# StackOverflow 问答 15114000-15114999

# c++ - number xor K - K = number + K xor K，为什么？

> ID：15114000
> 
> 赞同：-4
> 
> 时间：2013-02-27T14:02:40.907
> 
> 标签：c++, c, bit-manipulation

似乎对于给定整数 n 及其掩码 k 的普通整数（按位运算）（一个字节：1111 1111 表示负数，0000 0000 表示正数）

```
(n ^ K) - K = (n + K) ^ K 
```

这通常用于计算以 K 为掩码的数 n 的绝对值。我的问题是：为什么上述表达有效？为什么这两个术语是等价的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:16:10.113

您似乎只对 k 的 2 个值感兴趣：0 和 -1。

对于 k=0: `(n^0)-0=(n+0)^0`，好的。

对于 k=-1，由于`n^-1==~n`，这重写为`~n+1=~(n-1)`，尝试在两边添加 n-1 并注意 n+~n==-1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:11:47.583

我认为那不是真的。为了

```
(n ^ k) - k = (n + k) ^ k =>
((n ^ k) - k) ^ k) = (n + k) ^ k ^k =>
(n ^ k) ^ k - k ^ k = n + k => ### WRONG
n ^ k - 0 = n + k =>
n ^ k = n + k =>
n & k = 0 
```

这是等式的前提。

**编辑**

我犯了一个错误，即 xor 不能通过减法分配。`(a - b) ^ c = a ^ c - b ^ c`是错的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:19:42.840

`k = ~0`和存在整数溢出`n + k`。因此，它会导致未定义的行为。

# vim - 如何控制vim测量段落的方式

> ID：15114001
> 
> 赞同：2
> 
> 时间：2013-02-27T14:02:41.257
> 
> 标签：vim

在 vim 中编辑乳胶代码时，我经常键入`gwap`以重新调整当前段落。不幸的是，当段落包含方程式或其他类似的乳胶控制代码时，格式都被混淆了。

例如，如果我尝试重新调整合理合理的段落

```
Our network model follows that of Nakajima et
al.~\\cite{nakajima_robustness_2010} which is in turn based on the model of Li
et al.~\\cite{li_yeast_2004}. We define the dynamics of a network through the
following recurrence relation
\\[
X_i^{t+1} = \\left\\{ \\begin{array}{cl}
  1 & \\textrm{if $\\sum_j J_{ij} X_j^t > 0$} \\\\
  0 & \\textrm{if $\\sum_j J_{ij} X_j^t < 0$} \\\\
  \\theta_i & \\textrm{if $\\sum_j J_{ij} X_j^t = 0$}
\\end{array} \\right.
\\]
$X_i^t \\in \\{0, 1\\}$ is the expression state of gene $i$ at time point $t$.
$J_{ij}$ represents the regulatory effect of gene $j$ on gene $i$. $J_{ij} >
0$, $J_{ij} < 0$ and $J_{ij} = 0$  imply activation, repression and the absence
of regulation respectively. $\\theta_i$ is the constitutive expression state of
gene $i$. 
```

然后我结束了这个烂摊子：

```
Our network model follows that of Nakajima et
al.~\\cite{nakajima_robustness_2010} which is in turn based on the model of Li
et al.~\\cite{li_yeast_2004}. We define the dynamics of a network through the
following recurrence relation \\[ X_i^{t+1} = \\left\\{ \\begin{array}{cl} 1 &
                              \\textrm{if $\\sum_j J_{ij} X_j^t > 0$} \\\\ 0 &
                       \\textrm{if $\\sum_j J_{ij} X_j^t < 0$} \\\\ \\theta_i &
                       \\textrm{if $\\sum_j J_{ij} X_j^t = 0$} \\end{array}
                   \\right.  \\] $X_i^t \\in \\{0, 1\\}$ is the expression state of
                   gene $i$ at time point $t$.  $J_{ij}$ represents the
                   regulatory effect of gene $j$ on gene $i$. $J_{ij} > 0$,
                   $J_{ij} < 0$ and $J_{ij} = 0$  imply activation, repression
                   and the absence of regulation respectively. $\\theta_i$ is
                   the constitutive expression state of gene $i$. 
```

我如何告诉 vim 段落不应该跨越代码`\[ \] \begin{} \end{}`？

谢谢，约翰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:06:41.603

*段落*的概念来自*nroff 宏的旧**vi*遗产（无论是什么:-）；它不能有很大的改变。最近，[vim_dev 邮件列表](http://www.vim.org/community.php)上出现了一个补丁，以[支持通过正则表达式进行自定义定义](http://groups.google.com/group/vim_dev/browse_thread/thread/eabeaa5fc5ba23f6)。

 *到目前为止，您必须通过使用视觉选择来解决该问题：`Vjjjgw`. *或者，您可以为Tex*段落编写自己的文本对象。*

# url - 这是正确类型的 URL 地址吗？

> ID：15114010
> 
> 赞同：0
> 
> 时间：2013-02-27T14:02:58.693
> 
> 标签：url

嗨，如果两个域名 www.xyz.com 和 www.abc.com 是正确的，并且 xyz.com 是托管 abc.com 的服务器，那么地址 www.xyz.com/www.abc.com 是否有效？这个问题是试图解决一个法律问题！

谢谢，

亨利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:12:12.283

不，它不会工作。通常你会使用 vHosts 在一台机器上运行多个域。它们可以通过 IP（如果每个域有一个 IP）或 HTTP 标头中请求的域（如果两个域共享一个 IP）来区分。

所以，基本上你得到哪个网站取决于你的要求。地址 www.xyz.com/www.abc.com 应该提供 404 错误。除非管理员故意配置它以响应该请求。

进一步阅读：[http ://httpd.apache.org/docs/2.2/en/vhosts/name-based.html](http://httpd.apache.org/docs/2.2/en/vhosts/name-based.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:15:20.360

这是一个相当奇怪的问题。

如果您有两个都指向一个服务器的域，则地址 www.domain1.com www.domain2.com 将是该服务器上的虚拟主机。

如果配置正确，每个虚拟主机都会有自己的主文件夹

并且 www.domain1.com/something 将是 www.domain1.com 的 DocumentRoot 中名为 something 的文件夹

从您在域之后添加 / 的那一刻起，该计算机上的 Web 服务器将尝试查找本地文档根目录以查找超出该点的任何内容

即使使用非常糟糕的 Web 服务器配置，这也不太可能工作，因为它在 / 是它正在寻找的 DocumentRoot 文件夹之后返回到上面

所以除非你假设 domain1 的文档根目录是：/var/www/domain1/

如果你有 /var/www/domain1/www.domain2.com { 其中包含 www.domain2.com 的所有内容，那么它不会工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:16:14.347

`www.xyz.com/www.abc.com`是一个有效的 URI 并指向host*路径* 上的资源。只要主机的这条路径上存在某些东西，就会返回一个资源。`/www.abc.com``www.xyz.com``www.xyz.com/www.abc.com`

是否`www.xyz.com/www.abc.com`有效不取决于是否`xyz.com`和`abc.com`是否相关。*主机* 也可能不存在，`www.abc.com`因为它没有被提及。

[http://en.wikipedia.org/wiki/URI_scheme#Generic_syntax](http://en.wikipedia.org/wiki/URI_scheme#Generic_syntax)

# matplotlib - 如何使用 matplotlib 设置常用标签

> ID：15114013
> 
> 赞同：0
> 
> 时间：2013-02-27T14:02:58.950
> 
> 标签：matplotlib, axes

我以这种方式获得了一个情节：

```
f, ((ax1, ax2, ax3, ax4), (ax5, ax6, ax7, ax8), (ax9, ax10, ax11, ax12)) = plt.subplots(3, 4, sharex = 'col', sharey = 'row')
ax1.set_title('column1')
ax1.plot([x], [y])
ax5.plot([x1],[y1])
ax9.plot([x2],[y2])
..... 
```

所以，我基本上有 3 行和 4 列。我想知道如何将通用标签放在 x 和 y 轴上。我试着写

```
 plt_xlabel('x')
 plt.ylabel('y') 
```

或者

```
 set.xlabel('x')
 set.ylabel('y') 
```

但它不起作用。你能帮助我吗？是否也可以将文本放在情节的右端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:17:37.010

您可以通过遍历轴列表来做到这一点：

```
f, ax_lst  =  plt.subplots(3, 4, sharex = 'col', sharey = 'row')
for ax_l in ax_lst:
    for ax in ax_l:
        ax.set_xlabel('x')
        ax.set_ylabel('y') 
```

# python - 使用 len() 和 def __len__(self): 构建一个类

> ID：15114023
> 
> 赞同：36
> 
> 时间：2013-02-27T14:03:26.550
> 
> 标签：python, class, optimization, coding-style

只是好奇，

`len()`使用或`def __len__()`构建类之间有什么区别（优点和缺点）吗？哪种 Python 风格最好？

```
 class foo(object):
      def __init__(self,obs=[])
         self.data = obs
         self.max = max(obs)
         self.min = min(obs)
         self.len = len(obs) 
```

或者

```
 class foo(object):
      def __init__(self,obs=[])
         self.data = obs
         self.max = max(obs)
         self.min = min(obs)
      def __len__(self):
         return len(self.data) 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-02-27T14:04:59.113

有*很大*的不同。

该`__len__()`方法是一个钩子方法。该`len()` *函数*将使用该`__len__`方法（如果存在）来查询您的对象的长度。

人们期望使用的*普通*`len()`API 是方法，而使用`.len`属性会偏离该规范。

如果`self.data`不希望更改的长度，您始终可以将长度缓存在属性中并`.__len__()`返回该属性。

```
class foo(object):
    def __init__(self, obs=None):
        if obs is None:  # provide a default if no list was passed in.
            obs = []
        self.data = obs
        self.max = max(obs)
        self.min = min(obs)
        self._data_len = len(obs)

    def __len__(self):
        return self._data_len 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T14:05:32.710

有几个区别：

1.  只有第二种方法会为您提供熟悉`len(obj)`的`foo`. 第一个将需要`obj.len()`.
2.  如果 的长度`self.data`可以在构建后更改，则只有第二个版本会反映新的长度。

# c# - LaunchUriAsync() 不启动 Windows 应用商店应用

> ID：15114027
> 
> 赞同：2
> 
> 时间：2013-02-27T14:03:31.830
> 
> 标签：c#, windows-8, microsoft-metro, windows-store-apps

我正在尝试通过 LaunchUriAsync() 在 OnShareTargetActivated() 方法上调用我的应用程序，但它不起作用。

我在 appmanifest 中有一个名为“myapp”的协议。当我在文件资源管理器上放置“myapp://test”时，我的应用程序会启动，但是当我这样做时：

```
protected async override void OnShareTargetActivated(ShareTargetActivatedEventArgs args)
{
   Uri uri = new Uri("myapp://test");
   await Windows.System.Launcher.LaunchUriAsync(uri);
} 
```

当用户单击共享选项中 Charm Bar 上的我的应用程序时，会发生这种情况。但是该应用程序永远不会启动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:50:19.437

共享应用程序示例 ( [http://code.msdn.microsoft.com/windowsapps/Sharing-Content-Target-App-e2689782](http://code.msdn.microsoft.com/windowsapps/Sharing-Content-Target-App-e2689782) )

你应该检查你所分享的内容的格式，metro 只接受某种类型的内容来分享，分享格式是 Text,uri,Bitmap,storageitems,Html

分享目标代码和图片（[http://blogs.msdn.com/b/going_metro/archive/2012/05/03/integrating-with-windows-8-share-charm-part-1-receiving-data.aspx](http://blogs.msdn.com/b/going_metro/archive/2012/05/03/integrating-with-windows-8-share-charm-part-1-receiving-data.aspx)）

如果你觉得有用，请接受作为答案

# google-apps-script - 强制重新发布谷歌电子表格的脚本

> ID：15114031
> 
> 赞同：3
> 
> 时间：2013-02-27T14:03:41.723
> 
> 标签：google-apps-script, google-sheets

我创建了一个将数据推送到 Google 电子表格的表单。数据是纬度、经度、位置和其他识别数据。电子表格随后以 .CSV 文件的形式发布并导入 ARC GIS 以显示在交互式地图上。它完全按照我的意愿工作，我将其设置为在每次更改后重新发布。

问题是当电子表格有脚本附加的行时，它不会将其视为更改和重新发布。为了将更新的数据导入到地图中，我需要进入并手动重新发布。无论如何，我可以通过 Google Apps 脚本编写几行代码来强制重新发布吗？然后，我可以将其添加到我拥有的“表单提交”脚本或另一个基于时间的脚本中，该脚本已经在每天凌晨 3 点运行。

我查看了 Google Apps 脚本文档，但没有找到任何东西。在网上搜索帮助时，绝大多数回复都是关于如何将您的脚本发布为其他人的模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:01:31.703

在通过菜单条目或基于时间的触发器执行以下功能后，我的测试表被重新发布。

```
function ChangeIt() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet()
  var t = new Date()
  var x = 'upd: ' + t
  var range = sheet.getRange('a3')
  range.setValue(x)
} 
```

如果我站在你的立场上，我会在工作表的末尾添加一个额外的列，其中包含一些良性的常量数据，脚本可以更改这些数据而不会影响使用数据的系统。如果无法选择额外的列，请尝试修改我的示例以读取当前值，更改它，然后立即将其更改回来。

另外，当表单提交添加新行时，我会查看电子表格 onEdit() 触发器是否触发。如果是这样，请将您的 GAS 功能与其绑定以强制重新发布。如果没有，设置一个定时触发器来执行 GAS 功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-18T21:13:17.680

无需编写脚本即可解决此问题的快速解决方法是简单地制作数据的数组副本。

例如，我创建了一个新选项卡并在 A1 中输入： =ArrayFormula('Form Responses 1'!A1:Z1000)

虽然主表单响应选项卡将插入行并且不能很好地使用公式，但这个新选项卡保持良好和不变，并在添加新数据时自动更新。

# html - div 结构，每列的自动宽度相同

> ID：15114033
> 
> 赞同：1
> 
> 时间：2013-02-27T14:03:52.200
> 
> 标签：html, css

让我们看看这张表：

```
<table border="1">
<tr><td>1111</td><td>42342324</td><td>ffffffff</td></tr>
<tr><td>11</td><td>442324</td><td>fdadasdfffffff</td></tr>
</table> 
```

我需要做类似的事情，但要使用 DIV 元素（对不起，老板不允许使用表格）。真正的问题是，如何在不直接设置的情况下设置相同的宽度？我的意思是，如果第一行更长，那么它将是实际宽度，否则是第二行。最好没有 javascript/jQuery 黑客攻击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:10:56.893

我认为您想检查`flexbox`现代浏览器，并为旧浏览器提供 JavaScript 后备。

[http://css-tricks.com/using-flexbox/](http://css-tricks.com/using-flexbox/)

> Flexbox 非常棒，肯定是布局未来的一部分。在过去几年中，语法发生了很大变化，因此出现了“旧”和“新”语法。但是，如果我们将旧的、新的和中间的语法结合在一起，我们可以获得不错的浏览器支持。特别是对于一个简单且可能是最常见的用例：顺序控制的网格

[http://caniuse.com/flexbox](http://caniuse.com/flexbox)显示了相当不错的支持.. IE10、FF、Chrome、Safari 甚至 Opera！*

*使用组合的“新旧”语法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:19:23.633

我假设您希望“列”的宽度与内容一起增长？动态设置列中每个 div 的宽度？

我想不出用 css 做到这一点的方法，但是一些带有一些 div 的 jiggery pokery 可能会起作用。

```
<style>
    .table{
      border:1px solid black;
      position:relative;
    }
    .column{
      border:1px solid red;
      display:inline-block;
    }
    .cell{
      border:1px solid blue;
      float:left;
      clear:both;
    }
</style>
    <div class="table">
        <div class="column">
            <div class"cell">11</div>
            <div class"cell">ffff</div>
        </div>
        <div class="column">
            <div class"cell">1111</div>
            <div class"cell">f</div>
        </div>
        <div class="column">
            <div class"cell">1</div>
            <div class"cell">fff</div>
        </div>
    </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:06:40.180

```
<div id="main_div">
  <div id="nr1">   </div>
  <div id="nr2">   </div>
</div> 
```

并且您使用 css 来设置样式：宽度、高度、边距、每个 div 的位置

# python - Python：获取列表的子集，避免列表理解

> ID：15114034
> 
> 赞同：2
> 
> 时间：2013-02-27T14:03:55.940
> 
> 标签：python, list, list-comprehension

我经常发现自己有一个对象列表和相关参数列表：param1、param2、param3 等。我想获得具有满足某些条件的参数的对象子集。伪代码将是：

```
subset = object if param1>10 and 5<param2-param3<6 and param4==1 
```

我知道如何使用列表推导来做到这一点，但它变得非常丑陋，并且很难被其他人阅读。有替代品吗？例如，要两个两个添加列表的元素，很痛苦：

```
list1=[1,2,3,4]
list2=[10,10,10,10]

[item[0]+item[1] for item in zip(list1,list2)]
>>> [11, 12, 13, 14] 
```

使用 NumPy 数组而不是列表推导式看起来更清晰：

```
import numpy
list1=numpy.array([1,2,3,4])
list2=numpy.array([10,10,10,10])

list1 + list2
>>> array([11, 12, 13, 14]) 
```

当您开始对两个以上的列表进行一些重要的操作时，清晰度的增益会更大。

回到我最初在对象列表中只选择一些行的问题：

```
subset = [item[0] for item in zip(object,param1,param2,param3,param4) if item[1]>10 and item[2]-item[3]>5 and item[2]-item[3]<6 and item[4]==1] 
```

或者：

```
subset = [obj for obj,p1,p2,p3,p4 in zip(object,param1,param2,param3,param4) if p1>10 and p2-p3>5 and p2-p3<6 and p4==1] 
```

执行我想要的，但我觉得不是很优雅。更不用说非 pythoneers 很快就开始告诉你“SuperMongo 让它变得更容易”或“你想让我为此放弃 IDL！？”。

您是否知道为该特定任务提供更好语法的替代解决方案？NumPy 数组能否再次帮助简化语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:08:59.640

如果您正确缩进，我认为您的第二个示例可以变得非常可读：

```
[obj for obj, p1, p2, p3, p4 in zip(object, param1, param2, param3, param4) 
 if p1 > 10 
 and p2 - p3 > 5
 and p2 - p3 < 6
 and p4 == 1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:08:05.117

您可以使用[`filter`](http://docs.python.org/2/library/functions.html#filter)或只使用 for 循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:23:17.317

Numpy 数组版本：

```
subset = objects[(param1>10) & (param2-param3>5) & (param2-param3<6) & (param4==1)] 
```

但是 [] 中的每个操作都会创建一个临时数组，如果数组的大小很大，可能需要一些优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:27:08.267

您可以使用`map`/`imap`与`compress`.

```
from itertools import imap, compress

compress(obj_list, imap(lambda p1, p2, p3, p4: p1 > 10 and 5 < p2 - p3 < 6 and p4 == 1, param1_list, param2_list, param3_list, param4_list)) 
```

您还可以将其封装到一个函数中，以提供更简洁的接口。

```
mask_filter(filter_function, data, masks):

    return compress(data, imap(filter_function, masks))

mask_validator = lambda *params: params[0] > 10 and 5 < params[1] - params[2] < 6 and params[3] == 1
parameter_lists = (param1_list, param2_list, param3_list, param4_list)
mask_filter(mask_validator, obj_list, *parameter_lists) 
```

# node.js - Node.js 复制 /b 文件

> ID：15114039
> 
> 赞同：1
> 
> 时间：2013-02-27T14:04:07.110
> 
> 标签：node.js

我不确定 Windows 命令“copy /b ...”到底是做什么的，所以我的问题是：这可以用 Node.js 完成吗？如何？

你能给我一个例子，或者至少给我指出正确的方向吗？

例如：“复制 /b 文件 1+文件 2 目标文件”

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:43:53.773

`copy`是 Windows 中的内部命令。`copy /b file1+file2 destinationFile`创建destinationFile，其内容为file1，后跟file2，包括EOF等额外字符，因为`/b`.

以下是如何在 node.js 中执行此操作：

```
fs = require('fs');

file1=fs.createReadStream('./file1',{ flags: 'r',  encoding: "binary",});
file2=fs.createReadStream('./file2',{ flags: 'r',  encoding: "binary",});

dest=fs.createWriteStream('./destinationFile',{ flags: 'w',  encoding: "binary",});

file1.pipe(dest, { end: false });
file2.pipe(dest, { end: false }); 
```

# excel - 尝试使用 UDF .xll 在 HPC 网格上并行化 Excel

> ID：15114040
> 
> 赞同：1
> 
> 时间：2013-02-27T14:04:12.733
> 
> 标签：excel, parallel-processing, user-defined-functions, hpc, xll

我希望在 HPC 网格上并行化 Excel 计算，我正在使用 Excel 2007，所以我试图通过 XLL 中的 UDF 对其进行多线程处理，因为它是唯一的方法（至少在 2007 年）。

我想用 C# 编写 XLL 代码，正如[这个线程](https://stackoverflow.com/questions/665633/creating-an-excel-worksheet-function-udf-at-runtime-in-c-sharp)建议的那样，我可以使用 [exceldna](http://exceldna.codeplex.com/documentation)。

但是我不明白我应该如何多线程。在多线程处理时，我是否必须在 C# 中重新编写所有 VBA 函数？我可以只创建几个线程，每个线程调用一个 VBA 宏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:37:29.597

[Excel-DNA](http://excel-dna.net)允许您可能会发现有用的不同方法：

*   您可以将 UDF 标记为“线程安全”以使用[Excel 对多线程计算的支持](http://msdn.microsoft.com/en-us/library/office/bb687899.aspx)- 在这种情况下，Excel 控制线程，并将从不同线程同时调用您的 UDF，
*   您可以使用[Excel-DNA 中的异步函数](http://exceldna.codeplex.com/wikipage?title=Asynchronous%20Functions%20with%20Tasks)（可能使用 .NET 4 任务 API）开始网格上的工作，并在完成后通知 Excel 重新计算，
*   您可以使用 Excel-DNA 中的[Reactive Extensions 支持](http://exceldna.codeplex.com/wikipage?title=Reactive%20Extensions%20for%20Excel)并在 Rx 库上构建计算管道，
*   您可以使用Excel 2010 中内置[的 Windows HPC 群集支持，使用 Excel-DNA 在客户端和群集节点上托管托管代码。](http://excel-dna.net/2010/12/09/cluster-udf-support/)

在这些情况下，调用 Excel VBA 没有任何意义 - Excel 将始终确保 VBA 代码在 Excel 的主线程上运行。

如果您的函数代码在 VBA 中，您可以考虑[将 VB.NET 用于您的 Excel-DNA 插件](http://sysmod.wordpress.com/2012/02/06/from-vba-to-vb-net-using-exceldna/)，而不是 C# - 这可能会使您轻松迁移到 .NET。您还可以在托管的 Excel-DNA 加载项中混合使用 C# 和 VBA。

# c# - 输入不是有效的 Base-64 字符串，因为它包含非 base 64 字符

> ID：15114044
> 
> 赞同：128
> 
> 时间：2013-02-27T14:04:18.290
> 
> 标签：c#, file-io, base64

我有一个 REST 服务，它读取文件并将其转换为字节数组，然后转换为 Base64 字符串后将其发送到另一个控制台应用程序。这部分有效，但是当应用程序接收到相同的流时，它会被操纵并且不再是有效的 Base64 字符串。一些垃圾字符被引入流中。

将流转换回字节时收到的异常是

> 输入不是有效的 Base-64 字符串，因为它包含非 base 64 字符、两个以上的填充字符或填充字符中的非空白字符

**在服务：**

```
[WebGet(UriTemplate = "ReadFile/Convert", ResponseFormat = WebMessageFormat.Json)]  
public string ExportToExcel()
  {
      string filetoexport = "D:\\SomeFile.xls";
      byte[] data = File.ReadAllBytes(filetoexport);
      var s = Convert.ToBase64String(data);
      return s;
  } 
```

**申请时：**

```
 var client = new RestClient("http://localhost:56877/User/");
       var request = new RestRequest("ReadFile/Convert", RestSharp.Method.GET);
       request.AddHeader("Accept", "application/Json");
       request.AddHeader("Content-Type", "application/Json");
       request.OnBeforeDeserialization = resp => {resp.ContentType =    "application/Json";};
       var result = client.Execute(request);
       byte[] d = Convert.FromBase64String(result.Content); 
```

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2015-05-29T09:22:17.800

检查您的图像数据是否在开头包含一些标题信息：

```
imageCode = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkC... 
```

这将导致上述错误。

只需删除前面的所有内容，包括第一个逗号，就可以了。

```
imageCode = "iVBORw0KGgoAAAANSUhEUgAAAMgAAABkC... 
```

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-02-27T14:09:43.370

很可能它正在转换为修改后的 Base64，其中`+`and`/`字符更改为`-`and `_`。见[http://en.wikipedia.org/wiki/Base64#Implementations_and_history](http://en.wikipedia.org/wiki/Base64#Implementations_and_history)

如果是这种情况，您需要将其改回：

```
string converted = base64String.Replace('-', '+');
converted = converted.Replace('_', '/'); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2016-03-29T09:40:47.550

我们可以去掉值前面不必要的字符串输入。

```
string convert = hdnImage.Replace("data:image/png;base64,", String.Empty);

byte[] image64 = Convert.FromBase64String(convert); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-10-04T18:07:37.423

**通过正则表达式**删除不必要的字符串

 **```
Regex regex=new Regex(@"^[\w/\:.-]+;base64,");
base64File=regex.Replace(base64File,string.Empty); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-02-27T14:42:41.690

由于您将字符串作为 JSON 返回，因此该字符串将包括原始响应中的开始和结束引号。所以你的反应应该是这样的：

```
"abc123XYZ==" 
```

或其他...您可以尝试使用 Fiddler 确认这一点。

我的猜测是`result.Content`原始字符串，包括引号。如果是这种情况，则`result.Content`需要先反序列化才能使用它。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-08-23T13:37:20.960

**万一你不知道上传图片的类型，你只需要删除它的`base64`标题：**

```
 var imageParts = model.ImageAsString.Split(',').ToList<string>();
 //Exclude the header from base64 by taking second element in List.
 byte[] Image = Convert.FromBase64String(imageParts[1]); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-27T15:45:05.310

我安排了与您描述的类似的上下文，但遇到了同样的错误。我设法通过`"`从内容的开头和结尾删除并替换 `\/`为`/`.

这是代码片段：

```
var result = client.Execute(request);
var response = result.Content
    .Substring(1, result.Content.Length - 2)
    .Replace(@"\/","/");
byte[] d = Convert.FromBase64String(response); 
```

作为替代方案，您可以考虑使用 XML 作为响应格式：

```
[WebGet(UriTemplate = "ReadFile/Convert", ResponseFormat = WebMessageFormat.Xml)]  
public string ExportToExcel() { //... } 
```

在客户端：

```
request.AddHeader("Accept", "application/xml");
request.AddHeader("Content-Type", "application/xml");
request.OnBeforeDeserialization = resp => { resp.ContentType = "application/xml"; };

var result = client.Execute(request);
var doc = new System.Xml.XmlDocument();
doc.LoadXml(result.Content);
var xml = doc.InnerText;
byte[] d = Convert.FromBase64String(xml); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-09-25T10:57:16.630

可能字符串会像这样`data:image/jpeg;base64,/9j/4QN8RXh...` First split for`/`并获得第二个令牌。

```
var StrAfterSlash = Face.Split('/')[1]; 
```

然后拆分`;`并获取将成为格式的第一个标记。就我而言，它是jpeg。

```
var ImageFormat =StrAfterSlash.Split(';')[0]; 
```

然后删除`data:image/jpeg;base64,`收集格式的行

```
CleanFaceData=Face.Replace($"data:image/{ImageFormat };base64,",string.Empty); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-04-06T08:05:42.613

```
var spl = item.Split('/')[1];
var format =spl.Split(';')[0];           
stringconvert=item.Replace($"data:image/{format};base64,",String.Empty); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-08-03T08:16:06.653

正如[亚历克斯·菲利波维奇](https://stackoverflow.com/questions/15114044/the-input-is-not-a-valid-base-64-string-as-it-contains-a-non-base-64-character#comment21267678_15114044)所说，这个问题是错误的编码。我读入的文件是`UTF-8-BOM`并在`Convert.FromBase64String()`. 更改为`UTF-8`确实没有问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-02-03T10:56:46.627

有时它以双引号开头，大多数时候你从 dotNetCore 2 调用 API 来获取文件

```
string string64 = string64.Replace(@"""", string.Empty);
byte[] bytes = Convert.ToBase64String(string64); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-28T13:28:36.950

我收到此错误是因为**sqlserver**表中的字段是**varbinary而不是****varchar**。

 ***** * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-01T20:16:29.903

请检查是否没有 == 作为后缀，只需在字符串的最后添加 == 字符

```
// "........V/XeAeH/wALVWKtD8lz/AAAAABJRU5ErkJggg"
"........V/XeAeH/wALVWKtD8lz/AAAAABJRU5ErkJggg=="    /* yes */ 
```******

# jna - 使用 jna 读取 windows 日志

> ID：15114047
> 
> 赞同：1
> 
> 时间：2013-02-27T14:04:22.090
> 
> 标签：jna

# 使用 jna 读取 Windows 日志时出现异常

以下是我用来读取日志的程序。我从另一个帖子中获取了这个程序。

```
import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.CharBuffer;
import java.util.Arrays;

import com.sun.jna.*;
import com.sun.jna.platform.win32.*;
import com.sun.jna.platform.win32.WinNT.*;
import com.sun.jna.ptr.IntByReference;

public class Test {

public static void main(String[] args) throws NumberFormatException, IOException {

    HANDLE h = com.sun.jna.platform.win32.Advapi32.INSTANCE.OpenEventLog(null, "Application");
    IntByReference pnBytesRead = new IntByReference();
    IntByReference pnMinNumberOfBytesNeeded = new IntByReference();

    IntByReference pOldestRecord = new IntByReference();
    assertTrue(com.sun.jna.platform.win32.Advapi32.INSTANCE.GetOldestEventLogRecord(h,  pOldestRecord));
    int dwRecord = pOldestRecord.getValue();
    System.out.println("OLD: " + dwRecord);
    IntByReference pRecordCount = new IntByReference();
    assertTrue(com.sun.jna.platform.win32.Advapi32.INSTANCE.GetNumberOfEventLogRecords(h, pRecordCount));
    int dwRecordCnt = pRecordCount.getValue();
    System.out.println("CNT: " + dwRecordCnt);

    int bufSize = 0x7ffff; //(r.size()) * 2048;
    Memory buffer = new Memory(bufSize);
    int rc = 0;
    int cnt = 0;
    while(com.sun.jna.platform.win32.Advapi32.INSTANCE.ReadEventLog(h, 
            WinNT.EVENTLOG_SEEK_READ  /*
            | WinNT.EVENTLOG_SEQUENTIAL_READ */ 
            | WinNT.EVENTLOG_FORWARDS_READ /*
            | WinNT.EVENTLOG_BACKWARDS_READ*/
            , 
            dwRecord, buffer, 
            bufSize, 
            pnBytesRead, 
            pnMinNumberOfBytesNeeded)) {

        rc = Kernel32.INSTANCE.GetLastError();
        if (rc == W32Errors.ERROR_INSUFFICIENT_BUFFER) {
            break;
        }        

        int dwRead = pnBytesRead.getValue();
        Pointer pevlr = buffer;

        while (dwRead > 0) 
        {
            cnt++;
            EVENTLOGRECORD record = new EVENTLOGRECORD(pevlr);
            System.out.println("------------------------------------------------------------");
            System.out.println(cnt+". " + dwRecord + " Event ID: " + record.EventID.shortValue() + " SID: " + record.UserSidLength);

            dwRecord++;

            // WCHAR SourceName[]
            // WCHAR Computername[]
            {
                ByteBuffer names = pevlr.getByteBuffer(record.size(), 
                        (record.UserSidLength.intValue() != 0 ? record.UserSidOffset.intValue() : record.StringOffset.intValue()) - record.size());
                names.position(0);
                CharBuffer namesBuf = names.asCharBuffer();
                String[] splits = namesBuf.toString().split("\0");
                System.out.println("SOURCE NAME: \n" + splits[0]);
                System.out.println("COMPUTER NAME: \n" + splits[1]);
            }
            // SID   UserSid
            if (record.UserSidLength.intValue() != 0){
                ByteBuffer sid = pevlr.getByteBuffer(record.UserSidOffset.intValue(), record.UserSidLength.intValue());
                sid.position(0);
                //CharBuffer sidBuf = sid.asCharBuffer();
                byte[] dst = new byte[record.UserSidLength.intValue()];
                sid.get(dst);
                System.out.println("SID: \n" + Arrays.toString(dst));
            }
            else {
                System.out.println("SID: \nN/A");
            }
            // WCHAR Strings[]
            {
                ByteBuffer strings = pevlr.getByteBuffer(record.StringOffset.intValue(), record.DataOffset.intValue() - record.StringOffset.intValue());
                strings.position(0);
                CharBuffer stringsBuf = strings.asCharBuffer();
                System.out.println("STRINGS["+record.NumStrings.intValue()+"]: \n" + stringsBuf.toString());
            }
            // BYTE  Data[]
            {
                ByteBuffer data = pevlr.getByteBuffer(record.DataOffset.intValue(), record.DataLength.intValue());
                data.position(0);
                CharBuffer dataBuf = data.asCharBuffer();
                System.out.println("DATA: \n" + dataBuf.toString());
            }
            // CHAR  Pad[]
            // DWORD Length;

            dwRead -= record.Length.intValue();
            pevlr = pevlr.share(record.Length.intValue());
        }
    }
    assertTrue(rc == W32Errors.ERROR_HANDLE_EOF);
    assertTrue(com.sun.jna.platform.win32.Advapi32.INSTANCE.CloseEventLog(h));        
}

private static void assertTrue(boolean getOldestEventLogRecord) {

} 
```

}

例外情况如下：-

```
 Exception in thread "main" java.lang.NoSuchMethodError: com.sun.jna.IntegerType.
    <init>(IJZ)V
    at com.sun.jna.platform.win32.WinDef$DWORD.<init>(WinDef.java:57)
    at com.sun.jna.platform.win32.WinDef$DWORD.<init>(WinDef.java:53)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)

    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at com.sun.jna.NativeMappedConverter.defaultValue(NativeMappedConverter.java:47)
    at com.sun.jna.NativeMappedConverter.<init>(NativeMappedConverter.java:41)
    at com.sun.jna.NativeMappedConverter.getInstance(NativeMappedConverter.java:29)
    at com.sun.jna.Structure.calculateSize(Structure.java:803)
    at com.sun.jna.Structure.useMemory(Structure.java:254)
    at com.sun.jna.Structure.useMemory(Structure.java:238)
    at com.sun.jna.Structure.<init>(Structure.java:174)
    at com.sun.jna.Structure.<init>(Structure.java:167)
    at com.sun.jna.Structure.<init>(Structure.java:163)
    at com.sun.jna.platform.win32.WinNT$EVENTLOGRECORD.<init>(WinNT.java:1789)
    at Test.main(Test.java:54) 
```

请帮我摆脱困境。提前非常感谢。我是这个很棒的网站的新手，所以请原谅我的错误解释

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T13:23:17.840

您不能使用不同版本的 platform.jar 和 jna.jar。 *这*就是导致您的错误的原因。两者都分布在一起，所以我不明白你为什么使用一个版本的一个版本和另一个版本的不同版本。

# java - 无法延迟初始化集合，从 org.hibernate.classic.Lifecycle 的 onload 方法访问时没有关闭会话或会话

> ID：15114049
> 
> 赞同：0
> 
> 时间：2013-02-27T14:04:28.890
> 
> 标签：java, hibernate

# 代码

****l_details的****引脚**具有外部约束，它指的是**x_details 主键**，这里我使用 XDetails 类的单向关系。**

 **# 实体：

```
 @Entity
    @Table(name = "x_details")
    public class XDetails implements Lifecycle {
    private int y;
    ....
    .....
    private Set<LDetails> lDetails = new HashSet<LDetails>(0);
    .........
    ..........
        @OneToMany(fetch = FetchType.LAZY)
    @JoinColumn(name="pin")
    public Set<LDetails> getLDetails() {
        return this.lDetails;
    }

    @Override
    public void onLoad(Session s, Serializable id) {
        System.out.println("inside  load");
        try{
            if((lDetails!=null)){
                System.out.println("size of lDetails"+lDetails.size());
            }   
        }
        catch(Exception exception){
            exception.printStackTrace();
        }
    }
    }

    @Entity
    @Table(name = "l_details")
    public class LDetails {

    private Integer id1;
    private Integer pin;
    ....
    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "id1", unique = true, nullable = false)
    public Integer getId1() {
        return this.id1;
    }

    public void setId1(Integer id1) {
        this.id1 = id1;
    }
    @Column(name="pin")
    public Integer getPin() {
        return this.pin;
    }

    public void setPin(Integer pin) {
        this.pin = pin;
    }

    } 
```

主线程：

```
 Session session=HibernateUtil.getSessionFactory().getCurrentSession();
    session.beginTransaction();
    Criteria criteria=session.createCriteria(XDetails.class);
    criteria.createAlias("lDetails", "status",CriteriaSpecification.INNER_JOIN);
    criteria.setFetchMode("status", FetchMode.JOIN); 
    List<XDetails> details=criteria.list();
    session.getTransaction().commit(); 
```

异常（在 onload 内）：

```
 org.hibernate.LazyInitializationException: failed to lazily initialize a collection, no session or session was closed
    at rg.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:383)
    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:375)
    at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:122)
    at org.hibernate.collection.PersistentSet.size(PersistentSet.java:162)
    at com.hibernate.test.pendingdict3.XDetails.onLoad(XDetails.java:588)
    at org.hibernate.event.def.DefaultPostLoadEventListener.onPostLoad(DefaultPostLoadEventListener.java:73)
    at org.hibernate.engine.TwoPhaseLoad.initializeEntity(TwoPhaseLoad.java:234)
    at org.hibernate.loader.Loader.initializeEntitiesAndCollections(Loader.java:898)
    at org.hibernate.loader.Loader.doQuery(Loader.java:773)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:270)
    at org.hibernate.loader.Loader.doList(Loader.java:2449)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2192)
    at org.hibernate.loader.Loader.list(Loader.java:2187)
    at org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:119)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1706)
    at org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:347)
    at com.hibernate.test.main4.HibernateStandaloneMain.main(HibernateStandaloneMain.java:24) 
```

我正在使用 Hibernate 3.5.6 最终依赖项，mysql 数据库，并且正在运行 hibernatestandalone 应用程序。

```
# onload method
       @Override
    public void onLoad(Session s, Serializable id) {
        System.out.println("inside  load");
        try{
            if((lDetails!=null)){
                System.out.println("size of lDetails"+lDetails.size());
            }   
        }
        catch(Exception exception){
            exception.printStackTrace();
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:49:47.657

问题是您选择`LAZY`加载，但当您第一次访问集合的元素时，您的会话已经关闭。您需要`EAGER`获取您`Set<LDetails>`的会话或保持会话打开，直到所有操作完成。**

# android - 使用广播接收器刷新列表视图

> ID：15114050
> 
> 赞同：2
> 
> 时间：2013-02-27T14:04:29.253
> 
> 标签：android, listview, android-intent, service, broadcastreceiver

我有列表视图，可以在其中查看对象列表。此列表保存在内存中，当您使用服务启动应用程序时会刷新此列表。但是当您打开 listviewactivity 时，如果服务完成加载，我希望 listviewactivity 重新启动。

我试图这样实现它：

在我的服务类中，准备好后：

```
sendBroadcast(new Intent("REFRESH_RECEIPT_LISTVIEW")); 
```

然后在我的 ListViewActivity.class 的底部：

```
class DataUpdateReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
         if (intent.getAction().equals("REFRESH_RECEIPT_LISTVIEW")) {
            //restart code 
         }

    }
} 
```

所以这应该可以，但是我不知道如何使用广播接收器重新启动我的 listviewactivity。要重新开始一项活动，您可以做一些事情开始新活动，与旧活动相同，完成此活动

但我怎么能在广播接收器上下文中做到这一点？我是否需要在我的 listviewactivity oncreate 中初始化/启动我的接收器？

谢谢！

# php - 在 Jquery Mobile 中执行更新查询然后更改页面

> ID：15114052
> 
> 赞同：1
> 
> 时间：2013-02-27T14:04:30.240
> 
> 标签：php, jquery-mobile

我有一个确认对话框，当用户单击链接时会导致更新查询。

```
<div class="ui-bar">
    <a id="confirm" href="#" data-strid="<?php echo $str_info['str_id'] ?>">Confirm</a>
</div> 
```

我要做的是运行更新查询，然后重新加载上一页，其中包含更新的信息。

我以为我完成了这一点，但是萤火虫中不断出现某种错误，而 ajax 似乎并不成功。错误仅在我重新加载页面时出现......当我对其进行延迟时，没有错误，所以我什至无法阅读它是什么。

```
<script>
        $('#confirm').click(function (){
        var str_id = $("#confirm").data("strid");
        $.ajax({
            type: "POST",
            async: true,
            url: '../../ajax/add_land',
            dataType: 'json', 
            data: { str_id: str_id },
            success: function(){

            }
        });
        $('.ui-dialog').dialog('close')
        setTimeout(
            function() 
            {
                location.reload()
            }, 750);
        return false;
    });
</script> 
```

有什么好的方法可以做到这一点吗？同样，总而言之，我希望执行更新查询，然后重新加载上次查看的页面（不是对话框），以便显示更改的信息。 `../../ajax/add_land`是在 PHP 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:10:49.230

实现这一点的更好方法很少，但这超出了重点，在您的情况下，您应该这样做：

```
<script>
        $('#confirm').click(function (){
        var str_id = $("#confirm").data("strid");
        $.ajax({
            type: "POST",
            async: true,
            url: '../../ajax/add_land',
            dataType: 'json', 
            data: { str_id: str_id },
            success: function(){
              $('.ui-dialog').dialog('close');            
              location.reload();
            }
        });
        return false;
    });
</script> 
```

当 ajax 调用成功执行时，它将调用**成功**回调中的代码。Ajax 调用是异步操作，这意味着其余代码不会等待它完成。因为这个成功回调被使用。所以需要超时。

还有一件事，还有一个错误回调，用它来调试ajax问题：

```
error: function (request,error) {
    alert('Network error has occurred please try again!');
}, 
```

# c - 如何从这个毕达哥拉斯三元组代码中过滤重复出现的三元组？

> ID：15114054
> 
> 赞同：0
> 
> 时间：2013-02-27T14:04:32.437
> 
> 标签：c

我写了下面的代码，但它给出了重复的输出。如 3,4,5 和 4,5,3 和 5,4,3。它显示相同的三元组。我怎样才能防止这种情况？

```
#include <stdio.h>

int main(void){

int side1=1;
int side2=1;
int hypotenus=1;
int till;
int count=0;

printf("Till what number do you want to find triplets?");
scanf("%d",&till);  

for(side1=1;side1<=till;side1++){

    for(side2=1;side2<=till;side2++){

        for(hypotenus=1;hypotenus<=till;hypotenus++){

            if(hypotenus*hypotenus==side1*side1+side2*side2){

                count++;
                printf("%5d %5d %5d is a triple \n",side1,side2,hypotenus);
            }
        }

    }

}
printf("\n");
printf("%d triplets found.",count);
return 0;

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:05:28.237

只需这样做：

```
for(side2=side1;side2<=till;side2++){ 
```

即改变这个循环的起始值。这样，您只会找到 side2>=side1 的三元组，并且永远不会计算类型的三元组和类型`(side1, side2, hyp)`的三元组`(side2, side1, hyp)`

# java - WebDriver 在网格布局中查找元素

> ID：15114068
> 
> 赞同：2
> 
> 时间：2013-02-27T14:05:11.290
> 
> 标签：java, selenium, junit, jbehave

为了测试我的应用程序，我使用 Selenium、JBehave 和 JUnit。要在页面中查找元素，我使用 WebDriver。

我有网格布局，在网格的每个部分都有我想单击的按钮，例如：

```
getDriver().findElement(By.className("v-button")).click(); 
```

但我想从网格布局的特定部分单击按钮：

```
<div class="v-gridlayout-slot" style="left: 0px; top: 0px;">
  <div class="v-verticallayout v-layout v-vertical v-widget">
    <div class="v-slot">
    <div class="v-slot v-slot-h2">
    <div class="v-slot">
    <div class="v-slot v-align-right v-align-bottom">
      <div tabindex="0" role="button" class="v-button v-widget">
<div class="v-gridlayout-slot" style="left: 308px; top: 0px;"> 
```

我在页面中有这样的结构，我想从左上角单击按钮（带有`style="left: 0px; top: 0px;"`）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T14:53:11.303

您最好让前端开发人员为您的按钮提供 ID。然后按特定 id 搜索，例如“btn-top-left”，因为这个元素在您的页面上是唯一的。按属性搜索元素是一种不好的做法，但如果没有其他选择，请尝试真正按属性搜索： getDriver().findElement(By.xpath("//div[contains(@class,'v-') 和 contains( @style,'left: 0px; top: 0px;')]")).click();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:50:37.343

您可以使用 xpath 搜索具有“包含”“左：0px；顶部：0px；”的样式属性的父 div。或者，使用类 'v-gridlayout-slot' 获取所有 div，然后通过字符串匹配检查它们的样式属性，直到找到所需的元素。

# c# - IIS 中托管的 WCF 服务在不同线程中使用时返回“安全句柄已关闭”

> ID：15114069
> 
> 赞同：2
> 
> 时间：2013-02-27T14:05:12.810
> 
> 标签：c#, .net, multithreading, winforms, wcf

我在 winform 中使用 wcf 代理时遇到了一些问题。这个 wcf 服务托管在 IIS 上，公开了 2 种方法，并且当我在单线程 winform 中使用它时（一次调用一个），它可以正常工作。当我在不同的线程中使用相同的代理（相同的实例或 2 个单独的实例，没关系）时出现问题，我确实收到错误：“安全句柄已关闭”。

我真正不明白的是：如果我启动一些都调用相同的 wcf 方法的线程，它工作正常。仅当我开始调用其中一个 wcf 方法，开始另一个调用第二个 wcf 方法并且第二个调用在第一个调用完成之前完成时，才会出现此问题。澄清：

```
This will work:
    - start threadA that calls wcf MethodA
    - start threadB that calls wcf MethodA
    - MethodA in threadA finishes <-- No errors
    - MethodA in threadB finishes <-- No errors

This won't work:
    - start threadA that calls wcf MethodA
    - start threadB that calls wcf MethodB
    - MethodB in threadB finishes <-- No errors
    - MethodA in threadA finishes <-- Error "Safe handle has been closed"

This won't work either, methods order doesn't matter, only the fact that I mix methods it seems:
    - start threadA that calls wcf MethodB
    - start threadB that calls wcf MethodA
    - MethodA in threadB finishes <-- No errors
    - MethodB in threadA finishes <-- Error "Safe handle has been closed" 
```

这是我收到的堆栈：

```
Server stack trace:
   at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message reply, MessageFault fault, String action, MessageVersion version, FaultConverter faultConverter)
   at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at MyProxy.MyInterface.MyMethod(String myParam) 
```

有人有解释吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:07:06.820

通常，所有代理类都派生自 System.ServiceModel.ClientBase。根据 MSDN 文档，ClientBase 的实例方法不是线程安全的。

[http://msdn.microsoft.com/en-us/library/ms576141.aspx](http://msdn.microsoft.com/en-us/library/ms576141.aspx)

此外，查看错误，您的服务中可能存在一些公共资源。请检查 MethodA 和 MethodB 是否正在访问公共资源。调试服务将有所帮助

# excel - Excel 2007 VBA 将打开的工作簿保存为备份而不更改原始工作簿

> ID：15114071
> 
> 赞同：0
> 
> 时间：2013-02-27T14:05:20.953
> 
> 标签：excel, vba, backup

我正在尝试修改我在网上找到的这段代码

```
Sub SaveCopyas2()
Dim newWB As Variant
Dim wb1 As Workbook, wb2 As Workbook

Set wb1 = ActiveWorkbook
If wb1.Saved = False Then MsgBox wb1.FullName, vbInformation, "Workbook Not Saved"

 'Set a filename for new workbook
newWB = Application.GetSaveAsFilename(ActiveWorkbook.FullName, "Excel Files (*.xls), *.xls", , "Set Filename")
If newWB <> False Then wb1.SaveCopyAs (newWB)
End Sub 
```

它的作用是允许用户通过指定位置和名称来运行宏并保存备份

我要做的只是拥有它，以便在运行宏时，文件名为“备份”，位置为 C:\

任何人都可以帮我修复这段代码来做我想做的事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-29T16:32:44.897

（由 OP 在问题编辑中回答。移至社区 wiki 答案。请参阅[没有答案的问题，但问题已在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 这就是我要工作的地方。

```
Sub SaveCopyas2()
Dim newWB As Variant
Dim wb1 As Workbook
Set wb1 = ActiveWorkbook
With wb1
    .SaveCopyAs ("C:\Backup.xlsm")
End With
End Sub 
```

# asp.net - FormView 动态模板不会在插入/更新时发送表单值

> ID：15114072
> 
> 赞同：1
> 
> 时间：2013-02-27T14:05:24.673
> 
> 标签：asp.net, objectdatasource, formview

单击动态加载的 FormView 模板上的插入按钮时出现以下错误。默认表单模式设置为插入。我确实看到插入模板加载正常。我有 TypeName="WebApplication1.Repository.AccountRepo" 和 DataObjectTypeName="WebApplication1.Model.Account" 来更正类型。有人可以帮忙吗。

我得到的错误是 **ObjectDataSource 'ObjectDataSource1' 没有要插入的值。检查“值”字典是否包含值。**

```
 <asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
        <h2>
            Welcome to ASP.NET!
        </h2>
        <p>
            To learn more about ASP.NET visit <a href="http://www.asp.net" title="ASP.NET Website">
                www.asp.net</a>.
        </p>
        <p>
            You can also find <a href="http://go.microsoft.com/fwlink/?LinkID=152368&amp;clcid=0x409"
                title="MSDN ASP.NET Docs">documentation on ASP.NET at MSDN</a>.
            <uc1:WebUserControl1 ID="WebUserControl11" runat="server" />
        </p>
        <asp:FormView ID="FormView1" runat="server" DataSourceID="ObjectDataSource1"
            OnLoad="FormView1_Load" OnModeChanged="FormView1_ModeChanged" 
            oninit="FormView1_Init" ViewStateMode="Enabled"  DefaultMode="Insert">

        </asp:FormView>
        <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" DataObjectTypeName="WebApplication1.Model.Account"
            DeleteMethod="Delete"  SelectMethod="Select" TypeName="WebApplication1.Repository.AccountRepo"
            UpdateMethod="Update" oninserting="ObjectDataSource1_Inserting"
            InsertMethod="Insert">
            <InsertParameters>
                <asp:Parameter Name="acct" Type="Object" />
            </InsertParameters>
            <UpdateParameters>
                <asp:Parameter Name="acct" Type="Object"/>
            </UpdateParameters>
        </asp:ObjectDataSource>
    </asp:Content> 
```

页面初始化方法中的以下代码

```
 public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Init(object sender, EventArgs e)
        {
            //ITemplate control = Page.LoadTemplate("~/WebUserControl2.ascx");
            FormView1.EditItemTemplate = Page.LoadTemplate("~/WebUserControl2.ascx");
            FormView1.InsertItemTemplate = Page.LoadTemplate("~/WebUserControl2.ascx");
            FormView1.ItemTemplate = Page.LoadTemplate("~/WebUserControl2.ascx");

        }
    } 
```

我在 WebUserControl2.ascx 中有以下 HTML 片段

```
 <%@ Control Language="C#" AutoEventWireup="true" CodeBehind="WebUserControl2.ascx.cs"
        Inherits="WebApplication1.WebUserControl2" ViewStateMode="Enabled" %>
    Name:
    <asp:TextBox ID="NameTextBox" runat="server" Text='<%# Bind("Name") %>' />
    <br />
    Address:
    <asp:TextBox ID="AddressTextBox" runat="server" Text='<%# Bind("Address") %>' />
    <br />

    <asp:LinkButton ID="InsertButton" runat="server" CausesValidation="True" CommandName="Insert"
        Text="Insert" />
    &nbsp;
    <asp:LinkButton ID="InsertCancelButton" runat="server" CausesValidation="False"
        CommandName="Cancel" Text="Cancel" /> 
```

这是将业务类设置为 ObjectDataSource1 的示例存储库类

```
 public class AccountRepo
    {
        private static Model.Account _account;
        public void Delete(Model.Account acct)
        {
            _account = new Model.Account();
        }

        public Model.Account Update(Model.Account acct)
        {
            _account = acct;
            return _account;
        }

        public Model.Account Insert(Model.Account acct)
        {
            _account = new Model.Account() { Name = "new" };
            return _account;
        }

        public Model.Account Select()
        {
            if (_account == null)
                _account = new Model.Account() { Name = "BrandNew" };

            return _account;
        }

    } 
```

这是帐户类

```
 public class Account
    {
        public string Name { get; set; }
        public string Address {get;set;}

        public static Account CreateAccount(){
            return new Account();
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:25:57.683

在此页面上找到解决方案。做作者的建议，它的工作原理。 [http://www.developerfusion.com/code/4721/dynamically-loading-an-ibindabletemplate/](http://www.developerfusion.com/code/4721/dynamically-loading-an-ibindabletemplate/)

# php - PHP OOP连接mysql在启动对象后不起作用

> ID：15114077
> 
> 赞同：-1
> 
> 时间：2013-02-27T14:05:28.543
> 
> 标签：php, mysql

在 oop php 中，我创建了构造函数 mysql 连接（我知道它会被弃用，您建议使用 PDO 等等），但我遇到了问题。连接已建立，一切正常。但是插入不能做不知道为什么，代码一直运行到最后。似乎该对象没有连接，但它不可能。我使用 PHP 5.4.3。代码如下：

```
Table (Coach):
Coach_id INT (AutoIncrement)
Coach_name char(30)
Coach_nationality char(30)

class League 
{
    public $con;

    public function MySQLCon()
    {
    $this->con = mysql_connect("localhost","root","") or mysql_error($this->con);
    mysql_select_db("basket",$this->con) or mysql_error($this->con);
    return $this->con;
    }

    public $coach,$coachNationality;

    public function NewCoach($coach,$coachNationality)
    {

        $this->coach = $coach;
        $this->coachNationality = $coachNationality;

        $Query = "insert into Coach_name (Coach_name,Coach_nationality) VALUES ('".$this->coach."','".$this->coachNationality."')";

        //this query doesn't do anything but prints yes
        mysql_query($Query,$this->con) or mysql_error($this->con);
        echo "yes";

    }
}

//no data about mike Brown in database, database engine InnoDB
$LG = new League;
$LG->MySQLCon();
$LG->NewCoach("Mike Brown","USA"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:22:06.430

首先开始使用错误消息：

```
class League 
{
    var $con;

    public function __construct()
    {
    $this->con = mysql_connect("localhost","root","") or die("No connection: " . mysql_error());
    mysql_select_db("basket",$this->con) or die("Database could not be selected: " . mysql_error($this->con));
    }

    public $coach,$coachNationality;

    public function NewCoach($coach,$coachNationality)
    {

        $this->coach = $coach;
        $this->coachNationality = $coachNationality;

        $Query = "insert into Coach_name (Coach_name,Coach_nationality) VALUES ('".$this->coach."','".$this->coachNationality."')";

        //this query doesn't do anything but prints yes
        mysql_query($Query,$this->con) or die(mysql_error($this->con));
        return true;    
    }
}

//no data about mike Brown in database, database engine InnoDB
$LG = new League;
if( $LG->NewCoach("Mike Brown","USA") ) echo "inserted, method NewCoach returned true"; 
```

编辑代码后；

1.  mysql_error 将接收的唯一参数是连接，而不是字符串。
2.  插入和选择中的字符串需要用引号 '' 或 "" 括起来。
3.  mysql_query的第二个参数应该是连接
4.  开始使用 PDO 或 mysqli 而不是 mysql，因为它将在未来的版本中从 PHP 中删除，并且已经被认为是过时的实践。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:11:19.937

您的查询是错误的，您需要对字符串使用单引号：

```
"insert into Coach_name (Coach_name,Coach_nationality) VALUES ('".$this->coach."','".$coachNationality."')"; 
```

更好的是确保字符串中的单个 qoutes 被转义，如下所示：

```
... VALUES ('".mysql_real_escape_string($this->coach)."', .. 
```

但是你的代码很奇怪，可能会有更多错误

# build - 在 Cygwin 上构建 Riak

> ID：15114081
> 
> 赞同：2
> 
> 时间：2013-02-27T14:05:34.757
> 
> 标签：build, cygwin, riak

尝试在 Cygwin 上构建 Riak，但在构建 erlang_js > e_src 的 dep 时失败。我尝试了 2 种不同的 gcc，一种在 cygwin 下打包，另一种在 mingw 下打包。我试图在两者之间切换，但在每种情况下都会出现不同类型的错误。我知道 Riak 在 Windows 上不是“官方”支持的，但我宁愿尝试这样做，也不愿用 ubuntu 等运行虚拟机。这只是为了帮助我学习 Riak，而不是用于生产环境。这是我尝试从 Basho 的 github repo 克隆的 Riak 1.3 发布时遇到的初始错误：

```
user1@mycomputer ~/riak
$ make rel
./rebar get-deps
==> Entering directory `c:/cygwin/home/user1/riak'
==> Entering directory `c:/cygwin/home/user1/riak/deps/lager_syslog'
==> Entering directory `c:/cygwin/home/user1/riak/deps/lager'
==> lager (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/lager'
==> Entering directory `c:/cygwin/home/user1/riak/deps/syslog'
==> syslog (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/syslog'
==> lager_syslog (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/lager_syslog'
==> Entering directory `c:/cygwin/home/user1/riak/deps/cluster_info'
==> cluster_info (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/cluster_info'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_kv'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_core'
==> Entering directory `c:/cygwin/home/user1/riak/deps/poolboy'
==> poolboy (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/poolboy'
==> Entering directory `c:/cygwin/home/user1/riak/deps/protobuffs'
==> Entering directory `c:/cygwin/home/user1/riak/deps/meck'
==> meck (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/meck'
==> protobuffs (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/protobuffs'
==> Entering directory `c:/cygwin/home/user1/riak/deps/basho_stats'
==> basho_stats (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/basho_stats'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_sysmon'
==> riak_sysmon (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_sysmon'
==> Entering directory `c:/cygwin/home/user1/riak/deps/webmachine'
==> Entering directory `c:/cygwin/home/user1/riak/deps/mochiweb'
==> mochiweb (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/mochiweb'
==> webmachine (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/webmachine'
==> Entering directory `c:/cygwin/home/user1/riak/deps/folsom'
==> Entering directory `c:/cygwin/home/user1/riak/deps/bear'
==> bear (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/bear'
==> folsom (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/folsom'
==> riak_core (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_core'
==> Entering directory `c:/cygwin/home/user1/riak/deps/erlang_js'
==> erlang_js (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/erlang_js'
==> Entering directory `c:/cygwin/home/user1/riak/deps/bitcask'
==> bitcask (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/bitcask'
==> Entering directory `c:/cygwin/home/user1/riak/deps/merge_index'
==> merge_index (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/merge_index'
==> Entering directory `c:/cygwin/home/user1/riak/deps/ebloom'
==> ebloom (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/ebloom'
==> Entering directory `c:/cygwin/home/user1/riak/deps/eper'
==> Entering directory `c:/cygwin/home/user1/riak/deps/getopt'
==> getopt (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/getopt'
==> eper (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/eper'
==> Entering directory `c:/cygwin/home/user1/riak/deps/eleveldb'
==> eleveldb (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/eleveldb'
==> Entering directory `c:/cygwin/home/user1/riak/deps/sext'
==> Entering directory `c:/cygwin/home/user1/riak/deps/edown'
==> edown (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/edown'
==> sext (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/sext'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_pipe'
==> riak_pipe (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_pipe'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_api'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_pb'
==> riak_pb (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_pb'
==> riak_api (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_api'
==> riak_kv (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_kv'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_search'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_search/apps/lucene_parser'
==> lucene_parser (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_search/apps/lucene_parser'
==> riak_search (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_search'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riak_control'
==> Entering directory `c:/cygwin/home/user1/riak/deps/erlydtl'
==> erlydtl (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/erlydtl'
==> riak_control (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riak_control'
==> Entering directory `c:/cygwin/home/user1/riak/deps/riaknostic'
==> riaknostic (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/riaknostic'
==> Entering directory `c:/cygwin/home/user1/riak/rel'
==> rel (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak/rel'
==> riak (get-deps)
==> Leaving directory `c:/cygwin/home/user1/riak'
./rebar compile
==> Entering directory `c:/cygwin/home/user1/riak'
==> Entering directory `c:/cygwin/home/user1/riak/deps/lager_syslog'
==> Entering directory `c:/cygwin/home/user1/riak/deps/lager'
==> lager (compile)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/lager'
==> Entering directory `c:/cygwin/home/user1/riak/deps/syslog'
==> syslog (compile)
Compiling c_src/syslog_drv.c
This version of C:\cygwin\bin\cc.exe is not compatible with the version of Windows you're running. Check your computer's system information to see whether you need a x86 (32-bit) or x64 (64-bit) version of the program, and then contact the software publisher.
ERROR: cmd /q /c cc -c  -g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   c_src/syslog_drv.c -o c_src/syslog_drv.o failed with error: 1 and output:
This version of C:\cygwin\bin\cc.exe is not compatible with the version of Windows you're running. Check your computer's system information to see whether you need a x86 (32-bit) or x64 (64-bit) version of the program, and then contact the software publisher.

Makefile:8: recipe for target `compile' failed
make: *** [compile] Error 1

user1@mycomputer ~/riak 
```

在更改为 MingW 时，我收到以下错误：

```
user1@mycomputer ~/riak
$ export PATH=/cygdrive/f/Tools/MinGW/bin:$PATH

user1@mycomputer ~/riak
$ ./rebar compile
==> Entering directory `c:/cygwin/home/user1/riak'
==> Entering directory `c:/cygwin/home/user1/riak/deps/lager_syslog'
==> Entering directory `c:/cygwin/home/user1/riak/deps/lager'
==> lager (compile)
==> Leaving directory `c:/cygwin/home/user1/riak/deps/lager'
==> Entering directory `c:/cygwin/home/user1/riak/deps/syslog'
==> syslog (compile)
Compiling c_src/syslog_drv.c
c_src/syslog_drv.c:1:0: warning: -fPIC ignored for target (all code is position independent) [enabled by default]
c_src/syslog_drv.c:25:20: fatal error: syslog.h: No such file or directory
compilation terminated.
ERROR: cmd /q /c cc -c  -g -Wall -fPIC  -If:/Tools/erl5.9/lib/erl_interface-3.7.6/include -If:/Tools/erl5.9/erts-5.9/include   c_src/syslog_drv.c -o c_src/syslog_drv.o failed with error: 1 and output:
c_src/syslog_drv.c:1:0: warning: -fPIC ignored for target (all code is position independent) [enabled by default]
c_src/syslog_drv.c:25:20: fatal error: syslog.h: No such file or directory
compilation terminated. 
```

似乎有一个丢失的`syslog.h`文件或没有以其他方式引用/链接的文件。请帮我解决这个问题。

更新----如果我从`rebar.config`文件@riak根级别删除系统日志的dep，我会收到以下错误（使用MinGW）：

```
==> erlang_js (compile)
make[1]: Entering directory `c:/cygwin/home/user1/riak/deps/erlang_js'
cd c_src; make
make[2]: Entering directory `C:/cygwin/home/user1/riak/deps/erlang_js/c_src'
gunzip -c nsprpub-4.8.tar.gz | tar xf -
patching file nsprpub/configure.in
patching file nsprpub/configure
patching file nsprpub/lib/tests/Makefile.in
patching file nsprpub/pr/src/misc/prnetdb.c
(cd C:/cygwin/home/user1/riak/deps/erlang_js/c_src/nsprpub && \
 ./configure --disable-debug --enable-optimize \
                     --prefix=C:/cygwin/home/user1/riak/deps/erlang_js/c_src/system --disable-64bit && \
         F:/Tools/MinGW/bin/make all install)
: invalid feature nameg
make[2]: *** [C:/cygwin/home/user1/riak/deps/erlang_js/c_src/system/lib/libnspr4.a] Error 1
make[2]: Leaving directory `C:/cygwin/home/user1/riak/deps/erlang_js/c_src'
make[1]: *** [c_src] Error 2
make[1]: Leaving directory `c:/cygwin/home/user1/riak/deps/erlang_js'
ERROR: Command [compile] failed!
make: *** [compile] Error 1 
```

# linux - Shell 读取多余的换行符

> ID：15114083
> 
> 赞同：2
> 
> 时间：2013-02-27T14:05:37.550
> 
> 标签：linux, shell, unix

我有一个文本文件：

```
A1   A2
B1   B2 
```

我使用脚本一一读取值

```
cat $TXT | while read FILE
do
DATA1=`(echo $FILE | cut -d' ' -f1)`
DATA2=`(echo $FILE | cut -d' ' -f2)`
done 
```

但是 DATA2 将读取额外的 \n 字符示例：DATA2 = A2\n。

如何在不获取额外字符的情况下读取数据？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:10:15.217

```
while read DATA1 DATA2 REST
do
    # DATA1 and DATA2 are already set now
done < "$TXT" 
```

*这具有额外的优势，即每行输入*产生的进程更少。也就是说，我的方式产生零进程，而你的方式产生 4N + 1 之类的东西。

# jsf-2 - UI 重复 varStatus 在 CompositeComponent 中不起作用

> ID：15114086
> 
> 赞同：2
> 
> 时间：2013-02-27T14:05:46.997
> 
> 标签：jsf-2, el, composite-component

我在 WebSphere Application Server 8 上使用 JSF 2.0 (Apache myFaces)。

我有一个包含图表列表（jquery HighCharts 的数据）的 bean。对于每个图表，我需要一些 JSF 组件 + 一个写成 CompositeCompoent 的 Highchart Wrapper（[看这里](http://kevindoran1.blogspot.de/2012/12/using-highcharts-in-jsf.html)）

所以我像这样使用 jsf 2 的 ui:repeat 函数：

```
<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:hc="http://java.sun.com/jsf/composite/chartComponents"
    template="/template/mytemplate.xhtml">

    <ui:define name="content">

        <ui:repeat value="#{chartCtrl.charts }" var="chart" id="chartrepeat" varStatus="chartStatus">
                #{chartStatus.index }
                <h:form id="chartform_#{chartStatus.index }">

                    <!-- some jsf select stuff-->               
                </h:form>

                    #{chartStatus.index }
                    <hc:Chart title="Statistics" id="hcchart_#{chartStatus.index }"
                    <!-- here's the problem-->

                        <ui:repeat value="#{chart.series }" var="serie">
                            <hc:ChartSeries series="#{serie.data }" />
                        </ui:repeat>
                    </hc:Chart>
                    #{chartStatus.index }
            </p:panel>
        </ui:repeat>

        <h:outputScript library="js" name="highcharts.js" />
        <h:outputScript library="js/modules" name="exporting.js" />
        <h:outputScript library="js" name="jquery-1.9.1.min.js" target="head" />

    </ui:define>
</ui:composition> 
```

#{chartStatus.index } 在任何地方都有效，但在 hc:Chart id="" 中无效。这个 CC 生成的 js 和 div 包含 id 'hcchart_chartdiv'。当前重复左的索引。

如何将正确的数字传递给 id 属性？

编辑：复合组件

这是 hc:Chart 的一部分，应该使用 ID

```
<cc:implementation>
    <div id="#{cc.id}_chartDiv" />

        <!-- Highcharts -_>
    <script type="text/javascript">
        $(function() {
            // Data must be defined WITHIN the function. This prevents
            // different charts using the same data variables.
            var options = {
                credits : {
                    enabled : false
                },
                chart : {
                    renderTo : '#{cc.id}_chartDiv',
            ....
        </script> 
```

当我将 hc:Chart 中的属性 ID 留空时，生成的 ID 类似于“j_id568185923_1_5f9521d0_chartDiv”。但仍然没有:row:。

编辑 2：IndexOf Approach 我测试了另一种设置图表 ID 的方法。

```
id="hc_#{chartCtrl.charts.indexOf(chart) }" 
```

我尝试使用我的 ArrayList 的 IndexOf 方法。我在所有类中实现了 HashCode 和 Equals 方法。当我测试它时，它工作正常。但是当我将它与 EL 一起使用时，我得到 -1 返回。

**解决方案** 正如 BalusC 所说，我不能为 EL 使用 ID 标签。所以我简单地在我的 CC 中创建了一个新属性。这很好用（就是这么简单）。

谢谢BalusC。

有人有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:15:22.000

该`id`属性在视图构建期间进行评估。这`<ui:repeat varStatus>`是*在*视图构建时间之后的视图渲染时间期间设置的。本质上，您遇到的问题与此处详细解释的问题相同：[JSF2 Facelets 中的 JSTL ... 有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

属性中的任何 EL 表达式`id`必须在视图构建期间可用。如果在视图构建期间替换`<ui:repeat>`为运行，则必须正确设置。另一种方法是在那些基于. JSF**已经**自动为子组件的 ID添加了行索引的后缀。`<c:forEach>``id``id``<ui:repeat varStatus>`**`<ui:repeat>`**

 **请注意，`<c:forEach>`当与视图范围的 bean 和启用的部分状态保存结合使用时，可能会产生无法预料的副作用。有关详细信息，请参阅前面链接的答案。**

# javascript - 如何在 JavaScript 中捕获 dragend 事件？

> ID：15114090
> 
> 赞同：6
> 
> 时间：2013-02-27T14:05:55.200
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-draggable

我正在尝试在 JavaScript 中为可拖动的 DIV 捕获 dragend 事件。dragend 事件根本没有触发，为什么？以及如何解决这个问题？PS，我使用 .draggable() 方法来自：jQuery UI 1.9.2

这是我的代码：http: [//jsfiddle.net/vBMav/](http://jsfiddle.net/vBMav/)

HTML：

```
<div id="divId"> ... </div> 
```

CSS：

```
#divId {
    background-color: #000000;
    color: #ffffff;
    height: 200px;
    width: 200px;
} 
```

Javascript：

```
$('#divId').draggable(); 

$('#divId')
    .bind('dragstart', function(){ $("#divId").text("drag start"); })
    .bind('drag',      function(){ $("#divId").text("dragging");   })
    .bind('dragend',   function(){ $("#divId").text("drag ended"); }); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-27T14:13:28.627

尝试使用`dragstop`而不是`dragend`

```
.bind('dragstop',   function(){ $("#divId").text("drag ended");}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-10T22:49:12.107

**在 JavaScript 和 jQuery**中，当用户停止拖动光标时，触发的事件是：`dragend`.

**在 jQuery UI**中，调用 后`.draggable();`，当用户停止拖动光标时，触发的事件变为：`dragstop`。（小演示显示在[不调用](https://jsbin.com/qiwuvez/edit?html,css,js,console,output)[时 dragstop 不再有效`.draggable()`](https://jsbin.com/qiwuvez/edit?html,css,js,console,output)。 ）

*文档...*

**JavaScript** - `dragend`：在 google 上搜索这个会产生大约 100,000 个搜索结果，所以这很可能是您将使用的。来源：[**MDN Web 文档：文档：dragend 事件**](https://developer.mozilla.org/en-US/docs/Web/API/Document/dragend_event)

**jQuery UI** - `dragstop`：截至 2020 年 8 月，在 Google 上搜索“jQuery UI Dragstop”只会产生 5,000 个搜索结果。我几乎找不到任何提及它的内容，但它在**[官方 jQuery UI 文档：Draggable Widget](https://api.jqueryui.com/1.11/draggable/)**中有。

# c++ - 尝试使用 dynamic_cast 时获取“源类型不是多态的”

> ID：15114093
> 
> 赞同：81
> 
> 时间：2013-02-27T14:05:58.800
> 
> 标签：c++, c++11

```
struct A {};

struct B : A {};

int main()
{
    A* a = new B();

    B* b = dynamic_cast<B*>(a);
} 
```

给出：

> [不能 dynamic_cast 'a'（'struct A*' 类型）到类型 'struct B*'（源类型不是多态的）](https://ideone.com/wxHBB3)

我怎样才能使`A`多态？我想安全地将它投射到 B.

（一种方法是添加一个虚拟虚函数，但有更好的方法吗？）

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2013-02-27T14:07:12.690

您需要进行`A`多态，您可以通过添加`virtual`析构函数或任何虚函数来实现：

```
struct A {
  virtual ~A() = default;
}; 
```

或者，在 C++11 之前，

```
struct A {
  virtual ~A() {}
}; 
```

请注意，如果您打算通过指向基的指针安全地对派生类型的实例调用 delete，则多态类型无论如何都应该具有虚拟析构函数。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-27T14:07:09.987

您至少需要一个`virtual`函数 - 通常，如果没有其他函数合适，析构函数：

```
struct A {
   virtual ~A() {}
}; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-27T14:07:20.623

正如您的编译器所说，您的类型`A`不是多态的。您应该`virtual`为其添加一个功能。例如，`virtual`析构函数可能是一个不错的选择：

```
struct A { virtual ~A() { } };
//         ^^^^^^^ This makes A a polymorphic type

struct B : A {};

int main()
{
    A* a = new B();

    B* b = dynamic_cast<B*>(a); // Should work now
} 
```

# javascript - jQuery 根本无法使用我的 HTML？

> ID：15114094
> 
> 赞同：3
> 
> 时间：2013-02-27T14:06:08.730
> 
> 标签：javascript, jquery, html, css, apache

所以，我的 jQuery 没有做任何事情，无论是使用 apache 还是正常打开它时。（铬合金）

我将它链接到与我的 CSS 相连的 HTML 中，但它什么也没做。不完全确定这是因为我没有正确链接它还是什么。这是我所有的代码：（奖励问题：为什么锦标赛结果中的列表不在页面中心？）

非常感谢你们！

主页.html：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Niki Stoiber</title>
        <script type='text/javascript' src='http://localhost/Niki/script.js'></script>
        <link rel='stylesheet' type='text/css' href='stylesheet.css'/>
    </head>
    <body>
            <div id="navbar">
                <ul>
                    <a href="Home.html"><li class="pull-me">Home</li></a>
                    <a href="AboutMe.html"><li class="pull-me">About Me</li></a>
                    <a href="Tournaments.html"><li class="pull-me">Tournament Results</li></a>
                    <a href=""><li class="pull-me">Social Networks</li></a>
                </ul>
            </div>
            <br>
            <br>
            <div id="title">
                <h1 align="center">Niki Stoiber</h1>
            </div>
            <p>Hey there, my name is Niki Stoiber, and this is my Webpage!</p>
            <p>I am a 9 year old boy from Austria and I want to be a professional tennisplayer someday.</p>
    </body>
</html> 
```

关于我.html：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Niki Stoiber</title>
        <script type='text/javascript' src='script.js'></script>
        <link rel='stylesheet' type='text/css' href='stylesheet.css'/>
    </head>
    <body>
        <div id="navbar">
            <ul>
                <a href="Home.html"><li class="pull-me">Home</li></a>
                <a href="AboutMe.html"><li class="pull-me">About Me</li></a>
                <a href="Tournaments.html"><li class="pull-me">Tournament Results</li></a>
                <a href=""><li class="pull-me">Social Networks</li></a>
            </ul>
        </div>
        <br>
        <br>
        <div id="title">
                <h1 align="center">About Me</h1>
        </div>
        <div align="center">
            <p>
            Age: 9 <br>
            Birthday: 14.4.2003 <br>
            Tennis Club I play for: <a href="http://better-tennis.at"> Better Tennis <br>
            <img src="http://bit.ly/WpoXB1"/></a>
            </p>
        </div>
    </body>
</html> 
```

锦标赛.html：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Niki Stoiber</title>
        <script type='text/javascript' src='script.js'></script>
        <link rel='stylesheet' type='text/css' href='stylesheet.css'/>
    </head>
    <body>
            <div id="navbar">
                <ul>
                    <a href="Home.html"><li class="pull-me">Home</li></a>
                    <a href="AboutMe.html"><li class="pull-me">About Me</li></a>
                    <a href="Tournaments.html"><li class="pull-me">Tournament Results</li></a>
                    <a href=""><li class="pull-me">Social Networks</li></a>
                </ul>
            </div>
            <br>
            <br>
            <div id="title">
                <h1 align="center">Tournament Results</h1>
            </div>
            <div id="navbar">
                <ul>
                    <li>
                        Anif, Salzburg: 9\. Platz
                    </li>
                    <li>
                        Goetzis, Vorarlberg: 1\. Platz
                    </li>
                    <li>
                        Imst, Tirol: 2\. Platz
                    </li>
                </ul>
            </div>
    </body>
</html> 
```

样式表.css：

```
* {
    width:auto;
    height:auto;
    background-color:#D3D3D3;
    font-family:"Lintel", sans-serif;
}
@font-face {
    font-family: "Lintel";
    src: url("./Lintel.ttf") format("truetype");
}
#navbar {
    position:fixed;
    left:50%;
    margin-left:-254px;
}
ul {
    vertical-align:auto;
    list-style-type:none;
    position:fixed;
    margin:-5px;
    text-align:center;
}
.AboutMe {
    font-family:"Lintel", Sans-serif;
}
ul a li {
    background-color:#2F4F4F;
    color:#FFFFFF;
    border-radius:5px 5px;
    border:solid black;
    font-family:"Lintel", Sans-serif;
    display:inline;
    padding:5px;
    z-index:1;
    opacity: 0.5;
}
#title {
    z-index:2;
}
a:link {
    text-decoration:none;
    color:black;
}
a:visited {
    text-decoration:none; 
    color:black;
}
a:focus {
    text-decoration:none; 
    color:black;
}
a:hover {
    text-decoration:none; 
    color:black;
}
a:activ {
    text-decoration:none; 
    color:black;
}
h1 {
    text-align:center;
    position:relative;
}
p {
    text-align:center;
    position:relative;
} 
```

脚本.js：

```
$(document).ready(function() {
    $('a').mouseenter(function(){
        $(this).fadeTo('slow', 1);
    });
    $('a').mouseleave(function() {
        $(this).fadeTo('slow', 0.5)
    })
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:10:02.207

您正在使用 jQuery（ $ 部分）而没有首先包含 jQuery 库。推荐的方法是通过 Google Libs

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

至于另一个问题，您为什么希望列表居中？我没有看到任何代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T14:10:20.640

看来您忘记导入 jQuery 库了。添加这个

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

在你的头标签内

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T14:12:22.947

改变

```
<script type='text/javascript' src='script.js'></script>
<link rel='stylesheet' type='text/css' href='stylesheet.css'/> 
```

到

```
<link rel='stylesheet' type='text/css' href='stylesheet.css'/>
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
<script type='text/javascript' src='script.js'></script> 
```

# jquery - 悬停时的jQuery动画精灵

> ID：15114095
> 
> 赞同：1
> 
> 时间：2013-02-27T14:06:10.390
> 
> 标签：jquery, jquery-animate

我只是想弄清楚是否可以在有油漆标记的地方实现某些目标，该标记当前用作导航列表项下方的背景图像。

`div`是否可以为在底部重叠的次要设置动画`li`，从而在背景图像上创建显示效果，使其看起来好像图像从左到右出现，直到线条完全显示？当你悬停时，有点像一个不断增长的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:46:16.510

您也可以尝试挖掘 SpriteOnHover jquery 插件。

它有一些你可以使用的参数，而且它是轻量级的，所以它可能是值得的。你可以在这里得到它[http://apolinariopassos.com.br/dev/sprite-on-hover-jquery-plugin/](http://apolinariopassos.com.br/dev/sprite-on-hover-jquery-plugin/)

用法是`$('#yourSprite').spriteOnHover();` 这将使插件工作这个默认参数，它指向这个：

```
$('#yourSprite').spriteOnHover({fps:30, orientation:"horizontal", rewind: true, loop: false, autostart:false;repeat:true}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:24:54.980

您可以使用 jQuery 为`background-position-x`和`background-position-y`属性设置动画。

我没有任何代码可以向您展示，但这是一个示例。

```
$('#element-to-animate').animate({
    'background-position-x': '10%',
    'background-position-y': '20%'
}, 1500, 'linear'); 
```

# ruby-on-rails - 迭代方法数组时使用未定义的方法

> ID：15114101
> 
> 赞同：0
> 
> 时间：2013-02-27T14:06:26.833
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我是一名 Rails 初学者，并试图在模型中添加一些代码。下面的代码是一个插图。

看法：

```
Player_stats: <%= @player.player_pass_completion_ratio %> 
```

模型：

```
class Player < ActiveRecord::Base
 has_many :lefthandstats
 has_many :righthandstats

def player_pass_completion_ratio
 Hands = [ lefthandstats, righthandstats] #These are objects & calling   @player.lefthandstats.find_with_passes directly generally works

 if self.category ==  "Hands"
  total_usual_passes = 500
  Hands.each do |cmethod|
    if self.cmethod.find_with_passes(:passes, :first, {:conditions => 'passes>200' })   then accuratestats += 1 end
  end
 end

accuracy = (accuratestats/total_usual_passes)*100
end 
```

当我尝试从视图调用代码时，我得到一个未定义的方法“cmethod”。任何意见是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:09:50.670

ruby 中的注释使用`#`字符，而不是`//`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:09:22.597

摆脱“self.cmethod”，只使用“cmethod”

```
if cmethod.find_with_passes.... 
```

在块的范围内，“cmethod”只是一个局部变量。通过将 self 放在它前面，ruby 假设您正在调用包含类实例的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:11:04.740

您的代码正在调用`self.cmethod`，它将尝试调用`cmethod`您的对象（不存在）上的方法。

我相信您正在尝试做的事情如下：

```
hands = [:lefthandstats, :righthandstats]
hands.each do |cmethod|
  self.send(cmethod).... #rest of your code goes here
end 
```

这将动态调用对象上的`lefthandstats`and`righthandstats`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:15:12.633

首先更正您的代码，方法是替换`//`为`#`我们`#`用来注释 akofink 提到的代码的rails。

然后在您的代码上下文中考虑这一点：

```
@result = Player.all

@result.each do |player|

player.name

end 
```

这`@result`是返回的玩家集合。所以你可以使用一个循环，`@result.each`这样对于作为玩家的每个结果，你都会得到每个玩家的名字。

了解以上内容，更正您的代码。

# android - 如何找出哪个应用程序正在后台访问电话联系人？

> ID：15114103
> 
> 赞同：0
> 
> 时间：2013-02-27T14:06:38.943
> 
> 标签：android, contacts, contactscontract, android-contentresolver

我搜索了很多，但没有发现任何有用的东西。我创建了一个示例应用程序，它将读取和写入联系人并检查 Android 日志，但没有发现任何意图或任何显示我的联系人正在被应用程序访问的东西。（我使用了**内容解析器**

阅读联系方式

```
Cursor phones = getContentResolver().query(
                    ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null, null,
                    null, null); 
```

并写信给联系人

```
ArrayList < ContentProviderOperation > ops = new ArrayList < ContentProviderOperation > ();
                 ops.add(ContentProviderOperation.newInsert(
                 ContactsContract.RawContacts.CONTENT_URI)
                     .withValue(ContactsContract.RawContacts.ACCOUNT_TYPE, null)
                     .withValue(ContactsContract.RawContacts.ACCOUNT_NAME, null)
                     .build());) 
```

我可以在安装时检查应用程序权限，但我想在我的联系人被其他应用程序访问时捕获事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:28:40.790

你不能这样做。他们的 Android 系统不允许任何应用程序监视另一个应用程序的活动。您最接近的方法是检查并列出所有具有`android.permission.READ_CONTACTS`权限的应用程序。

# xml - xslt：使用单引号（撇号）作为分隔符生成 xml 属性值

> ID：15114106
> 
> 赞同：0
> 
> 时间：2013-02-27T14:06:41.590
> 
> 标签：xml, xslt, delimiter, apostrophe

xslt 处理似乎总是生成带有双引号作为分隔符的属性值。
输入xml：

```
<a b='"c"' /> 
```

输出xml：

```
<a b="&quot;c&quot;"/> 
```

我必须生成带有撇号的 XML 文件作为电话设备的属性值分隔符。此设备只接受带有撇号和双引号的属性值作为分隔符。例如：

```
<SYMB_ITEM ID="BS_Accounts.astAccounts[0].aucAccountName[0]"
class="symb_item" value='"test_3"'/> 
```

是否可以使用 xslt (xlstproc) 将撇号作为属性值的分隔符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:27:05.900

我不确定我是否正确理解了您的问题：将输出设置为“文本”有帮助吗？

```
<xsl:output method="text" encoding="utf-8" indent="no"/> 
```

示例 XSLT 工作表：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="text" encoding="utf-8" indent="no"/>

  <xsl:template match="/">
    <xsl:apply-templates />
  </xsl:template>

  <xsl:template match="a">
    &lt;a b='<xsl:value-of select="@b"/>'&gt;
  </xsl:template>                      
</xsl:stylesheet> 
```

对于以下 XML 文件：

```
<xml>
  <a b='"c"' />   
  <a b='"x"' />
</xml> 
```

产生（我认为）预期的效果：

```
<a b='"c"'>
<a b='"x"'> 
```

# php - 无法从 MySQL 表中检索数据

> ID：15114109
> 
> 赞同：0
> 
> 时间：2013-02-27T14:06:51.730
> 
> 标签：php, mysql, sql

首先，我是 php 新手。我也是 MySQL 的新手，所以对我要温柔。其次，我知道 mysql_* 已贬值，一旦我了解更多，这将在稍后修复。

所以我有以下代码：

```
 if(isset($_POST['email']) && !empty($_POST['email']) AND isset($_POST['password']) && !empty($_POST['password'])){
            $email = mysql_escape_string($_POST['email']);
            $password = mysql_escape_string($_POST['password']);

            $search = mysql_query("SELECT * FROM users WHERE email='".$email."' AND password='".$password."' AND active='1'") or die(mysql_error()); 
            $match  = mysql_num_rows($search);

            if($match > 0){
                $user=$search['forename'] .' '.$search['surname'];
                $_SESSION['username']=$user;
                $msg = 'Login Complete! Thanks, '.$user.'!';
            }else{
                $msg = 'Login Failed!<br /> Please make sure that you enter the correct details and that you have activated your account.';
            }
        } 
```

很简单，我正在检查电子邮件和密码是否匹配（我知道这不是散列密码……再说一次，这不是问题，因为它是一个测试）。如果他们这样做了，并且帐户已被激活，那么我想返回用户的名字和姓氏（用户表中的名字/姓氏）并将它们存储在会话变量中。如果该变量 isset，我想使用此信息来确认用户已登录（因此可以访问某些页面）。但是，此测试不返回用户名，而是输出：

> 登录完成！谢谢， ！

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:10:51.183

请记住返回的值`mysql_query`是资源，因此您需要将结果行作为关联数组获取。

```
while ($row = mysql_fetch_assoc($search)) 
{
    $user=$row['forename'] .' '.$row['surname'];
    $_SESSION['username']=$user;
} 
```

作为旁注，[`SQL Injection`](http://bobby-tables.com/)如果变量的值（*s*）来自外部，则查询很容易受到攻击。请看下面的文章，了解如何预防。通过使用`PreparedStatements`，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:10:48.563

你需要做`$row = mysql_fetch_array($search);`

进而

```
$user=$row['forename'] .' '.$row['surname']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:14:09.990

你替换你的代码 / ***** ** *** ** *** ** *** ******你的代码****** ***** / if(isset($_POST['email']) && !empty($_POST['email']) AND isset($_POST['password']) && !empty($_POST['password'])){ $email = mysql_escape_string($_POST['email']); $password = mysql_escape_string($_POST['password']);

```
 $search = mysql_query("SELECT * FROM users WHERE email='".$email."' AND password='".$password."' AND active='1'") or die(mysql_error()); 
        $match  = mysql_num_rows($search);

        if($match > 0){
            $user=$search['forename'] .' '.$search['surname'];
            $_SESSION['username']=$user;
            $msg = 'Login Complete! Thanks, '.$user.'!';
        }else{
            $msg = 'Login Failed!<br /> Please make sure that you enter the correct details and that you have activated your account.';
        }
    } 
```

到

/ ***** ** *** ** *** ** *** ******我的代码****** ***** /

```
 if(isset($_POST['email']) && !empty($_POST['email']) AND isset($_POST['password']) && !empty($_POST['password'])){
        $email = mysql_escape_string($_POST['email']);
        $password = mysql_escape_string($_POST['password']);

        $search = mysql_query("SELECT * FROM users WHERE email='".$email."' AND password='".$password."' AND active='1'") or die(mysql_error()); 
        $match  = mysql_num_rows($search);

        if($match > 0){
            $search = mysql_fetch_array($search); 
            $user=$search['forename'] .' '.$search['surname'];
            $_SESSION['username']=$user;
            $msg = 'Login Complete! Thanks, '.$user.'!';
        }else{
            $msg = 'Login Failed!<br /> Please make sure that you enter the correct details and that you have activated your account.';
        }
    } 
```

# php - csv 到数组覆盖数据

> ID：15114114
> 
> 赞同：0
> 
> 时间：2013-02-27T14:07:03.047
> 
> 标签：php, arrays, csv

我想用标题作为键的 csv 文件制作一个数组。但是当我将脚本插入数据库时​​，它会覆盖 csv 文件的前一行，并且只有最后一个值存储在数据库中。

我认为这是因为数组的默认值为 5。如何更改该值以创建新值？

这是脚本

```
<?php

// open the file.

if (($handle = fopen("test2.csv", "r")) !== FALSE) {
    // read the column headers in an array.
    $head = fgetcsv($handle, 1000, ";");

    // read the actual data.
    while (($data = fgetcsv($handle, 1000, ";")) !== FALSE) {

            // create a new array with the elements in $head as keys
            // and elements in array $data as values.
            $combined = array_combine($head,$data);

            // print.
            var_dump($combined);
    }
    // done using the file..close it,
}
?> 
```

这是输出

> array(5) { ["name"]=> string(5) "Harry" ["description"]=> string(4) "test" ["offer_url"]=> string(42) "demo.com/admin /offers/add" ["preview_url"]=> string(42) "demo.com/admin/offers/add" ["expiration_date"]=> string(9) "23-8-2013" }
> 
> array(5) { ["name"]=> string(5) "Gerry" ["description"]=> string(4) "test" ["offer_url"]=> string(42) "demo.com/admin /offers/add" ["preview_url"]=> string(42) "demo.com/admin/offers/add" ["expiration_date"]=> string(9) "23-8-2013" }
> 
> array(5) { ["name"]=> string(5) "merry" ["description"]=> string(4) "test" ["offer_url"]=> string(42) "demo.com/admin /offers/add" ["preview_url"]=> string(42) "demo.com/admin/offers/add" ["expiration_date"]=> string(9) "23-8-2013" }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:31:55.407

您必须通过多维数组并向组合参数添加额外的索引，如下所示 - combine[]=...：

```
 // create a new array with the elements in $head as keys
            // and elements in array $data as values.
            $combined[] = array_combine($head,$data); 
```

# debugging - PostgreSQL：pgAdmin 调试器中的变量范围

> ID：15114115
> 
> 赞同：0
> 
> 时间：2013-02-27T14:07:05.980
> 
> 标签：debugging, postgresql, scope, pgadmin

我正在尝试了解 pgAdmin 调试器，并且对 PostgreSQL 相当陌生。我不知道我看到的行为是因为我犯了一个错误，还是仅仅因为调试器的限制。

在我的函数顶部，我声明了两个变量：

```
 declare tuple record;
   declare buffer text; 
```

在我的函数主体中，我试图迭代临时表 TT_CALENDAR 中的行，因此可以在 Locals 窗口中检查临时表的内容：

```
for tuple in
  select startdate, enddate from TT_CALENDAR
  loop
   buffer := concat(buffer, tuple.startdate::text, tuple.enddate::text,'|');
  end loop;

 buffer :=''; 
```

断点设置在`buffer := concat(...`和 处`buffer :='';`，程序执行按预期停止在那里，但是一旦我们退出循环并到达`buffer :='';`字符串值，就会从 Locals 窗口中消失。

为什么当我们在执行*之前* `buffer :='';`退出循环时，缓冲区显示的值会从 Locals 窗口中消失？就好像变量超出了范围。

PS 是否存在会导致长值包含在 Locals 窗口**值**单元格中的配置设置？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T06:19:51.413

这听起来确实像调试器的错误。我通常会建议跟进 pgadmin 电子邮件列表并提醒开发人员注意这个问题。

我没有理由知道变量会超出范围，所以在我看来，这听起来像是调试器本身的一个错误。

# html - 什么 API 返回 HTML5 友好的视频链接？

> ID：15114121
> 
> 赞同：1
> 
> 时间：2013-02-27T14:07:20.330
> 
> 标签：html, video

我想尝试在 HTML5 中嵌入视频 - 并检查一些具有不同内容的应用程序。

我在哪里可以找到带有相应元数据的在线视频的好集合？一个具有不错的查询/搜索/过滤 API 的集合会很棒！

**更新**：要测试一个应用程序，我需要至少 50 部电影可通过一个`<video>`标签播放，并提供标题、atrist 和标签。带有索引文件的可下载短片库也足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T22:52:52.750

TEDTalks RSS 怎么样？

*   用作播客的 TEDTalks 标准视频源。[http://feeds.feedburner.com/TEDTalks_video](http://feeds.feedburner.com/TEDTalks_video)

*   高分辨率的 RSS 提要。[http://feeds.feedburner.com/TedtalksHD](http://feeds.feedburner.com/TedtalksHD)

我认为 RSS 应该足够了，但如果你需要更多，你也可以尝试他们的 API：http: [//developer.ted.com/API_Docs](http://developer.ted.com/API_Docs)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-09T05:23:26.383

DailyMotion 有一个 API：[http](http://www.dailymotion.com/doc/api/graph-api.html) : //www.dailymotion.com/doc/api/graph-api.html Vimeo 有 API： http: [//developer.vimeo.com/apis](http://developer.vimeo.com/apis) 他们都可能需要一些摆弄才能获得实际的视频（例如对于 Vimeo [http://player.vimeo.com/external/.sd.mp4?s=](http://player.vimeo.com/external/)），但如果元数据收集很重要，这两者都会有所帮助，您可以播放 Sintel 视频

# javascript - 如何抵消和防止工具提示通过页面的底部边缘？

> ID：15114123
> 
> 赞同：1
> 
> 时间：2013-02-27T14:07:22.480
> 
> 标签：javascript, position, title, tooltip

我正在尝试找出要添加到此脚本中的内容，以防止工具提示超出页面底部的边缘。非常感谢任何帮助和您的时间，谢谢。

```
<!-------------SCRIPT---------------->

    <script>
    $(document).ready(function() {
            // Tooltip only Text
            $('.masterTooltip').hover(function(){
                    // Hover over code
                    var title = $(this).attr('title');
                    $(this).data('tipText', title).removeAttr('title');
                    $('<p class="tooltip"></p>')
                    .text(title)
                    .appendTo('body')
                    .fadeIn('slow');
            }, function() {
                    // Hover out code
                    $(this).attr('title', $(this).data('tipText'));
                    $('.tooltip').remove();
            }).mousemove(function(e) {
                    var mousex = e.pageX + 20; //Get X coordinates
                    var mousey = e.pageY + 10; //Get Y coordinates
                    $('.tooltip')
                    .css({ top: mousey, left: mousex })
            });
    });
    </script>

 <!--------------CSS------------------>   
    <style>
    .tooltip {
        display:none;
        position:absolute;
        border:1px solid #333;
        background-color:#161616;
        border-radius:5px;
        padding:10px;
        color:#fff;
        font-size:12px Arial;
    }
    </style>

<!------------------HTML----------------->    
    <a href="#" title="This will show up in the tooltip" class="masterTooltip">Your Text</a>
    <p title="Mouse over the heading above to view the tooltip." class="masterTooltip">Mouse over the heading text above to view it's tooltip.</p>
    <img src="image.jpg" class="masterTooltip" title="Tooltip on image" /> 
```

演示：http: [//jsfiddle.net/KP7mT/](http://jsfiddle.net/KP7mT/)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:29:29.837

您需要检查页面的高度，如果菜单的高度 + 菜单（顶部）的 Y 位置大于该高度，则调整菜单的顶部位置。

```
var boxX = e.pageX;
var boxY = e.pageY;
var menuHeight = $('.tooltip').outerHeight();
var bodyHeight = $('body').height();
if ((boxY + menuHeight) > bodyHeight){
    boxY = bodyHeight - menuHeight;
}
$('.tooltip').css({ top: boxY + 'px', left: boxX + 'px' }) 
```

# android - Logcat 中显示的时间

> ID：15114130
> 
> 赞同：44
> 
> 时间：2013-02-27T14:07:31.047
> 
> 标签：android, time, android-logcat

我需要以 hh:mm:ss:SS 格式获取 Android 设备时间戳。我可以查看 Eclipse 的 Logcat 中显示的时间。是电脑的时间还是安卓设备的时间？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-02-27T14:16:29.300

从[logcat 的文档中，](http://developer.android.com/tools/help/logcat.html)您可以看到有一个选项可以指定输出的格式（[-v](http://developer.android.com/tools/debugging/debugging-log.html#outputFormat)）。

要获取时间戳，可以使用命令

```
logcat -v time 
```

这将为每条消息添加时间戳。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-02-03T16:50:55.713

在终端中使用`adb logcat -v threadtime` 从设备获取日志，它将包括日期和时间。

如果要将这些日志重定向到文本文件中，请在终端中使用命令。

```
 adb logcat -v threadtime > folder_path_in_the_computer/filename.txt 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-27T14:15:13.387

如果您在 Android 设备上运行您的应用程序，那么它将打印设备的时间，如果在模拟器上，它将显示计算机的时间。

为确保将日志的时间与设备的时间和计算机的时间相匹配，您会找到答案。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-01-27T19:16:56.853

## 使用`long`,`threadtime`或`time`格式与`logcat -v <format>`

[`logcat`](https://developer.android.com/studio/command-line/logcat.html)有许多格式选项，可以`-v`在命令行中传递给标志。[您可以在此处](https://developer.android.com/studio/command-line/logcat.html#outputFormat)查看文档中的所有格式。

以下是每个选项的示例，因此您可以决定哪个选项适合您的需求：

* * *

### `brief`

显示发出消息的进程的优先级、标记和 PID。

```
D/StatusBar.NetworkController( 1222): refreshNwBoosterIndicator - setNWBoosterIndicators(false)
D/StatusBar.NetworkController( 1222): refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

### `long`

显示所有元数据字段并用空行分隔消息。

*（我最喜欢这个，但我很喜欢空白。）*

```
[ 01-27 13:17:07.703  1222: 1222 D/StatusBar.NetworkController ]
refreshNwBoosterIndicator - setNWBoosterIndicators(false)

[ 01-27 13:17:07.703  1222: 1222 D/StatusBar.NetworkController ]
refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

### `process`

仅显示 PID。

```
D( 1222) refreshNwBoosterIndicator - setNWBoosterIndicators(false)  (StatusBar.NetworkController)
D( 1222) refreshNwBoosterIndicator - setNWBoosterIndicators(false)  (StatusBar.NetworkController) 
```

* * *

### `raw`

显示没有其他元数据字段的原始日志消息。

```
refreshNwBoosterIndicator - setNWBoosterIndicators(false)
refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

### `tag`

仅显示优先级和标签。

```
D/StatusBar.NetworkController: refreshNwBoosterIndicator - setNWBoosterIndicators(false)
D/StatusBar.NetworkController: refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

### `thread`

显示发出消息的线程的优先级、PID 和 TID 的传统格式。

```
D( 1222: 1222) refreshNwBoosterIndicator - setNWBoosterIndicators(false)
D( 1222: 1222) refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

### `threadtime`

显示发出消息的线程的日期、调用时间、优先级、标记、PID 和 TID。

*（文档说这是默认设置，但在我的情况下并非如此。）*

```
01-27 13:17:07.703  1222  1222 D StatusBar.NetworkController: refreshNwBoosterIndicator - setNWBoosterIndicators(false)
01-27 13:17:07.703  1222  1222 D StatusBar.NetworkController: refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

### `time`

显示发出消息的进程的日期、调用时间、优先级、标记和 PID。

```
01-27 13:17:07.703 D/StatusBar.NetworkController( 1222): refreshNwBoosterIndicator - setNWBoosterIndicators(false)
01-27 13:17:07.703 D/StatusBar.NetworkController( 1222): refreshNwBoosterIndicator - setNWBoosterIndicators(false) 
```

* * *

**注意：**如果您在应用程序中使用它以编程方式收集用户的设备日志以发送给您的支持团队或其他任何东西，您需要省略 和 之间的空格`-v`，`format`如下所示：

```
commandLine.add( "-vlong" ) 
```

不知道为什么会这样，但希望这可以节省一些人试图弄清楚这一点的时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T14:18:24.360

取自开发者网站上的[读写日志：](http://developer.android.com/tools/debugging/debugging-log.html)

" **time** — 显示发布消息的进程的日期、调用时间、优先级/标签和 PID。"

在模拟器上，这将是您的计算机时间，在设备上，它将是您设备的时间......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T14:12:00.760

如果您以编程方式需要设备日期：

```
 SimpleDateFormat s = new SimpleDateFormat("hh:mm:ss");
    String format = s.format(new Date()); 
```

# java - 如何使用数组用fillPolygon替换字符串中的字符

> ID：15114134
> 
> 赞同：0
> 
> 时间：2013-02-27T14:07:39.613
> 
> 标签：java, arrays, string, replace, applet

我需要在文本框中输入一个单词/句子，然后打印出我输入的内容，但是当我有一个特殊字符时，它会打印出我的 fillPolygon 形状。我使用了一个数组来尝试使用 If 语句将字符替换为多边形，但是我不断收到错误消息：

```
[line: 49]  Error: method drawH in class Stringpoly cannot be applied to given types;  required: java.awt.Graphics,int,int  found:
java.awt.Graphics,int[],int[]  reason: actual argument int[] cannot be
converted to int by method invocation conversion 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:11:15.967

您需要`int`在方法中包含数组参数`drawH`以匹配传入的值。替换

```
public void drawH(Graphics g, int xpoints, int ypoints) 
```

和

```
public void drawH(Graphics g, int[] xpoints, int[] ypoints) 
```

另一个错误是：

的参数`drawString`与该方法的任何可用版本都不匹配：

```
g.drawString(pr_charArray[i]); 
```

查看此方法的[文档](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#drawString%28java.lang.String,%20int,%20int%29)。你需要类似的东西

```
g.drawString(new String(pr_charArray), xpos, ypos); 
```

另一个问题是您没有实例化或添加`pr_text` `TextField`in `init`。你可以这样做：

```
pr_text = new TextField(20);
add(pr_text); 
```

**一些旁注：**

*   Java 使用骆驼案例，这将使`pr_text` `prText`
*   `AWT`非常老。考虑使用轻量级[Swing 图形库](http://docs.oracle.com/javase/tutorial/uiswing/)。

有一些布局问题需要解决 - 我将把它作为练习 :)

# email - 找不到摆脱 HTML_TITLE_SUBJ_DIFF 的说明

> ID：15114135
> 
> 赞同：3
> 
> 时间：2013-02-27T14:07:42.247
> 
> 标签：email, spam, newsletter, email-spam, spamassassin

Outlook 2013 对我的时事通讯进行了一些测试，并为时事通讯提供了 3.9 的垃圾邮件分数（需要 5 分）。我不想让分数尽可能低，但我在“HTML_TITLE_SUBJ_DIFF”测试中找不到要做什么，而且没有地方写过测试是什么。

你有这方面的经验吗？

提前致谢。问候，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T19:39:26.463

挖掘 spamassassin-3.3.2 的配置和来源后：

html 中的标题长度似乎是电子邮件主题长度的 3.5 倍。

使 html 标题更短或电子邮件主题更长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:37:50.153

约翰 -

您始终可以手动重新评分规则。在你的 local.cf 文件中，你可以有这样的一行：

```
score HTML_TITLE_SUBJ_DIFF 0.0 
```

local.cf 中的分数会覆盖其他地方的所有分数。

# .net - .Net Secure Token Service (STS) 基于 Realm 发行不同的 Token

> ID：15114136
> 
> 赞同：2
> 
> 时间：2013-02-27T14:07:44.157
> 
> 标签：.net, wif, windows-identity

我已经实现了一个 .Net STS 网站，一切正常。令牌填充了角色类型的声明，这些声明用于控制用户在应用程序中可以访问的内容。

一个新的要求是需要有第二个应用程序，它是主要应用程序中功能的子集，它提供系统某些部分的只读视图。它还应该使用 Active Directory 身份验证，以便用户无需使用用户名和密码组合登录。

我已扩展 STS 网站以使用 Active Directory 对用户进行身份验证，并发出一个包含单个声明/角色的令牌，该声明/角色强制执行此只读视图。

这很好用，但是我的问题是用户很可能会同时使用这两个应用程序。发生这种情况时，令牌会填充更多角色，并且只读应用程序中的用户可以访问的权限超出其应有的权限。

我可以看到解决此问题的唯一方法是将辅助/只读应用程序配置为使用不同的安全令牌。

我的问题是.Net STS 是否可以做到这一点，如果可以，怎么做？

非常感谢，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:36:32.637

您使用 Visual Studio 添加的样板 Sts 不用于生产用途，如果您检查 Microsoft 文档说明，它说的是理智的事情，如果开发模板太多而无法列出，则列出。查看 adfs 2.0，您将开始看到可用于实现基于声明的系统的附加功能集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:22:14.240

如果您需要带有 AD 身份验证的 STS，您可能想看看[ADFS](http://msdn.microsoft.com/en-us/library/bb897402.aspx)，它很容易设置和配置。最新版本是[AD FS 2.0](http://technet.microsoft.com/en-us/evalcenter/ee476597.aspx)。

# html - Jenkins 中的故障安全 html 报告

> ID：15114138
> 
> 赞同：7
> 
> 时间：2013-02-27T14:07:47.487
> 
> 标签：html, maven, selenium, jenkins, maven-failsafe-plugin

我有一些使用故障安全 maven 插件运行的集成测试（使用 Selenium）。Failsafe 仅生成 XML 报告文件。

1) 我想生成 HTML 报告

2) 我想在 Jenkins 中有一个指向 html 报告的链接

对于 1) 我安装了“maven-surefire-report-plugin”来使用 failsafe-report-only 目标。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-report-plugin</artifactId>
  <version>2.13</version>
  <executions>
    <execution>
      <phase>post-integration-test</phase>
      <goals>
        <goal>failsafe-report-only</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

但在标准输出中，似乎没有生成任何内容：

```
[INFO] 
[INFO] >>> maven-surefire-report-plugin:2.13:failsafe-report-only (default) @ BaseContrats >>>
[INFO] 
[INFO] <<< maven-surefire-report-plugin:2.13:failsafe-report-only (default) @ BaseContrats <<<
[INFO] 
[INFO] --- maven-surefire-report-plugin:2.13:failsafe-report-only (default) @ BaseContrats --- 
```

在我的故障安全报告目录中，我只有 XML 报告文件，但没有 HTML 报告文件。

它是为故障安全生成 html 报告的好插件吗？

对于 2)，我安装了 Jenkins 插件“Selenium HTML 报告”并添加了构建后操作“发布 Selenium HTML 报告”并为“Selenium 测试结果位置”参数配置了“target/failsafe-reports”值，但没有显示在 Jenkins 界面中（肯定是因为我的 html 报告文件没有生成...）。

你能帮我解决这2点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-07-15T16:05:33.587

回答第 1 部分）为 Failsafe 生成 HTML 报告。

将以下内容添加到 pom.xml

```
<reporting>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-report-plugin</artifactId>
            <version>2.18.1</version>
            <configuration>
                <skipSurefireReport>${skipSurefireReport}</skipSurefireReport>
                <reportsDirectories>
                    <reportsDirectory>${basedir}/target/failsafe-reports</reportsDirectory>
                </reportsDirectories>
            </configuration>
        </plugin>
    </plugins>
</reporting>
<properties>
   <skipSurefireReport>true</skipSurefireReport>
</properties> 
```

我假设您正在使用 mvn verify 使用故障安全插件运行集成测试。默认情况下，这会在 {basedir}/target/failsafe-reports 中生成 ( `*.txt`& ) 报告。`*.xml`这应该在`<reportDirectories>`. 您可以指向任何包含 TEST-*.xml 报告的目录。

然后运行cmd

```
mvn site 
```

这将为 Failsafe 运行集成测试生成 html 报告。默认情况下，文件位于 {basedir}/target/site/failsafe-report.html 中。这个位置要改。

# python - 覆盖 matplotlib.artist.Artist 以绘制复杂形状

> ID：15114139
> 
> 赞同：0
> 
> 时间：2013-02-27T14:07:58.117
> 
> 标签：python, matplotlib

我想在 matplotlib 中创建一个艺术家，它可以绘制一个`compound`包含封装在 FancyBboxPatch 中的文本和图像的形状。我从前面提到的 FancyBboxPatch 派生了一个类并重写了“draw”方法，但它似乎不起作用。

我想要实现的是一个可由 matplotlib 绘制的对象，但比可用的简单补丁更复杂；有点像 GUI 设计中的复合小部件的概念。

这是我尝试过的：

```
class Cell(FancyBboxPatch):

    def __init__(self, xy, width, height, **kwargs):
        FancyBboxPatch.__init__(self, xy, width, height, **kwargs)

    def draw(self, renderer):
        print "Overridden draw method"
        FancyBboxPatch.draw(self, renderer)

        # Try drawing some simple patches and text:
        r = Rectangle((set._x, self._y), self._width, self._height)
        r.draw(renderer) # this doesn't draw

        t = Annotation("hi", (self._x, self._y))
        t.draw(renderer) # this causes an error 
```

但这不起作用。矩形不会被绘制，并且 Annotation 会引发错误：`AttributeError: 'NoneType' object has no attribute 'transData'`

我觉得我做错了！我可以用`draw`这种方式覆盖该方法吗？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:21:21.093

尝试这个：

*   首先，您应该尝试将 *args 添加到**init**参数中，并将其也传递给 FancyBboxPatch。**在里面**
*   覆盖绘图时，您应该在完成更改之后（或之前）调用原始绘图，因为它可能调用了一些您不知道的内部方法，请检查 FancyBboxPatch.draw 的源代码

[http://matplotlib.sourcearchive.com/documentation/0.99.3-1/patches_8py-source.html](http://matplotlib.sourcearchive.com/documentation/0.99.3-1/patches_8py-source.html)

正如我所看到的，FancyBboxPatch 是 Patch 的子类，它是 Artist 的子类，Patch 和 Artist 都有方法 draw，所以你不能简单地覆盖它们而不调用原始方法

编辑：我超级盲目，抱歉，您正在调用 draw 方法，但是将 *args 和 **kwargs 添加到任何覆盖的方法是一个好主意.. 尝试一下，也许调用 FancyBboxPatch.draw覆盖方法的结束

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-02T03:20:20.640

[重写类方法](https://blog.devzero.com/2013/01/28/how-to-override-a-class-method-in-python/)和[实例方法](http://blog.thedigitalcatonline.com/blog/2014/05/19/method-overriding-in-python/)时语法有所不同。它可能会帮助您解决问题。因此，对覆盖的“draw”方法的调用应该是：

```
super(Cell,self).draw(renderer) 
```

您的构造函数也是如此：

```
super(Cell,self).__init__(xy, width, height, **kwargs) 
```

# c - 用 C 代码编写二进制数系统

> ID：15114140
> 
> 赞同：45
> 
> 时间：2013-02-27T14:07:59.053
> 
> 标签：c

当我们`0x`为十六进制数和八进制数使用前缀时`0`，有什么可以为二进制数做的吗？

我尝试了`b`后缀，但[GCC](http://en.wikipedia.org/wiki/GNU_Compiler_Collection)不允许。

> 错误：整数常量上的后缀“b”无效

可能吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-02-27T14:10:20.217

标准 C 没有定义二进制常量。虽然有一个 GNU C 扩展（在流行的编译器中，clang 也适应它）：`0b`or`0B`前缀：

```
int foo = 0b1010; 
```

如果你想坚持使用标准 C，那么有一个选择：你可以结合一个宏和一个函数来创建一个*几乎*可读的“二进制常量”特性：

```
#define B(x) S_to_binary_(#x)

static inline unsigned long long S_to_binary_(const char *s)
{
        unsigned long long i = 0;
        while (*s) {
                i <<= 1;
                i += *s++ - '0';
        }
        return i;
} 
```

然后你可以像这样使用它：

```
int foo = B(1010); 
```

如果您打开大量编译器优化，编译器很可能会完全消除函数调用（常量折叠）或至少内联它，因此这甚至不会成为性能问题。

**证明：**

以下代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <string.h>

#define B(x) S_to_binary_(#x)

static inline unsigned long long S_to_binary_(const char *s)
{
    unsigned long long i = 0;
    while (*s) {
        i <<= 1;
        i += *s++ - '0';
    }
    return i;
}

int main()
{
    int foo = B(001100101);

    printf("%d\n", foo);

    return 0;
} 
```

已使用 编译`clang -o baz.S baz.c -Wall -O3 -S`，并生成以下程序集：

```
 .section    __TEXT,__text,regular,pure_instructions
    .globl  _main
    .align  4, 0x90
_main:                                  ## @main
    .cfi_startproc
## BB#0:
    pushq   %rbp
Ltmp2:
    .cfi_def_cfa_offset 16
Ltmp3:
    .cfi_offset %rbp, -16
    movq    %rsp, %rbp
Ltmp4:
    .cfi_def_cfa_register %rbp
    leaq    L_.str1(%rip), %rdi
    movl    $101, %esi               ## <= This line!
    xorb    %al, %al
    callq   _printf
    xorl    %eax, %eax
    popq    %rbp
    ret
    .cfi_endproc

    .section    __TEXT,__cstring,cstring_literals
L_.str1:                                ## @.str1
    .asciz   "%d\n"

.subsections_via_symbols 
```

所以`clang`完全消除了对函数的调用，并将其返回值替换为`101`. 整齐吧？

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-27T14:10:03.983

`0b`用like in给你的字面量加上前缀

```
int i = 0b11111111; 
```

见[这里](http://gcc.gnu.org/onlinedocs/gcc/Binary-constants.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-27T16:21:02.113

使用[BOOST_BINARY](http://www.boost.org/doc/libs/1_53_0/libs/utility/utility.htm#BOOST_BINARY)（是的，您可以在 C 中使用它）。

```
#include <boost/utility/binary.hpp>
...
int bin = BOOST_BINARY(110101); 
```

该宏在预处理期间扩展为八进制文字。

# java - 可以HTable.get(列表 ) 是否曾在返回的数组中放入空引用？

> ID：15114141
> 
> 赞同：2
> 
> 时间：2013-02-27T14:08:03.473
> 
> 标签：java, exception, hadoop, hbase

HBase Javadoc 对于 HTable.get(List) 方法非常混乱。

作为返回参数文档，我们有以下语句：

```
如果重试后仍有任何故障，
这些 Gets 的结果数组中将有一个空值，
并且将引发异常。

```

我不明白“AND”：我们可以在返回的数组中有一个异常或一个空值，而不是像文档所暗示的那样同时存在。

我从未听说过能够引发异常并返回某些内容的 Java 方法。

当我调用这个方法时，我在我的代码中处理了异常，但我是否还需要担心结果数组中的空引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-01-23T13:38:45.867

此处的文档具有误导性，因为此函数不会返回结果并在失败的情况下同时抛出错误。

我挖了这个，因为我也很困惑。

下面是这个函数的[源代码](https://github.com/googleapis/java-bigtable-hbase/blob/432e0d3044d5eaf78d0b7da5ed8fe3dba3c00508/bigtable-client-core-parent/bigtable-hbase/src/main/java/com/google/cloud/bigtable/hbase/AbstractBigtableTable.java#L228-L245)：

```
 /** {@inheritDoc} */
  @Override
  public Result[] get(List<Get> gets) throws IOException {
    LOG.trace("get(List<>)");
    Preconditions.checkNotNull(gets);
    if (gets.isEmpty()) {
      return new Result[0];
    } else if (gets.size() == 1) {
      try {
        return new Result[] {get(gets.get(0))};
      } catch (IOException e) {
        throw createRetriesExhaustedWithDetailsException(e, gets.get(0));
      }
    } else {
      try (Scope scope = TRACER.spanBuilder("BigtableTable.get").startScopedSpan()) {
        addBatchSizeAnnotation(gets);
        return getBatchExecutor().batch(gets);
      }
    }
  } 
```

好的，所以如果列表中有多个项目，它会调用[`getBatchExecutor().batch(gets)`](https://github.com/googleapis/java-bigtable-hbase/blob/432e0d3044d5eaf78d0b7da5ed8fe3dba3c00508/bigtable-client-core-parent/bigtable-hbase/src/main/java/com/google/cloud/bigtable/hbase/BatchExecutor.java#L232-L246)，该函数的定义如下：

```
 public Result[] batch(List<? extends Row> actions) throws IOException {
    try {
      Object[] resultsOrErrors = new Object[actions.size()];
      batchCallback(actions, resultsOrErrors, null);
      // At this point we are guaranteed that the array only contains results,
      // if it had any errors, batch would've thrown an exception
      Result[] results = new Result[resultsOrErrors.length];
      System.arraycopy(resultsOrErrors, 0, results, 0, results.length);
      return results;
    } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
      LOG.error("Encountered exception in batch(List<>).", e);
      throw new IOException("Batch error", e);
    }
  } 
```

见那里的评论：

> 此时我们保证数组只包含结果，如果它有任何错误，批处理会抛出异常

这意味着这个函数只会在失败的情况下引发 IOException 并且没有关于结果的进一步信息。但是，您如何找出批次中的失败和正确处理的项目？原来有[另一个版本的`batch`定义`Table`](https://github.com/googleapis/java-bigtable-hbase/blob/432e0d3044d5eaf78d0b7da5ed8fe3dba3c00508/bigtable-client-core-parent/bigtable-hbase/src/main/java/com/google/cloud/bigtable/hbase/AbstractBigtableTable.java#L180-L187)的函数支持这种情况：

```
 /** {@inheritDoc} */
  @Override
  public void batch(List<? extends Row> actions, Object[] results)
      throws IOException, InterruptedException {
    LOG.trace("batch(List<>, Object[])");
    try (Scope scope = TRACER.spanBuilder("BigtableTable.batch").startScopedSpan()) {
      addBatchSizeAnnotation(actions);
      getBatchExecutor().batch(actions, results);
    }
  } 
```

以及相应的[定义](https://github.com/googleapis/java-bigtable-hbase/blob/432e0d3044d5eaf78d0b7da5ed8fe3dba3c00508/bigtable-client-core-parent/bigtable-hbase/src/main/java/com/google/cloud/bigtable/hbase/BatchExecutor.java#L259-L291)`BatchExecutor`：

```
 public void batch(List<? extends Row> actions, @Nullable Object[] results)
      throws IOException, InterruptedException {
    batchCallback(actions, results, null);
  }
  public <R> void batchCallback(
      List<? extends Row> actions, Object[] results, Batch.Callback<R> callback)
      throws IOException, InterruptedException {
    Preconditions.checkArgument(
        results == null || results.length == actions.size(),
        "Result array must have same dimensions as actions list.");
    if (actions.isEmpty()) {
      return;
    }
    if (results == null) {
      results = new Object[actions.size()];
    }
    Timer.Context timerContext = batchTimer.time();
    List<ApiFuture<?>> resultFutures = issueAsyncRowRequests(actions, results, callback);
    // Don't want to throw an exception for failed futures, instead the place in results is
    // set to null.
    List<Throwable> problems = new ArrayList<>();
    List<Row> problemActions = new ArrayList<>();
    List<String> hosts = new ArrayList<>();
    for (int i = 0; i < resultFutures.size(); i++) {
      try {
        resultFutures.get(i).get();
      } catch (ExecutionException e) {
        problemActions.add(actions.get(i));
        problems.add(e.getCause());
        hosts.add(options.getDataHost());
      }
    }
    if (problems.size() > 0) {
      throw new RetriesExhaustedWithDetailsException(problems, problemActions, hosts);
    }
    timerContext.close();
  } 
```

使用此函数，您传入一个（空）`results`数组，该数组的大小与您的批处理大小相同，该数组在结果输入时被填充。最后，如果批处理中的任何项目失败，则会出现详细信息异常关于他们失败的原因，但您的`results`数组仍然充满了所有项目的结果。失败的项目将`null`在该数组中，而其余的则包含一个实际的`Result`.

# xslt - 将 Xinclude 支持添加到 XSLT 样式表

> ID：15114144
> 
> 赞同：2
> 
> 时间：2013-02-27T14:08:23.197
> 
> 标签：xslt, xinclude

我有一个大型 XSLT 样式表，可以将 XML 格式转换为 HTML。我想在输入 XML 文件中添加对 XInclude 的支持。目标是每个包含文件以及包含 XML 文件都可以独立进行 XSD 验证。我控制了 XML 模式中的所有更改（我认为）；只有特定的 XML 元素可以移出到包含文件中，并且只有一层包含文件嵌套。我在 Eclipse 的 XML 编辑器中工作，它很好地验证了包含文件和每个包含文件。

XSLT 样式表有两种使用方式，在这里我们更接近我的问题：

1.  在使用 lxml 进行 XSLT 转换的 Python 脚本的构建环境中。Python 脚本被集成到基于 make 的构建环境和 Eclipse 的 Ant 脚本中。

2.  在包含 XML 文件的 xsl-stylesheet 指令中。这适用于人们希望在 Web 浏览器中立即查看他们对任何 XML 文件所做的更改的情况。到目前为止，这已被证明是一个非常有效的环境，所以我不想放弃它。

我能够使用 Python 脚本中的 ElementTree.xinclude() 方法获得用例 1。但是，这不是用例 2 的解决方案。

另外，我确实了解如何编写只执行 Xinclude 解析的 XSLT 样式表，理论上这可以用作第一个转换，然后是现有的 XSLT 样式表，用于 XML 到 HTML 的转换。问题是 XML 文件只能有一个 xsl-stylesheet 指令。

另一个想法是将 XInclude 分辨率留给 Web 浏览器。但是，我不知道有任何 Web 浏览器支持该功能。另外，我不希望限制只使用一种特定的浏览器。到目前为止，我们支持所有最常见的浏览器。

另一个想法是将 XInclude 解析支持添加到现有的 XSLT 样式表中。但是，我在为输入和输出而苦苦挣扎，因为这实际上是三个阶段（文件中的 XML 输入 -> 带有 Xinclude 解析的 FLat XML -> HTML。XInclude 解析部分需要执行第一次转换而现有的 XSLT 代码将执行第二个。我不确定这在一个样式表中是否可行。

我的问题是：

1.  有什么方法可以在使用 Web 浏览器打开（包括）XML 文件时调用两个 XSLT 样式表？

2.  有什么方法可以改进现有的 XSLT 样式表并支持 XInclude 以使其保持单个样式表？

3.  XSLT 样式表中有什么方法可以修改输入吗？

4.  Web 浏览器是否对 XInclude 分辨率提供任何支持？

谢谢安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-10T07:53:24.320

> [1](https://stackoverflow.com/questions/11525719/how-to-apply-xslt-on-xml-with-just-xinclude)有什么方法可以在使用 Web 浏览器打开（包括）XML 文件时调用两个 XSLT 样式表？
> 
> [2](http://www.saxonica.com/ce/index.xml)有什么方法可以改进现有的 XSLT 样式表并支持 XInclude 以使其保持单一样式表？
> 
> [3] XSLT 样式表中是否有任何方法可以修改输入？
> 
> [4] Web 浏览器是否支持 XInclude 解析？

以相反的顺序处理问题，因为这样更容易：

(4) 我也没有看到任何做 XInclude 扩展的网络浏览器。

(3) 我不知道“修改输入”是什么意思：XSLT 将输入转换（或修改）为输出。除非您要问：您可以一步修改输入，然后再次转换输出吗？是的：如果浏览器支持 exslt:node-set，那么您可以使用一次转换的结果创建一个变量，然后选择该变量进行另一次转换。您可以使用模式为不同的步骤选择一组不同的模板。

就像是：

```
 <xsl:variable name="doc.all">
    <xsl:apply-templates  mode="p1" select="/" />
</xsl:variable> 
```

使用一组 mode="p1" 模板，以及在某处选择该变量作为节点集的模板：

```
 <xsl:template match="/" >
    <xsl:apply-templates select="exslt:node-set($doc.all)" />
  </xsl:template> 
```

[ XSLT-2.0 可以更直接地处理节点集，但是没有浏览器本身支持 XSLT-2.0 ]

(2) 我不知道您现有的样式表是什么样的，但可能：是的。当您认为执行 XInclude 处理和 xslt 的其余部分必须是两个单独的步骤时，您是在程序上思考。如果您使用 XSLT 进行 XInclude 扩展，那么 xinclude 只是要匹配的另一组模式。

您可能需要类似此模板的内容来执行 xinclude 扩展：

```
 <xsl:template   match="xi:include[@href][@parse='xml' or not(@parse)]">
        <xsl:apply-templates select="document(@href)/*" />  
    </xsl:template> 
```

[从这个问题的答案修改](https://stackoverflow.com/questions/11525719/how-to-apply-xslt-on-xml-with-just-xinclude)：在文档（@href）之后添加“/ *”以避免在包含的文档以及基础文档上再次调用根模板。

然后包含一个 match="/" 模板来设置外部 html，其余的转换模式来创建内部节点。

这两个步骤在这里是隐含的：第一步是在遇到该元素时将输入源重定向到 xi:include/@href。步骤是根据其他匹配模板处理该文档中的节点。

(1) 使用 PI 只能运行一个样式表，但是，您的浏览器中有 Javascript，所以只要避免跨域安全问题，您应该可以按程序进行操作。

需要考虑的几点：

我不知道如果作为一次转换的结果，您生成另一个具有不同指令的文件，浏览器会做什么。它又继续了吗？可能值得一试。如果没有，您可以在 javascript 中显式进行处理，然后应用第二次转换。

您在浏览器中支持 xslt、javascript 和 css：您可以将 javascript 和 css 注入到输出中。css 可以为 XML 和 HTML 设置样式。

Michael Kay 发布了[Saxon CE](http://www.saxonica.com/ce/index.xml)，这是一个编译成 javascript 的 XSLT 2.0 实现，因此它可以在浏览器中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T11:56:45.297

您可能应该看看 XProc 来做到这一点

看来您的用例过于复杂，无法在单个 XSLT 中完成

# hadoop - 从不同目录调用 hive cli 时找不到表

> ID：15114145
> 
> 赞同：1
> 
> 时间：2013-02-27T14:08:24.183
> 
> 标签：hadoop, hive

我在 Hive Tables 上遇到了一个奇怪的问题。我已经`HIVE_HOME`在我的环境中设置，它也在我的搜索路径中，所以我可以`hive`直接调用。

现在我`hive`从一个目录调用`/a/b/c`并创建一些表。我可以看到桌子。

现在我切换到一个目录，例如并从那里`/a/b`调用。`hive`这是问题部分。要么我看不到表格，要么我收到此错误

```
hive> show tables;
FAILED: Error in metadata: javax.jdo.JDOFatalDataStoreException: Failed to start    
database 'metastore_db', see the next exception for details.

NestedThrowables:
java.sql.SQLException: Failed to start database 'metastore_db', see the next exception    
for details.
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask 
```

为什么表与`hive`调用 cli 的目录相关联？任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T17:30:30.810

我认为您正在使用配置单元用于存储元数据的 derby 服务器。因此，您可以做的是删除 metastore_db 文件夹中的所有内容，然后尝试重新启动 hadoop。然后试着看看。但是，我认为最好的建议是使用 mysql 作为元存储。

# c++ - 链接器警告（多次指定对象）

> ID：15114151
> 
> 赞同：0
> 
> 时间：2013-02-27T14:08:41.190
> 
> 标签：c++, visual-studio-2010, linker-errors, unresolved-external

好吧，在使用 Microsoft Visual Studio 编译 C++ 代码时，我又一次崩溃了。在我的一个项目中，显示了以下错误：

> 1>Debug\xmlreader.obj : 警告 LNK4042：对象指定了多次；额外被忽略

我有一个 xmlreader.h 和 xmlreader.cpp 文件，标题以 开头`#pragma once`，所以第一眼看起来这个问题很奇怪。

上面的错误还伴随着很多链接器错误，其中有“未解析的外部符号” - 基本上好像 xmlreader.h 中的所有内容都不再存在了。什么会导致这种情况，更重要的是 - 我该如何解决这个问题？

# android - 从android中的视频中提取位图

> ID：15114153
> 
> 赞同：9
> 
> 时间：2013-02-27T14:08:43.870
> 
> 标签：android, video, bitmap, media

我正在尝试从视频中提取所有帧。
通过以下代码，我想获取视频的前 30 帧，但我只得到了第一帧 30 次。

```
private ArrayList<Bitmap> getFrames(String path) {
    try {
        ArrayList<Bitmap> bArray = new ArrayList<Bitmap>();
        bArray.clear();
        MediaMetadataRetriever mRetriever = new MediaMetadataRetriever();
        mRetriever.setDataSource("/sdcard/myvideo.mp4");                    

        for (int i = 0; i < 30; i++) {
            bArray.add(mRetriever.getFrameAtTime(1000*i, 
                       MediaMetadataRetriever.OPTION_CLOSEST_SYNC));
        }
        return bArray;
    } catch (Exception e) { return null; }
} 
```

现在，如何从视频中获取所有帧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-07T10:27:20.773

Android SDK 中的视频支持有限，只能对关键帧进行 H264 编码视频的帧提取。为了提取任意帧，您需要使用像[FFmpegMediaMetadataRetriever](https://github.com/wseemann/FFmpegMediaMetadataRetriever "fmmr")这样的库，它使用本机代码从视频中提取数据。它非常快，带有预编译的二进制文件（用于 ARM 和 x86），因此您无需深入研究 C++ 和 makefile，在 Apache 2.0 下获得许可，并带有一个演示 Android 应用程序。

还有一个纯 Java 库，[JCodec](https://github.com/jcodec/jcodec "编解码器") ，但速度较慢，当我去年使用它时，提取帧的颜色会失真。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-03-19T07:47:38.693

你必须将路径传递给这个方法......完美的工作代码！希望有帮助

gradle - 实现 'com.github.wseemann:FFmpegMediaMetadataRetriever-core:1.0.15'

```
public void VideoToGif(String uri) {
    Uri videoFileUri = Uri.parse(uri);

    FFmpegMediaMetadataRetriever retriever = new FFmpegMediaMetadataRetriever();
    retriever.setDataSource(uri);
    List<Bitmap> rev = new ArrayList<Bitmap>();
    MediaPlayer mp = MediaPlayer.create(GitToImage.this, videoFileUri);
    int millis = mp.getDuration();
    System.out.println("starting point");
    for (int i = 100000; i <=millis * 1000; i += 100000*2) {
        Bitmap bitmap = retriever.getFrameAtTime(i, FFmpegMediaMetadataRetriever.OPTION_CLOSEST);
        rev.add(bitmap);
    }

    GiftoImage((ArrayList) rev);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-07T12:38:57.783

**getFrameAt 以毫秒为单位获取数据，**但您在 for 循环中增加了 0.001 毫秒。

```
 for(int i=1000000;i<millis*1000;i+=1000000) // for incrementing 1s use 1000
    {
       bArray.add(mRetriever.getFrameAtTime(i, 
                       MediaMetadataRetriever.OPTION_CLOSEST_SYNC));
    } 
```

像上面一样改变它。以上是创建您想要的示例。我也在[这里回答了](https://stackoverflow.com/a/24307619/3496570)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-20T08:41:16.363

从 Android 9.0（API 级别 28）开始，`MediaMetadataRetriever`有一个`getFrameAtIndex (int frameIndex)`方法，它接受您想要的帧的从零开始的索引并返回一个位图。

见[https://developer.android.com/reference/android/media/MediaMetadataRetriever.html#getFrameAtIndex(int)](https://developer.android.com/reference/android/media/MediaMetadataRetriever.html#getFrameAtIndex(int))

# c++ - OpenGL：使用纹理时至少绑定一个纹理？

> ID：15114155
> 
> 赞同：1
> 
> 时间：2013-02-27T14:08:45.607
> 
> 标签：c++, opengl, textures

我开始在 openGl 中使用纹理，我注意到一些奇怪的行为。请参阅以下伪代码示例：

```
int main()...
bindTexture1();
bindTexture2();
bindTexture3();

// None of these textures are actually used!

while(true) {
    begin();
    // draw stuff 
    end();
} 
```

我正在加载和绑定 3 个纹理，但现在我只是在绘制图元。但是那些原语是不可见的。它们在以下情况下可见：

```
int main()...
bindTexture1();   // <- So the first bind() remains the only one
//bindTexture2();
//bindTexture3();

// None of these textures are actually used!

while(true) {
    begin();
    // draw again just primitve stuff but now it's visible
    end();
} 
```

或者

```
int main()...
bindTexture1();
bindTexture2();
bindTexture3();

// None of these textures are actually used!

while(true) {
    begin();
    bindTexture1();  // Binding texture 1 again
    // draw again just primitve stuff but now it's visible 
    end();
} 
```

所以我想我的问题与这个 glBindTexture 函数有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:25:10.793

在固定管道（opengl 1 和 2）中渲染 2D 纹理的过程是这样的：

```
glEnable( GL_TEXTURE_2D );

glBindTexture( GL_TEXTURE_2D, textureId );

// render
glBegin( GL_QUADS );

   glTexCoord2f( 0.0, 0.0 );
   glVertex2f( 0.0, 0.0 );
   glTexCoord2f( 1.0, 0.0 );
   glVertex2f( 1.0, 0.0 );
   glTexCoord2f( 1.0, 1.0 );
   glVertex2f( 1.0, 1.0 );
   glTexCoord2f( 0.0, 1.0 );
   glVertex2f( 0.0, 1.0 );

glEnd();

glDisable( GL_TEXTURE_2D ); 
```

# objective-c - MPMoviePlayerController 到全屏

> ID：15114157
> 
> 赞同：0
> 
> 时间：2013-02-27T14:08:53.627
> 
> 标签：objective-c, mpmovieplayercontroller, fullscreen

我将 MPMoviePlayerController 放置在我的视图中的某个大小和位置。这工作正常。但是，在某些情况下，我希望视频全屏播放。我的视图是 UISPlitViewController 的一部分，所以如果我只是获得视图宽度，它就不是全屏的。我需要的是显示视频，就好像用户单击了播放器控件中的双端箭头以最大化视频一样。

到目前为止，这是我的代码。任何人都可以填写强制全屏播放的缺失位吗？

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // FIND OUT HOW MANY VIDEOS ARE AVAILABLE
    int videoCount = [[self videos] count];

    // GET THE FILE NAME OF THE FIRST AVAILABLE VIDEO
    NSString* fileName = [NSString stringWithFormat:@"%@.mp4", [self videos] objectAtIndex:0]];
    NSArray *arrayPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *path = [arrayPaths objectAtIndex:0];
    NSString *filePath = [path stringByAppendingPathComponent:fileName];
    NSURL *url = [NSURL fileURLWithPath:filePath];

    // PLACE THE MOVIE AT THE CORRECT LOCATION ON THE PAGE
    moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];
    [[moviePlayer view] setFrame:CGRectMake(100, 100, 600, 360)];
    [[moviePlayer view] setAutoresizingMask:UIViewAutoresizingFlexibleWidth];
    [[self view] addSubview:moviePlayer.view];
    [moviePlayer play];

    if(videoCount == 1)
    {
        -- MAXIMISE THE VIDEO TO FULL SCREEN AND LANDSCAPE --
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:22:07.100

根据 Apple 的文档，您只需将 `MPMoviePlayerController 设置为全屏显示：

```
[moviePlayer setFullscreen:YES animated:YES] 
```

你试过这个吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T11:07:36.797

请使用 MPMoviePlayerViewController 因为 MP4 文件。当你使用 MOV 然后工作完美！

```
MPMoviePlayerViewController *moviePlayerViewController;

-(void)PlayVedioController:(NSString*)videoUrl1
{
    NSURL    *fileURL    =   [NSURL URLWithString:videoUrl1];
    moviePlayerViewController = [[MPMoviePlayerViewController alloc] initWithContentURL:fileURL];

    // Register for the playback finished notification.
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(myMovieFinishedCallback:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:moviePlayerViewController.moviePlayer];

    //Present
    [self presentMoviePlayerViewControllerAnimated:moviePlayerViewController];

    // Play the movie!
    moviePlayerViewController.moviePlayer.movieSourceType = MPMovieSourceTypeFile;
    [moviePlayerViewController.moviePlayer play];
}

-(void)myMovieFinishedCallback:(NSNotification*)aNotification
{
    [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:MPMoviePlayerPlaybackDidFinishNotification
                                                  object:moviePlayerViewController.moviePlayer];

    [moviePlayerViewController release], moviePlayerViewController = nil;
} 
```

# ms-access - Ms Access VBA 中的 Postgres 备份

> ID：15114158
> 
> 赞同：0
> 
> 时间：2013-02-27T14:08:55.653
> 
> 标签：ms-access, backup, postgresql-9.2

是否可以创建一个 VBA (MS_Access 2010) 例程来自动创建 Postgres (9.2) 备份/恢复？

# c# - 使用 Delegate 中的参数作为基类

> ID：15114162
> 
> 赞同：1
> 
> 时间：2013-02-27T14:09:02.200
> 
> 标签：c#, delegates, params, inheritance

我有一个委托期望 A 类型的参数作为参数。所以 A 是基类。B 类和 C 类继承自 A。

问题是B和C虽然继承了基类A，但是脚本底部的DoSomething函数却无法转换为delegate。

```
public class A { }
public class B : A { }
public class C : A { }

public delegate void CallbackAction(params A[] paremeters);
public class Main
{
    public int main(params string[] args)
    {
        CallbackAction callbackAction;
        callbackAction = DoSomething1;
        callbackAction = DoSomething2;
        callbackAction = DoSomething3;

        return 0;
    }

    public void DoSomething1(A arg0) { }
    public void DoSomething2(B arg0) { }
    public void DoSomething3(C arg0) { }
} 
```

有没有办法在委托中使用 params 并能够使用以 params 类作为基类的类？

编译时我得到的错误是：错误 5 'DoSomething3' 没有重载匹配委托 'SKConsole.CallbackAction'

我正在使用 .NET 4 和 XNA

**编辑::** 好的，让我解释一下我为什么要使用它，我正在创建一个控制台。这意味着使用我的控制台的程序员可以向控制台添加命令（console.AddCommand("help", Help)，这里的帮助是一个函数。当您在游戏中并在控制台中输入帮助时，它将执行函数 Help() .我现在希望它也可以与 console.AddCommand("setSpeed", SetPlayerSpeed) 一起使用。SetPlayerSpeed 函数有 1 个参数，一个 int。但我希望它可以与任何函数一起使用，所以如果程序员创建函数 DoSomeFancyStuff(float a , string b, int c) 我希望控制台创建一个命令，如果您在控制台中输入正确的字符串，则执行这些命令。

我已经尝试为不同的功能制作很多代表，但在我看来这有点难看。

然后我尝试的是以下

```
public abstract class SKConsoleParameter
{
    protected string value;

    public SKConsoleParameter(string value)
    {
        this.value = value;
    }
    public string GetRawValue()
    {
        return value;
    }

    public abstract bool IsValid();
    public abstract object GetValue();
}

public class StringParam : SKConsoleParameter
{
    public StringParam(string value) : base(value) { }

    public override bool IsValid()
    {
        return true;
    }

    public override object GetValue()
    {
        return value;
    }
}

public class IntParam : SKConsoleParameter
{
    public IntParam(string value) : base(value) { }

    public override bool IsValid()
    {
        int i;
        return int.TryParse(value, out i);
    }

    public override object GetValue()
    {
        int i;
        if (int.TryParse(value, out i))
            return i;
        else
            return 0;
    }
} 
```

这样做是因为如果开发人员创建了如下函数：

```
DoSomethingCool(StringParam s, IntParam i) 
```

然后它可以通过使用 (string)s.GetValue() 和 (int)i.GetValue() 接收值 StringParam 和 IntParam 类都继承自 SKConsoleParameter，所以我现在可以创建以下委托

```
void CoolDelegate(params SKConsoleParameter[] parameters) 
```

但这不起作用..因为这个页面顶部的A，B和C类的抽象问题

有没有人有任何想法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:19:58.237

您正在错误的地方寻找错误。C#[允许](http://msdn.microsoft.com/en-us/library/ms173174.aspx)在委托的输入参数中进行逆变。您的代码的问题是您的委托需要`params A[]`，而您的方法需要一个`A`. 这是不允许的。Delcare 你的代表接受一个单一的`A`：

```
delegate void Callback1 (B a) ;
void Test11 (A a) {}
void Test12 (B b) {}

Callback1 c11 = Test11 ; // OK
Callback1 c12 = Test12 ; // OK 
```

另请注意，这不适*用于*数组参数：

```
delegate void Callback2 (B[] a) ;
void Test21 (A[] a) {}
void Test22 (B[] b) {}

Callback2 c21 = Test21 ; // compile error
Callback2 c22 = Test22 ; // OK 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:18:53.690

试试这个代码：

```
 public class A {  }
public class B : A { }
public class C : A { }

public static class Helper
{
    public static Action<A> DoSomething;
}

class Program
{
    static void Main(string[] args)
    {
        var a = new A();
        var b = new B();
        var c = new C();

        Helper.DoSomething = new Action<A>(DoSomething1);
        Helper.DoSomething = (Action<A>)new Action<B>(DoSomething2);
        Helper.DoSomething = (Action<A>)new Action<C>(DoSomething3);                       
    }

    public static void DoSomething1(A a) { }
    public static void DoSomething2(B a) { }
    public static void DoSomething3(C a) { }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:54:12.883

根据您更新的代码 - 试试这个。只要您的方法与委托匹配，逆变就应该在 .NET 3.5 或更好的版本中按预期工作

```
public abstract class SKConsoleParameter
{
    protected string value;

    public SKConsoleParameter(string value)
    {
        this.value = value;
    }
    public string GetRawValue()
    {
        return value;
    }

    public abstract bool IsValid();
    public abstract object GetValue();
}

public class StringParam : SKConsoleParameter
{
    public StringParam(string value) : base(value) { }

    public override bool IsValid()
    {
        return true;
    }

    public override object GetValue()
    {
        return value;
    }
}

public class IntParam : SKConsoleParameter
{
    public IntParam(string value) : base(value) { }
    public override bool IsValid()
    {
        int i;
        return int.TryParse(value, out i);
    }
    public override object GetValue()
    {
        int i;
        if (int.TryParse(value, out i))
            return i;
        else
            return 0;
    }
}   

class Program
{

    public delegate void CoolDelegate(params SKConsoleParameter[] parameters);

    static void Main(string[] args)
    {
        var s = new StringParam("Glenn");
        var i = new IntParam("12");
        var coolDel = new CoolDelegate(DoSomethingCool);
        coolDel(s, i);
    }

    public static void DoSomethingCool(params SKConsoleParameter[] parameters)
    {
        if (parameters == null) throw new ArgumentNullException("parameters");
        foreach (var item in parameters)
        {
            if (item is IntParam)
            {
                // do something interesting
                continue;
            }

            if (item is StringParam)
            {
                // do something else interesting
                continue;
            }

            throw new NotImplementedException("unknown param type");
        }
    }
} 
```

# infragistics - Infragistics FilterMenuFormatString

> ID：15114165
> 
> 赞同：0
> 
> 时间：2013-02-27T14:09:10.787
> 
> 标签：infragistics

有人会帮助我了解这个属性。下面是他们的解释：

* * *

```
<ig:TextColumn.FilterColumnSettings>
       <ig:FilterColumnSettings FilterMenuFormatString="{}{Regex}"/>
</ig:TextColumn.FilterColumnSettings> 
```

当您通过 XAML 应用格式并在其中使用特殊符号时，您应该使用 {} 对其进行转义。

* * *

我不明白如何将其转换为模式并替换。我想用双下划线替换字符串中的第一个下划线（试图破坏复选框的 RecognizesAccessKey 行为，而不创建新的控件模板）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:17:12.553

FilterMenuFormatString 允许您将 FormatString 应用于过滤器列表中显示的值，类似于[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)方法的作用。

请注意，您尝试解决的问题将在 Next NetAdvantage for WPF/Silverlight 服务版本中得到解决，该版本目前根据[发布时间表](http://www.infragistics.com/help/service-releases/)安排在 4 月 5 日。

如果您需要解决之前的行为，您可以使用[Infragistics 论坛上](http://www.infragistics.com/community/forums/p/77729/392598.aspx#392598)建议的解决方法在默认模板中将 ContentPresenter 的 RecognizesAccessKey 设置为 false。

# antlr - 检查可选规则是否为空

> ID：15114174
> 
> 赞同：2
> 
> 时间：2013-02-27T14:09:34.923
> 
> 标签：antlr

假设我有这样的语法（目标语言是 C）：

```
mycmd : cmd_name  option? arg1 
```

由于“选项”是可选的，如果我像这样直接访问它 -

```
mycmd : cmd_name  option? arg1
{ add_option($option.text); } 
```

程序会崩溃，生成的C代码是

```
add_option(option->getText(option)); 
```

这里“选项”为NULL。

我实验了以下

```
mycmd : cmd_name  option? arg1
{ if ($option != NULL) { add_option($option.text);} } 
```

这工作正常。

但是我搜索了一下，发现推荐的方法是预先声明一些布尔值，在子规则中将其设置为 true 并检查其实际值。我不喜欢它，因为它使阅读语法变得更加困难。

问题是，检查“$option”对 NULL 是否对我有用，这只是我的运气吗？有没有其他推荐的方法让我可以将语法和动作分开？

我正在使用 ANTLR3.4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:59:34.033

我会使用以下内容：

```
{ if ($option) { add_option($option.text); } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T05:28:11.353

检查 NULL 是合适的，或者您可以将操作放在可选的子规则中。

```
mycmd : cmd_name 
        (option {add_option($option.text);} )? 
        arg1 
```

# php - 带有 Slim 框架的 PHP RESTful Web 服务，需要身份验证还是反对无状态？

> ID：15114176
> 
> 赞同：0
> 
> 时间：2013-02-27T14:09:43.127
> 
> 标签：php, rest, restful-authentication, slim

我正在使用 Slim 微框架编写一个 RESTful Web 服务，并使用 GET 从 mysql 数据库中读取数据（选择查询），并使用 POST/PUT/DELETE 在数据库中插入/更新/删除行。

我现在的问题是，如果每个人都能够在数据库中写入或删除数据，这不是一个大的安全问题吗？但是我怎么能防止这种情况发生，我认为 REST 中的 ST 代表状态转移（因此 web 服务是无状态的），这与登录或未登录等状态是矛盾的。而且，如果我将一些允许写入数据库的登录数据传递给客户端，那么一个坏人不能用它捕获登录数据和虚假请求，例如删除所有条目吗？

那么，正常的做法是什么，我发现的唯一 Slim 框架示例总是显示路由示例，而不是如何保护它。

Slim 框架中是否还有一些机会来实现我所需要的？它应该尽可能简单，并且请求的响应速度应该几乎与没有身份验证或类似的情况一样快。没有像密码这样的敏感数据，对我来说，不是每个使用 cURL 命令行工具的人都可以删除所有行或类似的东西就足够了。

如果有人能解释我该怎么做和/或举一些例子，那就太好了。我还需要知道，我可能需要在允许发送请求的客户端上进行更改。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:16:47.720

每个请求都必须经过身份验证和授权。

人们经常被“无国籍”这个词所束缚。这实际上只是意味着从一个请求到下一个请求，RESTful 服务没有用户状态的先验知识。

但是，显然允许服务知道刚刚发出请求的经过身份验证的用户，否则它将如何决定是否应该允许访问？

因此，您可以在每次请求期间将经过身份验证的用户“存储”在某个变量中。然后由您决定如何使用此信息来授权请求​​。

我喜欢保持简单，并将所有用户作为我的 URI 链中的资源。他们提出类似的要求`users/{username}/someresource`。

我使用 http 基本身份验证（通过 SSL）进行身份验证并根据 URI 进行授权。如果请求未通过身份验证，则为 401 Unauthorized Request。如果 URI {username} 和经过身份验证的 {username} 不匹配，则该请求是 403 禁止的。如果经过认证和授权，则允许请求（http代码依赖于http动词）

现在已经涵盖了 Web 服务，接下来是 Web 服务客户端。这当然必须存储状态，否则您的用户每次发出请求时都必须登录。

您只需将用户会话存储在应用程序中（按照正常的会话管理），并在会话中存储用户名和密码（当然是加密的）。现在，每次发出请求时，您的 Web 服务客户端都需要检索用户名和密码，并将其与请求一起发送到您的 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:12:32.870

它将是无状态的，实际上不会有会话或 cookie。您通常会发出插入/更新/删除所需的密钥。

然后由您在每个请求中传递密钥并确定密钥何时到期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T06:01:07.930

它与普通的 http 认证会话一样安全。这些使用 cookie 等将连接的用户验证到存储的会话状态。

无状态服务也不例外 - 令牌被传递给服务，就像令牌存储在普通 http 的 cookie 中一样。如果您担心嗅探（IE 中间人攻击），您可以通过 SSL 保护链接。

服务生成的身份验证令牌将被加密，并包含一个盐，该盐也在服务器上针对每个请求进行验证。您还可以限制会话时间以适应您的妄想症，还可以检查源 IP、用户代理等的变化，如果这些变化使用户的令牌过期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T05:32:21.027

我最近遇到了类似的问题。正如这里的人所推荐的，我决定使用 OAuth 身份验证。

我正在使用[HybridAuth](https://github.com/hybridauth/hybridauth)一个用于 OAuth 的 php 包装器，以及用于 Facebook、Twitter、Google、LinkedIn 等的开箱即用的登录解决方案。

# r - 检查独特的元素

> ID：15114178
> 
> 赞同：4
> 
> 时间：2013-02-27T14:09:49.670
> 
> 标签：r

只是一个简单的问题。我有一个数据框（仅显示一个向量），如下所示：

> cln1
> A
> b
> A
> A
> c
> d
> A
> ....

我想要以下输出：

> cln1
> b
> c
> d

换句话说，我想删除所有复制的项目。函数“unique”和“duplicated”返回包含一次表示的复制元素的输出。我想明确地删除它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T14:13:08.437

您可以`setdiff`为此使用：

```
R> v <- c(1,1,2,2,3,4,5)
R> setdiff(v, v[duplicated(v)])
[1] 3 4 5 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T14:15:27.460

您可以使用`count`from `plyr`package 来计算一个项目的出现次数，并删除所有多次出现的项目。

```
library(plyr)
l = c(1,2,3,3,4,5,6,6,7)
count_l = count(l)
  x freq
1 1    1
2 2    1
3 3    2
4 4    1                                                                           
5 5    1                                                                           
6 6    2                                                                           
7 7    1  
l[!l %in%  with(count_l, x[freq > 1])]
[1] 1 2 4 5 7 
```

注意`!`，这意味着`NOT`。你当然把它放在一个单行中：

```
l[!l %in%  with(count(l), x[freq > 1])] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T14:23:07.710

另一种使用方式`table`：

使用@juba 的数据：

```
as.numeric(names(which(table(v) == 1)))
# [1] 3 4 5 
```

对于 OP 的数据，由于它是字符输出，`as.numeric`因此不需要。

```
names(which(table(v) == 1))
# [1] "b" "c" "d" 
```

# c# - C# 全局类 - 从一个方法添加并从另一个方法读取

> ID：15114180
> 
> 赞同：0
> 
> 时间：2013-02-27T14:09:53.057
> 
> 标签：c#, .net, parallel-processing

如何将下面的 DoScrape 方法添加到外部 CompanyInfo 变量中，然后在 button1_Click 的循环中访问该列表以写入文本文件？

```
namespace Test1
{
public partial class Form1 : Form
{

    public class LocationNameAndLink
    {
        public string Link { get; set; }
        public string Name { get; set; }
    }

LocationNameAndLink CompanyInfo = new List<LocationNameAndLink>();

private void button1_Click(object sender, EventArgs e)
{
        Parallel.ForEach(Brands, item =>
        {
            string initialSiteName = "http://www.site1.com/" + Brands;
            DoScrape(initialSiteName);
        });

        StreamWriter sw03 = new StreamWriter("websiteCompanyDetails.txt");
        foreach (var item in CompanyInfo)
        {
            sw03.WriteLine("\"" +  item.Name + "\",\"" + item.Link + "\""    );
        }
}

public static void DoScrape(string PageLink)
{
    string SiteLink;
    string SiteName;
    SourceCode = WorkerClass.getSourceCode(nextPageLink);
    SiteLink = SourceCode.Substring(0, 50);
    SiteName = SourceCode.Substring(51, 50);
     CompanyInfo.Add(new LocationNameAndLink 
                     {
                         Name = SiteName,
                         Link = SiteLink 
                     });
                 }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:11:36.957

您需要创建`DoScrape`一个*实例*方法，而不是*静态*方法。

静态方法并不特定于该类型的任何特定实例，因此它没有隐式`this`引用 - 而您的`CompanyInfo`字段是实例变量 - 每个实例`Form1`都有一个单独的变量。

有关含义的更多信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/98f28cdx.aspx)`static` - 这是一个需要理解的重要概念。

# xml - 重新格式化 XML 以获取单独的数据集（有条件地打开/关闭标签？）

> ID：15114185
> 
> 赞同：0
> 
> 时间：2013-02-27T14:10:12.107
> 
> 标签：xml, xslt

我（不幸地）必须使用的软件会生成一个包含多个数据集的 XML 文件（参见以下示例：“文档 1”、“文档 2”……），但没有用包装`<document>`标签将它们分开。它看起来像这样：

```
<print>
    <section>
        <col1>*****</col1>
        <col2>Document 1</col2>
    </section>
    <section>
        <col1>Title</col1>
        <col2>Title 1</col2>
    </section>
    <section>
        <col1>Year</col1>
        <col2>2011</col2>
    </section>

    <section />

    <section>
        <col1>*****</col1>
        <col2>Document 2</col2>
    </section>
    <section>
        <col1>Title</col1>
        <col2>Title 2</col2>
    </section>
    <section>
        <col1>Year</col1>
        <col2>2012</col2>
    </section>

    <section />

    <section>
        <col1>*****</col1>
        <col2>Document 3</col2>
    </section>
    <section>
        <col1>Title</col1>
        <col2>Title 3</col2>
    </section>
    <section>
        <col1>Year</col1>
        <col2>2013</col2>
    </section>

    <section />

    ...

</print> 
```

正如你所看到的，每个新的“文档”都从`<col1>*****</col1>`它的第一个`<section></section>`标签开始，并以一个空标签结束（或者更具体地说：后跟）`<section />`。

我想要做的是取出每个`<col2>`值并将其放入包装标签中，所以最后我应该得到文档的分离数据集。结果应如下所示：

```
<print>

    <document>
        <docno>Document 1</docno>
        <title>Title 1</title>
        <year>2011</year> 
    </document>

    <document>
        <docno>Document 2</docno>
        <title>Title 2</title>
        <year>2012</year> 
    </document>

    <document>
        <docno>Document 3</docno>
        <title>Title 3</title>
        <year>2013</year> 
    </document>

</print> 
```

所以我必须获取所有`<col2>`值，将它们放入新元素并将它们包装在`<document>`标签中。我使用以下 XSLT 进行了尝试，并且取得了部分成功（我可以获取`<col2>`值），但是在`<xsl:when>`标签内（我尝试包装`<col2>`值）会引发错误，因为`<document>`标签没有立即关闭：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>

    <xsl:template name="content">

        <xsl:if test="col1='*****'">
            <xsl:element name="docno">
                <xsl:value-of select="col2"/>   
            </xsl:element>
        </xsl:if>
        <xsl:if test="col1='Title'">
            <xsl:element name="title">
                <xsl:value-of select="col2"/>
            </xsl:element>
        </xsl:if>
        <xsl:if test="col1='Year'">
            <xsl:element name="year">
                <xsl:value-of select="col2"/>
            </xsl:element>
        </xsl:if>

    </xsl:template>

    <xsl:template  match="/">

        <xsl:element name="print">

        <xsl:for-each select="print/section">
            <xsl:choose>
                <xsl:when test="col1='*****'">
                    <xsl:element name="document">
                </xsl:when>
                <xsl:when test="not(col1/node())">
                    </xsl:element>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:call-template name="content"/>
                </xsl:otherwise>
            </xsl:choose>
        </xsl:for-each>

        </xsl:element>

    </xsl:template>
</xsl:stylesheet> 
```

我发现在 XSLT 中，有条件地打开和关闭标签是不可能的，但我确信还有另一种解决方案可以实现我的目标......我只是没有经验找到它。有人能指出我正确的方向吗？非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:57:08.620

Use (in XSLT 2.0)

```
<xsl:template match="print">
  <xsl:for-each-group select="section" 
          group-starting-with="section[starts-with(col2, 'Document')]">   
   <document>
     <docno><xsl:value-of select="current-group()[1]/col2"/>
     ... etc ...
   </document>
  </xsl:for-each-group>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:47:10.103

有更优雅的方法可以做到这一点，特别是如果您可以使用 XSLT 2.0，但如果您知道`<section>`每个空`<section/>`元素之间有三个元素，您可以执行类似这样的简单操作（兼容 XSLT 1.0）：

### 样式表

```
<?xml version="1.0"?>

<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="print">
    <xsl:copy>
      <!--
      Only apply the first <section> child of <print> and those <section> children
      whose first preceding <section> sibling is an empty <section/> element
      -->
      <xsl:apply-templates select="section[position() = 1
        or preceding-sibling::section[1][not(node())]]"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="section">
    <document>
      <!--
      Transform the <col2> child of this <section> into a <docno> elemen
      -->
      <xsl:apply-templates select="col2" mode="number"/>
      <!--
      Transform the <col2> element of the first following <section> sibling into
      a <title> element
      -->
      <xsl:apply-templates select="following-sibling::section[1]/col2" mode="title"/>
      <xsl:apply-templates select="following-sibling::section[2]/col2" mode="year"/>
    </document>
  </xsl:template>

  <xsl:template match="col2" mode="number">
    <docno>
      <xsl:value-of select="."/>
    </docno>
  </xsl:template>

  <xsl:template match="col2" mode="title">
    <title>
      <xsl:value-of select="."/>
    </title>
  </xsl:template>

  <xsl:template match="col2" mode="year">
    <year>
      <xsl:value-of select="."/>
    </year>
  </xsl:template>
</xsl:stylesheet> 
```

# lotus-domino - 使用 DSAPI 重写 URL

> ID：15114195
> 
> 赞同：2
> 
> 时间：2013-02-27T14:10:46.583
> 
> 标签：lotus-domino

我需要重写网址。即当用户发送对'url1'的请求时，我们将对'url2'发出请求（'url1'不会在浏览器中更改，用户不应该对此一无所知）。我环顾四周，除了 DSAPI 过滤器之外没有找到其他解决方案。DSAPI 可以做我需要的事情，但是由于经验不足，我无法完成该任务。

有人可以建议我应该调查哪些事件吗？我到底应该怎么做..

我正在查看这些事件：kFilterStartRequest、kFilterRawRequest 或 kFilterRewriteURL 尚未成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:01:29.757

我刚刚完成了基于 DSAPI 的解决方案，请在此处阅读[如何使用 DSAPI 重写 URL](http://dpastov.blogspot.com/2013/03/rewriting-url-in-domino-using-dsapi.html)。

# javascript - JS函数不返回返回

> ID：15114200
> 
> 赞同：0
> 
> 时间：2013-02-27T14:10:50.210
> 
> 标签：javascript

我有以下功能：

```
function anfahrtskosten()
{
    var xmlhttp;
    var entfernung=0;
    var anfahrtskostenergebnis=0;
    var anfahrtskostenergebnis1=0;
    var plz=document.modhochzeitskalk.plz.value;
    //aus den Parametern
    var anfahrtskosten=1;

    if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
    else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
    xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
                entfernung = xmlhttp.responseText;
                if (entfernung > 100 && entfernung < 2000) {
                    anfahrtskostenergebnis1 = anfahrtskosten * entfernung;
                } else {
                    anfahrtskostenergebnis1 = 0;
                }
                    anfahrtskostenergebnis = Math.round(anfahrtskostenergebnis1);
                    document.getElementById("anfahrtskostenergebnis").innerHTML=anfahrtskostenergebnis+",00 &euro;";
          }
    xmlhttp.open("GET","/modules/mod_hochzeitskalk/ogdb_remote.php?plzstart=10245&plzend="+plz,true);
    xmlhttp.send();
    return anfahrtskostenergebnis;
} 
```

我想在另一个函数中使用存储在 var anfahrtskostenergebnis 中的数字，我试过这样：

```
var gesamtkosten = anfahrtskosten() + videokosten() + filmkosten() + fotokosten() + extrakosten(); 
```

但它不起作用，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:21:54.243

因为您使用的是 AJAX，所以在 AJAX 调用返回之前无法继续处理。调用是异步的，意思是程序流程继续，AJAX调用在并行线程中运行。

这样做很有意义，因为替代方法是停止所有脚本活动，同时等待缓慢的网络流量传递结果。

您需要重新构建程序以使用回调函数，这些函数在通过 AJAX 返回值*后调用。*

这应该让你开始，但我怀疑你将不得不为你添加在一起的其他函数做类似的事情，并以某种方式跟踪已经收集的值，一旦它们全部被检索到就运行最终回调。

```
function anfahrtskosten(){
    var xmlhttp;

    ... your original code here...

                    anfahrtskostenergebnis = Math.round(anfahrtskostenergebnis1);

                    // call the callback here, with the value you retrieved
                    callback(anfahrtskostenergebnis); // <~~~~
                    document.getElementById("anfahrtskostenergebnis").innerHTML=anfahrtskostenergebnis+",00 &euro;";
          }
    xmlhttp.open("GET","/modules/mod_hochzeitskalk/ogdb_remote.php?plzstart=10245&plzend="+plz,true);
    xmlhttp.send();
}

var callback = function(anfahrtskosten){
  var gesamtkosten = anfahrtskosten + videokosten() + filmkosten() + fotokosten() + extrakosten();
  // do something with cost...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:20:58.033

您在 if (xmlhttp.readyState==4 ... 之后缺少一个开始大括号 '{' ... （即，您的 if 仅执行第一条语句）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T13:56:16.160

一个非常简单的解决方案或解决方法是将变量存储在文档中的某个地方的 innerhtml 中，我在示例中已经做了

document.getElementById("anfahrtskostenergebnis").innerHTML=anfahrtskostenergebnis+",00 €";

所以第二个函数可以通过从 innerHTML 读取它来重用这个值。在我的情况下，我还需要在执行第二个函数之前设置一个小的超时，以确保

# sql - 当从 int 到 varchar 时如何制作 CASE？

> ID：15114203
> 
> 赞同：1
> 
> 时间：2013-02-27T14:11:06.260
> 
> 标签：sql

我试图制作一个将 INT 更改为 VARCHAR 的 CASE。

```
UPDATE puntentotaal SET Leeftijdhoofdkostwinner = 
(CASE
    WHEN Punten1  22 THEN 35 jaar en jonger
    WHEN Punten1  29 THEN 36 t/m 50 jaar
    WHEN Punten1  39 THEN 51 jaar en ouder
END) 
```

为什么这段代码不起作用？

谢谢你帮助我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:11:42.930

你只需要引号。此外，您原来的案例陈述可以改进一点：

```
UPDATE puntentotaal SET Leeftijdhoofdkostwinner = 
(CASE Punten1 
    WHEN 22 THEN '35 jaar en jonger'
    WHEN 29 THEN '36 t/m 50 jaar'
    WHEN 39 THEN '51 jaar en ouder'
    ELSE '' -- You might want to set some sort of value for this; up to you though
END) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:12:36.237

不应该是：？

```
UPDATE puntentotaal SET Leeftijdhoofdkostwinner = 
(CASE
    WHEN Punten1  22 THEN '35 jaar en jonger'
    WHEN Punten1  29 THEN '36 t/m 50 jaar'
    WHEN Punten1  39 THEN '51 jaar en ouder'
END) 
```

# android - Android谷歌地图apiv2授权失败

> ID：15114204
> 
> 赞同：0
> 
> 时间：2013-02-27T14:11:08.993
> 
> 标签：android, google-maps-api-2

我使用以下两种类型的命令生成密钥库

> *   keytool -genkey -v -keystore mykestorename.jks -alias aliasname & keytool -selfcert -alias aliasname -keystore mykestorename.jks
> *   keytool -genkey -v -keystore mykestorename.keystore -alias 别名 -keyalg RSA -keysize 2048 -validity 1000000

我使用以下命令生成 sha1 密钥

> *   keytool -list -V -alias 别名 -keystore "keystore path"

我在 Google 控制台中创建 API 密钥生成的密钥通过**授权失败**错误并在地图片段中显示灰色纯色背景

# iphone - iPhone可以串流彩信、RTSP（RTP、SDP）、HTTP渐进式串流、HTTP直播串流（M3U8）文件

> ID：15114215
> 
> 赞同：1
> 
> 时间：2013-02-27T14:11:28.793
> 
> 标签：iphone, ios, live-streaming, m3u8

我正在检查 SO 中的一个问题，即[this](https://stackoverflow.com/questions/7063898/android-video-stream-mms-and-m3u8/7064869#7064869)，我认为 iPhone 是否也可以播放这些文件或者它只支持`M3U8`实时流媒体。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T17:26:19.717

我建议查看 RadioTunes SDK。您可能有一次性付款，但它是一个很棒的流媒体解决方案库，您可以将其放入您的应用程序中。我将它用于我以前的一位想要创建 Radio Streaming 应用程序的客户，他非常满意

[http://yakamozlabs.com/products/radiotunes](http://yakamozlabs.com/products/radiotunes)

# php - Facebook Api 程序流程

> ID：15114216
> 
> 赞同：0
> 
> 时间：2013-02-27T14:11:28.980
> 
> 标签：php, facebook-graph-api

我正在制定一个与 Facebook 紧密相连的项目。但是，我有几个与程序流程相关的问题。

用户可以通过 Facebook 进行身份验证，允许我使用用户的 access_token 进行数据查询。现在，当我需要数据时，我调用 api。这种情况发生得更频繁（在不同的页面上，具有为视图提供所需数据所需的字段）。我看到的一个缺点是，每次在我的一个网站的页面上发出请求时，我都会查询 Facebook 的 API。这是一件坏事吗？

另一种选择是将整个数据数组存储在会话中（或在未找到会话时请求它）并从中提取所需的数据，而不仅仅是 fb id 和访问令牌。

如果有人有更好的想法，或者有这方面的经验，把它扔给我。任何提示表示赞赏。

问候，matvp。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:22:14.747

当然，最好存储整个会话可能需要的用户数据，这些数据的简单缓存可以让您避免大量查询。

以下 Stack Overflow 问题可以帮助您：

[您可以存储 Facebook 用户的数据以及存储多长时间？](https://stackoverflow.com/questions/4704003/can-you-store-facebook-users-data-and-for-how-long)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:18:55.573

我想最好查询所有可能需要的数据并将其存储在会话中，然后在您的网站上进一步使用会话。或者，查询您想要的所有数据并将其与 ID 一起存储在您的数据库中，无论您的数据库是什么，然后在您需要数据时查询您的数据库

# java - 最长公共子序列 printdDiff

> ID：15114220
> 
> 赞同：2
> 
> 时间：2013-02-27T14:11:42.943
> 
> 标签：java, algorithm, lcs

只是一个关于最长公共子序列算法的快速问题。我已经完成了您需要生成子序列的部分，如下所示：

```
public int[][] lcsLength(char[] input1, char[] input2) {
    int[][] opt = new int[M][N];
    for (int i = 1; i < input1.length; i++) {
        for (int j = 1; j < input2.length; j++) {
            if (input1[i] == input2[j]) {
                opt[i][j] = opt[i - 1][j - 1] + 1;
            } else {
                opt[i][j] = Math.max(opt[i][j - 1], opt[i - 1][j]);
            }
        }
    }
    return opt;
} 
```

和 printDiff 函数如下：

```
 private static void printDiff(int[][] opt,String x,String y,int i, int j) {

    if(i>0 &&j>0 && x.charAt(i-1)==y.charAt(j-1)){
    printDiff(i-1,j-1);
    System.out.println(x.charAt(i-1));
    }
    else{
        if(j>0&&(i==0||opt[i][j-1]>=opt[i-1][j])){
        printDiff(i-1,j-1);
         System.out.println("-"+y.charAt(j-1));
        }
        else if(i>0&&(j==0|| opt[i][j-1]<=opt[i-1][j])){
        printDiff(i-1,j-1);
         System.out.println(x.charAt(i-1));
        }
    }

} 
```

然后，如果我将其用作参数：

```
String input1="ABCDE"
String input2="ACDC"
int i=input1.length()
int j=input2.length() 
```

在使用 lcsLength() 生成 opt 矩阵后，我希望 printdiff 能给我：

```
ABCDE-
A-CD-C 
```

但相反，我得到：

```
ABCDE-
ABCD-C 
```

关于我做错了什么的任何想法都会对我有很大帮助

谢谢洛朗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:15:50.283

来自[维基](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem#Print_the_diff)：

```
function printDiff(C[0..m,0..n], X[1..m], Y[1..n], i, j)
    if i > 0 and j > 0 and X[i] = Y[j]
        printDiff(C, X, Y, i-1, j-1)
        print "  " + X[i]
    else if j > 0 and (i = 0 or C[i,j-1] ≥ C[i-1,j])
        printDiff(C, X, Y, i, j-1)
        print "+ " + Y[j]
    else if i > 0 and (j = 0 or C[i,j-1] < C[i-1,j])
        printDiff(C, X, Y, i-1, j)
        print "- " + X[i]
    else
        print "" 
```

这一行：

```
else if(i>0&&(j==0|| opt[i][j-1]<=opt[i-1][j])){ 
```

应该：

```
else if(i>0&&(j==0|| opt[i][j-1]<opt[i-1][j])){ 
```

（`<=`改为只是`<`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:52:28.637

不知道这是否是相关问题，但我认为您的 LCS 代码应该是：

```
public int[][] lcsLength(char[] input1, char[] input2) {
    int[][] opt = new int[input1.length+1][input2.length+1];
    for (int i = 1; i <= input1.length; i++) {
        for (int j = 1; j <= input2.length; j++) {
            if (input1[i-1] == input2[j-1]) {
                opt[i][j] = opt[i - 1][j - 1] + 1;
            } else {
                opt[i][j] = Math.max(opt[i][j - 1], opt[i - 1][j]);
            }
        }
    }
    return opt;
} 
```

# spring-mvc - Spring MVC 消除 *.html 模式

> ID：15114225
> 
> 赞同：1
> 
> 时间：2013-02-27T14:11:55.847
> 
> 标签：spring-mvc

我使用带有以下前端控制器配置的 Spring MVC 3.1：

```
<servlet>
        <servlet-name>paymentSystemServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/servlet-config.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>paymentSystemServlet</servlet-name>
        <url-pattern>*.html</url-pattern>
    </servlet-mapping> 
```

因为我有像“* .html”这样的模式，所以我必须做下一件事。我需要在我的所有 url 中添加一个 html 扩展名到控制器（例如，'a href=/admin.html' 使用请求映射 '/admin' 拦截控制器）。我可以配置一些 url-pattern 以避免在我的 url 中添加 html 扩展名吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:25:32.743

通过将 DispatcherServlet 映射到 /，您可以将其用作默认 servlet，它将负责处理所有请求，包括 html、htm 等。

```
<servlet-mapping>
        <servlet-name>spitter</servlet-name>
        <url-pattern>/</url-pattern>
</servlet-mapping> 
```

或者，您可以使用 Spring MVC 3.x[默认 servlet 处理程序](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-default-servlet-handler)来完成这项工作。只需将以下内容添加到 Spring XML 配置中。

```
<mvc:default-servlet-handler/> 
```

# c - Linux：是否可以在进程之间共享代码？

> ID：15114233
> 
> 赞同：4
> 
> 时间：2013-02-27T14:12:04.400
> 
> 标签：c, linux, memory, ipc, mmap

我想知道 linux 进程是否有可能调用位于另一个进程内存中的代码？

假设我们在进程 A 中有一个函数 f()，我们希望进程 B 调用它。我想到的是使用带有 MAP_SHARED 和 PROT_EXEC 标志的 mmap 来映射包含函数代码的内存并将指针传递给 B，假设 f() 不会从 A 二进制调用任何其他函数。它会起作用吗？如果是，那么我如何确定内存中 f() 的大小？

=== 编辑 ===

我知道，共享库会做到这一点，但我想知道是否可以在进程之间动态共享代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:15:36.757

是的，您可以这样做，但第一个进程必须首先通过`mmap`内存映射文件或使用`shm_open`.

如果您共享已编译的代码，那么*这*就是为*.* 您可以以普通方式链接它们，共享将自动发生，或者您可以使用手动加载它们`dlopen`（例如插件）。

* * *

更新：

由于代码是由编译器生成的，因此您将需要担心*重定位。*编译器不会生成可以在任何地方工作的代码。它期望该`.data`部分位于某个位置，并且该`.bss`部分已被归零。需要填充 GOT。必须调用任何静态构造函数。

简而言之，您想要的可能是`dlopen`. 该系统允许您像打开文件一样打开共享库，然后按名称提取函数指针。库中的每个程序都`dlopen`将共享代码段，从而节省内存，但每个程序都有自己的数据段副本，因此它们不会相互干扰。

请注意，您需要编译您的库代码，`-fPIC`否则您也不会获得任何代码共享（实际上，许多架构的链接器和动态加载器可能不支持无论如何都不是 PIC 的库）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T14:15:38.507

标准方法是将 的代码`f()`放在共享库`libfoo.so`中。然后您可以链接到该库（例如通过使用 构建程序A *）* ，或者使用[dlopen(3)](http://www.kernel.org/doc/man-pages/online/pages/man3/dlopen.3.html)`gcc -Wall a.c -lfoo -o a.bin`动态加载它（例如在程序*B*中），然后检索using的地址。`f``dlsym`

当你编译一个共享库时，你想要：

*   `foo1.c`用`gcc -Wall -fPIC -c foo1.c -o foo1.pic.o`into[位置无关的代码](http://en.wikipedia.org/wiki/Position-independent_code)编译每个源文件，同样 for `foo2.c`into`foo2.pic.o`
*   将它们全部链接到`libfoo.so`with `gcc -Wall -shared foo*.pic.o -o libfoo.so`; 请注意，您可以将其他共享库链接到`lbfoo.so`（例如，通过附加`-lm`到链接命令）

另请参阅[程序库操作方法](http://tldp.org/HOWTO/Program-Library-HOWTO/)。

`mmap`你可以通过-ing 其他一些来玩疯狂的把戏，  `/proc/1234/mem`但这根本不合理。使用共享库。

PS。您可以`dlopen`拥有大量（数十万）共享对象`lib*.so`文件；您可能想要`dlclose`他们（但实际上您不必这样做）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T14:38:41.770

这样做是可能的，但这正是共享库的用途。

另外，请注意，您需要检查两个进程的共享内存地址是否相同，否则任何“绝对”引用（即指向共享代码中某些内容的指针）。与共享库一样，代码的位数必须相同，并且与所有共享内存一样，如果您修改任何共享内存，您需要确保不会“搞砸”其他进程记忆。

确定函数大小的范围从“困难”到“几乎不可能”，具体取决于生成的实际代码和可用信息的级别。调试符号将具有函数的大小，但请注意，我已经看到编译器生成代码，其中两个函数共享相同的“返回”代码段（即，编译器生成跳转到具有相同代码位的另一个函数返回结果，因为它节省了几个字节的代码，并且无论如何已经存在跳转[例如，编译器必须跳转的 if/else]）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-15T21:23:52.070

*   *不直接*
*   *这就是共享库的用途*
*   *搬迁*

**不好了！无论如何...**

这是这种能力的疯狂，不合理，不好，纯粹的学术证明。这对我来说很有趣，我希望它对你来说很有趣。

### 概述

程序`A`将使用`shm_open`创建一个共享内存对象，并将`mmap`其映射到它的内存空间。然后它将一些代码从定义的函数复制`A`到共享内存中。然后程序`B`会打开共享内存，执行函数，只是为了好玩，对代码做一个非常简单的修改。然后`A`将执行代码来演示更改已生效。

同样，这不是关于如何解决问题的建议，而是学术演示。

```
// A.c
#include <stdio.h>
#include <string.h>

#include <unistd.h>

#include <fcntl.h>
#include <sys/mman.h>
#include <sys/stat.h>

int foo(int y) {
  int x = 14;
  return x + y;
}

int main(int argc, char *argv[]) {
  const size_t mem_size = 0x1000;
  // create shared memory objects
  int shared_fd = shm_open("foobar2", O_RDWR | O_CREAT, 0777);
  ftruncate(shared_fd, mem_size);
  void *shared_mem =
      mmap(NULL, mem_size, PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, shared_fd, 0);
  // copy function to shared memory
  const size_t fn_size = 24;
  memcpy(shared_mem, &foo, fn_size);
  // wait
  getc(stdin);
  // execute the shared function
  int(*shared_foo)(int) = shared_mem;
  printf("shared_foo(3) = %d\n", shared_foo(3));
  // clean up
  shm_unlink("foobar2");
} 
```

注意`PROT_READ | PROT_WRITE | PROT_EXEC`在调用中使用`mmap`. 这个程序是用

```
gcc A.c -lrt -o A 
```

常数`fn_size`是通过查看输出来确定的`objdump -dj .text A`

```
...
000000000000088a <foo>:
 88a:   55                      push   %rbp
 88b:   48 89 e5                mov    %rsp,%rbp
 88e:   89 7d ec                mov    %edi,-0x14(%rbp)
 891:   c7 45 fc 0e 00 00 00    movl   $0xe,-0x4(%rbp)
 898:   8b 55 fc                mov    -0x4(%rbp),%edx
 89b:   8b 45 ec                mov    -0x14(%rbp),%eax
 89e:   01 d0                   add    %edx,%eax
 8a0:   5d                      pop    %rbp
 8a1:   c3                      retq   
... 
```

我认为这是`24`字节，我不知道。我想我可以放任何比这更大的东西，它也会做同样的事情。任何更短的东西，我可能会从处理器那里得到一个例外。另外，请注意`x`from `foo`( `14`，即（显然）`0e 00 00 00`在 LE 中）的值位于`foo + 10`。这将是`x_offset`program中的常量`B`。

```
// B.c
#include <stdio.h>

#include <unistd.h>

#include <sys/mman.h>
#include <sys/stat.h>
#include <fcntl.h>

const int x_offset = 10;

int main(int argc, char *argv[]) {
  // create shared memory objects
  int shared_fd = shm_open("foobar2", O_RDWR | O_CREAT, 0777);
  void *shared_mem = mmap(NULL, 0x1000, PROT_EXEC | PROT_WRITE, MAP_SHARED, shared_fd, 0);
  int (*shared_foo)(int) = shared_mem;
  int z = shared_foo(13);
  printf("result: %d\n", z);
  int *x_p = (int*)((char*)shared_mem + x_offset);
  *x_p = 100;
  shm_unlink("foobar");
} 
```

**反正**我先跑`A`，再跑`B`。的输出`B`是：

```
result: 27 
```

然后我返回`A`并 push `enter`，然后我得到：

```
shared_foo(3) = 103 
```

对我来说已经足够好了。

### /dev/shm/foobar2

为了完全消除这一切的神秘感，运行后`A`你可以做类似的事情

```
xxd /dev/shm/foobar2 | vim - 
```

然后，像以前一样编辑该常量`0e 00 00 00`，然后使用 'ol

```
:w !xxd -r > /dev/shm/foobar2 
```

并推`enter`入`A`并查看与上述类似的结果。

# php - 使用 strlen 和 strtok 进行 iconv 后的问题

> ID：15114244
> 
> 赞同：0
> 
> 时间：2013-02-27T14:12:48.173
> 
> 标签：php, strtok, iconv, ucs2

我编写了一个代码来将输入的 UCS-2LE 文件转换为普通的 8 位 ISO-8859-1 文本。转换后，我使用 strtok 函数将整个文本拆分为单词。现在我正在对获得的每个单词应用 strlen，但是我的单词长度很奇怪，我无法理解。

```
<?php
$fileData = file('input.txt');

foreach( $fileData as $txt ){

    $txt = iconv( 'ISO-8859-1', 'UCS-2LE', $txt );
    $tok = strtok($txt, " \n\t");
    while ($tok !== false) {
        echo 'Word = '.$tok.', Length = '.strlen($tok).'<br />';
        $tok = strtok(" \n\t");
    }
}
?> 
```

输入文件，文件名 = input.txt（在 UCS-2LE 中）是

```
 Slot#  NumJobs ActiveJobID ActiveBatchJob  ActiveProcStartTime
 0  0   1   input3.dat  7:20 PM
 1  0   2   input3.dat  7:20 PM 
```

输出是

```
Word = ÿþSlot#, Length = 24
Word = NumJobs, Length = 31
Word = ActiveJobID, Length = 47
Word = ActiveBatchJob, Length = 59
Word = ActiveProcStartTime , Length = 83
Word = , Length = 1
Word = 0, Length = 6
Word = 0, Length = 7
Word = 1, Length = 7
Word = input3.dat, Length = 43
Word = 7:20, Length = 19
Word = PM , Length = 15
Word = , Length = 1
Word = 1, Length = 6
Word = 0, Length = 7
Word = 2, Length = 7
Word = input3.dat, Length = 43
Word = 7:20, Length = 19
Word = PM , Length = 15
Word = , Length = 1
Word = , Length = 2 
```

1）长度显示不正确是怎么回事。

2) 输出中的第 6 行是新行字符，它没有被 strtok 正确标记。为什么？

3）我读了一点BOM，我知道文件中的前两个字符用于识别所用字符的格式。有没有办法避免这些字符，比如在输出的第一行，它显示了两个额外的字符。

在此先感谢您的帮助。

# jboss - Jboss AS 7 中的主要性能问题

> ID：15114245
> 
> 赞同：0
> 
> 时间：2013-02-27T14:12:56.283
> 
> 标签：jboss, transactions, ejb, jboss7.x, application-server

我参与了一个项目，我们最近将应用程序服务器更改为 Jboss AS 7 (EAP 6)。该系统是在域模式下运行的 Jboss 安装，其中一台服务器（服务器 A）包含 EJB 连接到关系数据库，另一台（服务器 B）作为前端节点，主要是 JSP 连接到服务器 A。

在开始我们的负载和性能测试之前，我想在这里问一下。

问题：

> 在运行事务性 EJB 和 JSP Web 接口的混合的域模式下的 Jboss AS 7 (EAP 6) 上需要哪些主要缺陷和性能调整？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T09:33:23.760

最大的性能问题通常是在不同的服务器上分离 EJB bean 和 UI 代码。

这种模式在 2001 年被提倡，因为“分布式对象”的概念在当时听起来很酷。

在许多失败且缓慢的 IT 项目之后，人们开始思考：我们到底为什么要在任意两段代码之间放置一个慢速网络？我们赢了什么？

答案一成不变。如果有的话，没什么。

长话短说; 不要将 Servlet、JSP 页面和 JSF Servlet 放在不同的服务器上。将您的 EJB 放在同一个 EAR 中，或者甚至考虑将它们放在同一个战争中（只需创建一个包“业务”）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-05T09:56:13.500

在我们的 JBoss 7 项目中，最大的性能贡献者之一是服务器没有经过微调，即默认情况下它运行许多未使用和不需要的服务。这些服务影响应用程序生命周期的几乎所有方面，例如部署速度、响应能力、内存和磁盘占用。

# javascript - 剑道网格中的子项

> ID：15114248
> 
> 赞同：0
> 
> 时间：2013-02-27T14:13:08.953
> 
> 标签：javascript, jquery, kendo-ui, parent-child, kendo-grid

如何将我的子数据绑定在一列中？我想在同一列和同一行中写“技术、经济、生活”。但我认为我需要循环进入“类别”。我该怎么做，有什么想法吗？

我的数据：

```
{
    "ParentId": "00000000-0000-0000-0000-000000000000",
    "Title": null,
    "UserGroupModel": null,
    "EntityAccessData": [
        {
            "EntityTitle": "User",
            "Access": {
                "Id": "59d0c6f7-8f93-497a-854d-bdd4a42ade94",
                "Title": "Can Delete"
            },
            "Category": [
                {
                    "Id": "00000000-0000-0000-0000-000000000000",
                    "Title": "Technology"
                },
                {
                    "Id": "00000000-0000-0000-0000-000000000000",
                    "Title": "Economy"
                },
                {
                    "Id": "00000000-0000-0000-0000-000000000000",
                    "Title": "Life"
                }
            ],
            "HasAccess": true
        },
        {
            "EntityTitle": "UserGroup",
            "Access": {
                "Id": "7c65be44-11b0-4cf4-9104-0ad999e7e280",
                "Title": "Can Edit"
            },
            "Category": [
                {
                    "Id": "00000000-0000-0000-0000-000000000000",
                    "Title": "Technology"
                },
                {
                    "Id": "00000000-0000-0000-0000-000000000000",
                    "Title": "Economy"
                },
                {
                    "Id": "00000000-0000-0000-0000-000000000000",
                    "Title": "Life"
                }
            ],
            "HasAccess": true
        }
    ]
} 
```

我的脚本：

```
 $("#grid").kendoGrid({
        dataSource: {
            type: "json",
            transport: {
                read: "/getData" },

            schema: {
                data: "EntityAccessData"

            },

                group: [{
                field: "EntityTitle"
            }],

        },
        columns: [
        {
            field: "Access.Id",
            title: "ID"
        },
        {
            field: "Access.Title",
            title: "Access title"
        },
        {
            field: "HasAccess",
            title: "has access"
        },
        {
            field: "Category.Title", // ***wrong***
            title: "Category"
        },
        ]

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:05:45.953

定义`schema`如下：

```
schema: {
    data : "EntityAccessData",
    model: {
        CategoryTitle: function () {
            var category = [];
            $.each(this.Category, function(idx, elem) {
                category.push(elem.Title);
            });
            return category.join(",");
        }
    }

}, 
```

我在其中添加了一个附加字段，该字段`CategoryTitle`是加入数组的结果`Title`，`Category`然后将其定义`column`为：

```
{
    field: "CategoryTitle()",
    title: "Category"
} 
```

# java - Files.isWritable 有问题

> ID：15114256
> 
> 赞同：0
> 
> 时间：2013-02-27T14:13:28.690
> 
> 标签：java, io

服务器：192.168.0.18/share是一个samba服务器，所有的都可以写入该路径

```
Files.write(Paths.get(URI.create("file://192.168.0.18/share/aa/aaaa")), "asd34234asdasd".getBytes(), StandardOpenOption.CREATE,StandardOpenOption.APPEND);

System.out.println(Files.isWritable(Paths.get(URI.create("file://192.168.0.18/share/aa/aaaa")))); 
```

我发现第一行确实创建了一个文件，并在其中添加了文本。

但第二行返回 false 。

我不知道为什么。

我尝试 JDK7_u5 & u13 。

谢谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:48:12.740

如果`"file://192.168.0.18/share/aa/aaaa"`检查时不存在，则应测试（现有）目录上的可写标志，`"file://192.168.0.18/share/aa/"`如下所示：

```
Path target=Paths.get(URI.create("file://192.168.0.18/share/aa/aaaa");
if (Files.exists(target)){  // check existing file
    System.out.println(Files.isWritable(target));
}else{ // check directory
    System.out.println(Files.isWritable(target.getParent()));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:43:18.470

写入共享时，文件属性并不总是可用，因此代码告诉您的是它无法确定文件是否可读。

在实际上由不同操作系统托管的文件系统上进行文件操作时，很多时候都是如此 - 低级文件属性并不总是暴露给客户端。

如果你这样做`new File(<your file>).exists()`了，它几乎肯定会返回`true`，所以要确定你所看到的原因是否确实与属性相关，你可以尝试：

```
DosFileAttributes attr =Files.readAttributes(<your file>, DosFileAttributes.class); 
```

或者

```
PosixFileAttributes attr = Files.readAttributes(<your file>, PosixFileAttributes.class); 
```

并询问结果以查看您是否获得有意义/预期的属性

# java - 写入 .doc 文件

> ID：15114257
> 
> 赞同：2
> 
> 时间：2013-02-27T14:13:31.940
> 
> 标签：java, utf-8, doc

我正在尝试将阿拉伯语句子写入 .doc 文件。但是每次我打开 .doc 文件时，它都会显示一条消息，说明文件转换，并询问我想以哪种 Unicode 显示 .doc 文件，因此我保留 Unicode(UTF-8)，一切正常。

这是我写入文件的代码：

```
PrintWriter print = new PrintWriter(new FileOutputStream(newFile+".doc", true));
print.println(toString());
print.println();
print.close(); 
```

用户选择的文件在哪里`newFile`（用户没有添加扩展名）， `toString()`是一个将要写入文件的整个句子组合在一起的功能。

我的问题是，每次打开 .doc 文件时都必须查看此文件转换吗？

我已经尝试在 net beans 中打开项目的属性并输入编码：UTF-8！

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:27:36.150

你不是在写`.doc`文件。您正在编写一个简单的文本文件并调用它`.doc`。

要使其作为`.doc`文件工作，您需要编写实际写入`.doc`文件格式的代码（或使用诸如[Apache POI](https://poi.apache.org/)之类的库来为您完成。

如果 Word 找到一个不是文件的`.doc`文件，它会尝试将其解释为文本文件，但需要知道编码，这就是您获得对话框的原因。

# java - 你能在 Linux 中仅使用名称运行 Java 程序，而不使用“java”命令吗？

> ID：15114262
> 
> 赞同：2
> 
> 时间：2013-02-27T14:13:46.790
> 
> 标签：java, linux, terminal, command-line-interface

如果我正在编写 HelloWorld，是否可以通过键入 HelloWorld 从任何目录运行程序？设置好 Ant 之后的方式是一样的，您可以从任何目录运行 Ant 吗？

只是为了一些细节，我们正在为客户创建一个基于 CLI 的工具包，只是好奇我们是否可以编译、安装它，并让他们使用工具包名称运行它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T14:15:27.350

您始终可以创建一个 shell 脚本，调用它`HelloWorld`并使其`java`与您的 JAR 一起运行。

然后，您需要[`chmod`](http://linux.die.net/man/1/chmod)脚本使其可执行，并将其放置在`$PATH`.

该脚本将类似于：

```
#!/bin/bash
cd /path/to/helloworld
java -jar HelloWorld.jar "$@" 
```

或者

```
#!/bin/bash
java -jar /path/to/helloworld/HelloWorld.jar "$@" 
```

取决于您的具体要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T14:20:08.423

您的问题的常见解决方案是创建一个单独的启动器应用程序，它是运行您的 Java 程序的非 Java 应用程序。Launcher 可以用一些可编译的语言（例如 C/C++）编写并编译成本机可执行文件。它也可以用一些解释性语言编写，例如 Unix shell、perl、python 等，并通过`#!/path/to/interpreter`在启动器文件的开头添加行并在其上设置可执行标志来使其可执行。还有一些实用程序可以为您的程序生成启动器，例如[launch4j](http://launch4j.sourceforge.net/)或[jsmooth](http://jsmooth.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:51:39.073

在 Linux（特别是）上，您可以使用`/proc`文件系统（参见[proc(5)](http://www.kernel.org/doc/man-pages/online/pages/man5/proc.5.html)手册页）及其[binfmt_misc](http://en.wikipedia.org/wiki/Binfmt_misc)（实际上是`/proc/sys/fs/binfmt_misc/register`伪文件和 下的其他伪文件`/proc/sys/fs/binfmt_misc/`）注册`java`为`.class`或`.jar`文件的处理程序。阅读内核源代码中的[Documentation/binfmt_misc.txt文件以获取详细信息。](http://www.kernel.org/doc/Documentation/binfmt_misc.txt)

然后任何可执行`.jar`文件将由`java`（或`jexec`）解释

我不确定这是否值得。我发现将您的 Java 程序包装在一些 shell 脚本中要容易得多（并且更便携，因为实际上很少有 Linux 系统使用`binfmt_misc`.，而且您的客户可能需要一些系统管理员技能才能启用它）。

# oop - 处理来自 HTTPWebRequest/HTTPWebResponse 的错误

> ID：15114266
> 
> 赞同：1
> 
> 时间：2013-02-27T14:13:56.957
> 
> 标签：oop

我有一个名为*Hotmail*的类，其中包含各种方法，例如登录、注销等。

为了说明我遇到的困惑，我有一个登录方法，可以通过我的软件将用户登录到 Hotmail。login 方法返回一个 HttpWebResponse 对象。但是，在登录方法中，可能会发生许多事情，例如输入错误的凭据或超时。

我对如何以及在何处处理此类错误感到有些困惑。

在输入错误凭据或超时的情况下，返回 HttpWebResponse 对象将毫无意义，或者有时无法返回。处理此类错误的最佳方法是什么？

我应该创建自定义异常，以便调用该方法的代码可以检查此类错误并处理它们吗？

我确信这是一个常见的混淆点，处理这些错误的传统方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T11:29:58.357

假设你有类似`Hotmail>>login(user, password)`我肯定会使用异常的东西。粒度有多细取决于您（和您的域模型），并且很难达到平衡。

对于这种情况，我肯定会为最重要的事件（如`WrongCredentialsException`）设置异常，但我不会为每个 4XX 和 5XX 响应错误设置一个异常类。但是，根据您的领域和个人喜好，您可以使用`ClientException`and `ServerException`，并使用一个实例变量来说明错误号，而不仅仅是使用`ConnectionException`.

高温高压

# ruby - 覆盖“+”方法

> ID：15114267
> 
> 赞同：0
> 
> 时间：2013-02-27T14:13:58.997
> 
> 标签：ruby

在理解 ruby​​ 的过程中，我试图用默认参数值覆盖“+”。像这样的东西。

```
class C
  def something(a = 5)
    puts "Received: #{a}"
  end

  def +(b = 10)
    puts "Received: #{b}"
  end
end 
```

现在

```
x = C.new
x.something #=> Received: 5
x.something(88) #=> Received: 88

x.+ #=> IRB shows ? whereas I was expecting an output 'Received: 10' 
```

这是因为运算符优先级吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:20:28.733

IRB 的问题（看起来它不处理这种情况）。如果您创建单独的 .rb 文件并运行它，您将获得预期的输出：

```
Received: 5
Received: 88
Received: 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T14:31:45.247

IRB 正在解析`+`并期待二进制操作的第二个参数。如果您提供括号，它可以正常工作：

```
x.+()  #=> Received: 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:56:22.137

IRb 使用与 Ruby 不同的解析器。因此，在一些奇怪的极端情况下，IRb 解析代码的方式可能与 Ruby 不同。如果你想查看某个东西是否是有效的 Ruby，你应该问 Ruby 而不是 IRb。

这样做的原因主要是 Ruby 总是一次解析整个文件，所以它总是知道表达式何时结束。另一方面，IRb 必须在每次按下时“猜测”`ENTER`您是只想在新行上继续表达式还是要按原样评估表达式。因此，IRb*不能*只使用 Ruby 解析器，它需要有自己的。而且 Ruby 的语法非常复杂，编写自己的解析器真的很难。这就是为什么即使在像 IRb 一样古老且广泛使用的软件中也会不时出现此类错误和极端情况的原因。

# java - JSF 2.1 使用 Ajax 同时验证两个输入

> ID：15114276
> 
> 赞同：0
> 
> 时间：2013-02-27T14:14:24.893
> 
> 标签：java, jsf-2, validation, customvalidator

我在同时验证两个输入时遇到问题。

在我的验证器中，我需要来自两者的数据：

1.  `<h:selectOneListbox>`
2.  `<h:inputText>`

这个想法是检查送货人员是否可以到达地址。在验证期间，我向 DB 发出请求。并寻找 streetName + houseNumber 的组合。

### 这是我的 JSF 页面的一部分。

```
 <h:form>
        <p> 
            <h:outputLabel for="streetsList" value="Street"/>
            <h:selectOneListbox id="streetsList" binding="#{theStreetsList}" 
                                size="1" value="#{makeOrder.streetName}" required="true">
                <f:selectItems value="#{locationView.streetNames}" var="streetName" 
                               itemLabel="#{streetName}" itemValue="#{streetName}"/>
            </h:selectOneListbox>
        </p>

        <p class="address_details">
            <h:outputLabel for="houseInput" value="#{msgs.house}"/>
            <h:inputText id="houseInput" class="tab_input house_input" 
                         value="#{makeOrder.house}" required="true">
                <f:validator validatorId="AddressValidator" />
                <f:attribute name="street" value="#{theStreetsList}" />
                <f:ajax event="blur" execute="streetsList houseInput" render="m_houseInput" />
            </h:inputText>
            <h:message id="m_houseInput" for="houseInput" style="color:red" />

            <h:outputLabel for="flatInput" class="flat_label" value="#{msgs.flat}"/>
            <h:inputText class="tab_input flat_input" value="#{makeOrder.flat}"/>
        </p>
    </h:form> 
```

### 这是我班级的验证方法：

```
@Override
public void validate(FacesContext context, UIComponent component, Object value) 
        throws ValidatorException {

    String house = (String) value;

    UIInput streetsComponent = (UIInput) component.getAttributes().get("street");
    String streetName = (String) streetsComponent.getSubmittedValue();

    Street orderStreet = this.findStreetInDB(streetName, house);

    if (orderStreet.getName().equals("dummyStreet")) {

        // Show error
        FacesMessage msg = new FacesMessage(
                "Unfortunately we do not deliver to this address, yet.");
        msg.setSeverity(FacesMessage.SEVERITY_ERROR);
        throw new ValidatorException(msg);
    }
} 
```

我的问题`String streetName`是`null`。

**该元素的**PS值渲染得很好。**如果我不使用验证，我什至可以提交表单。**

 ***   我究竟做错了什么？
*   这样做的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:06:15.647

> *表示提交值的 String streetName 现在为空。*

组件按照它们在组件树中出现的顺序进行处理。在处理过程中，获取、转换和验证提交的值。如果任何事情都成功，则转换/验证的值设置为组件的值，提交的值设置为`null`.

对于 2 个组件上的验证器，只有在第一个组件上调用验证器时，才能获取另一个组件的提交值。但是在您的情况下，它是在第二个组件上调用的，您应该使用`UIInput#getValue()`而不是`getSubmittedValue()`. 请注意，这将返回转换和验证的值，因此不是“原始”提交的值。**

# javascript - IE10 上的 WebSocket 给出 SecurityError

> ID：15114279
> 
> 赞同：56
> 
> 时间：2013-02-27T14:14:30.013
> 
> 标签：javascript, websocket, internet-explorer-10

我目前正在使用 JavaScript 中的 WebSockets 在 IE10（在 Windows 8 上）下开发一个网站。它在 Firefox 18 和 Chrome 25 下运行良好，但在 IE10 上，当我建立连接时出现 SecurityError。

我在做什么似乎很简单：

```
websocket = new WebSocket('wss://hello.dev.mydomain.net'); 
```

但 IE 不喜欢它：

```
SCRIPT5022: SecurityError 
```

该脚本位于“ [https://test.dev.mydomain.net](https://test.dev.mydomain.net) ”（显然不是真实地址）。

困扰我的是，如果我只是双击本地计算机上的文件（例如 file://...），它就可以工作。更糟糕的是：如果我使用**fiddler**来监控 HTTP 流量......它**也可以工作**。而没有提琴手似乎根本没有连接，如 API 规范中所述。（见下文。）

从[websocket 规范](https://html.spec.whatwg.org/multipage/web-sockets.html#the-websocket-interface)来看，异常也应该出现在 Chrome/Firefox 上......但它没有。所以我怀疑它是否与 HTTP/HTTPS 相关。无论如何，我在 httpS 页面上使用 wsS 套接字......此外：当我用在线示例中找到的另一个有效服务器替换 wss 地址时，它可以工作。

我不知道这是否相关，但是来自 test.dev.mydomain.net 的 IP 是 10.14.xx 其中 hello.dev.mydomain.net 是 194.247.xx 我不知道它是否会触发某种安全性仅在 IE 上...

还有一件事：我有 *.dev.mydomain.net 的证书，IE 似乎没有问题。该脚本最初驻留在名为 my.name.dev.mydomain.net 的服务器上，但由于我是从另一个 URL 访问它（我得到了一个重定向，因为我们最初认为它可能是某种同源策略问题），我不明白这有什么关系。至少我希望它不会...

欢迎任何想法。

编辑：将站点添加到受信任区域也不起作用。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-11-22T12:42:17.877

*如果您尝试在本地（内部网）*域上打开 websocket，IE 似乎会引发 SecurityError 。为了克服这个问题，您可以禁用 IE 识别本地站点的自动算法。这可以在`Tools > Internet Options > Security > Local Intranet > Sites`.

![内网检测设置](../Images/43468e97e0375413d460881169c53a93.png)

取消选中所有复选框（或仅选中一个特定的复选框，如果您知道您的域在 Intranet 中的最终结果如何）。

请注意，IE 使用（除其他外）其代理设置来确定本地站点：如果您的域在代理设置中被列为排除在代理之外，那么它可能会被视为 Intranet 之一。这就是启用 Fiddler 后 WebSockets 工作的原因：它会修改 IE 代理设置，因此 Intranet 站点列表会发生变化。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-01-13T21:27:03.677

应用安全补丁*后*，我在 Windows7/IE11 中遇到了这个问题。对于 Windows10/Edge 来说也是如此。

由于这是一个本地 websocket (ws://localhost)，您必须添加`ws:\\localhost\`到 Internet Explorer 配置（工具 > Internet 选项 > 安全 > 本地 Intranet > 站点 > 高级）。

[![IE11本地内网站点配置](../Images/171bffe6e58465fc28498b507bc1f4d4.png)](https://i.stack.imgur.com/x7rQZ.png)

在**Windows 10/Microsoft Edge**中，您将在控制面板 > Internet 选项中找到此配置。

**更新**

您的 webapp ( [https://test.dev.mydomain.net](https://test.dev.mydomain.net) ) 的地址也必须添加到*本地 Intranet 区域*。*请注意*，应在图像中添加 webapp 地址。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-05T16:50:59.887

好吧，我的问题没有那么成功，所以我会发布我找到的“解决方法”。

我在 194.247 中获得了该网站的另一个地址。*.* 也。这神奇地解决了它。Guess IE 不喜欢混合本地和外部的东西并监视 IP。

无论如何，我希望这对遇到同样问题的人有用。

如果您有通过配置 IE 解决“真正”问题的解决方案，请告诉我 :)

干杯，

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-07-17T09:31:39.197

浏览器有 websocket 限制。例如，Internet Explorer 将 websocket 连接的默认限制设置为每个主机头名称 6 个。为 WinForms WebBrowser 组件设置了相同的限制。

解决方案是在注册表中的键 Computer [\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_WEBSOCKET_MAXCONNECTIONSPERSERVER](https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/general-info/ee330736(v=vs.85)#websocket-maximum-server-connections)下添加值。只需添加带有可执行文件名称的 DWORD 值，例如 iexplore.exe（或您的应用程序可执行文件名称，如果您使用 Web 浏览器组件）并从 2..128 范围内设置值

如何解决 SecurityException 的第二个选项是创建多个子域。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-24T12:52:04.070

客户端主机名/IP 地址应与正在侦听的服务器 IP/主机名相同，否则您将收到上述错误。

1）确保服务器主机名是否配置为侦听 IP/localhost 等，如果没有明确指定主机名 ast server

2）在客户端使用相同的主机名。这将解决问题。它对我有用...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-12T17:36:44.530

我遇到了错误（虽然它没有说 SCRIPT5022 部分，而只是报告“ScriptError”）。我通过单击“受信任的站点”然后添加托管远程 websocket 的机器解决了这个问题。请注意，要添加到受信任的站点，

*   我必须提供不带“ws://”部分的地址（例如 mymahcine.mydomain.com）

*   我不得不取消选中“需要服务器验证 https:// ”选项的框。

*   完成添加域后，我重新选中了“需要服务器验证 (https://)”框。我建议每个人都这样做。取消选中该框只是添加不以开头的站点的一种解决方法https（在我的情况下是 ws://）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-22T19:50:36.920

我在一个客户的环境中遇到了同样的问题。原来他们有一个代理配置，不允许直接连接到 WebSocket 端点，也不支持 WebSocket 协议。临时解决方案是禁用代理，一切都开始工作了。长期的解决方案是编辑代理的配置（.pac 文件）以排除 WebSocket 端点的地址。

要禁用代理，请转至：Internet Explorer 选项 > 连接选项卡 > LAN 设置按钮 > 取消选中自动检测设置。

希望这可以帮助某人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-16T13:17:43.610

除了确保 Internet 区域不是 localhost（如上面的答案）外，还要确保如果使用 https，则应使用 wss。

这在其他浏览器中不是问题，但 IE 有点挑剔。

[![在此处输入图像描述](../Images/0073cc916c0a96d9245ef6c75b5d9e63.png)](https://i.stack.imgur.com/Oaz5g.png)

# eclipse - 如何在 Grails 工具套件上的 Groovy 中使用 Springsource 模板？

> ID：15114280
> 
> 赞同：0
> 
> 时间：2013-02-27T14:14:43.450
> 
> 标签：eclipse, spring-mvc

我在 Grails Toolssuite 3.1.0 上使用 Groovy。

我想为 Spring MVC 应用程序使用模板。

我没有找到我期望的模板`File – > New -> New Spring Template Project -> Spring MVC Project`

有人在 Grails 工具套件上的 Groovy 中使用过 SpringSource 模板吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:35:22.067

我使用`help -> install new software`然后`http://dist.springsource.com/release/TOOLS/update/e3.8`作为更新站点进入并安装了 Spring IDE 的 Core、Extensions、Integrations 和 Resources。

# antlr - Antlr 中使用括号的优先级

> ID：15114281
> 
> 赞同：1
> 
> 时间：2013-02-27T14:14:46.167
> 
> 标签：antlr, antlr3, lexer

我们正在开发 DSL，我们面临一些问题：

**问题 1：**
在我们的 DSL 中，允许这样做：
`A + B + C`

但不是这个：
`A + B - C`

如果用户需要使用两个或更多不同的运算符，他需要插入括号：
`A + (B - C)`
或
`(A + B) - C`。

**问题 2：** 在我们的 DSL 中，最先例的运算符必须用括号括起来。

例如，不要使用这种方式： `A + B * C`

用户需要使用这个： `A + (B * C)`

为了解决**问题 1**，我有一段 ANTLR 有效，但我不确定这是否是解决它的最佳方法：

```
sumExpr
@init {boolean isSum=false;boolean isSub=false;}
    : {isSum(input.LT(2).getText()) && !isSub}? multExpr('+'^{isSum=true;} sumExpr)+
    | {isSub(input.LT(2).getText()) && !isSum}? multExpr('-'^{isSub=true;} sumExpr)+
    | multExpr; 
```

要解决**问题 2**，我不知道从哪里开始。

感谢您帮助找到第一个问题的更好解决方案和解决第二个问题的方向。（对不起，我的英语不好）

下面是我们开发的语法：

```
grammar TclGrammar;

options {
    output=AST;
    ASTLabelType=CommonTree;
}

@members {
    public boolean isSum(String type) {
    System.out.println("Tipo: " + type);
    return "+".equals(type);
}

public boolean isSub(String type) {
    System.out.println("Tipo: " + type);
    return "-".equals(type);
}
}

prog    
: exprMain ';' {System.out.println( 
    $exprMain.tree == null ? "null" : $exprMain.tree.toStringTree());}
;

exprMain
:   exprQuando? (exprDeveSatis | exprDeveFalharCaso)
;

exprDeveSatis
: 'DEVE SATISFAZER' '{'! expr '}'!
;

exprDeveFalharCaso
: 'DEVE FALHAR CASO' '{'! expr '}'! 
;

exprQuando
: 'QUANDO' '{'! expr '}'!
;

expr    
: logicExpr
;

logicExpr
:   boolExpr (('E'|'OU')^ boolExpr)*
;

boolExpr
: comparatorExpr
| emExpr
| 'VERDADE'
| 'FALSO'
;

emExpr
: FIELD 'EM' '[' (variable_lista | field_lista) comCruzamentoExpr? ']'
-> ^('EM' FIELD (variable_lista+)? (field_lista+)? comCruzamentoExpr?)
;

comCruzamentoExpr
: 'COM CRUZAMENTO' '('  FIELD ';' FIELD (';' FIELD)* ')' -> ^('COM CRUZAMENTO' FIELD+)
;

comparatorExpr
: sumExpr (('<'^|'<='^|'>'^|'>='^|'='^|'<>'^) sumExpr)?
| naoPreenchidoExpr
| preenchidoExpr
;

naoPreenchidoExpr
: FIELD 'NAO PREENCHIDO' -> ^('NAO PREENCHIDO' FIELD)
;

preenchidoExpr
: FIELD 'PREENCHIDO' -> ^('PREENCHIDO' FIELD)
;

sumExpr
@init {boolean isSum=false;boolean isSub=false;}
: {isSum(input.LT(2).getText()) && !isSub}? multExpr('+'^{isSum=true;} sumExpr)+
| {isSub(input.LT(2).getText()) && !isSum}? multExpr('-'^{isSub=true;} sumExpr)+
| multExpr
;

multExpr
: funcExpr(('*'^|'/'^) funcExpr)?
;

funcExpr
: 'QUANTIDADE'^ '('! FIELD ')'!
| 'EXTRAI_TEXTO'^ '('! FIELD ';' INTEGER ';' INTEGER ')'! 
| cruzaExpr
| 'COMBINACAO_UNICA' '(' FIELD ';' FIELD (';' FIELD)* ')' -> ^('COMBINACAO_UNICA' FIELD+)
| 'EXISTE'^ '('! FIELD ')'!
| 'UNICO'^ '('! FIELD ')'!
| atom
;

cruzaExpr
:   operadorCruzaExpr ('CRUZA COM'^|'CRUZA AMBOS'^) operadorCruzaExpr ondeExpr?
;

operadorCruzaExpr
:   FIELD('('!field_lista')'!)?
;

ondeExpr
:   ('ONDE'^ '('!expr')'!)
;

atom
: FIELD 
| VARIABLE
| '('! expr ')'!
;

field_lista
: FIELD(';' field_lista)?
;

variable_lista
: VARIABLE(';' variable_lista)?
;

FIELD  
:   NONCONTROL_CHAR+
    ;

NUMBER
:   INTEGER | FLOAT
;

VARIABLE
: '\'' NONCONTROL_CHAR+ '\''
;

fragment SIGN: '+' | '-';   
fragment NONCONTROL_CHAR: LETTER | DIGIT | SYMBOL;
fragment LETTER: LOWER | UPPER;
fragment LOWER: 'a'..'z';
fragment UPPER: 'A'..'Z';
fragment DIGIT: '0'..'9';
fragment SYMBOL: '_' | '.' | ',';
fragment FLOAT: INTEGER '.' '0'..'9'*;
fragment INTEGER: '0' | SIGN? '1'..'9' '0'..'9'*;

WS  :   ( ' '
    | '\t'
    | '\r'
    | '\n'
    ) {skip();}
; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T20:04:55.540

这类似于根本没有运算符优先级。

```
expr
  : funcExpr
    ( ('+' funcExpr)*
    | ('-' funcExpr)*
    | ('*' funcExpr)*
    | ('/' funcExpr)*
    )
  ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:47:00.207

我认为以下应该有效。我假设一些具有明显名称的词法分析器标记。

```
expr: sumExpr;

sumExpr: onlySum | subExpr;

onlySum: atom ( PLUS onlySum )?;

subExpr: onlySub | multExpr;

onlySub: atom ( MINUS onlySub )? ;

multExpr: atom ( STAR atomic )? ;

parenExpr: OPEN_PAREN expr CLOSE_PAREN;

atom: FIELD | VARIABLE | parenExpr 
```

only* 规则匹配一个表达式，如果它在括号外只有一种类型的运算符。*Expr 规则匹配具有适当类型运算符的行或转到下一个运算符。

如果您有多种类型的运算符，那么它们将被强制放在括号内，因为匹配将通过 atom。

# jenkins - 使用 XStream 解析 Jenkins xml 结果

> ID：15114282
> 
> 赞同：0
> 
> 时间：2013-02-27T14:14:47.193
> 
> 标签：jenkins, xstream, jenkins-plugins

我正在尝试解析 Jenkins 生成的 lint-result.xml。我创建了一个独立的项目，该项目采用 lint 结果文件并使用 XStream 1.4.1（我在文档中看到的 Jenkins 当前使用的版本）解析它，这绝对没问题。但是，当我将代码移动到 Jenkins 插件（它是构建后插件）时，出现以下错误

```
com.thoughtworks.xstream.mapper.CannotResolveClassException: com.peter.android_lint.parser.LintIssues : com.peter.android_lint.parser.LintIssues
    at com.thoughtworks.xstream.mapper.DefaultMapper.realClass(DefaultMapper.java:68)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.DynamicProxyMapper.realClass(DynamicProxyMapper.java:71)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.PackageAliasingMapper.realClass(PackageAliasingMapper.java:88)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.ClassAliasingMapper.realClass(ClassAliasingMapper.java:86)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.ArrayMapper.realClass(ArrayMapper.java:96)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:38)
    at com.thoughtworks.xstream.mapper.CachingMapper.realClass(CachingMapper.java:56)
    at com.thoughtworks.xstream.core.util.HierarchicalStreams.readClassType(HierarchicalStreams.java:29)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.start(TreeUnmarshaller.java:136)
    at com.thoughtworks.xstream.core.AbstractTreeMarshallingStrategy.unmarshal(AbstractTreeMarshallingStrategy.java:33)
    at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:926)
    at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:912)
    at com.thoughtworks.xstream.XStream.fromXML(XStream.java:864)
    at com.peter.android_lint.parser.LintParser.parse(LintParser.java:25)
    at com.peter.ReportPublisher.findFiles(ReportPublisher.java:61)
    at com.peter.ReportPublisher.perform(ReportPublisher.java:48)
    at hudson.tasks.BuildStepMonitor$3.perform(BuildStepMonitor.java:36)
    at hudson.model.AbstractBuild$AbstractBuildExecution.perform(AbstractBuild.java:814)
    at hudson.model.AbstractBuild$AbstractBuildExecution.performAllBuildSteps(AbstractBuild.java:786)
    at hudson.model.Build$BuildExecution.post2(Build.java:183)
    at hudson.model.AbstractBuild$AbstractBuildExecution.post(AbstractBuild.java:733)
    at hudson.model.Run.execute(Run.java:1592)
    at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:237) 
```

解析器类

```
public class LintParser {

private File lintResult;

public void parse(String fileName) {
    lintResult = new File(fileName);
    XStream xstream = new XStream();
    xstream.alias("issues", LintIssues.class);
    xstream.alias("issue", LintIssue.class);
    xstream.alias("location", Location.class);
    //xstream.processAnnotations(new Class[]{LintIssues.class, LintIssue.class, Location.class});
    LintIssues lintIssues = null;
    FileInputStream fis = null;
    BufferedInputStream bis = null;
    try {
        fis = new FileInputStream(lintResult);
        bis = new BufferedInputStream(fis);
        lintIssues = (LintIssues) xstream.fromXML(bis);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }
    List<LintIssue> issueList = lintIssues.getIssueList();
    for (LintIssue issue : issueList) {
        printIssue(issue);
    }
    if(bis != null){
        try{
            bis.close();
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

private void printIssue(LintIssue issue) {
    System.out.println("ID= " + issue.getId() + " , severity= " + issue.getSeverity() + " , priority= " + issue.getPriority());
    for (Location location : issue.getLocations()) {
        printLocation(location);
    }
}

private void printLocation(Location location) {
    System.out.println("\t Location file=" + location.getFilename());
}
} 
```

Lint 问题类

```
//@XStreamAlias("issues")
public class LintIssues {
  @XStreamImplicit(itemFieldName = "issue")
  private List<LintIssue> issueList = new ArrayList<LintIssue>();

  public LintIssues(List<LintIssue> issueList) {
    this.issueList = issueList;
  }

  public List<LintIssue> getIssueList() {
    return issueList;
  }
} 
```

Lint 问题类

```
//@XStreamAlias("issue")
public class LintIssue {

@XStreamAlias("id")
@XStreamAsAttribute
private String id;
@XStreamAlias("severity")
@XStreamAsAttribute
private String severity;
@XStreamAlias("category")
@XStreamAsAttribute
private String category;
@XStreamAlias("priority")
@XStreamAsAttribute
private int priority;
@XStreamAlias("summary")
@XStreamAsAttribute
private String summary;
@XStreamAlias("explanation")
@XStreamAsAttribute
private String explanation;
@XStreamAlias("message")
@XStreamAsAttribute
private String message;
@XStreamAlias("errorLine1")
@XStreamAsAttribute
private String errorLine1;
@XStreamAlias("errorLine2")
@XStreamAsAttribute
private String errorLine2;
@XStreamImplicit(itemFieldName = "location")
private List<Location> locations = new ArrayList<Location>();

public String getId() {
    return id;
}

public void setId(String id) {
    this.id = id;
}

public String getSeverity() {
    return severity;
}

public void setSeverity(String severity) {
    this.severity = severity;
}

public String getCategory() {
    return category;
}

public void setCategory(String category) {
    this.category = category;
}

public int getPriority() {
    return priority;
}

public void setPriority(int priority) {
    this.priority = priority;
}

public String getSummary() {
    return summary;
}

public void setSummary(String summary) {
    this.summary = summary;
}

public String getExplanation() {
    return explanation;
}

public void setExplanation(String explanation) {
    this.explanation = explanation;
}

public String getMessage() {
    return message;
}

public void setMessage(String message) {
    this.message = message;
}

public String getErrorLine1() {
    return errorLine1;
}

public void setErrorLine1(String errorLine1) {
    this.errorLine1 = errorLine1;
}

public String getErrorLine2() {
    return errorLine2;
}

public void setErrorLine2(String errorLine2) {
    this.errorLine2 = errorLine2;
}

public List<Location> getLocations() {
    return locations == null ? new ArrayList<Location>() : locations;
}

public void setLocations(List<Location> locations) {
    this.locations = locations;
}
} 
```

位置类

```
//@XStreamAlias("location")
public class Location implements Serializable {

private static final long serialVersionUID = 1128640353127613495L;

@XStreamAlias("file")
@XStreamAsAttribute
private String filename;
@XStreamAlias("line")
@XStreamAsAttribute
private int lineNumber;
@XStreamAlias("column")
@XStreamAsAttribute
private int column;

public String getFilename() {
    return filename;
}

public void setFilename(String filename) {
    this.filename = filename;
}

public int getLineNumber() {
    return lineNumber;
}

public void setLineNumber(int lineNumber) {
    this.lineNumber = lineNumber;
}

public int getColumn() {
    return column;
}

public void setColumn(int column) {
    this.column = column;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:33:20.213

通过参与[jenkinsci-dev](https://groups.google.com/forum/#!forum/jenkinsci-dev)邮件列表，您可能会更幸运地得到这个问题的好答案。

# llvm - llvm 获取注释

> ID：15114284
> 
> 赞同：2
> 
> 时间：2013-02-27T14:14:52.797
> 
> 标签：llvm

我在新表格下更新了我之前的问题。大家好，

我有以下 LLVM IR：

```
@.str = private unnamed_addr constant [3 x i8] c"DS\00", section "llvm.metadata"

@llvm.global.annotations = appending global [1 x { i8*, i8*, i8*, i32 }] [{ i8*, i8*, i8*, i32 } { i8* bitcast (i32* @f to i8*), i8* getelementptr inbounds ([3 x i8]* @.str, i32 0, i32 0), i8* getelementptr inbounds ([9 x i8]* @.str1, i32 0, i32 0), i32 18 }], section "llvm.metadata" 
```

我需要得到`@f`（或者也许我能以某种方式得到 的定义`@f = global i32 0, align 4`），而且我需要从`@.str`. 在我的目标代码中，我有：

```
__attribute__((annotate("DS"))) int f=0; 
```

我在解析@llvm.global.annotations 时遇到问题，我假设我会遇到@.str。我尝试了什么：

1.

```
for (Module::global_iterator I = F.global_begin(), E = F.global_end(); I != E; ++I) {
    if (I->getName() == "llvm.global.annotations") {
       Value *V = cast<Value>(I->getOperand(0));
        errs()<<"\n "<<*(V)<<"\n";
        errs()<<"\n "<<*(V->getType())<<"\n"; 
```

结果 ：

```
 [1 x { i8*, i8*, i8*, i32 }] [{ i8*, i8*, i8*, i32 } { i8* bitcast (i32* @f to i8*), i8* getelementptr inbounds ([3 x i8]* @.str, i32 0, i32 0), i8* getelementptr inbounds ([9 x i8]* @.str1, i32 0, i32 0), i32 18 }]

 [1 x { i8*, i8*, i8*, i32 }] 
```

2.

```
errs()<<"\n "<<(V->getValueID())<<"\n";
if(V->getValueID() == Value::ConstantArrayVal) {
            ConstantArray *ca = (ConstantArray *)V;
            errs()<<"\n "<<(ca[0])<<"\n";  } 
```

结果 ：

```
[1 x { i8*, i8*, i8*, i32 }] [{ i8*, i8*, i8*, i32 } { i8* bitcast (i32* @f to i8*), i8* getelementptr inbounds ([3 x i8]* @.str, i32 0, i32 0), i8* getelementptr inbounds ([9 x i8]* @.str1, i32 0, i32 0), i32 18 }] 
```

欢迎任何帮助！谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:41:55.487

如果您这样做，请使用 runOnModule() 而不是 runOnFunction()。或者，您可以参加该模块。llvm.global.annotations 在函数外部定义。在里面做类似的事情：

```
for (Module::global_iterator I = F.global_begin(), E = F.global_end(); I != E; ++I) {

if (I->getName() == "llvm.global.annotations")
{
    errs()<<"\nllvm.global.annotations\n";
    //1\. find out what global variable is by "parsing" the IR
    //2\. get through the module till you find a load @f 
    //3\. you can add metadata to the load function and you can easily get the metadata from the normal pass
}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-19T06:30:07.797

一个很晚的答案，但谷歌把我带到了这里，我认为提供一个完整的 LLVM 通行证来发现自由文本注释会很有帮助。此 LLVM 通道将仅检测标有 __attribute((annotate("someFreeTextAnnotation"))) 的函数。代码如下：

```
#include "llvm/Pass.h"
#include "llvm/IR/Function.h"
#include "llvm/Support/raw_ostream.h"
#include "llvm/IR/Module.h"
#include "llvm/IR/Constants.h"
#include <set>

using namespace llvm;
const char *AnnotationString = "someFreeTextAnnotation";

namespace {
struct Hello : public FunctionPass {
    static char ID;
    Hello() : FunctionPass(ID) {}
    std::set<Function*> annotFuncs;

    virtual bool doInitialization(Module &M)override{
        getAnnotatedFunctions(&M);
        return false;
    }
    bool shouldInstrumentFunc(Function &F){
        return annotFuncs.find(&F)!=annotFuncs.end();
    }
    void getAnnotatedFunctions(Module *M){
        for (Module::global_iterator I = M->global_begin(),
                E = M->global_end();
                I != E;
                ++I) {

            if (I->getName() == "llvm.global.annotations") {
                ConstantArray *CA = dyn_cast<ConstantArray>(I->getOperand(0));
                for(auto OI = CA->op_begin(); OI != CA->op_end(); ++OI){
                    ConstantStruct *CS = dyn_cast<ConstantStruct>(OI->get());
                    Function *FUNC = dyn_cast<Function>(CS->getOperand(0)->getOperand(0));
                    GlobalVariable *AnnotationGL = dyn_cast<GlobalVariable>(CS->getOperand(1)->getOperand(0));
                    StringRef annotation = dyn_cast<ConstantDataArray>(AnnotationGL->getInitializer())->getAsCString();
                    if(annotation.compare(AnnotationString)==0){
                        annotFuncs.insert(FUNC);
                        //errs() << "Found annotated function " << FUNC->getName()<<"\n";
                    }
                }
            }
        }
    }

    bool runOnFunction(Function &F) override {
        if(shouldInstrumentFunc(F)==false)
            return false;
        errs() << "Instrumenting " << F.getName() << "\n";

        return false;
    }
}; // end of struct Hello
}  // end of anonymous namespace

char Hello::ID = 0;
static RegisterPass<Hello> X("hello", "Discover annotation attribute",
        false /* Only looks at CFG */,
        false /* Analysis Pass */); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T12:34:17.070

我解决了。我将整个带注释的表达式转换为 Value*。然后，为了避免像 getAsString() 这样丑陋的事情，我检查是否`V->getValueID() == Value::ConstantArrayVal`将其转换为`ConstantArray`. 因为它只包含 array[0]，所以我将 array0>getOperand(0) 转换为`ConstantStruct`. 因此，从中`ConstantStruct`可以得到所有四个操作数。现在要做的只是从每个字段中获取@f、@str 的名称。这是由`ConstantStruct->getOperand(0)->getOperand(0)`.

# c++ - 确定 unicode 字符在 C++ 中是全角还是半角

> ID：15114303
> 
> 赞同：7
> 
> 时间：2013-02-27T14:15:46.977
> 
> 标签：c++, unicode

我正在编写一个应该包装任意 unicode 文本的终端（控制台）应用程序。

终端通常使用等宽（固定宽度）字体，因此要换行文本，只需计算字符数并观察单词是否适合一行并采取相应措施。

问题是 Unicode 表中有全角字符占用了终端中 2 个字符的宽度。

计算这些会看到 1 个 unicode 字符，但打印的字符是 2 个“正常”（半角）字符宽，因为它不知道占用两倍宽度的字符，所以会破坏包装例程。

例如，这是一个全角字符（U+3004，JIS 符号）

```
〄
12

```

尽管它是预先格式化的，但它在这里并不占用 2 个字符的全部宽度，但它确实使用了终端中西方字符宽度的两倍。

为了解决这个问题，我必须区分全角或半角字符，但我在 C++ 中找不到这样做的方法。真的有必要知道 unicode 表中的所有全角字符来解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T14:24:48.443

您应该将 ICU[`u_getIntPropertyValue`](http://www.icu-project.org/apiref/icu4c/uchar_8h.html#a3376f0d34bb23c54671859f1978b4226)与该`UCHAR_EAST_ASIAN_WIDTH`物业一起使用。

例如：

```
bool is_fullwidth(UChar32 c) {
    int width = u_getIntPropertyValue(c, UCHAR_EAST_ASIAN_WIDTH);
    return width == U_EA_FULLWIDTH || width == U_EA_WIDE;
} 
```

请注意，如果您的图形库支持组合字符，那么您在确定序列使用多少个单元格时也必须考虑这些；例如，`e`后跟`U+0301`COMBINING ACUTE ACCENT 只会占用 1 个单元格。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-09T06:00:08.117

没有必要建立表格，来自 Unicode 的人已经这样做了：

[http://www.cl.cam.ac.uk/~mgk25/ucs/wcwidth.c](http://www.cl.cam.ac.uk/~mgk25/ucs/wcwidth.c)

相同的代码用于终端仿真软件，例如`xterm`[[1]](http://invisible-island.net/xterm/)、`konsole`[[2]](https://projects.kde.org/projects/kde/applications/konsole/repository/revisions/master/entry/src/konsole_wcwidth.cpp)以及很可能的其他软件......

# sql - 基于子字符串的 SQL Server 2008 审计触发器

> ID：15114305
> 
> 赞同：0
> 
> 时间：2013-02-27T14:15:55.930
> 
> 标签：sql, sql-server-2008, triggers, audit

我想基于列创建触发器，但仅适用于以`_ess`. 如何设置审核触发器来执行此操作？

这是当前触发器，但它只检查用户名的所有更改，而我只希望它检查用户名何时更新为或从以 _ess 结尾的用户名。

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TRIGGER [dbo].[AUDIT_UPD_HRPERSONS_USERNAME] ON [dbo].[HRPersons] FOR UPDATE NOT FOR REPLICATION As
BEGIN
DECLARE
@OperationNum   int,
@DBMSTransaction VARCHAR(255),
@OSUSER VARCHAR(50), 
@DBMSUSER VARCHAR(50), 
@HostPhysicalAddress VARCHAR(17), 
@contexto varchar(128),
@ApplicationModifierUser varchar(50),
@SessionInfo_OSUser varchar(50),
@HostLogicalAddress varchar(30)

Set NOCOUNT On

IF @@trancount>0
BEGIN
EXECUTE sp_getbindtoken @DBMSTransaction OUTPUT
END
ELSE BEGIN
SET @DBMSTransaction = NULL
END

IF PatIndex( '%\%',SUSER_SNAME()) > 0
BEGIN
set @OSUSER = SUSER_SNAME()
set @DBMSUSER = NULL
END
ELSE BEGIN
SET @OSUSER = NULL
SET @DBMSUSER = SUSER_SNAME()
END

set @HostPhysicalAddress = (SELECT net_address FROM master..sysprocesses where spid=@@spid )
set @HostPhysicalAddress = substring (@HostPhysicalAddress,1,2) + '-' + substring (@HostPhysicalAddress,3,2) + '-' + substring (@HostPhysicalAddress,5,2) + '-' + substring (@HostPhysicalAddress,7,2) + '-' + substring (@HostPhysicalAddress,9,2) + '-' + substring (@HostPhysicalAddress,11,2)

SELECT @contexto=CAST(context_info AS varchar(128)) FROM master..sysprocesses WHERE spid=@@SPID
IF (PatIndex( '%APPLICATION_USER=%',@contexto) is not null) and (PatIndex( '%APPLICATION_USER=%',@contexto) > 0)
set @ApplicationModifierUser=substring(ltrim(substring(@contexto,PatIndex( '%APPLICATION_USER=%',@contexto)+17,128)),1, charIndex( '///',ltrim(substring(@contexto,PatIndex( '%APPLICATION_USER=%',@contexto)+17,128) ) ) - 1 )
ELSE
set @ApplicationModifierUser=NULL
IF (PatIndex( '%OS_USER=%',@contexto) is not null)  and ( PatIndex( '%OS_USER=%',@contexto)>0 )
set @SessionInfo_OSUser=substring(ltrim(substring(@contexto,PatIndex( '%OS_USER=%',@contexto)+8,128)),1, charIndex( '///',ltrim(substring(@contexto,PatIndex( '%OS_USER=%',@contexto)+8,128) ) ) - 1 )
ELSE
set @SessionInfo_OSUser=NULL
IF (PatIndex( '%LOGICAL_ADDRESS=%',@contexto) is not null) and (PatIndex( '%LOGICAL_ADDRESS=%',@contexto)>0)
set @HostLogicalAddress=substring(ltrim(substring(@contexto,PatIndex( '%LOGICAL_ADDRESS=%',@contexto)+16,128)),1, charIndex( '///',ltrim(substring(@contexto,PatIndex( '%LOGICAL_ADDRESS=%',@contexto)+16,128) ) ) - 1 )
ELSE
set @HostLogicalAddress=NULL

INSERT INTO AuditedOperations ( Application, Object, OperationType, ModifiedDate, ApplicationModifierUser, OSModifierUser, DBMSModifierUser, Host, HostLogicalAddress, HostPhysicalAddress, DBMSTransaction)
VALUES (APP_NAME(), 'HRPERSONS', 'U', GETDATE(), @ApplicationModifierUser, @OSUSER, @DBMSUSER, HOST_NAME(), @HostLogicalAddress, @HostPhysicalAddress, @DBMSTransaction)

Set @OperationNum = @@IDENTITY

INSERT INTO AuditedRows (OperationNum, RowPK)
SELECT @OperationNum, ISNULL(CAST(INSERTED.ID as nvarchar),CAST(DELETED.ID as nvarchar))
FROM INSERTED FULL OUTER JOIN DELETED ON INSERTED.ID=DELETED.ID

INSERT INTO AuditedRowsColumns (OperationNum, RowPK, ColumnName, ColumnAudReg, OldValue, NewValue)
SELECT @OperationNum, ISNULL(CAST(INSERTED.ID as nvarchar),CAST(DELETED.ID as nvarchar)), 'USERNAME','A', CONVERT( VARCHAR(3500),DELETED.USERNAME), CONVERT( VARCHAR(3500),INSERTED.USERNAME)
FROM INSERTED FULL OUTER JOIN DELETED ON INSERTED.ID=DELETED.ID

END

GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:47:45.400

只需添加以下内容：

```
INSERT INTO AuditedRows (OperationNum, RowPK)
SELECT @OperationNum, ISNULL(CAST(INSERTED.ID as nvarchar),CAST(DELETED.ID as nvarchar))
FROM INSERTED FULL OUTER JOIN DELETED ON INSERTED.ID=DELETED.ID
-- Restrict it to only those where the username is changing from or to %_ess
WHERE (deleted.username like '%_ess' or inserted.username like '%_ess')

INSERT INTO AuditedRowsColumns (OperationNum, RowPK, ColumnName, ColumnAudReg, OldValue, NewValue)
SELECT @OperationNum, ISNULL(CAST(INSERTED.ID as nvarchar),CAST(DELETED.ID as nvarchar)), 'USERNAME','A', CONVERT( VARCHAR(3500),DELETED.USERNAME), CONVERT( VARCHAR(3500),INSERTED.USERNAME)
FROM INSERTED FULL OUTER JOIN DELETED ON INSERTED.ID=DELETED.ID
-- Restrict it to only those where the username is changing from or to %_ess
WHERE (deleted.username like '%_ess' or inserted.username like '%_ess') 
```

# javascript - 我可以阻止 Chrome 吃掉我的全局财产吗？

> ID：15114308
> 
> 赞同：7
> 
> 时间：2013-02-27T14:16:00.940
> 
> 标签：javascript, google-chrome, chrome-ios

`XMLHttpRequest`当您包含外部 JavaScript 文件时，iOS 上的 Chrome 似乎会创建一个对象。似乎将此对象分配给具有标识符的全局变量，从而`a`覆盖您可能已经拥有的任何内容。

**测试用例：**

*   HTML 文件 ( *test.html* ):

    ```
    <!-- ... -->
    <script>
        var a = 1; // Value is not important for this demonstration
    </script>
    <script src="test.js"></script>
    <!-- ... --> 
    ```

*   外部 JavaScript 文件 ( *test.js* )：

    ```
    setTimeout(function () {
        document.write(a); // [object XMLHttpRequest]
        a.onreadystatechange = function () {
            document.write(a.readyState); // Alternates between "1" and "4"
        };
    }, 100); 
    ```

似乎重复发出请求（到某个地方......通过`XMLHttpRequest`代理路由设备连接并且监视请求没有显示任何内容）并且`onreadystatechange`事件处理程序被重复执行。

**更多观察：**

*   这似乎只发生在页面加载后的某个时间（因此`setTimeout`）
*   当它发生时，还有一个`window.__gchrome_CachedRequest`属性
*   `__gchrome_CachedRequest === a`
*   它似乎不会发生在旧版本的 iOS Chrome 中（虽然不确定它首先出现在哪个版本中）

有没有人遇到过这个？有没有办法阻止它发生（注意......我不能重命名`a`）？如果有人知道*为什么*会这样，我很想知道。

* * *

**更新**

我刚刚注意到内联脚本实际上也会发生这种情况，而不仅仅是在包含外部脚本时。我最初没有注意到这一点，因为我没有`setTimeout`在那里打电话。所以看起来它实际上*总是*在页面加载后的某个时间发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:04:58.780

从我们在评论中的讨论来看，Chrome 似乎正在使用一个`with`声明来将它自己的一些东西放在`window`属性的顶部。它可能会这样做，因为这些属性通常不会被覆盖。延迟很可能归结为在页面开始加载后 Chrome 可以多快将自己的脚本注入 UIWebView（iOS 上的浏览​​器被迫使用底层 UIWebView 对象而不是它们自己的引擎）。

如果所有这些猜测都是真的，那么有一个简单的解决方案，除了访问`window.a`而不是`a`或收回权力并使用你自己的`with`声明：

```
with (window)
    eval(myScript); 
```

几乎没有任何人会喜欢实施的解决方案，但可能是您唯一的选择。

# java - JBoss 上的应用程序部署文件夹

> ID：15114309
> 
> 赞同：1
> 
> 时间：2013-02-27T14:16:03.740
> 
> 标签：java, jakarta-ee, jboss, ejb, jboss7.x

是否有任何配置可以热部署war文件并将其解压缩到.deployed文件之外的项目文件夹中，以便我们可以修改web.xml，persistence.xml，就像Tomcat和websphere一样？

谢谢

# javascript - Azure 中的分区键

> ID：15114313
> 
> 赞同：0
> 
> 时间：2013-02-27T14:16:19.753
> 
> 标签：javascript, azure, windows-8

有没有办法在使用 Javascript 插入项目之前设置项目的分区键？

我有一个 Win8 JS 应用程序，我想设置 PK，以便我可以将几辆汽车（例如）链接到一个用户，以便能够给出用户名，我可以查询属于它的每辆汽车。另外，对于性能方面的东西，这些汽车应该在同一个分区中，所以，有什么办法吗？

例如，假设我有一个用户。一个用户可以有几个属性，其中包括汽车列表。我在 Azure 表存储中有两个表，一个用于用户，另一个用于汽车，我想通过用户属性“用户名”（一个字符串）将汽车链接到用户，这样我就可以创建一个查询来选择汽车其 id 是“用户名”。我还想考虑性能问题，因此我发现希望将每组汽车放在自己的分区中，将它们指定为 PK 用户的用户名。问题是我如何在 W8JS 应用程序中做到这一点。

# actionscript-3 - StageWebView 和 Android 的缩放/缩放问题

> ID：15114315
> 
> 赞同：2
> 
> 时间：2013-02-27T14:16:30.957
> 
> 标签：actionscript-3, apache-flex, air, loader, flex-mobile

我有一个使用 StageWebView 加载本地 HTML 文件的 Flex Mobile 应用程序。

我一直在使用内置模拟器（模拟 Galaxy S3 屏幕，1280x720，320dpi）和我实际的 S3 在我的 PC 上调试它。

该应用程序将 StageWebView 视口设置为使用 stageHeight 和 stageWidth 的矩形。(1280x720)

在 PC 上，它完全显示 HTML 文件（HTML 文件有一个 1280x720 的背景图像）并且没有滚动。

然而，在我的手机上，webview 显示 HTML 文件“放大”（我说放大，但实际上你不能缩小！），我必须滚动才能查看所有内容。内容以两倍大小显示（如果我将背景图像设置为 360x640，则它适合手机屏幕而无需滚动）

为什么模拟器设置为相同的分辨率和 DPI，会以不同的方式显示内容？

更重要的是，为什么我的手机似乎“放大”了 HTML 文件并让我滚动？内容和手机分辨率匹配，但 StageWebView 似乎无法理解。

我找到了这篇文章，[点击我](http://forums.adobe.com/message/4820808)，这似乎表明有一个错误，但是那个人提到他的问题是当他不使用我正在使用的视口元标记时！

有谁知道我可以如何解决我的缩放问题，并希望我的 Flex 应用程序可以在各种设备上很好地缩放，并让 StageWebView 正确显示我的 HTML 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-26T20:34:38.057

如果您在 android 上使用元视口，请确保设置 target-densitydpi 值

```
<meta name="viewport" content="width=device-width, user-scalable=no, target-densitydpi=device-dpi"> 
```

或者如果可以使用 css 缩放，其中缩放值与与 html 页面大小相比与密度无关像素 (DP) 值相关

[在 Adob​​e 上查看这篇文章](http://www.adobe.com/devnet/air/articles/multiple-screen-sizes.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T07:06:25.537

我用同样的问题把头撞在墙上。在 Xoom (Android 3) 上，本地文件完美显示，但在 Nexus (Android 4.2.2) 上，内容无法通过 stagewebview 正确显示。

我的解决方案是更改 css 标记的 href。看这里：

[如何在android dev的静态webview窗口中引用本地css文件？](https://stackoverflow.com/questions/5813188/how-to-reference-local-css-files-in-a-static-webview-window-in-android-dev).

所以在我的本地 HTML 文件中，它改为：

```
<link rel="stylesheet" href="file:///styles/style.css" type="text/css" /> 
```

# java - REST 服务返回 HTTP 204 (Tomcat/Linux)

> ID：15114316
> 
> 赞同：4
> 
> 时间：2013-02-27T14:16:42.513
> 
> 标签：java, web-services, rest, tomcat, jersey

我在 Linux 发行版（Raspbian、Tomcat 7）上运行我的代码时遇到问题。在Windows/Tomcat 7/Eclipse下的测试环境中没有出现问题：

我的网络服务只返回 HTTP 204 而没有别的。该日志不包含任何指示请求期间出现错误的指示。就像在测试环境中所做的那样，它应该以 json 响应。

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
version="3.0">
<display-name>***</display-name>
<welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
</welcome-file-list>
<listener>
    <listener-class>**.useravailability.UserAvailabilityServletContextListener</listener-class>
</listener>
<servlet-mapping>
    <servlet-name>REST Service</servlet-name>
    <url-pattern>/REST/*</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>REST Service</servlet-name>
    <servlet-class>com.sun.jersey.server.impl.container.servlet.ServletAdaptor</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
        <param-value>true</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

</web-app> 
```

用户服务.xml

```
package **.webservice;

import java.util.ArrayList;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import com.google.gson.Gson;

import **.model.AccessManager;

@Path("/usersService")
public class UsersService {
@GET
@Produces("application/json")
public String getUser() {       
    String user = null;
    ArrayList<String> userList = new ArrayList<String>();
    try {       
        userList = new AccessManager().getUser();
        Gson gson = new Gson();
        user = gson.toJson(userList);           
    } catch (Exception e) {
        e.printStackTrace();
    }
    return user;
}

} 
```

我错过了什么？为什么它可以在测试环境中工作？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T15:03:33.273

如果您返回 null，Jersey 将返回 HTTP 204。

我认为这是最好的行为。

在您的情况下，您可能会引发异常，因此 user 为空。

如果你想返回一个错误代码（这可能更合乎逻辑）你可以替换

```
catch (Exception e) {
        e.printStackTrace();
    } 
```

经过

```
catch (Exception e) {
        throw new WebApplicationException(404);
    } 
```

如果您想声明找不到用户，或者如果您想返回服务器端错误代码，则返回 5XX HTTp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:49:22.660

谢谢你们！我错过了一条错误消息，即缺少 jdbc 驱动程序。我忘记在上传之前将其添加到构建路径中。

# c# - 将 Visual C# 2008 连接到 MS Access 2010 x64

> ID：15114317
> 
> 赞同：0
> 
> 时间：2013-02-27T14:16:41.910
> 
> 标签：c#, ms-access

我正在尝试在 Visual C# 2008 中连接到我的一个 MS Access 数据库，问题是 MS Access 2010 是 x64，我使用的是 Windows 7 x64，它在 ODBC 中看不到任何 64 位架构的 Access 驱动程序，所以我的问题是，是否有可用的驱动程序或对其进行修复，或者我是否必须在 x86 中重新安装 MS Access？

我知道我可以将 SQL 用于数据库，但更喜欢使用 Access，因为它对我来说更容易。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:30:10.613

“目前微软没有任何可用于 Office 产品的 64 位 ODBC 驱动程序。但是，只要您要连接的应用程序是 32 位的，您就可以使用 32 位 ODBC 驱动程序来创建 DSN。要获得32 位 ODBC 驱动程序，必须使用 32 位数据源管理器。如果您使用 64 位操作系统，必须直接启动 32 位数据源管理器。文件应位于以下路径：c:\windows\ sysWOW64\odbcad32.exe..."

从以下链接：[http ://answers.microsoft.com/en-us/office/forum/officeversion_other-access/64-bit-driver-for-dsn-for-ms-access-database/be8c0ad4-d8fd-48e0 -9026-b95d84135820](http://answers.microsoft.com/en-us/office/forum/officeversion_other-access/64-bit-driver-for-dsn-for-ms-access-database/be8c0ad4-d8fd-48e0-9026-b95d84135820)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:37:10.430

您必须强制您的 VS 项目使用 x86 处理器：

双击 ![在此处输入图像描述](../Images/80fd92fdad413a23ebaa70225bf11024.png)

然后设置平台目标

![在此处输入图像描述](../Images/792da153ef71736f9306e38cf9910685.png)

# c# - 生成的证书不起作用？

> ID：15114326
> 
> 赞同：1
> 
> 时间：2013-02-27T14:17:19.260
> 
> 标签：c#, wcf, certificate

我在 Windows 8 服务器上使用以下命令为我的 WCF TCP 解决方案生成客户端和服务证书：

```
makecert.exe -sr LocalMachine -ss My -a sha1 -n CN=MyAppServer -sky exchange -pe
makecert.exe -sr LocalMachine -ss My -a sha1 -n CN=MyAppClient -sky exchange –pe 
```

证书已安装，然后使用 MMC 移动到 TrustedPeople。然后我使用 MMC 将两个证书导出到文件，然后将它们都安装在 CurrentUser/TrustedPeople 下的客户端计算机上。

在客户端上查看 MMC 中的两个证书时，它说：

**“无法保证此证书的完整性。该证书可能已损坏或已被更改”**

我可以看到 Root Agence 和 MyAppServier 在主题上有交叉。

当我尝试连接到 WCF 服务（位于 Windows 8 服务器上）时，我将在客户端上收到以下异常：

**无法使用以下搜索条件找到 X.509 证书：StoreName 'TrustedPeople'、StoreLocation 'CurrentUser'、FindType 'FindBySubjectName'、FindValue 'MyAppClient'。**

我已经仔细检查了 CurrentUser 下的受信任的人，它们是否到位？

如果我从我的客户端计算机运行所有这些（包括生成和安装证书）一切正常吗？我怀疑这些证书有什么不对的地方？

我需要测试证书，所以我没有任何“真实”证书，但根据我的经验，它应该可以在服务上生成证书，然后在测试环境中使用它们？

那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:03:45.663

这个链接解决了我的问题并解释了很多：[http ://robbincremers.me/2011/12/29/wcf-message-security-and-client-certificate-authentication-with-self-signed-certificates/](https://web.archive.org/web/20150506062156/http://robbincremers.me/2011/12/29/wcf-message-security-and-client-certificate-authentication-with-self-signed-certificates/)

但是，这不会使用 IIS7 来生成证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:32:26.600

当我无法让证书工作时，我过去做过的一件事就是通过 IIS 7 UI 创建它们。IIS 会将它创建的证书放入您计算机上的个人证书和受信任的用户中。

[http://technet.microsoft.com/en-us/library/cc753127%28v=ws.10%29.aspx](http://technet.microsoft.com/en-us/library/cc753127%28v=ws.10%29.aspx)

祝你好运。

# android - Android：API 级别 < 14 上的 menuItem.expandActionView()

> ID：15114327
> 
> 赞同：3
> 
> 时间：2013-02-27T14:17:19.303
> 
> 标签：android, search, menuitem, backwards-compatibility

我正在使用搜索小部件在我的应用程序上实现搜索界面。我**不**打算支持任何 API 级别 < 11 (Honeycomb)。在搜索活动中，我想覆盖`onKeyDown()`以在用户按下搜索键时展开搜索小部件，并在提交查询文本时将其最小化。

这很容易通过调用来完成：

```
@Override
public boolean onSearchRequested() {
    if (mSearchMenuItem != null) {
        mSearchMenuItem.expandActionView();
    }
    return false;
} 
```

并在提交查询时：

```
searchView.setOnQueryTextListener(new OnQueryTextListener() {

        @Override
        public boolean onQueryTextSubmit(String query) {
            //Do nothing, results for the string supplied are already shown.
            //Just collapse search widget
            mSearchMenu.collapseActionView();
            return false;
        }

        @Override
        public boolean onQueryTextChange(String newText) {
            //do other stuff
             return false;
    }); 
```

问题是在 API 级别 14 中引入了折叠和展开。如前所述，我想提供早在 API 级别 11 的支持，但如果不调用新的 API 方法，我无法实现相同的功能。

我试过了：

```
@Override
public boolean onSearchRequested() {
    searchView.setIconifiedByDefault(false);
    //and also called
    searchView.requestFocusFromTouch();
} 
```

但这根本没有做任何事情（我的意思是如果搜索小部件已经折叠的话，它仍然是折叠的。

由于我保留了对 menuItem 的引用，因此我也尝试了：

```
@Override
public boolean onSearchRequested() {
    SearchActivity.this.onOptionsItemSelected(mSearchMenuItem);
} 
```

但这也没有做任何事情，我尝试的最后一件事是：

```
@Override
public boolean onSearchRequested() {
    searchMenu.getActionView().performClick();
    return false;
} 
```

但这也是不行的。

关于我可以做些什么来提供与`menuItem.collapseActionView()`并且`menuItem.expandActionView()`不必牺牲兼容性的相同功能的任何想法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-01-28T10:38:03.073

这适用于 API 级别 10，用于扩展 ActionView，例如 SearchView

```
MenuItemCompat.expandActionView(mSearchMenuItem); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-15T16:25:08.207

您可以使用 MenuItemCompat 静态方法。例子：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_search, menu);

    MenuItem menuItem = menu.findItem(R.id.action_search);
    MenuItemCompat.expandActionView(menuItem);
    SearchView searchView = (SearchView) MenuItemCompat.getActionView(menuItem);
    ...
} 
```

更多信息：http: [//developer.android.com/reference/android/support/v4/view/MenuItemCompat.html](http://developer.android.com/reference/android/support/v4/view/MenuItemCompat.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:56:43.310

您始终可以选择根据当前运行的版本来区分您的解决方案：

```
int sdk = android.os.Build.VERSION.SDK_INT;
if(sdk < android.os.Build.VERSION_CODES.HONEYCOMB) {
// pre honeycomb
} else {
// honeycomb and post
} 
```

我知道这可能不是您正在寻找的东西，但它可能会为您提供一些帮助。

# python - 使用python保存打开的excel文件

> ID：15114329
> 
> 赞同：0
> 
> 时间：2013-02-27T14:17:22.933
> 
> 标签：python, excel, xlrd

如何使用 python= 保存打开的 excel 文件我目前使用 XLRD 阅读 excel 工作簿，但我需要保存 excel 文件，以便读取用户输入的任何更改。

我已经使用 Excel 中的 VBA 脚本完成了这项工作，该脚本每 x 秒保存一次工作簿，但这并不理想。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:29:04.340

看起来 XLRD 用于读取数据，而不是与 excel 接口。所以不，除非您使用 python 使用不同的库不是最好的方法，否则 VBA 脚本有什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T08:56:52.577

使用 xlwt 怎么样？

*   对于 Python 2—— [https://pypi.python.org/pypi/xlwt/0.7.4](https://pypi.python.org/pypi/xlwt/0.7.4)
*   对于 Python 3—— [https://pypi.python.org/pypi/xlwt3/0.1.2](https://pypi.python.org/pypi/xlwt3/0.1.2)

# c# - WPF TreeView 带有两个单独的 ItemsPanel 用于分支和叶子

> ID：15114331
> 
> 赞同：1
> 
> 时间：2013-02-27T14:17:37.130
> 
> 标签：c#, wpf, xaml, wpf-controls

我正在用 TreeView 创建一个图表。下面是一个屏幕截图。到目前为止，一切都通过造型完成。我将 TreeView 的 ItemsPanel 设置为水平 StackPanel。 *（回形针只是没有图像的物品的占位符。）*

![树视图图的屏幕截图](../Images/af7e96d59bd62a778d6f8eca2858fc51.png)

注意底层的孩子是叶子。他们自己没有孩子。

**这是问题**：我希望这些项目进入单独的 WrapPanel。问题是一个项目显然可以有孩子有孩子和没有孩子的孩子*（分支和树叶）*。ItemsPanel 仍然需要是 StackPanel，以便您获得一个不错的水平布局。但是 StackPanel 中的最后一个控件需要是带有所有无子子级的 WrapPanel。

这是我拼凑在一起的屏幕截图，以显示 WrapPanel 中的叶子。

![带有环绕面板的树视图的屏幕截图](../Images/593b29e73e3f32b210fbc4369966c7e1.png)

**我尝试过的事情**

我尝试创建自己的项目面板转换器，但这会将整个项目面板转换为包装面板。

我尝试将单独的树视图添加到 ItemTemplate 并将其绑定到单独的集合，但这不是正确的外观。

**我没试过的东西**

我所说的 WrapPanel 几乎就像一个分支。但是分支本身是空的，但包含子项。也许我可以根据属性更改节点的样式。然后，它的数据模板将是 WrapPanel，而不是显示图片或其他内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:25:00.993

我想到了。

1.  我遍历了我的分层数据集并进行了一些更改。对于每个分支，我删除了它的叶子并将它们添加到一个新节点。然后我将节点添加回分支。它有点创建一个占位符。

2.  该节点包含一个名为“IsLeafCollection”的属性。它只是验证它的每个孩子都没有任何孩子。

3.  我有一个绑定到 IsLeafCollection 的数据触发器。如果为真，那么它将项目面板更改为换行面板。

下面是最终结果的屏幕截图。

![树视图的屏幕截图](../Images/b133ec57820202e561a7f8104cba9074.png)

# scala - 播放错误：值并且不是 play.api.libs.json 的成员

> ID：15114332
> 
> 赞同：26
> 
> 时间：2013-02-27T14:17:41.757
> 
> 标签：scala, playframework-2.1

这是我正在使用的代码：

```
(__ \ "fields").read(
  (__ \ "key").readNullable[String] and
  (__ \ "summary").readNullable[String] and
  (__ \ "description").readNullable[String]
  tupled
) 
```

在这种情况下，完整的错误是：

```
value and is not a member of play.api.libs.json.Reads[Option[String]] 
```

它也可能是错误中的其中之一

```
play.api.libs.json.OFormat
play.api.libs.json.OWrites 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-27T14:17:41.757

解决方案是导入功能语法

```
import play.api.libs.functional.syntax._ 
```

# java - Java中的查找表？

> ID：15114335
> 
> 赞同：5
> 
> 时间：2013-02-27T14:17:49.690
> 
> 标签：java, arrays, lookup-tables

在我的计算机科学课程中，我们正在学习查找表。但是我们的老师没有在他发布的课程页面中提供任何示例，也没有在他提供的视频中提供任何示例。他所做的只是告诉我们它是什么，但他希望我们在下一个任务中使用它们。但他没有给我们举例说明如何做到这一点。在进入查找表之前，我们正在学习数组。有人可以

1.  告诉我什么是查找表？（请详细说明？）
2.  提供一些查找表的示例？我们应该使用数组吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T14:19:49.623

您可以使用映射来存储键/值对并通过其键查找值：

```
Map<Integer, String> map = new HashMap<>();
map.put(1, "Foo");
map.put(2, "Bar");
System.out.println(map.get(1)); // prints Foo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T14:22:21.577

如果您应该使用数组，那很好而且简单。

```
int[] numbers = new int[5] // Initialise a new array with 5 "spaces".
for(int x = 0; x < 5; x++)
{
    numbers[x] = x;
    // This will populate the array with 0,1,2,3 and 4.
} 
```

现在要访问这些数字之一，您可以使用它的索引。IE

```
int value = numbers[3]; // Will return 3. 
```

所以你已经通过使用它的索引作为“键”来访问数组中的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-25T11:58:17.437

在我的理解中，查找表是一种使用给定“键”获取“值”的方法，它比迭代搜索快得多：即：

```
for(int x=0; x < 10; x++){
    if( x == n ) {
        return x;
    }
} 
```

这将不得不搜索（最多）10 的 1/2 以找到“n”的匹配值。使用“lookupTable”，您可以直接访问所需的值，而无需使用它的“键”进行迭代。

假设您正在寻找给定 mySql 数据类型的 Java 变量类型。你可以使用地图。

```
Map<String, String> lookUpTable = new Map<>();
lookUpTable.put( "VARCHAR", "String" ); 
```

然后您可以在 Java 中找到“VARCHAR”数据类型的转换值，它将是

```
lookUpTable.get("VARCHAR"); // This would give you "String". 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-03T12:03:39.360

我知道你问这个问题已经很长时间了，我相信你成功地完成了你的任务。但是，我将与像我一样想知道 a`lookup table`是什么的每个人分享我的答案。

### `Lookup table`它只是一个数组。

查找表（数组）它在提供我们需要的数据方面非常快[O(1)](https://en.wikipedia.org/wiki/Big_O_notation#Orders_of_common_functions)。想象一下它就像一个包含两列的表格。第一列是键/索引，第二列是值/数据。*我们可以通过index*直接访问我们需要的数据。

# ruby-on-rails - 带有 BRCOBRANCA 的 ActionController::Base:Class 的未定义方法“page_cache_extension”

> ID：15114336
> 
> 赞同：1
> 
> 时间：2013-02-27T14:17:51.017
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, page-caching

我在 Ubuntu 上使用 Ruby 1.8.7 执行 Rails 3.2.1。当我在控制台上执行“rails s”时，会出现此消息：**undefined method `page_cache_extension' for ActionController::Base:Class**

我尝试评论这些行：

config.action_view.debug_rjs = true

config.action_controller.perform_caching = false

但不要为我工作。

我尝试运行的项目是这个-> [https://github.com/kivanio/brcobranca_exemlo](https://github.com/kivanio/brcobranca_exemplo)用于生成格式为 PDF 的巴西文档。

有人有什么想法可以帮助我解决这个问题吗？

感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:39:55.017

使用 Ubuntu 12.04，在您项目的当前主分支上，我能够克隆存储库，然后运行`bundle install`，`rake db:migrate`然后`rails server`该站点出现了。master 与您要运行的内容之间有什么区别吗？

# javascript - 在 Backbone.js 中，我如何从另一个视图调用一个视图中的函数？

> ID：15114338
> 
> 赞同：1
> 
> 时间：2013-02-27T14:18:01.500
> 
> 标签：javascript, backbone.js, openlayers, backbone-views

我将我的观点分成单独的文件。在我的主视图中，我试图在另一个视图中调用一个函数。有没有办法在 Backbone.js 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:35:54.313

一个好方法是使用调解器模式，这样您就不会紧密耦合您的视图。在最新版本的 Backbone 中，`Backbone`对象可以用作中介。

在视图 1 中：`Backbone.trigger('somethingHappened', {id: 1});`

在视图 2 中：

```
//action when 'something' happens
onSomething : function(data){
    console.log('Got that: ' + data.id)
}
//... in the view init ...
Backbone.on('somethingHappened', onSomething)
//... in the view destruction...
Backbone.off('somethingHappened', onSomething); 
```

您也可以使用更新的`listenTo`方法。当然，它只有在 view2 已经初始化的情况下才会起作用。

# java - 如何等待多线程发布订阅通道完成

> ID：15114340
> 
> 赞同：2
> 
> 时间：2013-02-27T14:18:17.510
> 
> 标签：java, spring-integration

我有一个 Spring Integration 项目，我想通过多个操作同时处理一条消息。所以我设置了一个`publish-subscribe-channel`和一个`task-executor`。但是我想在继续之前等待所有处理完成。我该怎么做？

```
<publish-subscribe-channel id="myPubSub" task-executor="my10ThreadPool"/>

<channel id="myOutputChannel"/>

<service-activator input-channel="myPubSub" output-channel="myOutputChannel"
         ref="beanA" method="blah"/>
<service-activator input-channel="myPubSub" output-channel="myOutputChannel"
         ref="beanB" method="blah"/>

<service-activator id="afterThreadingProcessor" input-channel="myOutputChannel" .../> 
```

因此，在上述情况下，我希望`afterThreadingProcessor`在两者之后只调用一次my`beanA`并`beanB`完成它们的工作。但是，在上面`afterThreadingProcessor`会被调用两次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:03:50.947

1.  添加`apply-sequence="true"`到 pub-sub 通道（这会将默认相关数据添加到消息中，包括`correlationId`、`sequenceSize`和 ，`sequenceNumber`并允许在下游组件上使用默认策略）。

2.  添加一个`<aggregator/>`before并将两个s`afterThreadingProcessor`的输出路由到它。`<service-activator/>`

3.  在聚合器之后添加一个`<splitter/>`- 默认拆分器会将聚合器生成的集合拆分为两条消息。

`afterThreadingProcessor`将为完成其工​​作的第二个线程上的每条消息调用一次。

您可以通过使用链来简化配置...

```
<chain input-channel="myOutputChannel">
    <aggregator />
    <splitter />
    <service-activator id="afterThreadingProcessor" input-channel="myOutputChannel" .../>
</chain> 
```

要对最终服务进行一次调用，只需将您的服务更改为采用 a`Collection<?>`而不是添加拆分器。

编辑：

为了在评论#3中做你想做的事情（在原始线程上运行最终服务），这应该可以工作......

```
<int:channel id="foo" />
<int:service-activator ref="twoServicesGateway" input-channel="foo"
      output-channel="myOutputChannel" />

<int:gateway id="twoServicesGateway" default-request-channel="myPubSub"/>
    <int:publish-subscribe-channel id="myPubSub" task-executor="my10ThreadPool"
            apply-sequence="true"/>
    <int:service-activator input-channel="myPubSub" output-channel="aggregatorChannel"
         ref="beanA" method="blah"/>
    <int:service-activator input-channel="myPubSub" output-channel="aggregatorChannel"
         ref="beanB" method="blah"/>
    <int:aggregator input-channel="aggregatorChannel" />

<int:service-activator id="afterThreadingProcessor" input-channel="myOutputChannel" .../> 
```

在这种情况下，网关封装了另外两个服务和聚合器；默认`service-interface`是简单的`RequestReplyExchanger`. 调用线程将等待输出。由于聚合器没有`output-channel`，框架会将回复发送到网关，等待线程接收到，返回，`<service-activator/>`然后将结果发送到最终服务。

您可能希望`reply-timeout`在网关上放置 a，因为默认情况下，它将无限期等待，并且如果其中一项服务返回 null，则不会收到任何聚合响应。

请注意，我缩进了网关流只是为了显示它从网关运行，它们不是网关的子元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-07T13:50:42.157

现在可以使用***Spring Integration 4.1.0***中引入的更简洁的方法来实现相同的行为，作为 EIP ***Scatter-Gather***模式的实现。

Checkout Scatter-Gather 示例要点： [https ://gist.github.com/noorulhaq/b13a19b9054941985109](https://gist.github.com/noorulhaq/b13a19b9054941985109)

# r - 在R中并排显示相同pdf中的两个热图

> ID：15114347
> 
> 赞同：5
> 
> 时间：2013-02-27T14:18:34.590
> 
> 标签：r, pdf, png, heatmap

我正在尝试在同一个 png 或 pdf 中并排显示两个或多个热图。布局或 mfcol 在这种情况下不起作用。有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-02T03:02:35.760

这是使用最近引入的 gridGraphics 包的一个选项，

[![在此处输入图像描述](../Images/a20cad2aab278cb38e1384c886e7deb4.png)](https://i.stack.imgur.com/bFlkk.png)

```
library(gridGraphics)
library(grid)
heatmap(as.matrix(mtcars))

library(gridGraphics)
grab_grob <- function(){
  grid.echo()
  grid.grab()
}

g <- grab_grob()
grid.newpage()

# library(gridExtra)
# grid.arrange(g,g, ncol=2, clip=TRUE)

lay <- grid.layout(nrow = 1, ncol=2)
pushViewport(viewport(layout = lay))
grid.draw(editGrob(g, vp=viewport(layout.pos.row = 1, 
                                  layout.pos.col = 1, clip=TRUE)))
grid.draw(editGrob(g, vp=viewport(layout.pos.row = 1, 
                                  layout.pos.col = 2, clip=TRUE)))
upViewport(1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-05T02:52:43.777

如 heatmap.2 的帮助文档中所述，

> 'heatmap.2()' 使用 'layout' 并在 2x2 布局的右下角绘制 'image'。因此，它*不能*在多列/行布局中使用，即，当'par(mfrow= *)' 或'(mfcol= *)' 已被调用时。

热图也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-05T08:03:22.120

这是一种方法。这很hacky，但我认为当一个函数没有做你想做的事情时，最好的解决方案就是让它去做。
函数`heatmap.2`在其代码的中间包含以下三行：

```
...
op <- par(no.readonly = TRUE)
on.exit(par(op))
layout(lmat, widths = lwid, heights = lhei, respect = FALSE)
... 
```

正是因为它们，您无法使用它们，`layout`并且`par(mar=...)`它会覆盖它。将 heatmap.2 的代码复制到一个新函数中（比如`heatmap.3`）并删除这三行：

```
heatmap.3 <- function(... #etc etc with the exact same code minus those 3 lines 
```

然后，您并排生成两个热图的代码将是，例如：

```
layout(rbind(c(4,3,8,7),c(2,1,6,5)), 
       widths = c(1,2,1,2), heights = c(1,2), respect = FALSE)
heatmap.3(x)
heatmap.3(y) 
```

准备布局时，请记住热图代码首先绘制热图本身，然后是“行”树状图，然后是“列”树状图，最后是直方图，因此从上到下、从左到右的顺序是 4、3、2 , 1 表示当两个热图并排时，它变为 4、3、8、7、2、1、6、5。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-27T09:24:55.950

在遇到完全相同的问题后，我想出了以下解决方案：

1) 使用 ggplot2 用树状图制作热图，如下所示：[Reproduce lattice dendrogram graph with ggplot2](https://stackoverflow.com/questions/6673162/reproducing-lattice-dendrogram-graph-with-ggplot2)然后用 multiplot() 函数排列它（[http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_%28ggplot2%29/](http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_%28ggplot2%29/)）

2）但是，这是很多工作，我想坚持使用基本的 heatmap() 函数。如果您安装了 imagemagick，以下内容很简单（尽管不是普通的 R）并且可以在 Linux 上运行：

```
m <- matrix(runif(10^2), ncol=10)
for (i1 in 1:4) {
    ifile <- paste0(i1,'_heatmap.pdf')
    pdf(ifile)
    heatmap(m)
    d <- dev.off()
}
system('montage -geometry 100% -tile 2x2 ./*_heatmap.pdf outfile.pdf') 
```

# c# - 如何访问其他形式的列表视图

> ID：15114352
> 
> 赞同：-1
> 
> 时间：2013-02-27T14:18:42.717
> 
> 标签：c#

我正在开发一个带有面部检测功能的 mp3 播放器。我有两种形式。

第一种形式是媒体播放器和面部检测代码，第二种形式是用于创建播放列表的代码。

我希望当我单击创建按钮时，播放列表的名称应该显示在第一种形式的列表框中。

这是我对 form1 的一些代码

```
 private Capture cap;
  public Form1()
    {
        InitializeComponent();

        cap = new Capture(0);
        _dataBasePath = Directory.GetCurrentDirectory() + @"\db1.mdb";

        // adjust path to find your xml

        haar = new HaarCascade("haarcascade_frontalface_alt_tree.xml");
        mouth = new HaarCascade("Mouth.xml");

        lefteye = new HaarCascade("eye_left.xml");
        righteye = new HaarCascade("haarcascade_righteye_2splits.xml");
    }

    public void DataBasePath(string path)
    {
        _dataBasePath = path;
    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        using (Image<Bgr, byte> nextFrame = cap.QueryFrame())
        {
            if (nextFrame != null)
            {
                // there's only one channel (greyscale), hence the zero index
                //var faces = nextFrame.DetectHaarCascade(haar)[0];
                Image<Gray, byte> grayframe = nextFrame.Convert<Gray, byte>();
                Image<Gray, Byte> gray = nextFrame.Convert<Gray, Byte>();
                Image<Gray, Byte> gray1 = nextFrame.Convert<Gray, Byte>();
                Image<Gray, Byte> gray2 = nextFrame.Convert<Gray, Byte>();
                var faces = grayframe.DetectHaarCascade(
                         haar, 1.4, 4,
                         HAAR_DETECTION_TYPE.DO_CANNY_PRUNING,
                         new Size(nextFrame.Width / 8, nextFrame.Height / 8)
                         )[0];
                foreach (MCvAvgComp f in faces)
                {
                    //draw the face detected in the 0th (gray) channel with blue color
                    nextFrame.Draw(f.rect, new Bgr(Color.Blue), 2);
                    facesnap = f.rect;

                    int halfheight = facesnap.Height/2;
                    int start = facesnap.X;
                    int start1 = facesnap.Y;

                    Rectangle top = new Rectangle(start,start1,facesnap.Width,halfheight);
                    int start2 = top.Bottom;

                    Rectangle bottom = new Rectangle(start, start2, facesnap.Width, halfheight);

                    //Set the region of interest on the faces
                    gray.ROI = bottom;
                    MCvAvgComp[][] mouthsDetected = gray.DetectHaarCascade(mouth,
                                                    1.1, 10,
                                                  Emgu.CV.CvEnum.HAAR_DETECTION_TYPE.DO_CANNY_PRUNING,
                                                    new Size(40,30));
                    gray.ROI = Rectangle.Empty;

                    foreach (MCvAvgComp m in mouthsDetected[0])
                    {
                        Rectangle mouthRect = m.rect;
                        mouthRect.Offset(bottom.X, bottom.Y);
                        nextFrame.Draw(mouthRect, new Bgr(Color.Red), 2);
                        Rectangle mouthphoto = new Rectangle(mouthRect.X - 5, mouthRect.Y - 10, mouthRect.Width + 5, mouthRect.Height +10);
                        detectedmouth = mouthphoto;
                    }
                    int halfwidth =facesnap.Width/2;

                    Rectangle toprighteye =new Rectangle(start,start1,halfwidth,halfheight);
                    int leftx = toprighteye.Right;
                    Rectangle toplefteye = new Rectangle(leftx, start1, halfwidth, halfheight);

                    gray1.ROI =toplefteye;

                    MCvAvgComp[][] detectedlefteye = gray1.DetectHaarCascade(lefteye, 1.1, 1, Emgu.CV.CvEnum.HAAR_DETECTION_TYPE.DO_CANNY_PRUNING, new Size(30,10));
                    gray1.ROI = Rectangle.Empty;

                    foreach (MCvAvgComp eyesnapleft in detectedlefteye[0])
                    {
                        Rectangle eyeRectleft = eyesnapleft.rect;
                        eyeRectleft.Offset(toplefteye.X, toplefteye.Y);
                        nextFrame.Draw(eyeRectleft, new Bgr(Color.Green), 2);

                        lefteyesnap = eyeRectleft;

                    }

                    gray2.ROI = toprighteye;

                    MCvAvgComp[][] detectedrighteye = gray2.DetectHaarCascade(righteye, 1.1, 1, Emgu.CV.CvEnum.HAAR_DETECTION_TYPE.DO_CANNY_PRUNING, new Size(30, 10));
                    gray2.ROI = Rectangle.Empty;

                    foreach (MCvAvgComp eyesnapright in detectedrighteye[0])
                    {
                        Rectangle eyeRectright = eyesnapright.rect;
                        eyeRectright.Offset(toprighteye.X, toprighteye.Y);
                        nextFrame.Draw(eyeRectright, new Bgr(Color.Yellow), 2);

                        righteyesnap = eyeRectright;

                    }

                }

                pictureBox1.Image = nextFrame.ToBitmap();
            }
        }

    }
 private void Form1_Load(object sender, EventArgs e)
    {
        _dataBasePath = Directory.GetCurrentDirectory() + @"\db1.mdb";

        // adjust path to find your xml

        haar = new HaarCascade("haarcascade_frontalface_alt_tree.xml");
        mouth = new HaarCascade("Mouth.xml");

        lefteye = new HaarCascade("eye_left.xml");
        righteye = new HaarCascade("haarcascade_righteye_2splits.xml");
    } 
```

这是form2的一些代码

```
namespace Face_Detection_Concept
{
    public partial class Form2 : Form
{
    #region Global Variables

    public const string Separator = ",";

    public static ArrayList searchAudio = new ArrayList();
    public static ArrayList searchVideo = new ArrayList();

    public static StreamWriter sw;
    public string fnm;
    #endregion

    public Form2()
    {
        InitializeComponent();
    }

    private void Form2_Load(object sender, EventArgs e)
    {
        // Set default values
        cmbType.SelectedIndex = 0;
        chkIncSubDir.Checked = true;

        LoadFormats();

        txtFilename.Text = "PlayList1.wpl";
    } 
```

当我使用此代码在按钮单击事件上访问 form1 的列表框时

```
new Form1().playlistviewbar.items.add(playlistname); 
```

但这不显示播放列表的名称。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:40:45.560

虽然您*可以*通过 make in 直接公开控件`public`，但更好的方法是创建操作`ListBox`内容的方法。这使您可以灵活地更改控件而不会破坏调用表单：

```
public void AddPlayList(string playlistname)
{
    this.playlistviewbar.Items.Add(playlistname);
}
public string[] GetPlayLists()
{
    return this.playlistviewbar.Items;  // converting to strings if necessary.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:21:18.570

您的`Capture`对象`cap`为空，您应该在启动计时器之前对其进行初始化，例如：

```
public void form_load()
    {

        cap = new Capture();

        //Init and start Timer

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:35:41.897

将 ListBox 的 modifiers 属性设置为 public，您可以通过已知方式访问它。

将调用Form的引用传递给被调用的Form，并带着它访问LB。

```
// Call:
Form2 test = new Form2(this);

//Constructor Form2:
public Form2 (Form1 FormToAccess)

//Access:
FormToAccess.listBox1.... = ... ; 
```

# azure - 使用联合为多个租户分区

> ID：15114366
> 
> 赞同：0
> 
> 时间：2013-02-27T14:19:29.080
> 
> 标签：azure, azure-sql-database

鉴于以下“事实”，我从阅读中收集到。

1.  联合从创建之时起就是独立的数据库。
2.  作为原件的副本，如果我更改原件的架构，它们将不会自动改变。
3.  作为单独的数据库，您不能交叉连接。
4.  每个联邦都作为一个单独的数据库定价。
5.  我必须为要联合的每个表提供一个 TenantId 字段。

如果这些都是正确的，那么使用联合来实现多租户而不是简单地单独的数据库有什么优势？或者，如果有不正确的，请让我直截了当。

请注意，我们的租户数量很少，可能只有 20 个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:26:38.587

你的理解是正确的。

联邦有一些有趣的方面可能对您有用。首先它是一个相对灵活的分区环境。例如，您可以根据客户的使用模式将 10 个租户分组到第一个成员中，将 50 个租户分组到第二个成员中。或者，您可以简单地隔离一个使用该系统的客户比其他客户更多。

另一个重要的概念是每个数据库可以有多个联合。例如，您可以有一个 Customer 联合和一个 SalesHistory 联合。

最后但并非最不重要的一点是，您可能想阅读这篇文章，该文章讨论了传统分片模型中发生的[连接池碎片](http://blogs.msdn.com/b/cbiyikoglu/archive/2012/02/08/connection-pool-fragmentation-scale-to-100s-of-nodes-with-federations-and-you-won-t-need-to-ever-learn-what-these-nasty-problems-are.aspx)，但这不是 SQL 数据库联合的问题。

# sharepoint - 将实体框架 5.0 与 sharepoint 2013 一起使用

> ID：15114372
> 
> 赞同：2
> 
> 时间：2013-02-27T14:19:54.323
> 
> 标签：sharepoint

我想将实体框架 5.0 与 sharepoint 2013 一起使用。当我部署一个简单的 Web 部件时，我收到“实体框架 5 无法加载文件或程序集实体框架 5.0 版”错误。

我可以在 sharepoint 2013 中使用实体框架吗？如果是这样，问题是什么？

谢谢你。

注意：我可以在web项目中使用ef5，另外我有另一台机器设置了sp2010和实体框架4.0。他们工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T11:16:07.703

在包清单上将实体框架添加到安全控件中，这将在相应的共享点 Web 应用程序的 web.config 中添加安全控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T14:12:38.993

我做了一个工作并使用 WCF 服务来连接数据库。

# arcgis - 如何在点击时切换 AccordionPane？

> ID：15114373
> 
> 赞同：0
> 
> 时间：2013-02-26T17:49:50.527
> 
> 标签：arcgis, dojo

我有一个使用带有两个“子容器”的 dijit.layout.AccordionContainer 的应用程序

加载地图时，其中一个容器默认打开。我希望在单击按钮时关闭默认容器并打开第二个容器。知道怎么做吗？

我曾尝试使用 selectChild() 方法，但一定是做错了，或者完全偏离了基础。

**编辑** 我的 HTML 是：

```
<div dojotype="dijit.layout.ContentPane" id="leftPane" region="left" splitter="true">
        <div dojotype="dijit.layout.AccordionContainer">
      <div dojotype="dijit.layout.ContentPane" title="Table of Contents">
                        <div id="tocDiv">
                        </div>
                    </div>
                    <div dojotype="dijit.layout.ContentPane" title="Search Results" id="tab2">
                                                <div id="datagrid">
                                                <table data-dojo-type="dojox.grid.DataGrid" data-dojo-id="grid"  id="grid" data-dojo-props="rowsPerPage:'5', rowSelector:'20px'">
                                            <thead>
                                                <tr>
                                                    <th field="Parcel Identification Number" width="25%">
                            Parcel ID
                                                    </th>
                                                    <th field="Site Address" width="30%">
                            Address
                                                    </th>
                                                </tr>
                                            </thead>
                                        </table>
                                        </div>
                    </div>
        </div>
        </div> 
```

我试图通过我为点击时需要发生的其他一些事情创建的功能在点击时打开“tab2”

JS：

```
function doFind() {             
        //Set the search text to the value in the box
        findParams.searchText = dojo.byId("parcel").value;
                grid.showMessage("Loading..."); //Shows the Loading Message until search results are returned.
        findTask.execute(findParams,showResults);
      } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T18:30:49.643

你很接近。

我假设您正在收听自己的按钮单击事件。如果您不这样做，请尽可能发布该部分代码。

如果是这样，那么你需要这样做：

```
<accordian-container>.selectChild( <pane to open>); 
```

您需要将窗格传递给 selectChild 方法。

手风琴容器是一种堆栈容器，因此本文档应该会有所帮助：

[http://dojotoolkit.org/reference-guide/1.8/dijit/layout/StackContainer.html](http://dojotoolkit.org/reference-guide/1.8/dijit/layout/StackContainer.html)

这是 Stackoverflow 上几乎相同问题的链接： [Whats the best way to programatally open a pane inside Dijit AccordionContainer](https://stackoverflow.com/questions/1190157/whats-the-best-way-to-programatically-open-a-pane-inside-dijit-accordioncontaine)

# sharepoint-2010 - 为什么我无法将外部内容类型添加为我的 SharePoint 列表中的列？

> ID：15114377
> 
> 赞同：1
> 
> 时间：2013-02-27T14:20:02.157
> 
> 标签：sharepoint-2010, external-contenttype

我已经创建了一个外部内容类型，它从 SQL Server 存储过程中获取 2 列数据，现在我正试图将它添加到我创建的列表中。但是，当我选择我的外部内容类型时，我收到以下错误消息：

“未找到业务数据连接对象。管理员，请参阅服务器日志以获取更多信息。”

当我转到管理中心的 BDC 服务部分时，我看到了外部内容类型。有任何想法吗？

# javascript - 动画元素到另一个元素的位置

> ID：15114379
> 
> 赞同：1
> 
> 时间：2013-02-27T14:20:08.370
> 
> 标签：javascript, jquery, jquery-animate

我正在尝试为图像设置动画，以便覆盖另一个图像。这是我尝试过的，但没有成功：

```
var xrect = $("#black").offset().left;
var yrect = $("#black").offset().top;

var xlogo = $("#logo").offset().left;
var ylogo = $("#logo").offset().top;
$('.logo').transition({ x: xrect + 'px', y: yrect + 'px' }); 
```

HTML 是：

```
<img class="logo" id="logo" onclick="animateLogo()" src="images/logo.png" alt="logo"/>
<br />
<img class="black" id="black" src="images/black.png" alt="black logo"/> 
```

有谁知道做这种性质的事情的例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:25:28.413

该`transition`函数不是默认的 JQuery 实现。试试吧：http `animate`: [//api.jquery.com/animate/](http://api.jquery.com/animate/)

我添加了一个 z-index 值，以确保您的徽标位于矩形上方。

将您的图像样式位置设置为绝对像@dfsq 建议

```
 img {position: absolute; z-index: 1;}

    var xrect = $("#black").offset().left;
    var yrect = $("#black").offset().top;

    var xlogo = $("#logo").offset().left;
    var ylogo = $("#logo").offset().top;

    $('#logo').css('z-index',999).animate({ left: xrect + 'px', top: yrect + 'px' },2000); 
```

# reporting-services - Visual Studio 在选择数据源窗口中选择数据源时关闭

> ID：15114381
> 
> 赞同：1
> 
> 时间：2013-02-27T14:20:10.697
> 
> 标签：reporting-services, visual-studio-2012

我正在尝试在`Visual Studio 2012 Ultimate`. 我创建我的`.rdlc`文件。然后我添加一个`ReportViewer`到我的`.aspx`页面。然后我选择`SmartTag`并`ReportViewer`选择`.rdlc`文件。之后我选择`Choose Data Source`. 当我选择我的数据源时`Visual Studio`关闭，没有任何错误消息。我试过这个`Visual Studio 2010`没有任何问题。这是一个错误`Visual Studio 2012`吗？还是我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-15T00:33:56.207

[这是此处](https://stackoverflow.com/questions/14961293/visual-studio-2012-crashed-while-adding-data-source-to-report-viewer)提到的[解决方法](http://blogs.msdn.com/b/selvar/archive/2014/01/16/visual-studio-2012-and-2013-crashes-when-you-bind-datasource-to-rdlc-from-report-viewer-web-control.aspx)和[Microsoft Connect 错误](http://connect.microsoft.com/VisualStudio/feedback/details/812807/visual-studio-crashes-when-selecting-a-report-viewers-datasource)的问题的副本

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-08T05:42:35.997

我实际上只是在我自己的应用程序中解决了这个问题，所以我想我会弹出并分享。

我的问题是表单（在您的情况下是 .aspx 页面）与数据源具有相同的名称，并且它正在创建循环依赖项。更改其中一个名称，然后！工作了一个款待！

# .net - 在 Visual Studio 2010 中安装 Crystal Report

> ID：15114385
> 
> 赞同：-3
> 
> 时间：2013-02-27T14:20:29.723
> 
> 标签：.net, vb.net

我已经为 SAP 公司的 Visual Studio 2010 安装了 Crystal Report。仍然当我为我的项目打开一个水晶报表时，它会显示以下屏幕。我该如何解决这个问题？

![http://i.stack.imgur.com/syiYG.jpg](../Images/d5ed256c09bd2effc5ecddf86eb31336.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T05:20:39.193

试试完整的包，看看。我有同样的问题，这解决了它。[http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_13_0_2.exe](http://downloads.businessobjects.com/akdlm/cr4vs2010/CRforVS_13_0_2.exe)

# http - 匿名文件传输

> ID：15114389
> 
> 赞同：1
> 
> 时间：2013-02-27T14:20:39.613
> 
> 标签：http, proxy, ftp, file-transfer

有谁知道在两台计算机之间匿名传输某些文件的方法？我打算隐藏发件人电脑的 IP 地址。有一种简单的方法可以做到这一点吗？例如使用 tor...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:26:39.167

使用受信任的共享存储空间。机器 A 将内容上传到共享存储，机器 B 从共享存储中获取内容。机器A不需要知道机器B的身份；机器 B 确实需要知道机器 A 的身份。

# c# - 如何返回 IEnumerable 与 linq。获取子查询返回超过 1 个值

> ID：15114391
> 
> 赞同：1
> 
> 时间：2013-02-27T14:20:48.797
> 
> 标签：c#, sql, linq

我希望查询返回一个`NotificationConfiguration`和一个`IEnumerable<string>`（稍后我将使用 SB 将其转换为单个字符串）。一旦查询将这两项返回给我，我将使用视图模型中的构造函数对其进行转换，以便可以使用 DataTable 正确显示所有数据。我正在寻找的答案可能非常具体，但我需要了解为什么在我希望它返回时会收到子查询错误`IEnumerable<string>`以及如何修复它。另请注意...根据.net docs，代码应该交给我，`IEnumerable<string>`但由于某种原因它仍然崩溃。这是相关的代码示例：

```
 [HttpPost]
    public ActionResult Index(DataTableRequest requestedData)
    {
        using (this.dataStore.Session.BeginTransaction())
        {
            return this.dataStore.Query<NotificationConfiguration>()
                          .TableRange(requestedData, p => new NotificationConfigurationViewModel(p,  p.Events.Select(x => x.Code) ?? null));
        }
    } 
```

.

```
 public NotificationConfigurationViewModel(NotificationConfiguration notification , IEnumerable<string> events)
{
    Contract.Requires(notification != null);

    this.notification = notification;
    this.events = events;
} 
```

.

```
[Display(Name = "Events")]
public virtual string EventTypeCodes
{
    get
    {
        var codes = new StringBuilder();

        foreach (var item in this.events)
        {
           codes.Append(item + ",");
        }

        return codes.ToString().TrimEnd(',');
    }
} 
```

# php - xdebug 没有在 mamp 上运行

> ID：15114392
> 
> 赞同：5
> 
> 时间：2013-02-27T14:20:53.920
> 
> 标签：php, mamp, xdebug

我正在尝试在 mamp 上运行 xdebug 并遵循了许多教程，但是当我在 phpinfo() 中看到它时，我没有找到 xdebug。正如我阅读的那样，xdebug 已经包含在 mamp 中。[这](http://debuggable.com/posts/setting-up-xdebug-on-mac-os-x-or-win32-linux:480f4dd6-0240-4a90-8fa1-4e41cbdd56cb)是我在 php.ini 中添加的行，我还去了那个位置查看 xdebug.so 是否存在。但它仍然无法正常工作。有什么帮助吗？我正在使用 mamp 2.1.2

ps 我修改了php版本以在php.ini中从php5到php5.4.10进行挖掘

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-08-23T10:23:00.377

我不知道是否为时已晚，但我确信有人需要真正的答案。

要解决在线问题，必须将 php.ini 更改为正确的路径...

对于 php 5.4.10，有两个 php.ini，我都更改了，它对我有用。他们在：

```
MAMP/conf/php5.4.10/php.ini
and
MAMP/bin/php/php5.4.10/conf/php.ini 
```

当我更改第二个时，我重新加载 MAMP 并且它工作！如果你想知道它是否工作，在 localhost 上打开 MAMP，点击 phpinfo 并找到 xdebug。

另外，我不得不说我在 httpd.conf (MAMP/conf/apache) 中将端口 8888 更改为 80（您必须将 Listen:8888 更改为 Listen:80 并将 local_host:8888 更改为 local_host:80。（不带 _）在这种情况下，你只需要去 http://localhost 就可以看到你的项目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-12T17:06:25.100

谢谢@titolancreo！

几个小时后，我正要放弃今天，只需在两个 php.ini 中添加相同的行，它就突然起作用了！

您也可以在终端中执行此操作以了解它是否有效：

```
php -m 
```

您应该能够看到 Xdebug 模块两次，一次在 [PHP Modules] 列表中，另一次在 [Zend Modules] 列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-30T06:34:12.790

确保您正在收听来自 php.info 的正确端口，对我来说是 `xdebug.remote_port=9900`

然后在vcode中

```
{
        "name": "Listen for XDebug",
        "type": "php",
        "request": "launch",
        "port": 9900
    }, 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-22T13:30:22.357

您还必须检查——（我已经看到了）——xdebug.so 文件是否存在于 php.ini 中指定的位置。

在我的情况下，原来的行是：

```
zend_extension="/Applications/MAMP/bin/php/php7.1.0/lib/php/extensions/no-debug-non-zts-20151012/xdebug.so" 
```

我终于将其更改为指向正确的位置并且它起作用了：

```
zend_extension="/Applications/MAMP/bin/php/php7.1.0/lib/php/extensions/no-debug-non-zts-20160303/xdebug.so" 
```

但是在 php_error.log 中没有错误消息。我无法弄清楚为什么某些 .so 文件在日志中被报告为丢失，而其他一些文件却没有，比如这个。

# css - 块级盒子和主要块级盒子有什么区别？

> ID：15114396
> 
> 赞同：7
> 
> 时间：2013-02-27T14:21:02.247
> 
> 标签：css

引用[规范](http://www.w3.org/TR/CSS21/visuren.html)：

> 块级框是参与块格式化上下文的框。每个块级元素生成一个主块级框，其中包含后代框和生成的内容，也是任何定位方案中涉及的框。一些块级元素可能会生成除主框之外的其他框：“列表项”元素。这些附加框相对于主框放置。

它们本质上是一样的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T14:27:19.810

主要块级框是由给定元素生成的块级框，该元素直接受应用于该元素的样式规则影响。

大多数元素只生成一个框。对于这些元素，它们*本质*上是相同的，因为不涉及其他框。

但是，一个元素可以根据其显示类型生成多个框，例如[列表项](http://www.w3.org/TR/CSS21/generate.html#lists)；当您为此类元素声明样式时，这些样式通常应用于主框，并且生成的任何其他框都将相应地呈现。

例如，一个列表项除了主框外还有一个标记框；如果您指定`list-style-position: outside`，列表标记将放置在主体框的边界之外，但主体框的背景和边框不会受到影响。请注意，标记框仍然是主框的后代，因此可继承的属性（例如）`color`将应用于标记（这就是为什么`color: red`将文本及其项目符号标记变为红色的原因）。

大多数其他块级元素，包括`display: block` *但*不包括`display: table`（参见[第 17.4 节](http://www.w3.org/TR/CSS21/tables.html#model)），只会为它们的内容生成一个主要的块盒，而不是其他任何东西，使它们基本上只是“块盒”，但仅限于那些元素。

换句话说，所有主体块级框都是块级框，但并非所有块级框都是主体，例如[匿名块框](http://www.w3.org/TR/CSS21/visuren.html#anonymous-block-level)。此外，包括内联块在内的内联元素本身不会生成任何主盒，也没有主内联盒之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:33:50.907

主要块本质上是您的“标记”所代表的内容，出于机械目的，某些“主要”元素需要正确呈现其他元素，这些是浏览器显示额外内容所需的某种“工件”（来自例如文本区域）

# c# - C# 循环：遍历数组

> ID：15114403
> 
> 赞同：16
> 
> 时间：2013-02-27T14:21:26.243
> 
> 标签：c#, loops

如果我有如下循环：

```
foreach (string pass in new string[] { "pass1", "pass2", "pass3" })
{
 x = pass; //etc
} 
```

匿名字符串数组是最初创建一次，还是每次通过都重新创建一次？

我相信前者，但同事们确信这是一个等待发生的错误，因为他们说 foreach 循环的每次迭代都会导致创建一个新的字符串数组。

VS 反汇编代码表明我是对的，但我想确定一下。

我们正在研究这个的原因是试图理解一个神秘的错误，它报告一个集合在迭代时发生了变化。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-27T14:26:18.133

根据[Eric Lippert 博客](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)和[规范](http://msdn.microsoft.com/en-us/library/aa664754%28v=vs.71%29.aspx)，foreach 循环是一种语法糖：

```
{
  IEnumerator<string> e = ((IEnumerable<string>)new string[] { "pass1", "pass2", "pass3" }).GetEnumerator();
   try
   { 
     string pass; // OUTSIDE THE ACTUAL LOOP
      while(e.MoveNext())
      {
        pass = (string)e.Current;
        x = pass;
      }
   }
   finally
   { 
      if (e != null) ((IDisposable)e).Dispose();
   }
} 
```

如您所见，枚举器是在循环之前创建的。

@Rawling 正确指出，编译器对该数组的处理略有不同。*Foreach*循环被优化为带有数组*的 for循环。*根据[The Internals of C# foreach](http://www.csharphelp.com/2007/09/the-internals-of-c-foreach/)您的 C# 5 代码将如下所示：

```
string[] tempArray;
string[] array = new string[] { "pass1", "pass2", "pass3" };
tempArray = array;

for (string counter = 0; counter < tempArray.Length; counter++)
{
    string pass = tempArray[counter];
    x = pass;
} 
```

初始化也只发生一次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T14:32:37.987

如果你查看 ILSpy，这段代码会被翻译成类似

```
string[] array = new string[]
{
    "pass1",
    "pass2",
    "pass3"
};
for (int i = 0; i < array.Length; i++)
{
    string pass = array[i];
} 
```

所以是的，数组只创建一次。

但是，说服您的同事的最佳参考可能是 C# 规范的第 8.8.4 节，它基本上会告诉您 LazyBerezovsky 的答案的作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T14:30:31.923

它最初只创建一次。

我尝试了 Ofer Zelig 的建议（来自评论）

```
foreach (DateTime pass in new DateTime[] { DateTime.Now, DateTime.Now, DateTime.Now })
{
    int x = pass.Second; //etc
} 
```

并设置断点。即使您在迭代之间等待，它也会为所有 3 次迭代提供相同的秒数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T14:26:13.027

您可以对其进行测试（有很多方法可以这样做，但这是一种选择）：

```
string pass4 = "pass4";
foreach (string pass in new string[] { "pass1", "pass2", "pass3", pass4 })
{
    pass4="pass5 - oops";
    x = pass; //etc
} 
```

然后看看有什么结果。

你会发现你是对的——它只执行了一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T14:41:24.190

下面的示例应该回答是否重新创建数组的问题。

```
 int i = 0;
        int last = 0;

        foreach (int pass in new int[] { i++, i++, i++, i++, i++, i++, i++ })
        {
            if (pass != last)
            {
                throw new Exception("Array is reintialized!");
            }
            last++;
        }

        if (i > 7)
        {
            throw new Exception("Array is reintialized!");
        } 
```

# ruby-on-rails - Ruby on Rails 搜索 2 个模型

> ID：15114406
> 
> 赞同：0
> 
> 时间：2013-02-27T14:21:32.357
> 
> 标签：ruby-on-rails, ruby, search, models

对...我已经花了 3 天的时间尝试自己做这件事。

我有 2 个模型，称为 Film 和 Screenings。放映属于_电影，电影有_许多放映。

电影具有某些属性（:title、:date_of_release、:description、:genre）。

放映具有属性(:start_time, :date_being_screened, :film_id(Film 的外键))。

我想做的是针对这两个模型创建一个搜索。我想做这样的事情......

@films = Film.advanced_search(params[:genre], params[:title], params[:start_time], params[:date_showing])

然后在电影模型中......

```
def self.advanced_search(genre, title, start_time, date)
    search_string = "%" + title + "%"

    self.find(:all, :conditions => ["title LIKE ? OR genre = ? OR start_time LIKE ? OR date_showing = ?", title, genre, start_time, date], order: 'title')
    end
end 
```

我认为这不可能像这样工作，但我希望我的解释足够详细，让任何人都能理解我在尝试做什么？？：-/

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:40:34.697

我会将搜索功能提取到一个单独的（非 ActiveRecord）类中，例如`AdvancedSearch`它不完全适合`Film`or`Screening`类。

无需编写复杂的 SQL 查询，您可以只搜索电影，然后是放映，然后组合结果，例如：

```
class AdvancedSearch
  def self.search
    film_matches = Film.advanced_search(...) # return an Array of Film objects
    screening_matches = Screening.advanced_search(...) # return an Array of Screening objects

    # combine the results
    results = film_matches + screening_matches.map(&:film)

    results.uniq # may be necessary to remove duplicates
  end
end 
```

更新

假设您的高级搜索表单有两个字段 - 类型和位置。因此，当您提交表单时，发送的参数是：

```
{ :genre => 'Comedy', :location => 'London' } 
```

您的控制器将类似于：

```
def advanced_search(params)
  film_matches = Film.advanced_search(:genre => params[:genre])
  screening_matches = Screening.advanced_search(:location => params[:location])

  # remaining code as above 
end 
```

即，您正在拆分参数，将每个参数发送到不同的模型以运行搜索，然后组合结果。

这本质上是一个 OR 匹配——它将返回与该类型匹配或正在该指定地点放映的电影。（如果您想要 AND 匹配，则需要计算出数组交集）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:23:38.343

我想写点东西，但这个演员表说的都是[http://railscasts.com/episodes/111-advanced-search-form](http://railscasts.com/episodes/111-advanced-search-form)

和你的情况几乎一样。

# c++ - 加速度计“高度变化”代码 PIC

> ID：15114408
> 
> 赞同：0
> 
> 时间：2013-02-27T14:21:32.937
> 
> 标签：c++, c, accelerometer, pic

我正在执行一个项目，该项目是一种测量从悬崖跌落高度变化并测量水深以确定跳跃是否安全的装置。经验法则表明，2:1 的比例是合适的，例如，如果悬崖为 10 米，则水深必须至少为 5 米。该电路包含以下组件：

单片机PIC18F45K20

加速度计 ADXL335

声纳传感器（从“幸运便携式探鱼器”中回收）

2 x 1 瓦 LED

我正在使用 MPLab 版本 8.76 - Pick it 3 Programmer/Debugger

..................................................... ...................................

我正在努力利用此操作的代码，如果有任何片段/示例代码，我将不胜感激，特别是用加速度计测量“高度变化”。

最亲切的问候

最大限度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:30:02.273

由于双积分误差，在给定加速度的情况下测量位移几乎是不可能的。

但是，您很幸运，因为您只想测量自由落体。只需监控加速度计，当总加速度低于阈值（即重力消失）时，假设设备以 9.81 m/s ²的速度下降。当然，重力因地而异，最终速度会出现，但我认为这不会真正影响潜水员。

只需添加加速度计通道，无需计算实际矢量幅度。以尽可能高的频率运行它。公式是`9.81 / ( 2 * freq * freq ) * t * t`其中`t`是可忽略量级的加速度计读数的数量。

我不知道如何操作声纳。

请注意，您需要对依赖设备实际计划潜水的任何人的生命负责。

# ruby-on-rails - Ruby 哈希值到值数组中

> ID：15114413
> 
> 赞同：0
> 
> 时间：2013-02-27T14:21:40.190
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, hash

我有一个哈希 {:a => b} 并且我想向该键添加一个值并将其转换为保留前一个值的数组。

所以结果是 {:a => [b, c]}

有没有比遍历哈希更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:26:13.930

试试这个。

```
h = {a: b}
h[:a] = ((a[:a].is_a? Array) ? a[:a] : [a[:a]]) << c 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:25:43.000

简单的解决方案是创建一个数组哈希：

```
h = {}
h[:a] = []
h[:a].push(b)
h[:a].push(c) 
```

我的意思是：即使只有一个值，也要使用数组。这使得处理更容易。

# jquery - 变量值未正确设置

> ID：15114415
> 
> 赞同：3
> 
> 时间：2013-02-27T14:21:50.097
> 
> 标签：jquery, global-variables, getjson

在 getJSON 函数中未正确设置变量值。变量 $videoId 显示第一个警报中预期的 396 和 397。

但在第二个警报中，值 397 显示了两次。

我在这里错过了什么吗？我在这里找不到任何其他讨论此类问题的帖子。如果是这样，请指点我那里。

下面是 jQuery 代码。

```
 $( "div .ow_video_list_item").each(function(){         
     $videoId = $(this).children("a").attr("href").split("/")[5];
     alert($videoId);    ==> First Alert

     $.getJSON("video/get-embed/" + $videoId + "/", function (data)   
     {                        
         $.each(data, function (key, code) {                                  
             alert($videoId);   ==> Second Alert
         });       
     });  

  }); 
```

下面是 HTML 代码：

```
<div class="ow_video_list_item ow_small">
    <a href="http://site.com/video/396">Video 1</a>
</div>

<div class="ow_video_list_item ow_small">
    <a href="http://site.com/video/397">Video 2</a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:28:53.403

假设`$videoLink`实际上`$videoId`正如评论所指出的那样：

这是因为该`getJSON`方法是异步的，并且您正在处理 javascript 闭包。当您执行`getJSON`回调时：

```
function (data)   
     {                        
         $.each(data, function (key, code) {                                  
             alert($videoId);   ==> Second Alert
         }); 
```

你已经循环了你的第一个每个循环，并且 $videoId 已经取了最后一个值，因此显示 397 两次。

看看 javascript 闭包是如何工作的：[JavaScript 闭包是如何工作的？](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:32:36.323

当你做`getJson`方法时，你使用异步代码。在这种情况下，您给出的最后一个值`$videoID`在`397`两个回调中都是警报值。有几种方法可以解决这个问题。例如，您可以返回`videoID`从操作中检索到的“数据”中的值`getJson`并使用它`alert(data.videoID)`。或者，您可以拥有一个带有适当键的值数组，而不是一个简单的整数变量。例如，它可以是索引（`i`in : `$().each(function(i,e) {})`）。你需要找到一种方法让它像那样工作。我确实认为这`data.id`将是最简单的方法！希望它有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:45:29.947

关于 getJson 的异步性质的其他评论是正确的。但大多数情况下，问题在于您使用了全局变量 $videoId。如果您更换：

```
$videoId = $(this).children("a").attr("href").split("/")[5]; 
```

经过

```
var $videoId = $(this).children("a").attr("href").split("/")[5]; 
```

即使使用异步方法，您也会没事的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T15:25:40.690

几件事。

*   在您的代码中没有定义 $videoId，我假设 $videoLink 确实应该是 $videoId。以供将来参考，如果可能更容易执行类似的操作来访问该数据点

`<a href="http://site.com/video/396" data-video-id="396">Video 1</a>`

这样您就可以使用 轻松访问该视频 ID `$(element).data('videoId')`。为此还有其他策略，例如使用类。

*   如果在您的代码示例中 $videoLink 不应该是 $videoId，那么 $videoId 是在该函数范围之外的某个地方定义的。有很多关于 JS 范围/闭包的资源。如果您正在做大量的 JS 开发工作，我建议您使用[Javascript: The good parts](https://rads.stackoverflow.com/amzn/click/com/0596517742)。

*   回到假设您的代码示例中的 $videoLink 实际上是 $videoId 。您在该 .each 循环中分配它的值，但该变量本身并未在该函数内部“关闭”。它要么是全局的，要么是在每个循环范围之外的其他地方定义的。`var`在语句前面抛出 a`$videoLink =`以保持该 var 被包含。

*   另一个潜在问题是您正在调用对服务器的异步调用，但取决于该异步调用范围之外的变量。大多数情况下，这些调用将在几毫秒内完成，但了解正在发生的事情的一个好方法是在脑海中单步执行代码，并假装每个服务器调用将花费 1 分钟。在您的示例中，外部循环运行一次，获取 396 的 id 然后触发 AJAX 请求，然后再次循环并为 id 397 执行相同的操作。服务器在第二个 ajax 请求所用的时间内没有响应开火。所以你现在有 2 个 ajax 请求。一分钟后他们回来了，哦，看，你的 $variableLink 变量的值为 397，因为它是在 ajax 回调函数之外定义的。解决方案？有几个。

还有其他方法可以做到这一点，但是在不知道除了跟踪该变量之外您正在尝试做什么的确切用例的情况下，很难说。但这应该给你一个很好的起点。

# paypal - Paypal 获取订阅详情

> ID：15114418
> 
> 赞同：1
> 
> 时间：2013-02-27T14:21:58.223
> 
> 标签：paypal

我的网站正在使用订阅付款，而老程序员没有使用 ipn 来激活他使用自定义返回 url 的帐户（是的，非常愚蠢）。

这里的问题是，旧订阅没有附加到 ipn 的任何自定义信息（新订阅可以）。

有没有办法找出初始付款中使用的退货网址？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:52:26.670

无法从 PayPal 帐户查看此信息。但是，账户持有人可以联系 PayPal 并让他们检查其中一笔旧交易的交易详情，他们可以告诉他该交易的重定向/返回 URL 是什么。如果您在从客户支持处获取此信息时遇到任何问题，帐户保留也可以在 www.paypal.com/mts 上向 PayPal MTS 开票，请求提供信息。他需要使用在他的 PayPal 帐户上注册的电子邮件地址，并且他需要为客户想要返回 URL 的交易之一提供交易 ID。如果在那之后您有任何问题，请告诉我，给我发一个带有票号的 PM。

# xml - 多级 XSD 约束

> ID：15114420
> 
> 赞同：0
> 
> 时间：2013-02-27T14:22:07.320
> 
> 标签：xml, xsd

目前，我们正试图让模型对我们的 XSD 有好处。这是问题：

```
List
 I-> Item1
       I->Element1
       I->Element2
       I->Element3       
 I-> Item2
       I->Element1
       I->Element2
       I->Element3
 I-> Item3
       I->Element1
       I->Element2
       I->Element3

ReferenceToElement
 I-> Item1/Element1 
```

我们有一个模型，我们需要两个嵌套列表。所以有一个带有“项目”的列表，每个项目都有一个带有元素的列表。所以我们要引用这些元素。

**第一种方法**

每个项目/元素都有一个数字属性。number 属性在所有项目中都是唯一的。此外，number 属性在所有元素中都是唯一的，因为父项的编号使用其编号进行编码。例如，对于 item.no = 2，所有元素看起来像这样 2xx，所以 201、202 等。这当然会将元素限制为 100，这对我们来说很好。

为了保持引用元素的存在，我们对所有项目以及所有项目中的所有元素都创建了一个唯一的约束。所以我们对元素的引用看起来像这样

```
Reference
  - ItemNo
  - ElementNo 
```

通过这种方式，我们确保了项目和元素的存在。我知道这两个字段之间存在问题，因为引用的项目不一定在 elementno.xml 中隐式说明。例如 ItemNo=1，但 ElementNo=202。这样，模式验证至少会告诉我们这些元素是否确实存在。主要缺点是我们需要注意正确分配所有元素中的数字，这会立即杀死我们。

**第二种方法**

我们不会对 elementNo 使用约束，而是使用 itemNo。这样我们就可以在所有元素上使用简单的数字，但是在模式验证期间我们将失去对 elementNo 的引用完整性。这似乎是我们目前最好的方式。

**问题：**

有没有办法使用 XSD 功能对两阶段参考进行建模？我读了一些关于断言的东西，但在这种情况下它似乎对我们没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T16:04:04.337

[*请注意，如果您实际展示了一些 XML，那么理解您的问题会更容易一些。事实上，任何答案都必须部分基于对您的散文描述旨在描述的 XML 构造的猜测；那么，带着一粒盐把它们拿走。*]

如果我理解您，您希望施加几个限制（此处编号以供参考）：

1.  每个`<element>`元素都显示为元素的子`<item>`元素。

2.  每个`<element>`and`<item>`元素都有一个`number`属性，其值为一个标识号；每个`number`属性的值是一个有限的十进制数字序列。

3.  每个元素的标识号在某个标识的容器元素（例如文档元素）中的`<item>`所有元素中都是唯一的。`<item>`

4.  每个元素的标识号在同一容器元素中的`<element>`所有元素中都是唯一的。`<element>`（或者你的意思是它`<element>`在包含项目中的所有元素中都是唯一的？我无法从你的描述中看出。）

5.  每个`<element>`元素的标识号将以父`<item>`元素的标识号作为前缀。

6.  每个`<element>`元素的标识号将比父`<item>`元素的标识号长两位数。

以下模式强加了这些约束。由于您提到断言，我假设您能够使用 XSD 1.1。（如果你没有 1.1，你就没有断言。）

```
<xs:schema 
    targetNamespace="http://example.com/elements-and-items"
    xmlns:tns="http://example.com/elements-and-items"
    elementFormDefault="qualified"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="test" type="tns:test">
    <xs:unique name="item-unique">
      <xs:annotation>
        <xs:documentation>
          Ensure that the number attribute on each
          item is unique within the 'test' element.
          (Enforces constraint 3.)
        </xs:documentation>
      </xs:annotation>
      <xs:selector xpath=".//tns:item"/>
      <xs:field xpath="@number"/>
    </xs:unique>
    <xs:unique name="element-unique">
      <xs:annotation>
        <xs:documentation>
          Ensure that the number attribute on each
          item is unique within the 'test' element.
          (Enforces constraint 4\.  If 'element' elements
          are only supposed to be unique within 'item'
          elements, then move this to the declaration of
          the 'item' element, and forget constraint
          5.)                    
        </xs:documentation>
      </xs:annotation>
      <xs:selector xpath=".//tns:item/tns:element"/>
      <xs:field xpath="@number"/>
    </xs:unique>

  </xs:element>

  <xs:element name="item" type="tns:item"/>

  <xs:element name="element" type="tns:element"/>

  <xs:complexType name="test">
    <xs:annotation>
      <xs:documentation>
        Each 'test' element contains a sequence of
        'item' elements.
        (Helps enforce constraint 1.)
      </xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:item" maxOccurs="unbounded"/>
    </xs:sequence>        
  </xs:complexType>

  <xs:complexType name="item">
    <xs:annotation>
      <xs:documentation>
        Each 'item' element contains a sequence of
        'element' elements.
        (Helps enforce constraint 1.)
        Each 'item' element has a 'number' attribute,
        of type 'tns:number'.
        (Enforces constraint 2 for 'item' elements.)
      </xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:element" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:attribute name="number" type="tns:number"/>
    <xs:assert test="
        every $id in ./@number satisfies
        every $e in .//tns:element/@number satisfies
        starts-with($e,$id)">
      <xs:annotation>
        <xs:documentation>
          Each element-identifying number has the
          item-identifying number of the containing item
          as a prefix.
          Enforces constraint 5.
        </xs:documentation>
      </xs:annotation>
    </xs:assert>
    <xs:assert test="
        every $id in ./@number satisfies
        every $e in .//tns:element/@number satisfies
        string-length($e) = string-length($id) + 2">
      <xs:annotation>
        <xs:documentation>
          Each element-identifying number is two
          digits longer than the item-identifying
          number of the containing item.
          Enforces constraint 6.
        </xs:documentation>
      </xs:annotation>
    </xs:assert>
  </xs:complexType>

  <xs:complexType name="element" mixed="true">
    <xs:annotation>
      <xs:documentation>
        Each 'element' element has a 'number' attribute,
        of type 'tns:number'.
        (Enforces constraint 2 for 'element' elements.)
      </xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="number" type="tns:number"/>
  </xs:complexType>

  <xs:simpleType name="number">
    <xs:restriction base="xs:string">
      <xs:pattern value="\d+"/>
    </xs:restriction>
  </xs:simpleType>
</xs:schema> 
```

请注意，每个 XSD 1.1 处理器都需要在断言中支持相当少的 XPath 2.0 子集；我没有努力尝试在该子集中编写断言（但我也没有努力决定它们是否可以写入该子集中）。

一个有效的实例，在结构上与您的非 XML 示例相同（据我所知）：

```
<test xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="
    http://example.com/elements-and-items 
    uniqueness.xsd"
 xmlns="http://example.com/elements-and-items">

  <item number="1">
    <element number="101"/>
    <element number="102"/>
    <element number="103"/>
  </item>
  <item number="2">
    <element number="201"/>
    <element number="205"/>
    <element number="206"/>
  </item>
  <item number="3">
    <element number="303"/>
    <element number="301"/>
    <element number="302"/>
  </item>

</test> 
```

通过违反每个约束来说明每个约束的无效实例；如果架构正在完成其工作，则应检测到每个违规行为，并应使相应的元素或项目无效：

```
<test xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="
    http://example.com/elements-and-items
    uniqueness.xsd"
 xmlns="http://example.com/elements-and-items">

  <item number="1">
    <element number="101"/>
    <element number="102"/>
    <element number="103"/>
  </item>
  <item number="1">
    <!--* duplicate item number, invalid
        * (violates constraint 3) 
        *-->
    <element number="104"/>
    <element number="105"/>
    <element number="106"/>
  </item>
  <item number="2">
    <element number="107">
      element number unique but doesn't match item number 
      (violates constraint 5)
    </element>
    <element number="202"/>
    <element number="202">
      item number not unique
      (violates constraint 4)
    </element>
  </item>
  <item number="3">
    <element number="303"/>
    <element number="301"/>
    <element number="3141592">
      item number unique and matches item number
      but more than two digits longer 
      (violates constraint 6)</element>
  </item>

</test> 
```

# ajax - jQuery Mobile 避免在 ajax 表单中提交 changePage()

> ID：15114422
> 
> 赞同：3
> 
> 时间：2013-02-27T14:22:08.830
> 
> 标签：ajax, forms, jquery-mobile

我有一个`post`表单，我希望`submit`以*AJAX*方式完成，但我不想更改页面 URL。

例如：

```
<form action="/countries/change_country" data-ajax="true" method="post">
  <select name="country_code">
    <option value="FR" selected="selected">France</option>
    <option value="DE">Germany</option>
  </select>
  <input type="submit" value="change country" />
</form> 
```

当我单击`change country`按钮时，表单是通过 AJAX 发送的，但页面 URL 更改为`/countries/change_country`不好的，因为我的服务器中不存在此 URL，这对 HTTP 动词非常*挑剔*。

我知道可以为整个应用程序更改此默认行为，但我想停用`changePage()`此表单的唯一行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T12:03:14.537

改为通过**Javascript/jQuery**提交表单。

*第一*：**禁用**默认提交行为

```
$('#form').on('submit', function (e) {
   if (e.preventDefault) e.preventDefault();
   return false;
}); 
```

*二*：用jQuery**序列化表单数据**

```
var serializedFormData = $('#form').serialize(); 
```

*第三*：**发布**您的表格`$.ajax();`

```
$.ajax({
   url: '/countries/change_country',
   type: 'POST',
   data: serializedFormData
}); 
```

# paypal - 使用直接付款的贝宝链式付款

> ID：15114423
> 
> 赞同：0
> 
> 时间：2013-02-27T14:22:11.437
> 
> 标签：paypal, payment-gateway, paypal-adaptive-payments

我需要在网站上实现贝宝自适应链式支付。付款流程最初应该是付款应该转到一个贝宝账户，然后从这个贝宝账户将该账户拆分为另外两个贝宝账户。我分析了通过使用贝宝链式支付，贝宝中有一个选项。但我需要在 DoDirect 支付中实现与信用卡支付相同的链式支付。我的问题是 paypal 中是否有任何选项可以在 DoDirect 付款中进行链式付款？或者有什么方法可以在 DoDirect 支付中实现相同的链式工作流程（链式支付）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:03:46.457

没有办法通过使用 DoDirectPayment API 进行链式支付。如果您想使用 DoDirectPayment API，您需要进行多次 API 调用。因此，如果您想收集 10.00，然后有 2 个接收器，每个接收器得到 5.00。您必须为每个 5.00 进行两次单独的 API 调用。然后，买家会看到他们的卡上两次收取了 5.00，并且您还必须对每个接收方帐户拥有权限，才能在他们的帐户上处理 DoDirectPayments。他们还必须在他们的帐户上设置服务。

您将无法将 DoDirectPayment API 与 Adaptive Payments 一起使用，但您仍然应该能够做您想做的事情。您只需使用自适应支付链式支付，买家将通过流程并使用客人结账。客人结账允许买家使用信用卡，而无需登录 PayPal 帐户。

此外，如果一些商家想要使用 DoDirectPayment API，他们会使用什么方式将所有资金存入他们的账户。然后到月底，他们将使用 MassPay API 向所有其他账户付款。您甚至可以使用 Adaptive Payments Pay API 来发送资金，而不是使用 MassPay API。

# .net - ReactiveUi：绑定到 ReactiveAsyncCommand 的按钮在一次使用后被禁用

> ID：15114427
> 
> 赞同：2
> 
> 时间：2013-02-27T14:22:19.310
> 
> 标签：.net, wpf, reactiveui

代码非常简单。首先启用按钮。单击它会被禁用并保持这种状态。

```
 Command = new ReactiveAsyncCommand();
        Command
            .RegisterAsyncObservable(_ => AsyncMethod())
            .SubscribeOn(RxApp.DeferredScheduler)
            .Subscribe(value =>
                           {
                               UseValue(value);                                   
                           }); 
```

如果 can execute 参数为 null，CanExecute 不应该始终为真吗？（我猜 CanExecute 是假的，导致按钮被禁用）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:21:15.600

如果您`AsyncMethod`永远不会返回或写错，这将会发生。你可以粘贴它的代码吗？

另外，你不需要`.SubscribeOn(RxApp.DeferredScheduler)`，它已经内置了。

# java - 使用 WHERE 子句选择的数据加载 JCombobox

> ID：15114430
> 
> 赞同：0
> 
> 时间：2013-02-27T14:22:31.017
> 
> 标签：java, sql, arrays, swing, jdbc

我试图通过比较表中的数据和来自 myframe 的数据来加载到组合框，但是每次我的代码运行时我都会收到以下错误消息：- java.lang.NullPointerException，我也尝试使用向量。请帮助：这是我的数据库类中的代码

```
 public ArrayList allocateStaffcombobox(Allocation aloc) throws SQLException
{
    ArrayList<Allocation> vec = new ArrayList<Allocation>();
    String sql = "select * from staffsubalocation where SubCode='"+aloc.getSubjCode()+"'";

    ResultSet result = stmt.executeQuery(sql);

    while (result.next())
    {

        String staffNo = result.getString("StaffNo");

        String subcode=result.getString("SubCode");
        System.out.println(staffNo+" "+ subcode);
        vec.add(new Allocation(staffNo,subcode));
    }

    return vec;

} 
```

这是我的java类的代码：

```
 public  void loadStaffCombo()
    {
        try
        {
            DatabaseManager db = new DatabaseManager();
            ArrayList<Allocation> sub=db.allocateStaffcombobox(null);
            Staffcombobox.removeAllItems();
           // String firsIndex = " ";
            for(int x = 0; x< sub.size(); x++)
            {
                Staffcombobox.addItem( sub.get(x).getStaffNo());
            }

        }
        catch (SQLException ex)
        {
            Logger.getLogger(ViewSubjectsJInternalFrame.class.getName()).log(Level.SEVERE, null, ex);
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:33:52.717

您将 null 作为输入传递给：

```
ArrayList<Allocation> sub=db.allocateStaffcombobox(null); 
```

并且您尝试在以下位置取消引用该 null：

```
String sql = "select * from staffsubalocation where SubCode='"+aloc.getSubjCode()+"'"; 
```

每当您尝试在空对象上调用方法时，您都会收到 NullPointerException

# javascript - 如何使用 jquery 从选择框中删除几个选项？

> ID：15114435
> 
> 赞同：1
> 
> 时间：2013-02-27T14:23:02.620
> 
> 标签：javascript, jquery, html

我想使用 jquery 从 5 个选项中的选择框中删除几个选项，例如最后三个选项

下面是带有 5 个选项标签的选择框

```
<select id="select">
  <option>first</option>
  <option>second</option>
  <option>third</option>
  <option>fourth</option>
  <option>fifth</option>
</select> 
```

**更新：**

我试过这段代码

```
$("#select option:not(option:first, option:last)"; 
```

但这给了我在控制台中未捕获的异常

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T14:24:28.427

[`slice()`](http://api.jquery.com/slice/)方法是要走的路：

```
$("#select > option").slice(-3).remove(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:25:23.193

你试过什么？我认为[nth-child 选择器](http://www.w3schools.com/jquery/sel_nthchild.asp)可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:27:26.707

您可以使用以下代码删除最新项目 [http://jsfiddle.net/QxmvC/](http://jsfiddle.net/QxmvC/)

```
 $('#select').children().slice(-3).remove(); 
```

# c++ - 当主线程无限循环运行时，服务器没有收到用 QTcpSocket::write 写入的字节？

> ID：15114443
> 
> 赞同：0
> 
> 时间：2013-02-27T14:23:25.730
> 
> 标签：c++, c, linux, windows, qt

我正在开发一个与服务器交互的应用程序。

启动时，它正在从数据库加载一些数据，当数据库大小很大时，应用程序在很长的循环中运行，假设我在 db 中有 10 条 lac 记录，循环将迭代 10 次 lac 次。

经过一段固定的时间间隔（由用户设置）让我们说 1 秒，我的应用程序正在向不同线程中的服务器发送心跳消息。

在正常情况下，它工作正常，但是当应用程序在长循环中运行时，服务器没有收到心跳消息，尽管返回的写入字节`QTcpSocket::write()`与我正在写入的字节相同（成功），但`tcpDump`没有显示接收到任何字节。

我用过

```
tcpSocket->setSocketOption(QAbstractSocket::LowDelayOption , 1); 
tcpSocket->setSocketOption(QAbstractSocket::KeepAliveOption , 600); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:30:22.743

尝试[`processEvents()`](http://qt-project.org/doc/qt-4.8/qcoreapplication.html#processEvents)在循环中添加（假设每 1000 个周期或每 100 毫秒）以保持应用程序响应。当然，如果你遇到这样的问题，这是一个糟糕的设计的标志。考虑重新设计您的应用程序以使用多个线程，即主线程和一个用于长操作的工作线程（您的循环）。更多关于 Qt 线程支持的信息可以在[这里](http://qt-project.org/doc/qt-4.8/threads.html)找到。

# javascript - Object.observe() 如何影响性能？

> ID：15114448
> 
> 赞同：13
> 
> 时间：2013-02-27T14:23:56.287
> 
> 标签：javascript, performance, javascript-engine, object.observe

Object.observe [()](http://updates.html5rocks.com/2012/11/Respond-to-change-with-Object-observe) JavaScript API 允许任何一段代码接收任何 JavaScript 对象的所有属性更改的更改通知。

**这不会严重影响 JavaScript 引擎（即 V8）可以执行的代码生成和性能优化吗？**如果必须生成更改通知，生成的本机代码现在似乎必须检查对对象的每一次写入。无法静态确定给定对象是否设置了通知。因此无法优化检查。

似乎任何符合标准的 JavaScript 引擎现在都因为这个 API 而陷入永久性和严重的性能损失。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-27T16:51:50.210

现代 JavaScript 引擎利用内联缓存和自适应重新编译技术来最小化动态调度对生成代码的影响。

如果我们谈论 V8，那么是否观察到对象的事实编码在其隐藏类中。内联缓存存根和优化代码都已经根据某个预期值检查隐藏类以确定对象是否具有预期形状。同样的检查提供了关于是否观察到对象的信息。因此，与非观察对象一起工作的代码路径没有任何变化。开始观察对象的处理方式与更改其形状的方式相同：对象的隐藏类被切换到不同的类，并设置了观察位：您可以阅读[`Runtime_SetIsObserved`](https://code.google.com/p/v8/source/browse/trunk/src/runtime.cc?r=13744#13211)以查看此内容。

类似的推理适用于系统中在优化代码中省略守卫的部分，而是根据“形状”假设取消优化代码：一旦观察到对象，所有基于未观察到该对象的假设的优化代码都将被取消优化。因此，对于未观察到的物体，再一次没有任何代价。

也就是说，`Object.observe`V8 中的当前实现使观察到的对象付出了高昂的代价，因为它将它们标准化（将它们转换为字典表示）并且需要通过运行时系统来回往返以进行观察记录。但是以后要显着降低这个成本并没有固有的技术困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T15:11:28.533

> 这不会严重影响 JavaScript 引擎（即 V8）可以执行的代码生成和性能优化吗？

是的。就像 Proxies、Getters/Setters 甚至原型对象一样——它们在 JavaScript 中都是动态的。

然而，由于它们的异步性，新的（和更好的）优化是可能的；他们可以使其他效率更低的代码过时。引用[和谐草案中的](http://wiki.ecmascript.org/doku.php?id=harmony%3aobserve#goals)[*目标*](http://wiki.ecmascript.org/doku.php?id=harmony%3aobserve#goals)：

> *   **无需包装器或代理**对象，提供内存效率和对象标识
> *   在对象上添加/删除属性时更改通知
> *   更改对象属性的属性描述符修改通知
> *   对象手动指示访问器属性何时更改的能力
> *   **可在引擎中**有效实施****
> ***   **对当前 ES 的简单**、有针对性的扩展*   **异步**通知更改，但允许同步获取更改等待交付**

# jquery - 带有或不带有扩展关键字的jquery

> ID：15114449
> 
> 赞同：2
> 
> 时间：2013-02-27T14:23:55.940
> 
> 标签：jquery

谁能告诉我这两种扩展功能有什么区别？谢谢。

```
$.fn.alertWhileClick= function() {
   alert($(this).val());
}

$.fn.extend({
    alertWhileClick:function(){
      alert($(this).val());
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:43:01.073

这两种形式是等价的。第一个通过赋值向 jQuery 的原型添加一个方法，第二个通过调用 来实现，这与[$.extend()](http://api.jquery.com/jQuery.extend/)`$.fn.extend()`方法相同。

该文档实际上在这里有点误导，因为它说：

> 如果仅向 提供一个参数`$.extend()`，则意味着省略了目标参数。在这种情况下，jQuery 对象本身被假定为目标。

但实际发生的情况更像是：

> 如果仅向 提供一个参数`$.extend()`，则意味着省略了目标参数。在这种情况下，应用**对象`$.extend()`（即`this`方法内绑定的对象）**被假定为目标。

因此，`$.extend()`使用单个参数`$`调用 extends ，并`$.fn.extend()`使用单个参数调用 extends `$.fn`。

源代码的相关部分说：

```
jQuery.extend = jQuery.fn.extend = function() {

    // [...]

    // extend jQuery itself if only one argument is passed
    if ( length === i ) {
        target = this;  // Note: 'this', not 'jQuery'.
        --i;
    }

    // [...]
}; 
```

# java - 错误的“网页不可用”错误

> ID：15114450
> 
> 赞同：2
> 
> 时间：2013-02-27T14:23:59.520
> 
> 标签：java, android, webview, titanium, titanium-mobile

我已经看到这个很长一段时间了。我在 ICS 4.0.4 平板电脑上。大多数情况下，当我打开页面时`Webview`，页面显示正确。但有时，同一页面不显示，我很傻`Webpage not available`。

笔记：

*   该网址有一个额外的`#`
*   我加载的页面是本地的
*   这通常发生在我单击一个`href`触发`onclick`带有 webview 的窗口打开的窗口时。我只是`url`在 webview 创建时设置值。

![在此处输入图像描述](../Images/177f150cf147813b7ff7f8811d7e8587.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:37:46.657

在你的 manifest.xml`<uses-permission android:name="android.permission.INTERNET" />`

# php - PHP - 从括号内获取参数

> ID：15114451
> 
> 赞同：0
> 
> 时间：2013-02-27T14:24:00.157
> 
> 标签：php, arguments, brackets

我试图在一些括号内设置信息......

例子：

```
[Article title="Article 1" show="Article Name Goes Here"]
<p>Some other simple text here...</p>
[Article title="Article 2" show="Article Name Goes Here"] 
```

我试图将“参数”设置为变量，以便我可以从数据库中获取第 1 条信息并将其替换为 FullContent。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:39:46.827

使用爆炸或子串。substr 可能更快且更不容易出错。

```
$string = '[Article title="Article 1" show="Article Name Goes Here"]';
$arg1 = substr($string, strrpos($string, "title=")+len("title="), strrpos($string, "show="));
$arg2 = substr($string, strrpos($string, "show=")+len("title="), strrpos($string, -1)); 
```

您可能不得不使用一些 strrpos 值，因为我没有考虑到 qoutemarks。

# json - 用于分析的 Google API 授权无效，但有时有效

> ID：15114452
> 
> 赞同：0
> 
> 时间：2013-02-27T14:24:01.877
> 
> 标签：json, google-analytics

我已经解决这个问题 2 天了，并尝试在谷歌代码和 stackoverflow 下查看，但仍然可以找到答案。

我的问题是当我尝试我的谷歌分析 api 时，我得到“刷新 OAuth2 令牌时出错，消息：'{“error”：“invalid_grant”}'”

但奇怪的是，有时它会起作用。很少，但如果我刷新并继续尝试，它会输出。

我唯一能找到的就是可能[超出了刷新令牌限制](https://developers.google.com/analytics/devguides/reporting/core/v3/gdataAuthorization#helpme)

如果有人可以帮助我或指出正确的方向，请附上我的代码。

谢谢！

```
<?php
session_start();
require_once 'Google_Client.php';
require_once 'Google_AnalyticsService.php';
require_once 'config.php';

$keyFile = 'key.p12';

$client = new Google_Client();
$client->setApplicationName("test");
if (isset($_SESSION['token'])) {
   $client->setAccessToken($_SESSION['token']);
   }
 $client->setAssertionCredentials(new Google_AssertionCredentials(
GOOGLE_SERVICE_ACCOUNT,
array('https://www.googleapis.com/auth/analytics.readonly'),
file_get_contents($keyFile))
 );
 $client->setClientId(GOOGLE_CLIENT_ID);
 $client->setAccessType('offline');
 $client->setUseObjects(true);
 $service = new Google_AnalyticsService($client);
 try {
     $results = $service->data_ga->get(
    'ga:44444444',
    date('Y-m-d', strtotime('-30 days '.date('Y-m-d', strtotime('-1 day '.date('Y-m-    d'))))),
    date('Y-m-d', strtotime('-1 day '.date('Y-m-d'))),
    'ga:visits,ga:newVisits',
    /*array(
        'dimensions' => 'ga:source,ga:keyword',
        'sort' => '-ga:visits,ga:keyword',
        'filters' => 'ga:medium==organic',
        'max-results' => '25'
    )*/
    array('dimensions' => 'ga:date')
  );
 } catch (Google_ServiceException $e) {
 // echo $e->getMessage();
  }
 if ($client->getAccessToken()) {
    $_SESSION['token'] = $client->getAccessToken();
   }

   $dateParsePattern = '/"Date.parse\(\\\"((\d{4})-(\d{2})-(\d{2})) UTC\\\"\)"/';
  $dateParseReplacement = 'Date.parse("$1 UTC")';
  $allVisitsItems = array();
  $newVisitorsItems = array();
 if ($results && count($results->getRows()) > 0) {
    foreach ($results->getRows() as $row) {
    $date = 'Date.parse("'.date("Y-m-d", strtotime($row[0])).' UTC")';
    $allVisitsItems[] = array($date, intval(htmlspecialchars($row[1], ENT_NOQUOTES)));
    $newVisitorsItems[] = array($date, intval(htmlspecialchars($row[2], ENT_NOQUOTES)));
}
}
  header('Content-Type: application/json');
 ?>

<?php echo preg_replace($dateParsePattern, $dateParseReplacement, json_encode($allVisitsItems)) ?> 
```

编辑 - 这不是 NTP，当我回应 date('l jS \of FY h:i:s A'); 它匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:00:23.607

以下工作可生成输出 - 确保您运行的是 PHP 5.3 或更高版本。

```
<?php
require_once './src/Google_Client.php';
require_once './src/contrib/Google_AnalyticsService.php';

 $path_to_keyfile = '.p12';
 $service_account_email = '7@developer.gserviceaccount.com';
 $client_id = '7.apps.googleusercontent.com';
 $analytics_profile_id = 'ga:IN URL OF ANALYTICS';

 $client = new Google_Client();
 $client->setApplicationName("API TEST");
 $client->setAssertionCredentials(
new Google_AssertionCredentials(
    $service_account_email,
    array('https://www.googleapis.com/auth/analytics.readonly'),
    file_get_contents($path_to_keyfile)
)
);
$client->setClientId($client_id);
$client->setAccessType('offline_access');

$service = new Google_AnalyticsService($client);

 $from = date('Y-m-d', strtotime('-30 days '.date('Y-m-d', strtotime('-1 day '.date('Y-m-d'))))); // 30 days
 $to = date('Y-m-d', strtotime('-1 day '.date('Y-m-d'))); // yesterday

  $dateParsePattern = '/"Date.parse\(\\\"((\d{4})-(\d{2})-(\d{2})) UTC\\\"\)"/';
  $dateParseReplacement = 'Date.parse("$1 UTC")';
   $allVisitsItems = array();
  $newVisitorsItems = array();

try {
$data = $service->data_ga->get(
    //
    $analytics_profile_id,
    $from,
    $to,
    'ga:visits,ga:newVisits',
    array('dimensions' => 'ga:date')
);

if($data && $data['totalResults'] > 0) {
    foreach($data['rows'] as $row) {
        $date = 'Date.parse("'.date("Y-m-d", strtotime($row[0])).' UTC")';
        $allVisitsItems[] = array($date, intval(htmlspecialchars($row[1], ENT_NOQUOTES)));
        $newVisitorsItems[] = array($date, intval(htmlspecialchars($row[2], ENT_NOQUOTES)));
    }
}

header('Content-Type: application/json');
?>

<?php echo preg_replace($dateParsePattern, $dateParseReplacement, json_encode($allVisitsItems)) ?>

<?php echo preg_replace($dateParsePattern, $dateParseReplacement, json_encode($newVisitorsItems)) ?>

<?php
 } catch(Exception $e) {
echo 'There was an error : - ' . $e->getMessage();
 } 
```

# iphone - 在 iOS 中搜索文章的搜索栏

> ID：15114453
> 
> 赞同：0
> 
> 时间：2013-02-27T14:24:02.203
> 
> 标签：iphone, ios, search

你好，我是新的 iphone 开发者，我需要你的指导......</p>

我想制作一个应用程序，其中包含法律术语和对不同法律文章的解释……问题是我想要一个搜索栏，这样用户就可以在文章中搜索他想要的任何单词……如何做到这一点？？？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:05:51.603

我告诉你是因为你是新手，否则我会否决你的问题。

我有字典数组，我正在搜索这样的记录

```
-(void)searchBar:(UISearchBar*)searchBar textDidChange:(NSString*)text
{
        ProductFilteredArray = [[NSMutableArray alloc] init];

        for (NSMutableDictionary * cty in globleAry)
        {
            NSRange nameRange = [[cty objectForKey:@"Name"] rangeOfString:text options:NSCaseInsensitiveSearch];

            if(nameRange.location != NSNotFound)
            {
                [ProductFilteredArray addObject:cty];
            }
        }

    //copy this array in arrat of table
    tableArray = [ProductFilteredArray mutableCopy];
    [table reloadData];
} 
```

# javascript - 为什么在 JavaScript 的这个计算中 II 会变得未定义？

> ID：15114455
> 
> 赞同：0
> 
> 时间：2013-02-27T14:24:03.447
> 
> 标签：javascript

我尝试遍历整个数组并找出它们的“真实性”。现在，当我运行该函数时，我得到了一些**undefined-result**。：（ 为什么？

```
myArray = [
    {text: 'hola', done: false},
    {text: 'hola', done: true},
    {text: 'hola', done: true},
    {text: 'hola', done: false},
    {text: 'hola', done: true}
  ];

  var howMany = function(myArray){

     var result;
      for (var item in myArray){
          if(myArray.done === true)
            result++;
      }
      return result;
  };

var items =howMany(myArray);
    console.log(items) // I want to see if it's correct 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:27:29.047

a) 您没有初始化 的值`result`：

```
var result = 0; 
```

b）这不是您迭代数组项的方式：

```
for (var i = 0; i < myArray.length; i++) {
    var item = myArray[i];
    if (item.done === true) { // <-- "item" here, not "myArray"!
        result++;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T14:26:52.910

检查`result`变量是否已用 初始化`0`。迭代中还有另一个问题。您需要使用`myArray[item]`来获取对象属性的值：

```
if (myArray[item].done === true) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:26:42.117

尝试将变量初始化为实际值：`var result = 0;`

编辑：另外，根据 VisioN 的回答，您需要检查`myArray[item].done`

# postgresql - ActiveRecord 创建！使用 Postgresql 将布尔值保存为“t”，但在更新/保存后更新为 1/0

> ID：15114459
> 
> 赞同：1
> 
> 时间：2013-02-27T14:24:25.273
> 
> 标签：postgresql, activerecord, boolean

将 ActiveRecord 与 Postgresql 一起使用，创建！按预期生成新记录，布尔值 true 保存为“t”

```
SiteSetting.create!(:name => :enable_github, :value => true, :data_type => 5)

=> :value => 't' 
```

但是当我获取记录、更改并保存它时，如果我再次将其设置为 true，则该值会更改为 0 表示 false 或 1 表示 true。

```
setting = SiteSetting.where(:name => :enable_github).first
setting.value = false
setting.save

=> :value => 0 
```

接着

```
setting.value = true
setting.save

=> :value => 1 
```

为什么驱动程序将值更新为整数而不是't'或'f'，因为它应该为postgresql？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T04:58:19.463

您可能已在迁移中`value`指定`integer`。应改为`boolean`.

# sql - SQL Server 删除性能

> ID：15114462
> 
> 赞同：6
> 
> 时间：2013-02-27T14:24:34.323
> 
> 标签：sql, sql-server, performance, stored-procedures, sql-server-2008-r2

我在我们的.NET Web 应用程序中有一个例程，它允许我们平台上的用户清除他们的帐户（即删除他们的所有数据）。该例程在存储过程中运行，本质上是循环通过相关数据表并清除他们创建的所有各种项目。

存储过程看起来像这样。

```
ALTER procedure [dbo].[spDeleteAccountData](
    @accountNumber varchar(30) ) 
AS
BEGIN
    SET ANSI_NULLS ON ;
    SET NOCOUNT ON;

    BEGIN TRAN  
    BEGIN TRY
        DELETE FROM myDataTable1 WHERE accountNumber = @accountNumber
        DELETE FROM myDataTable2 WHERE accountNumber = @accountNumber
        DELETE FROM myDataTable3 WHERE accountNumber = @accountNumber
        //Etc.........

    END TRY
    BEGIN CATCH
        //CATCH ERROR
    END CATCH

IF @@TRANCOUNT > 0
    COMMIT TRANSACTION; 
SET ANSI_NULLS OFF;
SET NOCOUNT OFF;
END 
```

问题是，在某些情况下，我们可以在一个表上拥有超过 10,000 行，并且该过程可能需要 3-5 分钟。在此期间，数据库上的所有其他连接都会受到限制，从而导致超时错误，如下所示：

> *System.Data.SqlClient.SqlException (0x80131904)：超时已过期。在操作完成之前超时时间已过或服务器没有响应。*

我可以进行任何一般性更改来提高性能吗？我很欣赏与我们的数据库模式设计相关的许多未知数，但欢迎一般的最佳实践建议！我曾考虑将这个任务安排在凌晨运行以尽量减少影响，但这远非理想，因为在完成此任务之前用户将无法重新获得对其帐户的访问权限。

**附加信息：**

*   SQL Server 2008 R2 标准版
*   所有表都有聚集索引
*   没有触发器与任何相关表上的任何删除命令相关联
*   许多表上存在外键引用，但删除顺序说明了这一点。

***编辑：格林威治标准时间 16:52***

*删除过程影响大约 20 个表。最大的有大约 500 万条记录。其他的没有更多的 200,000 条记录，有些只包含 1000-2000 条记录。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:29:29.567

您`accountNumber`在所有表中都有索引吗？

看到您使用`WHERE`该列的子句删除，这可能会有所帮助。

另一种选择（可能甚至更好的解决方案）是在晚上安排删除操作，例如，当用户选择删除他的帐户时，您只是设置一个标志，而删除作业在晚上运行，实际上删除了那些标记为删除的帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:34:38.347

如果您在 accountNumber 字段上有索引，那么我猜删除的时间很长是由于锁（由其他进程生成）或受各个表影响的外键。

1.  如果是由于锁，那么你应该看看你是否可以使用 nolock 来减少它们，你实际上可以做到这一点。
2.  如果外键有问题..那么你必须等待..如果你不想等待并且你的应用程序逻辑不依赖于强制执行 FK（比如向应用程序发送 FK 违规错误，并针对它们）或者您觉得您的应用程序很完美，然后在短时间内不需要 FK，那么您可以在删除之前使用 ALTER TABLE xxx NOCHECK CONSTRAINT all 禁用相关的 FK，然后重新启用它。

当然，纯粹主义者会因为后者而责怪我，但是当需要时我已经使用了很多次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:26:55.637

SqlCommand.CommandTimeout 是简短的答案。增加它的价值。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)

请注意，连接超时与 CommandTimeout 不同。

...

你在每张桌子上都有关于“accountNumber”的索引吗？

您可以在表的代理键上有一个聚集键，但不是“accountNumber”。

...

基本上，您将不得不在这里查看执行计划（或发布执行计划）。

但这里有一些“入门代码”，用于尝试在该列上建立索引。

```
if exists (select * from dbo.sysindexes where name = N'IX_myDataTable1_accountNumber' and id = object_id(N'[dbo].[myDataTable1]'))
    DROP INDEX [dbo].[myDataTable1].[IX_myDataTable1_accountNumber]
GO

CREATE INDEX [IX_myDataTable1_accountNumber] ON [dbo].[myDataTable1]([accountNumber]) 
GO 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T15:01:18.827

将数据库切换到已提交读快照模式可能是值得的。这会对性能产生影响，多少取决于您的应用程序。

在 Read Committed Snapshot 模式下，写入者和读取者不再相互阻止，尽管写入者仍然阻止写入者。您没有说删除阻止了表上的哪种活动，所以很难说这是否有帮助？

[http://msdn.microsoft.com/en-us/library/ms188277(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms188277(v=sql.105).aspx)

话虽如此，删除约 10k 行的表需要 3-5 分钟似乎慢得离谱。你提到外键，外键是否被索引？如果不是，删除可能会导致另一端的表扫描以确保您没有破坏 RI，所以也许先检查一下？SQL Server Profiler 对这些删除查询的读/写说了什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-28T12:51:19.063

您可能想尝试的一种方法是：

1.  创建一个 SP。
2.  对于每个表，删除一些适合您的大小的小批量行（例如每批 10 行）。
3.  将每个批量删除放入事务中，并在每个事务之间添加自定义延迟。

例子：

```
 DECLARE @DeletedRowsCount INT = 1, @BatchSize INT = 300;
    WHILE (@DeletedRowsCount> 0) BEGIN
        BEGIN TRANSACTION  
            DELETE TOP (@BatchSize) dbo.Table
            FROM dbo.Table
            WHERE Id = @PortalId;
            SET @DeletedRowsCount = @@ROWCOUNT;
        COMMIT;

        WAITFOR DELAY '00:00:05';
    END 
```

我想你也可以在没有 SP 的情况下做同样的事情。事实上，这样可能会更好。

# c# - 在 maskedtextbox 中显示字母 A

> ID：15114466
> 
> 赞同：0
> 
> 时间：2013-02-27T14:24:39.257
> 
> 标签：c#, .net, visual-studio-2010, visual-studio, maskedtextbox

我只是在考虑如何在 VS .net 4 的 maskedtextbox 中显示一个字母。我可以设置所有字母，除了“A”，因为它被用作掩码中字母数字字母的虚拟对象。我想在值之后的掩码中显示统一的“安培”。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:33:15.323

使用反斜杠转义特殊字符。\A 会做你想做的事。
[http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.mask.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.mask.aspx)

# ruby-on-rails - ExecJS::RuntimeError （基本上）空的新项目

> ID：15114471
> 
> 赞同：2
> 
> 时间：2013-02-27T14:24:48.803
> 
> 标签：ruby-on-rails, ruby, web-applications

我刚刚创建了一个空应用程序，并且只生成了一个带有主页、帮助、关于和联系选项的 StaticPages 控制器，但是当我访问 localhost:3000/static_pages/home 时，出现错误：

```
ExecJS::RuntimeError in Static_pages#home

Showing [...]views/layouts/application.html.erb where line #6 raised:

  (in [...]/app/assets/javascripts/static_pages.js.coffee) Extracted source (around line #6):

3: <head> 
4:   <title>TodolistApp</title> 
5:   <%= stylesheet_link_tag "application", :media => "all" %> 
6:   <%= javascript_include_tag "application" %> 
7:   <%= csrf_meta_tags %> 8: </head> 9: <body> Rails.root: [..]

Application Trace | Framework Trace | Full Trace app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb__694989846_43803828' 
```

我看过一些关于这个问题的 stackoverflow 文章，还有一些建议安装 Node.js，我已经这样做了，但它没有做任何事情。为了清楚起见，我没有向任何静态页面视图添加任何代码，也没有在任何地方添加任何 javascript。

此外，有趣的是，如果我取出第 4 行（ <%= javascript_include_tag "application" %>），则没有错误。但我假设如果我把它拿出来，我就不能添加javascript。

我会很感激任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:42:24.297

尝试在您的 Gemfile 中使用“gem 'therubyracer'”，并安装“therubyracer_for_windows” 我做了以下（windows 8 64x）： 1\. 从[https://github.com/hiranpeiris/therubyracer_for_windows](https://github.com/hiranpeiris/therubyracer_for_windows)下载 gem + dll 2\. 安装这个gem (gem instal ...) 并将 dll 文件移动到“ruby\bin” 3\. 重新启动服务器（rails s，可选） 4\. 然后在我的 Gemfile 中使用“gem 'therubyracer'”“捆绑安装”运行良好

示例：“使用 sqlite3 (1.3.7) 使用 therubyracer (0.11.0beta1) 使用 uglifier (1.3.0) 使用 webrat (0.7.1) 您的捆绑包已完成！`bundle show [gemname]`用于查看捆绑的 gem 的安装位置。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T06:21:56.040

将此添加到您的 gemfile

```
gem 'therubyracer', :platform => :ruby
gem 'execjs' 
```

试试这个，它可能对你有用。我得到了一些类似的错误，我用这个解决了。

# c# - C# - 自定义图像名称转换为字符串

> ID：15114475
> 
> 赞同：0
> 
> 时间：2013-02-27T14:24:57.143
> 
> 标签：c#, string, stringbuilder

我有一种方法可以将选定的图像从一个复制`OpenFileDialog`到一个定义的位置，我想检查是否存在同名的图像，如果存在则动态更改名称。

这是我的方法：

```
 public void SaveImage(IList<AppConfig> AppConfigs, string ImageNameFilter)
        {
            string imgPath = AppConfigs[0].ConfigValue.ToString();
            Int32 i = 0;
            StringBuilder sb = new StringBuilder(selectedFileName);

            while (File.Exists(imgPath + "\\" + ImageNameFilter + selectedFileName))
            {
                sb.Insert(i, 0);
                i++;
                //ImageNameFilter += (i++).ToString();
            }
            File.Copy(selectedFile, imgPath + "\\" + ImageNameFilter + selectedFileName);
        } 
```

`ImageNameFilter`是添加在每个图像开头的自定义过滤器，用户需要此前缀才能识别图像的用途，仅通过查看前缀即可。`selectedFileName`是用 拍摄的图像的名称`SafeFileName`，这意味着它看起来像这样 - `imageName.jpeg`。

这段代码有几个问题。首先，我想像这样更改名称 - `imageName1.jpeg, imageName2.jpeg, imageName3.jpeg...imageName14.jpeg..`，但如果我使用`selectedFileName`的`+=`所有内容都添加了，即使在 之后`.jpeg`，这也不是我想要的。我能想到的唯一解决方案是使用`regex`，但我真的想找到另一种方法。

此外，递增`i++`和添加它`+=`会导致不需要的结果，即 : `imageName1.jpeg, imageName12.jpeg, imageName123.jpeg...imageName1234567.jpeg`。

那么，我怎样才能得到我想要的结果，我在这里看到的折衷方案是`_`在 the`ImageNameFilter`之后添加下划线，然后`i`在`selectedFileName`默认情况下在而不是末尾添加下划线。但是在字符串的开头添加一些东西也是我不知道该怎么做的事情。如您所见，我尝试了`StringBuiledr`+ `Insert`，但没有得到预期的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:35:07.780

基本上，您需要[`Path`](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)在开始循环之前将基本文件名与扩展名分开（使用有用的方法来执行此操作），然后继续生成文件名。每个候选者都*不会*根据最后一个生成（它只是基于固定信息和当前迭代次数），因此您根本不需要涉及 a `StringBuilder`。

这是分两步完成的一种巧妙方法。首先，设置簿记：

```
var canonicalFileName = ImageNameFilter + selectedFileName;
var baseFileName = Path.GetFileNameWithoutExtension(canonicalFileName);
var extension = Path.GetExtension(canonicalFileName); 
```

然后执行循环——这里我使用 LINQ 而不是循环语句，因为我可以，但与普通`while`循环没有本质区别：

```
var targetFileName = Enumerable.Range(1, int.MaxValue - 1)
    .Select(i => Path.Combine(imgPath, baseFileName + i + extension))
    .First(file => !File.Exists(file));

File.Copy(selectedFile, targetFileName); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:34:30.657

使用`Path.GetFileNameWithoutExtension`或`String.TrimEnd('.')`获取不带扩展名的文件名。您也可以使用`FileInfo`来获取扩展名。

# java - 在 Elasticsearch 的一个查询中返回所有记录

> ID：15114481
> 
> 赞同：13
> 
> 时间：2013-02-27T14:25:23.073
> 
> 标签：java, api, elasticsearch, search

我在弹性搜索中有一个数据库，并希望在我的网站页面上获取所有记录。我写了一个bean，它连接到弹性搜索节点，搜索记录并返回一些响应。我进行搜索的简单 java 代码是

```
SearchResponse response = getClient().prepareSearch(indexName)
    .setTypes(typeName)              
    .setQuery(queryString("\*:*"))
    .setExplain(true)
    .execute().actionGet(); 
```

但是 Elasticsearch 将默认大小设置为 10，我有 10 次点击作为响应。我的数据库中有 10 多条记录。如果我将大小设置为`Integer.MAX_VALUE`我的搜索会变得非常慢，这不是我想要的。

如何在不设置响应大小的情况下在可接受的时间内通过一个操作获取所有记录？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-04-21T10:07:00.253

```
public List<Map<String, Object>> getAllDocs(){
        int scrollSize = 1000;
        List<Map<String,Object>> esData = new ArrayList<Map<String,Object>>();
        SearchResponse response = null;
        int i = 0;
        while( response == null || response.getHits().hits().length != 0){
            response = client.prepareSearch(indexName)
                    .setTypes(typeName)
                       .setQuery(QueryBuilders.matchAllQuery())
                       .setSize(scrollSize)
                       .setFrom(i * scrollSize)
                    .execute()
                    .actionGet();
            for(SearchHit hit : response.getHits()){
                esData.add(hit.getSource());
            }
            i++;
        }
        return esData;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-03-01T17:31:39.427

当前排名最高的答案有效，但它需要将整个结果列表加载到内存中，这可能会导致大型结果集出现内存问题，并且在任何情况下都是不必要的。

我创建了一个 Java 类，它实现了一个 nice `Iterator`over `SearchHit`s，它允许遍历所有结果。在内部，它通过发出包含该`from:`字段的查询来处理分页，并且它只在内存中保存**一页 results**。

**用法：**

```
// build your query here -- no need for setFrom(int)
SearchRequestBuilder requestBuilder = client.prepareSearch(indexName)
                                            .setTypes(typeName)
                                            .setQuery(QueryBuilders.matchAllQuery()) 

SearchHitIterator hitIterator = new SearchHitIterator(requestBuilder);
while (hitIterator.hasNext()) {
    SearchHit hit = hitIterator.next();

    // process your hit
} 
```

请注意，在创建您的 时`SearchRequestBuilder`，您不需要调用`setFrom(int)`，因为这将由`SearchHitIterator`. 如果要指定页面的大小（即每页的搜索命中数），可以调用`setSize(int)`，否则使用 E​​lasticSearch 的默认值。

**SearchHitIterator：**

```
import java.util.Iterator;
import org.elasticsearch.action.search.SearchRequestBuilder;
import org.elasticsearch.action.search.SearchResponse;
import org.elasticsearch.search.SearchHit;

public class SearchHitIterator implements Iterator<SearchHit> {

    private final SearchRequestBuilder initialRequest;

    private int searchHitCounter;
    private SearchHit[] currentPageResults;
    private int currentResultIndex;

    public SearchHitIterator(SearchRequestBuilder initialRequest) {
        this.initialRequest = initialRequest;
        this.searchHitCounter = 0;
        this.currentResultIndex = -1;
    }

    @Override
    public boolean hasNext() {
        if (currentPageResults == null || currentResultIndex + 1 >= currentPageResults.length) {
            SearchRequestBuilder paginatedRequestBuilder = initialRequest.setFrom(searchHitCounter);
            SearchResponse response = paginatedRequestBuilder.execute().actionGet();
            currentPageResults = response.getHits().getHits();

            if (currentPageResults.length < 1) return false;

            currentResultIndex = -1;
        }

        return true;
    }

    @Override
    public SearchHit next() {
        if (!hasNext()) return null;

        currentResultIndex++;
        searchHitCounter++;
        return currentPageResults[currentResultIndex];
    }

} 
```

事实上，意识到拥有这样一个类是多么方便，我想知道为什么 ElasticSearch 的 Java 客户端不提供类似的东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-15T17:22:04.570

您可以使用滚动 API。使用 searchhit 迭代器的另一个建议也很有效，但前提是您不想更新这些命中。

```
import static org.elasticsearch.index.query.QueryBuilders.*;

QueryBuilder qb = termQuery("multi", "test");

SearchResponse scrollResp = client.prepareSearch(test)
        .addSort(FieldSortBuilder.DOC_FIELD_NAME, SortOrder.ASC)
        .setScroll(new TimeValue(60000))
        .setQuery(qb)
        .setSize(100).execute().actionGet(); //max of 100 hits will be returned for each scroll
//Scroll until no hits are returned
do {
    for (SearchHit hit : scrollResp.getHits().getHits()) {
        //Handle the hit...
    }

    scrollResp = client.prepareSearchScroll(scrollResp.getScrollId()).setScroll(new TimeValue(60000)).execute().actionGet();
} while(scrollResp.getHits().getHits().length != 0); // Zero hits mark the end of the scroll and the while loop. 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-05-30T21:51:05.717

您已经很久没有提出这个问题了，我想将我的答案发布给未来的读者。

正如上面提到的答案，最好加载具有大小的文档并在索引中有数千个文档时开始。在我的项目中，搜索加载 50 个结果作为默认大小并从零索引开始，如果用户想要加载更多数据，则将加载接下来的 50 个结果。这是我在代码中所做的：

```
public List<CourseDto> searchAllCourses(int startDocument) {

    final int searchSize = 50;
    final SearchRequest searchRequest = new SearchRequest("course_index");
    final SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();
    searchSourceBuilder.query(QueryBuilders.matchAllQuery());

    if (startDocument != 0) {
        startDocument += searchSize;
    }

    searchSourceBuilder.from(startDocument);
    searchSourceBuilder.size(searchSize);

    // sort the document
    searchSourceBuilder.sort(new FieldSortBuilder("publishedDate").order(SortOrder.ASC));
    searchRequest.source(searchSourceBuilder);

    List<CourseDto> courseList = new ArrayList<>();

    try {
        final SearchResponse searchResponse = client.search(searchRequest, RequestOptions.DEFAULT);
        final SearchHits hits = searchResponse.getHits();

        // Do you want to know how many documents (results) are returned? here is you get:
        TotalHits totalHits = hits.getTotalHits();
        long numHits = totalHits.value;

        final SearchHit[] searchHits = hits.getHits();

        final ObjectMapper mapper = new ObjectMapper();

        for (SearchHit hit : searchHits) {
            // convert json object to CourseDto
            courseList.add(mapper.readValue(hit.getSourceAsString(), CourseDto.class));
        }
    } catch (IOException e) {
        logger.error("Cannot search by all mach. " + e);
    }
    return courseList;
} 
```

信息： - Elasticsearch 版本 7.5.0 - Java 高级 REST 客户端用作客户端。

我希望，这对某人有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-07T07:13:03.887

要查询全部，您应该构建一个 CountRequestBuilder 以获取记录总数（通过 CountResponse），然后将数字设置回您的搜索请求的大小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-06T15:55:54.970

您将不得不权衡返回结果的数量与您希望用户等待的时间以及可用的服务器内存量。如果您已为 1,000,000 个文档编制索引，则没有一种现实的方法可以在一个请求中检索所有这些结果。我假设您的结果是针对一位用户的。您必须考虑系统在负载下的性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-07T16:51:43.780

如果您的主要关注点是导出所有记录，您可能希望寻求不需要任何排序的解决方案，因为排序是一项昂贵的操作。您可以将扫描和滚动方法与 ElasticsearchCRUD 一起使用，如此处[所述](http://damienbod.com/2014/11/13/csv-export-using-elasticsearch-and-web-api/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-24T11:33:53.143

```
SearchResponse response = restHighLevelClient.search(new SearchRequest("Index_Name"), RequestOptions.DEFAULT);
SearchHit[] hits = response.getHits().getHits(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-26T10:13:42.870

对于版本 6.3.2，以下工作：

```
public List<Map<String, Object>> getAllDocs(String indexName, String searchType) throws FileNotFoundException, UnsupportedEncodingException{

    int scrollSize = 1000;
    List<Map<String,Object>> esData = new ArrayList<>();
    SearchResponse response = null;
    int i=0;

    response = client.prepareSearch(indexName)
        .setScroll(new TimeValue(60000))
        .setTypes(searchType)  // The document types to execute the search against. Defaults to be executed against all types.
        .setQuery(QueryBuilders.matchAllQuery())
        .setSize(scrollSize).get(); //max of 100 hits will be returned for each scroll
    //Scroll until no hits are returned
    do {
        for (SearchHit hit : response.getHits().getHits()) {
            ++i;
            System.out.println (i + " " + hit.getId());
            writer.println(i + " " + hit.getId());
        }
        System.out.println(i);

        response = client.prepareSearchScroll(response.getScrollId()).setScroll(new TimeValue(60000)).execute().actionGet();
    } while(response.getHits().getHits().length != 0); // Zero hits mark the end of the scroll and the while loop.
    return esData;
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2016-01-06T17:12:35.707

1.设置最大尺寸，例如：MAX_INT_VALUE；

私有静态最终 int MAXSIZE=1000000;

@Override public List getAllSaleCityByCity(int cityId) 抛出异常 {

```
 List<EsSaleCity> list=new ArrayList<EsSaleCity>();

    Client client=EsFactory.getClient();
    SearchResponse response= client.prepareSearch(getIndex(EsSaleCity.class)).setTypes(getType(EsSaleCity.class)).setSize(MAXSIZE)
            .setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(), FilterBuilders.boolFilter()
                    .must(FilterBuilders.termFilter("cityId", cityId)))).execute().actionGet();

    SearchHits searchHits=response.getHits();

    SearchHit[] hits=searchHits.getHits();
    for(SearchHit hit:hits){
        Map<String, Object> resultMap=hit.getSource();
        EsSaleCity saleCity=setEntity(resultMap, EsSaleCity.class);
        list.add(saleCity);
    }

    return list;

} 
```

2.在搜索之前先计算ES

```
CountResponse countResponse = client.prepareCount(getIndex(EsSaleCity.class)).setTypes(getType(EsSaleCity.class)).setQuery(queryBuilder).execute().actionGet(); 
```

int size = (int)countResponse.getCount();//这是你想要的大小；

那么你也能

```
SearchResponse response= client.prepareSearch(getIndex(EsSaleCity.class)).setTypes(getType(EsSaleCity.class)).setSize(size); 
```

# regex - Bash：正则表达式

> ID：15114483
> 
> 赞同：2
> 
> 时间：2013-02-27T14:25:24.403
> 
> 标签：regex, bash

请看一下这个简单的 bash 脚本：

```
#!/bin/bash
if [[ $1 =~ a* ]]; then
 echo "match"
fi 
```

无论第一个参数提供了什么，似乎总是打印“匹配”。（在 bash 3.2 和 4.x 上测试）

**问题：**
我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:30:52.683

正则表达式的`a*`意思是“匹配零次或多次出现的字母 a”。因此，如果您输入`foo`，则匹配零`a`，因此表达式为真。如果您输入`bar`，`a`则匹配一个，因此它也是正确的。您输入的任何输入都将匹配。

`a+`如果要匹配出现的一个或多个字母，请尝试更改为`a`。

```
$ [[ foo =~ a+ ]] && echo match || echo "no match"
no match

$ [[ bar =~ a+ ]] && echo match || echo "no match"
match 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:33:48.977

只是猜测：'a*' 将匹配 'a' 零次或多次，这几乎匹配任何字符串。所以我会说你必须使用 'a+' 来匹配 'a'*一次或*多次；并且您可能希望添加 '^' 或 '$' 以匹配行的开头/结尾，具体取决于您想要实现的目标。

干杯，亚历克斯

编辑：啊，太晚了 ;-) 至少我的猜测似乎是正确的 ;-)

# c++ - C ++私有成员可访问？

> ID：15114505
> 
> 赞同：5
> 
> 时间：2013-02-27T14:26:43.440
> 
> 标签：c++

我在使用 C++ 的信号类中有这个项目。当我看到这个时，我正在修改我们的讲师代码：

```
ListData::ListData(const ListData& newlist) 
    : Data(), nbNodes(newlist.nbNodes) {} 
```

正如他所说，这是一个“复制构造函数”，应该大致相当于以下内容：

```
ListData::ListData(const ListData& newlist){
  Data = "";
  //copy nbNodes of newList to current instance
  nbNodes = newlist.nbNodes;
} 
```

但困扰我的是`nbNodes`私人会员。**如果它是私有的，****这个构造函数如何访问`nbNodes`传递的？`newList`**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T14:28:33.297

关于私有成员的一个有趣的事情是相同类型的两个对象可以自由地访问彼此的私有成员。你可以把它想象成一个类总是与自己成为朋友。由于 this 是`ListData`并且`newlist`也是 a的构造函数`ListData`，因此您可以很好地访问其私有内容。

[这是一个例子](http://ideone.com/dq2Z8w)：

```
#include <iostream>

class foo
{
  public:
    foo() { }
    foo(std::string secret) : secret(secret) { }
    void steal_secret(const foo& other) { secret = other.secret; }
    std::string get_secret() { return secret; }
  private:
    std::string secret;
};

int main() {
    foo f1("I'm actually a bar");
    foo f2;
    f2.steal_secret(f1);
    std::cout << f2.get_secret() << std::endl;
    return 0;
} 
```

`f2`尽管它是私人的，但愉快而轻松地窃取了`secret`from 。`f1`

允许这样做的原因仅仅是因为`private`这并不意味着对象私有 - 它意味着类私有。这简化了诸如复制构造函数之类的函数的实现，这些函数需要对同一类的两个对象的内部进行一些工作。

该规则来自`private`(§11/1) 的定义：

> 一个类的成员可以是
> 
> *   `private`; 也就是说，它的名称只能被声明它的类的成员和朋友使用。
> *   [...]

请注意，它是根据类而不是对象定义的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T14:27:56.987

关键字具有类语义而`private`不是对象语义。因此，同一类的其他对象可以访问类对象的私有成员。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T14:28:06.050

`nbNodes`是`ListData` **类**私有的，而不是该类的特定实例。因此，在类的代码中，您可以看到该类的其他实例的私有数据。

如果不是这样，每个类都必须为每个数据成员导出“getter”，以便执行复制构造和复制分配。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-27T14:28:08.227

具有`private`可见性的成员是只能在它们所属的同一**类的***成员函数中访问的成员，对**对象*没有限制。

 ***如果 function`f()`是 class 的成员函数`C`，它可以访问 的**任何**实例的`private`成员，而不仅仅是隐式指针指向的那些成员（当然，这也使得这对于根本不接收指针的函数也有效） .**`C``this``static``this`**

 *** * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-27T14:29:23.710

复制构造函数就像任何其他方法一样：由于您可以从该类的方法访问该类的私有成员，因此您可以对复制构造函数执行相同的操作（否则，您如何将实例的状态复制到类给另一个？）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-27T14:37:58.530

来自 C++ 标准，第 11 章：成员访问控制：

> **私人**; 也就是说，它的名称只能被声明它的类的成员和朋友使用。

这意味着**该类**的任何成员都可以访问**私有成员**

 **这`ListData::ListData(const ListData& newlist)`是 ListData 的复制构造函数，它是一个成员函数，因此可以访问类 ListData 的私有成员。*******

# javascript - 无法运行第二个警报

> ID：15114506
> 
> 赞同：0
> 
> 时间：2013-02-27T14:26:43.693
> 
> 标签：javascript

我不知道为什么这个简单的代码虽然它是为了教育目的，所以请我帮助找出我做错的事情：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Random thoughts part one</title>
    <meta http-equiv="content-type" content="text/html;charset = utf-8" />
    <meta name="keywords" content="thoughts, random, philosophy, mohamed, samir ,sameer, muhammad , mohammed samir" />
    <meta name="description" content="This is a personal page about Mohamed Samir khalil that contain his thoughts and believes" />
    <link rel="stylesheet" type="text/css" href="style.css">
      <body>
        <script type="text/javascript">//
            <![CDATA[

                    alert("hello");
                    var target = document.getElementById("unique_element");
                    alert(target.length);
            //]]>
        </script>
        <center>
          <h3>Random thoughts</h3>
        </center>
        <p id="unique_element">I do not think it is coincidence, because every time I walk in streets I have that strong feeling that keeps telling me &#8221;Man, you have to help people!&#8221;.</p>
        <p>In the beginning I thought that because of thinned for recognition I mean I do this just to hear people say &#8220;thank you&#8221; and to hear people say &#8220;it is great thing that you
        are between us&#8221; so I thought it is all about ego, but you know when I really realized that it is not about ego!</p>
        <p>I realized that when I helped someone and they did not say thank you, what was supposed to happen is that , I should feel anger because it is all about ego, right?</p>
        <p>But what really happened that I felt happy just to help now people who are reading this will say either &#8220;you are so kind&#8221; or &#8220;Okay, you want to make it up huh!&#8221;but
        the reality is just neither this or that ; actually I realized that I am helping people because this is what make us humans and this thing let us feel that we are not alone in this world so
        it is kind of socializing too and also when you help people, I guarantee that someday someone will help you in a very tough situation and he or she will come out of nowhere this is the rule
        of life and this is how people should live.</p>
      </body>
    </link>
  </head>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:32:04.120

您的脚本在解析 DOM 之前运行，因此：

```
var target = document.getElementById("unique_element"); 
```

不会返回 HTML 元素，`target.length`只会失败。尝试将 JavaScript 部分放在结束`</body>`标记之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:31:02.063

您正在尝试显示 DOM 元素的长度。试试`alert(target.innerHTML.length);`吧。

# c# - 反序列化http响应

> ID：15114510
> 
> 赞同：0
> 
> 时间：2013-02-27T14:26:52.480
> 
> 标签：c#, asp.net, asp.net-web-api

我正在使用（不是我的）使用肥皂结构构建的 api。

```
<?xml version='1.0' encoding='UTF-8'?>
 <S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
   <S:Body>
     <somePrefix:someNodeName xmlns="ulrWithNoPrefix" xmlns:somePrefix="urlWithPrefix"
    xmlns:anotherPrefix="UrlForAnotherprefix xmlns:AttributePrefix="UrlForAttributePrefix>
     <anotherPrefix:childNode1>value</anotherPrefix:childNode1>
     <anotherPrefix:childNode2>value</anotherPrefix:childNode2>
     <anotherPrefix:childNode3>value</anotherPrefix:childNode3>
     <anotherPrefix:childNode3 AttributePrefix:AttributeName="attributeValue/>
  </somePrefix:someNodeName>
</S:Body>
</S:Envelope> 
```

我正在尝试从中构建一个 C# 对象。确定我可以在每个节点上进行，提取内部文本并填充自定义类型，但我知道可以这样做（我仍然需要构建类型）。我曾尝试在 httpClient 中使用内置的反序列化机制，还下载了 protobuf-net 并在那里尝试了运气但也失败了。

我有以下方法来处理连接：

```
公共无效 RunPostTask（字符串 url，字符串请求）
        {
            字符串 res = "";
            var client = new HttpClient();
            HttpRequestMessage 请求 = 新的 HttpRequestMessage();
            request.Content = new StringContent(req);
            request.Content.Headers.ContentType = new MediaTypeHeaderValue("text/xml");

 var task =
            client.PostAsync(url, request.Content).ContinueWith((TaskResponse) =>
        {
            TaskResponse.Result.EnsureSuccessStatusCode();
            var response = TaskResponse.Result;
            var ReadTask = response.Content.ReadAsStringAsync();
            ReadTask.Wait(10000);
            res = ReadTask.Result;

        }).ContinueWith((err) =>
            {
                if (err.Exception != null)
                {
                    res = err.Exception.ToString();
                }
            });
        task.Wait(10000);
    } 
```

我想反序列化 res 字符串（上面显示了一个典型的结构）

还想知道我使用 HttpClient 的方式是否正确，或者更好的设计是可取的？

谢谢吉拉德

# testing - 测试几个 sftp / ftp 主机的连接性

> ID：15114514
> 
> 赞同：0
> 
> 时间：2013-02-27T14:26:58.070
> 
> 标签：testing, ftp, sftp

我有许多有效的主机，我们需要用它们来测试 ftp 和 sftp 连接。这是出于合法的商业目的，我们有权连接到这些主机。这是一个服务器转换场景，我们正在更改 ip 并且需要知道哪些主机允许/拒绝连接。我有一个主机列表，需要遍历所有主机并确定 (1) 主机是否以登录横幅响应以及 (2) 我们是否可以成功登录。想知道这是否最好在 perl/python/bash 中完成（其中哪些将是最快的原型），或者是否已经编写了任何可以加速开发的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T11:09:44.570

使用 perl 和[Net::OpenSSH::Parallel](https://metacpan.org/module/Net%3a%3aOpenSSH%3a%3aParallel)：

```
use strict;
use warnings;
use Data::Dumper;
use Net::OpenSSH::Parallel;

my @hosts = qw(localhost workload workload-db);

my $pssh = Net::OpenSSH::Parallel->new();
$pssh->add_host($_) for @hosts;
$pssh->all(cmd => {stdout_file => "output-%HOST%",
                   stderr_to_stdout => 1,
                   stdin_file => ['-|', "echo uname -a\n"]});
$pssh->run;
my %errors = $pssh->get_errors;
print Dumper \%errors; 
```

# android - Android 小部件和列表视图

> ID：15114516
> 
> 赞同：1
> 
> 时间：2013-02-27T14:27:07.943
> 
> 标签：android, android-listview, android-widget

我正在尝试为我的应用程序创建一个小部件。I want it to be like this : The user selects my widget among all widgets then a listview appears the user selects on of the items and the widget in that category (which is introduced in the application) will show up But when choosing the Widget " forceClose”发生。我附上我的代码谢谢你的帮助

```
public class WidgetConfig extends ListActivity implements OnItemClickListener { 

  AppWidgetManager awm;
  Context c;
  int awID;
  public String LS [] = {"C", "B", "A"}; 

  protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    //  setContentView(R.id.listviewfirstshow);
    setListAdapter(new ArrayAdapter<String>(this,R.layout.widget_config , LS));
    ListView lv = (ListView)findViewById(R.id.listviewfirstshow);

    lv.setOnItemClickListener(this);
    Intent i = getIntent();
    Bundle extras = i.getExtras();
    if (extras != null) {
      awID = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID, 
                           AppWidgetManager.INVALID_APPWIDGET_ID);
    }
    else {
      finish ();
    }

    awm = AppWidgetManager.getInstance(c);
  }

  @Override
  public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {

    RemoteViews rv = new RemoteViews(c.getPackageName() R.layout.widget);
    Intent in =  new Intent(c, WidgetLearn2Activity.class);
    PendingIntent pi = PendingIntent.getActivity(c, 0, in, 0);
    rv.setOnClickPendingIntent(arg2, pi);
    awm.updateAppWidget(awID, rv);

    Intent result = new Intent();
    result.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, awID);
    setResult(RESULT_OK, result);
    finish();

  }
} 
```

和清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="learn.widget" android:versionCode="1" android:versionName="1.0" >
  <uses-sdk android:minSdkVersion="8" />
  <application android:icon="@drawable/ic_launcher" android:label="@string/app_name" >
    <activity android:name=".WidgetLearn2Activity" android:label="@string/app_name" >
      <intent-filter>  
        <action android:name="android.intent.action.MAIN" />   
        <category android:name="android.intent.category.LAUNCHER" /> 
      </intent-filter>
    </activity>
    <receiver android:name=".PointlessWidget" >
      <intent-filter >
        <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
      </intent-filter>
      <meta-data android:name="android.appwidget.provider" android:resource="@xml/widget_stuff" />
    </receiver>
    <activity android:name=".WidgetConfig" android:label="@string/app_name">
      <intent-filter >
        <action android:name="android.appwidget.action.APPWIDGET_CONFIGURE"/>
      </intent-filter>
    </activity>
  </application>
</manifest> 
```

# excel - 用于从列中删除零并与其他列进行比较的 Excel 公式

> ID：15114520
> 
> 赞同：0
> 
> 时间：2013-02-27T14:27:16.947
> 
> 标签：excel, ms-office, excel-formula

我正在尝试应用 Excel 公式对 excel 列进行排序，但无法想出它。

excel 条目如下所示：

![在此处输入图像描述](../Images/cbb7b7f29a906f56458b35c942ca8de2.png)

如您所见，在第一列中，记录的末尾有 000。

1）我需要忽略A列的最后一个000，比较A列和B列的内容。

```
 a) If it matches, then remove the 000 from the Column A.

   b) If it does not matches, then delete the entire row OR make the content for both the column as N/A. 
```

请帮我解决这个问题，这个excel的内容很大，因此手动操作是不可行的:(

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:35:31.490

如果第一列总是数字并且总是有 3 个零，那么只需除以 1000 并进行比较。

如果不是，则转换为字符串并将第一个（长度-3）字符减去并与第二列的字符串结果进行比较

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T16:00:14.697

如果您希望使用 VBA 执行此操作，可以将以下宏添加到您的工作簿中：

**编辑**

您的评论表明您正在寻找前导零和尾随零，而不仅仅是像原始问题所暗示的那样尾随。如果是这种情况，您可以通过一个简单的条件语句来完成此操作，该语句检查 3 个零的位置（如果有的话）。

`Format`如果可能的话，单元格`Number type`删除前导零会简单得多。如果这是不可能的，那么这是实现这一目标的宏：

```
Public Sub CompareValues()
    Dim rowCount As Integer, currentRow As Integer
    Dim firstCellValue As String
    Dim secondValValue As String
    rowCount = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row
    Dim test As String
    For currentRow = rowCount To 1 Step -1

        'remove three leading or trailing 0's from value
        test = Left(Cells(currentRow, 1).Value, 3)
        If Left(Cells(currentRow, 1).Value, 3) = "000" Then
            firstCellValue = Right(Cells(currentRow, 1).Value, Len(Cells(currentRow, 1).Value) - 3)
        Else
            firstCellValue = Left(Cells(currentRow, 1).Value, Len(Cells(currentRow, 1).Value) - 3)
        End If

        secondValValue = Cells(currentRow, 2).Value

        If Not IsEmpty(firstCellValue) And Not firstCellValue = "" Then
            If firstCellValue = secondValValue Then
                Cells(currentRow, 1).Value = secondValValue
            Else
                Cells(currentRow, 1).EntireRow.Delete
            End If
        End If
    Next
End Sub 
```

**宏之前**

![在此处输入图像描述](../Images/552033a7ccaa0b82f8b1f7277e80f0cc.png)

**宏之后**

![在此处输入图像描述](../Images/832f18a89122079856286ceaf6a0af65.png)

# ruby - 什么| smtp | 下面的 Ruby 代码段有点意思？

> ID：15114524
> 
> 赞同：0
> 
> 时间：2013-02-27T14:27:23.003
> 
> 标签：ruby

我正在使用 MailFactory 发送电子邮件，并遇到了我以前从未见过的奇怪条款。我来自 PHP，现在已经做 Ruby 大约一个半星期了。

是| smtp | 变量 Net::SMTP.start 返回的值，然后在 {} 块中使用？

```
response = Net::SMTP.start(cfg['host'], 25, cfg['from_domain'], cfg['username'], cfg['password'], :plain) {
    | smtp |
    recipients = cfg['mail_targets']['errors']
    smtp.send_message(mail.to_s, mail.from, [recipients, mail])
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:29:09.620

`start`这是从块中传递的参数。

> 当使用块调用此方法时，新启动的 SMTP 对象将让给块，并在块调用完成后自动关闭。否则，调用者有责任在完成时关闭会话。

[http://apidock.com/ruby/Net/SMTP](http://apidock.com/ruby/Net/SMTP)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:29:28.350

`smtp`是传递到块中的参数的名称。语法是`{ |smtp| <code> }`Ruby 块语法。

[http://www.martinfowler.com/articles/simpleRuby.html](http://www.martinfowler.com/articles/simpleRuby.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:30:09.437

是的，格式有点奇怪（通常块变量在“{”旁边），但您正在使用块内的 Net::SMTP 实例。

[http://ruby-doc.org/stdlib-2.0/libdoc/net/smtp/rdoc/Net/SMTP.html](http://ruby-doc.org/stdlib-2.0/libdoc/net/smtp/rdoc/Net/SMTP.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T14:37:00.273

这称为块。

网络::SMTP::开始：[http ://ruby-doc.org/stdlib-2.0/libdoc/net/smtp/rdoc/Net/SMTP.html#method-c-start](http://ruby-doc.org/stdlib-2.0/libdoc/net/smtp/rdoc/Net/SMTP.html#method-c-start)

更多关于红宝石块：[http ://c2.com/cgi/wiki?BlocksInRuby](http://c2.com/cgi/wiki?BlocksInRuby)

# c# - 如何创建动态表达式，例如 ( x, y ) => DateTime.Compare( y.EFFECTIVE_DATE, x.EFFECTIVE_DATE )

> ID：15114527
> 
> 赞同：3
> 
> 时间：2013-02-27T14:27:28.683
> 
> 标签：c#, expression-trees

我是一个较新的编码器，并且在使用表达式树动态创建以下 lamdba 表达式时遇到了很多问题。

```
( x, y ) => DateTime.Compare( y.EFFECTIVE_DATE, x.EFFECTIVE_DATE ) 
```

我刚刚开始了解表达式树的基础知识，但似乎还不足以创建它。我没有任何好的代码可以真正放在这里，因为老实说我真的在摸索这个。任何帮助都会很棒。

先感谢您。

抱歉，第一次发布并在格式化项目方面遇到了一些问题。

所以，在我的主要方法中，我有以下内容：

var sortExpression = testing.GetExpression("EFFECTIVE_DATE", "EFFECTIVE_DATE");

```
 if (e.SortDirection == SortDirection.Ascending)
        {
            paymentAuthorizationList.Sort( sortExpression );  
        } 
```

而且，在我的获取表达式方法中：

```
 public Expression<Func<AuthorizePayments, AuthorizePayments, int >> GetExpression<t>( string propertyName, string propertyValue )
    {

        var paramX = Expression.Parameter( typeof( AuthorizePayments ), "x" ); // x
        var paramY = Expression.Parameter( typeof( AuthorizePayments ), "y" ); // y

        var xDate = Expression.Property( paramX, "EFFECTIVE_DATE" ); // x.EFFECTIVE_DATE
        var yDate = Expression.Property( paramY, "EFFECTIVE_DATE" ); // y.EFFECTIVE_DATE

        // DateTime.Compare(y.EFFECTIVE_DATE, x.EFFECTIVE_DATE)
        var body = Expression.Call( typeof( DateTime ).GetMethod( "DateTime.Compare" ), yDate, xDate );

        // (x, y) => DateTime.Compare(y.EFFECTIVE_DATE, x.EFFECTIVE_DATE)
        var expr = Expression.Lambda<Func<AuthorizePayments, AuthorizePayments, int >>( body, paramX, paramY ); 
```

返回表达式；}

我知道此时变量是错误的。排序表达式不适用于排序方法。

我离我正在尝试做的事情还差得很远吗？

对不起我的无知，感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:38:56.837

好吧，您可以使用 lambda 表达式在编译器的帮助下“静态地”创建它：

```
Expression<Func<Foo, Foo, int>> expr =
            (x, y) => DateTime.Compare(y.EFFECTIVE_DATE, x.EFFECTIVE_DATE); 
```

如果您想“手动”完成：

```
var paramX = Expression.Parameter(typeof(Foo), "x"); // x
var paramY = Expression.Parameter(typeof(Foo), "y"); // y

var xDate = Expression.Property(paramX, "EFFECTIVE_DATE"); // x.EFFECTIVE_DATE
var yDate = Expression.Property(paramY, "EFFECTIVE_DATE"); // y.EFFECTIVE_DATE

// DateTime.Compare(y.EFFECTIVE_DATE, x.EFFECTIVE_DATE)
var body = Expression.Call(typeof(DateTime).GetMethod("Compare"), yDate, xDate);

// (x, y) => DateTime.Compare(y.EFFECTIVE_DATE, x.EFFECTIVE_DATE)
var expr = Expression.Lambda<Func<Foo, Foo, int>>(body, paramX, paramY); 
```

# javascript - 如何在 javascript 中创建具有保存值的组合框（类似于 google CategoryFilter Control）

> ID：15114532
> 
> 赞同：0
> 
> 时间：2013-02-27T14:28:04.487
> 
> 标签：javascript, html, combobox, google-api, google-visualization

我想在我的 html 站点上有一个组合框，如下面的 img 所示。我想获取选定的值并打印出来。我怎样才能创建这个组合框？我已经尝试过 Google API Visualization CategoryFilter 控件。但是你不能自定义谷歌控件。

![组合框](../Images/99b791e579856a9c1c6625d6f82347eb.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:55:01.713

我只是像你描述的那样模拟了一个组合框：http: [//jsfiddle.net/twwGM/](http://jsfiddle.net/twwGM/)

基本上，您需要使用 JS 来捕获`onchange`选择框的事件，然后通过从您的函数生成 HTML 字符串，将其值附加到具有特定样式的某个目标区域。将样式保留在 JS 之外，而是通过使用 CSS 类对其进行样式设置。

HTML 标记：

```
<form>
    <select id="selector">
        <option>Magic</option>
        <option>Canaries</option>
        <option>Unicorns</option>
    </select>
</form>
<div id="target-area"></div> 
```

JS代码

```
(function () {

    document.getElementById("selector").addEventListener("change", function () {
        var val = this.options[this.selectedIndex].value;
        var genId = val + "-close";
        if (!document.getElementById(genId)) {
            var htmlstr = "<div class='pasted-option'>" + val + "<span id='" + genId + "'>x</span></div>";
            var targetArea = document.getElementById("target-area");
            targetArea.innerHTML += htmlstr;
            var closeButton = document.getElementById(genId);
            closeButton.addEventListener("click", function () {
                var parent = this.parentNode;
                parent.parentNode.removeChild(parent);
            });
        }
    });

}(window)); 
```

正如您在代码中看到的那样，我们还根据项目的名称为 span 生成一个 id，以便我们稍后可以调用它以从列表中删除。它还使我们能够检查并确定列表中不存在该值。

# db2 - 如何在 HyperSQL (HSQL) 中打开 DB2 语法？

> ID：15114537
> 
> 赞同：0
> 
> 时间：2013-02-27T14:28:17.523
> 
> 标签：db2, hsqldb

我正在尝试使用 HSQL 进行测试。在生产中，代码针对 DB2 数据库运行。我想打开 HSQL 的 DB2 语法并针对它运行生产 SQL（或尽可能多地运行它）。

根据[文档](http://hsqldb.org/doc/guide/management-chapt.html)，在 DB2 语法模式下，`nextval for`支持表达式。

我已经使用连接属性打开了 DB2 语法模式`sql.syntax_db2=true`，以及：

```
set database sql syntax db2 true; 
```

但是，我无法使用`nextval for`，尽管语法`next value for`可以正常工作：

```
values (next value for test_seq); -- returns the next value
values (nextval for test_seq); -- results in an error 
```

错误是：

```
Error: user lacks privilege or object not found: NEXTVAL
SQLState:  42501
ErrorCode: -5501 
```

我没有正确激活 DB2 语法模式，还是我做错了什么？我以 SA 身份登录，这可能是权限问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:09:05.170

文档中有错误。DUAL 表的支持方式与 Oracle 语法相同，但 NEXTVAL 是一种 Oracle 形式，用作`test_seq.NEXTVAL`.

DB2 支持`NEXT VALUE FOR test_seq`并允许 NEXTVAL 作为 NEXT VALUE 的替代方案。这将在 HSQLDB 的下一个版本中得到支持。

# ruby - Ruby 常量和命名空间

> ID：15114540
> 
> 赞同：2
> 
> 时间：2013-02-27T14:28:27.297
> 
> 标签：ruby, namespaces, constants

以下 2 段代码之间有区别吗？

```
# 1st snippet
class A
  class B
    # some code here
  end
end

# 2nd snippet
class A::B
  # some code here
end 
```

如果有区别，您能帮我理解区别是什么以及为什么要使用一个版本而不是另一个版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:47:33.097

这似乎主要是用于组织代码的语法糖 - 无论哪种方式对您有意义都是“正确”的方式。唯一的例外是，对于第二个片段，如果`class A`尚未定义，您将收到错误消息。在大多数情况下，这个问题是这个问题的副本[，](https://stackoverflow.com/questions/6927566/using-instead-of-module-for-ruby-namespacing)但由于您将类嵌套在类中而不是模块中的类，我将继续链接[Module docs](http://ruby-doc.org/core-2.0/Module.html)，它解释了 Ruby 中模块和类之间的区别和可以帮助您在您自己的问题的上下文中解释该 SO 答案。

# asp.net - SQL MAX() 函数很慢，有没有更好的方法？

> ID：15114541
> 
> 赞同：3
> 
> 时间：2013-02-27T14:28:30.190
> 
> 标签：asp.net, sql, sql-server, max, min

我有一个 SQL 数据库和 ASP.NET Web 应用程序，我的大部分查询都涉及 SQL max 函数。

例如，下面的查询需要大约。在 ASP.NET 网站和 SSMS 上执行（使用分析器时）36 秒。

```
SELECT MAX(CONVERT(FLOAT,ISNULL(Runhrs,Runho))) - 
       MIN(CONVERT(FLOAT,ISNULL(Runhrs,Runho))) AS ACTUALHOURSRUN 
FROM REPORTINGSYSTEM.DBO.HL_LOGS 
WHERE ID_LOCATION = @ID_LOCATION AND 
       CONVERT(VARCHAR,TIME_STAMP,102) 
       BETWEEN @STARTDATE AND @ENDDATE 
```

有问题的表有大约。5,000,000 条记录和 45 列。

执行查询以减少执行时间的最佳/最快/最有效方式是什么？

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:34:39.010

ID_LOCATION 和 TIME_STAMP 上的索引将是一个不错的选择。

但是，当您将 TIME_STAMP 字段转换为 VARCHAR 时，这将阻止它使用索引。相反，重新编写查询以消除执行 CONVERT 的需要，而是使用 DATETIME 值。

例如

```
SELECT MAX(CONVERT(FLOAT,ISNULL(Runhrs,Runho))) - MIN(CONVERT(FLOAT,ISNULL(Runhrs,Runho))) AS ACTUALHOURSRUN 
FROM REPORTINGSYSTEM.DBO.HL_LOGS 
WHERE ID_LOCATION = @ID_LOCATION AND TIME_STAMP >= @STARTDATE AND TIME_STAMP < @ENDDATE 
```

确保 @STARTDATE 和 @ENDDATE 也是 DATETIME 参数（我假设这是 TIME_STAMP 列的数据类型）

我还想问 Runhrs/Runho 列是什么数据类型？如果还没有存储为 FLOAT/DECIMAL，那么它们会不会是最合适的数据类型？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:38:27.180

您需要做几件事：

*   **确保您搜索的列已编入索引**- 您需要在`ID_LOCATION`and上建立索引`TIME_STAMP`（如果您有其他查询跨位置按日期或跨日期按位置进行查询，您可以考虑定义单独的索引；否则，单个组合索引将起作用）。
*   **停止将时间戳转换为字符串**- 在查询中使用本机数据类型`@STARTDATE`，`@ENDDATE`或将条件替换为`TIME_STAMP between CONVERT(datetime,@STARTDATE) and CONVERT(datetime,@ENDDATE)`

这两个更改应该使您的查询更快，尤其是第二个更改：当前，`CONVERT(VARCHAR,TIME_STAMP,102)`强制查询优化器对与您的位置匹配的所有内容进行全面扫描，如果没有索引，则甚至进行全表扫描`ID_LOCATION`。索引搜索应将记录数降低到可接受的水平。

最后要承担的一项是`CONVERT(FLOAT,ISNULL(Runhrs, Runho))`：如果前两次修改后的查询速度仍然不够，则更`MAX(CONVERT(FLOAT,ISNULL(Runhrs,Runho)))`改为`CONVERT(FLOAT, MAX(ISNULL(Runhrs,Runho)))`，并对 进行相同的更改`MIN`。这可能会或可能不会起作用，具体取决于 和 的`Runhrs`类型`Runho`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:36:49.947

首先，将 Rhnhrs 存储为数字类型。那么你不需要进行转换。

其次，您将通过在`hl_logs(id_location, time_stamp)`. 你也可以扔`Runhrs`，`Runho`以及。使用所有四列上的索引（按此顺序），查询甚至不需要转到原始数据。

要使用索引，您需要将`where`语句更改为：

```
 time_stamp bewteen @startTimeStamp and @EndTimeStamp 
```

如果变量是函数的参数，SQL 引擎将不会使用索引。

生成的查询应该更像：

```
select max(coalesce(runhrs, runho)) - min(coalesce(runhrs, runho) as Actual
from REPORTINGSYSTEM.DBO.HL_LOGS 
WHERE ID_LOCATION = @ID_LOCATION AND 
      TIME_STAMP BETWEEN cast(@STARTDATE as datetime) AND cast(@ENDDATE as datetime) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:37:52.347

```
SELECT CONVERT(FLOAT, MAX(Runhrs)), CONVERT(FLOAT, MAX(Runho),
       CONVERT(FLOAT, MIN(Runhrs)), CONVERT(FLOAT, MIN(Runho)
FROM REPORTINGSYSTEM.DBO.HL_LOGS 
WHERE ID_LOCATION = @ID_LOCATION
  AND TIME_STAMP BETWEEN @STARTDATE AND @ENDDATE 
```

在调用 SQL 的代码中自己做减法。（那是 .net 代码。）

你应该有一个关于 ID_LOCATION、TIME_STAMP、Runhrs、Runho 的索引。一个包含所有四个字段的索引。也许两个索引。

```
CREATE INDEX REPORTINGSYSTEM.DBO.HL_LOGS ON ID_LOCATION, TIME_STAMP, Runhrs
CREATE INDEX REPORTINGSYSTEM.DBO.HL_LOGS ON ID_LOCATION, TIME_STAMP, Runho 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T11:40:07.437

```
AND CONVERT(VARCHAR,TIME_STAMP,102) 
```

这不是这样做的方法 - 它会导致缓慢。不要对 DATA 应用不必要的函数 - 它会剥夺优化器在该字段上使用索引的任何机会。反过来，将`@STARTDATE`+`@ENDDATE`转换**为与 field 相同的数据类型**。（或者，这样想你正在做 ~ 5,000,000 次转换，以便你可以比较 2 个变量）

```
[time_stamp] BETWEEN @STARTDATE AND @ENDDATE 
```

请理解这实际上意味着：

```
[time_stamp] > = @STARTDATE AND [time_stamp] <= @ENDDATE 
```

即包含两个“边界”日期时间，通常更容易和更准确地避免之间的包容性并将其拼写如下：

```
[time_stamp] > = @STARTDATE AND [time_stamp] < @ENDDATE (with @enddate
being "next day at 00:00:00:000)

MAX(CONVERT(FLOAT,ISNULL(Runhrs,Runho))) -
MIN(CONVERT(FLOAT,ISNULL(Runhrs,Runho))) AS ACTUALHOURSRUN 
```

哇，这是很多函数调用！这里的问题不是纯粹`MAX()/MIN()`的。

建议你简单地寻找`Max(Runhrs)`前面提到的等，然后做减法。

# android - Android - 将位图纹理应用于 API 绘图例程

> ID：15114543
> 
> 赞同：0
> 
> 时间：2013-02-27T14:28:34.053
> 
> 标签：android, textures, android-canvas, porter-duff

我有一个跨越整个屏幕的位图，它将用作我需要绘制到画布上的 Path 对象的纹理。然后我有一个背景图像，这个纹理路径需要在上面绘制。

我尝试使用 PorterDuff 模式，但似乎没有任何工作正常。我很难弄清楚 PorterDuff 模式的确切运作方式，因为它们似乎都没有按照[我一直认为的方式运作](http://www.ibm.com/developerworks/java/library/j-mer0918/)。

我已经找到了一种使用此测试代码纹理路径的方法：

```
Paint paint = new Paint();
    //draw the texture
canvas.drawBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.texture),0,0,paint);
   //construct the Path with an inverse even-odd fill
Path p = new Path();
p.setFillType(Path.FillType.INVERSE_EVEN_ODD);
p.addCircle(this.getHeight()/2, this.getWidth()/2, 200, Path.Direction.CCW);
   //use CLEAR to remove inverted fill, thus showing only the originally filled section
paint.setXfermode(new PorterDuffXfermode(android.graphics.PorterDuff.Mode.CLEAR));
   //draw path
canvas.drawPath(p, paint); 
```

但我不知道如何将其放置在背景图像之上。我只是错误地使用了 PorterDuff 模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:43:26.090

也许我的问题可以引导您找到解决方案：

在`paint`你的`drawPath`电话中使用：
油漆风格是什么？
笔画宽度是多少？
什么是笔触/填充颜色？

如果您不使用描边/填充颜色，而是使用纹理，那么对绘画的调用在哪里`setShader`（使用 a `BitmapShader`）？

# c# - 旋转扫描的 PDF 文件

> ID：15114544
> 
> 赞同：0
> 
> 时间：2013-02-27T14:28:34.147
> 
> 标签：c#, asp.net, winforms, pdf

我有一个 pdf 格式的扫描文件，有时扫描的文件可能会颠倒或翻转。我希望能够将文档旋转为正确的阅读格式。此外，扫描的文档已经有 QR 码，是否有办法检测 QR 码的位置，因为正确的对齐方式是 QR 码必须位于左上角。这样文本也是正确的。

这就是我所拥有的 - 它可以很好地旋转倒置的文档，但是如果以正确的格式扫描文档，它会将其倒置保存。

```
if(page.Rotate != 180)
    page.Rotate = (page.Rotate + 180)%360; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:47:25.460

只需尝试翻转和旋转的所有组合，寻找正确位置和方向的 QR 码。在伪代码中：

```
images = array()
images[0] = masterimage.flip(false).rotate(0)
images[1] = masterimage.flip(false).rotate(180)
images[2] = masterimage.flip(true).rotate(0)
images[3] = masterimage.flip(true).rotate(180)

for i = 0...3
    if qrCodePlacedCorrectly(images[i])
        output = images[i]
        quit 
```

困难的部分是检测二维码。它应该是可行的，因为它们是方形的，总是有三个保证的点；右上角、左上角和左下角。 [这个 SO question](https://stackoverflow.com/questions/8339612/zxing-sample-code-to-detect-qrcode-in-an-image)应该有助于检测 QR 码。

# r - I() 的作用是什么？

> ID：15114548
> 
> 赞同：-1
> 
> 时间：2013-02-27T14:28:45.073
> 
> 标签：r, regression, linear-regression

我在网上找到了以下代码

`mod1 <- lm(mpg ~ weight + I(weight^2) + foreign, auto)`

功能是什么`I()`？结果似乎与`weight^2`相同`I(weight^2)`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T15:02:39.333

的功能`I()`是将公式中的术语与通常的公式解析和语法*隔离开来。*在数据框中还有其他用途`I()`，它有助于创建具有或继承自类`"AsIs"`的对象，从而允许嵌入对象而无需进行通常的转换。

在公式的情况下，正如您特别询问的那样，`^`是一个特殊的公式运算符，它指示术语交叉到第`n`th 度，`n`在运算符之后给出如下：`^n`. 因此，`^`公式中没有通常的算术解释。（同样，`-`、`+`和`/`运算`*`符也具有特殊的公式含义，因此`I()`需要使用它们将它们与公式解析工具隔离开来。）

在您给出的具体示例中（我将使用内置数据集进行说明`trees`），如果您忘记使用`I()`二次项，在这种情况下，R 将完全忽略该项，因为`Volume`（`weight`在您的示例中）是已经在模型中，并且您要求变量与其自身进行多向交互，这不是二次项。

首先没有`I()`：

```
> lm(Height ~ Volume + Volume^2, data = trees)

Call:
lm(formula = Height ~ Volume + Volume^2, data = trees)

Coefficients:
(Intercept)       Volume  
    69.0034       0.2319 
```

注意`Volume`公式中只有术语吗？二次模型的正确规范（实际上可能不是，见下文）是

```
> lm(Height ~ Volume + I(Volume^2), data = trees)

Call:
lm(formula = Height ~ Volume + I(Volume^2), data = trees)

Coefficients:
(Intercept)       Volume  I(Volume^2)  
   65.33587      0.47540     -0.00314 
```

我说可能不正确；这是由于`Volume`与 Volume^2 `. An identical but more stable fit can be achieved by the use of orthogonal polynomials, which`poly()` 之间的相关性可以为您产生的。所以更稳定的规范将是：

```
> lm(Height ~ poly(Volume, 2), data = trees)

Call:
lm(formula = Height ~ poly(Volume, 2), data = trees)

Coefficients:
     (Intercept)  poly(Volume, 2)1  poly(Volume, 2)2  
          76.000            20.879            -5.278 
```

请注意，拟合与早期模型相同，但由于输入数据不同（正交多项式与原始多项式）而具有不同的系数估计值。`summary()`如果您不相信我，您可以通过他们的输出看到这一点：

```
> summary(lm(Height ~ poly(Volume, 2), data = trees))

Call:
lm(formula = Height ~ poly(Volume, 2), data = trees)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.2266  -3.6728  -0.0745   2.4073   9.9954 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)       76.0000     0.9322  81.531  < 2e-16 ***
poly(Volume, 2)1  20.8788     5.1900   4.023 0.000395 ***
poly(Volume, 2)2  -5.2780     5.1900  -1.017 0.317880    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 5.19 on 28 degrees of freedom
Multiple R-squared: 0.3808, Adjusted R-squared: 0.3365 
F-statistic: 8.609 on 2 and 28 DF,  p-value: 0.001219 

> summary(lm(Height ~ Volume + I(Volume^2), data = trees))

Call:
lm(formula = Height ~ Volume + I(Volume^2), data = trees)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.2266  -3.6728  -0.0745   2.4073   9.9954 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 65.335867   4.110886  15.893 1.52e-15 ***
Volume       0.475398   0.246279   1.930   0.0638 .  
I(Volume^2) -0.003140   0.003087  -1.017   0.3179    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 5.19 on 28 degrees of freedom
Multiple R-squared: 0.3808, Adjusted R-squared: 0.3365 
F-statistic: 8.609 on 2 and 28 DF,  p-value: 0.001219 
```

请注意模型中线性项和二次项的*t检验差异。*这就是输入多项式项的正交性有帮助的地方。

要真正了解`^`公式中的内容（如果`?formula`您不熟悉其中的术语，请考虑以下模型：

```
> lm(Height ~ (Girth + Volume)^2, data = trees)

Call:
lm(formula = Height ~ (Girth + Volume)^2, data = trees)

Coefficients:
 (Intercept)         Girth        Volume  Girth:Volume  
    75.40148      -2.29632       1.86095      -0.05608 
```

由于 中有两个项`(...)^2`，因此公式解析代码将其转换为两个变量的主效应加上它们的二阶交互作用。该模型可以更简洁地写为`Height ~ Girth * Volume`，`^`但当您需要更高阶交互或大量变量之间的交互时会有所帮助。

# ruby-on-rails-3 - 在 Rails 中使用 Backbone 更新全局变量

> ID：15114549
> 
> 赞同：0
> 
> 时间：2013-02-27T14:28:45.143
> 
> 标签：ruby-on-rails-3, backbone.js, ruby-on-rails-3.2

我的单页应用程序的保存功能现在启动并运行，Backbone 中有不同的前端模型和集合（song.js 和songsCollection.js），保存到 Rails 中的适当后端模型（song.rb）。在用户创建一首由节拍和小节等组成的歌曲后......，主干路由将用户带到包含歌曲的 url，但是，我用来传递所有歌曲的 gobal 变量页面开始的开头没有更新。

我如何从主干（在路由或视图中）、方法或其他东西调用从数据库中重新获取所有歌曲，包括最近创建的歌曲，最好不更改 URL 的 Rails 端（在#哈希）？

位于 Assets.js.erb 中的 App.songs 变量是我感兴趣的从 Rails 更新的内容，在创建新歌曲后......

我不反对使用 gon gem，但如果我这样做了，我将如何调用它来更新？

大声思考：

也许在 assests.js.erb 我可以有这个：

```
App.updateThis = function(appSongs) {
  // then an ajax/pjax call to the Rails songs_controller.rb that returns newAllSongs
  appSongs = { songs: newAllSongs }
  return appSongs; // this would/should update the global variable 
} 
```

参考文件：

应用程序.js：

```
require([
  'MYAPPLICATION' // this gets passed in as 'Application'
], function(Application){
  Application.initialize(App.songs);
}); 
```

MYAPPLICATION.js：

```
define([
  'jquery',
  'underscore',
  'backbone',
  'backbone/routers/router', // Request router.js
], function($, _, Backbone, Router){
  var initialize = function(options){
    window.router = Router.initialize(options);
  }
  return {
    initialize: initialize
  };
}); 
```

此文件用于将 AssetsPipeline 路径打包到图像和声音，并在渲染时将它们传递给应用程序，形成要点： [https ://gist.github.com/patrickberkeley/3879730](https://gist.github.com/patrickberkeley/3879730)

资产.js.erb：

```
App = {};
App.assets = {
  // Returns an object containing all of asset pipeline's image paths.
  // This hash is because Rails' Asset Pipeline bundles the routes to files
  // per user session, then hands that to the user's session browser, for security.
  // So we create in Ruby (erb = embedded ruby) a hash of the images to be accessed
  // in the JS.
  images: {
    <% AssetsUtil.images.each do |img| %>
      "<%= img %>" : "<%= asset_path(img) %>",
    <% end %>
  }, 
  // Return a formatted URL for an asset.
  path: function(name) {
    // If the file is in our images object, pull the path from there.
    if (this.images && this.images[name]) {
      return this.images[name];
    }

    // Otherwise, create a generic asset path.
    return '/assets/' + name;
  }
};

App.songs = {
  songs: <%= Song.all.to_json.html_safe %>
}; 
```

routes.js (backbone 的路由，不是 rails 的路由)

```
define([
  .... require.js paths .....
], function($, _, Backbone, mainHomeView, beatSliderView, beatBarsView, componentsView, tempoSliderView, transportView, repButtonView, log, songsCollection, songsViewNew, songsViewIndex, songsViewShow, songsViewEdit){

  var AppRouter = Backbone.Router.extend({
    songs: {},
    routes: {
      'new'       : 'newSong',
      'index'     : 'index',
      ':id/edit'  : 'edit',
      ':id'       : 'show',
      '.*'        : 'newSong'
    },
    newSong: function(){
      var view = new songsViewNew({collection : this.songs});
      /// A WHOLE BUNCH OF RENDERING....
    },
    index: function(){
      console.log('bb routes index');
    },
    show: function(id){
      var createdSong = this.songs.get(id);
      var view = new songsViewShow(createdSong);
    },
    edit: function(id){
      console.log('bb routes edit');
    },
  });

  // Initialize the Router, with the options, where (options) is declared in MYAPPLCIATION.js
  // and called from application.js
  //
  // (options) == 'assest.js.erb' => App.songs{ songs : <%= Song.all.to_json.html_safe %> }
  // (options) == All the songs in the DB
  var initialize = function(options){

    var app_router = new AppRouter;
    app_router.songs = new songsCollection();
    app_router.songs.reset(options.songs);

    name = '';
    $('.component').each( function() {
      name = name + $(this).attr('id') + '.';

      $(this).children('.measure').each( function() {
        name = name + $(this).attr('id') + '.';

          $(this).children('.beat').each( function() {
            name = name + $(this).attr('id') + '.';
          });
      });

      log.sendLog([[1, "Component structure: "+name]]);
      name = '';
    });
    Backbone.history.start();
    return app_router;
  };

  return {
    initialize: initialize
  };
}); 
```

使用：

*   导轨 3.2.2
*   通过 gem 'rails-backbone' 的主干.js
*   require.js 通过 gem 'requirejs-rails'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:23:38.470

If I understand your question, you simply need to perform a '[fetch](http://backbonejs.org/#Collection-fetch)' on the collection after a successful update.

# c# - 使用带有继承类（每个类型的表）的 MVC 脚手架存储库不起作用

> ID：15114551
> 
> 赞同：0
> 
> 时间：2013-02-27T14:28:50.400
> 
> 标签：c#, asp.net-mvc, entity-framework, inheritance, repository-pattern

我有一个`Tenant`继承自`UserProfile`. 我使用 table-per-type 继承，所以我的上下文类看起来像这样：

```
// 1 DbSet for superclass UserProfile
public DbSet<LetLord.Models.UserProfile> UserProfile { get; set; } 
```

我正在使用存储库类进行数据访问，并`TenantRepository`使用以下包管理器命令创建：

> 脚手架控制器租户 - 存储库

当我尝试运行我的应用程序时，TenantRepository 中对租户的所有引用都会引发以下错误...

> 'MyNamespace.MyContext' 不包含定义'Tenant'，并且找不到接受第一个参数'MyNamespace.MyContext' 的'Tenant' 的扩展。

...例如以下参考：

```
public IQueryable<Tenant> All
{
    get { return context.Tenant; } // error line here
} 
```

当使用 table-per-type 继承时`DbSet`，应该只包含一个 for 基类，所以我明白为什么我会收到错误。

在我的场景中如何使用带有派生类的存储库？

* * *

**编辑**

使用 , 等时如何完成`.Add()`上述`.Find()`操作`.Remove()`？

与上述方法相同的错误：

```
public Tenant Find(int id)
{
    return context.UserProfile.OfType<Tenant>().Find(id); // error at .Find()
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:38:43.807

尝试这个：

```
public IQueryable<Tenant> All
{
    get { return context.UserProfile.OfType<Tenant>(); }
} 
```

这只会返回租户。

对于添加、查找、删除等其他方法：

```
public Tenant Find(int id)
{
    // a few different options here -- assumes your key property is Id
    return context.UserProfile.OfType<Tenant>().SingleOrDefault(t => t.Id == id);

    // option 2 
    // even though your context does not expose a DbSet<Tenant>, you can still
    // use the Set<TResult>() method to get only tenants this way
    return context.Set<Tenant>().Find(id);
}

public void Add(Tenant tenant)
{
    context.Add(tenant);
}

public void Remove(Tenant tenant)
{
    context.Set<Tenant>().Remove(tenant);
} 
```

# java - 朴素贝叶斯分类器 LongWritable 异常

> ID：15114555
> 
> 赞同：2
> 
> 时间：2013-02-27T14:28:56.190
> 
> 标签：java, mahout

我正在尝试使用 Mahout 中的朴素贝叶斯分类器对一些产品数据进行分类。

我曾经`solr`将两个数据集都转换为 lucene 索引，然后使用 Mahout split 命令创建训练集和保持集。这似乎工作正常。

现在我已经到了用 trainnb 训练朴素贝叶斯模型的阶段，但我收到以下错误：

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 1
        at org.apache.mahout.classifier.naivebayes.BayesUtils.writeLabelIndex(BayesUtils.java:119)
        at org.apache.mahout.classifier.naivebayes.training.TrainNaiveBayesJob.createLabelIndex(TrainNaiveBayesJob.java:152)
        at org.apache.mahout.classifier.naivebayes.training.TrainNaiveBayesJob.run(TrainNaiveBayesJob.java:92)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
        at org.apache.mahout.classifier.naivebayes.training.TrainNaiveBayesJob.main(TrainNaiveBayesJob.java:62)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
        at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
        at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:195) 
```

这是我的命令输入：

```
$MAHOUT_HOME/bin/./mahout trainnb -i ~/training_output/Amazon_training_output/ -el -o ~/model/Amazon -li ~/labelindex/Amazon -ow -c 
```

在这种情况下，错误是什么意思，我该如何解决？

有没有可能是我原来的索引是罪魁祸首？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T19:01:53.413

也许您的密钥格式不正确？根据代码，我看到关键是期待 /string/int

第 119、131 行 [http://grepcode.com/file/repository.cloudera.com/content/repositories/releases/org.apache.mahout/mahout-core/0.7-cdh4.1.3/org/apache/mahout/classifier/ naivebayes/BayesUtils.java?av=f](http://grepcode.com/file/repository.cloudera.com/content/repositories/releases/org.apache.mahout/mahout-core/0.7-cdh4.1.3/org/apache/mahout/classifier/naivebayes/BayesUtils.java?av=f)

# java - Jtable，对每一行使用不同的对齐方式

> ID：15114560
> 
> 赞同：0
> 
> 时间：2013-02-27T14:29:23.170
> 
> 标签：java, swing, jtable, alignment, tablecellrenderer

我创建了一个表格，需要每隔一行向右对齐，每隔一行对齐。

我了解如何对齐行。这是我的默认渲染器

```
final DefaultTableCellRenderer centerRenderer = new DefaultTableCellRenderer();
centerRenderer.setHorizontalAlignment(DefaultTableCellRenderer.CENTER); 
final DefaultTableCellRenderer rightRenderer = new DefaultTableCellRenderer();
rightRenderer.setHorizontalAlignment(DefaultTableCellRenderer.RIGHT); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:32:39.640

请参阅[表格行渲染](http://tips4java.wordpress.com/2010/01/24/table-row-rendering/)。

这将允许您在一个位置更改对齐方式，即使您的表格使用多个渲染器并且无需创建自定义渲染器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:54:38.990

您必须稍微调整渲染器并覆盖其`getTableCellRendererComponent`方法。就像是：

```
DefaultTableCellRenderer 渲染器 = 新 DefaultTableCellRenderer() {
    public Component getTableCellRendererComponent(JTable 表，对象值，
            boolean isSelected, boolean hasFocus, int row, int column) {
        如果 (r % 2 == 0) {
            setHorizo​​ntalAlignment(SwingConstants.LEFT);
        }
        别的 {
            setHorizo​​ntalAlignment(SwingConstants.RIGHT);
        }
        return super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
    }
};

```

`DefaultTableCellRenderer`尽管创建您自己的扩展并执行此操作的适当类将是一种更好的方法。

# android - 在android中使用ffmpeg时出现乱码

> ID：15114570
> 
> 赞同：0
> 
> 时间：2013-02-27T14:29:58.490
> 
> 标签：android, android-ndk, ffmpeg

我正在尝试将音频文件解码为 PCM 以与 AudioTrack 一起使用。音频是吱吱作响的，嘈杂的，只是简单的胡言乱语，随机的一秒钟听起来应该是这样，但主要是完全混乱。我不确定我的错误在哪里，是数组如何传递回 playSound 吗？

提前谢谢你，我真的很感谢你在这件事上的帮助，因为它已经让我很恼火了一段时间。

这是我的java代码：

```
public void init() {
int bufSize = AudioTrack.getMinBufferSize(44100, 
                AudioFormat.CHANNEL_OUT_STEREO,  
                AudioFormat.ENCODING_PCM_16BIT); 

        track = new AudioTrack(AudioManager.STREAM_MUSIC,  
        44100,  
        AudioFormat.CHANNEL_OUT_STEREO,  
        AudioFormat.ENCODING_PCM_16BIT,  
        bufSize, 
        AudioTrack.MODE_STREAM); 
        log("STARTING!!! _________________________ <--");

        byte[] array = new byte[bufSize];

        try {

            fos  = new FileOutputStream("/sdcard/acdc.bin");

        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        decoder("/sdcard/acdc.ogg", array); 
}

void playSound(byte[] buf, int size) {   

    try {
        fos.write(buf, 0, size);
    } catch (IOException e) {
        e.printStackTrace();
    }
    if(track.getPlayState()!=AudioTrack.PLAYSTATE_PLAYING) {   
        track.play();                       
    }
    int wrote =  track.write(buf, 0, size);
    if (wrote != size)
        log("WRITING: " + wrote  + " but size was: " + size); 
} 
```

这是我的 c 函数：

```
void Java_com_example_ffmpegsample_MainActivity_decoder(JNIEnv* env, jobject obj,jstring file,jbyteArray array)
    {
        jboolean            isfilenameCopy;
        const char *        filename = (*env)->GetStringUTFChars(env, file, &isfilenameCopy);
        AVCodec *codec;
        AVCodecContext *c= NULL;
        AVFormatContext *pFormatCtx;
        AVCodecContext *pCodecCtx;

        int out_size, len;
        FILE *f, *outfile;
        uint8_t *outbuf;
        uint8_t inbuf[AUDIO_INBUF_SIZE + FF_INPUT_BUFFER_PADDING_SIZE];
        AVPacket avpkt;
        LOGI("HERE");
        jclass              cls = (*env)->GetObjectClass(env, obj);
        LOGI(cls);
        jmethodID           play = (*env)->GetMethodID(env, cls, "playSound", "([BI)V");//At the begining of your main function

        av_init_packet(&avpkt);

        av_register_all();
        LOGI("AUDIO DECODER");
        printf("Audio decoding\n");
        int err;
        err = av_open_input_file(&pFormatCtx, filename, NULL, 0, NULL);
        if (err!=0) {
            LOGI("COULD NOT AV_OPEN file");
            return;
        }
        if(av_find_stream_info(pFormatCtx)<0) {
                LOGE("Unable to get stream info");
                return;
        }
        int audioStream = -1;
        int i;

        for (i=0; i<pFormatCtx->nb_streams; i++) {
                if(pFormatCtx->streams[i]->codec->codec_type==CODEC_TYPE_AUDIO) {
                    audioStream = i;
                    break;
                }
            }
            if(audioStream==-1) {
                LOGE("Unable to find audio stream");
                return;
            }
        LOGI("Audio stream is [%d]", audioStream);

        pCodecCtx=pFormatCtx->streams[audioStream]->codec;
        codec = avcodec_find_decoder(pCodecCtx->codec_id);
        /* find the mpeg audio decoder */
       // codec = avcodec_find_decoder(CODEC_ID_AAC);
        if (!codec) {
            LOGI("NO CODEC");
            fprintf(stderr, "codec not found\n");
            return;
        }

        //c= avcodec_alloc_context();
        c = pCodecCtx;

        /* open it */
        if (avcodec_open(c, codec) < 0) {
            fprintf(stderr, "could not open codec\n");
            LOGI("NOT LOADING CODEC");
            return;
        }

        outbuf = malloc(AVCODEC_MAX_AUDIO_FRAME_SIZE);

        f = fopen(filename, "rb");
        if (!f) {
            fprintf(stderr, "could not open %s\n", filename);
            LOGI("COULD NOT OPEN FILE");
            return;
        }

        /* decode until eof */
        avpkt.data = inbuf;
        avpkt.size = fread(inbuf, 1, AUDIO_INBUF_SIZE, f);

        while (avpkt.size > 0) {
            LOGI("............................." + avpkt.size);
            out_size = AVCODEC_MAX_AUDIO_FRAME_SIZE;
            len = avcodec_decode_audio3(c, (short *)outbuf, &out_size, &avpkt);
            if (len < 0) {
                fprintf(stderr, "Error while decoding\n");
                LOGI("ERROR DECODING, error: %d", len);
                return;
            }
            if (out_size > 0) {
                /* if a frame has been decoded, output it */
                jbyte *bytes = (*env)->GetByteArrayElements(env, array, NULL);
                memcpy(bytes, outbuf, out_size); //
                (*env)->ReleaseByteArrayElements(env, array, bytes, 0);
                (*env)->CallVoidMethod(env, obj, play, array, out_size);

            }
            avpkt.size -= len;
            avpkt.data += len;
            if (avpkt.size < AUDIO_REFILL_THRESH) {
                /* Refill the input buffer, to avoid trying to decode
                 * incomplete frames. Instead of this, one could also use
                 * a parser, or use a proper container format through
                 * libavformat. */
                memmove(inbuf, avpkt.data, avpkt.size);
                avpkt.data = inbuf;
                len = fread(avpkt.data + avpkt.size, 1,
                            AUDIO_INBUF_SIZE - avpkt.size, f);
                if (len > 0)
                    avpkt.size += len;
            }
        }

        fclose(f);
        free(outbuf);

        avcodec_close(c);
        av_free(c);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:21:29.443

您在 Streaming 模式下使用最小大小缓冲区创建 AudioTrack。可能是如果它正在转换一些数据，然后写入一些在音频播放中发生间隙的数据。如果转换必须继续从 SD 卡读取，则尤其如此。您可以增加 AudioTrack 缓冲区的大小以查看这是否是一个因素。

另外，我不确定，但我认为 avcodec_decode_audio3 可能会将 &out_size 设置为短裤的大小，但这会以字节大小的形式发送到 AudioTrack。（不只是检查 API 及其字节）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:51:27.717

您是否尝试过像这个[项目](https://github.com/guardianproject/android-ffmpeg)一样在 android 中使用纯 CLI 界面？您可以使用一个简单的 fileProcesssor 接口：IN=ogg OUT=raw-pcm

请参阅下面的 CLI 将 .ogg 转换为 PCM 格式。然后对输出做任何事情

```
 rob@ Downloads$ ffmpeg -i Example.ogg -f s16le -acodec pcm_s16le output.raw

ffmpeg version N-35901-g27a3415 Copyright (c) 2000-2012 the FFmpeg developers
  built on Oct  7 2012 12:06:43 with gcc 4.6 (Ubuntu/Linaro 4.6.3-1ubuntu5)
  configuration: --enable-gpl --enable-libfaac --enable-libfdk-aac --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-librtmp --enable-libtheora --enable-libvorbis --enable-libvpx --enable-x11grab --enable-libx264 --enable-nonfree --enable-version3
  libavutil      51\. 73.102 / 51\. 73.102
  libavcodec     54\. 64.100 / 54\. 64.100
  libavformat    54\. 29.105 / 54\. 29.105
  libavdevice    54\.  3.100 / 54\.  3.100
  libavfilter     3\. 19.102 /  3\. 19.102
  libswscale      2\.  1.101 /  2\.  1.101
  libswresample   0\. 16.100 /  0\. 16.100
  libpostproc    52\.  1.100 / 52\.  1.100
[NULL @ 0x186b840] Invalid packet
Input #0, ogg, from 'Example.ogg':
  Duration: 00:00:06.10, start: 0.000000, bitrate: 137 kb/s
    Stream #0:0: Audio: vorbis, 44100 Hz, stereo, s16, 160 kb/s
Output #0, s16le, to 'output.raw':
  Metadata:
    encoder         : Lavf54.29.105
    Stream #0:0: Audio: pcm_s16le, 44100 Hz, stereo, s16, 1411 kb/s
Stream mapping:
  Stream #0:0 -> #0:0 (vorbis -> pcm_s16le)
Press [q] to stop, [?] for help
size=    1054kB time=00:00:06.11 bitrate=1411.2kbits/s    
video:0kB audio:1054kB subtitle:0 global headers:0kB muxing overhead 0.000000% 
```

这假设您可以使用 OGG LIB 依赖项为 android 配置/制作 ffmpeg，这可能是一个棘手的过程......

# ios - iPad Safari 上的 localStorage 是否保证是持久的？

> ID：15114571
> 
> 赞同：14
> 
> 时间：2013-02-27T14:29:58.397
> 
> 标签：ios, html, ipad, safari, persistence

我在网上看到了对此的不同意见。据说从 iOS 5.1 开始，iPad 上 HTML5 内容的本地数据存储不再保证是持久的，但是在 Apple 当前的 Safari 开发者页面上 ( [https://developer.apple.com/technologies/safari/html5 .html](https://developer.apple.com/technologies/safari/html5.html) )，建议保证离线持久化。

有没有人最近对这个主题有任何经验并且能够评论 HTML5 的数据库功能在 iPad 上的 Safari 上的可靠性？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-30T16:25:32.273

### 这可能是足够的信息：

w3c 规范`localStorage`是：

> 第二种存储机制（*注意：localStorage*）是为跨多个窗口的存储而设计的，并且**持续时间超过当前会话**。特别是，出于性能原因，Web 应用程序可能希望在客户端存储数兆字节的用户数据，例如整个用户创作的文档或用户的邮箱。

在 Apple 页面上：

> Safari 支持最新的 HTML5 离线数据存储功能。您的应用程序可以使用简单的基于键/值的数据存储或强大的 SQL 数据库将其信息存储在本地机器上。数据存储在本地**，并在 Safari 启动时持续存在，**因此您的应用程序无需网络连接即可访问数据，从而缩短启动时间和整体性能。

搜索谷歌（和雅虎！因为一些反谷歌怪胎）给了我：

> **在 iOS 5.1**中，Apple 已将 localStorage 文件的位置移动到 Caches 文件夹**中，该文件夹会根据操作系统的要求进行偶尔清理**，通常是在空间不足的情况下。Apple 这样做很可能是为了阻止将 localStorage 备份到 iCloud。

[在 IOS-6 Safari 中无法访问 localStorage](https://stackoverflow.com/questions/13208878/localstorage-not-accessible-in-ios-6-safari)

> 我无法在**Safari（带有 IOS-6 的 iPad）**中访问 localStorage 。例如，以下代码在所有浏览器和（带有 iOS-5 的 iPad）上的 Windows 中都可以正常工作，但在 iOS-6 中却不行： localStorage.setItem("var","5"); 警报（localStorage.getItem（“var”））；

回答：

> **我可以通过关闭**iPad 上的隐私浏览来解决这个问题。我从参考中找到了解决方案：[https ://github.com/cloudhead/less.js/issues/312#issuecomment-2994845](https://github.com/cloudhead/less.js/issues/312#issuecomment-2994845)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-21T10:51:17.617

是的，当设备的存储空间不足时，Apple 会清理本地存储。（我实际上对此进行了测试并确定地确认了它）。

# c++ - C++ 强制转换语法

> ID：15114573
> 
> 赞同：1
> 
> 时间：2013-02-27T14:30:01.237
> 
> 标签：c++, casting

我从未见过以下强制转换语法：

> int var = int(1.0);

int 是一个基本类型，所以我想知道：它是否等同于

> int var = (int)1.0;

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:30:54.093

这两个符号是等价的（在原始类型的情况下）。只是一个旁注：请使用 static_cast`c++`代替 C 风格的转换。在这里没有太大区别，但这是一个坏习惯。

对于复杂类型，第一个将调用构造函数，而第二个将调用强制转换运算符，因此它们可能具有完全不同的逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:31:54.827

第一个调用是构造函数调用。第二个是强制转换。它们基本相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:39:50.477

这两种解决方案在语法上都是正确的，并且是显式类型转换的等效方法。 [http://www.cplusplus.com/doc/tutorial/typecasting/](http://www.cplusplus.com/doc/tutorial/typecasting/)

# jquery - 多个 jQuery 加载会破坏插件

> ID：15114579
> 
> 赞同：0
> 
> 时间：2013-02-27T14:30:12.773
> 
> 标签：jquery, jquery-plugins, plugins

来自客户端的多个 jquery 加载中断插件

在这里做了一个 jsbin - [http://jsbin.com/useyis/5/edit](http://jsbin.com/useyis/5/edit)

让我们解决这个问题

```
var $customname = jQuery.noConflict(); 
```

然后打电话

```
$customname('div').yourpluginname 
```

工作，但它不是一个解决方案，因为它会破坏其他插件使用`$`而不是`jQuery`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T14:20:15.167

经过几次测试，我想出了这个

我们在 window 对象上保存一个函数，然后用缓存的 jquery 对象调用它

解决方案 - [http://jsbin.com/useyis/14/edit](http://jsbin.com/useyis/14/edit)

# mysql - MYSQL 选择计数关系除法

> ID：15114581
> 
> 赞同：1
> 
> 时间：2013-02-27T14:30:22.220
> 
> 标签：mysql, sql, relational-division

我在 mysql ![在此处输入图像描述](../Images/6f0e63ff37214601386ed6dc7631036e.png) 1 中有这个表。是否可以选择一个计数 - ALL 相同 entity_id where field_tags_tid=2 and field_tags_tid=7

在此示例中，结果将为 1，因为只有 entity_id=6 匹配 field_tags_tid=2 和 field_tags_tid=7

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:32:02.687

这个问题通常被称为`Relational Division`

```
SELECT  entity_ID
FROM    tableName
WHERE   field_tags_ID IN (2,7)
GROUP   BY entity_ID
HAVING  COUNT(*) = 2 
```

如果没有对`field_tags_ID`每个强制执行唯一性，则需要`entity_ID`一个`DISTINCT`关键字。否则，保持原样，

```
SELECT  entity_ID
FROM    tableName
WHERE   field_tags_ID IN (2,7)
GROUP   BY entity_ID
HAVING  COUNT(DISTINCT field_tags_ID) = 2 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/b42da/2)
*   [关系划分的SQL](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)

**更新 1**

```
SELECT  COUNT(*) totalCOunt
FROM
(
    SELECT  entity_ID
    FROM    tableName
    WHERE   field_tags_tid IN (2,7)
    GROUP   BY entity_ID
    HAVING  COUNT(DISTINCT field_tags_tid) = 2
) s 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/b42da/8)

# asp.net-mvc-3 - 来自 ModelState 的错误消息未本地化

> ID：15114582
> 
> 赞同：1
> 
> 时间：2013-02-27T14:30:22.937
> 
> 标签：asp.net-mvc-3, localization, globalization, modelstate

我正在 mvc4 中开发一个应用程序。我希望该应用程序可以用英语和俄语工作。我的标题是俄语，但错误消息仍然是英语。

我的模型包含：-

```
 [Required(ErrorMessageResourceType = typeof(ValidationStrings),
              ErrorMessageResourceName = "CountryNameReq")]            
    public string CountryName { get; set; } 
```

if(ModelState.IsValid) 变为 false 它将转到 GetErrorMessage()

```
public string GetErrorMessage()
    {  
       CultureInfo ci = new CultureInfo(Session["uiCulture"].ToString());

        System.Threading.Thread.CurrentThread.CurrentUICulture = ci;

        System.Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(ci.Name);          
    string errorMsg = string.Empty;
    int cnt = 1;
    var errorList = (from item in ModelState
                   where item.Value.Errors.Any()
                   select item.Value.Errors[0].ErrorMessage).ToList();                                                 

        foreach (var item in errorList)
        {
            errorMsg += cnt.ToString() + ". " + item + "</br>";
            cnt++;
        }
        return errorMsg;
    } 
```

但我总是收到英文错误消息。如何自定义代码以获取当前文化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:07:06.417

原因是你设置文化太晚了。您在控制器操作中设置它，但是模型绑定器添加的验证消息比您的控制器操作开始执行要早得多。在那个阶段，当前的线程文化仍然是默认的。

为此，您应该在执行管道中更早地设置文化。例如，您可以`Application_BeginRequest`在您的方法中执行此操作`Global.asax`

就像这样：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    CultureInfo ci = new CultureInfo(Session["uiCulture"].ToString());
    System.Threading.Thread.CurrentThread.CurrentUICulture = ci;
    System.Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(ci.Name);
} 
```

# salesforce - 在 apex salesforce 中按名称获取字段的值

> ID：15114586
> 
> 赞同：2
> 
> 时间：2013-02-27T14:30:36.340
> 
> 标签：salesforce, apex-code, soql

在我的 visualforce 页面中，我有一些活动对象，首先用户选择一个对象，然后有一个多选项列表。在这个选项列表中，所有字段都有标签，用户选择一些字段然后我必须在所选活动对象中显示这些字段的值以显示多个选项列表我的顶点功能是

```
 public List<SelectOption> getOptionalFields(){

   Map <String, Schema.SObjectField> fieldMap= Campaign.sObjectType.getDescribe().fields.getMap();
       List<SelectOption> fieldsName =new List<SelectOption>();

   for(Schema.SObjectField sfield : fieldMap.Values())
{
schema.describefieldresult dfield = sfield.getDescribe();
fieldsName.add(new SelectOption(dfield.getName(),dfield.getLabel()));

} 
```

但我不知道如何显示该字段的值，例如我有像这样的对象实例

```
Campaign c; 
```

现在我必须获取名称为字符串形式的任何字段的值。如何为该字段获取相应的值。一个解决方案就是这样写

```
String fieldName; 
```

并使用多个 if

```
if(fieldName=='Name')
c.Name=
if(fieldName=='Id')
c.Id= 
```

还有其他方便的方法吗？请解释一下！！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T15:02:11.713

您需要阅读“动态顶点”。每个“具体”sObject（如 Account、Contact、自定义对象）都可以转换为通用 sObject（或者您可以直接使用这些[方法](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_methods_system_sobject.htm)）。

```
Object o = c.get(fieldName);
String returnValue = String.valueOf(o); 
```

在 Salesforce 专用站点上有一些关于动态`get`和方法的有用示例： [https ://salesforce.stackexchange.com/questions/8325/retrieving-value-using-dynamic-soql](https://salesforce.stackexchange.com/questions/8325/retrieving-value-using-dynamic-soql) [https://salesforce.stackexchange.com/questions/ 4193/update-a-records-using-generic-fields](https://salesforce.stackexchange.com/questions/4193/update-a-records-using-generic-fields)（第二个问题更高级一些）`set`

您仍然需要以某种方式决定何时将其返回为字符串、何时返回为数字、何时返回...只需尝试一下，然后进行一些简单的映射或使用描述方法来了解实际的字段类型...

# c++ - gdb 和 STL 列表的调试问题

> ID：15114588
> 
> 赞同：0
> 
> 时间：2013-02-27T14:30:40.287
> 
> 标签：c++, list, stl, gdb, segmentation-fault

我最近在这里问了一个问题，但没有得到我可以使用的答案，不幸的是：

[C++ STL 列表函数使用空列表进行段错误](https://stackoverflow.com/questions/14899678/c-stl-list-functions-segfaulting-with-empty-list)

我一直在尝试使用 gdb 来调试问题，但我对某事的含义有疑问：

我将一个列表声明为一个类的成员，如下所示：

```
std::list<Thing*> inventory; 
```

...然后实例化它所在的类（一个名为“pc”的对象）。在 gdb 中，我认为这表明我分配了一些内存？

```
(gdb) p &pc.inventory
$7 = (std::list<Thing*, std::allocator<Thing*> > *) 0xbffff22c 
```

此外，在代码问题行之前的一行（本质上，调用 'inventory.size()' 会导致段错误），这仍然成立：

```
(gdb) p &inventory
$8 = (std::list<Thing*, std::allocator<Thing*> > *) 0xbffff22c 
```

...但是我仍然得到段错误：

```
(gdb) n
558   if (inventory.size() == 52) {
(gdb) n

Program received signal SIGSEGV, Segmentation fault.
0x0804e3fe in std::_List_const_iterator<Thing*>::operator++ (this=0xbfff94e0)
at /usr/include/c++/4.4/bits/stl_list.h:223
223     _M_node = _M_node->_M_next; 
```

我的问题本质上是这样的：当然，如果我有成员列表的地址，则该列表存在，我应该能够在其上使用 size() 吗？如果不是，为什么不呢？我该如何进一步调试？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:31:54.907

要调试内存错误，我建议您在 valgrind 中运行该程序

> valgrind --tool=memcheck program_name

并修复 valgrind 指出的所有错误

# ruby-on-rails-3 - 测试遗忘变量中的每个循环

> ID：15114593
> 
> 赞同：0
> 
> 时间：2013-02-27T14:30:58.067
> 
> 标签：ruby-on-rails-3, testing, loops

我在测试我的 rails 应用程序时遇到问题。我有我的测试代码：

```
describe Categoria do

  let(:categoria) { FactoryGirl.create(:categoria) }

  it { should be_valid }

  describe "agregar campos" do
    before { @campo = categoria.campos.build(nombre: "campo1", tipo_campo: "check_box") }

    it { @campo.should be_valid }
    it { @campo.should respond_to :nombre }
    it { @campo.should respond_to :tipo_campo }
    it { @campo.should respond_to :requerido }

    describe "valores válidos" do
      valores = %w[texto texto_extenso numero decimal check_box]
      valores.each do |valido|
        @campo.tipo_campo = valido
        @campo.should be_valid
      end    
    end
  end
end 
```

如果我在没有“valores válidos”块的情况下运行测试并且所有其他测试都通过，但是当我运行所有测试时，我会收到此错误：

```
Rack::File headers parameter replaces cache_control after Rack 1.5.
Exception encountered: #<NoMethodError: undefined method `tipo_campo=' for nil:NilClass>
backtrace:
/home/alejo/proyectos/lachiquitienda/spec/models/categoria_spec.rb:38:in `block (4 levels) in <top (required)>'
/home/alejo/proyectos/lachiquitienda/spec/models/categoria_spec.rb:37:in `each'
/home/alejo/proyectos/lachiquitienda/spec/models/categoria_spec.rb:37:in `block (3 levels) in <top (required)>'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:238:in `module_eval'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:238:in `subclass'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:224:in `describe'
/home/alejo/proyectos/lachiquitienda/spec/models/categoria_spec.rb:35:in `block (2 levels) in <top (required)>'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:238:in `module_eval'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:238:in `subclass'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:224:in `describe'
/home/alejo/proyectos/lachiquitienda/spec/models/categoria_spec.rb:27:in `block in <top (required)>'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:238:in `module_eval'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:238:in `subclass'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/example_group.rb:224:in `describe'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/dsl.rb:18:in `describe'
/home/alejo/proyectos/lachiquitienda/spec/models/categoria_spec.rb:5:in `<top (required)>'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `block in load'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `block in load_spec_files'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `map'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load_spec_files'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:22:in `run'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/test_framework/rspec.rb:11:in `run_tests'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:13:in `block in run'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/forker.rb:21:in `block in initialize'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/forker.rb:18:in `fork'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/forker.rb:18:in `initialize'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:9:in `new'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/run_strategy/forking.rb:9:in `run'
/home/alejo/.rvm/gems/ruby-1.9.3-p374/gems/spork-0.9.2/lib/spork/server.rb:48:in `run'
/home/alejo/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/drb/drb.rb:1548:in `perform_without_block'
/home/alejo/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/drb/drb.rb:1508:in `perform'
/home/alejo/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/drb/drb.rb:1586:in `block (2 levels) in main_loop'
/home/alejo/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/drb/drb.rb:1582:in `loop'
/home/alejo/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/drb/drb.rb:1582:in `block in main_loop'
[Finished in 5.9s] 
```

为什么@campo nil 在每个循环中？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:34:00.140

因为当您尝试访问它时，您不在测试的上下文中。

您的所有其他测试都标有`it { }`块（rspec 也将接受`specify { }`块） - 您的循环没有定义任何测试。

尝试以下操作：

```
describe "valores válidos" do
  valores = %w[texto texto_extenso numero decimal check_box]
  valores.each do |valido|
    it "allows the value #{valido}" do # put your own translation in here!
      @campo.tipo_campo = valido
      @campo.should be_valid
    end
  end    
end 
```

现在您的分配在测试内部，并且`@campo`将定义变量。

# javascript - 使用 jQuery / Javascript 提交表单而不忽略“必需”标签

> ID：15114594
> 
> 赞同：3
> 
> 时间：2013-02-27T14:30:58.600
> 
> 标签：javascript, jquery, forms, required

所以我有以下表格：

```
 <form action="register.php" method="post" id="register-form" name="register-form">
    <input type="text" id="username" name="username" placeholder="Username" autofocus="autofocus" required />
    <input type="text" id="password" name="password" placeholder="Password" required />
    <a href="javascript:void(0);" class="btn" onclick="$('#register-form').submit();">Register</a>
    <input type="submit" style="display: none;" />
    </form> 
```

我想知道的是，有没有办法让 jQuery 在提交表单时处理“必需”标签？现在它没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:36:15.150

而是触发`click`提交按钮。

[http://jsfiddle.net/PdUcq/](http://jsfiddle.net/PdUcq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:37:12.993

从这个[链接](http://html5doctor.com/html5-forms-introduction-and-new-attributes/#required)，

required 属性适用于大多数新浏览器。在较旧的浏览器中，它不被支持，因为它是 HTML5 规范的一部分。

如果您正在寻找 jquery 的跨浏览器支持，则必须使用一些插件。一个好的是[这个插件](http://docs.jquery.com/Plugins/Validation)。

或者您可以继续编写自己的自定义验证器，但为什么要重新发明轮子。

# object - 核心数据更新方法令人困惑

> ID：15114603
> 
> 赞同：0
> 
> 时间：2013-02-27T14:31:11.887
> 
> 标签：object, core-data

我想为我的核心数据类实现更新方法，但是有问题。

```
-(BOOL)updateFromObject:(NSPredicate *)_find ToDesire:(NSPredicate *)_desire {

    NSFetchRequest *request = [[NSFetchRequest alloc]init];
    [request setEntity:entitydescription];
    [request setPredicate:_find];
    NSError *error = nil;
    NSArray *matchData = [context executeFetchRequest:request error:&error];
    if (matchData.count <=0) {
        NSLog(@"Nothing to do");
        return NO;
    }
    else {
        for (NSManagedObject *obj in matchData) {
            /*
            this is my problem
            how could i update my _desire to my object 
            */
        }
        [context save:&error];
        return YES;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:47:01.713

最后我做到了。

```
-(BOOL)updateFromObject:(NSPredicate *)_find withNewData:(NSDictionary *)_data {
    NSFetchRequest *request = [[NSFetchRequest alloc]init];
    [request setEntity:entitydescription];
    [request setPredicate:_find];
    NSError *error = nil;
    NSArray *matchData = [context executeFetchRequest:request error:&error];
    if (matchData.count <=0) {
        NSLog(@"Nothing to update");
        return NO;
    }
    else {
        for (NSManagedObject *obj in matchData) {
            //obj = [[NSManagedObject alloc]];
            [obj setValuesForKeysWithDictionary:_data];
        }
        [context save:&error];
        return YES;
    }
} 
```

# pentaho - Pentaho：如何将字段（= 列）动态添加到 OutputRow？

> ID：15114604
> 
> 赞同：7
> 
> 时间：2013-02-27T14:31:12.043
> 
> 标签：pentaho, kettle

我想在 Kettle 的结果输出行中动态添加字段（或新列）。

在花了几个小时阅读来自帖子并且他的脚本文档做得不太好之后，我想知道 Stackoverflow 是否会有所帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-03T10:45:05.133

我们可以使用以下步骤来生成动态列生成：

1.  计算器
2.  添加常量。
3.  在表输入中选择必填字段并将这些值分配为设置变量和第二个转换级别使用 get variables hop

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T07:08:23.023

您的输入值是如何传递给 SQL 查询的？如果它们是变量，那么只需将表输入步骤传递给“获取变量”步骤并以这种方式获取新列。

或者，您可以使用计算器添加列或添加常量。

或者您甚至可以使用“获取系统信息”步骤来获取命令行参数和日期等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:28:46.803

首先，让我给你一个我在用户定义的 Java 类步骤中的代码片段：

```
private int fieldToHashGeoIndex;
private int fieldToHashHeadIndex;

public boolean processRow(StepMetaInterface smi, StepDataInterface sdi) throws KettleException 
{
  Object[] r=getRow();
  if (r==null)
  {
    setOutputDone();
        return false;
  }

  if (first) {
     fieldToHashGeoIndex = getInputRowMeta().indexOfValue(getParameter("FIELD_TO_HASH_GEO"));
     if (fieldToHashGeoIndex<0) {
         throw new KettleException("Field to hash not found in the input row, check parameter 'FIELD_TO_HASH_GEO'!");
     }
     fieldToHashHeadIndex = getInputRowMeta().indexOfValue(getParameter("FIELD_TO_HASH_HEAD"));
     if (fieldToHashHeadIndex<0) {
         throw new KettleException("Field to hash not found in the input row, check parameter 'FIELD_TO_HASH_HEAD'!");
     }

     first=false;
  }

  Object[] outputRowData = RowDataUtil.resizeArray(r, data.outputRowMeta.size());
  int outputIndex = getInputRowMeta().size();

  String fieldToHashGeo = getInputRowMeta().getString(r, fieldToHashGeoIndex);
  String fieldToHashHead = getInputRowMeta().getString(r, fieldToHashHeadIndex);
  outputRowData[outputIndex++] = MurmurHash.hash64(fieldToHashGeo);
  outputRowData[outputIndex++] = MurmurHash.hash64(fieldToHashHead);

  putRow(data.outputRowMeta, outputRowData);

  return true;
} 
```

现在，通常您`outputRowMeta`从步骤的配置中进行配置，但也许您可以在代码中对其进行修改。这应该允许您在代码中指定其他字段。

作为替代方案，您可以通过在“field1”、“field2”等步骤上定义固定输出字段并在其他地方跟踪字段名称来锁定可变字段。您可能必须创建 String 类型的所有字段，然后再进行自己的类型调整。

现在我想起来了，可变的输出字段可能会导致麻烦：您必须非常小心您在后面的步骤中所做的事情，以避免由于类型不匹配或缺少字段而导致错误。

# c# - 多页asp.net中的db连接

> ID：15114605
> 
> 赞同：0
> 
> 时间：2013-02-27T14:31:11.457
> 
> 标签：c#, asp.net, database-connection, connection-string

我的 npgsql 连接到数据库时遇到问题。关键是我的应用程序根据 db 验证用户。如果成功则重定向到下一页并显示 SQL 查询。当站点被重定向并尝试读取查询时，异常显示：连接未打开。任何人都可以帮助我吗？

```
string connectionString =
"Server=serverName;" +
"Database=dbName;" +
"User ID=" + strUsername + ";" +
"Password=" + strPassword + ";" +
"Port=portNo;";

NpgsqlConnection dbcon;
dbcon = new NpgsqlConnection(connectionString);
dbcon.Open(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:20:00.233

您似乎正在尝试重用无法从不同位置访问的代码。这将是我的方法。

创建一个通用数据访问器。创建一个`App_Data`名为`DataAccessor`. 这是一个您要在其中使用它的**每个页面初始化和调用的类。**

```
public class DataAcessor
{
    private _connectionString;

    public DataAcessor(string connectionString)
    {
        _connectionString = connectionString;
    }

    public bool ValidateUser(string username, string password)
    {
        //code to call database for validation only, returns true or false
    }

    public string GetUserName(int userID) //or some other call to the database
    { }
} 
```

现在在**每一**页上，创建一个新的类对象并使用它。除非您使用 Session 变量，否则您不能依赖其他页面的数据。

```
DataAccessor da = new DataAccessor("<some conn string>");
da.ValidateUser("joe", "asdf"); 
```

在您的第二页上：

```
DataAccessor da = new DataAccessor("<some conn string>");
da.GetUserId(123); 
```

# sql - PHP我的管理员在致命错误后不再工作

> ID：15114607
> 
> 赞同：1
> 
> 时间：2013-02-27T14:31:12.590
> 
> 标签：sql, phpmyadmin

PHP 我的管理员不再工作了.. 这是错误：

> 致命错误：第 96 行 C:\wamp\apps\phpmyadmin3.5.1\libraries\session.inc.php 中的最大执行时间超过 100 秒

我正在运行 70.000 行的查询，但他加载了很长时间。现在关闭我的浏览器并尝试再次启动 phpmyadmin。但现在我不能再启动 phpmyadmin 了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:40:49.353

如果 phpmyadmin 不再响应，则查询可能仍在运行并阻止您的连接。如果可能，请尝试通过控制台进行连接*，然后执行以下操作：

```
mysql> SHOW PROCESSLIST; 
```

这将向您显示哪些进程仍在运行，它们已经运行了多长时间，最重要的是，它们的 id。如果您看到之前的怪物查询，请杀死它：

```
mysql> KILL QUERY 123; 
```

*) 如果您没有控制台访问权限，您也可以尝试从另一个浏览器打开 phpMyAdmin 并在那里运行命令。

# c++ - 带有 uEye 相机的 OpenCV

> ID：15114608
> 
> 赞同：2
> 
> 时间：2013-02-27T14:31:15.493
> 
> 标签：c++, qt, opencv, ueye

我需要将 OpenCV 与 uEye 以太网摄像机一起使用。问题是我没有找到一些关于一些示例代码的有用提示。

安装时提供的源代码确实链接到 MFC 的东西，这不是我想要的。摆脱它真的很复杂，它给我带来了很多问题（CWnd，Afx，Dialogs......）

我想从相机中读取一些帧并记录一些快照。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-06-12T20:56:00.243

您可以在此处找到完整的 SDK 描述：[https ://en.ids-imaging.com/manuals-ueye-software.html](https://en.ids-imaging.com/manuals-ueye-software.html)

只需简单地制作和帐户，您就可以访问它。文档真的很好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-27T15:00:07.260

我在网上找到了这份文件

[http://master-ivi.univ-lille1.fr/fichiers/Cours/uEye_SDK_manual_enu.pdf](http://master-ivi.univ-lille1.fr/fichiers/Cours/uEye_SDK_manual_enu.pdf)

# apache-flex - flex 4.6 pom 文件依赖没有解决

> ID：15114613
> 
> 赞同：5
> 
> 时间：2013-02-27T14:31:32.360
> 
> 标签：apache-flex, maven, flash-builder, pom.xml, flex4.6

我正在尝试将 flex 4.6 项目转换为 maven 以下是我的 pom.xml

```
 <build>
        <sourceDirectory>src</sourceDirectory>

        <plugins>

          <plugin>
            <groupId>org.sonatype.flexmojos</groupId>
            <artifactId>flexmojos-maven-plugin</artifactId>
            <version>4.0-RC2</version>
            <extensions>true</extensions>
            <dependencies>
              <dependency>
                <groupId>com.adobe.flex</groupId>
                <artifactId>compiler</artifactId>
                <version>4.6.0.23201</version>
                <type>pom</type>
              </dependency>
            </dependencies>
            <executions>
              <execution>
                <goals>
                  <goal>wrapper</goal>
                </goals>
                <configuration>
                  <parameters>
                    <swf>${build.finalName}</swf>
                    <width>100%</width>
                    <height>100%</height>
                  </parameters>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>

      <dependencies>
        <dependency>
          <groupId>com.adobe.flex.framework</groupId>
          <artifactId>flex-framework</artifactId>
          <version>4.6.0.23201</version>
          <type>pom</type>
        </dependency>
      </dependencies>

  <repositories>
    <repository>
      <id>flexmojos</id>
      <url>http://repository.sonatype.org/content/groups/flexgroup/</url>
    </repository>
  </repositories> 
```

我得到的错误如下：

> [错误] com.adobe:gDash-main-maven:1.0-SNAPSHOT (C:\\pom.xml) 项目有 1 个错误 [错误] 无法解决的构建扩展：插件 com.adobe.flex.compiler:batik-all- flex:4.6.0.23201 或其依赖项之一无法解析：无法解析以下工件：com.adobe.flex.compiler:batik-all-flex:jar :4.6.0.23201, com.adobe.flex:compiler :pom:4.6.0.23201: 在中央找不到工件 com.adobe.flex.compiler:batik-all-flex:jar:4.6.0.23201 ( [http://repo.ma](http://repo.ma)ven.apache.org/maven2) -> [Help 2] org.apache.maven.plugin.PluginResolutionException: Plugin com.adobe.flex.compile r:batik-all-flex:4.6.0.23201 或其依赖项之一不能已解决：无法解决以下工件：com.adobe.flex.compiler:batik-all-flex:jar:4.6.0.23201, com.adobe.flex:compiler:pom:4.6.0.23201: 找不到 ar tifact com.adobe.flex.compiler:batik-all-flex:jar:4.6.0.23201 在中央 ( [http://repo.maven.apache.org/maven2](http://repo.maven.apache.org/maven2) )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T11:43:04.533

我也面临同样的问题。将此添加到您的`pom.xml`文件中（`<repositories>...</repositories>`例如之后）：

```
<pluginRepositories>
    <pluginRepository>
        <id>flex-mojos-plugin-repository</id>
       <url>http://repository.sonatype.org/content/groups/flexgroup</url>
        <releases>
            <enabled>true</enabled>
        </releases>
        <snapshots>
            <enabled>false</enabled>
        </snapshots>
    </pluginRepository>
</pluginRepositories> 
```

为我解决了:)

一些 IDE 将生成一个 POM 文件，该文件已经包含此插件存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:38:43.453

如果你浏览 repo，你会看到

[http://repository.sonatype.org/content/groups/flexgroup/com/adobe/flex/framework/flex-framework/](http://repository.sonatype.org/content/groups/flexgroup/com/adobe/flex/framework/flex-framework/)

版本 4.6.0.23201 不存在，而是版本 4.6.b.23201

# powershell - 动态参数访问默认值

> ID：15114615
> 
> 赞同：3
> 
> 时间：2013-02-27T14:31:37.447
> 
> 标签：powershell, optional-parameters, strict-mode

我有一个 PowerShell 函数，它接受一个可选参数，使用 a 进行验证`ValidateSetAttribute`，并基于该值添加另一个动态参数。但是，**在严格模式下**，当尝试访问`DynamicParam`块内的参数时，并且我没有明确设置所述参数，然后我收到一个错误，即未定义变量。

```
Param(
    [Parameter()]
    [ValidateSet('A', 'B')]
    [string] $Target = 'A'
)
DynamicParam {
    if ($Target -eq 'B') { # <- Here it fails
        # Add new parameter here...
    }
}
end {
    Write-Host $Target
} 
```

该脚本在使用`A`或`B`作为第一个参数调用时有效，但在省略参数时失败。有趣的是，如果我从参数定义中删除了 the`ParameterAttribute`或 the `ValidateSetAttribute`，它就会起作用。

我目前的解决方法是使用访问变量`$PSBoundParameters`并检查是否设置了参数，如下所示：

```
if ($PSBoundParameters.ContainsKey('Target') -and $PSBoundParameters.Target -eq 'B') {
    # Add new parameter here...
} 
```

虽然这很好用，但如果我想检查该值，它有一个缺点`A`：`A`参数的*默认值*`$PSBoundParameters`也是如此，当省略参数并应用默认值时，它不会被添加。所以我需要修改我的检查以明确检查：

```
if (-not $PSBoundParameters.ContainsKey('Target') -or $PSBoundParameters.Target -eq 'A')) {
    # Add new parameter here...
} 
```

我不太喜欢这种解决方案，因为它会不必要地将动态参数添加与默认值联系起来。理想情况下，我希望能够更改默认值而无需触及其他任何内容。有没有办法从`DynamicParam`块内访问实际参数值？或者至少有可能访问参数定义并访问默认值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T16:37:25.837

If you need run correctly in case `PSDebug` is running in `strict` mode ( `set-psdebug -strict` ), you can do something like this:

```
Param(
    [Parameter()]
    [ValidateSet('A', 'B')]
    [string] $Target = 'A'
)

DynamicParam {

    # Ensure $Target is defined
    try { [void]$Target }
    catch { $Target = [string]::Empty }

    if ($Target -eq 'B') {
        write-host "si si"
    }
}
end {
    Write-Host $Target
} 
```

# python - 删除或编辑使用 Python pickle 保存的条目

> ID：15114616
> 
> 赞同：7
> 
> 时间：2013-02-27T14:31:38.923
> 
> 标签：python, binary, pickle

我基本上是做一系列的转储和加载，但在某些时候我想删除一个加载的条目。我怎样才能做到这一点？有没有办法删除或编辑使用 Python pickle/cpickle 保存的条目？

编辑：数据与pickle一起保存在二进制文件中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T15:21:46.117

要从二进制文件中删除腌制对象，您*必须*重写整个文件。该`pickle`模块不处理流的任意部分的修改，因此没有内置的方式来做你想做的事。

可能最简单的二进制文件替代方法是使用该[`shelve`](http://docs.python.org/2/library/shelve.html)模块。

该模块为`dict`包含腌制数据的数据库提供了一个类似的接口，正如您从文档中的示例中看到的那样：

```
import shelve

d = shelve.open(filename) # open -- file may get suffix added by low-level
                          # library

d[key] = data   # store data at key (overwrites old data if
                # using an existing key)
data = d[key]   # retrieve a COPY of data at key (raise KeyError if no
                # such key)
del d[key]      # delete data stored at key (raises KeyError
                # if no such key)
flag = key in d        # true if the key exists
klist = list(d.keys()) # a list of all existing keys (slow!)

# as d was opened WITHOUT writeback=True, beware:
d['xx'] = [0, 1, 2]    # this works as expected, but...
d['xx'].append(3)      # *this doesn't!* -- d['xx'] is STILL [0, 1, 2]!

# having opened d without writeback=True, you need to code carefully:
temp = d['xx']      # extracts the copy
temp.append(5)      # mutates the copy
d['xx'] = temp      # stores the copy right back, to persist it

# or, d=shelve.open(filename,writeback=True) would let you just code
# d['xx'].append(5) and have it work as expected, BUT it would also
# consume more memory and make the d.close() operation slower.

d.close()       # close it 
```

使用的数据库是`ndbm`或`gdbm`，具体取决于平台和可用的库。

注意：如果数据没有移动到其他平台，这很有效。如果您希望能够将数据库复制到另一台计算机，那么将`shelve`无法正常工作，因为它不能保证将使用哪个库。在这种情况下，使用显式 SQL 数据库可能是最好的选择。

# c# - 对接口和实现感到困惑

> ID：15114621
> 
> 赞同：3
> 
> 时间：2013-02-27T14:31:50.797
> 
> 标签：c#, inheritance, interface

案例很简单，我有这个接口

```
public interface IHasNext
{
    IHasNext NextItem { get; set; }
} 
```

然后我尝试像这样实现它：

```
public class Item : IHasNext
{
    public int Id { get; set; }
    Item NextItem { get; set; }
} 
```

但这不起作用，因为实现的属性 NextItem 不是同一类型（即使该类型实现了接口）。所以有人可以向我解释这不起作用的原因，当你可以相当自由地交换接口的类型时，它们甚至作为类型参数（至少在 IEnumerable 和 IQueryable 上）实现的接口。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T14:34:33.377

考虑这段代码：

```
public class BadItem : IHasNext
{
    public IHasNext { get; set; }
} 
```

现在：

```
IHasNext item = new Item();
item.NextItem = new BadItem(); 
```

这是完全有效的......但你希望它在`Item`课堂上做什么？它的`NextItem`属性是 type `Item`，所以它不知道如何处理`BadItem`...

基本上，这样做是不安全的。

您可能希望使您的界面通用：

```
public interface IHasNext<T> where T : IHasNext<T>
{
    T NextItem { get; set; }
}

public class Item : IHasNext<Item>
{
    public int Id { get; set; }
    IHasNext<Item> NextItem { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:36:09.710

接口声明属性必须是 type `IHasNext`，你的代码应该是：

```
public class Item : IHasNext
{
    public int Id { get; set; }
    IHasNext NextItem { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:38:29.277

您为什么不将其实现为：

```
 public class Item : IHasNext
 {
    public int Id { get; set; }
    IHasNext NextItem { get; set; }
 } 
```

? 这个接口可以在任何实现`IHasNext`.

但更好的是使其通用

```
public interface IHasNext<T>
{
    T NextItem { get; set; }
}

 public class Item : IHasNext<Item>
 {
    public int Id { get; set; }
    Item NextItem { get; set; }
 } 
```

# html - HTML - 扩展名错误的图像

> ID：15114626
> 
> 赞同：1
> 
> 时间：2013-02-27T14:32:01.197
> 
> 标签：html, image, browser, cross-platform, wap

如果图像文件名不能反映其正确的文件类型（例如以 .pdf 扩展名存储），在 HTML 中使用它是否安全？浏览器会决定图像的正确类型吗？移动浏览器是否能够推断出正确的文件类型？

我已经用谷歌浏览器测试过它，它工作正常，但它保证可以在所有合理的浏览器上运行吗？

**更新：**我无法将它们重命名为正确的扩展名，因为它们将由用户上传然后再次显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:38:05.563

> 移动浏览器是否能够推断出正确的文件类型？

浏览器通常不会*推断*文件类型（有例外，特别是在 IE 中 - 导致讨论 HTML 的文本文件被视为 HTML 和 IIS 服务器`text/plain`在其所有者没有注意到的情况下发送 HTML 文档的内容类型 - 但它们不应该是主要的关心）。

`Content-Type`相反，浏览器通过检查 HTTP响应标头来确定数据类型。默认情况下，大多数服务器将根据它们从文件系统读取的文件的文件扩展名来设置它以提供给客户端。

您可以覆盖它，但这样做很麻烦，如果人们在从本地文件系统打开文件之前保存文件，可能会导致问题（因为它的扩展名错误，并且他们的操作系统会将其与错误的应用程序相关联）。

# c++ - 被破坏的 C++ 对象的数据仍然可以访问吗？

> ID：15114631
> 
> 赞同：1
> 
> 时间：2013-02-27T14:32:06.413
> 
> 标签：c++

在以下代码中，`getObj()`函数返回对本地对象的引用。这显然是非常糟糕的，因为当函数返回时对象被销毁（ctor 和 dtor 输出强调对象的生命周期）。正如预期的那样，编译器（gcc44）给出了相应的警告。

```
#include <iostream>

class Blah {

private:
    int a_;

public:
    Blah(int a) : a_(a) { std::cout << "Constructing...\n"; }
    ~Blah() { std::cout << "...Destructing\n"; }
    void print() { std::cout << a_ << "\n"; }
};

Blah& getObj() 
{
    Blah blah(3);
    return blah; // returning reference to local object
}

int main()
{
    Blah& b = getObj();
    b.print(); // why does this still output the correct value???

    return 0;
} 
```

然而，调用`print()`明显被破坏的对象仍然会打印出私有变量的正确值`a_`。这是输出：

建设中...
...破坏
3

怎么会这样？我本来希望所有对象数据也会被销毁。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T14:33:10.540

它被称为**未定义的行为**。任何事情都有可能发生。你所看到的只是“任何事情”的一个子集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:36:43.000

为什么会破坏数据？恐怕你对正在发生的事情的心理模型显然是不正确的。当一个对象从堆栈或堆中释放时，所发生的一切就是它所存储的内存现在被标记为可以使用。数据仍然存在，直到发生某些事情来覆盖它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:37:46.113

销毁只是意味着将内存归还给它的原始所有者（操作系统）。它不会被删除或覆盖。某些操作系统允许您读取任何内存，因此您可以读取它，如果幸运的话，没有其他人获得这块内存并且您的价值仍然存在。请注意，不能以任何方式保证幸运，您的程序可能会崩溃和烧毁。

# linux - gdb 在另一个进程的上下文中运行？

> ID：15114632
> 
> 赞同：4
> 
> 时间：2013-02-27T14:32:08.147
> 
> 标签：linux, debugging, gdb

我只是想了解 gdb（或任何其他调试器）如何修改另一个进程的地址空间中的内存？

我们有一个正在运行的进程，我们附加到它

> 附`pid`

从这里开始，我们可以修改“附加进程”地址空间中的内存（变量）。这怎么可能。什么是阻止任何其他进程（不是调试器）做同样的事情。操作系统是否提供特殊`doors`的调试器可以用来查看/修改不同进程的地址空间？

还是我弄错了。附加后，进程是否在调试器的上下文中运行？如果是这样，这种情况下的变化是如何发生的？如果发生这种情况，我可以假设这将是写入时的副本吗？如果是这样，调试器将使用不同的内存来存储修改后的数据。但是一旦我们从gdb修改了一些内存并从进程中分离出来，进程将继续看到修改后的数据......这是否意味着gdb可以访问这个正在运行的进程的地址规范？

任何理解这一点的指针将不胜感激。我可以看一下gdb的代码，但是代码很大，不知道从哪里开始。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:34:11.983

在 Linux 上，API 是[`ptrace()`](http://linux.die.net/man/2/ptrace). 它需要某些特权，这些特权在手册页中有详细说明。

有关如何使用它的教程，请参阅[Playing with ptrace](http://www.linuxjournal.com/article/6100)。

# javascript - Backbone.js 路由取决于模型值

> ID：15114637
> 
> 赞同：1
> 
> 时间：2013-02-27T14:32:22.073
> 
> 标签：javascript, backbone.js, url-routing

我有一个看起来像这样的集合

```
[
    {
        "year": 1868,
        ....
           ]
    },
    {
        "year": 1872,
        ....
    },
    {
        ...
    }
] 
```

有没有办法用`'/year/:year': 'year'`或设置路线`'/(:year)': 'year'`？

我尝试在主 App 视图中创建一个查找表，它将年份索引传递给模型视图。我曾尝试使用 _.map、_.each、_.pluck 和 _.where，但我想我一定是做错了什么。

[这](http://amejias101.github.com/animated-elections/)是它的外观的非主干视图。所以导航到 /(:year) 会直接到那一年，它对应于模型索引

**编辑**：澄清一下，基本上我希望用户能够去`/year/:year`，但`:year`值对应于某个模型（见上文）。在这种情况下`/year/1868`，将呈现上述集合中的第一个模型。

**编辑＃2**：这是我的应用程序的样子。

这是路由器 var router = Backbone.Router.extend({ routes: { '': 'root', 'year(/:year)': 'year' },

```
 root: function() {
        new App();
    },

    year: function(year) {
        new App({
            year: year
        });
    }
}); 
```

调用这个文件

```
define(['backbone', 'assets/js/collections/elections.js', 'assets/js/views/election.js', 'jqueryui'], function(Backbone, Elections, ElectionView, simpleSlider) {
var AppView = Backbone.View.extend({
    current_election_index: 0,
    active_btn_class: 'dark_blue_bg',
    wiki_base: 'http://en.wikipedia.org/wiki/United_States_presidential_election,_',
    started: 0,
    el: 'body',
    playback: {
        id: '',
        duration: 1750,
        status: false
    },

    initialize: function() {
        elections = new Elections();
        _.bindAll(this, 'render');
        this.listenTo(elections, 'reset', this.render);
        elections.fetch();
        this.remove_loader();
    },

    render: function () {
        if (this.started === 0) {
            this.election_year();
        }
        var view = new ElectionView({
            model: elections.at(this.current_election_index),
            election_index: this.current_election_index
        });
        this._make_slider();
        this.update_ui();
        return this;
    }, 
```

我拿出了一些方法，因为它们不是必需的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:56:26.690

典型的解决方案如下所示：

```
var AppRouter = Backbone.Router.extend({
  routes: {
    "year(/:year)" : "electionByYear"
  },

  electionByYear: function(year) {

    //all of your data, wherever you get it from
    var results = this.allElectionResults;

    //if a year parameter was given in the url
    if(year) {
        //filter the data to records where the year matches the parameter
        results = _.findWhere(results, { year: parseInt(year, 10)});
    }

    doSomething(results);

  }
}); 
```

**根据评论进行编辑：**如果您的视图负责创建集合，则应将上述逻辑移至您的视图，并将`year`参数作为参数传递给您的视图：

```
var View = Backbone.View.extend({
  initialize: function(options) {
    this.year = options.year;
  }
});

var view = new View({year:year});
view.render(); 
```

或者，如果您使用的是现有视图：

```
view.year = year;
view.render(); 
```

# php - 多次添加追加销售产品

> ID：15114638
> 
> 赞同：0
> 
> 时间：2013-02-27T14:32:23.530
> 
> 标签：php, magento

为了将追加销售产品直接添加到购物车，我们在追加销售产品列表中添加了一个“添加到购物车”按钮。

添加追加销售产品后，Magento 会将其从追加销售产品列表中删除。是否可以避免这种情况，以便可以多次添加追加销售产品？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:08:49.267

为此，请创建一个自定义模块来重写`Mage_Catalog_Block_Product_List_Upsell`

/app/code/core/Mage/Catalog/Block/Product/List/Upsell.php

```
protected function _prepareData()
{
    ...

    if (Mage::helper('catalog')->isModuleEnabled('Mage_Checkout')) {
        /* removing code
        Mage::getResourceSingleton('checkout/cart')->addExcludeProductFilter($this->_itemCollection,
            Mage::getSingleton('checkout/session')->getQuoteId()
        );
        */

        $this->_addProductAttributesAndPrices($this->_itemCollection);
    }
 ... 
```

# responsive-design - 为什么这些社交按钮不在响应式设计中居中？

> ID：15114639
> 
> 赞同：0
> 
> 时间：2013-02-27T14:32:23.733
> 
> 标签：responsive-design, social, centering

我们在我们的网站上手动编写了 Twitter、Facebook 和 G+ 按钮，这些按钮在 ajax 产品组合中使用响应式设计。它们都彼此完美对齐，但问题是我们希望所有 3 个都居中，无论周围容器的大小如何。

在我的脑海中，这应该很容易与具有 100% 宽度以扩展到投资组合大小的周围 Div 一起工作，在另一个 Div 中，它具有左边距和右边距作为 auto，它在中心浮动到 100% 宽度 div，然后在里面该 div 中的按钮容器。但是由于某种原因，它们总是很难对齐到左侧。这是我目前的代码。

这是一个例子

```
http://themixtapesite.com/#/joe-budden-a-lose-quarter 
```

现在更改您的浏览器窗口以使其更小，以便您可以动态查看所有不同的大小 - 我希望这些社交按钮浮动在中间而不是像现在一样在左侧..

```
<!-- Social sharing buttons -->
    <div class="social-single">

    <div class="social-centre">     

    <div class="twit-button"><a href="https://twitter.com/share" class="twitter-share-button" data-via="mixtapes_4_free" data-lang="msa" data-related="realdannys" data-hashtags="mixtape">Tweet</a></div>

    <div class="fb-button"><iframe src="http://www.facebook.com/plugins/like.php?href=<?php echo urlencode(get_permalink($post->ID)); ?>&amp;title=<?php wp_title( '|', true, 'right' ); ?>&amp;send=false&amp;layout=button_count&amp;width=71&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=118471234925480" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width: 71px; height: 21px;" allowTransparency="true"></iframe>
                        </div>

    <div class="gplus-button"><g:plusone href="<?php echo urlencode(get_permalink($post->ID)); ?>" size="medium" annotation="bubble" width="50px"></g:plusone></div>

    </div> </div> 
```

和 CSS

```
/* Social Buttons */

.social-single {
display: block;
margin-left: auto;
margin-right: auto;
margin-top: 10px;
margin-bottom: 10px;
width:  100% !important;
}

.social-centre
{
margin-left: auto;
margin-right: auto;
}

.twit-button {
float:  left;
margin: 0;
margin-right: 5px;
width: 80px;
}

.fb-button {
float: left;
margin: 0;
width: 80px;
}

.gplus-button {
float: left;
margin: 0;
width: 50px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:19:14.480

你已经用过`margin-left: auto;`，`margin-right:auto;`很好。你把所有的东西都设置在响应的方式上。但是浏览器检查每个元素的一件事，它`width`以及`height`. 我们应该分别定义这些值，否则它将假定它没有任何子元素。

我检查了你的代码，因为我认为你只需要添加一件事 - 给`.social-centre`类宽度你想要的任何东西，但如果它在 %'s 中会很好，因为它的响应性。

```
.social-centre
{
margin-left: auto;
margin-right: auto;
width:50%; //example, whatever you want.
} 
```

它会正常工作。希望它会帮助你。

# cakephp - 找不到控制器的蛋糕php调用函数和获取控制器

> ID：15114643
> 
> 赞同：1
> 
> 时间：2013-02-27T14:32:30.383
> 
> 标签：cakephp, cakephp-2.3

我正在学习蛋糕 php。我用文件夹名称 Map 制作了插件，一切正常。但是当我`index()`在`MapController`课堂上调用其他函数时。它给出了错误

> 找不到 Map.functionName。

但我在`MapController`课堂上做了那个功能。

```
url -- http://localhost/rootfolder/map/functionName 
```

请告诉什么问题。我们不能做`index()`插件以外的其他功能吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:35:20.910

对于插件，默认 URL 路径是`/:plugin/:controller/:action`，因此您可能需要访问`/map/map/action`. 这可以用这样的路由重写：

```
Router::connect('/something/', array('plugin' => 'map', 'controller' => 'map', 'action' => 'someACtion')); 
```

# c - 使用 %s 即字符串说明符读取 char 数组

> ID：15114648
> 
> 赞同：0
> 
> 时间：2013-02-27T14:32:47.100
> 
> 标签：c, arrays, char, dynamic-memory-allocation, format-specifiers

```
char *ptr=(char*)calloc(n,sizeof(int)); 
```

使用上述方法，我们可以为 char 数组分配内存。但是是否逐个字符地阅读它是强制性的`? How to read and access it using`%s` 即字符串格式说明符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:47:56.127

逐个字符读取不是强制性的，并且精确使用`%s`容易受到缓冲区溢出的影响。指定要读取的最大字符数，比正在填充的缓冲区中的字节数少一，防止缓冲区溢出。例如`"%10s"`，最多读取十个字符，然后分配空终止字符，因此目标缓冲区至少需要 11 个字节。

但是，正如代码所示，`n`在编译时未知使用`%s`动态*宽度*是不可能的。但是可以构造格式说明符（格式说明符不需要是字符串文字）：

```
char fmt[32];
sprintf(fmt, "%%%ds", n - 1); /* If 'n == 10' then 'fmt == %9s' */
if (1 == scanf(fmt, ptr))
{
    printf("[%s]\n", ptr);
} 
```

另一种选择是[`fgets()`](http://en.cppreference.com/w/c/io/fgets)：

```
if (fgets(ptr, n, stdin))
{
} 
```

但行为略有不同：

*   `fgets()`确实使用空格来终止输入。
*   `fgets()`如果遇到换行符，将存储它。

`calloc()`不需要强制转换(or `malloc()`or `realloc()`) 的返回值（请参阅[Do I cast the result of malloc?](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)），并且发布的内容令人困惑，因为它正在分配空间`int[n]`但旨在成为字符数组。反而：

```
char* ptr = calloc(n, 1); /* 1 == sizeof(char) */ 
```

此外，如果一个空终止的字符串被读入`ptr`由提供的初始化`calloc()`是多余的，那么一个`malloc()`就足够了：

```
char* ptr = malloc(n, 1); 
```

记住`free()`你`malloc()`d，`calloc()`d或`realloc()`d。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:34:48.463

是的，您可以使用读取此类数组，`%s`但请确保已为尝试读取的内容分配了足够的内存（不要忘记终止的零字符！）。

# java - 为什么 varargs (Class ... t) 是“未经检查或不安全”的操作？

> ID：15114649
> 
> 赞同：12
> 
> 时间：2013-02-27T14:32:51.983
> 
> 标签：java, exception, generics, compiler-warnings, variadic-functions

好的，所以我正在调用带有签名的方法，`(Class<? extends Throwable>... exceptions)`并且在主方法中收到“File.java 使用未经检查或不安全的操作”警告：

```
public class VarargsFun {
    public void onException(Class<? extends Throwable>... exceptions) { }

    public static void main(String[] args) {
        new VarargsFun().onException(IllegalArgumentException.class);
    }
} 
```

编译器不应该能够看到`IllegalArgumentException`确实扩展了`RuntimeException`，`Exception`并且`Throwable`？

我应该如何正确修改我的代码以消除此警告？

我真的不想实例化我的异常......使用`.class`

（也不想使用`@SuppressWarnings`！）

我正在使用 java 7。感谢您的任何提示。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-27T14:46:07.700

因为 varargs 实际上只是数组，并且[泛型和数组不能混合](https://stackoverflow.com/a/1817544/228171)（很好），Java 传统上在调用具有泛型 vararg 类型的方法时会给出警告。这是因为从技术上讲，数组是在调用者处创建的。

然而，从*调用者的*角度来看，仅仅为了传递给可变参数方法而创建的数组并没有像普通的泛型数组那样遭受同样的危险，但是接收泛型数组的方法本身可能会滥用它们。所以在 Java 7 之前，警告出现在方法本身（在你的情况下，`onException`），并且可以通过使用[`@SafeVarargs`](http://docs.oracle.com/javase/7/docs/api/java/lang/SafeVarargs.html)方法上的注释来抑制：

```
@SafeVarargs
public void onException(Class<? extends Throwable>... exceptions) { } 
```

如果您实际上没有使用 Java 7 语言，或者您无法更改`onException`（可能是因为它是一种库方法），那么您可以安全地使用`@SuppressWarnings`来隐藏该警告：

```
@SuppressWarnings("unchecked")
public static void main(String[] args) {
    new VarargsFun().onException(IllegalArgumentException.class);
} 
```

但是，如果您以这种方式抑制警告，请注意将这一语句隔离在其自己的方法中，这样您就不会意外地抑制其他未来的警告。

就个人而言，我在我的 IDE 中完全禁用了通用可变参数警告，因为从调用者的角度来看，它们几乎从不指示错误的代码。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-27T19:39:59.370

如果您意识到这一点，则最容易理解

```
new VarargsFun().onException(IllegalArgumentException.class); 
```

只是语法糖

```
new VarargsFun().onException(
    new Class<? extends Throwable>[]{ IllegalArgumentException.class }); 
```

即调用站点创建一个组件类型等于可变参数类型的数组。

但当然，`new Class<? extends Throwable>[]`在 Java 中是不允许的。所以编译器`new Class<?>[]`会这样做并给出警告。

# wpf - 在 XAML 中指定命名颜色的透明度级别

> ID：15114651
> 
> 赞同：16
> 
> 时间：2013-02-27T14:32:58.763
> 
> 标签：wpf, xaml, colors, transparency

XAML 中有没有办法从具有不同自定义透明度级别的命名颜色创建颜色对象？例如

```
<Label Background="{SkyBlue;220}" /> 
```

我知道这不起作用，但只是想引用一个例子。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-27T14:41:35.560

当你自己找到答案的时候。这是任何未来读者的正确方法：

```
<Label.Background>
    <SolidColorBrush Color="SkyBlue" Opacity=".9" />
</Label.Background> 
```

`Opacity`范围在 0 和 1 之间，1 表示完全不透明（不透明）。

## 编辑

关于@Dai 的评论，如果您引用已经设置了一些透明度的颜色资源，此方法确实不会重置或覆盖指定颜色的透明度级别。例如，如果您的资源颜色的`SkyBlue`透明度设置为 0.5，而现在您想将其设置为 0.7，则上述方法将无法直接工作。

为了处理这种情况，您需要做的就是创建一个`Converter`重置输入颜色的 alpha 分量的小程序。像这样的东西：

```
public class NoTransparencyConverter : IValueConverter
{
  public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
  {
    var C = ((Color)value);
    return Color.FromArgb(0xFF, C.R, C.G, C.B);
  }

  public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
  {
    throw new NotSupportedException();
  }
} 
```

然后在您的 XAML 中使用它：

```
<SolidColorBrush Color="{Binding Path="YOUR_COLOR_RESOURCE" Converter={x:Static NoTransparencyConverter}}" Opacity=".9" /> 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-02-27T19:52:58.293

只是为了给这个加一点。是的，您绝对可以`Opacity`按照您在答案中显示的那样设置 via 声明性，但您甚至不需要设置依赖属性，您可以通过使用您的值`Alpha`顶部（**由方式提供比**）更好的性能。例如，假设您具有**Black**的价值，并且您想给它一些不透明性。可以添加该值的前 2 个八位字节来完成同样的事情。`RGB`**`opacity`**

 **例如；

“#000000” = 黑色（实心）

然而;

“#33000000” = 黑色（不透明度为 20%）

"#77000000" = 黑色（不透明度为 47%）

“#E5000000” = 黑色（不透明度为 90%）

只是为了在那里进行一些详细说明，并可能在将来该`Opacity`属性可能不那么容易获得或被设置为不可变时为您提供帮助。希望这可以帮助。

**附录：**还值得注意的是，对像 alpha 这样的属性进行设置总是比对整个元素设置不透明度更有效。这也适用于 HTML/CSS 场景，其中类似`background-color: rgba(0,0,0,.5)`的做法比说`<div style="background: black;opacity: .5)`**

# c++ - 从 C++ 代码控制 MATLAB dll

> ID：15114662
> 
> 赞同：0
> 
> 时间：2013-02-27T14:33:29.613
> 
> 标签：c++, matlab

我从 C++ 运行 MATLAB 函数 (dll)。此函数获取一些参数并运行具有多次迭代的循环。有没有办法在 C++ 代码中设置一些标志并在 MATLAB 函数的每次迭代中检查它。如果在 C++ 代码中将此标志设置为 false（让另一个线程说），MATLAB 函数将中断循环并返回 C++ 代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:50:04.027

如果您可以同时修改 C++ 和 MATLAB 代码（正如我们可以从问题中假设的那样），我认为最简单的方法是使用空文件作为事件的标志。如果其他线程可以创建文件，比如“event.flag”，您可以在 MATLAB 函数中轻松检查它的存在：

```
if exist('event.flag','file')
    % do_something
end 
```

确保包含第二个参数`file`，这将使存在运行得更快。

我相信这个解决方案比尝试使用任何全局变量更容易且防错。

* * *

如果您需要在运行时在 MATLAB 和其他进程之间交换一些数据，我建议使用[MEMMAPFILE](http://www.mathworks.com/help/matlab/ref/memmapfile.html)对象。检查文档以查看它是否适合您的情况。

# symfony - 同一张桌子上的多对多

> ID：15114666
> 
> 赞同：3
> 
> 时间：2013-02-27T14:33:44.823
> 
> 标签：symfony, many-to-many

我有一个项目，其中我在同一个数据库上有一个 OneToMany 关系。

目前它是这样设计的：

```
/**
 * @ORM\OneToMany(targetEntity="MyEntity", mappedBy="myCopiedItem")
 */
protected $mySource;

/**
 * @ORM\ManyToOne(targetEntity="MyEntity", inversedBy="mySource")
 * @ORM\JoinColumn(name="selected_myentity_copy_id", referencedColumnName="id")
 */
protected $myCopiedItem; 
```

但是现在我必须使这种关系ManyToMany。所以我这样做了：

```
/**
 * @ORM\ManyToMany(targetEntity="MyEntity", mappedBy="myCopiedItem")
 */
protected $mySource;

/**
 * @ORM\ManyToMany(targetEntity="MyEntity", inversedBy="mySource")
 * @ORM\JoinTable(name="entity_has_copy")
 */
protected $myCopiedItem; 
```

但是symfony创建的“entity_has_copy”表只有1个项目（myentity_id），我想要2个字段“myentity_id”和“selected_myentity_copy_id”，它们都是我的“myentity”表中的实际ID......

为了在生成的表中同时拥有两个 id，我必须修改什么？

我确定我错过了一些东西，但我不知道是什么:(

> 注意：实体/表名已重命名以保护隐私

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T15:39:30.970

解决了这个！

我必须在定义中添加关系......

所以这是 JoinTable 部分的正确定义：

```
/**
 * @ORM\ManyToMany(targetEntity="MyEntity", inversedBy="mySource")
 * @ORM\JoinTable(name="entity_has_copy",
 *      joinColumns={@ORM\JoinColumn(name="entity_id", referencedColumnName="id")},
 *      inverseJoinColumns={@ORM\JoinColumn(name="entity_copy_id", referencedColumnName="id")}
 *      )
 */
protected $myCopiedItem; 
```

希望这会帮助其他有同样问题的人......

如果您想了解更多有关实体之间的关联如何与 Doctrine 映射的信息，这里[有一个很好的 URL](http://docs.doctrine-project.org/en/2.0.x/reference/association-mapping.html)！

# c# - 用于列表框控件的代码，我喜欢用于gridview

> ID：15114668
> 
> 赞同：0
> 
> 时间：2013-02-27T14:33:49.007
> 
> 标签：c#, asp.net

我看过 1 篇文章，地址如下

[http://www.c-sharpcorner.com/UploadFile/rohatash/uploading-multiple-files-with-listbox-in-Asp-Net/](http://www.c-sharpcorner.com/UploadFile/rohatash/uploading-multiple-files-with-listbox-in-Asp-Net/)

用于显示上传文件的列表框

```
if (ListBox1.Items.Contains(new ListItem(System.IO.Path.GetFileName(FileUpload1.PostedFile.FileName))))
{
      Label1.Text = "File already in the ListBox";
}
else
{
      Files.Add(FileUpload1);
      ListBox1.Items.Add(System.IO.Path.GetFileName(FileUpload1.PostedFile.FileName));
      Label1.Text = "Add another file or click Upload to save them all";
} 
```

，现在我喜欢在网格视图中这样做，但是我在为网格视图传输下面的代码时遇到问题，它有问题它不能防止重复上传的文件。

```
for (int i = 0; i < count; i++)
{
     if (GridViewEfile.Rows[i].Cells[1].Text == FileName)
     {
             Label2.Text = "File already in the list";
             break;
     }
} 
```

我为gridview做了什么：

```
for (int i = 0; i < count; i++)
{
      if (GridViewEfile.Rows[i].Cells[1].Text == FileName)
      {
            Label2.Text = "File already in the list";
            break;
      }
}

for (int j = 0; j < count; j++)
{
      dr = dt.NewRow();
      dr["File Name"] = GridViewEfile.Rows[j].Cells[1].Text;
      dr["File Size"] = GridViewEfile.Rows[j].Cells[2].Text;
      dt.Rows.Add(dr);
}

dr = dt.NewRow();
dr["File Name"] = FileName;

if (size > 0)
     dr["File Size"] = size.ToString() + " KB";
else
     Label2.Text = "File size cannot be 0";

dt.Rows.Add(dr);

GridViewEfile.DataSource = dt;
GridViewEfile.DataBind(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:42:05.170

发生这种情况是因为即使您发现重复，您也不会停止添加新行。

```
bool isDuplicate = false;

for (int i = 0; i < count; i++)
{
    if (GridViewEfile.Rows[i].Cells[1].Text == FileName)
    {
         Label2.Text = "File already in the list";
         isDuplicate = true;
         break;
    }
}

for (int j = 0; j < count; j++)
{
     dr = dt.NewRow();
     dr["File Name"] = GridViewEfile.Rows[j].Cells[1].Text;
     dr["File Size"] = GridViewEfile.Rows[j].Cells[2].Text;
     dt.Rows.Add(dr);
}

if (!isDuplicate)
{
     if (size == 0)
     {
         Label2.Text = "File size cannot be 0";
     }
     else
     {
         dr = dt.NewRow();
         dr["File Name"] = FileName;
         dr["File Size"] = size.ToString() + " KB";

         dt.Rows.Add(dr);
     }
}

GridViewEfile.DataSource = dt;
GridViewEfile.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:42:47.190

您只是嵌套错误-第一个循环应该是文件迭代，第二个循环-检查是否有重复。反之亦然。

检查下面的片段：

```
for (int j = 0; j < count; j++) // here is file iteration
{
   for (int i = 0; i < count; i++) // here is dupe check
   {
      if (GridViewEfile.Rows[i].Cells[1].Text == FileName)
      {
          Label2.Text = "File already in the list";
          break;
      }
   }

   dr = dt.NewRow();
   dr["File Name"] = FileName;
   if (size > 0)
      dr["File Size"] = size.ToString() + " KB";
   else
      Label2.Text = "File size cannot be 0";

   dt.Rows.Add(dr);

   GridViewEfile.DataSource = dt;

   GridViewEfile.DataBind();
   }
} 
```

# java - 将 JAR 作为 Windows 服务运行

> ID：15114674
> 
> 赞同：15
> 
> 时间：2013-02-27T14:33:56.267
> 
> 标签：java, jar, windows-services

我有一个 JAR 文件，我想注册它并将其作为 Windows 服务运行。使用配置良好的 JAR 和已经注册的 JVM 关闭钩子，执行此操作应该不是一件大事。

我已经有一个带有外部`lib`目录的 JAR，我可以`java -jar My.jar`用`Ctrl+C`.

我还检查了来自 Apache 的 JSL、JSmooth 和 procrun，但没有有效的解决方案。

我需要一个带有良好教程的可行解决方案。

**更新：**我成功地使用了 procrun（最后）和手动 .net 服务包装器......这是我的 install.bat 的 procrun 版本的代码：

```
set PR_PATH=%CD%
SET PR_SERVICE_NAME=MyService
SET PR_JAR=MyService.jar
SET START_CLASS=org.my.Main
SET START_METHOD=main
SET STOP_CLASS=java.lang.System
SET STOP_METHOD=exit
rem ; separated values
SET STOP_PARAMS=0
rem ; separated values
SET JVM_OPTIONS=-Dapp.home=%PR_PATH%
prunsrv.exe //IS//%PR_SERVICE_NAME% --Install="%PR_PATH%\prunsrv.exe" --Jvm=auto --Startup=auto --StartMode=jvm --StartClass=%START_CLASS% --StartMethod=%START_METHOD% --StopMode=jvm --StopClass=%STOP_CLASS% --StopMethod=%STOP_METHOD% ++StopParams=%STOP_PARAMS% --Classpath="%PR_PATH%\%PR_JAR%" --DisplayName="%PR_SERVICE_NAME%" ++JvmOptions=%JVM_OPTIONS% 
```

我假设

*   从 jar 和 prunsrv.exe 所在的同一目录运行它
*   罐子有它的工作清单.MF
*   并且您已将关闭挂钩注册到 JVM 中（例如在 Spring 中使用 context.registerShutdownHook() ）...
*   不使用 jar 外部文件的相对路径（例如 log4j 应该与*log4j.appender.X.File=${app.home}/logs/my.log*或类似的东西一起使用）

感谢 apache procrun 团队 ( [http://commons.apache.org/proper/commons-daemon//procrun.html](http://commons.apache.org/proper/commons-daemon//procrun.html) ) 和 marifnst ( [http://a089lp.wordpress.com/tag/procrun-tutorial/](http://a089lp.wordpress.com/tag/procrun-tutorial/) )

**更新 2**：winsv 的新教程：[https ://dzone.com/articles/spring-boot-as-a-windows-service-in-5-minutes](https://dzone.com/articles/spring-boot-as-a-windows-service-in-5-minutes)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T14:47:10.670

试试这个 java 启动器

[http://winrun4j.sourceforge.net/](http://winrun4j.sourceforge.net/)

免费和开源

在页面末尾启动服务示例

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T14:52:26.500

从这些示例中编写您自己的服务：

*   [http://www.codeproject.com/Articles/3990/Simple-Windows-Service-Sample](http://www.codeproject.com/Articles/3990/Simple-Windows-Service-Sample)
*   [http://msdn.microsoft.com/en-us/library/windows/desktop/bb540476%28v=vs.85%29.aspx?bcsi-ac-bbaf765720ef3335=20190C4200000503o7MxKbMq7UL6Af4O24rqKSGuh1gPAwAAAwUAAPvrLQAIBwAAbwEAAGh=](http://msdn.microsoft.com/en-us/library/windows/desktop/bb540476%28v=vs.85%29.aspx?bcsi-ac-bbaf765720ef3335=20190C4200000503o7MxKbMq7UL6Af4O24rqKSGuh1gPAwAAAwUAAPvrLQAIBwAAbwEAAGhCCQA=)
*   [http://code.msdn.microsoft.com/windowsdesktop/CppWindowsService-cacf4948?bcsi-ac-bbaf765720ef3335=20190C4200000503o7MxKbMq7UL6Af4O24rqKSGuh1gPAwAAAwUAAPvrLQAIBwAAbwEAAGhCCQA=](http://code.msdn.microsoft.com/windowsdesktop/CppWindowsService-cacf4948?bcsi-ac-bbaf765720ef3335=20190C4200000503o7MxKbMq7UL6Af4O24rqKSGuh1gPAwAAAwUAAPvrLQAIBwAAbwEAAGhCCQA=)

进入`onStart`你必须做`CreateProcess( "java", "-jar", "MyJar.jar" )`的，保持它的PID

进入`onStop`你必须被PID杀死

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T14:45:31.940

您可以使用 Java 服务包装器

[http://wrapper.tanukisoftware.com/doc/english/download.jsp](http://wrapper.tanukisoftware.com/doc/english/download.jsp)

他们不分发已编译的 x86_64 windows 版本的社区版，但您可以自己构建它。

# c# - 每个连接的 MVC 4 IIS 内存泄漏

> ID：15114676
> 
> 赞同：6
> 
> 时间：2013-02-27T14:33:59.687
> 
> 标签：c#, asp.net, iis-7, asp.net-mvc-4

我有一个`AsyncController`设置来执行长轮询操作。这一切都很好，但是一位同事注意到服务器上的内存泄漏似乎随着每个新连接而增加。

我已经创建了一个小应用程序来从这个页面请求数千次，并且我正在监视 IIS 进程的内存使用情况。每个连接都会增加内存使用量，但不会在客户端断开连接时一直下降。

经过进一步调查，我发现即使我用除此之外什么都不做的标准替换我`AsyncController`的标准，这种情况仍然会发生：`Controller`

```
public class WaitController : Controller
{
    public JsonResult Member(string oauth_token, int service_id, bool busy = false)
    {
        return Json(new
        {
            ready = false,
        }, JsonRequestBehavior.AllowGet);
    }
} 
```

尽管在这种情况下，内存使用量并不**多**，但行为似乎完全相同。

我运行了一个内存分析器来显示 10,000 个连接之间的差异，但那里几乎没有任何东西。最多的内存被`ExpiresEntry[]`from`System.Web.Caching`或的实例占用`System.Runtime.Caching`，但是与我在 IIS 工作进程上获得的内存增加相比，这些完全没有。

**我的问题是**，IIS 是故意这样做的吗？也许这是为连接线程分配的，以防万一以后需要它们？这是 IIS、ASP.NET 或 MVC 4 的错误吗？

我决定为此使用 MVC 4 的 WebAPI 功能，因为我们希望它灵活、可维护、面向未来并且可以通过 AJAX 访问。从开发的角度来看，这似乎也很有意义，因为我们也在 MVC 4 中构建了网站。

然而，一位同事现在将此作为系统架构的一个关键问题提出，因为我们（将来）将需要连接数千个客户端。他建议我们改用 WCF。那么，额外的问题 - 使用 WCF 会解决这些问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:25:35.997

MS 现场工程师有一篇关于这个主题的精彩[文章](http://blogs.msdn.com/b/pfedev/archive/2009/01/22/memory-based-recycling-in-iis-6-0.aspx)。可能会有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T16:22:09.623

经过更多的试验和测试，不幸的是，我发现这是无法避免的。这似乎是设计使然，或者是 IIS 的一个真正根深蒂固的问题。

我改变了我的方法以使用一个较低级别的选项：实现一个`IHttpAsyncHandler`来做同样的事情。我[为 MVC 使用了一个自定义 HttpHandler 路由，](https://stackoverflow.com/a/3380249/369247)以允许我使用与以前使用的完全相同的 URL。问题仍然存在，但规模略小。

然后我尝试了一个完全空白`IHttpHandler`的简单返回`{ ready: false }`（就像我的代码在超时时所做的那样）。HttpHandler 中没有包含其他代码，但同样的问题仍然存在。

接下来，我尝试了一个完全空白的 WCF 服务，该服务也返回了`{ ready: false }`. 同样的问题，但这次规模更小。

正如链接[@rusev](https://stackoverflow.com/users/1393172/rusev)的回答所暗示的那样：

> 内存碎片和其他自然降级无法避免，回收确保应用程序定期清理。

这可能是问题的原因。我可以想象，因为在使用 MVC 控制器时会有更多的开销，所以碎片会发生得更快。使用 HttpHandler 或 WCF 服务等较低级别的方法会在每个连接中使用更少的内存，因此会导致更少的碎片。

# wordpress - 在 wordpress 上更新了我的主题并丢失了自定义标记

> ID：15114678
> 
> 赞同：0
> 
> 时间：2013-02-27T14:34:04.353
> 
> 标签：wordpress

我现在真的很生自己的气。

wordpress 上有这个主题，Reddle，我用它作为模板来创建博客。我编辑了 header.php、footer.php、CSS 等。

然后我在 wordpress 界面上看到 Reddle 有一个新的更新，我自动更新了。繁荣，失去了我所有的习惯，主题几乎被重置了。

幸运的是，我打开了 style.css，所以我可以保存它。但是我的标记已经消失了。所以这个 CSS 变得没用了。

有什么办法可以找回来吗？

我试图搜索我的 firefox/chrome 历史记录以找到博客的“旧”版本，但我找不到。有没有办法在我的电脑里找到它？就像在临时互联网文件或其他东西中一样。

或者使用 Firefox 历史恢复这个旧页面？

我知道在我工作的地方，浏览器会保存历史记录，那么有没有办法打开“保存的页面”而不是重新加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:39:18.400

wordpress 中添加自定义标记或主题的最佳方法是使其成为任何主题的子项。现在，如果您更新现有主题，则不会对您的子主题产生影响，只有父主题将被更新，您将使用它作为父主题，因此实际上不会对其产生任何影响。

# android - 如何停止画廊视图的向后动画

> ID：15114679
> 
> 赞同：0
> 
> 时间：2013-02-27T14:34:04.740
> 
> 标签：android, android-animation

我使用画廊视图来显示图像，但我只想滚动一侧。如何停止从左到右滚动或向后滚动？或者我如何创建自定义画廊？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:49:18.457

GallerView 是一个已弃用的小部件。

我使用[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)，您可以将其修改为自定义图库。您的片段将是您可以滑动的幻灯片或图像。

您可以[在此处](https://stackoverflow.com/questions/13796382/android-viewpager-as-image-slide-gallery)或[此处](https://stackoverflow.com/questions/12239886/how-to-migrate-from-gallery-to-horizontalscrollview-viewpager)阅读更多相关信息。

如果您只想滑动一种方式，则必须扩展 ViewPager 并覆盖 onTouch 事件。

# c++ - 给定我的自定义 const_iterator 实现自定义 const_reverse_iterator

> ID：15114680
> 
> 赞同：1
> 
> 时间：2013-02-27T14:34:06.167
> 
> 标签：c++, iterator

鉴于我关于迭代器和反向迭代器的[最后一个问题](https://stackoverflow.com/questions/15109185/c-iterator-and-reverse-iterator)，我现在`const_iterator`为我的自定义类提供了一个有效的实现......我现在想创建一个`const_reverse_iterator`迭代同一容器的。

我实现了我的`const_iterator`喜欢

```
class const_iterator : public std::iterator<T, std::bidirectional_iterator_tag>
{
    ...
    // operator overloads *, ++, --, ==, !=, e.g.
    uint32_t operator*() const;
    ...
}; 
```

我有一个`typedef`：

```
typedef std::reverse_iterator<const_iterator> const_reverse_iterator; 
```

现在，我的`crbegin()`和`crend()`实现看起来像这样（**我认为不正确的位**）：

```
const_reverse_iterator crbegin() const
{
    return const_reverse_iterator(this->cend());
}

const_reverse_iterator crend() const
{
    return const_reverse_iterator(this->cbegin());
} 
```

问题：在我的测试中，以下工作正常：

```
for(const_iterator i = line.cbegin(); i != line.cend(); ++i)
{
    std::cout << static_cast<char>(*i); // Display as a 'char' for testing purposes
} 
```

但是使用以下代码：

```
for(const_reverse_iterator i = line.crbegin(); i != line.crend(); ++i)
{
    std::cout << static_cast<char>(*i); // Why won't you display as a 'char' from 'unint32_t' like 'const_iterator' does??
} 
```

我收到以下错误`std::cout`：

```
error: invalid static_cast from type 'std::bidirectional_iterator_tag' to type 'char'| 
```

这是创建无忧无虑的有效方法`reverse_iterators`吗？

我觉得我缺少一些简单的东西，但是我搜索了很多，我找不到一个示例来说明如何在`std::reverse_iterator<ITERATOR_TYPE>`模板化类上调用构造函数。

提前感谢您的客气话和建议。

## 编辑：

仅供参考，下面的解决方案，我不得不改变：

```
class const_iterator : public std::iterator<T, std::bidirectional_iterator_tag> 
```

到

```
class const_iterator : public std::iterator<std::bidirectional_iterator_tag, const T> 
```

让它工作。还要注意`const`因为我有`const_iterator`我正在处理的 s。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:13:56.037

您的专业化`iterator`不正确，颠倒了值类型和迭代器类别。它应该是：

```
class const_iterator : public std::iterator<std::bidirectional_iterator_tag, T>
                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
```

结果，虽然`const_iterator`直接使用它时工作正常，但任何依赖于它的特性的东西，例如 using `<algorithm>`， or `std::reverse_iterator`，都会失败。

# amazon-ec2 - Tornado 应用程序在 100% CPU 的情况下定期停止几秒钟

> ID：15114683
> 
> 赞同：1
> 
> 时间：2013-02-27T14:34:22.450
> 
> 标签：amazon-ec2, tornado

我正在尝试对在 EC2 上的 Ubuntu 11.04 上的 tornado 2.4 上运行的应用程序进行故障排除。它似乎定期达到 100% CPU 并在该请求下停止几秒钟。

非常感谢您对此的任何帮助。

**症状：**

*   top 在停止时显示 100% cpu。通常服务器的 CPU 利用率约为 30-60%。
*   它每 2-5 分钟停止一次请求。我已经检查过没有影响这一点的 cronjobs。
*   它会停止大约 2 到 9 秒。问题在重新启动龙卷风时消失，并随着龙卷风正常运行时间而恶化。服务器启动的时间越长，它停止的时间就越长。
*   出现问题的 Http 请求似乎没有任何模式。
*   有趣的是，日志中的下一个请求有时有时与停止持续时间匹配，有时则不匹配。例子：

> ```
> 00:00:00      GET /some/request ()
> 00:00:09      GET /next/request (9000ms)
> 
> 00:00:00     GET /some/request ()
> 00:00:09     GET /next/request (1ms)
> # 9 seconds gap in requests is certainly not possible as clients are constantly polling. 
> ```

*   数据库（mongodb）显示没有昂贵或大量的查询。没有页面错误。数据库在同一台机器上 - 本地磁盘。
*   与前几分钟相比，vmstat 显示读/写大小没有变化。
*   龙卷风在 nginx 后面运行。

*   在最有可能停止时发送 SIGINT，每次都会给出不同的堆栈跟踪。其中一些如下：

> ```
> Traceback (most recent call last):
>   File "chat/main.py", line 3396, in <module>
>     main()
>   File "chat/main.py", line 3392, in main
>     tornado.ioloop.IOLoop.instance().start()
>   File "/home/ubuntu/tornado/tornado/ioloop.py", line 515, in start
>     self._run_callback(callback)
>   File "/home/ubuntu/tornado/tornado/ioloop.py", line 370, in _run_callback
>     callback()
>   File "/home/ubuntu/tornado/tornado/stack_context.py", line 216, in wrapped
>     callback(*args, **kwargs)
>   File "/home/ubuntu/tornado/tornado/iostream.py", line 303, in wrapper
>     callback(*args)
>   File "/home/ubuntu/tornado/tornado/stack_context.py", line 216, in wrapped
>     callback(*args, **kwargs)
>   File "/home/ubuntu/tornado/tornado/httpserver.py", line 298, in _on_request_body
>     self.request_callback(self._request)
>   File "/home/ubuntu/tornado/tornado/web.py", line 1421, in __call__
>     handler = spec.handler_class(self, request, **spec.kwargs)
>   File "/home/ubuntu/tornado/tornado/web.py", line 126, in __init__
>     application.ui_modules.iteritems())
>   File "/home/ubuntu/tornado/tornado/web.py", line 125, in <genexpr>
>     self.ui["_modules"] = ObjectDict((n, self._ui_module(n, m)) for n, m in
>   File "/home/ubuntu/tornado/tornado/web.py", line 1114, in _ui_module
>     def _ui_module(self, name, module):
> KeyboardInterrupt
> 
> Traceback (most recent call last):
>   File "chat/main.py", line 3398, in <module>
>     main()
>   File "chat/main.py", line 3394, in main
>     tornado.ioloop.IOLoop.instance().start()
>   File "/home/ubuntu/tornado/tornado/ioloop.py", line 515, in start
>     self._run_callback(callback)
>   File "/home/ubuntu/tornado/tornado/ioloop.py", line 370, in _run_callback
>     callback()
>   File "/home/ubuntu/tornado/tornado/stack_context.py", line 216, in wrapped
>     callback(*args, **kwargs)
>   File "/home/ubuntu/tornado/tornado/iostream.py", line 303, in wrapper
>     callback(*args)
>   File "/home/ubuntu/tornado/tornado/stack_context.py", line 216, in wrapped
>     callback(*args, **kwargs)
>   File "/home/ubuntu/tornado/tornado/httpserver.py", line 285, in _on_headers
>     self.request_callback(self._request)
>   File "/home/ubuntu/tornado/tornado/web.py", line 1408, in __call__
>     transforms = [t(request) for t in self.transforms]
>   File "/home/ubuntu/tornado/tornado/web.py", line 1811, in __init__
>     def __init__(self, request):
> KeyboardInterrupt
> 
> Traceback (most recent call last):
>   File "chat/main.py", line 3351, in <module>
>     main()
>   File "chat/main.py", line 3347, in main
>     tornado.ioloop.IOLoop.instance().start()
>   File "/home/ubuntu/tornado/tornado/ioloop.py", line 571, in start
>     self._handlers[fd](fd, events)
>   File "/home/ubuntu/tornado/tornado/stack_context.py", line 216, in wrapped
>     callback(*args, **kwargs)
>   File "/home/ubuntu/tornado/tornado/netutil.py", line 342, in accept_handler
>     callback(connection, address)
>   File "/home/ubuntu/tornado/tornado/netutil.py", line 237, in _handle_connection
>     self.handle_stream(stream, address)
>   File "/home/ubuntu/tornado/tornado/httpserver.py", line 156, in handle_stream
>     self.no_keep_alive, self.xheaders, self.protocol)
>   File "/home/ubuntu/tornado/tornado/httpserver.py", line 183, in __init__
>     self.stream.read_until(b("\r\n\r\n"), self._header_callback)
>   File "/home/ubuntu/tornado/tornado/iostream.py", line 139, in read_until
>     self._try_inline_read()
>   File "/home/ubuntu/tornado/tornado/iostream.py", line 385, in _try_inline_read
>     if self._read_to_buffer() == 0:
>   File "/home/ubuntu/tornado/tornado/iostream.py", line 401, in _read_to_buffer
>     chunk = self.read_from_fd()
>   File "/home/ubuntu/tornado/tornado/iostream.py", line 632, in read_from_fd
>     chunk = self.socket.recv(self.read_chunk_size)
> KeyboardInterrupt 
> ```

非常感谢有关如何解决此问题的任何提示。

进一步的观察：

*   strace -p 在挂起期间显示空输出。

*   ltrace -p 在挂起期间*仅*显示大量 free() 调用： free(0x6fa70080) = free(0x1175f8060) = free(0x117a5c370) =

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T21:52:26.217

听起来您正遭受垃圾收集 (GC) 风暴的困扰。您描述的行为是该诊断的典型行为，并且*ltrace*进一步支持了该假设。

*在您的使用情况下正在执行的主/事件循环中分配和处置了许多对象......并且由此产生了对free()*的周期性调用。

一种可能的方法是分析您的代码（或您所依赖的库），看看您是否可以重构它以使用（和重用）来自预分配池的对象。

另一种可能的缓解措施是让您自己更频繁地调用来触发垃圾收集——总体上更昂贵，但每次调用的成本可能更低。（这将是一个更可预测的吞吐量的权衡）。

您也许可以使用[Python: gc 模块](http://docs.python.org/2/library/gc.html)来更深入地调查问题（使用**gc.set_debug()** ）和尝试简单的缓解措施（例如，在每次事务后调用**gc.collect() ）。**您也可以尝试使用**gc.disable()**运行您的应用程序一段合理的时间，以查看是否进一步涉及 Python 垃圾收集器。请注意，长时间禁用垃圾收集器几乎肯定会导致分页/交换……所以仅将其用于验证我们的假设，不要指望以任何有意义的方式解决问题。它可能只是将问题推迟到整个系统崩溃并需要重新启动。

这是在 Tornado 上的另一个 SO 线程中使用**gc.collect()**的示例： [SO: Tornado memory leak on dropped connections](https://stackoverflow.com/questions/12626064/tornado-memory-leak-on-dropped-connections)

# javascript - 如何在新标签页中打开页面（谷歌浏览器问题）

> ID：15114687
> 
> 赞同：0
> 
> 时间：2013-02-27T14:34:33.080
> 
> 标签：javascript, google-chrome, scriptmanager

我通过以下代码在新选项卡中打开我的页面：

```
String js = "window.open('" + page + "'" + ", '_blank');";

ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "Open", js, true); 
```

但`Google chrome`它会在新窗口而不是新标签中打开！

如何让它在新标签页中打开甚至最大化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:37:48.827

您不能强制浏览器打开选项卡而不是窗口。这取决于浏览器。我正在使用 Chrome 24.0.1312.57m，所有链接，无论是`_blank`还是，都在*tabs*`_new`中打开，而不是在新窗口中打开。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:38:32.557

Javascript 代码无法确保。这取决于用户的浏览器设置是否会在新窗口或选项卡中打开页面。*

# delphi - 当我在基类上调用方法时，如何调用后代的实现？

> ID：15114690
> 
> 赞同：4
> 
> 时间：2013-02-27T14:34:42.413
> 
> 标签：delphi, inheritance

我的顶级类是`TBaseDB`，它有一个后代`TCommonDB`（，并且`TCommonDB`将有多个后代，比如`TProdDB`and `TDevDB`）。

*让我们在每个*类定义中创建一个函数，称为`Test1`. 现在，它所做的`ShowMessage('Some literal')`只是向我展示正在执行的代码。

直到运行时我才知道类类型。我想要有共同的代码，但不同的行为。

我想要的是这样的：

```
var
  MyObj: TBaseDB;
begin        
  //pseudo-code...
  if RadioButton1.Checked then
    MyObj := TBaseDB.Create
  else
    MyObj := TCommonDB.create;
  MyObj.Test1;    
end; 
```

我似乎无法让它工作，我想它在我的班级定义中。应该如何`Test1`定义，以便：

1.  我可以将我的变量声明为`TBaseDB`，
2.  创建的类可以是`TBaseDB`或`TCommonDB`, 和
3.  将根据实例是 a还是?调用*正确的过程* `Test``TBaseDB``TCommonDB`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-27T14:38:51.803

```
program Project1;

{$APPTYPE CONSOLE}

uses
  SysUtils;

type
  TFruit = class
  public
    procedure ShowMessage; virtual; abstract;
  end;

  TApple = class(TFruit)
  public
    procedure ShowMessage; override;
  end;

  TOrange = class(TFruit)
  public
    procedure ShowMessage; override;
  end;

{ TApple }

procedure TApple.ShowMessage;
begin
  Writeln('I''m an apple!');
end;

{ TOrange }

procedure TOrange.ShowMessage;
begin
  Writeln('I''m an orange!');
end;

var
  fruit: TFruit;

begin

  fruit := TApple.Create;

  fruit.ShowMessage;

  Writeln('Press Enter to continue.');
  Readln;

end. 
```

关键字`abstract`允许您在基类中完全没有实现。但是，您也可以在那里实现：

```
program Project2;

{$APPTYPE CONSOLE}

uses
  SysUtils;

type
  TFruit = class
  public
    procedure ShowMessage; virtual;
  end;

  TApple = class(TFruit)
  public
    procedure ShowMessage; override;
  end;

  TOrange = class(TFruit)
  public
    procedure ShowMessage; override;
  end;

{ TFruit }

procedure TFruit.ShowMessage;
begin
  Writeln('I''m a fruit.');
end;

{ TApple }

procedure TApple.ShowMessage;
begin
  inherited;
  Writeln('I''m an apple!');
end;

{ TOrange }

procedure TOrange.ShowMessage;
begin
  inherited;
  Writeln('I''m an orange!');
end;

var
  fruit: TFruit;

begin

  fruit := TApple.Create;

  fruit.ShowMessage;

  Writeln('Press Enter to continue.');
  Readln;

end. 
```

**练习：**

1.  在每种情况下，如果您创建 的实例会发生什么`TFruit`？
2.  在第二种情况下，`inherited`in`TApple.ShowMessage`和`TOrange.ShowMessage`是什么意思？他们是否需要处于程序的顶端？如果你省略它们会发生什么？

# objective-c - 将 NSRange 从高到低设置

> ID：15114691
> 
> 赞同：0
> 
> 时间：2013-02-27T14:34:48.180
> 
> 标签：objective-c, cocoa, objective-c-blocks, nsrange

我需要提供一个`NSRange`在`assetLibrary`用户照片库上运行的。我想从头开始。

我找不到一种方法来给出从末尾开始的范围。

```
 NSRange range;
 range.length=[group numberOfAssets];
 NSIndexSet *set = [NSIndexSet indexSetWithIndexesInRange: range];
 // ** i need to get a set to start from [group numberOfAssets] and down !

 [group enumerateAssetsAtIndexes:set 
                         options:0 
                      usingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop) {
     UIImage *thumbnail = [UIImage imageWithCGImage:[result thumbnail]]; 
```

现在我正在从 0 及以上获取图像，我需要相反的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:40:09.997

尝试使用`NSEnumerationReverse`

```
[group enumerateAssetsAtIndexes:set options:NSEnumerationReverse usingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop) {
    // Do something
}]; 
```

# python - 在 PyInstaller 中找不到导入的模块

> ID：15114695
> 
> 赞同：13
> 
> 时间：2013-02-27T14:34:53.520
> 
> 标签：python, windows, sockets, exe, pyinstaller

我在 Windows 中工作，`PyInstaller`用于打包 python 文件。但是发生了一些错误：

```
Traceback (most recent call last):
  File "<string>", line 2, in <module>
  File "D:\Useful Apps\pyinstaller-2.0\PyInstaller\loader\iu.py", line 386, in importHook
    mod = _self_doimport(nm, ctx, fqname)
  File "D:\Useful Apps\pyinstaller-2.0\PyInstaller\loader\iu.py", line 480, in doimport
    exec co in mod.__dict__
  File "D:\Useful Apps\pyinstaller-2.0\server\build\pyi.win32\server\out00-PYZ.pyz\SocketServer", line 132, in <module>
  File "D:\Useful Apps\pyinstaller-2.0\PyInstaller\loader\iu.py", line 386, in importHook
    mod = _self_doimport(nm, ctx, fqname)
  File "D:\Useful Apps\pyinstaller-2.0\PyInstaller\loader\iu.py", line 480, in doimport
    exec co in mod.__dict__
  File "D:\Useful Apps\pyinstaller-2.0\server\build\pyi.win32\server\out00-PYZ.pyz\socket", line 47, in <module>
  File "D:\Useful Apps\pyinstaller-2.0\PyInstaller\loader\iu.py", line 409, in importHook
    raise ImportError("No module named %s" % fqname)
ImportError: No module named _socket 
```

我知道那`_socket`是在 path `C:\Python27\libs\_socket.lib`，但是如何让生成的`EXE`找到那个文件呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-03-11T11:12:25.970

如果您使用的是 virtualenv，您应该使用“-p”或“--path='D:...'”选项。像这样：

```
pyinstaller.exe --onefile --paths=D:\env\Lib\site-packages  .\foo.py 
```

这样做是用这个 pathex 路径生成 foo.spec 文件

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T18:15:25.600

这听起来像是[隐藏导入](http://pythonhosted.org/PyInstaller/#listing-hidden-imports)的工作（仅在最新版本中可用）。

从文档

```
a = Analysis(['myscript.py'], 
             hiddenimports = ['_socket'], 
             <and everything else>) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-05-27T15:28:02.043

就我而言，我必须删除与`pyinstaller`我的目录中相关的所有文件夹和文件，即`__pycache__`、`build`、`dist`和`*.spec`. 我重新运行构建并且 exe 工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-05T15:06:41.937

您可以将路径添加到应用程序规范文件。

在[Analysis](http://pythonhosted.org/PyInstaller/#analysis-finding-the-files-your-program-needs)对象中，您可以指定`pathex=['C:\Python27\libs\', 'C:\Python27\Lib\site-packages']`任何其他路径...

请注意，如果找不到路径，则没有问题……我也有来自 linux 的路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-03T14:15:10.177

只需删除`'__pycache__'`目录，然后再次运行您的 exe 文件。它对我有用

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-04T19:52:10.873

如果您使用的是虚拟环境，那么问题在于环境。

**解决方案** 只需激活环境并运行 pyinstaller 命令。例如，如果您使用的是 pipenv 环境，则按以下顺序运行命令。

```
pipenv shell # To activate environment

pyintaller --onefile youscript.py # Command to generate executable 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-19T20:32:13.917

有类似的问题。这是我对 PyQt5、cffi、python 3.4.3 的修复：

这修复了“sip”未找到错误和“_cffi_backend”错误（如果出现）：

```
# -*- mode: python -*-

block_cipher = None

a = Analysis(['LightShowApp.py'],
             pathex=['c:\\MyProjects\\light-show-editor-36',
             'c:\\Python34\\libs\\', 'c:\\Python34\\Lib\\site-packages'],
             binaries=None,
             datas=None,
             hiddenimports=['sip', 'cffi'],
             hookspath=[],
             runtime_hooks=[],
             excludes=[],
             win_no_prefer_redirects=False,
             win_private_assemblies=False,
             cipher=block_cipher)
pyz = PYZ(a.pure, a.zipped_data,
             cipher=block_cipher)
exe = EXE(pyz,
          a.scripts,
          a.binaries,
          a.zipfiles,
          a.datas,
          name='LightShowApp',
          debug=False,
          strip=False,
          upx=True,
          console=True ) 
```

查看上面的“pathex”和“hiddenimports”。这些是默认生成的唯一更改。使用以下命令构建 exe：

`pyinstaller LightShowApp.spec -F`

我在 venv 或 pip-win 之外运行了它——不管那个垃圾是为了什么！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-21T13:52:46.657

以上答案都不适合我，但我确实让它起作用了。我使用的是 openpyxl，它在 datetime.py 模块中需要 jdcal。隐藏的导入或任何这些方法都没有帮助，运行 exe 仍然会说找不到 jdcal。我使用的解决方法是将 jdcal 中的几个函数直接复制到 openpyxl 代码中的 datetime.py 中。然后跑了 `pyinstaller -F program.py`

它奏效了！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-30T18:10:03.847

执行程序不知道库的位置，“C:\Python27\Lib\site-packages”等。因此，pyinstaller 在创建可执行文件时绑定模块位置。因此，您需要将您使用过的所有模块导入到您的程序中。

在主文件中导入“_socket”模块并使用 pyinstaller 重新编译。

我可能会工作。

**注意：**但您系统中安装的和程序中使用的模块的版本必须兼容。

# uml - 在活动图中描述决策

> ID：15114707
> 
> 赞同：1
> 
> 时间：2013-02-27T14:35:25.213
> 
> 标签：uml, activity-diagram

海

我如何在 UML 活动图中描述这一点？

最新（earliest_start_date，最早（latest_start_date，start_date））

这意味着：从 latest_start_date 和 start_date 中选择最早的，如果它晚于上一个决定的结果，则使用 early_start_date。我用钻石试过了，但我想我需要更多。

我希望你能帮帮我

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:20:38.810

最复杂的部分是决策节点将它们收到的令牌（即“值”）传递给所选边缘，然后您需要明确表明该值已根据执行的分支而改变。如果您将建模`start_date`为对象流（其中`start_date`流过图表的值）并且`earliest_start_date`是`latest_start_date`范围内的变量或常量，您可以将操作表示为：

![在此处输入图像描述](../Images/4c341dbea49fe303f4ea043369be3545.png)

（注意，我假设`earliest<latest`为了简化分支）上面的“菱形”是一个*决策节点*。三个分支中的一个被选择，这取决于在每个边的括号之间给出的*分支*（即条件）。下面的菱形是一个*合并节点*（替代执行路径相遇的地方）。在守卫的符号中，我假设`<`运算符适用于 start_date 的类型。

另一种方法是编写一个表示操作的转换。在这种情况下， 的输入`ActionState2`将是转换的结果，其中`start_date`是 的输出`ActionState1`。

![在此处输入图像描述](../Images/eaaf5759254a19914f088a177e754d68.png)

第三种方法是将操作编写为执行此类计算的操作的后置条件（即，将构造型`«postcondition»`附加到操作的约束）。

如果`Latest`和`Earliest`被定义为模型中的函数，则后置条件为：

```
result = Latest (earliest_start_date, 
                  Earliest (latest_start_date, start_date)) 
```

![在此处输入图像描述](../Images/543f6037fd4a78541b152607ac6dca15.png)

如果`start_date`定义了`min`and的类型`max`，则后置条件可以写成：

```
result = min(Set{latest_start_date, 
             max(Set{earliest_start_date,start_date})}); 
```

(即a) latest_start_date 组成的集合的最小值，b) early_start_date 和start_date 组成的集合的最大值。

如果`<`为 的类型定义了运算符`start_date`，则后置条件为：

```
result = if start_date<earliest_start_date 
            then earliest_start_date 
            else 
              if start_data>latest_start_date 
                then latest_start_date 
                else start_date
              endif
          endif 
```

您也可以将其表示为 ConditionalNode（从多个备选方案中选择一个的结构化活动节点），但没有为 ConditionalNodes 定义标准符号。

# c - 如何在 ubuntu 上编译厄运？

> ID：15114709
> 
> 赞同：6
> 
> 时间：2013-02-27T14:35:31.480
> 
> 标签：c, linux, gcc, ubuntu, compilation

我正在尝试编译原始 doom 的源代码作为学习 C 的一种方式。我从[github](https://github.com/id-Software/DOOM)下载了它并修复了 i_video.c 第 49 行（errnos.h -> errno.h）中的一个明显错误。

我现在明白了：

```
m_misc.c:257:5: warning: initialization from incompatible pointer type [enabled by default]
m_misc.c:257:5: warning: (near initialization for ‘defaults[14].location’) [enabled by default]
m_misc.c:257:5: error: initializer element is not computable at load time
m_misc.c:257:5: error: (near initialization for ‘defaults[14].defaultvalue’)
m_misc.c:264:35: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:264:5: error: initializer element is not constant
m_misc.c:264:5: error: (near initialization for ‘defaults[16].defaultvalue’)
m_misc.c:265:37: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:265:5: error: initializer element is not constant
m_misc.c:265:5: error: (near initialization for ‘defaults[17].defaultvalue’)
m_misc.c:288:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:288:5: error: initializer element is not constant
m_misc.c:288:5: error: (near initialization for ‘defaults[31].defaultvalue’)
m_misc.c:289:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:289:5: error: initializer element is not constant
m_misc.c:289:5: error: (near initialization for ‘defaults[32].defaultvalue’)
m_misc.c:290:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:290:5: error: initializer element is not constant
m_misc.c:290:5: error: (near initialization for ‘defaults[33].defaultvalue’)
m_misc.c:291:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:291:5: error: initializer element is not constant
m_misc.c:291:5: error: (near initialization for ‘defaults[34].defaultvalue’)
m_misc.c:292:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:292:5: error: initializer element is not constant
m_misc.c:292:5: error: (near initialization for ‘defaults[35].defaultvalue’)
m_misc.c:293:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:293:5: error: initializer element is not constant
m_misc.c:293:5: error: (near initialization for ‘defaults[36].defaultvalue’)
m_misc.c:294:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:294:5: error: initializer element is not constant
m_misc.c:294:5: error: (near initialization for ‘defaults[37].defaultvalue’)
m_misc.c:295:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:295:5: error: initializer element is not constant
m_misc.c:295:5: error: (near initialization for ‘defaults[38].defaultvalue’)
m_misc.c:296:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:296:5: error: initializer element is not constant
m_misc.c:296:5: error: (near initialization for ‘defaults[39].defaultvalue’)
m_misc.c:297:45: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
m_misc.c:297:5: error: initializer element is not constant
m_misc.c:297:5: error: (near initialization for ‘defaults[40].defaultvalue’)
m_misc.c: In function ‘M_LoadDefaults’:
m_misc.c:395:5: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
make: *** [linux/m_misc.o] Error 1 
```

在此声明期间的 m_misc.c 文件中包含强制转换的行：

```
default_t   defaults[] =
{
    {"mouse_sensitivity",&mouseSensitivity, 5},
    {"sfx_volume",&snd_SfxVolume, 8},
    {"music_volume",&snd_MusicVolume, 8},
    {"show_messages",&showMessages, 1},

#ifdef NORMALUNIX
    {"key_right",&key_right, KEY_RIGHTARROW},
    {"key_left",&key_left, KEY_LEFTARROW},
    {"key_up",&key_up, KEY_UPARROW},
    {"key_down",&key_down, KEY_DOWNARROW},
    {"key_strafeleft",&key_strafeleft, ','},
    {"key_straferight",&key_straferight, '.'},

    {"key_fire",&key_fire, KEY_RCTRL},
    {"key_use",&key_use, ' '},
    {"key_strafe",&key_strafe, KEY_RALT},
    {"key_speed",&key_speed, KEY_RSHIFT},

// UNIX hack, to be removed. 
#ifdef SNDSERV
    {"sndserver", (int *) &sndserver_filename, (int) "sndserver"},
    {"mb_used", &mb_used, 2},
#endif

#endif

#ifdef LINUX
    {"mousedev", (int*)&mousedev, (int)"/dev/ttyS0"},
    {"mousetype", (int*)&mousetype, (int)"microsoft"},
#endif

    {"use_mouse",&usemouse, 1}, 
    {"mouseb_fire",&mousebfire,0},
    {"mouseb_strafe",&mousebstrafe,1},
    {"mouseb_forward",&mousebforward,2},

    {"use_joystick",&usejoystick, 0}, 
    {"joyb_fire",&joybfire,0},
    {"joyb_strafe",&joybstrafe,1},
    {"joyb_use",&joybuse,3},
    {"joyb_speed",&joybspeed,2},

    {"screenblocks",&screenblocks, 9}, 
    {"detaillevel",&detailLevel, 0}, 

    {"snd_channels",&numChannels, 3}, 

    {"usegamma",&usegamma, 0},
    {"chatmacro0", (int *) &chat_macros[0], (int) HUSTR_CHATMACRO0 },
    {"chatmacro1", (int *) &chat_macros[1], (int) HUSTR_CHATMACRO1 },
    {"chatmacro2", (int *) &chat_macros[2], (int) HUSTR_CHATMACRO2 },
    {"chatmacro3", (int *) &chat_macros[3], (int) HUSTR_CHATMACRO3 },
    {"chatmacro4", (int *) &chat_macros[4], (int) HUSTR_CHATMACRO4 },
    {"chatmacro5", (int *) &chat_macros[5], (int) HUSTR_CHATMACRO5 },
    {"chatmacro6", (int *) &chat_macros[6], (int) HUSTR_CHATMACRO6 },
    {"chatmacro7", (int *) &chat_macros[7], (int) HUSTR_CHATMACRO7 },
    {"chatmacro8", (int *) &chat_macros[8], (int) HUSTR_CHATMACRO8 },
    {"chatmacro9", (int *) &chat_macros[9], (int) HUSTR_CHATMACRO9 }

}; 
```

这与现代编译器不兼容吗？有没有人设法通过它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T15:37:43.350

如果您使用的是 64 位编译器，请尝试使用该`-m32`标志并链接到`-L/usr/lib/i386-linux-gnu/`32 位库。

顺便说一句，如果你要编译这个源代码，你仍然会遇到运行问题，因为这个构建需要 320x200 的屏幕分辨率。否则它不会运行。

我正在开发 DOOM 的 SDL 端口，所以你可以试试我在[GitHub 上](https://github.com/aserebryakov/sdl_doom)的源代码。

您需要安装 SDL 库才能运行它。此外，那里没有声音。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T15:41:09.763

至于初始化列表错误，它就在那里——初始化列表中的元素不是常量表达式。看看这个：

```
{"mousedev", (int*)&mousedev, (int)"/dev/ttyS0"}, 
```

我猜`mousedev`是另一个变量。你有它。

我现在不记得了，但我认为初始化列表中的非常量是在后来的 C 标准之一中引入的。尝试使编译器坚持使用不同的编译器 - 我会尝试使用 C99。 [http://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#C-Dialect-Options](http://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#C-Dialect-Options)

Alex 正确回答了关于整数与指针大小的问题。

# c# - 我想在 C#.net Winforms 应用程序中执行任务并行

> ID：15114711
> 
> 赞同：-3
> 
> 时间：2013-02-27T14:35:39.953
> 
> 标签：c#, multithreading

我有 2 `Panels`。两个面板都加载给定的时间。现在我想在两个面板上添加一些动画

```
// animation start of panel1
panel1.show();

// animation start of panel2
panel2.show(); 
```

完成`panel1`动画后，第二个面板动画开始。Soo 现在我想同时为两个面板设置动画。

我认为多线程可以做到这一点。你能告诉我这在我的情况下如何工作吗？

```
public static class Util { 
    public enum Effect { Roll, Slide, Center, Blend } 
    public static void Animate(Control ctl, Effect effect, int msec, int angle) 
    { 
         int flags = effmap[(int)effect]; 
         if (ctl.Visible) {flags |= 0x10000; angle += 180;} 
         else { 
              if (ctl.TopLevelControl == ctl) flags |= 0x20000; 
              else if (effect == Effect.Blend) throw new ArgumentException(); 
         } 
         flags |= dirmap[(angle % 360) / 45]; 
         bool ok = AnimateWindow(ctl.Handle, msec, flags); 
         if (!ok) throw new Exception("Animation failed"); 
         ctl.Visible = !ctl.Visible; 
     } 

     private static int[] dirmap = { 1, 5, 4, 6, 2, 10, 8, 9 }; 
     private static int[] effmap = { 0, 0x40000, 0x10, 0x80000 }; 

     [DllImport("user32.dll")] private static extern bool 
        AnimateWindow(IntPtr handle, int msec, int flags); 
} 

private void Form1_Load(object sender, EventArgs e) { 
     Util.Animate(radPanel1, Util.Effect.Slide, 700, 360); 
     radPanel1.Show(); 
     expandablePanel1.Expanded = true;
} 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-27T14:50:46.597

我建议使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)或[Timer](http://msdn.microsoft.com/pl-pl/library/aa983736%28v=vs.71%29.aspx)组件。

# php - mongodb：将 mysql 列插入为 mongodb 子文档

> ID：15114713
> 
> 赞同：0
> 
> 时间：2013-02-27T14:35:44.910
> 
> 标签：php, mysql, mongodb

我正在尝试将 mysql 表导入 mongodb 集合。我想将 mysql 列作为 mongodb 子文档：MYSQL =>

```
| col1 | col2 | col3 | col4 |
------------------------------
| abc  | def  | ghi  | jkl  |
------------------------------
| 1234 | 5678 | 9876 | 4567 |
------------------------------
| abc  | def  | ghi  | jkl  |
------------------------------
etc..... 
```

在 mongodb 中希望它们看起来像：MongoDB =>

```
> doc1: { 
>                col1["abc", "1234", "abc", .....],
>                col2["def", "5678", "def", .....],
>                col3["ghi", "9876", "ghi", .....],
>                col4["jkl", "4567", "jkl", .....],
>                etc. 
```

我使用 php，我的代码如下所示：

```
$sql=mysql_query("select * from mytable") or die (mysql_error());
$count=mysql_num_rows($sql);
if (count > 0) {
while($data=mysql_fetch_row($sql)){
$mosql[]=$data;
}
$collection -> insert($mosql)
} 
```

作为我得到的输出，它给了我行而不是列：

> doc1: { col1:[0:"abc", 1:"def", 2:"ghi", 3:"jkl".....], col2:[0:"1234", 1:"5678" , 2:"9876", 3:"4567" .....], col3:[0:"abc", 1:"def", 2:"ghi", 3:"jkl"..... ]， ETC。

有人知道我做错了什么吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:42:33.133

您可能想尝试遍历从 MySQL 返回的行数组，并将文档一个接一个地插入 MongoDB 集合，而不是一次插入整个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T16:53:20.013

最后我想出了如何做到这一点，可能是这种方式太长了，但我得到了我想要的：

```
//var77
foreach( $mytables as $table => $struct ) {
  $sql77 = mysql_query("SELECT WINDSHEAR FROM XL_10331_EXPLOIT_251012 where flightid like '191622'") or die( mysql_error() );
  $count77 = mysql_num_rows( $sql77 );
  // If it has content insert all content
  if( $count77 > 0 ) {
    while($info77 = mysql_fetch_row($sql77)) {
      $mosql77[]=$info77[0];
  }

//var78
foreach( $mytables as $table => $struct ) {
  $sql78 = mysql_query("SELECT WING_AI_SYS_ON FROM XL_10331_EXPLOIT_251012 where flightid like '191622'") or die( mysql_error() );
  $count78 = mysql_num_rows( $sql78 );
  // If it has content insert all content
  if( $count78 > 0 ) {
    while($info78 = mysql_fetch_row($sql78)) {
      $mosql78[]=$info78[0];
  }

      $collection->insert(array('flightid'=>191622, 'AI_PB_ON_1'=>$mosql77, 'AI_PB_ON_2'=>$mosql78, etc....)); 
```

# types - JESS -> 如何检查变量的类型并进行测试？

> ID：15114719
> 
> 赞同：2
> 
> 时间：2013-02-27T14:36:02.830
> 
> 标签：types, numbers, integer, jess

我在 JESS（Java Expert System Shell）中有一个任务，但我遇到了一些麻烦。

我正在尝试检查某个变量（从键盘读取）是否为正整数（我已经设法检查它是否为正），但我找不到检查变量是否为正的方法（或函数）是一个整数/数字。

我尝试了 intergerp 和 numberp 功能*，*但*这些*似乎不起作用。

有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:42:13.347

`integerp`确实是检查某事物是否为整数的方法，正如您在下面的成绩单中所见。

```
Jess> (bind ?x (read))
1
1
Jess> (integerp ?x)
TRUE
Jess> (bind ?y (read))
foo
foo
Jess> (integerp ?y)
FALSE
Jess> (bind ?z (read))
1.1
1.1
Jess> (integerp ?z)
FALSE 
```

# c - 在 libcurl 中使用私有 RSA 密钥进行 SFTP 身份验证

> ID：15114723
> 
> 赞同：1
> 
> 时间：2013-02-27T14:36:14.337
> 
> 标签：c, curl, libcurl, sftp

我正在使用`stfp server`，但它需要 RSA 密钥身份验证，这里我想在我的`sftp`服务器上上传文件。

所以请任何人都可以告诉我如何在 C 中以编程方式使用私钥对我的 SFTP 服务器进行身份验证`RSA`。我想在 C 中做这件事

我正在使用此[链接](http://curl.haxx.se/libcurl/c/fileupload.html)作为参考

但是这里没有提到如何使用 RSA 密钥对此 SFTP 进行身份验证。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-28T12:21:23.510

对于公钥身份验证，我添加了以下选项：

```
const char* path_to_my_public_key = "~/.ssh/id_rsa.pub";
const char* path_to_my_private_key = "~/.ssh/id_rsa";

curl_easy_setopt(m_curl, CURLOPT_SSH_AUTH_TYPES, CURLSSH_AUTH_PUBLICKEY);
curl_easy_setopt(m_curl, CURLOPT_SSH_PUBLIC_KEYFILE, path_to_my_public_key);
curl_easy_setopt(m_curl, CURLOPT_SSH_PRIVATE_KEYFILE, path_to_my_private_key); 
```

# sql - 多个表中的多个联接

> ID：15114726
> 
> 赞同：-1
> 
> 时间：2013-02-27T14:36:16.920
> 
> 标签：sql, inner-join, multiple-tables

我有下表：

```
patient: id, incidentCode, name, insurance, contactdetailsID
contactDetails: id, cityCode
lookup: id, lookupdescription
incident: id, date 
```

患者加入联系人详细信息，例如：

```
inner join contactdetails on patient.contactdetailsid=contactdetails.id 
```

患者加入事件如下：

```
inner join incident on patient.incidentCode=incident.id 
```

患者加入查找如下：

```
inner join lookup on patient.insurance = lookup.id 
```

和联系方式加入查找，如：

```
inner join lookup on contactdetails.citycode = lookup.id 
```

现在我想从患者保险和contactdetails Citycode中同时选择Lookup.lookupDescription。我怎样才能做到这一点？在选择时，我还想要患者姓名、患者 ID、事件日期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:38:49.077

例如

```
SELECT
  patient.id,
  lookup.lookupdescription,
  contactDetails.cityCode
FROM patient
INNER JOIN contactdetails on patient.contactdetailsid=contactdetails.id
INNER JOIN ...
INNER JOIN ...
INNER JOIN ...
WHERE patient.id = xy 
```

顺便说一句：`JOIN`你提供的最后一个对我来说似乎没有那么有意义？！看起来像是`lookup.id`一个城市代码，同时又是一个保险号码？！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:40:07.997

```
SELECT  d.lookupDescription,
        a.insurance,
        e.Citycode,
        a.name,
        a.id,
        c.date
FROM    patient a
        INNER JOIN contactdetails b
            ON a.contactdetailsid = b.id
        INNER JOIN  incident c
            ON a.incidentCode = c.id
        INNER JOIN lookup d
            ON a.insurance = d.id
        INNER JOIN contactdetails e
            ON e.citycode = d.id 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

# javascript - Twitter 引导轮播 youtube 视频自动启动

> ID：15114727
> 
> 赞同：0
> 
> 时间：2013-02-27T14:36:21.930
> 
> 标签：javascript, jquery, twitter-bootstrap, youtube-api, youtube-javascript-api

我创建了一个 Twitter Bootstrap 轮播来显示图片和文本。到目前为止，这很好。但我想将 YouTube 视频添加到幻灯片中，我希望视频自动开始播放，视频播放完毕后，我希望轮播转到下一张幻灯片。

我曾尝试使用 YouTube 选项来完成类似的操作`?autoplay=1`，但因为所有 div 都是在启动时加载的，所以在加载页面时视频开始播放。我还没有找到任何解决等待视频结束问题的方法。

我希望有人可以帮助我。

编辑： [http](http://pastie.org/6348104) ://pastie.org/6348104 这是我用于轮播的代码。轮播功能齐全，但我将 Bootstrap 文件存储在本地。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:43:00.287

您可能希望附加 YouTube 的`player.playVideo()` [（示例）](https://developers.google.com/youtube/iframe_api_reference#Examples)函数作为函数的回调`carousel('cycle')`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-17T11:35:16.247

添加

```
style="transform: none;" 
```

和你`div`在一起`modal pop up``class="modal-dialog"`

到你的模态对话

# asp.net - visual studio - 如何将我的代码从旧的 Web 应用程序模板移动到新的空 Web 应用程序？

> ID：15114730
> 
> 赞同：1
> 
> 时间：2013-02-27T14:36:29.540
> 
> 标签：asp.net, visual-studio

当我开始学习 asp.net 时，我在 Visual Studio 中创建了一个新项目，但它不是空的，它似乎是一个包含 Site.master、Default.aspx、Global.asax 的模板......甚至还有一个数据库. 我开始在 Default.aspx 中编写代码。

在继续编码时，当我尝试从控件访问数据和访问控件时出现错误，例如`'textbox3' is not declared. It may be inaccessible due to its protection level.`

所以我需要开始一个新项目（这次是空的）并将我的代码从旧项目移动到新的空项目。

**问题**

我怎样才能做到这一点？我必须从旧项目中获取什么代码？我也必须有一个新的 Site.master 页面，还是应该从中获取任何代码，`<form runat="server">`例如？

*   我只需要传输 Default.aspx、它的代码隐藏和 Connection.vb（我创建的一个类）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:57:16.707

尝试修复文本框名称以匹配设计器文件中的名称，错误应该会消失。如果失败，请尝试重新创建 Default.aspx，然后删除旧副本。

# javascript - ontouchstart 删除 ipad iphone 中的悬停

> ID：15114731
> 
> 赞同：1
> 
> 时间：2013-02-27T14:36:38.170
> 
> 标签：javascript, jquery, css

我有一个按钮有：悬停效果。但是我想禁用 ipad 和 iphone 中的悬停。它不工作

```
$(document).ready(function () {
            $(".content").hide();
            $(".open1").click(function () {
                $(this).next().slideToggle(400);

                if('ontouchstart' in document){$('#btn_01').unbind('mouseenter mouseleave');}

                var btn = $('#btn_01'), isOn = btn.hasClass('on');              
                if(isOn) { btn.removeClass('on'); }
                else if(btn) { btn.addClass('on'); }
                });
        });

<style type="text/css">

    #btn_01{width:510px; height:109px; background:url('images/btn_01_on.png') no-repeat;}
        #btn_01:hover{width:510px; height:109px; background:url('images/btn_01_over.png') no-repeat;}
        #btn_01.on{width:510px; height:109px; background:url('images/btn_01_over.png') no-repeat;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:42:21.553

我会采用不同的方法：

```
jQuery(function($) {
    var className = ('ontouchstart' in document ) ? "touch-device" : "desktop-device";

    $(document.body).addClass(className);
}); 
```

然后，您可以使用`body.desktop-device`and指定您的样式中的调整`body.touch-device`：

```
body.desktop-device #btn_01:hover {
    background: red;
}
body.touch-device #btn_01 {
    background: blue;
} 
```

* * *

```
var a = b ? c : d;

//means:

if ( b ) {
    var a = c;
}
else {
    var a = d;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T13:54:23.177

找到了一种非常简单的方法来解决这个问题，使用 css @media 我将悬停的图像更改为原始图像。

```
#btn_01{btn_01_on.png'}
#btn_01:hover{btn_01_on.png'}
#btn_01.on{btn_01_over.png'}

@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : landscape) {
#btn_01{width:510px; height:109px; background:url('images/btn_01_on.png') no-repeat;}
#btn_01:hover{width:510px; height:109px; background:url('images/btn_01_on.png') no-repeat;}
#btn_01.on{width:510px; height:109px; background:url('images/btn_01_over.png') no-repeat;} 
```

# ruby-on-rails - 显示关注者列表和关注者列表

> ID：15114737
> 
> 赞同：0
> 
> 时间：2013-02-27T14:36:56.933
> 
> 标签：ruby-on-rails, ruby, loops, gem

地狱所有，

我正在使用一个名为 socialization ( [https://github.com/cmer/socialization](https://github.com/cmer/socialization) )的红宝石宝石

我让它工作了，我可以关注和取消关注用户，看看有多少人关注或关注任何用户。问题是当我想输出关注者和关注者的用户名时，它仅适用于 user1，对于用户 2-4，它将根据关注者的数量按顺序显示用户名，例如，如果表是

*   用户 1 跟随 => 用户 2
*   用户 2 跟随 => 用户 3

我要求用户 3 的关注者（知道 user3 是 1 个关注者）它会打印出 User1 无论如何（我希望这是有道理的）

这是我的代码：

UsersController 中的 Followers 方法

```
def followers
     @user = User.find(params[:user])
     @followers = @user.followers(User)
     @users = User.all

     response = {:user => @user, :followers => @followers, :users => @users}

     respond_to do |format|
      format.html  #followers.html.erb
      format.xml {render :xml => response}
    end
end 
```

用户控制器中的以下方法

```
def following
     @user = User.find(params[:user])
     @following = @user.followers(User)
     @users = User.all

     response = {:user => @user, :following => @following, :users => @users}

     respond_to do |format|
      format.html  #following.html.erb
      format.xml {render :xml => response}
    end
end 
```

以下视图：

```
<p><u>Following</u></p>

<% (1..(@following.count)).each do |i| %>

    <% if @users[i].followed_by?(@user) %> 
  <p> <%= @users[i].username %> </p>
   <% end %>
<% end %> 
```

关注者视图

```
<p><u>Followers</u></p>

<% (1..(@followers.count)).each do |i| %>

    <% if @users[i].follows?(@user) %> 
  <p> <%= @users[i].username %> </p>
   <% end %>
<% end %> 
```

我的路线

```
 resources :users do
  match 'show/:id' => 'user#show'
  collection do
    get 'follow'
    get 'unfollow'
    get 'followers'
    get 'following'
  end 
```

唯一似乎正常工作的是`/users/followers?user=1`

其他所有内容要么不显示任何内容，要么显示错误的名称。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:11:57.763

您正在吸引所有关注者`@followers`，因此请在您的视图中使用它：

```
<p><u>Followers</u></p>

<% @followers.each do |f| %> # f object is of type User.
  # You don't need the if statement that you had,
  # because you already know that they are followers.
  <p> <%= f.username %> </p>
<% end %> 
```

这将打印每个`follower`. 您遇到的其他问题是您的追随者和以下方法会做同样的事情，请检查您的 gem 的文档以找出如何获取`following`然后以类似方式构建您的视图。

# java - 如何设置单选按钮的位置？

> ID：15114739
> 
> 赞同：1
> 
> 时间：2013-02-27T14:37:02.430
> 
> 标签：java, swing, layout-manager, jradiobutton, flowlayout

我想为“性别”标签创建两个单选按钮。这是我得到的：

```
maleRB = new JRadioButton("Male", true);
femaleRB = new JRadioButton("Female", false);

radioGroup = new ButtonGroup();
radioGroup.add(maleRB);
radioGroup.add(femaleRB); 
```

但我不知道如何设置它们的位置。您设置的位置是否与设置 JLabel/JTextField 等位置的方式相同...？这是照片。我想将单选按钮放在标签“性别”旁边。

[![IMG](../Images/37164ac918f329abe84f9fa2d1909680.png)](https://i.stack.imgur.com/O8C5F.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:49:05.790

它通常取决于您使用的布局，但添加单选按钮组的一种方法是通过`JPanel`我在前面的评论中提到的。

```
JRadioButton maleRB   = new JRadioButton("Male"  , true);
JRadioButton femaleRB    = new JRadioButton("Female"   , false);

ButtonGroup bgroup = new ButtonGroup();
bgroup.add(maleRB);
bgroup.add(femaleRB);

JPanel radioPanel = new JPanel();
radioPanel.setLayout(new GridLayout(r, c)); // here r could be 1 and c could be 2 
radioPanel.add(maleRB);
radioPanel.add(femaleRB); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:44:19.593

只需将它们添加到 JPanel，就像其他任何东西一样。

`ButtonGroup`只需将它们的事件连接在一起，以便一次只能选择一个。它本身并不是一个图形化的 Swing 组件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-05-30T06:14:45.530

```
YourButton.setBounds(X, Y, Z, MAX_ENTRIES); 
```

例子：

```
Duck.setBounds(75, 100, 75, MAX_ENTRIES); 
```

# ruby - 获取不规则哈希中的电子邮件列表

> ID：15114740
> 
> 赞同：0
> 
> 时间：2013-02-27T14:37:04.250
> 
> 标签：ruby

我有 params 哈希，它由哈希的哈希组成，有时，这些哈希有一封电子邮件。获取所有电子邮件的最佳方式是什么？参数可能比 3 级更深。我只达到了通过每个参数的程度，但我不知道如何进行嵌套搜索

```
params = {
  :email => 'foo@bar.com', 
  :name => 'foo bar',
  '0' => {
    :name => 'My Name',
    :email => 'my@name.com',
    '0' => {
      :name => 'Another Name',
      :email => 'another@name.com'
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:39:46.650

有点骇人听闻，但您可以执行以下操作（未经测试）。如果您需要在数组中使用它们，您可以在方法之外声明一个实例变量，然后使用它代替`puts v`

```
def get_email(hash)
  hash.each do |k,v|
    if v.is_a?(Hash)
      get_email v
    elsif k.to_sym == :email
      puts v
    end 
  end 
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:38:33.197

Monkeypatching`Hash`类会是这样的：

```
class Hash
  def find_all key  
    self.map { |k, v|
      v.is_a?(Hash) ? v.find_all(key) : (v if k.to_sym == key.to_sym) 
    }.flatten.compact    
  end  
end  
# ⇒ nil

> params.find_all :email
# ⇒ [
#  [0] "foo@bar.com",
#  [1] "my@name.com",
#  [2] "another@name.com"
# ] 
```

# xpages - 如何在 Xpage 视图列中显示毫秒？

> ID：15114746
> 
> 赞同：0
> 
> 时间：2013-02-27T14:37:21.783
> 
> 标签：xpages

我的视图列旨在显示所有时间条目，并且我已验证它在我的 Notes 视图中显示“14:56:28:42”。

我想在 Xpages 的 viewPanel 的视图列中显示它，但失败了。

```
<xp:viewColumn
    columnName="$2"
    id="viewColumn1"
>
    <xp:this.converter>
        <xp:convertDateTime
            pattern="yyyy-MM-dd HH:mm:ss:SSS"
            >
        </xp:convertDateTime>
    </xp:this.converter>
    <xp:viewColumnHeader
        value="Created"
        id="viewColumnHeader1"
    >
    </xp:viewColumnHeader>
</xp:viewColumn> 
```

它在所有毫秒内显示零 (000)。如果我将例如“z”添加到模式中，它将显示时区。

请指教！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:51:09.043

最简单的方法是`@Text()`在 Notes 视图中使用并让它在那里工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T16:28:46.583

这可能是因为注释日期时间控制不会为数据添加毫秒精度（请参阅[http://www.jeroensomhorst.eu/uncategorized/dont-forget-the-milliseconds-a-post-about-dates-and -日期时间比较/](http://www.jeroensomhorst.eu/uncategorized/dont-forget-the-milliseconds-a-post-about-dates-and-datetime-comparison/)）。至少这是我在使用日期/时间控件时发现的。

# ios - sqlite中的复杂行删除

> ID：15114750
> 
> 赞同：0
> 
> 时间：2013-02-27T14:37:35.080
> 
> 标签：ios, sqlite

我有这样的表（`TABLE_NAME`）： ![在此处输入图像描述](../Images/dd48445ef4bcb6fee3f7d6ba0ccb097d.png)

我想检查计数是否超过 5，如果是，则删除时间戳值最低的行。在这个例子中，它应该删除最后一行。

我想用一个复杂的删除语句来做到这一点。任何想法如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:55:55.163

```
DELETE
FROM TABLE_NAME
WHERE TIMESTAMP < (
                   SELECT TIMESTAMP 
                   FROM (
                          SELECT TIMESTAMP 
                          FROM TABLE_NAME
                          ORDER BY TIMESTAMP DESC
                        ) LIMIT 1 OFFSET 4); 
```

通过此查询，您：

*   按 T​​IMESTAMP DESC 排序记录
*   选择第 5 条记录 TIMESTAMP（允许的最小值）--> min_timestamp
*   您删除了 TIMESTAMP < min_timestamp 的所有记录

我没有对其进行测试，但这应该是解决您问题的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:51:28.430

这是您的解决方案

```
delete from TABLE_NAME where timestamp IN (select min(timestamp) from TABLE_NAME where (SELECT count() FROM TABLE_NAME)>5) 
```

它将检查您的 tableRecord 计数是否大于 5，然后删除最小时间戳记录。

# c++ - 为什么向量指针占用这么多内存？

> ID：15114754
> 
> 赞同：2
> 
> 时间：2013-02-27T14:37:46.940
> 
> 标签：c++, vector, stl, boolean

我正在做一个项目，我需要在内存使用方面尽可能地刻薄。`vector<bool>`我正在尝试计算示例中 a of size的总大小`32`：

```
vector<bool> v(32);
cout << "sizeof: " << sizeof(v) << endl;
cout << "size: " << v.size() << endl;
cout << "capacity: " << v.capacity() << endl;
cout << "max_size: " << v.max_size() << endl; 
```

这给了我：

```
sizeof: 40                     <- 40 byte? wtf?
size: 32                       <- hoping an element takes up 1 bit
                                  (instead of the usual 1 byte for booleans)
                                  this should take around 32 bit memory
capacity: 64                   <- I guess this is because minimum size is
                                  1 integer = 64 bit
max_size: 9223372036854775744  <- relevant somehow? 
```

在我的 64 位 ubuntu 12.04 机器上。所以我想我可以像这样计算内存：

```
40 * 8 + 64 * 1 = 384 bit = 48 byte 
```

所以根据这个计算，大部分内存都花在了 size 的向量对象上`32`。我的问题是为什么一个`vector`对象需要使用这么多内存？还有我的计算有什么错误吗？如果不自己对矢量大小进行按位操作，我怎样才能提高效率`32`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:42:40.873

这 40 个字节是管理开销。除其他外， a`vector`必须跟踪它的`size`and `capacity`（这已经是两个`size_t`s 的字节了），非常重要的是，一个指向实际数据的指针！

向量保存的实际数据由默认向量分配器在堆上分配，其内存消耗不包含在`sizeof`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T14:40:41.113

`sizeof(v)`正在获取`v`' 结构的大小，而不是`v`' 数据的大小。就像这样做：

```
struct S { int* x };

S s;
s.x = new int[10000];

sizeof(s); // only the size of int* (it doesn't/can't check how much data is allocated) 
```

至于为什么`std::vector<bool>`可能具有比 更大的结构大小`std::vector<int>`，请记住该`bool`版本是专门的。它必须有一些额外的成员来保存按位记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:41:57.130

*   `v.size()`返回可以存储在`vector`. 与内存大小不直接相关
*   `v.capacity()`返回为向量分配的内存单元的数量。向量会提前分配一些内存，但最初并不是所有的都可以访问。非内存大小直接相关
*   `sizeof(v)`正在获取结构本身的字节大小。我想这里有一些指针。以及大小变量等。

如果您想获取向量元素所占用的内存，这可能是最接近的表达式：`v.size() * sizeof(v[0])`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T14:49:00.057

查看 g++ 实现的源代码，我可以找到以下成员：

向量继承自_Bvector_impl _M_impl；

从继承的_Bvector_impl

```
_Bit_iterator   _M_start;   16 bytes
_Bit_iterator   _M_finish;  16 bytes
_Bit_type*  _M_end_of_storage;  8 bytes 
```

这总计为 40 个字节。

_Bit_iterator 包含

```
_M_offset, an unsigned int: 8 bytes
_M_p,      a pointer 8 bytes. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T14:51:09.320

这就是您为可动态调整大小的结构所付出的代价。返回的`sizeof(v)`实际上只是向量跟踪其存储数据的动态分配内存的开销。该数字不包括用于存储数据的空间。

如果您在编译时知道项目数，则可以`std::bitset`改用。`std::bitset`实际上，您存储的每个布尔值将使用 1 位（四舍五入到它使用的字长），而没有`std::vector`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-27T14:55:01.137

如果你的大小`std::vector`实际上在编译时是固定的，那么使用 a 可能是有意义的`std::array`；数组没有*任何*开销（虽然有填充）。

但是，在非常具体的情况下`bool`，您应该考虑`std::bitset`！A`bitset`通过其大小进行参数化，并`bool`尽可能高效地打包 as。它的内存效率不如打包数组（比您自己编写的），因为它保留了切换位的计数。

在[liveworkspace](http://liveworkspace.org/code/LiOj3%240)演示：

```
#include <bitset>
#include <array>
#include <vector>

#include <iostream>

int main() {
   std::vector<bool> vec(32);
   std::array<bool, 32> arr;
   std::array<uint8_t, 4> packed;
   std::bitset<32> bs;

   std::cout << "vector: " << sizeof(vec) + vec.capacity()/8 << "\n";
   std::cout << "array : " << sizeof(arr) << "\n";
   std::cout << "packed: " << sizeof(packed) << "\n";
   std::cout << "bitset: " << sizeof(bs) << "\n";
} 
```

给出：

```
vector: 48
array : 32
packed: 4
bitset: 8 
```

显然哪里`packed`是最有效的容器，但`bitset`提供了一个现成的容器，成本相当低（与 64 位机器上的指针一样多的空间）。

# android - eclipse导出后Android PhoneGap App无法正常工作

> ID：15114756
> 
> 赞同：0
> 
> 时间：2013-02-27T14:37:50.727
> 
> 标签：android, cordova, extjs, export, keystore

我的应用程序通过服务器上的 https 上传一些图片，如果我通过 eclipse 运行它或从 sd 卡安装生成的 .apk，它可以正常工作。但是，如果我导出项目以添加密钥库并从 sd 卡安装 apk，则它无法正常工作。似乎应用程序根本无法连接到服务器。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T09:08:45.800

已解决！

我一直在使用 https 连接到服务器，将其更改为 http 后一切正常！

# php - 会话过期时，Apache 或 PHP 执行奇怪的重定向

> ID：15114759
> 
> 赞同：0
> 
> 时间：2013-02-27T14:38:00.963
> 
> 标签：php, apache, session, oscommerce

我最近开始为我工作的一家公司开发一个 OsCommerce 2.3.1 构建系统。尽管在错误日志中，他们开始收到一些奇怪的错误。我们不知道这些错误是什么时候开始的，但它们肯定与 PHP 或 Apache 中的会话处理有关，因为在我们的代码中的其他任何地方都没有进行重定向。

每当我的会话过期并尝试登录时，我都会被重定向到例如“example.com/aW5kZXgucGhw”，这不是一个有效的页面，并返回一个 404。

怎么会这样？它是否试图将会话密钥附加到 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:35:12.573

这种重定向不是标准的 osCommerce 重定向。会话 ID 比 aW5kZXgucGhw （32 个字符）长得多，所以它来自其他地方的可能性更高，加上会话 ID 每当在标准 osCommerce url 中是 example.com/page.php?osCsid='5abdl9l9tu5ndmcclvrt8267m2 '这样的事情。

在 osCommerce 函数中，includes/functions/general.php 中的 tep_redirect($url) 负责重定向。

我建议您编写一些代码来记录传递给此函数的 URL 参数以及一个调试回溯，以确定调用此函数的位置。

如果文件写入代码生成的“url”值类似于此 URL example.com/aW5kZXgucGhw 的日志，那么您需要查看调试回溯日志部分，以便获取导致此重定向调用的代码部分。

# python - 将坐标元组信息转换为 numpy 数组

> ID：15114761
> 
> 赞同：3
> 
> 时间：2013-02-27T14:38:13.913
> 
> 标签：python, numpy, scipy

我有一个有限元程序的结果，该程序在三维空间中的规则间隔网格位置给出了各种感兴趣的测量值（例如，温度、密度、压力）。

值沿每个坐标等距分布，但不同坐标的间距可能不同。例如，

```
x1 = [0, 0.1, 0.2, ..., 1.0]      (a total of NX1 pts) 
x2 = [0, 0.5, 1.0, ..., 20]       (a total of NX2 pts) 
x3 = [0, 0.2, 0.4, ..., 15]       (a total of NX3 pts) 
```

软件输出的结果格式如下：

```
x1_1, x2_1, x3_1, f_x, g_x, h_x
x1_1, x2_1, x3_2, f_x, g_x, h_x
x1_1, x2_1, x3_3, f_x, g_x, h_x
...
x1_1, x2_2, x3_1, f_x, g_x, h_x
x1_1, x2_2, x3_2, f_x, g_x, h_x
x1_1, x2_2, x3_3, f_x, g_x, h_x
...
x1_2, x2_1, x3_1, f_x, g_x, h_x
x1_2, x2_1, x3_2, f_x, g_x, h_x
x1_2, x2_1, x3_3, f_x, g_x, h_x
... 
```

其中 f_x、g_x、h_x 是在特定网格点处感兴趣的度量。

我想转换上述数据格式并获得 f、g 和 h 的 (NX1 x NX2 x NX3) numpy 数组。

一些结果集相当大（80 x 120 x 100）。

有没有人有任何提示可以有效地进行这种转换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:56:27.603

假设您将整个数组作为`data`shape数组读入内存`(Nx1 * Nx2 * Nx3, 6)`。

```
data = np.loadtxt('data.txt', dtype=float, delimiter=',') 
```

如果如您的示例所示，这些点是按字典顺序生成的，则只需将列抓取到`f`，`g`然后重新调整`h`它们的形状：

```
f = data[:, 3].reshape(Nx1, Nx2, Nx3)
g = data[:, 4].reshape(Nx1, Nx2, Nx3)
h = data[:, 5].reshape(Nx1, Nx2, Nx3) 
```

如果您需要弄清楚和是什么`Nx1`，您可以使用：`Nx2``Nx3``np.unique`

```
Nx1 = np.unique(data[:, 0]).shape[0]
Nx2 = np.unique(data[:, 1]).shape[0]
Nx3 = np.unique(data[:, 2]).shape[0] 
```

如果不能保证点的顺序，一个更强大的解决方案是`np.unique`用于提取网格值的索引：

```
Nx1, idx1 = np.unique(data[:, 0], return_inverse=True)
Nx1 = Nx1.shape[0]
Nx2, idx2 = np.unique(data[:, 1], return_inverse=True)
Nx2 = Nx2.shape[1]
Nx3, idx3 = np.unique(data[:, 2], return_inverse=True)
Nx3 = Nx3.shape[0]

f = np.empty((Nx1, Nx2, Nx3))
f[idx1, idx2, idx3] = data[:, 3]
g = np.empty((Nx1, Nx2, Nx3))
g[idx1, idx2, idx3] = data[:, 4]
h = np.empty((Nx1, Nx2, Nx3))
h[idx1, idx2, idx3] = data[:, 5] 
```

这将为`f`,`g`和`h`, 而不是原始数组的视图创建新数组`data`，因此它将使用更多内存。

当然，您应该使用循环或列表推导，而不是我上面的丑陋代码重复三遍！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:33:41.290

无论如何，您都必须遍历整个文件，那么为什么不初始化数组并输入值呢？

棘手的部分是，如果你想要一个 shape 的数组`(NX1,NX2,NX3)`，但如果你的`x1,x2,x3`值是`float`s，那么你必须以某种方式索引你的数组。也许存在一个数据结构，但你可以使用类似的东西

```
def xyz_index((x,y,z),(n1,n2,n3)):
    """ return integer indices for x,y,z position
        given a constant step """
    return tuple(map(int,[x/n1,y/n2,z/n3]))

import numpy as np
NX1,NX2,NX3 =  (80, 120, 100)
ns = n1, n2, n3 =   (.1,.5,.2)
x1, x2, x3 = np.arange(0,1+n1,n1), np.arange(0,20+n2,n2), np.arange(0,15+n3,n3),

data = np.empty((NX1,NX2,NX3),dtype=[('f',float),('g',float),('h',float)])
with open(filename,'r') as f:
    for line in f:
        x,y,z,f,g,h = map(float,line.split(', '))
        data[xyz_index((x,y,z),ns)] = (f,g,h) 
```

然后您可以按如下方式访问您的数据：

对于`h`点的 - 值`x1,x2,x3 = .2, .5, 0.`，使用

```
data[xyz_index((.2,.5,0),ns)]['h'] 
```

如果没有`['h']`，这将返回一个`(f,g,h)`包含上述内容的元组`dtype`。

如果没有索引，它将返回一个`(NX1,NX2,NX3)`包含所有值的数组`h`。

* * *

现在我看了一下，如果`n1, n2, n3`总是相同的，你可能想*在*你的`xyz_index`函数中定义它们，这样你就不必`ns`每次都传入：

```
data[xyz_index(.2,.5,0)]['h'] 
```

# html - 使用 P 标签和 CSS 制作列

> ID：15114762
> 
> 赞同：0
> 
> 时间：2013-02-27T14:38:18.023
> 
> 标签：html, css

我需要使用`p`标签制作列。因为内容是通过内容管理器插入的，所以它会`p`在我创建的框内创建一个包含内容的元素。

我不能创建 2 个或更多 div，就像我说的，内容被插入到一个`p`元素中

我怎样才能做到这一点？有什么CSS方法可以做到吗？

注意：杂志或报纸专栏等专栏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:40:24.147

您是否尝试过修改 p 元素的 CSS 并给他一个宽度和浮动？

就像是：

```
p {
   width: 300px;
   float: left;
   margin-left: 10px;
} 
```

好吧，你明白了：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:41:41.130

你可以

[CSS 多列布局模块](http://www.w3.org/TR/css3-multicol/)

[caniuse.com/#search=column](http://caniuse.com/#search=column)

以更老式的方式：

```
p.column {
    float:left;
    width : (100 / nbr of columns)%
    /* 33.3% for 3 columns */
} 
```

# java - 使用 @inject 和 applicationContext.xml 进行注入的区别

> ID：15114768
> 
> 赞同：1
> 
> 时间：2013-02-27T14:38:34.210
> 
> 标签：java, spring, cdi

Spring如何注入引用的bean之间有什么区别

MyClass.java

```
public class MyClass {
    @Inject
    @Named("myNiceBean")
    private MyBean bean;
    public MyBean getBean() { return bean; }
    public void setBean(MyBean bean) { this.bean = bean; }
} 
```

应用程序上下文.xml

```
<bean id="myNiceBean" class="com.exemple.DummyBean" /> 
```

和

```
public class MyClass {
    private MyBean bean;
    public MyBean getBean() { return bean; }
    public void setBean(MyBean bean) { this.bean = bean; }
} 
```

应用程序上下文.xml

```
<bean id="myNiceBean" class="com.exemple.DummyBean" />
<bean id="myClass" class="com.exemple.MyClass">
    <property name="bean" ref="myNiceBean"/>
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:43:04.857

第一个示例简单地使用带注释的方法来注入 bean。实际上，不需要 setter 和 getter 方法，`Spring`会处理这个问题。在第二个（手动）注入示例中，需要 setter 和 getter*方法*。

# c# - 将数据从一个窗口传递到另一个窗口

> ID：15114782
> 
> 赞同：0
> 
> 时间：2013-02-27T14:39:06.883
> 
> 标签：c#, wpf

我有 2 个窗口。当我按下一个按钮时，我想将一个`Person`对象从当前传递`Window`给另一个。

这是主窗口中的代码：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    person owner = new person();
    owner.ID = 1;
    owner.Name = "Mark";
    w2 newWindow = new w2(owner);

    newWindow.Show();
} 
```

在另一个名为`w2`我的窗口中，我有以下代码：

```
public partial class w2 : Window
{
    public class person
    {
        int _ID;
        string _Name;

        public int ID
        {
            get { return _ID; }
            set { _ID = value; }
        }
        public string Name
        {
            get { return _Name; }
            set { _Name = value; }
        }
   }

   public w2()
   {
       InitializeComponent();
   }

   public w2(person passedPerson) : this()
   { 
       this.passedPerson = passedPerson;
   }
} 
```

当我尝试编译时出现这些错误：

> 错误 3“passing.w2”不包含“passedPerson”的定义，并且找不到接受“passing.w2”类型的第一个参数的扩展方法“passedPerson”（您是否缺少 using 指令或程序集引用？48 18 次通过
> 
> 错误 1 ​​'passing.w2.w2(passing.w2.person)' 的最佳重载方法匹配有一些无效参数 57 28 传递
> 
> 错误 2 参数 1：无法从 'passing.MainWindow.person' 转换为 'passing.w2.person' 57 35 传递

顺便提一句。我使用这个例子作为起点：

[http://go4answers.webhost4life.com/Example/pass-variables-windowopen-wpf-31068.aspx](http://go4answers.webhost4life.com/Example/pass-variables-windowopen-wpf-31068.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:44:03.240

尝试显式分配传递者的每个属性。我的意思是尝试做

```
public w2(MainForm.person passedPerson)
        : this()
{
    this.passedPerson.ID = passedPerson.ID;
    this.passedPerson.Name = passedPerson.Name;
} 
```

您可能已经为 Person 定义了 2 个类。每种形式一个。

虽然你应该只定义一个人一次。（创建一个单独的类并将其用于两种形式）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:19:37.040

所以首先，简单的一个：

> “passing.w2”不包含“passedPerson”的定义

当你说：

```
this.passedPerson = passedPerson; 
```

显然，您正在尝试为该人分配一个实例字段，但没有这样的字段。只需添加一个：

```
private person passedPerson; 
```

对于其他两个错误，这是因为您定义了两个`person`类，每个窗口中都有一个类。你不应该那样做。仅仅因为有两个类具有相同的名称和相同的字段，并不能使它们成为同一个类，也不意味着您可以将一个视为另一个。

`person`在顶层创建你的类（最好是在它自己的文件中），并确保两个窗口都使用那个定义。

另请注意，按照惯例，类名以大写字母开头：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-23T11:21:05.000

试试这个，第一个窗口 LoginPageWindow

```
public partial class LoginPageWindow : Window
 {

    private void btnSave_Click(object sender, RoutedEventArgs e)
    {
       new Suucessfullogin(textboxvalue.text).ShowDialog();
    }
 } 
```

在第二个窗口中，我们可以获得价值

```
public partial class Suucessfullogin : Window
{
      string str;   
    public Suucessfullogin(string value)
    {
        InitializeComponent();
        str= value;     
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:44:10.037

只是将一个类嵌套在一个类中并不会创建它的成员。尝试

```
public partial class w2 : Window
{
   private person passedPerson;
   ....
} 
```

然后用参考填充您的成员。

或者更好：将您的班级人员放在其他班级之外，以便他们都可以访问其定义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T14:44:18.587

您确定您的“所有者”变量是 w2 类 (w2.person) 中定义的人员类型吗？您的 this.passedPerson 字段在哪里定义？看起来它根本没有定义。如果您想在“父”类之外使用它，则不应创建内部类。只需在单独的文件中创建 Person 类。

# php - 查找所选提交按钮的 id

> ID：15114783
> 
> 赞同：3
> 
> 时间：2013-02-27T14:39:09.213
> 
> 标签：php, javascript, jquery, codeigniter

我有 2 个输入字段和 2 个隐藏的提交按钮，我在按下输入时使用 jquery 提交输入字段，所以我想找到当按下**输入**时它显示选定的按钮 id 我已经在 jquery 中完成了它不要向我显示任何 id 这里是 jsfiddle 上的示例

```
$('input').click(function() {
    var id=$(this).attr('id');
        alert(id);  
}); 
```

这显示了我所有的 id，但我只选择了一个 [http://jsfiddle.net/azamalvi/kD3bx/7/](http://jsfiddle.net/azamalvi/kD3bx/7/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:40:39.137

```
$('input').click(function(eventObject) {
     var idOfButtonClicked = $(eventObject.target).attr('id');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:43:11.413

在您的示例代码的情况下，您应该使用这样的东西，因为 keydown 事件是在 textarea 内引发的

```
var id = $(this).parent().find("input[type=submit]").attr('id'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:44:44.227

试试：http: [//jsfiddle.net/3ZmbW/](http://jsfiddle.net/3ZmbW/)

```
 $(".text").bind("keydown", function (event) {

    var keycode = (event.keyCode ? event.keyCode : (event.which ? event.which : event.charCode));
    if (keycode == 13) {

        var $id = $(this).siblings().find("input[type=submit]");
        alert($id.attr("id"));            

        ($id).click();
        return false;
    } else {
        return true;
    }
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:48:26.610

你应该尝试这样的事情：

```
$(".text").bind("keydown", function (event) {
    var keycode = (event.keyCode ? event.keyCode : (event.which ? event.which : event.charCode));
    if (keycode == 13) {
        // Actually display your button ID
        alert($(event.target).next().find('input').attr('id'));  
        // Then, you can submit you form :
        button = $(event.target).next().find('input');
        button.click();
    }
}); 
```

# android - android如何从图像标签中获取src值

> ID：15114788
> 
> 赞同：-1
> 
> 时间：2013-02-27T14:39:36.920
> 
> 标签：android, html

在 Android 中，我想从图像标签的 src 属性中获取值，如下所示。

```
<img border="0" height="430" src="http://2.bp.blogspot.com/-551kBiFcc3o/US2MxmAHq1I/AAAAAAAAZvM/DjurUt5-4Ac/s640/856738_537952452911181_897510449_o.jpg" width="640"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:43:44.617

您可以尝试使用[正则表达式](http://www.vogella.com/articles/JavaRegularExpressions/article.html)来过滤掉 img src 的：

```
String imgRegex = "<img[^>]+src\\s*=\\s*['\"]([^'\"]+)['\"][^>]*>"; 
```

[仅当您知道自己在做什么](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)时才应该使用它（正如 CommonsWare 在评论中指出的那样）

剩下的取决于你——你已经给了我们一些关于上下文的信息。

# php - PHP 连接字符串

> ID：15114789
> 
> 赞同：0
> 
> 时间：2013-02-27T14:39:36.933
> 
> 标签：php, connection-string

我在使用 PHP 连接到数据库时遇到了一些困难。我使用以下代码：

```
$db=mysql_connect ("HOST", "USER", "PASS") or die ('I cannot connect to the database because: ' . mysql_error()); 
```

并且在使用 phpmyadmin 连接到主机时工作正常。但是我的客户主机正在使用名为 mylittletools.net 的东西，由于某种原因，连接字符串不会访问数据库。

这几天一直在绞尽脑汁，如果有人能为我阐明这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:50:46.750

我认为您无法连接，因为服务器拒绝来自其他主机的连接。

创建 MySQL 用户时 - 默认情况下它只能从本地计算机访问。

PHPMyAdmin 从本地机器连接到数据库，所以它可以工作。

如果您想从其他服务器连接 - 您必须在 MySQL 中为您的 mysql 用户添加权限。

您可以在 PHPMyAdmin 中添加远程登录权限，或使用 SQL。

特定 IP 123.123.123.123 的 SQL 示例

```
GRANT ALL PRIVILEGES
ON database.*
TO 'user'@'123.123.123.123'
IDENTIFIED BY 'newpassword'; 
```

任何 IP 的 SQL 示例：

```
GRANT ALL PRIVILEGES
ON database.*
TO 'user'@'%'
IDENTIFIED BY 'newpassword'; 
```

主机`'%'`是指任何主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:46:49.540

您的语法是正确的，除非它是评论中提到的变量问题，唯一的解释是

*   您的服务器没有 MySQL 服务器
*   或 PHP 的 MySQL 驱动程序不工作或未启用。

# c++ - 哈希表作为 C++ 中函数的返回类型

> ID：15114790
> 
> 赞同：0
> 
> 时间：2013-02-27T14:39:38.907
> 
> 标签：c++, hashtable

我想知道我是否可以使用哈希表作为 C++ 中函数的返回类型。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T14:42:34.453

哈希表的 C++ 标准库实现是`std::unordered_map`，是的，您可以愉快地从函数中返回它：

```
std::unordered_map<X, Y> foo() {
  std::unordered_map<X, Y> map;
  return map;
} 
```

它可以被复制，因为它有一个复制构造函数^(†</sup>。如果您实现自己的哈希表，如果它具有复制构造函数，它也将是可返回的。)

^(† 在 C++11 中，对于给出的示例，移动构造函数就足够了。)

# apache - 使用变量将asp重定向到php

> ID：15114791
> 
> 赞同：0
> 
> 时间：2013-02-27T14:39:44.650
> 
> 标签：apache, .htaccess

我有如下链接：

文件夹/dataBuy.asp?numOrder=578

我想重定向到

文件夹/dataBuy.php?numOrder=578

numOrder 是一个自动增量变量 (579, 580 ...) 我的服务器不支持 asp，所以我需要一个使用 htaccess 的解决方案。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:07:42.437

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^(folder)/([^.]+)\.asp$ /$1/$2.php [L,NC] 
```

# php - 使用 PHP 重新排序 RSS 提要

> ID：15114794
> 
> 赞同：1
> 
> 时间：2013-02-27T14:39:47.757
> 
> 标签：php, xml, rss

我需要过滤和重新排序`RSS`提要。

使用`PHP`，我将如何检测外壳中是否有链接`url=""`？

其中大部分将是空的，但我想将在此标签中具有链接的整个项目移动到顶部。

这是我将使用的代码示例。我猜我会用`isset`? 就像是：

```
if (isset($enclosure)){
    HOW WOULD I SELECT THE PARENT ITEM? AND EVERYTHING IN IT? AND THEN MOVE IT TO THE TOP?
}

<item>
    <title><![CDATA[Article title 1]]></title>
    <link><![CDATA[http://www.articlelinkone.com]]></link>
    <pubDate><![CDATA[Tue, 26 Feb 2013 15:45:00 EDT]]></pubDate>
    <description><![CDATA[Article discription 1<br />Some HTML will exist]]></description>
    <enclosure url="" type="image/jpeg"></enclosure>
    <thumbnail url="" type="image/jpeg"></thumbnail>
    <summary><![CDATA[Summary for article]]></summary>
    <guid><![CDATA[Guide for article]]></guid>
    <source url="http://www.article.com/"/>
</item> 
<item>
    <title><![CDATA[Article title 1]]></title>
    <link><![CDATA[http://www.articlelinkone.com]]></link>
    <pubDate><![CDATA[Tue, 26 Feb 2013 15:45:00 EDT]]></pubDate>
    <description><![CDATA[Article discription 1<br />Some HTML will exist]]></description>
    <enclosure url="" type="image/jpeg"></enclosure>
    <thumbnail url="" type="image/jpeg"></thumbnail>
    <summary><![CDATA[Summary for article]]></summary>
    <guid><![CDATA[Guide for article]]></guid>
    <source url="http://www.article.com/"/>
</item> 
<item>
    <title><![CDATA[Article title 1]]></title>
    <link><![CDATA[http://www.articlelinkone.com]]></link>
    <pubDate><![CDATA[Tue, 26 Feb 2013 15:45:00 EDT]]></pubDate>
    <description><![CDATA[Article discription 1<br />Some HTML will exist]]></description>
    <enclosure url="http://articleone.com/image1.jpg" type="image/jpeg"></enclosure>
    <thumbnail url="http://articleone.com/thumb/image1.jpg" type="image/jpeg"></thumbnail>
    <summary><![CDATA[Summary for article]]></summary>
    <guid><![CDATA[Guide for article]]></guid>
    <source url="http://www.article.com/"/>
</item> 
<item>
    <title><![CDATA[Article title 1]]></title>
    <link><![CDATA[http://www.articlelinkone.com]]></link>
    <pubDate><![CDATA[Tue, 26 Feb 2013 15:45:00 EDT]]></pubDate>
    <description><![CDATA[Article discription 1<br />Some HTML will exist]]></description>
    <enclosure url="" type="image/jpeg"></enclosure>
    <thumbnail url="" type="image/jpeg"></thumbnail>
    <summary><![CDATA[Summary for article]]></summary>
    <guid><![CDATA[Guide for article]]></guid>
    <source url="http://www.article.com/"/>
</item> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:03:29.230

以下是使用[SimpleXML](http://php.net/manual/fr/book.simplexml.php)检查附件 URL 是否为空的方法：

```
<?php
$xml = new new SimpleXMLElement($xml_content)
foreach( $xml->item AS $item ) {
    if( !empty( $item->enclosure['url'] ))
        // Do whatever you want
} 
```

根据您想要做什么，您可以将其`$item`放入一个新数组中，构建一个新的 XML 文件等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T14:49:57.320

你看过[SimpleXML](http://www.php.net/manual/en/book.simplexml.php)吗？您将能够轻松地反转 xml 对象中的项目，例如：

```
$str = file_get_contents($url);
$xml = simplexml_load_string($str);
$items = array_reverse($xml->xpath('item')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T14:47:59.947

我认为你真的应该看看 php dom xml

DOM XML 的简单示例：

```
<?php
$xmlDoc = new DOMDocument();
$xmlDoc->load("note.xml");

$x = $xmlDoc->documentElement;
foreach ($x->childNodes AS $item)
  {
  print $item->nodeName . " = " . $item->nodeValue . "<br>";
  }
?> 
```

[您可以阅读关于 W3Schools 的完整教程（推荐）](http://www.w3schools.com/php/php_xml_dom.asp)

# php - 在 cakePHP 中创建与模型无关的表单

> ID：15114800
> 
> 赞同：4
> 
> 时间：2013-02-27T14:40:01.803
> 
> 标签：php, cakephp-2.0, cakephp-model

我有一个用户在其中选择一个文档的表单。然后该文档由控制器保存到 webroot 文件夹。

但是，在它甚至显示表单之前，它给了我一个错误：

```
Missing Database Table
Error: Table office_layouts for model OfficeLayout was not found in datasource default. 
```

这是正确的，office_layouts 没有数据库表。但这不是必需的。这就是为什么没有桌子。表单刚刚上传到服务器。

我已通读创建表单，并尝试了以下方法：

```
// file: View/OfficeLayout/upload.ctp
echo $this->Form->create( null ,array('type' => 'file')); ?>
<fieldset>
    <legend><?php echo __('&emsp;Add Layout for ' . $branch); ?></legend>
    <?php
        echo $this->Form->input('layout',array('type'=>'file'));
    ?>
</fieldset>
<?php echo $this->Form->end(__('Submit')); ?> 
```

以及将`null`更改为控制器名称（在本例中`OfficeLayout`）。我还删除了所有参数 ( `thus creating it like so: $this->Form->create()`)

在我的控制器中，我有以下内容：

```
public function upload($branch = null) {
    $this->set('branch',$branch);
    if(isset($this->request->data['OfficeLayout'])) {
        $file = $this->request->data['OfficeLayout']['layout'];
        if($file['error'] === UPLOAD_ERR_OK && move_uploaded_file($file['tmp_name'],APP . 'docs' . DS . 'layouts' . DS . $branch . '.pdf')) {
            $this->Session->setFlash('New layout successfully uploaded.','default',array('class'=>'notification'));
            $this->redirect(array('action'=>$branch));
        } else {
            $this->Session->setFlash('Error uploading layout. Please contact web admin.','default',array('class'=>'error'));
        }
    }
} 
```

这个动作被调用：`domain/office_layouts/upload/branch`。

每当我删除该`$this->Form->create()`行时，它都会显示上传视图，但显然没有提交。

所以我在这种情况下的问题是，我怎样才能创建一个表单，而不是在数据库中寻找一个表？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-01T12:34:56.240

而不是`null`，使用`false`：

```
echo $this->Form->create( false, array('type' => 'file')); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T07:52:44.897

通过创建一个模型文件并将其放入其中来修复它：

```
class OfficeLayout extends AppModel {
    var $useTable = false;
} 
```

# xna - 带有 DrawIndexedPrimitives 的 SpriteBatch

> ID：15114801
> 
> 赞同：1
> 
> 时间：2013-02-27T14:40:03.617
> 
> 标签：xna, drawstring, spritebatch

这是我创建的第一个 3D 应用程序，如果这看起来像一个简单的问题，我很抱歉，但我已经搜索了互联网和这些论坛，试图找到答案。

我正在尝试使用 spriteBatch.DrawString 命令在屏幕上绘制一个简单的字符串。

该应用程序类似于 Minecraft，屏幕上有大量立方体。为了解决滞后问题，所有立方体都是通过顶点创建的，并且已经实现了硬件实例化。

问题是当我调用 spriteBatch.Begin() 时，所有其他多维数据集看起来都不同。我知道 spritebatch 更改了某些状态，因此添加了以下行

```
GraphicsDevice.BlendState = BlendState.Opaque;
GraphicsDevice.DepthStencilState = DepthStencilState.Default; 
```

Bellow 是用来绘制玩家的代码

```
public void Draw(Matrix view, Matrix projection)
    {
        effect.CurrentTechnique = effect.Techniques["TexturedNoShading"];
        effect.Parameters["xView"].SetValue(view);
        effect.Parameters["xProjection"].SetValue(projection);
        effect.Parameters["xWorld"].SetValue(world);
        effect.Parameters["xTexture"].SetValue(texture);

        device.SetVertexBuffer(myVertexBuffer);
        foreach (EffectPass pass in effect.CurrentTechnique.Passes)
        {
            pass.Apply();
            device.DrawIndexedPrimitives(PrimitiveType.TriangleList, 0, 0, vertices.Length, 0, indices.Length / 3);
        }
    } 
```

这是主类中用于绘制所有内容的代码

```
 RasterizerState rs = new RasterizerState();  
        rs.CullMode = CullMode.None;
        rs.FillMode = FillMode.Solid;
        device.RasterizerState = rs;

        GraphicsDevice.BlendState = BlendState.Opaque;
        GraphicsDevice.DepthStencilState = DepthStencilState.Default;
        _map.Draw(_camera.GetCamera(), projection);
        _player.Draw(_camera.GetCamera(), projection);

        spriteBatch.Begin();
        spriteBatch.DrawString(Text, "test", new Vector2(100, 100), Color.White);
        spriteBatch.End(); 
```

我想发布问题的屏幕截图以更清楚地显示它，但由于这是我的第一篇文章，我无权发布图像。我很高兴将图像通过电子邮件发送给人们。

我很乐意提供任何其他信息，但这似乎是一个简单的问题。

感谢您提供的任何帮助。

山姆维克里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:49:48.507

我可以看到您在哪里设置顶点缓冲区，但看不到您在任何地方设置索引缓冲区？

它通常就在您设置顶点缓冲区的位置附近。像这样的东西：'

```
device.SetVertexBuffer(myVertexBuffer);
device.Indices = myIndexBuffer; 
```

# javascript - 为什么使用 ajax 加载到另一个页面时，拆分中的 html 标签会被更改？

> ID：15114806
> 
> 赞同：0
> 
> 时间：2013-02-27T14:40:10.513
> 
> 标签：javascript, jquery, ajax, split

看看这个链接

[http://www.infopunta.com/test1/1stajax.asp](http://www.infopunta.com/test1/1stajax.asp)

该页面只是用ajax加载另一个页面，上面有其他javascript。

用 firefox 或 chrome 打开它点击检查元素并查看加载在正文中的 ajax 函数

在它拥有的 split 方法中说：

```
var partes = data.split("<pagebreak ></pagebreak>"); 
```

加载的原始文件中的真实行说：

```
var partes = data.split("<pagebreak />"); 
```

你可以在这里看到原始文件：http: [//www.infopunta.com/test1/2ndajax.asp](http://www.infopunta.com/test1/2ndajax.asp)

不知何故，用 ajax 加载的 javascript 内容中的 TAGS 会自动关闭。我不想要那个！！

我怎样才能解决这个问题？？

# mysql - 查找 mysql 数据库中不同行中的时间戳之间的重叠，按天和 ID 分组

> ID：15114811
> 
> 赞同：0
> 
> 时间：2013-02-27T14:40:37.167
> 
> 标签：mysql, sql, sqlite, timestamp

我有一张表，其中列出了某些对象的事件。

有两个事件：“移动”和“加载”。它们可以开始和结束，并且这些事件会在它们发生时用时间戳列出。

通过以下请求，我可以获得以下值：

```
sum of time, when movement took place (value in the fiddle: 421)
sum of time, when load took place (value in the fiddle: 520)
sum of time, when movement and load took place (value in the fiddle: 391) 
```

当前版本为每一天计算这些数字，这很好用。

[http://sqlfiddle.com/#!2/518dd/1](http://sqlfiddle.com/#!2/518dd/1)

但我也会有不同的ID。我现在想为每个 DAY 和每个 ID 计算这些数字。当我添加这些数据时，它会崩溃，请看这个小提琴：

[http://sqlfiddle.com/#!2/b43fa/6](http://sqlfiddle.com/#!2/b43fa/6)

这不是这个问题的重复：[Find intersections between rows and timestamps in a mysql db](https://stackoverflow.com/questions/15112004/find-intersections-between-rows-and-timestamps-in-a-mysql-db)，因为这个问题的解决方案在这种情况下不适合/不适用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:49:15.603

问题是您开始的查询。我根本不明白第三列是什么。但是，前两个更容易计算使用：

```
select (sum(case when event = 'movement end' then timestamp end) -
        sum(case when event = 'movement start' then timestamp end)
       ),
       (sum(case when event = 'load end' then timestamp end) -
        sum(case when event = 'load start' then timestamp end)
       )
from table1 
```

由此，通过以下方式添加组应该是微不足道的：

```
select id, date(timestamp),
        (sum(case when event = 'movement end' then timestamp end) -
        sum(case when event = 'movement start' then timestamp end)
       ),
       (sum(case when event = 'load end' then timestamp end) -
        sum(case when event = 'load start' then timestamp end)
       )
from table1
group by id, date(timestamp) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T21:15:31.163

正如 Gordon 所示，通过将过滤器移到最外层，可以进行分组`SELECT`。搜索需要包含移动事件的加载事件的方法与[前面的答案](https://stackoverflow.com/questions/15112004#15112972)相同：

```
SELECT id,
       date(timestamp, 'unixepoch') AS date,
       (SUM(CASE WHEN event = 'movement end'   THEN timestamp END) -
        SUM(CASE WHEN event = 'movement start' THEN timestamp END)
       ) AS all_movement,
       (SUM(CASE WHEN event = 'load end'   THEN timestamp END) -
        SUM(CASE WHEN event = 'load start' THEN timestamp END)
       ) AS all_load,
       (SUM(CASE WHEN event = 'movement end' AND
                      (SELECT event
                       FROM Table1 b
                       WHERE timestamp = (SELECT MIN(timestamp)
                                          FROM Table1 c
                                          WHERE c.timestamp >= a.timestamp
                                            AND c.id = a.id
                                            AND c.event LIKE 'load %')
                         AND b.id = a.id
                         AND b.event LIKE 'load %'
                      ) = 'load end'
            THEN timestamp END) -
        SUM(CASE WHEN event = 'movement start' AND
                      (SELECT event
                       FROM Table1 b
                       WHERE timestamp = (SELECT MAX(timestamp)
                                          FROM Table1 c
                                          WHERE c.timestamp <= a.timestamp
                                            AND c.id = a.id
                                            AND c.event LIKE 'load %')
                         AND b.id = a.id
                         AND b.event LIKE 'load %'
                      ) = 'load start'
            THEN timestamp END)
       ) AS load_movement
FROM Table1 a
GROUP BY id,
         date(timestamp, 'unixepoch') 
```

# java - ListView gwt 如何组织图片

> ID：15114819
> 
> 赞同：0
> 
> 时间：2013-02-27T14:40:52.187
> 
> 标签：java, listview, gwt, extjs2

不幸的是，我还不能发布图片，但我会尽力解释。我有图像，我想像 chrome 浏览器或歌剧中的空白页中的按钮一样使用它们。但结果我与图像有一条线，下一张图像在下一行，并且所有行（不仅是图像）都处于活动状态。

那么，我该怎么做。我一直在尝试找出我的代码与 ext gwt 2.2 资源管理器站点上给出的示例代码之间的任何差异（重要差异）。这是我的代码：

```
public class QueryPanel extends LayoutContainer {

public QueryPanel(final String customerId, final String login, final String password){

    setLayout(new FitLayout());
    final ContentPanel gallery = new ContentPanel();
    gallery.setHeading("Reports");
    gallery.setLayout(new FitLayout());
    gallery.setCollapsible(true);
    gallery.setAnimCollapse(false);
    gallery.setFrame(true);
    gallery.setId("images-view");
    gallery.setWidth(535);

    ListStore<GalleryButtonModel> store = new ListStore<GalleryButtonModel>();
    store.add(new GalleryButtonModel("Copy all messages", "CopyIcon.png", new CopyMsgs(customerId)));
    store.add(new GalleryButtonModel("Spam report", "spam.gif", new SpamReport(customerId, login, password)));
    store.add(new GalleryButtonModel("Top customers report", "topCustomers.gif", new TopCustomersReport(customerId, login, password)));
    store.add(new GalleryButtonModel("Total report", "total-report.gif", new TotalReport(customerId, login, password)));
    store.add(new GalleryButtonModel("Message througput report", "message-troughput.gif", new MessageThroughputReport(customerId, login, password)));
    store.add(new GalleryButtonModel("Delivery time report", "delivery-time.gif", new DeliveryTimeReport(customerId, login, password)));
    store.add(new GalleryButtonModel("Action type report", "report.gif", new ActionTypeReport(customerId, login, password)));

    ListView<GalleryButtonModel> view = new ListView<GalleryButtonModel>() {
        @Override
        protected GalleryButtonModel prepareData(GalleryButtonModel model) {
            String s = model.get("name");
            model.set("shortName", Format.ellipse(s, 15));
            return model;
        }

    };

    view.setId("img-chooser-view");
    view.setTemplate(getTemplate(""));
    view.setStore(store);
    view.setItemSelector("div.thumb-wrap");
    view.getSelectionModel().select(0, false);
    view.getSelectionModel().addListener(Events.SelectionChange,
            new Listener<SelectionChangedEvent<GalleryButtonModel>>() {

                public void handleEvent(SelectionChangedEvent<GalleryButtonModel> be) {
                    be.getSelectedItem().getExample().getButtonModel();
                }

            });
    VBoxLayoutData vFlex = new VBoxLayoutData();
    vFlex.setFlex(1);
    gallery.add(view, new FitData(5,5,5,5));
    add(gallery, vFlex);     
}    

    private native String getTemplate(String base)/*-{
        return ['<tpl for=".">',
            '<div class="thumb-wrap" id="{name}">',
            '<div class="thumb"><img src="/gxt/images/default/button/{path}" title="{name}"></div>',
            '<span class="x-editable">{shortName}</span></div>',
            '</tpl>',
            '<div class="x-clear"></div>'].join("");

    }-*/;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:33:01.177

听起来你可能在谈论这个例子：[http ://www.sencha.com/examples-2/#listview](http://www.sencha.com/examples-2/#listview)

（此帖子中提供的图像，同一问题的另一个化身[http://www.sencha.com/forum/showthread.php?257343-ListView-Template](http://www.sencha.com/forum/showthread.php?257343-ListView-Template)）

在您使用的模板中，您引用 css 类`thumb`和`thumb-wrap`. 这些不仅仅是添加到 html 结构中的字符串，它们在页面上的 CSS 中具有意义。以下是根据适用于此处的萤火虫选择的一些位：

```
#images-view .thumb-wrap {
    border: 1px solid white;
    float: left;
    margin: 4px 0 4px 4px;
    padding: 5px;
}

#images-view .thumb {
    background: none repeat scroll 0 0 #DDDDDD;
    padding: 3px;
} 
```

这些规则描述了当放置在具有*id*的容器中时如何使用`thumb`和`thumb-wrap` *类*设置元素的样式。您在代码的其他地方设置了 id，但如果您想删除它，您可以简化这些规则。`images-view`

 *这种`float:left;`风格特别是导致它们从左到右排列，然后从上到下排列的原因。当然，您要使用什么其他样式取决于您，但如果这些规则不在您页面上的 CSS 文件中，则这些元素将不会被它们设置样式。*

# windows - 使用 msiexec /qn 安装 Apache2。不设置 ServerAdmin

> ID：15114820
> 
> 赞同：0
> 
> 时间：2013-02-27T14:40:53.753
> 
> 标签：windows, apache

我目前正在尝试使用 CygWin 在 Windows Server 上安装 Apache2。我使用来自：[here](http://apache.imsam.info//httpd/binaries/win32/httpd-2.2.22-win32-x86-openssl-0.9.8t.msi)的预编译 .msi 。

要安装它，我使用以下命令：`Msiexec /i httpd-2.2.22-win32-x86-openssl-0.9.8t.msi INSTALLDIR="C:\\Apache2" SERVERADMIN="mail@example.com" SERVERNAME="example.com" SERVERDOMAIN="example.com" /qn`

然而，给定的`SERVERADMIN`没有在配置文件中设置。即使[文档这么说](http://httpd.apache.org/docs/2.2/platform/windows.html)。如果我打电话给`httpd.exe`它，它会响应： `Syntax error on line 163 of C:/Apache2/conf/httpd.conf: ServerAdmin takes one argument, The email address of the server administrator`

配置如下所示：

```
#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.  e.g. admin@your-domain.com
#
ServerAdmin 
#
# ServerName gives the name and port that the server uses to identify itself.
# This can often be determined automatically, but we recommend you specify
# it explicitly to prevent problems during startup.
#
# If your host doesn't have a registered DNS name, enter its IP address here.
#
#ServerName :80 
```

显然`ServerAdmin`和`ServerName`, 不是由安装程序设置的。

你有什么想法吗？作为后备，也许我们可以直接在 Config 中设置它。你有什么`Command Line`要做的吗（我不能使用 GUI，但我可以使用`CygWin`命令）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:51:32.803

好吧，写完这个问题后，答案立即出现在我面前。如果您使用 卸载 Apache `msiexec /x`，它不会删除旧的 ConfigFiles。如果您在同一目录中重新安装它，它只会采用旧的配置，无论您通过安装程序传递什么。

# c# - 泛型类在基类上有 where 约束，但只允许派生类

> ID：15114823
> 
> 赞同：1
> 
> 时间：2013-02-27T14:41:18.067
> 
> 标签：c#, generics, where-clause

我有一个`MediaCollection<T>`代表歌曲、视频或图片播放列表的类。我也有三个类：，`Song`它们都继承自一个抽象类。我的班级有以下限制：`Video``Picture``AMediaElement``MediaCollection<T>`

```
class MediaCollection<T>
    where T : AMediaElement, new()
{
} 
```

这让我可以收藏歌曲、图片、视频，但也可以收藏任何`AMediaElement`！

如何防止创建类型的对象`MediaCollection<AMediaElement>`？我可以制作`MediaCollection`摘要，然后制作其他三个类`SongCollection`,`PictureCollection`和`VideoCollection`，但我更喜欢使用该`where`子句的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:01:22.080

事实证明它有效。我通过创建一个`List<AMediaElement>`对象而不是一个. 来测试它是错误的`MediaCollection<AMediaElement>`。由于我的 where 子句指定`new()`，我不能使用`AMediaElement`我想要的抽象类。

我知道我按得太快了“提问”按钮..

# c# - WPF 中的 PrintPreview 类似于 WIndowsForms

> ID：15114824
> 
> 赞同：1
> 
> 时间：2013-02-27T14:41:18.440
> 
> 标签：c#, wpf, printing, preview

我没有找到解决方案，在 stackoverflow 和谷歌中都没有。我已经在 WindowsForms 中做到了：

```
static class PrintHandler
{
    private static Bitmap memoryImage;
    [System.Runtime.InteropServices.DllImport("gdi32.dll")]
    private static extern long BitBlt(IntPtr hdcDest, int nXDest, int nYDest, int nWidth, int nHeight, IntPtr hdcSrc, int nXSrc, int nYSrc, int dwRop);

    public static void Print(Form board)
    {
        PrintPreviewDialog pPreview = new PrintPreviewDialog();
        PrintDocument pDoc = new PrintDocument();

        pPreview.Document = pDoc;
        captureScreen(board);

        pDoc.DefaultPageSettings.PaperSize = new PaperSize("Paper", board.ClientRectangle.Width, board.ClientRectangle.Height);

        pDoc.PrintPage += new PrintPageEventHandler(pDoc_PrintPage);

        pPreview.Show(board);
    }

    static void  pDoc_PrintPage(object sender, PrintPageEventArgs e)
    {
        e.Graphics.DrawImage(memoryImage, 0, 0);
    }

    private static void captureScreen(Form board)
    {
        Graphics mygraphics = board.CreateGraphics();
        Size s = board.Size;
        memoryImage = new Bitmap(s.Width, s.Height, mygraphics);
        Graphics memoryGraphics = Graphics.FromImage(memoryImage);
        IntPtr dc1 = mygraphics.GetHdc();
        IntPtr dc2 = memoryGraphics.GetHdc();
        BitBlt(dc2, 0, 0, board.ClientRectangle.Width, board.ClientRectangle.Height, dc1, 0, 24, 13369376);
        mygraphics.ReleaseHdc(dc1);
        memoryGraphics.ReleaseHdc(dc2);
    }
} 
```

我要做什么？我打印了一个窗口（我可以在 WPF 中使用 PrintDialog.PrintVisual 执行此操作），但我想将其显示为具有动态纸张大小的预览。

在 WPF 中是否有容易做类似的事情？

# eclipse - Eclipse 很慢，并且会挂起一些时间

> ID：15114825
> 
> 赞同：0
> 
> 时间：2013-02-27T14:41:20.617
> 
> 标签：eclipse

我的工作区几乎有 2 GB，我正在使用 Eclipse Ganymede 和 Tomcat 6.0（因为我正在处理一个动态 Web 项目）。

我正面临着糟糕的开发体验，因为 Eclipse 太慢了，甚至按`Ctrl`+ `Space`。

我认为更高版本的工作空间更慢。请就如何解决这个问题提出建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-06T21:46:25.483

这可能会有所帮助

在你的日食中，

1）去帮助

2) 点击 Eclipse 市场

3) 搜索 - 优化器

安装“eclipse优化器” ![在此处输入图像描述](../Images/534d6d915c1049178b999069a987cd97.png)

# python - Django 测试。状态 200 和 302

> ID：15114828
> 
> 赞同：3
> 
> 时间：2013-02-27T14:41:24.343
> 
> 标签：python, django, unit-testing

这是如何工作的？302和200有什么区别？什么是正确的？

```
def test_thanks_page(self):
    response = self.client.get('/thanks/')
    self.failUnlessEqual(response.status_code, 302) 
```

和有什么区别：

```
self.failUnlessEqual(response.status_code, 302) 
```

和

```
self.assertEqual(response.status_code, 302) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:47:19.897

我相信 302 （“临时移动”）表示重定向到另一个位置（它的 URI 会随着响应返回），而 200 表示您在请求的 URI 中获得了所需的资源。

[W3 状态代码定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)说：

对于 302：“请求的资源临时驻留在不同的 URI 下。”

我希望这会有所帮助。

# phpmailer - SMTP -> 错误：服务器不接受 AUTH：530 5.7.0 必须先发出 STARTTLS 命令。c3sm5545732pax.9 - gsmtp PHPMailer

> ID：15114829
> 
> 赞同：1
> 
> 时间：2013-02-27T14:41:29.843
> 
> 标签：phpmailer

我已经检查了我的 wamp 服务器是否使用了 openssl，并且正在检查。但是我的代码有什么问题？

```
$mail = new PHPMailer(true); 
$body             = 'THIS IS YOUR USERNAME:'.$row['username'].' PASSWORD: '.$row['password'].'\n PLEASE DELETE THIS MESSAGE AFTER YOU READ THIS';
$mail->SMTPDebug = 1;
$mail->IsSMTP();                // tell the class to use SMTP
$mail->SMTPAuth   = true;                  // enable SMTP authentication
$mail->Port       = 587;                    // set the SMTP server port
$mail->SMTPSecure = 'tsl'; 
$mail->Host = 'smtp.gmail.com';
$mail->Username   = "dan.villarea22@gmail.com";     // SMTP server username
$mail->Password   = "password";            // SMTP server password
$mail->AddReplyTo("system@dvts.com","ADMIN");
$mail->From       = "system@dvts.com";
$mail->FromName   = "SYSTEM";
$to = "dan.villareal22@gmail.com";
$mail->AddAddress($to);
$mail->Subject  = "First PHPMailer Message";
$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; // optional, comment out and test
$mail->WordWrap   = 80; // set word wrap
$mail->MsgHTML($body);
$mail->IsHTML(true); // send as HTML
$mail->Send();echo 'Message has been sent.'; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-01T03:23:00.267

将 $mail->SMTPSecure = 'tsl' 更改为 $mail->SMTPSecure = 'tls'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T07:02:56.697

尝试按如下方式更改主机选项：

$mail->Host = "ssl://smtp.googlemail.com";

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-22T07:56:47.123

尝试使用 $mail->Port = 465; 而不是 587 并检查以下链接中的差异。
[端口 465 和 587 有什么区别？](https://stackoverflow.com/questions/15796530/what-is-the-difference-between-ports-465-and-587)

# r - 插入缺少日期的动物园对象

> ID：15114834
> 
> 赞同：12
> 
> 时间：2013-02-27T14:41:43.923
> 
> 标签：r, time-series, interpolation, zoo

我有一个缺少日期（不缺少值）的气候时间序列。例如：

```
n = 15
full.dates = seq(Sys.Date(), by = 'day', length = n)
serie.dates = full.dates[c(1:10, 12, 15)] # missing 11, 13, 14
y = rnorm(n)

require(zoo)    
serie = zoo(y, serie.dates) 
```

给定“full.dates”向量，我如何“填充”（使用插值）这些缺失点？谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-27T14:44:38.867

与包含所有您想要的日期的“空”对象合并，然后使用`na.approx`（或`na.spline`等）填充缺失值。

```
x <- merge(serie, zoo(,seq(start(serie),end(serie),by="day")), all=TRUE)
x <- na.approx(x) 
```

# python - 在python中按索引访问字典值

> ID：15114843
> 
> 赞同：42
> 
> 时间：2013-02-27T14:41:57.707
> 
> 标签：python, dictionary, indexing

我想通过 Python 字典中的键索引获取值。有没有办法得到这样的东西？

```
dic = {}
value_at_index = dic.ElementAt(index) 
```

其中`index`是一个整数

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-27T14:43:56.173

在 3.7 之前的 Python 版本中，字典本质上是无序的，所以你要求做的事情并没有真正的意义。

如果您真的，真的知道自己在做什么，请使用

```
value_at_index = list(dic.values())[index] 
```

请记住，在 Python 3.7 之前，添加或删除一个元素可能会更改每个其他元素的索引。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-12-25T16:41:26.803

让我们以字典为例：

```
numbers = {'first':0, 'second':1, 'third':3} 
```

当我这样做的时候

```
numbers.values()[index] 
```

我收到一个错误：'dict_values' 对象不支持索引

当我这样做的时候

```
numbers.itervalues() 
```

迭代并提取它也会给出错误的值：'dict'对象没有属性'iteritems'

因此，我想出了通过索引访问字典元素的新方法，只需将它们转换为元组即可。

```
tuple(numbers.items())[key_index][value_index] 
```

例如：

```
tuple(numbers.items())[0][0] gives 'first' 
```

如果您想编辑值或对值进行排序，元组对象不允许项目分配。在这种情况下，您可以使用

```
list(list(numbers.items())[index]) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-27T22:03:40.040

如果您真的只想从可用键范围中获取随机值，请`random.choice`在字典的值上使用（如果 Python 3，则转换为列表形式）。

```
>>> from random import choice
>>> d = {1: 'a', 2: 'b', 3: 'c'}
>>>> choice(list(d.values())) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-07-24T21:49:43.867

虽然你可以做

```
value = d.values()[index] 
```

应该更快

```
value = next( v for i, v in enumerate(d.itervalues()) if i == index ) 
```

编辑：我只是使用 len 100,000,000 的字典在最后检查索引对其进行计时，第一个/values() 版本需要 169 秒，而第二个/next() 版本需要 32 秒。

另外，请注意，这假设您的索引不是负数

# bash - 如何重定向错误输出并且仍然能够在标准输出上获得错误通知？

> ID：15114844
> 
> 赞同：0
> 
> 时间：2013-02-27T14:41:58.080
> 
> 标签：bash, command-line, awk, pipe, stderr

我有一段代码通过 ssh 执行命令。该命令更像是这样的：

```
( cd /home/some/path && ./program ) || echo 'error' 
```

多亏了这一点，如果执行失败，我会在标准输出上得到“错误”，并且可以在我的初始代码中将其解释为失败。但是，在这种方法中，我丢失了错误输出（当我通过 ssh 连接调用程序时）。我希望能够将错误输出保存到某个错误日志文件中（如果我可以使用 awk 用一些日期和时间对其进行注释，那将是完美的）并且在调用时仍然能够在输出上获得“错误”失败的。

我想出了类似的东西：

```
( cd /home/some/path && ./program 2>&1 | awk '{ print strftime("%Y-%m-%d %H:%M:%S"), $0; }' > error.log) || echo 'error' 
```

它将错误输出保存到 error.log 文件，但是，我没有收到“错误”消息。

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:32:14.020

您不能在本地重定向远程 stderr 吗？

```
ssh remotehost '( cd /home/some/path && ./program ) || echo error' 2>errors.txt 
```

将远程 stderr 发送到本地 errors.txt 并将远程字符串 'error' 发送到本地 stdout。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:44:16.827

您可能想要使用“tee”命令，它将输出重定向到文件，同时将其打印在屏幕上。

查看手册或[本文](http://alvinalexander.com/blog/post/linux-unix/use-unix-linux-tee-command-send-output-two-or-more-directions-a)。

例子：

```
$ ls -al 2>&1 | tee output.txt 
```

上面的命令在屏幕上打印目录列表并输出到 output.txt 文件。

# bash - 如何在 escript 或 Erlang 中设置环境变量

> ID：15114848
> 
> 赞同：2
> 
> 时间：2013-02-27T14:42:05.667
> 
> 标签：bash, erlang, environment-variables

我可以在执行 escript 脚本时设置环境变量，以便在同一环境中执行的其他应用程序可以读取该环境变量（有效地，`export`在 escript 或 Erlang 中是否有等效的 bash 命令可用）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:46:34.397

进程不能影响其父进程或其父进程的其他子进程的环境。

如果您想修改脚本启动的进程的环境（通过 fork 或类似的东西，尽管 OP 告诉我这是不支持的），可能有类似的东西`setenv`可用。

# mediaelement.js - Mediaelement.js 视频如何填充包含框？

> ID：15114849
> 
> 赞同：2
> 
> 时间：2013-02-27T14:42:06.197
> 
> 标签：mediaelement.js

我正在尝试将 Mediaelement 添加到我们的 html 视频播放中。我遇到了一个我还没有弄清楚如何处理的问题，并认为我最好问一下。

在一个地方，视频标签位于灯箱内（确切地说是彩盒）。直接 html5 视频尊重灯箱的大小。它填充可用空间，然后将实际视频帧放入该空间内，留下空白的“信箱”，其中视频和灯箱的纵横比不同。

这有意义吗？换句话说，它可以使视频尽可能大，而不会剪辑它的任何部分。

我希望 Mediaelement 也这样做，但它会做一些不同的事情。Mediaelement 每次都填充宽度。当灯箱比视频更宽时，这会导致视频被剪辑。该视频还可以滚动查看视频的底部和控制部分。

我确实尝试了一些基本的 css 覆盖，使用宽度和高度选项。我还更改了**enableAutosize**选项，但没有发现任何区别。看起来所有动态添加的 html 的大小都是由 Javascript 确定的。

是否有一种*支持*或*预期*的方式来获得我所追求的结果，而无需扩展或破解 Mediaelement javascript？

我可能应该补充一点，视频内容具有不同的尺寸，并且灯箱也是动态大小的。

```
$("a.cbox_group").colorbox({
  rel:'cbox_group',
  scalePhotos:true,
  transition:"none",
  width:"99%",
  height:"99%",
  maxWidth:"90%",
  maxHeight:"100%",
});

$('video').mediaelementplayer({
  loop: true,
  enableAutosize: true,
  features: ['playpause','progress','current','duration','fullscreen'],
  alwaysShowControls: true,
  pauseOtherPlayers: true,
}); 
```

Colorbox 设置为占据大部分浏览器窗口。它具有将内容大小调整为“框” **scalePhotos:true**的功能。这设置了正确的高度和高度，非常适合图像和原始视频标签。

如果 Mediaelement 发现了这一点，它将*做自己的事情*，使播放器的纵横比为 16:9，内容看起来是 1:1 像素比例。

如果我确保未设置此设置，即视频元素没有大小属性​​，则 Mediaelement 将使用**enableAutosize:true**启动并填充并可能导致垂直滚动和控件不在视野范围内。

## 在线“测试用例”

我设法提取了一些说明我遇到的问题的静态 html。一个带有链接的页面，该链接打开一个颜色框弹出窗口，其中几乎完全是我在应用程序中使用的设置。我将 mediaelement javascript 设置为 2s 延迟，以便在 mediaelement 接管之前可以观察到原始视频元素。

我想要找到一些设置组合，允许与原始视频标签相同的基本“布局”（既不剪辑高度也不剪辑宽度）但具有媒体元素控件和自动后备等等。

[示例测试页面](http://eimer.co/mediaelement/demo/colorbox.html)

[来源 Github](https://github.com/eimermusic/eimermusic.github.com/tree/master/mediaelement)

使浏览器非常宽屏以使其明显。

# javascript - Highcharts 更改 legendItemClick 上的系列填充不透明度

> ID：15114852
> 
> 赞同：1
> 
> 时间：2013-02-27T14:42:14.033
> 
> 标签：javascript, highcharts, opacity, legend

我有一个包含两个区域系列的图表，第二个系列的 fillOpacity 为 0.01，我想在单击第一个图例时更改该系列的 fillOpacity。我该怎么做呢？

[我的 jsfiddle](http://jsfiddle.net/4nd7d/4/)

```
chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            marginRight: 130,
            marginBottom: 25
        },
        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        },
        yAxis: {
            title: {
                text: 'Temperature (°C)'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            formatter: function() {
                    return '<b>'+ this.series.name +'</b><br/>'+
                    this.x +': '+ this.y +'°C';
            }
        },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'top',
            x: -10,
            y: 100,
            borderWidth: 0
        },
        series: [{
            name: 'Tokyo',
            type: 'area',
            events: {
                legendItemClick: function() {
                                chart.series[1].fillOpacity = 0.75;
                                chart.redraw();
                }
            },
            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
        }, {
            name: 'New York',
            type: 'area',
            fillOpacity: '0.01',
            data: [-0.2, 0.8, 5.7, 11.3, 17.0, 22.0, 24.8, 24.1, 20.1, 14.1, 8.6, 2.5]
        },
          {
            name: 'New York',
            type: 'area',
            fillOpacity: '0.01',
            data: [-0.2, 0.8, 5.7, 11.3, 17.0, 22.0, 24.8, 24.1, 20.1, 14.1, 8.6, 2.5]
        }]
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T11:30:59.373

您可以通过索引检查单击了哪个“图例中的链接”，然后修改 arwa SVG 对象（在系列线下）并设置自己的背景。

```
if((this.index==0) {
                        //set background for second serie
                        this.chart.series[1].area.attr({
                            fill:'rgba(170,70,67,0.5)'
                        });
                    } 
```

[http://jsfiddle.net/4nd7d/5/](http://jsfiddle.net/4nd7d/5/)

# php - 在 CakePHP 中跨应用程序使用多个数据库和表

> ID：15114854
> 
> 赞同：0
> 
> 时间：2013-02-27T14:42:28.993
> 
> 标签：php, database, codeigniter, cakephp-2.0

对于我的工作，我使用**CodeIgniter**构建了一个基于 Web 的应用程序。现在我想在**CakePHP**中重建这个应用程序，因为我认为它是一个更好的框架，它比我当前的框架可以做更多的事情并且具有更多的结构。

我从 CakePHP 网站上的基本教程开始创建一个小型博客应用程序。这很好用。我还将它与 Twitter Bootstrap 结合起来。现在我正在重建我的应用程序。

**首先我解释一下我的应用程序是做什么的。** 它显示来自数据库的数据列表（概览）。该数据库位于 localhost (MySQL) 上，称为“localdb1”（对于本示例）。该表称为“表”。该表包含我可以直接使用的数据，但它也**包含引用其他数据库的 id**。

例如一个名为 customer 的字段，其中包含客户的编号。客户的姓名存储在另一个数据库 (ODBC) 中，该数据库位于另一个主机 (“remotehost2”) 上。对于此示例，数据库称为“remotedb2”，客户名称存储在“客户名称”字段中的“客户”表中。

两天来，我一直在为 CakePHP 中的数据库系统苦苦挣扎。由于系统使用名称约定，我还不清楚。

**我做了什么：**

*   我已经阅读并搜索了该网站上的 CakePHP 文档，我认为这非常有用，但我找不到答案。
*   我已经搜索了互联网（通过谷歌课程）寻求答案。我发现了许多不同的可能解决方案，但不适合或在数据库连接时出现多个错误。
*   我在 Stackoverflow 的 QA 中进行了搜索。和上面一样。:(

**结果应如下所示：**

我想要一个来自localdb1.sheets的记录列表，但我不想显示客户的号码，但我想要客户的姓名，我在远程数据库remotedb2.customers中找到并且可以通过客户的号码找到

**有人可以告诉我该怎么做吗？** 困难在于，我不仅想要这个，而且我将合并位于这 2 台主机上的更多数据库和表。所以我需要一个像插件这样的解决方案（或者如果它是一个更好的模型），它能够从远程主机或其他表中的本地主机获取内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T05:38:08.877

我不知道它对你有用与否，但我正在使用以下模式维护我的多个云数据库。我希望它也可以为你工作......

在你的 database.php 中为第二个数据库创建一个新的连接对象

```
public $user = array(
    'datasource' => 'Database/Mysql',
    'persistent' => false,
    'host' => 'remotehost2',
    'login' => 'login_id',
    'password' => 'password',
    'database' => 'remotedb2',
    'prefix' => '',
    'encoding' => 'utf8',
); 
```

之后，您可以在模型中使用以下语法使用该连接对象

```
enter var $useDbConfig = 'table_name'; 
```

或者

您也可以使用以下语法维护连接

```
 $options = array();
    $db = ConnectionManager::getDataSource('table_name');
    $list = $db->rawQuery('select id, name from table_name;');
    while ($row = $db->fetchRow()) { 
        $options = Set::insert($options, $row["table_name"]["id"], $row["tablle_name"]["name"]);
    } 
```

# c# - C# 为什么 List.Remove() 打破'for循环'？

> ID：15114860
> 
> 赞同：1
> 
> 时间：2013-02-27T14:42:41.037
> 
> 标签：c#, list, for-loop

我真的不知道为什么 for 循环只循环一次。我认为逻辑是正确的，下面是代码。

```
// the list is named 'dataList'

for(int i = 0 ; i < dataList.Count; i ++)
{
    string[] data = dataList[i].Split('+');
    string[] wsno = data[0].Split(':');
    if(wsno[1].Equals(tbWorkSheet.Text)) 
    {
        dataList.Remove(dataList[i])   <<<< remove string that has the same number
        //data removed
        //for loop ends up here idk why..
    }
} 
```

dataList.Count 将是列表的大小。

情况是这样的..我想删除存储在列表中的多个字符串，每个字符串都有其组号。因此，for 循环将循环到最后一个。但是当它找到一个与所需数字相同的字符串时，它将执行 if 语句来删除它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T14:44:35.940

这是一个非常糟糕的主意。通过像这样从列表中删除值，您将跳过列表中的下一个项目。

例如，您的列表中有 3 个项目位于索引 0、1、2 处。

第一次迭代：i = 0 您删除了索引 0 处的项目。列表现在在索引 0、1 处有项目（删除了第一个项目）。

第二次迭代：i = 1。注意位于索引 1 的项目如何移动到 0。而我们的索引计数器从 0 变为 1。所以我们将“跳过”这个项目。

如果您的列表中只有 2 个项目，他将在第一次删除后中断。这是因为当您的索引增加时计数会减少。

通过逆序，您将消除此问题。

```
List<int> list = new List<int> { 2, 1 };
for (int i = list.Count - 1; i >= 0; i--)
{
    list.RemoveAt(i);
} 
```

编辑：正如**Rawling**提到的，如果在删除项目时*减少计数器*，您可以继续前进。

```
for (int i = 0; i < list.Count; i++)
{
    list.RemoveAt(i--);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T14:54:38.437

您可以使用 List.RemoveAll 泛型方法。方法从 List 中删除与谓词匹配的所有项目。方法签名如下：

int List.RemoveAll（谓词匹配）

它返回已删除的元素数。

请参阅 MSDN： http: [//msdn.microsoft.com/en-US/library/wdka673a (v=vs.110).aspx](http://msdn.microsoft.com/en-US/library/wdka673a(v=vs.110).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:44:29.303

`i`删除项目后您忘记递减。这将跳过下一个项目，因为所有后续项目都将被重新编号为 1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:46:01.200

向后循环列表：

```
for(int i = dataList.Count; i >= 0 ; i--)
{
    string[] data = dataList[i].Split('+');
    string[] wsno = data[0].Split(':');
    if(wsno[1].Equals(tbWorkSheet.Text)) 
    {
        dataList.RemoveAt(dataList[i])   <<<< remove string that has the same number
        //data removed
        //for loop ends up here idk why..
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T14:56:09.770

我更喜欢制作一个新列表而不是修改原始集合。

可以用 LINQ 巧妙地完成：

```
dataList =
    dataList
        .Select(x => new{
            dataItem = x,
            secondWsno = x.Split('+').First().Split(':').Skip(1).First()
        })
        .Where(x => !x.secondWsno.Equals(tbWorkSheet.Text))
        .ToList(); 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2013-02-27T14:44:26.370

您不能在 for 循环中更改列表。您可以将要删除的数据保存在另一个列表中，然后在退出循环后将其删除。

# c# - 为什么会有 PlatformID.MacOSX？

> ID：15114862
> 
> 赞同：2
> 
> 时间：2013-02-27T14:42:42.487
> 
> 标签：c#, macos, unix, operating-system, environment

`Environment.OSVersion.Platform`返回一个`PlatformID`（[信息：MSDN PlatformID](http://msdn.microsoft.com/de-de/library/3a8hyw88%28v=vs.110%29.aspx)）。
这个 PlatformID 的值也可以是“Unix”或“MacOSX”。

我的问题是——为什么要实施这些价值观？我以为 .NET 不能在 MacOSX 或 Unix 系统上运行？！例如，我知道有 Mono，在我看来，如果在 Mono 中实现/实现它是有意义的。但是为什么在 MS .Net 中无论如何都不能在 Unix 系统上运行呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T12:10:22.323

Silverlight 具有非常类似于 .NET 的运行时并且是 Microsoft 的官方产品，在 OSX 上运行良好 - 在 Silverlight 中使用时确实返回“MacOSX”。

# javascript - 将 SSRS 报告集成到 Web - Chrome 等效 - Opera/FF/IE 的 JavaScript hack？

> ID：15114864
> 
> 赞同：1
> 
> 时间：2013-02-27T14:42:47.603
> 
> 标签：javascript, jquery, browser, cross-browser

我对 Microsoft SSRS 报告（在网站上生成）中的日期选择器有疑问。默认情况下，日期选择器不起作用。所以我在网上找到了这段代码（[从 2011 年开始并且已经过时](https://i.imgur.com/9LLrcLm.png)）来解决它：

```
$($(":hidden[id*='DatePickers']").val().split(",")).each(function (i, item) {
    var h = $("table[id*='ParametersGrid'] span").filter(function (i) {
            var v = "[" + $(this).text() + "]";
            return (v != null && v.indexOf(item) >= 0);
        })
        .parent("td").next("td").find("input").datepicker({
            showOn: "button",
            buttonImage: '/WebSite1_Reporting_Test/Reserved.ReportViewerWebControl.axd?OpType=Resource&Name=Microsoft.Reporting.WebForms.calendar.gif', 
            buttonImageOnly: true,
            dateFormat: 'mm/dd/yy',
            changeMonth: true,
            changeYear: true
        }); 
```

但是当我在 Opera/FF/IE 中查看它时，它看起来像：

![在此处输入图像描述](../Images/b29fa063d03ef782e735d846876769b7.png)

它显示 3 个日期图标，其中两个有效（中间一个是默认的坏一个）。但在 Chrome 中它看起来不错！

![在此处输入图像描述](../Images/d4ad803005678161374309352e75b87a.png)

我没有 JS 代码方面的专业知识，我在这里迷路了 - 但一位同事说过滤器功能可能是不必要的。任何提示表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:57:16.587

在同事的帮助下，这是想通了：

```
 .parent("td").next("td").find("input").datepicker(
                    {  dateFormat: 'mm/dd/yy', changeMonth: true, changeYear: true }); 
```

这是一个遗漏的解决方案。我们将日期选择器绑定在输入框上。不知何故，在 chrome 中只显示输入框（可点击），但在 IE/FF/Op 中。您还会看到日期选择器，并且两个日期选择器/输入框都是可点击的。

# jquery - Jquery 对话框仅适用于第一个链接？

> ID：15114866
> 
> 赞同：0
> 
> 时间：2013-02-27T14:42:59.443
> 
> 标签：jquery, html, jquery-ui

```
<script type="text/javascript">
$(function(){
$("#headings_help").click(function(){
$("#box").dialog({

    title: 'Heading and Subheading IDs',
    width: 700,
    height:300,
    modal:true,
    resizable:false,
    buttons: [
    {
      text: 'Close',
      click: function(){
      $(this).dialog('close');
    }
    }
    ]

    });
    });

});
</script> 
```

对于上述`javascript`内容，假设您将此内联元素作为表单的一部分：

```
Help<a id='headings_help' ><img src='questionmark.png' border='0' /></a> 
```

假设上面的问号出现在网页的多个位置，该`jquery`代码仅适用于问号链接的第一个实例。它不适用于同一页面上的其他问号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:01:42.773

```
change this
Help<a class='headings_help' ><img src='questionmark.png' border='0' /></a>
and then
<script type="text/javascript">
$(function(){
$(".headings_help").click(function(){
$("#box").dialog({

    title: 'Heading and Subheading IDs',
    width: 700,
    height:300,
    modal:true,
    resizable:false,
    buttons: [
    {
      text: 'Close',
      click: function(){
      $(this).dialog('close');
    }
    }
    ]

    });
    });

});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:44:39.613

答案不是使用id，而是使用通用类。

ID 是单数的，它们不会在页面上重复。

所以将 ids 更改为一个类

```
<a class='headings_help' ><img src='questionmark.png' border='0' /></a> 
```

更改选择器以使用类

```
$(".headings_help").on("click, function(){...}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:46:48.743

```
 apply same css class to all links 

 then use 

 $(".className").click(function(){
      .........
}) 
```

我们不能将 ont id 用于多个元素。当您想将事件应用于多个元素时，将 css 类应用于所有元素然后使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T14:53:05.963

```
// Get all the links that have an image with `src` `questionmark.png`
var $Links = $.map($('a img[src="questionmark.png"]'), function () {
    return $(this).parent(); // return the parent
});

// Apply click for each of the links
$Links.click(function () {
    // Do your stuff here.
}); 
```

# android - Android将对象转换为JSON格式，GSON不起作用

> ID：15114876
> 
> 赞同：1
> 
> 时间：2013-02-27T14:43:11.427
> 
> 标签：android, json, gson

我正在尝试使用 GSON 将对象转换为 JSON 格式。然后我会将 JSON 发送到用 php 编写的 web 服务。不幸的是，由于某种原因，方法 gson.toJson(object) 不起作用。

我有这个 java 对象 - 干预（这包含几个类型的字符串、日期、时间和位图字段）。当我尝试这样做时：

```
Gson gson = new Gson();
String json = gson.toJson(intervention); 
```

我在 gson 变量中得到了这个：

> gson={serializeNulls:falsefactories:[工厂[type=com.google.gson.JsonElement,adapter=com.google.gson.internal.bind.TypeAdapters$25@40fbe5c8], com.google.gson.internal.bind.ObjectTypeAdapter$1 @411b7db8，工厂[type=java.lang.String,adapter=com.google.gson.internal.bind.TypeAdapters$13@40ff42d0]，工厂[type=java.lang.Integer+int,adapter=com.google.gson .internal.bind.TypeAdapters$7@411c00f8]，工厂[type=java.lang.Boolean+boolean,adapter=com.google.gson.internal.bind.TypeAdapters$3@411b4798]，工厂[type=java.lang.Byte +byte,adapter=com.google.gson.internal.bind.TypeAdapters$5@4122dbd0], 工厂[type=java.lang.Short+short,adapter=com.google.gson.internal.bind.TypeAdapters$6@4122a0c8] , 工厂[type=java.lang.Long+long,adapter=com.google.gson.internal.bind.TypeAdapters$8@40fc5d98], 工厂[type=java.lang.Double+double,adapter=com.google.gson.Gson$4@412295f0]，工厂[type=java.lang.Float+float,adapter=com.google.gson.Gson$5@41229898]，工厂[type=java.lang.Number,adapter=com. google.gson.internal.bind.TypeAdapters$11@41223618]，工厂[type=java.lang.Character+char,adapter=com.google.gson.internal.bind.TypeAdapters$12@41224168]，工厂[type=java. lang.StringBuilder,adapter=com.google.gson.internal.bind.TypeAdapters$16@411a7550], 工厂[type=java.lang.StringBuffer,adapter=com.google.gson.internal.bind.TypeAdapters$17@411a7790],工厂[type=java.math.BigDecimal,adapter=com.google.gson.internal.bind.TypeAdapters$14@40ff4568], 工厂[type=java.math.BigInteger,adapter=com.google.gson.internal.bind. TypeAdapters$15@411b4440]、Factory[type=java.net.URL,adapter=com.google.gson.internal.bind.TypeAdapters$18@411be338]、Factory[type=java.net.URI,adapter=com.google。gson.internal.bind.TypeAdapters$19@41229028]，工厂[type=java.util.UUID,adapter=com.google.gson.internal.bind.TypeAdapters$21@411a2200]，工厂[type=java.util.Locale，适配器=com.google.gson.internal.bind.TypeAdapters$24@411a2510]，工厂[typeHierarchy=java.net.InetAddress,adapter=com.google.gson.internal.bind.TypeAdapters$20@41229328]，工厂[type= java.util.BitSet,adapter=com.google.gson.internal.bind.TypeAdapters$2@411ca140], com.google.gson.internal.bind.DateTypeAdapter$1@412024f8, Factory[type=java.util.Calendar+java .util.GregorianCalendar,adapter=com.google.gson.internal.bind.TypeAdapters$23@411bef70], com.google.gson.internal.bind.TimeTypeAdapter$1@41229920, com.google.gson.internal.bind.SqlDateTypeAdapter$1 @411b67c0，com.google.gson.internal.bind.TypeAdapters$22@411a2500，com.google.gson.internal.bind。ArrayTypeAdapter$1@41222e90, com.google.gson.internal.bind.TypeAdapters$26@411b7ca0, Factory[type=java.lang.Class,adapter=com.google.gson.internal.bind.TypeAdapters$1@4121d940], com. google.gson.internal.Excluder@4122a3c8, com.google.gson.internal.bind.CollectionTypeAdapterFactory@40ff26d0, com.google.gson.internal.bind.MapTypeAdapterFactory@40ff2980, com.google.gson.internal.bind.ReflectiveTypeAdapterFactory@ 40ff2ba0]，instanceCreators：{}}ReflectiveTypeAdapterFactory@40ff2ba0]，instanceCreators：{}}ReflectiveTypeAdapterFactory@40ff2ba0]，instanceCreators：{}}

```
import android.graphics.Bitmap;
import com.google.gson.annotations.SerializedName;
import java.util.Date; 
```

公开课干预{

```
@SerializedName("case_id")
private String case_id;
public String getCase_id() {
    return case_id;
}

@SerializedName("user_id")
private String user_id;
public String getUser_id() {
    return user_id;
}

@SerializedName("account_id")
private String account_id;
public String getAccount_id() {
    return account_id;
}

@SerializedName("description")
private String description;
public String getDescription() {
    return description;
}

@SerializedName("solution")
private String solution;
public String getSolution() {
    return solution;
}

@SerializedName("status")
private String status;
public String getStatus() {
    return status;
}

@SerializedName("user_remarks")
private String user_remarks;
public String getUser_remarks() {
    return user_remarks;
}

@SerializedName("customer_remarks")
private String customer_remarks;
public String getCustomer_remarks() {
    return customer_remarks;
}

@SerializedName("case_complete")
private boolean case_complete;
public boolean isCase_complete() {
    return case_complete;
}

@SerializedName("charge_transport")
private boolean charge_transport;
public boolean isCharge_transport() {
    return charge_transport;
}

@SerializedName("service_billable")
private boolean service_billable;
public boolean isService_billable() {
    return service_billable;
}

@SerializedName("date_created")
private Date date_created;
public Date getDate_created() {
    return date_created;
}

@SerializedName("arrival_time")
private String arrival_time;
public String getArrival_time() {
    return arrival_time;
}

@SerializedName("departure_time")
private String departure_time;
public String getDeparture_time() {
    return departure_time;
}

@SerializedName("user_sign")
private Bitmap user_sign;
public Bitmap getUser_sign() {
    return user_sign;
}

@SerializedName("cust_sign")
private Bitmap cust_sign;
public Bitmap getCust_sign() {
    return cust_sign;
}

public void setUser_id(String user_id) {
    this.user_id = user_id;
}

public void setCase_id(String case_id) {
    this.case_id = case_id;
}

public void setAccount_id(String account_id) {
    this.account_id = account_id;
}

public void setDescription(String description) {
    this.description = description;
}

public void setSolution(String solution) {
    this.solution = solution;
}

public void setStatus(String status) {
    this.status = status;
}

public void setUser_remarks(String user_remarks) {
    this.user_remarks = user_remarks;
}

public void setCustomer_remarks(String customer_remarks) {
    this.customer_remarks = customer_remarks;
}

public void setCase_complete(boolean case_complete) {
    this.case_complete = case_complete;
}

public void setCharge_transport(boolean charge_transport) {
    this.charge_transport = charge_transport;
}

public void setService_billable(boolean service_billable) {
    this.service_billable = service_billable;
}

public void setDate_created(Date date_created) {
    this.date_created = date_created;
}

public void setArrival_time(String arrival_time) {
    this.arrival_time = arrival_time;
}

public void setDeparture_time(String departure_time) {
    this.departure_time = departure_time;
}

public void setUser_sign(Bitmap user_sign) {
    this.user_sign = user_sign;
}

public void setCust_sign(Bitmap cust_sign) {
    this.cust_sign = cust_sign;
} 
```

}

上面的类是对象类。

我验证了对象干预并填充了字段。有人可以向我解释我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T22:24:47.143

当前版本的`Gson`(2.2.2) 对象没有问题，`Date`并且可以很好地序列化/反序列化它们。如果您正在寻找一种特定的格式，您可以使用`setDateFormat()`in`GsonBuilder`来指定它。

你的`Bitmap`对象是一个不同的问题。这是一个非常复杂的对象，而不是 Gson 知道如何处理的东西（没关系，甚至很难用 JSON 表示）。您需要编写自定义序列化器和反序列化器来处理它。

浏览一下文档，`Bitmap`您似乎可以使用适当的静态方法将像素数据提取到`int[]`数组中`getPixels()`，也可以从该数据中构造一个。您将需要编写一个序列化器，从中生成 JSON（并且还包括其他参数），然后编写一个知道如何读取该 JSON 并返回.`Bitmap``createBitmap()``Bitmap`

有关编写自定义序列化程序/反序列化程序的信息可以在 Gson 用户指南中找到：[https ://sites.google.com/site/gson/gson-user-guide#TOC-Custom-Serialization-and-Deserialization](https://sites.google.com/site/gson/gson-user-guide#TOC-Custom-Serialization-and-Deserialization)

# php - 非工作会话变量

> ID：15114877
> 
> 赞同：0
> 
> 时间：2013-02-27T14:43:14.593
> 
> 标签：php, mysql

谁能告诉我为什么没有设置这个会话变量？当登录详细信息正确时，优惠页面会将用户重定向回索引，就像未设置会话变量一样。

```
<?php
session_start();

$username = $_POST['username'];
$password = $_POST['password'];

mysql_connect("localhost", "******", "******") or die("Could not connect.");
mysql_select_db("*******") or die("Could not find database.");

if(($username=='')||($password==''))
{
echo"<script type='text/javascript'>;
alert('Please check and re-enter details');
window.location = 'index.php';
</script>";
}
$qry="SELECT*FROM login WHERE username = '$username' and password = '$password'";
$result=mysql_query($qry);

if(mysql_num_rows($result)==0)
echo "<script type='text/javascript'>;
alert('The username you have entered does not exist in our database.  Please check ad re-enter details.');
window.location = 'index.php';
</script>";

if(mysql_num_rows($result)> 0)
{
$_SESSION['username'] = $username;
header('location: offers.php');
}
?> 
```

offer.php 代码

```
<?php
if ($_SESSION["username"]=="") 
{
header ('Location: index.php');
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:45:49.710

您需要将其放在`session_start();`您的 offer.php 页面的顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:45:51.833

尝试添加：

```
session_start(); 
```

到offers.php的顶部

# solr - Solr 正则表达式查询全局标志

> ID：15114879
> 
> 赞同：0
> 
> 时间：2013-02-27T14:43:19.243
> 
> 标签：solr

我想在 solr 中运行以下正则表达式查询`name:/.+\.m+d$/`。我的索引中有具有以下名称的文档：

```
readme.md
2013.02.26.md
test.mmd 
```

他们都不匹配。删除`$`匹配的*readme.md*条目。我相信问题是我需要指定一个全局模式修饰符，但找不到执行此操作的语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T15:56:14.697

这些是我基于对 Solr 正则表达式匹配进行试验的观察结果：

*   对正则表达式中的所有特殊字符进行[HTML 百分比编码](https://en.wikipedia.org/wiki/Percent-encoding)。[该站点](http://www.url-encode-decode.com/)有助于手动进行百分比编码。

*   如果要匹配整个值，请确保对字符串字段进行正则表达式匹配。文本字段上的正则表达式匹配将涉及标记化，并将根据索引期间生成的标记进行工作。

*   对于 solr 正则表达式，不要指定起始锚点`^`或结束锚点`$`，因为它始终假定您匹配整个字符串。除非您在开头或结尾指定`.*`or （或某些此类正则表达式），否则它始终与开头和结尾匹配。`.+``^``$`

我刚刚在字符串字段中索引了您问题中的 3 个值并发出了此查询，它匹配所有 3 个文档：

```
q=id:/.%2B%5C.m%2Bd/ 
```

的 PCRE`.%2B%5C.m%2Bd`是`.+\.m+d$`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:28:19.277

我在 Reg exp buddy 中试过这个。IT 与您的测试相匹配。

```
.+\.m+d 
```

用于遍历字符串中所有匹配项的 php (Preg) 语法。

```
preg_match_all('/.+\.m+d/', $subject, $result, PREG_PATTERN_ORDER);
for ($i = 0; $i < count($result[0]); $i++) {
    # Matched text = $result[0][$i];
} 
```

这是如果 ^$ 在换行符处匹配并且点匹配新行并且不区分大小写

```
preg_match_all('/.+\.m+d/sim', $subject, $result, PREG_PATTERN_ORDER);
for ($i = 0; $i < count($result[0]); $i++) {
    # Matched text = $result[0][$i];
} 
```

# node.js - 安装 node.js 错误 - 抛出新的 assert.AssertionError

> ID：15114881
> 
> 赞同：0
> 
> 时间：2013-02-27T14:43:24.737
> 
> 标签：node.js

我正在安装 node.js，

在 Ubuntu 12.04 上，使用源 node-v0.8.21.tar.gz

我正在使用[链接](http://www.stoimen.com/blog/2010/11/16/diving-into-node-js-introduction-and-installation/)

同时`make test`，我得到错误

```
python tools/test.py --mode=release simple message
=== release test-http-dns-fail ===                                        
Path: simple/test-http-dns-fail
assert.js:102
  throw new assert.AssertionError({
        ^
AssertionError: false == true
    at process.<anonymous> (/home/trendwise/Downloads/node.js/node-v0.8.21/test/simple/test-http-dns-fail.js:60:10)
    at process.EventEmitter.emit (events.js:126:20)
Error: listen EADDRNOTAVAIL
    at errnoException (net.js:770:11)
    at Server._listen2 (net.js:893:19)
    at listen (net.js:937:10)
    at Server.listen (net.js:994:9)
    at dns.js:72:18
    at process.startup.processNextTick.process._tickCallback (node.js:244:9)
Command: out/Release/node /home/trendwise/Downloads/node.js/node-v0.8.21/test/simple/test-net-pingpong.js
[02:14|% 100|+ 465|-   2]: Done                                                
make: *** [test] Error 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:04:55.237

这是一个已知问题，此处提到：[https ://github.com/joyent/node/issues/4672](https://github.com/joyent/node/issues/4672)

如果你想修复它，我认为你需要 Node 0.9，或者忽略它。

# c++ - 使用更多 C++ 文件在头文件中声明的全局变量

> ID：15114883
> 
> 赞同：1
> 
> 时间：2013-02-27T14:43:29.493
> 
> 标签：c++, variables, dll, export, global

我正在尝试从共享相同 .h 的各种 .cpp 文件创建一个动态库。是这样的：

```
// mylib1.cpp
namespace mylib {
    namespace part1 {
        void init() {
            part1::commonvar = true;
        }
    }
} 
```

和

```
// mylib2.cpp
namespace mylib {
    namespace part2 {
        void check() {
            if (part1::commonvar == true) {
                // do something
            }
        }
    }
} 
```

这是常见的标题

```
// mylib.h
#ifdef __cplusplus 
extern "C" {
#endif
    namespace mylib {
        namespace part1 {
            bool commonvar = false;
            void init();
        }
        namespace part2 {
            void check();
        }
    }
#ifdef __cplusplus 
}
#endif 
```

我正在使用 GCC (MingW) 编译并将其链接到单个 DLL 中，如下所示：

```
g++ -Wall -s -O2 -c mylib1.cpp -o mylib1.o
g++ -Wall -s -O2 -c mylib2.cpp -o mylib2.o
g++ -Wall -s -O2 -shared -o MyLib.dll -Wl,--out-implib=lib/libMyLib.dll.a mylib1.o mylib2.o 
```

所以，我的问题是，当我执行所有这些操作时，在尝试链接这两个对象时，我得到了该变量的多个定义错误。所以，我想知道是否有一种解决方法可以使*commonvar*对于两个命名空间都是通用的，但在两个目标文件中都不重复。如有必要，我可以使其成为命名空间“ *mylib* ”的成员，并且我也可以使用预处理器命令。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:48:24.970

非`const`全局变量具有外部链接。您将全局变量的相同*定义*`commonvar`导入多个翻译单元，链接器最终会抱怨您多次定义该符号，违反了单一定义规则。

您应该使用`extern`关键字将全局变量的定义转换为 a `declaration`，并在*一个* `.cpp`文件中定义全局变量：

**我的库**

```
namespace mylib {
    namespace part1 {
        extern bool commonvar;
    //  ^^^^^^
        void init();
    }
    namespace part2 {
        void check();
    }
} 
```

**MyLib.cpp**（或任何其他`.cpp`文件，只要它*只有一个*）

```
namespace mylib {
    namespace part1 {
        bool commonvar;
    }
} 
```

如果您想知道为什么您的包含保护（如果您正在使用它们）没有阻止在不同翻译单元中对同一符号的多个定义，[**请参阅此**](https://stackoverflow.com/questions/14909997/why-arent-my-include-guards-preventing-recursive-inclusion-and-multiple-symbol)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:48:11.560

下面怎么样

```
 bool* init(){
      static bool commonvar = false;
      return &commonvar;     
  } 
```

# javascript - 使用 iframe 和 javascript API 制作 youtube 视频全屏

> ID：15114884
> 
> 赞同：18
> 
> 时间：2013-02-27T14:43:32.080
> 
> 标签：javascript, youtube, youtube-api

我有一个带有隐藏控件的嵌入式 youtube 视频：

```
<iframe id="ytplayer" type="text/html" width="400" height="225"
src="http://www.youtube.com/embed/dMH0bHeiRNg?rel=0&controls=0&showinfo=0
&loop=1&hd=1&modestbranding=1&enablejsapi=1&playerapiid=ytplayer"
frameborder="0" allowfullscreen></iframe> 
```

我可以使用 youtube Javascript API 来控制它。

```
var tag = document.createElement('script');

tag.src = "//www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

var player;
function onYouTubeIframeAPIReady() {
player = new YT.Player('ytplayer', {
  events: {
    'onReady': onPlayerReady,
    'onStateChange': onPlayerStateChange
  }
});
} 
```

诸如此类`player.playVideo()`的事情完美无缺。现在我正在寻找一种通过 Javascript 调用以全屏模式播放视频的方法，但我在 API 中找不到任何方法。

**甚至可能（没有控件），如果是这样 - 怎么做？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-03-21T11:02:31.637

这对我来说很完美。您可以在此链接上找到更多详细信息：[CodePen 上的演示](http://codepen.io/bfred-it/pen/GgOvLM)

```
var player, iframe;
var $ = document.querySelector.bind(document);

// init player
function onYouTubeIframeAPIReady() {
  player = new YT.Player('player', {
    height: '200',
    width: '300',
    videoId: 'dQw4w9WgXcQ',
    events: {
      'onReady': onPlayerReady
    }
  });
}

// when ready, wait for clicks
function onPlayerReady(event) {
  var player = event.target;
  iframe = $('#player');
  setupListener(); 
}

function setupListener (){
$('button').addEventListener('click', playFullscreen);
}

function playFullscreen (){
  player.playVideo();//won't work on mobile

  var requestFullScreen = iframe.requestFullScreen || iframe.mozRequestFullScreen || iframe.webkitRequestFullScreen;
  if (requestFullScreen) {
    requestFullScreen.bind(iframe)();
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-29T16:31:31.600

我添加了代码来做全屏（**真正的全屏，而不是全窗口）到我对**[Youtube embed 的 Auto-Full Screen 的](https://stackoverflow.com/questions/7615380/auto-full-screen-for-a-youtube-embed)回答中。

YouTube 不会在其 API 中公开全屏，但您可以从 YouTube API 的 playerStateChange() 事件调用本机浏览器 requestFullScreen() 函数，或者像我一样制作自己的自定义播放按钮。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-01T12:39:11.653

您可以使用 html5 全屏 api：

```
node.requestFullScreen();
document.cancelFullScreen();
document.fullScreen; // bool 
```

但请注意：

*   这通常需要供应商特定的前缀，例如`mozRequestFullScreen()`或`webkitRequestFullScreen`
*   `requestFullScreen`必须在用户事件上调用（如 onclick）
*   在Firefox中，全屏将是黑色的，直到用户单击“允许”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-01T16:47:40.340

查看`iframe`播放器的 API 参考，我认为不可能将其设置为全屏（`iframe`仅使用 API）-`ctrl f`没有找到全屏，所以它要么是隐藏在 API 中的秘密方法，要么不存在. 但是，您可能知道，您可以设置播放器的大小`player.setSize(width:Number, height:Number):Object`，然后将[窗口设为全屏](https://stackoverflow.com/questions/1125084/how-to-make-in-javascript-full-screen-windows-stretching-all-over-the-screen)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T14:50:35.383

也许看看这个类似的问题。看起来这可能对您有用（使用 javascript 全屏 api 而不是 Youtube API）：

[使用 Javascript 的 Chromeless 播放器中的全屏选项？](https://stackoverflow.com/questions/13120704/full-screen-option-in-chromeless-player-using-javascript)

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2013-02-27T15:03:45.253

您可以尝试通过 javascript 将 iframe 尺寸设置为窗口尺寸。

像这样的东西（使用jQuery）：

```
$('ytplayer').attr('width', $(window).width());
$('ytplayer').attr('height', $(window).height()); 
```

我希望这可以帮助你。

# ruby - 为什么方法在调用时不返回其最后一个表达式？

> ID：15114886
> 
> 赞同：1
> 
> 时间：2013-02-27T14:43:33.267
> 
> 标签：ruby

当通过对象调用该方法时，我正在使用该方法返回的最后一个表达式。

使用以下代码的概念。

```
class Simple
  def foo
    2 + 2
  end
end
#=> nil
simple = Simple.new
#=> #<Simple:0x11eb390>
simple.foo
#=> 4 
```

但是为什么下面的代码返回这样的编码值而不是`15`and `20`？

```
class Fixnum
  def to_s
    self + 5
  end
end
#=> nil
puts 10
#<Fixnum:0x000015>
#=> nil
puts 15
#<Fixnum:0x00001f>
#=> nil 
```

任何人都可以在这里帮助我理解这个概念吗？

**编辑：**

```
class Fixnum
  def to_s
    self + 5
  end
end
#=> nil
10.to_s
#=> #<Fixnum:0x000029> 
```

同样的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:07:39.027

的合同`to_s`要求您返回一个`String`. 但是，您正在返回一个`Fixnum`. 如果您违反合同，可能会发生各种奇怪的事情。

如果您`String`从您的`to_s`方法中正确返回 a ，那么一切都会按您的预期进行：

```
class Fixnum
  def to_s
    "#{self + 5}"
  end
end

puts 10
# SystemStackError: stack level too deep 
```

好吧，“一切正常”可能有点误导。但是，正如您所看到的，一切都按您的预期发生：*调用*`puts`on `to_s`，`10`添加`5`到`10`返回`15`，然后调用`to_s`on `15`，添加`5`返回`20`，然后调用`to_s`等等`20`。

```
class Fixnum
  orig_to_s = public_instance_method(:to_s)

  define_method(:to_s) do
    orig_to_s.bind(self + 5).()
  end
end

puts 10
# 15 
```

*现在*，一切都按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:47:35.007

如果你将 5 添加到 self，你会得到另一个 Fixnum。

当您打印已修改 to_s 以不显示结果的 Fixnum 时，您开始看到结果对象而不是 fixnum 的值。

# android - Android将彩信添加到数据库

> ID：15114887
> 
> 赞同：11
> 
> 时间：2013-02-27T14:43:40.817
> 
> 标签：android, database, mms

我想将一些彩信添加到我的设备数据库中。

我有以下代码，但它根本不起作用。没有条目被添加到本机应用程序中......

```
public static Uri insert(Context context, String[] to, String subject, Uri messageUri)
{
    try
    {
        Uri destUri = Uri.parse("content://mms/sent");

        // Get thread id
        Set<String> recipients = new HashSet<String>();
        recipients.addAll(Arrays.asList(to));
        long thread_id = getOrCreateThreadId(context, recipients);
        Log.e(">>>>>>>", "Thread ID is " + thread_id);

        // Create a dummy sms
        ContentValues dummyValues = new ContentValues();
        dummyValues.put("thread_id", thread_id);
        dummyValues.put("body", "Dummy SMS body.");
        Uri dummySms = context.getContentResolver().insert(Uri.parse("content://sms/sent"), dummyValues);

        // Create a new message entry
        ContentValues mmsValues = new ContentValues();
        mmsValues.put("thread_id", thread_id);
        mmsValues.put("date", System.currentTimeMillis()/1000);
        mmsValues.put("ct_t", "application/vnd.wap.multipart.related");
        mmsValues.put("read", "1");
        mmsValues.put("sub", subject);

        // Create part
        long dummyId = System.currentTimeMillis();
        createPart(context, dummyId, imageBytes);

        // Insert message
        Uri res = context.getContentResolver().insert(destUri, mmsValues);
        String messageId = res.getLastPathSegment().trim();
        Log.e(">>>>>>>", "Message saved as " + res);

        // Update part
        ContentValues updateValues = new ContentValues();
        updateValues.put("mid", messageId);
        Uri updateUri = Uri.parse("content://mms/" + dummyId + "/part");
        int mmsPartRows = context.getContentResolver().update(updateUri, updateValues, null, null);
        Log.e(">>>>>>>", "Part rows " + mmsPartRows);

        // Create addresses
        for (String addr : to)
        {
            ContentValues addrValues = new ContentValues();
            addrValues.put("address", addr);
            addrValues.put("charset", "106");
            addrValues.put("type", 151); // TO
            Uri addrUri = Uri.parse("content://mms/"+ messageId +"/addr");
            Uri mmsAddrUri = context.getContentResolver().insert(addrUri, addrValues);
            Log.e(">>>>>>>", "Addr uri is " + mmsAddrUri.toString());
        }

        res = Uri.parse(destUri + "/" + messageId);

        // Delete dummy sms
        context.getContentResolver().delete(dummySms, null, null);

        return res;
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }

    return null;
}

private static Uri createPart(Context context, long id, byte[] imageBytes) throws Exception
{
    ContentValues mmsPartValue = new ContentValues();
    mmsPartValue.put("ct", "image/png");
    Uri partUri = Uri.parse("content://mms/" + id + "/part");
    Uri res = context.getContentResolver().insert(partUri, mmsPartValue);
    Log.e(">>>>>>>", "Part uri is " + res.toString());

    // Add data to part
    OutputStream os = context.getContentResolver().openOutputStream(res);
    ByteArrayInputStream is = new ByteArrayInputStream(imageBytes);
    byte[] buffer = new byte[256];
    for (int len=0; (len=is.read(buffer)) != -1;)
    {
        os.write(buffer, 0, len);
    }
    os.close();
    is.close();

    return res;
}

private static long getOrCreateThreadId(Context context, String[] numbers)
{
    HashSet<String> recipients = new HashSet<String>();
    recipients.addAll(Arrays.asList(numbers));
    return Telephony.Threads.getOrCreateThreadId(context, recipients);
} 
```

*   `context`是我的观点上下文
*   `to`是一个包含地址的字符串数组（例如 new String[] {"0612345678", "0623456789"}）
*   `subject`是我的彩信主题，例如“通过 MyApp 发送”
*   `messageUri`是一个指向我想在我的 SD 卡上发送的图像的 Uri。

我做错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T13:13:17.123

终于我找到了如何做这项工作！这是我制作的代码。

告诉我你是否在这方面遇到了麻烦。

```
public static Uri insert(Context context, String[] to, String subject, byte[] imageBytes)
{
    try
    {           
        Uri destUri = Uri.parse("content://mms");

        // Get thread id
        Set<String> recipients = new HashSet<String>();
        recipients.addAll(Arrays.asList(to));
        long thread_id = getOrCreateThreadId(context, recipients);
        Log.e(">>>>>>>", "Thread ID is " + thread_id);

        // Create a dummy sms
        ContentValues dummyValues = new ContentValues();
        dummyValues.put("thread_id", thread_id);
        dummyValues.put("body", "Dummy SMS body.");
        Uri dummySms = context.getContentResolver().insert(Uri.parse("content://sms/sent"), dummyValues);

        // Create a new message entry
        long now = System.currentTimeMillis();
        ContentValues mmsValues = new ContentValues();
        mmsValues.put("thread_id", thread_id);
        mmsValues.put("date", now/1000L);
        mmsValues.put("msg_box", MESSAGE_TYPE_OUTBOX);
        //mmsValues.put("m_id", System.currentTimeMillis());
        mmsValues.put("read", 1);
        mmsValues.put("sub", subject);
        mmsValues.put("sub_cs", 106);
        mmsValues.put("ct_t", "application/vnd.wap.multipart.related");
        mmsValues.put("exp", imageBytes.length);
        mmsValues.put("m_cls", "personal");
        mmsValues.put("m_type", 128); // 132 (RETRIEVE CONF) 130 (NOTIF IND) 128 (SEND REQ)
        mmsValues.put("v", 19);
        mmsValues.put("pri", 129);
        mmsValues.put("tr_id", "T"+ Long.toHexString(now));
        mmsValues.put("resp_st", 128);

        // Insert message
        Uri res = context.getContentResolver().insert(destUri, mmsValues);
        String messageId = res.getLastPathSegment().trim();
        Log.e(">>>>>>>", "Message saved as " + res);

        // Create part
        createPart(context, messageId, imageBytes);

        // Create addresses
        for (String addr : to)
        {
            createAddr(context, messageId, addr);
        }

        //res = Uri.parse(destUri + "/" + messageId);

        // Delete dummy sms
        context.getContentResolver().delete(dummySms, null, null);

        return res;
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }

    return null;
}

private static Uri createPart(Context context, String id, byte[] imageBytes) throws Exception
{
    ContentValues mmsPartValue = new ContentValues();
    mmsPartValue.put("mid", id);
    mmsPartValue.put("ct", "image/png");
    mmsPartValue.put("cid", "<" + System.currentTimeMillis() + ">");
    Uri partUri = Uri.parse("content://mms/" + id + "/part");
    Uri res = context.getContentResolver().insert(partUri, mmsPartValue);
    Log.e(">>>>>>>", "Part uri is " + res.toString());

    // Add data to part
    OutputStream os = context.getContentResolver().openOutputStream(res);
    ByteArrayInputStream is = new ByteArrayInputStream(imageBytes);
    byte[] buffer = new byte[256];
    for (int len=0; (len=is.read(buffer)) != -1;)
    {
        os.write(buffer, 0, len);
    }
    os.close();
    is.close();

    return res;
}

private static Uri createAddr(Context context, String id, String addr) throws Exception
{
    ContentValues addrValues = new ContentValues();
    addrValues.put("address", addr);
    addrValues.put("charset", "106");
    addrValues.put("type", 151); // TO
    Uri addrUri = Uri.parse("content://mms/"+ id +"/addr");
    Uri res = context.getContentResolver().insert(addrUri, addrValues);
    Log.e(">>>>>>>", "Addr uri is " + res.toString());

    return res;
} 
```

# java - GWTTestCase - 未找到测试

> ID：15114888
> 
> 赞同：1
> 
> 时间：2013-02-27T14:43:41.487
> 
> 标签：java, gwt, junit

我在 eclipse juno 中运行 get 1.7.5 试图设置 junit 测试。我从juno插件文件夹添加了junit jar。我已经为junit 4设置了选项。

我创建了一个新的获取项目“MyJunitProject”，并在客户端“MyFirstGWTTestCase”下创建了一个类。这是代码。

```
package com.client;

import org.junit.Test;

import com.google.gwt.junit.client.GWTTestCase;

 public class MyFirstGWTTestCase extends GWTTestCase {

@Override
public String getModuleName() {
    return "com.MyJunitProject";
}

@Test
public void myFirstTest() {
    assertTrue(true);
}

} 
```

我收到以下错误：

```
junit.framework.AssertionFailedError: No tests found in com.client.MyFirstGWTTestCase
at junit.framework.Assert.fail(Assert.java:50)
at junit.framework.TestSuite$1.runTest(TestSuite.java:97)
at junit.framework.TestCase.runBare(TestCase.java:134)
at junit.framework.TestResult$1.protect(TestResult.java:110)
at junit.framework.TestResult.runProtected(TestResult.java:128)
at junit.framework.TestResult.run(TestResult.java:113)
at junit.framework.TestCase.run(TestCase.java:124)
at junit.framework.TestSuite.runTest(TestSuite.java:243)
at junit.framework.TestSuite.run(TestSuite.java:238)
at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:17:20.617

不幸的是，GWT 测试用例都是使用 JUnit 3 模型而不是 JUnit 4 运行的。这意味着`@Test`注释没有任何意义，并且您的方法必须以单词 test 开头。所以而不是

```
//wrong! at least as of GWT 2.5 in a GWTTestCase
@Test
public void myFirstTest() {
    assertTrue(true);
} 
```

你应该写

```
public void testMyFirstTestCase() {
    assertTrue(true);
} 
```

方法名称的其余部分是什么并不重要，只要它以“test”开头即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:28:21.203

这是 GWTTestCase 的示例。

[http://www.tutorialspoint.com/gwt/gwt_junit_integration.htm](http://www.tutorialspoint.com/gwt/gwt_junit_integration.htm)

按照上面链接中给出的步骤进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T03:19:17.753

如果您使用的是 log4j / slf4j，请检查 test/resources 文件夹中是否有 log4j 属性

# tomcat - 没有 WEB-INF 的嵌入式 Tomcat

> ID：15114892
> 
> 赞同：2
> 
> 时间：2013-02-27T14:43:52.807
> 
> 标签：tomcat

我正在努力设置嵌入式 Tomcat 服务器。我的设置与 Tomcat 约定不同，因为我有一个 somePath/www 目录，其中包含我的静态文件，包括 index.html。我也没有 WEB-INF，也没有 web.xml。

我需要 Tomcat 在请求 localhost:8080/ 时打开 index.html。这不起作用，我得到一个找不到页面的错误。不过，当我请求 localhost:8080/index.html 时，请求会返回相关文件。我当前尝试的配置如下所示。

```
tomcat.addWebapp("/", "somePath/www");
Context ctx = tomcat.addContext("/", "somePath/www");
Wrapper defaultServlet = ctx.createWrapper();
defaultServlet.setName("default");
defaultServlet.setServletClass("org.apache.catalina.servlets.DefaultServlet");
defaultServlet.addInitParameter("debug", "0");
defaultServlet.addInitParameter("listings", "false");
defaultServlet.setLoadOnStartup(1);
ctx.addChild(defaultServlet);
ctx.addServletMapping("/*", "default"); 
```

另一方面，对于以下设置：

```
tomcat.addWebapp("/MY_APP", "somePath/www"); 
```

localhost:8080/MY_APP/ 也可以正常工作。

当 url 只是上下文根时，有没有办法让嵌入的 Tomcat 加载 index.html 位于任意目录中？我还要求解决方案不更改目录结构。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:53:12.223

In order for tomcat to serve `index.html` on requests with just the context path (`http://localhost:8080/`) you need to apply the following modifications:

*   Add `"index.html"` to the list of welcome files of your context using `Context.addWelcomeFile()`. The file will be looked up relative to your context's base directory. You can also use relative paths, eg. `"static/index.html"`
*   Use `"/"` pattern in servlet mapping for `"default"` servlet. Only then tomcat will consider welcome files and rewrite the request path before calling default servlet.

After applying these changes the code should look like this:

```
Context ctx = tomcat.addContext("/", "somePath/www");

defaultServlet = ctx.createWrapper();
defaultServlet.setName("default");
defaultServlet.setServletClass("org.apache.catalina.servlets.DefaultServlet");
defaultServlet.addInitParameter("debug", "0");
defaultServlet.addInitParameter("listings", "false");
defaultServlet.setLoadOnStartup(1);

ctx.addChild(defaultServlet);
ctx.addServletMapping("/", "default");
ctx.addWelcomeFile("index.html"); 
```

This is similar to how tomcat configures the context when you call `tomcat.addWebapp()`, so you could just use this:

```
Context ctx = tomcat.addWebapp("/", "somePath/www"); 
```

# php - 从包中添加配置

> ID：15114893
> 
> 赞同：0
> 
> 时间：2013-02-27T14:43:52.753
> 
> 标签：php, symfony, bundle

我想将我的包 config.yml 添加到 app/config/config.yml

我通过进口找到了一种方法。

我想写这个：

```
imports:
  - { resource: parameters.yml }
  - { resource: security.yml }
  name_of_my_bundle:
    - { resource: @MyBundle/Resources/Config/config.yml} 
```

但它不起作用......

我应该怎么写？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T14:47:20.473

缩进在 yml 中很重要。对于“导入”，您根本不需要指定包名称。

```
imports:
  - { resource: parameters.yml }
  - { resource: security.yml }
  - { resource: @MyBundle/Resources/Config/config.yml} 
```

# jsp - 将 href 的值从 JSP 传递给 Servlet

> ID：15114895
> 
> 赞同：0
> 
> 时间：2013-02-27T14:43:54.297
> 
> 标签：jsp, servlets, href

> 我正在开发**Java EE 应用程序**，我想将我**选择的 href 值从 JSP 传递到 Servlet**。我有 5 个链接，我想从中传递选定的值。
> 
> 我的**jsp代码**是，

```
<a href="selectTopic" name="html">HTML 5</a><br />
                <a href="selectTopic" name="windows">Windows 8</a><br />
                <a href="selectTopic" name="office">MS Office 2013</a><br />
                <a href="selectTopic" name="android">Android</a><br />
                <a href="selectTopic" name="hadoop">Hadoop</a> 
```

> 看起来像这样

![在此处输入图像描述](../Images/4c38643eccf589649b2ffe512bea3630.png)

> 我已将我的 selectTopic 操作映射到**SelectedTopic.java** servlet 类。代码是，

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        String selectedTopic = "";

        selectedTopic = (String)request.getParameter("html");

        System.out.println("selectedTopic = "+selectedTopic);

    } 
```

> **输出**是：

```
selectedTopic = null 
```

> 我的问题是，
> 
> 1）为什么我得到空值，因为我已经从任何文本字段中获取值
> 2）我如何动态区分并在 SelectedTopic.java 上获取选定的链接名称（html 或 windows 或 android 等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:53:48.863

您可以尝试使用 request.getRequestURL()：

```
String url = request.getRequestURL().toString(); 
```

或者您可以在锚点末尾添加一些关键字，例如“selectTopic?q=windows 并分析查询字符串（推荐）：

```
String urlWithQueryString = request.getRequestURL().append("?").append( 
     request.getQueryString()).toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:32:08.203

```
HTML [forms][1] are used to pass data to a server.

<form>
.
input elements
.
</form> 
```

并且`Href`不在 [列表中](http://www.files.chem.vt.edu/chem-ed/CHP/workshops/samples/formlist.html)

您必须使用`query string`或 [隐藏参数](http://www.echoecho.com/htmlforms07.htm)。

# algorithm - 采样而不用不等概率替换——线性运行时间可能吗？

> ID：15114898
> 
> 赞同：2
> 
> 时间：2013-02-27T14:44:00.333
> 
> 标签：algorithm, language-agnostic, random-sample

为了寻找[更快的无替换加权抽样](https://stackoverflow.com/questions/15113650/faster-weighted-sampling-without-replacement)，出现了以下问题：

*是否有一种算法可以使用输入大小的线性*时间来实现随机抽样而不用不等的选择概率替换？[在对这个问题](https://stackoverflow.com/questions/2140787/select-random-k-elements-from-a-list-whose-elements-have-weights)的回答中建议了一个 O(n log n) 实现——这可以改进吗？

# javascript - 如何将 javascript 对象复制或 TypeCast 到具有基类的变量

> ID：15114901
> 
> 赞同：0
> 
> 时间：2013-02-27T14:44:04.420
> 
> 标签：javascript, dojo, type-conversion

我有一个从数据结构创建的 Javascript 对象（它是一个 dojo/有状态对象）。我想将该有状态对象转换回标准哈希对象。

```
a = {test: "a test"};
b = new stateful(a);
new_a = new object(a); 
```

这样做的原因是因为我有一个函数需要传递一个带有基对象类的对象。向它传递一个有状态的对象是行不通的，即使数据结构是相同的。

我发现做一个

```
new_a = b;
new_a.__proto__ = new_a.__proto__.__proto__ 
```

会在我正在使用的 Chrome 版本中做我想做的事，但我猜这是一种非常糟糕的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T16:24:42.300

您可以为原始对象上的每个属性创建监视。这将使原始对象与有状态对象的更改保持同步。

此示例扩展`dojo/Stateful`对象以保留原始对象并添加监视以更新原始对象。

[http://jsfiddle.net/cswing/YJHtH/](http://jsfiddle.net/cswing/YJHtH/)

# java - java IO新建一个文件，文件名变成"?????"s 设置文件名为中文

> ID：15114902
> 
> 赞同：1
> 
> 时间：2013-02-27T14:44:07.890
> 
> 标签：java, eclipse, macos

```
File file = new File(this.filePath);
file.createNewFile(); 
```

我用上面的代码创建了一个文件。我将其设置`this.filePath`为中文，当文件创建时，它看起来就像`?????`在 Eclipse 中一样。

这是我的开发环境：

*   macOS 10.8
*   Eclipse 4 朱诺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:48:15.993

尝试窗口 -> 首选项 -> 常规 -> 工作区，在右侧栏上您将看到文本文件编码，尝试其他选项，看看是否能解决您的问题。

还要确保您的操作系统支持中文。

# rest - CakePHP REST 基本映射未按预期工作

> ID：15114907
> 
> 赞同：6
> 
> 时间：2013-02-27T14:44:15.643
> 
> 标签：rest, cakephp, routing, mapping

几乎完全按照蛋糕书的例子。

```
Router::mapResources('incidentReports');
Router::parseExtensions('json'); 
```

之前都

```
require CAKE . 'Config' . DS . 'routes.php'; 
```

我的控制器名为 IncidentReportsController

```
class IncidentReportsController extends AppController { 
```

其中包含功能

```
index()
view($id)
add()
edit($id)
delete($id) 
```

转到网址

```
www.myurl.com/incidentReports.json 
```

按预期将请求发送到 index() 函数。

转到网址

```
www.myurl.com/incidentReports/260.json 
```

应该映射到 view() 函数，但尝试映射到不存在的 260() 函数。

```
www.myurl.com/incidentReports/view/260.json 
```

是否映射到 view() 函数并正常工作。但是，我的理解是 URL 中的“视图”不应该是必需的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-25T20:46:06.913

有同样的问题。就我而言，我可以通过更改 URL 中的控制器名称来修复它。

没有工作：`http://www.example.com/entityName.json`
工作正常： `http://www.example.com/entity_name.json`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-01T05:30:33.550

如果您的控制器在插件中，您还必须指定..

例如：Router::mapResources('Plugin.Controller');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:50:08.340

根据[文档](http://book.cakephp.org/2.0/en/development/rest.html)，你做的一切都是正确的，所以我不确定。尝试把这个（应该启用的路由）也放在你的路由中。

```
Router::resourceMap(array(
    array('action' => 'index', 'method' => 'GET', 'id' => false),
    array('action' => 'view', 'method' => 'GET', 'id' => true),
    array('action' => 'add', 'method' => 'POST', 'id' => false),
    array('action' => 'edit', 'method' => 'PUT', 'id' => true),
    array('action' => 'delete', 'method' => 'DELETE', 'id' => true),
    array('action' => 'update', 'method' => 'POST', 'id' => true)
)); 
```

# ruby-on-rails - 个人资料页面的路由错误

> ID：15114914
> 
> 赞同：0
> 
> 时间：2013-02-27T14:44:28.180
> 
> 标签：ruby-on-rails

我是 Rails 的新手，我正在设置用户个人资料并向其中添加字段，以便用户向他们的个人资料添加详细信息。此信息与注册选项（帐户设置）完全不同。我遇到的问题是个人资料页面上的提交按钮仅将其识别为注册页面上的提交按钮。因此，当用户选择他们所有的个人资料选项（职业、宗教、身高等）然后单击提交时，会将他们重定向到注册页面，并且永远不会将个人资料选项保存给用户。

我相信我解决了这个问题，现在我遇到了路由错误“没有路由匹配 [GET]“/profile/4””

用户控制器：

```
class UsersController < ApplicationController
  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      UserMailer.registration_confirmation(@user).deliver
      session[:user_id] = @user.id
      redirect_to root_url, notice: "Thank you for signing up!"
    else
      render "new"
    end
  end

  def profile
    @user = User.find(params[:id])
    if @user.update_attributes(params[:user])
      flash[:success] = "Account updated"
      redirect_to @user
    else
      render 'edit'
    end
  end

  def edit
    @user = User.find(params[:id])
  end

  def index
    @users = User.all
  end

  def destroy
     User.find(params[:id]).destroy
     flash[:success] = "User deleted."
     redirect_to users_url
   end

  def update
    @user = User.find(params[:id])
    if @user.update_attributes(params[:user])
      flash[:success] = "Account updated"
      redirect_to @user
    else
      render 'edit'
    end
  end
end 
```

这是 profile.html（从允许 /users/user-id-here 的 show.html 重命名，但如上所述，我遇到了问题，所以我更改了文件名）：

```
<h1><%= @user.username %></h1>

<h2>Basics</h2>

<%= form_for @user do |f| %>

    <div class="field">
        <%= f.label :height %><br/>
        <%= f.select :about_me, [['Feet', nil], '4', '5', '6'] %>
        <%= f.select :about_me, [['Inches', nil], '0', '1', '2', '3', '4',                  
                                '5', '6', '7', '8', '9', '10', '11'] %>
        </div>
    <div class="field">
        <%= f.label :children %><br/>
        <%= f.select :children, [['Do you have or want kids?', nil], 'Yes, they live with me', 'I want kids now', 'I want one someday', 'Not for me']%>
        </div>
    <div class="field">
        <%= f.label :religion %><br/>
        <%= f.select :religion, [['What is your faith?', nil], 'Agnostic', 'Atheist', 'Christian', 'Catholic', 'Buddhist', 'Hindu', 'Jewish', 'Muslim', 'Spiritual without affiliation', 'Other', 'None', 'Prefer not to say'  ]%><br/>
        <%= f.select :religion, [['How important is this to you?', nil], 'Very Important', 'Somewhat Important', 'Not Important']%>
        </div>
    <div class="field">
        <%= f.label :career %><br/>
        <%= f.text_field :career %>
    </div>
    <div class="field">
        <%= f.label :education %><br/>
        <%= f.select :education, [['What is your education level?', nil], 'High school', 'Some college', 'Undergraduate', "Bachelor's", "Master's ", 'PhD', 'Business school', 'Law school', 'Medical school' ]%>
        </div>
    <div class="field">
        <%= f.label :ethnicity %><br/>
        <%= f.select :ethnicity, [['What is your ethnicity?', nil], 'Asian', 'Black', 'Biracial', 'Indian', 'Hispanic/Latin', 'Middle Eastern', 'Native American', 'Pacific Islander', 'White', 'Other' ]%>
        </div>
        <%= f.label :user_drink %><br/>
        <%= f.select :user_drink, [['How much do you drink?', nil], 'Often Drinks', 'Sometimes drinks', 'Never drinks', 'No comment' ]%>
        </div><br/>
        <%= f.label :user_smoke %><br/>
        <%= f.select :user_smoke, [['How often do you smoke?', nil], 'Often smokes', 'Sometimes smokes', 'Never smokes'] %>
        </div>
    <div class="actions"><%= f.submit %></div>

    <h3>About Me</h3>

    <%= form_for @user do |f| %>

    <div class="field">
        <%= f.label :about_me %><br/>
        <%= f.text_field :about_me %>
    <div class="actions"><%= f.submit %></div>

<% end %>
<% end %> 
```

这是路线文件：

```
Dating::Application.routes.draw do
  get 'signup' => 'users#new'
  get 'login' => 'sessions#new'
  get 'logout' => 'sessions#destroy'
  get 'edit' => 'users#edit'
  get 'profile' => 'users#profile'

  resources :users
  resources :sessions
  resources :password_resets

  root to: 'users#new' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:06:26.013

您需要在 form_for 中明确定义您的路径：

```
<%= form_for(@user, :url => {:action => :profile}) do |f| %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:48:33.657

改变

```
get 'profile' => 'users#profile' 
```

至

```
get 'profile/:id' => 'users#profile' 
```

或者更好的解决方案是在用户下添加成员路由

```
resources :users do
  get :profile, on: :member
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:49:45.020

你应该把 routes.rb

```
match "/profile/:id" => "users#show" 
```

虽然，我不会使用将 show.html 更改为 profile.html 的方法，但这应该可以修复路由:)

# c# - 方法添加到列表另一个方法读取列表

> ID：15114921
> 
> 赞同：-11
> 
> 时间：2013-02-27T14:44:46.630
> 
> 标签：c#, .net

如何使一个方法添加到列表中，而另一个方法读取列表来操作数据？

想法是，Method-A 获取数据并添加到 List-A。Method-B 在 Method-A 完成循环列表后读取数据并在列表上做一些工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:51:32.893

假设您正在执行多线程，您可能正在寻找的是一个[`BlockingCollection`](http://msdn.microsoft.com/en-gb/library/dd997371.aspx). 这使得为​​并行处理工作项编写线程安全代码变得非常容易。

如果您不是多线程，那么您可能需要一个[`Queue<T>`](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx).

但是您的问题实际上并没有足够的细节来正确回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:46:41.660

只需定义方法并传入`List`：

```
public void AppendData(List<SomeType> list) {
  // logic as per your requirements
}

public void ManipulateData(List<SomeType> list) {
  // logic as per your requirements
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:46:49.837

创建一个包含私有属性的类，该属性将成为您的列表，以及两个方法。这两种方法将可以访问相同的列表属性，而不会弄乱应用程序的其余部分。

# xml - 解析字符串映射并转换为 xml

> ID：15114922
> 
> 赞同：0
> 
> 时间：2013-02-27T14:44:46.590
> 
> 标签：xml, groovy

给出一个 id 和字符串路径的映射，我需要解析和构建一个 xml 文档。

1）这是带有ID的路径图（从数据库中收集）：

```
def trees = [:]
trees.put(1,"TEST/folder1")
trees.put(2,"TEST/folder2")
trees.put(3,"TEST/folder1/folder1.1")
trees.put(4,"TEST/folder2/folder2.1/folder2.1.2")
trees.put(5,"TEST/folder1/folder1.2") 
trees.put(6,"TEST/folder1/folder1.2/folder1.2.1/")                        
trees.put(7,"TEST/folder1/folder1.2/folder1.2.2/")
trees.put(8,"TEST/folder1/folder1.2/folder1.2.2/1.2.2.1") 
```

2) 闭包定义

```
def parseTreeNodes(HashMap<Integer,String> t) {
    def treeNodes = [:]
    def nodeItems = []
    def subItems=[]
    t.each { k,v ->
        subItems = v.split('/')
        subItems.eachWithIndex { node,i ->
            if(!treeNodes.values().contains(node)) {
                treeNodes.put(id:k,[depth:i,node:node,parent:subItems[i-1]])
            }
        }
    }
    println treeNodes.toString() + "---"
} 
```

3) 调用闭包

```
parseTreeNodes(trees) 
```

如何将 xml 转换应用于此过滤器，以便将 xml 文档作为输出而不重复？

4）有没有一种通用的方法来转换 xml 树以获取具有名称和 id 的属性（从第一次迭代中提取）？？？

```
<folder name="folder1" id="1" depth="1">
      <folder name="folder1.2" id="2" path="folder1/folder1.2" depth="2"/>
 <folder> 
... 
```

事实上，下面的地图已经有了所有的数据：

```
def treeNodes = [:]
     trees.each { k,v ->
                    subItems = v.split('/')
                    subItems.eachWithIndex { node,i ->
                        if(!treeNodes.values().contains(node)) {
                            treeNodes.put(id:k,[depth:i,node:node,parent:subItems[i-1]])
                        }
                    }
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:06:22.013

您可以执行以下操作来生成文件夹映射：

```
// Build a map of folders (see https://gist.github.com/kiy0taka/2478499)
def rslt = { [:].withDefault{ owner.call() } }().with { t ->
  trees.each { k, v ->
    v.tokenize( '/' ).inject( t ) { tr, i -> tr[ i ] }
  }
  t
} 
```

然后像这样将地图的地图转换为xml

```
// Taken from https://gist.github.com/uehaj/875631
sw = new StringWriter()
new groovy.xml.MarkupBuilder(sw).with {
  visitor = { k, v -> "$k" { v instanceof Map ? v.collect(visitor) : mkp.yield(v) } }
  root { rslt.collect visitor }
} 
```

所以现在打电话：

```
println sw.toString() 
```

印刷：

```
<root>
  <TEST>
    <folder1>
      <folder1.1 />
      <folder1.2>
        <folder1.2.2>
          <1.2.2.1 />
        </folder1.2.2>
      </folder1.2>
    </folder1>
    <folder2>
      <folder2.1>
        <folder2.1.2 />
      </folder2.1>
    </folder2>
  </TEST>
</root> 
```

# c# - 部署后启动服务命令失败

> ID：15114924
> 
> 赞同：0
> 
> 时间：2013-02-27T14:44:53.873
> 
> 标签：c#, windows-services, castle-windsor, topshelf

我遇到了 Windows 服务的问题 - 部署后`service_Start`尝试失败（超时）。在第二次尝试时，它基本上成功了。我试过增加超时，但没有帮助。该服务没有依赖关系。

这是一个使用容器的`c#`+应用程序。实现的主类注册到 LifestyleType 。其他依赖项注册为.`Topshelf (latest)``Castle.Windsor (2.5.3)``IMyService``Singleton``transient`

该服务从 Rabbit 总线读取消息并将它们存储在 Couchbase 中。

配置代码如下所示：

```
HostFactory.Run(x =>                                 
            {
                x.Service<IMyService>(s =>                        
                {
                    s.ConstructUsing(name => WindsorContainerContext.Container.Resolve<IMyService>());   
                    s.WhenStarted(s => s.Start());             
                    s.WhenStopped(s =>
                                    {
                                        s.Stop();
                                        WindsorContainerContext.Container.Release(s);
                                        WindsorContainerContext.Container.Dispose();
                                    });
                });
                x.RunAsLocalSystem();                            

                x.SetDescription(serviceDescription);
                x.SetDisplayName(serviceDescription);                       
                x.SetServiceName(serviceName);

            }); 
```

我认为也许某些东西没有正确发布并导致启动失败，但是在尝试了一些更改之后，我真的不知道还有什么可以尝试的。

我知道这可能不足以解决这个问题 - 请让我知道什么样的信息会有所帮助。我真的很想知道这里发生了什么，所以如果你能指出我在调试这个方面的正确方向，我也会很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-24T15:22:55.783

所以作为一个控制台应用程序，正常调试，你通常不会超时。

所以你可以请求更多时间，但我会从请求 20-30 秒开始。如果您要求的时间过长，服务经理会忽略您的请求并且不会告诉您。

# php - 在 GIT 控制的 Intranet 上使用 GIT / BitBucket 进行持续集成

> ID：15114928
> 
> 赞同：3
> 
> 时间：2013-02-27T14:45:16.047
> 
> 标签：php, git, netbeans, bitbucket

我刚刚为一个三人团队实施了 GIT 版本控制。我们正在设法拉/推/取等到我们的 bitBucket 存储库。我唯一关心的是在我们对存储库进行更新后我应该如何推送。

在另一台服务器上，我编写了一个 shell 脚本将 repo 克隆到一个目录中，这样我就可以进行测试了，但是在实时服务器上我不能这样做，因为在某些情况下我只需要推送一个文件。

请注意，我们的实时服务器位于网络内部，无法通过 Internet 访问（因此我无法使用 BitBucket 的推送服务）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:50:04.123

我能给出的唯一建议是确保本地存储库（集中了来自开发人员的更改）在推送之前是最新的并且完好无损。

您可以在本地定义您的工作流程。也许只有官方提交的主存储库会在通过本地测试后为每个开发人员的工作分支，并且每个人都可以在他们的机器上做他们喜欢的事情。或者更高级的东西。有关于工作流程的建议，从几乎集中到完全分布式，请查看它们。如果你采用一种工作`git`方式，如果你以后决定改变它，也不会妨碍你。

# jakarta-ee - EJB 拦截器有什么用途？

> ID：15114929
> 
> 赞同：0
> 
> 时间：2013-02-27T14:45:22.520
> 
> 标签：jakarta-ee, ejb, interceptor

我正在构建一个 Java EE 6 Web 应用程序，用户必须通过会话范围的托管 bean 登录。什么是 EJB 拦截器以及它们如何在我的程序中帮助我。我一直在阅读有关它们的信息，但是我阅读的材料在解释上似乎有些荒谬。任何人都可以把它放在我的外行条款中。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:56:08.533

我并不特别了解 Java EE 6 中的拦截器，但我知道 Struts 2 框架中的拦截器，实际上它看起来是一样的。

关键是横向任务不应该在你的类中（日志记录、识别、安全......）..所以它被决定放在拦截器中。

当请求到达时，在到达您的操作之前（和离开之后），我会说，它被其他一些可以验证、更改或执行您认为合适的任何事情的类拦截。

这是一种很好的编程方式，因此 POO 更受尊重。您的业​​务类不再被不应该存在的代码片段所污染，并且不再被应该从所有应用程序访问的代码片段所污染

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-17T02:49:08.160

拦截器是能够在方法调用或 EJB 或任何 CDI bean 的生命周期事件中插入自身的对象。

常见用法：

*   **Profiling**：您可以测量 EJB 方法花费的时间。因此，您可能会发现瓶颈。
*   **审计**：记录谁以及何时有人使用 EJB 方法。
*   **日志**：如果方法失败/成功（或抛出异常）写入文件，还可以让您知道方法调用的参数和返回值。
*   **自定义框架**：您可以根据自己的业务规则创建自定义框架。
*   **生命周期**：例如，如果某些 EJB 需要一些特殊资源，您可以将它们添加到 @PostConstruct 并在 @PreDestroy 时间关闭资源。
*   **自定义注入注解**：创建您自己的注解并在使用 EJB 的方法之前对 JNDI 进行一些查找以注入资源。

拦截器是 EJB 最好的朋友：

*   共享生命周期：连同它们的 bean 实例一起创建、销毁、钝化和激活
*   相同的 Java 调用堆栈
*   与它们拦截的 EJB 相同的 JNDI ENC 上下文
*   AroundInvoke 方法调用发生在与它们所插入的方法相同的事务和安全上下文中。

所以，这里是拦截器。正如莱昂纳多所说，出于您的目的（登录页面），过滤器会更好，但将拦截器保留在您的工具箱中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-17T01:33:38.213

IMO，我认为拦截器在这种情况下不会对您有太大帮助，因为它用于包装 EJB 方法，并且可能大多数这些方法只有在用户已经登录系统时才可用。检查每个 EJB 方法是否被授权用户请求听起来像是不必要的开销。当您尝试限制应用程序的使用时，过滤器通常是您真正想要的，因为它适用于请求级别，如果那里有一些 Session 对象，您可以检查用户是否登录。

拦截器对于剖析和审计等横向特性当然很有用。

# ios - 如何解决带有批评的 SIGSEGV

> ID：15114934
> 
> 赞同：3
> 
> 时间：2013-02-27T14:45:40.317
> 
> 标签：ios, objective-c, crittercism

我正在使用 crittercism 来获取有关我的应用程序的崩溃报告。它工作得很好，但是我遇到了一个堆栈跟踪崩溃，这并不是很有帮助。

```
0   libobjc.A.dylib 0x3b16c5b0 objc_msgSend + 16
1   Foundation 0x33d6b0f5 __NSThreadPerformPerform + 461
2   CoreFoundation 0x33429683 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 15
3   CoreFoundation 0x33428ee9 __CFRunLoopDoSources0 + 213
4   CoreFoundation 0x33427cb7 __CFRunLoopRun + 647
5   CoreFoundation 0x3339aebd CFRunLoopRunSpecific + 357
6   CoreFoundation 0x3339ad49 CFRunLoopRunInMode + 105
7   GraphicsServices 0x36f712eb GSEventRunModal + 75
8   UIKit 0x352b0301 UIApplicationMain + 1121
9   myapp 0x00024c2f main (main.m:14) 
```

坠机是象征性的，但没有任何信息可以告诉我坠机的确切位置。我认为它可能是一个过早发布的对象，但由于它是一个随机错误而且我不知道它发生在哪里，所以很难追踪它。如何将此堆栈跟踪或崩溃报告转换为人类可读的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T09:22:11.157

这次崩溃几乎与我目前主要的导致头痛的崩溃*完全相同*，我不知道该怎么办。我的崩溃日志中*唯一*的变化是`main (main.m:6)`你的`main (main.m:14)`.

到目前为止，我发现了这个：

*   [SIGABRT 在 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ 上崩溃](https://stackoverflow.com/questions/8214721/sigabrt-crash-on-cfrunloop-is-calling-out-to-a-source0-perform-function)
*   [被拒绝的 iPhone 应用程序有奇怪的崩溃日志](https://stackoverflow.com/questions/5148756/rejected-iphone-app-has-strange-crash-logs)

***接受的答案表明它可能与滥用`performSelector`.***

这家伙也有同样的崩溃，但没有建议的解决方案：

*   [http://comments.gmane.org/gmane.comp.handhelds.phonegap/24494](http://comments.gmane.org/gmane.comp.handhelds.phonegap/24494)

还有其他类似的崩溃日志有一个奇怪的补充：

```
...
CoreFoundation 0xXXXXXXXX -[NSObject performSelector:withObject:] + XX <- additional line
Foundation     0xXXXXXXXX __NSThreadPerformPerform + XXX
CoreFoundation 0xXXXXXXXX __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + XX
... 
```

***这再次表明它与 相关`performSelector`***，但这仍然是猜测。

# android - 有没有一个网站可以在我发布之前下载我的 APK 并给我反馈？

> ID：15114935
> 
> 赞同：0
> 
> 时间：2013-02-27T14:45:42.327
> 
> 标签：android, apk, alpha, beta-testing

我有我的朋友和“alpha 测试人员”，但我很想在我第一次在 Google Play 商店中发布它之前向尽可能多的人展示它。如果还有其他人推荐的，请告诉。

这是我的第一个应用程序，所以我只是想在发布之前进行尽职调查，而不是在它准备好之前发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:01:26.777

你可以试试

[安卓应用](http://www.androidtapp.com/)

[贝塔家族](http://thebetafamily.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:57:30.313

使用[ACRA](https://www.google.at/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC8QFjAA&url=http://code.google.com/p/acra/&ei=VR4uUcXeLtDS4QSXo4HIDg&usg=AFQjCNF1L9fawVNYyKuqqIa7q22TBcL08w&sig2=o2-yoO44CxH7LuMALVkDnw)进行崩溃报告。它很容易设置，将为您省去很多麻烦。此外，您可以在任何网络空间上托管 APK 文件，并将测试人员指向该链接。我推荐使用谷歌驱动器，因为以后很容易撤销权限。

# maven - Maven 源插件包括配置

> ID：15114940
> 
> 赞同：2
> 
> 时间：2013-02-27T14:45:59.690
> 
> 标签：maven, fileset, maven-source-plugin

我有一个非标准配置的 Maven 项目：

```
$> tree                                                                                          
.
├── pom.xml
├── symbolic-link-to-sources -> ../src
└── target
    ├── maven-archiver
    │   └── pom.properties
    ├── project-1.0-SNAPSHOT-sources.jar
    ├── project-1.0-SNAPSHOT.jar
    └── surefire 
```

我正在尝试生成此 maven 模块的源 jar，其源位于 ../src 中。在插件不接受路径中的父文件夹的情况下，我创建了一个指向 ../src 的符号链接。为此，我使用配置如下的 Maven 源插件：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-source-plugin</artifactId>
  <version>2.2.1</version>
  <configuration>
    <includePom>true</includePom>
    <includes>
      <include>symbolic-link-to-sources/**</include>
    </includes>
  </configuration>
</plugin> 
```

我用`mvn source:jar`. 不幸的是，我的源 jar 中只有 pom.xml。如果我将 includePom 设置为 false，则插件不会创建源存档。

我尝试了很多东西，例如：、、、、、，`<include>`它们都没有将我的资源放入我的资源 jar中。尽管有关它的[文档](http://maven.apache.org/plugins/maven-source-plugin/jar-mojo.html#includes)说它是一个相对的文件集模式。`../src``../src/**``../**``symbolic-link-to-sources``symbolic-link-to-sources/**``../**/*.java`

知道如何将 ../src 文件夹的 java 文件的内容放入我的源 jar 中吗？

（是的，我的符号链接没有损坏，没有办法重新排列我的模块以具有标准的文件夹层次结构，这是一个围绕基于 ant 的项目的包装器项目）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T08:15:59.733

您将使用该`<includes`属性来指定要包含*在*源文件夹中的文件/模式。

您是否设置`<sourceDirectory>`了正确的源位置（符号链接等）？如果是这样，你可以省略上面的整个插件配置，只`mvn source:jar`在 pom 上运行吗？它应该正确生成源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-26T12:09:24.887

卡住了同样的问题，经过谷歌搜索和尝试终于得出了这个结论：

```
<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>build-helper-maven-plugin</artifactId>
  <executions>
    <execution>
      <phase>package</phase>
      <goals>
        <goal>add-source</goal>
      </goals>
      <configuration>
        <sources>
          <source>../common/src/main/java</source>
        </sources>
      </configuration>
    </execution>
  </executions>
</plugin>
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-source-plugin</artifactId>
  <executions>
    <execution>
      <id>attach-sources</id>
      <goals>
        <goal>jar</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

其中“../common/src/main/java”是指向在当前项目中作为符号链接链接的源的路径。

请注意 build-helper-maven-plugin 有 package **phase**。使用阶段**生成源**，我得到了“重复类”，因为从符号链接目录和 build-helper-maven-plugin 中配置的目录添加了相同的源。

# angularjs - Angular.JS 触发两个异步服务调用，然后在两者都完成后执行操作

> ID：15114942
> 
> 赞同：14
> 
> 时间：2013-02-27T14:46:02.457
> 
> 标签：angularjs

我仍然在围绕 Angular.JS 绞尽脑汁。

我有两个独立的 $http 调用，它们从远程 Web 服务中检索数据。我有一个动作，我想在两个服务调用都完成后触发。

1.  第一个服务调用将填充 $scope.model
2.  第二个服务调用，修改 $scope.model 中的数据（它添加了一些在视图中呈现的计数器属性）

另一个独特的要求是最终将在控制器外部调用第二个服务调用并使用 $scope.model 进行更新。这是一个通知消息泵。

我猜我将使用 promises $q 和可能的 $service，但我不太确定从哪里开始遵循一些最佳实践。

我知道在这里异步调用听起来不合适，因为我的示例可以通过同步进行来简化。但是，第二个服务调用是一个通知更新程序，因此它会不断地轮询到服务器（最终将使用 websocket）。

这是我将在此应用程序中看到的常见模式。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-27T16:53:55.863

你会想要使用 $q 承诺。特别是 $q.all()。所有的 $http 方法都会返回 Promise。`$q.all([promise, promise, promise]).then(doSomething)`将等待所有承诺解决，然后调用`doSomething`将一组承诺结果传递给它。

```
app.service('myService', ['$http', '$q', function($http, $q) {
   return {
      waitForBoth: function() { 
          return $q.all([
             $http.get('/One/Thing'),
             $http.get('/Other/Thing')
          ]);
      };
   }
}]); 
```

然后调用它：

```
app.controller('MyCtrl', ['$scope', 'myService', function($scope, myService) {
   myService.waitForBoth().then(function (returnValues){
       var from1 = returnValues[0].data;
       var from2 = returnValues[1].data;
       //do something here.
   });
}]); 
```

这是为您演示的[Plunker](http://plnkr.co/edit/ba0awQTiqviijz8n4I59?p=preview)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T16:50:21.017

为您的第一个服务调用创建服务。皮特的回答将对此有所帮助：[https ://stackoverflow.com/a/12513509/215945](https://stackoverflow.com/a/12513509/215945)

在您的控制器中，在 then() 回调中，为适当的 $scope.model 属性添加一个 $watch：

```
app.controller('MainCtrl', function(myService, $scope) {
  myService.async().then(function(myData) {
    $scope.model = myData;
    $scope.$watch('model.???', function(newVal, oldVal) {
      if(newVal !== oldVal) {
         // do something here, now that $scope.model.??? has changed
      }
    })
  });
}); 
```

# jsf - primefaces自动完成问题

> ID：15114943
> 
> 赞同：0
> 
> 时间：2013-02-27T14:46:04.833
> 
> 标签：jsf, jsf-2, autocomplete, primefaces

基本上，我正在尝试使用 primefaces 的自动完成来搜索我的社交网络项目中的用户。我面临的问题是，每当有新用户注册时，自动完成功能有时会在建议中显示新用户，有时不会显示。通常在用户第一次注册时，自动完成功能会在建议中显示用户的姓名，但第二次当另一个用户注册时，他的姓名不会显示在建议中。我认为 userDB 没有得到更新。但是每当我重新部署项目时，一切都运行良好。用户名显示在自动完成中。

1)xhtml

```
<div class="det">
                <h:form style="float:right;font-size:small;">&nbsp;&nbsp;&nbsp;
      <h:outputText value="Search your friends here."
                        style="font-size:small;color:#CCCCCC;" />
                    <p:autoComplete id="auto" value="#{searchBean.selectedUser}"
                        completeMethod="#{searchBean.completeUser}" var="p"
                        itemLabel="#{p.userName}" itemValue="#{p}"
                        converter="userConverter" forceSelection="true"
                        style="width:300px;">
                        <p:column>
                            <img src="../images/profilePicture/thumb/#{p.image}"
                                style="height: 40px; width: 40px;" />
                        </p:column>
                        <p:column>  
                    #{p.firstName} #{p.lastName}   
            </p:column>
                    </p:autoComplete> 
         &nbsp;<h:commandButton image="../Image/magnify.png"
                        action="#{searchBean.navigate}" style="height:20px;float:right;" />
                    <br />
                </h:form>
            </div> 
```

2) 用户转换器

```
 package com.bean;

import java.util.ArrayList;
import java.util.List;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.convert.ConverterException;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;

import com.entity.User;

public class UserConverter implements Converter {

    public static   List<User> userDB;
    static EntityManagerFactory emf=Persistence.createEntityManagerFactory("FreeBird");
    static EntityManager em =emf.createEntityManager();

    static {  
        userDB = new ArrayList<User>();  
        Query query = em.createQuery("SELECT u FROM User u", User.class);
        userDB =query.getResultList();

    }

    public Object getAsObject(FacesContext facesContext, UIComponent component, String submittedValue) {  
        if (submittedValue.trim().equals("")) {  
            return null;  
        } else {  
            try {  

                for (User p : userDB) {  
                    if (p.getUserName().equalsIgnoreCase(submittedValue)) {  
                        return p;  
                    }  
                }  

            } catch(Exception exception) {  
                throw new ConverterException(new FacesMessage(FacesMessage.SEVERITY_ERROR, "Conversion Error", "Not a valid user"));  
            }  
        }  

        return null;  
    }  

    public String getAsString(FacesContext facesContext, UIComponent component, Object value) {  
        if (value == null || value.equals("")) {  
            return "";  
        } else {  
            return String.valueOf(((User) value).getUserName());  
        }  
    }  

} 
```

3) 搜索豆

```
package com.bean;
import com.bean.UserConverter;
import java.util.ArrayList;
import java.util.List;

import javax.faces.context.FacesContext;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.servlet.http.HttpSession;

import com.entity.User;

public class SearchBean {
    private EntityManager em;
    private User selectedUser;
    private List<User> users;

    public SearchBean(){
        users = UserConverter.userDB;
        EntityManagerFactory emf=Persistence.createEntityManagerFactory("FreeBird");
         em =emf.createEntityManager();
    }

    public User getSelectedUser() {
        return selectedUser;
    }

    public void setSelectedUser(User selectedUser) {
        this.selectedUser = selectedUser;
    }

    public List<User> completeUser(String query){
        List<User> suggestions = new ArrayList<User>();

        for(User u : users){
            if(u.getUserName().startsWith(query))
                suggestions.add(u);
        }

        return suggestions;
    }
    public String navigate(){
        User friend=em.find(User.class,selectedUser.getEmail());
        FacesContext context = FacesContext.getCurrentInstance();
        HttpSession session = (HttpSession) context.getExternalContext().getSession(true);
        session.setAttribute("frienddet",friend);
        return "searchsuccess";
    }

} 
```

4) 注册Bean

```
package com.bean;

import java.util.logging.Logger;

import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;
import javax.servlet.http.HttpSession;

import org.primefaces.event.FlowEvent;

import com.entity.User;

public class RegistrationBean {

    User user ;
    private EntityManager em;
     private boolean skip;  
     private static Logger logger = Logger.getLogger(RegistrationBean.class.getName()); 
    public RegistrationBean(){
        user=new User();
        EntityManagerFactory emf=Persistence.createEntityManagerFactory("FreeBird");
         em =emf.createEntityManager();
    }

    public User getUser() {
        return user;
    }

    public void setUser(User user) {
        this.user = user;
    }
     public boolean isSkip() {  
            return skip;  
        }  

        public void setSkip(boolean skip) {  
            this.skip = skip;  
        } 
    public String Save(){
        System.out.println("registration save called");
        em.getTransaction().begin();
        em.persist(user);
        em.getTransaction().commit();
        FacesContext context = FacesContext.getCurrentInstance();
        HttpSession session = (HttpSession) context.getExternalContext().getSession(true);
        session.setAttribute("userdet",this.user);
        return "success";

    }
     public String onFlowProcess(FlowEvent event) {  
            logger.info("Current wizard step:" + event.getOldStep());  
            logger.info("Next step:" + event.getNewStep());  

            if(skip) {  
                skip = false;   //reset in case user goes back  
                return "confirm";  
            }  
            else {  
                return event.getNewStep();  
            }  
        }

} 
```

5）注册xhtml

```
<p:growl id="growl" sticky="true" showDetail="true" />

                <p:wizard widgetVar="wiz"
                    flowListener="#{registrationBean.onFlowProcess}"
                    style="text-size:small;">

                    <p:tab id="personal" title="Personal">

                        <p:panel header="Personal Details">

                            <h:panelGrid columns="3" columnClasses="label, value"
                                styleClass="grid">
                                <h:outputText value="Username*" />
                                <p:inputText id="usrname" required="true" label="Username"
                                    value="#{registrationBean.user.userName}"
                                    requiredMessage="Username required" />
                                <p:message for="usrname"></p:message>

                                <h:outputText value="Firstname: *" />
                                <p:inputText id="frstname" required="true" label="Firstname"
                                    value="#{registrationBean.user.firstName}"
                                    requiredMessage="Firstname required" />
                                <p:message for="frstname"></p:message>

                                <h:outputText value="Lastname: *" />
                                <p:inputText id="lstname" required="true" label="Lastname"
                                    value="#{registrationBean.user.lastName}"
                                    requiredMessage="Lastname required" />
                                <p:message for="lstname"></p:message>

                                <h:outputText value="Password: *" />
                                <p:password id="pwd1" value="#{registrationBean.user.password}"
                                    feedback="true" match="pwd2" label="Password" required="true"
                                    requiredMessage="Password required" />
                                <p:message for="pwd1"></p:message>

                                <h:outputText value="Confirm Password: *" />
                                <p:password id="pwd2" value="#{registrationBean.user.password}"
                                    feedback="true" label="Confirm Password" required="true" />
                                <p:message for="pwd2"></p:message>

                                <h:outputText value="Date of Birth:" />
                                <p:calendar value="#{registrationBean.user.birthDate}"
                                    pattern="dd/MM/yyyy" mode="popup" showOn="button"
                                    navigator="true"></p:calendar>
                                <p:message for="frstname"></p:message>

                                <h:outputText value="Gender: " />
                                <p:inputText label="Gender"
                                    value="#{registrationBean.user.gender}" />
                                <p:message for="frstname"></p:message>

                                <h:outputText value="Relationship Status: " />
                                <p:inputText label="Relationship Status"
                                    value="#{registrationBean.user.relationship}" />
                                <p:message for="frstname"></p:message>

                                <h:outputText value="Skip to last: " />
                                <h:selectBooleanCheckbox value="#{registrationBean.skip}" />
                            </h:panelGrid>
                        </p:panel>
                    </p:tab>

                    <p:tab id="address" title="Address">
                        <p:panel header="Adress Details">

                            <h:messages errorClass="error" />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Street: " />
                                <p:inputText value="#{registrationBean.user.street}" />

                                <h:outputText value="City: " />
                                <p:inputText label="City" value="#{registrationBean.user.city}" />

                                <h:outputText value="Pincode: " />
                                <p:inputText value="#{registrationBean.user.pincode}" />

                                <h:outputText value="State: " />
                                <p:inputText label="State"
                                    value="#{registrationBean.user.state}" />

                                <h:outputText value="Country: " />
                                <p:inputText label="Country"
                                    value="#{registrationBean.user.country}" />

                                <h:outputText value="Skip to last: " />
                                <h:selectBooleanCheckbox value="#{registrationBean.skip}" />
                            </h:panelGrid>
                        </p:panel>
                    </p:tab>

                    <p:tab id="contact" title="Contact">
                        <p:panel header="Contact Information">

                            <h:messages errorClass="error" />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Email: *" />
                                <p:inputText label="Email"
                                    value="#{registrationBean.user.email}" />

                                <h:outputText value="Contact Number: " />
                                <p:inputText value="#{registrationBean.user.contactNo}" />

                            </h:panelGrid>
                        </p:panel>
                    </p:tab>
                    <p:tab id="education" title="Education">
                        <p:panel header="Education Information">

                            <h:messages errorClass="error" />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Secondary School: " />
                                <p:inputText label="Secondary School"
                                    value="#{registrationBean.user.secondarySchool}" />

                                <h:outputText value="High School: " />
                                <p:inputText label="High School"
                                    value="#{registrationBean.user.highSchool}" />
                                <h:outputText value="College: " />
                                <p:inputText label="College"
                                    value="#{registrationBean.user.college}" />
                                <h:outputText value="University: " />
                                <p:inputText label="University"
                                    value="#{registrationBean.user.university}" />
                                <h:outputText value="Degree: " />
                                <p:inputText label="Degree"
                                    value="#{registrationBean.user.degree}" />

                            </h:panelGrid>
                        </p:panel>
                    </p:tab>
                    <p:tab id="other" title="Other">
                        <p:panel header="Other Information">

                            <h:messages errorClass="error" />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Quote: *" />
                                <p:inputText value="#{registrationBean.user.quote}" />

                                <h:outputText value="About Me: " />
                                <p:inputText value="#{registrationBean.user.aboutMe}" />
                                <h:outputText value="Interest: " />
                                <p:inputText value="#{registrationBean.user.interest}" />

                            </h:panelGrid>
                        </p:panel>
                    </p:tab>
                    <p:tab id="confirm" title="Confirmation">
                        <p:panel header="Confirmation">

                            <h:panelGrid id="confirmation" columns="6">

                                <h:outputText value="Username: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.userName}" />
                                <h:outputText value="Firstname: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.firstName}" />
                                <h:outputText value="Lastname: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.lastName}" />
                                <h:outputText value="Password: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.password}" />
                                <h:outputText value="Date of Birth: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.birthDate}" />
                                <h:outputText value="Gender: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.gender}" />
                                <h:outputText value="Relationship: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.relationship}" />
                                <h:outputText value="EmailID: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.email}" />
                                <h:outputText value="Contact No.: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.contactNo}" />
                                <h:outputText value="Street: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.street}" />
                                <h:outputText value="City: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.city}" />
                                <h:outputText value="Pincode: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.pincode}" />
                                <h:outputText value="State: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.state}" />
                                <h:outputText value="Country: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.country}" />
                                <h:outputText value="Secondary School: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.secondarySchool}" />
                                <h:outputText value="High School: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.highSchool}" />
                                <h:outputText value="College: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.college}" />
                                <h:outputText value="University: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.university}" />
                                <h:outputText value="Degree: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.degree}" />
                                <h:outputText value="Quote: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.quote}" />
                                <h:outputText value="About Me: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.aboutMe}" />
                                <h:outputText value="Interest: " />
                                <h:outputText styleClass="outputLabel"
                                    value="#{registrationBean.user.interest}" />
                                <h:outputText />
                                <h:outputText />
                            </h:panelGrid>

                            <p:commandButton value="Submit" update="growl"
                                action="#{registrationBean.Save}" />

                        </p:panel>
                    </p:tab>

                </p:wizard> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:54:31.953

这

```
static {  
        userDB = new ArrayList<User>();  
        Query query = em.createQuery("SELECT u FROM User u", User.class);
        userDB =query.getResultList();

    } 
```

初始化您的用户列表。首次加载 UserConverter 类时会发生一次（何时执行类[的静态块？](https://stackoverflow.com/questions/9130461/when-is-the-static-block-of-a-class-executed)）。在生成自动完成建议时，您可以参考此列表。

当您添加新用户时，此列表永远不会重新生成。这就是您没有看到新添加的用户的原因。

一种创可贴的方法是将代码移动到类方法中，并在每次添加新用户或需要生成建议列表时调用它：

```
public class UserConverter implements Converter {

public static void regenerateUserDB {  
    Query query = em.createQuery("SELECT u FROM User u", User.class);
    userDB = query.getResultList();
}

}

public class SearchBean {

public List<User> completeUser(String query){
    List<User> suggestions = new ArrayList<User>();
    UserConverter.regenerateUserDB();
    for(User u : UserConverter.userDB){
        if(u.getUserName().startsWith(query))
            suggestions.add(u);
    }

    return suggestions;
}
} 
```

解决此问题的正确方法是使用依赖注入框架，因此您不必在使用的每个类中都构建新的 EMF - 这会浪费资源并可能导致问题。请参阅[http://en.wikipedia.org/wiki/Dependency_injection#Java](http://en.wikipedia.org/wiki/Dependency_injection#Java)。

# c# - 在 C# 中混合可选参数和 params 关键字

> ID：15114948
> 
> 赞同：4
> 
> 时间：2013-02-27T14:46:34.647
> 
> 标签：c#, params, optional

我正在尝试混合可选参数和可变长度参数（使用**params**关键字）：

这是函数声明：

```
void foo(int req, string opt = "empty", params object[] rest) {} 
```

以下是对该函数的调用：

```
foo(1);
foo(1, "something");
foo(1, "something", 2, 3);
foo(1, 2, 3); 
```

最后一次调用不会编译，因为在省略的可选参数之后提供了参数。（至少我认为这就是它不起作用的原因）

如何省略可选参数 (opt) 而仍然能够使用可变长度参数 (rest) ？

编辑：事实上，对[C# 4.0 的回答，可选参数和参数不能一起工作](https://stackoverflow.com/questions/3948971/c-sharp-4-0-optional-parameters-and-params-do-not-work-together)并不让我满意，因为在多个可选参数的情况下可能存在多种重载组合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:57:45.963

这是一种代码气味。这样的事情会更好：

```
public interface IFooSetup
{
    IReadOnlyList<object> Params{get;}
    string Opt{get;}
}

public class FooSetup : IFooSetup
{
    public IReadOnlyList<object> Params { get; set; }
    public string Opt { get; set; }

    public FooSetup()
    {
        Opt = "empty";
        Params = new List<object>();
    }
}

public void Foo(int req, IFooSetup setup)
{
} 
```

您将能够更轻松地模拟隔离您的 Foo 测试，并模拟您的设置。

不过，您应该将可选参数设为强类型，除非您绝对无法在编译时实现它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T14:53:32.893

尝试这个

```
 foo(1);
        foo(1, "something");
        foo(1, "something", 2, 3);
        foo(1, rest: new object[]{2,3 }); 
```

# java - 如何提高我的 A* 路径查找器的性能？

> ID：15114950
> 
> 赞同：3
> 
> 时间：2013-02-27T14:46:40.677
> 
> 标签：java, artificial-intelligence, a-star

所以基本上我编写了一个 A* 探路者，它可以找到穿过障碍物的路径并进行诊断。我基本上将[http://www.policyalmanac.org/games/aStarTutorial.htm](http://www.policyalmanac.org/games/aStarTutorial.htm)中的伪代码实现为真实代码，并使用二进制堆方法从 openlist 添加和删除项目。

使用二叉堆可以显着提升性能，比我之前使用的插入排序算法快大约 500 倍。

问题是它仍然平均需要大约 150 万纳秒，大约是 0.0015 秒。

所以问题是，我的计划是制作一个塔防游戏，每次我在地图上添加一个塔时，每个暴徒的寻路都需要更新。如果我在地图上最多有大约 50 个小怪，这意味着更新整个小怪的所有路径大约需要 0.0015 * 50 = 0.075 秒。游戏基本上每 1/60 秒（即 0.016 秒）打勾（所有游戏内容更新），所以问题是更新路径的时间比打勾的时间长，这将导致巨大的延迟。那么我该怎么做呢？我是否需要找到一种更好的算法来对 openlist 进行排序，或者以某种方式划分寻路任务，以便每个刻度仅执行 X 个寻路任务，而不是所有任务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T19:05:00.023

与其从每个敌人搜索到检查站，不如从检查站向外搜索到每个敌人。这样，您只需进行一次搜索，而不是进行 50 次搜索。

更具体地说，只需从玩家向外进行广度优先搜索*（或[djikstra's](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)，如果您的图表是加权的）*，直到到达每个敌人。

`EstimatedDistanceToEnd` *您可以通过将启发式（aka `h(x)`）*更改为对任何敌人的最小估计来更改此策略以使用 A* ，但是对于很多敌人，这最终可能会比更简单的选项慢。启发式必须是[一致](http://en.wikipedia.org/wiki/Consistent_heuristic)的才能起作用。

* * *

此外，请确保您使用了[正确的平局标准](https://stackoverflow.com/questions/15623630/)。

此外，最重要的是，请记住，对于大多数游戏，**您不需要在每一帧都运行探路者**- 通常您每秒只能运行一次或两次，甚至更少，具体取决于游戏。

如果这*仍然*太慢，您可以考虑使用[D* lite](http://idm-lab.org/bib/abstracts/papers/aaai02b.pdf)在后续搜索之间重用信息。但是，我敢打赌，运行单一的广度优先搜索将绰绰有余。

*（复制自我对 gamedev 上[类似问题的回答）](https://gamedev.stackexchange.com/questions/43860)*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T14:54:46.953

您是否考虑过 Floyd-Warshall 算法？

本质上，A* 用于从单个源到一个或多个目的地的路径查找。然而，在塔防中（当然取决于你的规则），它是关于在地图上导航的多个来源。

因此，对于这一点，弗洛伊德的算法似乎更优化。但是，您可以让您的 A* 算法找到单元**组**而不是单个单元的路径，这样可以优化您的计算时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:06:41.137

据推测，您可以从出口向后搜索所有小兵，因此您只需要探索一次迷宫。

# iis - iis7 ftp 用户隔离让 2 个用户具有相同的主目录

> ID：15114953
> 
> 赞同：1
> 
> 时间：2013-02-27T14:46:45.617
> 
> 标签：iis, iis-7, ftp, windows-server-2008

我已成功设置 IIS7 ftp 用户隔离，但有人问我如何设置 2 个不同的用户拥有相同的“主文件夹”？

只要我们需要在 LocalUser 文件夹中使用确切的用户名设置每个文件夹，我不知道如何继续。

在我们拥有的 5 种类型中，我使用的是“用户名目录选项”。

是否可以设置这样的配置？

谢谢

# zend-framework2 - ZF2 和 Zend Studio 10 是否需要 Vendor/Library 文件夹？

> ID：15114956
> 
> 赞同：1
> 
> 时间：2013-02-27T14:46:48.440
> 
> 标签：zend-framework2, zend-studio

在我们为 ZF2 项目设置的 Zend Studio 10 中，我们将 Zend Framework 2 作为 PHP 包含路径的一部分包含在内。但是随后该项目也被设置，`vendor/zendframework/zendframework/library/Zend/`其中包含包含路径中的库的副本。

每次自动完成出现时，都会有两个。事实上，当我从文件夹中删除 Zend 库时，一切都会继续工作。

请记住，这是使用项目向导创建新项目时的默认设置。

有什么理由保留`vendor/zendframework/zendframework/library/Zend/`文件夹吗？

**更新：** 看起来 PHP 单元配置直接查找库文件夹而不是包含路径条目。

从`TestConfiguration.php.dist`

`define('ZF2_PATH', realpath(__DIR__ . '/../../../vendor/zendframework/zendframework/library/'));`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:16:45.310

如果通过[Composer进行](http://getcomposer.org/)[自动加载](http://php.net/manual/de/language.oop5.autoload.php)，则认为 Composer 实际上会为每个项目下载所有依赖项的一份副本。

这已经被反复讨论过，但基本上，其原因是每个项目都被“锁定”到具有特定版本的一组特定依赖项（依赖项名称 + 版本 = 包）。

在 zf2 项目中，您不应再拥有共享库。

如果您的自动加载是通过 composer 进行的，那么您必须将该目录保存`vendor/`在[`init_autoloader.php`](https://github.com/zendframework/ZendSkeletonApplication/blob/zf/release-2.1.0/init_autoloader.php).

请考虑从 Zend Studio 中删除共享库。

此外，默认情况下，ZF2 不会在 中查找依赖项`include_path`，因为这样做会在 stat 调用中损失很多性能。

# jquery - 异步提交 2 个表单

> ID：15114959
> 
> 赞同：0
> 
> 时间：2013-02-27T14:46:58.510
> 
> 标签：jquery, ajax, forms, asynchronous

我正在尝试一键提交 2 个表单。甚至看起来两个表单都已提交，但对第二个表单的调用（来自第一个表单帖子的回调）没有实际结果。这是javascript：注意第一个函数在招聘模块中

```
this.submit_form = function()
{
  if( check_field_input())
    {                   
    var fname = $('#rec_first_name').val();
    var lname = $('#rec_last_name').val();
    var usr_email = $('#rec_email').val();
    var id = $('input[name="params_id"]').val();
    var x_id = $('input[name="XID"]').val();
    var url = $('#recruitment').attr('action');
    var mainformUrl = $('#recruitmentform').attr('action');

    var poster = $.post( url, {params_id: id, XID: x_id, firstname: fname, lastname: lname,  email: usr_email},
      function(response){
        if (response.success == true) {
            $.post( mainformUrl, $('form#recruitmentform').serialize());
            return true;
            //$('form#recruitmentform').submit();
            } else {
              alert("Error: " + response.errors[0]);
            }
        });
    }
} 

$(document).ready(function () { 
        var rec_mod = new recruitment_module();
        $('#submit_btn').click( function() { return rec_mod.submit_form(); });
    }); 
```

在调试脚本时，我可以看到它确实可以调用使用序列化函数发布第二个表单，但页面没有发布。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:56:01.683

如果没有我们可以检查和修改的可运行代码，我们就无法真正调试它。以下是调试此类内容的步骤：

1.  确保`mainformUrl`与您的页面在同一个域中，这样您就不会被同源安全限制所阻止。
2.  检查错误控制台或调试控制台是否有任何错误。
3.  将一个成功处理程序和一个错误处理程序添加到您的 ajax 调用中，看看哪个被调用以及它说什么。

# c# - 在 C# winforms 中，为什么 UI 标签没有更新并跟上 backgroundworker progresschanged 事件？

> ID：15114961
> 
> 赞同：0
> 
> 时间：2013-02-27T14:47:00.717
> 
> 标签：c#, winforms, backgroundworker

我正在更新 backgroundworker progressChanged 事件上的标签文本（字面意思是此事件回调中的 1 行代码）。

它在大约 45 秒内更新了大约 50 次，问题是 UI 似乎只更新了大约 10 次。因此，UI 似乎没有“跟上”事件的数量。

无论如何，有没有帮助改善这一点。我看到人们建议 APplication.DoEvents() 但一直认为这有点狡猾。

```
void worker_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
      lblProgress.Text = "Updating Progress: " +  e.ProgressPercentage;
} 
```

这里有推荐的做法，所以我可以看到 UI 上的每一个更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:53:20.580

尝试调用：

```
this.lblProgress.Refresh(); 
```

设置文本属性后

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:53:02.127

我以前只发生过一次，当时我发现最好的方法就是调用更新：

```
void worker_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
      lblProgress.Text = "Updating Progress: " +  e.ProgressPercentage;
      lblProgress.Update();
} 
```

根据标签文本的重要性，您可以调用`Refresh()`更直接的重绘。

# javascript - 使用 Google 地图标记更改信息窗口中的数据

> ID：15114963
> 
> 赞同：8
> 
> 时间：2013-02-27T14:47:02.633
> 
> 标签：javascript, google-maps, google-maps-api-3

我已按照[本教程](https://developers.google.com/maps/articles/phpsqlajax_v3)创建自定义 Google 地图。我已经包含了一些其他元素，例如将其链接到 Wordpress 和对标记进行聚类。

除了每个标记的信息窗口中的信息之外，这一切都很好。我似乎无法更改每个信息中的信息。我认为通过更改以下几行会改变它，但没有任何影响：

```
var html = "<b>" + name + "</b> <br/>" + address; 
```

[这是工作地图](http://www.teamworksdesign.com/clients/poh/)

我在哪里可以将自己的自定义数据放入窗口中？另外，如果我可以在上面设置窗口样式会更好。

* * *

看来clusterer是问题，主要是这个部分，我怎样才能把html内容放到信息窗口中？

```
function load() {
  var cluster = [];
  var map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(52.375599, -3.471680),
    zoom: 8,
    mapTypeId: 'roadmap'
  });
  var infowindow = new google.maps.InfoWindow();
  var min = .999999;
  var max = 1.000002;

  // Change this depending on the name of your PHP file
  downloadUrl("<?php bloginfo('stylesheet_directory'); ?>/phpsqlajax_genxml.php ", function(data) {
    var xml = data.responseXML;
    var markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
      var name = markers[i].getAttribute("name");
      var address = markers[i].getAttribute("address");
      var type = markers[i].getAttribute("type");

      var offsetLat = markers[i].getAttribute("lat") * (Math.random() * (max - min) + min);
      var offsetLng = markers[i].getAttribute("lng") * (Math.random() * (max - min) + min);

      var point = new google.maps.LatLng(offsetLat, offsetLng);
      var html = "<b>" + name + "</b> <br/>" + address;
      var icon = customIcons[type] || {};
      var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: icon.icon,
        shadow: icon.shadow
      });
      google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                        // infowindow.setContent(markers[i].getAttribute("name"));
                        // infowindow.open(map, marker, html);
                        infowindow.setContent(html); infowindow.open(map, marker);
                    }
                })(marker, i));
      cluster.push(marker);
    }
    var mc = new MarkerClusterer(map,cluster);
  });
} 
```

具体来说，它不是将html内容通过clusterer...至少这实际上是在更改窗口中的数据，只需要在不破坏clusterer的情况下输出html内容：

```
 google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                        infowindow.setContent(markers[i].getAttribute("name"));
                        infowindow.open(map, marker, html);
                    }
                })(marker, i));
      cluster.push(marker); 
```

* * *

到目前为止，我拥有的最接近的是这个，但它为每个标记显示了相同的信息。它显示了html内容：

```
 google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                        // infowindow.setContent(markers[i].getAttribute("name"));
                        // infowindow.open(map, marker, html);
                        infowindow.setContent(html); infowindow.open(map, marker);
                    }
                })(marker, i));
      cluster.push(marker); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T16:30:25.507

不敢相信我没有早点想到这个！！

这只是在侦听器中构建字符串的一种情况。

```
 // Change this depending on the name of your PHP file
  downloadUrl("<?php bloginfo('stylesheet_directory'); ?>/phpsqlajax_genxml.php ", function(data) {
    var xml = data.responseXML;
    var markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
      var type = markers[i].getAttribute("type");

      var offsetLat = markers[i].getAttribute("lat") * (Math.random() * (max - min) + min);
      var offsetLng = markers[i].getAttribute("lng") * (Math.random() * (max - min) + min);

      var point = new google.maps.LatLng(offsetLat, offsetLng);
      var icon = customIcons[type] || {};
      var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: icon.icon,
        shadow: icon.shadow
      });
      google.maps.event.addListener(marker, 'click', (function(marker, i) {
                    return function() {
                        var name = markers[i].getAttribute("name");
                        var address = markers[i].getAttribute("address");
                        var html = "<b>" + name + "</b> <br/>" + address;
                        infowindow.setContent(html);
                        infowindow.open(map, marker, html);
                        // infowindow.setContent(html);
                        // infowindow.open(map, marker);
                    }
                })(marker, i));
      cluster.push(marker);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T07:49:34.563

如果我没看错的话。您正在尝试在设置标记之后设置内容。

这应该是相反的。在将其推送到集群之前，移动您将 html 设置到的位置。

* * *

编辑：

```
for (var i = 0; i < markers.length; i++) {
  var name = markers[i].getAttribute("name");
  var address = markers[i].getAttribute("address");
  var type = markers[i].getAttribute("type");

  var offsetLat = markers[i].getAttribute("lat") * (Math.random() * (max - min) + min);
  var offsetLng = markers[i].getAttribute("lng") * (Math.random() * (max - min) + min);

  var point = new google.maps.LatLng(offsetLat, offsetLng);
  //var html = "<b>" + name + "</b> <br/>" + address;
  var infowindow = new google.maps.InfoWindow({content: "<b>" + name + "</b> <br/>" + address});

  var icon = customIcons[type] || {};
  var marker = new google.maps.Marker({
    map: map,
    position: point,
    icon: icon.icon,
    shadow: icon.shadow
  });
  //google.maps.event.addListener(marker, 'click', (function(marker, i) {
  //              return function() {
  //                  infowindow.setContent(markers[i].getAttribute("name"));
  //                  infowindow.open(map, marker, html);
  //              }
  //          })(marker, i));
  google.maps.event.addListener(marker, 'click',  function(marker, i){infowindow.open(map,marker);})(marker, i);

  cluster.push(marker);
} 
```

不确定 (marker, i) 件。我假设标记管理器使用它们来跟踪是什么。这两个更改（我注释掉了您的行并在下面添加了一个）似乎是下一个合乎逻辑的步骤。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-16T08:44:58.393

我有一个类似的问题，我想通了，要更改标记信息窗口中的内容

```
 var marker = new MarkerWithLabel({
        id: "costume_ID",/*<---this is the start of the trick*/
        position: new google.maps.LatLng(lat,lon),
        icon: "../images/icon-bla.png",
        map: map,
        title: 'bla',
        labelContent: 'bla,bla,
        labelClass: "labels", 
        labelStyle: {opacity: 1.0}
    })
    google.maps.event.addListener(marker, 'click', (function() {
        return function(){
        infowindow.setContent(infor(this.id));/*<--- here is the trick*/
        infowindow.open(map, this);
        map.setCenter(this.getPosition());
    }}); 
```

如果您在变量中有信息，则设置将输出您想要的任何内容的函数。

```
 function infor(im){
        return "<div><b>INFOWINDOW</b><br>Date: "+var[im].date+"<br>Sync:  "+var[im].sync+"...bla,bla,bla</div>";
    }/*THIS FUNCTION RETURN THE STING TO SHOW ION THE INFOWINDOW*/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-19T02:49:01.610

问题在于你的关闭。`for`循环没有正确处理您的范围。将循环内部的所有代码提取`for`到一个单独的函数中，闭包应该可以工作。

# php - 变量未从 Javascript 传递

> ID：15114964
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:02.787
> 
> 标签：php, jquery, mysql, autocomplete

我有两个不是我写的儿童签入系统的搜索框。我已将输入框升级为 jquery 自动完成功能。他们工作，我按名称搜索，然后输入身份证号码。

但是，当我单击“验证”时，应该会显示每个人的照片，成人没有任何反应。成人字段是可选的，它是第二个字段。我认为这是我的问题。

更新：如果我注释掉第一个自动完成框“孩子”并且十个让成年人独自一人，它就可以工作。我一直在跳过实际的自动完成部分，只是在框中输入一个数字，我有同样的错误。

```
<form method="post" action="Checkin.php" name="Checkin">
<input type="hidden" name="EventID" value="<?php echo $iEventID ; ?>">
    <table cellpadding="0" cellspacing="0" width="100%" align="center" border="1">
    <tr>
    <td>
        <caption>
            <h3><?php echo gettext("Add Attendees for Event: $event_title"); ?></h3>
        </caption>
    </td>
    </tr>
    <tr>
    <!-- Right Side new searchbox here-->
        <td width="33%" valign="top" align="right">

        <head> 

        <script type="text/javascript" src="jquery/js/jquery-1.4.2.min.js"></script> 
        <script type="text/javascript" src="jquery/js/jquery-ui-1.8.2.custom.min.js"></script> 
        <script type="text/javascript"> 

                    jQuery(document).ready(function(){
                        $('#child').autocomplete({source:'suggestname.php', minLength:2});
                        $.noConflict()
                    });

        </script> 
        <link rel="stylesheet" href="jquery/css/smoothness/jquery-ui-1.8.2.custom.css" /> 
        <style type="text/css"><!--

                        /* style the auto-complete response */
                        li.ui-menu-item { font-size:12px !important; }

        --></style> 
            </head>

        <form onsubmit="return false;"> 
        Enter a name:
        <input id="child" type="text" name="child" /> 
        </form> 

        </td>
    <!-- Middle -->
      <td width="33%" valign="top" align="center">
            <input type="submit" class="icButton" <?php echo 'value="' . gettext("Verify") . '"'; ?> Name="Verify" onclick="javascript:document.location='Checkin.php';">
            <input type="submit" class="icButton" <?php echo 'value="' . gettext("Back to Menu") . '"'; ?> name="Exit" onClick="javascript:document.location='Checkin.php';">
            <input type="button" class="icButton" <?php echo 'value="' . gettext("Add Visitor") . '"'; ?> name="Add" onClick="javascript:document.location='PersonEditor.php';"></td>
    <!-- Left Side -->
        <td width="33%" valign="top" align="left">

            <head> 

            <script type="text/javascript" src="jquery/js/jquery-1.4.2.min.js"></script> 
            <script type="text/javascript" src="jquery/js/jquery-ui-1.8.2.custom.min.js"></script> 
            <script type="text/javascript"> 

                jQuery(document).ready(function(){
                    $('#adult').autocomplete({source:'suggestname2.php', minLength:2});
                    $.noConflict()
                });

            </script> 
            <link rel="stylesheet" href="jquery/css/smoothness/jquery-ui-1.8.2.custom.css" /> 
            <style type="text/css"><!--

            /* style the auto-complete response */
            li.ui-menu-item { font-size:12px !important; }

                --></style> 
            </head> 

            <body> 

            <form onsubmit="return false;"> 
                Enter a name:
                <input id="adult" type="text" name="adult" /> 
            </form> 

            </body>

        </td>
    </tr>
    <tr>
        <td width="33%" align="right">
        Child's Name
        </td>
        <td width="33%" valign="top" align="center">
        </td>
        <td width="33%" valign="top" align="left">
        Adult's Name
        </td>
    </tr>
    </table>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:53:59.893

您提供的 html 都搞砸了 - 正文不应该在头顶！检查[此](http://www.scriptingmaster.com/html/basic-structure-HTML-document.asp)或[此](http://www.basewebmaster.com/html/html5-page-structure.php)以了解基础知识。

![在此处输入图像描述](../Images/cd50c5027516999bef0734996a583b71.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:54:09.347

您应该从一个有效的 html 页面开始。

一些例子：

*   您`<head>`在不允许使用的地方到处都有元素；
*   您有`<body>`不允许使用的元素；
*   您有嵌套的表单标签（也不允许）。

# google-email-settings-api - 是否可以通过 Google Apps 电子邮件设置 API 为每个批准的“发送邮件”设置签名？

> ID：15114966
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:08.057
> 
> 标签：google-email-settings-api

我有一个 Google Apps 帐户和另外两个已批准的“发送邮件”帐户。在 Gmail 设置（网络界面）中，我可以为三个电子邮件地址中的每一个设置一个签名。

是否可以通过 Googe Apps 电子邮件设置 API 执行相同的操作，以便我可以为整个组织自动执行此操作？

API 文档 ( [https://developers.google.com/google-apps/email-settings/#manage_signature_settings](https://developers.google.com/google-apps/email-settings/#manage_signature_settings) ) 仅提及如何定义用户名，但没有提供指定该用户名的实际电子邮件地址以设置签名的选项为了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T04:59:51.460

目前不可能，不。电子邮件设置 API 仅支持设置主电子邮件地址的签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:49:56.217

我认为有一些 3rd-party 应用程序可以做到这一点，但是 - 这是一个很大的应用程序 - 这取决于您发送邮件的程序。

如果您使用的是 Outlook，则可以使用 Exclaimer 签名管理器。该软件的重点是控制每个用户的电子邮件签名。您可以给他们多个签名以供选择，从而根据他们的“发送自”设置决定他们需要哪一个。

还有其他应用程序，但我认为它们中的任何一个都不会这样做。

如果您在浏览器中发送电子邮件，那么您就不走运了。我不知道 Exclaimer 是否拥有或正在开发 Google Apps 专用产品，这可能值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-10T20:32:24.623

较新的[Gmail API](https://developers.google.com/gmail/api/)允许设置每个地址的签名。请参阅[“别名和签名”指南](https://developers.google.com/gmail/api/guides/alias_and_signature_settings)。只有被委派了域范围权限的服务帐户才能更新非主地址的签名。

# backbone.js - 击退：从可观察集合中删除项目

> ID：15114970
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:13.697
> 
> 标签：backbone.js, knockback.js

给定 Knockback 中的可观察集合，我如何从基础集合中删除一个项目以响应 knockout.js 点击事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T12:46:07.040

如果我是对的，a 会说您想通过单击按钮从集合中删除某些项目。

所以我们有 kb 视图：

```
 var viewModel = kb.ViewModel.extend({
    constructor: function(model, options) {
      var self = this 
      this.delete= function(){

          self.coll.delete(self) 
      }
      this.coll = options.coll
      this.name = kb.Observable(model, {key: 'name'})

    }
});

var yourCollection = new Backbone.Collection(); 
var yourModel = new  Backbone.Model({name: 'Stefan'}); 
var yourKBView = new viewModel (yourModel, {coll: yourCollection}); 
```

这是存储一些嵌套信息的简单方法。

当您在集合中添加模型时自动执行此操作时，您可以像这样覆盖视图的创建功能。

```
 var collectionViewModel = kb.ViewModel.extend({
        constructor: function(collection, options) {
             var self = this
             this.coll= kb.collectionObservable(collection, {
              /**
               * Calls by adding a model to the collcetion
               * @param model - 
               * @param options -
               *
               */
            create: function(model, options){
              var options =  options || {}
              options.coll = self       
              return new viewModel(model,options)
            }
        });
  }
}); 
```

# wso2 - SOAP Envelope 不能有除 SOAP Header 和 Body 之外的子级

> ID：15114971
> 
> 赞同：2
> 
> 时间：2013-02-27T14:47:16.050
> 
> 标签：wso2, wso2esb

随着更新到版本 4.6.0 wso2esb，错误开始出现：

org.apache.axiom.soap.SOAPProcessingException：SOAP Envelope 不能有除 SOAP Header 和 Body 之外的子级

使用安全服务时。

如何解决错误？

# flash - 加载外部 SWF 会导致沙盒冲突

> ID：15114974
> 
> 赞同：2
> 
> 时间：2013-02-27T14:47:20.010
> 
> 标签：flash, debugging, actionscript, cross-domain, actionscript-2

我正在尝试加载外部 SWF 以便调试它。我不控制 SWF 源，但我控制它所在的域。

这是我的代码：

```
import flash.system.Security;
Security.allowDomain("*");

var swf = ["http://rcnhca.org.uk/wp-content/plugins/assessment-quiz/quiz.swf", "quiz_content/data.swf"]

var loadListener:Object = new Object();
loadListener.onLoadComplete = function(target_mc:MovieClip, httpStatus:Number):Void {
    trace(">> loadListener.onLoadComplete()");
    trace(">> httpStatus: " + httpStatus);
}

var mcLoader:MovieClipLoader = new MovieClipLoader();
mcLoader.addListener(loadListener);

var mc:MovieClip = this.createEmptyMovieClip("mc", this.getNextHighestDepth());
mcLoader.loadClip(swf[0], mc); 
```

但是，这会返回以下许多错误：

```
SecurityDomain 'http://rcnhca.org.uk/wp-content/plugins/assessment-quiz/quiz.swf' tried to access incompatible context 'file:///G|/Lifelong%20Learning/Active%20work/Sites/rcnhca/wp%2Dcontent/plugins/assessment%2Dquiz/as2debug.swf' 
```

我已经在我的域的根目录中设置了一个 crossdomain.xml 文件，如下所示：

```
<?xml version="1.0" ?>
<cross-domain-policy>
  <allow-access-from domain="*"/>
  <allow-http-request-headers-from domain="*" headers="*"/>
</cross-domain-policy> 
```

（在这里看到：[http](http://rcnhca.org.uk/crossdomain.xml) ://rcnhca.org.uk/crossdomain.xml ）

奇怪的是，SWF 加载但是当我尝试 Debug -> List variables 或在调试窗格中打开它时，它会使整个程序崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T12:02:17.843

您似乎缺少实际加载策略文件的代码（仅仅存在还不够）：

```
Security.loadPolicyFile('your_domain/crossdomain.xml'); 
```

`allowDomain('*');`（对于您从中加载的任何其他域，一旦一切正常，我也会修改您的调用以更具体，但现在还可以。）

确保你在申请开始时就这样做了——这些年来我一直为此头疼不已，希望它对你来说会更整洁！

希望这可以帮助。

# c++ - C++ 中的奇怪语法

> ID：15114977
> 
> 赞同：2
> 
> 时间：2013-02-27T14:47:22.057
> 
> 标签：c++, qt, syntax

最近我一直面临着一种非常奇怪的方式来编写原型：

```
void myProto( QList<::myObject::myStruct> myStructList ); 
```

我想知道“<::”和“>”是什么意思？

谢谢 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T14:50:11.210

`QList`是一个模板，并且`QList<Type>`是该模板的特化，具有实际的 type `::myObject::myStruct`。

是`::`范围解析运算符，它告诉编译器`myStruct`在范围内查找`myObject`，它本身就在全局范围内。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T14:49:51.823

```
::myObject::myStruct 
```

表示在位于全局范围内`myStruct`的类（或命名空间）中定义。`myObject`

```
<> 
```

*类型*放在这些括号内，它表示该类型的模板的特*化*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:58:08.223

编译以下程序

```
struct A // GLOBAL A
{
    void f()
    { }
};

namespace nm
{
    struct A // nm::A
    { };

    template <class T>
    struct B
    {
        T a;

    };

    void f1(B<A> b) // WILL NOT COMPILE
    {
        b.a.f();
    }

    void f2(B< ::A> b)  // WILL COMPILE
    {
        b.a.f();
    }
}

int main()
{

} 
```

`nm::f1`不会编译

`nm::f2`将编译

这是因为`::A`（全局 A）有`f`成员 `nm::A`但没有`f`成员。

# javascript - 如何使用 Google Maps API 跟踪对多边形的事件更改

> ID：15114980
> 
> 赞同：11
> 
> 时间：2013-02-27T14:47:25.590
> 
> 标签：javascript, google-maps, google-maps-api-3, polygon

我目前正在为我们正在开发的网站构建“搜索区域”功能。有点像[Rightmove](http://www.rightmove.co.uk/draw-a-search.html)上的那个。

除了跟踪对多边形的事件更改（新点的设置和更改现有点）的能力之外，我已经启动并运行了所有东西。我需要能够将坐标发布到表单以进行提交。

我已经尝试使用 Google Code docs 来[编辑事件](https://developers.google.com/maps/documentation/javascript/overlays#user_editable_shapes_events)。每次我尝试它时，我都会收到一条关于“set_at”不可能或我的对象没有被定义的消息。

我想我知道是错误的一点是`thePolygon`变量没有被传递给新的

```
google.maps.event.addListener(thePolygon, 'set_at', function() {
      // grab paths for infoWindow 
      grabPaths(thePath);
    }); 
```

但我不知道为什么。这是一个全局变量。或者不是？

**所以，问题是，如何跟踪多边形的变化以将更新的坐标传递给我的表单？**

非常感谢所有帮助。

这是我目前拥有的代码：

```
var mapOptions = {
  // options
};

var map = new google.maps.Map(document.getElementById('map'), mapOptions);

var drawingManager = new google.maps.drawing.DrawingManager({
  drawingMode: google.maps.drawing.OverlayType.POLYGON,
  drawingControl: false,
  polygonOptions: {
    // drawing options
  }
});

drawingManager.setMap(map);

google.maps.event.addListener(drawingManager, 'polygoncomplete', function(polygon) {
  // complete functions
});

google.maps.event.addListener(thePolygon, 'set_at', function() {
  // complete functions
});

google.maps.event.addListener(thePolygon, 'insert_at', function() {
  // complete functions
}); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-28T21:26:26.200

这些事件是为 MVCArray 定义的，折线不是 MVCArray。您必须`path`改为观察折线（这是一个 MVCArray）的事件。此外，您不能向尚未创建的对象添加侦听器。多边形之前不可用`polygoncomplete`，因此您必须在多边形完成回调中添加侦听器：

```
google.maps.event.addListener(drawingManager,'polygoncomplete',function(polygon) {

  // complete functions

  google.maps.event.addListener(thePath, 'set_at', function() {
    // complete functions
  });

  google.maps.event.addListener(thePath, 'insert_at', function() {
    // complete functions
  });

}); 
```

# javascript - 使用 jquery 删除数组

> ID：15114983
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:30.200
> 
> 标签：javascript, html, css

我创建了嵌套数组，然后将其附加到 div。当我单击 ID 为“名称”的按钮时，带有标题的电影存储在数组 $titelBetyg 中，该数组稍后存储在另一个数组 $films 中。每当我创建一个新的 $titelBetyg 时，我想从我的 div 中删除以前的 $films，然后用新的替换它。我该怎么做呢？

Javascript

```
$(document).ready(function(){

var $films = [];

$('#name').keyup(function(){
            $('#name').css('background-color', 'white');
});

$('#options').change(function(){
            $('#options').css('background-color', 'white');
});

$("#button").click(function(){
    var $titelBetyg = [];

    var $titel = $('#name').val();
    var $betyg = $('#options').val();

    if($titel == ""){
        $('#name').css('background-color', 'red');
        alert("Fail");
    }
    else if($betyg == "0"){
        $('#options').css('background-color', 'red');
        alert("Fail");
    }
    else{

        $titelBetyg.push($titel);
        $titelBetyg.push($betyg);
        $films.push($titelBetyg);

        // here is where i need to remove it before appending the new one

        $('#rightbar').append("<ul>");
        for(i=0; i<$films.length; i++){
            $('#rightbar').append("<li>" + $films[i][0] + " " + $films[i][1] + "</li>" + "<br>");
        }
        $('#rightbar').append("</ul>");
    }
});

$('#stigande').click(function(a,b){

});
$('#fallande').click(function(){

});

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:52:32.593

像这样使用[`.empty()`](http://api.jquery.com/empty/)（并附加到`<ul>`而不是其他东西）：

```
var $ul = $("<ul>");
for (var i=0; i<$films.length; i++) {
    $ul.append("<li>" + $films[i][0] + " " + $films[i][1] + "</li><br>");
}
$('#rightbar').empty().append($ul); 
```

顺便说一句，只附加新的而不是清空和重建整个东西可能更容易：

```
$('#rightbar ul').append("<li>" + $titel + " " + $betyg + "</li><br>"); 
```

* * *

要从 中仅删除列表内容（而不是其他内容）`#rightbar`，您可以使用以下命令：

```
var $ul = $('#rightbar ul').empty();
if (!$ul.length) // if nonexistent…
    $ul = $("<ul>").appendTo('#rightbar'); // create new one

for (var i=0; i<$films.length; i++)
    $ul.append("<li>" + $films[i][0] + " " + $films[i][1] + "</li>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:51:34.367

您只需要删除容器的内容。所以，使用[`.empty()`](http://api.jquery.com/empty/)函数

```
$('#rightbar').empty().append("<ul>"); //It will empty the content and then append
for(i=0; i<$films.length; i++){
    $('#rightbar').append("<li>" + $films[i][0] + " " + $films[i][1] + "</li>" + "<br>");
}
$('#rightbar').append("</ul>"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T14:49:20.707

```
document.getElementById('rightbar').innerHTML = ''; 
```

这样右栏完全是空的。

# javascript - jQuery防止响应前多次提交

> ID：15114988
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:36.363
> 
> 标签：javascript, ajax, jquery

我会在 JS fiddle 中执行此操作，但我无法让 POST 回显器工作，所以我将在这里做一个示例。让我们假设`someApi`返回“bar”

JS/jQuery

```
$(function() {
    $('button').click(function(event) {
        getSomeData();
    });
    function getSomeData() {
        $("div").text("Foo = ");
        $.get("someApi", function(i) {
            $("div").append(i);
        });
    };
}); 
```

HTML

```
<div></div>
<button>Click Me</button> 
```

这里可能有一些错别字，但请忽略它们，因为我已经写了一个即时示例。发生的情况`<button>`是单击一次，一切正常。调用 AJAX 函数并`<div>`在响应到来时附加 。如果我等待响应并再次单击，`<div>`则会被覆盖`Foo =`然后附加。当用户变得不耐烦并`<button>`多次单击并产生多个 AJAX 请求时，就会出现问题。这最终会导致多次附加“bar”。JS / jQuery 中是否有避免向同一个 URL 发送多个请求的功能？我不是说我想要一个`async = false`设想; 我知道这会起作用，但也会减慢应用程序的速度。我也知道我可以添加一个 if 循环来检查 bar 是否已被附加。我要的是一种适当的 JS / jQuery`.blockMultipleRequest();`类型的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:56:58.220

我不认为有一个插件。你可以这样使用`.one()`：

```
function bindButton() {
    $('button').one('click', function(event) {
        getSomeData();
    });
}

function getSomeData()
    $("div").text("Foo = ");
    $.get("someApi", function(i) {
        $("div").append(i);
        bindButton();
    });
}

$(function() {
    bindButton();
}); 
```

在函数`bindButton()`中，您使用 定义您的事件处理程序`one()`。一旦按钮被单击，事件就会被删除，直到 AJAX 调用响应，然后再次调用函数`bindButton()`并再次绑定事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T09:11:21.060

您可以使用 jQuery 提供的全局 AJAX 事件处理程序，然后根据请求执行操作。

*   [`.ajaxSend()`](http://api.jquery.com/ajaxSend/)当任何请求开始时（`event`、`jqXHR`和`settings`属性被发送到处理程序，因此您可以通过评估来执行特定于 URL 的操作`settings.url`
*   [`.ajaxComplete()`](http://api.jquery.com/ajaxComplete/)当任何请求完成时。

然后，您可以使用跟踪每个 URL 的 AJAX 调用的对象，该对象可以在发送另一个请求之前进行咨询（例如，仅当它当前不处于活动/挂起状态时）。

# ios - 为什么我不能从父 CCLayer 重置我的 CCParticleSystemQuad？

> ID：15114989
> 
> 赞同：0
> 
> 时间：2013-02-27T14:47:39.847
> 
> 标签：ios, cocos2d-iphone

我在我的“GameScene”中添加了一个额外的 CCLayer，`[self addChild:_congratsScreen]`只要我的角色在屏幕上收集给定数量的对象，它就会变得可见 ()。

在我的 GameScene.h 中，我声明了我的子层 ( `CClayer *congratsScreen`)，并在我的 GameScene.m 上合成它。我在 GameScene 的`init`方法中分配子 CCLayer，因此它在此实例变量中持有对子层的引用。

在我的 GameScene 上，我有几个`CCParticleSystemQuad`实例，调用它们`stopSystem`并`resetSystem`重放我的粒子动画非常简单，但是如果我尝试`CCParticleSystemQuad`在子层上初始化的那个上做同样的事情，`resetSystem`那么在我删除后它就不起作用我的 GameScene 中的孩子并将其重新添加回来。CCLayer 的组件从父层的场景中移除后会发生什么情况吗？

我目前没有代码，所以我将尝试编写一些伪代码来说明它是如何完成的：

它是如何在 ChildLayer.m 上初始化的：

```
_sparkling= [CCParticleSystemQuad particleWithFile:@"sparkling.plist"]; 
```

然后，在 GameScene.m 的某个地方，我有：

```
- (void) showCongrats {
  //pathetic way to create a modal panel
  [self setTouchable = NO];

  [[[self _congratsLayer] _sparkling] resetSystem];
  [self addChild:_congratsLayer];
}
- (void) hideCongrats {
  //let them continue playing
  [self setTouchable = YES];

  [[[self _congratsLayer] _sparkling] stopSystem];
  [self removeChild:_congratsLayer];
} 
```

所以，它在我第一次调用时工作`showCongrats`，参考很好，我可以操纵粒子，但是一旦我隐藏图层，继续玩游戏并再次显示祝贺面板，它会显示粒子的冻结动画最后一次调用，`resetSystem`不再有效。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T06:23:08.033

我会在代码中添加一些断点并遍历它，但如果我不得不猜测，我会说当你调用 removeChild 时，你会丢失 init 方法中的数据，并且正在发生一些奇怪的事情。

# silverlight - 如何使用 ScrollViewer.ScrollToVerticalOffset？

> ID：15114991
> 
> 赞同：6
> 
> 时间：2013-02-27T14:47:41.873
> 
> 标签：silverlight, windows-phone-8, windows-phone, scrollviewer

我希望这不是重复的，但我找不到任何关于如何实际*使用* `ScrollToVerticalOffset()`. 我在 Windows Phone 8 应用程序中使用它，但我认为它仍然适用于 WP7 和 Silverlight（不过，如果我错了，请随时纠正我）。

所以这是我的基本设置（内存中的伪代码）：

```
<phone.PivotItem>
   <ScrollViewer>
      <Grid Height="1500">
         <Grid.RowDefinitions>
            <!-- about 20 rows, all auto-height -->
         </Grid.RowDefinitions>

         <Border Grid.Row="0">
            <TextBox x:Name="txt1" />
         </Border>
         <Border Grid.Row="1">
            <TextBox x:Name="txt2" />
         </Border>

         <!-- ...... -->

         <Border Grid.Row="19">
            <TextBox x:Name="txt20" />
         </Border>
      </Grid>
   </ScrollViewer>
</phone.PivotItem> 
```

如您所见，我有一个`ScrollViewer`within a `PivotItem`，而 inside 是 a `Grid`。在`Grid`大约有 20`TextBox`秒，每个在一个`Border`. 当此页面加载时，我将焦点动态设置为其中一个`TextBox`，因此无论何时我将焦点设置为`TextBox`#6-20（大致） - 我必须手动向下滚动才能看到它。我想自动滚动我的`ScrollViewer`，这样无论哪个`TextBox`有焦点，它都会居中供用户查看。

的[文档](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.controls.scrollviewer.scrolltoverticaloffset%28v=vs.105%29.aspx)`ScrollToVerticalOffset()`说：

> 将 ScrollViewer 中的内容滚动到指定的垂直偏移位置。

并且它接受一种`System.Double`.

我不明白的是A）我应该通过的价值，以及B）我怎么能得到那个价值？它应该是介于 0 和我的`Grid`(1500) 高度之间的数字吗？如果是这样，我如何确定任何给定的位置`TextBox`以便滚动到它？

如果有任何简单的示例，请随时链接到它们。我不确定`ScrollViewer`调用此方法时的内容是否重要，但如果确实如此，我想确切地展示我是如何使用它的。

提前谢谢了！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T16:07:23.333

**您可以使用UIElement.TransformToVisual**调用查看任何 UIElement 相对于另一个 UIElement 的位置。

首先，获取 TextBox 和 ScrollViewer 之间的转换。

```
GeneralTransform transform = textBox.TransformToVisual(scrollViewer); 
```

然后，找出 TextBox 的哪个点 (0,0) 相对于 ScrollViewer。意思是，TextBox 原点 (0,0) 位于 ScrollViewer 的位置。

```
Point textBoxPosition = transform.Transform(new Point(0, 0)); 
```

现在您知道 TextBox 相对于 ScrollViewer 的 Y 位置，滚动到该 Y 偏移量。

```
scrollViewer.ScrollToVerticalOffset(textBoxPosition.Y); 
```

祝你好运！

# c# - 自托管 WebAPI 在 IDE 中运行，但不在 IDE 之外

> ID：15114992
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:47.550
> 
> 标签：c#, asp.net-web-api, self-hosting

我在控制台应用程序中内置了一个自托管 WebAPI。当我通过 VisualStudio IDE 运行它时，一切正常。我有一个客户端应用程序，可以很好地连接 WebAPI 应用程序并与之交互。但是，如果我在 IDE 之外运行我的 WebAPI 应用程序，只需双击 EXE，我的客户端应用程序就根本无法连接到它。我也没有得到任何真正有用的错误信息，客户端中有两个 InnerExceptions（在 PostAsXmlAsync 调用上）。一个说“无法连接到远程服务器”，第二个是“发送请求时发生错误”。

通常，如果这是一个一致的错误，我会自己进行故障排除和调试。但这里的关键元素是，如果我通过 VisualStudio IDE 运行这一切，一切都会按预期工作。

任何人都可以就我应该关注/关注的内容提供一些建议吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:23:21.703

1）如果您所做的只是在本地访问自己的主机，您可以设置以下配置选项：

```
config.HostNameComparisonMode = System.ServiceModel.HostNameComparisonMode.Exact; 
```

这样，您不必以提升的权限运行该进程（同样，如果您想在本地访问它）。

2）另一种选择是为特定用户保留特定端口：

```
netsh http add urlacl url=http://+:999/ user=machine\username 
```

这也允许您以管理员身份运行自我主机，只要该进程是为已为其保留端口的用户启动的。

3）最后，最后一个选项是以管理员身份运行它。

# javascript - 如何在 chrome 中使用 jquery.load() 在 html 中嵌入文件

> ID：15114993
> 
> 赞同：1
> 
> 时间：2013-02-27T14:47:48.720
> 
> 标签：javascript, jquery, html, google-chrome

我正在尝试在 Chrome 中使用 jquery 加载一个 txt 文件。为什么它不起作用？我[从 w3schools 复制了这段代码片段](http://www.w3schools.com/jquery/tryit.asp?filename=tryjquery_ajax_load)，我改变的只是他们的网址。

```
<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
<script>
$(document).ready(function(){
  $("button").click(function(){
    $("#div1").load("http://stackoverflow.com/questions/15114993/how-to-embed-a-file-in-html-using-jquery-load");
    alert("clicked");
  });
});
</script>
</head>
<body>

<div id="div1"><h2>Let jQuery AJAX Change This Text</h2></div>
<button>Get External Content</button>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:56:30.390

Chrome 在执行代码时会抛出以下错误：

```
Origin null is not allowed by Access-Control-Allow-Origin. 
```

你必须：

1.  将您的 HTML 代码托管在本地 Web 服务器上，以便可以在以下位置访问它：

    `http://localhost/your_directory/index.html`

2.  更新您的代码以加载您的`out.txt`，放置在您的文件所在的同一文件夹中`index.html`，就像这样（使用相对路径）...

    `$("#div1").load("out.txt");`

3.  ...或像这样（使用绝对路径）：

    `$("#div1").load("http://localhost/your_directory/out.txt");`

你完成了！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:55:50.903

好的，您可能在这里遇到的问题似乎与 chrome 和 ajax 请求有关。如果在本地运行 Chrome 尝试将您的代码放在 Web 服务器上，或尝试使用 firefox，Chrome 会引发安全问题。

或者，如果您在 Mac 上，您可以从命令行使用这样的方式打开 chrome，以防止出现安全问题

```
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --allow-file-access-from-files 
```

如果您搜索“允许从文件 chrome 访问文件”，谷歌上有很多帖子

祝你好运

# c# - 动态重新创建硬编码的 tabControl

> ID：15114994
> 
> 赞同：0
> 
> 时间：2013-02-27T14:47:50.927
> 
> 标签：c#, controls, tabcontrol, reset, recreate

我已经硬编码了一个 tabcontrol，它加载了一堆数据供我使用，但我希望能够丢弃 tabcontrol 并重新创建我硬编码的相同的 tabcontrol，但没有任何输入是空白的。

现在我有一个简单的 tabControl，大约有 10-15 个页面，每个页面上大约有 10 个控件，从 TextBoxes 到各种控件。

我尝试过简单的操作，只需使用 2 条简单的行删除和重新创建控件，例如：

```
this.Controls.Remove(tabControl1);
this.Controls.Add(tabControl1); 
```

删除和重新创建 tabControl 效果很好，但它不会重新创建内部的控件，将值返回给原始值。

我有一个工作版本，它只是删除了 tabControl 并将每个子控件重置为自定义值，但这对于我正在寻找的东西来说似乎很丑陋和被黑。

有没有办法或创建一个 tabControl 的模板并每次调用一个新的？

# svn - svnsync 我无法同步我的仓库，因为我收到错误：无法读取块大小

> ID：15114996
> 
> 赞同：0
> 
> 时间：2013-02-27T14:47:57.027
> 
> 标签：svn, svnsync

我只想在 repo 中同步我的分支。`branches/my_branch`所以我执行了：

```
svnsync init http://localhost/svn/my_branch http://remote_svn/branches/my_branch 
```

之后我执行了：

```
svnsync sync http://localhost/svn/my_branch

[...]
Copied properties for revision 53542.
Committed revision 53543.
Copied properties for revision 53543.
Committed revision 53544.
Copied properties for revision 53544.
Committed revision 53545.
Copied properties for revision 53545.
Committed revision 53546.
Copied properties for revision 53546.
Transmitting file data .........................................................
.................................................svnsync: E175002: REPORT of
'http://remote_svn/branches/my_branch': Could not read chunk size: connection 
was closed by server (http://remote_svn) 
```

（当然还有更多的“点”）

我知道这个修订是巨大的，因为它是初始的。

那么有没有其他方法可以做到这一点？也许结帐（结帐工作正常）它在临时位置并手动提交到目标SVN然后恢复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:07:17.817

看起来您的网络或服务器关闭了您的连接。您可以再试一次，密切关注同步过程的内存使用情况。

要手动修改它，您需要从文件目录复制数据，然后仔细编辑属性文件 0 的内容。在那里您将找到同步过程的详细信息。一旦你复制了第一个文件增量，你只需编辑 0 属性以读取它已经同步了这个文件。（即在相关条目中加 1）。不过，请花一点时间了解该属性文件中的每个条目。如果你搞砸了，你只需删除同步目录并重新开始（或复制整个同步 repo 并恢复它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T08:16:48.673

使用较新版本的 svnsync，您可以执行以下操作。

在源机器上

```
svnadmin dump repo > repo.dump 
```

在要同步到的机器上

```
svnadmin create repo
svnadmin load repo < repo.dump 
```

然后

```
svnsync init --allow-non-empty <dest> <source> 
```

它将假设您转储的前 n 个修订在 dest 和 source 上是相同的。

# mongodb - 一起使用 MongoDB 和 Neo4j

> ID：15114997
> 
> 赞同：20
> 
> 时间：2013-02-27T14:47:57.640
> 
> 标签：mongodb, neo4j, nosql

我正在开始一个新项目，我正在考虑使用 MongoDB 作为文档存储设施，并使用 Neo4j 作为映射文档之间关系的机制，然后我想通过 rest API 公开我的查询结果。有人会说这样做的优点和缺点是什么？有没有更好的方法可以使用不同的 NoSQL 文档存储来实现这一点？有没有可以在网上找到有人尝试做类似事情的例子？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-27T17:10:00.133

I have been thinking about using these two together for a while because my data is already in mongodb. But I don't want to add one more DB top of the existing architecture, because addition of neo4j will require more resources e.g. memory, diskspace and not to mention time invested in maintaining 2 DBs.

Another problem which I can think of is when you shard your data with mongodb, you'll also have to manage your neo4j data w.r.t. these new shards. Scaling in neo4j is done through clusters and it is a part of enterprise edition which is commercial.

I did further research and found out that **[OrientDB](http://www.orientdb.org/)** can store the data as documents and its a graph db.

Another way is building the relationships in MongoDB itself and write your logic on top of that and expose this logic through a REST API.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-28T23:53:23.350

您可能对[Mongo Connector的](https://github.com/mongodb-labs/mongo-connector)[Neo4j 文档管理器](http://neo4j.com/developer/mongodb/#_neo4j_doc_manager)感兴趣。它是 Mongo 连接器项目的扩展，允许实时单向同步从 MongoDB 到 Neo4j 的数据。在 MongoDB 中插入的文档被转换为属性图并自动插入到 Neo4j 中。可以配置要从 Mongo 同步到 Neo4j 的集合和字段。

这里的想法是促进在单个应用程序中同时使用 Neo4j 和 MongoDB，而无需在应用程序层编写代码来同步数据。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-27T16:10:29.653

如果你喜欢 Neo4j，你应该看看 Structr ( [https://github.com/structr/structr](https://github.com/structr/structr) , [http://structr.org](http://structr.org) )。

使用 Structr，您可以在 Neo4j 之上定义自定义模式（在 Java 中，或从 0.7 开始，甚至通过 UI），它将为您创建（几乎）生产就绪的 RESTful JSON API。

JSON“文档”由 Structr 实时创建，作为 Neo4j 中子图的任何类型的聚合或映射。这允许您在同一数据上定义任意数量的不同视图。

Structr 具有内置功能，例如搜索（全文、关键字/精确、带有 Neo4j 空间的位置范围）、分页、排序、约束、用户/组、访问控制、类似 cron 的后台作业、维护命令和补充（测试版）用于 CRUD 操作和基本 CMS 功能的 UI。

免责声明：我是 Structr 的创始人。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-28T16:43:01.670

我们最终使用 Neo4j 作为“索引”来进行路线计算（在公共汽车/火车搜索中）。大部分数据存储在 MongoDB 中。我们使用 MongoConnector 作为同步两个数据库的一种方式。Mongo 在处理原始 JSON 数据方面表现出色。

我们最初尝试在 Neo4j 中存储“所有内容”，但随后查询开始需要 +2 分钟，因此之后我们只存储了必要的最少数据。此外，Neo4j 对您可以索引的内容有限制。例如，它们没有“日期”类型，因此对日期的范围查询很麻烦。当你有一个“超级节点”时，你也会遇到问题，一个具有数千或数十万个链接（关系）的节点。关系在 Neo4j 中存储为链接列表，因此随机访问可能非常慢（用于查找关系）。

Neo4j的使用方式你要挑剔，最后我们把它用于最短路径计算/搜索，这是Neo4j的强项。

有关更多详细信息，请查看 GraphConnect NY 2013 上的视频和展示我们的发现： [https ://vimeo.com/79477603](https://vimeo.com/79477603)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-27T17:28:51.517

我会看看Gremlin。

查看这篇文章： [http](http://thinkaurelius.com/2013/02/04/polyglot-persistence-and-query-with-gremlin/) ://thinkaurelius.com/2013/02/04/polyglot-persistence-and-query-with-gremlin/ 我个人发现在处理数据时 Groovy 语法很棒。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-25T21:30:08.420

在neo4j中你应该构建你的关系，例如如果你在mongodb中有2个用户，如果一个跟随另一个你应该在neo4j中建立节点关系，而不是用信息制作另一个集合。您应该使用 2 个数据库作为一个。

# javascript - 使用Javascript检查数据库中是否存在记录

> ID：15114998
> 
> 赞同：0
> 
> 时间：2013-02-27T14:47:59.170
> 
> 标签：javascript, sql, select, recordset

我正在尝试使用 javascript 检查记录是否存在（我知道这不是最安全的方法），但所有这些都是供内部使用的，安全不是问题。

于是我打开了一个记录集，

```
rs.Open("SELECT * FROM clie Where N_CLIENT =" + textbox1+ " AND C_POST_CLIENT = '" + textbox2+ "'",connection) 
```

`textbox1`并且`textbox2`是我正在查看 clie 表的值，但首先我需要检查记录是否存在。我尝试将其分配`rs.Open`给一个变量，然后将其与某些东西进行比较，但它不起作用

我尝试使用 a`RecordCount`但我一直得到-1。我读到它不是为此而设计的，它不应该用于查找记录，因此必须有另一种方法来做到这一点。

****更新*_*****

 **这是我正在处理的整个功能

```
function RecordExists(textfield1, textfield2)
{
var connection = new ActiveXObject("ADODB.Connection") ;
    var connectionstring = "UID=admin;PWD=password";
    connection.Open(connectionstring);
    var rs = new ActiveXObject("ADODB.Recordset");
    var textbox1= new String();
    var textbox2=new String();
    textbox1= document.getElementById(textfield1).value;
    textbox2= document.getElementById(textfield2).value;

    var isEmpty=new String();

    rs.Open("SELECT count(*) as pers FROM clie HAVING N_CLIENT =" + textbox1+ " AND C_POST_CLIE = '" + textbox2+ "'",connection);

    alert(rs.recordcount);
    //alert(rs.fields(1));
    //isEmpty = rs.Open("pers");
    alert("Empty"+isEmpty);
    if(pers=0)
        alert("Record does not exist! pers="+pers);
    else if(pers=1)
        alert("Record exists! pers="+pers);
    else
        alert("not working");
    rs.close;
    connection.close;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T14:52:23.190

尝试这个：

```
rs.Open("SELECT count(1) as pers FROM clie Where N_CLIENT =" + textbox1+ " AND C_POST_CLIENT = '" + textbox2+ "'",connection) 
```

您可以通过以下方式检索 pers 字段：

```
perCounts = rs.('pers') 
```

或者

```
perCounts = rs.("pers") 
```

然后如果 perCounts = 0 则用户不存在....如果 1 则用户存在于您的数据库中。

****_ *_* ____***编辑****_* __ *_* __ *_* __ *_* __ *_* ___****

 **```
function RecordExists(textfield1, textfield2)
{
var connection = new ActiveXObject("ADODB.Connection") ;
var connectionstring = "UID=admin;PWD=password";
connection.Open(connectionstring);
var rs = new ActiveXObject("ADODB.Recordset");
var textbox1= new String();
var textbox2=new String();
textbox1= document.getElementById(textfield1).value;
textbox2= document.getElementById(textfield2).value;

var isEmpty=new String();

rs.Open("SELECT count(*) as pers FROM clie HAVING N_CLIENT =" + textbox1+ " AND C_POST_CLIE = '" + textbox2+ "'",connection);

alert(rs.recordcount);

rs.MoveFirst();

perCounts = rs.Fields(0).Value;

if(perCounts=0)
    alert("Record does not exist! pers="+pers);
else if(perCounts=1)
    alert("Record exists! pers="+pers);
else
    alert("not working");
rs.close;
connection.close;
}
} 
```

萨卢多斯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:04:04.097

您应该改用 count 方法

> rs.Open("SELECT count(*) FROM clie Where N_CLIENT =" + textbox1+ " AND C_POST_CLIENT = '" + textbox2+ "'",connection)

这将返回结果的数量

> 0 = 0 客户 1 = 1 客户 2 = 2 客户。. .****