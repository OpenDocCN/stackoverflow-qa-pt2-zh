# StackOverflow 问答 14755000-14755999

# android - 包含 Android 上的 webview 的 PageViewer 中的内存泄漏

> ID：14755002
> 
> 赞同：0
> 
> 时间：2013-02-07T15:38:14.767
> 
> 标签：android, memory-leaks, webview

我在我的应用程序中使用 a `ViewPager`。每个页面都包含一个`WebView`和一些`ImageView`。我知道这`WebView`是最关键的观点。

当我旋转屏幕时，`Activity`它不会被破坏。在`destroyItem()`我使用以下代码：

```
@Override
public void destroyItem(View collection, int position, Object view) {
    LinearLayout layout = (LinearLayout)((LimitScrollView)((RelativeLayout)view).getChildAt(0)).getChildAt(0);
    for (int i = 0; i < layout.getChildCount(); i++) {
        View locView = layout.getChildAt(i);
        if (locView.getTag() !=null && ((String)(locView.getTag())).equals(ADAPTER_TAG_WEBVIEW)){
            FrameLayout webViewFrame = (FrameLayout)locView;
            WebViewSub webView = (WebViewSub ) webViewFrame .getChildAt(0);
            webView.destroy();
            webView = null;
            webViewFrame.removeAllViews();
        }
    }
    ((ViewPager) collection).removeView((View) view);
} 
```

我试图`WebView`从 中的`onDestroy()`方法中删除所有内容，但是在旋转之后，我在 MAT 中`Activity`有两个实例。`Activity`如果我不使用`WebView`轮换后我有一项活动。

# php - 每个数组对象插入一行

> ID：14755004
> 
> 赞同：0
> 
> 时间：2013-02-07T15:38:20.693
> 
> 标签：php, mysql, arrays, post

我正在创建一个文档关联工具，用户可以将文档关联到预先存在的文档列表中的票证。

感谢 Alberto Ponte 的帮助，我能够从这个问题中构建初始的单选框系统（最初是复选框，由于明显的原因而更改）：[根据数组数据分离数组](https://stackoverflow.com/questions/14657216/separate-out-array-based-on-array-data)

现在我已经正确显示了单选按钮，我正在尝试将数据插入到 MySQL 中，每个文档都有一行。在此之后，我想让它查找每个对象的表，看看是否存在现有条目并更新它，而不是插入重复的条目。

提前为即将贬值的代码道歉，我将在未来更正代码，但这是一项比我目前有时间完成的更大的任务。

如果代码被认为是混乱的，也很抱歉。我在 PHP 方面并不出色，对最佳实践也不太热衷。任何快速指示总是受欢迎的。

显示代码：

```
<?php

include "../includes/auth.php";
include "../includes/header.php";

## Security ########################################################

if ($company_id != 1 OR $gid < 7) {

echo'          <div class="pageheader">
                  <div class="holder">
                     <br /><h1>Access Denied <small> Your attempt has been logged</small></h1>
            </div>
         </div>
';
exit();
}

// GET Values ###################################################
$jat_id = intval($_GET['id']);
$div_id = intval($_GET['div_id']);

## Page Start ########################################################

echo '
               <div class="pageheader">
                  <div class="holder">
                     <br /><h1>Clovemead Job Management Platform<small> Welcome...</small></h1>
            </div>
         </div>

<div class="well5" style="width:1000px !important;">
<h3>Create Document Association</h3>

<table border=1>
  <tr>
    <td align=center><p>Here you can associate documents to Jobs and Tasks to.</p> </td>
  </tr>
</table>';

            $order2 = "SELECT * FROM documents";
                $result2 = mysql_query($order2);
                while ($row2 = mysql_fetch_array($result2)) {

                $nice_name = $row2['nice_name'];
                $doc_id = $row2['id'];

}

echo '

<h3>Documents</h3>

<table border=1>
  <tr><th>Document Name</th><th>Document Type</th><th>Required</th><th>Optional</th><th>Not Required</th></tr>
';

            $order2 = "SELECT * FROM documents ORDER BY type_id";
                $result2 = mysql_query($order2);
                while ($row2 = mysql_fetch_array($result2)) {

                $nice_name = $row2['nice_name'];
                $doc_id = $row2['id'];
                $doc_type_id = $row2['type_id'];

echo '

  <tr>
    <td>'.$nice_name.'</td>';

            $order3 = "SELECT * FROM document_types WHERE id = '$doc_type_id'";
                $result3 = mysql_query($order3);
                while ($row3 = mysql_fetch_array($result3)) {

                $type_name = $row3['type_name'];

echo '
    <td>'.$type_name.'</td>
    <form method="post" action="create-doc-assoc-exec.php">
        <input type="hidden" value="'.$doc_id.'" name="doc_id">
        <input type="hidden" value="'.$jat_id.'" name="jat_id">
        <input type="hidden" value="'.$div_id.'" name="div_id">';

                $order4 = "SELECT * FROM document_assoc WHERE doc_id = '$doc_id'";
                $result400 = mysql_query($order4);
                $_results = mysql_fetch_array($result400);
                if (!$_results) {
    echo '
                    <td><input type="radio" name="req0" value="2"></td>
                        <td><input type="radio" name="req0" value="1"></td>
                        <td><input type="radio" name="req0" value="0" checked ></td>';
                    } else {
                            foreach ($_results as $result400) {
                            $requirement = $_results['requirement'];
                                        }
                    $name = "req".$doc_id;

    echo '
            <input type="hidden" value ="'.$name.'" name="name">
                <td><input type="radio" name="'.$name.'" value="2" '; if ($requirement == 2) { echo ' checked '; } echo '></td>
                <td><input type="radio" name="'.$name.'" value="1" '; if ($requirement == 1) { echo ' checked '; } echo '></td>
                <td><input type="radio" name="'.$name.'" value="0" '; if ($requirement < 1) { echo ' checked '; } echo '></td>';

    }

    }

echo '
  </tr>';
}
echo '
</table>

<input type="submit" name="submit value" value="Create Document Association" class="btn success Large"></form>';

            $order2 = "SELECT * FROM divisions WHERE id = '$div_id'";
                $result2 = mysql_query($order2);
                while ($row2 = mysql_fetch_array($result2)) {

                $dbname = $row2['division_dbname'];

            $order3 = "SELECT * FROM $dbname WHERE id = '$jat_id'";
                $result3 = mysql_query($order3);
                while ($row3 = mysql_fetch_array($result3)) {

                $type = $row3['type'];
                $type2 = strtolower($type);

echo '

        <input type="button" value="Back" onclick="window.location=&#39;./view-'.$type2.'.php?id='.$jat_id.'&#39;" class="btn primary Large">

';

}}
echo '
</div>';

include "../includes/footer.php";
?> 
```

执行代码：

```
<?php
include "../includes/dbconnect.php";
$name = $_POST['name']; 
$name = stripslashes($name);
$name = mysql_real_escape_string($name);

$doc_id = intval($_POST['doc_id']); 
$jat_id = intval($_POST['jat_id']); 
$div_id = intval($_POST['div_id']); 
$req = intval($_POST[$name]); 
$req_blank = intval($_POST['req0']); 

if ($req_blank == 0) {
$requirement = 0;
} elseif ($req_blank == 1) {
$requirement = 1;
} elseif ($req_blank == 2) {
$requirement = 2;
} elseif ($req == 0) {
$requirement = 0;
} elseif ($req == 1) {
$requirement = 1;
} elseif ($req == 2) {
$requirement = 2;
}

foreach ($doc_id as $doc_id2) {

$order = "INSERT INTO document_assoc (jat_id, dept_id, doc_id, requirement) VALUES ('$jat_id', '$div_id', '$doc_id2', '$requirement')";
$result = mysql_query($order);

            $order1 = "SELECT * FROM divisions WHERE id = '$div_id'";
                $result1 = mysql_query($order1);
                while ($row1 = mysql_fetch_array($result1)) {

                    $dbname = $row1['division_dbname'];

            $order2 = "SELECT * FROM $dbname WHERE id = '$jat_id'";
                $result2 = mysql_query($order2);
                while ($row2 = mysql_fetch_array($result2)) {

                    $type = $row2['type'];
            $type2 = strtolower($type);

if($result){
header("location:view-$type2.php?id=$jat_id&creation=success");
} else {
header("location:view-$type2.php?id=$jat_id&creation=failed");
}
}}

}
?> 
```

几个参考点：

```
$doc_id is the ID of each document which is to be passed over as an array for use in a (i believe) foreach insert
$jat_id is the ticket id documents are being associated to
$div_id is the department the ticket is associated
And the radio boxes are to decider the requirement of each document.  To be passed over inline with $doc_id 
```

我试过的：

经过相当多的搜索 - 什么也没找到 - 重新检查我的术语并再次搜索，我设法找到了`base64_encode(serialize())`在数组上使用的建议，但我无法让它工作。

# c - 函数中动态分配内存的范围

> ID：14755007
> 
> 赞同：-1
> 
> 时间：2013-02-07T15:38:28.543
> 
> 标签：c, function, scope, malloc

我有一个功能

```
int*AllocatedMemory(int n){
    int*p=malloc(n*sizeof(int));
    return p;
} 
```

分配的内存在离开函数后会失去作用域并因此被释放吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T15:44:17.130

不。分配的内存`malloc`与范围无关，需要释放`free`（或将在程序终止时释放）。

# scala - 如何在 Scala Play 2.0 应用程序中异步使用 Java 库？

> ID：14755012
> 
> 赞同：3
> 
> 时间：2013-02-07T15:38:50.853
> 
> 标签：scala, playframework-2.0

我在[调用 Web 服务的 Play 2.0 Scala 文档中](http://www.playframework.com/documentation/2.1.0/ScalaWS)看到惯用方法是使用 Scala 的异步机制来调用 Web 服务。因此，如果我使用 Java 库从 S3 下载图像并上传到 Facebook 和 Twitter（restfb 和 twitter4j），这是否会导致资源使用效率极低（什么资源？）还是没有太大区别（或根本没有区别）？

如果它有所作为，我将如何制作类似以下异步的东西？有没有一种快速的方法，或者我必须从头开始编写库？

请注意，如果这在本次讨论中很重要，它将在 heroku 上运行。

```
def tweetJpeg = Action(parse.urlFormEncoded) { request =>
  val form = request.body
  val folder = form("folder").head
  val mediaType = form("type").head
  val photo = form("photo").head
  val path = folder + "/" + mediaType + "/" + photo
  val config = Play.current.configuration;
  val awsAccessKey = config.getString("awsAccessKey").get
  val awsSecretKey = config.getString("awsSecretKey").get
  val awsBucket = config.getString("awsBucket").get
  val awsCred = new BasicAWSCredentials(awsAccessKey, awsSecretKey)
  val amazonS3Client = new AmazonS3Client(awsCred)
  val obj = amazonS3Client.getObject(awsBucket, path)
  val stream = obj.getObjectContent()    

  val twitterKey = config.getString("twitterKey").get
  val twitterSecret = config.getString("twitterSecret").get
  val token = form("token").head
  val secret = form("secret").head
  val tweet = form("tweet").head
  val cb = new ConfigurationBuilder();
  cb.setDebugEnabled(true)
    .setOAuthConsumerKey(twitterKey)
    .setOAuthConsumerSecret(twitterSecret)
    .setOAuthAccessToken(token)
    .setOAuthAccessTokenSecret(secret)
  val tf = new TwitterFactory(cb.build())
  val twitter = tf.getInstance()
  val status = new StatusUpdate(tweet)
  status.media(photo, stream)
  val twitResp = twitter.updateStatus(status)

  Logger.info("Tweeted " + twitResp.getText())
  Ok("Tweeted " + twitResp.getText())
}

def facebookJpeg = Action(parse.urlFormEncoded) { request =>
  val form = request.body
  val folder = form("folder").head
  val mediaType = form("type").head
  val photo = form("photo").head
  val path = folder + "/" + mediaType + "/" + photo
  val config = Play.current.configuration;
  val awsAccessKey = config.getString("awsAccessKey").get
  val awsSecretKey = config.getString("awsSecretKey").get
  val awsBucket = config.getString("awsBucket").get
  val awsCred = new BasicAWSCredentials(awsAccessKey, awsSecretKey)
  val amazonS3Client = new AmazonS3Client(awsCred)
  val obj = amazonS3Client.getObject(awsBucket, path)
  val stream = obj.getObjectContent()

  val token = form("token").head
  val msg = form("msg").head
  val facebookClient = new DefaultFacebookClient(token)
  val fbClass = classOf[FacebookType]
  val param = com.restfb.Parameter.`with`("message", msg)
  val attachment = com.restfb.BinaryAttachment`with`(photo + ".png", stream)
  val fbResp = facebookClient.publish("me/photos", fbClass, attachment, param)

  Logger.info("Posted " + fbResp.toString())
  Ok("Posted " + fbResp.toString())
} 
```

我的猜测尝试：

1.  是的，最好是异步做事；如果您同步执行所有操作，那么您将占用*线程。*线程是内存猪，所以你的服务器只能使用这么多；被捆绑等待的越多，您的服务器可以响应的请求就越少。
2.  不，这不是一个*大*问题。使用 node.js（和 Rails？Django？）这*是*一个大问题，因为只有一个线程，所以它阻塞了你的整个 Web 服务器。JVM 服务器是多线程的，因此您仍然可以为新请求提供服务。
3.  您可以在将来轻松地包装整个事情，或者更细化地做，但这并不能真正为您带来任何好处，因为您调用的是相同的方法，所以您只是将等待从一个线程转移到另一个线程。
4.  如果那些 Java 库提供异步方法，您可以在将来包装它们以获得异步的真正好处**<-怎么办？**. 否则，是的，您正在从头开始写作。
5.  真的不知道在heroku上运行是否重要。一个测功机 == 一个同时请求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T15:52:30.737

我认为最好异步执行这些请求，主要有两个原因：

*   高延迟（网络调用）
*   失败

使用 Play，您应该使用 Akka actor 来执行您的操作，它提供了处理这两个问题的好方法。问题同步代码是它会阻塞 Web 服务器。所以它不会对其他请求可用。在这里，我们将在与 Web 服务器无关的其他线程中等待。

您可以执行以下操作：

```
// you will have to write the TwitterActor
val twitterActor = Akka.system.actorOf(Props[TwitterActor], name = "twitter-actor")

def tweetJpeg = Action(parse.urlFormEncoded) { request =>
    val futureMessage = (twitterActor ? request.body).map {
         // Do something with the response from the actor
         case ... => ...
     }
     async {
         futureMessage.map( message =>
             ok("Tweeted " + message)
         )
     }
} 
```

您的演员将收到正文并发回服务的响应。此外，使用 Akka，您可以调整您的流程以有多个可用的参与者，有一个断路器......

更进一步：[http ://doc.akka.io/docs/akka/2.1.2/scala/actors.html](http://doc.akka.io/docs/akka/2.1.2/scala/actors.html)

Ps：我从来没有尝试过在 Heroku 上玩，所以我不知道单个发电机的影响。

# crm - crm 2011 更新在同步后和异步后阶段触发插件的记录

> ID：14755016
> 
> 赞同：2
> 
> 时间：2013-02-07T15:38:58.320
> 
> 标签：crm

在插件中，我必须更新插件在同步前、同步后、异步后触发的记录。

在同步前状态下，我只需要更新上下文实体，例如 mycontact.Attributes["lastname"] = "ABC" 并且更改的值会自动保存。

在更新后，我不能这样做，因为它已经在数据库中（但未提交）。我尝试使用该服务 (service.update(mycontact) 失败。

在更新后（同步/异步）中更新记录的最佳方法是什么 - 如果可能的话？

更新其他记录没问题，但更新插件由/从触发的记录不起作用。:-(

有任何想法吗？

问候，尼克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-04T07:13:15.543

在上述情况下，同步操作将不起作用，因为值尚未保存在数据库中，因此左侧的选项是**async-post-update**并检查

```
if (context.Depth > 1){ return; } //To Avoid Multiple Trigger Of Same Update Plugin. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-09T06:26:39.430

您可以在 Pre Sync、Post Sync 插件或 Post Async 插件中更新记录。

要更新 Pre Sync 插件中的记录，您只需在 Context Entity 中添加字段值，如下所示：

```
Entity e = context.InputParameters["Target"] as Entity;
e["attribute_name"] = somevalue; 
```

要更新 Post Sync 插件中的记录，您需要在上下文实体中添加字段值并调用 IOrganizationService 的 Update 方法，如下所示：

```
Entity e = context.InputParameters["Target"] as Entity;
e["attribute_name"] = somevalue;
service.Update(e); 
```

要更新 Post Async 插件中的记录，您需要执行与 Post Sync 插件相同的操作。

如果您只想更新同一记录的字段，建议使用“Pre Sync”插件。这将减少更新操作，因为此步骤在核心操作阶段之前执行。

如果要将与 EntityReference (Lookup) 相同的记录设置为另一条记录，则需要在 Post Async 插件中执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-16T12:35:00.893

您可以使用一种方法来避免插件多次运行。

```
if (localContext.PluginExecutionContext.Depth > 1) { return; } 
```

希望这就是你的意思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-01T09:31:11.530

在前：-

尝试在保存上下文数据时更新上下文：-

```
Entity test= (Entity)context.InputParameter["Target"];
test["name"]="ABC";
context.InputParaeter["Target"] = test; 
```

后期（同步/异步）：-

尝试创建一个新对象来更新记录

```
Entity test=new Entity("contact");
test.Id=((Entity)context.InputParameter["Target"]).Id;
test.Attributes["firstname"]="ABC";
service.Update(test); 
```

也请检查

```
Context.Depth<=1; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-30T00:30:33.510

正如其他人之前所说，在对当前记录发布操作调用更新时，您将不得不捕获大于 1 的 context.depth 属性。

我强烈建议您，如果您只编辑当前记录并且不需要将其他实体关联到它，那么请注册您的插件预操作。这样，您只需更改属性并让主要操作将它们提交到数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-28T10:20:12.900

您必须检索要更新的记录

```
Entity EntityUpdate=  service.retrieve(entity,id,true); 
```

然后更新字段

```
 EntityUpdate["field1"] = "abc"; 
```

然后

```
 service.update(EntityUpdate); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-03T17:29:46.490

我的猜测是您的插件被多次触发并达到了插件的递归限制。

通常，您只想在更改相关字段时触发插件。

此外，请确保您的更新调用仅具有需要在您发送到更新方法的对象上更新的属性。大多数时候，我不会从插件上下文更新对象，但我会使用 Id 属性集更新一条新记录。这有助于防止递归场景。

如果您想要更具体的答案，您将需要向您的问题添加更多信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-28T18:58:57.310

这

```
service.Update(entity) 
```

应该在后期工作。无论如何，在更新操作期间，您无法访问实体的所有字段，而只能访问已更新的字段。如果要修改其他字段，则需要使用检索来检索实体（始终只检索您需要的字段以获得更好的性能）。本质上，问题应该是您正在读取一个值，或更新一个尚未转发到上下文并因此为空的字段。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-12-15T17:37:14.893

没错，记录保存到数据库后，您将无法通过直接修改其内容来更新上下文记录。

相反，您需要创建一个新实体对象，然后使用新值对其进行更新。

```
Entity oContact = New Entity("contact");
oContact.Id = myContact.Id;
oContact.Attributes.Add("lastname", "ABC");
organizationService.Update(oContact); 
```

# asp.net-mvc-4 - HttpConfiguration 的 RouteHandler

> ID：14755018
> 
> 赞同：2
> 
> 时间：2013-02-07T15:39:02.410
> 
> 标签：asp.net-mvc-4, asp.net-web-api, asp.net-mvc-routing, asp.net-web-api-routing

我偶然发现了一篇关于 ASP.Net MVC 的 WebAPI 的 RouteHandlers 的有趣文章：

[http://techbrij.com/separate-web-api-action-mobile-asp-net-mvc](http://techbrij.com/separate-web-api-action-mobile-asp-net-mvc)

在本文中，它展示了来自桌面 Web 浏览器和来自移动设备的相同 WebAPI 请求如何路由到不同的控制器。该示例使用如下所示的 RouteHandler：

```
routes.MapHttpRoute(
               name: "DefaultApi",
               routeTemplate: "api/{controller}/{id}",
               defaults: new { id = RouteParameter.Optional }
           ).RouteHandler = new MyRouteHandler(); 
```

此代码用于 Global.asax。

但是，我在 App_Start 中通过 WebApiConfig 注册我的 WebAPI 路由，其中​​ HttpConfiguration 被传递到 config 方法中：

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional },
            constraints: null,
            handler: new CustomHttpControllerDispatcher(config)
        );

    }
} 
```

config.Routes.MapHttpRoute 没有处理 RouteHandler 的能力。如何将 RouteHandler 与 config.Routes.MapHttpRoute 一起使用？

谢谢你的帮助。

**更新**

经过进一步研究，我想我找到了我正在寻找的东西，但不确定这种方法是否好用。

我的目标是拦截传入的请求并确定请求的设备类型，以便我可以定制对正确设备（台式机、平板电脑、移动设备等）的响应。HttpRequestMessage 授予您对 Headers 和 UserAgent 字符串的访问权限。我找到了一种分析 UserAgent 以确定设备类型的方法（[http://techbrij.com/display-mode-mobile-tablet-tv-aspnet-mvc](http://techbrij.com/display-mode-mobile-tablet-tv-aspnet-mvc)）。我正在使用命名约定，将 DeviceType 放在控制器名称之后：

值[设备类型]控制器

例子：

*   值控制器
*   价值观移动控制器
*   值平板控制器

我从 UserAgent 确定设备类型，然后在 RouteData 集合中换出控制器名称。

**注意：下面的 DisplayModeConfig.GetDeviceType(userAgent) 使用上面链接中概述的方法

```
public class CustomHttpControllerDispatcher : HttpControllerDispatcher
{
    public CustomHttpControllerDispatcher(HttpConfiguration configuration): base(configuration)
    {

    }
    protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
    {
        // My stuff here
        var userAgent = request.Headers.UserAgent.ToString();
        var deviceType = DisplayModeConfig.GetDeviceType(userAgent);
        IHttpRouteData routeData = request.GetRouteData();

        switch(deviceType)
        {
            case "mobile":
                {
                    var controller = routeData.Values["controller"].ToString();
                    routeData.Values["controller"] = controller + "Mobile";

                    break;
                }
            case "tablet":
                {
                    var controller = routeData.Values["controller"].ToString();
                    routeData.Values["controller"] = controller + "Tablet";

                    break;
                }
            case "desktop":
                {

                    break;
                }
        }

        return base.SendAsync(request, cancellationToken);
    }
} 
```

通过根据设备类型指示哪个控制器处理响应，我可以通过定制对设备类型的正确响应来更好地控制用户体验。

您对这种方法有何看法？你能看出这种方法有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T21:02:08.277

有一个名为 IHttpControllerSelector 的服务可以满足您的目的。您可以从 DefaultHttpControllerSelector 派生并覆盖 GetControllerName。

# ios - Facebook iOs SDK 3.1，如果我不升级怎么办？

> ID：14755020
> 
> 赞同：1
> 
> 时间：2013-02-07T15:39:06.573
> 
> 标签：ios, facebook, sdk

不升级到 Facebook iOS SDK 3.1 的直接后果是什么？

我还能继续使用旧的 2.x API 多长时间？

# google-app-engine - GAE 将 JSF2 应用程序缓存为静态站点

> ID：14755022
> 
> 赞同：0
> 
> 时间：2013-02-07T15:39:10.873
> 
> 标签：google-app-engine, jsf

我有一个非常简单的公司简介网站，我正在使用 JSF2 开发，我使用的唯一动态参数是确定使用 PrettyFaces 完成的显示语言。该站点不使用任何 AJAX。

使用 JSF2 的唯一真正原因是 Facelets 模板机制来维护整个站点的布局、CSS 和 JS。

我希望 GAE 在第一次执行时从 JVM 加载内容，然后将内容缓存为静态 Facelets 文件以供后续请求使用。我注意到静态图像文件的加载速度比任何 Java 生成的代码都快得多，尤其是在第一次请求时。

是否有任何方法可以使用 appengine-web.xml 或 faces-config.xml 实现此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:20:50.170

AFAIK 无法进行自动开箱即用的 servlet/facelets 响应缓存。但是，您始终可以编写[自己的缓存 servlet 过滤器](http://onjava.com/pub/a/onjava/2003/11/19/filters.html?page=3)。

OTOH，所有 GAE 响应都被 Google CDN 缓存透明缓存。`Cache-control`您可以通过向其添加HTTP 标头来实现对任何响应的缓存。

请注意，缓存不能以编程方式过期，因此如果您将缓存时间设置为一小时，那么现有用户需要一个小时才能获取新内容，因此您应该在代码中谨慎使用它。

# c - 将结构指针转换为 char* 并复制

> ID：14755025
> 
> 赞同：3
> 
> 时间：2013-02-07T15:39:21.823
> 
> 标签：c, pointers

我有以下代码

```
struct Info { int age; char name[5]; }
char buffer[20];
Info i;
i.age = 10;
sprintf(i.name, "Case");
strncpy(buffer+5, (char*)&i, sizeof(Info)); 
```

现在我想恢复记录

```
Info j;
strncpy((char*)&j, buffer+5, sizeof(Info));
printf("%d %s", j.age, j.name); 
```

但是，这会打印名称的空字符串。我不确定我做错了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T15:42:13.227

您的复制机制存在两个问题：

1.  你假设那`sizeof(Info)`是 5。绝对不是这样的。
2.  您正在使用`strncpy`，它用于字符串。 `Info`不是字符串，因此您需要使用`memcpy`.

以下将起作用：

```
char buffer[sizeof(i)];
memcpy(buffer, &i, sizeof(i));

...

memcpy(&j, buffer, sizeof(j)); 
```

* * *

还有另一个问题；`name[5]`不足以容纳`"Casey"`，因为一旦您考虑了*null 终止符*，那就是 6 个字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T15:43:07.400

有几件事：

*   你溢出了缓冲区，`char name[5]`不能保持`"Casey"`，终结器不适合。这会导致未定义的行为。
*   您正在复制 from `&i`，就好像那是指向字符串的指针，而实际上它指向 a `struct`，其第一个字段是 a `int`。这不会可靠地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:51:18.797

您发布的代码存在几个问题。首先，考虑到“Casey”必须为空终止，该`name`字段`info`太短。

您所做的观察是由于另一个问题。的地址`j`不会与其`name`字段对齐。那个地方仍然有一个`int age`，并且很可能该`name`字段在 4 个字节之后开始，但这取决于您的编译器。

至于恢复`age`，那是行不通的，因为它从未存储到缓冲区中。

可行的是，假设它`buffer`足够大，`memcpy(buffer, &i, sizeof(Info))`可以存储，并且前两个参数切换到重构。在这里使用`sizeof`会有所帮助，因为这种方式是在询问编译器`Info`该结构在内存中的布局方式有多大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T15:59:04.520

您不需要使用 memcpy() 来复制`Info`变量。您可以只使用赋值运算符：

```
Info j;
j = i;
printf("%d %s", j.age, j.name); 
```

您可以这样做，因为`Info`不包含指针成员变量，因此在使用赋值运算符时您将获得深层副本。如果您只使用默认的复制构造函数，也会发生同样的情况：

```
Info j(i); 
```

或者：

```
Info j = i; 
```

当然，正如其他人指出的那样，您应该`Info::name`足够大以容纳您打算存储在其中的名称，包括`'\0'`字符串终止符。

# .net - 是否可以在没有实际数据的情况下绘制 WPF DataGrid 行分隔符？

> ID：14755026
> 
> 赞同：1
> 
> 时间：2013-02-07T15:39:32.350
> 
> 标签：.net, wpf, datagrid, datagridview, wpfdatagrid

我需要像设计师告诉我的那样绘制完全相同的用户控件。

DataGrids 之一包含没有实际数据的行分隔符：

![在此处输入图像描述](../Images/e741e21a2e0c7cf7d4c6d2bf11a4ab83.png)

是否可以在不添加假数据的情况下将分隔符绘制到 DataGrid 的末尾？（我不希望出现滚动条，而且这些行也不应该选择）

# messaging - Apache Kafka：消费者状态

> ID：14755030
> 
> 赞同：8
> 
> 时间：2013-02-07T15:39:42.230
> 
> 标签：messaging, asynchronous, apache-kafka

我阅读了 Kafka 网站上的文档，但是在尝试实现一个完整的最小示例（生产者 --> kafka --> 消费者）之后，我不太清楚“消费者状态”如何处理偏移量。

一些信息

1.  我正在使用高级 API (Java)
2.  我的消费者是一个带有 Main 的简单类，与“快速入门”Kafka 页面上的基本相同
3.  我正在使用动物园管理员
4.  我正在使用单个经纪人

现在，文档说 HighLevel API 消费者使用 zookeeper 存储其状态，所以我希望偏移量，因此消费者的状态将保持在

*   Kafka 代理重新启动
*   消费者重启

但不幸的是，它没有：每次我重新启动代理或消费者时，所有消息都会重新传递。现在，可能这些都是愚蠢的问题，但是

1.  **在 Kafka 重启的情况下**：我知道这取决于消费者来保持其状态，所以很可能当代理（重新）启动重新传递所有（！）消息并且消费者决定消费什么时......对吗？如果是这样，如果我有 10.0000.0000 条消息会发生什么？

2.  **如果 JVM 消费者重启**：如果状态保持在 Zookeeper 上，为什么要重新传递消息？新的 JVM 是否有可能具有不同的消费者“身份”？而在这种情况下，如何绑定之前的身份呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T19:27:38.340

是的，consumer 负责保持其状态，Java 高级 Consumer 将其状态保存在 zookeeper 中。

很可能您没有指定`groupId`配置属性。在这种情况下，kafka 会生成 random `groupId`。

您也可能关闭了`autocommit.enable`配置属性。

可以在此页面上找到 Kafka 配置的完整参考：http: [//kafka.apache.org/configuration.html](http://kafka.apache.org/configuration.html)在**“高级消费者的重要配置属性”**标题下。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-11T19:28:37.507

回答原始问题：使用 groupId 有助于避免“从一开始就重新消费所有消息”的情况

如果您更改 groupId，您将从创建队列的那一刻起（或自基于 kafka 日志保留策略的最后一次数据清除以来）获得所有消息

不要将此与 kafka-console-consumer “--from-beginning” 标志（设置 auto.offset.reset 选项）混淆，该标志可在下面的选项 1 和 2 之间进行选择：

1）从消费最后一条消息的那一刻开始消费新消息（不是从最初创建kafka队列的时间开始）：

*props.put("auto.offset.reset","smallest");*

2) 从订阅者 JVM 启动的那一刻起使用新消息（在这种情况下，您可能会在订阅者关闭且未侦听队列时丢失放入队列的消息）：

*props.put("auto.offset.reset","最大");*

* * *

*旁注：以下仅与原始问题相关*

对于更高级的用例 - 如果您尝试以编程方式设置消费者偏移量以从特定时间开始重播消息 - 它需要使用 SimpleConsumer API，如[https://cwiki.apache.org/confluence/display/KAFKA/中所示0.8.0+SimpleConsumer+Example](https://cwiki.apache.org/confluence/display/KAFKA/0.8.0+SimpleConsumer+Example)以找到从正确的代理/分区重放的最小偏移量。这实质上是用我们自己的 FindLeader 逻辑替换了 zookeeper。非常棘手。

对于这个用例（从某个用户指定的时间开始临时重播消息），我们决定存储消息的本地缓存并在本地管理偏移量，而不是使用 kafka 偏移量管理 API（这将需要重新实现大量 zookeeper 功能与 SimpleConsumer）。

即将kafka视为“邮递员”，一旦消息被传递，它就会进入本地邮箱，以防我们需要回到过去的某个偏移量，例如重播消息（已经被消费），例如如果发生消费者应用程序错误，我们不会回到“邮局”（kafka 经纪人）来找出正确的交付顺序，而是在**本地**进行管理。

*旁注结束*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-13T09:13:43.317

看来我一直是个糟糕的读者……这一切都在配置页面中。具体来说，我的两个问题都是通过设置一个默认为“最小”的标志“autooffset.reset”来解决的，因此会导致所描述的效果。

现在，以“最大”为值，在消费者和代理重新启动的情况下，事情都按预期工作，因为偏移量始终是最大的。

# android - 通过 NFC 发送字节数组

> ID：14755031
> 
> 赞同：0
> 
> 时间：2013-02-07T15:39:44.310
> 
> 标签：android, nfc

我想在 ARM 和智能手机之间进行通信（我有 Xperia Sola 和 Acer S500）（我的 ARM 有 PN532）

我所见过的任何地方，人们都会将 NDEF 消息发送到标签或发送任何东西......

就我而言，我只想发送一个字节数组。这个项目的目标是向手臂发送一个文件，所以我要发送我的文件剪切。

目前我的ARM在DESFire标签上读写，所以我会使用isodep类，因为我看到我们可以使用这种方法发送一个字节数组：public byte[] transceive (byte[] data)

你能帮我知道我需要做什么吗？

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T03:43:12.700

Android 中的点对点通信不是很通用。每次触摸只能发送一条消息，并且必须使用“束”协议：NDEF 推送或 SNEP。因此，如果您的设备（什么是“ARM”）实现了其中之一，您可以发送单个消息。这与使用 等与卡片/标签交谈非常不同`IsoDep`，因此这些都不适用。当然，除非您的“ARM”以某种卡模拟模式运行。

# windows - R自定义包安装从文件错误

> ID：14755033
> 
> 赞同：4
> 
> 时间：2013-02-07T15:39:50.803
> 
> 标签：windows, r, installation, package

我一直在为模拟项目开发 R 包，在家里的电脑上我使用 RStudio 成功构建和安装它。但是在大学的另一台机器上我遇到了麻烦......如果我尝试在 RStudio 中构建一个二进制文件，它也会安装它，我会收到一个错误，如果我只是编译一个源以获得 .tar.gz 它可以工作，但是当我来安装时，我再次收到错误。两次出现错误的读数如下。我认为它与库有关，但是为什么这与我不知道的家用计算机不同，我不是程序员，并且在这台机器上安装 R 和 RTools 和 RStudio 的方式与我个人的完全相同机器。- 我有几天的管理员访问权限。

```
install.packages("speEaR_1.0.tar.gz", repos=NULL, type="source")
Installing package(s) into ‘\\ueahome5/ressci17/yrq12edu/data/Documents/R/win-library/2.15’
(as ‘lib’ is unspecified)
* installing *source* package 'speEaR' ...
** R
** preparing package for lazy loading
** help
Warning: C:/Users/yrq12edu/AppData/Local/Temp/Rtmp84HJPx/R.INSTALL7e81a241d97/speEaR/man/makeSetMatrix.Rd:25: unknown macro '\begin'
Warning: C:/Users/yrq12edu/AppData/Local/Temp/Rtmp84HJPx/R.INSTALL7e81a241d97/speEaR/man/makeSetMatrix.Rd:26: unknown macro '\item'
Warning: C:/Users/yrq12edu/AppData/Local/Temp/Rtmp84HJPx/R.INSTALL7e81a241d97/speEaR/man/makeSetMatrix.Rd:30: unknown macro '\end'
*** installing help indices
** building package indices
** testing if installed package can be loaded
*** arch - i386
Warning in library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return = TRUE) :
  no library trees found in 'lib.loc'
Error: loading failed
Execution halted
*** arch - x64
Warning in library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return = TRUE) :
  no library trees found in 'lib.loc'
Error: loading failed
Execution halted
ERROR: loading failed for 'i386', 'x64'
* removing '\\ueahome5/ressci17/yrq12edu/data/Documents/R/win-library/2.15/speEaR'
Warning messages:
1: running command 'C:/PROGRA~1/R/R-215~1.2/bin/i386/R CMD INSTALL -l "\\ueahome5/ressci17/yrq12edu/data/Documents/R/win-library/2.15"   "speEaR_1.0.tar.gz"' had status 1 
2: In install.packages("speEaR_1.0.tar.gz", repos = NULL, type = "source") :
  installation of package ‘speEaR_1.0.tar.gz’ had non-zero exit status 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:47:07.287

几天前我遇到了类似的错误。这是因为您正在安装到此目录：

```
 '\\ueahome5/ressci17/yrq12edu/data/Documents/R/win-library/2.15/speEaR' 
```

我猜它连接到网络驱动器。您应该做的是转到该网络驱动器并明确复制地址

```
 'M:/ressci17/yrq12edu/data/Documents/R/win-library/2.15/' 
```

然后在安装时使用它来指定库位置。例如：

```
install.packages("speEaR_1.0.tar.gz", repos=NULL, type="source",lib='U:/ressci17/yrq12edu/data/Documents/R/win-library/2.15/') 
```

或尝试**devtools**，解压缩你的 tar 球并执行以下操作：

```
library(devtools)
has_devel() ## check if your Rtools are properly installed
check('speEaR')
##build('speEaR')
install("speEaR",args='-l "U:/ressci17/yrq12edu/data/Documents/R/win-library/2.15/"') 
```

这就是我解决问题的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-15T15:51:05.100

我发现问题与 R 脚本中 roxygen 注释中的 Windows 路径反斜杠有关。解决方案是将反斜杠更改为单个正斜杠。示例：最初我的 roxygen 信息是这样的：

```
#'  Performs a search in MS Windows file system for all files in the
#'  `C:\USERS\MYNAME` directory, and all directories below that 
```

这导致此警告消息：

```
* installing to library 'C:/Users/MYNAME/Documents/R/win-library/3.2'
* installing *source* package 'whatever' ...
** R
** preparing package for lazy loading
** help
Warning: C:/Users/MYNAME/Documents/R/CODE/whatever/man/func.Rd:11: unknown macro '\USERS'
Warning: C:/Users/MYNAME/Documents/R/CODE/whatever/man/func.Rd:11: unknown macro '\MYNAME'
*** installing help indices
** building package indices
** testing if installed package can be loaded
* DONE (whatever) 
```

线索是文本是橙色的，而不是 RStudio 中通常的蓝色。 [![在此处输入图像描述](../Images/3423f18c04409c76fd17b6f3db835078.png)](https://i.stack.imgur.com/KLLtv.png)

因此，将反斜杠更改为正斜杠，不会产生警告消息，并且所有 roxygen 注释现在都是蓝色的。

```
#'  Performs a search in MS Windows file system for all files in the
#'  `C:/USERS/MYNAME` directory, and all directories below 
```

[![在此处输入图像描述](../Images/779e198570573491dd1938098e0cb054.png)](https://i.stack.imgur.com/pma5o.png)

# javascript - 滚动时添加文本阴影（jquery 或 javascript）

> ID：14755038
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:01.067
> 
> 标签：javascript, jquery, css

我有这个 html 和 css 代码：

```
<div class="header">

</div>

.header {
    top:0;
    left:0;
    right:0;
    width:100%;
    background:#3b5998;
    height:95px;
    margin-bottom: 50px;
position:fixed;
} 
```

我在这里尝试做的是，每当用户向下滚动时，标题应该位于固定位置（顶部）。对于那件事我没有任何疑问。我轻松地完成了这项任务。

当用户向下滚动时，我想在其上添加不同的样式。当用户向下滚动时，我想在其上添加一个盒子阴影效果，这样它看起来会升高。如果用户向上滚动并到达我网页的顶部，它将恢复为默认的 css 样式（没有框阴影）。

更像是说：

向下滚动 = 激活盒子阴影效果

如果向上滚动并到达顶部 = 还原

我不知道有任何css代码，也许有人会用他们的javascript/jquery专业知识帮助我制作代码？

对不起，如果我的解释太长或有点混乱。非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:44:36.597

像这样试试

```
$(window).scroll(function(){
if (document.body.scrollTop === 0)
     $(".header").css({"box-shadow":"none"});
else
     $(".header").css({"box-shadow":"0px 0px 1px #EEE"});
}); 
```

[见演示仅供参考](http://jsfiddle.net/Dineshkani/xBjFL/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:53:34.297

像这样的东西？

```
var win = $(window),
    doc = $(document),
    header = $('.header');

win.scroll(function(e) {
    var scrollPercent = win.scrollTop() / (doc.height() - win.height()),
        scrollPercentRounded = (scrollPercent * 100).toFixed(2);

    header.css({boxShadow: '0 0 ' + scrollPercentRounded + 'px #000'});
}); 
```

**[演示](http://jsfiddle.net/xBjFL/2)**

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-07T16:07:03.730

使用[此代码](http://fiddle.jshell.net/xBjFL/9/)，您可以获得一个很好的平滑过渡：

```
var $doc = $(document),
    $target = $('.header'),
    limit = 200,
    shadowStyle = '0 2px 5px',
    rgb = '0,0,0';

$(window).scroll(function() {
    var top = $doc.scrollTop();

    if (top <= limit) {
        var opac = 1/limit*top;
        $target.css('box-shadow', shadowStyle+' rgba('+rgb+','+opac+')');
    }
}); 
```

您可以轻松修改阴影样式并`limit`定义它应该淡入/淡出的范围。

# solr - SOLR：如何过滤/不考虑搜索关键字，如“the”、“on”、“in”，这些关键字不会增加任何价值

> ID：14755042
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:11.310
> 
> 标签：solr, stop-words

我是 SOLR 的新手，所以刚刚掌握了一些基础知识。我已经配置了 mm、fq、qf、q 等参数，但问题是当用户搜索“湾区一位优秀的意大利厨师”之类时，搜索结果（排名）会受到“a”等关键字的影响和“在”。

我知道在 SOLR 中有某种设置/配置可以省略某些单词，但我不知道该怎么做。

感谢帮助。我每天都在学习。

PS：我正在使用 edismax

更新 ：

我正在搜索字段信息：

```
field name="information" type="text_general" indexed="true" stored="true" 
```

搜索工作正常，但正在搜索信息以查找一些常见的单词，例如“the”“and”“an”“in”等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T18:40:42.290

您要查找的内容称为“停用词列表”。

您需要指定一个停用词文件，并将 StopFilterFactory 放在您的过滤器列表中。[Solr 文档](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.StopFilterFactory)中的详细信息。

# sql - 在应评估一次的条件下性能显着下降

> ID：14755051
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:33.653
> 
> 标签：sql, postgresql

我有一个问题，即添加一个简单的测试条件（每个查询只应评估一次）导致整个查询需要十倍的时间才能返回。我正在运行 PostgreSQL 9.2，正在运行的表如下：

```
CREATE TABLE tags (
    tid     int4 UNIQUE NOT NULL,
    name    text UNIQUE NOT NULL,
    PRIMARY KEY (tid));

CREATE TABLE bugs (
    bid     int4 UNIQUE NOT NULL,
    type    int2 NOT NULL,
    title   text NOT NULL,
    PRIMARY KEY (bid));

CREATE TABLE bug_tags (
    bid     int4 REFERENCES bugs(bid) NOT NULL,
    tid     int4 REFERENCES tags(tid) NOT NULL,
    PRIMARY KEY (bid, tid));

CREATE INDEX bug_tags_bid_idx ON bug_tags (bid);
CREATE INDEX bug_tags_tid_idx ON bug_tags (tid); 
```

查询必须返回按出价排序的前 20 个匹配错误，其中匹配条件是错误的类型必须符合提供的位掩码（变量 $TYPE），并且与错误关联的标记集必须是提供的超集一组标记名（在准备好的语句中用 $TAGNAMES 表示）。在尝试了几种方法后，下面是产生最佳结果的一种。基本思想是首先获取满足 $TAGNAMES 条件的所有错误，然后针对 $TYPE 条件测试每个错误。此外，如果 $TAGNAMES 为空，那么我们将跳过获取这些错误，而是专注于只循环整个表（因为我们只想要前 20 行，这应该会快得多）。后一种测试是导致令人费解的结果的测试。

```
WITH tids AS
            (SELECT tid
            FROM    tags
            WHERE   name = ANY ($TAGNAMES :: text[])),
    bugs_from_tags AS
            (SELECT DISTINCT t1.bid
            FROM    bug_tags AS t1
            WHERE   NOT EXISTS
                    (SELECT *
                    FROM    tids
                    WHERE   NOT EXISTS
                            (SELECT *
                            FROM    bug_tags AS t2
                            WHERE   t2.tid = tids.tid AND t2.bid = t1.bid)))
SELECT bid, type, title
FROM bugs
WHERE (type & $TYPE <> 0) AND
  (($TAGNAMES :: text[]) = '{}' OR bid IN (SELECT * FROM bugs_from_tags))
ORDER BY bid
LIMIT 20; 
```

没有测试的版本当然是相同的，除了 WHERE 子句，它看起来像这样：

```
WHERE (type & $TYPE <> 0) AND (bid IN (SELECT * FROM bugs_from_tags)) 
```

下面是一个测试数据库（带有随机数据）的近似分析结果，其中包含 1,000,000 个错误、2,000 个标签和 bug_tags 中的 200,000 行。“with”和“without”列指的是带有/不带有空测试的查询版本。数字以毫秒为单位。

```
 with    without
len($TAGNAMES) = 0:         4       1500
len($TAGNAMES) = 1:         13000   1600 
```

显然，当 len($TAGNAMES) = 0 时添加测试条件会带来可观的回报，否则会导致灾难。这令人费解，因为条件独立于每一行，因此只应评估一次。此外，EXPLAIN ANALYZE 的结果（很长）确实表明，在 len($TAGNAMES) = 1 的情况下使用/不使用的计划是非常不同的，尽管它们应该是相同的！

无论如何，我怀疑我偶然发现了 PostgreSQL 查询计划器的一个怪癖（或错误？）。关于如何解决它的任何想法？

**注意：**这两个测试的 EXPLAIN ANALYZE 的结果都 [在这里](http://explain.depesz.com/s/JCD1)和[这里](http://explain.depesz.com/s/p6t)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T07:47:53.717

阅读计划，主要区别在于快速的首先过滤结果然后加入它们。第二个过滤器和嵌套循环连接。

关于慢查询，有两件事让我印象深刻。

首先是它选择了一个糟糕的计划。当您没有足够的内存来确保另一个计划更好时，就会发生这种情况。尝试将 Effective_cache_size 设置得高一点，把 work_mem 设置得高一点。

第二个是慢查询缺少哈希聚合。我建议将 DISTINCT 更改为 GROUP BY，看看这是否有帮助。我的猜测是，在速度较慢的情况下，它可能正在具体化 CTE，然后将查询作为嵌套循环运行。

然而，除了这些以及可能在系统中添加更多内存之外，我没有看到任何让我印象深刻的直接答案。我希望这会有所帮助，如果您在这里无法获得帮助，PostgreSQL 上的 -perform 列表通常非常擅长帮助人们。

# java - Mapred 子错误：AWS EMR 实例已终止

> ID：14755052
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:34.157
> 
> 标签：java, hadoop, amazon-ec2, heap-memory, amazon-emr

当我运行中等类型的 EMR 实例时，我在其中一个步骤中发现 EMR 实例终止了。我在 AWS 中使用了 5 个中型实例。它的容量是 3.75 GB RAM。我将属性 mapred.child.java.opts 的堆大小设置为 3000 MB。我已经使用 JobConf 将其设置为给定的参数，例如 conf.set("mapred.child.java.opts", "-Xmx3000m")。我为 Amazon EMR 程序运行了三个步骤。在最后一步，我遇到了这个问题，java.lang.Throwable: Child Error。工作失败的原因是什么。此外，子节点中的映射器所需的最佳堆大小是多少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:22:47.453

除非你正在做一些特别的事情——3000M 这个数字太高了。你能检查每台机器有多少地图任务hadoop正在运行吗？如果它运行的不止一个 - 它会轻松地摧毁 3.75GB 内存（无论如何，有些内存必须是免费的）。

我们提供 hadoop 即服务（Qubole）。默认情况下（以及在我之前的演出中） - 我们使用 1024M 作为默认值。您将希望将 io.sort.mb 设置为远低于该值（例如 400-500MB）。只有当用户正在做一些特别的事情（比如一个大的地图侧连接）——才有理由把它提高。如果必须增加 - 我们将不得不减少每台机器的最大并发映射任务数（如果它超过一个）。

# grails - Grails REST CRUD 控制器方法

> ID：14755055
> 
> 赞同：3
> 
> 时间：2013-02-07T15:40:37.090
> 
> 标签：grails, grails-controller

我对 Grails 很陌生，尽管我确实有很多使用不同语言（Perl、Python、Ruby）的其他 mvc 框架开发 Web 应用程序的经验。

我试图了解 CRUD 在 grails 中的含义。

基本上，Grails 默认为 create 函数创建以下两种方法：

create，用于显示表单创建保存，用于保存已发布的表单

现在来自不同的框架，我习惯于只有一种创建方法：

create，如果请求方法是 GET，这个函数将显示表单，如果请求方法是 POST，则保存表单，这似乎是大多数框架的首选方式？！？！？

为什么 Grails 会采用完全不同的方法来实现这个功能？我知道我可以手动更改它，但是这样做会有什么影响？我会失去什么，我会得到什么。

我知道这不是一个非常具体的问题，我当然不想引发一场激烈的战争，但我想了解为什么要选择另一种方式......

提前感谢您的分析。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T16:25:35.510

当你生成一个控制器时，它会使用一些带有 {index, list, create, save, show, edit, update, delete} 操作的默认模板。这只是一个起点，或用作参考。

我通常为面向公众的应用程序做的是设置处理基于 HTTP 方法的路由的 URL 映射。有关详细信息，请参阅[http://grails.org/doc/latest/guide/theWebLayer.html#mappingHTTP](http://grails.org/doc/latest/guide/theWebLayer.html#mappingHTTP)。

基本上，这可以让您执行以下操作：

```
static mappings = {
   "/product/$id"(controller:"product") {
       action = [GET:"show", PUT:"update", DELETE:"delete", POST:"save"]
   }
} 
```

在控制器中，动作应该是分开的，因为它们服务于不同的目的。Grails 允许您设置 URL 映射来处理 HTTP 方法路由。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T16:18:29.180

`generate-controller`和生成的代码`generate-all`只是为了方便和建议做什么。但是它会生成到您的应用程序中，因此请根据需要对其进行编辑，或者如果您愿意，可以从头开始编写所有内容。

`create`接受 GET 请求并仅创建新实例并呈现 GSP 以创建实例的操作的替代方法，加上`save`仅接受 POST 请求并执行实际创建的操作（如果实例是`create`同时执行这两种操作的单个方法）：

```
def create() {
   if (request.post) {
      // persist the new instance
   }
   else {
      // render the GSP
   }
} 
```

这需要明确的逻辑来确定要做什么，这会使代码混乱。Grails 采用的方法更简洁，因为每个操作都更加专注并且只做一件事。这具有使测试更容易的额外好处。

如果您发现两个操作之间最终存在共享逻辑，您始终可以将其重构为两者都调用的私有方法。

# android - Android - MapView 和 ScrollView 遇到问题

> ID：14755058
> 
> 赞同：1
> 
> 时间：2013-02-07T15:40:39.150
> 
> 标签：android, android-mapview, scrollview, android-tabhost

现在我遇到了一个非常烦人的问题。我有一个`ScrollView`和里面`ScrollView`我有一个`TabHost`和里面我有一个选项卡`MapView`，问题是使用该配置`MapView`填充整个屏幕而忽略选项卡，我想要的只是填充选项卡下方的空白空间！

我有这样的事情：

```
<ScrollView  xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    tools:context=".MainActivity" 
    android:id="@+id/scroll"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true" > 
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" 
    android:background="@color/white" >

<TabHost ..... >

<MapView ..... />

</TabHost>

</LinearLayout>
</ScrollView> 
```

如果我删除`ScrollView`一切正常，但在这里删除它不是一个选项！

# java - java中的组合框+列表

> ID：14755059
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:43.040
> 
> 标签：java, oracle, swing

在java中，我如何为组合框中的下拉列表定义不同的大小。所以组合框有一个大小，下拉列表有另一个大小，如下所示：

![http://www.thetertulianblog.comyr.com/js/java.jpg](../Images/e259a5a6ad1c933cccef833ff483965c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:56:53.720

从未使用过 Swing，但是这篇[文章](http://tips4java.wordpress.com/2010/11/28/combo-box-popup/)呢？

（在[这里](https://stackoverflow.com/questions/4629015/jcombobox-width)找到）

# ios - 在 iPad 中搜索和突出显示 PDF

> ID：14755061
> 
> 赞同：1
> 
> 时间：2013-02-07T15:40:43.953
> 
> 标签：ios, xcode

我需要在 iPad 中添加 PDF 搜索功能，我有许多 PDF 文件需要根据文本框中的文本输入进行搜索和突出显示。任何人都有图书馆的经验或以前做过吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:01:45.110

你好，这里是苹果开发者文档：[https ://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_pdf_scan/dq_pdf_scan.html#//apple_ref/doc/uid/TP30001066-CH220-TPXREF101](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_pdf_scan/dq_pdf_scan.html#//apple_ref/doc/uid/TP30001066-CH220-TPXREF101)

在quartz中有用于扫描pdf文档的api。在堆栈溢出上搜索 CGPDFScanner，你可以找到一堆建议。

但是，这里真正的答案是，如果您没有可浪费的飞蛾，请不要尝试自己实现 pdf 解析。它会让你发疯。我根据经验说话。Apple 仅提供用于扫描 pdf 标签而不解析它们的 api。这里的问题是 pdf 格式本身的复杂性。这里是文档[http://www.adobe.com/devnet/pdf/pdf_reference.html](http://www.adobe.com/devnet/pdf/pdf_reference.html)它有 800 多页。我已经全部阅读了。例如，如果您想突出显示文本，则必须知道它的位置以及它的表示是某种编码。这些信息很难可靠地恢复。如果我没记错的话，你有两种写文字的方法。其中一种方式有 4 个不同的文本环绕标签，加上七种不同的编码，其中一些必须映射到字体字典，巫婆有许多不同的映射和编码方式。这只是将文本输出为可读字符串。

长话短说，这看起来应该很容易，但相信事实并非如此，我去年调查过它，但找不到可靠的库。我试图自己实现它，一个月后我不得不放弃。除非你有一个团队，否则这将是一项非常艰巨的任务。

# python - 是否有仅运行 .pyc 文件的轻量版 Python？

> ID：14755062
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:44.187
> 
> 标签：python, embed, bytecode

我有包含已编译 Python 字节码的文件。我想通过我的可执行程序运行它们，而不需要 Python 解释器的大量过载。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:42:47.677

pyc 未编译为机器码。为此使用Shedskin。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:33:21.740

你提到了解释器的巨大开销：你有没有证据表明编译步骤是巨大的开销？您可能会误解 .pyc 文件中的内容。Python 字节码不是机器码，它是由 Python 解释器执行的高级字节码。

无论如何，不​​，没有可以运行 .pyc 文件而不是 .py 文件的 Python 版本。

# javascript - 如何重新编写这个与主干相关的脚本以传递模板/视图的名称来加载

> ID：14755063
> 
> 赞同：0
> 
> 时间：2013-02-07T15:40:48.477
> 
> 标签：javascript, templates, optimization, backbone.js, underscore.js

我正在使用 Backbone.js 和 Underscore.js（以及常见的嫌疑人，例如 JQuery 和 require.js）来创建 Web 应用程序。Web 应用程序的部分逻辑涉及加载 HTML 视图/模板。我编写了一个机制（基于在此处和其他地方找到的脚本），如下所示。

```
var some_View = Backbone.View.extend(
    {
        initialize:function(){this.render();},
        render:function(){
                var renderedElement = this.$el.html(something.render("someView"));
            }

    }
)

var someView=new some_View( {el:$("#some_DIV_container")} ); 
```

其中**something.render("someView")**是一种实际进行渲染的方法。该方法执行 AJAX 调用并将加载的结果插入到传递的 DIV (some_DIV_container) 中：

```
// code in the "something" object
render:function(tmpl_name,tmpl_data){
    console.log("loading view..." + tmpl_name);
    // this method renders a view. from the /views folder.
    if ( !this.render.tmpl_cache ) { 
        this.render.tmpl_cache = {};
    }
    if ( ! this.render.tmpl_cache[tmpl_name] ) {
        var tmpl_dir = 'views';
        var tmpl_url = tmpl_dir + '/' + tmpl_name + '.html';
        var tmpl_string;
        $.ajax({
            url: tmpl_url,
            method: 'GET',
            dataType:'html',
            async: false,
            success: function(data) {
                tmpl_string = data;
            }
        });
    this.render.tmpl_cache[tmpl_name] = _.template(tmpl_string);
    }
    console.log(" this.render.tmpl_cache[tmpl_name](tmpl_data) = "+ this.render.tmpl_cache[tmpl_name](tmpl_data));      
    return this.render.tmpl_cache[tmpl_name](tmpl_data);
} 
```

代码就像一个魅力，除了每次我创建一个新视图时，我必须创建一些扩展 Backbone.View 的变量，并创建另一个扩展 Backbone.View 的变量。换句话说，要加载的 HTML 文件的名称“someView”是静态的。我想将 HTML 模板的名称传递给*动态*加载。我只是看不到如何以 some_View 的编写方式传递参数。

我认为（看起来）

*   Backbone.View.Extend() 返回一些函数对象
*   我们使用*el*将 jQuery 引用传递给要插入 HTML 模板/视图代码的容器
*   当“some_View”被渲染时，我们调用something.render，它将HTML加载并返回到this.$el的html()方法中，我相信这本质上是我想要插入内容的已解析的div。内容被插入。

所以简而言之，我想优化这段代码，这样我就不必在每次想要创建视图时重复创建扩展backbone.view.extend 的变量并实例化它。

有什么想法吗？这是一个代码难题！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:44:49.070

所以你想为所有视图重用相同的视图构造函数？似乎这仅适用于不会更改或没有用户输入的非常简单的视图。但是你也许可以做这样的事情，只需在创建视图时传入你想要使用的模板。

```
var some_View = Backbone.View.extend(
    {
        initialize:function(options){
            this.templateName = options.templateName;
            this.render();
        },
        render:function(){
                var renderedElement = this.$el.html(something.render(this.templateName));
            }

    }
)

var someView=new some_View( {el:$("#some_DIV_container"), templateName: 'someTemplate'} ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:26:08.017

这是我使用的相关代码。（我也用Base.js做了一个类）

```
// this method is part of a javascript class called qq

var qq = Base.extend({

///other stuff///

render:function(tmpl_name,tmpl_data){
    console.log(" render(): rendering view " + tmpl_name + ".html");

    if ( !this.render.tmpl_cache ) { 
        this.render.tmpl_cache = {};
    }
    if ( ! this.render.tmpl_cache[tmpl_name] ) {
        var tmpl_dir = 'views'; // your directory
        var tmpl_url = tmpl_dir + '/' + tmpl_name + '.html';
        var tmpl_string;
        $.ajax({
            url: tmpl_url,
            method: 'GET',
            dataType:'html',
            async: false,
            success: function(data) {
                tmpl_string = data;
            }
        });
    this.render.tmpl_cache[tmpl_name] = _.template(tmpl_string);
    }

    return this.render.tmpl_cache[tmpl_name](tmpl_data);
}

});

var q=new qq(); // where the method above comes from
// define some initial parameters

q.viewParams={
    initialize:function(options){console.log("viewName = "+this.options.viewName);this.renderIt();},
    renderIt:function(){
        var renderedEl= this.$el.html(q.render(this.options.viewName));
        } 
    };

// load the recipient view
var x = Backbone.View.extend( q.viewParams );
q.recipientView = new x( {el:q.recipientBoxEl,viewName:"someView"}  ); 
```

# python - 我们的开发人员应该如何使用 Jenkins 测试 python SVN 分支？

> ID：14755065
> 
> 赞同：4
> 
> 时间：2013-02-07T15:40:59.397
> 
> 标签：python, svn, jenkins, continuous-integration, release

我正在与 7 个开发人员一起开发一个 Web 项目。我设置了一个 beta 盒（debian），以便我们可以在将新代码传递给暂存之前对其进行测试。

在 beta 盒子上，我设置了 Jenkins，并希望自动化合并/测试过程。我们还有一个测试套件，我想以某种方式配合它。

我应该如何使用 SVN / Jenkins 测试和运行 python web 项目？

我正在尝试制定一个好的工作流程。现在每个开发人员都在一个功能分支上工作，我在分支中运行代码，如果看起来不错，我们将其合并。

我希望开发人员登录到 beta jenkins，并告诉它从他们的功能分支构建。这是我对 Jenkins 将做的事情的计划：

1.  确保功能分支是从主干重新建立的
2.  确保 beta 分支与主干相同（覆盖任何合并的功能分支）
3.  将功能分支合并到 beta 分支
4.  杀死正在运行的服务器
5.  启动服务器`nohup python app.py &`
6.  运行测试套件`python test.py`
7.  将测试数据输出到Jenkins中的开发者视图
8.  如果任何测试失败，则恢复到分支合并之前的状态

我不确定如何处理合并冲突。此外，上述内容可能是坏的和错误的。任何意见，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T08:58:35.560

这个问题有点太大了，无法在一个简单的帖子中回答，因此我将尝试提供一些提示和参考，就我个人的观点而言：

一些快速提示：

*   我喜欢将开发人员分成多个分支的想法，但我会在功能分支上进行测试，并且只有在功能通过测试时才合并到 beta 分支，这样在测试之前不会进入 beta ！
*   我会将集成步骤放入 Jenkins 之外的脚本中。使其成为源代码的一部分。这样您就可以在 Jenkins 之外快速测试脚本本身
*   使用您最熟悉的构建系统或脚本语言，大多数步骤都可以使用任何编程语言轻松完成
*   使脚本返回成功或失败，因此 Jenkins 可以将构建标记为失败
*   对于合并问题，您有两种可能性
    *   要求在开发人员提交之前手动重新设置分支以进行集成，签入脚本并在需要重新设置时失败。这种方式不会发生合并错误，如果分支没有重新定位，则构建只会失败
    *   如果您宁愿允许非变基合并，则需要在合并错误时使构建失败，以便开发人员可以手动解决问题（通过在再次提交之前变基他/她的分支）

这里有一些我发现在这方面有用的书：

*   Google 如何测试软件，作者：James A. Whittaker、Jason Arbon、Jeff Carollo
*   持续交付：通过 Jez Humble 的构建、测试和部署自动化实现可靠的软件发布

通过评论让我知道您希望拥有哪些其他内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T10:16:15.133

有几件事：

*   正如 barracel 建议的那样——使用一些 DVCS 会更方便——这样的 git 可以更好地准备在多个分支中工作。
*   恕我直言，合并过程是您不想自动化的事情（我写这个是指“如何处理合并冲突”）。在我过去工作的工作流程中 - 合并总是由人工处理，有时需要进行某种代码审查（我不确定'如果它看起来不错'是什么意思 - 你是否只验证功能或它是如何实现的有方向吗？
*   除了单元测试之外 - 在每次合并到 beta 分支后启动一些功能测试（Selenium）和性能测试（jmeter 或 tsung） - 这样您还将跟踪应用程序如何随着开发而变化（并可能及时做出反应 -例如，如果您会注意到登录页面期间的性能下降。
*   这是微不足道的事情，但是在单独的分支上工作时 - 确保信息流，这样你就可以避免在不同的分支中开发相同的部分，或者在使用的解决方案/模式/库中变得矛盾。什么可能有帮助 - 发送失败的电子邮件（给失败的开发人员）和成功合并到主干后的每个人 - 所以每个人都会被通知（但确保你没有向开发人员发送垃圾邮件 - 他们会停止阅读它；）
*   如果你真的有很多合并冲突 - 也许是时候重新考虑流程并尽量减少分支数量，有趣的阅读[http://lostechies.com/derickbailey/2010/02/24/branching-strategies-the-cost-of -branching-and-merging/](http://lostechies.com/derickbailey/2010/02/24/branching-strategies-the-cost-of-branching-and-merging/)或抽象分支[http://paulhammant.com/blog/branch_by_abstraction.html/](http://paulhammant.com/blog/branch_by_abstraction.html/)
*   Make sure that developers are pulling and merging trunk to their branches often - it should also help with reducing conflicts, or even
*   Why not test directly on developer branches after merging from trunk? Such merged code, once again should be easy to merge back into the trunk

# c++ - 理解堆栈数据结构并实现它

> ID：14755068
> 
> 赞同：0
> 
> 时间：2013-02-07T15:41:07.443
> 
> 标签：c++, stack

请看下面的代码

```
template <typename T>

class Stack
{
public:
    Stack(int number)
    {
        maxSize = number;
        top = -1;
        stackData = new T*(maxSize);
    }

    ~Stack()
    {
        delete [] stackData;
    }

    int count()
    {

    }

    bool isEmpty()
    {
        if(top==-1)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    bool isFull()
    {
        if(top== (maxSize-1))
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    *T pop()
    {
        if(!isEmpty())
        {
            return stackData[top--]; // Remove Item From Stack
        }
    }

    *T peek();

    void push(T *pushValue)
    {
        if(!isFull())
        {
            stackData[++top] = pushValue;
        }
    }

private:
    int maxSize;
    T ** stackData;
    int top;
}; 
```

在上面的代码中，注释行说“从堆栈中删除项目”。但实际上，它不是删除，它只是提供一个值，它是一个值，对吧？在这里，我将删除称为从堆栈中完全破坏该特定值。

例如：在包含数据 1、2、3、4 的数组中，我删除了“2”。所以现在是 1,3,4

其次，“peek()”方法内部应该发生什么？

第三，有没有我没有发现的错误？

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:44:22.370

他们使用一个数组作为堆栈。实际上 top 指向堆栈中的顶部元素。所以当你这样做时：

```
return stackData[top--]; 
```

顶部减小，因此堆栈的大小**确实**减小了。你真的弹出一个元素。

`peek`应该返回堆栈顶部的当前元素 - 弄清楚如何自己做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T15:47:08.560

`top`从概念上讲，递减和“删除”顶部项目之间没有区别。“移除”一词是一个概念抽象，用于描述堆栈中的顶部项目不再是堆栈中的元素的想法。它并没有从内存中的那个位置逐字删除这一事实是无关紧要的。

如果你的意思是你想“销毁”顶层项目，即*调用它的析构函数并释放它*，你需要考虑你的`Stack`类如何管理内存的更大影响。如果堆栈应该拥有每个`T`对象的所有权，并且每个`T`对象都已使用 分配`new`，那么您可以在递减之前让您的`pop()`函数`delete`成为顶部项目`top`。（但`pop()`不能返回指向已删除元素的指针。）如果堆栈*不*拥有每个项目的所有权，则由调用者`pop()`来管理元素的生命周期/解除分配。

接下来，该`peek()`方法仅返回指向顶部项目的指针，而不将其从堆栈中删除。

最后，您没有正确分配`T*`指针数组。语法应该是：

```
stackData = new T*[maxSize]; 
```

您发布的代码在后面使用括号`new`而不是括号，这不是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:47:43.480

1)`pop`确实弹出一个元素，但它会保留在数组中，直到有东西被推过它。但是你已经改变`top`了，所以堆栈不再“知道”它在那里了。如果是复杂类型，则不会调用析构函数`pop`。

2)`peek`通常显示堆栈顶部而不弹出它。

3）您不验证`number`构造函数的参数。

`isFUll()`此外，您可以简单地编写`{ return (top== (maxSize-1));}`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T15:47:52.630

你确定这是正确引用：

```
stackData = new T*(maxSize); 
```

不应该是：

```
stackData = new T*[maxSize]; 
```

你是对的，pop 方法不会“破坏”数据，它只是将堆栈的顶部移动到下一个位置（从顶部元素到顶部的第二个元素）。我不确定您为什么要“从堆栈中销毁特定值”……通常，这没有任何意义。

此外，您所描述的“删除中间的东西”并不是您通常对堆栈所做的事情 - 这是一个列表、双端队列或类似的东西。

至于编写一个 peek 函数，它将涉及与 几乎相同的步骤`pop`，除了你不移动`top`...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T15:48:00.473

这个想法是索引大于索引的每个元素`top`都是无效的，而索引小于顶部的任何元素都是有效的。通过减少顶部，您正在删除一个元素，通过增加顶部，您正在添加一个元素。

# reporting-services - SSRS 2005 按列名值排序矩阵

> ID：14755069
> 
> 赞同：1
> 
> 时间：2013-02-07T15:41:14.880
> 
> 标签：reporting-services, reportingservices-2005

组，我正在创建一个基于多维数据集的 SSRS 报告，它动态生成（在某种意义上）三列。基本上它有 [Last Yes Current Month Qty Sold]、[This Year Current Month Qty Sold]，然后是 [Variance]（图表 1）。我想要做的是根据方差列降序对“产品”组进行排序（图 2）。它最初按 [Product Group #] 排序。

（图一）

![在此处输入图像描述](../Images/c43ed391ceeeb9e6fb0d334235c4289b.png)

（图 2）

![在此处输入图像描述](../Images/c86c4dfe697722679dcb6ee1a8ce6127.png)

非常感谢任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:33:16.277

我生成了一个示例数据集（仅通过查询）来测试它，但原理应该是相同的。

您需要将排序表达式应用于仅考虑总*方差*并忽略其他列的矩阵行组。

您可以使用类似于以下的表达式：

```
=SUM(IIf(Fields!col.Value = "Variance", Fields!val.Value, 0)) 
```

您可以看到这仅根据需要计算*方*差值。

将此应用于行组排序表达式：

![在此处输入图像描述](../Images/5a00f13233473d37c3404e3f6901751c.png)

单击**编辑**，然后单击**排序**，然后添加排序表达式。

![在此处输入图像描述](../Images/518fd99246b12085060e4e03e6ded320.png)

最后结果：

![在此处输入图像描述](../Images/5faae42c0144eb60a2b2d1642eb0eac7.png)

根据需要按*方差*排序。

# git - git：可以在重命名时合并处理副本吗？

> ID：14755071
> 
> 赞同：2
> 
> 时间：2013-02-07T15:41:19.227
> 
> 标签：git, version-control, merge

在 mercurial 中，我可以`hg copy`创建一个文件，当我在旧分支中更改原始文件并将其合并到当前分支时，文件的原始文件**和副本都将更改合并到**.

我知道 git 在合并时可以很好地处理重命名。如果我将文件重命名`originalfile`为`newfile`，在一个分支中对 to 进行更改`originalfile`并将该分支合并，那么 git 会将`originalfile`对`newfile`.

我不能让它做的是处理副本。据说 Git 可以检测副本，但是如果我**复制** `originalfile`到`newfile`并执行与上面相同的合并，那么只会`originalfile`更改，而不是副本。

在这方面有没有办法让 git 像 mercurial 一样工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:08:36.027

合并是在每个分支的基础上进行的。由于文件副本位于不同的分支上，Git 将它们视为不同的文件以进行合并。*（一次只能合并到一个分支。）*

# maven - Maven：如何将配置文件参数传递给 POM 中的子模块

> ID：14755077
> 
> 赞同：0
> 
> 时间：2013-02-07T15:41:46.663
> 
> 标签：maven

我从一位同事那里继承了一个代码库，我正在考虑优化一些东西。

1) 其中一个问题是他使用本身就可以的 WSDL 生成了一些代码。然而，不是他有一个 dev、test 和 prod 文件夹，其中包含实际模块，只有 WSDL 文件不同。现在我想到的第一件事是创建一个模块并添加 3 个包含`cxf-codegen-plugin`插件配置的配置文件。

2）然而，这带来了一个我想解决的额外问题，目前他首先构建子模块，以便将其安装到 .m2 存储库，然后使用根 pom 构建其余部分（它没有将 WSDL 模块定义为一个模块，所以它不会被构建）。我想修复它，这样当我在根 pom 上进行全新安装时，也会再次生成实际的类。但是我不太确定如何做到这一点，我真的找不到实现这一目标的方法。

3）或者你会解决问题1，然后跳过2？

# mysql - 带有 Postgres 数据的 Rails 乱序返回

> ID：14755079
> 
> 赞同：4
> 
> 时间：2013-02-07T15:41:51.410
> 
> 标签：mysql, ruby-on-rails, postgresql, rails-activerecord

我刚刚将我的应用程序从 MySQL 转换为 Postgres。以前，对 .all 的请求会按 id 顺序返回所有行。在 Postgres 上，行被乱序返回。同样地，

```
Person.first 
```

以前返回 id 为 1 的记录，现在有时返回另一条记录。

如果我添加这样的 order 子句：

```
Person.order("id").first 
```

查询成功并返回第一行。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:50:47.857

[这篇文章](https://stackoverflow.com/questions/4986496/activerecord-find-all-not-sorting-by-id)回答了你的问题：

> 我认为默认情况下不能保证按 ID 排序，因为我相信如何返回无序查询取决于数据库。您可以通过在模型顶部定义默认范围来对其进行排序，如下所示：
> 
> ```
> default_scope order('id ASC') 
> ```
> 
> 然后调用 Model.all 将等效于调用 Model.order('id ASC')。

# c# - 如何使这个结构更智能

> ID：14755088
> 
> 赞同：0
> 
> 时间：2013-02-07T15:42:01.120
> 
> 标签：c#, .net

我有这个结构，它是一个类的一部分。

```
 public struct PartStruct
    {
        public string name;
        public string filename;
        public string layer2D;
        public string layer3D;
        public TypeOfPart type;
        public int hight;
        public int depth;
        public int length;
        public int flooroffset;
        public int width;
        public int cellingoffset;
    } 
```

这个结构的每个实例将代表一个具有不同属性的部分，我只使用一种结构类型，因为我有这个功能：

```
public void insert(Partstruct part){//large code to insert the part} 
```

例子：

```
Partstruct monitor = new Partstruct();
monitor.name = "mon1";
monitor.file = "default monitor file name.jpg";//this is a const for each new monitor
monitor.TypeofPart = monitor;
monitor.layer2d = "default monitor layer";//this will be the same for each new monitor. 
```

ETC..

```
Partstruct keyboard= new Partstruct();
keyboard.name = "keyboard1";
keyboard.file = "default keyboard file name.jpg";//this is a const for each new keyboard
keyboard.TypeofPart = keyboard;
keyboard.layer2d = "default keyboard 2d layer";//this will be the same for each new keyboard.
keyboard.layer3d = "default keyboard 3d layer"//this will be the same for each new keyboard. 
```

ETC..

```
insert(monitor);
insert(keyboard); 
```

我能以更聪明的方式做到这一点吗？我正在使用.net 3.5

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:52:31.943

在我看来，在这种情况下，您可以从一些继承中受益。由于 part 是通用类型，并且您有更具体的类型，例如 Monitor 和 Keyboard，因此它是继承的完美示例。所以它看起来像这样：

```
public class Part
{
    public virtual string Name { get { return "not specified"; } }
    public virtual string FileName { get { return "not specified"; } }
    public virtual string Layer2D { get { return "not specified"; } }
    public virtual string Layer3D { get { return "not specified"; } }
    ...
}

public class Monitor : Part
{
    public override FileName { get { return "default monitor"; } }
    public override Layer2D { get { return "default monitor layer"; }}
    ...
} 
```

和

```
public class Keyboard : Part
{
    public override FileName { get { return "default keyboard filename.jpg"; } }
    public override Layer2D { get { return "default keyboard 2d layer"; }}
    ...
} 
```

您会在 Inheritance 上找到很多资源，我强烈建议您查看它们，因为它们将显着提高您的生产力和效率。这是一个例子： http: [//msdn.microsoft.com/en-us/library/ms173149 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms173149(v=vs.80).aspx)

# android - 如何在启动器图标下更改名称

> ID：14755090
> 
> 赞同：6
> 
> 时间：2013-02-07T15:42:06.410
> 
> 标签：android, eclipse, label

我没有找到一个准确的答案来了解如何在和 android 应用程序（使用 Eclipse）的启动器图标下更改名称。

我尝试在应用程序（清单）中编辑“@string/app_name”，但它不起作用。现在在 MainActivity.java 中，它在这一行中给出了错误“R 无法解析为变量”： `getMenuInflater().inflate(R.menu.activity_main, menu);`

如果在应用程序内的@string/ 中写回“app_name”，它也会返回此错误。我要疯了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T15:45:02.360

寻找`android:label`里面`<Activity>`有

```
<category android:name="android.intent.category.LAUNCHER" /> 
```

内部`<intent-filter>`并更改其值：

```
<activity
    android:name=".Activity_1_1_Splash"
    android:label="@string/app_name"
    android:screenOrientation="portrait" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

如果您想更改资源值，[@pratik 的回答](https://stackoverflow.com/a/14755259/156869)将指导您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T15:51:03.097

打开`res/values/strings.xml`

改变这一行，

```
<string name="app_name">default app name</string> 
```

使用您想要的应用名称

```
<string name="app_name">your desired name</string> 
```

不要在`manifest`文件中进行更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-03T11:23:31.863

如果您想在启动器图标下更改应用程序名称，`android:label="@string/app_name"` 请在主启动器活动标签内更改此名称

```
 <activity android:name="com.test.app"
                  android:label="@string/app_name" >
                  <intent-filter>
                    <action android:name="android.intent.action.MAIN" />
                    <category android:name="android.intent.category.LAUNCHER" />
                  </intent-filter>
        </activity> 
```

如果你想在里面更改应用名称

> 设置 -> 应用程序管理器 -> 已下载

您已安装所有应用程序的位置，然后`android:label="@string/app_name"` 在应用程序标签内更改此内容

```
<application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

            ........

        <activity android:name="com.test.app" >
        </activity>

             .......

 </application> 
```

# c# - yz Vector3 到 Vector2

> ID：14755094
> 
> 赞同：1
> 
> 时间：2013-02-07T15:42:19.163
> 
> 标签：c#, vector, unity3d

简单的问题，网上找不到答案。

有没有一种简单的方法可以将 Vector3 的 Y、Z 转换为 Vector2 而无需创建“new Vector2()”

就像是

```
Vector3 v = Vector3.one;
Vector2 plan = v.yz; 
```

（在 Unity3d 中使用 C# 的所有内容）Thx

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T17:00:03.877

C# 有一个很酷的特性，叫做[扩展方法](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)。例如，设置一个类 VectorExtensions 并将以下代码放入：

```
public static Vector2 YZ (this Vector3 v) {
    return new Vector2 (v.y, v.z);
} 
```

现在您可以从项目中的任何地方调用：

```
Vector2 v2 = v3.YZ (); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T21:47:10.940

不，如果这是你想要的，你不能避免创建一个新的 Vector2，因为它是与 Vector2 不同的对象，并且它们不能以任何方式相互分配。Kay 的扩展方法将为您提供您正在寻找的语法，但如果您只是关心在更新循环或其他东西中分配内存/新对象，那么您就不走运了。

如果您可以完全控制 Vector3 和 Vector2 类，我想您可以让 Vector3 从 Vector2 继承并添加 x 组件；那么您就可以将 Vector3 转换为 Vector2 （将子类视为父类）并且仅使用 y & z 组件。但是，您可能在一个将返回它自己的 Vector3 类的 Unity 库中工作，无论如何，这种继承黑客无论如何都是一个愚蠢的想法。此外，它会迫使您只获得 y&z 组件；如果你想要 z&x 或 x&y ...好吧，你会再次回到 new Vector2() 。

# json - 如何在ajax自动完成中解析solr建议组件json响应？

> ID：14755096
> 
> 赞同：-1
> 
> 时间：2013-02-07T15:42:22.917
> 
> 标签：json, solr

您好，我正在尝试在搜索框中解析 solrSuggester 查询输出，但没有得到准确的结果。请帮忙…………

```
 $(document).ready(function() {
            $( "#searchterm" ).autocomplete({
                source: function( request, response ) {
                    var text = $("#searchterm").val();
                    $.ajax({
                        url: 'http://localhost:8983/solr/collection1/suggest?wt=json&indent=true&spellcheck=true&spellcheck.q='+request.term+'&spellcheck.onlyMorePopular=true&spellcheck.count=50&start=0&rows=10',
                        dataType: "jsonp",
                        jsonp: 'json.wrf',
                        type:'GET',
                        contentType: "application/json; charset=utf-8",
                        crossDomain: true,
                        success: function(data) {
                            response( $.map(data.spellcheck.suggestions, function(item,i) {
                                return {
                                    label: item.suggestion,
                                    value: item.suggestion
                                }                                             
                            }));
                        }                      
                    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:20:43.147

在看到数据的 console.log 之后，您的迭代元素值为

```
"[ "ajax",{ "numFound":1, "startOffset":0, "endOffset":4, "suggestion":["ajaxs"]}, "sup",{ "numFound":10, "startOffset":5, "endOffset":8, "suggestion":["super", "supercoppa", "supercup", "superleague", "superstar", "supervisor", "supoporter", "suporter", "suporters", "supusepa"]}]" 
```

您必须在建议上更深入地工作。

# graphiti-js - 如何在 draw2dTouch/Graphiti 中设置 z-index？

> ID：14755097
> 
> 赞同：0
> 
> 时间：2013-02-07T15:42:24.663
> 
> 标签：graphiti-js, draw2d-js

我可以在 draw2dTouch/Graphiti 中设置任何形状或元素的 z-index。请尽快帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T10:42:29.133

如果我没记错，那么您不能明确设置 z 顺序。但它会导致您放置元素的顺序。

# nhibernate - 在几乎相同的查询中获得多个结果

> ID：14755098
> 
> 赞同：1
> 
> 时间：2013-02-07T15:42:28.010
> 
> 标签：nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我在 FNH 中有两个非常相似的查询，作用于类似的类，Project 和 Foo。Foo 只是一个从 Project 派生的新本地类。它的 classMap 也是从 Project 的 classMap 派生的。

```
 public class Foo:pcm.Domain.Project { }
    public class FooMap : pcm.Mappings.ProjectMapBase<Foo> { } 
```

这是我的查询，使用相同的会话：

```
 var list = session.Query<Project>()
            .Take(10)
            .ToList();

        var list2 = session.Query<foo>()
            .Take(10)
            .ToList();

        Assert.Equal(list.Count(),list2.Count()); 
```

断言失败，因为 list 有 30 个元素，而 list2 有 10 个。确实只有 10 个项目。

**编辑**：这是基础的映射，它位于它自己的 DLL 中。

```
public class ProjectBaseMapTemplate<T> : ClassMap<T> where T: ProjectBase
{
    public ProjectBaseMapTemplate()
    {
        Table("proj");
        Id(x => x.MasterKey, "master_key");
        Map(x => x.ProjectName).Column("project_name");
        Map(x => x.ProjectTitle, "project_title");
    }
}
public class ProjectBaseMap : ProjectBaseMapTemplate<ProjectBase> { } 
```

这是派生类，它位于另一个 DLL 中。将类分离到 DLL 中对于我需要如何使用 FNH 至关重要。

```
 public class Foo:pcm.Domain.ProjectBase 
    {
            public virtual int ProjectState{ get; set; }
    }
    public class FooMap : pcm.Mappings.ProjectBaseMapTemplate<Foo> 
    {
        public FooMap()
        {
            Map(x=> x.ProjectState).Column("project_state");
        }
    } 
```

**更新**这里是 ProjectBase

```
public class ProjectBase
{
    public virtual string MasterKey { get; set; }
    public virtual string ProjectName { get; set; }
    public virtual string ProjectTitle { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:17:50.947

当您使用`Take(10)`函数时，将根据您的 RDBMS 功能运行基础全选查询
然后将返回前 10 个结果（**分页**）

由于您不使用**ORDER BY**表达式，因此由于分页和 RDBMS 功能，相同的查询将导致多次执行不同。

希望有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:05:05.693

它可能与此有关：

> (10) 多态性（可选，默认为隐式）：确定是使用隐式还是显式查询多态。
> 
> 隐式多态性意味着类的实例将由命名任何超类或实现的接口或类的查询返回，并且类的任何子类的实例将由命名类本身的查询返回。显式多态性意味着类实例将仅返回显式命名该类的查询，并且命名该类的查询将仅返回在此声明中映射为 a 或 的子类的实例。对于大多数目的，默认值 polymorphism="implicit" 是合适的。当两个不同的类映射到同一个表时，显式多态很有用（这允许“轻量级”类包含表列的子集）。

因此，您可以使用以下方法修复映射：`Polymorphism.Explicit();`

前任。

```
public class FooMap : pcm.Mappings.ProjectBaseMapTemplate<Foo> 
{
    public FooMap()
    {
        Polymorphism.Explicit();
        Map(x=> x.ProjectState).Column("project_state");
    }
} 
```

# jqgrid - jqgrid 返回到相同的网格页面。

> ID：14755109
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:18.920
> 
> 标签：jqgrid

我正在将 jqGrid 与 c# MVC 一起使用

我有一个场景，我单击记录，然后需要打开一个网页，用户可以在其中修改该记录的信息。我将页面 # 传递给该页面。

我的问题是，当我完成该页面时，我想回到我之前所在的同一页面上的网格。

是否有一个示例说明如何将页面 # 传递给网格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:20:29.520

我认为实现要求的最简单方法就是在`localStorage`Web 浏览器中实现网格状态的保存。我发布[了答案](https://stackoverflow.com/a/8436273/315935)，然后发布了一些具有相同想法的其他答案（例如[，您可以使用查询](https://stackoverflow.com/search?q=user:315935%20localStorage)来查看答案）。

# java - Spring 集成：使用有序订阅者对发布/订阅频道进行异常处理

> ID：14755112
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:25.037
> 
> 标签：java, spring, spring-integration, enterprise-integration

给定一个配置了任务执行器的发布-订阅通道，如果抛出异常，是否可以中断对其有序订阅者的调用？

例如，在此示例中，“工作”消息仍由序列中的第二个服务激活器发送。我希望这不会发生。

```
 <int:publish-subscribe-channel id="input" task-executor="taskExecutor" />

    <int:service-activator
        input-channel="input"
        order="1" 
        expression="1 / 0" 
        output-channel="nullChannel"
    />
    <int:service-activator
        input-channel="input"
        order="2" 
        expression="'worked'" 
        output-channel="output"
    />

    <int:channel id="output">
        <int:queue />
    </int:channel> 
```

现实世界的用例稍微复杂一些，因为 a`File`发布给两个订阅者，一个用于解析它的内容，另一个用于归档到 S3。应用一个序列，以便在两个任务完成后可以聚合和删除它们。

S3 上传是通过一个不返回回复的出站通道适配器实现的。因此，有一个发布-订阅通道首先调用 S3 适配器（使用`order`属性），然后将其发送`File`到网桥，然后将其放置在收集聚合消息的通道上。

如果 S3 上传失败，我不希望文件被删除，因此不能调用上行通道的第二个订阅者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:06:13.930

添加任务执行器时，“order”属性实际上没有任何意义，因为这两个任务都是异步执行的；中断“第二个”线程可能为时已晚。要回答您的一般问题，不，一个线程的失败不会中断其他线程。

如果我正确理解您的用例，您应该能够使用新的 2.2`<request-handler-advice-chain/>`功能做您想做的事，您可以在其中添加一个`ExpressionEvaluatingRequestHandlerAdvice`以根据成功或失败采取不同的操作。这在本博客中进行了讨论...... [http://blog.springsource.org/2012/10/09/spring-integration-2-2-retry-and-more/](http://blog.springsource.org/2012/10/09/spring-integration-2-2-retry-and-more/)，特别是它引用的示例代码（对于ftp 适配器）...

```
<int-ftp:outbound-channel-adapter
    channel="inputChannel"
    session-factory="mockSessionFactory"
    remote-directory="foo">
    <int-ftp:request-handler-advice-chain>
        <bean class="org.springframework.integration.handler.advice.ExpressionEvaluatingRequestHandlerAdvice">
            <property name="onSuccessExpression" value="payload.delete()" />
            <property name="successChannel" ref="afterSuccessDeleteChannel" />
            <property name="onFailureExpression" value="payload.renameTo(payload.absolutePath + '.failed.to.send')" />
            <property name="failureChannel" ref="afterFailRenameChannel" />
        </bean>
    </int-ftp:request-handler-advice-chain>
</int-ftp:outbound-channel-adapter> 
```

# actionscript-3 - AS3 中的动态文本框未更新

> ID：14755114
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:30.827
> 
> 标签：actionscript-3, flash, actionscript, flash-cs5

我正在使用 Actionscript 3 开发 Flash MP3 播放器。我在舞台上的播放、暂停等按钮旁边有一个实例名称为“timerText”的动态文本框。

使用当前分钟和秒更新 timerText 字段的代码是从一个名为 onEnterFrame 的函数调用的，该函数附加到 EnterFrame 事件侦听器。

我已经在动态文本框中嵌入了字体，当我调用跟踪函数从动态文本框中打印出当前文本时，它会打印出应有的时间。然而，文本框本身并没有改变。

我的时间轴中有 1 帧，附有以下操作：

```
import flash.media.Sound;
import flash.media.SoundChannel;
import flash.media.SoundLoaderContext;
import flash.events.MouseEvent;
import flash.net.URLRequest;
import flash.events.Event;

// Stop the Player
stop();

/**
* Declare some Variables
*/

// Get the MP3 File
var req:URLRequest = new URLRequest('audio/alice-track-1.mp3');

// Create a Sound Object
var snd:Sound = new Sound();

// Create a Sound Channel
var channel:SoundChannel;

// Initialise the Pause Position
var pausePosition:int = 0;

// Boolean for Is Playing(?)
var isPlaying:Boolean = false;

// Set the Play Buffer to 5 Seconds
var context:SoundLoaderContext = new SoundLoaderContext(5000, true);

// Load the Requested URL into the Snd Var, along with the Context
snd.load(req, context);

// Create the Play Channel
channel = snd.play();

// Set IsPlaying to TRUE initially
isPlaying = true;

/**
* Play Music Function
*/
function playSound(event:MouseEvent):void {
    if (isPlaying == false) {
        channel = snd.play(pausePosition);
        isPlaying = true;
    }
}

/**
* Stop Music Function
*/
function stopSound(event:MouseEvent):void {
    channel.stop();
    pausePosition = 0;
    isPlaying = false;
}

/**
* Pause Music Function
*/
function pauseSound(event:MouseEvent):void {
    pausePosition = channel.position;
    channel.stop();
    isPlaying = false;
}

// Add the Button Event Listeners
playBtn.addEventListener(MouseEvent.CLICK, playSound);
stopBtn.addEventListener(MouseEvent.CLICK, stopSound);
pauseBtn.addEventListener(MouseEvent.CLICK, pauseSound);

// Add the OnEnterFrame Event Listener
addEventListener(Event.ENTER_FRAME, onEnterFrame);

/**
* Initialisation / OnEnterFrame Function
*/
function onEnterFrame(event:Event):void {
    var totalSeconds:Number = channel.position / 1000;
    var minutes:Number = Math.floor(totalSeconds / 60);
    var seconds = Math.floor(totalSeconds) % 60;

    if (seconds < 10) {
        seconds = '0' + seconds;
    }

    timerText.text = (minutes + ':' + seconds);
trace(timerText.text);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T11:17:54.807

通过查看这个，我看到“分钟”和“秒”是数字，而不是字符串。

我认为这会给你一个错误，但你总是可以尝试

```
timerText.text = String(minutes) + ":" + String(seconds); 
```

这会将数字转换为字符串并允许它们显示在文本字段中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:10:38.953

这可能是字体嵌入问题。

请确保您已启用字体嵌入选项中的全部按钮。看看这张图片 - [http://i.imgur.com/F5ufM.png](http://i.imgur.com/F5ufM.png)

另外，请确保字体颜色与背景颜色不同。

# python - 使用 Python 和 Pandas 实现经典的鞅

> ID：14755116
> 
> 赞同：7
> 
> 时间：2013-02-07T15:43:37.650
> 
> 标签：python, numpy, pandas

我想在投注系统中使用 Python 和 Pandas 实现经典的马丁格尔。

假设这个 DataFrame 是这样定义的

```
df = pd.DataFrame(np.random.randint(0,2,100)*2-1, columns=['TossResults']) 
```

所以它包含折腾结果（-1=输 1=赢）

我想用经典的马丁格尔改变赌注（我每次下注的金额）。

初始赌注为 1。

如果我失去赌注将是之前赌注的 2 倍（乘数 = 2）。

如果我赢了赌注将是stake_initial

我做了一个功能

```
def stake_martingale_classical(stake_previous, result_previous, multiplier, stake_initial):
    if (result_previous==-1): # lose
        stake = stake_previous*multiplier
    elif (result_previous==1):
        stake = stake_initial
    else:
        raise(Exception('Error result_previous must be equal to 1 (win) or -1 (lose)'))
    return(stake) 
```

但我不知道如何使用 Pandas 有效地实现它。我试过这个：

```
initial_stake = 1
df['Stake'] = None
df['Stake'][0] = initial_stake
df['TossResultsPrevious'] = self.df['TossResults'].shift(1) # shifting-lagging
df['StakePrevious'] = self.df['Stake'].shift(1) # shifting-lagging 
```

但现在，我需要沿 0 轴应用这个（多参数）函数。

我不知道如何进行！

我见过`pandas.DataFrame.applymap`函数，但它似乎只是 1 个参数函数。

也许我错了，使用`shift`函数不是一个好主意

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T06:14:46.163

一个细微的解释变化是您需要将损失标记为 a`1`并将胜利标记为`0`。

第一步是找到失败运行的边缘（`steps`+ `edges`）。然后，您需要获取步骤大小的差异，并将这些值推回原始数据中。当您选择其中一个`cumsum`时`toss2`，您会看到当前的连败长度。你的赌注是`2 ** cumsum(toss2)`。

版本比`numpy`版本快`pandas`，但因素取决于`N`（~8 for`N=100`和 ~2 for `N > 10000`）。

* * *

# 熊猫

使用`pandas.Series`：

```
import pandas as pd
toss = np.random.randint(0,2,100)

toss = pd.Series(toss)

steps = (toss.cumsum() * toss).diff() # mask out the cumsum where we won [0 1 2 3 0 0 4 5 6 ... ]
edges = steps < 0 # find where the cumsum steps down -> where we won
dsteps = steps[edges].diff() # find the length of each losing streak
dsteps[steps[edges].index[0]] = steps[edges][:1] # fix length of the first run which in now NaN
toss2 = toss.copy() # get a copy of the toss series
toss2[edges] = dsteps # insert the length of the losing streaks into the copy of the toss results
bets = 2 ** (toss2).cumsum() # compute the wagers

res = pd.DataFrame({'toss': toss,
                    'toss2': toss2,
                    'runs': toss2.cumsum(),
                    'next_bet': bets}) 
```

* * *

# 麻木的

这是纯`numpy`版本（我的母语是它）。需要进行一些微调才能使阵列对齐，`pandas`这对您有用

```
toss = np.random.randint(0,2,100)

steps = np.diff(np.cumsum(toss) * toss)
edges = steps < 0
edges_shift = np.append(False, edges[:-1])
init_step = steps[edges][0]
toss2 = np.array(toss)
toss2[edges_shift] = np.append(init_step, np.diff(steps[edges]))
bets = 2 ** np.cumsum(toss2)

fmt_dict = {1:'l', 0:'w'}
for t, b in zip(toss, bets):
    print fmt_dict[t] + '-> {0:d}'.format(b) 
```

* * *

## 熊猫输出

```
In [65]: res
Out[65]: 
    next_bet  runs  toss  toss2
0          1     0     0      0
1          2     1     1      1
2          4     2     1      1
3          8     3     1      1
4         16     4     1      1
5          1     0     0     -4
6          1     0     0      0
7          2     1     1      1
8          4     2     1      1
9          1     0     0     -2
10         1     0     0      0
11         2     1     1      1
12         4     2     1      1
13         1     0     0     -2
14         1     0     0      0
15         2     1     1      1
16         1     0     0     -1
17         1     0     0      0
18         2     1     1      1
19         1     0     0     -1
20         1     0     0      0
21         1     0     0      0
22         2     1     1      1
23         1     0     0     -1
24         2     1     1      1
25         1     0     0     -1
26         1     0     0      0
27         1     0     0      0
28         2     1     1      1
29         4     2     1      1
30         1     0     0     -2
31         2     1     1      1
32         4     2     1      1
33         1     0     0     -2
34         1     0     0      0
35         1     0     0      0
36         1     0     0      0
37         2     1     1      1
38         4     2     1      1
39         1     0     0     -2
40         2     1     1      1
41         4     2     1      1
42         8     3     1      1
43         1     0     0     -3
44         1     0     0      0
45         1     0     0      0
46         1     0     0      0
47         2     1     1      1
48         1     0     0     -1
49         2     1     1      1
50         1     0     0     -1
51         1     0     0      0
52         1     0     0      0
53         1     0     0      0
54         1     0     0      0
55         2     1     1      1
56         1     0     0     -1
57         1     0     0      0
58         1     0     0      0
59         1     0     0      0
60         1     0     0      0
61         2     1     1      1
62         1     0     0     -1
63         2     1     1      1
64         4     2     1      1
65         8     3     1      1
66        16     4     1      1
67        32     5     1      1
68         1     0     0     -5
69         2     1     1      1
70         1     0     0     -1
71         2     1     1      1
72         4     2     1      1
73         1     0     0     -2
74         2     1     1      1
75         1     0     0     -1
76         1     0     0      0
77         2     1     1      1
78         4     2     1      1
79         1     0     0     -2
80         1     0     0      0
81         2     1     1      1
82         1     0     0     -1
83         1     0     0      0
84         1     0     0      0
85         1     0     0      0
86         2     1     1      1
87         4     2     1      1
88         8     3     1      1
89        16     4     1      1
90        32     5     1      1
91        64     6     1      1
92         1     0     0     -6
93         1     0     0      0
94         1     0     0      0
95         1     0     0      0
96         2     1     1      1
97         1     0     0     -1
98         1     0     0      0
99         1     0     0      0 
```

* * *

## numpy 输出

（与 panadas 结果不同的种子）

```
(result -> next bet):
w->  1
l->  2
w->  1
w->  1
l->  2
w->  1
l->  2
w->  1
l->  2
l->  4
w->  1
l->  2
w->  1
l->  2
l->  4
w->  1
w->  1
w->  1
l->  2
l->  4
l->  8
w->  1
l->  2
l->  4
w->  1
l->  2
l->  4
w->  1
w->  1
l->  2
w->  1
w->  1
w->  1
w->  1
l->  2
l->  4
w->  1
w->  1
l->  2
l->  4
l->  8
w->  1
w->  1
l->  2
l->  4
w->  1
w->  1
w->  1
w->  1
w->  1
w->  1
l->  2
w->  1
l->  2
w->  1
l->  2
w->  1
w->  1
w->  1
w->  1
w->  1
w->  1
l->  2
l->  4
l->  8
l->  16
w->  1
l->  2
l->  4
w->  1
w->  1
w->  1
w->  1
l->  2
w->  1
w->  1
l->  2
w->  1
w->  1
w->  1
l->  2
w->  1
w->  1
w->  1
w->  1
w->  1
w->  1
l->  2
l->  4
l->  8
w->  1
w->  1
l->  2
l->  4
l->  8
w->  1
l->  2
l->  4
w->  1
l->  2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T17:50:55.210

当您可以使用矢量化操作时，Pandas 将获得最大的效率优势，但我认为这个问题需要迭代。使用熊猫的解决方案：

```
import pandas as pd
import numpy as np

df = pd.DataFrame(np.random.randint(0,2,100)*2-1, columns=['TossResults'])
initial_stake = 1
df['Stake'] = initial_stake

for i in xrange(1,df.shape[0]):
    if df.TossResults[i-1] == -1:
        df.Stake[i] = 2 * df.Stake[i-1] 
```

# python - Python从csv文件创建一个表到变量中

> ID：14755119
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:47.517
> 
> 标签：python, function, row, field, import-from-csv

我想将一个表创建为看起来像实际 csv 文件的变量：

```
Length    Price     Code 
10.05      0.78     AB89H
20         5        HB20K 
```

这是我对我正在使用的每个功能所做的事情所以也许我可以做一次也许......

```
 tree_file.readline() # skip first row
    for row in tree_file:
       field=row.strip()
       field=field.split(",") #make Into fields
       price=int(field[1]) 
```

我想要一个从 csv 文件创建表的函数，这样我就可以将这个表用于我的所有其他函数。所以我不必一直在每个函数中打开 csv 文件并剥离它们并在现场制作它们。

我不需要打印实际的表格！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:02:18.773

我建议使用 csv 模块中的 dictreader。您可以传递一个分隔符参数，在这种情况下为 。第一行将用作字典的键。
请参阅： [http ://docs.python.org/2/library/csv.html](http://docs.python.org/2/library/csv.html)

例子：

```
import csv
data = []
with open('example.csv',  'r') as f:
    reader = csv.DictReader(f, delimiter=',')
    for line in reader:
        line['Price'] = float(line['Price'])
        data.append(line) 
```

现在只需传递数据对象，或者将其放入您需要时调用的函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:49:38.153

```
# Create holder for all the data, just a simple list will do the job.
data = []

# Here you do all the things you do, open the file, bla-bla...
tree_file.readline() # skip first row
for row in tree_file:
    fields = row.strip().split(",") #make Into fields
    data.append({
        'length' : float(fields[0]),
        'price'  : float(fields[1]),
        'code'   : fields[2] 
    })

# ...close the open file object and then just use the data list... 
```

# c - 简单地 fputs() 示例返回 EOF

> ID：14755121
> 
> 赞同：1
> 
> 时间：2013-02-07T15:43:49.110
> 
> 标签：c, fputs

这个简单的程序，在 fgets() 中给我带来了麻烦，返回 EOF，这是 fgets() 的错误值我不明白问题出在哪里

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

FILE* openFile(const char* path)
{
    FILE* file;
    file = fopen(path, "r");
    if(file == NULL)
    {
        perror(path);
        exit(EXIT_FAILURE);
    }
    return file;
}

int main()
{
    FILE* file;
    char stringVector[6] = "hello";
    file = openFile("/home/user/workspace/fputs/src/testo.txt");

    if(fputs(&stringVector[0], file) == EOF)
    {
        printf("error in fputs");
        fclose(file);
        exit(EXIT_FAILURE);
    }

    fclose(file);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:48:17.757

您正在打开文件进行读取，但试图向其中写入数据？那没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T15:51:08.170

在'openFile()'中，你用'r'打开文件，但'fputs'想要'w'文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T15:53:59.807

嗯：&stringVector[0] ？

这与做的完全一样：a = 1 - 1，你为什么不做a = 0？

-> 字符串向量 = &字符串向量[0]

# sql - SQL Count 按数字序列分组

> ID：14755122
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:52.040
> 
> 标签：sql, sql-server, group-by, sequence, gaps-and-islands

我有一个这样的 SQL 表：

```
id      pNum
-----   --------
100     12
100     13
100     15
100     16
100     17
200     18
200     19
300     20
300     21
300     25 
```

我想按 id 和 pNum 序列分组，并计算行数。有这样的结果。

```
id      res
-----   --------
100     2
100     3
200     2
300     2
300     1 
```

关于如何做的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:44:49.057

如果您的 DBMS 支持窗口函数（例如 SQL Server 2005+）

```
SELECT id,
       count(*) AS res
FROM   (SELECT *,
               [pNum] - ROW_NUMBER() OVER (PARTITION BY [id] ORDER BY [pNum]) AS Grp
        FROM   YourTable) T
GROUP  BY id,
          Grp 
```

[SQL小提琴](http://www.sqlfiddle.com/#!3/75270/2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T15:52:45.340

使用[这个问题](https://stackoverflow.com/questions/5087864/sql-query-for-grouping-the-results-based-on-sequence)的解决方案：

```
declare @table table
(
    id int
    , pnum int
)

insert into @table
values (100,    12)
, (100,     13)
, (100,     15)
, (100,     16)
, (100,     17)
, (200,     18)
, (200,     19)
, (300,     20)
, (300,     21)
, (300,     25)

;WITH numbered AS (
  SELECT
    ID, pnum,
    SeqGroup = ROW_NUMBER() OVER (PARTITION BY ID ORDER BY pnum) - pnum
  FROM @table
)
SELECT
  ID,
  COUNT(*) AS res
FROM numbered
GROUP BY ID, SeqGroup
ORDER BY id, MIN(pnum) 
```

# google-maps-api-3 - KML 边界数据，创建/合并多边形的工具

> ID：14755123
> 
> 赞同：2
> 
> 时间：2013-02-07T15:43:53.163
> 
> 标签：google-maps-api-3, kml, boundary

我需要为 Google 地图混搭设定界限。

我正在尝试查找伦敦的边界数据 - 北部、东部、西部和中部。

搜索几个小时后，我只找到了行政区或邮政编码的数据。

将邮政编码边界合并为一个多边形的最佳方法是什么？

这样我就可以获取所有伦敦 N、NW 邮政编码并将它们合并为伦敦北多边形，然后对东西、南和中部做同样的事情。

有什么工具（如果可能的话免费）我可以做到这一点？

## 编辑

这被标记为重复的问题，但没有一个答案被标记为正确 - 只有一个答案对于如何使用字典和图表准确地合并多边形有点模棱两可，对我来说并不真正有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:53:48.220

如果您的目标最终是将一堆您已经拥有的多边形（区域、城市街区等）合并为一个多边形，则任何 GIS 工具都允许您这样做（ESRI ArcGIS 提供了试用版）。我也看起来像[http://www.gadm.org/](http://www.gadm.org/)可能有你请求的详细数据：点击：

1.  按国家下载
2.  选择英国和 KMZ 然后点击确定
3.  选择地图右下角的2级数据

# wolfram-mathematica - 无法操作 2d 绘图

> ID：14755126
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:57.473
> 
> 标签：wolfram-mathematica, mathematica-8

我得到了指示：

> 创建一个动态二维图：
> 
> e^(-ax) where 0<=x<=1 使用连续滑块 a where 0<=a<=10

所以我输入：

```
Manipulate[
  Plot[e^(-ax), {x,0,1}],
  {a,0,10}
] 
```

但结果是一个空图。然而，

```
Plot[e^(-x), {x,0,1}] 
```

工作得很好。有人可以帮我理解我做错了什么吗？我相信我正在根据文档使用操作功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:57:55.493

我尚未对此进行测试，但您的表达式`e^(-ax)`在我看来应该是`e^(-a*x)`-`ax`是一个两个字母的名称，您需要一个乘号或一个空格来告诉 Mathematica 您的意思`-a*x`。

仔细检查您的指令会发现`-a`和之间有一个空格`x`。

# iphone - 使用情节提要在模态转换时显示加载对话框

> ID：14755127
> 
> 赞同：0
> 
> 时间：2013-02-07T15:43:58.867
> 
> 标签：iphone, objective-c, xcode, storyboard

我第一次尝试使用情节提要，但遇到了问题。

我需要在加载模式视图控制器时显示加载对话框。

我会更好地解释它：我的导航栏上有一个按钮，当用户单击它时，会出现一个模式视图控制器，但需要几秒钟，所以我需要对用户说，“应用程序未锁定”。

**更新**

这是正常工作的最终代码：

```
-(void)showLoading {

    UIActivityIndicatorView *loading = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    loading.frame = CGRectMake(275, 0, 40, 40);
    [loading startAnimating];

    [UIView animateWithDuration:0 animations:^ {

        [self.navigationItem setRightBarButtonItem:[[UIBarButtonItem alloc] initWithCustomView:loading]];

    } completion: ^(BOOL completed) {

        UIStoryboard *mainStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
        UIViewController *vc = [mainStoryboard instantiateViewControllerWithIdentifier:@"MyViewController"];
        [self presentModalViewController:vc animated:YES];

    }];

} 
```

并且在`viewDidLoad`

```
[myBarButtonItem setTarget:self];
[myBarButtonItem setAction:@selector(visualizzaCaricamento)]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:59:13.810

一个简单的方法是使用内置的`UIActivityIndicator`. 它有大品种和小品种。您可以将其放在所有内容的视图中，也可以将其添加到您的`UINavigationBar`.

这是一段代码，可以用加载微调器替换按钮。

```
UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];
[indicator startAnimating];

[self.navigationBar setRightBarButtonItem:[[UIBarButtonItem alloc] initWithCustomView:indicator]]; 
```

**更新**

```
// In your viewDidLoad or somewhere like that.
[self.navigationBar setRightBarButtonItem:[[UIBarButtonItem alloc] initWithTitle:@"Do" style:UIBarButtonItemStyleBordered target:self action:@selector(doSomething:)]];

- (void)doSomething:(id)sender {
    // Show spinner
    UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];
    [self.navigationBar setRightBarButtonItem:[[UIBarButtonItem alloc] initWithCustomView:indicator]];
    [indicator startAnimating];

    // ... Load View
} 
```

# php - knpmenubundle：如何在构建器中获取用户数据？

> ID：14755130
> 
> 赞同：8
> 
> 时间：2013-02-07T15:44:04.973
> 
> 标签：php, symfony, knpmenubundle

如何在`KnpMenuBundle`的 Builder 中获取用户数据？

我知道我可以通过 Controller 中的这一行获取用户数据：

```
$user = $this->get('security.context')->getToken()->getUser(); 
```

但我也希望它进入我的菜单构建器，所以我可以将用户名放在菜单中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T20:04:54.887

您的 MenuBuilder 在 Symfony2 中被定义为服务，您可以在 [https://github.com/KnpLabs/KnpMenuBundle/blob/master/Resources/doc/menu_service.rst中看到](https://github.com/KnpLabs/KnpMenuBundle/blob/master/Resources/doc/menu_service.rst)

基本上，您需要做的就是配置您的 MenuBuilder 服务定义以注入安全上下文。（[http://symfony.com/doc/current/book/service_container.html#referencing-injecting-services](http://symfony.com/doc/current/book/service_container.html#referencing-injecting-services)）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-10-01T22:06:11.583

Simshaun 是完全正确的。经过一些研究，我设法做到了：

1.  添加注入`services.yml`：

    ```
    administration_main.menu.main:
      class: Knp\Menu\MenuItem
      factory_service: administration_main.menu_builder
      factory_method: createAdministrationMainMenu
      arguments: ["@request","@security.context"]
      scope: request
      tags:
          - { name: knp_menu.menu, alias: administrationMain } 
    ```

2.  在菜单生成器上使用它

    ```
    use Symfony\Component\Security\Core\SecurityContext;

    public function createAdministrationMainMenu(Request $request, SecurityContext $securityContext){

      $securityContext->getToken()->getUser();

    } 
    ```

# sql-server-2008 - 通过 SSRS 中的 URL 传递动态参数

> ID：14755131
> 
> 赞同：2
> 
> 时间：2013-02-07T15:44:07.760
> 
> 标签：sql-server-2008, reporting-services, ssrs-2008

我有两个报告，第一个通过第二个报告传递两个参数，在使用“转到报告”时工作正常

但是我需要使用“转到 URL”，因为我需要能够控制缩放。

问题是，我还需要通过 URL 传递 2 个参数。

这些参数是@Reason1 和@Reason2。

我尝试过使用以下内容：

```
http://servername/ReportServer/Pages/ReportViewer.aspxnameofmyreportpart&rs:Command=Render&Reason1=@Reason1&Reason2=@Reason2 
```

但是随后它将@Reason1 和@Reason2 硬编码为我的Reason1/Reason2 参数值框的值，这显然不会产生任何结果。

如何构建 URL 以接收上一个报告中所做选择的 2 个参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:38:06.293

为什么不将子报告称为操作并添加参数？您似乎正在尝试使 URL 执行已内置在代码中的操作。有具体原因吗？

如果必须，我会使用该表达式，但我可能会先构建 url 并验证您是否可以复制和粘贴它并且它会起作用。调用网络服务：

```
="http:// (ServerName)/ReportServer/(pathtoreport)&(ParameterName)=" + Parameters!(ParameterName).Value + "&(ParameterName2)=" + Parameters!(ParameterName).Value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-12T01:16:17.103

```
="javascript:void(window.open('http://Servername/ReportServer?/Foldername/Reportname&rs:Commnd=Render&parameter1=" & Fields!A.Value & "&parameter2=" & Fields!B.Value & "'))" 
```

使用上面的 URL 在带有动态参数的新窗口中打开报告。

# tfs - 快速查看 TFS 2012 中每个文件中未决更改的摘要

> ID：14755132
> 
> 赞同：4
> 
> 时间：2013-02-07T15:44:07.790
> 
> 标签：tfs

是否可以在 TFS 2012 的挂起更改窗口中查看显示对每个文件所做更改的摘要屏幕？我知道我可以右键单击每个文件并与工作区或最新文件进行比较，但如果我有大量签入要提交并且我想快速浏览以查看哪些文件实际上有更改以及哪些文件已经更改，那可能会很痛苦已签出但未编辑（例如）。Git 在 Git Extensions 和 VS Source Control 插件中有一个很好的功能，当您选择每个文件时，它会显示每个文件的增量。TFS 中是否隐藏着类似的东西？也许在电动工具中或通过不同的插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:36:20.457

您始终可以通过右键单击“源代码管理资源管理器”中的任何文件并选择比较来进行层次结构比较。您可以查看每个有实际更改的文件并双击以获取详细信息。此外，如果您需要更好的方法来查找待定更改，Visual Studio 2012 解决方案资源管理器上有一个“待定更改”过滤器。在我看来，这比为此目的使用“团队资源管理器”窗口要好。

[比较文件夹](http://msdn.microsoft.com/en-us/library/bb385986.aspx)

[显示带有待处理更改的文件或在visual-studio-2012-solution-explorer中打开的文件](http://blogs.msdn.com/b/visualstudioalm/archive/2012/08/14/showing-files-with-pending-changes-or-files-that-are-open-in-visual-studio-2012-solution-explorer.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-18T09:58:13.943

我有同样的问题，我的同事发现 VS2015 TFS 门户网站是要走的路！它提供了两个很棒的功能：

1.  类似于 GIT 扩展的待定更改视图
2.  搜索书架集时自动完成人名

**如何找到 TFS 在线门户网站？**

VS2015的门户地址语法为：http:// *ServerName* :8080/tfs/ *CollectionName* / *ProjectName*

更多信息在这里：[https ://msdn.microsoft.com/en-us/library/ee523998.aspx](https://msdn.microsoft.com/en-us/library/ee523998.aspx)

**如何获得 TFS 挂起更改的类似 GIT 扩展的差异视图？**

要查看您自己的本地更改，您首先需要将它们保存为搁置集。或者，如果您正在查看其他人的书架集，则只需转到 TFS 门户网站地址。

导航到门户网站地址（您可能需要登录 Office365），然后单击左上角的“CODE”菜单链接，然后单击“Shelvesets”选项卡，如下图所示：

[![在线查看 TFS 货架集更改以获得类似 GIT-Extsnions 的比较窗口](../Images/7c996c669ab423c50f4896845a2abb87.png)](https://i.stack.imgur.com/bbrLW.png)

从这里，您可以搜索书架集，它甚至会为您自动完成人名！找到要查看的架子集后，单击它的超链接名称，尽管速度不如 GIT，但单击文件名将显示其更改的差异。嘿，快！

这是一个显示在线差异的屏幕截图，通过单击更改文件的架子集列表中的文件名来访问（为了隐私而屏蔽了命名空间）：

[![TFS 在线 diff 示例，类似于 GIT Extensions](../Images/fee5b139c326d7cbf82590deb86ab115.png)](https://i.stack.imgur.com/KE94g.png)

您还可以通过查看“变更集”选项卡对已签入的代码执行类似的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T22:02:11.720

目前没有任何可用的东西（除非有一个我没听说过的鲜为人知的插件）。Team Explorer 应该很容易扩展，所以也许有人会开发一个。但它不在 VS2012 或 Team Foundation Power Toys 中。

# sql - 如何在 MERGE INTO 语句中使用 JOIN？

> ID：14755134
> 
> 赞同：5
> 
> 时间：2013-02-07T15:44:12.883
> 
> 标签：sql, sql-server, sql-server-2008, tsql, merge

我要为注册表单处理三个表：[months]、[members] 和 [months_members]。最后一个只是一个连接表。它们看起来像这样：

```
[months]
========
[id] INT (Primary Key)
[name] VARCHAR(50)
[date] DATE

[members]
=========
[id] INT (Primary Key)
[fname] VARCHAR(50)
[lname] VARCHAR(50)
[email] VARCHAR(300)

[months_members]
================
[id] INT (Primary Key)
[month_id] INT
[member_id] INT 
```

所以，从概念上讲，很简单。有一组成员，他们可以注册某些月份。我拥有的允许他们注册不同月份的表格实际上允许管理员一次输入（或更改！）所有注册。所以我希望使用 MERGE 语句通过单个查询将数据放入数据库，而不是遍历多个查询。

所以这就是我开始写的内容（尽管我知道这不是正确的语法）：

```
MERGE INTO [months_members] mm
INNER JOIN [months] mo ON mo.[id] = mm.[month_id] 
USING (
    SELECT 1 AS [month_id], 1 AS [member_id] UNION ALL
    SELECT 2 AS [month_id], 3 AS [member_id] UNION ALL
    SELECT 4 AS [month_id], 4 AS [member_id]
) AS u ON mm.[month_id] = u.[month_id] AND mm.[member_id] = u.[member_id] 
WHEN NOT MATCHED THEN 
    INSERT ([month_id], [member_id]) VALUES (u.[month_id], u.[member_id]) 
WHEN NOT MATCHED BY SOURCE AND DATEPART(YEAR, mo.[start]) = 2013 THEN 
    DELETE; 
```

希望这能说明我遇到的问题。我想将`USING`子查询中的任何新数据插入`[months_members]`表中。而且我还想从`[months_members]`表中删除子查询中*不*存在的任何内容——但前提*是*它对应于当年的一个月。如果子查询中没有对应于不同年份的数据，我*不想*删除它。我想不理会那些历史数据。所以条件是踢球者。`USING`*`USING`*`DATEPART`**

 **所以我要插入一张桌子，`[months_members]`但我也需要它来了解这张`[months]`桌子。有没有办法做到这一点？或者我是否必须让步并遍历多个 SQL 查询？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T15:49:39.197

您可以使用 CTE 代替目标表（或视图）。SQL Server 可以通过 CTE/视图跟踪更新。这是一个被破解的演示：

```
SELECT *
INTO #temp
FROM sys.objects
GO

;WITH cte AS (
    SELECT t1.*
    FROM #temp t1
    JOIN #temp t2 ON t1.object_id = t2.object_id
)
MERGE cte USING (
    SELECT 1 AS [month_id], 1 AS [member_id] UNION ALL
    SELECT 2 AS [month_id], 3 AS [member_id] UNION ALL
    SELECT 4 AS [month_id], 4 AS [member_id]
) AS u ON cte.object_id = u.[month_id]
WHEN MATCHED THEN DELETE; 
```**

# html - 如何保护（使其难以复制）网页源代码

> ID：14755156
> 
> 赞同：-3
> 
> 时间：2013-02-07T15:45:04.797
> 
> 标签：html

我当然知道隐藏网页源代码的源代码是不可能的，但是有没有办法让它难以复制。

我们有一个贴纸系统，它以 SVG 代码显示图片，所以我想隐藏那部分......

任何有好的提示？

感谢转发

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:49:50.737

我认为你能以某种方式实现你想要的唯一方法是使用混淆器。它试图使您的代码尽可能不可读。如果您想要混淆代码的示例，请查看 google.com 上的源代码

在这里有更多信息： [http://en.wikipedia.org/wiki/Obfuscation_(software)](http://en.wikipedia.org/wiki/Obfuscation_(software))

# google-chrome - ExtJS 4.1 MVC 应用程序中加载存储的高延迟

> ID：14755157
> 
> 赞同：1
> 
> 时间：2013-02-07T15:45:16.993
> 
> 标签：google-chrome, xmlhttprequest, store, extjs4.1, low-latency

我目前正在努力将使用自制界面库制作的 Web 应用程序转变为标准的 ExtJS MVC 应用程序。一切正常，除了 Ajax 请求在页面启动时延迟较高。事实上，虽然我调用的文件与以前没有什么不同，但有时我必须比以前多等待 3 到 6 秒才能得到响应。

为了缩小我的调查范围，我更改了代码以返回静态数据（一个简单的 json 字符串），从而消除了数据库问题的选项。此外，我注意到在 Google Chrome（“网络”面板）中使用“Replay XHR”几乎可以立即得到响应。

我想在这个话题上很难提供帮助，但希望有人已经遇到过这种问题，并且可以分享一些关于在哪里调查的建议。

## 观察

*   按延迟排序的请求（间隔约为 500 毫秒）：

    ![在此处输入图像描述](../Images/de3d32cbd49e68957589e24dabda137a.png)

*   按开始时间排序的请求：

    ![在此处输入图像描述](../Images/e99e98c0aae650301f03661d919162d9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T13:36:10.317

我尝试过加载一个又一个商店。这样做，我将所有商店的加载时间减少到大约半秒。不知道是不是每个浏览器都会出现这个问题，我改天查一下。这是补丁（不要忘记删除`autoLoad:true`到所有商店）：

```
// filters stores to load on startup
// store.self.getName() returns "AppName.store.MyStore"

var stores = Ext.StoreManager.filterBy(function (store) {
    return Ext.Array.indexOf(
        ['Store1', 'Store3', 'Store5'], 
        store.self.getName().split('.').pop()
    ) !== -1;
});

// loads one store after another

(function () {
    var callee = arguments.callee,
        store = stores.getAt(0);
    store.load({
        scope: this,
        callback: function () {
            stores.remove(store);
            if (stores.getCount()) {
                callee.call(this);
            } else {
                // all stores are now loaded
            }
        }
    });
}).call(this); 
```

# css - CSS优先级歧义

> ID：14755160
> 
> 赞同：0
> 
> 时间：2013-02-07T15:45:24.330
> 
> 标签：css, operator-precedence

我有以下CSS规则：

```
input[type="submit"],input[type="reset"]{
    background-image:url(skins/images/bg_mega_hdr_on.png);
    background-repeat:no-repeat;
    padding:5px;
    margin:5px;
    color:#000;
    cursor:pointer;
}

#submit-search{
    background-image:url(skins/images/bg_blue.png) !important;
} 
```

现在根据 css 规则，id 选择器比通用选择器具有更高的优先级，那么为什么当我应用此规则时，第二个被第一个覆盖？请注意，我什至应用了！important，然后也只应用了第一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:53:50.460

像这样的 id="submit-search"**注意空格**会导致奇怪的选择器行为！附言。还不能评论，一点点...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:59:15.693

对我来说是正确的。看到这个[jfiddle](http://jsfiddle.net/Fr4Vy/1/)。一定有其他问题（我删除`!important`了它仍然可以正常工作）。

# android - 关闭所有活动、服务、线程。退出Android应用程序时等

> ID：14755162
> 
> 赞同：0
> 
> 时间：2013-02-07T15:45:33.787
> 
> 标签：android, exit, resource-cleanup

我正在编写一个 android 应用程序，当我第一次运行它时它运行良好，但是当我尝试第二次运行它时它变得不稳定。我想也许我第一次启动的线程或服务仍然可以继续工作，而我第二次启动应用程序时会出现冲突或其他问题。在我的应用程序中，我有一个主要活动，我从中启动一个服务，并在服务内部启动一个运行的线程。退出 Android 应用程序时要遵循的一般准则是什么。有什么具体的事情要确保它在退出后没有任何东西继续运行并确保应用程序不持有一些资源，换句话说，它是一个干净的退出。

以下是有关我的应用程序的更多详细信息：我的主要活动是这样的：

```
public class MainActivity extends Activity implements OnClickListener {
...
   public void onClick(View src) {
    switch (src.getId()) {
    case R.id.buttonStart:
        if (isService == false)  {
            Intent intent1 = new Intent(this, MyService.class);
            startService(intent1);
        }
        isService = true;
        if (firstTime == false) myService.setA(true);
        firstTime = false;
        break;
    case R.id.buttonStop:
        if (isService == true)  {
            Intent intent1 = new Intent(this, MyService.class);
            myService.setA(false);
            stopService(intent1);
        }
        isService = false;
        break;
    }
   }

   ...
} 
```

我的服务看起来像这样：

```
public class MyService extends Service {
private boolean a=true;
...

@Override
public void onCreate() {    
    super.onCreate(); 
    int icon = R.drawable.icon;
    CharSequence tickerText = "Hello";
    long when = System.currentTimeMillis();
    Notification notification = new Notification(icon, tickerText, when);
    Intent notificationIntent = new Intent(this, MainActivity.class);
    PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);
    notification.setLatestEventInfo(this, "notification title", "notification message", pendingIntent);     
    startForeground(ONGOING_NOTIFICATION, notification);
    ...
}

@Override
public void onDestroy() {
    Toast.makeText(this, "My Service Stopped", Toast.LENGTH_LONG).show();
    Log.d(TAG, "onDestroy");
}

@Override
 public int onStartCommand( Intent intent, int flags, int startId ) {
    Thread mythread = new Thread() {
        @Override
        public void run() {
            while(a)
            {
                PLAY AUDIO
            }
        }
    };
    mythread.start();
    return super.onStartCommand( intent, flags, startId );
}

public void setA(boolean aa) {
    Log.d(TAG,"a is set");
    this.a = aa;
}
....
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:54:35.763

当您不需要它们时，请始终清理资源。例如：如果`Service`仅在您的 -> 调用运行时`Activity`需要. （和）。`stopService``Activity.onPause``startService``Activity.onResume`

关于你的`Service`，是否需要继续运行。还是应该做1个任务然后就完成了？如果是这样，请使用`IntentService`，当没有更多要处理的意图时，它将自行关闭。

此外，您使用的是哪种线程？`Thread`还是`AsyncTask`别的什么？`Thread`是非常基本的，一个像这样的糖版本`AsyncTask`可能会做得更好。很大程度上取决于你用它做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T08:37:25.520

如果没有其他并发症，请尝试终止该过程......

```
android.os.Process.killProcess(android.os.Process.myPid()); 
```

谢谢

# javascript - 如何在 MongoDB 集合中找到所有不是数字的项目？

> ID：14755164
> 
> 赞同：0
> 
> 时间：2013-02-07T15:45:39.077
> 
> 标签：javascript, mongodb, mongodb-query

我在 mongodb 数据库中有一个字段，该字段主要包含数字，但也可能包含一些空值、字符串等。我怎样才能找到（）所有这些记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:52:17.420

我不确定我是否完全理解你的问题。你想得到数字还是非数字？无论如何，您可以通过以下方式获得：

号码：

`db.stuff.find({my_field: { $type: 1 }})`

其他

`db.stuff.find({my_field: { $not: {$type: 1 }}})`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:51:51.773

使用[`$type`](http://docs.mongodb.org/manual/reference/operator/type/#_S_type)查询对象中的运算符按字段的数据类型进行选择。

# jsp - 在 JSP 中的表中自动插入新行

> ID：14755168
> 
> 赞同：1
> 
> 时间：2013-02-07T15:45:53.427
> 
> 标签：jsp, struts2

我的 JSP 中有一个包含一些输入字段的表（在 div 内）。其中一排有问题。我在第二行的 3 个不同单元格中有 3 个下拉菜单。这 3 个下拉菜单彼此重叠显示，而不是彼此相邻。所以而不是

```
[Select 1] [Select 2] [Select 3] 
```

我正进入（状态：

```
FIRST
SECOND
THIRD 
```

当我查看呈现的 HTML 时，似乎每次下拉后都会自动插入新行。需要帮助显示彼此相邻的 3 个下拉菜单。

代码：

```
 <s:form action="insNewAct" namespace="/">
   <table>
     <tr> 
      <td><s:textfield name="jobName" label = "Job Name" size="20" /></td>
      <td>&nbsp;</td><td>&nbsp;</td>
     </tr>
     <tr>
      <td>          
        <s:select 
        label = "Job Schedule"
        headerKey="-1" headerValue="Hour"
        list="{'1', '2', '3', '4'}" 
        name="hour"/>
      </td>
      <td>
        <s:select 
        headerKey="-1" headerValue="Minute"
        list="{'01', '02', '03', '04', '05' }" 
        name="minute"/>   
    </td>
    <td>      
        <s:select 
        headerKey="-1" headerValue="AM/PM"
        list="#{'A':'AM', 'P':'PM'}" 
        name="ampm"/>
    </td>
    </tr>
      <tr>
        <td><s:submit value="Submit" name="submit" align="center"/></td><td>&nbsp;</td><td>&nbsp;</td>
      </tr>
 </table>
 </s:form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:51:07.117

默认的 Struts 2 主题“xhtml”将表单元素放在表格行中。

如果您想使用“简单”主题：

```
<s:select label = "Job Schedule"
          headerKey="-1" headerValue="Hour"
          list="{'1', '2', '3', '4'}" 
          name="hour"
          theme="simple"
          /> 
```

需要注意的是，这将*不*支持验证框架提供的内置错误消息，尽管它们可以手动处理小块“简单”主题功能。

# android - 使用 ICS Android OS 的 Web 视图

> ID：14755169
> 
> 赞同：0
> 
> 时间：2013-02-07T15:45:55.793
> 
> 标签：android, android-webview, android-websettings

wvtxtcastdet.loadData（文本，“文本/html”，“utf-8”）

其中 text 是 HTML 内容。它在每个操作系统中都能正常工作。但在 ICS 中出现此错误

java.lang.Throwable：在设置 WebViewCore 之前不支持 EventHub.removeMessages(int what = 107)。

请帮我解决这个问题。

# nginx - Nginx 代理或重写取决于用户代理，没有 if

> ID：14755170
> 
> 赞同：4
> 
> 时间：2013-02-07T15:45:55.873
> 
> 标签：nginx

我需要根据用户代理提供不同的文件。这是一项非常基本的要求，比提供文件更上一层楼。

[标准答案](https://stackoverflow.com/questions/10627596/nginx-proxy-or-rewrite-depending-on-user-agent)似乎是，使用声明`if`。

[`if`但是，不应该使用语句](https://stackoverflow.com/a/14745134/238884)显然是众所周知的。

所以此时的答案似乎是 Apache，但我告诉我的老板 nginx 是一个可用的产品。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T17:06:06.077

如果你仔细阅读[if is evil](http://wiki.nginx.org/IfIsEvil "如果是邪恶的")，你会注意到它有以下引用：

```
The only 100% safe things which may be done inside if in location context are:
return ...;
rewrite ... last; 

Anything else may possibly cause unpredictable behaviour, including potential
SIGSEGV. 
```

所以...

的邪恶`if`只适用于在一个位置块内使用

在`location`-block 内，有两个，并且只有两个，保证了一个`if`块的保存用途：

*   一个持有孤独`return ...;`声明的人
*   一个持有孤独`rewrite ... last;`声明的人
*   （请注意，空`if`块也可能导致问题）

`if`在位置块中的非保证保存使用*可能*有效，但需要进行测试

# sql - 查找时间戳间隔 > 15 分钟的连续记录

> ID：14755171
> 
> 赞同：2
> 
> 时间：2013-02-07T15:45:58.107
> 
> 标签：sql, sql-server, timestamp, sql-server-2012, intervals

一个进程每 15 分钟运行一次（应该运行一次），并将其添加到 MS SQL 2012 日志记录表中。

```
2013-02-07 10:07:47.000
2013-02-07 09:52:36.000
2013-02-07 09:37:34.000
2013-02-07 09:22:32.000
2013-02-07 09:07:31.000
2013-02-07 08:52:29.000
2013-02-07 08:37:28.000
2013-02-07 08:13:53.000
2013-02-07 07:58:51.000
2013-02-07 07:43:50.000
2013-02-07 07:28:48.000
2013-02-07 07:13:47.000
2013-02-07 06:58:37.000 
```

我需要一个查询的帮助，该查询将返回相隔 > 16 分钟的连续时间戳。在上述记录中，查询将返回 2013-02-07 08:37:28.000 和 2013-02-07 08:13:53.000

编辑 - 添加对 MS SQL 的引用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:01:37.947

这个问题的答案很大程度上取决于您使用的 RDBMS。

像这样的东西应该适用于 SQL Server 使用`DATEDIFF`and `ROW_NUMBER`：

```
WITH CTE AS (
  SELECT ProcessTime, ROW_NUMBER() OVER (ORDER BY ProcessTime DESC) RN
  FROM Process
  )
SELECT P.ProcessTime, 
  P2.ProcessTime as ProcessTime2, 
  DATEDIFF(mi,  P.ProcessTime, P2.ProcessTime)
FROM CTE P
  JOIN CTE P2 ON P.RN = P2.RN + 1
WHERE DATEDIFF(mi, P.ProcessTime, P2.ProcessTime) > 16 
```

它将日期放在 2 个单独的列中——如果愿意，可以很容易地放在一个列中。

这是[小提琴](http://www.sqlfiddle.com/#!3/e2aa3/5)。

如果您让我们知道 RDBMS，我们可以在需要时组合一个替代解决方案。

对于 Oracle，使用`extract( minute from P2.ProcessTime - P.ProcessTime )`vs `DATEDIFF`- 查询的其余部分应该可以工作 - 这里是[Fiddle](http://www.sqlfiddle.com/#!4/537ab/5)。

对于 MySQL，代码会有所不同，因为 MySQL 不支持`CTEs`或`ROW_NUMBER`. 但这应该让你朝着正确的方向前进。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:03:26.527

基本思路是在序列中放入下一个时间戳，然后选择差值大于16的行。

以下查询使用相关子查询计算下一个时间戳：

```
select *
from (select t.*,
             (select MIN(t.timestamp) from t t2 where t2.timestamp > t.timestamp
             ) as nextTimestamp
      from t
     ) t
where DATEDIFF(min, timestamp, nextTimestamp) > 16 
```

该`where`子句依赖于数据库，但它提供了如何执行此操作的想法。

在 SQL Server 2012 上，您将执行以下操作：

```
select *
from (select t.*,
             lead (t.timestamp) over (order by timestamp) as nextTimestamp
      from t
     ) t
where DATEDIFF(mi, timestamp, nextTimestamp) > 16 
```

（假设您的时间戳存储为`datetime`）。

# scrapy - scrapy 无法抓取 craigslist

> ID：14755173
> 
> 赞同：1
> 
> 时间：2013-02-07T15:46:07.043
> 
> 标签：scrapy, rules, web-crawler

相同的代码可以毫无问题地抓取黄皮书，并且符合预期。将规则更改为 CL，它会点击第一个 url，然后在没有相关输出的情况下摇摇欲坠。

```
from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector
from craigs.items import CraigsItem

class MySpider(CrawlSpider):
        name = "craigs"
        allowed_domains = ["craiglist.org"]

        start_urls = ["http://newyork.craigslist.org/cpg/"]

        rules = [Rule(SgmlLinkExtractor(restrict_xpaths=('/html/body/blockquote[3]/p/a',)), follow=True, callback='parse_profile')]

        def parse_profile(self, response):
                found = []
                img = CraigsItem()
                hxs = HtmlXPathSelector(response)
                img['title'] = hxs.select('//h2[contains(@class, "postingtitle")]/text()').extract()
                img['text'] = hxs.select('//section[contains(@id, "postingbody")]/text()').extract()
                img['tags'] =  hxs.select('//html/body/article/section/section[2]/section[2]/ul/li[1]').extract()

                print found[0]
                return found[0] 
```

这是输出 [http://pastie.org/6087878](http://pastie.org/6087878) 如您所见，获取第一个 url 来抓取 http://newyork.craigslist.org/mnh/cpg/3600242403.html> 没有问题，但随后就死了。

我可以使用 CLI 并使用 xpaths 或关键字 SgmlLinkExtractor(allow=r' /cpg/.+').extract_links(response)
输出 -> [http://pastie.org/6085322](http://pastie.org/6085322)

但在爬网中，相同的查询失败。怎么回事？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T07:12:51.017

如果您查看文档，您会看到

> allowed_domains 可选的字符串列表，其中包含允许此蜘蛛抓取的域。如果启用了 OffsiteMiddleware，则不会遵循对不属于此列表中指定的域名的 URL 的请求。

您允许的域是

```
 allowed_domains = ["craiglist.org"] 
```

但您正在尝试获取子域

```
02-07 15:39:03+0000 [craigs] DEBUG: Filtered offsite request to 'newyork.craigslist.org': <GET http://newyork.craigslist.org/mnh/cpg/3600242403.html> 
```

这就是它被过滤的原因

要么`allowed_domains`从你的爬虫中删除，要么在其中添加适当的域，以避免过滤的异地请求

# android - 从 android 设备打开 facebook 应用程序请求通知

> ID：14755174
> 
> 赞同：1
> 
> 时间：2013-02-07T15:46:07.700
> 
> 标签：android, facebook, notifications, apprequests, facebook-app-requests

我想邀请 Facebook 朋友使用 Facebook 'apprequests' 方法试用我的应用程序。

它工作正常。朋友收到通知，但如果他从 android 通知栏而不是 Facebook 上单击通知，它会打开 Facebook 应用程序并加载而不做任何其他事情。

如果他点击来自 Facebook 的通知，它会按预期工作。你有什么想法我必须做什么来解决这个问题吗？

# time - 如何在 Windows CE 上保留系统时间设置

> ID：14755175
> 
> 赞同：1
> 
> 时间：2013-02-07T15:46:17.203
> 
> 标签：time, windows-ce

我使用的是 Windows CE 6.0 设备，当我设置设备时间（以[编程](http://msdn.microsoft.com/en-us/library/ms172517.aspx)方式或手动方式）时，设备在拔下电源时不记得设置。

**如何确保保存时间设置？**我需要以编程方式将设备时间与服务器同步，这使得设备电源关闭时变得困难。

我猜这个问题可能是一些注册表设置没有被保留，但我不确定时间是否存储在这些设置中，我也没有找到强制存储它们的方法。

谢谢你的建议。

编辑：重新启动设备后，时钟并没有完全重置，它只是返回到错误的时间。重启后设备的时间总是向前大约 1 小时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T21:30:45.567

如果设备在您断电时失去了时间，那是因为它没有电池支持的时钟或时钟的电池没电了。没有任何电源，设备就无法保持时间，您也无法让设备节省时间，除非添加某种形式的备用电源（或更换电池，*如果有的话*） .

**编辑**

如果时钟正在重置为系统默认值，但仅按小时更改，则强烈表明它正在丢失 DST 或时区设置。这两个都存储在注册表中，因此您的注册表设置很可能没有持久化。这可能有几个原因：

1.  您对注册表进行了更改，但没有告诉操作系统保存更改。操作系统配置可能设置为定期保存更​​改，或者仅在明确告知时保存。您最好的选择是更改时钟（我假设您在调整时钟时正在更改时区和/或 DST？）然后显式调用 RegFlushKey API 以强制保存注册表。
2.  您的设备没有永久注册表。只有 OEM 可以解决这个问题。测试很简单，创建一个注册表项，调用 RegFlushKey 并重新启动，看看它是否还在。如果不是，那么您的设备不会保留注册表设置，您可能不走运。

# mysql - MySQL 更新查询

> ID：14755176
> 
> 赞同：0
> 
> 时间：2013-02-07T15:46:27.730
> 
> 标签：mysql, sql-update

我有一个包含 90000 个更新查询的 sql 文件

```
UPDATE xxxx SET price='x.xx', wholesale_price='y.yy' WHERE reference='azerty'; 
```

我尝试使用以下内容更新我的数据库：

```
mysql -u user -ppassword ecommerce < update_prices-1360224708.sql 
```

但是在 2 个半小时后……我的更新还没有完成……而且运气不好，我的 SSH 会话期间我的互联网中断了，我确信更新失败了。

所以...我决定减少 10 个文件的失败（每个文件 10000 行，重量 = 1MO）...但是使用 phpmyadmin，请求太多...

90,000 个请求需要多长时间？

我失败了吗？当我使用“一行”时......它可以工作，我确定文件上没有错误。

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:02:21.360

在参考上创建索引：

```
CREATE INDEX ix_reference ON tablename (reference); 
```

# javascript - clearinterval 未捕获

> ID：14755181
> 
> 赞同：1
> 
> 时间：2013-02-07T15:46:41.193
> 
> 标签：javascript, jquery

我有一个被间隔调用的函数。然后我设置了调用函数的间隔。我有一个 mouseleave / mouseenter 事件来分别清除和设置间隔。但是 clearInterval 不起作用，但是内部的匿名函数被调用了：

```
interval = setInterval(function() { changeBackground(bgs); }, 2000);

    $('section#main').mouseleave(function() {
        clearInterval(interval);
        alert("j");
    });

    $('section#main').mouseenter(function() {
        var interval = setInterval(function() { changeBackground(bgs); }, 2000);
        alert("n");
    });

    function changeBackground(bgs) {
        $('#black').fadeIn(400, 'swing', function () {
            var Url = "url('content/slides/" + bgs[currentBg] + "')";
            $('#container').css('background-image', Url);
        });

        $('#black').fadeOut();

        currentBg++;

        if(currentBg == totalBg) {
            currentBg = 0;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:48:59.003

尝试这个：

```
var interval = null;

$('section#main').mouseleave(function() {
    clearInterval(interval);
    alert("j");
});

$('section#main').mouseenter(function() {
    interval = setInterval(function() { changeBackground(bgs); }, 2000);
    alert("n");
}); 
```

`interval`你在里面var'ing`mouseenter`所以它在里面是未定义的`mouseleave`。

**编辑**

您修改了代码：

```
var interval = setInterval(function() { changeBackground(bgs); }, 2000);

$('section#main').mouseleave(function() {
    clearInterval(interval);
    alert("j");
});

$('section#main').mouseenter(function() {
    interval = setInterval(function() { changeBackground(bgs); }, 2000);
    alert("n");
});

function changeBackground(bgs) {
    $('#black').fadeIn(400, 'swing', function () {
        var Url = "url('content/slides/" + bgs[currentBg] + "')";
        $('#container').css('background-image', Url);
    });

    $('#black').fadeOut();

    currentBg++;

    if(currentBg == totalBg) {
        currentBg = 0;
    }
} 
```

# c# - 如何检测服务代理上自动生成的方法参数？

> ID：14755182
> 
> 赞同：1
> 
> 时间：2013-02-07T15:46:43.283
> 
> 标签：c#, .net, wcf, service, proxy

当我为我的服务创建代理时，一些额外的参数被添加为 XmlIgnoreAttribute。例如：

接口方法契约声明：

```
[OperationContract]
void AddToList(int integerToAdd); 
```

方法实现：

```
public void AddToList(int integerToAdd) {
    intList.Add(integerToAdd);
} 
```

现在，当我动态地为我的服务生成代理时，这个方法实际上是这样的：

```
/// <remarks/>
[System.Web.Services.Protocols.SoapDocumentMethodAttribute("http://tempuri.org/IService1/AddToList", RequestNamespace="http://tempuri.org/", ResponseNamespace="http://tempuri.org/", Use=System.Web.Services.Description.SoapBindingUse.Literal, ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped)]
public void AddToList(int integerToAdd, [System.Xml.Serialization.XmlIgnoreAttribute()] bool integerToAddSpecified)
{
    this.Invoke("AddToList", new object[] {integerToAdd, integerToAddSpecified});
} 
```

如果我有此参数的 ParameterInfo 对象，如何检查此参数是否已标记为 XmlIgnoreAttribute？

如果这不是检查这些自动生成的参数的好方法，那么还有另一种（更好的）方法来检查它们吗？

奖励：是否存在生成非布尔类型并将其标记为 XmlIgnoreAttribute 的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:13:02.407

我假设您会使用[ParameterInfo.GetCustomAttributes()](http://msdn.microsoft.com/en-us/library/9kk93tbd%28v=vs.100%29.aspx)？

```
ParameterInfo secondParam = ..
object[] attribs = 
          secondParam.GetCustomAttributes(typeof(XmlIgnoreAttribute), false);
//the second bool param is ignored. See the docs.
//check if => attribs has anything.. 
```

**(1)**我不确定您为什么要检查这些参数，所以不确定它是否好/更好。**(2)**不确定第二个问题。我假设这是来自 VS 代码生成（`svcutil`？）也许一些设计这个的 MSFT 可能更了解。

# jquery - 在将图像添加为背景图像之前检查图像是否存在

> ID：14755183
> 
> 赞同：5
> 
> 时间：2013-02-07T15:46:43.897
> 
> 标签：jquery, api, background-image

堆栈上有一些解决方案关于在图像上使用 .error() 来确定它们是否存在，如果不存在则添加占位符，但它们都严格讨论了它在`<img>`标签上的使用。`<img>`有没有人对没有添加到标签而是作为 div 上的背景的图像执行这种类型的验证？

我们有一组来自第 3 方 API 的图像，并且在某些情况下，返回的整组图像 url 不存在。验证一组图像（注定是背景图像）以确定它们是否存在并在验证失败时应用适当的占位符的正确方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-07T15:55:04.203

有几种方法可以做到这一点：

使用阿贾克斯：

```
$.ajax({
    url: "image.jpg",
    type: "HEAD",
    error: function () { alert("no image"); }
}); 
```

使用 javascript 图像对象：

```
var image = new Image(); 
image.src = "image.jpg";
if (image.width == 0) {
  alert("no image");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:14:40.877

使用 jquery：`$("<img src='[path]'>").load(function(){ [image exists!] });`对于每个具有`background-image`.

我们实施的一个解决方案是创建一个中间的服务器端脚本，用于检查给定图像是否存在于第 3 方 API 端 - 如果存在，则提供图像，如果不存在 - 提供占位符。这种方式始终提供图像+添加缓存/调整图像大小的附加功能。

另一个解决方案是实际上不检查图像是否存在 - 您可以使用 CSS 提供占位符图像，如果您通过 javascript 添加背景图像，那么如果它存在，它将覆盖现有规则。

# android - 修复了 Android 中的视口高度

> ID：14755184
> 
> 赞同：0
> 
> 时间：2013-02-07T15:46:44.270
> 
> 标签：android, html, web-applications, height, viewport

我有一个只能在横向使用的 Android 网络应用程序。

当我将视口宽度设置为一个数字时，一切都按预期工作。但出于我的目的，我想使用固定的像素高度：

```
<meta name="viewport" content="height=500" /> 
```

无论我尝试什么，高度都会被完全忽略。我已经搜索了几个小时，但没有找到解决我问题的方法。

为了测试，我创建了一个带有 div 框的简单 html 文件，高度为 500，宽度为 500。我希望 div 以高度填充整个设备屏幕，但事实并非如此。

想法？:-o

# perl - 关于最大字符长度的 Perl 正则表达式

> ID：14755186
> 
> 赞同：-1
> 
> 时间：2013-02-07T15:46:56.090
> 
> 标签：perl, expression, maxlength

我正在尝试为给定字符串（在特定接口中）允许的最大长度创建 Perl 验证表达式

我试过`/.{0,5}/`或者`/^.{0,5}&/`我注意到在许多类似的情况下使用过，但似乎任何输入的字符串（甚至低于 20 个字符）都失败了......

我已经搜索和测试了很多方法，但没有结果。

我最近尝试过：

`[[:alpha:]]\{0,20\}`

但是行为很奇怪……

我怎样才能解决这个问题？我只是想阻止用户在表单中输入 20 个或更多字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:51:49.337

`length()`尝试使用该函数，而不是使用正则表达式。

例子：

```
my $max = 4;
my $input = "qwerty";
if (length($input) < $max) {
    print "[$input] is less than $max\n";
} 
else {
    print "[$input] is more or equal than $max\n";
} 
```

看

```
perldoc -f length 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T11:05:25.060

如果您正在从命令行读取输入，请尝试以下操作：

```
#!/usr/perl/bin -w

use strict;

my $input;
while (1) {
    $input = <>;
    if(length($input) < 20) {
        print "perfect\n";
    } 
    else {
        print "Exceeded 20 characters\n";
        exit(1);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:53:19.010

使用`/^.{1,20}$/`：

```
$ echo "12345678901234567890123" | perl -nle "print if /^.{1,20}$/"

$ echo "12345678901234567890" | perl -nle "print if /^.{1,20}$/"
12345678901234567890 
```

# python - 使用 IPC、Twisted 或 ZeroMQ 的架构方法？

> ID：14755187
> 
> 赞同：3
> 
> 时间：2013-02-07T15:46:58.310
> 
> 标签：python, architecture, ipc, twisted, zeromq

我正在使用扭曲从连接互联网的传感器获取消息，以便将其存储到数据库中。
我想在不干扰这些过程的情况下检查这些消息，因为我需要将每条消息与 db 中的一些基值进行比较，如果一些匹配，我需要为此触发警报，并且这个想法不是阻止任何进程......

我的想法是创建一个新流程来检查和提醒，但我需要在第一个流程存储消息后，它将消息发送到新流程，以便在需要时进行检查和提醒。

为此我需要IPC，我正在考虑使用ZeroMQ，但也扭曲了一种使用IPC的方法，我想如果我使用ZeroMQ，但也许它会弄巧成拙......

你觉得我的方法怎么样？也许我完全错了？

欢迎任何建议.. 感谢

PD：此过程将在专用服务器上运行，预期负载为 6000 msg/小时，每个 1Kb

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T00:15:00.913

所有这些方法都是可能的。我只能抽象地说，因为我不知道你的应用程序的精确轮廓。

如果您已经有一个工作应用程序，但它的速度不足以处理您向其发送的消息数量，那么请确定瓶颈。阻塞的两个可能原因是数据库访问或警报触发，因为其中任何一个都可能是同步 IO 操作。

你如何处理这个取决于你的工作量：

1.  如果您的消息速率很高且恒定，那么您需要确保您的数据库可以处理此速率。如果您的数据库无法处理它，那么再多的非阻塞消息传递将帮助您！按此顺序：
    1.  尝试调整您的数据库。
    2.  尝试将您的数据库放在具有更多内存的更大计算机上。
    3.  尝试在多台机器上分片您的数据库以分配工作负载。一旦您知道您的数据库可以处理消息速率，您就可以使用其他形式的并行处理其他瓶颈。
2.  如果您的消息速率是突发的，那么您可以使用队列来处理突发。按此顺序：
    1.  将负载平衡器放在消息处理器集群的前面。这个平衡器应该做的就是将传感器消息重新分发到不同的机器以进行检查和警报处理。这种方法的优点是您可能不需要更改现有应用程序，只需在更多机器上运行它即可。如果您的负载均衡器不需要等待响应，只需转发消息，这将最有效。
    2.  如果您的通信需求更复杂或者是双向的，您可以使用消息总线（例如 ZeroMQ）作为消息处理器、警报发送器和数据库检查器之间的通信层。这个想法是通过通过总线进行非阻塞通信并让总线上的每个节点只做一件事来增加并行性。然后，您可以根据每个消息处理阶段花费的时间来更改节点类型的比率。（即使整个消息处理过程中的队列深度相等。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:51:28.587

当你收到消息时，做两件事：

*   检查它是否应该触发警报（并在必要时发送警报，大概）
*   将其插入数据库

您不需要消息队列、多个进程、IPC 或任何这些东西。例如：

```
def messageReceived(self, message):
    self.checkForAlerts(message).addCallbacks(self.maybeAlert, log.err)
    self.saveMessageToDatabase(message).addErrback(log.err) 
```

# jquery - mouseout 和 mouseleave 在 ie 中不起作用

> ID：14755189
> 
> 赞同：0
> 
> 时间：2013-02-07T15:47:00.303
> 
> 标签：jquery, internet-explorer, iframe, mouseleave, onmouseout

```
var iframeContent = $("#<%= iframeID %>").contents();
iframeContent.off("mouseover", "#divImgSize").on("mouseover","#divImgSize", function() {
       //some code
    }); 
```

此功能工作正常，但

```
iframeContent.off("mouseout", "#divImgSize").on("mouseout", "#divImgSize", function(event) {
    //some code
}); 
```

或者

```
iframeContent.off("mouseleave ", "#divImgSize").on("mouseleave ", "#divImgSize", function(event) {
    //some code
}); 
```

在 Firefox、Chrome 中工作，但不能在 Internet Explorer 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:51:21.677

在查看有关访问 iframe 内容的另一篇[文章后](https://stackoverflow.com/questions/364952/jquery-javascript-accessing-contents-of-an-iframe)，内容必须位于同一域中，否则不可能。要使这成为可能，请尝试以下操作。

```
var iframeContent = $("#<%= iframeID %>").contents();

iframeContent.find("#divImgSize")
    .on("mouseover", doSomeThing())
    .on("mouseleave", doSomeThing());

function doSomeThing(){
    // Your code
} 
```

# mysql - 使用 Silverlight 连接到 webhost 上的 MySQL

> ID：14755192
> 
> 赞同：0
> 
> 时间：2013-02-07T15:47:12.740
> 
> 标签：mysql, visual-studio, silverlight

在我的虚拟主机上，我有一个 MySQL 数据库。在 Visual Studio 中，我想制作一个可以与该数据库连接的 Silverlight 应用程序 (VB.net)。

这个怎么做？我发现只有本地数据的教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:11:30.333

[这个问题](https://stackoverflow.com/questions/6982624/lightswitch-wcf-ria-mysql-connector-net-almost-working-but-not-quite)的答案也是你的答案。 [http://lightswitchhelpwebsite.com/Forum/tabid/63/aft/89/Default.aspx](http://lightswitchhelpwebsite.com/Forum/tabid/63/aft/89/Default.aspx)

目的不是让 Silverlight 客户端与 MySql 通信。相反，您必须托管一个处理数据访问的 Web 服务。RIA Services 为您完成大部分的后勤工作。

# ruby-on-rails - 机架重写在条件 RoR 3.1 中使用正则表达式

> ID：14755193
> 
> 赞同：0
> 
> 时间：2013-02-07T15:47:22.487
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, rack-rewrite

我正在尝试为重定向设置以下规则：

```
if Rails.env.staging? || Rails.env.production?
        r301 %r{.*}, 'http://mysite.com$&', :if => Proc.new {|rack_env|
            rack_env['SERVER_NAME'] != 'mysite.com' && rack_env['SERVER_NAME'] != '*.mysite.com'
        }
    end 
```

我需要将我的子域包含在条件中，但是如果我没有类似 a.mysite.com 的内容，它会一直将我重定向到 mysite.com。

我该如何解决？

谢谢！

# javascript - 无限次重复功能

> ID：14755197
> 
> 赞同：1
> 
> 时间：2013-02-07T15:47:42.627
> 
> 标签：javascript, function, intervals, infinite

基于一些较早的问题，我尝试无限次运行我的函数。但它仍然不起作用。如果我运行脚本，它会在奇怪的时刻被破坏，然后再次运行脚本，间隔很长。任何人都可以帮助我让这个脚本运行没有间隔和停止吗？谢谢。

```
<script type="text/javascript">
$("#go").hide().ready(function(){
animatie();
});
var d = 0;
function animatie() {
 for(var i = 0; i < 3; ++i){
  var b = ".block"+i;
  $(b).hide().delay(d).fadeIn(2000);
  $(b).hide().delay(1000).fadeOut(2000);
  d += 4000;
 }
}
window.setInterval(animatie, 13000);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:57:03.627

您可能希望重置`d`为`0`每次`setInterval`触发。此外，也许`4000`应该`5000`改为（`2000 + 1000 + 2000`）。最后，您不需要`.hide()`两次：http: [//jsfiddle.net/nZHCB/](http://jsfiddle.net/nZHCB/)。

```
function animatie() {
 var d = 0;
 for(var i = 0; i < 3; ++i){
  var b = ".block"+i;
  $(b).hide().delay(d).fadeIn(2000).delay(1000).fadeOut(2000);
  d += 5000;
 }
}
animatie();
window.setInterval(animatie, 15000); 
```

也就是说，您还可以使用一个函数来迭代一个元素。最后一个动画 ( `.fadeOut`) 完成后，使用下一个元素再次调用该函数：http: [//jsfiddle.net/nZHCB/2/](http://jsfiddle.net/nZHCB/2/)。

```
$("div").hide();

(function animatie(i) {
    var b = ".block" + i;
    $(b).fadeIn(2000).delay(1000).fadeOut(2000, function() {
        animatie((i + 1) % 3);
    });
})(0); 
```

# c# - 自动调用属性的构造函数 - C#

> ID：14755199
> 
> 赞同：0
> 
> 时间：2013-02-07T15:47:46.750
> 
> 标签：c#, attributes

有没有办法在调用`CallCommonCode()`时自动调用属性构造函数`CodedMethod()`？

```
using System;

[AttributeUsage(AttributeTargets.Method|AttributeTargets.Struct,
                   AllowMultiple=false,Inherited=false)]
public class CallCommonCode : Attribute
{
    public CallCommonCode() { Console.WriteLine("Common code is not called!"); }
}

public class ConcreteClass {

  [CallCommonCode]
  protected void CodedMethod(){
     Console.WriteLine("Hey, this stuff does not work :-(");
  }
  public static void Main(string[] args)
  {
     new ConcreteClass().CodedMethod();
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:54:10.460

不，因为属性独立于函数而存在。您可以扫描属性或执行功能，但不能同时执行这两项操作。

属性的意义只是用额外的元数据标记东西，但严格来说，它实际上并不是代码本身的一部分。

在这种情况下，您通常会做的是扫描函数上的标记，如果它违反您的业务逻辑，您会抛出某种异常。但总的来说，属性只是一个“标签”。

```
class Program
{
    [Obsolete]
    public void SomeFunction()
    {

    }

    public static void Main()
    {
        // To read an attribute, you just need the type metadata, 
        // which we can get one of two ways.
        Type typedata1 = typeof(Program);       // This is determined at compile time.
        Type typedata2 = new Program().GetType(); // This is determined at runtime

        // Now we just scan for attributes (this gets attributes on the class 'Program')
        IEnumerable<Attribute> attributesOnProgram = typedata1.GetCustomAttributes();

        // To get attributes on a method we do (This gets attributes on the function 'SomeFunction')
        IEnumerable<Attribute> methodAttributes = typedata1.GetMethod("SomeFunction").GetCustomAttributes();
    }
} 
```

# java - Android 开发：从 Main Activity 访问对象的 LinkedList（在 Application 类中定义）

> ID：14755204
> 
> 赞同：0
> 
> 时间：2013-02-07T15:47:53.517
> 
> 标签：java, android, object, linked-list

继较早的线程之后，我想知道创建链表并让它们在多个活动中保持不变。有人建议我扩展应用程序类来做到这一点，所以我决定研究一下。

我已经这样做了，假设我没有把它弄得一团糟，应用程序现在应该用一些我希望在主要活动中使用的示例数据填充一个链表。但我似乎无法访问数据，我有点难过。

刚刚开始使用 android 开发，如果这是一个荒谬的问题，我很抱歉。无论如何，这是我到目前为止所拥有的。

扩展类**GlobalData**

```
package com.example.employeeList;

import java.util.LinkedList;
import android.app.Application;
import android.widget.Toast;

import com.example.employeeList.Employee;

 public class GlobalData extends Application {

 public LinkedList<Employee> EmployeeList;

 @Override
 public void onCreate(){
    super.onCreate();
    createEmployeeLinkedList();
 }

  public void createEmployeeLinkedList(){
    // create a linked list
    Employee emp1 = new Employee("John");
    Employee emp2 = new Employee("Bob");
    Employee emp3 = new Employee("Fred");

    LinkedList<Employee> EmployeeList = new LinkedList<Employee>();
    EmployeeList.add(emp1);
    EmployeeList.add(emp2);
    EmployeeList.add(emp3);

     // The following code works, used for testing to see if linklist was actually being created.
     // Employee boo = newEmployee();
     // Employee boo = EmployeeList.getFirst(); 
     // Toast.makeText(getApplicationContext(), "("+boo.name+")" ,Toast.LENGTH_LONG).show();
 }

 } 
```

**员工**类

```
package com.example.employeeList;

import android.app.Application;

 public class Employee extends Application{

  public String name;

  public Employee(String name) {
     this.name = name;
  }
} 
```

**MainActivity**类

```
package com.example.employeeList;

import android.os.Bundle;
import android.app.Activity;
import android.widget.TextView;
import android.widget.Toast;
import com.example.employeeList.Employee;

public class MainActivity extends Activity {

protected GlobalData globalData;

 @Override
 protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Get the application instance
    globalData = (GlobalData)getApplication();

    //Would have thought I could just do this but apparently not.
    Employee boo = globalData.EmployeeList.getFirst();
    Toast.makeText(getApplicationContext(), "("+boo.name+")" ,Toast.LENGTH_LONG).show();

 }
} 
```

违规行似乎是

```
 Employee boo = globalData.EmployeeList.getFirst();
 Toast.makeText(getApplicationContext(), "("+boo.name+")" ,Toast.LENGTH_LONG).show(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:49:40.200

尝试使 GlobalData 成为 Application 类中的单例，在 GlobalData 类中添加如下内容：

```
 private static GlobalData singleton;

public static GlobalData getInstance() {
    return singleton;
} 
```

那么您也不需要 Employee 类来扩展 Application，它只是一个数据模型类。然后，您将在所有应用程序生命周期中拥有 GlobalData 类的实例（只有一个实例），因此您只需调用应用程序中的每个活动/类/等，例如：

```
GlobalData.EmployeeList.get(0) 
```

或者类似的东西，就这么简单。

请注意，您的 GlobalData 类将在您的应用程序启动时被实例化，并且在 OnCreate 方法中您将创建您的列表，并且它将在所有应用程序执行时间内“活动”。您也可以在您的类中使用 Application 类中的 OnPause 和 OnResume 方法来与应用程序状态更改进行交互。

希望它的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:48:54.983

我认为你应该看看 Parcelable。

[另一个帖子在这里](https://stackoverflow.com/questions/2906925/android-how-do-i-pass-an-object-from-one-activity-to-another)提到了它。

[这里](http://prasanta-paul.blogspot.ca/2010/06/android-parcelable-example.html)有一个例子。

# activereports - ActiveReports 7 文本框/列表分页符

> ID：14755207
> 
> 赞同：0
> 
> 时间：2013-02-07T15:48:01.037
> 
> 标签：activereports

我是 ActiveReports 7 的新手，我有一个 rdlx 报告，它使用存储过程用 TextBoxes 填充多个列表。数据显示正确，但是当它们包含的数据超过页面长度时，我无法让 TextBoxes 中断。相反，TextBox 保持完整，并从下一页开始，留下一个很大的空白。我将包含列表的“KeepTogether”属性设置为“False”，但它没有帮助。如何使这些列表和/或文本框在页面末尾中断并在下一个继续？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T00:53:49.170

检查您拥有的报告类型。有“ActiveReports 7 Page Report”，又名 FPL（固定页面布局）报告和“CPL 报告”（连续页面布局）。

固定页面布局用于为每条记录创建一个新页面。适用于发票和类似报告。您需要一份“CPL 报告”，以便它只根据内容的需要添加页面。

要获取 CPL 报告，请在 Visual Studio 的设计器中执行以下步骤：

1.  项目 > 添加新项目
2.  在此处选择“ActiveReports 7 Page Report”项。
3.  选择报告 > 转换为 CPL 报告。

这些步骤应该有效地将“页面”更改为“正文”。

以下是我用来创建 CPL 报告的步骤，该报告有一个包含很长文本（比页面长）的文本框列表，并且可以跨页面呈现：

1.  添加列表
2.  在列表中添加一个文本框。默认属性应该可以正常工作，但我的文本框上的相关属性是：
    *   TextBox.CanGrow=真
    *   TextBox.WrapMode=WordWrap
    *   List.KeepTogether=False：*尽管从技术上讲，如果文本框/列表大于一页，这应该没问题。KeepTogether=False 如果它从页面的一半开始，它将阻止它移动到新页面。*

如果您仍然没有破解它，请告诉我，我会在此处为您上传我的测试报告。

# javascript - 左对齐文本输入 onblur (IE 8 & 9)

> ID：14755209
> 
> 赞同：5
> 
> 时间：2013-02-07T15:48:02.693
> 
> 标签：javascript, html, textinput

我正在寻找一种在用户触发 onblur 事件时左对齐文本输入框内容的方法。我已经看到提到用 onblur="this.value = this.value" 解决问题，但这在 IE 中不起作用。

澄清：当用户键入超出文本框宽度然后离开焦点时，Internet Explorer 中会出现此问题。在 Chrome 和 Firefox 中，文本会自动左对齐，但在 IE 中不会发生这种情况。

应要求，我附上了代码（在 IE 中查看）：

```
<input type="text" /> 
```

[http://jsfiddle.net/t3hjonneh/FZJjW/](http://jsfiddle.net/t3hjonneh/FZJjW/)

文本域：

![文本域](../Images/c8d71f3a689ebb02e3eeee1b341f858f.png)

打字后：

![打字后](../Images/cdb47f0f03da09abc8838b0c287c1d3b.png)

模糊后：

![模糊后](../Images/c630cf3720e9f9b6e32de2bf12bacde9.png)

它应该看起来如何：

![它应该是什么样子](../Images/fd10ca1ed6283a132e715b32eea23c82.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T18:25:10.270

这与其说是一个正确的解决方案，不如说是一种技巧，但它以某种方式起作用：

```
function blurred(elem) {
    var range;
    // IE only, probably not the best check since it will run in other browsers
    // if they ever implement this feature
    if (elem.createTextRange) {
        range = elem.createTextRange();
        range.collapse(true);
        range.select();
    }
}

<input type="text" onchange="blurred(this);" /> 
```

注意使用`onchange`代替`onblur`。这是因为`select()`在使用时会引起一些麻烦`onblur`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-18T15:50:04.560

这是我模拟的适用于所有主要浏览器的 jQuery 版本：

```
$(document).ready(function(){
        $('input[type=text]').change(function(){
            try{//select nothing but side-effect is that text left justifies
                if(/webkit/.test(navigator.userAgent.toLowerCase())){
                    return;//webkit browsers do it automatically
                } else if(this.createTextRange) { //ie
                    var r = this.createTextRange();
                    r.collapse(true);
                    r.select();
                } else if(typeof this.selectionStart !== "undefined") { //firefox
                    this.selectionStart = 0;
                    this.selectionEnd = 0;
                }
            } catch(err) {
            //?? nobody cares ??
            }
        });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:59:19.287

我只是在该字段上设置一个类，然后在您的 html 中使用 onBlur 启动一个函数：例如`onBlur="left()"`，然后在您的 javascript 中，您可以简单地更改该类`.setAttribute`作为额外的奖励，您还可以将该类的其他属性设置为出色地。

虽然我确实支持发布相关代码的想法

# qt - “QMAKE_CFLAGS = -pipe”的含义

> ID：14755217
> 
> 赞同：-1
> 
> 时间：2013-02-07T15:48:24.823
> 
> 标签：qt, qmake, mxe

我在某个地方看到有人指定`QMAKE_CFLAGS = -pipe`. 除了“加快构建”之外，没有任何解释。它是如何做到这一点的，还有哪些替代选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:53:19.683

变量的内容`QMAKE_CFLAGS`（注意：有几个带有这个前缀的变量）会被转发给C编译器，对qmake过程没有影响。

查看此 SO 线程以了解`-pipe`对您的编译器意味着什么：[我何时应该使用 GCC 的 -pipe 选项？](https://stackoverflow.com/questions/1512933/when-should-i-use-gccs-pipe-option)

# c# - 将数组转换为自定义列表

> ID：14755219
> 
> 赞同：0
> 
> 时间：2013-02-07T15:48:30.100
> 
> 标签：c#

在我的应用程序中，我通过将列表转换为数组将数据写入文本文件，稍后我想通过将其转换为相同的列表类型来加载它并像这样返回它。

我的代码：

```
public abstract class PhoneBookCore
{
    protected string _group;

    public PhoneBookCore(string group)
    {
        this._group = group;
    }
}

public class Group : PhoneBookCore
{
    private List<PhoneBookCore> elements = new List<PhoneBookCore>();

    public List<PhoneBookCore> elementsList { 
         get { return new List<PhoneBookCore>(elements); } 
    }

    public Group(string name)
        : base(name)
    {
    }

class DataOptions
{
    public void Save(Group g)
    {
        string[] lines = g.elementsList.ConvertAll(p => p.ToString()).ToArray();
        File.WriteAllLines(path, lines);
    }

    public Group Load()
    {
        string[] buffer = File.ReadAllLines(path); // ----> How do I convert it back
                                                   //       to list of type group?

        return ;
    }
} 
```

如何将其转换回类型组列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:52:21.927

也许（假设您想将整行传递给 Group-constructor）

```
List<Group> allgroups = File.ReadLines(path)   
    .Select(l => new Group(l))
    .ToList(); 
```

请注意，我使用`File.ReadLines`了它返回流`IEnumerable<string>`而不是 a `string[]`，您也可以使用`File.ReadAllLines`.

但是为什么你总是在`elementsList`属性中创建一个新列表？刚回来`elements`。

**编辑**如果要创建一个组并`elementsList`从行中设置，则需要首先提供属性的设置器：

```
private List<PhoneBookCore> _elementsList = new List<PhoneBookCore>();
public List<PhoneBookCore> ElementsList
{ 
    get { return _elementsList; }
    set { _elementsList = value; }
} 
```

然后您可以通过这种方式初始化和设置组：

```
Group g = new Group(path); // i have no idea
g.ElementsList = File.ReadLines(path)
    .Select(l => new PhoneBookCore(l))
    .ToList();

return g; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T15:56:10.430

您希望将缓冲区列表中的每个字符串项投影到新的 PhoneBookCore 实例。由于您已经在使用 LINQ 扩展，因此以下内容就足够了：

```
elementsList = buffer.Select(s => new PhoneBookCore(s)).ToList(); 
```

# oracle - Oracle 为更新死锁选择排序依据

> ID：14755222
> 
> 赞同：1
> 
> 时间：2013-02-07T15:48:39.413
> 
> 标签：oracle

我收到了以下 oracle 日志：

```
DEADLOCK DETECTED ( ORA-00060 )

[Transaction Deadlock]

The following deadlock is not an ORACLE error. It is a
deadlock due to user error in the design of an application
or from issuing incorrect ad-hoc SQL. The following
information may aid in determining the deadlock:

Deadlock graph:
                       ---------Blocker(s)--------  ---------Waiter(s)---------
Resource Name          process session holds waits  process session holds waits
TX-00120007-0002acbf        82     185     X             67     240           X
TX-0008001c-0009ed94        67     240     X             82     185           X

session 185: DID 0001-0052-00000004 session 240: DID 0001-0043-00000004 
session 240: DID 0001-0043-00000004 session 185: DID 0001-0052-00000004 

Rows waited on:
  Session 185: obj - rowid = 0001285C - AAAShcAAiAAEoVFAAi
  (dictionary objn - 75868, file - 34, block - 1213765, slot - 34)
  Session 240: obj - rowid = 0001285C - AAAShcAAiAAEoRWAA3
  (dictionary objn - 75868, file - 34, block - 1213526, slot - 55)

----- Information for the OTHER waiting sessions -----
Session 240:
  sid: 240 ser: 7 audsid: 32762787 user: 76/NETCRACKER1
    flags: (0x8000041) USR/- flags_idl: (0x1) BSY/-/-/-/-/-
    flags2: (0x40008) -/-
  pid: 67 O/S info: user: oracle, term: UNKNOWN, ospid: 26869908
    image: oracle@opipodb1
  client details:
    O/S info: user: adipoas1, term: unknown, ospid: 1234
    machine: opipoas1 program: JDBC Thin Client
    application name: JDBC Thin Client, hash value=2546894660
  current SQL:
  select o.object_id
  from nc_objects o,
       (select object_id
          from nc_objects
        connect by prior object_id = parent_id
         start with object_id = :a1
        union
        select object_id
          from nc_references
         where reference in (select object_id
                               from nc_objects
                             connect by prior object_id = parent_id
                              start with object_id = :a1)) ids
 where o.object_id = ids.object_id
 order by o.object_id
   for update of o.object_id

----- End of information for the OTHER waiting sessions -----

Information for THIS session:

----- Current SQL Statement for this session (sql_id=3mxkkzhttwa2q) -----
select o.object_id
  from nc_objects o,
       (select object_id
          from nc_objects
        connect by prior object_id = parent_id
         start with object_id = :a1
        union
        select object_id
          from nc_references
         where reference in (select object_id
                               from nc_objects
                             connect by prior object_id = parent_id
                              start with object_id = :a1)) ids
 where o.object_id = ids.object_id
 order by o.object_id
   for update of o.object_id
=================================================== 
```

这是否意味着两个相等的查询（但可能使用不同的数据）已相互锁定？

如果是这样，怎么会发生？- 这个查询锁定有序序列，我想我们这里不能有死锁。

DB 是元模型 object_id - PK

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T16:12:27.690

[ORDER BY 不会总是防止死锁](https://stackoverflow.com/questions/11311951/should-select-for-update-always-contain-order-by)。

这是导致查询死锁的可能情况：

1.  会话 1 运行您的查询`:id=A`
2.  会话 2 运行您的查询`:id=B`
3.  会话 1 运行您的查询`:id=B`，会话 1 现在正在等待会话 2
4.  会话 2 运行您的查询`:id=A`，发出死锁

当您发出时`SELECT FOR UPDATE`，您冒着等待另一个会话的风险。如果此会话已经在等待您，则存在死锁。

在 OLTP 环境中避免死锁的一种常见方法是仅发出`SELECT FOR UPDATE NOWAIT`. 让第二个会话失败而不是等待。

* * *

### 更新以下评论

您有多个会话更新同一个表。你有机会互相阻挡。如果您让他们等待并且他们更新了不止一行，您就有可能出现死锁。你有很多选择来管理这个：

1.  让会话陷入僵局。Oracle 将自动检测到这一点并回滚。[Oracle 只会回滚其中一个会话的最后一条语句，而不是整个事务](http://jonathanlewis.wordpress.com/2013/02/22/deadlock-detection/)，这意味着收到错误的会话应该先**回滚**，然后再重试。

2.  按照我的建议，用 NOWAIT 运行它们。
    如果你不想让他们失败，你可以：

    1.  用 NOWAIT 锁定行
    2.  如果 ORA-56**回滚**
    3.  睡眠后（X 秒）从事务开始重试。

    您需要回滚以确保两个会话不会无限期地相互阻止。

3.  序列化更新。这通常是通过确保只有一个会话可以同时更新表（或一系列行）来完成的。
    例如，您可以让所有会话在事务表中插入，并让单个作业将修改合并到最终表中。并发会话不能互相阻止。这显然会推迟对主表的更新（至少在提交之后）。

我不会建议选项 1，因为您无法控制死锁检测（因此您无法优化它）。

# adfs2.0 - 如何避免 ADFS 登录页面？

> ID：14755224
> 
> 赞同：2
> 
> 时间：2013-02-07T15:48:48.077
> 
> 标签：adfs2.0, sts-securitytokenservice, loginview

有没有机会避免下图所示的 ADFS 登录窗口？我已将自定义 STS 配置为 ADFS 上的声明提供程序信任，因此我现在有两个选项。有没有办法在此处自动设置默认值并跳过此页面？

![在此处输入图像描述](../Images/3f3cba8cfc66daf49dd4641b3cd333eb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:35:49.947

请注意，这不是登录页面 - 它是 Home Realm Discovery (HRD) 页面。

如果你有：

```
<persistIdentityProviderInformation enabled="true" lifetimeInDays="30" /> 
```

在您的 web.config 中设置，它只会询问您一次，然后记住您选择的“lifetimeInDays”天数。

您可以更改 HRD 页面 - 对此有很多参考，例如

[自定义客户端登录和家庭领域发现页面](http://msdn.microsoft.com/en-us/library/windows/desktop/bb625464%28v=vs.85%29.aspx)
[ADFS 2.0 家庭领域发现豪华](http://www.idmcrisis.com/post/2011/11/03/ADFS-20-Home-Realm-Discovery-Deluxe.aspx)
[家庭领域在 WIF 和 ADFS 2.0 中通过查询字符串发现](http://blog.torresdal.net/2010/04/19/home-realm-discovery-in-wif-and-adfs-2-0-by-query-string/)

# web2py - Web2py 日期格式

> ID：14755227
> 
> 赞同：0
> 
> 时间：2013-02-07T15:48:55.603
> 
> 标签：web2py

大家好，我对 web2py 的这种日期格式有疑问。我只想显示月-日-年，但我得到的是年-月-日时-分-秒。这是我正在使用的代码

```
db.define_table('time',
    Field('date_made', 'datetime', default=request.now)) 
```

当我显示它时给定的输出是： 2013-1-15 12:24:20 我希望输出看起来像 2013-1-15 或 1-15-2103 没有时间，所以我可以比较日期。我已经在网站上搜索并[在 Web2py Python 中找到了这个格式化日期，](https://stackoverflow.com/questions/12605934/formating-date-in-web2py-python)但并不完全想像那样实现它，因为我试图在一个字段中定义它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-05T01:50:41.217

在 web2py 中创建日期输入格式的正确方法是

```
db.define_table('time',
   Field('date_made', 'datetime', default = request.now, requires = IS_DATE(format=('%d-%m-%Y'))) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-11T20:42:10.187

我希望这对你有帮助....

```
from datetime import datetime
db.define_table('time',
    Field('date_made', 'datetime', default=lambda:datetime.now()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-29T14:33:01.227

你能试试这个。

```
 Field('field_name', 'datetime', default=now) 
```

我发现[这里](https://books.google.co.in/books?id=vB2-BAAAQBAJ&pg=PA176&lpg=PA176&dq=store%20now%20time%20in%20dal%20web2py%20field&source=bl&ots=6Mjb_AK2go&sig=JroYkjFc0mH3gDZc3eGNIByepBM&hl=en&sa=X&ved=2ahUKEwibjqq5wsTcAhVMuI8KHYOpCDMQ6AEwBHoECAUQAQ#v=onepage&q=store%20now%20time%20in%20dal%20web2py%20field&f=false)对我有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-24T19:14:32.453

现在导入日期时间 = datetime.datetime.today()

字段('date_today','datetime', default=now)

更多参考点击[这里](http://www.web2py.com/books/default/chapter/29/07/forms-and-validators)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-08T15:03:06.600

我也刚开始 web2py，所以我不知道这是否会有所帮助。但是您可以为字段定义格式，所以这样做可能会有所帮助：

```
Field('date_made', 'datetime', default=request.now, format=('%d-%m-%Y')) 
```

# amazon-web-services - 我可以恢复有关 S3 分段上传的丢失信息吗？

> ID：14755233
> 
> 赞同：0
> 
> 时间：2013-02-07T15:49:27.010
> 
> 标签：amazon-web-services, amazon-s3

在这个[分段上传示例](http://docs.aws.amazon.com/AmazonS3/latest/dev/LLuploadFileDotNet.html)中，需要保存上传 ID 和与每个上传的部分对应的一组 etag，直到上传“关闭”。如果我丢失了上传 ID，我想我可以通过使用[ListMultipartUploads](http://docs.aws.amazon.com/AmazonS3/latest/dev/LLlistMPuploadsDotNet.html)查看打开的分段上传来恢复它，但是**如果我丢失了 etag 怎么办？** 可以以某种方式恢复这些，还是我必须中止整个转移并重新开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:59:35.650

从 ListMultipartUploads 检索到上传 ID 后，您可以使用 ListParts 获取已为此上传完成的部分（及其 etag）列表。您可以使用此信息从最后完成的部分重新开始上传。

[分段上传 API 和权限](http://docs.aws.amazon.com/AmazonS3/latest/dev/mpuAndPermissions.html)

[使用适用于 iOS 的 AWS 开发工具包恢复分段上传的示例](https://forums.aws.amazon.com/thread.jspa?threadID=100323&tstart=0)

# android - Vitamio ffmpeg 版本

> ID：14755239
> 
> 赞同：3
> 
> 时间：2013-02-07T15:49:46.367
> 
> 标签：android, ffmpeg, vitamio

有没有人成功修改过 Vitamio 中使用的 ffmpeg 版本？我已经应用了一个适用于 linux 的补丁，并将其编译为 android 的 libffmpeg.so。如何让 Vitamio 从此库而不是捆绑包中包含的库运行？

有任何想法吗？

谢谢，

担

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T06:37:35.413

## 要求

Vitamio 3.0 使用 Android *NDK r8b 构建*，因此建议使用 NDK r8b 构建您的自定义 FFmpeg。根据开发人员的反馈，如果使用其他 NDK 修订版，会出现很多问题和崩溃。

## 构建 FFmpeg

[首先从我们的 GitHub http://github.com/yixia/FFmpeg-Android](http://github.com/yixia/FFmpeg-Android)克隆 FFmpeg-Android 库。然后调整*FFmpeg-Android.sh*以满足您自己的需要。

最常见的场景是你想在你的应用程序中编译几个特定的​​ FFmpeg 模块，而不需要任何其他质量。在这种情况下，您需要做的就是修改`FFMPEG_FLAGS`shell 脚本中的 。所有可用参数都在 FFmpeg 的配置脚本中有详细记录`configure --help`。

在极少数情况下，如果您想修补 FFmpeg，您需要做更多的工作，我只是认为您可能具备执行此操作的所有知识。实际上，您只需要了解 FFmpeg-Android.sh 或制作自己的构建脚本。

最后，在 bash 中运行 FFmpeg-Android.sh。这是一个 bash 脚本，也可以在 zsh 中运行。

## 捆绑 libarm.so

在 VitamioBundle 中找到文件*res/raw/* libarm.so

```
=> file res/raw/libarm.so 
res/raw/libarm.so: 7-zip archive data, version 0.3 
```

是的，你找到了神奇之处，它是一个 7-zip 文件，所以无论如何都要解压缩它，并用你自己的构建替换每个 libffmpeg.so。

```
60 <=> armv6
61 <=> vfp
70 <=> armv7
71 <=> neon 
```

最后再次将所有数据归档到*libarm.so*。

**来源：** [https ://www.vitamio.org/en/2013/Tutorial_0509/13.html](https://www.vitamio.org/en/2013/Tutorial_0509/13.html)

# r - pdf字体和图形格式（win.graph）

> ID：14755244
> 
> 赞同：2
> 
> 时间：2013-02-07T15:50:06.510
> 
> 标签：r, graph, fonts, pdf-generation

我最近在 R 中遇到了一个问题，在这个组合中我试图解决并在互联网上搜索，但我还无法解决。我希望有一个人可以帮助我。

我在 Windows 7 上运行 R(x64)。图形设备本身自动使用 Arial 作为字体，当我将图形保存为位图时，“字体”自然保持原样。但是，我更喜欢将图形保存为 pdf，在这种情况下，当我通过 GUI 保存按钮保存时，生成的 pdf 中的字体会与 Helvetica 交换。

我在互联网上找到了一个解决方案，使用 Arial afm-Files 和 pdf("Test_Auto.pdf", family = "Arial")，这导致使用 Arial 作为字体的 pdf --- 到目前为止一切都很好。

现在我还经常不得不/想要使用 win.graph 更改图形布局，这就是问题开始的地方。这是一个例子：

```
Arial <- Type1Font(family = "Arial", metrics = c("C:/R_Fonts/ArialPlain.afm", "C:/R_Fonts/ArialBold.afm", "C:/R_Fonts/ArialItalic.afm", "C:/R_Fonts/ArialBoldItalic.afm"))
pdfFonts(Arial = Arial)

setwd("C:/PDFCrop")
D1<-matrix(c(1,2,3,4,6,3),3,2)
D2<-matrix(c(1,2,3,5,3,1),3,2)

#pdf("Test_Auto.pdf", family = "Arial")
win.graph(8.3,12,12)
layout(matrix(c(1,2),1,2,byrow=TRUE))
plot(D1,type="l",main="Gobble R")
plot(D2,type="l",main="Gobble R")
#dev.off() 
```

现在这段代码可以创建一个看起来像我想要的图形，但我必须手动保存图形（文件->另存为），然后我将 Helvetica 作为 pdf 中的字体。

或者我可以改变下部

```
pdf("Test_Auto.pdf", family = "Arial")
#win.graph(8.3,12,12)
layout(matrix(c(1,2),1,2,byrow=TRUE))
plot(D1,type="l",main="Gobble R")
plot(D2,type="l",main="Gobble R")
dev.off() 
```

这会产生一个实际使用 Arial 的 pdf 文件，但该图具有我想要的其他维度。当两者一起使用时，我得到一个“无法打开，因为它不包含任何页面”的 pdf（尽管它的大小不是 0KB）。

有什么方法可以让它工作，或者可以在 pdf() 和 dev.off() 之间使用 win.graph 的替代方法吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T12:54:36.927

天哪，对不起，我太笨了！

在我完全忽略的所有过程中，pdf-device 有自己的大小参数。

```
Arial <- Type1Font(family = "Arial", metrics = c("C:/R_Fonts/ArialPlain.afm", "C:/R_Fonts/ArialBold.afm", "C:/R_Fonts/ArialItalic.afm", "C:/R_Fonts/ArialBoldItalic.afm"))
pdfFonts(Arial = Arial)

setwd("C:/PDFCrop")
D1<-matrix(c(1,2,3,4,6,3),3,2)
D2<-matrix(c(1,2,3,5,3,1),3,2)

pdf("Test_Auto.pdf", width=8.3, height=12, family = "Arial")
#win.graph(8.3,12,12)
layout(matrix(c(1,2),1,2,byrow=TRUE))
plot(D1,type="l",main="Gobble R")
plot(D2,type="l",main="Gobble R")
dev.off() 
```

谢谢你的提示，DWin

# javascript - 单击时制作动画切换

> ID：14755251
> 
> 赞同：-1
> 
> 时间：2013-02-07T15:50:33.930
> 
> 标签：javascript, jquery, css

你好，我有以下...

```
 <span id="second" class="content1" style="width:0px; display:inline-block; overflow:hidden; float: left; white-space:nowrap;">
                    <p style="color:blue; background-color: #b5bdc8;">Camera Reviews</p>
                  </span>
                  <a href="#" class="slide1" style="float: left;"><li class="laptop"></li></a> 
```

脚本是：

```
$(document).ready(function () {
          $('.slide1').click(function () {
          $('#second').animate({
               width: '120px',
           }, 1000);
       });
 }); 
```

问题是我希望列表显示为 BLOCK... 并按原样工作另外我希望动画在我单击列表隐藏/显示时切换

这里的工作代码：http: [//jsfiddle.net/gVjFs/81/](http://jsfiddle.net/gVjFs/81/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:01:34.003

在您的 JSFiddle 中，您表明您正在将 CSS 设置为`block`for `ul li`。但这不起作用，因为您的 HTML 中没有任何`ul`标签。您似乎也`li`错误地使用了标签。`li`标签就像一个标签`td`：它在其父标签之外没有意义。For `li`'s 那将是一个`ol`或一个`ul`标签。如果您想点击一个小圆圈，请使用一个小圆圈的图像。`span`此外，将/`a`部分包装在`div`. 这将免费为您提供被阻止的显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:02:22.337

我将忽略狡猾的标记（除其他外）`<li>`。`<span>`你可以[`toggle()`](http://api.jquery.com/toggle/)在这里使用：

```
$('.slide1').toggle(function () {
    $('#second').stop().animate({
        width: '120px',
    }, 1000);
}, function(){
    $('#second').stop().animate({
        width: '0',
    }, 1000);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:03:14.653

使用 click() 和[toggleClass()](http://api.jquery.com/toggleClass/)的组合 像这样：

```
$("#click").click(function() {
    $(this).toggleClass('whatever');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:07:06.880

```
$(document).ready(function () {
    $('.slide1, .slide2, .slide3, .slide4, .slide5').click(function () {
        var elem = $('.' + $(this).attr('class').replace('slide','content')),
            width = elem.width();
        elem.animate({
            width: width === 0 ? '120px' : 0,
        }, 1000);
    });
}); 
```

**[演示](http://fiddle.jshell.net/NeHS7/)**

我建议您为`slide`所有元素设置一个类`.slide1, .slide2, .slide3`。

# html - 修复 ie7 中不显示的绝对位置溢出

> ID：14755253
> 
> 赞同：0
> 
> 时间：2013-02-07T15:50:49.230
> 
> 标签：html, css, css-position, internet-explorer-7

我正在构建一个设计并且已经完成了它，但是我定位的一个项目绝对不会在 IE7 中显示溢出。它适用于除 IE7 之外的所有浏览器。我不支持 ie6。div/image 不会在 IE7 中显示超出其父容器的任何内容。我尝试了更高的z-index，溢出：可见但没有成功..绝对定位的div位于第一个菜单项左侧的顶部导航栏中..应该很明显

网站在[这里](http://modernlogic.co/pureblend)

感谢您的任何帮助或建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:55:25.267

要在 IE7 中修复它，请执行以下操作：

消除：

> 位置：相对；

从`.navbar-inner`

将它放在内部有点多余，因为它的容器已经设置为相对位置（它们的大小/形状相同）。如果没有它，它将在内部 div 上产生相同的效果，并为您提供您正在寻找的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:04:55.867

尝试为 .navbar-inner 赋予比绝对定位 DIV 更高的 z-index 值。

我会将您的绝对定位元素 z-index 减少到 100 左右，并使 .navbar-inner 101。

# jquery - 设置文本区域内容时防止jQuery转义

> ID：14755254
> 
> 赞同：1
> 
> 时间：2013-02-07T15:50:48.980
> 
> 标签：jquery

我将一些已经转义的文本放到页面上，然后使用带有该文本的 jQuery 设置文本区域的内容。但它再次被逃脱。我不想逃避进入页面的文本，因为它是来自数据库的用户输入文本。

```
<script type="text/javascript">
jQuery('#load-template-link').click(function (event) {
    var content = jQuery('#template-' + jQuery('#template_selector option:selected').val());

    if (content.length > 0) {
        jQuery('#text-area').val(content.html());
    }

});
</script>

{% for template in templates %}
<script type="text/template" id="template-{{ template.id }}">{{ template.body }}</script>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:55:58.307

您尝试使用 text() 而不是 html() 吗？

```
content.text() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:53:37.933

如果`escape`您的意思是将 html 转换为实体，那么它就是`.html`执行此操作的函数。使用`.text`：

```
> $("<div>&></div>").html()
"&amp;&gt;"
> $("<div>&></div>").text()
"&>" 
```

# java - 提交按钮以提交表单并使用 jquery form-wizard 转到下一个屏幕

> ID：14755260
> 
> 赞同：5
> 
> 时间：2013-02-07T15:51:03.197
> 
> 标签：java, jquery, jquery-form-wizard

我正在使用[jquery FormWizard](http://thecodemine.org)并希望在最后一个屏幕上使用提交按钮作为提交表单并转到下一个屏幕的一种方式。

问题是我将这个 jquery 脚本嵌入到我的 Java 代码中。现在我有一个来自 jquery 表单向导的“提交”按钮，我有一个来自我的 Java 代码的“继续”按钮。因此，用户通过按“提交”提交表单，然后按“继续”进入下一个屏幕。对用户来说不是一个理想的情况。

如果我只使用**“继续”**而不按提交，它不会存储表单的任何信息。一旦我按**“提交”**然后**“继续”**，表格上的所有信息都将保存在数据库中。如何使用**继续**按钮作为提交并继续到下一个屏幕，这样我就不需要最后一个屏幕上的提交按钮。

```
Script sc = new Script();
sc.add("$(function(){$('#formScreenQuestions').formwizard({formPluginEnabled: true,validationEnabled: true,focusFirstInput : true,disableUIStyles : true});});");
HEADER.add(sc); 

Form form = new Form("criteria");
form.set(ID, "formScreenQuestions");
Div dh = new Div();
dh.set(ID, "lastStep");
dh.set(CLASS,"step");
Table vt = new Table();
vt.row();
vt.cell(text("Please press SUBMIT before pressing CONTINUE"));
==== showing some questions with checkboxes to select =====
dh.add(vt);
Div db = new Div();
db.set(ID,"navigation");
Table bt = new Table();
bt.row();
bt.cell("<input type='reset',id='back',value='Back' />");
bt.cell("<input type='submit',id='next',value='Next' />");      
db.add(bt); 

form.add(dv);
form.add(db); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T23:48:06.367

您可以在表单中添加“提交时”事件。

[http://api.jquery.com/submit/](http://api.jquery.com/submit/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T05:56:52.500

如果提交正常，则进行服务器端重定向，到下一页。

**或者**

在提交回调上做一个 $("#continueButton").click();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T15:59:30.063

如果我理解正确，formWizard 只是帮助您使用向导将表单分成多个步骤。
您不能只绑定单击按钮，因为它会在下次单击时触发。

你应该做的是使用 formWizard 中的这个事件，这样你就不会增加复杂性，因为你不会覆盖你正在使用的插件的任何功能：

```
$("#demoForm").bind("after_remote_ajax", function(event, data){
    if(event.success && event.currentStep === finalStep) {
        windows.location.href="要转发到的 URL";
    }
});

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T16:20:15.440

可能最好的方法是使用 jQuery 的提交事件并使用 AJAX 将其提交到服务器：

```
$("#form-name").submit(function(){
  $.post("submit-path", function(result){
   // do something with result
  });
  return false;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T19:57:03.300

如果您使用的是 JQuery——为什么不使用 AJAX 的力量并让它更好的用户体验——

在继续按钮上定义一个 jQuery 事件：

```
 $("#continue-button").click(function(){
           windows.location.href="URL to be forwared to";
    }): 
```

单击提交按钮提交 AJAX 请求（查看 jquery 的 AJAX 方法的文档，了解如何显示处理图标）

AJAX 请求：

```
$.ajax({
    url : actionURL,
    dataType : <your dataType>,
    contentType : <your Content Type>,
    type : 'post',
    data : <bla bla>,
    success : function(data) {
        //Show Continue button              
    }
    });
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T12:23:34.217

我认为这是一个设计问题。如果您正在尝试创建一个多步骤表单，其中在每个步骤之间保存数据，您应该在表单的每个步骤上都有一个提交按钮，将数据提交到服务器，使用输入隐藏值跟踪步骤然后发送表格的下一部分给客户。它更安全，因为即使客户端未启用 javascript，您的表单也能正常工作。在这样的设计中，可以稍后改进该过程以添加 AJAX 功能。

如果您不需要在每个步骤之间发送数据，那么您可以为每个子表单创建一个带有某种面板的表单，这些子表单将根据客户端的位置显示或隐藏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-01T11:35:59.137

如果您使用 jquery 表单中的继续按钮，并从 Java 中删除提交按钮，会不会更好？

```
$(function(){
    // bind a callback to the before_step_shown event
    $("#demoForm").bind("before_step_shown", function(event, data){
            if(!data.isBackNavigation){
            doSubmit();
            }

    });
}); 
```

# php - 联系表格的正则表达式替换

> ID：14755265
> 
> 赞同：1
> 
> 时间：2013-02-07T15:51:18.870
> 
> 标签：php, regex, preg-replace

在php中，我有以下正则表达式：

```
$regexp = "/^([-a-z0-9.,!@'?_-\s])+$/i"; 
```

我试图验证我的网站联系表（特别是消息字段）以确保没有输入讨厌的代码。我遇到的问题是我需要允许某些正常的标点符号和字符，但我担心它们可能被用来插入恶意代码。

对于不遵守上述表达式的任何字符，我想替换它以使其安全。两个问题：

1.  我该如何更换？
2.  我应该用什么替换字符？例如，我不允许括号`( )`。像这样替换`"(" ")"`还是最好的做法`\( \)`？

编辑

数据将发送到电子邮件地址并保存到数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:12:15.040

嗯，你为什么不让每个字符都插入到联系表单中，一旦表单提交后到达 php 脚本，就用[htmlentities将它们全部转换？](http://www.php.net/manual/en/function.htmlentities.php)这样您的用户将能够说出他们想要的内容，并且您不会对“恶意代码”有任何问题:)

```
And do not forget to use a proper database wrapper (PDO)
or at least escape when inserting into the database.

– knittl 
```

编辑：添加了 Knittl 的引用再次强调它:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T03:22:42.623

使用[过滤器扩展](http://www.php.net/manual/en/book.filter.php)。更具体地说，使用[`filter_input()`](http://php.net/filter_input)带有[消毒过滤器](http://www.php.net/manual/en/filter.filters.sanitize.php)的功能。例如：

```
$message = filter_input(INPUT_POST, 'message', FILTER_SANITIZE_STRING); 
```

这将确保标签被从消息中去除，并且处理起来更安全。

但是，这并不*意味着*您应该将其视为 100% 安全。将消息保存到数据库时仍然需要采取预防措施（例如使用数据库驱动程序的转义方法，并从消息中删除不需要/不需要/可疑的内容），并确保输出到客户端是安全的.

# php - 我应该在每次请求时动态生成每个缩略图，还是将它们存储在图像上传中？

> ID：14755277
> 
> 赞同：8
> 
> 时间：2013-02-07T15:51:41.147
> 
> 标签：php, image, web-applications, upload, thumbnails

**问题**- 我想在我的网站中设置图像上传功能。但我想同时显示原始图像和图像的小缩略图。

**选择**- 哪种方式更好 - 上传图像时在目录中创建单独的图像（缩略图），或者每次请求图像时通过以固定比例减小其高度和宽度来显示较小的版本？

**我目前是如何做**的 - 后一个对我来说听起来更好，因为它不会在磁盘上占用太多空间，但它必须一次又一次地调整图像大小。你觉得哪一个更好？

这是 Web 应用程序的一般问题，没有特定的语言。

知道 facebook 或 google 是如何做到的吗？

**问题**- 我的问题是如何生成缩略图并在网站上显示它们 - 通过创建具有较小尺寸的原始图像的副本或在每次请求时动态生成缩略图。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T15:54:42.580

在上传时创建缩略图几乎总是更好的选择。如果存储是一个问题，您可以在请求中转换它们，然后将结果缓存在内存存储中。如果在缓存过期之前再次请求它，则不需要转换。

存储通常很便宜，所以我可能不会考虑那种额外的复杂性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T15:56:43.560

只需创建一个缩略图版本并保存到磁盘。硬盘空间非常便宜。几个 TB 70 英镑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T15:57:54.547

创建缩略图是一个更好的选择，它不会占用太多磁盘空间。您的客户端在打开页面时也会加载较小的尺寸。根据请求转换图像将花费更多时间来加载您的页面；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T15:57:58.867

如果您查看大多数具有此内置功能的 CMS，它们几乎总是会在上传时创建图像的缩略图并将其存储在服务器上。

这可以追溯到“做谷歌所做的事情”但使用 CMS 的古老说法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-07T16:43:34.557

“更好”取决于您设置的标准。

对于大多数应用程序来说，磁盘空间不是问题——如果存储缩略图是一个问题，那么存储原件肯定是一个大问题——一张像样的数码相机照片将运行到许多兆字节，而缩略图不应超过 50K。

带宽和性能（客户认为）通常是更大的问题。如果您有很多人浏览图像缩略图库，那么提供 50Kb 缩略图将比提供数兆字节的高分辨率图像快得多（并且带宽更便宜）。

此外，通过在 URL 上提供缩略图`<img src="images/thumbnail/foobar.jpg">`并设置适当的缓存标头，您应该获得大量下游缓存 - 如果您提供图像，这种可能性较小，`<img src="thumbnail.php?image=image/foobar.jpg>`因为缓存对查询字符串的处理相当保守。

我曾经在一个管理数十万张产品图片的网站上工作；我们将[ImageMagick](http://www.imagemagick.org/script/index.php)设置为自动创建缩略图。根据您的设置，在第一次请求缩略图时而不是在文件上传时执行此操作可能更有意义，因为转换可能会占用大量资源，并且在上传时执行此操作将花费比我们想要等待的时间更长的时间. 现代硬件可能会使这成为一个问题。

还有一个关于保持缩略图与原件同步的问题——如果用户上传了新图像，你必须确保你得到了更新的缩略图；如果原件被删除，您还必须删除缩略图。

# c# - 如何运行应用程序并将用户名和密码传递给该应用程序

> ID：14755280
> 
> 赞同：0
> 
> 时间：2013-02-07T15:51:46.357
> 
> 标签：c#, oracle, login

我想从 c# 窗体应用程序运行 oracle 10g 企业版应用程序，并且我想将用户名和密码自动传递到 oracle 的登录页面……oracle 必须登录，无需任何努力输入登录用户名和密码。

我可以通过以下代码运行应用程序：

```
Process.Start("sqlplusw.exe"); 
```

但我不知道如何从 c# 表单自动将用户名和密码传递给该应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:55:39.990

从[文档中](http://docs.oracle.com/cd/B10501_01/win.920/a92157/ch3.htm)：

> 您可以选择包含用斜杠 (/) 分隔的登录用户名和密码，以及要连接到的远程数据库，例如：
> 
> `C:\> SQLPLUSW username/password@connect_identifier`

因此，您应该能够：

```
Process.Start("sqlplusw.exe", "username/password@connect_identifier"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:01:42.257

我找到了这个：

```
sqlplus user/password@dbname 
```

这里[http://www.fehily.com/books/createdb/sql-3rd-oracle-10g.html](http://www.fehily.com/books/createdb/sql-3rd-oracle-10g.html)

这是你的意思吗 ？

# php - Magento Soap V2 目录ProductListOfAdditionalAttributes 未被识别。

> ID：14755283
> 
> 赞同：2
> 
> 时间：2013-02-07T15:51:52.130
> 
> 标签：php, api, magento, soap

我正在阅读磁电机文档，其中有一个部分显示了如何检索产品的附加属性。

[http://www.magentocommerce.com/api/soap/catalog/catalogProduct/catalog_product.listOfAdditionalAttributes.html](http://www.magentocommerce.com/api/soap/catalog/catalogProduct/catalog_product.listOfAdditionalAttributes.html)

他们展示的示例之一是 Soap V2 的以下示例......

```
$proxy = new SoapClient('http://magentohost/api/v2_soap/?wsdl'); // TODO : change url
$sessionId = $proxy->login('apiUser', 'apiKey'); // TODO : change login and pwd if necessary

$result = $proxy->catalogProductListOfAdditionalAttributes($sessionId, 'simple', '13');
var_dump($result); 
```

好吧，我尝试了该示例，但出现了肥皂错误。说以下

```
Fatal error: Uncaught SoapFault exception: [Client] Function ("catalogProductListOfAdditionalAttributes") is not a valid method for this service 
```

我在 wsdl xml 页面中查找了该方法，但找不到与它远程匹配的任何内容。那么文档过时了吗？我的 wsdl 过期了还是这里发生了什么？我正在使用 v2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T20:55:41.727

弄清楚了...

```
$attributeList = $fclient->catalogProductAttributeList($fsession, $prod->set); 
```

以上为您提供了额外的核心属性。其中 $prod->set 是产品属性集编号。

甚至更好。如果您想获取所有特定产品的属性值，您可以执行以下操作

```
 foreach($attributeList as $attr) {
            $attributes->additional_attributes[] = $attr->code;
        }
        $prodInfo = $fclient->catalogProductInfo($fsession, $prod->product_id, null,$attributes); 
```

以上将返回附加属性中的所有产品属性值，包括核心值和自定义值。

# sql - SQL 在比较连续 DataRows 中的值时使用 PARTITION

> ID：14755293
> 
> 赞同：2
> 
> 时间：2013-02-07T15:52:27.493
> 
> 标签：sql

我正在使用 SQL 语句来比较字段 [Allocation] 的连续值，如下所示：

```
;WITH cteMain AS
(SELECT AllocID, CaseNo, FeeEarner, Allocation, ROW_NUMBER() OVER (ORDER BY AllocID) AS sn
FROM tblAllocations)

SELECT m.AllocID, m.CaseNo, m.FeeEarner, m.Allocation, 
       ISNULL(sLag.Allocation, 0) AS prevAllocation,
      (m.Allocation - ISNULL(sLag.Allocation, 0)) AS movement
FROM cteMain AS m

LEFT OUTER JOIN cteMain AS sLag
ON sLag.sn = m.sn-1; 
```

该查询返回一个计算字段 [movement]，它是 [Allocation] 的连续值的增加或减少。

我已包含此查询返回的数据的屏幕截图。

![返回数据截图](../Images/92191d17cd4a72ce6b22fe32f7fd50ea.png)

但是，查询尚未完成。我需要修改语句，以便比较的 [Allocation] 的连续值由 [FeeEarner] 和 [CaseNo] 分组/分区。

例如，在数据的第 18 行，[Allocation] 为 800，并与之前的值 600 进行比较。但之前的值属于不同的 [CaseNo]，即 6 而不是 31。实际上 [FeeEarner] 'PJW ' 在 [CaseNo] '31' 上没有先前的 [Allocation]，因此 [prevAllocation] 应该是 ISNULL 关键字中的 '0'。

我试过改变

```
OVER (ORDER BY AllocID) 
```

到

```
OVER (PARTITION BY CaseNo, FeeEarner ORDER BY AllocID) 
```

但这会导致大量数据行重复。

有人可以建议如何比较 [Allocation] 的连续值，但只能在具有匹配 [FeeEarner] 和 [CaseNo] 的数据行之间进行比较吗？

**注意**- 我不能使用 LAG，因为我的客户使用的是不支持并行数据仓库的 SQL Server 2008 R2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:02:39.287

我相信你很亲近。试试这个（注意在 join 子句中添加的部分来匹配分区 - 如果没有这个，你将匹配每个行号 3 与每个行号 2*跨分区*，这就是你所看到的）：

```
;WITH cteMain AS
(
    SELECT AllocID, CaseNo, FeeEarner, Allocation, 
        ROW_NUMBER() OVER (PARTITION BY CaseNo, FeeEarner ORDER BY AllocID) AS sn
    FROM tblAllocations
)    
SELECT m.AllocID, m.CaseNo, m.FeeEarner, m.Allocation, 
       ISNULL(sLag.Allocation, 0) AS prevAllocation,
      (m.Allocation - ISNULL(sLag.Allocation, 0)) AS movement
FROM cteMain AS m

LEFT OUTER JOIN cteMain AS sLag
    ON sLag.CaseNo = m.CaseNo
    AND sLag.FeeEarner = m.FeeEarner
    AND sLag.sn = m.sn-1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:59:00.857

您还需要更改加入条件：

```
FROM cteMain m LEFT OUTER JOIN
     cteMain sLag
     ON sLag.sn = m.sn-1 and sLag.FeeEarner = m.FeeEarner and slag.CaseNo = m.CaseNo 
```

此外，您应该只有一个`order by`在`row_number()`通话中。

此外，如果您使用的是 Oracle、SQL Server 2012、较新版本的 DB2 或 Postgres，那么`lead()`/`lag()`函数将是更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:52:08.963

OUTER APPLY 和 EXISTS 的另一种选择

```
SELECT t1.AllocID, t1.CaseNo, t1.FreeEarner, t1.Allocation, 
       ISNULL(o.Allocation, 0) AS PrevAllocation, 
       (t1.Allocation - ISNULL(o.Allocation, 0)) AS movement
FROM tblAllocations t1 
OUTER APPLY (
             SELECT t2.AllocID, t2.CaseNo, t2.FreeEarner, t2.Allocation
             FROM tblAllocations t2
             WHERE EXISTS (
                           SELECT 1
                           FROM tblAllocations t3
                           WHERE t1.AllocID > t3.AllocID
                           HAVING MAX(t3.AllocID) = t2.AllocID
                           ) AND t1.CaseNo = t2.CaseNo
             ) o 
```

# backbone.js - Backbone.js - 将集合呈现为 HTML 选项标签

> ID：14755295
> 
> 赞同：0
> 
> 时间：2013-02-07T15:52:29.993
> 
> 标签：backbone.js

A 有一组我想渲染到`<select>`模板中现有元素的项目。我遇到的问题是视图总是将`<option>`列表包装在`DIV`标签中。我怎样才能只呈现`<option>`没有任何包装元素的列表？

模板：

```
<script type="text/template" id="template-select">
    <% _(elements).each(function(element) { %>
            <option value="<%= element.id %>"><%= element.name %></option>
    <% }); %>
</script> 
```

看法：

```
myView = Backbone.View.extend({
    template: template('template-select'),
    render: function() {
        this.$el.html(this.template({
                elements: this.collection.toJSON()
            }));
        return this;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T18:28:57.060

我假设您正在其他地方创建该视图的实例，添加渲染/将其添加到`<select>`元素中。

您可以尝试这样的事情：

```
var view = new myView({el: '#id-of-existing-select'});
view.render(); 
```

这将使视图使用现有的`<select>`而不是生成`<div>`.

# jquery - 使用 jQuery 获取输入文本值发送输入名称而不是实际值

> ID：14755296
> 
> 赞同：0
> 
> 时间：2013-02-07T15:52:30.007
> 
> 标签：jquery, forms

我需要一些建议，

我有一个简单的 html 输入类型文本字段：

```
<p><input id="mrmid" type="text" name="mrmid" size="30" /></p> 
```

我正在尝试使用提交函数获取他的值，如下所示：

```
$("#myform").submit(function(){
    var mrmid = $("#mrmid").val();
    alert("mrmid");
}); 
```

而不是提交的值，假设我提交“123”，警报警报“mrmid”（输入名称）。

为什么会这样？

这是要走的路，还是我应该使用 serializeArray() 方法？我知道它有效，并且我看到它记录在堆栈上。

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:54:14.287

我认为你必须使用`alert(mrmid);`而不是`alert("mrmid");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:55:00.350

您正在警告字符串**"mrmid"**而不是变量**mrmid**。

改变

```
alert("mrmid"); 
```

到

```
alert(mrmid); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:57:22.620

因为您正在警告字符串“mrmid”，而不是`mrmid`变量中的值。删除`mrmid`in 的双引号`alert`

```
$("#eloqua").submit(function(){
    var mrmid = $("#mrmid").val();
    alert(mrmid);
}); 
```

# javascript - 如何从 asp.net 中的 try .. catch 块触发 javascript 弹出消息

> ID：14755302
> 
> 赞同：0
> 
> 时间：2013-02-07T15:52:47.840
> 
> 标签：javascript, asp.net, vb.net, try-catch

我正在尝试使用 Javascript 显示在 Try Catch Block 中捕获的错误消息。请看我的代码。如果我正常调用它，相同的 javascript 函数可以正常工作，但从 catch 块调用它不起作用。这是不可能的还是我做错了什么？有其他选择吗？

非常感谢。

```
Try
          Messagebox("Hello World") **'This works**
          Throw New Exception("OH NO")
Catch ex As Exception
            Messagebox(ex.Message) **'This doesn't work**
End Try

Protected Sub Messagebox(ex as string)

           'show ex as javascript error message
           Dim sb as stringbuilder = "javascript code here"
           Page.ClientScript.RegisterClientScriptBlock(Me.GetType(), "uniqueName", sb.ToString())

End Sub 
```

# virtualbox - Vagrant：使用 VBoxManage 执行以下命令时出错

> ID：14755304
> 
> 赞同：1
> 
> 时间：2013-02-07T15:52:52.180
> 
> 标签：virtualbox, vagrant

像这样添加新的共享文件夹后：

```
config.vm.share_folder 'Tomcat logs', '/path_on_VM/logs/', 'logs/' 
```

`vagrant up`抛出错误：

```
There was an error executing the following command with VBoxManage:

["sharedfolder", "add", "99d6e47f-d372-4d6e-a27b-8191deff32c8", "--name",
"Tomcat logs", "--hostpath", "/Users/w/DEV/vagrant-dev/logs"] 
```

这就是我所得到的。我正在使用`VAGRANT_LOG=DEGUG`

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:09:48.407

问题在于`/path_on_VM/logs/`它必须归`vagrant`用户所有。希望来自 Vagrant 的错误信息更好。

# python - 从另一个文件 PyQT 打开一个 GUI 文件

> ID：14755305
> 
> 赞同：7
> 
> 时间：2013-02-07T15:52:53.613
> 
> 标签：python, qt, python-3.x, pyqt, pyqt4

我已经使用 QT Designer 在 PyQT 中创建了许多 GUI 界面，但现在我试图从另一个界面打开一个界面，但我不知道该怎么做。 **Start.py**是运行 GUI 界面的文件**Authentification_1**和**Acceuil_start.py**是运行 GUI 界面**Acceuil_2.py**的文件，现在我想从**Start.py**到午餐**Acceuil_start.py**。你对此有什么想法吗？谢谢你。这是我的代码：

> 开始.py：

```
import sys
from PyQt4 import QtCore, QtGui
from Authentification_1 import Ui_Fenetre_auth
from Acceuil_2 import Ui_MainWindow #???  Acceuil_2.py is the file which I want to open

class StartQT4(QtGui.QMainWindow):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        self.ui = Ui_Fenetre_auth()
        self.ui.setupUi(self)

    def authentifier(val): #Slot method
        self.Acceuil = Acceuil() #???
        self.Acceuil.show() #???

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = StartQT4()
    myapp.show()
    sys.exit(app.exec_()) 
```

> acceuil_start.py

```
import sys
from PyQt4 import QtCore, QtGui
from Authentification_1 import Ui_Fenetre_auth
from Acceuil_2 import Ui_MainWindow

class StartQT4(QtGui.QMainWindow):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        self.ui = Ui_MainWindow()
        self.ui.setupUi(self)

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = StartQT4()
    myapp.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:55:28.090

首先，您应该命名您的 GUI 类，以便它们具有不同的名称，而不是通用名称，以便您可以区分它们。

为什么你需要这样做？好吧 - 简单地说，因为它有意义 - 如果每个类都代表不同类型的对话框，那么它就是不同的类型 - 它应该以不同的方式命名。一些名称是/可能是：`QMessageBox`、、、`AboutBox`等等`AddUserDialog`。

在 Acceuil_start.py 中（你也应该在其他模块中重命名类）。

```
import sys
from PyQt4 import QtCore, QtGui
from Authentification_1 import Ui_Fenetre_auth
from Acceuil_2 import Ui_MainWindow

class Acceuil(QtGui.QMainWindow):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        self.ui = Ui_MainWindow()
        self.ui.setupUi(self)

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = Acceuil()
    myapp.show()
    sys.exit(app.exec_()) 
```

在父类中，当你想创建窗口时，你已经关闭了（但它应该在任何情况下都可以工作）：

```
def authentifier(val): #Slot method
    self.Acceuil = Acceuil(self) # You should always pass the parent to the child control
    self.Acceuil.show() #??? 
```

关于父级问题：如果您的小部件/窗口正在创建另一个小部件，将创建者对象设置为父级始终是一个好主意（除了一些特殊情况），您应该阅读[此](http://doc.qt.digia.com/4.7-snapshot/objecttrees.html)内容以了解原因：

> QObjects 在对象树中组织自己。当您使用另一个对象作为父对象创建 QObject 时，它会添加到父对象的 children() 列表中，并在父对象存在时被删除。事实证明，这种方法非常适合 GUI 对象的需求。例如，QShortcut（键盘快捷方式）是相关窗口的子窗口，因此当用户关闭该窗口时，该快捷方式也会被删除。

**编辑 - 最小工作样本**

为了了解我想告诉您的内容，我构建了一个简单的示例。你有两个类 -`MainWindow`和 `ChildWindow`. `QApplication`通过创建单独的对象，每个类都可以在没有其他类的情况下工作。但是，如果您导入`ChildWindow`，`MainWindow`您将创建`ChildWindow`连接到单次计时器的插槽，该计时器将在 5 秒内触发。

主窗口.py：

```
import sys
from PyQt4 import QtCore, QtGui
from ChildWindow import ChildWindow

class MainWindow(QtGui.QMainWindow):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        QtCore.QTimer.singleShot(5000, self.showChildWindow)

    def showChildWindow(self):
        self.child_win = ChildWindow(self)
        self.child_win.show()

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = MainWindow()
    myapp.show()
    sys.exit(app.exec_()) 
```

ChildWindow.py：

```
import sys
from PyQt4 import QtCore, QtGui

class ChildWindow(QtGui.QMainWindow):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)
        self.setWindowTitle("Child Window!")

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = ChildWindow()
    myapp.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:11:16.420

要从 Start.py 引用另一个对话框，您必须在其前面加上模块名称，在本例中为 Acceuil_start。因此，如果每个模块中存在重复的函数名称是可以的。因此，您将拥有：

```
def authentifier(val): #Slot method
    dlg = Acceuil_start.StartQT4()
    dlg.exec_() 
```

但是，如果您希望它们从同一个进程运行，请记住您不能有两个`app`对象。您可能希望将 Acceuil_start.py 构建成一个对话框，而不是一个主窗口。如果这是两个不同的主窗口，您可能会发现只调用另一个以 Accuuil_start.py 作为参数的 Python 解释器会更容易。

# java - Diamond Operator 在 OpenJDK 而非 SunJDK 7 下编译

> ID：14755307
> 
> 赞同：3
> 
> 时间：2013-02-07T15:53:03.237
> 
> 标签：java, playframework-1.x, openjdk

希望这不是重复的，我已经搜索并发现了一些相关问题，但与 Java 中的差异无关。

```
private List<Stuff> apps = new ArrayList<Stuff>();
// compiles under both

private List<Stuff> apps = new ArrayList<>();
// compiles under OpenJDK 7
// SunJDK 7 Error raised is : Syntax error on token "<", ? expected after this token 
```

任何想法为什么会这样？我喜欢在我的 *nix 服务器和开发盒上使用 OpenJDK，但有时我使用别人的 Windows 笔记本电脑进行开发和测试，这是我第一次在两个版本之间遇到问题。将不胜感激任何建议或想法！

我还使用 Netbeans 7.2（它不会在 Windows 或 Debain 上标记错误）。该程序使用 Play Framework 1.2.5 并将 java 源设置为 1.7。

```
javac -version
javac 1.7.0_01 
```

和

```
java -version
java version "1.7.0_01"
Java<TM> SE Runtime-Environment <build 1.7.0_01-b08> 
```

并在所有我能告诉的地方检查了 Netbeans 的来源是 1.7。通过命令行编译产生了上述相同的错误。

回答？

我更新到最新版本的 SunJDK/Java (1.7.0_13) 并且为我解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:18:52.457

我更新到最新版本的 SunJDK/Java (1.7.0_13) 并解决了问题。

# tomcat - 告诉 Tomcat 使用哪个 log4j.xml

> ID：14755308
> 
> 赞同：2
> 
> 时间：2013-02-07T15:53:07.977
> 
> 标签：tomcat, log4j

我在 Tomcat 中指定哪个设置以便我可以选择特定的 log4j.xml 文件？

我有一个开发和生产 log4j.xml 文件，所以我希望能够配置何时使用其中一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:00:30.963

在您的 Tomcat 配置中添加以下行：

```
TOMCAT_OPTS="-Dlog4j.configuration=/my/config/log4j.properties" 
```

在您的开发环境中，您可以使用它覆盖默认设置，并将您的生产配置与`war`.

当然，如果该变量中有更多属性，则必须保留它们:)

# javascript - 我在 Emberjs 中的虚假案例陈述被炸毁了。什么是正确的方法？

> ID：14755313
> 
> 赞同：1
> 
> 时间：2013-02-07T15:53:19.183
> 
> 标签：javascript, ember.js, handlebars.js

我正在尝试根据模型中属性的当前值呈现不同的车把模板，并且可能有很多选项（因此我宁愿不使用很多`{{#if}}`s）。我能想到的最好的事情是：

```
Ember.Handlebars.registerBoundHelper('selectorType', function(name, options) {
  return Ember.Handlebars.compile("{{template _selectors_" + name + "}}")(options.contexts[0], options);
}); 
```

我在我的模板中使用它，例如：

```
{{selectorType selector.name}} 
```

（而不是像一百个`{{#if}}`）

问题是我在渲染期间收到此错误：*“您不能在渲染过程之外使用 appendChild”*

显然我做错了什么。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T21:52:50.217

我最终使用带有动态子视图的 ContainerView 解决了这个问题，请参阅[Ember.js 动态子视图](https://stackoverflow.com/questions/9795398/ember-js-dynamic-child-views)以了解如何进行讨论。

相关代码是（coffeescript）：

```
App.SelectorType = Ember.Object.extend
  name: null
  type: null
  typeView: null
  options: null

App.SelectorTypes = [
  App.SelectorType.create(
    name: 'foo'
    type: 'bar'
  ) #, more etc
]

App.SelectorTypes.forEach (t) ->
  t.set 'typeView', Ember.View.create
    templateName: "selectors/_#{t.get('viewType')}_view"
    name: t.get('name')

App.SelectorDetailView = Ember.ContainerView.extend
  didInsertElement: ->
    @updateForm()

  updateForm: (->
    type = @get('type')
    typeObject = App.SelectorTypes.findProperty('type', type)
    return if Ember.isNone(type)

    view = typeObject.get('typeView')
    @get('childViews').forEach (v) -> v.remove()
    @get('childViews').clear()
    @get('childViews').pushObject(view)
  ).observes('type') 
```

和模板：

```
 Selector Type:
  {{view Ember.Select
        viewName=select
        contentBinding="App.SelectorTypes"
        optionValuePath="content.type"
        optionLabelPath="content.name"
        prompt="Pick a Selector"
        valueBinding="selector.type"
  }}
<dl>
  <dt><label>Details</label></dt>
  <dd>
    {{view App.SelectorDetailView typeBinding="selector.type"}}
  </dd>
</dl> 
```

不过，似乎太难了，有兴趣看到更好的解决方案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:23:12.943

我认为没有必要创建一个助手来做到这一点。您可以在视图中通过修改 来执行此操作，然后在更改`templateName`其后调用该`rerender`方法`templateName`：

```
init: function() {
    this.set('templateName', 'firstOne');
    this._super();
},

click: function() {
    this.set('templateName', 'secondOne');
    this.rerender();
} 
```

我们可以使用在模板渲染之前`init`设置为空的方法。`templateName`然后我们将调用该`_super`方法来完成将视图插入到 DOM 中。然后我们可以在点击事件上触发视图的变化。我们更新`templateName`变量，然后调用`rerender()`重新渲染这个特定的视图。

我已经为您设置了一个 JSFiddle 作为示例：http: [//jsfiddle.net/pFkaE/](http://jsfiddle.net/pFkaE/)尝试单击“第一个”。将视图更改为`secondOne`.

# java - 将json字符串转换为java arraylist（使用jackson）

> ID：14755316
> 
> 赞同：0
> 
> 时间：2013-02-07T15:53:19.277
> 
> 标签：java, json, string, url

我想将以下 json 字符串转换为 java arraylist，以便我可以在文档中获取 id 或 name 并在 java 中进行更改。

```
{
 response{
  docs[
   {id:#
    name:#
   }
  ]
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:57:22.127

有许多 HTTP 客户端库，但鉴于您要引入 JSON，您最好的选择是使用 Jersey 客户端库。您需要创建一个与 JSON 匹配的 Java 对象（在这种情况下，一个`Response`对象包含一个对象`Docs`数组`Data`或类似的字段），并告诉 Jersey 客户端预期结果。然后，您将能够使用 Java 对象以您希望的任何形式输出它。

**更新*

代码的基本概述。首先，设置 Jersey 客户端：

```
import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.config.DefaultClientConfig;
import com.sun.jersey.api.client.WebResource;

....

final ClientConfig clientConfig = new DefaultClientConfig();
clientConfig.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING, Boolean.TRUE);
final Client client = Client.create(clientConfig); 
```

然后创建您的请求：

```
final WebResource webResource = client.resource("http://mydomain.com/myresource"); 
```

在这个阶段，如果你想获取你的 JSON 作为`String`你可以调用：

```
final String json = webResource.get(String.class); 
```

但与其他 HTTP 客户端相比，使用 Jersey 的真正好处是它会为您解析 JSON，因此您无需考虑它。如果您创建以下类：

```
public class DataResponse
{
  private final List<DataDoc> docs;

  @JsonCreator
  public DataResponse(@JsonProperty("docs")List<DataDocs> docs)
  {
    this.docs = docs;
  }

  public List<DataDoc> getDocs()
  {
    return this.docs;
  }
}

public class DataDoc
{
  final String id;
  final String name;
  // Other fields go here

  @JsonCreator
  public DataDoc(@JsonProperty("id") String id,
                 @JsonProperty("name") String name)
  {
    this.id = id;
    this.name = name;
  }

  // Getters go here
} 
```

那么您可以将您的 Jersey 客户端代码更改为：

```
final DataResponse response = webResource.get(DataResponse.class); 
```

现在您可以按照普通的 Java 对象访问响应的字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T15:58:47.363

```
URL url = new URL("webAddress");

URLConnection conn = url.openConnection();

BufferedReader reader = new BufferedReader(new InputStreamReader(
                conn.getInputStream()));

 String line = "";
 ArrayList<String> list = new ArrayList<String>();
 while ((line = reader.readLine()) != null) {
      list.add(line);

  //Perform operation on your data.It will read a line at a time.

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:56:41.037

实际上你想执行 HTTP GET，所以看看这个讨论：[How do I do a HTTP GET in Java?](https://stackoverflow.com/questions/1485708/how-do-i-do-a-http-get-in-java)

# sql-server - 无效的 SQL 查询 - 指定了非布尔类型

> ID：14755317
> 
> 赞同：0
> 
> 时间：2013-02-07T15:53:20.107
> 
> 标签：sql-server

我不是 SQL Server 专家。我正在尝试执行查询。该查询依赖于一个函数来拆分 CSV 并在表上进行连接。它是一个非常基本的查询，如下所示：

```
SELECT 
  *
FROM
 [Order]
WHERE
 dbo.ConvertIDListToTable('1,2,3,4', ',') l INNER JOIN Order o ON l.item=o.ID 
```

当我执行查询时，我收到以下错误：

```
An expression of non-boolean type specified in a context where a condition is expected, near 'l'. 
```

我究竟做错了什么？这必须是语法上的。我一直盯着它看，但一切对我来说都是正确的。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:56:09.447

从语法上讲，你`INNER JOIN`的 s 应该在你的`WHERE`语句之前，此外，你不需要`WHERE`这里的语句。

不知道确切的代码`ConvertIDListToTable`是一个障碍，但假设它返回一个表，我认为你需要：

```
SELECT *
FROM dbo.ConvertIDListToTable('1,2,3,4', ',') l 
INNER JOIN Order o ON l.item=o.ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:56:15.917

不能在 WHERE 子句中使用 JOIN。这确实是一个语法问题。

查看 SQL Server SELECT 语法：http: [//msdn.microsoft.com/en-us/library/ms189499.aspx](http://msdn.microsoft.com/en-us/library/ms189499.aspx)

您应该在 WHERE 子句之前加入。如果您需要有关查询的更多帮助，请说明您希望它做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:57:22.937

我相信这个查询结构来自mysql

在 SQL Server 中，您可以这样编写：

```
SELECT 
  *
FROM
 [Order] o 
 Inner join dbo.ConvertIDListToTable('1,2,3,4', ',') l
   ON l.item=o.ID 
```

# backbone.js - 有没有一种安静的方法来告诉 Backbone 只将一个属性保存到服务器？

> ID：14755326
> 
> 赞同：0
> 
> 时间：2013-02-07T15:53:41.180
> 
> 标签：backbone.js, backbone-relational

我有一个附加到模型的集合。当我单击一个按钮时，我希望能够告诉主干仅将一个属性（包含集合）保存到服务器

```
m.Survey = m.BaseModel.extend({
    relations: [{
        type: Backbone.HasMany,
        key: 'invites',
        relatedModel: 'APP.Models.SurveyInvite',
        collectionType: 'APP.Collections.SurveyInvites',
        //save invites separately
        includeInJSON: false, 
        reverseRelation: {
            key: 'survey',
            //We don't want to list the survey when doing toJSON()
            includeInJSON: false
        }
    }],
    //need this method
    saveInvites: function(){
         this.saveOnly('invites');
    });
}); 
```

我希望它发送到服务器：

发布 /api/surveys/123/

```
{
    invites: [
    {<invite1>}, {<invite2>}, {<invitex>}
    ] 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:12:22.623

您可以使用[`Model.save`](http://backbonejs.org/#Model-save)以下`patch`选项：

```
saveInvites: function(){
     this.save({invites:this.get('invites')}, {patch:true});
}); 
```

这`POST`将发送一个`HTTP PATCH`. 由于您要求采用 RESTful 方式，因此 patch 是此处使用的正确动词。如果您的服务器无法处理补丁请求，您可以`POST`使用以下[`emulateHTTP`](http://backbonejs.org/#Sync-emulateHTTP)选项强制它：

```
saveInvites: function(){
     this.save({invites:this.get('invites')}, {patch:true, emulateHTTP:true});
}); 
```

# opencv - 使用filestorage读取用gz压缩的yaml文件时出现OpenCV异常

> ID：14755332
> 
> 赞同：0
> 
> 时间：2013-02-07T15:54:02.533
> 
> 标签：opencv, compression, yaml, gzip

当我保存一些变量时的输出文件`FileStorage`是一个 9MB 的 yaml 文件。我看到我们可以在文件名中添加“.gz”来压缩文件。生成的文件为 3.5MB。那没问题。但是当我尝试使用文件存储打开 myfile.yaml.gz 文件以追加时，我遇到了未处理的异常。你知道OpenCV是否支持这个？如果是，我应该如何阅读文件？如果没有，有什么建议可以轻松压缩/解压缩文件吗？

这是一个示例代码：

```
std::vector<int> myArray;
myArray.push_back(0); myArray.push_back(1);
FileStorage fs("myFile.yaml.gz", FileStorage::WRITE);
fs << "myArrayName" << myArray;
fs.release();

myArray.clear();

fs = FileStorage("myFile.yaml.gz", FileStorage::APPEND);
fs << "intValue" << 3;
fs.release();

fs = FileStorage("myFile.yaml.gz", FileStorage::READ);
fs["myArrayName"] >> myArray;
fs.release(); 
```

# jquery-validate - 使用插件 jquery validate 验证几个依赖选择列表

> ID：14755333
> 
> 赞同：-2
> 
> 时间：2013-02-07T15:54:06.657
> 
> 标签：jquery-validate, call, selectlist

正如标题所说，我需要使用 jQuery Validator Plugin 验证 2 个依赖选择列表，以强制网站用户从所有 2 个字段中选择一个选项（它们必须成为必填字段）。如果您看到 html，您可以在第二个列表中读取“禁用”标签，当用户选择 list1 选项之一时，该标签将被删除。这是**表单的简化代码**

```
<form action="/index.php" method="post" id="XTspSearchForm132" >
<select class='sid_list1' name='to_sid_list_1321' id='extparent_1321' style='margin-top:4px;'><option style="" value="" selected="selected">- Seleziona categoria -</option><option style="" value="spc55" class="spc63" >Africa del Sud</option><option style="" value="spc56" class="spc63" >Nord America e Caraibi</option><option style="" value="spc57" class="spc63" >America Centrale</option><option style="" value="spc58" class="spc63" >Sud America</option><option style="" value="spc59" class="spc63" >Isole del Pacifico</option><option style="" value="spc60" class="spc63" >Oceano Indiano</option><option style="" value="spc61" class="spc63" >Penisola Arabica</option></select>
<select class='sid_list2' name='to_sid_list_1322' id='extparent_1322' style='margin-top:4px;'><option style="" value="" selected="selected" disabled="disabled">- Seleziona categoria -</option><option style="" value="spc62" class="spc55" >Botswana</option><option style="" value="spc64" class="spc55" >Mauritius e Seychelles</option><option style="" value="spc65" class="spc55" >Mozambico</option><option style="" value="spc66" class="spc55" >Namibia</option><option style="" value="spc67" class="spc55" >Zimbabwe e Zambia</option><option style="" value="spc68" class="spc55" >Sudafrica</option><option style="" value="spc69" class="spc56" >Anguilla</option><option style="" value="spc70" class="spc56" >Antigua e Barbados</option><option style="" value="spc71" class="spc56" >Aruba</option><option style="" value="spc72" class="spc56" >Bahamas</option><option style="" value="spc73" class="spc56" >Bermuda</option><option style="" value="spc74" class="spc56" >Giamaica</option><option style="" value="spc75" class="spc56" >Repubblica Dominicana</option><option style="" value="spc76" class="spc56" >St Lucia</option><option style="" value="spc77" class="spc56" >St Martin</option><option style="" value="spc78" class="spc56" >Turks and Caicos</option><option style="" value="spc79" class="spc56" >US &amp; British Virgin Islands</option><option style="" value="spc80" class="spc56" >Canada</option><option style="" value="spc81" class="spc56" >Canouan Island</option><option style="" value="spc82" class="spc56" >Stati Uniti</option><option style="" value="spc83" class="spc57" >Belize</option><option style="" value="spc84" class="spc57" >Costa Rica</option><option style="" value="spc85" class="spc57" >Guatemala</option><option style="" value="spc86" class="spc57" >Messico</option><option style="" value="spc87" class="spc57" >Panama</option><option style="" value="spc88" class="spc58" >Equador</option><option style="" value="spc89" class="spc58" >Perù</option><option style="" value="spc90" class="spc59" >Hawaii</option><option style="" value="spc91" class="spc59" >Polinesia Francese</option><option style="" value="spc92" class="spc60" >Seishelles</option><option style="" value="spc93" class="spc60" >Mauritius</option><option style="" value="spc94" class="spc61" >Dubai</option><option style="" value="spc95" class="spc61" >Oman</option></select>
<input type="submit" id="XTtop_button" name="search" value="Search" class="buttonhome" onclick="this.form.sp_search_for.focus();extSearchHelper132.extractFormValues();"/>
</form> 
```

删除“禁用”标签可能取决于此脚本，由表单加载：http: [//www.provafabio.netsons.org/modules/mod_sobiextsearch/js/jquery.chained.min.js](http://www.provafabio.netsons.org/modules/mod_sobiextsearch/js/jquery.chained.min.js)

现在我正在使用这个脚本，它适用于第一个，但不适用于第二个......

```
<script text= type='text/javascript'> 
var $j = jQuery.noConflict();
$j(document).ready(function () {

    $j("#XTspSearchForm132").validate({
        // other rules and options,
    });

    $j('.sid_list1').each(function () {
        $j(this).rules('add', {
            required: true,
            messages: {
                required: "your custom message"
            }
        });
    });

    $j('.sid_list2').each(function () {
        $j(this).rules('add', {
            required: true,
            messages: {
                required: "your custom message"
            }
        });
    });

});
</script> 
```

我需要找到激活第二个列表的操作语法，以实现一个像 jsfiddle.net/km6XE/ 这样工作的脚本（对不起，不能发布更多链接）

这是实际使用的表格：provafabio.netsons.org

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:28:35.493

我认为问题出在您未包含的示例的“其他规则和选项”部分中，因为您的表单或 JavaScript 代码没有任何问题

当您为不存在的方法指定规则时，经常会遇到您描述的错误 -[请查看this fiddle以获取示例](http://jsfiddle.net/Z7saz/1/)

例如。这会给你你看到的错误

```
$('#myform').validate({
        rules: {
            field1: {
                non_existent_method: true
            }
        }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:37:18.707

> 引用 OP：“我需要了解：1）如何在不使用“添加”功能的情况下将规则添加到第一类 2）如何将规则添加到 DOM 中不存在的选择列表中”

请参阅以下内容：

> "1) 如何在不使用“添加”功能的情况下向第一类添加规则”

如果您想通过使用它们一次将这些规则分配给许多元素`class`，则使用`rules('add')`是可以接受的。如果通过添加规则`name`，还有其他方法。同样，由于您的目标是`class`，因此在这里使用`rules('add')`是可以接受的。

> “2）如何将规则添加到 DOM 中不存在的选择列表中”

您**不能**向 DOM 中尚不存在的内容添加规则。

**在用于创建元素的任何函数内部都是您放置`rules('add')`.**

**这只是一个例子：**

**如果**您使用按钮添加输入元素，您将放入`rules('add')`处理`click`程序函数中。无论您如何添加新的`input`. 由于我们看不到您的代码的那部分，我坚持使用下面的通用示例：

```
$('button#add').one('click', function () { // <-- WHATEVER FUNCTION YOU USE to add the new input

    // THIS is just SAMPLE code that adds a new input element
    var field = '<input type="text" name="newfield" /><br />';
    $('#myform').prepend(field);

    // NOW HERE, AFTER the new input is created, is where to add the rules.
    $('[name="newfield"]').rules("add", {
        required: true,
        messages: {
            required: "this new field is now required"
        }
    });

});  // <- end button#add click handler 
```

**工作演示：http: [//jsfiddle.net/km6XE/](http://jsfiddle.net/km6XE/)**

本质上，这与我的[第一个答案](https://stackoverflow.com/a/14759567/594235)相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:38:42.240

如果元素尚不存在，则不要`rules('add')`在 DOM中使用。`input`

这个答案表明，当用户单击一个按钮时，会添加一个名为的新字段`newfield`，`form`然后将[规则动态添加](http://docs.jquery.com/Plugins/Validation/rules#.22add.22rules)到这个新`input`字段。

```
$(document).ready(function () {

    $('#myform').validate({ // initialize the plugin
        rules: {
            field1: {
                required: true,
                minlength: 5
            },
            field2: {
                required: true,
                minlength: 5
            }
        }
    });

    $('button#add').one('click', function () {
        var field = '<input type="text" name="newfield" /><br />';
        $('#myform').prepend(field);
        $('[name="newfield"]').rules("add", {
            required: true,
            messages: {
                required: "this new field is now required"
            }
        });
    });

}); 
```

**演示：http: [//jsfiddle.net/km6XE/](http://jsfiddle.net/km6XE/)**

您需要确保您的代码为每个新代码创建一个**唯一** 的，否则您将破坏 Validate 插件。`name``input`

# cordova - Phonegap 2.3.0 和 ForegroundCamera 插件

> ID：14755336
> 
> 赞同：3
> 
> 时间：2013-02-07T15:54:14.217
> 
> 标签：cordova, plugins, camera, foreground

我正在使用 Phonegap 2.3.0 和来自 Google Code 的新 ForegroundCamera 插件。我仔细按照说明进行操作，在我的 Eclipse 设置中验证项目时出现以下错误：

*   无法从 ForegroundCameraLauncher 投射到插件
*   ctx 无法解析或不是字段 (x2)
*   R 无法解析为变量 (x4)
*   未定义 ForegroundCameraLauncher 类型的方法 success(PluginResult, String)

现在，我通过更新一些已弃用的代码行解决了上述前三个错误（我希望我解决了它 - 它不再显示错误）..

第一个错误已通过在“import org.apache.cordova.api.Plugin;”行中将 Plugin 更改为 CordovaPlugin 来纠正。在 ForegroundCameraLauncher.java 中。ctx 在这两个地方被替换为 cordova.getActivity() ，这引起了麻烦。R 的这个问题是通过对库进行一些更改来修复的，这使得它创建了一个 R 对象（抱歉，我不知道如何正确解释这一点，因为我对 Eclipse 还不太熟悉）。

对于四个错误消息中的最后一个，我尝试通过注释掉 ForegroundCameraLauncher.java 中的这两行（带有“this.success”的行...）来进行临时修复。但是当在我的应用程序中拍照时，它会在从相机实例返回时使整个事情崩溃..

有谁知道发生了什么？我真的很高兴在这里得到一些指示:)

最后一个错误显然是您应该关注的错误；）如果其他人遇到相同的错误，我只想包括一些错误修复过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T15:10:01.680

我们刚刚更新了**Foreground Camera Plugin**以与**Phonegap 2.4.0**一起使用，我们也在开发**Foreground Gallery 插件**。请参阅[http://code.google.com/p/foreground-camera-plugin/](http://code.google.com/p/foreground-camera-plugin/)和[http://code.google.com/p/foreground-gallery-plugin/](http://code.google.com/p/foreground-gallery-plugin/)并让我们知道（发布问题）如果你有什么问题。

拜拜！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T12:45:37.257

请参阅此提交以了解 Cordova 中发生了什么变化：[https ://github.com/apache/cordova-android/commit/205215d409c4f75e958a9c09c0b4a38bd9a859​​ac](https://github.com/apache/cordova-android/commit/205215d409c4f75e958a9c09c0b4a38bd9a859ac)

替换
`this.success(new PluginResult(PluginResult.Status.OK, getRealPathFromURI(uri, this.ctx)), this.callbackId);`
为
`this.callbackContext.success(getRealPathFromURI(uri, cordova));`。

根据该提交更新`execute`函数，然后更新`takePicture`.

之后，我有 ForgroundCamera 插件与 Cordova 2.3 一起使用。现在要做更多的测试和清理。

# ios - 在 iOS 中访问 RESTfull Web 服务

> ID：14755337
> 
> 赞同：0
> 
> 时间：2013-02-07T15:54:20.397
> 
> 标签：ios, objective-c, web-services, rest, restkit

我正在尝试学习一些有关 iOS 应用程序的 RestKit 框架的知识。它提供了一种与 RESTfull Web 服务进行通信的更简单的方法，此外它还减少了样板代码。该框架有大约 6 个核心功能。我想知道与 RESTfull Web 服务通信的替代方式是什么？你可以给我一个例子吗; 更多细节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:57:06.670

这是[一个内容丰富的教程](http://blogs.captechconsulting.com/blog/jack-cox/tutorial-simple-iphone-rest-client)，详细描述了如何创建一个简单的 REST 客户端并附有示例。它涉及一些基本概念，例如使用[NSURLConnection的](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)*异步*和*同步*请求以及使用[NSXMLParser](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)解析响应。

# java - iReport：如何一个接一个地添加一个组（不在里面）

> ID：14755338
> 
> 赞同：0
> 
> 时间：2013-02-07T15:54:27.900
> 
> 标签：java, jasper-reports, report, ireport

通常 iReports 会创建这样的组：

* * *

## 第 1 组标题

## 第 2 组标题

## 细节

## 第 2 组页脚

## 第 1 组页脚

但我需要以这种方式创建组：

* * *

## 第 1 组标题

## 细节

## 第 1 组页脚

* * *

## 第 2 组标题

## 细节

## 第 2 组页脚

我怎样才能让它以我需要的方式工作？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:42:34.550

让这个工作的唯一方法是拥有一个包含第 2 组的子报表。

主要报告：

*   组表达式`group1`，添加组页眉和页脚带
*   例如摘要带中的子报告

子报告：

*   组表达式`group2`，添加组页眉和页脚带

# c# - 在 ASP.NET 中将文本下载为文件

> ID：14755339
> 
> 赞同：8
> 
> 时间：2013-02-07T15:54:31.037
> 
> 标签：c#, asp.net, .net

我正在尝试从屏幕上下载一些文本输出作为文本文件。以下是代码。它在某些页面上工作，而在其他页面上根本不工作。谁能建议这里有什么问题？

```
protected void Button18_Click(object sender, EventArgs e){
    Response.Clear();
    Response.Buffer = true;
    Response.ContentType = "text/plain";
    Response.AppendHeader("content-disposition", "attachment;filename=output.txt");

    StringBuilder sb = new StringBuilder();
    string output = "Output";
    sb.Append(output);
    sb.Append("\r\n");
    Response.Write(sb.ToString());
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-07T16:03:17.480

正如 Joshua 已经提到的，您需要将文本写入输出流（响应）。另外，不要忘记在那之后调用 Response.End() 。

```
protected void Button18_Click(object sender, EventArgs e)
{
    StringBuilder sb = new StringBuilder();
    string output = "Output";
    sb.Append(output);
    sb.Append("\r\n");

    string text = sb.ToString();

    Response.Clear();
    Response.ClearHeaders();

    Response.AppendHeader("Content-Length", text.Length.ToString());
    Response.ContentType = "text/plain";
    Response.AppendHeader("Content-Disposition", "attachment;filename=\"output.txt\"");

    Response.Write(text);
    Response.End();
} 
```

编辑1：添加了更多细节

编辑 2：我正在阅读其他 SO 帖子，用户建议在文件名周围加上引号：

```
Response.AppendHeader("content-disposition", "attachment;filename=\"output.txt\""); 
```

来源： [https ://stackoverflow.com/a/12001019/558486](https://stackoverflow.com/a/12001019/558486)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T15:56:23.203

如果那是您的实际代码，您永远不会将文本写入响应流，因此浏览器永远不会收到任何数据。

至少，你应该需要

```
Response.Write(sb.ToString()); 
```

将您的文本数据写入响应。此外，作为额外的奖励，如果您事先知道长度，您应该使用`Content-Length`标题提供它，以便浏览器可以显示下载进度。

您还将设置`Response.Buffer = true;`作为方法的一部分，但从不明确刷新响应以将其发送到浏览器。尝试`Response.Flush()`在您的 write 语句之后添加一个。

# c - 如何正确设置 sigaltstack？

> ID：14755341
> 
> 赞同：5
> 
> 时间：2013-02-07T15:54:36.717
> 
> 标签：c, macos, signals

我已经看到至少三种不同的方法来设置*sigaltstack()*的替代堆栈。我想知道哪个是最好的方法：

方法#1

```
stack_t sigstk;
sigstk.ss_size = 0;
sigstk.ss_flags = 0;
sigstk.ss_sp = mmap (NULL, SIGSTKSZ, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANON, -1, 0);
if (sigstk.ss_sp != MAP_FAILED) {
    sigstk.ss_size = SIGSTKSZ;
    if (sigaltstack (&sigstk, 0) < 0) {
        sigstk.ss_size = 0;
        printf ("sigaltstack errno=%d\n", errno);
    }
} else {
    printf ("malloc (SIGSTKSZ) failed!\n");
} 
```

方法#2（我们已经使用了一段时间，但是这里分配的内存显示在泄漏检测（`leaks`命令）中）

```
stack_t sigstk;
sigstk.ss_size = 0;
sigstk.ss_flags = 0;
sigstk.ss_sp = malloc (SIGSTKSZ);
if (sigstk.ss_sp != NULL) {
    sigstk.ss_size = SIGSTKSZ;
    if (sigaltstack (&sigstk, 0) < 0) {
        sigstk.ss_size = 0;
        free (sigstk.ss_sp);
        printf ("sigaltstack errno=%d\n", errno);
    }
} else {
    printf ("malloc (SIGSTKSZ) failed!\n");
} 
```

方法#3

```
stack_t sigstk;
static char ssp[SIGSTKSZ];
sigstk.ss_size = SIGSTKSZ;
sigstk.ss_flags = 0;
sigstk.ss_sp = ssp;
sigstk.ss_size = SIGSTKSZ;
if (sigaltstack (&sigstk, 0) < 0) {
    sigstk.ss_size = 0;
    free (sigstk.ss_sp);
    printf ("sigaltstack errno=%d\n", errno);
} 
```

谢谢，Ákos (Mac OS X 10.8.2)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-04T22:03:38.973

方法#1 是最好的。原因是因为位置。假设您使用 #2 并且您的代码流程如下所示：

```
void *blah = malloc (...)
...
stack_t sigstk;
sigstk.ss_size = 0;
sigstk.ss_flags = 0;
sigstk.ss_sp = malloc (SIGSTKSZ); 
```

现在，如果您用尽信号处理程序中的堆栈空间会发生什么？您的堆栈将向下增长并干扰指向的内存`blah`。如果你在某处有一些浅递归，它很容易发生。#3 有同样的问题。

相反，请使用 mmap，因为它从远离数据堆的不同池中分配，并且设置保护页是一个好主意：

```
char* mem = mmap (NULL, 
                  SIGSTKSZ + 2*getpagesize(), 
                  PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANON, 
                  -1, 0);
mprotect(mem, getpagesize(), PROT_NONE);
mprotect(mem + getpagesize() + SIGSTKSZ, getpagesize(), PROT_NONE);
sigstk.ss_sp = mem + getpagesize();
... 
```

`SIGSEGV`现在，如果发生堆栈溢出，您将得到一个比随机内存覆盖更容易调试的十亿倍。:)

#2 被视为泄漏的原因可能是误报。您使用的泄漏工具可能会使用`malloc`自己的变体覆盖库函数，这是更喜欢使用`mmap`此任务而不是`malloc`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T18:14:32.643

我不太熟悉`sigaltstack()`，但我一直在查看[手册页](http://www.kernel.org/doc/man-pages/online/pages/man2/sigaltstack.2.html)。您的 3 种方法的区别似乎在于如何为`ss_sp`结构成员分配空间：使用`mmap()`、使用传统`malloc()`或从堆栈中分配它。

如果我对系统的理解正确，那么你绝对**不想**做方法#3：从堆栈分配。退出函数后，堆栈空间将立即被回收和重新利用（即改变），并且会破坏`sigaltstack()`.

所以我会推荐传统`malloc()`的。`mmap()`如果你喜欢语法，你可以去。根据我的理解，将`NULL`地址传递给无论如何`mmap()`都相当于。`malloc()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-01T21:37:42.533

您主要关心的是 malloc 情况下的泄漏检查——如果您有一个详尽的泄漏检查器（这要求在退出之前释放所有分配给 malloc 的东西）。如果是这种情况，您可以通过记住旧的 sigstack 来进行清理以恢复它

```
stack_t sigstk, orig_sigstk;

setup_alt_sigstack() {
    sigstk.ss_size = 0;
    sigstk.ss_flags = 0;
    sigstk.ss_sp = malloc (SIGSTKSZ);
    if (sigstk.ss_sp != NULL) {
        sigstk.ss_size = SIGSTKSZ;
        if (sigaltstack (&sigstk, &orig_sigstack) < 0) {
            sigstk.ss_size = 0;
            free (sigstk.ss_sp);
            printf ("sigaltstack errno=%d\n", errno);
        }
    } else {
        printf ("malloc (SIGSTKSZ) failed!\n");
    }

restore_orig_sigstack() {
    if (sigaltstack (&orig_sigstack, 0) < 0) {
        printf ("sigaltstack errno=%d\n", errno);
    }
    sigstk.ss_size = 0;
    free (sigstk.ss_sp);
} 
```

# c# - Visual Studio 2010 在跟踪点上挂起

> ID：14755342
> 
> 赞同：10
> 
> 时间：2013-02-07T15:54:39.773
> 
> 标签：c#, wpf, visual-studio, debugging

**问题：**
每当我尝试在调试器中中断或设置跟踪点时，我们的应用程序和 Visual Studio 都会完全冻结。分离调试器后，应用程序继续。

此问题可能与 WPF 有关。我们已将 WinForm 应用程序迁移到 WPF。从那时起，这个问题就出现了。但我无法找到导致问题的代码的特定部分。我已经回滚了数百次提交，但没有成功。

它也可能与 UI 线程有关。如果断点设置在远离 UI 逻辑的某个位置，则应用程序将不会冻结，或者不会像 UI 线程中的某个位置那样经常冻结。

[**编辑：** ]
我使用 Windows 7\. 64bit 和 Visual Studio 2010

[**更新：** ]
当 Visual Studio 挂起时，我尝试在显示断点之前分离，消息*“无法从一个或多个进程分离。所有未完成的 func-evals 尚未完成”*。但是我在调​​试选项中禁用了所有功能评估。我认为我的问题是由无法完成或超时的 func_evaluation 引起的。

有没有办法查看挂在哪个 func_evaluation 视觉工作室上？

**例子：**

```
class SomeUiViewPresenterExample
{
   private Timer m_Timer;

public void Init()
{
    m_Timer = new Timer();
    m_Timer.Elapsed += ElapsedFoo();
    m_Timer.AutoReset = false;
    m_Timer.Interval = 200;
}

private void ElapsedFoo(object sender, ElapsedEventArgs elapsedEventArgs)
{
    // there is no code inside this method
    // On the next line a trace point with "---> ElapsedFoo called" will freeze the debugger
} 
```

**我已经尝试过的：（没有成功）**

*   启用/禁用主机进程
*   尝试调试 x86 和 x64 进程
*   使用 /SafeMode 启动了 Visual Studio
*   NGEN 更新
*   在调试选项中禁用“属性评估和其他隐式函数调用”
*   禁用符号服务器
*   禁用符号加载
*   删除了 WPF 字体缓存
*   用 'DebuggerDisplay("some text without expression")' 标记了几个 UI 元素

（[票Microsoft Connect](https://connect.microsoft.com/VisualStudio/feedback/details/777769/visual-studio-2010-managed-debugger-hangs-after-hitting-a-breakpoint)）

**可能相关的问题：**

因为我们的应用程序使用 .NET Remoting 与另一个进程通信，所以我的问题与[此处](http://tech.pro/tutorial/914/wcf-callbacks-hanging-wpf-applications)类似。我已将所有对远程事件的注册放在自己的任务中，但没有成功。

**调试后的 Visual Studio 的调试器输出：**

我已将调试器附加到 Visual Studio 并观察到一些异常，**（80010005）**

但我不知道它们是否与我的问题相关：

```
(18d8.1708): C++ EH exception - code e06d7363 (first chance)
(18d8.1708): C++ EH exception - code e06d7363 (first chance)
..... // snip
(18d8.18dc): **Unknown exception - code 80010005 (first chance)
..... // 20 seconds freeze until breakpoint hit in IDE

(18d8.18dc): Unknown exception - code 80010005 (first chance)
(18d8.18dc): C++ EH exception - code e06d7363 (first chance)
ModLoad: 365f0000 36665000 C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\Packages\Debugger\mcee.dll

// after continue execution debugger and debugged process freezes forever

(18d8.18dc): Unknown exception - code 80010005 (first chance)
ModLoad: 00000000`02b90000 00000000`02c1c000 C:\Windows\SysWOW64\UIAutomationCore.dll
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance)
(18d8.1a8c): CLR exception - code e0434352 (first chance) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:08:35.840

您可以使用以下 url 中的 windebug 工具来更好地调试并整理出解决方案

[http://msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg463009.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T13:02:58.107

感谢您的提示。最后我安装了 VS 2012，调试器现在表现正常。Visual Studio 2010 调试器中似乎确实存在错误/性能问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:00:42.953

我越看这个，我越怀疑这是因为你没有使用 WPF 计时器。如果您尝试使用常规 Timer 类而不是 WPF Dispatcher 计时器，则可能会尝试在非 ui 线程上更新 UI - 这可能是您的问题的原因（因为 DataContext 是UI 技术上）。

更多信息在这里：

[DispatcherTimer 与 WPF 应用程序中用于任务调度程序的常规 Timer](https://stackoverflow.com/questions/2258830/dispatchertimer-vs-a-regular-timer-in-wpf-app-for-a-task-scheduler)

# git - 让 NuGet 与整个解决方案和其中包含的单个项目一起工作

> ID：14755347
> 
> 赞同：4
> 
> 时间：2013-02-07T15:54:57.573
> 
> 标签：git, msbuild, jenkins, solution, csproj

我有一个包含几个项目的解决方案。除了一个之外，其他都是类库项目，用于多种解决方案，作为 git 子模块包含在内，并且没有 .sln 文件，只有 .csproj 和 .cs 源。

像这样的东西（一行，一个存储库）

```
TheProgram: .sln, exe.csproj, .nuget/NuGet.{config,targets}, packages.config, .cs files
  submodule-0: sub-n.csproj, packages.config, and some .cs files
  submodules-1 to n: as above 
```

在编译整个解决方案时，一切都运行良好 - 如果需要，会下载 nuget.exe，安装包，然后它就可以正常工作。

克隆使用 nuget 包的单个子项目，然后使用 msbuild 构建它失败。它找不到`nuget.targets`。查看 csproj 似乎是因为以下几行：

```
<SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\..\</SolutionDir>
...
<Import Project="$(SolutionDir)\.nuget\nuget.targets" /> 
```

让一个项目引用一个以开头的路径`..\..\`对我来说感觉不对，但这是 nuget 生成的，我的手写 msbuild 脚本的经验非常有限。

我希望这个工作的原因是詹金斯，当我没有使用任何 nuget 包时，它在推送之后构建了解决方案的任何部分。

我可以看到一些方法来完成这项工作，例如可以将 nuget dir 添加到每个子模块并使用它，如果没有编译为解决方案的一部分，或者向每个 csproj 添加一些 BeforeBuild 命令行，或者向每个子模块添加一个 .sln。这些都不对。

我是不是做错了什么，当我停止这样做时，一切都会奏效吗？

如果没有，是否有人以不太难看的方式解决了类似的问题，还是我应该研究一下 msbuild 并自己做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T20:42:52.080

我通过定义与`SolutionDir`属性相关的`MSBuildProjectDirectory`属性来使其工作：

```
<SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">$(MSBuildProjectDirectory)\..\</SolutionDir> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T20:40:31.367

您可以尝试将 nuget.config 添加到每个项目，将外部位置指定为存储库。

```
<configuration>
 <config>
     <add key="repositoryPath" value="c:\nuget" />
 </config>
 <packageSources>
     <add key="NuGet official package source" value="https://nuget.org/api/v2/" />
 </packageSources>
 <activePackageSource>
     <add key="All" value="(Aggregate source)" />
 </activePackageSource>
 <packageRestore>
     <add key="enabled" value="true" />
 </packageRestore>
</configuration> 
```

# php - php pdo查询错误

> ID：14755352
> 
> 赞同：0
> 
> 时间：2013-02-07T15:55:01.473
> 
> 标签：php, scripting, pdo

有 PDO 经验的人可以帮助我吗？我已经花了大约 6 个小时，但我仍然无法运行查询。

这是我的代码：

```
<?php

include('database.php');

//print_r($_GET);

if(isset($_GET['ctype']))
{
    $ctype = $_GET['ctype'];
}
else
{
    die("Could determine type of input");
}

if($ctype==1)
{
//it is client
    if((isset($_GET['uid'])) && (isset($_GET['name'])) && (isset($_GET['address'])) && (isset($_GET['city'])) && (isset($_GET['state'])) && (isset($_GET['zip'])))
    {
        try 
        {

            $conn = new PDO("mysql:host=$host;dbname=$database", $username, $password);         
            //$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);           
            $sql = "INSERT INTO clients (uid, name, address, city, state, zip) VALUES(:uid, :name, :address, :city, :state, :zip)";                         
            $stmt = $conn->prepare($sql);                               
            $stmt->execute(array(
            ':uid' => $_GET['uid'],
            ':name' => $_GET['name'],
            ':address' => $_GET['address'],
            ':city' => $_GET['city'],
            ':state' => $_GET['state'],
            ':zip' => $_GET['zip']      
            ));
            echo $stmt->rowCount(); // 1            
        } 
        catch(Exception $e) 
        {
            echo 'Error: ' . $e->getMessage();
        }

    }   
}?> 
```

database.php 是：

```
<?php
//Please Enter database settings here
$username = "root";
$password = "";
$database="letters";
$host="localhost";
?> 
```

我用这个 GET 请求点击了页面

```
http://localhost/letters/contact_add.php?ctype=1&uid=mmm&name=test&address=6182&city=xyz&state=abc&zip=123456 
```

我得到的错误：

```
Parse error: in C:\xampp\xampp\htdocs\letters\contact_add.php on line 26 
```

第 26 行是：

```
$sql = "INSERT INTO clients (uid, name, address, city, state, zip) VALUES (:uid, :name, :address, :city, :state, :zip)"; 
```

我浏览了几乎所有可以在谷歌上获得的链接，但仍然无法找到问题所在。我遵循的链接是[这个](http://www.phpeveryday.com/articles/PDO-Insert-and-Update-Statement-Use-Prepared-Statement-P552.html)。我正在运行 xampp 1.8.1 并且 extension=php_pdo_mysql.dll 已启用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:13:53.170

您发布的代码中没有解析错误。因此，您正在运行其他代码。
请仔细检查您实际运行的文件。

# python - 从继承自models.Model的类的python子类

> ID：14755357
> 
> 赞同：2
> 
> 时间：2013-02-07T15:55:14.110
> 
> 标签：python, django, class, subclass, abstract

我这里有一些疑问...

想象一下，我有 3 个课程：

```
class CarSpec(models.Model):
    x = models.IntegerField(default=20)
    y = models.CharField(max_length=100, blank=True)
    z = models.CharField(max_length=50, blank=True)
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'A'})
    car_brand = models.CharField(max_length=100, blank=True)
    car_model = models.CharField(max_length=50, blank=True)
    number_of_doors = models.IntegerField(default=2)

class MotoSpec(models.Model):
    x = models.IntegerField(default=20)
    y = models.CharField(max_length=100, blank=True)
    z = models.CharField(max_length=50, blank=True)
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'C'})
    motor_brand = models.CharField(max_length=100, blank=True)
    motor_model = models.CharField(max_length=50, blank=True)
    powered_weels = models.IntegerField(default=1)

class Chassis(models.Model):
    name = models.CharField(max_length=50, blank=False)
    type = models.CharField(max_length=2, choices = GAME_TYPES, default="A")

GAME_TYPES = (('A', 'Car'),('B', 'Truck'),('C', 'Motorcycle')) 
```

我正在使用这 3 个类，但在我的应用程序中，我必须一直检查**机箱**类型，以便将一些业务规则应用于每种情况......我认为这不是正确的方法......所以我计划这个：

```
class Spec(models.Model):
    x = models.IntegerField(default=20)
    y = models.CharField(max_length=100, blank=True)
    z = models.CharField(max_length=50, blank=True)

    class Meta:
        abstract = True 
```

并有两个子类：

```
class CarSpec(Spec):
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'A'})
    car_brand = models.CharField(max_length=100, blank=True)
    car_model = models.CharField(max_length=50, blank=True)
    number_of_doors = models.IntegerField(default=2)

class MotoSpec(Spec):
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'C'})
    motor_brand = models.CharField(max_length=100, blank=True)
    motor_model = models.CharField(max_length=50, blank=True)
    powered_weels = models.IntegerField(default=1)

class Chassis(models.Model):
    name = models.CharField(max_length=50, blank=False)
    type = models.CharField(max_length=2, choices = GAME_TYPES, default="A")

GAME_TYPES = (('A', 'Car'),('B', 'Truck'),('C', 'Motorcycle')) 
```

好的，直到这里一切正常，我的应用程序中没有任何改变，这些应用程序与以前的类一起工作，并且所有对象都按预期很好地保存在数据库中..

但是，我的问题仍然存在……因为我继续实例化 CarSpec 和 MotoSpec 而不是 Spec……但是……我想一直使用 Spec 而不是扩展类……既然如此，我该怎么做能够实例化一个 Spec 对象，将 Chassis 传递给他的**init**方法，以便从该（或其他）方法中获取 CarSpec 或 MotoSpec。

**EDITED-IMPORTANT**：我为 MotoSpec 添加了**powered_weels****属性**，为CarSpec**添加**了**number_of_doors**属性，因为我为这两个规范中的每一个都有一些特定的字段

 ****再次编辑**：在我看来，我想避免每次我弄乱 Specs 时都进行类型验证，并将其留给所涉及的类之一。恢复，我希望能够添加一个新的 Spec 对象，而不必担心更改我的视图.. 只有与 Specs 相关的对象..

```
# CarSpec
if game_type == "A":
    stuff = CarSpec.restore_state(request, game_session)
# MotoSpec
elif game_type == "C":
    stuff = MotoSpec.restore_state(request, game_session) 
```

**已编辑**：我在我的 Spec 类中添加了 restore_state，但后来我想我发现了一些与循环导入相关的问题.. OMG .. 这让我很生气。我有 .NET 背景，python 在这些方面对我来说并不容易：S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:59:29.080

为 Spec 类添加底盘、品牌和型号属性，然后为 CarSpec 和 MotoSpec 类使用[代理模型](https://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models)，可能添加 car_brand()、motor_brand() 等方法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:59:51.160

尽管您可以删除`class Meta`该类`Spec`（以便您拥有`Spec`对象）。我不认为你可以重写`__init__`类上的方法来实例化`CarSpec`或`MotoSpec`对象。这会给你一个循环依赖；对象的定义`CarSpec`依赖于对象的定义`Spec`（因为`CarSpec`是 的后代`Spec`）。您不能使对象的定义`Spec`依赖于`CarSpec`对象（如果`CarSpec`出现在`Spec`的`__init__`定义中就会如此）。

我个人认为您应该使用 lysergia25 建议的代理模型，并隐藏/需要代理中的其他字段。

更新

假设您将所有字段添加到`Spec`（`blank=True, null=True`在仅出现在一个子类中的字段上），那么您可以执行以下操作 -

```
class MotoSpec(Spec):
    class Meta:
        proxy = True

    def __init__(self, *args, **kwargs):
        super(MotoSpec, self).__init__(*args, **kwargs)
        self.fields['number_of_doors'].editable = False
        self.feilds['powered_wheels'].blank = False 
```

`number_of_doors`这应该从所有表单（inc admin）中隐藏该字段，同时需要`powered_wheels`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:22:29.823

提出：

```
class Spec(models.Model):
    x = models.IntegerField(default=20)
    y = models.CharField(max_length=100, blank=True)
    z = models.CharField(max_length=50, blank=True)
    brand = models.CharField(max_length=100, blank=True)
    model = models.CharField(max_length=50, blank=True)

class CarSpec(Spec):
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'A'})
    number_of_doors = models.IntegerField(default=2)
CarSpec._meta.get_field('brand').verbose_name = 'Car Brand'
CarSpec._meta.get_field('model').verbose_name = 'Car Model'

class MotoSpec(Spec):
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'C'})
    powered_weels = models.IntegerField(default=1)
MotoSpec._meta.get_field('brand').verbose_name = 'Motor Brand'
MotoSpec._meta.get_field('model').verbose_name = 'Motor Model'

class Chassis(models.Model):
    GAME_TYPES = (
        ('A', 'Car'),
        ('B', 'Truck'),
        ('C', 'Motorcycle')
    )

    name = models.CharField(max_length=50, blank=False)
    type = models.CharField(max_length=2, choices = GAME_TYPES, default="A") 
```

或者您可以在 forms.py 中输入详细名称

```
class CarSpec(Spec):
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'A'})
    number_of_doors = models.IntegerField(default=2)

class MotoSpec(Spec):
    chassis = models.ForeignKey(Chassis, unique=True, limit_choices_to={'type':'C'})
    powered_weels = models.IntegerField(default=1) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-07T15:59:39.613

您应该使用多表继承，如[django 文档中所述](https://docs.djangoproject.com/en/dev/topics/db/models/#model-inheritance)**

# jquery - Knockout.js：如何防止在表中添加重复项

> ID：14755361
> 
> 赞同：0
> 
> 时间：2013-02-07T15:55:26.853
> 
> 标签：jquery, knockout.js

我正在使用 Knockout.js。我有一个 HTML 表单，用户可以在其中向表格添加条目。下面是我的代码。

问题是您可以创建重复的条目。我不想允许那样。

我该如何补救？

HTML

```
<div class="span12">
  <button style="margin-bottom: 10px;" class="btn" data-bind="click: function () { ViewModel.AddIntMember() }"><i class="icon-plus"></i>Add</button>
</div>
        <div class="span8">

           <table class="table table-bordered table-condensed">
                <thead>
                    <tr>
                       <th></th>
                          <th>Name</th>                      
                                <th>Staff No</th>                       
                            </tr>
                </thead>
                <tbody data-bind="foreach: ViewModel.RiskAssessment.IntTeam">
                    <tr>
                        <td>
                            <button class="btn btn-small" data-bind="click: function () { ViewModel.StaffViewModel.Remove($data) }">
                                <i class="icon-remove"></i>
                                 Remove</button>
                         </td>
                                <td data-bind="text: Name"></td>
                                <td data-bind="text: StaffNo"></td>
                    </tr>
                </tbody>
            </table>
         </div> 
```

JS 相关函数

```
AddIntMember: function () {
                    LoadStaff("", 0);
                    $("#InternalStaffPopup").bPopup({ positionStyle: "fixed", scrollBar: true });
                },

Select: function (staffMember) {
                        ViewModel.RiskAssessment.IntTeam.push({ Id: 0, RiskAssessmentId: 0, StaffNo: staffMember.StaffNo, Name: staffMember.Name });
                    },

Remove: function (staffMember) {
                        ViewModel.RiskAssessment.IntTeam.remove(staffMember);
                    }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:39:02.863

我将通过向您的视图模型添加两个可观察的属性来处理这个问题：名称和员工编号。像这样的东西

```
self.Name = ko.observable();
self.StaffNumber= ko.observable(); 
```

然后将输入元素添加到绑定到这些的 html 中。

```
<div class="span12">
<div>
<label for="StaffName">Street Address</label>
<input type="text" id="StaffName" data-bind="value: ViewModel.Name" />
</div>
<div>
<label for="StaffNumber">Street Address</label>
<input type="text" id="StaffNumber" data-bind="value: ViewModel.StaffNumber" />
</div>

<button style="margin-bottom: 10px;" class="btn" data-bind="click: function () { ViewModel.AddIntMember() }"><i class="icon-plus"></i>Add</button>
</div> 
```

最后，在您的 AddIntMember 函数中，您只需在将它们添加到 ViewModel.RiskAssessment observableArray 之前检查重复项。

```
 AddIntMember: function () {
      //self.Name and self.StaffNumber contains the values the user entered
      //look through ViewModel.RiskAssessment.IntTeam for duplicates
      var isUnique = yourWayOfCheckingForDuplicates();
      if (isUnique) {
         LoadStaff("", 0);
         $("#InternalStaffPopup").bPopup({ positionStyle: "fixed", scrollBar: true });
      }
      else {
        //display to user that their entries need to be unique
      }}, 
```

玩得开心！

# algorithm - 生成实际值列表，这些值总和为固定值并满足一些约束

> ID：14755366
> 
> 赞同：1
> 
> 时间：2013-02-07T15:55:46.953
> 
> 标签：algorithm, random, constraints

我需要生成满足以下约束的 n 个随机实数值 P[0], P[1], ..., P[n-1]：

```
Pmin[0] <= P[0] <= Pmax[0]
Pmin[1] <= P[1] <= Pmax[1]
...
Pmin[n-1] <= P[n-1] <= Pmax[n-1]

P[0] + P[1] + ... + P[n-1] = S 
```

知道如何有效地做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:03:47.000

一般来说，如果从给定的范围内随机均匀地选择元素，是不可能解决这个问题的。

示例 1：假设 Pmin[i] = 0 和 Pmax[i] = 1。假设 n = 10 和 S = 100。那么没有解，因为最大可能的和是 10。

示例 2：假设 Pmin[i] = 0 和 Pmax[i] = 1。假设 n = 10 和 S = 10。那么只有一个解决方案：选择 P[i] = 1。

可以编写一个算法，从可能的解决方案集中随机均匀地选择结果序列；这与说 P[i] 均匀分布在 Pmin[i] 和 Pmax[i] 之间完全不同。

基本思想是，在每个阶段，进一步限制你的范围，如下所示：

1.  范围的开始应该是以下两个量中较大的一个：Pmin[i]，或 S - Smax[i] - P，其中 Smax[i] 是和 Pmax[i+1] + ... + Pmax[n] 和 P 是和 P[0] + ... + P[i]。这可以保证您选择的数字足够大，最终可以工作。
2.  范围的末端应该是以下两个量中较小的一个：Pmax[i]，或 S - Smin[i] - P，其中 Smin[i] 是和 Pmin[i+1] + ... + Pmin[n] 和 P 和以前一样。这可以保证您选择的数字足够小，最终可以工作。

如果您在选择每个 P[i] 时能够遵守这些规则，那么就有一个解决方案，您会随机找到一个解决方案。否则，没有解决办法。

请注意，要实际随机选择解决方案，最好对索引进行洗牌，执行此算法，然后重新排列序列，使其顺序正确。您可以在 O(n) 中洗牌，执行此算法（此处推荐动态编程，因为您可以自下而上构建解决方案），然后通过“解洗”结果序列来吐出序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:42:16.317

```
For every i, assign P[i] := Pmin[i]
Compute the sum
If sum>S, then stop (it's impossible)
For every i:
    If P[i]+S-sum <= Pmax[i]
        P[i] = P[i]+S-sum
        Stop (it's done :-)
    sum = sum+Pmax[i]-P[i]
    P[i] = Pmax[i]
    Go for next i
Stop (it's impossible) 
```

哎呀，对不起，你说随机......这不是那么微不足道。让我想想...

运行前面的算法有一个起点。现在计算上下的总保证金。上面的边距是每个 i 的各个边距 Pmax[i]-P[i] 的总和。下面的边距是每个 i 的各个边距 P[i]-Pmin[i] 的总和。

以随机顺序遍历除**一个之外**的所有元素，每个元素只访问一次。对于他们每一个人：

*   更新上面的边距和下面的边距，从它们中减去当前元素的贡献。
*   建立当前值的最小值和最大值，同时考虑：
    *   它们必须在区间 [Pmin[i], Pmax[i]] *AND*
    *   这些最小值和最大值足够接近 P[i]，因此稍后更改其他元素可以补偿将 P[i] 更改为此最小值或最大值（这就是上下边距所指示的）
    *   将 P[i] 更改为计算间隔 [min, max] 中的随机值并更新总和和边距（我不是 100% 确定应该如何在此处更新边距......）

然后调整剩余元素以适合总和 S。

关于随机顺序的遍历，请参阅[Knuth shuffles](http://en.wikipedia.org/wiki/Random_permutation#Knuth_shuffles)。

# java - 使用假 smtp 服务器生成 MailSendException

> ID：14755368
> 
> 赞同：1
> 
> 时间：2013-02-07T15:55:55.530
> 
> 标签：java, spring, unit-testing, jakarta-mail

我需要测试一些使用 Spring MailSender 实例发送电子邮件批处理的组件。当提供的目标地址格式不正确时，方法“send”会引发 MailSendException，例如 myAddressgmail.com（请注意，我并不是假装我的 smtp 服务器知道该地址是否真的存在于目标主机中，只是在谈论结构）。事实上，这就是使用我真正的 smtp 服务器时发生的情况。

为了模拟 smtp 服务器，我尝试了 Dumbster 和 GreenMail，这里出现了问题。这些虚假的 smtp 服务器不检查地址是否格式正确，因此不会抛出 MailSendException。我需要抛出这个异常来测试异常处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:25:54.907

使用像[Mockito](http://mockito.googlecode.com)或[EasyMock](http://www.easymock.org/)这样的模拟库。

然后您可以执行以下操作：

```
MailSender mockSender = mock(MailSender.class);
YourSMTPServer server = new YourSMTPServer(mockSender);

when(mockSender.send(...)).thenThrow(new MailSendException(...));

// then invoke the method on your server that calls MailSender.send() and
// assert it does what you want it to do when an exception is encountered 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-10T10:55:31.300

您可以使用 mailnest.io 进行电子邮件测试。在平台中有一个错误模式，您可以打开它来模拟来自服务器的错误响应。

# php - 回声会话变量不起作用

> ID：14755370
> 
> 赞同：1
> 
> 时间：2013-02-07T15:55:56.073
> 
> 标签：php, session

我在将 SESSION 变量“登录”传递到其他页面时遇到问题。我一直在使用 session_is_registered，但现在因为 PHP5 我不得不继续前进。

这是我的**login.php**

```
$login=$_POST['login']; 
$heslo=$_POST['heslo']; 
// ochrana proti MySQL Injection + mysql query
$login = stripslashes($login);
$heslo = stripslashes($heslo);
$login = mysql_real_escape_string($login);
$heslo = mysql_real_escape_string($heslo);
$md5heslo=md5($heslo);
$sql="SELECT * FROM uzivatele WHERE login='$login' and heslo='$md5heslo'";
$result=mysql_query($sql);

//zjištění id uživatele pro přiřazení do SESSION
$query = mysql_query("SELECT * FROM uzivatele WHERE login='$login'");
$row = mysql_fetch_array($query);
$id = $row['id'];

// Mysql_num_row počítá řádky
$count=mysql_num_rows($result);

// Jestliže výsledek($result) se shoduje s $login a $heslo, musí být první řádek
if($count==1){

// zapsání proměnných login, přesměrování ná "loggedin_main.php"
$_SESSION['login'] = $login;
$_SESSION['id'] = $id;
header("location:loggedin_main.php");
}
else {

echo "<div class=\"grey_box\">Špatné jméno nebo heslo, zkuste to prosím znovu. <br> <a            href=index.php>Přejít na hlavní stránku.</a></div>";} 
```

**这是我在其他页面上放置的代码。**

```
<?php
session_start();
$_SESSION['login'] = $login;
if (isset($_SESSION[$login])){
header("location:index.php");
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:57:05.183

看起来你忘了放在`session_start();`login.php 的顶部

# ios - iOS，如何正确支持多种语言

> ID：14755377
> 
> 赞同：2
> 
> 时间：2013-02-07T15:56:13.470
> 
> 标签：ios

我们目前在 AppStore 上有一个英文应用程序，并决定支持另一种语言。但我不知道从哪里开始。

应该如何创建应用程序内容才能支持这一点？我应该只用各自的语言创建两个单独的应用程序并将它们都提交到 AppStore 吗？还是我必须创建一个具有某种即时翻译机制的应用程序？

我不认为用我的应用程序的多个版本充斥 AppStore 是可行的方法（至少在 Apple Review 团队看来）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:59:37.020

通常的方式是使用iOS的本地化。您不应该上传不同的应用程序！

有关教程，请参阅此链接：[如何本地化 iPhone 应用程序](http://www.raywenderlich.com/2876/how-to-localize-an-iphone-app-tutorial)

# javascript - 如何修改在 Backbone 同步期间生成的 URL，但仅限于特定请求

> ID：14755388
> 
> 赞同：0
> 
> 时间：2013-02-07T15:56:54.403
> 
> 标签：javascript, backbone.js

我想更改我的实体调用销毁时生成的 URL。我不想将 HTTP DELETE 写入 /{Action}/{EntityID}，而是发送 /{Action}/{EntityID}/{SecondEntityID}。

```
item.destroy({
    data: $.param({
        playlistId: playlistId
    }),
    processData: true,
    success: callback,
    error: function (error) {
        console.error(error);
    }
}); 
```

我认为这样的事情可能会起作用，但它似乎没有附加任何额外的参数。如果我想扩展只是破坏的 URL，我是否必须完全实现我自己的同步方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T17:38:46.063

您可以通过在调用销毁时在选项中传入 .url 属性来覆盖。由于我假设您希望为每次通话都执行此操作，因此您可以执行以下操作：

```
var MyModel = Backbone.Model.extend({
  destroy: function(options) {
    // Override URL
    options || (options = {});
    // You can put whatever you need here,
    options.url = 'http://www.awesome.com/destroy/' + this.get('id') + '/' + this.get('secondaryId');

    // Call Model.destroy().
    // We are reusing the existing functionality from Backbone.Model.destroy().
    Backbone.Model.prototype.destroy.apply(this, arguments); 
  }
});

var m= new MyModel({ id: 123, secondaryId: 456 });

// Note: You need to set 'id' in order for destroy() call to be successful.
m.destroy({
  sucess: function() { console.log('good'); },
  error: function() { console.log('bad'); }
}); 
```

如果您打开 Firebug 或 Chrome 开发工具，您应该会看到对 www.awesome.com 进行了 XHR/AJAX 调用。

既然您提到您希望在您拥有的所有实体上执行此操作，那么在这种情况下您可以做的是`BaseModel`在您的应用程序中创建一个，并让您的所有实体都从它扩展。

无论如何，希望这会有所帮助！

JSFiddle：http: [//jsfiddle.net/EwQaD/](http://jsfiddle.net/EwQaD/)

# matlab - matlab积分中的向量值限制

> ID：14755389
> 
> 赞同：-1
> 
> 时间：2013-02-07T15:56:58.727
> 
> 标签：matlab

是否可以对任何 matlab 积分函数使用向量限制？由于程序的速度，我必须避免使用 for 循环。你能给我一个关于做的线索吗

```
k=0:5
f=@(x)x^2
quad(f,k,k+1) 
```

如果有人需要，我找到了我的问题的答案：[quad with vector limit](https://stackoverflow.com/questions/9636660/quad-with-vector-limit)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:12:28.753

根据我对`quad`功能的经验，我会尝试给你一个答案。

从此开始：

```
k=0:5;
f=@(x) x.^2; 
```

请注意您的`f`定义（不正确）和我的定义（正确）的差异。

如果您只想`f`在范围内集成，`(0,5)`您可以轻松调用

```
quad(f,k(1),k(end)) 
```

如果没有句柄功能，您可以通过使用以下方法以不同的方式获得相同的结果`trapz`：

```
x = 0:5;
y = x.^2;
trapz(x,y) 
```

`[k(i),k(i+1)]`相反，如果您打算在您可能键入的小范围内执行逐步积分

```
arrayfun(@(ii) quad(f,k(ii),k(ii+1)),1:numel(k)-1) 
```

为了方便起见，请注意

```
sum(arrayfun(@(ii) quad(f,k(ii),k(ii+1)),1:numel(k)-1)) == quad(f,k(1),k(end)) 
```

我希望这有帮助。

# javascript - 在开发库时，我们应该抛出错误/异常吗？

> ID：14755391
> 
> 赞同：7
> 
> 时间：2013-02-07T15:57:01.267
> 
> 标签：javascript, debugging, error-handling, shared-libraries

我正在开发一个供其他人使用的 pub/sub Mediator 库，但我不知道如何处理错误。

这是一段示例代码：

```
/**
 *
 * @param String channel Channel to subscribe
 * @param String|function callback Function name or callback
 * @param String context Context to bind function to
 * @param Boolean once True to subscribe once
 **/
this.subscribe = function (channel, callback, context, once) {

    if (!_.isObject(context)) {
         context = window;
    }

    if (!_.isFunction(subscription) && !_.isFunction(context[subscription])) {
        throw new Error('Function passed as callback to channel subscription named  ' + channel + ' seems invalid!');
    }

    // Everything ok, add to channels object
    channels[channel].push({fn: subscription, context: context || this, once: once});
} 
```

此方法是库的一部分。它的 API 需要一个通道名称和一个有效的回调（函数名称、lambda 或回调）。

如果通道参数不是字符串，库很容易停止。如果传递了无效的上下文，则假定为 window。这两个参数中的错误很容易调试。

但是，如果传递了无效的回调，它会传播错误，直到触发事件（进行频道发布）。在发布/订阅系统中，如果事件很少被触发，这可能会成为调试的噩梦。

* * *

**所以我的问题是...**

在这种特定情况下，考虑到我正在为其他人开发 javascript 库，我应该：

*   抛出错误以防止进一步的错误传播？
*   返回 false/undefined/-1 并且不注册订阅？
*   正常进行，让它死在某个地方，将调试留给第三方开发人员

* * *

注意：有[一个类似的问题](https://stackoverflow.com/questions/8689516/js-library-best-practice-return-undefined-or-throw-error-on-bad-function-input)，但我的情况有点不同，提供的答案并没有让我的精神放松。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:05:38.913

我想这个答案更多的是我的观点和我所遵循的。您必须问自己是否应该返回抛出错误并让您的库的使用者处理错误。如果错误是无法恢复的，则无需抛出错误（在 JS 中）。你的库应该能够优雅地回退到替代方案，但如果它不能为某个函数做到这一点，它应该返回 undefined。大多数 JS 开发人员确实会检查未定义，并且在使用库函数时这样做是很常见的做法。如果无法处理事件，通常在事件处理程序中返回 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:32:53.147

应该避免选项#3。至少，`return false;`。您甚至可以注册无效的回调，期望也没有发布任何事件（因为出现问题）。这种“如果不是一切都出错了，静默失败”可能并不真正适用于您的 pub/sub 示例，但可能有它的用例。

选项#2 听起来不错。它以某种方式使`callback`参数显式可选，这可能是您的库的一个功能 - 如果用户不确定自己是否有理由订阅，如果您仍然这样做，他可以省略该测试。您可以将其与`console.warn()`调试版本中的消息结合使用。

如果确实发生了意想不到的事情，则应选择选项 #1。它允许您以非常描述性的自定义错误消息失败。如果回调是真实对象但不可调用，或者通道参数是布尔值或其他东西，则可能是这种情况 - 取决于您的界面设计的封闭程度/您提供的重载程度（在您的情况下，您可以接受字符串被评估为回调，例如通道字符串数组）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-13T15:09:23.110

错误和异常应该完全停止执行并通知调用者。“抛出错误以防止进一步的错误传播？” 如果在这种情况下不应该执行您的代码，则完全是编写选择。

尽管如此，如果您预计某些内容会被错误传递，您可以返回一些特殊值并在文档中进行描述。默认值被开发人员广泛使用，这并不直观，但大多数情况下都有效：

```
/*
* ...
* Returns a Socket if found, otherwise undefined
*/

function FindSocketOrUndefined(): Socket|undefined {
...
return undefined
} 
```

# javascript - 从 .js.erb 文件中热获取 I18.locale？

> ID：14755397
> 
> 赞同：0
> 
> 时间：2013-02-07T15:57:21.893
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3.2, rails-i18n

我正在尝试根据语言做一个“if”语句，并找到正确的方法让 JS 找到语言环境。

在我试用时，我尝试过与此类似的组合，但无济于事。

```
alert(<%= I18n.locale.to_s %>); 
```

页面加载但未显示警报。

知道我缺少什么吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:01:06.230

您缺少引号。

```
alert('<%= I18n.locale.to_s %>'); 
```

# extjs - Sencha CMD：运行构建的生产版本时出现 404 错误

> ID：14755401
> 
> 赞同：1
> 
> 时间：2013-02-07T15:57:23.097
> 
> 标签：extjs, extjs4, sencha-cmd

我已将现有的 ExtJS 4.1.3 应用程序转换为使用 Sencha CMD 推荐的结构和工具。我首先创建了结构，然后将我现有的应用程序 JS 文件放在单页 JS 应用程序应该放置的位置。

我目前在以下位置访问我的应用程序的开发版本：

```
{my-server-side-app-url}/sws/dt/index.jsp 
```

[Sencha 工作区](http://docs.sencha.com/ext-js/4-1/#!/guide/command_workspace)在哪里`sws`，Sencha[单页应用程序](http://docs.sencha.com/ext-js/4-1/#!/guide/command_app_single)在哪里。到目前为止，我相信没有问题。然后我运行命令：`dt`

```
sencha app build 
```

在我`app`的目录中。这完成了几个`Yui Compressor Warning (Trailing comma is not legal in an ECMA-262 object initializer`警告，但没有错误。所以我在 URL的*生产* `index.jsp`页面（它使用`all-classes.js`文件，接收上述命令的串联输出）：`app build`

```
{my-server-side-app-url}/sws/build/dt/production/index.jsp 
```

当`all-classes.js`尝试加载*理论上应该包含在其自身中的*多个文件时，就会出现此问题。其中包括*app.js*中指定的控制器。

为什么这些文件没有被连接起来`all-classes.js`？下面是 Chrome 尝试从 加载它们的屏幕截图，`all-classes.js`当然没有找到它们。

![在此处输入图像描述](../Images/03239c8d41c3ad46e092117881815f17.png)

*我尝试了什么？* 试图通过调整我`app.js`的*要求*控制器[`requires`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Class-cfg-requires)；[`uses`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Class-cfg-uses)或通过此[问题/答案对](https://stackoverflow.com/questions/14457508/using-sencha-cmd-with-dynamically-loaded-controllers)的建议提供所需的课程，但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T14:41:54.380

尝试在. [`uses`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Class-cfg-uses)_[`requires`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Class-cfg-requires)`app.js`

请注意，如果控制器需要一些视图，您可以在 的 require 部分中省略该视图`app.js`，因为当 sencha 工具解析您的控制器时，它将被包含在内。

`uses`在将文件添加到/`requires`部分时尝试使用完整路径`app.js`。也就是说，写`MyApp.controller.pages.Home`or`MyApp.store.users.List`但现在`pages.Home`or `users.List`。

您可以在 sencha 工具的 YUI 最小化阶段开始之前使用`-before-build`Ant`-after-build`目标来修改您的 app.js。
在我的情况下，我最终搜索`app/controller`文件夹内的所有控制器并将它们的名称添加`uses`到`app.js`. 这已经足够了，因为我的控制器中需要其他需要的类。

为了能够找到 app.js 的使用部分，我使用了特殊注释

```
/*ant-generated-content-start*/ /*ant-generated-content-end*/ 
```

我的`app.js`

```
Ext.application({
    name: 'MyApp',
    appFolder: 'app',

    controllers: [
        "main.App"
    ],

    uses: [
        /*ant-generated-content-start*/ /*ant-generated-content-end*/
    ],
    autoCreateViewport: true,
}); 
```

我的`build.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<project name="MyApp" default=".help">
    <import file="${basedir}/.sencha/app/build-impl.xml"/>

    <target name="-before-build">

        <echo message="Collecting all controllers in application class property ... "/>
        <fileset id="app_controllers" dir="${app.dir}/app/controller" casesensitive="yes">
            <include name="**/*.js"/>
        </fileset>
        <pathconvert pathsep="," property="app_controller_names" refid="app_controllers" targetos="unix">
            <chainedmapper>
                <globmapper from="${app.dir}/app/*" to="${ant.project.name}/*" casesensitive="no" handledirsep="yes"/>
                <chainedmapper>
                    <regexpmapper from="^(.*)\.js$$" to='"\1"'/>
                    <filtermapper>
                        <replacestring from="/" to="."/>
                        <replacestring from="\" to="."/>
                    </filtermapper>
                </chainedmapper>
            </chainedmapper>
        </pathconvert>
        <echo message="Collected controllers: ${app_controller_names}"/>

        <echo message="Injecting into app.js ..."/>
        <replaceregexp file="${app.dir}/app/app.js"
                       match="/\*ant-generated-content-start\*/(.*)/\*ant-generated-content-end\*/"
                       replace="/*ant-generated-content-start*/ ${app_controller_names} /*ant-generated-content-end*/"
                       byline="true"
                />
    </target>

    <target name="-after-build">
        <echo message="Reverting to original app.js ..."/>
        <replaceregexp file="${app.dir}/app/app.js"
                       match="/\*ant-generated-content-start\*/(.*)/\*ant-generated-content-end\*/"
                       replace="/*ant-generated-content-start*/ /*ant-generated-content-end*/"
                       byline="true"
                />
    </target>

</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T15:32:37.530

我仍然不完全理解这个问题，但这就是我为解决这个问题所做的。

我有两个模型；`App.js`并且`Window.js`分别有一个`hasMany`和`belongsTo`关系。在`App.js`：

```
associations: [{
    type : 'hasMany',
    model: 'WD.model.Window',
    name : 'windows'
}] 
```

在`Window.js`我有：

```
associations: [{
    type : 'belongsTo',
    model: 'WD.model.App',
    associationKey: 'appId'
}] 
```

我开始怀疑这些部分会导致问题，因为它们是唯一提供`404`;的 ExtJS 模块。其他提供 a 的模块`404`取决于使用`hasMany`和的模型文件`belongsTo`。

我只是删除了`associations`上面粘贴的片段（因为现在我没有使用它们，因为它们并没有真正起作用，因为我仍然必须自己加载数据，而不是自动加载孩子）。然后重新运行`sencha app build`，生产版本**正常**工作！

如果有人（**尤其是来自 Sencha 的人**）确切地知道我笨拙的修复工作的原因，请回答下面的问题或评论，我会更新答案。

感谢[@bhovhannes](https://stackoverflow.com/users/898580/bhovhannes)的回答，这仍然导致对问题的有用洞察；+1ed。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-20T08:29:35.470

我也有同样的问题，为了解决这个问题，我只是更改了类的名称。我使用 SenchaCmd 3.1.xx 和 Sencha Touch 2.2 构建

# java - 从从二进制 png 图像检索的像素数据中检测矩形

> ID：14755406
> 
> 赞同：2
> 
> 时间：2013-02-07T15:57:46.930
> 
> 标签：java, image, opencv

我已经从一个看起来像这样的 png 图像中检索了所有像素......![在此处输入图像描述](../Images/a5c55cf8d19fdb2f0aec7252ce7df6dd.png)

我开始将所有填充线水平化以获取每条线的起始结束像素....当我水平扫描时，我也得到水平层中的垂直线....我想可以手动编码，但它需要时间....我的问题是有没有人使用opencv，imageJ或其他方法来判断这些库是否可以解决问题......我也愿意接受任何算法建议......（使用Java）...... .

-> 最大的问题是 1 到 4 像素之间的线条粗细，否则我可以轻松检索关节点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T14:06:00.467

这是使用图像形态的可能解决方案。下面的代码是用 C++ 编写的，因为我对 Java 几乎没有经验。

要解决您的问题，您需要：

*   [细化](http://en.wikipedia.org/wiki/Thinning_(morphology))- 将粗线减少到一像素宽的线。
*   [命中或未命中变换](http://en.wikipedia.org/wiki/Hit_or_miss_transform)- 用于在二值图像中寻找模式，即角点和关节点。

坏消息是从 2.4.3 版开始，OpenCV 还不支持这两种操作。好消息是我已经实现了这两个操作，代码可以在我的博客上找到：

*   [`void thinning(cv::Mat& im)`](http://opencv-code.com/quick-tips/implementation-of-thinning-algorithm-in-opencv/)
*   [`void hitmiss(cv::Mat& src, cv::Mat dst, cv::Mat& kernel)`](http://opencv-code.com/tutorials/hit-or-miss-transform-in-opencv/)

我将使用我的`thinning()`和`hitmiss()`功能以及您的测试图像。

加载图像后，将其转换为单通道二值图像。

```
cv::Mat im = cv::imread("D1Xnm.png");
cv::Mat bw;
cv::cvtColor(im, bw, CV_BGR2GRAY);
cv::threshold(~bw, bw, 0, 255, CV_THRESH_BINARY | CV_THRESH_OTSU); 
```

![在此处输入图像描述](../Images/c3dec6fe2e4c38d0a67ef40205608a5e.png)

由于线条的宽度从 1 到 4 个像素不等，因此执行细化以获得一宽线条。

```
thinning(bw); 
```

![在此处输入图像描述](../Images/0fc9194b0b8fd9ec6f4e641d76bd1ba3.png)

从细化的图像中，注意到有完美和不完美的关节点，如下图所示。

![在此处输入图像描述](../Images/ae735e74db1e455e6e879d42cb2cf683.png) ![在此处输入图像描述](../Images/b80ae0f259b92597e6a8bd11b275b46d.png)

为了同时覆盖完美和不完美的关节点，我们需要以下核用于命中或未命中变换。

```
std::vector<cv::Mat> k;
k.push_back((cv::Mat_<char>(5,5) << -1,-1, 0,-1,-1,
                                    -1,-1, 0,-1,-1,
                                     0, 0, 0, 0, 1,
                                    -1,-1, 0, 0,-1,
                                    -1,-1, 1,-1,-1 ));

k.push_back((cv::Mat_<char>(5,5) << -1,-1, 0,-1,-1,
                                    -1,-1, 0,-1,-1,
                                     1, 0, 0, 0, 0,
                                    -1, 0, 0,-1,-1,
                                    -1,-1, 1,-1,-1 ));

k.push_back((cv::Mat_<char>(5,5) << -1,-1, 1,-1,-1,
                                    -1,-1, 0,-1,-1,
                                     1, 0, 0, 0, 0,
                                    -1, 0, 0,-1,-1,
                                    -1,-1, 0,-1,-1 ));

k.push_back((cv::Mat_<char>(5,5) << -1,-1, 1,-1,-1,
                                    -1,-1, 0,-1,-1,
                                     0, 0, 0, 0, 1,
                                    -1,-1, 0, 0,-1,
                                    -1,-1, 0,-1,-1 ));

cv::Mat dst = cv::Mat::zeros(bw.size(), CV_8U);

for (int i = 0; i < k.size(); i++)
{
    cv::Mat tmp;
    hitmiss(bw, tmp, k[i]);
    dst |= tmp;
} 
```

![在此处输入图像描述](../Images/56718a3e29aa369089a5d0cebbf6ada6.png)

打开原始图像以使结果更清晰。

关节点定位成功，在原图上绘制。

```
std::vector<std::vector<cv::Point> > cnt;
cv::findContours(dst.clone(), cnt, CV_RETR_EXTERNAL, CV_CHAIN_APPROX_SIMPLE);
cv::drawContours(im, cnt, -1, CV_RGB(255,0,0), 10); 
```

![在此处输入图像描述](../Images/92952dca1dafa19e906a5c3dcdae63b5.png)

* * *

为了完整起见，这里是完整的代码。通过一些努力，您可以将其移植到 Java。

```
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/highgui/highgui.hpp>

void thinningIteration(cv::Mat& im, int iter)
{
    cv::Mat marker = cv::Mat::zeros(im.size(), CV_8UC1);

    for (int i = 1; i < im.rows; i++)
    {
        for (int j = 1; j < im.cols; j++)
        {
            uchar p2 = im.at<uchar>(i-1, j);
            uchar p3 = im.at<uchar>(i-1, j+1);
            uchar p4 = im.at<uchar>(i, j+1);
            uchar p5 = im.at<uchar>(i+1, j+1);
            uchar p6 = im.at<uchar>(i+1, j);
            uchar p7 = im.at<uchar>(i+1, j-1);
            uchar p8 = im.at<uchar>(i, j-1);
            uchar p9 = im.at<uchar>(i-1, j-1);

            int A  = (p2 == 0 && p3 == 1) + (p3 == 0 && p4 == 1) + 
                     (p4 == 0 && p5 == 1) + (p5 == 0 && p6 == 1) + 
                     (p6 == 0 && p7 == 1) + (p7 == 0 && p8 == 1) +
                     (p8 == 0 && p9 == 1) + (p9 == 0 && p2 == 1);
            int B  = p2 + p3 + p4 + p5 + p6 + p7 + p8 + p9;
            int m1 = iter == 0 ? (p2 * p4 * p6) : (p2 * p4 * p8);
            int m2 = iter == 0 ? (p4 * p6 * p8) : (p2 * p6 * p8);

            if (A == 1 && (B >= 2 && B <= 6) && m1 == 0 && m2 == 0)
                marker.at<uchar>(i,j) = 1;
        }
    }
    im &= ~marker;
}

void thinning(cv::Mat& im)
{
    im /= 255;
    cv::Mat prev = cv::Mat::zeros(im.size(), CV_8UC1);
    cv::Mat diff;
    do {
        thinningIteration(im, 0);
        thinningIteration(im, 1);
        cv::absdiff(im, prev, diff);
        im.copyTo(prev);
    } 
    while (cv::countNonZero(diff) > 0);
    im *= 255;
}

void hitmiss(cv::Mat& src, cv::Mat& dst, cv::Mat& kernel) 
{
    CV_Assert(src.type() == CV_8U && src.channels() == 1);

    cv::Mat k1 = (kernel == 1) / 255;
    cv::Mat k2 = (kernel == -1) / 255;

    cv::normalize(src, src, 0, 1, cv::NORM_MINMAX);

    cv::Mat e1, e2;
    cv::erode(src, e1, k1, cv::Point(-1,-1), 1, cv::BORDER_CONSTANT, cv::Scalar(0));
    cv::erode(1 - src, e2, k2, cv::Point(-1,-1), 1, cv::BORDER_CONSTANT, cv::Scalar(0));
    dst = e1 & e2;
}

int main()
{
    cv::Mat im = cv::imread("D1Xnm.png");
    if (im.empty())
        return -1;
    cv::Mat bw;
    cv::cvtColor(im, bw, CV_BGR2GRAY);
    cv::threshold(~bw, bw, 0, 255, CV_THRESH_BINARY | CV_THRESH_OTSU);
    thinning(bw);

    std::vector<cv::Mat> k;
    k.push_back((cv::Mat_<char>(5,5) << -1,-1, 0,-1,-1,
                                        -1,-1, 0,-1,-1,
                                         0, 0, 0, 0, 1,
                                        -1,-1, 0, 0,-1,
                                        -1,-1, 1,-1,-1 ));

    k.push_back((cv::Mat_<char>(5,5) << -1,-1, 0,-1,-1,
                                        -1,-1, 0,-1,-1,
                                         1, 0, 0, 0, 0,
                                        -1, 0, 0,-1,-1,
                                        -1,-1, 1,-1,-1 ));

    k.push_back((cv::Mat_<char>(5,5) << -1,-1, 1,-1,-1,
                                        -1,-1, 0,-1,-1,
                                         1, 0, 0, 0, 0,
                                        -1, 0, 0,-1,-1,
                                        -1,-1, 0,-1,-1 ));

    k.push_back((cv::Mat_<char>(5,5) << -1,-1, 1,-1,-1,
                                        -1,-1, 0,-1,-1,
                                         0, 0, 0, 0, 1,
                                        -1,-1, 0, 0,-1,
                                        -1,-1, 0,-1,-1 ));

    cv::Mat dst = cv::Mat::zeros(bw.size(), CV_8U);

    for (int i = 0; i < k.size(); i++)
    {
        cv::Mat tmp;
        hitmiss(bw, tmp, k[i]);
        dst |= tmp;
    }

    std::vector<std::vector<cv::Point> > cnt;
    cv::findContours(dst.clone(), cnt, CV_RETR_EXTERNAL, CV_CHAIN_APPROX_SIMPLE);
    cv::drawContours(im, cnt, -1, CV_RGB(255,0,0), 10);

    cv::imshow("src", im);
    cv::imshow("bw", bw*255);
    cv::imshow("dst", dst*255);
    cv::waitKey();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T18:02:35.960

查看 OpenCV [squares.c demo](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/c/squares.c?rev=1429)或以下线程之一：

*   [使用opencv2.4（C）检测正方形](https://stackoverflow.com/q/11913313/176769)
*   [OpenCV C++/Obj-C：检测一张纸/正方形检测](https://stackoverflow.com/a/8863060/176769)(C++)
*   [OpenCV C++/Obj-C：高级正方形检测](https://stackoverflow.com/a/10535042/176769)(C++)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:03:38.557

您可以对获得的二值图像使用形态学运算。在matlab中你可以玩[`bwmorph`](http://www.mathworks.com/help/images/ref/bwmorph.html)

```
bw = I == 0; % look at dark lines in image I
[y x] = find( bwmorph( bw, 'branchpoints' ) ); 
```

会给你`x` `y`连接点的坐标。

# actionscript-3 - AS3：合并多个二维数组 - indexOf 不起作用

> ID：14755408
> 
> 赞同：0
> 
> 时间：2013-02-07T15:57:49.040
> 
> 标签：actionscript-3, multidimensional-array, merge, indexof

我想合并多个类型为 [唯一编号] [固定编号] 的 2dim 数组因为我想合并它们（并获得唯一结果），如果数组 [唯一编号] 是，我正在“retArr”中搜索当下。

```
Array1: retArr
Array2: arg  (multiple 2dim Arrays)

// before here is an additional "for each"-loop which gives me in every iteration a "new" arg-Array.
for (var p:uint = 0; p<arg.length; p++){
  if(retArr.length ==0){
    var tmp:Array = new Array();
    tmp.push(arg[p][0]);
    tmp.push(arg[p][1]);
    retArr.push(tmp);
  }
  else{
    for(var i:uint = 0; i<retArr.length; i++){
      if (retArr[i].indexOf(arg[p][0]) == -1){
         var tmp:Array = new Array();
         tmp.push(arg[p][0]);
         tmp.push(arg[p][1]);
         retArr.push(tmp);
         break;
      }
    }
   }
} 
```

我认为这条线

```
if (retArr[i].indexOf(arg[p][0]) == -1) 
```

是我的问题，因为我的 retArr 得到了双重结果。谁能帮帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:51:57.643

总结一下：您有一个数组数组，父数组中的每个数组都有两个元素。您想过滤掉所有在索引 0 处具有重复值的数组。这是正确的吗？

如果是这样，问题出在您的第二个 for 循环中。假设这是您在 arg 中的内容：

```
var arg:Array = [[0, 1], [2, 3], [2, 3]] 
```

在您的第一次迭代中， retArr 不包含任何内容，因此添加了 [0, 1] 并且第二个 for 循环不运行

在第二次迭代中，第二个 for 循环执行一次，因为 [2, 3] 的第一个元素没有出现在 [0, 1] 中

现在问题来了：在您的第三次迭代中，执行第二次 for 循环。它检查 [0, 1] 是否包含 2。它没有，因此将它添加到 retArr。它甚至从不检查 [2, 3] 是否包含 2。

您需要做的是循环遍历 retArr 的所有元素，如果根本没有匹配项，那么您可以安全地添加数组。

```
var matchFound:Boolean = false;
for(var i:uint = 0; i<retArr.length; i++){
  if (retArr[i].indexOf(arg[p][0]) != -1){
     matchFound = true;
     break;
  }
}
if( ! matchFound) {
  var tmp:Array = new Array();
  tmp.push(arg[p][0]);
  tmp.push(arg[p][1]);
  retArr.push(tmp);
} 
```

还有另一个问题：即使它的元素 0 与另一个数组的元素 1 匹配，您也要过滤掉一个数组。要仅过滤掉具有重复元素 0 的数组，请更改此

```
if (retArr[i].indexOf(arg[p][0]) != -1){ 
```

对此

```
if (retArr[i].indexOf(arg[p][0]) == 0){ 
```

如果您这样做，它可能会更快，更简单：

```
if(retArr[i][0] == arg[p][0]){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:21:16.893

看起来这应该可以通过使用 splice 或 concat
[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html#concat%28%29](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html#concat%28%29)

您可以将数组附加到`retArr`，而无需计算长度和迭代

# java - 如何在android中替换序列\/？

> ID：14755416
> 
> 赞同：0
> 
> 时间：2013-02-07T15:58:06.417
> 
> 标签：java, android

UI 中的问题是：

![在此处输入图像描述](../Images/38be9932c44f47aa4202d86f9b9b4b2c.png)

如何替换`\/`android中的序列？

我使用下面的替换方法，但它显示无效的转义序列。

```
tempLabelForListView[i].replaceAll("\/", "") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T15:59:26.003

您不需要使用[`String#replaceAll`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)方法，它需要一个`regex`as 参数。相反，只需使用[`String#replace`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)方法，您需要`\`使用另一个反斜杠来转义。并且您需要将替换的字符串重新分配给目标字符串，因为字符串是不可变的，并且替换不会影响当前字符串，而是返回一个新字符串：-

```
tempLabelForListView[i] = tempLabelForListView[i].replace("\\/", ""); 
```

至于[`String#replaceAll`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)方法，因为它需要一个正则表达式，你需要两次转义*反斜杠。*一次`Java`又一次`regex`。因此，您需要*4 个反斜杠*才能使用`replaceAll`：-

```
tempLabelForListView[i] = tempLabelForListView[i].replaceAll("\\\\/", ""); 
```

但是，您仍然不需要它。

# perl - Perl + Word：度数符号出现在 A-circumflex 之前

> ID：14755420
> 
> 赞同：0
> 
> 时间：2013-02-07T15:58:09.780
> 
> 标签：perl, ms-word, ole

我正在用 Perl 生成一个 Word 文档，我想在生成的文本中包含度数符号 (°)。如果我像这样生成代码：

`$cell .= qq/\xB0/;`

`$cell`这有效，并生成（对于的值`55`）：55°

然而，当我这样做时，perlcritic 向我抱怨并建议我改用这种结构：

`$cell .= qq/\N{DEGREE SIGN}/;`

这不起作用；它产生：55°

浏览我的代码`perl -d`，我看到运行以下代码：

```
my $cell = 55;
$cell .= qq/\N{DEGREE SIGN}/; # the PBP way
print sprintf("%x\n", ord($_)) for split //, $cell; 
```

```
my $cell = 55;
$cell .= qq/\xB0/; # the non-PBP way
print sprintf("%x\n", ord($_)) for split //, $cell; 
```

结果是：

```
35
35
b0 
```

我正在使用[Win32::OLE](http://search.cpan.org/~jdb/Win32-OLE-0.1709/lib/Win32/OLE.pm)将文本输出到 Word 文档：

```
my @column_headings = @{ shift $args->{'data'} };
my @rows            = @{ $args->{'data'} };

my $word   = Win32::OLE->new( 'Word.Application', 'Quit' );
my $doc    = $word->Documents->Add();
my $select = $word->Selection;

$csv->combine(@column_headings);
$select->InsertAfter( $csv->string );
$select->InsertParagraphAfter;
for my $row (@rows) {
    $csv->combine( @{$row} );
    $select->InsertAfter( $csv->string );
    $select->InsertParagraphAfter;
}
my $table = 
  $select->ConvertToTable( { 'Separator' => wdSeparateByCommas } );
$table->Rows->First->Range->Font->{'Bold'} = 1;
$table->Rows->First->Range->ParagraphFormat->{'Alignment'} =
  wdAlignParagraphCenter;
@{ $table->Rows->First->Borders(wdBorderBottom) }{qw/LineStyle LineWidth/}
  = ( wdLineStyleDouble, wdLineWidth100pt );
$doc->SaveAs( { 'Filename' => Cwd::getcwd . '/test.doc' } ); 
```

我能做些什么来摆脱多余的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:34:53.897

当然，您会遇到编码问题。度数符号是`U+00B0`，但这会序列化为 UTF-8 ，如果这个多字节字符被正确解码为 utf- 8 `C2 B0`，则呈现为-。`°`如果您将字节解码为单字节编码（例如 ... cp1252），则字节将被视为单独的，并会显示`Â °`.

现在很明显，解决方案是告诉 Perl 将 unicode 字符串转换为 cp1252 字符的字节字符串（太可怕了！）。你会发现`my $bytestring = Encode::encode("cp1252", $string)`这里的功能很有趣。

或者您告诉文档它将认为自己是 UTF-8。我不知道你会怎么做，但必须在*某个地方**有*一个选项。这实际上更可取，因为有数千个字符（与°不同）不适合 cp1252。像摄氏度 ℃ (U+2103) 或华氏度 ℉ (U+2109) 字符;-)

# dart - Dart - 编码和解码 base64 字符串

> ID：14755421
> 
> 赞同：13
> 
> 时间：2013-02-07T15:58:16.580
> 
> 标签：dart

如何原生转换*字符串*-> *base64*和*base64* ->*字符串*

我只找到[base64string的这个字节](http://www.dartlang.org/docs/dart-up-and-running/contents/ch03.html#ch03-crypto-base64)

想要这样：

```
String Base64String.encode();
String Base64String.decode(); 
```

还是从另一种语言移植更容易？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-04-10T12:35:07.207

从 0.9.2`crypto`开始

> `CryptoUtils`已弃用。请改用包中的`Base64`API`dart:convert`和十六进制 API `convert`。

```
import 'dart:convert' show utf8, base64;

main() {
  final str = 'https://dartpad.dartlang.org/';

  final encoded = base64.encode(UTF8.encode(str));
  print('base64: $encoded');

  final str2 = utf8.decode(base64.decode(encoded));
  print(str2);
  print(str == str2);
} 
```

在[DartPad中尝试](https://dartpad.dartlang.org/460627beb8fe2c4e00b05e24e0cd22ed)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-07T16:31:25.813

您可以使用转换库中的[BASE64 编解码器](https://api.dartlang.org/stable/1.24.3/dart-convert/BASE64-constant.html)（`base64`在 Dart 2 中重命名）和[LATIN1 编解码器](https://api.dartlang.org/stable/1.24.3/dart-convert/LATIN1-constant.html)（在 Dart 2 中重命名`latin1`）。

```
var stringToEncode = 'Dart is awesome';

// encoding

var bytesInLatin1 = LATIN1.encode(stringToEncode);
// [68, 97, 114, 116, 32, 105, 115, 32, 97, 119, 101, 115, 111, 109, 101]

var base64encoded = BASE64.encode(bytesInLatin1);
// RGFydCBpcyBhd2Vzb21l

// decoding

var bytesInLatin1_decoded = BASE64.decode(base64encoded);
// [68, 97, 114, 116, 32, 105, 115, 32, 97, 119, 101, 115, 111, 109, 101]

var initialValue = LATIN1.decode(bytesInLatin1_decoded);
// Dart is awesome 
```

如果您总是使用`LATIN1`生成编码字符串，则可以通过创建编解码器直接将字符串转换为编码字符串/从编码字符串转换来避免 2 个转换调用。

```
var codec = LATIN1.fuse(BASE64);

print(codec.encode('Dart is awesome'));
// RGFydCBpcyBhd2Vzb21l

print(codec.decode('RGFydCBpcyBhd2Vzb21l'));
// Dart is awesome 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-01-12T21:27:49.633

我会评论 Günter 2016 年 4 月 10 日的帖子，但我没有名气。正如他所说，你现在应该使用`dart:convert`图书馆。您必须结合几个编解码器才能从 base64 字符串中获取 utf8 字符串，反之亦然。[这篇文章](https://www.dartlang.org/articles/libraries/converters-and-codecs)说[融合你的编解码器](https://api.dartlang.org/stable/1.21.0/dart-convert/Codec/fuse.html)更快。

```
import 'dart:convert';

void main() {
  var base64 = 'QXdlc29tZSE=';
  var utf8 = 'Awesome!';

  // Combining the codecs
  print(utf8 == UTF8.decode(BASE64.decode(base64)));
  print(base64 == BASE64.encode(UTF8.encode(utf8)));
  // Output:
  // true
  // true

  // Fusing is faster, and you don't have to worry about reversing your codecs
  print(utf8 == UTF8.fuse(BASE64).decode(base64));
  print(base64 == UTF8.fuse(BASE64).encode(utf8));
  // Output:
  // true
  // true
} 
```

[https://dartpad.dartlang.org/5c0e1cfb6d1d640cdc902fe57a2a687d](https://dartpad.dartlang.org/5c0e1cfb6d1d640cdc902fe57a2a687d)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-01-01T19:49:37.793

以下是 dart 中编码/解码的示例：

主要飞镖：

```
import 'dart:convert';

main() {
  // encode
  var str = "Hello world";
  var bytes = utf8.encode(str);
  var base64Str = base64.encode(bytes);
  print(base64Str);

  // decode
  var decoded_bytes = base64.decode(base64Str);
  var decoded_str = utf8.decode(decoded_bytes);
  print(decoded_str);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-08T09:26:52.860

我拿了一个 dart.io -> base64.dart 类，稍微修改了一下，就可以了

如何使用：

```
var somestring = 'Hello dart!';

var base64string = Base64String.encode( somestring );
var mystring = Base64String.decode( base64string ); 
```

[Pastbin.com 上的来源](http://pastebin.com/0FBhjnnG)

[来源 gist.github.com](https://gist.github.com/ahiipsa/4754533)

# java - 没有文件所有者的 S3 HDFS - AccessControlException

> ID：14755424
> 
> 赞同：1
> 
> 时间：2013-02-07T15:58:23.750
> 
> 标签：java, hadoop, amazon-s3, mapreduce, hdfs

我目前正在为 HDFS 和 MapReduce 运行一个小型 Hadoop 集群，并且我正在尝试按照此处的页面将 S3 换成本地 HDFS：

[用于 HDFS 的 AmazonS3](http://wiki.apache.org/hadoop/AmazonS3)

我遇到的问题是，在启动 JobTracker 时，如果元数据（jobtracker.info）已经存在，当 Hadoop 尝试访问/覆盖此文件时，它无法打开它，因为该文件的所有者与MapRed 所有者。在 hadoop-core-1.0.3 ( [JobTracker.java](http://javasourcecode.org/html/open-source/hadoop/hadoop-1.0.3/org/apache/hadoop/mapred/JobTracker.java.html) ) 中，比较：

```
FileStatus systemDirStatus = fs.getFileStatus(systemDir);
if (!systemDirStatus.getOwner().equals( getMROwner().getShortUserName())) {
    throw new AccessControlException("The systemdir " + systemDir +
      " is not owned by " + getMROwner().getShortUserName());
} 
```

Where`systemDirStatus.getOwner()`返回一个空字符串（s3 文件所有者）并`getMROwner().getShortUserName()`返回“ *mapred*`HADOOP_USER_NAME` ”，尽管通过在 JobTracker 节点上设置环境变量，可以轻松地将这个值更改为空字符串以外的任何值。

这个问题是 S3 不维护“文件所有者”的牺牲品，Hadoop 的 NativeS3Filesystem 和 Jets3t 没有做任何补偿这一事实。

有没有办法在不修补 Hadoop 的情况下解决这个问题？我认为必须有某种方法可以实现这一点，因为 EMR 是 S3 支持的。请注意，我们还不想迁移到 EMR，而是希望继续在我们自己的 EC2 集群上运行 MapReduce，同时将 S3 用于 HDFS。

先感谢您！

拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:41:11.357

因此，经过进一步研究，我偶然发现了解决问题的方法：

上述问题（其中 S3 不维护文件权限/所有者）在尝试将 S3 支持的 Hadoop JobTrakcers 用作 HDFS 时表现在两个不同的地方：

1.  在 JobTrakcer 重新启动期间，当 jobtracker.conf 文件已存在时。
2.  当 JobTrakcer 尝试从 HDFS 中的暂存目录获取信息时转换到作业的第二个任务。

这些问题中的前者从未在 Elastic MapReduce 中出现，因为“JobTracker”只启动一次，并在作业完成后被销毁。然而，第二个可能会成为`org.apache.hadoop.mapreduce.JobSubmissionFiles`类检查的受害者，具体取决于您使用的 Hadoop 版本。

在大多数 CDH3 发行版中（我只检查了 cdh3u3、cdh3u4 和 cdh3u5），文件所有者和权限在两个单独的语句中检查以添加更详细的日志记录（来自 cdh3u5 - [JobSubmissionFiles.java](http://grepcode.com/file/repository.cloudera.com/content/repositories/releases/org.apache.hadoop/hadoop-core/0.20.2-cdh3u5/org/apache/hadoop/mapreduce/JobSubmissionFiles.java?av=f)的片段）：

```
FileStatus fsStatus = fs.getFileStatus(stagingArea);
  String owner = fsStatus.getOwner();
  if (!(owner.equals(currentUser) || owner.equals(realUser))) {
     throw new IOException("The ownership on the staging directory " +
                  stagingArea + " is not as expected. " + 
                  "It is owned by " + owner + ". The directory must " +
                  "be owned by the submitter " + currentUser + " or " +
                  "by " + realUser);
  }
  if (!fsStatus.getPermission().equals(JOB_DIR_PERMISSION)) {
    LOG.info("Permissions on staging directory " + stagingArea + " are " +
      "incorrect: " + fsStatus.getPermission() + ". Fixing permissions " +
      "to correct value " + JOB_DIR_PERMISSION);
    fs.setPermission(stagingArea, JOB_DIR_PERMISSION);
  } 
```

请注意，如果`String owner`有一个 null 或空字符串值，它将永远不会匹配`currentUser`or `realUser`，它们是从运行作业的机器中提取的。

在较旧和较新的 hadoop 版本中，包括 Apache 0.20.2、1.0.x 和 2.0.x 以及 CDH4，此检查被合并到一个语句中，允许空所有者转入默认权限" (来自 Apache Hadoop 1.0.3 - [JobSubmissionFiles.java](http://javasourcecode.org/html/open-source/hadoop/hadoop-1.0.3/org/apache/hadoop/mapreduce/JobSubmissionFiles.java.html)的片段）：

```
FileStatus fsStatus = fs.getFileStatus(stagingArea);
  String owner = fsStatus.getOwner();
  if (!(owner.equals(currentUser) || owner.equals(realUser)) || 
      !fsStatus.getPermission().equals(JOB_DIR_PERMISSION)) {
     throw new IOException("The ownership/permissions on the staging " +
                  "directory " + stagingArea + " is not as expected. " + 
                  "It is owned by " + owner + " and permissions are "+ 
                  fsStatus.getPermission() + ". The directory must " +
                  "be owned by the submitter " + currentUser + " or " +
                  "by " + realUser + " and permissions must be rwx------");
  } 
```

长话短说，切换到具有折叠比较而不是扩展比较的 Hadoop 版本解决了我的 S3 问题。

# r - R中字符串到日期转换的“标准明确日期”格式是什么？

> ID：14755425
> 
> 赞同：107
> 
> 时间：2013-02-07T15:58:26.723
> 
> 标签：r, date, date-formatting, strptime, as.date

请考虑以下

```
$ R --vanilla

> as.Date("01 Jan 2000")
Error in charToDate(x) :
    character string is not in a standard unambiguous format 
```

但是那个日期显然*是*标准的明确格式。为什么会出现错误信息？

更糟糕的是，一个模棱两可的日期显然被接受而没有警告或错误，然后读取不正确！

```
> as.Date("01/01/2000")
[1] "0001-01-20" 
```

我在包含此错误消息的 [R] 标记中搜索并发现了 28 个其他问题。所有解决方案和解决方法都涉及指定格式 iiuc。这个问题的不同之处在于我问的是标准的明确格式在哪里定义，它们可以改变吗？每个人都收到这些消息还是只有我一个人？也许它与语言环境有关？

换句话说，有没有比需要指定格式更好的解决方案？

[包含“[R] 标准明确格式”的 29 个问题](https://stackoverflow.com/search?q=%5Br%5D%20standard%20unambiguous%20format)

```
> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United Kingdom.1252
[2] LC_CTYPE=English_United Kingdom.1252
[3] LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United Kingdom.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-02-07T16:10:55.000

这是记录在案的行为。来自`?as.Date`：

> 格式：一个字符串。如果未指定，它将在第一个非 'NA' 元素上尝试 '"%Y-%m-%d"' 然后 '"%Y/%m/%d"'，如果两者都不起作用，则会给出错误。

`as.Date("01 Jan 2000")`产生错误，因为格式不是上面列出的两种格式之一。 `as.Date("01/01/2000")`产生一个不正确的答案，因为日期不是上面列出的两种格式之一。

我将“标准明确”表示为“ISO-8601”（尽管`as.Date`不是那么严格，因为“%m/%d/%Y”不是 ISO-8601）。

如果您收到此错误，解决方案是指定您的日期（或日期时间）的格式，**使用**`?strptime`.

确保转换规范的*顺序*以及任何*分隔符与**输入*字符串的格式完全对应。此外，如果您的数据包含日/月名称和/或缩写，请务必特别小心，因为转换将取决于您的语言环境（请参阅`?strptime`和阅读中的示例`?LC_TIME`；另请参阅[`strptime`，`as.POSIXct`并`as.Date`返回意外`NA`](https://stackoverflow.com/questions/13726894/strptime-as-posixct-and-as-date-return-unexpected-na)）。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2016-11-20T21:32:25.790

> 换句话说，有没有比需要指定格式更好的解决方案？

是的，现在有（即 2016 年末），这要归功于[随时](https://cran.r-project.org/package=anytime)包`anytime::anydate`。

有关上面的一些示例，请参见以下内容：

```
R> anydate(c("01 Jan 2000", "01/01/2000", "2015/10/10"))
[1] "2000-01-01" "2000-01-01" "2015-10-10"
R> 
```

正如你所说，这些实际上是*明确*的，应该可以工作。并且通过`anydate()`他们这样做。没有格式。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2013-02-07T16:19:41.410

作为@JoshuaUlrich 回答的补充，这里是函数的定义`as.Date.character`：

```
as.Date.character
function (x, format = "", ...) 
{
    charToDate <- function(x) {
        xx <- x[1L]
        if (is.na(xx)) {
            j <- 1L
            while (is.na(xx) && (j <- j + 1L) <= length(x)) xx <- x[j]
            if (is.na(xx)) 
                f <- "%Y-%m-%d"
        }
        if (is.na(xx) || !is.na(strptime(xx, f <- "%Y-%m-%d", 
            tz = "GMT")) || !is.na(strptime(xx, f <- "%Y/%m/%d", 
            tz = "GMT"))) 
            return(strptime(x, f))
        stop("character string is not in a standard unambiguous format")
    }
    res <- if (missing(format)) 
        charToDate(x)
    else strptime(x, format, tz = "GMT")
    as.Date(res)
}
<bytecode: 0x265b0ec>
<environment: namespace:base> 
```

所以基本上如果两者都`strptime(x, format="%Y-%m-%d")`抛出`strptime(x, format="%Y/%m/%d")`一个`NA`它被认为是模棱两可的，如果不是明确的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-12-19T20:42:44.453

在不指定当前格式的情况下转换日期很容易给您带来此错误。

## 这是一个例子：

```
sdate <- "2015.10.10" 
```

## 在不指定格式的情况下进行转换：

```
date <- as.Date(sdate4) # ==> This will generate the same error"""Error in charToDate(x): character string is not in a standard unambiguous format""". 
```

## 以指定格式转换：

```
date <- as.Date(sdate4, format = "%Y.%m.%d") # ==> Error Free Date Conversion. 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-06-07T00:56:18.073

这对我来说非常有效，无论日期之前是如何编码的。

```
library(lubridate)
data$created_date1 <- mdy_hm(data$created_at)
data$created_date1 <- as.Date(data$created_date1) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-08-04T21:13:57.217

作为补充：如果您尝试转换的条目是应该是 NA 的字符串，也会引发此错误。如果您指定预期格式 - 或使用“真实” NA - 没有问题：

data.table 的最小可重现示例：

```
library(data.table)
df <- data.table(date_good = c("01-01-2001", "01-01-2001"), date_bad= ("NA", "01-01-2001"))

df[, .(date_good = as.Date(date_good), date_bad = as.Date(date_bad))]
# Error in charToDate(x) : character string is not in a standard unambiguous format

df[, .(date_good = as.Date(date_good), date_bad = as.Date(date_bad, format="%Y-%m-%d"))]
# No errors; you simply get NA.

df2 <- data.table(date_good = c("01-01-2001", "01-01-2001"), date_bad= (NA, "01-01-2001"))

df2[, .(date_good = as.Date(date_good), date_bad = as.Date(date_bad))]
# Just NA 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-12T20:55:39.413

如果日期是例如：“2000 年 1 月 1 日”，我建议使用

```
library(lubridate)
date_corrected<-dmy("01 Jan 2000")
date_corrected
[1] "2000-01-01"
class(date_corrected)
[1] "Date" 
```

lubridate 对几乎所有类型的日期都有一个功能。

# c - Strtok - 在行尾读取空字符串

> ID：14755437
> 
> 赞同：1
> 
> 时间：2013-02-07T15:59:13.010
> 
> 标签：c, strtok

在下面的代码中，我使用 strtok 从文件中解析一行代码，如下所示：

```
1023.89,863.19  1001.05,861.94  996.44,945.67   1019.28,946.92  1023.89,863.19 
```

由于文件可以有不同长度的行，我不使用 fscanf。下面的代码除了一个小故障外有效。它循环了太多次并读入一个长的空字符串“”，然后再次循环识别空标记“”并退出while循环。我不知道为什么会这样。

任何帮助将不胜感激。

```
fgets(line, sizeof(line), some_file);    
while ((line != OPC_NIL) {
    token = strtok(line, "\t"); //Pull the string apart into tokens using the commas
    input = op_prg_list_create();
    while (token != NULL) {
        test_token = strdup(token);
        if (op_prg_list_size(input) == 0)       
            op_prg_list_insert(input,test_token,OPC_LISTPOS_HEAD);  
        else
            op_prg_list_insert(input,test_token,OPC_LISTPOS_TAIL);
        token = strtok (NULL, "\t");
    }
    fgets(line, sizeof(line), some_file);                
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:25:06.877

您必须使用正确的分隔符列表。您的代码与评论相矛盾：

```
token = strtok(line, "\t"); //Pull the string apart into tokens using the commas 
```

如果您想用逗号分隔标记，请使用`","`而不是`"\t"`. 此外，您当然不希望标记包含换行符`\n`（出现在从 file by 读取的每一行的末尾`fgets`）。因此，将换行符添加到分隔符列表中：

```
token = strtok(line, ",\n"); //Pull the string apart into tokens using the commas
...
token = strtok (NULL, ",\n"); 
```

您可能还想将空格字符添加到分隔符列表中（是`863.19 1001.05`单个标记还是两个标记？您要删除行尾的空格吗？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:47:09.050

您的使用`sizeof(line)`告诉我这`line`是一个存在于堆栈上的固定大小的数组。在这种情况下，`(line != OPC_NIL)`永远不会`false`。但是，当到达文件末尾或发生其他错误时`fgets()`将返回。`NULL`您的外部 while 循环应重写为：

```
while(fgets(line, sizeof(line), some_file)) {
...
} 
```

您的输入文件可能在最后一个输入行的末尾也有一个换行符，导致末尾有一个空行。这是这之间的区别：

```
1023.89,863.19 1001.05,861.94 996.44,945.67 1019.28,946.92 1023.89,863.19↵
<blank line> 
```

和这个：

```
1023.89,863.19 1001.05,861.94 996.44,945.67 1019.28,946.92 1023.89,863.19 
```

在 while 循环中你应该做的第一件事是检查字符串是否真的是你期望的格式。如果不是，则中断：

```
while(fgets(line, sizeof(line), some_file)) {
    if(strlen(line) == 0) // or other checks such as "contains tab characters"
        break;
    ...
} 
```

# html - 设置像素 div 后填充 div 的其余部分

> ID：14755443
> 
> 赞同：0
> 
> 时间：2013-02-07T15:59:33.990
> 
> 标签：html, css

我有一个不同宽度的 div。里面还有另外两个，一个是固定宽度，另一个应该填满该区域的其余部分。但我不能让它总是填满。根据外盒的宽度，它要么太小，要么太大并低于 inner-box-1。如何让 inner-box-2 填充外盒的其余部分？

[http://jsfiddle.net/Y57YP/](http://jsfiddle.net/Y57YP/)

**HTML**

```
<div id ="outer-box">
   <div id="inner-box-1"></div>
   <div id="inner-box-2"></div>
</div> 
```

**CSS**

```
#outer-box{
  width:50%;
  background:#fcc;
  position: relative;
  overflow: auto;
}
#inner-box-1{
  height:50px;
  width:50px;
  background:#ccc;
  float:left;
}
#inner-box-2{
  height:50px;
  width:80%;
  background:#555;
  float:left;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:11:50.480

这是那些简单但完全不直观的奇怪答案之一。您需要结合使用overflow 属性和float 属性来触发[块格式化上下文。](https://developer.mozilla.org/en-US/docs/CSS/Block_formatting_context)

请参阅此**[jsFiddle 示例](http://jsfiddle.net/j08691/Y57YP/2/)**。

```
#inner-box-2{
   height:50px;
   background:#555;
   overflow:auto;
} 
```

我所做的就是从您的`#inner-box-2`div 中删除宽度和浮动并添加一个`overflow:auto`

# ms-access - Access 2007 - Left Join 返回正确的结果，Inner Join 不返回任何结果

> ID：14755447
> 
> 赞同：1
> 
> 时间：2013-02-07T16:00:08.793
> 
> 标签：ms-access, left-join, inner-join, resultset, missing-data

我有一个查询，我可以让它工作的唯一方法是在三个字段上左加入。如果我对这三个字段进行普通的内部联接，则查询不会返回任何内容。但是，如果我尝试单独加入每个人，他们都会按照我的预期加入，例如 Bob 到 Bob、Bookshop 到 Bookshop、Bread 到 Bread 等。

那么对于这两组查询结果...

```
1.Manager  1.Shop     1.Product  1.Cost     2.Manager  2.Shop     2.Product   2.Quantity
Bob        Hardware   Spanners    15        Bob        Hardware   Spanners     3
Terry      Food       Bread       12        Terry      Food       Bread        4
Sue        Bookshop   Books       18        Sue        Bookshop   Books        7 
```

...此查询不返回任何结果：

```
SELECT 1.Manager, 1.Shop, 1.Product, 1.Cost, 2.Quantity
FROM 1 INNER JOIN 2 ON 1.Manager = 2.Manager AND 1.Shop = 2.Shop AND 1.Product = 2.Product; 
```

我知道加入文本并不理想，但我有类似的查询可以毫无问题地加入这三个字段，所以想知道这是否是我遇到的 Access 的“功能”，或者它是否可能是数据？

-编辑-

通过将 JOIN 条件改为 WHERE 子句，我发现，如果我有 WHERE 1.Manager = "Bob" AND 2.Manager = "Bob:

```
WHERE 1.Product = "Spanners" 
```

独立工作，并且：

```
WHERE 2.Product = "Spanners" 
```

单独工作，但将两者结合起来：

```
WHERE 1.Product = "Spanners" AND 2.Product = "Spanners" 
```

再次返回什么！

-编辑2-

主查询在引用表中的数据时确实表现正常。因此，基本查询返回结果的方式可能有些奇怪。

-编辑 3-

这是问题示例的链接：[链接已删除]

01 顶级查询：这两个是一样的，但一个是指表，并且是有效的；而另一个是指查询，并且不起作用。我想找出为什么查询版本不起作用。

02 2nd Level Queries and Tables：每组数据有两个版本 - 一个是查询，另一个是使用查询的 Make Table 版本制作的表。据我所知，两者都是相同的。

03 和 04 级查询：这些是构成第二级查询的较低级别查询

表：这些是构建所有其他查询的基础表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:35:17.800

好的，所以我下载了您的数据库并查看了。我发现如果你把 NumStores 查询放在你的内部连接中，那么它会返回记录，然后就放弃了。我不想听起来很苛刻，但是您在糟糕的数据库设计的道路上已经走得太远了，您没有希望走得更远。将继续给您带来问题的许多问题包括： 表中没有主键（没有任何类型的索引）。对象（查询和表）的难以理解的命名约定。数据在许多不同的表中重复（规范化违规）。主查询中的嵌入子查询。如果您想使用 Access 来帮助您，您需要学习如何使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T09:54:53.150

作为记录，如果有人看到这个问题有类似的问题 - 输入主查询的查询之一是在一个字段上分组，该字段没有出现在该特定查询的任何地方。一旦我从 Group By 子句中删除了该字段，主查询就会返回我预期的结果。

奇怪的是，查询本质上返回了完全相同的结果，但行为不同，但你去了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-23T15:22:16.717

未来（2017 年，Access 2010）在这里也遇到了同样的问题。出于某种原因，Left Join 会产生与 Inner Join 完全相同的结果，但它却神秘地停止了。在**“2013 年 2 月 11 日 9:54”**消息之后，我注意到其中一个加入的查询使未显示的 Group By 字段增加了一倍（没有理由），所以我删除了它们。有效。Access 重新创建了未显示的 Group By 字段，但不再加倍，这就是（错误？）问题。

# jena - 如何使用 Fuseki 通过本体模式持久存储数据

> ID：14755450
> 
> 赞同：2
> 
> 时间：2013-02-07T16:00:19.443
> 
> 标签：jena, ontology, fuseki

嗨，我是本体存储的新手 :)

实际上，我正在寻找具有 Java 互操作性（耶拿）的三元存储。所以我选择了 Apache Fuseki。在文档中，我找到了用于加载本体的 ja:MemoryModel。但这是否意味着当我关闭服务器时数据会丢失？

另一个想法是使用某种本体模式。这意味着我想使用 1 个本体作为架构，使用第二个本体来存储实体。在示例 configuration.ttl 中，我发现了类似的内容：

```
ja:baseModel 
[ a ja:MemoryModel ;
  ja:content [ja:externalContent <file:Data/test_abox.ttl>] ;
  ja:content [ja:externalContent <file:Data/test_tbox.ttl>] ;
] ; 
```

但是我找不到对 baseModel 的真正解释，并且在文档中也提到了 OntModel。哪个用于架构，哪个用于实体。对我这个新人来说，这有点令人困惑？有人可以给我一个提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T10:47:11.823

您可以使用持久数据库运行服务器。使用 --loc=DB 启动服务器，它将使用 Jena TDB 的副本作为数据存储。

或者，您可以使用汇编器并在 TDB 支持的数据存储和其中的模型中进行配置。

# html - 阶梯 div 格式

> ID：14755451
> 
> 赞同：0
> 
> 时间：2013-02-07T16:00:24.413
> 
> 标签：html, css, xhtml

我有一个客户希望他们的主页上的特定设计与他们杂志封面上的内容相匹配。封面的基本阶梯设计从未改变，但图像偶尔会改变。在不使用 1 个大图像的情况下，我无法设计出一种覆盖这种格式的方法。

这是一个小提琴：http: [//jsfiddle.net/z6ghY/](http://jsfiddle.net/z6ghY/)

注意：这个小提琴中的外观在客户希望它被看到时是正确的。我的问题是它使用了一个必须偶尔更改的大图像。如果将这三个图像分开会容易得多。

任何人都知道我可以实现这一目标的最佳方法吗？图像可以通过 HTML 或 CSS 放置，无论哪种方式都无关紧要，尽管在 HTML 中看到它们以获得 SEO 好处会很高兴。

如果小提琴没有在这里显示图像，它是.. [http://i.imgur.com/6s2i9L7.png](http://i.imgur.com/6s2i9L7.png)

HTML：

```
<h2>Innovative Engineering Solutions in Material Handling</h2>

<div class="home-container">
<div class="home-content"><p>Experience the impact that Lauyans &amp; Company can make on your business success.  Through innovative engineering solutions in material handling, Lauyans will take responsibility for the planning, execution and acceptance of your project.</p>

<!--h2>Lauyans... why choose anyone else?</h2-->

<h2 style="margin: 80px 0 0 30px;">Lauyans...<br />  why choose<br />  anyone else?</h2>

</div><!-- END HOME CONTENT -->

</div><!-- END HOME CONTAINER -->

<div class="home-container2">
<div class="home-planning">
<h3>Planning</h3>
</div>
<div class="home-execution">
<h3>Execution</h3>
</div>
<div class="home-acceptance">
<h3>Acceptance</h3>
</div>
</div> 
```

CSS：

```
.home-container { width: 690px; height: 459px; background: url('/wp-content/uploads/2013/01/home-image.png') 50% 100% no-repeat; }
.home-container2 { width: 690px; }
.home-content { width: 430px; height: 429px; padding: 15px; }
.home-content p { padding: 0; margin: 0; }
.home-content h2 { padding-top: 10px; margin: 0; }
.home-container2 h3 { padding-top: 0px; margin: 0; text-align: center; }
.home-planning { width: 230px; float: left; }
.home-execution { width: 230px; float: left; }
.home-acceptance { width: 230px; float: left; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:10:06.667

考虑到您要使用的“独特”布局，我会采用绝对定位路线：

[http://jsfiddle.net/z6ghY/1/](http://jsfiddle.net/z6ghY/1/)

我重新处理了所有内容（包括我必须从其他地方抓取的图像）：

HTML

```
<div class="home_con">

    <h2 class="pge_title">Innovative Kitten Solutions</h2>

    <div class="home_step">
        <h2 class="step-title">Lauyans...<br />  why choose<br />  anyone else?</h2>

        <p>
            Experience the impact that Kittens can make on your business success through
            purring.
        </p>   

        <img class="img1" src="http://www.vivapets.com/img/album/52/19052_white_persian_kittens_for_adoption_thb.jpg" />

        <img class="img2" src="http://www.saudivets.com/images/Vpic20.jpg" />   

        <img class="img3" src="http://fc04.deviantart.net/fs70/f/2011/167/2/8/kitten_tracks_banner_100x300_by_xxjessie_kittehxx-d3j2h51.png" />

    </div>

    <div class="img_text">
        <div class="img_text_ele">Planning</div>
        <div class="img_text_ele">Execution</div>
        <div class="img_text_ele">Acceptance</div>
    </div> 

</div> 
```

CSS

```
.home_con h2.pge_title { font-weight:bold; font-size:1.125em; }

.home_step { width:300px; height:300px; position:relative; }
.home_step h2.step-title { position:absolute; top:110px; left:10px; }
.home_step p { width:200px; position:absolute; top:10px; left:10px; }
.home_step img { position:absolute; bottom:0px; }
.home_step .img1 { left;0px; }
.home_step .img2 { left:100px; }
.home_step .img3 { left:200px; }

.home_con .img_text { width:300px; overflow:hidden; }
.home_con .img_text_ele { width:100px; float:left; text-align:center; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:23:24.067

这种方式需要将图像切碎一点，但如果这样做很酷，它会起作用：

[http://jsfiddle.net/5qfLj/1/](http://jsfiddle.net/5qfLj/1/)

HTML：

```
<div class="container">
    <div class="row">
        <div class="span2">1</div>
        <div class="span1" style="background:#ccc;">2</div>
    </div>
    <div class="row">
        <div class="span1">3</div>
        <div class="span1"  style="background:#666;">4</div>
        <div class="span1"  style="background:#ccc;"></div>
    </div>
    <div class="row">
        <div class="span1" style="background:#999;">5</div>
        <div class="span1" style="background:#666;">6</div>
        <div class="span1" style="background:#ccc;">7</div>
    </div>
</div> 
```

CSS：

```
.container {
    width:600px;
}

.row {
    overflow: hidden;
}

.span1 {
    float:left;
    width:200px;
    height:200px;
}

.span2 {
    width:400px;
    height:200px;
    float:left;
} 
```

# typo3 - TYPO3 6.0.1 中的 TYPO3 内容元素

> ID：14755454
> 
> 赞同：0
> 
> 时间：2013-02-07T16:00:36.280
> 
> 标签：typo3, typoscript

我在 Typoscript 中使用内容元素。从文件夹中获取图像。我在较旧的 TYPO3 版本中为此疯狂了 1000 次。

这是小米代码

```
 lib.test = CONTENT
  lib.test{
    table = tt_content
    select{
      uidInList=4
      pidInList=2
    }
  } 
```

文件夹 ID 正确。

我在 div(inner) 中使用 Templavoila 映射测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:04:32.970

我们遇到了同样的问题并移植回 Typo3 4.7.x。TemplaVoila 和许多其他扩展在 6.x 中仍然存在问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-08T14:06:51.820

试试下面的一个；

```
lib.logo = RECORDS 
lib.logo{
          tables = tt_content
          source = 123 #Respected Content Element ID
} 
```

# android - 执行代码时出现 IOMainThreadException

> ID：14755455
> 
> 赞同：0
> 
> 时间：2013-02-07T16:00:38.500
> 
> 标签：android

当我执行以下代码时，它会引发错误：

> IOMainThreadException

任何人都可以找出错误发生的位置吗？

```
import java.io.BufferedReader;

import java.io.ByteArrayInputStream;

import java.io.IOException;

import java.io.InputStream;

import java.io.InputStreamReader;

import java.io.Reader;

import javax.xml.parsers.DocumentBuilder;

import javax.xml.parsers.DocumentBuilderFactory;

import javax.xml.parsers.ParserConfigurationException;

import org.apache.http.HttpEntity;

import org.apache.http.client.ClientProtocolException;

import org.apache.http.client.HttpClient;

import org.apache.http.client.methods.HttpGet;

import org.apache.http.impl.client.DefaultHttpClient;

import org.w3c.dom.Document;

import org.w3c.dom.Node;

import org.xml.sax.SAXException;

import android.app.Activity;

import android.os.Bundle;

import android.widget.ImageView;

import android.widget.TextView;

import android.widget.Toast;

public class AndroidYahooWeatherDOMActivity extends Activity {

    TextView weather;
    TextView txtcity;
    TextView txtregion;
    TextView txtcountry;
    TextView txttemp;
    TextView txtpressure;
    TextView txthumidity;
    TextView txtspeed;
    TextView txtsunrise;
    TextView txtsunset;
    TextView txtcondition;

    TextView day1;
    TextView date1;
    TextView low1;
    TextView high1;
    TextView text1;
    TextView day2;
    TextView date2;
    TextView low2;
    TextView high2;
    TextView text2;

    ImageView img;
    ImageView nxtday1;
    ImageView nxtday2;

    class MyWeather {
        WeatherImageHandler im = new WeatherImageHandler(getApplicationContext());
        WeatherImageHandler im1 = new WeatherImageHandler(getApplicationContext());
        WeatherImageHandler im2 = new WeatherImageHandler(getApplicationContext());
        String description;
        String city;
        String region;
        String country;

        String windChill;
        String windDirection;
        String windSpeed;

        String sunrise;
        String sunset;

        String conditiontext;
        String conditiondate;

        String temp;
        String pressure;
        String humidity;
        String visibility;
        String code;

        String rising;

        String day;
        String date;
        String low;
        String high;
        String text;
        String code0;

        String day1;
        String date1;
        String low1;
        String high1;
        String text1;
        String code1;

        String day2;
        String date2;
        String low2;
        String high2;
        String text2;
        String code2;

        public String toString() {

            return "\n- " + description + " -\n\n" + "city: " + city + "\n"
                    + "region: " + region + "\n" + "country: " + country
                    + "\n\n"

                    + "Wind\n" + "chill: " + windChill + "\n" + "direction: "
                    + windDirection + "\n" + "speed: " + windSpeed + "\n\n"

                    + "Sunrise: " + sunrise + "\n" + "Sunset: " + sunset
                    + "\n\n"

                    + "Condition: " + conditiontext + "\n" + conditiondate
                    + "\n\n" + "temp:" + temp + "\n" + "pressure:" + pressure
                    + "\n" + "humidity" + humidity + "\n" + "rising" + rising
                    + "\n" + "visibility" + visibility + "\n"+"code  :" +code+"\n\n"

                    + "day  :" + day
                    + "\n" + "date  :" + date + "\n" + "low  :" + low + "\n" + "high  :"
                    + high+ "\n" + "text  :" + text+"\n"+"code"+code0+"\n\n"

                    + "day  :" + day1
                    + "\n" + "date  :" + date1 + "\n" + "low  :" + low1 + "\n" + "high  :"
                    + high1+ "\n" + "text  :" + text1+"code"+code1+"\n\n"

                    + "day  :" + day2
                    + "\n" + "date  :" + date2 + "\n" + "low  :" + low2 + "\n" + "high  :"
                    + high2+ "\n" + "text  :" + text2+"code"+code2;

        }
    }

        @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        txtcity = (TextView) findViewById(R.id.city);
        txtregion = (TextView) findViewById(R.id.region);
        txtcountry = (TextView) findViewById(R.id.country);
        txttemp = (TextView) findViewById(R.id.temp);
        txtpressure = (TextView) findViewById(R.id.pressure);
        txthumidity = (TextView) findViewById(R.id.humidity);
        txtspeed = (TextView) findViewById(R.id.speed);
        txtsunrise = (TextView) findViewById(R.id.sunrise);
        txtsunset = (TextView) findViewById(R.id.sunset);
        txtcondition = (TextView) findViewById(R.id.condition);

        day1 = (TextView) findViewById(R.id.day1);
        date1 = (TextView) findViewById(R.id.date1);
        low1 = (TextView) findViewById(R.id.low1);
        high1 = (TextView) findViewById(R.id.high1);
        text1 = (TextView) findViewById(R.id.text1);

        day2 = (TextView) findViewById(R.id.day2);
        date2 = (TextView) findViewById(R.id.date2);
        low2 = (TextView) findViewById(R.id.low2);
        high2 = (TextView) findViewById(R.id.high2);
        text2 = (TextView) findViewById(R.id.text2);

        img = (ImageView) findViewById(R.id.imageView1);
        nxtday1 = (ImageView) findViewById(R.id.nextday1);
        nxtday2 = (ImageView) findViewById(R.id.nextday2);

        String weatherString = QueryYahooWeather();
        Document weatherDoc = convertStringToDocument(weatherString);

        MyWeather weatherResult = parseWeather(weatherDoc);
        txtcity.setText(weatherResult.city);
        txtregion.setText(weatherResult.region);
        txtcountry.setText(weatherResult.country);
        txttemp.setText(weatherResult.temp);
        txtpressure.setText(weatherResult.pressure);
        txthumidity.setText(weatherResult.humidity);
        txtspeed.setText(weatherResult.windSpeed);
        txtsunrise.setText(weatherResult.sunrise);
        txtsunset.setText(weatherResult.sunset);
        txtcondition.setText(weatherResult.date);

        day1.setText(weatherResult.day);
        date1.setText(weatherResult.date);
        low1.setText(weatherResult.low);
        high1.setText(weatherResult.high);
        text1.setText(weatherResult.text);

        day2.setText(weatherResult.day1);
        date2.setText(weatherResult.date1);
        low2.setText(weatherResult.low1);
        high2.setText(weatherResult.high1);
        text2.setText(weatherResult.text1);

        img.setImageDrawable(weatherResult.im.getWeatherImage());
        nxtday1.setImageDrawable(weatherResult.im1.getWeatherImage());
        nxtday2.setImageDrawable(weatherResult.im2.getWeatherImage());
    }

    private MyWeather parseWeather(Document srcDoc) {

        MyWeather myWeather = new MyWeather();

        myWeather.description = srcDoc.getElementsByTagName("description")
                .item(0).getTextContent();

        Node locationNode = srcDoc.getElementsByTagName("yweather:location")
                .item(0);
        myWeather.city = locationNode.getAttributes().getNamedItem("city")
                .getNodeValue().toString();
        myWeather.region = locationNode.getAttributes().getNamedItem("region")
                .getNodeValue().toString();
        myWeather.country = locationNode.getAttributes()
                .getNamedItem("country").getNodeValue().toString();

        Node windNode = srcDoc.getElementsByTagName("yweather:wind").item(0);
        myWeather.windChill = windNode.getAttributes().getNamedItem("chill")
                .getNodeValue().toString();
        myWeather.windDirection = windNode.getAttributes()
                .getNamedItem("direction").getNodeValue().toString();
        myWeather.windSpeed = windNode.getAttributes().getNamedItem("speed")
                .getNodeValue().toString();

        Node atmosphereNode = srcDoc
                .getElementsByTagName("yweather:atmosphere").item(0);
        myWeather.humidity = atmosphereNode.getAttributes()
                .getNamedItem("humidity").getNodeValue().toString();
        myWeather.visibility = atmosphereNode.getAttributes()
                .getNamedItem("visibility").getNodeValue().toString();
        myWeather.pressure = atmosphereNode.getAttributes()
                .getNamedItem("pressure").getNodeValue().toString();
        myWeather.rising = atmosphereNode.getAttributes()
                .getNamedItem("rising").getNodeValue().toString();

        Node astronomyNode = srcDoc.getElementsByTagName("yweather:astronomy")
                .item(0);
        myWeather.sunrise = astronomyNode.getAttributes()
                .getNamedItem("sunrise").getNodeValue().toString();
        myWeather.sunset = astronomyNode.getAttributes().getNamedItem("sunset")
                .getNodeValue().toString();

        Node conditionNode = srcDoc.getElementsByTagName("yweather:condition")
                .item(0);
        myWeather.conditiontext = conditionNode.getAttributes()
                .getNamedItem("text").getNodeValue().toString();
        myWeather.conditiondate = conditionNode.getAttributes()
                .getNamedItem("date").getNodeValue().toString();
        myWeather.temp = conditionNode.getAttributes().getNamedItem("temp")
                .getNodeValue().toString();
        myWeather.code = conditionNode.getAttributes().getNamedItem("code")
                .getNodeValue().toString();
        myWeather.im.setWeatherImage(myWeather.code);

        Node forecastNode1 = srcDoc.getElementsByTagName("yweather:forecast")
                .item(0);
        myWeather.day = forecastNode1.getAttributes().getNamedItem("day")
                .getNodeValue().toString();
        myWeather.date = forecastNode1.getAttributes().getNamedItem("date")
                .getNodeValue().toString();
        myWeather.low = forecastNode1.getAttributes().getNamedItem("low")
                .getNodeValue().toString();
        myWeather.high = forecastNode1.getAttributes().getNamedItem("high")
                .getNodeValue().toString();
        myWeather.text = forecastNode1.getAttributes().getNamedItem("text")
                .getNodeValue().toString();
        myWeather.code0 = forecastNode1.getAttributes().getNamedItem("code")
                .getNodeValue().toString();
        myWeather.im1.setWeatherImage(myWeather.code0);

        Node forecastNode2 = srcDoc.getElementsByTagName("yweather:forecast")
                .item(1);
        myWeather.day1 = forecastNode2.getAttributes().getNamedItem("day")
                .getNodeValue().toString();
        myWeather.date1 = forecastNode2.getAttributes().getNamedItem("date")
                .getNodeValue().toString();
        myWeather.low1 = forecastNode2.getAttributes().getNamedItem("low")
                .getNodeValue().toString();
        myWeather.high1 = forecastNode2.getAttributes().getNamedItem("high")
                .getNodeValue().toString();
        myWeather.text1 = forecastNode2.getAttributes().getNamedItem("text")
                .getNodeValue().toString();
        myWeather.code1 = forecastNode1.getAttributes().getNamedItem("code")
                .getNodeValue().toString();
        myWeather.im2.setWeatherImage(myWeather.code1);

        return myWeather;
    }

    private Document convertStringToDocument(String src) {
        Document dest = null;

        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder parser;

        try {
            parser = dbFactory.newDocumentBuilder();
            dest = parser.parse(new ByteArrayInputStream(src.getBytes()));
        } catch (ParserConfigurationException e1) {
            e1.printStackTrace();
            Toast.makeText(AndroidYahooWeatherDOMActivity.this, e1.toString(),
                    Toast.LENGTH_LONG).show();
        } catch (SAXException e) {
            e.printStackTrace();
            Toast.makeText(AndroidYahooWeatherDOMActivity.this, e.toString(),
                    Toast.LENGTH_LONG).show();
        } catch (IOException e) {
            e.printStackTrace();
            Toast.makeText(AndroidYahooWeatherDOMActivity.this, e.toString(),
                    Toast.LENGTH_LONG).show();
        }

        return dest;
    }

    private String QueryYahooWeather() {

        String qResult = "";
        String queryString = "http://weather.yahooapis.com/forecastrss?w=2295422";

        HttpClient httpClient = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(queryString);

        try {
            HttpEntity httpEntity = httpClient.execute(httpGet).getEntity();

            if (httpEntity != null) {
                InputStream inputStream = httpEntity.getContent();
                Reader in = new InputStreamReader(inputStream);
                BufferedReader bufferedreader = new BufferedReader(in);
                StringBuilder stringBuilder = new StringBuilder();

                String stringReadLine = null;

                while ((stringReadLine = bufferedreader.readLine()) != null) {
                    stringBuilder.append(stringReadLine + "\n");
                }

                qResult = stringBuilder.toString();
            }

        } catch (ClientProtocolException e) {
            e.printStackTrace();
            Toast.makeText(AndroidYahooWeatherDOMActivity.this, e.toString(),
                    Toast.LENGTH_LONG).show();
        } catch (IOException e) {
            e.printStackTrace();
            Toast.makeText(AndroidYahooWeatherDOMActivity.this, e.toString(),
                    Toast.LENGTH_LONG).show();
        }

        return qResult;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:24:21.047

您的方法`QueryYahooWeather()`会打开一个网络连接。Android 将在 API 级别[11](http://developer.android.com/guide/appendix/api-levels.html#level11) (Android 3.0) 及更高版本上抛出[NetworkOnMainThreadException 。](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)顾名思义，您不能在主 (UI) 线程上打开网络连接。

其原因是“[为响应而设计](http://developer.android.com/guide/practices/design/responsiveness.html)”的原则。如果服务器不可用或用户连接较弱，则您的应用程序会滞后，因为它正在等待服务器响应。

在自己的线程中运行您的网络代码以解决问题。

更新：`ASyncTask`是这样做的正确方法。（参见上面的 Geobits 建议）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:25:01.870

例外是因为您正在访问`network`并在 上执行其他繁重的操作，`main UI thread`而 android 不允许这样做。您需要`AsyncTask`在`background`

[`AsyncTask`请参阅我在此处使用的回答](https://stackoverflow.com/questions/13349801/unfortunately-msger-has-stopped-fatal-exception-main/13349938#13349938)

# linux - 如果反引号无法执行，则 STDERR 重定向到 STDOUT 会丢失

> ID：14755456
> 
> 赞同：5
> 
> 时间：2013-02-07T16:00:41.553
> 
> 标签：linux, perl

我发现`STDERR`如果命令执行失败，反引号调用中的重定向可能会丢失。我被我看到的行为难住了。

```
$ perl -e '使用严格；使用警告；我的 $out=`DNE`; 打印 $out'  
无法执行“DNE”：-e 第 1 行没有这样的文件或目录。
在 -e 第 1 行的打印中使用未初始化的值。

$ perl -e '使用严格；使用警告；我的 $out=`DNE 2>&1`; 打印 $out'
在 -e 第 1 行的打印中使用未初始化的值。

$ perl -e '使用严格；使用警告；我的 $out=`echo 123; DNE 2>&1`; 打印 $out'
123
sh：DNE：找不到命令
```

我的语法不正确吗？

我在 Linux 上使用 Perl 5.8.5。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-07T16:33:45.373

您的语法是正确的，但在一种情况下`perl`会删除错误消息。

通常，请考虑在初始化期间测试您的系统是否具有您想要的命令，如果丢失则尽早失败。

```
my $foopath = "/usr/bin/foo";
die "$0: $foopath is not executable" unless -x $foopath;

# later ...

my $output = `$foopath 2>&1`;
die "$0: $foopath exited $?" if $?; 
```

要完全理解输出的差异，有必要了解 Unix 系统编程的细节。继续阅读。

## Unix 文件描述符

考虑一个简单的`perl`调用。

```
perl -e '打印 "hi\n"; 警告“再见\n”'
```

它的输出是

```
你好
再见
```

请注意，输出`print`到`STDOUT`标准输出，并`warn`写入`STDERR`标准错误。从终端运行时，两者都会出现在终端上，但我们可以将它们发送到不同的地方。例如

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' >/dev/null
再见
```

空设备或`/dev/null`丢弃发送给它的任何输出，因此在上面的命令中，“hi”消失了。上面的命令是简写

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' 1>/dev/null
再见
```

也就是说，1 是 的文件描述符`STDOUT`。要扔掉“再见”，请运行

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' 2>/dev/null
你好
```

如您所见， 2 是`STDERR`. （为完整起见，文件描述符为`STDIN`0。）

在 Bourne shell 及其派生类中，我们还可以将`STDOUT`和`STDERR`与合并`2>&1`。将其读作“使文件描述符 2 的输出与文件描述符 1 的输出到相同的位置。”</p>

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' 2>&1
你好
再见
```

终端输出没有突出区别，但额外的重定向显示正在发生的事情。我们可以通过运行丢弃两者

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' >/dev/null 2>&1
```

顺序对于这个以从左到右的顺序处理重定向的 shell 系列很重要，因此转置两个产生

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' 2>&1 >/dev/null
再见
```

起初这可能令人惊讶。shell首先处理`2>&1`这意味着发送`STDERR`到与它已经是相同的目的地`STDOUT`：终端！然后它处理`>/dev/null`并重定向`STDOUT`到空设备。

这种文件描述符的重复是通过调用[`dup2`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html)来实现的，这通常是[`fcntl`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html).

## 重定向和管道

现在假设我们要为命令输出的每一行添加一个前缀。

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' | sed -e 's/^/得到：/'
再见
得到：你好
```

顺序不同，但请记住，`STDERR`它们`STDOUT`是不同的流。另请注意，只有“hi”有前缀。要获得两条线，它们都必须出现在`STDOUT`.

```
$ perl -e '打印 "hi\n"; 警告“再见\n”' 2>&1 | sed -e 's/^/得到：/'
得到：再见
得到：你好
```

为了构建管道，shell 使用 来创建子进程`fork`，使用 来执行重定向`dup2`，并通过调用`exec`适当的进程来启动管道的每个阶段。对于上面的管道，过程类似于

*   shell：`fork`要运行的进程`sed`
*   shell：等待退出`sed`状态`waitpid`
    *   sed：创建一个`pipe`将输入提供给`perl`
    *   sed：`fork`要运行的进程`perl`
    *   sed：`dup2`从`STDIN`管道的读取端读取
    *   sed `exec`：`sed`命令
    *   sed：等待输入`STDIN`
        *   perl：从步骤 3`dup2`发送`STDOUT`到管道的写入端
        *   perl:`dup2`发送`STDERR`到`STDOUT`的目的地
        *   perl `exec`：`perl`命令
        *   perl：写入输出并最终`exit`
    *   sed：接收和编辑输入流
    *   sed：检测管道上的文件结尾
    *   sed: reap`perl`的退出状态`waitpid`
    *   赛德：`exit`
*   shell：填充`$?`来自的返回值`waitpid`

请注意，子进程是按从右到左的顺序创建的。这是因为 Bourne 系列中的 shell 将管道的退出状态定义为最后一个进程的退出状态。

## 自己动手的管道

您可以使用以下代码在 Perl 中构建上述管道。

```
#! /usr/bin/env perl

use strict;
use warnings;

my $pid = open my $fh, "-|";
die "$0: fork: $!" unless defined $pid;

if ($pid) {
  while (<$fh>) {
    s/^/got: /;
    print;
  }
}
else {
  open STDERR, ">&=", \*STDOUT or print "$0: dup: $!";
  exec "perl", "-e", q[print "hi\n"; warn "bye\n"]
    or die "$0: exec: $!";
} 
```

第一次调用`open`为我们做了很多工作，如[perlfunc 文档`open`](http://perldoc.perl.org/functions/open.html)中所述：

> 对于三个或更多参数，如果 MODE 为`"|-"`，则文件名被解释为要通过管道输出的命令，如果 MODE 为`"-|"`，则文件名被解释为通过管道输出给我们的命令。在双参数（和单参数）形式中，应将破折号 ( `"-"`) 替换为命令。有关这方面的更多示例，请参阅在 perlipc 中[使用`open`IPC 。](http://perldoc.perl.org/perlipc.html#Using-open()-for-IPC)

它的输出是

```
$ ./简单管道
得到：再见
得到：你好
```

上面的代码硬编码了 的重复项`STDOUT`，我们可以在下面看到。

```
$ ./simple-pipeline >/dev/null
```

## Perl 反引号

要捕获另一个命令的输出，`perl`请设置相同的机器，您可以在[`pp_backtick`](https://github.com/mirrors/perl/blob/fc99edcf6b3d3de59f7bdefc42a09167fd8b96f5/pp_sys.c#L296)(in `pp_sys.c`) 中看到它，它调用[`Perl_my_popen`](https://github.com/mirrors/perl/blob/5d1d68e202770f3a59cef999bc11d534a2364d5f/util.c#L2625)(in `util.c`) 来创建子进程并设置管道 ( `fork`, `pipe`, `dup2`)。孩子做了一些检查并调用`Perl_do_exec3`(in `doio.c`) 来启动我们想要输出的命令。我们注意到[一个相关的评论](https://github.com/mirrors/perl/blob/0eb30aebe20a48d634d4e484bc9e6005dffc1420/doio.c#L1514)：

```
/* handle the 2>&1 construct at the end */ 
```

该实现识别 sequence `2>&1`、 duplicates`STDOUT`并从要传递给 shell 的命令中删除重定向。

```
if (*s == '>' && s[1] == '&' && s[2] == '1'
    && s > cmd + 1 && s[-1] == '2' && isSPACE(s[-2])
    && (!s[3] || isSPACE(s[3])))
{
    const char *t = s + 3;

    while (*t && isSPACE(*t))
        ++t;
    if (!*t && (PerlLIO_dup2(1,2) != -1)) {
        s[-2] = '\0';
        break;
    }
} 
```

后来我们看到

```
PerlProc_execl(PL_sh_path, "sh", "-c", cmd, (char *)NULL);
PERL_FPU_POST_EXEC
S_exec_failed(aTHX_ PL_sh_path, fd, do_report); 
```

在里面`S_exec_failed`，我们发现

```
if (ckWARN(WARN_EXEC))
    Perl_warner(aTHX_ packWARN(WARN_EXEC), "Can't exec \"%s\": %s",
                cmd, Strerror(e)); 
```

这是您在问题中提出的警告之一。

## 时间线

让我们详细了解如何`perl`处理您问题中的命令。

### 正如预期的那样

```
$ perl -e '使用严格；使用警告；我的 $out=`DNE`; 打印 $out'
无法执行“DNE”：-e 第 1 行没有这样的文件或目录。
在 -e 第 1 行的打印中使用未初始化的值。
```

这里没有惊喜。

一个微妙的细节是很重要的理解。上面处理`2>&1`内部的代码仅在要执行的命令的条件为真时运行：

```
if (*s != ' ' && !isALPHA(*s) &&
    strchr("$&*(){}[]'\";\\|?<>~`\n",*s)) { 
```

这是一个优化。如果反引号中的命令包含上述 shell 元字符，则`perl`必须将其交给 shell。*但是*如果不存在 shell 元字符，`perl`可以`exec`直接使用命令——节省`fork`shell 启动成本。

不存在的命令`DNE`不包含 shell 元字符，`perl`所有工作也是如此。由于命令失败并且您启用了`warnings`编译指示，因此生成了 exec-category 警告。perlop 文档告诉我们，当命令失败时，反引号或在标量上下文中`qx//`返回`undef`，这就是为什么您会收到有关打印未定义值的警告的原因`$out`。

### 缺少警告

```
$ perl -e '使用严格；使用警告；我的 $out=`DNE 2>&1`; 打印 $out'
在 -e 第 1 行的打印中使用未初始化的值。
```

失败的`exec`警告去哪儿了？

记住创建运行另一个命令的子进程的基本步骤：

1.  为子级创建一个管道以将其输出发送到父级。
2.  调用`fork`创建一个几乎相同的子进程。
3.  在孩子中，`dup2`连接`STDOUT`到管道的写入端。
4.  在子进程中，`exec`使新创建的子进程改为执行另一个程序。
5.  在父级中，读取管道的内容。

要捕获另一个命令的输出，请执行`perl`以下步骤。在准备尝试运行`DNE 2>&1`时，`perl`fork 一个子进程并*在子进程中*导致`STDERR`复制`STDOUT`，但还有另一个副作用。

```
if (!*t && (PerlLIO_dup2(1,2) != -1)) {
    s[-2] = '\0';
    break;
} 
```

如果`2>&1`是在命令的末尾并且`dup2`成功，则`perl`在重定向之前写入一个 NUL 字节。这具有将其从命令中删除的效果，*例如*，`DNE 2>&1`变为`DNE`! 现在，在命令中没有 shell 元字符的情况下，`perl` *子进程*自己认为，“我们自己，我们可以`exec`直接执行这个命令。”</p>

调用`exec`失败，因为`DNE`不存在。孩子仍然在 上发出失败的`exec`警告`STDERR`。它不会进入终端，因为`dup2`它指向`STDERR`与以下相同的位置`STDOUT`：管道的写端返回父级。

父进程检测到子进程异常退出，并忽略管道的内容，因为命令执行失败的结果记录为`undef`.

### 不同的警告

```
$ perl -e '使用严格；使用警告；我的 $out=`echo 123; DNE 2>&1`; 打印 $out'
123
sh：DNE：找不到命令
```

在这里，我们看到了`DNE`不存在的不同诊断。遇到的第一个 shell 元字符是`;`，因此`perl`将未更改的命令交给 shell 执行。`echo`正常完成，然后在*shell*`DNE`中失败，并且 shell 的并返回父进程。从的角度来看，shell 执行得很好，所以没有什么需要警告的。*`STDOUT``STDERR``perl`*

 *## 相关说明

当您启用`warnings`pragma（**非常**好的做法！）时，这将启用`exec`警告类别。要查看这些警告的完整列表，请在[perldiag](http://perldoc.perl.org/perldiag.html)文档中搜索字符串`W exec`。

观察差异。

```
$ perl -Mstrict -Mwarnings -e '我的 $out=`DNE`; 打印 $out'
无法执行“DNE”：-e 第 1 行没有这样的文件或目录。
在 -e 第 1 行的 print 中使用未初始化的值 $out。

$ perl -Mstrict -Mwarnings -M-warnings=exec -e '我的 $out=`DNE`; 打印 $out'
在 -e 第 1 行的 print 中使用未初始化的值 $out。
```

后一个调用等价于

```
use strict;
use warnings;
no warnings 'exec';

my $out = `DNE`;
print defined($out) ? $out : "command failed\n"; 
```

`exec`当 an 、 pipe等出现问题时，我喜欢格式化我自己的错误消息`open`。这意味着我通常禁用 exec 警告，但这也意味着我必须格外小心地测试返回值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-07T16:13:01.747

这里的问题是重定向是由 shell 完成的。而且你的`...` 命令不是通过shell 运行的——Perl 尝试使用$PATH 查找DNE 程序，但它失败了。

如果您需要同时捕获 stdout 和 stderr，您可以采用多种方式，但我认为最安全的是使用[IPC::Open3](http://search.cpan.org/~dom/perl-5.12.5/ext/IPC-Open3/lib/IPC/Open3.pm)或[IPC::Run](http://search.cpan.org/~toddr/IPC-Run-0.92/lib/IPC/Run.pm)。

如果你觉得冒险，你可以尝试做这样的事情，但请记住这是个坏主意：

```
$ perl -e 'use strict; use warnings; my $o=`sh -c "DNE 2>&1"`; print $o' 
sh: 1: DNE: not found 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T10:56:29.417

```
 my $op =`dne 2>&1;`; 
```

这行得通。注意`;`重定向末尾的分号。

或者你可以使用下面的代码。

```
#!/usr/bin/perl
use strict;
use warnings;

my $op=`dne 2>&1 1>output.txt`;

print $op; 
```

输出：

```
sh: dne: command not found 
```

`dne 2>&1`虽然，我仍然不知道为什么不打印 STDOUT 以防万一。

但是，当您使用 STDOUT 重定向到文件时，会打印输出。这很奇怪，但有效。*

# html - 固定标题不会随正文水平滚动

> ID：14755460
> 
> 赞同：0
> 
> 时间：2013-02-07T16:00:54.030
> 
> 标签：html, css, image

我想知道是否有人知道如何解决这个问题。我做了一个固定的标题，只有内容框会滚动，但如果我水平滚动，标题将停留在浏览器的中间，我的内容会滚动，这让它看起来很愚蠢。我也想要垂直和水平滚动。

有谁知道如何用纯 css html 解决这个问题？=X

请帮忙！

我还不允许在这里张贴图片，所以去 www.covenantchurch-pca.net 并水平滚动你会看到我的问题。如果您需要查看我的 html css 编码，请告诉我。我真的需要帮助。我不太擅长这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:03:53.843

```
<img style="position: fixed; height:200px; width:40px; top: 150px;right: 0px;" id="imgId" src="images/skin/contact2.png"> 
```

这对你有用..

# ios - ld：创建具有本机扩展名的 AIR iOS 包时找不到 -lgcc_s.1 的库

> ID：14755461
> 
> 赞同：3
> 
> 时间：2013-02-07T16:01:02.563
> 
> 标签：ios, mobile, air, air-native-extension, libgcc

我正在尝试为 iOS 创建一个 AIR 本机扩展，但是当尝试创建要部署到我的设备的包时，我收到以下错误：

```
ld: library not found for -lgcc_s.1
Compilation failed while executing : ld64 
```

当我尝试为模拟器创建应用程序时它工作。我尝试了许多组合，将 libgcc_s.1 添加到我的 platform.xml 文件中，只为 iOS 创建一个包，为模拟器和手机创建一个胖二进制文件等。

我不确定为什么它需要 libgcc_s.1 包，因为我没有在我的扩展中引用它。我尝试将它手动添加到 xcode 中的“Link Binary With Libraries”列表中，此时它不会构建，告诉我 libgcc_s.1.dylib 在我的系统上不存在。

其他人的系统上有这个库吗？如果我没有要求，有人知道为什么要添加它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-20T03:07:07.510

经过几天的搜索和测试，我终于解决了这个问题。打包设备时删除 -platformsdk 选项。

# angularjs - 为什么我的请求 POST by $resource 是一个选项

> ID：14755464
> 
> 赞同：2
> 
> 时间：2013-02-07T16:01:17.950
> 
> 标签：angularjs

我正在使用的代码如下，在 coffeescipt 中：

```
request_with_token =
  get:
    method: "JSONP",
    params:
      token: app["token"]
  save:
    method: "POST",
    params:
      token: app["token"]

$rootScope.API = "http://0.0.0.0:5200/1.0"

$scope.ajaxAccountUpdate = $resource($rootScope.API + "/account/update.json",
  { callback: "JSON_CALLBACK" }, request_with_token )

user = $scope.user
$scope.ajaxAccountUpdate.save user, (resource) ->
  $scope.show_message(resource) 
```

但是在我的日志中，我有一个 OPTIONS 而不是 POST

```
[07/Feb/2013 16:50:48] "OPTIONS /1.0/account/update?callback=JSON_CALLBACK&token=mytoken HTTP/1.1" 200 - 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:24:15.270

可能是因为您向提供 HTML 的不同网站发出请求，导致“跨源资源共享”CORS 飞行前检查。这是一项安全功能：

欲了解更多信息：[http ://www.html5rocks.com/en/tutorials/cors/](http://www.html5rocks.com/en/tutorials/cors/)

# arrays - 奇怪的数组问题 - 改变长度，预定义的第一个元素

> ID：14755465
> 
> 赞同：0
> 
> 时间：2013-02-07T16:01:27.980
> 
> 标签：arrays, actionscript-3

这是我创建的一段基本代码，它生成一个随机的双色关卡：

```
var map:Array = new Array();

var mLength:int = 28;
var mHeight:int = 16;
var mArea:int = mLength * mHeight;

var tileWidth:int = 20;
var tileHeight:int = 20;
var tileX:int = 0 - tileWidth;
var tileY:int = 0;
var genTile:int;
var genDone:Boolean = false;

var waterChance:int = 10;
var grassChance:int = 33;
var tile:Sprite = new Sprite();
var waterTile:Sprite = new Sprite();
var waterHolder:Sprite = new Sprite();
var genericTileHolder:Sprite = new Sprite();

var hitting:Boolean = false;

var i:int = 0;

for (i = 0; i < mArea; i++) {
    if (map[i - 27] == 1) {
        waterChance * 8;
        grassChance / 2;
    }
    if (map[i - 28] == 1) {
        waterChance * 8;
        grassChance / 2;
    }
    if (map[i - 29] == 1) {
        waterChance * 8;
        grassChance / 2;
    }
    if (map[i - 1] == 1) {
        waterChance * 8;
        grassChance / 2;
    }
    tileX += tileWidth;
    if (tileX >= mLength * tileWidth) {
        tileX = 0;
        tileY += tileHeight;
    }
    genTile = (Math.round((Math.random()*(waterChance+grassChance))));

    if (0 < genTile < waterChance) {
        waterTile.graphics.beginFill(0x0033CC);
        waterTile.graphics.drawRect(tileX,tileY,tileWidth,tileHeight);
        waterHolder.addChildAt(waterTile, 0);
        map.push("1");
    }
    if ((waterChance + 1) < genTile && genTile < (waterChance + grassChance)) {
        tile.graphics.beginFill(0x216B18);
        tile.graphics.drawRect(tileX,tileY,tileWidth,tileHeight);
        genericTileHolder.addChildAt(tile, 0);
        map.push("2");
    }
    grassChance = 33;
    waterChance = 10;

}
stage.addChildAt(waterHolder, 0);
stage.addChildAt(genericTileHolder, 1); 
```

问题有两个方面。一，每当数组生成时，长度似乎有一个随机的变化——使用 trace(map.length) 我得到了很多不同的长度，从 750 到 780，而它最多只能是 400。

其次，每当我跟踪关卡本身时，使用 trace(map) 我发现第一个元素似乎默认设置为 1。我无法弄清楚它为什么这样做，因为它应该在 20 之后至少一次为 2尝试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:54:41.477

您不能在 actionscript 中比较超过 2 个项目：

```
if (0 < genTile < waterChance) {... 
```

它总是会返回 true（我认为）。反而：

```
if ((0 < genTile) && (genTile < waterChance)) {... 
```

此外，看起来每个循环都可以执行 map.push("1") 和 map.push("2") - 因此 map 大于 mArea - 我认为它应该做一个或另一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T10:12:28.660

**问题2：map的第一个元素默认为1**

```
if (0 < genTile < waterChance)
{
    waterTile.graphics.beginFill (0x0033CC); // Blue
    waterTile.graphics.drawRect (tileX,tileY,tileWidth,tileHeight);
    waterHolder.addChildAt (waterTile, 0);
    map.push ("1");
} 
```

由于`<`运算符是左关联的，因此表达式将被计算为`(0 < genTile) < waterChance`.

由于 genTile 永远不会小于 0，`(0 < genTile)`因此始终为 false。

而且由于 waterChance 也永远不会小于 0，`(false < waterChance)`

翻译`(0 < waterChance)`为总是正确的。

这`(0 < genTile) < waterChance`总是正确的。

因此 map 的第一个元素总是“1”。

**问题 1：map.length 变化**

```
if ((waterChance + 1) < genTile && genTile < (waterChance + grassChance))
{
    tile.graphics.beginFill (0x216B18); // Green
    tile.graphics.drawRect (tileX,tileY,tileWidth,tileHeight);
    genericTileHolder.addChildAt (tile, 0);
    map.push ("2");
} 
```

由于 mArea 等于 448，因此水砖的总和将始终为 448。

而且由于 genTile 是一个随机数，所以草块的总和总是一个随机数。

因此 map.length 变化。

我希望这会有所帮助。

# asp.net - 在 Ajax 调用期间 WebMethod 的行为如何？

> ID：14755466
> 
> 赞同：0
> 
> 时间：2013-02-07T16:01:32.423
> 
> 标签：asp.net, jquery

使用 jQuery 在网页上调用 WebMethod 时。我们将其定义为静态。

然而`static methods always have one instance`。发出多个 Web 请求时会发生什么。

1.  它真的是异步发生的还是
2.  所有请求都流水线等待 WebMethod 接受请求？

我创建了一个示例控制台程序来模拟场景`static method work`并发现它们按顺序执行。

```
class Program
{
    static int count = 10;
    static void Main(string[] args)
    {
        new Program().foobar();

        Console.ReadLine();
    }

    public void foobar()
    {
        Parallel.Invoke(() => work("one"), () => work("two"), () => work("three"), ()=> work("four"));
    }

    static void work(string str)
    {
        Thread.Sleep(3000);
        count++; 
        Console.WriteLine(str + " " + count);
    }
} 
```

你能解释一下这个概念吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:17:41.020

它们不会按顺序执行。如果您在客户端服务器场景中创建了多个应用程序，这将是一个更好的示例，因为您的控制台应用程序本质上是按顺序运行所有内容。

也就是说，使用静态方法，您只需要了解共享资源、数据等。本地数据就可以了。

# javascript - 为什么我不能在 HTML 中使用称为“评估”的 JS 函数？

> ID：14755468
> 
> 赞同：9
> 
> 时间：2013-02-07T16:01:35.813
> 
> 标签：javascript, html

我有点好奇为什么这不起作用

JavaScript：

```
function evaluate(){
    console.log(42);
} 
```

HTML：

```
<a onclick="evaluate()">Click Me!</a> 
```

是否在 html 端的某处评估保留关键字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:10:37.597

“evaluate”不是保留关键字，但是当它用于**内联**事件处理程序时，它恰好与文档的`evaluate`函数发生冲突（对象在对象**之前**的`document`处理程序范围链内）。如果您不想更改函数名称，只需在其前面添加上下文，即**`window``window`**

 **`<a onclick="window.evaluate()">Click Me!</a>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T16:11:23.727

`document.evaluate`解析 XML 是必需的，请参阅[此处 MDN 中的参考](https://developer.mozilla.org/en-US/docs/Introduction_to_using_XPath_in_JavaScript)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-07T16:33:55.580

Evaluate 不是JavaScript 中的[保留字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words)[`document.evaluate`](https://developer.mozilla.org/en-US/docs/DOM/document.evaluate)，用于评估[XPath](https://developer.mozilla.org/en-US/docs/XPath)表达式。

`evaluate`如果您使用一种不那么突兀的方法来附加您的事件处理程序，您仍然可以命名您的函数：

```
var evaluate = function (){
    console.log(42);
}

document.addEventListener('click', evaluate, false); 
```

[例子](http://jsfiddle.net/RWRdJ/)**

# javascript - 从 mongodb 回调将值设置为外部变量

> ID：14755469
> 
> 赞同：0
> 
> 时间：2013-02-07T16:01:36.300
> 
> 标签：javascript, node.js, mongoose

当我必须将 mongodb find 回调函数中的值设置为外部变量时，我遇到了一个奇怪的问题。例如：

```
 p += '<tr style="width: 165px!important;">';
    photos.forEach(function(photo) {
        EventPhoto.findOne({ _photo: photo._id }, function(err, doc) {
            if (doc.main) {
                p += '<td class="center-text"><a href="#" class="main-photo-on" onclick="javascript:changeMainPhoto("' + photo._id + '");">destaque</a></td>';
            } else {
                p += '<td class="center-text"><a href="#" class="main-photo-off" onclick="javascript:changeMainPhoto("' + photo._id + '");">destaque</a></td>';
            }
        });
    });
    p += '</tr>'; 
```

每张照片的变量`p`都是递增的，问题是当 EventPhoto.find(...) 结束并且该值未签名时，会丢失所有添加的内容（我检查过）。不幸的是，我无法在这个回调函数中开发其余的代码，那么即使没有“超级”运算符或类似的东西，分配这个值的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T17:21:39.303

这不起作用，因为您正在启动异步请求并且您不知道返回值何时到达。相反，您的目标应该是按顺序执行每个查找，一旦到达终点，继续做需要做的工作。我相信你的情况，这或多或少是你正在寻找的方法。

```
var p = '<tr style="width: 165px!important;">';
var i = -1;
var next = function() {
    i++;
    if (i < photos.length) {
        var photo = photos[i];
        EventPhoto.findOne({ _photo: photo._id }, function(err, doc) {
            if (doc.main) {
                p += '<td class="center-text"><a href="#" class="main-photo-on" onclick="javascript:changeMainPhoto("' + photo._id + '");">destaque</a></td>';
            } else {
                p += '<td class="center-text"><a href="#" class="main-photo-off" onclick="javascript:changeMainPhoto("' + photo._id + '");">destaque</a></td>';
            }
            next();
        });
    }
    else {
        p += '</tr>';
        // TODO: Do remaining work.
    }
}
next(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:20:59.980

很确定你需要一个关闭：
编辑：不！

```
p += '<tr style="width: 165px!important;">';
photos.forEach(
(function(what){
  return function(photo) {  //this will be forEach's iterator fn
    EventPhoto.findOne({ _photo: photo._id }, function(err, doc) {
        if (doc.main) {
            what += '<td class="center-text"><a href="#" class="main-photo-on" onclick="javascript:changeMainPhoto("' + photo._id + '");">destaque</a></td>';
        } else {
            what += '<td class="center-text"><a href="#" class="main-photo-off" onclick="javascript:changeMainPhoto("' + photo._id + '");">destaque</a></td>';
        }
    });
  };  // end of fn being returned by closure to forEach()
})(p) // pass p into the closure so the callback remembers it
);    // end of forEach call
p += '</tr>'; // this will be added before the callback fires 
```

# ruby-on-rails - 迁移期间的基本 Rails 问题 (Rails 2.3.11)

> ID：14755472
> 
> 赞同：1
> 
> 时间：2013-02-07T16:01:42.553
> 
> 标签：ruby-on-rails, migration

我在迁移期间遇到了基本的 Rails 问题。这是两个脚本

```
class CreateGoogleMaps < ActiveRecord::Migration
  def self.up
    create_table :google_maps do |t|
      t.string :name, :null => false
      t.string :description
      t.column "center", :point, :null => false, :srid => 4326, :with_z => false # 4326: WSG84
      t.integer :zoom
      t.datetime :created_at
      t.datetime :updated_at
      t.integer :created_by_id
      t.integer :updated_by_id
    end
  end

  def self.down
    drop_table :google_maps
  end
end 
```

文件 #2 +++ 003_add_map_style.rb ++++++

```
class AddMapStyle < ActiveRecord::Migration
  def self.up
      add_column :google_maps, :style, :integer
      GoogleMaps.update_all( "style = 1")
  end

  def self.down
      remove_column :google_maps, :style
  end
end
*********************************************** 
```

这是我在迁移期间看到的内容 == CreateGoogleMaps：迁移 ====================================== ========== -- create_table(:google_maps) -> 0.0638s == CreateGoogleMaps: 已迁移 (0.0640s) ==================== ===================

== CreateMarkers：迁移 ============================================= ===== -- create_table(:markers) -> 0.0537s == CreateMarkers: 迁移 (0.0539s) ======================== =================

== AddMapStyle：迁移 ============================================== ======= -- add_column(:google_maps, :style, :integer) -> 0.0406s rake 中止！发生错误，所有后续迁移均已取消：

未初始化的常量 AddMapStyle::GoogleMaps

我正在使用 Rails 2.3.11。非常感谢任何调试提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:12:15.503

您不应该在迁移中使用模型，因为它很危险 - 模型可能会更改，您正在尝试加载 ActiveRecord 对象，同时从它们下面更改模式。

如果可以，您应该使用 SQL，例如运行原始更新命令的以下示例。

```
class AddMapStyle < ActiveRecord::Migration
  def self.up
      add_column :google_maps, :style, :integer
      execute("UPDATE google_maps SET style=1")
  end

  def self.down
      remove_column :google_maps, :style
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:18:06.650

您可以像这样在迁移中安全地使用模型：

```
class AddMapStyle < ActiveRecord::Migration
  class GoogleMaps < ActiveRecord::Base; end

  def self.up
      add_column :google_maps, :style, :integer
      GoogleMaps.update_all( "style = 1")
  end

  def self.down
      remove_column :google_maps, :style
  end
end 
```

由于该类是在迁移类内部定义的，因此它位于单独的命名空间中。

# javascript - 如何在 html 或 javascript 中自动左对齐图像

> ID：14755474
> 
> 赞同：0
> 
> 时间：2013-02-07T16:01:48.650
> 
> 标签：javascript, css, image, html

下面是我的代码，其中三个图像彼此水平对齐。单击每个图像后，我添加了一些简单的操作来删除其他图像，但如果单击图像 2 和图像 3 仍将保留在其当前区域，而不是像图像 1 那样左对齐。有没有办法可以左对齐图像 2或 3 如果他们被点击？非常感谢

```
<div style="width:510px; height:105px; padding:5px;">

    <img alt="Passenger Vehicle" id="V1" src="http://hou-agsprd02/images/basictruck.gif" onclick="Vehicle1()" style="width:150px; height:100px; border:1px solid blue; float:left;" />
    <img alt="Water Vehicle" id="V2" src="http://hou-agsprd02/images/WaterTruck.gif" onclick="Vehicle2()" style="width:150px; height:100px; border:1px solid blue; float:left;" />
    <img alt="Rig Transport Vehicle" id="V3" src="http://hou-agsprd02/images/GasTruck.gif" onclick="Vehicle3()" style="width:150px; height:100px; border:1px solid blue; float:left;" />

</div> 
```

这是我在另一个函数中的代码，如果单击图像 1，它会隐藏图像 2 和 3，很抱歉将其遗漏了。

```
 document.getElementById('V2').style.visibility = 'hidden';
 document.getElementById('V3').style.visibility = 'hidden'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:48:22.040

您将可见性设置为隐藏，这实际上隐藏了块，但仍占用布局中的空间。

您要做的是通过将`display`属性设置为来删除块曾经所在的空间`none`。

根据您的 javascript 代码，您可以通过将代码更改为：

```
document.getElementById('V2').style.display = 'none';
document.getElementById('V3').style.display = 'none'; 
```

完成此操作后，您会注意到该块将被移除，并且它周围的元素将塌陷到隐藏块曾经所在的区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:18:02.957

你的Javascript代码是什么？如果您只是将图像隐藏起来，它仍然存在。您将需要实际从页面中删除图像，然后图像将填充它的位置，因为它们是向左浮动的。

# javascript - javascript - 从时钟脚本中删除秒

> ID：14755475
> 
> 赞同：1
> 
> 时间：2013-02-07T16:01:53.443
> 
> 标签：javascript, wordpress, datepicker, clock

我想对这个[脚本](http://temporario.web929.uni5.net/datepicker/bootstrap-datetimepicker.min.js)做一个小的修改。

[演示](http://tarruda.github.com/bootstrap-datetimepicker/)

它是引导程序的日期选择器。

使用上面网站上提供的演示，您很快就会意识到我要更改的内容。

当您选择日期时，通过单击一天，我希望它自动更改为 CLOCK 功能，如果时钟只有小时和分钟，不包括秒，那就太好了 -

到目前为止我已经尝试过： showSeconds: false 但它不起作用。研究并尝试了一系列关于javascript文件的东西，但没有成功。我不太擅长 javascript:/

有人可以给我一些启示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T18:31:39.467

我不确定如何在单击日期后使日期选择自动转到时间设置，但我已经能够修改文件，这样您就可以摆脱秒数。

我没有粘贴所有代码，而是在这里进行了修改：http: [//jsbin.com/ujuwej/1/edit](http://jsbin.com/ujuwej/1/edit)

快速概述我所做的事情。

我打了这个电话来启动插件：

```
$('#datetimepicker').datetimepicker({
    format: 'dd/MM/yyyy HH:mm PP',
    pick12HourFormat: true
  }); 
```

请注意，格式没有秒数。

如果你看一下这个函数：

```
TPGlobal.getTemplate = function(is12Hours) 
```

并将我的版本与原始版本进行比较，您会注意到我只是删除了表格中每一行的最后一个单元格。这有效地消除了显示秒数。

希望这就是你要找的！

# makefile - 有没有办法在 Makefile 的规则中引用目标特定变量？

> ID：14755476
> 
> 赞同：2
> 
> 时间：2013-02-07T16:01:57.680
> 
> 标签：makefile, target

```
1 target foo : src = foo.c
2 target foo : obj = foo.o
3 target bar : src = bar.c
4 target bar : obj = bar.o

5 foo bar: obj   # problem - not recognizing obj!
6    @echo link ${bin}     
7    @gcc command to link ${obj}

8 foo.o bar.o
9    @echo compile ${src}
10   @gcc command to compile ${src} 
```

因此，目标特定变量非常适合第 6、7、9 和 10 行中使用的目标配方。但是，有没有一种方法可以像在第 5 行中那样在目标规则本身中引用目标特定变量“obj” ? 我想有，但我需要一些巫毒符号来引用它。不敢相信我在任何地方都找不到这个答案。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T16:07:40.800

使用[二次扩展](http://www.gnu.org/software/make/manual/make.html#Secondary-Expansion)：

```
.SECONDEXPANSION:

foo bar: $$(obj)
    ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:07:00.920

我认为您需要先决条件，而不是针对特定变量：

```
foo : foo.o
bar : bar.o

foo bar :
    gcc -o $@ $^ ${LDFLAGS } ${LDLIBS}

# use the default rule for .c to .o 
```

请注意，这`$^`会扩展到所有先决条件的列表。

# git - git - 进行一些编辑后，我提交并尝试推送，但收到消息说一切都是最新的

> ID：14755478
> 
> 赞同：0
> 
> 时间：2013-02-07T16:02:03.360
> 
> 标签：git

我只是做了一些更改，然后提交，但是当我尝试推送时，我收到一个错误，表明一切都是最新的。

为什么会发生这种情况？作为说明，昨天我遇到了一些合并问题，今天我不得不做一个 git checkout some_version_number

知道这里出了什么问题吗？谢谢！

这是 git status 的输出

```
macoss-MacBook-Pro-10:Marketing owner12$ git status
# Not currently on any branch.
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#   modified:   Marketing/en.lproj/MainStoryboard_iPad.storyboard
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   Marketing.xcodeproj/project.xcworkspace/xcuserdata/owner12.xcuserdatad/ 
```

然后当我尝试通过执行 git checkout master 去我的分支时，我得到了这个：

```
macoss-MacBook-Pro-10:Marketing owner12$ git push origin master
Password for 'https://genadinik@bitbucket.org': 
Everything up-to-date
macoss-MacBook-Pro-10:Marketing owner12$ git checkout master
error: Your local changes to the following files would be overwritten by checkout:
    Marketing/en.lproj/MainStoryboard_iPhone.storyboard
Please, commit your changes or stash them before you can switch branches.
error: The following untracked working tree files would be overwritten by checkout:
    Marketing.xcodeproj/project.xcworkspace/xcuserdata/owner12.xcuserdatad/UserInterfaceState.xcuserstate
Please move or remove them before you can switch branches. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T17:10:37.640

根据您的`git status`输出，您在不在主分支上时进行了这些更改：

```
macoss-MacBook-Pro-10:Marketing owner12$ git status
# Not currently on any branch.
... 
```

您`git checkout`没有将您移动到`master`分支的原因是因为这样做会涉及覆盖您所做的更改（根据错误消息）。

您最简单的方法是：

```
$ git stash save      # Save the edits made whilst not on a branch
$ git checkout master # Move to the master branch
$ git stash pop       # Apply stashed-changes; delete from stash if successful 
```

请注意，应用您的更改可能会导致冲突 - 请务必仔细阅读任何 git 输出。

（编辑：请注意，`git stash save`不会处理未跟踪的文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:31:08.723

你需要

```
git add FILENAME 
```

或者

```
git commit -a 
```

否则你什么都没有提交。

您的 git 输出告诉您有未暂存和未跟踪的文件，这是因为您刚刚执行了“git commit 文件名”，除非您使用 git add 暂存文件，否则它不会做任何事情。

你也可以通过

```
git log 
```

您本地的历史记录与远程的历史记录相同，因此 git 消息“一切都是最新的，没有变化”

# c++ - mingw 4.7.1 上的 stoi 和 std::to_string

> ID：14755484
> 
> 赞同：3
> 
> 时间：2013-02-07T16:02:21.117
> 
> 标签：c++, c++11, mingw, std

好吧，我想将我的 C++11 程序移植到 Windows，但在 mingw 4.7.1 中似乎没有实现 stoi 和 std::to_string 。我知道有人问过它并且有一个解决方案来编辑​​一些标题，但是在我的 mingw 版本（4.7.1 附带 codelite）中，标题是不同的，并且没有我必须移动的确切行（可能是因为答案是对于 mingw 4.6）。

所以我的问题是如何在 mingw 4.7 上获得这些功能？是否有任何指南可以在 4.7 中更改标题，或者它可能会包含在 4.8 中？

当然有 boost::lexical_cast，但我想保持我的代码不变，所以我正在寻找如何在 mingw 中启用这些功能的解决方案。

也许有一些自定义的 mingw 发行版支持这些功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T21:46:30.580

Mingw uses the Windows API, and Windows doesn't provide a conforming version of the `vswprintf` function used to implement `to_string`, blame Microsoft.

If you use a (very) recent version of the mingw-w64 fork and the unreleased 4.8 version of GCC then it will work, but you're outta luck with the main mingw32 and GCC 4.7.1

If you're willing to patch your implementation you could try the solution given at [http://tehsausage.com/mingw-to-string](http://tehsausage.com/mingw-to-string) but read the caveats carefully.

**Update:**

It seems that only `std::to_wstring` is affected by the broken `vswprintf` function, so I've made a change for GCC 4.9.3 (and later versions) which will define `std::stoi`, `std::stod`, `std::to_string` etc. for MinGW, and just leave `to_wstring` undefined.

If you want to edit the 4.7.1 header yourself, here's the relevant patch:

```
--- a/home/jwakely/gcc/4.7.1/include/c++/4.7.1/bits/basic_string.h
+++ b/home/jwakely/gcc/4.7.1/include/c++/4.7.1/bits/basic_string.h.fix
@@ -2808,8 +2808,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION
 _GLIBCXX_END_NAMESPACE_VERSION
 } // namespace

-#if (defined(__GXX_EXPERIMENTAL_CXX0X__) && defined(_GLIBCXX_USE_C99) \
-     && !defined(_GLIBCXX_HAVE_BROKEN_VSWPRINTF))
+#if (defined(__GXX_EXPERIMENTAL_CXX0X__) && defined(_GLIBCXX_USE_C99)

 #include <ext/string_conversions.h>

@@ -2959,6 +2958,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION
   stold(const wstring& __str, size_t* __idx = 0)
   { return __gnu_cxx::__stoa(&std::wcstold, "stold", __str.c_str(), __idx); }

+#ifndef _GLIBCXX_HAVE_BROKEN_VSWPRINTF
   // DR 1261.
   inline wstring
   to_wstring(int __val)
@@ -3021,6 +3021,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION
                                            L"%Lf", __val);
   }
 #endif
+#endif

 _GLIBCXX_END_NAMESPACE_VERSION
 } // namespace 
```

# java - GridBagLayout 面板对齐

> ID：14755487
> 
> 赞同：8
> 
> 时间：2013-02-07T16:02:25.703
> 
> 标签：java, swing, jpanel, gridbaglayout

我对 GridBag 布局管理器有一点问题。我正在尝试显示 9 个这样的面板：

![理想布局 - 图解](../Images/80b716cc41cd2a2a81833021df5ad5cd.png)

为此，我像这样分隔网格：

![进行中的工作 - 图解](../Images/da0d2384ea2937ad076cf7639a53b100.png)

对于面板 1 到 7，没有问题，它们会按照我的意愿显示。但问题始于面板`S8`和`S9`. 如您所见，`S8`and`S9`占据了一半的帧，但我不能让它像这样显示。`S8`开头的结尾`S4`和`S9`结尾的开头`S4`，我无法处理半个空格。

我想出的唯一方法是将`S8`and`S9`面板放在另一个面板中，该面板占据所有框架宽度 - 但肯定必须有一种正确的方法来显示这两个面板而不将它们放在另一个面板中！

这是代码：

```
workzone.setLayout(new GridBagLayout());
GridBagConstraints c = new GridBagConstraints();
c.anchor = GridBagConstraints.NORTHWEST;
c.fill = GridBagConstraints.BOTH;
c.weightx = 0.5;
c.weighty = 0.5;
c.insets = new Insets(0,0,0,0);

//S1
c.gridx = 0;
c.gridy = 0;
c.gridwidth = 2;
c.gridheight = 2;
workzone.add(S1, c);

//S2
c.gridx = 2;
c.gridy = 0;
c.gridwidth = 2;
c.gridheight = 1;
workzone.add(S2, c);

//S3
c.gridx = 2;
c.gridy = 1;
c.gridwidth = 2;
c.gridheight = 1;
workzone.add(S3, c);

//S4
c.gridx = 4;
c.gridy = 0;
c.gridwidth = 2;
c.gridheight = 2;
workzone.add(S4, c);

//S5
c.gridx = 7;
c.gridy = 0;
c.gridwidth = 1;
c.gridheight = 1;
workzone.add(S5, c);

//S6
c.gridx = 7;
c.gridy = 1;
c.gridwidth = 2;
c.gridheight = 1;
workzone.add(S6, c);

//S7
c.gridx = 8;
c.gridy = 0;
c.gridwidth = 2;
c.gridheight = 2;
workzone.add(S7, c);

//S8
c.gridx = 0;
c.gridy = 2;
c.gridwidth = 5;
c.gridheigth = 1;
workzone.add(S8, c);

//S9
c.gridx = 6;
c.gridy = 2;
c.gridwidth = 5;
c.gridheight = 1;
workzone.add(S9, c); 
```

欢迎任何想法和建议！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T18:41:33.360

好问题。我花了一点时间来破解它，但我明白了。通常，我会将第 1-7 节放在顶部面板中，将第 8-9 节放在底部面板中，但我喜欢使用 GBL 来挑战 1 个面板。[无聊的]

问题是第 4 节（列索引 4 和 5）没有为 GBL 明确定义，因此第 8 节不知道要覆盖它的第五列（索引 4）多远，所以它在列索引之后停止3.

因此，我在构成第 4 部分的列中添加了 2 个零高度垫片，它起作用了。注释掉标记为 SPACERS 的 2 行以了解我的意思：

**编辑**：添加了@SheridanVespo 建议的修复

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class GridBagDemo2 implements Runnable
{
  private Color[] colors = {Color.BLACK, Color.BLUE, Color.CYAN, Color.GRAY,
                            Color.GREEN, Color.MAGENTA, Color.ORANGE,
                            Color.PINK, Color.RED, Color.YELLOW};

  private JPanel panel;
  private GridBagConstraints gbc;

  public static void main(String[] args)
  {
    SwingUtilities.invokeLater(new GridBagDemo2());
  }

  public void run()
  {
    panel = new JPanel(new GridBagLayout());
    gbc = new GridBagConstraints();

    add(0,0, 2,2, "1");
    add(2,0, 2,1, "2");
    add(2,1, 2,1, "3");
    add(4,0, 2,2, "4");
    add(6,0, 2,1, "5");
    add(6,1, 2,1, "6");
    add(8,0, 2,2, "7");
    add(0,2, 5,1, "8");
    add(5,2, 5,1, "9");

    // SPACERS: define the 2 columns that is section "4"
    add(4,3, 1,1, "");
    add(5,3, 1,1, "");

    JFrame frame = new JFrame("Grig Bag");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().add(panel);
    frame.pack();
    frame.setVisible(true);
  }

  private void add(int x, int y, int colspan, int rowspan, String name)
  {
    gbc.gridx = x;
    gbc.gridy = y;
    gbc.gridwidth = colspan;
    gbc.gridheight = rowspan;
    gbc.weightx = .1;
    gbc.weighty = .1;
    gbc.anchor = GridBagConstraints.CENTER;
    gbc.fill = GridBagConstraints.BOTH;

    // using another panel for illustrative purposes only
    JPanel p = new JPanel();

    if (!name.equals(""))
    {
      gbc.weightx = 1;                          // @SheridanVespo fix
      int index = Integer.parseInt(name);
      JLabel label = new JLabel("Panel " + name);
      p.add(label);
      p.setBackground(colors[index]);
      panel.add(p, gbc);
    }
    else
    {
      gbc.weightx = 0.5;                        // @SheridanVespo fix
      gbc.weighty = 0;  // don't allow the spacer to grow 
      gbc.fill = GridBagConstraints.NONE;
      panel.add(Box.createHorizontalGlue(), gbc);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T02:34:48.550

公认的[答案](https://stackoverflow.com/a/14758551/230513)很有吸引力，但随着框架的大小调整，它会导致第 4 部分比侧面板加宽得更快。此变体将面板 8 和 9 放置在 a 的单独子面板中`BoxLayout`。

![图片](../Images/038372426fecd53279a2761105229c4a.png)

```
import java.awt.*;
import javax.swing.*;

/** @see https://stackoverflow.com/q/14755487/261156 */
public class GridBagDemo implements Runnable {

    private JPanel panel;

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new GridBagDemo());
    }

    @Override
    public void run() {
        JFrame frame = new JFrame("GridBag");
        frame.setLayout(new BoxLayout(frame.getContentPane(), BoxLayout.Y_AXIS));
        panel = new JPanel(new GridBagLayout());
        add(1, 0, 0, 1, 2);
        add(2, 1, 0, 1, 1);
        add(3, 1, 1, 1, 1);
        add(4, 2, 0, 1, 2);
        add(5, 3, 0, 1, 1);
        add(6, 3, 1, 1, 1);
        add(7, 4, 0, 1, 2);
        frame.add(panel);
        panel = new JPanel(new GridBagLayout());
        add(8, 0, 0, 1, 1);
        add(9, 1, 0, 1, 1);
        frame.add(panel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    private void add(int i, int x, int y, int w, int h) {
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.gridx = x;
        gbc.gridy = y;
        gbc.gridwidth = w;
        gbc.gridheight = h;
        gbc.weightx = .1;
        gbc.weighty = .1;
        gbc.anchor = GridBagConstraints.CENTER;
        gbc.fill = GridBagConstraints.BOTH;
        JPanel p = new JPanel();
        p.setBorder(BorderFactory.createEmptyBorder(8, 8, 8, 8));
        p.add(new JLabel("Panel " + i));
        p.setBackground(Color.getHSBColor((i - 1) / 9f, 0.75f, 0.95f));
        panel.add(p, gbc);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T16:25:08.943

我从来都不是 GridBagLayout 的忠实粉丝。所以对我来说，我会将您的 GUI 分解为多个面板，并且可能会使用多个 GridLayout 来实现您想要的。就像是：

```
JPanel top = new JPanel( new GridLayout(0, 5) );
top.add(s1);
JPanel s23 = new JPanel( new GridLayout(2, 0) );
s23.add(s2);
s23.add(s3);
top.add(s23);
...

JPanel bottom = new JPanel( new GridLayout(0, 2) );
bottom.add(s8);
bottom.add(s9);

JPanel main = new JPanel( appropriate layout manager );
main.add(top);
main.add(bottom); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-07T17:48:25.490

对于最后两个`JPanel`，我建议您只需将它们添加到新`JPanel`的 with`GridLayout`并将其设置`JPanel`为`GridLayout`on 到`JPanel`具有`GridBagLayout`. 请看一下代码示例，它实际上产生了与您期望的相同的输出：

```
import javax.swing.*;
import java.awt.*;

/**
 * Created with IntelliJ IDEA.
 * User: Gagandeep Bali
 * Date: 2/7/13
 * Time: 10:34 PM
 * To change this template use File | Settings | File Templates.
 */
public class GridBagExample
{
    private JPanel contentPane, footerPanel;
    private JPanel s1, s2, s3, s4, s5, s6, s7, s8, s9;

    private void displayGUI()
    {
        JFrame frame = new JFrame("GridBagLayout Example");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        contentPane = new JPanel();
        contentPane.setLayout(new GridBagLayout());
        GridBagConstraints gbc = new GridBagConstraints();
        /*
         * Constraints for S1 JPanel.
         */
        gbc.anchor = GridBagConstraints.CENTER;
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.fill = GridBagConstraints.BOTH;
        gbc.gridwidth = 1;
        gbc.gridheight = 2;
        gbc.weightx = 0.2;
        gbc.weighty = 0.8;
        s1 = new JPanel(new GridBagLayout());
        s1.setOpaque(true);
        s1.setBackground(Color.BLUE);
        s1.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s1Label = new JLabel("S1", JLabel.CENTER);
        s1.add(s1Label);
        contentPane.add(s1, gbc);

        /*
         * Constraints for S2 JPanel.
         */
        gbc.weighty = 0.4;
        gbc.gridx = 1;
        gbc.gridheight = 1;
        s2 = new JPanel(new GridBagLayout());
        s2.setOpaque(true);
        s2.setBackground(Color.GREEN);
        s2.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s2Label = new JLabel("S2", JLabel.CENTER);
        s2.add(s2Label);
        contentPane.add(s2, gbc);

        /*
         * Constraints for S3 JPanel.
         */
        gbc.gridy = 1;
        s3 = new JPanel(new GridBagLayout());
        s3.setOpaque(true);
        s3.setBackground(Color.CYAN);
        s3.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s3Label = new JLabel("S3", JLabel.CENTER);
        s3.add(s3Label);
        contentPane.add(s3, gbc);

        /*
         * Constraints for S4 JPanel.
         */
        gbc.weighty = 0.8;
        gbc.gridx = 2;
        gbc.gridy = 0;
        gbc.gridheight = 2;
        s4 = new JPanel(new GridBagLayout());
        s4.setOpaque(true);
        s4.setBackground(Color.WHITE);
        s4.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s4Label = new JLabel("S4", JLabel.CENTER);
        s4.add(s4Label);
        contentPane.add(s4, gbc);

        /*
         * Constraints for S5 JPanel.
         */
        gbc.weighty = 0.4;
        gbc.gridx = 3;
        gbc.gridheight = 1;
        s5 = new JPanel(new GridBagLayout());
        s5.setOpaque(true);
        s5.setBackground(Color.RED);
        s5.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s5Label = new JLabel("S5", JLabel.CENTER);
        s5.add(s5Label);
        contentPane.add(s5, gbc);

        /*
         * Constraints for S6 JPanel.
         */
        gbc.gridy = 1;
        s6 = new JPanel(new GridBagLayout());
        s6.setOpaque(true);
        s6.setBackground(Color.MAGENTA);
        s6.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s6Label = new JLabel("S6", JLabel.CENTER);
        s6.add(s6Label);
        contentPane.add(s6, gbc);

        /*
         * Constraints for S7 JPanel.
         */
        gbc.gridheight = 2;
        gbc.weighty = 0.8;
        gbc.gridx = 4;
        gbc.gridy = 0;
        s7 = new JPanel(new GridBagLayout());
        s7.setOpaque(true);
        s7.setBackground(Color.ORANGE);
        s7.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s7Label = new JLabel("S7", JLabel.CENTER);
        s7.add(s7Label);
        contentPane.add(s7, gbc);

        footerPanel = new JPanel();
        footerPanel.setLayout(new GridLayout(1, 2, 5, 5));

        s8 = new JPanel(new GridBagLayout());
        s8.setOpaque(true);
        s8.setBackground(Color.PINK);
        s8.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s8Label = new JLabel("S8", JLabel.CENTER);
        s8.add(s8Label);
        footerPanel.add(s8);

        s9 = new JPanel(new GridBagLayout());
        s9.setOpaque(true);
        s9.setBackground(Color.YELLOW);
        s9.setBorder(BorderFactory.createLineBorder(Color.DARK_GRAY, 5));
        JLabel s9Label = new JLabel("S9", JLabel.CENTER);
        s9.add(s9Label);
        footerPanel.add(s9, gbc);

        /*
         * Constraints for Footer JPanel.
         */
        gbc.gridheight = 1;
        gbc.gridwidth = 5;
        gbc.weightx = 1.0;
        gbc.weighty = 0.2;
        gbc.gridx = 0;
        gbc.gridy = 2;
        contentPane.add(footerPanel, gbc);

        frame.setContentPane(contentPane);
        frame.pack();
        //frame.setSize(500, 500);
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new GridBagExample().displayGUI();
            }
        });
    }
} 
```

这是上述代码的输出：

![GridBagLayout 示例](../Images/f70baab8833e0fa7bb80863997089f6d.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-07T16:26:20.923

通常，我按 Y、X 位置顺序创建和添加 GridBagLayout 的组件。我不知道这是否是必需的，但它使我更容易诊断问题。

这是我为您的网格提出的建议。

```
Component   xPosition   yPosition   xWidth   yHeight
---------   ---------   ---------   ------   -------
S1              0           0          2        2
S2              2           0          2        1
S4              4           0          2        2
S5              6           0          2        1
S7              8           0          2        2
S8              0           2          5        1
S3              2           2          2        1
S9              5           2          5        1
S6              6           2          2        1 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-07T16:28:07.777

对于 S9 组件，您的代码是

```
//S9
c.gridx = 6;
c.gridy = 2;
c.gridwidth = 5;
c.gridheight = 1;
workzone.add(S9, c); 
```

由于坐标系从 0 而不是 1 开始，我建议代码为

```
//S9
c.gridx = 5; // I changed this
c.gridy = 2;
c.gridwidth = 5;
c.gridheight = 1;
workzone.add(S9, c); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-07T18:27:44.007

我试过用`BorderLayout`它来检查它是如何工作的。但只是在这里发布.. :) 这个过程在彼此内部使用多个面板。如果这个例子很舒服，你可以尝试这种方法。

![使用边框布局](../Images/b22822a41cc5a332f1131de031952a9b.png)

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.awt.FlowLayout;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.border.LineBorder;

public class BorderAndGridBag {
    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                new GridWithBorder().createUI();
            }
        };

        EventQueue.invokeLater(r);
    }
}

class GridWithBorder {
    public void createUI() {
        JFrame frame = new JFrame();

        JPanel motherPanel = new JPanel(new BorderLayout());

        JPanel topPanel = new  JPanel();
        topPanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel bottomPanel = new JPanel(new BorderLayout());
        bottomPanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel topLeftPanel = new JPanel();
        topLeftPanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel topRightPanel = new JPanel();
        topRightPanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel topMiddlePanel = new JPanel();
        topMiddlePanel.add(new JLabel("Top Middle"));
        topMiddlePanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel bottomLeftPanel = new JPanel();
        bottomLeftPanel.add(new JLabel("Bottom Left"));
        bottomLeftPanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel bottomRightPanel = new JPanel();
        bottomRightPanel.add(new JLabel("Bottom Right"));
        bottomRightPanel.setBorder(LineBorder.createBlackLineBorder());

        JPanel topLeftLeft = new JPanel();
        topLeftLeft.add(new JLabel("Top Left"));
        topLeftLeft.setBorder(LineBorder.createBlackLineBorder());

        JPanel topLeftRight = new JPanel(new BorderLayout());

        JPanel topLeftRightTop = new JPanel();
        topLeftRightTop.add(new JLabel("Top Left's Right Top"));
        topLeftRight.setBorder(LineBorder.createBlackLineBorder());

        JPanel topLeftRightBottom = new JPanel();
        topLeftRightBottom.add(new JLabel("Top Left's Right Bottom"));

        JPanel topRightLeft = new JPanel(new BorderLayout());
        topRightLeft.setBorder(LineBorder.createBlackLineBorder());

        JPanel topRightRight = new JPanel();
        topRightRight.add(new JLabel("Top Right Right"));
        topRightRight.setBorder(LineBorder.createBlackLineBorder());

        JPanel topRightLeftTop = new JPanel();
        topRightLeftTop.add(new JLabel("Top Right Left Top"));

        JPanel topRightLeftBottom = new JPanel();
        topRightLeftBottom.add(new JLabel("Top Right Left Bottom"));

        topLeftPanel.add(topLeftLeft, BorderLayout.WEST);

        // Top panel sub alignment.
        topLeftPanel.add(topLeftRight, BorderLayout.EAST);
        topLeftRight.add(topLeftRightTop, BorderLayout.NORTH);
        topLeftRight.add(topLeftRightBottom, BorderLayout.CENTER);

        topRightLeft.add(topRightLeftTop, BorderLayout.NORTH);
        topRightLeft.add(topRightLeftBottom, BorderLayout.SOUTH);
        topRightPanel.add(topRightLeft, BorderLayout.WEST);
        topRightPanel.add(topRightRight, BorderLayout.EAST);

        // Top Panel main alignment.
        topPanel.add(topLeftPanel, BorderLayout.WEST);
        topPanel.add(topMiddlePanel, BorderLayout.CENTER);
        topPanel.add(topRightPanel, BorderLayout.EAST);

        // Bottom Panel main alignment.
        bottomPanel.add(bottomLeftPanel, BorderLayout.WEST);
        bottomPanel.add(bottomRightPanel, BorderLayout.EAST);

        motherPanel.add(topPanel, BorderLayout.NORTH);
        motherPanel.add(bottomPanel, BorderLayout.CENTER);

        frame.add(motherPanel);
        frame.pack();
        frame.setTitle("Layout Manager");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
    }
} 
```

# javafx-2 - 一个简单的 JavaFX 2.x 动画任务

> ID：14755492
> 
> 赞同：0
> 
> 时间：2013-02-07T16:02:38.277
> 
> 标签：javafx-2

我在 FlashProfessional (CS 6) 中做过动画，顺便说一句，这很糟糕（不断崩溃而不保存最后的修改，产生巨大的文件，工作不一致等等）。我很难弄清楚如何在 JavaFX 2.x 中完成以下简单任务（可能是因为我的背景是在 Flash 中）：一个矩形，存在于从 t=0 到 t=100 的恒定位置，然后它从场景中删除。

在 Flash 中，我可以在 t=0 创建一个关键帧，在其中绘制一个矩形。然后我在 t=100 创建第二个关键帧，其中矩形被删除。就这么简单。

在 JavaFX 中，为什么我不能只写`timeline.getKeyFrames().addAll(new KeyFrame(new Duration(100), new Rectangle(10, 10, 25, 25)));`或喜欢。

请帮助我并提供代码。我迷失在这些 KeyValues 和 Java 属性中，为什么我仍然需要它们……</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T07:39:19.130

要完成该任务，您可以在 100 毫秒后删除矩形。与 Flash 不同，JavaFX 不是基于关键帧构建的——它们是可选功能，仅在您需要真正的动画时使用，例如对象的缩放。有关更多信息，请参阅下一个教程：http: [//docs.oracle.com/javafx/2/animations/jfxpub-animations.htm](http://docs.oracle.com/javafx/2/animations/jfxpub-animations.htm)

并演示代码：

```
public void start(Stage primaryStage) {
    final Rectangle rect1 = new Rectangle(10, 70, 50, 50);
    final Rectangle rect2 = new Rectangle(10, 150, 50, 50);

    Button btn = new Button("Play");
    btn.setOnAction(new EventHandler<ActionEvent>() {

        @Override
        public void handle(ActionEvent t) {
            // this "timeline" just call a handler after 500 ms which hides rectangle
            TimelineBuilder.create().keyFrames(new KeyFrame(Duration.millis(500), new EventHandler<ActionEvent>() {

                @Override
                public void handle(ActionEvent t) {
                    rect1.setVisible(false);
                }
            })).build().play();

            // this timeline hides rectangle 2 with animation
            // changing scaleXProperty() from 1 (default) to 0
            TimelineBuilder.create().keyFrames(
                    new KeyFrame(
                        Duration.millis(500), 
                        new KeyValue(rect2.scaleXProperty(), 0))
                    ).build().play();
        }
    });

    Pane root = new Pane();
    root.getChildren().addAll(rect1, rect2, btn);

    Scene scene = new Scene(root, 300, 300);

    primaryStage.setScene(scene);
    primaryStage.show();
} 
```

# javascript - 用画布画线

> ID：14755497
> 
> 赞同：1
> 
> 时间：2013-02-07T16:02:44.573
> 
> 标签：javascript, canvas, internet-explorer-9, html5-canvas

IE9 Canvas 现在支持虚线/点线吗？目前我正在做与以下非常相似的事情：

```
var CP = window.CanvasRenderingContext2D && CanvasRenderingContext2D.prototype;
if (CP && CP.lineTo){
  CP.dashedLine = function(x,y,x2,y2,dashArray){
    if (!dashArray) dashArray=[10,5];
    if (dashLength==0) dashLength = 0.001; // Hack for Safari
    var dashCount = dashArray.length;
    this.moveTo(x, y);
    var dx = (x2-x), dy = (y2-y);
    var slope = dy/dx;
    var distRemaining = Math.sqrt( dx*dx + dy*dy );
    var dashIndex=0, draw=true;
    while (distRemaining>=0.1){
      var dashLength = dashArray[dashIndex++%dashCount];
      if (dashLength > distRemaining) dashLength = distRemaining;
      var xStep = Math.sqrt( dashLength*dashLength / (1 + slope*slope) );
      if (dx<0) xStep = -xStep;
      x += xStep
      y += slope*xStep;
      this[draw ? 'lineTo' : 'moveTo'](x,y);
      distRemaining -= dashLength;
      draw = !draw;
    }
  }
} 
```

发现自：[覆盖画布中虚线/点线的线条描边](https://stackoverflow.com/questions/4576724/dotted-stroke-in-canvas)

这在 IE7、IE8、IE9 兼容模式和 FireFox 中效果很好，但是在 IE9 和 Chrome 中，每条虚线都会绘制一个实线。

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:54:54.677

还有什么不对劲的。它在 Chrome 中运行良好：

```
ctx.beginPath();
ctx.dashedLine(10,10, 100, 100,[4, 4])
ctx.stroke(); 
```

[http://jsfiddle.net/MPg5X/1/](http://jsfiddle.net/MPg5X/1/)

# java - 活动中的处理程序引用，来自服务类

> ID：14755498
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:02:45.543
> 
> 标签：java, android, service, android-activity, handler

我在我的服务类中声明了处理程序 onCreate() 。我的应用在某些情况下会触发此处理程序（ postDelayed 方法）。但是，如果用户有任何机会想要退出我的应用程序，我希望该处理程序停止（在 X 时间执行 - 使用 removeCallBacks()）。我如何获得对在我的活动中声明的处理程序对象的引用，以便我可以调用它的方法？（合适的方式）。这甚至可能吗？

我已经[从 main activity 中检查了 Reference 处理程序对象](https://stackoverflow.com/questions/14182846/reference-handler-object-from-main-activity)，但它不是很有帮助。

我可以通过静态方法获得参考，但这真的是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:05:55.647

如果您已经有一个服务对象（通过`ServiceConnection`），您可以在 Service 中公开一个公共方法，该方法将调用`removeCallBacks`Handler 实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:09:34.670

您不需要在活动中包含处理程序引用，您可以要求服务停止处理程序。

有很多方法可以从最适合您的情况的活动中与您的服务进行通信：

1-调用`startService`并通过`Intent`操作传递给它，例如当服务接收到它时调用的*stopHandler*`removeCallBacks()`

2-用于`LocalBroadcast`向服务发送消息以停止处理程序

您也可以绑定到服务，但这将比以前的方法额外工作

**编辑**

在您的活动中，您可以调用类似

```
Intent intent = new Intent(context,MyService.class);
intent.setAction("stopHandler");
startService(intent); 
```

在您的服务中`onStartCommand`或`onHandleIntent`取决于您的服务类型

```
if(intent.getAction().equals("stopHandler")){
   // call removeCallBacks()
} 
```

对于第二种解决方案，[请参阅此](https://stackoverflow.com/questions/8802157/how-to-use-localbroadcastmanager)

# jquery-ui - JQuery UI多个对话框不起作用

> ID：14755500
> 
> 赞同：0
> 
> 时间：2013-02-07T16:02:51.127
> 
> 标签：jquery-ui, jquery

我有一个带有两个链接的页面，它们打开两个不同的模式，“忘记密码”链接打开“忘记密码”模式，“告诉朋友”链接打开“告诉朋友”模式。

两种模式都包含可以提交的表单。

问题是如果我打开第一个模态并提交或关闭它，我无法提交第二个模态。我可以打开第二个模式，但我不能提交它。

请告知可能是什么问题！

下面是驻留在单独的 javascript 文件中的 javascript 代码，然后将其导入 HTML 文件。它不是内联 javascript，如果这很重要的话。

[代码]

```
var forgottenPasswordDiv;
var tellAFriendDiv;

function clearErrorMessages() {
    $('#errorMessage').text("");        
}

function openForgottenPassword() {
    forgottenPasswordDiv = $('#forgotten-password');
    $('#forgotten-password').load("/Templates/include/new/ajax/modal/forgottenPassword.jsp")
    .dialog(
        {
            autoOpen:false,
            modal:true, 
            position:'left+35% top+20%', 
            width:'330', 
            height:'auto'
        }
    );
    $('#forgotten-password').dialog('open');
}

function closeForgottenPassword() {
    forgottenPasswordDiv.dialog("close");
}

function submitForgottenPassword() {
    clearErrorMessages();
    var email = $('#email').val();
    if (email == null || email == '') {
        $('#errorMessage').text("Please enter your user name or email");
    } else {
        clearErrorMessages();
        /* Ajax Post */
        var formData = $("#forgottenPasswordForm").serialize();
        $.ajax({
            type: "GET",
            url: "/Templates/include/new/ajax/forgottenPassword.jsp", 
            data: formData,
            success: function(data) {
                if (data.error != null) {
                    $("#errorMessage").text(data.error);
                } else {                            
                    $('#forgottenPasswordForm , .info').fadeOut(1000);
                    $("#successMessage").text(data.success);        
                    $("div").removeClass('display-none');
                }
            },
            dataType: 'json'
        });
    }               
}

function openTellAFriend(gunId) {
    tellAFriendDiv = $('#tell-a-friend');
    $('#tell-a-friend').load("/Templates/include/new/ajax/modal/tellAFriend.jsp?id=" + gunId)
    .dialog(
        {
            autoOpen:false,         
            modal:true, 
            position:'center top+10%', 
            width:'330', 
            height:'auto'
        }
    );
    $('#tell-a-friend').dialog('open');
}

function closeTellAFriend() {
    tellAFriendDiv.dialog("close");
}

function submitTellAFriend() {
    clearErrorMessages();
    var yourname = $('#yourname').val();
    var errorMessage = "";
    if (yourname == null || yourname == '') {
        errorMessage += "Please enter your name<br />";                 
    } 

    if (errorMessage != '') { 
        $('#errorMessage').html(errorMessage);
    } else {
        clearErrorMessages();
        /* Ajax Post */
        var formData = $("#tellAFriendForm").serialize();
        $.ajax({
            type: "GET",
            url: "/Templates/include/new/ajax/tellAFriend.jsp", 
            data: formData,
            success: function(data) {
                if (data.error != null) {
                    $("#errorMessage").text(data.error);
                } else {
                    $("#tellAFriendForm").fadeOut(1000);                        
                    $("#successMessage").text(data.success);
                    $("div").removeClass('display-none');
                }
            },
            dataType: 'json'
        });
    }
} 
```

[/代码]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:31:42.937

即使对话框关闭，ui-dialog 小部件仍将作为隐藏元素保留在 DOM 中。因此，为了将您的两个对话功能相互隔离，我建议您致电：

```
forgottenPasswordDiv.dialog("destroy") 
```

在您的“closeForgottenPassword”功能和

```
tellAFriendDiv.dialog("destroy") 
```

在您的“closeTellAFriend”函数中。

这将使对话框返​​回到其预初始化状态（这根本没有害处，因为您在“打开”函数中重新初始化它。）

# php - Ion Auth & Codeigniter：新用户登录时循环重定向

> ID：14755501
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:02:53.827
> 
> 标签：php, mysql, codeigniter, ion-auth

我是 Codeigniter 的常客，已经到了不得不开始查看库以获取登录/忘记密码的地步，所以我决定使用 Ion Auth。

我设置了这个 - 工作正常，尝试了已经设置好的管理员帐户，这很好。

现在，当我以管理员身份登录然后创建新用户时，数据将添加到数据库中，并且页面从“create-user”重定向到欢迎页面。但是，如果我注销并使用这些新详细信息登录，页面会变为空白，并且重新加载栏会变得疯狂！如果有意义，则 url 栏看起来像是进入欢迎页面，但没有加载。

我还检查了我的控制台上的 firebug 和 php 日志错误，什么都没有。

我检查了我的数据库，添加用户后，密码已经过哈希处理，但在 salt 列中它被归类为 NULL，而默认帐户已经设置了哈希码？- 这可能与它有关吗？

编辑：我现在已经更改了代码，但是当它没有被触及时仍然没有工作，所以只有代码中的编辑是删除表，而在身份验证控制器中，功能是登录、创建用户和注销。

当 admin@admin.com 用户登录时，它会加载页面，就像其他“新”帐户一样。

谢谢！

```
 //log the user in
    function login() {

        $this->data['title'] = "Login";

        $this->form_validation->set_rules('identity', 'Identity', 'required');
        $this->form_validation->set_rules('password', 'Password', 'required');

        if ($this->form_validation->run() == true) {

            //check for "remember me"
            $remember = (bool) $this->input->post('remember');

            if ($this->ion_auth->login($this->input->post('identity'), $this->input->post('password'), $remember)) {

                //if the login is successful
                //redirect them back to the home page
                $this->session->set_flashdata('message', $this->ion_auth->messages());
                redirect('/', 'refresh');
            }else{
                //if the login was un-successful
                //redirect them back to the login page
                $this->session->set_flashdata('message', $this->ion_auth->errors());
                redirect('auth/login', 'refresh');
            }
        }else{

            //the user is not logging in so display the login page
            $this->data['message'] = (validation_errors()) ? validation_errors() : $this->session->flashdata('message');

            $this->data['identity'] = array('name' => 'identity',
                'id' => 'identity',
                'type' => 'text',
                'value' => $this->form_validation->set_value('identity'),
            );
            $this->data['password'] = array('name' => 'password',
                'id' => 'password',
                'type' => 'password',
            );

            $this->_render_page('auth/login', $this->data);
        }
    }

    //log the user out
    function logout() {

        $this->data['title'] = "Logout";

        $logout = $this->ion_auth->logout();

        $this->session->set_flashdata('message', $this->ion_auth->messages());
        redirect('auth/login', 'refresh');
    }

    //create a new user
    function create_user() {

        $this->data['title'] = "Create User";

        $this->form_validation->set_rules('first_name', 'First Name', 'required|xss_clean');
        $this->form_validation->set_rules('last_name', 'Last Name', 'required|xss_clean');
        $this->form_validation->set_rules('email', 'Email Address', 'required|valid_email');
        $this->form_validation->set_rules('password', 'Password', 'required|min_length[' . $this->config->item('min_password_length', 'ion_auth') . ']|max_length[' . $this->config->item('max_password_length', 'ion_auth') . ']|matches[password_confirm]');
        $this->form_validation->set_rules('password_confirm', 'Password Confirmation', 'required');

        if ($this->form_validation->run() == true) {

            $username = strtolower($this->input->post('first_name')) . ' ' . strtolower($this->input->post('last_name'));
            $email    = $this->input->post('email');
            $password = $this->input->post('password');

            $additional_data = array(
                'first_name' => $this->input->post('first_name'),
                'last_name'  => $this->input->post('last_name')

            );
        }
        if ($this->form_validation->run() == true && $this->ion_auth->register($username, $password, $email, $additional_data)) {
            //check to see if we are creating the user
            //redirect them back to the admin page
            $this->session->set_flashdata('message', $this->ion_auth->messages());
            redirect("auth/login", 'refresh');
        }else{
            //display the create user form
            //set the flash data error message if there is one
            $this->data['message'] = (validation_errors() ? validation_errors() : ($this->ion_auth->errors() ? $this->ion_auth->errors() : $this->session->flashdata('message')));

            $this->data['first_name'] = array(
                'name'  => 'first_name',
                'id'    => 'first_name',
                'type'  => 'text',
                'value' => $this->form_validation->set_value('first_name'),
            );
            $this->data['last_name'] = array(
                'name'  => 'last_name',
                'id'    => 'last_name',
                'type'  => 'text',
                'value' => $this->form_validation->set_value('last_name'),
            );
            $this->data['email'] = array(
                'name'  => 'email',
                'id'    => 'email',
                'type'  => 'text',
                'value' => $this->form_validation->set_value('email'),
            );
            $this->data['password'] = array(
                'name'  => 'password',
                'id'    => 'password',
                'type'  => 'password',
                'value' => $this->form_validation->set_value('password'),
            );
            $this->data['password_confirm'] = array(
                'name'  => 'password_confirm',
                'id'    => 'password_confirm',
                'type'  => 'password',
                'value' => $this->form_validation->set_value('password_confirm'),
            );

            $this->_render_page('auth/create_user', $this->data);
        }
    }

    function _render_page($view, $data=null, $render=false) {

        $this->viewdata = (empty($data)) ? $this->data: $data;

        $view_html = $this->load->view($view, $this->viewdata, $render);

        if (!$render) return $view_html;
    }

} 
```

**欢迎页面控制器**

```
class Welcome extends CI_Controller {

    function __construct() {

        parent::__construct();
        $this->load->library('ion_auth');
        $this->load->library('session');
        $this->load->library('form_validation');
        $this->load->helper('url');
    }

        public function index() {

        if (!$this->ion_auth->logged_in()) {
            redirect('auth/login', 'refresh');

        }elseif (!$this->ion_auth->is_admin()) {
            redirect('/', 'refresh');
        }else{
            $this->data['message'] = (validation_errors()) ? validation_errors() : $this->session->flashdata('message');
            $this->_render_page('auth/welcome', $this->data);
        }
    }
} 
```

已解决：这是 Google Chrome 的一个错误，我必须更新系统和浏览器。此外，为了存储 SALT，我更改了 ion_auth 配置文件中的一些设置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T12:36:38.207

这是 Google Chrome 的一个错误，我必须更新系统和浏览器。此外，为了存储 SALT，我更改了 ion_auth 配置文件中的一些设置

# eclipse - gradle eclipse 集成 -

> ID：14755502
> 
> 赞同：4
> 
> 时间：2013-02-07T16:02:59.773
> 
> 标签：eclipse, gradle

我正在使用 eclipse 4.2 发行版，并从 springsource 安装了 gradle eclipse 集成插件。

当我最初尝试使用向导创建一个快速 java 项目时，我收到以下错误：

```
Unable to start the daemon process.
This problem might be caused by incorrect configuration of the daemon.
For example, an unrecognized jvm option is used.
Please refer to the user guide chapter on the daemon at C:\devtools\gradle-1.4\docs\userguide\gradle_daemon.html
Please read below process output to find out more:
-----------------------
Error occurred during initialization of VM
Could not reserve enough space for object heap
Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit.

Could not fetch model of type 'HierarchicalEclipseProject' using Gradle installation 'C:\devtools\gradle-1.4'. 
```

当我`gradle build`在命令行中运行时，一切都很好。

有什么想法可以让这个工作吗？

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T08:58:45.837

由于您可以在命令行中成功运行 gradle，因此您需要尝试在 eclipse 插件中使用该 gradle。

设置`Preference -> Gradle -> Gradle Distribution -> Folder`为您自己运行良好的 gradle 发行版。

# colorbox - 带有 html5bp 的颜色框

> ID：14755503
> 
> 赞同：0
> 
> 时间：2013-02-07T16:02:59.977
> 
> 标签：colorbox, viewport

我无法弄清楚为什么来自 html5bp 的视口行会导致颜色框出现问题。当我使用 iPhone 4 查看时出现问题。弹出模式中的 YouTube 视频对于屏幕来说太大了。在桌面上一切都很好。

```
<meta name="viewport" content="width=device-width; initial-scale=1.0;"> 
```

如果我不使用这条线，我的彩盒模式效果很好。但是，我的页面不适用于移动设备。

如果我包含这一行，我的颜色框模式对于屏幕来说太大了。

以下是显示这两种行为的示例链接：

[http://ivantown.com/cbtest/good.html](http://ivantown.com/cbtest/good.html)

[http://ivantown.com/cbtest/bad.html](http://ivantown.com/cbtest/bad.html)

这是代码：

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

   <meta name="viewport" content="width=device-width; initial-scale=1.0;">

<title>colorbox youtube</title>
<link rel="stylesheet" type="text/css" href="colorbox.css" /> 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="jquery.colorbox-min.js"></script> 
<script>
$(document).ready(function(){
$(".youtube").colorbox({iframe:true, innerWidth:640, innerHeight:464});
});
</script> 
</head>

<body>

<h2>colorbox youtube</h2>

<a class="youtube" href="https://www.youtube.com/embed/C0DPdy98e4c?autoplay=1">Link1</a>

</body>
</html> 
```

谢谢你的帮助。来自社区的长期恩人，但第一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:53:35.533

你的问题在这里

```
$(document).ready(function(){
$(".youtube").colorbox({iframe:true, innerWidth:640, innerHeight:464});
}); 
```

如果您注意您的代码，您将颜色框的 innerWith 指定为 640 像素。**(innerWidth:640, innerHeight:464)** iPhone 纵向宽度为 320px。这就是为什么它正在运行。

所以你有两个选择：你可以将宽度和高度设置为百分比，或者使用 javascript 检测用户是在桌面还是移动设备上，并相应地设置宽度和高度。

# php - 指定字段中的整数个数

> ID：14755504
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:03:11.817
> 
> 标签：php, javascript, mysql

我正在做一个注册表单页面，我也应该在其中输入“电话”输入，但我需要电话字段为 8 位数字！！！如果用户输入的数字多于或少于 8 位，则注册表单会告诉他一个错误。

我认为应该是这样的......连接到数据库后

```
 $telephone=$_POST['telephone'];
  ... 
  .... 
  if(empty($telephone)){ // **i think i should write smth here???**
  echo  "phone number not set, and should be 8 digits!!" ;
  }
  else{

  /* Now we will write a query to insert user details into database */
  $insert_user=mysql_query("INSERT INTO login (telephone) VALUES ('$telephone')"); 
```

我感谢任何帮助:) 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:07:25.537

首先：并非所有电话号码都是8位数字。所以你不应该那么严格地强迫它。

对于电话号码的合理验证，此线程中有许多很好的答案：[电话号码验证的综合正则表达式](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)

就个人而言，您真的不应该在生产代码中使用多个感叹号。读“！！” 对用户和其他开发人员来说有点……令人不安。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:15:29.230

要确保输入仅是 X 个数字：

```
// replace everything that is not in the range 0-9
$telephone = preg_replace('/[^0-9]/', '', $telephone);
// now check the remaining length - for this example 8
if (strlen($telephone) != 8) {
    // throw your error code in here
} else { ... 
```

请记住，您确定电话号码只需要 8 位数字吗？没有破折号、逗号或括号，不再是数字（美国/加拿大数字为 10，不包括国际代码），一些国家/地区的数字更长/更短。

但就您的问题而言，如发布的那样，上述两个步骤将满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:26:13.367

可以设置文本输入字段的最大长度。

```
<input maxlength="8"> 
```

确保您使用至少 8 个字符

```
if(strlen($telephone) != 8){ error.. } 
```

另外验证您只收到了数字而不是您可以使用的字符

```
for($i=0; $i<8; $i++){
if{(ord($telephone[$i]>47)&&(ord$telephone[$i]<58)){ // its a number } 
```

# sql-server - Select top percent, in SQL Server, is off by 1?

> ID：14755510
> 
> 赞同：2
> 
> 时间：2013-02-07T16:03:25.747
> 
> 标签：sql-server, sql-server-2005

我想使用 select 语句从 3661 记录表中获取 10%。但是我得到了 367 条记录，但我只想要 366 条记录；但是当我投入 50% 时，我想获得 1831 条记录，而不是 1830 条记录。这是我使用的声明：

```
SELECT top 10 percent *
FROM table_a 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T16:05:21.877

不幸的是，这就是该[`TOP x PERCENT`子句](http://msdn.microsoft.com/en-us/library/ms189463.aspx)的工作方式（突出显示相关部分）：

> 百分
> 
> 指示查询仅返回结果集中第一个表达式百分比的行。**小数值向上舍入到下一个整数值。**

如果您想要不同的舍入方案，则必须自己进行计算：

```
SELECT TOP (SELECT COUNT(*) / 10 FROM table_a) * FROM table_a 
```

这将使用整数除法，它会[截断小数部分](http://msdn.microsoft.com/en-us/library/ms175009.aspx)，即向下舍入。

由于您希望 3661 的 50% 产生 1831，我猜您想要“*四舍五入*”，您可以使用以下[`ROUND`函数](http://msdn.microsoft.com/en-us/library/ms175003.aspx)获得：

```
SELECT TOP (SELECT CONVERT(int, ROUND(COUNT(*) / 10.0, 0)) FROM table_a) * FROM table_a 
```

请注意，要强制进行浮点除法而不是整数除法`10.0`，则需要代替。`10`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:09:30.960

以下是 MSDN Page for SQL Server 2012 [TOP PERCENT 参数的描述：](http://msdn.microsoft.com/en-us/library/ms189463.aspx)

> 指示查询仅返回结果集中第一个表达式百分比的行。小数值向上舍入到下一个整数值。

但是，[TOP 页面的 SQL Server 2005 版本](http://msdn.microsoft.com/en-us/library/ms189463%28v=sql.90%29.aspx)不包括关于小数值被四舍五入的第二句。我会假设行为是相同的（部分基于你的轶事证据），MSDN 添加它是因为人们询问/抱怨这种行为。

# jquery - ahref 链接模拟和触发 keypress/keydown

> ID：14755513
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:03:32.810
> 
> 标签：jquery, jquery-plugins

我在做什么是当我点击一个链接时，它会触发一个按键。例如，当我单击一个链接时，它实际上会执行 ctrl + = ，即 keycode 17 和 187 一起。我有尝试但没有运气，不成功。

```
var press = jQuery.Event("keydown");
press.ctrlKey = true;
press.which = 187;
$("#resize").click(function(e){
    e.trigger(press);
    e.preventDefault();
}); 
```

或者任何人有更好的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:19:51.260

在事件上触发事件永远不会起作用；-) 改用选择器：

```
var press = jQuery.Event("keydown");
press.ctrlKey = true;
press.which = 187;
$("#resize").click(function(e){
    $(document).trigger(press);
    e.preventDefault();
}); 
```

[演示](http://fiddle.jshell.net/XwjfB/2)

**更新**

既然提问者变得更加[精确](https://stackoverflow.com/questions/14755513/ahref-link-simulate-and-triggering-keypress-keydown/14755829#comment20652726_14755829)了一点。我做了这个**[演示](http://fiddle.jshell.net/XwjfB/6/)**

这足以满足他的需求：[demo](http://jsfiddle.net/XwjfB/8/)

```
var i = 1;
$("#resize").click(function(e){
    $(document.body).css({transform: 'scale(' + (i += 0.1) + ')'});
    // or without css3, maybe:
    // $(document.body).css({zoom: i += 0.1});
    e.preventDefault();
}); 
```

# scala - Scala 泛型子类型

> ID：14755519
> 
> 赞同：3
> 
> 时间：2013-02-07T16:03:39.460
> 
> 标签：scala, generics, types

我迷失在 scala 泛型中。

我需要一个`storeUnit`接受`Unit`' 子类的实例 (eq `Visit`) 并返回`StoredUnit`' 子类的实例 (eq `StoredVisit`) 的方法，但我收到编译错误。

```
trait StatsUnit { val ip: String } 
case class Visit(ip: String) extends StatsUnit
case class Click(ip: String) extends StatsUnit

trait StoredStatsUnit extends StatsUnit { val id: String }
case class StoredVisit(id: String, ip: String) extends StoredStatsUnit
case class StoredClick(id: String, ip: String) extends StoredStatsUnit

def storeUnit[A <: StatsUnit, B <: StoredStatsUnit](statsUnit: A): B = {
  statsUnit match {
    case x: Visit => StoredVisit("myid", x.ip)
    case x: Click => StoredClick("myid", x.ip)
  }
}

/tmp/1.scala:11: error: type mismatch;
 found   : this.StoredVisit
 required: B
    case x: Visit => StoredVisit("myid", x.ip)
                                    ^
/tmp/1.scala:12: error: type mismatch;
 found   : this.StoredClick
 required: B
    case x: Click => StoredClick("myid", x.ip) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:12:56.680

先来个评论：

1.  不要说出你的特质`Unit`！`Unit`在 Scala 中具有特定的含义——它相当于 Java 的`void`——并且遮蔽该定义只会造成麻烦！

但是，这里的问题是您指定您的方法将返回一个实例，`B`然后您尝试返回一些类型`StoredVisit`。在此示例中您根本不需要`B`，因此以下将正常工作：

```
def storeUnit[A <: StatsUnit](unit: A): StoredStatsUnit = {
  StoredVisit("myid", unit.ip)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T17:29:54.360

让我们对编译器撒谎以使代码编译，然后我将展示编译器在抱怨什么。第一的：

```
scala> def storeUnit[A <: StatsUnit, B <: StoredStatsUnit](unit: A): B = {
     |   StoredVisit("myid", unit.ip).asInstanceOf[B]
     | }
storeUnit: [A <: StatsUnit, B <: StoredStatsUnit](unit: A)B 
```

现在让我们创建另一个子类`StoredStatsUnit`：

```
case class UnStoredVisit(id: String, ip: String, n: Int) extends StoredStatsUnit 
```

现在让我们看看为什么编译器会抱怨那个方法定义：

```
scala> val visit: UnStoredVisit = storeUnit(Visit("1.2.3.4"))
java.lang.ClassCastException: StoredVisit cannot be cast to UnStoredVisit 
```

换句话说，您*不会*返回一个参数化的 B ，它是`StoredStatsUnit`. 您正在返回 a `StoredVisit`，它是它的一个特定子类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:14:44.567

`B`是 的子类型`StoredUnit`并且`StoredVisit`是 的子类型，`StoredUnit`但没有`StoredVisit`与 兼容的有效推论`B`。

# javascript - JavaScript 是否有 i18n (Intl) 垫片？

> ID：14755521
> 
> 赞同：19
> 
> 时间：2013-02-07T16:03:43.247
> 
> 标签：javascript, internationalization, ecmascript-5, ecma262, ecmascript-intl

我正在为[ECMAScript Internationalization API](http://www.ecma-international.org/ecma-402/1.0/)寻找垫片。有人知道这样的项目吗？（即使它目前仍在进行中。）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-12-10T10:46:23.407

是的，在 https://github.com/andyearnshaw/Intl.js 上有一个适用于 ECMA-402（又名 ECMA 国际化 API 规范）的[polyfill](https://github.com/andyearnshaw/Intl.js)。

要在 Node.js 应用程序中使用，您可以使用 NPM 安装：

```
npm install intl 
```

它也可用作前端的 Bower 组件：

```
bower install intl 
```

支持`NumberFormat`and `DateTimeFormat`，但不支持`Collator`. 目前，对于客户端浏览器环境，您需要使用单独的函数添加语言环境数据。有关详细信息，请参阅 README.md 文件。

**免责声明：** @AndyE 是`Intl.js`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T14:40:21.557

这个 SO-question 为 javascript 中的 i18n 支持提供了一些框架。[https://stackoverflow.com/questions/9640630/javascript-i18n-internationalization-frameworks-libraries-for-client-side-use](https://stackoverflow.com/questions/9640630/javascript-i18n-internationalization-frameworks-libraries-for-client-side-use)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T17:06:39.080

我假设您知道“Google Chrome 版本 24，目前处于测试阶段，使用 Collat​​or、NumberFormat 和 DateTimeFormat 对象实现 API，如上所述。” （见[这里](http://norbertlindenberg.com/2012/12/ecmascript-internationalization-api/index.html)）。就语言环境覆盖而言，任何垫片要么是巨大的和/或不完整的——你真的想实现卡纳达语数字（这是他们在班加罗尔使用的语言）吗？

我的建议是使用您需要的部件滚动您自己的精简垫片，根据需要从其他执行类似操作的库中挑选和选择。例如，您可能需要日期/时间格式，而不是排序（这很复杂）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-03T09:54:50.430

刚刚发现这个老问题，由于 ECMA-402 实现并非在所有浏览器中都可用，我发现 formatjs.io 的[polyfill](https://formatjs.io/docs/polyfills)在您需要支持 Safari 或 IE 等浏览器时很有用。

# haskell - 如何编写派生类？

> ID：14755525
> 
> 赞同：13
> 
> 时间：2013-02-07T16:03:57.637
> 
> 标签：haskell

我有这个

```
data Something = Something Integer deriving (MyClass, Show)

class MyClass a where   
    hello :: MyClass a => a -> a

instance MyClass Integer where
    hello i = i + 1

main = print . hello $ Something 3 
```

但 MyClass 不可派生。为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-07T16:08:40.333

GHC 不能神奇地为任意数据类型派生实例。但是，它可以利用`newtype`声明为相同的底层类型创建一个新名称的事实来为使用 `GeneralizedNewtypeDeriving`扩展的那些派生实例。所以，你可以这样做：

```
{-# LANGUAGE GeneralizedNewtypeDeriving #-}

newtype Something = Something Integer deriving (MyClass, Show)

class MyClass a where
    hello :: MyClass a => a -> a

instance MyClass Integer where
    hello i = i + 1

main = print . hello $ Something 3 
```

GHC 无法派生新实例的原因是它不知道该实例应该是什么。即使您的数据类型只有一个字段，它也不一定与该字段相同。为`newtype`s 派生实例的能力很方便，因为它们通常用于为某些类型类提供不同的行为，或者作为使用类型系统来分离代码中具有相同类型但用途不同的事物的一种方式。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-07T16:26:59.333

You may want to have a look at the [GHC documentation on Generic Programming](http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/generic-programming.html).
You need to create a class that can work on a generic representation of arbitrary types. I don't think the specific example you gave is reasonable for a derivable class.

# java - 空布局 - 组件在重绘后隐藏

> ID：14755527
> 
> 赞同：0
> 
> 时间：2013-02-07T16:04:07.010
> 
> 标签：java

所以我有一个大面板：setLayout(null)。然后我想给它添加按钮。在大面板的构造函数中，我添加了这样的代码：

```
JButton button = new JButton("eeee");
button.setBounds(100, 100, 100, 50);
add(button); 
```

而且没关系。但是当我重绘大面板按钮时隐藏。当我将鼠标移动到它应该在的位置时它再次出现......如何防止这种奇怪的行为？也许它与我在 constrcutor 中添加按钮的事实有关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:01:15.573

您需要先使用“super.paint (g)”让绘制面板组件，如果不这样做，它不会绘制添加的组件

```
@Override
public void paint(Graphics g){
    super.paint(g); //draw your button as default
    // hear, you can draw others things 

} 
```

# wcf - Azure WCF Webrole 错误：远程服务器返回了意外响应：（413）请求实体太大

> ID：14755529
> 
> 赞同：2
> 
> 时间：2013-02-07T16:04:19.270
> 
> 标签：wcf, azure-web-roles

我有一个 Windows Azure webrole (WCF) 网络服务。我有一种将文件上传到 Window Azure blob 存储的方法。这很好用，但仅适用于小 (< 30 Kb) 文件。

```
<OperationContract()>
Function UploadFileV1(ByVal ApplicationSessionGuid As String, 
                      ByVal UserSessionGuid As String, 
                      ByVal FileContent As Byte(), 
                      ByVal FileName As String, 
                      ByVal FileDescription As String, 
                      ByVal FileDisplayName As String, 
                      ByVal IsPublic As Boolean) As DataSet 
```

如果这部分：`ByVal FileContent As Byte()` 大于 30 Kb，那么我在调用 web 服务时会出错。

远程服务器返回意外响应：(413) 请求实体太大。

如果我在本地运行这个 web 服务并进行调试，我在方法上设置了一个断点，它甚至不会到达那里。

我发现了一些类似的主题，但它们不在 Windows Azure 上下文中。

WCF 项目中的 web.config 非常空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T07:12:48.123

在 (Windows Azure) WCF webrole webservice 的 web.config 的 system.serviceModel 中，您可以添加 basicHTTPBinding。我犯的错误是尝试添加名称，但没有名称似乎是默认值。现在它就像一个魅力。希望其他人遇到这个问题并在这里找到他的答案。我花了四个小时。

```
<bindings>
  <basicHttpBinding>
    <binding maxReceivedMessageSize="2147483647"  maxBufferSize="2147483647" transferMode="Streamed"  >
      <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647"/>
      <security mode="None">
      </security>
    </binding>
  </basicHttpBinding>
</bindings> 
```

# java - Java 全局异常处理程序

> ID：14755530
> 
> 赞同：2
> 
> 时间：2013-02-07T16:04:24.390
> 
> 标签：java

我有一个关于异常处理程序的问题。我的项目有一个结构化代码，其中有许多用于不同目的的包和类。在这段代码中，我尝试在很多地方捕获不同类型的异常。提到其中的一些是`SAXException`, `IOException`, `NumberFormatException`, `ParserConfigurationException`,`RuntimeException`等等。

在我捕获异常的所有情况下，我只打印一个堆栈跟踪。当我遇到异常时，我会从堆栈跟踪中找出它发生的函数并相应地修复它。除了我不打算做任何事情，我也不打算做任何其他事情，因为代码量并不大，而且对我来说很容易调试。

现在，我正在使用第三方开发人员提供的外部 Java 库。这个库为我调用的每个可能的函数抛出异常。我正在尝试在这个库上编写一个包装器以利用它。但是，由于这个库，我在代码中到处都可以找到 try/catch 块。

例如，我的代码如下所示 -

```
Class Wrapper
{
     public void method1()
     { 
         ....
         try
         {
            ...
            third party library calls...
            ... 
         } catch (Exception e) { e.printStackTrace(); }

     }

     public void method2()
     { 
         ....
         try
         {
            ...
            third party library calls...
            ... 
         } catch (Exception e) { e.printStackTrace(); }

     }
     // ... and so on... there are 50-100 methods like this.
     // some are even one-liners.
} 
```

鉴于这种情况，我应该切换到[本讨论](https://stackoverflow.com/questions/1548487/java-global-exception-handler)中提到的全局异常处理程序吗？

这会避免在我的代码中到处写 try/catch 块吗？

另外，我应该删除现有的 try/catch 块吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:17:26.673

如果您不介意程序在任何异常后退出，您可以使用全局异常处理程序。您可能必须将`throws Exception`（或更具体的异常类）放在一大堆地方（以防止未处理的异常编译时错误），这远非理想（最终可能会得到比捕获更少的“漂亮”代码抛出它们的异常）。

另一方面，如果您希望您的程序从错误中恢复（通常在生产级代码中需要），您将需要适当放置 try-catch 语句（这可能涉及在代码中的任何地方都有 try-catch 语句）。

例如，如果您收到 IOException，您可能想要重试，或者如果您收到 NumberFormatException，您可能想要通知用户输入无效并让他/她重试。

你不应该只删除 try-catch 语句，你应该看看他们做了什么，这种行为是否是你想要的，以及它是否可以通过替代解决方案（例如全局 try-catch 语句）重现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:32:53.063

如果您不希望您的客户端代码处理已检查的异常，您可以在包装器中执行以下操作。

```
public void method1() {
     try {
        //3rd party code here....
     }
     catch(RuntimeException e){
         throw e;
     }
     catch(Exception e){
       throw new RuntimeException(e.getMessage(),e);
     }
} 
```

请注意，这避免了吞下 3rd 方库抛出的异常，并且不会强制客户端处理 Checked`IOException`等异常`SQLException`。

# java - Java中如何引用BeanEditForm(tapestry5)中使用的bean的属性？

> ID：14755531
> 
> 赞同：0
> 
> 时间：2013-02-07T16:04:37.010
> 
> 标签：java, selection, tapestry

我的 .tml 文件中有这样的内容：

```
<t:beaneditform t:id="adForm" object="editableAd"
                        reorder="actiontype,shops,movies,streams,widgets" .... 
```

我的问题是如何访问（引用）**actionType**，它是 .java 文件中的 Enum （实际上是 SELECT ）？当用户更改此选择（下拉）的值时，我只需要处理事件，显然是在提交表单本身之前。

如果这样的事情对我有用......

```
@OnEvent(component = "adForm.actionType", value=EventConstants.VALUE_CHANGED)
    public void actionTypeValueChanged(String value) {
      log.info("value is: " + value);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:54:01.037

要在客户端使用**Select** html 组件中的更改值进行更新，请在模板文件中使用带有`t:zone`属性的挂毯选择组件（即，在您的情况下，它可以指向任何虚拟区域，只需要正确设置如果您需要在更改值时更新区域）

还要`t:value`在 page\component java 文件中将属性设置为 enum 变量，通常这个变量会用 Tapestry 的`@Property`.

例子：

```
<t:select t:id="myEnumVariable" t:zone="dummyZone" t:value="myEnumVariable"/> 
```

`myEnumVariable`用于引用您的类的变量并充当 ID（即，实际字符串**myEnumVariable**用作 id），这不是必需的，但这样更具可读性和可维护性）

```
public class MyClass{
    @Property
    private MyEnum myEnumVariable;

    @OnEvent(component = "myEnumVariable", value=EventConstants.VALUE_CHANGED)
    public void actionTypeValueChanged(**MyEnum** newValue) {
        this.myEnumVariable = newValue; // <<<<<<
        log.info("value is: " + myEnumVariable );
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T13:52:22.530

如果您不介意将 ChenilleKit 框架用于挂毯，您可以尝试使用该框架的[OnEvent mixin](http://chenillekit.codehaus.org/chenillekit-tapestry/ref/org/chenillekit/tapestry/core/mixins/OnEvent.html)。

您会在我分享的链接上找到示例，但基本上您在选择标签中添加了两个属性：

```
<t:select t:id="myselect" ... t:mixins="ck/OnEvent" t:event="change" /> 
```

然后在你的 java 类上添加事件处理程序：

```
@OnEvent(component="myselect", value='change')
public void onChangeDoSomething(String value) { 
```

希望对您有所帮助，顺便说一下，我认为穆罕默德的回答同样正确（并且不需要使用额外的框架）。

# python - 在迭代列表元素时删除它

> ID：14755534
> 
> 赞同：1
> 
> 时间：2013-02-07T16:04:45.727
> 
> 标签：python

我需要在迭代列表时从列表中删除元素（我无法创建新列表，因为它在我无法控制的代码中被引用）。

我想出的最好的是：

```
last_index = len(somelist) - 1
for (index,item) in enumerate(reversed(somelist)):
    if somecondition(item):
        del somelist[last_index - index] 
```

有更好的选择吗？我已经看过这篇[文章](https://stackoverflow.com/questions/6022764/python-removing-list-element-while-iterating-over-list)和这篇文章，但是[所](https://stackoverflow.com/questions/7573115/delete-item-from-list-in-python-while-iterating-over-it)提供的解决方案都没有那么高效或简洁（恕我直言）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:09:20.213

您可以使用列表理解+切片分配，这当然更简洁——我不知道效率（尽管我希望它在这方面做得更好，因为您不需要在每次删除项目时列出...）

```
somelist[:] = [ x for x in somelist if not somecondition(x) ] 
```

# javascript - Javascript：使用带有 imgTmp 的 IF 条件

> ID：14755538
> 
> 赞同：0
> 
> 时间：2013-02-07T16:04:57.227
> 
> 标签：javascript, if-statement

下面的脚本有效。但是，我想将它与条件 IF 语句一起使用来表示“如果状态为在线，则`changeIt.style.visibility = 'visible';`否则/如果不是则`changeIt.style.visibility = 'hidden';`

我真的尝试过，但没有设法将 IF 与 imgTmp 一起使用。

```
function checkimage() {
    var imgTmp = new Image();
    imgTmp.onload = function() {
        printState("Online");
    };
    imgTmp.onerror = function() {
        printState("Offline");
    };
    imgTmp.src = "http://xxx/test.png?_=" + (+new Date());
}

function printState(state) {
    document.getElementById("div1").innerHTML = " + state + ";
}

printState();
    setInterval(checkimage, 200); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:07:52.797

只需编辑您的 printState 或创建其他函数来更改您想要的可见性...

```
function printState(state) {
    document.getElementById("div1").innerHTML = " + state + ";
    if (state === 'Online') {
        changeIt.style.visibility = 'visible';
    } else {
        changeIt.style.visibility = 'hidden';
    }
} 
```

# ruby-on-rails - Cucumber/Capybara 不会在 Rails 2.3 应用程序上以硒模式运行

> ID：14755544
> 
> 赞同：1
> 
> 时间：2013-02-07T16:05:32.043
> 
> 标签：ruby-on-rails, cucumber, capybara, ruby-on-rails-2

好的，我在 Rails 2 应用程序的黄瓜场景中遇到了一个奇怪的错误。

我们在 Capybara Webkit 下运行我们的 Cucumber 套件。这在大多数情况下工作正常，但我有一个在 ajax 事务期间失败的测试，因为它看不到应该出现在页面上的元素。

我最初虽然这是一个竞争条件并提高了最大超时时间，但无论我们等待多长时间，都找不到该元素。

所以我想看看它的实际效果，所以我尝试切换到 Selenium，这样我就可以端到端地观看整个测试。

但是，每当我尝试通过 selenium 运行它时，它会在第一个设置步骤中直接失败并出现错误：

```
Given I am logged in # features/step_definitions/users/authentication_steps.rb:5
  HTTP request path is empty (ArgumentError)
  /home/dvg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:1860:in `initialize'
  /home/dvg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:2093:in `initialize'
  ./features/support/assumption.rb:48:in `login'
  ./features/step_definitions/users/authentication_steps.rb:7:in `/^I am logged in$/'
  features/requests/user_requests_a_thing.feature:4:in `Given I am logged in' 
```

我已经把我能想到的所有设置都搞砸了，试图让它发挥作用。

我试过了：

1.  从 Firefox 切换到 ChromeDriver
2.  定义应用主机
3.  定义一个 NO_PROXY 环境变量以防代理服务器妨碍（我认为这是 Selenium Webdriver 所关注的）
4.  重构以使用 path_helpers 而不是访问“/login”样式的步骤
5.  更新捆绑包

特别注意事项：

1.  我们是一个刚刚从 Ruby 1.8.7 转换为 1.9.3 的 rails 2.3 应用程序
2.  我们正在使用最新的 Cucumber/Capybara

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:48:26.340

它是无代理变量，但它需要是

```
ENV['no_proxy'] = "127.0.0.1" 
```

# android - 获取以编程方式创建的 ImageView 的宽度和高度

> ID：14755547
> 
> 赞同：1
> 
> 时间：2013-02-07T16:05:43.687
> 
> 标签：android, imageview

我在[CatchtheCows](http://catchthecows.com/?p=113)使用 ImageMap 小部件。此小部件（扩展 imageView）假定图像和地图资源将存储在 res/ 文件夹中，因此将它们设置在布局 xml 中。

我想使用存储在 sdcard 中的自己的资源。所以我创建了一个构造函数，它同时接收地图文件路径和图像文件路径。

问题来了，因为这个小部件需要预先计算 imageView 的宽度和高度，以便相应地缩放位图。但是以编程方式添加 imageView 似乎不会触发 onSizeChanged 事件。

我该如何解决这个问题？

这就是我创建 ImageMap 的方式：

```
mImageMap = new ImageMap(getApplicationContext(),"maps.xml", "/sdcard/media/myimage.jpg");
setContentView(mImageMap, new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.FILL_PARENT, RelativeLayout.LayoutParams.FILL_PARENT)); 
```

这是前面提到的构造函数：

```
public ImageMap(Context context, String mapFile, String imageFile) {
        super(context);
        Bitmap b = BitmapFactory.decodeFile(imageFile);
        this.setImageBitmap(b);

        init();     
        loadMapFromSDCard("maps.xml");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:35:55.510

似乎您正在尝试在`ImageView`实际渲染之前获取它的大小，这将返回零。视图大小仅在渲染后定义。

[addOnGlobalLayoutListener](https://stackoverflow.com/questions/9845197/android-get-fragment-width)可能会解决您的问题，因此您只能在渲染完成后获得大小

# asp.net - DevExpress Asp.net 控件验证意外启动

> ID：14755549
> 
> 赞同：0
> 
> 时间：2013-02-07T16:05:48.207
> 
> 标签：asp.net, devexpress

我正在使用最新的 DevEx Asp.net 控件。在我的一个页面中，我有一个带有 AspxLabels 和 AspxTextBoxes 的表单。在某些文本框中，我有一个必填字段验证。单击时，我在页面上还有 2 个复选框，它们使用来自服务器的数据填充某些文本框。

这是问题发生的时间。

单击任何复选框时，我会将将从服务器填充的所有文本框设置为空字符串。然后我设置数据。

如果其中一个必填字段已经有一些数据，则在选中复选框时将其设置为空字符串会导致客户端验证启动并且服务器调用以获取数据未完成。

有谁知道如何处理和解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T08:48:50.880

根据您的描述（aspx 会更清楚），您应该将[ValidationSettings.ValidateOnLeave](http://documentation.devexpress.com/#AspNet/DevExpressWebASPxEditorsValidationSettings_ValidateOnLeavetopic)设置为 false 并手动验证编辑器。

以下是 devex 代码中心文章的示例：

```
<input type="button" value="Validate" onclick="tbTextBox2.Validate();" />

<dx:ASPxTextBox ID="tbTextBox2" runat="server" ClientInstanceName="tbTextBox2">
    <ValidationSettings ValidateOnLeave="False">
        <RequiredField IsRequired="True" ErrorText="Field is required." />
    </ValidationSettings>
</dx:ASPxTextBox> 
```

有关在客户端验证表单编辑器的各种方法，请阅读[如何在客户端进行验证](http://www.devexpress.com/Support/Center/p/E124.aspx)。

# jquery - 使用 jquery validate 验证辅助表单

> ID：14755552
> 
> 赞同：0
> 
> 时间：2013-02-07T16:05:58.397
> 
> 标签：jquery, jquery-validate

我在一页上有 2 个表格（在[http://www.bumblebeezflorist.com/](http://www.bumblebeezflorist.com/)上将产品添加到您的购物篮）。你可以在这里看到小提琴：

[http://jsfiddle.net/jeepstone/S5Fnn/](http://jsfiddle.net/jeepstone/S5Fnn/)

如果您有交付估算器，我想在有人单击结帐链接之前验证是否已输入某些内容。

因为我已经在我打算使用它的站点上拥有 jquery 验证库。到目前为止，我有：

```
if($('#cartForm').length > 0) {
    $('#proceedCheckout').on('click', function (event) {
        console.log('HSA');
        $('#changeCountry').validate({
            errorClass: 'alert-error'
        });
        event.preventDefault();
    });
} 
```

如果您退出邮政编码字段，则验证可以正常工作，但如果您单击结帐按钮，则验证不会触发。我怎样才能做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:16:48.643

你的代码：

```
if($('#cartForm').length > 0) {
    $('#proceedCheckout').on('click', function (event) {
        console.log('HSA');
        $('#changeCountry').validate({ // <-- move out of here
            errorClass: 'alert-error'
        });
        event.preventDefault();  // <-- should always be first in a function
    });
} 
```

[`.validate()`](http://docs.jquery.com/Plugins/Validation/validate#options)应该用于在 DOM 就绪的表单上初始化插件（及其选项）。由于您在每次点击时都重新初始化，因此您会看到意外的行为。

您还以不存在`#changeCountry`的地方为目标，因此我添加了与两个标签相对应的标签。`id``id``id``form`

每当您有两个表单并且一个表单的提交取决于另一个表单的验证状态时，请使用[插件的`.valid()`方法](http://docs.jquery.com/Plugins/Validation/valid)来测试另一个表单。

尝试更多类似的东西：

```
$(document).ready(function () {

    // call .validate() to initialize the plugin
    $('#changeCountry').validate({
        errorClass: 'alert-error'
    });

    // on click, test the form using .valid()
    $('#proceedCheckout').on('click', function (event) {
        event.preventDefault();
        if ($('#changeCountry').valid()) {
            $('#cartForm').submit(); // passes validation
        } else {
            // failed validation
        }
    });

}); 
```

**演示：http: [//jsfiddle.net/B9d8A/](http://jsfiddle.net/B9d8A/)**

[`$('#changeCountry').validate()`](http://docs.jquery.com/Plugins/Validation/validate#options)在`form`with上[初始化 validate 插件](http://docs.jquery.com/Plugins/Validation/validate#options)`id` `#changeCountry`。

[`$('#changeCountry').valid()`以编程方式触发实际验证测试](http://docs.jquery.com/Plugins/Validation/valid)并返回一个`true/false`布尔值。

**完整文档：**

[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-07T16:17:57.953

为什么有条件地将点击事件添加到按钮？

我会在 click 事件中进行购物车测试，这样您就不会在 click 事件被正确分配给按钮时遇到任何问题。

```
$('#proceedCheckout').on('click', function (event) {
   console.log('HSA');
   if($('#cartForm').length > 0) {
     $('#changeCountry').validate({ errorClass: 'alert-error'  });
     event.preventDefault();
   }
}); 
```

# javascript - Javascript 提升

> ID：14755554
> 
> 赞同：1
> 
> 时间：2013-02-07T16:06:07.723
> 
> 标签：javascript

作为一名 JS 学习者，我发现了一件非常有趣的事情，请考虑以下代码。

```
 this.init = function (e) {
        var container = e.container;

        // slider
        var slider = $("#div1").slider({ orientation: "horizontal", step: 1,
            slide: function () {

                console.log(e.container); // not null
                console.log(container); // null
            }
        });
   }; 
```

这是它的名称：

```
lib.init({ container: $("#container") }); 
```

我知道我可以`on("slide", {container: container}, function(event, args){...}))`用来绑定幻灯片事件并将外部数据传递给它。但是 - 谁能解释为什么两个 console.log 返回的值不同？另外我想知道该技术在技术上是否可以替代`on`方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:29:45.163

首先，我很惊讶你得到了一个`null`for `container`。如果您可以发布，实际上希望查看您的日志

其次，这里解释了为什么这不起作用，但**不是**为什么你得到一个`null`：

这与吊装无关

您正在执行该`init`功能`lib.init({ container: $("#container") });`

那时附加的函数`this.init = function (e) { ...`会以 , 的某个值执行`e`，可能是一个`Event`, 所以`e`被定义并且变量`container`得到一个值

而在以下第 5 行的代码中，

```
var slider = $("#div1").slider( ... // u are calling slider 
```

**使用选项调用**该`slider`函数，其中一个选项是：

 **```
slide: function () { // anonymous and will execute later
    console.log(e.container); // not null
    console.log(container); // null
} 
```

1.  最重要的是，您在`slider`库的功能范围内，因为它正在执行
2.  在这里，您附加的功能`slide: ...`尚未执行。它会，当`slide`事件发生时
3.  `container`发生这种情况时，将使用的现值

如果你得到一个`null`，那么肯定是在重置`container`，就像在 yckart 的小提琴**[中](http://fiddle.jshell.net/WJ2s8/)**一样，它不是 null 并且与`e.container`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:38:20.377

看不出有什么区别......对我来说都是`logs`平等的：http: [//fiddle.jshell.net/WJ2s8/](http://fiddle.jshell.net/WJ2s8/)**

# vim - Vim：Tab 多个文件？

> ID：14755555
> 
> 赞同：9
> 
> 时间：2013-02-07T16:06:13.863
> 
> 标签：vim, tabs

我知道跑步

```
vim -p file1 file2 file3 
```

但是有没有在 vim 中做类似的事情呢？我想过想做的是

```
:tabe file1 file2 file3 
```

或（IMO 更糟，但仍有改进）：

```
:edit file1 file2 file3 
```

...但至少在默认情况下，这些都不可能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T16:25:31.403

尝试这个：

```
:args file1 file2 file3 |tab sall 
```

这只会将新打开的文件 ( `file1, file2, file3`) 放在选项卡中，而不是所有缓冲区。

如果要打开选项卡中的所有缓冲区，请替换`sall`为`sball`

顺便说一句，tab 使用起来方便吗？我个人更喜欢使用缓冲区...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T16:11:07.000

在更广泛地浏览网页，研究这个问题后，我发现的最佳解决方案是：

```
:arga file1 file2 file3 (...) 
```

这将为所有输入文件创建缓冲区。然后按照：

```
:tab sball 
```

这会将所有缓冲区打开到单独的选项卡中。但也许有更好/更短的方法？如果不是，也许我正在帮助其他人，有同样的问题/问题。

# android - 在同一个 TabSpec 中设置不同的布局 - Android

> ID：14755558
> 
> 赞同：1
> 
> 时间：2013-02-07T16:06:27.817
> 
> 标签：android, android-layout, android-tabhost

在 TabHost 中，我有 4 个选项卡，其中一个是登录选项卡。根据用户是否登录，如果用户未登录，此选项卡将显示包含登录表单的布局，或者将选项卡内容布局设置为从 MySQL 数据库检索的用户详细信息。

我尝试使用简单的“if-else”语句设置布局，但是在登录（尝试动态更改布局）时，新布局完全替换了 TabHost，并且我的选项卡不再可见。

如何动态设置选项卡的布局？

# c++ - 运行 g++ 的 Windows XP 上的 ntdll 中的运行时错误

> ID：14755560
> 
> 赞同：1
> 
> 时间：2013-02-07T16:06:32.610
> 
> 标签：c++, g++, ntdll

所以我有这个 cpp 文件，我的 cl_Page 类的构造函数。

```
cl_Page::cl_Page(cl_SoftRoot *parent_param)/* : bgimage(nullptr)*/{
    parent_softroot = parent_param;
    parent_type = 2;
    id[0] = '\0';
    SetColor(bgcolor, 0xffffffff);
    //textboxes.resize(0);
    //buttons.resize(0);
    //images.resize(0);
} 
```

问题是即使在构造函数开始运行之前（parent_softroot 尚未设置）我的程序崩溃了。调用堆栈如下所示：

```
#0 77C460CB strcat() (C:\WINDOWS\system32\msvcrt.dll:??)
#1 7C9140BB ntdll!RtlDosApplyFileIsolationRedirection_Ustr() (C:\WINDOWS\system32\ntdll.dll:??)
#2 00401905 cl_Page::cl_Page(this=0x738a58, parent_param=0x737810) (F:\Scoala\C++\EduSoftViewer_Parser\sources\classes\soft_tree\page.cpp:10)
#3 00402195 cl_SoftRoot::cl_SoftRoot(this=0x737810) (F:\Scoala\C++\EduSoftViewer_Parser\sources\classes\soft_tree\softroot.cpp:4)
#4 004031F4 p2_parse_root(parent_x=0x22bdc0) (F:\Scoala\C++\EduSoftViewer_Parser\sources\parser\parser.cpp:166)
#5 00402D64 parser_wrapper(filename=0x47c1f2 "Test_Software.xml") (F:\Scoala\C++\EduSoftViewer_Parser\sources\parser\parser.cpp:24)
#6 00402BB8 main() (F:\Scoala\C++\EduSoftViewer_Parser\sources\main.cpp:12) 
```

使用 cl_SoftRoot 构造函数中的初始值设定项列表调用 cl_Page 构造函数。

我很乐意提供所需的任何信息。

编辑： cl_Page 类标题：

```
 class cl_Page{
    public:
    cl_Page(cl_LessonMoment *parent_param);
    cl_Page(cl_SoftRoot *parent_param);
    int parent_type;
    cl_LessonMoment *parent_lmoment;
    cl_SoftRoot *parent_softroot;

    char id[256]; //identification

    //<content>
    //Backgrounds.
    str_Color bgcolor;
    cl_Image bgimage;

    //Actual content
    vector<cl_Textbox> textboxes;
    vector<cl_Button> buttons;
    vector<cl_Image> images;
    //</content>

    cl_Textbox* AddTextbox();
    cl_Button* AddButton();
    cl_Image* AddImage(char *filename = nullptr);
}; 
```

# teamcity - TeamCity 7.0.1 命令行构建步骤和 ERRORLEVEL

> ID：14755561
> 
> 赞同：12
> 
> 时间：2013-02-07T16:06:32.907
> 
> 标签：teamcity, teamcity-7.0

我的构建配置中有一个构建步骤，即运行器类型“命令行”，运行自定义脚本。

该脚本正在执行 Robocopy：

```
robocopy "%teamcity.build.workingDir%\Code" "\\target\d$\Web\Target Sites" /E /NP /LOG:robocopy.log

if ERRORLEVEL GEQ 4 (
"D:\blat.exe" "robocopy.log" -to me@me.com -f me@me.com -subject "Error during robocopy on TEAMCITY" -server mail.me.com
)

exit /B 0 
```

Robocopy 命令运行良好，但我不断收到一封电子邮件，并且在构建日志中我不断看到：

> GEQ 在这个时候是出乎意料的。

ERRORLEVEL 检查由于某种原因不起作用？

我试过`IF %ERRORLEVEL% GEQ`了，但这破坏了我的构建，TeamCity 希望我传递一个构建参数。

这是否仅作为“带参数的可执行文件”工作？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-07T16:34:29.933

尼尔，您可以尝试[转义百分号](http://confluence.jetbrains.com/display/TCD7/Defining+and+Using+Build+Parameters+in+Build+Configuration#DefiningandUsingBuildParametersinBuildConfiguration-UsingBuildParametersinBuildConfigurationSettings)。

尝试`IF %%ERRORLEVEL%% GEQ ...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-10T19:19:49.300

我刚刚遇到了这个问题，并感谢@John 的回答。

这是我想出的：

```
robocopy [from] [to] /MIR

REM http://ss64.com/nt/robocopy-exit.html
IF %%ERRORLEVEL%% EQU 0 (
   ECHO No errors occurred, and no copying was done; The source and destination directory trees are completely synchronized.
  EXIT 0
)
IF %%ERRORLEVEL%% EQU 1 (
  ECHO One or more files were copied successfully, new files have arrived.
  EXIT 0
)
 IF %%ERRORLEVEL%% EQU 2 (
  ECHO Some Extra files or directories were detected. No files were copied.
  EXIT 0
 ) 
IF %%ERRORLEVEL%% GEQ 3 (
  ECHO Robocopy Exit Codes: http://ss64.com/nt/robocopy-exit.html  
  EXIT %%ERRORLEVEL%%
) 
```

# meteor - Meteor.js：获取匿名访问者的唯一 ID/ip/什么？

> ID：14755563
> 
> 赞同：16
> 
> 时间：2013-02-07T16:06:34.457
> 
> 标签：meteor

假设我正在使用meteor.js 构建一个应用程序，我只是从用户那里收集一些简单的表单数据。也许是一个简单问题的答案之类的。他们无需登录即可提交数据。

**如何保护我的应用程序免受有人在他们的 Chrome 控制台中创建 js-loop 的影响，而后者只是将垃圾插入到我的数据库中？**

* * *

我可以通过这样做来保护删除和更新：

```
Formanswers.allow({
  insert: function () {
    return true;
  },
  update: function () {
    return false;
  },
  remove: function () {
    return false;
  },
}); 
```

如果用户已登录（您记得在我的应用程序中不是这种情况），我可以为每个插入添加时间戳并检查如下内容：

```
 insert: function (userId, doc) {
        if (userId && (Formanswers.findOnd({userid: userId, time: SOMETHING TIME SPECIFIC}).count() < 1)) return true;
  }, 
```

所以我的问题是：有没有其他方法可以为匿名（未登录）用户获取唯一的 userId-thing 或 IP-address 或其他东西，这样我也可以对他进行上述检查？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T05:24:44.710

You can use a meteorite package.

accounts-anonymous

[https://github.com/tmeasday/meteor-accounts-anonymous](https://github.com/tmeasday/meteor-accounts-anonymous)

So you use

```
Meteor.loginAnonymously(); 
```

if the user visits your page for the first time, and use .allow to check what you need

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T22:19:04.223

要获取 ip 地址，天文台 ( [https://github.com/jhoxray/observatory](https://github.com/jhoxray/observatory) ) 项目使用这个：

在咖啡中：

```
Meteor.userIP = (uid)->
  ret = {}
  if uid?
    s = ss for k, ss of Meteor.default_server.sessions when ss.userId is uid
    if s
      ret.forwardedFor = s.socket?.headers?['x-forwarded-for']
      ret.remoteAddress = s.socket?.remoteAddress
  ret 
```

它返回一个像`{ forwardedFor: '192.168.5.4', remoteAddress: '192.168.5.4' }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:15:16.713

使用会话或本地存储密钥。当访问者提交表单时，检查是否已设置密钥，如果已设置，则拒绝插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:18:49.790

你可以这样做：

```
if (Meteor.isClient) {
    Meteor.startup(function () {
        Session.set('currentuser', 'something randomly generated by another function');
    }
} 
```

并检查“当前用户”是否已插入您的数据库。

# jqmobi - 刷新jqMobi中的文本输入值

> ID：14755564
> 
> 赞同：0
> 
> 时间：2013-02-07T16:06:37.580
> 
> 标签：jqmobi, jqui

我在自定义页脚中有一个文本输入。我正在尝试使用以下方法更新文本：

```
$("#navbar #segment").val("blah"); 
```

我也试过

```
$("#segment").val("blah"); 
```

两者都返回对象，但都不显示更新的文本输入。输入所属的页脚当时没有显示，我认为这可能与它有关，因为在显示面板时执行相同的操作。我也尝试`$.ui.updateNavbarElements($("#navbar #segment"))`在每次调用后添加，它会引发错误。

另外，appMobi XDK 中包含的 jq.web.min.js 与 CDN 上的 jqMobi 脚本有什么区别？它们是否相同，只是 CDN 是最新的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T18:28:17.760

我假设只有在元素显示时才会反映更改是正确的。

# c# - 一页问题中的多个视图

> ID：14755566
> 
> 赞同：0
> 
> 时间：2013-02-07T16:06:42.560
> 
> 标签：c#, asp.net-mvc, linq-to-sql

我有三个观点，它们本身就可以正常工作。我们称它们为 A、B 和 C。它们需要作为完整、独立的观点独立存在。

也就是说，在视图 A 上，我总是需要显示 B 和 C。这很简单，使用 jquery.load()。他们表现得很好，一切都“看起来”很好。当我提交时，问题就来了。我还没有做过类似的事情。三个表单有三个“提交”按钮。我可以很容易地隐藏除页面 A 之外的所有页面。但是，**在控制器中，当我提交 A 时，如何同时提交 B 和 C？** 我不知道这是否重要，但所有三个都是严格类型的视图。

我正在使用 C#、MVC 4、LINQ to SQL。

谢谢

# powershell-2.0 - 使用 Powershell 从远程调用 msiexec 中获取结果

> ID：14755567
> 
> 赞同：0
> 
> 时间：2013-02-07T16:06:43.213
> 
> 标签：powershell-2.0, powershell-remoting

我在 Win 2008r2 上使用 Powershell 对 msiexec 进行远程调用，如下所示：

```
Invoke-Command -session $Session -ScriptBlock{param($arguments) start-process -FilePath "msiexec.exe" -Wait $arguments } -Argument $arguments 
```

目前我正在使用 if(!$?) 检查是否成功，但这并不好，因为我刚刚看到 msiexec 进程抛出 1638 错误（因为该应用程序已经安装在远程服务器上）但是 $? 是真的。

谁能告诉我如何捕获远程服务器上的 msiexec 返回的 1638 代码或其他任何代码？

谢谢，罗伯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-03T13:50:24.993

这是一种非常老套的方法，但我通过使用类似于全局的变量 $script:functionexitcode 解决了这个问题，我将使用 Start-Process 分配来自 msiexec.exe 的 .ErrorCode 的值。

然后在 PowerShell 脚本的主要部分中，我将测试该值 if ($functionexitcode -eq 0)。

以下是与 Start-Process 非常相似的安装场景的完整片段：

```
# Start MSP upgrade to UR

$upgrade = (Start-Process -Filepath $msiexecpath -ArgumentList $argumentlist_BEGIN$argumentlist_MSP$argumentlist_END -PassThru -Wait -ErrorAction Stop)

if ($upgrade.ExitCode -eq 0) {

    Write-Host "Upgrade successful. Error code:" $upgrade.ExitCode `

    "`nUpgrade logfile location: " $workingdirectory\$msi_logfile_upgrade

    $script:FunctionExitCode = $upgrade.ExitCode 
```

# html - 居中一些没有宽度的浮动div

> ID：14755569
> 
> 赞同：0
> 
> 时间：2013-02-07T16:06:46.400
> 
> 标签：html

我有一些无法使用 display: inline-block 的浮动 div，因为其中一些 div 是 jqxSwitchButtons 并且使用该 inline-block 会弄乱这些按钮周围的一切。

[这](http://jsfiddle.net/Luigino/Ps3zE/)是一个 JSFiddle 示例，其中我评论了一些 jqxSwitchButtons 行，我想将这些 div 居中。

来自 JSFiddle 的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
    <center>
            <table style="padding:1px;margin:1px;color:#00417B;font-size:12px;border:2px solid #525252;border-collapse: collapse;background-color:white;width: 100%;" border=1>
            <tr><td>
            <div style="display: block; align:center; width: 100%; margin-left: auto; margin-right: auto; padding-right: auto; padding-left: auto; text-align: center;">

            <div style="float: left; margin-top: 5px; font-weight: bold; ">Element 1</div>
            <div><div style="float: left; margin-left: 5px; margin-right: 5px; margin-top: 2px; margin-bottom: 2px; border: 0.1em solid green; width: 10px; height: 21px;"><div id="element_1" style="float: left;"></div></div></div> <!-- jqxSwitchButton -->

            <div style="float: left; margin-top: 5px; font-weight: bold; ">Element 2</div>
            <div><div style="float: left; margin-left: 5px; margin-right: 5px; margin-top: 2px; margin-bottom: 2px; border: 0.1em solid green; width: 10px; height: 21px;"><div id="element_2" style="float: left;"></div></div></div> <!-- jqxSwitchButton -->

            <div style="float: left; margin-top: 5px; font-weight: bold; ">Element 3</div>
            <div><div style="float: left; margin-left: 5px; margin-right: 5px; margin-top: 2px; margin-bottom: 2px; border: 0.1em solid green; width: 10px; height: 21px;"><div id="element_3" style="float: left;"></div></div></div> <!-- jqxSwitchButton -->

            <div style="float: left; margin-left: 1px">|</div>

            <div style="float: left; margin-left: 2px"><input type="button" id="btnCompute" value="Compute" onClick="Compute()" style="margin-top: 4px"></div>

            <div style="float: left; margin-left: 1px">|</div>

            <div style="float: left; margin-top: 5px; margin-left: 2px; font-weight: bold; ">Auto-compute</div>
            <div><div style="float: left; margin-left: 5px; margin-right: 5px; margin-top: 2px; margin-bottom: 2px; border: 0.1em solid green; width: 10px; height: 21px;"><div id="recompute" style="float: left;"></div></div></div> <!-- jqxSwitchButton -->

            <div style="float: left; margin-top: 5px; margin-left: 2px; font-weight: bold; "><input type="checkbox" name="chkAutoRecompute" id="chkAutoRecompute" value="0" style="display: none" ></div>

            </div>

            </td></tr>

            </table>
    </center>
</body>
</html> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:15:39.920

使用 CSS 使事物居中的正确方法是 margin-left: auto; 边距右：自动；。但是由于您已经更改了这些 div 的边距，因此我建议您使用折旧的`<center></center>`HTML 标记。即使几年前已经贬值，它仍然可以在现代浏览器中使用。我不确定是否有任何浏览器计划在未来版本中删除中心标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T08:33:47.673

你好 Cyborgx37 和 mitchelltrout！最后，我解决了在容器 div 上使用固定宽度根据媒体查询正确设置的问题，因此对于不同的分辨率，我设置了不同的宽度，这样我就可以在一行中对齐。再次感谢大家的帮助。乔，路易吉诺

# asp.net - 错误页面没有看到 Server.GetLastError 有错误

> ID：14755572
> 
> 赞同：1
> 
> 时间：2013-02-07T16:06:50.837
> 
> 标签：asp.net, vb.net

`Page_load`如果出现自定义错误页面，我有以下代码块：

```
Dim objError As Exception
objError = Server.GetLastError()

If IsError(objError) Then
    lblStackTrace.Text = objError.StackTrace
    lblSource.Text = objError.Source
    lblMessage.Text = objError.Message
Else
    MsgBox("Not an Error")
End If 
```

每次我触发错误并通过 web.config 发送到我的页面时，我都会得到“不是错误”框，即使我知道它只是抛出了一个错误。我没有正确实施吗？我正在尝试将错误的详细信息写入页面（作为自动发送包含详细信息的电子邮件的垫脚石），但实际上我正在挂断它看起来的错误。

编辑：Web.config 块：

```
<customErrors defaultRedirect="http://localhost:60470/ErrorPages/GenericError.aspx" mode="On">
</customErrors> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T16:21:15.943

你是对的，来自 web.config 的自定义错误页面无权访问该错误。

看 ：

[http://msdn.microsoft.com/fr-fr/library/aa479319.aspx#customerrors_topic1](http://msdn.microsoft.com/fr-fr/library/aa479319.aspx#customerrors_topic1)

> 此外，自定义错误页面（在 web.config 中设置）无法访问最后抛出的错误，因此只有让道歉更漂亮才有用。

请参见 ：

[http://msdn.microsoft.com/fr-fr/library/aa479319.aspx#customerrors_topic7](http://msdn.microsoft.com/fr-fr/library/aa479319.aspx#customerrors_topic7)

用于丰富的自定义错误页面处理

希望这会有所帮助

# c# - 是否可以重载 NHibernate 创建的惰性集合？

> ID：14755574
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:06:50.787
> 
> 标签：c#, .net, nhibernate

基本上，我有这个类：

```
 public class Promotion : Entity<int>
        {
            public Promotion()
            {
                Created = DateTime.Now;
                this.files = new HashedSet<PromoImage>();
            }

            public Promotion(int id, string Name, DateTime created, DateTime from, DateTime to, ISet<PromoImage> files)
            {
                this.Id = id;
                this.Created = created;
                this.From = from;
                this.To = to;
                this.files = files;
            }

            public Promotion(string Name, DateTime created,DateTime from, DateTime to, ISet<PromoImage> files)
            {
                this.Created = created;
                this.From = from;
                this.To = to;
                this.files = files;
            }

            public virtual DateTime Created { get; protected set; }

            public virtual string Name { get; protected set; }

            public virtual DateTime? From { get; protected set; }

            public virtual DateTime? To { get; protected set; }

            private ISet<PromoImage> files;

            public IEnumerable<PromoImage> Files
            {
                get
                {
                    return files;
                }
            }

        public virtual bool AddPromoImage(PromoImage newPromoImage)
        {
            if (newPromoImage != null && files.Add(newPromoImage))
            {
                return true;
            }
            return false;
        }

        public virtual bool RemovePromoImage(PromoImage promoImage)
        {
            if (promoImage != null && files.Remove(promoImage))
            {
                return true;
            }
            return false;
        }

            public virtual bool ChangePhotoPositions(IEnumerable<Row> rows)
            {
                foreach (var row in rows)
                {
                    List<PromoImage> photos = Files.Where(p => row.PhotoIdAndPosition.Any(q => q.First == p.Id)).ToList();
                    int totalWidth = 0;
                    int lastHeight = photos[0].Image.Height;
                    bool allPhotosHaveSameHeight = true;
                    foreach (var photo in photos)
                    {
                        allPhotosHaveSameHeight = lastHeight == photo.Image.Height;
                        totalWidth += photo.Image.Width;
                        lastHeight = photo.Image.Height;
                    }
                    if (totalWidth > 734 && !allPhotosHaveSameHeight)
                    {
                        return false;
                    }
                    else
                    {
                        foreach (var photo in photos)
                        {
                            var newPosition = row.PhotoIdAndPosition.Single(p => p.First == photo.Id).Second;
                            photo.Row = row.Level;
                            photo.Position = newPosition;
                        }
                    }
                }
                return true;
            }

            public virtual bool SetPromotionDateRange(DateTime from, DateTime to)
            {
                if (from > DateTime.Now)
                {
                    if (from > to)
                    {
                        From = from;
                        To = to;
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                }
                else
                    return false;
            }
        } 
```

以及将 Promotion 对象的任何更改存储为持久事件的此类：

```
 public class StagedPromotion:Promotion
    {
        public StagedPromotion():base()
        {
            Changes = new HashedSet<Change>();
        }

        public virtual DateTime? CommitedWhen { get; protected set; }

        public virtual ISet<Change> Changes { get; protected set; }

        public virtual Promotion WorkingPromotion 
        {
            get
            {
                Promotion promotion = new Promotion(this.Name, this.Created, this.From.Value, this.To.Value, this.files);
                foreach (var change in Changes)
                {
                    change.ExecuteChange(promotion);
                }
                return promotion;
            }
        }
        public virtual bool ChangePhotoPositions(IEnumerable<Row> rows)
        {
            var promo = WorkingPromotion;
            if (promo.ChangePhotoPositions(rows))
            {
                Change change = new ChangeRowAndPosition(new HashedSet<Row>(rows.ToList()));
                Changes.Add(change);
                return true;
            }
            else
                return false;
        }

        public virtual bool SetPromotionDateRange(DateTime from, DateTime to)
        {
            var promo = WorkingPromotion;
            if (promo.SetPromotionDateRange(from, to))
            {
                Change change = new ChangePromotionDate(from, to);
                Changes.Add(change);
                return true;
            }
            else
                return false;
        }

        public virtual bool AddPromoImage(PromoImage newPromoImage)
        {
           //todo
        }

        public virtual bool RemovePromoImage(PromoImage promoImage)
        {
           //todo
        }

        public virtual IEnumerable<PromoImage> Files
        {
            get
            {
                var files =  base.Files;
                //replace each PromoImage object with a StagedPromoImage Decorator                
                //which registers any changes to the PromoImage as persistent events
            }
        }
    } 
```

NHibernate 是否可以通过 base.Files 返回延迟加载的集合并保持 StagedPromotion 的 Files 属性完好无损？

这个想法是创建一个版本控制系统，每个我都可以跟踪已提交/未提交的促销活动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T11:00:20.133

您将 base.Files 称为 nhibernate 可以管理的东西，但是没有办法照原样映射它。为了让 nhibernate 提供一个惰性集合，该属性无论如何都必须是虚拟的，因此您不能在不覆盖基本属性的情况下拥有分阶段促销 Files 属性。

# wix - 您可以将 WiX 属性分配给 CommonAppDataFolder 吗？

> ID：14755575
> 
> 赞同：0
> 
> 时间：2013-02-07T16:06:58.270
> 
> 标签：wix, windows-installer

我想将 WiX 属性的可覆盖属性设置为 CommonAppDataFolder 的当前位置。到目前为止，我已经尝试了以下方法：

```
<Property Id="GHOSTSCRIPT" Value="[CommonAppDataFolder]"/> 
```

也

```
<Property Id="GHOSTSCRIPT" Value="CommonAppDataFolder"/> 
```

都没有正确解决。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T18:40:33.747

Property 元素将一行写入 Windows Installer[属性表](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370908%28v=vs.85%29.aspx)。值列是类型“文本”而不​​是类型“格式化”，因此 [PROPNAME] 不起作用。

SetProperty 元素按需要的顺序安排属性自定义操作（类型 51），它支持您尝试执行的操作。

[设置属性元素](http://wix.sourceforge.net/manual-wix3/wix_xsd_setproperty.htm)

# ios - ios xcode：产品名称不等于目标设置的值->包装->产品名称->（调试|发布）

> ID：14755577
> 
> 赞同：2
> 
> 时间：2013-02-07T16:07:01.357
> 
> 标签：ios, xcode

Xcode 让我发疯。我希望我的 DEBUG 产品被称为“ProductName-Dev”，我的 ADHOC 产品被称为“ProductName-Beta”，我的 RELEASE 产品被称为“ProductName”。然后我想同时在我的设备上。

我选择了我的目标，然后是打包，然后是产品名称，然后是调试（或其他配置）并设置我想要的名称。不同的模式基于不同的配置。

无论我选择何种架构，它都可以构建，但不会在产品组中创建 .app。

如果我尝试在模拟器中运行任何模式，它会启动然后立即退出。对于 DEV 模式，状态区域中的名称是 ProductName-Dev，但对于其他模式，它只是 ProductName。

显然我不明白这一点。感谢你的帮助。

托德

![图像](../Images/11f9d61eddbc0584bf491970286d678c.png)

![图像](../Images/b6d82ac4a01a7a1e79a30a2549729bb7.png)

# objective-c - sqlite 无法识别特殊字符

> ID：14755581
> 
> 赞同：1
> 
> 时间：2013-02-07T16:07:09.907
> 
> 标签：objective-c, sqlite

我正在使用 sql 查询来获取数据。我的查询是

```
select * from green where outlineDate between '2013-01-01' and '2013-12-31' and outlineTitle = 'That's Alright' 
```

得到的`outlineTitle`单引号，即使数据库有数据，也没有从数据库获取数据。如果我放另一个`outlineTitle`没有任何特殊字符的，它的工作......

请帮帮我....提前谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:25:11.697

您正在不正确地创建查询。永远不要使用字符串格式来构建查询字符串。您很可能正在做类似的事情：

```
NSString *title = ... // some title that might have "special characters"
NSString *query = [NSString stringWithFormat:@"select * ... and outlineTitle='%@'", title]; 
```

这是创建查询的一种非常糟糕的方式。正确的方法是使用准备好的语句。

```
NSString *title = ... // some title that might have "special characters"
sqlite3_stmt *stmt = NULL;
sqlite3_prepare_v2(dbHandle, "SELECT * FROM green WHERE outlineTitle = ?", -1, &stmt, nil);
sqlite3_bind_text(stmt, 1, [title UTF8String], -1, SQLITE_TRANSIENT); 
```

通过`?`在查询中使用，然后使用正确的`sqlite3_bind_xxx`方法，所有值都被正确转义和引用。这解决了单引号和其他字符的问题。这也修复了潜在的 SQL 注入攻击。

# xslt - XSLT 过滤器属性

> ID：14755582
> 
> 赞同：0
> 
> 时间：2013-02-07T16:07:11.297
> 
> 标签：xslt, filtering, umbraco

我需要一些帮助来根据属性过滤我的 xml

我有以下格式的 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<root id="-1">
    <LandingPage id="1067" parentID="1050" level="2" 
        writerID="0" creatorID="0" nodeType="1066" template="1073" 
        sortOrder="0" createDate="2013-02-04T14:29:39" 
        updateDate="2013-02-07T11:08:27" nodeName="About" 
        urlName="about" writerName="Pete" creatorName="Pete" 
        path="-1,1050,1067" isDoc="">
      <hideInNavigation>0</hideInNavigation>
    </LandingPage>
</root> 
```

我需要做的是在 hideInNavigation = 0 的地方过滤这些元素

我尝试了以下方法：

```
[@isDoc and @hideInNavigation ='0'] 
```

（我也需要 @isDoc 属性）但意识到这只有`hideInNavigation`在标签的属性时才有效，`LandingPage`所以我尝试了

```
value['hideInNavigation'='0'] 
```

但这似乎也没有做任何事情。在寻找答案之后，我还没有想出任何东西，所以想知道是否有可能

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:16:33.443

假设当前上下文是`<root>`元素，您可以选择带有 hideInNavigation = 0 的 LandingPages：

```
LandingPage[hideInNavigation = '0'] 
```

如果您愿意分享您的 XSLT，我将为您提供有关如何针对这种特殊情况进行修改的更具体的指导。

你的第一个例子中的`@isDoc`测试是你想要的吗？是否要过滤具有`isDoc`属性和`hideInNavigation`值为 0 的 LandingPages？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:17:43.053

`'hideInNavigation'='0'`比较两个字符串`'hideInNavigation'`和`'0'`，保证它们是不同的。

在 root 的上下文中，`LandingPage[hideInNavigation=0]`将匹配您示例中的 LandingPage 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:42:53.770

此 XPath 返回所有具有 isDoc 属性为空且 hideInNavigation 元素内容为“0”的 LandingPage

```
//LandingPage[@isDoc="" and hideInNavigation='0'] 
```

# ios - 为什么使用强大的属性来保存选择器视图

> ID：14755583
> 
> 赞同：1
> 
> 时间：2013-02-07T16:07:12.077
> 
> 标签：ios, objective-c, ios5, properties

我在iOS开发之初的picker view章节看到了这个例子。而且我不明白为什么它在这里使用强引用。

```
@property (strong, nonatomic) IBOutlet UIDatePicker *datePicker; 
```

我们总是使用**弱属性**来引用 UI 组件。

他们的超级视图将**保存**一个子视图数组。（保存子视图数组，也保存每个子视图，对吗？）。

因此，我认为我们可以只使用弱引用来引用作为主视图的子视图的选择器。主视图将`hold`选择器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T03:48:18.297

Apple 建议[应将 outlet 声明为弱引用](https://developer.apple.com/library/ios/#Documentation/General/Conceptual/CocoaEncyclopedia/Outlets/Outlets.html)。

我似乎记得以前的建议是相反的。如果是这样，您的示例似乎是在建议使用时编写的`strong`（或者`retain`，如果它最初早于 ARC）。

`strong`（而且我不认为这是重复的，因为这个问题专门针对网点，而不是关于和之间的根本区别`weak`。）

# javascript - 以编程方式设置数字输入值不起作用

> ID：14755584
> 
> 赞同：1
> 
> 时间：2013-02-07T16:07:11.577
> 
> 标签：javascript, jquery

我有一段 javascript 设置数字输入值。但是，它不会起作用。调用后输入的值字段仍然为空（尽管输出元素的 val() 的 console.log() 确实显示了正确的值）。我已经尝试通过 jQuery 的 .val(total)、.attr('value', total) 和普通的旧 .value = 三种方式设置值，但仍然没有。我什至用 html 替换了整个元素，并将值连接到 value 属性中，但它不起作用。

任何想法为什么这不会？

这是标记：

```
<div id="proposal_price_box">
  <div class="proposal_price_header sys_bkgcolor">
    <span class="title"><h3>Price to Appear on Proposal</h3></span>
  </div>
  <div class="inner">
    <span class="label">$</span>
    <input type="number" class="amount-input" id="proposal_price" value=""/>
  </div>
</div> 
```

和相关的javascript：

```
$('#proposal_price').val('1234'); 
```

Jsfiddle 演示了下面的问题。

[http://jsfiddle.net/n8z9K/12/](http://jsfiddle.net/n8z9K/12/)

不知何故，如果元素的容器被显示，它会设置值。但是一旦它再次隐藏，它就会破裂。

**编辑**抱歉，我没有在 JSfiddle 中正确演示该问题。我正在尝试克隆容器的内容并将其放置在其他地方。我已经更新了 jsfiddle 以更好地显示问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T17:00:26.580

输入节点的值与其值属性之间存在差异。当您使用 val() 方法分配它的值时，您设置的是它的值，而不是它的 value 属性。当您使用 html() 方法时，您将获得具有所有属性（包括 value 属性）的 html，但该属性并未通过您的 val() 分配而改变。只有节点的值发生了变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:18:55.367

你做`#proposal_price { display: none; }`。如果你是那个元素，它会保持相同的 ID（这实际上是无效的，但现代浏览器可以处理这个）。因此，它仍然是隐藏的，因为`display: none;`您应该删除克隆的 ID，否则克隆也不会显示。

是的，这个 jQuery 似乎解决了它：

```
$(document).ready(function() {
    $('#proposal_price').val('123');
    console.log("before clone");
    clone = $('#proposal_container').clone();
    clone.attr("id", "");
    console.log("after clone");
    $('body').append(clone.html());
}); 
```

# amazon-web-services - 无法在新 EC2 实例上引导厨师 (10.8) - net-ssh 冲突

> ID：14755589
> 
> 赞同：0
> 
> 时间：2013-02-07T16:07:35.147
> 
> 标签：amazon-web-services, amazon-ec2, chef-infra

在我的研究中，我发现[无法安装厨师，gem 版本与 net-ssh net-ssh-multi net-ssh-gateway 冲突](https://stackoverflow.com/questions/14738091/cant-install-chef-gem-version-conflict-with-net-ssh-net-ssh-multi-net-ssh-gate/14738173#14738173)，但不幸的是，在我的特殊情况下，这些变通方法都不适合我。

我正在尝试在 EC2 实例上引导厨师。

我无法升级到 11.x。

这个不起作用：（添加了我运行以安装厨师的命令，其中包括--verbose和--version）

```
gem install net-ssh -v 2.2.2 --no-ri --no-rdoc
gem install net-ssh-gateway -v 1.1.0 --no-ri --no-rdoc --ignore-dependencies
gem install net-ssh-multi -v 1.1.0 --no-ri --no-rdoc --ignore-dependencies
gem install chef --no-ri --no-rdoc --verbose --version 0.10.8 
```

有没有办法在不升级厨师的情况下解决这个问题？

我也尝试过上述方法，但使用

```
gem install chef --pre --no-ri --no-rdoc 
```

这也失败了。这些都是上面链接帖子中概述的解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T13:53:12.217

Joshua Timberman 的[这篇](http://jtimberman.housepub.org/blog/2013/02/06/chef-and-net-ssh-dependency-broken/)博文有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T19:00:05.077

在使用 Knife EC2 工具启动服务器时，我在运行 0.10.4 Chef Server 和等效的 Chef Clients 时遇到了这些问题。

对于像我这样在让 KNIFE 启动没有此 net-ssh 问题的实例时遇到问题的其他人，按照 SO 上的其他建议将以下内容放入我的引导文件中不起作用：

```
gem install chef --no-ri --nordoc --verbose --version 0.10.24 
```

有效的方法是在刀 ec2 命令上使用标志：

```
--bootstrap-version 10.24.0 
```

版本可以高于 10.20.0。

# python - 根据另一个不是索引数组的数组中的值从 numpy 数组中选择元素

> ID：14755590
> 
> 赞同：5
> 
> 时间：2013-02-07T16:07:35.103
> 
> 标签：python, numpy

假设我有以下两个数组：

```
a = array([(1, 'L', 74.423088306605), (5, 'H', 128.05441039929008),
       (2, 'L', 68.0581377353869), (0, 'H', 88.15726964130869), 
       (4, 'L', 97.4501582588212), (3, 'H', 92.98550136344437),
       (7, 'L', 87.75945631669309), (6, 'L', 90.43196739694255),
       (8, 'H', 111.13662092749307), (15, 'H', 91.44444608631304),
       (10, 'L', 85.43615908319185), (11, 'L', 78.11685661303494),
       (13, 'H', 108.2841293816308), (17, 'L', 74.43917911042259),
       (14, 'H', 64.41057325770373), (9, 'L', 27.407214746467943),
       (16, 'H', 81.50506434964355), (12, 'H', 97.79700070323196),
       (19, 'L', 51.139258140713025), (18, 'H', 118.34835768605957)], 
      dtype=[('id', '<i4'), ('name', 'S1'), ('value', '<f8')])

b = array([ 0,  3,  5,  8, 12, 13, 14, 15, 16, 18], dtype=int32) 
```

我想从中选择`a`中`id`给出的元素`b`。也就是说，`b`不是索引数组。它包含`ids`观察结果。我怎样才能在 numpy 中做到这一点？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T16:16:49.867

你应该得到你想要的

```
indeces = [i for i,id in enumerate(a['id']) if id in b]
suba = a[indeces]
print(suba)
>>>array([(5, 'H', 128.05441039929008), (0, 'H', 88.15726964130869),
   (3, 'H', 92.98550136344437), (8, 'H', 111.13662092749307),
   (15, 'H', 91.44444608631304), (13, 'H', 108.2841293816308),
   (14, 'H', 64.41057325770373), (16, 'H', 81.50506434964355),
   (12, 'H', 97.79700070323196), (18, 'H', 118.34835768605957)], 
  dtype=[('id', '<i4'), ('name', '|S1'), ('value', '<f8')]) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T17:36:28.093

对于您的示例数组，以下方法比 Francesco 的方法快几倍：

```
In [7]: a[np.argmax(a['id'][None, :] == b[:, None], axis=1)]
Out[7]: 
array([(0, 'H', 88.15726964130869), (3, 'H', 92.98550136344437),
       (5, 'H', 128.05441039929008), (8, 'H', 111.13662092749307),
       (12, 'H', 97.79700070323196), (13, 'H', 108.2841293816308),
       (14, 'H', 64.41057325770373), (15, 'H', 91.44444608631304),
       (16, 'H', 81.50506434964355), (18, 'H', 118.34835768605957)], 
      dtype=[('id', '<i4'), ('name', '|S1'), ('value', '<f8')])

In [8]: %timeit a[np.argmax(a['id'][None, :] == b[:, None], axis=1)]
100000 loops, best of 3: 11.6 us per loop

In [9]: %timeit indices = [i for i,id in enumerate(a['id']) if id in b]; a[indices]
10000 loops, best of 3: 66.9 us per loop 
```

要了解它是如何工作的，请看一下：

```
In [10]: a['id'][None, :] == b[:, None]
Out[10]: 
array([[False, False, False,  True, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
    ... # several rows removed 
    [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False,  True]], dtype=bool) 
```

它是一个数组，行数与 中的元素`b`一样多，列数与 中的元素一样多`a`。`np.argmax`然后找到`True`每行中第一个的位置，即 in 的对应元素第一次出现的`b`索引`a['id']`。

如上所示，对于小型数组，这在性能方面优于 python。但是，如果其中一个`a`或`b`太大，则`bool`s 的中间数组的大小会削弱性能。此外，必须搜索整行，它永远不会提前跳出循环，如果太长`np.argmax`，这不是一件好事。`a`我在回答[这个问题](https://stackoverflow.com/questions/14559687/scipy-fast-1-d-interpolation-without-any-loop)时做了一些时间安排，使用了类似的方法，对于中等大的数组来说，这仍然是可行的方法。

Francesco 的方法绝对不那么老套，更容易理解，我必须承认，对于样本大小的数组，性能差异无关紧要。但它不会让你感觉像[这样](http://abstrusegoose.com/483)......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:17:21.863

```
sorted = numpy.sort(a)
sorted[b]
 array([(0, 'H', 88.15726964130869), (3, 'H', 92.98550136344437),
   (5, 'H', 128.05441039929008), (8, 'H', 111.13662092749307),
   (12, 'H', 97.79700070323196), (13, 'H', 108.2841293816308),
   (14, 'H', 64.41057325770373), (15, 'H', 91.44444608631304),
   (16, 'H', 81.50506434964355), (18, 'H', 118.34835768605957)], 
  dtype=[('id', '<i4'), ('name', '|S1'), ('value', '<f8')]) 
```

只要数组中的 id 数与行数一样多。

# firefox - 如何：使用 Firefox 时以模式打开文章

> ID：14755595
> 
> 赞同：0
> 
> 时间：2013-02-07T16:07:53.027
> 
> 标签：firefox, joomla2.5

嗨，我在使用 Firefox 时在 joomla 2.5 模板中以模态打开文章时遇到问题。

当我使用 crome 或 ie 时，一切都很好，但是 firefox 和 opera 不起作用，知道如何解决这个问题吗？

[链接到网站](http://nemanja.me/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T13:46:26.313

尝试更改`modal.js`文件或`uncompressed-modal.js`文件。有一个`if`设置条件的语句。

供参考，请看[这里](http://kb.lexo.ch/2012/08/joomla-modal-js-error-in-firefox-when-opening-a-modal-window-message-could-not-convert-javascript-argument-arg-0-nsidomhtmldivelement-contains/)。

我希望它对你有帮助。

尝试更改这些行。它对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:43:21.363

我把我的模板代码放在首位：

```
<?php JHTML::_('behavior.modal'); ?> 
```

并创建这样的链接：

```
<a class="modal" href="index.php/article?tmpl=component" rel="{size: {x: 500, y: 400}}">article</a> 
```

正如我在 chrome 中所说的那样，这一切都很好，即 safari。但在Firefox和Opera中不起作用。

在我的网站上，您可以看到示例... [nemanja.me](http://nemanja.me)

# c# - 我的属性搜索 XPath 查询出了什么问题

> ID：14755596
> 
> 赞同：1
> 
> 时间：2013-02-07T16:07:54.323
> 
> 标签：c#, xml, xpath, xml-namespaces, xmldocument

我有一个 XPath 查询，它看起来对我来说是正确的，但没有返回任何结果。

它正在测试的 XML 文档：

```
<Deployment xmlns="http://schemas.microsoft.com/client/2007/deployment" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Deployment.Parts>
    <AssemblyPart x:Name="foo" Source="foo.dll" />
  </Deployment.Parts>
</Deployment> 
```

编码：

```
Xml = new XmlDocument();
Xml.LoadXml(text);
Manager = new XmlNamespaceManager(Xml.NameTable);
//use constants for namespaces to make more readable
Manager.AddNamespace("a", NS_DEPLOYMENT_2007); //use 'a' for default namespace here so xpath is easier
Manager.AddNamespace("x", NS_XAML_2006); 

string xpath="//a:Deployment.Parts/a:AssemblyPart[@a:Source='foo.dll']";
var tmp = Xml.SelectNodes(xpath, Manager); 
```

我的 XPath 查询有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:11:31.283

您需要从属性中删除命名空间前缀：

```
string xpath="//a:Deployment.Parts/a:AssemblyPart[@Source='foo.dll']"; 
```

如果属性明确定义了命名空间，则只需为其指定命名空间，因此当您想要查询该`Name`属性时，您必须添加它：

```
string xpath="//a:Deployment.Parts/a:AssemblyPart[@x:Name='foo']"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:11:22.537

我*怀疑*这部分是你的问题：

```
@a:Source='foo.dll' 
```

与元素名称不同，属性名称不继承命名空间。您的文档没有为该属性指定名称空间，因此我认为您也不应该这样做。

试试：

```
@Source='foo.dll' 
```

（顺便说一句，我个人会使用 LINQ to XML 而不是 XPath - 我发现它通常更简单。YMMV，但它可能值得考虑 - 如果您使用的是 .NET 3.5 或更高版本，当然。）

来自[“XML 1.0（第 3 版）中的命名空间”第 6.2 节](http://www.w3.org/TR/xml-names/#defaulting)（强调我的）：

> 默认命名空间声明的范围从它出现的开始标签的开头延伸到相应的结束标签的末尾，不包括任何内部默认命名空间声明的范围。在空标签的情况下，范围是标签本身。
> 
> 默认命名空间声明适用于其范围内的所有无前缀元素名称。**默认命名空间声明不直接应用于属性名称；无前缀属性的解释由它们出现的元素决定。**

# c++ - 需要设计建议以独占访问私有类状态

> ID：14755598
> 
> 赞同：1
> 
> 时间：2013-02-07T16:08:02.250
> 
> 标签：c++, design-patterns

我正在开发一个简单的系统，涉及序列化用户对象。我有一系列专门的模板类，它们作用于每种类型的读/写方式不同：

```
template<class T>
class ItemSerializer;

template<>
class ItemSerializer<int>
{
public:
    static void store( int const& obj )
    {
    }

    static void fetch( int& obj )
    {
    }
};

template<>
class ItemSerializer<NoteNumberArray>
{
public:
    static void store( NoteNumberArray const& obj )
    {
       // NoteNumberArray::_blocks is used here.
    }

    static void fetch( NoteNumberArray& obj )
    {
       // NoteNumberArray::_blocks is used here.
    }
}; 
```

根据类型，它可能有也可能没有状态，这对于分配它的序列化程序类是必需的。在这个例子中，我有 2 种类型的序列化器：`int`和`NoteNumberArray`. 存储/获取功能不需要任何`int`类型的附加状态，读/写实现非常简单。

但是，对于`NoteNumberArray`，状态是必要的，所以我创建自己的类，而不是使用核心类型或 STL 类型。此状态仅由 的实现使用`ItemSerializer` *，*用于优化目的。这种私有状态将用于优化读/写方法的速度和效率。由于序列化程序类不是有状态的，我将这个状态放在用户对象中。

我可能会成为`ItemSerializer`的朋友`NoteNumberArray`，但这会导致循环依赖，并提供对不必要`ItemSerializer`的访问权限。`NoteNumberArray`

这样的系统有什么好的设计？只是寻找一些提示来帮助我开始。以下是此示例的其他一些相关片段：

```
class Block
{
};

class NoteNumberArray
{
public:
    // Public interface, none of which will use _blocks. Only ItemSerializer uses _blocks.

private:
    std::vector<int> _array; // This should not be used directly by anyone, including ItemSerializer.
    std::vector<Block> _blocks; // This is the private state only used by ItemSerializer
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T17:21:25.063

我没有看到循环依赖问题，也没有`ItemSerializer<NoteNumberArray>`与`NoteNumberArray`.

如果您不想`ItemSerializer<NoteNumberArray>`看到`NoteNumberArray`.

一种可能性是包装`_blocks`到另一个类`NoteNumberArraySerializerHelper`中，该类`ItemSerializer<NoteNumberArray>`作为友元和所有方法（包括构造函数和其他通常由编译器为您编写的东西）都是私有的。然后，您必须为 to 提供公共访问器/修改器方法，`_blocks`但`NoteNumberArray`除了这些方法之外，没有人`ItemSerializer<NoteNumberArray>`可以使用这些方法来做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:32:02.537

If`_blocks`仅用于`ItemSerializer`使其成为`ItemSerializer`专业化的成员。在不了解整个目的的情况下，我看不到`NoteNumberArray`直接存储这样的东西的好处。

附带说明一下，通过避免`_`在标识符上前导，您可以轻松避免意外使用保留名称（例如`_`后跟大写或`_`在全局命名空间中前导）。

# python - 无法使用 Python 通过套接字发送正确的值

> ID：14755599
> 
> 赞同：0
> 
> 时间：2013-02-07T16:08:07.697
> 
> 标签：python, sockets, tcp, client-server, python-3.3

我是一般使用 Python 和套接字的新手（昨天才开始），所以我在尝试设置 TCP 客户端和服务器时遇到了很多问题。我遇到的问题是我想将密钥从服务器发送到客户端。我知道服务器在打印出正确的密钥时正确地获取了密钥，但是它在新行中附加了一个 0，当密钥发送到客户端时，唯一显示的是“b'0' ”。

由于缺乏经验，我取得的进展很小，经过几个小时的搜索，我仍然没有找到解决问题的方法。

这是服务器代码：

```
import os
from socket import * #import the socket library

HOST = '' #We are the host
PORT = 29876
ADDR = (HOST, PORT)
BUFFSIZE = 4096
message = 'Hello, World!'

serv =  socket( AF_INET,SOCK_STREAM)
serv.bind(ADDR,) 
serv.listen(5) 
print ('listening...')

conn,addr = serv.accept()
print (conn,addr)
print ('...connected')

key = os.system("cat ~/.ssh/id_rsa.pub")
conn.send(str(key))
print (key)

conn.close() 
```

这是客户端代码

```
from socket import *
import os

HOST = 'xxx.xxx.xxx.xxx'
PORT = 29876 
ADDR = (HOST,PORT)
BUFFSIZE = 4096
message = "Hello, World!"

cli = socket( AF_INET, SOCK_STREAM)
cli.connect(ADDR,)

data = cli.recv(BUFFSIZE)
print (data)

cli.close() 
```

从我的代码中可以看出，我正在使用 Python 3.3 非常感谢任何有关此问题的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:44:32.217

os.system() 不返回进程的输出，而是返回值（即整数`0`）。

如果您只想读取文件，请手动执行：

```
with open(os.path.expanduser("~/.ssh/id_rsa.pub")) as f:
    key = f.read()
    conn.sendall(key) 
```

如果您需要流程输出，请阅读[subprocess 模块](http://docs.python.org/3/library/subprocess.html)的文档。

# java - 如何为 Web 应用程序实现屏幕共享？

> ID：14755601
> 
> 赞同：7
> 
> 时间：2013-02-07T16:08:12.403
> 
> 标签：java, swing, rtmp, wowza, screensharing

**序言**。我想问，如何在网络上创建桌面屏幕共享的解决方案，但后来发现有很多这样的问题。用几个字符串来回答这个任务非常复杂。所以我花了一些时间试图找到合适的解决方案。似乎我找到了一个——只是想分享它。

**初始任务**：我们有一个 Web 应用程序。我们需要找到一种方法让用户与任何其他用户共享他的屏幕。实现于：Win 7 x64、Java、Wowza-3.5.0。

我们怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-07T16:08:12.403

**整个过程一言以蔽之：**通过网页上的链接在 JavaWebStart (jlnp) 的帮助下，用户启动用 Java 编写的 Swing 应用程序，每秒都会对他的桌面进行截图。在此之后，它将其编码为视频流并将此流发送到 Wowza-server。Wowza 能够将此流重新传输给任意数量的用户，这些用户可以通过 flash-player 访问该流。

**详细步骤：**

**1\. 安装 Wowza（强制）。**

*   从这里获取适当的安装程序（在我的情况下为 Win）：[http ://www.wowza.com/pricing/installer](http://www.wowza.com/pricing/installer)
*   从这里获得免费的开发者许可证：[http](http://www.wowza.com/pricing/trial) ://www.wowza.com/pricing/trial （您需要提供电子邮件，有效期为 180 天的密钥将发送到那里）。
*   关注关于过程的精彩视频：[http://www.wowza.com/forums/content.php?288-Getting-Started-(Video-Tutorial)](http://www.wowza.com/forums/content.php?288-Getting-Started-(Video-Tutorial))

此外，我将 wowza 安装目录称为 [wowza-root]

**步骤检查：**安装完成后——开始——所有应用程序——Wowza Media Server 3.5.0——Wowza启动。服务器何时启动，您将看到消息

```
“Wowza Media Server is started!” 
```

打开浏览器并输入：

```
http://localhost:1935/ 
```

您应该看到如下内容：

```
Wowza Media Server 3 Developer Edition (Expires: авг 03, 2013) 3.5.0 build2989 
```

如果是这样——我们完成了第一步。

* * *

**2\. 在 Wowza 上启动示例电影（可选）。**

下一步——实际流式传输一些内容，[wowza-root] 拥有它所需的一切。

*   进入目录**[wowza-root]\examples**
*   右键单击**installall.bat**并选择“以管理员身份启动”以安装所有必要的播放器。
*   输入 dir **[wowza-root]\examples\VideoOnDemandStreaming\FlashHTTPPlayer** 并单击 **player.html**在浏览器中启动此文件。单击连接。 **步骤检查**：你应该看到关于兔子的有趣电影。您可以在此处提交这部电影：**[wowza-root]\content\sample.mp4**

* * *

**3\. SWING-app 分享你的桌面（强制）。**

好的，我们的服务器启动并运行（WOWZA 正在运行）。现在是时候启动可以为我们的桌面截屏的应用程序了。幸运的是，它已经是德勒奥拉吉德写的，上帝保佑这个人。查看此链接了解详细信息 ( [http://code.google.com/p/red5-screenshare/](http://code.google.com/p/red5-screenshare/) )，并下载此链接 ( [http://code.google.com/p/red5-screenshare/downloads/list](http://code.google.com/p/red5-screenshare/downloads/list) ) –您需要下载 screenshare.zip 文件。

解压到任意目录。我们将从 bat 文件启动这个应用程序开始。解压后的目录中已经有两个 bat 文件 - **do_run1.bat**和**do_run2.bat**。我刚刚复制了其中一个文件并将其命名为**do_run_my.bat**，其内容应如下所示：

```
"C:\Program Files\Java\jdk1.6.0_26\bin\java" -classpath screenshare.jar org.redfire.screen.ScreenShare  localhost screenshare 1935 ss1 flashsv1
pause 
```

在哪里

*   "C:\Program Files\Java\jdk1.6.0_26\bin\java" – 正确的 java 路径
*   screenshare.jar - 我们应该使用什么 jar（可以在解压缩的文件夹中找到）。
*   org.redfire.screen.ScreenShare – 主类
*   localhost – Wowza 的主机
*   屏幕共享 – 应用程序名称（重要）
*   1935 – 沃扎港
*   ss1 – 流名称（重要）
*   flashsv1 – 为您的视频流编码。

您唯一需要更改的就是为您的 java.util 设置正确的路径。你现在可以启动它了！

**步骤检查**：您应该看到应用程序屏幕。巨大的成功！但是，如果您单击“开始共享”按钮，您会在控制台中收到错误消息，Wowza 中缺少该屏幕共享应用程序文件夹。没关系，这意味着我们现在走在正确的轨道上。退出 SWING 应用程序。

```
[ERROR] [New I/O client worker #2-1] org.redfire.screen.ScreenClientHandler - closing channel, server resonded with error: [0 COMMAND_AMF0 c3 #0 t0 (0) s207] name: _error, transactionId: 1, object: null, args: [{level=error, code=NetConnection.Connect.Rejected, description=Connection failed: Application folder ([install-location]/applications/screenshare) is missing., clientid=8.87236417E8}] 
```

* * *

**4\. 配置 WOWZA 以接受来自我们 SWING APP 的流（强制）。**

*   输入**[wowza-root]\applications并在那里创建名称为****screenshare**的文件夹（注意 - 这与我们的 SWING 应用程序中的应用程序名称完全相同）
*   输入**[wowza_root]\conf** 并再次创建文件夹**screenshare**。
*   在**[wowza_root]\conf**中，您可以找到一个名为**Application.xml**的文件。将此文件复制到您刚刚创建的**[wowza_root]\conf\screenshare文件夹。**
*   更改**Application.xml**中的一些属性。设置此值：

    StreamType=live HTTPStreamers=cupertinostreaming,smoothstreaming,sanjosestreaming LiveStreamPacketizers=cupertinostreamingpacketizer,smoothstreamingpacketizer,sanjosestreamingpacketizer PlayMethod=none

*   现在重新启动 Wowza。

**步骤检查：**通过 bat 文件再次启动 SWING-APP。现在你应该看到类似这样的东西，而不是错误，这意味着与服务器的连接已建立：

```
[INFO] [New I/O client worker #1-1] org.redfire.screen.ScreenClientHandler - onStatus code: NetStream.Publish.Start
+++ [0 VIDEO c5 #1 t166 (0) s255355]
+++ [1 VIDEO c5 #1 t1169 (1003) s116522]
+++ [1 VIDEO c5 #1 t2171 (1002) s53049]
+++ [1 VIDEO c5 #1 t3178 (1007) s53667] 
```

* * *

**5\. 观看您的直播（可选）。** 现在是最令人愉快的部分——看看所有这些员工是如何一起工作的。- 输入**[wowza-root]\examples\LiveVideoStreaming\FlashRTMPPlayer** 并启动 **player.html**。请注意，在下面的两个参数中都使用了应用程序名称和流名称，这与我们在 SWING-APP 中配置的完全相同。

```
Server: rtmp://localhost/screenshare
Stream: ss1 
```

然后点击“连接”按钮。

**步骤检查**：您将看到您的共享桌面！所以任务完成了——至少是它的初始阶段。

* * *

**6\. 在网页上启动 flash-player（可选）** 太好了！现在我们有了可行的解决方案，只有一件事尚未完成——我们正在从 Windows 目录启动播放器，网络上的其他人无法访问它。所以 - 有什么问题，让我们部署一个。

*   首先你需要通读这个：[http ://www.wowza.com/forums/content.php?49](http://www.wowza.com/forums/content.php?49)
*   接下来去[http://www.osmf.org/configurator/fmp/#](http://www.osmf.org/configurator/fmp/#)
*   在“Videosource”字段中插入指向您的流的链接（当然，SWING-APP 应该在共享模式下工作）：**rtmp://localhost:1935/screenshare/ss1**
*   单击预览。你应该看到你的流。
*   现在只需将整个代码从“Preview Embed Code”复制到实际部署在应用程序服务器上的任何网页——仅此而已。您可以将此页面的链接提供给任何用户，他将能够看到您的流。

* * *

**7\. 使用动态流名而不是静态（可选）**

您可能已经注意到，现在我们的屏幕共享正在运行，但是因为我们通过配置向我们的 SWING-APP 提供流名称，所以无法同时为多个用户使用它。我不会详细描述如何处理它，只是给一个简短的说明。

如果你检查**screenshare.jar**你会发现这个 jar 实际上包含了 SWING-application 的所有编译和源代码。可以根据您的需要修改源代码并重新设计初始应用程序。在我的情况下，我只是将当前时间（以毫秒为单位）添加到提供的流名称和消息窗口中，在单击“开始流”按钮后显示如下内容：

```
Send this link to any person you want to share you screen with:
http://localhost:8080/player.htm?src=rtmp%3A%2F%2Flocalhost%3A1935%2Fscreenshare%2Fss1360243745881 
```

正如您在链接中看到的 - 我只是将流地址作为查询字符串添加到我的带有嵌入式播放器代码的 html 页面所在的 URL。我也想提供这个页面的代码。它非常简单——在 javascript 的帮助下，我从请求字符串中提取了参数，并将提取的参数放在我的 html 页面上的位置，其中嵌入了 p.6 中的代码

```
<html>
<head></head>
<body>

<SCRIPT LANGUAGE="JavaScript">

    var myQueryString = document.location.search;

    // remove the '?' sign if exists
    if (myQueryString[0] = '?') {
        myQueryString = myQueryString.substr(1, myQueryString.length - 1);
    }

    document.write(
        '<object width="600" height="409">\n' +
            '<param name="movie" value="http://fpdownload.adobe.com/strobe/FlashMediaPlayback.swf" />\n' +
            '</param>\n' +
            '<param name="flashvars" value="' + myQueryString +'" />\n' +
            '</param>\n' +
            '<param name="allowFullScreen" value="true" />\n' +
            '</param>\n' +
            '<param name="allowscriptaccess" value="always" />\n' +
            '</param>\n' +
            '<embed src="http://fpdownload.adobe.com/strobe/FlashMediaPlayback.swf" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="600" height="409" flashvars="' + myQueryString +'"></embed>\n' +
            '</object>'
    );

</SCRIPT>

</body>
</html> 
```

就这些。我希望它会为某人节省一些时间。祝你好运

# jquery - CSS 背景图片影响 jQuery 性能？

> ID：14755605
> 
> 赞同：0
> 
> 时间：2013-02-07T16:08:21.783
> 
> 标签：jquery, html, css

我有一个大约 10,000 像素宽的页面。

当用户滚动页面时，页面会从右向左移动，从而产生水平滚动。

我的页面上有多个 div，每个 div 都有一个背景图像，每个 div 都设置了要包含的背景大小，以便图像相应地缩放每个 div 的高度。

```
.examplediv {
    background-image:url('myimage.jpg');
    background-size:contain;
    height:80%; 
    width:200px;
} 
```

我的页面相对平滑地向上滚动，直到到达 Id 具有 .examplediv 的点，然后它开始抖动/抖动。

我要问的是，以前有没有人遇到过这个问题，在 css 中加载图像比在标记中留下空的 div 标签要慢吗？:contain 值是否会在每次滚动时重新计算并减慢速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:34:46.943

问题是，当使用`background-size`浏览器时，实际上并没有缓存图像，所以在每次事件之后，比如用某些东西覆盖图像等，它必须再次渲染它——对于更大的图像，它会产生明显的延迟

**编辑：这是一个类似问题的 ling[使用背景大小的 Chrome 性能不佳：封面](https://stackoverflow.com/questions/7869086/poor-performance-of-chrome-using-background-size-cover)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:29:21.440

我会确保所有图像都不会比实际需要的大。此外，在 Photoshop 中，您可以将 Web 的质量设置得非常低。

在 Photoshop 中使用 save for web，您可以在 2up 视图中同时看到旧图像和新图像。

# jquery - 用于放大和缩小的 JQuery 插件

> ID：14755606
> 
> 赞同：-2
> 
> 时间：2013-02-07T16:08:22.180
> 
> 标签：jquery, jquery-animate

是否有用于即时放大和缩小图像效果的 JQuery 插件，例如单击[getglue.com](http://getglue.com)帖子上的“喜欢”按钮或 Facebook 移动应用程序在您喜欢某物时显示它的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:12:15.273

有一个名为**Zoomooz.js**的插件可以缩放/扩展页面上的元素。

您可以在这里找到该插件：http: [//janne.aukia.com/zoomooz/](http://janne.aukia.com/zoomooz/)

我相信 getblue.com 实现的是自定义的，并且可以通过一些基本的 jQuery 轻松实现。只需搜索一下如何使用 jQuery 扩展/收缩元素。有数百个例子可供您学习。

# regex - 需要一个仅匹配管道字符的单个实例的正则表达式

> ID：14755608
> 
> 赞同：3
> 
> 时间：2013-02-07T16:08:30.187
> 
> 标签：regex

我正在尝试编写一个正则表达式，以仅匹配未跟随一个或多个进一步管道的“管道”字符 (|) 的实例。所以一个管道后面跟着一个管道以外的任何东西。

我有这个，但它似乎没有工作：

```
/|(?!/|) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T16:10:27.747

你在逃避你的`pipe`错误。你需要使用`backslash`，而不是`slash`。除此之外，您还需要使用`negative look-behind`, 以便`last`管道不匹配，它可能前面没有管道，但后面没有： -

```
(?<!\|)\|(?!\|) 
```

一般来说，如果我想匹配正则表达式元字符类，我更喜欢使用字符类而不是转义：-

```
(?<![|])[|](?![|]) 
```

但是，这是我的口味。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:41:50.437

好的，经过多次迭代，我找到了答案。这将仅匹配一个未进行且未跟随管道的单个管道字符。

```
(?=(\|(?!\|)))((?<!\|)\|) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:54:45.590

匹配一个（行首或非管道）管道（行尾或非管道）。

```
(^|[^|])[|]([^|]|$) 
```

# codeigniter - 值中没有任何字符串的 CodeIgniter 锚函数

> ID：14755616
> 
> 赞同：0
> 
> 时间：2013-02-07T16:08:59.163
> 
> 标签：codeigniter

我现在的代码：

```
<?php echo anchor('admin/delete_msg/'.$obj->id, 'DELETE MESSAGE', array('onclick' => 'return confirm(\'Are you sure?\');', 'class' => 'delete-button')); ?> 
```

但我想使用类似的东西：

```
<?php echo anchor('admin/delete_msg/'.$obj->id, '', array('onclick' => 'return confirm(\'Are you sure?\');', 'class' => 'delete-button')); ?> 
```

所以没有“删除消息”文本，我可以使用图像代替。

但是，如果我将单引号留空，则链接将显示，例如`http://localhost/project`

有什么建议如何在锚函数中解决这个问题而不是通过`<a href="...`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:17:42.867

您可以使用 CSS 隐藏文本并拉入背景图像：

```
.delete-button{
   display: inline-block;
   width: 80px; /* fits background-img width */
   height: 40px; /* fits background-img height */
   text-indent: -9999px;
   background: url('path/to/image') top left no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T15:46:29.740

我已经使用空间解决了它，例如：

```
<?php echo anchor('admin/delete_msg/'.$obj->id, ' ', array('onclick' => 'return confirm(\'Are you sure?\');', 'class' => 'delete-button')); ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:42:10.583

不要使用锚助手。只需将 $obj 传递给视图（html.php）

```
<a rel="nofollow" onclick="return confirm()" class="btn btn-delete-icon" href="<?php echo site_url('admin/delete_msg/'.$obj->id.'')?>"> &nbsp; </a> 
```

# arrays - 在 VBA 中排列数组以计算 Shapley-Shubik 功率指数

> ID：14755620
> 
> 赞同：2
> 
> 时间：2013-02-07T16:09:09.833
> 
> 标签：arrays, excel, vba, multidimensional-array, permutation

我想这是我在这个论坛上的第一个问题，如果我错过了一些规则，请原谅。我正在尝试编写一个 VBA 算法来计算 Shapley-Shubik 指数。该索引需要计算一系列数字的所有排列（代表议会、国会等的投票）。经过一些彻底的研究，我明白必须使用递归算法来执行这样的事情。

我的想法是在 vba 中创建一个矩阵，其中每个元素单独存储，并且每一行包含不同的排列。这是我随后可以执行计算并检索计算此类索引所需的正确标签值的唯一方法。问题是我无法理解一旦达到最后一个递归级别，如何恢复到以前的级别。

（编辑）最终，我能够想出一个解决方案。我在下面发布结果，因为我已经看到它已被要求。不过我应该警告一下，这是一个非常低效的代码，并且它不适用于超过 7 个玩家。这样做的原因是因为 vba 无法处理这段代码创建的非常大的矩阵，所以程序只是因为溢出错误而崩溃。

然而，在编写这段代码时并不是特别聪明，这意味着修改代码应该很容易，以使其适用于更多的玩家。基本上，无需使用置换函数来创建矩阵，只需计算每个特定置换中的关键参与者，然后使用数组“存储”频率。不幸的是，我没有时间修改代码，因为我目前正在处理其他项目，虽然有些相关，但使用 Matlab 代替。

这是我组装的功能：

```
Public Function ShapleyShubik( _
  Votes As Range, _
  Coalitions As Range, _
  Candidate As String, _
  Threshold As Double) As Double
'
'------------------------------------------------------
'                    by Sim1
'  This function computes the Shapley-Shubik Power Index
'  For a specified coalition among the available ones
'------------------------------------------------------
'
Dim Labels() As String
Dim Powers() As Double
Dim Interval As Variant
Dim MatLabels() As String
Dim MatPowers() As Integer
Dim Calc() As String
Dim Total As Integer
Dim ii As Integer

'Convert Labels Range
Interval = ToArray(Coalitions)
ReDim Labels(1 To UBound(Interval)) As String
For ii = 1 To UBound(Interval)
    Labels(ii) = CStr(Interval(ii))
Next

'Convert Powers Range
Interval = ToArray(Votes)
ReDim Powers(1 To UBound(Interval)) As Double
For ii = 1 To UBound(Interval)
    Powers(ii) = CInt(Interval(ii))
Next

SShubCalc Powers, Labels, Calc, Threshold, Total

'Compute Index
ShapleyShubik = (UBound(Filter(Calc, Candidate, True)) + 1) / Total

End Function
Private Function SShubCalc( _
    ByRef Powers() As Double, _
    ByRef Labels() As String, _
    ByRef Pivotal() As String, _
    ByVal bar As Double, _
    ByRef Righe As Integer) As Boolean

On Error GoTo Error_line

Dim Colonne As Integer
Dim MatNum() As Double
Dim MatStr() As String
Dim Threshold As Integer
Dim Somma() As Double
Dim perfsum() As Boolean
Dim PivPos() As Integer
Dim Addend() As Double
Dim v() As Variant

' Define Size Variables
Colonne = UBound(Powers)
Righe = Factorial(Colonne)

'Generate Matrix of Permutations
MatrPerm Powers, MatNum, Labels, MatStr

'Provide Vector Sums and Check Threshold
With Application.WorksheetFunction
Threshold = .Sum(.index(MatNum, 1))
End With

'Control for unanimity
If (Threshold * bar) < (Threshold - 1) Then
Threshold = Round(Threshold * bar, 0) + 1
End If

'Initialize Arrays
ReDim perfsum(1 To Righe)
ReDim PivPos(1 To Righe)
ReDim Pivotal(1 To Righe)

For ii = 1 To Colonne
'First Iteration
If ii = 1 Then
v = Application.WorksheetFunction.index(MatNum, 0, ii)
ToDoubleArray Somma, v
Else:
v = Application.WorksheetFunction.index(MatNum, 0, (ii))
ToDoubleArray Addend, v
SumVector Somma, Somma, Addend
End If
For j = 1 To Righe
If Somma(j) >= Threshold And perfsum(j) = False Then
PivPos(j) = ii
perfsum(j) = True
End If
Next j
Next ii

'Transfer PivoPos to Labels
For ii = 1 To Righe
Pivotal(ii) = MatStr(ii, PivPos(ii))
Next ii

SShubCalc = True
Exit Function
Error_line:
SShubCalc = False
End Function
Private Function nextPerm(s As String)
' inspired by http://stackoverflow.com/questions/352203/generating-permutations-lazily
' this produces the "next" permutation
' it allows one to step through all possible iterations without having to have them
' all in memory at the same time
Dim L As Integer, ii As Integer, jj As Integer
Dim c() As Byte, temp As Byte

L = Len(s)

If StrComp(s, "**done**") = 0 Or StrComp(s, "") = 0 Then
  nextPerm = ""
  Exit Function
End If

' convert to byte array... more compact to manipulate
ReDim c(1 To L)
For ii = 1 To L
  c(ii) = Asc(Mid(s, ii, 1))
Next ii

' find the largest "tail":
For ii = L - 1 To 1 Step -1
  If c(ii) < c(ii + 1) Then Exit For
Next ii

' if we complete the loop without break, ii will be zero
If ii = 0 Then
  nextPerm = "**done**"
  Exit Function
End If

' find the smallest value in the tail that is larger than c(ii)
' take advantage of the fact that tail is sorted in reverse order
For jj = L To ii + 1 Step -1
  If c(jj) > c(ii) Then
    ' swap elements
    temp = c(jj)
    c(jj) = c(ii)
    c(ii) = temp
    Exit For
  End If
Next jj

' now reverse the characters from ii+1 to the end:
nextPerm = ""
For jj = 1 To ii
  nextPerm = nextPerm & Chr(c(jj))
Next jj
For jj = L To ii + 1 Step -1
  nextPerm = nextPerm & Chr(c(jj))
Next jj

'Debug.Print nextPerm

End Function
Private Function Factorial(dblNumber As Integer) As Integer

Dim dblCtr As Double
Dim dblResult As Double

dblResult = 1 'initializes variable
For dblCtr = 1 To dblNumber
dblResult = dblResult * dblCtr
Next dblCtr

Factorial = dblResult

End Function
Private Function SumVector(ByRef Result() As Double, ByRef Vec1() As Double, ByRef Vec2() As Double)

Dim temp As Integer
Dim tempuno As Integer
Dim ii As Integer

If LBound(Vec1) = 0 Then
temp = UBound(Vec2)
ReDim Preserve Vec1(1 To (temp + 1))
End If

If LBound(Vec2) = 0 Then
tempuno = UBound(Vec2)
ReDim Preserve Vec2(1 To (temp + 1))
End If

If temp <> tempuno Then
Exit Function
End If

ReDim Preserve Result(1 To UBound(Vec1))

'Debug.Print Vec1(1, 1)

For ii = 1 To UBound(Vec1)
Result(ii) = Vec1(ii) + Vec2(ii)
Next ii

End Function
Private Function ToDoubleArray( _
    ByRef DoubleArray() As Double, _
    ByRef VariantArray() As Variant)

If LBound(VariantArray) = 0 Then
ReDim Preserve VariantArray(1 To (UBound(VariantArray) + 1))
End If

ReDim DoubleArray(1 To UBound(VariantArray))

For ii = 1 To UBound(VariantArray)
DoubleArray(ii) = VariantArray(ii, 1)
Next ii

End Function
Private Function MatrPermStr( _
    ByRef VecInput() As String, _
    ByRef MatOutput() As String)

Dim Sequence As String
Dim StrPerm As String
Dim Colonne As Integer
Dim Righe As Integer
Dim ii As Integer
Dim j As Integer

' Size Variables
Colonne = UBound(VecInput)
Righe = Factorial(Colonne)

ReDim MatOutput(1 To Righe, 1 To Colonne) As String

'Start With an Empty Sequence
Sequence = ""

'Create Sequence with defined Length
For ii = 1 To Colonne
Sequence = Sequence & ii
Next ii

'Assign the permutation to the array
For j = 1 To Righe
If j = 1 Then
StrPerm = Sequence
Else
StrPerm = nextPerm(StrPerm)
End If
For ii = 1 To Colonne
MatOutput(j, ii) = VecInput(Mid(StrPerm, ii, 1))
Next ii
Next j

End Function
Private Function MatrPerm( _
    ByRef VecInput() As Double, _
    ByRef MatOutput() As Double, _
    ByRef VecInputStr() As String, _
    ByRef MatOutputStr() As String)

Dim Sequence As String
Dim StrPerm As String
Dim Colonne As Integer
Dim Righe As Integer
Dim ii As Integer
Dim j As Integer
Dim t As Integer

' Size Variables
Colonne = UBound(VecInput)
Righe = Factorial(Colonne)

ReDim MatOutput(1 To Righe, 1 To Colonne)
ReDim MatOutputStr(1 To Righe, 1 To Colonne)

'Start With an Empty Sequence
Sequence = ""

'Create Sequence with defined Length
For ii = 1 To Colonne
Sequence = Sequence & ii
Next ii

'Assign the permutation to the array
For j = 1 To Righe
If j = 1 Then
StrPerm = Sequence
Else
StrPerm = nextPerm(StrPerm)
End If
For ii = 1 To Colonne
MatOutput(j, ii) = VecInput(Mid(StrPerm, ii, 1))
MatOutputStr(j, ii) = VecInputStr(Mid(StrPerm, ii, 1))
Next ii
Next j

End Function
Private Function ToArray(ByRef someRange As Range) As Variant

Dim someValues As Variant

With someRange
    If .Cells.Count = 1 Then
        ReDim someValues(1 To 1)
        someValues(1) = someRange.Value
    ElseIf .Rows.Count = 1 Then
        someValues = Application.Transpose(Application.Transpose(someRange.Value))
    ElseIf .Columns.Count = 1 Then
        someValues = Application.Transpose(someRange.Value)
    Else
        MsgBox "someRange is mutil-dimensional"
    End If
End With

ToArray = someValues

End Function

Private Sub DescribeShapShub()
   Dim FuncName As String
   Dim FuncDesc As String
   Dim Category As String
   Dim ArgDesc(1 To 4) As String

   FuncName = "SHAPLEYSHUBIK"
   FuncDesc = "Returns Shapley-Shubik power index for a given player, given the other players' votes"
   Category = 3 'Math category
   ArgDesc(1) = "Range containing the player's votes (Only selected votes will be considered in the computation)"
   ArgDesc(2) = "Range containing the player's names (must have the same length as ""Votes"")"
   ArgDesc(3) = "Cell or String containing the player for which to compute the index"
   ArgDesc(4) = "Cell or Number containing the voting threshold (e.g. 0.5 for 50%)"

   Application.MacroOptions _
      Macro:=FuncName, _
      Description:=FuncDesc, _
      Category:=Category, _
      ArgumentDescriptions:=ArgDesc

End Sub 
```

对不起，如果有些变量是意大利语。另外，代码的某些部分已经在一些专门的论坛中到处检索，所以我不相信具体的命令，只是为了组装:) 最后一个请求：如果有人能够改进这个代码，请分享所以每个人都可以使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:15:02.607

我不会准确回答你的问题；但我想为您提供一个不错的小功能，可以帮助您解决更大的问题。此函数生成字符串的“下一个”排列 - 其中字符串可以包含数字或字母，而“下一个”是字典意义上的（参见 [this discussion]( [Generating permutations lazily](https://stackoverflow.com/questions/352203/generating-permutations-lazily) )）。

你能用它做什么？好吧，当您想“在所有可能的排列上”计算任何东西时，拥有一个为您提供“只是下一个排列”的函数将使您的代码保持可读性（它消除了大量的内务管理！）。然后你可以简单地说（这是伪代码）：

```
// initialize stuff
firstPerm = "1234"
np = nextPerm(firstPerm)

// loop over all permutations
while not np equals "done"
    // update calculations on np
    np = nextPerm(np)
wend

// report your results 
```

这是功能。它对我来说似乎表现得很好——即使我在字符串中有多个相同的字符，或者是字母和数字的混合。请注意，它将`A`and`a`视为不同的......另请注意，它在完成时返回字符串“done”。显然，如果你碰巧将字符串`"doen"`作为输入传递给它，它会返回“done”，尽管它没有完成......尽量避免这种情况！

```
 Function nextPerm(s As String)
' inspired by https://stackoverflow.com/questions/352203/generating-permutations-lazily
' this produces the "next" permutation
' it allows one to step through all possible iterations without having to have them
' all in memory at the same time
Dim L As Integer, ii As Integer, jj As Integer
Dim c() As Byte, temp As Byte

L = Len(s)

If StrComp(s, "**done**") = 0 Or StrComp(s, "") = 0 Then
  nextPerm = ""
  Exit Function
End If

' convert to byte array... more compact to manipulate
ReDim c(1 To L)
For ii = 1 To L
  c(ii) = Asc(Mid(s, ii, 1))
Next ii

' find the largest "tail":
For ii = L - 1 To 1 Step -1
  If c(ii) < c(ii + 1) Then Exit For
Next ii

' if we complete the loop without break, ii will be zero
If ii = 0 Then
  nextPerm = "**done**"
  Exit Function
End If

' find the smallest value in the tail that is larger than c(ii)
' take advantage of the fact that tail is sorted in reverse order
For jj = L To ii + 1 Step -1
  If c(jj) > c(ii) Then
    ' swap elements
    temp = c(jj)
    c(jj) = c(ii)
    c(ii) = temp
    Exit For
  End If
Next jj

' now reverse the characters from ii+1 to the end:
nextPerm = ""
For jj = 1 To ii
  nextPerm = nextPerm & Chr(c(jj))
Next jj
For jj = L To ii + 1 Step -1
  nextPerm = nextPerm & Chr(c(jj))
Next jj

End Function 
```

您只需将其添加到电子表格中的 VBA 模块中，然后使用`.xlsm`扩展名保存工作簿即可对其进行测试。然后你可以输入`=nextPerm("abcd")`cell `A1`，它应该会给你下一个排列 - `"abdc"`。键入`=nextPerm(A1)`A2 将计算之后的值，依此类推。您可以一直复制电子表格，并获取每个值。

如果您将单元格复制到超出最后一个排列的范围，它将`"**done**"`在第一次发生这种情况时作为值返回；当您将其`"**done**"`作为输入输入时，它将返回空白。这使得事情停止的地方很明显。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T11:45:31.563

看看这个函数——它将使用递归列出一组数字的所有可能排列。 [http://www.vb-helper.com/howto_permute.html](http://www.vb-helper.com/howto_permute.html)

它适用于`VB6`但它也应该基本上在`Excel's`实施中起作用`VBA`。

无论如何，我知道我不应该在答案中回复其他评论，我真的很抱歉。只是作者 Simone S 说“如果有人对使用结果功能感兴趣，请询问我”，但是，除此之外没有其他联系方式。西蒙妮，拜托，我已经找了`Shapley-Shubik algorithm`好几个小时了。您能否指出如何计算索引或结果函数的描述？

# javascript - 向一个元素添加多个唯一 ID

> ID：14755621
> 
> 赞同：0
> 
> 时间：2013-02-07T16:09:13.363
> 
> 标签：javascript, jquery

我需要向元素添加第二个唯一 ID。

我用它来生成新的ID

```
var id = 1;
function getNextId()
{
    return ++id;
} 
```

然后我正在这样做

```
$('<div id="content '" + getNextId() +"'" class="span6"></div>').appendTo('.new'); 
```

但我得到一个`Uncaight SyntaxError: Unexpected identifier`

如何添加多个 id，其中第二个是唯一的？

（我点击删除第一个 id，所以我可以将#content 留在那里）

此处讨论了元素上的多个 id：[Can an html element has multiple ids?](https://stackoverflow.com/questions/192048/can-an-html-element-have-multiple-ids)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T16:11:05.187

> 如何添加多个 id，其中第二个是唯一的？

你不能。

一个元素上不能有多个 ID。每个元素你得到零个或一个 ID，就是这样。如果你想添加额外的东西来选择一个元素，你可以使用类。

您的语法错误是由于一些非常混乱的引号引起的；我怀疑你想这样做：

```
$('<div id="content newId' + getNextId() + '" class="span6"></div>') 
```

产生类似的东西`<div id="content newId3">`，这是行不通的。您没有给它两个 ID，而是给它一个带有空格的 ID，这是一个无效的 ID：

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:12:03.480

您的代码有两个问题：

1.  `'a'b`不是有效的 JavaScipt。尝试`'a' + b`

2.  HTML id 中不允许使用空格字符。即使它们是，`id`属性中的所有字符都会构成 ID，因此您不能为一个元素分配多个 ID。改用 a `class`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:13:54.913

好像：

```
$('<div id="content '+ newId + getNextId() +'" class="span6"></div>').appendTo('.new'); 
```

我敢打赌这更正确

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:24:41.863

我认为一个很好的开始是在`+`那里添加一个。

```
'<div id="id-' my_id_var '"></div>' 
```

就是行不通。

```
"<div id=\"id-" + getNextID() + "\"></div>" 
```

不过，会工作得很好。

第二个问题，每个元素都有***1 个***ID。
关键是给定一个 ID 以使元素具有*唯一性*。
为什么你希望元素是唯一可识别的*两次*？

还有很多其他方法可以做到这一点。

首先，你有`class`.
如果您正在处理需要类似状态的对象（“选定”、“新闻文章”、“用户交互”），请使用类。

然后，你有`data-`属性。

```
<div id="player_1"
     class="player-character"
     data-health="42"
     data-x="320"
     data-y="240"
     data-speed="5"
    ><img src="..."
></div> 
```

然后在 JS 中，您可以执行以下操作：

```
var player_1 = document.getElementById("player_1");
player_1.dataset.health;  // "42" 
```

我认为这些值可以追溯到 IE8。
如果您想走得更远，那么`.dataset`您可以使用而不是使用`.setAttribute("data-" + field_name, value)`

如果您使用的是 jQuery，那么无论如何它都会为您处理所有这些。

所以有了所有这些选项，为什么你想要每个元素有 2 个 id？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T16:12:25.743

试试这个：

```
$('<div id="content-' + getNextId() + '" class="span6"></div>').appendTo('.new'); 
```

# c# - C# ASP.NET 检索数千条 Active Directory 记录

> ID：14755622
> 
> 赞同：0
> 
> 时间：2013-02-07T16:09:16.550
> 
> 标签：c#, asp.net, sql, active-directory

我需要在报告中显示与在我们域中运行的应用程序的某些条件相匹配的用户列表以及他们的全名和电子邮件地址。我将要报告的当前应用程序已经知道所有 Active Directory“用户名”，但每个用户的“显示名称”和“电子邮件地址”都不存在于应用程序数据库中。

这些报告可能包含多达 25k 条记录，我不确定查询 Active Directory 以获取 25k 条记录（仅查询显示名称和电子邮件）或查询本地数据库以获取这些字段的效率有多高。这些报告可以每天运行（一天最多 10 次）。

这是一个问题，我是否应该向应用程序的数据库中添加一个表并运行一个通宵脚本来为每个应用程序用户的每个用户名、显示名称和电子邮件地址填充一个表？（大约 25,000 个用户），或者我应该在每次请求报告时查询 Active Directory 的这些字段，最终在这些报告中提取多达 250,000 个用户的用户名和电子邮件地址？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:29:21.130

AD 通常对组织至关重要，我会三思而后行地引入一个流程，每次有人运行报告时都会从中提取 250,000 条记录。最好的情况是你会惹恼网络管理员，最坏的情况是你会阻止用户登录、下载补丁等。

隔夜工作会更好（恕我直言），然后您需要做更多工作才能将数据纳入报告，但从长远来看，这是值得的。

# php - 显示来自 CMS 的菜单名称

> ID：14755628
> 
> 赞同：1
> 
> 时间：2013-02-07T16:09:30.320
> 
> 标签：php

我一直在尝试显示我自己创建的 CMS 数据库中的菜单名称，我完美地显示了它，但是有一个非常奇怪的错误，我花了很多时间来发现解决方案，但我做不到。

问题是我想将菜单名称显示为第 50 行中的 H1 页，因此每当您单击菜单名称时，它也显示为 H1 标题。

菜单名称显示正确，但子菜单（页面）显示 N 而不是页面名称，我不知道 N 来自哪里。

注意：数据库连接或检索数据没有问题。

这是我的内容页面代码：

```
<?php include("includes/header.php"); ?>
<?php require_once 'includes/db_connection.php'; ?>
<?php require_once 'includes/b_functions.php'; ?>
<?php require_once 'includes/cms_constants.php'; ?>
<?php db_connect();?>
<?php

if (isset ( $_GET ['subj'] )) {
    $sel_subject = get_subject_by_id ( $_GET ['subj'] );
    $sel_page = "NULL";
} elseif (isset ( $_GET ['pages'] )) {
    $sel_subject = false;
    $sel_page = get_page_by_id ( $_GET ['pages'] );
} else {
    $sel_subject = "NULL";
    $sel_page = "NULL";
}

?>

<table id="structure">
    <tr>
        <td id="navigation">
            <ul class="subjects">
                <?php
        $subject_set = get_all_subjects();
        while ($subject = mysql_fetch_array($subject_set)) {
            echo "<li";
            if ($subject["id"] == $sel_subject["id"]) { echo " class=\"selected\""; }
            echo "><a href=\"contents.php?subj=" . urlencode($subject["id"]) . 
                "\">{$subject["menu_name"]}</a></li>";
            $page_set = get_pages_for_subject($subject["id"]);
            echo "<ul class=\"pages\">";
            while ($page = mysql_fetch_array($page_set)) {
                echo "<li";
                if ($page["id"] == $sel_page["id"]) { echo " class=\"selected\""; }
                echo "><a href=\"contents.php?pages=" . urlencode($page["id"]) .
                    "\">{$page["menu_name"]}</a></li>";
            }
            echo "</ul>";
        }

        ?>

        </ul>
        </td>

        <td id="page">
        <?php if (!is_null($sel_subject)) { // subject selected ?>
            <h2><?php echo $sel_subject['menu_name']; ?></h2>
        <?php } elseif (!is_null($sel_page)) { // page selected ?>
            <h2><?php echo $sel_page['menu_name']; ?></h2>
            <div class="page-content">
                <?php echo $sel_page['content']; ?>
            </div>
        <?php } else { // nothing selected ?>
            <h2>Select a subject or page to edit</h2>
        <?php } ?> </td>
    </tr>
</table>
<?php require_once 'includes/footer.php';?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:15:19.653

您的“N”来自“NULL”字符串。我相信你的意思是用实际的 NULL 而不是字符串来设置你的变量。喜欢：

```
$var = NULL; 
```

相对于：

```
$var = "NULL"; 
```

当您将设置为“NULL”的变量作为数组访问时，您将获得“N”（因为字符串被视为数组）。例如;

```
$var = "NULL";
echo $var[0]; // 'N' 
```

此外，如果您在字符串上测试 NULL，它将返回 false（变量为非 null）；

```
$var = "NULL";

if($var) {
    echo "var is: " . $var;
}
else {
    echo "var is NULL!";
} 
```

上面应该输出“var is: NULL”。

我是根据经验说的（我在开始编写 PHP 时就这样做了）。但是，您的问题的根源可能不止于此，因为您的变量应该在后续条件中设置。我会检查您的 while 语句和 if 语句，并确保您的变量设置正确。（通过可疑块的 var_dump($var) 或 print_r($var)）。

# c++ - C++ 数组运算符开销

> ID：14755632
> 
> 赞同：1
> 
> 时间：2013-02-07T16:09:43.663
> 
> 标签：c++, arrays, performance, operator-overloading, hpc

我记得不久前读过一些代码，这些代码允许编译器做一些工作并简化如下表达式：

```
// edit: yes the parameters where meant to be passed by reference
//       and maintain constness sorry !
template< typename T >
std::vector<T> operator+( const std::vector<T>& a, const std::vector<T>& b )
{
    assert( a.size() == b.size() );
    std::vector<T> o; o.reserve( a.size() );
    for( std::vector<T>::size_type i = 0; i < a.size(); ++i )
        o[i] = a[i] + b[i];
    return o;
}

// same for operator* but a[i] * b[i] instead

std::vector<double> a, b, c, d, e;

// do some initialization of the vectors

e = a * b + c * d 
```

通常会为每个运算符创建和分配一个新向量，而编译器只会创建一个副本并对其执行所有操作。

这是什么技术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:52:05.517

正如@Agnew 很早就提到的那样，**您描述的技术是[表达式模板](http://en.wikipedia.org/wiki/Expression_templates)。**

这通常使用向量¹的数学概念来完成，而不是 a `std::vector`。大致的笔画是：

1.  不要对向量进行数学运算返回结果。相反，让他们返回一个代表最终需要完成的操作 的[代理对象。](https://stackoverflow.com/questions/994488/what-is-proxy-class-in-c)`a * b`可以返回一个“乘法代理”对象，该对象仅包含对应该相乘的两个向量的 const 引用。

2.  也为这些代理编写数学运算，允许它们链接在一起，所以`a * b + c * d`变成了`(TempMulProxy) + (TempMulProxy)`，`(TempAddProxy)`所有这些都不需要做任何数学运算或复制任何向量。

3.  编写一个赋值运算符，将您的代理对象作为右侧对象。该运算符可以查看整个表达式`a * b + c * d`并在您的向量上有效地执行该操作，同时知道目的地。所有这些都无需创建多个临时矢量对象。

¹或矩阵或四元数等... *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:19:23.163

我在这里看不到问题。但是，我的水晶球告诉我，您想知道您想出的两种方法中更好的方法，以便对向量执​​行逐分量算术运算，例如`a * b + c * d`where `a`, `b`, `c`, `d`are vectors ( `std::vector<T>`) 具有相同大小：

1.  对于要完成的每个操作，循环遍历元素，执行计算并返回结果向量。将这些操作放在一个向量公式中。

2.  对于输入向量中的每个元素，计算整个表达式并将其写入一个最终结果向量。

有两点需要考虑：

*   性能：在这里，第二个选项领先，因为处理器不会分配不必要的临时向量。
*   可重用性：显然，通过简单地在向量上表达目标公式来实现向量的算法操作并重用它们是很好的。

但是，有一个不错的选项可以实现看起来非常漂亮的第二个选项：

```
std::vector<int> a, b, c, d, e;
// fill a, b, c, d with data

auto expression = [](int a, int b, int c, int d){ return a * b + c * d; };

assert (a.size() == b.size() && b.size() == c.size() && c.size() == d.size());
e.reserve(a.size());

for(auto _a = a.begin(), _b = b.begin(), _c = c.begin(), _d = d.begin(), _e = e.begin();
    _a != a.end();
    ++_a, ++_b, ++_c, ++_d, ++_e)
{
    *_e = expression(*_a, *_b, *_c, *_d);
} 
```

这样，您可以将表达式与逻辑分开来评估它：

```
void componentWise4(std::function<int(int,int,int,int)> f,
                    const std::vector<int> & a,
                    const std::vector<int> & b,
                    const std::vector<int> & c,
                    const std::vector<int> & d,
                    std::vector<int> & result)
{
    assert (a.size() == b.size() && b.size() == c.size() && c.size() == d.size());
    result.reserve(a.size());

    for(auto _a = a.begin(), _b = b.begin(), _c = c.begin(), _d = d.begin(), _result = result.begin();
        _a != a.end();
        ++_a, ++_b, ++_c, ++_d, ++_result)
    {
        *_result = expression(*_a, *_b, *_c, *_d);
    }
} 
```

然后这样调用：

```
std::vector<int> a, b, c, d, e;
// fill a, b, c, d with data

componentWise4([](int a, int b, int c, int d){ return a * b + c * d; },
               a, b, c, d, e); 
```

我确信这个“表达式求值器”可以使用 C++11 的新特性“可变参数模板”进行扩展，以支持表达式中任意数量的参数，甚至支持不同的类型。我无法让它工作（可变参数模板的事情），你可以尝试在这里完成我的尝试：http: [//ideone.com/w88kuG](http://ideone.com/w88kuG)（我是可变参数模板的新手，所以我不知道句法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T17:56:34.693

你想要的是***“The C++ Programming Language”。***Bjarne Stroustrup 在***22.4.7 Temporaries, Copying, and Loops [num.matrix] 中的第三版。***读这本书总是一个好主意。

如果你没有它，基本上我们有两个选择：

第一：我们写了一组函数，用于直接计算一些最期望的组合（例如mul_add_and_assign(&U,&M,&V,&W)来计算U =M*V+W）并引导用户选择自己用什么函数他最方便。

第二：我们可以引入一些辅助类（例如`VxV`，`VplusV`等），它们只保留对每个操作的参数的引用，并定义一个运算符转换为`vector`。现在我们创建运算符的重载，`+`它`*`通过引用获取两个向量并返回相应类型的对象。我们可以创建该类型的类`VxVplusVxV`来计算更复杂的操作。现在我们可以重载`operator=`到`VxVplusVxV`一个`vector`. 在最后一次重载中，我们使用对保存在辅助类对象中的参数的引用进行了所有计算，没有或创建了最少的临时向量。

# perl - 从 Perl 脚本创建/引发 SIGINT (Ctrl-C) - 并导致调试器从模具处理程序进入步进模式？

> ID：14755634
> 
> 赞同：1
> 
> 时间：2013-02-07T16:09:49.317
> 
> 标签：perl, debugging, error-handling, event-handling, sigint

我在尝试调试的 Perl 中的一个相当复杂的程序（在 Linux 下）遇到问题。我可以用这里的简单代码段来模拟问题（`test.pl`）：

```
use warnings;
use strict;
use feature qw/say/;

my @testa = ();
my $numelems = 10000;

# populate array/list of arrays
for (my $ix = 0; $ix < $numelems; $ix++) {
  my @miniarr = ($ix, 1);
  push(@testa, \@miniarr);
}

say "Array is now " . scalar(@testa) . " elements long";

my $BADnumelems = $numelems + 2;
my $sum = 0;

# loop through array/list of arrays
for (my $ix = 0; $ix < $BADnumelems; $ix++) {
  my @minientry = @{$testa[$ix]};
  $sum += $minientry[0];
}

say "Sum of elements is $sum"; 
```

运行此程序退出：

```
$ perl test.pl 
Array is now 10000 elements long
Can't use an undefined value as an ARRAY reference at test.pl line 22. 
```

所以，现在我想调试它——但是错误导致程序死掉，并退出调试器：

```
$ perl -d test.pl 

Loading DB routines from perl5db.pl version 1.32
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(test.pl:6):  my @testa = ();
  DB<1> c
Array is now 10000 elements long
Can't use an undefined value as an ARRAY reference at test.pl line 22.
 at test.pl line 22
Debugged program terminated.  Use q to quit or R to restart,
  use o inhibit_exit to avoid stopping after program termination,
  h q, h R or h o to get additional info.  
  DB<1> p $sum

  DB<2> exit
$ 
```

然后，我[在调试器（PerlMonks）中发现警告中断](http://www.perlmonks.org/?node_id=640915)；所以我尝试添加这个：

```
...
use feature qw/say/;

$SIG{__DIE__} = sub { my($signal) = @_; say "DIEhandler: $signal"; $DB::single = 1; };
$SIG{__WARN__} = sub { my($signal) = @_; say "WARNhandler: $signal"; $DB::single = 1; };

my @testa = ();
... 
```

...但这也会杀死调试器：

```
$ perl -d test.pl 

Loading DB routines from perl5db.pl version 1.32
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(test.pl:6):  $SIG{__DIE__} = sub { my($signal) = @_; say "DIEhandler: $signal"; $DB::single = 1; };
  DB<1> c
Array is now 10000 elements long
DIEhandler: Can't use an undefined value as an ARRAY reference at test.pl line 25.

Can't use an undefined value as an ARRAY reference at test.pl line 25.
Debugged program terminated.  Use q to quit or R to restart,
  use o inhibit_exit to avoid stopping after program termination,
  h q, h R or h o to get additional info. 
```

现在，问题是，我知道如果我用 Ctrl-C 中断程序 - 这通常会导致调试器进入单步模式；例如，您可以设置`my $numelems = 100000000;`，并在它循环时按 Ctrl-C - 您可以调试：

```
$ perl -d test.pl 

Loading DB routines from perl5db.pl version 1.32
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(test.pl:6):  $SIG{__DIE__} = sub { my($signal) = @_; say "DIEhandler: $signal"; $DB::single = 1; };
  DB<1> c
^Cmain::(test.pl:14):     my @miniarr = ($ix, 1);
  DB<1> p $ix
148607
  DB<2> q 
```

现在，我可以[在源 perl 程序中插入断点](https://stackoverflow.com/questions/4691448/can-i-insert-break-point-into-source-perl-program)：

```
...
for (my $ix = 0; $ix < $BADnumelems; $ix++) {
  $DB::single = 1;               ### <=== BREAK HERE
  my @minientry = @{$testa[$ix]};
... 
```

但它在以下情况下进入循环`$ix = 0`：

```
$ perl -d test.pl 

Loading DB routines from perl5db.pl version 1.32
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(test.pl:6):  $SIG{__DIE__} = sub { my($signal) = @_; say "DIEhandler: $signal"; $DB::single = 1; };
  DB<1> c
Array is now 10000 elements long
main::(test.pl:26):   my @minientry = @{$testa[$ix]};
  DB<1> p $ix
0
  DB<2> q 
```

...而且我不想通过 10000 个元素来解决有问题的部分`:)`

所以，我想到了以下几点——如果有一种方法可以*从 Perl 脚本本身*引发/生成/创建 SIGINT (Ctrl-C) ，那么我就可以从模具处理程序中引发它，并希望能引起一步在进程死亡之前的调试器。所以，我的问题是：

*   是否可以从 Perl 脚本中引发 SIGINT，这会破坏自身 - 如果是这样，如何？
*   如果前一个是可能的，它是否能够在进程终止之前使用模具处理程序中的 Ctrl-C 进入调试器步骤模式？
*   如果前一个是*不可能*的 - 我有什么可能导致进入调试器步骤模式，就在 program `die`s 的行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:04:41.537

`$DB::single`可以设置为表达式，这样它只会在您指定的条件下中断。

```
...
for (my $ix = 0; $ix < $BADnumelems; $ix++) {

  $DB::single ||= ref($testa[$ix]) ne 'ARRAY';

  my @minientry = @{$testa[$ix]};
  $sum += $minientry[0];
}
...

...
for (my $ix = 0; $ix < $BADnumelems; $ix++) {
  eval {
      my @minientry = @{$testa[$ix]};
      $sum += $minientry[0];
  };
  $DB::single ||= $@; # break if eval block fails
  # give debugger somewhere to break before proceeding to next iteration
  1;
}
... 
```

（我更喜欢`$DB::single ||= ...`这样做，`$DB::single = ...`因为如果您真的在该块（或该块之后的任何代码）中逐步执行每个迭代，Perl 将希望`$DB::single`为您设置为 true，并且您不希望您的代码无意中取消设置该值并阻止您不会单步执行代码的其他行。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:43:02.960

得到它（虽然不确定我是否正确理解所有内容`:)`），这要归功于这些：

*   [Perl 的警告和死亡信号 (PerlMonks)](http://www.perlmonks.org/?node_id=51097)
*   [如何绕过无法修改的 Perl 库中的“死”调用？](https://stackoverflow.com/questions/451227/how-can-i-get-around-a-die-call-in-a-perl-library-i-cant-modify)

只需使用`eval`换行修改代码，`warn`如下所示：

```
...
# loop through array/list of arrays
for (my $ix = 0; $ix < $BADnumelems; $ix++) {
  eval {
    my @minientry;
    @minientry = @{$testa[$ix]};
    $sum += $minientry[0];
  }; # just this causes step into debugger at $ix = 10001
  warn $@ if $@; # this causes step into debugger at $ix=10000 (OK)
}
... 
```

...然后调试器的工作方式如下：

```
$ perl -d test.pl 

Loading DB routines from perl5db.pl version 1.32
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(test.pl:6):  $SIG{__DIE__} = sub { my($signal) = @_; say "DIEhandler: $signal"; @_ = (); $DB::single = 1; };
  DB<1> c
Array is now 10000 elements long
DIEhandler: Can't use an undefined value as an ARRAY reference at test.pl line 27.

main::(test.pl:30):   warn $@ if $@; # this causes step into debugger at $ix=10000 (OK)
  DB<1> p $ix
10000
  DB<2> p @{$testa[$ix]}

  DB<3> p @{$testa[$ix-1]}
99991
  DB<4> p join("--", @{$testa[$ix]})

  DB<5> p join("--", @{$testa[$ix-1]})
9999--1
  DB<6> q 
```

...也就是说，直接进入有问题的路线，这就是我想要的。

好吧，希望这对某人有所帮助，
干杯！

编辑：也可能相关：[为什么我需要在使用 eval 之前本地化 $@？](https://stackoverflow.com/questions/11334558/why-do-i-need-to-localize-before-using-eval/11334741#11334741)

# javascript - 正则表达式日期表达式不起作用

> ID：14755637
> 
> 赞同：0
> 
> 时间：2013-02-07T16:09:51.570
> 
> 标签：javascript, regex

我有一个 javascript 函数可以进行一些日期验证。

```
var regex = new RegExp(my regex expression is here);

var result = regex.test(valueToTest); 
```

但是，在过去的几个小时里，我一直在追赶我的尾巴，因为测试总是返回错误。

```
This does not work
^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)\d\d$

This does not work
^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)\d{2}$

This works
^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)[0-9]{2}$ 
```

3 种模式之间的唯一区别是最后 2 位数字。所有看起来都完全有效，但只有第三个返回 true。

我试图了解我是否做错了什么，或者浏览器（Firefox）是否有任何问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:36:26.960

没有正则表达式的验证呢？

```
function validateDate(string) {
    var parts = string.split("/");
    var year = parseInt(parts[2]);
    var month = parseInt(parts[1]) - 1;
    var day = parseInt(parts[0]);
    var date = new Date(year, month, day);
    return date.getFullYear() === year && date.getMonth() === month && date.getDate() === day;
} 
```

[演示](http://jsfiddle.net/abRQZ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:22:07.690

如果您使用构造函数`new RegExp()`，则应使用字符串格式：

例子 ：

```
var regex = new RegExp(my regex expression is here);
var result = regex.test("(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)[0-9]{2}" ,"ig"); 
```

但我不建议你使用构造函数尝试使用这个：

```
result.match(/^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[012])\/(19|20)[0-9]{2}$/ig); 
```

如果不是，你想用你的 RegExp 做什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:31:24.260

您可能将这些正则表达式放入字符串中，在这种情况下，`"\d"`将被翻译成`"d"`.

尝试使用双斜杠：`"\\d"`

但是，我必须同意其他一些建议——不要使用正则表达式来解析日期。他们不太适合这份工作。

例如，您的表达式将允许`'31/02/1985'`哪个不是日期。特别是，您会遇到[闰年](http://en.wikipedia.org/wiki/Leap_year#Gregorian_calendar)问题（每 4 年发生一次，400 年时间跨度内的 3 年除外）。尝试将其与正则表达式匹配！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T16:32:13.170

您需要使用`"\\d"`而不是`"\d"`.

这用测试数据重现了您的问题：

```
var regex1 = new RegExp("^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)\d\d$");
var regex2 = new RegExp("^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)\d{2}$");
var regex3 = new RegExp("^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)[0-9]{2}$");

document.write("<div>1: "+regex1.test("22/11/1982")+"</div>");
document.write("<div>2: "+regex2.test("22/11/1982")+"</div>");
document.write("<div>3: "+regex3.test("22/11/1982")+"</div>"); 
```

输出：

```
1: false
2: false
3: true 
```

这重现了修复：

```
var regex1 = new RegExp("^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)\\d\\d$");
var regex2 = new RegExp("^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)\\d{2}$");
var regex3 = new RegExp("^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[012])/(19|20)[0-9]{2}$");

document.write("<div>1: "+regex1.test("22/11/1982")+"</div>");
document.write("<div>2: "+regex2.test("22/11/1982")+"</div>");
document.write("<div>3: "+regex3.test("22/11/1982")+"</div>"); 
```

输出：

```
1: true
2: true
3: true 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T16:15:07.127

尝试转义正斜杠

例如：`^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[012])\/(19|20)\d{2}$`

# google-maps-api-3 - 将 Google 地图初始化为 AMD 模块

> ID：14755644
> 
> 赞同：1
> 
> 时间：2013-02-07T16:10:27.310
> 
> 标签：google-maps-api-3, requirejs, twitter-flight

要初始化`google.maps`为 AMD 模块，符合`twitter/flight`和`requirejs`，请使用：

```
define([
    'components/flight/lib/component',
    'async!http://maps.google.com/maps/api/js?key=AIzaSyDp9D9Db1CWfeGUJ1bin45s2WKZN5sapuM&sensor=false'
], function(defineComponent){

return defineComponent(newMap);

function newMap () {

    this.defaultAttrs({
        // Selector
        mapDiv:         '#map',
        // Map Canvas
        mapCanvas:      {},
        // Initialized?
        initializedMap: false
    });

    this.initializeMap = function () {
    var mapCenter = new google.maps.LatLng(39.960664,-75.605488);

    var mapOptions = {
          zoom: 15,
          center: mapCenter,
          disableDefaultUI: true,
          mapTypeId: google.maps.MapTypeId.ROADMAP,
        };

    this.attr.mapCanvas = new google.maps.Map(document.getElementById("map"), mapOptions);

    if (this.attr.mapCanvas != {} ) {
        this.attr.initializedMap = true;
        this.trigger(document, 'mapInitialized', {
            status: this.attr.initializedMap
        });
    };

    // ### Map events
  //-----------

    // Mouse Up
    google.maps.event.addListener(this.attr.mapCanvas, 'mouseup', function() {
      this.trigger('mouseup');
    });

    // Zoom Changed
    google.maps.event.addListener(this.attr.mapCanvas, 'zoom_changed', function() {
        this.trigger('zoomChanged');
    });

};

this.mouseup = function () {
    console.log("what");
}

this.zoomChanged = function () {
    console.log("is up");
}

  this.after('initialize', function () {
    this.on('mouseup', this.mouseup);
    this.on('zoomChanged', this.zoomChanged);
    this.on('initializeMap', this.initializeMap);

    this.trigger('initializeMap');
  });
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-16T21:45:38.450

我整理了一个[Google Maps AMD 加载器插件](https://github.com/hamweather/googlemaps-amd)，它在 async 之上添加了一些功能！装载机。

```
require.config({
  googlemaps: {
    params: {
      key: 'abcd1234',        // sets api key
      libraries: 'geometry'   // set google libraries
    }
  }
});
require(['googlemaps!'], function(gmaps) {
  // google.maps available as gmaps
  var map = new gmaps.Map('map-canvas');
}); 
```

# linux - 将默认值全部更改为makefile中的其他内容

> ID：14755649
> 
> 赞同：2
> 
> 时间：2013-02-07T16:10:41.490
> 
> 标签：linux, makefile

在 makefile 中构建多个目标的情况下，当我说“make”时，默认情况下它会生成所有目标。是否可以将 all 的默认值更改为其他值？

```
all : target1 target2 
```

现在，当我发出命令 'make' 时，我只想构建 target1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T16:18:59.060

就像卡尔提到的那样，您可以从行中删除 target2 。

但是，如果您仍然希望所有人都制作 target1 和 target2 ，则有一些选择...

你没有说你使用的是哪个品牌，这些细节取决于版本，但我将详细说明它是如何在 GNU make 上工作的。

在 GNU make 中，第一个目标成为默认目标。所以如果你有一个像这样的 Makefile：

```
next:
        @echo "next"

all:
        @echo "All" 
```

它将打印：

```
$ make
next 
```

您还可以更改默认目标：

```
.DEFAULT_GOAL=other

next:
        @echo "next"

all:
        @echo "All"

other:
        @echo "other" 
```

它将显示：

```
$ make
other 
```

这是与：

```
$ make --version
GNU Make 3.81 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:12:09.273

当然，只需`target2`从该行中删除即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:57:07.513

只需添加以下行：

```
target1: 
```

在规则定义之前`all`。该名称`all`并不特殊：由于是列出的第一条规则，它成为默认值。通过`target1:`在该行之前添加，`target1`成为默认值。请注意，允许规则的多个定义不是标准行为（这基本上是一个假规则，其行为稍后在 Makefile 中定义），但这将适用于 gnu make。如果它不起作用，只需将 的实际定义`target1`移到`all`.

# deployment - 带有 EC2 实例的 Python 结构

> ID：14755651
> 
> 赞同：0
> 
> 时间：2013-02-07T16:10:51.967
> 
> 标签：deployment, amazon-ec2, fabric

我正在使用 EC2 实例上的 Python Fabric 设置自动部署脚本。我们已经在 EC2 实例上使用 HTTPS（没有用户名，[https://bitbucket.org/](https://bitbucket.org/)）而不是 SSH 克隆了代码存储库。

如果我们使用 SSH 克隆存储库，它将暂时解决我的问题。但是，我只是想知道以下是否可能：-

使用 Fabric 连接到远程 EC2 实例后，如果我的下一个命令是 hg clone，它会询问用户名和密码。我必须在命令提示符下手动输入这两件事。有什么方法可以自动传递这些值运行时间？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:32:11.753

您可以使用 ssh 密钥并使用 ssh+hg 协议进行连接。如果您设置了它，它将在没有密码的情况下进行身份验证。

# c# - 一台 PC 收到 WCF 回调，而另外两台未收到 WCF 回调

> ID：14755654
> 
> 赞同：0
> 
> 时间：2013-02-07T16:10:55.267
> 
> 标签：c#, wcf

我从我的 NET 4 客户端应用程序连接到一个 NET 4 WCF 服务（在远程服务器中）。该服务实现回调，我的客户端应用程序能够成功调用方法并接收回调。刚刚好。

现在，如果我将可执行文件（和配置）复制到托管 WCF 服务的远程服务器（独立），应用程序可以成功执行方法，但它永远不会收到任何回调！

我还尝试在我的开发 PC 上的虚拟机上运行该应用程序。它也能够连接到服务并执行方法，但再一次永远不会收到任何回调！

我已经尝试了终极测试。我同时在所有 3 个地方运行了该应用程序。所有 3 都初始化正常并成功调用服务上的方法，但一旦触发事件，只有我的开发 PC 收到回调！另外两人沉默。所有 3 个应用程序都是从一个共享文件夹启动的，因此可以有效地运行相同的代码并依赖相同的配置。

我的开发 PC 有什么特别之处，可以成为唯一收到回调的 PC？任何线索都非常受欢迎。我希望这会给某人敲响警钟。

[更新]

启用跟踪后，我发现以下异常。似乎达到了一些内部缓冲区限制。我不知道如何解决这个问题。这些是我当前对 app.config 的一些限制：`maxBufferPoolSize="16384000" maxReceivedMessageSize="16384000"`。

*格式化程序在尝试反序列化消息时抛出异常：尝试反序列化参数[http://tempuri.org/:result](http://tempuri.org/:result)时出错。InnerException 消息是“反序列化 MatchResult 类型的对象时出错。读取 XML 数据时已超出最大数组长度配额 (16384)。可以通过更改创建 XML 阅读器时使用的 XmlDictionaryReaderQuotas 对象的 MaxArrayLength 属性来增加此配额。有关更多详细信息，请参阅 InnerException。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:29:39.377

谷歌搜索 MaxArrayLength[发现这](http://davidsandor.com/post/2010/05/24/Setting-maxArrayLength-value-for-a-customBinding-using-binaryMessageEncoding.aspx)似乎可以解决问题。希望这可以帮助某人并节省他们发疯的时间。

我引用了重要的部分，以防博客出现故障。

```
<binding name="MaintenanceServiceBindingConfiguration">
  <binaryMessageEncoding>
      <readerQuotas maxArrayLength="2147483647" maxStringContentLength="2147483647" />
  </binaryMessageEncoding>
  <httpTransport maxBufferPoolSize="2147483647" maxBufferSize="2147483647"
          maxReceivedMessageSize="2147483647" />
</binding> 
```

# unit-testing - PhpStorm 中的 PHPUnit 引导程序

> ID：14755655
> 
> 赞同：4
> 
> 时间：2013-02-07T16:10:56.383
> 
> 标签：unit-testing, ide, phpunit, zend-framework2, phpstorm

我正在使用 Zend Framework 2，我想在 PhpStorm 5.0.4 中为我的所有模块运行测试。我设置了 PhpStorm 来检查测试`myproject/module`，它成功地找到了我的测试。问题是它没有在每个模块中读取我需要的配置文件（它指向引导文件）。

这是模块的目录结构（[source](http://framework.zend.com/manual/2.0/en/user-guide/unit-testing.html)）：

```
/module
    /User
        /tests
            /UserTest
                /Model
                    /UserTest.php
            Bootstrap.php
            phpunit.xml.dist
            TestConfig.php.dist 
```

当我运行测试时，它给了我一个错误，因为`Bootstrap.php`is not run before running `UserTest.php`。所有文件都是正确的，因为如果我`cd`在终端中`/myproject/module/User/tests/`运行，它工作正常。`phpunit`

我希望它在每个模块中使用配置（从而引导）。我尝试使用`--configuration`具有相对路径的选项，但我无法让它工作。

这是我当前的配置：

![PhpStorm PHPUnit 配置](../Images/dde756178d5a76c02218ae0acce08bcb.png)

关于在测试模块时如何运行配置文件（和引导程序）的任何指示？也就是说，一个模块有自己的配置文件和引导程序。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-05T01:44:25.890

PHP Storm 7 假设您只需要一个默认引导文件，因此不会为每个 PHPUnit 测试配置直接启用单独的引导文件。

但是，zf2 以每个模块为基础进行测试。因此，在您将默认值设置为第一个模块后，其他模块将不起作用。解决这个问题的方法是

1.  删除 File|Settings|PHP|PHPUnit 中的默认选项 您不必删除默认配置文件，但必须 EMPTY OUT 并取消选中默认引导文件。仅取消选中是不够的

2.  运行|编辑配置（此框还有其他快捷方式） 对于每个模块，您必须创建一个测试配置。例如，您将拥有标准的应用程序模块，因此有一个“应用程序模块测试”，可能是一个管理模块，然后是一个“管理模块测试”

3.  对于每个测试（假设标准 zf2 目录结构）

一个。测试范围：目录b。目录：C:\wamp\www\PROJECT-NAME\module\MODULE-NAME\test c. 选中“使用替代配置文件：” d。输入 C:\wamp\www\PROJECT-NAME\module\MODULE-NAME\test\MODULE-NAMETest\phpunit.xml.dist e。在“Test Runner options”中，输入“--bootstrap C:\wamp\www\PROJECT-NAME\module\MODULE-NAME\test\MODULE-NAMETest\Bootstrap.php”

1.  重复下一个模块

这里的问题是，只要默认的 bootsrap 字段有一个条目，phpstorm 就会将其添加为默认的 --bootstrap 选项，无论您在案例特定的 Test Runner 选项中添加什么。所以，无论你做什么，你最终都会运行错误的引导文件，除了第一个/默认测试用例

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T10:58:11.083

除非我遗漏了什么，否则您必须为每个模块设置一个测试配置。在你的情况下，你有 myproject。相反，您需要为每个模块设置一个，然后为每个模块设置配置（使用替代配置文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-17T13:32:57.620

我利用运行配置中的环境变量选项来定义一个值，我可以在全局 bootstrap.php 中使用它来引入特定于给定模块或应用程序部分的需求。

```
class GlobalBootstrap
{

private static $applicationSections = [
    'section_a',
    'section_b',
    'section_c'
];

public static function init()
{
    $localMethod = self::fetchLocalMethod();
    if (!is_null($localMethod)) {
        self::$localMethod();
    } else {
       throw new Exception(
            __CLASS__
            . '::'
            . __FUNCTION__
            . 'Says: No local method has been defined for this test section'
        );
    }
}

private static function fetchLocalMethod()
{
    $section = getenv('APPLICATION_SECTION');
    if (is_null($section) || !in_array($section, self::$applicationSections)) {
        return null;
    }
    $section = preg_replace("/[^a-zA-Z]+/", "", $section);
    $method = 'bootstrap' . ucfirst(strtolower($section));

    return $method;
}

/**
 * Section specific methods
 */

protected static function bootstrapSectiona()
{
    require __DIR__ . '/../../{section_a}/module/Test/Bootstrap.php';
}
}

GlobalBootstrap::init(); 
```

可以创建任意变量和值，然后在 bootstrap.php 中使用： getevn(VARIABLE_NAME); 这在 PHPStorm 中节省了大量冗长的配置，但如果您依赖许多不同的引导功能，可能会变得同样复杂。

# javascript - 在 Ext JS 4 或 JavaScript 中解析 JSON

> ID：14755657
> 
> 赞同：5
> 
> 时间：2013-02-07T16:11:02.110
> 
> 标签：javascript, extjs, extjs4, extjs-mvc

我有这种类型的[JSON](http://en.wikipedia.org/wiki/JSON)：

```
{"value":[{"idProductCategoryAttributeValue":43,"value":"7","sortOrder":0}]} 
```

我想要像这样的单个参数值。如何在[Ext JS](http://en.wikipedia.org/wiki/Ext_JS) 4 或简单的 JavaScript 中解析这个 JSON 字符串？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-07T16:16:06.487

看看[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.JSON](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.JSON)。在那里你可以找到如何使用 Ext JS 4 解析 JSON。

```
var strJson = '{"value": [{"idProductCategoryAttributeValue":43,"value":"7","sortOrder":0}]}';
var obj = Ext.JSON.decode(strJson); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T16:55:29.860

```
var obj = Ext.decode(jsonstr); 
```

# google-maps - 谷歌地方 api - 事件

> ID：14755661
> 
> 赞同：0
> 
> 时间：2013-02-07T16:11:14.413
> 
> 标签：google-maps, google-maps-api-3, google-places

虽然我们可以添加事件并且事件将与搜索结果一起返回，但我不确定事件是如何“搜索”的。

因为我看到当我们添加事件时，我们无法定义类型。说演唱会。那么当用户在搜索时，什么样的搜索会将音乐会事件列为结果呢？

# android - 更改 InAppBrowser for Cordova 2.3.0+/PhoneGap 在 iOS 上的设计

> ID：14755662
> 
> 赞同：2
> 
> 时间：2013-02-07T16:11:20.740
> 
> 标签：android, ios, cordova, phonegap-plugins

我们使用 PhoneGap 在 iOS 和 Android 上打包我们的网络应用程序，并且我们使用 InAppBrowser 插件来显示一些外部页面。我们希望将其显示在我们自己的设计中，而不是默认的 PhoneGap 设计中。

对于 Android，这很容易，我刚刚基于 Cordova 使用我自己的布局创建了我自己的插件 - 就是这样。然而，在 iOS 上，我无法找到合适的资源来设置 InAppBrowser 插件的样式。布局在 CDVInAppBrowser.m 文件中硬编码，与 Android 版本相同。但是我不是很精通Objective-C。

我怎样才能最好地做到这一点，是否有任何 github 项目或任何已经这样做的项目？

# functional-programming - 如何在 OCaml 的顶层加载 ml 文件，就像在 SML/NJ 中使用 mine.sml 一样？

> ID：14755664
> 
> 赞同：23
> 
> 时间：2013-02-07T16:11:23.400
> 
> 标签：functional-programming, ocaml, sml

在`SML`'s`repl`中，您只需键入`use whatever.sml`并将其中的所有内容加载`.sml`到`repl`.

我怎样才能在 OCaml 中做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-07T16:17:41.120

你有`#use`为此目的的指令：

> #使用“文件名”；；
> 
> 从给定文件中读取、编译和执行源短语。这是文本包含：处理短语就像在标准输入中键入一样。文件的读取在遇到第一个错误时停止。

例如（根据@gasche 的建议）：

```
# #use "whatever.ml";; 
```

这是[OCaml 指令](http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual023.html#toc91)的完整列表。

# mysql - SQL - 对子查询的调用过多

> ID：14755666
> 
> 赞同：3
> 
> 时间：2013-02-07T16:11:23.907
> 
> 标签：mysql, sql, sql-optimization

就“技能名称”的子查询选择而言，以下查询相当慢。当我针对 SQL 执行运行配置文件时，我从 ACDCallinformation 表中针对技能名称的子查询的每行查询太多。

优化此 SQL 查询的最佳方法是什么，或者是否有 MySQL 工具来帮助检查 SQL 查询的成本和优化脚本？

```
SELECT 
CASE 
    WHEN(
            SELECT 
                COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`)
            FROM acdcallinformation ag
            WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL AND DATEofcall = DATE(NOW()) AND ag.skillid = acdcallinformation.skillid
        ) IS NULL 
    THEN 
            0 
    ELSE
        (
            SELECT COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`)
                FROM acdcallinformation ag
            WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL AND DATEofcall= DATE(NOW()) AND ag.skillid = acdcallinformation.skillid) 
        END AS 'Lost Calls', 
        CASE WHEN COUNT(acdcallinformation.idleonqueue) IS NULL THEN 0 ELSE COUNT(acdcallinformation.idleonqueue) END AS 'Total Calls', 
        CASE WHEN COUNT(acdcallinformation.`ANSWERTIME`) IS NULL THEN 0 ELSE COUNT(acdcallinformation.`ANSWERTIME`) END AS 'Answered',
    (
        SELECT 
            skillinfo.skillname
        FROM skillinfo
        WHERE skillinfo.pkey = acdcallinformation.skillid
    ) AS Skill, 
    SEC_TO_TIME(AVG(TIME_TO_SEC(answertime)- TIME_TO_SEC(firstringonqueue))) AS 'Average Answer Time', 
    SEC_TO_TIME(AVG(TIME_TO_SEC(IDLEONQUEUE) - TIME_TO_SEC(answertime))) AS 'Average Talk Time'
FROM `acdcallinformation` acdcallinformation
WHERE DATEOFCALL = DATE(NOW())
GROUP BY skill; 
```

不确定显示数据的最佳方式：

ACDCALLINFORMATION - 当前行数 3028

```
INSTIME              PKEY   DATEOFCALL  CONNECTTIME FIRSTRING SKILLID
2012-07-19 14:50:16  19985  2012-07-19  14:50:16    14:50:16  5 
```

SKILLINFO - 平均行数为 5-10

```
INSTIME              PKEY   SKILLNAME
2012-07-01 13:12:01  1      Calls Outgoing
2012-07-01 13:12:01  2      Call Centre
2012-07-01 13:12:01  3      Accounts
2012-07-01 13:12:01  4      Reception 
```

这是预期的输出：

```
"Lost Calls"    "Total Calls"   "Answered"  "Skill"         "Average Answer Time" "Average Talk Time"

"1"         "2"          "1"            "Accounts"  "00:00:04"  "00:00:01"
"0"         "5"          "5"            "Service"   "00:00:07"  "00:01:20" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:41:48.920

试试这个，正在使用内部连接来提高性能并避免不必要的子查询

```
SELECT 
    COALESCE(ag.skillcount, 0) AS 'Lost Calls', 
    CASE WHEN COUNT(acdcallinformation.idleonqueue) IS NULL THEN 0 ELSE COUNT(acdcallinformation.idleonqueue) END AS 'Total Calls', 
    CASE WHEN COUNT(acdcallinformation.`ANSWERTIME`) IS NULL THEN 0 ELSE COUNT(acdcallinformation.`ANSWERTIME`) END AS 'Answered',
    si.skillname AS Skill, 
    SEC_TO_TIME(AVG(TIME_TO_SEC(answertime)- TIME_TO_SEC(firstringonqueue))) AS 'Average Answer Time', 
    SEC_TO_TIME(AVG(TIME_TO_SEC(IDLEONQUEUE) - TIME_TO_SEC(answertime))) AS 'Average Talk Time'
FROM `acdcallinformation` acdcallinformation
LEFT JOIN (
    SELECT skillid,  COUNT(`PKEY`) - COUNT(`ANSWERTIME`) skillcount
    FROM acdcallinformation 
    WHERE (`COMPLETED`) = 1 AND answertime IS NULL AND DATEofcall = DATE(NOW())
) ag ON  AND ag.skillid = acdcallinformation.skillid
LEFT JOIN skillinfo si ON si.pkey = acdcallinformation.skillid
WHERE DATEOFCALL = DATE(NOW())
GROUP BY si.skillname; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:35:29.740

看起来您正在尝试确保将`NULL`s 转换为`0`s。因此：

```
SELECT 
  IFNULL(
    (SELECT COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`) FROM acdcallinformation ag
       WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL 
        AND DATEofcall = DATE(NOW()) AND ag.skillid = acdcallinformation.skillid
    ), 0)  AS 'Lost Calls', 
    IFNULL(COUNT(acdcallinformation.idleonqueue), 0) AS 'Total Calls', 
    IFNULL(COUNT(acdcallinformation.`ANSWERTIME`),0) AS 'Answered',
    (
        SELECT 
            skillinfo.skillname
        FROM skillinfo
        WHERE skillinfo.pkey = acdcallinformation.skillid
    ) AS Skill, 
    SEC_TO_TIME(AVG(TIME_TO_SEC(answertime)- TIME_TO_SEC(firstringonqueue))) AS 'Average Answer Time', 
    SEC_TO_TIME(AVG(TIME_TO_SEC(IDLEONQUEUE) - TIME_TO_SEC(answertime))) AS 'Average Talk Time'
FROM `acdcallinformation` acdcallinformation
WHERE DATEOFCALL = DATE(NOW())
GROUP BY skill; 
```

`NULL`虽然，使用使用这些数据的语言将这些 s转换为零可能更容易......只是一个想法。

此外，我对文档的阅读[`COUNT`](http://dev.mysql.com/doc/refman/5.1/en/group-by-functions.html#function_count)让我认为它永远不会返回`NULL`，因此：

```
SELECT 
  (SELECT COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`) FROM acdcallinformation ag
       WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL 
        AND DATEofcall = DATE(NOW()) AND ag.skillid = acdcallinformation.skillid
  )  AS 'Lost Calls', 
  COUNT(acdcallinformation.idleonqueue) AS 'Total Calls', 
  COUNT(acdcallinformation.`ANSWERTIME`) AS 'Answered',
    (
        SELECT 
            skillinfo.skillname
        FROM skillinfo
        WHERE skillinfo.pkey = acdcallinformation.skillid
    ) AS Skill, 
    SEC_TO_TIME(AVG(TIME_TO_SEC(answertime)- TIME_TO_SEC(firstringonqueue))) AS 'Average Answer Time', 
    SEC_TO_TIME(AVG(TIME_TO_SEC(IDLEONQUEUE) - TIME_TO_SEC(answertime))) AS 'Average Talk Time'
FROM `acdcallinformation` acdcallinformation
WHERE DATEOFCALL = DATE(NOW())
GROUP BY skill; 
```

最后，我认为您可以使用`JOIN`

```
SELECT 
      IFNULL(
        (SELECT COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`) FROM acdcallinformation ag
           WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL 
            AND DATEofcall = DATE(NOW()) AND ag.skillid = acdcallinformation.skillid
        ), 0)  AS 'Lost Calls', 
        IFNULL(COUNT(acdcallinformation.idleonqueue), 0) AS 'Total Calls', 
        IFNULL(COUNT(acdcallinformation.`ANSWERTIME`),0) AS 'Answered',
        skillinfo.skillname AS Skill, 
        SEC_TO_TIME(AVG(TIME_TO_SEC(answertime)- TIME_TO_SEC(firstringonqueue))) AS 'Average Answer Time', 
        SEC_TO_TIME(AVG(TIME_TO_SEC(IDLEONQUEUE) - TIME_TO_SEC(answertime))) AS 'Average Talk Time'
    FROM `acdcallinformation` acdcallinformation 
       INNER JOIN skillinfo ON skillinfo.pkey = acdcallinformation.skillid 
    WHERE DATEOFCALL = DATE(NOW())
    GROUP BY skill; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T16:36:21.920

试试这个查询。整个查询只是一个猜测，但如果您提供一些数据，那将是一个打击。我也使用 id 作为主键，您需要用自己的键替换它。避免使用子查询，而是使用连接它们更快。这是查询。

```
SELECT 
    IF(l.LDifference IS NULL,0,r.RDifference) AS 'Lost Calls', 
    IF(COUNT(acdcallinformation.idleonqueue) IS NULL , 0 , COUNT(acdcallinformation.idleonqueue))AS 'Total Calls', 
    IF(COUNT(acdcallinformation.`ANSWERTIME`) IS NULL,0,COUNT(acdcallinformation.`ANSWERTIME`))AS 'Answered',
    (SELECT skillinfo.skillname FROM skillinfo  WHERE skillinfo.pkey = acdcallinformation.skillid) AS Skill, 
    SEC_TO_TIME(AVG(TIME_TO_SEC(a.answertime)- TIME_TO_SEC(a.firstringonqueue))) AS 'Average Answer Time', 
    SEC_TO_TIME(AVG(TIME_TO_SEC(a.IDLEONQUEUE) - TIME_TO_SEC(a.answertime))) AS 'Average Talk Time'
FROM acdcallinformation as a
INNER JOIN( 
    SELECT  
        (COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`)) as `LDifference`
    FROM acdcallinformation ag
    WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL AND DATEofcall = DATE(NOW()) AND ag.skillid = acdcallinformation.skillid  
) as l ON l.id = a.id
INNER JOIN( 
    SELECT (COUNT(ag.`PKEY`) - COUNT(ag.`ANSWERTIME`)) as `RDifference`
        FROM acdcallinformation ag
    WHERE (ag.`COMPLETED`) = 1 AND answertime IS NULL AND DATEofcall= DATE(NOW()) AND ag.skillid = acdcallinformation.skillid
) as r ON r.id = a.id   
WHERE a.DATEOFCALL = DATE(NOW())
GROUP BY skill; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-07T17:58:29.353

试试这个。使用 INNER JOIN、IF() 并尽量避免不必要的子查询。

```
SELECT IFNULL(ag.skillcount, 0) AS 'Lost Calls', COUNT(info.idleonqueue) AS 'Total Calls', 
         COUNT(info.ANSWERTIME) AS 'Answered', si.skillname AS Skill, 
         SEC_TO_TIME(AVG(TIME_TO_SEC(answertime)- TIME_TO_SEC(firstringonqueue))) AS 'Average Answer Time', 
         SEC_TO_TIME(AVG(TIME_TO_SEC(IDLEONQUEUE) - TIME_TO_SEC(answertime))) AS 'Average Talk Time'
FROM acdcallinformation AS info
INNER JOIN (
            SELECT skillid, COUNT(PKEY)-COUNT(ANSWERTIME) skillcount
            FROM acdcallinformation 
            WHERE COMPLETED = 1 AND DATEofcall = DATE(NOW()) AND answertime IS NULL 
           ) ag ON ag.skillid = info.skillid
INNER JOIN skillinfo si ON si.pkey = info.skillid
WHERE DATEOFCALL = DATE(NOW())
GROUP BY si.skillname; 
```

# stata - 如何给家庭编号？

> ID：14755667
> 
> 赞同：1
> 
> 时间：2013-02-07T16:11:27.237
> 
> 标签：stata

我有一组家庭数据，包含 4200 个家庭的 20,000 多条记录。在我的数据集中，没有任何家庭 ID 列，所有记录都是每个家庭成员。有一个人的序列号&每个&每个“1”的列，应该改变住户。（即：如果我们开始给住户编号，当第一个人的序列号等于1时，对应的HH_ID应该为“1”。一旦人的序列号=1时的下一条记录相遇，那么HH_ID应该是2。）所以我想添加一个名为HH_ID的列并从1-4200编号。如何使用 STATA 编写程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T18:22:27.153

您想要的是（假设`personid`人员标识符的变量）

```
 . gen hhid = sum(personid == 1) 
```

就是这样。解释比代码长。该表达式`personid == 1`在 true 时计算为 1，在 false 时计算为 0。对于第一个家庭，第一个人，这将是 1，对于同一家庭中的其他人，这将是 0。对于第二个家庭，第一个人，这将是 1，依此类推。该函数`sum()`给出累积或运行总和，因此您应该以 1,1,1,2,2,2,2,3,3,3,... 显然是 1s、2s 的实际数字， 3s 等将取决于家庭中的人数。

关于Stata中的真假，请参见

[http://www.stata.com/support/faqs/data-management/true-and-false/index.html](http://www.stata.com/support/faqs/data-management/true-and-false/index.html)

# android - Android WebView loadWithBaseURL

> ID：14755670
> 
> 赞同：1
> 
> 时间：2013-02-07T16:11:36.417
> 
> 标签：android, css, webview

我想知道如何正确设置 WebViews loadWithBaseURL 的路径。

我想要做的是，在 webview 中加载 html，它使用存储在外部存储上的资源。

例如：

```
<html>
<head>
<style>body{ background-image:url(beach.jpg); }</style> 
</head>
<body> 
<img src="football.jpg" />
</body>
</html> 
```

其中 beach.jpg 和 ball.jpg 直接存储在手机外部存储的“根”目录中（/sdcard/beach.jpg 和 /sdcard/ball.jpg）

所以我尝试按如下方式加载内容：

```
String html = "<html> ... example from above ... </html>";
String base = Environment.getExternalStorageDirectory().getAbsolutePath().toString();
webView.loadDataWithBaseURL("file://" + base, html, "text/html", "utf-8", null); 
```

但是路径似乎是错误的，因为我在 webview 中看不到图像。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T18:15:35.373

您是否在 webview 上启用了文件访问？

```
webView.getSettings().setAllowFileAccess(true); 
```

此外，如果您自己构建 HTML - 您可能会考虑使用图像的完整路径。

```
String html = "<html>... <img src=\"file://"+base+"/football.jpg\" />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T18:04:58.350

你有**互联网许可**吗？

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

这些也可能有帮助..

*   [Android webview loadDataWithBaseURL 如何从资产加载图像？](https://stackoverflow.com/questions/14374553/android-webview-loaddatawithbaseurl-how-load-images-from-assets)
*   [http://myexperiencewithandroid.blogspot.com/2011/09/android-loaddatawithbaseurl.html](http://myexperiencewithandroid.blogspot.com/2011/09/android-loaddatawithbaseurl.html)
*   [Android v2.2-2.3.5：WebView：loadDataWithBaseURL：只会加载一次页面](https://stackoverflow.com/questions/9960443/android-v2-2-2-3-5-webview-loaddatawithbaseurl-will-only-load-page-once)

# ios - 使用 PrivateFrameworkHeader-iOS-iPhone-5 API

> ID：14755671
> 
> 赞同：1
> 
> 时间：2013-02-07T16:11:36.690
> 
> 标签：ios, jailbreak, iphone-privateapi

我在一个看似简单的任务上卡住了一点……

<**计划**>

开发基于 cycript 的应用程序，用于检索必须在设备上安装的应用程序的信息。cy 脚本导航到应用程序的下载页面（Apple AppStore）并执行安装过程。

< **/计划**>

我已经在下载页面打开的地方。因此，连接 SpringBoard 或 AppStore 进程并玩转并不是问题，我只是不知道如何执行安装按钮或安装进程。

比我找到了一个绝对可以解决我的问题的[私有框架](https://github.com/masbog/PrivateFrameworkHeader-iOS-iPhone-5.-)。通过连接到 AppStored 进程并执行

```
`cy# [SSDownloadManager _triggerDownloads]`
```

（[StoreServices.framework](https://github.com/masbog/PrivateFrameworkHeader-iOS-iPhone-5.-/blob/master/StoreServices.framework/SSDownloadManager.h)）用于身份验证的警报视图弹出，但如果我填写用户密码没有任何反应......当然不会，因为没有与绑定到 SSDownloadManager 的应用程序相关的信息......我只是不'不知道如何使用那个私有框架......（当然没有文档）

我认为以某种方式必须有可能：

```
cy# [SSPurchase purchaseWithBuyParameters:x] 
```

但不知道如何找出购买参数是什么......

如果有人可以帮助我解决这个问题，我将不胜感激。希望解释不会让人困惑^^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:42:41.530

您是否考虑过仅模拟单击“安装”按钮？如果你可以连接 AppStore，你可以做类似的事情

*   UIWindow* keyWindow = [[UIApplication sharedApplication] keyWindow];
*   UIViewController* 控制器 = [keyWindow rootViewController];
*   获取此控制器上所有控件的列表（ [如何在 iOS 中列出 uiviewcontroller 中的所有子视图？](https://stackoverflow.com/questions/7243888/how-to-list-out-all-the-subviews-in-a-uiviewcontroller-in-ios)）
*   当您找到带有“安装”文本的按钮时，以编程方式单击它（以[编程方式触发按钮单击事件？](https://stackoverflow.com/questions/5625651/programmatically-fire-button-click-event)）

# excel - 带有 TEXT 公式字符限制的字符串转换？

> ID：14755672
> 
> 赞同：2
> 
> 时间：2013-02-07T16:11:42.053
> 
> 标签：excel, excel-formula

我正在尝试格式化存储为文本值的单个数字。

例如，我想转换：

5145350002005000080

到：

5145-350002-00500-0080

我使用的公式是：

=文本（A1，“0000-000000-00000-0000”）

我收到的输出是：

5145-350002-00500- **0000**

为什么最后 4 个字符是“0000”而不是我所期望的“0080”？有字符限制，还是我的公式不正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:26:38.517

引用[大数算术](http://www.tushar-mehta.com/misc_tutorials/project_euler/LargeNumberArithmetic.htm)：

> Excel 中的限制是数字中的 15 个有效数字。输入 16 位信用卡号，1234567890123456 将变为 1234567890123450。

实际上，即使是 514535000200500 **1111**也会导致`5145-350002-00500-0000`.

此外，在选择输入单元格时查看公式栏 - 对于我的 Excel 2007，我看到：

![Excel 数量限制](../Images/ff182c0840233b9d1200417592df41d1.png)

希望对您有所帮助）

**编辑：**

作为解决任务的解决方案 -**将您的数字格式设置为文本**并使用以下公式：

```
=LEFT(A1,4)&"-"&MID(A1,5,6)&"-"&MID(A1,11,5)&"-"&RIGHT(A1,4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:39:39.270

这是一个自定义函数。将其放在工作簿的常规代码模块中，您可以通过 =FormatLargeNumber("A1") 在单元格中调用它

```
Public Function FormatLargeNumber(val As String)
'This function parses extremely large numbers per your example.
' Modify as needed.
FormatLargeNumber = Left(val, 4) & "-" _
                    & Mid(val, 5, 6) & "-" & _
                    Mid(val, 11, 5) & "-" & _
                    Right(val, 4)

End Function 
```

# email - 在 applescript 中保存邮件消息

> ID：14755677
> 
> 赞同：1
> 
> 时间：2013-02-07T16:12:00.323
> 
> 标签：email, checkbox, applescript

我是 applescript 的新手，在做一些看似非常基本的事情时遇到了巨大的麻烦。我正在尝试以带有附件的 RTF 格式保存选定的邮件。这是错误的脚本：

```
 tell application "Mail"
        activate
        set AllMessages to selection
        set myMessage to item 1 of AllMessages
        open myMessage
        tell application "System Events"
            tell process "Mail"
                tell menu bar 1
                    tell menu bar item "File"
                        tell menu "File"
                            click menu item "Save As…"
                            delay 2
                            keystroke "test"
                            click checkbox "Include Attachments" -- result: ERROR
                        end tell
                    end tell
                end tell
            end tell
        end tell
    end tell 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:03:10.840

你可以尝试这样的事情：

```
set the clipboard to POSIX path of (path to desktop as text) & "test"

tell application "Mail"
    open first item of (get selection)
    activate
end tell

tell application "System Events"
    tell process "Mail"
        click menu item "Save As…" of menu 1 of menu bar item "File" of menu bar 1
        delay 3
        perform action "AXPress" of pop up button 1 of group 1 of sheet 1 of window 1
        click menu item 1 of menu 1 of pop up button 1 of group 1 of sheet 1 of window 1
        if value of checkbox "Include Attachments" of group 1 of sheet 1 of window 1 = 0 then
            perform action "AXPress" of checkbox "Include Attachments" of group 1 of sheet 1 of window 1
        end if
        keystroke "g" using {command down, shift down}
        keystroke "v" using {command down}
        keystroke return
        keystroke return

    end tell
end tell 
```

# c# - 在 C# 中限制结构的使用

> ID：14755682
> 
> 赞同：2
> 
> 时间：2013-02-07T16:12:12.377
> 
> 标签：c#, c#-4.0, data-structures, struct

好的，可以说我有一个这样的结构 A：

```
Struct A{
    private String _SomeText;
    private int _SomeValue;

    public A(String someText, int SomeValue) { /*.. set the initial values..*/ }

    public String SomeText{ get { return _SomeText; } }
    public int SomeValue{ get { return _SomeValue; } }
} 
```

现在我想要做的是返回结构 A 作为 ABC 类中的方法的结果，如下所示：

```
Class ABC{
    public A getStructA(){
        //creation of Struct A
        return a;
    }
} 
```

我不希望任何程序员使用我的库（它将具有 Struct A 和 Class ABC 以及更多东西）能够创建 Struct A 的实例。
我希望创建它的唯一方法是作为回报来自 getStructA() 方法。然后可以通过适当的 getter 访问这些值。

那么有没有办法设置这样的限制？所以一个结构不能在某个类之外实例化？使用 C#、.Net4.0。

谢谢你的帮助。

---编辑：----
添加一些关于我为什么要实现这一目标的细节：

*   我的 ABC 班有一些人可以查询的“状态”。此状态有 2 个字符串值，然后是一长串整数。
*   程序员永远不需要创建“状态”的对象/实例，状态只能由类的“getStatus()”函数返回。
*   我不想将这 3 个字段拆分为不同的方法，因为要获得它们，我正在调用 Windows API (p/invoke)，它返回具有所有 3 个字段的类似结构。
*   如果我确实要将其拆分为 3 个方法而不使用该结构，那么每次调用这 3 个方法之一时，我都必须缓存结果或从 Windows API 调用该方法...

所以我可以创建一个公共结构，程序员可以根据需要实例化它，这对他们来说是无用的，因为没有方法可以接受它作为参数。或者我可以以这样一种方式构建库，即该结构（或将其更改为类，如果它使事情变得更容易）只能作为方法的返回获得。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T16:49:07.807

如果“受限”类型是结构，那么不，没有办法做到这一点。结构必须至少与工厂方法一样公开，如果结构是公开的，则可以使用其默认构造函数构造它。但是，您可以这样做：

```
public struct A
{
    private string s;
    private int i;
    internal bool valid;
    internal A(string s, int i)
    {
        this.s = s;
        this.i = i;
        this.valid = true;
    } 
    ... 
```

现在您可以让您的库代码检查“有效”标志。A 的实例只能由 (1) 由库内部的可调用内部构造函数的方法生成，或 (2) 由默认构造函数生成。您可以使用有效标志将它们区分开来。

许多人建议使用界面，但这有点毫无意义；使用结构的重点是获取值类型语义，然后将其装箱到接口中。你不妨一开始就把它变成一门课。如果它要成为一个类，那么肯定可以创建一个工厂方法；只需将类的所有 ctor 设为内部即可。

当然，我希望不言而喻，这些设备都不应该用于实现能够抵抗完全受信任的用户攻击的代码。请记住，这个系统是为了保护*好用户*免受*不良代码*的侵害，而不是保护*好代码*免受*不良用户*的侵害。没有什么可以阻止完全受信任的用户代码通过反射调用他们想要在您的库中的任何私有方法，或者就此而言，使用不安全代码更改结构中的位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:21:51.780

创建一个公共接口并使该类对调用它的类来说是私有的。

```
public ISpecialReturnType
{
    String SomeText{ get; }
    int SomeValue{ get; }
}

class ABC{
    public ISpecialReturnType getStructA(){
        A a = //Get a value for a;
        return a;
    }

    private struct A : ISpecialReturnType
    {
        private String _SomeText;
        private int _SomeValue;

        public A(String someText, int SomeValue) { /*.. set the initial values..*/ }

        public String SomeText{ get { return _SomeText; } }
        public int SomeValue{ get { return _SomeValue; } }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T17:20:45.173

你具体关心什么？结构基本上是用胶带粘在一起的字段的集合。由于结构赋值将所有字段从一个结构实例复制到另一个结构实例，因此不受相关结构类型的控制，结构执行任何类型的不变量的能力非常有限，尤其是在多线程代码中（除非结构完全是1、2 或 4 个字节，想要创建一个包含从两个不同实例复制的混合数据的实例的代码可能很容易做到，并且结构无法阻止它）。

如果您想确保您的方法不会接受除您的类型在内部生成的类型以外的任何类型的实例，您应该使用只有构造函数`internal`或`private`构造函数的类。如果你这样做，你可以确定你得到的是你自己生成的实例。

**编辑** 根据修订，我认为请求的限制类型没有必要或特别有用。这听起来像是从根本上想要将一堆值粘在一起并将它们存储到调用者持有的一组粘在一起的变量中。如果您简单地声明一个结构：

```
public struct QueryResult {
  public ExecutionDuration as Timespan;
  public CompletionTime as DateTime;
  public ReturnedMessage as String;
} 
```

然后声明：

```
QueryResult foo; 
```

将有效地创建三个变量，名为`foo.ExecutionDuration`、`foo.CompletionTime`和`foo.ReturnedMessage`。该声明：

```
foo = queryPerformer.performQuery(...); 
```

将根据函数的结果设置这三个变量的值——基本上相当于：

```
{
  var temp = queryPerformer.performQuery(...);
  foo.ExecutionDuration = temp.ExecutionDuration
  foo.CompletionTime = temp.CompletionTime;
  foo.ReturnedMessage = temp.ReturnedMessage;
} 
```

没有什么能阻止用户代码对这三个变量做任何想做的事，但那又如何呢？如果用户代码出于任何原因决定说，`foo.ReturnedMessage = "George";`那么`foo.ReturnedMessage`将等于`George`。这种情况真的和代码所说的没有什么不同：

```
int functionResult = doSomething(); 
```

然后后来说`functionResult = 43;`。的行为`functionResult`，与任何其他变量一样，是保存最后写入的内容。如果写入它的最后一件事是最后一次调用的结果，`doSomething()`那么它将保持不变。如果最后写的东西是别的东西，它将包含别的东西。

请注意，与类字段或结构属性不同，结构字段*只能*通过写入来更改，或者通过使用结构赋值语句将一个结构实例中的所有字段写入另一个结构实例的相应字段中的值. 从消费者的角度来看，只读结构属性没有这样的保证。一个结构可能碰巧实现了一个以这种方式运行的属性，但是如果不检查该属性的代码，就无法知道它返回的值是否会受到某个可变对象的影响。

# liferay - Liferay 如果用户已经登录并且他手动输入登录页面 url？

> ID：14755686
> 
> 赞同：4
> 
> 时间：2013-02-07T16:12:16.380
> 
> 标签：liferay

我需要如果用户已经登录并且他手动输入登录路径，他会重定向到主页？请让我知道如何执行此操作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T07:11:08.877

据我了解，即使在登录后输入以下登录 URL，您也希望这样做：

```
http://localhost:8080/web/guest/home?p_p_id=58&p_p_lifecycle=0&p_p_state=maximized&p_p_mode=view&saveLastPath=0&_58_struts_action=%2Flogin%2Flogin 
```

那么你应该被带到主页，即`http://localhost:8080/web/guest/home`.

因此，如果是这种情况，那么我认为您可以创建一个[servlet-filter 挂钩](http://www.liferay.com/documentation/liferay-portal/6.1/development/-/ai/other-hooks "Liferay 开发人员指南中的其他钩子 - 还有一个示例链接")，该挂钩将拦截所有请求并检查 URL 的相关参数，例如`struts_action=/login/login`并执行以下操作（在伪代码中）：

```
if(is_SignIn_URL) { // check if it is the sign-in URL

    if(isUserLoggedIn) { // check if user is logged-in

        // redirect to the home page configured in portal-ext.properties

    } else {

        // let the application work normally i.e. let it go to the sign-in page

    }
} 
```

此外，为了获取信息和深入了解，您可以检查 lifeary 的[`AutoLoginFilter`](https://github.com/liferay/liferay-portal/blob/master/portal-impl/src/com/liferay/portal/servlet/filters/autologin/AutoLoginFilter.java "AutoLoginFilter：Git-hub 上的源代码")类（这是一个实际的 Servlet 过滤器，但您可以按照相同的方式制作一个钩子）以及如果用户已登录，则[`liferay-web.xml`](https://github.com/liferay/liferay-portal/blob/c1498646126e0d12b738f398c88541a72c3497db/portal-web/docroot/WEB-INF/liferay-web.xml#L40 "liferay-web.xml：Github 上的源代码，显示了确切的行")该 URL`c/portal/login`将您带到该页面或`home`否则将带您进入登录页面。

这与使用 Cookie 无关 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T03:48:46.207

您可以在 Web 服务器中编写重定向规则。下面是 Apache httpd.conf 文件中的示例代码，

`yourCookie`登录后立即创建一个 Cookie（比如说）。

```
RewriteEngine On
RewriteCond %{HTTP:Cookie}  yourCookie=([a-zA-Z0-9]+)
RewriteCond %{REQUEST_URI} ^/web/portal/home/-/portal/login/      //This is your login page URL
RewriteRule .* http://%{SERVER_NAME}/web/portal/home [R=302]      //This is your Home Page URL 
```

# c# - 我应该在“使用”语句中使用 SqlDataReader 吗？

> ID：14755687
> 
> 赞同：35
> 
> 时间：2013-02-07T16:12:19.193
> 
> 标签：c#, .net, ado.net, sqlconnection

以下两个例子哪个是正确的？（或者哪个更好，我应该使用）

在 MSDN 中，我发现了这个：

```
private static void ReadOrderData(string connectionString)
{
   string queryString = "SELECT OrderID, CustomerID FROM dbo.Orders;"

   using (SqlConnection connection = new SqlConnection(connectionString))
   {
       SqlCommand command = new SqlCommand(queryString, connection);
       connection.Open();

       SqlDataReader reader = command.ExecuteReader();

       // Call Read before accessing data.
       while (reader.Read())
       {
           Console.WriteLine(String.Format("{0}, {1}", reader[0], reader[1]));
       }

       // Call Close when done reading.
       reader.Close();
   }
} 
```

但是查看其他页面，一些用户建议这样做：

```
private static void ReadOrderData(string connectionString)
{
   string queryString = "SELECT OrderID, CustomerID FROM dbo.Orders;";

   using (SqlConnection connection = new SqlConnection(connectionString))
   {
       using (SqlCommand command = new SqlCommand(queryString, connection))
       {
          connection.Open();

          using (SqlDataReader reader = command.ExecuteReader())
          {
              // Call Read before accessing data.
              while (reader.Read())
              {
                    Console.WriteLine(String.Format("{0}, {1}", reader[0], reader[1]));
              }
          }
       }
   }
} 
```

所以，问题是：我应该在and 中使用该`using`语句，还是在代码块的末尾自动处理它们。`SqlCommand``SqlDataReader``SqlConnection` `using`

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-07T16:13:03.090

第二个选项意味着您`reader`将在创建后发生异常时关闭，因此是首选。

它被编译器有效地转换为：

```
SqlDataReader reader = command.ExecuteReader();
try
{
    ....
}
finally
{
  if (reader != null)
      ((IDisposable)reader).Dispose();
} 
```

有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-07T16:17:17.883

您实际上可以一起列出使用情况，例如：

```
private static void ReadOrderData(string connectionString)
{
   string queryString =
       "SELECT OrderID, CustomerID FROM dbo.Orders;";

   using (SqlConnection connection = new SqlConnection(connectionString))
   using (SqlCommand command = new SqlCommand(queryString, connection))
   {
        connection.Open();

        using (SqlDataReader reader = command.ExecuteReader())
        {
            // Call Read before accessing data.
            while (reader.Read())
            {
               Console.WriteLine(String.Format("{0}, {1}",
               reader[0], reader[1]));
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-31T10:01:25.517

使用这段代码不是更简单吗？

```
 private static void ReadOrderData(string connectionString)
    {
        string queryString =
            "SELECT OrderID, CustomerID FROM dbo.Orders;";

        using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, CommandType.Text, queryString))
        {
            // Call Read before accessing data.
            while (reader.Read())
            {
                Console.WriteLine(String.Format("{0}, {1}",
                reader[0], reader[1]));
            }
        }
    } 
```

这应该处理阅读器，以及终止使用时的隐式连接和命令。

还是我错过了什么？

# javascript - 在javascript上将整数添加到数组

> ID：14755696
> 
> 赞同：0
> 
> 时间：2013-02-07T16:12:45.910
> 
> 标签：javascript

我正在开发一个应该在画布上绘制一些矩形的应用程序。这个想法是通过将每个都放在最后一个来绘制它们 - 我的意思是，从另一个完成的地方开始绘制它。

我创建了一个从输入中获取值的按钮，这很容易。我将此值添加到数组中，但每次按下按钮时，数组都会再次为空。我听说我需要一个“实例变量”，但我现在很迷茫。

欢迎任何帮助。这是代码

```
function corta() {
    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    var medida1 = document.getElementById('medida2').value;
    var medida2 = document.getElementById('medida1').value;
    var corte1 = Math.round(medida1);
    var corte2 = Math.round(medida2);
    var arrayAncho = [];
    var arrayLargo = [];
    var ancho = 0;
    var largo = 0;
    arrayLargo.push(medida2);
    arrayAncho.push(medida1);
    //ancho, largo

    document.getElementById('medida2').onclick = function () { this.value = ''; };
    document.getElementById('medida1').onclick = function () { this.value = ''; };

    //metodo para el ancho

    for (var i = 0; i < arrayAncho.length ; i++) {
        ancho += arrayAncho[i];
    }

    if (arrayAncho.length == 1) {
        ctx.fillStyle = "#58FA58";
        ctx.fillRect(0, largo, corte1, corte2);
    } else
    if (medida1 > 122 - ancho) {
        ctx.fillStyle = "#58FA58";
        ctx.fillRect(ancho, largo, corte1, corte2);//ancho, largo
    }

    medida1 = 0;
    medida2 = 0; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:22:28.963

每次你运行你运行的函数

```
var arrayAncho = [];
var arrayLargo = []; 
```

这使他们每次都空白。您必须在函数之外声明它们，并且只能在代码块内引用它们

# javascript - nodejs 服务器抵御 DOS 攻击

> ID：14755707
> 
> 赞同：10
> 
> 时间：2013-02-07T16:13:01.057
> 
> 标签：javascript, node.js, denial-of-service

我正在使用 nodejs 编写一个高度可扩展的基于浏览器的网络聊天服务器。所涉及的概念很简单——首先它检查浏览器是否支持 websocket。如果不支持或与服务器规范不兼容，它会优雅地降级为传统的长轮询。

利用其高度事件化的 I/O 模型，到目前为止，我找不到任何其他框架这么好并且适合 nodejs 来完成这种工作。但是，我有一个与 DOS 攻击有关的问题，我决定提出一个简单的解决方案。但是，我不确定这是否是对抗那些大规模洪水攻击的最理想方式。

我计划做的是 - 如果来自单个 IP 地址的 50 个或更多请求在特定时间长度（例如 1 秒）内到达服务器，然后拒绝来自该 IP 的所有进一步请求，直到该特定时间间隔达到失效等等。

这会好吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T16:19:26.070

这不涉及 DDOS 攻击 - 分布式拒绝服务 - 其中使用了许多 IP，并且当您需要继续为与参与攻击的机器位于同一防火墙内的某些机器提供服务时。

DDOS 中使用的机器通常是被接管的僵尸机器。当针对大型目标的 DDOS 启动时，每 IP 限制可能会禁止所有计算机进入同一个防火墙 LAN。当纽约时报的机器被感染并在 DDOS 中使用时，这可能会给大公司带来非常糟糕的公关，时报的记者检查公司的网站是否关闭，并被阻止导致他们报告这次攻击比实际成功得多。

要在 DDOS 面前继续提供服务，您确实需要根据请求本身的常见元素来阻止请求，而不仅仅是 IP。 [security.se](https://security.stackexchange.com/)可能是有关如何执行此操作的具体建议的最佳论坛。

# c++ - 从外部目录链接库

> ID：14755711
> 
> 赞同：0
> 
> 时间：2013-02-07T16:13:07.267
> 
> 标签：c++, gcc

*编辑：根据答案，我已经用我所做的更改更新了我的问题。* 我正在尝试链接到我编写的一个小库，以了解这是用 C++ 完成的，但没有运气。G++ 抱怨`undefined reference`.

我要链接的库的根目录在 directory 中`~/code/gklib/cxx/`。该目录的结构如下：

```
~/code/gklib/cxx/
|
|`-> gk.{hh,cc}
|`-> libgk.o
|
 `-> lib/
     |
     `-> libgk.a 
```

我已经`gk.cc`使用`-c`标志编译，然后将生成的目标文件转换为带有.a 的*.a*文件`ar rvsc lib/libgk.a libgk.o`。

该库的客户端位于文件夹`~/code/cpp`。在此目录中，我再次编译`some_stuff.cc`为目标文件，然后尝试使用以下命令链接到它：

```
$ cxx some_stuff.o -L../gklib/cxx/lib -lgk -o some_stuff 
```

我收到此错误：

```
some_stuff.o: In function `main':
some_stuff.cc:(.text+0x49): undefined reference to `void GK::algorithms::insertionSort<int, 5ul>(int*)'
collect2: error: ld returned 1 exit status 
```

这些是这些文件的内容：

*~/code/cpp/some_stuff.cc*

```
#include <cstdlib>
#include <iostream>
#include <gk.hh>

using namespace std;

int main(int argc, char **argv) {
  int i = -1;
  int arr[5] = { 3, 4, 2, 1, 5 };
  const size_t len = sizeof(arr)/sizeof(int);
  GK::algorithms::insertionSort<int, len>(arr);
  while(++i < 5)
    cout << arr[i] << " ";
  cout << endl;
  exit(EXIT_SUCCESS);
} 
```

*~/code/gklib/cxx/gk.cc*

```
#include "gk.hh"
template<class T, size_t len>
void GK::algorithms::insertionSort(T arr[len]){
  // insertion sort
} 
```

*~/code/gklib/cxx/gk.hh*

```
#pragma once
#include <cstdlib>

#define NAMESPACE(ns) namespace ns {
#define END_NAMESPACE(ns) }

NAMESPACE(GK)
NAMESPACE(algorithms)

template<class T, size_t len>
extern void insertionSort(T arr[len]);

END_NAMESPACE(algorithms)
END_NAMESPACE(GK) 
```

我对我的命令尝试了很多变体，但没有结果。互联网上到处都是教程和论坛，其中包含对我不起作用的说明。当所有的东西都在一个文件中时，这段代码运行得很好。我该如何解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:20:27.477

我认为它更像是：

```
cxx some_stuff.o -L$HOME/gklib/cxx/lib -B../gklib/cxx/lib -lgklib -o some_stuff 
```

`-lgklib`，而不是`-Igklib`（`-I`选项指定包含文件夹）

但你必须重命名你`gklib.a`的`libgklib.a`

也许你甚至可以删除`-B../gklib/cxx/lib`，试试看:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:19:24.433

我看到几个问题：按顺序：

*   如果这是您的确切命令行，则该`-L`选项不指向您上面显示的结构（ `cxx`路径中没有）。

*   我不知道你为什么使用`-B`. 这告诉编译器在哪里寻找*它的*库等。通常，只有当你想测试你修改的编译器的部分时才需要这样做。

*   我没有看到您指定链接到库的位置。由于该库不遵守通常的命名约定 ( )，因此您必须直接指定它（以与指定目标文件相同的方式），并且不使用该选项。或者，您将其命名为 或类似名称，并在您的目标文件*之后*添加一个到命令行。`lib*name*.a``-L``libgk.a``-lgk`

**   最后，错误消息是指模板的实例化。这通常是因为模板的实现在源文件中，而不是在头文件中。该标准要求实现在触发模板的实例化时是可见的。g++（和几乎所有其他编译器）的工作方式是，如果实现不可见，他们假设模板将在另一个翻译单元中实例化，并输出对它的外部引用。但是，如果实现在源代码中，则不会有实例化，并且您将收到链接器错误。（你也不会在任何地方找到用于实例化的汇编程序，因为模板还没有被实例化。）你应该在标题的底部包含源代码，而不是单独编译它。* 

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T17:51:50.150

[在这个](https://stackoverflow.com/questions/7731021/c-gcc-undefined-reference-to-stackintstackint?lq=1)和[这个](https://stackoverflow.com/questions/7583710/including-cpp-at-end-of-template-header-file)问题的帮助下，我已经解决了这个问题。问题在于它`void insertionSort(T *)`是一个模板函数，而模板函数只能在头文件中实现。这样做的原因是，编译器需要达到 的定义，以便为每次调用它创建一个新函数，并使用不同的类型作为模板的参数。我已将此函数的定义移至`gk.h`，从而成功编译和链接。*

# dojo - Dojox 表单/上传文件选择行为

> ID：14755714
> 
> 赞同：0
> 
> 时间：2013-02-07T16:13:09.003
> 
> 标签：dojo, dijit.form

我如何检测某人何时确实从文件资源管理器中选择了一些文件并点击了选择？我想在选择文件时添加一个事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T13:53:31.967

我想到了。您必须将输入表单绑定到 onChange 方法。

```
<input type="file" data-dojo-attach-event="onChange:_onUpload" data-dojo-type="dojox/form.Uploader"/>

_onUpload: function(evt){

} 
```

# javascript - jquery脚本生成表单元素？

> ID：14755716
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:13:12.720
> 
> 标签：javascript, jquery, jquery-plugins

我有一个简单的 jquery 脚本，它允许我在上传的文件旁边创建文本框

```
$(function(){

    //------------- Plupload php upload  -------------//
    // Setup html4 version
    $("#html4_uploader").pluploadQueue({
        // General settings
        runtimes : 'html4', 
        url : '../../assets/dashboard/php/upload.php',
        max_file_size : '10mb',
        max_file_count: 15, // user can add no more then 15 files at a time
        chunk_size : '5mb',
        multiple_queues : true,

        // Rename files by clicking on their titles
        rename: true,

        // Sort files
        sortable: true,
    });

    var uploader = $('#html4_uploader').pluploadQueue();
    uploader.bind('FileUploaded', function(up, file, info) {
            if (uploader.files.length == (uploader.total.uploaded + uploader.total.failed)) {
                $('.gradient').hide();

                form    = '<form class="form-horizontal" id="form-validate" novalidate="novalidate" method="post">';
                length  = uploader.files.length;
                files   = uploader.files;

                for (var i = 0; i <= length-1; i++) {
                    form+= '<div class="alert alert-success" id="message" style="display:none;"></div>';
                    form+= '<div class="form-row row-fluid">';
                    form+= '<div class="span12">';
                    form+= '<div class="row-fluid">';
                    form+= '<label class="form-label span3" for="medianame">File Title</label>';
                    form+= '<input class="span3 text" id="medianame'+i+'" name="mediatitle[]" type="text">';
                    form+= '<input type="hidden" name="mediapath[]" value="'+files[i].name+'" >';
                    form+= '<strong style="margin-right:20px;" >'+files[i].name+'</strong>';
                    form+= '</div>';
                    form+= '</div>';
                 };

                 form+= '<div class="form-row row-fluid">';
                 form+= '<div class="span12">';
                 form+= '<div class="row-fluid">';
                 form+= '<div class="form-actions">';
                 form+= '<div class="span3"></div>';
                 form+= '<div class="span9 controls">';
                 form+= '<button type="submit" id="submit" class="btn marginR10" style="margin:10px;" >Save</button>';
                 form+= '<button class="btn btn-danger">Delete</button>';
                 form+= '</div>';                  
                 form+= '</div>';
                 form+= '</div>';
                 form+= '</div>';
                 form+= '</div>';
                 form+= '</form>';
                 $('#multiform').html(form);

                 $('#submit').click(function()
                 {
                        $.ajax
                        ({
                            type: "POST",
                            url: "",
                            dataType: "json",
                            data: $('form').serialize(),
                            cache: false,
                            beforeSend: function()
                            {
                                $('#message').hide();
                            },
                            success: function(data)
                            {
                                if(data.response)
                                {
                                    $('#message').show().html(data.message);
                                }
                            }
                        });
                        return false;
                 });
            }
        });

}); 
```

该脚本工作正常，但在创建文本框时有一个问题
第一个文本框工作正常，但所有其他框都被禁用我无法单击它们来编写文本
我试图修改它很多时间但我可以不知道为什么会出现这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:30:00.077

这是因为您正在生成重复`id`的 s。

您正在为 for 循环的每次迭代创建一个`div`带有“消息”的“消息”。`id`有多个相同的元素`id`是无效的 HTML，因为`id`s在文档中*必须*是唯一的。

当您`id`使用 jQuery 选择器选择它或者`.getElementById()`它只选择*第*一个，因为不应该有任何其他元素具有相同的`id`.

现在您的`label`及其`for`属性也存在问题。你所有的标签都指向一个带有`id`“medianame”的元素。那应该改成

```
<label class="form-label span3" for="medianame'+i+'">FileTitle</label> 
```

匹配下一行生成的输入。

# batch-file - 如何列出服务器上的所有 iSCSI 连接？

> ID：14755720
> 
> 赞同：0
> 
> 时间：2013-02-07T16:13:35.847
> 
> 标签：batch-file, iscsi

我正在尝试列出我网络上的所有 iSCSI 连接。我看到了一个很好的方法来做这个“嘿，脚本专家！” 通过powershell 3.0，但我需要另一种方式。有没有人知道如何通过命令行获得 iSCSI 连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:48:21.830

弄清楚了：

psexec @listOfServers.txt -u DOMAIN\user iscsicli ListTargets

# python - 有关如何为 Pygments 编写词法分析器的大量文档？

> ID：14755721
> 
> 赞同：10
> 
> 时间：2013-02-07T16:13:38.033
> 
> 标签：python, stata, pygments

我有一本[Stata](http://stata.com/)关键字字典和 Stata 语法的合理知识。我想花几个小时把它变成[Pygments](http://pygments.org/)的 Stata 词法分析器。

但是，我找不到足够的有关词法分析器语法的文档，并且发现自己无法开始编写词法分析器。**有人可以指出一个为 Pygments 编写新词法分析器的好教程吗？**

我知道[Pygments API](http://pygments.org/docs/api/)和[lexer development page](http://pygments.org/docs/lexerdevelopment/)，但老实说，对于像我这样对 Python 知识非常有限的人来说，这些还不够。

到目前为止，我的策略是寻找例子。我找到[了很多](https://github.com/search?p=3&q=pygments+lexer&ref=commandbar)，例如[Puppet](https://github.com/rodjek/puppet-pygments-lexer/blob/master/puppet_lexer/__init__.py)、[Sass](https://github.com/chriseppstein/pygments-sass-lexer/blob/master/sass_lexer/__init__.py)、[Scala](https://github.com/iamjwc/pygments-scala-lexer/blob/master/scala_lexer.py)、[Ada](https://github.com/jschaf/Ada-Pygments-Lexer/blob/master/ada_lexer/__init__.py)。他们只帮了这么多。欢迎任何有关如何从我的 Stata 关键字开始的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T13:02:31.030

如果您只是想突出显示关键字，您可以从这个开始（用您自己的 Stata 关键字列表替换关键字）：

```
class StataLexer(RegexLexer):

    name = 'Stata'
    aliases = ['stata']
    filenames = '*.stata'
    flags = re.MULTILINE | re.DOTALL

    tokens = {
       'root': [
           (r'(abstract|case|catch|class|do|else|extends|false|final|'
            r'finally|for|forSome|if|implicit|import|lazy|match|new|null|'
            r'object|override|package|private|protected|requires|return|'
            r'sealed|super|this|throw|trait|try|true|type|while|with|'
            r'yield)\b', Keyword),
       ],
   } 
```

我认为您的问题不在于您不了解任何 Python，而是您在编写词法分析器或了解词法分析器的工作原理方面没有太多经验？因为这个实现相当简单。

然后，如果您想添加更多内容，请在`root`列表中添加一个额外的元素，一个双元素元组，其中第一个元素是正则表达式，第二个元素指定一个句法类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T03:38:03.290

我最近尝试编写一个 pygments 词法分析器（用于 BibTeX，它具有简单的语法），并同意您的评估，即那里的资源对不熟悉 Python 或一般代码解析概念的人没有多大帮助。

我发现最有用的是[Pygments 中包含的词法分析器集合](https://bitbucket.org/birkenfeld/pygments-main/src/1df5916a89237546fe1de8a26d1755d261554c65/pygments/lexers/)。

有一个文件`_mapping.py`列出了所有已识别的语言格式以及每个格式的词法分析器对象的链接。为了构建我的词法分析器，我尝试考虑与我正在处理的语言具有相似结构的语言，并检查是否可以梳理出一些有用的东西。一些内置的词法分析器比我想要的更复杂，但其他的很有帮助。

# c# - ADO.Net 数据集在更新后不会将生成的标识提取到数据表中

> ID：14755723
> 
> 赞同：1
> 
> 时间：2013-02-07T16:13:48.173
> 
> 标签：c#, ado.net

没有找到对我的问题有用的答案，所以也许在这里试试我的运气。我正在尝试使用 C# Ado.Net 数据集将记录添加到 MSAccess mdb 文件中的表中。一切都很好，直到我尝试将新行添加到另一个用外键引用的表中。这不能按计划工作，因为在我用前一个新行更新数据表后，objectrow 仍然具有默认的“-1”id 值，因此由于外键而无法添加新行。应更新 id 值，因为该列是 MSaccess 的自动增量/身份变量类型。

我使用了通用名称，因为我用另一种语言写了这个......

```
public void addObject(Object o)
        {

        ds.objects.Clear(); //clear datatable where ds is reference to dataset
        Data.DBManagerDataSet.objectRow row = ds.objects.NewobjectRow();

        FillRowWithVariables(row, o); //fill row with some random variables

        ds.objects.Rows.Add(rij);
        taObjects.Update(ds.objects); //tell tableadapter to update objects

        Object2 p = AddObjectWithSomeRandomVariables(o.RandomVariable);

        Data.DBManagerDataSet.object_otherobjectRow linkrow = ds.object_otherobject.Newobject_otherobjectRow(); //new row to reference the other one

        linkrow.object_id = row.object_id;
        linkrow.otherobject = p.Id;
        ds.object_otherobject.Rows.Add(linkrow);
        taobject_otherobject.Update(ds.object_otherobject);

        } 
```

一些帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T00:49:30.853

有一篇 MSDN 文章介绍了如何执行此操作（包括底部的 Access 示例代码）：http: [//msdn.microsoft.com/en-us/library/ks9f57t0.aspx](http://msdn.microsoft.com/en-us/library/ks9f57t0.aspx)

编辑：

MSDN 推荐的方法是将事件处理程序添加到`OleDbDataAdapter.RowUpdated`将检索插入行的自动编号的事件：

```
private static void OnRowUpdated(object sender, OleDbRowUpdatedEventArgs e)
{
    // Conditionally execute this code block on inserts only.
    if (e.StatementType == StatementType.Insert)
    {
        OleDbCommand cmdNewID = new OleDbCommand("SELECT @@IDENTITY", connection);
        // Retrieve the Autonumber and store it in the CategoryID column.
        e.Row["CategoryID"] = (int)cmdNewID.ExecuteScalar();
        e.Status = UpdateStatus.SkipCurrentRow;
    }
} 
```

# batch-file - 需要帮助将批处理文件中的变量重定向到逗号分隔的文本文件

> ID：14755728
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:14:04.973
> 
> 标签：batch-file, redirect

有人可以帮我解决这个问题。

我在批处理文件中有 5 个变量，这些变量是通过提示输入的

```
set Name=john smith
set address=25 center street
set city=Hackenack
set state=NJ
set zip-07601 
```

我想创建一个名为clients.txt 的以逗号分隔的输出文本文件，该文件将在一行中包含所有变量的内容，用逗号分隔字段。

我将在变量中有数百个具有不同值的输入记录。

我只需要帮助向我展示如何将变量重定向到一个输出记录。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:56:26.377

```
@echo off
setlocal
SET /P name="Name? "
SET /P address="Street address? "
SET /P city="City? "
SET /P state="State? "
SET /P zip="Zip? "

echo %name%,%address%,%city%,%state%,%zip% >> clients.txt 
```

如果您希望它是真正的 CSV 格式，则需要用引号将输入的值括起来，如下所示。

`echo "%name%","%address%","%city%","%state%","%zip%" >> clients.txt`

如果您希望文本文件完全是一行（不是每个分组一行），那么

`set /p I="%name%","%address%","%city%","%state%","%zip%" <NUL >> clients.txt`

并且对于随后`set /p I=stuff<NUL >>clients.txt`的每个数据将被写入附加到第一行，没有换行符。

**解释**

当您使用单个`>`文本回显数据时，本应输出到控制台的数据会被重定向到新的输出文件，如果目标文件已经存在，则覆盖它。

当您使用双精度回显数据时`>>`，输出将附加到现有文件而不覆盖（或者如果文件尚不存在则创建）。

在没有换行符的情况下追加有点棘手，并且需要一点技巧：`set /p var=text to append<NUL >>outfile.txt`. 如果您需要更多详细信息，请发表评论，我将尝试解释*为什么*会这样。

# javascript - Javascript 日期减法返回 (Pentaho)

> ID：14755729
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:14:15.273
> 
> 标签：javascript, pentaho

如何用天减去日期..

例如;- curdate: 20130207 原始日期必须是: 20130206,2010205, 20130204,..., 20130201, 20130131, 20130130 等。

如何使用 javascript（或者如果你知道 Pentaho 的计算器步骤）来做到这一点？

说，我想回去 90 天。

困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:19:24.817

使用`setDate`和`getDate`：

```
var yesterday = new Date();
yesterday.setDate(yesterday.getDate() - 1)); 
```

或者，在您的所有 90 天内：

```
d = new Date();
for (i = 1; i <= 90; i++) {
   d.setDate(d.getDate() - 1);
   console.log(i+" days ago: "+d);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:27:17.260

使用类似的东西：

```
var d1 = new Date(2012, 1, 6) // date(year, month - 1, day)
days= -90; //# of days
var d2 = new Date(d1.setDate(d1.getDate() + days)); 
```

演示：http: [//jsfiddle.net/dirtyd77/qZWJE/](http://jsfiddle.net/dirtyd77/qZWJE/)

# visual-studio-2008 - Visual Studio 中源文件的绝对路径

> ID：14755730
> 
> 赞同：2
> 
> 时间：2013-02-07T16:14:20.827
> 
> 标签：visual-studio-2008

我有一个源代码文件，`raven_sqlite.cpp`我在不同的项目中使用它。我将此文件的一份副本保存`C:\Users\James\Documents\code\ravenset`在系统环境变量 指向的文件夹中`$RAVENROOT`。这样我只需要维护一份代码，我的所有项目都可以确保使用相同的版本。

以下是它在[解决方案资源管理器](https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Other_tools)的 Visual Studio 属性视图中的外观：

![在此处输入图像描述](../Images/e5fda967fa55a52de8a9e99068b2efa3.png)

请注意，虽然可编辑属性的标题是相对路径，但完整路径是环境变量指定的绝对路径，*而不是*相对于项目目录的路径。

对于几个项目，这已经完美地工作了好几个月。

突然，这对一个项目停止工作（其他项目仍在正常工作）。

对于失败的项目，它看起来像这样：

![在此处输入图像描述](../Images/ffa9caf0eeadf059c0f4ed008c2b28fb.png)

不是现在如何通过添加项目目录和添加环境变量等来构建完整路径。环境变量*没有*被扩展（或解析或你称之为:-)

为什么 Visual Studio 2008 突然停止为这个项目扩展环境变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:19:07.103

好吧，我找到了解决方法。如果我停止 Visual Studio 然后重新启动它，一切都会再次运行。我想我可以忍受。

# jquery - asp.net jquery 按钮单击防止回发

> ID：14755731
> 
> 赞同：3
> 
> 时间：2013-02-07T16:14:27.227
> 
> 标签：jquery, asp.net, postback

我想要 asp:Button ，当我点击它时，我不希望它做回发，而是在 . 这是我的代码

```
 <script type="text/javascript">
        $(document).ready(function (e) {
            $('#<%=btn_comment_add.ClientID %>').click(function (e) {
                $('#comments').append('<div>asd</div>');
                return false;
            });
        });
    </script> 
```

这是 asp.net 按钮

```
 <asp:Button ID="btn_comment_add" runat="server" Text="Gönder" CssClass="theme04" UseSubmitBehavior="false" /> 
```

我可以看到该代码添加了 div 但它回发了所以它被删除了。我只看到了新的 div :)

请帮我修复它，这样它就不会回发。非常感谢大家

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T16:26:41.973

而不是`ASP Button`使用简单的 HTML 按钮并分配`jquery`您希望运行的功能，

```
<input type="button" name="btnname" onclick="MyJueryFunction()" /> 
```

把你的jquery写成

```
function  MyJueryFunction()
{
  $('#comments').append('<div>asd</div>');

 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T16:16:52.087

如果您不希望它回发，那么为什么要有一个 asp.net 按钮？在任何情况下，您都可以这样做：

```
 <asp:Button ID="btn_comment_add" runat="server" Text="Gönder" CssClass="theme04" UseSubmitBehavior="false" 
OnClientClick="return false;" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T16:22:21.713

摆脱`UseSubmitBehavior`.

当您将此设置为 false 时，ASP.NET 将添加一个客户端`onclick`事件，该事件将在您自己的 javascript 事件之前/之后触发，因此无论您在 click 事件中做什么来尝试阻止它回发，它都会。

查看页面的源代码，你会看到类似的东西；

```
javascript:__doPostBack(&#39;btnID&#39;,&#39;&#39;) 
```

在按钮上

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-12T05:19:36.480

有几种方法可以实现这一目标。以下是另一种方式

```
 $("#<%=ButtonClick.ClientID %>").bind('click', function (e) {
         e.preventDefault();
         //Do Your work 
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-03T11:11:27.687

在这种情况下，ASP 按钮必须通过一些验证来调用函数 //ASP 按钮

asp:Button ID="btnSave" runat="server" Text="Save" class="btn btn-success" OnClientClick="return Valid()" OnClick="btnSave_Click"

函数有效（）{

```
 if ($("#ctl00_ContentPlaceHolder1_ddlLocation").val() == 0) {
            alert("Please select Location");
            $("#ctl00_ContentPlaceHolder1_ddlLocation").focus();
            return false;
        }

        if ($("#ctl00_ContentPlaceHolder1_txtArea").val().length == 0) {
            alert("Please Type Area");
            $("ctl00_ContentPlaceHolder1_txtArea").focus();
            return false;
        }
        return true;
    } 
```

# android - 带有光标的 Android SQLite

> ID：14755732
> 
> 赞同：0
> 
> 时间：2013-02-07T16:14:28.827
> 
> 标签：android, sql, sqlite, relational-database

在之前的帖子中，我对我的问题还不够清楚：

我有 2 节课：

```
public class Categorie {

    // Attributs
    private int identifiant;
    private String libelle;

   ...
}

public class Restaurant {

    // Attributs
    private int identifiant;
    private String nom;
    private String description;
    private List<Categorie> lesCategories;

    ...
} 
```

在 SQLite 中：

```
CREATE TABLE Categorie
( categorie_id  INTEGER PRIMARY KEY
, libelle       TEXT    NOT NULL
);

CREATE TABLE Restaurant
( restaurant_id INTEGER PRIMARY KEY
, nom           TEXT    NOT NULL
, description   TEXT
);

CREATE TABLE RestaurantCategorie
( restaurant_id INTEGER NOT NULL    REFERENCES Restaurant
, categorie_id  INTEGER NOT NULL    REFERENCES Categorie
, PRIMARY KEY (restaurant_id, categorie_id)
); 
```

但是为了创建我的光标，我不知道该怎么做......

```
public Restaurant ConvertCursorToObject(Cursor c) { 

Restaurant restaurant= new Restaurant ( 
    c.getInt(EnseigneOpenHelper.NUM_RES_ID), 
    c.getString(EnseigneOpenHelper.NUM_RES_NOM),
    c.getString(EnseigneOpenHelper.NUM_RES_DESCRIPtion), 
    ????
); 
return restaurant; 
}

/** * Convert a cursor in Restaurant */

public Restaurant ConvertCursorToOneObject(Cursor c) { 
    c.moveToFirst(); 
    Restaurant restaurant = ConvertCursorToObject(c); 
    c.close(); 
    return restaurant ; 
} 
```

这个问题就在这里=“？？？？？？” 我的构造函数想要一个 List Category 类型的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:31:39.710

使用您从第一个查询中获得的餐厅 ID 对类别执行另一个查询。然后从新游标的结果中构建一个类别列表。

# ruby-on-rails - Calendar_Date_Select rails -- 不可编辑

> ID：14755733
> 
> 赞同：0
> 
> 时间：2013-02-07T16:14:40.223
> 
> 标签：ruby-on-rails, ruby

我在我的应用程序中使用 calendar_date_select 作为日期..

```
<% calendar_date_select :start_date %> 
```

我在`controller.action_name=="new"`.

对于`controller.action_name=="edit"`我正在显示这样的日期

```
<% calendar_date_select :start_date, @date, :pop_up => "force" %> 
```

这里@date 表示start_date 值，我从数据库中检索，使用@date。

实际上日期正在显示，我可以编辑日期。

但对于特定阶段，我不应该编辑日期。我试图搜索 calendar_date_select 不可编辑。有没有办法不使用 calendar_date_select 编辑日期。

请建议我如果还有其他选择..为此..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:20:26.833

不要`calendar_date_select`为此使用，使用普通的`text_field_tag`：

```
<%= text_field_tag(:start_date, @date, {readonly: true}) %> 
```

这应该使用您的`@date`值创建一个文本字段并将该文本字段标记为只读。

# c# - 在标题中带有下拉菜单的自定义 WPF DataGrid

> ID：14755737
> 
> 赞同：2
> 
> 时间：2013-02-07T16:14:51.510
> 
> 标签：c#, wpf, data-binding, datagrid, wpfdatagrid

我正在尝试创建一个在标题中有下拉菜单的 DataGrid，但我不确定如何去做。

DataGrid 本身是从一个 CSV 文件中填充的，该文件可以有许多不同的格式，因此我无法在 XAML 中预先定义列，而是将它们设置为：

```
 //add headers as columns on the data grid
 var headerRow = _inputFile.GetHeaderRow();
 foreach (var hr in headerRow)
 {
      var textColumn = new DataGridTextColumn();
      textColumn.Header = hr;
      SourceGrid.Columns.Add(textColumn);
 } 
```

我的目标是在标题列（或第一行，如果样式合适）中也有下拉菜单，因为我的想法是我将输入 CSV 文件映射到一组预定义的输出，所以我想要用户通过下拉菜单选择每个输入文件头将其映射到的内容。

尝试在 xaml 中定义数据网格模板会更好吗？或者也许将我的输入数据安排到一个类结构中，这样可以更容易地以我想要的方式将数据绑定到网格？还是完全不同的东西？

我对 WPF 相当陌生，并且很难找到从这里去的地方，所以即使是正确方向的指针也会非常有帮助！

* * *

编辑：

```
var comboColumn = new DataGridComboBoxColumn();
comboColumn.Header = new ComboBox();
SourceGrid.Columns.Add(comboColumn); 
```

所以我知道我可以将标题设置为代码中的文本或组合框，但是有没有办法将文本和组合框放在同一个列标题中？另外，我解决这个问题的方法是一个好的方法还是我应该考虑另一种控制？或者也许使用数据绑定而不是在代码中设置值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:32:11.423

下面的代码将帮助您在 wpf 中显示 Combobox 标题。

```
<DataGridTextColumn Binding="{Binding FirstName}">
     <DataGridTextColumn.Header>
      <ComboBox />
     </DataGridTextColumn.Header>
    </DataGridTextColumn> 
```

# php - PHP方法返回致命错误：不在对象上下文中使用$this

> ID：14755738
> 
> 赞同：1
> 
> 时间：2013-02-07T16:14:52.757
> 
> 标签：php, class, this

所以我有一堂课：

```
<?php 
class Database extends PDO implements DatabaseCore
{
  private $connections;
  private $runQueryType = array('select'=>array(),
      'update'=>array(),
      'insert'=>array(),
      'delete'=>array());
  private $activeDB;
  private $databaseKeys = array();

  function __construct()
  {
    global $databases;
    foreach ($databases as $key=>$value) {
      $this->openConnection($value['dsn'], $value['user'], $value['password'], $key);
      array_push($this->databaseKeys, $key);
      $this->enumerateQueryRights($key, $value['rights']);
      Query::initQuery();
    }
  }

  function __destruct()
  {
    foreach ($this->databaseKeys as $key) {
      unset($this->connections->$key);
    }
  }

  function enumerateQueryRights($key, array $rights = array())
  {
    foreach ($rights as $r) {
      array_push($this->runQueryType[$r], $key);
    }
  }

  public function getConnection($key = 'mysqli')
  {
    //ERROR_HERE: PHP says $this is not an object at this point??
    return $this->connections->$key;
  }

  function parseConnectionInfo()
  {

  }

  function getRightByKey($key, $op = 'select')
  {
    return in_array($key, $this->runQueryType[$op]);
  }
  function closeConnection($key)
  {
    if (isset($this->connections->$key)) {
      unset($this->connections->$key);
      return TRUE;
    } else {
      return FALSE;
    }
  }

  function getConnectionInfo($key)
  {

  }

  function getConnectionKeys()
  {
    return array_values($this->databaseKeys);
  }

  function openConnection($dsn, $user, $password, $key = 'mysqli')
  {
    try {
      $this->connections->$key = new PDO($dsn, $user, $password);
      $this->connections->$key->setAttribute(PDO::ATTR_EMULATE_PREPARES, TRUE);
      $this->connections->$key->setAttribute(PDO::ATTR_ERRMODE,     PDO::ERRMODE_EXCEPTION);
    } catch (PDOException $e) {
      throw new Exception('Error: connection to Database');
      error_log($key  . '_CONNECT_ERROR' . "\t" . $e);
      set_message('We\'ve encountered an error.  To try again, please log into <a     href="https://powerschool.bps101.net">Powerschool</a>.', 'error');
      mail('Jason.ott@bps101.net', 'Error connecting to '.$key, $e);
      die('We can\'t connect to our database, an administrator has been notified');
    }
  }

  public function getError()
  {

  }
}//class 
```

在函数 getConnection($key = 'mysqli') 我有 return $this->connections-$key;

php 抛出的错误就在此时：

```
Fatal error: Using $this when not in object context in /var/www/html/projects/fees/library/class/database.inc on line 40 (if I counted right, look for the comment in the code, ERROR_HERE) 
```

我真的不确定为什么 $this 在脚本中当时不被视为对象。任何建议将不胜感激，如果您需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:37:21.467

你怎么叫`getConnection()`？您是否尝试将其称为静态方法？

例如，您是否正在做这样的事情：

```
$conn = Database::getConnection(); 
```

如果您是这样称呼它的，那么不，您不能`$this`在那种情况下使用它，因为它是静态的；它没有引用对象。您还需要该`connections`属性是静态的。

# javascript - 推迟脚本执行一段时间

> ID：14755739
> 
> 赞同：1
> 
> 时间：2013-02-07T16:14:59.153
> 
> 标签：javascript, deferred-execution

在 javascript 中，是否有可能推迟执行位于顶层闭包的自执行函数？（为您理解，jQuery 使用 this。它在全局范围内具有自执行功能）

我的目标是让整个外部脚本在以后执行而不延迟它的下载，以便它尽快下载并在事件发生后执行（我决定该事件何时发生）。

我也发现了这个：
[https ://developer.mozilla.org/en-US/docs/DOM/element.onbeforescriptexecute](https://developer.mozilla.org/en-US/docs/DOM/element.onbeforescriptexecute)

听起来像是我想要的“第 1 部分”。如果我取消，则不会执行脚本。但是然后......我以后如何有效地执行它？

**注意1：**我完全无法控制那个外部脚本，所以我不能改变它。

**注意2：**我和谁请求这个都不关心IE是否因为这样的事情而变慢（是的，真的！（s）他像我一样反IE）

编辑（附加信息）：
@SLaks 服务器发送 apache 发送的默认标头（看起来如此）加上缓存控制标头排序缓存 12 小时。
从关于域的规则的观点来看，它是跨域的。
我不允许更改有关其他服务器的定义。不过，我可以尝试要求它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:20:21.860

不幸的是，无法使用`<script>`标记，因为您无法以这种方式将外部脚本的文本包含在代码中以延迟它。[如果可以的话，那将通过跨站点请求伪造（ CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)）开辟一个全新的可能性世界。

但是，您可以使用 AJAX 请求获取脚本，只要它托管在相同的域名下即可。然后你可以延迟它的执行。

```
$.ajax({
    url: '/path/to/myscript.js',
    success: function(data) {
        // Replace this with whatever you're waiting for to delay it
        $.ready(function() {
            eval(data);
        });
    }
}); 
```

**编辑**`$.getScript()`自从我使用[RequireJS](http://requirejs.org/)来包含脚本以来，我 从来没有使用过自己，所以我不知道它是否有助于满足您的需求，但请看一下：[http ://api.jquery.com/jQuery.getScript /](http://api.jquery.com/jQuery.getScript/)

**仅供参考** ，如果您想知道我在谈论 CSRF 攻击的内容，[请查看此](https://stackoverflow.com/questions/2669690/why-does-google-prepend-while1-to-their-json-responses)内容。

# java - Java 日期年计算按年关闭两天

> ID：14755742
> 
> 赞同：18
> 
> 时间：2013-02-07T16:15:01.907
> 
> 标签：java, date, calendar, simpledateformat

如果您可以想象的话，这会在我的软件中造成 Y2K 风格的错误。奇怪的是一年的计算只发生在一年中的两天，我不太确定如何排除故障。

输出：

```
03-Jan-2013
02-Jan-2013
01-Jan-2013
31-Dec-2013 ** strange
30-Dec-2013 ** strange
29-Dec-2012
28-Dec-2012
27-Dec-2012
26-Dec-2012
25-Dec-2012 
```

我不确定 Java 日期实用程序的哪一部分会导致这样的错误。

代码（因为测试太小了，我包含了一个完整的工作程序）：

```
import java.util.Calendar;
import java.util.Date;
import java.text.SimpleDateFormat;

public class DateT {

        private static String getFormattedBackscanStartTime(int days) {

                SimpleDateFormat dateFormat = new SimpleDateFormat("dd-MMM-YYYY");
                Calendar workingDate = Calendar.getInstance();
                workingDate.add(Calendar.DATE, -1 * days);

                String formattedStartTime = dateFormat.format(workingDate.getTime());
                return formattedStartTime;
        }

        public static void main(String args[]) {

                for(int i = 35; i < 45; i++) {
                        System.out.println(getFormattedBackscanStartTime(i));
                }
        }
} 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-02-07T16:17:48.823

这就是问题：

```
"dd-MMM-YYYY" 
```

`YYYY`是周年，而不是日历年。你想要`yyyy`。

2012 日历年的最后两天在 2013 年周的第一周。您通常应该只将周年与“周年”说明符 ( `w`) 一起使用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-07T16:21:51.267

我假设您正在使用`java 1.7`.

上面的代码片段将无法使用，`java 1.6`因为`SimpleDateFormat("dd-MMM-YYYY")`会引发`java.lang.IllegalArgumentException`（YYYY 在 中不可用`java 1.6`）

您需要使用`yyyy`而不是`YYYY`.

```
Y -> week-year
y -> year 
```

[这里](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)

编辑

适用于`yyyy`：

```
$ java DateT
03-Jan-2013
02-Jan-2013
01-Jan-2013
31-Dec-2012
30-Dec-2012
29-Dec-2012
28-Dec-2012
27-Dec-2012
26-Dec-2012
25-Dec-2012 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-07T16:21:02.587

`yyyy`问题出在你的日期格式字符串-年不应该`YYYY`。

如果您`workingDate.getTime()`在循环的每次迭代中打印 的值，您会看到它具有预期值：

```
Thu Jan 03 11:19:33 EST 2013
Wed Jan 02 11:19:33 EST 2013
Tue Jan 01 11:19:33 EST 2013
Mon Dec 31 11:19:33 EST 2012
Sun Dec 30 11:19:33 EST 2012
Sat Dec 29 11:19:33 EST 2012
Fri Dec 28 11:19:33 EST 2012
Thu Dec 27 11:19:33 EST 2012
Wed Dec 26 11:19:33 EST 2012
Tue Dec 25 11:19:33 EST 2012 
```

因此问题在于 SimpleDateFormat 的使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-08T14:25:51.013

为了完整起见，这是使用的现代答案`LocalDate`（如 Basil Bourque 在评论中推荐的那样）。

```
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Locale;

public class DateT {

    private static DateTimeFormatter dateFormatter 
            = DateTimeFormatter.ofPattern("dd-MMM-uuuu", Locale.US);

    private static String getFormattedBackscanStartTime(int days) {
        return LocalDate.now(ZoneId.systemDefault()).minusDays(days).format(dateFormatter);
    }

    public static void main(String args[]) {
        for(int i = 155; i < 165; i++) {
            System.out.println(getFormattedBackscanStartTime(i));
        }
    }
} 
```

今天运行这个我得到了

```
04-Jan-2017
03-Jan-2017
02-Jan-2017
01-Jan-2017
31-Dec-2016
30-Dec-2016
29-Dec-2016
28-Dec-2016
27-Dec-2016
26-Dec-2016 
```

需要注意的几点：

*   为格式化程序提供明确的语言环境以控制输出的语言。即使你只是通过`Locale.getDefault()`了，你也是在告诉读者你已经考虑了语言环境并做出了决定。
*   同样，给出一个明确的时区来`LocalDate.now()`告诉读者你已经做出了决定（例如`ZoneId.of("America/New_York")`对于特定的时区；`ZoneId.systemDefault()`对于 JVM 的当前时区设置）。
*   我发现代码比使用老式`Calendar`类的代码更简单、更直接。这对于较新的课程来说是典型的。
*   我已经用`uuuu`了一年了。`yyyy`（小写）也有效，在共同时代（AKA BC）之前的几年里只会有区别。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-07T16:21:04.257

您需要使用小写的 y 作为年份。试试这个：

```
 SimpleDateFormat dateFormat = new SimpleDateFormat("dd-MMM-yyyy"); 
```

# mysql - 为什么 percona xtrabackup 这么慢又大

> ID：14755744
> 
> 赞同：1
> 
> 时间：2013-02-07T16:15:08.533
> 
> 标签：mysql, percona, mysql-backup

当我不带参数调用 innobackupex 时，它会生成所有数据库的备份。它需要三分钟，并产生 8GB 的​​输出。当我运行 mysqldump --all-databases 时，需要 1 分钟，并产生 1.5gb 的输出。既然这两个输出都可以用来重新创建同一个数据库，为什么 xtrabackup 这么慢而且这么大？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T17:34:21.853

你的 ibdata1 文件是 8gb 吗？xtrabackup 对整个文件进行热拷贝。热复制过程不需要锁定表（这允许您的数据库在备份过程中可用）。缺点是文件中未使用的空间也会被备份。

# python - 只将关键字参数传递给 __new__() 而不将其进一步传递给 __init__()？

> ID：14755754
> 
> 赞同：9
> 
> 时间：2013-02-07T16:15:54.183
> 
> 标签：python, mocking

# **第1部分**

我有一个设置，我有一组要模拟的类，我的想法是，在我想这样做的情况下，我将一个`mock`关键字参数传递给构造函数并`__new__`拦截它，而是传回一个模拟版本那个物体。

它看起来像这样（**在@mgilsons 建议之后编辑了关键字查找**）：

```
class RealObject(object):
    def __new__(cls, *args, **kwargs):
        if kwargs.pop('mock', None):
            return MockRealObject()
        return super(RealObect, cls).__new__(cls, *args, **kwargs)

    def __init__(self, whatever = None):
        '''
        Constructor
        '''
        #stuff happens 
```

然后我像这样调用构造函数：

```
ro = RealObject(mock = bool) 
```

我在这里遇到的问题是，当我收到以下错误`bool`时`False`：

`TypeError: __init__() got an unexpected keyword argument 'mock'`

如果我将`mock`其作为关键字参数添加，则此方法有效，`__init__`但我要问的是是否可以避免这种情况。我什至`mock`从`kwargs` `dict`.

这*也是*一个关于设计的问题。有一个更好的方法吗？（当然！）我想尝试这样做，而不使用工厂或超类或任何东西。但是，我应该使用另一个关键字吗？`__call__`?

# **第 2 部分基于 jsbueno 的回答**

所以我想将元类和`__new__`函数提取到一个单独的模块中。我这样做了：

```
class Mockable(object):

    def __new__(cls, *args, **kwargs):

        if kwargs.pop('mock', None):
            mock_cls = eval('{0}{1}'.format('Mock',cls.__name__))
            return super(mock_cls, mock_cls).__new__(mock_cls)

        return super(cls, cls).__new__(cls,*args, **kwargs)

class MockableMetaclass(type):

    def __call__(self, *args, **kwargs):
        obj = self.__new__(self, *args, **kwargs)
        if "mock" in kwargs:
            del kwargs["mock"]

        obj.__init__(*args, **kwargs)

        return obj 
```

我已经在一个单独的模块中定义了类`RealObject`和`MockRealObject`. 我现在有两个问题：

1.  如果`MockableMetaclass`并且`Mockable`不在与`RealObject`班级相同的模块中，`eval`则`NameError`如果我提供`mock = True`.
2.  如果`mock = False`代码将进入一个以令人印象深刻的`RuntimeError: maximum recursion depth exceeded while calling a Python objec`. 我猜这是因为`RealObject`s 的超类不再是`object`，而是`Mockable`。

我该如何解决这些问题？我的方法不正确吗？我应该改为`Mockable`装饰师吗？我试过了，但这似乎不起作用，因为`__new__`一个实例似乎只是只读的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-07T16:58:10.770

这是一份工作`__metaclass__` :-)

负责在实例化 Python 新样式对象时调用的代码位于类元类的`__new__`方法中。（或语义上等价的）。`__init__``__call__`

换句话说 - 当你这样做时：

`RealObject()`——真正叫的是`RealObject.__class__.__call__`方法。由于没有显式声明元类，因此元类是`type`，它是`type.__call__`被调用的。

大多数处理元类的`__new__`方法都是处理方法的子类化——在创建类时自动执行操作。但是重写`__call__`我们可以在类被实例化时采取行动，而不是。

在这种情况下，只需在调用之前删除“mock”关键字参数（如果有）`__init__`：

```
class MetaMock(type):
    def __call__(cls, *args, **kw):
       obj = cls.__new__(cls, *args, **kw)
       if "mock" in kw:
           del kw["mock"]
       obj.__init__(*args, **kw)
       return obj

class RealObject(object):
    __metaclass__ = MetaMock
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:54:54.323

子类非常重要，因为`__new__`总是将参数传递给构造函数调用`__init__`方法。如果您通过类装饰器添加子类作为 mixin，那么您可以拦截`mock`子类中的参数`__init__`：

```
def mock_with(mock_cls):
    class MockMixin(object):
        def __new__(cls, *args, **kwargs):
            if kwargs.pop('mock'):
                return mock_cls()
            return super(MockMixin, cls).__new__(cls, *args, **kwargs)
        def __init__(self, *args, **kwargs):
            kwargs.pop('mock')
            super(MockMixin, self).__init__(*args, **kwargs)
    def decorator(real_cls):
        return type(real_cls.__name__, (MockMixin, real_cls), {})
    return decorator

class MockRealObject(object):
    pass

@mock_with(MockRealObject)
class RealObject(object):
    def __init__(self, whatever=None):
        pass

r = RealObject(mock=False)
assert isinstance(r, RealObject)
m = RealObject(mock=True)
assert isinstance(m, MockRealObject) 
```

另一种方法是让子类`__new__`方法返回`RealObject(cls, *args, **kwargs)`；在这种情况下，因为返回的对象不是子类的实例。但是在这种情况下，`isinstance`检查将失败。

# c# - 获取“递归泛型”的类型？

> ID：14755755
> 
> 赞同：0
> 
> 时间：2013-02-07T16:16:04.070
> 
> 标签：c#, generics, typeof

我确实有一个类，定义为：

```
public abstract class Singleton <T> : BaseObject
    where T : Singleton <T>
{
} 
```

我想在其他地方定义这些通用单例的数组。就像是

```
public MonoSingleton[] singletons; 
```

如何检索该泛型的正确类型（如您所见，这似乎是递归的）？我怎样才能把这个写出来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:21:56.593

您是否正在尝试像这样进行“奇怪的递归模板模式”？

```
class CuriouslyRecursiveBase<T>
{

}

class CuriouslyRecursiveDervied<T> : CuriouslyRecursiveBase<T>
{

}

class MyClass : CuriouslyRecursiveBase<MyClass>
{

} 
```

要实例化从基础派生的，您只需使用：

```
class CuriouslyRecursiveBase<T>
{
    public static void InstantiateDerived()
    {
        T instance = (T)Activator.CreateInstance(typeof(T));
    }
} 
```

因为 T 实际上是派生类型 ( `MyClass`)，而且奇怪的是类型 ( `CuriouslyRecursive<MyClass>`)。

特别适用于您的问题：

```
// Create a common interface that all singletons use. This allows 
// us to add them all to a list.
interface ISingleton { }

class Singleton<T> : ISingleton
{
    // Store our list of ISingletons
    static List<ISingleton> instances = new List<ISingleton>();
    static T instance;

    protected Singleton() { }

    public static T GetInstance()
    {
        // Either return the existing instnace, or create a new one
        if (Singleton<T>.instance == null)
        {
            Singleton<T>.instance = (T)Activator.CreateInstance(typeof(T));

            // Use a common interface so they can all be stored together.
            // Avoids the previously mentioned co-variance problem.
            // Also, compiler isn't built to follow curious recursiveness,
            // so use a dynamic statement to force runtime re-evaluation of 
            // the type hierarchy. Try to avoid dynamic statements in general
            // but in this case its useful.
            instances.Add((dynamic)Singleton<T>.instance);
        }

        return Singleton<T>.instance;
    }
}

class MyClass : Singleton<MyClass>
{

}

public static void Main()
{
    MyClass my = MyClass.GetInstance();
} 
```

更多信息：

[http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:22:29.450

使用设计时代码，您将能够通过使用`typeof`运算符并为泛型参数提供一些参数来获取类型：

```
typeof(Singleton<SomeImplementationOfBaseObject>) 
```

或者

```
typeof(Singleton<>) 
```

但还有另一种选择：反射。

```
Type singletonType = Type.GetType("NamespaceA.NamespaceN.Singleton`1"); 
```

1 部分是泛型参数的数量。如果你有类似的东西，`Class<T, S>`那就是 2 等等。

请注意，使用反射*您不需要给出通用参数*。无论如何，您都可以使用泛型参数获取类型。为了给出通用参数，您可以这样做：

```
Type genericType = singletonType.MakeGenericType(typeof(SomeImplementationOfBaseObject)); 
```

或者，如果您想直接获取它，您可以这样做：

```
Type singletonType = Type.GetType("NamespaceA.NamespaceN.Singleton`1[[NamespaceA.NamespaceN.SomeImplementationOfBaseObject]]"); 
```

`[[ ]]`作为泛型参数传递的类型的全名内的字符串。请注意，如果泛型类型与执行的程序集不同，则需要提供程序集限定名称（*例如，“NamespaceA.MyClass, MyAssembly”*）。

## 更新

OP在一些评论中说：

> 如果我确实使用：公共`Singleton<BaseObject>[]`单例；它会警告我：“错误 CS0309：BaseObject 类型必须可转换为单例”，以便将其用作泛型类型或方法“单例”中的参数“T”

这是另一个问题：你不能在类中做*协方差。*为了做这样的事情，你需要一个这样的界面：

```
public interface ISingleton<out TBaseObject> where TBaseObject : ......... 
```

并让`Singleton<T>`类实现它。

因此，您可以通过以下方式创建这样的数组：

```
public ISingleton<BaseObject>[] singletons; 
```

*协方差*允许您向上转换泛型参数，并且仅限于接口和委托。

在此处了解更多信息：

*   [http://msdn.microsoft.com/en-us/library/ee207183.aspx](http://msdn.microsoft.com/en-us/library/ee207183.aspx)

# asp.net - ASP.NET 服务器验证

> ID：14755756
> 
> 赞同：0
> 
> 时间：2013-02-07T16:16:04.320
> 
> 标签：asp.net, validation

是必填字段验证器、比较验证器等服务器端验证还是客户端验证？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:21:03.067

验证器通常同时在客户端和服务器端进行，但这完全取决于您如何配置它们。寻找[`EnableClientScript`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.enableclientscript.aspx)房产。如果您构建自定义验证器，您可以提供服务器代码、客户端代码或两者都提供，但您必须为双方独立编写代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:20:25.293

它们将在客户端上运行（除非[`EnableClientScript`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.enableclientscript.aspx)is `false`）并在表单无效时阻止提交。如果绕过客户端检查，它们还将在服务器上运行。请务必[`Page.IsValid`](http://msdn.microsoft.com/en-us/library/system.web.ui.page.isvalid.aspx)在事件处理程序中采取行动之前进行检查（即使服务器端验证失败，事件处理程序仍会运行）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T17:11:51.757

我听到的一个很好的解释是

1.  **客户端验证**是为了用户的利益（出于@Garry 在上面的回答中解释的原因）。
2.  **服务器端验证**是为了系统完整性（也是出于@Garry 在上面的回答中解释的原因）。

# php - 如何找到字符串中的出现？

> ID：14755759
> 
> 赞同：0
> 
> 时间：2013-02-07T16:16:08.077
> 
> 标签：php, regex, string, substring

我想知道知道我的子字符串是否在字符串中的最佳方法是什么。

所以，我可以拥有这些价值：

```
"abcd.tif"
"abcd_A.tif"
"abcd_B.tif"
"abcd_VP.tif" 
```

我会检测字符串中是否存在“_A”或“_B”或“_VP”。

最好的方法是什么？使用 substr 和 strlen 的组合？

或使用正则表达式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T16:19:16.383

使用`strpos`，它将为您提供针在字符串中的 0 索引位置。如果它不在字符串中，则`strpos`返回`false`. （也有不区分大小写的`stripos`）。

但是，您一次只能检查一根针。如果您想同时检查这三个中的任何一个，您可以使用循环或编写更简洁但效率较低的方法：

```
preg_match('/_A|_B|_VP/', $str) 
```

`true`...如果这三个字符串中的*任何*一个匹配，它将返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:20:56.803

最有效的方法（我知道：P）是[strpos](http://php.net/manual/en/function.strpos.php)。

```
$s = 'abcd_VP.tif';
if (strpos('_A', $s) !== false) {
     // do your thing
} 
```

你可以在这之后做一个简单的`||`，它不会那么短，但它会比正则表达式快得多：

```
$s = 'abcd_VP.tif';
if ((strpos('_A', $s) !== false) || (strpos('_B', $s) !== false) || (strpos('_VP') !== false)) {
     // do your thing
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:22:14.883

使用 OR 操作，如 (_A)|(_VP) 等。检查这个问题作为提示：[正则表达式：是否有 AND 运算符？](https://stackoverflow.com/questions/469913/regular-expressions-is-there-an-and-operator), 在正则表达式中使用 'OR'。

# html - 将包装类直接应用于元素而不是周围的 div？

> ID：14755762
> 
> 赞同：1
> 
> 时间：2013-02-07T16:16:30.543
> 
> 标签：html, css, layout, positioning

首先，这是我的**HTML**

```
<div class="header">
  <div class="wrapper">
    <div class="navi">
      <a href="#" class="logo">Logo</a>
      <ul><!--
        --><li><a href="#" class="navlink">Link 1</a></li><!--
        --><li><a href="#" class="navlink">Link 2</a></li><!--
      --></ul>
    </div>
  </div>
</div>

<div class="wrapper">
  <div class="content">
    <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
  </div>
</div> 
```

和**CSS**

```
.wrapper {
    width: 90%;
    max-width: 50em;
    margin: 0 auto;
}

.header,
.navi {
    width: 100%;
}

.header {
    background: grey;
}

.navi {
    background: green;
    display: table;
    text-align: center;
}

.navi ul {
    display: table-cell;
    vertical-align: middle;
    text-align: right;
}

.navi li {
    background: orange;
    display: inline;
    margin-left: 10px;
}

.navilink {
    display: inline-block;
    width: auto;
}

.logo {
    background: red;
    float: left;
}

.content {
    width: 100%;
    background: fuchsia;
} 
```

[小提琴](http://jsfiddle.net/SnwCq/)
[全屏小提琴](http://jsfiddle.net/SnwCq/embedded/result/)

您会看到，包装器确保内容和视口边缘之间始终存在某种间隙，并且超过某个点（50 em），`.wrapper`不会超过任何进一步。

我在这里发布的代码有效，但我想知道是否有机会摆脱`<div class="wrapper">`实现相同的结果。我已经尝试将`.wrapper`类直接应用于元素，但这不起作用 - 为什么？

*澄清一下：*我的目标是使标记更清晰。这就是为什么我对解决方案感兴趣，然后确保元素的行为与我发布的示例中的一样，但不使用`<div class="wrapper">`. 当然，课程`.wrapper`必须保持不变，只是让`div`我印象深刻。这就是为什么我尝试`.wrapper`直接添加到元素中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:21:05.597

移除包装器 div，并将两个 CSS 属性添加到内容 div..

```
.content { 
margin: 0 auto;
max-width: 50em;
} 
```

# java - Eclipse 中令牌的语法错误

> ID：14755769
> 
> 赞同：0
> 
> 时间：2013-02-07T16:16:49.697
> 
> 标签：java

我正在尝试为我正在编写的一个小游戏使用随机数生成器。随机生成器位于主程序调用的外部类中。

我收到如下所示的语法错误，不知道为什么？任何帮助都会很棒！

代码：导入java.util.Random；

```
 public class RandomGenerator 
{
    Random generator = new Random(); // Error here is: Syntax error on token ";", { 
    for (int i = 0; i < 2; i++)          // expected after this token
    {
      int r = generator.nextInt(2);
    }
} // I also get an error here telling me to add an "}" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:19:14.640

如果没有方法或块，您不能将代码放入类中。读这个：

*   [http://docs.oracle.com/javase/tutorial/getStarted/application/index.html](http://docs.oracle.com/javase/tutorial/getStarted/application/index.html)
*   [http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)

另请注意，标准 Java 格式在行尾放置左大括号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:19:56.627

```
public class RandomGenerator 
{
    public static void main (String [] args)
    {
        Random generator = new Random ();
        for (int i = 0; i < 2; i++)
        {
            int r = generator.nextInt (2);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:22:10.667

这部分不应该：

```
 Random generator = new Random(); // Error here is: Syntax error on token ";", { 
for (int i = 0; i < 2; i++)             expected after this token
{
  int r = generator.nextInt(2);
} 
```

在一个函数中？像：

```
public static void init()
{
     Random generator = new Random(); 
     int r=0;
     for (int i = 0; i < 2; i++)             
     {
         r = generator.nextInt(2);
     }
} 
```

# c# - CodeBehind 中没有显示控件？

> ID：14755771
> 
> 赞同：3
> 
> 时间：2013-02-07T16:17:02.773
> 
> 标签：c#, asp.net

我有我的母版页：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="KezberProjectManager.master.cs" Inherits="KezberProjectManager.KezberProjectManager" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>

    <!-- Le styles -->
    <link href="assets/css/bootstrap.css" rel="stylesheet"/>
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet"/>
    <link href="assets/css/kezblu.styles.css" rel="stylesheet"/>

    <style type="text/css">

    </style>
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.0.min.js"></script>
    <script type="text/javascript" src="assets/js/kezcommon.js"></script>
    <script type="text/javascript">

        $(document).ready
    (
        function () {

            createAutoClosingAlert('.success_alert', 6000);
        }
    );

        function createAutoClosingAlert(selector, delay) {
            var alert = $(selector).alert();
            window.setTimeout(function () { $(alert).slideUp() }, delay);
        }

</script>  

    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
<asp:Repeater runat="server" id="MenuRepeater">
  <headertemplate>
       <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#">KezBlu</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
  </headertemplate>
  <itemtemplate>
     <%# Eval("Content") %>
  </itemtemplate>
  <footertemplate>
             </ul>

          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>
  </footertemplate>
 </asp:Repeater>

    <div id="wrap">
       <div id="content">
           <div id="alerts">
               <div class="bs-docs-example">
                        <div id="auth">
                 <asp:HyperLink id="HyperLink1" runat="server">HyperLink</asp:HyperLink>
             </br>
                 <asp:HyperLink id="HyperLink2" runat="server">HyperLink</asp:HyperLink>
             </div>
              <div runat="server"  id="success_alert" class="success_alert alert alert-success fade in">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                   <div runat="server" id="success_alert_text">
                </div>
              </div>
             </div>
              <div class="bs-docs-example">
              <div runat="server" id="error_alert" class="error_alert alert alert-error fade in">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                <div runat="server" id="error_alert_text">
                </div>
              </div>
             </div>
            </div>
       <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">

       </asp:ContentPlaceHolder>
       </div>

    </div>
    </form>
      <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
</body>
</html> 
```

在那里我有：

```
 <div id="auth">
         <asp:HyperLink id="HyperLink1" runat="server">HyperLink</asp:HyperLink>
     </br>
         <asp:HyperLink id="HyperLink2" runat="server">HyperLink</asp:HyperLink>
     </div> 
```

像这样，链接在后面的代码中显示得很好。

现在，如果我将它们移到中继器的页脚中：

...

```
 <div class="nav-collapse collapse">
            <ul class="nav">
  </headertemplate>
  <itemtemplate>
     <%# Eval("Content") %>
  </itemtemplate>
  <footertemplate>
             </ul>
             <div id="auth">
                 <asp:HyperLink id="HyperLink1" runat="server">HyperLink</asp:HyperLink>
             </br>
                 <asp:HyperLink id="HyperLink2" runat="server">HyperLink</asp:HyperLink>
             </div>

          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>
  </footertemplate>
 </asp:Repeater> 
```

然后它们不再可以在后面的代码中使用。

我真的真的不明白这一点。

为什么它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:29:56.490

`RepeaterItem`有不一样的 `NamingContainer`。您只能直接访问页面顶部的控件，因为这些控件是在部分代码隐藏类中自动创建的。你必须使用`FindControl`来获取一个控件的引用`RepeaterItem`。

在这种情况下，您可以使用`Repeater`'[`ItemDataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemdatabound.aspx)事件：

```
protected void Repater1_ItemDataBound(Object Sender, RepeaterItemEventArgs e)
{
    // This event is raised for the header, the footer, separators, and items.
    if (e.Item.ItemType == ListItemType.Footer)
    {
        HyperLink hl = (HyperLink)e.Item.FindControl("HyperLink1");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:20:45.183

因为控件不再位于主窗体上，它们不再是`Page`. 它们可以改为通过`Repeater`.

有关通过. [_](https://stackoverflow.com/questions/701412/how-to-find-controls-in-a-repeater-header-or-footer)`Repeater`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:21:55.537

当您将对象放入中继器、网格等时，您必须在后端进行更多处理才能找到它们。基本上，当中继器绑定时，您可以遍历并搜索对象，然后访问其属性。

例如，这里是一些代码的链接，用于在绑定项目时查找各种项目控件的中继器

```
protected void rptTaskListOnItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        if (e.Item.ItemType == ListItemType.AlternatingItem || e.Item.ItemType == ListItemType.Item)
        {
            var lnkEdit = e.Item.FindControl("lnkEdit") as HyperLink;
            var lnkDelete = e.Item.FindControl("lnkDelete") as LinkButton;

            var pnlAdminControls = e.Item.FindControl("pnlAdmin") as Panel;

            var t = (Task)e.Item.DataItem;

            if (IsEditable && lnkDelete != null && lnkEdit != null && pnlAdminControls != null)
            {
                pnlAdminControls.Visible = true;
                lnkDelete.CommandArgument = t.TaskId.ToString();
                lnkDelete.Enabled = lnkDelete.Visible = lnkEdit.Enabled = lnkEdit.Visible = true;

                lnkEdit.NavigateUrl = EditUrl(string.Empty, string.Empty, "Edit", "tid=" + t.TaskId);

                ClientAPI.AddButtonConfirm(lnkDelete, Localization.GetString("ConfirmDelete", LocalResourceFile));
            }
            else
            {
                pnlAdminControls.Visible = false;
            }
        }
    } 
```

就我个人而言，我从未尝试过访问转发器的页眉或页脚中的控件，但我相信它会是类似的

# c - 读取下一个节点的链表中的内存位置

> ID：14755774
> 
> 赞同：1
> 
> 时间：2013-02-07T16:17:12.600
> 
> 标签：c

我正在编写一个代码来读取链表中节点的地址，因此有人可以确认printf 中`%p`的`%u`格式是否正确。一个给我十六进制，另一个给我十进制，转换为十六进制或十进制是匹配的。如果有人可以简要介绍 和 的区别，那就太好`%p`了`%u`。

```
struct node {
    int x;
    struct node *next;
};

int main () {
    struct node *root;
    struct node *track;

    root = malloc(sizeof(struct node));
    printf ("Location of root is %p\n", root);
    printf ("Location of root is %u\n", root);
} 
```

执行输出：

```
[root@vm c_prog]# ./a.out
根的位置是 0xdc3010
根的位置是 14430224
[root@vm c_prog]# ./a.out
根的位置是 0x11fbf010
根的位置是 301723664
[root@vm c_prog]# ./a.out
根的位置是 0x7e8e010
根的位置是 132702224
[root@vm c_prog]#

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:20:39.580

不同之处在于 %u = unsigned int 和 %p = 指针...它们在您的系统/架构上的大小可能不同，不应互换使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:21:51.907

`%p`是指针，是正确的。严格来说，您应该转换为`void *`，但我从未遇到过关心的实现。例子：

```
printf ("Location of root is %p\n", (void *)root); 
```

`%u`is for an`unsigned int`并且是*不*正确的，除非您玩一些铸造体操并且确定指针和 an`int`大小相同。要安全地以十进制打印指针值，您应该使用`PRIuPTR`from `inttypes.h`：

```
printf ("Location of root is %"PRIuPTR"\n", (uintptr_t)root); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T16:23:29.760

是的，`%p`以实现认为合适的任何格式打印指针（通常是十六进制 - 这就是您现在看到的），并且 %u 打印一个无符号整数。如果您改用 %x，您可能会得到更相似的结果。但是，`%p`也了解指针的大小，在 64 位系统中，它与整数不同，它是`%u`或`%x`将打印的内容。

从技术上讲，`%p`也“仅”适用于 void 指针。

# ios - 释放 UIPageViewController 中未使用的页面

> ID：14755782
> 
> 赞同：9
> 
> 时间：2013-02-07T16:17:41.110
> 
> 标签：ios, xcode, memory-management, automatic-ref-counting, uipageviewcontroller

我为基于图画书的每个基于页面使用单独`.h`的`.m`, 和文件。每个页面都加载了动画、音乐等，大约需要 4MB 的内存。在 Instruments 中，随着每一页的加载，可用内存会下降约 4MB。当页面被翻页时，这个内存永远不会被释放。它最终会给出内存警告。 似乎将它实例化的每个页面都保留在内存中并且不会卸载它。因此，当页面快速翻动时，应用程序就会崩溃。`.xib``UIViewController``UIPageViewController``UIPageViewController`

我希望能够卸载除`UIPageViewController`前一页、当前页和下一页所需的 3 个以外的所有页面。我如何卸载不需要的页面，因为它们是由`UIPageViewController`.

下面是`UIPageViewController`从中提取的页面数组。所有页面（Page1、Page2 等）基本上只是加载图像文件、提供基本动画和音乐。

```
 //ARRAY OF PAGES    
pageArray = [[NSArray alloc] initWithObjects:
        (id)[[Page1 alloc] initWithNibName:nil bundle:nil],
            [[Page2 alloc] initWithNibName:nil bundle:nil],    
            [[Page3 alloc] initWithNibName:nil bundle:nil],    
            [[Page4 alloc] initWithNibName:nil bundle:nil],    
            [[Page5 alloc] initWithNibName:nil bundle:nil],    
            [[Page6 alloc] initWithNibName:nil bundle:nil], 
            [[Page7 alloc] initWithNibName:nil bundle:nil],
            [[Page8 alloc] initWithNibName:nil bundle:nil],
             // continues all the way up to page 47
             [[Page47 alloc] initWithNibName:nil bundle:nil],
             nil]; 
```

我省略了`UIPageViewController`. 它使用“ `nextPageNumber`”从`pageArray`上面拉出正确的页面来创建一个新的页面对象。

```
-(void)turnPageForward{

[pageController setViewControllers:[NSArray arrayWithObject:[pageArray objectAtIndex:nextPageNumber]]
                         direction:UIPageViewControllerNavigationDirectionForward
                          animated:YES completion:^(BOOL finished){
                          }]; 
```

}

我尝试创建一个对象“ `pageIndex`”（见下文），在将其提供给`pageController`. 它没有用。页面前进后，该页面仍会占用大量内存。

```
//PROGRAM PAGE FORWARD 
```

-(void)turnPageForward{

```
UIViewController * pageIndex =[pageArray objectAtIndex:nextPageNumber];  //nextPageNumber is the next page to load

[pageController setViewControllers:[NSArray arrayWithObject:pageIndex]
                         direction:UIPageViewControllerNavigationDirectionForward 
                          animated:YES completion:^(BOOL finished){
                          }];                                  
pageIndex = nil; 
```

}

我已经使用相同的向 提供页面的方式查看了 stackoverflow 的帖子`UIPageViewController`，但没有找到任何接近的东西。最接近的是“*在导航控制器中“返回”时 ARC 不释放内存”，*但没有以相同的方式设置视图控制器。

我试图将不需要的页面设置为 nil，以便 ARC 可以在没有运气的情况下删除它们。我应该尝试任何建议或替代路径吗？我喜欢卷页效果，但在其他地方找不到一个很好的水平卷页效果。

谢谢！埃里克

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-07T16:50:03.953

“UIPageViewController 似乎将它实例化的每个页面都保存在内存中”

不，您是通过实例化所有这些“页面”（控制器）并将它们放入数组中来做到这一点的（当您翻页时内存会跳转，因为控制器的视图在您显示它之前实际上并未加载，即使控制器已经实例化了。但是一旦你这样做了，你的控制器会保留它的视图，而数组会保留控制器）。你只需要对你所在的页面进行某种计数，并在 viewControllerBeforeViewController: 和 viewControllerAfterViewController: 的实现中，在那里实例化一个页面。当您离开该页面时，其控制器将被释放。如果加载缓慢，

我做了一个这样的简单测试应用程序：

```
@implementation ViewController {
    int count;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    count = 1;
    self.pager = [[UIPageViewController alloc]initWithTransitionStyle:UIPageViewControllerTransitionStylePageCurl navigationOrientation:UIPageViewControllerNavigationDirectionForward options:nil];
    self.pager.dataSource = self;
    self.pager.delegate = self;
    Page1 *first = [[Page1 alloc] initWithNibName:@"Page1" bundle:nil];
    [self.pager setViewControllers:@[first] direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:nil];
    [self addChildViewController:self.pager];
    [self.view addSubview:self.pager.view];
    [self.pager didMoveToParentViewController:self];
}

-(UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController {
    if (count > 1) {
        NSString *nibName = [@"Page" stringByAppendingFormat:@"%d",count-1];
        UIViewController *prev = [[NSClassFromString(nibName) alloc] initWithNibName:nibName bundle:nil];
        count -= 1;
        return prev;
    }
    return nil;
}

-(UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController {
    if (count < 3) {
        NSString *nibName = [@"Page" stringByAppendingFormat:@"%d",count+1];
        UIViewController *next = [[NSClassFromString(nibName) alloc] initWithNibName:nibName bundle:nil];
        count += 1;
        return next;
    }
    return nil;
} 
```

我的示例只有 3 页，但它说明了执行此操作的一种方法。我将日志放在 3 个控制器的 dealloc 方法中，当我离开它们时调用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-16T12:11:52.507

我知道这个问题有点老了，但也许我的方法可以帮助一些在不使用 ARC 时面临同样问题的人。

我认为释放未使用页面的最佳方法是在 UIPageViewController 的 didFinishAnimation 方法中。您在那里获得了 1 或 2 个以前的视图控制器，并且您可以轻松地释放它们。我这样做：

```
-(void)pageViewController:(UIPageViewController *)thePageViewController didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed {

    if(completed) {
        for (UIViewController *viewController in previousViewControllers) {
             [viewController release];
        }
     }
} 
```

重要的是，只有在操作完成时才释放它们，否则在下一次页面更改时，您将尝试访问已发布的页面。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-01T09:04:29.710

这次我遇到了这个问题。经过一个小时的思考，我找到了解决方案。

这是我的 .h 文件

```
#import <UIKit/UIKit.h>

@interface BKContentViewController : UIPageViewController

@end 
```

还有我的 .m 文件和 viewDidload 方法

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    self.delegate = self;
    self.dataSource = self;

    [self setViewControllers:[NSArray arrayWithObject:detailContent]
                   direction:UIPageViewControllerNavigationDirectionForward
                    animated:NO
                  completion:NULL];
} 
```

而最重要的。

```
#pragma mark - UIPageViewControllerDataSource UIPageViewControllerDelegate

- (void)pageViewController:(UIPageViewController *)pageViewController didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed{
    if (completed) {
        [self setViewControllers:[NSArray arrayWithObject:detailContent]
                       direction:UIPageViewControllerNavigationDirectionForward
                        animated:NO
                      completion:NULL];
    }

}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController
viewControllerAfterViewController:(UIViewController *)viewController{

    if (!detailRight) {
        detailRight = [[DetailContent alloc] init];
        [detailRight setShouldReturn:YES];
        [detailRight setPath:fPath withFileName:fName];
    }
    return detailRight;
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController
viewControllerBeforeViewController:(UIViewController *)viewController{

    if (!detailLeft) {
        detailLeft = [[DetailContent alloc] init];
        [detailLeft setShouldReturn:YES];
        [detailLeft setPath:fPath withFileName:fName];
    }

    return detailLeft;
}

- (UIPageViewControllerSpineLocation)pageViewController:(UIPageViewController *)pageViewController
spineLocationForInterfaceOrientation:(UIInterfaceOrientation)orientation{
    UIViewController *currentViewController = [self.viewControllers objectAtIndex:0];
    NSArray *viewControllers = [NSArray arrayWithObject:currentViewController];
    [self setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:NULL];

    self.doubleSided = NO;
    return UIPageViewControllerSpineLocationMin;
} 
```

在此之后，我只有三个 viewContrller 并且一次又一次滚动不会增加内存。希望这会帮助你。

# ruby-on-rails - Rails：身份验证时未定义的方法错误

> ID：14755786
> 
> 赞同：-2
> 
> 时间：2013-02-07T16:17:48.663
> 
> 标签：ruby-on-rails, ruby

我正在尝试在 RAILS 上创建一个身份验证系统`find_by_user_name_and_password()`

我有以下问题：

```
undefined method `find_by_user_name_and_password' for #<Class:0x007fae373d5698>
Rails.root: /ror/blog/Blog`

Application Trace | Framework Trace | Full Trace
app/controllers/sessions_controller.rb:7:in `create' 
```

这是我的 session_controller 代码

```
 class SessionsController < ApplicationController
    skip_before_filter :authorizes
  def new
  end

  def create
        user = User.find_by_user_name_and_password(params[:name], params[:password]) 
        if user
            session[:user_id] = user.id
            redirect_to admin_url
        else
            redirect_to login_url, alert: "Bad datas"
        end
  end

  def destroy
    session[:user_id] = nil
    rederect_to blog_url, notice: "End seans"
  end
end 
```

模型定义：

```
class User < ActiveRecord::Base
  attr_accessible :name, :password_digest, :password_confirmation
  validates :name, presence: true, uniqueness: true
    #validates_confirmation_of :password  
  has_secure_password
end 
```

迁移

```
class CreateUsers < ActiveRecord::Migration
  def change
    create_table :users do |t|
      t.string :name
      t.string :password_digest

      t.timestamps
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:25:39.463

查看您刚刚发布的模型，我发现您没有密码字段......所以没有`find_by_whatever_and_password`。

你需要使用

```
user = User.find_by_name(params[:user][:name])
if user && user.authenticate(params[:user][:password])
  # etc. 
```

# subdomain - Zend Framework 2 - 多个子域导致问题

> ID：14755788
> 
> 赞同：3
> 
> 时间：2013-02-07T16:17:53.460
> 
> 标签：subdomain, url-routing, zend-framework2

我正在 Zend Framework 2 中编写一个应用程序，它将从几个不同的子域运行，我希望每个子域都有一个不同的模块，以保持整洁。

我的问题是当我向路由添加超过 1 个子域时，它会丢失其中一个子域。

例如：此设置适用于 testbed.localhost (module/Application) a.testbed.localhost (module/A)

如果我添加一个额外的，它会将所有对 a 的请求路由到应用程序索引控制器

例如 testbed.localhost (module/Application), a.testbed.localhost (module/A), b.testbed.localhost (module/B)

这是 module/A 的 module.config.php

```
 'router' => array(
    'routes' => array(
        'ads' => array(
            'type'    => 'Hostname',
            'options' => array(
                 'route'    => 'a.testbed.localhost', 
                'constraints' => array(
                    'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                    'id'     => '[0-9]+',
                ),
                'defaults' => array(
                    '__NAMESPACE__' => 'A\Controller',
                    'controller' => 'A\Controller\A',
                    'action'     => 'index',
                ),
            ), 
```

这是 module/B 中 module.config.php 中的路由

```
 'router' => array(
    'routes' => array(
        'ads' => array(
            'type'    => 'Hostname',
            'options' => array(
                 'route'    => 'b.testbed.localhost', 
                'constraints' => array(
                    'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                    'id'     => '[0-9]+',
                ),
                'defaults' => array(
                    '__NAMESPACE__' => 'B\Controller',
                    'controller' => 'B\Controller\B',
                    'action'     => 'index',
                ),
            ), 
```

现在两个 module.config.php 文件中的命名空间都是正确的，我注意到如果我从 config/application.config.php 中删除对它的引用，子域 a.testbed.localhost 将起作用

```
 <?php
    return array(
        'modules' => array(
         'Application',
         'A',
         'B', <--- A doesn't work if B is here
      ), 
```

如果我在上面的模块数组中交换 A 和 B，那么 B 将被转发到应用程序模块并且 A 将工作。所以它似乎有超过 1 个子域的问题。有没有人有任何想法/遇到同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T14:50:08.153

发生这种情况是因为您的路线名称相同。我会尝试使用 a-ads 和 b-ads 作为路线名称，这应该可以解决您的情况。

最后，配置被合并在一起。所以它就像一个数组，当最后一个数组被合并时，它会覆盖它之前的任何东西。

# ssms - SQL Server Management Studio 2012 无法识别本地服务器

> ID：14755796
> 
> 赞同：0
> 
> 时间：2013-02-07T16:18:21.877
> 
> 标签：ssms, ssms-2012

我完全是 SSMS 的新手，但是我在网上找到的所有教程都掩盖了他们启动程序并连接到本地服务器（他们的计算机名称）的步骤。我在 Windows 8 上，并且 ISS 已安装并正常运行。我不确定我还能错过什么。这是一个屏幕截图：

![来自 sql server 管理工作室的屏幕截图](../Images/366d51e2392a6d47308f1aef17b2279f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:31:18.687

用作`localhost`服务器名称。`/instance_name`如果您正在使用实例，请附加。例如，如果使用 SQL Express，请使用`localhost/SQLExpress`.

# c# - C# DateTime 默认值问题 01/01/0001 00:00:00

> ID：14755802
> 
> 赞同：5
> 
> 时间：2013-02-07T16:18:37.963
> 
> 标签：c#, sql, visual-studio-2010, datetime

我在将 DateTime 插入数据库时​​遇到问题，出现以下错误：

```
SqlDateTime overflow. Must be between 1/1/1753 12:00:00 AM and 12/31/9999 11:59:59 PM. 
```

我知道 SQL 日期必须在 1/1/1753 12:00:00 AM 和 12/31/9999 之间，但是我的日期似乎仍然是 01/01/0001 00:00:00。

我在 Web 服务方法中定义了以下日期：

```
 [DataMember]
  public DateTime RecordTimeStamp { get; set; } 
```

这在以下代码中用于添加到数据库中

```
 sqlComm.Parameters.Add("@RecordTimeStamp", SqlDbType.DateTime).Value = pCustomer.RecordTimeStamp; 
```

此代码从带有代码的 aspx 页面获取其值

```
 DateTime now = DateTime.Now;
  pCustomer.RecordTimeStamp = now; 
```

我试图让它将当前日期插入数据库，但它似乎并没有改变默认值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-26T19:14:46.630

尝试更改属性

从：

> ```
> [DataMember]
> public DateTime RecordTimeStamp { get; set; } 
> ```

至：

> ```
> [DataMember]
> public DateTime? RecordTimeStamp { get; set; } 
> ```

希望这将解决问题。发生的情况是 DateTime 不是 NULL 数据类型，它强制在其中放置一个默认值 (01/01/0001) 以确保将提交非空日期。我不知道为什么它不接受更改的值并抛出“超出范围”异常。这是您可能需要进一步调查的内容。

# ios - 如何从 AppDelegate 更新一些 ViewController 的标签？

> ID：14755804
> 
> 赞同：0
> 
> 时间：2013-02-07T16:18:40.393
> 
> 标签：ios, objective-c, uiviewcontroller, appdelegate

我有几个视图控制器，每个控制器都有一个标签或一个按钮。我想从 AppDelegate 更改可见视图控制器按钮或标签的文本。我知道这是一种不好的做法，但是我在 AppDelegate 中运行了一个后台线程，该线程在服务器上为用户查找新图像，如果有，它必须更新当前显示视图导航栏标签中的新图像计数器.

我的想法是在 AppDelegate.m 中使用下一个代码：`(ControllerWhichLabelIWantToChange*) self.navigationControllerClass.visibleviewcontroller. ...`但是在这里我看不到我在 ControllerWhichLabelIWantToChange 中为其定义属性的标签或按钮。

那么问题是如何从 AppDelegate 访问不同视图控制器的元素并更改它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T16:45:28.140

一个可能对您更好的建议是使用[NSNotificationCenter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html)发送有关各种更改的通知。任何希望刷新自己的视图都可以响应此类通知。这是一种常见的做法。例如，您正在后台处理主题数据，并且您有 20 个需要主题化的实时视图，您可以在后台处理完成后发布通知，并且所有正在观察通知的视图都会收到通知，他们可以更新自己。

# java - Java SVNKit 版本异常

> ID：14755814
> 
> 赞同：0
> 
> 时间：2013-02-07T16:19:17.793
> 
> 标签：java, svn, svnkit

我有一个小型 java 应用程序，它通过 SVNKit 与 svn 一起工作。但是当我尝试使用我的本地副本时，它会抛出这个异常：

```
Exception in thread "main" org.tmatesoft.svn.core.SVNException: svn: The path 'D:\mainWorkspace\wowaProj' appears to be part of a Subversion 1.7 or greater
working copy.  Please upgrade your Subversion client to use this
working copy. 
```

我有 SVN 版本 1.7.8，已经重新安装过一次，但仍然出现相同的错误。有什么想法吗，伙计们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:24:26.920

SVNKit 是一个独立的 Subversion 库实现。您需要升级它（不是重新安装您的 svn 客户端，而是 SVNKit 本身）以匹配可能已触及工作副本的其他 svn 客户端。

# javascript - JavaScript：按 ID 设置嵌套对象值

> ID：14755823
> 
> 赞同：3
> 
> 时间：2013-02-07T16:19:35.690
> 
> 标签：javascript, object, collections, nested, set

我想知道在 JavaScript 中更新多级对象集合成员的最佳方法是什么

这是我收藏的简化版：

```
this.Steps = [

{ id: 1, text: "test", childSteps: 
  [
    { id: 2, text: "test"},
    { id: 3, text: "test"},
    { id: 4, text: "test", childSteps: 
    [
           { id: 10, text: "test"},
           { id: 11, text: "test"}
    ]}
    },
    { id: 5, text: "test"},
    { id: 6, text: "test"},
    { id: 7, text: "test"},    
    { id: 8, text: "test"},
    { id: 9, text: "test"}
  ]
}
]; 
```

理想的情况是有一个函数被称为：

```
updateObjectByID(11, 'string to be set'); 
```

当我们只有 1 级对象时，这很容易做到。但是当在多级集合上使用递归时，它变得更加困难。

我目前正在使用一个解析整个集合并构建字符串的函数，例如：

```
this.Steps[0].childSteps[3].childSteps[1].text == "string to be set" 
```

然后我`eval()`在那根弦上做。

我确信可能有一个更清洁的解决方案。

使用 eval 使我的班级无法压缩 btw。

任何帮助将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:41:46.500

您可以通过 id 构建对象映射以进行直接访问：

```
var map = {};
(function recurse(steps) {
    for (var i=0; i<steps.length; i++) {
        var step = steps[i];
        map[ step.id ] = step;
        if ("childSteps" in step)
            recurse(step.childSteps);
    }
})(this.Steps);

function updateObjectByID(id, string) {
    map[id].text = string;
} 
```

* * *

对您的代码的评论：您过度复杂了很多。当条件`if(obj.id == objId)`满足时，你已经有你的`obj`参考了！！！现在绝对不需要搜索它的路径，从中构建一个字符串，然后评估它。只需直接分配给它的属性！

```
function(steps, objId, value, whatParam, command) {
    if (typeof whatParam == 'undefined')
        whatParam = 'selected';
    $.each(steps, function(index, obj){
        if(obj.id == objId) {
            // removed a lot of unecessary stuff

            // not sure, looks like "value" was evaled sometimes as well
            obj[whatParam] = value;

         } // insert an "else" here if ids are unique
         if (typeof obj.childSteps != 'undefined') {           
             this.setupObjectState(obj.childSteps, objId, value, whatParam, command);
         }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:54:56.283

```
function updateObjectByID(id, text) {
    (function setText(steps) {
        for(var i = 0; i < steps.length; i++){
            var step = steps[i];
            if(step.id === id){
                step.text = text;
            }
            if ("childSteps" in step){
                setText(step.childSteps);
            }
        }
    })(this.Steps);
} 
```

这是演示。[http://jsfiddle.net/qDWX8/](http://jsfiddle.net/qDWX8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:43:08.973

由于您`updateObjectById()`使用 ID 调用，因此 ID 必须是唯一的。那你为什么不改变你的结构呢：

```
this.Steps = [
    { id: 1, text: "test" },
    { id: 2, parent: 1, text: "test" },
    { id: 3, parent: 1, text: "test" },
    { id: 4, parent: 1, text: "test" },
    { id: 10, parent: 4, text: "test" },
    { id: 11, parent: 4, text: "test" },
    { id: 5, parent: 1, text: "test"},
    { id: 6, parent: 1, text: "test"},
    { id: 7, parent: 1, text: "test"},    
    { id: 8, parent: 1, text: "test"},
    { id: 9, parent: 1, text: "test"}
] 
```

这样您就可以轻松地更新您的条目，如下所示：

```
function updateObjectByID(id, text) {
    for(var i = 0; i < this.Steps.length; i++) {
        if(this.Steps[i].id === id) {
            this.Steps[i].text = text;
            break;
        }
    }
} 
```

使用额外的属性`parent`，您仍然可以轻松获取元素的所有子元素，如下所示：

```
function getChildrenByID(id) {
    var array = [];
    for(var i = 0; i < this.Steps.length; i++) {
        if(this.Steps[i].parent === id) {
            array.push(this.Steps[i]);
        }
    }
    return array;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:43:35.257

您必须递归地向下搜索具有目标“id”的对象并替换其文本的树结构。例如：

```
function updateObjectByID(obj, id, text) {
  if (!obj) return;
  if (obj.id === id) {
    obj.text = text;
  } else if ((typeof(obj)==='object') && (obj.constructor===Array)) {
    for (var i=0; i<obj.length; i++) {
      updateObjectByID(obj[i], id, text);
    }
  } else if (obj.childSteps) {
    updateObjectByID(obj.childSteps, id, text);
  }
}

updateObjectByID(this.Steps, 11, 'String to be set'); 
```

但是，可以通过树修剪来优化此解决方案。

# node.js - node.js 使用 SSL 托管？

> ID：14755831
> 
> 赞同：3
> 
> 时间：2013-02-07T16:19:54.787
> 
> 标签：node.js, cloud-hosting

所以说我有一个 node.js 应用程序，它同时托管 HTTP 和 HTTPS 服务器，如问题中所述：[如何在 Express.js 中强制 SSL / https](https://stackoverflow.com/questions/8605720/how-to-force-ssl-https-in-express-js)

在我的代码中，我有以下内容：

```
// General configuration settings for production usage
app.configure(function () {
  app.set('port', process.env.PORT || 3000);
  app.set('sslport', process.env.SSLPORT || 4000);
  ...
}

http.createServer(app).listen(app.get('port'), function () {
  winston.info('Express server listening on port ' + app.get('port'));
});

var options = {
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem')
};

https.createServer(options, app).listen(app.get('sslport'), function () {
  winston.info('Express server listening on port ' + app.get('sslport'));
}); 
```

这对于本地运行的节点服务器非常有效。

但是，我想将我的网站发布到云托管提供商，如 Azure 网站、Heroku、Nodejitsu 等。

所有的云主机似乎都设置了一个`process.env.PORT`值，但只有一个。创建我的 HTTPS 服务器时，这通常会导致应用程序崩溃，因为 PORT 已在使用/拒绝访问等。

那么如何创建/托管一个具有安全登录页面且只有一个端口可供使用的站点！？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T20:57:54.657

如果您使用 Heroku，则无需在 nodejs 中指定端口即可获得 SSL。您需要做的就是监听 http 请求的 heroku PORT 环境变量。上传到 heroku 后，您可以使用 https（在 443 上）或 http（在端口 80 上）寻址您的 heroku 应用程序。Heroku 路由到您的服务器。

同样，如果使用 EC2 的弹性负载平衡，您可以在负载平衡器上使用 SSL 终止，并再次使用 http 路由到侦听端口 80 的节点服务器。[http://aws.amazon.com/elasticloadbalancing](http://aws.amazon.com/elasticloadbalancing)

在这两种情况下，您都可以根据需要使用自签名或适当的 SSL 证书。

# ruby-on-rails - 在事务中提交单个更新

> ID：14755834
> 
> 赞同：1
> 
> 时间：2013-02-07T16:20:16.453
> 
> 标签：ruby-on-rails, transactions, commit

我需要帮助...

这是一种 Rails 3.0.15 伪代码来解释我的问题：

```
progress_bar = ProgressBar.create

record = Record.new
10000.times.do
  record.bodies.build
  progress_bar.inc
end
record.save 
```

该代码创建了 10000 个记录体，但它们被包装在一个事务中，因此它们被立即提交，这很好。

ProgressBar.create a record in a table，inc应该增加一个counter，所以js进度条可以从table中读取当前count并更新进度，但是由inc触发的ProgressBar更新被困在Record事务里面，并承诺 10000 条记录......没用！

关于如何在事务中强制更新而不提交整个事务的任何想法？

或者我可以使用哪种替代存储来保存进度条当前位置？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:13:15.950

Realtional 数据库通常不能在事务中进行写入，因此您的选择是以某种方式发送消息，以便另一个数据库连接将处理进度条，或者（这更容易更好，imo）将您的进度条数据存储在Redis 或 Memcached 之类的其他东西；它们专为此用途而设计。

# javascript - 活动时更改页内锚链接背景图像

> ID：14755835
> 
> 赞同：0
> 
> 时间：2013-02-07T16:20:18.203
> 
> 标签：javascript, css, anchor

我正在使用页内链接锚点来平滑向下滚动我的页面。一切正常，每个链接都悬停在适当的图像上。但是，我希望活动部分有不同的图像来向用户显示他们在哪里。我似乎无法让它与任何东西一起使用。

这是我的 HTML

```
<div id="scrollnav">
<ul>
    <li class="scrolldot"><span><a href="#one">1</a></span></li>
    <li class="scrolldot"><span><a href="#two">2</a></span></li>
    <li class="scrolldot"><span><a href="#three">3</a></span></li>
    <li class="scrolldot"><span><a href="#four">4</a></span></li>
    <li class="scrolldot"><span><a href="#five">5</a></span></li>
    <li class="scrolldot"><span><a href="#six">6</a></span></li>
</ul>
</div> 
```

这是我的 CSS

```
#scrollnav { width: 75px; height: 150px; position: fixed; right: 0; top: 100px; z-index: 999999;}
#scrollnav ul li { height: 16px; width: 16px; padding: 0px 0px 7px 0px; }
span { text-indent: -99999px; }
.scrolldot a { display: block; height: 16px; width: 16px; background-image: url(../images/dots.png); background-repeat: no-repeat; background-position: -16px 0; }
.scrolldot a:hover { background-image: url(../images/dots.png); background-repeat: no-repeat; background-position: 0 0; }
.selected { background-color: red; } 
```

这是我将滚动到并希望处于活动状态的部分的示例。

```
<section id="one">
<div id="mainimagewrapper">
    <div class="image1">
        <div class="image2">
            <div class="970content">
                <div id="textdiv">
                    <h1>This is headline.</h1>
                    <p>This would be a description if someone wanted to write stuff here. This would be a description if someone wanted to write stuff here. This would be a description if someone wanted to write stuff here.</p>
                </div>                  
            </div>
        </div>
    </div>
</div>
</section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:29:29.343

/* ORDER 定义锚伪类 */

```
a, a:link, a:visited { ... css ...}
a:hover, a:visited:hover {... css ...}
a:active,a.my-active {... css ...}
a:focus {... css ...} 
```

通过这种方式，您可以为锚点上的浏览器默认操作定义样式。

之后，您可能需要使用 javascript 触发一些行为（以防浏览器由于超链接中的#hash 而导致行为异常）。

如果您“重新加载”页面，使用 jQuery 操作添加一些风味，例如**.my-active**切换 onClick 将无济于事。您必须从超链接中推断出#hash，然后将其用于您的样式。

只需使用 jQuery [hashchange](http://archive.plugins.jquery.com/project/hashchange)从超链接获取#hash，然后在范围内的元素上触发一个类。

否则，**如果您只需要一个插件来滚动到**打开页面中的某个位置：http: [//demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/) 或研究[jquery-joyride-feature-tour-plugin](http://www.zurb.com/playground/jquery-joyride-feature-tour-plugin)。

继续

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:29:35.573

我认为最简单的方法是查看 Twitter Bootstrap 的“Scrollspy”插件，而无需编写自己的 jQuery 脚本。我相信它只需很少的配置即可提供您正在寻找的效果。

链接：http: [//twitter.github.com/bootstrap/javascript.html#scrollspy](http://twitter.github.com/bootstrap/javascript.html#scrollspy)

# facebook-apps - 应用程序未出现在“应用程序”中

> ID：14755836
> 
> 赞同：0
> 
> 时间：2013-02-07T16:20:17.633
> 
> 标签：facebook-apps

我需要更新一个应用程序。但是，我在“开发人员”的“应用程序”列表中没有看到它。

该应用程序的选项卡出现在业务页面上，并且似乎处于活动状态：

[https://www.facebook.com/zapzyt/app_205014796286415](https://www.facebook.com/zapzyt/app_205014796286415)

这个应用程序已经运行了足够长的时间，任何以前的更改都可以“传播”（最后一次更新大约是一个月前）。

有什么我忽略的吗？我也是 FB 应用程序开发的新手，所以这可能很简单。

# iphone - CGContextClearRect 带圆圈

> ID：14755840
> 
> 赞同：3
> 
> 时间：2013-02-07T16:20:25.903
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我正在创建一个应用程序，我试图在其中清除`rect`. `UIImageView`我已经用 实现了这一点`CGContextClearRect`，但问题是它`rect`以方形清除，我想以圆形实现这种效果。

到目前为止我已经尝试过：

```
UITouch *touch2 = [touches anyObject];
CGPoint point = [touch2 locationInView:img];

UIGraphicsBeginImageContextWithOptions(img.bounds.size, NO, 0.0f);
[img.image drawInRect:CGRectMake(0, 0, img.frame.size.width, img.frame.size.height) blendMode:kCGBlendModeNormal alpha:1.0];
CGContextRef context = UIGraphicsGetCurrentContext();

CGRect cirleRect = CGRectMake(point.x, point.y, 40, 40);
CGContextAddArc(context, 50, 50, 50, 0.0, 2*M_PI, 0);
CGContextClip(context);
CGContextClearRect(context,cirleRect);
//CGContextClearRect(context, CGRectMake(point.x, point.y, 30, 30));
img.image =UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T09:51:46.080

我不确定你在做什么，但你的剪裁弧没有正确创建。您在固定位置创建它，这就是它实际上不起作用的原因 - 除非它起作用，如果您单击左上角。

如果你想看到它工作，试试这个：

```
- (IBAction)clearCircle:(UITapGestureRecognizer *)sender {
    UIImageView *imageView = self.imageView;
    UIImage *currentImage = imageView.image;
    CGSize imageViewSize = imageView.bounds.size;

    CGFloat rectWidth = 40.0f;
    CGFloat rectHeight = 40.0f;

    CGPoint touchPoint = [sender locationInView:imageView];

    UIGraphicsBeginImageContextWithOptions(imageViewSize, YES, 0.0f);
    CGContextRef ctx = UIGraphicsGetCurrentContext();

    [currentImage drawAtPoint:CGPointZero];

    CGRect clippingEllipseRect = CGRectMake(touchPoint.x - rectWidth / 2, touchPoint.y - rectHeight / 2, rectWidth, rectHeight);
    CGContextAddEllipseInRect(ctx, clippingEllipseRect);

    CGContextClip(ctx);

    CGContextClearRect(ctx, clippingEllipseRect);

    imageView.image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

} 
```

这会在以触摸点为中心的 40 x 40 矩形中创建一个剪切椭圆（在本例中为圆形）。

[您可以在Bitbucket](https://bitbucket.org/abizern/dotimage)上的示例项目中看到这一点，您可以[下载自己](https://bitbucket.org/abizern/dotimage/get/master.zip)尝试

# javascript - 无法让javascript间隔工作

> ID：14755841
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:20:26.783
> 
> 标签：javascript, onclick

所以我对javascript有点陌生，但我试图通过点击一个按钮来制作一个带有其他功能的进度条。我想在 javascript 中使用设置的时间间隔来计时栏，这是我到目前为止的 js：

```
//Javascript Document

function progress(){
 Var uno = setTimeout("uno()", 3000);
  uno(){
   document.getElementById("title").innerHTML = "Connecting...";
   document.getElementById("progressInner").style.display = 'block';
   document.getElementById("progressInner").style.width = '20px';
  }   
} 
```

从我收集到的内容来看，这是它的工作原理，但是我对此表示怀疑，因为似乎我正在设置一个变量`uno`但没有对它做任何事情....从我在 php 中的背景来看，这不是它的工作原理：p 任何指针你们可以给我这个吗？我的 html 在这里：http: [//jsbin.com/apoboh/1/edit](http://jsbin.com/apoboh/1/edit)

现在，它什么也不做，它给了我：Uncaught ReferenceError: progress is not defined

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:22:40.330

首先，您使用的是`setTimeout`not `setInterval`。前者触发一次回调，后者以设定的时间间隔无限期地触发。

其次，这些方法返回一个可用于取消 setInterval 的标记，请改为执行此操作

```
function startProgress(){
     // only start progress if it isn't running
     if (!App.progressToken) {  // App is you apps namespace
         App.progressToken = setInterval(function(){
             document.getElementById("title").innerHTML = "Connecting...";
             document.getElementById("progressInner").style.display = 'block';
             document.getElementById("progressInner").style.width = '20px';
         }, 3000);         
    }
} 
```

稍后，当您想停止时：

```
function stopProgress(){
   clearInterval(App.progressToken);`
   delete App.progressToken
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:22:24.383

该变量`uno`只是保存您刚刚设置的超时的句柄。如果您需要通过调用[`clearTimeout()`](https://developer.mozilla.org/en-US/docs/DOM/window.clearTimeout).

如果您不需要清除超时，那么根本没有理由存储句柄。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:22:37.660

```
function progress(){
  function uno(){
   document.getElementById("title").innerHTML = "Connecting...";
   document.getElementById("progressInner").style.display = 'block';
   document.getElementById("progressInner").style.width = '20px';
  } 
 var timeoutFunc = setTimeout(uno, 3000);  
} 
```

您将一个函数传递给 setTimeout，它将稍后调用，而不是一个字符串。所以这段代码将定义一个函数 uno，然后将它传递给 setTimeout 并延迟 3 秒，然后每 3 秒调用一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:24:30.420

你忘了在 uno() 之前加上“函数”这个词

# ruby-on-rails - 使用 God monitor unicorn for rails 但权限错误

> ID：14755850
> 
> 赞同：0
> 
> 时间：2013-02-07T16:20:52.187
> 
> 标签：ruby-on-rails, permissions, unicorn, god

我是新手`God`。我正在尝试使用`God`来监视`unicorn`我的 rails 应用程序运行的进程。

这是我的上帝文件：

```
rails_env = ENV["RAILS_ENV"]
APP_ROOT = '/home/deployer/deploy/myproject'
RAILS_ROOT = "#{APP_ROOT}/current"

God.watch do |w|
  w.name = "myproject"
  w.interval = 30.seconds
  w.dir = RAILS_ROOT

  w.start = "cd #{RAILS_ROOT} && bundle exec unicorn_rails -E #{rails_env} -c #{RAILS_ROOT}/config/unicorn.rb -D"
  w.stop = "kill -s QUIT `cat #{RAILS_ROOT}/tmp/pids/unicorn.pid`"
  w.restart = "kill -s USR2 `cat #{RAILS_ROOT}/tmp/pids/unicorn.pid`"

  w.start_grace = 20.seconds
  w.restart_grace = 20.seconds
  w.pid_file = "#{RAILS_ROOT}/tmp/pids/unicorn.pid"
  w.log = "#{RAILS_ROOT}/log/unicorn.god.log"

  w.uid = 'deployer'
  w.gid = 'staff'

  w.behavior(:clean_pid_file)

  w.start_if do |start|
    start.condition(:process_running) do |c|
      c.interval = 5.seconds
      c.running = false
    end
  end

  w.restart_if do |restart|
    restart.condition(:memory_usage) do |c|
      c.above = 300.megabytes
      c.times = [3, 5] # 3 out of 5 intervals
    end

    restart.condition(:cpu_usage) do |c|
      c.above = 50.percent
      c.times = 5
end 
```

结束结束

但是当我试运行以测试配置文件是否有效时`god -c config/unicorn.god -D`，我收到以下错误：

```
$ god -c config/unicorn.god -D
I [2013-02-07 23:51:23]  INFO: Loading config/unicorn.god
I [2013-02-07 23:51:23]  INFO: Syslog enabled.
I [2013-02-07 23:51:23]  INFO: Using pid file directory: /home/deployer/.god/pids
E [2013-02-07 23:51:23] ERROR: PID file directory '/home/deployer/deploy/myproject/current/tmp/pids' is not writable by deployer
E [2013-02-07 23:51:23] ERROR: Log directory '/home/deployer/deploy/myproject/current/log' is not writable by deployer
E [2013-02-07 23:51:23] ERROR: Task 'myproject' is not valid (see above) 
```

但实际上我有权使用 user 访问这两个目录`deployer`：

```
~/deploy/myproject/current$ ls -l
lrwxrwxrwx 1 deployer staff   42 Feb  7 23:24 log -> /home/deployer/deploy/myproject/shared/log

~/deploy/myproject/current/tmp$ ls -l
lrwxrwxrwx 1 deployer staff   43 Feb  7 23:24 pids -> /home/deployer/deploy/myproject/shared/pids 
```

并且上帝进程也在运行`deployer`：

```
$ ps -ef | grep god
deployer   381     1  5 00:20 pts/0    00:00:00 /usr/local/rvm/gems/ruby-1.9.3-p327-falcon@global/bin/god 
```

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-05T04:43:42.610

我有一个类似的问题。当我移除这`w.gid`条线时，一切都开始正常了。

# python - SymPy - 对不定积分应用限制

> ID：14755864
> 
> 赞同：5
> 
> 时间：2013-02-07T16:21:29.427
> 
> 标签：python, sympy, integral

在 SymPy 中，是否可以对不定积分应用限制并对其进行评估？

```
import sympy
from sympy.abc import theta

y = sympy.sin(theta)

Y_indef = sympy.Integral(y)
Y_def = sympy.Integral(y, (theta, 0, sympy.pi / 2)) 
```

`Y_def.evalf()`产生一个数字。

我正在寻找类似`Y_indef.evalf((theta, 0, sympy.pi/2))`得到相同答案的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T22:33:50.610

我不知道直接的方法，但是您可以从中提取信息`Y_indef`以创建定积分：

```
>>> indef = Integral(x)
>>> to_be_integrated, (free_var,) = indef.args
>>> definite = Integral(to_be_integrated, (free_var, 1, 2)) 
```

`.args`是一个通用属性，包含构造大多数 SymPy 对象所需的任何内容。

编辑：解决对问题的评论。

1.  SymPy 可能会成功评估定积分，但同时无法解决它们的不定版本。这是由于存在要应用于定积分的附加算法。

2.  定积分和不定积分都是同一类的实例。唯一的区别是它们包含在`.args`. `Integral`鉴于 SymPy 主要用作表示它无法求解积分的标志（即当所有已实现的算法都失败时`integrate`函数返回），因此尚未感觉到对不同类的需求。`Integral`

# android - 突出显示预选的微调器项目

> ID：14755869
> 
> 赞同：4
> 
> 时间：2013-02-07T16:21:49.347
> 
> 标签：android, spinner

假设我在微调器列表中有 10 个项目。并且项目编号 3 已被选中。现在的问题是，当用户想要更改他的选择时，我想给出某种指示，表明 this(item number 3) 已经是选中的项目。我想通过复选标记或设置某种背景或类似方式来实现这一点。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-12T05:16:47.833

我为此功能使用自定义适配器。只需扩展它`BaseAdapter`并扩展您的视图`Spinner`和`Droppdown`控制。

```
List<String> stagesValues = new ArrayList<>(stagesResults.values());
mStageSpn.setAdapter(new DropdownAdapter(mContext, stagesValues, mStageSpn));

public class DropdownAdapter extends BaseAdapter {

    private final LayoutInflater mInflater;
    private List<String> mData;
    private Spinner mStageSpn;

    public DropdownAdapter(Context context, List<String> data, Spinner stageSpn) {
        mInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        mData = data;
        mStageSpn = stageSpn;
    }

    @Override
    public int getCount() {
        return mData.size();
    }

    @Override
    public Object getItem(int arg0) {
        return null;
    }

    @Override
    public long getItemId(int position) {
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View view = mInflater.inflate(android.R.layout.simple_spinner_item, null);
        ((TextView) view.findViewById(android.R.id.text1)).setText(mData.get(mStageSpn.getSelectedItemPosition()));

        return view;
    }

    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) {
        View view = mInflater.inflate(R.layout.spinner_item, null);
        if (mStageSpn.getSelectedItemPosition() == position)
            view.setBackgroundColor(Color.RED);
        ((TextView) view.findViewById(R.id.text_id)).setText(mData.get(position));

        return view;
    }

} 
```

# android - 在没有 Facebook 应用程序的 Android 手机上登录 Facebook

> ID：14755875
> 
> 赞同：1
> 
> 时间：2013-02-07T16:21:52.633
> 
> 标签：android, facebook, facebook-android-sdk

我正在通过我的应用程序在 facebook 上分享。

一开始一切都很好（使用调试哈希键），直到我将“发布哈希键”放在 facebook 开发人员的应用程序设置中。现在发生的问题是没有 Facebook 应用程序的用户被重定向到从 fb-sdk WebView '登录'，但它没有给用户登录的机会 - > 它显示'你不是登录查看'

# .net - 列表框未选择所选项目

> ID：14755878
> 
> 赞同：3
> 
> 时间：2013-02-07T16:22:02.293
> 
> 标签：.net, wpf, listbox

请参阅下面的代码
Visual Studio 2010
ListBox 上方有一个 TextBox。
通过绑定文本框可以在选择项目时变大或变小。
这会导致 ListBox 移动。
当 ListBox 移动所选项目时，不是被单击的项目。
所选项目是移动的 ListBox 上鼠标下的项目。
有时它甚至根本不会选择（尝试从 9 到 10 或从 10 到 9）。
在此代码中重现问题的偶数和奇数产生不同的长度。
因此，如果您从奇数到奇数或偶数到偶数，则没有问题。
如果您从顶部的奇数到底部的偶数（不滚动），那么有时会选择一个不在视图中的项目。
在实际代码中，TextBox 是对项目的描述，并且描述的长度不同。
有趣的是在调试中，在 get { return boundText; 上有一个断点；} 然后它确实选择了正确的项目。
我认为它会处理选择，然后测量 UI，然后在新 UI 上再次处理选择。
由于它在调试中的行为不同，因此很难弄清楚。

```
<Window x:Class="ListBoxMissClick.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBox Grid.Row="0" Grid.Column="0" Text="{Binding Path=BoundText}" TextWrapping="Wrap" />
        <ListBox Grid.Row="1" Grid.Column="0" ItemsSource="{Binding Path=BoundList}" SelectedItem="{Binding Path=BoundListSelected, Mode=TwoWay}"/>
    </Grid>
</Window>

using System.ComponentModel;

namespace ListBoxMissClick
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window, INotifyPropertyChanged
    {
        private string boundListSelected;
        private string boundText = string.Empty;
        private List<string> boundList = new List<string>();
        private bool shortLong = true;
        public event PropertyChangedEventHandler PropertyChanged;

        protected void NotifyPropertyChanged(String info)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(info));
            }
        }

        public MainWindow()
        {
            for (int i = 0; i < 1000; i++)
            {
                boundList.Add(i.ToString());
            }

            InitializeComponent();

        }
        public string BoundText 
        { 
            get { return boundText; }
            set 
            { 
                if (boundText != value)
                {
                    boundText = value;
                    NotifyPropertyChanged("BoundText");
                }
            }
        }
        public List<string> BoundList { get { return boundList; } }
        public string BoundListSelected
        {
            get { return boundListSelected; }
            set
            {
                boundListSelected = value;
                if (Int32.Parse(value) % 2 == 0)
                {
                    BoundText = value.ToString() + " something very long something very long something very long something very long something very long something very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very long";
                }
                else
                {
                    BoundText = value.ToString() + " something short "; 
                }
             }
        }

        private void ListBox_MouseDoubleClick(object sender, MouseButtonEventArgs e)
        {
            BoundText = " something very long something very long something very long something very long something very long something very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very long";
        }
    }
} 
```

除了接受的答案 Mouse.Capture 和 ReleaseMouseCapture 工作。

```
set
{
    Mouse.Capture(this);
    {
        boundListSelected = value;
        if (Int32.Parse(value) % 2 == 0)
        {
            BoundText = value.ToString() + " something very long something very long something very long something very long something very long something very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very long";
        }
        else
        {
            BoundText = value.ToString() + " something short ";
        }
    }
    ReleaseMouseCapture();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T18:58:05.380

我已经稍微改写了你的代码。诀窍是使用 MouseCapture 来避免处理多个事件（使用您的原始代码，由于在按下鼠标按钮时布局发生了变化，因此 listBox 一次单击最多可以选择三个）

这是代码：

**主窗口.xaml**

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="TextEditor.MainWindow"
        Title="MainWindow" Height="350" Width="525">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <TextBox Grid.Row="0" Text="{Binding Path=BoundText}" TextWrapping="Wrap" />
        <ListBox Grid.Row="1" 
                 ItemsSource="{Binding Path=BoundList}" 
                 SelectedItem="{Binding Path=BoundListSelected, Mode=TwoWay}"/>
    </Grid>

</Window> 
```

**主窗口.xaml.cs**

```
using System;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Input;

namespace TextEditor
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public string BoundText
        {
            get { return (string)GetValue(BoundTextProperty); }
            set { SetValue(BoundTextProperty, value); }
        }

        // Using a DependencyProperty as the backing store for BoundText.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty BoundTextProperty =
            DependencyProperty.Register("BoundText", typeof(string), typeof(MainWindow), new PropertyMetadata(string.Empty));

        public string BoundListSelected
        {
            get { return (string)GetValue(BoundListSelectedProperty); }
            set { SetValue(BoundListSelectedProperty, value); }
        }

        // Using a DependencyProperty as the backing store for BoundListSelected.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty BoundListSelectedProperty =
            DependencyProperty.Register("BoundListSelected", typeof(string), typeof(MainWindow), new PropertyMetadata(string.Empty, OnBoundListSelectedChanged));

        private static void OnBoundListSelectedChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var mainWindow = d as MainWindow;
            var value = e.NewValue as string;

            Mouse.Capture(mainWindow);

            if (Int32.Parse(value) % 2 == 0)
            {
                mainWindow.BoundText = value.ToString() + " something very long something very long something very long something very long something very long something very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very long";
            }
            else
            {
                mainWindow.BoundText = value.ToString() + " something short ";
            }

            mainWindow.ReleaseMouseCapture();
        }

        public MainWindow()
        {
            for (int i = 0; i < 1000; i++)
            {
                boundList.Add(i.ToString());
            }

            InitializeComponent();
            DataContext = this;
        }

        public List<string> BoundList { get { return boundList; } }
        private List<string> boundList = new List<string>();
    }
} 
```

**编辑：**我实际上改变了 MainWindow 的编码方式（没有必要在 DependencyObject 上实现 INotifyPropertyChanged，所以我只是删除了它并设置了两个依赖属性）但是您可以尝试通过在设置之前简单地捕获鼠标来解决您的原始代码问题BoundText，然后释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T17:31:28.227

您可以添加setter`Thread.Sleep`来`BoundListSelected`解决您的问题，但我认为更好的解决方案是在这种情况下使用网格列。当您使用列时，您不需要使用`Thread.Sleep`.

```
public string BoundListSelected
{
    get { return boundListSelected; }
    set
    {
        Thread.Sleep(TimeSpan.FromSeconds(.2));
        boundListSelected = value;
        if (Int32.Parse(value) % 2 == 0)
        {
            BoundText = value.ToString() + " something very long something very long something very long something very long something very long something very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very longsomething very long something very long something very long something very long something very long";
        }
        else
        {
            BoundText = value.ToString() + " something short ";
        }
    }
} 
```

如果您不想使用`Thread.Sleep`，可以使用带有列的网格：

```
<Grid>
    <Grid.ColumnDefinitions>            
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <TextBox Grid.Column="0" Text="{Binding Path=BoundText}" TextWrapping="Wrap" />
    <ListBox Grid.Column="1" ItemsSource="{Binding Path=BoundList}" SelectedItem="{Binding Path=BoundListSelected, Mode=TwoWay}"/>
</Grid> 
```

# python - 在 Python 中编译正则表达式

> ID：14755882
> 
> 赞同：4
> 
> 时间：2013-02-07T16:22:13.940
> 
> 标签：python, regex, compilation

我正在研究 Doug Hellman 的“Python 标准库示例”并遇到了这个问题：

“1.3.2 编译表达式 re 包括用于将正则表达式作为文本字符串处理的模块级函数，但*编译*程序经常使用的表达式更有效。”

我无法按照他的解释解释为什么会这样。他说“模块级函数维护编译表达式的缓存”，并且由于“缓存大小”是有限的，“使用编译表达式直接避免了缓存查找开销。”

如果有人能解释或指导我解释为什么编译程序经常使用的正则表达式更有效，以及这个过程实际上是如何工作的，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T16:27:34.510

嗯。这很奇怪。到目前为止，我的知识（[从这个问题](https://stackoverflow.com/questions/452104/is-it-worth-using-pythons-re-compile)中获得的其他来源）建议了我的初步答案：

* * *

# 第一个答案

Python 会缓存您使用的最后 100 个正则表达式，因此即使您没有显式编译它们，也不必在每次使用时都重新编译它们。

但是，有两个缺点：当达到 100 个正则表达式的限制时，整个缓存都会被核弹，所以如果你连续使用 101 个不同的正则表达式，每次都会重新编译每个正则表达式。好吧，这不太可能，但仍然如此。

其次，为了确定一个正则表达式是否已经编译，解释器每次都需要在缓存中查找正则表达式，这确实需要一些额外的时间（但并不多，因为字典查找非常快）。

因此，如果您显式编译您的正则表达式，您可以避免这个额外的查找步骤。

* * *

# 更新

我刚刚做了一些测试（Python 3.3）：

```
>>> import timeit
>>> timeit.timeit(setup="import re", stmt='''r=re.compile(r"\w+")\nfor i in range(10):\n r.search("  jkdhf  ")''')
18.547793477671938
>>> timeit.timeit(setup="import re", stmt='''for i in range(10):\n re.search(r"\w+","  jkdhf  ")''')
106.47892003890324 
```

因此，似乎没有进行缓存。也许这是运行的特殊条件的一个怪癖`timeit.timeit()`？

另一方面，在 Python 2.7 中，差异并不明显：

```
>>> import timeit
>>> timeit.timeit(setup="import re", stmt='''r=re.compile(r"\w+")\nfor i in range(10):\n r.search("  jkdhf  ")''')
7.248294908492429
>>> timeit.timeit(setup="import re", stmt='''for i in range(10):\n re.search(r"\w+","  jkdhf  ")''')
18.26713670282241 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T16:24:00.997

我相信他想说的是，您不应该在循环内编译正则表达式，而应在循环外编译。然后，您可以在循环内运行已编译的代码。

代替：

```
while true: 
    result = re.match('A', str) 
```

你应该把：

```
regex = re.compile('A')
while true:
    result = regex.match(str) 
```

~~基本上`re.match(pattern, str)`结合了编译和匹配步骤。在循环内编译相同的模式是低效的，因此应该在循环外提升。~~

请参阅蒂姆的答案以了解正确的推理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:36:59.093

在我看来，作者只是在说编译正则表达式并保存它比指望它之前编译的版本仍然保存在模块的有限大小的内部缓存中更有效。这可能是因为编译它们所需的工作量加上必须首先发生的额外缓存查找开销大于客户端简单地存储它们本身。

# security - RESTful PUT 和破解 URI

> ID：14755883
> 
> 赞同：0
> 
> 时间：2013-02-07T16:22:14.290
> 
> 标签：security, rest, put

我正在学习 RESTful 接口。要更新服务器资源，例如使用 (id = 1) 的联系人，我将其放入：

```
PUT /contact/1 
```

现在假设当前用户属于组织 1，组织 1 拥有联系人 1。还有组织 2，拥有联系人 2。当前用户不属于组织 2，没有权限。如果用户入侵网页（使用 Mozilla 的 Firebug 或 MSIE 的“F12 调试器”）并将网页请求更改为指向 /contact/2，浏览器将愉快地提交请求。

我的服务器必须防止这种跨组织攻击。在我当前的网站设计中，一旦用户登录，我就会在会话中存储一个数据对象（我使用的是 Tomcat/Java）。该对象存储用户所属的组织。安全检查代码将回传 PUT 请求的组织与用户所属的组织进行比较，并查看回传数据是否属于用户的组织。在检测到黑客攻击（组织 1 的用户正在尝试修改属于组织 2 的联系人 2）时，会向浏览器返回错误。

我知道 REST 应该是无状态的，但我目前正在使用某种状态。然而，如果我将用户信息传递到网页中，我认为这也可以通过 Firebug 等人进行黑客攻击。

**如何在不调用服务器状态的情况下实现这种安全性？**

谢谢，杰罗姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:26:48.193

RESTful 服务通常是无状态的。这意味着每个请求都必须使用 apikey 或其他方式进行身份验证。

所以请求将是`/path?apikey=MYKEY`，服务器将处理该 apikey 的权限。

顺便说一句，我也尝试过有状态的休息服务，并且服务器能够通过在登录期间初始化的 cookie 来理解会话（但这并不是真正的 RESTful）。

如果你想用 curl 尝试它们，请执行以下操作：

```
curl -c cookie.txt -d "user=username&password=pass" "my.login.path"
curl -b cookie.txt "do.something" 
```

# debugging - Erlang“系统”内存部分不断增长

> ID：14755885
> 
> 赞同：7
> 
> 时间：2013-02-07T16:22:16.140
> 
> 标签：debugging, memory-leaks, erlang

我有一个具有以下模式的应用程序：

*   2 个长时间运行的进程在一些空闲时间后进入休眠状态，并且它们的内存消耗按预期下降
*   N (0 < N < 100) 个工作进程，它们在空闲超过 10 秒时执行某些工作并休眠，如果空闲超过两个小时则终止
*   在夜间，当没有活动时，进程内存会恢复到与应用程序启动时几乎相同的值，这是预期的，因为所有工作人员都已死亡。

问题是“系统”部分不断增长（大约 1GB/周）。

我的问题是如何调试存储在那里的内容或谁在该区域分配内存而不释放它。

我已经测试**了 lists:keysearch/3**并且它似乎没有泄漏内存，因为这是我正在使用的唯一本地东西（没有端口，没有驱动程序，没有 NIF，没有 BIF，什么都没有）。Erlang 版本是 R15B03。

这是当前的**erlang:memory()**输出（少量流量，应用程序于 2 月 3 日启动）：

```
[{total,378865650},
{processes,100727351},
{processes_used,100489511},
{system,278138299},
{atom,1123505},
{atom_used,1106100},
{binary,4493504},
{code,7960564},
{ets,489944},
{maximum,402598426}] 
```

这是一个 64 位系统。如您所见，“系统”部分有约 270MB，而“进程”约为 100MB（夜间下降至约 16MB）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T13:10:18.730

看来我找到了问题所在。

我有一个“process_killer”gen_server，其中进程可以订阅定期 GC 或终止。它的订阅函数在某些进程收到的每条消息上被调用，以推迟 GC/kill（类似于重新武装）。

如果尚未监视此进程，则执行 erlang:monitor 以捕获死进程并将其从监视列表中删除。如果我在每条处理的消息上评论我们的重新订阅行，“系统”区域似乎表现正常。这意味着它是我的 process_killer 中的一个错误，它确实泄漏了监视器引用（请记住，您可以多次调用 erlang:monitor 并且每次调用都会创建一个引用）。

我之所以产生这个想法，是因为我测试了一个简单的模块，它在循环中调用 erlang:monitor，并且我看到每次调用都会增加约 13 字节的“系统”区域。

工人们自己都还好，因为无论如何他们都会带着他们的显示器死去。有一个长时间运行的（从应用程序开始，从应用程序停止）进程将所有消息发送给在收到的每条消息上调用 GC re-arm 的工作人员，所以我们谈论的是每个产生的数以万计的监视器小时，从未释放。

我在这里写下这个答案以供将来参考。

TL;博士; 确保您没有在长时间运行的过程中泄漏监视器参考。

# php - php 会话和 cookie

> ID：14755889
> 
> 赞同：0
> 
> 时间：2013-02-07T16:22:21.777
> 
> 标签：php, session, cookies

我想让会话保持浏览器关闭所以我用

```
session_set_cookie_params(86400 * 60, '/', 'my.domain.com', true, true); 
```

向客户端发送一个持久 cookie（也带有安全标志，因为这是一个 SSL 站点），有效期为 2 个月。但是，我看到在 x 分钟不活动后，会话变量在服务器上被清除。我怎样才能避免这种情况？本质上，我希望存储会话变量，直到 cookie 变得无效

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:29:51.693

设置[session.gc_maxlifetime 配置属性](http://www.php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime)。

当涉及到可接受的值时，文档相当稀疏，但我不想长达两个月。

您通常最好将重要数据存储在数据库中，并在使用*记住我*cookie 创建会话时将其添加到会话中。

为实际会话留下会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:30:41.633

通过会话，您可以看到两件事。直到垃圾收集清理服务器上的会话的时间，以及直到 cookie 过期的时间。

您只更改了 cookie 过期时间，会话仍将被清理。然而，延长会话并不是解决这个问题的好方法。您的代码可能会更改，最终可能会导致用户会话中断。您可能需要使用某种共享会话存储，例如 memcached，无论如何都会在某个最大时间后删除存储。

所以解决这个问题的方法是生成一个唯一的一次性cookie，可以用作替代登录密钥。此密钥将允许用户以类似于用户名/密码的方式登录。使用后，会重新生成一个新的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:24:06.930

会话变量将保持如下注释，但除非您更改它们的默认行为，否则它们会在会话结束时（即浏览器关闭时）过期。

对于您要完成的工作，您应该将值存储在`$_COOKIE`变量中，而不是`$_SESSION`变量中。

见这篇文章：[http ://buildinternet.com/2010/07/when-to-use-_session-vs-_cookie/](http://buildinternet.com/2010/07/when-to-use-_session-vs-_cookie/)

# c++ - 如何替换/删除字符缓冲区中的字符？

> ID：14755892
> 
> 赞同：0
> 
> 时间：2013-02-07T16:22:31.043
> 
> 标签：c++

我正在尝试修改使用此行的某人的代码：

```
out.write(&vecBuffer[0], x.length()); 
```

但是，我想事先修改缓冲区，以便删除我不想输出的任何坏字符。例如，如果缓冲区是“Test%string”并且我想去掉 %，我想将缓冲区更改为“Test string”或“Teststring”，以更容易为准。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:33:17.447

`std::replace`将允许用另一个特定字符替换一个特定字符，例如`'%'`用`' '`. 只需正常调用它：

```
std::replace( vecBuffer.begin(), vecBuffer.end(), '%', ' ' ); 
```

将 替换`'%'`为谓词对象 call `replace_if`，您可以替换谓词对象返回的任何字符`true`。但总是具有相同的性格。为了获得更大的灵活性，`std::transform`您可以传递一个函数，该函数接受 a`char`并返回 a `char`; 它将在缓冲区中的每个字符上调用。

或者，您可以执行以下操作：

```
vecBuffer.erase(
    std::remove( vecBuffer.begin(), vecBuffer.end(), '%' ).
    vecBuffer.end() ); 
```

删除字符。在这里，您也可以替换`remove` 为`remove_if`，并使用谓词，它可以匹配许多不同的字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:25:36.530

您可以使用的最简单的库可能是[Boost String Algorithms](http://www.boost.org/doc/libs/1_53_0/doc/html/string_algo.html)库。

```
boost::replace_all(buffer, "%", ""); 
```

将在原地替换所有出现的`%`无。您可以指定`" "`为替代品，甚至可以指定`"REPLACEMENT"`为适合您的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:30:31.253

```
std::string str("Test string");
std::replace_if(str.begin(), str.end(), boost::is_any_of(" "), '');
std::cout << str << '\n'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:27:40.343

您不需要使用 boost 库。最简单的方法是使用标题`%`中的 std::replace() 将字符替换为空格：`<algorithm>`

```
std::replace(vecBuffer.begin(), vecBuffer.end(), '%', ' '); 
```

我假设 ，`vecBuffer`顾名思义，是一个 std::vector。如果它实际上是一个普通数组（或指针），那么你会这样做：

```
std::replace(vecBuffer, vecBuffer + SIZE_OF_BUFFER, '%', ' '); 
```

SIZE_OF_BUFFER 应该是数组的大小（如果您不想转换整个缓冲区，则应该是要处理的数组中的字符数。）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-07T16:26:50.493

假设你有一个功能

```
bool goodChar( char c ); 
```

这会返回`true`您被批准的角色，`false`否则，那么怎么样

```
void fixBuf( char* buf, unsigned int len ) {
    unsigned int co = 0;
    for ( unsigned int cb = 0 ; cb < len ; cb++ ) {
        if goodChar( buf[cb] ) {
           buf[co] = buf[cb];
           co++;
        }
    }
} 
```

# sql - 统计访问次数并按公司分组

> ID：14755896
> 
> 赞同：0
> 
> 时间：2013-02-07T16:22:49.673
> 
> 标签：sql, tsql

我创建了这个 T-Sql 查询来给我多少次客户访问并按公司分组我的 Pronlem 是我的查询不要只计算一次访问也不按公司分组

```
SELECT     COUNT(  VisitTracking.customerID) AS #VISIT
                , MAX(VisitTracking.visitID) AS visitID
                ,Customers.title AS Title
                ,Customers.customerID
                ,Customers.firstName AS "First Name" 
                ,Customers.LastName AS "Last Name"
                ,Company.companyName AS "Company Name"
                ,VisitTracking.DateVisited AS "Date Visited"
                ,VisitTracking.nextVisit AS "Next Visit"
FROM         VisitTracking INNER JOIN
                      Customers ON VisitTracking.customerID = Customers.customerID INNER JOIN
                      Company ON VisitTracking.companyID = Company.companyID
GROUP BY VisitTracking.companyID,Customers.customerID, VisitTracking.customerID, Customers.title, Customers.firstName, Customers.LastName, Company.companyName, VisitTracking.DateVisited,VisitTracking.nextVisit 
```

输出 ![在此处输入图像描述](../Images/b08a8c8d0a4569010f3826460de00258.png)

我想要的是

```
2   29  Mr  2   Mike    Mike        N/A 2013-01-31  
1   28  Mr  2   Mike    Mike        Compudata   2013-01-31 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:27:43.417

问题是因为您正在使用字段 DataVisited，您应该删除该字段或执行类似的操作。

```
SELECT     COUNT(  VisitTracking.customerID) AS #VISIT
                , MAX(VisitTracking.visitID) AS visitID
                ,Customers.title AS Title
                ,Customers.customerID
                ,Customers.firstName AS "First Name" 
                ,Customers.LastName AS "Last Name"
                ,Company.companyName AS "Company Name"
                ,MAX(VisitTracking.DateVisited) AS "Date Visited"
                ,VisitTracking.nextVisit AS "Next Visit"
FROM         VisitTracking INNER JOIN
                      Customers ON VisitTracking.customerID = Customers.customerID INNER JOIN
                      Company ON VisitTracking.companyID = Company.companyID
GROUP BY VisitTracking.companyID,Customers.customerID, VisitTracking.customerID, Customers.title, Customers.firstName, Customers.LastName, Company.companyName,VisitTracking.nextVisit 
```

# r - 按列名选择一列，但R中矩阵的每一行的名称不同？

> ID：14755899
> 
> 赞同：3
> 
> 时间：2013-02-07T16:23:11.153
> 
> 标签：r

假设我有一个矩阵，我想从第一行的 column1、第二行的 column5 和第三行的 column4 中选择值（...）。这些列作为列名存储在向量中，并且该向量中的位置等于要选择该列的行。

我怎样才能有效地实现这一点，即没有循环？

（背景是：我的目的是在模拟中使用它，这就是为什么我想对其进行矢量化以加快速度）

一个最小的例子：

```
 # Creating my dummy matrix
    aMatrix <-matrix(1:15,3,5,dimnames=list(NULL,LETTERS[1:5]))
    aMatrix
         A B C  D  E
    [1,] 1 4 7 10 13
    [2,] 2 5 8 11 14
    [3,] 3 6 9 12 15

    # Here are the columns I want for each row
    columns <-c("A","E","D")
    columns
    [1] "A" "E" "D"
    # means: select for row 1 column "A" = 1,
    # select for row 2 column "E" = 11,
    # select for row 3 column "D" = 12

    # Now obviously I could do looping, but this is inefficient
    for (i in columns) print(grep(i,colnames(aMatrix))) #grep is necessary for my specific matrix-names in my simulation only.
    [1] 1 #wanting col. 1 for row 1
    [1] 5 #wanting col. 5 for row 2
    [1] 4 #wanting col. 4 for row 3 
```

我刚刚看到我这样做的循环方式效率不高。

我正在考虑 sapply/tapply 但不知何故无法让它工作，因为有两个参数发生了变化（要在矩阵中搜索的行，以及要从目标列名向量中选择的字母）。

我会非常感谢您的帮助。谢谢！

亚娜

PS 我在这里使用“grep”，因为列名是我将运行的模拟中实际列名的子字符串。但是创建子字符串会使示例更加复杂，因此我跳过了它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T16:31:04.770

正如帮助页面`?`[``所说，您可以使用矩阵进行子集化以获取单个元素。子集矩阵的每一行都是一个元素，列指定每个维度的索引。

```
match(columns,colnames(aMatrix)) #gets the column indices
# [1] 1 5 4
b <- cbind(seq_along(columns),match(columns,colnames(aMatrix))) #subset matrix
#      [,1] [,2]
# [1,]    1    1 #first element: first row first column
# [2,]    2    5 #second element: second row fifth column
# [3,]    3    4 #third element: third row fourth column
aMatrix[b]
# [1]  1 14 12 
```

# javascript - Ember deleteRecord 递归过多

> ID：14755900
> 
> 赞同：1
> 
> 时间：2013-02-07T16:23:12.290
> 
> 标签：javascript, recursion, ember.js, ember-data

我无法让 Ember 删除具有 belongsTo 关系的记录。我有几个模型设置为一对一的关系，如下所示：

```
App.User = DS.Model.extend({
    account: DS.belongsTo('App.Account')
    ...
});

App.Account = DS.Model.extend({
    user: DS.belongsTo('App.User'),
    ...
}); 
```

这是我的 UserController 上的 deleteUser 方法

```
deleteUser: function() {
    user = this.get('model');
    var transaction = App.store.transaction();
    transaction.add(user);
    user.deleteRecord();
    transaction.commit();
    this.transitionTo('users');
} 
```

当它到达 user.deleteRecord(); 我在控制台中收到错误 递归过多。试图解决这个问题，我发现在主 ember.js 文件的这部分代码中发生了无限循环

```
var meta = obj[META_KEY], desc = meta && meta.descs[keyName],
    isUnknown, currentValue;
if (desc) {
    desc.set(obj, keyName, value);
} else {
    ....
} 
```

deleteRecord 调用 clearRelationships，后者在用户对象上调用 Ember.set(this, "account", null)。在 Ember.set() 中，当它遇到上面的代码时，它会找到对用户对象的引用并在其上调用 set.. 然后找到帐户并在其上调用 set.. 它找到用户并在其上调用 set..等等

如果这是 Ember 中的错误，任何人都可以帮助我修复或解决方法吗？这是我的示例的[jsFiddle](http://jsfiddle.net/LTUXY/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T22:02:37.640

看起来这是一个疏忽。github上的这个拉取请求为我解决了这个问题[https://github.com/emberjs/data/pull/715](https://github.com/emberjs/data/pull/715)

# c# - C# IDictionary.Keys 和 IDictionary.Values：最佳实现是什么？

> ID：14755903
> 
> 赞同：2
> 
> 时间：2013-02-07T16:23:25.330
> 
> 标签：c#, key-value, icollection, idictionary

我有一个充当字典的 C# 类，所以我现在正在支持 IDictionary。

一切都很好，除了属性键和值：

```
ICollection<TKey> Keys { get; }
ICollection<TValue> Values { get; } 
```

我在内部没有键或值的集合，所以我想知道如何将这些作为 ICollection 提供。

我的第一次尝试是像这样使用“收益回报”的魔力：

```
ICollection<TValue> Values { 
    get {
        for( int i = 0; i < nbValues; ++i ) {
            yield return GetValue(i);
        }
    }
} 
```

但当然这不起作用，因为返回的类型不是 IEnumerator 而是 ICollection ...

**这太糟糕了，因为这将是最简单的解决方案！**

我的第二次尝试是将我的值复制到一个新创建的数组中并返回该数组。

```
ICollection<TValue> Values { 
    get {
        TValue[] copy = new TValue[nbValues];
        for( int i = 0; i < nbValues; ++i ) {
            copy[i] = GetValue(i);
        }
        return copy;
    }
} 
```

这会起作用，因为 Array 支持 ICollection。
但问题是 ICollection 具有添加和删除条目的方法。如果调用者调用这些方法，则只会修改副本而不是字典...

我选择的最终解决方案是让我的字典支持 IDictionary 以及 ICollection 和 ICollection，这样我就可以从属性 Keys 和 Values 中返回这些集合......

```
public class MyDictionary : IDictionary<TKey,TValue>, 
                            ICollection<TKey>, 
                            ICollection<TValue>
{
} 
```

所以现在属性 Keys 和 Values 的 get 访问器只返回“this”，即：字典。

```
ICollection<TValue> Values { 
    get {
        return this;
    }
} 
```

这可能是最理想的解决方案，但我发现无论何时要实现 IDictionary，都必须实现两个额外的接口很麻烦。

你有什么别的想法吗？

我在想也许将副本作为数组返回毕竟不是一个坏主意。无论如何，IDictionary 中已经有一个 Add 和 Remove 方法，使用起来更有意义。

也许返回包装数组的 ReadOnlyCollection 会更好，因为任何修改返回的集合的尝试都会失败？

```
ICollection<TValue> Values { 
    get {
        TValue[] copy = new TValue[nbValues];
        for( int i = 0; i < nbValues; ++i ) {
            copy[i] = GetValue(i);
        }
        return new System.Collections.ObjectModel.ReadOnlyCollection<TValue>(copy);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:26:08.370

我个人不希望您能够通过无论如何从字典中删除键和值`Keys`-`Values`我认为*不*这样做很好。

返回 a`ReadOnlyCollection<T>`很好 - 如果调用者尝试修改集合，那么调用者只会得到一个异常，而不是只是默默地忽略该尝试。

顺便说一句，该异常遵循以下行为`Dictionary<TKey, TValue>`：

```
using System;
using System.Collections.Generic;

class Test
{
    static void Main()
    {
        IDictionary<string, string> dictionary = 
            new Dictionary<string, string> {{ "a", "b" }};
        dictionary.Keys.Clear();
        Console.WriteLine(dictionary.Count);
    }
} 
```

结果：

```
Unhandled Exception: System.NotSupportedException: Mutating a key collection
derived from a dictionary is not allowed.
   at System.Collections.Generic.Dictionary`2
            .KeyCollection.System.Collections.Generic.ICollection<TKey>.Clear()
   at Test.Main() 
```

正如 SLaks 所说，如果您可以创建自己的`ICollection<T>`惰性实现，那会更好 - 但如果由于某种原因这很棘手，或者确实在您的情况下性能并不重要，只需创建数组并将其包装在`ReadOnlyCollection<T>`很好。不过，您应该考虑以任何一种方式记录预期的性能。

*如果您确实*创建了自己的惰性实现，请注意一件事：您可能应该有某种“版本号”，以确保在基础数据发生更改时使返回的集合无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:25:01.283

A`ReadOnlyCollection`是您列出的选项中的最佳方法；这些集合不应该是可写的。

但是，您的吸气剂是 O(n)，这不好。

正确的方法是创建自己的集合类来实现`ICollection<T>`并返回字典的实时视图。（并从突变方法中抛出异常）

这是采取的方法`Dictionary<TKey, TValue>`；它确保属性获取器快速，并且不会浪费额外的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:33:24.583

谢谢大家的答案。

所以我最终做了两个实用程序类，它们实现了 Keys 和 Values 属性请求的两个 ICollection。我有一些字典需要添加对 IDictionary 的支持，因此我将重复使用它们几次：

这是键集合的类：

```
public class ReadOnlyKeyCollectionFromDictionary< TDictionary, TKey, TValue >
                       : ICollection<TKey>
                       where TDictionary : IDictionary<TKey,TValue>, IEnumerable<TKey>
{
    IDictionary<TKey, TValue> dictionary;

    public ReadOnlyKeyCollectionFromDictionary(TDictionary inDictionary)
    {
        dictionary = inDictionary;
    }

    public bool IsReadOnly {
        get { return true; }
    }

    Here I implement ICollection<TKey> by simply calling the corresponding method on 
    the member "dictionary" but I throw a NotSupportedException for the methods Add,
    Remove and Clear

    public IEnumerator<TKey> GetEnumerator()
    {
        return (dictionary as IEnumerable<TKey>).GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return (dictionary as IEnumerable).GetEnumerator();
    }
} 
```

这是值集合的类：

```
public class ReadOnlyValueCollectionFromDictionary<TDictionary, TKey, TValue> 
                       : ICollection<TValue>
                       where TDictionary : IDictionary<TKey, TValue>, IEnumerable<TValue>
{
    IDictionary<TKey, TValue> dictionary;

    public ReadOnlyValueCollectionFromDictionary(TDictionary inDictionary)
    {
        dictionary = inDictionary;
    }

    public bool IsReadOnly {
        get { return true; }
    }

    Here I implement ICollection<TValue> by simply calling the corresponding method on 
    the member "dictionary" but I throw a NotSupportedException for the methods Add,
    Remove and Clear

    // I tried to support this one but I cannot compare a TValue with another TValue
    // by using == since the compiler doesn't know if TValue is a struct or a class etc
    // So either I add a generic constraint to only support classes (or ?) or I simply
    // don't support this method since it's ackward in a dictionary anyway to search by
    // value.  Users can still do it themselves if they insist.
    bool IEnumerable<TValue>.Contains(TValue value)
    {
        throw new System.NotSupportedException("A dictionary is not well suited to search by values");
    }

    public IEnumerator<TValue> GetEnumerator()
    {
        return (dictionary as IEnumerable<TValue>).GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return (dictionary as IEnumerable).GetEnumerator();
    }
} 
```

然后，如果我的字典支持 TKey 和 TValue 的 IEnumerable，一切都变得如此简单：

```
public class MyDictionary : IDictionary<SomeKey,SomeValue>, 
                            IEnumerable<SomeKey>, 
                            IEnumerable<SomeValue>
{
    IEnumerator<SomeKey> IEnumerable<SomeKey>.GetEnumerator()
    {
        for ( int i = 0; i < nbElements; ++i )
        {
            yield return GetKeyAt(i);
        }
    }

    IEnumerator<SomeValue> IEnumerable<SomeValue>.GetEnumerator()
    {
        for ( int i = 0; i < nbElements; ++i )
        {
            yield return GetValueAt(i);
        }
    }

    // IEnumerator IEnumerable.GetEnumerator() is already implemented in the dictionary

    public ICollection<SomeKey> Keys
    {
        get
        {
            return new ReadOnlyKeyCollectionFromDictionary< MyDictionary, SomeKey, SomeValue>(this);
        }
    }

    public ICollection<Value> Values
    {
        get
        {
            return new ReadOnlyValueCollectionFromDictionary< MyDictionary, SomeKey, SomeValue >(this);
        }
    }
} 
```

太糟糕了 IDictionary 没有为属性键和值返回 IEnumerable 而不是 ICollection。这一切本来会容易得多！

# magento - 在 Magento 中为折扣运费设置优惠券

> ID：14755909
> 
> 赞同：1
> 
> 时间：2013-02-07T16:23:33.037
> 
> 标签：magento

我需要为美国大陆的订单超过 25.00 美元设置免费送货。但是对于阿拉斯加和夏威夷以及公关。我需要这只是运费的 50% 折扣。

免费送货没问题，50% 的运费似乎是个问题。

我们不介意通过代码或管理员执行此操作。任何提示都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T15:25:25.743

检查促销 -> 购物车价格规则 -> 并添加基于送货地区或州的条件（任何适合您的需求）和另一个基于订单数量的条件。在选项卡操作中，您可以设置免费送货等。

# java - 将图形数据转换为 Json

> ID：14755910
> 
> 赞同：1
> 
> 时间：2013-02-07T16:23:41.073
> 
> 标签：java, json, neo4j

我正在尝试开发一个代表网站页面之间链接的小程序。我想用关系表示每个链接，用节点表示每个页面。

现在我正在使用一个小数据集，它看起来像：

```
HOME -> PAGE 1 -> PAGE 3 -> PAGE 5
     -> PAGE 2 -> PAGE 4 
```

插入我的所有节点和关系后，我想遍历我的图表并在 Json 中打印数据以获得类似：

```
{
  "name": "HOME",
  "children": [
    {
      "name": "PAGE 1",
      "children": [
        {
          "name": "PAGE 3",
          "children": [
            {"name": "PAGE 5"}
          ]
        },
        {
          "name": "PAGE 2",
          "children": [
            {"name": "PAGE 4"}
          ]
        }
      ]
    }
  ]
} 
```

有没有这样做的功能，或者我必须自己写json？

这是我的代码：

```
private static void routing( final GraphDatabaseService graphDb )
    {
        Transaction tx = graphDb.beginTx();

        Page home, p1, p2, p3, p4, p5;

        try
        {
            home = new Page(graphDb, "http://www.site.com/");
            p1 = new Page(graphDb, "http://www.site.com/page1.html");
            p2 = new Page(graphDb, "http://www.site.com/page2.html");
            p3 = new Page(graphDb, "http://www.site.com/page3.html");
            p4 = new Page(graphDb, "http://www.site.com/page4.html");
            p5 = new Page(graphDb, "http://www.site.com/page5.html");

            home.createLinkTo(p1);
            home.createLinkTo(p2);
            p1.createLinkTo(p3);
            p2.createLinkTo(p4);
            p3.createLinkTo(p5);

            tx.success();

            tx = graphDb.beginTx();
            final TraversalDescription linkTraversal = Traversal.description().depthFirst().relationships( RelationshipTypes.LINK );

            String output = "";

            for ( Node node : linkTraversal.traverse(home.getUnderlyingNode()).nodes() )
            {
                output += node.getProperty( "url" ) + "\n";

            }

            System.out.println(output);
        }
        finally
        {
            tx.finish();
        }
    } 
```

Page类的代码

```
public class Page implements Serializable{
    private static final long serialVersionUID = 1L;

    static final String URL = "url";
    private final Node underlyingNode;
    private List<Page> children = null;

    public Page( final Node node )
    {
        this.underlyingNode = node;
    }

    public Page( final GraphDatabaseService graphDb, final String url )
    {
        this.underlyingNode = graphDb.createNode();
        underlyingNode.setProperty( URL, url );
        children = new ArrayList<Page>();
    }

    public Node getUnderlyingNode()
    {
        return underlyingNode;
    }

    public String getUrl()
    {
        return (String) underlyingNode.getProperty( URL );
    }

    public void createLinkTo( final Page other )
    {
        Relationship link = underlyingNode.createRelationshipTo(other.underlyingNode, RelationshipTypes.LINK );
        children.add(other);
        //link.setProperty( ANCHOR, 'Mon ancre' );
    }

    @Override
    public String toString()
    {
        return "Page [url=" + getUrl() + "]";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:35:46.777

假设您有一个代表您的页面的 bean，如下所示：

```
public class Page implements Serializable {
    private String name;
    private List<Page> children;
    private transient GraphDatabaseService dbService;

    // Constructors, Getters/Setters
} 
```

您可以使用各种 JSON 库（如[Jackson](http://jackson.codehaus.org/)或[GS​​ON](http://code.google.com/p/google-gson/) ）轻松序列化它。这是一个简单的杰克逊示例：

```
final Page home ; // Initialize and construct the home page
final ObjectMapper mapper = new ObjectMapper();
final String json = mapper.writeValueAsString(home); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T12:17:34.680

我认为最有效的格式是节点列表和边缘列表，请参阅[https://github.com/jexp/batch-import](https://github.com/jexp/batch-import)以获取 CSV 版本，D3 在 Javascript 中执行类似操作，请参阅以 JSON 格式读取的 D3 示例。

/彼得

# maven - 如何在 parentpom 中依赖相同版本的 Maven 多模块兄弟项目

> ID：14755911
> 
> 赞同：0
> 
> 时间：2013-02-07T16:23:42.387
> 
> 标签：maven

我有一个用于父 pom 和静态分析配置的 maven 聚合器，包括：

*   parentpom-nocode - 我们公司和内部联系回购的详细信息。还充当以下子模块的聚合器和父级：
    *   analysisconfig - checkstyle、pmd 和 findbugs 的配置
    *   parentpom-minimal-java
    *   parentpom-full-java - 两个带有插件定义的 parentpom，包括 checkstyle、pmd、findbugs.

parentpoms 中的静态分析插件需要依赖 analysisconfig 来获取它们的配置。理想情况下，这应该与 parentpom 的 analysisconfig 版本相同。

如何在配置中指定它？${project.version} 不起作用，因为我们的实现项目将具有与 parentpom 不同的版本。同样，${project.parent.version} 和类似的也不起作用，因为我们的项目本身通常是聚合器。将其设置为固定版本号也不起作用，因为这些都应该一起发布并且是一个聚合器（无论如何这将是一场配置噩梦）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:35:29.553

我看到很多项目 parentpom 有固定版本（没有点）。在这种情况下，parentpom 应该包含变化缓慢的信息（例如 org info + repo configs）。您可以发布一次（技术/元发布）并在下一个版本中使用相同的版本。

# php - 在ajax中得到403禁止

> ID：14755916
> 
> 赞同：1
> 
> 时间：2013-02-07T16:23:56.337
> 
> 标签：php, html, ajax, tinymce, jomsocial

我在 ajax 调用中收到一个非常奇怪的 403 禁止错误。在对象上应用 JSON.stringify 后，数据将在多个 javascript 变量的 post javascript 对象中发送。

对象中的一个变量导致了问题，即从编辑器中获取的 text/html。当文本编辑器中有两个“p”标签时，会抛出 403 禁止。'p' 或任何其他标签。当编辑器中只有 1 个标签时，ajax 调用成功完成。

我认为在 ajax 调用中发送 html 有某种安全性，但 html 的编码如下：“{"description>:"<p>coming soon</p><p>coming soon</ p>"}"

我尝试删除 .htaccess，禁用 SEF 组件中的任何安全功能，停用 cloudflare 证券等。

详细信息：编辑器 TinyMCE、PHP 5.3、Joomla 2.5、JomSocial 2.0、Linux、Apache

请帮忙

帮助父母负担得起养家糊口的费用。我们将通过帮助他们识别社区内的商机并为他们的小企业提供资金来做到这一点。","funds_usage":"-","more_descp":"我的项目在不久的将来会增长到足够多，以至于我们可以提供高中 12 年级的学生兼职打工，这样他们就可以为大学注册、prome（matric ball）服装等挣钱，因为高中毕业后注册费总是一个问题，我也有过这样的苦涩味道。”， "help":"我会尽我所能获得面包制造公司的赞助，这样我们就可以帮助家长们找到自己的脚，我们可以在每个上学日为他们的孩子做一顿血统的学校午餐。n"}"

# html - 我没有看到应用于 div 标签的 css。这是为什么？

> ID：14755921
> 
> 赞同：-1
> 
> 时间：2013-02-07T16:24:10.497
> 
> 标签：html, css

通过以下代码段，我尝试打印文本`FileName`并`NodeThatShared`进行一些装饰。但它打印出来好像我没有使用`css` *(以简单的方式)*。这可能是什么原因？

```
HTML :

<div id="FileName">
    FileName
</div>

<div id="NodeThatShared">
    NodeThatShared
</div> 
```

* * *

```
CSS:

root { 
  display: block;
}

FileName {
  font-size:10px;
  text-decoration:underline;
  font-weight:bold;
}

NodeThatShared {
  font-size:9px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:25:13.063

你需要

```
#FileName

#NodeThatShared 
```

`.`表示一个 HTML 类 `#`表示一个 HTML ID

`<div id="test">`也是如此。`#test`_ `<div class="test">`_`.test`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T16:26:26.413

您应该在 CSS 文件中的 ID 名称之前包含 # 符号。

如果您决定使用类，请将 . 在类名之前。

您的 CSS 应如下所示：

```
#FileName {
    font-size:10px;
    text-decoration:underline;
    font-weight:bold;
}

#NodeThatShared {
    font-size:9px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:26:01.433

您没有正确选择元素，这是正确的方法：

```
#FileName {
  font-size:10px;
  text-decoration:underline;
  font-weight:bold;
}

#NodeThatShared {
  font-size:9px;
} 
```

类的 CSS 选择器用“.”表示 和一个 '#' 用于 ids。

以下是两者的示例：

```
<div class="my_class">This div is styled by a class selector</div>
<div id="my_id">This div is styled by an id selector</div>

.my_class { backgroud:orange; }
#my_id    { background:red; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T16:26:03.807

CSS ID 需要以井号为前缀`#`

```
#FileName {
  font-size:10px;
  text-decoration:underline;
  font-weight:bold;
}

#NodeThatShared {
  font-size:9px;
} 
```

CSS 类需要以句点为前缀`.`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T16:26:25.297

您需要将选择器的类型添加到前面。像：

```
#FileName {
  font-size:10px;
  text-decoration:underline;
  font-weight:bold;
 }

#NodeThatShared {
  font-size:9px;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-07T16:26:58.117

您错过了`#`指示 ID 的标志。

^(（我讨厌它不允许我发布（至少需要 30 个字符）而只有一个符号回答问题）)

```
#FileName {
  font-size:10px;
  text-decoration:underline;
  font-weight:bold;
}

#NodeThatShared {
  font-size:9px;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-07T16:27:37.263

要引用一个`id`in css，您可以使用：

```
#{id name} 
```

在您的情况下，它将是：

```
#FileName

#NodeThatShared 
```

如果您`class`在 css 中引用 a ，它将是：

```
.{class name} 
```

如：

```
.class1

.class2 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-07T16:53:05.223

在 CSS 中，ID 需要引用样式表中前面带有“#”符号的内容。例如：

```
 #FileName {
font-size:10px;
 text-decoration:underline;
font-weight:bold;
}

 #NodeThatShared {
font-size:9px;
} 
```

请记住，这仅适用于 ID。要使用类，它看起来像这样：

```
 .FileName {
font-size:10px;
 text-decoration:underline;
font-weight:bold;
}

 .NodeThatShared {
font-size:9px;
} 
```

类可以多次使用。

# java - java滚动条不合作

> ID：14755922
> 
> 赞同：0
> 
> 时间：2013-02-07T16:24:12.353
> 
> 标签：java, jscrollpane, jtextarea

您好，我正在尝试创建一个 JTextArea，一旦数据变大以容纳数据，滚动条就可以让我滚动，但是 ATM 没有滚动条，只有一个小方框，数据正在推动 GUI 的其余部分。

这是 textArea 和滚动条的代码，p3 也是我尝试添加滚动条和 textArea 的面板。

```
//TEXT AREA
final JTextArea dataTextField = new JTextArea();
dataTextField.setSize(750,200);    
dataTextField.setLineWrap(true);
dataTextField.setEditable(false);
dataTextField.setVisible(true);

JScrollPane scroll = new JScrollPane (dataTextField);
scroll.setVerticalScrollBarPolicy(
    JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
scroll.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
scroll.setVisible(true);

p3.add(dataTextField);
p3.add(scroll); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:27:43.717

```
//p3.add(dataTextField);
p3.add(scroll); 
```

Swing 组件只能有一个父级。当您将 dataTextField 添加到面板时，您会将其从滚动面板中删除。摆脱那行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:28:51.480

不要`setSize (750, 200)`在`dataTextField`. 只需将列数和行数传递给`JTextArea`.

# c - 如何将反汇编的 C 代码划分为函数？

> ID：14755935
> 
> 赞同：5
> 
> 时间：2013-02-07T16:24:46.407
> 
> 标签：c, windows, assembly, x86

我有一个创建`.text`win32 进程段转储的应用程序。然后它将代码划分为基本块。基本块是一组指令，它们总是一个接一个地执行（跳转总是这些基本块的最后一条指令）。这是一个例子：

```
Basic block 1
    mov ecx, dword ptr [ecx]
    test ecx, ecx
    je 00401013h

Basic block 2
    mov eax, dword ptr [ecx]
    call dword ptr [eax+08h]

Basic block 3
    test eax, eax
    je 0040100Ah

Basic block 4
    mov edx, dword ptr [eax]
    push 00000001h
    mov ecx, eax
    call dword ptr [edx]

Basic block 5
    ret 000008h 
```

现在我想将这些基本块分组到函数中——说哪些基本块构成一个函数。算法是什么？我必须记住，一个函数中可能有很多`ret`指令。如何检测`fast_call`功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T16:53:59.937

将块分组为函数的最简单算法是：

1.  记下所有呼叫的地址，并附有`call some_address`说明
2.  如果这样的地址之后的第一个块以 结尾`ret`，则您已完成该功能，否则
3.  跟随块中的跳转到另一个块，依此类推，直到您遵循所有可能的执行路径（请记住条件跳转，每个路径都将路径分成两部分）并且所有路径都以`ret`. 您需要识别组织循环的跳转，这样您的程序本身就不会因进入无限循环而挂起

问题：

1.  可以通过从内存中读取函数指针来间接进行许多调用，例如，您将拥有`call [some_address]`而不是`call some_address`
2.  可以对计算的地址进行一些间接调用
3.  在返回之前调用其他函数的函数可能有`jump some_address`而不是`call some_address`紧随其后`ret`
4.  `call some_address`可以用`push some_address`+ `ret`OR `push some_address`+的组合来模拟`jmp some_other_address`
5.  一些函数可能在它们的末尾共享代码（例如，它们有不同的入口点，但一个或多个出口点是相同的）

您可以通过寻找最常见的 prolog 指令序列来使用一些启发式方法来确定函数从哪里开始：

```
push ebp
mov ebp, esp 
```

`esp`同样，如果函数在编译时抑制了帧指针（即它们会使用而不是`ebp`访问堆栈上的参数，这是可能的），这可能不起作用。

编译器（例如 MSVC++）也可以用指令填充函数间空间，`int 3`这也可以作为即将到来的函数开始的提示。

至于区分各种调用约定，查看符号可能是最容易的（当然，如果你有它们的话）。[MSVC++ 生成不同的名称前缀和后缀，例如](http://msdn.microsoft.com/en-us/library/984x0h58.aspx)：

*   _function - cdecl
*   _function@number - 标准调用
*   @function@number - 快速调用

如果您无法从符号中提取此信息，则必须分析代码以查看参数如何传递给函数以及函数或其调用者是否将它们从堆栈中删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T16:30:27.663

您可以使用存在`enter`来表示函数的开始，或者使用[某些设置框架的代码](http://en.wikibooks.org/wiki/X86_Disassembly/Functions_and_Stack_Frames)。

```
push ebp
mov  ebp, esp
sub  esp, (bytes for "local" stack space) 
```

稍后您会`leave`在调用之前找到相反的代码（或）`ret`：

```
mov esp, ebp
pop ebp 
```

您还可以使用本地堆栈空间的字节数来识别本地变量。

[识别`thiscall`,`fastcall`](http://en.wikipedia.org/wiki/X86_calling_conventions)等将在 s 之前对`call`使用初始位置的代码进行一些分析，并对使用/清理的寄存器进行评估。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T16:39:27.280

看看windasm 或ollydbg 之类的软件。和`call`操作`ret`表示函数调用。但是，代码不会按顺序运行，并且可以在各处进行跳转。 `call dword ptr [edx]`取决于 edx 寄存器，因此除非您进行运行时调试，否则您将无法知道它的去向。

要识别 fastcall 函数，您必须查看参数是如何传递的。Fastcall 会将前两个指针大小的参数放在 edx 和 ecx 寄存器中，stdcall 会将它们压入堆栈。请参阅[这篇文章](http://www.nynaeve.net/?p=63)以获得解释。

# asp.net - 在 IIS Asp.net 中上传大文件

> ID：14755939
> 
> 赞同：2
> 
> 时间：2013-02-07T16:25:04.347
> 
> 标签：asp.net, iis

我们有一个客户的要求，他希望他们的客户能够通过公司网站上传大约 1Gb 的文件。

该网站使用托管在 IIS 和 Windows Server 2008 R2 上的 Sitefinity 5.3 构建。

我对此有几个担忧：

1.  我在测试上传一个 150Mb 的文件时监控了 CPU 使用率，它徘徊在 40% 左右，在某些时候我们让它停留在 99% 并且网站出现故障

2.  通过 HTTP 传输的文件……我们不是失去了所有不错的 FTP 功能，例如暂停/继续吗？我无法想象如果上传失败 90% 然后不得不从头开始，他们的客户会非常高兴。

有谁知道为什么CPU在上传过程中需要这么多热量？并且，除了 DropBox 和其他类似系统之外，是否有更好的解决方案。

谢谢， 雅克

# git - 删除 git 中的提交历史

> ID：14755940
> 
> 赞同：0
> 
> 时间：2013-02-07T16:25:04.440
> 
> 标签：git, heroku, commit

我在玩`heroku`和。要`django`在上面托管我的 django 应用程序`heroku`，我必须来回更改很多文件（`settings,urls,requirements.txt`等）（以便把事情做好）。结果在 repo 中有很多提交。问题是我有代码的稳定版本（在完成 heroku 特定修改之前）`github`，现在如果我推送我`github`为让应用程序运行所做的所有提交，它看起来会很难看`heroku`。

所以，我想删除所有这些提交，并回到旧的稳定版本。然后我可以添加`heroku`特定的修改并只做一个提交。我看到它的方式，我可以做到

1.pull from`github`然后添加`heroku`特定的更改。然后提交，推送到`github`，推送到`heroku`。

2.在里面`gitk`，我可以选择最后一个pre-heroku提交，右键单击并做'Reset master branch to here'。然后进行`heroku`相关更改，commit，push to `github`，push to `heroku`。

正确的方法是什么？假设 pre-heroku 提交是 ver6，而我当前的提交是 ver10，我做了 4 次不必要的提交。我需要将它们擦干净，然后进行下一次提交 ver7。

有人可以建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:44:40.577

1.  执行 git pull 以离线获取最新版本。
2.  [git rebase --interactive](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Squashing-Commits)修改你的分支。为除第一个之外的所有内容选择 squash 以仅进行一次提交。（将提交消息更改为合理的内容）
3.  git cherry-pick 在您将与稳定分支合并的任何开发分支上的一个提交。
4.  合并并推送

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-28T20:16:28.497

[方法与此处](https://stackoverflow.com/a/26000395/4720652)提到的 Github 中的方法非常相似。虽然我会为 Heroku 重写答案。

为了删除提交历史

*   创建一个新分支并结帐到它`git checkout --orphan branch_new`
*   添加所有文件`git add -A`
*   犯罪`git commit -m "Deleting commit history"`
*   删除主分支`git branch -D master`
*   将分支重命名为 master`git branch -m master`
*   强制将更新推送到存储库`git push -f heroku master`

# python - Amazon DynamoDDB：对表预置吞吐量的编程更改是否有限制？

> ID：14755946
> 
> 赞同：0
> 
> 时间：2013-02-07T16:25:12.027
> 
> 标签：python, amazon-dynamodb, throughput

我正在处理大量文件，如下所示：我首先将它们全部下载到 EC2 实例，然后运行一个脚本，该脚本顺序处理每个文件并将其索引到 DynamoDDB 表中（表中的每个项目对应于一行在一个文件中）。然后我下载下一批文件等。

现在我通过 AWS GUI 控制台调整预置吞吐量，它最终在下载阶段和索引阶段都是相同的。显然，这是次优的，因为在下载时我根本不与数据库交谈，所以我在此阶段所需的写入吞吐量基本上为 0。

所以我想要做的是在我开始索引时以编程方式调整预置吞吐量，然后在我停止索引并开始下载时降低。

我可以在单个请求中增加多少写入 t/p 是否有任何限制？例如，我可以将它从 5 更改为 120 吗？如果不是，我如何计算请求数量和将 t/p 从值 X 调整到值 Y（其中 X << Y）所需的时间？我是否必须为降低 t/p 做类似的计算？

我正在使用 Python 博托。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:44:12.003

扩大规模时，您只能将写入配置翻倍，因此如果您是 5 岁，则最多可以达到 10 倍，然后等待 20-30 秒以使其生效，然后再翻倍至 20 等等。您可以按自己的喜好缩小。

根据[AWS 常见问题解答](http://aws.amazon.com/dynamodb/faqs/#Is_there_any_limit_on_how_much_I_can_change_my_provisioned_throughput_with_a_single_request)：

> 问：我可以通过单个请求更改多少我的预置吞吐量有任何限制吗？是的。**Amazon DynamoDB 允许您通过单个 UpdateTable API 调用将预置的吞吐量级别更改多达 100%。如果您希望将吞吐量提高 100% 以上，只需再次调用 UpdateTable。**

例如，如果您的表预置了 1,000 个单位的写入容量，则您无法使用单个 API 调用将表更新到 3,000 个，因为这超过了单个 UpdateTable 操作的最大允许更改。要将吞吐量从 1,000 提高到 3,000 个写入容量单位，只需调用 UpdateTable 以首先将吞吐量翻倍至 2,000，然后再次调用 UpdateTable 以达到 3,000 写入/秒。

# mysql - sql 查询 LIKE % on Index

> ID：14755948
> 
> 赞同：1
> 
> 时间：2013-02-07T16:25:19.873
> 
> 标签：mysql, sql

我正在使用 mysql 数据库。我的网站分为不同的元素（项目 12 的 PRJ_12、任务 14 的 TSK_14、文档 18 的 DOC_18 等）。我们目前将这些元素的引用存储在我们的数据库中作为 VARCHAR。关系列已编入索引，因此选择起来更快。

我们正在考虑将这些列分为 2 列（在列“element_type”上使用 PRJ，在一个“element_id”上使用 12）。我们正在考虑这个解决方案，因为我们做了很多包含 LIKE ...% 的请求（例如检索一个用户的所有任务，无论任务的 id 是什么）。但是，将这些列分成 2 列会增加索引列的数量。

所以，我有两个问题：

1.  索引列中的`LIKE ...%`请求是否真的比简单的 where 查询慢（没有类似）。我知道如果该列未编入索引，则不建议进行`where ... LIKE %`请求，但我真的不知道索引是如何工作的）。
2.  我们将参考列一分为二的事实将使索引表的数量增加一倍。那是问题吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:32:05.020

1）点赞总是比完整比较（使用 = ）更昂贵，但这一切都归结为字段数据类型和记录数（除非我们谈论的是一个巨大的表，否则你不应该有问题）

2）多列索引不是问题，是的，它使索引更大，但那又怎样？数据类型和总行数很重要，但这就是索引的用途。

所以去吧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:50:06.643

这涉及到许多因素，但总的来说，在只有一个索引的表上再添加一个索引不太可能是一个大问题。有些事情要考虑。

*   如果表大多是只读的，那么它几乎肯定不是问题。如果更新很少，则不需要经常修改索引，这意味着额外的成本很少（除了额外的磁盘空间）。
*   如果对现有记录的更新不会更改这些键值中的任何一个，则不需要修改索引，因此也不会产生额外的运行时成本。
*   DELETES 和 INSERTS 将需要更新两个索引。因此，如果这是大多数操作（并且远远超过读取），那么额外的索引可能会导致可测量的性能下降（但从人类的角度来看，它可能不会很多并且不明显）。
*   您描述用法的like 运算符应完全优化。换句话说，该子句的执行应该与在这两种情况下都存在索引的情况`WHERE combinedfield LIKE 'PRJ%'`基本相同。`WHERE element_type = 'PRJ'`更昂贵的情况是如果您在开头使用通配符（例如，`LIKE '%abc%'`）。您可以将 LIKE 搜索视为等同于在字典中查找单词。搜索“overf%”与搜索“overflow”基本相同。您可以在字典中进行“手动”二进制搜索，并快速找到以“overf”开头的第一个单词。搜索“%low”的成本要高得多。您必须扫描整个字典才能找到所有以“low”结尾的单词。
*   从长远来看，拥有两个单独的字段来表示两个单独的值几乎总是更好，因为您可以构建更有效的查询，轻松执行连接等。

因此，根据给定的信息，我建议将其拆分为两个字段并索引这两个字段。

# javascript - data-dojo-mixin and id value

> ID：14755951
> 
> 赞同：2
> 
> 时间：2013-02-07T16:25:32.610
> 
> 标签：javascript, dojo

I'm trying to add a mixin to our ValidationTextBox using data-dojo-mixin="_MaskedMixin" in the html attribute for use when the parser runs over my document. When I do this, the instance gets an id of "_MaskedMixin_0" instead of "ValidationTextBox_0".

Is there any way to preserve the "ValidationTextBox" identity of the mixed in object?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T17:03:27.810

Not knowing your particular case, my recommendation would be to specify the id in the HTML markup and not let the parser auto generate one. But if you want the id to be auto generated, you can override the declared class.

[http://jsfiddle.net/cswing/EQj8G/](http://jsfiddle.net/cswing/EQj8G/)

```
<input type="text" data-dojo-type="dijit/form/ValidationTextBox" 
    data-dojo-mixins="_MaskedMixin" 
    data-dojo-props="declaredClass:'ValidationTextBox'" 
    value="" ></input> 
```

# python - Python 中的 WebSocket 服务器：“模块”对象没有属性“AF_INET”

> ID：14755963
> 
> 赞同：37
> 
> 时间：2013-02-07T16:26:10.313
> 
> 标签：python, sockets, websocket

我正在尝试运行这个简单的 Python WebSocket，并进行了一些非常小的更改。我正在运行 Python 2.4.3，因为我不能使用更新的版本，但我不确定这有多重要。

这是我得到的错误：

```
Traceback (most recent call last):
  File "socket.py", line 258, in ?
    server = WebSocketServer("localhost", 8000, WebSocket)
  File "socket.py", line 205, in __init__
    self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
AttributeError: 'module' object has no attribute 'AF_INET' 
```

这是我的代码：

```
import time
import struct
import socket
import base64
import sys
from select import select
import re
import logging
from threading import Thread
import signal

# Simple WebSocket server implementation. Handshakes with the client then echos back everything
# that is received. Has no dependencies (doesn't require Twisted etc) and works with the RFC6455
# version of WebSockets. Tested with FireFox 16, though should work with the latest versions of
# IE, Chrome etc.
#
# rich20b@gmail.com
# Adapted from https://gist.github.com/512987 with various functions stolen from other sites, see
# below for full details.

# Constants
MAGICGUID = "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"
TEXT = 0x01
BINARY = 0x02

# WebSocket implementation
class WebSocket(object):

    handshake = (
        "HTTP/1.1 101 Web Socket Protocol Handshake\r\n"
        "Upgrade: WebSocket\r\n"
        "Connection: Upgrade\r\n"
        "Sec-WebSocket-Accept: %(acceptstring)s\r\n"
        "Server: TestTest\r\n"
        "Access-Control-Allow-Origin: http://localhost\r\n"
        "Access-Control-Allow-Credentials: true\r\n"
        "\r\n"
    )

    # Constructor
    def __init__(self, client, server):
        self.client = client
        self.server = server
        self.handshaken = False
        self.header = ""
        self.data = ""

    # Serve this client
    def feed(self, data):

        # If we haven't handshaken yet
        if not self.handshaken:
            logging.debug("No handshake yet")
            self.header += data
            if self.header.find('\r\n\r\n') != -1:
                parts = self.header.split('\r\n\r\n', 1)
                self.header = parts[0]
                if self.dohandshake(self.header, parts[1]):
                    logging.info("Handshake successful")
                    self.handshaken = True

        # We have handshaken
        else:
            logging.debug("Handshake is complete")

            # Decode the data that we received according to section 5 of RFC6455
            recv = self.decodeCharArray(data)

            # Send our reply
            self.sendMessage(''.join(recv).strip());

    # Stolen from http://www.cs.rpi.edu/~goldsd/docs/spring2012-csci4220/websocket-py.txt
    def sendMessage(self, s):
        """
        Encode and send a WebSocket message
        """

        # Empty message to start with
        message = ""

        # always send an entire message as one frame (fin)
        b1 = 0x80

        # in Python 2, strs are bytes and unicodes are strings
        if type(s) == unicode:
            b1 |= TEXT
            payload = s.encode("UTF8")

        elif type(s) == str:
            b1 |= TEXT
            payload = s

        # Append 'FIN' flag to the message
        message += chr(b1)

        # never mask frames from the server to the client
        b2 = 0

        # How long is our payload?
        length = len(payload)
        if length < 126:
            b2 |= length
            message += chr(b2)

        elif length < (2 ** 16) - 1:
            b2 |= 126
            message += chr(b2)
            l = struct.pack(">H", length)
            message += l

        else:
            l = struct.pack(">Q", length)
            b2 |= 127
            message += chr(b2)
            message += l

        # Append payload to message
        message += payload

        # Send to the client
        self.client.send(str(message))

    # Stolen from http://stackoverflow.com/questions/8125507/how-can-i-send-and-receive-websocket-messages-on-the-server-side
    def decodeCharArray(self, stringStreamIn):

        # Turn string values into opererable numeric byte values
        byteArray = [ord(character) for character in stringStreamIn]
        datalength = byteArray[1] & 127
        indexFirstMask = 2

        if datalength == 126:
            indexFirstMask = 4
        elif datalength == 127:
            indexFirstMask = 10

        # Extract masks
        masks = [m for m in byteArray[indexFirstMask : indexFirstMask+4]]
        indexFirstDataByte = indexFirstMask + 4

        # List of decoded characters
        decodedChars = []
        i = indexFirstDataByte
        j = 0

        # Loop through each byte that was received
        while i < len(byteArray):

            # Unmask this byte and add to the decoded buffer
            decodedChars.append( chr(byteArray[i] ^ masks[j % 4]) )
            i += 1
            j += 1

        # Return the decoded string
        return decodedChars

    # Handshake with this client
    def dohandshake(self, header, key=None):

        logging.debug("Begin handshake: %s" % header)

        # Get the handshake template
        handshake = self.handshake

        # Step through each header
        for line in header.split('\r\n')[1:]:
            name, value = line.split(': ', 1)

            # If this is the key
            if name.lower() == "sec-websocket-key":

                # Append the standard GUID and get digest
                combined = value + MAGICGUID
                response = base64.b64encode(combined.digest())

                # Replace the placeholder in the handshake response
                handshake = handshake % { 'acceptstring' : response }

        logging.debug("Sending handshake %s" % handshake)
        self.client.send(handshake)
        return True

    def onmessage(self, data):
        #logging.info("Got message: %s" % data)
        self.send(data)

    def send(self, data):
        logging.info("Sent message: %s" % data)
        self.client.send("\x00%s\xff" % data)

    def close(self):
        self.client.close()

# WebSocket server implementation
class WebSocketServer(object):

    # Constructor
    def __init__(self, bind, port, cls):
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        self.socket.bind((bind, port))
        self.bind = bind
        self.port = port
        self.cls = cls
        self.connections = {}
        self.listeners = [self.socket]

    # Listen for requests
    def listen(self, backlog=5):

        self.socket.listen(backlog)
        logging.info("Listening on %s" % self.port)

        # Keep serving requests
        self.running = True
        while self.running:

            # Find clients that need servicing
            rList, wList, xList = select(self.listeners, [], self.listeners, 1)
            for ready in rList:
                if ready == self.socket:
                    logging.debug("New client connection")
                    client, address = self.socket.accept()
                    fileno = client.fileno()
                    self.listeners.append(fileno)
                    self.connections[fileno] = self.cls(client, self)
                else:
                    logging.debug("Client ready for reading %s" % ready)
                    client = self.connections[ready].client
                    data = client.recv(4096)
                    fileno = client.fileno()
                    if data:
                        self.connections[fileno].feed(data)
                    else:
                        logging.debug("Closing client %s" % ready)
                        self.connections[fileno].close()
                        del self.connections[fileno]
                        self.listeners.remove(ready)

            # Step though and delete broken connections
            for failed in xList:
                if failed == self.socket:
                    logging.error("Socket broke")
                    for fileno, conn in self.connections:
                        conn.close()
                    self.running = False

# Entry point
if __name__ == "__main__":

    logging.basicConfig(level=logging.DEBUG, format="%(asctime)s - %(levelname)s - %(message)s")
    server = WebSocketServer("localhost", 8000, WebSocket)
    server_thread = Thread(target=server.listen, args=[5])
    server_thread.start()

    # Add SIGINT handler for killing the threads
    def signal_handler(signal, frame):
        logging.info("Caught Ctrl+C, shutting down...")
        server.running = False
        sys.exit()
    signal.signal(signal.SIGINT, signal_handler)

    while True:
        time.sleep(100) 
```

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2013-02-07T16:34:32.733

看来您已经命名了自己的文件`socket.py`，所以当您使用时`import socket`，您没有获得系统库（它只是重新导入您当前所在的文件 - 没有`AF_INET`符号）。尝试将文件重命名为`mysocket.py`.

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-03-08T08:49:43.283

即使在更改文件名之后，如果您从终端运行 python。

（你可能会得到同样的错误）

亲切地

```
rm -rf socket.pyc 
```

（之前编译的字节码）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-08-25T15:00:41.523

我遇到了同样的问题，我被困在这里几个小时，尝试重新安装一百万次，但找到了解决方案。

1）确保文件名不是socket.py，

2）更改目录，由于某些权限问题，它在主目录中不起作用。

如果您偶然将文件保存为 socket.py，请不要复制相同的文件或将其重命名为其他文件，问题将持续存在。我建议你做的是，在不同的目录中打开一个新文件夹，编写一个涉及 AF_INET 的简单套接字代码。尝试运行它。它应该工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-02T11:30:03.667

进入当前工作目录并删除名为 'socket.py' 和 'socket.pyc' 的文件

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-04-22T06:23:40.963

问题可能是您有一个文件或缓存名称 socket.py 或 socket.pyc

```
rm -rf socket.py
rm -rf socket.pyc 
```

希望这将解决您的导入问题。好运

# ios - 实体 Shop 不符合键“category.name”的键值编码

> ID：14755965
> 
> 赞同：4
> 
> 时间：2013-02-07T16:26:17.393
> 
> 标签：ios, core-data

我正在使用 CoreData 开发一个 iOS 应用程序。

我有这两个实体：

**店铺**

![在此处输入图像描述](../Images/eb0fb7580e2f6f1707ac41805df64996.png)

**类别**

![在此处输入图像描述](../Images/9e04da66afe877eb9bc9bf5d52d35c6f.png)

我正在尝试`category.name`从`Shop`实体访问，但出现错误：

```
- (void)updateDetails:(NSManagedObject *)shop
{
    NSLog(@"updateDetails: %@", shop);

    if (shop == nil)
        return;

    self.nameLabel.text =      [[shop valueForKey:@"name"] description];
    self.categoryLabel.text =  [[shop valueForKey:@"category.name"] description];
    self.addressLabel.text =   [[shop valueForKey:@"address"] description];
    self.telephoneLabel.text = [[shop valueForKey:@"telephone"] description];

    NSNumberFormatter* f = [[NSNumberFormatter alloc] init];
    [f setNumberStyle:NSNumberFormatterDecimalStyle];
    NSNumber* acceptRate = [f numberFromString:[[shop valueForKey:@"acceptRate"] description]];

    _ratingControl.rating = [acceptRate unsignedIntValue];
} 
```

我以这种方式检索`Shop`实体：

```
NSManagedObjectContext *context = [self managedObjectContext];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Shop"
                                          inManagedObjectContext:context];

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
[fetchRequest setEntity:entity];

NSArray *results = [context executeFetchRequest:fetchRequest error:nil]; 
```

但我得到这个错误：

`'[<NSManagedObject 0x1cdb4890> valueForUndefinedKey:]: the entity Shop is not key value coding-compliant for the key "category.name".'`

**我该如何解决这个错误？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T16:47:00.400

`self.categoryLabel.text = [[shop valueForKey:@"category.name"] description];`

应该

`self.categoryLabel.text = [[shop valueForKeyPath:@"category.name"] description];`

**原因**：来自[键值编码文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/BasicPrinciples.html#//apple_ref/doc/uid/20002170-183455)

键是标识对象的特定属性的字符串。通常，键对应于接收对象中访问器方法或实例变量的名称。密钥必须使用 ASCII 编码，以小写字母开头，并且不得包含空格。

一些示例键是`payee`,`openingBalance`和。`transactions``amount`

键路径是一串点分隔键，用于指定要遍历的对象属性序列。序列中第一个键的属性是相对于接收者的，并且每个后续键都相对于前一个属性的值进行评估。

例如，关键路径`address.street`会从接收对象中获取地址属性的值，然后确定相对于地址对象的街道属性。

# java - Javafx：用鼠标在 ImageView 上绘图

> ID：14755968
> 
> 赞同：3
> 
> 时间：2013-02-07T16:26:24.340
> 
> 标签：java, canvas, imageview, javafx, draw

在 ImageView 上用鼠标绘图的任何方式..我不知道，例如使用画布？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T11:08:38.493

我来到这个是一个很好的解决我的问题..不是吗？

```
 AnchorPane anchorRoot;
    double initX;
    double initY;
    ImageView iv = new ImageView(image);
    final double maxX = iv.getImage().getWidth();
    final double maxY = iv.getImage().getHeight();

    anchorRoot.getChildren().add(iv);

    iv.setOnMousePressed(new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent me) {
            //System.out.println("Clicked, x:" + me.getSceneX() + " y:" + me.getSceneY());
            //the event will be passed only to the circle which is on front
            initX = me.getSceneX();
            initY = me.getSceneY();
            me.consume();
        }
    });
    iv.setOnMouseDragged(new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent me) {
            //System.out.println("Dragged, x:" + me.getSceneX() + " y:" + me.getSceneY());
            if (me.getSceneX() < maxX && me.getSceneY() < maxY) {
                Line line = new Line(initX, initY, me.getSceneX(), me.getSceneY());
                line.setFill(null);
                line.setStroke(Color.RED);
                line.setStrokeWidth(2);
                anchorRoot.getChildren().add(line);
            }

            initX = me.getSceneX() > maxX ? maxX : me.getSceneX();
            initY = me.getSceneY() > maxY ? maxY : me.getSceneY();
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-12T18:35:07.657

您可以使用 javafx 轻松完成此操作（未显示设计文件（fxml），仅显示代码的工作原理）...

```
package sample;

import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.image.PixelWriter;
import javafx.scene.image.WritableImage;
import javafx.scene.paint.Color;
import java.net.URL;
import java.util.ResourceBundle;

public class Controller implements Initializable{

    @FXML private ImageView img;

    @Override
    public void initialize(URL location, ResourceBundle resources) {

        Image[] i={null};
        i[0]=new Image("file:\\"+"C:\\Users\\Ragib\\Desktop\\a.jpg");
        img.setFitHeight(i[0].getHeight());
        img.setFitWidth(i[0].getWidth());
        img.setImage(i[0]);

        img.setOnMouseDragged(event -> {
            double x=event.getX();
            double y=event.getY();
            WritableImage wi=new WritableImage(i[0].getPixelReader(),(int)i[0].getWidth(),(int)i[0].getHeight());
            PixelWriter pw=wi.getPixelWriter();
            pw.setColor((int)x,(int)y,new Color(0,0,0,1));
            i[0]=wi;
            img.setImage(i[0]);
        });
    }
} 
```

# c# - 什么是一 .csdproj 文件？

> ID：14755969
> 
> 赞同：1
> 
> 时间：2013-02-07T16:26:24.880
> 
> 标签：c#, visual-studio

我继承了 C# Visual Studio 解决方案。

有一个 ProjectName.csdproj 文件和一个 ProjectName.csproj 文件。

什么是一 .csdproj 文件？我需要吗？我可以/应该删除它吗？

PS我真的是说csDproj。我知道 csproj 是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:46:34.770

它是 VS 早期版本的智能设备项目。我猜想 .csproj 只是同一个项目的转换版本。您可以通过其内容进行验证。

保留它意味着有人也在使用 VS2003 和更高版本。如果没有，那么只保留 .csproj 应该是要走的路。

# sql - 检查没有列的约束

> ID：14755973
> 
> 赞同：4
> 
> 时间：2013-02-07T16:26:40.950
> 
> 标签：sql, database, oracle, constraints, check-constraints

今天我在其中一张表上发现了一个有趣的约束：

```
alter table T1 add constraint C$T1_DUMMY check (null is null); 
```

知道为什么我们需要这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:07:44.993

答案很简单。

条件`null is null`将始终返回 true。因此，该`CHECK`语句始终返回 true，因此不强制执行任何额外的业务逻辑。很可能这就是约束被命名为的原因`C$T1_DUMMY`。

我还在我自己的机器上尝试了它，`emp`在 Oracle 自己的示例模式中的表上。完美运行。除了语法错误和其他约束的强制执行之外，没有什么是被禁止的。

# visual-studio - 适用于 Web 的 Visual Studio Express 2012。单击某处时光标不会返回到行尾

> ID：14755975
> 
> 赞同：2
> 
> 时间：2013-02-07T16:26:44.843
> 
> 标签：visual-studio

当我在编辑器视图中单击某处时，光标应该移动到最近的代码行的末尾，或者如果它是空的，则移动到行的开头。这是我在工作中习惯的。但是在家里，我有相同的 VS Express 2012 for Web（一切都更新了），但光标在点击时会闪烁。我知道这没什么大不了的，但有点烦人。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T22:28:32.750

检查您是否关闭了“虚拟空间”。

从 Visual Studio 菜单工具 -> 选项，文本编辑器 -> 所有语言，并确保未选中“启用虚拟空间”。

# frame - 寻求MPEG-2，从哪里开始？

> ID：14755980
> 
> 赞同：0
> 
> 时间：2013-02-07T16:26:53.593
> 
> 标签：frame, directshow, seek, mpeg-2

我希望能够寻找 MPEG-2 文件中的任意帧（来自 DVD，我猜它被称为 MPEG-2 程序流）。到目前为止，我一直在使用 OpenCV 2.1 来访问这些帧，但这只能在逐帧的基础上工作（仅向前搜索）。后来，当我安装 OpenCV 2.3.1 时，这种可能性就消失了，即仅限于 AVI。无论如何，我想在没有 OpenCV 的情况下做到这一点。我设法寻找关键帧（我想）或每一个帧（例如每 12 帧）。现在，看VirtualDub 的帧精确寻找是可能的。它说：''解析交错的 MPEG-2 文件''。这到底是什么意思，我必须从哪里开始做同样的事情？它甚至合法吗，我记得在某处读过一些关于它的东西，但我真的不记得了。我正在使用directshow在C++中编程。据我所知，directshow 不会这样做。然后我在研究 CBaseFilter、streamtime 方法等，但在我深入那个复杂的话题之前，我想知道这是否是正确的方法。期待您的解答，谢谢！

@Geraint：过滤图的代码片段：

```
CoCreateInstance(CLSID_FilterGraph,NULL,CLSCTX_INPROC,IID_IGraphBuilder,(LPVOID *)&pGraphBuilder);
 CoCreateInstance(CLSID_MPEG2Demultiplexer,NULL,CLSCTX_INPROC,IID_IBaseFilter,(LPVOID *)&pib);
 CoCreateInstance(CLSID_CMPEG2VidDecoderDS,NULL,CLSCTX_INPROC,IID_IBaseFilter,(LPVOID *)&pib2);

 pGraphBuilder->AddFilter(pib,L"Sample Splitter");
 pGraphBuilder->AddFilter(pib2,L"Sample Decoder");

 ZeroMemory(&am_media_type, sizeof(am_media_type));
am_media_type.majortype = MEDIATYPE_Video;
am_media_type.subtype = MEDIASUBTYPE_MPEG2_VIDEO;
am_media_type.formattype = FORMAT_MPEG2Video;

pGraphBuilder->QueryInterface(IID_IMediaControl,(LPVOID *)&pMediaControl);
pGraphBuilder->QueryInterface(IID_IMediaSeeking, (void**)(&pMediaSeeking));
pGraphBuilder->QueryInterface(__uuidof(IVideoFrameStep), (PVOID *)&fst); 
pGraphBuilder->QueryInterface(IID_IMediaEvent, (void **)&imev);
pGraphBuilder->QueryInterface(IID_IBasicVideo,(LPVOID *)&ibv);

pGraphBuilder->RenderFile(FILENAME,0); 
```

然后我使用 IMediaSeeking 来寻找视频。我也尝试过帧步进（因此上面的参考资料）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T15:14:39.970

DirectShow 能够提供帧精确的搜索。但是，如果没有索引，这是基于从文件开始的时间偏移量，而不是帧数。

使用 IMediaSeeking 设置开始时间。解复用器将在此之前以某种方式开始传送压缩帧。解码器将从前一个关键帧开始解码，但会丢弃您选择的起点之前的任何帧。

G

# android - AndroidAnnotations + cwac 无尽整合

> ID：14755985
> 
> 赞同：0
> 
> 时间：2013-02-07T16:27:03.447
> 
> 标签：android, android-annotations, commonsware-cwac

我正在使用令人惊叹的[AndroidAnnotations](http://androidannotations.org/)框架，现在尝试使用[cwac-endless](https://github.com/commonsguy/cwac-endless)库进行无限滚动。问题是我需要将我的适配器子类化为 EndlessAdapter，这迫使我实现它的四个构造函数之一。同时，我以前的适配器用 @EBean 注释，它只允许构造函数带有 Context 参数或 void。@EBean 不允许 EndlessAdapter 的四个构造函数中的任何一个。我应该放弃一种解决方案还是有另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:44:21.713

`EndlessAdapter`是开源的。欢迎您将其复制到您的项目中并对其进行修改以适应。

# cakephp - CakePHP：视图与控制器不同步

> ID：14755986
> 
> 赞同：0
> 
> 时间：2013-02-07T16:27:03.767
> 
> 标签：cakephp

我遇到了一个奇怪的问题，在控制器中从表中传递了一条记录，但视图最终显示了整个表。

我有大量的日志记录，并且很确定控制器正在通过 $this->set() 传递一条记录。

**控制器（ContactsController：show_list）**

```
$arr_contacts = $this->Contact->find(
    'all', 
    array(
        'conditions' => array(
            'Contact.state_id' => $i_state_id, 
            'Contact.city'=> $str_city
        ),
        'fields' => array(
            'Contact.id', 
            'Contact.name',  
            'Contact.city'
        ),
        'recursive' => -1
    )
);

$contacts = $arr_contacts;
$this->log ($contacts, 'debug');
$this->set('contacts', $this->paginate());
$this->log(__FUNCTION__." : ".__LINE__, 'debug' ); 
```

日志中的输出：

```
 Debug: Array
(
    [0] => Array
        (
            [Contact] => Array
                (
                    [id] => 504
                    [name] => Michael
                    [city] => New York
                )

        )

)

Debug: show_list : 303 
```

在**视图文件 (show_list.ctp)**中，我有

```
 <div class="contacts index">

   <?php echo print_r($contacts);?> 
```

视图文件打印*表中所有记录*的列表。cakephp 显示的 SQL 转储显示正在进行额外的 SQL 调用。但是，尚不清楚这些电话来自何处。

其余的控制器和操作似乎运行良好，排除了任何腐败问题。

有没有人遇到过类似的情况？任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T16:35:18.740

您将 paginate() 函数的输出传递给您的视图，这与您自己的 find() 调用不同。

如果您想要与 find() 相同的条件。将它们传递给 paginate() （提示：首先将条件放入数组中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T04:52:39.863

如果您不需要 Paginate，因为您只从 Db 获得一行条目，因此您似乎不需要 Paginate，那么您应该这样重写您`$this->set()`的：

```
$this->set('contacts',$contacts); 
```

如果您需要 Paginate (???)，那么您需要将整个函数设置为：

```
$this->paginate = array(
    'conditions' => array(
        'Contact.state_id' => $i_state_id, 
        'Contact.city'=> $str_city
    ),
    'fields' => array(
        'Contact.id', 
        'Contact.name',  
        'Contact.city'
    ),
    'recursive' => -1
);

$this->log ($this->paginate, 'debug');
$this->set('contacts', $this->paginate());
$this->log(__FUNCTION__." : ".__LINE__, 'debug' ); 
```

# java - WebLogic Toplink（它的 xml 解析器？）配置问题

> ID：14755987
> 
> 赞同：0
> 
> 时间：2013-02-07T16:27:09.847
> 
> 标签：java, weblogic-10.x, toplink

我在 WEB-INF\lib 下有一个带有 toplink.jar 和 xmlparserv2.jar 文件的 Web 应用程序（war 打包）。问题是我得到

```
]] Root cause of ServletException.
java.lang.NoClassDefFoundError: oracle/xml/parser/schema/XSDElement
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2389)
    at java.lang.Class.getConstructor0(Class.java:2699)
    at java.lang.Class.newInstance0(Class.java:326)
    at java.lang.Class.newInstance(Class.java:308)
    at oracle.toplink.internal.security.PrivilegedAccessHelper.newInstanceFromClass(PrivilegedAccessHelper.java:335)
    at oracle.toplink.platform.xml.XMLPlatformFactory.getXMLPlatform(XMLPlatformFactory.java:95) 
```

我不明白，因为 xmlparserv2.jar 包含`oracle.xml.parser.schema.XSDElement`类 - 所以它应该在类路径上。我的 WebLogic 版本是 10.3.2.0，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-05T00:59:20.927

在 WebLogic 管理控制台的“服务器启动”选项卡的“参数”中添加以下行

```
-Dtoplink.xml.platform=oracle.toplink.platform.xml.jaxp.JAXPPlatform 
```

来源：[https ://community.oracle.com/message/2988932?tstart=44](https://community.oracle.com/message/2988932?tstart=44)

# iphone - Iphone 文字显示问题

> ID：14755988
> 
> 赞同：1
> 
> 时间：2013-02-07T16:27:15.150
> 
> 标签：iphone, mobile-safari

我有一个非常简化的版本，一个只显示文本供用户查看和排序的网站。但是，某些文本随机不显示在 iphone 上。更奇怪的是，如果我长按 iphone 上的单元格，它会弹出尝试完成通话的号码....有什么想法吗？在网络浏览器上很好，在安卓上也很好。

附上错误示例的图片。网址是[http://jacobyfeed.com/mobile/ft-worth-steer-weight-breaks.html](http://jacobyfeed.com/mobile/ft-worth-steer-weight-breaks.html)

# ios - 有效地将键/值保存到许多键

> ID：14755990
> 
> 赞同：0
> 
> 时间：2013-02-07T16:27:22.220
> 
> 标签：ios, objective-c, cocoa-touch, key-value

我正在使用键/值方法将整数保存到 NSUserDefaults。我在 switch 中有 30 种不同的情况，每种情况都将整数值保存到特定键。我为每个正在保存的整数创建了一种方法。这里有一些代码来解释：

```
-(void) saveInteger1:(NSInteger)int1 {
    [[NSUserDefaults standardUserDefaults] setInteger:int1 forKey:@"Integer1"];
}
-(void) saveInteger2:(NSInteger)int2 {
    [[NSUserDefaults standardUserDefaults] setInteger:int2 forKey:@"Integer2"];
}
-(void) saveInteger3:(NSInteger)int3 {
    [[NSUserDefaults standardUserDefaults] setInteger:int3 forKey:@"Integer3"];
}
//And I got from 1-30 of these methods

switch (newInteger) {
    case 1:
    [self saveInteger1:newInteger];
    break;
    case 2:
    [self saveInteger2:newInteger];
    break;
    case 3:
    [self saveInteger3:newInteger];
    break;
//And from 1-30 cases
} 
```

什么是更有效的方法来做到这一点，所以它不会有这么多的代码行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T16:32:35.393

是表单的所有键`IntegerX`吗？如果是这样，请执行以下操作：

```
- (void)saveInteger:(NSInteger)value {
    NSString *key = [NSString stringWithFormat:@"Integer%d", value];
    [[NSUserDefaults standardUserDefaults] setInteger:value forKey:key];
}

[self saveInteger:newInteger]; 
```

无需`switch`声明。

# android - Android 为益智游戏存储图像

> ID：14755991
> 
> 赞同：0
> 
> 时间：2013-02-07T16:27:23.637
> 
> 标签：android, sqlite

只是在寻找对解决我的问题的最佳方法的意见。我有一个针对儿童的益智游戏应用程序的想法，其中一部分要求用户从 3 个不同的选项中选择正确的图像。给出一条线索，例如“D 代表...”，然后将显示 3 张图像。例如苹果、狗和山羊。如果用户在这种情况下选择 Dog，则选择下一个字母。如果用户选择错误，他们将有另一个机会选择。

我不是在寻找解决方案，我只是想知道存储带有正确问题的图像的最佳方法是什么。SQLite DB 会是最佳选择吗？最初它只会为每个字母存储 1 个图像，但最终会扩展为每个字母存储多个图像，所以我在这里考虑长期。

提前谢谢各位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:46:07.660

我会将它全部存储在一个 json 文件中。我认为 SQLite 将为此矫枉过正。

```
[
  {
    "letter":"c",
    "images":[
    "image_cat",
    "image_car"
    ]
  },
  {
    "letter":"d",
    "images":[
    "image_dog",
    "image_duck",
    "image_desk"
    ]
  }
] 
```

然后你可以很容易地将 json 解析成一个对象数组。

然后在 res/drawable/hdpi/ 你可以有 image_cat.png image_car.png image_dog.png image_duck.png image_desk.png

然后从资源加载这些图像，使用类似：

```
int resourceId=Resources.getSystem().getIdentifier(imageName, "drawable", getContext().getPackageName());
if(resourceId != 0){
 Drawable d = getResources().getDrawable(resourceId);
} 
```

如果您希望将图像存储在资产中，您可以这样做：

```
InputStream ims = getAssets().open(imageName);
Drawable d = Drawable.createFromStream(ims, null); 
```

# android - 如何在 Android 中正确终止 AsyncTack 线程？

> ID：14755993
> 
> 赞同：3
> 
> 时间：2013-02-07T16:27:32.037
> 
> 标签：android, multithreading, android-asynctask

我在我的 Android 项目中子类化了一个 AsyncTask。

我想实现一项功能，如果当前任务花费太多时间，则允许用户取消当前的 AsyncTack 并开始一个新的。

```
MyAsyncTask mat = new MyAsyncTask(); 
```

当用户单击取消按钮时，我将执行以下代码，然后开始一个新任务。

```
mat.cancel(true); 
```

但是，我后来意识到，直到旧任务完成，新任务才会开始。旧的任务步骤仍在执行。

我在google上查看官方文档。看来我应该在***doInBackGroud(Params... params)***中调用以下语句。

```
if (isCancelled()) break; 
```

问题是我发现下面的代码需要很长时间。

```
DefaultHttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(url);
HttpResponse httpResponse = httpClient.execute(httpPost); 
```

***但是如何在httpClient.execute(httpPost)***执行时检查任务是否被取消？有没有像***onProgressChanged(int progress)***这样的方法可以在 DefaultHttpClient 中覆盖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:34:56.617

> 我想实现一项功能，如果当前任务花费太多时间，则允许用户取消当前的 AsyncTack 并开始一个新的。

由于在旧任务完成之前无法启动新任务，因此您可以创建 Asyntask 的新实例。事实上，多次使用 AsyncTask 的实例是个坏主意。在你之后

```
HttpResponse httpResponse = httpClient.execute(httpPost); 
```

你可以检查它是否被取消

```
if(!isCanceled()){

} 
```

查看[文档](http://developer.android.com/reference/android/os/AsyncTask.html)，线程规则下的最后一行。 正如评论指出的那样
**更新。**取决于您的平台，因此请在执行前检查平台版本。

```
 if (Build.VERSION.SDK_INT>=Build.VERSION_CODES.HONEYCOMB) {
      myTask.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);
    }
    else {
      myTask.execute();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:36:07.943

您需要通过调用`abort`您的`httpPost`对象来中止您的请求。这将导致该`execute`方法立即返回并停止阻塞您的线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T17:01:31.330

我实际上会完全避免使用 AsyncTask。AsyncTask 容易发生内存泄漏，并且与 Activity 生命周期的联系很差，因此您最终会给自己带来麻烦。

考虑使用[RoboSpice](https://github.com/octo-online/robospice/blob/master/README.md)，因为它不仅可以帮助您解决问题，而且可以避免 AsyncTasks 的问题，并且不必使用 HttpClient 手动编写内容。我不是 RoboSpice 的开发者之一，但我最近开始使用它，这是一个很棒的项目。

# image-processing - Coldfusion 8 错误：图像格式无效或性能缓慢

> ID：14755994
> 
> 赞同：1
> 
> 时间：2013-02-07T16:27:33.950
> 
> 标签：image-processing, coldfusion, coldfusion-8, cfimage

试图解决别人的不太好的代码。任何想法将不胜感激。它似乎在`<cfif>`带来图像时爆炸：

```
<cfif LEN(qryCampers.std_image_filename[iRow + iCol]) GT 0> 
```

如果我注释掉 if（并且只将与“no_image.gif”相关的部分保留在`cfif`语句之外）我们很好。文档出现。

CF Server 8，SQL Server 2000，图像尺寸相对较小（全部小于 30kb，宽度不超过 300px），此代码有时会起作用，当它起作用时，加载 PDF 需要永远。此特定查询（仅 12 条记录）导致错误。

错误：

```
Invalid image format

The error occurred in D:\apps\Websites\Example\app\reports\dsp_camper_cards_preview.cfm: line 51
49 :                            <td width="40%" align="center" valign="middle">
50 :                                <cfif LEN(qryCampers.std_image_filename[iRow + iCol]) GT 0>
51 :                                    <cfimage source="../photos/#qryCampers.std_image_filename[iRow + iCol]#" action="read" name="cardImage">
52 :                                    <cfif cardImage.height GT cardImage.width>
53 :                                        <img src="../photos/#qryCampers.std_image_filename[iRow + iCol]#" height="150"> 
```

`cfdocument`代码：

```
<cfdocument filename="#fileName#" format="PDF" pagetype="letter" 
    margintop=".175" marginbottom=".125" marginright=".125" marginleft=".125" 
    orientation="portrait" unit="in" encryption="none" fontembed="Yes" backgroundvisible="No" overwrite="Yes">

<style type="text/css">
   table, tr, td { font-size: 9px; font-family:Arial; }
</style>
<table width="100%" border="0" cellpadding="2" cellspacing="2" align="center" bordercolor="000000">
    <cfloop from="1" to="#Ceiling(qryCampers.recordcount/2)#" index="iRow">
    <tr valign="top">
        <cfloop from="#iRow - 1#" to="#iRow#" index="iCol">
        <cfif LEN(qryCampers.student_id[iRow + iCol]) GT 0>
        <cfquery name="qryMedInfo" datasource="#session.datasource#">
        SELECT * FROM tbl_medical_info_form WHERE mif_std_id = #qryCampers.student_id[iRow + iCol]# AND mif_trip_year = '#DateFormat(Now(), '01/01/yyyy')#'
        </cfquery>
        <td width="50%">
            <table width="100%" border="0" cellpadding="2" cellspacing="2" align="center">
                <tr valign="top">
                    <td height="25%">
                    <table width="100%" border="0" cellpadding="2" cellspacing="2" align="center">
                        <tr valign="top">
                            <td width="40%" align="center" valign="middle">
                                <cfif LEN(qryCampers.std_image_filename[iRow + iCol]) GT 0>
                                    <cfimage source="../photos/#qryCampers.std_image_filename[iRow + iCol]#" action="read" name="cardImage">
                                    <cfif cardImage.height GT cardImage.width>
                                        <img src="../photos/#qryCampers.std_image_filename[iRow + iCol]#" height="150">
                                    <cfelseif cardImage.height LTE cardImage.width>
                                        <img src="../photos/#qryCampers.std_image_filename[iRow + iCol]#" height="150">
                                    </cfif>
                                <cfelse>
                                    <img src="../images/no_image.gif" alt="" width="" height="150" border="0">
                                </cfif>
                            </td>
                            <td width="60%">
                                <cfif qryMedInfo.mif_c_alleriges EQ "Yes" OR LEN(qryMedInfo.mif_severe_allerigies) GT 0>
                                    <font color="FF0000" style="font-size:16px;">ALLERGIES</font><br>
                                </cfif>
                                <cfif qryMedInfo.mif_r_alcohol EQ "Yes">
                                    <font color="FF0000" style="font-size:16px;">ALLOWED TO DRINK</font><br>
                                <cfelse>
                                    <font color="FF0000" style="font-size:16px;">NOT ALLOWED TO DRINK</font><br>
                                </cfif>

                                <u>Parent Note</u> : <cfif qryMedInfo.mif_c_alleriges EQ "Yes">#qryMedInfo.mif_history_comments#</cfif><br>
                                <u><font color="FF0000">SEVERE ALLERGIES</font></u> : #qryMedInfo.mif_severe_allerigies#<br>
                                <br>
                                <u>Conditions</u> : #qryMedInfo.mif_med_conditions_1#<br>
                                <cfif Len(qryMedInfo.mif_med_conditions_2) GT 0>#qryMedInfo.mif_med_conditions_2#<br></cfif>                
                                <u>Medications</u> : <font color="FF0000">#TRIM(qryMedInfo.mif_med_taken_1)#</font><br>#TRIM(qryMedInfo.mif_med_taken_2)#<br>

                                <font color="FF0000"><u>CANNOT TAKE</u> : </font>
                                    <cfif qryMedInfo.mif_r_aspirin EQ "No">     Aspirin,</cfif>
                                    <cfif qryMedInfo.mif_r_pepto EQ "No">       Pepto Bismol,</cfif>
                                    <cfif qryMedInfo.mif_r_non_aspirin EQ "No"> Non-Apsirin (Acetaminophen/Tylenol),</cfif>
                                    <cfif qryMedInfo.mif_r_maalox EQ "No">      Maalox,</cfif>
                                    <cfif qryMedInfo.mif_r_nsaid EQ "No">       NSAID (Ibuprofen/Advil, Motrin or Naproxensodium/Aleve),</cfif>
                                    <cfif qryMedInfo.mif_r_immodium EQ "No">    Immodium,</cfif>
                                    <cfif qryMedInfo.mif_r_benadryl EQ "No">    Benadryl,</cfif>
                                    <cfif qryMedInfo.mif_r_simethicone EQ "No"> Simethicone (GasX),</cfif>
                                    <cfif qryMedInfo.mif_r_sudafed EQ "No">     Pseudoephedrine/Sudafed,</cfif>
                                    <cfif qryMedInfo.mif_r_tagamet EQ "No">     Tagamet or similar,</cfif>
                                    <cfif qryMedInfo.mif_r_cough EQ "No">       Cough Medicine,</cfif>
                                    <cfif qryMedInfo.mif_r_bandages EQ "No">    Bendages,</cfif>
                                    <cfif qryMedInfo.mif_r_throat EQ "No">      Throat Lozenges,</cfif>
                                    <cfif qryMedInfo.mif_r_antibiotic EQ "No">  Antibiotic Ointment,</cfif>
                                    <cfif qryMedInfo.mif_r_ex_anesthetic EQ "No">External Anesthetic (Calamine or the like),</cfif>
                                    <cfif qryMedInfo.mif_r_cortisone EQ "No">   Topical Cortisone Cream,</cfif>
                                    <cfif qryMedInfo.mif_r_tylenol_pm EQ "No">  Tylenol PM</cfif>
                                    <br>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <font style="font-size:16px;font-weight:bold;color:0000ff;">
                                    #qryCampers.std_first_name[iRow + iCol]# #qryCampers.std_last_name[iRow + iCol]#
                                </font><br>
                                <br>
                                <u>Emergency Contact</u> : #qryMedInfo.mif_emerg_name#&nbsp;&nbsp;&nbsp;<cf_phoneoutput startstring="#GetNumbers(qryMedInfo.mif_emerg_phone)#"><br>
                                <br>
                                <u>Father/Gaurdian</u> : #qryCampers.ftr_first_name[iRow + iCol]# #qryCampers.ftr_last_name[iRow + iCol]#&nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;<u>(H)</u> <cf_phoneoutput startstring="#GetNumbers(qryCampers.ftr_main_phone[iRow + iCol])#">&nbsp;&nbsp;&nbsp;or&nbsp;&nbsp;&nbsp;<u>(C)</u> <cf_phoneoutput startstring="#GetNumbers(qryCampers.ftr_cell_phone[iRow + iCol])#"><br>
                                <u>Mother/Gaurdian</u> : #qryCampers.mtr_first_name[iRow + iCol]# #qryCampers.mtr_last_name[iRow + iCol]#&nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;&nbsp;<u>(H)</u> <cf_phoneoutput startstring="#GetNumbers(qryCampers.mtr_main_phone[iRow + iCol])#">&nbsp;&nbsp;&nbsp;or&nbsp;&nbsp;&nbsp;<u>(C)</u> <cf_phoneoutput startstring="#GetNumbers(qryCampers.mtr_cell_phone[iRow + iCol])#"><br>
                            </td>
                        </tr>
                    </table>
                    </td>
                </tr>
            </table>
        </td>
        <cfelse>
            <td width="50%">&nbsp;</td>
        </cfif>
        </cfloop>       
    </tr>
    <cfif iRow MOD 4 IS 0>
    <tr>
        <td>&nbsp;</td>
    </tr>
    </cfif>
    </cfloop>
</table>
</cfdocument> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:32:12.677

听起来在这一行`<cfimage source="../photos/#qryCampers.std_image_filename[iRow + iCol]#" action="read" name="cardImage">`中找到的图像不是有效的图像格式。你确定它试图读取的是图像吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:48:35.130

您是否尝试过使用“isImage”？

```
 <cfif trim(qryCampers.std_image_filename[iRow + iCol]) neq '' 
          AND isImage('../photos/#qryCampers.std_image_filename[iRow + iCol]#')> 
```

我同意@Leeish 的观点，即 CFImage 标签正在获取它无法识别为图像的东西。我曾经有过一段时间，我有一个标记为 jpg 的 jpg，我可以在浏览器中查看它，但后来我尝试在 photoshop 或类似的东西中将其拉起，我发现 jpg 本身存在一个前导问题这阻止了 cfimage 或 cfx_ImageCR （我更喜欢）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T17:07:55.960

至于您的无效图像错误，我们遇到了类似的格式无效和性能缓慢的问题。我们的解决方案是将图像转换为 png，然后使用 cfimage 转换回 jpg。我们在上传图片时这样做了，但您可以在您的情况下做同样的事情。

```
<cfimage source="#expandPath('\images\temp')#\#cffile.serverFile#" action="convert" destination="#expandPath('\images\temp')#\#cffile.serverFileName#.png" overwrite="yes">
<cfimage source="#expandPath('\images\temp')#\#cffile.serverFileName#.png" action="convert" destination="#expandPath('\images\temp')#\#cffile.serverFileName#.jpg" overwrite="yes"> 
```