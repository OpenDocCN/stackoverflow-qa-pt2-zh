# StackOverflow 问答 15622000-15622999

# jquery - 由 jquery 加载的 Wordpress WP_Query

> ID：15622000
> 
> 赞同：0
> 
> 时间：2013-03-25T18:23:21.790
> 
> 标签：jquery, wordpress, include, load

我通过 jquery 加载一个 php 文件，女巫应该加载一个新的 WP_Query，但是 WP 加载不起作用，这里是我的代码：

jQuery代码：

```
$('.teaser-click').click(function(){

var post_id = $(this).attr("rel");
$("#content-"+post_id).load("xxxMYURLxxx/load-content.php", {neuId:post_id});

}); 
```

加载内容.php

```
$neuId = $_POST['neuId'];
echo "neuId: ".$neuId; 
```

它工作正常，直到这里，我得到了正确的 id，并且 ID alos 显示在 div 中，但我不会得到 wp-query 的内容

我也试过 'p' => 200 （只是为了测试）

```
$args = array(
        'p' => $neuId,
        'post_type' => 'any',
);

$my_new_posts = new WP_Query($args);
while ($my_new_posts->have_posts()) : $my_new_posts->the_post(); ?>

        <h1><?php the_title(); ?></h1>

<?php endwhile; ?> 
```

* * *

这是索引文件的wp查询

```
if (have_posts()) : 
 while (have_posts()) : the_post(); 

...

<?php endwhile; ?>
<?php endif; ?> 
```

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:02:02.940

你试过添加

```
require_once(ABSPATH . 'wp-load.php'); 
```

或者如果 ABSPATH 不起作用，您可能需要尝试手动使用 ../../ 并转到路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:51:52.747

您是否在 php 文件加载内容中包含定义 WP_Query 的文件？

请发送整个加载内容的 php 文件！

# r - 如何使用ggplot2在轴上仅显示整数值

> ID：15622001
> 
> 赞同：101
> 
> 时间：2013-03-25T18:23:29.940
> 
> 标签：r, ggplot2

我有以下情节：

```
library(reshape)
library(ggplot2)
library(gridExtra)
require(ggplot2)

data2<-structure(list(IR = structure(c(4L, 3L, 2L, 1L, 4L, 3L, 2L, 1L
), .Label = c("0.13-0.16", "0.17-0.23", "0.24-0.27", "0.28-1"
), class = "factor"), variable = structure(c(1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L), .Label = c("Real queens", "Simulated individuals"
), class = "factor"), value = c(15L, 11L, 29L, 42L, 0L, 5L, 21L, 
22L), Legend = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L), .Label = c("Real queens", 
"Simulated individuals"), class = "factor")), .Names = c("IR", 
"variable", "value", "Legend"), row.names = c(NA, -8L), class = "data.frame")
p <- ggplot(data2, aes(x =factor(IR), y = value, fill = Legend, width=.15))

data3<-structure(list(IR = structure(c(4L, 3L, 2L, 1L, 4L, 3L, 2L, 1L
), .Label = c("0.13-0.16", "0.17-0.23", "0.24-0.27", "0.28-1"
), class = "factor"), variable = structure(c(1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L), .Label = c("Real queens", "Simulated individuals"
), class = "factor"), value = c(2L, 2L, 6L, 10L, 0L, 1L, 4L, 
4L), Legend = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L), .Label = c("Real queens", 
"Simulated individuals"), class = "factor")), .Names = c("IR", 
"variable", "value", "Legend"), row.names = c(NA, -8L), class = "data.frame")
q<- ggplot(data3, aes(x =factor(IR), y = value, fill = Legend, width=.15))

##the plot##
q + geom_bar(position='dodge', colour='black') + ylab('Frequency') + xlab('IR')+scale_fill_grey() +theme(axis.text.x=element_text(colour="black"), axis.text.y=element_text(colour="Black"))+ opts(title='', panel.grid.major = theme_blank(),panel.grid.minor = theme_blank(),panel.border = theme_blank(),panel.background = theme_blank(), axis.ticks.x = theme_blank()) 
```

我希望 y 轴只显示整数。这是通过四舍五入还是通过更优雅的方法完成对我来说并不重要。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2014-12-16T00:57:08.483

If you have the `scales` package, you can use `pretty_breaks()` without having to manually specify the breaks.

```
q + geom_bar(position='dodge', colour='black') + 
scale_y_continuous(breaks= pretty_breaks()) 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2016-10-05T14:41:48.670

这就是我使用的：

```
ggplot(data3, aes(x = factor(IR), y = value, fill = Legend, width = .15)) +
  geom_col(position = 'dodge', colour = 'black') + 
  scale_y_continuous(breaks = function(x) unique(floor(pretty(seq(0, (max(x) + 1) * 1.1))))) 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2013-03-25T18:39:36.077

使用`scale_y_continuous()`and 参数`breaks=`，您可以将 y 轴的断点设置为要显示的整数。

```
ggplot(data2, aes(x =factor(IR), y = value, fill = Legend, width=.15)) +
    geom_bar(position='dodge', colour='black')+
    scale_y_continuous(breaks=c(1,3,7,10)) 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2017-07-03T13:37:10.677

您可以使用自定义贴标机。例如，这个函数保证只产生整数中断：

```
int_breaks <- function(x, n = 5) {
  l <- pretty(x, n)
  l[abs(l %% 1) < .Machine$double.eps ^ 0.5] 
} 
```

用于

```
+ scale_y_continuous(breaks = int_breaks) 
```

它通过采用默认中断来工作，并且只保留那些整数。如果它显示的数据中断太少，请增加`n`，例如：

```
+ scale_y_continuous(breaks = function(x) int_breaks(x, n = 10)) 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2019-02-13T20:27:02.460

这些解决方案对我不起作用，也没有解释解决方案。

函数的`breaks`参数`scale_*_continuous`可以与将限制作为输入并返回中断作为输出的自定义函数一起使用。默认情况下，对于连续数据（相对于数据范围），轴范围将在每侧扩展 5%。由于这种扩展，轴限制可能不是整数值。

我正在寻找的解决方案是简单地将下限四舍五入到最接近的整数，将上限四舍五入到最接近的整数，然后在这些端点之间的整数值处中断。因此，我使用了休息功能：

`brk <- function(x) seq(ceiling(x[1]), floor(x[2]), by = 1)`

所需的代码片段是：

`scale_y_continuous(breaks = function(x) seq(ceiling(x[1]), floor(x[2]), by = 1))`

原始问题的可重现示例是：

```
data3 <-
  structure(
    list(
      IR = structure(
        c(4L, 3L, 2L, 1L, 4L, 3L, 2L, 1L),
        .Label = c("0.13-0.16", "0.17-0.23", "0.24-0.27", "0.28-1"),
        class = "factor"
      ),
      variable = structure(
        c(1L, 1L, 1L, 1L,
          2L, 2L, 2L, 2L),
        .Label = c("Real queens", "Simulated individuals"),
        class = "factor"
      ),
      value = c(2L, 2L, 6L, 10L, 0L, 1L, 4L,
                4L),
      Legend = structure(
        c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L),
        .Label = c("Real queens",
                   "Simulated individuals"),
        class = "factor"
      )
    ),
    row.names = c(NA,-8L),
    class = "data.frame"
  )

ggplot(data3, aes(
  x = factor(IR),
  y = value,
  fill = Legend,
  width = .15
)) +
  geom_col(position = 'dodge', colour = 'black') + ylab('Frequency') + xlab('IR') +
  scale_fill_grey() +
  scale_y_continuous(
    breaks = function(x) seq(ceiling(x[1]), floor(x[2]), by = 1),
    expand = expand_scale(mult = c(0, 0.05))
    ) +
  theme(axis.text.x=element_text(colour="black", angle = 45, hjust = 1), 
        axis.text.y=element_text(colour="Black"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank(), 
        axis.ticks.x = element_blank()) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2021-08-27T11:15:54.327

您可以为此使用or的`accuracy`参数：[`scales::label_number()`](https://scales.r-lib.org/reference/label_number.html)[`scales::label_comma()`](https://scales.r-lib.org/reference/label_number.html)

```
fakedata <- data.frame(
  x = 1:5,
  y = c(0.1, 1.2, 2.4, 2.9, 2.2)
)

library(ggplot2)

# without the accuracy argument, you see .0 decimals
ggplot(fakedata, aes(x = x, y = y)) +
  geom_point() +
  scale_y_continuous(label = scales::comma) 
```

![](../Images/f29299ff47634f978cf208d16ddcab27.png)

```
# with the accuracy argument, all displayed numbers are integers
ggplot(fakedata, aes(x = x, y = y)) +
  geom_point() +
  scale_y_continuous(label = ~ scales::comma(.x, accuracy = 1)) 
```

![](../Images/e2473e0aa9db17f6a495037bb0928aa8.png)

```
# equivalent
ggplot(fakedata, aes(x = x, y = y)) +
  geom_point() +
  scale_y_continuous(label = scales::label_comma(accuracy = 1)) 
```

![](../Images/e55e30369c5a7c4385446a6bb6c2787d.png)

```
# this works with scales::label_number() as well
ggplot(fakedata, aes(x = x, y = y)) +
  geom_point() +
  scale_y_continuous(label = scales::label_number(accuracy = 1)) 
```

![](../Images/31fb83978cf43188ebbcecc46b9e69f2.png)

^(由[reprex 包](https://reprex.tidyverse.org)于 2021-08-27 创建(v2.0.0.9000))

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-06-11T09:25:51.187

我从 Joshua Cook 那里找到了这个解决方案，并且效果很好。

```
integer_breaks <- function(n = 5, ...) {
fxn <- function(x) {
breaks <- floor(pretty(x, n, ...))
names(breaks) <- attr(breaks, "labels")
breaks
}
return(fxn)
}

q + geom_bar(position='dodge', colour='black') + 
scale_y_continuous(breaks = integer_breaks()) 
```

来源是： [https ://joshuacook.netlify.app/post/integer-values-ggplot-axis/](https://joshuacook.netlify.app/post/integer-values-ggplot-axis/)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-05-20T16:23:38.637

所有现有的答案似乎都需要自定义功能或在某些情况下失败。

此行进行整数中断：

```
bad_scale_plot +
  scale_y_continuous(breaks = scales::breaks_extended(Q = c(1, 5, 2, 4, 3))) 
```

有关更多信息，请参阅文档`?labeling::extended`（这是一个由 调用的函数`scales::breaks_extended`）。

基本上，参数`Q`是一组很好的数字，算法试图将其用于比例中断。原始图产生非整数中断（0、2.5、5 和 7.5），因为 的默认值`Q`包括 2.5: `Q = c(1,5,2,2.5,4,3)`。

**编辑：**正如评论中指出的那样，当 y 轴的范围较小时，可能会发生非整数中断。默认情况下，`breaks_extended()`尝试进行`n = 5`中断，当范围太小时，这是不可能的。快速测试表明，大于 0 < y < 2.5 的范围会给出整数中断（`n`也可以手动减少）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-09-13T11:22:44.033

谷歌让我想到了这个问题。我正在尝试以任意比例使用*实数*。y 刻度数字以百万为单位。

[**scales**](https://scales.r-lib.org)包`comma`方法在我的大数中引入了一个逗号**。**[R-Bloggers](https://www.r-bloggers.com/using-custom-scales-with-the-scales-package/)上的这篇文章解释了一种使用该方法的简单`comma`方法：

```
library(scales)

big_numbers <- data.frame(x = 1:5, y = c(1000000:1000004))

big_numbers_plot <- ggplot(big_numbers, aes(x = x, y = y))+
geom_point()

big_numbers_plot + scale_y_continuous(labels = comma) 
```

享受**R** :)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-07-18T02:24:45.803

这个答案建立在@Axeman's answer to address the comment by kory that if the data only go from 0 to 1, no break is shown at 1\. 这似乎是因为`pretty`输出不准确，似乎是 1 与1（见最后的例子）。

因此，如果您使用

```
int_breaks_rounded <- function(x, n = 5)  pretty(x, n)[round(pretty(x, n),1) %% 1 == 0] 
```

和

```
+ scale_y_continuous(breaks = int_breaks_rounded) 
```

0 和 1 都显示为中断。

**示例说明与 Axeman 的区别**

```
testdata <- data.frame(x = 1:5, y = c(0,1,0,1,1))

p1 <- ggplot(testdata, aes(x = x, y = y))+
  geom_point()

p1 + scale_y_continuous(breaks = int_breaks)
p1 + scale_y_continuous(breaks =  int_breaks_rounded) 
```

两者都将使用初始问题中提供的数据。

**说明为什么需要舍入**

```
pretty(c(0,1.05),5)
#> [1] 0.0 0.2 0.4 0.6 0.8 1.0 1.2
identical(pretty(c(0,1.05),5)[6],1)
#> [1] FALSE 
```

# google-maps - 黑莓应用程序：放置标记以获取纬度和经度

> ID：15622002
> 
> 赞同：2
> 
> 时间：2013-03-25T18:23:31.407
> 
> 标签：google-maps, blackberry

我想在我的黑莓应用程序上有一个页面，用户可以在其中将标记放在地图上（最有可能是谷歌地图），并且将检索标记的坐标（纬度和经度）。

我已经查看了[Google Static Maps API](https://developers.google.com/maps/documentation/staticmaps/)，但这会返回一个图像，没有用于放置标记和从 Google 获取坐标的选项。

我还研究了从像素位置获取静态地图上一个点的坐标[看这里](http://www.physicsforums.com/showthread.php?t=455491)，但这非常复杂，而且黑莓手机的不同屏幕尺寸都需要不同的计算。

我想做的事情似乎很容易[在浏览器](https://stackoverflow.com/questions/1726049/how-do-you-click-on-a-map-and-have-latitude-and-longitude-fields-in-a-form-popul)中使用 Google Javascript API 以及适用于 iOS 或 Android 的 Google Maps 完成，但没有返回可点击地图的 Web 服务。

编辑：我正在为 Blackberry OS 4.5 版或 5.0 版（如有必要）开发应用程序。

任何帮助表示赞赏。

谢谢，

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-05T13:08:53.853

1.  试试这个地图代码作为 hml 文件
2.  调用 html 文件到 qml 使用`Webview{}`

**水滴制造者**

```
var marker=new google.maps.Marker({
      position:myCenter,
      }); 
```

* * *

**谷歌地图代码**

```
<!DOCTYPE html>
<html>
<head>
<script
src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false">
</script>

<script>
var myCenter=new google.maps.LatLng(13.052414,80.250825);

function initialize()
{
var mapProp = {
  center:myCenter,
  zoom:12,
  mapTypeId:google.maps.MapTypeId.ROADMAP
  };

var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);

var marker=new google.maps.Marker({
  position:myCenter,
  });

marker.setMap(map);
}

google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>

<body>
<div id="googleMap" style="width:500px;height:380px;"></div>
</body>
</html> 
```

# php - 在 codeigniter 中通过 AJAX 请求数据

> ID：15622007
> 
> 赞同：1
> 
> 时间：2013-03-25T18:23:48.400
> 
> 标签：php, ajax, codeigniter

codeigniter MVC 如何与 AJAX 一起工作？

更具体地说，允许将数据发送到模型，然后返回视图的最基本 AJAX 功能是什么？您能否深入解释其中涉及的大部分组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:23:48.400

作为 PHP/JS/Codeigniter 和一般 Web 开发的新手，了解 AJAX 背后的概念以及它如何与 codeigniter 连接是让我头疼的事情之一。

SO和其他教程网站上的大多数答案似乎都来自经验丰富的人的观点，外行人没有多大意义。

因此，我决定做一个非常“基本”的答案，希望能帮助大多数试图理解这段代码如何以及为什么工作的新手。请记住，这应该是一个非常基本的解释。随意编辑，但尽量保持简单且没有行话。

我不打算深入了解有关定义的详细信息，因为您可以通过 google 做到这一点。我将从第一步开始，即 javascript。

在您的页面上，您需要为实际的 AJAX 找到一个位置。确保已加载 JQUERY。有关这方面的更多信息，请谷歌“Jquery”，并尽快加载库。

对于这种情况，我们将直接将脚本添加到 HTML 中，因为它更容易。或者，您可以像加载样式表一样加载外部 JS 脚本。

HTML

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<meta property="og:image" content="<?php echo base_url()?>img/logo/logo-big.jpg"/> 
<!--[if lt IE 10]>You are living in the past...Upgrade you Browser!! OMFG (google chrome/fire fox)<![endif]-->
<html lang="en">
    <head>
    <script src="/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="1.8.21/jquery-ui.min.js"></script>
    <link href="<?php echo base_url()?>css/account.css" rel="stylesheet" type="text/css"  
</head>
<body>
<div class="ajaxContainer">
    <form id="ajaxForm" method="get">
        <input type="text" id="ajax_input" name="q" placeholder="Type Here"/>
        <input type="submit" id="ajax_submit" value="" />
    </form>
</div>
</body> 
```

在 HTML 中，添加以下脚本（在任何地方，尽管我通常将其添加在顶部）：

```
<script>
$('.ajaxContainer').delegate('#ajaxForm', 'submit', function() {
    $.ajax({
        var submitdata = $('#ajax_input').val();
        type: "POST",
        url: '/ajax/getdata',
        dataType: 'json', 
        data: { submitdata: submitdata },
        success: function(data){
            $('#ajax').html(data['content']);
        }
    });  
    return false;
});
</script> 
```

至于解释：

1`$('.ajaxContainer').delegate('#ajaxForm', 'submit', function() {`

我使用 jqueries`delegate`函数来获取提交点击。很简单。它扫描指定 div/class ( `.ajaxContainer`) 中的所有 ids/classes。

2`$.ajax({`

这就是魔术开始的地方。

3`var submitdata = $('#ajax_input').val();`

在这里，您将简单地“获取”要在控制器/模型中使用的数据。这不是必需的，但它肯定有助于解释。在这里，我们将其中的值`#ajax_input`添加到 javascript 变量`submitdata`中以供以后使用。

4`type: "POST",`

希望您熟悉 post/get 和典型的 html 表单提交。在此示例中，我们指定 POST 来提交数据。如果需要，您可以更改为 GET。玩弄它。

注意每个部分是如何由一个`,`不太复杂的，只是需要注意的东西来分隔。实际上，您可以在此代码中添加许多其他内容。查看 jquery AJAX 文档以获取更多信息并进行尝试。[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

5 `url: '/ajax/getdata,`

这是您正在调用的控制器。稍后我会详细解释，但是，您想在`ajax`其中创建和控制器以及一个名为`getdata`. 同样，您只是将 ajax 指向一个 URL。理论上，您可以通过在地址栏中键入来手动访问该页面。将数据传递给该控制器后，您就可以使用 PHP/codeigniter，并且离成功执行 AJAX 调用更近了一步。

6

```
dataType: 'json', 
data: { submitdata: submitdata }, 
```

指定您希望返回的数据类型`dataType`。

`data:`将 POSTED 数据发送到您的控制器，以便在您的模型中提取和使用。第一个`submitdata:`是我们之前创建的变量，第二个代表您将在控制器中搜索的名称。

此时，我们将转到控制器。如果您还记得，我们将 AJAX 调用定向到`url:`-`/ajax/getdata,`

我提到创建一个反映该 URL 的控制器/函数。这是它的样子：

```
<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Ajax extends CI_Controller
{
    function __construct()
    {
        parent::__construct();
        $this->load->model('logic_model');
    }

    public function getdata()
    {
        //First, grab the data being passed via AJAX through post
        $submitteddata = $this->input->post('submitdata');
        //Then send that data to your model to do whatever you want.
        $data['content'] = $this->logic_model->dosomething($submitteddata);
        // you need to echo the data.  json_encode turns an array into a JSON formatted string.  Without this, you will not receive a success, and you lose sir, goodday. 
        echo json_encode($data);
    }
} 
```

还有我们的模型，又名：`logic_model`->

public function dosomething(submitteddata) { return "Success!" }

它返回`Success!`没有将反馈到控制器，`$data['content']`然后将被回显。

我们现在返回到 javascript，它会检查发生的所有事情并执行`success:`or`failure:`函数（有关失败的更多信息，请阅读文档）。

7

```
success: function(data){
    alert(data['content']);
} 
```

可以看到，函数中包含参数，`data`这个代表我们在ajax控制器中回显的JSON。它就像一个数组一样工作。如果成功，它应该提醒返回的字符串“成功！”

它就这么简单。显然，随着您的任务发生变化，一些步骤也会发生变化，但它通常只会扩展上述场景。

希望人们发现这对那些还不是很擅长 PHP/AJAX 但已经走了很长一段路的人有所帮助。

# asp.net-mvc - 我需要为 MVC4 中的每个视图创建一个模型

> ID：15622010
> 
> 赞同：0
> 
> 时间：2013-03-25T18:23:58.597
> 
> 标签：asp.net-mvc, asp.net-mvc-4

实际上我是 MVC4 的新手，我的老板想将旧的 asp.net webform 更改为 MVC4。我有一些问题。一个是每个视图是否需要创建单独的模型？例如，在登录页面，用户只需输入他们的姓名和密码并提交。因此，为了接收这些名称和密码，我需要为该名称和密码创建一个模型，即一个具有两个类成员名称和密码的身份验证类。

或者有没有更好的方法将旧的转移到 MVC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T10:42:31.343

你所说的是一个*视图模型*——一个代表你的视图/表单的类。此类的实例将作为参数传递给您的`Login`操作，并将包含用户名和密码。您通常会在视图之后命名您的视图模型类，例如。`LoginViewModel`.

这是创建 MVC 应用程序的公认方式。

# c# - 无法检索 Microsoft Access 自动编号值

> ID：15622011
> 
> 赞同：0
> 
> 时间：2013-03-25T18:23:59.937
> 
> 标签：c#, sql-server, ms-access

访问 2003

VS 2010 C#

正如主题标题所说，我对此有疑问。它正在创建一个新字段来打印日期和时间，它应该在当前 ID 中标记日期和时间。我也尝试过 UPDATE 命令参数但没有成功。

我有一种不同的方法（btnloggedIn），它可以保存用户名、登录日期和登录时间。这可以正常工作。我创建了另一种我遇到问题的方法 (btnLoggedOut)。目的是保存用户注销时的注销日期和注销时间，在登录时创建自动 ID 的 Access 的来列中。

表名 - LoginTable

>

```
FieldName   Data Type
UserName    Text
Password    Text 
```

表名 - LoginLogTable

```
 FieldName     Data Type

 ID            AutoNumber
 UserName      Text
 LoggedInDate  Date/Time
 LoggedInTime  Date/Time
 LoggedOutDate Date/Time
 LoggedOutTime Date/Time 
```

ID是PK。它的一对多关系。登录的用户可以有许多关于日期和时间详细信息的详细信息

如果有人可以在这里帮助我，我将不胜感激。

```
 private void btnLogOut_Click(object sender, EventArgs e)
    {
        OleDbCommand cmd = new OleDbCommand();
        cmd.CommandType = CommandType.Text;

       cmd.CommandText = " UPDATE [LoginLogTable] SET [LoggedOutDate] = ?, [LoggedOutTime] = ?  
       WHERE ID = ?";

        cmd.Parameters.AddWithValue("@LoggedOutDate", DateTime.Now.ToShortDateString());
        cmd.Parameters.AddWithValue("@LoggedOutTime", DateTime.Now.ToString("HH:mm"));
        cmd.Connection = myCon;
        myCon.Open();
        cmd.ExecuteNonQuery();
            Close();
   } 
```

这是 btnLogin 方法的部分代码...

```
 OleDbCommand cmd = new OleDbCommand();
        cmd.CommandType = CommandType.Text;

        cmd.CommandText = "INSERT INTO LoginLogTable (UserName, LoggedInDate, LoggedInTime) VALUES (@UserName, @LoggedInDate, @LoggedInTime)";

        cmd.Parameters.AddWithValue("@UserName", txtUserName.Text);
        cmd.Parameters.AddWithValue("@LoggedInDate", DateTime.Now.ToShortDateString());
        cmd.Parameters.AddWithValue("@LoggedInTime", DateTime.Now.ToString("HH:mm"));
        cmd.Connection = myCon;
        myCon.Open();
        cmd.ExecuteNonQuery();
        myCon.Close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:58:45.150

`SELECT @@IDENTITY`如果您在用户单击“注销”按钮时执行查询，您可能不会得到您希望的值。`SELECT @@IDENTITY`旨在在`INSERT`创建记录之后立即调用（在这种情况下，当用户登录*时*）。然后，您可以将该值隐藏在您的应用程序中，并在用户注销时使用它来选择相同的记录。

如果您的应用程序插入任何其他记录（在其他表中）导致创建新的身份（也称为“自动编号”）值，那么将返回*这些*`SELECT @@IDENTITY`值中的最新值。因此，只需在用户登录时获取该值并将其保存以供用户再次注销时使用。*`@@IDENTITY`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:55:24.983

通常，这样做的方式是：

1.  创建新的登录记录。
2.  通过运行一个新的选择来获取其自动生成的记录 ID，该选择要求该特定用户的最新登录条目。您可以降序排序以保证它是记录集中的第一条记录。
3.  使用该记录 ID 来指定您想要更新的登录记录，`WHERE ID = ?`并使用记录 ID 填写 ID 值。

当您不知道自动生成的主记录 ID 是什么时，这是一种非常典型的数据库记录创建模式。您创建新记录，在记录 ID 中读回它以获取其自动生成的主键 ID 值，然后从那时起使用记录 ID 来引用它。*

# sql - 添加外键关系危险吗？

> ID：15622013
> 
> 赞同：-1
> 
> 时间：2013-03-25T18:24:06.840
> 
> 标签：sql, database

作为程序员，添加对对象的引用非常安全，但添加外键关系（我认为）非常危险。通过添加 FK 关系，必须更新从该外部表中删除行的所有查询，以在实际删除该行之前正确删除与该行关联的外键。您如何搜索从该外部表中删除一行的所有查询？这些查询可能隐藏在代码和存储过程中。这是维护噩梦的真实例子吗？这个问题有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:57:04.000

我不会这么说（以确认其他人提到的内容） - 这通常是通过级联删除来处理的。提供你想要的那种方式 - 或者通过仔细的*程序*来清理背后的东西。

更大的系统是您可以看到更多的“程序”和更少的“自动化”（即级联删除）。对于较大的设置 - DBA-s 通常更喜欢在数据库维护阶段处理它。很多时候，不允许通过中间件应用程序代码删除记录——而只是简单地标记为“已删除”或不活动——并稍后根据组织中的数据库例程和程序（存档等）进行处理.

除非你有一个非常大的代码库，否则这不是一个大问题。此外，通常大多数 Db 代码都经过一些可以轻松遍历的 DAL 层。或者，您还可以查询系统表以获取所有关系和“依赖项”，并且为此类代码维护编写了许多例程（在“围栏”的两侧）。并不是说这不是一个“问题”，只是与正常的 Db 工作没有什么不同——还有比这更糟糕的事情。

`So, I wouldn't lose my sleep over that`. 使用“太多”的参照完整性约束（性能、维护）还有其他问题——但这在 DBA-s（以及一般的 Db 专业人士）之间通常是一个非常有争议的问题，所以我不会深入探讨:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:26:50.827

你的说法根本不正确。建立外键关系时，可以将级联属性设置为`cascade delete`. 完成后，删除父记录时将删除子记录，确保没有记录是孤立的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:27:25.880

如果您使用正确的 ORM 解决方案，正确配置 FK 和 PK，并启用级联删除，您应该没有任何问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T19:45:39.580

你不应该从一开始就设计一个没有外键的关系数据库。这是随着时间推移数据完整性较差的保证。

您可以按照其他人的建议添加代码并使用级联删除，但这通常也是错误的答案。有时您真的希望停止删除，因为您有子记录。例如，假设您有客户和订单。如果您删除有订单的客户，那么您将丢失订单的财务记录，这是一场灾难。相反，您希望应用程序收到一条错误消息，指出该客户的订单存在。进一步的级联删除可能会突然让您删除数百万条子记录，从而在发生巨额交易时锁定您的数据库。这是一种危险的做法，应该很少（如果有的话）在生产数据库中使用。

添加 FK（如果有关系，则需要），然后搜索从该表中删除的代码并进行适当调整。考虑软删除是否不是更好的选择。在这里您将记录标记为已删除或非活动，因此它不再显示为数据输入选项，但您仍然可以看到现有记录。同样，您可能需要相当严格地调整您的数据库代码才能正确实现这一点。从一开始就设计糟糕的数据库没有简单的解决方法。

如果您认为您将拥有许多子记录并且确实想要删除它们，那么软删除也是一个不错的选择。这样，您可以标记记录，使其不再显示在应用程序中，并使用在非高峰时间运行的作业批量删除记录。

如果您要添加新表并添加 FK，则处理起来肯定更容易，因为您会在编写任何代码之前创建表。

# mysql - 这是 MySQL 查询解析中的错误吗？

> ID：15622014
> 
> 赞同：4
> 
> 时间：2013-03-25T18:24:11.933
> 
> 标签：mysql

我正在运行一些查询，并遇到了我认为看起来像 MySQL 错误的东西。我运行了以下查询：

```
select s.id, a.name as a_name, s.label, st.name as st_name,
-- substr(f.name FROM 1 FOR locate('cl', f.name)-2),
-- substr(f.name FROM locate('cl', f.name)-2 FOR 1),
substr(f.name FROM locate('cl', f.name)),
count(1)
from table_sf sf,
table_f f,
table_s s,
table_a a,
table_st st
where f.id = sf.f_id
and s.id = sf.s_id
and s.a_id = a.id
and s.st_id = st.id
group by 1, 2, 3, 4, 5
having count(1) != 2; 
```

默认情况下，当您没有在计算字段上指定列名时，MySQL 会分配列名。通常，它只是字段的完整“公式”，例如，`count(1)`上面查询中的最后一个字段。但是，似乎在查询中添加注释会使 MySQL 关闭。结果是正确的，但是字段名是完全错误的。这些是我得到的列标题：

```
 id    name         label         name       -- substr(f.name FROM 1 FOR locate('cl', f.name)-2),       count(1) 
```

请注意，第 5 列的名称是**第一个**评论，甚至不是相邻的评论。它确实认识到有两个注释，因为它只将第一个注释指定为下一个计算字段的列名，而没有别名。这是预期的行为吗？或者这是一个 MySQL 错误？我正在运行 MySQL 5.1.63，在 OS X 上使用 SequelPro 作为客户端。

**更新：** 还在 MySQL 5.4.3 安装上尝试过，该字段在那里正确显示。也许这是 5.1.x 代码库中的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T04:55:47.150

所以，做了一些研究，似乎我找到了原来的错误。前段时间在 5.0 中被报道过，并且只针对 5.2 进行修复。

[http://bugs.mysql.com/bug.php?id=25224](http://bugs.mysql.com/bug.php?id=25224)

所以，如果你运行 MySQL 5.1.x，你会遇到这个问题。MySQL 的反应似乎只是升级到更新的版本。

# php - 使用 AJAX 发布表单时遇到问题

> ID：15622016
> 
> 赞同：0
> 
> 时间：2013-03-25T18:24:18.747
> 
> 标签：php, javascript, jquery, ajax

**编辑 - 信息似乎正在发布，但在 form_data.php 上似乎没有检索发布的值**

这是AJAX

```
<head>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script>

    $("#submit_boxes").submit(function() { return false; });
    $('input[type=submit]').click(function() {
        $.ajax({
              type: 'POST',
              url: 'form_data.php',
              data: $(this).serialize(),
              success: function(data) {
                $('#view_inputs').html(data); //view_inputs contains a PHP generated table with data that is processed from the post. Is this doable or does it have to be javascript?
       });
       return false;
        });
   };
  </script>
</head> 
```

这是我要提交的表格

```
 <form action="#" id = "submit_boxes">
        <input type= "submit" name="submit_value"/>
        <input type="textbox" name="new_input">
 </form> 
```

这是获取发布到的信息的 form_data 页面

```
<?php
    if($_POST['new_input']){
      echo "submitted";
      $value = $_POST['new_input'];
      $add_to_box = new dynamic_box();
      array_push($add_to_box->box_values,$value);
      print_r($add_to_box->box_values);
   }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:59:04.917

您的表单正在提交，因为您有错误阻止阻止表单提交的代码运行。具体`dataType: dataType`和`this.html(data)`。首先`dataType`是`undefined`，如果您不知道要设置什么数据类型，则将其排除在外。其次`this`是指没有`html`方法的表单元素，您可能的意思是`$(this).html(data)`虽然这不太可能是您想要的，但很可能是`$(this).serialize()`您想要的。所以你的代码应该看起来像

```
$('form#submit_boxes').submit(function() {
    $.ajax({
        type: 'POST',
        url: 'form_data.php',
        data: $(this).serialize(),
        success: success
    })
    return false;
}); 
```

此外，如果您必须在表单提交处理程序中调试 ajax，您要做的第一件事就是阻止表单提交（返回 false 只能在最后完成），这样您就可以看到发生了什么错误。

```
$('form#submit_boxes').submit(function(event) {
    event.preventDefault();
    ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:42:11.400

处理它的一种方法...

取消通常的表单提交：

```
$("#submit_boxes").submit(function() { return false; }); 
```

然后为您的按钮分配一个点击处理程序：

```
$('input[type=submit]').click(function() {
            $.ajax({
                  type: 'POST',
                  url: 'form_data.php',
                  data: this.html(data),
                  success: success,
                  dataType: dataType
           })
           return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:31:24.783

可以使用 jQuery 的`.serialize()`方法发送表单数据

下面的一些不错的链接让您了解

[jquery form.serialize等参数](https://stackoverflow.com/questions/10398783/jquery-form-serialize-and-other-parameters)

[http://www.tutorialspoint.com/jquery/ajax-serialize.htm](http://www.tutorialspoint.com/jquery/ajax-serialize.htm)

[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

# c# - INSERT INTO 命令不起作用

> ID：15622017
> 
> 赞同：1
> 
> 时间：2013-03-25T18:24:20.523
> 
> 标签：c#, sql, sql-server, insert, sql-server-ce

在我开始之前，我会让你知道，在我考虑自己发布问题之前，我已经尝试了以前问题和其他网站上已经建议的所有内容。碰巧的是，似乎没有任何效果，我对此感到厌烦。

作为一些背景信息，这是针对我的 Computing A2 项目的，所以我现在有点卡住了 - 即我不能理想地改变我的代码负载。

无论如何，关于这个问题......我在我的代码中使用 SQLCe 从各种表中读取并写入一个。到目前为止，从表中读取的代码工作正常，所以首先解决任何连接问题。我正在努力的代码如下：

```
 string connectionString = Properties.Settings.Default.BookingSystemDatabaseConnectionString;
        using (SqlCeConnection myConnection = new SqlCeConnection(connectionString))
        {
            myConnection.Open();
            try
            {
                string commandStr = "INSERT INTO bookings(username, room, time) VALUES(@username, @room, @time)";
                SqlCeCommand myCommand = new SqlCeCommand(commandStr);
                //Passes parameters into SQL command.
                myCommand.Parameters.AddWithValue("username", StaticUser.StudentUser.username);
                myCommand.Parameters.AddWithValue("room", roomBox.Text);
                myCommand.Parameters.AddWithValue("time", timeBox.Text);
                //Executes SQL command. Returns the number of affected rows (unecessary for my purposes; a bi-product if you will).
                myCommand.ExecuteNonQuery();
            }
            catch
            {
                System.Windows.Forms.MessageBox.Show("Could not write new booking to database. This is likely because the database cannot be reached.", "Error");
                Program.AccessError = true;
            }
            myConnection.Close();
        } 
```

这只是我试图解决我遇到的问题的众多方法之一。我也探索过：

```
myCommand.Parameters.Add(new SqlCeParameter("username", StaticUser.StudentUser.username)); 
```

传递参数......和另一种现在让我逃避的方法（我认为使用“.Value = StaticUser.StudentUser.username”）。此外，我尝试使用命令的“使用”语句来保存我自己关闭连接（我最终可能会使用使用“使用”的解决方案）。最后（尽管这不是按时间顺序排列的回忆），我尝试了：

```
SqlCeCommand myCommand = new SqlCeCommand("INSERT INTO bookings(username, room, time) VALUES(@username, @room, @time)", myConnection) 
```

再次，当然，无济于事。

为了突出我遇到的问题的实际症状：代码似乎运行良好；单步执行我在上面粘贴的完整方法表明没有发现任何错误（当然，消息框没有出现——我后来意识到单步执行可以说是一个不必要的过程），在我提到的其他方法中，同样的事情发生。那么，问题是表“bookings”实际上并没有被更新。

所以，我的问题，为什么？

* * *

我没有做明显的检查并检查 Debug 文件夹以获取更新的数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:45:41.373

在 bin/debug 文件夹中查找数据库文件的副本。在连接字符串中使用完整路径，最好不要在项目中包含 sdf 文件（或至少将构建操作设置为无）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:48:42.643

我认为您没有为命令 try 定义连接

```
mycommand.connection = connectiostring; 
```

# macos - 当我不需要多文档支持时使用 NSDocument？

> ID：15622020
> 
> 赞同：0
> 
> 时间：2013-03-25T18:24:39.670
> 
> 标签：macos, cocoa, core-data, nsdocument

我喜欢 NSDocument，因为当与 Core Data 模型结合使用时，它可以免费为我提供一个包含持久数据的应用程序。但我知道，对于我的特定项目，我只会处理一个“文档”。我不需要文档架构堆栈附带的多文档支持。对我来说仍然使用 NSDocument 是否有意义，但是在我发现它的地方破坏了多文档支持？或者有没有更好的方法来获得我正在寻找的持久魔法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T20:05:40.227

如果您不创建基于文档的应用程序，那么 Xcode 中有一个默认项目模板，它可以在没有文档堆栈的情况下为您提供核心数据。它将自动为您创建一个实现核心数据持久层的应用程序委托。

# visual-studio-2012 - 如何在执行后停止 Visual Studio 2012 关闭控制台窗口？

> ID：15622023
> 
> 赞同：3
> 
> 时间：2013-03-25T18:24:43.870
> 
> 标签：visual-studio-2012

如何在不使用的情况下阻止 Visual Studio 2012 在执行后关闭控制台窗口`system("pause");`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:24:43.870

右键单击您的项目-> 属性-> 配置属性-> 链接器-> 系统。

然后`Console (/SUBSYSTEM:CONSOLE)`在“子系统”选项中选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-24T06:07:07.507

只需单击 VS 代码窗口的最左侧即可放置断点（通常与“Return 0;”相反或更高）。

# python - 解析 XML 文件获取 UnicodeEncodeError (ElementTree) / ValueError (lxml)

> ID：15622027
> 
> 赞同：5
> 
> 时间：2013-03-25T18:24:46.513
> 
> 标签：python, xml, python-requests, lxml, elementtree

[我向CareerBuilder API](http://api.careerbuilder.com/)发送 GET 请求：

```
import requests

url = "http://api.careerbuilder.com/v1/jobsearch"
payload = {'DeveloperKey': 'MY_DEVLOPER_KEY',
           'JobTitle': 'Biologist'}
r = requests.get(url, params=payload)
xml = r.text 
```

并取回一个看起来像[这样](http://pastebin.com/jwXdYhMf)的 XML 。但是，我无法解析它。

使用任一`lxml`

```
>>> from lxml import etree
>>> print etree.fromstring(xml)

Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    print etree.fromstring(xml)
  File "lxml.etree.pyx", line 2992, in lxml.etree.fromstring (src\lxml\lxml.etree.c:62311)
  File "parser.pxi", line 1585, in lxml.etree._parseMemoryDocument (src\lxml\lxml.etree.c:91625)
ValueError: Unicode strings with encoding declaration are not supported. 
```

或者`ElementTree:`

```
Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    print ET.fromstring(xml)
  File "C:\Python27\lib\xml\etree\ElementTree.py", line 1301, in XML
    parser.feed(text)
  File "C:\Python27\lib\xml\etree\ElementTree.py", line 1641, in feed
    self._parser.Parse(data, 0)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 3717: ordinal not in range(128) 
```

因此，即使 XML 文件以

```
<?xml version="1.0" encoding="UTF-8"?> 
```

我的印象是它包含不允许的字符。如何使用`lxml`or解析此文件`ElementTree`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-25T18:27:00.370

您正在使用*解码*后的unicode 值。改用[`r.raw`原始响应数据](https://requests.readthedocs.io/en/latest/user/quickstart/#raw-response-content)：

```
r = requests.get(url, params=payload, stream=True)
r.raw.decode_content = True
etree.parse(r.raw) 
```

它将直接从响应中读取数据；请注意`stream=True`选项`.get()`。

设置该`r.raw.decode_content = True`标志可确保原始套接字将为您提供解压缩的内容，即使响应是 gzip 或 deflate 压缩。

您不必*流*式传输响应；对于较小的 XML 文档，可以使用[`response.content`属性](https://requests.readthedocs.io/en/latest/api/#requests.Response.content)，它是未解码的响应正文：

```
r = requests.get(url, params=payload)
xml = etree.fromstring(r.content) 
```

XML 解析器总是期望字节作为输入，因为 XML 格式本身决定了解析器如何将这些字节解码为 Unicode 文本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-14T06:35:08.970

## Correction!

See below how I got it all wrong. Basically, when we use the method `.text` then the result is a unicode encoded string. Using it raises the following exception in lxml

> ValueError: Unicode strings with encoding declaration are not supported. Please use bytes input or XML fragments without declaration.

Which basically means that @martijn-pieters was right, we must use the raw response as returned by `.content`

### Incorrect answer (but might be interesting to someone)

For whoever is interested. I believe the reason this error occurs is probably an invalid guess taken by requests as explained in [`Response.text` documentation](http://docs.python-requests.org/en/latest/api/#requests.Response.text):

> Content of the response, in unicode.
> 
> If Response.encoding is None, encoding will be guessed using chardet.
> 
> The encoding of the response content is determined based solely on HTTP headers, following RFC 2616 to the letter. If you can take advantage of non-HTTP knowledge to make a better guess at the encoding, you should set r.encoding appropriately before accessing this property.

So, following this, one could also make sure requests' `r.text` encodes the response content correctly by explicitly setting the encoding with `r.encoding = 'UTF-8'`

This approach adds another validation that the received response is indeed in the correct encoding prior to parsing it with lxml.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-02T11:55:07.487

了解这个问题已经得到了答案，我在 Python3 上遇到了类似的问题，它在 Python2 上运行良好。我的解决方案是：`str_xml.encode()`然后`xml = etree.fromstring(str_xml)`是标签和属性的解析和提取。

# java - 在 xstream 中省略 xml 声明

> ID：15622029
> 
> 赞同：2
> 
> 时间：2013-03-25T18:24:54.960
> 
> 标签：java, xml, xstream

我想使用 xstream 将内容附加到 xml，但每次运行时都使用 xstream.toXml(obj,writer)，它正在向内容添加 xml 声明，我们可以在 xstream 中省略 xml 声明吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-25T09:02:02.860

在 XStream 团队解决问题的同时，您可以做一个解决方法。覆盖`createStaxWriter`in `StaxDriver`：

```
 StaxDriver driver = new StaxDriver() {
        @Override
        public StaxWriter createStaxWriter(XMLStreamWriter out) throws XMLStreamException {
            //the boolean parameter controls the production of XML declaration
            return createStaxWriter(out, false);  
        }
    };
    XStream xstream = new XStream(driver); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T16:11:48.010

我刚遇到这个问题（使用 XStream 1.4.4）。如果您使用 StaxDriver 而不是 JAXP DOM 一或默认 XPP3 一，则会出现问题。所以要么切换到：

```
XStream xstream = new XStream(); 
```

（在类路径中使用 XPP3 和 xmlpull JAR）或

```
XStream xstream = new XStream(new DomDriver()); 
```

代替

```
XStream xstream = new XStream(new StaxDriver()); 
```

这可能是 XStream 中的一个（一致性）错误，因为它的[常见问题解答明确指出](http://x-stream.github.io/faq.html#XML)它是用于编写代码片段并且不生成 XML 声明（另请参阅[此问题](https://stackoverflow.com/questions/13063815)）。它没有提供不生产它的方法/设置，因为它永远不应该生产！我会考虑和他们一起提出。

# ruby - 连接拒绝从 Ruby 到 Git

> ID：15622033
> 
> 赞同：2
> 
> 时间：2013-03-25T18:25:07.887
> 
> 标签：ruby, git, gitlab

当我试图将某些东西推送到我的 gitlab 的仓库时，`geosurvey.git`我收到了这个错误：

![在此处输入图像描述](../Images/a55f95038d90296057193d00df4cbab6.png)

```
git@192.168.31.128:geosurvey.git: /usr/local/lib/ruby/1.9.1/net/http.rb:762!in `initialize': Connection refused(2) (Errno:ECONNREFUSED)
  from /usr/local/lib/ruby/1.9.1/net/http.rb:762:in `open'
  from /usr/local/lib/ruby/1.9.1/net/http.rb:762:in `block in connect'
  from /usr/local/lib/ruby/1.9.1/timeout.rb:54:in `timeout'
  from /usr/local/lib/ruby/1.9.1/timeout.rb:99:in `timeout'
  from /usr/local/lib/ruby/1.9.1/net/http.rb:762:in `connect'
  from /usr/local/lib/ruby/1.9.1/net/http.rb:755:in `do_start'
  from /usr/local/lib/ruby/1.9.1/net/http.rb:744:in `start'
  from /home/git/gitlab-shell/lib/gitlab_net.rb:56:in `get'
  from /home/git/gitlab-shell/lib/gitlab_net.rb:17:in `allowed?'
  from /home/git/gitlab-shell/lib/gitlab_shell.rb:51:in `validate_access'
  from /home/git/gitlab-shell/lib/gitlab_shell.rb:21:in `exec'
  from /home/git/gitlab-shell/lib/gitlab_shell.rb:16:in `<main>' 
```

上面的错误是针对此代码的：

```
def connect
      D "opening connection to #{conn_address()}..."
      s = timeout(@open_timeout) { TCPSocket.open(conn_address(), conn_port()) }
      D "opened"
      if use_ssl?
        ssl_parameters = Hash.new
        iv_list = instance_variables
        SSL_ATTRIBUTES.each do |name|
          ivname = "@#{name}".intern
          if iv_list.include?(ivname) and
             value = instance_variable_get(ivname)
            ssl_parameters[name] = value
          end
        end
        @ssl_context = OpenSSL::SSL::SSLContext.new
        @ssl_context.set_params(ssl_parameters)
        s = OpenSSL::SSL::SSLSocket.new(s, @ssl_context)
        s.sync_close = true
end 
```

我的 gitlab.yml 或 /etc/nginx/sites-available/gitlab 可能有问题吗？

谢谢，

* * *

问题是我无法与远程 gitlab 服务器建立 ssh 连接。我的 ssh 端口是 22（默认），我的 gitlab 端口是 3222。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T14:36:09.510

gitlab 的安装指南缺少必须如何配置监听端口。

现在，有了这条线，我可以推送和克隆任何存储库。

```
listen *:80 default_server;         # e.g., listen 192.168.1.1:80; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T07:40:34.150

> 问题是我无法与远程 gitlab 服务器建立 ssh 连接。我的 ssh 端口是 22（默认），我的 gitlab 端口是 3222。

然后你需要确保在使用 ssh Gitlab url 时使用端口 3222。
您可以在配置文件中指定自定义端口号，如在[这个问题](https://stackoverflow.com/a/12668477/6309)中，也在“[使用具有非标准端口的远程存储库](https://stackoverflow.com/a/1558735/6309)”中说明，scp 样式。
或者直接在 ssh url 中指定端口：

```
ssh://[user@]host.xz[:port]/path/to/repo.git/ 
```

# c++ - 在 C++ 中包含变量的“隐形”类

> ID：15622035
> 
> 赞同：0
> 
> 时间：2013-03-25T18:25:10.477
> 
> 标签：c++, class, arduino, wrapper

我目前正在使用两个相同的库来解析 Arduino 中接收到的命令（通过[TCP/IP](http://en.wikipedia.org/wiki/Internet_protocol_suite)和通过串行）。所有不同之处在于传递给解析器的对象类型。

```
//main.cpp
SerCmd sCmd;
EthCmd eCmd;
void setup() {
    sCmd.listen("#",dumpCmd);
    eCmd.listen("#",dumpCmd);
}

void loop() {
    HardwareSerial SerClient = Serial.available();
    EthernetClient EthClient = Server.available();
    eCmd.read(SerClient);
    sCmd.read(EthClient);
}

//SerCmd.h
class SerCmd {
    public:
        void read(HardwareSerial &dataObj);
}

//EthCmd.h
class EthCmd {
    public:
        void read(EthernetClient &dataObj);
} 
```

很明显：

*   这两个对象几乎相同，它们共享许多常用方法（sCmd、eCd）。
*   这两个类（SerCmd、EthCmd）可以用一个类替换以减小[草图](http://www.arduino.cc/en/Tutorial/Sketch)大小。

如何创建一个可以传递给`read()`方法的“隐形”类，同时仍然处理下面的两个不同对象中的任何一个？

在这种情况下使用的常见做法是什么？

到目前为止，我能够编译以下代码，但无法初始化任何方法：

```
class Communication {};
HardwareSerial *SerClient;
Communication *Comm;

void setup() {
    Comm = (Communication*) SerClient;
    //Comm.begin(9600);
    //Error: request for member 'print' in 'Comm',
    //which is of non-class type 'Communication*'
} 
```

# android - 基于片段的viewpager中的listview

> ID：15622036
> 
> 赞同：0
> 
> 时间：2013-03-25T18:25:10.467
> 
> 标签：android, android-listview, android-fragments, android-viewpager

我正在使用基于片段的浏览器，它的效果非常好。我的 viewpager 在每个页面上显示一个按钮（因为它是我放入每个片段的布局 xml 文件中的）。现在我想在每个页面而不是按钮上有一个包含不同数据的列表视图。这就是为什么我首先选择使用片段。问题是我没有找到将列表视图集成到我的查看器中的方法。请问有什么想法吗？

这是我的代码：

MainActivity.java

```
 public class MainActivity extends FragmentActivity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        List<Fragment> fragments = new Vector<Fragment>();
        fragments.add(Fragment.instantiate(this, FragmentA.class.getName()));
        fragments.add(Fragment.instantiate(this, FragmentB.class.getName()));
        fragments.add(Fragment.instantiate(this, FragmentC.class.getName()));
        ViewPagerAdapter adapter = new ViewPagerAdapter(super.getSupportFragmentManager(), fragments);
        ViewPager pager = (ViewPager)super.findViewById(R.id.viewpager);
        pager.setAdapter(adapter);
        pager.setOffscreenPageLimit(2);
        pager.setCurrentItem(1);
    }
} 
```

main.xml 声明 viewpager

```
<?xml version="1.0" encoding="utf-8"?>
<android.support.v4.view.ViewPager
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/viewpager"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <android.support.v4.view.PagerTabStrip
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="top" />
</android.support.v4.view.ViewPager> 
```

ViewPagerAdapter.java

```
public class ViewPagerAdapter extends FragmentPagerAdapter {

    private List<Fragment> fragments;
    private static String[] titles = new String[] {"A", "B", "C"};

    public ViewPagerAdapter(FragmentManager fm, List<Fragment> fragments) {
        super(fm);
        this.fragments = fragments;
    }

    @Override
    public Fragment getItem(int position) {
        return this.fragments.get(position);
    }

    @Override
    public int getCount() {
        return this.fragments.size();
    }

    @Override
    public String getPageTitle( int position )
    {
        return titles[ position ];
    }
} 
```

片段A.java

```
 public class FragmentA extends Fragment {
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.fragment_a, container, false);
    }
} 
```

fragment_a.xml 只包含一个按钮

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <Button android:text="@string/a"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-14T20:34:22.270

您可以用 ListView 替换 xml 中的按钮（或保留两者）。

在您的片段类中，创建一个 arrayAdapter 并将其设置为列表视图

```
mListView = (ListView) rootView.findViewById(R.id.lv_list);
mListView.setAdapter(mAdapter); 
```

您可以创建自定义适配器并在 getView 函数中设置您需要的任何内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:16:59.503

查看[ListFragments](http://developer.android.com/reference/android/app/ListFragment.html)和[官方 ListView 教程](http://developer.android.com/guide/topics/ui/layout/listview.html)。本教程使用 ListActivity，但您基本上可以用 ListFragment 替换它。

# python - boto dynamodb：为什么我得到“'Layer2'对象没有属性'new_batch_write_list'”？

> ID：15622037
> 
> 赞同：1
> 
> 时间：2013-03-25T18:25:10.573
> 
> 标签：python, boto, amazon-dynamodb

[我正在尝试使用此处](https://gist.github.com/griggheo/2698152)的代码示例将项目列表批量写入数据库

这是我的脚本的代码摘录：

```
import boto

conn = boto.connect_dynamodb(...)
main_table = conn.get_table(...)

do_batch_write(items,conn,main_table)

def do_batch_write(items,conn,table):
       batch_list = conn.new_batch_write_list() 
```

在最后一行，我收到以下异常：

```
'Layer2' object has no attribute 'new_batch_write_list' 
```

为什么？我似乎正在执行上述链接下的示例中的内容。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:23:21.500

你用的是什么版本的boto？您链接到的示例似乎对我有用。要找出您正在运行的版本，请尝试启动交互式 Python 会话并执行以下操作：

```
>>> import boto
>>> boto.__version__
'2.8.0-dev'
>>> 
```

你说什么？

# macos - 为什么我的应用程序将二进制文件标记为已隔离？

> ID：15622040
> 
> 赞同：0
> 
> 时间：2013-03-25T18:25:22.717
> 
> 标签：macos, cocoa, sandbox

我的（沙盒）OSX 应用程序正在尝试启动`biber`（LaTeX 的参考书目工具）。但是它无法启动，我收到以下消息，说明应用程序已在 Console.App 中将 biber 标记为已隔离。

```
25/03/2013 16:44:15.000 kernel[0]: exec of /private/var/folders/s1/70f5my9n6wq0_kk7bcxjslhh0000gn/T/com.abc.XYZ/par-64756e63616e737465656c65/cache-ef42c8d5d44e40bdd24828b0ae70de275e379c88/biber denied since it was quarantined by XYZ and not approved by Gatekeeper, qtn-flags was 0x00000002 
```

应用程序调用的任何其他二进制文件都不会发生这种情况。

此应用程序对整个硬盘驱动器都有一个活动的 SSB，因此启动或访问外部文件没有问题。

为什么以及如何将该文件标记为已隔离，以及如何删除隔离以使其能够执行？谢谢你的帮助。

**编辑**如果有帮助，该目录的内容是

*   `biber`
*   `libperl.dylib`

运行 ls -l@eOd 显示它们都具有属性 com.apple.quarantine，但是我不确定是什么将它们复制到该目录中，或者它们如何获得该标志。原始副本不被隔离。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T06:37:50.733

看起来这个“biber”不是从 Mac App Store 或已识别的开发者（使用 Apple 开发者 ID）下载的应用程序。因此，您必须手动允许其启动。
通常有三种方法可以做到这一点：

*   右键单击应用程序，然后从上下文菜单中单击“打开”。会有一个警告，只需点击“打开”。OSX 会记住你的选择，下次它会打开。
*   您可以更改 Gatekeeper 的设置：“系统偏好设置”->“安全和隐私”->“常规”选项卡。解锁以进行更改。在“允许下载的应用程序”部分中选择“任何地方”。**注意**：它会降低安全性，并且会在建议使用第一个解决方案时发出警告。
*   从应用程序中删除“隔离属性”。在终端运行命令中：`xattr -d com.apple.quarantine <your_app>`

我更喜欢最后一个解决方案。所有解决方案都适用于应用程序，但我认为也适用于实用程序。

# android - 调试错误：确认透视切换

> ID：15622041
> 
> 赞同：0
> 
> 时间：2013-03-25T18:25:29.123
> 
> 标签：android, xml, debugging

当我点击按钮添加调试错误

并打开确认透视切换对话框在 dis 行中显示错误“EditText add = (EditText) d1.findViewById(R.id.add);”我的代码有什么错误？

xml页面

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <TextView
        android:id="@+id/TextView01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Question1" >
    </TextView>
    <EditText
        android:id="@+id/question"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="" >
    </EditText>
    <EditText
        android:id="@+id/answer"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="" >
    </EditText>
    <Button
        android:id="@+id/registerques"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="registerques" >
    </Button>
</LinearLayout> 
```

java类在editext行中显示错误

```
package quesansw.the1;

import android.app.Activity;
import android.app.Dialog;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;
import android.widget.EditText;

public class Memo extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        final Dialog d1 = new Dialog(this);
        Window window = d1.getWindow();
        window.setFlags(WindowManager.LayoutParams.FLAG_BLUR_BEHIND,
                WindowManager.LayoutParams.FLAG_BLUR_BEHIND);
        d1.setTitle("Register Questions");
        d1.setContentView(R.layout.memo);
        d1.show();
        Button view1 = (Button) d1.findViewById(R.id.view);
        Button add = (Button) d1.findViewById(R.id.add);
        add.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                EditText add = (EditText) d1.findViewById(R.id.add);
                EditText view = (EditText) d1.findViewById(R.id.view);
                System.out.println(add.toString());
                System.out.println(view.toString());
            }
        });
        view1.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Intent intent = new Intent(getBaseContext(), View.class);
                startActivity(intent);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:44:23.493

代码中的错误可能是您从未定义过 id “add” - 您`@+id/TextView01`在 xml “page”中有（您的意思是文件 - 您必须告诉我们*哪个*文件）但没有`@+id/add`

# c# - 如何通过 USB 为外部设备虚拟创建内存闪存？

> ID：15622043
> 
> 赞同：1
> 
> 时间：2013-03-25T18:25:33.810
> 
> 标签：c#, .net, memory, serial-port, usb

我正在做一个项目，我想通过我的 USB 端口为外部设备制作一个虚拟 USB 闪存，例如，需要用于录制电视频道的存储器的卫星接收器。我想将 PC USB 端口连接到卫星 USB 端口并将文件直接记录到文件中。我在 C#/.NET 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T21:10:06.727

USB 协议通常位于两个不同的设备之间：*主机*和*客户端*。主机说明传输了哪些数据以及何时传输，客户端必须收听。然后有不同的客户端**设备类**。有 USB 可移动媒体、打印机、网络摄像头等。USB otg 略有不同，因为设备可以是客户端或主机，具体取决于另一个设备。例如，当连接到 PC 或主机时，您的手机面包车是客户端，它连接到 USB 记忆棒。

现在有你的卫星接收器。它想成为主人。（你知道当它使用大的 Type-A 插座时）它需要一个可移动的媒体设备，比如 USB 记忆棒。当您连接打印机时，它将不知道如何使用它。与网络适配器或串行端口相同。

> 注意：您不可能实现“通过串行端口的闪存协议”。因为串行端口已经是客户端设备类。此外，USB 和串口之间没有电线兼容性。

由于您的 PC 具有相同的角色并且不会在 USB 连接中充当客户端，因此没有简单的解决方案。（我打赌你已经知道了，嗯？）

即使你有一个像闪存驱动器一样的 PCIexpress 卡，也会有更多的障碍。例如，文件系统并非设计为由两台计算机同时访问。

回到建设性的回答： [受此链接的启发，](http://www.gossamer-threads.com/lists/gentoo/dev/199189)您可以获取一些更高端的微控制器并连接（微型）SD 卡。然后你让它在其 USB 端口上充当闪存驱动器。使用其以太网连接（或 wifi）并通过 samba 提供对（微型）SD 卡的访问。

对于微处理器来说，这是一些非常高端的东西，所以最好不要使用非常便宜的东西。我想到了 RasberryPI A 型（不是 B 型，不能充当 USB 客户端）或 Arduino/Netduino（最强大的）。我找不到即用型设备。

重要的是，与您的 PC 的连接使用某种网络而不是 USB。因为网络协议具有并发性（多台 PC 访问相同的数据），而本地文件系统则没有。

# c# - 选择具有流利的 nhibernate 的列和子类

> ID：15622045
> 
> 赞同：0
> 
> 时间：2013-03-25T18:25:40.407
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-mapping

我有一个类（项目），它代表一个有点大的数据库表。除了一个子类（ProjectUses，它代表另一个与 Project 具有 1:1 关系的数据库表）之外，我只需要检索大约十几个列。我可以使用如下所示的投影很好地获得 Project 对象的单列，但是在检索 Project 对象并填充 ProjectUses 子类时也遇到了问题。谁能指出我正确的方向？

这是我正在使用的存储库代码：

```
public Project GetProjectDebenture(int pkProjectID)
{
    var proj = _session.CreateCriteria(typeof(Project))
                .SetProjection(Projections.ProjectionList()
                    .Add(Projections.Property("pkProjectID"), "pkProjectID")
                    .Add(Projections.Property("ReservePercentage"), "ReservePercentage")
                    .Add(Projections.Property("FundingFeePercentage"), "FundingFeePercentage")
                    .Add(Projections.Property("PackagingFeePercentage"), "PackagingFeePercentage")
                    )
                .SetResultTransformer(Transformers.AliasToBean(typeof(Project)))
                .Add(Restrictions.Eq("pkProjectID", pkProjectID))
                .UniqueResult<Project>();
            return proj;
        }
        return null;
    } 
```

我尝试使用`Projections.Property("ProjectUses")`并`Projections.GroupProperty("ProjectUses")`检索填充的子类，但没有成功。

下面是类和映射定义的[简化]代码

```
// Project class
public partial class Project
{
    public int pkProjectID { get; set; }
    public decimal ReservePercentage { get; set; }
    public decimal FundingFeePercentage { get; set; }
    public decimal PackagingFeePercentage { get; set; }
    public ProjectUses ProjectUses { get; set; }
}

// ProjectUses class
public partial class ProjectUses
{
    public int pkProjectID { get; set; }
    public Project Project { get; set; }
    ...
}

// Project mapping
public class ProjectMap : ClassMap<Project>
{
    public ProjectMap()
    {
        Table(@"Project");
        LazyLoad();
        Id(x => x.pkProjectID)
          .Column("pkProjectID")
          .Not.Nullable()
          .GeneratedBy.Identity();
        ...
        HasOne<ProjectUses>(x => x.ProjectUses)
          .PropertyRef(r => r.Project)
          .Cascade.All();
    }
}
// Project Uses mapping
public class ProjectUsesMap : ClassMap<ProjectUses>
{
    public ProjectUsesMap()
    {
        Table(@"ProjectUses");
        LazyLoad();
        Id(x => x.pkProjectID, "pkProjectID").GeneratedBy.Foreign("Project");
        HasOne<Project>(x => x.Project)
            .Constrained()
            .ForeignKey()
            .Cascade.None();

        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T22:25:50.680

您可以制作一个具有您需要的所有属性的 DTO，`Project`并`ProjectUses`在新 DTO 上进行投影。这具有将视图模型与域模型分离的额外优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:25:15.840

您是否尝试过`.Not.LazyLoad()`在 ProjectMap 类中使用？

# php - ajax提交后php表单中的数据返回为空

> ID：15622048
> 
> 赞同：0
> 
> 时间：2013-03-25T18:25:50.910
> 
> 标签：php, jquery, ajax

我正在尝试通过 ajax 提交一个 php 表单，我的 jquery 代码是

```
$("#editContraForm").submit(function editContra (e) {

        e.preventDefault();

        dataString = $("#editContraForm").serialize();

        $.ajax({
        type: "POST",
        url: "./validations/contraAjax.php",
        data: dataString,
        action : "edit",
        dataType: "text",
        success: function(data) {
            console.debug("success : "+data);
        },
        error : function(error){
            console.debug("erro");
        }
        }); 

    }); 
```

和 php 代码是 (contraAjax.php)

```
if(!isset($_SESSION))
session_start();
include_once '../connect/connectOpen.php';
$action=isset($_REQUEST['action'])?$_REQUEST['action']:'';

if($action=="edit"){
echo 'good';
} 
```

并且调用成功（如 firbug 所示）但控制台打印“成功：”，表示数据为空。这段代码有什么问题，请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:33:23.777

使用 action 作为参数，然后使用**$_POST['action'] 访问它。**

也尝试`var_dump($_POST['action'])`；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:28:01.173

您不应该序列化数据，而是传递一个对象。

请参阅 jQuery 文档：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:18:41.733

要添加操作参数，只需将其连接到数据字符串中。

```
data: dataString + '&action=edit', 
```

# python - pyqt - 在 TableView 中更改行~单元格颜色

> ID：15622053
> 
> 赞同：2
> 
> 时间：2013-03-25T18:26:07.167
> 
> 标签：python, qt, pyqt4, tableview, background-color

我有一个包含三列的 QTableView 第二列是关于数字的，只有三种类型：1、-1 和 0。我想为这三种“类型”的数字（1、-1、0）设置不同的颜色，用不同的颜色为他们的行着色。我该怎么做？

```
 self.tableView = QTableView(self.tabSentimento)
 self.tableView.setGeometry(QRect(550,10,510,700))
 self.tableView.setObjectName(_fromUtf8("TabelaSentimento"))
 self.tableView.setModel(self.model)
 self.tableView.horizontalHeader().setStretchLastSection(True) 
```

obs：我之所以使用`horizontalheader().setStrechLastSection(True)`，是因为我在我的表格视图中打开了一个现有的 csv 文件（使用按钮）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:06:51.397

您必须在模型中定义颜色，而不是在视图中：

```
def data(self, index, role):
    ...
    if role == Qt.BackgroundRole:
        return QBrush(Qt.yellow) 
```

**编辑：** 这是一个工作示例，除了从[http://www.saltycrane.com/blog/2007/06/pyqt-42-qabstracttablemodelqtableview/完全窃取的颜色部分](http://www.saltycrane.com/blog/2007/06/pyqt-42-qabstracttablemodelqtableview/)

```
from PyQt4.QtCore import *
from PyQt4.QtCore import *
from PyQt4.QtGui import *
import sys

my_array = [['00','01','02'],
            ['10','11','12'],
            ['20','21','22']]

def main():
    app = QApplication(sys.argv)
    w = MyWindow()
    w.show()
    sys.exit(app.exec_())

class MyWindow(QTableView):
    def __init__(self, *args):
        QTableView.__init__(self, *args)

        tablemodel = MyTableModel(my_array, self)
        self.setModel(tablemodel)

class MyTableModel(QAbstractTableModel):
    def __init__(self, datain, parent=None, *args):
        QAbstractTableModel.__init__(self, parent, *args)
        self.arraydata = datain

    def rowCount(self, parent):
        return len(self.arraydata)

    def columnCount(self, parent):
        return len(self.arraydata[0])

    def data(self, index, role):
        if not index.isValid():
            return QVariant()
        # vvvv this is the magic part
        elif role == Qt.BackgroundRole:
            if index.row() % 2 == 0:
                return QBrush(Qt.yellow)
            else:
                return QBrush(Qt.red)
        # ^^^^ this is the magic part
        elif role != Qt.DisplayRole:
            return QVariant()
        return QVariant(self.arraydata[index.row()][index.column()])

if __name__ == "__main__":
    main() 
```

# sql - 你如何处理一个有两个父母选择的孩子

> ID：15622061
> 
> 赞同：0
> 
> 时间：2013-03-25T18:26:38.483
> 
> 标签：sql, sql-server

我们正在创建一个活动构建器，我正在努力寻找一种好方法来处理一个不同类型的父母。

我们有两个表类别和活动。类别有 id 和 name 活动有 id 和 parentid

活动 parentid 可以是类别的 id 或另一个活动的 id。一个类别有活动，每个活动都可以有子活动。类别仅为顶级，因此没有类别或活动有子类别

现在我有两个问题，设置表格的最佳方法是什么。我考虑过将它们存储在单独的列中，与具有 id 和某种标志的字符串相同的列，具有 id 的列和具有父表的另一列。

我认为这些都不是很好，我想知道是什么。

另一个问题是我将如何拉这张桌子。我知道我可以进行多次查找，但如果有办法一次性完成所有操作，我就会徘徊。

我们正在使用 MSSQL 2012

编辑以试图澄清和添加更多信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:45:45.083

我不是 SQL 中“重载”的忠实粉丝。换句话说，一列应该包含只意味着一件事的数据。因此，我建议使用以下数据结构。

类别 => 标识 | 姓名

活动 => 标识 | 姓名 | CategoryId 不为空 | ParentActivityId 空

这样，每个 Activity 都与一个 Category 相关联，并且可能与一个父 Activity 相关联。

至于“拉”？我假设您的意思是选择数据？

```
SELECT a.Name AS ActivityName, c.Name AS ParentName, c.Id AS ParentId
FROM Category c
JOIN Activity a
ON c.Id = a.CategoryId
WHERE a.ParentActivityId IS NULL

UNION 

SELECT a.Name AS ActivityName, c.Name AS ParentName, c.Id AS ParentId
FROM Activity c
JOIN Activity a
ON c.Id = a.ParentActivityId 
```

# plesk - 如何在 Plesk 中为所有域添加到 open_basedir 的路径？

> ID：15622065
> 
> 赞同：1
> 
> 时间：2013-03-25T18:26:45.930
> 
> 标签：plesk

正如标题所说，如何在 Plesk 中为所有域添加到 open_basedir 的路径？

我必须更改所有域的 open_basedir 值：

```
{DOCROOT}/:/tmp/ 
```

至：

```
{DOCROOT}/:/tmp/:/var/www/vhosts/{DOMAIN?}/ 
```

我知道在哪里做，我只是不知道 {DOCROOT} 的父级的变量是什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T11:31:36.487

我在 plesk 11 使用了 Oleg 的 php.php 模板解决方案，只是更改了以下代码：

```
echo $OPT['settings']; 
```

至

```
echo str_replace(':/tmp/', ':/tmp/:/php/includes/', $OPT['settings']); 
```

这不是一个非常健壮的解决方案，因为可以进行比需要更多的选项替换，但这在常见情况下有效（将 /php/includes/ 目录添加到 open_basedir 选项中）。通常这些更改可以通过 plesk 服务计划更正来完成，但是当您有太多具有自定义服务计划的域时 - 更改所有域设置可能会很痛苦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T07:47:50.600

我不了解 Plesk 10.3，但在 Plesk 10.4 中有 {WEBSPACEROOT} 暴露于 /var/www/vhosts/%domain-name%/。因此，您只需在服务计划的 PHP 设置中将“{DOCROOT}/:/tmp/”替换为“{WEBSPACEROOT}/:/tmp/”即可。

这是 Plesk 11.0 中的默认设置。

对于 Plesk 10.0，当**php 用作 Apache 模块**时：

```
mkdir /usr/local/psa/admin/conf/templates/custom/service/
cp /usr/local/psa/admin/conf/templates/default/service/php.php /usr/local/psa/admin/conf/templates/custom/service/ 
```

在 /usr/local/psa/admin/conf/templates/custom/service/php.php 替换字符串

```
echo "php_admin_value open_basedir {$OPT['dir']}/:/tmp/\n"; 
```

至

```
echo "php_admin_value open_basedir " . str_replace('/httpdocs', '', $OPT['dir']) . "/:/tmp/\n"; 
```

并运行：

```
/usr/local/psa/admin/bin/httpdmng --reconfigure-all # to apply new configuration for all domains 
```

但是对于 CGI 和 FastCGI 需要更改 /var/www/vhosts/domain-name/etc/php.ini 文件，我不知道如何处理它。

# css - 为什么这个 CSS 下拉菜单在 IE9 中消失了

> ID：15622068
> 
> 赞同：0
> 
> 时间：2013-03-25T18:26:55.170
> 
> 标签：css

在我的网站上：http: [//www.carbonfibergear.com/](http://www.carbonfibergear.com/)如果您将鼠标悬停在“SHOP”菜单上，它会显示一个基于[此](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-build-a-kick-butt-css3-mega-drop-down-menu/)的下拉列表。我注意到在 IE9 中，一旦您将鼠标移出 word shop，下拉菜单就会消失。知道如何解决这个问题吗？

您可以在此答案中看到此问题的一些更新（请通读评论）：[https ://stackoverflow.com/a/15622168/1464510](https://stackoverflow.com/a/15622168/1464510)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:32:37.010

看起来你的按钮和 IE 不喜欢的菜单之间有一个间隙。它假设你正在将鼠标悬停在按钮上。如果你快速移动忍者，你可以保持菜单的焦点。

改变：

```
header nav #nav-site li {
margin: 0 10px 3px 0;
} 
```

至：

```
header nav #nav-site li {
padding: 0 10px 3px 0;
} 
```

看看这是否有帮助.. IE 在计算包括边距在内的整体框大小时表现得很奇怪。

# python - Python 列表赋值错误

> ID：15622075
> 
> 赞同：1
> 
> 时间：2013-03-25T18:27:16.190
> 
> 标签：python, string, list

我有一个字符串列表存储在`wk`

我运行以下代码。

```
n_wk=wk
for i in range(10):
    if some condition:
       n_wk[i]='new' 
```

我想保留这些`wk`值。但是，`wk`也随着`n_wk`. 谁能指出这个错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:28:45.020

创建以下*副本*：`wk`

```
n_wk = list(wk) 
```

或使用：

```
n_wk = wk[:] 
```

两者都将索引复制到新列表中。

# javascript - 在输入触发焦点事件时使 HTML5 数据列表可见

> ID：15622076
> 
> 赞同：25
> 
> 时间：2013-03-25T18:27:17.527
> 
> 标签：javascript, jquery, html

有些人可能已经知道样式选择元素是一场噩梦，如果没有一些 javascript 技巧，实际上是不可能的。HTML5 中的新数据列表可以起到相同的作用，因为用户会看到一个选项列表，并且值记录在输入文本字段中。

这里的限制是，在用户开始在文本字段中输入内容之前，列表不会出现，即使这样，也只会根据他们的输入显示可能的匹配项。我想要的行为是，一旦关注该字段，整个选项列表就会变得可见。

所以我有这个代码 -[在 jsbin 上查看](http://jsbin.com/eqihis/4/edit)

```
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>Input - Datalist</title>
</head>
<body>
  <input list="categories">
  <datalist id="categories">
    <option value="Breakfast">Breakfast</option>
    <option value="Brunch">Brunch</option>
    <option value="Lunch">Lunch</option>
    <option value="Dinner">Dinner</option>
    <option value="Desserts">Desserts</option>
  </datalist>
</body>
</html> 
```

我正试图用这个 Javascript 来显示它：

```
 var catVal = document.getElementsByTagName("input")[0],
    cat = document.getElementById("categories");

    catVal.style.fontSize = "1.3em";

    catVal.addEventListener("focus", function(event){
     cat.style.display = "block";
    }, false); 
```

任何帮助，将不胜感激，

干杯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-17T23:15:39.337

我使用以下代码：

```
<input name="anrede" 
    list="anrede" value="Herr" 
    onmouseover="focus();old = value;" 
    onmousedown = "value = '';" 
    onmouseup="value = old;"/>

<datalist id="anrede">
    <option value="Herr" selected></option>
    <option value="Frau"></option>
    <option value="Fraulein"></option>
</datalist> 
```

**鼠标悬停：**
设置焦点并记住一个--全局--变量中的旧值

**mousedown：**
删除值并显示`datalist`（内置功能）

**mouseup：**
恢复旧值

然后选择新值。

发现这是针对组合框的可接受的解决方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-10-25T12:48:22.060

我希望你喜欢这个解决方案：

我在输入字段中添加了一个“temp”属性进行存储，一旦鼠标悬停在输入字段上，它会将其当前值保存在 temp 中，然后删除该值以允许打开数据列表。

在 mouseout 时，它将从变量 temp 中恢复字段的值。这个解决方案在我测试过的 Chromium 下效果很好。

作为奖励，您可以添加一个`placeholder="Click to see all your options"`

```
<input value="Classic" list="myDatalist" temp="" onmouseover="this.temp=this.value; this.value='';" onmouseout="this.value=this.temp;">
<datalist id="myDatalist" open="open"> 
        <option value="Internet Explorer">
        <option value="Firefox">
        <option value="Chrome">
        <option value="Opera">
        <option value="Safari">
      </datalist>
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2020-02-14T13:06:06.290

问题很老了，但它是谷歌上的热门搜索，没有找到答案，所以我会在这里添加。

要在第一次单击时展开数据列表，您需要设置

```
dataListElement.style.display = "block"; 
```

并立即将其隐藏在下一行，因此它不会在您的 DOM 中显示为元素，但只会在输入元素下展开。

```
dataListElement.style.display = "none"; 
```

截至今天，它仅在 Firefox 中没有在首次点击时展开。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-03-26T20:36:47.837

HTML：

```
<!DOCTYPE html>
<html>
<head>
   <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>

   <meta charset=utf-8 />
   <title>Input - Datalist</title>
</head>
<body>

  <input list="categories" id="categories2" type="text">
  <div id="result"></div>
  <datalist id="categories">
     <option value="Breakfast">Breakfast</option>
     <option value="Brunch">Brunch</option>
     <option value="Lunch">Lunch</option>
     <option value="Dinner">Dinner</option>
     <option value="Desserts">Desserts</option>
  </datalist>
</body>
</html> 
```

jQuery：

```
var result='';
$(document).ready(function(){  
   $('input[type=text]').focus(function(){
      $('#categories option').each(function(){
      result=result+" "+$(this).val();
      });

      $('#result').show().html(result);
      $('input[type=text]').unbind('focus');
   });
   $('input[type=text]').blur(function(){
       $('#result').hide();  
       $('input[type=text]').focus(function(){
           $('#result').show();
       });

   });  
}); 
```

工作 JS 箱

[http://jsbin.com/urupit/4/watch](http://jsbin.com/urupit/4/watch)

# dart - Dart中的单元格表？

> ID：15622077
> 
> 赞同：3
> 
> 时间：2013-03-25T18:27:22.973
> 
> 标签：dart

我需要 Dart 中的可编辑表格，但我找不到好的解决方案。有一些示例 ( [http://igindo.com/dart/datagrid/dartPlay.html](http://igindo.com/dart/datagrid/dartPlay.html) ) 但单元格不可编辑。

我正在寻找的想法示例就像 gwt 单元格表 [http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTable](http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTable)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T05:51:04.890

我还不知道 Dart 中有任何可编辑的表格。很快，希望...

# c++ - 反转存储在指针数组中的字符串

> ID：15622079
> 
> 赞同：-3
> 
> 时间：2013-03-25T18:27:23.423
> 
> 标签：c++, string, pointers, reverse

> 编写一个程序来反转存储在以下指向字符串的指针数组中的字符串：

```
char *s[ ] = {
  "To err is human...",
  "But to really mess things up...",
  "One needs to know C!!"
}; 
```

> 提示：编写一个函数`xstrrev ( string )`，它应该反转一个字符串的内容。调用此函数以反转存储在`s`.

为什么我无法使用此代码获得正确的输出？

```
#include "stdafx.h"
#include "conio.h"
#include "stdio.h"
#include "string.h"

using namespace System;

void xstrrev (char str[])
{
    int i,l;
    char temp;
    l=strlen(str);

    for (i=0;i<(l/2);++i)
    {
        temp=*(str+i);
        *(str+i)=*(str+i+l-1);
        *(str+i+l-1)=temp;
    }
}

void main ()
{
char *s[] = {
        "To err is human...",
        "But to really mess things up...",
        "One needs to know C!!"
    };
    xstrrev(s[0]);
    xstrrev(s[1]);
    xstrrev(s[2]);
    puts(s[0]);
    puts(s[1]);
    puts(s[2]);
    getch();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:37:26.563

我是否只能注意到您在声明`s[]`. 你应该`s[]`像这样在 main() 中声明你：

```
char str1[] = "To err is human...";
char str2[] = "But to really mess things up...";
char str3[] = "One needs to know C!!";
char *s[] = { str1, str2, str3}; 
```

原因：

如果你喜欢：

```
char* str = "yourname";
str[2] = 'c';    // you are trying to write on read only memory 
```

您正在尝试在只读存储器上写入。导致分段错误（未定义行为）的原因是因为`str`指向常量字符串文字。

如果你喜欢，在哪里：

```
char str[] = "yourname";
str[2] = 'c';    // ok no error 
```

然后就可以了，因为这次`str[]`是一个数组字符串，它的值和大小在声明点定义。

我认为算法明智你是正确的

**编辑** ，我是对的。[**在我的建议Codepad**](http://codepad.org/01DdlO3b) 和@carlNorm 所说的正确之后，看到这里你的代码正在工作。他还发布了一个很好的链接。

# javascript - 如何使用 javascript 轻松剖析链接？

> ID：15622080
> 
> 赞同：5
> 
> 时间：2013-03-25T18:27:25.983
> 
> 标签：javascript, jquery, hyperlink, split

我将如何使用 Javascript 或 JQuery 剖析链接/href？

我可以使用 split 来拆分一些变量，但我想知道是否有更简单的方法来解决这个问题，例如......

www.url.com/dir/page?setting&var1=value1

获取目录、页面和设置的最简单方法是什么。

PS 总是选择最后一个目录会很好，所以如果有多个目录，使用标准拆分并不总是有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:32:39.053

我推荐 James Padolsey 的 URL 解析器——它是一个简单的 JS 函数，可以为您提供 URL 的任何部分（主机、查询字符串、路径等）

[http://james.padolsey.com/javascript/parsing-urls-with-the-dom/](http://james.padolsey.com/javascript/parsing-urls-with-the-dom/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:32:33.977

[parseUri](http://blog.stevenlevithan.com/archives/parseuri)似乎完全符合您的要求，将 url 拆分为其组件部分。

# python - Django，模板编码的路径

> ID：15622082
> 
> 赞同：0
> 
> 时间：2013-03-25T18:27:35.140
> 
> 标签：python, django, encoding

我是 Python 和 Django 的新手，在遵循 Django 教程时遇到了一些问题

我在 settings.py 中配置了 Django 以从路径中获取自定义模板。但是，文件夹的名称包含拉丁字符，因此 Python 输出以下错误：Non-ASCII character '\xe3' in file C:\Users\Joòo Dias...。

我试过放`#coding iso8859-1`，但出现了另一个类似的错误，但现在说 UTF-8 无法转换字符。

错误发生在 TEMPLATE_DIRS 定义上

```
TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    'C:/Users/João Dias/PythonProjects/test27/templates'
) 
```

关于如何解决这个问题的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:50:32.383

在源文件中编写非 ASCII 字符串文字时，需要在`# coding`注释中设置文字编码。如果您的文件是 thr UTF8 编码，您需要写入`# coding: utf-8`，而不是`#coding iso8859-1`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T12:16:47.287

原来我正在使用`#coding UTF-8`评论，但是切换到`#encoding UTF-8`似乎可以解决问题

# asp.net-mvc-4 - 无法在 asp,net mvc4 中使用 dojo.xhrPost() 将数据作为 Json 发布

> ID：15622083
> 
> 赞同：0
> 
> 时间：2013-03-25T18:27:38.877
> 
> 标签：asp.net-mvc-4, dojo

我正在将 dojo 1.8.3 与 asp.net mvc 一起使用。我被一个问题困住了。我正在尝试将来自一种表单的数据作为 JSON 发布（我有一个特定的理由发布为 json 而不是 JSON）。所以当我发布时，我在控制器端得到一个空字符串。下面是我的javascript代码

```
 var xhrArgs = { url: rootPath + "Home/CreateNewPattern/",
            postData: dojo.toJson({ Name: "name1", TimeSpan: "10" }),
            handleAs: "text",
            headers: { "Content-Type": "application/json", "Accept": "application/json" },
            load: function (data) {
                console.log("Create pattern form posted");
            },
            error: function (error) {
                // We'll 404 in the demo, but that's okay.  We don't have a 'postIt' service on the
                // docs server.
                alert("Error during Form posting");
            }
        }

        // Call the asynchronous xhrGet
        var deferred = dojo.xhrPost(xhrArgs); 
```

我在控制器内的操作方法是

```
 [HttpPost]
        public ActionResult CreateNewPattern(string newPattern)
        {
            Trace.WriteLine("Name of the pattern is " + newPattern);

            return RedirectToAction("DisplayPatternManagement");
        } 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:30:56.663

您正在发布`Name`和`TimeSpan`属性，但您的操作接受一个名为`newPattern`.

那显然行不通。

# java - Horspool 输出错误

> ID：15622085
> 
> 赞同：1
> 
> 时间：2013-03-25T18:27:46.373
> 
> 标签：java, output

这是一个家庭作业问题。我有一个 java 程序来计算某个模式/字符串是否在用户输入的文本字符串中。该程序可以工作，但总是输出 -1，如果模式字符串不在指定的文本中，它应该输出。我一生都无法弄清楚什么是行不通的，我会非常感谢提示我需要修复什么。

这是我的代码：

```
import java.util.Scanner;

/**
 * @author Mouse
 *
 */
public class horspool {

/**
 * @param args
 */
public static void main(String[] args) 
{
    Scanner scanIn = new Scanner (System.in);

    //The text to search for the phrase in
    String t = "";

    //The phrase/pattern to search for
    String p = "";

    System.out.println(" ");
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println("Harspool's Algorithm: ");
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println(" ");
    System.out.println("Please enter the full text: ");
    t = scanIn.nextLine();
    System.out.println("Please enter the pattern to search for: ");
    p = scanIn.nextLine();

    char[] text = new char[t.length()];
    char[] pattern = new char[p.length()];

    for (int i = 0; i < text.length; i++)
    {
        text[i] = t.charAt(i);
    }

    for (int i = 0; i < pattern.length; i++)
    {
        pattern[i] = p.charAt(i);
    }

    int newChar[] = new int[256];

    for(int i=0; i < 256; i++) 
    {
        newChar[i]=0;
    }

    for (int i = 0; i < text.length; i++)
    {
        newChar[t.charAt(i) % 256]++;
    }

    for (int i = 0; i < pattern.length; i++)
    {
        newChar[p.charAt(i) % 256]++;
    }

    int index = HorspoolMatching(pattern, text);

    System.out.println("Index: " + index);
}

public static int[] ShiftTable(char[] p) 
{
    int m = p.length;

    //Table filled with shift sizes for each individual letter.
    int[] table = new int[256];

    for (int i = 0; i < table.length; i++)
    {
        table[i] = m;
    }
    for (int j = 0; j < m - 1; j++)
    {
        for (int a = 0; a < p.length; a++)
        {
            if (p[j] == p[a])
            {
                table[a] = (m - 1 - j);
            }
        }
    }
    return table;
}

public static int HorspoolMatching(char[] p, char[] t) 
{
    int [] table = ShiftTable(p);
    int m = p.length;
    int i = m - 1;
    int n = t.length;
    int temp = 0;
    int k = 0;
    int count = 0;

    while (i <= n - 1)
    {
        k = 0;

        while (t[i - k] == p[m - 1 - k] && k < m - 1) 
        {
            System.out.println("In second while");
            k++;
        }   
        if (k == m)
        {
            return (i - m + 1);
        } 
        else
        {
            for (int a = 0; a < t.length; a++)
            {
                if (t[i] == t[a])
                {
                    temp = table[a];
                }
            }
            i = i + temp;
        }
    }
    return -1;
}

} 
```

任何帮助将不胜感激！非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:55:03.433

> 它总是输出 -1

检查 HorspoolMatching 中的 return 语句。

编辑：好吧，我derped，对不起。

当我改变

```
while (t[i - k] == p[m - 1 - k] && k < m - 1) 
```

至

```
while ( k < m && t[i - k] == p[m - 1 - k]) 
```

它开始工作了。

k < m - 1 的问题是您过早停止循环并且从未真正检查完整模式，因此不匹配。

通过将其移动到 && 的第一个条件并删除 -1，它现在检查完整的模式，并且当它应该时 while 将失败：在索引超出范围之前，而不是在此之前的一个循环。

更多编辑：

我现在跳过 sys 并设置：

```
String t = "lklklklkabcdabababcd";
String p = "ab"; 
```

这给出了 8

但

```
String t = "lklklklkabcdabababcd";
String p = "abc"; 
```

给-1...

好的，这应该可以做到[剧透警告]

```
table[i] = 1; //m; 
```

# javascript - JavaScript 在页面顶部停止 div 并滚动它们

> ID：15622086
> 
> 赞同：1
> 
> 时间：2013-03-25T18:27:51.983
> 
> 标签：javascript, jquery, html, scroll, fixed

我有一段代码在这里工作：http: [//jsfiddle.net/Tgm6Y/4302/](http://jsfiddle.net/Tgm6Y/4302/)

这是jquery的一个片段：

```
 (function(window){
$.fn.stopAtTop= function () {
    var $this = this,
        $window = $(window),
        thisPos = $this.offset().top,
        //thisPreservedTop = $this.css("top"),
        setPosition,
        under,
        over;

    under = function(){
        if ($window.scrollTop() < thisPos) {
            $this.css({
                position: 'absolute',
                top: ""
            });
            setPosition = over;
        }
    };

    over = function(){
        if (!($window.scrollTop() < thisPos)){
            $this.css({
                position: 'fixed',
                top: 0
            });
            setPosition = under;
        }
    };

    setPosition = over;

    $window.resize(function()
    {
        bumperPos = pos.offset().top;
        thisHeight = $this.outerHeight();
        setPosition();
    });

    $window.scroll(function(){setPosition();});
    setPosition();
};
})(window);

$('#one').stopAtTop();
$('#two').stopAtTop();
$('#three').stopAtTop();
$('#four').stopAtTop(); 
```

但是我不知道如何滚动 div 如果它大于可视区域，然后在它到达底部时开始滚动它下面的 div。

例如，在上面页面的#one 中，您可以看到 hello，但永远看不到最后 2 个短语（End、Start Scrolling）。我已经重新调整了 CSS，让它不是 100% 的 with，但这仍然不能解决这个问题。

在 JavaScript / Jquery 中，我需要找到一种方法，在显示 div 中的所有数据之前不滚动其下方的 div，然后向上滚动执行相同操作。任何帮助，将不胜感激。

谢谢，

# ruby-on-rails - Rails with Devise：关联问题

> ID：15622087
> 
> 赞同：1
> 
> 时间：2013-03-25T18:27:53.527
> 
> 标签：ruby-on-rails, devise, associations

我制作了新的 Rails 应用程序。只有一个 User 模型（通过 Devise 生成）和一个用脚手架生成的 Post 模型，它是完全新鲜的。在 Post 模型中，我在数据库中有一个名为`user_id`.

问题是`user_id`在 Post 表中始终是`nil`（它不会更改为`user_id`正在发布的用户）。我怀疑这与设计有关，但我不完全确定。关于做什么的任何建议？

**用户.rb**

```
class User < ActiveRecord::Base
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  attr_accessible :email, :password, :password_confirmation, :remember_me

  has_many :posts, dependent: :destroy
end 
```

**post.rb**

```
class Post < ActiveRecord::Base
  attr_accessible :title, :user_id
  belongs_to :user
end 
```

**宝石文件**

```
source 'https://rubygems.org'

gem 'rails', '3.2.13'
gem 'bootstrap-sass', '2.1'
gem 'devise'

group :development do
  gem 'sqlite3', '1.3.5'
end

group :assets do
  gem 'sass-rails',   '3.2.5'
  gem 'coffee-rails', '3.2.2'

  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.2'

group :production do
    gem 'pg', '0.12.2'
end

gem 'will_paginate', '> 3.0' 
```

**post_controller（创建）**

```
 def create
    @post = Post.new(params[:post])

    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, notice: 'Post was successfully created.' }
        format.json { render json: @post, status: :created, location: @post }
      else
        format.html { render action: "new" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:36:14.813

我猜这个`user_id`属性没有被设置，因为你没有设置它。:)

```
 def create
    @post = Post.new(params[:post])
    @post.user_id = current_user.id # You need to add this line

    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, notice: 'Post was successfully created.' }
        format.json { render json: @post, status: :created, location: @post }
      else
        format.html { render action: "new" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end 
```

旁注：我建议在 to 以及（如果您还没有）外键约束上放置一个非空`post.user_id`约束。这些限制有助于预防和更轻松地诊断这类问题。`post.user_id``user.id`

# jquery - 悬停下一个li类时如何保持jquery下拉悬停内容打开

> ID：15622096
> 
> 赞同：0
> 
> 时间：2013-03-25T18:28:31.273
> 
> 标签：jquery, html

我从一个站点上传了一个 jquery 下拉菜单，我想知道这是否可行，如果可以，如何？目前，当您将鼠标悬停在 3 个主要 li 类中的任何一个上时，下拉菜单会在每个类下方展开，然后如果您将鼠标悬停在打开的 div 上或悬停到另一个 li 类，则菜单会关闭并出现新内容。我想要这样，一旦你将鼠标悬停并打开它们中的任何一个，那么如果你的鼠标悬停在下一个上，整个容器不会收缩，而是针对新 li 的新内容进行调整。我想要的示例是[Nike.com](http://www.nike.com/) 菜单，只要您的鼠标在导航区域上，最后放置的内容就会保留，如果您将鼠标悬停在新菜单项上，菜单不会折叠，它会自行调整对于新内容。

我在这里设置了 jsfiddle 的演示测试 [http://jsfiddle.net/R7aTq/](http://jsfiddle.net/R7aTq/)

```
$(function(){

    $('#navigation_horiz').naviDropDown({
        dropDownWidth: '300px'
    });

    $('#navigation_vert').naviDropDown({
        dropDownWidth: '300px',
        orientation: 'vertical'
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T17:10:48.730

这是我想出的解决方案：http: [//jsfiddle.net/JeremyGood/R7aTq/198/](http://jsfiddle.net/JeremyGood/R7aTq/198/)

您可能想要添加一些动画。此外，如果您使用绝对定位，您可以让下拉菜单与导航栏的宽度相同。

当然，我们基本上只是重写了插件的下拉逻辑。在某些时候，它只是成为您自己的自定义菜单代码。

```
$(function(){

    $('#navigation_horiz').naviDropDown({
        dropDownWidth: '300px'
    });

    $('#navigation_vert').naviDropDown({
        dropDownWidth: '300px',
        orientation: 'vertical'
    });

    var olddropdown = null;

    $("#navigation_horiz>ul>li").unbind('mouseout');
    $("#navigation_horiz>ul>li").unbind('mouseover');
    $("#navigation_horiz>ul>li").bind("mouseout", function(event) {
         olddropdown = $(this).find(".dropdown");
    });
    $("#navigation_horiz>ul>li").bind("mouseover", function(event) {
        $(this).find(".dropdown").css('display', 'block');
        if (olddropdown != null) {
            olddropdown.css('display', 'none');
            olddropdown = null;
        }
    });
    $("#navigation_horiz>ul").bind("mouseout", function(event) {
        olddropdown.css('display', 'none');
        olddropdown = null;
    });
}); 
```

# spring - 当 Spring 无法验证模型的 java.util.Date 字段时，如何显示用户友好的错误？

> ID：15622098
> 
> 赞同：8
> 
> 时间：2013-03-25T18:28:31.923
> 
> 标签：spring, validation, date, model, error-handling

我正在使用 Spring 3.1.2.RELEASE。如果我的日期字段格式不正确，我想在我的 JSP 上显示一条错误消息。我以为我遵循了所有正确的步骤。我在控制器中绑定了一个转换器……</p>

```
@InitBinder
public void initBinder(final WebDataBinder binder) {
    final DateFormat dateFormat = new SimpleDateFormat(Contract.DATE_FORMAT);
    dateFormat.setLenient(false);

    // true passed to CustomDateEditor constructor means convert empty String to null
    binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));
...
} 
```

我已将这些错误消息包含在我的 messages.properties 文件中（包含在 Spring 应用程序上下文中）

```
typeMismatch.activationDate=The activation date format should be of the form MM/dd/yyyy
typeMismatch.sampleUserForm.activationDate=The activation date format should be of the form MM/dd/yyyy 
```

这是我正在使用的模型：

```
public class SampleUserForm
{

    private String userId;
    private String firstName;
    private String middleName;
    private String lastName;
    private String username;
    private String url;
    private String password;
    private String confirmPassword;
    private State state;
    private java.util.Date activationDate;
    private java.util.Date expirationDate;
    private List<Product> products;
    private Set<Role> roles = new HashSet<Role>(); 
```

这是我在提交日期格式错误的表单时收到的错误消息……</p>

```
org.springframework.validation.BindException: org.springframework.validation.BeanPropertyBindingResult: 1 errors
Field error in object 'sampleUserForm' on field 'activationDate': rejected value [1900]; codes [typeMismatch.sampleUserForm.activationDate,typeMismatch.activationDate,typeMismatch.java.util.Date,typeMismatch]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sampleUserForm.activationDate,activationDate]; arguments []; default message [activationDate]]; default message [Failed to convert property value of type 'java.lang.String' to required type 'java.util.Date' for property 'activationDate'; nested exception is java.lang.IllegalArgumentException: Could not parse date: Unparseable date: "1900"]
    org.springframework.web.method.annotation.ModelAttributeMethodProcessor.resolveArgument(ModelAttributeMethodProcessor.java:111)
org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:75)
    org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:156)
    org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:117)
org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
    org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:754)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:103)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:183)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259) 
```

我还需要做什么/检查以捕获格式错误的日期？我宁愿向用户显示友好的错误消息，而不是页面优雅地死去。

这是应该处理表单的控制器方法。请注意，我已经包含了一个 BindingResult。

```
@RequestMapping(value = "/save", method = RequestMethod.POST)
public ModelAndView save(final HttpServletRequest request,
                         final SampleUserForm sampleUserForm,
                         final Model model,
                         final BindingResult result) 
{
    String nextPage = "sampleusers/add";
    m_sampleUserFormValidator.validate(sampleUserForm, result);
    if (!result.hasErrors())
    {
       ... process the model and determine the next page ...
    }   // if 

    return new ModelAndView(nextPage);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T21:39:20.947

See: [Spring @Valid validator not invoked properly (Roo, Hibernate)](https://stackoverflow.com/questions/9916623/spring-valid-validator-not-invoked-properly-roo-hibernate).

Short story is changing the controller method signature from

```
@RequestMapping(value = "/save", method = RequestMethod.POST)
public ModelAndView save(final HttpServletRequest request,
                     final SampleUserForm sampleUserForm,
                     final Model model,
                     final BindingResult result) 
```

to

```
@RequestMapping(value = "/save", method = RequestMethod.POST)
public ModelAndView save(final HttpServletRequest request,
                         final Model model,
                         final SampleUserForm sampleUserForm,
                         final BindingResult result) 
```

fixed everything.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-25T18:36:08.580

我假设您应该将表单绑定到您的一种`POST`方法中，使用`@ModelAttribute`. 在同一个方法中绑定 a`BindingResult bindingResult`并且所有绑定错误都应该被捕获到这个`bindingResult`对象中。在方法内部，您应该能够检查

`if (bindingResult.hasErrors()) {`

并采取适当的行动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T17:16:57.247

我相信错误在于您格式化数据时。确认您需要调试您的应用程序并检查日期值。另一个好的做法是相信您为应用程序配置了标准格式。

请按照以下示例进行操作：

```
 @Configuration
 public class ApplicationContext {

    @Bean
    public FormattingConversionService conversionService() {

            // Use the DefaultFormattingConversionService but do not register
            // defaults
            DefaultFormattingConversionService conversionService = new DefaultFormattingConversionService(false);

            // Ensure @NumberFormat is still supported
            conversionService.addFormatterForFieldAnnotation(new NumberFormatAnnotationFormatterFactory());

            // Register date conversion with a specific global format
            DateFormatterRegistrar registrar = new DateFormatterRegistrar();
            registrar.setFormatter(new DateFormatter("dd/MM/yyyy")); // define your format
            registrar.registerFormatters(conversionService);

            return conversionService;
    }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T02:54:06.073

使用此类/方法级别注释对该控制器类上的方法进行注释：

```
@ExceptionHandler(BindException.class)
public String handleBindExcption(/*flexible parameters*/ ){
    //codes goes here
    return "view"; //view name or modelAndView 
} 
```

更多[信息](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/bind/annotation/ExceptionHandler.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-13T17:55:49.683

BindingResult 参数应位于正在验证的模型旁边。例如

```
 public void checkout(
                         @Valid @ModelAttribute("legalContactDetails") LegalContactDetails legalContactDetails,
                         BindingResult legalContactDetailsResult,
                         @Valid @ModelAttribute("researchIntent") ResearchIntent researchIntent,
                         BindingResult researchIntentResult) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-03T11:17:44.253

```
`class DateBinderImpl` extends PropertyEditorSupport {

 public void setAsText(String text)
        throws IllegalArgumentException
    {
if(text.isEmpty()){

        Datelistener dateString = new Datelistener ();
        dateString.setValue("");
        setValue(dateString); setValue is method of PropertyEditorSupport
return;
    }
// for other date check condition use SimpleDateFormat class

public String getAsText()
    {
        Datelistener dateString = (Datelistener) getValue();
        if(dateString.getDate.isEmpty()){
            return "";

}

public class   Datelistener {
private String date;
public Datelistener ()
    {

    }
//setter and getter for date;

}

public class TestModel{
  private Datelistener date;
// gettter and setter for date

}
@InitBinder
 public void initBinder(WebDataBinder binder)
    {
        binder.registerCustomEditor(Datelistener, new DateBinderImpl());

    }

private boolean checkClientSideValidation(TestModel model, BindingResult bindingResult) {
Datelistener  dateobject=model.getDate(); // now you can obtained binded date value.
dateobject.getDate().isEmpty(){
 bindingResult.rejectValue("date;", "", new Object[] {""}, "");
            return true;
} 
```

您可以查看此链接以获取更多信息 [http://forum.springsource.org/showthread.php?58933-Handle-excpetions-from-custom-property-editor-spring-2-5](http://forum.springsource.org/showthread.php?58933-Handle-excpetions-from-custom-property-editor-spring-2-5) [http://www.codercorp.com/博客/spring/registering-propertyeditorss-with-spring-for-custom-objects-example.html](http://www.codercorp.com/blog/spring/registering-propertyeditorss-with-spring-for-custom-objects-example.html)

# javascript - 如果执行 onclick，如何禁用 HREF？

> ID：15622100
> 
> 赞同：115
> 
> 时间：2013-03-25T18:28:47.300
> 
> 标签：javascript, html, onclick, anchor, href

我有一个*同时* `HREF`设置和`ONCLICK`属性的锚。如果单击并启用了 Javascript，我希望*它只*执行`ONCLICK`和忽略`HREF`。同样，如果 Javascript 被禁用或不受支持，我希望它遵循`HREF`URL 并忽略`ONCLICK`. 下面是我正在做的一个例子，它将执行 JS 并同时跟踪链接（通常是 JS 被执行，然后页面发生变化）：

```
<A HREF="http://example.com/no-js-login" ONCLICK="yes_js_login()">Log in</A> 
```

**最好的方法是什么？**

我希望有一个 Javascript 答案，但我会接受任何方法，只要它有效，特别是如果这可以用 PHP 完成。我已经阅读了“ [a href 链接在 javascript onclick 功能能够完成之前执行并重定向页面](https://stackoverflow.com/questions/10712528/a-href-link-executes-and-redirects-page-before-javascript-onclick-function-is-ab)”，但它只是延迟`HREF`，但并没有完全禁用它。我也在寻找更简单的东西。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2014-03-28T21:14:21.350

如果您将 return 放在`onclick`属性中，则可以使用第一个未编辑的解决方案：

```
<a href="https://example.com/no-js-login" onclick="return yes_js_login();">Log in</a>

yes_js_login = function() {
     // Your code here
     return false;
} 
```

示例：[https ://jsfiddle.net/FXkgV/289/](https://jsfiddle.net/FXkgV/289/)

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2013-03-25T18:41:36.580

```
 yes_js_login = function() {
         // Your code here
         return false;
    } 
```

如果您返回 false 它应该阻止默认操作（转到 href）。

**编辑：**抱歉，这似乎不起作用，您可以执行以下操作：

```
<a href="http://example.com/no-js-login" onclick="yes_js_login(); return false;">Link</a> 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2016-05-23T13:56:56.990

只需在 HTML 中使用[`preventDefault`](https://developer.mozilla.org/en/docs/Web/API/Event/preventDefault)并传递默认浏览器行为即可。`event`

`<a href=/foo onclick= yes_js_login(event)>Lorem ipsum</a>`

```
yes_js_login = function(e) {
  e.preventDefault();
} 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-12-20T22:21:23.967

```
<a href="http://www.google.com" class="ignore-click">Test</a> 
```

**使用 jQuery：**

```
<script>
    $(".ignore-click").click(function(){
        return false;
    })
</script> 
```

**使用 JavaScript**

```
<script>
        for (var i = 0; i < document.getElementsByClassName("ignore-click").length; i++) {
            document.getElementsByClassName("ignore-click")[i].addEventListener('click', function (event) {
                event.preventDefault();
                return false;
            });
        }
</script> 
```

您将类分配给`.ignore-click`您喜欢的尽可能多的元素，并且单击这些元素将被忽略

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-04-26T06:36:09.027

您可以使用这个简单的代码：

```
<a href="" onclick="return false;">add new action</a><br> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-06-05T17:32:30.923

如果传递这样的事件参数会更简单：

```
<a href="#" onclick="yes_js_login(event);">link</a> 
```

```
function yes_js_login(e) {
    e.stopImmediatePropagation();
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-12-01T09:11:37.503

尝试使用`javascript:void(0)`如下 -

`<a href="javascript:void(0)" onclick="...">Text</a>`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-11-15T05:04:34.900

这可能会有所帮助。 **不需要 JQuery**

```
<a href="../some-relative-link/file" 
onclick="this.href = 'https://docs.google.com/viewer?url='+this.href; this.onclick = '';" 
target="_blank"> 
```

此代码执行以下操作：将相对链接传递给[Google Docs Viewer](https://docs.google.com/viewer)

1.  通过以下方式获取锚点的完整链接版本`this.href`
2.  打开新窗口的链接。

因此，在您的情况下，这可能有效：

```
<a href="../some-relative-link/file" 
onclick="this.href = 'javascript:'+console.log('something has stopped the link'); " 
target="_blank"> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-18T09:24:55.213

我解决了我需要一个模板来处理常规 URL 或 javascript 调用的元素的情况，其中 js 函数需要对调用元素的引用。在 javascript 中，“this”仅在表单元素（例如按钮）的上下文中用作自引用。我不想要一个按钮，只是一个常规链接的外观。

例子：

```
<a onclick="http://blahblah" href="http://blahblah" target="_blank">A regular link</a>
<a onclick="javascript:myFunc($(this));return false" href="javascript:myFunc($(this));"  target="_blank">javascript with self reference</a> 
```

href 和 onClick 属性具有相同的值，除了我在 onClick 上附加“return false”时，它是一个 javascript 调用。在被调用函数中“返回 false”不起作用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-11T19:40:01.923

就我而言，当用户单击“a”元素时，我有一个条件。条件是：

如果其他部分的项目超过十个，则不应将用户重定向到其他页面。

如果其他部分的项目少于十个，则应将用户重定向到其他页面。

“a”元素的功能取决于其他组件。点击事件中的代码如下：

```
var elementsOtherSection = document.querySelectorAll("#vehicle-item").length;
if (elementsOtherSection> 10){
     return true;
}else{
     event.preventDefault();
     return false;
} 
```

# php - 在连接类中使用 PDO 时如何显示 mysql 错误？

> ID：15622105
> 
> 赞同：2
> 
> 时间：2013-03-25T18:29:08.113
> 
> 标签：php, mysql, class, error-handling, pdo

我正在尝试编写一个小类，以便可以使用它来连接到我的数据库但是我遇到了一个问题，即 PDO 没有显示错误。

我要做的是在查询失败时显示 mysql 错误，以便我知道错误是什么并修复它。

在我的通话中，我有 4 种方法需要捕获 mysql 错误。

```
startConnection()
getOneResult()
processQuery()
getDataSet() 
```

这是我目前的课程，有人可以告诉我如何显示 mysql 错误。请注意，我尝试使用 try catch 来捕获错误，但这对我不起作用。

谢谢你的帮助

```
<?php

class connection {

    private $connString;
    private $userName;
    private $passCode;
    private $server;
    private $pdo;
    private $errorMessage;

    private $pdo_opt = array (
                            PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
                            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
                            );

    function __construct($dbName, $serverName = 'localhost'){

        //sets credentials
        $this->setConnectionCredentials($dbName, $serverName);

        //start the connect
        $this->startConnection();

    }

    function startConnection(){

            $this->pdo = new PDO($this->connString, $this->userName, $this->passCode, $this->pdo_opt);

            if( ! $this->pdo){

                $this->errorMessage  = 'Failed to connect to database. Please try to refresh this page in 1 minute. ';
                $this->errorMessage .= 'However, if you continue to see this message please contact your system administrator.';
                echo $this->getError();

            }

    }

    //this will close the PDO connection
    public function endConnection(){

        $this->pdo->close;
    }

    //return a dataset with the results
    public function getDataSet($query, $data = NULL)
    {
        $cmd = $this->pdo->prepare( $query );

        $cmd->execute($data);
        return $cmd->fetchAll();
    }

    //return a dataset with the results
    public function processQuery($query, $data = NULL)
    {
        $cmd = $this->pdo->prepare( $query );

        return $cmd->execute($data);
    }

    public function getOneResult($query, $data = NULL){
        $cmd = $this->pdo->prepare( $query );
        $cmd->execute($data);
        return $cmd->fetchColumn();
    }

    public function getError(){
        if($this->errorMessage != '')
            return $this->errorMessage;
        else
            return true;  //no errors found

    }

    //this where you need to set new server credentials with a new case statment
    function setConnectionCredentials($dbName, $serv){

        switch($serv){

            case 'NAME':
                $this->connString   = 'mysql:host='.$serv.';dbname='.$dbName.';charset=utf8';
                $this->userName     = 'user';
                $this->passCode     = 'password';
            break;

            default:
                $this->connString   = 'mysql:host=localhost;dbname=rdi_cms;charset=utf8';
                $this->userName     = 'user';
                $this->passCode     = 'pass!';
            break;

            }

    }

}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:01:37.583

您不一定要*显示*错误消息，而只是*提出*它。显示 mysql 错误消息会使您的站点不那么安全并且看起来很卑鄙。

所以，你唯一关心的就是

*   使 PDO 对 SQL 错误产生异常。
*   设置 PHP 以在开发服务器上显示错误消息并登录实时服务器

因此，请在脚本顶部尝试此代码

```
ini_set('display_errors',1);
error_reporting(E_ALL); 
```

然后使用故意的 mysql 错误运行这些函数之一。您的脚本应该停止并显示错误消息。

更新：
好吧，我尝试运行您的代码，上面的这两条神奇的代码行以其他方式帮助了我：

```
Notice: Undefined variable: pdo_opt in D:\SERVER\htdocs\0.php on line 37 
```

表示变量拼写错误（您必须`$this->pdo_opt`改用） - 所以，这就是 PDO 没有引发异常的原因。

这是一个教训，为什么`error_reporting`应该**总是** `E_ALL`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:37:23.957

我会摆脱或不使用方法`getError()`,`getOneResult()`和. 使用该类来管理您的 PDO 连接。然后将您的 PDO 语句包装在 try...catch 中。`processQuery()``getDataSet()`

```
try
{
    $conn = new connection( "mydatabase" );
    $db = $conn->getPdoInstance();
    $stmt = $db->prepare( "SELECT * FROM `something`" );
    $stmt->execute();
}
catch( PDOException $e )
{
   // Catch the error message and do whatever you need to do with it
} 
```

# xmpp - XMPP / Jabber：对于自定义消息我需要修改客户端还是服务器？

> ID：15622109
> 
> 赞同：5
> 
> 时间：2013-03-25T18:29:20.580
> 
> 标签：xmpp, openfire, google-talk

我正在编写一个 IM，我想实现一些标准中没有的功能，我想要一些自定义功能。
我想知道例如我是否可以使用 Google 的 XMPP 服务（Google Talk）并制作一个自定义 IM 客户端，该客户端实现了能够与服务器对话的默认功能，并且可能有一种方法可以在 XML 中添加一些自定义标签谷歌服务器将与我的其他客户端一起工作并将消息发送到可以解释此 XML 并显示并执行正确操作的其他客户端？

还是我必须在服务器上实现此功能？例如，Openfire 支持插件，您可以使用插件对其进行扩展，但我更愿意避免制作自己的服务器，而是使用 Google 帐户和服务器。我只是一名学生，我没有资源自己维护服务器。

另外，我不太明白“ [Jabber 组件协议](http://xmpp.org/extensions/xep-0114.html)”的用途。根据我的阅读，我知道它可以解决我的问题，但它必须在服务器上。它不在 XMPP 服务器中，但它也必须作为服务器工作并与 XMPP 服务器连接。
我认为我不能将“ [Jabber 组件协议](http://xmpp.org/extensions/xep-0114.html)”与 Google 的 XMPP 服务器一起使用，或者我可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T10:48:25.397

如果我正确理解了您的问题，那么您只想在消息中添加一些额外的有效负载，这些有效负载只能由接收客户端解释。因此，您只需要 XMPP 服务器作为从客户端 A 到客户端 B 的路由器。这将与 Google Talk 服务器和任何其他服务器结合使用。这种可扩展性是 XMPP 的基本特性之一。

Openfire 插件和组件协议适用于其他用例。

以下是如何添加自定义有效负载的示例：

所以像：

```
<message to="user@server.com">
   <mytag xmlns="mycompany.com/mynamespace"/>
</message> 
```

或者

```
<message to="user@server.com">
   <mytag xmlns="urn:xmpp:mynamespace:v1"/>
</message> 
```

# django - 如何将身份验证添加到我的 django 项目的 sphinx 文档中？

> ID：15622113
> 
> 赞同：1
> 
> 时间：2013-03-25T18:29:24.340
> 
> 标签：django, authorization, python-sphinx

我正在使用 sphinx-apidoc 为我的 Django 项目自动生成文档，该项目使用 django-social-auth + oauth2 进行身份验证。我希望能够使用相同的身份验证来访问文档。我怎样才能做到这一点？

我查看了[django-sphinxdoc](http://stefan.sofa-rockers.org/django-sphinxdoc/)，但当前版本与最新的 Haystack 不兼容，并且似乎还有一些其他错误。另外，我真的需要做类似的事情吗 - 将文档转换为 JSON 并将它们存储到数据库中以便在模板上下文中呈现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T10:41:39.957

您可以将 sphinx 构建静态 html 文件作为静态文件移动到您的 django web-server 项目中，并简单地添加用户身份验证此静态文件路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T10:54:35.393

您可以使用 mod_wsgi 的`WSGIAuthUserScript`指令调用 Django 后端进行身份验证。这样你就有了一个以 Django 的用户数据库为后端的 HTTP BASIC AUTH。

请参阅[modwsgi 文档](https://code.google.com/p/modwsgi/wiki/AccessControlMechanisms)和[check_password()](https://github.com/django/django/blob/master/django/contrib/auth/handlers/modwsgi.py#L6)

**编辑：**

我刚刚注意到 Django 文档中有一个全面的[How To](https://docs.djangoproject.com/en/1.6/howto/deployment/wsgi/apache-auth/)说明。

# python - 来自两个大型数据集的匹配和不匹配行

> ID：15622114
> 
> 赞同：0
> 
> 时间：2013-03-25T18:29:31.270
> 
> 标签：python, regex, stream, match, python-2.4

我正在使用 Python 2.4，并且在 Python 方面很新，一般编程和正则表达式。我有一个大模块，当前输出两个单独的流（或数据集/文件）的行，流 A 和流 B。我正在尝试将流 A 与流 B 进行比较，以查看流 B 中的任何字符串是否可以在任何行中匹配流 A。我想将所有匹配的内容和所有不匹配的内容作为两个单独的对象返回。请在下面**以粗体查看我的问题**。有谁知道我可以如何克服这个问题或有最佳实践建议？

到目前为止，我已经将流 B（“realtimes”）转换为一个列表（“regexes”）并将该列表转换为一组正则表达式（“combined”），使用此代码

*请注意，我没有包含模块中的所有代码，只是我坚持的部分*：

```
regex = re.compile(r'.*\[(\d{2}:\d{2}:\d{2}\.\d{6})\].*')
optsymbx = re.compile(r'\[(\d{2}:\d{2}:\d{2}\.\d{6})\][\s]+(trade),(S|B),(\d{1,}),(\w+)[\s]+([0-9A-Z]+),(\d+\.\d+)')
regexes = []

def realtimes():
    for x in realtrades():
        x = str(x)
        m = re.match(regex,x)
        if m:
            #regexes.append(str(m.groups()))
            yield str(m.groups())

#make contents of realtimes into group of regular expressions     
f = open(logfile,'r')
for x in realtimes():
    regexes.append(x)
combined = "(" + ")|(".join(regexes) + ")" 
```

然后我查看流 A（f 中的行），并根据“combined”和一个附加的正则表达式标准（“optsymbx”）检查每一行，看看是否有匹配项，如下所示：

```
# checking if any lines in the logfile match "optsymbx" and any regular expressions wihtin "combined"
f = open(logfile,'r')
for line in f:
    m = re.match(combined,line)
    mopt = re.match(optsymbx,line)
    if not m:
        if mopt:
            print line 
```

**问题是流 A 和 B 非常大。流 A 包含超过 100,000 行，流 B 有数千行。因此，当我将 Stream B 的内容转换为一组正则表达式（“组合”）时，它超过了 100 个命名组的容量，并且出现错误：** 另外，我测试并知道当我减小将 Stream B 的内容分成少于 100 个命名组。

```
Traceback (most recent call last):
  File "badtrades.py", line 121, in ?
    m = re.match(combined,line)
  File "/usr/lib64/python2.4/sre.py", line 129, in match
    return _compile(pattern, flags).match(string)
  File "/usr/lib64/python2.4/sre.py", line 225, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/usr/lib64/python2.4/sre_compile.py", line 506, in compile
    raise AssertionError(
AssertionError: sorry, but this version only supports 100 named groups 
```

来自组合的样本数据（来自流 B）：

```
 ["('09:50:31.458370',)", **"('09:50:31.458370',)"**, "('09:50:48.343785',)", "('09:50:48.449219',)", "('09:50:48.449219',)", "('09:50:48.449219',)", "('09:50:48.449219',)", "('09:51:01.986971',)", "('09:51:01.986971',)", "('09:51:01.986971',)", "('09:51:34.543147',)", "('09:52:14.688349',)", "('09:52:14.688349',)", "('09:52:14.688349',)", "('09:52:14.688349',)", "('09:52:19.700134',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:53:06.696156',)", "('09:54:39.295261',)", "('09:54:39.295261',)", "('09:54:44.883143',)", "('09:54:44.883143',)", "('09:54:44.883143',)", "('09:54:44.883143',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:17.750226',)", "('09:55:19.767099',)", "('09:55:26.750094',)", "('09:55:26.750094',)", "('09:55:29.195194',)", "('09:55:29.195194',)", "('09:55:29.195194',)", "('09:55:29.195194',)", "('09:55:29.195194',)", "('09:55:29.722747',)", "('09:56:38.809658',)", "('09:56:38.809658',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:57:38.444653',)", "('09:58:37.573746',)", "('09:58:37.573746',)", "('09:58:37.573746',)", "('09:59:02.185210',)", "('09:59:09.245981',)", "('09:59:33.619633',)", "('09:59:33.619633',)", "('09:59:33.619633',)", "('09:59:33.619633',)"] 
```

来自日志文件（流 A）的样本数据：

```
[09:49:52.515951] T,AAPL  130518C00450000,1,32.05
[09:49:53.568816] T,AAPL  130328P00455000,30,1.09
[09:49:53.811441] trade,S,2,AAPL  130328C00470000,4.75
[09:49:53.811447] trade,B,95,AAPL,468.69
--
[09:50:31.241441] T,AAPL  130328P00430000,3,0.08
[09:50:31.385327] T,AAPL  130328P00455000,5,1.10
[09:50:31.385911] T,AAPL  130328P00455000,5,1.10
[09:50:31.458370] trade,B,2,AAPL  130328C00475000,2.80
[09:50:31.458373] trade,S,68,AAPL,468.46
--
[09:50:48.339322] T,AAPL  130328C00485000,8,0.92
[09:50:48.339341] T,AAPL  130328C00485000,1,0.92
[09:50:48.339357] T,AAPL  130328C00485000,9,0.92
[09:50:48.343785] trade,B,2,AAPL  130328C00465000,7.05
[09:50:48.343789] trade,S,118,AAPL,468.19 
```

匹配将是：

```
data A:  [09:50:31.458370] trade,B,2,AAPL  130328C00475000,2.80
data B:  [09:50:31.458370] 
```

没有匹配是：

```
data A:  [09:49:53.811441] trade,S,2,AAPL  130328C00470000,4.75
data B:  #there is no timestamp from B which matches A 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:36:11.200

忘记正则表达式。您应该仔细阅读每个流。尽可能推进和排序匹配项。一些伪代码：

```
Using Streams A and B, and Objects Match and NoMatch
FETCH next Line of A into LineA
FETCH next Line of B into LineB
WHILE Neither stream is at end of file:
    WHILE TimeStamp in LineA < TimeStamp in LineB:
        ADD LineA to NoMatch
        FETCH next Line of A into LineA
    WHILE TimeStamp in LineA = TimeStamp in LineB:
        Add (LineA, LineB) to Match
        FETCH next Line of A into LineA
    FETCH next Line of B into LineB
WHILE A is not at End of File
    ADD LineA to NoMatch
    FETCH next Line of A into LineA 
```

这将处理 A 中的重复，但不处理 B 中的重复。要处理 B 中的重复，您必须保持对过去行的记忆：

```
Using Streams A and B, and Objects Match, NoMatch and Temp
FETCH next Line of A into LineA
FETCH next Line of B into LineB
WHILE Neither stream is at end of file:
    CLEAR Temp
    WHILE TimeStamp in LineA < TimeStamp in LineB:
        ADD LineA to NoMatch
        FETCH next Line of A into LineA
    WHILE TimeStamp in LineA = TimeStamp in LineB:
        ADD (LineA, LineB) to Match
        ADD LineA to Temp
        SET Temp Timestamp to LineA Timestamp
        FETCH next Line of A into LineA
    FETCH next Line of B into LineB
    WHILE TimeStamp in LineB = Temp TimeStamp:
        FOR Line IN Temp:
            ADD (Line, LineB) TO Match
        FETCH next Line of B into LineB 
WHILE A is not at End of File
    ADD LineA to NoMatch
    FETCH next Line of A into LineA 
```

编辑：我对如何确定 EOF 模棱两可。让我们假设在 EOF 之后读取返回和空字符串（就像在 python 中一样）。实现更像这样：

```
Using Streams A and B, and Objects Match, NoMatch and Temp
FETCH next Line of A into LineA
FETCH next Line of B into LineB
WHILE Neither LineA nor LineB is an Empty String:
    CLEAR Temp
    WHILE LineA is not an Empty String, AND TimeStamp in LineA < TimeStamp in LineB:
        ADD LineA to NoMatch
        FETCH next Line of A into LineA
    WHILE LineA is not an Empty String, AND TimeStamp in LineA = TimeStamp in LineB:
        ADD (LineA, LineB) to Match
        ADD LineA to Temp
        SET Temp Timestamp to LineA Timestamp
        FETCH next Line of A into LineA
    FETCH next Line of B into LineB
    WHILE LineB is not an Empty String, AND TimeStamp in LineB = Temp TimeStamp:
        FOR Line IN Temp:
            ADD (Line, LineB) TO Match
        FETCH next Line of B into LineB 

//At this point, Either LineA is empty (meaning there are no more strings to match),
//or LineB is empty (meaning there are no more matches to find).  If the first is true,
//This loop will be skipped.  Otherwise, this loop will put what's left of A into the 
//Not Matched Object.
WHILE  LineA is not an Empty String:
    ADD LineA to NoMatch
    FETCH next Line of A into LineA 
```

# node.js - Grunt.js 永远关注

> ID：15622116
> 
> 赞同：4
> 
> 时间：2013-03-25T18:29:37.887
> 
> 标签：node.js, gruntjs, forever

## 目标：

我正在尝试在我的守护进程中运行一个`watch`任务。`Gruntfile.js`

通常，我会像这样执行这个脚本：`grunt watch`.

## Gruntfile.js：

```
module.exports = function(grunt) {

  grunt.initConfig({
    concat: {
      options: {
        separator: ''
      },
      dist: {
        src: ['static/js/**/*.js'],
        dest: 'app.js'
      }
    },
    watch: {
      files: ['<%= concat.dist.src %>'],
      tasks: ['concat']
    }
  });

  grunt.loadNpmTasks('grunt-contrib-watch');
  grunt.loadNpmTasks('grunt-contrib-concat');
}; 
```

## 问题：

**我如何** `grunt watch` **作为守护进程生成？**

## 更新：

*似乎已经对此进行了考虑：*
[https ://github.com/shama/grunt-hub#watching-forever](https://github.com/shama/grunt-hub#watching-forever)
[https://github.com/shama/grunt-hub/issues/3](https://github.com/shama/grunt-hub/issues/3)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-05T13:26:59.000

你可以使用[https://github.com/nodejitsu/forever](https://github.com/nodejitsu/forever) exmaple

```
forever start gruntstart.js 
```

gruntstart.js：

```
var exec = require('child_process').exec;

exec('grunt watch > log/grunt.log',
    function (error, stdout, stderr) {
        console.log('stdout: ' + stdout);
        console.log('stderr: ' + stderr);
        if (error !== null) {
           console.log('exec error: ' + error);
        }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T20:57:40.947

我是 javascript 的新手，但我通过以下方式解决了这个问题：**tmux**

1.  用于 git 等简单操作的一个窗格。
2.  另一个是为“**咕噜手表**”

即使我关闭控制台**tmux 也会继续**观看：D
[http://i.imgur.com/9L04OGe.jpg](http://i.imgur.com/9L04OGe.jpg)

# mysql - mysql查询插入不存在的地方

> ID：15622121
> 
> 赞同：1
> 
> 时间：2013-03-25T18:29:54.337
> 
> 标签：mysql, sql, database

我搜索一种在数据库（MySQL）中输入数据的方法，如果它们在 DB 中尚不存在：类似于：

```
 INSERT INTO TABLE(id,name,surname) VALUES('','name1','surname1')
 WHERE NOT EXISTS (SELECT * FROM TABLE) 
```

这个查询有什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T18:31:47.360

虽然您不能使用`NOT EXISTS`上述查询，但可以使用子查询。这是使用 a`LEFT JOIN`和子查询的一种方法：

```
INSERT INTO yourtable (name, surname) 
SELECT a.name, a.surname
FROM  
  (SELECT 'name1' name,'surname1' surname) a 
  LEFT JOIN yourtable b ON 
      a.name = b.name AND a.surname = b.surname
WHERE b.name IS NULL; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/d04fb/1)

和`NOT EXISTS`方法：

```
INSERT INTO yourtable (name, surname) 
SELECT a.name, a.surname
FROM  
  (SELECT 'name1' name,'surname1' surname) a 
WHERE NOT EXISTS (
       SELECT 1 
       FROM yourtable 
       WHERE name = 'name1' and surname = 'surname1') 
```

[更多小提琴](http://sqlfiddle.com/#!2/d93b0/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:05:58.633

假设您有如下定义的表：

```
+------+  +------+
|Names |  |Add   |
+------+  +------+
|ID    |  |ID    |
|FName |  |FName |
|LName |  |LName |
+------+  +------+ 
```

如果您想将 Add 表插入 Names 表而不添加重复项，您可以使用以下 select 语句为您需要的每个 insert 语句创建一行。这也提供了创建审计跟踪的额外好处。

```
Select CONCAT('INSERT INTO Names \(ID, FName, LName\) VALUES \(',a.ID,',',a.FName,',',a.LName,'\)')
From Add a LEFT JOIN Names N on a.ID = n.ID AND a.FName = n.FName AND a.LName = n.FName
Where n.ID is null; 
```

我不确定我的语法是否完美，因为我不使用 mySQL，但它应该在球场上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:39:48.543

建议在提问之前先做功课。如果您在 google 或 stackoverflow 中查找，您可以找到与您类似的问题：

[MySQL：如果表中不存在则插入记录](https://stackoverflow.com/questions/3164505/mysql-insert-record-if-not-exists-in-table)

我相信这会解决你的问题。

需要明确的是：不，您不能在 INSERT 中使用 WHERE。但是是的，您可以锁定表以避免在它们存在的地方插入记录。这称为 CONSTRAINT，需要从表创建中声明。

您需要的一切都在链接的问题中。

# php - 我如何忽略“。” 在 preg_match

> ID：15622122
> 
> 赞同：1
> 
> 时间：2013-03-25T18:30:12.193
> 
> 标签：php, regex

嘿伙计们，我正在尝试使用 preg_match 忽略句点，所以：

```
$pos1 = preg_match( "/.*(#\S+)/", $currentStatus , $match );
$hash = $match[1]; 
```

这将在 twitter API 中获取 2 个标签，但可以说他们有 #hi。<- 它会抓住 . 到，所以如果有人放一个 . 偶然我希望它忽略这一点。

不知道如何做到这一点，并希望得到帮助！

大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:33:05.377

为什么不从结果中删除点：

```
$hash = str_replace('.','', $match[1]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:47:24.713

```
preg_match('/(#\S+[^\.\s])/', $currentStatus, $match); 
```

或者

```
preg_match('/(#[a-zA-Z0-9]+)/', $currentStatus, $match); 
```

# ms-access - ODBC 链接表将 Tinyint 字段转换为是/否

> ID：15622127
> 
> 赞同：0
> 
> 时间：2013-03-25T18:30:25.553
> 
> 标签：ms-access, odbc, ms-access-2007

我正在将 Access .ADP 项目转换为带有链接表的 .ACCDB。我知道使用 SQL Server 后端时的一个大问题是使用可空`bit`字段，因为 Access 的`Yes/No`数据类型不允许空值。所以我将所有可以为空的`bit`字段都转换为`tinyint`. 但是，Access 仍然将这些字段映射为`Yes/No`，并将我的所有空值都转换为零。

有人对如何让它停止这种情况有任何建议吗？我已经仔细检查了有问题的字段是否设置为`tinyint`，并且在 SSMS 中查询我发现绝大多数记录都是空的。但我能想到的就是刷新或删除并重新创建链接表，这并不能解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:03:50.330

就我而言，答案是我应该记住的，但我忘记了。希望将来对其他人有所帮助。

我的链接表实际上链接到后端的视图（我肯定应该在我的问题中提到这一点）。当基础表更改时，视图上的元数据[不会自动刷新。](http://www.bidn.com/blogs/pkumar3/ssas/2703/sql-server-views-some-great-views-about-views)我已将基础表中的所有可为空`bit`字段更改为`tinyint`，但就视图而言，它们仍然是`bit`。

昨晚，我删除并重新创建了所有视图，然后刷新了 Access 中的链接表。问题解决了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:58:42.460

使用可空 int 字段存储 -1（表示是）、0（表示否）和 null（不知道/未定义），我有更多的运气。访问表单完全理解这些值，并且当绑定到复选框并用于过滤等时它们会正确响应。空值（如果您将必需属性设置为否，您可以使用本机访问表执行此操作）将在绑定到复选框时显示为灰色。

# sql - 具有不同列的同一个表的相同查询（对于不同的版本）？

> ID：15622130
> 
> 赞同：1
> 
> 时间：2013-03-25T18:30:44.470
> 
> 标签：sql, sql-server, sql-server-2008

不同模式的相同查询？

你好，

我有一个查询。它在表中查询一些数据。但是，因为有2个不同版本的数据库，所以表列发生了变化。例如：

对于版本 #1，table1 有列：id、value、name 对于版本 #2，table1 有列：id、value、title

（当它是#2时，数据库中有一个新的table2。我用来决定它是#1还是#2。）

现在，我需要编写一个查询以在一个查询中适应这两个版本。

```
 IF OBJECT_ID('dbo.table2', 'U') IS NULL
            BEGIN
                -- version #1
                SELECT *
                FROM table1 t1 INNER JOIN table3 t3 on t1.Name = t3.Name ......
                ...

            END
            ELSE
            BEGIN
                -- version #2
                SELECT *
                FROM table1 t1 INNER JOIN table3 t3 on t1.title = t3.Name ......
                ...
            END 
```

当我为版本 #2 运行它时，它报告错误：t1.Name 无效的列名。

我想可能，我可以使用 EXEC 来解决这个问题。有没有更优雅的方法来做到这一点？

我尝试了 TRY CATCH，它仍然报告相同的错误。

我发现的奇怪的事情是：我有另一个查询，它确实：

1）创建一个临时表#Ldap 2）使用openquery（用于活动目录）将一些数据插入临时表#Ldap。3）然后使用上面的逻辑来判断是版本#1还是#2。

尽管它在管理工作室的编辑器中将 t1.Name 突出显示为错误，但它工作正常。它不报告错误。

这让我想知道：SQL 会先编译整个查询吗？要不然？

有人知道解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:33:27.870

SQL 将尝试解析和评估所有列引用。您可以避免引用不存在的表（延迟名称解析），但您无法摆脱不存在的表上不存在的列。解析器不关心您`IF`和其他条件逻辑在运行时可能产生什么。这就是为什么你不能这样做：

```
IF (1=1)
  CREATE TABLE #foo...
ELSE
  CREATE TABLE #foo... 
```

解析器甚至会阻止那么简单的事情，即使它`ELSE`永远不可能运行。

是的，解决这个问题的方法是动态 SQL（或者首先是更稳定的设计）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:33:37.240

你需要使用`exec`来解决这个问题。该问题发生在处理的编译阶段。它没有在表中找到该列（谢谢 Aaron），所以它失败了。

不幸的是，您无法使用`if`甚至`try catch`块来捕获编译时错误。

但是，您似乎理解了正确的解决方案，即使用动态 SQL。

您还可以通过`t1`在两个版本中创建具有相同列名的视图，然后使用该视图来解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:44:58.937

另一种解决方案可能是在 table1 上创建一个数据库视图，其字段名为`title_Name`（定义为版本 #1 的 table1.Name 和版本 #2 的 table1.title），并使用数据库视图而不是 table1您的查询，像这样加入：

```
INNER JOIN table3 t3 on t1.title_Name = t3.Name 
```

# java - 如何使用 java 和 activeX 在 Bartende 软件上打印标签

> ID：15622131
> 
> 赞同：0
> 
> 时间：2013-03-25T18:30:47.750
> 
> 标签：java, printing, activex, barcode-printing

我正在做一个项目，我需要能够通过调酒师软件打印标签。我打算用 Java 来做，但我不知道如何进行。我下载了试用版，但我无法将 Bartender 连接到我的数据库，因为它不是 SQL Server。但我知道有一种方法可以将数据发送给调酒师以便它可以打印，但我找不到 API，我无法连接到他们我知道我将不得不使用 ActiveX [http://www.bartenderbarcodesoftware.com/标签软件/白皮书/控制条码标签软件使用-activex-automation.pdf](http://www.bartenderbarcodesoftware.com/label-software/whitepapers/controlling-barcode-label-software-using-activex-automation.pdf)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T08:48:17.717

也许本教程有帮助，这家伙使用 BarTender 的 Commander 使其与他们的 Web 应用程序一起工作：http: [//cases.azoft.com/bartender-print-server/](http://cases.azoft.com/bartender-print-server/)

PHP 是一步一步完成的，但据说该方法也适用于其他语言。

# c# - 绑定列表 在带有 caliburn.micro 的数据网格列中

> ID：15622132
> 
> 赞同：0
> 
> 时间：2013-03-25T18:30:47.687
> 
> 标签：c#, wpf, list, caliburn.micro, datagridcolumn

我的课是这样的：

```
public class Articolo : Screen
{
        public string Code { get; set; }
        public string Description { get; set; }
        public decimal Cost{ get; set; }
        public decimal Price{ get; set; }
        public List<Ean> BarCode { get; set; }
} 
```

这个 Ean 类：

```
public class Ean
{
    public string Code{ get; set; }
} 
```

我的数据网格是：

```
<DataGrid Height="367" HorizontalAlignment="Stretch" Margin="14,52,12,0"
         VerticalAlignment="Top" AutoGenerateColumns="False" x:Name="List" >
       <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding Code}" Header="Codice" />
            <DataGridTextColumn Binding="{Binding Description }" Header="Descrizione" />
            <DataGridTextColumn Binding="{Binding Cost}" Header="Quantita" />
            <DataGridTextColumn Binding="{Binding Price}" Header="Prezzo" />
            <DataGridTextColumn Binding="{Binding BarCode}" Header="BarCodes" />
        </DataGrid.Columns>
</DataGrid> 
```

他是 ViewModel 的一员：

```
 [Export(typeof(IScreen))]
    public class BolleViewModel : Screen
    {
        public List<Articolo> List { get; private set; }

        public BViewModel()
        {
            Recover recover = new Recover();
            List = recover.Import();
            NotifyOfPropertyChange("List");
        }
    } 
```

在 BarCodes 列中写入（集合）！而不是条形码。为什么？如何查看列中的条码列表？谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:00:26.353

`BarCode`是 a`List<T>`并且 的`ToString()`方法`List<T>`本身并不显示列表的内容。

您可以做的最简单的事情可能是实现[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)并将此转换器应用到您的`BarCode`绑定中。

首先，转换器可能看起来像这样：

```
public class EanListToStringConverter : IValueConverter {
   public object Convert(object value, Type targetType, 
                         object parameter, CultureInfo culture) {
      return String.Join(" ", ((List<Ean>)value).Select(ean => ean.Code));
   }
   public object ConvertBack(object value, Type targetType, 
                             object parameter, CultureInfo culture) {
      return NotSupportedException();
   }
} 
```

然后，您需要在视图中添加一个转换器实例作为资源：

```
<Grid.Resources>
    <converters:EanListToStringConverter x:Key="EanListToString"/>
</Grid.Resources> 
```

最后在您的`BarCode`绑定中调用此实例，如下所示：

```
<DataGridTextColumn Binding="{Binding BarCode, 
    Converter={StaticResource EanListToString}}" Header="BarCodes" /> 
```

# java - Java 不喜欢下载文件。

> ID：15622133
> 
> 赞同：0
> 
> 时间：2013-03-25T18:30:49.167
> 
> 标签：java, swing, download

我正在创建一个具有多种更新功能的 Swing GUI。如果用户没有正确更新，它将显示“下载并安装”按钮。这很好用，但按下按钮什么也没做。它没有冻结，它只是坐在那里。尽管如此，“setup.exe”是一个相当大的文件（~600MB），但它没有显示任何内容，该文件甚至没有开始出现在 C:\ 目录中。我在这里做错了什么？

```
protected static JButton aroundTheLake; 

private static JButton aroundTheRiver() {
    aroundTheLake = new JButton("DOWNLOAD & INSTALL!");
    aroundTheLake.setVerticalTextPosition(AbstractButton.CENTER);
    aroundTheLake.setHorizontalTextPosition(AbstractButton.LEADING); //aka LEFT, for left-to-right locales
    aroundTheLake.setMnemonic(KeyEvent.VK_D);
    aroundTheLake.setActionCommand("aroundthelake");
    return aroundTheLake;
}

private static String readURL(String targetURL) {
    String returnish = "";
    try {
        URL tempURL = new URL(targetURL); 
        Scanner s = new Scanner(tempURL.openStream()); 
        while (s.hasNextLine()) {
            returnish = returnish+s.nextLine(); 
        }
    } catch (IOException e) {
        System.out.println(e); 
    }
    return returnish;
}

private static String readFile(String targetFile) { 
    String returnString = "";
    try {
        File tempFile = new File(targetFile);
        Scanner s = new Scanner(tempFile);
        while (s.hasNextLine()) {
            returnString = returnString + s.nextLine(); 
        }
    } catch(IOException e) { 
        // !
        System.out.println(e);
    }
    return returnString;
}

public void actionPerformed(ActionEvent e) {
    if ("aroundthelake".equals(e.getActionCommand())) {
        try { 
                System.out.println("initiated");
                URL website = new URL("http://theneverhood.sourceforge.net/setup.exe");
                ReadableByteChannel rbc = Channels.newChannel(website.openStream());
                FileOutputStream fos = new FileOutputStream("setup.exe");
                fos.getChannel().transferFrom(rbc, 0, 1 << 24);
        } catch (IOException exc) { 
            System.out.println(exc);
        }
    } else {
        // man
    }
}

private static void showGUI() {
    JFrame frame = new JFrame("The Neverhood Restoration Project");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(new Dimension(1024, 600));
    frame.setExtendedState(frame.MAXIMIZED_BOTH);
    frame.getContentPane().setBackground(new Color(0xA64343));

    File fileCheck = new File("C:/Program Files (x86)");
    String returnString = null;
    String rootDirectory = null;
    if (fileCheck.exists()) {
        rootDirectory = "C:/Program Files (x86)/DreamWorks Interactive"; 
        String checkFile = rootDirectory+"/Neverhood/version.txt"; 
        File tempFile = new File(checkFile);
        if (tempFile.exists()) {
            returnString = readFile(checkFile);
        } else {
            returnString = "It appears you do not have the Neverhood Restoration Project installed, or you are using an earlier version."; 
        }
    } else {
        rootDirectory = "C:/Program Files/DreamWorks Interactive";
        String checkFile = rootDirectory+"/Neverhood/version.txt"; 
        File tempFile = new File(checkFile);
        if (tempFile.exists()) {
            returnString = readFile(checkFile);
        } else {
            returnString = "It appears you do not have the Neverhood Restoration Project installed, or you are using an earlier version.";
        }
    }
    if (returnString.equals(readURL("http://theneverhood.sourceforge.net/version.txt"))) {
        returnString = "You are updated to the recent version!"; 
    } else { 
        returnString = "It appears you're not updated.";
    }

    JLabel headerLabel = new JLabel("The Neverhood Restoration Project");
    headerLabel.setHorizontalAlignment(JLabel.CENTER);
    JPanel heapPanel = new JPanel();
    heapPanel.setLayout(new BoxLayout(heapPanel, BoxLayout.PAGE_AXIS));
    heapPanel.setPreferredSize(new Dimension(500, heapPanel.getPreferredSize().height));
    JTextArea heapLabel = new JTextArea(50, 50);        
    heapLabel.setLineWrap(true);
    heapLabel.setWrapStyleWord(true);
    heapLabel.setEditable(false);
    heapLabel.setBorder(BorderFactory.createEmptyBorder(10, 20, 10, 20));
    heapLabel.setFont(new Font("Serif", Font.PLAIN, 14));
    heapLabel.append("Current version: "+readURL("http://theneverhood.sourceforge.net/prettyversion.txt")+".\nInstalled version: "+readFile(rootDirectory+"/Neverhood/prettyversion.txt")+".\n"+returnString+"\n" + 
        "You can read the full version of the document to the left at http://theneverhood.sourceforge.net."
        + "\nHaven't installed yet? Below is the download button. Just click to save setup.exe in and enjoy!");
    heapPanel.add(heapLabel);
    if (returnString == "It appears you're not updated.") { 
        heapPanel.add(aroundTheRiver());
    }

    try {
        Font sFont = Font.createFont(Font.TRUETYPE_FONT, new File("DUGFB___.TTF"));
        sFont = sFont.deriveFont(Font.PLAIN, 48);
        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        ge.registerFont(sFont);
        headerLabel.setFont(sFont);
    } catch (FontFormatException | IOException e) {
        System.out.println(e);
    }

    BufferedImage icoImage = null;
    try {
        icoImage = ImageIO.read(
            frame.getClass().getResource("/nhood.bmp"));
    } catch (IOException e) {
        System.out.println(e);
    }
    frame.setIconImage(icoImage);

    JEditorPane updateLog = new JEditorPane();
    JScrollPane scrollPane = new JScrollPane(updateLog);
    updateLog.setEditable(false);

    try {
        updateLog.setPage("http://theneverhood.sourceforge.net/");
    } catch (IOException e) {
        updateLog.setContentType("text/html");
        updateLog.setText("<html>The application could not load the webpage.</html>");
    }

    frame.add(headerLabel, BorderLayout.NORTH);
    frame.add(scrollPane);
    frame.add(heapPanel, BorderLayout.EAST);
    frame.pack();
    frame.setVisible(true);
}

public static void main(String[] args) {
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            showGUI();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:35:57.670

您的代码中有两个主要问题：

*   您尚未将动作侦听器注册到您的按钮。像这样做：

```
button.addActionListener(this); 
```

*   `actionPerformed()`在 GUI 线程 ( [EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html) ) 上执行，因此请避免对其执行密集操作。而是使用[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)。请参阅[SwingWorker 的工作原理](https://stackoverflow.com/a/11546203/597657)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:35:36.033

有几件事：

1)**永远不要**从 Swing 线程进行网络调用！使用[SwingWorker](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)。当 Swing EDT 被阻止时，所有 UI 操作都会停止。请参阅[此处](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)了解更多信息。

2) 你真的不需要重写 JButton。只需添加一个 ActionListener 即可。通过这种方式，您正在使您的代码不那么灵活。

3）确保您实际调用[addActionListener()](http://docs.oracle.com/javase/7/docs/api/javax/swing/AbstractButton.html#addActionListener%28java.awt.event.ActionListener%29)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:35:48.140

用户界面冻结，因为您使事件调度线程忙于下载。

事件分派线程与维护 UI“活动”的线程相同 - 您**永远**不应该直接在事件处理程序中执行任何需要很长时间的事情。

您应该做的是启动一个单独的线程来下载文件。为了使这个用户友好，您可以使用[进度监视器](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html#monitors)，以便用户看到您的程序正在做什么，以及理想情况下需要多长时间。我建议阅读本[教程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)以了解它是如何完成的。

一个快速的解决方案就是启动一个新线程。但是，这不是非常用户友好，因为绝对不会有用户反馈。

```
public void actionPerformed(ActionEvent e) {
    if ("aroundthelake".equals(e.getActionCommand())) {
        new Thread() {
            public void run() {
                try { 
                    System.out.println("initiated");
                    URL website = new URL("http://theneverhood.sourceforge.net/setup.exe"); 
                    ReadableByteChannel rbc = Channels.newChannel(website.openStream());
                    FileOutputStream fos = new FileOutputStream("setup.exe");
                    fos.getChannel().transferFrom(rbc, 0, 1 << 24);
                } catch (IOException exc) { 
                    System.out.println(exc);
                }   
            }   
        }.start();

    } else {
        // man
    }   
} 
```

# java - Eclipse中光标前的矩形

> ID：15622137
> 
> 赞同：1
> 
> 时间：2013-03-25T18:31:02.470
> 
> 标签：java, eclipse

我在 Eclipse 中有这个奇怪的矩形，以前从未见过。它不会出现在其他任何地方的代码中。

![在此处输入图像描述](../Images/17723094f5836968d4831cdd1661710a.png)

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:21:54.417

通常这种“矩形光标”仅在您开始重构或使用模板时出现，这样 Eclipse 就希望您为标识符或其他符号输入一个新名称。如果是这种情况，只需点击 ，此光标就会消失`Escape`。

# r - R 不适用于 Sublime Text2

> ID：15622138
> 
> 赞同：1
> 
> 时间：2013-03-25T18:31:08.403
> 
> 标签：r, sublimetext2, sublimerepl

我正在尝试让 R 2.15.3 与 Sublime Text 2 一起使用。我按照[http://tomschenkjr.net/using-sublime-text-2-for-r/](http://tomschenkjr.net/using-sublime-text-2-for-r/)中的步骤操作。当我尝试`Tools -> SublimeREPL -> R`时，我收到一条错误消息

```
 WindowsError(2,'The system cannot find the file specified.'). 
```

我已经仔细检查过，我在 default_extend_env 中提到的路径是正确的。

有人可以告诉我可能是什么问题，以及我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T00:20:00.777

我想这可能对您有用 [http://tomschenkjr.net/using-sublime-text-2-for-r/](http://tomschenkjr.net/using-sublime-text-2-for-r/)，请注意这是 PC 中的一种设置方式。

# javascript - For 循环后缺少 )。不知道出了什么问题。

> ID：15622141
> 
> 赞同：0
> 
> 时间：2013-03-25T18:31:20.403
> 
> 标签：javascript, xml-parsing

我正在尝试运行此脚本来解析 XML 文档。当我验证 js 时，我在 for 循环后丢失了 )。我是编程新手，不知道哪里出错了。我已经在最后发布了整个 js 文件。谢谢！

```
var meds = [];
for (var i = docMedActivities.size(); i--; i &gt;= 0) {
    var activity = docMedActivities.get(i);
    var material = activity.getConsumable().getManufacturedProduct().getManufacturedMaterial();

meds.push({ 
    name: String(material.getName().getText()),
    displayName: String(material.getCode().getDisplayName()),
    ndc: String(material.getCode().getTranslations().get(0).getCode()),
    doseQty: String(activity.getDoseQuantity().getValue()),
    effectiveDateTime: String(activity.getEffectiveTimes().get(0).getLow().getValue()), // 20120502000000+0000
    code: String(material.getCode().getCode())
});
} 
```

整个js文件如下：

```
// Load the CCD Document
var doc = org.openhealthtools.mdht.uml.cda.util.CDAUtil.load(new java.io.ByteArrayInputStream(messageObject.getRawData().getBytes("UTF-8")));

// Get CCD Document Sections to be parsed
var docPatientRole = doc.getRecordTargets().get(0).getPatientRole();
var docPatient = docPatientRole.getPatient();
var docPatientName = docPatient.getNames().get(0);
var docPatientAddress = docPatientRole.getAddrs().get(0);
var docMedSection = doc.getMedicationsSection();
var docMedActivities = docMedSection.getMedicationActivities();

// Patient Identity
var patient = {
firstName:  String(docPatientName.getGivens().get(0).getText()),
lastName: String(docPatientName.getFamilies().get(0).getText()),
genderCode: String(docPatient.getAdministrativeGenderCode().getCode()),
dateOfBirth: String(docPatient.getBirthTime().getValue()) // YYYYMMDD
};

// Patient Address
var address = {
addressCity: String(docPatientAddress.getCities().get(0).getText()),
addressState: String(docPatientAddress.getStates().get(0).getText()),
addressPostalCode: String(docPatientAddress.getPostalCodes().get(0).getText())
};

// Patient Medication Activities
var meds = [];
for (var i = docMedActivities.size(); i--; i &gt;= 0) {
var activity = docMedActivities.get(i);
var material =   activity.getConsumable().getManufacturedProduct().getManufacturedMaterial();

meds.push({
    name: String(material.getName().getText()),
    displayName: String(material.getCode().getDisplayName()),
    ndc: String(material.getCode().getTranslations().get(0).getCode()),
    doseQty: String(activity.getDoseQuantity().getValue()),
    effectiveDateTime: String(activity.getEffectiveTimes().get(0).getLow().getValue()), // 20120502000000+0000
    code: String(material.getCode().getCode())
});
}

// Populate Channel Map, use JSON so logs are readable
channelMap.put(&apos;patient&apos;, JSON.stringify(patient, null, 2));
channelMap.put(&apos;address&apos;, JSON.stringify(address, null, 2));
channelMap.put(&apos;meds&apos;, JSON.stringify(meds, null, 2));</script>
      <type>JavaScript</type>
      <data class="map">
        <entry>
          <string>Script</string>
          <string>// Load the CCD Document
var doc = org.openhealthtools.mdht.uml.cda.util.CDAUtil.load(new    java.io.ByteArrayInputStream(messageObject.getRawData().getBytes(&quot;UTF-8&quot;)));

// Get CCD Document Sections to be parsed
var docPatientRole = doc.getRecordTargets().get(0).getPatientRole();
var docPatient = docPatientRole.getPatient();
var docPatientName = docPatient.getNames().get(0);
var docPatientAddress = docPatientRole.getAddrs().get(0);
var docMedSection = doc.getMedicationsSection();
var docMedActivities = docMedSection.getMedicationActivities();

// Patient Identity
var patient = {
firstName:  String(docPatientName.getGivens().get(0).getText()),
lastName: String(docPatientName.getFamilies().get(0).getText()),
genderCode: String(docPatient.getAdministrativeGenderCode().getCode()),
dateOfBirth: String(docPatient.getBirthTime().getValue()) // YYYYMMDD
};

// Patient Address
var address = {
addressCity: String(docPatientAddress.getCities().get(0).getText()),
addressState: String(docPatientAddress.getStates().get(0).getText()),
addressPostalCode: String(docPatientAddress.getPostalCodes().get(0).getText())
};

// Patient Medication Activities
var meds = [];
for (var i = docMedActivities.size(); i--; i &gt;= 0) {
var activity = docMedActivities.get(i);
var material =   activity.getConsumable().getManufacturedProduct().getManufacturedMaterial();

meds.push({
    name: String(material.getName().getText()),
    displayName: String(material.getCode().getDisplayName()),
    ndc: String(material.getCode().getTranslations().get(0).getCode()),
    doseQty: String(activity.getDoseQuantity().getValue()),
    effectiveDateTime: String(activity.getEffectiveTimes().get(0).getLow().getValue()), // 20120502000000+0000
    code: String(material.getCode().getCode())
});
}

// Populate Channel Map, use JSON so logs are readable
channelMap.put(&apos;patient&apos;, JSON.stringify(patient, null, 2));
channelMap.put(&apos;address&apos;, JSON.stringify(address, null, 2));
channelMap.put(&apos;meds&apos;, JSON.stringify(meds, null, 2)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:32:31.913

在 JS 文件中，您需要编写`>=`而不是`&gt;=`; 后者仅在 JS 嵌入 (X)HTML PCDATA 时才有意义。

（错误消息的奇怪措辞的原因是验证器将其解释`gt`为标识符，并使用[按位与运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)`i & gt`解释为表达式。因此，当它看到分号时，它认为-loop 标头应该结束。）`for`

* * *

**编辑添加：**此外，虽然您的`for`-loop 在您进行此更改后将起作用，但这只是由于一系列奇怪的怪癖和巧合。这个：

```
for (var i = docMedActivities.size(); i--; i >= 0) {
    ...
} 
```

这意味着：

```
var i = docMedActivities.size();
while (i--) {      // note the post-increment: i-- evaluates to i's old value
    ...
    i >= 0;        // note that this expression has no side-effects
} 
```

这相当于：

```
var i = docMedActivities.size();
while (i != 0) {
    i--;
    ...
}
i--; 
```

碰巧做你想做的事。因此，您的代码恰好可以正常工作，但这并不是因为它*看起来*确实如此，并且将来任何微小的更改都会以令人困惑的方式破坏它。

你真正想写的是：

```
for (var i = docMedActivities.size() - 1; i >= 0; i--) {
    ...
} 
```

（在初始化表达式中`i >= 0`出现*，* `i--`并且`- 1`在初始化表达式中出现）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:37:20.943

在脚本中，您不需要转义 HTML 实体。JS 解析器在您的 for 语句中检测到 3 个分号，这是一个过多而无效的分号 - 需要一个右括号。

此外，您已经用更新代码交换了条件。将其更改为

```
for (var i = docMedActivities.size(); i>=0; i--) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:35:59.443

问题在于循环的这一部分：`i &gt;= 0`

在第三个逗号之后，for 语句通常结束，这就是为什么需要/需要右括号的原因。将 更改`&gt;`为`>`。意思是“`&gt;`大于”，建议您从某处复制此代码，但可能需要在其他地方更改。

另外，我很确定您的 for 语句的顺序应该是：

```
for (var i = docMedActivities.size(); i >= 0; i--) { 
```

请注意，`i--`应该是语句的第三部分，而“大于”部分应该是第二部分。最后一部分后面的逗号也不是必需的。

由于您是编码新手，我建议您至少查看一下[这个关于 for-loops 的页面。](http://www.w3schools.com/js/js_loop_for.asp)但是总体上看一下 JavaScript 的一些介绍会是一个好主意。

希望这可以帮助。

# google-maps-api-3 - 使用谷歌地图 api 的 3 个字符国家代码

> ID：15622145
> 
> 赞同：2
> 
> 时间：2013-03-25T18:31:24.780
> 
> 标签：google-maps-api-3

有没有办法在谷歌地图的反向地理编码中获得 3 个字符的国家代码？

下面的查询返回 2 个字符的国家代码（ISO 3166-1 编码）。但我需要有 3 个字符的国家代码。 [http://maps.google.com/maps/api/geocode/xml?latlng=40.714224,-73.961452&sensor=false](http://maps.google.com/maps/api/geocode/xml?latlng=40.714224,-73.961452&sensor=false)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T22:17:27.093

You can use a lookup table based on javascript multi dimensional array and using [**jquery**](http://jquery.com/)

```
var countries = [
{"two" : "AF","three" : "AFG" },
{"two" : "AL","three" : "ALB" },
{"two" : "DZ","three" : "DZA" },
{"two" : "AS","three" : "ASM" },
{"two" : "AD","three" : "AND" },
{"two" : "AO","three" : "AGO" },
{"two" : "AI","three" : "AIA" },
{"two" : "AQ","three" : "ATA" },
{"two" : "AG","three" : "ATG" },
{"two" : "AR","three" : "ARG" },
{"two" : "AM","three" : "ARM" },
{"two" : "AW","three" : "ABW" }
];//etc

var getKeyByParameter = function(obj, parameter) {
var returnVal = "";

$.each(obj, function(key, info) {
    if (info.two == parameter) {
       returnVal = info.three;
        return false; 
    };   
});

return returnVal;       

}

console.log(getKeyByParameter(countries, 'AG')); 
```

Returns ATG

# asp.net - 用户注销时的 AJAX 请求

> ID：15622146
> 
> 赞同：0
> 
> 时间：2013-03-25T18:31:25.693
> 
> 标签：asp.net, ajax, webforms

我在我的 ASP.net 应用程序中发出**许多**AJAX 请求，但是现在，当用户注销时，登录表单只会显示在我使用响应文本的任何地方。

我该如何处理这个问题？我无法重新概念所有响应，因此如果用户退出，我会得到某个响应，因为它们*太多了*。

有没有办法可以处理所有回复？所有响应均由特定文件夹中的 Generic Halndlers .ashx 处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:45:24.030

您可以使用命令功能在整个站点上实现这一点来验证会话。这可以通过两步过程来实现

步骤1：

在 ajax 完成函数调用 validateSession 中，您将根据会话/登录页面内容重定向到登录页面。

```
complete: function(XHR, status){   //handle session out
            validateSession(XHR.responseText);
        }, 
```

第2步：

现在通过检查登录页面中的一些文本来处理会话和重定向。在我的示例中，我在登录页面中放置了 :SESSION EXPIRED: 字符串

```
 function validateSession(strAjaxOutput, strStatus, objXhr)
    {
    if(("undefined" != typeof strStatus) && ("undefined" != typeof objXhr))
    {
    strAjaxOutput = objXhr.responseText;
    }
    var reg = /:SESSION EXPIRED:/;
    if(reg.test(strAjaxOutput))
    {
    window.location = "http://www.myloginpage.com"; //redirect to login page
    return false;
    }
    else
    {
    return true;
    }
    } 
```

# testing - 如何使用 selenium Web 驱动程序自动测试基于触摸和多点触摸的 Web 应用程序？

> ID：15622147
> 
> 赞同：1
> 
> 时间：2013-03-25T18:31:28.770
> 
> 标签：testing, selenium, touch, multi-touch, ui-automation

我正在为各种 Web 应用程序使用 cucumber 和 selenium 编写一些自动化测试。目前这运作良好，但我们即将开始制作我们页面的移动特定版本。

我知道点击与触摸非常相似，但是我们希望能够测试一些东西，例如

*   拖动
*   刷卡
*   旋转设备
*   捏放大

我计划使用 selenium WebDriver 和 selenium 网格来实现大部分测试，除了 Firefox WebDriver 之外，我在运行任何 WebDriver 方面没有太多经验，但是我找不到任何提到触摸界面的东西。这是目前硒缺乏的东西吗，有人知道任何其他可能允许触摸界面控制的项目或驱动程序吗？

随着移动 Web 设备和浏览器的爆炸式增长，拥有自动化测试方式是我们可以管理此测试的唯一方法。

断言页面的显示是另一个问题，就这个问题而言，它超出了范围，但是我计划结合使用硒断言和[对抗布局错误](https://code.google.com/p/fighting-layout-bugs/)类型测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:44:24.480

[这个博客](http://google-opensource.blogspot.com/2011/10/test-your-mobile-web-apps-with.html)怎么样。

旋转设备示例

```
 assertEquals(landscapeSize, secondImage.getSize()) 
((Rotatable) driver).rotate(ScreenOrientation.PORTRAIT); 
assertEquals(portraitSize, secondImage.getSize()); 
```

# asp.net-mvc - 模拟 HttpPostedFileBase 和 InputStream 进行单元测试

> ID：15622153
> 
> 赞同：24
> 
> 时间：2013-03-25T18:31:44.390
> 
> 标签：asp.net-mvc, unit-testing, moq, httppostedfilebase

我想测试以下代码行：

```
...
Bitmap uploadedPicture = Bitmap.FromStream(model.Picture.InputStream) as Bitmap;
... 
```

图片是我的模型类型 HttpPostedFileBase 中的一个属性。所以我想模拟一个用于单元测试的 HttpPostedFileBase 属性：

```
model.Picture = new Mock<HttpPostedFileBase>().Object; 
```

完全没有问题。

现在我必须模拟 InputStream，否则它为空：

```
model.Picture.InputStream = new Mock<Stream>().Object; 
```

这不起作用，因为 InputStream 是只读的（没有 setter 方法）：

```
public virtual Stream InputStream { get; } 
```

有没有一个好的和干净的方法来处理这个问题？一种解决方案是在派生类中为我的单元测试覆盖 HttpPostedFileBase。还有什么想法吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-17T14:39:09.513

您好 :) 我做了类似的事情，

```
 [TestInitialize]
    public void SetUp()
    {
        _stream = new FileStream(string.Format(
                        ConfigurationManager.AppSettings["File"],
                        AppDomain.CurrentDomain.BaseDirectory), 
                     FileMode.Open);

        // Other stuff
    } 
```

在测试本身上，

```
 [TestMethod]
    public void FileUploadTest() 
    {
        // Other stuff

        #region Mock HttpPostedFileBase

        var context = new Mock<HttpContextBase>();
        var request = new Mock<HttpRequestBase>();
        var files = new Mock<HttpFileCollectionBase>();
        var file = new Mock<HttpPostedFileBase>();
        context.Setup(x => x.Request).Returns(request.Object);

        files.Setup(x => x.Count).Returns(1);

        // The required properties from my Controller side
        file.Setup(x => x.InputStream).Returns(_stream);
        file.Setup(x => x.ContentLength).Returns((int)_stream.Length);
        file.Setup(x => x.FileName).Returns(_stream.Name);

        files.Setup(x => x.Get(0).InputStream).Returns(file.Object.InputStream);
        request.Setup(x => x.Files).Returns(files.Object);
        request.Setup(x => x.Files[0]).Returns(file.Object);

        _controller.ControllerContext = new ControllerContext(
                                 context.Object, new RouteData(), _controller);

        // The rest...
    } 
```

希望这可以为您的解决方案提供一个想法:)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-04-24T15:56:22.940

我一直在做类似的事情，并想在@TiagoC13 的答案中添加以下内容。

我正在测试的系统是我正在编写的文件服务，其中一个要求是测试文件是否具有正确的尺寸。请注意，硬编码的文件名。这在我的测试项目中作为文件夹和文件存在。该文件的属性如下： Build Action : Embedded Resource and Copy to Output Directory: Copy if newer (尽管 Copy Always 应该可以正常工作)

构建项目后，testimage.jpg 及其文件夹将添加到测试找到它的 bin 中。

还要注意 fileStream.Close(); 这将释放文件，因此您可以在同一个套件中进行许多类似的测试。

希望这是有帮助的。

```
using Moq;
using NUnit.Framework;
using System.Web;

    [Test]
    public void IsValidFile() {
        string filePath = Path.GetFullPath(@"testfiles\testimage.jpg");
        FileStream fileStream = new FileStream(filePath, FileMode.Open);
        Mock<HttpPostedFileBase> uploadedFile = new Mock<HttpPostedFileBase>();

        uploadedFile
            .Setup(f => f.ContentLength)
            .Returns(10);

        uploadedFile
            .Setup(f => f.FileName)
            .Returns("testimage.jpg");

        uploadedFile
            .Setup(f => f.InputStream)
            .Returns(fileStream);

        var actual = fileSystemService.IsValidImage(uploadedFile.Object, 720, 960);

        Assert.That(actual, Is.True);

        fileStream.Close();
    } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-08-18T15:38:42.287

无需通过打开磁盘上的文件来创建流。实际上，我认为这是一个非常可怕的解决方案。可以在内存中轻松创建工作测试流。

```
var postedFile = new Mock<HttpPostedFileBase>();

using (var stream = new MemoryStream())
using (var bmp = new Bitmap(1, 1))
{
    var graphics = Graphics.FromImage(bmp);
    graphics.FillRectangle(Brushes.Black, 0, 0, 1, 1);
    bmp.Save(stream, ImageFormat.Jpeg);

    postedFile.Setup(pf => pf.InputStream).Returns(stream);

    // Assert something with postedFile here   
} 
```

# git - github在分支删除后未能推送一些参考

> ID：15622161
> 
> 赞同：2
> 
> 时间：2013-03-25T18:32:15.830
> 
> 标签：git, github, branch, push

我创建了一个`tabbar`只有 1 次提交的本地分支并推送了它`git push origin tabbar`。然后我决定对该提交进行更改，并对其进行修改。远程分支从未合并，所以我去了 github 并按了删除分支。所以现在我不能推送那个提交——git给了我

`error: src refspec tabbar does not match any.`

`error: failed to push some refs to 'https://github.com/myName/Myproject.git'`，即使我更改了本地分支的名称。

有人可以帮我解决这个问题吗？我对github不是很熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T03:05:45.680

虽然我不知道为什么会出现这个问题，但你可以试试`git push origin tabbar:tabbar`

# c++ - Qt：数据目录的路径

> ID：15622167
> 
> 赞同：3
> 
> 时间：2013-03-25T18:32:36.557
> 
> 标签：c++, qt

我有一个 Qt 应用程序，其中有大量数据存储在一个名为“Data”的文件夹中，该文件夹与应用程序 qrc 文件位于同一目录中。

我想以某种方式让应用程序知道在哪里可以找到这个文件夹。我不想将所有数据添加为资源文件，因为我希望能够在 Data 目录中添加和删除新数据文件，而不必每次都重新编译。我不想硬编码相对文件路径，因为执行目录可能会因操作系统、应用程序的启动方式等而有所不同，我不想硬编码绝对目录，因为如果应用程序是在不同的机器上编译。

如何让我的应用程序知道在哪里查找数据文件夹？整个项目的目录结构将是相同的，无论它在什么操作系统/机器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:41:11.777

应用程序目录可通过[QCoreApplication.applicationDirPath()](http://qt-project.org/doc/qt-4.8/qcoreapplication.html#applicationDirPath)获得，可通过 global 获得`qApp`：

```
 #include <QApplication>

  ...
  QString appDir = qApp.applicationDirPath(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:36:56.867

有一个 xml 配置文件，其中包含 OS 应用程序的所有可能组合的列表以及要读取的相应路径。

在启动时读取配置文件并检查操作系统版本和其他配置以决定从读取的 xml 文件中使用哪个路径

# parameters - 是否有可能创建一个类似类型的函数

> ID：15622170
> 
> 赞同：0
> 
> 时间：2013-03-25T18:32:37.910
> 
> 标签：parameters, parameter-passing, javascript, invocation

我做了一个更准确的`typeof`-function 并希望像默认`typeof`-operator 一样使用它。`typeOf()`目前，我像其他所有函数一样调用我的 -function : `typeOf("foo")`，但是是否可以在不在其括号中定义它们的情况下获取函数参数？就像`typeof`- 运算符一样。

默认：`typeof "foo" === "string"`

想要的：`typeOf "foo" === "string"`

我尝试的是定义和覆盖一个全局变量，可以，但是是的，不是真正的解决方案：

```
window.typeOf = "foo";
(function(window) {
    window.typeOf = (Object.prototype.toString.call(window.typeOf).match(/\[object (.+)\]/)[1] + "").toLowerCase();
}(this));

console.log(typeOf); // "string" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:34:27.560

> ...是否可以获取函数参数而不在其括号中定义它们？

不，不是。这将要求 JavaScript 允许您创建一个新的*operator*，而不是 function，这不是该语言所具有的功能。（有两个函数——`toString`和`valueOf` ——可以作为表达式的一部分在对象上被隐式调用，但这在这里对你没有帮助。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:40:13.777

No this is not possible in normal javascript. You can't define custom operators, only objects and therefore functions. You also can't change javascripts syntax for calling functions.

If you really want to use syntax like this you can use coffeescript and write code like this

```
typeOf = (x) -> "whatever you want"

typeOf "string" 
```

which will translate to javascript like this

```
var typeOf;

typeOf = function(x) {
  return "whatever you want";
};

typeOf("string"); 
```

[Example](http://coffeescript.org/#try:typeOf%20%3D%20(x)%20-%3E%20%22whatever%20you%20want%22%0A%0AtypeOf%20%22string%22)

But there's no way to replicate that in pure javascript.

### A quick aside

One more note: I wouldn't advise naming this operator typeOf even if you did have it. Naming 2 things that act similarly but act slightly different the same thing other than a single capitalized letter is just begging for subtle typo errors that are hard to trackdown and check. Something like `exactType` or something else different would remove the potential confusion/bugs.

# c# - 汇总 DataGridView 中某列的值

> ID：15622173
> 
> 赞同：0
> 
> 时间：2013-03-25T18:32:47.827
> 
> 标签：c#, winforms

我有一个带有 4 列的简单 dataGridView。我想总结第三列中的值，并在按下按钮时将结果保存到变量中。我试过这样，但我总是得到一个错误说

> “指定的转换无效 - 从数字转换时，值必须小于无穷大”。

PS 每个单元格基本上都是一个 DataGridViewTextBoxColumn，这意味着我可以直接输入值。

代码：

```
private void button2_Click(object sender, EventArgs e)
    {
        Double result = 0;
        foreach (DataGridViewRow row in this.dataGridView1.Rows)
        {
            result += (Double)row.Cells[2].Value;
        }

        this.label13.Text = result .ToString();
    } 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:44:02.447

而不是铸造，尝试

```
result += Convert.ToDouble(row.Cells[2].Value); 
```

带错误检查

```
if (row.Cells[2].Value != null)
{
    try
    {
        result += Convert.ToDouble(row.Cells[2].Value);
    }
    catch { }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-08T14:59:49.743

```
DataTable dt =DataGridView1.DataSource as DataTable;

decimal total;

total=(int)dt.Compute("sum(column_name)",""); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-04T18:27:52.030

```
private getColSum()
{
    int sum = 0;
    for (int i = 0; i < dataGridView1.Rows.Count; ++i)
    {
        sum += Convert.ToInt32(dataGridView1.Rows[i].Cells[2].Value);
    }
    return sum;
} 
```

# html - IE9 表单 = 属性不起作用

> ID：15622178
> 
> 赞同：1
> 
> 时间：2013-03-25T18:33:11.103
> 
> 标签：html, forms, internet-explorer-9

我在一个复杂的页面上有多个表单，其中的字段由相当多的中间 HTML 分隔。在 Firefox 和 chrome 中，我可以声明一个表单并关闭它，然后在要与表单关联的字段中放置一个 form="xxx" 属性。这在 IE9 中似乎不起作用。

这是一个简化的示例：

```
 <?php
if (isset($_POST["field1"])) echo "Field1: " . $_POST["field1"] . "<br>";
if (isset($_POST["Btn1"])) echo "Btn1: " . $_POST["Btn1"] . "<br>";
if (isset($_POST["Btn2"])) echo "Btn2: " . $_POST["Btn2"] . "<br>";
?>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test Page</title>
    <link rel="stylesheet" href="css/normalize.css" media="all">
    <!--[if lt IE 9]>
      <script src="js/html5shiv-printshiv.js" media="all"></script>
    <![endif]-->
  </head>
  <body>
    <form id="form1" action="Test.php" method="POST"></form>
    <input type="text" form="form1" id="field1" name="field1" value="text input">
    <button type="submit" form="form1" id="Btn1" name="Btn1" value="Btn1" title="Btn1">
      Btn1</button>
    <input type="submit" form="form1" id="Btn2" name="Btn2" value="Btn2" title="Btn2">
  </body>
</html> 
```

我尝试添加 < meta http-equiv="X-UA-Compatible" content="IE=9" > ... 没有变化。

...其他人遇到此“功能”，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T20:24:08.217

There does not seem to be any information about support to the `form` attribute in [Microsoft’s info on support to HTML5 forms](http://msdn.microsoft.com/en-us/library/ie/hh673544%28v=vs.85%29.aspx). A quick test suggests that even IE 10 does not support it.

So consider simplifying the structure. Intervening HTML should not be a problem, as long as your are not trying to overlap or nest forms.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:02:34.757

该`form`属性是 HTML5 添加的。它不适用于太旧而无法支持 HTML5 的浏览器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-10-24T13:47:06.557

您需要在字段之后关闭表单标签，它应该如下所示：

```
<form id="form1" action="Test.php" method="POST">
    <input type="text" form="form1" id="field1" name="field1" value="text input">
    <button type="submit" form="form1" id="Btn1" name="Btn1" value="Btn1" title="Btn1">
      Btn1</button>
    <input type="submit" form="form1" id="Btn2" name="Btn2" value="Btn2" title="Btn2">
</form> 
```

还为每个字段添加标签以使表单可访问。

# python - 在python中提取数据以及搜索的字符串

> ID：15622179
> 
> 赞同：1
> 
> 时间：2013-03-25T18:33:18.097
> 
> 标签：python

我的文件（表格）实际上看起来像这样。我想在文件中搜索像“Vonmises”这样的字符串。那就是我要提取的内容的起点。我有 9 个表格，如下所示。现在我可以在我的文件中搜索“Vonmises”字符串，但我的问题是如何提取表格数据和字符串。

**我为搜索“Vonmises”字符串编写的代码是：**

```
import re
f_read = open('filename','r')
str='VON MISES'
for line in f_read:    
    m=re.search(str,line)
    if m:
        print line 
```

**我的实际表：**

```
 STRESSES IN QUADRILATERAL ELEMENT

    ELEMNT-ID GRID-ID FIB-DIS STRESSES IN ELEMNT COORD SYS PRINCIPAL STRESSES
                                Norm-X  Norm-Y  Shear-XY     Angle Major Minor Vonmises   
        1         2     45         234    4565    675         65     345   345   54345
                 43     32         444    3243    324         65     453   543   34223 

                           STRESSES IN QUADRILATERAL ELEMENT
   ELEMNT-ID GRID-ID FIB-DIS STRESSES IN ELEMNT COORD SYS PRINCIPAL STRESSES
                                 Norm-X Norm-Y Shear-XY     Angle Major Minor Vonmises   
        2        34    324        342    556     565         546    53   6543   3456
                 45    345        657    676     856         674    65   676    6766 
```

**当我执行上面的代码时，我得到的结果是：**

```
 ELEMNT-ID GRID-ID FIB-DIS STRESSES IN ELEMNT COORD SYS PRINCIPAL STRESSES

  ELEMNT-ID GRID-ID FIB-DIS STRESSES IN ELEMNT COORD SYS PRINCIPAL STRESSES 
```

因此，除了上述结果之外，我还想要获取表格值，并且我只想提取 Vonmises 应力列并将其转储到文本文件中。

```
 ELEMNT-ID GRID-ID FIB-DIS STRESSES IN ELEMNT COORD SYS PRINCIPAL STRESSES
                                Norm-X  Norm-Y  Shear-XY     Angle Major Minor Vonmises   
        1         2     45         234    4565    675         65     345   345   54345
                 43     32         444    3243    324         65     453   543   34223 
```

# python - intertext() 恰好接受 1 个位置争论（给定 2 个）

> ID：15622184
> 
> 赞同：0
> 
> 时间：2013-03-25T18:33:25.367
> 
> 标签：python, xml

不完全确定如何处理此错误...

代码：

```
import xml.etree.ElementTree as ET
tree = ET.parse('network_objects.xml')
root = tree.getroot()

for network in root.iterfind('network_object'):
    name = network.find('Name')
    class_name = network.find('Class_Name')
    color = network.find('color')
    for netmaskElement in network.iterfind('netmask'):
        netmask = network.itertext('netmask')    
    for ipaddyElement in network.iterfind('ipaddr'):
        ipaddy = network.find('ipaddr')
    print (name.text,class_name.text,ipaddy.text,netmask,color.text) 
```

错误：

```
builtins.TypeError: itertext() takes exactly 1 positional argument (2 given)
line 10, in <module>
netmask = network.itertext('netmask') 
```

XML 本身，例如：

```
<network_objects>
<network_object>
<Name>Internal-192.168.112.0_24b</Name>
<Class_Name>network</Class_Name>
<add_adtr_rule>false</add_adtr_rule>
<broadcast><![CDATA[allow]]></broadcast>
<color><![CDATA[dark orchid]]></color>
<comments><![CDATA[no comment]]></comments>
<edges/>
<ipaddr><![CDATA[192.168.112.0]]></ipaddr>
<location><![CDATA[internal]]></location>
<location_desc><![CDATA[]]></location_desc>
<netmask><![CDATA[255.255.255.0]]></netmask>
<type><![CDATA[network]]></type>
</network_object>
</network_objects> 
```

当然还有其他*不*包含网络掩码的对象，我认为这是错误的来源，但是我认为 for 循环会纠正这一点。

我该如何解决？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:36:10.440

更改`itertext( 'netmask')`为`itertext()`

文档显示它没有像您当前所做的那样接收附加参数。

[文本文档](http://docs.python.org/dev/library/xml.etree.elementtree.html#xml.etree.ElementTree.Element.itertext)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T22:50:17.880

为什么不像在循环的其余部分中那样使用 .find 呢？

```
import xml.etree.ElementTree as ET
tree = ET.parse('network_objects.xml')
root = tree.getroot()

for network in root.iterfind('network_object'):
    name = network.find('Name')
    class_name = network.find('Class_Name')
    color = network.find('color')
    for netmaskElement in network.iterfind('netmask'):
        netmask = network.find('netmask')    
    for ipaddyElement in network.iterfind('ipaddr'):
        ipaddy = network.find('ipaddr')
    print (name.text,class_name.text,ipaddy.text,netmask,color.text) 
```

# asp.net - 选择具有多个参数化子句的查询

> ID：15622191
> 
> 赞同：1
> 
> 时间：2013-03-25T18:34:10.027
> 
> 标签：asp.net, sql, sql-server, razor-2

我有一个包含 2 个下拉列表和 3 个复选框部分的表单，用户可以从中选择以搜索数据库。由于所有的表都很小，我想使用一个 SELECT 语句来返回结果。我在 mikesdotnetting 上找到了一个扩展，它适用于单个 IN 子句

```
using System;
using System.Collections.Generic;
using WebMatrix.Data;
using System.Linq;

public static class DatabaseExtensions
{
public static IEnumerable<dynamic> QueryIn(this Database db, string commandText, string values)
{
    if (string.IsNullOrEmpty(values))
        throw new ArgumentException("Value cannot be null or an empty string", "values");
    var temp = values.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
    var temp2 = values.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
    var temp3 = values.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
    var parms = temp.Select((s, i) => "@" + i.ToString()).ToArray();
    var parms2 = temp2.Select((s, i) => "@" + i.ToString()).ToArray();
    var parms3 = temp3.Select((s, i) => "@" + i.ToString()).ToArray();
    var inclause = string.Join(",", parms, parms2, parms3);
    return db.Query(string.Format(commandText, inclause), temp, temp2, temp3);
}

public static int ExecuteIn(this Database db, string commandText, string values)
{
    if (string.IsNullOrEmpty(values))
        throw new ArgumentException("Value cannot be null or an empty string", "values");
    var temp = values.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
    var parms = temp.Select((s, i) => "@" + i.ToString()).ToArray();
    var inclause = string.Join(",", parms);
    return db.Execute(string.Format(commandText, inclause), temp);
}
 } 
```

这是显示我如何设想查询的页面代码：

```
var gender = Request["genderSvd"];
var person = Request["chkPerson"];
var spec = Request["chkSpec"];
var county = Request["ctyLoc"];
var crim = Request["chkCrim"];

    var db = Database.Open("HBDatabase");
    var sql = "SELECT DISTINCT tblProgram.* FROM lnkPrgPersonSvd INNER JOIN tblProgram ON lnkPrgPersonSvd.prgId = tblProgram.prgId";
    sql += "INNER JOIN lnkPrgSpecial ON tblProgram.prgId = lnkPrgSpecial.prgId INNER JOIN tblProgram.prgId = lnkPrgCriminal.prgId ";
    sql += "WHERE (lnkPrgPersonSvd.personId IN ({0})) AND (lnkPrgSpecial.specId IN ({1})) AND tblProgram.prgGenderSvdId = @2 ";
    sql += "AND tblProgram.prgCounty = @3 AND (lnkPrgCriminal.criminalId IN ({4}))";

    var prgList = db.QueryIn(sql, person, spec, gender, county, crim); 
```

这显然是行不通的，因为扩展不能接受那么多参数。我正在寻找一种方法来修改类以允许附加参数，以便查询可以通过一次执行来运行。这可能是不可能的。

此外，我确实找到了几个处理单个参数化 in 子句的线程，但没有真正提到带有变量列表的倍数。

我不擅长存储过程或编写自己的类。有什么建议么？

# c - 如何优化埃拉托色尼的 CUDA 筛

> ID：15622196
> 
> 赞同：0
> 
> 时间：2013-03-25T18:34:32.043
> 
> 标签：c, cuda, sieve-of-eratosthenes

我是 CUDA 的新手。为了弄脏我的手，我试着写了一个埃拉托色尼筛法（用于找出不超过某个数 n 的所有素数）。

我必须做很多事情才能让它工作，这似乎是不必要的。我很好奇是否有人知道更自然（并且仍然是 CUDA 优化）的方法。

1.  要在 isPrime 数组中获取标记为素数的条目，我必须进行两次单独的内核调用。第一个计算每个线程块中素数的数量，并将该块中小于 i 的素数分配给每个条目 i。然后我必须再次调用以添加所有先前块中的素数，以获得最终索引。
2.  但更糟糕的是，因为为了避免大量并发读取，我不得不将块中素数的数量存储在每个 THREADS_PER_BLOCK 索引处的单独数组中，从而有效地使算法所需的内存加倍。似乎应该有一种方法让所有线程为每个块读取相同的值，而不必复制它很多次。
3.  尽管如此，clearMultiples 方法中仍然存在并发读取的问题。尤其是对于像 2 和 3 这样的小素数，每个线程都必须读取其中的值。难道没有办法处理这个问题吗？

谁能看看我的代码并告诉我是否有什么明显可以做的更简单或更高效的事情？

我在做什么特别低效（除了在课程结束时打印出所有素数）？

每次内核调用后是否需要调用同步？

我还需要在 memcpy 之后进行同步吗？

最后，为什么当我将 THREADS_PER_BLOCK 设置为 512 时它不起作用？

谢谢

```
#include <stdio.h>
#include <cuda.h>
#include <assert.h>
#include <math.h>

#define MAX_BLOCKS 256
#define THREADS_PER_BLOCK 256 //Must be a power of 2
#define BLOCK_SPACE 2 * THREADS_PER_BLOCK

__global__ void initialize(int* isPrime, int n) {
    int idx = blockIdx.x * THREADS_PER_BLOCK + threadIdx.x;
    int step = gridDim.x * THREADS_PER_BLOCK;
    int i;
    for (i = idx; i <= 1; i += step) {
        isPrime[i] = 0;
    }
    for (; i < n; i += step) {
        isPrime[i] = 1;
    }
}

__global__ void clearMultiples(int* isPrime, int* primeList, int startInd,
        int endInd, int n) {
    int yidx = blockIdx.y * blockDim.y + threadIdx.y;
    int xidx = blockIdx.x * blockDim.x + threadIdx.x;
    int ystep = gridDim.y * blockDim.y;
    int xstep = gridDim.x * blockDim.x;
    for (int pnum = startInd + yidx; pnum < endInd; pnum += ystep) {
        int p = primeList[pnum];
        int pstart = p * (p + xidx);
        int pstep = p * xstep;
        for (int i = pstart; i < n; i += pstep) {
            isPrime[i] = 0;
        }
    }
}

__device__ void makeCounts(int* isPrime, int* addend, int start, int stop) {
    __shared__ int tmpCounts[BLOCK_SPACE];
    __shared__ int dumbCounts[BLOCK_SPACE];
    int idx = threadIdx.x;
    tmpCounts[idx] = ((start + idx) < stop) ? isPrime[start + idx] : 0;
    __syncthreads();
    int numEntries = THREADS_PER_BLOCK;
    int cstart = 0;
    while (numEntries > 1) {
        int prevStart = cstart;
        cstart += numEntries;
        numEntries /= 2;
        if (idx < numEntries) {
            int i1 = idx * 2 + prevStart;
            tmpCounts[idx + cstart] = tmpCounts[i1] + tmpCounts[i1 + 1];
        }
        __syncthreads();
    }
    if (idx == 0) {
        dumbCounts[cstart] = tmpCounts[cstart];
        tmpCounts[cstart] = 0;
    }
    while (cstart > 0) {
        int prevStart = cstart;
        cstart -= numEntries * 2;
        if (idx < numEntries) {
            int v1 = tmpCounts[idx + prevStart];
            int i1 = idx * 2 + cstart;
            tmpCounts[i1 + 1] = tmpCounts[i1] + v1;
            tmpCounts[i1] = v1;
            dumbCounts[i1] = dumbCounts[i1 + 1] = dumbCounts[idx + prevStart];
        }
        numEntries *= 2;
        __syncthreads();
    }
    if (start + idx < stop) {
        isPrime[start + idx] = tmpCounts[idx];
        addend[start + idx] = dumbCounts[idx];
    }
}

__global__ void createCounts(int* isPrime, int* addend, int lb, int ub) {
    int step = gridDim.x * THREADS_PER_BLOCK;
    for (int i = lb + blockIdx.x * THREADS_PER_BLOCK; i < ub; i += step) {
        int start = i;
        int stop = min(i + step, ub);
        makeCounts(isPrime, addend, start, stop);
    }
}

__global__ void sumCounts(int* isPrime, int* addend, int lb, int ub,
        int* totalsum) {
    int idx = blockIdx.x;
    int s = 0;
    for (int i = lb + idx; i < ub; i += THREADS_PER_BLOCK) {
        isPrime[i] += s;
        s += addend[i];
    }
    if (idx == 0) {
        *totalsum = s;
    }
}

__global__ void condensePrimes(int* isPrime, int* primeList, int lb, int ub,
        int primeStartInd, int primeCount) {
    int idx = blockIdx.x * THREADS_PER_BLOCK + threadIdx.x;
    int step = gridDim.x * THREADS_PER_BLOCK;
    for (int i = lb + idx; i < ub; i += step) {
        int term = isPrime[i];
        int nextTerm = i + 1 == ub ? primeCount : isPrime[i + 1];
        if (term < nextTerm) {
            primeList[primeStartInd + term] = i;
        }
    }
}

int main(void) {
    printf("Enter upper bound:\n");
    int n;
    scanf("%d", &n);

    int *isPrime, *addend, *numPrimes, *primeList;
    cudaError_t t = cudaMalloc((void**) &isPrime, n * sizeof(int));
    assert(t == cudaSuccess);
    t = cudaMalloc(&addend, n * sizeof(int));
    assert(t == cudaSuccess);
    t = cudaMalloc(&numPrimes, sizeof(int));
    assert(t == cudaSuccess);
    int primeBound = 2 * n / log(n);
    t = cudaMalloc(&primeList, primeBound * sizeof(int));
    assert(t == cudaSuccess);
    int numBlocks = min(MAX_BLOCKS,
            (n + THREADS_PER_BLOCK - 1) / THREADS_PER_BLOCK);
    initialize<<<numBlocks, THREADS_PER_BLOCK>>>(isPrime, n);
    t = cudaDeviceSynchronize();
    assert(t == cudaSuccess);

    int bound = (int) ceil(sqrt(n));

    int lb;
    int ub = 2;
    int primeStartInd = 0;
    int primeEndInd = 0;

    while (ub < n) {
        if (primeEndInd > primeStartInd) {
            int lowprime;
            t = cudaMemcpy(&lowprime, primeList + primeStartInd, sizeof(int),
                    cudaMemcpyDeviceToHost);
            assert(t == cudaSuccess);
            int numcols = n / lowprime;
            int numrows = primeEndInd - primeStartInd;
            int threadx = min(numcols, THREADS_PER_BLOCK);
            int thready = min(numrows, THREADS_PER_BLOCK / threadx);
            int blockx = min(numcols / threadx, MAX_BLOCKS);
            int blocky = min(numrows / thready, MAX_BLOCKS / blockx);
            dim3 gridsize(blockx, blocky);
            dim3 blocksize(threadx, thready);
            clearMultiples<<<gridsize, blocksize>>>(isPrime, primeList,
                    primeStartInd, primeEndInd, n);
            t = cudaDeviceSynchronize();
            assert(t == cudaSuccess);
        }
        lb = ub;
        ub *= 2;
        if (lb >= bound) {
            ub = n;
        }
        numBlocks = min(MAX_BLOCKS,
                (ub - lb + THREADS_PER_BLOCK - 1) / THREADS_PER_BLOCK);

        createCounts<<<numBlocks, THREADS_PER_BLOCK>>>(isPrime, addend, lb, ub);
        t = cudaDeviceSynchronize();
        assert(t == cudaSuccess);

        sumCounts<<<THREADS_PER_BLOCK, 1>>>(isPrime, addend, lb, ub, numPrimes);
        t = cudaDeviceSynchronize();
        assert(t == cudaSuccess);

        int primeCount;
        t = cudaMemcpy(&primeCount, numPrimes, sizeof(int),
                cudaMemcpyDeviceToHost);
        assert(t == cudaSuccess);
        assert(primeCount > 0);

        primeStartInd = primeEndInd;
        primeEndInd += primeCount;
        condensePrimes<<<numBlocks, THREADS_PER_BLOCK>>>(isPrime, primeList, lb,
                ub, primeStartInd, primeCount);
        t = cudaDeviceSynchronize();
        assert(t == cudaSuccess);
    }
    int finalprimes[primeEndInd];
    t = cudaMemcpy(finalprimes, primeList, primeEndInd * sizeof(int),
            cudaMemcpyDeviceToHost);
    assert(t == cudaSuccess);

    t = cudaFree(isPrime);
    assert(t == cudaSuccess);
    t = cudaFree(addend);
    assert(t == cudaSuccess);
    t = cudaFree(numPrimes);
    assert(t == cudaSuccess);
    t = cudaFree(primeList);
    assert(t == cudaSuccess);
    for (int i = 0; i < primeEndInd; i++) {
        if (i % 16 == 0)
            printf("\n");
        else
            printf(" ");
        printf("%4d", finalprimes[i]);
    }
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T23:38:49.000

回答你的一些问题。

1.  修复评论中定义的错误检查。

2.  定义“并发读取”的含义。您对此感到担忧，但我不确定您的意思。

> 每次内核调用后是否需要调用同步？

不，不是。如果您的代码无法正常工作，则在每次内核调用后进行同步然后进行适当的错误检查将告诉您是否有任何内核未正确启动。像这样相对简单的单流节目一般不需要同步。像 cudaMemcpy 这样需要同步的 cuda 调用会自动为您执行此操作。

> 我还需要在 memcpy 之后进行同步吗？

不，cudaMemcpy 本质上是同步的（它将强制同一流中的所有 cuda 调用在它开始之前完成，并且在复制完成之前它不会将控制权返回给主机线程。）如果您不想要阻塞特性（在完成之前不会将控制权返回给主机线程）然后您可以使用调用的 cudaMemcpyAsync 版本。您将使用流来解决强制所有以前的 cuda 调用完成的行为。

> 最后，为什么当我将 THREADS_PER_BLOCK 设置为 512 时它不起作用？

请定义“它不起作用”是什么意思。我用 512 和 256 的 THREADS_PER_BLOCK 编译了你的代码，对于 1000 的上限，它在每种情况下都给出了相同的输出。

# javascript - 流程图，禁用图形刻度上的小数点

> ID：15622203
> 
> 赞同：10
> 
> 时间：2013-03-25T18:35:00.870
> 
> 标签：javascript, graph, charts, scale, flot

在我的图表中，数据集中的所有项目都不包含小数点，但在其自动缩放例程中，它有时会决定向我显示中间小数点

我不希望它那样做，反正有它不那样做吗？

这很重要的原因是因为这个数据集中从来没有十进制值，所以没有必要暗示会有或认为它是对规模的有益补充

[http://jsfiddle.net/gamm/t3Vqh/2/](http://jsfiddle.net/gamm/t3Vqh/2/)

```
var dataset = [overdue, open, completed];

var options = {
    series: {
        stack: true,
        bars: {
            show: true
        }
    },
    bars: {
        align: "center",
        horizontal: false,
        barWidth: .8,
        lineWidth: 0
    },
    grid: {
        borderWidth: 0,
        borderColor: null,
        backgroundColor: null,
        labelMargin: 10,
        minBorderMargin: 10
    },
    yaxis: {
        tickColor: "FFFFFF"
    },
    xaxis: {
        tickColor: "FFFFFF",
        ticks: [
            [1, "Public Works"],
            [2, "Sanitation"],
            [3, "Mayor"],
            [4, "L&I"],
            [5, "Police"]
        ]
    },
    legend: {
        position: 'ne',
        show: true
    }
};

$.plot($("#example-section15 #flotcontainer"), dataset, options); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-25T18:58:51.983

使用轴[tickDecimals](https://github.com/flot/flot/blob/master/API.md#customizing-the-axes)选项，如下所示：

```
yaxis: {
    tickDecimals: 0
} 
```

# ios - 批量替换 XCode 中的版权注释

> ID：15622208
> 
> 赞同：7
> 
> 时间：2013-03-25T18:35:10.173
> 
> 标签：ios, xcode

我已经在 iOS 项目上工作了一段时间，创建了数百个源文件，现在一切都很好并且完成了，我意识到一些可悲的事情：我在开始工作之前编辑了版权文件模板，我所有的文件都有这种蹩脚的格式：

```
//
//  MyClass.h
//
//  Created by Redwarp on 3/25/13.
//  Copyright (c) 2013 Redwarp. All rights reserved.
// 
```

这并不酷！我想用类似的东西代替它：

```
/* This software is licensed under the Apache 2 license, quoted below.

Copyright 2013 Redwarp <redwarp@gmail.com>
Licensed under the Apache License, Version 2.0 (the "License"); you may not
use this file except in compliance with the License. You may obtain a copy of
the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations under
the License.
*/ 
```

反正。我可能会编写一个脚本，搜索我的所有文件并用更好的注释替换第一行“//”，但我确信有一个工具可以完美地做到这一点。

除了：我在任何地方都找不到那个工具。

有人知道这样的工具吗？（或者可能是我是个傻瓜？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T09:08:36.030

我最终使用了我在这里找到的脚本：http: [//gergap.wordpress.com/2009/06/03/howto-recursively-replace-file-headers-of-source-files/](http://gergap.wordpress.com/2009/06/03/howto-recursively-replace-file-headers-of-source-files/)

做我想做的工作，并且免除了我自己做的负担。

# drupal - 如何在 Drupal 视图中显示 Web 服务 (SOAP) JSON 结果

> ID：15622210
> 
> 赞同：1
> 
> 时间：2013-03-25T18:35:12.797
> 
> 标签：drupal, soap, service, view, web

我是 Drupal 初学者，我想在页面中显示 Web 服务 (SOAP) 结果（以 JSON 格式）。我想在表格中显示结果（所以我认为 Drupal View 会很好地显示它......），但我不知道如何将 Web 服务结果显示到视图中。

我正在使用模块“wsclient”（[http://drupal.org/project/wsclient](http://drupal.org/project/wsclient)）和“Rules”来执行 Web 服务方法，我能够将其结果转换为消息，但这就是我的全部能做到到现在。

我是 Drupal 的新手。有人可以帮我以最好的方式执行此操作吗？

我正在使用 Drupal 7。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T22:47:10.523

wsclient 问题队列中有一个用于视图集成的功能请求：http: [//drupal.org/node/1215570](http://drupal.org/node/1215570)

编辑：正如下面的评论所指出的，以下内容不适用于原始问题：

~~您是否考虑过使用[服务](http://drupal.org/project/services)模块？已经有它的[视图集成](http://drupal.org/project/services_views)。~~

# java - 从 GAE HRD 中的 Json 创建的 JDO 在实例重新启动之前不会正确转换回 Json

> ID：15622211
> 
> 赞同：2
> 
> 时间：2013-03-25T18:35:13.843
> 
> 标签：java, google-app-engine, gson

我正在开发一个使用 Google App-Engine 来存储和管理应用程序数据的 Android 应用程序。不幸的是，我遇到了一个我似乎无法解决的问题。

当用户创建一个新帐户时，会为他们创建一个新的“项目”。该项目包含任务，这些任务存储在 Project 类的一个 ArrayList 中。因此，在项目类的构造函数中，所有内容都被实例化，并且任务是使用 Gson2.2.2 从带有 Json 格式数据的文本文件创建的。
所有这一切都很好，如果我在 appengine 管理控制台中查看数据存储查看器，一切看起来都很好。创建帐户后，用户立即登录，当用户登录时，需要将任务发送到 Android 客户端。这就是它变得奇怪的地方。将任务序列化回 Json 格式时，它们似乎未初始化。所有字符串字段都是空的，并且整数都设置为 0，但是正在序列化正确数量的任务，因此会填充列表。这个问题一直存在，直到我在 GAE 中手动关闭了实例。当它通过新请求重新启动时，数据会正确序列化为 Json 格式，并且一切正常。显然这不好，每次新用户创建帐户时，我都不能让服务器关闭它的实例，只是为了能够为他们提供正确的数据。所以，请帮我解决这个问题。我已经为此苦苦挣扎了一段时间。下面是准确重现问题的代码。

```
public class CreateData extends HttpServlet{

    public void doGet(HttpServletRequest req, HttpServletResponse resp){
        if(req.getParameter("name").length() > 1){
            PersistenceManager pm = PMF.get().getPersistenceManager();
            User u = new User(req.getParameter("name"));
            pm.makePersistent(u);
            pm.close();
            try {
                resp.getWriter().print("User created with name "+req.getParameter("name"));
            } catch (IOException e) {
                e.printStackTrace();
            }
        }else if(req.getParameter("name").length() <= 1){
            try {
                resp.getWriter().print("Please supply a name with at least 2 characters");
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }else{
            try {
                resp.sendError(400);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }
} 
```

用户类

```
 public class User {
    public @interface Skip {
        // Field tag only annotation
    }

    @PrimaryKey
    @Persistent
    private String name;

    @Persistent
    private ArrayList<DataType> data;
    public User(String name) {
        this.name = name;
        data = new ArrayList<DataType>();
        createDataFromJSON();
    }

    public String getDatasAsJSON(){
        Gson gson = new GsonBuilder().setExclusionStrategies(new MyExclusionStrategy(Key.class)).create();
        Type taskType = new TypeToken<List<DataType>>(){}.getType();
        String json = gson.toJson(this.data, taskType);
        return json;
    }

    public void createDataFromJSON() {
        FileReader fr = null;
        try {
            fr = new FileReader(new File("WEB-INF/defaults.json"));
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
        if (fr != null) {
            Type taskType = new TypeToken<List<DataType>>(){}.getType();
            data = new Gson().fromJson(fr, taskType);
        }
    }

    public class MyExclusionStrategy implements ExclusionStrategy {
        private final Class<?> typeToSkip;

        private MyExclusionStrategy(Class<?> typeToSkip) {
            this.typeToSkip = typeToSkip;
        }

        public boolean shouldSkipClass(Class<?> clazz) {
            return (clazz == typeToSkip);
        }

        public boolean shouldSkipField(FieldAttributes f) {
            return f.getAnnotation(Skip.class) != null;
        }
    }
} 
```

数据类型类

```
public class DataType {
    @PrimaryKey
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private Key key;

    @Persistent
    private String name;

    @Persistent
    private int points;

    @Persistent
    private int unique;

    public DataType() {
    }

    public DataType(String name, int points, int unique){
        this.name = name;
        this.points = points;
        this.unique = unique;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getPoints() {
        return points;
    }

    public void setPoints(int points) {
        this.points = points;
    }

    public int getUnique() {
        return unique;
    }

    public void setUnique(int unique) {
        this.unique = unique;
    }

} 
```

用于获取数据的 Servlet

```
public class GetData extends HttpServlet{
    public void doGet(HttpServletRequest req, HttpServletResponse resp){
        String name = req.getParameter("name");
        PersistenceManager pm = PMF.get().getPersistenceManager();
        User u = null;
        try{
            u = pm.getObjectById(User.class, name);
        }catch(JDOObjectNotFoundException e){
            try {
                resp.sendError(404);
            } catch (IOException e1) {
                e1.printStackTrace();
            }
        }

        if(u != null){
            String response = u.getDatasAsJSON();

            try {
                resp.getWriter().print(response);
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

和 JSON 数据

```
[ 
    {
      "name": "Hug",
      "unique": 1,
      "points": 20
    },
    {
      "name": "Tug",
      "unique": 2,
      "points": 40
    },
    {
      "name": "Rug",
      "unique": 3,
      "points": 50
    },
    {
      "name": "Jug",
      "unique": 4,
      "points": 100
    },
    {
      "name": "Smug",
      "unique": 5,
      "points": 20
    }
] 
```

因此，创建一个名为“Arne”的新用户可以正常工作，并且在 HDR 中创建对象。以 Json 的形式从数据存储中请求返回对象会产生此响应

```
[{"points":0,"unique":0},{"points":0,"unique":0},{"points":0,"unique":0},{"points":0,"unique":0},{"points":0,"unique":0}] 
```

在重新启动服务器实例时，相同的请求会给出此响应

```
[{"name":"Hug","points":20,"unique":1},{"name":"Tug","points":40,"unique":2},{"name":"Rug","points":50,"unique":3},{"name":"Jug","points":100,"unique":4},{"name":"Smug","points":20,"unique":5}] 
```

很抱歉这篇文章很长，但希望有人能够向我指出我做错了什么。提前谢谢了！最好的问候， 伊瓦尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T13:18:39.800

糟糕的是，似乎没有人能够回答这个问题，尽管我找到了解决方法。我仍然认为这需要一个适当的解决方案，但至少我现在通过循环遍历所有对象并使用对象中字段的值分配一个临时变量来让它工作。这似乎迫使它们进行初始化，并且返回的 JSON 实际上填充了正确的字段。

```
public class GetData extends HttpServlet{
    public void doGet(HttpServletRequest req, HttpServletResponse resp){
        String name = req.getParameter("name");
        PersistenceManager pm = PMF.get().getPersistenceManager();
        User u = null;
        try{
            u = pm.getObjectById(User.class, name);
        }catch(JDOObjectNotFoundException e){
            try {
                resp.sendError(404);
            } catch (IOException e1) {
                e1.printStackTrace();
            }
        }

        if(u != null){
            //By adding this seemingly pointless loop
            //the objects will actually return populated fields
            //when converted back to JSON
            for(DataType dt : u.getData()){
                String temp = dt.getName();
            }
            String response = u.getDatasAsJSON();

            try {
                resp.getWriter().print(response);
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

# php - 如何在一个单元格上合并两个单元格

> ID：15622212
> 
> 赞同：0
> 
> 时间：2013-03-25T18:35:14.907
> 
> 标签：php, mysql

我有两个具有相同数据但只有一个单元格与其他单元格不同的行，如下所示：-

```
Customer Name   |   No Room   |   Room Type
 Maikle dived         2             single
 Maikle dived         1             double 
```

所以我不会像这样将客户合并到一个单元格上：-

```
Customer Name   |   No Room   |   Room Type
                      2             single
  Maikle dived            
                      1             double 
```

我如何通过 PHP 和 mysql 做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:47:17.477

如果您尝试将其输出为 HTML，请执行以下操作：

```
 //$source should hold the data from DB
 $source = array(
   array('Maikle dived' => array('No Room' => 2, 'Room Type' => 'single'),
   array('Maikle dived' => array('No Room' => 1, 'Room Type' => 'double'),
 );

$result = array();

foreach($source as $item) {
    $user = key($item);
    $val  = current($item);

    if(!isset($result[$user])) {
        $result[$val] = array();
    }
    $result[$user][] = $val;
} 
```

然后你可以循环通过 $result 来构建 html

```
foreach($result as $user => $vals) {
    echo $user;
    echo '<ul>';
    foreach($vals as $val) {
        echo '<li>'.$val.'</li>';
    }
    echo '</ul>';
} 
```

# c - 分析 valgrind 输出：“invalid free()”

> ID：15622215
> 
> 赞同：4
> 
> 时间：2013-03-25T18:35:22.313
> 
> 标签：c, free, valgrind, memcheck

valgrind 在一个（愚蠢的）身份验证模块上发现了这个奇怪的错误，该模块在堆分配上产生了一些问题。

```
 ==8009== Invalid free() / delete / delete[] / realloc()
 ==8009==    at 0x4C2A739: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
 ==8009==    by 0x40263F: authenticate (server_utils.c:109)
 ==8009==    by 0x401A27: main (server.c:240)
 ==8009==  Address 0x51f1310 is 0 bytes inside a block of size 18 free'd
 ==8009==    at 0x4C2A739: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
 ==8009==    by 0x402633: authenticate (server_utils.c:108)
 ==8009==    by 0x401A27: main (server.c:240)
 =8009== 
 ==8009== Invalid free() / delete / delete[] / realloc()
 ==8009==    at 0x4C2A739: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
 ==8009==    by 0x40264B: authenticate (server_utils.c:110)
 ==8009==    by 0x401A27: main (server.c:240)
 ==8009==  Address 0x51f1319 is 9 bytes inside a block of size 18 free'd
 ==8009==    at 0x4C2A739: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
 ==8009==    by 0x402633: authenticate (server_utils.c:108)
 ==8009==    by 0x401A27: main (server.c:240)
 ==8009== 
 ==8009== Invalid free() / delete / delete[] / realloc()
 ==8009==    at 0x4C2A739: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
 ==8009==    by 0x402657: authenticate (server_utils.c:111)
 ==8009==    by 0x401A27: main (server.c:240)
 ==8009==  Address 0x51f131e is 14 bytes inside a block of size 18 free'd
 ==8009==    at 0x4C2A739: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
 ==8009==    by 0x402633: authenticate (server_utils.c:108)
 ==8009==    by 0x401A27: main (server.c:240)
 ==8009== ... 
```

据我了解，他说我在第 109-110-111 行做了三个无效的 free()。错误应该是我尝试释放比实际分配更多的空间，但我无法决定释放多少空间。我也不明白为什么它指的是第 108 行（这也是一个 free()）。

这是来自文档（无效免费）：

> Memcheck 使用 malloc/new 跟踪程序分配的块，因此它可以准确地知道 free/delete 的参数是否合法。在这里，这个测试程序两次释放了同一个块。与非法读/写错误一样，Memcheck 尝试理解释放的地址。如果像这里一样，地址是以前被释放的地址，你会被告知——使同一块的重复释放很容易被发现。
> 
> 如果您尝试释放一个不指向堆块开头的指针，您也会收到此消息。

我真的无法想象在其中一种情况下会怎样。

```
/* Authentication through <user_id:password:flag>
 * Returns 1 on success, -1 if user_id doesn't exist, -2 on password mismatch 
 * On success sets access_permissions
 */
int authenticate(USR_PSW *received, int *access_permissions) {

/*Users file opening*/
FILE *fd;
fd = fopen(USERS_FILE, "r");
if (fd == NULL) {
    fprintf(stderr, "Users file opening error\n");
    exit(EXIT_FAILURE);
}

char *usr_psw_line = malloc(USR_SIZE + PSW_SIZE + 3 + 1);
if (usr_psw_line == NULL) {
    fprintf(stderr, "Dynamic alloc error\n");
    exit(EXIT_FAILURE);
}
char *usr_tok = malloc(USR_SIZE);
if (usr_tok == NULL) {
    free(usr_psw_line);
    fprintf(stderr, "Dynamic alloc error\n");
    exit(EXIT_FAILURE);
}
char *psw_tok = malloc(PSW_SIZE);
if (psw_tok == NULL) {
    free(usr_psw_line);
    free(usr_tok);
    fprintf(stderr, "Dynamic alloc error\n");
    exit(EXIT_FAILURE);
}
char *flg_tok = malloc(sizeof (char) *2);
if (flg_tok == NULL) {
    free(usr_psw_line);
    free(usr_tok);
    free(psw_tok);
    fprintf(stderr, "Dynamic alloc error\n");
    exit(EXIT_FAILURE);
}

/*Reading from file <user_id:password:flag> */
while (fgets(usr_psw_line, USR_SIZE - 1 + PSW_SIZE - 1 + 3 + 1, fd) != NULL) {
    usr_tok = strtok(usr_psw_line, ":");

    if (strcmp(usr_tok, received->user_id) == 0) {
        /*user_id found, password check*/
        psw_tok = strtok(NULL, ":");
        /*password match*/
        if (strcmp(psw_tok, received->password) == 0) {
            flg_tok = strtok(NULL, ":");
            *access_permissions = atoi(flg_tok);
            free(usr_psw_line); //108
            free(usr_tok);//109
            free(psw_tok);//110
            free(flg_tok);//111
            fclose(fd);
            return AUTHENTICATED;
        } else { //password unmatch
            free(usr_psw_line);
            free(usr_tok);
            free(psw_tok);
            free(flg_tok);
            fclose(fd);
            return INVALID_PSW;
        }
    } else {
        fseek(fd, 1, SEEK_CUR);
        continue;
    }

}
/*EOF Reached without match*/
free(usr_psw_line);
free(usr_tok);
free(psw_tok);
free(flg_tok);
fclose(fd);
return INVALID_USR;

} 
```

头文件：

```
#ifndef __SERVER_UTILS_H__
#define __SERVER_UTILS_H__

#define USR_SIZE 9
#define PSW_SIZE 5 

/*Authentication data structure definition*/
typedef struct{
    char user_id[USR_SIZE]; // eg: user_123
    char password[PSW_SIZE]; // eg: a1b2
} USR_PSW;

#define NM_MAX_SIZE 17
#define NR_MAX_SIZE 11

/*System record structure*/
typedef struct{
    char first_name[NM_MAX_SIZE];
    char last_name[NM_MAX_SIZE];
    char number[NR_MAX_SIZE];
}TBOOK_RECORD;

/*Session status flags*/
#define NOT_AUTHENTICATED 0
#define AUTHENTICATED 1
#define INVALID_USR 2
#define INVALID_PSW 3

/*Persmissions flags*/
#define NO_PERM 0
#define READ_WRITE  1
#define O_WRITE  2
#define O_READ  3

/*Contains <user_id:password,flag> triplets stored in server */
 #define USERS_FILE "users.txt" 

/*Contains all telbook records <first_name:last_name:phone_number>*/
 #define RECORDS_FILE "records.txt"

/*Single records file line max length (before \n) */
 #define RECFILE_LINE_MAX_LEN  2*NM_MAX_SIZE+NR_MAX_SIZE+3+1;

/*Client operation*/
#define NO_OP 0
#define SEARCH_BY_NAME 1
#define SEARCH_BY_NUMBER 2
#define INSERT_RECORD 3

/* 
 * Returns number of bytes copied into buffer (excluding terminating null byte), 
 * or 0 on EOF, or -1 on error.
 * size_t : used for sizes of objects.
 * ssize_t: used for a count of bytes or an error indication (-1).
 */
 ssize_t readline(int fd, void *buffer, size_t n);

/* Authentication through <user_id:password:flag>
 * Returns 1 on success, -1 if user_id doesn't exist, -2 on password mismatch 
 * On success sets access_permissions
 */
int authenticate(USR_PSW *received, int *access_permissions);

int close_session(int sock_ds);

int search_by__(int op_code, TBOOK_RECORD *rc_rcvd, TBOOK_RECORD *rc_rspn
            , FILE *fd, char *file_line);

int insert_record(TBOOK_RECORD *rc_rcvd);

#endif  /* __SERVER_UTILS_H__ */ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:41:48.967

```
usr_tok = strtok(usr_psw_line, ":");
...
    psw_tok = strtok(NULL, ":"); 
```

您正在用其他地方的指针覆盖指向您的`malloc`ed 内存的指针（从而泄漏它）。然后你试图`free`指向你从其他地方收到的那个指针，它（正如 valgrind 所说）是无效的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:45:00.083

要添加到上述答案，只需确保在所有有 return 语句的情况下 fclose (fp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:43:33.467

当您使用 strok() 时，您正在更改指针地址。这样，当您调用 free() 时，您可能不会指向整个块。您可以使用辅助指针来存储 strok() 返回值，然后您可以使用原始指针来 free() 所有分配的空间正确。

# java - JAX-WS 和 JAX-RS 的定义

> ID：15622216
> 
> 赞同：3
> 
> 时间：2013-03-25T18:35:23.220
> 
> 标签：java, jax-ws, jax-rs

我在互联网的某个地方读到 JAX-WS 是 SOAP 实现，而 JAX-RS 是 Rest 实现。这是真的？JAX-WS 和 JAX-RS 是实现还是规范？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T23:16:50.173

它们是定义 API 的规范。

*   JSR 224：基于 XML 的 Web 服务的 Java API (JAX-WS) 2.0 [http://jcp.org/en/jsr/detail?id=224](http://jcp.org/en/jsr/detail?id=224)
*   JSR 311：JAX-RS：RESTful Web 服务的 JavaTM API [http://jcp.org/en/jsr/detail?id=311](http://jcp.org/en/jsr/detail?id=311)

他们定义的 API（接口、类和异常）需要实现。

JAX-WS 的参考实现 (RI) 包含在 Java SE 中。JAX-WS RI 是作为 Metro 项目 ( [http://metro.java.net/](http://metro.java.net/) ) 的一部分创建的。Metro 包括超出 JAX-WS RI 支持的增强功能和功能。在 SOAP 世界中，Web 服务堆栈可以支持一些可选功能，例如 WS-Security。Metro 支持这些，而 JAX-WS RI 不支持。

由于 JAX-WS 包含在 Java SE 中，是的，您可以在没有服务器的情况下制作 JAX-WS (SOAP) Web 服务。这是因为 Java SE 中包含一个非常基本的 HTTP 服务器。您使用[Endpont](http://docs.oracle.com/javase/7/docs/api/javax/xml/ws/Endpoint.html)类发布服务。这实际上比其他任何东西都更适合测试。JAX-WS 包含在 Java SE 中的真正原因是更容易成为 SOAP 服务客户端。要真正运行 JAX-WS Web 服务，您需要一个服务器，例如 GlassFish、JBoss 或 WebLogic。可以将 JAX-WS 实现添加到 Tomcat，但只有真正的 Java EE 应用程序服务器才包含开箱即用的完整实现。

JAX-RS 的参考实现 (RI) 被命名为 Jersey ( [http://jersey.java.net/](http://jersey.java.net/) )。JAX-RS 不包含在 Java SE 中。您必须下载一个实现。一旦你下载了它，你*可以*在没有服务器的情况下使用它，但同样，它实际上更适合在服务器中使用。下载 Jersey 的一个原因是让 Jersey Client API 来编写客户端（这不是当前 JAX-RS 规范的一部分）。与 JAX-WS 实现一样，您可以将 Jersey 添加到 Tomcat，或者完整的 Java EE 应用程序服务器将包含 JAX-RS 实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:44:47.317

JAX-WS 和 JAX-RS 都是用于在 Java 中以各种方式进行通信的库 (API)。

正如您所提到的，JAX-WS 是一个可用于在 Java 中进行 SOAP 通信的库，而 JAX-RS 允许您在 Java 中进行 REST 通信。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:01:25.403

JAX-WS 是[JSR 224](http://jcp.org/en/jsr/detail?id=224)中引入的一组 Java 接口、类和注释：

> JAX-RPC 2.0 规范用新特性扩展了现有的 JAX-RPC 1.0 规范，包括以下部分或全部：直接支持基于 JAXB 2.0 的数据绑定，支持最新的 W3C 和 WS-I 标准（例如 SOAP 1.2 , WSDL 1.2)，Java<->WSDL 映射的标准化元数据，易于开发的特性，支持更容易的 Web 服务发展，改进的处理程序框架，支持异步 RPC 和非 HTTP 传输。

它是一个 API，需要运行时实现，例如由[Apache Axis2](http://axis.apache.org/)提供。

JAX-RS 是[JSR 311](http://jcp.org/en/jsr/detail?id=311)中引入的用于 RESTful 客户端/服务器通信的 API ：

> 该 API 将使开发人员能够使用 Java 快速构建 Web 应用程序，这些应用程序是 Web 设计最好的部分的特征。该 JSR 将开发一个 API，用于在 Java 平台中提供 REST（具象状态传输 - 请参阅 Roy Fielding 的论文第 3.1 节）支持。轻量级的 RESTful 方法正在成为一种流行的替代基于 SOAP 的技术，用于在 Internet 上部署服务。目前，使用 Java 平台构建 RESTful Web 服务比构建基于 SOAP 的服务要复杂得多，并且需要使用低级 API，例如 Servlet 或动态 JAX-WS API。正确的实现需要开发人员具备高水平的 HTTP 知识。

同样，它需要一个实现，例如由[Jersey](http://jersey.java.net/)提供。

# c++ - 大小为 1 的 OpenCV 构造范围

> ID：15622229
> 
> 赞同：0
> 
> 时间：2013-03-25T18:36:10.570
> 
> 标签：c++, opencv

在下面的代码中，是否有更好的方法来构建单例范围`cv::Range(i, i+1)`和`cv::Range(j, j+1)`？我希望在 OpenCV 中的某个地方存在一个创建单例范围的函数，例如，只是一个`cv::Range(i)`等效于`cv::Range(i, i+1)`.

```
const int sizeA[] = { 100, 100, 100 };
cv::Mat matrix(3, sizeA, cv::DataType<int>::type);

// get submatrix (i, j, :)
int i = 8;
int j = 15;
const cv::Range ranges = { cv::Range(i, i+1), cv::Range(j, j+1), cv::Range::all() };
cv::Mat submatrix = matrix(ranges); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:41:55.260

OpenCV 中没有内置任何东西可以做到这一点。只需`cv::Range(i, i+1)`在任何地方编写或编写自己的辅助函数。

# css - 滑块在 IE8 中不起作用

> ID：15622234
> 
> 赞同：0
> 
> 时间：2013-03-25T18:36:21.693
> 
> 标签：css, html, slider, css3pie

我目前正在建立一个网站，但我注意到滑块在 IE8 中不起作用。当我单击兼容模式按钮时，它确实有效。

`div`当我在 IE8 中查看时，它显示了一些奇怪的错位s。我最近在 Pie 中构建了圆角以在 IE8 中工作；也许这就是滑块的问题？

有没有人可以帮助我？

这是代码:)

```
<div class="slider-container">
<div id="slideshow">
    <div>
        <div class="caption rc">
            <div class="caption-text">
                <?php perch_content('tekst slide 1'); ?>
            </div>
        </div>
        <img src="img/slider.jpg" alt="Slide">
    </div>
    <div>
    <div class="caption rc">
            <div class="caption-text">
                <?php perch_content('tekst slide 2'); ?>
            </div>
        </div>
        <img src="img/slider-2.jpg" alt="Slide">
    </div>
    <div>
    <div class="caption rc">
            <div class="caption-text">
                <?php perch_content('tekst slide 3'); ?>
            </div>
        </div>
        <img src="img/slider-3.jpg" alt="Slide">
    </div>
    <div>
    <div class="caption rc">
            <div class="caption-text">
                <?php perch_content('tekst slide 4'); ?>
            </div>
        </div>
        <img src="img/slider-4.jpg" alt="Slide">
    </div>
    </div>
</div> 
```

和这里：

```
$(function() {

    $("#slideshow > div:gt(0)").hide();

    setInterval(function() { 
      $('#slideshow > div:first')
        .fadeOut(1000)
        .next()
        .fadeIn(1000)
        .end()
        .appendTo('#slideshow');
    },  6000);

}); 
```

奇怪的是它可以在兼容模式下工作，但不能在正常模式下工作，在 IE8 和 Firefox、Chrome 和 Safari 中它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:32:05.927

您正在使用 cdn，有时加载 cdn 文件时遇到问题...尝试添加一个备用脚本以从本地服务器加载 jquery。在标头中来自 google cdn 的 jquery 脚本之后添加它并修改您的路径。

```
<script type="text/javascript">
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='path to jquery libary' type='text/javascript'%3E%3C/script%3E"));
}
</script> 
```

希望这可以帮助

问候

# javascript - HTML 5 画布形状碰撞测试

> ID：15622236
> 
> 赞同：0
> 
> 时间：2013-03-25T18:36:26.050
> 
> 标签：javascript, html, canvas

你能帮我做碰撞测试吗？

在 Flash 中，我会使用 Hittest，这需要 2 分钟，但我看到 HTML5 有点不同。

下面是我的代码。我可以轻松地让球在红色块内反弹，但我希望中间有一个灰色块，球也会反弹，并且 if 语句变得混乱且不起作用。有没有更简单的方法来做到这一点，请你帮帮我。谢谢

```
<html>
<head>
</head>

<script>
    var context;
    var x=50;
    var y=100;
    var speedX=-2;
    var speedY=-2;
    var counter=0;
    var ballCoordinates ='';

    function init()
    {
      var c = document.getElementById('myCanvas');
      context= c.getContext('2d');
      setInterval(draw,10);
    }

    function draw()
    {
          context.clearRect(0,0, 300,400);

          //draw number
          context.fillStyle = '#fff';
          context.font="160px Arial";
          context.fillText(counter,10,150);

          context.fillStyle = '#fff';
          context.font="20px Arial";
          context.fillText(ballCoordinates,10,400);

          //draw ball
          context.beginPath();
          context.fillStyle="#0000ff";
          context.arc(x,y,20,0,Math.PI*2,true);
          context.closePath();
          context.fill();

          //draw block
          context.fillStyle = '#333';
          context.fillRect(100,200,100,100);

          // Boundary Logic
            //if( x<0 || x>300) dx=-dx;
            //if( y<0 || y>300) dy=-dy;

            if(x>280){
            speedX=speedX * -1;
            }else if(y<20){
            speedY=speedY * -1;
            }else if(x<20){
            speedX=speedX * -1;
            }else if(y>380){
            speedY=speedY * -1;
            }else if( x>80 && y >180 && y <320) {
                speedY=speedY * -1;
            }else if( x<220 && y >180 && y <320) {
                speedY=speedY * -1;
            }else if( y>180 &&  x>80 && x<220) {
                speedX=speedX * -1;
            }else if( y<180 &&  x>80 && x<220) {
                speedX=speedX * -1;
            }

            x+=speedX;
            y+=speedY;

            ballCoordinates = x + 'x   ' + y + 'y ' + speedX + 'speedx    ' + speedY + 'speedy';
    }

</script>
<body onLoad="init();">
  <canvas id="myCanvas" width="300" height="400" style="background:red" >
  </canvas>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:19:43.757

在我的[葡萄柚](https://github.com/englercj/grapefruit)游戏引擎中，我使用有界框系统来检测碰撞。[我在gamedev.stackexchange.com](https://gamedev.stackexchange.com/questions/586/what-is-the-fastest-way-to-work-out-2d-bounding-box-intersection)上找到了一个很好的问题，它帮助了我，这就是我想出的：

```
intersects: function(entity) {
    return (Math.abs(this._hitboxMesh.position.x - entity._hitboxMesh.position.x) * 2 < (this.hitSize.x + entity.hitSize.x)) &&
            (Math.abs(this._hitboxMesh.position.y - entity._hitboxMesh.position.y) * 2 < (this.hitSize.y + entity.hitSize.y));
} 
```

基本上，游戏循环将对实体运行此检查，以查看它们是否相交或碰撞。这是`Entity`对象上的方法，因此`this`引用 an `Entity`，参数也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T09:50:23.667

[http://www.html5rocks.com/en/tutorials/canvas/notearsgame/#toc-introduction](http://www.html5rocks.com/en/tutorials/canvas/notearsgame/#toc-introduction)

```
function collides(a, b) {
  return a.x < b.x + b.width &&
         a.x + a.width > b.x &&
         a.y < b.y + b.height &&
         a.y + a.height > b.y;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:42:47.817

我过去使用的一种技术是创建一个背景缓冲区并为每个对象分配一个 ID。然后，当绘制该对象时，还将其绘制在背景缓冲区中，使每个像素颜色为该 id。在背景缓冲区上绘图时，检查是否在非黑色 (0) 的像素上绘制了任何像素，那么这是一个碰撞，您碰撞的对象是缓冲区上该像素的颜色。

# php - 未定义的偏移量 151？

> ID：15622237
> 
> 赞同：0
> 
> 时间：2013-03-25T18:36:26.250
> 
> 标签：php, arrays

我不知道未定义的偏移量 151 是什么意思，但我知道它与我用来翻转 ascii 值的过程非常吻合。这是它不喜欢的代码：

```
$secondb = $array1[$i2] / 10;
$firstb = $array1[$i2] % 10; 
```

它在这个“for”循环中出现了这个错误：

```
 for($i2 = 0; $i2 < $amt1; $i2++);
    {
        $secondb = $array1[$i2] / 10;
        $firstb = $array1[$i2] % 10;
        $firstb = $firstb * 10;
        $array1[$i2] = $firstb + $secondb;
    } 
```

更多代码：

```
function decoding($inputs)
{
    $inputs = base64_decode($inputs);
    $amt1 = strlen($inputs);
    $array1 = str_split($inputs);
    for($i2 = 0; $i2 < $amt1; $i2++);
        {
            $secondb = $array1[$i2] / 10;
            $firstb = $array1[$i2] % 10;
            $firstb = $firstb * 10;
            $array1[$i2] = $firstb + $secondb;
        }
        $inputs = implode($array1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:39:11.167

未定义的偏移量 151 表示您正在检查数组是否包含第 151 个元素。

介意发布更多与您的 for 循环相关的代码吗？如果不知道 的值，我们什么都做不了`$amt1`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:46:04.490

当您除以第一个值时，不允许`$array1[$i2]/10`执行除以 0。要跳过除以 0，我建议您在 for 循环中创建一个 if 条件并跳过除以 0，或者将起始值设置为to 。`$array1[$i2]%10``$i2``0``$i2``1`

`for($i2 = 1, $i2< $amt1+1 ; i++){//your code}`

# sql - 交易有多有用

> ID：15622244
> 
> 赞同：1
> 
> 时间：2013-03-25T18:36:48.197
> 
> 标签：sql, sql-server, tsql

我了解它们为什么很好，但是它们是否用于现实世界的情况？

如果是这样，它们在创建嵌套事务时有多大用处？有什么好处？

例如（一个非常松散的例子），假设我正在创建一个数据库，目的是帮助其他人理解 SQL（假设地）。

所以我需要编写一个脚本来创建数据库、创建模式、为每个模式创建表、为每个模式创建序列、用有效信息填充表，然后结束脚本。

所以在这样做时，我会分解我的批次以依次运行，例如。

```
 use master; go 

 create databse testdb; go

 use testdb; go

 create table tbl(XYZ); go
 insert into tbl (XYZ)   
 values (XYZ); go 
```

那么现在，我将在该块的哪个位置使用事务，为什么要嵌套它们？

在此先感谢，感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:16:24.313

在您无法确保所有语句都成功执行的情况下，事务是一个福音。基本上，情况**总是**如此。

您**实际上无法避免**错误：错误、超时、死锁。如果其中一种情况发生，您希望撤消所做的所有修改并报告错误。您*不想*调试存在的数据损坏问题，因为某些代码只执行了一半。

除了原子性还有其他用途：你可能想隔离事务，检测冲突事务，让冲突事务互相等待，使用锁实现互斥。大多数 trans 用于 DML，而不是 DDL（从实践中说）。一些跨英亩*仅*用于读取数据库的一致时不变快照。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:58:12.460

事务用于确保一组 DML（数据操作语言）语句的一致性。如果某些事情失败（例如，因为您试图创建重复键），整个事务将回滚并且您没有，例如，没有明细行的订单标题。您可以选择使用 ROLLBACK 语句手动回滚。

事务的另一个用途是数据库恢复。如果数据库崩溃，您通常会遇到不一致的情况。恢复操作将回滚不完整的事务。

DDL（数据定义语言）语句（例如 CREATE TABLE）通常在它们自己的事务中执行 - 您不想让数据字典处于不一致的状态。

在您的示例中，唯一可能的事务是围绕 INSERT。执行 INSERT 时将自动创建一个事务。如果您的系统没有打开自动提交并且您未能提交插入，那么您的数据将永远不会进入数据库。

嵌套事务用于复杂情况，您可能希望回滚插入子表并执行其他操作（例如要求额外的用户输入），而不必回滚父表上的事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:39:51.973

With create db, you can simply drop table if there are errors so you shouldn't need to use transactions but...

they are very useful when you're trying to maintain atomicity across multiple sql statements.

# c++ - Visual Studio 2010 编译器选项

> ID：15622245
> 
> 赞同：2
> 
> 时间：2013-03-25T18:36:50.963
> 
> 标签：c++, visual-studio-2010, compiler-construction, compiler-options

我在 Visual Studio 2010 Ultimate 的项目属性页上找不到人们称为“C/C++”的选项来更改一些编译器选项。这是我得到的：

![属性页截图](../Images/6910d5c212d8169b0b8f31f75b9ee1dc.png)

我尝试创建一个 Empty Project 和一个 Win32 Project 设置为空但没有结果。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:41:41.210

在您的项目中至少有一个 .cpp 文件之前，Visual Studio 2010 不会显示 C/C++ 属性（也可能接受其他文件类型，但 .h 不起作用）。

因此，将单个 .cpp 文件添加到您的项目中，当您转到属性页面时，它应该显示在链接器设置的正上方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:39:41.353

在附加选项中，`/TP`为 C++ 和 C添加`/TC`。

`/TP`将所有文件编译为 C++，不管它们的文件扩展名。`/TC`将所有文件编译为 C，不管它们的文件扩展名。

# java - 在 Android 上检查 Internet 连接

> ID：15622247
> 
> 赞同：1
> 
> 时间：2013-03-25T18:36:58.240
> 
> 标签：java, android, connection

我需要检查 Android 应用程序上的互联网连接。

我正在使用这段代码：

```
 ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo ni = cm.getActiveNetworkInfo();
        if (ni!=null && ni.isAvailable() && ni.isConnected()) {
            return true;
        } else {
            return false; 
        } 
```

并且不能通过下一个错误：

> 对于 ConxsMTD 类型，方法 getSystemService(String) 未定义

我尝试使用`getContext().getSystemService`，但也失败了，出现下一个错误：

> 对于 ConxsMTD 类型，方法 getContext() 未定义

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:38:28.963

这并不能解决您给定的示例，但我的示例确实有效并且更简单（在我看来）。

你想要做的是发送一个“ping”（如果你想这样称呼它）来检查连接。如果连接完成，您就知道您仍然处于连接状态。如果您得到 a`IOException`或 a `NullPointerException`，那么您可能已超时并且不再连接。

```
try {
    URL url = new URL("http://www.google.com");
    HttpURLConnection urlConnect = (HttpURLConnection) url.openConnection();
    urlConnect.setConnectTimeout(1000);
    urlConnect.getContent();
    System.out.println("Connection established.");
} catch (NullPointerException np) {
    np.printStackTrace();
} catch (IOException io) {
    io.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:53:24.817

使用这个片段，我在每个项目中都使用它：

```
public static boolean checkNetworkState(Context context) {
    ConnectivityManager conMgr = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo infos[] = conMgr.getAllNetworkInfo();
    for (NetworkInfo info : infos) {
        if (info.getState() == State.CONNECTED)
            return true;
    }
    return false;
} 
```

所以，你只需要传递`getApplicationContext()`给这个方法，比如`boolean hasConnection = checkNetworkState(getApplicationContext());`

# javascript - V8 中 Javascript 方法的时间复杂度

> ID：15622248
> 
> 赞同：9
> 
> 时间：2013-03-25T18:37:08.300
> 
> 标签：javascript, algorithm, performance, time-complexity, v8

我知道 Javascript 标准没有为数组等方法指定所需的时间复杂度，`unshift`但在特定的 Javascript 引擎（如 V8）中是否有时间复杂度的参考？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-09-26T09:09:04.303

> 在特定的 Javascript 引擎（如 V8）中是否有时间复杂度的参考？

*没有*。

正如您可能已经知道的那样，ECMA 规范没有指定边界复杂度，该引擎也没有。每个 JavaScript 引擎都可以自由实现自己的功能，只要它与标准兼容。

例如，V8 不为其方法提供时间复杂度。

您当然可以查看源代码，在我们的脑海中构建使用的算法，理解它，分析它，然后为它的时间复杂度提出一个界限。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2021-02-05T11:26:35.427

检查这个。

突变方法。

1.  推（） - 0（1）
2.  流行（） - 0（1）
3.  移位() - 0(n)
4.  unshift() - 0(n)
5.  拼接（） - 0（n）
6.  排序（） - 0（n log（n））

访问器方法

1.  连接（） - 0（n）
2.  切片（） - 0（n）
3.  indexOf() - 0(n)

迭代方法

1.  forEach() - 0(n)
2.  地图（） - 0（n）
3.  过滤器（） - 0（n）
4.  减少（） - 0（n）

# responsive-design - 将 jquery 同位素与 Foundation 集成

> ID：15622249
> 
> 赞同：2
> 
> 时间：2013-03-25T18:37:09.430
> 
> 标签：responsive-design, jquery-isotope, zurb-foundation

已经设法让 jQuery Isotope 和 Zurb Foundation 运行得相当好，但出于某种原因，在某些宽度下，当三列有足够的空间时（Foundation 的响应式网格中应该始终有空间），只显示一列或两列。

这是一个示例[http://codepen.io/anon/pen/yraxh的链接](http://codepen.io/anon/pen/yraxh)

有没有人设法获得与 Foundation 或 Twitter Bootstrap 一起使用的示例，以便它在他们的网格中很好地工作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:33:58.167

我也会尝试“Packery”。它适用于基于百分比的布局。它没有与同位素相同的所有功能，但很可能会达到其目的。

[http://packery.metafizzy.co/](http://packery.metafizzy.co/)

# python - 检查用户输入python

> ID：15622252
> 
> 赞同：-6
> 
> 时间：2013-03-25T18:37:16.193
> 
> 标签：python, user-input, datahandler

在我的 inputCheck 函数中，当用户输入在检查后通过是否是可接受的输入时，应该通过打印消息确认，然后运行另一个函数 - 但是它没有这样做，我不知道为什么 - 你能建议如何解决问题？非常感谢！

```
def main():
    print('WELCOME TO THE WULFULGASTER ENCRYPTOR 9000')
    print('==========================================')
    print('Choose an option...')
    print('1\. Enter text to Encrypt')
    print('2\. Encrypt text entered')
    print('3\. Display Encrypted Text!')
    menuChoice()

def menuChoice():
    valid = ['1','2','3']
    userChoice = str(input('What Would You Like To Do? '))
    if userChoice in valid:
        inputCheck(userChoice)
    else:
        print('Sorry But You Didnt Choose an available option... Try Again')
        menuChoice()

def inputCheck(userChoice):
    if userChoice == 1:
        print('You Have Chosen to Enter Text to Encrypt!')
        enterText()
    if userChoice == 2:
        print('You Have Chosen to Encypt Entered Text!')
        encryptText()
    if userChoice == 3:
        print('You Have Chosen to Display Encypted Text!')
        displayText()

def enterText():
    print('Enter Text')

def encryptText():
    print('Encrypt Text')

def displayText():
    print('Display Text')

main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:43:03.450

您将用户的输入转换为字符串 ( `str(input('What ...'))`)，但将其与`inputCheck`. 由于 中没有`else`路径`inputCheck`，因此当您输入“有效”选项时不会发生任何事情。

此外，如果您使用的是 Python 2，则 using`input`不是您想要的，`raw_input`而是要走的路（例如，请参阅[Python3.x 中 raw_input() 和 input() 之间的区别是什么？](https://stackoverflow.com/questions/4915361/whats-the-difference-between-raw-input-and-input-in-python3-x)）。

除此之外，`menuChoice`每当用户输入非法选择时递归调用很可能是一个坏主意：输入非法选择几十或几千次，您的程序将崩溃（除了浪费大量内存）。你应该把代码放在一个循环中：

```
while True:
    userChoice = str(raw_input('What Would You Like To Do? '))
    if userChoice in valid:
        inputCheck(userChoice)
        break
    else:
        print('Sorry But You Didnt Choose an available option... Try Again') 
```

# django - 为什么django不自动更新外键？（obj.relative.id ！= obj.relative_id）

> ID：15622253
> 
> 赞同：3
> 
> 时间：2013-03-25T18:37:20.857
> 
> 标签：django, django-models

我有这样的代码（Django 1.4.3）：

```
class Peon(models.Model)
  # ...
  order = models.ForeignKey(Order, db_column='idOrder')
  # ... 

  def save(self, *args, **kwargs):
    if self.order_id is None:
      self.order = Order()

    #edit self.order's fields appropriately
    self.order.generate(...)

    self.order.save()

    super(Peon, self).save(*args, **kwargs) 
```

super().save() 抱怨订单不存在。

换句话说，即使设置了 self.order.pk，self.order_id 仍然为 None，这使我无法保存 self。

我的解决方法是在调用 super().save() 之前执行此操作：

```
self.order_id = self.order.pk 
```

我的问题是，为什么这是必要的？感觉 self.order.save() 应该自动更新外键，但一定有充分的理由不这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:18:24.310

当您通过 生成订单时`self.order = Order()`，不会像调用订单的`save`方法时那样设置 id。因此`order_id`，您的对象字段`Peon`设置为无。

如果您的所有订单字段都是可选的，您可以执行类似的操作`self.order = Order.objects.create()`，然后将正确设置 ID。

否则你将需要做类似的事情

```
def save(self, *args, **kwargs):
  if self.order_id is None:
    order = Order()
    #edit self.order's fields appropriately
    order.generate(...)
    self.order = order

  else:
    #edit self.order's fields appropriately
    self.order.generate(...)

  self.order.save()

  super(Peon, self).save(*args, **kwargs) 
```

当然如果`order.generate`不需要后向关系。

# log4net - log4net：按日期滚动，按编号枚举文件

> ID：15622255
> 
> 赞同：0
> 
> 时间：2013-03-25T18:37:22.510
> 
> 标签：log4net, log4net-configuration

以前，我的团队一直在使用 log4net 按最大文件大小滚动，它生成的文件如下：

```
MyLog.log
MyLog.log.1
MyLog.log.2
etc. 
```

最近，我们切换到

```
<rollingStyle value="Date"/>
<MaxSizeRollBackups value="14"/>
<datePattern value="yyyyMMdd"/> 
```

现在产生的文件名如下：

```
MyLog.log
MyLog.log20130324
MyLog.log20130323
etc. 
```

是否可以按日期滚动，但仍然像以前一样枚举日志文件？如果是这样，我该怎么做？我浏览了 Log4net 的网站，但找不到有关如何执行此操作的良好参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:33:06.250

我认为如果不创建自定义附加程序就无法做到这一点。对于 RollingFileAppender，如果 rollingStyle 设置为 Date 或 Composite（默认），则下一个输出文件名由基本文件名 + datePattern 格式化的当前时间生成。

# oracle - 如何创建唯一约束

> ID：15622257
> 
> 赞同：3
> 
> 时间：2013-03-25T18:37:24.793
> 
> 标签：oracle, constraints

我有一种编程情况，我必须检查表列的唯一性。

假设我的表是员工表，我添加了一个代码列。现在我必须防止插入`MGR`and `mgr`。

所以这意味着我不能有 2 行具有不区分大小写的值。

如何添加检查约束？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T18:41:17.073

如果您使用的是 Oracle，您可以在列的小写字母上添加唯一索引。

```
create unique index <index_name> on <tablename>(lower(<column_name>)) 
```

# excel - Microsoft Excel 参考数据

> ID：15622259
> 
> 赞同：0
> 
> 时间：2013-03-25T18:37:34.263
> 
> 标签：excel, reference, lookup, cells, transpose

我试图弄清楚如何查找一个单元格以查看它是否包含我指定的列表中的名称，例如，我们将使用“Hofmann Trucking”。

使用 a、b 和 c 列，其中 a 列包含卡车从 a 点行驶到 b 点所需的平均小时数，b 列包含承运人信息（霍夫曼卡车运输），最后 c 列是我想要答案的地方.

我希望 c 列返回 a 列中列出的时间，前提是霍夫曼卡车运输是 b 列中的承运人。如果列出了另一个承运人，我想将该信息放在 d 列中。

最后，这些时间将是每个承运人每天的平均值，因此我可以轻松显示不同公司往返某些地区所花费的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:41:03.410

This should do it:

```
Col A       Col B                Col C                             Col D
8           Hoffman Trucking     =If(B1="Hoffman Trucking",A1,0)   =A1-C1 
```

Put those 2 formulas in columns C & D and drag down...

# multithreading - 多线程德尔福

> ID：15622261
> 
> 赞同：6
> 
> 时间：2013-03-25T18:37:39.297
> 
> 标签：multithreading, delphi

我在delphi中遇到多线程问题。我有一个名称列表（大约 2.000 个名称），我需要获取我网站中每个名称的一些数据。我的系统运行良好，除了线程控制。

我想创建 10 个线程，并且当某个线程终止时，创建另一个......直到列表结束。

```
var
 Form1: TForm;
 tCount: Integer;  //threads count

implementation

type
 TCheck = class(TThread)
 public
  constructor Create(Name: string);
  destructor Destroy; Override;
 protected
  procedure Execute; Override;
 end;

 MainT = class(TThread)
 protected
  procedure Execute; Override;
 end;

destructor TCheck.Destroy;
begin
 Dec(tCount);
end;

procedure MainT.Execute;
var
 i: Integer;
 Load: TStringList;
begin
 Load:=TStringList.Create;
 Load.LoadFromFile('C:\mynames.txt');

 for i:= 0 to Load.Count -1 do
 begin

  if tCount = 10 then  //if we have 10 threads running...
  begin
   repeat
    Sleep(1);
   until tCount < 10;
  end;

  TCheck.Create(Load.Strings[i]);
  TCheck.Start;
  Inc(tCount);

 end;

end;  // end of procedure 
```

好吧，我没有放 TCheck.Constructor 因为问题是我检查创建线程数的方法。我的意思是，我的软件只是停止，没有任何错误消息，有时检查 500 个名称，有时检查 150 个名称......

抱歉英语不好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T21:49:05.527

这是使用泛型的线程安全队列解决方案。

定义你想要多少个消费者线程，队列深度，然后`DoSomeJob`从一个线程运行程序。

将使用字符串的工作定义为通用过程（在 中`CaptureJob`）。

当队列为空时，消费者线程将被销毁。该`DoSomeJob`过程一直等到所有作业都准备好。您可以轻松地将其转换为通用工作池，重用线程而不破坏它们。工作项的通用结构也使它们适合处理不同类型的工作。

请注意，此队列适用于 XE2 及更高版本。如果您使用的是较旧的 delphi 版本，请按照评论中的建议查找类似的线程安全队列。

```
uses
  Classes,SyncObjs,Generics.Collections;

Type
  TMyConsumerItem = class(TThread)
  private
    FQueue : TThreadedQueue<TProc>;
    FSignal : TCountDownEvent;
  protected
    procedure Execute; override;
  public
    constructor Create( aQueue : TThreadedQueue<TProc>; aSignal : TCountdownEvent);
  end;

constructor TMyConsumerItem.Create(aQueue: TThreadedQueue<TProc>);
begin
  Inherited Create(false);
  Self.FreeOnTerminate := true;
  FQueue := aQueue;
  FSignal := aSignal;
end;

procedure TMyConsumerItem.Execute;
var
  aProc : TProc;
begin
  try
    repeat
      FQueue.PopItem(aProc);
      if not Assigned(aProc) then
        break; // Drop this thread
      aProc();
    until Terminated;
  finally
    FSignal.Signal;
  end;
end;

procedure DoSomeJob(myListItems : TStringList);
const
  cThreadCount = 10;
  cMyQueueDepth = 100;
var
  i : Integer;
  aQueue : TThreadedQueue<TProc>;
  aCounter : TCountDownEvent;
  function CaptureJob( const aString : string) : TProc;
  begin
    Result :=
      procedure
      begin
        // Do some job with aString
      end;
  end;
begin
  aQueue := TThreadedQueue<TProc>.Create(cMyQueueDepth);
  aCounter := TCountDownEvent.Create(cThreadCount);
  try
    for i := 1 to cThreadCount do
      TMyConsumerItem.Create(aQueue,aCounter);
    for i := 0 to myListItems.Count-1 do begin
      aQueue.PushItem( CaptureJob( myListItems[i]));
    end;
  finally
    for i := 1 to cThreadCount do
      aQueue.PushItem(nil);
    aCounter.WaitFor;  // Wait for threads to finish
    aCounter.Free;
    aQueue.Free;
  end;
end; 
```

* * *

**注意**：Ken 解释了为什么你的初始化和线程启动是错误的。该提案显示了一种更好的结构，可以以更通用的方式处理此类问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:04:56.857

如果你没有声明一个变量来保存 的返回值`TCheck.Create`，你就不能访问`TCheck.Start`（没有`TCheck`你可以用来访问该`Start`方法的实例）。

正确的方法是声明一个`var Check: TCheck;`inside `MainT.Execute`，然后存储返回的值：

```
Check := TCheck.Create(Load[i]);  { See note below }
Check.Start;
Inc(tCount); 
```

**注意**的默认属性`TStringList`是`Strings`，所以你不需要使用它。您可以`Strings`像我上面所说的那样直接访问。接下来的两行完全相同（但显然其中一行更短且更易于键入）：

```
Load.Strings[i];
Load[i]; 
```

如果您不想保留对 的引用`TCheck`，只需将您的代码更改为一个`with`块（包括`begin..end`, 并且块中不包含其他代码（这是我推荐使用的**唯一方法**`with`a ）：

```
with TCheck.Create(Load[i]) do
begin
  Start;
  Inc(tCount);
end; 
```

话虽如此，有更好的方法可以做到这一点，而不是创建/销毁各种线程。正如其他人所说，您可以拥有一个包含 10 个线程的列表并将其工作排队，以便每个线程处理一个项目`Load`，然后在完成后返回以获取另一个要处理的项目，并重复直到列表完成。很难确切地说你将如何做到这一点，因为这取决于你的 Delphi 版本。（有一些库可以为您完成大部分工作，例如[`OMNIThreadLibrary`](http://otl.17slon.com/)，但它不适用于某些旧版本的 Delphi。Delphi 的最新版本还支持`TQueue`和`TObjectQueue`以及其他一些可能非常有用的类型和功能。

（如果您对如何在线程数量有限的队列中执行此操作有不同的问题，那应该是一个**新问题**，而不是您添加到这个问题的问题。）

# firefox - 如何从所有域中删除所有 cookie？

> ID：15622266
> 
> 赞同：4
> 
> 时间：2013-03-25T18:38:05.073
> 
> 标签：firefox, selenium, webdriver, selenium-webdriver

Webdriver Wire Protocol 不包含从所有域中删除所有 cookie 的方法。[它只能从当前域中删除 cookie](https://code.google.com/p/selenium/wiki/JsonWireProtocol#/session/%3asessionId/cookie)。

我想从所有域中删除所有 cookie，因为 AUT 已与设置 cookie 的 3rd 方站点集成，并且我希望在每个测试开始时确保干净的状态以提高可维护性。

所以我开始考虑删除所有 cookie 的特定于驱动程序的方法。我对火狐特别感兴趣。

在 Firefox 中，它可以通过以下任一方式完成：

*   按`Ctrl`+ `Shift`+`Delete`然后`Enter`
*   编写允许一步完成的 Firefox 扩展

我错过了什么吗？是否有删除所有 cookie（从所有域）的跨驱动程序选项？

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2013-03-26T14:12:30.670

有几种方法可以做到这一点。这就是我通常在我的框架中实现工作的方式。

创建新的驱动程序对象（在本例中为 ChromerDriver）时，设置 ENSURING_CLEAN_SESSION 功能：

```
public WebDriver driver() {

    File driverServer = new File(WebDriverConfig.class.getClassLoader().getResource("webDrivers/chromedriver.exe").getFile());
    System.setProperty("webdriver.chrome.driver", driverServer.getAbsolutePath());
    DesiredCapabilities caps = DesiredCapabilities.chrome();
    caps.setCapability(CapabilityType.ForSeleniumServer.ENSURING_CLEAN_SESSION, true);
    return new ChromeDriver();

} 
```

然后在我使用 TestNG 框架的每个测试开始时：

```
@BeforeMethod(alwaysRun = true)
public void setup() {

    driver.manage().deleteAllCookies();
    // Do other stuff before each test executes

} 
```

您还可以通过获取 cookie 并找到您想要的，然后删除该 cookie 来仅删除特定的 cookie。

`driver.manage().getCookies();`

我希望这可以帮助您找到解决问题的方法。

# html - HTML - 左对齐 元素

> ID：15622275
> 
> 赞同：0
> 
> 时间：2013-03-25T18:38:30.593
> 
> 标签：html, asp-classic

我正在开发一个经典的 ASP 站点，右侧导航栏上的无序列表需要左对齐。通过删除`<ul></ul>`标签并简单地留下列表项，我能够做到这一点。但是，现在第一项的文本（对于它所在的表格单元格来说显然太长了）渗入了第二行。有谁知道，不使用`<ul>`标签，如何正确地证明文本？

这是一个屏幕截图。我需要让“应用程序”这个词与每个项目符号中的第一个词对齐。

![在此处输入图像描述](../Images/d81014c25744f80d9bcfb47d22659fc4.png)

这是本节的 HTML：

```
<p><strong><span style='font-size:10.0pt; font-family:&quot;Helvetica&quot;, &quot;sans-serif&quot;; color:#0070B9'>Please contact our Product Specialists for assistance with:</span></strong></p>
    <li><span style='font-size:10.0pt; font-family:&quot;Helvetica&quot;, &quot;sans-serif&quot;; color:#666666'>Submitting your first application</li>
    <li><span style='font-size:10.0pt; font-family:&quot;Helvetica&quot;, &quot;sans-serif&quot;; color:#666666'>Marketing Materials</span></li>
    <li><span style='font-size:10.0pt; font-family:&quot;Helvetica&quot;, &quot;sans-serif&quot;; color:#666666'>Quoting tools</span></li>
<p><strong><span style='font-size:10.0pt; font-family:&quot;Helvetica&quot;, &quot;sans-serif&quot;; color:#0070B9'><br /> 
```

编辑这是带有`<ul>`标签的列表的屏幕截图。

![在此处输入图像描述](../Images/361e5ce4d437f379aecec41f9b04c910.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T10:42:40.190

放回 UL 并用 css 减少边距。

```
ul.exampleList {
margin-left: ??px;
} 
```

您的代码示例：http: [//jsfiddle.net/jYmpG/](http://jsfiddle.net/jYmpG/)

# ios - 实现共享功能的标准方法

> ID：15622276
> 
> 赞同：3
> 
> 时间：2013-03-25T18:38:38.783
> 
> 标签：ios, share

我需要在 iOS 中实现“共享为...”功能。例如，按钮名称为“共享为...”并弹出一个对话框，其中包括电子邮件、短信、Facebook、Twitter 等项目。我想知道是否有一个标准对话框来完成这项工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T15:47:38.467

经过搜索，我发现使用 UIActivityViewController 在 iOS6 中似乎很“标准”的方式。

以下是 developer.apple.com 的描述：

UIActivityViewController 类是一个标准的视图控制器，您可以使用它从您的应用程序中提供各种服务。该系统提供多种标准服务，例如将项目复制到粘贴板、将内容发布到社交媒体网站、通过电子邮件或 SMS 发送项目等等。应用程序还可以定义自定义服务。

以下是我使用 UIActivityViewController 设法生成的对话框

![在此处输入图像描述](../Images/70937134ac27192464447f7a29ca84c9.png)

以下是我使用的源代码：

```
NSArray *activityItems = [NSArray arrayWithObjects: share_text.text, share_image.image , nil];

    UIActivityViewController *activityController = [[UIActivityViewController alloc] initWithActivityItems:activityItems applicationActivities:nil];
    [self presentViewController:activityController animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-17T08:40:57.913

在您的 ViewController.m 中：

```
NSString *message = @"The Flyer http://flyerdream.tumblr.com";
UIImage *image = [UIImage imageNamed:@"flyer"];
NSArray *arrayOfActivityItems = [NSArray arrayWithObjects:message, image, nil];
UIActivityViewController *activityVC = [[UIActivityViewController alloc]
                                         initWithActivityItems:arrayOfActivityItems applicationActivities:nil];

[self.navigationController presentViewController:activityVC animated:YES completion:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:50:00.450

**使用 UIActivityViewController 后，我相信它是一个比我在下面发布的更好的解决方案。我留下了我的答案，因为个人共享方法可能对某人有用。**

这就是我在项目中实现共享功能的方式：

**电子邮件**：使用`MFMailComposeViewController`。请参阅此处的文档：http: [//developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html)

**脸书和推特**：使用`SLComposeViewController`。请参阅此处的文档：http: [//developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/SLComposeViewController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/SLComposeViewController_Class/Reference/Reference.html)

例子：

```
// prepare and present SLComposeViewController if service is available
if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {
    SLComposeViewController *socialPost = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];
    [socialPost setInitialText:@"TEXT FOR POST"];
    [socialPost addImage:[UIImage imageNamed:@"yourImage.png"]];

    [self presentViewController:socialPost animated:YES completion:nil];
}

// set up a completion handler
[socialPost setCompletionHandler:^(SLComposeViewControllerResult result) {
    switch (result) {
        case SLComposeViewControllerResultDone:
            // post was completed
            break;
        case SLComposeViewControllerResultCancelled:
            // post was cancelled
            break;
        default:
            break;
    }
} 
```

注意：如果您想为 Twitter 发帖，请在上面的代码示例中`SLServiceTypeFacebook`替换为。`SLServiceTypeTwitter`

# php - 什么是防止未经身份验证的用户访问控制器方法的好技术？

> ID：15622277
> 
> 赞同：1
> 
> 时间：2013-03-25T18:38:44.397
> 
> 标签：php, codeigniter, access-control

我有一个事件控制器：

```
class Event extends CI_Controller{

   public function index(){
   }

   public function foo(){
   }

   //Shouldn't be able to use this method unless logged in
   public function bar(){
   }

} 
```

而且我正在尝试组织我的代码，使其相当整洁和直接。刚才我有一个名为 MY_Controller 的控制器，因此只有经过身份验证的用户才能访问任何扩展它的控制器的方法（edit_event()、add_event()）。

但是，我的控制器中的某些方法需要未经身份验证的用户才能访问（例如 get_event()）。

什么是处理这个的好方法？我应该制作两个完全独立的控制器还是从基本事件控制器扩展并添加经过身份验证的方法？

以前我有一个管理控制器来处理所有需要身份验证的方法，例如 add_user、delete_user、add_doc、delete_doc。但是它很快就被弄脏了，并且不容易更新或修改控制器（而且它很乱，似乎没有遵循良好的编程礼仪）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T17:01:18.940

通常我使用[钩子](http://ellislab.com/codeigniter/user-guide/general/hooks.html)

阅读有关它们的信息。

例如，我创建了一个 url_hook.php，它控制每次页面加载是否允许用户使用 uri：

```
class url_hook{

function allowed_urls(){

$allow = array('login','logout','search');

if(in_array($allow,$this->uri->segment(2)) && $this->session->userdata('user_id')){

 //ok user allowed

return true;

}else{

//user not allowed

 redirect(); 
```

} } }

然后在`config/config.php`我做：

```
$config['enable_hooks'] = TRUE; 
```

在`config/hooks.php`这样的事情中：

```
 $hook['pre_controller'][] = array(
                                'class'    => 'url_hook',
                                'function' => 'allowed_urls',
                                'filename' => 'url_hook.php',
                                'filepath' => 'hooks'

                                ); 
```

每次在您的应用中调用 url 时，所有这些都会自动运行

# windows-phone-7 - 系统告警复现

> ID：15622278
> 
> 赞同：0
> 
> 时间：2013-03-25T18:38:46.587
> 
> 标签：windows-phone-7

Windows Phone 允许您使用 ScheduledActionService 创建和注册系统警报。重复类型的选项是每天、每周等。

我正在尝试为特定日期设置警报。使用recurrenceType 枚举这是不可能的。我能看到的唯一方法是为指定的每一天创建一个警报。这样，对于创建的单个警报，我必须在希望它再次发生的每一天都创建它的副本。

唯一的问题是显示它们。它们不能被赋予“名称”属性，因此无法在逻辑上将这些警报分组到单个“主”警报中。

有没有人遇到过这个问题？有没有办法在不使用此调度程序服务的情况下设置警报？我想不出办法解决这个问题，并希望得到任何指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:29:42.547

我知道的唯一一个例子是有人处于类似情况，导致他们根本不使用调度程序。
由于他们需要复杂的调度模式，因此他们选择不使用任何内置功能，而是根据需要创建单独的警报。他们已经有一个现有的 BackgroundAgent 并在那里添加了功能，以确保接下来的两个警报总是排队。

您的确切要求可能使这成为可能。
不过，我会仔细考虑为此添加代理。

# ios - 没有自定义 UIPickerView 的 UIDatePicker 中的“未知”年份

> ID：15622279
> 
> 赞同：1
> 
> 时间：2013-03-25T18:38:54.390
> 
> 标签：ios, objective-c, cocoa-touch, uipickerview, uidatepicker

我担心这已经被问过了，并且被击落了很多次，但值得一试......

是否可以使用创建与联系人应用程序中的生日选择器完全相同的 UIDatePicker，并为年份组件选择“----”，而无需使用 UIPickerView 重新创建它？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:43:14.263

简短回答：不`UIDatePicker`，将始终显示年份。

# jquery - 在主干视图的滚动窗口中显示页面顶部

> ID：15622282
> 
> 赞同：2
> 
> 时间：2013-03-25T18:39:08.177
> 
> 标签：jquery, scroll, window, backbone-views

我有一个主干视图页面（或窗口），它可以有很长的内容，这使得垂直滚动成为必要。发生这种情况时，视口会自动定位在窗口的中间而不是顶部。无论页面是否有长内容，我都希望它在页面顶部打开。我尝试了几种 scrollTo 变体，但似乎都没有。请注意，我使用的是 Backbone js，并且是用 Coffeescript 编写的。这里是：

```
:coffeescript
  $ ->
    model = new Backbone.Model
      forcastTickInterval: #{xx_interval(@type_well.num_rows)}
      typeWell: #{@type_well.to_json}
      x_labels: #{price_array}
      disc_rate_array: #{disc_rate_array}
      disc_pv10_array: #{disc_pv10_array}
    view = new VGStream.Views.TypeWells.Show(
      model: model
    ).render()
    VGStream.App.router = new VGStream.Routers.Tabs()
    VGStream.App.currentView = view
    Backbone.history.start() 
```

选项卡路由器也相当简单：

```
class VGStream.Routers.Tabs extends Backbone.Router
  routes:
    '' : 'index'
    ':name' : 'viewTab'

  index: ->
    firstTab = $('.tab-nav li a').first()
    firstTab.scrollTop(0)
    if firstTab
      @navigate firstTab.attr('href'),
        trigger: true

  viewTab: (name) ->
    selectedTab = $(".tab-nav li a[href='##{name}']").parent()
    unless selectedTab.hasClass 'active'
      $('.tab-nav li.active').removeClass 'active'
      selectedTab.addClass 'active'
      $('.tab').hide()
      $(".tab##{name}").show()
      if VGStream.App.currentView? && VGStream.App.currentView[name]?()
        VGStream.App.currentView[name]() 
```

有趣的是，当我打开 Chrome 控制台并输入以下命令时：

this.scrollTo(0)

窗口正确地转到页面顶部。

我不知道如何解决这个问题。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:42:52.410

你有没有尝试过

```
$(document).scrollTop(0); 
```

[http://api.jquery.com/scrollTop/](http://api.jquery.com/scrollTop/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-30T09:11:08.370

感谢这是一个古老的问题，但也许下面的内容对于人们搜索旧的 SO 问题以回答他们的编程问题有一些用处。

所以，`$(document).scrollTop(0);`工作。它也适用于 Bootstrap 导航栏。但重要的是你*何时*调用它。您正在操作 DOM，即窗口，因此这需要在视图呈现后发生。[在 view.render() 完成后](https://stackoverflow.com/questions/9790361/backbone-js-event-after-view-render-is-finished)查看Backbone.js 事件，了解如何在视图呈现后触发事件。

我正在使用 Backbone.Marionette，因此会 自动触发两者`onRender`和事件。`onShow`这对我很有用：

```
 onRender: function(){
    $(document).scrollTop(0);
  } 
```

# matlab - 在 Matlab 中关闭所有 ImageJ 3D 查看器窗口

> ID：15622284
> 
> 赞同：1
> 
> 时间：2013-03-25T18:39:18.567
> 
> 标签：matlab

我正在使用 Fiji（ImageJ 的发行版）在 Matlab 中获取 3D 查看器。我想一次关闭所有“3D 查看器窗口”。Matlab 的“关闭（全部）”功能不处理这些窗口。有没有一种简单的方法可以一次关闭所有这些窗口，而不是为所有这些窗口单击“x”？

# java - jQueryUI datepicker 的 SimpleDateFormat 解析错误

> ID：15622289
> 
> 赞同：0
> 
> 时间：2013-03-25T18:39:29.803
> 
> 标签：java, jsp, jsp-tags, simpledateformat

我正在尝试使用 jQueryUi datepicker 中的 SimpleDateFormat 解析日期值，但是每次我尝试将其保存到数据库时，它都会以一种奇怪的格式保存，例如我输入 02/10/1995 它会保存为 0002-Jan-01 .

```
try {
        Date albumRelease = new SimpleDateFormat("MM/dd/yyyy").parse(request.getParameter("AlbumRelease"));
        album.setAlbumRelease(albumRelease);
    } catch (ParseException e) {
        e.printStackTrace();
    }

<label>Release Date</label>
<input type="text" name="AlbumRelease" id="datepicker" value="<fmt:formatDate pattern="MM/dd/yyyy" value="${album.albumRelease}" />" /> 
```

**调试模式下的变量检查将 albumRelease 返回为“Sun Dec 27 00:00:00 IST 11”**

我在第 60 行的 AlbumController 处遇到断点错误）

[https://github.com/linuxsavvy/music-library/blob/master/com.solancer/src/com/solancer/controller/AlbumController.java](https://github.com/linuxsavvy/music-library/blob/master/com.solancer/src/com/solancer/controller/AlbumController.java)

[https://github.com/linuxsavvy/music-library/blob/master/com.solancer/WebContent/Album.jsp](https://github.com/linuxsavvy/music-library/blob/master/com.solancer/WebContent/Album.jsp)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:06:45.110

当您进入`Sun Dec 27 00:00:00 IST 11`servlet 时，

您必须在 servlet中使用`SimpleDateFormat("EEE MMM dd HH:mm:ss z yy")`而不是。`SimpleDateFormat("MM/dd/yyyy")`

# matlab - 如何在MATLAB中将列矩阵转换为行矩阵

> ID：15622291
> 
> 赞同：3
> 
> 时间：2013-03-25T18:39:33.850
> 
> 标签：matlab, matrix

在 Matlab 中，我想将列矩阵转换为行矩阵，如下所示：

```
A =
  1
  2
  3
  4
  5
  6
  7
  8
  9 
```

对此：

```
A = [1 2 3 4 5 6 7 8 9] 
```

这是怎么做到的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-25T18:50:51.627

您想要矩阵的转置，在 Matlab 中写为`A'`.

# c# - C# LINQ 子在哪里

> ID：15622299
> 
> 赞同：1
> 
> 时间：2013-03-25T18:39:49.073
> 
> 标签：c#, linq, where

我有对象

```
 public class OrderItem
   {
      public string idProduct { get; set; }
      public int quantity { get; set; }
      public List<WarehouseItem> WarehouseInfo = new List<WarehouseItem>();
   }

   public class WarehouseItem
   {
       public string Name{ get; set; }
       public string LocnCode{ get; set; }
   } 
```

我需要选择具有 WarehouseInfo.LocnCode == "A1" 的项目

当我使用类似的东西时它不起作用

```
var items = itemList.Where(x => x.WarehouseInfo.Where(y => y.LocnCode.Equals("A1"))); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:53:25.520

您的要求可以解释为三种方式之一，所以这里有三种解决方案：

1.  给我所有`OrderItems`任何`WarehouseItem`有的`LocnCode`地方`"A1"`：

    ```
    var items = itemList.Where(i => i.WarehouseInfo.Any(w => w.LocnCode  == "A1")); 
    ```

2.  给我所有`WarehouseItem`s`OrderItem`中具有 a`LocnCode`的s `"A1"`：

    ```
    var items = itemList.SelectMany(i => i.WarehouseInfo)
                        .Where(w => w.LocnCode.Equals("A1")); 
    ```

3.  给我所有`OrderItems`任何`WarehouseItem`有 a`LocnCode`的地方`"A1"`，并过滤`WarehouseInfo`到只有那些`WarehouseItem`s：

这不能在简单的 Linq 查询中完成，因为无法*更改*现有对象的内容。您将不得不使用过滤后的值创建*新对象：*

```
 var items = itemList.Where(i => i.WarehouseInfo.Any(w => w.LocnCode  == "A1"))
                        .Select(i => new OrderItem
                                     {
                                         idProduct     = i.idProduct, 
                                         quantity      = i.quantity,
                                         WarehouseInfo = i.WarehouseInfo.Where(w => w.LocnCode.Equals("A1"));
                                                                        .ToList()
                                     }
                               ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:41:03.857

Try

```
var items = itemList.Where(x => x.WarehouseInfo.Any(y => y.LocnCode.Equals("A1"))); 
```

The `Where` takes a predicate that should return a `bool`. `Any` will return true if at least one item in the collection returns true for the given predicate.

# ruby-on-rails - How to change primary key in rails migration file?

> ID：15622303
> 
> 赞同：11
> 
> 时间：2013-03-25T18:39:55.713
> 
> 标签：ruby-on-rails, database-migration, rails-migrations

I need to migrate an old mysql table like this:

```
Products
  name (string, primary_key) 
```

to this schema:

```
Products
  id (integer, primary_key, auto_generated)
  name (unique) 
```

I need the Products.id values populated in the new table. How can i write the rails migration file? I am using Rails 3.2.7

I have 2 problems now: 1\. I can't find a method to remove primary key in ActiveRecord::Migration 2\. I don't know how to generate values for newly added primary key.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-25T19:43:13.057

您可以在迁移中执行任意 SQL：

```
execute "ALTER TABLE `products` DROP PRIMARY KEY" 
```

然后添加新列：

```
add_column :products, :id, :primary_key 
```

看：

[删除 MySQL 中的主键](https://stackoverflow.com/questions/2111291/remove-primary-key-in-mysql)

[如何将主键添加到rails中的表](https://stackoverflow.com/questions/9644509/how-to-add-a-primary-key-to-a-table-in-rails)

[http://thinkwhere.wordpress.com/2009/05/09/adding-a-primary-key-id-to-table-in-rails/](http://thinkwhere.wordpress.com/2009/05/09/adding-a-primary-key-id-to-table-in-rails/)

[http://api.rubyonrails.org/classes/ActiveRecord/Migration.html](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-11-09T08:08:14.970

如果您使用的是 Postgresql，则语法略有不同。

```
ALTER TABLE <table_name> DROP CONSTRAINT <table_name>_pkey; 
```

# c# - Error when using PrincipalContext.ValidateCredentials to authenticate against a Local Machine?

> ID：15622304
> 
> 赞同：11
> 
> 时间：2013-03-25T18:39:56.197
> 
> 标签：c#, wcf, authentication, active-directory, principalcontext

I have a WCF service which contains a `Login` method that validates a username and password against the local machine credentials, and after a seemingly random period of time it will stop working for some users.

The actual login command looks like this:

```
public UserModel Login(string username, string password, string ipAddress)
{
    // Verify valid parameters
    if (username == null || password == null)
        return null;

    try
    {
        using (var pContext = new PrincipalContext(ContextType.Machine))
        {
            // Authenticate against local machine
            if (pContext.ValidateCredentials(username, password))
            {
                // Authenticate user against database
                using (var context = new MyEntities(Connections.GetConnectionString()))
                {
                    var user = (from u in context.Users
                                where u.LoginName.ToUpper() == username.ToUpper()
                                      && u.IsActive == true
                                      && (string.IsNullOrEmpty(u.AllowedIpAddresses)
                                        || u.AllowedIpAddresses.Contains(ipAddress))
                                select u).FirstOrDefault();

                    // If user failed to authenticate against database
                    if (user == null)
                        return null;

                    // Map entity object to return object and assign session token
                    var userModel = Mapper.Map<User, UserModel>(user);
                    userModel.Token = Guid.NewGuid();
                    userModel.LastActivity = DateTime.Now;

                    // Authenticated users are added to a list on the server
                    // and their login expires after 20 minutes of inactivity
                    authenticatedUsers.Add(userModel);
                    sessionTimer.Start();

                    // User successfully authenticated, so return UserModel to client
                    return userModel;
                }
            }
        }
    }
    catch(Exception ex)
    {
        // This is getting hit
        MessageLog.WriteMessage(string.Format("Exception occurred while validating user: {0}\n{1}", ex.Message, ex.StackTrace));
        return null;
    }

    // If authentication against local machine failed, return null
    return null;
} 
```

This appears to work fine for a few days, then it will abruptly stop working for some users and throw this exception:

> **Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Exception from HRESULT: 0x800704C3)**
> 
> at System.DirectoryServices.AccountManagement.CredentialValidator.BindSam(String target, String userName, String password)
> 
> at System.DirectoryServices.AccountManagement.CredentialValidator.Validate(String userName, String password)
> 
> at System.DirectoryServices.AccountManagement.PrincipalContext.ValidateCredentials(String userName, String password)
> 
> at MyNamespace.LoginService.Login(String username, String password, String ipAddress) in C:\Users\me\Desktop\somefolder\LoginService.svc.cs:line 67

Line 67 is: `if (pContext.ValidateCredentials(username, password))`

I'm not sure if it matters or not, but the final line of the error message is the path of the VS solution on my development machine, not the path to the files on the production server.

When it fails, it only fails for some users, while others can continue to login just fine. The only thing I have found to temporarily fix the error is running `iisreset`. Stopping/starting the web site or recycling the app pool doesn't work.

I am unable to reproduce the error on demand. I've tried logging in with the same user from multiple sessions and IP addresses, logging in with different users from the same browser session at the same time, spamming the Login button to try and get it to run multiple times, etc but everything appears to work fine.

I can see from our logging that users have been successfully able to login in the past:

```
3/21/2013
o   9:03a   I logged in
o   1:54p   UserB logged in
o   1:55p   UserA logged in
o   2:38p   UserB logged in
o   3:48p   UserB logged in
o   5:18p   UserA logged in
o   6:11p   UserB logged in

3/22/2013
o   12:42p  UserA logged in
o   5:22p   UserB logged in
o   8:04p   UserB logged in

3/25/2013 (today)
o   8:47a   I logged in
o   12:38p  UserB tries logging in and fails. Repeated ~15 times over next 45 min
o   1:58p   I login successfully
o   2:08p   I try to login with UserB's login info and fail with the same error

```

The reason we authenticate against the local machine is because users have an account created locally for FTP access, and we didn't want to build our own custom login system or make our users remember two sets of credentials.

The code should only authenticate the user's credentials, and does not do do anything else with the user's credentials. There is no other code that uses `System.DirectoryServices`, no file IO going on, and no access to anything locally on the file system other than the files required to run the web application.

What can cause that error to appear, seemingly at random, after a few days? And how can I fix it?

The server is Windows Server 2003, which runs IIS 6.0, and it is setup to use .Net Framework 4.0

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T18:13:04.757

我可以在网上找到最接近解释这个问题的是[这个论坛帖子](http://forums.asp.net/t/953113.aspx/1)，用户遇到同样的错误并得到重播说明：

> WinNT 提供程序在服务器环境中表现不佳。我实际上很惊讶你没有看到这个负载要小得多。我只需要 2 或 3 个用户就可以做到这一点。

这个SO[评论](https://stackoverflow.com/questions/290548/validate-a-username-and-password-against-active-directory#comment580943_290558)说明

> 正确验证某人的最佳方法是使用 LogonUserAPI 作为@stephbu 编写。这篇文章中描述的所有其他方法都不会 100% 有效

其中“所有其他方法”包括使用的最高投票答案`PrincipalContext.ValidateCredentials`

它在 Windows Server 2003 和 IIS6.0 上听起来`PrincipalContext.ValidateCredentials`并不完全 100% 可靠，所以我重写了我的身份验证代码以改用[LogonUser](http://msdn.microsoft.com/en-us/library/aa378184.aspx) WinAPI 方法。

```
[DllImport("advapi32.dll", SetLastError = true)]
public static extern bool LogonUser(
    string lpszUsername,
    string lpszDomain,
    string lpszPassword,
    int dwLogonType,
    int dwLogonProvider,
    out IntPtr phToken
    );

IntPtr hToken;
if (LogonUser(username, "", password, 
    LOGON32_LOGON_NETWORK, LOGON32_PROVIDER_DEFAULT, out hToken))
{
    ...
} 
```

# c# - WPF Listbox grows outside screen size (MVVM light)

> ID：15622306
> 
> 赞同：3
> 
> 时间：2013-03-25T18:40:03.940
> 
> 标签：c#, wpf, listbox, scrollbar

I have a typical MVVM structure. A mainwindow consists of some labels and a viewmodel (bound as ContentControl). This viewmodel has a listbox where I add entries. As the list grows the height of my viewmodel grows as well and thus the height of the whole application. Unfortunately the size doesn't stop at the edge of the screen and just grows out of the screen. I tried all the different size-restrictions on the mainwindow, the viewmodel is stretched in both dimensions. Furthermore, I tried to get a scrollbar for the listbox but didn't succeed (or it's just there but not enabled if I force it.)

How can I restrict the maximal size to be the resolution of the screen (fullscreen) and get a scrollbar for the listbox when the size is reached?

€: Okay, here should be the relevant part of my code. I tried a fixed size of 1024x768 but even that doesn't work.

MainWindow.xaml

```
<Window x:Class="SWS.MainWindow"
    DataContext="{Binding Main, Source={StaticResource Locator}}"
    Width="1024"
    Height="768"
    MaxWidth="1024"
    MaxHeight="768">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <ContentControl Grid.Row="0" Content="{Binding CurrentViewModel}" />
    </Grid>
</Window> 
```

The ViewModel in question

```
<UserControl x:Class="SWS.Views.ProgramView"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0">
            <Label Width="65" Content="{x:Static p:Resources.PrV_Number}" />
            <Label Width="75" Content="{x:Static p:Resources.PrV_Weight}" />
            <Label Width="55" Content="{x:Static p:Resources.PrV_Action}" />
            <Label Content=" " />
        </DockPanel>
        <ListBox Grid.Row="1" 
                 VerticalAlignment="Stretch" 
                 ItemsSource="{Binding ParticleCollection}" 
                 ScrollViewer.CanContentScroll="True"
                 ScrollViewer.VerticalScrollBarVisibility="Auto">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <DockPanel>
                        <TextBlock Text="{Binding ID}" Width="53" />
                        <TextBlock Text="{Binding Weight, StringFormat=F4}" Width="65" />
                        <TextBlock Text="{Binding Action}" Width="52" />
                    </DockPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:15:23.923

您需要在`Window`for`ContentControl`和 your `ListBox`in上将行高设置为 *`UserControl`以填充可用空间，而不是尝试获得所需的空间。

这很好用：

MainWindow.xaml：

```
<Window x:Class="SWS.MainWindow"
    DataContext="{Binding Main, Source={StaticResource Locator}}"
    Width="1024"
    Height="768"
    MaxWidth="1024"
    MaxHeight="768">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <ContentControl Grid.Row="0" Content="{Binding CurrentViewModel}" />
    </Grid>
</Window> 
```

和`UserControl`：

```
<UserControl x:Class="SWS.Views.ProgramView"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        ...
    </Grid>
</UserControl> 
```

也可以通过更多方式做到这一点：

在你的`Window`你可以完全删除`<Grid.RowDefinitions>...<Grid.RowDefinitions>`。默认行为是您所寻找的。

当您有超过 1 行时，您可以选择指定`Height="*"`或`Height`仅从`RowDefinition`

```
<Grid.RowDefinitions>
    <RowDefinition Height="Auto" />
    <RowDefinition />
</Grid.RowDefinitions> 
```

# asp.net-mvc - Razor View rendered as text

> ID：15622308
> 
> 赞同：0
> 
> 时间：2013-03-25T18:40:04.750
> 
> 标签：asp.net-mvc, razor, view

I have the Template MVC 4 change password view returning text instead of html:

Password View:

```
@model Heelp.ViewModels.LocalPasswordViewModel

<p>@ViewBag.StatusMessage</p>

@if(Model.HasLocalPassword)
{
    @Html.Partial(MVC.Account.Views._ChangePasswordPartial)
}
else
{ 
    @Html.Partial(MVC.Account.Views._SetPasswordPartial)
} 
```

And the ChangePartial View:

```
@model Heelp.ViewModels.LocalPasswordViewModel

@if (!String.IsNullOrEmpty(Model.Result))
{
    <div class="result">
        @Model.Result
    </div>
}
@if (!Model.ChangePasswordSucceeded)
{
    using (Html.BeginForm(MVC.Account.Password())) 
    {
        @Html.AntiForgeryToken()

        @Html.LabelFor(m => m.OldPassword)
        @Html.PasswordFor(m => m.OldPassword)
        @Html.ValidationMessageFor(m => m.OldPassword)
        <br />
        @Html.LabelFor(m => m.NewPassword)
        @Html.PasswordFor(m => m.NewPassword)
        @Html.ValidationMessageFor(m => m.NewPassword)
        <br />
        @Html.LabelFor(m => m.ConfirmPassword)
        @Html.PasswordFor(m => m.ConfirmPassword)
        @Html.ValidationMessageFor(m => m.ConfirmPassword)
        <br />
        <input type="submit" value="@HeelpResources.ChangePasswordPartialSubmitButtonLabel" />
    }
} 
```

And finally the controller:

```
 [HttpPost]
    [ValidateAntiForgeryToken]
    public virtual ActionResult Password(LocalPasswordViewModel model)
    {
        // Has this information is lost in the roundtrip between the Controller and the Action, we need to get this information again
        model.HasLocalPassword = OAuthWebSecurity.HasLocalAccount(WebSecurity.GetUserId(User.Identity.Name));

        if (model.HasLocalPassword)
        {
            if (ModelState.IsValid)
            {
                // It's a local account so update the new password
                model.ChangePasswordSucceeded = WebSecurity.ChangePassword(User.Identity.Name, model.OldPassword, model.NewPassword);
            }

            // Send back to the View the results of the operation
            model.Result = model.ChangePasswordSucceeded ? HeelpResources.AccountManagePasswordChangeSucessMsg : HeelpResources.AccountManagePasswordChangeErrorMsg;

            return View(model);
        }
        else
        {
            try
            {
                // It's not a local account so create the account based on the external information and the password
                WebSecurity.CreateAccount(User.Identity.Name, model.NewPassword);
                model.ChangePasswordSucceeded = true;
            }
            catch (Exception)
            {
                model.ChangePasswordSucceeded = false;
            }

            // User does not have a local password so remove any validation errors caused by a missing OldPassword field
            ModelState state = ModelState["OldPassword"];
            if (state != null)
            {
                state.Errors.Clear();
            }

            // Send back to the View the results of the operation
            model.Result = model.ChangePasswordSucceeded ? HeelpResources.AccountManagePasswordSetSucessMsg : HeelpResources.AccountManagePasswordSetErrorMsg;
        }

        return View(model);
    } 
```

And when I submit the Password Change Form I get the page in text format:

```
< !DOCTYPE html >
< html xmlns="http://www.w3.org/1999/xhtml" >
< head >
  < meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  < title>izigo | tudo fica mais fácil</title>
  < meta name="viewport" content="width=960, user-scalable=yes"/> 
```

//REST OF THE TEXT PAGE

Any ideas why is this happening?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:45:08.483

[Html.Partial](http://msdn.microsoft.com/en-us/library/ee402902%28v=vs.108%29.aspx)返回一个 HTML 编码的字符串，它可以解释您所看到的行为。

如果您想渲染视图，那么也许可以尝试[Html.RenderPartial](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.renderpartialextensions.renderpartial%28v=vs.108%29.aspx)。

另外，参见这个 Stack Overflow[问题](https://stackoverflow.com/questions/5248183/html-partial-vs-html-renderpartial-html-action-vs-html-renderaction)

# c# - Enable scroll bars once a flow control exceeds a certain size in winform?

> ID：15622313
> 
> 赞同：1
> 
> 时间：2013-03-25T18:40:33.777
> 
> 标签：c#, winforms, autosize, autoscroll

I did some browsing and could not find an answered question that addresses this issue.

My winform consists of a fill-docked flow control with a bunch of other controls in it. More controls leave and are added during runtime, so I have the flowcontrol (and the winform) autosize to fit everything as it appears.

The issue is, I want scrollbars to appear once the form exceeds a certain size. So if the form is small, it continues to autosize to fit, but once it gets about a certain height, the internal flowcontrol keeps doing its thing but the form stops growing and a scroll bar appears.

Is there a way to do this? All combinations of dock, autoscroll, and autosize that I tried were fruitless, but maybe I was doing it wrong.

Just a quick note - currently, once the flowcontrol grows to be taller than the screen, it moves everything below that line over to a new column. I would also like to disable this, so that it continues to grow vertically regardless of screen height (because I will have scroll bars).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:18:28.360

放入`FlowLayoutPanel`面板`panel1`

```
panel1.AutoScroll = true;
panel1.Dock = DockStyle.Fill; //if you want

FlowLayoutControl.AutoSize = true;
FlowLayoutControl.AutoScroll = false;
FlowLayoutControl.Dock = DockStyle.None;
FlowLayoutControl.Anchor = AnchorStyles.Left | AnchorStyles.Top | AnchorStyles.Right;
FlowLayoutControl.Location = new Point(0,0);
FlowLayoutControl.Size = new Size(FlowLayoutControl.Width, 0); 
```

# authorization - Allowing data to be stored for a client who isn't logged in using Meteor Auth and then saving on login

> ID：15622315
> 
> 赞同：7
> 
> 时间：2013-03-25T18:40:43.873
> 
> 标签：authorization, meteor

I have a simple form that captures data from the user. It is just a single field and a date stamp for tracking weight on a daily basis.

I am using the Meteor authorisation package. When a user is logged in I just save UserID into the list and then filter the collection for that User ID.

This is fine if I force users to login before they use the system.

But I would like to allow users to try the system first. So they might save 3 or 4 lines of data and then decide to create an account and save. In the short term I would like to just save the data from that current session (so if they shut their browser down without having saved, their data is lost). In Phase 2 I would like the data to persist so that if they don't save but come back the next day in the same browser they can still decide to save their data against a permanent account.

I am currently thinking of saving the uuid instead of the standard Meteor.userId for temporary users and then just replace this value with their new Meteor.UseriD. Longer term saving a random number as the user ID and saving this data to a persistent client cache and then overwriting with their Meteor.UserID when they create an account.

But I am a newbie and would like to know if there is a more elegant way of achieving these two goals:

1) Allowing the user to record some data, that only they can see. Then saving this when they choose to create an account. 2) Allowing the user to record some data, that persists across sessions. Then saving that data when they choose to create an account.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T03:30:46.137

如果您使用的是陨石包管理器，您可以使用 accounts-anonymous 插件[https://github.com/tmeasday/meteor-accounts-anonymous](https://github.com/tmeasday/meteor-accounts-anonymous)

它只有两个小文件，因此您也可以直接将其添加到您的项目中。

然后一旦登录将用户信息传输过来。

# vhdl - variable assignment and synthesizable code

> ID：15622319
> 
> 赞同：0
> 
> 时间：2013-03-25T18:40:53.250
> 
> 标签：vhdl, fpga, synthesize

Simply having a code like this :

```
if(rising_edge(clk)) then
    temp(0):="001";
    temp(1):="011";
    temp(2):="101";
    temp(3):="000";
    temp(0):=temp(3)xor temp(5);
end if 
```

For the example above all this variable assignment would be done in 1 clock cycle which is pretty unpractical. In the behavioral simulation it works fine but in post synthesis it's messed up. Can I add like a delay or a sth like a wait(wait statement is un-synthesizable) to make it wait util the variable gets its value before jumping to the next line?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:02:19.530

在一个时钟周期内完成所有这些事情很简单。硬件速度非常快，相对于处理器而言，FPGA 时钟速率并没有那么高。

由于您使用的是变量，因此会立即使用中间结果。如果您想要更明确的延迟，可以使用信号。上面带有信号的代码将`temp(3)`从前一个上升沿开始使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T06:47:31.413

对于合成，您不能像等待一样进行延迟。定义明确、可控的综合延迟只能通过流水线（时钟周期作为延迟单位）来实现。

# excel - Excel 2010 - 尝试刷新 odbc 后爆炸

> ID：15622323
> 
> 赞同：0
> 
> 时间：2013-03-25T18:41:08.050
> 
> 标签：excel, excel-2010, excel-2013

我使用office 2013制作了一个excel电子表格，效果很好。但是当我尝试在 Office 2010 中打开它时，它会在检索数据时崩溃。

**我的配置**：office 2013 - x64

**客户**：办公室 2010 - x32

**数据来源**：odbc

我不知道出了什么问题，

我试过什么：

如果我确实单击编辑查询并运行它运行的查询，但是一旦我按下按钮将数据带回办公室，它就会崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T11:13:20.637

您是否尝试过为 Office 2010 安装 powerpivot？

这可能会为您提供更清洁、更强大的解决方案，适用于两个版本的 Excel

# linux - 如何grep目录及其所有子目录中的字符串？

> ID：15622328
> 
> 赞同：257
> 
> 时间：2013-03-25T18:41:32.677
> 
> 标签：linux, unix, grep, centos

如何在LINUX中grep目录及其所有子目录的文件中的字符串或文本？

* * *

## 回答 #1

> 赞同：454
> 
> 时间：2013-03-25T18:42:52.690

如果您的 grep 支持`-R`，请执行以下操作：

```
grep -R 'string' dir/ 
```

如果没有，则使用`find`：

```
find dir/ -type f -exec grep -H 'string' {} + 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-03-25T18:43:41.310

```
grep -r -e string directory 
```

`-r`用于递归；`-e`是可选的，但它的参数指定要搜索的正则表达式。有趣的是，[POSIX`grep`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/grep.html)不需要支持`-r`（或`-R`），但~~我几乎可以肯定 System V支持`grep`，所以~~实际上它们（几乎）都支持。某些版本的`grep`支持`-R`以及（或可能代替）`-r`；AFAICT，这意味着同样的事情。

# jquery - jQuery Mobile 中一直存在的顽固子页面

> ID：15622331
> 
> 赞同：1
> 
> 时间：2013-03-25T18:41:40.670
> 
> 标签：jquery, css, jquery-mobile

好的，所以我遇到了一个问题。

我正在使用一个主要是 jQuery Mobile 和 Javascript 的应用程序，以及一些用于动态创建 HTML 的 jQuery。

我们正在使用 jQuery 插件来创建子页面，效果很好。子页面呈现得很好，但是在导航回原始页面后给了我一个非常顽固的问题。回到实际页面后，我在底部留下了 15 像素的边距，这显然是子页面的内容 div，它已被破坏并留空且未填充，但显然固定在我的页面底部。页眉和页脚 div 不显示，只是内容 div 的填充。

我尝试过使用 jQuery 操作高度、填充和显示 css，所有这些要么什么都不做，要么隐藏整个年龄，而不仅仅是子页面 div 或子页面内容 div。我对 $('div').hide()、$('div').remove 和其他此类 jQuery 方法也有同样的问题，所有这些方法都会在此过程中将整个原始页面变为空白。

任何指针？

# javascript - 使用 jQuery 通过 DOM 创建 SVG

> ID：15622333
> 
> 赞同：3
> 
> 时间：2013-03-25T18:41:41.967
> 
> 标签：javascript, jquery, google-chrome, svg, xhtml

## 该项目：

我目前正在执行通过 JS + jQuery 动态创建 SVG 元素的任务。一切顺利，我可以在屏幕上绘制所有基本形状。

## 问题：

`<DEFS>`当我尝试在块中声明形状并使用 绘制时`<USE>`，屏幕上没有绘制任何内容。

## 困惑：

尽管屏幕上没有绘制任何内容，但如果我通过 Firebug 或 Chrome 的 Dev 工具检查动态 DOM，则语法很好；我什至可以复制语法，放在一个`.SVG`文件中，它会正常工作。

## 附加信息：

*   我正在使用内联 SVG
*   使用 xhtml 而不是 html
*   主要使用jQuery框架
*   外面`USE`的任何东西都`DEFS`可以正常工作。

## 我的 jQuery 代码：

```
var $root = $('#svgRoot');

    $(document).ready(function(e) {
        init($root);

        var $defBlock = $(def(null, {}));
        $(ellipse('petal', {cx: '50%', cy: '50%', rx: '75', ry: '15'}, $defBlock));
        $(use(null, { x: '10%', y: '10%',   fill:'purple' , 'xlink:href':'#petal'}));

    }); 
```

这些都是自定义函数，第一个参数是元素 ID，其他都是属性。第三个参数是可选的。它指定要附加到的父级。如果为 null，则附加到根 SVG 节点。如果指定，它将附加到该父级。

## 使用 Chrome 检查时的输出：

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svgRoot" version="1.1">
    <svg:defs xmlns:svg="http://www.w3.org/2000/svg">
        <svg:ellipse id="petal" cx="50%" cy="50%" rx="75" ry="15" />
    </svg:defs>
    <svg:use xmlns:svg="http://www.w3.org/2000/svg" x="10%" y="10%" fill="purple" xlink:href="#petal" />
</svg> 
```

## 帮助！

即使底层 DOM 是正确的，并且在放置在独立`.SVG`文件中时也可以正常工作，是否有人对不呈现代码有任何经验？

## 编辑：在引擎盖下

```
function createBasicNode(parent ,shape, id, attributes){
    var $tag = $(createSVG(shape));

    if(id != null){
        $tag.attr('id', id);
    }

    applyAttributes($tag, attributes);
    $tag.appendTo(parent);
    return $tag;
}

function def(id, attributes, parent){
    parent = (parent === undefined) ? $parent : parent;
    return $(createBasicNode(parent,'defs', id, attributes));
}

function use(id, attributes, parent){
    parent = (parent === undefined) ? $parent : parent;
    return $(createBasicNode(parent,'use', id, attributes));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T01:26:13.227

你在用[`createElementNS()`](https://developer.mozilla.org/en-US/docs/DOM/document.createElementNS)吗？

您不能使用常规创建命名空间元素`createElement()`。如果你使用像 in 这样的前缀名称，`createElement("svg:defs")`它最终会成为标签名称的一部分（它没有语法，但想象一下类似的东西`<null:svg\:defs>`）。

在带有 HTML5 解析器的浏览器中，您可以使用它`el.innerHTML = "<svg>…&lt;/svg>"`来创建 SVG 命名空间元素，因为`<svg>`它是由解析器特例化的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:09:20.010

如果您不使用`svg`标签上的前缀，它会起作用。例如

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svgRoot" version="1.1">
    <defs xmlns:svg="http://www.w3.org/2000/svg">
        <ellipse id="petal" cx="50%" cy="50%" rx="75" ry="15" />
    </defs>
    <use xmlns:svg="http://www.w3.org/2000/svg" x="10%" y="10%" fill="purple" xlink:href="#petal" />
</svg> 
```

# ruby-on-rails-3 - 从 rails setter 访问属性

> ID：15622338
> 
> 赞同：0
> 
> 时间：2013-03-25T18:41:59.927
> 
> 标签：ruby-on-rails-3

我有点卡住试图从 Rails 中的自定义设置器访问（读取）属性：

```
def password=(new_password)

  puts self.firstname # returns nil

  # Do other checks here before setting a hashed SCrypt password

end 
```

名字是在（用户）对象上定义的，但是调用名字不会产生值集。我需要从自定义设置器中读取各种属性，以针对名字、姓氏和电子邮件地址进行密码检查。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:11:25.463

你有对应的getter方法吗？

```
def password
  @password
end 
```

或者，如果它是一个非常简单的 getter/setter 对

```
:attr_accessor password 
```

更新您的评论：所以您想要做的不仅仅是在 setter 中设置属性？

所以很明显，我必须反对这一点。但是，您可以执行以下操作：

```
def password=(new_password)
  some_method(new_password)
  @password = new_password
end 
```

这会将 new_password 方法从 setter 中传递出去，允许您在将实例变量设置为新值之前用它做其他事情。

如果您尝试访问密码设置器中的 firstname 属性，如您的示例中所示，您可以这样做：

```
def password=(new_password)
  some_method(firstname)
  @password = new_password
end 
```

您不使用 self 来调用 getter 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T16:08:41.287

好的似乎是我的应用程序某处的问题。我刚刚做了一个运行良好的最小测试应用程序：

```
class User < ActiveRecord::Base

  def password
    password ||= SCrypt::Password.new(password_hash)
  end

  def password=(new_password)

    logger.info 'DEBUG: self.lastname: ' + self.lastname.to_s

    self.password_hash = SCrypt::Password.create(new_password, :key_len => 512, :salt_size => 32)

  end

end 
```

在控制台中它工作正常：

```
Loading development environment (Rails 3.2.12)
2.0.0-p0 :001 > u = User.new
 => #<User id: nil, firstname: nil, lastname: nil, password_hash: nil, created_at: nil, updated_at: nil>
2.0.0-p0 :002 > u.lastname = "Some Lastname"
 => "Some Lastname"
2.0.0-p0 :003 > u.password = 'test'
DEBUG: self.lastname: Some Lastname
 => "test" 
```

因此，这似乎是与应用程序中的 gem / something / 某处相关的问题，而不是 Rails 特定的问题。向名单道歉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-10T15:15:08.323

根据我的观察，参数的顺序在这里很重要。

⚠️注意通过的顺序`:firstname`和`:password`时间。

如果您正在使用`params.require(:user).permit(:firstname, :password)`然后通过`.new`or`=setter`方法将其传递给您的设置器。然后，您始终可以`self.firstname`在您的`password=`setter 方法中访问，因为您`firstname`首先获得了设置，并且可以访问下一个 setter。

但是，如果您有，`params.require(:user).permit(:password, :firstname)`那么您的密码设置方法将无法访问`self.firstname`.

# sql-server-2008 - 在导入 SSIS 时将参数值添加到表中

> ID：15622344
> 
> 赞同：0
> 
> 时间：2013-03-25T18:42:15.603
> 
> 标签：sql-server-2008, ssis

我正在使用 SSIS 将 Excel 表从 ftp 站点导入 SQL。目标表将用于计算基于另一个 SQL 数据库的好记录和坏记录。这是我的问题。Excel 文件的名称为 RTW_032613_ABC_123.xls。该文件名是多个字段的串联。我无法根据表中的字段重新创建它，因此我需要保留它并将其传递给 SQL 中的新表。我有一个参数@FileName，我用它来遍历ftp 文件夹中的文件。我想做的是将Excel文件中的数据导入与文件名结合起来，或者在导入后将文件名插入每条记录中。我从 SQL 中的另一个存储过程调用 SSIS 过程。

我在这方面对 SSIS 感到不知所措。关键是我需要的参数在 SSIS 中可用，但我真的需要将它传递给我的 SQL 表。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T20:17:58.740

如果我没看错您的问题，您有一个 SSIS 包，其中包含一个包含文件名的变量，并且您希望将文件名与您发送到 SQL 表的每一行一起保存？如果是这样：

1.  将派生列添加到数据流，创建新列并引用表达式中的变量
2.  将该新列包含在数据流目标的映射中，将文件名发送到您要保存该数据的任何列。

无需单独的 SQL 任务。

# coldfusion - 使用当前表单输入在冷融合中生成 pdf

> ID：15622346
> 
> 赞同：0
> 
> 时间：2013-03-25T18:42:30.337
> 
> 标签：coldfusion, pdf-generation

我们有一个表格，表格下方有一个动态运行总计表。例如，当用户更改 Quantity 字段中的值时，运行总计会根据输入（通过 javascript）更新。只显示表格，数据库中不保存任何内容

我们希望能够生成一个包含更新的运行总计的 pdf。基本上我正在搜索是否有某种方法可以将`innerHTML`div 中的电流传递给 pdf。

这可能已经在这里被问过并得到了回答——[从当前文档生成 pdf](https://stackoverflow.com/questions/9296371/generate-pdf-from-current-document?rq=1)，但用户并没有特别说明表单在初始页面加载后更新数据。所以我只是想确保我没有遗漏任何东西。谢谢。我有一种感觉，我应该调查一下`localStorage`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T12:21:25.313

（来自评论）

我认为您可能使 PDF 功能过于复杂。就生成 PDF 而言，不必跟上用户所做的本地更改。用户很可能会对页面进行任何更改，然后仅在完成所有更改后单击链接/按钮以生成 PDF。此时，您可以简单地将包含所有更新值的表单提交给 ColdFusion 并生成您的 PDF 文件。代替/或与更新`innerHTML`div 一起更新隐藏的表单字段。然后在 ColdFusion 服务器上，您可以使用[CFDocument](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7c21.html)标签之类的东西从提交的表单字段创建您的 PDF。（请记住在使用之前验证所有表单字段数据。）

# owl-api - 无法使用 OWLAPI 加载 OWL 文件

> ID：15622353
> 
> 赞同：0
> 
> 时间：2013-03-25T18:43:02.553
> 
> 标签：owl-api

我正在尝试使用 owlapi 彻底的网络 bean 加载 .owl 文件，以使用 owlapi 文档中列出的代码插入个人及其数据属性，但它无法加载文件，但是当我将 .owl 文件转换为 .rdf 格式时已成功加载，我能够插入所需的数据。我需要操作 .owl 文件而不是 .rdf 格式

以下是我用来加载.owl但没有成功的代码

> ```
>  File fileBase = new File("src/java/ontology.owl);
>      OWLOntologyManager manager = OWLManager.createOWLOntologyManager();
>      OWLOntology ontology= manager.loadOntologyFromOntologyDocument(fileBase); 
> ```

但是当我使用如下所示的 rdf fromat 时，它已成功加载

> ```
>  File fileBase = new File("src/java/ontology.rdf); 
> ```

那么我该如何克服这个问题并加载 .owl 文件呢？

以下命令是将公理保存到本体文件的最佳命令吗？

> manager.saveOntology（本体）；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T10:19:04.607

我建议你检查你的 OWL 文件。如果它无法解析本体，它将抛出异常。您需要捕获并读取异常。很可能是解析问题。你的命令完全没问题。

通过您的命令保存本体很好，但根据 OWL 文档，最好的方法是在每次更改后“应用更改”。就像是：

```
manager.applyChange(axiom); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-04T23:40:39.023

这是您的 .owl 文件的问题。使用下面的链接来验证您的本体文件 [http://mowl-power.cs.man.ac.uk:8080/validator/](http://mowl-power.cs.man.ac.uk:8080/validator/)

# python - Django：使用 post() 方法的 ListView？

> ID：15622354
> 
> 赞同：9
> 
> 时间：2013-03-25T18:43:02.497
> 
> 标签：python, django, formview, django-class-based-views

我正在尝试在基于 Django 类的视图中处理两种表单。该站点包含一个名为`form`（基于`GET`）的表单，用于缩小 ListView 的列表结果和第二个表单`status_form`（基于`POST`）。

两种形式都是必需的，因为 ListView 返回项目列表。`Form`让用户限制选择并`status_forms`让用户通过模式表单标记不正确的项目（因此它需要在同一个模板中）。

我的麻烦是`ListView`该方法没有附带`post`，但是`FormView`有。我的类`List`继承自两个类，但是当我执行该类时，我收到错误消息：

> **属性错误：“列表”对象没有属性“status_form”**

**我应该如何更改我的实现以允许通过`post method`?**

```
class List(PaginationMixin, ListView, FormMixin):
    model = ListModel
    context_object_name = 'list_objects'
    template_name = 'pages/list.html'
    paginate_by = 10 #how may items per page

    def get(self, request, *args, **kwargs):
        self.form = ListSearchForm(self.request.GET or None,)
        return super(List, self).get(request, *args, **kwargs)

    def post(self, request, *args, **kwargs):
        self.status_form = StatusForm(self.request.POST or None)
        if self.status_form.is_valid():
            ...
        else:
            return super(List, self).post(request, *args, **kwargs)

    def get_queryset(self):
        # define the queryset
        ...
        # when done, pass to object_list
        return object_list

    def get_context_data(self, **kwargs):
        context = super(List, self).get_context_data(**kwargs)
        context.update(**kwargs)
        context['form'] = self.form
        context['status_form'] = self.status_form # Django is complaining that status_form is not existing, result since the post method is not executed
        return context 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T18:49:07.847

```
# Django is complaining that status_form does not exist,
# result since the post method is not executed
context['status_form'] = self.status_form 
```

因为你一开始没有定义`self.status_from`。您已经在 中定义了它`get_context_data`，并且可以从那里访问它。

`get_context_data`您可以从您的 post 方法中访问您的对象；

```
context = self.get_context_data(**kwargs)
status_form = context['status_form'] 
```

还要考虑您可以`status_form`直接在方法本身中定义您的方法，而无需从or中`post`获取它。`self``get_context_data`

重新设计您的视图以将每个表单处理分开在单独的视图中，然后将它们彼此紧密。

视图重新设计：

简而言之，让每个视图做一项工作。您可以创建一个仅用于处理您的视图并将其`status_form`命名为`StatusFormProcessView`然后在您的`List`视图中返回它的`post`方法

```
class List(ListView);
    def post(self, request, *args, **kwargs):
        return StatusFormView.as_view()(request) # What ever you need be pass to you form processing view 
```

这只是一个例子，需要更多的工作才能成为现实。

再举一个例子；在我的网站索引页面上，我有一个搜索表单。当用户`POST`或`GET`搜索表单时，我的搜索处理不存在`IndexView`，而是我在单独的视图中处理整个表单的东西，如果表单应该处理`GET`方法，我将覆盖`get()`方法，如果表单应该处理`POST`，我' ll override`post()`方法将`search_form`数据发送到负责处理处理的视图`search_form`。

### 评论回复

`status_form = context['status_form']`

不应该

```
context['status_form'] = status_form 
```

在我创建它之后？

你想从中得到`status_form`，`context`所以你需要

```
status_form = context['status_form'] 
```

无论如何，您的表单数据可在`self.request.POST`

# sql - Django用过滤器左外连接

> ID：15622356
> 
> 赞同：14
> 
> 时间：2013-03-25T18:43:06.753
> 
> 标签：sql, django, join

我正在使用 Django 的内置用户模型，并有一个自定义 Foo 对象，其中包含一个外键到用户。我正在寻找适合某些约束的所有 User 对象和所有 Foo 对象，如下所示：

```
SELECT * from auth_user LEFT OUTER JOIN "foo" ON
(auth_user.id = foo.id AND <other criteria here>) 
```

我应该如何在 Django 中做到这一点？到目前为止，我已经尝试过：

```
User.objects.filter(foo__<criteria>) 
```

但这会生成与此类似的 SQL：

```
SELECT * from auth_user LEFT OUTER JOIN "foo" ON
(auth_user.id = foo.id) WHERE <other criteria here> 
```

并且只返回具有符合条件的 Foo 对象的 User 对象。或者，我可以选择所有用户对象并为每个对象运行一个查询，但这会大大降低效率。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2018-01-19T02:21:15.293

要获得一个`LEFT OUTER JOIN`，你可以去：

```
User.objects.select_related('foo').filter(Q(foo__isnull=True) | Q(<other criteria here>)) 
```

Django 使用`foo__isnull=True`来指导它生成一个`LEFT OUTER JOIN`. 如果没有 filter 参数，Giving `foo__isnull=False`to 会生成一个。`INNER JOIN`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-09-22T14:25:03.397

Django 2.0 引入了[`FilteredRelation`objects](https://docs.djangoproject.com/en/3.1/ref/models/querysets/#filteredrelation-objects)，它可以产生几乎与`LEFT OUTER JOIN`您提到的查询完全相同的代码，类似于：

```
User.objects.annotate(
    filtered_foo=FilteredRelation('foo', condition=Q(foo_<criteria>))
).values(...) # e.g. 'user__id', 'filtered_foo__id' 
```

但是，您似乎需要通过指定 in或附加注释来明确要求`filtered_foo`您要使用的字段。`values`或者，您还可以聚合`filtered_foo`按用户分组的字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T20:46:25.900

如果您希望 Django 获取所有`User`对象以及`Foo`与用户对象相关的所有对象，那么您将使用[`select_related()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.select_related)：

```
User.objects.all().select_related('foo') 
```

但是在这里您不想要与用户对象相关的*所有*`Foo`对象，您只想要满足您的标准的它们的子集。我不知道如何告诉 Django 在单个查询集中执行此操作。但是您*可以*做的是分别进行两个选择并在 Python 中进行连接：

```
# Map from user id to corresponding Foo satisfying <criteria>, if any.
foos = {foo.user_id: foo for foo in 
        Foo.objects.filter(user__isnull = False, <criteria>)}
for user in User.objects.all():
    foo = foos.get(user.id)
    # ... 
```

（这不会比你做更多的数据库工作或传输更多的数据`LEFT OUTER JOIN`，所以我认为这是一种合理的方法。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-04T21:09:19.797

虽然有很好的答案可以满足一个人的需求，但最好的做法是

```
from django.db.models import Prefetch

User.objects.all().prefetch_related(Prefetch(<related_name>, queryset=Foo.objects.filter(<criteria>))) 
```

<related_name> = 'foo' 如果：

```
class Foo(models.Model):
    user = models.ForeignKey(User, related_name='foo') 
```

这将返回与具有给定过滤条件的用户相关的所有用户和 foo 对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-15T13:46:12.500

它很笨重，但应该这样做：

```
User.objects.raw('SELECT auth_user.* from auth_user LEFT OUTER JOIN '
                 '"foo" ON (auth_user.id = foo.id AND '
                 '<other criteria here>)') 
```

您可以通过将返回的用户对象添加到选择的左侧来在返回的用户对象上添加额外的属性。

# java - Java：值类型为 ArrayList 时的映射列表

> ID：15622360
> 
> 赞同：0
> 
> 时间：2013-03-25T18:43:35.680
> 
> 标签：java, list, map, arraylist

我正在开发一个 java 项目，我想创建一个映射列表，其中键的类型是字符，值是字符的 ArrayLists。我写了这样的东西：

`List<Map<Character, ArrayList<Character>>>`

但日食说：`Syntax error on token ">>>", VariableDeclarator expected after this token`

我该怎么做 ？任何想法 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T18:45:22.217

编译器期望变量名符合 Java 语法：

```
List<Map<Character, List<Character>>> myList = 
                              new ArrayList<Map<Character, List<Character>>>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:49:40.490

`List<Map<Character, ArrayList<Character>>> list ;`应给予

看下面的屏幕截图

![在此处输入图像描述](../Images/39fe9a8fa6708ad530a35af525088547.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:50:11.380

您可以将变量声明为接口（例如`List`），但要创建实例，您必须选择一个实现（例如`ArrayList`）：

`List<Map<Character, ArrayList<Character>>> myList = new ArrayList<Map<Character, ArrayList<Character>>>();`

# elasticsearch - 使用 elasticsearch 仅搜索特定字段

> ID：15622364
> 
> 赞同：1
> 
> 时间：2013-03-25T18:43:52.133
> 
> 标签：elasticsearch, elastica

我如何告诉 Elasticsearch 在按术语搜索时排除某个字段？

我有一个用户索引（姓名、电子邮件、认证、经验、办公室...），但只有某些人可以通过认证搜索用户。在我当前的 PHP Lucene 实现中，我有 2 个单独的索引，其中包含和不包含该数据。有没有办法只用一个用户索引来做到这一点？我假设我需要应用某种过滤器[[1]](http://www.elasticsearch.org/guide/reference/query-dsl/filtered-query.html) [[2]](http://elastica.io/en/search-documents#section-filter)，但没有看到可以让我完全忽略一个字段的过滤器。

如果有任何专门使用[Elastica（PHP 客户端）](https://github.com/ruflin/Elastica)的方法会更有帮助，但原生 ES 也同样有帮助。

假设我的索引中有 2 个用户

凯文史密斯松饼制作认证

Mark Smith 获得了摩托车跳跃认证。

当普通用户搜索motorcycle时，不应返回任何内容，但如果他们搜索Smith，则应返回两者。

具有搜索认证字段能力的用户在搜索摩托车时将返回 Mark，如果搜索 Smith，则两者都返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T08:37:20.507

我没有测试任何东西，但似乎您可以在映射阶段将“include_in_all”设置为 false。这意味着您的字段不会包含在“_all”中。然后你只需要对“_all”字段进行查询。注意该字段仍然可以搜索和索引，您可以通过在字段查询中指定它来进行查询；它只是从“_all”参数中排除。

同样，我还没有测试任何东西。

# java - java中方法的良好实践

> ID：15622365
> 
> 赞同：3
> 
> 时间：2013-03-25T18:43:58.947
> 
> 标签：java

我有一个从数据库读取并在那里获取一些字符串的方法。根据我得到的信息，我将为另一个我已经知道的字符串覆盖该字符串。例如：

*   `str`→`string`
*   `bin`→`binary`
*   等等..

我的问题是，这样做的最佳做法是什么？当然，我已经考虑过如果...

```
if (str.equals("str"))
    str = "string"; 
```

一个预先定义了这些东西的文件，一个多维数组等。但这一切似乎都是一个新手，所以你有什么推荐的？什么是最好的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T18:47:02.833

使用地图：

```
// create a map that maps abbreviated strings to their replacement text
Map<String, String> abbreviationMap = new HashMap<String, String>();

// populate the map with some values
abbreviationMap.put("str", "string");
abbreviationMap.put("bin", "binary");
abbreviationMap.put("txt", "text");

// get a string from the database and replace it with the value from the map
String fromDB = // get string from database
String fullText = abbreviationMap.get(fromDB); 
```

您可以[在此处阅读有关地图的更多信息](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:47:45.497

您可以使用地图，例如：

```
Map<String, String> map = new HashMap<String, String>();
map.put("str", "string");
map.put("bin", "binary");

// ...

String input = ...;
String output = map.get(input); // this could be null, if it doesn't exist in the map 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:55:09.730

正如人们所建议的那样，地图是一个不错的选择。在这种情况下，我通常考虑的另一个选项是 Enum。它为您提供了为组合添加行为的额外功能。

# javascript - jquery切换功能打开/关闭

> ID：15622367
> 
> 赞同：1
> 
> 时间：2013-03-25T18:44:02.930
> 
> 标签：javascript, jquery

尝试执行一个功能，在切换打开时执行“A”，在切换关闭时执行“B”。

代码：

```
function awesome_toggle()
{
    $(".button").click(function()
    {
        $("content").toggle(
            function()
            {
                /* Do "A" */
            },
            function()
            {
                /* Do "B" */
            }
        );
    });
} 
```

这段代码似乎不起作用，我不知道为什么。当我只使用一个函数时，所以我在 /* Do "A" */ 之后停止代码它可以工作，但是当我添加 /* Do "B" */ 函数时它停止工作。怎么了？

jquery 版本：ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T18:51:44.667

正如评论所说，此版本`toggle`已被弃用。

可能有更好的方法来完成您想要的，但是您*可以*在使用选择器切换后检查元素是否可见[`:visible`](http://api.jquery.com/visible-selector/)，并根据它有条件地做一些事情。

```
function awesome_toggle()
{
    $(".button").click(function() {
        $("content").toggle(normalSpeed, function () {
            if ($("content").is(':visible')) {
                /* Do "A" */
            } else {
                /* Do "B" */
            }
        });
    });
} 
```

# spring - Spring事务管理+活动MQ+数据源

> ID：15622368
> 
> 赞同：0
> 
> 时间：2013-03-25T18:44:04.727
> 
> 标签：spring, tomcat, spring-transactions

这是流程：

1.  开始交易。
2.  消息已放入队列但尚未准备好出列。（现在我不知道如何实现它）
3.  (i)结束事务 - 成功：消息可以出列。
4.  (ii) 回滚：消息将从队列中删除。
5.  消息由侦听器成功出列。

我可以为休眠实体配置 Spring Transaction Manager。以同样的方式，我可以将 Active MQ 用于`JMSTransactionManager`. 但最大的问题是
JMSTransactionManager 将如何知道状态`HibernateTransactionManager`？这两者将如何互动？

```
Note: I am using Tomcat managed datasources for Hibernate entities. Apache Camel support is also available in project. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:50:21.763

您需要一个支持 XA 的事务管理器，而 Spring 没有。因此，要么将您的应用程序部署在 Java EE 应用程序服务器中，要么嵌入像 Bitronix 这样的独立事务管理器。

# javascript - 无法在页面加载时将标题更改为随机颜色

> ID：15622369
> 
> 赞同：1
> 
> 时间：2013-03-25T18:44:09.077
> 
> 标签：javascript, jquery, jquery-plugins

当页面加载时，会生成随机颜色并将其应用于“TEST COLOUR”文本和 RSS 提要的标题。

[http://jsfiddle.net/chrisloughnane/nqkH4/](http://jsfiddle.net/chrisloughnane/nqkH4/)

问题是 RSS 提要标题的颜色没有改变。

我设置了一个事件，单击“测试颜色”，标题颜色会改变，所以我认为它与动态添加的元素有关。

我看过 .on() 但没有设法让它工作。

有人可以发布更改页面加载时标题颜色所需的代码吗？

蒂亚

jQuery 插件是 FeedEk：http: [//jquery-plugins.net/FeedEk/FeedEk.html](http://jquery-plugins.net/FeedEk/FeedEk.html)

代码

```
$(document).ready(function(){

    $('#divRss').FeedEk({
      FeedUrl : 'http://rss.cnn.com/rss/edition.rss'
    });

    var r = Math.floor(Math.random()*256);
    var g = Math.floor(Math.random()*256);
    var b = Math.floor(Math.random()*256);

    $('#example, .itemTitle a').css("color", getHex(r,g,b));

    $('#example').click(function() {

        $('.itemTitle a').css("color", getHex(r,g,b));

    });

    function intToHex(n){
        n = n.toString(16);
        if( n.length < 2) 
            n = "0"+n; 
        return n;
    }

    function getHex(r, g, b){
        return '#'+intToHex(r)+intToHex(g)+intToHex(b); 
    }

}); 
```

HTML

```
<div id="example">TEST COLOUR</div>
<div id="divRss"></div> 
```

CSS

```
.feedEkList{width:450px; list-style:none outside none;background-color:#FFFFFF; border:1px solid #D3CAD7; padding:4px 6px; color:#3E3E3E;}
.feedEkList li{border-bottom:1px solid #D3CAD7; padding:5px;}
.feedEkList li:last-child{border-bottom:none;}
.itemTitle a{font-weight:bold; color:#4EBAFF; text-decoration:none }
.itemTitle a:hover{ text-decoration:underline }
.itemDate{font-size:11px;color:#AAAAAA;}

#example { font-weight: bold; cursor: pointer;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:58:30.400

**-编辑-**

在回应以下评论时，这`timeout`是不可靠的。我扩展了包含的库以允许回调函数。默认值为`alert('done')`，但它可以作为参数传入以执行您想要的任何操作。

> 更新小提琴：http: [//jsfiddle.net/nqkH4/8/](http://jsfiddle.net/nqkH4/8/)

或者，如下所述，您可以轮询目标 div 的内容以查看其内容是否发生变化，当发生变化时，您就知道调用已完成。

~~我认为问题在于内容访问 DOM 和尝试设置样式的脚本存在*轻微延迟。*它已经让它与一个小的`timeout`.~~

```
 setTimeout(function () {
    var r = Math.floor(Math.random() * 256);
    var g = Math.floor(Math.random() * 256);
    var b = Math.floor(Math.random() * 256);
    var color = getHex(r, g, b);

    $('#example, .itemTitle a').css("color", color);

}, 50); 
```

> 更新小提琴：http: [//jsfiddle.net/nqkH4/6/](http://jsfiddle.net/nqkH4/6/)

# c# - C#中的实例类->静态类->实例类

> ID：15622373
> 
> 赞同：0
> 
> 时间：2013-03-25T18:44:27.993
> 
> 标签：c#, static, instance

我已经阅读了大量关于实例与静态类的内容，但还没有找到我的问题的答案。在实例类引用的静态类中实例化不同的类有什么危险吗？

我正在使用的当前设计是实例类调用静态“记录器”方法（传递一系列参数）以将错误记录到文件系统中的文本文件的设计。我正在重构静态“Logger”方法来实例化一个参数类（这只是一系列属性和一些帮助方法以将自身作为 XML 或字符串返回）和一个 DBLogger 类来将错误记录到数据库而不是文件系统，将参数类作为唯一参数传递。

这个模型在我的旧 VB6 代码中运行良好，其中 Logger 类是实例化的，而不是静态的。

但是现在在 .NET 代码中，我不确定是否应该将我的 2 个新类（参数和 DBLogger）设为静态，或者只是将 DBLogger 设为静态并实例化参数类。我担心从静态类创建（或不）实例时可能出现并发/多线程数据问题。我应该担心还是什么都不担心？

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;

// all code truncated for illustration purposes

namespace ThisIs.A.Test
{
    //INSTANCE
    public class ErrorLogParameters
    {
        private int mThreadId = 0;
        private int mErrorNumber = 0;
        private string mServerDate = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss.fff");

        public int ThreadId
        {
            get { return mThreadId; }
            set { mThreadId = value; }
        }
        public int ErrorNumber
        {
            get { return mErrorNumber; }
            set { mErrorNumber = value; }
        }
        public string ServerDate
        {
            get { return mServerDate; }
        }
    }

    //INSTANCE
    public class ErrorLog
    {
        public void LogErrorToDatabase(ErrorLogParameters criteria)
        {
            //Log error to database here
        }
    }

    //STATIC - Instantiates INSTANCE of ErrorLogParameters and ErrorLog
    public class Logger
    {
        public static void WriteLog(string pstrObjectName, string pstrProcedureName, int plngErrNumber, string pstrErrDescription)
        {
            // create a new parameter object
            ErrorLogParameters objParameters = new ErrorLogParameters();

            // populate object properties
            objParameters.ErrorNumber = mlngErrNumber;
            objParameters.ThreadId = System.Threading.Thread.CurrentThread.ManagedThreadId;

            ErrorLog objErrorLog = new ErrorLog();

            objErrorLog.LogErrorToDatabase(objParameters);
        }
    }

    //INSTANCE - Invokes STATIC method
    public class SomeInstance 
    {
        private void ErrorHandler_Log(Exception exception, string procedureName, string additonalDescription, string stackTrace)
        {
            // call from instance class to static class
            Logger.WriteLog(mstrObjectName, procedureName, mlngErrNumber, mstrErrDescription);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:48:19.013

不，这绝对没问题 - 如果您在方法中创建任何类的实例，那么声明该方法的类是否是静态类都没有关系。

此外，除非你有一些“特殊”的东西（例如，一个统计创建的实例数量的静态变量），否则在创建*新*对象时遇到并发问题的可能性比使用*现有*对象时要小。基本上，几乎所有并发的棘手部分是找出可变数据在哪里共享 -*听起来*你在这里没有任何东西（尽管示例代码有助于澄清这一点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T01:40:37.070

静态方法没有并发问题。

静态变量是另一回事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:38:31.820

我会为此使用提供者和单例模式的组合。

创建一个名为 Logger 的抽象类。

1.  Logger 类包含用于写入日志的抽象方法。例如：
    *   抽象无效LogInfo（LogInfo信息）；
    *   抽象无效LogError（异常异常）；
    *   ETC
2.  Logger 类包含 Logger 对象的私有实例。
3.  Logger 类包含一个返回私有实例的静态属性。
4.  Logger 类包含一个静态构造函数，用于实例化 Logger 对象的私有实例。您可能会使用反射并根据配置实例化对象。
5.  实现一个继承自 Logger 对象的 FileLogger。此记录器写入文件。
6.  实现一个继承自 Logger 对象的 SQLLogger。此记录器写入数据库。

像这样调用记录器：

*   Logger.Instance.WriteInfo(info);
*   Logger.Instance.WriteError（异常）；

使用这种设计有几个优点：

1.  您的日志记录功能是完全抽象的。这将日志调用者与写入日志的代码完全分离。这允许您将日志写入任何数据存储。
2.  您可以在不编译代码的情况下更改要使用的记录器。只需更新配置文件。
3.  单例保证线程安全
4.  可测试性。您可以针对抽象类编写 Mock 测试。

希望这可以帮助。

# sql-server - 两个排序的子查询为一个结果

> ID：15622377
> 
> 赞同：1
> 
> 时间：2013-03-25T18:44:43.743
> 
> 标签：sql-server, database, sql-server-2008, tsql

所以我有两个子查询从同一个表中返回相同的列

查询 #1：

```
SELECT E.Id,E.Title,E.LocationId,P.LocationId,E.DepartmentId,P.DepartmentId,E.DateCreated,E.IsActive,E.IsHotJob,E.RequisitionId,E.RequisitionIdString,E.RewardSettingId,E.EmploymentOpportunityStatusId 
FROM EmploymentOpportunities E, Profiles P
WHERE E.EmploymentOpportunityStatusId = 9 AND E.IsActive = 1 AND E.IsHotjob = 1  
     AND P.Id = 'C5F07EBB-CE81-4133-A462-241A5F84D418' AND (P.DepartmentId != E.DepartmentId AND P.LocationId != E.LocationId)
ORDER BY E.DateCreated DESC 
```

查询 #2：

```
SELECT E.Id,E.Title,E.LocationId,P.LocationId,E.DepartmentId,P.DepartmentId,E.DateCreated,E.IsActive,E.IsHotJob,E.RequisitionId,E.RequisitionIdString,E.RewardSettingId,E.EmploymentOpportunityStatusId 
FROM EmploymentOpportunities E, Profiles P
WHERE E.EmploymentOpportunityStatusId = 9 AND E.IsActive = 1 AND E.IsHotjob = 0 AND 
      P.Id = 'C5F07EBB-CE81-4133-A462-241A5F84D418' AND (P.DepartmentId = E.DepartmentId OR P.LocationId = E.LocationId)
ORDER BY E.DateCreated DESC 
```

我希望这两个查询合并为一个，但保留它们的顺序，因此以某种方式将查询 #1 堆叠到查询 #2 上。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:48:52.843

```
SELECT 1 SetNumber, E.Id,E.Title,E.LocationId,P.LocationId,E.DepartmentId,
  P.DepartmentId,E.DateCreated,E.IsActive,E.IsHotJob,E.RequisitionId,
  E.RequisitionIdString,E.RewardSettingId,E.EmploymentOpportunityStatusId
FROM EmploymentOpportunities E, Profiles P
WHERE E.EmploymentOpportunityStatusId = 9 AND E.IsActive = 1 
  AND E.IsHotjob = 1 P.Id = 'C5F07EBB-CE81-4133-A462-241A5F84D418' 
  AND (P.DepartmentId != E.DepartmentId AND P.LocationId != E.LocationId)

union all

SELECT 2, E.Id,E.Title,E.LocationId,P.LocationId,E.DepartmentId,P.DepartmentId,
  E.DateCreated,E.IsActive,E.IsHotJob,E.RequisitionId,E.RequisitionIdString,
  E.RewardSettingId,E.EmploymentOpportunityStatusId
FROM EmploymentOpportunities E, Profiles P
WHERE E.EmploymentOpportunityStatusId = 9 AND E.IsActive = 1 
  AND E.IsHotjob = 0 AND P.Id = 'C5F07EBB-CE81-4133-A462-241A5F84D418' 
  AND (P.DepartmentId = E.DepartmentId OR P.LocationId = E.LocationId)

ORDER BY SetNumber, DateCreated desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:50:06.277

只需使用`UNION ALL`

```
SELECT * FROM
(
    Your Query1

    UNION ALL      // do not use order by here

    Your Query2 
) AS someName
ORDER BY yourColumn DESC 
```

您也可以使用`UNION`- 但它会过滤掉重复项（如果有）。

# css - 不需要的滚动条

> ID：15622386
> 
> 赞同：4
> 
> 时间：2013-03-25T18:45:14.813
> 
> 标签：css, scroll, scrollbar, margin

这是我第二次遇到不必要的滚动条，我第一次通过添加来修复它`body{margin:0;}`；但是，我不知道这次发生了什么。有任何想法吗？

HTML：

```
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="Style-Sheets/style.css" />
        <!--[if IE]><link rel="stylesheet" type="text/css" href="Style-Sheets/ie.css" /><![endif]-->
        <!--[if !IE 7]><link rel="stylesheet" type="text/css" href="Style-Sheets/!ie7.css" /><![endif]-->
        <!--[if OPERA]><link rel="stylesheet" type="text/css" href="Style-Sheets/opera.css" /><![endif]-->
        <link rel="icon" href="Favicons/favicon.jpg" />
        <!--<base target="_blank" />-->
        <title>Home</title>
    </head>
    <body>
        <div id="wrap">
            <div id="header">
                <p class="title">Title</p>
                <p class="nav-down"><span class="verticle-bar">|</span>&nbsp<a class="navigation" href="index.html">Home</a>&nbsp<span class="verticle-bar">|</span>&nbsp<a class="navigation" href="about.html">About</a>&nbsp<span class="verticle-bar">|</span>&nbsp<a class="navigation" href="blah/index.html">blah</a>&nbsp<span class="verticle-bar">|</span>&nbsp<a class="navigation" href="blah2.html">blah2</a>&nbsp<span class="verticle-bar">|</span></p>
            </div>
            <div id="body">
            </div>
        </div>
        <div id="footer">
            <div class="footer">
                <span class="verticle-bar">|</span>&nbsp
                <a class="footer-link" href="">About The Developer</a>&nbsp
                <span class="verticle-bar">|</span>
            </div>
        </div>
    </body>
</html> 
```

CSS：（来自 style.css，它是（或应该是）唯一影响页面的样式表）

```
html {
height:100%;
margin:0;
padding:0;
background-color:#FFFFFF;
text-align:center;
font-family:arial;
line-height:1.5;/*test*/
color:black;
}

body {
margin:0;
height:100%;    
}

p {
margin:0;
padding:0;
}

#wrap {
min-height:100%;
}

#header {
z-index:2;
position:fixed;
top:0;
left:0;
right:0;
height:4.25em;
background-color:#6D8CE7;
font-family:gabriola;
line-height:1em;
letter-spacing:0.2em;
}

.title {
font-size:3em;
line-height:1.0em;
color:white;
}

#body {
margin-left:5em;
margin-right:5em;
padding-top:4.25em;
overflow:auto;
padding-bottom:4em; /* must be same height as footer */
}

#footer {
position:relative;
margin-top:-4em; /* negative value of footer height */
height:4em;
clear:both;
}

.footer {
position:absolute;
left:0;
right:0;
bottom:0;
}

.verticle-bar {
color:black;
font-family:gabriola;
}

a.navigation:link {
text-decoration:none;
color:black;
}

a.navigation:visited {
text-decoration:none;
color:black;
}

a.navigation:hover {
text-decoration:underline;
color:black;
}

a.navigation:active {
text-decoration:underline;
color:black;
}

.footer-link {
font-family:gabriola;
}

a.footer-link:link {
text-decoration:none;
color:#CC5500;
}

a.footer-link:visited {
text-decoration:none;
color:#CC5500;
}

a.footer-link:hover {
text-decoration:underline;
color:#CC5500;
}

a.footer-link:active {
text-decoration:underline;
color:#CC5500;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T18:51:11.057

一个快速的解决方法是`overflow: hidden`为您的`#footer`.

`#body`注意：如果您的内容流出视口，滚动条仍会出现。

[小提琴](http://jsfiddle.net/AaronBlenkush/6dRLr/)

```
#footer {
    overflow:hidden;
    position:relative;
    margin-top:-4em;
    /* negative value of footer height */
    height:4em;
    clear:both;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-08T12:38:26.387

在 html 标记中使用 overflow:hidden 属性作为

```
html
{
  overflow: hidden;
} 
```

它将删除不必要的滚动条。

默认情况下，如果是 html 标记，此属性是自动的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-27T18:52:40.603

根据您要隐藏滚动条的方向

1.  横向

    html{溢出-x：隐藏；}

2.  垂直

    html{溢出-y：隐藏；}

注意：

溢出：隐藏；=> 水平和垂直，所以要小心，知道你真正想要什么。

# data-structures - 在 Haxe 中是 array.push() O(1) 吗？

> ID：15622387
> 
> 赞同：1
> 
> 时间：2013-03-25T18:45:15.893
> 
> 标签：data-structures, arraylist, haxe

许多语言都有一个标准类型，可以在需要时自行调整大小，例如 C++`vector<T>`或 C# `ArrayList<T>`。然而，在 Haxe 中，我没有看到这样的数据结构。

在 Haxe 中是否`Array`以这种方式工作？它可以添加/删除（摊销）O（1）中的最后一个元素吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T13:49:13.710

从技术上讲，这当然取决于特定于平台的实现`Array`，但可以安全地假设`push`已经摊销了 O(1)，因为这很容易实现（neko 实现很好地表明了这一点）。

在所有带有支持稀疏性的动态大小数组的平台上，Haxe 都使用那些用于实现的平台（AFAIK，即 flash、js 和 php），但我想如果那些指标显示不佳，它们将被重新实现。

我会注意到还有`List`，如果随机访问不重要的话。但在某些平台上，它永远不会比 快`Array`，只会更小。

# c# - 使用 XMLElement 进行 XML 序列化

> ID：15622388
> 
> 赞同：3
> 
> 时间：2013-03-25T18:45:21.250
> 
> 标签：c#, xml

我有一个已定义的类，其中包含以下数据

```
public partial class EHRNodesTesting {
   private string fieldID;
   private bool fieldRights;
   private string fieldName;

   [System.Xml.Serialization.XmlAttribute]
   public string FieldID
   {
      get { return this.fieldID; }
      set { this.fieldID = value; }
   }
   [System.Xml.Serialization.XmlAttribute]
   public bool FieldRights 
   {
      get { return this.fieldRights; }
      set { this.fieldRights = value; }
   }
   [XmlElement("Value")]
   public string FieldValue
   {
      get { return this.fieldName; }
      set { this.fieldName = value; }
   }
} 
```

然后我使用我得到的一组数据填充它，所以我没有预定义的字段，并且在序列化时结果如下

```
<FieldNode>
   <FieldName FieldID="LastName" FieldRights="true">
      <FieldValue>Harris</FieldValue>
   </FieldName>
   <FieldName FieldID="FirstNameName" FieldRights="true">
      <FieldValue>John</FieldValue>
   </FieldName>
</FieldNode> 
```

现在，有没有一种方法可以让序列化获取 FieldID 的值并用它替换 FieldName 以获得以下内容

```
<FieldNode>
   <LastName FieldID="LastName" FieldRights="true">
      <FieldValue>Harris</FieldValue>
   </LastName >
   <FirstName FieldID="FirstName" FieldRights="true">
      <FieldValue>John</FieldValue>
   </FirstName>
</FieldNode> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:19:40.570

XmlDocument/XDocument 对象无法做到这一点。您是否尝试过通过实施来自定义输出`IXmlSerializable`？我对界面的限制没有经验。

我确实有一个类似 XML 的自定义序列化，我可以在其中更改节点的名称。我相信你也必须这样做。

# android - 从 View.GONE 返回到 View.VISIBLE

> ID：15622391
> 
> 赞同：1
> 
> 时间：2013-03-25T18:45:22.923
> 
> 标签：android, listview

我有一个称为 LinearLayout`my_layout`和一个 listView 称为`my_list`.

首先，我设置`my_layout.setVisibility(View.GONE);`

我只看到列表。如果我点击一个listItem，

清单去`my_list.setVisibility(View.GONE)`

和布局去`myLayout.setVisibility(View.VISIBLE);`。

我的问题是当我按下后退按钮时。我想在 listView 消失时返回我的 listView ，或者如果我可以看到 listView ，以完成我的活动。但不幸的是，当我尝试这样做时，我得到了一个空列表。

这是我的代码：

```
@Override
    public void onBackPressed()
    {
        if( my_list.isShown()==true)
        {
            finish();    
        }
        else
        {
            my_layout.setVisibility(View.GONE);
            my_list.setVisibility(View.VISIBLE);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:03:27.677

改变：

```
if(my_list.isShown()==true) 
```

至：

```
if(my_list.getVisibility()==View.VISIBLE) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:03:42.250

我刚刚找到了解决方案。

问题出在动画中。我改为`android:fillAfter="true"`并且`false`一切正常。

# javascript - 用 window.open 替换 window.showmodaldialog

> ID：15622395
> 
> 赞同：0
> 
> 时间：2013-03-25T18:45:28.737
> 
> 标签：javascript

在许多应用程序中，许多弹出窗口是使用 window.showmodaldialog 实现的，它限制用户在将焦点更改为任何其他应用程序之前完成弹出窗口的工作。我想将实现从模态对话框（window.showmodaldialog）更改为独立窗口（window.open）。你能帮我完成必须遵循的步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:49:41.657

这很简单`window.open([URL], 'width=[some number],height=[some number]');`。

在这种情况下，如果您有任何在打开器窗口中使用的返回值，`window.showmodaldialog`则必须使用`window.opener`.

看看[https://developer.mozilla.org/en-US/docs/DOM/window.open](https://developer.mozilla.org/en-US/docs/DOM/window.open) ~~[http://www.w3schools.com/jsref/met_win_open.asp](http://www.w3schools.com/jsref/met_win_open.asp)~~

# css - 列表编号和列表内容的不同字体

> ID：15622397
> 
> 赞同：4
> 
> 时间：2013-03-25T18:45:40.737
> 
> 标签：css

在 CSS 中，我试图设置一个有序列表的样式，以便内容是一种字体，但数字是另一种字体。如何定位列表编号，它们不是 html 元素和列表样式的一部分？

我唯一能想到并尝试过的就是使列表成为无序列表。将列表样式设置为无，然后手动将列表中的数字包含在 's 中，我将它们设置为不同的样式。但这似乎非常低效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:51:52.083

HTML

```
<ol>
    <li><p>Hello</p></li>
    <li><p>World</p></li>
</ol> 
```

CSS：

```
ol{
    font: italic 1em Georgia, Times, serif;
}

ol p{
    font: normal .8em Arial, Helvetica, sans-serif;
} 
```

上面示例的[JSFiddle](http://jsfiddle.net/pLPUb/)

# php - 将 AJAX 搜索过滤器添加到结果中 - PHP/MySQL

> ID：15622406
> 
> 赞同：0
> 
> 时间：2013-03-25T18:46:06.270
> 
> 标签：php, mysql, search

我正在尝试创建一个显示数据库中所有数据的页面，但我希望能够通过搜索框实时过滤数据，消除与查询不匹配的行，几乎与 DataTables 完全一样。但是，我不能使用 DataTables，因为我发现很难添加我拥有的自定义列。我知道如何制作一个搜索页面，然后显示结果，但不知道如何在结果中搜索。

任何帮助，将不胜感激。谢谢。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
        <title>View Records</title>
</head>
<body>

<?php

        // connect to the database
        include('connect-db.php');

        // get results from database
        $result = mysql_query("SELECT * FROM Orders") 
                or die(mysql_error());      

        // display data in table        
        echo "<table border='1' cellpadding='10'>";
        echo "<tr> <th>Date</th> <th>Name</th> <th>Phone</th> <th>Location</th> <th></th> <th></th></tr>";

        while($row = mysql_fetch_array( $result )) {
     $src = '';
     switch( $row['Location'] ) {
          case '1':
              $src = '1.jpg';
              break;
          case '2':
              $src = '2.jpg';
              break;
          default:
              $src = 'default.jpg';

            }      // echo out the contents of each row into a table
                echo "<tr>";
                echo '<td>' . $row['date'] . '</td>';
                echo '<td>' . $row['Name'] . '</td>';
                echo '<td>' . $row['Phone'] . '</td>';
                echo '<td><img src="'.$src.'"></td>';
                echo '<td><a href="edit.php?id=' . $row['id'] . '">Edit</a></td>';
                echo '<td><a href="delete.php?id=' . $row['id'] . '">Delete</a></td>';
                echo "</tr>"; 
        } 

        // close table>
        echo "</table>";

?>
<p><a href="new.php">Add a new record</a></p>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:01:51.787

[使用 jQuery 进行客户端表搜索](https://stackoverflow.com/a/9127872/309483)

# c - 如何在C中链接多个实现文件

> ID：15622409
> 
> 赞同：14
> 
> 时间：2013-03-25T18:46:16.867
> 
> 标签：c, compilation, header, implementation

我有很多`.c`文件，即实现文件说

*   主程序
*   交流电
*   公元前

任何文件中的函数都可以调用不同文件中的任何函数。我的问题是，我是否需要`.h`为 A 和 B 的每个实现提供一个 ie 头文件，其中每个头文件都定义了 A 或 B 中的**所有**函数。

另外， main.c 将同时包含`A.h`和`B.h #included`吗？

如果有人终于可以说清楚，我以后如何在终端中编译和运行多个文件。

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-25T18:51:43.553

### 标题内容

`A.h`的标头`A.c`应仅包含使用 中定义的设施的外部代码所必需的信息`A.c`。它不应该声明静态函数；它不应该声明静态变量；它不应声明内部类型（仅在 中使用的类型`A.c`）。它应该确保一个文件可以使用`#include "A.h"`，然后充分利用`A.c`. 它应该是独立的、幂等的（因此您可以包含它两次而不会出现任何编译错误）并且最小化。您可以简单地检查标题是自包含的，`#include "A.h"`方法是`#include`在`A.c`; 您可以通过两次包含它来检查它是否是幂等的（但最好作为单独的测试完成）。如果它不编译，它就不是自包含的。同样对于`B.h`和`B.c`。

有关标头和标准的更多信息，请参阅“[我应该`#include`在标头中使用吗？](https://stackoverflow.com/questions/1804486/should-i-use-include-in-headers/1804719#1804719)'，它引用了 NASA 编码标准，以及 ' [Linking against a static library](https://stackoverflow.com/questions/4507896/linking-against-a-static-library/4514024#4514024)`chkhdr` '，其中包括我用来测试自包含性和幂等性的脚本。

### 链接

请注意，`main.o`取决于`main.c`,`A.h`和`B.h`, 但`main.c`它本身不依赖于标头。

在编译方面，您可以使用：

```
gcc -o program main.c A.c B.c 
```

如果您需要其他选项，请添加它们（开头的大多数标志；最后的库，在源代码之后）。您还可以将每个文件分别编译为目标代码，然后将目标文件链接在一起：

```
gcc -c main.c
gcc -c A.c
gcc -c B.c
gcc -o program main.o A.o B.o 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T18:51:05.963

`.c`仅当一个文件中声明的内容在另一个文件中需要时，您必须提供一个头`.c`文件。

一般来说，您可以为每个源文件都有一个头文件，您可以在其中导出所有声明的函数或`extern`符号。

在实践中，您并不总是需要导出每个函数或每个变量，只需要导出另一个源文件所需的那个，您只需将其包含在所需文件中（并且在与特定头文件配对的源中）。

当试图理解它是如何工作的时，想想每个源文件都是独立编译的，所以如果它要使用没有在源文件中直接声明的东西，那么它必须通过头文件来声明。通过这种方式，编译器可以知道一切都存在并且类型正确。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-25T18:52:19.607

这取决于编译器，但假设您使用的是 gcc，您可以使用如下内容：

```
gcc -Wall main.c A.c B.c -o myoutput 
```

查看[http://www.network-theory.co.uk/docs/gccintro/gccintro_11.html](http://www.network-theory.co.uk/docs/gccintro/gccintro_11.html)（第一个谷歌答案）了解更多详情。您可以将其编译成多个目标文件/库：

```
gcc -c main.c
gcc -c A.c
gcc -c B.c
gcc -o mybin main.o A.o B.o 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-14T05:21:52.063

你想用

```
gcc -g *.c -lm 
```

它节省了输入，并允许您链接项目中的所有 c 文件。

# jquery - 打开和关闭 Google 地图图层

> ID：15622411
> 
> 赞同：0
> 
> 时间：2013-03-25T18:46:28.270
> 
> 标签：jquery, google-maps, google-maps-api-3

我正在构建一个自定义谷歌地图（[http://www.southdevonaonb.org.uk/cordialemapping/](http://www.southdevonaonb.org.uk/cordialemapping/)），我在打开和关闭图层时遇到问题。

我在 html 中使用了一个简单的复选框 - 例如：

```
Parish boundary line <input type="checkbox" id="layer100" onclick="toggleLayer(100)"  checked><br /> 
Letterbox locations and results <input type="checkbox" id="layer0" onclick="toggleLayer(0)" checked><br />
Landscape challenges <input type="checkbox" id="layer1" onclick="toggleLayer(1)" checked><br /> 
```

和以下 JavaScript：

```
var geocoder;
var map; 
var marker;
var layers = [];

function initialize() {
geocoder = new google.maps.Geocoder ();
var latlng = new google.maps.LatLng (50.31697, -3.670807);
var myOptions = {
  zoom: 10,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
    }
  map = new google.maps.Map(document.getElementById("map-container"),
    myOptions);
  marker = new google.maps.Marker({map:map});

  layers[100] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/100.kml', {preserveViewport: true});
  layers[200] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/200.kml', {preserveViewport: true});
  layers[300] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/boundaryline.kml', {preserveViewport: true});

  layers[0] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/beta0.kml', {preserveViewport: true});
  layers[1] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/beta1.kml', {preserveViewport: true});
  layers[2] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/beta2.kml', {preserveViewport: true});
  layers[10] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/beta10.kml', {preserveViewport: true});
  layers[11] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/beta11.kml', {preserveViewport: true});
  layers[46] = new google.maps.KmlLayer('http://www.southdevonaonb.org.uk/cordialemapping/kmzdata/holbeton.kml', {preserveViewport: true});
  for (var i = 1; i < layers.length; i++) {
    layers[i].setMap(map);
  }
    }
function codeAddress () {
    var address = document.getElementById ("address").value;
    geocoder.geocode ( { 'address': address}, function(results, status)  {
    if (status == google.maps.GeocoderStatus.OK)  {
        map.setCenter(results [1].geometry.location);
        marker.setPosition(results [1].geometry.location);
        map.setZoom(14);
        } 
    else {
        alert("Geocode was not successful for the following reason: " + status);
            }
}); 
}

function toggleLayer(i) {
  if(layers[i].getMap() === null) {
    layers[i].setMap(map);
  }
  else {
    layers[i].setMap(null);
  }
}
  google.maps.event.addDomListener(window, 'load', initialize); 
```

您将从脚本中看到，我还没有在上面链接的页面的列表中添加所有图层，并且我已经使用 jQuery Accordian 插件在选项卡中设置了菜单样式。

到目前为止，我添加的图层可以打开和关闭，但我遇到的问题是，当页面加载时，有时会显示一个图层，而其他时候它会被隐藏，并且需要在它之前勾选该复选框几次会出现。

我正在尝试找到解决此问题的解决方案，以便地图页面首先加载未选中的复选框并隐藏图层。然后当一个复选框被勾选时，该层将打开，然后在取消勾选复选框时再次关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T21:24:52.063

设置 myOptions 变量后，您缺少一个分号。

我正在用你的代码发现更多问题来更新它。

您将地图设置为图层的 for 循环不正确。layers 数组的长度为 301，但这是因为您在索引 300 处手动设置了一个项目。当包含值的数组索引之间存在间隙时，您不能盲目地迭代 layers 数组。如果你真的想做一个 for 循环，那么你需要像这样安全检查你的索引

```
for (var i = 1; i < layers.length; i++) {
    if (typeof layers[i] != 'undefined') {
        layers[i].setMap(map);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T22:49:55.527

虽然我没有找到这方面的文档，但根据我的经验，Google Maps API 不会一次在地图上显示超过 5 个 KML 图层（这类似于对 FusionTablesLayers 的限制，在[此处](https://developers.google.com/maps/documentation/javascript/layers#FusionTablesLimits)记录）。

如果您不希望您的图层在加载时显示，请不要`setMap`在您的`initialize`函数中调用它们。然后，只有已“检查”（并在`toggleLayer`函数中添加到地图中）的图层才会显示在地图上。

您应该添加一个注释，说明向地图添加超过 5 个图层将不起作用，或者您可以添加代码来跟踪最近添加的 5 个图层，并且在添加第 6 个图层时将删除第一个（最近添加的）图层。

```
var addedlayers = [];
function toggleLayer(i) {
    if (layer.getMap() === null) {
        addedlayers.push(i);
        if(addedlayers.length > 5) {
            var ejected = addedlayers.shift();
            layers[ejected].setMap(null);
            document.getElementById("layer" + ejected).checked = false;
        }
        layers[i].setMap(map);
    } else {
        layers[i].setMap(null);
        addedlayers.splice(addedlayers.indexOf(i)) //remove from addedlayers
    }
} 
```

# java - 在没有星期六，星期日和公众假期的情况下计算java中的工作日

> ID：15622413
> 
> 赞同：6
> 
> 时间：2013-03-25T18:46:43.337
> 
> 标签：java

我在 oracle 中有一张表，我在其中保存了墨西哥的十二个公共日，我需要计算你注册后的限制日

```
public Date calcularFechaLimite() {
    try {
        DiaFestivoDTO dia = new DiaFestivoDTO();

        // Calendar fechaActual = Calendar.getInstance();
        Calendar fechaL = Calendar.getInstance();
        fechaL.add(Calendar.DATE, 3);

        switch (fechaL.get(Calendar.DAY_OF_WEEK)) {
        case Calendar.SATURDAY:
            fechaL.add(Calendar.DATE, 2);
            break;
        case Calendar.SUNDAY:
            fechaL.add(Calendar.DATE, 2);
            break;
        case Calendar.MONDAY:
            fechaL.add(Calendar.DATE, 2);
            break;
        case Calendar.TUESDAY:
            fechaL.add(Calendar.DATE, 1);
        default:
            break;
        }
        dia.setFechaLimite(fechaL.getTime());
        Integer numeroDiasFest = seleccionPagoBO.obtenerDiasFestivos(dia);
        if (numeroDiasFest != 0) {
            fechaL.add(Calendar.DATE, numeroDiasFest);
            dia.setFechaLimite(fechaL.getTime());
        }

        fechaLimite = fechaL.getTime();
    } catch (Exception e) {
        e.printStackTrace();
    }

    return fechaLimite;

} 
```

这就是我所拥有的，但 3 月 28 日和 29 日是公共日，它不起作用，知道吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T22:36:31.133

几个问题：

您没有检查您跳过的前 3 天是否包含周末。

此外，您正在跳过奇怪的天数并跳过工作日（这是工作日，因此不应跳过）。

我假设方法 DiaFestivoDTO.obtenerDiasFestivos() 计算特定日期范围内的国定假日数，但开始日期是什么？创建 DiaFestivoDTO 时是否将其初始化为当前日期？

当您的日期范围内有国定假日时，您会增加日期范围，但从不检查这个新的日期范围是否包括新的国定假日或周末。

如果您要做的是计算“从现在起 3 个工作日”的日期，这大致是我会做的：

```
// get all the holidays as java.util.Date
DiaFestivoDTO dia = new DiaFestivoDTO();
List<Date> holidays = dia.getAllNationalHolidays();

// get the current date without the hours, minutes, seconds and millis
Calendar cal = Calendar.getInstance();
cal.set(Calendar.HOUR_OF_DAY, 0);
cal.set(Calendar.MINUTE, 0);
cal.set(Calendar.SECOND, 0);
cal.set(Calendar.MILLISECOND, 0);

// iterate over the dates from now and check if each day is a business day
int businessDayCounter = 0
while (businessDayCounter < 3) {
    int dayOfWeek = cal.get(Calendar.DAY_OF_WEEK);
    if (dayOfWeek != Calendar.SATURDAY && dayOfWeek != Calendar.SUNDAY && !holidays.contains(cal.getTime())) {
        businessDayCounter++;
    }
    cal.add(Calendar.DAY_OF_YEAR, 1);
}
Date threeBusinessDaysFromNow = cal.getTime(); 
```

为此，我建议您添加一个新方法“getAllNationalHolidays”来列出所有假期，因为将十二个日期存储在内存中比多次访问数据库来检查它们更有效。

如果您无法更改/添加数据库方法，那么您可以这样做

```
while (businessDayCounter < 3) {

    // determine if this day is a holiday
    DiaFestivoDTO dia = new DiaFestivoDTO();
    dia.setFechaInitial(cal.getTime());
    dia.setFechaLimite(cal.getTime());
    boolean isHoliday = seleccionPagoBO.obtenerDiasFestivos(dia) > 0;

    int dayOfWeek = cal.get(Calendar.DAY_OF_WEEK);
    if (dayOfWeek != Calendar.SATURDAY && dayOfWeek != Calendar.SUNDAY && !isHoliday) {
        businessDayCounter++;
    }
    cal.add(Calendar.DAY_OF_YEAR, 1);
} 
```

在这里，我假设您可以使用“setFechaInitial”或类似的东西在 DiaFestivoDTO 中设置“开始”日期。但是通过这种方式，您将至少调用数据库 3 次，这是低效的。

# ruby - activerecord-jdbc-adapter 在运行时需要 ActiveRecord 错误

> ID：15622420
> 
> 赞同：1
> 
> 时间：2013-03-25T18:47:13.913
> 
> 标签：ruby, activerecord, rubygems, jruby

所以我刚刚将 JRUBY 更新到 1.7.3 [1.9] 并为 1.9 版的 ruby​​ 进行了全新的 gem 安装。

以下是我的 activerecord gem 的版本：

```
activerecord (1.6.0)
activerecord-jdbc-adapter (1.2.9)
ActiveRecord-JDBC (0.5)
activesupport (3.2.13) 
```

当我尝试执行数据库语句时，出现以下错误

```
activerecord-jdbc-adapter requires ActiveRecord at runtime
no such file to load -- active_record/version (LoadError) 
```

有谁知道发生了什么？我已通过使用`jgem list`这些 gem 已全部安装来验证

Gemfile.lock

```
GEM
  remote: http://rubygems.org/
  specs:
    ActiveRecord-JDBC (0.5)
    Ascii85 (1.0.2)
    activerecord (1.6.0)
    activerecord-jdbc-adapter (1.2.9)
    activesupport (3.2.13)
      i18n (= 0.6.1)
      multi_json (~> 1.0)
    afm (0.2.0)
    akami (1.2.0)
      gyoku (>= 0.4.0)
      nokogiri (>= 1.4.0)
    bouncy-castle-java (1.5.0147)
    builder (3.2.0)
    business_time (0.6.1)
      activesupport (>= 3.1.0)
      tzinfo (~> 0.3.31)
    childprocess (0.3.9)
      ffi (~> 1.0, >= 1.0.11)
    cucumber (1.2.3)
      builder (>= 2.1.2)
      diff-lcs (>= 1.1.3)
      gherkin (~> 2.11.6)
      multi_json (~> 1.3)
    cuke_sniffer (0.0.3)
      roxml
    data_magic (0.14)
      faker (>= 1.1.2)
      yml_reader (>= 0.2)
    diff-lcs (1.2.1)
    faker (1.1.2)
      i18n (~> 0.5)
    ffi (1.6.0)
    gherkin (2.11.6-java)
      json (>= 1.7.6)
    gyoku (1.0.0)
      builder (>= 2.1.2)
    hashery (2.1.0)
    httpi (2.0.2)
      rack
    i18n (0.6.1)
    jruby-openssl (0.8.7)
      bouncy-castle-java (>= 1.5.0147)
    jruby-win32ole (0.8.5)
    json (1.7.7-java)
    mime-types (1.21)
    multi_json (1.7.2)
    nokogiri (1.5.9-java)
    nori (2.0.4)
    page-object (0.8.6.1)
      page_navigation (>= 0.7)
      selenium-webdriver (>= 2.31.0)
      watir-webdriver (>= 0.6.2)
    page_navigation (0.7)
      data_magic (>= 0.14)
    pdf-reader (1.3.2)
      Ascii85 (~> 1.0.0)
      afm (~> 0.2.0)
      hashery (~> 2.0)
      ruby-rc4
      ttfunk
    rack (1.5.2)
    rake (10.0.4)
    rautomation (0.8.0)
      ffi
    rest-client (1.6.7)
      mime-types (>= 1.16)
    roxml (3.3.1)
      activesupport (>= 2.3.0)
      nokogiri (>= 1.3.3)
    rspec (2.13.0)
      rspec-core (~> 2.13.0)
      rspec-expectations (~> 2.13.0)
      rspec-mocks (~> 2.13.0)
    rspec-core (2.13.1)
    rspec-expectations (2.13.0)
      diff-lcs (>= 1.1.3, < 2.0)
    rspec-mocks (2.13.0)
    ruby-debug-ide (0.4.16)
      rake (>= 0.8.1)
    ruby-ole (1.2.11.6)
    ruby-rc4 (0.1.5)
    rubyzip (0.9.9)
    savon (2.1.0)
      akami (~> 1.2.0)
      builder (>= 2.1.2)
      gyoku (~> 1.0.0)
      httpi (~> 2.0.2)
      nokogiri (>= 1.4.0)
      nori (~> 2.0.3)
      wasabi (~> 3.0.0)
    selenium-webdriver (2.31.0)
      childprocess (>= 0.2.5)
      multi_json (~> 1.0)
      rubyzip
      websocket (~> 1.0.4)
    sources (0.0.1)
    spreadsheet (0.8.3)
      ruby-ole (>= 1.0)
    ttfunk (1.0.3)
    tzinfo (0.3.37)
    wasabi (3.0.0)
      httpi (~> 2.0)
      nokogiri (>= 1.4.0)
    watir-webdriver (0.6.2)
      selenium-webdriver (>= 2.18.0)
    websocket (1.0.7)
    xpath (1.0.0)
      nokogiri (~> 1.3)
    yml_reader (0.2)

PLATFORMS
  java

DEPENDENCIES
  ActiveRecord-JDBC
  activerecord
  activerecord-jdbc-adapter
  builder
  business_time
  childprocess
  cucumber
  cuke_sniffer
  ffi
  gherkin
  jruby-openssl
  jruby-win32ole
  json
  mime-types
  nokogiri
  page-object
  pdf-reader
  rake
  rautomation
  rest-client
  rspec
  ruby-debug-ide
  rubyzip
  savon
  selenium-webdriver
  sources
  spreadsheet
  watir-webdriver
  xpath 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:56:53.690

第一个问题是您的要求声明，

您的第二个问题是使用 1.6.0，据报道它会引发此错误。解决方案是从 Gemfile.lock 中删除 AR 1.6.0 并安装更新的版本。

在您的 Gemfile 中添加：

```
gem "activerecord", "~> 3.2.13" 
```

然后在修复您的 Gemfile.lock 后重新运行捆绑程序

# python - 从整数区间生成所有特定长度的递增序列

> ID：15622421
> 
> 赞同：3
> 
> 时间：2013-03-25T18:47:17.287
> 
> 标签：python, function, numpy, sequence

我想从整数间隔生成特定长度的所有可能序列。(np.arange(start,end)) 如果它只是一组特定长度的子多集，我可以选择： [https](https://stackoverflow.com/a/4941846/257640) ://stackoverflow.com/a/4941846/257640 我不确定它是否会成为最有效率的。

所以“subseq”函数将是这样的：

```
subseq(np.arange(1,4),2) 
```

应该返回：

```
[[1,1],
[1,2],
[1,3],
[2,2],
[2,3],
[3,3]] 
```

谢谢你。

# python - 有条件地加载模块 Python

> ID：15622427
> 
> 赞同：2
> 
> 时间：2013-03-25T18:47:35.590
> 
> 标签：python, python-2.7

我写了一个主要的 python 模块，需要加载一个文件解析器才能工作，最初我是一个只有一个文本解析器模块，但我需要为不同的情况添加更多的解析器。
parser_class1.py
parser_class2.py
parser_class3.py

每个正在运行的实例只需要一个，然后我想通过命令行加载它：

```
mmain.py -p parser_class1 
```

出于这个目的，我编写了这段代码，以便在调用主模块时选择要加载的解析器：

```
#!/usr/bin/env python

import argparse
aparser = argparse.ArgumentParser()
aparser.add_argument('-p',
            action='store',
            dest='module',
            help='-p module to import')
results = aparser.parse_args()

if not results.module:
    aparser.error('Error! no module')
try:
    exec("import %s" %(results.module))
    print '%s imported done!'%(results.module)
except ImportError, e:
    print e 
```

但是，我读到这种方式很危险，也许没有标准..

那么，这种方法可以吗？或者我必须找到另一种方法来做到这一点？为什么？谢谢，欢迎任何评论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:50:13.520

`import`您实际上可以只在条件块内执行语句：

```
if x:
    import module1a as module1
else:
    import module1b as module1 
```

您可以使用此方法以不同的方式解释各种列入白名单的模块导入，但实际上这个想法是对导入进行预编程，然后基本上使用 GOTO 进行正确的导入...如果您确实只想让用户导入任何任意参数，那么`__import__`函数将是要走的路，而不是`eval`.

**更新：**

正如评论中提到的@thedox，该`as module1`部分是使用不同底层代码加载类似 API 的惯用方式。如果您打算使用完全不同的 API 做完全不同的事情，那不是要遵循的模式。在这种情况下，更合理的模式是在该 import 语句中包含与特定导入相关的代码：

```
if ...:
    import module1
    # do some stuff with module1 ...

else:
    import module2
    # do some stuff with module2 ... 
```

至于*安全性*，如果您允许用户导入一些任意代码集（例如他们自己的模块，也许？），它与`eval`在用户输入上使用并没有太大区别。它本质上是相同的漏洞：用户可以让你的程序执行他们自己的代码。

我认为根本没有一种真正安全的方式可以让用户导入*任意*模块。这里的例外是如果他们无法访问文件系统，因此无法创建要导入的新代码，在这种情况下，您基本上会回到白名单的情况，并且还可以实现显式的白名单以防止将来 -如果/当在未来的某个时候用户确实获得了文件系统访问权限，则存在漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:57:16.003

这是如何使用`__import__()`

```
allowed_modules = ['os', 're', 'your_module', 'parser_class1.py', 'parser_class2.py']

if not results.module:
    aparser.error('Error! no module')
try:
    if results.module in allowed_modules:
        module = __import__(results.module)
        print '%s imported as "module"'%(results.module)
    else:
        print 'hey what are you trying to do?'
except ImportError, e:
    print e

module.your_function(your_data) 
```

**`EVAL`对比`__IMPORT__()`**

using`eval`允许用户在您的计算机上运行任何代码。不要那样做。`__import__()`只允许用户加载模块，显然不允许用户运行任意代码。但这显然更安全。

建议的功能`allowed_modules`仍然存在风险，因为它可以允许加载任意模型，该模型在加载时可能会运行一些恶意代码。攻击者可能会在某处加载文件（共享文件夹、ftp 文件夹、由您的网络服务器管理的上传文件夹......）并使用您的参数调用它。

**白名单**

使用`allowed_modules`可以缓解问题，但不能完全解决问题：要进一步强化，您仍然需要检查攻击者是否将“os.py”、“re.py”、“your_module.py”、“parser_class1.py”写入您的script 文件夹，因为python首先在那里搜索模块（[docs](http://docs.python.org/2/tutorial/modules.html#the-module-search-path)）。

最终，您可以将 parser_class*.py 代码与哈希列表进行比较，就像[sha1sum](http://en.wikipedia.org/wiki/Sha1sum)一样。

**最后**的评论：实际上，如果用户对您的脚本文件夹具有写入权限，则您无法确保代码绝对安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:56:34.423

您应该考虑可能为该解析函数导入的所有可能模块，然后使用 case 语句或字典来加载正确的模块。例如：

```
import parser_class1, parser_class2, parser_class3

parser_map = {
    'class1': parser_class1,
    'class2': parser_class2,
    'class3': parser_class3,
}

if not args.module:
    #report error
    parser = None
else:
    parser = parser_map[args.module]
#perform work with parser 
```

如果在此示例中加载任何 parser_classN 模块的成本很高，您可以定义返回该模块的 lambda 或函数（即`def get_class1(): import parser_class1; return parser_class1`）并将该行更改为`parser = parser_map[args.module]()`

该`exec`选项可能非常危险，因为您正在执行未经验证的用户输入。想象一下，如果您的用户做了类似的事情 -

```
mmain.py -p "parser_class1; some_function_or_code_that_is_malicious()" 
```

# android - 索尼 Tablet S 上的不同行为活动生命周期

> ID：15622428
> 
> 赞同：2
> 
> 时间：2013-03-25T18:47:37.903
> 
> 标签：android, android-activity, sony

我是 Android 上的新开发人员。我有一个在多个 Android 设备上运行的应用程序，但我发现在具有 4.0.3 android 版本的 Sony Tablet S 上的活动生命周期上有一个奇怪的行为。我的应用程序有一个启动 B 活动的 A 活动，问题是当 B 启动时，A 被暂停并销毁，而在其他设备中被暂停并恢复。当我通过返回按钮从 B 活动返回时，必须再次创建 A。

任何想法？我已经搜索了很多关于这个问题，但我没有发现任何类似的问题。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:10:41.153

Activity 是否被销毁由 Android 操作系统决定，不仅取决于您的设备，还取决于当前的内存使用情况。在具有较小内存单元的设备上或者如果有其他应用程序占用内存（也许应用程序不会被破坏，因为它们是索尼修改后的操作系统的一部分），您的活动被更快地破坏的可能性不大。这可能会发生，尤其是如果您的活动 A 使用位图的权重很大...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T23:44:45.600

我观察到与 Sony Xperia Z 相同的问题。我的调用活动（A）有意调用本机相机（使用 startActivityForResult(..)）。我观察到的是 A 被破坏，当使用相机 onActivtyResult(..) 完成时，A 被调用。

我仍在试图弄清楚如何解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T10:59:50.613

我用来创建和显示活动 B 的代码如下：

```
 legendButton.setOnClickListener(new OnClickListener() {
     @Override
     public void onClick(final View v) {
        final Intent intent = new Intent(MainActivity.this, LegendActivity.class);
        intent.putExtra(Constants.LEGEND, _legenditems);
        startActivity(intent);
     }
  }); 
```

# javascript - jQuery .wrapAll() 和 .unwrap() 问题

> ID：15622432
> 
> 赞同：1
> 
> 时间：2013-03-25T18:48:10.530
> 
> 标签：javascript, jquery

该脚本的第一部分包装了一些 div 并添加了一个新类，效果很好。

**HTML**（此链接打开 ColorBox）

```
<a class="group1 cboxElement wrapbox" href="http://localhost/blabla">This is a link</a> 
```

**jQuery：**

```
$(document).ready(function(){

$(".wrapbox").click(function(){
   $('#boxOverlay, #box').wrapAll('<div class="wrapper">');
   $("#boxOverlay").addClass("unwrapbox"); 

  });
}); 
```

但是当我试图撤消一切时，脚本失败了，我不知道为什么：

```
$(document).ready(function(){

$(".unwrapbox").click(function(){
   $('#boxOverlay, #box').unwrap('<div class="wrapper">');
   $("#boxOverlay").removeClass("unwrapbox"); 

  });
}); 
```

**HTML：（**这是我点击“.unwrapbox”后的结果）

```
<div class="wrapbox">
<div id="boxOverlay" class="unwrap" style="display: none; opacity: 1; cursor: auto; visibility:  visible;"></div>
<div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none; visibility: visible; top: 1125px; left: 660px; position: absolute; width: 600px; height: 1242px; opacity: 1; cursor: auto;"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:52:29.877

unwrap 不接受参数。 [http://api.jquery.com/unwrap/](http://api.jquery.com/unwrap/)

```
$(".unwrapbox").click(function(){
 $('#boxOverlay').unwrap();
}); 
```

会做的伎俩。

# javascript - 从多个嵌套函数中获取变量

> ID：15622433
> 
> 赞同：0
> 
> 时间：2013-03-25T18:48:17.073
> 
> 标签：javascript, jquery, variables

我正在尝试从多个嵌套函数中获取变量**（lib） 。**

```
var nme='name',lib;

$('script').each(function(){

    var src=$(this).attr('src');

    if(typeof(src)==='undefined'){src='';}

if(src.indexOf(nme)!==-1){

    $.get($(this).attr('src').match(/\w([^ ]+)spbin/)[0]+'/conf/ptmedia.plist',
        function(c){
            $(c).find('key').each(function(){
                if($(this).html()==='MediaLib'){lib=$(this).next().html();}
            });
        }
    );

}
});

if(lib==='some lib'){DO STUFF} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:49:58.037

您的问题不在于范围，问题是您有一个异步的 AJAX 调用。您应该将 HTML 的更改`.null`放在回调函数中：

```
$.get($(this).attr('src').match(/\w([^ ]+)spbin/)[0]+'/conf/ptmedia.plist',
        function(c){
            $(c).find('key').each(function(){
                if($(this).html()==='MediaLib'){lib=$(this).next().html();}

                $('.null').html(lib);
            });
        }
}); 
```

在 JavaScript 中，IO 通常是*异步*的。这意味着当您进行 AJAX 调用时，它不会立即发生，而是等待从 HTTP 请求返回的值，然后调用*回调*。在您的情况下，这`function(c)`是回调，它会*在 AJAX 调用的值到达*时执行。

因此，实际上您正在将 的`HTML`内容更新为未定义，因为它在更新之前`.null`获得了 的值。`lib`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:34:30.663

我解决了这个问题如下：

```
var nme='name';

    $('script').each(function(){

    var src=$(this).attr('src');

        if(typeof(src)==='undefined'){src='';}

        if(src.indexOf(nme)!==-1){media=$(this).attr('src').match(/\w([^ ]+)spbin/)[0];}

    });

    function ffn(){
    $($.ajax({url:media+'/conf/ptmedia.plist',async:false}).responseText).find('key').each(function(){
        if($(this).html()==='string'){value=$(this).next().html();}
    });

    return value;
    }

    if(ffn()==='some lib'){DO STUFF} 
```

感谢大家的参与和好主意！

# python - 将一个 DataFrame 列的总和除以另一个 DataFrame 列的总和得到 0

> ID：15622436
> 
> 赞同：-1
> 
> 时间：2013-03-25T18:48:38.887
> 
> 标签：python, python-2.7, pandas

我有一个数据框，我想通过它计算百分比；但是，当尝试这样做时，python 会返回 0 或 1。

例如，columns`OIR.a1.d.bull`和`OIR.a1r1.d`是用 1 和 0 填充的数组。

```
>>> data['OIR.a1.d.bull'].sum()
653
>>> data['OIR.a1r1.d'].sum()
320
>>> den = data['OIR.a1.d.bull'].sum()
>>> num = data['OIR.a1r1.d'].sum()
>>> den
653
>>> num
320
>>> num / den
0 
```

我希望看到 - 大致 - 以下。

```
>>> num / den
0.49004594 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:51:31.433

您进行整数除法，因此您的结果将是一个整数，这意味着除法结果的小数部分被截断。要获得浮点数，您必须将其中一个值转换为浮点数。

```
float(num)/den 
```

# maven - 詹金斯：“无法启动 Maven”错误

> ID：15622437
> 
> 赞同：-2
> 
> 时间：2013-03-25T18:48:41.763
> 
> 标签：maven, jenkins, maven-3

我在 Jenkins 中收到以下错误。我正在使用 Maven 3.0.4。在 Linux 从站上运行。任何人有任何解决方案？

错误：无法找到或加载主类 org.jvnet.hudson.maven3.agent.Maven3Main

错误：无法启动 Maven。退出代码 = 1

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-01T15:05:16.823

该解决方案甚至与我看到的错误消息无关。但尽管如此，我还是使用自定义工具插件安装了自定义工具。我从来没有使用过这些工具，只是安装了它们。这给了我上述错误。

# database - 如何缓存 Wordpress DB 使其不查询 MySql？

> ID：15622440
> 
> 赞同：0
> 
> 时间：2013-03-25T18:48:44.663
> 
> 标签：database, wordpress, caching

除了 MySql 数据库，我在所有东西上都有一个无限的主机，它同时连接数量有限。我想知道是否有任何方法可以在服务器/主机中缓存帖子，因此每次访问者加载页面时它都不会从数据库中加载它们。

如果没有大量流量，这不会是一个问题，但是我有很多流量并且这崩溃了他们昨天崩溃了我的数据库。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:53:37.977

使用缓存解决方案。memcache 是最常用的一种。

还有一些可以进行完整的页面缓存 - 树脂和清漆非常受欢迎。

事实上，在[http://wordpress.org/extend/plugins/wordpress-varnish/installation/](http://wordpress.org/extend/plugins/wordpress-varnish/installation/)上有一个清漆插件 fir wordpress 。

# mysql - 循环运行两次？

> ID：15622441
> 
> 赞同：0
> 
> 时间：2013-03-25T18:48:46.143
> 
> 标签：mysql, wordpress, loops, while-loop

为什么这个 while 循环在移动到下一个条目之前会显示内容两次？我有双眼皮！双条目，而不仅仅是单个条目的列表。顺便说一句，我正在使用 Wordpress 的瞬态数据。

输出显示如下： name1 name1 name2 name2 name3 name3

我试图让它像这样呈现：name1 name2 name3

```
<?php

$result = mysql_query("SELECT * FROM wp_options WHERE option_name LIKE '%fparent_name_%' ORDER BY option_id DESC");

while ($row = mysql_fetch_array($result))
{
$op_name =  $row['option_name']; // get the value of the option
$op_time = substr($op_name, -10); // trim the option to the epoch time
$the_name = get_transient('fparent_name_'.$op_time);  // get the name with epoch added

$phptime = new DateTime("@$op_time");  // convert UNIX timestamp to PHP DateTime
echo $the_name." - Submitted: ".$phptime->format('n/j/Y - g:ia'); // print the good stuff
?>
<form name="more" action="" method="post" id="more">
<input type="hidden" value="<?=$op_time;?>" name="timestamp" id="timestamp">
<input type="submit" value="See Details" name="details" id="details">
</form>
<br>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:49:24.230

`mysql_fetch_array()`返回 MySQL 结果的关联数组和基于数字的数组。改为使用[`mysql_fetch_assoc()`](http://www.php.net/manual/en/function.mysql-fetch-assoc.php)。

[请不要`mysql_*`在新代码中使用函数](https://stackoverflow.com/questions/12859942)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[红框](http://uk.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# ios - 使用 uiwebview 将链接加载到自定义的 webview 中

> ID：15622444
> 
> 赞同：0
> 
> 时间：2013-03-25T18:49:01.393
> 
> 标签：ios, uiwebview, uiwebviewdelegate

我正在使用 UIWebView，在我的应用程序的详细视图中，我在 webview 中打开一个 url，并将 webview 嵌入到我的详细视图中（这是一个 uiview）。现在嵌入的 webview 的内容有 web 链接，当点击打开到同一个嵌入的 webview 时，正如预期的那样。

这里我担心的是我想将二级链接（从嵌入式 webview 中单击的链接）打开到另一个自定义 webview 组件中，而不是打开到同一个嵌入式 webview 中。

我尝试实现 UIWebViewDelegate 的以下方法，但我无法达到预期的结果。

```
-(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType; 
```

执行：

```
{
CustomWebView* iWebView = [[CustomWebView alloc] initWithFrame:CGRectMake(0, 0, webView.frame.size.width, webView.frame.size.height)]; //creating custom webview in same frame
    [iWebView loadRequest:request];//loading the request into custom webview
    [webView addSubview:iWebView]; // adding custom webview overlapping the webview
    return NO; //[stop loading the url into the embedded webview]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:52:17.107

您还需要设置自定义 Web 视图委托：

```
iWebView.delegate = self; 
```

然后你应该看到请求将首先通过

```
-(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType; 
```

委托方法。

# java - Java Swing GUI，自定义 JtabbedPane 样式

> ID：15622446
> 
> 赞同：2
> 
> 时间：2013-03-25T18:49:14.513
> 
> 标签：java, css, swing

我是挥杆初学者。我尝试为我的项目创建一个选项卡式窗口作为 GUI 的一部分。但如下所示，用于导航选项卡的按钮显示了某种边框。有没有办法可以删除这些边框？请参阅附图以查看问题。

![在此处输入图像描述](../Images/1b2e7acd5820aecf04067ac449d0f937.png)

GUI的代码如下

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Toolkit;
import javax.swing.*;
import javax.swing.border.EmptyBorder;

public class tst {    
    /**
     * @param args the command line arguments
     */
    public static String  generateHtml(String tabButtonLabel,String style) {
        /*@@Generates HTML for the tab button when the button label is given*/
        String ret = "<html><body style = '"+style+"'>"+tabButtonLabel+"</body></html>";
        return ret;
    }

    public static void main(String[] args) {
        // TODO code application logic here
        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        JFrame frame = new JFrame("tst");
        frame.setVisible(true);
        frame.setSize(screenSize);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        /*Groups tab*/            
        JPanel groups = new JPanel();
        groups.setBackground(Color.gray);            
        /*Settings Tab*/            
        JPanel settings = new JPanel();            
        /*About Tab*/            
        JPanel about = new JPanel();            
        /*Tabbed pane to hold all panels*/
        JTabbedPane tabbedPane = new JTabbedPane();             
        /*Tabbed Pane CSS*/
        String tabButtonCss = "margin:0;width:110px;height:10px;border-radius:3px;padding:10px;background:#fff;text-align:center;border:none;";

        tabbedPane.setVisible(true);
        tabbedPane.add(generateHtml("Groups",tabButtonCss),groups);
        tabbedPane.add("Settings",settings);
        tabbedPane.add("About",about);            
        /*Tab styles*/
        tabbedPane.setBackground(Color.gray);
        tabbedPane.setForeground(Color.white);
        tabbedPane.setBounds(0, 0, 0,0);
        //tabbedPane.setBorder(new EmptyBorder(-10,-20,-10,0));            
        frame.add(tabbedPane);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T23:50:56.717

正如@Smit 所指出的，这完全取决于 CSS。另请注意，Java HTML/CSS 引擎无法识别`#fff`颜色的“3 位”样式快捷方式。要获得白色，我们必须使用`#ffffff`.

![CSS1](../Images/3d07939b98bddecab8d9da0d0bc204e8.png) ![CSS2](../Images/0ede21fe9500fd23a8dc0f65d0b015e9.png) ![CSS3](../Images/d9ae1be967cbb40a25478a03533cf2ed.png)

```
import java.awt.*;
import javax.swing.*;

class ExampleCSS {

    public static void showStyle(String style) {
        JPanel gui = new JPanel(new BorderLayout());

        String html1 = "<html><body style = '"+style+"'>";
        String html2 =  "</body></html>";
        JTabbedPane tp = new JTabbedPane();
        tp.addTab(html1 + "Groups" + html2, new JLabel(style));
        tp.addTab(html1 + "Settings" + html2, new JLabel(style));
        tp.addTab(html1 + "About" + html2, new JLabel(style));

        gui.add(tp);

        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        f.setContentPane(gui);
        f.setMinimumSize(new Dimension(400,100));
        f.pack();
        f.setLocationByPlatform(true);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                String[] css = {
                    "margin:0;background:#ffffff;",
                    "padding:10px;",
                    "width:110px;height:10px;border-radius:3px;"
                        + "text-align:center;border:none;"
                };
                showStyle(css[0]);
                showStyle(css[0]+css[1]);
                showStyle(css[0]+css[1]+css[2]);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        // http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html
        SwingUtilities.invokeLater(r);
    }
} 
```

另请参阅@whiskeyspider 建议重新 @trashgod 解决[BG 颜色](https://stackoverflow.com/a/8752166/418556)。比试图在 HTML 中强制它好得多（*很多）。*

![](../Images/e2dd6b4657b14ba6219ec97ea511d86b.png)

# google-maps - 使用 ID 从 Google Places API 获取位置

> ID：15622447
> 
> 赞同：10
> 
> 时间：2013-03-25T18:49:21.363
> 
> 标签：google-maps, google-maps-api-3, google-places-api

当我知道参考时，我可以使用以下方法从 Google Places API 获取地点详细信息：

[https://maps.googleapis.com/maps/api/place/details/json?reference=CmRYAAAAciqGsTRX1mXRvuXSH2ErwW-jCINE1aLiwP64MCWDN5vkXvXoQGPKldMfmdGyqWSpm7BEYCgDm-iv7Kc2PF7QA7brMAwBbAcqMr5i1f4PwTpaovIZjysCEZTry8Ez30wpEhCNCXpynextCld2EBsDkRKsGhSLayuRyFsex6JA6NPh9dyupoTH3g&sensor=true&key=API_KEY_HERE](https://maps.googleapis.com/maps/api/place/details/json?reference=CmRYAAAAciqGsTRX1mXRvuXSH2ErwW-jCINE1aLiwP64MCWDN5vkXvXoQGPKldMfmdGyqWSpm7BEYCgDm-iv7Kc2PF7QA7brMAwBbAcqMr5i1f4PwTpaovIZjysCEZTry8Ez30wpEhCNCXpynextCld2EBsDkRKsGhSLayuRyFsex6JA6NPh9dyupoTH3g&sensor=true&key=API_KEY_HERE)

但是，我想通过使用 ID 来获取相同的信息。因此，上面查询中的相同位置将类似于：

[https://maps.googleapis.com/maps/api/place/details/json?id=4f89212bf76dde31f092cfc14d7506555d85b5c7&sensor=true&key=API_KEY_HERE](https://maps.googleapis.com/maps/api/place/details/json?id=4f89212bf76dde31f092cfc14d7506555d85b5c7&sensor=true&key=API_KEY_HERE)

这样的事情可能吗？

这将是我正在构建的搜索过滤器的一部分，其中一部分是位置。我的搜索参数被传递到 url，所以我计划对从位置自动完成中选择的位置执行相同的操作。使用 id 比 reference 短得多，因此更适合查询字符串。除非有更好的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-09-30T15:43:46.487

您可以通过 PlaceID 搜索 Place 数据

```
https://maps.googleapis.com/maps/api/place/details/json?placeid=ChIJF7QkuDsDLz4R0rJ4SsxFl9w&key=YOUR_KEY 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-04-27T21:25:38.100

现在可以通过 placeId 获取地点数据：

[https://developers.google.com/maps/documentation/javascript/examples/place-details](https://developers.google.com/maps/documentation/javascript/examples/place-details)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-05T06:43:30.490

It is not possible to get a place details with id, you do need to use the reference. as specifically mentioned in the bottom of this link - [http://goo.gl/KFDbl](http://goo.gl/KFDbl)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-30T16:11:29.360

显然 id 和 reference 无论如何都已弃用。

来自 Google Places Autocomplete Docs（2014 年 8 月）：

"注意：id 和 reference 字段自 2014 年 6 月 24 日起已弃用。它们被新的地点 ID 取代，这是一个唯一标识符，可用于比较地点和检索地点信息。地点 API 当前返回一个place_id 在所有响应中，并在 Place Details 和 Place Delete 请求中接受 placeid。在 2015 年 6 月 24 日之后不久，API 将停止在响应中返回 id 和 reference 字段。一段时间后，API 将不再接受 reference在请求中。我们建议您尽快更新代码以使用新的地点 ID 而不是 id 和引用。"

[https://developers.google.com/places/documentation/autocomplete](https://developers.google.com/places/documentation/autocomplete)

# c# - 从 C# 调用 C++ 方法来计算 CRC

> ID：15622451
> 
> 赞同：0
> 
> 时间：2013-03-25T18:49:28.077
> 
> 标签：c#, c++-cli, class-library, crc

我有一个 C# 服务器需要`CRC (CRC16 – CCITT (xModem))`从一个字节数组中计算一个。问题是我想从 C# 调用 C++ 代码，以提高性能。但我正在努力完成这项任务，因为他们给我提供的 C++ 算法显然与 VC++ 不兼容。

CRC计算功能：

```
const UINT16 crc_table[16] = {
    0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7,
    0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef
};

UINT16 CalculateCrc( UINT8 *data, UINT32 len )
{
    UINT i;
    UINT16 crc = 0;

    while( len-- )
    {
        i = ( crc >> 12 ) ^ ( *data >> 4 );
        crc = crc_table[ i & 0x0F ] ^ ( crc << 4 );
        i = ( crc >> 12 ) ^ ( *data >> 0 );
        crc = crc_table[ i & 0x0F ] ^ ( crc << 4 );
        data++;
    }

    return ( crc & 0xFFFF );
} 
```

其中`*data`是指向 byte[] 的指针，并且`len`是该 byte[] 的长度；

为了能够将此代码“注入”到我的 C# 代码中，我创建了一个`C++ Class Library`，但我不确定它完成后如何使用它。

最后，我的问题是：

*   如何移植提供的算法以使用 VC++？
*   如何使用已编译的类库来实际计算我的 C# 服务器上的代码？
*   这种方法（创建 C++ 代码来计算 CRC）是否具有更好的性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:59:44.267

CLR 中的 Just In Time 编译器非常好。我认为您不会看到使用 C++ 带来的性能提升。事实上，由于额外的开销，它甚至可能更慢。

将您的算法从 C 转换为 C# 应该很容易；只需将数据类型更改为其等价物并在需要时添加强制转换：

```
ushort[] crc_table = {
    0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7,
    0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef
};

ushort CalculateCrc( byte[] data )
{
    int i;
    ushort crc = 0;
    int len = data.Length;

    for (int j = 0; j < len; j++)
    {
        i = ( crc >> 12 ) ^ ( data[j] >> 4 );
        crc = (ushort) (crc_table[ i & 0x0F ] ^ ( crc << 4 ));
        i = ( crc >> 12 ) ^ ( data[j] >> 0 );
        crc = (ushort) (crc_table[ i & 0x0F ] ^ ( crc << 4 ));
    }

    return crc;
} 
```

不过，我还没有测试过。

# delphi - 如何找出特定组件或类使用了多少内存？

> ID：15622455
> 
> 赞同：4
> 
> 时间：2013-03-25T18:49:48.210
> 
> 标签：delphi, memory, components

是否可以检索 delphi 中单个组件使用的内存量？

我正在从互联网上下载简单的字符串，我发现在下载过程结束时内存使用量高达千兆字节，但是当我查看包含我下载的所有内容的保存文件时，文件只有千字节范围，很明显，这些组件发生了一些事情，即使我破坏了它们。

例子：

编辑：

```
procedure TForm1.OnCreate(Sender: TObject);
  var list: TStringList;
begin
  list:=TStringList.Create;
  list.LoadFromFile('10MB_of_Data.txt');
  list.destroy;
end; 
```

我怎么知道作为 TStringList 的“列表”正在使用 10 MB 的内存空间？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T08:54:18.403

我认为比较之前和之后的内存使用情况是解决这个问题的方法，因为没有简单的方法可以查看事后代码块分配了哪些内存......例如，使用上面的字符串列表，类它本身只会占用少量内存，因为它由指向其他分配的指针（即字符串数组）组成，并且它本身是指向实际字符串的指针数组......这是一个相对简单的情况.

无论如何，这可以使用 FastMM 来完成，其功能如下......

```
uses
  FastMM4;

function CheckAllocationBy(const AProc: TProc): NativeUInt;
var
  lOriginalAllocated: NativeUInt;
  lFinalAllocated: NativeUInt;
  lUsage: TMemoryManagerUsageSummary;
begin
  GetMemoryManagerUsageSummary(lUsage);
  lOriginalAllocated := lUsage.AllocatedBytes;
  try
    AProc;
  finally
    GetMemoryManagerUsageSummary(lUsage);
    lFinalAllocated := lUsage.AllocatedBytes;
  end;
  Result := lFinalAllocated - lOriginalAllocated;
end; 
```

并且可以这样使用...

```
lAllocatedBytes := CheckAllocationBy(
  procedure
  begin
    list:=TStringList.Create;
    list.LoadFromFile('10MB_of_Data.txt');
    list.Free;
  end); 
```

这将告诉您您的字符串列表留下了多少（有趣的是，我在第一次重复调用时得到 40 个字节，之后在调用前后查阅使用日志后得到 0 个字节，这是在第一次调用时创建的两个编码类） . 如果您想检查泄漏内存的分配位置，使用 FastMM 也很简单（尽管我同意上述观点，如果它是第 3 方，那不应该是您的问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T21:18:00.283

首先：请耐心等待，这实际上并不能完全回答您的问题，但它太大了，无法在评论中发布。此代码是使用 FPC 编写和编译的，但它可以为您提供一些估计。可能有人知道如何将它移植到德尔福。

```
program project4;

uses
    SysUtils,
    Classes;

var
    p: Pointer;
    sl: TStringList;
var
    a: TFPCHeapStatus;
begin
    a := GetFPCHeapStatus;
    writeln('== 1 ==');
    //writeln(a.MaxHeapSize);
    writeln(a.MaxHeapUsed);
    //writeln(a.CurrHeapSize);
    writeln(a.CurrHeapUsed);
    //writeln(a.CurrHeapFree);

    GetMem(p, 1024);

    a := GetFPCHeapStatus;
    writeln('== 2 ==');
    writeln(a.MaxHeapUsed);
    writeln(a.CurrHeapUsed);

    sl := TStringList.Create;

    a := GetFPCHeapStatus;
    writeln('== 3 ==');
    writeln(a.MaxHeapUsed);
    writeln(a.CurrHeapUsed);

    sl.Add('To beer or not to beer? That is the question!');

    a := GetFPCHeapStatus;
    writeln('== 4 ==');
    writeln(a.MaxHeapUsed);
    writeln(a.CurrHeapUsed);

    Readln;
end. 
```

和输出：

```
== 1 ==
2448
2448
== 2 ==
3488
3488
== 3 ==
3568
3568
== 4 ==
3616
3616 
```

另一个带有大文本文件的测试：

```
sl.LoadFromFile('tolstoy - war and peace.txt');

a := GetFPCHeapStatus;
writeln('== 4 ==');
writeln(a.MaxHeapUsed);
writeln(a.CurrHeapUsed); 
```

输出：

```
== 3 ==
3568
3568
== 4 ==
8837104
4643776 
```

文件大小：3,1 Mb（3 280 005 字节）（ansi 编码）

# r - 如何从图例中删除边框而不从 ggplot2 中的条形图中删除边框

> ID：15622456
> 
> 赞同：2
> 
> 时间：2013-03-25T18:49:49.357
> 
> 标签：r, ggplot2

我有以下情节：

```
library(reshape)
library(ggplot2)
library(gridExtra)
require(ggplot2)

data2<-structure(list(IR = structure(c(4L, 3L, 2L, 1L, 4L, 3L, 2L, 1L
), .Label = c("0.13-0.16", "0.17-0.23", "0.24-0.27", "0.28-1"
), class = "factor"), variable = structure(c(1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L), .Label = c("Real queens", "Simulated individuals"
), class = "factor"), value = c(15L, 11L, 29L, 42L, 0L, 5L, 21L, 
22L), Legend = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L), .Label = c("Real queens", 
"Simulated individuals"), class = "factor")), .Names = c("IR", 
"variable", "value", "Legend"), row.names = c(NA, -8L), class = "data.frame")
p <- ggplot(data2, aes(x =factor(IR), y = value, fill = Legend, width=.15))

data3<-structure(list(IR = structure(c(4L, 3L, 2L, 1L, 4L, 3L, 2L, 1L
), .Label = c("0.13-0.16", "0.17-0.23", "0.24-0.27", "0.28-1"
), class = "factor"), variable = structure(c(1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L), .Label = c("Real queens", "Simulated individuals"
), class = "factor"), value = c(2L, 2L, 6L, 10L, 0L, 1L, 4L, 
4L), Legend = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L), .Label = c("Real queens", 
"Simulated individuals"), class = "factor")), .Names = c("IR", 
"variable", "value", "Legend"), row.names = c(NA, -8L), class = "data.frame")
q<- ggplot(data3, aes(x =factor(IR), y = value, fill = Legend, width=.15))

##the plot##
q + geom_bar(position='dodge', colour='black') + ylab('Frequency') + 
        xlab('IR')+scale_fill_grey() +
        theme(axis.text.x=element_text(colour="black"), 
        axis.text.y=element_text(colour="Black"))+ 
        opts(title='', panel.grid.major = theme_blank(),panel.grid.minor = 
        theme_blank(),panel.border = theme_blank(),panel.background = 
        theme_blank(), axis.ticks.x = theme_blank()) 
```

我想保留黑色边框效果

```
geom_bar(colour='black) 
```

没有在图例中描绘的块上出现奇怪的对角线。有什么方法可以将它们解耦或删除对角线吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:17:21.577

正如 Didzis Elferts 提到的，这里有一个例子[（](http://www.cookbook-r.com/Graphs/Legends_%28ggplot2%29/)最后一个例子）。

诀窍是叠加两个图：第一个图以所需的方式处理图例，第二个图没有图例，但为实际图本身添加了边框。

# java - 如何在 Eclipse 中锁定运行配置？

> ID：15622457
> 
> 赞同：0
> 
> 时间：2013-03-25T18:49:51.887
> 
> 标签：java, eclipse

Eclipse Juno SR2（以及以前的版本）经常破坏我的运行配置。它删除了一些程序参数、更改端口等。

有没有办法锁定运行配置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:05:55.877

在“运行配置”对话框中，转到“常用”选项卡。选择“共享文件”。在那里，您可以将运行配置保存到项目中，甚至将其置于源代码控制之下。这样你就可以确定它是不变的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:07:47.010

查看运行配置的“通用”选项卡，您可以在其中将运行配置直接保存为工作区中的“共享文件”。然后您可以将其设为只读，并像普通文件一样将其置于版本控制之下，并在出现问题时将其恢复。

也就是说，通常 Eclipse 插件一旦您手动更改它们就不会修改现有的运行配置，因此可能还有另一个问题。

# c - C指针异常，请解释

> ID：15622460
> 
> 赞同：6
> 
> 时间：2013-03-25T18:49:55.910
> 
> 标签：c, arrays, pointers, gcc, malloc

我有一个函数，函数的基本思想是改变`a`指向的东西。第一个版本有效，但第二个版本无效。

有人可以帮我理解这里发生了什么吗？

```
// this works
void swap(int **a) {
    int *temp = malloc(sizeof(int) * 3);
    temp[0] = 0;
    temp[1] = 1;
    temp[2] = 2;
    *a = temp;
}

// this does not
void swap(int **a) {
    *a = malloc(sizeof(int) * 3);
    *a[0] = 0;
    *a[1] = 1; // seg fault occurs on this line
    *a[2] = 2;
} 
```

我这样调用函数

```
int main() {
   int b[] = {0,1};
   int *a = b;

   swap(&a);

   return 0;
} 
```

此外，这两个函数不能同时属于同一个文件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T18:52:21.420

的优先级`[]`高于`*`（实际上`[]`在 C 中具有最高优先级）。这意味着你的表达`*(a[0])`不是`(*a)[0]`你想要的。

# javascript - 如何获得 translate3d 的绝对值？

> ID：15622466
> 
> 赞同：1
> 
> 时间：2013-03-25T18:50:15.427
> 
> 标签：javascript, css, translate3d

我将如何将负 translate3d 值转换为正数？

例如：

```
var val = $m('slider').style.webkitTransform;
console.log(val); // this returns a number like: translate3d(-93px, 0, 0); 
```

我将如何将值转换为正数，以便我的输出是：

```
translate3d(93px, 0, 0); // positive 93 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:08:25.823

如果可以的话，最好在 JS 中跟踪你的坐标，但如果这不可能，你需要[从变换矩阵中解析出各个值](https://stackoverflow.com/questions/7982053/get-translate3d-values-of-a-div)......

[**演示**](http://jsfiddle.net/3gBYB/)

如果您使用它获得转换的计算样式（不仅仅是`.style`属性）`getComputedStyle`，它将返回一个矩阵：

```
// adapted from jQuery solution at https://stackoverflow.com/questions/7982053/get-translate3d-values-of-a-div
function getTransform(el) {
    var transform = window.getComputedStyle(el, null).getPropertyValue('-webkit-transform');
    var results = transform.match(/matrix(?:(3d)\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))(?:, (-{0,1}\d+)), -{0,1}\d+\)|\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))\))/);

    if(!results) return [0, 0, 0];
    if(results[1] == '3d') return results.slice(2,5);

    results.push(0);
    return results.slice(5, 8); // returns the [X,Y,Z,1] values
}

var translation = getTransform( $m('slider') );
var translationX = translation[0];
var absX = Math.abs(translationX); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-17T17:51:41.933

亚当的答案有一个错误：它不能处理这样的十进制值：

```
matrix(1, 0, 0, 1, 100.000002649095, 100.000002649095) 
```

改编正则表达式以允许它：

```
function getTransform(el) {
    var transform = window.getComputedStyle(el, null).getPropertyValue('-webkit-transform');
    var results = transform.match(/matrix(?:(3d)\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}\d+))(?:, (-{0,1}\d+))(?:, (-{0,1}\d+)), -{0,1}\d+\)|\(-{0,1}\d+(?:, -{0,1}\d+)*(?:, (-{0,1}.+))(?:, (-{0,1}.+))\))/);

    if(!results) return [0, 0, 0];
    if(results[1] == '3d') return results.slice(2,5);

    results.push(0);
    return results.slice(5, 8); // returns the [X,Y,Z,1] values
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:08:17.820

这是一个示例，说明如何使用 分隔所有值`split`，使用解析整数值`parseInt`，然后使用获取绝对值`abs()`

工作小提琴：http: [//jsfiddle.net/bXgCP/](http://jsfiddle.net/bXgCP/)

```
var mystr = "93px, 0, 10";

var myarr = mystr.split(",");
var finalStr = '';

for (var i=0;i<myarr.length;i++)
{ 

    myarr[i] = Math.abs(parseInt(myarr[i]),10);
}

finalStr = myarr.join(); // put the values back with the `,` format 
```

# sql - SQL Rolling Total 到某个日期

> ID：15622474
> 
> 赞同：1
> 
> 时间：2013-03-25T18:50:39.990
> 
> 标签：sql, sql-server-2008

我有两张正在使用的桌子。我们称他们为“客户”和“积分”。

积分表如下所示：

```
Account Year M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12
123     2011  10   0   0   0  10   0  10   0   0   0   0  10
123     2012   0   0   0   0  10   0   0  10  10  10  10  20
123     2013   5   0   0   0   0   0   0   0   0   0   0   0 
```

但是这些点在滚动的 12 个月内有效。计算当前客户的积分很简单，但挑战在于不再活跃的客户。假设客户 123 在 2013 年 1 月变得不活跃，我们只想计算 2013 年 2 月至 2013 年 1 月。这就是另一个表Customers出现的地方，让我们简化并说它看起来像这样：

```
Account   End Date
123       20130105 
```

现在，我要做的是创建一个查询来计算每个客户拥有的点数。（当前 12 个月适用于活跃客户，过去 12 个月适用于不再活跃的客户。）

这里有一些更多信息：

*   我正在运行 SQL Server 2008。
*   这些表是这样提供给我的，我无法修改它们。
*   活跃客户是结束日期为 99991231（9999 年 12 月 31 日）的客户
*   积分表仅填充客户是活跃客户的年份。Aka，某人在 2009 年 2 月成为活跃客户，他们有 2009 年的条目，如果他们在 2009 年 7 月变得不活跃，他们的积分仅计算 2009 年 2 月至 7 月，2008 年没有行，因为他们不是客户那时。2009 年 1 月和 8 月至 12 月将显示 0。
*   此外，仅当客户当年获得任何积分时才会创建记录。如果客户在一年内获得 0 分，则不会有任何记录。
*   对于边境案件，如果您进入一个月的第一天，则该月被计算在内。例如，假设今天是 2013 年 4 月 1 日，这意味着我们总结了 May'12-April'13。

这是一个相当复杂的问题。如果有什么我可以更好地解释的，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:44:06.647

不幸的是，您的表结构`points`将不得不*取消透视*数据。unpivot将数据从多列中提取到行中*。*一旦数据在行中，加入、过滤数据和合计每个帐户的积分就会容易得多。取消透视数据的代码将与此类似：

```
select account,
  cast(cast(year as varchar(4))+'-'+replace(month_col, 'M', '')+'-01' as date) full_date,
  pts
from points
unpivot
(
  pts
  for month_col in ([M01], [M02], [M03], [M04], [M05], [M06], [M07], [M08], [M09], [M10], [M11], [M12])
) unpiv 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/1dda7/9)。该查询给出类似于以下的结果：

```
| ACCOUNT |  FULL_DATE | PTS |
------------------------------
|     123 | 2011-01-01 |  10 |
|     123 | 2011-02-01 |   0 |
|     123 | 2011-03-01 |   0 |
|     123 | 2011-04-01 |   0 |
|     123 | 2011-05-01 |  10 | 
```

一旦数据采用这种格式，您可以加入`Customers`表格以获取每个 的总分`account`，因此代码将类似于以下内容：

```
select 
  c.account, sum(pts) TotalPoints
from customers c
inner join 
(
  select account,
      cast(cast(year as varchar(4))+'-'+replace(month_col, 'M', '')+'-01' as date) full_date,
    pts
  from points
  unpivot
  (
    pts
    for month_col in ([M01], [M02], [M03], [M04], [M05], [M06], [M07], [M08], [M09], [M10], [M11], [M12])
  ) unpiv
) p
  on c.account = p.account
where 
(
  c.enddate = '9999-12-31'
  and full_date >= dateadd(year, -1, getdate()) 
  and full_date <= getdate()  
)
or
(
  c.enddate <> '9999-12-31'
  and dateadd(year, -1, [enddate]) <= full_date
  and full_date <= [enddate]
)
group by c.account 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/e2431/3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:00:13.497

糟糕的数据结构。首先要做的是取消旋转它。然后你会得到一个以年-月-点为列的表格。

从这里，您可以选择最近的 12 个月。事实上，您甚至不必担心客户何时离开，因为大概从那时起他们就没有收集积分。

下面是一个 SQL 示例：

```
with points as (
    select 123 as account, 2012 as year,
           10 as m01, 0 as m02, 0 as m03, 0 as m04, 10 as m05, 0 as m06,
           10 as m07, 0 as m08, 0 as m09, 0 as m10, 0 as m11, 10 as m12
   ),
   points_ym as (
    select account, YEAR, mon, cast(right(mon, 2) as int) as monnum, points
    from points
    unpivot (points for mon in (m01, m02, m03, m04, m05, m06, m07, m08, m09, m10, m11, m12)
    ) as unpvt
   )
select account, SUM(points)
from points_ym
where year*12+monnum >= year(getdate())*12+MONTH(getdate()) - 12
group by account 
```

# c++ - 为共享指针参数提供默认值

> ID：15622475
> 
> 赞同：2
> 
> 时间：2013-03-25T18:50:41.040
> 
> 标签：c++, shared-ptr

以下代码在支持 shared_ptr 和 make_shared 函数的 VS2010 中给出了编译错误。为什么以及如何纠正它？

```
#include <memory>

class A
{
    A(std::shared_ptr<int> p = std::make_shared<int>())   // error is at this line
    {}
}; 
```

它显示“make_shared”不是“全局命名空间”的成员。

# html - 你怎么能在里面做秀 标签？

> ID：15622485
> 
> 赞同：-1
> 
> 时间：2013-03-25T18:51:12.137
> 
> 标签：html

我目前正在创建一个网页来教别人 HTML。在我的 HTML 文档中，我想创建一个段落，例如“以 html 开头，以 /html 结尾”。html 和 /html 周围应该有 <> 标签，但我不知道该怎么做！（这是我的问题）该文档只留下了 html 和 /html （周围有 <> ）。我如何确保文档留在里面？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:52:31.840

## 使用 HTML 实体

写字符**<**和**>**使用`&lt;`and`&gt;` **这给你：**

```
&lt;html&gt; and &lt;/html&gt; 
```

渲染为：<html> 和 </html>

这称为[HTML 实体](http://www.w3schools.com/html/html_entities.asp)。可以在[此处](http://www.w3schools.com/tags/ref_entities.asp)或在[wikipedia](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)上找到更完整的列表。

> 在 HTML 中，有一组标准的 252 个命名字符实体用于字符 - 一些常见的，一些晦涩的 - 在某些字符编码中找不到或在某些上下文中是标记敏感的（例如尖括号和引号）。尽管任何 Unicode 字符都可以通过其数字代码点来引用，但一些 HTML 文档作者更愿意尽可能使用这些命名实体，因为它们不那么神秘并且更受早期浏览器的支持。字符实体可以通过使用实体引用包含在 HTML 文档中，实体引用采用 &EntityName; 的形式，其中 EntityName 是实体的名称。例如, `&mdash;`, 很像 `&#8212;`或`&#x2014;`, 表示 U+2014：em 短划线字符“—”，即使使用的字符编码不包含该字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T18:52:32.263

使用 amp 代码（[HTML 实体](http://www.w3schools.com/html/html_entities.asp)）！

```
<p>&lt;html&gt;</p> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T18:53:17.063

您可以使用 HTML 实体：`&gt;`for >、`&lt;`for <。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-25T18:54:12.587

如果要显示 HTML 标记，请将所有 < 和 > 替换为`&lt;`and`&lt;`

例子：`&lt;HTML&gt;`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-25T18:52:43.153

使用 < 表示 < 和 > 表示 >

# c# - 向 Word 文档中的现有表添加一行（打开 XML）

> ID：15622489
> 
> 赞同：18
> 
> 时间：2013-03-25T18:51:22.713
> 
> 标签：c#, ms-word, openxml

我需要使用现有表格（例如，3 列）打开现有 Word 文档 (.docx)，并向该表格添加新行。有没有办法做到这一点？我正在使用 Open XML

我正在创建这样的表（第一次）：

```
Table tbl = new Table();

// Set the style and width for the table.
TableProperties tableProp = new TableProperties();
TableStyle tableStyle = new TableStyle() { Val = "TableGrid" };

// Make the table width 100% of the page width.
TableWidth tableWidth = new TableWidth() { Width = "5000", Type = TableWidthUnitValues.Pct };

// Apply
tableProp.Append(tableStyle, tableWidth);
tbl.AppendChild(tableProp);

// Add 3 columns to the table.
TableGrid tg = new TableGrid(new GridColumn(), new GridColumn(), new GridColumn());
tbl.AppendChild(tg);

// Create 1 row to the table.
TableRow tr1 = new TableRow();

// Add a cell to each column in the row.
TableCell tc1 = new TableCell(new Paragraph(new Run(new Text("1"))));
TableCell tc2 = new TableCell(new Paragraph(new Run(new Text("2"))));
TableCell tc3 = new TableCell(new Paragraph(new Run(new Text("3"))));
tr1.Append(tc1, tc2, tc3);

// Add row to the table.
tbl.AppendChild(tr1);
return tbl; 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-25T21:39:00.843

干得好，

```
Body bod = doc.MainDocumentPart.Document.Body;
foreach (Table t in bod.Descendants<Table>())
{
    t.Append(new TableRow(new TableCell(new Paragraph(new Run(new Text("test"))))));
} 
```

使用 LINQ 获取正确的表。

编辑：

假设您想获得有 4 列的表。

```
Body bod = doc.MainDocumentPart.Document.Body;
foreach (Table t in bod.Descendants<Table>().Where(tbl => tbl.GetFirstChild<TableRow>().Descendants<TableCell>().Count() == 4))
{
    t.Append(new TableRow(new TableCell(new Paragraph(new Run(new Text("test"))))));
} 
```

假设您要获取包含单词“mytable”的表。

```
Body bod = doc.MainDocumentPart.Document.Body;
foreach (Table t in bod.Descendants<Table>().Where(tbl => tbl.InnerText.Contains("myTable")))
{
    t.Append(new TableRow(new TableCell(new Paragraph(new Run(new Text("test"))))));
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-27T07:37:16.423

这是一个更详细的示例，您将 5 行添加到现有表中。

这假定表格是文档中的第一个表格。如果没有，你必须找到你的桌子。

代码获取表的最后一行并将其复制。之后，您只需在单元格中填写您的数据。

```
Table myTable = doc.Body.Descendants<Table>().First();
TableRow theRow = myTable.Elements<TableRow>().Last();
for (int i = 0; i < 5; i++)
{
    TableRow rowCopy = (TableRow)theRow.CloneNode(true);

    var runProperties = GetRunPropertyFromTableCell(rowCopy, 0);
    var run = new Run(new Text(i.ToString() + " 1"));
    run.PrependChild<RunProperties>(runProperties);

    rowCopy.Descendants<TableCell>().ElementAt(0).RemoveAllChildren<Paragraph>();//removes that text of the copied cell
    rowCopy.Descendants<TableCell>().ElementAt(0).Append(new Paragraph(run));
    //I only get the the run properties from the first cell in this example, the rest of the cells get the document default style. 
    rowCopy.Descendants<TableCell>().ElementAt(1).RemoveAllChildren<Paragraph>();
    rowCopy.Descendants<TableCell>().ElementAt(1).Append(new Paragraph(new Run(new Text(i.ToString() + " 2"))));
    rowCopy.Descendants<TableCell>().ElementAt(2).RemoveAllChildren<Paragraph>();
    rowCopy.Descendants<TableCell>().ElementAt(2).Append(new Paragraph(new Run(new Text(i.ToString() + " 3"))));

    myTable.AppendChild(rowCopy);
}
myTable.RemoveChild(theRow); //you may want to remove this line. I have it because in my code i always have a empty row last in the table that i copy. 
```

GetRunPropertiesFromTableCell 是我对文本使用与现有行已有的相同格式的快速破解尝试。

```
private static RunProperties GetRunPropertyFromTableCell(TableRow rowCopy, int cellIndex)
{
    var runProperties = new RunProperties();
    var fontname = "Calibri";
    var fontSize = "18";
    try
    {
        fontname =
            rowCopy.Descendants<TableCell>()
               .ElementAt(cellIndex)
               .GetFirstChild<Paragraph>()
               .GetFirstChild<ParagraphProperties>()
               .GetFirstChild<ParagraphMarkRunProperties>()
               .GetFirstChild<RunFonts>()
               .Ascii;
    }
    catch
    {
    //swallow
    }
    try
    {
        fontSize =
               rowCopy.Descendants<TableCell>()
                  .ElementAt(cellIndex)
                  .GetFirstChild<Paragraph>()
                  .GetFirstChild<ParagraphProperties>()
                  .GetFirstChild<ParagraphMarkRunProperties>()
                  .GetFirstChild<FontSize>()
                  .Val;
    }
    catch 
    {
    //swallow
    }
    runProperties.AppendChild(new RunFonts() { Ascii = fontname });
    runProperties.AppendChild(new FontSize() { Val = fontSize });
    return runProperties;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-21T07:46:07.547

这里是从数据集中向现有表添加行

```
 DataTable dt = new DataTable();
    dt.Columns.Add("Gender");
    dt.Columns.Add("Passport");
    dt.Columns.Add("Name");
    foreach (RepeaterItem item in rptemplist.Items)
    {
        TextBox txtGender = (TextBox)item.FindControl("txtGender");
        TextBox txtPassport = (TextBox)item.FindControl("txtPassport");
        TextBox txtName = (TextBox)item.FindControl("txtName");
        dt.Rows.Add(new object[] { txtGender.Text, txtPassport.Text, txtName.Text });
    }

    using (WordprocessingDocument wordDoc2 = WordprocessingDocument.Open(file, true))
    {
        var doc = wordDoc2.MainDocumentPart.Document;
        DocumentFormat.OpenXml.Wordprocessing.Table table = doc.MainDocumentPart.Document.Body.Elements<DocumentFormat.OpenXml.Wordprocessing.Table>().FirstOrDefault();

        int icounterfortableservice;
        for (icounterfortableservice = 0; icounterfortableservice < dt.Rows.Count; icounterfortableservice++)
        {
            DocumentFormat.OpenXml.Wordprocessing.TableRow tr = new DocumentFormat.OpenXml.Wordprocessing.TableRow();
            DocumentFormat.OpenXml.Wordprocessing.TableCell tablecellService1 = new DocumentFormat.OpenXml.Wordprocessing.TableCell(new DocumentFormat.OpenXml.Wordprocessing.Paragraph(new DocumentFormat.OpenXml.Wordprocessing.Run(new DocumentFormat.OpenXml.Wordprocessing.Text(dt.Rows[icounterfortableservice]["Gender"].ToString()))));
            DocumentFormat.OpenXml.Wordprocessing.TableCell tablecellService2 = new DocumentFormat.OpenXml.Wordprocessing.TableCell(new DocumentFormat.OpenXml.Wordprocessing.Paragraph(new DocumentFormat.OpenXml.Wordprocessing.Run(new DocumentFormat.OpenXml.Wordprocessing.Text(dt.Rows[icounterfortableservice]["Passport"].ToString()))));
            DocumentFormat.OpenXml.Wordprocessing.TableCell tablecellService3 = new DocumentFormat.OpenXml.Wordprocessing.TableCell(new DocumentFormat.OpenXml.Wordprocessing.Paragraph(new DocumentFormat.OpenXml.Wordprocessing.Run(new DocumentFormat.OpenXml.Wordprocessing.Text(dt.Rows[icounterfortableservice]["Name"].ToString()))));
            tr.Append(tablecellService1, tablecellService2, tablecellService3);
            table.AppendChild(tr);

        }

    } 
```

# iphone - 我应该将用于在 iOS 中读取设备唯一 ID 的代码放在哪里？

> ID：15622493
> 
> 赞同：2
> 
> 时间：2013-03-25T18:51:38.323
> 
> 标签：iphone, ios, objective-c, performance

我有以下代码用于读取唯一设备 ID。由于这将用于 20 多个不同的视图（.m 文件），我只是在质疑自己是否有一种清洁和有效的方法来做到这一点？所以我只是想出了3个选项：

选项一：只需将这些代码复制/粘贴到我需要执行它们的任何地方。我认为这将是最糟糕的做法。

选项二：将其放入 AppDelegate.m。这只会在每次启动时运行一次（如果我是对的，可能会节省一点时间）。然后只要我需要就调用字符串“stringDeviceID”。

选项三：创建另一个类并将这些代码放入类函数中。但是，这仍然存在每次执行代码的“问题”。

我的问题是我必须选择哪个最好/更好的选择？如果有比这些更好的选择，请告诉我。提前致谢。

```
NSString *stringDeviceID;

if ([UIDevice instancesRespondToSelector:@selector(identifierForVendor)])
{
    stringDeviceID = [[[UIDevice currentDevice] identifierForVendor] UUIDString];
}
else
{
    stringDeviceID = [[UIDevice currentDevice] uniqueIdentifier];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:56:50.617

我会将它实现为 UIDevice 上的一个类别：

```
@iumplementation UIDevice (backwardCompatibleIdentifier)
- (NSString *)backwardCompatibleIdentifier {
    // your code
}
@end 
```

然后，您所要做的就是：

```
NSString *myid = [[UIDevice currentDevice] backwardCompatibleIdentifier]; 
```

我严重怀疑调用这 20 次的性能成本是否会产生任何真正的性能差异。如果您担心，请测试它。如果这*是*一个问题，您可以在实现中粘贴一个缓存。如果调用`currentDevice`太慢，你可以把它变成类方法而不是实例方法。

您的其他选择大多是合理的，除了一个：不要复制和粘贴 20 次。在某些时候，您会想要删除`uniqueIdentifier`呼叫（无论是因为 Apple 强迫您，还是仅仅因为您想放弃 iOS 5 兼容性）。您可能想要添加 OpenUDID 或其他一些第三方库。无论您做什么，您都希望能够在 1 个地方进行更改，而不是在 19 个地方进行更改，然后在 6 个月后调试您忘记的 1 个地方……</p>

# iframe - 是否可以使用谷歌翻译自动翻译 iframe？

> ID：15622495
> 
> 赞同：1
> 
> 时间：2013-03-25T18:51:42.133
> 
> 标签：iframe, translation

当用户访问该页面时，我想在我的网站上自动翻译成法语 iframe：[http ://www.julienlussiez.com/p/boutique.html](http://www.julienlussiez.com/p/boutique.html)

可能吗？

这是代码：

```
<iframe height="525px" scrolling="no" src="http://julienlussiez.bandcamp.com/album/fragile" width="950px"></iframe> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T05:05:28.977

一般来说，我会说只需将 iframe 的 src 设置为：[http ://translate.google.com/translate?hl=fr&sl=auto&tl=fr&u=BLANK](http://translate.google.com/translate?hl=fr&sl=auto&tl=fr&u=BLANK)

其中 BLANK 是网站的 url。

但是，它似乎不适用于您正在查看的网站，因为谷歌认为它已经是法语......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-17T11:03:27.860

（2014 年 10 月：）谷歌翻译不允许翻译 iframe。不过，他们很乐意翻译完整的窗口，然后您的特定案例的 URL 可能类似于：

[http://www.google.com/translate?hl=fr&ie=UTF8&sl=en&tl=fr&u=http%3A%2F%2Fjulienlussiez.bandcamp.com%2Falbum%2Ffragile](http://www.google.com/translate?hl=fr&ie=UTF8&sl=en&tl=fr&u=http%3A%2F%2Fjulienlussiez.bandcamp.com%2Falbum%2Ffragile)

sl 表示源语言，因此 sl=en 是您认为源是英文的声明。tl 表示目标语言，因此 tl=fr 表示您请求法语翻译。我相信 hl 表示人机界面语言，即使用您请求的参数和来自谷歌的评论、按钮等以特定语言显示。（在这种情况下是法语）。

# android - Android磁力计返回随机值

> ID：15622497
> 
> 赞同：2
> 
> 时间：2013-03-25T18:51:43.447
> 
> 标签：android, accelerometer, compass-geolocation, magnetometer

我正在构建一个 Android 应用程序，它将设备的罗盘度数记录到一个文件中。获得这个学位有两种方法：

**方法一：**

```
SensorManager mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
Sensor orientationSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION);
mSensorManager.registerListener(this, orientationSensor, SensorManager.SENSOR_DELAY_NORMAL);

public void onSensorChanged(SensorEvent event) {
    float azimuthInDegrees = event.values[0]
} 
```

**方法二：**

```
SensorManager mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
Sensor accelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
Sensor magnetometer = mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD);
mSensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_NORMAL);
mSensorManager.registerListener(this, magnetometer, SensorManager.SENSOR_DELAY_NORMAL);

float[] mGravity;
float[] mGeomagnetic;

public void onSensorChanged(SensorEvent event) {
    if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER) {
       mGravity = event.values;
    }

    if (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD) {
        mGeomagnetic = event.values;
    }

    if (mGravity != null && mGeomagnetic != null) {
        float R[] = new float[9];
        float I[] = new float[9];
        boolean success = SensorManager.getRotationMatrix(R, I, mGravity, mGeomagnetic);
        if (success) {
            float orientation[] = new float[3];
            SensorManager.getOrientation(R, orientation);   

            float azimuthInDegress = ((float) Math.toDegrees(orientation[0]) + 360) % 360;
        }
    }
} 
```

我通过将我的设备放在北方向（大约 360 度）来尝试这两种方法：

**方法 1**返回完美的结果，但不幸的是，此方法已被弃用：

*   359.6567
*   359.5034
*   359.859
*   359.76212
*   359.8878
*   359.87048
*   359.8356
*   359.80356
*   359.81192
*   359.7671
*   359.84668
*   359.88528

**方法 2**也返回良好的结果，但有时（随机）它返回不正确的度数：

*   359.91495
*   359.83652
*   **263.67697**
*   359.67993
*   359.70038
*   359.688
*   359.71155
*   359.70276
*   359.6984
*   359.6429
*   **270.6323**
*   359.62302
*   359.49954
*   359.44757
*   359.47803
*   359.4947
*   359.39572

如您所见，使用第二种方法会随机返回一些不正确的度数。该设备已校准，我认为问题在于第二种方法，因为第一种方法返回完美的结果。你们能帮帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:30:27.330

问题出在分配上`mGravity`，`mGeomagnetic`而且应该是`event.values.clone()`。mGravity 具有类作用域，但是通过使用 mGravity = event.values，您可以将其值分配给具有方法作用域的地址中的值。因此，一旦再次调用 onSensorChanged 并且它是磁性类型，mGravity 现在指向一个不再存在的变量，因此可以具有任何值。

# jquery - 将数据发送到另一个函数 JQuery

> ID：15622499
> 
> 赞同：0
> 
> 时间：2013-03-25T18:51:46.717
> 
> 标签：jquery, ajax

我正在尝试在我的订单中设置优惠券/促销/折扣代码，但是我无法获取优惠券金额以转到 updatePrices 功能。

```
function updateCoupon() {
var coupon = $('#coupon').val();
if (coupon.length) {
    $('#couponContainer .checking').show();         
    $.ajax({
        url: "/includes/pscript/coupon.php",
        data: {coupon: coupon},
        dataType: 'json',
        type: 'POST',
        success: function(data) {
            if(typeof data.available != 'undefined' && data.available == true) {
                    coupon_discount = new Number(data.price.discount);
                    $('#couponStatus').html('<p>'+data.status+'</p > ');
                    $('#couponContainer .checking').hide();
                    $('#couponStatus').show();
                    updatePrices(coupon_discount);
            }  else {
                    coupon_discount = 0;
                    $('#coupon ').val('');
                    $('#couponContainer .checking').hide();
                    $('#couponStatus ').hide();
                    $('#couponStatus ').html('');
                    alert('Sorry this discount code is no long valid!');
            }
        },
        error: function() {
                coupon_discount = 0;
                $('#coupon ').val('');
                $('#couponContainer .checking').hide();
                $('#couponStatus ').hide();
                $('#couponStatus ').html('');
                alert('Sorry this discount code is no long valid!');
        }
    });
}
else
{
    coupon_discount = 0;
    $('#coupon').val('');
    $('#couponContainer.checking ').hide();
    $('#couponStatus ').hide();
    $('#couponStatus ').html('');
    alert('Sorry this discount code is no long valid!');
}

} 
```

以上确实有效，并且它收到了金额。一旦它有我希望它发送到 updatePrices() 的金额；

```
function updatePrices(a, coupon_discount) {

var item_price = 0;
var delivery_price = 0;
var discounts = 0;
if(coupon_discount != 0){
    var coupon_discount = coupon_discount;
    alert('Coupon '+coupon_discount);
}
var product = $("[name='Product']").val();

...

if(coupon_discount != 0)
    {
        discounts += coupon_discount;
    }

    var total = (item_price + delivery_price - discounts); 
```

}

这只是代码的一部分。我想做的就是，updateCoupon 获取价格将其发送到 updatePrices - 如果说产品已更改，则优惠券将被删除，并且会出现一条消息以重新申请。

当前问题：我在 updatePrices() 中未定义

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:57:50.993

您正在调用`updatePrices(coupon_discount);`并且您的函数定义为`updatePrices(a, coupon_discount)`. 目前，您的价值应该在 a var。a 是干什么用的？

# c++ - 如何使用 STL 为数据点创建最大和最小堆？

> ID：15622500
> 
> 赞同：3
> 
> 时间：2013-03-25T18:51:47.917
> 
> 标签：c++, stl

我正在尝试解决一个导致我为某些数据点创建最大和最小堆的问题。假设我有以下信息：

```
(10,100)
(30,120)
(14,110)
(18,200)
(20,230)
(13,49) 
```

And I want to store these data points in a max and min heap, but I want the heaps made by their second value. However, I still need the first value preserved as I use it later in the program. How can I accomplish this task? What are the most efficient STL methods to always pop the max or always pop the min from a set of data points, while still preserving other, paired data?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T19:01:44.833

这看起来很简单：

```
#include <vector>
#include <algorithm>

int main() {
    std::vector<std::pair<int, int>> values = {
        {10,100},
        {30,120},
        {14,110},
        {18,200},
        {20,230},
        {13,49},
    };

    std::make_heap(values.begin(), values.end(), [](std::pair<int, int> const & lhs, std::pair<int, int> const & rhs) {
            return lhs.second < rhs.second;
            });

    // If you can't use c++11, then this is identical:
    struct {
        bool operator()(std::pair<int, int> lhs, std::pair<int, int> rhs) const {
            return lhs.second < rhs.second;
        }
    } Compare;

    std::make_heap(values.begin(), values.end(), Compare);

    // And if a priority queue works:
    std::priority_queue<std::pair<int, int>, std::vector<std::pair<int, int>>, decltype(Compare)> max_heap;
    max_heap.push(std::make_pair(10,100));
    max_heap.push(std::make_pair(30,120));
    max_heap.push(std::make_pair(14,110));
    max_heap.push(std::make_pair(18,200));
    max_heap.push(std::make_pair(20,230));
    max_heap.push(std::make_pair(13,49));
} 
```

# c# - Windows 8 应用商店应用平滑方向更改

> ID：15622503
> 
> 赞同：5
> 
> 时间：2013-03-25T18:51:58.060
> 
> 标签：c#, xaml, windows-8, orientation, windows-store-apps

我有以下问题：

当我将 c#+xaml 页面的方向从横向更改为纵向或反之亦然时，在重新计算和重新渲染布局之前，用户可以在屏幕上看到大的蓝色部分大约半秒。这些斑点看起来像是先前定向状态的残余物。

**我正在寻找一种方法来隐藏或平滑这种极其粗糙和颠簸的过渡。**

我尝试添加一个带有 ProgressRing 的方向更改处理程序以覆盖它 1 秒钟，但它没有帮助 - 处理程序在蓝点之后执行。这是我的动画故事板的代码

```
 <!-- The entire page respects the narrower 100-pixel margin convention for portrait -->
            <VisualState x:Name="FullScreenPortrait">
                <Storyboard>
                    <!-- Change the back button and the logo -->
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="backButton" Storyboard.TargetProperty="Style">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PortraitBackButtonStyle}"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="headerLogoImage" Storyboard.TargetProperty="Width">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="430"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="headerLogoImage" Storyboard.TargetProperty="Height">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="49"/>
                    </ObjectAnimationUsingKeyFrames>

                    <!--Change section title and navButtons to be in two rows, by moving navButtons to the second row, first column-->
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="navButtons" Storyboard.TargetProperty="(Grid.Row)">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="1"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="navButtons" Storyboard.TargetProperty="(Grid.Column)">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="0"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="navButtons" Storyboard.TargetProperty="(Grid.ColumnSpan)">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="2"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="navButtons" Storyboard.TargetProperty="Margin">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="0,15,0,0"/>
                    </ObjectAnimationUsingKeyFrames>

                    <!--Change the grid-->
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="itemGridView" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="itemPortraitGridView" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
            </VisualState> 
```

任何帮助表示赞赏，谢谢！

编辑：我通过使用以下方法（以及我同事的帮助）解决了这个问题：

```
/// <summary>
    /// On Orientation change collapse all views, and make visible only the views for the particular new orientation
    /// Also change the font size for portrait mode
    /// </summary>
    /// <param name="sender"></param>
    private async void OnOrientationChanged(object sender)
    {
        headerGrid.Visibility = Visibility.Collapsed;
        itemGridView.Visibility = Visibility.Collapsed;
        itemPortraitGridView.Visibility = Visibility.Collapsed;
        itemListView.Visibility = Visibility.Collapsed;

        //Make the loading spinner temporarily visible and stop it in the StoryBoard animation for every orientation separately
        LoadingView.Visibility = Visibility.Visible;

        //Change the font size
        if (ScreenHelper.IsInPortraitMode())
        {
            _viewModel.FontSizeMethod = _viewModel.GetPortraitFontSize;
        }
        else
        {
            //change font size method back
            _viewModel.FontSizeMethod = _viewModel.GetLandscapeFontSize;
        }

        // Change visibility back to normal in case the xaml approach failed.
        await Task.Delay(1000);

        if (ScreenHelper.IsInPortraitMode())
            itemPortraitGridView.Visibility = Windows.UI.Xaml.Visibility.Visible;
        else if (ApplicationView.Value == ApplicationViewState.Snapped)
            itemListView.Visibility = Windows.UI.Xaml.Visibility.Visible;
        else
            itemGridView.Visibility = Windows.UI.Xaml.Visibility.Visible;

        headerGrid.Visibility = Visibility.Visible;
        LoadingView.Visibility = Visibility.Collapsed;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T23:49:28.943

我知道您已将其标记为完整，但由于我无法发表评论，因此我不得不在这里提问。你能用缓动来解决这个问题吗？

# asp.net - 请求的内容似乎是脚本，不会由静态文件处理程序提供服务。IIS 7.5

> ID：15622504
> 
> 赞同：15
> 
> 时间：2013-03-25T18:52:08.430
> 
> 标签：asp.net, iis-7.5, publishing

我知道这个论坛和其他资源上有相关的帖子，但我被这个卡住了，无法继续。问题是我用 vs2010 做了一个网站，当我将它发布到 ftp 服务器并导航到 url 地址时，我得到了这个错误。这是我做过的事情

-我已启用 IIS 服务和静态内容

-我已经恢复到处理程序映射下的静态文件的父级

-我已经在命令提示符下再次注册了 asp.net（regiis.exe 的东西）

- 在 IIS 管理器中，我在站点下添加了我的网站地址，停止了默认网站并启动了我的网站。

-我已将我的网站添加到 classic.NET AppPool（集成和 v4.0）

-我已启用默认浏览..

-我已经完成了通常涵盖的所有建议..

这是我的 web.config

```
<configuration>
<system.webServer>
<directoryBrowse enabled="true" showFlags="Date, Time, Size, Extension" />
<defaultDocument>
  <files>
    <add value="AnaSayfa.aspx" />
  </files>
</defaultDocument>
</system.webServer>
<system.web>
<compilation debug="true" targetFramework="4.0" />

</system.web>
 </configuration> 
```

我在哪里做错了？我已经用了2天了，一寸也进不去。如果这个问题解决了，我会泪流满面。任何帮助都会非常，非常，非常！感激，将是我的英雄，大师（：谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-06-13T11:16:32.973

转到**命令提示符**并安装/修复 ASP.NET

`C:\Windows\Microsoft.NET\Framework\v4.0.30319>aspnet_regiis -i`

转到**IIS => 选择服务器名称（系统名称）**

转到**ISAPI 和 CGI​​ 限制**

允许**不允许**的限制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-18T14:43:44.247

当我将应用程序池的 .Net 框架版本更改为我的应用程序的 .net 框架版本时，我得到了这个工作。我的应用程序的框架版本是 4.0，但应用程序池的设置默认为 2.0。我不得不将其更改为 4.0，然后它工作正常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-11T03:06:09.197

+1 @Dablue，IIS 8.5 不再支持 aspnet_regiis 命令。对我来说，通过在 Web 服务器 > 应用程序开发下安装“Asp.Net 3.5”或“Asp.Net 4.5”解决了这个问题。

[![在此处输入图像描述](../Images/3a1b66f1e2649c29542763f1be2b3020.png)](https://i.stack.imgur.com/moRqW.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T21:30:24.967

@regeme - 我在尝试运行自己的网站时遇到了类似的问题，经过大量挖掘后，我终于解决了。在我的情况下，它与尝试加载的 *.json 文件有关，并且没有为其初始化任何规则。如果您仔细查看您的错误，它应该让您了解 IIS 未加载的内容。

查看网络检查器的网络选项卡后，我能够看到哪些项目返回 404，它们都是***.json**。

我假设由于您的错误返回“内容似乎是脚本，并且不会由...提供服务”，因此情况相同。

我的决议：

A）您可能已经这样做了，因为它会引发另一个错误，我只是在介绍我们的基础。

1.  转到 IIS **HTTP 响应标头**
2.  创建一个 mime 类型“ **.json** ”“ **application/json** ”

B) ****见注**

1.  转到**处理程序映射**。
2.  设置**请求路径：**到“*.json”
3.  **可执行文件：**到“C:\Windows\System32\inetsrv\asp.dll”

C) 为了安全起见，您可能希望此时再次重新启动服务，这可以在 IIS 面板或 cmd 提示符中完成。

1.  **Windows 键**+ **r**
2.  输入：**cmd**并按**ctrl** + ***shift** +* **enter**
3.  类型：**iisreset**并按**回车**

*注意：这可能会为您省去很多麻烦，在我的情况下，我安装了 64 位 dll 的 asp.dll 而不是 32 位版本，64 位版本的文件夹位于 C:\Windows\SysWOW64\inetsrv\ asp.dll

**重要**的是，这些文件位置在 Windows 8 中，据我了解，在 Windows 7 中是相同的，但*对于您的操作系统*仔细检查可能并非如此。

最后，如果您缺少 asp.dll，这仅仅是因为您缺少 Windows 功能。只需转到添加/删除程序（程序和功能）

1.  **打开或关闭 Windows 功能**
2.  下拉互联网信息服务
3.  下拉万维网服务
4.  检查应用程序开发功能确保它不仅仅是部分检查，并且所有子项目都正在安装

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-25T12:49:59.853

在 Windows 2012 和 IIS 8.5 上，aspnet_regiis 不再有效。

相反，在服务器管理器中添加 aspnet-4.5 角色

在左侧栏中打开服务器管理器选择 IIS 滚动右侧窗口直到看到“角色和功能”任务选择添加角色在“服务器角色”下打开“Web 服务器（iis）打开”Web 服务器打开“应用程序开发”选择“ASP .NET 4.5”（“asp.net 4.5 可扩展性”不会这样做）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-18T20:26:27.540

我不得不创建一个新的网站。我的网站级别中有一些无效配置直接引用了我的应用程序的虚拟目录。

例如，`https://server/app`给我 404.17 错误但`https://server/app-test`工作成功。交换两个应用程序名称（使用`appcmd`）导致工作`app-test`（现在重命名为`app`）开始失败。在创建一个名为的新网站后`MyApp Web Site`，我能够再次创建一个新应用程序，这次命名`app`成功。

经过广泛审查后，`Default Web Site`我们无法确定是什么配置导致了名为 404.17 的应用程序`app`，而不是替代命名的应用程序，例如`app-test`.

我相信造成这种情况的最终原因，是我没有通过服务器角色`.NET Extensibility Services`和`ASP.NET 4.5`功能添加——在安装过程中。因此，我的应用程序的安装程序未能`Default Web Site`正确配置成功。例如，创建的应用程序池错误地安装了 v2.0 Integrated 而不是 v4.0 Integrated。安装所需角色和功能后，我验证 ISAPI（64 位 v4）配置正确，并且应用程序池已针对 v4 集成进行了适当配置。不幸的是，我无法确定会导致此问题的任何其他设置 - 特别是明确针对`app`虚拟路径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-16T04:27:27.847

在 Web 服务器上托管 MVC 应用程序时，我们遇到了同样的问题。除 WCF 服务外，所有应用程序都运行良好。

当我们在 Windows 服务器管理器中为 .NET Framework 4.5 WCF 服务添加服务器角色时，该问题已得到解决。

访问[http://community.bamboosolutions.com/blogs/bambooteamblog/archive/2013/02/08/how-to-enable-and-use-net-framework-3-5-and-4-5-in-windows -server-2012.aspx](http://community.bamboosolutions.com/blogs/bambooteamblog/archive/2013/02/08/how-to-enable-and-use-net-framework-3-5-and-4-5-in-windows-server-2012.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-26T20:46:29.487

这为我解决了这个问题。对所有说出合理解决方案而不必通过 3 环马戏团的人 +1。

打开像这样的 IIS Windows 功能

[![与 ASP.NET 相关的 IIS 应用程序开发功能](../Images/35606cefd939b806a092727a155df5f8.png)](https://i.stack.imgur.com/xrGlj.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-06T14:04:41.757

看看这个，就我而言，这解决了问题

[https://support.microsoft.com/en-us/kb/2019689](https://support.microsoft.com/en-us/kb/2019689)

这可能会帮助你

在这种情况下，如果从站点请求的 *.aspx 资源在未以经典模式运行、不是 32 位或未运行 .NET 2.0 版本的应用程序池中处理，则会返回 404.17 错误框架。为了在此示例中正确提供资源，必须满足所有 3 个先决条件。具体来说，托管此资源的应用程序池必须针对经典模式进行配置，需要将其配置为使用 .NET Framework 的 2.0 版本，并且需要针对 32 位应用程序进行设置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-25T16:20:32.483

对我来说，这个问题是通过右键单击虚拟目录来解决的——>转换为应用程序

# c# - 如何在代码隐藏中对动态创建的 GridView 进行排序

> ID：15622506
> 
> 赞同：0
> 
> 时间：2013-03-25T18:52:13.480
> 
> 标签：c#, javascript, asp.net, gridview

我根据用户输入的数据创建了动态数量的 Gridview。每个 Gridview 都有自己的标题行，我希望用户能够通过单击特定列的标题对单个 GridView 进行排序。我一直无法编写 OnClick_sort 方法来引用特定的 GridView 和该数据。另外，我希望这在客户端完成，而不是传递回服务器，所以我需要在 JavaScript 中编写 Sort 方法，对吗？每个 GridView 都有一个唯一的 ID，在将 GridView 添加到控件时生成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:10:42.273

你可以通过唱 Jquery 来做到这一点。参考这个... [http://www.aspsnippets.com/Articles/Scrollable-GridView-with-Fixed-Headers-and-Client-Side-Sorting-using-jQuery-in-ASP.Net.aspx](http://www.aspsnippets.com/Articles/Scrollable-GridView-with-Fixed-Headers-and-Client-Side-Sorting-using-jQuery-in-ASP.Net.aspx)

[http://www.aspsnippets.com/Articles/Filter-GridView-Records-using-DropDownList-in-HeaderTemplate-Header-Row-in-ASPNet.aspx](http://www.aspsnippets.com/Articles/Filter-GridView-Records-using-DropDownList-in-HeaderTemplate-Header-Row-in-ASPNet.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-25T18:58:31.167

您应该将网格的元素保存在内存中，并使用您的代码（处理事件等）对其进行排序。但是，神奇的是：你应该把你的网格放在一个 updatePanel 中，这样你的代码就会被翻译成一个在客户端执行的脚本。如果您的代码太复杂而无法在客户端上运行，它将与服务器通信而无需您的干预。

就是它？;)

# actionscript-3 - Flash CS 5.5 调整单选按钮组件的大小

> ID：15622516
> 
> 赞同：0
> 
> 时间：2013-03-25T18:52:36.030
> 
> 标签：actionscript-3, flash, radio-button

如何调整 Flash CS5.5 附带的单选按钮组件的大小？

默认外观非常小。这同样适用于同样非常小的单选按钮标签。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:43:03.563

您可以在库中找到图形资产。该文件夹将是`"Component Assets" -> "RadioButtonSkins"`. 请注意，有许多影片剪辑包含单选按钮的各种状态

至于单选按钮的文本/标签部分，您必须通过代码来完成。这是您可以拥有的示例函数：

```
function styleRadioButton(rb:RadioButton, myTextFormat:TextFormat):void {
    rb.setStyle("embedFonts", true); //if you want to use an embedded font
    rb.setStyle("textFormat", myTextFormat); //set the text format
    rb.setStyle("antiAliasType", AntiAliasType.ADVANCED); //if you want smoother looking fonts
    rb.textField.autoSize = TextFieldAutoSize.LEFT; //if you want the label to automatically grow
} 
```

因此，如果您有一个名为 的复选框的实例`myRadio`，您可以这样做：

```
var textFormat:TextFormat = new TextFormat("Arial", 24, 0xFF0000); //make a red, 24px Arial text format
styleCheckBox(myRadio,textFormat); 
```

* * *

现在，您还可以做的一件更简单的事情是将您的单选按钮放在一个`MovieClip`或`Sprite`容器内并缩放所述容器。去做这个：

1 - 在舞台上放置一个单选按钮的实例

2 - 选择新创建的实例，按 F8（或修改 -> 转换为符号）

3 - 缩放新制作的影片剪辑

# javascript - 仅使用 jQuery 将 return false 添加到父链接

> ID：15622519
> 
> 赞同：1
> 
> 时间：2013-03-25T18:52:40.503
> 
> 标签：javascript, jquery, html

我在切换的 div 中有一个列表...

```
<li>
    <a href="#">Link</a>
    <ul stlye="display:none;">
        <li><a href="http://www.google.com">Child Link</a></li>
    </ul>
</li> 
```

我写了一段 jQuery 来切换子 UL 的显示，仅当单击子链接时它不再起作用（它不会通过谷歌），任何人都可以看到我哪里出错了吗？

```
//  Dropdown
$('.archives ul li a').click(function(){
    $(this).parent().find('ul').slideToggle();  
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:05:16.537

STYLE 拼写错误。

```
stlye= 
```

从您的帖子标题看来，您想要这样的东西......

```
$('.archives ul li a').click(function(){
    var $children = $(this).parent().find('ul');
    $children.slideToggle();
    return $children.length > 0 ? false : true;
}); 
```

仅当找到子 UL 时，才会返回 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:05:58.710

ChildLink 也与您的选择器匹配，并且在单击处理程序中您正在阻止默认操作（即“导航到 Google”）。

所以你应该调整你的选择器来只获得切换链接，或者你使用这个：

```
$('.archives ul li a').click(function(e){
    if ($(this).siblings('ul').slideToggle().length) // if we found a list to toggle
        e.preventDefault(); // or return false
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:03:28.433

假设您显示的内容在 a 内部`ul`，而后者又在具有 class 的元素内部**，**`archives`则选择器`.archives ul li a`匹配父锚点和子锚点，因为您使用了后代选择器，因此您的处理程序会为孩子调用，并且阻止它执行默认操作（按照链接）。**`return false;`**

 **如果您的目标是只为较早的链接而不是子链接触发处理程序，那么您可能需要更具体。但是，您没有显示足够多的标记，我们无法帮助您*更*具体。如果我假设您的标记看起来像这样：

```
<div class="archives">
  <ul>
    <li>
      <a href="#">Link</a>
      <ul style="display:none;">
          <li><a href="http://www.google.com">Child Link</a></li>
      </ul>
  </li>
  </ul>
</div> 
```

...然后选择器将仅匹配“链接”锚而不匹配“子链接”锚`.archives > ul > li > a`（例如，使用*直接子*选择器）。

另请注意，您有`stlye`而不是`style`，但我认为这只是问题中的一个错字。*（为什么人们不使用复制和粘贴？！;-)）*

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-25T19:06:21.120

由于您的`return false`语句正在取消默认链接操作，因此您需要更加具体，以免您针对希望允许继续运行的链接。

尝试这个：

```
$('.archives > li > a').click(function () {
    $(this).parent().find('ul').slideToggle();
    return false;
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/JRXxF/5/)**

通过使用`>`子选择器并将目标更改为仅最外层列表的直接子链接，子链接将不会被选中并继续工作。在您的代码中，您`$('.archives ul li a')`将应用于任何子链接，而不仅仅是顶层。**

# angularjs - AngularUI select2 onChange 方法

> ID：15622522
> 
> 赞同：1
> 
> 时间：2013-03-25T18:52:46.373
> 
> 标签：angularjs, angular-ui, jquery-select2

我该如何做一些事情：

```
 <select ui-select2 multiple="true" on-change="onChange()" data-ng-model="select2Model"></select> 
```

在我的控制器中，我定义了 onChange(select2OnChangeData) 。

我试着添加这个

```
 scope: {
        model: "=ngModel",
        onChange: "&onChange"
    }, 
```

到 angular-ui，但这改变了范围变量并破坏了其余的功能。

我真的不想这样做：

> .on("改变", 函数(e)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:57:55.117

好在我在我的项目中做到了这一点：

**HTML**

```
<select data-placeholder="Select an asset" class="input-xxlarge" ui-select2="sourceAssetId" ng-model="sourceAssetId" ng-options="asset.id as asset.name for asset in assets"></select> 
```

**指示**

```
module.directive("uiSelect2", function() {
    var linker = function(scope, element, attr) {
        element.select2();

        scope.$watch(attr.ngModel, function(newValue, oldValue) {
            console.log("uiSelect", attr.ngModel, newValue, oldValue);

            // Give the new options time to render
            setTimeout(function() {
                if(newValue) element.trigger("change");
            })
        });
    }

    return {
        link: linker
    }
}); 
```

**相关控制器代码**

```
$scope.$watch("sourceAssetId", function(newValue, oldValue) {
    if(newValue) $scope.fetchAsset();
}); 
```

# html - 多列形式的不同大小输入

> ID：15622526
> 
> 赞同：0
> 
> 时间：2013-03-25T18:53:00.763
> 
> 标签：html, css, css-tables

我是编码新手，我正在努力使我的输入达到我需要的大小。

我有一个 6 列的表单，所有输入框的大小都相同。我希望一些更宽，一些更窄。

我试图缩小框的所有内容都会导致列折叠

我的 HTML 是：

```
<!DOCTYPE html>
<html>

<head>
<title>Web Form</title>
<link rel='stylesheet' type='text/css' href='stylesheet.css'/>    
</head>

<body>

        <div id="header"><h1>LED Savings Calculator</h1></div>

        <div id="c1" class="column1" >

          <form room="input" action="#" method="post">

                  Room 1: <input type="text" room="" value="" ><br/> 
                  Room 2: <input type="text" room="" value=""><br/>
                  Room 3: <input type="text" room="" value=""><br/>
                  Room 4: <input type="text" room="" value=""><br/>
                  Room 5: <input type="text" room="" value=""><br/>
                  Room 6: <input type="text" room="" value=""><br/>
                  Room 7: <input type="text" room="" value=""><br/>
                  Room 8: <input type="text" room="" value=""><br/>
                  Room 9: <input type="text" room="" value=""><br/>
                  Room 10: <input type="text" room="" value=""><br/>

            </form>
        </div>

        <div id="lights" class="column1" >
            <form lights="input" action="#" method="post">

                  Existing Lights: <input type="text" lights="" value=""><br/> 
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>

              </form>
        </div>
            <div id="Watts" class="column2" >

              <form watts="input" action="#" method="post">    
                  Lamp Size (Watts): <input type="text" lights="" value=""  ><br/> 
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""  ><br/>
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value="" ><br/>

              </form>
        </div>
  <div  id="Quantity" class="column2" >
    <form room="input" action="#" method="post">

                  How Many?: <input type="text" lights="" value=""><br/> 
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>

            </form>
        </div>
      <div  id="savings" class="column2" >
         <form room="input" action="#" method="post" >
           Costs: <input type="text" lights="" value=""><br/> 
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
           </form>
        </div>

  <div  id="savings" class="column2" >
    <form room="input" action="#" method="post" >
         Savings: <input type="text" lights="" value=""><br/> 
                 . <input type="text" room="" value="" ><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
                 . <input type="text" room="" value=""><br/>
           </form>
        </div> 
```

而 CSS 是：

```
body {
  background-color: #ffffff;
}

#header {
  position: relative;
  top: -10px;
  background-color: #00A0B0;
  border-top-left-radius: 15px;
  border-top-right-radius: 15px;
  border-bottom-left-radius: 15px;
  border-bottom-right-radius: 15px;
  height: 40px;
}

h1 {
  font-family: Myriad-pro;
  color: #ffffff;
  text-align: center;
 }

div.column1 {
  float:left;
  width:150px;
  height:400px;
}

div.column2 {
  float:left;
  width:150px;
  height:400px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:53:49.333

尝试这个

```
<input type="text"  value=""  style="Width:50px" >
<input type="text"  value=""  style="Width:100px">
<input type="text"  value=""  style="Width:70px"> 
```

根据需要更改值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:55:14.400

你可以改变他们的`size`属性。

加上他们没有`room`属性。我不知道你想做什么。你不能使随机属性。

```
<input type="text" size="5" value="" >
<input type="text" size="10" value="" > 
```

等等

这是演示[http://jsfiddle.net/btevfik/a8Urj/](http://jsfiddle.net/btevfik/a8Urj/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:57:29.020

看起来您正在使用底部的 CSS 定义表格宽度，您可以调整它！

您是否尝试过在每个文本输入中添加宽度？

# sql-server - 如何在 sql server 2008 中与来自其他计算机的用户创建一个新的启动会话？

> ID：15622530
> 
> 赞同：0
> 
> 时间：2013-03-25T18:53:15.940
> 
> 标签：sql-server, permissions, lan, workgroup

我有两台电脑。一台装有 Windows XP，我有 SQL Server 2008 Express，另一台装有 Windows 7 的计算机。在两台计算机上，我都有 sql server management studio。

两台计算机都在同一个工作组中。使用资源管理器，我可以看到从一台计算机到彼此的共享文件夹。

在 Windows 7 计算机中，当我在资源管理器中输入 \myXPComputer 时，我可以看到共享的文件夹和一个 sqlexpress 连接。如果我确实双击此图标，我会收到一条错误消息，提示 Windows 无法访问 \myXPComputer\slqexpress。但是我可以连接到共享的打印机并且它们在 xp 计算机中。

所以在xp电脑上，我打开sql server management studio，尝试添加新的启动会话，但是只能看到位置\myXPComputer，无法从同一个工作组的其他电脑中选择其他用户。

我想知道 kow 可以从我的 windows 7 计算机上安装的 sql server management studio 访问 XP 中的数据库。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:04:41.167

在 SSMS...

服务器类型：数据库引擎：服务器名称：您要连接的计算机的 IP。

验证...

你可以做窗户，但设置起来更难，所以我们不要。所以...确保您的 SQL 服务器支持混合模式身份验证并使用您要连接的 SQL 服务器的凭据，所以如果您在 7 上并尝试连接到 xp，请输入该 xp 框的 IP 并让您登录到该 XP 框的凭据。这些凭据可能是 SA。如果没有，请确保您已启用混合模式和 SA。

这是它的基本要点。

# ruby-on-rails - 话语 - Ruby 2.0 / Rails 4？

> ID：15622543
> 
> 赞同：3
> 
> 时间：2013-03-25T18:54:04.823
> 
> 标签：ruby-on-rails, ruby, discourse

我知道这不是 Stack Overflow 的正确问题类型（请原谅我），但我花了几个小时试图让 Discourse 在我的机器上运行。它以前可以工作，但我升级到 Ruby 2.0 和 Rails 4，现在由于各种错误（安装 NFS、Syck 已弃用、TheRubyRacer 安装不正确），我根本无法正常工作。

我一一解决了这些问题，现在当我通过 SSH 连接到 vagrant 时，它说当我进行捆绑安装时找不到 gemfile。我想我可能已经改变了一些东西，它不是“SSH-ing”到正确的文件夹中，但我做了很多事情基于我在 stackoverflow 上搜索/发现的内容并且有点卡住了。

我知道这是一个非常模糊/结构不佳的问题，但我还是编程新手，只是想知道，Discourse 是否可以与 Ruby 2.0/Rails 4 一起使用，有人可以为我指出如何判断我是否以某种方式崩溃的正确方向我的 SSH 命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T16:44:47.600

基于 Discourse 源代码，主要基于[Gemfile/Gemfile.lock](https://github.com/discourse/discourse) ，rails 版本是 **Rails v3.2.12**，可能他们使用的是**Ruby 1.9.x**

**编辑 1**
基于[Rails 的 Travis CI Builds](https://travis-ci.org/rails/rails)看起来 rails 支持**ruby​​ 2.0**。我不知道 Rails 3.2.12 是否支持它——但我的猜测是，在 Ruby 2.0 上运行 Discourse 应该很少或没有问题。

**编辑 2**
此外，看起来[Discourse 针对 Ruby 2.0 构建没有问题](https://travis-ci.org/discourse/discourse)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T10:23:06.610

ssh后你是在app的根目录下吗？

```
cd /vagrant 
```

# batch-file - 如何创建一个批处理文件，以管理员身份打开 32 位 cmd 提示符以运行另一个批处理文件

> ID：15622545
> 
> 赞同：1
> 
> 时间：2013-03-25T18:54:07.677
> 
> 标签：batch-file, cmd

我有一个批处理文件，我目前必须执行以下操作才能运行：

1.  以管理员身份打开 SYSWOW64\cmd.exe（这是一个 32 位应用程序）
2.  cd c:\mybatchfilelocation\
3.  然后运行我的批处理文件batchfile.bat

我希望能够以管理员身份运行一批，自动以管理员身份打开 SYSWOW64\cmd.exe（提示输入管理员用户名和密码即可），然后运行我的 batchfile.bat

我已经看到如果您在运行之前在批处理文件中预先指定 /user:machinename\administor 并且它只提示输入密码，但这需要部署给客户，我不能依赖他们编辑文件。当他们需要输入时，我需要它在提示下运行。

**更新**

感谢 Bill，我不再需要担心 SYSWOW64 部分。我只需要能够弄清楚如何让批处理文件以管理员身份打开 cmd 提示符，并让该 cmd 在同一目录中运行另一个批处理文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:03:36.090

要在可能运行 64 位 Windows 的机器上的 cmd shell 脚本（批处理文件）中注册 32 位 DLL...

```
@echo off
setlocal enableextensions
set REGSVR=
if defined PROCESSOR_ARCHITEW6432 (
  set REGSVR=%SystemRoot%\system32\regsvr32.exe
) else (
  set REGSVR=%SystemRoot%\SysWOW64\regsvr32.exe
)
%REGSVR% /s "C:\Path\my dll file.dll"
...
endlocal 
```

**更新**

**如果定义**的行不应该使用**not**。应该如上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:36:41.380

你能包括额外的软件吗？有[几个](http://code.kliu.org/misc/elevate/) [命令行](http://wintellect.com/cs/blogs/jrobbins/archive/2007/03/27/elevate-a-process-at-the-command-line-in-vista.aspx) [实用程序](http://jpassing.com/2007/12/08/launch-elevated-processes-from-the-command-line/)可用于此目的。或者您可以使用 VBScript 启动批处理脚本：

```
Set app = CreateObject("Shell.Application")
app.ShellExecute "C:\Windows\SYSWOW64\cmd.exe", "/c batchfile.bat" _
  , "C:\mybatchfilelocation\", "runas", 1 
```

# python - 使用 python 脚本作为另一个 python 脚本的命令行参数

> ID：15622551
> 
> 赞同：0
> 
> 时间：2013-03-25T18:54:35.490
> 
> 标签：python, command-line-arguments

我已经编写了一个返回整数值的 python 脚本。我想将该整数值用作我正在处理的不同 python 脚本的参数之一。有没有办法做到这一点？我在 mac 终端工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:06:29.823

只需将您的脚本作为模块导入到第二个脚本中。然后你可以调用任何带有模块前缀的函数。从脚本 2 中：

```
import script1

#this is your function call that returns an integer
script1.script1function() 
```

您可以使用：

```
from script1 import * 
```

也可以访问所有变量。但这通常不是一个好主意，特别是如果您打算更改这些变量的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:35:49.123

```
from subprocess import (
    Popen,
    PIPE
)
p1 = Popen(['/path/to/python', "/path/to/your/script.py"], stdout=PIPE)
p1.stdout.read() 
```

但是你的脚本需要标准输出，这意味着它必须打印结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:10:14.350

这个问题可以通过将第一个脚本作为第二个（[文档](http://docs.python.org/2/tutorial/modules.html)）中的模块导入来解决假设您的第一个脚本称为 script.py，如下所示：

```
def some_function():
    return(1)

some_variable = 2 
```

在您的第二个脚本中，您可以将第一个作为模块导入并使用其函数和变量，前提是模块名称：

```
import script

print script.some_function(), script.some_variable 
```

这将打印`1, 2`.

# ruby-on-rails - Heroku - ActiveRecord::StatementInvalid (PG::Error: ERROR: "requested" 列不存在

> ID：15622552
> 
> 赞同：1
> 
> 时间：2013-03-25T18:54:55.197
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, heroku, rails-activerecord

我有一个`absense.html.erb`在开发和生产中运行良好的。但是，当我尝试访问该页面时，出现以下错误：

> 2013-03-25T18:43:43+00:00 app[web.1]：在 2013-03-25 18:43:43 +0000 2013-03-25T18:43 开始为 77.100.90.77 获取“/缺席” :43+00:00 app[web.1]: 2013-03-25T18:43:43+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR: column "requested" does不存在 2013-03-25T18:43:43+00:00 app[web.1]: LINE 1: ...LECT "holidays".* FROM "holidays" WHERE (state = "requested... 2013-03 -25T18:43:43+00:00 app[web.1]:
> ^ 2013-03-25T18:43:43+00:00 app[web.1]: : SELECT "holidays".* FROM "holidays" WHERE （状态 = “请求”））：2013-03-25T18:43:43+00:00 应用 [web.1]：2013-03-25T18:43:43+00:00 应用 [web.1]：2013 -03-25T18:43:43+00:00 应用 [web.1]:
> app/controllers/holidays_controller.rb:52:in 'absence' 2013-03-25T18:43:43+00:00 heroku[router]: at=info method=GET path=/rota_days host=miuk-portal.herokuapp. com fwd="77.100.90.77" dyno=web.1 queue=0 wait=0ms connect=1ms service=5773ms status=200 bytes=897173

错误指向我的控制器中我的缺席方法的以下行

```
def absence
#show the holidays where the approver id matches the current user id
#and state = "requested"'

    @user = current_user
    if current_user.role? :administrator
      # a superadmin can view all current holiday requests
      @holidays = Holiday.find(:all, :conditions => 'state = "requested"')
    else
      #otherwise an admin sees the holiday requests that they are approvers for
      @holidays = Holiday.find(:all, :conditions => ["approver_id = #{current_user.id}", "state = requested"])
    end
  end 
```

我已经在我的假期模型中声明了这一点，如下所示：

**假日.rb**

```
class Holiday < ActiveRecord::Base

  belongs_to :user
  belongs_to :calendar
  belongs_to :type, :class_name => "Type"
  belongs_to :approver, :class_name => "User"

  before_create :default_values #Before creating holiday set default_values
                                #before_create :overflow

  validates :start_at, :presence => { :message => "must be a valid date/time" }
  validates :end_at, :presence => {:message => "must be a valid date/time"}
  validate :start_must_be_before_end_date
  validate :overflow #Hook method to determine if user holidays are over the set amount
  validates_presence_of :end_at, :start_at

  attr_accessible :description, :end_at, :start_at, :state, :type_id, :user_id, :color

  def length
    (self.end_at.to_i - self.start_at.to_i)/(60*60*24)
  end

  def days_used
    ( (start_at.to_date)..(end_at.to_date) ).select {|d| (1..5).include?(d.wday) }.size
  end

  #Validates_presence_of is called to ensure that the start date exisit.
  #Start date must be lt or = to end date otherwise throw error.
  def start_must_be_before_end_date
    errors.add(:start_at, "must be before end date") unless
        self.start_at <= self.end_at
  end

  #Overflow of holidays is validated by calling "validates" L31\. Then checks if absent days
  #Is gt or = to length
  def overflow
    errors.add(:overflow, "- You only have #{user.absentdays} days holiday remaining; this absence is #{length} days.") unless
        user.absentdays >= length
  end

  def name
    return self.user.name
  end

  def colors
    if state ||= "denied"
      return self.color ||= "#C00000"

    end
  end

  private

  #Setting default values - before_create is called and sets the following
  def default_values
    self.state ||= "requested"
    self.color ||= "#000000"
    self.type_id||= 1
  end
end 
```

似乎不明白为什么这在开发和生产中都有效，而不是在 heroku 中。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:11:27.983

标准 SQL 字符串使用单引号，双引号用于标识符（例如表名和列名）；PostgreSQL 遵循这里的标准，MySQL 和 SQLite 不那么严格，其他数据库做其他事情的严格程度不同。在任何情况下，SQL 字符串文字的单引号应该在任何地方都一样。

您在 SQL 字符串上使用双引号：

```
@holidays = Holiday.find(:all, :conditions => 'state = "requested"')
#------------------------------------------------------^---------^ 
```

你必须单引号：

```
@holidays = Holiday.find(:all, :conditions => %q{state = 'requested'}) 
```

或对其进行现代化改造并让 ActiveRecord 处理引用：

```
@holidays = Holiday.where(:state => 'requested') 
```

您可能还需要修复此引用：

```
@holidays = Holiday.find(:all, :conditions => ["approver_id = #{current_user.id}", "state = requested"]) 
```

同样，对其进行现代化改造是最简单的方法：

```
@holidays = Holiday.where(:approver_id => current_user.id, :state => 'requested') 
```

我猜你是在 SQLite 上开发，但在 PostgreSQL 上部署。这是一个坏主意，总是在同一个堆栈上开发和部署。

# html - 如何使用文本换行符保留 div 高度

> ID：15622556
> 
> 赞同：0
> 
> 时间：2013-03-25T18:55:15.240
> 
> 标签：html, css

我正在尝试显示人们姓名的框。问题是这些名称可能会变得很长，并且使用固定宽度的框，肯定会出现疯狂。长间隔的文本中断，导致新行出现问题 ( [http://jsfiddle.net/9MhWW/](http://jsfiddle.net/9MhWW/) ) 并禁用换行符`white-space: nowrap;`将溢出框 ( [http://jsfiddle.net/9MhWW/1/](http://jsfiddle.net/9MhWW/1/) )。

使用换行符似乎是最好的选择。如果您同意，那么这就引出了以下问题：有没有办法确保在不丢失部分文本、每行都有一个 div 或给段落固定高度的情况下不会发生行问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:58:11.133

如果只有一行适合您，请设置`overflow: hidden`：

```
p { overflow: hidden; } 
```

一个很好的效果是使用省略号将溢出的文本替换为`...`：

```
p { overflow: hidden; text-overflow: ellipsis; } 
```

请参阅您的小提琴的此[更新](http://jsfiddle.net/9MhWW/2/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:18:16.360

我想我已经想出了一个解决方案。所以 bootstrap 添加了很多东西来让它看起来不错，但是在你的情况下，我们必须撤消其中的一些。所以我们必须去掉左边的浮动并用显示内联块替换它：

```
.span2{
    float: none !important;
    display:inline-block;
} 
```

请参阅[小提琴更新](http://jsfiddle.net/9MhWW/4/ "小提琴更新")。我不得不更改文本对齐方式以匹配您之前的对齐方式。

# android - android编程-标签不起作用

> ID：15622557
> 
> 赞同：-2
> 
> 时间：2013-03-25T18:55:19.310
> 
> 标签：android, eclipse, tabs

我是一个新用户和一个初学者 android 程序员。我在MainActivity.java中写了一段代码，在虚拟设备上不行，不知道是什么原因。谁能告诉我为什么它不起作用？提前致谢

```
package com.tee.contactsList;

import android.app.Activity;
import android.os.Bundle;
import android.widget.LinearLayout;
import android.widget.ScrollView;
import android.widget.TabHost;
import android.widget.TabHost.TabSpec;
import android.widget.TextView;

public class MainActivity extends Activity
{

    LinearLayout mainLayout;
    TextView title;
    TextView contact1;
    ScrollView scrollList;
    LinearLayout list;
    TabHost tabs;
    TabSpec firstTab;
    TabSpec secondTab;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        tabs = new TabHost(this); 
        firstTab = tabs.newTabSpec("tid1");
        secondTab = tabs.newTabSpec("tid2");
        mainLayout = new LinearLayout(this);
        title = new TextView(this);
        contact1 = new TextView(this);
        scrollList = new ScrollView(this);
        list = new LinearLayout(this);
        tabs.addTab(firstTab);
        tabs.addTab(secondTab);
        firstTab.setIndicator("Contacts");
        secondTab.setIndicator("Calender");
        tabs.getTabWidget().setCurrentTab(1);
        mainLayout.setId(123);
        mainLayout.setOrientation(LinearLayout.VERTICAL);
        list.setOrientation(LinearLayout.VERTICAL);
        mainLayout.addView(title);
        title.setText("Contacts");
        mainLayout.addView(scrollList);
        scrollList.addView(list);
        scrollList.setBackgroundColor(0x0000ff00);
        list.setBackgroundColor(0x0000ff00);
        contact1.setBackgroundColor(0x0000ff00);
        list.addView(contact1);
        String s="\n";
        String array[]={"contact1","contact2","contact3","contact4","contact5"};
        for (int x=0;x<=4;x++)
        {
            s+="contact";
            s+=(x+1);
            s+=":";
            s+=array[x];
            s+="\n";
        }
        contact1.setText(s);
        firstTab.setContent(123);
        setContentView(tabs);
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:06:58.950

您应该将布局创建为 xml。

在活动中，您参考您在 xml -> findviewbyid 中创建的元素的 viewID

对象仅在您的代码中创建，它们不会分配给布局。例如， setContentView 也会发生同样的情况。那里应该有一个 viewID r.layout.xml_file

# jquery - 根据在 JQuery 的下拉列表中选择的选项禁用和启用单选按钮

> ID：15622558
> 
> 赞同：0
> 
> 时间：2013-03-25T18:55:21.507
> 
> 标签：jquery, asp.net, html

我有一个单选按钮选项，我想根据从下拉列表中选择的选项禁用和启用。我最初禁用了单选按钮选项，但是当我尝试根据下拉列表中选择的选项启用它时，没有任何反应。我能得到一些帮助吗：HTML：

```
 <asp:DropDownList runat="server" ID="ddl1">
                  <asp:ListItem Text="Please Select" Value="0" />
                  <asp:ListItem Text="1" Value="1" />
                  <asp:ListItem Text="2/Staff" Value="2" />
                  <asp:ListItem Text="3" Value="3" />                      
                  <asp:ListItem Text="4" Value="4" />
                  <asp:ListItem Text="5" Value="5" />                     
            </asp:DropDownList> 
          <asp:RadioButtonList runat="server" ID="rbPType" ClientIDMode="Static">
                     <asp:ListItem Value="0" Text="T0"></asp:ListItem>
                     <asp:ListItem Value="1" Text="1"></asp:ListItem>
                     <asp:ListItem Value="2" Text="2"></asp:ListItem>
                 </asp:RadioButtonList> 
```

JS：

```
$('#rbPType_1').attr("disabled", true);
$('#ddl1').change(function () {

    if ($(this).children('option:selected').text() == "2")
    {
        $('#rbPType_1').attr("disabled", false);
    }
    else
    {
        $('#rbPType_1').attr("disabled", true);
    }

}); 
```

PS：我最初的意图是根据选项隐藏和显示这个并被踩到。因此，如果有一种方法可以隐藏和显示而不是启用和禁用，我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:18:05.107

您可以通过使用获取下拉列表的选定值`.val()`

```
<asp:DropDownList runat="server" ID="ddl1">
    <asp:ListItem Text="Please Select" Value="0" />
    <asp:ListItem Text="1" Value="1" />
    <asp:ListItem Text="2/Staff" Value="2" />
    <asp:ListItem Text="3" Value="3" />
    <asp:ListItem Text="4" Value="4" />
    <asp:ListItem Text="5" Value="5" />
</asp:DropDownList>
<asp:RadioButtonList runat="server" ID="rbPType" ClientIDMode="Static">
    <asp:ListItem Value="0" Text="T0"></asp:ListItem>
    <asp:ListItem Value="1" Text="1"></asp:ListItem>
    <asp:ListItem Value="2" Text="2"></asp:ListItem>
</asp:RadioButtonList>
<script>
    $('#rbPType_1').attr("disabled", true);
    $('#ddl1').change(function () {

        if ($(this).val() == '2') {
            $('#rbPType_1').attr("disabled", false);
        }
        else {
            $('#rbPType_1').attr("disabled", true);
        }

    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:02:07.193

试试这个作为 JS：

```
$('#rbPType_1').hide();
$('#ddl1').change(function () {
    if ($(this).val() == ("2"||"2/Staff")) {
        $('#rbPType_1').show();
    } else {
        $('#rbPType_1').hide();
    }
}); 
```

它*应该*工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:02:41.180

```
$('#rbPType_1').attr('disabled', 'disabled');
$('#ddl1').on('change',function () {
    if($(this).val()=='2'){
        $('#rbPType_1').removeAttr('disabled');
    }else{
        $('#rbPType_1').attr('disabled','disabled');
    }
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T19:44:59.790

尝试这个

```
 <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" 
        Height="28px" onselectedindexchanged="DropDownList1_SelectedIndexChanged" 
        Width="100px">
        <asp:ListItem>Value one</asp:ListItem>
        <asp:ListItem>Value Two</asp:ListItem>
    </asp:DropDownList> 
```

并设置事件

```
 protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    if (DropDownList1.SelectedIndex == 0)
    {
        RadioButton1.Checked = true;
    }
    else
    {
        RadioButton1.Checked = false;
    }
} 
```

试试这个并根据需要实现它。

# android - 有没有办法将 KeyEvent.KEYCODE_BACK 触发到自定义按钮？

> ID：15622564
> 
> 赞同：0
> 
> 时间：2013-03-25T18:55:38.593
> 
> 标签：android

我想在我的应用程序中创建另一个后退按钮。为此，我可以使用完成方法，但我需要的操作已经存在于 Android KeyEvent.KEYCODE_BACK 中，而不是我试图在我的 clicklistener 上触发此事件，有没有办法做到这一点？

按钮 btnVoltar = (按钮) findViewById(R.id.btnVoltar);

```
 btnVoltar.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            // HERE I WANT TO USE KeyEvent.KEYCODE_BACK
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:03:03.833

```
Try this override onbackpressed and invoke it on your click

        @Override
    public void onBackPressed() {
        // TODO Auto-generated method stub
        super.onBackPressed();
    }
  btnVoltar.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            onBackPressed();
        }
    }); 
```

# javascript - jquery与动态div绑定

> ID：15622565
> 
> 赞同：0
> 
> 时间：2013-03-25T18:55:42.777
> 
> 标签：javascript, jquery

我对 jquery 有疑问。假设我在 jquery 中有 2 个 div，

```
<div id='1'>               //static div
</div>

<div id='2'>               //dynamic div
</div> 
```

静态 div 始终存在于文档中，但当我们单击静态 div 时，动态 div 会切换。现在我想要在动态 div 上放置一个事件，例如：

```
$(document).on("show", "#2", {}, function() {
 alert("div 2 present");
}); 
```

这样当文档中存在动态 div 时我可以做一些事情。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:58:35.180

元素可见时不会触发“显示”事件。您必须将处理程序绑定到导致元素首先可见的事件。在这种情况下，这似乎是第一个 div 上的点击事件：

```
$(document).on("click", "#1", function() {
    $("#2").toggle();

    if ( $("#2").is(":visible") ) {
        alert("div 2 present");
    }
}); 
```

请注意，根据 HTML 4 规范，元素 ID 不应以数字开头。但是，这在 HTML 5 中没问题。

需要注意的进一步改进是，当将处理程序绑定到动态生成的元素时，最好以最近的静态父元素为目标，而不是允许在`document`级别处理委托；即做`$("#parent").on("click", element, function() {})`。

最后，由于`<div id="1">`是静态的，你不需要委托事件处理程序，你可以直接绑定处理程序：

```
$("#1").click(function () {
    //...
}); 
```

# c# - 反序列化继承对象的集合

> ID：15622568
> 
> 赞同：0
> 
> 时间：2013-03-25T18:56:04.013
> 
> 标签：c#, xml, serialization

我有一个 xml 文件，其中包含一个看起来像这样的集合

```
<AbstractCollection>
    <ConcreteA name="Bob" age="4"/>
    <ConcreteB name="Tree" size="1" />
</AbstractCollection> 
```

我知道如果我使用一个具体的集合——即两个元素是相同的类型——在 C# 中使用标准的 XML 反序列化会很容易。不同的类型似乎使它变得更加困难。

有没有办法使用简单的 xml 反序列化来解决这个问题，还是我必须自己实现反序列化？

[为清楚起见添加] 我应该补充一点，xml 已经存在并且我无法更改它。我在 xml 中接收采用上述形式的消息。一个更具体的例子是：

```
<Actions>
    <Walked name="Bob" distance="4"/>
    <Cycled name="Jane" gear="3rd" />
</Actions> 
```

我想要结束的是一个“循环”和一个“步行”对象。哦，为了让它更有趣，顺序很重要。

另外，我尝试在代码中使用 XmlInclude 属性，但是通过在序列化时更改 xml 来工作（当然，除非我一直在使用错误）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T11:51:31.170

所以我找到了解决方案，感谢[这个答案](https://stackoverflow.com/a/2689660/1988046)。

关键是用来`XmlElementAttribute`改变不同类的序列化方式。

唯一奇怪的部分是我发现我必须为列表创建一个包装类，否则 Cycled 和 Walked 元素不会包装在根元素中。

我知道命名空间的东西还在，但我可以处理——获取派生类的问题已经解决了！

感谢所有参与的人。

```
[Serializable]
public class Actions
{
    [XmlElementAttribute("Walked", typeof(WalkedAction))]
    [XmlElementAttribute("Cycled", typeof(CycledAction))]
    public List<Action> ActionList { get; set; }
}
[Serializable]
public abstract class Action
{
    [XmlAttribute]
    public string Name { get; set; }
}

[Serializable]
public class WalkedAction : Action
{
    [XmlAttribute]
    public int Distance { get; set; }
}

[Serializable]
public class CycledAction : Action
{
    [XmlAttribute]
    public string Gear { get; set; }
}

public class Program
{
    public static void Main(string[] args)
    {
        var actionList = new Actions();
        actionList.ActionList = new List<Action>();
        actionList.ActionList.Add(new WalkedAction { Name = "Bob", Distance = 4 });
        actionList.ActionList.Add(new CycledAction { Name = "Jane", Gear = "3rd" });

        var ser = new XmlSerializer(typeof(Actions));

        TextWriter w = new StringWriter();
        ser.Serialize(w, actionList);

        TextReader r = new StringReader(w.ToString());
        Actions result = (Actions) ser.Deserialize(r);
    }
} 
```

# regex - 处理 CLOB 字段中的 wordrap 分隔符

> ID：15622570
> 
> 赞同：0
> 
> 时间：2013-03-25T18:56:07.690
> 
> 标签：regex, oracle

我在下面有这个请求，它完全符合我的要求，但只有当字段 Author_ID 和 Author_Name 是 VARCHAR 并且它们中的值由星号分隔时才会这样做，如下表所示：

```
ID_BOOK | ID_AUTHOR |       NAME AUTHOR       |
-----------------------------------------------
001     |01         | AuthorU                 | 
-----------------------------------------------
002     |02*03*04   | AuthorX*AuthorY*AuthorZ |
----------------------------------------------- 
```

该请求会给我这个结果：

```
ID_BOOK | ID_AUTHOR |       NAME AUTHOR       |
-----------------------------------------------
001     |01         | AuthorU                 |
-----------------------------------------------
002     |02         | AuthorX                 |
-----------------------------------------------
002     |03         | AuthorY                 |
-----------------------------------------------
002     |04         | AuthorZ                 |
----------------------------------------------- 
```

但在现实生活中，这两个字段是 CLOB 并且没有星形分隔符，只有 wordrap 分隔符，所以数据在现实生活中看起来像这样：

```
ID_BOOK | ID_AUTHOR |       NAME AUTHOR       |
-----------------------------------------------
001     |01         | AuthorU                 | 
-----------------------------------------------
002     |02*03*04   | AuthorXAuthorYAuthorZ   | 
```

我试图获得与 Varchar 字段和星号分隔符相同的结果，因为使用 CLOB 我不能使用 REGEXP_SUBSTR 并且我不知道如何处理 wordrap 分隔符。你能帮我一些提示吗？非常感谢。

```
SELECT
 ID_Book,
 REGEXP_SUBSTR(ID_Author, '[^*]+', 1, Counter) AS AuthID,
 REGEXP_SUBSTR(Name_Author, '[^*]+', 1, Counter) AS AuthName
FROM Books
CROSS JOIN (
  SELECT LEVEL Counter
    FROM DUAL
    CONNECT BY LEVEL <= (      
      SELECT MAX(REGEXP_COUNT(ID_Author, '[^*]+'))
      FROM Books))
WHERE REGEXP_SUBSTR(Name_Author, '[^*]+', 1, Counter) IS NOT NULL
ORDER BY 1, 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:08:23.190

您可以转换`clob`为`varchar2`使用`to_char`功能。

* * *

**编辑：**
如果`Name_Author`是 CLOB，请尝试

```
 to_char(REGEXP_SUBSTR(Name_Author, '[^'||chr(10)||chr(13)||']+', 1, Counter)) 
```

或者

```
 to_char(REGEXP_SUBSTR(Name_Author, '^.*?$', 1, Counter, 'm')) 
```

后一个表达式更短，但它没有去掉`chr(13)`符号。

# excel - 基于模板添加工作簿

> ID：15622572
> 
> 赞同：1
> 
> 时间：2013-03-25T18:56:27.920
> 
> 标签：excel, add-in, excel-2003, vba

我正在为 Excel 2003 编写一个小型 VBA 加载项，其想法是加载项在目录中查找任何“.xlt”文件，并为找到的每个文件添加一个按钮到“模板”菜单，该菜单提供快速获取空白模板的方法。大多数加载项都运行良好，但我遇到了一点问题，我很难理解为什么它不工作。

这是构建菜单的代码示例。

```
Public Sub BuildMenu()

Dim Active_Menu_Bar As Office.CommandBar
Dim Tmplts_MenuItem As Office.CommandBarControl
Dim Tmplts_MenuControl As Office.CommandBarControl
Dim objSearch
Dim TemplatesPath As String

DeleteControls

Application.Interactive = False

Set Active_Menu_Bar = Application.CommandBars.Item(1)
Set Tmplts_MenuItem = Active_Menu_Bar.Controls.Add(msoControlPopup, , , 10, True)

With Tmplts_MenuItem
    .Caption = "Templates"
    .BeginGroup = False
    .Tag = C_TAG
End With

TemplatesPath = FetchValue("TemplatesPath")

Set objSearch = Application.FileSearch
    objSearch.LookIn = TemplatesPath
    objSearch.SearchSubFolders = False
    objSearch.Filename = "*.xlt"
    objSearch.Execute

For Each strFile In objSearch.FoundFiles

    'Remove Path from strFile
    strFile = Replace(strFile, TemplatesPath, "")

    Select Case strFile
        Case "Journal.xlt"
            Set Tmplts_MenuControl = Tmplts_MenuItem.Controls.Add(Type:=msoControlButton, temporary:=True)
            With Tmplts_MenuControl
                .Caption = "New Journal"
                .OnAction = "'" & ThisWorkbook.Name & "'!NewJournal"
                .Tag = C_TAG
            End With

        Case "Budget Journal.xlt"
            Set Tmplts_MenuControl = Tmplts_MenuItem.Controls.Add(Type:=msoControlButton, temporary:=True)
            With Tmplts_MenuControl
                .Caption = "New Budget Journal"
                .OnAction = "'" & ThisWorkbook.Name & "'!NewBudgetJournal"
                .Tag = C_TAG
            End With

        Case Else
            Set Tmplts_MenuControl = Tmplts_MenuItem.Controls.Add(Type:=msoControlButton, temporary:=True)
            With Tmplts_MenuControl
                .Caption = "New " & strFile
                .OnAction = "'" & ThisWorkbook.Name & "'!NewGenericTemplate(""" & TemplatesPath & strFile & """)"
                .Tag = C_TAG
            End With

    End Select
Next

Set objSearch = Nothing

Set Tmplts_MenuControl = Tmplts_MenuItem.Controls.Add(Type:=msoControlButton, temporary:=True)
With Tmplts_MenuControl
    .Caption = "User Preferences"
    .OnAction = "'" & ThisWorkbook.Name & "'!UserPrefs"
    .BeginGroup = True
    .Tag = C_TAG
End With

Application.Interactive = True

End Sub 
```

如您所见，有一个 select case 语句说，对于特定的“已知”模板，为按钮分配一个宏，以便处理该模板的要求（例如，Journal 模板的宏也填充了几个字段始终具有特定值的模板，例如由`application.username`) 填充的用户名，该位按预期工作。

问题在于 Case Else。我希望能够选择恰好在目录中的任何其他模板并将完整路径传递给“通用”宏，该宏将根据模板创建一个新工作簿，而无需任何花哨的附加功能，因此在`OnAction`部分`MenuControl`我正在传递模板的完整路径。

但是，当我单击菜单控件时，什么也没有发生，没有错误消息，什么都没有。

这是`NewGenericTemplate`宏的代码。

```
Sub NewGenericTemplate(MyTemplate As String)

Workbooks.Add Template:=MyTemplate
MsgBox MyTemplate

End Sub 
```

简单的东西（意思是我可能忘记了一些非常明显的东西），`msgbox`当我意识到菜单按钮不起作用并且我想检查该值是否实际上被传递时，我添加了，所以现在我得到了 msgbox 而不是什么都没有（由于某种原因两次），它显示了模板的正确路径，但没有添加工作簿。

任何帮助，将不胜感激。

PS我也尝试在`NewGenericTemplate`宏中设置断点，但代码没有中断

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T11:16:29.457

不幸的是，我不得不把这个问题搁置几个星期，但今天我回到了它，我决定回到基础，只是寻找一种方法将变量从菜单按钮传递到宏，从而导致我到[这个线程](http://www.exceltip.com/st/Pass_arguments_to_macros_from_buttons_and_menus_using_VBA_in_Microsoft_Excel/424.html)。

我现在所做的是将`.OnAction`属性从

```
.OnAction = "'" & ThisWorkbook.Name & "'!NewGenericTemplate(""" & TemplatesPath & strFile & """)" 
```

至

```
.OnAction = "'NewGenericTemplate """ & strFile & """'" 
```

所以基本上删除了对包含宏的文件的引用。我也只传递文件名而不是完整路径，所以下面是我现在用于`NewGenericTemplate`例程的代码。

```
Public Sub NewGenericTemplate(MyTemplate As String)

Dim TemplatesPath As String
Dim FullPathToTemplate As String

'Retrieve path to Templates Directory
TemplatesPath = FetchValue("TemplatesPath")

FullPathToTemplate = TemplatesPath & MyTemplate

If Dir(FullPathToTemplate) <> "" Then
    Workbooks.Add FullPathToTemplate
    Else
    MsgBox "Template File not Found, it may have been moved or deleted.", vbExclamation, "File Not Found"
End If

End sub 
```

希望这应该是排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T21:40:27.157

好的。我能够修改[这个线程](http://www.ozgrid.com/forum/showthread.php?t=28365)的建议。

使用新控件，添加`.Parameter`如下内容：

```
With Tmplts_MenuControl
   .OnAction = "'" & ThisWorkbook.Name & "'!NewGenericTemplate"
  .Parameter = "'" & ThisWorkbook.FullName & "'!NewGenericTemplate"
  .Caption = "New Generic Template"
  .FaceId = 99
  .Style = msoButtonCaption
  .BeginGroup = True
End With 
```

然后，我修改`NewGenericTemplate`子程序来接收这个`.Parameter`。有点儿。由于我们不能按索引引用控件，因为它们看起来是动态的，所以我只是循环现有的控件/子控件，并`myTemplate`根据控件的`.OnAction`值进行分配。

```
Sub NewGenericTemplate()
Dim varControls As Variant 'top level controls
Dim ctrl As Variant 'secondary controls within top-level
Dim myTemplate As String

'Since I can't refernce the controls by Index (they are dynamic), we loop over them:
For Each varControls In Application.CommandBars("Command Bar Name").Controls '<--- EDIT AS NECESSARY
    For Each ctrl In varControls.Controls
        If ctrl.OnAction = "'" & ThisWorkbook.FullName & "'!NewGenericTemplate" Then
            myTemplate = ctrl.Parameter
            GoTo EarlyExit:
        End If
    Next
Next

Exit Sub 'if no parameter has been assigned.

EarlyExit:
If Not myTemplate = vbNullString Then
    Workbooks.Add Template:=myTemplate
End If

End Sub 
```

这对我来说很成功，以前的尝试因您遇到的相同问题而失败。

# sql - 使用多个表连接

> ID：15622574
> 
> 赞同：0
> 
> 时间：2013-03-25T18:56:28.920
> 
> 标签：sql, inner-join, alias

真的在这里挣扎，不太明白发生了什么。使用 MS SQL Server 2012。

如果我要运行此代码：

```
USE database 1;
GO

SELECT a.ID, b.ID, c.ID, d.ID
FROM table1 a, table2 b, table3 c, table3 d
INNER JOIN database2.tablex tx ON a.ID = tx.ID 
```

由于某种原因它不会工作。Intellisense 将仅显示列表中的最后一个别名“d”。如果我将其余代码写出来，则无法绑定 xxxx 列...我该怎么做？我想从多个表中进行选择，然后为所有这些表应用内连接（构建 DW）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:01:46.293

不要混合 2 种连接样式 - 旧的（连接条件 in `WHERE`）和新的（使用`JOIN`关键字）。您的查询不起作用，因为只有最新的表对以下`FROM`内容可见`JOIN`：

```
--Doesn't work 
SELECT a.ID, b.ID, c.ID, d.ID
FROM table1 a, table2 b, table3 c, table3 d
INNER JOIN database2.tablex tx ON a.ID = tx.ID 

--Works (note - table1 a is the last in "FROM"):
SELECT a.ID, b.ID, c.ID, d.ID
FROM  table2 b, table3 c, table3 d, table1 a 
INNER JOIN database2.tablex tx ON a.ID = tx.ID ;

-- Preferred way :
SELECT a.ID, b.ID, c.ID, d.ID
FROM  table1 a  
INNER JOIN table2 b ON (...)
INNER JOIN table3 c ON (...) 
INNER JOIN table3 d ON (...)
INNER JOIN database2.tablex tx ON a.ID = tx.ID 
```

# php - 将 mysql 转换为 mysqli

> ID：15622576
> 
> 赞同：1
> 
> 时间：2013-03-25T18:56:35.020
> 
> 标签：php, mysql, database, mysqli

我对 Mysql 和 PHP 完全陌生。我写了一个有效的脚本，但现在意识到我应该使用 mysqli 而不是 mysql。我尝试将所有 'mysql_...' 更改为 'mysqli_' 但没有奏效。谁能告诉我如何重写下面的代码？

```
 $tableName = "Fixtures";

  //==== CONNECT TO DATABASE
  $con = mysql_connect($host,$user,$pass);
  $dbs = mysql_select_db($databaseName, $con);

  //==== FETCH DATA
  $result = mysql_query("SELECT * FROM $tableName");

  //==== PUT DATA INTO ARRAY
  $array = array();
  while ($row = mysql_fetch_row($result)) {
    $array[] = $row;
  }

  //==== ECHO AS JSON
  echo json_encode($array); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T19:02:10.867

这很简单

```
$db = new mysqli("host", "user", "password", "db");
$result = $db->query("SELECT * FROM $tableName");
while ($row = $result->fetch_row()) {
    //etc.
} 
```

我发现[mysqli 上的 php.net 文档](http://php.net/mysqli)对于查找函数和代码片段很有用。这也回答了你的问题[php.net/mysqli_fetch_row](http://php.net/mysqli_fetch_row)

# php - 带有 ajax 内容的 Jquery 模态加载 onclick 不是一次全部

> ID：15622577
> 
> 赞同：0
> 
> 时间：2013-03-25T18:56:34.970
> 
> 标签：php, jquery, ajax, modal-dialog

我对我的情况有点困惑，我希望你们能对我的挑战有所启发！

好的，我做了一个查询，在我的数据库中加载了大约 1,000 个左右的名字。我成功地制作了一个回声，它加载了一个模式窗口，其中包含每个模式 div 内的配置文件详细信息。

问题是当我有 1,000 个要填充的名称时，它必须使用内部的配置文件详细信息构建每个模式，并且加载页面需要一段时间。

我正在寻找一种更好的方法来检索具有某种 onclick 操作的模态窗口，因此在页面加载时不必创建所有模态窗口。所以也许只是一个动作，当用户点击链接时，它会以某种方式加载它？

这是我的代码，但同样 - 加载每个页面加载的所有信息：

```
<div  id="myModal_."$pageID"" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-body">
    <script>
    $("#".$pageID."").load("admin/page1.php?m=".$pageID."");
    </script>
  </div>
</div>

<a data-toggle="modal" href="#myModal_'.$pageID.'">'.$name.'</a> 
```

提前致谢！！

编辑

这是我在 firebug 中看到的 html - 它没有在模式窗口中加载任何内容？

```
<div class="modal-body">
    <div id="7"></div>                                                 
    <script>
        $('a[href="#myModal7"]').on('click',function(){
        $("#7").load("admin/page1.php?m=7");
        });
    </script>
</div>

<a href="#myModal7" data-toggle="modal">Name goes here</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:04:38.280

```
 <div  id="myModal_."$pageID"" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-body">
        <script>
           $('a[href="#myModal'.$pageID.'"]').on('click',function(){
               $("#myModal_".$pageID." .modal-body").load("admin/page1.php?m=".$pageID."");
           });
        </script>
      </div>
    </div>

<a data-toggle="modal" href="#myModal'.$pageID.'">'.$name.'</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:36:57.157

此函数仅在用户单击链接时创建 HTML。这样做是为了避免浪费大量时间加载不会使用的 HTML：

```
$(".modalLink").click(function(){
    var id = $(this).attr('id');
    if($("#myModal_" + id).length == 0) {
        var div1 = $('<div id="myModal_' + id + '" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" />');
        var div2 = $('<div class"modal-body"/>');
        $('body').append(div1);
        div1.append(div2);
    }
    $('#myModal_' + id + ' div').load("admin/page1.php?m=" + id);
    $("#myModal_" + id).modal();
    return false;
}); 
```

每个链接都应该有类 'modalLink' 和一个唯一的 id：

```
<a id="$pageID" class="modalLink" href="#">$name</a> 
```

由于我不知道您使用的是什么模态脚本，因此我将其编码为我在这里找到的那​​个：http: [//kylefox.ca/jquery-modal/examples/](http://kylefox.ca/jquery-modal/examples/)。我测试了它，它按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:59:59.687

```
$('#mylink').click(function(){
     $("#".$pageID."").load("admin/page1.php?m=".$pageID."");
}); 
```

这是你要找的吗？

# php - 在一个网格视图中显示来自两个表的信息

> ID：15622578
> 
> 赞同：0
> 
> 时间：2013-03-25T18:56:38.173
> 
> 标签：php, yii

我的数据库中有两个表，用于显示基于网格的信息表。目前我的代码只显示一张表的信息（代码如下）

```
<?php $this->widget('zii.widgets.grid.CGridView', array(
    'id'=>'aux-room-grid',
    'dataProvider'=>$model->search(),
    'filter'=>$model,
    'columns'=>array(
        'room',
        'capacity',
        array(
            'class'=>'CButtonColumn',
        ),
    ),
)); ?> 
```

我因为我有容量，所以我也想根据与第二张桌子上的房间号相关联的行数来获得入住率。我知道如果不使用 PHP，这可能看起来很简单，但我是 Yii 的新手，不明白如何在另一个模型上执行计数。要找到入住人数，我需要使用表 1 的第一列的房间号。

简单地说：我需要从第一列开始 count() 与房间号相关的行。我需要显示房间和容量的原始表格内容，但这两列之间有占用。我将如何使用 Yii 做到这一点？

两个表的 SQL：

```
CREATE  TABLE IF NOT EXISTS `cs_people`.`aux_room` (
  `room` VARCHAR(20) NOT NULL ,
  `capacity` VARCHAR(20) NULL ,
  PRIMARY KEY (`room`) )
ENGINE = InnoDB;

CREATE  TABLE IF NOT EXISTS `cs_people`.`room_desk` (
  `userid` VARCHAR(8) NOT NULL ,
  `room` VARCHAR(20) NULL ,
  `desk` VARCHAR(250) NULL ,
  PRIMARY KEY (`userid`) ,
  INDEX `room_desk.room_idx` (`room` ASC) ,
  CONSTRAINT `room_desk.userid`
    FOREIGN KEY (`userid` )
    REFERENCES `cs_people`.`people` (`userid` )
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `room_desk.room`
    FOREIGN KEY (`room` )
    REFERENCES `cs_people`.`aux_room` (`room` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T12:03:08.330

为了达到这个目的，最好在你的 yii 模型中使用关系。[阅读本文](http://www.yiiframework.com/doc/guide/1.1/en/database.arr)并在您的模型上实现必要的关系。下面是 yii 中的一个示例，说明如何使用关系显示来自相关模型的计数。在我的项目中，这显示了用户类型列表旁边给定类型的用户数量。

在我的项目中，下面的文件位于 views/usertype/admin.php 中，因为它适用于管理视图网格，同样适用于索引视图。

```
<?php
$this->widget('bootstrap.widgets.TbGridView', array(
    'id' => 'user-type-grid',
    'dataProvider' => $model->search(),
    'filter' => $model,
    'template' => '{items}',
    'columns' => array(
        'id',
        'name',
        array('header' => 'Users', 'value' => 'count($data->users)'),
        array(
            'class' => 'bootstrap.widgets.TbButtonColumn',
        ),
    ),
));
?> 
```

$model 变量是从 UserType 控制器的 actionAdmin() 方法传递的。Gii 应该为你设置这个。您可以看到，在列数组的引号内使用 $data 变量将使您能够访问每条记录的属性。在此示例中，它访问 UserType 记录的“用户”关系并计算相关用户的数量。

这些关系消除了编写任何复杂 SQL 的需要。Yii 将查询数据并为您执行所有必要的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:05:30.153

不是 Yii 特定的解决方案，但就个人而言，我会使用视图直接从数据库中获取数据。

就像是：

```
CREATE VIEW rooms_with_occupancy 
AS
    SELECT r.*, count(o.*) as occupant_count
    FROM rooms r
    LEFT JOIN occupancy o ON o.room_id = r.id
    GROUP BY r.id 
```

现在，当绑定小部件时，您将使用`rooms_with_occupancy`视图而不是`rooms`表格。

有关创建视图的更多信息，请参阅[官方文档](http://dev.mysql.com/doc/refman/5.0/en/create-view.html "官方 mysql CREATE VIEW SYNTAX 文档")。

# sql - 如何从类别和生产者组中选择价格最低的产品？

> ID：15622581
> 
> 赞同：0
> 
> 时间：2013-03-25T18:56:55.813
> 
> 标签：sql, oracle, function, min

我有一个看起来微不足道的问题，但我无法让它发挥作用。它在 Oracle SQL 中。这是脚本的示例：

```
create table product (
product_id number primary key,
name varchar(255)
);

create table producer (
producer_id number primary key,
name varchar(255)
);

create table catalog (
pp_product_id number,
pp_producer_id number,
price number
);

alter table catalog add constraint pp_product_id1 foreign key (pp_product_id) references product (product_id);
alter table catalog add constraint pp_product_id2 foreign key (pp_producer_id) references producer (producer_id);

insert into product (product_id, name) values (1, 'HDD 250 gb');
insert into product (product_id, name) values (2, 'HDD 500 gb');
insert into product (product_id, name) values (3, 'HDD 750 gb');

insert into producer (producer_id, name) values (1, 'Hitachi');
insert into producer (producer_id, name) values (2, 'Corsair');
insert into producer (producer_id, name) values (3, 'Western Digital');

insert into catalog (pp_product_id, pp_producer_id, price) values (1,1, 80);
insert into catalog (pp_product_id, pp_producer_id, price) values (1,3, 60);
insert into catalog (pp_product_id, pp_producer_id, price) values (2,1, 75);
insert into catalog (pp_product_id, pp_producer_id, price) values (2,2, 40);
insert into catalog (pp_product_id, pp_producer_id, price) values (3,2, 63);
insert into catalog (pp_product_id, pp_producer_id, price) values (3,3, 100); 
```

因此，总共有 6 个产品，3 个生产商，3 个产品类别（HD 类型）。我需要的是显示最便宜的产品，每种类型的产品都带有与该产品相关的生产商名称。就像是：

西部数据 250 GB 60

海盗船 500 GB 40

海盗船 750 GB 63

这将在他们的组（类型）中选择最便宜的高清

```
select p.name, min (c.price)
from product p, catalog c, producer prc
where c.pp_product_id = p.product_id and prc.producer_id = c.pp_producer_id
group by p.name; 
```

...但我不能添加生产者姓名？我尝试了几种解决方案，但都没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:04:08.400

这是一个很好的用途`row_number()`。您的数据没有`type`字段，所以我在产品表中发明了一个：

```
select *
from (select p.name as product_name, p.type, prod.name as producer_name,
             price,
             ROW_NUMBER() over (partition by p.name order by price ) as seqnum
      from catalog c join
           product p
           on c.pp_product_id = p.product_id join
           producer prod
           on c.pp_producer_id = prod.producer_id
     ) t
where seqnum = 1; 
```

如果您想要*所有*产品的最低价格，请使用以下细微变化：

```
select *
from (select p.name as product_name, p.type, prod.name as producer_name,
             price,
             min(price) over (partition by p.name) as minprice
      from catalog c join
           product p
           on c.pp_product_id = p.product_id join
           producer prod
           on c.pp_producer_id = prod.producer_id
     ) t
where price = minprice; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:01:16.800

这应该回答您的核心问题。这篇文章解决了 MySQL 中的问题，但同样的概念也适用。

[http://www.xaprb.com/blog/2006/12/07/how-to-select-the-firstleastmax-row-per-group-in-sql/](http://www.xaprb.com/blog/2006/12/07/how-to-select-the-firstleastmax-row-per-group-in-sql/)

一旦您在组中获得最低价格的产品，其余的只是加入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:17:16.617

感谢@Gordon Linoff - 他的代码稍作更改，它适用于我的问题。为了清楚起见，我在这里发布解决方案：

```
select *
from (select p.name as product_name, prod.name as producer_name,price,
ROW_NUMBER() over (partition by p.name order by price ) as seqnum
from catalog c join
product p
on c.pp_product_id = p.product_id join
producer prod
on c.pp_producer_id = prod.producer_id
) t
where seqnum = 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T16:46:32.440

与此同时，我找到了另一个可能的答案：

```
SELECT p.name, pr.name, c2.minprice
FROM product p, producer pr, catalog c,
  (SELECT pp_product_id, MIN(price) AS minprice
    FROM catalog c1
    GROUP BY pp_product_id
  ) c2
WHERE p.product_id=c.pp_product_id
AND pr.producer_id=c.pp_producer_id
AND p.product_id  =c2.pp_product_id
AND c.price       =c2.minprice; 
```

输出如下：

硬盘 750 GB 海盗船 6300

硬盘 500 GB 海盗船 4000

硬盘 250 GB 西部数据 6000

# unit-testing - PHPUnit 报告将未经测试的方法标记为已测试

> ID：15622582
> 
> 赞同：1
> 
> 时间：2013-03-25T18:56:57.773
> 
> 标签：unit-testing, report, phpunit, zend-framework2

我在 Zend Framework 2 应用程序中编写了两个简单的模型类：`Catalog\Model\City` `Catalog\Model\CityTyble`. 对于这些，还没有编写任何单元测试。但是当我创建一个报告 ( `user@machine:/path/to/project/module/Catalog/test# phpunit --coverage-html ./report`) 时，其中一个类显示为经过测试：

![在此处输入图像描述](../Images/e7ad9b5971bea9e6ca42b5d91a179c29.png)

...以及方法：

![在此处输入图像描述](../Images/c9d6ada8f4047b3394167eced20be176.png)

这个类没有测试方法，甚至a类也不存在。

这里有什么问题？为什么这个未经测试的类/这些未经测试的方法显示为经过测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T22:59:04.350

该报告并不完全意味着正在测试代码。报告只说这些行正在执行。因此，如果您有执行某些行的测试，则假设它们正在被测试。为了获取这些信息，PHPUnit 使用[PHP_CodeCoverage](http://www.phpunit.de/manual/3.8/en/code-coverage-analysis.html)

你有任何可以被 PHPUnit 执行的代码吗？正如报告中所说，您在某处有 PHPUnit 正在执行的代码，即创建*CityTable*的实例并调用方法*fetchAll()*

如果您使用[的是配置文件](http://www.phpunit.de/manual/3.8/en/appendixes.configuration.html)，请检查您是否在告诉 PHPUnit 执行正确的文件。

# matlab - 如何计算矩阵的特定列的平均值，不包括 MATLAB 中的给定值

> ID：15622604
> 
> 赞同：0
> 
> 时间：2013-03-25T18:58:13.073
> 
> 标签：matlab, matrix, logical-operators, mean

我有一个 1000x7 矩阵，它的列显示一些值等于`-99`.

我想分别计算每列的平均值，因为我正在使用 构建一个表`fprintf`，*但*我希望计算的平均值不包括`-99`值。

例如，采取 matrix `A`，我试过

```
mean(A(A(:,1) ~= -99)) 
```

它适用于计算第一列的平均值。

但是，当我尝试

```
mean(A(A(:,2) ~= -99)) 
```

对于第二列，结果与第一列的结果**完全相同**。

那有什么问题？非常感谢您的提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:51:04.653

简而言之：您需要在读取值时指定列：

```
mean(A(A(:,2) ~= -99, 2)) 
```

更长的版本：`A(:,1) ~= -99`返回一个`1000 x 1`逻辑数组，`A(:,2) ~= -99`. 当使用逻辑数组进行索引时，Matlab 有效地展平了两个数组，并提取了逻辑数组的值`true`。

如果逻辑数组`B`有`M`元素并且被索引到的数组, `A`, 有`N`元素`M <= N`Matlab 将只对ie的第一个`M`元素进行操作将等价于*`B``C = A(B)`

```
C = A(1:M);
C = C(B); 
```

在您的示例中，您正在`1000 x 7`使用`1000 x 1`逻辑数组对数组进行索引，这使得所有调用仅考虑前 1000 个元素，即第一列。因此，您需要指定要应用逻辑索引的列。

*如果`B`是一个`1xM`数组，则结果数组也将被重新整形为一个`1xM`数组，对于所有其他情况，`Mx1`返回一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:16:24.247

您仅将索引值带到第一列。

尝试

`mean(A(A(:,2) ~= -99),2)`第二列的 %

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:33:12.623

您正在使用向量 ,`A(:,1)~=-99`来索引数组，因此它仅访问第一列中的值。下面是一个示例，说明如何对数组中的每一列进行此计算：

```
A = [1 2 3; -99, 4, 3; 10 4 8];

for col = 1:3
    index = A(:,col) ~= -99;
    mean(A(index,col))
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T19:21:54.797

例如，您需要的是第一列：

```
mean(A(find(A(:,1) ~= -99),1)) 
```

例如：

```
>> A

A =

     1     2
     1     3
   -99     4
     1     5 
```

然后，

```
>> find(A(:,1)~=-99)

ans =

     1
     2
     4 
```

和，

```
>> mean(A(find(A(:,1)~=-99),1))

ans =

     1 
```

# php - 用于解析客户端 ID 的 URI 的正则表达式

> ID：15622606
> 
> 赞同：1
> 
> 时间：2013-03-25T18:58:20.617
> 
> 标签：php, regex

我一直在试图弄清楚如何获取正则表达式来解析以下网址：

```
http://localhost/asdf/client/16/admin/64/edit 
```

我想得到的是跟随客户的号码。在这种情况下 16\. 我尝试了适用于 的 client/(.+)/ `http://localhost/hot_seat/client/16/admin`，但是一旦我将 64/edit 添加到 url 中，它就不再起作用了。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:05:40.983

尝试这样的事情，因为客户端 ID 是一个整数：

```
preg_match('/client\/(?P<id>\d+)\/?/', 'http://localhost/asdf/client/16/admin/64/edit', $array);
echo $array["id"]; // 16 
```

# ios6 - iPhone 二进制文件上的 iPhone 5 iOS6 GDB

> ID：15622607
> 
> 赞同：1
> 
> 时间：2013-03-25T18:58:21.023
> 
> 标签：ios6, jailbreak, iphone-5

我正在尝试使用`gdb`在我的 iPhone 5 (iOS 6) 上解密一些 iPhone App 二进制文件，以便我可以对它们进行分类转储。我正在使用来自 cydia.radare.org 源的 gdb。我 ssh 进入我的手机，cd 到应用程序目录（例如 iReddit），然后运行`gdb iReddit`​​. GDB 加载二进制文件就好了，在 GDB 提示符下，我输入：

`(gdb) set sharedlibrary load-rules ".*" ".*" none`

`(gdb) set inferior-auto-start-dyld off`

`(gdb) set sharedlibrary preload-libraries off`

`(gdb) set sharedlibrary load-dyld-symbols off`

`(gdb) handle all nostop`

`(gdb) rb doModInitFunctions`

`(gdb) run`

我得到：

`Starting program:/var/mobile/Applications/<hexid>/iReddit.app/iReddit`

它就在那里。我已经等了一段时间，但每次，它似乎都没有做任何事情。它不会在任何地方中断，我尝试在**每个**函数上设置断点（使用`rbreak .`）。它不会对他们中的任何一个人造成破坏。我有一种感觉，它甚至没有被运行。我已经检查以确保没有其他 iReddit 实例正在运行。当我尝试从命令行运行应用程序时，使用

`./iReddit`

同样的事情也会发生。什么都没有被杀死，提示就在那里。关于可能出了什么问题以及如何解决的任何建议？

# node.js - node.js http.get 块没有返回正确的结构

> ID：15622609
> 
> 赞同：1
> 
> 时间：2013-03-25T18:58:23.733
> 
> 标签：node.js

这可能会因为在 railjs 控制器内部运行而变得复杂（还没有移动到化合物中），但不要这么认为，不要认为铁路会干扰这里的任何东西。

我有以下内容：

```
var http = require('follow-redirects').http;
var https = require('follow-redirects').https;
action('index', function (req,res) {
    var url = decodeURIComponent(request.query.url);
    var resobj;
    var stat;
    var headers;
    http.get(url, function (r) { 
        stat = r.statusCode;
        headers = r.headers;
    r.on('data', function (chunk) {
            resobj += chunk.toString();
        });
        r.on('end', responder);
    });
    function responder(){
    response.writeHead(200, {
            'Content-Type': headers["content-type"]
        })
        response.write(resobj);
        response.end();
    }

}); 
```

request.query.url 来自铁路，或者可能来自快递底层，无论如何它正确返回。但是，每当我在各种网站上运行它时，我都会遇到两个问题

1.  文本 undefined 出现在其他任何内容之前，例如在 doctype 声明之前。

2.  块的结构似乎是关闭的，导致浏览器修复 html（可能是由“未定义”字符串引起的），这种修复意味着通常在渲染时在头部找到的元素最终在正文中，

有关解决此问题的任何想法-如果有人可以向我展示如何执行上述代码，以便我可以使用其中一个节点 phantomjs 桥接器获得至少一样好的结果，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T19:57:36.920

这个问题大约有一年的历史，但我试图解决类似的问题。Node 在流中处理这些响应以保持其占用空间相当低。要求 Node 缓冲它们并尝试连接夹头是不必要的工作。我发现使用 mikeal 的请求包是处理响应“正文”的最简单方法[https://github.com/mikeal/request](https://github.com/mikeal/request)

```
var request = require('request');
request('http://www.google.com', function (error, response, body) {
    if (!error && response.statusCode == 200) {
        console.log(body) // Print the google web page.
    }
}) 
```

# java - 从c ++（jni）调用java函数根本不起作用

> ID：15622610
> 
> 赞同：2
> 
> 时间：2013-03-25T18:58:26.493
> 
> 标签：java, android, c++, android-ndk, java-native-interface

我在网上找到了很多帖子，但似乎没有一个可以帮助我做对。

我的问题是我想从 ndk c++ 部分调用一个 android java 函数。

当我上课时：

```
jclass icls = jenv->GetObjectClass(obj); 
```

我收到此错误： *E/AndroidRuntime(27397): java.lang.NoSuchMethodError: no method with name='setValues' signature='()V' in class Ljava/lang/Class;* => jmid == 0

当我用**“FindClass”**像下面这样调用它时，我收到此错误：*A/libc(26692): Fatal signal 11 (SIGSEGV) at 0x00000004 (code=1), thread 26743 (Thread-8302)*

***findclass 和方法似乎有效（！= 0）所以obj***可能有问题吗？

任何人？提前谢谢..

JAVA - 主类：

```
package com.new.test;
class Test{
   public Test(Context context, AttributeSet attrs) {
        super(context, attrs);
        run();
   }

   run(){
         int x = 10;
         new DoStuff(x);
   }
   public void setValues(){     
       Log.e("","SET VALUES");
   }
} 
```

JAVA 2 JNI：

```
public class DoStuff{   
    public DoStuff(int x){
        nativeDoStuff(x);
    }

    private static native long nativeDoStuff(int x);

    static{
        System.loadLibrary("do_stuff");
    }
} 
```

C++：cpp

```
JNIEXPORT void JNICALL Java_com_new_test_DoStuff_nativeDoStuff (JNIEnv * jenv, jobject obj, jint x){

    jclass icls = jenv->FindClass("com/new/test/Test");
    //jclass icls = jenv->GetObjectClass(obj);
    jmethodID jmid = jenv->GetMethodID(icls, "setValues","()V");
    jenv->CallVoidMethod(obj,jmid);

} 
```

C++: 小时

```
JNIEXPORT void JNICALL Java_com_new_test_DoStuff_nativeDoStuff (JNIEnv *, jobject, jint); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:11:21.717

如果我没看错的话，在这种情况下，“obj”将指向 DoStuff 对象，而不是 Test 对象。因此，您尝试在不包含此方法的对象上调用 setValues 方法。您应该使您的本机方法成为 Test 的成员，或者将 Test 的实例传递给函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T20:09:01.117

该方法`Test.setValues()`是一个实例方法 - 它需要一个有效的`Test`对象才能执行。同时，该方法`nativeDoStuff`没有。它是一个静态方法，它所拥有的（作为第二个参数）是 DoStuff 类的一个类对象。您错误地将该类指针作为指向的`this`指针传递`CallVoidMethod()`- 这是致命的错误。

将所有内容移动到一个类中（`Test`或者`DoStuff`，都没有关系），并`nativeDoStuff()`在 Java 端声明为非静态。或者使`doStuff()`自己静态并`jenv->CallStaticVoidMethod()`用作最后一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T22:24:34.260

尝试改变空白：

```
JNIEXPORT void JNICALL Java_com ... 
```

到**jlong** ​​。

# asp.net-mvc - 如何更改 EF 生成的类属性的 [DisplayName]？

> ID：15622616
> 
> 赞同：14
> 
> 时间：2013-03-25T18:58:35.210
> 
> 标签：asp.net-mvc, entity-framework, asp.net-mvc-4, ef-database-first

`.edmx`我们知道 EF 根据我们添加到文件的表生成类。这不会为他们提供任何 [DisplayName] DataAnnotations。

如何在不修改它们的情况下添加生成的类的 [DisplayName]？`.edmx`因为如果数据库更改，如果我修改文件（重新添加修改后的表），则可以覆盖生成的类。所以我不想修改生成类本身。

## EF 生成类

```
 public partial class Committee
    {
        public string Committee_Description { get; set; }
        public byte[] Committee_Id { get; set; }
        public string Rn_Descriptor { get; set; }
        public Nullable<System.DateTime> Rn_Create_Date { get; set; }
       ......
       ..... 
```

## 看法

```
 <tr>
            <th>
                @Html.DisplayNameFor(model => model.Item2.GetEnumerator().Current.Committee_Name)
            </th> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T20:41:52.867

使用元数据类并通过 MetadataTypeAttribute 将其附加到您的实体类。您在元数据类中的属性上指定数据注释属性（所述属性没有实现）。

MSDN：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.metadatatypeattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.metadatatypeattribute.aspx)

编辑：初始陷阱是您定义的部分类的命名空间以附加 MetadataTypeAttribute。确保将其命名空间更改为原始实体使用的命名空间，以便它定义相同的类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-20T14:45:52.743

您可以更改模板 .tt 文件，生成类代码以使用模型的文档属性生成具有必要属性的类。例如对于 EF5，您可以在 *Model.tt 方法中替换`CodeStringGenerator.Property()`为：

```
public string Property(EdmProperty edmProperty)
{
    return string.Format(
        CultureInfo.InvariantCulture,
        "{5} {0} {1} {2} {{ {3}get; {4}set; }}",
        Accessibility.ForProperty(edmProperty),
        _typeMapper.GetTypeName(edmProperty.TypeUsage),
        _code.Escape(edmProperty),
        _code.SpaceAfter(Accessibility.ForGetter(edmProperty)),
        _code.SpaceAfter(Accessibility.ForSetter(edmProperty)),
        (edmProperty.Documentation == null ? "" : ("[Display(Name=\""+edmProperty.Documentation.Summary+"\")]"+Environment.NewLine+"   ")));
} 
```

并且`CodeStringGenerator.UsingDirectives()`：

```
public string UsingDirectives(bool inHeader, bool includeCollections = true)
{
    return inHeader == string.IsNullOrEmpty(_code.VsNamespaceSuggestion())
        ? string.Format(
            CultureInfo.InvariantCulture,
            "{0}using System;{1}" +
            "{2}{3}",
            inHeader ? Environment.NewLine : "",
            includeCollections ? (Environment.NewLine + "using System.Collections.Generic;") : "",
            inHeader ? "" : Environment.NewLine,"using System.ComponentModel.DataAnnotations;"+Environment.NewLine)
        : "";
} 
```

在模型和模板.tt中设置`Documentation.Summary`属性之后，将生成具有适当属性的所有类，而不使用元数据类并通过 MetadataTypeAttribute 将其附加到您的实体类。例如：

```
namespace DataAdmin.Models
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel.DataAnnotations;

    public partial class Discount
    {
        public Discount()
        {
            this.DiscountPeriods = new HashSet<DiscountPeriod>();
            this.Clinics = new HashSet<Clinic>();
            this.Doctors = new HashSet<Doctor>();
            this.Servs = new HashSet<Serv>();
        }

        public int DiscountKey { get; set; }
        [Display(Name="Discount name")]
        public string Name { get; set; }
        public string MisCode { get; set; }
        public string MisName { get; set; }
        public string MisDesc { get; set; }
        public decimal Perc { get; set; }
        public int Rang { get; set; }
        public Nullable<int> DiscountTypeKey { get; set; }

        public virtual ICollection<DiscountPeriod> DiscountPeriods { get; set; }
        public virtual ICollection<Clinic> Clinics { get; set; }
        public virtual ICollection<Doctor> Doctors { get; set; }
        public virtual ICollection<Serv> Servs { get; set; }
        public virtual DiscountType DiscountType { get; set; }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-01T05:48:50.863

请注意，生成的类是部分类。因此，您可以创建另一个具有相同名称的部分类并对其进行注释。然后，如果您更改 .edmx 文件，第二个部分类将不会刷新。

更多关于[MVC DB first Fix display Name](https://stackoverflow.com/questions/12610319/mvc-db-first-fix-display-name)

# node.js - 我应该在 node.js 中的哪里存储当前用户？

> ID：15622618
> 
> 赞同：4
> 
> 时间：2013-03-25T18:58:42.170
> 
> 标签：node.js, express

与几乎所有 Web 应用程序一样，我需要一种方法来引用我的 node.js 应用程序中的当前用户。

我的登录/会话系统正常工作，但今天我注意到，当我在一个浏览器中登录我的应用程序并在另一个浏览器中查看它时，我可以看到与在第一个浏览器中看到的相同数据。

我目前将有关当前用户的信息存储在全局 app.current_user 对象中，但我现在意识到这是在所有请求/会话中共享的，因为 node.js 是单线程的——因此，这是一个坏主意。

存储对当前用户的引用的正确方法是什么？当前用户不仅仅是用户数据的哈希，而是一个 Mongoose 模型，所以我想存储在 cookie 中不是一个好主意？

顺便说一句 - 我还存储了用户的设置和其他一些我不想在每次对用户及其设置执行某些操作时再次获取的内容（在单个请求中可能会发生很多次）。我想你可以说我正在将当前用户缓存在内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T06:20:10.240

目前存储有关当前用户的信息的正确位置似乎是在请求对象中。

如果您不喜欢将请求对象传递给 mongoose 或其他模块的想法，那么您需要在路由器/控制器/中间件中进行任何更改。例如，我可以在我的操作中为模型设置`lastModifiedBy`用户 ID 。`Post``posts_controller` `update()`

您也可以尝试使用相当新的`domain`功能来存储当前用户数据，但是在使用 Mongoose 时，它​​还没有帮助，因为 Mongoose 还不支持域：[https ://github.com/LearnBoost/mongoose/pull/ 1337](https://github.com/LearnBoost/mongoose/pull/1337)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:43:51.577

在快递中，您可以使用会话

```
//To set up session 
app.use(express.cookieParser());
app.use(express.session({secret: 'secret pass', store: sessionStore})); 
//To use it
req.session = {user:name , model:mongo_model};
console.log(req.session.user); 
```

例子

1.  [在这里](https://github.com/visionmedia/express/blob/master/examples/session/index.js)看一个简单的例子
2.  [在这个问题](https://stackoverflow.com/questions/6819911/node-js-express-js-session-handling-with-mongodb-mongoose)中查看如何使用 mongostore 获取会话数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-29T08:13:48.680

由于您已经实现了会话，因此在所有路由之前放置一个中间件，该中间件可以找到当前登录的用户并将其存储在 res.locals 中。这使用户数据可用于您可以在应用程序中的任何位置访问的所有路线，如下所示。

*else if*部分用于记住我的功能。此功能根据是否存在秘密将记住令牌和用户 ID 存储在 cookie 对象/signedCookie 对象中。

```
app.use(function(req, res, next){
    if (req.session.userId){
        User.findById(req.session.userId, function(err, u){
        res.locals.currentUser = res.locals.currentUser || u
        next()
        })
    }else if (req.signedCookies.userID){ // if the user previously checked remember me
        User.findById(req.signedCookies.userID, function(err, u){
            if (u && u.authenticated(req.signedCookies.rToken, u.rememberDigest)){
                req.session.userId = u._id // re logs in user by resetting session  
                res.locals.currentUser = res.locals.currentUser || u
                next()
            }
        })
    }
}) 
```

灵感来自 Micheal Hartl 的 Rails 书

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-21T13:58:47.783

如果有人像我一样来到这里，寻找传递隐式上下文并使用 express。

我最终为此使用了 express-http-context ( [https://www.npmjs.com/package/express-http-context](https://www.npmjs.com/package/express-http-context) )

从文档：

```
var express = require('express');
var httpContext = require('express-http-context');

var app = express();
// Use any third party middleware that does not need access to the context here, e.g. 
// app.use(some3rdParty.middleware);
app.use(httpContext.middleware);
// all code from here on has access to the same context for each request 
```

获取用户或您想要保留的任何数据：

```
// Example authorization middleware
app.use((req, res, next) => {
    userService.getUser(req.get('Authorization'), (err, result) => {
        if (err) {
            next(err);
        } else {
            httpContext.set('user', result.user)
            next();
        }
    });
}); 
```

在其他需要价值的地方：

```
var httpContext = require('express-http-context');

// Somewhere deep in the Todo Service
function createTodoItem(title, content, callback) {
    var user = httpContext.get('user');
    db.insert({ title, content, userId: user.id }, callback);
} 
```

# c# - 类似于 Python 的 defaultdict？

> ID：15622622
> 
> 赞同：14
> 
> 时间：2013-03-25T18:59:00.117
> 
> 标签：c#, .net

是否有 Python 的 .NET 类似物[`defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)？我发现编写短代码很有用，例如。计数频率：

```
>>> words = "to be or not to be".split()
>>> print words
['to', 'be', 'or', 'not', 'to', 'be']
>>> from collections import defaultdict
>>> frequencies = defaultdict(int)
>>> for word in words:
...     frequencies[word] += 1
... 
>>> print frequencies
defaultdict(<type 'int'>, {'not': 1, 'to': 2, 'or': 1, 'be': 2}) 
```

所以理想情况下，我可以在 C# 中编写：

```
var frequencies = new DefaultDictionary<string,int>(() => 0);
foreach(string word in words)
{
    frequencies[word] += 1
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-10-07T11:02:34.703

这是一个简单的实现：

```
public class DefaultDictionary<TKey, TValue> : Dictionary<TKey, TValue> where TValue : new()
{
    public new TValue this[TKey key]
    {
        get
        {
            TValue val;
            if (!TryGetValue(key, out val))
            {
                val = new TValue();
                Add(key, val);
            }
            return val;
        }
        set { base[key] = value; }
    }
} 
```

以及如何使用它：

```
var dict = new DefaultDictionary<string, int>();
Debug.WriteLine(dict["foo"]);  // prints "0"
dict["bar"] = 5;
Debug.WriteLine(dict["bar"]);  // prints "5" 
```

或者像这样：

```
var dict = new DefaultDictionary<string, List<int>>();
dict["foo"].Add(1);
dict["foo"].Add(2);
dict["foo"].Add(3); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T19:07:18.657

我认为没有等价物，但鉴于您的示例，您可以使用 LINQ 执行此操作：

```
var words = new List<string>{ "One", "Two", "Three", "One" };
var frequencies = words.GroupBy (w => w).ToDictionary (w => w.Key, w => w.Count()); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-25T19:17:30.577

让你开始的东西。我基本上只是改变了`this`索引器。由于我不知道 python 的完整功能，`defaultdict`我无法进一步改进它。您给定的示例将起作用。

```
public class DefaultDictionary<TKey, TValue> : IDictionary<TKey,TValue>
{
    private readonly Func<TValue> _defaultSelector;
    private readonly Dictionary<TKey, TValue> _values = new Dictionary<TKey, TValue>();

    public DefaultDictionary(Func<TValue> defaultSelector)
    {
        _defaultSelector = defaultSelector;
    }

    public IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator()
    {
        return _values.GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public void Add(KeyValuePair<TKey, TValue> item)
    {
        ((IDictionary<TKey,TValue>)_values).Add(item);
    }

    public void Clear()
    {
        _values.Clear();
    }

    public bool Contains(KeyValuePair<TKey, TValue> item)
    {
        return ((IDictionary<TKey,TValue>)_values).Contains(item);
    }

    public void CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex)
    {
        ((IDictionary<TKey, TValue>)_values).CopyTo(array, arrayIndex);
    }

    public bool Remove(KeyValuePair<TKey, TValue> item)
    {
        return ((IDictionary<TKey, TValue>)_values).Remove(item);
    }

    public int Count { get { return _values.Count; } }
    public bool IsReadOnly { get { return ((IDictionary<TKey, TValue>) _values).IsReadOnly; } }
    public bool ContainsKey(TKey key)
    {
        return _values.ContainsKey(key);
    }

    public void Add(TKey key, TValue value)
    {
        _values.Add(key, value);
    }

    public bool Remove(TKey key)
    {
        return _values.Remove(key);
    }

    public bool TryGetValue(TKey key, out TValue value)
    {
        return _values.TryGetValue(key, out value);
    }

    public TValue this[TKey key]
    {
        get
        {
            if (!_values.ContainsKey(key))
            {
                _values.Add(key, _defaultSelector());
            }
            return _values[key];
        }
        set
        {
            if(!_values.ContainsKey(key))
            {
                _values.Add(key, _defaultSelector());
            }
            _values[key] = value;
        }
    }

    public ICollection<TKey> Keys { get { return _values.Keys; } }
    public ICollection<TValue> Values { get { return _values.Values; } }

    public Dictionary<TKey, TValue> ToDictionary()
    {
        return new Dictionary<TKey, TValue>(_values);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-30T08:17:54.867

**ConcurrentDictionary** （在 System.Collections.Generic 中）的行为非常相似（尽管是为并发使用而设计的）

*   检索值：GetOrAdd 方法返回一个键的值，如果它不存在，则使用值工厂创建一个。

*   设置值： AddOrUpdate 方法更新一个值，或者如果它不存在则设置它

优点：

*   线程安全
*   完全控制默认值和更新步骤

缺点：

*   稍微冗长的语法

# r - qgraph：节点处的多个图像

> ID：15622627
> 
> 赞同：1
> 
> 时间：2013-03-25T18:59:27.550
> 
> 标签：r, r-lavaan, r-qgraph

我最近一直在使用`Lavaan`R 中的包进行结构方程建模，并在生成路径图时使用该`semPlot`包，这似乎是从.`qgraph`

我发现它`qgraph`支持将图像（例如 jpeg 和 png）绘制为节点。

我的问题是是否有可能，如果可以，如何为路径图中的每个节点绘制不同的图像。我希望能够使用我研究项目的图片来填写路径图上的清单变量。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:38:05.013

并感谢您查看 semPlot（它仍处于非常发展的状态）。你当然可以做到这一点。确实 semPlot 搭载了 qgraph，实际上它基本上是 qgraph 的前端并返回一个 qgraph 对象。您可以将参数发送到 qgraph 或使用不同的参数再次绘制结果。例如：

```
library("lavaan")

# Example 5.8 from mplus user guide:
Data <- read.table("http://www.statmodel.com/usersguide/chap5/ex5.8.dat")
names(Data) <- c(paste("y", 1:6, sep=""),
                 paste("x", 1:3, sep=""))

# Model:
model.Lavaan <- 'f1 =~ y1 + y2 + y3
f2 =~ y4 + y5 + y6
f1 + f2 ~ x1 + x2 + x3 '

# Run Lavaan:
library("lavaan")
fit <- lavaan:::cfa(model.Lavaan, data=Data, std.lv=TRUE)

# Download R logo:
download.file("http://cran.r-project.org/Rlogo.jpg", file <- tempfile(fileext = ".jpg"), 
              mode = "wb")

# Plot path diagram and store qgraph object:
Graph <- semPaths(fit,title=FALSE, curvePivot = TRUE)

# plot qgraph again with images:
qgraph(Graph, images = file, labels = FALSE) 
```

如果您想为每个节点使用不同的图像，您可以为图像提供一个向量，其中包含按节点顺序排列的每个节点的图像文件名。要找出节点顺序，您可以执行以下操作：

```
# To see which nodes are which:
Graph$graphAttributes$Nodes$labels 
```

# java - Google checkout IPN，“Requesting Notifications”返回“OK”而不是消息数据

> ID：15622628
> 
> 赞同：0
> 
> 时间：2013-03-25T18:59:33.903
> 
> 标签：java, google-checkout

我正在使用沙盒“通知序列号”节点。我承认很好并得到了序列号。当我按照“请求通知”中的描述获取消息时，我会收到两个字母的响应正文：OK .. 相反，我需要通知消息。

[https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Notification_API#responding_to_notifications](https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Notification_API#responding_to_notifications)

这是我的代码：

```
public static enum Account {
    sandbox, production;
    String merchantId, merchantKey, url;
    static {
        sandbox.merchantId = "9999999999999999";
        sandbox.merchantKey = "Ran0mUPPERlowerCaArAcTeRs";
        sandbox.url = "https://sandbox.google.com/checkout/";
        production.merchantId = "...";
        production.merchantKey = "...";
        production.url = "https://checkout.google.com/";
    }
}

// https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Notification_API
    //notification api entry-point
    public static void sandbox() throws IOException, GoogleCheckoutException,
            ParseException {

        String sn = request.params.get("serial-number");
        if (sn == null)
            error();//playframework sends an error response code

        //GoogleCheckoutApi.Account.sandbox is an enum with my information
        //try to process first (or exception), then confirm below
        processNotification(GoogleCheckoutApi.Account.sandbox, sn);

        // confirm request
        // https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Notification_API#responding_to_notifications

        String s = "<notification-acknowledgment xmlns=\"http://checkout.google.com/schema/2\" serial-number=\""
                + sn + "\" />";
        response.out.write(s.getBytes());
    }

static final String URL_REPORTS_FORM = "api/checkout/v2/reportsForm/Merchant/";

public static void processNotification(Account account, final String sn)
            throws IOException, GoogleCheckoutException, ParseException {

        System.out.println(new Date() + "\tGoogle Notification IN\t" + sn);
        Map<String, String> parms = new HashMap<String, String>() {
            {
                put("_type", "notification-history-request");
                put("serial-number", sn);

            }
        };
        HttpURLConnection c = requestPost(account.url + URL_REPORTS_FORM
                + account.merchantId, authProperties(account), parms, null);

        try {
            if (c.getResponseCode() != 200)
                throw new GoogleCheckoutException("Error Response Code "
                        + c.getResponseCode() + " from google API\n"
                        + c.getResponseMessage());

            handleResponse(account, c.getResponseMessage());

        } finally {
            c.disconnect();
        }
    }

private static void handleResponse(Account account, String responseMessage)
        throws IOException, ParseException {

    if (responseMessage.equals("OK")) {
        System.out.println(new Date() + "\tGoogle Notification IN\tOK");
        return;
    }

    //...other code to log and save the message...
}

//...requestPost seems to work fine.  I know I'm authenticating correctly.
public static HttpURLConnection requestPost(String requestURL,
        Map<String, String> properties, Map<String, String> params,
        String content) throws IOException {
    // derived from
    // http://www.codejava.net/java-se/networking/an-http-utility-class-to-send-getpost-request
    URL url = new URL(requestURL);
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();

    connection.setDoInput(true);
    connection.setInstanceFollowRedirects(false);
    connection.setRequestMethod("POST");
    if (properties != null)
        for (String key : properties.keySet()) {
            String value = properties.get(key);
            connection.setRequestProperty(key, value);
        }

    connection.setUseCaches(false);
    if (params != null && params.size() > 0) {
        StringBuffer requestParams = new StringBuffer();
        for (String key : params.keySet()) {
            String value = params.get(key);
            requestParams.append(URLEncoder.encode(key, "UTF-8"));
            if (value != null)
                requestParams.append("=").append(
                        URLEncoder.encode(value, "UTF-8"));

            requestParams.append("&");
        }
        // remove &
        requestParams.setLength(requestParams.length() - 1);//
        connection.setDoOutput(true);
        connection.setRequestProperty("Content-Length", String
                .valueOf(requestParams.length()));

        OutputStreamWriter writer = new OutputStreamWriter(connection
                .getOutputStream());

        writer.write(requestParams.toString());
        writer.close();
    } else if (content != null) {
        connection.setDoOutput(true);
        // sends POST data
        connection.setRequestProperty("Content-Length", String
                .valueOf(content.length()));

        OutputStreamWriter writer = new OutputStreamWriter(connection
                .getOutputStream());

        writer.write(content);
        writer.close();
    }
    return connection;
}
static final BASE64Encoder encoder = new BASE64Encoder();
private static Map<String, String> authProperties(final Account account) {
    return new HashMap<String, String>() {
        {
            put("Content-Type", "application/xml; charset=UTF-8");
            put("Accept", "application/xml; charset=UTF-8");
            put(
                    "Authorization",
                    "Basic "
                            + encoder
                                    .encode((account.merchantId + ":" + account.merchantKey)
                                            .getBytes()));
        }
    };
} 
```

此代码输出：

```
Wed Mar 20 17:57:39 UTC 2013    Google Notification IN  748115991100000-00005-6
Wed Mar 20 17:57:39 UTC 2013    Google Notification IN  OK 
```

我期待看到整个消息，而不是“OK”。

# javascript - 拼接/排序数组时如何保留 jQuery DOM 元素引用？

> ID：15622630
> 
> 赞同：0
> 
> 时间：2013-03-25T18:59:47.140
> 
> 标签：javascript, jquery

我有一个对象数组。这些对象的属性之一是对 DOM 元素的 jQuery 引用，该元素可能在任何给定时间实际附加到 DOM，也可能不附加到 DOM；

例如：

```
Array = [{
      name : 'whatever 1',
      element : $('<div id="item_1" class="item"><img src="" /></div>')
},
{
     name : 'whatever 2',
     element : $('<div id="item_2" class="item"><img src="" /></div>')
}]; 
```

当这个数组保持不变时，我可以毫无问题地将这些元素分离并附加到 DOM，并在元素上使用标准的 jQuery 方法。

例如：

```
Array[0].element.find('img'); 
```

...会正常工作。

但是，如果我对这个数组进行排序或拼接，我会丢失引用。

我理解发生这种情况的原因，但我想知道的是，是否存在这样的情况，以便在对整个数组本身进行排序或拼接时，可以不断地更改、附加、分离、修改该元素？

提前致谢。

编辑：

这是我的重新排列功能的代码示例：

```
 rearrangeItems : function(){
                        var self = this;

                        var offset = 0;

                        // get number of items that are less than insertindex
                        for(var i = 0; i < self.cache.selecteditems.length; i++) {
                                  if(self.cache.selecteditems[i] < self.cache.rearrangepos){
                                      offset++;
                                  }

                        }

//subtract the offset from the intended insertion index

            var rearrangeindex = self.cache.rearrangepos - offset;

            var removedItems = [];

//sort the selected element indexes into ascending order
            self.cache.selecteditems.sort(function (a, b) {
                if (a < b) return -1;
                else if (b < a) return 1;
                return 0;
            });

//remove the selected array elemens from the overall array and push them into the temporary array    
            for(var i = 0; i < self.cache.selecteditems.length; i++) {
                var index = self.cache.selecteditems[i];
                removedItems.push(self.cache.items.splice(index - removedItems.length, 1)[0]);
            }

//Add the selected array elements back into the main array at the correct insertion point
            self.cache.items.splice.apply(self.cache.items, [rearrangeindex, 0].concat(removedItems));

    } 
```

调用此函数时，所有数组元素都按预期重新排序。

在重新排序之前，我可以执行以下操作：

```
self.cache.items[index].html.find('img'); 
```

然而，之后，它将导致一个空对象（html 属性等同于我上面示例中的 element 属性）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:05:46.250

我会使用 ID，因为你有一个。不知道这是否是最干净的解决方案，但它会起作用。

像这样调用你的例子：

```
$('#' + Array[0].element.attr('id')).find('img'); 
```

希望这对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:56:03.843

可悲的是，这归因于我自己的愚蠢。在我的代码中，我错误地引用了该元素。

我实际上是在做以下事情：

```
self.cache.items[index].html.find('#image_' + index); 
```

在重新排序元素之后，我故意在之后重置索引，因此在排序/重新排序之后调用它时，元素不正确。

通过切换到类选择器，一切都得到了修复。

```
self.cache.items[index].html.find('.image_item'); 
```

多么尴尬！我向所有人道歉。

# three.js - three.js 将 equirectangular 视频转换为立方体全景视频？

> ID：15622634
> 
> 赞同：1
> 
> 时间：2013-03-25T19:00:08.347
> 
> 标签：three.js

在这里遇到了这个例子

[http://mrdoob.github.com/three.js/examples/webgl_panorama_equirectangular.html](http://mrdoob.github.com/three.js/examples/webgl_panorama_equirectangular.html)

想知道如果源是具有等角投影的视频，而不是静止图像，是否可能发生同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T00:48:12.040

是的。这个例子展示了如何： http: [//mrdoob.github.com/three.js/examples/webgl_materials_cubemap_dynamic2.html](http://mrdoob.github.com/three.js/examples/webgl_materials_cubemap_dynamic2.html)

# java - 使用 JSTL 自动完成

> ID：15622635
> 
> 赞同：0
> 
> 时间：2013-03-25T19:00:09.030
> 
> 标签：java, jsp, jstl

不确定是否有可能，如果我有以下 autoComplete 代码，我如何在 jstl 代码中使用它来实现相同的功能？或者有没有其他方法可以实现这一目标？

```
<input type="text" id="department" name="department"/>

<script>
    $("#department").autocomplete("getdept.jsp",{minChars: 4});
</script> 
```

并且在`getdept.jsp`

```
DepartmentMB dept = new DepartmentMB ();
String query = request.getParameter("q");
List<String> dep = dept.getData(query);

Iterator<String> iterator = dep .iterator();
while(iterator.hasNext()) {
    String department = (String)iterator.next();
    String deptName=(String)it.next();
    out.println(deptName);

} 
```

# c - 从 void，C 返回数组 []

> ID：15622644
> 
> 赞同：0
> 
> 时间：2013-03-25T19:00:36.673
> 
> 标签：c, arrays, void

所以当我写一个函数

```
void sort (int oldarray[], int length)
{

//imagine there is a function here that runs a loop and finishes with a sorted:

newarray[];
} 
```

如何让 newarray[] 替换主函数中的 oldarray[]，如下所示：

```
int main()
{
int length = 7
int oldarray[length]

//here would be a loop that populates the oldarray

sort(oldarray[], length)

//a loop that prints the newarray[] from the sort or main function
} 
```

仅供参考，这不是家庭作业。我是在自学，所以你不会帮我骗取教授的血汗钱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:07:32.853

您不想将 [] 放在您的排序电话中：

```
sort(oldarray, length) 
```

如果你真的不想从排序函数返回任何东西，而不是传入一个数组，这实际上只是一个指针，你想传入一个指向指针的指针，然后重新分配指针指向的内容（唷）。像这样：

```
int ** pointer_to_arr = &old; //& gives address of old
sort(pointer_to_arr, length); 
```

排序：

```
sort(int** arr, int len) {
    //you need to malloc the new array if you don't want it
    //to go away on function return:
    int* new_array = (int*) malloc(len*sizeof(int));
    //... sort here into new_array ...
    *arr = new_array; //set arr to the newly sorted array 
} 
```

您现在可以从 pointer_to_old 访问 new_array：

```
int* new_array = *pointer_to_arr;
 //... do what you will
//don't forget to release you memory when you're done
free (new_array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:18:49.170

以下是基于 Aniket 的回答，但经过简化：

```
#include <stdio.h>
#include <stdlib.h> 

void sort (int *oldarray, int *newarray, int length)
{
    // do your stuff, and put result in newarray
}

int main()
{
    int length = 7;
    int oldarray[length];
    int newarray[length];

    // here would be a loop that populates the oldarray

    sort(oldarray, newarray, length);

    // a loop that prints the newarray from the sort or main function

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:05:26.903

```
void sort (int *oldarray, int length, int *newarray, int *newlength)
{

//imagine there is a function here that runs a loop and finishes with a sorted:

//newarray after sorting can be passed to `main` function - even if the function returns void
// also remember to set the `newlength`
}

int main()
{
  int newlength;
  int *newarray = malloc(7 * sizeof(int));
  int length = 7
  int oldarray[length]

  //here would be a loop that populates the oldarray

  sort(oldarray[], length, newarray, &newlength)

  //a loop that prints the newarray[] from the sort or main function
  free(newarray);
  return 0;
} 
```

# tfs - 显式积压节点，还是根节点作为积压节点？

> ID：15622645
> 
> 赞同：0
> 
> 时间：2013-03-25T19:00:41.497
> 
> 标签：tfs, workitem, areas, backlog

是否有任何理由更喜欢 TFS 中的显式积压区域或迭代节点，而不是仅使用根节点？这是否改善了任何报告或任何东西的功能？它们中的任何一个都提供更容易的可管理性吗？

我已经看到了这两种方式，我希望看到有关权衡的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T22:11:24.167

对区域路径使用不同的节点：

团队的概念是在 TFS 2012 中引入的。每个团队都可以拥有自己的主页 Web 访问页面以及自己的待办事项。每个团队都可能绑定到特定的区域路径，您可以将他们的积压设置到特定的区域节点以过滤积压查询。您甚至可以连接到 Visual Studio 2012 中的特定团队，因此工作项也会在 IDE 环境中被过滤掉。

为迭代路径使用不同的节点：

团队可以将他们的迭代分解为版本。即 sprint 1-10 可以用于发布 1，sprint 11-20 可以用于发布 2。这将为您提供发布燃尽图以及冲刺燃尽图。这实际上取决于您如何开发软件和团队使用的流程。

这些只是几个例子，因为可能性是无穷无尽的。您还可以将团队与区域路径以外的不同领域联系起来，并有一个集中的积压工作，然后委派给团队。这是 Martin Hinshelwood 关于这个特定主题的博客文章：http: [//blogs.msdn.com/b/greggboer/archive/2012/01/27/tfs-vnext-configuring-your-project-to-have-a -master-backlog-and-sub-teams.aspx](http://blogs.msdn.com/b/greggboer/archive/2012/01/27/tfs-vnext-configuring-your-project-to-have-a-master-backlog-and-sub-teams.aspx)

# wordpress - Fishpig Wordpress Magento 集成 - 获取所有作者的列表

> ID：15622646
> 
> 赞同：0
> 
> 时间：2013-03-25T19:00:42.627
> 
> 标签：wordpress, magento, fishpig

我正在使用 Magento 1.7.0.2 和 Fishpig Wordpress 完全集成扩展 v. 2.5.0.9

我想在我的 WP 集成 Magento 博客上列出**所有博客作者。**我希望它自动完成，因此只要出现新的 WP 作者，列表就会更新。

有人建议我如何使用 Fishpig 功能提取一组作者及其信息（姓名、描述等）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T10:55:25.977

您可以使用以下代码检索作者集合：

```
<?php $authors = Mage::getResourceModel('wordpress/user_collection') ?> 
```

然后，您可以按如下方式列出这些：

```
<?php $authors = Mage::getResourceModel('wordpress/user_collection') ?>
<?php if (count($authors) > 0): ?>
    <ul>
    <?php foreach($authors as $author): ?>
        <li>
            <a href="<?php echo $author->getUrl() ?>"><?php echo $author->getDisplayName() ?></a>
        </li>
    <?php endforeach; ?>
    </ul>
<?php endif; ?> 
```

# c++ - 递归深度截止策略：并行快速排序

> ID：15622647
> 
> 赞同：0
> 
> 时间：2013-03-25T19:00:43.303
> 
> 标签：c++, algorithm, parallel-processing, openmp, quicksort

我实现了一个并行的快速排序算法。为了避免过多并行线程的开销，我有一个截止策略，当向量大小小于特定阈值时，将并行算法转换为顺序算法。但是，现在我正在尝试根据递归深度设置截止策略。即我希望我的算法在达到某个递归深度时变为顺序。我使用了以下代码，但它不起作用。我不确定如何进行。有任何想法吗？

```
template <class T>
void ParallelSort::sortHelper(typename vector<T>::iterator start, typename vector<T>::iterator end, int level =0) //THIS IS THE QUICKSoRT INTERFACE
{
  static int depth =0;

  const int insertThreshold = 20;
  const int threshold = 1000;
  if(start<end)
  {
    if(end-start < insertThreshold) //thresholf for insert sort
    {
      insertSort<T>(start, end);
    }
    else if((end-start) >= insertThreshold && depth<threshold) //threshhold for non parallel quicksort
    {
      int part = partition<T>(start,end);
      depth++;
      sortHelper<T>(start, start + (part - 1), level+1);
      depth--;
      depth++;
      sortHelper<T>(start + (part + 1), end, level+1);
      depth--;
    }
    else
    {
      int part = partition<T>(start,end);
      #pragma omp task
      {
        depth++;
        sortHelper<T>(start, start + (part - 1), level+1);
        depth--;
      }
      depth++;
      sortHelper<T>(start + (part + 1), end, level+1);
      depth--;
    }
  }
} 
```

我尝试了静态变量`depth`和非静态变量`level`，但它们都不起作用。注意：以上截图仅取决于`depth`. `level`包括在内以显示两种尝试的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:27:11.503

`static depth`从两个线程写入会使您的代码执行未指定的行为，因为未指定这些写入的作用。

碰巧的是，您正在传递 down `level`，这是您的递归深度。在每个级别，您将线程数加倍——因此级别等于 6（比如说）的限制最多对应于 2^6 个线程。您的代码只有一半并行，因为`partition`代码发生在主线程中，所以您可能会少于理论上同时运行的最大线程数。

```
template <class T>
void ParallelSort::sortHelper(typename vector<T>::iterator start, typename vector<T>::iterator end, int level =0) //THIS IS THE QUICKSoRT INTERFACE
{

  const int insertThreshold = 20;
  const int treeDepth = 6; // at most 2^6 = 64 tasks
  if(start<end)
  {
    if(end-start < insertThreshold) //thresholf for insert sort
    {
      insertSort<T>(start, end);
    }
    else if(level>=treeDepth) // only 2^treeDepth threads, after which we run in sequence
    {
      int part = partition<T>(start,end);
      sortHelper<T>(start, start + (part - 1), level+1);
      sortHelper<T>(start + (part + 1), end, level+1);
    }
    else // launch two tasks, creating an exponential number of threads:
    {
      int part = partition<T>(start,end);
      #pragma omp task
      {
        sortHelper<T>(start, start + (part - 1), level+1);
      }
      sortHelper<T>(start + (part + 1), end, level+1);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:46:31.663

好吧，我想通了。这是我的一个愚蠢的错误。

当堆栈大小大于某个阈值时，算法应该回退到顺序代码，**而不是更小**。这样做可以解决问题，并加快速度。

# pdf - PDF 如何存储文本

> ID：15622650
> 
> 赞同：10
> 
> 时间：2013-03-25T19:00:49.837
> 
> 标签：pdf, pdf-generation, text-extraction

我试图更好地理解 PDF 如何存储文本。一般来说，当从 MS Word（或在我的情况下为 SQL Server Reporting Services）等应用程序创建 PDF 时，PDF 如何存储文本？我希望生成的文档在这种特定情况下不会像原始 PDF 文档是从图像创建的那样进行 OCR。

为了更详细一点，我试图了解 PDF 的文本提取器是如何工作的。我对 PDF 的最初理解是它存储了（PostScript）关于如何将文档的“图像”绘制到页面或打印机的说明，并且文档本身中不包含实际的文本。随后，我认为文本提取器可能会对此类指令进行逆向工程，以生成 PDF 否则会生成的文本。不过，我对此没有信心。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-25T19:06:25.067

PDF 包含几种不同类型的对象；不仅是矢量或光栅绘图指令。尤其是文本由文本元素表示。其中包括应使用特定字体在某些位置绘制的字符串。

从 PDF 中提取文本可能是一件复杂的事情，因为文件格式面向页面布局。文本元素可以是整个段落，也可以是单个字符。如果混合了不同的字体，即使一个单词也可能包含多个文本元素。此外，字符不一定以标准编码（如 Unicode）进行编码。它们可能以特定于特定字体的方式编码。

如果您有幸处理带*标签的 PDF*文件，例如[PDF/A](http://en.wikipedia.org/wiki/PDF/A)或[PDF/UA](http://en.wikipedia.org/wiki/PDF/UA)，那么文本提取会容易得多，因为文本跨度是这样标识的，并且定义了到 Unicode 字符的映射。

维基百科没有完整的规范，但可以作为介绍：[http ://en.wikipedia.org/wiki/Portable_Document_Format#Text](http://en.wikipedia.org/wiki/Portable_Document_Format#Text)

# visual-studio-2010 - 如何将 Visual Studio 2010 与 DotNetNuke 社区版集成？

> ID：15622652
> 
> 赞同：-2
> 
> 时间：2013-03-25T19:00:59.087
> 
> 标签：visual-studio-2010, dotnetnuke

如何将 Visual Studio 2010 与 DotNetNuke 社区版集成？请向我解释清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:13:38.490

You will need to be building DNNModules. A guide on how to get going can be found here:

[http://www.dotnetnuke.com/Resources/Wiki/Page/Module-Development.aspx](http://www.dotnetnuke.com/Resources/Wiki/Page/Module-Development.aspx)

There is also a prebuilt DNNModule template which someone has developed here:

[http://dnnmodule.codeplex.com/](http://dnnmodule.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T20:32:51.567

我在[http://christoctemplate.codeplex.com/releases/view/93348](http://christoctemplate.codeplex.com/releases/view/93348)上有 Codeplex 上的 VS2010 模块开发模板。该项目的较新版本适用于 VS2012。

在 DNN 开发中，您通常不会打开 DNN 解决方案本身，而是打开模块和皮肤的单个项目。通过这种方式，您可以为平台创建和使用扩展，而不是修改平台本身。

如果您想对其进行更改，您可以打开 DNN 解决方案，但您应该小心进行更改，因为您最终会走下自己的分支，并且在您想要升级到新版本的 DNN 时遇到困难。

# php - 将多个值从 javascript 传递到 php 文件

> ID：15622653
> 
> 赞同：0
> 
> 时间：2013-03-25T19:01:02.807
> 
> 标签：php, javascript, html, mysql

我正在尝试将多个值传递给 javascript 函数“get2”，然后调用“data2.php”文件，以便根据下拉列表/文本框中提交的值从数据库中检索数据。两者分开工作但不能一起工作，我得到的错误是“未定义的索引”。任何人都可以帮助我吗？

```
<script type="text/javascript">
    function get2() { 
        $.post('data2.php', { gender: form2.gender.value },
            function(output) {
                $('#gender').html(output).show();
            }
        );
        $.post('data2.php', { skills: form2.skills.value },
            function(output) {
                $('#skills').html(output).show();
        });
    }

</script>
...
...
<form name="form2">
        <Select name="gender">
            <OPTION>Male</OPTION>
            <OPTION>Female</OPTION></SELECT>

What is the patients relationship status?
(hold "Ctrl" key to select multiple options at one time):
<br/><br/>
        <BR>
        <BR>
        <select name="skills">
            <OPTION value="Single" selected="selected">Single</OPTION>
            <OPTION value="With partner">With partner</OPTION>
            <OPTION value="Separated from partner">Separated from partner</OPTION>
            <OPTION value="Partner died">Partner died</OPTION>
        <OPTION value="DK">DK</OPTION>
        </select>
        <BR>
        <BR>
        <INPUT TYPE="button" VALUE="search" onClick="get2();">
</form>
<div id="gender"></div>
<div id="skills"></div> 
```

* * *

DATA2.PHP

```
<?php
mysql_connect("localhost", "root", "");
mysql_select_db("grist");

$gender = $_POST['gender'];
$skills =  $_POST['skills'];

if (($gender==NULL) && ($skills==NULL)) {
    echo"please enter gender and skills!";
    }
else 
{
    $dob4 = mysql_query("SELECT * FROM patients WHERE gender='$gender' AND relationship_status='$skills'");
    //$dob_num_rows = mysql_num_rows($dob);
    while($row4 = mysql_fetch_array($dob4)){
    $a=$row4['patient_id'];
    $b=$row4['gender'];
    $c=$row4['dob'];
        echo "<b>Patient:</b> $a";
        echo "<b>Patient:</b> $b";
        echo "<b>Patient:</b> $c";
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:10:11.367

这是您可以使用 POST 请求将两个值发送到页面的方法：

```
<script type="text/javascript">
    function get2() { 
        $.post('data2.php', { gender: form2.gender.value, 
                              skills: form2.skills.value },
            function(output) {
                $('#gender').html(output).show();
                $('#skills').html(output).show();
            }
        );
    }
</script> 
```

请注意，现在这会更新性别和技能元素。我不确定你想做什么；data2.php 要求/允许同时使用这两个参数。

您还应该清理用户输入：目前您容易受到 SQL 注入攻击。使用允许使用准备好的语句（例如 PDO）的数据库客户端库会更好。您正在使用的旧 mysql 库已被弃用，并将在某个时候从 PHP 中删除。

# java - Java 正则表达式中的 EOL

> ID：15622656
> 
> 赞同：-2
> 
> 时间：2013-03-25T19:01:16.717
> 
> 标签：java, regex

为什么在 Java 的正则表达式库中 EOL 在下一个命令中找到

```
Matcher matcher = Pattern.compile( "[\\\\r\\\\n$]+" ).matcher( " where " );
if ( matcher.find() )
{
// found reaction
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T19:05:49.373

这不是新行正则表达式。您实际上匹配以下字符之一 1 次或多次：`\`、`r`、`\`或. 在中，有一个，因此在字符串中找到了模式。`n``$``where``r`

新行正则表达式是`\r|\n|\r\n`. 在 JAVA 中，您需要转义反斜杠，因此它将是`\\r|\\n|\\r\\n`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:14:53.533

两个问题：

1.  正则表达式不正确，您只需要一个转义序列。模式是`\r`and `\n`，不是`\\r`and `\\n`。在 Java 中，您需要将它们转义一次，因此模式是`\\r`和`\\n`。
2.  您在 ( ) 中搜索的字符串`" where "`不包含任何回车 + 换行符（只是 \r）。

这将找到一个回车+换行：

```
Matcher matcher = Pattern.compile( "[\\r\\n$]+" ).matcher( " where \n" );
if ( matcher.find() ){
    System.out.println("found");
} 
```

# html - 拉伸视频？

> ID：15622657
> 
> 赞同：0
> 
> 时间：2013-03-25T19:01:17.090
> 
> 标签：html, video, html5-video, stretching

我正在尝试拉伸我拥有的视频。它必须拉伸 400 X 400。我尝试使用“stretchtofit” value="true" 但这不起作用，我需要将视频置于标题下方。我很好奇我用什么来拉伸视频？这是我的代码：

```
<!DOCTYPE html
   PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>Lab 8-3</title>

</head>
<body>

<div style="text-align: center">
    <img style="border: 0" src="magiclogo.png" width="325" height="88" alt="Logo" />
</div>

<div style="position: absolute; top: 110px; left: 310px">

    <object data="magicshow.wmv" height="400" width="400">
        <param name="showcontrols" value="false" />
        <param name="stretchtofit" value="true" />

    </object>

</div>

<object classid="clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6">

        <param name="URL" value="magicmusic.mp3" />
          <param name="uimode" value="invisible" />

    </object>   

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:09:00.707

你为什么不使用`<video>`标签。您可以轻松设置大小。

```
<video width="400" height="400" controls>
  <source src="movie.mp4" type="video/mp4">
</video> 
```

# nservicebus - nservicebus 和 eventstore

> ID：15622662
> 
> 赞同：1
> 
> 时间：2013-03-25T19:01:37.607
> 
> 标签：nservicebus, neventstore

我想知道是否有人以前遇到过这种情况：

我处理一个命令，在处理程序中，我将一个事件保存到事件存储区（joliver）。
在调度之后，再次处理相同命令的处理程序。
我知道它是相同的命令，因为命令上的 guid 是相同的。

五次尝试后，nservicebus 说由于最大重试次数，命令失败。
所以显然命令失败了，但我没有得到任何失败的迹象。我已将调度程序的内容放在 try catch 中，但没有捕获到错误。代码退出调度程序后，事件处理程序将始终触发，就好像发生了错误一样。

跟踪代码，将事件保存到数据库（我看到行），调度程序运行，并将 Dispatched 列设置为 true，然后处理程序再次处理命令，过程重复，并插入另一行进入提交表。

什么可能会失败？我没有在事件商店的某处设置成功标志吗？如果我将事件存储与 nServicebus 分离，两者都将按预期运行，不会重试和失败。

调度员：

```
 public void Dispatch(Commit commit)
    {
        for (var i = 0; i < commit.Events.Count; i++)
        {
            try
            {
                var eventMessage = commit.Events[i];
                var busMessage = (T)eventMessage.Body;
                //bus.Publish(busMessage);

            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
    } 
```

Wireup.Init()

```
 private static IStoreEvents WireupEventStore()
    {
        return Wireup.Init()
            .LogToOutputWindow()
            .UsingSqlPersistence("EventStore")
            .InitializeStorageEngine()
            .UsingBinarySerialization()
            //.UsingJsonSerialization()
            //    .Compress()
            //.UsingAsynchronousDispatchScheduler()
            //    .DispatchTo(new NServiceBusCommitDispatcher<T>())

           .UsingSynchronousDispatchScheduler()
               .DispatchTo(new DelegateMessageDispatcher(DispatchCommit))

            .Build();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:18:20.343

我在保存时打开了一个我从未关闭过的事务范围。

```
 public static void Save(AggregateRoot root)
    {
        // we can call CreateStream(StreamId) if we know there isn't going to be any data.
        // or we can call OpenStream(StreamId, 0, int.MaxValue) to read all commits,
        // if no commits exist then it creates a new stream for us.
        using (var scope = new TransactionScope())
        using (var eventStore = WireupEventStore())
        using (var stream = eventStore.OpenStream(root.Id, 0, int.MaxValue))
        {
            var events = root.GetUncommittedChanges();
            foreach (var e in events)
            {
                stream.Add(new EventMessage { Body = e });
            }

            var guid = Guid.NewGuid();
            stream.CommitChanges(guid);
            root.MarkChangesAsCommitted();

            scope.Complete(); // <-- missing this
        }
    } 
```

# python - 为什么 Pinax 项目中的应用程序没有出现？

> ID：15622665
> 
> 赞同：0
> 
> 时间：2013-03-25T19:01:50.293
> 
> 标签：python, django, social-networking, pinax

我越来越：

```
ImportError at /
No module named tribes.models
Request Method: GET
Request URL:    http://stornge.com:8000/
Django Version: 1.5
Exception Type: ImportError
Exception Value:    
No module named tribes.models
Exception Location: /home/jonathan/clay/apps/tribes/admin.py in <module>, line 3
Python Executable:  /home/jonathan/virtual_environment/bin/python
Python Version: 2.7.3
Python Path:    
['/home/jonathan/clay/apps',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/pinax/apps',
 '/home/jonathan/clay',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/distribute-0.6.24-py2.7.egg',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/pip-1.1-py2.7.egg',
 '/home/jonathan/virtual_environment/lib/python2.7',
 '/home/jonathan/virtual_environment/lib/python2.7/plat-linux2',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-tk',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-old',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-dynload',
 '/usr/lib/python2.7',
 '/usr/lib/python2.7/plat-linux2',
 '/usr/lib/python2.7/lib-tk',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/PIL']
Server time:    Mon, 25 Mar 2013 14:57:41 -0400 
```

这不是寻找部落。但是tribes 应用程序出现在 Python 路径的第一个条目中：

```
(virtual_environment)jonathan@li393-189:~/clay/apps/tribes$ ls -l
total 68
-rw-rw-r--  1 jonathan jonathan  215 Mar 25 15:05 admin.py
-rw-rw-r--  1 jonathan jonathan  580 Mar 25 18:55 admin.pyc
drwxrwxr-x  2 jonathan jonathan 4096 Mar 25 15:05 fixtures
-rw-rw-r--  1 jonathan jonathan 1561 Mar 25 15:05 forms.py
-rwxrwxr-x  1 jonathan jonathan    0 Mar 25 15:05 __init__.py
-rw-rw-r--  1 jonathan jonathan  130 Mar 25 15:05 __init__.pyc
drwxrwxr-x 11 jonathan jonathan 4096 Mar 25 15:05 locale
-rw-rw-r--  1 jonathan jonathan  904 Mar 25 15:05 management.py
-rw-rw-r--  1 jonathan jonathan 1221 Mar 25 17:14 management.pyc
drwxrwxr-x  3 jonathan jonathan 4096 Mar 25 15:05 media
-rwxrwxr-x  1 jonathan jonathan  539 Mar 25 15:05 models.py
-rw-rw-r--  1 jonathan jonathan 1177 Mar 25 15:05 models.pyc
drwxrwxr-x  3 jonathan jonathan 4096 Mar 25 15:05 templates
drwxrwxr-x  2 jonathan jonathan 4096 Mar 25 15:05 templatetags
drwxrwxr-x  2 jonathan jonathan 4096 Mar 25 15:05 tests
-rw-rw-r--  1 jonathan jonathan  865 Mar 25 15:05 urls.py
-rwxrwxr-x  1 jonathan jonathan 5693 Mar 25 15:05 views.py
(virtual_environment)jonathan@li393-189:~/clay/apps/tribes$ 
```

如何让应用程序/部落被识别为提供tribes.models？

# c# - 在过早通过时结束 MSTEST 测试

> ID：15622672
> 
> 赞同：2
> 
> 时间：2013-03-25T19:02:09.023
> 
> 标签：c#, mstest, specflow

有没有办法结束 mstest 过早通过而不运行其余的测试代码？

Assert.Inconclusive 最接近，但将测试标记为不确定，这对我来说会导致其他问题（电子邮件是根据测试状态生成的）。

我这样做是因为我在类中的其余测试之前运行 mstest 的代码，并且不想在它正常运行时运行它。基本上是这样的： [https ://groups.google.com/forum/?fromgroups=#!topic/specflow/6bzgl9LYOFI](https://groups.google.com/forum/?fromgroups=#!topic/specflow/6bzgl9LYOFI)

编辑：我通过忽略 feature_setup 部分找到了解决此问题的方法，因此它只会在我通过反射触发它时运行，并且作为正常 mstest 执行的一部分被忽略。

可悲的是，这个答案只适用于我在这里使用specflow和mstest的组合的非常具体的情况。我认为使用 return 是正常 mstest 的正确解决方案。

# .net - 将 JPG 图像嵌入 WPF 应用程序的问题

> ID：15622676
> 
> 赞同：0
> 
> 时间：2013-03-25T19:02:18.530
> 
> 标签：.net, wpf, deployment, resources, clickonce

无论我做什么，运行应用程序时都无法显示我的 jpeg 图像。我需要能够使用存在的所有图像部署此应用程序。

我的资源中有一个名为 BinOpticsLogo 的图像。它链接到此处的图像

> C:\Users\kyle.formeck\Documents\Visual Studio 2008\Projects\AOILibrary\VisualInspectionConsole\VisualInspectionConsole_currentFasterDBUploads\WaferTracker\binopticslogo_full.jpg。

此图像的属性是：

```
Build Action = Resource
Copy To Output Directory = Copy Always 
```

引用此图像的 XAML 代码：

```
 <Image 
        Source="binopticslogo_full.jpg"
        Height="23"/> 
```

在我的资源中，BinOpticsLogo 资源持久性属性设置为 Embedded in .resx

我在设计器中正确地看到了图像，但是当我运行应用程序时，我从来没有看到图像。

任何帮助将不胜感激！

-凯尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:24:39.347

Solved it!

Here is the updated XAML code that made it all work:

```
 <Image
        Height="23">
        <Image.Source>
            <ImageSource>/WaferTracker;component/Resources/BinOpticsLogo.jpg</ImageSource>
        </Image.Source>
    </Image> 
```

# javascript - jQuery 新手：此代码示例有问题吗？

> ID：15622678
> 
> 赞同：0
> 
> 时间：2013-03-25T19:02:24.167
> 
> 标签：javascript, jquery, html

我无法运行一些 jQuery，我认为它与我的`.js`文件有关。这是整个文件：

```
$(document).ready(function(){
$(".dropdown")
    .on('change keyup', colorizeSelect)
    .change();
});

function colorizeSelect(){
    if($(this).val() == "") $(this).addClass("dropdown_placeholder");
    else $(this).removeClass("dropdown_placeholder")
} 
```

我在这个网站上找到了这个样本，虽然它对我来说没有意义，但它应该可以工作。有人看到这有什么问题吗？我很确定我的 html 已正确设置以处理此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:05:43.007

发现问题，使用这段代码：

```
$(document).ready(function(){
    $(".dropdown").on('change keyup', colorizeSelect()).change();
});

function colorizeSelect(){
    if($(this).val() == "") $(this).addClass("dropdown_placeholder");
    else $(this).removeClass("dropdown_placeholder");
} 
```

# android - 边框样式应用程序加速器

> ID：15622684
> 
> 赞同：0
> 
> 时间：2013-03-25T19:03:05.980
> 
> 标签：android, titanium, textfield

我有以下代码，但结果与我认为的（ios 版本）完全不同。

我究竟做错了什么？

```
//creating the textfield for our loan amount input
var tfAmount = Titanium.UI.createTextField({
    width: 140,
    height: 30,
    top: 100,
    right: 20,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED,
    returnKeyType:Titanium.UI.RETURNKEY_DONE,
    hintText: '1000.00',
    keyboardToolbar: [flexSpace,buttonDone],
    keyboardType:Titanium.UI.KEYBOARD_PHONE_PAD
});
view.add(tfAmount); 
```

![在此处输入图像描述](../Images/63aeff73e530d9ba888fb16a40b8d296.png)

![在此处输入图像描述](../Images/99563c8bc48858a872eb208aee19d289.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T10:57:51.300

试试这个代码。它对我来说工作正常。

```
 var win = Titanium.UI.createWindow({
    backgroundColor : 'black'
});
var view = Titanium.UI.createView({
    backgroundColor : 'pink',
    top : '2%',
    height : '40%'
});
win.add(view);

/* Loan Label and TextField*/

var loanLabel = Titanium.UI.createLabel({
    top : '5%',
    left : '1%',
    width : Titanium.UI.SIZE,
    height : Titanium.UI.SIZE,
    color : 'black',
    text : 'Loan amount : $ ',
    font : {
        fontWeight : 'bold'
    }

})

view.add(loanLabel);
var loanAmount = Titanium.UI.createTextField({
    width : '50%',
    height : Titanium.UI.SIZE,
    top : '5%',
    //color: 'black',
    right : '1%',
    borderStyle : Titanium.UI.INPUT_BORDERSTYLE_ROUNDED,
    returnKeyType : Titanium.UI.RETURNKEY_DONE,
    hintText : '1000.00',
    keyboardType : Titanium.UI.KEYBOARD_PHONE_PAD
});
view.add(loanAmount);

/* Interest Rate Label and TextField*/
var irLabel = Titanium.UI.createLabel({
    top : '50%',
    left : '1%',
    width : Titanium.UI.SIZE,
    height : Titanium.UI.SIZE,
    color : 'black',
    text : 'Interest Rate : % ',
    font : {
        fontWeight : 'bold'
    }

})

view.add(irLabel);
var tfAmount = Titanium.UI.createTextField({
    width : '50%',
    height : Titanium.UI.SIZE,
    top : '50%',
    //color: 'black',
    right : '1%',
    borderStyle : Titanium.UI.INPUT_BORDERSTYLE_ROUNDED,
    returnKeyType : Titanium.UI.RETURNKEY_DONE,
    value : '6',
    borderColor : 'none',
    font : {
        fontWeight : 'bold'
    },
    keyboardType : Titanium.UI.KEYBOARD_PHONE_PAD
});
view.add(tfAmount);

win.open(); 
```

# c - 从文件中读取 7 个变量（每个变量 1 行）并分配给结构变量

> ID：15622686
> 
> 赞同：-1
> 
> 时间：2013-03-25T19:03:13.273
> 
> 标签：c, file, input, struct, stream

我正在制作一个简单的注册系统，该系统维护一个包含计算机科学专业学生的数据库。每个学生记录包含

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct student
{

   char name[300];   
   int age;
   char course_1[40];
   char course_2[40];
   char *remarks;

};

struct course

{

   char course_title[200];
   int  cse_num[100];
   char instructor[200];
   char date[50];
   char start_time[50];
   char end_time[50];
   char location[50];

};

main()

{

  int i;
  struct course data[11];
  FILE *f;
  char title[100];
  int num[100];
  char instructor[100];
  char date[100];
  char start_time[100];
  char end_time[100];
  char location[100];
  char line[300];

  f = fopen("course.dat", "r");

  i=0;

  while(*fgets(line, 300, f) != '\n')

  {
      sscanf(line, "%99[^\n]", num);
      sscanf(line, "%99[^\n]", title);
      sscanf(line, "%99[^\n]", instructor);
      sscanf(line, "%99[^\n]", date);
      sscanf(line, "%99[^\n]", start_time);
      sscanf(line, "%99[^\n]", end_time);
      sscanf(line, "%99[^\n]", location);

      data[i].cse_num = num // doesn't work

      strcpy(data[i].course_title, title);
      strcpy(data[i].instructor, instructor);
      strcpy(data[i].date, date);
      strcpy(data[i].start_time, start_time);
      strcpy(data[i].end_time, end_time);
      strcpy(data[i].location, location);

      i++;

  }

  fclose(f);

} 
```

***我的问题是如何从文件中获取输入，因为它是 7 行，直到考虑新行。我尽力解释了这一点，如果你能帮助我，谢谢！老实说，我真的很专注于这一点，只是无法弄清楚。这是文件：***

示例输入：

```
CSE1001
Research Directions in Computing
Wildes, Richard
W
16:30
17:30
VC 135 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:29:20.040

别忘了，你也必须`strcpy(data[i].course_title, title);`

这适用于所有字符串。

您目前正在这样做：`data[i].course_title = title;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:25:25.493

考虑使用[scanf](https://stackoverflow.com/tags/scanf/info "扫描")。这是一个通用函数，用于解析来自终端或带有`fscanf`变体的文件的输入。它已经是您将要包含的库的一部分，并且在格式上`printf`与您将使用很多程序输出的格式相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:27:34.723

你误报了`main()`：

```
struct course
{
    char course_title[200];
    int  cse_num[100];
    char instructor[200];
    char date[50];
    char start_time[50];
    char end_time[50];
    char location[50];
}

main()
{ 
```

这表示`main()`返回一个`struct course`. 那是错误的。

1.  在结构后添加分号。
2.  始终为每个函数提供显式类型。C99 需要它；这是 C89 的好习惯。

代码应该开始：

```
struct course
{
    char course_title[200];
    int  cse_num[100];
    char instructor[200];
    char date[50];
    char start_time[50];
    char end_time[50];
    char location[50];
};

int main(void)
{ 
```

您应该从 C 编译器收到有关此错误的警告。如果不是，您要么需要打开警告，要么需要获得更好的编译器。

这可能与您面临的其他问题直接相关，也可能不直接相关，但应该解决。

# unix - Unix 查找和移动命令

> ID：15622687
> 
> 赞同：0
> 
> 时间：2013-03-25T19:03:14.387
> 
> 标签：unix

我需要一个 Unix 命令来查找所有超过 3 天的文本文件，并在单个命令中将它们移动到其他位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:07:55.733

在这种情况下，您需要查找并使用它的 -exec 和 -mtime 标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:18:14.847

它应该是这样的：

```
find . -mtime -3 -type f -print0 | xargs -0 -I file mv file /new/dir/. 
```

[男人发现](http://linux.die.net/man/1/find)

[人 xargs](http://linux.die.net/man/1/xargs)

# xcode - xcode 无法获取声音文件以使用 AVAudioPlayer 播放

> ID：15622694
> 
> 赞同：3
> 
> 时间：2013-03-25T19:03:38.747
> 
> 标签：xcode, audio, avaudioplayer

我是 iOS 新手，正在尝试为我的应用程序添加声音。我已经遵循了几个关于在我的项目中添加一个简单的声音文件的教程，但结果都是一样的。我没有错误，但没有声音播放。关于我做错了什么的任何想法？任何帮助，将不胜感激！

```
- (IBAction)playSound:(id)sender {

    NSString *soundFilePath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"mp3"];
    NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];
    NSLog(soundFilePath);

    NSError *error;
    AVAudioPlayer *player = [[AVAudioPlayer alloc] initWithContentsOfURL:soundFileURL error:&error];
    player.numberOfLoops = 1; 

    [player play];

 } 
```

*********更新****** ******

 **所以我对上面的代码从来没有任何运气，这非常令人沮丧，但我最终还是使用 AudioToolbox 框架让它工作，使用这个：

```
SystemSoundID soundID;
NSString *soundFile = [[NSBundle mainBundle]
                       pathForResource:@"test" ofType:@"mp3"];
AudioServicesCreateSystemSoundID((__bridge  CFURLRef)
                                 [NSURL fileURLWithPath:soundFile], & soundID);
AudioServicesPlaySystemSound(soundID); 
```

谁能向我解释其中的区别，为什么这个有效而另一个无效？我比什么都好奇。希望得到一些澄清。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T19:20:33.723

终于想通了。我需要在我的头文件中为 AVAudioPlayer 创建一个属性才能让它工作。这是我所做的：

```
// .h file
@interface ThirdViewController : UIViewController {

    AVAudioPlayer *audioPlayer;

}
@property (nonatomic, retain) AVAudioPlayer *audioPlayer;

- (void) playSound     //method in .m file
{
    NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] 
                                          pathForResource:@"test" 
                                          ofType:@"mp3"]];
    NSError *error;
    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
    [audioPlayer play];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T14:25:54.123

确保安装了quartz.h，或支持音频播放器的特定框架。仔细检查一下。

不久前有同样的问题，必须正确安装框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:13:57.147

通过执行以下操作来简化您的代码。还将您的 test.mp3 放到 xcode 中项目目录的根目录中。您的 mp3 放置和位置非常重要。还要确保音量已调高，振动已关闭您的设备，并且已取消静音。

```
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                     pathForResource:@"test"
                                     ofType:@"mp3"]];

AVAudioPlayer *audioPlayer = [[AVAudioPlayer alloc]
                              initWithContentsOfURL:url
                              error:nil];
[audioPlayer play]; 
```**

# sql - 使用存储过程执行相同的查询两个不同的数据库

> ID：15622697
> 
> 赞同：1
> 
> 时间：2013-03-25T19:03:55.883
> 
> 标签：sql, sql-server-2008

如何使用基于变量（参数）的存储过程在同一服务器中使用两个不同的数据库执行相同的查询？

由于我使用它的方式，这必须在存储过程中完成。信息存储在两个数据库上的相同表名中。我需要基于变量的结果是动态的。如果输入 X 变量，则需要从数据库 A 中读取，但如果输入 Y，则需要从数据库 B 中读取。

我现在所拥有的只是一个有效的查询，每次都会更改 dbo。我花了很多时间寻找答案，但我找不到任何东西。谁能帮我开始？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T19:07:46.670

您可以使用参数并检查 where 子句并决定从哪个数据库表中选择数据试试这个

```
--assuming both tables have same table structure
select * from database1.dbo.table where 'x' = @param1
union all
select * from database2.dbo.table where 'y' = @param1 
```

或者

```
if (@param1 = 'x') 
begin
  select * from database1.dbo.table 
end
else if (@param1 = 'y')
begin
  select * from database2.dbo.table
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:16:49.440

您需要的是**4 部分命名约定**和**动态构造您的查询语句**。而且，如果您的数据库不在同一台服务器上，您将需要**链接服务器**或使用**OpenRowset。**

假设：您的数据库位于同一台服务器上，那么在您的存储过程中，您将需要一个参数来接受数据库名称@dbname。

```
 declare @sql varchar(max)
set @sql = 'select * from '+ @dbname + '.dbo.tablename'
exec(@sql) 
```

如果你的数据库位于不同的服务器，那么首先创建链接服务器，然后使用链接服务器，或者直接使用openrowset。在您的存储过程中，您将需要 @serverName 和 @DBName

```
 declare @sql varchar(max)
set @sql = 'select * from ' + @ServerName + '.' + @DBName + '.dbo.tablename'
exec(@sql) 
```

注意：这里，@servername 是您创建链接服务器时的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:15:45.127

另一种选择是动态 SQL。

```
DECLARE @sql NVARCHAR(MAX) = N'SELECT
  col FROM [Database' 
    + CASE @param WHEN 'X' THEN 'A' ELSE 'B' END + '].dbo.table
    WHERE ...';

EXEC sp_executesql @sql; 
```

如果要连接，请说：

```
+ ' WHERE somecol <= dateadd(DAY, 1, ' + @DATE + '))'; 
```

那么是的，你会得到一个错误（但不是你指出的那个）。很难判断您在 pastebin 代码中的哪个位置出现错误，因为它没有任何动态 SQL。但是，您应该使用强类型参数而不是上述模式，例如

```
DECLARE @date DATE = '2013-03-11'; -- no m/d/y ugliness please

DECLARE @sql NVARCHAR(MAX) = N'SELECT
  col FROM [Database' 
    + CASE @param WHEN 'X' THEN 'A' ELSE 'B' END + '].dbo.table
    WHERE somecol <= dateadd(DAY, 1, @date_param))';

EXEC sp_executesql @sql, N'@date_param DATE', @date; 
```

我更改了变量名，以便您看到它是如何传入的。

**编辑**您要整理的新粘贴箱，您需要更改：

```
EXEC sp_executesql @SQL, N'@date_param DATE', @DATE; 
```

至：

```
EXEC sp_executesql 
  @SQL, -- unparameterized command
  N'@USERID VARCHAR(100), @OURORDERDATE DATE', -- param list
  @USERID,       -- param 1
  @OURORDERDATE; -- param 2 
```

解开更多的纱线和拉更多的牙齿，也许你在这之后，假设用户 X 和 Y 在 database1 中，其他用户在 database2 中：

```
DECLARE @sql NVARCHAR(MAX) = N'USE Database' 
  + CASE WHEN @UserID IN ('X','Y') THEN '1' ELSE '2' END
  + ';';

SELECT ...all the join stuff from your pastebin...
WHERE  (TABEL2.SOLDTOCUSTID = @USERID)
    and TABEL2.OURORDERDATE >= DATEADD(YEAR, DATEDIFF(YEAR, 0, GETDATE()), 0)
    and (TABEL2.OURORDERDATE <= dateadd(day, 1, @OURORDERDATE));';

EXEC sp_executesql 
  @SQL, -- unparameterized command
  N'@USERID VARCHAR(100), @OURORDERDATE DATE', -- param list
  @USERID,       -- param 1
  @OURORDERDATE; -- param 2 
```

# ios - 尝试实现一个代表，在导航栏中按下后退按钮时发出信号 - 我做错了什么？

> ID：15622699
> 
> 赞同：1
> 
> 时间：2013-03-25T19:04:05.367
> 
> 标签：ios, objective-c, ios5, ios6, delegates

我有一个主要的文章列表，单击一篇文章后，它会转到阅读视图控制器，在那里我使用具有 NSNumber 属性的视图控制器来跟踪用户的阅读进度。当他们按下后退按钮时，我想将此位置更新回根视图控制器（以便我可以向他们展示他们的进度），但我的代表似乎没有工作。

在阅读视图的 .h 文件中：

```
@property (nonatomic, weak) id<UpdateProgressDelegate> delegate;

...

@protocol UpdateProgressDelegate <NSObject>

@required
- (void)finishedReadingWithPosition:(NSNumber *)position;

@end 
```

在 .m 文件中：

```
- (void)viewDidDisappear:(BOOL)animated {
    [super viewWillDisappear:YES];

    if ([self.delegate respondsToSelector:@selector(finishedReading:)]) {
        [self.delegate finishedReadingWithPosition:self.position];
    }
} 
```

在我的根视图中（注意它确实实现了协议）：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"ReadBasicArticleSegue"] || [segue.identifier isEqualToString:@"ReadFullArticleSegue"]) {
        ReadingViewController *destination = segue.destinationViewController;

        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
        self.rowOfLastSelectedCell = @(indexPath.row);
        Article *article = self.articles[[self.rowOfLastSelectedCell intValue]];

        // Set ReadingViewController's variables so the selected article can be read
        destination.textToRead = [article.body componentsSeparatedByString:@" "];
        destination.wordsPerMinute = @(1500);
        destination.numberOfWordsShown = @(3);

        destination.delegate = self;
    }
} 
```

和...

```
- (void)finishedReadingWithPosition:(NSNumber *)position {
    Article *article = [self.articles objectAtIndex:[self.rowOfLastSelectedCell intValue]];
    article.position = position;

    [self.tableView reloadData];
} 
```

我只是不明白我做错了什么。当我按下后退按钮时，根视图控制器仍然有一个 0% 的进度指示器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T23:40:56.193

这里：

```
- (void)viewDidDisappear:(BOOL)animated {
    [super viewWillDisappear:YES];

    if ([self.delegate respondsToSelector:@selector(finishedReading:)]) {
        [self.delegate finishedReadingWithPosition:self.position];
    }
} 
```

*   `viewDidDisappear:`应该将相同的 'did' 方法传递给`super`，而不是`viewWillDisappear:`..
    `[super viewDidDisappear:animated];`

*   选择器`finishedReading:`与选择器不同`finishedReadingWithPosition:`。由于它没有在委托中实现，因此不会调用条件。

错别字 - 或解决方案......？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T00:56:15.123

两件快速的事情：

首先，在您的委托响应选择器检查中，确保您正在测试正确的方法。您在检查中有“finishedReading：”，然后在方法调用中调用finishedREadingWithPosition：“。我的猜测是它跳过了该行，因为它是您检查的错误选择器。

接下来确保 self.position 有一个值，并且：我同意提到 @He 的 [super] 调用 - 需要调用相同的方法

# physics - 在不同的屏幕分辨率上电晕相同的物理运动

> ID：15622706
> 
> 赞同：2
> 
> 时间：2013-03-25T19:04:34.063
> 
> 标签：physics, resolution, coronasdk, game-physics

我正在开发一个游戏，作为教程，学习经验

规格摘要：

*   想象一下像冰球这样的东西，但场地上有静态障碍物（图钉）。
*   回合制，每个球员通过拖动球并在相反方向施加线性脉冲来射击
*   所有这些都是多人游戏

基本上，在你投篮后，你告诉其他球员的应用程序必须对球施加“这个”力。考虑到它是同一个引擎，我想我会在两个设备上得到相同的结果，因此唯一的通信将涉及在适当的时候发送力参数。只要他们有相同的分辨率，这是正确的。如果我拍摄一条直线，没有障碍物，那么一切看起来都很好（我看不出是否有非常小的偏移），但是有障碍物、碰撞等。不同的运动是不一样的（不同的轨迹）分辨率（设备）

我需要知道是否有某种方法可以使这项工作在所有设备上都相同。我需要找到一种方法，这样我就可以在不同的屏幕/分辨率上精确地复制运动（复杂，而不是直线）。

一些技术细节：

*   我正在使用信箱规模
*   1200w 800h 分辨率（真的不知道我为什么选择这个 :) ... 现在看起来真的很愚蠢...但是你明白了，我使用的分辨率基本上比我测试的大多数设备都大）
*   physics.setScale(100) = 这在某些时候似乎很重要。

PS：这是一个教程；我知道我可以发送轨迹线然后组成运动或找到另一种方法来复制运动，但我需要完全理解这个问题，因为我必须在未来的游戏中面对它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T08:56:34.750

我不确定它是否有效，但你可以试试这个：

```
( forceVariable / 1200 ) * display.contentWidth 
```

（假设您的宽度仍然是 1200 像素

它适用于我的图像

# laravel - 如何使用 Laravel 的 Eloquent/Fluent 将每一行设置为相同的值？

> ID：15622710
> 
> 赞同：79
> 
> 时间：2013-03-25T19:04:38.980
> 
> 标签：laravel, eloquent, fluent, laravel-3

我需要更新数据库中的所有行，以便所有行中的特定字段*等于*单个值。这是一个例子。

假设我的数据库表是这样的：

| ID | 数据 | 确认的 |
| --- | --- | --- |
| 1 | 一些数据 | 0 |
| 2 | 一些数据 | 1 |
| 3 | 一些数据 | 0 |

我想执行一个查询，将每一行的已确认字段设置为 1。

我可以这样做：

```
$rows = MyModel::where('confirmed', '=', '0')->get();
foreach($rows as $row) {
    $row->confirmed = 0;
    $row->save();
} 
```

但似乎有更好的方法？一个查询只会说“将每一行的‘确认’字段设置为 1”。

Laravel 的 Eloquent/Fluent 中是否存在这样的查询？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2016-09-14T15:11:15.997

为了让这个线程保持最新，你可以直接使用 Eloquent 模型更新所有行：

```
Model::query()->update(['confirmed' => 1]); 
```

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2013-03-26T13:24:20.973

好吧，一个简单的答案：不，你不能用雄辩的。一个模型代表数据库中的 1 行，如果他们实现它就没有意义。

但是，有一种方法可以使用 fluent 来做到这一点：

```
$affected = DB::table('table')->update(array('confirmed' => 1)); 
```

甚至更好

```
$affected = DB::table('table')->where('confirmed', '=', 0)->update(array('confirmed' => 1)); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-03-24T08:51:34.283

你可以用 elquent (laravel 4) 做到这一点：

```
MyModel::where('confirmed', '=', 0)->update(['confirmed' => 1]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-20T17:25:23.517

更新任何列文件

```
DB::table('your_table_name')->update(['any_column_name' => 'any value']); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-07T05:07:50.613

更新所有行的解决方案：

1.  创建一个额外的列（如'updateAll'）并为mysql表中的所有行（如'updateAll' = '1'）分配静态值。

2.  添加带有 name="forUpdateAll" 和 value="forUpdateAllValue" 的隐藏输入字段（仅执行特定代码以更新所有行）

3.  然后为 update(Request $request, $id) 方法添加以下代码：

```
public function update(Request $request, $id){
      if($request->get('forUpdateAll') == "forUpdateAllValue"){
                 $question = \App\YourModel::where('updateAll',$id)
                     ->update([
                         'confirmed' => 1
                     ]);

      }else {
          //other code ( update for unique record ) 
      }
 } 
```

4.  像这样设置您的表单：

```
<form role="form" action="/examples/1" method="post">        
      {{ method_field('PATCH') }}
      {{ csrf_field()}}
      <input type="hidden" name="forUpdateAll" value="forUpdateAllValue">  
      <button type="submit" class="btn btn-primary">Submit</button>
  </form> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-29T08:47:09.407

这对我有用：

```
 MyModel::query()->update(  ['confirmed' => 1] ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-14T09:13:15.390

模型::where('confirmed', 0)->update(['confirmed' => 1])

* * *

## 回答 #8

> 赞同：-8
> 
> 时间：2018-06-12T06:19:28.193

您可以这样做来更新所有记录。

App\User::where('id', 'like', '%')->update(['confirmed' => 'string']);

# android - 以编程方式线性布局 - 如何设置分隔线？

> ID：15622711
> 
> 赞同：2
> 
> 时间：2013-03-25T19:04:39.010
> 
> 标签：android, android-linearlayout, divider

我正在`TextViews`以`LinearLayout`编程方式创建，我想用分隔线（只是一条简单的线）将它们分开。我无休止地用谷歌搜索，我发现我可以使用`.setDividerDrawable`，但我不想为此使用外部图像。有小费吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T19:06:55.007

## 如何以编程方式将分隔线添加到 Android 布局

创建一个`View`1 或 2 像素的高和宽`match_parent`，并将背景颜色设置为您希望分隔线的任何颜色。

使用设置将分隔线与上面和下面的项目分开`margin`。

**示例**：

```
ImageView divider = new ImageView(this);
LinearLayout.LayoutParams lp = 
    new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT);
lp.setMargins(left, top, right, bottom);
divider.setLayoutParams(lp);
divider.setBackgroundColor(Color.WHITE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-21T10:13:13.763

您可以在 xml 中使用简单的可绘制对象作为分隔线（例如[**此处**](https://stackoverflow.com/a/15128873/878126)），或者使用几乎不占用任何内容的 9-patch 图像。

然后，使用 LinearLayoutICS 以在大多数设备上显示分隔线。你可以看看我写的[**这篇文章。**](https://stackoverflow.com/questions/22547897/how-to-add-dividers-to-linearlayoutics/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-14T09:24:41.360

对于线性布局，您可以使用此属性设置分隔线 android:divider="some color" android:showDividers="middle"

# amazon-s3 - 我可以限制 S3 存储桶的大小吗？

> ID：15622717
> 
> 赞同：15
> 
> 时间：2013-03-25T19:05:00.480
> 
> 标签：amazon-s3, bucket

我一直在寻找，我找不到是或否的答案。我可以将 S3 中的存储桶限制为特定大小吗？

如果是这样，您能否指出我这样做的正确方向？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T19:11:28.750

好吧，您可以在您正在构建的应用程序中执行此操作，假设您知道相关存储桶的大小，您可以使用 AWS API 获取存储桶大小。但是，似乎没有办法在 AWS 控制面板中完成此操作，也无法通过 S3 存储桶策略完成。

太糟糕了，因为我认为这也是一个很棒的功能。

我的建议是注意哪些应用程序正在将内容上传到您的 S3 存储桶，或者要将您的应用程序与 AWS API 连接，请在插入内容之前检查存储桶大小。然而，这并不理想。

# asp.net-mvc - .NET Web Api - 404 - 找不到文件或目录

> ID：15622720
> 
> 赞同：2
> 
> 时间：2013-03-25T19:05:05.143
> 
> 标签：asp.net-mvc, iis-7, asp.net-web-api

简而言之，一切都在本地机器上工作，但在部署到服务器“A”时却不行。

我确定服务器“A”中缺少某些东西，但我不知道它是什么，并且我无权在那里进行更改或正确测试。

因此，我在这里寻求帮助和解决问题的想法，以便我可以建议服务器“A”的负责人，或者我需要对我的项目进行任何更改以使其在那里工作。

话虽如此，让我们谈谈我的项目......

我正在使用 Web Api，并且在 global.asax 中定义了一个路由，如下所示：

```
RouteTable.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
           defaults: new { id = System.Web.Http.RouteParameter.Optional }); 
```

我正在使用 Jquery ajax 和 Kendo UI 调用控制器，如下所示：

（这是一个假例子，只是为了证明这一点）

```
read: {
        url: function () {
               return "../api/Member/123";
        }
} 
```

同样，在本地服务器上一切正常，但是当我部署它时，我会得到每个 web api 调用：

```
404 - File or directory not found. 
```

没有其他的。

需要考虑的事项：

*   我正在使用 .NET 4.0 框架编译项目。
*   服务器“A”上的网站设置为使用 .NET 4.0 经典版（这可能是个问题吗？）
*   我不认为 MVC 4 安装在服务器“A”中。Web Api 是否需要 MVC？
*   服务器“A”正在运行 IIS 7

我在 web.config 文件中添加了以下内容，但仍然出现 404 错误：

```
<modules runAllManagedModulesForAllRequests="true"/> 
```

如果您需要任何其他信息，请告诉我。

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T03:12:48.527

下载 MVC4 以使用 ASP.NET WebAPI。[http://www.microsoft.com/en-us/download/details.aspx?id=30683](http://www.microsoft.com/en-us/download/details.aspx?id=30683)

# highcharts - Highcharts 3.0“不可见”列

> ID：15622723
> 
> 赞同：1
> 
> 时间：2013-03-25T19:05:20.583
> 
> 标签：highcharts

我刚刚升级到最新版本，柱形图（动态更新）适用于 IE9（？！？）但不适用于最新的 Chrome ![IE截图](../Images/d155bf4574ac34537ae6baeb5a06dd0a.png)

![铬屏幕截图](../Images/4b081b3de9f20e236d6122d5166a0000.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T20:51:32.580

I think this is a highcharts bug that has been fixed. I tested their latest work ([http://github.highcharts.com/master/highcharts.js](http://github.highcharts.com/master/highcharts.js)) before reporting the bug, and the problem went away for me.

I believe this is the github issue: [https://github.com/highslide-software/highcharts.com/issues/1623](https://github.com/highslide-software/highcharts.com/issues/1623)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T14:16:51.187

我准备了动态添加列的示例（通过按钮）

[http://jsfiddle.net/DQTMP/](http://jsfiddle.net/DQTMP/)

```
 $('#container').highcharts({
        chart: {
            type: 'spline'
        },
        title: {
            text: 'Monthly Average Temperature'
        },
        series: [{
            name: 'Tokyo',
            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 23.3, 18.3, 13.9, 9.6]

        }]
    },function(chart){

        $('#btn').click(function(){
            chart.addSeries({
                type:'column',
                data:[1,2,3,4,5]
            });
        });

    }); 
```

如果您在 Chrome 中遇到此示例的问题，请告诉我。

# java - javascript变量是否丢失？

> ID：15622730
> 
> 赞同：0
> 
> 时间：2013-03-25T19:05:40.063
> 
> 标签：java, javascript, struts2

我是 javascript 新手，我想创建一个日期选择器，使用带有日期列表的 json 响应突出显示某些日期。

这就是我正在尝试的：

```
var dates = [];
dates = getDays();
$(function () {
    $("#datepicker").datepicker({
        beforeShowDay: setHoliDays
    });
    function setHoliDays(date) {
        for (var i = 0; i < dates.lenght; i++) {
            if (dates[i] == date) {
                return [true, "green"];
            }
        }
        return [true, ""];
    }
});
function getDays() {
    var arr = [];
    $.getJSON("/getDates", function (data) {
        $.each(data, function (id, val) {
            arr.push(val);
        });
        return arr;
    });
} 
```

JSON 响应是这样的：

```
["2013-03-18T12:00:00","2013-03-19T12:00:00","2013-03-20T12:00:00",
"2013-03-21T11:00:00","2013-03-21T10:00:00","2013-03-21T08:00:00",
"2013-03-25T10:00:00","2013-03-26T08:00:00","2013-03-27T09:00:00",
"2013-03-28T08:00:00","2013-03-28T09:00:00","2013-03-28T10:00:00",
"2013-03-28T11:00:00","2013-03-28T12:00:00"] 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:09:17.317

您的 getDays 函数正在进行异步调用。这意味着该方法在实际从远程资源接收到响应之前返回（在这种情况下不返回）。要利用此响应，您的回调函数将需要创建数组并将其保存在某处（全局变量最简单，但肯定不推荐，因为我不会在这里讨论）。然后你的 setHoliDays 函数可以利用它。

鉴于您已经在使用全局，您的回调可能会以如下方式结束：

```
$.each(data,function(id,val){
  arr.push(val);
});
dates = arr; 
```

# ios - 从 UIView 使用 presentViewController

> ID：15622736
> 
> 赞同：23
> 
> 时间：2013-03-25T19:05:56.490
> 
> 标签：ios, objective-c, xcode, ios6, presentviewcontroller

我正在为我的 iOS 应用程序创建一个标题栏，并在 UIView 中创建它。我遇到的唯一问题是“主页按钮”。当home键被按下时，需要跳转到首页，也就是ViewController。

但是，它似乎不适`[self presentViewController:vc animated:NO completion:NULL];`用于 UIView。

我该如何解决这个问题？

```
- (void) createTitlebar {

    CGRect titleBarFrame = CGRectMake(0, 0, 320, 55);

    //Create the home button on the top right of the page. When clicked, it will navigate to the home page of the application
    homeButton = [UIButton buttonWithType:UIButtonTypeCustom];
    homeButton.frame = CGRectMake(275, 10, 40, 40);
    [homeButton setTag:1];
    [homeButton setImage:[UIImage imageNamed:@"homeIcon.png"] forState:UIControlStateNormal];
    [homeButton addTarget:self action:@selector(homeButtonPressed:) forControlEvents:UIControlEventTouchUpInside];
    [self addSubview:homeButton];
}

- (IBAction)homeButtonPressed:(id)sender{

    //Transition to the submit button page
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    ViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"ViewController"];
    [vc setModalPresentationStyle:UIModalPresentationFullScreen];
    [self presentViewController:vc animated:NO completion:NULL];
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2015-07-08T10:02:59.437

您可以在不使用委托模式的情况下执行此操作。干得好

**客观C**

```
UIViewController *currentTopVC = [self currentTopViewController];
currentTopVC.presentViewController......... 

- (UIViewController *)currentTopViewController {
    UIViewController *topVC = [[[[UIApplication sharedApplication] delegate] window] rootViewController];
    while (topVC.presentedViewController) {
        topVC = topVC.presentedViewController;
    }
    return topVC;
} 
```

**迅速**

```
var topVC = UIApplication.sharedApplication().keyWindow?.rootViewController
while((topVC!.presentedViewController) != nil) {
     topVC = topVC!.presentedViewController
}
topVC?.presentViewController........ 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-25T20:04:45.413

只有 UIViewController 可以呈现另一个视图控制器，所以如果你需要从视图中显示一个视图控制器，有几种方法，其中一种是这样的：

制作一个视图控制器，您的父视图所在的视图控制器是它的代表

```
ParentView *view = [ParentView new];
...
view.delegate = self; 
```

然后，在该委托的 ParentView 调用方法中

```
- (IBAction)homeButtonPressed:(id)sender {
    [self.delegate buttonPressed];
} 
```

然后，在您的 VC 工具中

```
 -(void)buttonPressed {
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    ViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"ViewController"];
    [vc setModalPresentationStyle:UIModalPresentationFullScreen];
    [self presentViewController:vc animated:NO completion:NULL];
} 
```

如果您需要将此代码保留在 UIView 中并避免委托，您可以做一个这样的技巧（我个人不喜欢它，但它应该可以工作）

```
-(void)buttonPressed{
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    ViewController *vc = [storyboard      instantiateViewControllerWithIdentifier:@"ViewController"];
    [vc setModalPresentationStyle:UIModalPresentationFullScreen];
    [(UIViewController*)self.nextResonder presentViewController:vc animated:NO completion:NULL];
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-05-07T18:32:49.047

这是 Shamsudheen 答案的更惯用的 Swift 3 版本：

```
extension UIApplication {

    static func topViewController() -> UIViewController? {
        guard var top = shared.keyWindow?.rootViewController else {
            return nil
        }
        while let next = top.presentedViewController {
            top = next
        }
        return top
    } 
} 
```

然后你可以打电话：

```
UIApplication.topViewController()?.present(...) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-30T07:24:57.657

**使用 Swift 4 - 4.2** 添加到 Shamsudheen TK 的答案。

```
var topVC = UIApplication.shared.keyWindow?.rootViewController
    while((topVC!.presentedViewController) != nil) {
        topVC = topVC!.presentedViewController
    }
    let customViewController = CustomViewController()
    topVC?.present(customViewController, animated: true, completion: nil) 
```

**使用 UINavigationController：** 这里还有一个附加功能 -> 您可以将 UINavigationController 与您的 customViewController 一起传递。

```
 var topVC = UIApplication.shared.keyWindow?.rootViewController
    while((topVC!.presentedViewController) != nil) {
        topVC = topVC!.presentedViewController
    }
    let customViewController = CustomViewController()
    let navController = UINavigationController(rootViewController: CustomViewController)
    topVC?.present(navController, animated: true, completion: nil) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-29T05:06:20.273

**你可以试试下面的代码**

```
 UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
 ViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"ViewController"];
 UIViewController *vc1 = [UIApplication sharedApplication].keyWindow.rootViewController;
 [vc1 presentViewController:vc animated:YES completion:nil]; 
```

# iphone - ios5和ios6中UITabBarController的区别

> ID：15622739
> 
> 赞同：1
> 
> 时间：2013-03-25T19:06:00.943
> 
> 标签：iphone, ios5, ios6

我已经编写了以下代码来创建 UITabBarController

```
{
    NSMutableArray *arr = [[NSMutableArray alloc]init];
    STPC_AgendaController *agendaController = [[STPC_AgendaController alloc]initWithNibName:@"STPC_AgendaController" bundle:nil];

    STPC_Sponserer *Sponserer = [[STPC_Sponserer alloc]initWithNibName:@"STPC_Sponserer" bundle:nil];
    Sponserer.tabBarItem.title = @"Sponsors";
    STPC_AboutUsViewController  *aboutUs = [[STPC_AboutUsViewController alloc]initWithNibName:@"STPC_AboutUsViewController" bundle:nil];
aboutUs.tabBarItem.title = @"About us";

    UINavigationController *agendaNavigation = [[UINavigationController alloc]
                                                initWithRootViewController:agendaController];

    agendaNavigation.tabBarItem.title = @"Agenda";

    self.navigationController.navigationBarHidden = YES;
    self.tabController = [[UITabBarController alloc]init];
    [arr addObject:agendaNavigation];
    [arr addObject:Sponserer];
    [arr addObject:aboutUs];

    [self.tabController setViewControllers:arr animated:YES];

    [self resignFirstResponder];
    [self.view addSubview:self.tabController.view];
} 
```

但是它在 ios5 中的作用不同： ![ios5](../Images/9f4c833e0d9262f3ed98b4ed2544a9c2.png)

和ios6： ![IOS6](../Images/5c1e9e8e6a3fc5b7ccf5bede008edbba.png)

ios5 和 ios6 的 PFA 屏幕截图。如何创建一个标签栏控制器，使其在 ios5 和 ios6 中看起来完全一样？

任何帮助appriciated。

# java - LDAP LDIF Java 解析和换行

> ID：15622740
> 
> 赞同：0
> 
> 时间：2013-03-25T19:06:02.770
> 
> 标签：java, xml, parsing, ldap, ldif

我有一些将 excel 表转换为 LDIF 语句的代码。我很好奇，当我创建一个新行时，是否有正确的方法来执行它，以便在我尝试运行 LDIF 时不会出现任何错误？现在我在每一行的末尾都有 \r\n 。有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T03:49:00.910

使用[UnboundID LDAP SDK](https://www.unboundid.com/products/ldap-sdk/)。附带一个 LDIF 包。

# performance - Internet Explorer XMLhttp 而不是 Internet 控件？

> ID：15622744
> 
> 赞同：1
> 
> 时间：2013-03-25T19:06:22.880
> 
> 标签：performance, vba, internet-explorer-8

我正在使用 vba 代码从网络上获取信息。一切都很好，但需要很长时间:(

我记得很清楚，还有另一种获取信息的方法，而不是创建一个 IE 对象。

我想我不需要 IE 控件。我只是从一张纸上一个接一个地加载一个链接。

另一种“方式”如何运作？它类似于 XMLHttp 吗？代码有区别吗？应该是，还是？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T21:54:32.423

这就是我使用的：

```
Function getPage(URLStr As String) As MSHTML.HTMLDocument
    Dim oHttpRequest As MSXML2.XMLHTTP60
    Set oHttpRequest = New MSXML2.XMLHTTP60
    With oHttpRequest
        .Open "GET", URLStr, False
        .send
    End With
    Dim oHTMLDoc As MSHTML.HTMLDocument
    Set oHTMLDoc = New MSHTML.HTMLDocument
    oHTMLDoc.body.innerHTML = oHttpRequest.responseText
    Set getPage = oHTMLDoc
End Function 
```

要调用该函数，请使用以下内容：

```
Dim oHTMLDoc as MSHTML.HTMLDocument
Set oHTMLDoc = getPage("http://www.example.com") 
```

为此，您需要添加对“Microsoft XML, v6.0”和“Microsoft HTML 对象库”的引用，然后您可以根据需要使用 MSHTML 库解析代码。

# java - 在从 Java bean 中选择下拉列表时填充表单字段

> ID：15622749
> 
> 赞同：0
> 
> 时间：2013-03-25T19:06:30.457
> 
> 标签：java, jsp, jstl, javabeans, el

我有一个带有 5 个文本字段的 html 表单。

我有一个从 servlet 中的数据库查询创建的用户对象的 ArrayList。

我已经使用 jstl 填充了选择选项的下拉菜单，并且填充得很好。

```
<c:forEach var="user" items="${userList}">
<option>${user.userName}</option>
</c:forEach> 
```

我要做的是在选择时将用户对象与数组列表隔离，并使用所选对象的其他属性填充表单字段，例如：

user.firstName、user.lastName、user.email 等......

我大部分时间都在寻找答案，但没有运气。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T21:46:49.453

这可以在 Javascript 中轻松处理。该`<option>`标签有一个`value`属性，您可以在其中“存储”要显示的数据。将`JSTL`有分隔字段，例如使用逗号：

```
<select id="names" onchange="fillInFields()">
   <c:forEach var="user" items="${userList}">
      <option value="${user.firstName},${user.lastName},...">${user.userName}</option>
   </c:forEach>
</select> 
```

Javascript：

```
function fillInFields() {
   var fields = document.getElementById("names").value.split(",");
   document.getElementById("firstNameField").value = fields[0]; // name
   ...
} 
```

为了完整起见，以下字段：

```
<input id="firstNameField">
... 
```

`,`这种方法的一个警告是，这依赖于所选字段中不存在逗号字符。在这种情况下，可以使用另一个分隔符。

# php - 在文件顶部没有会话重新生成的情况下，PHP 代码无法运行

> ID：15622752
> 
> 赞同：0
> 
> 时间：2013-03-25T19:06:48.890
> 
> 标签：php, session

基本上，如果文件顶部没有会话重新生成检查，我的脚本都无法工作，这很奇怪，因为我以前从未遇到过这个问题，而且我不知道为什么它会迫使我运行这段代码。下面是我的注销，然后在下面是我必须放在每个涉及会话的单个文件的顶部以使其工作。关于什么是错的任何想法？

登出：

```
require_once("../Core/Core.php");

if(!isset($_SESSION['LoggedIn']))
    Core::ThrowError(13,"",1);

session_destroy();
header("Location: " . Core::$url); 
```

需要使它工作：（另外我把它放在用户查看的每个页面上（所以没有登录脚本页面之类的东西））

```
<?
    session_start();
    if(!isset($_SESSION['started']))
    {
        session_regenerate_id();
        $_SESSION['started'] = true;
    }
?> 
```

更新1：

在上面添加 session_start() 之后，我将数据添加到变量中，我现在可以将数据放入会话中（尽管会话已经启动，因为它甚至在您查看登录页面之前就已经启动）但是当我调用 session_destroy() 它返回false 好像会话不存在一样，但是我将 session_start() 放在 session_destroy() 之上，它工作正常！不管它是什么，这真的很愚蠢......请帮忙。

更新 2：

如果我在尝试访问之前放置 session_start() 似乎只能访问会话数据，即使会话已经说明也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:10:09.950

好的，我设法修复它，我不知道“要使用基于 cookie 的会话，必须在向浏览器输出任何内容之前调用 session_start()。” 所以为了修复它，我把 session_start() 放在了所有东西都需要的核心中，所以一切都会在尝试访问会话之前调用它。

# java - 插入 Sql 查询不适用于 HQL

> ID：15622756
> 
> 赞同：0
> 
> 时间：2013-03-25T19:06:58.617
> 
> 标签：java, sql, hibernate, hql

我正在尝试通过使用本机 SQL 代码使用 HQlL 将简单的插入到数据库中。

它没有给出任何错误，它只是不起作用。任何帮助表示赞赏。

谢谢。

```
public void AddMedicament(Medicament medicament) {
    System.out.println(medicament.getName());
    // open a database connection
    Session session = FarmacieHibernateUtil.getSessionFactory().openSession();
    Transaction transaction = session.beginTransaction();
    // prepare SQL insert command
    session.createSQLQuery("insert into Medicament(name) values('test')");

    // close the database connection
    session.close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:12:12.607

If you use createSQLQuery this throw a native sql instruction

Your object table name is Medicament too?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:16:37.737

session.saveOrUpdate（药物）；tx.commit(); 如果你没有设置主键，那么它将插入，如果你在域对象中设置了 PK，那么它将被更新。

如果您使用的是 Spring ORM，则无需在休眠中执行查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T19:09:03.163

我不熟悉 Hibernate，但我没有看到你在运行你的命令。您只需创建查询并关闭会话，我认为您需要一些语句来执行它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-25T19:09:42.510

你需要打电话

```
session.executeUpdate() 
transaction.commit(); 
```

在闭幕会议之前。

# linux - 如何终止“CLOSE_WAIT”和“FIN_WAIT2”网络连接

> ID：15622758
> 
> 赞同：3
> 
> 时间：2013-03-25T19:07:03.303
> 
> 标签：linux, node.js, socket.io

我使用 node.js 和 socket.io 创建了一个游戏。一切正常，但有时这个游戏套接字服务器不响应任何连接。当我转到进程信息-> 文件和连接（在 webmin 中）时，我看到有很多连接`CLOSE_WAIT`和`FIN_WAIT2`状态。我认为问题出在这些连接上，因为当有大约 1,000 个连接时游戏会失败。服务器操作系统是 Ubuntu Linux 12.04。

如何终止这些连接或增加允许的最大连接数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:48:52.353

为了补充吉姆的答案，我认为您的客户端处理关闭套接字连接时存在问题。似乎您的客户端没有正确关闭套接字（服务器启动和客户端启动关闭），这就是您的服务器有这么多等待状态的原因

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T08:32:30.317

您无需终止连接或增加允许的数量。您需要在连接的一侧修复应用程序中的缺陷，特别是未启动关闭的一侧。

参见[RFC 793](http://www.faqs.org/rfcs/rfc793.html)的图 13 。您的程序处于关闭序列的第 3 步。您在 FIN-WAIT-2 中看到的那一面表现正确。它已启动关闭，并且 TCP 堆栈已在网络上发送了一个 FIN 数据包。CLOSE-WAIT 的一方有缺陷。那边的 TCP 栈已经收到并确认了 FIN 包，但是应用程序没有注意到。应用程序如何检测远程端已关闭连接将取决于您的平台。不幸的是，我老了，不知道 node.js 或 socket.io。

在 C 中发生的情况是套接字看起来是可读的，但是 read() 返回一个长度为零的数据包。当应用程序看到这一点时，它应该调用 close()。您将在 node.js 或 socket.io 的文档中找到等效的内容。

当你找到它时，考虑在这里回答你自己的问题并接受答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:18:41.700

Linux 有`SO_REUSEADDR`设置套接字参数的选项。它允许立即重用同一端口。了解您的工具集的人可以告诉您如何设置套接字选项。你可能已经知道怎么做了。我不知道这个工具集。

从较旧的 java 文档集：http: [//docs.oracle.com/javase/1.5.0/docs/guide/net/socketOpt.html](http://docs.oracle.com/javase/1.5.0/docs/guide/net/socketOpt.html)

# c++ - Visual C++ 2010 接受字符串作为重载函数中的 bool

> ID：15622760
> 
> 赞同：6
> 
> 时间：2013-03-25T19:07:05.467
> 
> 标签：c++, visual-studio-2010, visual-c++

我正在使用 Visual Studio 2012（但使用 VC++ 2010 构建工具），并且我在一个类中定义了这两个重载函数（下面的签名），我稍后在另一个类中调用该类来实例化第一个类（也在下面）：

```
Defined in the class:
Node CreateNode(Node *parent,string name,string node_text,bool expects_node = true);
Node CreateNode(Node *parent,string name, string attribute, string value,bool expects_node = true)

Calling these functions in the macro:
Node axis1 = handler->CreateNode(&sparse,"axis","id","trigger_pt"); 
```

当我调用函数时，它调用的是第一个函数，而不是第二个！所以它将第二个字符串视为布尔值！但是，当我在函数调用中添加“true”时，它会按预期调用第二个函数。谁能解释一下？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T19:10:31.057

字符串文字`"trigger_pt"`的类型为“array of 11 `const char`”。编译器认为将其转换为 a`bool`比将其转换为 a 更好`std::string`。原因是转换为`bool`仅使用标准转换（数组到指针，然后是布尔指针），而转换为`std::string`需要调用构造函数。标准转换序列始终被认为比用户定义的转换序列（涉及转换构造函数）更好。

> 比较隐式转换序列的基本形式时（定义见 13.3.3.1）
> 
> *   标准转换序列 (13.3.3.1.1) 是比用户定义的转换序列或省略号转换序列更好的转换序列，并且
> *   [...]

您可以通过将该文字设为 a 来强制它使用第二个重载`std::string`：

```
Node axis1 = handler->CreateNode(&sparse,"axis","id",std::string("trigger_pt")); 
```

另一种选择是提供另一个采用 a 的重载`const char*`，这将优于`bool`版本。这个重载可以简单地转发到`std::string`重载。

# java - 绑定服务的多个实例 - 绑定服务在应用程序结束后仍然存在

> ID：15622762
> 
> 赞同：0
> 
> 时间：2013-03-25T19:07:23.550
> 
> 标签：java, android

作为一名刚接触 android 的开发人员，我想我可能误解了绑定服务。

我创建了一个服务来结束对服务器的访问。作为此服务的一部分，该服务正在侦听多播地址，以识别本地网络上的设备何时出现和消失。

但是，由于启动了多个服务实例，我遇到了问题。当活动关闭（使用后退按钮）然后不久重新打开时，就会发生这种情况。效果是服务无法绑定到本地端口，因此无法监听多播。

我原以为一旦活动停止绑定服务就会死掉，但事实并非如此。

我是否误解了绑定服务或者我做错了什么？

**编辑**

所以它接缝我的误解是，我假设程序将在最后一个非守护线程关闭后立即被清理，*并且只要活动终止*。

我已经通过显式取消侦听线程并关闭`onDestroy()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:25:58.233

> 但是，由于启动了多个服务实例，我遇到了问题

在任何时候，您的进程中只会有零个或一个给定服务类的实例运行。

> 我原以为一旦活动停止绑定服务就会死掉，但事实并非如此。

该服务将在以下某个时间被销毁：

*   所有调用`bindService()`都有对应的`unbindService()`, 和
*   如果您`startService()`曾经为此正在运行的服务实例调用过，那么您调用`stopService()`或服务调用`stopSelf()`

服务被销毁的确切时间是不确定的，尽管从我所看到的情况来看通常是相当快的。但是，我不能排除您的第二个活动实例在服务被销毁之前绑定到服务的可能性，从而防止它被销毁。

> 还是我做错了什么？

当服务被销毁时，您可能没有正确清理您的多播套接字，或者您正在尝试打开已从先前绑定打开的套接字。

我不完全清楚你为什么在这里使用绑定模式。就个人而言，我发现它通常比它的价值更麻烦。也许考虑使用命令模式，通过or向服务发送命令`startService()`并停止服务。`stopService()``stopSelf()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:12:22.457

Try using Stopservice() on onbackpressed()

# python - Python GeraldoReports - 用逗号格式化总和值

> ID：15622763
> 
> 赞同：1
> 
> 时间：2013-03-25T19:07:27.607
> 
> 标签：python, django, geraldo

我正在使用 Geraldo Reports 为我的 Django 项目创建 PDF 报告。我被困在如何格式化作为汇总值的值。我在报告组中
有一个 ObjectValue 。`action=FIELD_ACTION_SUM`我不知道如何将返回值格式化为用逗号分隔千位的数字。

我尝试了在 Geraldo Reports 文档中列出的 get_text 参数，但没有很好地记录如何使用它。

我当前的对象值：

```
ObjectValue(
  attribute_name='labor',
  action=FIELD_ACTION_SUM,
  left=7 * inch,
  width=.8 * inch,
  style={'alignment': TA_RIGHT},
  get_text=lambda instance, value: '{:,.2f}'.format(value),
  stores_text_in_cache=False
), 
```

我没有任何运气来寻找解决方案。这里有谁知道我做错了什么，或者我应该做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-15T20:26:41.413

经过反复试验，我找到了答案！在我的示例中，我在一个名为“jd_gross”的查询集中有一个字段，我想在我的报告中对其进行总计..​​....我最终放弃了 action=FIELD_ACTION_SUM 部分并推出了我自己的

在我的 band_detail 部分中，我可以用逗号显示此字段，其中包含以下内容：

```
 ObjectValue(attribute_name='jd_gross', left=26.7*cm, width=1.7*cm, style={'alignment':TA_RIGHT}, get_value=lambda instance: intcomma(instance.jd_gross)), 
```

但是，对摘要部分有用的答案是添加到 : def **init** (self, *args, **kwargs): 部分，在 : self.band_page_header.elements += [ 我使用相同的概念来计算我的总数，将其转换为格式化字符串，并将一行作为系统字段添加到我的摘要部分，如下所示：

```
 myset = self.queryset
    grosstotal = 0
    for myline in myset:
        if myline.jd_gross:
            grosstotal += myline.jd_gross
    ugrosstotal = intcomma(grosstotal)
    self.band_summary.elements += [
        SystemField(expression=ugrosstotal, top=1*cm, left=26.5*cm, width=1.9*cm, style={'alignment':TA_RIGHT}),
        ] 
```

所以我的完整继承报告现在如下：

类 JobdetailsReport(DefaultReport): title = 'Job Details' page_size = Landscape(A4)

```
class band_detail(DetailBand):
    height=0.7*cm
    elements=[
        ObjectValue(attribute_name='jd_job', left=0.1*cm),
        ObjectValue(attribute_name='c_name', left=1.5*cm),
        ObjectValue(attribute_name='clientname', left=5.8*cm),
        ObjectValue(attribute_name='jd_return', left=10.1*cm),
        ObjectValue(attribute_name='jd_delivery', left=12.6*cm),
        ObjectValue(attribute_name='get_j_status1_display', left=15.1*cm),
        ObjectValue(attribute_name='get_j_status2_display', left=17.6*cm),
        ObjectValue(attribute_name='jd_prodref', left=20.1*cm),
        ObjectValue(attribute_name='userformalname', left=23*cm),
        ObjectValue(attribute_name='jd_gross', left=26.7*cm, width=1.7*cm, style={'alignment':TA_RIGHT}, get_value=lambda instance: intcomma(instance.jd_gross)),
        ]
    borders = {'bottom': True}

class band_summary(ReportBand):
    height = 1.7*cm
    elements = [
        Label(text='Records printed:', top=1*cm, left=0.5*cm),
        ObjectValue(expression='count(jd_job)', top=1*cm, left=5.6*cm),
        Label(text="Total Value:", top=1*cm, left=22*cm),
        ]
    borders = {'top': True}

def __init__(self, *args, **kwargs):
    super(JobdetailsReport, self).__init__(*args, **kwargs)

    self.band_page_header.elements += [
        Label(text="Job No.", top=0.8*cm, left=0.1*cm),
        Label(text="Client", top=0.8*cm, left=1.5*cm),
        Label(text="Delivery", top=0.8*cm, left=5.8*cm),
        Label(text="Return", top=0.8*cm, left=10.1*cm),
        Label(text="Delivery", top=0.8*cm, left=12.6*cm),
        Label(text="Physical Status", top=0.8*cm, left=15.1*cm),
        Label(text="Accts Status", top=0.8*cm, left=17.6*cm),
        Label(text="Reference", top=0.8*cm, left=20.1*cm),
        Label(text="Our Contact", top=0.8*cm, left=23*cm),
        Label(text="Gross", top=0.8*cm, left=27*cm),
        ]

    myset = self.queryset
    grosstotal = 0
    for myline in myset:
        if myline.jd_gross:
            grosstotal += myline.jd_gross
    ugrosstotal = intcomma(grosstotal)
    self.band_summary.elements += [
        SystemField(expression=ugrosstotal, top=1*cm, left=26.5*cm, width=1.9*cm, style={'alignment':TA_RIGHT}),
        ] 
```

希望对你有帮助！我只花了几个小时就让它工作了......

# java - 使用 ArrayList 填充 mysql 数据库行

> ID：15622766
> 
> 赞同：-1
> 
> 时间：2013-03-25T19:07:34.280
> 
> 标签：java, mysql, database, arraylist

我需要将 ArrayList 中的每个项目添加到数据库中。我可以让 for each 循环将文件中的每个行项输出到控制台窗口，但是我将如何使用此循环将每个项添加到 mysql 数据库行？

```
 FileInputStream fstream = new FileInputStream(file);
    BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
    StringBuffer sb = new StringBuffer();
    ArrayList<String> store = new ArrayList<String>();
    String strLine;

    //Read File Line By Line
while((strLine = br.readLine())!= null)
{
    String [] splitLine = strLine.split(" \n");
    for(String x : splitLine)
    {

        System.out.println("Line: "+ x +"\n");

    }
} 
```

- - - 更新 - -

好的，我修改了代码

```
 FileInputStream fstream = new FileInputStream(file);
    BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
    String strLine;

        while((strLine = br.readLine())!= null)
            {
                String [] splitLine = strLine.split(" \n");
                for(int i=0;i<splitLine.length;i++)
                {           
                    // Prepare the query and values to be inserted into the database 
                    String str="INSERT INTO donations(name,charity,amount) VALUES (?,?,?)";

                    java.sql.PreparedStatement statement = conn.prepareStatement(str); 
                        String db1 = splitLine[0];
                        String db2 = splitLine[1];
                        Double db3 = Double.parseDouble(splitLine[2]);

                    statement.setString(1,db1);
                    statement.setString(2,db2);
                    statement.setDouble(3,db3);

                System.out.println("Line: "+ splitLine[i]+ " -record- " + i);

                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:29:26.763

您可以使用休眠并为数据库表创建一个 POJO。您可以创建此 POJO 的数组列表，保存后，数组列表将（批量）插入数据库中。

# c# - 使用空值更新 varchar 字段

> ID：15622767
> 
> 赞同：5
> 
> 时间：2013-03-25T19:07:43.237
> 
> 标签：c#, mysql

我有一个`clube varchar(50)`默认为 NULL 的字段，但事实并非`notnull`如此，它接受空值。我需要知道的是，如果我在这个字段上已经有一个值并且我想创建一个`Update`并设置它的值`null`，我该怎么做？
我试图设置`null`a 的值`string`但没有奏效。

如果某些条件为真，我想将此字段设置`NULL`为`Update`.

很明显，如果条件变为假，我将传递一个值而不是`null`值。所以我需要使用`MySqlcommand Parameter`. 喜欢：

```
sql = "UPDATE usuarios SET nome = @nome";
cmd.CommandText = sql;
cmd.Parameter.Add(New MySqlParameter("@nome", MySqlDbType.VarChar)).Value = `variable`; 
```

如果条件是`true`= `variable = null`else `variable != null`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T17:40:54.857

这是我找到的答案：

```
cmd.Parameters.Add(new MySqlParameter("@nomeclube", MySqlDbType.VarChar)).Value = !String.IsNullOrEmpty(usr.Nome_Clube) ? (object)usr.Nome_Clube : DBNull.Value; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T19:36:08.777

要将值设置为 null：

```
cmd.Parameter.Add(New MySqlParameter("@nome", MySqlDbType.VarChar)).Value = DBNull.Value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:09:48.900

简单的。只需将其设置为`NULL`：

```
UPDATE table SET clube = NULL WHERE ..... 
```

# json - 在没有尾随分隔符的情况下分隔 AWK 中的输出记录

> ID：15622776
> 
> 赞同：6
> 
> 时间：2013-03-25T19:08:16.807
> 
> 标签：json, awk, gawk, nawk

我有以下记录：

```
31 Stockholm
42 Talin
34 Helsinki
24 Moscow
15 Tokyo 
```

我想用 AWK 把它转换成 JSON。使用此代码：

```
#!/usr/bin/awk
BEGIN {
    print "{";
    FS=" ";
    ORS=",\n";
    OFS=":";
};

{    
    if ( !a[city]++ && NR > 1 ) {
        key = $2;
        value = $1;
        print "\"" key "\"", value;
    }
};

END {
    ORS="\n";
    OFS=" ";
    print "\b\b}";
}; 
```

给我这个：

```
{
"Stockholm":31,
"Talin":42,
"Helsinki":34,
"Moscow":24,
"Tokyo":15, <--- I don't want this comma
} 
```

问题是最后一个数据行上的尾随逗号。它使 JSON 输出不可接受。我怎样才能得到这个输出：

```
{
"Stockholm":31,
"Talin":42,
"Helsinki":34,
"Moscow":24,
"Tokyo":15
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T01:06:31.300

介意对您发布的脚本的一些反馈吗？

```
#!/usr/bin/awk        # Just be aware that on Solaris this will be old, broken awk which you must never use
BEGIN {
    print "{";        # On this and every other line, the trailing semi-colon is a pointless null-statement, remove all of these.
    FS=" ";           # This is setting FS to the value it already has so remove it.
    ORS=",\n";
    OFS=":";
};

{
    if ( !a[city]++ && NR > 1 ) {      # awk consists of <condition>{<action} segments so move this condition out to the condition part
                                       # also, you never populate a variable named "city" so `!a[city]++` won't behave sensibly.
        key = $2;
        value = $1;
        print "\"" key "\"", value;
    }
};

END {
    ORS="\n";                          # no need to set ORS and OFS when the script will no longer use them.
    OFS=" ";
    print "\b\b}";                     # why would you want to print a backspace???
}; 
```

所以你的原始脚本应该写成：

```
#!/usr/bin/awk
BEGIN {
    print "{"
    ORS=",\n"
    OFS=":"
}

!a[city]++ && (NR > 1) {    
    key = $2
    value = $1
    print "\"" key "\"", value
}

END {
    print "}"
} 
```

这是我真正编写脚本以将您发布的输入转换为您发布的输出的方式：

```
$ cat file
31 Stockholm
42 Talin
34 Helsinki
24 Moscow
15 Tokyo
$
$ awk 'BEGIN{print "{"} {printf "%s\"%s\":%s",sep,$2,$1; sep=",\n"} END{print "\n}"}' file
{
"Stockholm":31,
"Talin":42,
"Helsinki":34,
"Moscow":24,
"Tokyo":15
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T20:00:04.647

你有几个选择。一个简单的方法是在您即将写出新行时添加上一行的逗号：

*   `first = 1`在你的`BEGIN`.

*   当要打印一行时，检查`first`。如果是`1`，则只需将其设置为`0`。如果`0`打印出逗号和换行符：

    ```
    if (first) { first = 0; } else { print ","; } 
    ```

    这样做的目的是避免在列表的开头放置额外的逗号。

*   使用`printf("%s", ...)`而不是`print ...`这样可以在打印记录时避免换行。

*   在右大括号之前添加一个额外的换行符，如下所示：`print "\n}";`

另外，请注意，如果您不关心美学，JSON 并不真正需要项目之间的换行符等。您可以只为整个 enchilada 输出一个大行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T20:20:29.873

你真的应该使用**[json 解析器](https://stackoverflow.com/questions/15622776/separating-output-records-in-awk-without-a-trailing-separator/15623714#15623714)**，但这里是如何使用的`awk`：

```
BEGIN {
    print "{"    
}
NR==1{
    s= "\""$2"\":"$1
    next
}
{
    s=s",\n\""$2"\":"$1
}
END {
    printf "%s\n%s",s,"}"
} 
```

输出：

```
{
"Stockholm":31,
"Talin":42,
"Helsinki":34,
"Moscow":24,
"Tokyo":15
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T20:03:55.173

为什么不使用`json`解析器？不要强迫`awk`做某事不是设计来做的。这是使用的解决方案`python`：

```
import json

d = {}
with open("file") as f:
    for line in f:
       (val, key) = line.split()
       d[key] = int(val)

print json.dumps(d,indent=0) 
```

这输出：

```
{
"Helsinki": 34, 
"Moscow": 24, 
"Stockholm": 31, 
"Talin": 42, 
"Tokyo": 15
} 
```

# android - 从android调用Python谷歌云端点api

> ID：15622779
> 
> 赞同：4
> 
> 时间：2013-03-25T19:08:19.013
> 
> 标签：android, python, eclipse, google-cloud-endpoints

至此，我创建了一个名为`paper`（如 中所述`app.yaml`）文件的 python app-engine 端点 api。我已将所有 jar 包（包括`…-java-1.13.2-beta-sources.jar`文件）放在我的 android 项目的 libs 目录中。如何调用我的 Web 服务之一（又名端点方法）？因为我不知道将我引导到 api 的包的名称，它在 python 后端是简单的`class PageApi(remote.Service):`. 想象一下`paper`api 有一个名为`countPages(self):`. 我将如何调用该服务？我已经尝试过导入`import com.appspot.api.services.[etc]`，但 eclipse 没有看到导入路径。

编辑：

我重新加载了api。我检查了 api explorer 上的一切是否正常。然后我发现了两个似乎是我的包的包——除了它们根本不包含任何类。

```
import com.google.api.services.page.*;
import com.google.api.services.page.model.*; 
```

如果它们确实是包，为什么会丢失这些类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T00:10:23.700

第一的。正确设置项目后，生成客户端库的同一向导会将其复制到您的 Android 项目并添加源文件。然后您将在项目资源管理器的端点库文件夹中找到您需要的包。请查看[这篇文章](https://stackoverflow.com/a/15442841/150016)，了解有关使其正常工作的提示。

然后使用 Android 代码调用端点，如下所示：

```
final HttpTransport transport = AndroidHttp.newCompatibleTransport();
JsonFactory jsonFactory = new JacksonFactory();

endpointname.Builder builder = new endpointname.Builder( transport, jsonFactory, null );    
builder.setApplicationName( appName );

endpointname service = builder.build();

try {
   response = service.methodName( parameters ).execute();
} catch (IOException e) {
   Log.e(...);
} 
```

# ruby - Ruby 按内部哈希的相同值计数对哈希进行排序

> ID：15622789
> 
> 赞同：0
> 
> 时间：2013-03-25T19:08:42.470
> 
> 标签：ruby

我有一个哈希值，我想要完成的是根据内部哈希值的相同值的计数对哈希值进行排序。所以假设这是我的哈希。

```
hash = { 
         "Run1"=>{"March 24, 2013"=>"failed", "March 23, 2013"=>"failed", "March 21, 2013"=>"failed", "March 19, 2013"=>"passed", "March 18, 2013"=>"passed"},
         "Run2"=>{"March 24, 2013"=>"failed", "March 23, 2013"=>"failed", "March 21, 2013"=>"failed", "March 19, 2013"=>"failed", "March 18, 2013"=>"failed"} 
       } 
```

我想对哈希进行排序，以便 Run2 出现在 Run1 之前，因为我试图按运行“失败”的次数进行排序

我想我需要类似的东西

```
hash.sort_by{|key, innerHash| innerHash.values.count('failed')} 
```

非常感谢任何帮助或建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:45:02.187

一个小修复：

```
hash.sort_by { |_,h| -h.values.count('failed') } # notice force negative 
```

...并且应该工作。记住`sort_by`总是返回一个数组，所以也许你想：

```
sorted_hash = Hash[hash.sort_by { |_,h| -h.values.count('failed') }] 
```

# php - 使用 AVG() 查询 MySQL 的问题

> ID：15622791
> 
> 赞同：1
> 
> 时间：2013-03-25T19:08:49.943
> 
> 标签：php, mysql, average

我正在使用一个查询，该查询对每个给定 ID 的所有记录进行平均...

```
$query = "SELECT bline_id, AVG(flow) as flowavg 
          FROM blf 
          WHERE bline_id BETWEEN 1 AND 30 
          GROUP BY bline_id 
          ORDER BY bline_id ASC"; 
```

这些记录每天更新一次。我只想使用平均每个 id 的 10 条最新记录。

任何帮助将不胜感激。

blf 表结构为：

```
id | bline_id | flow | date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:23:24.973

如果这些真的每天都在更新，那么使用日期算术：

```
SELECT bline_id, AVG(flow) as flowavg
FROM blf
WHERE bline_id BETWEEN 1 AND 30 and
      date >= date_sub(now(), interval 10 day)
GROUP BY bline_id
ORDER BY bline_id ASC 
```

否则，您必须放入一个计数器，您可以使用相关子查询来执行此操作：

```
SELECT bline_id, AVG(flow) as flowavg
FROM (select blf.*,
             (select COUNT(*) from blf blf2 where blf2.bline_id = blf.bline_id and blf2.date >= blf.date
             ) seqnum
      from blf
     ) blf
WHERE bline_id BETWEEN 1 AND 30 and
      seqnum <= 10
GROUP BY bline_id
ORDER BY bline_id ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:14:09.220

另一种选择是模拟 ROW_NUMBER()。

此语句创建一个计数器并在每次遇到新的 bline_id 时将其重置。然后它会过滤掉前 10 行中没有的任何记录。

```
SELECT bline_id, 
       Avg(flow) avg 
FROM   (SELECT id, 
               bline_id, 
               flow, 
               date, 
               CASE 
                 WHEN @previous IS NULL 
                       OR @previous = bline_id THEN @rownum := @rownum + 1 
                 ELSE @rownum := 1 
               end rn, 
               @previous := bline_id 
        FROM   blf, 
               (SELECT @rownum := 0, 
                       @previous := NULL) t 
        WHERE bline_id > 0 and bline_id < 31
        ORDER  BY bline_id, 
                  date DESC, 
                  id) t 
WHERE  rn < 11
GROUP  BY bline_id 
```

[演示](http://sqlfiddle.com/#!2/4b55c/23)

[通过删除 group by 并查看中间结果](http://sqlfiddle.com/#!2/4b55c/24)来看到这一点是值得的

# html - 使用 CSS3 触发图像显示

> ID：15622793
> 
> 赞同：-1
> 
> 时间：2013-03-25T19:08:55.397
> 
> 标签：html, css, animation

我是一个 css3 过渡的菜鸟，我想在滚动位置（或可见时）触发一个图像，css3 动画从不透明度：O 到 1。我在这里有一个很好的例子：http: [//bonvalletromain.com /项目/雪铁龙创意奖](http://bonvalletromain.com/projects/citroen-creative-awards)

我想对图像做同样的事情并在滚动位置触发它们。

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:27:36.597

我认为您必须使用某种 javascript 来触发事件。这是一个简单的解决方案，它使用 jQuery 来监听窗口上的滚动事件：

```
$(window).scroll(function(){
  if ($(document).height() - $(window).height() < 20)
  {        
     $('#DivWithImage').fadeIn();
  }
}); 
```

（以上基于[滚动显示内容的jQuery插件](https://stackoverflow.com/questions/8544996/scroll-to-reveal-content-jquery-plugin)）。

您可以修改上述内容以将类附加到 div，如下所示：[http ://www.impressivewebs.com/css3-transitions-javascript/](http://www.impressivewebs.com/css3-transitions-javascript/)

因此使用 css3 制作动画，但如果您已经在使用 jQuery，为什么还要麻烦呢？

# ruby - 使用 collect 为数组的值添加引号

> ID：15622802
> 
> 赞同：2
> 
> 时间：2013-03-25T19:09:23.593
> 
> 标签：ruby, arrays

这是我的数组`[1, 6, 8, 16, 21]`。我希望它是`["1", "6", "8", "16", "21"]`

我努力了：

```
[1, 6, 8, 16, 21].collect {|x| "x" }
=> ["x", "x", "x", "x", "x"] 
```

使用收集正确的方法吗？如何格式化 collect 函数以获取围绕我的值的引号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T19:11:48.870

我想你不明白这些引号是什么意思。您真正想要的是获取一个*整数*数组并将其转换为*字符串*数组。

```
a = [1, 6, 8, 16, 21]
a.map(&:to_s)
# => ["1", "6", "8", "16", "21"] 
```

这里的每个元素`a`都*映射*到`to_s`方法，该方法返回数字的字符串表示形式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-25T19:11:15.653

你想把数字变成字符串吗？那么试试这个：

```
[1, 6, 8, 16, 21].map(&:to_s) 
```

或完整的表格

```
[1, 6, 8, 16, 21].map{|i| i.to_s } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-25T19:15:08.027

您可以在示例中尝试使用字符串插值。您只需要将变量放入`#{}`双引号中的字符串中：`"#{ variable }"`.

```
[1, 6, 8, 16, 21].collect {|x| "#{x}" } # "x" will just return string "x" 
```

# mysql - MySQL选择昨天的日期

> ID：15622803
> 
> 赞同：11
> 
> 时间：2013-03-25T19:09:25.083
> 
> 标签：mysql, sql, date

如果我有这样的约会：

```
'2013-03-25' 
```

我想用`WHERE`“昨天”写一个 MySQL 查询，我该怎么做？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-25T19:10:29.120

这应该这样做：

```
WHERE `date` = CURDATE() - INTERVAL 1 DAY 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-25T19:11:52.153

获取昨天日期的一种简单方法是使用[`subdate()`](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_subdate)函数：

```
subdate(currentDate, 1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-02T21:03:58.940

我总是不得不参考一个代码片段来再次解决这个问题。

习惯上将日期时间以 UTC 格式存储在数据库中。但通常，在生成报告时，需要针对特定​​时区调整时间。

这是我用来显示昨天选择的片段，已针对太平洋时间进行了调整：

```
SET @date_start = DATE_SUB((CURDATE() - INTERVAL 1 DAY), INTERVAL 8 HOUR);
SET @date_end = DATE_SUB(CURDATE(), INTERVAL 8 HOUR);

SELECT
    projects.token,
    projects.created_at as 'UTC created_at',
    DATE_SUB(projects.created_at, INTERVAL 8 HOUR) as 'Pacific created_at'
FROM
    projects
WHERE
    projects.created_at BETWEEN @date_start AND @date_end; 
```

**注意：**我在代码段中设置了变量，以便于查看。当我编写最终查询时，我通常不使用变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T19:10:55.667

我想你正在寻找：

```
DATE_ADD(date_column, INTERVAL -1 DAY) 
```

见[https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

# ruby-on-rails - 如何在 Rails 中使用全局实例？

> ID：15622805
> 
> 赞同：3
> 
> 时间：2013-03-25T19:09:36.337
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, ruby-on-rails-3.2

我在初始化程序中有以下内容：

```
options = YAML.load_file(Rails.root.join('config','oauth.yml' ))

CLIENT = GameSystem::Client.new options 
```

我如何利用 CLIENT 从控制器调用其关联方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:21:18.543

我会做：

```
class ApplicationController

  private

  def game_client
    @game_client ||= begin
      options = YAML.load_file(Rails.root.join('config','oauth.yml' ))
      GameSystem::Client.new options
    end
  end 
```

然后在需要的地方调用它：

```
game_client #like you're using current_user 
```

所以基本上，我不会在初始化程序中创建它（除非有我无法实现的需要）。

# python - 在 Python 中正确使用正则表达式语法

> ID：15622807
> 
> 赞同：1
> 
> 时间：2013-03-25T19:09:47.820
> 
> 标签：python, regex

我正在使用正则表达式来查找由连字符分隔的 8 位数字表示的任何和所有模式，如下所示：

```
(\d{8}\-\d{8}\) 
```

我在 rubular.com （在线正则表达式编辑器）上粘贴了它，它似乎工作正常。但是，当我在我的 Python 代码中使用它时，我收到一个错误：SyntaxError: EOL while scanning string literal。我试着把反斜线从末端去掉。但是，虽然错误似乎已经消失，但正则表达式并没有找到该模式。我有一个嵌入了以下模式的字符串：

```
output = "... 57867983 - 87995423 ...." 
```

我正在使用以下代码：

```
include re

regex = re.compile(r"\d{8}\-\d{8}\")

re.search(regex, outuput) 
```

正则表达式不返回输出字符串中的模式。有人可以告诉我我做错了什么吗？谢谢！

这是我要匹配的实际字符串，它出现在返回的字符串中：

```
Hash\r\n\t\t01773857 - 90349912\r\n\tWork with 
```

我是否需要在 8 位数字加上我想要匹配的连字符之前考虑任何字母数字字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:12:25.707

You have your last `"` escaped by `\`

You want:

```
regex = re.compile(r"\d{8}\-\d{8}") 
```

EDIT - Based on your updated question it looks like you need to account for spaces before your dash:

```
regex = re.compile(r"\d{8}\s*\-\s*\d{8}") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:13:50.900

您的数据与您的模式不匹配：

```
57867983 - 87995423 
```

是 8 位数字，*后跟一个空格*，后跟一个连字符，*然后是一个空格*，然后是 8 位数字。

所以你的模式应该是：

```
r"\d{8} - \d{8}" 
```

如果空格是可选的，则：

```
r"\d{8} *- *\d{8}" 
```

这意味着“零个或多个空格”。顺便说一句，连字符不是外面的特殊字符`[ ]`，所以不需要转义。

编辑：这是一个更完整的例子：

```
import re

regex = re.compile(r"(\d{8}) - (\d{8})")

outuput = "Hash\r\n\t\t01773857 - 90349912\r\n\tWork with"

m = re.search(regex, outuput)

if m: print("Found:",m.groups()) 
```

给出：

```
Found: ('01773857', '90349912') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:16:14.497

```
import re
regex = re.compile(r'(\d{8}\s*\-\s*\d{8})')
found = re.search(regex, "11111111-01234567")
print found.group(0)
found = re.search(regex, "22222222 - 01234567")
print found.group(0) 
```

# ajax - Javascript范围问题，ajax

> ID：15622811
> 
> 赞同：0
> 
> 时间：2013-03-25T19:10:11.303
> 
> 标签：ajax, scope, this

我想使用 ajax 提交表单，然后如果 ajax 请求成功，则添加一个“禁用”类。

```
$("body").on("click", ".my_form", function(e){
    submit_form(e, $(this));    
});

function submit_form(e, _this){
    e.preventDefault();
    $.ajax({
        type:"POST",
        url:"/controller/common/form_processing.php", 
        data: "my form data goes here",
        dataType: "json", 
        success:function (data, _this) {
            _this.parents(".my_form").addClass("disabled");
       });
}); 
```

在当前的形式中，*没有*添加“禁用”类。但是，如果我将 line: 移到`_this.parents(".thumbsup").addClass("disabled");`ajax 括号之外，它确实有效。（但显然在这种情况下，无论ajax调用成功还是失败，都会添加“禁用”。有人可以解释如何让它正常工作吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:13:46.400

Remove the `_this` parameter from your success callback, you are redefining `_this` over the original one which is the jQuery object passed to `submit_form`

```
success:function (data) {
    _this.parents(".my_form").addClass("disabled");
}); 
```

# css - CSS 导航栏：UL 后面的文字四处飘荡——为什么？

> ID：15622812
> 
> 赞同：0
> 
> 时间：2013-03-25T19:10:13.010
> 
> 标签：css

我在玩这个网站的水平导航栏：

[http://www.w3schools.com/css/tryit.asp?filename=trycss_float5](http://www.w3schools.com/css/tryit.asp?filename=trycss_float5)

使用以下代码：

```
<head>
<style>
ul
{
     float:left;
     width:100%;
     padding:0;
     margin:0;
     list-style-type:none;
}
a
{
     float:left;
     width:6em;
     text-decoration:none;
     color:white;
     background-color:purple;
     padding:0.2em 0.6em;
     border-right:1px solid white;
}
a:hover {background-color:#ff3300;}
li {display:inline;}
</style>
</head>

<body>
<ul>
      <li><a href="#">Link one</a></li>
      <li><a href="#">Link two</a></li>
      <li><a href="#">Link three</a></li>
      <li><a href="#">Link four</a></li>
</ul>

<p>
      In the example above, we let the ul element and the a element float to the left.
      The li elements will be displayed as inline elements (no line break before or    after the element). This forces the list to be on one line.
      The ul element has a width of 100% and each hyperlink in the list has a width of 6em (6 times the size of the current font).
      We add some colors and borders to make it more fancy.
</p> 
```

如果在 ul 的样式中，float 被移除，那么 p 文本会在 ul 周围浮动。但我的问题是浮动应用于链接元素，而不是 ul。那为什么p那么贪心占用ul的空位呢？

请帮助澄清。将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:16:53.407

该段落在列表菜单旁边浮动，因为 UL 不再占据 100% 的宽度，因为它的子链接是浮动的。

在UL`overflow:auto`或`clear:left`段落上设置规则将产生类似的结果，其中段落不会浮动到列表旁边。

这个[W3C wiki 条目](http://www.w3.org/wiki/Floats_and_clearing)可能有助于理解：

> 正如您在上面看到的，父框通常不会展开以包含浮动的子框。这通常会导致混淆，例如，当您通过浮动所有 li 元素从无序列表中创建水平菜单时，元素的所有子级都浮动。由于浮动框被从流中取出并且不会影响父框，因此浮动所有子框有效地使父框为空，并且它将折叠到零高度。有时这是不可取的，例如，如果您想在父对象上设置背景。如果父级的高度为零，则背景将不可见。

# php - 使用 php curl 上传文件

> ID：15622814
> 
> 赞同：1
> 
> 时间：2013-03-25T19:10:17.183
> 
> 标签：php, libcurl

发送错误的 mime 类型。文件类型为“video/mp4”，但“application / octet-stream”作为发送。我想发送“视频/mp4”。卷曲选项（$file = 真实路径）

```
$post = array('videoupload'=>'1','input_1'=>"@$file");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS,$post);
curl_setopt($ch, CURLOPT_INFILESIZE,(string)filesize($file));
curl_setopt($ch, CURLOPT_INFILE,fopen($file,'r')); 
```

Http 调试器输出

> > ------------------94a50e65d9fe 内容处置：表单数据；名称="视频上传"
> 
> 1 ------------------94a50e65d9fe 内容处置：表单数据；名称=“输入_1”；文件名="1.mp4" 内容类型：应用程序/八位字节流

我试过了

```
$post = array('videoupload'=>'1','input_1'=>"@$file;type=video/mp4");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS,$post);
curl_setopt($ch, CURLOPT_INFILESIZE,(string)filesize($file));
curl_setopt($ch, CURLOPT_INFILE,fopen($file,'r')); 
```

curl_error 输出：

> 创建 formpost 数据失败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:31:05.553

尝试像这样在 curl_setopt 中添加 CURLOPT_HTTPHEADER

```
curl_setopt($ch, CURLOPT_HTTPHEADER,array('Content-Type: video/mp4')); 
```

# objective-c - 标签栏未显示在 XCode 的扩展视图中

> ID：15622816
> 
> 赞同：1
> 
> 时间：2013-03-25T19:10:24.317
> 
> 标签：objective-c, xcode, uitabbarcontroller, storyboard

！我是一个客观的c初学者。我已经研究了这个问题的时间并观看了 youtube 视频，但仍然无法解决这个问题 - 我创建了第一个视图作为第一个标签的标签栏控制器，如图所示。然后我尝试用另外两个视图扩展第一个视图：一个主表视图和一个详细 UIView。第一个视图通过第一个视图上的按钮链接到主表视图。我编译运行项目，一切都很顺利，除了主表视图和详细 UIView 上没有显示标签栏。我试图添加标签栏项目，但仍然没有显示任何内容。我还检查了属性检查器以确保底部栏属性设置为“推断”，我现在该怎么办？谢谢你的帮助。![在此处输入图像描述](../Images/c7303feecd069836d3ee4fb2dd95a1f9.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T10:22:09.897

Tab bar 控制器加载的视图控制器必须是 UINavigationController。查看您在此处上传的图像，我认为您的情况不会发生这种情况。下图一定能帮助你理解我的观点。![在此处输入图像描述](../Images/0fb1989ef52b824cb782d140d5162e34.png)

一旦你像上面那样设置你的故事板，你的问题就会得到解决。

# tinymce - Cakephp TinyMce

> ID：15622817
> 
> 赞同：1
> 
> 时间：2013-03-25T19:10:27.323
> 
> 标签：tinymce, cakephp-2.1

我正在尝试使用 cakePhp 设置 TinyMce，唯一加载的是 textarea。我要从 The Bakery 发表这篇文章：

[http://bakery.cakephp.org/articles/galitul/2012/04/11/helper_tinymce_for_cakephp_2](http://bakery.cakephp.org/articles/galitul/2012/04/11/helper_tinymce_for_cakephp_2)

我检查了我的文件的拼写，我有 webroot/js/tiny_mce 和 View/Helper/TinymceHelper.php。我需要在布局中添加其他内容吗？

在我的控制器中，我有：

```
public $helpers = array('Html', 'Form', 'Session', 'Tinymce'); 
```

我的观点：

```
<?php echo $this->Tinymce->input('description', array(
     'label' => 'content'),
     array('language' => 'en'
         ),
     'bbcode'
     ); 
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T14:53:44.947

我找不到上面的助手，所以我尝试了 CakeDC 制作的这个插件来解决问题：[https ://github.com/CakeDC/TinyMCE](https://github.com/CakeDC/TinyMCE)

在 app/plugin 目录中提取文件后，您只需在控制器中添加一个可能类似于以下内容的帮助程序：

```
public $helpers = array('TinyMCE.TinyMCE'); 
```

在 /app/config/bootstrap.php 文件中我添加了：

```
CakePlugin::load('TinyMCE');

...

Configure::write('TinyMCE.configs', array(
'advanced' => array(
    'mode' => 'textareas',
    'theme' => 'advanced',
    'plugins' => 'emotions,spellchecker,advhr,insertdatetime,preview',
    'theme_advanced_buttons1' => 'newdocument,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,fontselect,fontsizeselect,formatselect',
    'theme_advanced_buttons2' => 'cut,copy,paste,|,bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,|,code,preview,|,forecolor,backcolor',
    'theme_advanced_buttons3' => 'insertdate,inserttime,|,spellchecker,advhr,,removeformat,|,sub,sup,|,charmap,emotions',
    'width' => '700',
    'theme_advanced_toolbar_location' => 'top',
    'theme_advanced_toolbar_align' => 'left',
    'theme_advanced_statusbar_location' => 'bottom',
    'theme_advanced_resizing' => 'true'
    )
  )
); 
```

您可以访问 TinyMCE 网站并根据需要配置设置。

然后，一旦我完成了配置并将助手添加到我的控制器中，我添加了：

```
$this->TinyMCE->editor('advanced'); 
```

这会将表单上的 textarea 转换为 TinyMCE 编辑器并从 bootstrap.php 加载设置（请注意，您仍然必须在视图上创建 textarea 输入）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-07T21:11:27.323

如果您的 CakePHP 项目使用 Composer 进行依赖管理，并且您想包含 CakeDC TincyMCE 插件 ( [https://github.com/CakeDC/TinyMCE](https://github.com/CakeDC/TinyMCE) )，您可以在 composer.json 中使用以下配置

```
{
    "require": {
        "cakedc/tiny-mce": "1.2.0"
    },
    "extra": {
        "installer-paths": {
            "app/Plugin/TinyMCE": ["cakedc/tiny-mce"]
        }
    }
} 
```

在这种情况下，我已经指定了一个自定义的“安装程序路径”，因为我的 CakePHP 应用程序位于 /app 中，但我的 composer.json 位于根目录中。没有这个，插件最终会出现在 /Plugin/TinyMCE 而不是 /app/Plugin/TinyMCE

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T12:14:57.607

您需要知道的第一件事是，目前，教程位于： [http](http://bakery.cakephp.org/articles/galitul/2012/04/11/helper_tinymce_for_cakephp_2) ://bakery.cakephp.org/articles/galitul/2012/04/11/helper_tinymce_for_cakephp_2 适用于 TinyMCE 3.x。我什至没有开始重建给定的代码以适应 4.x。更重要的是，教程使用了位于 TinyMCE 3.x 包中的高级主题。

如果你使用 CakePHP 2.x 版和 TinyMCE，它应该工作得很好：

1.  从官方 TinyMCE 网站下载 3.x 包：[http](http://www.tinymce.com/download/download.php) ://www.tinymce.com/download/download.php ，
2.  按照教程中的说明提取 jscripts/tiny_mce 目录（到 app/webroot/js/）
3.  添加：`public $helpers = array('Tinymce');`到每个需要 TinyMCE 的控制器。
4.  使用教程中的代码在 App/View/Helpers 目录中创建 TinymceHelper.php
5.  在 add/edit 或您为带有 tinyMCE 字段的文件指定的任何名称中，创建如下字段：`$this->Tinymce->input('ModelName.fieldname', $options = array(), $tinyoptions = array(), $preset = null);`
    示例：
    `echo $this->Tinymce->input('StaticPage.description', array('label' => 'Content'),array(), 'full');`

我希望这对任何人都有帮助:-)

# android - 谷歌地图 v2 模块。Android 应用程序未在地图视图中显示地图

> ID：15622818
> 
> 赞同：4
> 
> 时间：2013-03-25T19:10:28.450
> 
> 标签：android, titanium-mobile, google-maps-api-2

我正在使用新的 Google map v2 模块在我的 android 应用程序中显示地图。我正在执行以下步骤。应用程序安装和工作正常。我面临的问题是视图内没有地图。

1）首先我下载了​​地图模块并放入以下文件夹。

```
/Users/fkamani/Library/Application\ Support/Titanium/modules/android/ 
```

2) 在 tiapp.xml 文件中添加地图模块。

```
<module platform="android">ti.map</module> 
```

3) 在 tiapp.xml 中添加以下 android manifest

```
<android xmlns:android="http://schemas.android.com/apk/res/android">
        <manifest>
            <!-- Allows the API to download data from Google Map servers -->
            <uses-permission android:name="android.permission.INTERNET"/>
            <!-- Allows the API to cache data -->
            <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
            <!-- Use GPS for device location -->
            <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
            <!-- Use Wi-Fi or mobile connection for device location -->
            <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
            <!-- Allows the API to access Google web-based services -->
            <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
            <!-- Specify OpenGL ES 2.0 as a requirement -->
            <uses-feature android:glEsVersion="0x00020000" android:required="true"/>
            <!-- Replace com.domain.appid with your application ID -->
            <uses-permission android:name="com.mycompanyname.myprojectname.permission.MAPS_RECEIVE"/>
            <permission android:name="com.mycompanyname.myprojectname.permission.MAPS_RECEIVE"
                android:protectionLevel="signature"/>
            <application>
                <!-- Replace "PASTE YOUR GOOGLE MAPS API KEY HERE" with the Google API key you obtained -->
                <meta-data android:name="com.google.android.maps.v2.API_KEY"
                    android:value="My App key"/>
            </application>
        </manifest>
    </android> 
```

4) 更改Titamium sdk 版本。

```
<sdk-version>3.0.2.GA</sdk-version> 
```

5) 从钛文档中复制以下代码并放入 app.js 文件

```
var MapModule = require('ti.map');
var win = Titanium.UI.createWindow();

var mountainView = MapModule.createAnnotation({
    latitude:37.390749,
    longitude:-122.081651,
    title:"Appcelerator Headquarters",
    subtitle:'Mountain View, CA',
    pincolor:MapModule.ANNOTATION_RED,
    myid:1 // Custom property to uniquely identify this annotation.
});

var mapview = MapModule.createView({
    mapType: MapModule.NORMAL_TYPE,
    region: {latitude:33.74511, longitude:-84.38993,
            latitudeDelta:0.01, longitudeDelta:0.01},
    animate:true,
    regionFit:true,
    userLocation:true,
    annotations:[mountainView]
});

win.add(mapview);
// Handle click events on any annotations on this map.
mapview.addEventListener('click', function(evt) {
    Ti.API.info("Annotation " + evt.title + " clicked, id: " + evt.annotation.myid);
});
win.open(); 
```

6) 我创建了新的密钥库文件并使用此密钥库文件创建分发版本。

7) 为了创建谷歌地图 API 密钥，我在控制台中复制了 SHA1 证书指纹；com.mycompanyname.myprojectname。

应用程序已成功安装在我的三星 S3 设备中。当我运行该应用程序时，它会显示带有 +,- 按钮的地图视图以进行缩放。唯一的问题是地图视图内没有地图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T15:37:04.313

在移动设备上编译时检查您的 Studio 控制台，并查找：

```
[DEBUG] jarsigner -sigalg MD5withRSA -digestalg SHA1 -storepass ******* -keystore "YOUR_PATH_TO_KEYSTORE" -signedjar 
```

如果密钥库位于“.../mobilesdk/osx/3.0.2.GA/android/dev_keystore”中，您需要使用 dev_keystore 的 SHA1 证书创建一个谷歌地图 API 密钥。

这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T18:25:39.727

我注意到一个非常相似的问题。在我的应用程序中，我使用了一个视图管理器，它在屏幕外加载内容，然后通过设置 left 属性为屏幕上的视图设置动画。我可以让地图出现的唯一方法是，如果我还包括在动画调用中更改不透明度。我创建了一个小型 Alloy 应用程序来说明。

index.js

```
function doClick(e) {  
    $.mapView.animate({left:0, opacity:1})
}

var map1 = MapModule.createView({
    userLocation: true,
    mapType: MapModule.NORMAL_TYPE,
    animate: true,
    region: {latitude: -33.87365, longitude: 151.20689, latitudeDelta: 0.1, longitudeDelta: 0.1 },
    height: '100%',
    top: 0,
    left: 0,
    width: '100%'
});

$.mapView.add(map1);

$.win.open(); 
```

索引.xml

```
<Alloy>
    <Window class="container" id="win">
        <Label onClick="doClick" height="100">Click HERE</Label>
        <View id="mapView">

        </View>
    </Window>
</Alloy> 
```

索引.tss

```
".container": {
    backgroundColor:"white"
},
"#mapView": {
    top:0,
    bottom:0,
    opacity:1,
    width:Ti.Platform.displayCaps.platformWidth,
    left:Ti.Platform.displayCaps.platformWidth
} 
```

如果您从动画调用中删除不透明度，则地图将按照您的描述显示为空白。

```
function doClick(e) {  
    $.mapView.animate({left:0})
} 
```

这是一个似乎对我有用的肮脏技巧，尽管我很想知道为什么更改动画调用中的不透明度（只需添加 $.mapView.opacity = 1; 不起作用）会使地图出现......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T09:21:37.430

我的 Galaxy s3 也有同样的问题。对我来说，解决方案是我将地图模块移动到我的项目（ modules/android/ti.map/2.1.2 ）并且我的 AndroidManifest.xml 给我带来了麻烦，当我删除它时它工作得很好，我有同样的和你一样的问题。

希望这会有所帮助。此外，可以在这里看到一个非常好的视频，其中一个人实际上展示了完整的设置（非常感谢他！）： [http ://www.youtube.com/watch?v=M4fUlqKWg7g](http://www.youtube.com/watch?v=M4fUlqKWg7g)

# python - 去重和重新排序字典

> ID：15622821
> 
> 赞同：1
> 
> 时间：2013-03-25T19:10:36.477
> 
> 标签：python, django

假设我们有一个基本模型。

```
class Log(models.Model):
    key = fields.BigInteger()
    calldate = fields.DateTimeField()
    followupdate = fields.DateTimeField() 
```

可以为同一个键设置多个 followupdates。我想做的是在列表中显示最近（按通话日期）安排的后续行动。

在我看来，我有以下几点：

`# views.py`

```
def callbacks(request):
    """ get objects where a followupdate has been specified """
    q = Log.objects.filter(followupdate__isnull = False).order_by("-calldate")

    """ deduplicate key so only most recently scheduled followupdate show """ 
    newresults = []
    seen_key = []   
    for result in q:
        if result.key not in seen_key:
            seen_key.append(result.key)
            newresults.append(result)

    results = newresults
    """ What I want to do is equivalent to results.order_by("followupdate") """
    """ But since it's a dictionary now and not a queryset, I can't """
    return render_to_response('callbacks.html', {"callbacks":results}) 
```

我需要帮助的是`results`通过 key重新排序字典 , `followupdate`。在每个字典中都有一个这样的键：`'followupdate': datetime.date(2013, 3, 25)`这是我需要重新排序的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:34:49.157

`.sort()`似乎像这样工作-

```
l.sort(key=lambda item:item['followupdate'], reverse=True) 
```

测试用例 -

```
>>> l = [{'followupdate': datetime.date(2013, 3, 25)}, {'followupdate': datetime.date(2013, 3, 24)}, {'followupdate': datetime.date(2013, 3, 29)}]
>>> l
[{'followupdate': datetime.date(2013, 3, 25)}, {'followupdate': datetime.date(2013, 3, 24)}, {'followupdate': datetime.date(2013, 3, 29)}]
>>> l.sort(key=lambda item:item['followupdate'], reverse=True)
>>> l
[{'followupdate': datetime.date(2013, 3, 29)}, {'followupdate': datetime.date(2013, 3, 25)}, {'followupdate': datetime.date(2013, 3, 24)}] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:56:19.780

您应该让数据库进行重复数据删除，而不是从数据库中获取记录仅在 Python 中丢弃它们，这是浪费时间和带宽。

Django 的对象-关系映射不能做到这一点，但你可以在 SQL 中这样做：

```
SELECT L1.*
FROM myapp_log AS L1,
     (SELECT MAX(date) AS maxdate, `key`
      FROM myapp_log GROUP BY `key`) as L2
WHERE L1.date = L2.maxdate
  AND L1.`key` = L2.`key`
  AND L1.followupdate IS NOT NULL
ORDER BY L1.date DESCENDING 
```

（字段名称`key`需要引用，因为它是 SQL 关键字。）

[`raw()`然后，您可以使用方法](https://docs.djangoproject.com/en/1.5/topics/db/sql/#django.db.models.Manager.raw)从 Django 运行此查询，如下所示：

```
sql = '''
    SELECT L1.* FROM myapp_log AS L1,
    # and so on (see above)
    '''
q = Log.objects.raw(sql) 
```

# simulation - 尝试提前检查色块并根据前面色块的色块做出决定

> ID：15622823
> 
> 赞同：3
> 
> 时间：2013-03-25T19:10:41.667
> 
> 标签：simulation, netlogo

我试图让乌龟检查前方补丁的颜色并决定移动到哪里。如果前面的补丁不是白色的，那么海龟会向左或向右旋转并移动。我的 If 决策构造中出现错误，显示“此处应为 TRUE？FALSE，而不是块列表”。知道可能是什么原因造成的吗？我对我的 while 循环使用了相同的逻辑，这似乎工作正常。下面是我的代码，错误发生在代码“ifelse [[pcolor] of patch-ahead 1 != white]”的第一行。

```
 ifelse [[pcolor] of patch-ahead 1 != white][
     ifelse(tempx < xcor)[
       set heading 270
       jump 1
       ]
     [ 
       set heading 90
       jump 1
     ]
 ] 
```

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T23:08:50.307

您有语法错误。ifelse 中的条件不应该在块中。

像这样修复它：

```
ifelse [pcolor] of patch-ahead 1 != white [
.... 
```

# html - iframe 不呈现页面，iframe 的源仅将页面显示为文本

> ID：15622825
> 
> 赞同：0
> 
> 时间：2013-03-25T19:10:43.967
> 
> 标签：html

为了简单起见，假设我有标准的 .html 文档。现在，我正在做的是围绕这个文档中的所有内容：`<iframe> {everything} </iframe>`. 现在，当我查看页面的源代码时，我可以看到页面已在 iframe 中加载，但未显示。为什么不显示？

编辑：好的，这是一个简单的例子：

```
<iframe>
 <!DOCTYPE html>
 <html>
    <head></head>
    <body>asdf</body>
 </html>
</iframe> 
```

将其保存为 .html 并启动 - 代码将在那里，但不会显示。为什么？

# prompt - 我试图阻止 SaveFileDialog 从 elseif DialogResult.No 提示（并取消）

> ID：15622826
> 
> 赞同：0
> 
> 时间：2013-03-25T19:10:45.137
> 
> 标签：prompt, savefiledialog

基本上我是这类事情的初学者，我正在尝试通过创建自己的记事本应用程序来练习，类似地复制微软的记事本。我在网上搜索了几个小时都没有成功。

所以问题是，我从 ToolStripMenu 中的“新建”项开始，当按下时，它会提示用户消息“你想保存对这个文档的更改吗？”，如果用户按下是，SaveFileDialog显示，用户可以将其保存到他/她喜欢的任何地方。如果用户按否，则 RichTextDialogBox 中的信息被清除，如果用户按取消，则按计划返回，不做任何更改。但是，当我单击“否”和/或“取消”按钮时，它仍会使用 SaveFileDialog 框提示用户。是否有人可以帮助我稍微更改我的代码，以便它停止按钮“否”和“取消”提示用户使用 SaveFileDialog？

```
 Private Sub NewToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NewToolStripMenuItem.Click
    Dim intResult As Integer = Nothing
    Dim dlg As SaveFileDialog = New SaveFileDialog
    dlg.Filter = "Text File (*.txt)|*.txt"
    intResult = MessageBox.Show("Do you want to save the changes made to this document?", "Warning", MessageBoxButtons.YesNoCancel)
    If dlg.ShowDialog = Windows.Forms.DialogResult.Yes Then
        RichTextBox1.SaveFile(dlg.FileName, RichTextBoxStreamType.RichText)
    ElseIf intResult = Windows.Forms.DialogResult.No Then
        RichTextBox1.Clear()
    End If
    If intResult = Windows.Forms.DialogResult.Cancel Then
        Return
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:24:53.960

我相信这是因为您将对话框作为 If 条件测试的一部分

尝试以下

```
Private Sub NewToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NewToolStripMenuItem.Click

    Dim intResult As Integer = Nothing
    Dim dlg As SaveFileDialog = New SaveFileDialog

    dlg.Filter = "Text File (*.txt)|*.txt"
    intResult = MessageBox.Show("Do you want to save the changes made to this document?", "Warning", MessageBoxButtons.YesNoCancel)

    If intResult = Windows.Forms.DialogResult.Yes Then
        dlg.ShowDialog
        RichTextBox1.SaveFile(dlg.FileName, RichTextBoxStreamType.RichText)
    ElseIf intResult = Windows.Forms.DialogResult.No Then
        RichTextBox1.Clear()
    Else
        Return
    End If

End Sub 
```

# javascript - JS 滑块仅适用于兼容性视图 IE8

> ID：15622827
> 
> 赞同：0
> 
> 时间：2013-03-25T19:10:45.510
> 
> 标签：javascript, internet-explorer-8, slider, slideshow

我目前正在建立一个网站，并得出结论我的滑块在 IE8 中不起作用。所有其他浏览器都很好，但滑块在兼容性视图中不起作用:(

有谁能帮忙吗？

很多问候。

```
$(function() {

            $("#slideshow > div:gt(0)").hide();

            setInterval(function() { 
              $('#slideshow > div:first')
                .fadeOut(1000)
                .next()
                .fadeIn(1000)
                .end()
                .appendTo('#slideshow');
            },  6000);

        }); 
```

# c# - 一次打开我项目中所有已关闭的表单

> ID：15622828
> 
> 赞同：2
> 
> 时间：2013-03-25T19:10:48.757
> 
> 标签：c#, winforms, forms

我发现以下代码将遍历我项目中所有关闭的表单并打开一个 MessageBox 并显示表单名称。

但是，我将如何修改它而不是显示 MessageBox；它实际上会一个一个地打开每个封闭的表格吗？我更喜欢使用 ShowDialog 或类似的东西，所以每个表单一次只能打开 1 个，而不是一次打开。只要我关闭一个表单，下一个表单就会打开，依此类推，这会很好。

```
//http://kellyschronicles.wordpress.com/2011/08/06/show-all-forms-in-a-project-with-c/
System.Reflection.Assembly myAssembly = System.Reflection.Assembly.GetEntryAssembly();
Type[] Types = myAssembly.GetTypes();
foreach (Type myType in Types)
{
   if (myType.BaseType == null) continue;

       if (myType.BaseType.FullName == "System.Windows.Forms.Form")
       {
           //Application.Run(myType.Name());  //This does not work
           MessageBox.Show(myType.Name);
       }   

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:18:21.140

尝试这个：

```
var form = (Form)Activator.CreateInstance(myType);
form.ShowDialog(); 
```

您可以将它与像这样的默认构造函数或带参数的构造函数一起使用，但这有点棘手。
更多信息请参见：[Activator.CreateInstance 方法](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:28:56.323

```
System.Reflection.Assembly myAssembly = System.Reflection.Assembly.GetEntryAssembly();
Type[] Types = myAssembly.GetTypes();
foreach (Type myType in Types)
{
   if (myType.BaseType == null) continue;

       if (myType.BaseType.FullName == "System.Windows.Forms.Form")
       {
           //Application.Run(myType.Name());  //This does not work
           //MessageBox.Show(myType.Name);
           var myForm = (System.Windows.Forms.Form)
                  Activator.CreateInstance(myAssembly.Name, myType.Name);
           myForm.Show();
       }   

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:14:09.337

您需要向 Application.Run 方法提供表单的新实例。尝试将其转换为形式并创建新实例。像这样的东西：

```
public Form TryGetFormByName(string frmname)
{
   var formType = Assembly.GetExecutingAssembly().GetTypes().Where(a => a.BaseType == typeof(Form) && a.Name == frmname).FirstOrDefault();
   if (formType == null) // If there is no form with the given frmname
       return null;
   return (Form)Activator.CreateInstance(formType);
} 
```

从此帖子[Winforms，按表单名称获取表单实例](https://stackoverflow.com/questions/12091818/winforms-get-form-instance-by-form-name)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T19:16:10.753

尝试这个：

```
 if (myType.BaseType.FullName == "System.Windows.Forms.Form")
   {
       //Application.Run((Form)myType);
       Application.Run((Form)Activator.CreateInstance(myType));
   } 
```

# asp.net - 意外的应用程序池回收，为什么？

> ID：15622830
> 
> 赞同：1
> 
> 时间：2013-03-25T19:10:56.193
> 
> 标签：asp.net, iis, application-pool, recycle

我知道有几个关于这个的帖子，但我有不同的情况。

就我而言，我禁用了 IIS 中的所有选项以回收应用程序池

*   在几分钟内，
*   在请求中，
*   在某个时间，
*   通过内存，虚拟和使用。

对以下可能导致应用程序池回收的文件没有任何更改：

*   网络配置，
*   机器配置，
*   全球.asax,
*   Bin 目录，以及
*   应用程序代码

当 Windows 窗体应用程序多次调用我的服务器上托管的 Web 服务时会发生这种情况 - 应用程序池被回收，并且我的 Windows 窗体应用程序由于 Web 服务不可用而崩溃。

关于其他什么事情会导致应用程序池回收的任何想法？

# c# - CanClose - 父导体中的新子节点以保存文档

> ID：15622831
> 
> 赞同：0
> 
> 时间：2013-03-25T19:10:58.337
> 
> 标签：c#, caliburn.micro, lifecycle

我有外壳，其中包含 TabViewModel（单独作为属性，并通过 ContentControl 显示在视图中）。在 TabViewModel 我打开一个文档。文档的 VM 又依赖于 LoadSaveVM 来加载和保存文档。Document VM本身是IScreen对象的Conductor，但是使用子VM来显示文档的数据。

直到现在，一切都很顺利。我已经实现了“脏”行为，即当文档被更改时，它被标记为脏，因此当关闭它时，会询问用户，如果他/她想要保存它，不要保存它，或者取消关闭。

所有这些都是通过 Caliburn.Micro 的常规框架（`IGuardClose`、`DefaultCloseStrategy`、`Conductor<IScreen>`等）处理的。

问题是，当文档 VM 被关闭并且用户选择保存时，我`InvalidOperationException`从 List 的**Enumerator**获得，因为 TabViewModel 的**Items**属性发生了变化（LoadSaveVM 显示为处理保存）。

通过调用Shell上的协程（SaveDocument）调用保存，委托给TabVM的ActiveItem，即Document VM，返回协程，在TabVM中执行LoadSaveVM就结束。

从我的立场来看，有两种解决方案：

*   修改 TabViewModel 的关闭策略
*   修改 DocumentVM 的 SaveDocument 协程的行为，直到加载/保存完成后才会结束。

但是，在我看来，这两种解决方案都不是很干净，至少在我的情况下是这样。

注意：文档实际上是一个文件，加载/保存需要很长时间（因此 LoadSaveVM 显示此类操作的进度）。

# html - 内容隐藏在固定位置的 div 下

> ID：15622832
> 
> 赞同：-2
> 
> 时间：2013-03-25T19:11:03.137
> 
> 标签：html, css

这是代码：

```
 <body style="margin: 0; background-color: #FFFFFF; color: #001f1f; font-family: 'Oxygen', sans-serif; font-size: 15px; background-image:url('img/2.png');">

<div style="width: 100%; height: 20px; position: fixed; background-color: #001f1f; text-align: right; color: #ffffff; padding-right: 100px;"><span style="float: left;">Search</span>View your shopping cart</div>
<div style="width: 100%; height: 100px; margin-top: 20px; position: fixed; background-color: #f1f1f1; box-shadow: 0px 3px 3px #c9c9c9;"><a href="#"><img src="img/logo.png" style="float:left;"></a></div>

Text example 
```

我应该如何更改“文本示例”不会成为那些固定的 div 的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:22:37.233

[http://jsfiddle.net/k7um4/](http://jsfiddle.net/k7um4/)

`position: fixed`将元素移出流。因此它们对 DOM 位置中的以下元素没有任何影响。虽然您的第一个 div 具有高度，但它们不会占用流程中的任何实际空间 - 而您的“文本示例”只是向上滑动以填充它们留下的空间。

为了让元素被看到，你需要通过向容器元素（你的身体）添加填充来适应它们所占据的空间。我添加了一个小提琴并`top: 0px`在两个元素上都指定了一个（如果你正在修复和元素，你可能想要指定你的顶部/左侧位置。）

# php - 通过 SSL 下载损坏的 IE8 文件

> ID：15622833
> 
> 赞同：0
> 
> 时间：2013-03-25T19:11:11.517
> 
> 标签：php, file, ssl, internet-explorer-8, download

我编写并维护了一个网站，两周前的 3 月 11 日星期一……就在两次 IE 更新和夏令时生效之后。这段代码坏了，但只适用于运行 IE8 的 Windows XP 机器，并且只适用于 SSL 加密。问题是我需要安全地传输这个文件。此代码同样适用于 XP 机器上的 firefox，或 Windows 7 上的 IE 9

该文件根据请求创建并立即删除

问题不是间歇性的......它一直失败......而且很快（基本上立即......所以没有超时问题或其他东西）

这是错误：http: [//i.imgur.com/j0cOJ0L.png](http://i.imgur.com/j0cOJ0L.png)

这是当前的 PHP 文件：

```
//////////////////
// Download script
//////////////////

$path = $_SERVER['DOCUMENT_ROOT']."/mysite/"; // change the path to fit your websites document structure
$fullPath = $path.$B->LastName.$P->Property_ID.".fnm"; 
if ($fd = fopen ($fullPath, "r")) {
    $fsize = filesize($fullPath);
    $path_parts = pathinfo($fullPath);
    $ext = strtolower($path_parts["extension"]);
    switch ($ext) {
       case "fnm":
        header("Content-type: application/fnm"); // add here more headers for diff. extensions
       header("Content-Disposition: attachment; filename=\"".$path_parts["basename"]."\""); // use 'attachment' to force a download
        break;
        default;
        header("Content-type: application/octet-stream");
        header("Content-Disposition: filename=\"".$path_parts["basename"]."\"");
    }
    header("Content-length: $fsize");
    header("Cache-control: private"); //use this to open files directly
    while(!feof($fd)) {
        $buffer = fread($fd, 2048);
        echo $buffer;
    }
}
fclose ($fd);

////////////////////////
//Delete the file from the server
/////////////////////////
$myFile = $path.$B->LastName.$P->Property_ID.".fnm"; 
unlink($myFile);

exit; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-01T15:57:30.323

当我运行测试时，似乎只需要将**缓存控制设置为 Private**，并添加**Pragma: private**标头
示例代码：

```
header('Content-Disposition: attachment; filename='.urlencode($zipFileName));
header('Content-Type: application/zip');
header('Content-Length: '.filesize($zipFileName) );
header("Cache-Control: private");
header("Pragma: private");
readfile($zipFileName); 
```

通过 https 像 IE8 一样工作。

# xcode - Xcode/Parse - PFQuery NSMutableArray 问题

> ID：15622836
> 
> 赞同：0
> 
> 时间：2013-03-25T19:11:22.703
> 
> 标签：xcode, arrays, parsing, nsmutablearray

[这可能是一个菜鸟问题，但我花了很多时间来解决这个问题。]

基本上，我使用 www.parse.com 服务将我的数据存储在云中。我正在检索一个名为 objects 的 NSArray，它在控制台中的结果是：

```
2013-03-25 19:59:06.118 app[18960:c07] (
"<users:u8WRDUlfVg:(null)> {\n    pairs =     (\n        14120151,\n        14749606,\n        17230018\n    );\n    username = GeoffroyMorel;\n}"
) 
```

然后，因为我想要 NSMutableArray 中的“对”值，所以我这样做：

```
pairsUserMutableArray = [objects mutableArrayValueForKey:@"pairs"]; 
```

控制台中的结果非常好，除了多了一对括号（这可能是以下问题的原因）：

```
2013-03-25 19:59:06.119 app[18960:c07] (
    (
    14120151,
    14749606,
    17230018
)
) 
```

现在的问题是，当我尝试添加一个对象并在控制台中显示结果时，它带有这样的括号：

```
2013-03-25 20:02:45.887 app[18960:c07] (
    (
            (
        14120151,
        14749606,
        17230018
    ),
    15749606
)
) 
```

我想要这样：

```
2013-03-25 20:02:45.887 app[18960:c07] (
    14120151,
    14749606,
    17230018,
    15749606
) 
```

感谢您的帮助，我确定我只是缺少可以正确订购 NSMutableArray 的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T17:57:11.340

好的，我刚刚找到了答案，我没有注意到从查询中收到的“对象”是一个 NSArray ！你只需要这样：

```
PFQuery *query = [PFQuery queryWithClassName:@"Users"];
[query whereKey:@"username" equalTo:userAccount.username];

[query findObjectsInBackgroundWithBlock:^(NSArray *objects, NSError *error) {
if (!error) {
    NSLog(@"%@", objects);

    NSArray *array = [objects objectAtIndex:0];//Selects the first "object" from all the "objects"
    array = [array valueForKey:@"pairs"];//Makes a NSArray from the "pairs" values
    pairs = [array mutableCopy];//Converts the array to a NSMutableArray

    NSLog(@"%@, %i", pairs, pairs.count);
} else {
    // Log details of the failure
    NSLog(@"Error: %@ %@", error, [error userInfo]);
}
}]; 
```

# java - ownCloud android，FC滚动文件列表时

> ID：15622843
> 
> 赞同：0
> 
> 时间：2013-03-25T19:11:52.297
> 
> 标签：java, android, forceclose, owncloud

从源代码构建 ownCloud 后，滚动到文件显示页面底部时，我得到一个 FC。

日志猫

```
03-25 14:45:05.868: E/AndroidRuntime(31619): FATAL EXCEPTION: main
03-25 14:45:05.868: E/AndroidRuntime(31619): java.lang.ArrayIndexOutOfBoundsException: length=1; index=1
03-25 14:45:05.868: E/AndroidRuntime(31619):    at edu.sage.cloud.DisplayUtils.getResourceId(DisplayUtils.java:147)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at edu.sage.cloud.ui.adapter.FileListListAdapter.getView(FileListListAdapter.java:118)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.AbsListView.obtainView(AbsListView.java:2123)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.ListView.makeAndAddView(ListView.java:1772)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.ListView.fillDown(ListView.java:672)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.ListView.fillGap(ListView.java:636)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.AbsListView.trackMotionScroll(AbsListView.java:4684)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.AbsListView.scrollIfNeeded(AbsListView.java:2963)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.widget.AbsListView.onTouchEvent(AbsListView.java:3234)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.View.dispatchTouchEvent(View.java:5556)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1951)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1712)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1940)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1390)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.app.Activity.dispatchTouchEvent(Activity.java:2414)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1888)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.View.dispatchPointerEvent(View.java:5736)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3017)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2582)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewRootImpl.processInputEvents(ViewRootImpl.java:887)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2591)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.os.Looper.loop(Looper.java:137)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at android.app.ActivityThread.main(ActivityThread.java:4697)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at java.lang.reflect.Method.invokeNative(Native Method)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at java.lang.reflect.Method.invoke(Method.java:511)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
03-25 14:45:05.868: E/AndroidRuntime(31619):    at dalvik.system.NativeStart.main(Native Method) 
```

相关代码：

```
public View getView(int position, View convertView, ViewGroup parent) {
    View view = convertView;
    if (view == null) {
        LayoutInflater inflator = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        view = inflator.inflate(R.layout.list_item, null);
    }
    if (mFiles != null && mFiles.size() > position) {
        OCFile file = mFiles.get(position);
        TextView fileName = (TextView) view.findViewById(R.id.Filename);
        String name = file.getFileName();

        fileName.setText(name);
        ImageView fileIcon = (ImageView) view.findViewById(R.id.imageView1);
        fileIcon.setImageResource(DisplayUtils.getResourceId(file.getMimetype()));
        ImageView localStateView = (ImageView) view.findViewById(R.id.imageView2);
        FileDownloaderBinder downloaderBinder = mTransferServiceGetter.getFileDownloaderBinder();
        FileUploaderBinder uploaderBinder = mTransferServiceGetter.getFileUploaderBinder();
        if (downloaderBinder != null && downloaderBinder.isDownloading(mAccount, file)) {
            localStateView.setImageResource(R.drawable.downloading_file_indicator);
            localStateView.setVisibility(View.VISIBLE);
        } else if (uploaderBinder != null && uploaderBinder.isUploading(mAccount, file)) {
            localStateView.setImageResource(R.drawable.uploading_file_indicator);
            localStateView.setVisibility(View.VISIBLE);
        } else if (file.isDown()) {
            localStateView.setImageResource(R.drawable.local_file_indicator);
            localStateView.setVisibility(View.VISIBLE);
        } else {
            localStateView.setVisibility(View.INVISIBLE);
        }

        TextView fileSizeV = (TextView) view.findViewById(R.id.file_size);
        TextView lastModV = (TextView) view.findViewById(R.id.last_mod);
        ImageView checkBoxV = (ImageView) view.findViewById(R.id.custom_checkbox);

        if (!file.isDirectory()) {
            fileSizeV.setVisibility(View.VISIBLE);
            fileSizeV.setText(DisplayUtils.bytesToHumanReadable(file.getFileLength()));
            lastModV.setVisibility(View.VISIBLE);
            lastModV.setText(DisplayUtils.unixTimeToHumanReadable(file.getModificationTimestamp()));
            // this if-else is needed even thoe fav icon is visible by
            // default
            // because android reuses views in listview
            if (!file.keepInSync()) {
                view.findViewById(R.id.imageView3).setVisibility(View.GONE);
            } else {
                view.findViewById(R.id.imageView3).setVisibility(View.VISIBLE);
            }

            ListView parentList = (ListView) parent;
            if (parentList.getChoiceMode() == ListView.CHOICE_MODE_NONE) {
                checkBoxV.setVisibility(View.GONE);
            } else {
                if (parentList.isItemChecked(position)) {
                    checkBoxV.setImageResource(android.R.drawable.checkbox_on_background);
                } else {
                    checkBoxV.setImageResource(android.R.drawable.checkbox_off_background);
                }
                checkBoxV.setVisibility(View.VISIBLE);
            }

        } else {
            fileSizeV.setVisibility(View.GONE);
            lastModV.setVisibility(View.GONE);
            checkBoxV.setVisibility(View.GONE);
            view.findViewById(R.id.imageView3).setVisibility(View.GONE);
        }
    }

    return view;
} 
```

和：

```
public static int getResourceId(String mimetype) {

    if (mimetype == null || "DIR".equals(mimetype)) {
        return R.drawable.ic_menu_archive;

    } else {
        String[] parts = mimetype.split("/");
        String type = parts[0];
        String subtype = parts[1];

        if (TYPE_TXT.equals(type)) {
            return R.drawable.file_doc;

        } else if (TYPE_IMAGE.equals(type)) {
            return R.drawable.file_image;

        } else if (TYPE_VIDEO.equals(type)) {
            return R.drawable.file_movie;

        } else if (TYPE_AUDIO.equals(type)) {
            return R.drawable.file_sound;

        } else if (TYPE_APPLICATION.equals(type)) {

            if (SUBTYPE_PDF.equals(subtype)) {
                return R.drawable.file_pdf;

            } else if (SUBTYPES_DOCUMENT_SET.contains(subtype)) {
                return R.drawable.file_doc;

            } else if (SUBTYPES_COMPRESSED_SET.contains(subtype)) {
                return R.drawable.file_zip;
            }

        }
        // problems: RAR, RTF, 3GP are send as application/octet-stream from
        // the server ; extension in the filename should be explicitly
        // reviewed
    }

    // default icon
    return R.drawable.file;
} 
```

# css - Image and text on same line?

> ID：15622844
> 
> 赞同：1
> 
> 时间：2013-03-25T19:11:57.110
> 
> 标签：css, image, text, alignment, inline

This is giving me a headache...

I'm trying to have an image of fixed height/width on the left, and text on the right, in the same line of course. The overall container has a dynamic width of 90% of viewport, meaning that the text on the right will also have a dynamic width (90% - image width) since the image on the left is fixed. The text needs to be aligned left, so "float:right" won't work. I've tried countless combinations of floats, aligns, table cells, etc, nothing works... closest I've got to was they were in the same line, but the text was forced aligned to the right.

Image of what I mean: [http://i.imgur.com/QRDhLro.png](http://i.imgur.com/QRDhLro.png)

```
#container {
overflow:hidden;
position:relative;
width:90%;
min-width:800px;
margin-bottom:20px;
margin-top:20px;
margin-left:auto;
margin-right:auto;
}
.leftimage {
width:600px;
height:100px;
}
.righttext {    
float:right;
}

...
...

<div id="container">

    <div class="righttext">lorem ipsum lorem ipsum <br> lorem ipsum lorem ipsum </div>

    <div class="leftimage"><img src="../pictures/test.png"></div>

</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T19:15:46.923

移动

```
<div class="righttext">lorem ipsum lorem ipsum <br> lorem ipsum lorem ipsum </div> 
```

后

```
<div class="leftimage"><img src="../pictures/test.png"></div> 
```

CSS：

```
.righttext{
    float: none;
    margin-left: 600px;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T19:15:01.743

也许只是：

```
<img src="#" align="left">
<p>This is my paragraph to the right of my image</p> 
```

这确实有效，如此处所示：http: [//jsfiddle.net/tWqwh/](http://jsfiddle.net/tWqwh/)

# java - avoiding going back to main thread after opening camera android

> ID：15622845
> 
> 赞同：0
> 
> 时间：2013-03-25T19:12:02.917
> 
> 标签：java, android, camera

So I'm programming my first app, and I have a loading screen which shows my logo and a loading bar. This is actually just for the looks. But when I want to take a picture with the camera, and inserting it into an imageview, it goes back to the loading screen, and not to my second screen after pressing ok button in the camera app.

Does anyone know what to do about this?

my code:

second activity:

```
public void makeFoto(View v) {
    Intent photoIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
    startActivityForResult(photoIntent, CAMERA_PHOTO_REQUEST);
    photoIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
} 
```

and

```
protected void onActivityResult(int requestCode, int resultCode, Intent data){
    super.onActivityResult(requestCode, resultCode, data);
    if(resultCode == RESULT_OK){
        if(requestCode == CAMERA_PHOTO_REQUEST){
            Bundle extras = data.getExtras();
            Bitmap bmp = (Bitmap) extras.get("data");
            ImageView imv = (ImageView) findViewById(R.id.imvFoto);
            imv.setImageBitmap(bmp);
            //HttpGetMethod client = new HttpGetMethod();

        }
    }
} 
```

loading screen:

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_load_screen);
        (new Thread(){
            @Override
        public void run(){
            for(int i = 0; i<255; i++){
                // next will pause the thread for some time
                try{ sleep(5); }
                   catch(Exception e)

                   { break; }
                }
                startActivity(new Intent(LoadScreen.this,Home.class));
            }
        }).start();
    } 
```

# .htaccess - Rewrite dynamic url structure with .hataccess

> ID：15622846
> 
> 赞同：1
> 
> 时间：2013-03-25T19:12:08.063
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, sef

I've tried to rewrite the dynamic URL (below) to a slightly different structure; either does not work or I am not sure if it is correct:

*   Old URL (URL#1): index.php?lang=AAA&zone=BBB&city=CCC&str=DDD&search=EEE
*   New URL (URL#11): index.php?lang=AAA&country=BBB&place=CCC&street=DDD

*basically changed the names and the "search" string is not important any more

*   what I am trying to achieve is redirecting all visitors from (old) dynamic URL#1 to (new) dynamic URL#11

In a second step, after all search engines show the new urls and we finished all test that are easier with non-sef urls, we would like to rewrite URL#11 to URL#2

*   New URL (URL#11): index.php?lang=AAA&country=BBB&place=CCC&street=DDD
*   Sef URL (URL#2): /AAA/BBB/CCC/DDD

I am not very familiar with apache programming and even when my solution works, we are not sure if it is the right one or if it will generate errors with certain URLs. Any help would be highly appreciated in creating a .htaccess file that does the step 1 redirection and a separate .htaccess file to be used later, for SEF urls. THANK YOU!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T06:34:12.970

> `http://example.com/index.php?lang=AAA&zone=BBB&city=CCC&str=DDD&search=EEE`
> 
> 重定向到：
> 
> `http://example.com/AAA/BBB/CCC/DDD`
> 
> 默默地映射到：
> 
> `http://example.com/index.php?lang=AAA&country=BBB&place=CCC&street=DDD`

您可以在根目录中的一个 .htacces 文件中尝试此操作：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /

RewriteCond %{QUERY_STRING} lang=([^&]+)&zone=([^&]+)&city=([^&]+)&str=([^&]+)&search=  [NC]
RewriteRule .* /%1/%2/%3/%4?   [R=301,L,NC]

RewriteCond %{REQUEST_URI} ^/([^/]+)/([^/]+)/([^/]+)/([^/]+)/?  [NC]
RewriteCond %{REQUEST_URI} !index\.php                          [NC]
RewriteRule .* /index.php?lang=%1&country=%2&place=%3&street=%4 [L,NC] 
```

如果查询包含以下格式的参数：`%nn`，请尝试将 **B**标志添加到两个规则中。示例：[L,NC,B]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T16:35:57.903

[这是来自faa](https://stackoverflow.com/users/1679045/faa)的有效代码（第一步）：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /

RewriteCond %{QUERY_STRING} lang=([^&]+)&zone=([^&]+)&city=([^&]+)&str=([^&]+)&search=  [NC]
RewriteRule .* /index.php?lang=%1&country=%2&place=%3&street=%4 [L,NC] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:17:40.003

假设你的变量只包含小写字母和数字，试试这个：

```
RewriteRule ^/([a-z0-9]+)/([a-z0-9]+)/([a-z0-9]+)/([a-z0-9]+)$
    /index.php?lang=$1&country=$2&place=$3&street=$4
RewriteCond %{QUERY_STRING}
    ^lang=([a-z0-9]+)&zone=([a-z0-9]+)&city=([a-z0-9]+)&str=([a-z0-9]+)&search=[a-z0-9]+$
RewriteRule ^index.php$
    /index.php?lang=%1&country=%2&place=%3&street=%4 [R=permanent] 
```

（请注意，必须**没有换行符**，但我已将它们插入此处并带有缩进，只是为了使该块在此网页上可读。）

# cakephp - external sql query in cakephp

> ID：15622849
> 
> 赞同：0
> 
> 时间：2013-03-25T19:12:25.470
> 
> 标签：cakephp

I have trouble with this code in cakephp for a sql query

Here my code in RankingsController.php

```
<?php
class RankingsController extends AppController {
    public $helpers = array('Html', 'Form', 'Session');
    public $components = array('Session');

    public function index() {

    $this->Ranking->virtualFields += array(
    'totalpoints' => 0);    

    $rankings = $this->Ranking->query("
    select turnierranks.teilnehmer_id as teilnehmer_id, 
    teilnehmers.nachname, teilnehmers.vorname,
    sum(pointtab.points) as totalpoints
    from turnierranks, pointtab, turniers, teilnehmers 
    where 
    turnierranks.turnier_id = turniers.id and
    turniers.turnierkategorie = pointtab.kategorie and
    turnierranks.rank     = pointtab.rank and
    teilnehmers.id = teilnehmer_id
    group by teilnehmer_id, teilnehmers.nachname, teilnehmers.nachname
    order by totalpoints desc");

      debug($rankings); 

    }
 } 
```

debug (rankings$) show the right querydata

but in views/Rankings/index.cpt i get the error

Undefined variable: rankings [APP/View/Rankings/index.ctp, line 12] and the same error for the next line

```
 LINE 12: <?php   debug($rankings); ?>

<?php foreach ($rankings as $ranking): ?> 
```

in Model ranking.php

```
<?php
class Ranking extends AppModel {
 public $useTable = false; 
} 
```

whats is wrong with the $rankings variable array?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:50:17.723

要将变量从控制器传递到视图，您需要设置一个`viewVar`;

在您的示例中：

```
$rankings = ..........

$this->set('rankings', $rankings); 
```

第一个参数是要创建/设置的 viewVar 的名称，例如：

```
$this->set('FooBar', $rankings); 
```

将创建一个 viewVar 'FooBar' 包含 $rankings 的内容，这些内容将通过变量在您的视图中可用`$FooBar`

[请参阅文档交互视图](http://book.cakephp.org/2.0/en/controllers.html#interacting-with-views)中的这一章

## 自定义查询/原始 SQL

这不是您的问题的一部分，但是，您似乎正在编写自己的 SQL 语句来检索数据。这不仅允许代码中存在潜在的 SQL 漏洞，还可以*跳过*CakePHP 模型的大部分功能。

以“正确”的方式使用 CakePHP 模型，将减少所需的代码量，并适当地保护您免受 SQL 注入等攻击。

请阅读文档中关于模型的章节；

[http://book.cakephp.org/2.0/en/models.html#models](http://book.cakephp.org/2.0/en/models.html#models)

[http://book.cakephp.org/2.0/en/models/retrieving-your-data.html](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html)

# asp.net - MVC WebApi HttpGet with complex object

> ID：15622852
> 
> 赞同：8
> 
> 时间：2013-03-25T19:12:40.080
> 
> 标签：asp.net, asp.net-web-api, deserialization, json.net

I have an existing WebApi action, that I want to switch from HttpPost to HttpGet. It currently takes a single complex object as parameter.

**The model:**

```
public class BarRequest
{
    [JsonProperty("catid")]
    public int CategoryId { get; set; }
} 
```

**The controller:**

```
public class FooController : ApiController
{
    //[HttpPost]
    [HttpGet]
    [ActionName("bar")]
    public void Bar([FromUri] BarRequest request)
    {
        if (request != null)
        {
            // CategoryId should be 123, not 0
            Debug.WriteLine("Category ID :: {0}", request.CategoryId);
        }
    }
} 
```

Now when I send the following request, everything works as expected.

```
GET /foo/bar?CategoryId=123 
```

Also the old POST request worked as expected.

```
POST /foo/bar {"catid":123} 
```

But now I need the following request to work:

```
GET /foo/bar?catid=123 
```

How can I accomplish this?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-26T13:31:53.910

感谢您的建议，但唯一适合我的解决方案如下。

**前：**

```
var data = {
    catid: 123,
    // <snip>
};
var json = JSON.stringify(data);
$.post('/foo/bar', json, callback); 
```

```
public class FooController : ApiController
{
    [HttpPost, ActionName("bar")]
    public void Bar(BarRequest request)
    {
        // use request.Category to process request
    }
} 
```

**后：**

```
var data = {
    catid: 123,
    // <snip>
};
var json = JSON.stringify(data);
$.get('/foo/bar?data=' + encodeURIComponent(json), callback); 
```

```
public class FooController : ApiController
{
    [HttpGet, ActionName("bar")]
    public void Bar(string data)
    {
        var request = JsonConvert.DeserializeObject<BarRequest>(data);
        // use request.Category to process request
    }
} 
```

这样我就不需要在客户端或服务器上接触任何模型、验证器等。此外，所有其他解决方案都要求我更改服务器或客户端的命名约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T22:44:46.213

您可以通过使用 datacontracts 和 datamember 属性来做到这一点：

[http://msdn.microsoft.com/en-us/library/ms733127.aspx](http://msdn.microsoft.com/en-us/library/ms733127.aspx)

```
[DataContract]
public class BarRequest{  

   [DataMember(Name="catid")]  
    public int CategoryId { get; set; }
} 
```

如果是 Post 方法

但是使用 get 方法，这是复杂对象的结构示例：

```
api/Bar?request.CategoryId =1&request.AnotherProp=foo 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-28T16:53:42.033

有一个扩展方法可以完全满足您`URI`的要求： . 您可以在 ApiController: 中从您的请求中获取 URI 。这是它的样子：`System.Net.Http.UriExtensions``TryReadQueryAs<T>(out T model)``Request.RequestUri`

```
public class FooController : ApiController
{
    //[HttpPost]
    [HttpGet]
    [ActionName("bar")]
    public void Bar()
    {
        BarRequest request;
        if (Request.RequestUri.TryReadQueryAs(out model))
        {
            // CategoryId should be 123, not 0
            Debug.WriteLine("Category ID :: {0}", request.CategoryId);
        }
    }
} 
```

仅当您指定`[DataContract]`Joan 建议的类似内容时，这可能才有效。

但是请注意，将解析一个空的查询字符串，因此如果您曾经根据数据是否被`POST`编辑来执行不同的操作，则需要检查模型的有效性。无论如何，希望你这样做。

# python - Passing variables when invoking a Python script

> ID：15622853
> 
> 赞同：1
> 
> 时间：2013-03-25T19:12:40.940
> 
> 标签：python, variables

Is it possible to pass variables to Python when invoking a script from a bash shell?

For example, when I would call my_script in the shell like this:

```
python my_script.py -par1 -par2 
```

is it possible to use `par1` and `par2` as variables in Python so I can pass them as arguments to a function?

Something similar like for shell scripting, where in something like this:

```
my_script.sh par1 
```

`par1` would be stored as $1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:13:23.740

You can get the commandline arguments from [`sys.argv`](http://docs.python.org/2/library/sys.html#sys.argv)

Python also comes with a variety of commandline processing utilities. I would recommend [`argparse`](http://docs.python.org/2.7/library/argparse.html) which is included in the standard library starting with version 2.7\. But there is also `optparse` or even `getopt` for the adventurous.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:25:46.290

壳：

```
python my_script.py -par1 -par2 
```

Python：将它们作为参数传递给函数：

```
import sys

arg1,arg2 = sys.argv[1:3]

myfunc(arg1,arg2) 
```

# c++ - using regex for searching strings in VS2010

> ID：15622854
> 
> 赞同：0
> 
> 时间：2013-03-25T19:12:42.283
> 
> 标签：c++, visual-studio-2010, search

Hi I have been trying to search a string pattern in Visual Studio 2010 using regex. The string pattern is something like "abc[somevar].ppfunc"

Now "abc" and "ppfunc" are fixed terms but "somevar" could be any string of any length. For example: it could be abc[xyz].ppfunc or abc[ghid].ppfunc or abc[blah].ppfunc

What wild card should I use in place of "somevar" so that search results should contain all possible words present in the code.

I tried abc[*].ppfunc and abc[.*].ppfunc (in Find and replace box of VS) but it didn't work.

any quick suggestions ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:37:25.620

您需要使用 VS2010 的基于正则表达式的查找和替换功能，如此[处](http://msdn.microsoft.com/en-us/library/2k3te2cs%28VS.100%29.aspx)所述。为此，请确保启用正则表达式：

> 要启用正则表达式，请在查找和替换窗口中展开查找选项，选择使用，然后选择正则表达式。查找内容和替换为字段旁边的三角形表达式生成器按钮变为可用。

然后构造一个匹配你想要替换的正则表达式。

# templates - ITextSharp 4.1.6 - Remove existing line from PDF Template

> ID：15622855
> 
> 赞同：1
> 
> 时间：2013-03-25T19:13:08.053
> 
> 标签：templates, border, itextsharp, acrofields

I have a PDF template created in LibreOffice and I'm filling it in using AcroFields. In some rare cases I'd like to hide a particular field, thus I remove it using RemoveField method. It's border however stays in there. From what I've googled it seems it's probably the way LibreOffice creates the forms.

What I've came up with so far was to get the rectangle of the field and cover it with white image. Problem however is, customer plans creating templates using background image and/or other background color than white making my current solution almost unusable

The question therefore is - is there some way I could remove the borders? [e.g. by accessing some low-level object model of ITextSharp, or something like that]

Thanks a lot in advance

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T13:49:23.740

删除单个绘图对象可能会有些棘手，但并非不可能。最困难的部分是决定要删除哪些对象。下面是一些针对 iTextSharp 4.1.6 的示例代码，它首先创建一个带有两个矩形的 PDF，然后基于第一个 PDF 创建第二个 PDF，其中一个矩形被删除。您需要应用您的逻辑来确定要删除的矩形。您可能实际上没有矩形，而是恰好形成矩形的线条，在这种情况下，您也需要稍微修改代码。

第一点只是在桌面上创建一个带有两个矩形的基本 PDF：

```
//Create a file on the desktop with two rectangles
var file1 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "File1.pdf");
using (var fs = new FileStream(file1, FileMode.Create, FileAccess.Write, FileShare.None)) {
    var doc = new Document();
    var writer = PdfWriter.GetInstance(doc, fs);
    doc.Open();

    var cb = writer.DirectContent;

    //Draw two rectangles
    cb.SaveState();
    cb.SetColorStroke(iTextSharp.text.Color.RED);
    cb.Rectangle(40, 60, 200, 100);
    cb.Stroke();
    cb.RestoreState();

    cb.SaveState();
    cb.SetColorStroke(iTextSharp.text.Color.BLUE);
    cb.Rectangle(500, 80, 90, 50);
    cb.Stroke();
    cb.RestoreState();

    doc.Close();
} 
```

下一部分是更复杂的部分。我鼓励您`Console.WriteLine(tokenizer.StringValue);`在循环内部进行操作`while`以查看所有 PDF 命令。您会注意到他们使用[RPN 语法](http://en.wikipedia.org/wiki/Reverse_Polish_notation)，这可能需要一点时间来使用。有关更多问题，请参阅代码中的注释。

```
//Bind a reader to our first file
var reader = new PdfReader(file1);
//Get the first page (this would normally be done in a loop)
var page = reader.GetPageN(1);
//Get the "contents" of that page
var objectReference = (PdfIndirectReference)page.Get(PdfName.CONTENTS);
//Get the actual stream of the "contents"
var stream = (PRStream)PdfReader.GetPdfObject(objectReference);
//Get the raw bytes of the stream
var streamBytes = PdfReader.GetStreamBytes(stream);
//Convert the bytes to actual PDF tokens/commands
var tokenizer = new PRTokeniser(new RandomAccessFileOrArray(streamBytes));
//We're going to re-append each token to this below buffer and remove the ones that we don't want
List<string> newBuf = new List<string>();
//Loop through each PDf token
while (tokenizer.NextToken()) {
    //Add them to our master buffer
    newBuf.Add(tokenizer.StringValue);
    //The "Other" token is used for most commands, so if we're on "Other" and the current command is "re" which is rectangle
    if (
        tokenizer.TokenType == PRTokeniser.TK_OTHER && //The "Other" token is used for most commands
        newBuf[newBuf.Count - 1] == "re" &&            //re is the rectangle command
        newBuf[newBuf.Count - 5] == "40"               //PDFs use RPN syntax so the red rectangle command was "40 60 200 100 re"
        ) {
        newBuf.RemoveRange(newBuf.Count - 5, 5);       //If the above conditions were met remove the last 5 commands
    }
}

//Convert our array to a string with newlines between each token, convert that to an ASCII byte array and push that back into the stream (erasing the current contents)
stream.SetData(System.Text.Encoding.ASCII.GetBytes(String.Join("\n", newBuf.ToArray())));

//Create a new file with the rectangle removed
var file2 = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "File2.pdf");
using (var fs = new FileStream(file2, FileMode.Create, FileAccess.Write, FileShare.None)) {
    //Bind a stamper to our read above which has the altered stream
    var stamper = new PdfStamper(reader, fs);
    //Loop through each page
    int total = reader.NumberOfPages;
    for (int i = 1; i <= total; i++) {
        //Push the content over page by page
        reader.SetPageContent(i, reader.GetPageContent(i));
    }
    stamper.Close();
}
reader.Close(); 
```

# python - How can I delay execution until after several concurrent processes are all finished?

> ID：15622861
> 
> 赞同：1
> 
> 时间：2013-03-25T19:13:43.380
> 
> 标签：python, file, subprocess, wait, popen

I am using subprocess.Popen() to run processes and wait for them to finish before executing other things. For a single process I wrote my code in this general form:

```
process = subprocess.pOpen(['command', 'options...', '1> output.txt'])
process.wait()

more code... 
```

and it worked just fine. The script waited for the process to output the results to output.txt before moving on to 'more code...'

However, I'm not sure what to do in order to run several concurrent processes, and wait for all of them to be done in order to move on to the rest of the code. Without the logic for waiting, my code generally looks like this:

```
for i in range(0, n_streams):
    os.system("start /b command [options] 1> output{0}.txt".format(i)) 
```

and it works fine; each process writes output to a text file and they run at the same time as I'd like. I just can't figure out how to make the program wait for all of them to have written to a text file before moving on.

I keep thinking all I need to do is replace os.system() with pOpen() and use wait() as I did for above for a single process, but this would just cause the instances of the process to run sequentially.

To reiterate my question: how can I run many instances of a process at the same time, and wait until all instances have finished (written to their respective output file) before moving on?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-15T00:42:28.820

只需存储所有已启动的进程，然后等待每个进程：

```
# Start and store all of your processes
processes = []
for i in range(0, n_streams):
    processes.append(subprocess.Popen(['command', 'options...', '1> output.txt']))

# Wait for all of them to complete
for proc in processes:
    proc.wait() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:36:56.230

使用[subprocess.Popen.returncode](http://docs.python.org/2/library/subprocess.html#subprocess.Popen.returncode)您可以检查子进程是否结束。

# angularjs - AngularJS directive controllers requiring parent directive controllers?

> ID：15622863
> 
> 赞同：30
> 
> 时间：2013-03-25T19:13:46.333
> 
> 标签：angularjs, angularjs-directive, angularjs-scope

I might be thinking about this completely backwards, but I'm trying to make three nested directives, lets call them: screen, component and widget. I want widget to be able to trigger some behavior in component, which in turn triggers some behavior in screen. So:

```
.directive('screen', function() {
    return {
        scope: true,
        controller: function() {
            this.doSomethingScreeny = function() {
                alert("screeny!");
            }
        }
    }
})

.directive('component', function() {
    return {
        scope: true,
        controller: function() {
            this.componentFunction = function() {
                WHAT.doSomethingScreeny();
            }
        }
    }
})

.directive('widget', function() {
    return {
        scope: true,
        require: "^component",
        link: function(scope, element, attrs, componentCtrl) {
            scope.widgetIt = function() {
                componentCtrl.componentFunction();
            };
        }
    }
})

<div screen>
    <div component>
        <div widget>
            <button ng-click="widgetIt()">Woo Hoo</button>
        </div>
    </div>
</div> 
```

I can require parent components in a widget's link fn using `require: "^component"`, but how do I further give components controller access to its containing screen?

What I need is the WHAT in component so when you click the widget's button it alerts "screeny!".

Thanks.

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-25T22:00:53.363

这里有两种方法可以解决您的问题：

1.  由于您使用的是`scope: true`，因此所有范围都原型继承。因此，如果您在控制器中定义方法`$scope`而不是 on ，那么两者和都可以访问 function 。 [小提琴](http://jsfiddle.net/mrajcok/bVWbN/)。`this``screen``component``widget``doSomethingScreeny`

2.  `component`在和上定义链接函数`require: '^screen'`。在链接函数中，将 screenCtrl 保存到范围属性中，然后您可以在指令的控制器中访问它（注入`$scope`）。
    [小提琴](http://jsfiddle.net/mrajcok/StXFK/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-10T15:02:54.583

当您想在创建控制器时直接从父控制器访问属性或方法时，大多数这些东西都会失败。我通过使用依赖注入和使用`$controller`服务找到了另一个解决方案。

```
.directive('screen', function ($controller) {
    return {
       require: '^parent',
       scope: {},
       link: function (scope, element, attr, controller) {
           $controller('MyCtrl', {
                $scope: scope,
                $element: element,
                $attr, attr, 
                controller: controller
           });
       }
    }
})

.controller('MyCtrl, function ($scope, $element, $attr, controller) {}); 
```

此方法可更好地测试，并且不会用不需要的控制器污染您的示波器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-28T15:24:49.967

```
var myApp = angular.module('myApp', [])

.directive('screen', function() {
  return {
    scope: true,
    controller: function() {
      this.doSomethingScreeny = function() {
        alert("screeny!");
      }
    }
  }
})

.directive('component', function() {
  return {
    scope: true,
    controller: function($element) {
      this.componentFunction = function() {
        $element.controller('screen').doSomethingScreeny();
      }
    }
  }
})

.directive('widget', function() {
  return {
    scope: true,
    controller: function($scope, $element) {
      $scope.widgetFunction = function() {
        $element.controller('component').componentFunction();
      }
    }
  }
})

.controller('MyCtrl', function($scope) {
  $scope.name = 'Superhero';
})
```

```
<body ng-app="myApp">

  <div ng-controller="MyCtrl">
    <div screen>
      <div component>
        <div widget>
          <button ng-click="widgetFunction()">Woo Hoo</button>
        </div>
      </div>
    </div>
  </div>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
```

如果要从*组件指令控制器（不是链接函数）访问**屏幕*指令控制器中定义的函数，可以使用（从*组件*指令）。*`$element.controller('screen').doSomethingScreeny()`*

 **[JSFiddle](http://jsfiddle.net/50y4569a/3/ "JSFiddle")

角[文件](https://docs.angularjs.org/api/ng/function/angular.element "文件")：

> *   `controller(name)`- 检索当前元素或其父元素的控制器。默认情况下检索与 `ngController`指令关联的控制器。如果`name`作为 camelCase 指令名称提供，则将检索该指令的控制器（例如 `'ngModel'`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-02T09:44:38.090

return { scope: true } 或 return { scope: false } 不影响控制器中的 $scope 变量：每个指令中的 function($scope) {}，但指令标签必须放入 ng-controller 或 ng-app 标签.

[JSFiddle](http:////jsfiddle.net/mrajcok/bVWbN/)

[JSFiddle](http:////jsfiddle.net/mrajcok/StXFK/)**

# android - Android 空白区域上的谷歌地图

> ID：15622866
> 
> 赞同：0
> 
> 时间：2013-03-25T19:13:55.947
> 
> 标签：android, google-maps

我在 Android（api10）上的 GoogleMaps 遇到了一些奇怪的问题，我想我得到了在我的活动屏幕上显示地图所需的一切，但它显示为空白（带有网格和缩放按钮的灰色空间）。这是我的 AndroidManifest、布局文件和活动源。

[更新]我为地图制作了另一个项目

AndroidManifest

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="pl.example.mapa"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="10"
    android:targetSdkVersion="16" />

<permission android:name="your.application.package.permission.MAPS_RECEIVE" android:protectionLevel="signature"/>
<uses-permission android:name="your.application.package.permission.MAPS_RECEIVE"/>
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />   

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name="pl.example.mapa.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="AIzaSyATooww6ZGs80CF_2Zyjc3OMj9igbFNu9k" />
</application> 
```

布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<fragment
    android:name="com.google.android.gms.maps.SupportMapFragment"
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

mainActivity 源

```
package pl.example.mapa;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.FragmentActivity;

import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.MapFragment;

public class MainActivity extends FragmentActivity {

private GoogleMap gMap;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    //gMap = ((MapFragment) getFragmentManager().findFragmentById(R.id.mapFragment)).getMap();
}
} 
```

我可以添加日志跟踪，因为我无法在模拟器上运行它

我敢打赌，我有点想念它，但毕竟在这一刻搜索，我不知道谁错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:27:10.970

您需要将 API 密钥添加到您的清单文件中。

[1）获取您的 API 密钥（这里](https://developers.google.com/maps/documentation/android/start)有很好的说明）

2）将以下行添加到您的清单文件的结束标记之前。

```
 <meta-data
    android:name="com.google.android.maps.v2.API_KEY"
    android:value="your_api_key"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:26:32.733

看起来您正在使用 Maps v1，我也遇到了这个问题。新的 API (v2) 要求将 API 密钥存储在 android 清单中并使用不同的库。在从 v1 迁移到 v2 时，我发现[本教程非常有用。](http://www.vogella.com/articles/AndroidGoogleMaps/article.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T21:58:50.930

似乎您正在混合使用 Google Maps 服务的两种 API。大多数情况下，您使用的是 API v1，但此权限属于 API v2：

```
<permission
android:name="pl.mariusz.georeminder.permission.MAPS_RECEIVE"
android:protectionLevel="signature"/>
<uses-permission android:name="pl.mariusz.georeminder.permission.MAPS_RECEIVE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/> 
```

并且可能是导致您出现问题的原因。

另一方面，我建议您迁移到 API v2，因为 API v1 很快就会被弃用（如果还没有的话），这是我写的一篇关于如何将 Google Map API V2 集成到您的应用程序中的博客文章：

[谷歌地图 API V2](https://blog-emildesign.rhcloud.com/?p=435)

# javascript - 找不到本地咕噜声

> ID：15622869
> 
> 赞同：12
> 
> 时间：2013-03-25T19:14:04.143
> 
> 标签：javascript, gruntjs

我已经 grunt 在本地运行得很好，但是在设置我的 Jenkins 服务器做同样的事情之后，我遇到了 grunt 无法找到 grunt 文件的问题。我可能错过了安装/配置的东西吗？我无法从错误输出中判断出什么问题，这是我在詹金斯盒子上得到的：

[user@buildserver]# ls

```
AUTHORS  CHANGELOG  coverage  Gruntfile.js  package.json  README.md  reports  spec  src 
```

[user@buildserver]# 咕噜

```
grunt-cli: The grunt command line interface. (v0.1.6)

Fatal error: Unable to find local grunt.

If you're seeing this message, either a Gruntfile wasn't found or grunt
hasn't been installed locally to your project. For more information about
installing and configuring grunt, please see the Getting Started guide:

http://gruntjs.com/getting-started 
```

这是 Gruntfile.js

```
module.exports = function(grunt) {
  'use strict';

  // Project configuration.
  grunt.initConfig({
    jasmine : {
      src : 'src/**/*.js',
      options : {
        specs : 'spec/**/*.js',
        template : require('grunt-template-jasmine-istanbul'),
        templateOptions: {
          coverage: 'reports/coverage.json',
          report: 'reports/coverage'
        }
      }
    },
  });

  grunt.loadNpmTasks('grunt-contrib-jasmine');

  grunt.registerTask('default', ['jasmine']);
}; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-25T19:35:03.380

你在你的 Jenkins 服务器中安装了 grunt 吗？

```
npm install grunt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-14T16:04:17.200

您可以从 jenkins 管理界面设置所有内容，无需在本地安装 grunt :)

## 安装 Jenkins 插件

*   Git 插件 -*用于 git*
*   Git 客户端插件 -*用于 git*
*   Git 参数插件 -*用于 git 标签*
*   GitHub API 插件 -*用于 github*
*   NodeJS Plugin -*常用 JavaScript 工具 NodeJS 和 npm 的集成*

## Git / Ant / Maven / NodeJS 安装

*   转到服务器/詹金斯/配置

吉特

*   Git -> Git 安装 -> 添加 Git -> JGit
*   Git 插件 -> 全局配置 user.name 值 = “Anthony Mckale”，全局配置 user.email 值 = “anthony.mckale@bskyb.com”

节点JS

*   NodeJS-> NodeJS 安装 -> 添加 NodeJS -> Name = "NodeJS 0.11.10"，勾选“自动安装”，选择“从 nodejs.org 安装”，将“grunt-cli”添加到全局安装的包中

## 多田

希望你可以使用 git/nodejs 和 grunt

有关如何将 grunt/node 任务添加到 jenkins 作业的更多详细信息，请参阅插件 wiki -> [https://wiki.jenkins-ci.org/display/JENKINS/NodeJS+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/NodeJS+Plugin)

这真的很容易:)

不需要 ssh 登录只需要 jenkins 管理员权限

# r - 在 R 中生成点图

> ID：15622873
> 
> 赞同：-1
> 
> 时间：2013-03-25T19:14:15.567
> 
> 标签：r, plot

我在 R 中有 3 个数据向量，并希望生成一个像这里这样的图：！（[http://r.789695.n4.nabble.com/file/n2134530/Rplot_dotplot.jpg](http://r.789695.n4.nabble.com/file/n2134530/Rplot_dotplot.jpg)）

例如，假设我有向量：

```
A=runif(50)
B=runif(50)
C=runif(50) 
```

有没有办法让我产生一个像图片中的情节？x轴上只有三个标签（A，B，C）并且值以直线上的点上升？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:18:36.720

您可以使用普通的绘图功能绘制这种绘图，只需制作适当的 x 值，例如：

```
A<-runif(50)
B<-runif(50)
C<-runif(50)

x<-rep(1:3,each=50) #generate x-coordinates
plot(x,y=c(A,B,C),xaxt="n",xlab="Groups",ylab="Values")
axis(side=1,at=1:3,labels=c("A","B","C")) 
```

或者你可以使用`stripchart`函数：

```
#This needs list or data.frame as an input
stripchart(data.frame(A,B,C),vertical=TRUE,pch=1,xlab="Groups",ylab="Values") 
```

# jquery - 按价格列排序表

> ID：15622874
> 
> 赞同：1
> 
> 时间：2013-03-25T19:14:15.920
> 
> 标签：jquery, sorting, tablesorter

这是账单清单：

```
Service   Price
---------------
S1        13 CHF
S2        Free
S3        Free
S4        40 CHF 
```

我想使用 jQuery 或纯 JavaScript 按价格对其进行排序。（不是服务器端）

我尝试了[jQuery Tablesorter](http://tablesorter.com)，但失败了。因为有些价格不是数字。( `Free`)

我能做些什么？Tablesorter 可以支持吗？或者我应该使用其他插件...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:02:17.937

以下是一些自定义排序代码，假设如下：

1.  您的表的 id 为`items`
2.  `tr`您要排序的每一行 ( ) 都有类`item`
3.  每个价格单元 ( `td`) 都有类`price`

然后只需包含以下 jQuery 代码并在您想要排序时调用该函数：（[**这是一个演示**](http://jsfiddle.net/sSC6y/)）

```
var sorted_by_price = false;

function sortByPrice() {
    $('#items').append(
        $('#items').find('tr.item').sort(function (a, b) {
            var td_a = $($(a).find('td.price')[0]);
            var td_b = $($(b).find('td.price')[0]);
            if(sorted_by_price){
                if(td_a.html() == 'Free') return 1;
                return td_b.html().replace(/\D/g, '') - td_a.html().replace(/\D/g, '');
            }else{
                if(td_a.html() == 'Free') return -1;
                return td_a.html().replace(/\D/g, '') - td_b.html().replace(/\D/g, '');
            }
        })
    );
    if(sorted_by_price) sorted_by_price = false;
    else sorted_by_price = true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:44:45.593

如果您不想使用繁重的插件，则无法手动对其进行排序：

```
$(function(){
    var table=$('#table');
    var rowsArray=$('tr',table).sort(function(current,next){
        var compareCurrent=$('td.price',current).text().toUpperCase();
        var compareNext=$('td.price',next).text().toUpperCase();
        return (compareCurrent<compareNext)? -1 : (compareCurrent > compareNext) ? 1 : 0;
    });
    $('tr',table).remove();
    $.each(rowsArray,function(index,element){
        $(element).appendTo(table)
    })
}) 
```

在此示例中，您应该将“价格”类添加到带有价格的单元格。或者你可以使用伪选择器“:last-child”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:31:11.523

您可以使用 DataTables ( [http://www.datatables.net/](http://www.datatables.net/) )。这是一个非常强大的 JS 插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T19:26:10.500

您可以编写自己的解析器。请参阅以下文档：[http ://tablesorter.com/docs/example-parsers.html](http://tablesorter.com/docs/example-parsers.html)

工作示例：

```
$.tablesorter.addParser({ 
    id: 'price', 
    is: function(s) { 
        return false; 
    }, 
    format: function(s) { 
        return s.replace(/Free/,0).replace(/ CHF/,""); 
    }, 
    type: 'numeric' 
}); 

$(function() { 
    $("table").tablesorter({ 
        headers: { 
            1: { 
                sorter:'price' 
            } 
        } 
    }); 
}); 
```

[http://jsfiddle.net/8BCHR/](http://jsfiddle.net/8BCHR/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T19:38:42.653

因为您有自定义的非数字值要排序，所以您将需要某种自定义排序功能。这是您的表格的自定义排序例程：

HTML：

```
<table id="service">
    <tr><td class="sortBy" data-sortType="findNumber">Service</td><td class="sortBy" data-sortType="numeric">Price</td></tr>
    <tr><td>S1</td><td>13 CHF</td></tr>
    <tr><td>S2</td><td>Free</td></tr>
    <tr><td>S3</td><td>Free</td></tr>
    <tr><td>S4</td><td>40 CHF</td></tr>
</table> 
```

代码：

```
$(".sortBy").click(function() {
    var self = $(this);
    var tbody = self.closest("tbody");

    // determine which column was clicked on
    var column = self.index();

    // get the sort type for this column
    var sortType = self.data("sortType");
    var sortCells = [];

    // get all rows other than the clicked on row
    //    find the right column in that row and
    //    get the sort key from it
    $(this).closest("tr").siblings().each(function() {
        var item = $(this).find("td").eq(column);
        var val = item.text();
        var matches;
        if (sortType == "numeric") {
            if (val.toLowerCase() == "free") {
                val = 0;
            } else {
                val = parseInt(val, 10);
            }
        } else {
            // find numbers in the cell
            matches = val.match(/\d+/);
            if (matches) {
                val = parseInt(matches[0], 10);
            } else {
                val = 0;
            }
        }
        sortCells.push({cell: item, data: val});
    });
    // sort by the key
    sortCells.sort(function(a, b) {
        return(a.data - b.data);
    });
    // reinsert into the table in sorted order
    for (var i = 0; i < sortCells.length; i++) {
        sortCells[i].cell.parent().appendTo(tbody);
    }
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/3w9gQ/](http://jsfiddle.net/jfriend00/3w9gQ/)

# python-importlib - 如何强制 importlib find_loader 专门使用特定路径？

> ID：15622875
> 
> 赞同：2
> 
> 时间：2013-03-25T19:14:16.427
> 
> 标签：python-importlib

`imp`我正在尝试根据要使用的模块重新实现一些代码`importlib`。`imp.find_module`函数和之间存在细微差别`importlib.find_loader`：

```
# Using imp find_module
>>> import imp
>>> imp.find_module("abc", ["some/path/module.py"])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib64/python3.3/imp.py", line 220, in find_module
    raise ImportError(_bootstrap._ERR_MSG.format(name), name=name)
ImportError: No module named 'abc'

# Using import find_loader
>>> import importlib
>>> loader = importlib.find_loader("abc", ["some/path/module.py"])
>>> loader.path
'/usr/lib64/python3.3/abc.py' 
```

看起来`importlib`正在回退到系统库，同时以独占方式`imp.find_module`使用`path`参数，最终引发异常。

如何强制`importlib.find_loader`使用特定路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-20T18:44:19.157

我认为您对两者的使用`imp`可能`importlib`不正确。路径列表应该是目录的路径，而不是特定的 .py 文件。您永远不会在 module.py 中找到 abc.py，因此导入失败。

例如，我在本地文件中定义了一些自定义 Fabric pip 函数`pip.py`，但我也想`pip.py`在我的站点包目录中加载官方。因为我第一次使用 importlib 来导入我的自定义 pip.py，所以这会`import pip`加载我的自定义版本。要将模块加载到站点包中，我必须这样做：

```
from distutils.sysconfig import get_python_lib
import imp
real_pip = imp.load_module('pip', *imp.find_module('pip', [get_python_lib()])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T13:04:13.243

这取决于您的代码的确切目标。首先，这两个调用都是错误的，因为“路径”参数是目录列表，而不是特定文件。

其次，从标准库返回 abc，因为它已经在 sys.modules 中。请记住，importlib.find_loader() 会查找指定模块的加载程序，因此这包括查找`sys.modules['abc'].__loader__`以跳过尝试不必要地查找它。如果您在标准库中指定了一个尚未导入的模块（例如 tokenize），那么 importlib.find_loader() 将返回 None。

换句话说， importlib.find_loader() 将在“路径”中指定时在特定目录中搜​​索模块，但您必须查找尚未导入的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T12:37:25.327

我发现答案不是使用 find_loader 而是使用 importlib.machinery.PathFinder 类来查找特定路径中的模块。

# mysql - MYSQL 查询返回列什么时候应该是值

> ID：15622876
> 
> 赞同：0
> 
> 时间：2013-03-25T19:14:23.383
> 
> 标签：mysql

我试图不显示`b.title`标题中值为“Money”的任何结果，但`%Money%`正在返回：

```
Unknown column 'Money' in 'where clause' 
```

**询问：**

```
SELECT `id`,`name`
FROM `users` AS u
WHERE `id` NOT IN ('
   SELECT `user_id`
   FROM `purchases` AS p
   INNER JOIN `books` b ON b.id = p.book_id AND b.title LIKE '%Money%'') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:15:39.763

删除多余的撇号：

```
SELECT `id`,`name`
FROM `users` AS u
WHERE `id` NOT IN (
   SELECT `user_id`
   FROM `purchases` AS p
   INNER JOIN `books` b ON b.id = p.book_id AND b.title LIKE '%Money%') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T13:10:25.307

让我们仔细看看您的查询以了解发生了什么：

```
WHERE `id` NOT IN ('SELECT [...] LIKE '%Money%'')
--                 |<---------------->|^     ^ ^---- another string
--                   this is a string  |     |
--                                     |     | 
--                               % is the modulo operator 
```

所以括号内的表达式为：“some string **modulo** *Money* **modulo** empty string”。如果没有引号，Money 指的是一个不存在的列名，这就是查询失败的地方。

您没有收到语法错误的唯一原因是“%”是一个有效的运算符。所以它有点“工作”是偶然的。

解决方案，如前所述：不要引用子查询，它是 SQL 表达式，而不是字符串。

# jqgrid - 当字段失去焦点时显示消息

> ID：15622877
> 
> 赞同：0
> 
> 时间：2013-03-25T19:14:36.280
> 
> 标签：jqgrid, qtip

我正在尝试将 qtip 与 jqGrid 一起使用，但我没有成功。当一个字段失去焦点时，我想显示一条消息。可能吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:05:42.240

我在自己的项目中做了一些尝试，这看起来是可以合理完成的。

两种方法取决于您的确切用例/参数。如果您想在单元格上的值的模糊处显示 qTip，那么只需将一个类应用于该值并相应地设置您的 qTip。

如果您希望它位于单元格本身上，如果您要使用类似

```
 onCellSelect: function (rowid, iCol, cellcontent, e) {
        ... //Logic to trigger the qTip on blur of the right cell

        }, 
```

这将允许您添加将 qTip 绑定到行的右侧单元格以触发 qTip 模糊的逻辑。

虽然这不是执行您正在寻找的确切代码，但我认为这是在两种情况下到达那里的正确途径。

# mysql - 在 MYSQL 中不兼容时自动更改数据

> ID：15622880
> 
> 赞同：0
> 
> 时间：2013-03-25T19:14:49.960
> 
> 标签：mysql, date, alter

我正在尝试在 MYSQL 中创建一个电影数据库（我使用 MYSQL 工作台）。

我使用 TxtToMy [(link)](http://www.withdata.com/txttomy.html)将 imdb.com 生成的 rating.csv 文件导入 MYSQL。

现在的问题是无法导入 16 部电影（共 819 部电影），因为“date_released”的格式不正确。

此错误显示在日志中：

> (#22007) 不正确的日期值：第 1 行的列“release_date”的“1983-05”

现在我想知道是否有办法更改 MYSQL 中的表以自动将格式为 YYYY-MM 的任何日期更改为 YYYY-MM-DD ，其中 DD 为 00 或其他东西。或者这样也接受不同格式的日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:02:46.567

我不太`TxtToMy`清楚，但是如果您必须使用它，*并且*如果它不允许您实现像上面提出的 didierc 这样的解决方案，那么一种选择是添加一个 VARCHAR 列来导入原始日期并使用更新“真实”日期列的触发器。

假设您的表名为`MOVIES`...

```
ALTER TABLE MOVIES ADD (RawDateFromIMDB VARCHAR(10)); 
```

然后将您的`TxtToMy`定义更改为 import into`RawDateFromIMDB`而不是`release_date`.

此触发器将获取原始日期并使用它来更新您的`release_date`列：

```
CREATE TRIGGER Movie_RawDateParse
  BEFORE INSERT ON Movies
  FOR EACH ROW
BEGIN
  SET NEW.release_date = str_to_date(NEW.RawDateFromIMDB, '%Y-%m-%d');
END; 
```

MySQL 似乎非常高兴有一个像 '1983-05-00' 这样的日期，所以当我将值“导入”`1983-05`到`RawDateFromIMDB`. 它也适用于“常规”日期，如下所示：

```
mysql> INSERT INTO Movies (RawDateFromIMDB) values ('1983-05');
Query OK, 1 row affected (0.03 sec)

mysql> INSERT INTO Movies (RawDateFromIMDB) values ('1983-06-22');
Query OK, 1 row affected (0.04 sec)

mysql> SELECT release_date, RawDateFromIMDB FROM Movies;
+--------------+-----------------+
| release_date | RawDateFromIMDB |
+--------------+-----------------+
| 1983-05-00   | 1983-05         |
| 1983-06-22   | 1983-06-22      |
+--------------+-----------------+
2 rows in set (0.00 sec) 
```

# python - 这两个脚本有什么区别？

> ID：15622887
> 
> 赞同：0
> 
> 时间：2013-03-25T18:35:43.380
> 
> 标签：python, python-3.x

我想知道这两个脚本有什么区别，输出看起来相似！

* * *

```
def test(a,b,c,*args):
    print (a,b,c)
    for n in args: print(n, end=' ')

 test('aa','bb','cc',1,2,3,4) 
```

输出：
aa bb cc
1 2 3 4

* * *

```
def test(a,b,c,*args):
    print (a,b,c)
    print (*args) 
```

输出：

```
aa bb cc  
1 2 3 4 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:37:00.457

其中一个在循环中分别打印每个值，但告诉`print()`函数在每个值之后打印一个空格而不是换行符。

第二个版本*一次性*打印所有值，中间有空格，最后有换行符。中的每个值`args`都作为单独的参数传递给`print()`函数，就好像您发出了表达式一样`print(args[0], args[1], args[2], args[3])`。

因此有区别。第一个版本打印：

```
1<space>2<space>3<space>4<space> 
```

而第二个版本打印：

```
1<space>2<space>3<space>4<newline> 
```

# c# - 仅利用类的几个属性处理的正确方法？

> ID：15622891
> 
> 赞同：0
> 
> 时间：2013-03-25T19:15:20.227
> 
> 标签：c#

我正在添加一个相当大的程序。在这个程序中，有一个从我们的数据库映射的类，其中包含每个员工的所有属性。它有姓名、电话号码、雇用日期等许多信息；总共超过40个属性。

现在，出于我个人的需要，我需要访问这些数据，但我只需要使用其中的四五个属性，而不是所有可用的属性。我将以多种方式操作这个“迷你对象”，例如搜索、返回结果以及类似性质的事物。这是一个小的，虚构的例子来补充我的解释。

```
public class BigEmployee //mapped from database
{
    public string attr1 {get;set;}
    public string attr2 {get;set;}
    public string attr3 {get;set;}
    public string attr4 {get;set;}
    //...etc, until attribute 40
}

public class SmallEmployee //IF THIS EXISTED, this all that I would need
{
    public string attr1 {get;set;} //same as BigEmployee attr1
    public string attr2 {get;set;} //same as BigEmployee attr2
    public string attr3 {get;set;} //same as BigEmployee attr3
} 
```

和一个示例方法：

```
public List<SmallEmployee> GetAllEmployees
{
    return EmployeeList;
} 
```

所以，我想知道的是，我该如何解决这个问题？我应该制作一个从主类中提取的单独对象吗？我是否应该每次都访问主类并强制它只返回某些属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T19:22:14.357

从您提供的信息中无法轻易回答您的问题。不过，我将尝试提供一些一般性指导：

看起来您的项目正在使用某种形式的 ORM，无论它是众多第三方 ORM 之一（实体框架、NHibernate、SimpleData 等）还是自产的。如果是这种情况，那么在自己的类中创建同一实体的“精简”版本实际上没有任何问题。ORM 生成的类*应该*只是 DTO（数据传输对象），因此其中不应该包含任何业务逻辑。使用此类类的优势在于，根据 ORM，它们可以减少数据库流量（因为它们只带回您使用的列）。

**但是**（这是一个很大的但是）

*它们只适合只读使用*。

大多数 ORM 依赖于将整个对象或对象图保存回数据库。它们通常不提供对数据库进行更改的方法，除非原始对象以完全 ORM 兼容的实体形式存在于内存中。这些“lite”类最常见的用途是将大量对象列表发送回用户，此时他们将以您的程序惯用的任何方式选择一个对象，然后程序将检索完整的实体对象进行编辑.

如果您需要的是完全双向支持（检索以及插入、更新和删除功能），那么您实际上仅限于使用完全实体类。

**编辑**这是使用“lite”实体的示例：

考虑我们有一个`Customer`在我们的上下文中命名的实体。我们需要一个仅包含 ID (an `int`) 和名称 (a `string`) 的 lite 客户。只需为 lite 实体定义一个类：

```
public class CustomerLite
{
    public int CustomerId { get; set; }
    public string Name { get; set; }
} 
```

然后在这样的查询中使用它：

```
var liteCustomers = context.Customers
                    .Where(c => c.Name.StartsWith("Smith, ")
                    .Select(c => new CustomerLite()
                    {
                        CustomerId = c.CustomerId,
                        Name = c.Name
                    })
                    .ToList(); 
```

（或者，如果您更喜欢查询语法而不是 lambda 语法）

```
var liteCustomers = (from c in context.Customers
                     where c.Name.StartsWith("Smith, ")
                     select new CustomerLite()
                     {
                         CustomerId = c.CustomerId,
                         Name = c.Name
                     }).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:18:24.583

是的，这是一个很好的方法。如果您想直接从数据库中将其作为查询返回，那么这是要走的路。

另一种方法是使用接口：

```
public interface ISmallEmployee
{
    string attr1 {get;set;} //same as BigEmployee attr1
    string attr2 {get;set;} //same as BigEmployee attr2
    string attr3 {get;set;} //same as BigEmployee attr3
}

public class BigEmployee : ISmallEmployee
{
    ...
} 
```

但是，ORM 可能不会直接识别这一点，因此您必须查询 all`BigEmployee`并将它们转换`ISmallEmployee`为 C#。

你也可以创建`SmallEmployee`一个基类`BigEmployee`，你需要注意如何配置你的 ORM 来解释这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:24:05.910

我认为你在正确的轨道上。

[在 SOLID http://www.codeproject.com/Articles/60845/The-SOLID-Object-Oriented-Programming-OOP-Prin](http://www.codeproject.com/Articles/60845/The-S-O-L-I-D-Object-Oriented-Programming-OOP-Prin)中查找 I

在这种情况下，将您的主要对象映射到您的客户需要的任何投影。

# css - CSS：禁用图像大小/“裁剪”图像？

> ID：15622893
> 
> 赞同：0
> 
> 时间：2013-03-25T19:15:28.580
> 
> 标签：css, image

我有一个包含大约 4000 像素宽的内联图像的页面（好的或坏的做法，没关系）。是否有 CSS 方法来“裁剪”图像以使其适合视口？基本上喜欢`background-size: cover`，但对于内联图像。

因为它是一个响应式网站，所以我为所有图像添加了这个 CSS 规则：

```
img {
  max-width: 100%;
  height: auto;
} 
```

现在，对于“裁剪”的图像，我用`overflow`,`min-`和`max-width`&尝试了一切`-heigh`，但我无法让它工作，浏览器总是使图像适合视口。设置`min-height`even 的值会导致图像被压扁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:18:46.600

如果你想使用 css 也可以使用 css 设置图像：

html:

```
<div class="img1"></div> 
```

CSS：

```
.img1 {
    background-image:url(yourimagepath);
    height: 200px; /** A set size*/
    width: 300px; /** A set size*/
} 
```

如果必须使用图像标签，则可以使用溢出属性：

HTML：

```
<div class="img1">
    <img ....>
</div> 
```

CSS：

```
.img1 {
    height: 200px; /** A set size*/
    width: 300px; /** A set size*/
    overflow:hidden;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:23:59.727

您可以将其包裹`<img>`在容器中以实现*裁剪*效果。

见例子：http: [//jsfiddle.net/amyamy86/GZzru/](http://jsfiddle.net/amyamy86/GZzru/)

HTML：

```
<div class="image">
    <img src="http://www.bubblews.com/assets/images/news/616498554_1357418372.jpg" />
</div> 
```

CSS：

```
.image {
    overflow: hidden;
    height: 500px;    /* crop size */
    width: 500px;
} 
```

# excel - 复制多选行时调整单元格列的大小

> ID：15622894
> 
> 赞同：0
> 
> 时间：2013-03-25T19:15:34.777
> 
> 标签：excel, vba

我在此代码上不断收到错误 1004“复制区域的大小/形状不同”：

我试过在一些地方插入各种 .pastespecials、.selection.autofit ......但我有点在黑暗中刺伤。

帮助？

```
Sub SaveData()

Dim rr As Range
Set rr = Selection

For Each Row In rr

   'error occurs here'
    Range("a" & i & ":BN" & i).Copy Worksheets("ArchiveData").Cells(Worksheets("ArchiveData").Rows.Count, "b").End(xlUp).Offset(1, 0) 
    Sheets("ArchiveData").Cells(Worksheets("archivedata").Cells(Rows.Count, 2).End(xlUp).Row, 1).Value = Date

    Next Row 
```

结束子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:33:11.423

首先使用 OPTION EXPLICIT！！！*（工具 > 选项 > 编辑器 > 需要变量声明）*

现在到这个特定的问题（如果启用 Option Explicit 就可以清楚地看到这一点。

`Row` in`For Each Row In rr`被视为变量或对象，而不是范围 rr 的行。

你需要使用的是

```
Dim rr As Range
Dim rrrow as Range

Set rr = Selection

For Each rrrow In rr.Rows 
```

现在下一个问题也`i`没有标注，甚至没有值，因此它很可能为零或空（0或“”或NULL）

我猜你想要进行类似的事情：

```
rrrow.Copy
With Worksheets("ArchiveData")
    .Range(........).PasteSpecial 'HERE YOU ONLY NEED TO SPECIFY THE TOP LEFT MOST CELL
End With 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T00:49:45.913

试试下面的代码：

```
Sub SaveData()

    Dim rr As Range
    Set rr = Selection

    Dim wsht As Worksheet
    On Error Resume Next
    Set wsht = Worksheets("ArchiveData")
    On Error GoTo 0

    If wsht Is Nothing Then Exit Sub

    For i = 1 To rr.Rows.Count

        Range("a" & i & ":BN" & i).Copy wsht.Cells(wsht.Range("B65000").End(xlUp).Row + 1, 2)
        wsht.Cells(wsht.Cells(Rows.Count, 2).End(xlUp).Row, 1).Value = Date

    Next
End Sub 
```

# android - android中的ListView在使用自定义适配器的android中表现得非常生涩

> ID：15622900
> 
> 赞同：0
> 
> 时间：2013-03-25T19:15:53.523
> 
> 标签：android

我正在使用自定义适配器来显示 ListView，但我的 ListView 表现得非常生涩

我的自定义适配器的代码

```
 class ListAdapter extends BaseAdapter
    {
    Context context;
    ArrayList<T> arr ;

    public ListAdapter(Context con,ArrayList<T> arrayList) {
    arr = arrayList;
    context = con;
    }

    @Override
    public int getCount() {
    return arr.size();
    }
    @Override
            public Object getItem(int arg0) {
                return arg0;
            }
    @Override
            public long getItemId(int arg0) {
                return arg0;
            }

@Override
        public View getView(int pos, View convertView, ViewGroup parent) {
            ViewHolder viewHolder;
            if(convertView == null ){
                viewHolder = new ViewHolder();
                convertView = View.inflate( context,R.layout.match_introspection_list_item, null);
                viewHolder.teamFlagOneImageView = (ImageView) convertView.findViewById(R.id.imageView1);
                viewHolder.teamFlagTwoImageView = (ImageView) convertView.findViewById(R.id.imageView3);
                viewHolder.teamOneTextView =(TextView) convertView.findViewById(R.id.textView1);
                viewHolder.teamTwoTextView =(TextView) convertView.findViewById(R.id.textView4);
                viewHolder.dateTextView =(TextView) convertView.findViewById(R.id.textView2);
                viewHolder.placeTextView =(TextView) convertView.findViewById(R.id.textView3);
                viewHolder.descTextView = (TextView) convertView.findViewById(R.id.desc);
                convertView.setTag(viewHolder);
            }else{
                viewHolder =(ViewHolder) convertView.getTag();
            }

            final MatchIntrospectionObjects obj = arr.get(pos);
            viewHolder.teamOneTextView.setText(obj.home_team_abbrev);
            viewHolder.teamTwoTextView.setText(obj.away_team_abbrev);
            viewHolder.descTextView.setText(Html.fromHtml("<b>Description: </b>")+obj.matchdescription);
            if(obj.date.equals("")){}else
                viewHolder.dateTextView.setText(splitDate(obj.date));

            viewHolder.placeTextView.setText(obj.venue);

            imageLoader.displayImage(FLAG_BASE_URL+obj.home_flag, viewHolder.teamFlagOneImageView, options, animateFirstListener);
            imageLoader.displayImage(FLAG_BASE_URL+obj.away_flag, viewHolder.teamFlagTwoImageView, options, animateFirstListener);

            return convertView;
        }
} 
```

这是 ListAdpater 的我的代码

我在 Oncreate() 方法中像这样设置 ListAdapter

```
ListAdapter adapter =new ListAdapter(this,listArray);
            mListView.setAdapter(adapter); 
```

这段代码帮助我在我的 ListView 中最小化某种程度的生涩效应。

我正在使用通用图像加载器从 URL 获取图像如果相同的图像想要从相同的 URL 获取不同的单元格，那么 Universal ImageLoader 会再次获取并再次获取，或者它在生命周期中获取一次，然后从缓存中获取可用的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:30:09.370

@Sam 推荐的视频的症结在于，每次滚动时您都在夸大您的视图，而不是使用`recycler`内置的`ListView`. `Array`您正在尝试通过使用of来加快速度`RelativeLayout`，但更好的方法是`ViewHolder`为您的视图创建一个以便可以重用它。这`ViewHolder`是一个静态内部类。像这样定义它：

```
public static class ViewHolder {
    public TextView currentRatingText;
    public TextView countryName;
    public GradientTextView rating;
    public TextView rank;
    ... 
```

}

然后在自定义适配器的构造函数中定义充气器，如下所示：`rowInflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);`

然后，您的`getView()`方法应该看起来像这样。

```
public View getView(int pos, View convertView, ViewGroup parent) {
ViewHolder viewHolder;
if (convertView == null) {
    viewHolder = new ViewHolder;
    convertView = rowInflater.inflate(context,R.layout.team_ranking_list_item, null);
    viewHolder.currentRatingText = (TextView) convertView.findViewById(R.id.Rating);
    viewHolder.countryName = (TextView) convertView.findViewById(R.id.TeamNameTextView);
    viewHolder.rating = (GradientTextView) convertView.findViewById(R.id.RatingTextView);
    viewHolder.rank =(TextView) convertView.findViewById(R.id.RankTextView);
    ...
    //Views can hold a tag, which is an object. By setting the viewHolder as the
    //view tag, we can grab it next time so we don't need to re-inflate everything.
    convertView.setTag(viewHolder);
} else {
    viewHolder = (ViewHolder)convertView.getTag();
}
//Here is where you set all of you views' data.
T t = arr.get(pos);
viewHolder.currentRatingText.setText(t.getText());
viewHolder.countryName.setText("UAE");
...
return convertView; 
```

}

`ConvertView`是离开屏幕的视图，现在可以重新用于屏幕底部的新视图。如上所述，缓存图像肯定会有所帮助，但我认为这足以让列表平滑滚动。

该视频仍然是强制观看的；罗曼盖伊是老板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T20:46:29.810

```
public View getView(int pos, View convertView, ViewGroup parent) { 
ViewHolder viewHolder;
if (convertView == null) {
viewHolder = new ViewHolder;
convertView = rowInflater.inflate(context,R.layout.team_ranking_list_item, null);
viewHolder.currentRatingText = (TextView) convertView.findViewById(R.id.Rating);
viewHolder.countryName = (TextView) convertView.findViewById(R.id.TeamNameTextView);
viewHolder.rating = (GradientTextView) convertView.findViewById(R.id.RatingTextView);
viewHolder.rank =(TextView) convertView.findViewById(R.id.RankTextView);
convertView.setTag(viewHolder);
} else 
 {
viewHolder = (ViewHolder)convertView.getTag();
}
//set data here

return convertView;
}

 static class ViewHolder {
 TextView currentRatingText;
 TextView countryName;
 GradientTextView rating;
 TextView rank;
} 
```

使用视图支架来实现平滑滚动和性能。如果您每次都显示 100 张图像而不是 findviewById，则在您的视图为空并且您设置数据时执行此操作。回收竞争。

[http://developer.android.com/training/improving-layouts/smooth-scrolling.html](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)。

您也可以使用惰性列表。[https://github.com/thest1/LazyList](https://github.com/thest1/LazyList)

要显示大量图像，您可以使用 Universal Image Loader。（为您提供比惰性列表更多的配置选项）

[https://github.com/nostra13/Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)。它基于惰性列表。您可以显示来自 sdcard、手机内存或服务器的图像。如果下载失败，您可以显示错误图像。可以显示带圆角的图像。可以缓存在磁盘或内存上。可以压缩图像。

在您的自定义适配器构造函数中

```
 File cacheDir = StorageUtils.getOwnCacheDirectory(a, "your folder");

  // Get singletone instance of ImageLoader
  imageLoader = ImageLoader.getInstance();
  // Create configuration for ImageLoader (all options are optional)
  ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(a)
      // You can pass your own memory cache implementation
     .discCache(new UnlimitedDiscCache(cacheDir)) // You can pass your own disc cache implementation
     .discCacheFileNameGenerator(new HashCodeFileNameGenerator())
     .enableLogging()
     .build();
 // Initialize ImageLoader with created configuration. Do it once.
 imageLoader.init(config);
 options = new DisplayImageOptions.Builder()
 .showStubImage(R.drawable.stub_id)//display stub image
 .cacheInMemory()
 .cacheOnDisc()
 .displayer(new RoundedBitmapDisplayer(20))
 .build(); 
```

在你的 getview()

```
 ImageView image=(ImageView)vi.findViewById(R.id.imageview); 
   imageLoader.displayImage(imageurl, image,options);//provide imageurl, imageview and options 
```

# ios - 如何在给定数字范围的情况下计算一些点

> ID：15622901
> 
> 赞同：1
> 
> 时间：2013-03-25T19:15:54.523
> 
> 标签：ios, objective-c, math

数学是很久以前的事了，我不确定我想要什么，也不知道如何计算它。想象一下，我知道我有从 1 到 100 的数字。我想给用户一个选择器/组合框，以便能够选择其中一些数字。但我不想要选择器中的所有数字。也许它显示数字 1,2,3,4,5,10,15,25,40,60,80,90,100。用我的话来说，它开始缓慢上升，然后变得更陡峭。我认为指数函数太陡了。

最终，如果有人可以向我展示如何创建一个客观的 C 方法，该方法接受两个数字并返回和 NSNumbers 数组，我会喜欢它，类似于我上面显示的。

提前谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:32:26.540

[三角数列](http://en.wikipedia.org/wiki/Triangular_number)怎么样？

**方程：** x [n] = n(n+1)/2

**序列*（从 n = 0 开始）***：0、1、3、6、10、15、21、28、36、45、55、66、78、91、105、120、136、153、171、190、210 , 231, 253, 276, 300, 325, 351, 378, 406, 435, 465, 496, 528, 561, ...

输入：1 到 100

> 最小值 = 1 ，最大值 = 100
> 
> 1 + **0** = 1
> 
> 1 + **1** = 2
> 
> 2 + **3** = 5
> 
> 5 + **6** = 11
> 
> 11 + **10** = 21
> 
> 21 + **15** = 36
> 
> 36 + **21** = 57
> 
> *依此类推..直到评估的数量超过最大值*
> 
> **序列：** 1、2、5、11、21、36、57 等等...

输入：1000 到 10000

> 最小值 = 1000 ，最大值 = 10000
> 
> 1000 + **0** = 1000
> 
> 1000 + **1** = 1001
> 
> 1001 + **3** = 1004
> 
> 1004 + **6** = 1010
> 
> 1010 + **10** = 1020
> 
> 1020 + **15** = 1035
> 
> 1035 + **21** = 1056
> 
> *依此类推..直到评估的数量超过最大值*
> 
> **序列：** 1000、1001、1004、1010、1020、1035、1056 等...

我将把实现部分留给您尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T14:49:43.880

我写了一些代码来生成

```
-(NSArray *)generateNumbersFromBeginning:(int)begin toEnd:(int)end withCount:(int)count
{
    NSMutableArray * genNumbers=[NSMutableArray new];

    double sqBegin=1.0; //our beginning generator

    double sqEnd  =sqrt((double)(end-begin)); // last element to produce

    double step = (sqEnd-sqBegin)/((double)count);//

    double power=1.0;

    NSLog(@"%f %f %f",sqBegin,sqEnd,step);

    for (int a= 0; a<count; a++) {

        sqBegin+=step;

        power += 1.0/(double)count;

        int genNumber=(int)(pow(sqBegin, power));

        genNumber+=begin;

        [genNumbers addObject:[NSNumber numberWithInt:genNumber]];

    }

    NSLog(@"numbers are: %@ ",genNumbers);

    return genNumbers;

} 
```

用法是 ([a,b], x) 其中 a 是起点 b 是终点，x 是在该范围内生成的 int 数。

例如：

```
[self generateNumbersFromBeginning:9000 toEnd:10000 withCount:36]; 
```

这个调用的结果是：

```
numbers are: (
    9001,
    9002,
    9003,
    9005,
    9006,
    9008,
    9010,
    9012,
    9014,
    9017,
    9021,
    9025,
    9029,
    9034,
    9041,
    9048,
    9056,
    9065,
    9076,
    9089,
    9104,
    9121,
    9141,
    9165,
    9192,
    9223,
    9259,
    9301,
    9350,
    9407,
    9473,
    9549,
    9638,
    9741,
    9860,
    9999
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T18:18:25.063

我不是 100% 确定您在寻找什么，但您可以使用一个简单的等式，例如：

> f(x) = floor(x ^c ) 其中 c > 1

您可以将 c 设置为提供所需陡度的任何数字。例如。对于 c = 1.5，您将有：

> 0, 1, 2, 5, 8, 11, 14, 18, 22, 27, 31, 36, 41, 46, 52, 58, 64, 70, 76, 82, 89, 96, 103, 110, 117, 125...

要调整不同的起始值 s，只需执行 f(x, s) = floor(x ^c ) + s。

* * *

另一种可能的功能是由一系列陡峭度逐渐增加的线组成。例如，这是一条由线段组成的“抛物线”：

> f(x, s) = 0.5cd(地板(x/d)) ² + 0.5cd(地板(x/d)) + c(地板(x/d) + 1)(x mod d) + s

其中 c 和 d 是您选择的常数 (≥ 1)（并且推导有点烦人）。c是初始线的斜率，d表示线段的长度。s 再次是起始值。例如，让 s = 100, c = 3, d = 4，你有以下序列（对于 x = 0, 1, 2, ...）：

> 100, 103, 106, 109, 112, 118, 124, 130, 136, 145, 154, 163, 172, 184, 196, 208, 220, 232, 247...

现在，如果我们想要“整数”，我们会将 c 和 s 设置为“整数”。但是如果我们想从一个开始计数，我们可以定义如下：

```
g(x) = x             when x = 0, 1, 2, 3, 4
     = f(x - 5, 5)   when x ≥ 5 
```

因此，如果 c = 5 且 d = 5，我们有如下序列：

> 0, 1, 2, 3, 4, 5, 10, 15, 20, 25, 30, 40, 50, 60, 70, 80, 95, 110, 125, 140, 155, 175, 195, 215, 235, 255, 280, 305, 330, 355, 380, 410, 440, 470, 500, ...

* * *

*当然，要在给定的最大值之前停止，只需在函数返回大于所需最大值的数字时停止评估函数。

# java - HashMap.put 没有按预期工作

> ID：15622915
> 
> 赞同：1
> 
> 时间：2013-03-25T19:16:40.757
> 
> 标签：java, map, hashmap

我正在尝试将 HashMap 保存在另一个哈希图中。

当我在内部哈希图中保存一个键和值时，问题就来了。

当我尝试恢复值时，总是返回 null。

这就像 HashMap 不起作用......为什么？

我尝试创建一个全局变量 protected 和 final .. 什么都没有:(

```
protected final Map<Integer,Map> HMG =  new HashMap<Integer,Map>(); //GLOBAL VARAIBLE

    List<org.jdom2.Element> hijos = root.getChildren();
    for(int i=0 ; i < hijos.size(); i++) {
        org.jdom2.Element elem = hijos.get(i);
        String file = elem.getName();
        HMG.put(i, new HashMap<String, String>());
        System.out.println("Hashmap saved to "+ i+" "+file );
        System.out.println(file + i);
        List<org.jdom2.Element> hijos2 =elem.getChildren();
        for (org.jdom2.Element e : hijos2){
            guardarAtributos(e,i);
        }
    }

public void guardarAtributos(org.jdom2.Element elemento,Integer orden) {
    List<org.jdom2.Attribute> atributos=elemento.getAttributes();
     Map<String,String> a =HMG.get(orden);
     for (org.jdom2.Attribute atrib : atributos) {
         a.put(atrib.getName(), atrib.getValue());
         System.out.println("Writting into miniHashMap ===> "+atrib.getName()+" "+" "+atrib.getValue());
         System.out.println("Testing:::::"+ a.get(0));
    }
} 
```

输出是：

```
Hashmap saved to 0 Number
Number0
Writting into miniHashMap ===> value  3
Testing:::::null
Writting into miniHashMap ===> value  1
Testing:::::null
Writting into miniHashMap ===> value  4
Testing:::::null
Hashmap saved to 1 Number
Number1
Writting into miniHashMap ===> value  88
Testing:::::null 
```

编辑！：谢谢你，但是当我试图恢复一个值时，使用

```
public void recuperarHashMap(Integer orden){
 Map<String,String> hash= HMG.get(orden);
 for(Entry<String, String> entry: hash.entrySet()) {
     System.out.println(entry.getKey());
     System.out.println(entry.getValue());
 }
} 
```

测试类：

```
a.recuperarHashMap(0);
a.recuperarHashMap(1); 
```

输出：

```
value
4
value
88 
```

我只得到最后一个值！！为什么？！！！非常感谢你:) 我是个菜鸟！:(

编辑2！

XML就是这样（用emf工具编辑器制作的）

```
<?xml version="1.0" encoding="UTF-8"?>
<xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:language1="language1">
  <language1:Number id="PI">
    <has value="3"/>
    <has value="1"/>
    <has value="4"/>
  </language1:Number>
  <language1:Number id="888">
    <has value="88"/>
  </language1:Number>
</xmi:XMI> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T19:19:11.150

您不是在测试您要放入的相同内容：

```
a.put(atrib.getName(), atrib.getValue());
...
System.out.println("Testing:::::"+ a.get(0)); 
```

`atrib.getName()`不是数字0吧？如果您将代码更改为：

```
System.out.println("Testing:::::"+ a.get(atrib.getName())); 
```

你会发现它可以毫无问题地恢复价值。你期望`a.get(0)`做什么？您是否希望它返回地图中的第一个元素？地图不是这样工作的 - 该`get()`方法通过*key*获取。

编辑：如果您使用 键设置多个条目`value`，则表明您有多个名称为`value`. 请注意，您有两个循环：

```
for (org.jdom2.Element e : hijos2){
    guardarAtributos(e,i);
} 
```

和：

```
for (org.jdom2.Attribute atrib : atributos) {
    a.put(atrib.getName(), atrib.getValue());
    ...
} 
```

因此，如果您有多个元素都具有一个`value`属性，那么*yes*，较早的值将被后面的值覆盖。

我怀疑你有这样的 XML：

```
<root>
  <child>
    <x value="3" />
    <y value="1" />
    <z value="4" />
  </child>
  <child>
    <x value="88" />
  </child>
</root> 
```

...但是您还没有向我们展示您的 XML，因此我们无法确定。

编辑：现在我们已经看到了您的 XML，尚不清楚您为什么要使用属性名称，或者您为什么需要地图。在我看来你*真的*想要一个`List<List<String>>`：

```
List<List<String> elementValues = new ArrayList<List<String>>();

List<Element> elements = root.getChildren();
for (Element element : elements) {
    List<String> values = new ArrayList<String>();
    for (Element child : element.getChildren()) {
        values.add(child.getAttributeValue("value"));
    }
} 
```

这将比使用地图等简单得多*。*

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-25T19:25:41.423

最终变量无法覆盖

# jquery - 验证 JQuery：未捕获的 TypeError：无法调用未定义的方法“调用”

> ID：15622917
> 
> 赞同：4
> 
> 时间：2013-03-25T19:16:43.120
> 
> 标签：jquery, jquery-validate

我总是出错

```
Uncaught TypeError: Cannot call method 'call' of undefined 
```

当我在表单中输入正确的电子邮件时。自定义按摩也不起作用。函数`?module=auth&amp;action=registration`正常工作（它返回字符串“false”或“true”）。

我使用这个插件：[JQuery Validation Plugin](http://docs.jquery.com/Plugins/Validation)。

我认为问题出在下面的这些文件中。

**custom.validation.js**：

```
$(document).ready(function() {
$("#reg").validate({

       rules: {
               'u1[firstName]': "required",
               'u2[firstName]': "required",
               'u1[lastName]' : "required",
               'u2[lastName]' : "required",
               'u1[email]' : {
                   "required" : true,
                   "email" : true,
                   "remote" : { 

                    url: '?module=auth&action=checkemail',
                    type: "post",
                    data:
                      {
                          'u1[email]': function()
                          {
console.log($("#email1").val());
                              return $("#email1").val();
                          }
                    }                  
               },
               'u2[email]' : "required" 
       },      
       messages: {
               'u1[firstName]': {
                       required: "My requied text"
               }
       }    
    }
});
}); 
```

和**形式**：

```
<fieldset>
    <label for="imie" >Name:</label>
    <input type="text" name="u1[firstName]"{if $smarty.post.u1.firstName} value="{$smarty.post.u1.firstName}"{/if}>
    <label for="nazwisko" >Lastname:</label>
    <input type="text" name="u1[lastName]" {if $smarty.post.u1.lastName} value="{$smarty.post.u1.lastName}"{/if}>
    <label for="adresEmail">E-mail:</label>
    <input type="text" name="u1[email]" id="email1" {if $smarty.post.u1.email} value="{$smarty.post.u1.email}"{/if}>
</fieldset>
<fieldset>
    <button type="submit">Send</button>
</fieldset> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T22:01:07.687

`messages`是一个独立的选项，但你不小心把它*放在里面*，`rules`这会破坏插件。

修复此语法后，它似乎可以正常工作。（顺便说一句，正确缩进和制表符后，代码更容易排除故障。）

**演示：http: [//jsfiddle.net/sERPT/](http://jsfiddle.net/sERPT/)**

```
$(document).ready(function () {

    $("#reg").validate({

        rules: {
            'u1[firstName]': "required",
            'u2[firstName]': "required",
            'u1[lastName]': "required",
            'u2[lastName]': "required",
            'u2[email]': "required",
            'u1[email]': {
                required: true,
                email: true,
                remote: {
                    url: '?module=auth&action=checkemail',
                    type: 'post',
                    data: {
                        'u1[email]': function () {
                            console.log($("#email1").val());
                            return $("#email1").val();
                        }
                    }
                }
            }
        },
        messages: {
            'u1[firstName]': {
                required: "My requied text"
            }
        }
    });

}); 
```

# image - 启动文件下载？WordPress 主题

> ID：15622918
> 
> 赞同：0
> 
> 时间：2013-03-25T19:16:43.983
> 
> 标签：image, wordpress, file, download, themes

我的主题结束了！构建最后的功能 - 文件下载。

我以前做过，但我想确保我实际上是按照 wordpress 的最佳实践和标题的使用来工作的。

购买后，用户可以下载文件。该文件必须动态调整大小并提供给他们。如果它是 zip 或 eps，它同样简单地传输。这部分我可以处理。

**有问题的部分：**

在 wordpress 环境中，**什么是刺激下载的最佳方式**？在链接到外部 php 文件时，除非您包含`wp_load.php`，否则您无法访问 wp 函数，这不是一个好习惯。我需要这些来验证请求。

我想也许我可以使用某种过滤器/操作/挂钩检查来查看在客户页面加载之前是否正在请求文件？有没有办法通过wordpress动态压缩它？这将是一个奖金。在不刷新页面的情况下这样做是最理想的。

我希望这个问题不要过于主观。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:49:15.163

我可能过于复杂了 - 这个线程似乎很好地击中它 -[如何使用 php headers 立即开始文件下载](https://stackoverflow.com/questions/6371547/how-to-start-file-download-instantly-using-php-headers)

# java - AES 错误：给定的最终块未正确填充

> ID：15622924
> 
> 赞同：1
> 
> 时间：2013-03-25T19:16:58.267
> 
> 标签：java, cryptography, aes

我需要有关此错误的帮助：鉴于最终块未正确填充。从标题中可以看出，我正在使用 AES。

这是错误所在行的代码：

```
 byte[] decrypted = cipher.doFinal(bytes); 
```

这是完整的代码：

```
public class AESCrypt {
private final Cipher cipher;
private final SecretKeySpec key;
private String encryptedText, decryptedText;

public AESCrypt(String password) throws Exception {
    // hash password with SHA-256 and crop the output to 128-bit for key
    MessageDigest digest = MessageDigest.getInstance("SHA-256");
    digest.update(password.getBytes("UTF-8"));
    byte[] keyBytes = new byte[16];
    System.arraycopy(digest.digest(), 0, keyBytes, 0, keyBytes.length);

    cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
    key = new SecretKeySpec(keyBytes, "AES");
}

public String encrypt(String plainText) throws Exception {
    byte[] iv = new byte[cipher.getBlockSize()];
    new SecureRandom().nextBytes(iv);
    AlgorithmParameterSpec spec = new IvParameterSpec(iv);
    cipher.init(Cipher.ENCRYPT_MODE, key, spec);
    byte[] encrypted = cipher.doFinal(plainText.getBytes());
    encryptedText = asHex(encrypted);
    return encryptedText;
}

public String decrypt(String cryptedText) throws Exception {
    byte[] iv = new byte[cipher.getBlockSize()];
    AlgorithmParameterSpec spec = new IvParameterSpec(iv);
    cipher.init(Cipher.DECRYPT_MODE, key, spec);
    // decrypt the message
    byte[] bytes = cryptedText.getBytes("UTF-8");
    byte[] decrypted = cipher.doFinal(bytes);
    decryptedText = asHex(decrypted);
    System.out.println("Desifrovani tekst: " + decryptedText + "\n");

    return decryptedText;
}

public static String asHex(byte buf[]) {
    StringBuilder strbuf = new StringBuilder(buf.length * 2);
    int i;
    for (i = 0; i < buf.length; i++) {
        if (((int) buf[i] & 0xff) < 0x10) {
            strbuf.append("0");
        }
        strbuf.append(Long.toString((int) buf[i] & 0xff, 16));
    }
    return strbuf.toString();
}

public static void main(String[] args) throws Exception {

    System.out.print("....AES....\n");

    String message = "MESSAGE";
    String password = "PASSWORD";

    System.out.println("MSG:" + message);

    AESCrypt aes = new AESCrypt(password);
    String encryptedText = aes.encrypt(message).toString();
    System.out.println("SIFROVANA PORUKA: " + encryptedText);
    String decryptedText = aes.decrypt(encryptedText).toString();       
    System.out.print("DESIFROVANA PORUKA: " + decryptedText);
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T13:28:01.093

根据您的评论，您非常接近让加密货币工作。

您需要将 IV 生成代码从您的加密/解密方法移动到其他地方，就像这样

```
public AlgorithmParameterSpec getIV() {
AlgorithmParameterSpec ivspec;
byte[] iv = new byte[cipher.getBlockSize()];
new SecureRandom().nextBytes(iv);
ivspec = new IvParameterSpec(iv);
} 
```

然后将该 ivspec 传递给加密和解密方法（使它们看起来像`encrypt(String,AlgorithmParameterSpec)`），以便加密和解密都具有相同的 iv。

另外，不要调用`printBase64Binary`decryptedByteArray，而是调用`new String(decryptedByteArray, "UTF-8")`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:36:54.613

您有两个问题，首先您将输出编码为十六进制字符串，但不要在 decode 方法中从它解码回来。其次，您生成一个随机 IV，但不再使用它进行解码。

```
public byte[] encrypt(String plainText) throws Exception {
   byte[] iv = new byte[cipher.getBlockSize()];    
   AlgorithmParameterSpec spec = new IvParameterSpec(iv);
   cipher.init(Cipher.ENCRYPT_MODE, key, spec);
   return cipher.doFinal(plainText.getBytes());
}

public String decrypt(byte[] cryptedText) throws Exception {
   byte[] iv = new byte[cipher.getBlockSize()];
   AlgorithmParameterSpec spec = new IvParameterSpec(iv);
   cipher.init(Cipher.DECRYPT_MODE, key, spec);
   // decrypt the message
   byte[] decrypted = cipher.doFinal(cryptedText);
   decryptedText = new String(decrypted, "UTF-8");
   return decryptedText;
}

String decryptedText = aes.decrypt(aes.encrypt(message)).toString(); 
```

# windows - 确定 BizTalk 接收位置的 Windows 身份验证失败的原因

> ID：15622925
> 
> 赞同：0
> 
> 时间：2013-03-25T19:17:00.460
> 
> 标签：windows, permissions, biztalk, biztalk-2010

我有一个 BizTalk 接收位置，指向一个远程 UNC 文件共享，当我打开接收位置时它会立即关闭，并抱怨它对该目录没有读/写权限。过去看到这种情况，难免是因为 BizTalk 服务帐户没有被授予“完全控制”权限，或者是因为 unix 权限问题。

但是，在这种情况下，它是一个 Windows 文件服务器，BizTalk 服务帐户可以完全控制该目录。所以这些似乎都不是问题。另外，在另一台机器上，我创建了一个共享，授予服务帐户权限，包括 UNC 和 NTFS，将 BizTalk 指向它，它就像一个魅力一样工作。

我能说的唯一区别是，他们为 BizTalk 服务帐户所在的组提供了目录结构中更高的权限。但这只是意味着服务帐户在该机器上拥有更大程度的权限，而不是更少。

*   有什么想法可能导致这种情况吗？
*   是否有任何工具或此类工具可以帮助追踪 Windows 身份验证问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:15:23.290

> 有什么想法可能导致这种情况吗？

然而，什么都没有立即浮现在脑海中：

*   为了保持一致性，我会将目录权限更改为组权限或服务帐户权限。
*   您在帖子中提到了 UNC 共享和 NTFS 权限，我会仔细检查您有问题的共享上的内容，以确保它们与组或服务帐户权限一致。
*   我还将检查以确保运行您的文件适配器的 BizTalk 主机正在使用您希望它使用的凭据，并且是预期组的成员。

如果这些检查不起作用，我会考虑将 FILE 适配器设置为使用不同的身份验证凭据-您知道可以使用的东西-覆盖 BizTalk 服务凭据以降低 BizTalk 的问题。

> 是否有任何工具或此类工具可以帮助追踪 Windows 身份验证问题？

关于工具，我不知道有什么可以帮助解决这个特定问题，但是SysInternals 的[Process Explorer](http://technet.microsoft.com/en-gb/bb896653)可能会提供一些关于正在发生的事情的见解。

# javascript - NodeJS：子进程上的事件

> ID：15622927
> 
> 赞同：1
> 
> 时间：2013-03-25T19:17:07.270
> 
> 标签：javascript, node.js, process, scp, spawn

```
var spawn = require("child_process").spawn;
var child = spawn("scp" , ["-P9022", path_to_file, scp_remote_path])
child.stdout.on("data", function(){
    //Automatically type in password
}) 
```

我正在尝试 scp 进入删除服务器并自动输入密码（我知道，我应该改用公钥身份验证，但这不是重点）。当我运行显示的代码时，我得到了正确的密码提示；无论如何我可以通过代码检测到所述提示的存在吗？在这种情况下，似乎没有触发“数据”事件。

编辑：不确定这是否重要，但 process.stdout.isTTY 是真的。当然，然后我尝试像这样监听 process.stdin 的可读事件

```
process.stdin.on "readable", ()->
        buf = process.stdin.read()
        buf2 = process.stdout.read()
        console.log "pin", buf, buf2 
```

回调被调用，但 buf 和 buf2 均为空

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:18:03.040

节点 0.10 中的流已更改，这可能是事件未触发的原因。理论上，添加“数据”事件监听器应该将可读流切换到向后兼容模式。但是，在您开始收听“数据”时，事情可能已经处于某种状态。（这是我的理论，我可能完全错了）

使用节点 0.10 中的新可读流，您不应该监听“数据”事件，而是监听“可读”事件，然后从流中读取数据。请参阅此处了解更多信息[可读事件](http://nodejs.org/api/stream.html#stream_event_readable)

尝试这个：

```
child.stdout.on("readable", function(){
     var buf = child.stdout.read();
     // check that you got your complete prompt for password... 
     // write password to stdin...
}); 
```

# angularjs - 单元测试 AngularJS 指令

> ID：15622928
> 
> 赞同：6
> 
> 时间：2013-03-25T19:17:09.030
> 
> 标签：angularjs, unit-testing, angularjs-directive

如何对我的指令进行单元测试？

我所拥有的是

```
angular.module('MyModule').
    directive('range', function() {
        return {
            restrict: 'E',
            replace: true,
            scope: {
                bindLow: '=',
                bindHigh: '=',
                min: '@',
                max: '@'
            },
        template: '<div><select ng-options="n for n in [min, max] | range" ng-model="bindLow"></select><select ng-options="n for n in [min, max] | range" ng-model="bindHigh"></select></div>'
    };
}) 
```

在我的单元测试中，我想从一个非常简单的测试开始

```
describe('Range control', function () {
    var elm, scope;

    beforeEach(inject(function(_$compile_, _$rootScope) {
        elm = angular.element('<range min="1" max="20" bind-low="low" bind-high="high"></range>');

        var scope = _$rootScope_;
        scope.low = 1;
        scope.high = 20;
        _$compile_(elm)(scope);
        scope.$digest();
    }));

    it('should render two select elements', function() {
        var selects = elm.find('select');

        expect(selects.length).toBe(2);
    });
}); 
```

这不起作用，因为该指令已在应用程序模块上注册，并且我不想包含该模块，因为这将使我的所有代码`config`和`run`代码运行。这将违背将指令作为一个单独的单元进行测试的目的。

我是否应该将所有指令放在一个单独的模块中并仅加载它？或者有没有其他聪明的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T22:14:15.103

编辑：我看到自上次回答以来问题已经改变。

你需要把你的指令放在一个独立的模块中。

例如：

```
angular.module('MyModule.directives'); 
```

要仅测试该模块，您可以像这样在测试中显式加载该模块：

```
beforeEach(module('MyModule.directives')); 
```

这将加载该模块及其所有依赖项。

*请记住在应用程序的 MyModule 定义中将指令模块声明为依赖项：*

```
angular.module('MyModule', ['MyModule.directives', ...]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T08:35:44.833

您应该在“youapp.directives”模块中声明所有指令，并将该模块包含在指令测试中。

在你的 app.js

```
angular.module('myApp', ['myApp.controllers', 'myApp.directives', 'myApp.services', 'myApp.filters']).config(...) 
```

在你的 directives.js

```
angular.module('myApp.directives', []) .directive(.....) 
```

最后你的directionsSpec.js

```
describe('directives specs', function() {
    beforeEach(module('myApp.directives'));

    describe('range', function() {
    ...
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T00:13:13.590

angular-seed 项目 [https://github.com/angular/angular-seed](https://github.com/angular/angular-seed) 似乎认为指令应该放在它们自己的模块中，然后是基本应用程序模块的依赖项。

所以指令进入一个名为“myApp.directives”的模块：

```
angular.module('myApp.directives', []).
  directive('appVersion', ['version', function(version) {
    return function(scope, elm, attrs) {
      elm.text(version);
    };
  }]); 
```

然后基础应用模块添加指令模块作为依赖

```
// Declare app level module which depends on filters, and services
angular.module('myApp', ['myApp.filters', 'myApp.services', 'myApp.directives']).
  config(['$routeProvider', function($routeProvider) {
    $routeProvider.when('/view1', {templateUrl: 'partials/partial1.html', controller: MyCtrl1});
    $routeProvider.when('/view2', {templateUrl: 'partials/partial2.html', controller: MyCtrl2});
    $routeProvider.otherwise({redirectTo: '/view1'});
  }]); 
```

那么他们的测试示例只依赖于指令模块

```
describe('directives', function() {
  beforeEach(module('myApp.directives'));
etc... 
```

我实际上还没有用你或我的代码尝试过这个，但看起来你主要是在寻找最常见的实践指导。

# python - 限制python脚本的线程数

> ID：15622930
> 
> 赞同：3
> 
> 时间：2013-03-25T19:17:20.893
> 
> 标签：python, multithreading, resources, runtime, limit

我在 CentOS linux 服务器上有一个 python 2.7 脚本，它有一个错误启动新线程，直到我无法再登录服务器。

有没有办法告诉python运行时不要创建/启动/使用超过50个线程（并抛出异常或终止脚本）来防止这个问题，或者我必须自己在脚本中实现这个？

线程通过`thread.start_new_thread()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:24:23.697

根据[python`threading`模块](http://docs.python.org/2/library/threading.html#module-threading)（较新的线程模块）上的文档，您可以调用`active_count()`模块上的方法并找出正在运行的线程数。现在，我知道您正在使用较低级别的`thread`模块，所以我通过运行来查看它：

```
import thread
dir(thread) 
```

这产生了列表：

```
['LockType', '__doc__', '__name__', '__package__', '_count', '_local', 'allocate', 'allocate_lock', 'error', 'exit', 'exit_thread', 'get_ident', 'interrupt_main', 'stack_size', 'start_new', 'start_new_thread'] 
```

（我展示这个是因为它对于找出模块包含的内容非常有用，特别是在交互式终端中）

您可以看到该`thread`模块包含一个`_count`字段，在调用该字段时（例如`thread._count()`）应返回正在运行的线程数（您可以检查此值并在超过最大值时引发异常）。

当然，前面的下划线`_count`表示该方法被处理，有点像私有方法。但是，在 Python 中，您仍然可以访问它。

# opengl - 粘贴在较大纹理上时，小纹理的动画会变慢

> ID：15622936
> 
> 赞同：0
> 
> 时间：2013-03-25T19:17:32.917
> 
> 标签：opengl

我想为一个带有纹理的方形框（即 .raw 图像文件）制作动画。我的背景还包括一个更大的盒子，上面还有一个图像。

我正在使用 timer() 函数来为盒子设置动画。问题是当我不断增加背景图像时，我的动画会变慢。我怎样才能提高它的速度..？

raw_texture_load

```
 GLuint raw_texture_load1( const char * filename, int width , int height)
  {
  GLuint texture;
  unsigned char *data;
  FILE * file;

  // open texture data
  file = fopen( filename, "rb" );
  if ( file == NULL ) return 0;

  // allocate buffer

  data= (unsigned char*) malloc(width * height*3);

 // read texture data
 fread( data, width * height*3 , 1, file );
 fclose( file );

 // allocate a texture name
 glGenTextures( 1, &texture );

 // select our current texture
 glBindTexture( GL_TEXTURE_2D, texture );

// select modulate to mix texture with color for shading
glTexEnvf( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE );

// when texture area is small, bilinear filter the closest MIP map
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER,
               GL_LINEAR_MIPMAP_NEAREST );
// when texture area is large, bilinear filter the first MIP map
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );

// if wrap is true, the texture wraps over at the edges (repeat)
//       ... false, the texture ends at the edges (clamp)
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S,
                GL_REPEAT );
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T,
                GL_REPEAT );

// build our texture MIP maps
gluBuild2DMipmaps( GL_TEXTURE_2D, 3, width,
height, GL_RGB, GL_UNSIGNED_BYTE, data );

// free buffer
free( data );

return texture;

} 
```

主要代码

```
 .
 .
 GLuint texture1 ;
 GLuint texture2 ;
 GLuint raw_texture_load1( const char * filename, int width , int height );
 GLuint raw_texture_load2( const char * filename, int width , int height );

 int refreshMills = 10 ;

 .
 .
 .
 void initGL() {
  glClearColor(0.0f, 0.0f, 1.0f, 0.0f);
  texture1 = raw_texture_load1("level.raw", 700, 700);
  texture2 = raw_texture_load2("mario2.raw", 100, 100);
}

 void display()
 {
glClear(GL_COLOR_BUFFER_BIT);   // Clear the color buffer
glMatrixMode(GL_MODELVIEW);     // To operate on Model-View matrix
glLoadIdentity();
glClear(GL_COLOR_BUFFER_BIT);

glEnable(GL_TEXTURE_2D);

glBindTexture(GL_TEXTURE_2D , texture1);
glBegin(GL_QUADS) ;
  glTexCoord2d(0,1);glVertex3f(-1.0, -1.0, 0.0);
  glTexCoord2d(1,1);glVertex3f(1.0, -1.0, 0.0);
  glTexCoord2d(1,0);glVertex3f(1.0, 1.0, 0.0);
  glTexCoord2d(0,0);glVertex3f(-1.0, 1.0, 0.0);
  glEnd() ;
  glDisable(GL_TEXTURE_2D);
  glPopMatrix() ;

     glEnable(GL_TEXTURE_2D);
    glBindTexture(GL_TEXTURE_2D , texture2) ;
    glBegin(GL_QUADS); 
   glTexCoord2d(0,1);glVertex3f(0.2+move, 0.0, 0.0);
  glTexCoord2d(1,1);glVertex3f(0.0+move, 0.0, 0.0);
  glTexCoord2d(1,0);glVertex3f(0.0+move, 0.2, 0.0);
  glTexCoord2d(0,0);glVertex3f(0.2+move, 0.2, 0.0);
  glEnd();  
  glDisable(GL_TEXTURE_2D);
  glPopMatrix() ;
  glutSwapBuffers() ;

  }

  void Timer(int value)
   {
   glutPostRedisplay();      // Post re-paint request to activate display()
   glutTimerFunc(refreshMills, Timer, 0); // next Timer call milliseconds later
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:29:38.220

> 问题是，随着我不断增加背景图像，我的动画变慢了。我怎样才能提高它的速度？

这里的关键字是*fillrate*。背景越大，GPU 必须从 RAM 传输到 RAM 的像素就越多。因为填充率变化很大，所以使用静态计时器不会产生好的结果。正确的方法是测量渲染帧之间的时间并将其用作动画的基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T21:39:09.477

正如 datenwolf 已经指出的那样，您的表现是有限的。

level.raw 必须有多“锐利”？如果（像大多数背景一样）您可以在没有太多细节的情况下通过，则将其从 700x700 缩小到 512x512。如果您可以使用 256x256，也可以尝试一下。

这个较小的二次方大小的图像*应该*可以提供更好的纹理缓存性能，从而提高您的填充率。

# c++ - 我不明白为什么这些数字以它们在 C++ 中的方式出现

> ID：15622937
> 
> 赞同：0
> 
> 时间：2013-03-25T19:17:35.523
> 
> 标签：c++, floating-point, integer, double

我运行了这些代码，但我得到了一个非常奇怪的数字。我是 C++ 新手

ii) 预测以下代码片段的输出：

一个）

```
int x=75, y=105;
printf(" %c %lf " , x,y); 
```

对于第一个我得到的 x 等于 K。我理解，但是对于 y 我得到 0，是因为它被声明为 int 而不是 double 吗？

b)

```
float pH=5.65582; 
printf (" %d %lf" , pH,pH); 
```

现在这个太奇怪了。对于第一个 pH 值，它是 1073741824。我什至不知道他们是如何得到它的。而对于第二个 pH 值是 2。如何？C）

```
float p=0.345689;
double q=0.445566778899;
printf ( "%d %f %lf" , p*q, p*q, p/q);
printf ("%d %0.5f %9.3f", p+q , p-q, p*(p+q)); 
```

p*q -1713662420

p*q -0.000000

p/q -0.000000

p+q -1561213759

pq 0

p*(p+q) 一个很长的数

5918904964504337400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.000

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:20:45.930

您`printf`为传递的参数类型使用了错误的格式说明符。

要打印`float`or`double`值，请使用`"%f"`, `"%g"`, or `"%e"`, 或一些变体。对于`int`参数，使用`"%d"`.

通过使用特定的格式字符串，您承诺传递正确类型的参数。如果你不这样做，你就是在撒谎`printf`，并且由此产生的行为是不确定的。不要那样做。

（可能发生的情况是，例如，`printf`正在获取`int`您实际给出的参数的表示，并*假设*它是一个`double`对象的表示。但不要浪费时间弄清楚为什么你会得到你所做的结果。只需修复编码。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:22:55.643

`double`a and `float`and的实际表示`int`在机器内部是非常不同的。不正确的格式说明符`printf`将尝试将此二进制表示解释为特定类型。

垃圾进垃圾出

# c# - Mongodb：将聚合框架结果转换为 POCO 的优雅方式

> ID：15622954
> 
> 赞同：0
> 
> 时间：2013-03-25T19:18:43.910
> 
> 标签：c#, .net, mongodb, mongodb-.net-driver, aggregation-framework

为了使这个简短易懂，[http](http://mikaelkoskinen.net/mongodb-aggregation-framework-examples-in-c/) ://mikaelkoskinen.net/mongodb-aggregation-framework-examples-in-c/展示了我想要完成的一些事情。此“ToDynamic”调用在从聚合返回的日期时间值上中断。

在了解我们需要一个 DateTime 之后，我能够将其转换为：

```
public static dynamic ToDynamic(this BsonDocument doc)
    {
        var json = doc.ToJson(new JsonWriterSettings { OutputMode = JsonOutputMode.TenGen });
        dynamic obj = JToken.Parse(json);
        return obj;
    } 
```

这能够成功地将这个对象转换为一个 JContainer，我可以使用以下方法解析它：

```
returnApp = BsonSerializer.Deserialize(service.apps.ToString(), typeof(MyMongoObject)); 
```

这一直有效，直到我们想要接收一个 ObjectId 并反序列化它。这组操作在“ToDynamic”调用中中断，因为它无法解析返回的 ObjectId。

有没有人找到一种将聚合框架结果转化为 POCO 的持续成功、优雅的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:43:00.123

您示例中的变量“json”将包含 10gen 特定值，例如 ISODate()、BinData() 和 ObjectId()。我怀疑 JToken.Parse(txt) 期望 txt 是有效的 json，而不是 bson。

在下一行，JToken.Parse() 将采用该 json-like-but-actually-proprietary 字符串并尝试解析它。您最好使用 BsonReader 并使用 JToken.ReadFrom(myBsonReader)

```
using (var reader = new BsonReader(inputStream))
{
    var json = (JObject)JToken.ReadFrom(reader);
} 
```

# c++ - 类型推导的重载赋值运算符

> ID：15622958
> 
> 赞同：1
> 
> 时间：2013-03-25T19:18:54.047
> 
> 标签：c++, c++11, user-defined-literals

这是 ideone 代码：http: [//ideone.com/Qp8Eqg](http://ideone.com/Qp8Eqg)

我的问题是，是否可以仅基于左值强制转换？例如，

```
[Seconds] s = 2_h + 60_s;
cout <<s.getSeconds()<<endl; 
```

显然，我必须编写类似 2_h.toSeconds() 的东西，但这太冗长并且无法实现这个想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:37:11.857

为了允许这样做（这比你写的更可能是你的问题，如果我错了，请纠正我）：

```
Seconds s = 2_h; 
```

以下将起作用：添加`operator Seconds() const`到类`Hours`：

```
class Hours {
    unsigned long long _hours;
public:
    Hours(unsigned long long hours) : _hours(hours) { }

    operator Seconds() const;

    unsigned long long getHours() const {
        return this->_hours;
    }
}; 
```

*并在*课后定义它`Seconds`：

```
Hours::operator Seconds() const { return this->_hours * 3600; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:53:24.420

正如给出的答案中已经指出的那样，您需要`operator Seconds ()`实施以允许从`Hours`到的自动转换`Seconds`。有了这个运算符，您还可以简化`operator+`. 为了提高运行时间，您还可以`constexpr`在编译时添加一些值来评估值。

```
#include <iostream>

class Seconds {
    public:
        constexpr Seconds(const Seconds& other) : seconds_(other.seconds_) {}
        constexpr Seconds(unsigned long long seconds) : seconds_(seconds) {}

        Seconds& operator=(const Seconds& other) {
            seconds_  = other.seconds_;
            return *this;
        }

        constexpr unsigned long long value() const {
            return this->seconds_;
        }

    private:
        unsigned long long seconds_;
};

class Hours {
    public:
        constexpr Hours(const Hours& other) : hours_(other.hours_) {}
        constexpr Hours(unsigned long long hours) : hours_(hours) {}

        Hours& operator=(const Hours& other) {
            hours_ = other.hours_;
            return *this;
        }

        unsigned long long value() const {
            return this->hours_;
        }

        operator Seconds () const { return Seconds(hours_*60*60); }
    private:
        unsigned long long hours_;
};

constexpr Seconds operator+(const Seconds& lhs, const Seconds& rhs) 
{
    return Seconds(lhs.value()+rhs.value());
}

constexpr Hours operator "" _h(unsigned long long hours) {
    return Hours(hours);
}

constexpr Seconds operator "" _s(unsigned long long seconds) {
    return Seconds(seconds);
}

int main() {
    using namespace std;

    Seconds s = 1_h + 10_s;
    cout <<s.value()<<endl;
    s = 2_h + 60_s;
    cout <<s.value()<<endl;
    return 0;
} 
```

# ios - 如何使用 KIF 框架从 UIDatePicker 自动选择日期

> ID：15622959
> 
> 赞同：2
> 
> 时间：2013-03-25T19:18:54.860
> 
> 标签：ios, uidatepicker, ios-ui-automation, kif

我正在使用 KIF 框架自动化我的应用程序。对于其中一种情况，我需要从 UIDatePicker 自动选择日期。

有没有人这样做过？并就如何继续或共享一些代码提出一些想法。

任何帮助是极大的赞赏。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T19:38:17.667

在日期选择器上使用`setAccessibilityLabel`，然后`setDate`在`KIFTestStep`类别中定义一个方法，如下所示：

```
+ (id)stepToEnterDate:(NSDate*)date ToDatePickerWithAccessibilityLabel:(NSString*)label
{
    NSString *description=[NSString stringWithFormat:@"Enter date to Date picker with accessibility label '%@'",[date description]];
    return [self stepWithDescription:description executionBlock:^(KIFTestStep *step, NSError **error)
            {
                UIAccessibilityElement *element = [[UIApplication sharedApplication] accessibilityElementWithLabel:label];
                KIFTestCondition(element, error, @"View with label %@ not found", label);
                if(!element)
                {
                    return KIFTestStepResultWait;
                }
                UIDatePicker *picker = (UIDatePicker*)[UIAccessibilityElement viewContainingAccessibilityElement:element];

                KIFTestCondition([picker isKindOfClass:[UIDatePicker class]], error, @"Specified view is not a picker");

                [picker setDate:date animated:YES];
                return KIFTestStepResultSuccess;         
            }];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-07T18:06:14.783

一个更最新的答案。

使用 KIF 中的此方法：

`- (void) selectDatePickerValue:(NSArray*)datePickerColumnValues;`

在 KIF 3.1.0 上可用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-29T01:11:37.723

这是一个更新的（也是非常基本的）方法，您可以将其放在一个类别中`KIFUITestActor`

```
- (void)enterDate:(NSDate *)date intoDatePickerWithAccessibilityLabel:(NSString *)label {
  [tester runBlock:^KIFTestStepResult(NSError **error) {
    UIAccessibilityElement *element;
    [self waitForAccessibilityElement:&element view:nil withLabel:label value:nil traits:UIAccessibilityTraitNone tappable:NO];
    KIFTestCondition(element, error, @"Date picker with label %@ not found", label);
    KIFTestCondition([element isKindOfClass:[UIDatePicker class]], error, @"Specified view is not a picker");
    UIDatePicker *picker = (UIDatePicker *)element;
    [picker setDate:date animated:NO];
    [self waitForTimeInterval:1.f];
    return KIFTestStepResultSuccess;
  }];
} 
```

然后你可以像这样使用它：

```
[tester enterDate:[NSDate distantPast] intoDatePickerWithAccessibilityLabel:kLocaleDatePicker]; 
```

# wordpress - Github，跟踪主要的 WordPress 主题和变体

> ID：15622961
> 
> 赞同：2
> 
> 时间：2013-03-25T19:19:00.347
> 
> 标签：wordpress, git, github, themes

我是 Git / Git hub 的新手，但想确保我从一开始就做对了。

我想做的是开发一个裸框架主题，然后基于此开发单独的主题（样式不同）。

我希望能够继续在裸框架上工作，并根据需要将更改推送到样式主题。

我假设我设置了我的裸框架，然后克隆它以创建一个新框架？我之后所做的进一步更改是否可以从新主题中访问？或者我应该以其他方式做吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:26:05.760

在我看来，您想要的是一个主分支，其中包含裸框架和每个样式主题的单独分支。

首先在 master 上创建裸框架，然后在创建主题分支时从 master 分支。

当您更新 master 上的裸框架时，您可以轻松地将这些更改合并到每个主题分支。

# python - 如何重新索引通过折叠 DataFrame 创建的系列？

> ID：15622962
> 
> 赞同：0
> 
> 时间：2013-03-25T19:19:05.337
> 
> 标签：python, pandas

考虑下面的代码：

```
sfix = sub['fix']  # a pandas.Panel
(sfix.minor_xs('tstop') - sfix.minor_xs('tstart'))  # slicey slicey! 
```

输出：

```
<class 'pandas.core.frame.DataFrame'>
Int64Index: 804 entries, 0 to 803
Data columns (total 8 columns):
0    573  non-null values
1    675  non-null values
2    804  non-null values
3    715  non-null values
4    578  non-null values
5    568  non-null values
6    664  non-null values
7    599  non-null values
dtypes: float64(8) 
```

此输出对应于Panel 对象中包含的 8 个 DataFrame 中的每一个的`tstop`和列之间的差异。`tstart`

这些列都包含相同类型的数据，我想将它们堆叠成一个系列，ergo：

```
s = pd.concat([df[i] for i in df]) 
```

这是一个好的开始，但现在我的所有索引都重复了 8 次：

```
>>> s.ix[0]

0     98
0    184
0    178
0    188
0    176
0    234
0    128
0     82
dtype: float64 
```

从这里开始，我不太清楚如何重新索引我的系列，以使索引从 0 变为`len(s)`. 我尝试了以下方法，但无济于事：

```
s.reindex(copy=True)
s.reindex(index=xrange(len(s)), copy=True) 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:39:45.273

IIUC，您可以使用`reset_index(drop=True)`：

```
>>> s
0     98
0    184
0    178
0    188
0    176
0    234
0    128
0     82
Dtype: float64
>>> s.reset_index(drop=True)
0     98
1    184
2    178
3    188
4    176
5    234
6    128
7     82
Dtype: float64 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T19:40:53.603

这也应该工作

```
s = pd.concat([df[i] for i in df], ignore_index = True) 
```

# python - 使用 islice 逐块读取文本文件

> ID：15622965
> 
> 赞同：0
> 
> 时间：2013-03-25T19:19:20.453
> 
> 标签：python, coding-style, slice

我有一个包含数百万个点的文本文件（*x*、*y*、*z*等）。我正在尝试用***islice***读取前一百万行以初始化字典

```
from collections import defaultdict
from itertools import islice

def point_grid_id(x, y, minx, maxy, size):
    """give id (row,col)"""
    col = int((x - minx) / size)
    row = int((maxy - y) / size)
    return row, col

def initialize_dict(filename, minx, maxy, size, chunk=1000000):
    point_dict = defaultdict(list)
    with open(filename, 'r') as datafile:
        for line in islice(datafile, chunk):
            point = line.rstrip().split(parse)
            point_dict[point_grid_id(float(point[0]), float(point[1]), minx, maxy, size)].append(point)
    return point_dict 
```

其中**minx**，**maxy**是网格的原点（左上角）和网格的**大小**。,`float(point[0])`是点 i`float(point[1])`的*x*和*y*

**ID**是 point-i 放置的位置。

```
point_dict = initialize_dict(filename, minx, maxy, 2) 
```

使用这本字典，我试图读取其余的点（约 800 万）并将**ID**已经作为**Keys**存在的点存储在字典中。换句话说，ID 不存在于字典中的点将存储在新的文本文件中，否则将它们存储在字典中。

我正在尝试如何找出每 100 万个点切片的样式，直到文件结束（未知）

```
size = 2
with open(filename, 'r') as datafile:
    for line in islice(datafile, 1000000, 2000000):
        point = line.rstrip().split(parse)
        if point_grid_id(float(point[0]), float(point[1]), minx, maxy, size) in point_dict:
            point_dict[point_grid_id(float(point[0]), float(point[1]), minx, maxy, size)].append(point)
        else:
            pass 
```

使用这种形式，我总是得到拳头 10 分

```
with open(filename, 'r') as datafile:
    for line in islice(datafile, 10):
        point = line.rstrip().split(";")
        print point 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:27:42.957

你可以继续取`islice(datafile, 1000000)`每个islice，从前一个停止的地方继续。问题是检测文件的结尾，你只会得到空的islices。

更好的模式是使用`groupby`

```
from itertools import groupby, count
with open(filename, 'r') as datafile:
    groups = groupby(datafile, key=lambda k, line=count(): next(line)//1000000)
    for k, group in groups:
        for line in group:
            ... 
```

分组的键是行号 //1000000 所以每组 1000000 行有相同的键

# ruby-on-rails - 没有路线匹配 [POST] "/account/edit"

> ID：15622966
> 
> 赞同：0
> 
> 时间：2013-03-25T19:19:35.143
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我在我的视图页面上工作正常：

```
<%

   me = Users.find(session[:id])

%>
<h1>Edit account</h1>
<form action="" method="post">
 Username: <input type="text" name="username" value="<%=me[:username]%>" /> <br />
 E-mail: <input type="text" name="email" value="<%=me[:email]%>" /><br />
 <input type="submit" value="Update" />
</form> 
```

但是当我提交表单时，我得到 No route matches [POST] "/account/edit"

我的控制器：

```
class AccountController < ApplicationController
    def edit  
        if  params[:username] 
        @out = "Hey"
    end
 end
end 
```

在路线中我尝试设置这个

```
 post "account/edit" 
```

它也确实有效，但是当它刷新时会话不起作用，所以得到这个：

```
 Couldn't find Users without an ID 
```

有人能帮我吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:34:33.160

编辑旧回复：

我认为尝试调试您在这里所拥有的东西是无济于事的。关键是您的代码存在很多问题，目前尚不清楚您还有哪些与之交互的地方。如果您没有设置其他路由并且控制器中没有其他操作，那么 POST 与什么交互？创建（或类似）操作在哪里查找用户以获取为其创建帐户的用户 ID？

我认为您需要以运行脚手架为起点

```
rails g scaffold account attr1:type attr2:type etc. 
```

这将为您提供一些可靠的东西，您可以查看、定制和学习。我鼓励你继续努力——很明显你想要学习。祝你好运！:-)

# couchbase - 沙发底座中的多个可选键

> ID：15622968
> 
> 赞同：2
> 
> 时间：2013-03-25T19:19:43.927
> 
> 标签：couchbase

我的地图功能

```
function(doc, meta) {
  emit([doc.city, doc.region], doc.id);
} 
```

我的查询

```
?keys=[["New York", "Northeast"]] 
```

这将发出：

```
{ 
  city: 'New York',
  region: Northeast
} 
```

如果我想使用相同的地图功能仅从东北部获取那些城市，它将无法正常工作。有什么办法只匹配其中一个键吗？喜欢...

```
?keys=[[null, "Northeast"]] 
```

并输出

```
[{ 
  city: 'New York',
  region: 'Northeast'
},
{
  city: 'Boston',
  region: 'Northeast'
}] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T20:10:15.917

当您在 Couchbase 中使用查询/视图时，您只能从左到右读取密钥。

因此，如果您希望能够查询每个“部分”，您需要创建一个发射的新视图（如果您想在同一视图中进行 2 个发射或创建 2 个视图，您可以这样做）

```
emit(doc.region, doc.city); 
```

并查询它例如使用

```
?startkey=["Northeast"]&endkey["Northeast",{}] 
```

此外，如您所见，我不发出 doc.id，这不是必需的，因为 doc.id 始终由 Couchbase 视图发出。

# iphone - UIActivityViewController 系统活动的自定义

> ID：15622970
> 
> 赞同：2
> 
> 时间：2013-03-25T19:19:53.693
> 
> 标签：iphone, ios, cocoa, ios6, uiactivityviewcontroller

我想`UIActivityViewController`通过 Facebook、Twitter 和 Mail 来分享不同的内容。但除了分享之外，我还需要做一些事情，例如日志记录。

1.  是否有可能向系统添加自定义功能`UIActivities`？

2.  如果不是，这是继承 UIActivity 以通过 Facebook、Twitter、Mail 提供共享的正确方法吗？

3.  或者可能`UIActivityViewController`太简化了，我必须使用自定义视图控制器来实现自定义目的？

# c# - 如何将字符串设置为可为空的实体框架

> ID：15622971
> 
> 赞同：1
> 
> 时间：2013-03-25T19:19:55.863
> 
> 标签：c#, entity-framework

我得到了这个例外：

> 自创建数据库以来，支持“数据库”上下文的模型已更改。考虑使用 Code First 迁移来更新数据库 ( [http://go.microsoft.com/fwlink/?LinkId=238269](http://go.microsoft.com/fwlink/?LinkId=238269) )。

正如我被告知的那样，当您更改代表数据库表的模型并且您的数据库具有不同的属性（表和字段）时，就会出现错误（如果我错了，请纠正我）。

`Tbl_Users`，在数据库中，具有以下结构

```
dbUser(int,not null)//key
dbUserId(varchar(50),null)//allow null, right?
dbPassWord(varchar(20),null) 
```

这是模型：

```
public class Tbl_Users {
    [Key,DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int dbUser { get; set; }
    [MaxLength(50)]
    public string dbPassWord { get; set; }
    [MaxLength(20)]
    public string dbUserID{ get; set; }
    public int? dbLock { get; set; }
} 
```

如何设置`public string dbPassWord { get; set; }`和`public string dbPassWord { get; set; }`允许空值？或者这个错误还有其他解决方案吗？

**更新**

如果我添加迁移，并`Update-Database`按照[此处](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)所述更新数据库，受影响表的值会被删除吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:29:18.997

由于 Jon Skeet 的注释字符串是可以为空的类型。

```
public string MyProperty{get;set;}

MyProperty = null; //this is fine 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:33:55.750

尽我所能，抱怨您的后备存储（数据库）中没有 dbLock 列。您需要启用 Code First 迁移，然后更新数据库。或者，如果您还没有数据，只需推送更新，但您几乎肯定最终会想要迁移。

几乎是错误消息所说的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:31:57.660

是不是您的 MaxLength 属性已被切换？它们与数据库不匹配：

```
public class Tbl_Users {

        [Key,DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int dbUser { get; set; }
        [MaxLength(20)]
        public string dbPassWord { get; set; }
        [MaxLength(50)]
        public string dbUserID{ get; set; }
        public int? dbLock { get; set; }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T21:26:25.927

> 如果我添加迁移，并按照此处所述使用 Update-Database 命令更新数据库。受影响表的值会被删除吗？

`Changing column to 'nullable'`（如果它不是索引）或`adding new columns`（您的 dbLock） - `should not delete data`。大多数情况下，EF/CF 迁移值得信赖，只需对现有 Db 结构进行最小的更改 - 当然取决于您所做的更改（我会小心重命名等）。

无论如何，执行`Add-Migration`- 并查找创建的迁移文件（.cs - 自动为您打开） - 它会告诉您`up`和`down`部分中的内容。您可以在此处重新检查 EF 为您做了什么。

正如建议的那样，首先备份 - 你很安全。

除此之外 - 即使 Code First（通过迁移）是为了适应对对象的更改 - 它主要用于原型设计和开发 - 并在任何生产环境中尽量减少此类更改，因为事情会变得更加成问题。

# tsql - SQL Azure：并发删除操作死锁

> ID：15622972
> 
> 赞同：2
> 
> 时间：2013-03-25T19:19:57.393
> 
> 标签：tsql, azure, azure-sql-database

我在我的 SQL azure 数据库上遇到了一些由并发删除操作引起的死锁，我不确定如何解决它。我已将情况简化到最基本的级别。我有下表：

```
CREATE TABLE [dbo].[Test2013](
    [ClientID] [int] NOT NULL,
    [ID] [uniqueidentifier] NOT NULL,
    [Value] [int] NOT NULL,
 CONSTRAINT [dbo-Test2013] PRIMARY KEY CLUSTERED 
(
    [ClientID] ASC,
    [ID] ASC
)
 WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF,
       IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON,
       ALLOW_PAGE_LOCKS  = ON)
)

GO

ALTER TABLE [dbo].[Test2013] ADD CONSTRAINT [Test2013-ID-Default-Value]
     DEFAULT (newid()) FOR [ID]
GO 
```

导致该问题的查询如下：

```
INSERT INTO [Test2013]
    ([ClientID],[ID],[Value])
    SELECT
        CAST(-2147483648 AS INT) [ClientID], 
        '82ecb924-d2f0-44ee-9a8e-5240d12de088' [ID], 
        CAST(1 AS INT) [Value]

INSERT INTO [Test2013]
    ([ClientID],[ID],[Value])
    SELECT
        CAST(-2147483648 AS INT) [ClientID], 
        '82ecb924-d2f0-44ee-9a8e-5240d12de077' [ID], 
        CAST(2 AS INT) [Value]

 DECLARE @MyDateTime DATETIME
SET @MyDateTime = DATEADD(s,5,GETDATE())

DECLARE @MyDateTime2 DATETIME
SET @MyDateTime2 = DATEADD(ms,1,@MyDateTime)

BEGIN tran
    WAITFOR TIME @MyDateTime;
    DELETE FROM [Test2013]
    WHERE [ID] = '82ecb924-d2f0-44ee-9a8e-5240d12de088';
Commit tran

BEGIN tran
    WAITFOR TIME @MyDateTime2;
    DELETE FROM [Test2013]
    WHERE [ID] = '82ecb924-d2f0-44ee-9a8e-5240d12de077';
Commit tran 
```

我认为这将是相对微不足道的，但我无法找出实际锁定查询的内容。我检查了 sys.events_log 表，它不包含任何新的死锁事件。我以前见过其他死锁，但它们都抛出了我可以处理的异常，这个只是无限期挂起。

附带说明一下，如果我将第二次操作延迟 50 毫秒，它可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T20:17:09.047

这里的挂起并不是因为死锁，而是因为你在等待一个已经过去的时间。以下是您查询的修改版本，它会在当前时间以及我运行的消息中发送垃圾邮件。如您所见，当您等待@MyDateTime2 时，它已经过去了。50 毫秒有效的原因是因为完成所有这些工作不需要 50 毫秒。我将 WAITFOR TIME 更改为 WAITFOR DELAY，它可以工作。不过，它并没有真正等待一毫秒。

```
INSERT INTO [Test2013]
    ([ClientID],[ID],[Value])
    SELECT
        CAST(-2147483648 AS INT) [ClientID], 
        '82ecb924-d2f0-44ee-9a8e-5240d12de088' [ID], 
        CAST(1 AS INT) [Value]

INSERT INTO [Test2013]
    ([ClientID],[ID],[Value])
    SELECT
        CAST(-2147483648 AS INT) [ClientID], 
        '82ecb924-d2f0-44ee-9a8e-5240d12de077' [ID], 
        CAST(2 AS INT) [Value]

 DECLARE @MyDateTime DATETIME
SET @MyDateTime = DATEADD(s,5,GETDATE())

PRINT(CONVERT(varchar, @MyDateTime, 121))
DECLARE @MyDateTime2 DATETIME
SET @MyDateTime2 = DATEADD(ms,1,@MyDateTime)

PRINT(CONVERT(varchar, @MyDateTime2, 121))
BEGIN tran
PRINT(CONVERT(varchar, getdate(), 121))
    WAITFOR TIME @MyDateTime;
PRINT(CONVERT(varchar, getdate(), 121))
    DELETE FROM [Test2013] 
    WHERE [ID] = '82ecb924-d2f0-44ee-9a8e-5240d12de088';
PRINT(CONVERT(varchar, getdate(), 121))
Commit tran

BEGIN tran
PRINT(CONVERT(varchar, getdate(), 121))
    WAITFOR TIME @MyDateTime2;
PRINT(CONVERT(varchar, getdate(), 121))
    DELETE FROM [Test2013]
    WHERE [ID] = '82ecb924-d2f0-44ee-9a8e-5240d12de077';
PRINT(CONVERT(varchar, getdate(), 121))
Commit tran 
```

当我取消查询时产生的消息：

```
(1 row(s) affected)

(1 row(s) affected)
2013-06-21 15:13:09.980
2013-06-21 15:13:09.980
2013-06-21 15:13:04.980
2013-06-21 15:13:09.997

(1 row(s) affected)
2013-06-21 15:13:09.997
2013-06-21 15:13:10.017
Query was cancelled by user. 
```

使用 WAITFOR DELAY 代替： INSERT INTO [Test2013] ([ClientID],[ID],[Value]) SELECT CAST(-2147483648 AS INT) [ClientID], '82ecb924-d2f0-44ee-9a8e-5240d12de088' [ID], CAST(1 AS INT) [值]

```
INSERT INTO [Test2013]
    ([ClientID],[ID],[Value])
    SELECT
        CAST(-2147483648 AS INT) [ClientID], 
        '82ecb924-d2f0-44ee-9a8e-5240d12de077' [ID], 
        CAST(2 AS INT) [Value]

BEGIN tran
PRINT(CONVERT(varchar, getdate(), 121))
    WAITFOR delay '00:00:05'
PRINT(CONVERT(varchar, getdate(), 121))
    DELETE FROM [Test2013] 
    WHERE [ID] = '82ecb924-d2f0-44ee-9a8e-5240d12de088';
PRINT(CONVERT(varchar, getdate(), 121))
Commit tran

BEGIN tran
PRINT(CONVERT(varchar, getdate(), 121))
    WAITFOR delay '00:00:00.001'
PRINT(CONVERT(varchar, getdate(), 121))
    DELETE FROM [Test2013]
    WHERE [ID] = '82ecb924-d2f0-44ee-9a8e-5240d12de077';
PRINT(CONVERT(varchar, getdate(), 121))
Commit tran 
```

# javascript - 如何防止此类实例化？

> ID：15622973
> 
> 赞同：0
> 
> 时间：2013-03-25T19:19:58.650
> 
> 标签：javascript

我正在使用[jQuery 插件](https://gist.github.com/gotoAndBliss/5239816)来创建类。但是我不希望我的类被初始化，除非我想要它们。如何防止以下代码初始化，但如果需要可以访问？

```
window.classes.my_custom_class = new(Class.extend({
 init: function() {
    // stuff()
  }
})); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:40:59.307

要创建单例，您根本不使用类。只需遵循默认[模块模式即可](http://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript)。在你的情况下：

```
window.classes.my_custom_module = {
    init: function() {
        // stuff()
    }
}; 
```

还是您想要一个实际的[“类”](https://stackoverflow.com/a/13418980/1048572)，即构造函数？然后避免那里的`new`关键字！

```
window.classes.my_custom_class = Class.extend({
    init: function() {
        // stuff()
    }
});

// later:
var instance = new classes.my_custom_class(); 
```

# mysql - Grails 数据库迁移 MySQL 问题 - 未生成更改日志

> ID：15622974
> 
> 赞同：0
> 
> 时间：2013-03-25T19:20:00.683
> 
> 标签：mysql, grails, database-migration

我尝试在 grails 2.2.1 上运行数据库迁移，但它似乎无法正常工作。

运行*dbm-generate-changelog*会生成初始 changelog.groovy，但在模型更改后尝试运行*dbm-gorm-diff*会导致没有文件生成。

从 Liquibase 记录回来的最后一行是：

```
Sequences not supported for ..... 
```

我的数据源设置正确，mysql 方言设置为*org.hibernate.dialect.MySQL5InnoDBDialect*

我试图找到一个配置选项来直接向 liquibase 指定 mysql 是目标，但它接缝它从数据源中读取它。

有任何想法吗？

[已解决] - 更新存在与此[http://jira.grails.org/browse/GPDATABASEMIGRATION-120相关的问题](http://jira.grails.org/browse/GPDATABASEMIGRATION-120)

作为一种解决方法，您可以克隆[https://github.com/ph4t/grails-database-migration](https://github.com/ph4t/grails-database-migration)，然后使用 > 从您的 grails 应用程序 (BuildConfig.groovy) 指向克隆的项目>

```
grails.plugin.location.'database-migration' = "<path to cloned folder>" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T08:28:45.583

有一个与此[http://jira.grails.org/browse/GPDATABASEMIGRATION-120相关的问题](http://jira.grails.org/browse/GPDATABASEMIGRATION-120)

作为一种解决方法，您可以克隆[https://github.com/ph4t/grails-database-migration](https://github.com/ph4t/grails-database-migration)，然后使用 > 从您的 grails 应用程序 (BuildConfig.groovy) 指向克隆的项目>

```
grails.plugin.location.'database-migration' = "<path to cloned folder>" 
```

# c - 比较常量时在哪里可以使用 & 和 ==？有什么区别？

> ID：15622977
> 
> 赞同：1
> 
> 时间：2013-03-25T19:20:20.287
> 
> 标签：c, windows, winapi

我想知道之间有什么区别：

`file.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY`

和 ：

`file.dwFileAttributes == FILE_ATTRIBUTE_DIRECTORY`

当我使用第一个时，我会得到更多文件。

`FILE_ATTRIBUTE_DIRECTORY`是文件属性常量，`file.dwFileAttributes`是`WIN32_FIND_DATA`Windows API 中的结构成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:34:37.817

规则很简单：

*   当变量可以只包含一个值时，您可以使用等式运算符 进行测试`==`。
*   当变量可以保存零个、一个或多个标志时，您可以使用按位和运算符测试标志的存在`&`。

在 的情况下`dwFileAttributes`，文档说：

> 文件的文件属性。有关可能的值及其描述，请参阅...

复数的使用表明我的第二个要点适用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:28:21.777

`&`是按位*与*运算，while`==`是实际比较。

**按位与**

```
#define FLAG_1 1
#define FLAG_2 2
#define FLAG_3 4
#define FLAG_4 8

/* Check if FLAG_2 or FLAG_3 is enabled in flags */
if ((flags & FLAG_2) || (flags & FLAG_3)) {
    ...
} 
```

有大量关于按位与和其他基本位运算的资源。[维基链接](http://en.wikipedia.org/wiki/Bitwise_operation#AND)。

**定期比较**

```
#define FLAG_1 1
#define FLAG_2 2
#define FLAG_3 4
#define FLAG_4 8

/* Check if flags is *equal* to FLAG_2 value */
if (flags == FLAG_2) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:23:46.317

`file.dwFileAttributes`是用作标志的整数类型。每个位代表一个标志（0 或 1 表示设置或未设置）

`FILE_ATTRIBUTE_DIRECTORY`是具有单个位集的整数。（该位表示文件是否为目录）

`file.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY``FILE_ATTRIBUTE_DIRECTORY`如果设置了标志，则返回非零。

`file.dwFileAttributes == FILE_ATTRIBUTE_DIRECTORY`如果设置的唯一标志是 ，则返回 true `FILE_ATTRIBUTE_DIRECTORY`。

# javascript - 为什么这段js会抛出DOM Exception？

> ID：15622985
> 
> 赞同：2
> 
> 时间：2013-03-25T19:20:46.053
> 
> 标签：javascript, xmlhttprequest

我不明白为什么这个[**小提琴**](http://jsfiddle.net/bevacqua/kDtQb/)会抛出

> 未捕获的错误：InvalidStateError：DOM 异常 11

```
function url(){
 return '/echo/js/?js=' + 5 + Math.floor(Math.random()*900);
}

function poll(done){
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function(){
        if(xhr.status === 200 && xhr.readyState === 4){
            var foo = xhr.responseText;
            done(parseInt(foo));
        }
    };
    xhr.open('get',url(),false);
    xhr.send(null);
}

var button = document.querySelector('#poller');
var price = document.querySelector('#price');

button.addEventListener('click', function(){
    poll(function(data){
        price.innerText = data;
    });
},false); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T19:25:55.977

问题是readyState为0/1时状态不可用

您需要颠倒您的 if 中的顺序。

```
if(xhr.readyState === 4 && xhr.status === 200){ 
```

规范说它应该返回零[“如果状态是 UNSENT 或 OPENED，返回 0 并终止这些步骤。”](http://www.w3.org/TR/XMLHttpRequest/#the-status-attribute) ，但由于某种原因，某些浏览器会执行此操作“如果状态未打开或设置了 send() 标志，则会引发“InvalidStateError”异常。” 这就是[setRequestHeader](http://www.w3.org/TR/XMLHttpRequest/#the-setrequestheader%28%29-method)所做的。此外，您的代码很奇怪，您会将它与同步请求一起使用。

所以这里的问题是浏览器没有像规范所说的那样返回零。更改 if 语句中的顺序会阻止浏览器到达该点，因为第一次检查失败。

还有[WebKit 上的 bug](https://bugs.webkit.org/show_bug.cgi?id=45994)

# c - 为什么 Valgrind 不工作？

> ID：15622987
> 
> 赞同：0
> 
> 时间：2013-03-25T19:21:03.507
> 
> 标签：c, ubuntu, valgrind

我是 C 和 Ubuntu 的新手，决定安装 Valgrind 并在这个简单的 C 代码上对其进行测试：

```
#include <stdio.h>

int *p;

int main(void) {
    p = calloc(100, sizeof(int));
    return 0;
} 
```

我已将此代码放在 sum.c 文件中并对其进行编译。然后我输入了：

```
valgrind --tool=memcheck --leak-check=yes sum 
```

在终端窗口中，这就是我得到的：

![在此处输入图像描述](../Images/d94d9798ce654a37e18298f391d8ac4f.png)

我不知道它是继续循环还是卡住，但它会一直保持这种状态，直到我单击 ctrl+d 停止它，这就是我得到的：

![在此处输入图像描述](../Images/f41e03f49ea56cd3aea630caefd88302.png)

难道我做错了什么 ？为什么我看不到我有内存泄漏？

顺便说一下，这是 Ubuntu 版本 11.04。

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T19:25:48.997

注意

```
00000     0 
```

您正在运行**`/usr/bin/sum`而不是您自己的可执行文件**，因为您没有说`./sum`. 这就是为什么你必须打`C-d`:`sum(1)`等到 EOF。

* * *

附带说明一下，您很可能不会报告泄漏，而是“仍然可以访问内存”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T19:22:54.427

您可能需要使用以下符号

```
valgrind --tool=memcheck --leak-check=yes ./sum 
```

也就是说，如果“sum”是您的可执行文件的名称。注意添加`'./'`

# php - HTML文件拉PHP文件->打印两页而不是一页

> ID：15622988
> 
> 赞同：-2
> 
> 时间：2013-03-25T19:21:03.450
> 
> 标签：php, analytics, google-ads-api

[http://www.freshmarketonline.com/coupon/coupon.php](http://www.freshmarketonline.com/coupon/coupon.php)

我的餐厅在其网站上有一张上面链接的优惠券。优惠券总是在“明天”到期，这样我们就可以让顾客每天回到网站，这样他们就可以看到我们在菜单上提供的服务。我让某人编写了一个 PHP 脚本来自动生成具有第二天到期日期的优惠券。

我想为 google analytics 和 google adwords 放置一个转换跟踪（以便我可以跟踪 AdWords 的有效性），但是使用动态 PHP 脚本这样做很麻烦。有一个多步骤的过程，包括更改代码和一些转换值。它比我预期的要复杂，所以我从一个 HTML 文件中提取了 PHP 文件，链接如下：

[http://www.freshmarketonline.com/coupon/coupon_new.html](http://www.freshmarketonline.com/coupon/coupon_new.html)

所以，这个 HTML 文件会拉取 PHP 文件。我还能够毫无问题地将转换代码复制并粘贴到这个 HTML 文件中。标签工作完美，除了一件事：

当客户打印优惠券时，它会自动打印两页，一张优惠券和一张空白页。有没有办法让这张优惠券只打印一页？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:25:15.117

我相信原因是因为您调用的 iframe 设置为 100% 的高度。使用正文标签填充，将其设置为两页。为什么不拉入图像：

```
<img src="http://www.freshmarketonline.com/coupon/coupon.php" > 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:26:05.397

设置的高度和宽度`iframe`。给高度一个`800px`左右的大小，以及宽度`600px`或附近的东西。

上述或**选项2：**

将正文设置为没有填充或边距：

```
body{
margin: 0;
padding: 0;
} 
```

无论如何，您只需要确保页面上没有溢出。具有边距和内边距的主体，加上`iframe`高度和宽度为的主体`100%`，导致了这种溢出。

# security - 保护 Amazon Web Services (AWS) S3 免受 DDoS 攻击

> ID：15622990
> 
> 赞同：11
> 
> 时间：2013-03-25T19:21:06.587
> 
> 标签：security, amazon-web-services, amazon-s3

我已经托管了我的博客 Amazon Web Services S3（带有托管的静态文件）。我应该添加任何策略或措施来进一步保护我的帐户免受 DDoS/高带宽消耗吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-26T05:04:59.673

我认为这是一场音乐会。不是在技术方面，但肯定是在财务方面。如果由于某种原因您的内容从 S3 下载过多，则您需要为此付费。

如果您希望所有人都可以访问内容，那么没有 S3 策略可以帮助您。

如果您想跟踪您的支出，我建议使用[AWS Billing Alerts](http://aws.amazon.com/about-aws/whats-new/2012/05/10/announcing-aws-billing-alerts/)。当您当月的总账单达到 X 美元时，您可以使用 CloudWatch 警报向 SNS（以及您的电子邮件）发送消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T03:36:11.700

没有。

由于 S3 只是平面文件，并且已经每天处理 [大量] 请求，因此您（个人）不需要担心针对它的 DDoS 攻击。如果（偶然）DDoS 成功，[将受到影响的不仅仅是您](http://status.aws.amazon.com)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-10T15:34:00.393

保护您的站点免受 DDoS 攻击的最简单方法是设置 CloudFlare 的免费服务层。它将免费缓存和保护您的域名免受 DDoS 攻击。

[Cloudflare 计划](https://www.cloudflare.com/plans-b/)

# c# - 将多个 URL 重定向到单个 URL

> ID：15622991
> 
> 赞同：3
> 
> 时间：2013-03-25T19:21:13.760
> 
> 标签：c#, asp.net, url-rewriting, seo

我正在一个遗留的asp.net 和umbraco 网站上做一些工作。它使用 UrlRewritingNet 来设置 url 操作的规则。

我想在 UrlRewritingNet 文件中创建一个规则，以将多个 url 重定向到单个 URL。这是出于 SEO 的目的，以引用页面以防止稀释页面相关性。

因此，我希望[http://www.test.com/index.aspx](http://www.test.com/index.aspx)和[http://www.test.com/index](http://www.test.com/index)重定向到[http://www.test.com](http://www.test.com)。

我试过这个，但它似乎不起作用。

```
<add name="Rule1" ignoreCase="true" rewriteUrlParameter="ExcludeFromClientQueryString"
  redirectMode="Permanent"
  redirect="Application"
  virtualUrl="~/index(.*)"
  destinationUrl="^~/$"/> 
```

你能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T14:00:26.090

由于没有环境，我无法对此进行测试，但请尝试 destinationUrl="~/"，^ 和 $ 是您不需要的字符串字符的正则表达式开头和结尾。