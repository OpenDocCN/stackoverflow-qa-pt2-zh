# StackOverflow 问答 13422000-13422999

# javascript - 输入标签的javacode

> ID：13422003
> 
> 赞同：-7
> 
> 时间：2012-11-16T18:02:23.467
> 
> 标签：javascript

我有一个 java 函数，但我想把它放在输入标签中。我想这样做，但 hmtl 不显示它：

```
function ff
  {
  x.innerHTML="This is it <input id='id' name='name'  class='box' value=' " CODE    " '> ";
  } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:05:03.070

假设 CODE 是您的代码，您没有连接字符串，这就是它没有出现的原因。

# visual-studio-2010 - 单元测试的 Visual Studio 属性窗口？

> ID：13422004
> 
> 赞同：1
> 
> 时间：2012-11-16T18:02:24.343
> 
> 标签：visual-studio-2010, visual-studio, unit-testing, mstest

我发现了一篇关于“单元测试”属性窗口的博客文章，如下所示：（ [来源：][[msdn.com](http://blogs.msdn.com/blogfiles/slange/WindowsLiveWriter/DataDrivenTestsinTeamSystemUsingExcelast_CF7E/image_thumb_3.png)][）][![](../Images/cc5bbedb50af835d34a8da40d442dcc0.png)](https://i.stack.imgur.com/RbES3.png)

（图片来源：图片主页在[这里](https://blogs.msdn.microsoft.com/slange/2009/09/03/data-driven-tests-in-team-system-using-excel-as-the-data-source/)）

我的问题是，我一生都无法在“*属性*”窗口中填充“单元测试”。我正在运行 Visual Studio 2010 Ultimate。当我在*解决方案资源管理器*中单击文件时，它会按预期显示在“*属性”窗口中。*当我单击代码中的任意位置时，“*属性*”窗口变为空白。

我花了大约 10 分钟在谷歌上搜索答案，但我找不到答案（搜索结果中有很多噪音）。

我确定我在这里遗漏了一些明显的东西，当我想我会问 SO 的好人是否有答案时，我正要宣布损失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:09:18.347

在 Visual Studio 2010 中，从“测试”菜单中，选择“Windows\Test View”

在“测试视图”窗口中，您可以右键单击测试并选择“属性”

（我在 Visual Studio 2012 中根本找不到它。）

# xslt - 我们所说的 xsl 表示法是什么意思

> ID：13422008
> 
> 赞同：12
> 
> 时间：2012-11-16T18:02:36.900
> 
> 标签：xslt, notation

我不明白我们的意思。。

```
<xsl:template match="/|@*|node()">
<xsl:apply-templates match="@*|node()"/>
</xsl:template> 
```

请帮帮我。。

```
 <xsl:template match="local-name()='status'"/> 
<xsl:template match="/|@*|node()"> 
<xsl:copy> 
<xsl:apply-templates match="@*|node()"/> 
<xsl:copy> 
</xsl:template> 
```

如果我这样申请，它会 `<status>`在我的 xml 中省略节点，如何发生

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-16T18:17:05.720

`/|@*|node()`是由三个单一模式组成的[匹配模式。](http://www.w3.org/TR/xslt#patterns)`/`匹配根节点，也称为文档节点，`@*`匹配任何属性节点，并且`node()`作为模式“匹配除属性节点和根节点之外的任何节点”。因此，对于任何类型的节点（因为这三种模式描述了所有类型的节点），模板表示`<xsl:apply-templates select="@*|node()"/>`处理属性节点和子节点的联合。匹配的文档节点`/`没有属性节点，属性也没有它们，但作为一种紧凑的方式，您经常看到这样的模板。

但是，有一个文档节点的内置模板，`<xsl:template match="/"><xsl:apply-templates/></xsl:template>`通常人们会忽略`/`模式中的 。

# ms-access - 暂停代码以传递用户输入的值

> ID：13422015
> 
> 赞同：1
> 
> 时间：2012-11-16T18:03:14.243
> 
> 标签：ms-access

我正在使用 Access 2010，并希望用户单击 Form1 中名为“另存为”的按钮，该按钮启动 VBA 代码，在代码运行完成之前，让它暂停，打开 Form2（用户输入“另存为”标题，然后单击保存），然后使用在 Form2 中输入的字符串作为变量让代码继续在 Form1 中运行。

我只是不确定如何在 Form1 中“暂停”我的代码，因为它等待用户进行输入。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:12:59.120

从`Form1`，`Form2`以对话模式打开。 `Form1`代码将等待`Form2`。

向 中添加“完成”按钮`Form2`，并向其单击事件添加一个过程，该过程通过将其属性设置为 False来~~重新打开`Form2`隐藏~~隐藏表单。`.Visible`将其隐藏会使其脱离对话模式。所以用户输入她的值后，她可以点击“完成”，流控将恢复进入`Form1`，可以从 now-hidden 上的控件读取输入值`Form2`。

使用这种方法，`Form2`不需要知道任何关于`Form1`. 因此`Form2`可用于收集任意形式的输入……或其他代码。

所以假设`Form1`有一个名为 的命令按钮`cmdSaveAs`，使用类似这样的东西作为它的点击事件过程。

```
Private Sub cmdSaveAs_Click()
    DoCmd.OpenForm "Form2", acNormal, WindowMode:=acDialog
    ' the next line is not executed while Form2 is modal (open in dialog mode);
    ' but after Form2 is hidden, we can read the value of the text
    ' box named txtInput
    MsgBox "User input was: " & Forms!Form2!txtInput
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:08:59.113

您需要使用 Docmd.OpenForm 打开 Form2，并将 WindowMode 参数设置为 acDialog。这会导致调用窗体 (Form1) 上的代码停止并等待被调用窗体 (Form2) 关闭。在 Form2 上，当您单击“保存”按钮时，可以将“另存为”标题写入 Form1 上的隐藏文本框控件或将 Form1 上的属性设置为所需的值。当您返回 Form1 时，如果用户没有为“另存为”标题输入值，请确保您计划好您希望发生的事情。

# ruby-on-rails - 是否可以自定义 password_digest 以使用“password_digest”以外的列

> ID：13422020
> 
> 赞同：2
> 
> 时间：2012-11-16T18:03:33.623
> 
> 标签：ruby-on-rails

我想用*ActiveModel::SecurePassword*实现 Rails 身份验证，但我不想在我的*用户*模型中出现“password_digest”列。我如何告诉 Rails 使用列“foo”而不是“password_digest”？

顺便说一句-我已经更正了这篇文章。我最初有**"password"**而不是**"password_digest"**。对不起！*关于用户*模型中的“password_digest”列，Ryan Bates 在他的 RailsCast *270-authentication-in-rails 中*说“名称很重要，但您可以自定义它” 。我想*知道怎么做？*谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:23:27.093

从源代码来看，它看起来不像你可以......除非你想猴子修补这个方法......

```
# File activemodel/lib/active_model/secure_password.rb, line 34
def has_secure_password
  # Load bcrypt-ruby only when has_secure_password is used.
  # This is to avoid ActiveModel (and by extension the entire framework) being dependent on a binary library.
  gem 'bcrypt-ruby', '~> 3.0.0'
  require 'bcrypt'

  attr_reader :password

  validates_confirmation_of :password
  validates_presence_of     :password_digest

  include InstanceMethodsOnActivation

  if respond_to?(:attributes_protected_by_default)
    def self.attributes_protected_by_default
      super + ['password_digest']
    end
  end
end 
```

# php - 获取下个月的第一天

> ID：13422032
> 
> 赞同：13
> 
> 时间：2012-11-16T18:03:58.253
> 
> 标签：php, date, timestamp

> **可能重复：**
> [如何使用php找到下个月的第一天并保留到该日期的天数](https://stackoverflow.com/questions/1777384/how-to-find-first-day-of-the-next-month-and-remain-days-to-this-date-with-php)

我有这个来获得本月的第一天

```
$_SERVER['dataInicio'] = date('Y') . "-" . date('m') . "-" . "1"; 
```

我需要类似的东西来获得下个月的第一天

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-16T18:57:27.527

```
$date = new DateTime('now');

$date->modify('first day of next month');
echo $date->format('D') . '\n';

$date->modify('first day of this month');
echo $date->format('D') . '\n'; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-16T18:05:39.060

这似乎是下个月的重复或类似帖子

但是如果你想使用 strtotime，下个月会这样

```
date("m/l/Y", strtotime(date('m', strtotime('+1 month')).'/01/'.date('Y').' 00:00:00')); 
```

这将返回

12/Saturday/2012 如果您只想要日期名称，只需将日期格式设置为 l（小写 L）

`date("l", strtotime(date('m', strtotime('+1 month')).'/01/'.date('Y').' 00:00:00'));`

[如何使用PHP查找下个月的第一天和直到该日期的剩余天数](https://stackoverflow.com/questions/1777384/how-to-find-first-day-of-the-next-month-and-remain-days-to-this-date-with-php)

或这个

[在 PHP 中，有没有一种简单的方法来获取一个月的第一个和最后一个日期？](https://stackoverflow.com/questions/43589/in-php-is-there-an-easy-way-to-get-the-first-and-last-date-of-a-month)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-16T18:08:03.467

```
$_SERVER['dataInicio'] = date('Y-m-d', mktime(0, 0, 0, date('m')+1, 1, date('Y'))); 
```

应该做你想做的事。

# objective-c - UIViewImage 可以在其框架之外绘制其图像吗？

> ID：13422036
> 
> 赞同：3
> 
> 时间：2012-11-16T18:04:44.467
> 
> 标签：objective-c, ios, uiimageview, uiimage

在制作照片查看器应用程序时，发现我们的 UIImageView 控制器正在将其图像绘制到其框架之外，而内容模式既不是 ScaleToFill 也不是 Aspect Fit。

试图了解原因；我隔离了制作一个新项目的问题，该项目只有一个 UIImageView 和以下帧（50,50,100,100）。其中包含的图像大小为 (4592,3056)。

运行应用程序后，将内容模式设置为 ScaleToFill 和 AspectFit，一切都按预期工作：

但是将UIImageView的contentMode设置为TopLeft后，图像被绘制到了它的frame之外，奇怪的是frame中的log毕竟已经绘制出来了，还是原来的{50,50,100,100}。

我试图通过移动 UIViewController 的 Autoresize、剪辑和内容模式来理解这个问题，但结果是一样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:25:03.427

在视图上设置 clipToBounds = YES。

默认情况下它没有，因为这使得绘图更便宜

# ios - SSkeychain，如何存储 NSArray

> ID：13422040
> 
> 赞同：1
> 
> 时间：2012-11-16T18:05:07.460
> 
> 标签：ios, xcode

在另一个问题中，有人建议我使用 SSKeychain，在搜索网络后，似乎 SSKeychain 是使用 Keychain 的首选方法。

很难找到代码示例，而且那里只存储一个字符串，即密码。

当您有多个要存储在钥匙串中的钥匙时，您将如何使用 SSKeychain 保存和检索 NSArray。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:09:45.547

看看这里：http: [//github.com/granoff/Lockbox](http://github.com/granoff/Lockbox)。这是我建立的一个项目，用于将数据安全地存储在钥匙串中，它具有在应用程序被删除和重新安装时仍然存在的额外优势。

这是下课。它只是工作。

**编辑：** *现在*它可以工作了。我认为 Xcode 4.5 的某些方面比我最初开发 Lockbox 时更加严格。多亏了分叉版本的贡献，它又是一个简单的“即插即用”解决方案。

# java - java ResultSet 覆盖

> ID：13422041
> 
> 赞同：3
> 
> 时间：2012-11-16T18:05:12.117
> 
> 标签：java, sql, resultset, multiple-resultsets

我的结果集似乎有一些问题，我对它们的命名不同，但它们似乎都有相同的数据，但我不知道为什么。

```
String query = "SELECT * FROM blog_comments;";
ResultSet rs = stmt.executeQuery(query);
ResultSetMetaData rsmd = rs.getMetaData();
int colNum = rsmd.getColumnCount();
boolean more = rs.next();

String query2 = "SELECT * FROM blog_entries;";
ResultSet rs2 = stmt.executeQuery(query2);
ResultSetMetaData rsmd2 = rs2.getMetaData();
int colNum2 = rsmd2.getColumnCount();
boolean more2 = rs2.next(); 
```

我查看了调试，它们都有相同的列，但我认为他们不应该有任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T18:07:58.287

您需要一个新的 Statement 来实例化您的新 ResultSet。

```
Statement st1 = Conn.CreateStatement();
Statement st2 = Conn.CreateStatement();

ResultSet rs1 = st1.executeQuery();
ResultSet rs2 = st2.executeQuery(); 
```

从[语句 API](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/Statement.html)。

> 默认情况下，每个 Statement 对象只能同时打开一个 ResultSet 对象。因此，如果一个 ResultSet 对象的读取与另一个 ResultSet 对象的读取交错，则每个对象都必须由不同的 Statement 对象生成。Statement 接口中的所有执行方法都会隐式关闭语句的当前 ResultSet 对象（如果存在打开的对象）。

# java - 在处理程序中组装 Netty 消息

> ID：13422043
> 
> 赞同：6
> 
> 时间：2012-11-16T18:05:17.347
> 
> 标签：java, netty

我正在为我的项目制作 Netty 原型。我正在尝试在 Netty 之上实现一个简单的面向文本/字符串的协议。在我的管道中，我使用以下内容：

```
public class TextProtocolPipelineFactory implements ChannelPipelineFactory
{
@Override
public ChannelPipeline getPipeline() throws Exception 
{
    // Create a default pipeline implementation.
    ChannelPipeline pipeline = pipeline();

    // Add the text line codec combination first,
    pipeline.addLast("framer", new DelimiterBasedFrameDecoder(2000000, Delimiters.lineDelimiter()));
    pipeline.addLast("decoder", new StringDecoder());
    pipeline.addLast("encoder", new StringEncoder());

    // and then business logic.
    pipeline.addLast("handler", new TextProtocolHandler());

    return pipeline;
}
} 
```

我在管道中有一个 DelimiterBasedFrameDecoder、一个字符串解码器和一个字符串编码器。

由于此设置，我的传入消息被拆分为多个字符串。这导致多次调用我的处理程序的“messageReceived”方法。这可以。但是，这需要我在内存中积累这些消息，并在收到消息的最后一个字符串包时重新构造消息。

我的问题是，“累积字符串”然后“将它们重新构造成最终消息”的最有效的内存方式是什么。到目前为止，我有 3 个选项。他们是：

*   使用 StringBuilder 来累积和 toString 来构造。（这给出了最差的内存性能。事实上，对于具有大量并发用户的大型有效负载，这给出了不可接受的性能）

*   通过 ByteArrayOutputStream 累积到 ByteArray，然后使用字节数组构造（这比选项 1 提供更好的性能，但它仍然占用相当多的内存）

*   累积到一个 Dymamic Channel Buffer 并使用 toString(charset) 来构造。我还没有分析这个设置，但我很好奇这与上述两个选项相比如何。有没有人使用动态通道缓冲区解决了这个问题？

我是 Netty 的新手，我可能在架构上做错了什么。您的意见将不胜感激。

在此先感谢索希尔

**添加我的自定义 FrameDecoder 实现以供 Norman 审查**

```
public final class TextProtocolFrameDecoder extends FrameDecoder 
{
public static ChannelBuffer messageDelimiter() 
{
      return ChannelBuffers.wrappedBuffer(new byte[] {'E','O','F'});
    }

@Override
protected Object decode(ChannelHandlerContext ctx, Channel channel,ChannelBuffer buffer) 
throws Exception 
{
    int eofIndex = find(buffer, messageDelimiter());

    if(eofIndex != -1)
    {
        ChannelBuffer frame = buffer.readBytes(buffer.readableBytes());
        return frame;
    }

    return null;
}

private static int find(ChannelBuffer haystack, ChannelBuffer needle) {
    for (int i = haystack.readerIndex(); i < haystack.writerIndex(); i ++) {
        int haystackIndex = i;
        int needleIndex;
        for (needleIndex = 0; needleIndex < needle.capacity(); needleIndex ++) {
            if (haystack.getByte(haystackIndex) != needle.getByte(needleIndex)) {
                break;
            } else {
                haystackIndex ++;
                if (haystackIndex == haystack.writerIndex() &&
                    needleIndex != needle.capacity() - 1) {
                    return -1;
                }
            }
        }

        if (needleIndex == needle.capacity()) {
            // Found the needle from the haystack!
            return i - haystack.readerIndex();
        }
    }
    return -1;
   }
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T05:04:01.750

如果您实现自己的 FrameDecoder，我认为您将获得最佳性能。这将允许您缓冲所有数据，直到您真正需要将其分派给链中的下一个处理程序。请参考[FrameDecoder](http://static.netty.io/3.5/api/org/jboss/netty/handler/codec/frame/FrameDecoder.html) apidocs。

如果您不想自己处理 CRLF 的检测，也可以保留 DelimiterBasedFrameDecoder 并在其后面添加一个自定义 FrameDecoder 来组装代表一行文本的 ChannelBuffers。

在这两种情况下，FrameDecoder 都会尽量减少内存副本，方法是尝试“包装”缓冲区而不是每次都复制它们。

也就是说，如果您想获得最佳性能，请使用第一种方法，如果您希望轻松使用第二种方法；）

# c++ - 为什么我的 c++ 程序在 Eclipse 中没有输出但在 Visual Studio 中可以运行？

> ID：13422044
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:05:27.013
> 
> 标签：c++, eclipse

我的程序在 Windows 上的 Visual Studio 中运行，但是当我尝试在 Ubuntu 上的 Eclipse 中处理它时，它会在我尝试运行时终止，根本不显示任何输出。

Eclipse 正在使用 Linux GCC 工具包。

我没有编译器错误或警告或任何东西，控制台只显示说它终止然后空白的位。

我进入调试并想出了

Shop [1188] [cores: 1]
Thread [1] 1188 [core: 1]（暂停：信号：SIGSEGV:Segmentation fault）0x7ffff7b78bca
std::string::assign() at 0x7ffff7b79ff6 operator=() at basic_string.h： 542 0x402f00
fillInventory() at shop.cpp:364 0x402f00
main() at shop.cpp:73 0x401a29

我*认为*它没有打开输入文件，但我不确定......主要和原型如下：

```
input file      :ball_inventory.txt
output file     :ball_reportData.txt
*/

#include <iostream>
#include <cmath>
#include <string>
#include <fstream>
#include <sstream>
#include <iomanip>

using namespace std;

//CLASSES and STRUCTURES
struct inventory
{
    string name;            //name of item
    int cost;               //cost of item
    int stock;              //items in stock
    int deficit;            //items ordered but not provided when out of stock
};

//PROTOTYPES

//Receive and validate input for yes/no prompts.
char yesNo();
//Display shop's logo
void logo();
//Display the low level item menu
void lowLevelMenu(int limit, inventory lowLevelInv[]);
//perform a purchase action for a single individual
int purchase(int limit, inventory lowLevelInv[], int itemTally[]);
//populate the inventory array with name, price, stock, data, initialize deficit to 0.
int fillInventory(ifstream &fin, inventory lowLevelInv[]);
//sort the inventory array by the day's deficit
void sortByDeficit(inventory lowLevelInv[], int limit);

//BODY
/*  
*   Function Procedure:
*   1\.  Prompt "customer 1" user for purchases
*   3\.  Update group total
*   3\.  Loop until there are no more "customers"
*   4\.  Output group total
*   5\. If no more groups, prompt for password.
*   6\. At end of day, output to file, 1 line per item: name, stock, deficit.
*/
int main()
{
    const int INV = 20;                                     //sets size of item[] and parallel arrays
    char confirm = 'n';                                     //holds user response to y/n prompts
    int groupTot;                                           //Group's total cost
    ifstream invSrc;                                        //inventory resource file
    ofstream    ball_reportData;                            //output file for report
    int limit;                                              //number of populated elements in arrays
    string password = "98765";                              //sets manager password
    string passCheck;                                       //user input to be checked against password
    bool exitAllow = 0;                                     //allows program to generate report and exit
    int itemTally[INV];                                     //tally of items ordered by a user
    inventory lowLevelInv[INV];                             //contains inventory information for the low level inventory

    invSrc.open("ball_inventory.txt");                      //open inventory file, populate arrays, close inventory file.
    /*LINE 73*/ limit = fillInventory(invSrc, lowLevelInv);
    invSrc.close();

    logo();                                                 //display shop logo

    while(!exitAllow)                                       //continue running until password is entered to set exitAllow to true
    {
        groupTot = 0;                                       //initialize group total due to 0;
        groupTot += purchase(limit, lowLevelInv, itemTally);                //prompt first customer for purchases and update group total
        do
        {
            cout<<"Are there any more orders for this group? y/n: ";        //check for more customers
            confirm = yesNo();
            if(confirm == 'y')                                              //prompt additional users and update total for each
            {
                groupTot += purchase(limit, lowLevelInv, itemTally);
            }
        }while(confirm == 'y');

        cout<<"The group's total is: "<<groupTot<<" denarii.";          //output total for group

        cout<<"\n\nAre you done for the day?";                                  //confirm for more groups to calculate
        confirm = yesNo();
        while(confirm == 'y')
        {
            cout<<"Enter your password:";
            cin>>passCheck;
            if(password != passCheck)
            {
                cout<<"Invalid password, try again? ";
                confirm = yesNo();
            }
            else
            {
                exitAllow = 1;
                confirm = 'n';
            }
        }
    }

    for(int i = 0; i<limit; i++)
    {
        cout << lowLevelInv[i].stock << endl;
    }
    for(int i = 0; i<limit; i++)
    {
        cout << lowLevelInv[i].deficit << endl;
    }
    cout << string(20, '-')<<endl;
    sortByDeficit(lowLevelInv, limit);

    ball_reportData.open("ball_reportData.txt");
    for(int i = 0; i<limit; i++)
    {
        ball_reportData << lowLevelInv[i].name << endl;
        ball_reportData << lowLevelInv[i].stock << endl;
        ball_reportData << lowLevelInv[i].deficit << endl;
    }

    cout<<"\n\nPress Enter to finish...";
    cin.ignore();
    cin.get();
    return(0);
} 
```

填充库存：

```
int fillInventory(ifstream &fin, inventory lowLevelInv[])
{
    string name = "junk";               //name to be input to itemArray
    string cost;
    string stock;                           //cost to be input to costArray
    int i = 0;                              //incrementer
    stringstream convert;               //string stream used to input string to int
    int max=0;                                  //Number of elements filled in array

    while(name != "none")               //until "none" in file, fill name/cost arrays
    {
        getline(fin, name);             //get name line
        getline(fin, cost);             //get cost line
        getline(fin, stock);
        if(name != "none")
        {
/*LINE 364*/    lowLevelInv[i].name = name;         //output to name array
            convert<<cost;                  //fill stringstream
            convert >> lowLevelInv[i].cost; //output stringstream to cost array
            convert.clear();                //clear EOF(?) flag
            convert<<stock;                 //fill stringstream
            convert >> lowLevelInv[i].stock;    //output stringstream to cost array
            convert.clear();                //clear EOF(?) flag
            lowLevelInv[i].deficit = 0;         //set initial deficit

            max++;
        }
        i++;
    }
    return max;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T18:15:18.827

正如[“无控制台输出（MinGW，CDT）”](http://www.eclipse.org/forums/index.php/t/197552/)中的人指出的那样，这可能（或至少有时）是因为 Eclipse 在启动可执行文件时没有将 PATH 添加到 MINGW\bin，所以：

在“环境”标签中，按“新建”，将其设置为：

*   “名称：路径”
*   “值：C:\MinGW\bin”

# javascript - 如果 ($(this).val() == "Spine") 但不是 ($(this).val() == "Spine"||"Brian")，此代码工作正常

> ID：13422045
> 
> 赞同：3
> 
> 时间：2012-11-16T18:05:34.287
> 
> 标签：javascript, jquery, html

`($(this).val() == "Spine")`如果选择菜单关闭，则此代码工作正常，然后在选择我做错`($(this).val() == "Spine"||"Brian")`了什么时再次打开？`"optionbodyRegion" == ""`

```
$("#optionbodyRegion").change(function(){

                if ($(this).val() == "Spine"||"Brain") {

                    document.getElementById('optioncontrast').options[0]=new Option("Select", "", false, false)
                    document.getElementById('optioncontrast').options[1]=new Option("With", "With", false, false)
                    document.getElementById('optioncontrast').options[2]=new Option("Without", "Without", false, false)
                    document.getElementById('optioncontrast').options[3]=new Option("With and Without", "With and Without", false, false)

                    $("#contrast").slideDown("fast"); //Slide Down Effect

                } else {
                    if ($(this).val() == "" ) {
                    $("#contrast").slideUp("fast");   //Slide Up Effect

                    }
                }
            }); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T18:06:27.540

使用逻辑或`||`运算符时语法错误

改变

```
 if ($(this).val() == "Spine"||"Brain") { 
```

至

```
if ($(this).val() == "Spine"|| $(this).val() == "Brain") { 
```

正如 Fabrício Matté 建议的那样，您可以将 value 与 javascript 对象一起使用，而不是 jquery 对象的 val()。它会给你带来性能上的好处。

```
if (this.value == "Spine" || this.value == "Brain") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-16T18:07:07.577

您必须在“或”的每一侧陈述完整的条件/测试。

```
if($(this).val() == "Spine" || $(this).val() == "Brain") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T18:07:47.873

试试这个代码：

```
 if (($(this).val() == "Spine")||($(this).val() =="Brain"))) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-16T18:11:30.040

您正在寻找的是：

```
if ($(this).val() == "Spine"|| $(this).val() == "Brain") 
```

照原样，您的代码有关于运算符优先级的错误。我建议查看[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)

您的版本将始终返回 true，因为在布尔上下文中使用任何非零长度字符串都会解析为 true。关于布尔求值时 Javascript 的古怪行为有很多文章。一些最常见的基本大纲可以在[http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/找到](http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-16T18:13:46.557

我会使用不同的方法。特别是如果列表增长。如果您得到一个包含多个部分的列表，则条件会变得很难看。

```
var parts = ["Spine", "Brain"];
var value = $(this).val();

if($.inArray(value, parts) > -1){
    //do something    
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-16T18:16:58.437

或使用开关盒

```
$("#optionbodyRegion").change(function(){
    switch ($(this).val())
{
   case "Spine": case "Brain": 
    document.getElementById('optioncontrast').options[0]=new Option("Select", "", false, false)
                    document.getElementById('optioncontrast').options[1]=new Option("With", "With", false, false)
                    document.getElementById('optioncontrast').options[2]=new Option("Without", "Without", false, false)
                    document.getElementById('optioncontrast').options[3]=new Option("With and Without", "With and Without", false, false)

                    $("#contrast").slideDown("fast"); //Slide Down Effect
   break;
 case "":
$("#contrast").slideUp("fast");   //Slide Up Effect
break;

  default: 
  break;
} 
```

# php - mb_convert_case 未定义函数 (Symfony2 FOS/UserBundle)

> ID：13422048
> 
> 赞同：7
> 
> 时间：2012-11-16T18:05:50.767
> 
> 标签：php, symfony, mamp, mbstring

在我的 Symfony2 应用程序中，我收到一个错误：

> 致命错误：在第 18 行的 /Applications/MAMP/htdocs/application/vendor/bundles/FOS/UserBundle/Util/Canonicalizer.php 中调用未定义函数 FOS\UserBundle\Util\mb_convert_case()

我正在使用 PHP 5.3.6。

这是我的 PHPInfo，显示 mbstring 已启用：

[http://i.stack.imgur.com/FCMDv.png](http://i.stack.imgur.com/FCMDv.png)

如果启用了 mbstring，那么为什么找不到 mb_convert_case？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T18:17:19.967

我找到了这个：

在 Windows 下，您必须取消注释 php.ini 中带有 php_mbstring.dll 的行

我不知道您是否正在运行 Windows 框。

# javascript - 如何修补 console.error 或 info 但保留 Firebug 的跳转 url？

> ID：13422050
> 
> 赞同：1
> 
> 时间：2012-11-16T18:05:53.107
> 
> 标签：javascript, firebug

我看到很多帖子如何用其他人替换 JS 控制台功能，但没有人将它完好无损地留给 Firebug。

当我替换它们中的任何一个时，它会调用我的自定义函数，但它会报告来自新函数的同一位置的消息。

这里的目标是接收任何这些控制台消息并将它们显示在其他地方，同时我仍然可以跳转到 Firebug 控制台中的被调用者。

这可能吗？

更新：例如（PSEUDO）：

```
//keep the old one
var oriFn=console.error;

console.error=function(){
   someOtherFunc(arguments);//send to server for instance
   oriFn(arguments);
} 
```

现在我想在其他地方像往常一样调用 console.error('bla'); 在 Firebug 控制台中，它会打印我的消息，但会显示上面替换代码的链接。我想在 Firebug 控制台中链接到被调用者的父函数，就是这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-09T20:53:08.167

使用函数指针。给定 foo.js：

```
function foo()
 {
 console.error = console.log; //Reassign console.error
 location.hash = document.title; //Do something
 console.error("Not the mama");  //Outputs line foo.js:5
 } 
```

**参考**

*   [如何去匿名化你的匿名函数](http://www.javascriptkata.com/2010/05/19/how-to-de-anonymize-your-anonymous-functions/)

*   [JavaScript Wikibook：匿名函数](https://en.wikibooks.org/wiki/JavaScript/Anonymous_Functions)

*   [JavaScript 匿名函数](http://blog.scottlogic.com/2011/06/10/javascript-anonymous-functions.html)

*   [Javascript 函数声明与函数运算符](http://helephant.com/2012/07/14/javascript-function-declaration-vs-expression/)

# html - 为什么 js 文件在另一个文件夹中不起作用？

> ID：13422054
> 
> 赞同：2
> 
> 时间：2012-11-16T18:06:05.977
> 
> 标签：html, directory

我的文件夹层次结构是：

```
\- htdocs
    |- folder
        |- bootstrap
            |- js
                |- boostrap.min.js
        |- index.html 
```

我正在使用这个脚本来调用 .js 文件：

```
<script src="bootstrap/js/bootstrap.min.js"></script> 
```

我也试过：

```
<script src="folder/bootstrap/js/bootstrap.min.js"></script> 
```

我没有成功，这里有人知道它是如何工作的吗？

编辑：当我说“它不起作用”时，我的意思是 js 文件没有加载。
我的日志文件：

> 1 - - [16/Nov/2012:15:16:21 -0300] "GET /bootstrap/css/bootstrap.min.css HTTP/1.1" 404 1310 "localhost/THU/index.html"; “Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:08:12.990

根据您的文件夹结构，只要这`<script>`是`index.html`您调用的，您的第一个导入是正确的：

```
<script src="bootstrap/js/bootstrap.min.js"></script> 
```

ps - 不要忘记包括`type="text/javascript"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:12:20.057

在 Chrome 中打开页面。右键单击 > 查看源代码。右键单击 js 引用并在新选项卡中打开。这将向您显示浏览器认为您将其指向的位置，并且您应该能够从那里进行调整。

# wcf - 无法访问 WCF 服务（自托管）

> ID：13422065
> 
> 赞同：0
> 
> 时间：2012-11-16T18:06:53.717
> 
> 标签：wcf, service, host

今天我决定看一下 WCF，这个例子在我的本地主机上运行得非常好，我也试图在我的服务器上运行，所以我用正确的主机编译它（测试了 IP 和域）并将它上传到我的服务器

你可以在这里看到源代码：http: [//pastebin.com/YiCR0RCf](http://pastebin.com/YiCR0RCf)

问题是，我无法将服务添加到我的客户端应用程序，也无法在浏览器中打开 http 站点（本地主机运行良好）

我在 Windows 根服务器上运行它并禁用了该程序的防火墙。如果你能给我一个让它正常工作的提示，那就太好了，因为我在过去的 2 个小时里随机更改代码并上传程序，希望它现在可以工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:36:25.830

好的，它是 Windows 防火墙，我完全禁用了它（之前添加了一个例外，但我现在知道这没有帮助）并且它可以工作。

不管怎么说，多谢拉

# c# - 如何为其他应用程序手动锁定文件

> ID：13422072
> 
> 赞同：5
> 
> 时间：2012-11-16T18:07:14.693
> 
> 标签：c#, .net, file, io, file-locking

我花了很长时间弄清楚如何做到这一点，但没有找到任何有用的解决方案。

这就是我想要做的。我正在我的应用程序中生成一个巨大的二进制文件。棘手的是，这个过程需要我偶尔关闭 FileStream。现在的问题是，有时其他应用程序（即我的病毒扫描程序）正在使用文件不再锁定的这一短暂时刻来锁定文件本身。或其他应用程序，如保管箱等...

结果是，下次我需要打开文件流时，它说它被另一个进程锁定了。所有这些都很少发生，但当它发生时仍然很烦人。即使我仍然可以访问文件，我仍然不希望 ie 保管箱在完成之前上传此文件（这可能需要几分钟）。

我需要的是手动锁定文件的可能性，以便我的应用程序仍然可以打开该文件上的文件流，但在我再次手动解锁之前没有其他应用程序可以打开它。

我用伪代码描绘了这样的东西：

```
 File.Lock(filepath);

 //... do something that opens and closes filestreams on this file

 File.Unlock(filepath); 
```

有没有办法做到这一点？“保持文件流打开”的解决方案无效。我明确地试图避免这种情况，所以请记住这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T18:22:42.157

正如您自己注意到的，锁定文件的最佳方法是使用`FileStream`. 您说，您的主 FileStream 已关闭，但您可以使用一个来模拟锁。这是一个示例类，使用 IDisposable 以便`FileLock`对象本身是锁，并释放它：

```
 public class FileLock : IDisposable
 {
    private FileStream _lock;
    public FileLock(string path)
    {
        if (File.Exists(path))
        {
            _lock = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.None);
            IsLocked = true;
        }            
    }

    public bool IsLocked { get; set; }

    public void Dispose()
    {
        if (_lock != null)
        {
            _lock.Dispose();
        }
    }
} 
```

和用法：

```
using (FileLock lock = new FileLock(filePath))
{
      // Safe in the knowledge that the file is out of harm's way. 
} 
```

# android - Google Play 图书应用价格

> ID：13422075
> 
> 赞同：-4
> 
> 时间：2012-11-16T18:07:29.147
> 
> 标签：android, google-play

Google Play 将我的图书应用程序的价格从 4.99 美元更改为 5.07 美元。在应用程序设置中，价格仍然是 4.99 美元。Google 为什么要更改价格？我如何获得我想要的价格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:39:44.520

虽然这并不是一个与编程相关的问题，因此不应该出现在 SO 上。我预计您的问题与适用于您在 Play 商店中输入的价格的销售税有关。

# javascript - 使用循环将点击事件绑定到在 javascript/jquery 中不起作用的几个元素上

> ID：13422080
> 
> 赞同：1
> 
> 时间：2012-11-16T18:07:51.517
> 
> 标签：javascript, jquery

我有一张消息地图说：

```
var Mapping = {
"notnow": 2,
"expensive": 3,
"not_worth_it": 4
} 
```

我有一堆 html 元素（让我们说具有相同名称的 div）所以

```
<div id="notnow"></div> 
```

，ETC

现在我想为每个人附加一个点击处理程序，我运行一个循环，如下所示

```
function setThemUp(){
   for(var item in Mapping)
   {
      $("#" + item).bind('click', function () {
      Apply(Mapping[item]); });
   }
} 
```

但由于某种原因，它们似乎都被绑定到“not_worth_it”：4。不是他们各自的价值观。

我正在使用 Jquery 1.5。

有人可以解释为什么会发生这种情况吗？

我的猜测是，与其将 Mapping[item] 解析为它们的值，不如将它作为引用或其他东西传递，这就是为什么由于 item 的值最终指向“不值得”，所有它们都使用该值调用函数本身。我可以通过任何方式克服它们。

将它们中的每一个硬编码为

```
 $("#notnow").bind('click', function () {
      Apply(Mapping["notnow"]); });
  $("#expensive").bind('click', function () {
      Apply(Mapping["expensive"]); });
  $("#not_worth_it").bind('click', function () {
      Apply(Mapping["not_worth_it"]); }); 
```

确实有效，但我更喜欢带有循环的优雅解决方案。

**回答**

我选择了关闭解决方案

```
function setThemUp(){
   for(var item in Mapping)
   {
       $("#" + item).bind('click', (function () {
            return function(temp) {
                 Apply(Mapping[temp]); };
            })(item));
       }
   } 
```

原因是，这更多是循环不起作用的原因，而不是关于 jquery 的优化，因为这毕竟是一个有代表性的例子，而不是我的实际代码，这是解决这个问题的一个优雅的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:13:53.403

这是*范围*问题的典型案例：您`item`在每个绑定的处理程序中引用变量。但是，变量`item`发生了变化->它被分配了`Mapping`对象文字的所有属性，最后一个是`not_worth_it`.

创建闭包可能有助于保留`item`每个回调的状态：

```
for(var item in Mapping)
{
   $("#" + item).bind('click', (function(currentItem)
   {//IIFE, pass item as argument---------/
        return function ()
        {//return function, \/ access to closure scope
            Apply(Mapping[currentItem]);
         };
    }(item)););
} 
```

但这似乎有些矫枉过正，为什么不简单地委托事件并使用`Mapping[$(this).attr('id')]`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:26:52.510

我建议改用这种形式：

将类添加`mapped`到映射 div。

HTML

```
<div id="notnow" class="mapped"></div> 
```

JS

```
function setThemUp(){
    $('.mapped').bind('click', function () {
        Apply(Mapping[this.id]); 
    });
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-16T18:12:57.637

问题是你需要写：

```
for (var item in Mapping) 
```

而不是 foreach。

# iphone - UIViewController 中的键盘倒置

> ID：13422084
> 
> 赞同：0
> 
> 时间：2012-11-16T18:08:05.940
> 
> 标签：iphone, objective-c, uiviewcontroller, ios6, uiinterfaceorientation

我正在尝试更新我的应用程序以与新的 iPhone 5 一起使用，并且我的一些视图正在将键盘从视图顶部而不是底部放下。这里有一张图片可以更好地说明：

![在此处输入图像描述](../Images/1f116c098e518fdc2551fa255a13a881.png)

这在 iOS 6.0 之前有效，所以我猜它一定是新 API 中的某些东西导致了这个错误。我正在使用以下代码来支持 UIVeiwController 中的方向：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
   // Return YES for supported orientations
   return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft || 
           interfaceOrientation == UIInterfaceOrientationLandscapeRight);
}

- (BOOL)shouldAutorotate {
   return YES;
}

- (NSUInteger)supportedInterfaceOrientations {
   return UIInterfaceOrientationMaskLandscape;
} 
```

有没有其他人看到过类似的问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:33:30.020

我试图复制您的问题，但它在 iOS6 上对我很有用。我的建议可能不是很有帮助，但请查看该委托、合成和所有功能匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:50:51.080

[我在这个问题](https://stackoverflow.com/questions/12537541/supportedinterfaceorientations-method-not-working-on-ios-6-uiviewcontroller)上找到了答案。通过更改我设置根 UI 视图控制器的一行代码来解决我的问题。

更改此行：

```
[window addSubview:viewController.view]; 
```

对此：

```
[window setRootViewController:viewController]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T22:12:35.580

安德鲁，我还发现 iOS 6 中不推荐使用 shouldAutoROtateToInterfaceOrientation 方法。

无论如何，我看到你解决了你的问题。

# wordpress - 如何从 WordPress 对象缓存中清除用户权限？

> ID：13422088
> 
> 赞同：3
> 
> 时间：2012-11-16T18:08:17.263
> 
> 标签：wordpress, permissions, memcached, wpmu

我在 Amazon EC2、RDS、Nginx、PHP-FPM、APC、BatCache 和 Memcached 上运行了一个高度优化的 WordPress 多站点 (WPMU) 安装。

APC 仅在 PHP 级别运行，用于缓存操作码，但我没有将它用于 WordPress 的对象缓存。为此，我使用的是 BatCache+Memcached。

所有这一切都运行得非常好，在负载下超快等等，但我只是遇到了一个意想不到的问题。

我以测试用户身份登录，创建了一个新博客，当我登录 /wp-admin 时它告诉我我没有权限。我注销，重新登录，同样的问题。然后我注销，重新启动 Memcached，重新登录，问题就解决了。

我几乎可以肯定这是与缓存相关的。我可能需要加入新站点创建过程并从 Memcached 中清除一些键，但我不确定如何找到要清除的正确键。

请帮忙！;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:43:20.307

如果这与用户角色功能有关，我不太确定，但如果是的话……这应该是一个将管理员功能重置为默认值的小脚本：

```
add_action( 'after_setup_theme', 'add_roles_caps' );
function add_roles_caps() {

  $caps = array(
    "edit_post",
    "read_post",
    "delete_post",
    "edit_posts",
    ...
  );
  $roles = array(
    get_role( 'administrator' ),
    get_role( 'subscriber' ),
  );
  foreach ($roles as $role) {
    foreach ($caps as $cap) {
      $role->add_cap( $cap );
    }
  }
} 
```

[这是一个示例.. 您应该使用此处](http://codex.wordpress.org/Roles_and_Capabilities)列出的所有功能填充 $caps 数组

# java - 提交表单时收到错误消息：“客户端发送的请求在语法上不正确”

> ID：13422093
> 
> 赞同：2
> 
> 时间：2012-11-16T18:08:51.997
> 
> 标签：java, spring

我正在开发一个使用 Spring 框架 3.1.0 版开发的 Web 应用程序。

我有一个 JSP 页面，其中包含一个表单，该表单允许用户从 SELECT 下拉列表框中选择一个国家/地区。提交表单应该运行数据库查询并返回相同的 JSP 页面，其中包括表单以及所选国家/地区的作者和机构数据的 HTML 表。

下面是 JSP 页面的部分代码：

```
<c:url var="submitUrl" value="/authorsInstitutes.htm"/>
<form:form action="${submitUrl}" method="POST">
   <select id="countryCode">
      <option value="-1">-- Please Select --</option>
         <c:forEach var="country" items="${countryList}">
            <option value="${country.countryCode}">${country.countryName}</option>
         </c:forEach>
   </select>
   <input type="submit"/>
</form:form> 
```

这是控制器类的代码，用于处理“GET”和“POST”请求的方法：

```
@RequestMapping(value = "/authorsInstitutes", method = RequestMethod.GET)
public ModelAndView displayAuthorsInstitutesForm() {
    ModelAndView mav = new ModelAndView("authorsInstitutes");

    List<Country> countryList = countrySrv.findAll();
    mav.addObject("countryList", countryList);

    return mav;
}

@RequestMapping(value = "/authorsInstitutes", method = RequestMethod.POST)
public ModelAndView displayAuthorsInstitutes(
    @RequestParam(value = "countryCode") String country) {
    ModelAndView mav = new ModelAndView("authorsInstitutes");

    List<Country> countryList = countrySrv.findAll();
    mav.addObject("countryList", countryList);

    if (country != null && !country.trim().equals("")) {
        List<Affiliation> affiliationList = 
            affiliationSrv.getAffiliationsByCountryCode(country);
        mav.addObject("affiliationList", affiliationList);
    }

    return mav;
} 
```

'GET' 请求工作正常，但是当我选择一个国家并提交表单时，我收到 404 错误消息：

> HTTP 状态 400 -
> 类型状态报告
> 消息
> 描述客户端发送的请求在语法上不正确 ()。

我确信这很简单，但对于我的生活，我只是没有看到我做错了什么。我将不胜感激任何帮助解决这个问题，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:59:27.283

因为我们`countryCode`在 POST 方法映射中有一个请求参数。控制器期望在请求中发送参数。这是在下面的代码中

```
@RequestMapping(value = "/authorsInstitutes", method = RequestMethod.POST)
public ModelAndView displayAuthorsInstitutes(@RequestParam(value = "countryCode") String country) {
 } 
```

更改 jsp 中的选择标记以包含这样的名称属性。

```
<select id="countryCode" name="countryCode">
  <option value="-1">-- Please Select --</option>
     <c:forEach var="country" items="${countryList}">
        <option value="${country.countryCode}">${country.countryName}</option>
     </c:forEach>
</select>
<input type="submit"/> 
```

这会将 contryCode 分配给选定的选项。试试这个，我希望它会工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:13:47.740

使用 Firebug 或任何类似工具，检查`countryCode`参数是否传递到服务器。我也看到请求映射是

`@RequestMapping(value = "/authorsInstitutes", method = RequestMethod.POST)`

请求发送到哪里`/authorsInstitutes.htm`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-26T06:34:10.490

您需要从 url 标签中的 url 中删除斜杠，如下所示：

`<c:url var="submitUrl" value="authorsInstitutes.htm"/>`

如果在jsp中使用带斜线的绝对路径，表单将不会发送数据。

# tor - Tor StrictExitNodes 不工作

> ID：13422099
> 
> 赞同：2
> 
> 时间：2012-11-16T18:09:14.663
> 
> 标签：tor

因此，根据整个 Internet 的建议，包括 Tor 文档，我试图通过编辑 torrc 文件来强制仅美国出口节点，如下所示：

```
StrictNodes 1
ExitNodes {US} 
```

但是，我仍然从西欧、澳大利亚和美国获得出口节点。我正在使用 Vidalia 捆绑包，尽管我从命令行以编程方式启动 Tor 和 Polipo 并通过 Polipo 执行 HttpWebRequests。有什么想法吗？我真的非常需要出口节点只能来自美国，我真的很惊讶这不起作用。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T20:00:43.013

当我从命令行启动 Tor 时，我似乎通过添加这个参数解决了这个问题：

```
-f C:\Users\Frank\AppData\Local\Vidalia\torrc 
```

我不确定为什么 Tor 默认不使用这个配置文件，但现在我明确指出它，它似乎遵循 StrictNodes 指令。谢谢。

# git - 将我的 git .config 文件提交到 github - 我应该对我的 github 令牌保密吗？

> ID：13422105
> 
> 赞同：1
> 
> 时间：2012-11-16T18:09:47.293
> 
> 标签：git, github

我想添加`~/.gitconfig`到我`dotfiles`在 github 上的存储库，以便我可以在我使用的不同机器之间共享它。但是其中一项设置是针对github的，如下：

```
[github]                                                                      
    user = jononomo
    token = 3517aa3a6f1cda2f07bf6e73f30248d3
    email = me@myemailaddress.com 
```

对我来说保持这个令牌的秘密很重要，因此`~/.gitconfig`如果它包含令牌就不要提交我的文件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:21:05.507

是的。将此令牌保密非常重要。**您不应该在公共**存储库上提交此文件。

**您甚至不应该在 stackoverflow 上粘贴您的真实令牌。**

也许有人可以使用这些信息访问一些私人数据。GitHub 博客上的[Token Authentication](https://github.com/blog/170-token-authentication "令牌认证") Post 说：

> 只需将`login`and传递`token`给任何需要身份验证的 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-21T02:39:11.447

您可以使用以下`[include]`部分`gitconfig`：

```
[include]
        path = ~/.gitconfig.local 
```

然后把私人信息放在那里，并将这个文件添加到你的 dotfile 的 .gitignore 中。

# jquery-mobile - jqm iscrollview 滚动条“最小高度”到高

> ID：13422107
> 
> 赞同：1
> 
> 时间：2012-11-16T18:09:56.693
> 
> 标签：jquery-mobile, uiscrollview

我有一个带有标题的 jqm 页面和一个始终可见的 div 块。在此块之后，我在新 div 中添加了一个列表视图并启用了 iscroll via `data-iscroll=""`。

如果它必须滚动，iscroll-div 会获得一个很高的高度值。某些内容不可见且不可滚动（请参阅屏幕截图红圈）。

![在此处输入图像描述](../Images/48c8f2f0d12d1e2ca8cea630ab713f6e.png)

我的简短代码如下：

```
<div data-role="page" id="pageId">
    <div data-role="header" data-position="fixed">
        {title}
    </div>
    <div data-role="content">
        <div class="details-header">
            <img src="{url}" />
            {some text}
        </div>
        <div data-iscroll="">
        <ul data-role="listview">
            <li>
                <h2>Lorem Ipsum</h2>
                <p style="white-space:normal">Lorem ipsum dolor sit amet[..]</p>
            </li>
            <li>
                <h2>Lorem Ipsum</h2>
                <p style="white-space:normal">Lorem ipsum dolor sit amet[..]</p>
            </li>
            [...]
        </ul></div>
    </div>
</div> 
```

看来min-height是通过device-height-header-height计算出来的。有没有办法重新计算 iscroll divs 的高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T16:15:54.310

我找到了解决方案：对于元素`data-iscroll-fixed=""`外的容器来完成这项工作。`data-iscroll`

# android - carousel android 错误：在包中找不到属性“UseReflection”的资源标识符

> ID：13422110
> 
> 赞同：1
> 
> 时间：2012-11-16T18:10:03.290
> 
> 标签：android, xml, android-layout, carousel

实施轮播时，我的 xml 文件有问题。main.xml 布局显示以下错误

在此行找到多个注释：

```
- error: No resource identifier found for attribute 'UseReflection' in package 
 ''
- error: No resource identifier found for attribute 'SelectedItem' in package 
 ''
- error: No resource identifier found for attribute 'Items' in package ''

- error: No resource identifier found for attribute 'Names' in package 
 '' 
```

主要布局如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

    xmlns:pj="http://schemas.android.com/apk/res/packagename"

    xmlns:bm="package name"

    android:layout_width="fill_parent"

    android:layout_height="fill_parent"

    android:orientation="vertical"
>

     <TextView

        android:layout_width="fill_parent"

        android:layout_height="fill_parent"

        android:layout_weight="0.5"

        android:text="text"

        android:id="@+id/selected_item"

        android:background="#1E1921"

        android:textColor="#A85E4F"

        android:textStyle="normal"

        />

   <package.controls.Carousel 

         android:id="@+id/carousel"

         android:layout_width="413dp"

         android:layout_height="446dp"

         android:layout_gravity="center_horizontal"

         pj:Items="@array/entries"

         pj:Names="@array/names"

         pj:SelectedItem="0"

         pj:UseReflection="true" >

     </package.controls.Carousel>

</LinearLayout> 
```

我的值文件夹中的 attrs.xml

```
<resources>

        <declare-styleable name="Carousel">

        <attr name="android:gravity" /> 

        <attr name="android:animationDuration" />

        <attr name="UseReflection" format="boolean"/>

        <attr name="Items" format="integer"/>

        <attr name="SelectedItem" format="integer"/>

        <attr name="maxTheta" format="float"/>

        <attr name="minQuantity" format="integer"/>

        <attr name="maxQuantity" format="integer"/>

        <attr name="Names" format="string" />

    </declare-styleable>    

</resources> 
```

是日食错误还是我错过了一步。可以帮忙吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T18:23:20.800

您是否正确替换`packagename`为实际应用程序的包名称（如 com.myapp）？

```
xmlns:pj="http://schemas.android.com/apk/res/packagename" 
```

应该

```
xmlns:pj="http://schemas.android.com/apk/res/com.myapp" 
```

此外，根据 android 约定，您的属性名称应以小写字母开头。

# javascript - 如何在不重新加载页面的情况下更改地址栏中的 URL？

> ID：13422113
> 
> 赞同：6
> 
> 时间：2012-11-16T18:10:14.240
> 
> 标签：javascript, url

Shopify 如何做到这一点？转到他们的网站，单击“功能”链接，您会看到浏览器地址栏中的 URL 显示：

[http://www.shopify.com/tour/sell-online](http://www.shopify.com/tour/sell-online)

然后单击任何子链接，您会看到地址栏中的 URL 发生了变化，没有使用哈希，也没有翻页。

我认为他们没有使用 ajax 来更改内容，因为它似乎都包含在页面上的隐藏 div 中，但无论如何，您显然可以使用客户端技巧更改 URL。感谢您的帮助？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-16T18:11:37.473

您使用新的 HTML5 历史 API 来推送新状态。

这是[MDN 文档](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)和[一个很好的教程](http://diveintohtml5.info/history.html)。

请注意，这样做通常很痛苦（您必须正确管理应用程序的状态）并且[它不适用于 IE9](http://caniuse.com/#feat=history)。它几乎总是与 ajax 结合使用：即使没有重新加载或更改整个页面，它也可以让动态加载的内容成为可收藏的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T18:12:31.640

查看[pushState](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history#The_pushState%28%29.C2.A0method)，但请注意并非所有浏览器都支持它。

# objective-c - 获取 NSString 中的某些值

> ID：13422115
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:10:17.393
> 
> 标签：objective-c, nsstring

我在下面有这个 NSString。我希望能够获取每个应用程序的名称及其位置。有人可以帮助我或指出正确的方向吗？提前致谢。

```
Applications:

Xcode:

  Version: 4.5.2
  Last Modified: 11/3/12 11:45 PM
  Kind: Intel
  64-Bit (Intel): Yes
  App Store: Yes
  Location: /Applications/Xcode.app

Terminal:

  Version: 2.3
  Last Modified: 6/21/12 12:01 AM
  Kind: Intel
  64-Bit (Intel): Yes
  App Store: No
  Location: /Applications/Utilities/Terminal.app

Google Chrome:

  Version: 23.0.1271.64
  Last Modified: 10/31/12 7:59 PM
  Kind: Intel
  64-Bit (Intel): No
  App Store: No
  Location: /Applications/Google Chrome.app

App Store:

  Version: 1.2.1
  Last Modified: 4/18/12 7:52 PM
  Kind: Intel
  64-Bit (Intel): Yes
  App Store: No
  Location: /Applications/App Store.app 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:27:45.653

使用您的字符串创建 NSScanner 的实例。由于 NSScanner 的实例默认跳过空格和换行符，因此您需要在继续之前禁用此行为，如下所示：

```
[scanner setCharactersToBeSkipped:[[[NSCharacterSet alloc] init] autorelease]]; 
```

从这里，你会做这样的事情：

```
NSString *appName = nil;

[scanner scanString:@"Applications:" intoString:NULL];

NSCharacterSet *charset = [NSCharacterSet newlineCharacterSet];

[scanner scanCharactersFromSet:charset intoString:NULL];

while ([scanner isAtEnd] == NO)
{
    // Get your application name.
    [scanner scanUpToCharactersFromSet:charset intoString:&appName];
    [scanner scanCharactersFromSet:charset intoString:NULL];

    // You could do something with your application name here.

    // Skip over the other stuff.
    for (NSUInteger idx = 0; idx < 6; idx++)
    {
        [scanner scanUpToString:@":" intoString:NULL];
        [scanner scanString:@":" intoString:NULL];
        [scanner scanUpToCharactersFromSet:charset intoString:NULL];
        [scanner scanCharactersFromSet:charset intoString:NULL];
    }
} 
```

请注意，尽管出现，我并没有给你一个完整的解决方案。除了检查字符串的结尾之外，没有错误检查，不用说真正的应用程序会检查错误。（甚至应该在一开始就检查字符串结尾。）此外，这个片段依赖于数据的严格表示，例如您提供的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:22:10.463

如果有简单的分隔符，我会使用 componentsSeparatedByString。如果没有，请尝试使用带有 NSRegularExpression 的正则表达式来查找值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T20:35:37.007

有很多方法可以解决这个问题。 `NSRegularExpression`已被提及。 `NSScanner`是另一个。这是一个潜在的解决方案（不保证正确性 - 只是一个指南。）

```
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{

    @autoreleasepool {
        NSString *source = @"Applications:\n\nXcode:\n\n  Version: 4.5.\n  Last Modified: 11/3/12 11:45 PM\n  Kind: Intel\n  64-Bit (Intel): Yes\n App Store: Yes\n  Location: /Applications/Xcode.app";
        NSScanner *scanner = [NSScanner scannerWithString:source];
        [scanner scanUpToString:@":" intoString:NULL];
        [scanner scanString:@":" intoString:NULL];

        while( ![scanner isAtEnd] ) {
            NSString *appName = nil;
            NSString *appPath = nil;

            [scanner scanUpToCharactersFromSet:[NSCharacterSet alphanumericCharacterSet] intoString:NULL];
            [scanner scanCharactersFromSet:[NSCharacterSet alphanumericCharacterSet] intoString:&appName];

            NSString *junk = nil;
            [scanner scanUpToString:@"Location: " intoString:&junk];
            [scanner scanString:@"Location: " intoString:NULL];
            [scanner scanUpToString:@"\n" intoString:&appPath];
            [scanner scanString:@"\n" intoString:NULL];

            printf("app name = %s, path = %s\n",[appName UTF8String],[appPath UTF8String]);
        }

    }
    return 0;
} 
```

# html - 如何将我的网页内容堆叠成 2 列并在页面大小上保持一致

> ID：13422117
> 
> 赞同：2
> 
> 时间：2012-11-16T18:10:29.200
> 
> 标签：html, css, asp.net-mvc, razor

我需要将我的网页堆叠在两列中，这就是它现在正在做的事情：

![在此处输入图像描述](../Images/628a5aadeceadf09943bb9187e960e8e.png)

到目前为止，这是我的代码...

**这是我的 AddCustomer.cshtml：**

```
@model SuburbanCustPortal.SuburbanService.CustomerData      

@{
    ViewBag.Title = "Account Screen";
 }

<h2>AccountScreen</h2>

<div>
   <fieldset class="leftdiv">
    <legend>customer info</legend>
    <div>   
      @Html.Partial("CustomerInfoPartialView")
    </div>
  </fieldset>
  <fieldset class="rightdiv">  
    <legend>balance</legend>
    <div>
      @Html.Partial("BalancePartialView")
    </div>
  </fieldset>
</div> 
<div>
   <fieldset class="leftdiv">
    <legend>customer info</legend>
    <div>   
      @Html.Partial("DeliveryPartialView")
    </div>
  </fieldset>
  <fieldset class="rightdiv">  
    <legend>balance</legend>
    <div>
      @Html.Partial("SomeOtherPartialView")
    </div>
  </fieldset>
</div> 
```

**这是我的 BalancePartialView.cshtml：**

```
@model SuburbanCustPortal.SuburbanService.CustomerData

          <div  class="leftdiv">
            <label class="sizedCustomerlabel">Over 30:</label>
            <label class="sizedCustomerlabel">Over 60:</label>
            <label class="sizedCustomerlabel">Over 90:</label>
            <label class="sizedCustomerlabel">Over 120:</label>
            <label class="sizedCustomerlabel">Current:</label>
          </div>

          <div class="rightdiv">
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Over30)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Over60)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Over90)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Over120)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.CurrentBalance)</label>
          </div> 
```

**这是 CustomerInfoPartialView：**

```
@model SuburbanCustPortal.SuburbanService.CustomerData

          <div  class="leftdiv">
            <label class="sizedCustomerlabel">Account Number:</label>            
            <label class="sizedCustomerlabel">Name:</label>
            <label class="sizedCustomerlabel">Care of:</label>
            <label class="sizedCustomerlabel">Mailing Address:</label>
            <label class="sizedCustomerlabel">City/St/Zip:</label>
            <label class="sizedCustomerlabel">Delivery Address:</label>
            <label class="sizedCustomerlabel">Delivery City:</label>
          </div>

          <div class="rightdiv">
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Branch) - @Html.DisplayFor(model => model.AccountNumber)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Name)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.CareOf)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.Street)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.City),&nbsp;@Html.DisplayFor(model => model.State)&nbsp;&nbsp;@Html.DisplayFor(model => model.ZipCode)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.DeliveryStreet)</label>
            <label class="sizedCustomerDataLeftLabel">@Html.DisplayFor(model => model.DeliveryCity)</label>
          </div> 
```

**最后，我的CSS：**

```
.sizedCustomerlabel 
{
  display: block;
  width: 8em;
  padding: .1em;
  text-align: right;
}

.sizedCustomerDataRightlabel 
{
  display: block;
  width: 5em;
  text-align: left; 
  padding: .1em;
}

.sizedCustomerDataLeftLabel 
{
  display: block;
  width: 20em;
  text-align: left; 
  padding: .1em;
}

.SmallRedlabel 
{
  display: block;
  font-size: 10px;
  padding: .1em;
  text-align: left;
  color: blue;
}

.rightdiv {
    float: right;
    width: 45%;
    text-align:left
}
.leftdiv {
    float: left;
    width: 45%;
    text-align:left
}

.bigarealabel {
    margin:250px 50px;
} 
```

谁能告诉我如何比我正在做的更好地实现这一目标？他们的方式我会这样做是废话。我觉得我正在尝试用石头制作一个粘土碗，哈哈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:23:04.600

您可以使用[Bootstrap](http://twitter.github.com/bootstrap/index.html)，一个响应式设计的框架。无论设备如何，页面都会调整为窗口大小。

如果你想自己做，用 2`div`和 CSS`position: absolute;`和一个`left: 0px;`和另一个`right: 0px;`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:55:39.077

尝试将您更改`AddCustomer.cshtml`为此

```
@model SuburbanCustPortal.SuburbanService.CustomerData      

@{
    ViewBag.Title = "Account Screen";
}

<h2>AccountScreen</h2>

<div>
    <div class="leftdiv">
        <fieldset>
            <legend>customer info</legend>

            <div>
                @Html.Partial("CustomerInfoPartialView")
            </div>
        </fieldset>

        <fieldset>
            <legend>balance</legend>

            <div>
                @Html.Partial("BalancePartialView")
            </div>
        </fieldset>
    </div>
</div>

<div>
    <div class="rightdiv">
        <fieldset>
            <legend>customer info</legend>

            <div>
                @Html.Partial("DeliveryPartialView")
            </div>
        </fieldset>

        <fieldset>
            <legend>balance</legend>

            <div>
                @Html.Partial("SomeOtherPartialView")
            </div>
        </fieldset>
    </div>
</div> 
```

# bundle - 如何在 symfony 2.1 中注册服务

> ID：13422123
> 
> 赞同：0
> 
> 时间：2012-11-16T18:10:48.060
> 
> 标签：bundle, symfony-2.1

我正在使用 Symfony 2.1，我想添加一个新包。这个包被称为`pulse00/ffmpeg-bundle`这个包被添加到 composer.json 就像任何其他包一样：在 require 数组中添加行`"pulse00/ffmpeg-bundle": "dev-master"`

运行 php composer.phar 后，更新过程以成功结束。之后是在 appkernel.php 中注册的捆绑包。

问题始于将此捆绑包注册为服务。在这个包的自述文件中写道：

```
 dubture_f_fmpeg:
    binary: /usr/bin/ffmpeg 
```

但是 Symfony 崩溃并显示错误代码

```
 InvalidConfigurationException: Unrecognized options "binary" under "dubture_f_fmpeg" 
```

有没有人成功配置了这个捆绑包以及如何配置？还是其他捆绑包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:52:17.333

自述文件中有一个错字。正确的配置是这样的：

```
dubture_f_fmpeg:
    ffmpeg_binary: /usr/bin/ffmpeg
    ffprobe_binary: /usr/bin/ffprobe 
```

如您所见，您还必须定义`ffprobe_binary`.

[您可以在Configuration.php](https://github.com/pulse00/ffmpeg-bundle/blob/master/DependencyInjection/Configuration.php)文件中检查包的配置选项。

或者转储捆绑包的配置：

```
$ php app/console config:dump-reference DubtureFFmpegBundle

Default configuration for "DubtureFFmpegBundle"

    dubture_f_fmpeg:
        ffmpeg_binary:        ~ # Required
        ffprobe_binary:       ~ # Required 
```

# java - Thread.sleep() VS Executor.scheduleWithFixedDelay()

> ID：13422125
> 
> 赞同：27
> 
> 时间：2012-11-16T18:11:05.090
> 
> 标签：java, multithreading, thread-sleep, scheduledexecutorservice

目标：每隔一段时间执行某些代码。

问题：在性能方面，是否存在显着差异：

```
while(true) {
    execute();
    Thread.sleep(10 * 1000);
} 
```

和

```
executor.scheduleWithFixedDelay(runnableWithoutSleep, 0, 10, TimeUnit.SECONDS); 
```

?

当然，后一种选择更洁净。然而，我想知道我是否应该开始一次名为“花几天时间重构遗留代码来告别 Thread.sleep()”的冒险。

更新：此代码在超级/超级/超高负载环境中运行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-16T18:16:14.673

您正在处理以数十秒为单位的睡眠时间。通过在此处更改睡眠选项可能会节省纳秒或微秒。

我每次都更喜欢后一种风格，但如果你有前一种，而且要花很多钱来改变它，“提高性能”就不是一个特别好的理由。

*编辑回复*：8000 个线程

8000 个线程非常多；我可能会转移到预定的执行程序，以便您可以控制系统上的负载量。您关于改变唤醒时间的观点是需要注意的，尽管我认为更大的风险是所有线程都在睡觉然后连续醒来并竞争所有系统资源的踩踏事件。

我会花时间把这些都扔到一个固定的线程池调度执行器中。只有尽可能多的同时运行，因为您可以使用最有限的资源（例如，# cores 或 # IO 路径）加上一些来处理任何问题。这将以延迟为代价为您提供良好的吞吐量。

使用该`Thread.sleep()`方法将很难控制正在发生的事情，并且您可能会损失吞吐量*和*延迟。

如果您需要更详细的建议，您可能必须更详细地描述您正在尝试做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:52:51.620

由于您没有提到 Java 版本，所以情况可能会发生变化。

正如我从 Java 的源代码中回忆的那样，主要区别在于内部编写的方式。

对于**Sun Java 1.6**，如果您使用第二种方法，本机代码还会将**等待和通知**调用引入系统。因此，在某种程度上，线程效率更高且 CPU 友好。

但是你又一次失去了控制，你的代码变得更加不可预测 - 考虑你想睡 10 秒钟。

所以，如果你想要更多的可预测性——当然你可以选择选项 1。

另外，附带说明一下，在遗留系统中，当你遇到这样的事情时 - 80% 的机会现在有更好的方法来做到这一点 - 但神奇的数字是有原因的（剩下的 20%）所以，改变它个人风险 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-23T06:22:49.800

有不同的场景，

1.  Timer 创建一个不断更新的任务队列。当 Timer 完成后，它可能不会立即被垃圾回收。所以创建更多的定时器只会将更多的对象添加到堆上。Thread.sleep() 只暂停线程，因此内存开销会非常低
2.  Timer/TimerTask 也会考虑到你的任务的执行时间，所以会更准确一点。它更好地处理多线程问题（例如避免死锁等）。
3.  如果你线程得到异常并被杀死，那就是一个问题。但是 TimerTask 会处理它。无论之前运行是否失败，它都会运行
4.  TimerTask 的优势在于它更好地表达了您的意图（即代码可读性），并且它已经实现了 cancel() 功能。

参考取自[这里](https://stackoverflow.com/questions/1453295/timer-timertask-versus-thread-sleep-in-java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-28T15:41:08.737

您说您在“大型......高负载环境”中运行，所以如果我理解正确，您有许多这样的线程同时睡眠，就像您的代码示例一样。重用一个线程比杀死和创建一个新线程花费更少的 CPU 时间，并且重构可能允许您重用线程。

您可以使用大于 1的[ScheduledThreadPoolExecutor](https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)创建线程池。然后，当您在该线程池上调用[scheduleWithFixedDelay](https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/ScheduledExecutorService.html#scheduleWithFixedDelay)时，如果线程可用，它将被重用。`corePoolSize`

此更改可能会降低 CPU 利用率，因为线程正在被重用而不是销毁和创建，但减少的程度将取决于它们正在执行的任务、池中的线程数等。如果某些情况下，内存使用量也会下降的任务重叠，因为一次空闲的线程会更少。

# c# - JQuery 自动完成不会加载远程值

> ID：13422126
> 
> 赞同：3
> 
> 时间：2012-11-16T18:11:06.157
> 
> 标签：c#, jquery, autocomplete, webmethod

好的，所以 JQuery 的自动完成小部件让我发疯！
我尝试了多种加载小部件的方法。我目前得到以下信息：

> 错误：未调用 jQuery15105511000803127266_1353087819681 - parsererror

并且响应值（来自萤火虫）似乎是`System.string[]`虽然我不确定它是一个字符串，它的值是`System.string[]`还是一个实际的`system.string[]`对象。

我只是愚蠢，还是我错过了什么（请善待你对最后一个问题的回答......）？

我的 javascript 是：

```
$("#clientName").autocomplete({
    source: function (request, response) {
        $.ajax({
            url: "/supplier/apSupplierSearch/",
            data: { searchAPName: clientName.value },
            dataType: "json",
            type: "POST",
            success: function (data) {
                //response(data);
                response($.map(data, function (item) {
                    return {
                        label: item.Name,
                        value: item.Name
                    }
                }))
            }
        }); // ajax
    }, // function [{
    scroll: true,
    scrollHeight: 600,
    minLength: 4
}); 
```

我的网络方法是：

```
[WebMethod]
public string[] apSupplierSearch(string searchAPName)
{
    IList<int> selectedPropertyIDs = new List<int>();
    string currentRole = UserServices.GetCurrentRole();
    Property currentProperty = UserServices.GetCurrentPropety();
    List<ApSupplier> suppliers = ApSupplierQueries.GetApSuppliers(searchAPName, selectedPropertyIDs, currentRole, currentProperty);
    List<string> supplierList = new List<string>();
    foreach (ApSupplier supplier in suppliers)
    {
        supplierList.Add(supplier.Name);
    }
    return supplierList.ToArray();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:14:21.260

我对 C# 不太熟悉，但您可能想要打印供应商列表而不是返回它。在做 AJAX 时，您实际上必须输出数据，而不仅仅是从方法中返回它（但这可能是我对语言的误解）。

其次，您需要使用库从 toArray() 创建的数组中创建 JSON 字符串。否则，jQuery 不会将响应识别为 JSON 并且不会解析它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:12:09.273

当您指定 dataType:"jsonp" 而不是 JSON 时，您得到的错误似乎是某种跨域问题。这让我想知道为什么你会收到这个错误，因为你有 dataType:"json"。

我有一段类似的代码，对我来说似乎工作正常。我服务中的方法是“GET”类型。这里是：

```
 var availabletags=new Array();

    CallService2("GET", "ServiceUrl",
        function (data) {
            if (data) {
            $.each(data, function (index, item) {
                    availabletags.push(item);
                });
        },
        function (result) {
            alert('Service call failed: ' + result.status + '' + result.statusText);
        });

    function CallService2(method, serviceUrl, successHandler, errorHandler) {
    $.ajax({
        type: method,
        url: serviceUrl,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: successHandler,
        error: errorHandler
        });
    }

    $(function() {  
    $( "#tags" ).autocomplete({
        source: availableTags
    });
}); 
```

在页面加载之前调用此代码。让我知道它是否有帮助。一切顺利......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T23:23:43.967

够有趣的。它看起来像一个 JQuery JSONP 错误，但您使用的是 json。您确定错误与您附加的代码相对应。请参阅相关问题： [使用 jsonp 内容类型的 jQuery.ajax 请求后的 parsererror](https://stackoverflow.com/questions/5359224/parsererror-after-jquery-ajax-request-with-jsonp-content-type)

# authentication - 在 AngularJS 基本路径之外导航时，Testacular 冻结

> ID：13422127
> 
> 赞同：2
> 
> 时间：2012-11-16T18:11:12.557
> 
> 标签：authentication, angularjs, karma-runner

我有一个需要身份验证的 AngularJS 应用程序。它是 Express 提供的一个更大项目的一部分，并且存在于自己的基本路径中：`<base href="/path/to/app/">`，而不是`/`. 现有应用程序已经具有往返登录。用户需要先登录才能访问 Angular 应用程序。这很好用，除了使用 testacular 进行 e2e 测试。

禁用服务器上的身份验证后，e2e 测试可以毫无问题地运行。例如：

```
describe 'protected app', ->

  it 'should display the index', ->
    browser().navigateTo '/path/to/app'
    expect(browser().location().url()).toBe '/'

  it 'etc...' 
```

显然，使用服务器端身份验证，这将失败。我们需要先登录。我们收到以下错误：

```
Sandbox Error: Application document not accessible. 
```

当我们尝试在我们的场景中登录时，问题就出现了。

```
describe 'protected app', ->

  it 'should authenticate', ->
    browser().navigateTo '../login'
    #input('#email').enter('admin@example.com')
    #input('#password').enter('secret')
    #element('button').click()    

  it 'should display the index', ->
    browser().navigateTo '/path/to/app'
    expect(browser().location().url()).toBe '/'

  it 'etc...' 
```

运行此程序（无论是否填写表单并单击）都会导致登录页面加载并冻结。Testacular 永远不会完成它的运行，它只是挂在登录页面上。

我对 Angular/Testacular/e2e 测试的理解是否存在缺陷，或者可能是错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:58:48.283

Vojta 说这不是睾丸问题。问题是 Angular 场景运行器不支持整页重新加载。

# c# - 以另一种形式编辑 Datagridview 行项目（主从）

> ID：13422136
> 
> 赞同：0
> 
> 时间：2012-11-16T18:11:40.960
> 
> 标签：c#, data-binding

在我的 c# (VS2008) 应用程序中，我有 2 个 winform。在 Form1 中，有一个显示“员工”对象列表的 DataGridView。此 datagridview 数据绑定到 EmployeeList BindingSource。在 Form2 中，控件绑定到 Employee bindingsource。

我能够将 Form2 中的 Employee 添加到 Form1 中的 EmployeeList 中。我想要的是每当我在 datagridview 中双击时，Form2 将打开所选的员工数据。然后更新的数据将发送回 Form1 datagridview。但是 datagridview 不是从 Form2 更新的。

这样做的技术是什么。

提前致谢。SK保罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:28:35.873

如果没有任何发布的代码，我们将无法帮助解决任何特定问题，但这是您可以尝试的通用方法：

在 Form1 中

```
public void UpdateEmployee(Employee emp)
{
   //update whatever info for that employee
}

private void dataGridView1_CellClick(object sender,
    DataGridViewCellEventArgs e)
{
      DataGridViewCell selectedEmployeeCell = dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex]; //Get whatever data you're sending from this to the new form

      Employee tempEmployee = getEmployee(selectedEmployeeCell);

      Form2 updateEmp = new Form2(tempEmployee, this);
      updateEmp.showDialog();
} 
```

在 Form2 中

```
 public Form2(Employee emp, Form1 parent)
    {
        //blah blah blah
    }

 private void UpdateEmployee(Employee emp)
{
    parent.UpdateEmployee(emp);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:59:35.513

我尽量避免使用带有网格视图的向导数据源。我会手动对网格进行编码，然后使用第一个网格的编辑行中的按钮将 url 中的变量传递给第二个网格。或者在您的情况下，可能是第一个网格的选定行事件。

# javascript - PhoneGap 2.2：新桥如何工作？

> ID：13422138
> 
> 赞同：1
> 
> 时间：2012-11-16T18:11:47.890
> 
> 标签：javascript, cordova, webgl, phonegap-plugins

今年早些时候，我编写了一个名为[WebGLGap](https://github.com/AshleyScirra/WebGLGap)的实验性 PhoneGap 插件。理论上，它可以通过将所有 JS 调用转发到插件代码来在 PhoneGap 应用程序中启用 WebGL 支持。不幸的是，我放弃了它，因为 Javascript 和插件之间的桥梁是一个巨大的瓶颈：所有内容（包括顶点数据）都被字符串化为一个巨大的字符串，传递给插件，然后解析回 JSON 以供本机插件代码读取。显然，这使它变得毫无用处。

但是我正在阅读 PhoneGap 2.2 有一个新的桥，它可以快 10 倍以上。它是如何工作的？它是否避免了字符串化？如果网桥足够高效，那么重新审视 WebGLGap 可能是值得的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T22:02:17.820

它仍然是所有字符串。不同之处在于现在的默认值是 XHR_WITH_PAYLOAD，它使用 XMLHttpRequest 在标头中带有参数，而不是 XHR_NO_PAYLOAD，它使用 XHR 触发读取队列，或 IFRAME_NAV，这是可用的更快方法之一，但与触摸滚动冲突iOS 5 由于一个 safari 错误。

在修复了处理快速请求的错误 ( [https://issues.apache.org/jira/browse/CB-1404](https://issues.apache.org/jira/browse/CB-1404) ) 后，XHR_WITH_PAYLOAD 在 2.2 中被设置为默认值。但是，如果网桥仍然很忙，修复会回退到稍微慢一点的方法，因此虽然性能对于正常使用来说更好，但它不是您想要放在主渲染循环中的东西。

对于这样的不寻常的要求，自定义桥可能更有意义 - 还有其他可用的方法（例如 XHR 与请求和响应的正文内容）对于传输大量数据会更好，但不会真正起作用像标准桥梁这样的通用解决方案。

# wpf - 使用交互触发器时获取 EventArgs

> ID：13422146
> 
> 赞同：3
> 
> 时间：2012-11-16T18:12:23.050
> 
> 标签：wpf, xaml, mousewheel, interaction, eventtrigger

我正在使用这种方式从 XAML 中捕获事件：

```
<i:Interaction.Triggers>
    <i:EventTrigger EventName="MouseWheel">
        <ei:CallMethodAction MethodName="ChangeValue" TargetObject="{Binding DataContext}" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

这种方式效果很好，我可以`ChangeValue`在我的代码中触发我的函数。但我想知道我的`ChangeValue`功能上的鼠标滚轮方向（向上或向下）。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:29:54.700

您可以使用[MVVM Light](http://mvvmlight.codeplex.com/)，[`EventToCommand`](http://mvvmlight.codeplex.com/SourceControl/changeset/view/b922e8ccf674#GalaSoft.MvvmLight%2fGalaSoft.MvvmLight.Extras%20%28NET4%29%2fCommand%2fEventToCommandVS10.cs)它也有一个`PassEventArgsToCommand`属性。然后，代替方法，定义一个接收事件 args 作为参数的命令。您的 XAML 应如下所示：

```
<i:Interaction.Triggers>
    <i:EventTrigger EventName="MouseWheel">
        <cmd:EventToCommand Command="{Binding ChangeValueCommand}"
                            PassEventArgsToCommand="True" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:25:27.360

我使用了这里描述的技术：

[http://blog.roboblob.com/2010/01/26/binding-ui-events-from-view-to-commands-in-viewmodel-in-silverlight-4/](http://blog.roboblob.com/2010/01/26/binding-ui-events-from-view-to-commands-in-viewmodel-in-silverlight-4/)

那里的博文非常清晰且易于理解，特别是如果您已经有一些 WPF/Silverlight 经验。我在实现这个版本的 Event->Command 模式时没有遇到任何问题。

此功能也可“内置”到诸如 MVVMLight 之类的框架中。

本质上，您为要使用的每个事件创建一个命令 (ICommand)。

# mysql - 从 Java Servlet 将 MySQL 查询结果打印到 JSP

> ID：13422151
> 
> 赞同：1
> 
> 时间：2012-11-16T18:12:33.283
> 
> 标签：mysql, jsp, servlets, output

现在我面临这个脚本的以下两个问题。

1）当我运行类似的命令`SELECT * FROM table;`时，它只返回列名。当我运行类似的命令时`SELECT columnName FROM table;`，它会完美地显示输出。什么可能导致此错误？

2) 当我运行`INSERT`or`DELETE`命令时，我收到反馈消息说数据库已更新，但是在检查数据库时，没有进行任何更改。任何人都可以在我的源代码中看到该子句有什么问题吗？

下面分别是我的 .java 和 .jsp 文件：

数据库Servlet.java

```
import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;
import java.sql.*;
import java.util.ArrayList;

@SuppressWarnings("serial")

public class databaseServlet extends HttpServlet {
    private Connection conn;
    private Statement statement;

    public void init(ServletConfig config) throws ServletException {
        try {
            Class.forName(config.getInitParameter("databaseDriver"));
            conn = DriverManager.getConnection(
                    config.getInitParameter("databaseName"),
                    config.getInitParameter("username"),
                    config.getInitParameter("password"));
            statement = conn.createStatement();
        }
        catch (Exception e) {
            e.printStackTrace();
        }
    }

    protected void doPost (HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ArrayList<String[]> out = new ArrayList<String[]>();
        ArrayList<String> columns = new ArrayList<String>();

        String query = request.getParameter("query");

        if (query.toString().toLowerCase().contains("select")) {
            //SELECT Queries
            try {
                ResultSet resultSet = statement.executeQuery(query.toString());
                ResultSetMetaData metaData = resultSet.getMetaData();
                int numberOfColumns = metaData.getColumnCount();
                for(int i = 1; i<= numberOfColumns; i++){
                    columns.add(metaData.getColumnName(i));
                }

                while (resultSet.next()){
                    String[] row = new String[numberOfColumns];
                    for (int i = 0; i < numberOfColumns; i++){
                        row[i] = (String) resultSet.getObject(i+1);
                    }
                    out.add(row);
                 }
            }
            catch (Exception f) {
                f.printStackTrace();
            }
        }
        else if (query.toString().toLowerCase().contains("delete") || query.toString().toLowerCase().contains("insert")) {
            //DELETE and INSERT commands
            try {
                conn.prepareStatement(query.toString()).executeUpdate(query.toString());
                columns.add("\t\t Database has been updated!");
            }
            catch (Exception l){
                l.printStackTrace();
            }
        }
        else {
            //Not a valid response
            columns.add("\t\t Not a valid command or query!");
        }
        request.setAttribute("query", query);
        request.setAttribute("resultSize",  out.size());
        request.setAttribute("queryResults", out);
        request.setAttribute("queryColumns", columns);
        RequestDispatcher dispatcher = request.getRequestDispatcher("/dbServlet.jsp");
        dispatcher.forward(request,  response);
    }
} 
```

dbServlet.jsp

```
<?xml version = "1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<!-- dbServlet.html -->
<html xmlns = "http://www.w3.org/1999/xhtml">
<%@ page import="java.util.ArrayList" %>
<head>
    <title>MySQL Servlet</title>
    <style type="text/css">
        table{border: 1px solid #FFF;}
        td{border: 1px dashed #FFF; padding: 3px; background-color: #5A5F64;}
        body{background-color: #182229; text-align: center; color: #FFF;}
        h1{font-family:"Arial", sans-serif, Helvetica;}
    </style>
</head>
<body>
    <h1>MySQL Servlet User-Interface</h1>
    <div style="width:500px; margin-right:auto; margin-left: auto; background-color:#131B21; padding: 20px;">
        <h3>Enter an SQL Command!</h3>
        <form action = "/database/database" method = "post">
        <p>
            <textarea name = "query" cols="28" rows="5"></textarea>
        </p>
        <p>
            <input type = "submit" value = "Run MySQL Servlet" />
            <input type = "reset" value = "Clear Command" />
        </p>
        </form>
        <hr>
        <TABLE id="results" align="center">
            <%
                ArrayList<String> columns = (ArrayList<String>)request.getAttribute("queryColumns");
                ArrayList<String[]> results = (ArrayList<String[]>)request.getAttribute("queryResults"); 
                out.println("<TR align='left'>");
                if(columns != null && !columns.isEmpty()){
                    for(String columnName: columns ){
                       out.println("<TD>"+columnName+"</TD>");
                    }
                }
                out.println("</TR>");
                //print data
                if(results != null && !results.isEmpty()){
                    for(String[] rowData: results){
                       out.println("<TR align='left'>");
                       for(String data: rowData){
                          out.println("<TD>"+data+"</TD>");
                       }
                       out.println("</TR>");
                    }
                }
            %>
        </TABLE>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T09:26:10.317

调用`select *`查询时，您是否检查过任何抛出的异常。`row[i] = (String) resultSet.getObject(i+1);`如果返回的对象不是字符串类型，则此行可能会导致 classCastExceptions。您的*numworkers*列对我来说似乎是一个整数。

# pex - 我可以将 PEX 与 Visual Studio 2012 一起使用吗？

> ID：13422153
> 
> 赞同：5
> 
> 时间：2012-11-16T18:12:42.820
> 
> 标签：pex

我没有看到任何有关使 Pex 在 Visual Studio 2012 上工作的计划的当前信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T23:59:58.390

我试图联系微软，但没有得到答复。所以我决定给 Mary Jo Foley 发电子邮件，她收到了以下信息：

> 这是您在 Visual Studio 上的 MS 发言人的回答：
> 
> “<em>我们希望在 2013 年初的某个时候更新与 Visual Studio 2012/.NET 4.5 兼容的 Pex。首先是学术许可，然后是商业许可。”</p>

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-11T02:53:06.693

Visual Studio 2012 便携式库的新 Pex 扩展名为 Code Digger。目前 Code Digger 仅适用于可移植类库，并且不会像原始 PEX 那样自动创建单元测试项目。PEX 团队表示他们将发布新版本，增加功能并使其在 Portable Subset 之外工作，尽管没有时间表。

[http://blogs.msdn.com/b/nikolait/archive/2013/04/23/introducing-code-digger-an-extension-for-vs2012.aspx](http://blogs.msdn.com/b/nikolait/archive/2013/04/23/introducing-code-digger-an-extension-for-vs2012.aspx)

摘自博客：

“在后台，Code Digger 使用 Pex 引擎和 Microsoft Research 的 Z3 约束求解器系统地分析代码中的所有分支，试图生成一个实现高代码覆盖率的测试套件。与 Visual Studio 产品组的 Peter Provost 合作，我们尝试创建一个非常简单的用户界面。我们希望将代码探索的想法带到每个程序员的指尖。这与 Pex Power Tools 不同，我们为您提供了许多配置选项，您必须接受 (参数化）单元测试以获得所有好处。Code Digger 并不是 Pex 的完全替代品，它只是 Pex 团队为 Visual Studio 2012 提供的第一个扩展 - 请继续关注更多信息。”

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-04T13:16:10.897

Pex 和 Moles 在 Visual Studio Ultimate 和最近的 Visual Studio Premium 中以假货的形式提供，遗憾的是在其他 VS 版本中没有。我们总能抱有希望。

# javascript - 你如何把jsfiddle放在你的html上

> ID：13422154
> 
> 赞同：-6
> 
> 时间：2012-11-16T18:12:45.173
> 
> 标签：javascript, jquery

这可能是有史以来最厚的问题！但是我怎样才能让它在我的 html 上工作呢？

HTML

```
<div class="test2"></div>

<div class="test"></div>

<div class="test3"></div> 
```

CSS

```
.test2 {margin-top: 250px;
       position:absolute;
       left: -100px;
       width:100px;
       height:100px;
       background: aqua;
}

.test {margin-top: 500px;
       position:absolute;
       right: -100px;
       width:100px;
       height:100px;
       background: aqua;
}

.test3 {margin-top: 1000px;
       position:absolute;
       right: 100px;
       width:100px;
       height:100px;
       background: aqua;
} ​​ 
```

JS

```
var $test2 = $(".test2");
$(window).scroll(function() {
    if ($(this).scrollTop() > 20) {
        $test2.stop().animate({
            left: "200px"
        }, 200);
    }
});    

var $test = $(".test");
$(window).scroll(function() {
    if ($(this).scrollTop() > 100) {
        $test.stop().animate({
            right: "200px"
        }, 400);
    }
});​ 
```

[http://jsfiddle.net/maxmitch/UgEu6/](http://jsfiddle.net/maxmitch/UgEu6/)（完整示例）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:20:53.410

获得 jsFiddle 的单页工作版本的一种简单方法是使用他们的“共享全屏结果”链接，例如 jsfiddle.net/maxmitch/UgEu6/embedded/result/。

然后您需要做的就是右键单击主框架并复制源代码。请注意，如果您使用 jsFiddle 的“规范化 css”选项，则必须调整您看到的 CSS 文件的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:18:34.467

“在你的 html 上？” 我......它在“你的html”上不起作用。你有3个文件。一个 javascript 文件、一个 CSS 文件和您的 HTML 文件。

在左边，你会看到它在`onDomReady`事件中使用了 jQuery 1.7.2 库，如果我记得是

```
$(document).ready(function(){
    // code to execute
}) 
```

您需要为每个文件创建 3 个单独的文件。您需要知道如何将 CSS 和 Javascript 文件放入您的 HTML 文档中。如果您不知道，请谷歌它。

# c# - 我应该使用哪种形式的线程来提高递归效率？

> ID：13422156
> 
> 赞同：0
> 
> 时间：2012-11-16T18:12:52.000
> 
> 标签：c#, multithreading, user-interface, recursion

我有两个一个接一个的递归方法，每个都为每个节点生成数据到任意大小的树。*（我不能将两者结合起来，因为第二个取决于第一个的结果 - 而且，第一次迭代是从叶到根，第二次是从根到叶。）*我需要为每个节点添加/位置更新生成数据。每次树状态更新时，我都需要将树绘制到缓存的位图上。

我目前正在为此使用 BackgroundWorker，但是当用户添加大量节点时，事情开始滞后，就好像任务在与 UI 相同的线程上工作一样。（这是我第一次使用 BackgroundWorker 但一般不用于处理线程）

我曾经遇到过马特的帖子：[BackgroundWorker vs background Thread](https://stackoverflow.com/a/1507337/1416320) 我应该改回 System.Thread 还是他们可能是另一种选择？当进程完成时，我需要将结果树和一个整数值存储在主线程上。

```
[Threading]
private void Commence()
{
    if (worker.IsBusy)
    {
        try
        {
            // I was thinking of fixing this with a timer instead
            worker.CancelAsync();
            while (worker.IsBusy) Thread.Sleep(10);
        }
        catch { return; }
    }
    worker.RunWorkerAsync();
}
void worker_DoWork(object sender, DoWorkEventArgs e)
{
    // int radMax; TreeNodeEx rTNH;
    // Call the two recursive methods
    radMax = GenerateDataFromNodes(rTNH, radMax);
    UpdateRenderRegion(); // draw result to cached bitmap
}
void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    // draw bitmap to screen
    if (!e.Cancelled) Invalidate();
}

[Algorithm]
private int GenerateDataFromNodes(TreeNodeEx hierarchy, int max)
{
    // set hierarchy values
    max = GenerateScaleAndRadius(hierarchy, max);
    GenerateStartAndSweep(hierarchy);

    return max;
}
private int GenerateScaleAndRadius(TreeNodeEx hierarchy, int max, int radius = 2)
{
    for (int i = 0; i < hierarchy.Nodes.Count; i++)
    {
        max = GenerateScaleAndRadius((TreeNodeEx)hierarchy.Nodes[i], max, radius+1);
    }
    // generation a
    return max;
}
private void GenerateStartAndSweep(TreeNodeEx hierarchy)
{
    for (int i = 0; i < hierarchy.Nodes.Count; i++)
    {
        // generation b-1
    }
}
private void node_SweepAngleChagned(object sender, EventArgs e)
{
    for (int i = 0; i < ((TreeNode)sender).Nodes.Count; i++)
    {
        // generation b-2
    }
}

[Invalidation]
private void UpdateRenderRegion()
{
    if (rTNH != null)
    {
        renderArea = new Bitmap(radMax * rScale * 2, radMax * rScale * 2);
        Graphics gfx = Graphics.FromImage(renderArea);

        gfx.SmoothingMode = SmoothingMode.AntiAlias;
        // pens, graphicspaths, and pathgradients

        // draw parent first

        // draw generations next using the same structure as the parent
        DrawNodes(gfx, p, rTNH, rScale, w, h);

        gfx.Dispose();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:37:41.210

我想这是您的代码的问题。如果您按照您的建议有一棵大树，并且您的递归过程很长，那么当您再次调用`Commence()`方法时，它将等待并执行`Thread.Sleep(10)`；产生 UI 无响应。像这样重写你的代码，如果`BackgroundWorker`被取消，它应该调用事件处理程序中的`Commence()`方法，`RunWorkerCompleted`而不是等待工作人员完成。检查代码：

```
private void Commence()
{
      if (worker.IsBusy)
      {
           worker.CancelAsync();
      }
      else
      {
           worker.RunWorkerAsync();
      }
}

void worker_DoWork(object sender, DoWorkEventArgs e)
{
      BackgroundWorker bgw = (BackgroundWorker)sender;
      if (bgw.CancellationPending)
      {
            e.Cancel = true;
            return;
      }
      else
      {
            radMax = GenerateDataFromNodes(rTNH, radMax);
            if (bgw.CancellationPending)
            {
                  e.Cancel = true;
                  return;
            }
            UpdateRenderRegion(); // draw result to cached bitmap
      }
}
void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
      if (!e.Cancelled)
           Invalidate();
      else
           Commence();
} 
```

作为旁注，请注意不要在发生 Invalidate 时（无论出于何种原因）同时访问 backBuffer（您正在使用的位图）。我不知道您是否已经处理了从不同线程对该位图的访问，但请记住这一点。

# java - 方法不适用于参数，但不知道为什么

> ID：13422160
> 
> 赞同：0
> 
> 时间：2012-11-16T18:13:03.977
> 
> 标签：java, methods, parameters

我有以下方法，它将类列表作为参数：

```
public List<Interface> getInterfacesOfTypes(List<Class<? extends InternalRadio>> types) {
    List<Interface> interfaces = new ArrayList<Interface>();

    for(Interface iface : _nodes)
        if(types.contains(iface._type))
            interfaces.add(iface);

    return interfaces;
} 
```

我想要做的是为它创建一个包装器，其中只指定了一个类，它调用上面的方法，只列出一个类：

```
public List<Interface> getInterfacesOfType(Class<? extends InternalRadio> type) {       
    return getInterfacesOfTypes(Arrays.asList(type));
} 
```

但是，我收到一个错误：

```
The method getInterfacesOfTypes(List<Class<? extends InternalRadio>>) in the type InterfaceConnectivityGraph is not applicable for the arguments (List<Class<capture#3-of ? extends InternalRadio>>) 
```

我不知道为什么会这样，也不知道这`capture #3-of`意味着什么。我将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:31:18.347

**解决方案**

将界面更改为以下内容：

```
public List<Interface> getInterfacesOfTypes(List<? extends Class<? extends InternalRadio>> types) 
```

老实说，我无法真正解释为什么。扩大允许的泛型集合的范围（通过添加“？扩展”）只是让编译器更容易看到这是有效的......

**在旁边**

*   而不是`Arrays.asList(type)`我会写`Collections.singletonList(type)`.
*   在 Java 中使用 '_' 前缀类成员并不常见
*   我认为`Interface`这不是一个好名字，因为“接口”也是一个 Java 概念（而且似乎`Interface`不是这样的接口 :)）
*   我可能会在 Interface 上使用 'getType()' 函数，而不是直接引用它的 '_type' 字段 - 这使得以后更容易重构。
*   您可能可以接受任何`Collection`而不是要求`List`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:34:55.873

如果您确定您的对象类型：

```
public List<Interface> getInterfacesOfType(final Class<? extends InternalRadio> type)
    {
        final List list = Arrays.asList(type);
        @SuppressWarnings("unchecked")
        final List<Class<? extends Interface>> adapters = list;

        return getInterfacesOfTypes(adapters);
    } 
```

# c++ - QThread：如何使用受保护的静态函数

> ID：13422162
> 
> 赞同：1
> 
> 时间：2012-11-16T18:13:19.710
> 
> 标签：c++, multithreading, qt, qthread

我从以下链接中了解到，对 QThread 进行子类化不是使用它的正确方法......正确的方法是对 QObject 进行子类化，然后使用 moveToThread() 函数将 QObject 类的对象移动到相应的线程......我点击了以下链接.. [链接 1](http://qt-project.org/doc/note_revisions/5/177/view)和[链接 2](http://mayaposch.wordpress.com/2011/11/01/how-to-really-truly-use-qthreads-the-full-explanation/) ...但我的问题是我将如何使用 msleep() 和 usleep() 受保护的静态函数？还是我会使用 QTimer 让线程等待一段时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T21:53:35.780

不需要计时器。对于等待，Qt 提供了 QWaitCondition。你可以实现这样的事情：

```
#include <QWaitCondition>
#include <QMutex>

void threadSleep(unsigned long ms)
{
    QMutex mutex;
    mutex.lock();
    QWaitCondition waitCond;
    waitCond.wait(&mutex, ms); 
    mutex.unlock();
} 
```

这是一个正常的功能。如果需要，您当然也可以将其实现为成员函数（`static`在这种情况下，它可以是成员。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:39:02.953

一种解决方案是创建一个计时器：

```
class Worker: public QObject
{
///...

private slots:
void doWork()
{
    //...
    QTimer::singleShot(delay, this, SLOT(continueDoingWork()));
}

void continueDoingWork()
{
}
}; 
```

有时，您只需要在不同的线程中运行一个操作，所有这些事件循环和线程都是开销。然后你可以使用[`QtConcurent`](http://doc.qt.digia.com/qt/threads-qtconcurrent.html)框架：

```
class Worker
{
public:
void doWork()
{
//...
}
} worker;

//...

QtConcurent::run(worker, &Worker::doWork); 
```

然后，我通常使用互斥锁来模拟睡眠操作：

```
QMutex m;
m.lock();
m.tryLock(delay); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T18:40:53.800

规范的答案是“使用信号和槽”。

例如，如果您希望线程中的 QObject 在一段时间后“唤醒自己”，请考虑[QTimer::singleShot()](http://qt-project.org/doc/qt-4.8/qtimer.html#singleShot)，将插槽作为第三个参数传递。这可以从有问题的插槽中调用，从而导致定期执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T18:47:59.907

如果没有这个线程的合作，你不能让不同的线程休眠，这就是成员函数`QThread`受到保护的原因。如果你想休眠一个不同的线程，你需要在里面使用一个条件变量或一个计时器

如果你想用 睡眠当前线程`usleep()`，最简单的方法是对其进行子类化 - 只要你不需要`QThreadPool`线程本地事件循环或类似的，它就很好。

# java - Android 使用带有 HttpPost 和 URLconnection 的 cookie

> ID：13422164
> 
> 赞同：0
> 
> 时间：2012-11-16T18:13:25.707
> 
> 标签：java, android, http, cookies

我正在将 web 应用程序移植到 android，我有一个问题。我正在从 PHP 脚本下载验证码图像，并且我想检索 cookie：

```
 Bitmap mIcon11 = null;
          try {
              java.net.URL url = new java.net.URL(urldisplay);

              HttpURLConnection connection = (HttpURLConnection) url.openConnection();
              connection.setUseCaches(true);
              connection.connect();
            InputStream in = connection.getInputStream();
            mIcon11 = BitmapFactory.decodeStream(in);

          } catch (Exception e) {
              Log.d("Error", "NEINA SIUSTI IMAGO");
              e.printStackTrace();
          } 
```

并在此处使用相同的 cookie 进行验证：

```
DefaultHttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://somesite.lt/index.php");

try {
    // Add your data
    List < NameValuePair > nameValuePairs = new ArrayList < NameValuePair > (2);
    nameValuePairs.add(new BasicNameValuePair("phoneno", ((EditText) findViewById(R.id.number)).getText().toString()));
    nameValuePairs.add(new BasicNameValuePair("phbody", ((EditText) findViewById(R.id.sms)).getText().toString()));
    nameValuePairs.add(new BasicNameValuePair("captcha_code", ((EditText) findViewById(R.id.code)).getText().toString()));
    nameValuePairs.add(new BasicNameValuePair("agree", "on"));
    nameValuePairs.add(new BasicNameValuePair("submit", ""));
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    Log.d("ers", "ENtit  " + nameValuePairs.toString());
    // Execute HTTP Post Request

    HttpResponse response = httpclient.execute(httppost, mHttpContext); 
```

我该怎么做？从 URLConnection 检索 cookie 并在该 HTTPPost 请求中使用它们。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T09:58:22.790

耶！找到了解决方案。我在验证码中得到：

```
String urldisplay = urls[0];
              Bitmap mIcon11 = null;
              try {
                  java.net.URL url = new java.net.URL(urldisplay);

                  HttpURLConnection connection = (HttpURLConnection) url.openConnection();
                  connection.setUseCaches(true);

                  connection.connect();
                  String cookie = connection.getHeaderField("Set-Cookie");

                  cookie = cookie.substring(0, cookie.indexOf(';'));

                  mSes = cookie;
                InputStream in = connection.getInputStream();
                mIcon11 = BitmapFactory.decodeStream(in); 
```

在页面验证中：

```
DefaultHttpClient httpclient = new DefaultHttpClient();

                                HttpPost httppost = new HttpPost("http://somesite.lt/index.php");
                                httppost.addHeader("Cookie", mSes);
                                try {
                                    // Add your data
                                    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
                                    nameValuePairs.add(new BasicNameValuePair("phoneno", ((EditText)findViewById(R.id.number)).getText().toString()));
                                    nameValuePairs.add(new BasicNameValuePair("phbody", ((EditText)findViewById(R.id.sms)).getText().toString()));
                                    nameValuePairs.add(new BasicNameValuePair("captcha_code", ((EditText)findViewById(R.id.code)).getText().toString()));
                                    nameValuePairs.add(new BasicNameValuePair("agree", "on"));
                                    nameValuePairs.add(new BasicNameValuePair("submit", ""));
                                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                                    Log.d("ers","ENtit  "+nameValuePairs.toString());
                                    // Execute HTTP Post Request

                                    HttpResponse response = httpclient.execute(httppost, mHttpContext); 
```

# gwt - 网站的 gwt 博客小部件

> ID：13422177
> 
> 赞同：1
> 
> 时间：2012-11-16T18:14:33.717
> 
> 标签：gwt

只是想知道是否有人知道 gwt 中可以插入网站的“博客小部件”。用例如下：

--> 管理员可以自己管理一个带有图片/富文本的博客

--> 最终用户会在网站的侧边栏上看到博客

谢谢，

雨果

# c++ - Visual Studio 2012 - 缺少所需的文件“tracker.exe”

> ID：13422178
> 
> 赞同：10
> 
> 时间：2012-11-16T18:14:39.370
> 
> 标签：c++, visual-studio, cryengine

我尝试编译[cryengine 3](http://www.crydev.net/)的源代码，但总是收到以下错误消息。

```
Error   1   error : Required file "tracker.exe" is missing. C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V110\Microsoft.CppCommon.targets  251 6   CryGame 
```

由于某种原因，我在谷歌上找不到任何信息。

我的 Visual Studio 安装有可能以某种方式损坏吗？我仍在使用候选版本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T18:33:02.640

MS网站上关于tracker.exe的引用：

> 在某些情况下，需要 Tracker.exe 正确增量生成资源，例如在使用 32 位 MSBuild 在 64 位操作系统上构建时。此版本需要 Tracker.exe，但无法找到。该任务正在注册表项 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v7.0A 的 InstallationFolder 值下查找 Tracker.exe。

可能的解决方案：

*   安装 Microsoft Windows SDK v7.0A 或更高版本。
*   手动将上述注册表项设置到正确的位置。
*   您可以通过将 ResGenTrackerSdkPath 属性设置为 7.1 .NET 4.0 工具位置来缩短该查找。在构建定义中，在“MSbuild Arguments”下，您可以添加以下内容：

*/p:ResGenTrackerSdkPath=":\Program Files(x86)\Microsoft SDKs\Windows\v7.1\Bin\NETFX 4.0 工具*

编辑：您的路径可能会有所不同，但这仍然显示了添加的一般路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-13T08:12:21.007

你可以去目录`"C:\Program Files (x86)\Microsoft SDKs\Windows"`。

然后，您搜索密钥“tracker.exe”，如果找不到，则可能以某种方式将其删除。

最好的方法是：

复制文件夹`"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\NETFX 4.0 Tools"`

到您的 PC 在同一目录中。如果不行，可以把文件夹复制进去[下图]每一个。

图片：
[![图片](../Images/c18393446ff15b26bab5fcf3c6d34834.png)](https://i.stack.imgur.com/pgEDL.png)

# log4net - RollingFileAppender - 每年滚动？

> ID：13422181
> 
> 赞同：0
> 
> 时间：2012-11-16T18:14:53.363
> 
> 标签：log4net, rollingfileappender

是否可以将 RollingFileAppender 设置为每年滚动而不是每月滚动？没有足够的条目每月需要一个文件，所以我想每年设置一次，但是当我设置`datePattern = "yyyy"`log4net 时说它无法解析（无效的滚动点）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T11:15:20.220

不。

RollingFileAppender.RollPoint.TopOfMonth 是最大的值。

请参阅[http://logging.apache.org/log4net/release/sdk/log4net.Appender.RollingFileAppender.RollPoint.html](http://logging.apache.org/log4net/release/sdk/log4net.Appender.RollingFileAppender.RollPoint.html)以供参考。

# c++ - 如何使用 QCloseEvent 退出程序？

> ID：13422182
> 
> 赞同：4
> 
> 时间：2012-11-16T18:15:07.403
> 
> 标签：c++, qt

我已经覆盖了登录对话框的 .h 文件中的 closeEvent 函数，以便它在发出时退出程序：

```
 void closeEvent(QCloseEvent *event){exit(0)} 
```

但是，对于我单击的对话框中的任何按钮，它似乎都会退出程序。如何仅在单击右上角的“x”按钮时退出？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T21:36:12.050

当对话框想要关闭时调用 closeEvent()。显然，如果您单击对话框的“确定”或“取消”按钮，则它要关闭。这个是正常的。

此外，传递给 closeEvent() 的事件应该被接受或忽略。您不应该只 exit() 应用程序。例如：

```
void closeEvent(QCloseEvent *event)
{
    if (The dialog should close)
        event->accept();
    else
        event->ignore(); // Don't close.
} 
```

窗口为什么要关闭并不重要。用户是否单击了窗口框架中的“确定”、“取消”或“X”按钮。你说不出来。关闭事件就是这样；窗户想要关闭。

如果对话框是最后一个打开的窗口，那么 QApplication::exec() 将返回并且您的程序将正常关闭。

# groovy - 如何使用 groovy 的 AS 关键字

> ID：13422183
> 
> 赞同：6
> 
> 时间：2012-11-16T18:15:11.053
> 
> 标签：groovy, as-keyword

这可能是重复的，但“as”对谷歌来说是一个令人难以置信的硬关键字，即使 SO 忽略“as”作为查询的一部分。

所以我想知道如何实现一个自反地支持“as”的类。对于示例类：

```
X类{
    私人价值
    公共 X(def v) {
        val=v
    }
    公共asType（C类）{
        if (c == Integer.class)
            将 val 作为整数返回
        如果（c == String.class）
            将 val 作为字符串返回
    }
}

```

这允许类似：

```
new X(3) as String 
```

工作，但无助于：

```
3 as X 
```

我可能必须以某种方式附加/修改 String 和 Integer 上的“asType”，但我觉得这样的任何更改都应该仅限于“X”类...... X 类是否可以实现如下方法：

```
X fromObject(object) 
```

或者以某种方式从 X 中修改 String/Integer 类。这似乎很难，因为在实际使用 X 之前它不会在 X 中执行任何代码......如果我第一次使用 X 是“3 as X”，X 会得到在 Groovy 尝试调用之前覆盖 Integer 的 asType 的机会是？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T20:01:40.200

`asType`正如你所说，改变Integer 接受`X`作为一种新型转换的方法并不容易（尤其是在不破坏现有功能的情况下）。

我能想到的最好的办法是：

```
Integer.metaClass.toX = { -> new X( delegate ) } 
```

然后你可以打电话：

```
3.toX() 
```

我想不出怎么`3 as X`做——正如你所说，反过来；`new X('3') as Integer` 相对容易。

* * *

实际上，您可以这样做：

```
// Get a handle on the old `asType` method for Integer
def oldAsType = Integer.metaClass.getMetaMethod( "asType", [Class] as Class[] )

// Then write our own
Integer.metaClass.asType = { Class c ->
  if( c == X ) {
    new X( delegate )
  }
  else {
    // if it's not an X, call the original
    oldAsType.invoke( delegate, c )
  }
}

3 as X 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T20:33:18.793

这使功能不受 Integer 类型的影响，并最大限度地减少了效果的范围（取决于您要查找的内容，这是好是坏）。

此类别将从 Integer 端应用 asType。

```
class IntegerCategory {
    static Object asType(Integer inty, Class c) {
        if(c == X) return new X(inty)
        else return inty.asType(c)
    }
}

use (IntegerCategory) { 
    (3 as X) instanceof X
} 
```

# python - 在 Python 中同时启动两个方法

> ID：13422186
> 
> 赞同：5
> 
> 时间：2012-11-16T18:15:24.213
> 
> 标签：python, parallel-processing

我试图在 Python 中同时运行两种方法。其中一个播放声音，另一个录制声音。两种方法都可以正常工作，但我无法弄清楚如何在尝试多处理和线程的同时启动它们。而我现在几乎可以肯定它不能用线程来解决。

```
def listen_to_audio()

def play_audio() 
```

有任何想法吗？（它们不必同时完成，但它们都应该在一秒钟内开始。）

那是代码，很抱歉没有在开头发布它：

```
import pyaudio
import wave
import sys
import time
from math import *
from getopt import *
import threading

def make_sin(f0=1000.,ampl=30000,rate=22050,length=5.):
  a = 2\. * pi * f0/rate              
  n = int(rate * length)
  wav=''
  for i in range(0, n):
    f = int(ampl*sin(a*i))
    wav += chr(f & 0xFF) + chr((f & 0xFF00) >> 8)
  return wav

def play_audio(forHowLong):
    data = make_sin(f0=1000.,ampl=30000,rate=22050,length=5.)

    p = pyaudio.PyAudio() #sets up portaudio system
    stream = p.open(format=p.get_format_from_width(2),
                channels=1,
                rate=22050,
                output=True)

    start = time.time()
    while time.time() < start + forHowLong*0.5:    
            stream.write(data)

    stream.stop_stream()
    stream.close()
    p.terminate()

def listen_to_audio(forHowLong):
    CHUNK = 1024
    FORMAT = pyaudio.paInt16
    CHANNELS = 2
    RATE = 44100
    RECORD_SECONDS = forHowLong
    WAVE_OUTPUT_FILENAME = "output.wav"

    p = pyaudio.PyAudio()

    stream = p.open(format=FORMAT,
            channels=CHANNELS,
            rate=RATE,
            input=True,
            frames_per_buffer=CHUNK)

    print("* recording")

    frames = []

    for i in range(0, int(RATE / CHUNK * RECORD_SECONDS)):
        data = stream.read(CHUNK)
        frames.append(data)

    print("* done recording")

    stream.stop_stream()
    stream.close()
    p.terminate()

    wf = wave.open(WAVE_OUTPUT_FILENAME, 'wb')
    wf.setnchannels(CHANNELS)
    wf.setsampwidth(p.get_sample_size(FORMAT))
    wf.setframerate(RATE)
    wf.writeframes(b''.join(frames))
    wf.close()

def main():

#start play_audio and record_audio here at the same time

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:38:46.990

```
import threading,time
def play1():
    while time.time() <= start_time:
        pass
    threading.Thread(target=listen_to_audio).start()
def play2():
    while time.time() <= start_time:
        pass
    threading.Thread(target=play_audio).start()
start_time=time.time()+20
threading.Thread(target=play1).start()
threading.Thread(target=play2).start() 
```

这应该对你有用，它启动每个函数，并且在每个函数中它一直等到正确的时间:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T18:23:07.103

我会使用线程：

```
import threading

threads = []
threads.append(threading.Thread(target=listen_to_audio))
threads.append(threading.Thread(target=play_audio))

map(lambda x: x.start(), threads) 
```

编辑：不确定 map 是否会**绝对**同时启动线程，但应该非常接近

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T18:24:03.770

你可以从：

```
import threading

threading.Thread(target=listen_to_audio).start()
threading.Thread(target=play_audio).start() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T21:48:49.303

谢谢IT忍者，

您的代码完成了这项工作，但我不得不将其更改为：

```
def main():
start_time=time.time()+1
def play1():
    while time.time() < start_time:
        pass
    threading.Thread(target=listen_to_audio(5)).start()
def play2():
    while time.time() < start_time:
        pass
    threading.Thread(target=play_audio(5)).start()

threading.Thread(target=play1).start()
threading.Thread(target=play2).start() 
```

现在它工作了:) 谢谢大家！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T18:29:46.393

为什么要使用线程启动这两个功能？您可以简单地调用第一个函数并使用第一个函数中的线程启动第二个函数。

```
import threading

def play_audio():
    threading.Thread(target=listen_to_audio).start()
    #rest of code for play_audio 
```

我认为这里的延迟会非常少。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-24T05:46:27.313

事后很久，但是，

1.  线程可能同时开始，但由于 Windows 的限制，播放/录制不会同时开始。实际上，幕后两者都有一个缓冲区，导致（未知或可控）延迟。

2.  最好的方法是创建一个异步读/写流（一个同时进行读和写的流）。也就是说，使用回调函数创建一个流并定义 input=True 和 output=True （我在这里假设 pyaudio）。

我不确定 pyaudio 如何在幕后实现线程，尤其是在它阻塞音频的情况下，但另一个问题是 GIL（全局解释器锁）。我没有对事物的当前状态以及在不同 python 实现下的行为方式进行足够的研究，但是 IIRC 只有一个线程可以在给定时间运行 python 代码，所以 python 在大多数情况下对多线程不是很友好瞬间AFAIK

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-16T18:20:49.043

我会创建一个`def startBoth()`来包装这两个函数，并根据需要同时导入 listen_to_audio 和 play_audio。一旦你开始`startBoth()`，它会调用这两个函数。

# objective-c - Asana API 错误 - 使用 ios 客户端时浏览器不受支持

> ID：13422187
> 
> 赞同：1
> 
> 时间：2012-11-16T18:15:32.970
> 
> 标签：objective-c, ios, asana

我正在从 iOS 客户端向 Asana 发送 API 调用，并得到一个标题为：Asana - Unsupported Browser 的 HTML 页面，它告诉我调用的方式有问题。

我的API调用代码如下：

客户端设置在这里：

```
- (id) initHTTPClient {
    self = [super initWithBaseURL:[NSURL URLWithString:ASANA_BASE_URL]];

    if (self) {
        [self registerHTTPOperationClass:[AFJSONRequestOperation class]];
        [self setDefaultHeader:@"Accept" value:@"application/json"];
        [self setParameterEncoding:AFJSONParameterEncoding];
        [self setAuthorizationHeaderWithUsername:ASANA_API_KEY password:[NSString string]];
    }

    return self;
} 
```

API调用在这里构造：

```
- (void) getCurrentUser {

    NSDictionary *parameters = [NSDictionary dictionary];

    NSMutableURLRequest *request = [self requestWithMethod:@"GET" path:@"/users/me.json" parameters:parameters];

    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];

    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSError *error;
        NSDictionary *response = [NSJSONSerialization JSONObjectWithData:responseObject options:NSJSONReadingAllowFragments error:&error];
        NSLog(@"Success, here's what we got: %@",response);

    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        NSLog(@"Failure, error: %@",error.debugDescription);
    }];

    [operation start];
} 
```

# java - 为什么需要验证通过调用 HttpSession.getAttribute() 获得的 servlet 中的数据？

> ID：13422188
> 
> 赞同：2
> 
> 时间：2012-11-16T18:15:47.097
> 
> 标签：java, security

我是 WebApp 编程的新手，我试图了解不验证通过调用`javax.servlet.http.HttpSession.getAttribute()`接口方法获得的数据的安全隐患。我正在使用已标记此潜在漏洞的安全代码扫描程序。

我知道作为一般规则，我应该始终验证从不受信任的来源获得的数据，但我想我不明白为什么会话的内容会不受信任。这是基于我的（可能是没有根据的）假设，即可以将数据添加到会话的唯一方法是通过调用`HttpSession.setAttribute()`，并且只有同一应用程序范围内的受信任代码才能做到这一点。

我想我真正要问的是攻击者如何利用无法验证从 HttpSession 获取的数据的应用程序。是因为实现是未知的，并且不能保证会话的内容不是从 HTTP 请求中的数据（除了会话 ID）以某种方式构造的，因此会受到篡改吗？还是因为信任会话的内容意味着隐含地信任会话 ID，这可能会受到损害并指向错误的会话？（尽管要发生这种情况，攻击者似乎必须有某种方法来创建包含受损数据的备用会话）。

假设会话的内容不是根据请求中的数据构建的，那么是否存在可以利用此漏洞的唯一方法是如果存在另一个允许攻击者创建错误会话的漏洞？例如上传可执行代码并让服务器执行它并返回一个被捕获和重放的会话ID？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T12:54:29.473

只要您不将任何您不信任的内容放入 HttpSession 中，您就不需要验证 HttpSession 中的数据。HttpSession 是为您的 web 应用程序创建的，当您要求它时，它应该只包含您在您的 servlet 或 JSP 之一中添加到它的东西 - 尽管如果您使用一些额外的框架可能是间接的。

我个人会确保我永远不会在 HttpSession 中放入任何稍后我将其取出时必须再次验证的内容。在一个简单的 servlet 容器环境中，它只会是您自己的代码来更新会话（除非容器自动删除它，如果它超时）。

除非您使用的框架会自动将内容添加到 HttpSession 中*，并且*这些内容可能直接来自用户而没有经过清理，否则您应该没问题。如果您自己的代码当前正在将您不信任的内容放入 HttpSession 中，我会将其更改为不这样做。

请注意，JSP 在这方面没有任何区别；JSP在编译后*就是servlet。*如果您信任您的 servlet 放入 HttpSession 中的内容，那么您应该也能够信任您的 JSP 对它所做的事情。（毕竟，它们是*您的*JSP。）

重新“是因为实现是未知的，并且不能保证会话的内容不是从 HTTP 请求中的数据（除了会话 ID）以某种方式构造的，因此会被篡改吗？”。servlet 规范中没有任何内容可以强制或允许这种情况发生。所以不，这不是原因。

重新“或者是因为信任会话的内容意味着隐式信任会话 ID，这可能会受到损害并指向错误的会话？” 我不确定“错误的会话”。但是，一旦某人（除了预期用户）拥有会话 ID（JSESSIONID），他们本质*上*就是预期用户，并且可以做任何用户可以做的事情（在相关 webapp 的能力范围内）。无论被破坏的数据是来自会话、数据库还是其他什么，都是如此。

一个常见的 servlet/MVC/JSP 方法是让用户登录（通过任何方式），然后为用户创建一个包含该用户的最小表示的 HttpSession（例如，一个包含用户 ID、名称等的 UserLogin POJO， ETC）。从那时起，webapp 相信此信息是有效的并使用它来识别用户 - 例如，带有 JSESSIONID 的 HTTP 请求到达，它映射到 HttpSession，后者映射到会话中的某些数据（UserLogin POJO），然后识别请求用户在从 webapp 内部调用底层系统时（例如进行数据库调用）。没有 HttpSession 和 UserLogin 会话数据则表明用户没有登录。这在 webapps 中很常见，并且取决于能够信任 JSESSIONID 和它映射到的 HttpSession。

顺便说一句（因为上面有人提到了 JSP）我不会编写一个 JSP 接触会话的 web 应用程序——我会限制 JSP 呈现由基于 MVC 的 servlet 提供给它们的数据。

（如果可以选择的话，我也根本不会使用 JSP：JSP 相当笨重，语法难看，还有许多其他限制 - 尝试使用 JSP 来模板电子邮件，而不是 HTML 页面，例如, 没有跳过一堆箍。考虑使用 Velocity 或类似的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:07:23.807

数据也可以从表单添加到会话中。请求可能来自另一个 servlet/应用程序，不一定来自表单。某人很容易在表单/servlet 中为 SQL 注入设置 SQL 语句并将其转发给 servlet。这只是我能想到的一种可能性。话虽如此，我不记得验证会话属性......永远！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:00:37.460

我认为它的全部意思是用户可能输入数据，您无法确定用户输入的内容或是否有任何类型的客户端验证。如果您根据在请求中收到的内容盲目地调用函数，那么您可能会遇到安全问题。例如，在检索用户输入的客户 ID 的客户信息之前，请确保 ID 有效并确保用户有权查看数据。

# scala - 如何在我的开发环境中管理多个版本的 Scala 和 SBT？

> ID：13422189
> 
> 赞同：8
> 
> 时间：2012-11-16T18:15:58.963
> 
> 标签：scala, sbt

我刚刚完成了很棒的 Coursera Scala 课程，并渴望通过探索一些现有的开源项目来继续了解更多关于 Scala 的知识。不过，我在尝试让其中一些在本地运行时遇到了障碍。

我来自 Ruby 的背景，我们使用诸如`rvm`或`rbenv`在一个系统上管理多个 Ruby 解释器/版本之类的工具。Scala 用户在处理使用不同版本的 Scala/SBT 的项目时采用什么方法？

我怀疑我错过了一些大事，因为这似乎不是一个受欢迎的问题。

请注意，我对 Java 和一般的 JVM 世界还是很陌生。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-16T18:34:27.223

我建议你看看 paulp 的[优秀 sbt-extras 脚本](https://github.com/paulp/sbt-extras)。这将使您能够在每个项目的基础上选择要使用的 sbt 版本，并且 sbt 将允许您在每个项目的基础上选择所需的 Scala 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-23T16:27:05.493

我总是使用[Homebrew](http://brew.sh) (OS X) 的最新版本，然后`sbt`从.`build.sbt`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-24T18:01:56.593

最近（2016 年 12 月），您可以尝试查看[**sdkman.io**](http://sdkman.io/)，**软件开发工具包管理器**。

它是一种用于在大多数基于 Unix 的系统上管理多个软件开发工具包的并行版本的工具。它提供了一个方便的命令行界面 (CLI) 和 API，用于安装、切换、删除和列出候选人。

它为 JVM 安装软件开发工具包，例如 Java、Groovy、Scala、Kotlin 和 Ceylon。还支持 Activator、Ant、Gradle、Grails、Maven、SBT、Spring Boot、Vert.x 等。

# html - css transform3d和堆叠顺序

> ID：13422190
> 
> 赞同：0
> 
> 时间：2012-11-16T18:16:04.133
> 
> 标签：html, css, z-index, translate3d

我使用[同位素](http://isotope.metafizzy.co/)来布置一些项目。每个项目都包含一个弹出菜单。因为同位素用于`translate3d`布局和动画项目的菜单的堆叠顺序我们都搞砸了。后面的项目隐藏了前一个项目的菜单，即使项目有`z-index: 1`并且菜单有`z-index: 2`。有没有办法解决这个问题？

这是一个显示行为的示例（[jsfiddle](http://jsfiddle.net/paskQ/2/)）：

CSS：

```
.items {
    position: relative;
}

.item {
    position: absolute;
    z-index: 1;
    width: 90px;
    height: 90px;
    background: lightgray;
    padding: 5px;
}

.menubutton {
    position: relative;
}

.menu {
    position: absolute;
    z-index: 2;
    top: 100%;
    left: 0px;
    list-style: none;
    margin: 0;
    padding: 5px;
    background: yellow;
}

.menubutton .menu {
    display: none;
}

.menubutton:hover .menu {
    display: block;
} 
```

HTML：

```
<div class="items">
<div class="item" style="-webkit-transform: translate3d(10px,10px,0px); transform: translate3d(10px,10px,0px);">
<div class="menubutton">
    <div class="label">menu</div>
    <ul class="menu">
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>                    
    </ul>
</div>
    ...
</div>
<div class="item" style="-webkit-transform: translate3d(10px,120px,0px); transform: translate3d(10px,120px,0px);">
<div class="menubutton">
    <div class="label">menu</div>
    <ul class="menu">
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>
        <li>menu item</li>                    
    </ul>
</div>
    ...
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:52:23.513

我只是知道如何解决它。我刚刚添加了这种样式：

```
.item:hover {
    z-index: 2;
} 
```

这样，当前悬停的项目总是在所有其他项目的前面。

见：http: [//jsfiddle.net/paskQ/5/](http://jsfiddle.net/paskQ/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:44:56.543

看起来每个`.item`都有相同的`z-index`，所以每个后续`.item`都堆叠在前一个之上，尽管有相同`z-index.`的父`z-index`级然后是被比较的，而不是`z-index`on `.menu`。

我不熟悉同位素，所以这可能不是一个可行的解决方案，但如果您能够添加一些 jQuery，您可以在`z-index`之后动态设置值并使用类似的方法解决问题

```
var total = $(".item").length;
$(".item").each(function(){
   $(this).css("z-index", total);
   total--;        
}); 
```

这是一个小提琴[http://jsfiddle.net/paskQ/4/](http://jsfiddle.net/paskQ/4/)

如果这不起作用，请告诉我，也许我可以找到替代解决方案，或者如果您有任何问题。

# php - 如何操作从 example.com/search/?s=some 到 example.com/search/some 的 URL

> ID：13422193
> 
> 赞同：1
> 
> 时间：2012-11-16T18:16:09.943
> 
> 标签：php, .htaccess, url-rewriting

我的网站上有一个搜索表。提交表单时，它由我的 index.php 处理，因此 URL 类似于 index.php?s=some。现在我在我的 htaccess 中添加了一些重写规则：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/]*)/$ index.php?s=$1 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/]*)/([^/]*)/?$ index.php?s=$2&f=$1 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/]*)/([^/]*)/([^/]*)?$ index.php?s=$2&f=$1&t=$3 [QSA,L] 
```

我的表单有“搜索”动作，它看起来像这样：

```
<form id="searchform" method="get" action="search"> 
```

现在提交时会发生什么情况，您会被重定向到 example.com/search/?s=some 但我想要的是被重定向到 example.com/search/some 我可以在我的重写规则中添加什么来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:22:50.503

当我为我的项目寻找解决方案时，我遇到了[http://matthewjamestaylor.com/blog/how-to-post-forms-to-clean-rewritten-urls 。](http://matthewjamestaylor.com/blog/how-to-post-forms-to-clean-rewritten-urls)涉及的 PHP 可能有点矫枉过正，但它确实有很多实用性。

**.htaccess**

```
# Clean up search URL
RewriteRule ^search/([^/\.]+)$ search.php?q=$1 
```

**PHP**

```
<?
    // Collect the search phrase from the URL
    $qs = mysql_real_escape_string($_GET['q']);

    // Clean up by removing unwanted characters
    $qsclean = ereg_replace("[^ 0-9a-zA-Z]", " ", $qs);

    // Remove multiple adjacent spaces
    while (strstr($qsclean, "  ")) {
       $qsclean = str_replace("  ", " ", $qsclean);
    }

    // Prefix each keyword with a + (for the SQL statement)
    $qsql = "+".str_replace(" ", " +", $qsclean);
?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-16T18:25:37.687

为什么不使用 post 方法？我认为这种方法会使编程更复杂 请使用 post 方法。它更安全。

# android - 在 Mac OS X 10.8.x 中使用硬件键盘创建 AVD

> ID：13422195
> 
> 赞同：1
> 
> 时间：2012-11-16T18:16:16.923
> 
> 标签：android, macos, avd

我正在尝试在 AVD Manager 中模拟 Galaxy Nexus 设备。我已经检查了`Hardware keyboard present`和`Display a skin with hardware controls`，但是当设备实际启动时，这些似乎都不起作用。有没有人可以在 Mac OS X 10.8.2 上为 AVD 设备启用键盘输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:34:51.403

检查当前设备的配置文件

```
~/.android/avd/<emulator-device-name>.avd/config.ini 
```

看看是否`hw.keyboard=yes`。如果显示`no`，请更改为`yes`.

# asp.net-mvc - PagedList 正在抛出 Security.VerificationException

> ID：13422201
> 
> 赞同：3
> 
> 时间：2012-11-16T18:16:48.950
> 
> 标签：asp.net-mvc, pagedlist

在尝试重构 MVC 4 应用程序期间，我的代码发生了如此大的变化，我从 Subversion 恢复了整个事情。但是，现在，当我运行代码时，我得到以下异常并且无法弄清楚如何消除它。

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

 Operation could destabilize the runtime. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Security.VerificationException: Operation could destabilize the runtime.

Source Error: 

Line 756:            ViewBag.PageSize = pageSize;
Line 757:            ViewBag.pageNumber = pageNumber;
Line 758:            return View(offenders.ToPagedList(pageNumber, pageSize));
Line 759:
Line 760: 

Source File: e:\KOOL_save\KOOLR\Controllers\KOOLRController.cs    Line: 758 

Stack Trace: 

[VerificationException: Operation could destabilize the runtime.]
   PagedList.PagedList`1..ctor(IQueryable`1 superset, Int32 pageNumber, Int32 pageSize) +0
   PagedList.PagedListExtensions.ToPagedList(IQueryable`1 superset, Int32 pageNumber, Int32 pageSize) +100
   KOOLR.Controllers.KOOLRController.AdvancedSearch(String sortOrder, String resetButton, String LastName, String FirstName, String MiddleName, Nullable`1 page) in e:\KOOL_save\KOOLR\Controllers\KOOLRController.cs:758
   lambda_method(Closure , ControllerBase , Object[] ) +2013
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +59
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +435
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +60
   System.Web.Mvc.Async.AsyncControllerActionInvoker.InvokeSynchronousActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +50
   System.Web.Mvc.Async.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41() +75
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +44
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +139
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +102
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult) +49
   System.Web.Mvc.Async.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33() +126
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +323
   System.Web.Mvc.Async.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult) +44
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +139
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +102
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult) +50
   System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +68
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +184
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +136
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +56
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +40
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +40
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +47
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +151
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +59
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +44
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +47
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +151
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +59
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +39
   System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +39
   System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__3(IAsyncResult asyncResult) +45
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +47
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +151
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +59
   System.Web.Mvc.Async.AsyncResultWrapper.End(IAsyncResult asyncResult, Object tag) +40
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +40
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +38
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +9629708
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.17929 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T07:09:56.563

您可以尝试安装它的最新版本吗？这发生在升级到 .NET 4.5 后，并在最新版本的 PagedList 中得到解决。

# xcode - 使用 CMake 为多个可执行文件添加不同的 Xcode 资源

> ID：13422202
> 
> 赞同：3
> 
> 时间：2012-11-16T18:16:54.587
> 
> 标签：xcode, resources, cmake

**背景：**我正在使用 CMake 配置一个构建库和应用程序组合的项目。每个应用程序都使用该应用程序独有的资源文件，例如图像和文本文件。Xcode 理解资源文件的概念，可以正确地将它们复制到应用程序包中。如果我正在创建一个只有一个应用程序的项目，那将没有问题：我可以使用 CMake`set_source_files_properties(... PROPERTIES MACOSX_PACKAGE_LOCATION Resources)`告诉 Xcode 将文件放入包的资源目录中，以便稍后调用`[[NSBundle mainBundle] pathForResource:...]`将正确找到它们。（该`pathForResource`方法默认搜索“Resources”目录。）这些文件也出现在 Xcode 项目的 Resources 组中。

**问题：**当我在 CMake 项目中包含多个应用程序时，会出现问题。每个项目都需要将自己的不同资源文件复制到自己的包的资源目录中。因此，每个应用程序在 Xcode 中都需要一个不同的资源组来保存这些文件并从中复制它们。然而，这些不同的目录必须全部命名为“资源”。理想情况下，Xcode 中的每个特定于应用程序的文件夹都有自己独特的“资源”子目录，其中包含所有需要的资源。实际发生的情况是，该项目有一个共享的 Resources 目录，所有资源文件都收集到该目录中，并且项目特定的“Resources”子目录仅包含该应用程序的 info.plist 文件。因为所有应用程序的资源都被扔到同一个组中，

有没有人找到一种方法来使用 CMake 来设置支持具有不同资源的多个应用程序的 Xcode 项目？还是其他一些解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T17:32:14.487

我的解决方案对我有用，但也许这对你不满意。

我所做的是一个简单的**复制文件后构建步骤**，我将我的资源直接复制到构建的 Target.app 中。

我的方法的问题是文件没有出现在 Xcode 项目中。

## 这是我的做法：

我覆盖了**ADD_EXECUTABLE**宏。在内部，它评估资源变量 ${target}_RESOURCES。

因此，在我的目标的 CMakeLists.txt 中，我收集了一些*目录*和*资源文件*，并将它们作为列表存储在我的目标中，具体取决于资源变量。

以下自定义命令在我的宏中（实际上可能在任何地方）：

```
ADD_CUSTOM_COMMAND( TARGET ${target} POST_BUILD 
                    COMMAND ${CMAKE_COMMAND} -DFILES_LIST="${${target}_RESOURCES}"  -DDESTINATION="\${TARGET_BUILD_DIR}/\${FULL_PRODUCT_NAME}" -DEXCLUDE_EXT=".svn .git CVS .DS_Store" -P ${ROOT_DIR}/cmake/scripts/copyFiles.cmake
                    WORKING_DIRECTORY ${CMAKE_CURRENT_LIST_DIR}
                    COMMENT "Copying resource files and directories to iOS App Bundle..." ) 
```

它调用我的复制文件脚本（也许有更好的方法来添加自定义构建步骤）：

```
SEPARATE_ARGUMENTS( FILES_LIST )

FOREACH( ENTRY ${FILES_LIST} )
    MESSAGE( "copying: ${ENTRY} to ${DESTINATION}" )
    FILE( COPY ${ENTRY} DESTINATION ${DESTINATION} PATTERN "${EXCLUDE_EXT}" EXCLUDE )
ENDFOREACH( ENTRY ) 
```

这个对我有用。我真的不在乎资源是否出现在 XCode 项目中。

但我还是想知道。在 Xcode 中没有文件时是否有任何问题或问题？

# ruby-on-rails - 此设置的正确 Rails 关联

> ID：13422204
> 
> 赞同：0
> 
> 时间：2012-11-16T18:17:01.523
> 
> 标签：ruby-on-rails, associations

刚开始使用rails，我有一个问题。我对联想的把握很薄弱。

假设我有一个模型**汽车**

有些汽车会出租，有些则不会。所以我创建了一个表和一个名为**Rentals的模型**

其中只有**car_id**，指定在 car_id 是租赁。

现在我的 Rental 模型中有一个**belongs_to :cars**行。我不确定这是否正确。我正在尝试轻松获取所有租金的清单。所以从出租表中获取 car_ids 并从汽车表中获取所有汽车信息是最有效的方式。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:25:21.843

这取决于你究竟需要用它做什么。

为简单起见，这就是我的做法。

```
class CarType #better than Rentals and more meaningful [:type => [rental, lease, own]]
  belongs_to :car
end

class Car
  has_one :car_type
end 
```

所以，现在对于`cars`表格，它将`car_type_id`指向`car_types`表格中的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:25:47.097

以下：

```
Car.joins(:rentals).all # try with :rental if not working 
```

将输出所有与租赁对象相关联的汽车；）

# python - 如何在c中加载自定义python模块

> ID：13422206
> 
> 赞同：5
> 
> 时间：2012-11-16T18:17:11.613
> 
> 标签：python, c, embed

到目前为止，我只是想在 python 文档中给出[这个例子](http://docs.python.org/2/extending/embedding.html#pure-embedding)，以便在 C 中嵌入一个 python 模块来工作。我的问题是我不知道在哪里放置 python 脚本。我的最终目标是`__init__.py`通过执行`PyImport_Import(...)`. 但现在，请让我知道将显示的脚本（文件名、路径等）放在哪里，以便运行给定的 C 程序。

**编辑**

我应该指出我尝试过的。我尝试将`multiply.py`文件放在本地目录中，以及将其放在文件中调用的子目录`multiply`中`__init__.py`。在所有这些情况下，我得到`ImportError: No module named multiply`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T18:21:24.817

我认为它应该在同一个目录中，或者在`sys.path`它按名称加载模块时，这应该有效：

```
./call multiply multiply 5 6 
```

更新：如果我明确地将当前目录添加到`sys.path`它的工作原理：

```
Py_Initialize();
PyRun_SimpleString("import sys");
PyRun_SimpleString("sys.path.append(\".\")"); 
```

这打印：

```
./call multiply multiply 5 6
('Will compute', 5, 'times', 6)
Result of call: 30 
```

**更新**：我问了一个相关的问题，似乎如果你只是添加`PySys_SetArgv`它就可以了：

```
Py_Initialize();
PySys_SetArgv(argc, argv); 
```

原因在这里提到：

> 否则（即，如果 argc 为 0 或 argv[0] 不指向现有文件名），则在 sys.path 前添加一个空字符串，**这与在当前工作目录前添加 (".") 相同**

这也是您可以在那里检查答案的问题：

[为什么 PyImport_Import 无法从当前目录加载模块？](https://stackoverflow.com/questions/13422764/why-does-pyimport-import-fail-to-load-a-module-from-the-current-directory/13424007#13424007)

# php - Zend Framework 2 在实例化不存在的类时不显示错误

> ID：13422211
> 
> 赞同：0
> 
> 时间：2012-11-16T18:17:56.477
> 
> 标签：php, zend-framework2

在尝试学习 Zend Framework 2 时，我在调试代码时遇到问题。

最初我一直在尝试实现 Zend\Captcha\ReCaptcha 并不断收到黑页。但是，我已经回到了这样一个事实，即当我尝试从不存在的类中实例化一个对象时，我没有收到任何错误。只是一个空白页。

例如：

```
public function indexAction()
{

   new Zend\Captcha\ReCaptcha();
   //or
   new Some_Class_Which_Doesnt_Exist();
} 
```

结果是空白页。如果我将实例注释掉，我会得到我的标准布局页面。

我的 PHP 错误报告设置为：

```
error_reporting = E_ALL | E_STRICT 
```

我猜这与 Zend 框架有关。我可以强制它显示错误以帮助我进行调试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:22:23.560

检查`display_errors`php.ini 中的选项，也许它设置为`0`.

# primefaces - Primefaces RowEditor 不适用于 Spring Webflow

> ID：13422213
> 
> 赞同：0
> 
> 时间：2012-11-16T18:18:18.113
> 
> 标签：primefaces, facelets, spring-webflow, spring-webflow-2

我有带有单元内编辑的 Primefaces DataTable：

```
 <p:dataTable id="docsTable" editable="true" value="#{customer.docs}" var="doc" style="border-width:0px;" >

            <p:growl id="docsMessages" showDetail="true"></p:growl>

            <p:ajax event="rowEdit" update="docsMessages,docsTable" listener="#{customerController.onEditDocument}"></p:ajax>
            <p:ajax event="rowEditCancel" update="docsMessages,docsTable" listener="#{customerController.onEditDocumentCancel}"></p:ajax>

            <p:column headerText="Document Type">
                <p:cellEditor>
                    <f:facet name="output">
                        <h:outputText value="#{doc.docType}"></h:outputText>
                    </f:facet>
                    <f:facet name="input">
                        <p:inputText value="#{doc.docType}"></p:inputText>
                    </f:facet>
                </p:cellEditor>
            </p:column>
            <p:column headerText="Document Number">
                <p:cellEditor>
                    <f:facet name="output">
                        <h:outputText value="#{doc.docNum}"></h:outputText>
                    </f:facet>
                    <f:facet name="input">
                        <p:inputText value="#{doc.docNum}"></p:inputText>
                    </f:facet>
                </p:cellEditor>
            </p:column>
            <p:column>
                <p:rowEditor></p:rowEditor>
            </p:column>
        </p:dataTable> 
```

下面是对应的 SWF 视图状态定义：

```
<view-state id="enterDetails" view="/WEB-INF/views/tiles/customer/s3-custDetails.xhtml" model="customer"> <!-- tiles/customer/s3-custDetail -->
    <secured attributes="ROLE_WEB" />
    <var name="customerController" class="com.my.CustomerController"/>
    <transition on="addNewDocument">
        <evaluate expression="customer.docs.add(new com.my.CustomersDocs())"></evaluate>
        <render fragments="custDetails"></render>
    </transition>
</view-state> 
```

视图渲染良好，值保存在支持 bean 中，并且在我的控制器中也调用了 rowEdit 侦听器。但是，无论用户做什么，它都不会退出编辑器模式。我做了一些网络嗅探，似乎 SWF 只发回了视图状态，而 Primefaces 展示也发回了渲染片段。

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T19:41:57.007

这是 Spring webflow 中的一个错误/缺陷。它在 Spring 文档中被提及（参见[http://static.springsource.org/spring-webflow/docs/2.3.x/reference/html/ch13s10.html](http://static.springsource.org/spring-webflow/docs/2.3.x/reference/html/ch13s10.html)），但以一种相当晦涩的方式，并没有提到与部分渲染的关系问题。修复很简单，在 webflow:flow-executor 标签中添加以下内容：

```
 <webflow:flow-execution-attributes>
            <webflow:redirect-in-same-state value="false"/>
        </webflow:flow-execution-attributes> 
```

# .net - 构建 Windows Phone 8 益智游戏的技术选择/编程语言是什么？

> ID：13422217
> 
> 赞同：0
> 
> 时间：2012-11-16T18:18:33.620
> 
> 标签：.net, windows-phone-8

我不确定构建一个简单的益智游戏应该选择哪种技术。我想构建一个“引擎”，让我可以选择图像的区域作为“拼图”，并将它们放在一个盒子中供孩子选择并拖动到拼图网格中。我不确定从哪里开始 WP8，因为我从来没有用 XNA 构建过任何东西，而且 C++ 超出了我目前的水平。

我需要使用哪种编程语言和技术来完成此类功能？这可以在没有 WP8 中的本机 C++ 代码的情况下完成，还是需要 XNA/C++？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:23:22.793

我认为 XNA 可以胜任这项任务，并在 WP8 中得到支持。

但是，如果您想将游戏（或“未来证明”）移植到 Windows 商店（“Metro”），您可能需要查看 MonoGame，或更明确的 DirectX 与 SharpDX。

# iphone - UI 自定义按钮的想法 - 需要评论

> ID：13422220
> 
> 赞同：0
> 
> 时间：2012-11-16T18:18:42.763
> 
> 标签：iphone, ios, xcode, ipad

作为我之前关于带有图像的自定义 UI 按钮的问题的后续，我能够创建嵌入图像的圆形自定义按钮。我根本不是一个好的设计师，想就以下方面获得专家建议：

1.  圆形按钮是否更好看，用户在使用应用程序时不会混淆或错误地按下主页按钮而不是我的应用程序的圆形按钮？

2.  这些是不是太大了？我可以选择的最佳尺寸是多少？我正在构建的应用程序既适用于 iPhone（包括 iPhone 5），也适用于 iPad，包括 mini。

3.  仅使用纯文本和没有嵌入图像的按钮会更好看吗？

4.  视图的背景颜色是黑色，想知道按钮的最佳颜色和尺寸是什么？

谢谢。

![在此处输入图像描述](../Images/a29a5a7059a04464094423c48736a98c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:31:42.440

1.  用户通常能够区分他们的设备主页按钮（他们非常了解）和设备屏幕上的自定义按钮。圆形按钮可以是呈现具有单个正确触摸点的触摸元素的有效方式。查看 Path 以获得圆形按钮的一个很好的例子。从您的示例看来，您正在尝试重新实现 UITabBar。请考虑使用内置实现，因为它仍然提供了大量的 UI 自定义，并且对于普通用户来说也是一个非常容易识别的元素。

2.  这些按钮应符合移动应用程序的最低 Apple[人机界面指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/Introduction/Introduction.html)。您可以考虑使实际按钮图像更小，但用透明填充围绕它们以增加点击目标，以便用户可以轻松地实际点击您的按钮。

3.  一般来说，我发现带有图像的按钮比文本更可取，尤其是。当图像准确传达意义时。图片按钮将使用户对您的应用程序更加好奇，而且一旦他们了解了按钮的功能，他们就不再需要文本了。

4.  如果没有看到更多的应用程序，我将无法让您更深入地了解实际设计或颜色选择。通常，黑色界面往往会给用户带来负面体验。您会注意到，网络上大多数流行的应用程序都具有大量的白色或浅灰色，并且元素之间有足够的空间。即使是苹果也很少使用真正的黑色元素。

# servicestack - 默认内容类型 + 反序列化错误

> ID：13422222
> 
> 赞同：2
> 
> 时间：2012-11-16T18:18:49.097
> 
> 标签：servicestack

我已将我的 AppHost 配置为 JSON 作为默认内容类型。不幸的是，当 ServiceStack 无法将请求反序列化为相应的 DTO 时，它会以 application/xml 内容进行响应。这是一个示例响应（为简洁起见，我省略了大部分消息和堆栈跟踪元素值）：

```
<UpsertResponse xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="">
    <ResponseStatus>
        <ErrorCode>SerializationException</ErrorCode>
        <Message>Could not deserialize 'application/xml' request using ...</Message>
        <StackTrace>at ServiceStack.WebHost.Endpoints.Support.EndpointHandlerBase.CreateContentTypeRequest(IHttpRequest httpReq, Type requestType, String contentType)...</StackTrace>
    </ResponseStatus>
</UpsertResponse> 
```

我猜响应是这样编码的，因为请求正在发送“应用程序/xml”内容。有没有办法强制（或挂钩）ServiceStack 使用默认内容类型？

更详细一点 - 我的服务不仅使用 JSON 作为默认内容类型，而且（尝试）通过全局请求过滤器确保 JSON 是唯一接受的内容类型，该过滤器在每次读取期间检查 Accept/Content-type 标头/write 并在内容类型不是“application/json”时使用 400 响应使请求短路。

# tsql - SQL获取按周分组的计数并键入给定的日期间隔

> ID：13422225
> 
> 赞同：1
> 
> 时间：2012-11-16T18:19:17.400
> 
> 标签：tsql, pivot-table, group-by

给定一个包含开始和结束日期以及它们正在发生的区域的项目表，我试图让我的结果输出在给定时间间隔内每周活动项目的数量并按地区分组。

我在项目中有很多看起来像的记录

```
地区 start_date end_date
阿拉巴马州 2012-07-08 2012-08-15
德州 2012-06-13 2012-07-24
阿拉巴马州 2012-07-25 2012-09-13
德州 2012-08-08 2012-10-28
佛罗里达州 2012-07-03 2012-08-07
路易斯安那州 2012-07-14 2012-08-12
……

```

如果我想要一周的结果，我可以做类似的事情

```
DECLARE @today datetime
SET @today ='2012-11-09'

SELECT 
[Region],
count(*) as ActiveProjectCount
FROM [MyDatabase].[dbo].[Projects]
where (datecompleted is null and datestart < @today) OR (datestart < @today AND @today     < datecompleted)
Group by region
order by region asc 
```

这产生

```
区域 ActiveProjectCount
阿肯色州 15
路易斯安那州 18
北达科他州 18
俄克拉荷马州 27
...

```

如何更改此查询以生成看起来像的结果

```
地区 10/06 10/13 10/20 10/27    
阿肯色州 15 17 12 14
路易斯安那州 3 0 1 5
北达科他州 18 17 16 15
俄克拉荷马州 27 23 19 22
...

```

在每周的间隔中，我可以看到活动项目的总数（开始和结束日期之间的项目）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T23:12:40.540

你可以做某事。像这样：

```
with "nums"
as
(
  select 1 as "value"
  union all select "value" + 1 as "value"
  from "nums"
  where "value" <= 52
)
, "intervals"
as
(
  select
  "id" = "value"
  , "startDate" = cast( dateadd( week, "value" - 1, dateadd(year, datediff(year, 0, getdate()), 0)) as date )
  , "endDate" = cast( dateadd( week, "value", dateadd( year, datediff( year, 0, getdate()), 0 )) as date )

from
  "nums"
)
, "counted"
as
(
select
  "intervalId" = I."id"
  , I."startDate"
  , I."endDate"
  , D."region"
  , "activeProjects" = count(D."region") over ( partition by I."id", D."region" )

from
  "intervals" I
  inner join "data" D
    on D."startDate" <= I."startDate"
    and D."endDate" > I."endDate"
)

select
  *
from
(
  select
    "region"
    , "intervalId"
  from
    "counted"
) as Data
pivot
( count(Data."intervalId") for intervalId in ("25", "26", "27", "28", "29", "30", "31")) as p 
```

可以根据需要定义间隔。

见[SQL-Fiddle](http://www.sqlfiddle.com/#!3/f774d/92/0)

# android - Android - 带有 RadioButtons 的 AlertDialog，获取 AndroidRuntimeException

> ID：13422226
> 
> 赞同：0
> 
> 时间：2012-11-16T18:19:21.287
> 
> 标签：android, exception, radio-button, android-alertdialog

我正在开发一个使用 SQLite 数据库存储信息的 Android 应用程序。我正在尝试获取其中一些信息并将它们添加到带有单选按钮的 AlertDialog 中，但是当我调试时，我得到了这个 RuntimeException: **requestFeature() must be called before added content** 我认为错误在于：

> shop_type.setContentView(R.layout.shop_list_selection);

但我不知道如何解决它。

这是我单击 ImageButton 时的代码：

> ```
>  ImageButton shopping = (ImageButton)findViewById(R.id.gotoshop);
>     shopping.setOnClickListener(new OnClickListener() { 
> 
>       @Override
>       public void onClick(View v) { 
> 
>           // Get infos from DB
>           Cursor lists = dbAdapter.select("ls_tipo_lista", new String[] {"id", "nome"}, null, null, null, null, null);
> 
>           // Fetch data if exists
>           if(lists.getCount() > 0)
>           {
>               // Create AlertDialog
>               AlertDialog shop_type = new AlertDialog.Builder(MenuActivity.this).create();
> 
>               // Set title and layout
>               shop_type.setTitle("Tipo di spesa");
>               shop_type.setContentView(R.layout.shop_list_selection);
> 
>               // Get RadioGroup from shop_list_selection.xml
>               RadioGroup opts = (RadioGroup)shop_type.findViewById(R.id.rbshop);
> 
>               // Fetch data
>               while(lists.moveToNext())
>               {
>                   // Create radio button instance
>                   RadioButton rdbtn = new RadioButton(MenuActivity.this);
> 
>                   // Add data
>                   rdbtn.setId(lists.getInt(0));
>                   rdbtn.setText(lists.getString(1));
> 
>                   // Add to radiogroup
>                   opts.addView(rdbtn);
>               }
> 
>                       // Show dialog
>               shop_type.show();
>           }
>       }
>     }); 
> ```

这里是 XML 布局：

> ```
> <RadioGroup xmlns:android="http://schemas.android.com/apk/res/android"
>     android:id="@+id/rbshop"      android:layout_width="wrap_content"         android:layout_height="wrap_content"
>   android:orientation="vertical" >    </RadioGroup> 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:34:57.223

当您收到错误`requestFeature() must be called before adding content`时，这意味着您正在尝试以错误的顺序构建窗口。
为了避免这个错误，我建议利用 AlertDialog.Builder 类：

```
AlertDialog.Builder builder = new AlertDialog.Builder(MenuActivity.this);

// Create the View to populate the RadioButtons
View view = LayoutInflater.from(MenuActivity.this).inflate(R.layout.shop_list_selection, null, false);

// Get RadioGroup from shop_list_selection.xml
RadioGroup opts = (RadioGroup)view.findViewById(R.id.rbshop);

// Fetch data
while(lists.moveToNext())
{
    // Create radio button instance
    RadioButton rdbtn = new RadioButton(MenuActivity.this);

    // Add data
    rdbtn.setId(lists.getInt(0));
    rdbtn.setText(lists.getString(1));

    // Add to radiogroup
    opts.addView(rdbtn);
}

// Set title and layout
builder.setTitle("Tipo di spesa");
builder.setView(view);

// Show dialog
AlertDialog shop_type = builder.create();
shop_type.show();
// This works too for a one-off dialog: builder.show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:16:33.437

在 requestFeature() 之后调用 setContentView()。

调用 shop_type.show(); 就在 AlertDialog shop_type = new AlertDialog.Builder(MenuActivity.this).create();

# java - 所有类（不是接口）都有 AspectJ TypePattern 吗？

> ID：13422230
> 
> 赞同：2
> 
> 时间：2012-11-16T18:19:44.697
> 
> 标签：java, logging, aspectj, spring-roo

我正在尝试使用 AspectJ 自动向我的所有类添加一个记录器字段，以避免我不得不在每个类中单独编写样板记录器信息。在我看来，这似乎是一种相当普遍的做法，但我还没有找到任何现有的方面来实现这一点。

方面本身相当简单：

```
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
public privileged aspect Slf4jLoggerAspect{

    public interface Slf4jLogger{}
    private final Logger Slf4jLogger.logger = LoggerFactory.getLogger(getClass());

    declare parents: ????? extends Slf4jLogger;
} 
```

我的大问题是我为 ????? 放了什么。我希望 TypePattern 指示所有类，但不指示接口。如果我尝试只使用 * 模式，它也会获取我所有的接口。

AspectJ 中有什么东西可以让我只挑选出我所有的类定义吗？

或者这样的东西已经存在了吗？我本来想/期望在 Roo 中看到这一点，但找不到 slf4j roo 插件或注释。

谢谢！

埃里克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T01:08:40.690

首先，请记住，在 Java 中，一个类只能有一个超类（使用“extends”关键字），但您可以有多个接口（实现）。因此，您可能希望改为使用“实现”而不是“扩展”。

下面展示了如何按照 Ramnivas Laddad 的 AspectJ in Action, 2nd Edition（第 5 章）中的说明进行混合样式方法。当您能够让类实现接口并且您希望提供默认实现时，这种风格很有效。

```
package com.example.aop.attributes;

import java.util.Calendar;

import javax.persistence.Column;
import javax.persistence.PrePersist;
import javax.persistence.PreUpdate;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import javax.validation.constraints.NotNull;

/**
 * Aspect that adds a timestamp attribute to the entity along with the logic to
 * update that timestamp value just before it gets persisted to the database. It
 * also adds a creation timestamp to track when the object was originally
 * created.
 * 
 * @author tgh
 * 
 */
public interface Timestamped {

    public Calendar getCreationTimestamp();

    public void setCreationTimestamp(Calendar creationTimestamp);

    public Calendar getModificationTimestamp();

    public void setModificationTimestamp(Calendar modificationTimestamp);

    /**
     * AspectJ MixIn for any class which implements the interface. Provides a
     * default implementation using AspectJ. This is the style shown in
     * Manning's AspectJ in Action (2nd edition) for providing a default
     * implementation interface.
     * 
     * @author tgh
     */
    static aspect Impl {

        @NotNull
        @Temporal(TemporalType.TIMESTAMP)
        @Column(name = "created", nullable=false)
        private Calendar Timestamped.creationTimestamp = Calendar.getInstance();

        @NotNull
        @Temporal(TemporalType.TIMESTAMP)
        @Column(name = "last_modified", nullable=false)
        private Calendar Timestamped.modificationTimestamp = Calendar.getInstance();

        public Calendar Timestamped.getCreationTimestamp() {
            return this.creationTimestamp;
        }

        public void Timestamped.setCreationTimestamp(Calendar creationTimestamp) {
            this.creationTimestamp = creationTimestamp;
        }

        public Calendar Timestamped.getModificationTimestamp() {
            return this.modificationTimestamp;
        }

        public void Timestamped.setModificationTimestamp(Calendar modificationTimestamp) {
            this.modificationTimestamp = modificationTimestamp;
        }

        @PrePersist
        @PreUpdate
        private void Timestamped.updateModificationTimestampDuringPrePersistAndPreUpdate() {
            this.modificationTimestamp = Calendar.getInstance();
        }

    }
} 
```

要使用上述内容，您只需将“implements Timestamped”添加到实体类。这是在类中引入成员（新属性）的最简单方法。您还可以使用源上的注释进行混音。

在无法修改源的情况下，您将不得不与声明的父母一起玩。如果只标记在其类声明中已经有“@Entity”的实体，这将是：

```
declare parents: @Entity * implements Slf4jLoggerAspect; 
```

或者：

```
declare parents: (@MakeLoggable *) implements Slf4jLogger; 
```

如果您的接口位于单独的包中，那么您可以尝试仅标记特定包（而不是接口包）的 TypePattern：

```
declare parents: my.class.package.* implements Slf4jLogger; 
```

并且根据 AspectJ in Action (2nd Ed) 中的第 3.5 章，您还可以在 Type Pattern 元素上使用二元运算符：

```
declare parents: (@Entity *) || (@MakeLoggable *) implements Slf4jLogger; 
```

我不能 100% 确定上述方法是否有效，但有一个“||” 二元运算符，我已经看到在其他地方使用过（但找不到链接）。

（不，我不认为你可以告诉类型模式只看类而不看接口。虽然可能有 hasMethod() 和 hasField() 但它们在书中被标记为实验性的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T00:00:05.910

我不相信你能实现你想要的。使用 ITD，您需要指定具体的类名，例如：

```
private Logger MyClass.logger; 
```

其中 MyClass 是要添加记录器字段的类。因此，您必须为每个班级添加其中一个（spring roo 风格）。

您可以将此记录器字段添加到父类，并使所有类扩展该类，但这不适用于已经扩展其他类的类。

您可以将此字段添加到接口并让所有类都实现您在示例中的接口，但这不会起作用，因为接口中的字段是静态最终的，因此您不能调用 getClass()。

您可以使用替代记录器创建：

```
Logger Slf4jLogger.logger = LoggerFactory.getLogger(Slf4jLogger.class); 
```

但这将对所有日志记录事件使用相同的类别，从而使日志记录无用。

一种激进的方法可能是将其添加到 Object 类中：

```
final Logger Object.logger = LoggerFactory.getLogger(getClass()); 
```

但这可能真的把事情搞砸了。刚试过这个，说“受影响的类型没有暴露给织布工”。

另外，我不认为通过方面添加日志记录字段是一个好习惯。我认为以传统方式在每个类的顶部添加 Logger 字段没有任何问题。应谨慎使用 AOP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T13:37:11.267

仅仅因为用户*tgharold*提到了 mix-ins：在[AspectJ 1.6.4中引入了](http://eclipse.org/aspectj/doc/released/README-164.html)[@DeclareMixin](http://www.eclipse.org/aspectj/doc/released/adk15notebook/ataspectj-itds.html#atDeclareMixin)功能- 另请参阅[票 #266552](https://bugs.eclipse.org/bugs/show_bug.cgi?id=266552)。也许它有帮助，我没有尝试过，但它似乎很有希望解决你的混合类型的问题。

# html - 隐藏 type='hidden' 的输入字段与使用 display:none 的类

> ID：13422234
> 
> 赞同：9
> 
> 时间：2012-11-16T18:20:14.357
> 
> 标签：html, security, browser, client

我的页面上有几个隐藏的表单字段，用于将数据传递到服务器端。出于调试目的，我觉得通过将所有符合条件的输入字段都设为隐藏类的一部分来隐藏所有符合条件的输入字段比在每个输入字段上设置 type=hidden 属性更容易。

每当我需要调试时，我都可以轻松地修改该类属性以进入调试模式。当然，这两种方法都可以隐藏输入字段，但我不确定为什么这种方法（通过类隐藏）在现实生活中没有广泛使用。您能否阐明应该首选的方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-16T18:36:43.220

`<input type="hidden">`不会触发输入验证、自动完成和其他与用户交互相关的事件。它旨在保存原始数据，无需用户直接输入。

但是`<input type="text">`，视觉上隐藏的，仍将被视为用户交互组件。并且在某些启用了视觉辅助的设备上，它不会被隐藏，并且无法提供您期望的一致性。这就是为什么不建议这样做的原因。

例如。a`<input type="hidden">`不会自动完成它，或者在刷新页面之前保留输入的数据，或者防止表单提交失败，甚至看不到类型验证。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-16T18:26:47.750

CSS 方法不利于可用性和可访问性。想想一个禁用了 CSS 的人（非常旧的手机，有屏幕阅读器的人），他们不会像你期望的那样渲染你的 CSS，并且所有荣耀的输入都会显示给用户。

隐藏的输入应该用于**隐含的用户输入**，意思是来自用户的输入，但是是隐含的，不需要手动输入。

你的问题更多地落在`type="hidden"`方法上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T18:40:57.020

我建议使用`<input type="hidden" />`，因为它是 HTML 保存用户输入值的标准方式。如果你使用另一个属性 for`type`并用 隐藏它`css`，可能会出现一个问题，当 css 加载失败时，`input control`会显示 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T18:32:52.843

我认为您的问题是关于调试表单字段的最佳方法。我建议在您的 HTML 中将它们保留为 type='hidden'。这对您、您的用户和页面的语义解释都是最好的。

相反，请使用[Chrome 开发者工具之类的工具](https://developers.google.com/chrome-developer-tools/)来进行调试。这将使您轻松查看隐藏字段的值。

# c# - 当我在asp.net的网格视图中绑定数据时，网格视图如何隐藏某些特殊类型数据的细节？

> ID：13422236
> 
> 赞同：0
> 
> 时间：2012-11-16T18:20:23.640
> 
> 标签：c#, asp.net, asp.net-3.5

我有一个问题，我正在从数据源在网格视图中绑定数据，并且我正在获取不同类型的订单状态开始表格 1 到 7 的信息。我不想在我的网格视图中显示状态 7 数据。你能帮我我们怎么做吗

```
 <data:EntityGridView ID="GridView1" runat="server" AutoGenerateColumns="False" OnSelectedIndexChanged="GridView1_SelectedIndexChanged"
                        DataSourceID="ActiveOrdersDataSource" Width="100%" DataKeyNames="OrderNo" AllowMultiColumnSorting="false"
                         OnRowCommand="GridView1_RowCommond" OnRowDataBound="GridView1_OnRowDataBound"
                        DefaultSortDirection="Descending"  ExcelExportFileName="Export_ActiveOrders.xls">
                        <Columns>
                            <asp:CommandField ShowSelectButton="True" SelectText="Edit" />
                            <asp:BoundField DataField="OrderNo" ItemStyle-HorizontalAlign="Center" HeaderText="Order No" SortExpression="[OrderNo]" />
                            <asp:BoundField DataField="OrderDate" DataFormatString="{0:d}" HtmlEncode="False"
                                HeaderText="Order Date" SortExpression="[OrderDate]" />
                            <asp:BoundField DataField="PickupCompanyName" HeaderText="Pickup Company" SortExpression="[PickupCompanyName]" Visible="false" />
                            <asp:BoundField DataField="DeliveryCompanyName" HeaderText="Delivery Company" SortExpression="[DeliveryCompanyName]" Visible="false"  />
                            <data:HyperLinkField HeaderText="Ac.No." ControlStyle-ForeColor="Black" DataContainer="AccountNumberSource"
                                DataTextField="AccountNumber" />
                                 <data:HyperLinkField HeaderText="Client"  DataContainer="AccountNumberSource"
                                DataTextField="Name" />
                                <asp:BoundField DataField="Caller" ItemStyle-HorizontalAlign="Center" HeaderText="Caller" SortExpression="[Caller]" />
                                 <asp:BoundField DataField="Department" ItemStyle-HorizontalAlign="Center" HeaderText="Department" SortExpression="[Department]" />
                                 <asp:BoundField DataField="Reference" HeaderText="Reference" SortExpression="[Reference]"  />
                            <asp:TemplateField HeaderText="Driver" HeaderStyle-HorizontalAlign="Left">
                                <ItemTemplate>
                                    <asp:Label ID="lblDriver" runat="server" Text='<%#Eval("CurrentDriverNumberSource.Name") %>'></asp:Label>
                                </ItemTemplate>
                            </asp:TemplateField>
                            <data:HyperLinkField HeaderText="Service"  ControlStyle-ForeColor="Black" DataContainer="ServiceTypeIdSource"
                                DataTextField="Description" />
                            <data:HyperLinkField HeaderText="Vehicle" ControlStyle-ForeColor="Black" DataContainer="VehicleTypeIdSource"
                                DataTextField="Description" />
                            <asp:TemplateField HeaderText="Status" HeaderStyle-HorizontalAlign="Left">
                                <ItemTemplate>
                                    <asp:Label ID="lblStatus" runat="server" Text='<%#Eval("StatusID") %>'></asp:Label>
                                </ItemTemplate>
                            </asp:TemplateField>

                            <asp:TemplateField HeaderText="TotalAmount" ItemStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                            <asp:Label ID="lblAmount" runat="server" Text='<%# Eval("TotalAmount","{0:C2}")%>' ></asp:Label> 
                                            </ItemTemplate>
                                            <ItemStyle HorizontalAlign="Right" />
                                            </asp:TemplateField>

                        </Columns>

                        <EmptyDataTemplate>
                            <b>No Active Orders Found!</b>
                        </EmptyDataTemplate>
                    </data:EntityGridView> 
```

对于数据源，我使用它

```
 <data:ActiveOrdersDataSource ID="ActiveOrdersDataSourcebyCompany" runat="server" SelectMethod="GetPaged" EnablePaging="True" EnableSorting="True" EnableDeepLoad="True">
                        <DeepLoadProperties Method="IncludeChildren" Recursive="False">
                            <Types>
                                <data:ActiveOrdersProperty Name="Clients" />
                                <data:ActiveOrdersProperty Name="Companies" />
                                <data:ActiveOrdersProperty Name="Drivers" />
                                <data:ActiveOrdersProperty Name="SalesPeople" />
                                <data:ActiveOrdersProperty Name="ServiceTypes" />
                                <data:ActiveOrdersProperty Name="VehicleTypes" />
                                <data:ActiveOrdersProperty Name="Zones" />
                                </Types>
                        </DeepLoadProperties>
                        <Parameters>
                        <asp:SessionParameter Name="CompanyId" SessionField="CompanyId" Type="String" />
              <data:SqlParameter Name="WhereClause" UseParameterizedFilters ="false">
                          <Filters> 
```

```
 <%--<data:CustomParameter Name="WhereClause" Value="" ConvertEmptyStringToNull="false" />
                            <data:CustomParameter Name="OrderByClause" Value="" ConvertEmptyStringToNull="false" />
                            <asp:ControlParameter Name="PageIndex" ControlID="GridView1" PropertyName="PageIndex"
                                Type="Int32" />
                            <asp:ControlParameter Name="PageSize" ControlID="GridView1" PropertyName="PageSize"
                                Type="Int32" />
                            <data:CustomParameter Name="RecordCount" Value="0" Type="Int32" />--%>
                        </Parameters>
                    </data:ActiveOrdersDataSource> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T12:43:35.640

高塔姆，

您可以使用过滤器标签来设置您想要的值，例如：

```
<Parameters>
  <data:SqlParameter Name="WhereClause" UseParameterizedFilters="false">
    <Filters>
      <data:ChartOfAccountsFilter Column="Status" ComparisionType="NotContains" DefaultValue="7"    />
    </Filters>
  </data:SqlParameter>
</Parameters> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T12:59:23.497

您可以按照以下代码制作：

```
Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs)
If e.Row.RowType = DataControlRowType.DataRow Then
Dim x As String
x = e.Row.Cells(1).Text
Dim y As String
y = e.Row.Cells(8).Text
If Convert.ToInt32(x) <= Convert.ToInt32(y) Then
e.Row.ForeColor = System.Drawing.Color.Blue
End If
End If
End Sub 
```

# jquery - JQuery Image Slider图像未显示

> ID：13422242
> 
> 赞同：1
> 
> 时间：2012-11-16T18:20:56.360
> 
> 标签：jquery, image

我正在尝试使用 JQuery 创建一个图像滑块（我被告知这是实现此目的的“正确”方法。”我在项目根文件夹下有以下带有图像的代码，但它没有显示？不确定为什么？

```
<head runat="server">
<title></title>
<asp:ContentPlaceHolder ID="head" runat="server">
    <script src="../App_Themes/Project/jquery-1.8.2.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var imgs = [
    'myImage.png'];
        var cnt = imgs.length;

        $(function () {
            setInterval(Slider, 3000);
        });

        function Slider() {
            $('#imageSlide').fadeOut("slow", function () {
                $(this).attr('src', imgs[(imgs.length++) % cnt]).fadeIn("slow");
            });
        }
    </script>
</asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <img id="imageSlide" alt="" src="" />
    </div>
    <asp:ContentPlaceHolder ID="Content" runat="server">
    </asp:ContentPlaceHolder>
    </form>
</body>
</html> 
```

此外，我希望箭头允许导航每个图像 - 我仍然在正确的路径上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:38:07.753

您的 javascript 在页面加载之前执行，因此它所附加的元素尚不存在。[$(document).ready()](http://api.jquery.com/ready/)是一个很好的函数，用于延迟 javascript 的执行，直到页面完成加载。

编辑：关于箭头，我认为最好在一个单独的问题中提出，并提供更多详细信息。

EDIT2：JsFiddle 示例：http: [//jsfiddle.net/nTCJp/](http://jsfiddle.net/nTCJp/)

```
 $(document).ready(function() {
    // Handler for .ready() called. 
    var imgs = ['http://static.jquery.com/files/rocker/images/logo_jquery_215x53.gif'];
    var cnt = imgs.length;
    setInterval(Slider, 3000);

    function Slider() {
        $('#imageSlide').fadeOut("slow", function() {
            $(this).attr('src', imgs[(imgs.length++) % cnt]).fadeIn("slow");
        });
    }
}); 
```

# php - 将破折号添加到 .number_format php 函数

> ID：13422244
> 
> 赞同：1
> 
> 时间：2012-11-16T18:21:11.523
> 
> 标签：php, function

我是使用 php 语言的新手，但通过测试和大量时间在互联网上搜索示例和教程已经学习了一段时间。有时我会被一项我自己似乎无法解决的任务难住。所以我要求有人至少在我当前的问题中指出正确的方向。

我需要能够在表单字段中添加我想要的任何字符，以显示我输入的结果。目前，模板使用下面的代码作为字段并只显示数字。我需要升级或更改它以允许我想要的任何角色。

这里是

```
.number_format($price, 0, '.', ',') 
```

我是否需要提供任何额外的信息，或者这会让任何人的齿轮转动？

非常感激。

# php - magento - 集成贝宝自适应支付（链式支付）

> ID：13422250
> 
> 赞同：0
> 
> 时间：2012-11-16T18:21:55.950
> 
> 标签：php, magento, paypal

我目前正在努力将 paypal 的链式支付方式集成到 magento 中。 [https://cms.paypal.com/ca/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_APIntro](https://cms.paypal.com/ca/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_APIntro)

支付流程是：买家支付卖家的贝宝账户 -> pp 自适应支付网关 -> 85% 进入卖家的贝宝，15% 进入网站的默认贝宝账户（买家不知道这种拆分）。

我已经有 api 函数需要 2 个贝宝账户（卖家和网站的默认值）和付款金额，我希望将其集成。

以前有没有人集成过自适应支付，或者指出我应该在哪里集成这个逻辑？我会覆盖 /app/code/core/Mage/paypal 中的功能之一吗？

我基本上需要获取当前购物车中的总成本，以及当前商店的贝宝电子邮件，并将其传递给我的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-16T11:38:45.813

首先，您需要为 magento 创建一个单独的付款方式，我建议您为其创建一个付款模块，然后您需要注册到 paypal 沙箱帐户。我附上了自适应支付集成的示例代码，还有一些有用的链接，用于流程它将如何工作

```
ini_set("track_errors", true);
//set PayPal Endpoint to sandbox
$sandbox="";
$API_AppID = XXXXXXXXXXXXXXXXXXX;//your adaptive payment app Id
//value for check sandbox enable or disable
$sandboxstatus=1;
if($sandboxstatus==1){
    $sandbox="sandbox.";
    $API_AppID="APP-80W284485P519543T";
}
$url = trim("https://svcs.".$sandbox."paypal.com/AdaptivePayments/Pay");
//PayPal API Credentials
$API_UserName = XXXXXXXXXXXXXXXXXXX;//TODO
$API_Password = XXXXXXXXXXXXXXXXXXX;//TODO
$API_Signature = XXXXXXXXXXXXXXXXXXX;//TODO 
//Default App ID for Sandbox    
$API_RequestFormat = "NV";
$API_ResponseFormat = "NV";

$bodyparams = array (
    "requestEnvelope.errorLanguage" => "en_US",
    "actionType" => "PAY",
    "currencyCode" => "USD",//currency Code
    "cancelUrl" => "",// cancle url
    "returnUrl" => "paymentsuccess",//return url
    "ipnNotificationUrl" => "paymentnotify"//notification url that return all data related to payment
);

$finalcart=array(
        array('paypalid'=>"partner1",'price'=>50),
        array('paypalid'=>"partner2",'price'=>50),
        array('paypalid'=>"partner3",'price'=>50),
        array('paypalid'=>"partner4",'price'=>50),
        array('paypalid'=>"partner5",'price'=>50)
      );

$i=0;
foreach($finalcart as $partner){
    $temp=array("receiverList.receiver($i).email"=>$partner['paypalid'],"receiverList.receiver($i).amount"=>$partner['price']);
    $bodyparams+=$temp; 
    $i++;
}

// convert payload array into url encoded query string
$body_data = http_build_query($bodyparams, "", chr(38));
try{
   //create request and add headers
   $params = array("http" => array( 
      "method" => "POST",
      "content" => $body_data,
      "header" => "X-PAYPAL-SECURITY-USERID: " . $API_UserName . "\r\n" .
                     "X-PAYPAL-SECURITY-SIGNATURE: " . $API_Signature . "\r\n" .
                     "X-PAYPAL-SECURITY-PASSWORD: " . $API_Password . "\r\n" .
                     "X-PAYPAL-APPLICATION-ID: " . $API_AppID . "\r\n" .
                     "X-PAYPAL-REQUEST-DATA-FORMAT: " . $API_RequestFormat . "\r\n" .
                     "X-PAYPAL-RESPONSE-DATA-FORMAT: " . $API_ResponseFormat . "\r\n"
   ));
   //create stream context
   $ctx = stream_context_create($params);
   //open the stream and send request
   $fp = @fopen($url, "r", false, $ctx);
   //get response
   $response = stream_get_contents($fp);
   //check to see if stream is open
   if ($response === false) {
      throw new Exception("php error message = " . "$php_errormsg");
   }
   //close the stream
   fclose($fp);
   //parse the ap key from the response
   $keyArray = explode("&", $response);
   foreach ($keyArray as $rVal){
       list($qKey, $qVal) = explode ("=", $rVal);
       $kArray[$qKey] = $qVal;
   }
   //set url to approve the transaction
   $payPalURL = "https://www.".$sandbox."paypal.com/webscr?cmd=_ap-payment&paykey=" . $kArray["payKey"];
   //print the url to screen for testing purposes
   If ( $kArray["responseEnvelope.ack"] == "Success") {
    echo '<p><a id="paypalredirect" href="' . $payPalURL . '"> Click here if you are not redirected within 10 seconds...</a> </p>';
    echo '<script type="text/javascript"> 
            function redirect(){
           document.getElementById("paypalredirect").click();
            }
            setTimeout(redirect, 2000);
              </script>';
   }
   else {
     echo 'ERROR Code: ' .  $kArray["error(0).errorId"] . " <br/>";
     echo 'ERROR Message: ' .  urldecode($kArray["error(0).message"]) . " <br/>";
  }
}
catch(Exception $e) {
    echo "Message: ||" .$e->getMessage()."||";
} 
```

您可能会忽略模块流程，但您可以按照设置沙箱帐户以进行贝宝付款的步骤进行操作，希望对您有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:19:50.143

您可能需要为此编写一个全新的支付模块。从我所看到的（我承认自从我详细查看它以来已经有一点点），当前 Magento 中的 PayPal 集成不支持链式支付。

如果需要，您仍然可以扩展现有的 PayPal 模块，但您需要编写 API 请求以相应地处理自适应支付调用。同样，没有任何现有函数可以在扩展模块中简单地覆盖。您只需要从一开始就创建自己的。

如果最新版本的 Magento 添加了一些自适应支付，那么我可能错了。如果是这种情况，您可能会在 /paypal 目录中看到直接引用它的内容，您可以研究其中的函数以查看可以用自己的函数覆盖的内容。也就是说，如果他们已经将自适应支付作为支付模块包含在内，那么您真的不需要在代码中对其进行自定义。

# tcl - tcl 设置数组列表产生重复

> ID：13422251
> 
> 赞同：1
> 
> 时间：2012-11-16T18:22:01.280
> 
> 标签：tcl

我正在生成一个 TCL 过程，它将返回一个开关下的设备数组列表。定义是一个读取的 XML 文件。使用递归过程解析生成的 XML 条目列表，并将设备属性放置在数组中。

然后将每个数组放在一个列表中并反射回调用者。我的问题是，当我打印出设备列表时，每次都会打印出添加到列表中的最后一个设备。列表的内容都是重复的。

注意：我使用的是在这里找到的优秀的 proc，'xml2list'。对不起，我忘了是谁提交的。

下面的代码说明了这个问题：

```
source C:/src/tcl/xml2list.tcl

# Read and parse XML file
set fh [open C:/data/tcl/testfile.xml r]
set myxml [read $fh]
set mylist [xml2list $myxml]

array set mydevice {}

proc devicesByName { name thelist list_to_fill} {
        global mydevice
        global set found_sw 0

        upvar $list_to_fill device_arr
        foreach switch [lindex $thelist 2] {

            set atts [lindex $switch 1]
            if { [lindex $switch 0] == "Switch" } {
                if { $name == [lindex $atts 3] } {
                    set found_sw 1
                    puts "==== Found Switch: $name ===="
                } else {
                    set found_sw 0
                }
            } elseif { $found_sw == 1 && [string length [lindex $atts 3]] > 0 } {

                set mydevice(hdr) [lindex $switch 0]
                set mydevice(port) [lindex $atts 1]
                set mydevice(name) [lindex $atts 3]
                set mydevice(type) [lindex $atts 5]
                puts "Device Found: $mydevice(name)"
                set text [lindex $switch 2]
                set mydevice(ip) [lindex [lindex $text 0] 1]

                lappend device_arr mydevice
            }
            devicesByName $name $switch device_arr
         }
    }

    #--- Call proc here

    # set a local array var and send to the proc
    set device_arr {}
    devicesByName "Switch1" $mylist device_arr

    # read out the contents of the list of arrays
    for {set i 0} {$i<[llength $device_arr]} {incr i} {
        upvar #0 [lindex $device_arr $i] temp
        if {[array exists temp]} {
            puts "\[$i\] Device: $temp(name)-$temp(ip)"
        }
    } 
```

XML 文件在这里：

```
<Topology>    
    <Switch ports="48" name="Switch1" ip="10.1.1.3">
        <Device port="1" name="RHEL53-Complete1" type="host">10.1.1.10</Device>
        <Device port="2" name="Windows-Complete1" type="host">10.1.2.11</Device>
   <Device port="3" name="Solaris-Complete1" type="host">10.1.2.12</Device>
    </Switch>
    <Switch ports="36" name="Switch2" ip="10.1.1.4">
        <Device port="1" name="Windows-Complete2" type="host">10.1.3.10</Device>
    </Switch>
    <Router ports="24" name="Router1" ip="10.1.1.2">
        <Device port="1" name="Switch1" type="switch">10.1.1.3</Device>
        <Device port="2" name="Switch2" type="switch">10.1.1.4</Device>
    </Router>
</Topology> 
```

如果我的代码块看起来很糟糕，请原谅。当我阅读它们时，我按照指示进行操作，但它看起来不正确。我无法修复它，所以还是发布了。

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:43:01.020

tcl 中的数组不是值。因此它们的行为不像常规变量。它们实际上是一些特殊的东西，比如文件句柄或套接字。

您不能将数组分配给这样的列表。正在做：

```
lappend device_arr mydevice 
```

只需将字符串附加`"mydevice"`到列表中`device_arr`。该字符串恰好是全局变量的名称，因此以后可以使用该字符串来访问该全局变量。

要建立一个键值数据结构，你想要的是一个[dict](http://www.tcl.tk/man/tcl/TclCmd/dict.htm)。您可以将 dict 视为具有偶数个元素的特殊列表，格式为：`{key value key value}`. 事实上，这种数据结构甚至在引入`dict`s 之前的非常旧版本的 tcl 上也有效，因为`foreach`tcl 中的循环可用于处理键值对。

所以你想要的是在`$mydevice`每个循环中创建一个新的 dict 并`[dict set]`用来分配值。

或者，您可以保留大部分代码并将 lappend 更改为：

```
lappend device_arr [array get mydevice] 
```

这是有效的，因为`[array get]`返回一个可以被视为字典的键值列表。您可以稍后使用该`dict`命令访问数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T20:47:41.797

数组变量不能用作值。要将其中的内容放入列表元素，将其发送到 proc，将其写入文件等，将其转换为列表形式（键、值、键、值...）`array get`。

```
lappend device_arr [array get mydevice] 
```

要稍后使用它，请将列表写回到带有`array set`.

```
foreach device_l $device_arr {
  #array unset device
  array set device $device_l
  puts "$device(name)-$device(ip)"
} 
```

请注意，`array set`不会删除目标数组中的旧键，因此如果您在循环中使用它并且键名并不总是相同，则需要在每次迭代时清除数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T06:48:58.540

您可以使用数组以两种方式存储此信息。第一个是多维数组，在这种情况下是一个三维数组，第二个是一个一维数组，存储一个列表，稍后可以轻松地将其转换为数组，以便以后访问数据。

对于 3d 数组，键是 Switch Name,device_port,dataname 您可以将错误的临时 myDevice 和 lappend 代码更改为

```
 # attr is a list of { attributename1 value1  ... attributenameN valueN}
  array set temp $attr
  set port $temp(port)
  set text [lindex $switch 2]
  set ip [lindex [lindex $text 0] 1]
  # name already set to "Switch1" etc
  foreach f [array names temp ] {
      set device_arr($name,$port,$f) $temp($f)
  } 
  set device_arr($name,$port,ip) $ip
  array unset temp 
```

此代码导致以下结果（当 parray device_arr

```
parray device_arr

device_arr(Switch1,1,name) "Switch1"
device_arr(Switch1,1,port)  1
device_arr(Switch1,1,type) "RedHat .."  
device_arr(Switch1,1,ip) 10..
device_arr(Switch1,2,name) "Switch1"
device_arr(Switch1,2,port)  1
device_arr(Switch1,2,type) "RedHat .."  
device_arr(Switch1,2,ip) 10..
...
device_arr(Switch2,1,name) "Switch1"
device_arr(Switch2,1,port)  1
device_arr(Switch2,1,type) "Windows Complete"  
device_arr(Switch2,1,ip) 10..
.... 
```

要查找 Switch1 端口 2 的 ip，您将：

```
puts "the ip of Switch1 port 2 is $device_arr(Switch1,2,ip)" 
```

请注意大量数据重复，但您可以直接访问所有数据，而无需像下一个方案中那样进入中间步骤来获取数据

```
 # attr is a list of { attributename1 value1  ... attributenameN valueN}
  set data $attr
  array set temp $attr
  set text [lindex $switch 2]
  set ip [lindex [lindex $text 0] 1]
  lappend data ip $ip 
   set key "$name,$temp(port)"
  # name already set to "Switch1" etc
  set device_arr($name,$port) $data
  array unset temp 
```

做一个 parray device_arr 给出：

```
device_arr(Switch1,1) {  port "1" name "RHEL53-Complete1" type "host" ip 10.1.1.10 }
device_arr(Switch1,2) {  port "2" name "Windows-Complete1" type "host" ip 10.1.2.11}
.... 
```

要找到 swtich1 端口 2 的 ip，你会

```
 array set temp $device_array(Switch1,2)
   puts "ip of device 2 is $temp(ip)" 
```

# javascript - 如何在 apex 中使用此代码从 oracle 连接我的数据库

> ID：13422252
> 
> 赞同：2
> 
> 时间：2012-11-16T18:22:04.610
> 
> 标签：javascript, html, css, oracle-apex

我正在使用 apex 4.0 并使用预制报告、HTML、jQuery JavaScript 和 CSS 在区域中构建报告，并且我想从我的 Oracle 数据库中检索数据。

如何从我的 Oracle 数据库中检索此代码中的数据？

```
 <a class="offline-button" href="../index.html">Back</a>
 <script src="#WORKSPACE_IMAGES#people.js" type="text/javascript"></script>

    <div id="example" class="k-content">
        <div id="clientsDb">

            <div id="grid" style="height: 380px"></div>

        </div>

        <style scoped>
            #clientsDb {
                width: 692px;
                height: 413px;
                margin: 30px auto;
                padding: 51px 4px 0 4px;
                background: url(#WORKSPACE_IMAGES#clientsDb.png) no-repeat 0 0;
            }
        </style>
        <script>
            $(document).ready(function() {
                $("#grid").kendoGrid({
                    dataSource: {
                        data: createRandomData(50),
                        pageSize: 10
                    },
                    groupable: true,
                    sortable: true,
                    pageable: {
                        refresh: true,
                        pageSizes: true
                    },
                    columns: [ {
                            field: "FirstName",
                            width: 90,
                            title: "First Name"
                        } , {
                            field: "LastName",
                            width: 90,
                            title: "Last Name"
                        } , {
                            width: 100,
                            field: "City"
                        } , {
                            field: "Title"
                        } , {
                            field: "BirthDate",
                            title: "Birth Date",
                            template: '#= kendo.toString(BirthDate,"dd MMMM yyyy") #'
                        } , {
                            width: 50,
                            field: "Age"
                        }
                    ]
                });
            });
        </script>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-07T23:30:45.527

有不同的方法可以做到这一点，但由于您的帖子中的信息很少，我将主要尝试回答您的问题，即“如何从 Oracle 数据库中检索数据”

```
<script language="JavaScript1.1" type="text/javascript">

function getYourDataTableList (narrowText, empSelect) //getYourDataTableList should be the table you would like to retrive

{  

  var empSelectObj = document.getElementFirstName(FirstName);

  var ajaxRequest = new htmldb_Get(null,&APP_ID.,'APPLICATION_PROCESS=getYourDataTableList ,0);

  ajaxRequest.add('P1_FirstName_NARROW',narrowText.value);

  ajaxResult = ajaxRequest.get();

  if(ajaxResult)

    {   

      empSelectObj.options.length = 0;

      var empArray = ajaxResult.split("~empsep~");

       for(var i=0; i < empArray.length; i++) {

        var colArray = empArray[i].split("~colsep~");

        empSelectObj.options[i] = new Option(colArray[1], colArray[0]);

      }

    }

    else

    {

      empSelectObj.options.length = 0;

    }

  ajaxRequest = null;   

}  

 </script> 
```

-- 代码不是测试器，也不是完整的功能 我建议你按照这个例子
[http://www.dba-oracle.com/t_html_db_apex_ajax_application_express.htm](http://www.dba-oracle.com/t_html_db_apex_ajax_application_express.htm)

还要考虑如果您使用的是 iFrame，您可能会遇到这个问题：（如果 iframe src 是与您的 visualforce 页面不同的服务器，则浏览器将不允许 javascript 访问内容，因为这将被视为跨站点脚本攻击。 )
**来源**： [http ://boards.developerforce.com/t5/Apex-Code-Development/How-we-get-the-if​​rame-data-in-apex-page-using-javascript/td-p/446781](http://boards.developerforce.com/t5/Apex-Code-Development/How-we-get-the-iframe-data-in-apex-page-using-javascript/td-p/446781)

# java - xjc：两个声明导致 ObjectFactory 类中的冲突

> ID：13422253
> 
> 赞同：24
> 
> 时间：2012-11-16T18:22:07.183
> 
> 标签：java, binding, xsd, schema, xjc

运行以下**xjc**命令会引发错误：

```
$ xjc "ftp://ftp.ncbi.nih.gov/bioproject/Schema/Core.xsd"
parsing a schema...
compiling a schema...
[ERROR] Two declarations cause a collision in the ObjectFactory class.
  line 340 of ftp://ftp.ncbi.nih.gov/bioproject/Schema/Core.xsd

[ERROR] (Related to above error) This is the other declaration.   
  line 475 of ftp://ftp.ncbi.nih.gov/bioproject/Schema/Core.xsd 
```

虽然我了解 JAXB 绑定以及 XJC 中的冲突是什么，但我不明白当前模式中的冲突在哪里。

我应该如何解决这个问题？

谢谢，

皮埃尔

更新：这是错误的上下文：

```
$ curl -s "ftp://ftp.ncbi.nih.gov/bioproject/Schema/Core.xsd" | sed 's/^[ \t]*//' | cat -n | egrep -w -A 10 -B 10 '(340|475)' 
   330  <xs:element maxOccurs="1" name="Description"
   331  type="xs:string" minOccurs="0">
   332  <xs:annotation>
   333  <xs:documentation>
   334  Optionally provide description especially when "eOther" is selected
   335  </xs:documentation>
   336  </xs:annotation>
   337  </xs:element>
   338  <xs:element name="BioSampleSet" minOccurs="0" maxOccurs="1"><xs:annotation><xs:documentation>Identifier of the BioSample when known</xs:documentation>
   339  </xs:annotation>
   340  <xs:complexType><xs:sequence><xs:element name="ID" maxOccurs="unbounded" type="xs:token"></xs:element>
   341  </xs:sequence>
   342  </xs:complexType>
   343  </xs:element>
   344  </xs:sequence>
   345  <xs:attribute name="sample_scope" use="required">
   346  <xs:annotation>
   347  <xs:documentation>
   348  The scope and purity of the biological sample used for the study
   349  </xs:documentation>
   350  </xs:annotation>
--
   465  <xs:documentation>Please,  fill Description element when choose "eOther"</xs:documentation>
   466  </xs:annotation>
   467  </xs:enumeration>
   468  </xs:restriction>
   469  </xs:simpleType>
   470  </xs:attribute>
   471  </xs:complexType>
   472  </xs:element>
   473  <xs:element name="TargetBioSampleSet">
   474  <xs:annotation><xs:documentation>Set of Targets references to BioSamples</xs:documentation></xs:annotation>
   475  <xs:complexType>
   476  <xs:sequence>
   477  <xs:element name="ID" type="xs:token" minOccurs="1" maxOccurs="unbounded"></xs:element>                                                 
   478  </xs:sequence>
   479  </xs:complexType>
   480  </xs:element>                        
   481  </xs:choice>
   482  <xs:element name="Method" minOccurs="1">
   483  <xs:annotation>
   484  <xs:documentation>
   485  The core experimental approach used to obtain the data that is submitted to archival databases 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-18T07:21:53.250

我将引用网上[关于 JAXB 的最官方的非官方指南](http://jaxb.java.net/guide/Dealing_with_errors.html#Two_declarations_cause_a_collision_in_the_ObjectFactory_class)。

> 当模式包含看起来相似的元素/类型名称时，它们可能会导致“两个声明导致 ObjectFactory 类中的冲突”错误。更准确地说，对于所有类型和许多元素中的每一种（确切地说，哪些元素获得了工厂，哪些没有，很难解释），XJC 在同一个包中的 ObjectFactory 类上生成一个方法。ObjectFactory 类是为 XJC 在其中生成一些文件的每个包创建的。方法的名称来源于 XML 元素/类型名称，如果两个元素/类型尝试生成相同的方法名称，则会报告错误。

也就是说，你有两个选择。

首先是像这样定义一个外部绑定 XML

```
<jaxb:bindings xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  version="1.0">
  <jaxb:bindings schemaLocation="Core.xsd">
    <jaxb:bindings node="//xs:element[@name='BioSampleSet']/xs:complexType">
      <jaxb:factoryMethod name="TypeBioSampleSet"/>
    </jaxb:bindings>
    <jaxb:bindings node="//xs:element[@name='TargetBioSampleSet']/xs:complexType">
      <jaxb:factoryMethod name="TypeTargetBioSampleSet"/>
    </jaxb:bindings>
  </jaxb:bindings>
</jaxb:bindings> 
```

在生成的`ObjectFactory`类中，这将创建两个名为`createTypeBioSampleSet`and的方法`createTypeTargetBioSampleSet`（JAXB 会将您指定的名称附加到单词`create`），可用于生成`BioSampleSet`和`TargetBioSampleSet`对象。

（不必为*这两种*类型定义绑定。）

我不确定为什么 JAXB 拒绝从给定模式生成类，但是当我只指定一个绑定（`BioSampleSet`例如）时，另一种类型的工厂方法被命名为，`createTypeProjectProjectTypeSubmissionWhateverThisAndThatTargetTargetSampleBioCatDogWoofTypeIDoNotKnowWhatElse`所以我认为 JAXB 被这个长方法标识符窒息，因为它以某种方式设法为两种类型创建了相同的。我认为这是 JAXB 中的一些实现细节。

另一种解决方案是为 a 创建一个基本类型`BioSampleSet`并在两个位置使用它

```
<xs:element name="ProjectTypeSubmission">

...

  <xs:element name="Target">

    ...

    <xs:element name="BioSampleSet" type="typeBioSampleSet" minOccurs="0" maxOccurs="1"/>

    ...

  </xs:element>

  ...

  <xs:element name="TargetBioSampleSet" type="typeBioSampleSet"/>

  ...

<xs:element/>

...

<xs:complexType name="typeBioSampleSet">
  <xs:sequence>
    <xs:element name="ID" maxOccurs="unbounded" type="xs:token"></xs:element>
  </xs:sequence>
</xs:complexType> 
```

最好的解决方案是从您的架构中删除每个匿名类型声明。如果你能做到这一点，那就去做吧，因为这个模式看起来很乱（至少对我来说）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-12-05T09:32:34.247

删除命令中的 -p 包

```
xjc -d src -XautoNameResolution TFMData_Service.xsd 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-02T09:07:16.053

我有同样的问题，对象工厂的冲突，我的解决方案是使用以下绑定：

```
<jaxb:bindings version="1.0"
               xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
               xmlns:xs="http://www.w3.org/2001/XMLSchema"
               xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
               jaxb:extensionBindingPrefixes="xjc">

    <jaxb:bindings
            schemaLocation="../pfel_xsd/pfel-mng-managedocument-v4-vs_data.xsd"
            node="/xs:schema">
        <jaxb:schemaBindings>
            <jaxb:package name="document.client.pfelservice"/>
        </jaxb:schemaBindings>
    </jaxb:bindings>

    <jaxb:bindings
            schemaLocation="../pfel_xsd/pfel-mng-managedocument-v4-vs_data-types.xsd"
            node="/xs:schema">
        <jaxb:schemaBindings>
            <jaxb:package name="document.client.pfel"/>
        </jaxb:schemaBindings>
    </jaxb:bindings>

</jaxb:bindings> 
```

这是解决方案：[https ://www.javaer101.com/en/article/1278220.html](https://www.javaer101.com/en/article/1278220.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-05T09:09:07.430

使用以下 Maven 插件时对我有用的解决方案是添加`-XautoNameResolution`

```
<groupId>org.codehaus.mojo</groupId>
<artifactId>jaxb2-maven-plugin</artifactId> 
```

示例代码：

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jaxb2-maven-plugin</artifactId>
            <version>2.5.0</version>
            <executions>
                <execution>
                    <id>xjc</id>
                    <goals>
                        <goal>xjc</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <xjbSources>
                    <xjbSource>src/main/resources/global.xjb</xjbSource>
                </xjbSources>
                <sources>
                    <source>src/main/xsd/</source>
                </sources>
                <arguments>
                    <argument>-XautoNameResolution</argument>
                </arguments>
                <packageName>com.xxx.yyy.zzz.policy.xml</packageName>
            </configuration>
        </plugin> 
```

# css - ipad屏幕搞砸了响应式设计

> ID：13422254
> 
> 赞同：0
> 
> 时间：2012-11-16T18:22:09.490
> 
> 标签：css, ipad, responsive-design

我有一个关于平板电脑响应式设计的问题：

目标是彼此下方有 2 或 3 个 div，高度为 100%，因此它们看起来像全屏页面。在 iPad 上访问我的响应式网站（正在进行中）时，一切看起来都很好。但是一旦你转动设备，一些不必要的边距就会开始出现，并且设备会放大内容。

我的问题：

这是正常的，还是我错过了几行代码？

编辑：忘记添加网站[http://www.danielsneijers.com/](http://www.danielsneijers.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:25:25.200

这是 iOS 的一个已知错误，有一个可用的解决方法：http: [//filamentgroup.com/lab/a_fix_for_the_ios_orientationchange_zoom_bug/](http://filamentgroup.com/lab/a_fix_for_the_ios_orientationchange_zoom_bug/)

在视口中设置最大比例可以解决这个问题，它还会禁用所有设备上的缩放，这对可访问性非常不利，并且意味着您的网站更有可能在未来的设备上出现问题。

# perl - 在 Perl 中扩展对象

> ID：13422256
> 
> 赞同：9
> 
> 时间：2012-11-16T18:22:13.640
> 
> 标签：perl, object

我有一个名为 RuleObject 的基础对象和一个继承自 RuleObjectString 的对象。我在 RuleObjectString 中有一个新方法，我想在使用该对象的代码中调用它。但我得到了错误。**“无法通过 ./testobject.pl 第 10 行的包“RuleObject”找到对象方法“比较”。**但我没有创建 RuleObject。我正在创建一个 RuleObjectString。我在这里做错了什么？

测试对象.pl

```
 1 #! /usr/bin/perl
  2
  3 use strict;
  4
  5 use RuleObjectString;
  6
  7 my $s = RuleObjectString->new();
  8 $s->value('stuff goes here');
  9
 10 if ($s->compare('stuff')){
 11         print "MATCH!\n";
 12 }else{
 13         print "no match :(\n";
 14 } 
```

规则对象.pm

```
package RuleObject;

our @ISA = qw/Exporter/;
our @EXPORT = qw/new/;

use strict;

sub new{
        my $class = shift;

        my $self;
        $self->{value} = undef;

        bless $self;
        return $self;
}

sub value{
        my $self = shift;
        my $value = shift;
        if ($value){
                $self->{value} = $value;
        }else{
                return $self->{value};
        }
} 
```

规则对象字符串.pm

```
package RuleObjectString;

our @ISA = qw/RuleObject/;
our @EXPORT = qw/compare/;

use strict;

sub compare{
        my $self = shift;
        my $compareto = shift;

        return $self->value() =~ /$compareto/;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-16T18:37:11.897

我认为 jmcneirney 是在正确的轨道上。在你的`RuleObject`构造函数中，你说

```
bless $self; 
```

这与

```
bless $self, __PACKAGE__; 
```

或者

```
bless $self, 'RuleObject' 
```

但是你想要的是对象被祝福为`RuleObjectString`. 所以你想做的是说

```
bless $self, $class 
```

现在

```
RuleObject->new()
RuleObjectString->new() 
```

都将调用相同的构造函数，但第一次调用返回的对象将被祝福为 a`RuleObject`而第二个对象将被祝福为 a `RuleObjectString`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T11:50:28.370

这是 2012 年，因此您应该考虑使用适当的 OOP 解决方案，而不是重新发明轮子。

通过使用[Moose](https://metacpan.org/release/Moose)，解决方案看起来像这样（未经测试）：

规则对象.pm

```
package RuleObject;
use Moose;

has 'value' => ( isa => 'Str', is => 'rw', required => 0, default => '' );

1; 
```

规则对象字符串.pm

```
package RuleObjectString;
use Moose;

extends 'RuleObject';

sub compare {
    my $self      = shift;
    my $compareto = shift;

    return $self->value =~ /$compareto/;
}

1; 
```

简单的！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:30:53.513

尝试转储对象，看看它是什么。

```
print Dumper( $s ) 
```

这将是一个 RuleObject。

您可能需要在 RuleObjectString 中定义一个 new() 并让它调用 Super::new()。

# java - 在 Java 中，整数如何在内部以位级别表示？

> ID：13422259
> 
> 赞同：86
> 
> 时间：2012-11-16T18:22:40.770
> 
> 标签：java, memory, binary, store, twos-complement

我试图了解 Java 如何在内部存储整数。我知道所有java原始整数都是有符号的（除了short？）。这意味着该数字在一个字节中可用的位减少了。

我的问题是，是否所有整数（正数和负数）都存储为二进制补码，或者只是二进制补码中的负数？

我看到规格说`x bit two's complement number`。但我经常感到困惑。

例如：

```
 int x = 15; // Stored as binary as is?  00000000 00000000 00000000 00001111?
  int y = -22; // Stored as two complemented value? 11111111 11111111 11111111 11101010 
```

**编辑**

要清楚，`x = 15`

```
 In binary as is: `00000000 00000000 00000000 00001111'
  Two's complement: `11111111 11111111 11111111 11110001` 
```

因此，如果您的答案是 `all`数字存储为二进制补码，那么：

```
 int x = 15; // 11111111 11111111 11111111 11110001
  int y = -22 // 11111111 11111111 11111111 11101010 
```

这里的混乱再次是标志说，两者都是负数。可能是我误读/误解了吗？

**编辑** 不确定我的问题是否令人困惑。被迫隔离问题：

**我的问题正是：正数存储在，`binary as is`而负数存储为`two's complement`？**

有人说所有都存储在二进制补码中，一个答案说只有负数存储为二进制补码。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-11-16T18:36:48.533

让我们从总结 Java 原始数据类型开始：

**byte**：字节数据类型是一个 8 位有符号**二进制补码整数**。

**Short**： Short 数据类型是一个 16 位有符号**二进制补码整数**。

**int：** Int 数据类型是 32 位有符号**二进制补码整数**。

**long：** Long 数据类型是 64 位有符号**二进制补码整数**。

**float：** Float 数据类型是单精度**32 位 IEEE 754 浮点数**。

**double** : double 数据类型是双精度**64 位 IEEE 754 浮点数**。

**boolean：**布尔数据类型代表**一位信息**。

**char：** char 数据类型是**单个 16 位 Unicode 字符**。

[资源](http://www.tutorialspoint.com/java/java_basic_datatypes.htm)

**二进制补码**

“一个很好的例子来自[wiki](http://en.wikipedia.org/wiki/Two%27s_complement)，通过注意 256 = 255 + 1 来实现与二进制补码的关系，并且 (255 - x) 是 x 的补码

0000 0111=7 二进制补码是 1111 1001= -7

它的工作方式是 MSB（最高有效位）接收负值，因此在上述情况下

> -7 = 1001= -8 + 0+ 0+ 1

正整数通常存储为简单的二进制数（1 是 1，10 是 2，11 是 3，依此类推）。

负整数存储为其绝对值的二进制补码。当使用此符号时，正数的二进制补码是负数。

[资源](https://stackoverflow.com/questions/794062/is-twos-complement-notation-of-a-positive-number-the-same-number)

由于我得到了这个答案的几点，我决定向它添加更多信息。

## **更详细的答案：**

除其他外，有四种主要方法可以用二进制表示正数和负数，即：

1.  有符号的幅度
2.  一个人的补充
3.  二进制补码
4.  偏见

**1\. 有符号数**

用最高位表示符号，其余位表示绝对值。其中**0**代表**正数**，**1**代表**负数**，例如：

```
1011 = -3
0011 = +3 
```

这种表示更简单。但是，您不能像添加十进制数一样添加二进制数，这使得在硬件级别上实现起来更加困难。此外，这种方法使用两个二进制模式来表示 0、**-0 (1000)**和**+0 (0000)**。

**2.补码**

在这种表示中，我们反转给定数字的所有位以找出它的互补。例如：

```
010 = 2, so -2 = 101 (inverting all bits). 
```

这种表示的问题是仍然存在两个位模式来表示 0，**负 0（1111）**和**正 0（0000）**

**3\. 补码**

为了找到一个数字的负数，在这个表示中，我们反转所有位，然后添加一位。添加一位解决了两个位模式表示 0 的问题。在这种表示中，我们只有一个 **0 (0000)**模式。

例如，我们想使用 4 位找到 4（十进制）的二进制负表示。首先，我们将 4 转换为二进制：

```
4 = 0100 
```

然后我们反转所有位

```
0100 -> 1011 
```

最后，我们加一点

```
1011 + 1 = 1100. 
```

因此，如果我们使用 4 位的二进制补码表示，则 1100 相当于十进制的 -4。

找到互补的更快方法是将第一位固定为值 1 并将其余位取反。在上面的示例中，它将类似于：

```
0100 -> 1100
^^ 
||-(fixing this value)
|--(inverting this one) 
```

二进制补码表示，除了只有一种表示 0 外，它还以与十进制相同的方式将两个二进制值相加，不同符号的偶数。然而，有必要检查溢出情况。

**4\. 偏见**

此表示用于表示 IEEE 754 规范中浮点的指数。它的优点是所有位为零的二进制值代表最小值。所有位为 1 的二进制值代表最大值。顾名思义，该值以二进制编码（正或负），n 位带有偏差（通常为 2^(n-1) 或 2^(n-1)-1）。

因此，如果我们使用 8 位，十进制中的值 1 使用 2^(n-1) 的偏差以二进制表示，值如下：

```
+1 + bias = +1 + 2^(8-1) = 1 + 128 = 129
converting to binary
1000 0001 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-11-16T18:39:45.940

Java 整数是 32 位的，并且总是有符号的。这意味着，最高有效位 (MSB) 用作符号位。an 表示的整数`int`不过是位的加权和。权重分配如下：

```
Bit#    Weight
31      -2^31
30       2^30
29       2^29
...      ...
2        2^2
1        2^1
0        2^0 
```

请注意，MSB 的权重是负数（实际上可能是最大的负数），因此当该位打开时，整数（加权和）变为负数。

让我们用 4 位数字来模拟它：

```
Binary    Weighted sum            Integer value
0000       0 + 0 + 0 + 0           0
0001       0 + 0 + 0 + 2^0         1
0010       0 + 0 + 2^1 + 0         2
0011       0 + 0 + 2^1 + 2^0       3
0100       0 + 2^2 + 0 + 0         4
0101       0 + 2^2 + 0 + 2^0       5
0110       0 + 2^2 + 2^1 + 0       6
0111       0 + 2^2 + 2^1 + 2^0     7 -> the most positive value
1000      -2^3 + 0 + 0 + 0        -8 -> the most negative value
1001      -2^3 + 0 + 0 + 2^0      -7
1010      -2^3 + 0 + 2^1 + 0      -6
1011      -2^3 + 0 + 2^1 + 2^0    -5
1100      -2^3 + 2^2 + 0 + 0      -4
1101      -2^3 + 2^2 + 0 + 2^0    -3
1110      -2^3 + 2^2 + 2^1 + 0    -2
1111      -2^3 + 2^2 + 2^1 + 2^0  -1 
```

所以，二进制补码并不是表示负整数的唯一方案，而是我们可以说整数的二进制表示总是相同的，我们只是否定最高有效位的权重。该位确定整数的符号。

在 C 中，有一个关键字`unsigned`（在 java 中不可用），可用于声明`unsigned int x;`. 在无符号整数中，MSB 的权重是正数 ( `2^31`) 而不是负数。在这种情况下， an 的范围`unsigned int`是`0`to `2^32 - 1`，而 an 的`int`范围`-2^31`是 to `2^31 - 1`。

从另一个角度来看，如果您考虑`x`as `~x + 1`(NOT x plus one) 的二进制补码，以下是解释：

对于任何`x`,`~x`只是 的按位倒数`x`，所以凡`x`有`1`-bit 的地方，`~x`都会有`0`-bit （反之亦然）。所以，如果你把这些加起来，加法中不会有进位，总和只是一个整数，其中的每一位都是`1`。

对于 32 位整数：

```
x + ~x = 1111 1111 1111 1111 1111 1111 1111 1111
x + ~x + 1 =   1111 1111 1111 1111 1111 1111 1111 1111 + 1
           = 1 0000 0000 0000 0000 0000 0000 0000 0000 
```

最左边的`1`位将被丢弃，因为它不适合 32 位（整数溢出）。所以，

```
x + ~x + 1 = 0
-x = ~x + 1 
```

所以你可以看到负数`x`可以用 表示`~x + 1`，我们称之为 的补码`x`。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-16T18:36:36.930

我已经运行了以下程序来了解它

```
public class Negative {
    public static void main(String[] args) {
        int i =10;
        int j = -10;

        System.out.println(Integer.toBinaryString(i));
        System.out.println(Integer.toBinaryString(j));
    }
} 
```

输出是

```
1010
11111111111111111111111111110110 
```

从输出来看，它似乎一直在使用二进制补码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-16T18:35:49.067

Oracle 提供了一些您可能会感兴趣的有关 Java[数据类型的文档。](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)具体来说：

> int：int 数据类型是一个 32 位有符号二进制补码整数。它的最小值为 -2,147,483,648，最大值为 2,147,483,647（含）。

顺便说一句，short 也存储为二进制补码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-02-12T13:23:02.310

> 正数按原样存储/检索。

```
e.g) For +ve number 10; byte representation will be like 0-000 0010 
                                               (0 - MSB will represent that it is +ve).
So while retrieving based on MSB; it says it is +ve, 
so the value will be taken as it is. 
```

> 但负数将存储在 2 的补码之后（MSB 位除外），MSB 位将设置为 1。

例如）当存储 -10 时

```
 0-000 0010  -> (1's complement) -> 0-111 1101 
              -> (2's complement) 0-111 1101 + 1 -> 0-111 1110
  Now MSB will be set to one, since it is negative no -> 1-111 1110 
```

检索时，发现MSB设置为1。所以它是负数。除 MSB 外，将执行 2 的补码。

```
 1-111 1110  --> 1-000 0001 + 1 --> 1-000 0010
  Since MSB representing this is negative 10 --> hence  -10 will be retrived. 
```

> 铸件

另请注意，当您将 int/short 转换为字节时，只会考虑最后一个字节以及最后一个字节 MSB，

以“-130”短为例，它可能存储如下

```
(MSB)1-(2's complement of)130(1000 0010) --> 1-111 1111 0111 1110 
```

现在字节转换采用最后一个字节，即 0111 1110。（0-MSB）由于 MSB 表示它是 +ve 值，因此将按原样采用。这是126。（+ ve）。

再举个例子“130”短，它可能像下面这样存储

```
 0-000 000 1000 0010     (MSB = 0) 
```

现在字节转换采用最后一个字节，即 1000 0010 。(1=MSB) 由于 MSB 表示它是 -ve 值，因此将执行 2 的补码并返回负数。所以在这种情况下 -126 将被返回。

```
 1-000 0010  -> (1's complement) -> 1-111 1101 
             -> (2's complement) 1-111 1101 + 1 -> 1-111 1110 -> (-)111 1110
               = -126 
```

> (int)(char)(byte) -1 AND (int)(short)(byte) -1 之间的差异

```
(byte)-1       -> 0-000 0001 (2's Comp) -> 0-111 1111 (add sign) -> 1-111 1111
(char)(byte)-1 -> 1-111 1111 1111 1111  (sign bit is carry forwarded on left) 
```

相似地

```
(short)(byte)-1-> 1-111 1111 1111 1111  (sign bit is carry forwarded on left) 
```

但

```
(int)(char)(byte)-1 -> 0-0000000 00000000 11111111 11111111  = 65535
since char is unsigned; MSB won't be carry forwarded. 
```

和

```
(int)(Short)(byte)-1 -> 1-1111111 11111111 11111111 11111111 = -1
since short is signed; MSB is be carry forwarded. 
```

> 参考

[为什么用二进制补码表示负数？](https://stackoverflow.com/questions/1125304/why-is-twos-complement-used-to-represent-negative-numbers)

[什么是“2的补码”？](https://stackoverflow.com/questions/1049722/what-is-2s-complement)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-16T18:34:23.527

根据[this document](http://duke.csc.villanova.edu/jss/webBonuses/primitiveStorage/primitiveStorage.pdf)，所有整数都以java的二进制补码格式进行签名和存储。不确定它的可靠性..

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-16T18:51:32.727

最高有效位（第 32 位）表示该数字是正数还是负数。如果为 0，则表示该数为正数，并以其实际二进制表示形式存储。但如果为 1，则表示该数为负数，并以二进制补码表示形式存储。因此，当我们将权重 -2^32 赋予第 32 位，同时从其二进制表示中恢复整数值时，我们得到了实际答案。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-01-09T14:01:20.070

谢谢你，**dreamcrash**的答案[https://stackoverflow.com/a/13422442/1065835](https://stackoverflow.com/a/13422442/1065835)；在[wiki 页面上，](http://en.wikipedia.org/wiki/Two%27s_complement#Converting_to_two.27s_complement_representation)他们给出了一个示例，帮助我了解如何找出正数的负数对应物的二进制表示。

> 例如，使用 1 个字节（= 2 个半字节 = 8 位），十进制数 5 表示为
> 
> 0000 01012 最高有效位为 0，因此该模式表示非负值。要以二进制补码表示法转换为 -5，请反转位；0变成1，1变成0：
> 
> 1111 1010 此时，数字是十进制值 -5 的反码。为了获得二进制补码，将 1 添加到结果中，给出：
> 
> 1111 1011 结果是一个有符号二进制数，表示二进制补码形式的十进制值 -5。最高有效位为 1，因此表示的值为负数。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-07T06:59:52.333

正数直接存储为二进制。负数需要 2 的补码。

例如：

15：00000000 00000000 00000000 00001111
-15：11111111 11111111 11111111 11110001

这是有符号位的差异。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-27T17:14:14.220

对于正整数 2' 补码值与 MSB 位 0 相同`(like +14 2'complement is 01110)`。

仅对于负整数，我们正在计算 2'complement value `(-14= 10001+1 = 10010)`。

所以最终的答案是这两个值`(+ve and -ve)`都只以 2' 补码形式存储。

# html - 为什么我在本地或内网部署时不能使用 HTML5？

> ID：13422261
> 
> 赞同：0
> 
> 时间：2012-11-16T18:22:44.600
> 
> 标签：html, internet-explorer, internet-explorer-8, internet-explorer-7, intranet

我有一个使用[Twitter Bootstrap](http://twitter.github.com/bootstrap/)的 ASP.NET 站点，当我在本地运行时一切看起来都很棒，但是当我在本地部署或部署到我们的测试环境时，所有 HTML5 元素似乎都被忽略了。我有一个 DOCTYPE 应该允许我使用 HTML5：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:22:44.600

默认情况下，IE 会检查网站是否在您的 Intranet 中，以便它可以将 Intranet 安全应用于您的浏览。另一个很棒的功能是它默认将文档兼容模式设置为 IE7 用于 Intranet 站点 - 而 IE7 在 HTML5 方面并不出色。如果您按 F12 并拉起开发人员工具（顶部的文档模式），您可以看到这一点。

所以，好消息是，这只是 Intranet 中的一个问题——一旦你部署到生产服务器，你应该不会再遇到这个问题了。坏消息是，当这种行为生效时，很难进行正确的测试。

当然，您可以更改 IE 设置以不自动检测 Intranet 站点。但是，对于更具可扩展性的解决方案，您可以在页面中包含此元标记以强制使用更高的兼容性模式：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

参考[本文](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx)评论。

# jquery - Jquery在响应式模板中调整图像大小不适用于Iphone

> ID：13422270
> 
> 赞同：0
> 
> 时间：2012-11-16T18:23:19.320
> 
> 标签：jquery, resize

在响应式模板中，我有一些 jquery 代码来计算与屏幕尺寸成比例的图像高度。它适用于所有浏览器，但在 Iphone/Ipad 上，当我从纵向更改为横向时，图像不会调整大小，这是代码，希望有人能帮助我！谢谢

> // 调整正文大小 $(document).ready(function() { var bodywidth = $(document).width(); var ratioheight = (bodywidth/3.582); $("#gallery").height(ratioheight) ; });
> 
> // 用于调整主体大小 $(window).resize(function() { var bodywidth = $(document).width(); var ratioheight = (bodywidth/3.582); $("#gallery").height(ratioheight ); });

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:25:51.730

你在使用 jQuery 手机吗？如果是这样，则有一个检测方向变化的事件称为`orientationchange`

或者取自[检测视口方向，如果方向是纵向显示警告消息，建议用户使用说明](https://stackoverflow.com/questions/4917664/detect-viewport-orientation-if-orientation-is-portrait-display-alert-message-ad)

```
window.addEventListener("orientationchange", function() {
  // Announce the new orientation number
  alert(window.orientation);
}, false); 
```

实际上，您的代码应该是这样的

```
$(window).bind('orientationchange resize', function(event){
      if(event.orientation) {
            if(event.orientation == 'portrait') {
          // do something
              } else if (event.orientation == 'landscape') {
                       // do something else 
                       } 
            } else {
                  // optional... PC-version javascript for example
                  }

      }); 
```

# c++ - 为什么我可以选择*不*在运行中调用 Concurrency::agent::done？

> ID：13422278
> 
> 赞同：4
> 
> 时间：2012-11-16T18:23:44.513
> 
> 标签：c++, visual-c++, concurrency, concurrency-runtime, concrt

这是在 Microsoft C++ 并发 API 的上下文中。

有一个名为`agent`（在`Concurrency`命名空间下）的类，它基本上是您派生和实现纯虚拟的状态机`agent::run`。

现在，调用 是您的责任`agent::start`，这会将其置于*可运行*状态。然后调用`agent::wait`* 或其任何变体来实际执行该`agent::run`方法。

但是为什么我们必须`agent::done`在体内呼唤呢？我的意思是，显而易见的答案是`agent::wait`* 将等到发出完成信号或超时已经过去，但是......

设计师的意图是什么？为什么代理`agent::run`返回时不进入完成状态？这就是我想知道的。为什么我可以选择不打电话`done`？如果超时已过，wait 方法会抛出异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:14:35.583

我能看到的唯一原因是它会让你声明你是`done()`，然后做更多你不希望你的消费者等待的工作（比如清理）。

现在，他们本可以这样做：

```
private: void agent::do_run() {
  run();
  if (status() != agent_done)
    done();
} 
```

然后让他们的框架调用`do_run()`而不是`run()`直接调用（或等效的）。

但是，您会注意到您自己可以执行此操作。

```
class myagent: public agent {
protected:
  virtual void run() final override { /* see do_run above, except call do_run in it */ }
  virtual void do_run() = 0;
}; 
```

和噗，如果你`do_run()`调用失败`done()`，包装函数会为你做。如果第二个虚函数开销对您来说太高：

```
template<typename T>
class myagent: public agent {
private:
  void call_do_run()
  {
    static_cast<T*>(this)->do_run();
  }
protected:

  virtual void run() final override { /* see do_run above, but call_do_run() */ }
}; 
```

让您进行编译时调度的 CRTP。采用：

```
class foo: public myagent<foo>
{
public:
  void do_run() { /* code */ }
}; 
```

... /耸耸肩

# git - git cherry-pick 多个提交

> ID：13422280
> 
> 赞同：7
> 
> 时间：2012-11-16T18:23:57.353
> 
> 标签：git

> **可能重复：**
> [如何挑选一系列提交并合并到另一个分支](https://stackoverflow.com/questions/1994463/how-to-cherry-pick-a-range-of-commits-and-merge-into-another-branch)

我想从一个分支中挑选 19 个提交并将它们应用到另一个分支。所有提交都是顺序的（提交 1，提交 2 ... 提交 19），并且最后一次提交不是最近的提交（即，在它之后还有其他提交，我不想应用其更改）。如何在不`git cherry-pick`为每次提交输入的情况下将更改应用到分支？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T19:59:27.997

> git cherry-pick $from_sha..$to_sha

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:06:39.643

一种手动完成的方法（无需采摘樱桃）

* * *

从提交所在的分支的头部创建一个新分支`git branch newB`

将此新分支硬重置为最后一次提交`git reset --hard <shaID of Commit19>`

*方法一*

在第一次提交之前直接对提交进行混合重置`git reset --mixed <shaId of the mentioned commit>`

在这个“修改过的”代码上做一个隐藏，只有提交 1 到 19`git stash`

转到您要应用此手动樱桃采摘的地方并弹出`git checkout <dstBranch>`&&`git stash pop`

*方法2*（此方法将保留提交消息）

在第一次提交之前对提交进行硬重置`git reset --hard <shaId of the mentioned commit>`

与 reflogs 先前的状态进行压缩合并`git merge --squash HEAD@{1}`

现在您将看到提交 1 - 19 将被编入索引，如果您进行提交，则提交消息将预先填充所有单独的提交消息...允许您根据需要修改消息

既然您已经提交了，请在您想要的地方挑选这个提交。它的好处是拥有所有想要的提交消息。

*完成后* 删除临时分支以摆脱您为进行内部选择所做的所有垃圾`git branch -D newB`

# php - 在 Zend Framework 中，我如何运行另一个操作并在变量中获取它的视图输出

> ID：13422291
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:25:38.237
> 
> 标签：php, model-view-controller, zend-framework, zend-controller

如果有更好的方法来构建它以实现我的目标，欢迎您提出想法。

我有一个 CMS，用户可以在其中编辑页面（侧边栏、标题等），这些都在 IndexController 中完成。

有些页面需要自己的控制器，例如 ContactController。但是，我希望它们同样可定制。

我可以从 IndexController::IndexAction 运行 NewsletterController::IndexAction 并以字符串形式获取视图输出吗？我不只是想渲染视图文件，我也想运行 Action 中的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:46:27.257

您所问的在技术上是可行的（在 ZF1 中），但这通常不是一个好主意。启动 ZF 操作会涉及一定程度的开销，因此您不希望多次执行此操作以服务单个请求。它还使您的应用程序更难调试。谷歌“zend framework actionstack”以获得关于这个主题的更多讨论。

你想做什么可能可以用视图助手来解决。例如，如果您想从 NewsletterController::IndexAction 获得一个时事通讯订阅表单，则创建一个视图助手来输出此表单。这个视图助手输出的表单仍然可以提交给 NewsletterController，但是你得到的会更快、更干净、更容易测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:31:41.520

**菜鸟方式但是**：在使用 Zend URL View Helper 构建 URL 时，您是否尝试过 file_get_contents() 或 cURL

# javascript - 在循环上使用逻辑运算符会导致矛盾

> ID：13422292
> 
> 赞同：1
> 
> 时间：2012-11-16T18:25:44.743
> 
> 标签：javascript, jquery, regex, for-loop, logical-operators

我正在处理 JavaScript 中一个非常非常奇怪的问题。我正在开发一个验证器脚本，该脚本使用 jQuery 循环遍历字段列表。每个验证都与对象上的正则表达式相关联，如下所示：

```
var 格式 = {

      电子邮件：/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+ \/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\. )+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/g,

      电话：/(?!:\A|\s)(?!(\d{1,6}\s+\D)|(((\d{1,2}\s+){2,2}))( ((\+\d{1,3})|(\(\+\d{1,3}\)))\s*)?((\d{1,6})|(\(\d {1,6}\)))\/?(([ -.]?)\d{1,5}){1,5}((\s*(#|x|(ext)))\.? \s*)\d{1,5})?(?!:(\Z|\w|\b\s))/gm,

      数字：/(\d+)(((.|,)\d+)+)?/g,

      网址：/^((http\:\/\/|https\:\/\/|ftp\:\/\/)|(www.))+(([a-zA-Z0-9\.- ]+\.[a-zA-Z]{2,4})|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1 ,3}\.[0-9]{1,3}))(\/[a-zA-Z0-9%:\/-_\\?\.'~]*)?$/gi

    };

```

然后我创建了一个函数，它给定两个参数，格式和测试主体，返回`true`或`false`（仅仅是`test`RegExp 对象的方法的包装）：

```
validy.is = 函数（什么，str）{
    返回格式[what].test(str);
};

```

在一个 jQuery 集合上，我的`INPUT`元素具有根据每种格式命名的类：

```
<input type="text" class="field email" id="field-1-1" />
<input type="text" class="field phone" id="field-1-2" />
...

```

然后，我的验证功能是这样的：

```
    formBuilder.validate = function() {
      console.info("=== 开始验证 ===");

      var isValid = true;
      var allFields = $(".field", formBuilder.form).toArray();
      var validable = ["电子邮件","电话","数字","url"];

      变量错误 = {
        "email": "Debés ingresar una dirección de e-mail válida (por ejemplo: juanperez@gmail.com)。",
        "电话": "Debés ingresar un número de teléfono válido.",
        "numeric": "Debés ingresar un número.",
        "url": "Debés ingresar una dirección Web válida (por ejemlo: www.misitio.com.ar)。"
      };

      for (var f = 0; f < allFields.length; f++) {

        var $field = $(allFields[f]);

        控制台信息（$字段）；
        console.info("--> 字段有类：" + $field.attr("class"));

        for (var v = 0; v < validable.length; v++) {

          var 有效类 = 有效[v];

          if ($field.hasClass(validableClass)) {

            console.info("--> 验证 " + validableClass + " 值 <<" + $field.val() + ">>");
            console.info("--> 测试结果：validy.is(validableClass, $field.val()) = " + vw.validy.is(validableClass, $field.val()));
            console.info("--> isValid 的最后一个值 = " + isValid);

            isValid = isValid && (validy.is(validableClass, $field.val()) ? true : false);

            console.info("--> isValid 的值现在是 = " + isValid);
            休息;

          };

        }

        console.info("** isValid 状态：" + isValid + " **");

        如果（！isValid）{

          console.info("--> 检测到无效字段");
          //vw.popoverError($field, "Error", errors[validableClass]);
          休息;

        };

      };

      返回是有效的；

    };

```

它的问题是，即使字段值有效，并且`isValid == true`在执行`isValid == isValid && ...`操作时，`isValid`最终还是`false`.

表达式怎么可能`true && true`抛出`false`。

我知道一定有一些我看不到的愚蠢，但我似乎找不到。有人可以帮忙吗？

谢谢！

**更新 1**

最初，该行：

`isValid = isValid && (validy.is(validableClass, $field.val()) ? true : false);`

曾是

`isValid &= validy.is(validableClass, $field.val();`

**更新 2**

在某些时候，显然该`test`方法正在返回`1`or`0`而不是`true`or `false`。但我无法确定它发生的确切时间。

**更新 3**

因此，事实证明我在滥用`&=`评论中提到的运算符。但...

`isValid = isValid && validy.is(validableClass, $field.val());`

...返回`false`时`isValid == true`并独立`validy.is`返回`true`。

**更新 4**

`validy.is`根据 CaffGeek 的回答更改了定义：

```
    validy.is = 函数（什么，str）{

      返回 !!formats[what].test(str);

    };

```

不幸的是，它没有效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T18:57:24.133

我经常使用 !!variable 来确保变量存在并且它具有正值。

如果未定义或为假，!!variable 将返回假，如果已定义且为真或有值（非 0），则返回真

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:59:00.040

尝试改变

```
validy.is = function(what, str) {
    return formats[what].test(str);
}; 
```

为此，以确保它是一个布尔结果。

```
validy.is = function(what, str) {
    return !!formats[what].test(str);
}; 
```

我没有对此进行测试，但是您不需要使用 jQuery 的所有循环。它是基于设置的。您可以通过这种方式简化您的代码。

```
formBuilder.validate = function() {
    console.info("=== STARTING VALIDATE ===");

    var isValid = true;
    var allFields = $(".field", formBuilder.form).toArray();
    var validable = ["email", "phone", "numeric", "url"];

    var errors = {
        "email": "Debés ingresar una dirección de e-mail válida (por ejemplo: juanperez@gmail.com).",
        "phone": "Debés ingresar un número de teléfono válido.",
        "numeric": "Debés ingresar un número.",
        "url": "Debés ingresar una dirección Web válida (por ejemplo: www.misitio.com.ar)."
    };

    var failedFields = $('EMPTYJQUERYSET');

    $.each(validable, function(index, className) {
        failedFields.add(
            allFields.filter('.' + className).filter(function(index) {
                return ! validy.is(validableClass, $(this).val());
            });
        );
    });

    isValid = !!(failedFields.length == 0);

    console.info("** Status of isValid: " + isValid + " **");

    if (!isValid) {
        console.info("--> Invalid field detected");
        //vw.popoverError($field, "Error", errors[validableClass]);
        break;
    };

    return isValid;
}; 
```

# javascript - 如果禁用父元素，则防止子元素上的单击事件

> ID：13422298
> 
> 赞同：1
> 
> 时间：2012-11-16T18:25:56.550
> 
> 标签：javascript, jquery, jeditable

我已经构建了一个相当复杂的 UI，我希望能够禁用它的一部分，以便除一个（重新启用按钮）之外的所有子元素都不可点击。

我正在向父级添加一个**禁用** `class`并在父级上设置一个侦听器来检查点击，但是由于子元素事件没有被委托，它们在父级的点击处理程序之前触发，所以我无法停止冒泡.

据我了解，使用捕获阶段并不是一个真正的选择，那么还有另一种方法吗？

我不想在顶部添加一个新的 HTML 元素（覆盖），因为我需要能够单击父级内部的按钮来删除禁用状态。

我是否应该重写所有子元素单击处理程序以改用委托，因此只有父元素正在侦听单击事件？

[更新更多解释和示例代码] 我有一个动态加载的面板，在我的网站的每个部分都不同。加载后，将运行特定于页面的脚本以将事件连接到面板中的各种元素。这包括链接和表单，以及 jeditable 元素（它们只是 DOM 中的常规跨度。）示例 HTML：

```
<div class="infoPanelContent" id="detailSection">
<h1><span>
    Details 
    <a class="sprite-icons flag" title="Flag" data-recordid="123123" href="/tickets/flag">Flag</a>
</span></h1>
<ul class="flexCol">
    <li>
        <h3>Status:</h3>
        <span id="setStatus">
            <span data-recordid="123123" data-projectid="104824" id="status" class="editWithSelect" title="Click to edit...">Open</span>
            <input type="text" class="hidden" maxlength="50" placeholder="New Status">
        </span>
    </li>
</ul>

<!-- Responsiblity -->
<h1><span>
    Responsibility</span>
    <a data-orientation="left" title="Add people" href="/tickets/responsible?r=123123" class="toggleAddNew sprite-buttons iconAdd">Add people</a>
</h1>
<ul class="singleCol">
    <li>
        <p>Mel L.</p>
        <a class="sprite-buttons iconRemove" data-itemid="432432" data-recordid="123123" data-projectid="104824" href="/tickets/delete-responsible">Delete</a>
    </li>
</ul>
<h1>
<span>Attachments</span>
<a data-orientation="left" title="Add attachments" href="/tickets/attachments?r=123123" class="toggleAddNew sprite-buttons iconAdd">Add attachments</a>
</h1>
<ul class="singleCol attachments">
    <li>
        <p><a target="_blank" href="http://www.test.com"><span class="sprite-icons iconFiletypeIMG"></span><em>Sample (60 KB)</em></a></p>
    </li>
</ul>

<p class="centerButton"><a data-delete="Delete Ticket" data-restore="Restore Ticket" class="sprite-buttons btnBlueLight" title="" data-recordid="123123" data-projectid="104824" href="/tickets/delete" id="deleteTicket"><strong class="sprite-buttons">Restore Ticket</strong></a></p> 
```

连接功能的示例元素是`$(".flag")`、等`$("#status")`，`$(".toggleAddNew")`并且需要可点击的一项是底部的删除按钮（这是一个锚标记）。请记住，此 HTML 在不同页面上可能会有所不同。如果我要委派锚点的点击，我没有问题，但确实是可编辑的东西是一个问题，因为不能使用委派事件进行设置。我尝试添加一个侦听`$("#infoPanel *").click( ... )`器并停止传播、默认行为并返回 false，但是项目的事件处理程序首先运行，所以这不起作用。通常情况下，如果不是为了那个按钮，我只会在整个事情上加一个覆盖层并收工。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:31:10.717

在子元素的处理程序中执行此操作：

```
if ($(this).parent().is(".disabled")) {
    return false;
} 
```

或者，如果“父母”是指更远的祖先，请执行以下操作：

```
// In the child element's handler...
if ($(this).parents(".disabled").length) {
    return false;
} 
```

如果您仍想让事件冒泡，请`false`从`return`语句中删除。

* * *

如评论中所述，使用`.closest()`代替`.parents()`可能会产生更好的结果，因为一旦`.disabled`找到第一个祖先，它就可以停止测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:40:59.143

不完全确定你想在这里做什么，但据我了解，你想让父元素的所有后代都不可点击，除了一个子元素。

假设您计划在您的父元素上保持“禁用”类：

```
$('.disabled').find(':not(.enable_button)').on('click', function() {
    return false;
}); 
```

这也假设您可以在您希望可点击的子元素上放置一个类“enable_button”。如果你不想使用一个类，我相信有一些方法可以识别它。

当用户单击重新启用按钮时，只需删除此处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:43:51.790

我使用 jEditable`.editable('disabled')`方法的组合解决了这个问题，然后直接在禁用面板内的`a`和`button`元素上添加处理程序（不包括恢复按钮。）并确保我自己绑定的元素使用委托，所以我可以控制的任何事件已注册到面板。这使我能够使禁用/启用全局，并为每个部分编写更清晰的代码。

# r - tryCatch() 显然忽略了警告

> ID：13422300
> 
> 赞同：4
> 
> 时间：2012-11-16T18:26:03.697
> 
> 标签：r, warnings, try-catch

我正在编写一个函数，它使用 kmeans 来确定 bin 宽度以将连续测量（预测概率）转换为整数（3 个 bin 之一）。我偶然发现了一个边缘情况，在这种情况下，我的算法有可能（正确地）预测整个集合的相同概率，我想处理这种情况。我通过以下方式使用`rattle`包的功能：`binning()`

```
btsKmeansBin <- function(x, k = 3, default = c(0, 0.3, 0.5, 1)) {
  result <- binning(x, bins = k, method = "kmeans", ordered = T)
  bins <- attr(result, "breaks")
  attr(bins, "names") <- NULL
  bins <- bins[order(bins)]
  bins[1] <- 0
  bins[length(bins)] <- 1
  return(bins)
} 
```

在 上运行这个函数`x <- c(.5,.5,.5,.5,.5,.5)`，你会在这`order(bins)`一步得到一个错误，因为`bins`它将是 NULL，因此不是向量。

显然，如果`x`只有一个不同的值，kmeans 不应该工作。在这种情况下，我想返回`default`bin 分区。发生这种情况时，会`binning`发出“警告：不考虑变量”。所以我想用它`tryCatch`来处理这个警告，但是用下面的代码包围这一`result <- ...`行并不能像我期望的那样工作：

```
...
tryCatch({
  result <- binning(x, bins = k, method = "kmeans", ordered = T)
}, warning = function(w) {
  warn(sprintf("%s. Using default values", w))
  return(default)
}, error = function(e) {
  stop(e)
})
... 
```

警告被打印出来，好像我没有使用过一样`tryCatch`，代码继续执行`return`语句并再次抛出错误`order`。我尝试了很多变体都无济于事。我在这里错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T18:35:18.477

如果您查看，`binning`我想您会发现您看到的“警告”不是通过生成的，`warning()`而是通过生成的`cat()`，这就是为什么`tryCatch`不选择它的原因。对于这种疏忽，作者`binning`可能应该用湿面条来鞭打几下。;)（或者由于拨浪鼓的特殊工作方式，它可能是故意的，我不确定。）

发生这种情况时它似乎会返回`NULL`，因此您可以简单地手动处理它。不理想，但可能是唯一的方法。

# javascript - javascript动态添加删除行嵌套

> ID：13422302
> 
> 赞同：0
> 
> 时间：2012-11-16T18:26:13.867
> 
> 标签：javascript

我在 javascript 中添加和删除空白行时遇到了问题……这是一个嵌套问题和唯一 ID 问题。

总而言之，我有三个表单域。字段 1、金额 1、金额 2。Field1 可以有多个 Amount1 & Amount2。Field1也可以有多个，Amount1、Amount2也可以有多个。问题是我的“添加”按钮复制了额外的 Amount1、Amount2（如果存在）。只是为了解释一下，“添加行”添加了 Amount1，Amount2。选中复选框时，“删除行”将删除 Amount1,Amount2。

当我单击“添加”按钮时，我想要一个新的 Field1、Amount1、Amount2 但没有额外的 Amount1、Amount2。当我在其他表单字段集中单击“添加行”或“删除行”时，我希望它在该特定集中添加或删除 Amount1、Amount2。

我需要为每一整行分配一个唯一标识符以使其正常工作，但无法弄清楚。

这是我的代码，如果执行它可能会更有意义。

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd"><head>

    <script type="text/javascript">

    function addRow(tableID) {               
    var table = document.getElementById(tableID);               
    var rowCount = table.rows.length;             
    var row = table.insertRow(rowCount);               
    var colCount = table.rows[0].cells.length;               
     for(var i=0; i<colCount; i++) {                   
    var newcell = row.insertCell(i);                   
     newcell.innerHTML = table.row[0].cells                                                [i].innerHTML; //alert                                                       (newcell.childNodes);
switch(newcell.childNodes[0].type) {                     

    case "text":                             
    newcell.childNodes[0].value = "";                            
    break;                     
    case "checkbox":                             
    newcell.childNodes[0].checked = false;                             
    break;                     
    case "select-one":                             
    newcell.childNodes[0].selectedIndex = 0;                            
    break;   

    }             
    }         
    }

    function deleteRow(tableID) {             
     try {             
       var table = document.getElementById(tableID);             
       var rowCount = table.rows.length;               
         for(var i=0; i<rowCount; i++) {                 
       var row = table.rows[i];                 
       var chkbox = row.cells[0].childNodes[0];                 
        if(null != chkbox && true == chkbox.checked) {                     
        if(rowCount <= 1) {                         
           alert("Cannot delete all the rows.");                        
       break;                     
      }  

     table.deleteRow(i);                     
      rowCount--;                    
       i--;                 
       }                 
       }             
       }catch(e) 
       {                 
       alert(e);             
       }         
       }

       var _counter = 0;
       function Add() {
           _counter++;
           var oClone = document.getElementById("template").cloneNode(true);
           oClone.id += (_counter + "");
           document.getElementById("placeholder").appendChild(oClone);
       }

       </script>
       </head>

       <body>

    <fieldset id="fieldset">

        <div id="placeholder">
        <div id="template">

           <br>

    <table  id= "act_legis">
            <tr>
                <td>Field1:</td>
                <td>Amount1:</td>
        <td>Amount2:</td>
                <td>&nbsp;</td> 
        </tr>
    </table>

    <table id= "act">
            <tr>  
                <td>
                    <button type="button" name="Submit" 
                     align = "left" onclick="Add();">Add</button>
                    <input name="Field1" type="text" size="4" maxlength="4"/></td>    
            </tr>
    </table>

    <table id= "legis_amounts">
            <tr>
                <td>
                    <input type="checkbox" name="chk"/>
                    <input name="Amount1" type="text" size="10"maxlength="18"/>
               </td>
      <td>
                 <input name="Amount2" type="text" size="10" maxlength="18"/>
      </td>
           </tr>
    </table>

    <table>
    <tr>
        <td>
                    <input type="button" onclick="addRow('legis_amounts');
            return false;"  value = "add row"/>
            <input type="button" value = "delete row" onclick="deleteRow
                    ('legis_amounts');return false;"  />
                  </td>
    </tr>
    </table>

        </div> <!-- template -->
        </div> <!-- placeholder -->
        </fieldset>

    <table>
            <tr>
                <td><p>&nbsp;</p>
                </td>
            </tr>
    </table>

    </body>
    </html> 
```

# sql - 根据列中的值对 SQL 查询进行排序，确定下一行中另一列的值

> ID：13422306
> 
> 赞同：0
> 
> 时间：2012-11-16T18:26:26.110
> 
> 标签：sql, sql-server-2008, sql-order-by

我的表如下所示：

```
Value     Previous     Next
37        NULL         42
42        37           3
3         42           79
79        3            NULL 
```

除了，桌子全乱了。（没有重复，所以这不是问题。）我想知道是否有任何方法可以对输出进行排序，基本上说“下一行'值'=这一行'下一个'”，如图所示多于 ？

我无法控制数据库以及这些数据的存储方式。我只是想找回它并组织它。我相信 2008 年的 SQL Server。

我意识到这在之后重组并不难，但我只是好奇我是否可以编写一个开箱即用的查询，这样我就不必担心了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:35:30.877

如果您正在使用`Oracle`，请尝试`Starts with- connect by`

```
 select ... start with initial-condition connect by 
    nocycle recursive-condition; 
```

**编辑：对于 SQL-Server**，使用`WITH`如下语法：

```
WITH rec(value, previous, next) AS 
  (SELECT value, previous, next 
    FROM table1
    WHERE previous is null
    UNION ALL
    SELECT nextRec.value, nextRec.previous, nextRec.next
    FROM table1 as nextRec, rec
    WHERE rec.next = nextRec.value)
  SELECT value, previous, next FROM rec; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:56:09.457

使用[递归查询](http://msdn.microsoft.com/en-us/library/ms186243%28v=sql.105%29.aspx)，在此处列出的 i 中，您的链表可以有多个路径：

```
with cte (Value, Previous, Next, Level)
as
(
  select Value, Previous, Next, 0 as Level
  from data
  where Previous is null

  union all

  select d.Value, d.Previous, d.Next, Level + 1
  from data d
    inner join cte c on d.Previous = c.Value  
)

select * from cte 
```

[在这里摆弄](http://sqlfiddle.com/#!6/352e3/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T20:21:03.907

这应该做你需要的：

```
WITH CTE AS (
    SELECT YourTable.*, 0 Depth
    FROM YourTable
    WHERE Previous IS NULL
    UNION ALL
    SELECT YourTable.*, Depth + 1
    FROM YourTable JOIN CTE
        ON YourTable.Value = CTE.Next
)
SELECT * FROM CTE
ORDER BY Depth; 
```

[[SQL Fiddle]](http://sqlfiddle.com/#!3/67b89/9) *（为简洁起见，省略了引用完整性和索引。）*

我们使用递归公用表表达式 ( `CTE`) 从列表的头部 ( `WHERE Previous IS NULL`) 移动到尾随节点 ( `ON YourTable.Value = CTE.Next`)，同时记住到达当前节点 (in `Depth`) 所需的递归深度。

最后，我们只需按到达每个节点所需的递归深度进行排序（`ORDER BY Depth`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T18:34:51.680

像这样的东西应该工作：

```
With Parent As (
  Select
    Value,
    Previous,
    Next
  From
    table
  Where
    Previous Is Null
  Union All
  Select
    t.Value,
    t.Previous,
    t.Next
  From
    table t
      Inner Join  
    Parent
      On Parent.Next = t.Value
)

Select
  *
From
  Parent 
```

[例子](http://sqlfiddle.com/#!3/f345d/2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T18:36:04.840

一种方法是使用连接：

```
select t.*
from t left outer join
     t tnext
     on t.next = tnext.val
order by tnext.value 
```

然而，这样不行吗？

```
select t.*
from t
order by t.next 
```

# vba - 如何将Word中的形状移动到书签位置

> ID：13422314
> 
> 赞同：0
> 
> 时间：2012-11-16T18:27:20.013
> 
> 标签：vba, ms-word

我在 Word 文档中有一个形状，需要将其移动到书签位置。

我尝试使用“left”和“top”属性，但是，这不起作用，因为据我所知，书签没有“left”和“right”属性。

我曾尝试使用剪切和粘贴，但这不适用于形状。

以下是创建形状的代码：

```
Set shp = ActiveDocument.Content.InlineShapes.AddOLEControl("Forms.CommandButton.1")

With ActiveDocument.InlineShapes(1).OLEFormat.Object
    .Caption = "Test"
    .Height = 30
    .Width = 44
End With

With ActiveDocument.InlineShapes(1).ConvertToShape
    .Name = "Test1"
    .ZOrder (msoBringInFrontOfText)
End With 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T02:13:52.973

除了使用书签，您可以在文档的某处使用绝对位置吗？

```
 Dim Test1 As Shape

        Set Test1 = ActiveDocument.Shapes("Test1")

        With Test1
                .RelativeHorizontalPosition = wdRelativeHorizontalPositionPage
                .RelativeVerticalPosition = wdRelativeVerticalPositionPage
                .Left = InchesToPoints(6.889)
                .Top = InchesToPoints(0.374)
        End With

        End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-24T09:46:46.413

这是一个非常古老的线程，但基本前提仍然有效，并且可以使用 VBA 在带书签的位置（此处为名为“bmShape”的书签）插入控件，如下所示。

```
Dim oRng As Range
Dim oShp As InlineShape
Set oRng = ActiveDocument.Bookmarks("bmShape").Range
oRng.Text = ""
Set oShp = oRng.InlineShapes.AddOLEControl("Forms.CommandButton.1")
oRng.End = oRng.End + 1
oRng.Bookmarks.Add "bmShape"

With oShp.OLEFormat.Object
    .Caption = "Test"
    .Height = 30
    .Width = 44
End With

With oShp.ConvertToShape
    .Name = "Test1"
    .WrapFormat.Type = wdWrapSquare
    .WrapFormat.Side = wdWrapBoth
End With 
```

# c# - HTTPS 显示混合内容错误。无论如何以编程方式处理这个？或更改错误的文本？

> ID：13422316
> 
> 赞同：2
> 
> 时间：2012-11-16T18:27:26.693
> 
> 标签：c#, wcf, silverlight, https, uri

我有一个 HTTPS silverlight 应用程序（最后），但我也有一个电话要从非 https 网站获取一些地图数据。

问题在于对非 https 地图数据的调用，该数据仅由图像（地图图块）和国家列表组成。它向用户显示一条注释，说明该页面包含不安全（混合）的内容，并且他们希望显示它。

** 地图数据托管在网络上的内部服务器上，是 100% 受信任和安全的内容。**

我的问题是这三个：

1.  无论如何我可以告诉用户不安全的内容只是地图数据并且只会被拉到客户端一次，如果他们想在应用程序中查看地图，他们应该按接受？

2.  或者有没有办法从 silverlight 向用户显示自定义消息并存储他们在应用程序中隐藏或显示“不安全”内容的决定？

3.  或者配置文件中是否有一种方法可以指定一组安全的 URI，并且在浏览器进行混合内容检查时可以忽略？就像我想指定[http://mapdata.com/mapdata](http://mapdata.com/mapdata)的安全 URI 一样，我可以在 silverlight 的 webconfig 文件中与一些 https 设置一起执行此操作吗？

感谢您的帮助和时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:30:29.003

出于安全原因，不，您不能覆盖该警告消息。想象一下，如果一个恶意网站重写了该消息以说没有任何问题？这意味着开发人员不能乱用。

你可以做的是通过一些 HTTPS 隧道（也许是[stunnel](https://www.stunnel.org/index.html)？）隧道传输 HTTP 内容。这会对性能产生一些影响，但它应该可以解决您的混合内容问题。

# sql - SQL 更新没有返回值？

> ID：13422323
> 
> 赞同：0
> 
> 时间：2012-11-16T18:28:08.970
> 
> 标签：sql, tsql, sql-server-2012

> **可能重复：**
> [没有。在 SQL Server 2005 中运行选择查询后受影响的行数](https://stackoverflow.com/questions/1543605/getting-no-of-rows-affected-after-running-select-query-in-sql-server-2005)

如何获取更新更新的行数？像这样的东西：

```
select update container set a = 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:31:29.983

您可以使用

```
SET NOCOUNT OFF;
GO 
```

这将显示更新的行数。

您还可以使用 ever-so-cool`@@ROWCOUNT`变量，它返回受上次操作影响的行数。

```
SELECT @@ROWCOUNT;  
GO 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:32:31.433

```
DECLARE @UPDATED_RECORDS int
SET @UPDATED_RECORDS = 0

select update container set a = 1

Select @UPDATED_RECORDS = @@ROWCOUNT 
```

紧接着更新语句，您应该得到现在存储在@UPDATED_RECORDS 变量中的更新记录总数。

当然，如果没有更新过滤器，您将更新表中的每一行，因此在这种情况下 SELECT COUNT(1) FROM CONTAINER 应该提供相同的结果。

# vb.net - 如何动态创建“枚举”类型的属性值

> ID：13422328
> 
> 赞同：2
> 
> 时间：2012-11-16T18:28:35.727
> 
> 标签：vb.net, list, properties, dictionary, enums

我需要在一个类中创建一个属性，该属性将为程序员提供一个可供选择的值列表。我过去曾使用 enums 类型完成此操作。

```
Public Enum FileType
    Sales
    SalesOldType
End Enum

Public Property ServiceID() As enFileType
    Get
        Return m_enFileType
    End Get
    Set(ByVal value As enenFileType)
        m_enFileType = value
    End Set
End Property 
```

问题是我想根据 SQL 表值填充类的 init 值列表。根据我的阅读，不可能动态创建枚举，因为它们基本上是常量。

有没有办法可以使用列表或字典类型来实现我的目标？或任何其他可能有效的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:06:34.573

我不知道这是否会回答你的问题，但这只是我对此事的看法。我喜欢枚举，主要是因为它们对我这个程序员来说很方便。这只是因为当我编写代码时，在常量值上使用和枚举不仅可以让我在键入时自动完成，还可以进行编译时错误检查，确保我只能提供有效的枚举值。但是，枚举不适用于运行时定义的值，因为就像您说的那样，存在编译时定义的常量。

通常，当我使用从您的示例中的 SQL 表加载的灵活值时，我将只使用字符串值。所以我只需将`Sales`和存储`SalesOldType`在表中并将它们用于`FileType`. 我通常使用字符串而不是整数，因为如果我在调试某些东西时查看数据表，字符串是人类可读的。

现在，您可以做一些混合，允许存储值并来自表，但在代码中将常用值定义为常量，如下所示：

```
 Public Class FileTypeConstants
       public const Sales = "Sales"
       public const SalesOldType = "SalesOldType"
 End Class 
```

这样，您可以确保在使用通用值进行编码时，一个地方的小字符串拼写错误不会导致您的程序出现错误。

另外，作为旁注，我为通过单击一次部署在我们公司内部部署的应用程序编写代码，因此对于很少添加的值，我仍然会使用枚举，因为它非常容易添加值并推出更新。因此，使用和枚举与数据库值的问题可能是获取用户更新的难易程度之一。如果您很少更新，数据库值可能是最好的，如果您经常更新并且更新不是由用户完成，那么枚举仍然可以正常工作。

希望其中一些对您有所帮助！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-19T13:46:05.020

如果在编译代码后值不会改变，那么听起来最好的选择就是简单地自动生成代码。例如，您可以编写一个简单的应用程序来执行以下操作：

```
Public Shared Sub Main()
    Dim builder As New StringBuilder()
    builder.AppendLine("' Auto-generated code.  Don't touch!!  Any changes will be automatically overwritten.")
    builder.AppendLine("Public Enum FileType")
    For Each pair As KeyValuePair(Of String, Integer) In GetFileTypesFromDb()
        builder.AppendLine(String.Format("    {0} = {1}", pair.Key, pair.Value))
    End For
    builder.AppendLine("End Enum")
    File.WriteAllText("FileTypes.vb", builder.ToString())
End Sub

Public Function GetFileTypesFromDb() As Dictionary(Of String, Integer)
    '...
End Function 
```

然后，您可以将该应用程序作为预构建步骤添加到您的项目中，以便它在您每次编译主应用程序时自动运行。

# winapi - 将开发环境从 C/VI/Make 转换为 VCC

> ID：13422333
> 
> 赞同：0
> 
> 时间：2012-11-16T18:29:09.507
> 
> 标签：winapi

我有一个相当大的 C 程序，我花了几年时间编写，最初是一个简单的 Win32 GUI。我使用 vi、nmake 和微软的 CL 命令行编译器作为我的构建环境。这是一个相当复杂的 GUI，有几个正在运行的线程、网络服务器、一个 COM 端口接口、几个对话框等......我在 GUI 中手工构建了每个项目，而我的 makefile 只是在最终之前使用资源编译器 (RC) 构建它们连锁。更改或更新非常繁琐，尤其是在涉及 GUI 时。

无论如何，该程序仍然存在，但我真的很想过渡到 Visual Studio，并使用最新的工具重新创建 GUI。我不想使用 .NET，也不需要 C++，但我假设如果我这样做的话我会坚持下去（是吗？）。有人对如何在不进行大量 C-to-C++ 重写的情况下开始这个有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T21:56:09.613

大多数 C 可以移植到 C++，只需将文件扩展名从 .c 重命名为 .cpp。您可以获得 C++ 的好处（更强大的类型检查等），但您仍然可以直接编写 C。

但是，如果您不想进行该更改，您仍然可以使用 Visual Studio。只需创建一个新的 C++ 项目（文件/新建/来自现有代码）并将其指向您现有的 C 文件。Visual Studio 将愉快地编译和链接您的 .c 和 .rc 文件，而不会强迫您使用 C++。

# ruby-on-rails - Rails：图片上传（没有插件）

> ID：13422340
> 
> 赞同：3
> 
> 时间：2012-11-16T18:29:48.467
> 
> 标签：ruby-on-rails, image, forms, upload

我有一张存储有关酱汁信息的表格。每个酱汁在图像资产文件夹中都有一个图像，在一个名为酱汁的文件夹中。所有酱汁文件的名称都相同；例如`assets/images/sauces/sauces_piri.png`

我想要做的基本上就是以创建发生的形式上传一个 .png 文件，并在 pic_url 的字段中存储图像的名称以及调味汁/因此当我想显示时正确定向图片。

目前管理员必须使用域文件管理将图像物理上传到正确的位置，并且在创建新酱时还要输入“酱汁/酱汁名称.png”。

添加新酱的表格：

```
<%= error_messages_for(@sauce) %>
   <table summary="Sauces Form Fields">
    <tr>
     <th><%= f.label(:name,"Sauce Name") %></th>
     <td><%= f.text_field(:name) %></td>
    </tr>
    <tr>
     <th><%= f.label(:description, "Description") %></th>
     <td><%= f.text_area(:description, :size => '40x5') %></td>
    </tr>
    <tr>
     <th><%= f.label(:heat_level, "Heat Level") %></th>
     <td><%= f.select(:heat_level,{ 1 => "1", 2 => "2", 3 => "3", 4 => "4", 5 => "5"}) %></td>
   </tr>
   <tr>
    <th><%= f.label(:pic_url, "Picture URL") %></th>
    <td><%= f.text_field(:pic_url) %></td>
   </tr>
   <tr>
    <th><%= f.label(:title_colour, "Title Colour") %></th>
    <td><%= f.text_field(:title_colour) %></td>
   </tr>
   <tr>
    <th><%= f.label(:description_colour, "Desc Colour") %></th>
    <td><%= f.text_field(:description_colour) %></td>
   </tr>
  </table> 
```

因此，如果不使用回形针等插件，如何启用图像上传，然后将文件存储在正确的位置，并且在表字段中存储文件夹`pic_url`名称/文件名.png？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:40:00.197

我不清楚你有什么问题。所以，我将发布一个关于上传文件的示例表单。

```
<%= form_for(:uploaded_data_file, :url => upload_files_path(:params => params) ,  :remote => true, :html => { :multipart => true } ) do |f| %>
  <%= f.label "Upload" %><br />
  <%= f.file_field :location %>
<% end %> 
```

您必须为将在此示例中存储图像的函数定义路径，它被调用`upload_files_path`，我们将所有`params`. 然后重新启动 webapp 以获取新路由。

在控制器中，您可以保存文件及其详细信息

获取文件名

```
params[:uploaded_data_file][:location].original_filename 
```

获取文件本身并保存

```
File.open("where/to/save", "wb") { |f| f.write(params[:uploaded_data_file][:location].read) } 
```

为了确保它是 .png，您可以进行一些正则表达式检查

```
if(name =~ /.png$/i) # for more than one type do (name =~ /.jpeg$|.png$/i) 
```

要执行其他操作，请查看您的内容`params`并进行所需的更改。

对于工作路线，您可以查看[http://edgeguides.rubyonrails.org/routing.html#adding-more-restful-actions](http://edgeguides.rubyonrails.org/routing.html#adding-more-restful-actions)

```
resources :posts do
  collection do
    get :upload_files # will create upload_files_posts_path
  end
end 
```

或者

```
match '/upload_files', :to => 'controller_name#method_name' # 'posts#upload_files' 
```

或者

```
<% form_tag({:action => 'upload_file'}  #will use the correct controller based on the form 
```

# c# - ContentControl 与 ScrollViewer，焦点

> ID：13422345
> 
> 赞同：0
> 
> 时间：2012-11-16T18:30:21.883
> 
> 标签：c#, windows-8, focus, windows-runtime, contentcontrol

在我的 Windows 8 Metro 项目中，我使用从 ContentControl 派生的类（我们称之为 MyControl）来展示我的内容。在 MyControl 中，我有一个 ScrollViewer。因为我希望我的控件能够处理键盘事件，所以我需要能够将焦点设置到我的控件上。但是，我还想要让滚动查看器处理键事件的选项，例如箭头键和 PageUp/Down。更准确地说，我希望这是另一个程序员可以打开或关闭的选项。这意味着有时，我希望 MyControl 成为一个制表位，有时我希望 ScrollViewer 成为一个制表位，但从不两者兼而有之。

问题是我不想将 MyControl 的内部工作原理暴露给其他程序员。也就是说，理想情况下，他们应该能够使用 MyControl.IsTabStop 并保留将实际制表位放置在我的 Control 中的逻辑（放入 MyControl 或 ScrollViewer）。

有没有什么好的方法来实现这一点，或者我是否必须通过提供一个单独的函数来解决它以使我的控件成为制表位？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:59:27.770

如果您查看我的测试 XAML，您会发现我什么也没做，但是 TextBox 中的向上/向下键可以在文本行之间移动，并且当没有文本行可以转到时，它们会滚动 ScrollViewer。这可能是通过 KeyDown 处理程序在不希望键事件冒泡时将 e.Handled 值设置为 true 来实现的（就像 TextBox 已经处理它时一样）并在未处理事件时将其设置为 false ，这让ScrollViewer 处理它。如果有焦点，该事件将始终在 TextBox 上触发，但如果未处理，它会在可视树上冒泡。除了决定是否要将关键事件标记为已处理外，您似乎不需要做任何其他事情。

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <ScrollViewer
        IsTabStop="True">
        <Grid
            Width="2000"
            Height="2000">
            <Button
                Margin="149,342,0,311">
                <Button>
                    <TextBox
                        AcceptsReturn="True"
                        Height="400"
                        Width="200"/></Button>
            </Button>
        </Grid>
    </ScrollViewer>
</Grid> 
```

# php - file_get_contents() 是阻塞函数吗？

> ID：13422346
> 
> 赞同：4
> 
> 时间：2012-11-16T18:30:21.967
> 
> 标签：php, file-get-contents, blocking

我正在通过 file_get_contents 连接到不可靠的 API。由于它不可靠，因此我决定将 api 调用放入 while 循环中：

```
$resultJSON = FALSE;

while(!$resultJSON) {
    $resultJSON = file_get_contents($apiURL);
    set_time_limit(10);
} 
```

换句话说：假设 API 在第 3 次尝试成功之前失败了两次。我发送了 3 个请求，还是发送了数百个请求以适应该 3 秒窗口？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T18:34:02.383

`file_get_contents()`，基本上就像 PHP 中的所有函数一样，是一个阻塞调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T18:34:42.957

是的，它是一个阻塞函数。您还应该检查该值是否专门为“假”。（注意使用 ===，而不是 ==。）最后，你想睡 10 秒。set_time_limit() 用于设置自动终止前的最大执行时间。

```
set_time_limit(300); //Run for up to 5 minutes.

$resultJSON = false;
while($resultJSON === false)
{
    $resultJSON = file_get_contents($apiURL);
    sleep(10);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T19:06:57.397

扩展@Sammitch 建议以使用 cURL 而不是`file_get_contents()`：

```
<?php
$apiURL = 'http://stackoverflow.com/';

$curlh = curl_init($apiURL);
// Use === not ==
// if ($curlh === FALSE) handle error;
curl_setopt($curlh, CURLOPT_FOLLOWLOCATION, TRUE); // maybe, up to you
curl_setopt($curlh, CURLOPT_HEADER, FALSE); // or TRUE, according to your needs
curl_setopt($curlh, CURLOPT_RETURNTRANSFER, TRUE);
// set your timeout in seconds here
curl_setopt($curlh, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($curlh, CURLOPT_TIMEOUT, 30);
$resultJSON = curl_exec($curlh);
curl_close($curlh);
// if ($resultJSON === FALSE) handle error;
echo "$resultJSON\n"; // Now process $resultJSON
?> 
```

还有很多`curl_setopt`选择。[你应该检查出来。](http://www.php.net/manual/en/function.curl-setopt.php)

当然，这假设[您有可用的 cURL](http://www.php.net/manual/en/curl.setup.php)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T19:10:38.090

我不知道 PHP 中没有“阻塞”的任何函数。作为替代方案，如果您的服务器允许此类操作，您可以：

1.  `pcntl_fork()`在等待 API 调用通过时，在脚本中使用和执行其他操作。
2.  如果不可用，用于`exec()`在后台调用另一个脚本 [使用`&`] 为您执行 API 调用。`pcntl_fork()`

但是，如果在没有成功调用该 API 的情况下您实际上无法在脚本中执行任何其他操作，那么调用是否“阻塞”并不重要。你真正应该关心的是花费太多时间等待这个 API，以至于你超出了配置的`max_execution_time`范围，并且你的脚本在中间被中止而没有正确完成。

```
$max_calls = 5;
for( $i=1; $i<=$max_calls; $i++ ) {
    $resultJSON = file_get_contents($apiURL);
    if( $resultJSON !== false ) {
        break;
    } else if( $i = $max_calls ) {
        throw new Exception("Could not reach API within $max_calls requests.");
    }
    usleep(250000); //wait 250ms between attempts
} 
```

值得注意的是，`file_get_contents()` [默认超时时间为***60 秒***](https://stackoverflow.com/questions/10236166/php-file-get-contents-have-time-out)，因此您确实有脚本被杀死的危险。请认真考虑改用 cURL，因为您可以设置更合理的超时值。

# wpf - WPF 绑定 TextBox 和 ObservableDictionary （按 ID 显示字符串）

> ID：13422349
> 
> 赞同：1
> 
> 时间：2012-11-16T18:30:35.820
> 
> 标签：wpf, xaml, binding

我的员工列表中的每一项都有`Post`属性。该属性是`Int64`类型。另外，我有一些`ObservableDictionary<Int64,String>`作为静态属性。每个员工必须`String`按其键显示值。项目的数据模板`Employe`（我删除了多余的）：

```
 <DataTemplate x:Key="tmpEmploye">
            <Border BorderThickness="3" BorderBrush="Gray" CornerRadius="5">
                <StackPanel Orientation="Vertical">                        
                    <TextBlock Text="{Binding Path=Post}"/>
                </StackPanel>
            </Border>                               
        </DataTemplate> 
```

但是这段代码显示了`Int64`值，而不是`String`. 获取静态字典的字符串：

```
"{Binding Source={x:Static app:Program.Data}, Path=Posts}" 
```

我知道如何解决它的问题`ComboBox`，但我不知道`TextBlock`。因为`ComboBox`我写了它（它工作正常）：

```
<ComboBox x:Name="cboPost" x:FieldModifier="public" Grid.Row="4" Grid.Column="1" HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch" Margin="2" Grid.ColumnSpan="2" 
          ItemsSource="{Binding Source={x:Static app:Program.Data}, Path=Posts}" DisplayMemberPath="Value"
          SelectedValuePath="Key"
          SelectedValue="{Binding Path=Post, Mode=TwoWay}">            
</ComboBox> 
```

但是我该如何解决呢`TextBlock`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:46:13.263

嗯，我确定我之前已经为这个场景开发了一些东西，但我不记得或找不到任何相关的东西！

IMO您可以使用转换器，因此您将Post（Int64）传递给转换器，它会从字典中返回字符串值，尽管它必须是一个更好的解决方案。

```
[ValueConversion(typeof(Int64), typeof(string))]    
public class PostToStringConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        // validation code, etc
        return (from p in YourStaticDictionary where p.Key == Convert.ToInt64(value) select p.Value).FirstOrDefault();
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
    }
} 
```

XAML：

```
<Window ...
    xmlns:l="clr-namespace:YourConverterNamespace"
    ...>
    <Window.Resources>
        <l:PostToStringConverter x:Key="converter" />
    </Window.Resources>
    <Grid>
        <TextBlock Text="{Binding Post, Converter={StaticResource converter}}" />
    </Grid>
</Window> 
```

# jquery - 全屏视差背景

> ID：13422350
> 
> 赞同：0
> 
> 时间：2012-11-16T18:30:37.660
> 
> 标签：jquery, html, css, background, parallax

我正在学习如何使用[jParallax](http://stephband.info/jparallax/) jQuery 插件来使用视差效果。到目前为止，我所做的工作正常，但我需要让视差影响整个屏幕。我将它应用于身体标签，但这显然不起作用。[这](http://kode.co.nf/)是它的外观。

这是代码。

```
<html>
<head>
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/jquery.parallax.css" />
<style type="text/css">
.parallax-viewport {
    height:20em;
    max-width:60em;
    width:100%;
}
</style>

<script type="text/javascript" src="js/jquery-1.8.2.js"></script>
<script type="text/javascript" src="js/jquery.parallax.js"></script>
<script type="text/javascript" src="js/jquery.event.frame.js"></script>
<script type="text/javascript">
$(document).ready(function(e) {
    $('#parallax .parallax-layer')
    .parallax({
      mouseport: $('#parallax')
    });
});
</script>

</head>

<body id="parallax" class="parallax-viewport">

    <div class="parallax-layer" style="width:600px; height:274px;">
        <img src="images/background_layers/bottom_layer.png" />
    </div>
    <div class="parallax-layer" style="width:1100px; height:284px;">
        <img src="images/background_layers/mid_layer.png" />
    </div>
    <div class="parallax-layer" style="width:1360px; height:320px;">
        <img src="images/background_layers/top_layer.png" />
    </div>

</body>
</html> 
```

如何用视差背景填充整个屏幕？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:56:30.133

您可以尝试将 .parallax-viewport 高度从 20em 更改；至 100%

# javascript - 检查数组是否唯一

> ID：13422352
> 
> 赞同：1
> 
> 时间：2012-11-16T18:30:52.870
> 
> 标签：javascript

> **可能重复：**
> [Javascript：确定数组是否包含值](https://stackoverflow.com/questions/1181575/javascript-determine-whether-an-array-contains-a-value)

```
var thelist = new Array();
function addlist(){
thelist.push(documentgetElementById('data').innerHTML);
} 
```

如何检查我推送的数据是否已存在于数组中`thelist`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:34:09.340

```
var thelist = []; // Use the array literal, not the constructor.
function addlist(){

  // get the data we want to make sure is unique
  var data = documentgetElementById('data').innerHTML;

  // make a flag to keep track of whether or not it exists.
  var exists = false;

  // Loop through the array
  for (var i = 0; i < thelist.length; i++) {

    // if we found the data in there already, flip the flag
    if (thelist[i] === data) {
      exists = true;

      // stop looping, once we have found something, no reason to loop more.
      break;
    }
  }

  // If the data doesn't exist yet, push it on there.
  if (!exists) {
    thelist.push(data);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:45:35.483

如果您不关心 IE < 9，您也可以使用 Array 方法“some”。看看这个例子：

```
var thelist = [1, 2, 3];

function addlist(data) {

    alreadyExists = thelist.some(function (item) {
        return item === data
    });

    if (!alreadyExists) {
        thelist.push(data);
    }
}
addlist(1);
addlist(2);
addlist(5);

console.log(thelist);​ 
```

[http://jsfiddle.net/C7PBf/](http://jsfiddle.net/C7PBf/)

一些确定是否存在至少一个具有给定约束的元素（回调返回值 === true）。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:36:41.157

如果您不关心 IE 8 或更低版本，您可以使用`Array.filter`：

```
var thelist = new Array();
function addlist(){
    var val = documentgetElementById('data').innerHTML;
    var isInArray = theList.filter(function(item){
        return item != val
    }).length > 0;

    if (!isInArray)
        thelist.push(val);
} 
```

或者，您可以使用`Array.indexOf`：

```
var thelist = new Array();
function addlist(){
    var val = documentgetElementById('data').innerHTML;
    var isInArray = theList.indexOf(val) >= 0;

    if (!isInArray)
        thelist.push(val);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T18:41:12.393

看看`underscore.js`：[underscore.js](http://underscorejs.org) 然后你可以检查数组

```
_.contains(thelist, 'value you want to check');

// The full example
var thelist = new Array();
function addlist(){
   var data = documentgetElementById('data').innerHTML;
   if(!_.contains(thelist, data)) theList.push(data);
} 
```

或者您可以在不考虑重复值的情况下将值添加到数组中，并且在添加过程完成后，您可以通过以下方式删除重复元素

```
theList = _.uniq(theList); 
```

第二种方法当然效率较低。

# python - 套接字在 Python 中不起作用

> ID：13422356
> 
> 赞同：4
> 
> 时间：2012-11-16T18:31:07.660
> 
> 标签：python

我一直在尝试 Python 中的“套接字”模块，但每当我尝试运行此代码时：

```
import socket
import sys

host = '192.168.1.1'
port = 23

try:
      s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
except:
      print "socket() failed"
      sys.exit(1) 
```

然后它就死了。这是没有 except 和 try 的错误：

```
Traceback (most recent call last):
  File "C:\Documents and Settings\a\Desktop\socket.py", line 1, in <module>
    import socket
  File "C:\Documents and Settings\a\Desktop\socket.py", line 6, in <module>
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
AttributeError: 'module' object has no attribute 'AF_INET' 
```

我刚刚开始使用 Python（今天）并且需要帮助。

我将它保存为 socket.py 但也保存为 sock.py ...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T18:36:38.697

```
import socket 
```

[在 Python 的标准库之前查看当前目录](http://docs.python.org/2/library/sys.html#sys.path)。并且由于您的文件被调用`socket.py`，它本身是导入的，而不是[套接字](http://docs.python.org/3/library/socket.html)标准库模块。将文件重命名（不要复制，因为这会留下原始文件）文件为其他名称，例如`my_socket.py`.

# android - 如何检查手机是否处于空闲状态或手机是否退出空闲状态？

> ID：13422359
> 
> 赞同：1
> 
> 时间：2012-11-16T18:31:15.203
> 
> 标签：android, state

我有一个扩展 BroadcastReciever 的类和另一个扩展 AsyncTask 的类

我想要它，以便当它收到一条短信时，它会使用“AsyncTask-extended”类启动一个计时器。
在 30 秒之后，**假设手机一直处于空闲状态或在整个 30 秒内没有收到任何用户输入**，它将运行一个函数。
否则，它将停止计时器。

我已经将计时器部分关闭（尽管它会随机地过早停止）
现在我一直在弄清楚如何检查计时器运行时是否有任何用户输入。

有人可以告诉我如何检查所述用户输入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:48:53.160

所以基本上你需要听 ACTION_SCREEN_ON 广播意图。

实现它的步骤：

> 1) 为 SMS 设置 BroadcastReceiver。我们称之为 SMSBroadcastReceiver。
> 
> 2）在您的 SMSBroadcastReceiver.onReceive 方法上，您必须做两件事：
> 
> 2.1) 使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)安排未来执行您的功能。无需使用 AsyncTasks。
> 
> 2.2）注册一个新的BroadcastReceiver来监听[ACTION_SCREEN_ON](http://developer.android.com/reference/android/content/Intent.html#ACTION_SCREEN_ON)事件。此接收器的实现应取消在步骤 2.1 上安排的操作。

此外，请考虑仅在[ACTION_SCREEN_OFF上注册 SMSBroadcastReceiver](http://developer.android.com/reference/android/content/Intent.html#ACTION_SCREEN_OFF)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:38:26.677

当手机空闲时，您当前活动的 onStop() 方法将被调用。覆盖此方法并在调用它时执行您想要的操作。当手机从空闲状态恢复时，方法 OnResume() 和 onRestart() 将被调用，您也可以覆盖它们。在此处了解有关活动生命周期的更多信息：http: [//developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

# android - android中的服务器端数据处理

> ID：13422365
> 
> 赞同：0
> 
> 时间：2012-11-16T18:31:43.310
> 
> 标签：android, tomcat

到目前为止，我一直在构建这个 Android 应用程序，并将所有数据存储到手机内部存储器中。现在我想将所有东西移动到服务器上，以便所有数据都存储在服务器上并从服务器接收。我想在 Apache (tomcat) 服务器上执行此操作。有人可以指导我如何开始这个。一些不错的教程或任何帮助都会很棒。！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T18:44:32.300

您可以创建一个 Web 服务并从您的 android 应用程序向它发送请求。这是一个很好的教程

> [http://androiddevelopement.blogspot.com/2011/09/connecting-to-remote-mysql-database.html](http://androiddevelopement.blogspot.com/2011/09/connecting-to-remote-mysql-database.html)

编辑：另一个教程

> [http://codeoncloud.blogspot.com/2012/03/android-mysql-client.html](http://codeoncloud.blogspot.com/2012/03/android-mysql-client.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:39:59.387

在您的服务器上安装 apache tomcat，使用 sql 数据库并使用 json 进行通信。剩下的：你知道谷歌吗？它是一个不错的搜索引擎。您可以在 google.com 上找到它

我喜欢这本书从 servlets/tomcat 开始：

[http://www.amazon.de/Head-First-Servlets-Bryan-Basham/dp/0596516681/ref=sr_1_2?ie=UTF8&qid=1353091543&sr=8-2](http://www.amazon.de/Head-First-Servlets-Bryan-Basham/dp/0596516681/ref=sr_1_2?ie=UTF8&qid=1353091543&sr=8-2)

# c# - 向 CommandItemSettings RadGrid 按钮添加样式

> ID：13422368
> 
> 赞同：0
> 
> 时间：2012-11-16T18:31:54.123
> 
> 标签：c#, asp.net, telerik, radgrid

我正在尝试在 RadGrid 中的“AddNewRecordText”按钮之后添加一个红色星号。这是代码。红色星号应显示在“添加奖励”文本之后。如果有任何建议，您能告诉我吗？谢谢你。

```
 <telerik:RadGrid ID="RadGrid1" AutoGenerateColumns="false" Width="99%" 
  runat="server" MasterTableView-AllowAutomaticInserts="true" GridLines="None" Skin="Default"
                ShowFooter="false" ShowStatusBar="false">
    <MasterTableView Width="100%" DataKeyNames="c_id" CommandItemDisplay="Top"
         CommandItemSettings-ShowAddNewRecordButton="true">
    <CommandItemSettings AddNewRecordText="Add Award *" ShowAddNewRecordButton="true" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:37:11.850

RadGrid 将 AddNewRecordText 预渲染为一个`<a>`元素。并且您不能为一个元素添加不同的样式。
要更改该默认行为，您必须使用[CommandItemTemplate](http://www.telerik.com/help/aspnet-ajax/grid-commanditemtemplate.html)。
[这个演示](http://demos.telerik.com/aspnet-ajax/grid/examples/programming/commanditem/defaultcs.aspx)对你来说应该是一个好的开始。

另一种简单的方法是，您始终可以使用 jquery 更改页面上的任何样式。
这应该对你有用（对我有用，可能你必须更改 ID）：

```
$('a[id$="InitInsertButton"]') //this means: find all <a> elements that have id ending with "InitInsertButton"
   .first() //Get the first element to be sure.
   .append('<span style="color:red"> *</span>') //Add text inside a attribute. 
```

您必须在[document.ready()](http://api.jquery.com/ready/)上添加此代码。
这是一个小的 jsfiddle，可以看到它的实际效果：http: [//jsfiddle.net/rXhnM/](http://jsfiddle.net/rXhnM/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-06T00:05:34.267

所以我又迟到了，但你可以在服务器端获得对该控件的引用：

```
protected void HandleGridItemCreated(object sender, GridItemEventArgs e)
{
 if(e.Item is GridCommandItem)
 {
  var button = e.Item.FindControl("SaveChangesIcon") as Button;
  var link = e.Item.FindControl("SaveChangesButton") as LinkButton;
  button.Text += "<span class='red'>*</span>";
 }
} 
```

我需要添加一些 javascript 以在单击时运行，所以这就是我设法将其关闭的方法。我想添加 * 并附加到 text 属性会产生您正在寻找的结果。我们使用的是 Telerik 控制集的 2016 版。

# java - Java EE 奇怪的实体行为

> ID：13422369
> 
> 赞同：1
> 
> 时间：2012-11-16T18:31:55.827
> 
> 标签：java, windows, web, ejb

我正在经历一种奇怪/奇怪的行为。我正在开发一个使用 Java EE 的 Web 应用程序项目。它使用 Eclipselink 2.3 持久性服务部署在 GlassFish 3.1.1 上。一切都在 Eclipse、Windows 7 Professional 64 位、JDK + JVM 64 位上。

我得到了一个可以使用的业务对象。首先我设置了相应的实体。一切都很好，直到调用方法。如果我在其中调试，实体突然变为空。

在此调用之前，实体被实例化。

代码是这样的：

```
// get my entity  
tramiteProxy = ejbTramiteFactory.getEntity(tramite);  

// get corresponding business thru factory  
IRegistrableInLiquidador registrableInLiquidadorBusiness = (IRegistrableInLiquidador)     ejbTramiteFactory.getCBusiness(tramiteProxy);  

// invoke business  
// up to here everything is fine, you can inspect business variable and it shows correct, entity is instantiated as expected   

registrableInLiquidadorBusiness.registrarNovedadInIntegrador(); 
```

现在我们在业务对象 ( ) 中进行调试`registrableInLiquidadorBusiness`：

```
// Here if one checks the entity it became null !!!  

public void registrarNovedadInIntegrador() throws CException {  
    try {  
        CIntegradorBusiness ejbIntegradorBusiness = CCTX  
            .getEJB(CIntegradorBusiness.class);  

        // Here's the problem: getEntity() returns null, the entity of this business object became *magically* null  

        ejbIntegradorBusiness.registrarNovedad(getEntity(),null);  

    } catch (Exception e) {  
        throw new CException(1, e);  
    }  
} 
```

我必须补充一点，对象实体是在该业务的父项中声明的变量，它从该变量扩展。

所以我不知道还能尝试什么。我查看了与此相关的每一行代码，以发现任何错误都无济于事。

下一步可能是下载 Eclipselink 源并对其进行调试以查看幕后发生的情况，尽管我什至不知道它是否与此有关。

任何建议将不胜感激。

# django - 在什么情况下使用 Django 表单集？

> ID：13422370
> 
> 赞同：0
> 
> 时间：2012-11-16T18:31:56.077
> 
> 标签：django

我是 Django 的初学者。在什么情况下使用 Django 表单集？（在实际应用中。）

请举一些例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:37:06.133

[根据文档：](https://docs.djangoproject.com/en/dev/topics/forms/formsets/)

> 表单集是在同一页面上处理多个表单的抽象层。最好将其与数据网格进行比较。

因此，任何时候您希望在页面上显示特定表单的多个实例以进行创建或更新。这方面的一个例子可能是电话簿。每个表格都是电话簿中的一个条目，但 Phonbook 表格的 Formset 将允许您一次创建或编辑多个条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:46:31.673

一种情况是 ModelA 具有 ModelB 的外键。您可以说一个 ModelB 有多个 ModelA，那么假设 ModelB 是 Invoice 而 ModelA 是 ProductItem，一张发票有一个或多个产品项目。

现在在实践中，您可以制作这样的基本表单集：[http](http://help.mailchimp.com/img/addafieldoption.jpg) ://help.mailchimp.com/img/addafieldoption.jpg您可以在其中将更多产品项目添加到发票中。

# asp.net - 使用 Response.Output 导出 excel 数据

> ID：13422372
> 
> 赞同：0
> 
> 时间：2012-11-16T18:32:18.830
> 
> 标签：asp.net, vb.net, export-to-excel, htmltextwriter, stringwriter

我有以下代码要保存以用于 Excel 导出：

```
'Export to Excel
        Response.Clear()
        Response.Buffer = True
        Response.AddHeader("content-disposition", "attachment;filename=excelExport.xls")
        Response.Charset = ""
        Response.ContentType = "application/vnd.ms-excel"

        Dim sw As New StringWriter()
        Dim hw As New HtmlTextWriter(sw)

        Dim grdView = New GridView

        grdView.AllowPaging = False

        'LOAD DATA
        Dim Sql As String = "SELECT * " & _
             "FROM bobSettings AS bobSettings " & _
              "INNER JOIN bobData AS bobData " & _
             "ON bobSettings.linkTobobData = bobData.linkTobobSettings " & _
             "WHERE linkTobobSettings = '1110450005' "

        Dim checkFormName As New SqlCommand(Sql, myCONN)

        myCONN.Open()

        Dim objCmd As SqlCommand

        objCmd = New SqlCommand(Sql, myCONN)

        Dim da As New SqlDataAdapter(objCmd)
        Dim ds As New DataSet()
        da.Fill(ds)

        grdView.DataSource = ds
        grdView.DataBind()
        myCONN.Close()
        'END LOADING DATA

        grdView.DataBind()
        grdView.HeaderRow.Style.Add("background-color", "#FFFFFF")
        grdView.HeaderRow.Cells(0).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(1).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(2).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(3).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(4).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(5).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(6).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(7).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(8).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(9).Style.Add("background-color", "#DFB")
        grdView.HeaderRow.Cells(10).Style.Add("background-color", "#DFB")

        For i As Integer = 0 To grdView.Rows.Count - 1
            Dim row As GridViewRow = grdView.Rows(i)

            row.BackColor = System.Drawing.Color.White
            row.Attributes.Add("class", "textmode")

            If i Mod 2 <> 0 Then
                row.Cells(0).Style.Add("background-color", "#C2D69B")
                row.Cells(1).Style.Add("background-color", "#C2D69B")
                row.Cells(2).Style.Add("background-color", "#C2D69B")
                row.Cells(3).Style.Add("background-color", "#C2D69B")
                row.Cells(4).Style.Add("background-color", "#C2D69B")
                row.Cells(5).Style.Add("background-color", "#C2D69B")
                row.Cells(6).Style.Add("background-color", "#C2D69B")
                row.Cells(7).Style.Add("background-color", "#C2D69B")
                row.Cells(8).Style.Add("background-color", "#C2D69B")
                row.Cells(9).Style.Add("background-color", "#C2D69B")
                row.Cells(10).Style.Add("background-color", "#C2D69B")
            End If
        Next
        grdView.RenderControl(hw)

        Dim style As String = "<style>.textmode{mso-number-format:\@;}</style>"

        Response.Write(style)
        Response.Output.Write(sw.ToString())
        Response.Flush()
        Response.End()
        ds = Nothing
        da = Nothing 
```

它执行没有问题或错误但我似乎无法找到它放置文件的位置或是否弹出一个框要求我保存它等。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T20:53:55.217

你写

```
grdView.DataSource = ds 
```

然后

```
ds = Nothing 
```

进而

```
grdView.DataBind() 
```

**编辑：**

为了避免“线程被中止”，您可以放入`Response.End()`一个 Try Catch 块来处理 ThreadAbort 异常。

```
Try
    Response.End()
Catch e As ThreadAbortException
End Try 
```

# eclipse - 在 PyDev 中更新 jython.jar

> ID：13422373
> 
> 赞同：0
> 
> 时间：2012-11-16T18:32:24.007
> 
> 标签：eclipse, jython, pydev

将新的 jython.jar 应用于 PyDev 的正确方法是什么？

我希望此选项可用，因为我必须在启动时提供 Jython 解释器。使用混合版本可能会导致问题。我希望该解释器的 jython.jar 可用于所有内容，而不仅仅是运行独立的 Jython，但似乎并非如此。

我相信 org.python.pydev.jython 提供了 jython.jar 的一个版本。PyDev 2.7.1 中这个插件的版本有一个 pydev-jython.jar，当我导入这个插件时，它位于运行时类路径中。（导入还会复制我配置的 Jython 解释器的目录。）

如何让 PyDev 使用不同的 jython.jar？

这里有一些更多的背景信息。

我已按照 PyDev 网站上的说明在 Eclipse 中安装 PyDev。我已将 Jython 2.5.3 配置为解释器。

我可以打开一个 Jython 控制台并运行以下命令：

```
>>> import org.python.core.PySystemState as pss
>>> st = pss()
>>> st.getBuiltins
<bound method <reflected field public org.python.core.PyObject org.python.core.PySystemState.__name__ at 0x1>.getBuiltins of <module 'sys' (built-in)>> 
```

从我作为 Jython Run 运行的 python 模块执行此操作也没有问题。

但是，当我尝试从 java 访问 getBuiltins 时，我收到一个编译时错误，指出方法 getBuiltins 没有为 PySystemState 定义。由于我与这个问题进行了广泛的斗争，我相信发生的事情是 org.python.pydev.jython 提供 jython.jar 而解释器配置仅用于运行 Jython 解释器。

显然，一些 jython.jar 在我的类路径中，因为我在导入 org.python.core.PySystemState 时没有收到任何投诉。这些症状与没有 Jython 2.5.3 完整 API 的旧 jython.jar 一致。

任何帮助将不胜感激——我不想再获得风滚草青铜！:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:59:19.917

事实证明，我试图做的事情需要访问一个新的 jython.jar。它与 PyDev 无关。我刚刚从 jython.jar 创建了一个插件并引用了它。

我认为 PyDev 存在问题，因为 classpath 和 jythonpath 可以从 java 应用程序自动运行，但不能从插件产品配置中自动运行。事实证明 Eclipse 是在一种情况下为我处理它，而不是在另一种情况下。PyDev 根本没有涉及。

# osgi - 设置 osgi.configuration.area 会破坏我的 Equinox OSGI 应用程序

> ID：13422374
> 
> 赞同：2
> 
> 时间：2012-11-16T18:32:23.913
> 
> 标签：osgi, equinox

我有一段时间使用 Equinox 作为 osgi 框架的应用程序。到目前为止，我使用系统属性 osgi.install.area 来指定我的捆绑包的位置

```
${osgi.install.area}/
  plugins/
     org.eclipse.osgi_3.7.0.v20110613.jar
     ... my app bundles 
```

Equinox 然后自动`${osgi.install.area}/configuration`用作配置区域。

一切正常。

现在我需要将配置区域移出，`${osgi.install.area}`因为它可能是只读的，我认为它就像设置`${osgi.configuration.area}`到合适的路径一样简单，但是当我这样做时，应用程序不再启动，并且我在日志中有以下堆栈跟踪：

```
java.lang.IllegalStateException: Unable to acquire application service. Ensure that the org.eclipse.core.runtime bundle is resolved and started (see config.ini).
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:74)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.main(EclipseStarter.java:150)
... 
```

使用该路径是因为在该位置创建了日志文件和一个目录`"org.eclipse.osgi"`。

`config.ini`我喜欢这样引用捆绑包的路径：

```
osgi.bundles=de.mycomp.app-0.6.0.20121116-1834.jar@start, ... 
```

错误消息并没有真正提示在哪里查看。这一定是相当简单的事情，但我现在相当无能。

提前致谢，

罗伯特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T05:57:27.413

`.ini`我测试了更改现有 osgi 应用程序的配置区域，并且它可以在安装根目录的文件中使用以下参数。你确定你像这样正确设置配置参数：

```
-Dosgi.configuration.area=c:\mytest 
```

完成此操作并再次运行应用程序后，它创建了文件夹和新配置。

这是我的`.ini`有效文件的副本，osgi params 和 vm args 也很重要。

```
-loglevel=trace
-vmargs
-Dosgi.configuration.area=c:\mytest
-Dorg.osgi.service.http.port=8094
-Declipse.ignoreApp=true
-Dosgi.noShutdown=true
-Dequinox.ds.print=true 
```

# python - 如何将 Google 文档列表 API 与 .jpeg .gif 等非文档文件一起使用？

> ID：13422376
> 
> 赞同：2
> 
> 时间：2012-11-16T18:32:30.810
> 
> 标签：python, google-drive-api, google-docs-api, google-api-python-client

我现在正在使用 gdata-python-client（Google 文档列表 API）在 Linux 操作系统的终端上访问我的 google 驱动器，但我无法显示图像文件——它只显示 .doc .xls 或 .pdf 文件

是否有一些解决方案可以解决我仍在使用 gdata-python-client 的问题？我希望有一些解决方案比将我的 API 更改为 Google drive API 更好，这意味着我应该重新启动我的项目！！。好难过 ：（

如果我改用 Google Drive APIs。怎么办？或者我可以重复使用我的项目与新 API 的兼容性吗？

请给我一些建议或教程。非常非常非常感谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:37:25.927

使用云端硬盘 API。我们有一个 Python[命令行示例](https://developers.google.com/drive/quickstart-python)来帮助您入门，以及每个 API 方法的 Python 片段，包括[files.list](https://developers.google.com/drive/v2/reference/files/list)。

# cocoa - 使用 AFNetworking 通过 POST 上传文件

> ID：13422379
> 
> 赞同：1
> 
> 时间：2012-11-16T18:32:43.577
> 
> 标签：cocoa, post, upload, afnetworking

所以我正在尝试使用 AFNetworking 将 XML 文件上传到带有 POST 的服务器。
所以使用他们网站上的示例代码我已经设置好了。当它运行时，一些东西被上传到服务器（或者至少它离开了我的电脑）。我可以监控上传，当上传完成时，服务器识别它完成并去加载文件，但它加载了一个旧的 XML。所以它正确连接到服务器，但我不确定为什么文件上传不能正常工作。另外我只想发送文件，服务器不需要任何标题或参数等。
所以我想知道我是否正确存储了数据？或者如果我没有正确发送服务器或什么？任何的意见都将会有帮助

```
NSData *iTunesXMLData = [NSData dataWithContentsOfFile:filePath];

AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];

  /* NSMutableURLRequest *request =[httpClientmultipartFormRequestWithMethod:@"POST"     
path:@"/upload.php?id=5" parameters:nil constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
    [formData appendPartWithFileData:iTunesXMLData name:@"iTunes Music Library" fileName:@"iTunes Music Library.xml" mimeType:@"application/xml"];
}];*/

//I tried this way also, both did the same thing

NSMutableURLRequest *request = [httpClient multipartFormRequestWithMethod:@"POST" path:@"/upload.php?id=5" parameters:nil constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
    [formData appendPartWithFormData:iTunesXMLData name:@"iTunes Music Library"];
}];`

 AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];`

NSLog(@"Operation: %@", operation);
[operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
    NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);
}];
[operation start]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T11:54:18.230

您是否尝试过捕捉操作的成功/失败？之后试试这个`setUploadProgressBlock`：

```
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    // Operation ended successfully
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    // Something happened! 
    NSLog(@"ERROR: %@, %@", operation, error);
    // Here you can catch operation.responseString to see the response of your server
}]; 
```

这是了解服务器返回内容的简单方法。如果有内容上传到您的服务器，请仔细检查您是否获得了正确的文件。AFAIK，您的 AFNetwork 似乎还可以。

# go - 惯用缓冲区 os.Stdout

> ID：13422381
> 
> 赞同：46
> 
> 时间：2012-11-16T18:32:54.543
> 
> 标签：go

`os.Stdout.Write()`是*无缓冲*的写入。要获得*缓冲*写入，可以使用以下内容：

```
f := bufio.NewWriter(os.Stdout)
f.Write(b) 
```

**问题：**

有没有更惯用的方法来获得*缓冲*输出？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-16T18:39:36.657

不，这是缓冲写入 Stdout 的最惯用方式。在许多情况下，您还需要添加延迟：

```
f := bufio.NewWriter(os.Stdout)
defer f.Flush()
f.Write(b) 
```

这将确保在您从函数返回时刷新缓冲区。

# c - 如何让 C 中的多个线程在二维数组的同一个 for 循环上工作？

> ID：13422394
> 
> 赞同：5
> 
> 时间：2012-11-16T18:34:04.860
> 
> 标签：c, multithreading, concurrency, pthreads, mutex

我有一个 C 语言程序。

我使用 pthread_create 创建了 3 个线程，并且创建了一个互斥锁以锁定/解锁关键区域。

**pthread_create**的第三个**参数**是指向线程将执行的函数的指针。

 **在我在网上找到的示例中，这个函数 **总是非常简单**，例如打印线程 id 或打印消息。

当线程要执行的函数包含一个**for 循环时会发生什么？**

因为在我的程序中，我希望每个线程都使用二维数组。

每个线程应找到二维数组中一行的总和。例如

**Thread1**应计算二维数组的第一行之和

**Thread2**计算第二行的总和
**Thread1**计算第三行的总和
**Thread3**计算第三行的总和

我不关心线程的顺序，但我需要每个线程都选择其中的一行。

我有以下代码将二维数组中的两个单元格**相加。**

该程序：

1.  **创建 NTHREADS**

    ```
     for(i=0; i < NTHREADS; i++)
        {
           pthread_create( &thread_id[i], NULL, CalculateSum, NULL );
        } 
    ```

2.  **每个线程等待其他线程完成**

    ```
    for(j=0; j < NTHREADS; j++)
       {
          pthread_join( thread_id[j], NULL);
       } 
    ```

3.  每个线程应执行的函数，但对于数组的**一行**而**不是**整个数组是

    ```
    void *CalculateSum(void *dummyPtr)
    {
       pthread_mutex_lock( &mutex1 );

     int i,j,sum = 0;

      for( i = 0; i <= N-1; i++) {
            for( j = 0; j <= M-1; j++) {
                    sum = dimensional_array[i][j] + dimensional_array[i][j];
            }
             printf(" Sum = %d\n", sum);
            }

       counter++;

       pthread_mutex_unlock( &mutex1 );
    } 
    ```

整个程序如下： 程序没有任何编译错误。

为了运行它，你应该这样做：**gcc -pthread program.c**

```
 //program.c

   #include <stdio.h>
   #include <pthread.h>

   #define NTHREADS 3
   void *CalculateSum(void *);
   pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;
   int  counter = 0;

   #define N 10
   #define M 10

   int dimensional_array[N][M];

   main()
   {
      pthread_t thread_id[NTHREADS];
      int i, j;

      for (i = 0; i <= N - 1; i++ )
           for( j = 0; j <= M - 1; j++)
                   dimensional_array[i][j] = i;

      for(i=0; i < NTHREADS; i++)
      {
         pthread_create( &thread_id[i], NULL, CalculateSum, NULL );
      }

      for(j=0; j < NTHREADS; j++)
      {
         pthread_join( thread_id[j], NULL);
      }

      printf("Final counter value: %d\n", counter);

      //print ARRAY
      for (i = 0; i <= N-1; i++ ) {
           for( j = 0; j <= M-1; j++)
                   printf("%d\t",dimensional_array[i][j]);
           printf("\n");
           }
   }
   //Calculate
   void *CalculateSum(void *dummyPtr)
   {
      pthread_mutex_lock( &mutex1 );

    int i,j,sum = 0;

     for( i = 0; i <= N-1; i++) {
           for( j = 0; j <= M-1; j++) {
                   sum = dimensional_array[i][j] + dimensional_array[i][j];
           }
            printf(" Sum = %d\n", sum);
           }

      counter++;

      pthread_mutex_unlock( &mutex1 );
   } 
```

所以，我希望每个线程都能找到一行的总和，但我很困惑，我不知道该怎么做。

在我的程序中，每次线程调用计算函数时，都会计算所有行的总和，而不仅仅是一个

[注意：为简单起见，我将第一个元素与它自己的元素相加，重点是了解这些线程如何全部发生在那个 for 循环中]

如果有人可以帮助我，我会很高兴

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T18:48:09.470

您应该创建一个每个线程参数的数组，并将这些参数一个接一个地传递给线程。在您的情况下，单个指针`int`就足够了：您将其索引`threadindex`从零传递给线程到`NTHREADS`，并且线程将总和传递回这样的行`row % NTHREADS == threadindex`。

这是您的线程函数的外观：

```
void *CalculateSum(void *args)
{
    int *argPtr = args;

    int i,j,sum = 0;
    int threadindex = *argPtr;

    for( i = 0; i <= N-1; i++) {
        if (i % NTHREADS != threadindex) continue;
        for( j = 0; j <= M-1; j++) {
            sum += dimensional_array[i][j];
        }
    }

    pthread_mutex_lock( &mutex1 ); Mutex must go here
    counter++;
    pthread_mutex_unlock( &mutex1 );
    // Pass the value back:
    *argPtr = sum;
}

main()
{
    pthread_t thread_id[NTHREADS];
    int thread_args[NTHREADS];
    int i, j;

    pthread_mutex_init(&mutex1, NULL);

    for (i = 0; i <= N - 1; i++ )
        for( j = 0; j <= M - 1; j++)
            dimensional_array[i][j] = i;

    for(i=0; i < NTHREADS; i++)
    {
        thread_args[i] = i;
        pthread_create( &thread_id[i], NULL, CalculateSum, &thread_args[i]);
    }

    int sum = 0;
    for(j=0; j < NTHREADS; j++)
    {
        pthread_join( thread_id[j], NULL);
        sum += thread_args[i];
    }

    printf("Final counter value: %d. Total: %d\n", counter, sum);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T18:45:36.840

计算一行的总和（忽略线程的东西）：

```
void *CalculateSum(void *dummyPtr)
{
    int j,sum = 0;

    int i = (int)dummyPtr;
    for( j = 0; j <= M-1; j++) {
        sum += dimensional_array[i][j];
    }
    printf(" Sum = %d\n", sum);

    pthread_mutex_lock( &mutex1 );
    counter++;
    pthread_mutex_unlock( &mutex1 );
} 
```

然后像这样创建线程：

```
int line_number = 2;    // Or whatever line to print`enter code here`
pthread_create( &thread_id[i], NULL, CalculateSum, (void *)line_number ); 
```

编辑：把“counter++”放回去。**

# pascal - 多维数组帕斯卡语法错误

> ID：13422397
> 
> 赞同：1
> 
> 时间：2012-11-16T18:34:15.233
> 
> 标签：pascal, multidimensional-array

我这样做并且它的工作稍微好一点，现在我得到错误：45 / 44 matric.pas 致命：语法错误，）预期但发现 const char 这很可能是因为我使用的是帕斯卡图。

```
program MatrixArray;
Uses wincrt,graph;
Var
GraphicsDriver, GraphicsMode: Smallint;
Xaxis: array[1..10] of string;
Yaxis: array[1..10] of string;
Matrix: array[1..10,1..10] of string;
x:integer;
y:integer;
{two var's are needed for initialisation}
Begin
Writeln('Loading Game Graphics...');
GraphicsDriver := Detect;
InitGraph(GraphicsDriver, GraphicsMode,'');
ClearViewPort; 
```

声明数组

```
Xaxis[1] :='A';
Xaxis[1] :='B';
Xaxis[1] :='C';
Xaxis[1] :='D';
Xaxis[1] :='E';
Xaxis[1] :='F';
Xaxis[1] :='G';
Xaxis[1] :='H';
Xaxis[1] :='I';
Xaxis[1] :='J';

Yaxis[1] :='1';
Yaxis[1] :='2';
Yaxis[1] :='3';
Yaxis[1] :='4';
Yaxis[1] :='6';
Yaxis[1] :='7';
Yaxis[1] :='8';
Yaxis[1] :='9';
Yaxis[1] :='10';

for x := 1 to 10 do
 for y := 1 to 10 do
     Matrix[x,y] := Xaxis[x] + Yaxis[y];

     For x := 1 to 10 do
         for y := 1 to 10 do 
```

outtextxy 就像 writeln(); [http://pascal-programming.info/lesson8.php](http://pascal-programming.info/lesson8.php)

```
 OutTextXY(0,0, Matrix[x,y]' ');

End. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:04:20.943

该`OutTextXY`例程可能需要两个整数和一个字符串作为输入。Matrix 数组包含字符串，因此请使用：

```
OutTextXY(0, 0, Matrix[x, y]); 
```

（注意缺少的`' '`。）

# javascript - 为什么移动设备上的本地文件可以跨域脚本编写？

> ID：13422401
> 
> 赞同：4
> 
> 时间：2012-11-16T18:34:29.047
> 
> 标签：javascript, android, ajax, mobile, cross-domain

## 我做了什么：

我用 xss.js 创建了一个 index.html，它调用了 jQuery.get() 函数。然后我在浏览器（Firefox、Chrome、IE 和 Opera）中打开了 index.html 并尝试触发 ajax 请求。

## 编码

这是我的 index.html：

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>XSS</title>
        <script src="libs/js/jquery-1.7.2.js" ></script>
    </head>
    <body>
        <button id="request" >fire</button>
        <script src="libs/js/xss.js" ></script>
    </body>
</html> 
```

和我的 xss.js：

```
function init()
{
    $('#request').click(loadContent);
}

function loadContent()
{
    $.get('http://www.example.com/', null, function(data){
        alert('success');            
        $('body').html(data);            
    }, 'html');

}

init(); 
```

如果我`index.html`在浏览器中打开 ( `file:///C:/workspace/xss%20test/index.html`)，单击按钮后会收到以下响应：

*   **Firefox**：没有错误代码（`HTTP/1.1 200 OK`），但答案为空

*   **IE**：没有答案

*   **铬**： `XMLHttpRequest cannot load http://www.example.com/. Origin null is not allowed by Access-Control-Allow-Origin.`

*   **Opera**`HTTP/1.1 200 OK` :没有错误代码（

此代码将加载`index.html`到我的 Android WebView 中：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        WebView webview = (WebView) findViewById(R.id.webview);

        webview.getSettings().setJavaScriptEnabled(true);
        webview.setWebChromeClient(new WebChromeClient());
        webview.setWebViewClient(new WebViewClient());

        webview.loadUrl("file:///android_asset/www/index.html");
    }
} 
```

在触发按钮后，调用成功回调并`www.example.com`在我的文件正文中显示内容。`index.html`

*（在 iPhone 设备上也是如此——我没有在 Windows Phone 设备上测试过）*。

## tl;博士 - 问题：

为什么可以将内容从远程服务器加载到我的移动设备 - 这不是跨域脚本的情况还是我遗漏了什么？

> 由于浏览器安全限制，大部分“Ajax”请求都受同源策略的约束；请求无法从不同的域、子域或协议成功检索数据。

**另外：**为什么 Opera 收到答案但没有显示任何内容？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T19:16:52.420

实际上，您的代码在移动浏览器上失败，包括 Android 上的 ICS 和 Chrome 以及 iPhone 上的 Safari。但是，您所展示的并不是在浏览器中加载 html 文件 - 而是将其加载到 WebView 中 - 完全不同。

WebView 或 Webkit 只是实现类似浏览器功能的 UI 小部件。它们不是浏览器。它们不提供通常的浏览器 chrome 之类的东西，并且与浏览器相比，它们默认具有非常自由的安全模型。不过，如果需要，您可以添加代码来实现同源策略等。

它不仅在移动设备上。尝试在桌面上创建一个 Webkit 应用程序，你会看到同样的结果。

我相信这样做的原因是 WebViews 和 Webkits 被假定用于显示您 100% 控制的内容。与用户可以在地址栏中输入任何 URL 的浏览器不同。因此，您可以自行决定装载的物品是否安全。

# array-algorithms - 具有正和的列表的子列表

> ID：13422402
> 
> 赞同：1
> 
> 时间：2012-11-16T18:34:36.207
> 
> 标签：array-algorithms

我正在尝试查找具有以下 2 个属性的列表的子列表（至少有一个正整数） 1\. 它的元素之和为正 2\. 它具有所有其他子列表的最大长度和正和

我只对那个列表的长度感兴趣。Kadane 的算法在 O(n) 时间内找到总和最大的子列表。有没有一种算法可以在 O(n) 中做同样的事情？我找到了一个解决方案，但它确实计算了所有子列表，当然非常慢......

感谢您的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T09:52:27.910

一个可能的解决方案在这里。您可以使用[计数排序](http://en.wikipedia.org/wiki/Counting_sort%E2%80%8E)对数组进行排序。在该凝视形式之后，最大元素进行求和并检查是否添加此元素将保留非的正和，如果它仍然为正，则添加并递增计数继续前进。这可能对某些输入有一些错误，我的意思是它可能不适用于所有测试用例。但是，这只是一个可能对您有所帮助的想法，因为对此进行一些改进将为您提供所需的输出。在一个遍历计数变量结束时会给你结果。例子：

```
array=[12,10,8,5,4,-2,-3,-20,-30] //considered already sorted now
i=0 sum=12 count=1
i=1 sum=22 count=2
i=2 sum=30 count=3
i=3 sum=35 count=4
i=4 sum=39 count=5
i=5 sum=37 count=6
i=6 sum=34 count=7
i=7 sum=14 count=8
i=8 sum=14 count=8 //as now 30 cant be added
so, here count=8 says maximum length sub array of 8 can give you positive sum. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-14T06:50:51.710

由于在您的回答中您将子列表视为后续元素，我想对 Kadane 的算法稍作修改将适合您。只需引入一个名为**max_length_till_now**的变量。并在您发现长度大于当前值的子列表时更新它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T13:55:37.160

好的，你几乎已经回答过了。只需修改 Kadane 以使用子序列的长度而不是子序列的总和。这解决了你的问题。这是来自维基百科的 Kadane：

```
int sequence(int numbers[])    
{ 
    // These variables can be added in to track the position of the subarray
    size_t begin = 0;
    size_t begin_temp = 0;
    size_t len_temp = 0;
    size_t end = 0;

    // Find sequence by looping through
    for(size_t i = 1; i < numbers.size(); i++)
    {
            // calculate max_ending_here
            if(max_ending_here < 0)
            {
                    max_ending_here = numbers[i]; 
                    begin_temp = i;
            }
            else
            {
                    max_ending_here += numbers[i];
                    len_temp += (i - begin_temp);
            }

            // calculate max_so_far_len
            if(len_temp >= max_so_far_len )
            {
                    max_so_far_len  = len_temp; 
                    begin = begin_temp;
                    end = i;
            }
    }
    return max_so_far_len ; 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T11:51:48.547

计算所有数字的总和说它是n。如果 n > 0 则返回完整列表作为答案。否则继续从两端修剪较小的元素并从总和中减去，直到总和变为正数。返回 this 作为结果。这是一个 O(n) 算法。希望能帮助到你

# perl - Perl 不能在 Windows 上关闭文件？

> ID：13422412
> 
> 赞同：0
> 
> 时间：2012-11-16T18:35:16.613
> 
> 标签：perl, winapi, io, handle, filehandle

我遇到了一个非常奇怪的行为。

我的 Perl 程序试图关闭 Windows 上的一些文件。事实证明，文件没有关闭 - 并且没有错误消息。

我怎么知道文件没有被关闭？因为当尝试对它们执行 Perl“移动”功能时，它会给出错误：

$!: 权限被拒绝

$^E：该进程无法访问该文件，因为它正被另一个进程使用

我已经在两台不同的计算机上测试了这个程序，一台运行 Windows XP SP 3，另一台运行 Windows 7 - 得到*相同*的结果。

当我使用 Windows“handle.exe”实用程序“破坏”文件时，文件确实会关闭，我可以“移动”（重命名）文件。

（我很抱歉这个问题很长，但否则响应者可能会说没有足够的细节来理解这些问题）。

以下是代码示例。

在这个程序中，如果用户选择“yes”“force_close”，子 force_close 被调用，文件被关闭。如果用户选择“否”，那么只有 Perl 程序在这两个 *.csv 文件上调用了“关闭”函数，实际上它们保持打开状态！（“关闭”返回没有错误！）

重要提示：没有其他进程正在使用这些文件，或者将它们保持打开状态。（都不是可能的“反病毒”）。我怎么知道？因为“force_close”子例程确实成功地关闭了文件，使用连接到 perl.exe 进程的单个 Windows 句柄；如果另一个进程保持文件打开，那么该文件应该有一个额外的打开句柄，Perl“移动”函数将失败。

解释性说明：文件信息保存在简单的散列中，包含文件句柄和模式（除了文件名）。

湾。子程序 YNchoice 是一个简单的单选按钮是/否选择窗口。

主程序：

```
use strict;
 use warnings;
 use 5.014; 
 use Win32::GUI();
 use Win32::Console;
 use autodie; 
 use warnings qw< FATAL utf8 >;
 use Carp;
 use Carp::Always;
 use File::Copy;
 use File::stat;
 use English '-no_match_vars';

my ($i, $j, $k, $sta, $desk, $dw, $dh, $filename, $filename_old, $MovedFileName, $resname_new,
        $resH, $inpH, $TopDir, $InputDir, $pid, $stobj, $fmode, $debug, $forceclose_choice);
my $NL = "\x0A";
my ( %inp_file, %res_file, %log);
sub force_close;
state $prog_name = substr( ProgName(), rindex(ProgName(), '\\')+1);
binmode STDOUT, ':unix:utf8';
binmode STDERR, ':unix:utf8';
binmode $DB::OUT, ':unix:utf8' if $DB::OUT; # for the debugger
Win32::Console::OutputCP(65001);         # Set the console code page to UTF8
$debug = TRUE;
$TopDir = 'E:\My Documents\Technical\Perl\Eclipse workspace';
$desk = Win32::GUI::GetDesktopWindow();
$dw = Win32::GUI::Width($desk);
$dh = Win32::GUI::Height($desk);
$InputDir = Win32::GUI::BrowseForFolder( -root => $TopDir, -includefiles => 1,
                    -title => 'Select directory for file to rename', -newui => 1, 
                    -text =>'text Select directory for file', -size => [60/100*$dw, 60/100*$dh],
                    -position =>  [50/100*$dw, 50/100*$dh], -owner =>$desk);
$log{FileName} = $InputDir.'\Close file test log '.DatenTime().'.txt';
$i = OpenFile \%log, ">:encoding(utf8)",    # Must open log.txt explicitly
            TimeString().SP.ProgName().": opening file: \n".$log{FileName};
if ($i) {
    PrintT $log{HANDLE}, TimeString().SP.ProgName().": opened file '$log{FileName}'";
}   # end if ($i)
binmode $i, ':unix:utf8';
# Select test file to open
$filename = Win32::GUI::GetOpenFileName( -title  => 'Select file to open and close with handle',
        -directory => $InputDir, -file   => "\0" . " " x 256,
        -filter => ["All files", "*.*", "Text files (*.txt)" => "*.txt",],
        -text => 'Select file');
$inp_file{FileName} = $filename;
$inpH = OpenFile \%inp_file, "<:encoding(utf8)",    
            TimeString().SP.$prog_name.": opening file:\n'$inp_file{FileName};";
binmode $inpH, ':unix:utf8';
if ($inpH) { #1
    say ": opened file:\n'$inp_file{FileName}'";
}   # end if ($inpH)
else { #1
    confess "Opening file '$inp_file{FileName}' failed";
} #1 end else if ($inpH)

$j = rindex $inp_file{FileName}, '.';
$res_file{FileName} = substr($inp_file{FileName}, 0, $j).' res.csv';
$resH = OpenFile \%res_file, '>:encoding(utf8)', 
                ": opening \$res_file for output:\n'$res_file{FileName}'";
binmode $resH, ':unix:utf8';
local $/ = "\x0D\x0A";
while (<$inpH>) { #1
    chomp;
    $i = $_;
    s{^(.*)(?<!\x0D)\x0A(.*)$}{$1$2}g;  # delete newlines not preceded by cr
                                                    # See http://stackoverflow.com/questions/11391721
                                                    # and http://perldoc.perl.org/perlport.html#Newlines
    $i = $_;
    PrintT $resH, $_;
}   #1 end while (<$inpH>)

CloseFile \%inp_file, TimeString(), SP, $prog_name, ": closing file: \n",
                                                                                    $inp_file{FileName};
CloseFile \%res_file, TimeString(), SP, $prog_name, ": closing file: \n", $res_file{FileName};

${^WIN32_SLOPPY_STAT} = TRUE;   # see http://perldoc.perl.org/perlport.html#stat
$stobj = stat $inp_file{FileName};
$fmode =  sprintf "%04o", $stobj->mode & 07777;
say ": for file \$inp_file{FileName}:\n'$inp_file{FileName}'\n",
    'Mode is: ', $fmode, ', $stobj->mode = ', $stobj->mode;
$forceclose_choice = YNChoice Question => 'force_close $inp_file and $res_file?',
                                        Debug => $debug, SizeRef => [30,15], LogRef => \%log;
if ($forceclose_choice) { #1
    $pid = $PID;
    force_close FileName => $inp_file{FileName}, owning_process => $pid, LogRef => \%log,
            Debug => $debug;
}  #1
$filename_old = substr($inp_file{FileName}, 0, $j).' old.csv';
say ": moving file:\n", "'$inp_file{FileName}' to:\n", "'$filename_old'\n";
$sta = move $inp_file{FileName}, $filename_old;
unless ($sta) { #1
    confess "\n", $prog_name, ": problem renaming incoming file to '*.old'\n",
                                                                                        "\$!: $!\n", "\$^E: $^E";
} #1 end unless ($sta)
else { PrintDebug $debug, \%log, $prog_name, ': moving succeeded'; }
$resname_new = substr($inp_file{FileName}, 0, $j).'.csv'; # the original incoming filename
$inp_file{FileName} = $filename_old;
if ($forceclose_choice) { #1
    force_close FileName => $res_file{FileName}, owning_process => $pid, LogRef => \%log,
                Debug => $debug;
}  #1
say ": renaming file:\n", "'$res_file{FileName}' to:\n", "'$resname_new'\n";
$sta = move $res_file{FileName}, $resname_new;
unless ($sta) {  #1
        confess $prog_name, ": problem renaming ResFile to original\n", "\$!: $!\n", "\$^E: $^E";
} #1 end unless ($sta)
else { say ': moving succeeded'; }
$res_file{FileName} = $resname_new; 
```

子程序 OpenFile 和 CloseFile：

```
sub OpenFile {      # Call: OpenFile \%FileStruct, $Mode, $Message [,$Message ...];
    my ($FileRef, $Mode) =@_[0..1];
    my ($HANDLE, $FileName, $sta);
    $FileName = $FileRef->{FileName};
    if (@_ >=3) { #1
        foreach (@_[2..(scalar @_-1)]) { #2
            print $_;
        }   #2 end foreach (@_[2..(scalar @_ -1)])
        print "\n";
    }   #1 end if (@_ >=3)
    unless ( defined $FileName) { confess 'Utilities::OpenFile: $FileName undefined';}
    elsif ($Mode =~ m{.*<.*}) { #1 
        unless (-e $FileName) { #2
            confess "Utilities::OpenFile: file '$FileName' does not exist'";
        }   #2 end unless (-e $FileName)
    }   #1 end elsif (! defined $FileName)
    unless ( defined $FileRef->{HANDLE} and defined openhandle($FileRef->{HANDLE}) 
                and defined $FileRef->{Mode} and ($FileRef->{Mode} =~ m{^.*<.*$})) { #1
        $sta = open ($HANDLE, $Mode, $FileName);
        if ($sta) { #2
            $FileRef->{HANDLE} = $HANDLE;
            $FileRef->{Mode} = $Mode;
        } else { #2
            confess "Can't open \$HANDLE: file:\n'$FileName'\n\$!: $!\n\$^E: $^E"; 
        }    #2 end else if ! $sta
    } #1 end unless (if not) file is open
    else { #1 file is open
        say ' called from ', CallerName(),': file ', $FileRef->{FileName},' is open';
        $sta = TRUE;
    } #1 end else file is open
    return ($sta ? $HANDLE : $sta);
  }  # end sub OpenFile

sub CloseFile { # Call: CloseFile \%FileStruct, $Message [,$Message ...];
    my $FileRef = shift;
    my ($HANDLE, $FileName, $sta);
    $FileName = $FileRef->{FileName};
    if (@_ >=1) { #1  There is a message
        foreach (@_) { #2
            print $_;
        }   #2 end foreach (@_[1..(scalar @_ -1)])
        print "\n";
    }   #1 end if (@_ >=3)
    unless (-e $FileName) { #1
        confess SubName().": file '$FileName' does not exist'";
    }   #1 end unless (-e $FileName)
    unless ( defined $FileName) { confess SubName().': $FileName undefined';}
    unless (defined openhandle($FileRef->{HANDLE})) { #1
        say ": file $FileName is closed!";
        $sta = 0;                                                   
    } else {  #1
        $sta = close $FileRef->{HANDLE};
        unless ( $sta) {  #2
            confess "Can't close \$HANDLE: file:\n'$FileName'\n\$!: $!\n\$^E: $^E";
        } else {  #2
            undef $FileRef->{Mode};
        }  #2 end else $sta
    } #1 end else defined handle
    return $sta;
} # end sub CloseFile 
```

子程序 force_close：

```
sub force_close { # close $FileStruct{FileName} using MS handle -------------------- force_close
# call: $sta = force_close FileName => $file_name, owning_process => $pid, LogRef = \%Log,
#               Debug = $debug;
my %parms = @_;
my ($i, $j, $sta, $stobj, $fmode, $HANDLE, $command, $pid, $Windows_handle, $filename,
            $filename_reg, $file_line, $lineno, $file_lineno, $s1succ, $s2succ);
my @handle_output;
state $handleloc = '"E:\\WinXP Programs\\System\\Utilities\\handle"';  #Location of MS handle.exe
local $/ = "\x0A";
# get all open files for the perl process
$pid = $parms{owning_process};
$filename = $parms{FileName};
$filename_reg = qr{\Q$filename\E};
$sta = open $command, "$handleloc -p $pid |";
unless ($sta) { #1
    confess "\n", SubName(), ': problem invoking handle command',
                                                                                    "\$!: $!\n", "\$^E: $^E";
} #1 end unless ($sta)
$lineno = 0;
while (<$command>) {
    chomp;
    $j = $_;
    if (m{$filename_reg} ) {
        $file_line = $_;
        $file_lineno = $lineno;
    }   # end if (m{$filename_reg} )
    push @handle_output, $_;
    say "\$lineno = $lineno\n", $_;
    ++$lineno;
} # end while (<$command>)
close $command;

if  (defined $file_line) { # 1
    say ': found line with $parms{FileName}, no.:', $file_lineno, ", Line:\n'$file_line'";
    # get handle number for the file we want to close
    $file_line =~ m{^\s*(\w+)\:};
    unless (defined $1) { confess '$1 not defined'};
    $Windows_handle = defined $1 ? $1 : '';
    @handle_output = ();    # release array
    # force close the file
    $sta = open $command, "$handleloc -c $Windows_handle -p $pid -y |";
    unless ($sta) { #1
        confess "\n", SubName(), ': problem invoking handle command',
                                                                                        "\$!: $!\n", "\$^E: $^E";
    } #1 end unless ($sta)
    while (<$command>) {
        chomp;
        $j = $_;
        push @handle_output, $_;
        PrintDebug $parms{Debug}, $parms{LogRef}, $_;
    } # end while (<$command>)
    close $command;
}  # 1  end if (defined $file_line)
else  { #1 
    say ': couldn\'t find match for {FileName}, $file_line not defined',
                "\n", '@handle_output =', scalar @handle_output, ", \$pid= $pid";
    confess '';
}   # end else (! defined $file_line)
}   # end sub force_close 
```

子程序 YNCoice 和 TerminateWindow：

```
sub YNChoice { # Ask a yes/no question, in a 2 radio boxes window  
        # call: $answer = YNChoice (Question => $Question, SizeRef => \@Size,
        #       PosRef => \@Pos, (in percentages), LogRef => \%Log, Debug => $Debug); 
        #       Size and Pos (in percent of desktop) are optional
my %parms = @_;
my ($i, $j, $k, $desk, $w, $h, $WindowChoice, $wPCT, $hPCT, $deskw, $deskh, $x, $y, $xPCT, $yPCT);
my $wPCTmin =20; my $hPCTmin = 15;
my @UserChoice;
$desk = Win32::GUI::GetDesktopWindow();
$deskw = Win32::GUI::Width($desk);
$deskh = Win32::GUI::Height($desk);
$xPCT = (defined $parms{PosRef}[0] and $parms{PosRef}[0] >=0 and $parms{PosRef}[0] <=100) ?
                ($parms{PosRef}[0]) : 20;
$yPCT = (defined $parms{PosRef}[1] and $parms{PosRef}[1] >=0 and $parms{PosRef}[1] <=100) ?
                ($parms{PosRef}[1]) : 20;
$wPCT = (defined $parms{SizeRef}[0] and $parms{SizeRef}[0] >=0 and $parms{SizeRef}[0] <=100) ?
                $parms{SizeRef}[0] : 20;
$wPCT = $wPCT >= $wPCTmin ? $wPCT : $wPCTmin;
$hPCT = (defined $parms{SizeRef}[1] and $parms{SizeRef}[1] >=0 and $parms{SizeRef}[1] <=100) ?
                $parms{SizeRef}[1] : 12;
$hPCT = $hPCT >= $hPCTmin ? $hPCT : $hPCTmin;
$WindowChoice = Win32::GUI::Window->new( -name => 'choice', -text => $parms{Question},
        -pos => [$xPCT/100*$deskw, $yPCT/100*$deskh], 
        -size => [$wPCT/100*$deskw,$hPCT/100*$deskh], -dialogui => 1,
        -onTerminate => \&TerminateWindow, -tabstop => 1,
        -addexstyle => WS_EX_TOPMOST, -cancel => 1, );
$WindowChoice -> AddRadioButton ( -name => 'ButtonRadioYes', -pos => [10,10],
                        -size => [20,20], -onClick => sub { &RadioClickYes(\@UserChoice) });
$WindowChoice -> AddLabel (-name => 'LabelRadioYes', -text=> 'Yes', -pos => [30,10],
                        -size => [40,20]);
$WindowChoice -> AddRadioButton ( -name => 'ButtonRadioNo', -pos => [10,40],
                        -size => [20,20], -onClick => sub { &RadioClickNo(\@UserChoice) });
$WindowChoice -> AddLabel (-name => 'LabelRadioNo', -text=> 'No', -pos => [30,40],
                        -size => [40,20]);
$WindowChoice ->Show();
Win32::GUI::Dialog();
TerminateWindow();
return $UserChoice[0];
} # end sub YNChoice

sub TerminateWindow {
    return -1;
} # end sub TerminateWindow 
```

子程序 RadioClickYes 和 RadioClickNo：

```
sub RadioClickYes {
    $_[0][0] = 1;
    TerminateWindow();
} # end sub RadioClickYes

sub RadioClickNo {
    $_[0][0] = 0;
    TerminateWindow();
} # end sub RadioClickNo 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-17T15:09:50.867

每次调用 OpenFile 并成功打开文件时，都会创建 2 个文件句柄，但只关闭其中一个。

以下是 OpenFile 中关键的单独代码行。

这是第一个文件句柄：

> $sta = 打开 ($HANDLE, $Mode, $FileName);

这是你复制它的地方：

> $FileRef->{句柄} = $句柄；

在这里，您将返回第一个：

> 返回 ($sta ? $HANDLE : $sta);

这是 sub 的调用

> $i = OpenFile \%log, ">:encoding(utf8)", ....

所以，现在您在 $i 中有一个句柄，在 $log{HANDLE} 中有第二个句柄

# spring-mvc - 如何在spring select标签中禁用多个属性

> ID：13422416
> 
> 赞同：0
> 
> 时间：2012-11-16T18:35:25.543
> 
> 标签：spring-mvc

我有以下代码：

```
<form:select path="roles" items="${roleList}" itemLabel="roleType" itemValue="id" /> 
```

它生成的html如下：

```
<select id="roles" name="roles" multiple="multiple">
 <option value="1">ROLE_ADMIN</option>
 <option value="2">ROLE_HQ</option>
 <option value="3">ROLE_MASTER</option>
 <option value="4">ROLE_STATE</option>
 <option value="5">ROLE_CENTRE</option>
</select> 
```

另外我不使用`multiple`可选属性。知道为什么生成的 HTML 包含`"multiple="multiple"`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:38:06.490

只是一个猜测，但由于您将其映射到`roles`，并且角色可能是一个集合，因此将选择框设为多个是有意义的。如果不是多个，您将只能在集合中存储单个项目。并且标签将无法显示所选角色。

编辑：阅读标签的源代码后，看来我的猜测是正确的。见中的`forceMultiple()`方法`SelectTag`。

# django - 无法访问静态资源

> ID：13422419
> 
> 赞同：2
> 
> 时间：2012-11-16T18:35:33.160
> 
> 标签：django, amazon-s3, django-cache, django-compressor, mezzanine

我正在使用 Mezzanine、django-compressor 和 amazon-s3。我使用 django-compressor 来压缩 css 文件。我已经将网站部署到 Heroku 并成功存储了静态资源。但是，一段时间后，所有的CSS都丢失了。以下是来自 amazon-s3 的通知：

```
<Error>
<Code>AccessDenied</Code>
<Message>Request has expired</Message>
<RequestId>FCE5D863FC2EBB9D</RequestId>
<Expires>2012-11-16T17:30:01Z</Expires>
<HostId>
aXa9JBZWx5UiwJmIfpTXsUZgeNGQDONx0G/IezufvWv1FwAUlnK8bzo2u+Qdsenj
</HostId>
<ServerTime>2012-11-16T18:10:17Z</ServerTime>
</Error> 
```

这是设置中的配置：

```
from datetime import date, timedelta
ten_years = date.today() + timedelta(days=365*10)
# Expires 10 years in the future at 23h GMT
AWS_HEADERS = {
    'Expires': ten_years.strftime('%a, %d %b %Y 23:00:00 GMT'),
    'Cache-Control': 'max-age=386900',
} 
```

请帮我解决这个问题。我找不到根本原因。太感谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-07T12:57:32.500

这是因为访问签名的 url。您可以在 settings.py 中进行以下设置以避免这种情况

```
AWS_QUERYSTRING_AUTH = False 
```

# java - Spring with STS：如何使用具有旧依赖项的项目？

> ID：13422422
> 
> 赞同：3
> 
> 时间：2012-11-16T18:35:56.827
> 
> 标签：java, eclipse, spring

我有关于 Spring 编程的书籍。事实证明，让环境运转起来比尝试编写代码更难。

我的具体例子适用于一般情况。我正在尝试加载和运行 APress Pro Spring 3 书的作者提供的 ProSpring3 项目。我从 springsource.org 获得了最新的 STS（这是 spring-tool-suite-3.1.0.RELEASE-e4.2-win32-x86_64-installer.exe）。它安装并似乎运行正常。在我的 Win 7 PC 上，我设置了权限、环境变量等，以使文件可以复制并让 maven 正常运行。

现在从[https://github.com/prospring3/springblog](https://github.com/prospring3/springblog)获取项目。它以 ZIP 格式下载，我将代码安装在我的项目目录中。STS 说这是一个需要转换的旧项目，我让它。

我尝试更新项目，或者在服务器中运行它。关于缺少 JAR 文件的投诉——大约 80 个。它想要的那些在 .m2 目录中。以下是错误示例：

> 读取文件时出错 C:\Users\Jerome.m2\repository\org\springframework\spring-context\3.1.0.RELEASE\spring-context-3.1.0.RELEASE.jar C:\Users\Jerome.m2\repository\ org\springframework\spring-context\3.1.0.RELEASE\spring-context-3.1.0.RELEASE.jar（系统找不到指定的文件）

所以我认为，更新依赖关系应该很容易，因为这就是我使用这个软件堆栈的原因，对吧？也许如果我将版本更改为 3.1.1，因为那是我似乎拥有的版本，那么*某些东西*（Maven？Roo？）将开始自动为我修复问题。到目前为止，对我来说不是这样。我认为该目录缺少*每个*JAR 文件。

我去 github.com 找到了一个包含 Pet Clinic 的 spring-samples 版本。我找到了一个，但*它*坚持使用“3.0.5.RELEASE”之类的东西。

每当我获得 Spring 库的更新版本时，我编写的每个项目都会中断大约 50-100 行，这是真的吗？

还是在 STS 的某个地方我还没有发现一根魔杖？

# r - 如何通过 R 创建 GUI？

> ID：13422427
> 
> 赞同：11
> 
> 时间：2012-11-16T18:36:10.633
> 
> 标签：r, plot, interactive

现在我的绘图有几个参数。所以我想创建一个 GUI，其中包含一些用于控制连续参数的滑块、一些用于控制逻辑参数的复选框/选项按钮以及一个用于选择数据文件的对话框。当我改变参数时，我希望我的情节可以立即改变。我做了一些快速搜索，比如“r control”或“r interactive”，但没有找到有趣的东西。谁能给我一些提示？谢谢你。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-16T18:37:50.687

[R 常见问题解答中](http://cran.r-project.org/doc/FAQ/R-FAQ.html#R-Web-Interfaces)有一个完整的部分专门介绍了*Web 界面*方面。最新的竞争者很[闪亮](http://www.rstudio.com/shiny/)，绝对值得一看。

如果你想要桌面 GUI，这也是一个常见问题解答，因为 R 通过 tcltk 包 a 有这个问题十年以上，还有 John Verzani 等人的优秀[gWidgets 抽象](http://cran.r-project.org/web/packages/gWidgets/index.html)。

# ruby-on-rails - Ruby on Rails Heroku 设置域的第一部分

> ID：13422429
> 
> 赞同：1
> 
> 时间：2012-11-16T18:36:17.740
> 
> 标签：ruby-on-rails, heroku

我开发了一个 RoR 应用程序。我想更新它以处理多个客户。例如，一个客户可能使用 ame.requestsys.com，而另一个客户可能使用 slc.requestsys.com。

目前在 Heroku，我有 requestsys.com 和 www.requestsys.com

有人告诉我我需要 *.requestsys.com --> 对吗？如果是，为什么 Heroku 不让我添加它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:06:22.317

从应用程序目录中的命令行执行：

```
$ heroku domains:add *.requestsys.com 
```

您也可以从 heroku 仪表板执行此操作。

然后在您的 DNS 中相应地设置一个 CNAME 以指向 yourapp.herokuapp.com

尝试本指南以获取更多信息： [https](https://devcenter.heroku.com/articles/custom-domains#wildcard-domains) ://devcenter.heroku.com/articles/custom-domains#wildcard-domains 。

基本上你想做的是一个多租户应用程序，有几个关于这个主题的 railscasts：

[http://railscasts.com/episodes?search=multitenancy](http://railscasts.com/episodes?search=multitenancy)

但这超出了问题的范围。

# asp.net - 对象引用不设置对象的实例

> ID：13422431
> 
> 赞同：0
> 
> 时间：2012-11-16T18:36:18.460
> 
> 标签：asp.net, linq

在详细视图中，我有用户控制，我喜欢用它来填充它的属性

```
foreach (var file in fileList.Efiles) 
```

但我有错误“对象引用不设置对象的实例”（fileList.Efiles）

请帮助是什么问题

完整的代码如下：

```
 public partial class DocResult : System.Web.UI.Page
{

    private EDMSDataContext _DataContext;
    private int _TransmittalId;
    private int _DocId;
    protected void Page_Load(object sender, EventArgs e)
    {
        String tmpString1;
        String tmpString2;
        tmpString1 = Request.QueryString["DocId"];
        if (String.IsNullOrEmpty(tmpString1))
            throw new ArgumentNullException("DocId");
        _DocId = Convert.ToInt32(tmpString1);

        tmpString2 = Request.QueryString["TransID"];
        if (String.IsNullOrEmpty(tmpString2))
            throw new ArgumentNullException("TransID");
        _TransmittalId = Convert.ToInt32(tmpString2);

        _DataContext = new EDMSDataContext();
        var query = _DataContext.spDocResult(_DocId, _TransmittalId);
        DetailsView1.DataSource = query.ToList();
        DetailsView1.DataBind();
        spDocResultResult docresult = (spDocResultResult)DetailsView1.DataItem;
        FileTemp fileList = (FileTemp)DetailsView1.FindControl("FileTemp1");

        foreach (var file in fileList.Efiles)

        {
            file.FileName = docresult.Filename;
        }

        fileList.DataBind();

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:41:22.253

试试下面的代码

```
if(fileList!=null)
{
   foreach (var file in fileList.Efiles)

  {
    file.FileName = docresult.Filename;
  }
 fileList.DataBind();
} 
```

# python - Python Cherrypy：禁用请求记录

> ID：13422438
> 
> 赞同：4
> 
> 时间：2012-11-16T18:36:40.387
> 
> 标签：python, cherrypy

我正在尝试使来自 CherryPy 的 http 请求的日志记录静音。我试过了

```
cherrypy.log.access_file = None 
```

据我了解，它应该删除访问日志记录的处理程序，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-12-09T21:11:11.677

显然，当您独立配置 Python`logging`模块时，告诉 CherryPy 停止记录实际上并没有做任何事情。解决方案是这样做：

```
cherrypy.log.error_log.propagate = False
cherrypy.log.access_log.propagate = False 
```

（[此博客文章的](http://blog.fealdia.org/2011/04/19/how-to-prevent-cherrypy-from-logging-after-logging-basicconfig/)提示，不幸的是现在已关闭。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-19T10:44:10.043

这是我通常的做法：

```
 access_log = cherrypy.log.access_log
    for handler in tuple(access_log.handlers):
        access_log.removeHandler(handler) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:48:23.130

它在最新版本的 CherryPy的[文档页面](http://docs.cherrypy.org/stable/refman/_cplogging.html#custom-handlers)`""`上说将处理程序设置为不`None`

```
# Remove the default FileHandlers if present.
log.error_file = ""
log.access_file = "" 
```

# xquery - 通过 XCC 将 XQuery xml 元素作为外部变量传递给 Marklogic

> ID：13422445
> 
> 赞同：8
> 
> 时间：2012-11-16T18:37:10.383
> 
> 标签：xquery, marklogic

我们有一个相当简单的 XQuery 和 Groovy 代码，如下所示。查询代码：

```
declare variable $criteria as element(criteria) external ;

<scopedInterventions>{
$criteria/equals/field
}</scopedInterventions> 
```

这是试图调用它的测试代码

```
def uri = new URI("xcc://admin:admin@localhost:8001")

def contentSource = ContentSourceFactory.newContentSource(uri)

def request = session.newModuleInvoke("ourQuery.xqy")
def criteria =
"""<criteria>
<equals>
<field>status</field>
<value>draft</value>
</equals>
</criteria>
"""

request.setNewVariable("criteria",ValueType.ELEMENT, criteria);

session.submitRequest(request).asString()
} 
```

我们在执行时收到此错误：

> 引起：com.marklogic.xcc.exceptions.XQueryException: XDMP-LEXVAL: xs:QName("element()") -- 无效的词法值 "element()" [Session: user=admin, cb={default} [ ContentSource: user=admin, cb={none} [provider: address=localhost/127.0.0.1:9001, pool=1/64]]] [Client: XCC/5.0-3, Server: XDBC/5.0-3] expr : xs:QName("element()") at com.marklogic.xcc.impl.handlers.ServerExceptionHandler.handleResponse(ServerExceptionHandler.java:34) at com.marklogic.xcc.impl.handlers.EvalRequestController.serverDialog(EvalRequestController.java :83) com.marklogic.xcc.impl.handlers.AbstractRequestController.runRequest(AbstractRequestController.java:84) com.marklogic.xcc.impl.SessionImpl.submitRequestInternal(SessionImpl.java:373) com.marklogic.xcc。 impl.SessionImpl.submitRequest(SessionImpl.java:356) 在 com.zynx.galen.dataaccess.MarkLogicUtilities.executeQueryWithMultipleXMLParameters(MarkLogicUtilities.groovy:52) 在 com.zynx.galen.repositories.ScopedInterventionService.getScopedInterventionsByCriteria(ScopedInterventionService.groovy:20) ... 还有 1 个

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T21:30:26.160

[http://docs.marklogic.com/javadoc/xcc/overview-summary.html](http://docs.marklogic.com/javadoc/xcc/overview-summary.html)有答案，我认为：

> 使用查询传递变量
> 
> 变量可以绑定到 Request 对象。当使用 Session.submitRequest(Request) 向服务器发出执行请求时，当前绑定到 Request 对象的所有变量都被发送并定义为服务器执行上下文中的外部变量。
> 
> XCC 允许您创建 XdmNodes 和 XdmSequences，以及 XdmAtomic 值。但是，在最初的 XCC 版本中，这种类型的值可能不会绑定为外部变量，因为 MarkLogic Server 还不能接受它们。预计未来版本会提供此功能。

由于`XdmNode`不支持，我想它的子类 XdmElement 也不支持。所以这些类只对响应有用，对请求没有用。错误消息可能需要改进。

您可以使用 传递 XML 字符串`setNewStringVariable`，然后调用`xdmp:unquote`您的 XQuery 模块。请注意，它`xdmp:unquote`返回一个文档节点，因此`/*`XPath 步骤产生它的根元素。

```
declare variable $xml-string as xs:string external ;
declare variable $criteria as element(criteria) := xdmp:unquote($xml-string)/* ;
.... 
```

# android - 空指针异常解析json使用GSON Android

> ID：13422448
> 
> 赞同：1
> 
> 时间：2012-11-16T18:37:18.903
> 
> 标签：android, eclipse, json, android-asynctask, gson

我正在调用从数据库中获取数据并输出以下 JSON 的 Web 服务：

```
{"eventId":"1","eventTitle":"opening ceremony","eventCategory":"store","eventSubCategory":"clothing","eventDescription":"This is an event description of some kid for the first event","eventDate":"13/05/2012","eventTime":"14:52","eventAddress":"49 somerset road","eventCity":"southsea","eventCountry":"UK","eventWebsite":"www.nxtldn.com","eventEmail":"lg@nxtldn.com","eventPhone":"07757491567","eventKeywords":"clothes, street, wear, heart, love"},{"eventId":"2","eventTitle":"cupcakes","eventCategory":"Store","eventSubCategory":"food","eventDescription":"This is an event description of some kid for the second event","eventDate":"17/05/2012","eventTime":"11:22","eventAddress":"12 cleveleys road","eventCity":"london","eventCountry":"UK","eventWebsite":"www.ashshort.com","eventEmail":"ashshort@short.com","eventPhone":"0778514562","eventKeywords":"cupcakes, store, london, hipster"}] 
```

[我附加的（我已经使用http://jsonlint.com/](http://jsonlint.com/)测试了 JSON 是否有效）：

```
{"Events":[{"eventId":"1","eventTitle":"opening ceremony","eventCategory":"store","eventSubCategory":"clothing","eventDescription":"This is an event description of some kid for the first event","eventDate":"13/05/2012","eventTime":"14:52","eventAddress":"49 somerset road","eventCity":"southsea","eventCountry":"UK","eventWebsite":"www.nxtldn.com","eventEmail":"lg@nxtldn.com","eventPhone":"07757491567","eventKeywords":"clothes, street, wear, heart, love"},{"eventId":"2","eventTitle":"cupcakes","eventCategory":"Store","eventSubCategory":"food","eventDescription":"This is an event description of some kid for the second event","eventDate":"17/05/2012","eventTime":"11:22","eventAddress":"12 cleveleys road","eventCity":"london","eventCountry":"UK","eventWebsite":"www.ashshort.com","eventEmail":"ashshort@short.com","eventPhone":"0778514562","eventKeywords":"cupcakes, store, london, hipster"}]} 
```

我使用 AsyncTask 调用它

```
public class EventSync extends AsyncTask<String, Integer, EventsList> {

EventsList elist1 = new EventsList();

@Override
protected EventsList doInBackground(String... urls) {
    String tempurl = urls[0];
    String output = "";
    InputStream is = null;
    StringBuilder sb = new StringBuilder();
    EventsList list = new EventsList();
    try
    {
        URL url = new URL(tempurl);
        HttpURLConnection con = (HttpURLConnection) url.openConnection();
        con.connect();
        is = con.getInputStream();

        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        String line = null;

        while((line = reader.readLine()) != null)
        {
            sb.append(line + "\n");
        }

    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
    finally
    {
        try
        {
            is.close();
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }
    }

    output = sb.toString();
    String json = "{\"Events\":" + output + "}";
    System.out.println(json);
    Gson gson = new Gson();
// When debugging this is the line I believe it fails on, It points to a bit of memory but the list is empty.
    EventsList jsonlist = gson.fromJson(json, EventsList.class);

    return jsonlist;
}

@Override 
protected void onPostExecute(EventsList list)
{

    System.out.println("in on post");
    for (Event event : list.getEvents())
    {
        System.out.println(event.getEventId());
    }
}} 
```

```
public class EventsList {

public EventsList(){

}

private List<Event> events;

public List<Event> getEvents()
{
    return events;
}

public void setEventsList(List<Event> events)
{
    this.events = events;
}} 
```

```
public class Event {

private String eventId;
private String eventTitle;
private String eventCategory;
private String eventSubCategory;
private String eventDescription;
private String eventDate;
private String eventTime;
private String eventAddress;
private String eventCity;
private String eventCountry;
private String eventWebsite;
private String eventEmail;
private String eventPhone;
private String eventKeywords;

public Event()
{

}

// ALL GETS AND SETS 
```

目前我只是想测试它是否会在我使用自定义适配器填充列表视图之前返回。但不幸的是，我收到以下错误：

```
11-10 23:37:08.315: E/AndroidRuntime(5592): FATAL EXCEPTION: main
11-10 23:37:08.315: E/AndroidRuntime(5592): java.lang.NullPointerException
11-10 23:37:08.315: E/AndroidRuntime(5592):     at com.nxtldn.trill.EventSync.onPostExecute(EventSync.java:71)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at com.nxtldn.trill.EventSync.onPostExecute(EventSync.java:1)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at android.os.AsyncTask.finish(AsyncTask.java:631)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at android.os.AsyncTask.access$600(AsyncTask.java:177)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at android.os.Looper.loop(Looper.java:137)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at android.app.ActivityThread.main(ActivityThread.java:4745)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at java.lang.reflect.Method.invokeNative(Native Method)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at java.lang.reflect.Method.invoke(Method.java:511)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
11-10 23:37:08.315: E/AndroidRuntime(5592):     at dalvik.system.NativeStart.main(Native Method) 
```

我是android新手，所以我不确定是否有更好的方法或者正确的方法是什么。

为什么 GSON 不接受并返回空指针是我的 JSON 结构的原因吗？

非常感谢任何可以提供帮助的人:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:38:23.693

尝试改变

```
EventsList jsonlist = gson.fromJson(json, EventsList.class); 
```

到

```
Event[] jsonlist = gson.fromJson(json, Event[].class); 
```

这是假设您在 Web 服务中使用了 Event 类型的数组（如上图所示）来创建此 json。我认为当前的问题是您的 json 字符串与 EventList 类不匹配，因此返回 null。确保您的服务和 android 项目中的 Event 类匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:46:54.777

在 EventsList 中，您期望一个 List(Collection) 事件，但您附加的 JSON 实际上是一个对象："{\"Events\":" + output + "}"; 也许您希望它看起来像这样：

```
"{\"Events\":[" + output + "]}"; 
```

这会将您的单个事件放入一系列潜在事件中。您的用例令人困惑，我不确定您为什么要将单个 JSON 对象放入数组中，但也许我缺少更多细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:40:10.643

I found it was due to me adding "/n" to my string builder, creating the new line and chopping off the final } of the json. Thanks everyone

# android - 有 2 个微调器的错误

> ID：13422453
> 
> 赞同：0
> 
> 时间：2012-11-16T18:37:50.513
> 
> 标签：android

我有这种类型的错误你能帮我解决它吗？或者知道这个代码我用它与其他类的其他微调器一起使用它是什么问题，所以它有点让我感到困惑，因为我有这个问题微调还是没有？她是我的日志猫

```
 11-16 21:56:27.841: E/AndroidRuntime(794): FATAL EXCEPTION: main
11-16 21:56:27.841: E/AndroidRuntime(794): java.lang.NullPointerException
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.widget.ArrayAdapter.getCount(ArrayAdapter.java:291)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.widget.AbsSpinner.setAdapter(AbsSpinner.java:113)
11-16 21:56:27.841: E/AndroidRuntime(794):  at com.example.test1.MainActivity$LoadAllSection.onPostExecute(MainActivity.java:220)
11-16 21:56:27.841: E/AndroidRuntime(794):  at com.example.test1.MainActivity$LoadAllSection.onPostExecute(MainActivity.java:1)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.os.AsyncTask.finish(AsyncTask.java:417)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.os.AsyncTask.access$300(AsyncTask.java:127)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.os.Looper.loop(Looper.java:123)
11-16 21:56:27.841: E/AndroidRuntime(794):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-16 21:56:27.841: E/AndroidRuntime(794):  at java.lang.reflect.Method.invokeNative(Native Method)
11-16 21:56:27.841: E/AndroidRuntime(794):  at java.lang.reflect.Method.invoke(Method.java:521)
11-16 21:56:27.841: E/AndroidRuntime(794):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-16 21:56:27.841: E/AndroidRuntime(794):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-16 21:56:27.841: E/AndroidRuntime(794):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:57:37.043

从日志猫：

```
Caused by: java.lang.NullPointerException
    at com.example.test1.MainActivity$LoadAllSection.doInBackground(MainActivity.java:195) 
```

既然你说这是第 195 行：

```
sectionList.add(map1); 
```

`sectionList`这只是意味着`null`，您忘记使用以下命令对其进行初始化：

```
sectionList = new ArrayList<HashMap<String, String>>(); 
```

* * *

好的，对于您的新 LogCat，问题从第 220 行开始，这似乎是：

```
spinner2.setAdapter(adapter2); 
```

再次`sectionList`受到责备，仅当您尝试传递绑定到`null`数据集的适配器时才会发生此错误。

# javascript - 从更新面板内部运行 Javascript

> ID：13422454
> 
> 赞同：0
> 
> 时间：2012-11-16T18:38:05.367
> 
> 标签：javascript, asp.net, updatepanel

我在更新面板中有一个 asp 按钮，我希望每次单击按钮时，都应该执行 JavaScript 代码。我正在使用`ScriptManager.RegisterStartupScript`在后面的代码中注册 JavaScript。

当我第一次单击该按钮时。JS 代码已执行，但之后无法正常工作。

我的代码片段：

```
ScriptManager.RegisterStartupScript(this.Page.GetType(), "script", 
     "showNotification()", true); 
```

# mysql - MySQL - 查询组合具有相同 ID 的行并保留该 ID 的所有条目但作为一条记录

> ID：13422461
> 
> 赞同：13
> 
> 时间：2012-11-16T18:38:58.203
> 
> 标签：mysql, sql, phpmyadmin, wampserver

我一直在处理 mysql 数据库中的一个表，该表在 wamp 服务器上本地保存我正在使用 wamp 中的 phpmyadmin 区域来运行查询。我正在尝试获取数据以执行以下操作：

任何人都可以帮助我有一张包含许多植物记录的表格。一个植物可以有多个名称，该表将其显示为不同的记录。该表名为 new_plantsname

```
plantid name
1       tree
1       rose
2       bush
3       tree
3       bush
3       rose 
```

这持续了 3000 多条记录

我想要的是合并具有相同植物 ID 的记录并在不同的列中显示不同的名称：

```
plantid name1 name2 name3 ...
1       tree  rose  NULL
2       shrub NULL  NULL
3       tree  rose  bush 
```

ETC

乍一看，我相信一种植物不超过 4 个名称。

有人能帮我查询一下吗？我还想将结果保存到新表中

有人给了我以下答案：

```
select plantid,
  max(case when nameRn = 'name1' then name end) Name1,
  max(case when nameRn = 'name2' then name end) Name2,
  max(case when nameRn = 'name3' then name end) Name3,
  max(case when nameRn = 'name4' then name end) Name4
from
(
  select plantid, name,
      concat('name', @num := if(@plantid = `plantid`, @num + 1, 1)) as nameRn,
      @plantid := `plantid` as dummy
  from
  (
    select plantid, name, @rn:=@rn+1 overall_row_num
    from yourtable, (SELECT @rn:=0) r
  ) x
  order by plantid, overall_row_num
) src
group by plantid; 
```

这似乎在没有错误的情况下有效，但它没有将记录结合起来，它只保留了第一条记录的名称和 id 而不是其余的。使用的数据：

```
plantid     name
    1       tree
    1       rose
    2       tree
    3       rose
    3       bush
    3       rose 
```

结果：

![结果显示为除名字之外的所有内容添加了 null](../Images/dfc8e30c6cad8fe6d52efb7837a80127.png)

谁能帮忙

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-16T22:59:48.060

问题是 MySQL 没有枚举行的好方法。唉，根据 MySQL 文档，不能保证使用常量。它通常确实有效，但也可能存在问题。

我建议您将这些名称连接到一个字段中。结果将如下所示：

```
1     tree,rose
2     tree
3     tree,bush,rose 
```

使用 SQL：

```
select plantid, group_concat(name separator ',')
from t
group by plantid 
```

如果您真的希望将名称放在单独的列中，可以想到两个选项。一种是使用上面的结果，然后将结果解析为单独的字符串。另一种选择是使用自连接和聚合来计算序号，如下所示：

```
select p.plantid, p.name, count(*) as seqnum
from t p left outer join
     t pprev
     on p.plantid = pprev.plantid and
        p.name >= pprev.name
group by p.plantid, p.name 
```

并将其用作子查询。

# javascript - Jquery/JS 范围

> ID：13422463
> 
> 赞同：0
> 
> 时间：2012-11-16T18:39:26.910
> 
> 标签：javascript, jquery

这可能很简单，但它难倒我。我正在尝试将 javascript 中的变量返回到函数范围之外的另一个变量。由于某种原因，分配没有发生。这是我的代码：

```
var time = Math.round(((new Date()).getTime())/1000);

// first call to get data
var power_now = get_data(<%= @user.id %>, time);

function get_data(user_id, timestamp){
  var targetURL = "get/user_data?time_now="+timestamp+"&user_id="+user_id;
  var power = 0;

  $.get(targetURL, function(data){
    power = data[0]['power'];
    alert(power);
  })

  return power;
}

$('body').html('<h1>'+power_now+','+power_then+'</h1>') 
```

如果我将 alert(power) 放在 .get 函数中，则该值是正确的；但是，如果我将它放在 .get 函数之外，则值为 0。

也许我错过了一些关于 javascript 范围的东西？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:43:25.367

`get`是`.ajax`一些特定参数集的同义词。AJAX 中的第一个 A 是异步的。这意味着代码不会立即执行，它会发送请求并继续前进。因此，该变量的赋值直到 return 语句之后才会发生。

相反，您应该将代码移动到回调中：

```
$.get(targetURL, function(data){
    power = data[0]['power'];

    $('body').html('<h1>'+power_now+','+power_then+'</h1>')
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T18:41:45.420

`$.get`是一个 aysc AJAX 调用，这意味着即使在服务器响应之前，该函数也会返回 0。

您需要使用回调函数来设置`power_now`或调用相应的代码。

如果它适合您，您可以修改您的代码，如下所示，

```
var power_now = 0;
get_data(<%= @user.id %>, time);

function get_data(user_id, timestamp){
  var targetURL = "get/user_data?time_now="+time+"&user_id="+<%= @user.id %>;

  $.get(targetURL, function(data){
    power_now = data[0]['power'];
    $('body').html('<h1>'+power_now+','+power_then+'</h1>')
  })
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T18:45:46.697

`$.get`是一个异步ajax调用。您需要在成功函数中指定生成的操作。

```
var time = Math.round(((new Date()).getTime())/1000);

// first call to get data
var power_now = get_data(<%= @user.id %>, time);

function get_data(user_id, timestamp){
  var targetURL = "get/user_data?time_now="+time+"&user_id="+<%= @user.id %>;
  var power = 0;

  $.get(targetURL, function(data){
    power = data[0]['power'];
    alert(power);
  })

  .success(function() { $('body').html('<h1>'+power+','+power_then+'</h1>') })
} 
```

# session - arquillian - 如何在测试中获取持久会话范围的 bean

> ID：13422466
> 
> 赞同：2
> 
> 时间：2012-11-16T18:39:44.543
> 
> 标签：session, null

一直在努力解决服务依赖于会话范围内的 bean 失败的测试用例；

产生@SessionScoped User 的类：

```
public class LoginService {

    private User user;

    public void login(String name) {
        if ("userA".equals(name)) {
            user = new User(name, "permissionA");
        } else if ("userB".equals(name)) {
            user = new User(name, "permissionB");
        } else {
            user = new User("anonymous", "");
        }
    }

    @Produces
    @LoggedIn
    @SessionScoped
    public User getLoggedIn() {
        return this.user;
    }
} 
```

使用@LoggedIn 用户的服务：

```
public class MediaService {
    @Inject
    @LoggedIn
    private User user; 

    public void updateImage(){
        if("permissionA".equals(user.getPermission())) {
            System.out.println("user can update image");
        } else {
            System.out.println("user can not update image");
        }
    }
} 
```

和测试：

```
@RunWith(Arquillian.class)
public class ServiceTest {

    @Deployment
    public static WebArchive deployment() {
        return ShrinkWrap
                .create(WebArchive.class, "test.war")
                .addClass(LoggedIn.class)
                .addClass(LoginService.class)
                .addClass(MediaService.class)
                .addClass(User.class)
                .addAsWebInfResource(EmptyAsset.INSTANCE, "beans.xml");
    }

    @Inject
    private LoginService lservice;

    @Inject 
    private MediaService mservice;

    @Test
    public void testLogin() {
        lservice.login("userA");
    }

    @Test
    public void testUpdateImage(){
        mservice.updateImage();
    }
} 
```

使用 arquillian 远程容器进行测试，第一个测试 (testLogin) 通过并且 testUpdateImage 失败，会话中的用户为 null。

```
WELD-000052 Cannot return null from a non-dependent producer method:  [method] @Produces @LoggedIn @SessionScoped public org.arg.service.LoginService.getLoggedIn() 
```

谢谢

# java - 接受数组的 Java 构造函数

> ID：13422469
> 
> 赞同：0
> 
> 时间：2012-11-16T18:39:49.670
> 
> 标签：java, constructor

你如何创建一个构造函数来获取卡片数组并将它们添加到一个数组列表中？到目前为止，以下是我的 3 个构造函数...

“该类应提供一个默认构造函数（创建一个空手），一个构造函数接受一组卡片并将它们添加到手上，以及一个构造函数接受不同的手并将卡片添加到此手”

更新：

```
 public class Hand {

    private List<Hand> hand = new ArrayList<Hand>();

    public Hand(){
        hand = new ArrayList<Hand>();
    }

    public Hand(Card[] cards){
        //this.hand.addAll(Arrays.asList(cards));
        //this.hand = new ArrayList<Hand>(Arrays.asList(cards));]
    }

    public Hand(Hand cards){
         this.hand = Arrays.asList(cards);
    }   
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:45:13.927

您应该将列表作为`Hand`类中的实例变量：

```
public class Hand {
    private List<Card> cards;

    public Hand(Card[] cards) {
        this.cards = Arrays.asList(cards);
    }
} 
```

当前，您正在声明一个局部变量，该变量在构造函数返回后立即超出范围。

**更新**

在类本身中有一个`Hand`s列表是没有意义的。`Hand`IMO，最好让每个人`Player`保留自己的`Hand`.

据了解，您希望有一个初始化卡片列表的构造函数，以及将卡片添加到该列表的方法。如下所示：

```
public class Hand {
    private List<Card> cards;

    public Hand() {
        this.cards = new ArrayList<Card>();
    }

    public void addCards(Card... cards) {
        this.cards.addAll(Arrays.asList(cards));
    }
} 
```

以下是构造函数：

```
public class Hand {
    private List<Card> cards;

    //constructor to create an empty hand
    public Hand() { 
        this.cards = new ArrayList<Card>();
    }

    //constructor to create an empty hand and add all provided cards to it
    public Hand(Card[] cards) {
        this();
        this.cards.addAll(Arrays.asList(cards));
    }

    //constructor to create an empty hand and add all cards in the provided hand
    public Hand(Hand hand) {
        this();
        this.cards.addAll(hand.getCards());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:42:33.393

```
public Hand(Card[] cards){
    ArrayList<Card> hand = new ArrayList<Card>(Arrays.asList(cards));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:46:52.030

使用 java.util.Arrays

```
List<Card> hand = Arrays.asList(cards); 
```

# android - 在一个 WiFi 网络上让多个 Android 设备共享信息的最佳方式

> ID：13422470
> 
> 赞同：1
> 
> 时间：2012-11-16T18:39:51.477
> 
> 标签：android, networking

我试图弄清楚在一个网络共享数据上拥有多个 android 设备的解决方案是什么。

假设他们都在运行同一个应用程序，并且用户“注册”，我想弄清楚（没有任何用户输入）网络上的其他设备可以与之交谈，然后向他们发送这个注册数据，这样当用户转到下一个设备时，他们的信息就已经存在了。

我能够 ping xxx0-255 范围内的 255 个连接的设备以​​查看哪个响应，但我不清楚如何编写一个应用驻留服务器（松散地使用该术语），然后我可以将数据发送到该服务器。

我不能成为第一个需要解决这个问题的人，但是在这方面我找不到任何有用的东西。

需要注意的是，这适用于没有 3G（或其他方式）接入互联网的设备，并且它们所在的 wifi 网络也无法接入互联网，因此解决方案必须是 100% 内部的网络并且不能包含任何其他设备（例如运行 apache 的盒子，所有设备都可以用作服务器）。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:40:22.920

> 但我不清楚如何编写一个应用程序驻留服务器（松散地使用该术语），然后我可以将数据发送到该服务器。

创建一个`Service`具有打开 a`ServerSocket`并侦听传入请求的代码的 a，例如 HTTP 服务器。

总的来说，这是危险的，但对于受限的情况——比如你的“100% 内部网络”——它应该是安全的。

# sql - SQL：如何获得 AVG(MIN(number))？

> ID：13422473
> 
> 赞同：4
> 
> 时间：2012-11-16T18:40:05.157
> 
> 标签：sql, sql-server, sql-server-2008, aggregate-functions

我正在寻找**最小**数字（*按人分组*）的**平均**（*总体*）。

 ***我的表如下所示：

```
Rank    Name
1   Amy
2   Amy
3   Amy
2   Bart
1   Charlie
2   David
5   David
1   Ed
2   Frank
4   Frank
5   Frank 
```

我想知道最低分数的平均值。对于这些人来说，最低分是：

```
Rank    Name
1   Amy
2   Bart
1   Charlie
2   David
1   Ed
2   Frank 
```

给我一个**1.5**的最终答案- 因为三个人的 MIN(Rank) 为**1**，而另外三个人的 MIN(Rank) 为**2**。这就是我要找的——一个数字。

我的真实数据有几百行，所以它不是很大。但我无法在一个简单的语句中弄清楚如何做到这一点。感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T18:48:06.927

试试这个：

```
;WITH MinScores
AS
(
   SELECT 
     "Rank", 
     Name, 
     ROW_NUMBER() OVER(PARTITION BY Name ORDER BY "Rank") row_num
  FROM Table1
) 
SELECT 
  CAST(SUM("Rank") AS DECIMAL(10, 2)) / 
  COUNT("Rank")
FROM MinScores 
WHERE row_num = 1; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/59673/11)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T20:02:19.267

选择一组最小值很简单。[cast() 对于以后避免整数除法](http://msdn.microsoft.com/en-us/library/ms175009.aspx)是必要的。您还可以通过转换为浮点数而不是十进制数来避免整数除法。（但您应该知道浮点数是“有用的近似值”。）

```
select name, cast(min(rank) as decimal) as min_rank
from Table1
group by name 
```

现在您可以将最小值用作公用表表达式，并从中进行选择。

```
with minimums as (
  select name, cast(min(rank) as decimal) as min_rank
  from Table1
  group by name
)
select avg(min_rank) avg_min_rank
from minimums 
```

如果您碰巧需要在不支持公用表表达式的平台上执行相同的操作，您可以 a) 创建最小值视图，然后从该视图中进行选择，或者 b) 将最小值用作派生表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T18:46:34.563

您可以尝试使用派生表来获取最小值，然后在外部查询中获取平均最小值，如下所示：

```
-- Get the avg min rank as a decimal
select avg(MinRank * 1.0) as AvgRank
from (
    -- Get everyone's min rank
    select min([Rank]) as MinRank
    from MyTable
    group by Name
) as a 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-09-25T12:31:02.033

我认为最简单的将是

最大

```
select name , max_rank = max(rank) 
from table
group by name; 
```

平均

```
select name , avg_rank = avg(rank)
from table
cgroup by name; 
```***

# asp.net - 编译器错误消息：BC30451：未声明名称“cmbY”

> ID：13422475
> 
> 赞同：0
> 
> 时间：2012-11-16T18:40:15.860
> 
> 标签：asp.net, vb.net

我在此代码中收到非声明错误。

```
 Line 23:         If Not Page.IsPostBack Then
    Line 24: cmbY.DataSource = rsFirehose("SELECT LeagueTypeKey, LeagueTypeDescription FROM LeagueType " & _**
    Line 25:                 "WHERE LeagueTypeKey=0 or (Appkey=" & glngAppKey & " AND LeagueTypeKey IN (SELECT Distinct YKey FROM " & _
    Line 26:                 "Division WHERE DivisionTypeKey=" & soaDivisionTypeBracket & ")) ORDER BY LeagueTypeDescription") 
```

第 24 行是错误所在：它表示未声明名称“cmbY”。我该如何申报？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T10:30:03.313

纠正这个错误

1.检查控件的拼写 2.检查元素的范围 3.检查成员访问运算符

如果您发布您的代码，那么我们可以很好地找到它......所以发布您的代码

# api - WSO2 API Manager 是否支持 API 联合？

> ID：13422478
> 
> 赞同：2
> 
> 时间：2012-11-16T18:40:31.703
> 
> 标签：api, wso2, wso2-am, federation

基本上，我感兴趣的是在多个区域设置 WSO2 API Manager；例如亚洲、美国和欧洲。一些 API 将部署在每个区域的数据中心内，而其他 API 将仅部署在特定区域内。

理想情况下，我想要的是一个单一的 WSO2 API 存储，我可以在其中查看跨所有区域部署的 API（包括仅在特定区域的服务器上可用的 API）。

我不希望 API 用户必须了解每个 API Manager 或其商店才能发现可用的 API。我宁愿他们只知道 API Manager 商店之一（最好是他们所在地区的商店），然后他们可以找到可用的 API 并决定是否要处理使用来自不同地区的 API 的延迟。

因此，当在一个地区使用 API Manager Publisher 发布 API 时，我希望将该 API 信息联合到每个 API Manager Store。

这可能吗？如果是这样，是否存在任何关于如何配置 API 管理器以使用 API 元数据联合的文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T13:51:49.957

如果我正确理解了您的查询，这可以通过 WSO2 API Manager 的分布式集群设置来实现。

这篇[博文](http://techfeast-hiranya.blogspot.com/2012/08/wso2-api-manager-designed-for.html)将帮助您初步了解 WSO2 API Manager[AM] 如何设计可扩展性。

目前，我们正在使用分布式设置中的 API Manager 部署详细信息更新 WSO2 AM 文档，这些将在不久的将来提供。此外，此[幻灯片集](http://www.slideshare.net/wso2.org/wso2-use-case-api-facade-pattern)将对您有所帮助，因为它包含一些可用于 API Manager 的部署模式。

谢谢;

# android - 如何在运行时更改布局资源文件夹？

> ID：13422482
> 
> 赞同：0
> 
> 时间：2012-11-16T18:40:43.083
> 
> 标签：android, layout

例如，有两个文件夹

`layout-mdpi`

`layout-hdpi`

我如何告诉操作系统，布局应取自另一个文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:46:52.877

你不能。原因是它是只读系统。

# youtube-api - YouTube iFrame API：onStateChange 传递未定义的数据

> ID：13422488
> 
> 赞同：1
> 
> 时间：2012-11-16T18:41:02.207
> 
> 标签：youtube-api

这似乎是一个反复出现的问题，因为在过去几年中，YouTube API Google Group 上有许多类似的帖子。使用 YouTube iFrame API（仅尝试 HTML5 而不是 Flash）onStateChange 事件会正确触发（并调用指定的处理程序），但传递的数据属性未定义。我正在运行 OS X Mountain Lion，使用 Chrome (23.0.1271.64) 和 Safari (6.0.2) 都会出现错误。

任何关于问题可能是什么的想法都将不胜感激。

选定的代码片段

```
myapplication.controllers.Player = function(containerId, videoId) {

    [...]

    this.player = new YT.Player(this.currentView_.playerContainer_, {
        videoId: videoId,
        playerVars: { 'showinfo': 0, 'modestbranding': 1, 'rel': 0 },
        suggestedQuality: 'medium'
    });

    [...]

    goog.events.listen(this.player, 'onStateChange', this.onPlayerStateChange_, 
        false, this);

    [...]

};

myapplication.controllers.Player.prototype.onPlayerStateChange_ = function(e) {
  if (e.data == 1) {
    this.startTimer_(100);
  } else {
    this.stopTimer_();
  };
}; 
```

# c# - Npgsql 参数化语句

> ID：13422492
> 
> 赞同：1
> 
> 时间：2012-11-16T18:41:15.077
> 
> 标签：c#, .net, database, postgresql, npgsql

最新版本的[`Npgsql`](http://npgsql.projects.pgfoundry.org/index.html)for是否`PostgreSQL`支持参数化语句？如果是，它在 C# 中的形式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:19:52.280

我想你正在寻找：

[http://bobby-tables.com/csharp.html](http://bobby-tables.com/csharp.html)

和

[http://www.npgsql.org/doc/3.0/](http://www.npgsql.org/doc/3.0/)

# c - 在 C 中的 shell 实现中的管道

> ID：13422496
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:41:42.053
> 
> 标签：c, shell, pipe

我正在用 C 实现一个 shell。这是我用于管道的函数。当我在代码中输入“ls | a”（即用无效命令传递有效命令）时，它不会像应有的那样退出子进程。我如何让它回到主要功能？当我做 ps | 时也会发生同样的事情 ls或ps | pwd 等，但 ls | ps 的工作方式与 bash 相同。我知道ls | ps或ps | ls 没有意义，但至少它们应该提供与 bash 相同的输出。

```
void exec3(char **args, char **args2){
    int fd[2];
    pid_t pid,pid1;
    int status;
    pipe(fd);
    int e=0;
    if ((pid = fork()) < 0) {    
        printf("*** ERROR: forking child process failed\n");
        exit(1);
    }

    else if ((pid1 = fork()) < 0) {    
        printf("*** ERROR: forking child process failed\n");
        exit(1);
    }

    else if (pid == 0 && pid1!=0){   
        printf("in 1\n");
        close(1);
        dup(fd[1]);
            close(fd[0]);
        close(fd[1]);

            if(execvp(args[0],args)<0){
                printf("**error in exec");
                close(fd[0]); 
                close(fd[1]);           
                exit(1);
            }
    //printf("exiting 1\n");
    exit(0);
}

else if (pid1 == 0 && pid!=0) {   
    printf("in 2\n");
    close(0);
    dup(fd[0]);
    close(fd[1]);
    close(fd[0]);
    if((e=execvp(args2[0],args2))<0){
            printf("**error in exec2 ");
            close(fd[0]);
            close(fd[1]);

        exit(1);
    }
    exit(0);
}

else {  
        close(fd[0]);
        close(fd[1]);
        fflush(stdout) ;             
        while (wait(&status) != pid);
        while (wait(&status) != pid1);
    }  
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-16T19:20:29.267

您已接近解决方案。看看是如何`popen()` [实现](http://ftp.cc.uoc.gr/mirrors/OpenBSD/src/lib/libc/gen/popen.c)的，这就是你想要做的。

# razor - 如果语句未正确评估

> ID：13422504
> 
> 赞同：0
> 
> 时间：2012-11-16T18:42:17.017
> 
> 标签：razor, asp.net-mvc-4

我试图在尝试呈现 HiddenFor HTML 元素之前评估模型的属性以查看它是否为空，但输入了 if 语句的代码块，即使该语句为 false。

```
@{
if(Model.BoatImage.UploadedImagePath != string.Empty)
{
   @Html.HiddenFor(model => model.BoatImage.UploadedImagePath)
}
} 
```

在上面的代码中，UploadedImagePath 在 BoatImage 的构造函数中初始化为 string.Empty。如果我在 if 语句处中断，Intellisense 会显示 UploadedImagePath 为空，并且即时窗口将 if 语句评估为假。但是，程序仍会尝试呈现 HiddenFor 元素。

编辑：调试器错误地指出上面的代码导致了异常，而实际上是上面代码下面的几行。一旦我纠正了导致问题的行，上面的代码就可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:53:17.080

在剃须刀中，您应该这样写：

```
@if(!string.IsNullOrEmpty(Model.BoatImage.UploadedImagePath))
{
   @Html.HiddenFor(model => model.BoatImage.UploadedImagePath)
} 
```

请注意，我还更改了您的字符串评估方法

# python - 为什么这个 python 程序不启动？

> ID：13422505
> 
> 赞同：2
> 
> 时间：2012-11-16T18:42:17.657
> 
> 标签：python, python-idle

我在教程论坛上复制了其他人编写的python程序的源代码，并对其进行了一些修改以满足我自己的需要

我相信原件是在python shell中运行的，我让它在shell中运行，但我需要将它保存到python IDLE并从那里运行

我正在使用 python 3.2.3 IDLE btw 这是我写的：

```
def fibonacci(previous=0,current=1):
    n = int(input("Calculate fibonacci sequence value up to: "))
    if previous > current:
        previous,current = current, previous
    yield previous
    yield current
    while True:
        current,previous = previous+current,current
        yield current

    x = fibonacci()    
    for i in range(n):
        print(next(x))
fibonacci() 
```

它没有运行，就像没有弹出错误一样，我只是得到箭头：>>就是这样，什么也没发生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:47:50.733

该程序确实启动并运行。不幸的是，通过`yield`在函数中使用，你使它成为一个生成器，并且生成器只在最后一行被构造，但从未被评估过。

相反，您想突出最后四行：

```
def fibonacci(previous=0,current=1):
    if previous > current:
        previous,current = current, previous
    yield previous
    yield current
    while True:
        current,previous = previous+current,current
        yield current

n = int(input("Calculate fibonacci sequence value up to: "))
x = fibonacci()    
for i in range(n):
    print(next(x)) 
```

# android - Android显示旋转...保存状态

> ID：13422510
> 
> 赞同：0
> 
> 时间：2012-11-16T18:42:48.390
> 
> 标签：android, html, cordova, jquery-mobile

我正在开发一个带有 phonegap 和 jquery 的网络应用程序。这个脚本由一个 javascript 组成，可以动态地创建一些表单元素。

问题是，当我更改屏幕方向时，脚本会从头开始再次运行。

我怎样才能保存状态？

谢谢。是否存在解决方案，或者唯一的事情是禁用方向屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:00:33.003

听起来您的活动标签没有在 AndroidManifest.xml 中正确设置 configChanges 属性。它应该看起来像这样：

```
<activity
        android:name=".MainActivity"
        android:label="@string/title" 
        android:configChanges="orientation|keyboardHidden|keyboard|screenSize|locale"
        android:theme="@android:style/Theme.Black.NoTitleBar"
        android:hardwareAccelerated="true"> 
```

# javascript - 调试 jQuery 插件

> ID：13422514
> 
> 赞同：0
> 
> 时间：2012-11-16T18:42:57.460
> 
> 标签：javascript, jquery, debugging

**背景**

我有一段 javascript 在客户页面上的站点。执行此脚本时，它会加载必要的资产和脚本，然后执行主代码。

我正在加载的脚本之一是[Twitter 的引导 JS](http://twitter.github.com/bootstrap/javascript.html#modals)，用于创建模式窗口。它被实现为一个 jQuery 插件，并将 '$.modal()' 添加到一个 jquery 对象。

**问题**

这适用于除一个客户站点之外的所有站点。在这个特定的网站上，当我调用`$('#idOfWindow').modal();`时，页面会抛出一个 javascript 错误`Object has no method 'modal'`

我已经验证了引导代码被调用，并被`$.fn.modal`调用来设置插件，我的预感是某些东西正在破坏 jQuery 对象，但我不确定如何调试它。

**评论**

我目前正在使用 Chrome 的开发人员工具进行调试，并且我已经验证了该插件在被调用之前已加载并执行。客户端站点使用 jQuery 1.7.2。我熟悉 chrome 工具，但我不是高级用户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:53:42.773

如果您是对的，您的原始 jQuery 对象正在某处被覆盖，您应该能够使用[`jQuery.noConflict()`](http://api.jquery.com/jquery.noconflict/).

**演示：** [jsfiddle.net/KthZu](http://jsfiddle.net/KthZu/)

* * *

**编辑：**一些调试提示：

为了帮助调试，您可以使用以下代码在控制台中检查 jQuery 版本：

```
$().jquery 
```

另一个潜在的调试技巧是在创建插件时存储对 jQuery 的引用。

```
$.fn.myPlugin = function(){};
window.jQueryWithMyPlugin = $; 
```

然后，在调试的时候，就可以清楚的看到是否`window.$`被覆盖了：

```
$ === jQueryWithMyPlugin 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:01:49.797

通常对于要嵌入外部的任何小部件类型的代码，您都需要包装您的代码：

```
(function($){
    $('#idOfWindow').modal();
})(jQuery); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:52:32.320

过去，我遇到过在同一页面上加载多个版本的 jQuery（或 jQuery 和原型）的问题。确保您添加的 jQuery`$.fn.modal`版本与正在调用的版本相同。`$().jquery`可以用来访问正在使用的特定版本的jQuery。

# java - 大小为 2^32 的 Java 新字节数组

> ID：13422515
> 
> 赞同：9
> 
> 时间：2012-11-16T18:43:01.340
> 
> 标签：java

在 Java 中，它不允许我使用 long 来处理这样的事情：

```
long size = 0xFFFFFFFF; //2^32-1

byte [] data = new byte[size]; 
```

而一个 int 只能达到 0x7FFFFFFF (2^31-1)。是否可以声明这种大小的字节数组？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-16T18:53:39.210

答案是`NO`因为这是最大可能的初始化：

```
 int size = Integer.MAX_VALUE;
    byte [] data = new byte[size]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T18:45:15.077

声明`size`为 an并重`int`试：

```
int size = 0x7FFFFFFF; // 0x7FFFFFFF == Integer.MAX_vALUE == 2^32-1 
```

数组只能声明为正`int`大小，而不是`long`. 请注意，最大`int`正值（因此，整数数组的最大可能大小，假设有足够的可用内存）是`0x7FFFFFFF == Integer.MAX_vALUE`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T18:57:27.567

Integer.MAX_VALUE 是许多 java 概念的限制。例如 String/List 不能长于这个。

早在 1995 年创建 Java 时，4MB 的总内存是常态。

大多数语言都存在同样的问题。但如果我们今天要设计一种新语言，我们肯定会使用`long`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-16T19:00:55.887

我同意您的 byte[] 元素不能超过 Integer.MAX_VALUE 。但是，您可以拥有一个数组数组。

我建议编写一个具有以下内容的类：

*   一个构造函数，它需要很长的大小并构建一个足够大的 byte[][] 以包含这么多元素。

*   获取和设置使用长索引的方法

*   返回 long 的 size() 方法。

当然，这仅适用于 64 位 JVM 和足够大的内存。

早在 1990 年代，我就觉得数组索引和长度类型选择 int 而不是 long 是短视的。Sun 销售了许多具有数十 GB 内存的机器，并且一直存在最大数组大小接近内存大小和内存大小增长的趋势。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-16T18:44:59.337

您的示例中的问题是数组创建函数需要一个 int 作为参数，而您传递的是一个 long。

这编译：

```
long size = 0xFFFFFFFF; //2^32-1

byte [] data = new byte[(int)size]; 
```

但不运行。它不会在这个特定示例中运行，`long`因为数字是负数，并且您根本无法创建具有负数元素的数组。但是，仍然可以使用 long 变量来创建数组，但它必须是正数并且需要强制转换为 int，如下所示：

```
long size = 0x00FFFFFF; //

byte [] data = new byte[(int)size]; 
```

这将编译和工作。

顺便说一句，`Integer.MAX_VALUE`如果这超出了您的 JVM 内存限制，则从 size 更改为不会完成任何事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-16T18:53:50.513

这是不可能的。**数组大小仅支持 int 值**。

您可以查看[数组的 JDK 源代码](http://hg.openjdk.java.net/jdk6/jdk6-gate/jdk/file/eb90e0cf5456/src/share/classes/java/util/Arrays.java)。仅支持 int 值。

# gcc - 手臂-精灵-gcc。没有创建 .gcda 文件，程序太大而无法放入内存？

> ID：13422520
> 
> 赞同：1
> 
> 时间：2012-11-16T18:43:46.193
> 
> 标签：gcc, arm, code-coverage, gnu, elf

我试图在 C++ 中对一个简单的 hello world 程序进行代码覆盖。目标设备是一个 arm 处理器，因此我使用的是 GNU ARM 工具链。

arm-elf-gcc -mcpu=arm7tdmi -O2 -g -c main.c -o main.exe 创建一个 .gcno 文件，但未能创建 gcov 查找代码覆盖率所需的 .gcda 文件。

通常，当我运行 g++/gcc -fprofile-arcs -ftest-coverage .cpp 时，它首先会创建一个 .gcno 文件和一个 .exe。运行 a.exe 后，它会生成 .gcda 文件。

在这里，当我尝试运行 main.exe 以生成 .gcda 时，它会引发错误 - 程序太大而无法放入内存。我该如何解决这个问题？我在哪里出错了吗？

谢谢， AJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T20:20:14.697

显然，您必须在目标设备上运行您的可执行文件。目标设备必须有一个文件系统。退出时，可执行文件使用普通 POSIX 函数 - `open`、`fcntl`、`write`、`close`等写入覆盖信息。查看`gcov-io.c`GCC 源代码。确保您可以成功链接`libgcov.a`到您的可执行文件，您在目标设备上具有写入权限等。

# java - GridBagLayout 一个单元格对齐标签

> ID：13422521
> 
> 赞同：1
> 
> 时间：2012-11-16T18:43:47.683
> 
> 标签：java, swing, gridbaglayout

例如，我在网格布局中有 3x3 组件，我希望它们都是标签，但是由于我有一些填充，我希望我的标签位于它们的单元格的中心。但我似乎无法管理它...

部分相关代码：

```
panel = new JPanel();
GridBagLayout gridBag = new GridBagLayout();
panel.setLayout(gridBag);
panel.setSize(new Dimension(30, 400));
GridBagConstraints c = new GridBagConstraints()     

JLabel lab = new JLabel("proba"); 
lab.setBorder(outline);
c.fill = GridBagConstraints.BOTH;
c.gridx =2; c.gridy=2; c.ipady = 10; c.ipadx=10;

c.ipadx=100; panel.add(lab,c); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:27:05.193

[更新]

你真的应该发布一个[SSCCE](http://sscce.org)，这样我们都可以尝试，而不必猜测问题出在哪里。我的最后一个猜测——不管它是否能解决你当前的问题——这是你应该做的事情——是

```
 label.setHorizontalAlignment(JLabel.CENTER); 
```

如果您的标签居中并填充整个网格单元格，则默认情况下文本仍将左对齐。上述更改将导致文本在标签内居中。

但是，如果您的标签没有填充单元格，这将无济于事。

[原来的]

由于这不是一个完整的程序，因此很难确切地说出了什么问题，但这里有一些评论可能会让您走上正轨。

首先，您应该使用 setPreferredSize 而不是 setSize（请参阅[Java：组件中的 setPreferredSize() 和 setSize() 方法之间的区别](https://stackoverflow.com/questions/1783793/java-difference-between-the-setpreferredsize-and-setsize-methods-in-compone)）

当您进行此更改时，您会发现面板不是您想要的。它又高又瘦。也许是一个错字 - 你的意思是`(300,400)`不是`(30,400)`

现在我猜你所有的标签都会聚集在一起。为了得到它们，`spread out`您需要添加：

```
c.weightx = .5;
c.weighty = .5; 
```

（实际上任何非零值都可以）。这在[http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html中有描述](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)

> 除非您为 weightx 或 weighty 指定至少一个非零值，否则所有组件都会在其容器的中心聚集在一起。这是因为当权重为 0.0（默认值）时，GridBagLayout 会在其单元格网格和容器边缘之间放置任何额外的空间。

这应该让你接近（r）......

# c - 这个将char数组转换为int数组的函数不起作用吗？

> ID：13422523
> 
> 赞同：0
> 
> 时间：2012-11-16T18:43:56.933
> 
> 标签：c

该程序应该通过从它们的 ascii 值中减去 97 将字符数组（字符串）转换为整数数组（输入应该是小写，因为 a 的 ascii 值为 97）。因此，如果我输入字符串 abcd，我应该得到 0123，但我却以某种方式得到：012134513789。我不知道问题出在哪里。

```
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

void userEnter(int*pattern, int n);

int main(void)
{
int n, i;
printf("What is the length of the array: ");
scanf("%d",&n);
int pattern[n];
printf("Enter the char array: ");
userEnter(pattern, n);
printf("The int array is: ");
for(i=0;i<n;i++)
{
printf("%d",pattern[i]);
}
printf("\n");

}

void userEnter(int*pattern, int n)
{
    char input[n];
    scanf("%s", input);

    int i;
    for(i = 0; i < n-1; i++)
    {
        pattern[i] = input[i]-97;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:03:03.477

长度参数`n`也包括一个空字符。因此，如果您输入长度为`n`4，那么您只能输入 3 个字符，例如`abc`因为第 4 个字符是空的。

因此，您应该相应地更改声明：

改变：

```
 char input[n]; 
```

至：

```
 char input[n+1]; 
```

请注意，仅从 C99 起才允许使用可变长度数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:45:30.600

```
char input[n];
scanf("%s", &input); 
```

应该

```
char input[n+1];
scanf("%s", input); 
```

`input`相当于`&input[0]`

`userEnter`当您遇到结束用户输入字符串的 nul 字符时，您还应该退出 for 循环。例如，类似的东西

```
char* p = input;
while (*p != '\0') {
    *pattern = (*p) - 'a';
    p++;
    pattern++;
} 
```

正如 KingsIndian 指出的那样，您还需要增加`input`缓冲区的大小。目前，您溢出该缓冲区并覆盖循环计数器`i`；

# asp.net-web-api - 每个方法的 ASP.NET WebAPI 支持的媒体类型

> ID：13422524
> 
> 赞同：6
> 
> 时间：2012-11-16T18:44:15.417
> 
> 标签：asp.net-web-api, asp.net-web-api-routing, media-type

给定控制器中的方法：

```
public class CustomerController : ApiController
{
    [HttpGet]
    public CustomerDto GetById([FromUri] int id)
    {
        .
        .
        return customerDto
    }
} 
```

有没有办法用属性指定支持的媒体类型？例如，CustomerDto 是一个复杂的类，只会使用 JSON (application/json) 而不是 XML (application/xml) 进行序列化，但也可以接受 PDF (application/pdf)。有没有这样的东西：

```
[HttpGet(Accepts.JSON, Accepts.PDF)]  
    or
[HttpGet][AcceptJSON][AcceptXML]
    or
[HttpGet][Accept("application/json")][Accept("application/pdf")] 
```

如果传入的请求不受支持，则可以返回不支持的异常/状态。

注意 - 我不想像在全球范围内那样删除所有的 XML 序列化。相反，我想定义每条路线接受的内容。

使用 - ASP.NET WebAPI RC 1（需要升级）+ 自托管

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T19:24:32.453

听起来像自定义 ActionFilterAttribute 可能会奏效。

创建一个继承自 System.Web.Http.Filters.ActionFilterAttribute 的新类，重写 OnActionExecuting 方法。在此方法中，您可以检查请求的标头，查找您不想支持的内容并返回适当的响应。

您的自定义 ActionFilterAttribute 的构造函数可以获取您想要处理哪些“接受”类型以及您想要拒绝哪些类型的详细信息。

有关自定义 ActionFilterAttribute 的示例，请查看[这篇文章](http://www.strathweb.com/2012/05/output-caching-in-asp-net-web-api/)。

# javascript - 网页中的 Javascript 函数

> ID：13422526
> 
> 赞同：-3
> 
> 时间：2012-11-16T18:44:23.300
> 
> 标签：javascript

有没有办法列出网页引用的所有函数以及定义它们的 .js 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:46:31.627

我认为这项工作最好的办法是使用开发控制台，例如 Chrome 的开发人员工具或 Firebug。这将允许您“记录”网页并查看其所有 JavaScript 执行以及它们的来源。

# android - 在 Android 4.2（及更高版本）上修改 AIRPLANE_MODE_ON

> ID：13422527
> 
> 赞同：12
> 
> 时间：2012-11-16T18:44:24.250
> 
> 标签：android, sdk, settings

自 sdk 4.2 版以来，似乎无法再在设备上修改飞行模式，因为谷歌已将此设置移至只读的 Settings.Global。

有没有人能够在没有生根的情况下绕过这个？

我的应用程序的主要功能是在屏幕关闭时启用飞行模式，这从 4.2 开始停止工作。

只是想仔细检查我的评估是否正确，并且我的应用程序从 android 4.2 及更高版本开始就已失效。

参考资料：http: [//developer.android.com/reference/android/provider/Settings.Global.html#AIRPLANE_MODE_ON](http://developer.android.com/reference/android/provider/Settings.Global.html#AIRPLANE_MODE_ON)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T19:38:05.300

> 只是想仔细检查我的评估是否正确，并且我的应用程序从 android 4.2 及更高版本开始就已失效。

是的。或者，换一种说法，如果有修改这个设置的后门方式，它代表一个安全漏洞，最终会被关闭，就像已经存在 3 年以上的启用/禁用 GPS 限制一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-16T11:26:25.617

我知道你明确要求一个没有生根的解决方案，但如果你有一个生根设备，至少有（某种）官方解决方案可以将你的应用程序移动到文件夹`/system/app`中。然后可以写入`Settings.Global`：

```
Settings.Global.putInt(context.getContentResolver(), Global.AIRPLANE_MODE_ON, mode ? 1 : 0); 
```

看看如何[为 4.2 切换飞行模式](https://bitbucket.org/jholetzeck/ministatus-android/src/2f66bc57b4ca7a4f46181b05be47d91ca5456e9a/src/de/holetzeck/ministatus/AirplaneMode_SDK17.java?at=default) 以及如何将您的应用程序移至`/system/app` [此处](https://bitbucket.org/jholetzeck/ministatus-android/src/2f66bc57b4ca7a4f46181b05be47d91ca5456e9a/src/de/holetzeck/ministatus/MiniStatusSettings.java?at=default)。我将它用于我的切换小部件*迷你状态*（[源代码链接](https://bitbucket.org/jholetzeck/ministatus-android)）。

# c# - 终止前清理？

> ID：13422528
> 
> 赞同：5
> 
> 时间：2012-11-16T18:44:24.920
> 
> 标签：c#, c++, garbage-collection, dispose

这个问题困扰了我一段时间：我在 MSDN 的 DirectX[文章](http://msdn.microsoft.com/en-us/library/windows/desktop/dd370994%28v=vs.85%29.aspx)中阅读了以下内容：

> *（应用程序的）*析构函数应该释放存储的任何*（Direct2D）*接口......

```
DemoApp::~DemoApp()
{
    SafeRelease(&m_pDirect2dFactory);
    SafeRelease(&m_pRenderTarget);
    SafeRelease(&m_pLightSlateGrayBrush);
    SafeRelease(&m_pCornflowerBlueBrush);
} 
```

[现在，如果所有应用程序的数据都在终止（ source](https://stackoverflow.com/questions/6727383/dynamically-allocated-memory-after-program-termination) ）时被释放/释放，为什么我要费心制作一个函数以按顺序/并单独释放它们？这没有道理！

随着时间的推移，我越来越多地看到这一点，这显然让我很烦恼。上面的 MSDN 文章是我第一次遇到这种情况，因此在所有其他情况下提及它是有道理的。

好吧，因为到目前为止我还没有真正问过我的问题，所以它们是：

*   我需要在终止前释放一些东西吗？（请解释原因）
*   为什么 MSDN 中的作者选择这样做呢？
*   答案是否与本机和托管代码不同？IE 在编写 C# 程序时，我是否需要确保在程序结束时处理所有内容？（我不了解 Java，但如果存在处置，我相信其他成员也会对此表示赞赏）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T18:50:33.953

当您的应用程序终止时，您无需担心托管内容。当整个进程的内存被销毁时，所有这些都会随之而来。

重要的是非托管资源。

如果您有一个文件锁，并且当应用程序关闭时文件处理程序的托管包装器在您没有释放锁的情况下被删除，那么您现在已经丢弃了唯一允许访问该文件的密钥。

如果您有一个内部缓冲区（例如用于记录错误），您可能希望在应用程序终止之前刷新它。不这样做可能意味着不会记录导致应用程序结束的致命错误。那可能……很糟糕。

如果您打开了网络连接，则需要关闭它们。如果您不这样做，那么操作系统可能不会为您执行此操作（至少暂时不会；最终它可能会注意到不活动），这对另一端的任何人来说都是相当粗鲁的。他们可能会继续倾听回应，或者继续向您发送信息，却不知道您已经不在了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T18:53:40.527

> 现在，如果应用程序的所有数据都在终止时被释放/释放（源），为什么我要费心去做一个函数按顺序/并单独释放它们？

有很多原因。一个直接的原因是因为并非所有*资源*都是内存。只有内存在进程终止时被回收。如果您的某些资源是共享互斥锁或文件句柄之类的东西，则不释放这些资源可能会弄乱其他程序或程序的后续运行。

我认为还有一个更重要、更根本的原因。自己不清理只是懒惰、草率的编程。如果您在终止时的清理工作很懒惰和马虎，那么您在其他时候是否也很懒惰和马虎？如果你的倾向是懒惰和马虎，并且只在你意识到潜在问题的特定领域超越这种倾向，那么你的倾向就是懒惰和马虎。如果有你没有意识到的潜在问题怎么办？你怎么能依靠你懒惰、草率编程的整体哲学来编写正确、健壮的程序？

不要成为那个人。自己打扫干净。

# ruby-on-rails - 在 Rails 3 项目中创建多个网页

> ID：13422530
> 
> 赞同：0
> 
> 时间：2012-11-16T18:44:40.817
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我对 Ruby 和 Rails 还很陌生。我正在使用 rails 3。我正在创建一个项目，人们可以在其中登录和发布工作，人们可以搜索工作等。我已经创建了我的用户模型和工作模型，并且一切正常。我已经开始创建主页布局，并添加了指向其他页面发布工作、查找工作、联系方式、关于的链接。我有几个问题希望有人可以帮忙。

1.  当我进入 Rails 服务器并查看项目和我的主页时，它显示了从用户模型设置的登录，它还显示了某人可以发布工作的工作模型。我试图弄清楚如何做到这一点，这样工作就不会发布在主页上，而是找到工作页面，人们可以从该页面进行搜索？我是否需要将工作模型链接到类似的查找工作页面？

2.  如何为我已建立的这些其他链接创建网页。我不知道如何为我拥有的后期工作链接或我拥有的其他链接构建页面布局，以便人们查看页面布局。任何帮助表示赞赏？再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:56:58.497

你问的主要是 Rails 的基础知识。您可以在您想要的任何视图中渲染作业或任何其他模型，您只需要将这些作业从控制器“发送”到视图。

**1.- 配置路线：**

```
#config/routes.rb
get "/jobs" match 'jobs#index' # i.e 'controller#action' 
```

**2.- 配置模型控制器：**

```
#app/controllers/jobs_controller.rb
class JobsController < ApplicationController
  def index
    @jobs = Jobs.last(10)
    render 'index'
  end
end 
```

**3.- 配置视图：**

```
#app/views/jobs/index.html.erb
<% @jobs.each do |job| "do something with each #{job}" end %> 
```

这只是一个鸟瞰概述，您应该查看一些 Rails 教程。

关于为不在数据库中的内容生成页面...

我曾经遇到过这个问题并像这样解决了它：

```
#config/routes.rb
get "/:view" match 'home#views' # rails g controller home

#app/controllers/views_controller.rb
class HomeController < ApplicationController
  def views
    render params[:view]
  end
end 
```

现在为每个新页面生成一个视图，让我们说“关于”，`/app/views/home`您可以通过`/view_name`.

# asp.net - 在没有 IIS 的任何 Windows 7 PC 上本地运行已编译的 ASP.net MVC 4 项目

> ID：13422534
> 
> 赞同：0
> 
> 时间：2012-11-16T18:44:57.343
> 
> 标签：asp.net, iis, asp.net-mvc-4

好的，所以让我们忘记担心可见代码。

我有一个编译的 MVC 4 应用程序，使用 Web API、Backbone 和 HTML 5 编写，并在应用程序中包含的紧凑 SQL 中为本地 CRUD 存储配置。数据通过 API 从 Internet 接收并存储在本地 Db 中。本地 Db 也通过 API 向一些远程 MVC 网站 Db 发送数据。

**问题：**

除了提供包含编译应用程序和 sql db 的 zip 文件下载之外，还必须为用户做什么，在本地 PC 或平板电脑上运行 Windows 7（具有充足的存储空间）？

我是否需要一些预先打包的罐装“更新到 4.5 Net 等，等等才能在本地运行 MVC 4”，或者我需要创建一些自定义系统更新伴随程序，或者我什么都不做，因为该应用程序可以在本地 PC 上正常运行没有 IIS 的 Windows 7 标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:40:49.420

如果没有某种 Web 服务器，您将无法运行 ASP.net。IIS 就是答案（除非你想在 Linux 上摆弄 Mono）。

在可访问的网站上托管应用程序并为用户提供 URL。这就是您使用 ASP.NET 而不是创建 winforms 应用程序的原因，对吧？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:46:50.610

控制面板-程序和功能-打开windos功能

互联网信息服务 + .Net Framework 4.5

那是你需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T20:00:12.483

您可能可以尝试 WebMatrix 2，因为它带有 IIS Express...

# java - JButton 的 NullPointerException

> ID：13422539
> 
> 赞同：3
> 
> 时间：2012-11-16T18:45:06.637
> 
> 标签：java, swing, nullpointerexception, jbutton

我正在尝试将文本分配给循环内的按钮，但出现 NullPointerException。我已经在类的构造函数中初始化了按钮数组，在初始化之后，我调用了以下方法。这是我遇到错误的代码。

```
public class Alfred
{
   private String names[]={"nfs","gta","maxpayne","hitman"};
   private JButton but[];

   public Alfred()
   {
    ...
     but= new JButton[4];
    AssignLettersToButtons();
   }
    private void AssignLettersToButtons()
    {       
        for(int i=0;i<names.length;i++)
        {
            but[i].setText(names[i]); // error
            pane1.add(but[i]);
        }
    }
}
} 
```

按钮数组和名称数组的长度相同。此异常的原因是什么，我该如何解决？

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T18:51:11.957

```
 but= new JButton[4]; 
```

这只为四个数组元素**分配空间**；每个元素都被[初始化](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)为`null`，这是像您的对象这样的引用类型的*默认值。*`JButton`

`but[0]`, `but[1]`, `but[2]`,`but[3]`都是`null`。

您应该像这样**初始化**它们：

```
but[0] = new JButton(); //or whatever. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:47:39.863

您尚未初始化`but`数组中的元素。

如果要在循环中进行初始化，可以将其简化为：

```
for (int i=0;i<names.length;i++)
    pane1.add(but[i] = new JButton(names[i])); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:49:05.723

这里

```
 but[i].setText(names[i]); //but[i] is null here 
```

在调用方法之前初始化 but 数组

并实例化数组中的元素，因为它们都是空的 看看

```
 for(int i=0;i<names.length;i++)
    {
        System.out.println(but[i]);//all will print null
    } 
```

尝试这样的代码来实例化元素

```
 for(int i=0;i<names.length;i++)
    {
       but[i]= new Jbutton();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T18:53:28.383

如果 but 数组的大小为 5。在执行以下操作之前，在其中添加 5 个 but 对象：

```
but[i].setText(names[i]); 
```

我认为你的数组没有用对象初始化，这就是为什么当你这样做时`setText()`它会给你 NPE。

尝试如下操作：

```
for(int i=0;i<names.length;i++)
        {
            JButton butObject = new JButton();//Add this line to your code
            but[i]=butObject;         // Add this line to your code
            but[i].setText(names[i]); // error
            pane1.add(but[i]);
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T19:47:07.333

Java 将 JButton 类型的数组初始化为 0（又名 NULL）。您需要将数组的每个索引初始化为指向 JButton 实例的指针，因为它不会为每个元素自动调用构造函数。

# javascript - 如何检查 Facebook 开发用户是否属于应用的管理员、开发人员或测试人员角色？

> ID：13422547
> 
> 赞同：1
> 
> 时间：2012-11-16T18:45:33.220
> 
> 标签：javascript, ajax, facebook-graph-api

我对 Facebook Graph API 进行了很多研究，但找不到解释如何检查用户是否属于 Facebook 应用的管理员、开发人员或测试人员角色的文档。

有没有办法使用 JavaScript 通过 REST API/Facebook Graph 获取这些信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T15:23:33.630

此查询将获取与用户关联的所有角色的列表：

```
SELECT application_id, role FROM developer WHERE developer_id = me() 
```

如果您应用程序访问令牌，那么您可以获取所有开发人员及其角色的列表，如下所示：

```
SELECT developer_id, role FROM developer WHERE application_id = 0 
```

更多信息可以在[https://developers.facebook.com/docs/reference/fql/developer/](https://developers.facebook.com/docs/reference/fql/developer/)找到。

# opencv - 准备好数据（每行一个样本）以使用 k-means 进行聚类？

> ID：13422553
> 
> 赞同：0
> 
> 时间：2012-11-16T18:45:56.753
> 
> 标签：opencv, cluster-analysis, k-means, sift

我正在尝试使用 kmeans 函数对关键点（使用 SIFT 检测到）进行聚类，但我无法让它准备好使用。

使用以下代码将关键点保存到 xml/yml 文件中：

```
int _tmain(int argc, _TCHAR* argv[])
{
Mat img;

img = imread("c:\\box.png", 0);

SiftFeatureDetector detector;
vector<KeyPoint> keypoints;
detector.detect(img, keypoints);

FileStorage fs("keypoint1.xml", FileStorage::WRITE);
write(fs, "keypoints1", keypoints);
fs.release(); 
```

xml 保存用空格分隔的关键点，yml 使用逗号分隔关键点。

```
%YAML:1.0
keypoints1: [ 6.1368021965026855e+000, 5.2649226188659668e+000,
    4.0740542411804199e+000, 2.7943280029296875e+002, 0., 9109760, -1,
    6.1368021965026855e+000, 5.2649226188659668e+000,
    4.0740542411804199e+000, 3.4678604125976562e+002, 0., 9109760, -1,
    1.5903041076660156e+002, 2.4698186874389648e+001,
    4.1325736045837402e+000, 9.7977493286132813e+001, 0., 10158336, -1,
    1.6808378601074219e+002, 2.5029441833496094e+001,
    4.2399377822875977e+000, 9.7380126953125000e+001, 0., 11993344, -1,
    1.9952423095703125e+002, 4.4663669586181641e+001,
    5.0049328804016113e+000, 5.7439949035644531e+001, 0., 7275008, -1,
    3.0947158813476563e+002, 4.6865818023681641e+001,...................... 
```

[kmeans](http://docs.opencv.org/modules/core/doc/clustering.html#double%20kmeans%28InputArray%20data,%20int%20K,%20InputOutputArray%20bestLabels,%20TermCriteria%20criteria,%20int%20attempts,%20int%20flags,%20OutputArray%20centers%29)函数要求每个样本输入一行。有人可以解释一下吗，我的意思是上述文件可以用作单行吗？它是否符合使用 FileStorage 读取方法的 kmeans 条件？

我想添加和读取文件的原因是假设我有 100 个关键点需要聚类的图像。我想将所有这些文件附加到一个巨大的文件中并将其聚集在一起。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T22:08:39.023

Tom is correct. Usually with SIFT, you use **more than one keypoint per image**. That is the whole idea behind keypoint detection, that you try to process only the "interesting" parts of the image in the further steps.

So for clustering images, regular SIFT features will not work too well. They are good for **panorama construction** and such things, where you expect to find the *same* keypoints across multiple images.

However, you can "abuse" SIFT keypoints; and that probably is what you are trying to reproduce. It would certainly help if you read the relevant articles, instead of just trying to figure it out yourself from a coding point of view.

A simple introduction can be found here: [http://image-net.org/download-features](http://image-net.org/download-features)

Notice how they sample the same number of keypoints from each image, by using a regular grid. Yet, they still do not put them together into one huge array - that doesn't work for similarity search. Instead they perform a kind of dimensionality reduction.

They run k-means on all of the *individual* keypoints of *all* images, to obtain 1000 "common" keypoints, called **visual words**. Then they translate each keypoint into the best matching visual word, and this way obtain a text-like representation of the image. Except that the keypoints don't have human-readable names, you can imagine representing the images as something like "sky sky sky sky fur fur fur forest sky fur sky fur water forest water water water forest" for an image with a beaver swimming in a lake.

On these **bag of words** representations you could then run clustering or similarity search again. K-means won't work well, because the vectors are sparse. Euclidean distance doesn't work well for sparse data, and k-means is unfortunately designed for Euclidean distance. Plus, the means are no longer sparse, and that makes them abnormal. Most likely, the resulting means will be more similar to each other than to the instances, taking the whole partitioning ad absurdum.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:59:45.733

筛选点的数量随图像而变化，因此也没有固定长度的向量可以投影。此外，您连接它们以创建 1 个大向量的顺序意味着顺序很重要。SIFT 特征是一*组*点（不是向量）

您需要更复杂的指标来定义相似性。欧几里得或其他基于矢量的指标将不起作用。OpenCV 的 K-means 需要向量输入，所以它不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T23:45:25.090

SIFT 特征是一回事，每个特征的值构建向量。当您从 SIFT 关键点提取 SIFT 描述符时，您正在提取 4x4 区域中 8 个可能方向的梯度幅度。因此，对于每个关键点，您都有一个具有 128 个特征的向量，或者如果需要，还有 128 个维度。它与表示欧几里得空间中的一个点相同，但不是三个维度，而是 128。常规 SIFT 描述符的一个变体表现更好。密集筛选。它不是从高斯差中计算关键点，而是在图像顶部放置一个矩形网格来提取描述符。在谷歌中寻找 vl_feat。

# c# - 将结构编组到 out 会返回垃圾

> ID：13422555
> 
> 赞同：0
> 
> 时间：2012-11-16T18:46:05.027
> 
> 标签：c#, struct, marshalling, ref

我正在尝试在非托管 dll 中存储和检索一些数据。我试图通过尽可能简化结构来缩小我的问题范围，这就是我要解决的问题：

结构定义

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi, Pack = 1)]
public class MyStruct
{
  private UInt32 size;    
  public UInt16 SomeData;

  public MyStruct()
  {
    size = (UInt32)Marshal.SizeOf(this);
    this.SomeData = 66; //just put any non 0 value for test
  }
} 
```

DLL 导入：

```
[DllImport(MY_DLL, CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
[return:MarshalAs(UnmanagedType.U1)]
public static extern bool SetData(ref MyStruct ms);
[DllImport(MY_DLL, CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
public static extern IntPtr GetData(); 
```

函数调用：

```
MyStruct ms_in = new MyStruct();
bool b = Wrapper.SetData(ref ms_in);
IntPtr ptr = Wrapper.GetData();
MyStruct ms_out = (MyStruct)Marshal.PtrToStructure(ptr, typeof(MyStruct)); 
```

我猜很简单。我知道字符集和打包是可以的，因为我只是将另一个结构定义中的结构布局属性粘贴到与我实际上对大多数代码所做的相同的 dll 中。

当读取 ms_out 的内容时，它充满了垃圾（随机大数）。

我终于通过反复试验找到了我的问题的答案，但我不太明白。这是工作版本：

```
[DllImport(MY_DLL, CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
[return:MarshalAs(UnmanagedType.I1)]
public static extern bool SetData( [In, MarshalAs(UnmanagedType.LPStruct)] MyStruct ms); 
```

用 [In, MarshalAs(UnmanagedType.LPStruct)] 替换 ref 成功了，但为什么呢？

感谢您的回答，祝您编码愉快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T11:40:46.743

现在为什么从非托管 dll 返回时结构中充满了垃圾？

当我在非托管 dll 上设置数据然后将其取回时会发生这种情况，但当我在本地创建非托管指针、设置数据并将其读回时不会发生这种情况：

```
MyClass x = new MyClass(); //create class
IntPtr ptr2 = Marshal.AllocHGlobal(Marshal.SizeOf(x)); //allocate unmanaged memory
Marshal.StructureToPtr(x, ptr2, false); //marshall to unmanaged memory
MyClass xOut = (MyClass)Marshal.PtrToStructure(ptr2, typeof(MyClass)); //marshall from unmanaged memory
Marshal.FreeHGlobal(ptr2); //free unmanaged memory 
```

如果您的数据“通过”上述测试，那么所有 StructLayout、字符集、编组等都可以。就我而言，它是。

如果您只是在 c# 中创建数据并将指向它的指针传递给非托管代码，您只能确定*指针地址*是有效的，只要 c# 变量超出范围，它指向的数据就会无效。

以下方法适用于我测试的任何类型的数据，包括字符串：

```
[return:MarshalAs(UnmanagedType.U1)]
public static extern bool SetData( IntPtr data); //no marshalling in, no ref, no problem...

MyClass x = new MyClass(); //create class
//...store some data in x....
IntPtr ptrIn = Marshal.AllocHGlobal(Marshal.SizeOf(x)); //allocate unmanaged memory
Marshal.StructureToPtr(x, ptrIn, false);    //marshall to unmanaged memory

bool b = Wrapper.SetData(ref ms_in); //store data in unmanaged dll
IntPtr ptrOut = Wrapper.GetData(); //get data back from unmanaged dll

MyClass xOut = (MyClass)Marshal.PtrToStructure(ptrOut, typeof(MyClass)); //marshall from unmanaged memory

Marshal.FreeHGlobal(ptrIn); //free unmanaged memory 
```

这里的问题是调用者必须释放分配的内存。在我的场景中，这用于将数据传递给另一个非托管 dll（不要问...），但调用程序无法确保最终接收者实际读取了数据。

到底谁来负责清理内存？

我可能会与被调用者一起清理数据，调用者在创建新块之前检查数据是否已释放/清理，除非我发现场景更简单一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T11:03:26.990

进一步研究这一点，我发现编组可以与 c# 结构或类一起用作目标。

使用结构：

```
[StructLayout...
struct MyStruct
{
  //some properties

  //can't have parameterless constructor
  public void MakeStruct()
  {
    size = ...;
    //initialize properties as needed
  }
}   
...
public static extern bool SetData(ref MyStruct ms); //ref is ok for struct, equivalent to c &struct 
```

使用一个类：

```
[StructLayout...
class MyClass
{
  //some properties

  //parameterless constructor
  public void MyClass()
  {
    size = ...;
    //initialize properties as needed
  }
}

...
public static extern bool SetData([In, MarshalAs(UnmanagedType.LPStruct)]  MyClass ms); //no ref for class 
```

使用类的优点是在构造函数中自动设置大小，而不是调用者必须使用结构版本显式设置它。

# android - 如何在选定选项卡上禁用 FragmentPagerAdapter 中第一个 Fragment 的重新创建？

> ID：13422569
> 
> 赞同：1
> 
> 时间：2012-11-16T18:47:01.300
> 
> 标签：android, android-actionbar, fragmentpageradapter

`onCreateView`我在 FragmentPagerAdapter 中的第一个片段不是很快。因此，将当前选项卡更改为第一个选项卡会有延迟。

如何在选定选项卡上禁用在 FragmentPagerAdapter 中重新创建第一个片段？

```
private class TabsAdapter extends FragmentPagerAdapter implements ViewPager.OnPageChangeListener, ActionBar.TabListener {
    private final Context context;
    private ActionBar bar;
    private final ViewPager viewPager;
    private final ArrayList<TabInfo> tabs = new ArrayList<TabInfo>();

    final class TabInfo {
        private final Class<?> clss;
        private final Bundle args;

        TabInfo(Class<?> _class, Bundle _args) {
            clss = _class;
            args = _args;
        }
    }

    TabsAdapter(SherlockFragmentActivity activity, ViewPager pager) {
        super(activity.getSupportFragmentManager());
        context = activity;
        bar = activity.getSupportActionBar();
        viewPager = pager;
        viewPager.setAdapter(this);
        viewPager.setOnPageChangeListener(this);
    }

    public void addTab(ActionBar.Tab tab, Class<?> clss, Bundle args) {
        TabInfo info = new TabInfo(clss, args);
        tab.setTag(info);
        tab.setTabListener(this);
        tabs.add(info);
        bar.addTab(tab);
        notifyDataSetChanged();
    }

    @Override
    public int getCount() {
        return tabs.size();
    }

    @Override
    public Fragment getItem(int position) {
        TabInfo info = tabs.get(position);
        Fragment fragment = Fragment.instantiate(context, info.clss.getName(), info.args);
        return fragment;
    }

    @Override
    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {}
    @Override
    public void onPageScrollStateChanged(int state) {}

    @Override
    public void onPageSelected(int position) {
        bar.setSelectedNavigationItem(position);
    }

    @Override
    public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
        Object tag = tab.getTag();
        for (int i = 0; i < tabs.size(); i++) {
            if (tabs.get(i) == tag) 
                viewPager.setCurrentItem(i);
        }
    }

    @Override
    public void onTabUnselected(ActionBar.Tab tab, FragmentTransaction ft) {}
    @Override
    public void onTabReselected(ActionBar.Tab tab, FragmentTransaction ft) {}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T09:13:04.807

现在我遇到了同样的问题。

当您在**Tab:(n)**上时，只有**Tab:(n-1)**和**Tab:(n+1)**会在内存中存活，以优化内存使用。其余所有选项卡都将被销毁，这就是为什么当您回到第一个选项卡时，它的 onCreateView 会再次被调用。

实际上，即使您单击**Tab:2 ，也会调用****Tab:1 的**onCreateView ，因为它是附近的 Tab。

 **我得到的一个解决方案是：

更改 ViewPager 的**OffscreenPageLimit**。它的默认值为**1**

```
viewPager.setOffscreenPageLimit(total no of Tabs - 1); 
```

这样所有的选项卡都会活着，即使它在屏幕外。但仅当您没有足够**的标签时才建议这样做（<=5）**

如果你有大量的标签，最好使用

[FragmentStatePagerAdapter](http://developer.android.com/reference/android/support/v4/app/FragmentStatePagerAdapter.html)**

# sql - 显示特定行计数信息的 SQL Select 语句？

> ID：13422570
> 
> 赞同：0
> 
> 时间：2012-11-16T18:47:07.663
> 
> 标签：sql, select, count

我需要一些 SQL 帮助..

假设我有 2 个表：`Customers`和`Products`.

现在，我想查看一条 SQL 语句，它将显示这两列：

```
Customer  |   Number of orders placed 
```

我怎么做 ？

第二列是一个不存在的列，它显示了一个数字，该数字说明了客户下了多少订单。

例如：

```
Customer  | Number of orders placed
--------  | -----------------------
John      |              23
Jack      |               5
Mary      |              12 
```

ETC ..

这种 select 的 SQL 是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:50:52.563

加入。这只是组成您的列名，因为没有给出表格。

```
 SELECT 
        c.Name,
        myOrders = COUNT(o.id)
   FROM Customers c
   INNER JOIN Orders o
        ON c.id = o.customerId
   GROUP BY c.Name 
```

一些快速阅读：[JOINS](http://www.w3schools.com/sql/sql_join.asp)。 [通过...分组](http://www.w3schools.com/sql/sql_groupby.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:51:14.760

我猜 Product 表包含一个引用客户的外键 CustomerID。结果查询将是

```
select Customers.Name, Count(*)
from   Customers join Products 
       on Customers.CustomerID = Products.CustomerID 
```

然而，这只是一个猜测，因为您忘记告诉我们两个表之间的关系，即产品如何知道它们属于哪个客户。

另外，但这有点挑剔，您想要订单数量但只有一个“产品”表......

# algorithm - 为什么我们需要后缀树中的哨兵字符？

> ID：13422573
> 
> 赞同：4
> 
> 时间：2012-11-16T18:47:40.750
> 
> 标签：algorithm, suffix-tree

为什么我们在实现[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)时需要将“$”附加到原始字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T08:32:24.280

当使用特定的构造算法时，在字符串末尾附加一个（甚至更多）特殊字符可能有特殊原因——无论是在后缀树和后缀数组的情况下。

然而，就后缀树而言，**最根本的根本原因**是后缀树的两个属性的组合：

1.  后缀树是 PATRICIA 树，即边缘标签与尝试的边缘标签不同，是由一个或多个字符组成的*字符串*
2.  内部节点仅存在于分支点

这意味着您可能会遇到一个边缘标签是另一个边缘标签的情况：

![在此处输入图像描述](../Images/2f4e1408b1f46918cc59f5b26b6c6489.png)

这里的想法是右边的黑色节点是叶子节点，即后缀到此结束。但是如果文本有后缀`aa`，那么单个字符`a`也必须是后缀。但是我们无法存储后缀在第一个 之后结束的信息`a`，因为`aa`它形成了树的一个连续边（上面的属性 1）。我们必须引入一个可以存储信息的中间节点，如下所示：

![在此处输入图像描述](../Images/b12c6b15de984032ebd1132bf9496491.png)

但这将是非法的，因为属性 2：除非存在分支点，否则不得存在内部节点。

如果我们可以保证文本的最后一个字符是整个字符串中没有其他地方出现的字符，那么问题就解决了。美元符号通常用作它的符号。

显然，如果最后一个字符没有出现在其他地方，则字符串末尾不可能有任何重复（例如`aa`，甚至更复杂的，例如`abcabc`），因此不会出现非分支内部节点的问题。在上面的例子中，放在`$`字符串末尾的效果是：

![在此处输入图像描述](../Images/14ce2aa29af8e6bca2c903a531e8ca91.png)

现在有三个后缀：`aa$`,`a$`和`$`，但没有一个是另一个的前缀。显然，这意味着我们毕竟需要引入一个内部节点，现在一共有三个叶子。所以，可以肯定的是，这样做的好处**并不是**我们节省了空间或任何东西变得更有效率。这只是保证上述两个属性的一种方式。当我们证明后缀树的某些有用特性时，这些属性很重要，包括它的内部节点数量与字符串长度呈线性关系（如果允许非分支内部节点，则无法[证明这一点）。](https://stackoverflow.com/questions/13389858/maximum-and-minimum-number-of-nodes-in-a-suffix-tree)

这也意味着**在实践中**，您可能会使用不同的方式来处理作为其他后缀前缀的后缀以及非分支内部节点。例如，如果您使用著名的 Ukkonen 算法来构造树，则无需在末尾附加唯一字符即可这样做；您只需要确保在最后一次迭代之后，将非分支内部节点放在每个隐式后缀的末尾（即，每个后缀都在边缘中间结束）。

同样，在构建后缀树或数组之前将其放在文本末尾**可能还有更多且非常具体的原因。**`$`例如，在基于 DC（差异覆盖）原理的后缀数组的构造算法中，您必须`$`在字符串的末尾放置两个符号，以确保即使字符串的最后一个字符也是完整字符三元组的一部分，因为该算法基于三元排序。此外，在某些特定情况下，`$`必须以特殊方式解释唯一字符。对于 Ukkonen 构造算法，唯一性就足够了`$`；对于 DC 后缀数组算法，除了唯一性之外，还有必要`$`在字典上比所有其他字符都小，并且在基于后缀树的圆形字符串切割算法（最近[在这里](https://stackoverflow.com/questions/13403653/can-we-use-circular-strings-with-suffix-trees)提到）中，实际上有必要将其解释`$`为字典*上最大*的字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:56:10.457

我怀疑它是出于遍历目的。当您从后缀树生成*某些*内容时，您需要知道您是否在字符串完成的节点处，如果没有，那么您知道您必须继续前进。查看后缀树为其提供线性时间解决方案的[最长公共子字符串](http://en.wikipedia.org/wiki/Longest_common_substring_problem)`$`，您需要哨兵来确定您已到达字符串终止的节点。之后你不能完成`A-NA`。

来自维基百科

![在此处输入图像描述](../Images/5332485d671130de33c925e9170f26ea.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-01T23:01:58.090

**1.不是帕特里夏**

后缀树不是帕特里夏树，它是基数 2。后缀树节点可能有 2 个或更多子节点。

**2\. 今天没有任何正当理由**

除了添加特殊字符之外，没有任何理由

*   要求有2个或更多的孩子
*   对于 n 个字符的字符串，要求恰好有 n 个叶子

后缀树可以以与压缩特里树（或基数树作为其中一种）相同的方式实现，没有任何特殊符号，在这种情况下也没有任何功能上的缺点。

**3\. 古老的小径**

如果您查看 1973 年的旧书，您会看到与名为“未压缩后缀树”的 trie 结构非常相似，但带有值和终止符号。然后他们压缩它。

**4\. 但有什么不同？**

前缀和后缀树在节点中都有元数据，对吧？它被实现为节点的值。

**但是对于后缀树，我们有一个有趣的要求——我们需要一个后缀的索引。因此，在最后一个节点中，我们必须保留两个元数据字段，两个值。而且您需要保持节点大小相同，逐个字节。所以他们通过额外的节点，结束节点**

在现代世界中，您可以保留任意数量的字段，您不会保存所花费的每个字节，因此您不需要这个技巧。

**5\. 那么，我们有理由使用结束符号吗？**

是的，可能我们有一个非功能性原因 - 在每个非叶节点中保存几个字节。

**6\. 仍然......结束符号的任何功能原因？**

是的，我们可能有一个结束符号**S**有用的情况 - [**GENERALIZED** suffix tree](https://en.wikipedia.org/wiki/Generalized_suffix_tree)，而不仅仅是后缀树。

广义后缀树将需要不同的结束标记，在节点上的集合**或作为单独的结束符号**。同样，您可以使用或不使用特殊符号来实现。

**7\. 底线**

*   这些要求似乎是旧系统的遗留问题
*   随意以与压缩前缀树相同的方式实现后缀树，没有任何警告，除了在每个节点中为未使用的结束索引标志浪费了几个字节。
*   广义后缀树是一种结构，其中结束符号**S** ***可能有用***（但您仍然可以在没有它们的情况下构建它）

我希望这将使情况更清楚。

# android - 在我自己的自定义 android 主屏幕中，我如何捕捉主页按钮？

> ID：13422575
> 
> 赞同：2
> 
> 时间：2012-11-16T18:47:48.680
> 
> 标签：android, android-homebutton

我知道android不允许我们抓住home键的按下；但是，我有自己构建的主屏幕替换应用程序，只想知道何时按下按钮以允许动画。

因此，我的应用程序只有一项活动，因为我将大部分“活动”作为画布绘图，因此我可以完全控制我的应用程序的视觉美感。问题是，如果用户导航到应用程序中的不同页面并按下主页，则不会发生任何事情，因为从技术上讲，该应用程序已经在同一个活动中。

我想知道何时按下按钮，以便我可以动画/导航我的应用程序回到主屏幕。另外，我知道我可以通过单独的实际活动来实现这一点，但这对我正在尝试做的事情不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:03:09.683

您需要`<category android:name="android.intent.category.HOME"/>`在应用的 Android.xml 中添加活动的意图过滤器

您可以查看 Android SDK 示例中的“Home”应用程序。可以使用[这些说明](http://developer.android.com/tools/samples/index.html)下载它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-21T07:39:30.697

//重写方法

```
 @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {     

        if(keyCode == KeyEvent.KEYCODE_HOME)
        {
           //The Code Want to Perform. 
        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:03:03.780

您可以检测何时按下主页按钮，因为`onPause()`总是被调用。您不允许覆盖主页按钮，但以下应该可以工作

```
@Override
protected void onPause() 
{
    super.onPause();
    //code here
} 
```

当然，使用它的问题是即使用户没有退出应用程序也会调用它（即，如果它们通过意图发送到另一个应用程序）

那是你最接近的，`onHomeButtonPressedListener`真的没有办法做到这一点

*   [Home 按键事件监听器](https://stackoverflow.com/questions/6693896/home-key-press-event-listener)

# windows - WP7 去除黑边

> ID：13422577
> 
> 赞同：1
> 
> 时间：2012-11-16T18:47:50.690
> 
> 标签：windows, windows-phone-7, button, border

我一直在尝试和寻找这个已经退出很长时间了。

Windows 在按钮组件周围添加了黑色（或透明）边框。这样做的原因是按钮的触摸区域有点大，因此更容易点击按钮。

在我的应用程序中，我确实需要删除该区域。我尝试了很多，但似乎不可能。我也在 E​​xpression Blend 中尝试过，但没有运气。

```
 <Style x:Key="ButtonStyleCalendar" TargetType="Button">
        <Setter Property="Background" Value="{StaticResource PhoneAccentBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource PhoneForegroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="FontSize" Value="{StaticResource PhoneFontSizeSmall}"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Margin" Value="0" />
        <Setter Property="VerticalContentAlignment" Value="Top" />
    </Style> 
```

这就是我应用于按钮的样式。我认为这将是边距或填充，但事实并非如此。

有人对此有答案吗？我搜索了stackoverflow，但没有人想出解决方案。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T20:04:57.790

您需要覆盖`ControlTemplate`Button 并删除`Margin="{StaticResource PhoneTouchTargetOverhang}"`. 这是生成的样式：

```
<Style x:Key="ButtonStyleCalendar" TargetType="Button">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="{StaticResource PhoneForegroundBrush}"/>
    <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
    <Setter Property="BorderThickness" Value="{StaticResource PhoneBorderThickness}"/>
    <Setter Property="FontFamily" Value="{StaticResource PhoneFontFamilySemiBold}"/>
    <Setter Property="FontSize" Value="{StaticResource PhoneFontSizeMediumLarge}"/>
    <Setter Property="Padding" Value="10,3,10,5"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Grid Background="Transparent">
                    <Border x:Name="ButtonBackground" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="0" >
                        <ContentControl x:Name="ContentContainer" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" Padding="{TemplateBinding Padding}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Border>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# go - 在 golang 中是否有一种从地图中获取值的好方法？

> ID：13422578
> 
> 赞同：119
> 
> 时间：2012-11-16T18:47:53.650
> 
> 标签：go

如果我有一张地图 m 是否有更好的方法来获取值 v 的一部分而不是

```
package main
import (
  "fmt"
)

func main() {
    m := make(map[int]string)

    m[1] = "a"
    m[2] = "b"
    m[3] = "c"
    m[4] = "d"

    // Can this be done better?
    v := make([]string, len(m), len(m))
    idx := 0
    for  _, value := range m {
       v[idx] = value
       idx++
    }

    fmt.Println(v)
 } 
```

有地图的内置功能吗？Go 包中是否有一个函数，或者如果我必须这样做，这是最好的代码吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-11-17T05:20:16.463

作为 jimt 帖子的补充：

您也可以使用`append`而不是显式地将值分配给它们的索引：

```
m := make(map[int]string)

m[1] = "a"
m[2] = "b"
m[3] = "c"
m[4] = "d"

v := make([]string, 0, len(m))

for  _, value := range m {
   v = append(v, value)
} 
```

请注意，长度为零（尚无元素），但容量（分配的空间）使用 的元素数进行初始化`m`。这样做是为了`append`不需要在每次切片容量`v`用完时分配内存。

您也可以`make`在没有容量值的情况下切片，并`append`为自己分配内存。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2012-11-16T18:52:55.513

很不幸的是，不行。没有内置的方法可以做到这一点。

作为旁注，您可以在创建切片时省略容量参数：

```
v := make([]string, len(m)) 
```

这里暗示容量与长度相同。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-05-22T10:49:12.650

不一定更好，但更简洁的方法是定义**切片长度和容量，**例如`txs := make([]Tx, 0, len(txMap))`

```
 // Defines the Slice capacity to match the Map elements count
    txs := make([]Tx, 0, len(txMap))

    for _, tx := range txMap {
        txs = append(txs, tx)
    } 
```

完整示例：

```
package main

import (
    "github.com/davecgh/go-spew/spew"
)

type Tx struct {
    from  string
    to    string
    value uint64
}

func main() {
    // Extra touch pre-defining the Map length to avoid reallocation
    txMap := make(map[string]Tx, 3)
    txMap["tx1"] = Tx{"andrej", "babayaga", 10}
    txMap["tx2"] = Tx{"andrej", "babayaga", 20}
    txMap["tx3"] = Tx{"andrej", "babayaga", 30}

    txSlice := getTXsAsSlice(txMap)
    spew.Dump(txSlice)
}

func getTXsAsSlice(txMap map[string]Tx) []Tx {
    // Defines the Slice capacity to match the Map elements count
    txs := make([]Tx, 0, len(txMap))
    for _, tx := range txMap {
        txs = append(txs, tx)
    }

    return txs
} 
```

简单的解决方案，但有很多陷阱。阅读这篇博文了解更多详情：[https ://web3.coach/golang-how-to-convert-map-to-slice-three-gotchas](https://web3.coach/golang-how-to-convert-map-to-slice-three-gotchas)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-16T23:50:37.143

据我目前所知，go 没有一种方法可以将字符串/字节连接到生成的字符串中，而无需制作至少 /two/ 副本。

您目前必须增加一个 []byte，因为所有字符串值都是 const，然后您必须使用内置的字符串让语言创建一个“祝福”字符串对象，它将复制缓冲区，因为某处可能有引用到支持 [] 字节的地址。

如果 []byte 是合适的，那么您可以在 bytes.Join 函数中获得非常小的领先优势，方法是进行一次分配并进行复制调用您自己。

```
package main
import (
  "fmt"
)

func main() {
m := make(map[int]string)

m[1] = "a" ;    m[2] = "b" ;     m[3] = "c" ;    m[4] = "d"

ip := 0

/* If the elements of m are not all of fixed length you must use a method like this;
 * in that case also consider:
 * bytes.Join() and/or
 * strings.Join()
 * They are likely preferable for maintainability over small performance change.

for _, v := range m {
    ip += len(v)
}
*/

ip = len(m) * 1 // length of elements in m
r := make([]byte, ip, ip)
ip = 0
for  _, v := range m {
   ip += copy(r[ip:], v)
}

// r (return value) is currently a []byte, it mostly differs from 'string'
// in that it can be grown and has a different default fmt method.

fmt.Printf("%s\n", r)
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-05T23:42:11.350

你可以使用这个[`maps`](https://github.com/drgrib/maps)包：

```
go get https://github.com/drgrib/maps 
```

那么你只需要打电话

```
values := maps.GetValuesIntString(m) 
```

对于该常见`map`组合，它是类型安全的。您可以在同一包中使用该工具`generate`的任何其他类型的其他类型安全功能。`map``mapper`

完全披露：我是这个包的创建者。我创建它是因为我发现自己`map`反复重写这些函数。

# linux - 将单词放到行中的特定位置

> ID：13422585
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:48:26.533
> 
> 标签：linux, file, shell, awk

我有一个文件，它包含以下数据：

```
905222105114 BAHADIR ADANA 2122121

905222105114 ISTANBUL ANKARA 213123

0012312554645 ANTALYA BAHADIR 2312312 
```

我想把这些数据放在另一个文件中。

N.1 值必须从行的 0 位置开始。

N.2 值必须从行的 20 位置开始。

N.3 值必须从行的 40 位置开始。

N.4 值必须从行的 60 位置开始。

通过这种方式，我将得到一个文件，每个值都从行的当前位置开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:41:02.673

```
awk '{printf "%-20s%-20s%-20s%-20s\n",$1,$2,$3,$4}' file.dat 
```

应该做的伎俩...

# iphone - 应用发布到应用商店后图像消失

> ID：13422587
> 
> 赞同：2
> 
> 时间：2012-11-16T18:48:30.200
> 
> 标签：iphone, objective-c, uiimage, app-store

在我的应用程序发布到应用商店后，我的应用程序中有一些非常奇怪的东西。由于某些原因，我使用的一些 UIImages 只是丢失并显示为黑色。我之前在设备和模拟器中检查过很多次，看起来还不错。一些注意事项：

1.  我确实拖动了文件并检查了复制 - 图像肯定在库中
2.  图像 DO 出现在 Build Phases 下的 Copy Bundle Resources 中
3.  我使用这两行来获取图像：

> [UIImage imageNamed:@"email_icon.png"] 和 [UIImage imageNamed:@"facebook_icon"]

而且我刚刚注意到图像的扩展名是PNG而不是PNG - 也许是这个原因？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:04:49.980

你能在你的设备上复制这个问题吗？如果不是，我建议从您的设备中删除当前版本并重新部署。您可能在设备上缓存了不允许您看到问题的图像。

其次，是的，设备上的文件名区分大小写。还要确保您正确命名文件，这不仅仅是拼写错误或图像名称的更改。

根据您的代码行，您缺少第二张图片上的文件扩展名 `[UIImage imageNamed:@"email_icon.png"] and [UIImage imageNamed:@"facebook_icon"]` <-- facebook_icon 是什么类型的文件？

# magento - 获取简单产品的属性文本并隐藏在产品视图magento中可配置

> ID：13422592
> 
> 赞同：0
> 
> 时间：2012-11-16T18:48:46.737
> 
> 标签：magento, configurable

如何仅在简单产品上获取属性文本？并隐藏在可配置？在产品视图 Magento。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:50:24.270

这段代码应该在任何地方，并且只需要运行 1 次。运行此代码后，您可以将其删除。

```
 $setup = new Mage_Eav_Model_Entity_Setup('core_setup');

        $setup->addAttribute('catalog_product', 'attributename', array(
            'group'             => 'Geral',
            'label'             => 'Backend label',
            'note'              => '',
            'type'              => 'int',    //backend_type
            'input'             => 'text', //frontend_input
            'frontend_class'    => '',
            'source'            => 'sourcetype/attribute_source_type',
            'backend'           => '',
            'frontend'          => '',
            'global'            => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_WEBSITE,
            'required'          => true,
            'visible_on_front'  => false,
            'apply_to'          => 'simple',
            'is_configurable'   => false,
            'used_in_product_listing'   => false,
            'sort_order'        => 5,
        )); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:29:42.660

为什么不在基于类型 id 的 view.phtml 中做一个异常呢？

```
<?php if($_product->getTypeId() == "configurable"){ ?>
            <div class="product-view"> ... </div>

        <?php  } else { ?> 
            <div class="product-view"> ... </div>
        <?php  } ?> 
```

# python - Python：需要 kwarg，要引发哪个异常？

> ID：13422601
> 
> 赞同：32
> 
> 时间：2012-11-16T18:49:11.043
> 
> 标签：python, exception

确保使用特定 kwarg 调用方法的一种方法是：

```
def mymethod(self, *args, **kwargs):
    assert "required_field" in kwargs 
```

提高 an`AssertionError`似乎不是最合适的做法。是否有一个商定的内置异常来处理这个带有很好的错误消息？

更多信息：存在需要传递 *args 和 **kwargs kinda' 的 3rd-party 子类化问题，因此将“required_field”作为位置参数并不是一个好的选择。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-11-16T18:51:18.787

```
>>> def foo(bar): pass
... 
>>> foo()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: foo() missing 1 required positional argument: 'bar' 
```

我会选择 TypeError ..

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-11-16T19:51:49.480

+1 类型错误。这是 Python 3 为必需的仅关键字参数提出的：

```
>>> def foo(*, x):
...     pass
... 
>>> foo()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: foo() needs keyword-only argument x
>>> foo(2)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: foo() takes exactly 0 positional arguments (1 given)
>>> foo(x=2) 
```

*（TypeError 建议已经给出（并被接受）；我写这个答案是为了提到这个 Python 3 特性）。*

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-11-16T18:51:32.383

标准库似乎喜欢`TypeError`在获得错误数量的参数时提出。这本质上是你的问题，所以我会提出这个问题。

也就是说，`**kwargs`大部分时间基本上都是填写默认参数，所以有一个必需的默认参数似乎有点令人惊讶/困惑。

请注意，python 很乐意让您通过关键字调用位置参数：

```
>>> def foo(a, b):
...     print a, b
... 
>>> foo(a=1, b=2)
1 2
>>> foo(b=1, a=2)
2 1 
```

但我认为它们*都*必须由`foo(2, a=2)`您可能不想要的关键字（不起作用）引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T19:01:06.297

我认为`KeyError`是最合适的，因为`**kwargs`是`dict`.

```
>>> def foo(**kwargs):
...  print kwargs['abc']
...
>>> foo()
Traceback (most recent call last): 
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 2, in foo
KeyError: 'abc' 
```

如果该字段实际上是必需的，您可以检查它

```
try:
  kwargs['required']
except KeyError:
  raise KeyError('required is a Required Argument') 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-16T18:52:48.890

如果您需要它成为必需的关键字，请执行以下操作：

```
def mymethod(self,myrequired=None):
    if myrequired==None:
        #raise error
    #do other stuff down here 
```

你不应该真的需要从 kwargs 中提取它。

# java - java中实现具有相似签名的大量方法的最佳设计模式是什么？

> ID：13422603
> 
> 赞同：0
> 
> 时间：2012-11-16T18:49:34.753
> 
> 标签：java, design-patterns

[我想在TA-Lib](http://ta-lib.svn.sourceforge.net/viewvc/ta-lib/trunk/ta-lib/java/src/com/tictactec/ta/lib/Core.java?revision=1558&view=markup)中实现以下类的所有 cdl（烛台图案）方法 。

大约有 61 种 cdl 分析方法，其中大约 90% 具有相似的签名，只是它们的核心实现不同。

例如：

```
 public RetCode cdl2Crows(int startIdx,
      int endIdx,
      double inOpen[],
      double inHigh[],
      double inLow[],
      double inClose[],
      MInteger outBegIdx,
      MInteger outNBElement,
      int outInteger[])

public RetCode cdl3BlackCrows(int startIdx,
      int endIdx,
      double inOpen[],
      double inHigh[],
      double inLow[],
      double inClose[],
      MInteger outBegIdx,
      MInteger outNBElement,
      int outInteger[]) 
```

我在想是否可以将方法名称作为源类的参数传递，然后使用反射调用方法以避免重复代码

```
public invokeAnalytic(String analyticMethodName, common params .....)
{
    // using reflection invoke analyticMethodName of Core class
    // and pass rest of the params
} 
```

1.  在这种情况下，Java 中最好的设计模式是什么？
2.  如果我在这种情况下使用反射，会不会出现性能问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:59:28.790

将参数包装在不可变的[值对象](http://en.wikipedia.org/wiki/Value_object)中怎么样？

例如

```
MyValueObject params = new MyValueObject(int startIdx,
    int endIdx,
    double inOpen[],
    double inHigh[],
    double inLow[],
    double inClose[],
    MInteger outBegIdx,
    MInteger outNBElement,
    int outInteger[]);

// ....
someObject.cdl2Crows(params);
// ...
someObject.cdl3BlackCrows(params); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:12:34.600

```
public interface CDL

    public RetCode invoke
    (
          int startIdx,
          int endIdx,
          double inOpen[],
          double inHigh[],
          double inLow[],
          double inClose[],
          MInteger outBegIdx,
          MInteger outNBElement,
          int outInteger[]
    );

static Map<String,CDL> map = new HashMap<>();

map.put("cdl2Crows", new CDL()
{ 
    public RetCode invoke(...)
    { 
        impl... 
    }
});
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T18:58:21.990

创建公共数据点的最终类（类似于 C 中的结构）并将其作为参数传递给您的函数。它有点重，但并不像你想象的那么糟糕（尤其是在声明类的情况下`final`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T18:55:54.197

在这种情况下应该避免反射，因为您将失去安全性和性能，而不必多输入。

在这种情况下，我只使用基于方法签名相同/实现细节共享位置的接口层次结构或抽象类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T20:01:09.453

我认为策略模式是您最好的选择：

[http://java.dzone.com/articles/design-patterns-strategy](http://java.dzone.com/articles/design-patterns-strategy)

# arrays - MATLAB：成对差异矩阵

> ID：13422606
> 
> 赞同：8
> 
> 时间：2012-11-16T18:49:59.307
> 
> 标签：arrays, matlab, matrix

我有一个 Nx1 值向量。我想做的是创建一个 NxN 矩阵，其中每个值代表第 i 个和第 j 个值之间的差异 - 有点像一个大的相关矩阵。我已经用循环完成了这个，但我正在寻找一种更优雅的方法来使用 MATLAB 的矢量化功能，因为这个矢量可能会变得非常大。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-16T18:55:17.597

关于什么

```
 diff__ = bsxfun(@minus,repmat(A,N,1),A'); 
```

**这绝对**可以通过做来改善

```
 diff__ = bsxfun(@minus,A,A'); 
```

?

一点性能检查：

```
 N = 1000;
   v = rand(N,1);

   tic
   diff__ = bsxfun(@minus,repmat(v,N,1),v');
   toc

   tic
   diff__ = bsxfun(@minus,v,v');
   toc 
```

结果

```
 Elapsed time is 105.343344 seconds.
  Elapsed time is 1.124946 seconds. 
```

（蒂姆的数据检查：

差异__ =

```
 0     2     6     4
-2     0     4     2
-6    -4     0    -2
-4    -2     2     0 
```

）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-16T18:53:04.070

`meshgrid`可以生成适合此目的的矩阵。获得差分矩阵

```
meshgrid(v) - meshgrid(v)' 
```

例子：

```
>> v = [1 3 7 5]

v =

     1     3     7     5

>> meshgrid(v)

ans =

     1     3     7     5
     1     3     7     5
     1     3     7     5
     1     3     7     5

>> meshgrid(v) - meshgrid(v)'

ans =

     0     2     6     4
    -2     0     4     2
    -6    -4     0    -2
    -4    -2     2     0

>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:08:32.323

已经给出了很好的答案。但是为了凑热闹，这里有另一种方式（使用 Tim 数据）

```
v=[1 3 7 5];
 cell2mat(arrayfun(@(i) (v(i)-v)',1:size(v,2), 'UniformOutput',false)) 
```

答案=

```
 0     2     6     4
-2     0     4     2
-6    -4     0    -2
-4    -2     2     0 
```

# ruby - 使用 JsonPath 过滤哈希

> ID：13422607
> 
> 赞同：0
> 
> 时间：2012-11-16T18:50:09.263
> 
> 标签：ruby, hash, jsonpath

我需要找到某个哈希元素，其中一个键等于某个值。我尝试了很多方法，但似乎无法用`jsonpath`gem 弄清楚。

需要在`tire`哪里获取标签`grip == 'bad'`

```
require "jsonpath"

hash = {
    :id => 1,
    :cars => [
        {:id => 1, :tire => {:grip => "good", :color => "black"}},
        {:id => 2, :tire => {:grip => "bad", :color => "red"}},
        {:id => 3, :tire => {:grip => "good", :color => "green"}}
    ]
}

puts JsonPath.on(hash, "$..tire[?(@['grip'] == 'bad')]").inspect 
```

没结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T15:31:55.913

该`[?()]`过滤器仅适用于数组（或至少适用于数组或散列，而不是同时适用于两者）。为了让它工作，我必须将`:tire`散列包含在一个数组中。

原来的：

```
:tire => {:grip => "good", :color => "black"} 
```

新的：

```
:tire => [{:grip => "good", :color => "black"}] 
```

这是一个对我有用的“修复”。如果有人修复了`jsonpath`gem 以使其同时适用于数组和哈希（相同类型且同时），那就更好了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-16T18:55:14.173

在 JsonPath.on 中，第一个参数必须是 json，而不是哈希。
我不能通过 ruby​​ 做到这一点，这不是完全正确的解决方案。但这可能对您有所帮助。

```
require 'jsonpath'
require 'json'

hash = {
    :id => 1,
    :cars => [
        {:id => 1, :tire => {:grip => "good", :color => "black"}},
        {:id => 2, :tire => {:grip => "bad", :color => "red"}},
        {:id => 3, :tire => {:grip => "good", :color => "green"}}
    ]
}

json = hash.to_json
obj = JsonPath.new( "$..tire")[json]
result = obj.inject(Array.new){|res, x| res << x if x["grip"]=='bad'; res }

p result # [{"grip"=>"bad", "color"=>"red"}] 
```

# haskell - 我应该使用新的 Haskell 语言扩展来支持旧的吗？

> ID：13422610
> 
> 赞同：15
> 
> 时间：2012-11-16T18:50:25.013
> 
> 标签：haskell, functional-programming, language-features

当开始一个新的 Haskell 项目时，它需要新旧扩展提供的语言特性，我应该使用哪个？新的还是旧的？例如：

*   [GADT](http://www.haskell.org/ghc/docs/7.0.3/html/users_guide/data-type-extensions.html#gadt)取代[ExistentialQuantification](http://www.haskell.org/ghc/docs/7.0.3/html/users_guide/data-type-extensions.html#existential-quantification)。
*   在许多情况下，[TypeFamilies取代了](http://www.haskell.org/ghc/docs/7.0.3/html/users_guide/type-families.html)[FunctionalDependencies](http://www.haskell.org/ghc/docs/7.0.3/html/users_guide/type-class-extensions.html#functional-dependencies)。
*   等[（如果您有更多示例，请随时在此处添加）]

我倾向于较新的，因为它们感觉更干净，并且以统一的方式为语言添加了更多功能。但是，较旧的编译器得到更多编译器的支持，它们在现有库中使用，并且可能在程序员中也更为人所知。

**更新：**如答案/评论中所述，上述“取代”关系并不完全准确。但是，我对（经常发生的）一个任务可以通过几个扩展同样好地完成的情况感兴趣。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T20:56:34.517

“取代”在这里非常模棱两可。

对于语义与其他特征重叠的语言特征，我们可以识别几种情况：

*   一些特征概括了现有的
*   有些提供替代方法

在更一般的特征的情况下，有风险和好处。通用性会影响语言的许多其他部分，或者受到限制。在后者中，选择一般情况。

如果是在没有严格顺序的替代方法之间进行选择，例如 FD 或 AT，则很难给出一般性建议。

所以，总而言之，“不”，当谈到语言特性时，没有明显的理由使用“新”事物而不是“旧”事物。他们不这样排序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-16T22:47:47.993

简而言之，是的，并且出于您所说的原因：更干净，更清晰。

偶尔我会遇到一个类更好地表示为具有功能依赖的多参数类型类的地方，因为您可以通过这种方式更简单地获得更多参数，但通常关联类型系列是一种更清晰、更灵活的表达方式. 对于函数式程序员来说，类型族比函数式依赖更直观。

GADT 的语法比存在量化更清晰、更清晰，概念障碍更少，并且很容易获得你想要的行为。

如果可以的话，我建议使用新的东西，如果有必要的话，使用旧的方法。这些可爱的新扩展可以做更高的配置。

# sql - 使用一个 select 语句返回特定范围之间的行

> ID：13422613
> 
> 赞同：15
> 
> 时间：2012-11-16T18:50:42.993
> 
> 标签：sql, sql-server, database, sql-server-2008

我正在寻找这样的表达式（使用 SQL Server 2008）

```
SELECT TOP 10 columName FROM tableName 
```

但我需要 10 到 20 之间的值而不是那个值。我想知道是否有一种方法可以只使用一个 SELECT 语句来做到这一点。

例如这是没用的：

```
SELECT columName FROM
(SELECT ROW_NUMBER() OVER(ORDER BY someId) AS RowNum, * FROM tableName) AS alias
WHERE RowNum BETWEEN 10 AND 20 
```

因为括号内的选择已经返回所有结果，我希望避免这种情况，因为性能。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T19:00:27.057

有一个技巧`row_number`不涉及对所有行进行排序。

尝试这个：

```
SELECT columName
FROM (SELECT ROW_NUMBER() OVER(ORDER BY (select NULL as noorder)) AS RowNum, *
      FROM tableName
     ) as alias
WHERE RowNum BETWEEN 10 AND 20 
```

您不能在`order by`. 但是，您可以使用计算结果为常量的表达式。SQL Server 认识到这一点，并仅返回遇到的行，并正确枚举。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-16T18:55:23.283

使用 SQL Server 2012 获取/跳过！

```
SELECT SalesOrderID, SalesOrderDetailID, ProductID, OrderQty, UnitPrice, LineTotal
FROM AdventureWorks2012.Sales.SalesOrderDetail
OFFSET 10 ROWS FETCH NEXT 10 ROWS ONLY; 
```

对于旧版本的 sql server，没有什么比您描述的更好的了。也许使用 CTE，但不太可能有所作为。

```
WITH NumberedMyTable AS
(
    SELECT
        Id,
        Value,
        ROW_NUMBER() OVER (ORDER BY Id) AS RowNumber
    FROM
        MyTable
)
SELECT
    Id,
    Value
FROM
    NumberedMyTable
WHERE 
    RowNumber BETWEEN @From AND @To 
```

或者，您可以删除前 10 行，然后获取接下来的 10 行，但我会加倍任何人想要这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T19:07:05.163

为什么你认为 SQL Server 会评估整个内部查询？假设您的排序列已编入索引，它只会读取前 20 个值。如果你真的很紧张，你可以这样做：

```
Select
  Id 
From (
  Select Top 20 -- note top 20
    Row_Number() Over(Order By Id) As RowNum,
    Id 
  From
    dbo.Test
  Order By
    Id
  ) As alias
Where
  RowNum Between 10 And 20
Order By
  Id 
```

但我很确定查询计划是相同的。

（真的）根据 Aaron 的评论修复。

[http://sqlfiddle.com/#!3/db162/6](http://sqlfiddle.com/#!3/db162/6)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T14:53:27.237

另一种选择

```
SELECT TOP(11) columName
FROM dbo.tableName
ORDER BY
CASE WHEN ROW_NUMBER() OVER (ORDER BY someId) BETWEEN 10 AND 20 
     THEN ROW_NUMBER() OVER (ORDER BY someId) ELSE NULL END DESC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-16T19:18:35.337

您可以创建一个按您想要的方式排序的临时表：

SELECT ROW_NUMBER() OVER(ORDER BY someId) AS RowNum, * FROM tableName into ##tempTable ...

这样你就有了一个有序的行列表。并且可以在随后的时间中只按行号查询，而不是多次进行内部查询。

# xaml - 工作流设计器 XAML 文件中的错误

> ID：13422615
> 
> 赞同：2
> 
> 时间：2012-11-16T18:50:51.617
> 
> 标签：xaml, dynamics-crm, dynamics-crm-2011

我有一个从 Microsoft Dynamics CRM 2011 导出的 XAML 文件。当我在 VS 2010 中打开它时，我收到以下错误：

> Workflow Designer 遇到文档问题
> 
> 请检查文档中的无效内容、名称空间、引用或引用循环。
> 
> '设置属性 '{clr-namespace:Microsoft.Xrm.Sdk.Workflow.Activities;assembly=Microsoft.Xrm.Sdk.Workflow}ActivityReference.AssemblyQualifiedName' 引发异常。行号“59”和行位置“42”。

任何想法为什么会发生这种情况？

这是 XAML 文件中引用的行：

```
 <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T12:03:12.423

您需要`Microsoft.Xrm.Sdk.Workflow.dll`在 Workflow Toolbox 中添加对程序集的引用。

在 Visual Studio 中打开工具箱窗口（通常是从左侧弹出），右键单击并选择添加项目。添加对上述程序集的引用，该程序集位于 SDK 的 bin 文件夹中，您应该会看到工具窗格中亮起额外的自定义 CRM 活动。您现在应该能够加载/编译您的自定义工作流程

# android - Android 4.1 复制文件

> ID：13422617
> 
> 赞同：1
> 
> 时间：2012-11-16T18:50:56.350
> 
> 标签：android, android-4.2-jelly-bean

我正在开发一个应用程序来备份和恢复所有愤怒的小鸟版本的存档。对于 Android 4.0 或更高版本的设备，我编写了一个简单的输入/输出文件流，它可以工作。
在 Android 4.1 或更高版本的设备上（可能是因为安全性更高），愤怒的小鸟保存需要从我的应用程序复制更多权限（`rwx`还不够）。有没有办法更改在我的应用程序中添加 root 访问权限的权限，或者是否有不添加 root 的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:28:46.447

当文件存储到内部存储时，它们默认是私有的。除非应用程序使用 MODE_WORLD_READABLE 创建它们，否则您将无法阅读它们。唯一的捷径是要求有根设备并且你的应用程序被授予超级用户状态。

# android - 如何将 ListView 与 SherlockActivity 一起使用

> ID：13422620
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:51:07.080
> 
> 标签：android, adapter, actionbarsherlock

我在使用 listview 和 SherlockActivity 时遇到了一些问题。我的问题是我在这条线上得到了空值：

```
ListView    lv = (ListView) findViewById(R.id.mainListView ); 
```

我的 xml 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLa"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <ListView android:layout_width="fill_parent"   
      android:layout_height="fill_parent"   
      android:id="@+id/mainListView">  

    <ImageView
        android:id="@+id/iconremove"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:scaleType="centerCrop"
         android:src="@drawable/removeicon"
         android:visibility="gone"
          />

    <TextView
        android:id="@+id/textView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left|center_vertical"
        android:layout_marginLeft="10dip"
        android:layout_weight="1"
        android:textSize="20dip" />
      </ListView>    
</LinearLayout> 
```

我的代码看起来像这样：

```
public class ListRss extends SherlockActivity  {
    ActionBar actionbar; 
    @SuppressWarnings("unchecked")
    public ArrayList<rssLinkAndTitle> ListRssLinkAndTitle=new ArrayList();
    //public ArrayList listValue=new ArrayList();
    RssArrays rssparser=new RssArrays();
    Context con;
    @SuppressWarnings("unchecked")
    @Override
    public void onCreate(Bundle savedInstanceState) {

            super.onCreate(savedInstanceState);

            actionbar=getSupportActionBar();
            con=getApplicationContext();
            ListRssAdpter listAdapter;
        //  ListView lv = getListView();

            ListView    lv = (ListView) findViewById(R.id.mainListView ); 
```

谢谢您的帮助！

更新：

添加了这个

```
 super.onCreate(savedInstanceState);
           setContentView(R.layout.titlesrss); 
```

并且错误在这一行是：

```
11-17 07:57:46.341: E/AndroidRuntime(481): FATAL EXCEPTION: main
11-17 07:57:46.341: E/AndroidRuntime(481): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.rss/com.example.rss.ListRss}: java.lang.UnsupportedOperationException: addView(View, LayoutParams) is not supported in AdapterView
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.os.Looper.loop(Looper.java:123)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.ActivityThread.main(ActivityThread.java:3683)
11-17 07:57:46.341: E/AndroidRuntime(481):  at java.lang.reflect.Method.invokeNative(Native Method)
11-17 07:57:46.341: E/AndroidRuntime(481):  at java.lang.reflect.Method.invoke(Method.java:507)
11-17 07:57:46.341: E/AndroidRuntime(481):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-17 07:57:46.341: E/AndroidRuntime(481):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-17 07:57:46.341: E/AndroidRuntime(481):  at dalvik.system.NativeStart.main(Native Method)
11-17 07:57:46.341: E/AndroidRuntime(481): Caused by: java.lang.UnsupportedOperationException: addView(View, LayoutParams) is not supported in AdapterView
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.widget.AdapterView.addView(AdapterView.java:461)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:627)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
11-17 07:57:46.341: E/AndroidRuntime(481):  at com.actionbarsherlock.internal.ActionBarSherlockCompat.setContentView(ActionBarSherlockCompat.java:853)
11-17 07:57:46.341: E/AndroidRuntime(481):  at com.actionbarsherlock.app.SherlockActivity.setContentView(SherlockActivity.java:229)
11-17 07:57:46.341: E/AndroidRuntime(481):  at com.example.rss.ListRss.onCreate(ListRss.java:54)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-17 07:57:46.341: E/AndroidRuntime(481):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
11-17 07:57:46.341: E/AndroidRuntime(481):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:03:06.720

我想你忘了设置你的布局。所以，之后

```
 super.onCreate(savedInstanceState); 
```

添加这个

```
 setContentView(R.layout.nameOfXmlFileYouPostedWeDontKnowTheNameOf); 
```

其中 nameOfXmlFileYouPostedWeDontKnowTheNameOf 是 xml 文件的名称

# android - 使用 layout_marginBottom 的意外效果

> ID：13422623
> 
> 赞同：0
> 
> 时间：2012-11-16T18:51:17.860
> 
> 标签：android, layout

我希望当我设置边距底部时，这使得部分视图走出屏幕/不可见，整个布局转移到顶部，看起来“相同” - 意味着，不重新排列内部视图。

但是当我设置边距时，在这个简化的示例中，容器缩小或内部布局移动到底部。这里有图片来说明：

设置边距前：

![在此处输入图像描述](../Images/7933edaec8387260b49ccf1b6bc24fc9.png)

设置 200dip 保证金底部后：

![在此处输入图像描述](../Images/d07db3eb5928c7addc6867db288a0380.png)

这是 XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="400dip"
        android:background="#ff0000"
        android:gravity="center"
        android:layout_marginBottom="200dip"
        >

        <View 
            android:layout_width="fill_parent"
            android:layout_height="200dip"
            android:background="#00ff00"
            />

    </LinearLayout>

    <Button
        android:id="test"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_alignParentBottom="true"
        android:text="@string/hello_world"
        tools:context=".MainActivity" />

</RelativeLayout> 
```

我能做些什么来避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:06:34.823

为此，请尝试在要向上移动的视图顶部设置一个负的上边距。

```
<LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="400dip"
        android:background="#ff0000"
        android:gravity="center"
        android:layout_marginTop="-200dip"
        > 
```

# android - If Exists 查询在“IF”附近出错

> ID：13422626
> 
> 赞同：0
> 
> 时间：2012-11-16T18:51:27.487
> 
> 标签：android, sql

我通过以下查询在“IF”附近收到语法错误：

```
myDataBase.execSQL("IF EXISTS (SELECT * FROM ANSWERS WHERE QUESTION_ID=" + id +" AND PLAYER ='" + player + "')" +
                "UPDATE ANSWERS SET "+field+"=1"
                + " WHERE QUESTION_ID=" + id + " AND LEVEL =" + level +" AND PLAYER='" + player + "' ELSE "
                + "INSERT INTO ANSWERS (level, player, question_id, "+field+") VALUES (level, player, id, 1)"); 
```

不知道我哪里出错了..有人看到了吗？

```
 near "IF": syntax error: IF EXISTS (SELECT * FROM ANSWERS WHERE QUESTION_ID=6 AND PLAYER ='nob')UPDATE ANSWERS SET showhint1=1 WHERE QUESTION_ID=6 AND LEVEL =1 AND PLAYER='nob' ELSE INSERT INTO ANSWERS (level, player, question_id, showhint1) VALUES (level, player, id, 1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:56:24.933

[请参阅此问题](https://stackoverflow.com/questions/7746306/sqlite-if-exists-clause)的答案：

```
select exists(
    select * from answers ...
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:53:44.247

**编辑：** 我喜欢对原始答案的评论：sackoverflow.com/questions/418898/… – zapl 7 分钟前。我不知道你能做到这一点。看起来很高效....

我很快就做到了。希望你明白了......所以这些变量和东西将在非 sql 代码中。如果可以的话，我建议使用存储过程或类似的东西....或完全分离所有部分（查看它是否存在，基于执行此 sql，或者是否不执行此 sql）。

仅使用更新语句....如果表中不存在变量，则不会更新任何内容。并且仅使用插入语句...如果表中确实存在变量，则不会插入任何内容。除了这两个语句之外，不需要 if 或任何东西来实际检查答案中是否存在某些东西。

```
create table #answers (question_id int, player int, level int, other_field int) 

insert into #answers values (1,1,1,1) 
insert into #answers values (2,1,1,1)  

declare @question_id int
declare @player int
declare @level int
declare @other_field int

set @question_id=1
set @player=1 
set @level=1
set @other_field=1

-- if it exists already 
update a
    set     other_field=@other_field  
    from    #answers as a
    where   QUESTION_ID=@question_id and 
            PLAYER=@player and 
            other_field<>@other_field 

set @question_id=4
set @player=4
set @level=1
set @other_field=1

-- if it doesn't exist
insert into #answers (question_id, player, level, other_field)
        select  x.QUESTION_ID, x.player, @level, @other_field
        from    #answers a 
                right outer join 
                    (select @question_id as QUESTION_ID,
                            @player as player) as x 
                    on x.QUESTION_ID=a.QUESTION_ID and 
                        x.player=a.player
        where   a.player is null and a.question_id is null 
```

或者如果它不存在（更混乱但更短）

```
-- if it doesn't exist
insert into #answers (question_id, player, level, other_field)
        select  distinct  @QUESTION_ID, @player, @level, @other_field  
        from    #answers 
        where   not exists (select 1 from #answers where 
                                QUESTION_ID=@question_id and 
                                    PLAYER=@player ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:23:52.950

`If exists`不是在 SQL 更新语句中使用的有效关键字。

# undefined - gnuplot 直方图中整列为零的问题

> ID：13422629
> 
> 赞同：3
> 
> 时间：2012-11-16T18:51:36.880
> 
> 标签：undefined, gnuplot, histogram

我正在使用 gnuplot 创建一个堆叠的直方图。今天，第一次，其中一列中的所有数据点都为零。这给 gnuplot 带来了一个问题，因为它现在报告：

> 直方图中的所有点未定义

这是因为我的“使用”语句具有如下逻辑：

> 使用 ($6>0:$6:NaN)

当一整列包含被忽略的值时，gnuplot 会阻塞。有没有我可以用来让 gnuplot 忽略这个特殊且无害的问题的设置？有时列会为零，这是数据中的有效条件。我希望 gnuplot 能够处理这个问题。

如果我无法让 gnuplot 处理它，我可能不得不使用不同的命令来发布我的绘图以省略丢失的数据集。除非必须，否则我真的宁愿不进行此更改。

有人有什么建议吗？

编辑（添加绘图脚本和数据文件）：

plotscript 和数据文件在运行时生成，使用模板文件和脚本逻辑的组合来确定最终脚本。这通过打开 gnuplot 命令的命令管道并将脚本直接提供给 gnuplot 直接提供给 gnuplot。

今天出现此问题是因为图表中的第 6 列今天全为零。这是一件好事（没有图像处理时间超过 60 分钟）。我希望 gnuplot 简单地抑制零值（根据 plotscript 中的“绘图”行中的三元运算符），如果所有值都被抑制，那么直方图的该列没有数据。正常和预期；除了 gnuplot 不喜欢它。

剧情简介：

```
set terminal 'pngcairo'
set key center under horizontal font ",8"
set style data histogram
set style histogram rowstacked
set style fill  solid 1.0
set boxwidth 0.5 relative
set xtics border in scale 0.5,0.25 nomirror rotate by 45  font ",8" offset character -2, -1, 0 right
set xtics autofreq  norangelimit
set ytics border in scale 0.5,0.25 nomirror norotate  font ",8" offset character 0, 0, 0 autojustify
set ytics autofreq  norangelimit
set y2tics border in scale 0.5,0.25 nomirror norotate  font ",8" offset character 0, 0, 0 autojustify
set y2tics 1800  norangelimit
set my2tics 6
set title "Image Processing Trends"
set title  offset character 0, 0, 0 font ",18" norotate
set timestamp "" bottom offset character 0,-2,0
unset xlabel
set ylabel "Nbr of Images (bars)"
set ylabel  offset character 2, 0, 0 font ",8" textcolor lt -1 rotate by -270
set y2label "Avg Time in Seconds (line)"
set y2label  offset character 0, 0, 0 font ",8" textcolor lt -1 rotate by -270
set zero 1e-08
set label "Generated by Luna" font ",6" tc rgb "#808080" at graph 1,-0.25 right
plot 'datafile' using (sum [i=2:4] column(i)):xtic(1) title "< 15 min" lc rgb "#00FF50", '' using ($5>0?$5:NaN) title columnhead lc rgb "#F0F000", '' using ($6>0?$6:NaN) title columnhead lc rgb "#FF0000"

Datafile:
"Date" "< 5 min" "5 - 10 min" "10 - 15 min" "15 - 60 min" "> 60 min" "Avg ET"
  2012-10-26  1099    71    23     0     0   184
  2012-10-29    16     0     0     0     0    81
  2012-10-30     5     0     0     0     0    76
  2012-10-31   650    41    24    19     0   176
  2012-11-01   831   118    11     0     0   169
  2012-11-02   671   158   195    91     0   353
  2012-11-05   887   127    64    81     0   287
  2012-11-06  1343    35     8     0     0   139
  2012-11-07  1018   233   201   112     0   334
  2012-11-08  1140   433   143    16     0   271
  2012-11-09  1192   115    15     0     0   168
  2012-11-12  1008    90    17     1     0   173
  2012-11-13   911    62     5     0     0   160
  2012-11-14  1066   346   219    68     0   317
  2012-11-15   754   110     0     0     0   170 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:12:48.323

我发现由于某种原因，gnuplot 的处理方式不同，`NaN`并且`1/0`数学上未定义的表达式会被*默默地忽略*（例如，请参见[此处](http://www.gnuplot.info/docs_4.0/gnuplot.html)的注释）。`NaN`在您的逻辑中使用全零的第 6 列将产生错误

```
 "<scriptname>", line xx: All points in histogram UNDEFINED 
```

和一个空的png文件。真可惜。但是`1/0`在你的逻辑中只会产生一个警告

```
 "<scriptname>", line xx: warning: Skipping data file with no valid points 
```

它将生成带有其余数据的图。由于它完全跳过了数据集，因此“> 60 分钟”也不会出现在您可能想要的图例中。

因此，只需将 plot 命令中第 6 列（以及第 5 列，如果它充满零）的逻辑更改为

```
plot 'datafile' using (sum [i=2:4] column(i)):xtic(1) title "< 15 min" lc rgb "#00FF50", '' using ($5>0?$5:1/0) title columnhead lc rgb "#F0F000", '' using ($6>0?$6:1/0) title columnhead lc rgb "#FF0000" 
```

除了警告消息告诉您没有数据可以绘制超过 60 分钟（我们知道开始）之外，这应该可以工作。

我使用了 gnuplot v4.6 补丁级别 0。

# c++ - 结构、数组和空格

> ID：13422633
> 
> 赞同：-1
> 
> 时间：2012-11-16T18:52:02.063
> 
> 标签：c++, text, struct, stream, getline

我正在尝试完成我的 C++ 课程介绍的作业，但我陷入了僵局！该程序应该是一个 VHS 视频管理器，其中电影存储在结构中。电影是从源文件夹中的 .txt 文件中获取的，包含电影的标题和年份。读入文本文件后，初始输出应如下所示：

```
Initializing Video Collection:
What file should I use? movies.txt
A New Hope (1977)
Empire Strikes Back (1980)
Flight of the Navigator (1986)
Goonies (1985)
Last Crusade (1989)
Raiders of the Lost Ark (1981)
Return of the Jedi (1983)
Temple of Doom (1984)
War Games (1983) 
```

视频存储在如下结构中：

```
struct Video
{
    string title; //the name of the video
    int year; // the year the movie was released
    int stars; // a rating out of five stars - this will be zero until you set it
    bool watched; // starts as false until you watch the movie and flip it to true
}; 
```

似乎我不知道如何正确读取我的文件，以便将标题和年份放置在它们各自的数组位置中。这是我为此目的而拥有的功能：

```
void initialize(Video video_array[tapes_max], Video data)
{

    ifstream videofile;
    videofile.open("movies.txt");
    if(videofile.fail())
    {
        cout << "Could not open states file for reading!" << endl;
        exit(1);
    }
    for(int i = 0; i < tapes_max; i++)
    {
        getline(videofile, video_array[i].title);
    }

    videofile.close();
    for (int i = 0; i < tapes_max; i++)
    {
       cout << video_array[i].title << " " << video_array[i].year << endl;
    }

    cout << endl << endl;
} 
```

这是分配给我的PDF的链接，也许你们能比我更好地理解它？在此先感谢您的帮助！

[https://docs.google.com/open?id=0Bwr7dC-H4CCZUkkyUGNTRzRZdk0](https://docs.google.com/open?id=0Bwr7dC-H4CCZUkkyUGNTRzRZdk0)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T21:47:37.980

因此，您已将输入行读入字符串。现在，您需要将其分成两部分：标题和年份。这通常称为*解析*：从字符串中提取一些信息。

我假设您没有将正式语法（定义字符串格式的规则集）作为任务的一部分，但很容易做出很好的猜测：该行包含标题（可能带有空格），然后是一个空格，左括号，发行年份的十进制表示，后跟右括号。

你知道如何解析它吗？一个不错的选择是向后扫描字符串：

1.  如果最后一个字符不是右括号，则抱怨格式错误；否则，砍掉它，你已经完成了括号的解析。
2.  找到左括号；如果没有人，请投诉。您必须从末尾开始搜索：标题本身可能包含括号，因此我们感兴趣的左括号必须是最后一个。将文本存储在括号之间（注意索引！）：它将是您的`year`.
3.  将年份解析为数字（`atoi`或类似的，请参阅[此答案](https://stackoverflow.com/questions/194465/how-to-parse-a-string-to-an-int-in-c)或谷歌了解更多详细信息）；如果解析失败，程序必须报错输入格式
4.  砍掉前面的空格，如果找不到空格，请抱怨
5.  字符串的其余部分必须是视频标题；至少检查它不是空的。

足够解析了，现在您的`Video`对象有了标题和发布年份。其他两个字段现在具有默认值；但是您的程序必须能够更改它们并可能将它们*序列化*（将信息保存到文件中的一个花哨的词），以便下次用户启动您的程序时，这些字段的状态会被保留。

这意味着也许您应该为磁盘上的数据发明一种格式，其中包含所有四个字段（当前`.txt`仅包含其中两个）。当然，您还需要该格式的*解析器*。在您的情况下，我个人会使用非常简单的格式：例如，每行只有一个字段。

欢迎来到软件开发的世界！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T20:06:40.063

我认为你应该使用 boost::regex。
这是有关如何使用正则表达式处理行的演示：

```
#include <boost/regex.hpp>
#include <iostream>
#include <string>
#include <cstring>

int main()
{
  using namespace std;

  string line = "Hey Joe(1984) "; // an example line that you can read
  boost::smatch what;
  boost::regex e("(.*)\\(([0-9]+)\\).*"); // whatever comes before numbers in parentheses, is the title.

  if(boost::regex_match(line, what, e, boost::match_extra))
  {
    string title = what[1];
    int year = atoi(static_cast<string>(what[2]).c_str()); // perhaps there is a better code for this but it will do.
    cout<<"title: "<<title<<"\tyear: "<<year<<endl;
  }
  else
  {
    cout<<"No match"<<endl; // indicates a wrong line
  }
  return 0;
} 
```

只需将其放入循环中即可。

如果你不知道如何使用 boost：

安装[boost](http://www.boost.org/) ——（在 Mac 上，我用 Macports 安装了 boost）

为我编译行：

```
g++ -I/opt/local/include -L/opt/local/lib -lboost_regex-mt boost_regex.cpp
# for testing
./a.out 
```

对你来说，它可能在 Windows 上是类似的。( `g++ -IC:\path\to\boost\includes -LC:\path\to\boost\libs -lboost_regex-something`)。在 Windows 上，我认为您应该查找一个名为“boost_regex.dll”之类的 dll 文件。您可以在 boost 安装的 lib 目录中找到该 dll。

更多信息：[正则表达式文档](http://www.boost.org/doc/libs/1_39_0/libs/regex/doc/html/boost_regex/captures.html)

# eclipse - 如何在团队提供者插件中添加要求提交的评论？

> ID：13422636
> 
> 赞同：0
> 
> 时间：2012-11-16T18:52:16.913
> 
> 标签：eclipse, svn

我通过团队提供者进行了提交，它不要求任何提交评论……但过去确实如此。它在哪里配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:58:15.137

解决。我很抱歉。首选项->团队->CVS->提示

# java - Swing：从对话按钮中删除焦点边框

> ID：13422642
> 
> 赞同：3
> 
> 时间：2012-11-16T18:52:32.407
> 
> 标签：java, swing, border, jbutton, uimanager

我想知道如何从对话框中的按钮中删除这个灰色边框？![在此处输入图像描述](../Images/2b79ac69bfe6b17cc758ec53ec35e493.png)

对于简单的 JButtons，我找到了一个解决方案 - 只需使用`button.setFocusPainted(false);` 但是有没有一种简单的方法可以对所有对话中的所有按钮执行相同的操作？我试图查看 UIManager 属性，但那里似乎没有合适的参数。 ![在此处输入图像描述](../Images/85d12dbb83ae528179f5b2990562362e.png)

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T19:09:26.947

*   从`JButtons API`你可以使用`JButton.setFocusable()`和搭配`JButton.setBorderPainted(false);`

*   from`UIManager`必须覆盖键（对整个 JVM 实例有效）

.

```
UIDefaults defaults = UIManager.getLookAndFeelDefaults();
defaults.put("Button.focus", new ColorUIResource(new Color(0, 0, 0, 0))); 
```

*   我建议将`Color`( `transparency`4th paramater in am code) 更改为另一个更体面的`Color`，否则你看不到任何 `JButtons 的焦点

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-20T18:13:00.140

关于什么

```
JButton.setFocusPainted(false) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-02T06:27:59.200

这是一个全局修复，因此您不必为每个控件手动执行此操作。从我的另一篇文章：[禁用 JButton 焦点边框](https://stackoverflow.com/questions/9361658/disable-jbutton-focus-border/35146492#35146492)

```
 // Removes the dotted border around controls which is not consistent with Windows
        UIManager.put("Button.focus", new ColorUIResource(new Color(0, 0, 0, 0)));
        UIManager.put("ToggleButton.focus", new ColorUIResource(new Color(0, 0, 0, 0)));

        // ways to remove it from other controls...
        UIManager.put("CheckBox.focus", new ColorUIResource(new Color(0, 0, 0, 0)));
        UIManager.put("TabbedPane.focus", new ColorUIResource(new Color(0, 0, 0, 0)));
        UIManager.put("RadioButton.focus", new ColorUIResource(new Color(0, 0, 0, 0)));
        UIManager.put("Slider.focus", new ColorUIResource(new Color(0, 0, 0, 0)));

        // figure out combobox
        UIManager.put("ComboBox.focus", new ColorUIResource(new Color(0, 0, 0, 0))); 
```

# python - Emacs 24.x 上的 IPython 支持

> ID：13422653
> 
> 赞同：7
> 
> 时间：2012-11-16T18:53:25.490
> 
> 标签：python, emacs, ipython

我对 IPython 与 Emacs 的集成感到困惑。从 Emacs 24 开始，Emacs 附带了它自己的`python.el`. 该文件是否支持 IPython 或仅支持 Python？

此外，[Emacswiki](http://emacswiki.org/emacs/PythonProgrammingInEmacs)讨论了一个名为的文件`IPython.el`（尽管它提供的链接：http: [//ipython.scipy.org/dist/ipython.el](http://ipython.scipy.org/dist/ipython.el)返回 404 错误）。该文件与 Emacs 24' 兼容`python.el`还是仅适用于`python-model.el`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-28T10:26:09.447

新的`python.el`（随 Emacs 版本 24.3 提供）确实支持 IPython。您需要将以下行添加到`init.el`文件中（从 复制的说明`python.el`）：

```
(require 'python)
(setq
  python-shell-interpreter "ipython"
  python-shell-interpreter-args "--pylab"
  python-shell-prompt-regexp "In \\[[0-9]+\\]: "
  python-shell-prompt-output-regexp "Out\\[[0-9]+\\]: "
  python-shell-completion-setup-code
    "from IPython.core.completerlib import module_completion"
  python-shell-completion-module-string-code
    "';'.join(module_completion('''%s'''))\n"
  python-shell-completion-string-code
    "';'.join(get_ipython().Completer.all_completions('''%s'''))\n") 
```

这适用于 Linux（我正在运行 Ubuntu 12.04），在 Windows 上可能需要进行一些额外的修改（有关详细信息，请查看`init.el`源代码）。

但是，您不应该**使用**（`ipython.el`它与 IPython 包一起分发），因为它显式依赖于`python-mode.el`（至少安装在我的系统上的 IPython 0.12.1 就是这种情况）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:21:32.353

不确定股票 python.el，因为我正在运行 python-mode.el，其中有 ipython 支持。但是我只是看了看随我的 Emacs 24 一起安装的 python.el 源代码，它里面有一些对 ipython 的引用，所以它似乎确实支持 ipython。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T08:29:37.580

Emacs 早在 emacs 22 就附带了 python.el。我正在使用并依赖它来构建我需要的其余 python 编辑功能。

不幸的是，有人写了一个新的 python.el 并且维护者（他们都没有大量使用 python 模式）可以在即将到来的 24.3 中替换现有的和工作的 python.el。他们打算以向后兼容的方式来做这件事，可悲的是，它落在了相反的一边。

`python.el`从 24.3 之前开始支持运行 ipython。

# c# - C# Httpwebrequest 用户代理

> ID：13422656
> 
> 赞同：0
> 
> 时间：2012-11-16T18:53:31.797
> 
> 标签：c#

我写了一个脚本来获取谷歌搜索的热门网址。这个脚本的一个最大问题是，它会根据我的 IP 返回搜索结果。也就是说，我在芝加哥，它是从芝加哥而不是美国返回结果。我认为这可能与用户代理有关：

```
 HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);

   request.Accept = "application/x-ms-application, image/jpeg, application/xaml+xml,         image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*";

   request.Headers["Accept-Language"] = "en-US";
   request.UserAgent = "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)";

   request.KeepAlive = true;
   request.AllowAutoRedirect = true;
   request.Timeout = 60000;

   request.Method = "GET"; 
```

有人知道我为什么要搜索本地吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:42:04.033

正如[http://support.google.com/websearch/bin/answer.py?hl=en&answer=179386](http://support.google.com/websearch/bin/answer.py?hl=en&answer=179386)所述，您可以通过直接在搜索查询中指定一个来覆盖自动位置检测。

> 如果您想查看您的 Google 域之外的区域的结果，请在搜索查询中指定位置，例如 [bike repair paris] 或访问其他 Google 本地域。

# javascript - 从 javascript 加载 codeigniter 控制器和方法

> ID：13422657
> 
> 赞同：0
> 
> 时间：2012-11-16T18:53:34.940
> 
> 标签：javascript, jquery, ajax, codeigniter

我将 jquery ajax 与 $.confirm 结合使用，我需要弄清楚如何加载 codeigniter 控制器/方法以响应 $.confirm。这是代码：

```
$.ajax({
    url: sURL + "utility/ajaxFind_In_tblClients",
    type: "POST",
    data: {ClientNum: ClientNum},
    dataType: 'json',
    success: function(json) {   
    $.confirm("The email address registered to this account is:\n\n"      
        +json.ClientEmail+
        "\n\nSend password recovery information to this email address?"+
        "\n\nIf you need assistance, please call 888-526-9999.",
        //YES
        function(){ 

        //need to load a codeigniter controller here        

            $.msg("Password recovery information has been sent.\nPlease check your inbox",
            {header:'Password Sent', live:10000});
            $('#ajaxShield').hide();
        },                      
        //NO 
        function(){
            $.msg("Password recovery information has NOT been sent.",
            {header:'Password Not Sent', live:10000});
            $('#ajaxShield').hide();
        } 
    ) //end of confirm
  }, //end of success: function(json), could be YES or NO inside
    error:function (xhr, ajaxOptions, thrownError){ alert('Problem with utility/ajaxFind_In_tblClients  Status code:'+xhr.status+', Error:'+thrownError);} 
}); 
```

看起来我在第 14 行需要帮助。在用户对 $.confirm 响应“是”后，我不知道如何加载 codeigniter 控制器。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:13:48.673

创建一个函数：

```
function send_email(email){
    $.ajax({
        type:'post',
        url: '/email_controller/send_email',
        data: 'email='+email,
        error: function(){},
        success: function(){}
    }
} 
```

并在您的 YES 函数中调用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T04:16:07.387

```
$.ajax{
    url: "<?php echo base_url()?>controller_name/function_name",
    type: "POST",
    data: "client="+client,
    dataType: "json",
    success: function(){
         //do everything you want for success. it depends on your controller.
    }
} 
```

# jquery - 将 jquery 代码重构为一行代码

> ID：13422664
> 
> 赞同：0
> 
> 时间：2012-11-16T18:53:57.327
> 
> 标签：jquery

我有这个 jquery 代码：

```
$('#csv_button').attr('disabled', 'disabled').addClass("disabled");
$('#excel_button').attr('disabled', 'disabled').addClass("disabled");
$('#delete_button').attr('disabled', 'disabled').addClass("disabled"); 
```

是否可以将此代码简化为一行代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T18:54:45.500

您可以使用逗号分隔多个选择器：

```
$('#csv_button,#excel_button,#delete_button').prop('disabled', true).addClass("disabled"); 
```

或者您可以将相同的类应用于所有 3 个元素并使用类选择器：

```
$('.disabled-button').prop('disabled', true).addClass("disabled"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:55:20.123

```
$('#csv_button,#excel_button,#delete_button').attr('disabled','disabled').addClass("disabled"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:14:46.800

或者你可以这样做：

```
 $("[id$='button']").prop('disabled', true).addClass("disabled"); 
```

这将返回 id 以 'button' 结尾的所有元素。

更多关于 jquery 选择器的信息可以在[这里](http://api.jquery.com/attribute-ends-with-selector/)找到。

# silverlight - Silverlight ScrollViewer，查找是否启用垂直滚动

> ID：13422665
> 
> 赞同：2
> 
> 时间：2012-11-16T18:54:02.157
> 
> 标签：silverlight, scrollviewer

我有一个滚动查看器

```
<ScrollViewer x:Name="sViewer" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto"/> 
```

现在加载后，我怎样才能找到滚动查看器是否可以垂直滚动。即垂直滚动条是可见的还是折叠的。

我试图阅读 Visibility 属性，

```
ScrollBar verticalScrollBar = ((FrameworkElement)VisualTreeHelper.GetChild(sViewer, 0)).FindName("VerticalScrollBar") as ScrollBar; 
```

但是每次我将可见性显示为折叠时，即使滚动可用。

将感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:22:06.113

使用 ScrollBar.ScrollableHeight 和 ScrollBar.ScrollableWidth。值 > 0 表示有滚动条。

您还可以使用 ScrollViewer.ComputedVerticalScrollBarVisibility 和 ScrollViewer.ComputedHorizo​​ntalScrollBarVisibility。

# c# - WPF 无边框窗口问题：Aero Snap 和最大化

> ID：13422666
> 
> 赞同：12
> 
> 时间：2012-11-16T18:54:03.053
> 
> 标签：c#, wpf, aero, wndproc

通过在 XAML 中设置以下窗口属性，我创建了一个无边框 WPF 窗口：

```
... WindowStyle="None" AllowsTransparency="True" ... 
```

**这会导致许多问题：**

**1) 已解决：**它不再具有任何内置的调整大小功能

**2）已解决：**它不再具有任何内置的拖动功能

**3）解决：**没有顶部工具栏，它不再有最小化/最大化/恢复/关闭按钮

**4) 已解决：**通过 aero snap 最大化或设置 WindowState 可防止其取消捕捉。

**5)**通过aero snap 最大化或设置WindowState 将使用整个屏幕作为边界，与windows 工具栏重叠。

**6)**通过 aero snap 最大化或设置 WindowState 似乎包括 -7 边距，使窗口在超出窗口边缘的每侧有 7 个像素。

通过制作 xaml 窗口模板解决了 1-3 问题。我使用不可见的矩形作为句柄区域，并通过覆盖 OnApplyTemplate() 应用其背后的一些代码，以通过 user32.dll SendMessage(...) 附加功能以调整大小/移动/最小化/最大化/恢复/关闭。

[我在这里](https://stackoverflow.com/questions/11703833/dragmove-and-maximize)找到了#4的答案

我尝试通过 WndProc 拦截最大化消息并手动设置大小/位置来解决 5-6，但这存在将 RestoreRegion 覆盖为最大化大小/位置的问题，从而消除了恢复窗口的能力。

真正奇怪的是，将窗口大小从顶部边框调整到屏幕顶部可以很好地触发航空全高捕捉，完全没有问题。

所以，我已经走了很长一段路，但 5-6 仍然是一个问题......有没有办法手动指定最大化区域？或者，有没有办法在不影响 restoreregion 属性的情况下设置窗口大小？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2017-03-15T10:19:57.320

> 最简单的完整解决方案

您好，以下解决方案以最简单的方式解决了您问题中详述的所有问题，并且可以在使用 WPF 和最新版本的 C# 语言和 .NET 框架的 Windows 10 上运行。这是截至 2017 年 3 月 15 日。如果它停止工作，请告诉我。

**第 1 步：**要解决问题 1、2 和 4，请`<Window ... > </Window>`在应用程序 XAML 的标记中，将其粘贴到顶部或底部：

```
<WindowChrome.WindowChrome>
    <WindowChrome CaptionHeight="35"/>
<WindowChrome.WindowChrome> 
```

`CaptionHeight`是您的窗口拖动区域的所需高度。

**第 2 步：**要解决问题 3，您需要创建标题栏和标题以及窗口控件。为此，您只需为每个所需的标题栏元素提供一个顶部的 VerticalAlignment，或者将它们放入一个将 VerticalAlignment 设置为顶部的网格中，这将为所有这些元素执行此操作，但请确保它们的高度不是大于第 1 步中在 XAML 中声明`CaptionHeight`的元素的属性`WindowChrome`。对于所有按钮，您必须为它们或它们的容器分配属性`WindowChrome.IsHitTestVisibleInChrome="True"`。这是一个例子：

```
<Grid VerticalAlignment="Top" Background="White" Name="TitleBar" Height="35">
    <Label Content="Borderless Window Test" VerticalAlignment="Center" HorizontalAlignment="Left"/>
    <StackPanel WindowChrome.IsHitTestVisibleInChrome="True" VerticalAlignment="Center" HorizontalAlignment="Right" Orientation="Horizontal" Name="WindowControls">
        <Button Height="35" Width="35" Content="-" Padding="0" Name="MinimizeButton"/>
        <Button Height="35" Width="35" Content="+" Padding="0" Name="MaximizeButton"/>
        <Button Height="35" Width="35" Content="x" Padding="0" Name="CloseButton"/>
    </StackPanel>
</Grid> 
```

现在，要向窗口控制按钮添加适当的功能，请在`MainWindow()`代码隐藏的构造函数中，即应用程序的 C# 源代码中，**在**调用后将以下内容粘贴到`InitializeComponent();`：

```
CloseButton.Click += (s, e) => Close();
MaximizeButton.Click += (s, e) => WindowState = WindowState == WindowState.Normal ? WindowState.Maximized : WindowState.Normal;
MinimizeButton.Click += (s, e) => WindowState = WindowState.Minimized; 
```

**第 3 步：**要解决问题 5 和 6，您需要连接到 WmGetMinMaxInfo。为此，请转到您的代码隐藏，然后将此[Pastebin](http://pastebin.com/WDZpDKRN)中的所有内容复制并粘贴到您的 Window 类中。现在，在您的`MainWindow()`构造函数中，粘贴：

```
SourceInitialized += (s, e) =>
{
    IntPtr handle = (new WindowInteropHelper(this)).Handle;
    HwndSource.FromHwnd(handle).AddHook(new HwndSourceHook(WindowProc));
}; 
```

通过`Project > Add References`在文件菜单中，请务必参考：

```
System.Management
System.Windows.Interop
System.Security.Principal
System.Runtime.InteropServices
Microsoft.Win32 
```

最好的检查方法是单击`Assemblies`左上角的选项卡，然后选择`Framework`，然后使用窗口右上角的搜索框。现在将所有这些使用（命名空间）添加到代码隐藏的顶部：

```
using System.Management;
using System.Windows.Interop;
using System.Security.Principal;
using System.Runtime.InteropServices;
using Microsoft.Win32; 
```

那应该涵盖所有内容。我希望这有帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-02-05T15:33:26.540

我自己刚刚经历了这整个事情。这是一件真正的苦差事，因为您必须手动考虑这么多。有趣的是，这些天我们把很多事情都视为理所当然，就像基本窗口的操作一样简单。但是看看我提供的这个示例代码可以很好地表明这个问题到底有多少。

我希望这会有所帮助，因为我自己花了一点时间才到这里。

**主窗口.Xaml**

```
<Window x:Class="WpfApp1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:WpfApp1"
    Background="Transparent"
    WindowStartupLocation="CenterScreen"
    ResizeMode="CanResizeWithGrip"
    AllowsTransparency="True"
    WindowStyle="None"
    mc:Ignorable="d"
    Title="Test Window Behavior" Height="768" Width="1024" StateChanged="Window_StateChanged" PreviewMouseLeftButtonDown="Window_PreviewMouseLeftButtonDown">

<Grid>
    <DockPanel Grid.Column="1" Grid.Row="1">
        <DockPanel x:Name="titleBar" Background="White" DockPanel.Dock="Top">
            <Rectangle Width="32" Height="32" DockPanel.Dock="Left" Fill="Red" Margin="2"/>
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" Margin="2">

                <!-- Minimize Button -->
                <Border Width="24" Height="24" Margin="2" HorizontalAlignment="Right" MouseLeftButtonUp="OnMinimizeWindow" Grid.Column="2">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Setter Property="Background" Value="Transparent" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#FFD0D0D0" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center" Text="0" FontFamily="Webdings" />
                </Border>

                <!-- Maximize Button -->
                <Border Width="24" Height="24" Margin="2" HorizontalAlignment="Right" MouseLeftButtonUp="OnMaximizeWindow" Grid.Column="3">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Setter Property="Background" Value="Transparent" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#FFD0D0D0" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock x:Name="IsMaximized" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center" FontFamily="Webdings">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Text" Value="1" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=InternalWindowState, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}" Value="Maximized">
                                        <Setter Property="Text" Value="2" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Border>

                <!-- Close Button -->
                <Border Width="24" Height="24" Margin="2" HorizontalAlignment="Right" MouseLeftButtonUp="OnCloseWindow" Grid.Column="4">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Setter Property="Background" Value="Transparent" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="Red" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center" Text="r" FontFamily="Webdings" />
                </Border>
            </StackPanel>

            <Label MouseLeftButtonDown="OnDragMoveWindow" MouseDoubleClick="OnMaximizeWindow" Margin="8 0 0 0" FontSize="12" VerticalContentAlignment="Center" Content="{Binding Path=Title, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, FallbackValue='Main Window'}" />
        </DockPanel>

        <Grid Background="White" DockPanel.Dock="Bottom" Height="32">
            <Label VerticalContentAlignment="Center" Content="Statusbar Text Goes Here ..." />
        </Grid>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="100" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="100" />
                <RowDefinition Height="*" />
                <RowDefinition Height="100" />
            </Grid.RowDefinitions>

            <!-- Top 3 -->
            <Border Background="Gray" Grid.Row="0" Grid.Column="0" />
            <Border Background="Gray" Grid.Row="0" Grid.Column="1" BorderBrush="Black" BorderThickness="0 0 0 1" />
            <Border Background="Gray" Grid.Row="0" Grid.Column="2" />

            <!-- Middle 2 -->
            <Border Background="Gray" Grid.Row="1" Grid.Column="0" BorderBrush="Black" BorderThickness="0 0 1 0" />
            <Border Background="Gray" Grid.Row="1" Grid.Column="2" BorderBrush="Black" BorderThickness="1 0 0 0" />

            <!-- Bottom 3 -->
            <Border Background="Gray" Grid.Row="2" Grid.Column="0" />
            <Border Background="Gray" Grid.Row="2" Grid.Column="1" BorderBrush="Black" BorderThickness="0 1 0 0" />
            <Border Background="Gray" Grid.Row="2" Grid.Column="2" />
        </Grid>
    </DockPanel>
    <Grid>
        <Grid.Resources>
            <Style TargetType="Thumb">
                <Style.Setters>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <Border Background="Transparent" />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style.Setters>
            </Style>
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="25" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="25" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="25" />
            <RowDefinition Height="*" />
            <RowDefinition Height="25" />
        </Grid.RowDefinitions>

        <!-- Top/Left -->
        <DockPanel LastChildFill="False" Grid.Row="0" Grid.Column="0">
            <Thumb DockPanel.Dock="Left" Width="4" Cursor="SizeNWSE" Tag="0" DragDelta="Thumb_DragDelta" />
            <Thumb DockPanel.Dock="Top" Height="4" Cursor="SizeNWSE" Tag="0" DragDelta="Thumb_DragDelta" />
        </DockPanel>

        <!-- Top/Right -->
        <DockPanel LastChildFill="False" Grid.Row="0" Grid.Column="2">
            <Thumb DockPanel.Dock="Right" Width="4" Cursor="SizeNESW" Tag="0" DragDelta="Thumb_DragDelta" />
            <Thumb DockPanel.Dock="Top" Height="4" Cursor="SizeNESW" Tag="0" DragDelta="Thumb_DragDelta" />
        </DockPanel>

        <!-- Bottom/Left -->
        <DockPanel LastChildFill="False" Grid.Row="2" Grid.Column="0">
            <Thumb DockPanel.Dock="Left" Width="4" Cursor="SizeNESW" Tag="1" DragDelta="Thumb_DragDelta" />
            <Thumb DockPanel.Dock="Bottom" Height="4" Cursor="SizeNESW" Tag="1" DragDelta="Thumb_DragDelta" />
        </DockPanel>

        <!-- Bottom/Right -->
        <DockPanel LastChildFill="False" Grid.Row="2" Grid.Column="2">
            <Thumb DockPanel.Dock="Right" Width="4" Cursor="SizeNWSE" Tag="1" DragDelta="Thumb_DragDelta" />
            <Thumb DockPanel.Dock="Bottom" Height="4" Cursor="SizeNWSE" Tag="1" DragDelta="Thumb_DragDelta" />
        </DockPanel>

        <!-- Left -->
        <Thumb Grid.Row="1" Grid.Column="0" Width="4" Cursor="SizeWE" Tag="0" HorizontalAlignment="Left" DragDelta="Thumb_DragDelta" />

        <!-- Top -->
        <Thumb Grid.Row="0" Grid.Column="1" Height="4" Cursor="SizeNS" Tag="0" VerticalAlignment="Top" DragDelta="Thumb_DragDelta" />

        <!-- Right -->
        <Thumb Grid.Row="1" Grid.Column="2" Width="4" Cursor="SizeWE" Tag="1" HorizontalAlignment="Right" DragDelta="Thumb_DragDelta" />

        <!-- Bottom -->
        <Thumb Grid.Row="2" Grid.Column="1" Height="4" Cursor="SizeNS" Tag="1" VerticalAlignment="Bottom" DragDelta="Thumb_DragDelta" />
    </Grid>
</Grid> 
```

**主窗口.xaml.cs**

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApp1
{
    public partial class MainWindow : Window
    {
        #region --- Declarations ---
        private Rect _location { get; set; }
        #endregion

        #region --- Constructors ---
        public MainWindow()
        {
            InitializeComponent();
        }
        #endregion

        #region --- Properties ---
        private Rect DesktopArea
        {
            get
            {
                var c = System.Windows.Forms.Cursor.Position;
                var s = System.Windows.Forms.Screen.FromPoint(c);
                var a = s.WorkingArea;
                return new Rect(a.Left, a.Top, a.Width, a.Height);
            }
        }
        #endregion

        #region --- Dependency Properties ---
        public static readonly DependencyProperty InternalWindowStateProperty = DependencyProperty.Register("InternalWindowState", typeof(WindowState), typeof(MainWindow), new PropertyMetadata(WindowState.Normal, new PropertyChangedCallback(OnInternalWindowStateChanged)));

        public WindowState InternalWindowState
        {
            get { return (WindowState)GetValue(InternalWindowStateProperty); }
            set { SetValue(InternalWindowStateProperty, value); }
        }

        private static void OnInternalWindowStateChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            MainWindow instance = (MainWindow)d;
            instance.SetInternalWindowState((WindowState)e.NewValue);
        }
        #endregion

        #region --- Private Methods ---
        private void StoreLocation()
        {
            _location = new Rect(this.Left, this.Top, this.Width, this.Height);
        }

        private void RestoreLocation()
        {
            this.Width = _location.Width;
            this.Height = _location.Height;
            this.Top = _location.Top >= 0 ? _location.Top : 0;
            this.Left = _location.Left;
        }

        private void SetMaximizedState()
        {
            this.Width = DesktopArea.Width;
            this.Height = DesktopArea.Height;
            this.Top = DesktopArea.Top;
            this.Left = DesktopArea.Left;
        }

        private void SetInternalWindowState(WindowState state)
        {
            InternalWindowState = state;

            switch (InternalWindowState)
            {
                case WindowState.Normal:
                    this.WindowState = WindowState.Normal;
                    RestoreLocation();
                    break;
                case WindowState.Maximized:
                    this.WindowState = WindowState.Normal;
                    SetMaximizedState();
                    break;
                case WindowState.Minimized:
                    this.WindowState = WindowState.Minimized;
                    break;
            }
        }
        #endregion

        #region --- Sizing Routines --- 
        private void Thumb_DragDelta(object sender, System.Windows.Controls.Primitives.DragDeltaEventArgs e)
        {
            Thumb thumb = (Thumb)sender;
            int tag = Convert.ToInt32(thumb.Tag);
            if (thumb.Cursor == Cursors.SizeWE) HandleSizeWE(tag, e);
            if (thumb.Cursor == Cursors.SizeNS) HandleSizeNS(tag, e);
            if (thumb.Cursor == Cursors.SizeNESW) HandleSizeNESW(tag, e);
            if (thumb.Cursor == Cursors.SizeNWSE) HandleSizeNWSE(tag, e);
        }

        private void HandleSizeNWSE(int tag, DragDeltaEventArgs e)
        {
            if (tag == 0)
            {
                this.Top += e.VerticalChange;
                this.Height -= e.VerticalChange;
                this.Left += e.HorizontalChange;
                this.Width -= e.HorizontalChange;
            }
            else
            {
                this.Width += e.HorizontalChange;
                this.Height += e.VerticalChange;
            }
        }

        private void HandleSizeNESW(int tag, DragDeltaEventArgs e)
        {
            if (tag == 0)
            {
                this.Top += e.VerticalChange;
                this.Height -= e.VerticalChange;
                this.Width += e.HorizontalChange;
            }
            else
            {
                this.Left += e.HorizontalChange;
                this.Width -= e.HorizontalChange;
                this.Height += e.VerticalChange;
            }
        }

        private void HandleSizeNS(int tag, DragDeltaEventArgs e)
        {
            if (tag == 0)
            {
                this.Top += e.VerticalChange;
                this.Height -= e.VerticalChange;
            }
            else
                this.Height += e.VerticalChange;
        }

        private void HandleSizeWE(int tag, DragDeltaEventArgs e)
        {
            if (tag == 0)
            {
                this.Left += e.HorizontalChange;
                this.Width -= e.HorizontalChange;
            }
            else
                this.Width += e.HorizontalChange;
        }
        #endregion

        #region --- Event Handlers ---
        private void OnDragMoveWindow(Object sender, MouseButtonEventArgs e)
        {
            if (this.InternalWindowState == WindowState.Maximized)
            {
                var c = System.Windows.Forms.Cursor.Position;
                this.InternalWindowState = WindowState.Normal;
                this.Height = _location.Height;
                this.Width = _location.Width;
                this.Top = c.Y - (titleBar.ActualHeight / 2);
                this.Left = c.X - (_location.Width / 2);
            }
            this.DragMove();
        }

        private void OnMaximizeWindow(Object sender, MouseButtonEventArgs e)
        {
            if (this.InternalWindowState == WindowState.Maximized)
                this.InternalWindowState = WindowState.Normal;
            else
                this.InternalWindowState = WindowState.Maximized;
        }

        private void OnMinimizeWindow(Object sender, MouseButtonEventArgs e)
        {
            this.InternalWindowState = WindowState.Minimized;
        }

        private void OnCloseWindow(Object sender, MouseButtonEventArgs e)
        {
            Application.Current.Shutdown();
        }

        private void Window_StateChanged(object sender, EventArgs e)
        {
            if (this.WindowState == WindowState.Maximized)
            {
                this.InternalWindowState = WindowState.Maximized;
            }
        }

        private void Window_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            if (this.InternalWindowState != WindowState.Maximized)
                StoreLocation();
        }
        #endregion
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-25T19:34:09.227

对于第 5 点，请使用：

```
public WindowName() // Constructor for your window
{
this.MaxHeight = SystemParameters.WorkArea.Height;
this.MaxWidth = SystemParameters.WorkArea.Width;
} 
```

这将确保窗口在最大化时不会与任务栏重叠。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-08T02:45:07.517

`WM_GETMINMAXINFO`您可以通过处理Win32 消息来指定最大化区域。[这里](http://blogs.msdn.com/b/llobo/archive/2006/08/01/maximizing-window-_2800_with-windowstyle_3d00_none_2900_-considering-taskbar.aspx)的代码显示了如何做到这一点。它将解决问题#5 和#6。

请注意，我会做一些不同的事情，例如`IntPtr.Zero`在 WindowProc 中返回而不是 (System.IntPtr)0 并制作`MONITOR_DEFAULTTONEAREST`一个常量。但这只是编码风格的改变，并不影响最终结果。

还要确保注意在事件`WindowProc`期间挂钩的更新`SourceInitialized`而不是`OnApplyTemplate`. 那是最好的地方。如果您正在实现从 Window 派生的类，那么另一个选项是覆盖`OnSourceInitialized`以挂钩`WindowProc`而不是附加到事件。这就是我通常所做的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-16T19:08:29.777

对于所有这些问题，我只能推荐这个：

MahApps.Metro：[http ://mahapps.com/MahApps.Metro/](http://mahapps.com/MahApps.Metro/)

源代码：[https ://github.com/MahApps/MahApps.Metro](https://github.com/MahApps/MahApps.Metro)

这是一个很好的图书馆，主题很好，易于使用！

希望有帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-14T13:23:56.373

我知道这是一个迟到的回应，但几年前我正在处理这些确切的问题，尤其是#6。

对于 #6，如果您将 ResizeState 设置为 CanResize 或 CanResizeWithGrip、CanMinimize 和 NoResize 全屏且没有过扫描，则会出现问题。我所做的是我创建了自己的标题栏，具有最小化、最大化、关闭和 DragMove（具有取消捕捉支持）功能，并且我创建了一个拇指作为调整大小的手柄以允许调整大小。

这仍然有一些缺点，例如只能从右下角调整大小并且必须处理#5。我还没有找到一个优雅的解决方案。

# mediawiki - MediaWiki 内部错误：带有消息的异常“BadTitleError”

> ID：13422669
> 
> 赞同：0
> 
> 时间：2012-11-16T18:54:22.507
> 
> 标签：mediawiki

我在使用媒体 wiki 时遇到问题，我升级了 mediawiki，但这里的问题仍然是错误消息，我收到 MediaWiki 内部错误。

原始异常：异常 'BadTitleError' 带有消息“请求的页面标题无效、为空或链接错误的跨语言或跨 wiki 标题。它可能包含一个或多个不能在标题中使用的字符。在 /home/website/public_html/wiki/includes/Wiki.php:197 堆栈跟踪：

```
#0 /home/website/public_html/wiki/includes/Wiki.php(536): MediaWiki->performRequest()
#1 /home/website/public_html/wiki/includes/Wiki.php(446): MediaWiki->main()
#2 /home/website/public_html/wiki/index.php(59): MediaWiki->run()
#3 {main} 
```

异常处理程序中捕获的异常：在 /home/website/public_html/wiki/includes/parser/Parser.php 中带有消息“PCRE 需要使用 --enable-unicode-properties 编译才能使 MediaWiki 运行”的异常 'MWException' ：1528 堆栈跟踪：

```
#0 /home/website/public_html/wiki/includes/parser/Parser.php(1160): Parser->replaceExternalLinks('')
#1 /home/website/public_html/wiki/includes/parser/Parser.php(370): Parser->internalParse('The requested p...')
#2 /home/website/public_html/wiki/includes/cache/MessageCache.php(873): Parser->parse('The requested p...', Object(Title), Object(ParserOptions), true)
#3 /home/website/public_html/wiki/includes/Message.php(605): MessageCache->parse('The requested p...', Object(Title), true, true, Object(Language))
#4 /home/website/public_html/wiki/includes/Message.php(434): Message->parseText('The requested p...')
#5 /home/website/public_html/wiki/includes/Message.php(496): Message->toString()
#6 /home/website/public_html/wiki/includes/OutputPage.php(3528): Message->parseAsBlock()
#7 /home/website/public_html/wiki/includes/OutputPage.php(2062): OutputPage->addWikiMsgArray('badtitletext', NULL)
#8 /home/website/public_html/wiki/includes/Exception.php(342): OutputPage->showErrorPage('badtitle', 'badtitletext', NULL)
#9 /home/website/public_html/wiki/includes/Exception.php(374): ErrorPageError->report()
#10 /home/website/public_html/wiki/includes/Exception.php(620): BadTitleError->report()
#11 /home/website/public_html/wiki/includes/Exception.php(690): MWExceptionHandler::report(Object(BadTitleError))
#12 /home/website/public_html/wiki/includes/Wiki.php(449): MWExceptionHandler::handle(Object(BadTitleError))
#13 /home/website/public_html/wiki/index.php(59): MediaWiki->run()
#14 {main} 
```

感谢您的帮助谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-29T11:05:43.600

skalee 的解决方案适用于嵌套：尝试升级 PCRE 或 Perl，或自行使用该选项编译 PCRE。

# c# - 引用第一个孩子并获取对象引用错误

> ID：13422670
> 
> 赞同：1
> 
> 时间：2012-11-16T18:54:27.717
> 
> 标签：c#

我有两个可以返回的不同 XML 响应。它们看起来像这样：

1) 如果没有用户则返回。

```
<ArrayUser xmlns:i="http://www.w3.org/2001/XMLSchema-instance"> 
```

2：如果用户找到则返回。

```
<ArrayUser xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <User>
    <Name></Name>
    <ID></ID>
  </User> 
```

这是我当前的代码：

```
 if (userLookupResponse.DocumentElement.FirstChild.Name.Equals("User")) 
        {
            XmlNamespaceManager nsm = addXmlNamespaces(userLookupResponse);
            userLookupResponse.LoadXml(userLookupResponse.SelectSingleNode("//SSO:User", nsm).OuterXml);
            return userLookupResponse;
        } 
```

我的问题是，如果未返回用户，则`if`语句中的对象引用未设置为对象错误实例的错误。仅当数字 2 与用户信息一起返回时，我如何才能进入 if 语句？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:00:14.793

> if (userLookupResponse.DocumentElement.FirstChild.Name.Equals("User"))

我猜 FirstChild 将是空的，因为没有孩子。

为什么不改变你的测试来看看：

> if (userLookupResponse.DocumentElement.FirstChild != null)

# android - 寻找 addTimedTextSource 的工作示例，用于从 Android 4.1 中的 .srt 文件向视频添加字幕

> ID：13422673
> 
> 赞同：33
> 
> 时间：2012-11-16T18:55:11.407
> 
> 标签：android, video, captions, srt

我一直在尝试将 .srt 文件用于定时文本源（仅在 android 4.1+ [http://developer.android.com/about/versions/android-4.1.html#Multimedia](http://developer.android.com/about/versions/android-4.1.html#Multimedia)中可用）。第一个问题与获取 .srt 文件的文件描述符有关（在资产文件夹中，您将如何将它捆绑到您的应用程序中？）。该文件会自动压缩，因此您甚至无法在不更改编译设置或进行自定义构建的情况下看到该文件。最简单的解决方案是将 .srt 文件重命名为 .jpg ，这样它就不会被压缩并且 openFD 方法仍然有效。我现在添加 TimedTextSource：

```
_myMP.addTimedTextSource(getAssets().openFd("captions.jpg").getFileDescriptor(),   MediaPlayer.MEDIA_MIMETYPE_TEXT_SUBRIP); 
```

现在文件正确加载并使用 myMP.getTrackInfo() 获取曲目列表，可以看到添加定时文本源后，第 6 个曲目的类型为“3”，即定时文本曲目类型。我已经使用 selectTrack 来选择这个轨道，如谷歌文档中所说，但这样做之后，没有任何字幕出现在我的 TimedTextListener 上：

```
 _myMP.setOnTimedTextListener(new OnTimedTextListener(){
        @Override
        public void onTimedText(MediaPlayer mp, TimedText text) {
                if (text!=null)
                   Log.d("TimedText", text.getText());  
            }       
        }); 
```

只触发一次（我在文件中有 20 个定时文本事件），但文本参数始终为空。我已经进行了搜索，但找不到使用 timeText 的单个工作代码示例，并且它没有出现在任何示例项目中，除了来自 google 的 api 文档之外，实际上没有任何文档，但据我所知，没有人发布过它的工作示例。我正在更新到 Android 4.2 的谷歌 Nexus 上测试这个

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-18T04:05:46.453

我能够让它工作，因为它仍然是一个悬而未决的问题，我将在此处包含完整的解决方案。

虽然更改文件扩展名以防止压缩的想法很好，但我更喜欢将`srt`文件从资源复制到设备上的应用程序本地目录，但无论如何为了完整起见，这里是一个扩展列表，不会t被压缩。

> “.jpg”、“.jpeg”、“.png”、“.gif”、“.wav”、“.mp2”、“.mp3”、“.ogg”、“.aac”、“.mpg”、 “.mpeg”、“.mid”、“.midi”、“.smf”、“.jet”、“.rtttl”、“.imy”、“.xmf”、“.mp4”、“.m4a”、 “.m4v”、“.3gp”、“.3gpp”、“.3g2”、“.3gpp2”、“.amr”、“.awb”、“.wma”、“.wmv”

解决步骤很简单：

1.  创建一个`MediaPlayer`实例并通过调用`MediaPlayer.create()`或`player.setDataSource()`然后准备它`player.prepare()`

2.  如果android设备上不存在字幕文件，将其从资源文件夹复制到设备

3.  `player.addTimedTextSource()`使用第一个参数 a调用，`String`其中包含设备上*字幕文件*的完整路径，并`MediaPlayer.MEDIA_MIMETYPE_TEXT_SUBRIP`作为第二个参数调用

4.  通过调用选择`TimedText`曲目`player.selectTrack()`并通过`the index of timedTextType`搜索`TrackInfo[]`返回来传递`player.getTrackInfo()`（我通常会找到它`2`）

5.  设置监听器，`player.setOnTimedTextListener()`然后开始播放媒体文件`player.start()`

**这是完整的课程：**

*要运行这个确切的类，您将需要文件`res/raw`夹下的两个文件`sub.srt`和`video.mp4`（或任何扩展名）。然后`TextView`用 id定义 a `txtDisplay`。最后你的项目/设备/模拟器必须支持`API 16`*

```
public class MainActivity extends Activity implements OnTimedTextListener {
    private static final String TAG = "TimedTextTest";
    private TextView txtDisplay;
    private static Handler handler = new Handler();

    @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    txtDisplay = (TextView) findViewById(R.id.txtDisplay);
    MediaPlayer player = MediaPlayer.create(this, R.raw.video);
    try {
        player.addTimedTextSource(getSubtitleFile(R.raw.sub),
                MediaPlayer.MEDIA_MIMETYPE_TEXT_SUBRIP);
        int textTrackIndex = findTrackIndexFor(
                TrackInfo.MEDIA_TRACK_TYPE_TIMEDTEXT, player.getTrackInfo());
        if (textTrackIndex >= 0) {
            player.selectTrack(textTrackIndex);
        } else {
            Log.w(TAG, "Cannot find text track!");
        }
        player.setOnTimedTextListener(this);
        player.start();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

private int findTrackIndexFor(int mediaTrackType, TrackInfo[] trackInfo) {
    int index = -1;
    for (int i = 0; i < trackInfo.length; i++) {
        if (trackInfo[i].getTrackType() == mediaTrackType) {
            return i;
        }
    }
    return index;
}

private String getSubtitleFile(int resId) {
    String fileName = getResources().getResourceEntryName(resId);
    File subtitleFile = getFileStreamPath(fileName);
    if (subtitleFile.exists()) {
        Log.d(TAG, "Subtitle already exists");
        return subtitleFile.getAbsolutePath();
    }
    Log.d(TAG, "Subtitle does not exists, copy it from res/raw");

    // Copy the file from the res/raw folder to your app folder on the
    // device
    InputStream inputStream = null;
    OutputStream outputStream = null;
    try {
        inputStream = getResources().openRawResource(resId);
        outputStream = new FileOutputStream(subtitleFile, false);
        copyFile(inputStream, outputStream);
        return subtitleFile.getAbsolutePath();
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        closeStreams(inputStream, outputStream);
    }
    return "";
}

private void copyFile(InputStream inputStream, OutputStream outputStream)
        throws IOException {
    final int BUFFER_SIZE = 1024;
    byte[] buffer = new byte[BUFFER_SIZE];
    int length = -1;
    while ((length = inputStream.read(buffer)) != -1) {
        outputStream.write(buffer, 0, length);
    }
}

// A handy method I use to close all the streams
private void closeStreams(Closeable... closeables) {
    if (closeables != null) {
        for (Closeable stream : closeables) {
            if (stream != null) {
                try {
                    stream.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

@Override
public void onTimedText(final MediaPlayer mp, final TimedText text) {
    if (text != null) {
        handler.post(new Runnable() {
            @Override
            public void run() {
                int seconds = mp.getCurrentPosition() / 1000;

                txtDisplay.setText("[" + secondsToDuration(seconds) + "] "
                        + text.getText());
            }
        });
    }
}

// To display the seconds in the duration format 00:00:00
public String secondsToDuration(int seconds) {
    return String.format("%02d:%02d:%02d", seconds / 3600,
            (seconds % 3600) / 60, (seconds % 60), Locale.US);
}
} 
```

**这是`subtitle`我用作示例的文件：**

```
1
00:00:00,220 --> 00:00:01,215
First Text Example

2
00:00:03,148 --> 00:00:05,053
Second Text Example

3
00:00:08,004 --> 00:00:09,884
Third Text Example

4
00:00:11,300 --> 00:00:12,900
Fourth Text Example

5
00:00:15,500 --> 00:00:16,700
Fifth Text Example

6
00:00:18,434 --> 00:00:20,434
Sixth Text Example

7
00:00:22,600 --> 00:00:23,700
Last Text Example 
```

以下是测试应用程序的一些屏幕截图，显示`TextView`随着媒体文件的进展，它正在自动更改（即从字幕文件中读取）

![定时文本示例](../Images/01623c92204ba2d023c51a42f6aec068.png)

**编辑：**

这是[示例项目的代码](https://github.com/iTech-Developer/TimedTextTest)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-07-27T02:52:37.907

编辑：我应该指出，在过去几年中，后 KitKat 版本的 Android 已成为大多数使用应用程序的 android 设备市场份额。下面的实现是试图桥接与旧设备的兼容性。此时，我建议使用 TimedText 框架（在 KitKat 中运行良好）或 android 发布的更新替代方案，因为自定义解决方案可能需要大量维护成本。

* * *

我花了 2 天时间查看 android 源代码，试图消除这个 TimedText 框架引起的所有错误。

我的建议是完全跳过它们的实施。它是不完整和不一致的。在早期的版本中，很多文本同步都是在原生媒体播放器中完成的，所以很容易出现状态错误。

我的替代方法是使用 Textview 子类：

```
package ca.yourpackage.yourapp;

import android.content.Context;
import android.media.MediaPlayer;
import android.util.AttributeSet;
import android.util.Log;
import android.widget.TextView;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.LineNumberReader;
import java.util.Locale;
import java.util.Map;
import java.util.TreeMap;

/**
 * Created by MHDante on 2015-07-26.
 */
public class SubtitleView extends TextView implements Runnable{
    private static final String TAG = "SubtitleView";
    private static final boolean DEBUG = false;
    private static final int UPDATE_INTERVAL = 300;
    private MediaPlayer player;
    private TreeMap<Long, Line> track;

    public SubtitleView(Context context) {
        super(context);
    }

    public SubtitleView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }
    public SubtitleView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    public void run() {
        if (player !=null && track!= null){
            int seconds = player.getCurrentPosition() / 1000;
            setText((DEBUG?"[" + secondsToDuration(seconds) + "] ":"")
                    + getTimedText(player.getCurrentPosition()));
        }
        postDelayed(this, UPDATE_INTERVAL);
    }

    private String getTimedText(long currentPosition) {
        String result = "";
        for(Map.Entry<Long, Line> entry: track.entrySet()){
            if (currentPosition < entry.getKey()) break;
            if (currentPosition < entry.getValue().to) result = entry.getValue().text;
        }
        return result;
    }

    // To display the seconds in the duration format 00:00:00
    public String secondsToDuration(int seconds) {
        return String.format("%02d:%02d:%02d", seconds / 3600,
                (seconds % 3600) / 60, (seconds % 60), Locale.US);
    }

    @Override
    protected void onAttachedToWindow() {
        super.onAttachedToWindow();
        postDelayed(this, 300);
    }

    @Override
    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        removeCallbacks(this);
    }
    public void setPlayer(MediaPlayer player) {
        this.player = player;
    }

    public void setSubSource(int ResID, String mime){
        if(mime.equals(MediaPlayer.MEDIA_MIMETYPE_TEXT_SUBRIP))
            track = getSubtitleFile(ResID);
        else
            throw new UnsupportedOperationException("Parser only built for SRT subs");
    }

    /////////////Utility Methods:
    //Based on https://github.com/sannies/mp4parser/
    //Apache 2.0 Licence at: https://github.com/sannies/mp4parser/blob/master/LICENSE

    public static TreeMap<Long, Line> parse(InputStream is) throws IOException {
        LineNumberReader r = new LineNumberReader(new InputStreamReader(is, "UTF-8"));
        TreeMap<Long, Line> track = new TreeMap<>();
        while ((r.readLine()) != null) /*Read cue number*/{
            String timeString = r.readLine();
            String lineString = "";
            String s;
            while (!((s = r.readLine()) == null || s.trim().equals(""))) {
                lineString += s + "\n";
            }
            long startTime = parse(timeString.split("-->")[0]);
            long endTime = parse(timeString.split("-->")[1]);
            track.put(startTime, new Line(startTime, endTime, lineString));
        }
        return track;
    }

    private static long parse(String in) {
        long hours = Long.parseLong(in.split(":")[0].trim());
        long minutes = Long.parseLong(in.split(":")[1].trim());
        long seconds = Long.parseLong(in.split(":")[2].split(",")[0].trim());
        long millies = Long.parseLong(in.split(":")[2].split(",")[1].trim());

        return hours * 60 * 60 * 1000 + minutes * 60 * 1000 + seconds * 1000 + millies;

    }

    private TreeMap<Long, Line> getSubtitleFile(int resId) {
        InputStream inputStream = null;
        try {
            inputStream = getResources().openRawResource(resId);
            return parse(inputStream);
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (inputStream != null) {
                try {
                    inputStream.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
        return null;
    }

    public static class Line {
        long from;
        long to;
        String text;

        public Line(long from, long to, String text) {
            this.from = from;
            this.to = to;
            this.text = text;
        }
    }
} 
```

用法：

```
//I used and reccomend asyncPrepare()
MediaPlayer mp = MediaPlayer.create(context, R.raw.video);
SubtitleView subView = (SubtitleView) getViewbyId(R.id.subs_box);
subView.setPlayer(mp);
subView.setSubSource(R.raw.subs_intro, MediaPlayer.MEDIA_MIMETYPE_TEXT_SUBRIP); 
```

在您的布局 xml 文件中，只需创建一个您希望显示字幕的 textView，然后将类更改为 ca.yourpagckage.yourapp.SubtitleView

```
<ca.yourpagckage.yourapp.SubtitleView
    android:layout_width="300dp"
    android:layout_height="300dp"
    android:text="Subtitles go Here"
    android:id="@+id/subs_box"/> 
```

祝你好运。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-09-22T02:25:51.527

要让它与 .mp3 文件一起使用，请调用 player.start(); 在声明一个新的媒体播放器之后和 addtimedtext 代码之前。在下面的行之后

```
MediaPlayer player = MediaPlayer.create(this, R.raw.video); 
```

# linux - 如何在 linux 中使用另一个脚本运行脚本？

> ID：13422677
> 
> 赞同：0
> 
> 时间：2012-11-16T18:55:21.520
> 
> 标签：linux, scripting

我的脚本是：

```
/opt/Myapplication/bin/start.sh 
```

我总是必须这样开始：

```
$cd /opt/Myapplication
$bin/start.sh 
```

现在我想编写一个脚本，它将像上面一样运行 start.sh。我的意思是，它应该从`/opt/Myapplication`目录运行它

也许是这样的：

```
#!/bin/bash

my_path=/opt/Myapplication
$my_path/bin/start.sh 
```

它会从`/opt/Myapplication`目录运行 start.sh 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:00:07.650

它会运行`/opt/Myapplication/my_path/bin/start.sh`，但它不会改变工作目录，如果这就是你的意思的话。为此，您必须首先`cd`在脚本中：

```
#!/bin/bash

my_path=/opt/Myapplication
cd $my_path
$my_path/bin/start.sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:01:29.203

您希望避免需要在特定位置才能正常工作的脚本

但是不，它不会在那个工作目录下运行，你必须先 cd

```
#!/bin/bash
cd /opt/Myapplication/bin
bash start.sh 
```

# xml - 有条件的 XSL 转换

> ID：13422678
> 
> 赞同：0
> 
> 时间：2012-11-16T18:55:22.480
> 
> 标签：xml, xslt

我必须在下面的 xml 中添加一个 href 属性，但不是每个子进程都有一个。

```
<?xml version="1.0"?>
<processes>
    <process nr="1" name="Process1" >
        <subprocess nr="1" name="Subprocess1" href="some/relative/link.html"></subprocess>
        <subprocess nr="2" name="Subprocess2" href="#"></subprocess>
        <subprocess nr="3" name="Subprocess3"></subprocess>
    </process>
</processes> 
```

我需要在我的原始 XSL 中进行哪些更改才能生成以下 HTML 输出？如何处理不同的 href 属性值？

**XSL**：

```
<xsl:template name="subprocess">
<xsl:call-template name="linking"/>
</xsl:template>
 <xsl:template name="linking">
 <xsl:variable name="processNo" select="@nr"/>   
 <ul class="myframe">
  <xsl:for-each select="subprocess">
    <li>
      <a class="myButton" href="p{$processNo}s{@nr}.html">
        <xsl:value-of select="@nr"/>
        <br/>
        <xsl:value-of select="@name"/>
      </a>
    </li>
  </xsl:for-each>
</ul>
</xsl:template> 
```

**HTML：**

```
<ul class="myframe">
    <li><a class="linkButton" href="some/relative/link.html">Subprocess1</a></li>
    <li><a class="noLink" href="#">Subprocess2</a></li>
    <li><a class="myButton" href="p1s3.html">Subprocess3</a></li>
</ul> 
```

因此，根据 href 属性，我也想分配不同的 CSS 类。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T22:12:31.150

Another way to approach this is to make use of power of pattern matching with templates. You have a separate template to match the various conditions that occur for your **subprocess** elements.

```
<xsl:template match="subprocess[@href = '#']">

<xsl:template match="subprocess[@href != '' and @href != '#']">

<xsl:template match="subprocess"> 
```

Then, within each one of these you could call your **linking** template, but passing in the relevant class, and optionally the link, as a parameter. For example...

```
<xsl:template match="subprocess[@href = '#']">
   <xsl:call-template name="linking">
      <xsl:with-param name="class" select="'noLink'"/>
   </xsl:call-template>
</xsl:template> 
```

Here is the full XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="process">
      <ul class="myframe">
         <xsl:apply-templates select="subprocess"/>
      </ul>
   </xsl:template>

   <xsl:template match="subprocess[@href = '#']">
      <xsl:call-template name="linking">
         <xsl:with-param name="class" select="'noLink'"/>
      </xsl:call-template>
   </xsl:template>

   <xsl:template match="subprocess[@href != '' and @href != '#']">
      <xsl:call-template name="linking" />
   </xsl:template>

   <xsl:template match="subprocess">
      <xsl:call-template name="linking">
         <xsl:with-param name="class" select="'myButton'"/>
         <xsl:with-param name="link" select="concat('p', ../@nr, 's', @nr, '.html')"/>
      </xsl:call-template>
   </xsl:template>

   <xsl:template name="linking">
      <xsl:param name="class" select="'linkButton'" />
      <xsl:param name="link" select="@href"/>
      <li>
         <a class="{$class}" href="{$link}">
            <xsl:value-of select="@name"/>
         </a>
      </li>
   </xsl:template>
</xsl:stylesheet> 
```

When applied to your XML, the following is output

```
<ul class="myframe">
   <li>
      <a class="linkButton" href="some/relative/link.html">Subprocess1</a>
   </li>
   <li>
      <a class="noLink" href="#">Subprocess2</a>
   </li>
   <li>
      <a class="myButton" href="p1s3.html">Subprocess3</a>
   </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:28:02.463

使用`xsl:choose`和`xsl:attribute`：

```
<xsl:template name="linking">
    <xsl:variable name="processNo" select="@nr"/>
    <ul class="myframe">
        <xsl:for-each select="subprocess">
            <li>
                <a>
                    <xsl:choose>
                        <xsl:when test="@href eq '#'">
                            <xsl:attribute name="class" select="'noLink'"/>
                        </xsl:when>
                        <xsl:when test="not(@href)">
                            <xsl:attribute name="class" select="'myButton'"/>
                            <xsl:attribute name="href"
                                select="concat('p',$processNo,'s',@nr,'.html')"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:sequence select="@href"/>
                        </xsl:otherwise>
                    </xsl:choose>
                    <xsl:value-of select="name()"/>
                </a>
            </li>
        </xsl:for-each>
    </ul>
</xsl:template> 
```

# ios - iOS 应用程序无法通过 OTA Enterprise Distribution 正确更新

> ID：13422680
> 
> 赞同：3
> 
> 时间：2012-11-16T18:55:29.403
> 
> 标签：ios, ipad, installation, updates, ota

我有一个通过 OTA Enterprise Distribution 分发给客户端的 iPad 应用程序。该应用程序在客户的 iPad 上分发和安装没有问题。当他们尝试安装较新版本的应用程序时会出现问题。

在新版本中添加到 app bundle 中的任何新资源在最新版本中都无法访问；客户端必须先删除旧应用程序并重新安装新版本才能看到应用程序包中的新资源。

每个构建中的 .plist 文件为 bundle-version 指定不同的编号，因此不应在较新的构建中使用相同的应用程序包。

我似乎无法在任何地方找到解决方案。有没有其他人遇到过这个问题？您对我如何解决它有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T18:01:48.903

原来问题不在于应用程序包。某些资源被保存到 Documents 文件夹（因为较新的版本是通过应用程序下载的）并且文件路径被保存到用户默认值。当应用程序更新为新版本时，文件路径变得无效，因为新更新的应用程序在路径中有不同的 uid，因此找不到存储在 Documents 文件夹中的资源。

我修改了代码以始终从 NSDocumentsDirectory 中获取文件路径，而不是从 User Defaults 中存储和获取它；我不确定为什么最初实现它是为了存储文件路径。

# mysql - SQL Join 使用 CodeIgniter 失败

> ID：13422682
> 
> 赞同：0
> 
> 时间：2012-11-16T18:55:32.350
> 
> 标签：mysql, sql, codeigniter

我试图加入两个表，但似乎无法弄清楚如何解决这个错误：这是从 CodeIgniter 生成的代码：

```
SELECT `proc`.* FROM (`deliverycheck_proc_entries` proc) 
LEFT OUTER JOIN `deliverycheck_proc_entries` 
ON `proc`.`raw_entry_id` = `deliverycheck_raw_entries`.`id` 
WHERE `proc`.`status` > '1' 
ORDER BY `id` asc LIMIT 10 
```

我的错误：

```
Error Number: 1054
Unknown column 'deliverycheck_raw_entries.id' in 'on clause' 
```

我需要来自 的所有列和来自 的`deliverycheck_proc_entries`特定列`deliverycheck_raw-entries`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:57:09.247

改变

```
LEFT OUTER JOIN `deliverycheck_proc_entries` 
```

至

```
LEFT OUTER JOIN `deliverycheck_raw_entries` 
```

## 编辑

```
SELECT proc.*, raw.* 
FROM deliverycheck_proc_entries `proc`
LEFT OUTER JOIN deliverycheck_raw_entries raw
ON proc.raw_entry_id = raw.id 
WHERE proc.status > '1' 
ORDER BY proc.id ASC
LIMIT 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:57:18.153

可能是一个错字，但你加入`deliverycheck_proc_entries`了它自己而不是`deliverycheck_raw_entries`.

# java - Eclipse 无法识别字符串和类

> ID：13422683
> 
> 赞同：4
> 
> 时间：2012-11-16T18:55:32.467
> 
> 标签：java, eclipse, adt

我已经保存了一个由 eclipse 构建的项目，然后我的计算机就死了。当我修复它并重新格式化时，我重新下载了 eclipse 等。实际上，当我按下“eclipse.exe”时，它会显示 eclipse juno 图标，但窗口的名称是 Java-ADT，它看起来有点不同。我已经安装了 ADT 插件和所有的 Android API，但是当我导入我的项目时，当它打开类时，可以说它什么都不识别。我的意思是，字符串、类、导入、android，什么都没有。

它说：无法解析导入android。或者：字符串不能被解析为一种类型。

有人有想法吗？

顺便说一句：XML 工作正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T18:58:59.383

转到`Menu(Windows) ->Preferences -> Java -> Installed JREs`并确保您的 JRE 可用并且选择了合适的 JRE。如果没有（我希望是这样），请使用`Add`右侧的按钮添加库并浏览 JRE 安装位置。

除上述步骤外，转到`Right Click(project) -> properties -> Java Build Path -> libraries`。再次确保在那里选择了正确的库和罐子并且有效。如果没有，请添加/更正它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:59:19.520

重新下载JDK，这将自动更新Eclipse。

# extjs4.1 - Extjs4.1.1GA GridPanel 滚动条不显示

> ID：13422687
> 
> 赞同：0
> 
> 时间：2012-11-16T18:55:43.250
> 
> 标签：extjs4.1

这是我正在处理的应用程序的简单代码：

```
 {
            xtype: 'tabpanel',
            activeTab: 0,
            layout: 'fit',
            items: [
                {
                    xtype: 'gridpanel',
                    title: 'Proposed Benchmarkss',
                    store: 'BenchmarkLookupStore',
                    plugins: [cellEditing],
                    scroll: true,
                    columns: [
                        new Ext.grid.RowNumberer(),
                        {
                            dataIndex: 'code',
                            text: 'Code',
                            flex: 1
                        }

                    ]
                },
                {
                    xtype: 'panel',
                    title: 'Additional Comments',
                    layout: 'fit',
                    items: [
                        {
                            xtype: 'htmleditor'
                        }
                    ]
                }
            ]
        } 
```

我正在使用 Extjs4.1.1 GA，记录数为 300，但在网格面板上看不到滚动条。我放了 scroll: true ，但我仍然看不到滚动条。我获得滚动条的唯一方法是将 height:200 放在网格面板上。

很奇怪 ！

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T21:32:10.097

通过将多个项目放置在具有合适布局的选项卡面板中，您可能会混淆布局引擎。它旨在拉伸单个项目以占据其父元素的整个主体。我将更改为在选项卡面板上使用 vbox 布局而不是 fit 布局，并为网格面板和附加评论面板提供 flex 或 height 属性（可能在评论和 flex: 1 网格面板上设置高度以像素为单位） . 此外，如果选项卡面板中的任何容器未在此处显示，请确保它们具有布局集并正确应用。

# python - Django：如何限制从模型返回的对象数量

> ID：13422689
> 
> 赞同：20
> 
> 时间：2012-11-16T18:55:46.520
> 
> 标签：python, django

我在数据库中有一个“新闻”标题列表，其中包含以下字段：ID、标题、日期。我想获取最新的十个（如果少于十个，则全部检索）。

就像是：

```
news = News.objects.order_by("date").first(10) 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-16T18:59:41.203

这是你需要做的：

```
news = News.objects.order_by("-date")[:10] 
```

这里发生了一些有趣的事情。

首先，要获得最新消息，您需要降序。（那是“-date”部分）[0]

第二部分是限制结果集[1]。这与 Python 列表 Slicing[2] 共享相同的接口，但它们是不同的东西。请仔细阅读。

[0] [https://docs.djangoproject.com/en/dev/ref/models/querysets/#order-by](https://docs.djangoproject.com/en/dev/ref/models/querysets/#order-by)

[1] [https://docs.djangoproject.com/en/dev/topics/db/queries/#limiting-querysets](https://docs.djangoproject.com/en/dev/topics/db/queries/#limiting-querysets)

[2] [http://docs.python.org/2/tutorial/introduction.html](http://docs.python.org/2/tutorial/introduction.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-02T10:51:44.223

我的解决方案

返回的对象实际上是一个列表。通过使用 python 列表索引，我们可以获得任意数量的对象。下面添加的示例。

```
'productobj = product_master.objects.all()[0:20]` 
```

# c# - 直接访问物理光驱设备

> ID：13422690
> 
> 赞同：1
> 
> 时间：2012-11-16T18:55:51.543
> 
> 标签：c#, winapi, device

我正在尝试访问物理 cdrom 设备以检查它是否可启动，因此我需要从中读取字节。我尝试了以下两种方法，但没有成功：

方法一：

```
FileStream stream = new FileStream(H:, FileMode.Open); 
```

但我在 H: 上被拒绝访问。我知道我可以访问。

方法 B：通过 Pinvoke

```
 IntPtr handle = CreateFile(source, FileAccess.Read, FileShare.ReadWrite, 0, FileMode.Open, 0, IntPtr.Zero);
            binReader = new BinaryReader(new FileStream(handle, FileAccess.Read,true)); 
```

但我得到：

FileStream 不会打开 Win32 设备，例如磁盘分区和磁带驱动器。避免在路径中使用“\.\”。

有什么办法可以在 c# 中完成我想要的吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:29:16.037

好的...问题是 DVD 和 CD 之间的区别...显然我们不能那样读取 DVD...但是给您...

```
using System;
using System.Runtime.InteropServices;
using Microsoft.Win32.SafeHandles;
using System.ComponentModel;

namespace cdDvdAccess
{
    public class Program
    {

        //some interesting IOCTLs
        public const uint IOCTL_CDROM_READ_TOC = 0x00024000;
        public const uint IOCTL_CDROM_RAW_READ = 0x0002403E;
        public const uint IOCTL_STORAGE_EJECT_MEDIA = 0x002D4808;
        public const uint IOCTL_STORAGE_LOAD_MEDIA = 0x002D480C;

        // P/Invoke signatures
        [DllImport("Kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool DeviceIoControl(
                SafeFileHandle hDevice,
                uint dwIoControlCode,
                IntPtr InBuffer, // arbitrary buffer
                int nInBufferSize,
                IntPtr OutBuffer,
                int nOutBufferSize,
                ref int pBytesReturned,
                IntPtr lpOverlapped);

        [DllImport("Kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool DeviceIoControl(
                SafeFileHandle hDevice,
                uint dwIoControlCode,
                ref RAW_READ_INFO InBuffer, // with RAW_READ_INFO
                int nInBufferSize,
                IntPtr OutBuffer,
                int nOutBufferSize,
                ref int pBytesReturned,
                IntPtr lpOverlapped);

        [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
        private static extern SafeFileHandle CreateFile(
           string lpFileName,
           EFileAccess dwDesiredAccess,
           EFileShare dwShareMode,
           IntPtr lpSecurityAttributes,
           ECreationDisposition dwCreationDisposition,
           EFileAttributes dwFlagsAndAttributes,
           IntPtr hTemplateFile);

        [Flags]
        public enum EFileAccess : uint
        {
            //
            // Standart Section
            //

            AccessSystemSecurity = 0x1000000,   // AccessSystemAcl access type
            MaximumAllowed = 0x2000000,     // MaximumAllowed access type

            Delete = 0x10000,
            ReadControl = 0x20000,
            WriteDAC = 0x40000,
            WriteOwner = 0x80000,
            Synchronize = 0x100000,

            StandardRightsRequired = 0xF0000,
            StandardRightsRead = ReadControl,
            StandardRightsWrite = ReadControl,
            StandardRightsExecute = ReadControl,
            StandardRightsAll = 0x1F0000,
            SpecificRightsAll = 0xFFFF,

            FILE_READ_DATA = 0x0001,        // file & pipe
            FILE_LIST_DIRECTORY = 0x0001,       // directory
            FILE_WRITE_DATA = 0x0002,       // file & pipe
            FILE_ADD_FILE = 0x0002,         // directory
            FILE_APPEND_DATA = 0x0004,      // file
            FILE_ADD_SUBDIRECTORY = 0x0004,     // directory
            FILE_CREATE_PIPE_INSTANCE = 0x0004, // named pipe
            FILE_READ_EA = 0x0008,          // file & directory
            FILE_WRITE_EA = 0x0010,         // file & directory
            FILE_EXECUTE = 0x0020,          // file
            FILE_TRAVERSE = 0x0020,         // directory
            FILE_DELETE_CHILD = 0x0040,     // directory
            FILE_READ_ATTRIBUTES = 0x0080,      // all
            FILE_WRITE_ATTRIBUTES = 0x0100,     // all

            //
            // Generic Section
            //

            GenericRead = 0x80000000,
            GenericWrite = 0x40000000,
            GenericExecute = 0x20000000,
            GenericAll = 0x10000000,

            SPECIFIC_RIGHTS_ALL = 0x00FFFF,
            FILE_ALL_ACCESS =
            StandardRightsRequired |
            Synchronize |
            0x1FF,

            FILE_GENERIC_READ =
            StandardRightsRead |
            FILE_READ_DATA |
            FILE_READ_ATTRIBUTES |
            FILE_READ_EA |
            Synchronize,

            FILE_GENERIC_WRITE =
            StandardRightsWrite |
            FILE_WRITE_DATA |
            FILE_WRITE_ATTRIBUTES |
            FILE_WRITE_EA |
            FILE_APPEND_DATA |
            Synchronize,

            FILE_GENERIC_EXECUTE =
            StandardRightsExecute |
              FILE_READ_ATTRIBUTES |
              FILE_EXECUTE |
              Synchronize
        }

        [Flags]
        public enum EFileShare : uint
        {
            /// <summary>
            ///
            /// </summary>
            None = 0x00000000,
            /// <summary>
            /// Enables subsequent open operations on an object to request read access.
            /// Otherwise, other processes cannot open the object if they request read access.
            /// If this flag is not specified, but the object has been opened for read access, the function fails.
            /// </summary>
            Read = 0x00000001,
            /// <summary>
            /// Enables subsequent open operations on an object to request write access.
            /// Otherwise, other processes cannot open the object if they request write access.
            /// If this flag is not specified, but the object has been opened for write access, the function fails.
            /// </summary>
            Write = 0x00000002,
            /// <summary>
            /// Enables subsequent open operations on an object to request delete access.
            /// Otherwise, other processes cannot open the object if they request delete access.
            /// If this flag is not specified, but the object has been opened for delete access, the function fails.
            /// </summary>
            Delete = 0x00000004
        }

        public enum ECreationDisposition : uint
        {
            /// <summary>
            /// Creates a new file. The function fails if a specified file exists.
            /// </summary>
            New = 1,
            /// <summary>
            /// Creates a new file, always.
            /// If a file exists, the function overwrites the file, clears the existing attributes, combines the specified file attributes,
            /// and flags with FILE_ATTRIBUTE_ARCHIVE, but does not set the security descriptor that the SECURITY_ATTRIBUTES structure specifies.
            /// </summary>
            CreateAlways = 2,
            /// <summary>
            /// Opens a file. The function fails if the file does not exist.
            /// </summary>
            OpenExisting = 3,
            /// <summary>
            /// Opens a file, always.
            /// If a file does not exist, the function creates a file as if dwCreationDisposition is CREATE_NEW.
            /// </summary>
            OpenAlways = 4,
            /// <summary>
            /// Opens a file and truncates it so that its size is 0 (zero) bytes. The function fails if the file does not exist.
            /// The calling process must open the file with the GENERIC_WRITE access right.
            /// </summary>
            TruncateExisting = 5
        }

        [Flags]
        public enum EFileAttributes : uint
        {
            Readonly = 0x00000001,
            Hidden = 0x00000002,
            System = 0x00000004,
            Directory = 0x00000010,
            Archive = 0x00000020,
            Device = 0x00000040,
            Normal = 0x00000080,
            Temporary = 0x00000100,
            SparseFile = 0x00000200,
            ReparsePoint = 0x00000400,
            Compressed = 0x00000800,
            Offline = 0x00001000,
            NotContentIndexed = 0x00002000,
            Encrypted = 0x00004000,
            Write_Through = 0x80000000,
            Overlapped = 0x40000000,
            NoBuffering = 0x20000000,
            RandomAccess = 0x10000000,
            SequentialScan = 0x08000000,
            DeleteOnClose = 0x04000000,
            BackupSemantics = 0x02000000,
            PosixSemantics = 0x01000000,
            OpenReparsePoint = 0x00200000,
            OpenNoRecall = 0x00100000,
            FirstPipeInstance = 0x00080000
        }

        public enum TRACK_MODE_TYPE
        {
            YellowMode2 = 0,
            XAForm2 = 1,
            CDDA = 2,
            RawWithC2AndSubCode = 3,
            RawWithC2 = 4,
            RawWithSubCode = 5
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct RAW_READ_INFO
        {
            public long DiskOffset;
            public uint SectorCount;
            public TRACK_MODE_TYPE TrackMode;

        }

        static void Main(string[] args)
        {
            Byte[] data; // a variable to hold our desired data...
            Win32Exception ex, ex2; //see using block below
            int outputBufferSize = 4096000;//just some buffer ... way to big, but hey ...
            var unmanagedOutputBuffer = Marshal.AllocHGlobal(outputBufferSize); // Marshal will give us an unmanaged buffer of desired size ... hopefully
            RAW_READ_INFO ri = new RAW_READ_INFO { DiskOffset = 0, SectorCount = 20, TrackMode = TRACK_MODE_TYPE.YellowMode2 }; // what do we want to read?
            var ri_size = Marshal.SizeOf(ri); // since we are giving ri to an unmanaged function, we need to tell that function the size of ri
            int bytesReturned = 0; // if everything works as expected, we will get something written in our unmanaged buffer ... here we can store how many bytes were written
            using (var hDev = CreateFile(@"\\.\H:", EFileAccess.GenericRead, EFileShare.Read | EFileShare.Write, IntPtr.Zero, ECreationDisposition.OpenExisting, EFileAttributes.Normal, IntPtr.Zero))
            {// since we are working with a handle, we have to make sure we release it after we are done ... "using" does that for us
                ex = new Win32Exception();//will tell you if CreateFile worked 
                var b = DeviceIoControl(hDev, IOCTL_CDROM_RAW_READ, ref ri, ri_size, unmanagedOutputBuffer, outputBufferSize, ref bytesReturned, IntPtr.Zero); // the magic happens here
                ex2 = new Win32Exception();//will tell you if DeviceIoControl worked
            }

            if (bytesReturned > 0)
            {
                data = new byte[bytesReturned]; //this time, a managed buffer to hold our data
                Marshal.Copy(unmanagedOutputBuffer, data, 0, bytesReturned); // copy from unmanaged buffer to managed buffer (from the land of dragons and monsters into the .net world)
            }
            Marshal.FreeHGlobal(unmanagedOutputBuffer);//release the unmanaged buffer

            // if everything worked as expected you should now have the first 20 sectors of a ordinary CD-Rom (Yellow Book - Mode 2) in the data array ...

        }
    }
} 
```

# php - 使用 javascript 和 php 上传 HTML5 图像

> ID：13422692
> 
> 赞同：1
> 
> 时间：2012-11-16T18:55:55.460
> 
> 标签：php, javascript, jquery, html

我想使用`javascript`and `php`(html5) 将图像多次上传到数据库，但我有问题，我的代码只是上传一张图像，这是选择的最新照片而不是全部。如何解决这个问题，我该怎么办？

我使用开发者 mozilla html5：**[这里](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications)**

您可以通过选择多个图像并单击按钮`Upload Image`来测试我的代码以查看结果。

**[来自我的完整代码的演示](http://binboy.gigfa.com/imgup.html)**

我的js代码：

```
function doClick() {
    var el = document.getElementById("fileElem");
    if (el) {
        el.click();
    }
}

function handleFiles(files) {
    var d = document.getElementById("fileList");
    if (!files.length) {
        d.innerHTML = "<p>No files selected!</p>";
    } else {
        var list = document.createElement("ul");
        d.appendChild(list);
        for (var i = 0; i < files.length; i++) {
            var li = document.createElement("li");
            list.appendChild(li);

            var img = document.createElement("img");
            img.src = window.URL.createObjectURL(files[i]);;
            img.height = 60;
            img.onload = function () {
                window.URL.revokeObjectURL(this.src);
            }
            li.appendChild(img);

            var info = document.createElement("span");
            info.innerHTML = files[i].name + ": " + files[i].size + " bytes";
            li.appendChild(info);
        }
    }
} 
```

我的PHP代码：

```
<?php 
  foreach ($_FILES[ 'userfile'] as $key=>$value{ 
      echo '<pre>';
      print_r($value);
  }
?> 
```

我的html代码：

```
<html>

    <head>
        <title>file input click() demo</title>
        <script type="text/javascript" src="html5java.js"></script>
    </head>

    <body>
<a href="javascript:doClick()">Select some files</a>

        <div id="fileList"></div>
        <form action="up.php" method="post" enctype="multipart/form-data">
            <input type="file" name="userfile[]" id="fileElem" multiple accept="image/*"
            style="display:none" onchange="handleFiles(this.files)">
            <input type="submit" value="Upload Images">
        </form>
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:22:44.943

问题是 php 多个文件没有存储为 $_FILES['userfile'][x]['name'] 等。它们存储为 $_FILES['userfile']['name']['x' ]。

所以最好的方法通常是遍历 files 数组并将数组重新排序为更合乎逻辑的模式。下面的函数非常适合将其转换为您期望的工作方式（取自第二条评论： http: [//php.net/manual/en/features.file-upload.multiple.php](http://php.net/manual/en/features.file-upload.multiple.php)）

```
<?php
    public static function fixGlobalFilesArray($files) {
        $ret = array();

        if(isset($files['tmp_name']))
        {
            if (is_array($files['tmp_name']))
            {
                foreach($files['name'] as $idx => $name)
                {
                    $ret[$idx] = array(
                        'name' => $name,
                        'tmp_name' => $files['tmp_name'][$idx],
                        'size' => $files['size'][$idx],
                        'type' => $files['type'][$idx],
                        'error' => $files['error'][$idx]
                    );
                }
            }
            else
            {
                $ret = $files;
            }
        }
        else
        {
            foreach ($files as $key => $value)
            {
                $ret[$key] = self::fixGlobalFilesArray($value);
            }
        }

        return $ret;
    }
?> 
```

# javascript - 用 JS 在本地存储结果？

> ID：13422694
> 
> 赞同：0
> 
> 时间：2012-11-16T18:56:07.960
> 
> 标签：javascript

我有一个页面，用户在其中进行选择，并使用 AJAX 调用更新 db，但是，如果用户决定回溯，我想显示选择。如果我只使用 PHP 这样做，我可能会将项目 id 和对应的选定值添加到数组中。但是在这个项目中我没有刷新页面，所以我的问题......有没有办法以某种方式在本地存储这些数据，也许使用 JS。或者我可以在我的 AJAX 页面上构建一个字符串并通过 JSON 返回它。

只是在寻找如何去做的想法。

顺便说一句，我在这个项目中没有使用 HTML5 ......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:08:12.587

如果我理解正确，为什么不创建一堆选择：

```
var selections = [];

function makeSelection(_selection) {
    selections.push(_selection);

    ... ajax
}

function getLastSelection() {
    if (selections.length == 0) {
        return false;
    }

    return selections[selections.length - 1];
}

function getSelections() {
    var out = '';
    var ct = selections.length;
    for (var i = 0; i < ct; ++i) {
        out += (out == '' ? '' : ', ') + selections[i];
    }
return out;
} 
```

添加了一些功能来显示如何查看/获取选择。现在，您将拥有当前会话的用户所在位置（和访问过的位置）的本地副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:09:29.507

您是否尝试过使用数据库存储变量并使用 PHP 获取它们？为什么不使用 HMTL5，因为这样你就可以使用 localStorage，这是一个很棒的功能 :)

# c# - 插入列表 到餐桌

> ID：13422702
> 
> 赞同：2
> 
> 时间：2012-11-16T18:56:25.647
> 
> 标签：c#, asp.net, sql-server, tsql, stored-procedures

我有这种将新公司插入数据库的方法，但我遇到了问题，`List<Contacts>`因为我希望能够为公司插入多个联系人。有人可以帮助我吗？

![在此处输入图像描述](../Images/5891dabef82e043920e72a8cf2f4cdd1.png)

```
public static bool AddNewCompany(Company company,List<Contacts> contact , Location local)
{
    // get a configured DbCommand object
    DbCommand comm = GenericDataAccess.CreateCommand();

    // Set the stored procedure name 
    comm.CommandText = "AddNewCompany";

    //create new parameter @CompanyName
    DbParameter param = comm.CreateParameter();
    param.ParameterName = "@CompanyName";
    param.Value = company.CompanyName;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @CompanyDetail 
    param = comm.CreateParameter();
    param.ParameterName = "@CompanyDetail";
    param.Value = company.CompanyDetail;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @ModifiedDate
    param = comm.CreateParameter();
    param.ParameterName = "@ModifiedDate";
    param.Value = DateTime.Now;
    param.DbType = DbType.DateTime;
    comm.Parameters.Add(param);

    //Company Info
    foreach (var c in contact)
    {
        //create new parameter @LabelContactTypeID
        param = comm.CreateParameter();
        param.ParameterName = "@LabelContactTypeID";
        param.Value = c.LabelContactTypeID;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

        //create new parameter @ContactDetails
        param = comm.CreateParameter();
        param.ParameterName = "@ContactDetails";
        param.Value = c.ContactDetail;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

        //create new parameter @Status
        param = comm.CreateParameter();
        param.ParameterName = "@Status";
        param.Value = c.Status;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

        //create new parameter @Notes
        param = comm.CreateParameter();
        param.ParameterName = "@Notes";
        param.Value = c.Notes;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);
    }

    //Company Info
    //create new parameter @Address
    param = comm.CreateParameter();
    param.ParameterName = "@Address";
    param.Value = local.Address;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @City
    param = comm.CreateParameter();
    param.ParameterName = "@City";
    param.Value = local.City;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @Province
    param = comm.CreateParameter();
    param.ParameterName = "@Province";
    param.Value = local.Province;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @PostalCode
    param = comm.CreateParameter();
    param.ParameterName = "@PostalCode";
    param.Value = local.PostalCode;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @Note
    param = comm.CreateParameter();
    param.ParameterName = "@Note";
    param.Value = local.Note;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @ModifiedDateLocation  
    param = comm.CreateParameter();
    param.ParameterName = "@ModifiedDateLocation";
    param.Value = DateTime.Now;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    try
    {
        return (GenericDataAccess.ExecuteNonQuery(comm) != -1);

    }
    catch
    {
        return false;
    }
} 
```

SQL Server 存储过程：

```
ALTER PROCEDURE [dbo].[AddNewCompany]
    @CompanyName nvarchar(50),
    @CompanyDetail nvarchar(max),
    @ModifiedDate datetime,
    --ContactInfo
    @LabelContactTypeID  int,
    @ContactDetails nvarchar(MAX),
    @Status bit,
    @Notes nvarchar(MAX),
    -- Company Location 
    @Address nvarchar(max),
    @City nvarchar(50),
    @Province nvarchar(50),
    @PostalCode nvarchar(10),
    @Note nvarchar(max),
    @ModifiedDateLocation datetime
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO [TaskManagementSystem_DB].[dbo].[Company] ([companyName],[companyDetail], [modifiedDate])
     VALUES (@CompanyName, @CompanyDetail, @ModifiedDate)

    DECLARE @CompanyID int 
    SET @CompanyID = SCOPE_IDENTITY();

    INSERT INTO [TaskManagementSystem_DB].[dbo].[Company_Contacts] ([companyID], [labelContactTypeID], [contactDetails], [status], [notes])
    VALUES (@CompanyID, @LabelContactTypeID, @ContactDetails, @Status, @Notes)

    INSERT INTO [TaskManagementSystem_DB].[dbo].[Location]([address], [city], [province], [postalCode], [note], [modifiedDate])
    VALUES (@Address, @City, @Province, @PostalCode, @Note, @ModifiedDateLocation)          

    DECLARE @LocationID  INT 
    SET @LocationID = SCOPE_IDENTITY(); 

    INSERT INTO [TaskManagementSystem_DB].[dbo].[Company_location]([companyID], [locationID])
    VALUES (@CompanyID, @LocationID)            
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:08:21.963

将公司部分移到联系人上方。

把它放在接触循环中

```
GenericDataAccess.ExecuteNonQuery(comm); 
```

它添加了一些逻辑来检查是否有任何故障。
如果您想继续或立即返回，这取决于您。

```
public static bool AddNewCompany(Company company,List<Contacts> contact , Location local)
{
    // get a configured DbCommand object
    DbCommand comm = GenericDataAccess.CreateCommand();

    //Set the store Proc name 
    comm.CommandText = "AddNewCompany";

    //create new parameter @CompanyName
    DbParameter param = comm.CreateParameter();
    param.ParameterName = "@CompanyName";
    param.Value = company.CompanyName;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @CompanyDetail 
    param = comm.CreateParameter();
    param.ParameterName = "@CompanyDetail";
    param.Value = company.CompanyDetail;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @ModifiedDate
    param = comm.CreateParameter();
    param.ParameterName = "@ModifiedDate";
    param.Value = DateTime.Now;
    param.DbType = DbType.DateTime;
    comm.Parameters.Add(param);

    //Company Info
    //create new parameter @Address
    param = comm.CreateParameter();
    param.ParameterName = "@Address";
    param.Value = local.Address;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @City
    param = comm.CreateParameter();
    param.ParameterName = "@City";
    param.Value = local.City;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @Province
    param = comm.CreateParameter();
    param.ParameterName = "@Province";
    param.Value = local.Province;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @PostalCode
    param = comm.CreateParameter();
    param.ParameterName = "@PostalCode";
    param.Value = local.PostalCode;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @Note
    param = comm.CreateParameter();
    param.ParameterName = "@Note";
    param.Value = local.Note;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @ModifiedDateLocation  
    param = comm.CreateParameter();
    param.ParameterName = "@ModifiedDateLocation";
    param.Value = DateTime.Now;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    // need to split up the SP to add the company here 
    // execute company SP here
    // and get back the companyID
    // can just clear out the parameters and reuse it
    comm.Parameters.Clear();

    //and you can just define the parameters once
    //create new parameter @LabelContactTypeID
    paramTypeID = comm.CreateParameter();
    paramTypeID.ParameterName = "@LabelContactTypeID";       
    paramTypeID.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(paramTypeID);

    //Company Info
    foreach (var c in contact)
    {
        //create new parameter @LabelContactTypeID
        paramTypeID.Value = c.LabelContactTypeID;

        //create new parameter @ContactDetails
        param = comm.CreateParameter();
        param.ParameterName = "@ContactDetails";
        param.Value = c.ContactDetail;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

        //create new parameter @Status
        param = comm.CreateParameter();
        param.ParameterName = "@Status";
        param.Value = c.Status;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

        //create new parameter @Notes
        param = comm.CreateParameter();
        param.ParameterName = "@Notes";
        param.Value = c.Notes;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

        try
        {
             if (GenericDataAccess.ExecuteNonQuery(comm) == -1) return false;
             // this syntax is not what I am used to
             // i useally just comm.ExecuteNonQuer();
        }
        catch
        {
            return false;
        }
    }
    return true;    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:04:52.860

您的存储过程只为公司插入一个联系人。如果您想添加另一个联系人（或更多联系人），请编写另一个过程，该过程将使用插入数据库的最后一个公司的 CompanyID 插入新联系人。

我无法为您编写代码，因为我不知道表格并且无法复制结果，但是您应该使用此代码创建另一个过程

```
INSERT INTO [TaskManagementSystem_DB].[dbo].[Company_Contacts]
           ([companyID] 

           ,[labelContactTypeID]
           ,[contactDetails]
           ,[status]
           ,[notes])
     VALUES
           (@CompanyID 
           ,@LabelContactTypeID
           ,@ContactDetails
           ,@Status
           ,@Notes) 
```

在第一部分中，只需从列表中添加一个联系人（列表中索引 0 上的第一个联系人）

读取刚刚插入的公司的 CompanyID 以及列表中的每个其他联系人，使用此 ID 调用您的新程序。它将使用相同的 companyID（引用身份一对多）添加引用到公司的新联系人。

**编辑**你应该做这样的事情：

```
public static bool AddNewCompany(Company company,List<Contacts> contact , Location local)
{
    // get a configured DbCommand object
    DbCommand comm = GenericDataAccess.CreateCommand();
//Set the store Proc name 
comm.CommandText = "AddNewCompany";

//create new parameter @CompanyName
DbParameter param = comm.CreateParameter();
param.ParameterName = "@CompanyName";
param.Value = company.CompanyName;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @CompanyDetail 
param = comm.CreateParameter();
param.ParameterName = "@CompanyDetail";
param.Value = company.CompanyDetail;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @ModifiedDate
param = comm.CreateParameter();
param.ParameterName = "@ModifiedDate";
param.Value = DateTime.Now;
param.DbType = DbType.DateTime;
comm.Parameters.Add(param);

    //Company Info
//add only one contact
    /create new parameter @LabelContactTypeID
        param = comm.CreateParameter();
        param.ParameterName = "@LabelContactTypeID";
        param.Value = contact[0].LabelContactTypeID;
        param.DbType = DbType.StringFixedLength;
        comm.Parameters.Add(param);

    //create new parameter @ContactDetails
    param = comm.CreateParameter();
    param.ParameterName = "@ContactDetails";
    param.Value = contact[0].ContactDetail;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @Status
    param = comm.CreateParameter();
    param.ParameterName = "@Status";
    param.Value = contact[0].Status;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

    //create new parameter @Notes
    param = comm.CreateParameter();
    param.ParameterName = "@Notes";
    param.Value = contact[0].Notes;
    param.DbType = DbType.StringFixedLength;
    comm.Parameters.Add(param);

//Company Info
//create new parameter @Address
param = comm.CreateParameter();
param.ParameterName = "@Address";
param.Value = local.Address;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @City
param = comm.CreateParameter();
param.ParameterName = "@City";
param.Value = local.City;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @Province
param = comm.CreateParameter();
param.ParameterName = "@Province";
param.Value = local.Province;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @PostalCode
param = comm.CreateParameter();
param.ParameterName = "@PostalCode";
param.Value = local.PostalCode;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @Note
param = comm.CreateParameter();
param.ParameterName = "@Note";
param.Value = local.Note;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

//create new parameter @ModifiedDateLocation  
param = comm.CreateParameter();
param.ParameterName = "@ModifiedDateLocation";
param.Value = DateTime.Now;
param.DbType = DbType.StringFixedLength;
comm.Parameters.Add(param);

try
{
    return (GenericDataAccess.ExecuteNonQuery(comm) != -1);

}
catch
{
    return false;
} 
```

}

创建一个新方法，使用我在此处粘贴的部分过程添加新联系人并插入所有其他联系人。将 companyID 传递给此方法。

# c# - 通过 WCF 服务发送消息来解耦 MSMQ

> ID：13422705
> 
> 赞同：2
> 
> 时间：2012-11-16T18:56:31.673
> 
> 标签：c#, wcf, architecture, error-handling, msmq

我有几个 .Net 应用程序（尚未构建）需要将错误消息、警告、警报、心跳等发送到数据库，以便可以在警报摘要仪表板中查看它们。这不会使应用程序减慢太多。它必须很快。我想要一种方法来确定某些消息的优先级，以便它们立即显示在仪表板中。

我认为 MSMQ 是要走的路，因为可能会有大量消息进入，您可以创建多个队列。

让我的应用程序将消息直接发送到 MSMQ 会更快吗？或者，使用 NetMSMQBinding 将它们发送到 WCF 服务会更快吗？

如果我将消息直接发送到 MSMQ，那么应用程序将与 MSMQ 紧密耦合，如果我以后想废弃 MSMQ 并使用其他东西，我会被搞砸的。我不想在每次警报摘要应用程序更改时对应用程序进行更改。

如果我使用 NetMSMQBinding 将消息发送到 WCF 服务，那么我仍然将我的应用程序与 MSMQ 紧密耦合，对吗？

这个警报摘要应用程序可能很大，影响整个系统中的每个应用程序，并且必须正确完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:25:22.610

如果您希望避免与 MSMQ 紧密耦合，我建议您使用类似于本地总线抽象的东西，它接收消息，然后以您希望的任何方式将其发送到 MSMQ。这样，您总是可以插入一个不同的实现来使用您想要的任何东西（RabbitMQ、一些直接的数据库持久性或您可能想到的任何东西）。否则，我个人会尽量减少消息处理的成本和尽可能短的时间。您可能还想查看有关[msmq 性能的文章，例如 this](http://www.devx.com/enterprise/Article/22314)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:19:02.270

我刚刚为我工作的公司完成了一个与您类似的大型项目。

它完全依赖于 WCF，使用 NetTcpBinding 并将所有信息保存在 Sql Server 数据库中。

主要的 WCF 服务负责将信息持久化到数据库中。其他 wcf 服务将数据返回给需要它的客户（挂在我们墙上的 32 英寸触摸屏、桌面小工具、智能手机）。

有一个公共库，其中包含合同定义和所有客户端相关的东西，这里的所有应用程序都使用这些东西（10+）。所有这些应用程序都针对 wcf 服务记录所有内容（始终处于异步操作中）：异常、警告、心跳，甚至调试信息。这里的客户端数量并不多，大约有 60 台电脑同时运行 1 或 2 个应用程序。

仪表板是一个 WPF 应用程序，它不断联系 wcf 服务以了解是否有基于优先级的更新，然后在漂亮的 UI 中显示它们。

在 60 多个客户端之间，我们有 15 个 RTU，它们将来自 3 个不同城市的天然气管道的温度 (ºC) 和压力 (bars) 发送到同一服务器，此信息由 windows 服务通过 Tcp 接收，然后发送到 wcf 服务（在同一台服务器上）。所有这些数据都很关键！！我们甚至还有另一个 Windows 服务，它不断查询 wcf 服务以查找重要事件并向与该类型事件相关的人员发送 SMS。

太棒了，IMO wcf 是实现您目标的绝佳技术！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T21:40:03.203

不可能将自己完全与技术选择的后果隔离开来，并且在某些时候尝试这样做，您将获得递减的回报。

我知道我们都被教导要不惜一切代价避免耦合，就像它是某种疾病一样，但首先使用 WCF 的好处之一是您不会硬耦合到特定的传输。您可以仅通过配置更改将 MSMQ 换成 TCP。

正如@nieve 所建议的那样，通过创建抽象，您确实将自己与实现细节（在本例中为 WCF）解耦。但是，将自己与抽象总线表示耦合是否更好？*您可能会获得更少的“耦合”，但可以说是以更大的混淆*为代价。

通过 WCF 调用 MSMQ 的好处是它的代码量很少，并且可以很容易地被其他开发人员以几乎零分析开销的方式获取。我会胆怯地建议您可能正在过度设计一个实际上并不存在的问题的解决方案。

想想在 12 个月内新加入您项目的开发人员。你想建立一个系统，他们不会在前两个月*学习*它，然后才能提高工作效率。使用旨在在某种程度上解耦您的熟悉框架可能会在某种程度上实现这一目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T00:44:35.183

在我的测试中，WCF 和 NetTcpBinding 非常快（往返时间 < 1ms）。
通过使用异步，您可以避免在某些连接失败时锁定应用程序。
[AsyncWcfLib](http://sourceforge.net/apps/mediawiki/asyncwcflib/index.php?title=Main_Page)可以帮助提升抽象级别。

# events - java fx 在线事件处理

> ID：13422706
> 
> 赞同：1
> 
> 时间：2012-11-16T18:56:32.757
> 
> 标签：events, line, javafx-2

我发现了一篇关于 JavFx2 和关于这个的非常有趣的文章

[http://docs.oracle.com/javafx/2/events/handlers.htm](http://docs.oracle.com/javafx/2/events/handlers.htm)

我想知道如何创建一个扩展线条特征的对象，以便插入事件管理。

例如，单击鼠标左键，鼠标左键单击绘制的线，或在鼠标悬停线（选定线）时从键盘按canc键，或鼠标左键单击线外？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-10T12:47:14.090

这是使用 JavaFX 时反复出现的问题。目前，我正在用不可见的厚对应物覆盖所有薄视觉效果，并在厚视觉效果上注册事件侦听器。

例如，您有一个由多个线段组成的连接：

```
// construct invisible fat lines for selection
selectionLines.getChildren().clear();
for (Node child : connection.getChildren()) {
    Line line = (Line) child;
    Line selLine = new Line(line.getStartX(), line.getStartY(), line.getEndX(), line.getEndY());
    selLine.setLayoutX(line.getLayoutX());
    selLine.setLayoutY(line.getLayoutY());
    selLine.setStrokeWidth(SELECTION_LINE_WIDTH);
    selLine.setStroke(INVISIBLE);
    selectionLines.getChildren().add(selLine);
}
connection.getChildren().add(selectionLines); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T09:50:30.293

我刚刚遇到了同样的问题。

我想要一个“绘图面板”，我可以在其中放置可拖动的辅助线。您可以通过 'setOnMousePressed' 和 'setOnMouseDragged' 附加 MouseHandler 以获得此类行为。

但最大的问题是，线条尺寸太小了，你必须很幸运才能用鼠标击中它。

这就是为什么我以相反的方式实现它。我在绘图面板上附加了一个鼠标处理程序，每次单击鼠标时，我都会检查鼠标光标是否在任何辅助线附近。这让我有机会添加一点容差，因此可以单击和拖动线条。

我不能说这是否是最有效的方法，如果其他人提出更好的想法，我会很高兴。

> **编辑：** 同时我写了一个小测试，发现我的第一个想法不是那么好。
> 
> 我的第二个想法是将线包裹在一个窗格中并将它的 y 坐标（对于垂直线）放在该窗格内。在该窗格中，我设置了鼠标处理程序。而且由于我使窗格的首选高度为 5 像素，因此鼠标光标现在有足够的容差来捕捉该行。
> 
> 如果有人对此想法感兴趣，我可以发布一些示例代码。

问候，-克里斯-

# c# - 语音识别挂在 ApiController

> ID：13422708
> 
> 赞同：0
> 
> 时间：2012-11-16T18:56:54.533
> 
> 标签：c#, model-view-controller, speech-recognition

我有一个使用 mvc 的服务，在这种情况下，我有一个控制器正在实现 apicontroler，我从另一个项目调用一个帖子并将其传递给一个流。然后我得到字符串并处理它。这个方法运行并返回正确的值，但是我在调​​用它的地方没有得到任何东西。看起来它正在工作，但没有任何反应。

这是代码。

```
result = new List<string>(); 
Stream stream = new MemoryStream(); 
Task loadingStream = (Request.Content as StreamContent).CopyToAsync(stream);

loadingStream.Wait();

stream.Position = 0;

SpeechRecognitionEngine _appRecognizer = new SpeechRecognitionEngine(new CultureInfo("en-US"));

_appRecognizer.SpeechRecognized += new EventHandler<SpeechRecognizedEventArgs>(SpeechRecognized);

_appRecognizer.SetInputToWaveStream(stream);

_appRecognizer.LoadGrammar(new Grammar(@"C:\Users\Thomas\Desktop\grammar1.srgs")); 
RecognitionResult recognitionResult = _appRecognizer.Recognize();

_appRecognizer.SpeechRecognized -= SpeechRecognized;

return recognitionResult != null ? recognitionResult.Text : null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T21:30:03.243

您是否调用了 _appRecognizer.RecognizerAsync()？[在这里](http://msdn.microsoft.com/en-us/library/system.speech.recognition.speechrecognitionengine.aspx)查看文档。

# c# - 从格式化字符串中提取电话号码正则表达式

> ID：13422714
> 
> 赞同：0
> 
> 时间：2012-11-16T18:57:22.960
> 
> 标签：c#, .net, regex, phone-number

鉴于电话号码都是这种格式：

```
(999) 999-9999 Ext.9999" 
```

我想将所有内容都返回到第二个空间，例如：

```
(999) 999-9999 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T19:01:07.817

如果您的字符串在 s 中：

```
 string s = "(999) 999-9999 Ext.9999";
   string number = s.Split(" Ext")[0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T19:02:22.960

如果你想要一个完美的匹配，你可以使用这个表达式：

```
string s = "(999) 999-9999 Ext.9999";
Match m = Regex.Match(s, @"(?<nr>\([0-9]{3}\)\s+[0-9]{3}\-[0-9]{4})");
if (m.Groups["nr"].Success)
{
    Console.WriteLine(m.Groups["nr"].Value);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T18:58:56.873

不要使用正则表达式。使用[`Split()`](http://msdn.microsoft.com/en-us/library/b873y76a.aspx). 然后将前两个元素重新连接在一起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T19:06:59.137

其中`s`包含完整的刺痛。如果真的“全部采用这种格式” ，*那么*您可以只取前 14 个字符：

```
string number = s.SubString(0, 14); 
```

或者更灵活、更安全：

```
var idx = s.IndexOf(" Ext");
//good idea to check if idx == -1
string number = s.SubString(0, idx); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T19:07:46.253

看看这个：

```
 string s = "(999) 999-9999 Ext.9999";
    string phonenumber1 = Regex.Replace(s, @"(?i)\s*ext\.\d+", ""); 
```

# ruby-on-rails - MacVIM 7.3 抛出错误

> ID：13422718
> 
> 赞同：0
> 
> 时间：2012-11-16T18:57:41.307
> 
> 标签：ruby-on-rails, macvim

我最近在我的 mac (MacOs 10.6.8) 上安装了 MacVim 7.3，现在当我输入 Vim 时，我收到了这个错误。我还安装了这个 git：`git://github.com/akitaonrails/vimfiles.git .vim`

```
E254: Cannot allocate color Red
E254: Cannot allocate color White
E254: Cannot allocate color Blue
E254: Cannot allocate color Red
E254: Cannot allocate color Grey
E254: Cannot allocate color Blue
E254: Cannot allocate color Brown
E254: Cannot allocate color SeaGreen
E254: Cannot allocate color SeaGreen
E254: Cannot allocate color Yellow
E254: Cannot allocate color Red
E254: Cannot allocate color Blue
E254: Cannot allocate color Magenta
E254: Cannot allocate color DarkCyan
E254: Cannot allocate color LightMagenta
E254: Cannot allocate color Grey
E254: Cannot allocate color Blue
E254: Cannot allocate color Magenta
E254: Cannot allocate color Red
E254: Cannot allocate color Yellow
E254: Cannot allocate color Black
E254: Cannot allocate color LightGrey
E254: Cannot allocate color DarkBlue
E254: Cannot allocate color Grey
E254: Cannot allocate color DarkBlue
E254: Cannot allocate color Grey
E254: Cannot allocate color DarkBlue
E254: Cannot allocate color LightGrey
E254: Cannot allocate color LightBlue
E254: Cannot allocate color LightMagenta
E254: Cannot allocate color Blue
E254: Cannot allocate color LightCyan
E254: Cannot allocate color LightGrey
E254: Cannot allocate color Grey90
E254: Cannot allocate color Grey90
E254: Cannot allocate color LightRed
E254: Cannot allocate color DarkGrey
E254: Cannot allocate color LightGrey
E254: Cannot allocate color Cyan
Error detected while processing /Users/myusername/.vimrc:
line  216:
E484: Can't open file /Applications/MacVim.app/Contents/MacOs/vim/runtime/syntax/syntax.vim
line  266:
E185: Cannot find color scheme default
line  314:
E484: Can't open file /Users/myusername/vimfiles/snippets/support_functions.vim 
```

有人遇到过同样的问题并有解决方法吗？

谢谢

# php - sprintf 使用输入文本框中的值更新数量

> ID：13422720
> 
> 赞同：0
> 
> 时间：2012-11-16T18:58:06.807
> 
> 标签：php, mysql

如果我有

```
$updateSQL = sprintf("UPDATE stuffntory SET `youwho`=%s, stock=stock -1, list=%s WHERE something=%s", 
```

而不是减号 -1 我想拥有由文本框输入的 -Quantity

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:04:04.643

更新您的格式以使用*数量*`sprintf()`占位符。假设*数量*是一个整数：

 **```
sprintf("UPDATE stuffntory SET `youwho`=%s, stock=stock - %d, list=%s WHERE something=%s", ...) 
```**

# python - Sphinx中toctree的显式标题

> ID：13422729
> 
> 赞同：1
> 
> 时间：2012-11-16T18:59:00.103
> 
> 标签：python, python-sphinx, toctree

我试图在我的`toctree`. 文档说应该是这样的：

```
.. toctree::

    All about strings <string> 
```

但它只打印 string.rst 文档中内容的标题，而不是“关于字符串的全部内容”。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:17:20.740

我可以用 Sphinx 1.1.2 确认这一点。这似乎是一个错误，可能是[问题 #86](https://bitbucket.org/birkenfeld/sphinx/issue/86)的回归。这个问题显然在[0.5.2](http://sphinx-doc.org/changes.html#release-0-5-2-mar-24-2009)中得到了修复，但似乎已经找到了解决办法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T16:52:59.523

根据 Lukas Graf 的回答，sphinx 1.1.2 有你的确切问题。我用 1.1.3 试了一下：没问题。（在 python 2.7，osx 上）。

[我在Sphinx 的 1.1.3 变更日志](http://sphinx-doc.org/changes.html#release-1-1-3-mar-10-2012)中没有看到任何具体内容，尽管提到了“恢复与 docutils trunk 的兼容性”。这表明另一个 docutils 版本*可以*帮助您。我正在使用版本`0.9`。

所以： sphinx`1.1.3`和 docutils `0.9`，你能试试这些版本吗？

# macos - 在 Mac 上以伪分布式模式设置 Hadoop

> ID：13422730
> 
> 赞同：0
> 
> 时间：2012-11-16T18:59:01.303
> 
> 标签：macos, hadoop, installation

我目前正在尝试在运行 Mountain Lion 的 Mac 上以伪分布式模式设置 Hadoop。我下载了 Hadoop 1.0.4 并采取了以下步骤，详见 Chuck Lam 的“Hadoop in Action”：

1）生成SSH密钥对：我跑`ssh-keygen -t rsa`生成了一对，没有设置密码。我将密钥放在 /Users/me/.ssh/id_rsa.pub 中。然后我将此文件复制到 ~/.ssh/authorized_keys。这允许我在不提供密码的情况下从我自己的机器 SSH 到我自己的机器。

2) 设置 JAVA_HOME：我修改了 conf/hadoop-env.sh 为 include `export JAVA_HOME=/Library/Java/Home`，我相信这是我的 Java 安装目录。（作为参考，此目录包含 bin、bundle、lib 和 man。）

3）设置站点配置文件：我复制粘贴了书中建议的配置。它们是：core-site.xml

```
<!-- Put site-specific property overrides in this file. -->

<configuration>

<property>
 <name>fs.default.name</name>
 <value>hdfs://localhost:9000</value>
 <description>The name of the default file system. A URI whose
 scheme and authority determine the FileSystem implementation. 
</description>
</property>

</configuration> 
```

mapred-site.xml

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<!-- Put site-specific property overrides in this file. -->

<configuration>

<property>
 <name>mapred.job.tracker</name>
 <value>localhost:9001</value>
 <description>The host and port that the MapReduce job tracker runs
 at.</description>
</property>

</configuration> 
```

hdfs-site.xml

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

 <!-- Put site-specific property overrides in this file. -->

<configuration>

<property>
 <name>dfs.replication</name>
 <value>1</value>
 <description>The actual number of replications can be specified when the
 file is created.</description>
</property>

</configuration> 
```

4）设置master和slave。我的 conf/masters 和 conf/slaves 文件只包含 localhost。

5）格式化HDFS：`bin/hadoop namenode -format`我得到以下输出：

```
12/11/16 13:20:12 INFO namenode.NameNode: STARTUP_MSG: 
/************************************************************
STARTUP_MSG: Starting NameNode
STARTUP_MSG:   host = dhcp-18-111-53-8.dyn.mit.edu/18.111.53.8
STARTUP_MSG:   args = [-format]
STARTUP_MSG:   version = 1.0.4
STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.0 -r 1393290; compiled by 'hortonfo' on Wed Oct  3 05:13:58 UTC 2012
************************************************************/
Re-format filesystem in /tmp/hadoop-me/dfs/name ? (Y or N) Y
12/11/16 13:20:17 INFO util.GSet: VM type       = 64-bit
12/11/16 13:20:17 INFO util.GSet: 2% max memory = 39.83375 MB
12/11/16 13:20:17 INFO util.GSet: capacity      = 2^22 = 4194304 entries
12/11/16 13:20:17 INFO util.GSet: recommended=4194304, actual=4194304
12/11/16 13:20:17 INFO namenode.FSNamesystem: fsOwner=me
12/11/16 13:20:18 INFO namenode.FSNamesystem: supergroup=supergroup
12/11/16 13:20:18 INFO namenode.FSNamesystem: isPermissionEnabled=true
12/11/16 13:20:18 INFO namenode.FSNamesystem: dfs.block.invalidate.limit=100
12/11/16 13:20:18 INFO namenode.FSNamesystem: isAccessTokenEnabled=false accessKeyUpdateInterval=0 min(s), accessTokenLifetime=0 min(s)
12/11/16 13:20:18 INFO namenode.NameNode: Caching file names occuring more than 10 times 
12/11/16 13:20:18 INFO common.Storage: Image file of size 119 saved in 0 seconds.
12/11/16 13:20:18 INFO common.Storage: Storage directory /tmp/hadoop-me/dfs/name has been successfully formatted.
12/11/16 13:20:18 INFO namenode.NameNode: SHUTDOWN_MSG: 
/************************************************************
SHUTDOWN_MSG: Shutting down NameNode at dhcp-18-111-53-8.dyn.mit.edu/18.111.53.8
************************************************************/ 
```

6）启动：`bin/start-all.sh`我得到以下输出：

```
starting namenode, logging to /Users/me/hadoop-1.0.4/libexec/../logs/hadoop-me-namenode-dhcp-18-111-53-8.dyn.mit.edu.out
localhost: starting datanode, logging to /Users/me/hadoop-1.0.4/libexec/../logs/hadoop-me-datanode-dhcp-18-111-53-8.dyn.mit.edu.out
localhost: starting secondarynamenode, logging to /Users/me/hadoop-1.0.4/libexec/../logs/hadoop-me-secondarynamenode-dhcp-18-111-53-8.dyn.mit.edu.out
starting jobtracker, logging to /Users/me/hadoop-1.0.4/libexec/../logs/hadoop-me-jobtracker-dhcp-18-111-53-8.dyn.mit.edu.out
localhost: starting tasktracker, logging to /Users/me/hadoop-1.0.4/libexec/../logs/hadoop-me-tasktracker-dhcp-18-111-53-8.dyn.mit.edu.out 
```

该文本现在声称我应该能够运行 jps 并获得类似于以下内容的输出：

```
26893 Jps
26832 TaskTracker
26620 SecondaryNameNode
26333 NameNode
26484 DataNode
26703 JobTracker 
```

但是，我只得到：

```
71311 Jps 
```

所以我认为出了点问题，但不知道我哪里出错了。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T05:40:42.157

Hadoop 日志会告诉你原因。

检查下的日志`/Users/me/hadoop-1.0.4/libexec/../logs/`

我认为问题可能是`.ssh`目录的权限不正确。

尝试`chmod 700 ~/.ssh; chmod 600 ~/.ssh/id_rsa`

# java - 使用一个命名错误的字段使 MongoDB 崩溃，它有什么特别之处？

> ID：13422736
> 
> 赞同：4
> 
> 时间：2012-11-16T18:59:28.190
> 
> 标签：java, mongodb

使用 Java 驱动程序，我们今天发现可能会因分段错误而导致 MongoDB 实例停机。

```
new Mongo().getDB("test").getCollection("test").
    insert(new BasicDBObject("\u0000Žö", "")); 
```

`mongod`这将在它死亡之前产生以下输出：

```
Fri Nov 16 18:53:18 Invalid access at address: 0xbac3c5fe from thread: conn5

Fri Nov 16 18:53:18 Got signal: 11 (Segmentation fault: 11).

Fri Nov 16 18:53:18 Backtrace:
0x10004241b 0x10005628b 0x100056941 0x7fff828afcfa 0x1 0x100281611 0x100288c91 0x10006c501 0x10058e50c 0x1005e31d3 0x7fff8285b8bf 0x7fff8285eb75 
 0   mongod                              0x000000010004241b _ZN5mongo15printStackTraceERSo + 43
 1   mongod                              0x000000010005628b _ZN5mongo10abruptQuitEi + 987
 2   mongod                              0x0000000100056941 _ZN5mongo24abruptQuitWithAddrSignalEiP9__siginfoPv + 673
 3   libsystem_c.dylib                   0x00007fff828afcfa _sigtramp + 26
 4   ???                                 0x0000000000000001 0x0 + 1
 5   mongod                              0x0000000100281611 _ZN5mongo14receivedInsertERNS_7MessageERNS_5CurOpE + 1841
 6   mongod                              0x0000000100288c91 _ZN5mongo16assembleResponseERNS_7MessageERNS_10DbResponseERKNS_11HostAndPortE + 4705
 7   mongod                              0x000000010006c501 _ZN5mongo16MyMessageHandler7processERNS_7MessageEPNS_21AbstractMessagingPortEPNS_9LastErrorE + 257
 8   mongod                              0x000000010058e50c _ZN5mongo3pms9threadRunEPNS_13MessagingPortE + 1084
 9   mongod                              0x00000001005e31d3 thread_proxy + 163
 10  libsystem_c.dylib                   0x00007fff8285b8bf _pthread_start + 335
 11  libsystem_c.dylib                   0x00007fff8285eb75 thread_start + 13 
```

我一直试图了解究竟是什么让这个神奇的领域名称变得特别。删除**任何**涉及的字符使 mongodb 生存得很好，堆栈跟踪并没有让我更聪明。

我已经写了一篇关于这个问题的简短[博客文章](http://jwdev.tumblr.com/post/35851221681/how-to-crash-mongodb-in-1-line-of-java)，并在 mongodb.org上提交了一张[JIRA 票，但我的好奇心正在扼杀我。](https://jira.mongodb.org/browse/SERVER-7691)谁能弄清楚是什么让`\u0000Žö`特别？

**编辑澄清**：很好`\u0000`，`\u0000Ž`所以`\u0000Žsomerandomtext`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:07:54.500

它无法正常工作的原因是 unicode 文字语句被破坏的方式。可能有这种可能性，即 java 驱动程序没有正确检查可能性，unicode 文字语句中可能有 unicode ;) 在 mongo shell 上使用这样的键创建对象（复制到基于 UTF8 的终端）会引发错误：`BSONElement: bad type -59`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:32:49.067

Java `String`s 只能以 ASCII 编码表示，要获得 unicode 文字，您必须获取每个 unicode 代码并构建字符串：

```
String unicode = "\u1123\u5678hello"; 
```

将导致：

```
ᄣ噸hello 
```

# ruby-on-rails - Ruby on Rails：从数据库中提取文件，分析它，结果保存在数据库中

> ID：13422742
> 
> 赞同：0
> 
> 时间：2012-11-16T18:59:51.333
> 
> 标签：ruby-on-rails

我正在使用[这个文件上传示例](https://github.com/tors/jquery-fileupload-rails-paperclip-example)来上传数据库中的一些文件。我有一个带有 r-script 的 rruby.rb，它对文件（命名为 A）进行统计分析，因此它在文件 A 所在的目录中保存了一个绘图。我需要的是从数据库中提取文件，进行分析并将绘图保存回数据库。我应该将 rruby.rb 的代码放在哪里？在[uploads_controller](https://github.com/tors/jquery-fileupload-rails-paperclip-example/blob/master/app/controllers/uploads_controller.rb)，[upload.rb](https://github.com/tors/jquery-fileupload-rails-paperclip-example/blob/master/app/models/upload.rb)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:22:00.480

我会将`rruby.rb`文件分开并按原样使用。但是该文件放在哪里呢？

有两个同样有效的选项。要么放在`lib`文件夹里，要么放在`models`文件夹里。

`lib`如果我考虑到更通用的代码和我碰巧需要的代码，我会将它放在文件夹中。代码输入`lib`是最终可以变成宝石的代码。这是我认为与任何业务代码或模型完全无关的代码。

如果代码与我的业务领域和其他模型密切相关。

因此，在您的情况下，我会将`rruby`文件放在`lib`文件夹中，因为（如果我理解正确的话）它包含一个非常独立的过程，不依赖于其余代码，只需要一个文件作为输入，并将生成一个文件作为输出。

`rruby`保持代码分离的另一个优点是您也可以单独测试它。

希望这可以帮助。

[编辑：添加示例实现]

我认为你`rruby`是一个简单的脚本，所以你把它包装在一个模块中，因为它执行我称之为统计分析`Statistical`，但你应该给它一个更合适的名字

所以在`lib/statistical.rb`写

```
module Statistical

  def self.do_analysis(file_to_analyse)
    # .. do a lot of stuff and return a result-file
  end
end 
```

然后在您的上传控制器或上传模型中，您执行类似的操作

```
result_file = Statistical.do_analysis(uploaded_file) 
```

通常，其中的所有文件都会`lib`自动添加到 rails load-path，所以这就是你需要做的。

# linux - 将时间跨度（以秒为单位）转换为 shell 中的格式化时间

> ID：13422743
> 
> 赞同：36
> 
> 时间：2012-11-16T18:59:53.250
> 
> 标签：linux, shell, timespan, date-formatting

我有一个 $i 变量，它在 shell 脚本中是秒，我正在尝试将其转换为 24 HOUR HH:MM:SS。这可能在shell中吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-11-16T19:17:51.123

这是一个有趣的hacky方式来做你正在寻找的东西=）

```
date -u -d @${i} +"%T" 
```

**解释：**

*   该`date`实用程序允许您从字符串指定时间，以 1970-01-01 00:00:00 UTC 以来的秒数为单位，并以您指定的任何格式输出。
*   选项是显示`-u`UTC 时间，因此它不考虑时区偏移（因为 1970 年的开始时间是 UTC）
*   以下部分是 GNU特定的`date`(Linux)：
    *   该`-d`部分告诉`date`接受来自字符串的时间信息，而不是使用`now`
    *   这`@${i}`部分是你如何告诉`date`它`$i`是在几秒钟内
*   `+"%T"`用于格式化输出。从`man date`页面：`%T time; same as %H:%M:%S`。因为我们只关心`HH:MM:SS`零件，所以这很合适！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-16T23:16:08.967

另一种方法：算术

```
i=6789
((sec=i%60, i/=60, min=i%60, hrs=i/60))
timestamp=$(printf "%d:%02d:%02d" $hrs $min $sec)
echo $timestamp 
```

生产`1:53:09`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-02-17T06:48:21.073

该`-d`论点仅适用于`coreutils`(Linux) 的日期。

在 BSD/OS X 中，使用

```
date -u -r $i +%T 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T19:17:47.090

如果`$i`表示自纪元以来第二个日期，您可以使用

```
 date -u -d @$i +%H:%M:%S 
```

但是您似乎认为这`$i`是一个间隔（例如某个持续时间）而不是日期，然后我不明白您想要什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-07T13:43:36.123

这是我网站上的算法/脚本助手： [http:](http://ram.kossboss.com/seconds-to-split-time-convert/) //ram.kossboss.com/seconds-to-split-time-convert/ 我从这里使用了这个优雅的算法：[将秒转换为小时、分钟、秒](https://stackoverflow.com/questions/12199631/convert-seconds-to-hours-minutes-seconds-in-bash)

```
convertsecs() {
 ((h=${1}/3600))
 ((m=(${1}%3600)/60))
 ((s=${1}%60))
 printf "%02d:%02d:%02d\n" $h $m $s
}
TIME1="36"
TIME2="1036"
TIME3="91925"

echo $(convertsecs $TIME1)
echo $(convertsecs $TIME2)
echo $(convertsecs $TIME3) 
```

我的秒到日、时、分、秒转换器的示例：

```
# convert seconds to day-hour:min:sec
convertsecs2dhms() {
 ((d=${1}/(60*60*24)))
 ((h=(${1}%(60*60*24))/(60*60)))
 ((m=(${1}%(60*60))/60))
 ((s=${1}%60))
 printf "%02d-%02d:%02d:%02d\n" $d $h $m $s
 # PRETTY OUTPUT: uncomment below printf and comment out above printf if you want prettier output
 # printf "%02dd %02dh %02dm %02ds\n" $d $h $m $s
}
# setting test variables: testing some constant variables & evaluated variables
TIME1="36"
TIME2="1036"
TIME3="91925"
# one way to output results
((TIME4=$TIME3*2)) # 183850
((TIME5=$TIME3*$TIME1)) # 3309300
((TIME6=100*86400+3*3600+40*60+31)) # 8653231 s = 100 days + 3 hours + 40 min + 31 sec
# outputting results: another way to show results (via echo & command substitution with         backticks)
echo $TIME1 - `convertsecs2dhms $TIME1`
echo $TIME2 - `convertsecs2dhms $TIME2`
echo $TIME3 - `convertsecs2dhms $TIME3`
echo $TIME4 - `convertsecs2dhms $TIME4`
echo $TIME5 - `convertsecs2dhms $TIME5`
echo $TIME6 - `convertsecs2dhms $TIME6`

# OUTPUT WOULD BE LIKE THIS (If none pretty printf used): 
# 36 - 00-00:00:36
# 1036 - 00-00:17:16
# 91925 - 01-01:32:05
# 183850 - 02-03:04:10
# 3309300 - 38-07:15:00
# 8653231 - 100-03:40:31
# OUTPUT WOULD BE LIKE THIS (If pretty printf used): 
# 36 - 00d 00h 00m 36s
# 1036 - 00d 00h 17m 16s
# 91925 - 01d 01h 32m 05s
# 183850 - 02d 03h 04m 10s
# 3309300 - 38d 07h 15m 00s
# 1000000000 - 11574d 01h 46m 40s 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-24T09:18:57.663

我使用 C shell，如下所示：

```
#! /bin/csh -f

set begDate_r = `date +%s`
set endDate_r = `date +%s`

set secs = `echo "$endDate_r - $begDate_r" | bc`
set h = `echo $secs/3600 | bc`
set m = `echo "$secs/60 - 60*$h" | bc`
set s = `echo $secs%60 | bc`

echo "Formatted Time: $h HOUR(s) - $m MIN(s) - $s SEC(s)" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-13T15:02:25.187

继续@Daren 的回答，只是为了清楚一点：如果您想使用转换为**您的时区**，**请不要使用“u”开关**，如：`date -d @$i +%T`或在某些情况下`date -d @"$i" +%T`。

# maven - 什么是 m2e 连接器？

> ID：13422744
> 
> 赞同：11
> 
> 时间：2012-11-16T18:59:54.063
> 
> 标签：maven, m2e

我想知道m2e连接器是什么。除了这个页面，我在互联网上没有找到太多描述它们的内容：

[http://objectledge.org/confluence/display/TOOLS/M2E+Connectors](http://objectledge.org/confluence/display/TOOLS/M2E+Connectors)

所以我的问题是：

*   它是像任何 Eclipse 插件一样的插件吗？
*   它可以用来做什么？
*   是否有任何页面解释我如何使用它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-27T09:44:34.403

是的，它是一个 Eclipse 插件。它充当了一个 Maven 插件和 Eclipse 之间的桥梁。基本上它用于三件事：

*   根据pom配置配置eclipse项目，
*   自动刷新由您的构建修改的资源，
*   提供增量构建（如果正确完成......）

对于常见的插件，您可以在导入 maven 项目时安装它，或者通过快速修复。

[一些文档](https://www.eclipse.org/m2e/documentation/m2e-execution-not-covered.html)，尽管它更面向 m2e 连接器的开发。

# php - 保持 LDAP 会话

> ID：13422746
> 
> 赞同：5
> 
> 时间：2012-11-16T18:59:55.963
> 
> 标签：php, session, ldap, bind

在 PHP 中，假设我在第 1 页上有一个 LDAP 连接：

```
$ldapconn = ldap_connect($ldapserver);
if ($ldapconn) {
      // binding to ldap server
      $ldapbind = ldap_bind($ldapconn, $ldaprdn, $ldappass);
}
// do stuff here 
```

假设一切顺利并且我能够实际做一些事情，我怎样才能保存这个绑定，以便当用户点击第二页时，我不需要再次使用他们的用户名/密码执行 ldap_bind。本质上，如果出于安全目的可以避免，我不想将密码存储在会话中，但我想保持连接，以便我可以在其他页面上重复使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:13:38.373

PHP LDAP 不支持持久连接。根据您正在执行的 LDAP 查询类型和频率，您始终可以设置一个数据库，以加密状态存储用户名/密码，然后将 ID 保留在会话中的该记录中（**存储不是一个好主意用户名/密码**）。类似于[这里](https://stackoverflow.com/a/1737218/861974)的回答。如果您扩展您正在尝试做的事情，也许会帮助我们指导您更好地完成它。如果它只是用于验证登录，那么一旦它们通过 LDAP 验证，您就可以在会话中输入一个值，表明它们已经过验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:16:02.593

我过去所做的是，如果您可以控制 LDAP 服务器，是否拥有一个只有读取权限的“查询”用户。您将其作为全局存储在配置文件或数据库中，并在您需要进行简单查询时与此帐户进行所有绑定，并且仅在初始身份验证时使用用户名和密码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-16T19:17:55.043

另一种解决方案不是重新检查他们是否已登录，而是创建一个 cookie 或会话，其中包含一些告诉您用户已登录的字符串。

然后在新页面上验证该会话是否存在。添加一个超时，这样如果 10 分钟内没有更新，登录的 cookie 就会过期。

# c - 使用单个 AVX 内在函数反转包含双精度的 AVX 寄存器

> ID：13422747
> 
> 赞同：4
> 
> 时间：2012-11-16T18:59:56.387
> 
> 标签：c, sse, vectorization, simd, avx

如果我有一个 AVX 寄存器，其中有 4 个双精度数，并且我想将其反转存储在另一个寄存器中，是否可以使用单个内部命令来执行此操作？

例如：如果我在 SSE 寄存器中有 4 个浮点数，我可以使用：

```
_mm_shuffle_ps(A,A,_MM_SHUFFLE(0,1,2,3)); 
```

我可以这样做`_mm256_permute2f128_pd()`吗？我认为您不能使用上述内在函数来解决每个单独的双重问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-16T19:42:17.350

您实际上需要 2 个排列来执行此操作：

*   `_mm256_permute2f128_pd()`仅在 128 位块中置换。
*   `_mm256_permute_pd()`不会跨 128 位边界置换。

所以你需要同时使用：

```
inline __m256d reverse(__m256d x){
    x = _mm256_permute2f128_pd(x,x,1);
    x = _mm256_permute_pd(x,5);
    return x;
} 
```

测试：

```
int main(){
    __m256d x = _mm256_set_pd(13,12,11,10);

    cout << x.m256d_f64[0] << "  " << x.m256d_f64[1] << "  " << x.m256d_f64[2] << "  " << x.m256d_f64[3] << endl;
    x = reverse(x);
    cout << x.m256d_f64[0] << "  " << x.m256d_f64[1] << "  " << x.m256d_f64[2] << "  " << x.m256d_f64[3] << endl;
} 
```

输出：

```
10  11  12  13
13  12  11  10 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-13T09:32:54.327

**AVX2**新增了对粒度更细的 128 位的车道交叉洗牌的支持：

```
_mm256_permute4x64_pd(vec, _MM_SHUFFLE(0,1,2,3));  // i.e. 0b00011011 
```

[`VPERMPD ymm1, ymm2/m256, imm8`](https://www.felixcloutier.com/x86/vpermpd)`VPERM2F128`以与英特尔 CPU 上的其他通道交叉洗牌（如 ）相同的吞吐量和延迟运行。也在[内在函数查找器](https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html#techs=MMX,SSE,SSE2,SSE3,SSSE3,SSE4_1,SSE4_2,AVX,AVX2,Other&text=vpermp&ig_expand=4405,5863)中。

在 AMD Zen1（和[Excavator](http://users.atw.hu/instlatx64/AuthenticAMD0660F01_K15_Carrizo_InstLatX64.txt)）上，`vpermpd`比 2-input 更快`vperm2f128`。它们的向量 ALU 内部只有 128 位宽；256 位向量指令被解码为至少 2 个微指令，但车道交叉操作需要更多，尤其是可以读取 4 个总车道中的任何一个的操作。（不幸的是，解码器在为 vperm2f128 选择 uops 时不仅仅查看直接位）。Manual `vextractf128`/`vinsertf128`会比`vperm2f128`Bulldozer-family 和 Zen1 更好，但在其他任何地方都会很糟糕。[https://uops.info/](https://uops.info/)。我认为`vpermpd`在 Excavator / Zen1 上是最佳的，3 uops 与至少 4 到车道内倒车，然后用`vextracti128`/交换一半`vinsert128`。

* * *

有一些 CPU 带有 FMA3 而不是 AVX2，例如 AMD Piledriver 和 Steamroller。在 Intel 上，AVX2 和 FMA 都是 Haswell 的新功能。AMD Bulldozer 系列已过时，但仍在家用计算机中，因此即使您的功能利用 AVX1 + FMA，您的选择也是需要 AVX2 并让这少数 CPU 退回到更糟糕的东西（例如，没有 FMA 的 AVX1） ，或制作另一个版本的函数。

# c# - 为什么我的 Grid Tapped 事件没有被调用？

> ID：13422748
> 
> 赞同：9
> 
> 时间：2012-11-16T19:00:00.097
> 
> 标签：c#, windows-8, winrt-xaml, windows-store-apps, grid-layout

确实，我实际上并没有在模拟器中点击——因为我的开发机器没有启用触摸功能——但我认为这不是问题，因为我在网格中的点击应该会触发事件。

这是我的xml：

```
<Grid x:Name="grid1" Margin="24,0,0,0" Grid.Row="1" Tapped="Grid_OnTapped"> 
```

...和我的代码：

```
private void Grid_OnTapped(object sender, TappedRoutedEventArgs args)
{
     if (args.OriginalSource.Equals(grid1))
     {
    . . . 
```

我从来没有参加过 Grid_OnTapped 活动。我错过了什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-18T18:03:40.197

设置`Background="Transparent"`在您的`Grid`.

# jquery - jQuery - 使用服务器生成的 id 查找 html 元素

> ID：13422749
> 
> 赞同：3
> 
> 时间：2012-11-16T19:00:00.600
> 
> 标签：jquery, html

我有这个元素需要在 DOM 中找到，其 id 为：

```
ctl00_Spwebpartmanager1_g_0dff8583_314d_412f_8be7_ad019dd61cf3_ctl00__socialSecurityNumber 
```

我如何掌握它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:02:33.923

您可以尝试以下内容

```
$('[id$="socialSecurityNumber"]'); 
```

$= 表示属性以指定的字符串结尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:03:42.147

您可以将令牌输出到 javascript var，然后将其用作标识符吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T19:13:11.477

```
document.getElementById("ctl00_Spwebpartmanager1_g_0dff8583_314d_412f_8be7_ad019dd61cf3_ctl00__socialSecurityNumber") 
```

如果你想使用 jQuery 来处理它，你可以这样做：

```
$("#ctl00_Spwebpartmanager1_g_0dff8583_314d_412f_8be7_ad019dd61cf3_ctl00__socialSecurityNumber") 
```

# ruby-on-rails - Rails ActiveAdmin：在同一视图中显示相关资源的表

> ID：13422751
> 
> 赞同：10
> 
> 时间：2012-11-16T19:00:04.077
> 
> 标签：ruby-on-rails, ruby, activeadmin

当`show`使用 Rails ActiveAdmin gem 获取资源时，我想显示另一个关联模型的表格。

所以让我们说一个`Winery` `has_many` `:products`. 现在我想在管理资源的`show`页面上显示关联的产品。`Winery`我希望它是一个类似于我`index`在`Products`资源中获得的表格。

我让它工作，但只能通过手动重新创建 HTML 结构，这很糟糕。是否有一种更简洁的方法`index`可以为关联资源的特定子集创建表格样式视图？

我有什么，有点糟糕：

```
show title: :name do |winery|
  attributes_table do
    row :name
    row(:region) { |o| o.region.name }
    rows :primary_contact, :description
  end

  # This is the part that sucks.
  div class: 'panel' do
    h3 'Products'
    div class: 'attributes_table' do
      table do
        tr do
          th 'Name'
          th 'Vintage'
          th 'Varietal'
        end
        winery.products.each do |product|
          tr do
            td link_to product.name, admin_product_path(product)
            td product.vintage
            td product.varietal.name
          end
        end
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-17T09:10:13.753

为了解决这个问题，我们使用了部分：

`/app/admin/wineries.rb`

```
ActiveAdmin.register Winery do
  show title: :name do
    render "show", context: self
  end
end 
```

`app/admin/products.rb`

```
ActiveAdmin.register Product do
  belongs_to :winery
  index do
    render "index", context: self
  end
end 
```

`/app/views/admin/wineries/_show.builder`

```
context.instance_eval  do
  attributes_table do
    row :name
    row :region
    row :primary_contact
  end
  render "admin/products/index", products: winery.products, context: self
  active_admin_comments
end 
```

`/app/views/admin/products/_index.builder`

```
context.instance_eval  do
  table_for(invoices, :sortable => true, :class => 'index_table') do
    column :name
    column :vintage
    column :varietal
    default_actions rescue nil # test for responds_to? does not work.
  end
end 
```

# html - 使 div 水平自动填充父 div

> ID：13422755
> 
> 赞同：1
> 
> 时间：2012-11-16T19:00:16.407
> 
> 标签：html, css

我想在我的 html 正文中有一个水平填充正文的页脚。

我有一个这样的html：

```
<body>
    <div class="footer"></div>
</body> 
```

和这样的CSS：

```
body {
    padding: 0px;
    margin: 0px;
    width: 100%;
    height: 100%;
}
body .footer {
    display: block;
    position: absolute;
    bottom: 0px;
    left: 0px;
    height: auto;
    padding: 10px;
} 
```

文档说，当我`display:block`在 div 中使用时，默认情况下，这个 div 会水平填充父级。我不知道为什么，但这并没有发生在这里！所以我改变了这样的CSS：

```
body {
    padding: 0px;
    margin: 0px;
    width: 100%;
    height: 100%;
}
body .footer {
    width: 100%;
    position: absolute;
    bottom: 0px;
    left: 0px;
    height: auto;
    padding: 10px;
} 
```

现在`width:100%`除了 a 之外的问题`padding:10px`是它会产生一个比父级大 20px 的 div，当然还有一个水平滚动条！

有没有标准的方法来实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:05:09.730

有以下三种方法：

没有水平填充：

```
padding: 10px 0; 
```

绝对定位在右边：

```
right: 0; 
```

或更改页脚的框大小：

```
box-sizing: border-box; 
```

有关 box-sizing 的更多说明，请参见此处：http: [//css-tricks.com/box-sizing/](http://css-tricks.com/box-sizing/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T19:05:12.470

我认为这可能是因为 div 有一个`position:absolute`. 尝试添加`right:0px;`到`body .footer`. 我不认为这将在 IE6 中起作用，但如果这很重要。

查看我的 jsfiddle（为 div 添加了红色背景以提高可见性）：http: [//jsfiddle.net/jdwire/BtnXe/](http://jsfiddle.net/jdwire/BtnXe/)

# scala - 在没有错误状态的情况下处理迭代库中的异常

> ID：13422756
> 
> 赞同：8
> 
> 时间：2012-11-16T19:00:17.790
> 
> 标签：scala, haskell, io, scalaz, iterate

我正在尝试编写一个枚举器，用于从`java.io.BufferedReader`使用[Scalaz](https://github.com/scalaz/scalaz) 7 的 iteratee 库中逐行读取文件，该库目前只为`java.io.Reader`.

我遇到的问题与我使用过的所有其他迭代库（例如[Play 2.0](http://www.playframework.org/documentation/2.0/Iteratees)和[John Millikin 的`enumerator`](http://hackage.haskell.org/package/enumerator)`Step`Haskell）作为其类型的构造函数之一和 Scalaz 7都存在错误状态有关。没有。

## 我目前的实现

这是我目前拥有的。首先是一些导入和`IO`包装器：

```
import java.io.{ BufferedReader, File, FileReader }
import scalaz._, Scalaz._, effect.IO, iteratee.{ Iteratee => I, _ }

def openFile(f: File) = IO(new BufferedReader(new FileReader(f)))
def readLine(r: BufferedReader) = IO(Option(r.readLine))
def closeReader(r: BufferedReader) = IO(r.close()) 
```

还有一个类型别名来清理一下：

```
type ErrorOr[A] = Either[Throwable, A] 
```

现在是一个`tryIO`助手，模仿（松散地，可能是错误地）在`enumerator`：

```
def tryIO[A, B](action: IO[B]) = I.iterateeT[A, IO, ErrorOr[B]](
  action.catchLeft.map(
    r => I.sdone(r, r.fold(_ => I.eofInput, _ => I.emptyInput))
  )
) 
```

自身的枚举器`BufferedReader`：

```
def enumBuffered(r: => BufferedReader) = new EnumeratorT[ErrorOr[String], IO] {
  lazy val reader = r
  def apply[A] = (s: StepT[ErrorOr[String], IO, A]) => s.mapCont(k =>
    tryIO(readLine(reader)) flatMap {
      case Right(None)       => s.pointI
      case Right(Some(line)) => k(I.elInput(Right(line))) >>== apply[A]
      case Left(e)           => k(I.elInput(Left(e)))
    }
  )
} 
```

最后是一个负责打开和关闭阅读器的枚举器：

```
def enumFile(f: File) = new EnumeratorT[ErrorOr[String], IO] {
  def apply[A] = (s: StepT[ErrorOr[String], IO, A]) => s.mapCont(k =>
    tryIO(openFile(f)) flatMap {
      case Right(reader) => I.iterateeT(
        enumBuffered(reader).apply(s).value.ensuring(closeReader(reader))
      )
      case Left(e) => k(I.elInput(Left(e)))
    }
  )
} 
```

现在假设我想将文件中包含至少 25 个`'0'`字符的所有行收集到一个列表中。我可以写：

```
val action: IO[ErrorOr[List[String]]] = (
  I.consume[ErrorOr[String], IO, List] %=
  I.filter(_.fold(_ => true, _.count(_ == '0') >= 25)) &=
  enumFile(new File("big.txt"))
).run.map(_.sequence) 
```

在许多方面，这似乎工作得很好：我可以开始这个动作`unsafePerformIO`，它会在几分钟内通过数千万行和千兆字节的数据，在恒定的内存中并且不会破坏堆栈，然后关闭阅读器完成后。如果我给它一个不存在的文件的名称，它会尽职尽责地将包含在 a 中的异常返回给我`Left`，并且`enumBuffered`如果它在读取时遇到异常，至少似乎表现得适当。

## 潜在问题

不过，我对我的实现有些担心——尤其是`tryIO`. 例如，假设我尝试编写一些迭代：

```
val it = for {
  _ <- tryIO[Unit, Unit](IO(println("a")))
  _ <- tryIO[Unit, Unit](IO(throw new Exception("!")))
  r <- tryIO[Unit, Unit](IO(println("b")))
} yield r 
```

如果我运行它，我会得到以下信息：

```
scala> it.run.unsafePerformIO()
a
b
res11: ErrorOr[Unit] = Right(()) 
```

如果我在 GHCi 中尝试同样的事情`enumerator`，结果更像我所期望的：

```
...> run $ tryIO (putStrLn "a") >> tryIO (error "!") >> tryIO (putStrLn "b")
a
Left ! 
```

我只是看不到在 iteratee 库本身没有错误状态的情况下获得这种行为的方法。

## 我的问题

我并不声称自己是迭代器方面的专家，但我在一些项目中使用了各种 Haskell 实现，感觉我或多或少地理解了基本概念，并且曾经和 Oleg 喝过咖啡。不过，我在这里不知所措。这是在没有错误状态的情况下处理异常的合理方法吗？有没有一种方法可以实现`tryIO`更像`enumerator`版本？由于我的实现行为不同，是否有某种定时炸弹在等着我？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T20:13:11.447

在这里编辑是真正的解决方案。我离开了原来的帖子，因为我认为它值得看到这种模式。适用于 Klesli 的方法适用于 IterateeT

```
import java.io.{ BufferedReader, File, FileReader }
import scalaz._, Scalaz._, effect._, iteratee.{ Iteratee => I, _ }

object IterateeIOExample {
  type ErrorOr[+A] = EitherT[IO, Throwable, A]

  def openFile(f: File) = IO(new BufferedReader(new FileReader(f)))
  def readLine(r: BufferedReader) = IO(Option(r.readLine))
  def closeReader(r: BufferedReader) = IO(r.close())

  def tryIO[A, B](action: IO[B]) = I.iterateeT[A, ErrorOr, B] {
    EitherT.fromEither(action.catchLeft).map(r => I.sdone(r, I.emptyInput))
  }

  def enumBuffered(r: => BufferedReader) = new EnumeratorT[String, ErrorOr] {
    lazy val reader = r
    def apply[A] = (s: StepT[String, ErrorOr, A]) => s.mapCont(k =>
      tryIO(readLine(reader)) flatMap {
        case None => s.pointI
        case Some(line) => k(I.elInput(line)) >>== apply[A]
      })
  }

  def enumFile(f: File) = new EnumeratorT[String, ErrorOr] {
    def apply[A] = (s: StepT[String, ErrorOr, A]) => 
      tryIO(openFile(f)).flatMap(reader => I.iterateeT[String, ErrorOr, A](
        EitherT(
          enumBuffered(reader).apply(s).value.run.ensuring(closeReader(reader)))))
  }

  def main(args: Array[String]) {
    val action = (
      I.consume[String, ErrorOr, List] %=
      I.filter(a => a.count(_ == '0') >= 25) &=
      enumFile(new File(args(0)))).run.run

    println(action.unsafePerformIO().map(_.size))
  }
} 
```

===== 原帖 =====

我觉得你需要一个 EitherT。如果没有 EitherT，您最终只会得到 3 个左或右。使用 EitherT 它将对左进行适当的处​​理。

我想你真正想要的是

```
type ErrorOr[+A] = EitherT[IO, Throwable, A] 
I.iterateeT[A, ErrorOr, B] 
```

以下代码模拟了您当前的组合方式。因为 IterateeT 没有左右的概念，所以当你编写它时，你最终只会得到一堆 IO/Id。

```
scala> Kleisli((a:Int) => 4.right[String].point[Id])
res11: scalaz.Kleisli[scalaz.Scalaz.Id,Int,scalaz.\/[String,Int]] = scalaz.KleisliFunctions$$anon$18@73e771ca

scala> Kleisli((a:Int) => "aa".left[Int].point[Id])
res12: scalaz.Kleisli[scalaz.Scalaz.Id,Int,scalaz.\/[String,Int]] = scalaz.KleisliFunctions$$anon$18@be41b41

scala> for { a <- res11; b <- res12 } yield (a,b)
res15: scalaz.Kleisli[scalaz.Scalaz.Id,Int,(scalaz.\/[String,Int], scalaz.\/[String,Int])] = scalaz.KleisliFunctions$$anon$18@42fd1445

scala> res15.run(1)
res16: (scalaz.\/[String,Int], scalaz.\/[String,Int]) = (\/-(4),-\/(aa)) 
```

在下面的代码中，我们没有使用 Id，而是使用了 EitherT。由于 EitherT 具有与 Either 相同的绑定行为，因此我们最终得到了我们想要的。

```
scala>  type ErrorOr[+A] = EitherT[Id, String, A]
defined type alias ErrorOr

scala> Kleisli[ErrorOr, Int, Int]((a:Int) => EitherT(4.right[String].point[Id]))
res22: scalaz.Kleisli[ErrorOr,Int,Int] = scalaz.KleisliFunctions$$anon$18@58b547a0

scala> Kleisli[ErrorOr, Int, Int]((a:Int) => EitherT("aa".left[Int].point[Id]))
res24: scalaz.Kleisli[ErrorOr,Int,Int] = scalaz.KleisliFunctions$$anon$18@342f2ceb

scala> for { a <- res22; b <- res24 } yield 2
res25: scalaz.Kleisli[ErrorOr,Int,Int] = scalaz.KleisliFunctions$$anon$18@204eab31

scala> res25.run(2).run
res26: scalaz.Scalaz.Id[scalaz.\/[String,Int]] = -\/(aa) 
```

您可以将 Keisli 替换为 IterateeT 并将 Id 替换为 IO 以获得您需要的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T00:19:51.593

它的方法`pipes`是使用`Channel`类型类进行类型类组合：

```
class Channel p where
    {-| 'idT' acts like a \'T\'ransparent proxy, passing all requests further
        upstream, and passing all responses further downstream. -}
    idT :: (Monad m) => a' -> p a' a a' a m r

    {-| Compose two proxies, satisfying all requests from downstream with
        responses from upstream. -}
    (>->) :: (Monad m)
          => (b' -> p a' a b' b m r)
          -> (c' -> p b' b c' c m r)
          -> (c' -> p a' a c' c m r)
    p1 >-> p2 = p2 <-< p1 
```

`EitherT`...并从基础组合物衍生出提升的组合物。这是代理转换器原理的一个特例，在 中介绍`pipes-2.4`，它允许在任意扩展上提升组合。

这种提升需要定义一个`EitherT`专门的`Proxy`类型的形状`Control.Proxy.Trans.Either`：

```
newtype EitherP e p a' a b' b (m :: * -> *) r
  = EitherP { runEitherP :: p a' a b' b m (Either e r) } 
```

`Proxy`为了能够定义类的类型良好的实例，对形状的这种特殊化是必要的`Channel`。Scala 在这方面可能比 Haskell 更灵活。

然后我只是重新定义`Monad`实例（和其他实例）以及`EitherT`这种特殊类型的所有普通操作：

```
throw :: (Monad (p a' a b' b m)) => e -> EitherP e p a' a b' b m r
throw = EitherP . return . Left

catch
 :: (Monad (p a' a b' b m))
 => EitherP e p a' a b' b m r        -- ^ Original computation
 -> (e -> EitherP f p a' a b' b m r) -- ^ Handler
 -> EitherP f p a' a b' b m r        -- ^ Handled computation
catch m f = EitherP $ do
    e <- runEitherP m
    runEitherP $ case e of
        Left  l -> f     l
        Right r -> right r 
```

有了这个，我就可以定义以下提升的组合实例：

```
-- Given that 'p' is composable, so is 'EitherP e p'
instance (Channel p) => Channel (EitherP e p) where
    idT = EitherP . idT
    p1 >-> p2 = (EitherP .) $ runEitherP . p1 >-> runEitherP . p2 
```

要了解那里发生了什么，只需遵循以下类型：

```
p1 :: b' -> EitherP e p a' a b' b m r
p2 :: c' -> EitherP e p b' b c' c m r

runEitherP . p1 :: b' -> p a' a b' b m (Either e r)
runEitherP . p2 :: c' -> p b' b c' c m (Either e r)

-- Use the base composition for 'p'
runEitherP . p1 >-> runEitherP . p2
 :: c' -> p a' a c' c m (Either e r)

-- Rewrap in EitherP
(EitherP . ) $ runEitherP . p1 >-> runEitherP . p2
 :: c' -> EitherP e p a' a c' c m r 
```

这使您可以在特定阶段内抛出和捕获错误，而不会中断其他阶段。这是我从`pipes-2.4`公告帖子中复制并粘贴的示例：

```
import Control.Monad (forever)
import Control.Monad.Trans (lift)
import Control.Proxy
import Control.Proxy.Trans.Either as E
import Safe (readMay)

promptInts :: () -> EitherP String Proxy C () () Int IO r
promptInts () = recover $ forever $ do
    str <- lift getLine
    case readMay str of
        Nothing -> E.throw "Could not parse an integer"
        Just n  -> liftP $ respond n

recover p =
    p `E.catch` (\str -> lift (putStrLn str) >> recover p)

main = runProxy $ runEitherK $ mapP printD <-< promptInts 
```

结果如下：

```
>>> main
1<Enter>
1
Test<Enter>
Could not parse an integer
Apple<Enter>
Could not parse an integer
5<Enter>
5 
```

iteratee 方法的答案是相似的。您必须采用现有的方式来编写迭代器并将其提升`EitherT`。无论您是使用类型类还是仅仅定义一个新的组合运算符，都取决于您。

其他一些有用的链接：

*   [`pipes-2.4`公告帖](http://www.haskellforall.com/2012/10/pipes-24-proxy-transformers-extra.html)
*   [`Control.Proxy.Class`](http://hackage.haskell.org/packages/archive/pipes/2.5.0/doc/html/Control-Proxy-Class.html), [`Control.Proxy.Trans`](http://hackage.haskell.org/packages/archive/pipes/2.5.0/doc/html/Control-Proxy-Trans.html), 和[`Control.Proxy.Trans.Either`](http://hackage.haskell.org/packages/archive/pipes/2.5.0/doc/html/Control-Proxy-Trans-Either.html)
*   关于同一主题的一个[非常相似的 Stack Overflow 问题](https://stackoverflow.com/questions/11402892/what-approach-to-error-handling-to-use-with-pipes-core/11417819#11417819)（`pipes 除外）

# c# - 用于在页面之间写入的锁定（文件）？

> ID：13422761
> 
> 赞同：3
> 
> 时间：2012-11-16T19:00:39.930
> 
> 标签：c#, asp.net

我有一个应用程序，它使用 XML 文件来存储不需要在数据库中的某些数据。该文件虽然很少，但可能会同时在页面之间写入。这会产生一个问题，很可能会导致其中一个页面崩溃。我想知道是否有办法让页面渲染等到另一个完成写入文件。

我不确定我是否可以假设每个页面渲染都在自己的线程中运行；如果是这样，那么我可以像 lock() 命令一样停止该线程以等待资源可用。如果是这样，我如何在文件上实现 lock() （因为它不是内存段）？

如果它没有线程或者我不能使用 lock()，还有什么其他方法可以确保文件被写入，但是如果其他人正在使用该文件，它可以等待文件可用？

管理写入顺序和权限的方法有很多，但很简单；如果你是第二名，你会在其他人完成后写。在这一点上，我不太关心写入冲突，但并发写入是需要解决的问题。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:43:40.277

**编辑**：运行更多测试（在单声道上），我不太确定这是最好的方法。

我没有设法使任何东西崩溃，但执行只是在 之后暂停`Run()`几秒钟，然后返回给调用者。所以我怀疑这不是支持这个代码片段的好兆头。

话虽如此，经过测试的场景远非现实。

* * *

另一种选择是以`FileShare.ReadWrite`模式打开文件，让操作系统关心锁定。

```
 public void Run()
    {
        var file = @"/home/me/test.txt";
        var threads = new Thread[3];

        for (int i = 0; i < threads.Length; i++) {
            int j = i;
            threads[j] = new Thread( s => { 
            Console.WriteLine("thread " + j + " is running...");
            using (var stream = File.Open(file, FileMode.OpenOrCreate, 
                   FileAccess.ReadWrite, FileShare.ReadWrite))
            {
                Console.WriteLine("thread " + j + " is holding the file!");
                var data = ASCIIEncoding.ASCII.GetBytes("hello, I'm stream " + j);
                stream.Write(data, 0, data.Length);
                Thread.Sleep(1000);
            }});    
        }   

        foreach (var t in threads)
            t.Start();

        foreach (var t in threads)
            t.Join();

        Console.WriteLine(File.ReadAllText(file));
    } 
```

输出：

```
thread 1 is running...
thread 0 is running...
thread 2 is running...
thread 2 is holding the file!
thread 1 is holding the file!
thread 0 is holding the file!
hello, I'm stream 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:06:17.663

如果它来自单台机器，您可以使用`Semaphore` [http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx](http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx)：

```
private static Semaphore _fileSemaphore = new Semaphore(1, 1, "myFileGlobalSemaphore");

// later...

try
{
    _fileSemaphore.WaitOne();
    // do stuff..
}
finally
{
    _fileSemaphore.Release();
} 
```

这有点像系统范围的锁。虽然不是很好，建议使用数据库。另外，其他事情可能会导致文件访问失败。您可以使用适当的锁定模式实现创建 a`FileStream`的东西，如果您尝试打开两个源进行写入，这将失败，但它不会执行类似`lock`的场景（在`Monitor`内部使用该类）

顺便说一句：“不需要存储在数据库中”。你问这个问题的事实表明它确实应该是。如果实施起来很麻烦，您可能需要重新考虑您的数据访问策略。带有 Code First 的实体框架之类的东西可以很容易地在数据库中“收集”东西。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-16T19:07:38.527

使用一些全局锁定对象。例如添加到您的 global.asax.cs：

```
public static readonly object FileLock = new Object(); 
```

然后在您的页面中使用：

```
lock(YourApplicationClass.FileLock)
{
    // do stuff
} 
```

# python - 为什么 PyImport_Import 无法从当前目录加载模块？

> ID：13422764
> 
> 赞同：9
> 
> 时间：2012-11-16T19:00:54.713
> 
> 标签：python, linux, python-2.7, python-embedding

我正在尝试运行[嵌入示例](http://docs.python.org/2/extending/embedding.html#pure-embedding)，我无法从当前工作目录加载模块，除非我明确将其添加到`sys.path`然后它可以工作：

```
PyRun_SimpleString("import sys");
PyRun_SimpleString("sys.path.append(\".\")"); 
```

Python 不应该在当前目录中查找模块吗？

**Edit1**：尝试只导入模块：

```
Py_Initialize();
PyRun_SimpleString("import multiply"); 
```

它仍然失败并出现以下错误：

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named multiply 
```

**Edit2**：来自`sys.path` [文档](http://docs.python.org/library/sys.html#sys.path)：

> 如果脚本目录不可用（例如，如果以交互方式调用解释器或从标准输入读取脚本），则 path[0]**是空字符串，它指示 Python 首先搜索当前目录中的模块**。

不确定*not available*是什么意思，但如果我打印`sys.path[0]`它不是空的：

```
/usr/lib/pymodules/python2.7 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-16T20:33:26.977

您需要调用`PySys_SetArgv(int argc, char **argv, int updatepath)`相关导入才能工作。这会将正在执行的脚本的路径添加到`sys.path`if `updatepath`is `0`（有关更多信息，请参阅[文档](http://docs.python.org/2/c-api/init.html#PySys_SetArgvEx)）。

以下应该可以解决问题

```
#include <Python.h>

int
main(int argc, char *argv[])
{
  Py_SetProgramName(argv[0]);  /* optional but recommended */
  Py_Initialize();
  PySys_SetArgv(argc, argv); // must call this to get sys.argv and relative imports
  PyRun_SimpleString("import os, sys\n"
                     "print sys.argv, \"\\n\".join(sys.path)\n"
                     "print os.getcwd()\n"
                     "import thing\n" // import a relative module
                     "thing.printer()\n");
  Py_Finalize();
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-01T18:57:42.230

我对 python 3.5 所做的`PySys_SetPath`是能够从该`cwd`位置导入：

```
QString qs = QDir::currentPath();
std::wstring ws = qs.toStdWString();
PySys_SetPath(ws.data()); 
```

其中的`Q`s 是 Qt。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-11-05T11:03:56.663

我有完全相同的问题，我只是通过添加`Py_Initialize();`和解决了它`Py_Finalize();`

希望能帮到你

# php - 在 PHP 中有没有一种方法可以让服务器直接将文件下载到文件系统？

> ID：13422767
> 
> 赞同：0
> 
> 时间：2012-11-16T19:01:09.300
> 
> 标签：php, download, server-to-server

我需要我的服务器下载文件并将其写入服务器的文件系统。问题是我见过的所有 PHP 示例都将文件下载到服务器 RAM 中，然后写入文件。

由于我正在处理大文件，我希望 PHP 从其他服务器读取文件并立即将它读取的内容写入本地文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:32:25.557

像这样使用`curl`：

```
<?php
 $url  = 'http://www.example.com/a-large-file.zip';
 $path = '/path/to/a-large-file.zip';

 $fp = fopen($path, 'w');

 $ch = curl_init($url);
 curl_setopt($ch, CURLOPT_FILE, $fp);

 $data = curl_exec($ch);

 curl_close($ch);
 fclose($fp);
?> 
```

# hadoop - 在 Hadoop 中，我可以在哪里更改 namenode 和 jobtracker 网页的默认 url 端口 50070 和 50030

> ID：13422770
> 
> 赞同：6
> 
> 时间：2012-11-16T19:01:16.837
> 
> 标签：hadoop, nosql, mapreduce, hbase, elastic-map-reduce

必须有一种方法可以更改端口 50070 和 50030，以便以下 url 显示我选择的端口上的集群状态

```
NameNode - http://localhost:50070/
JobTracker - http://localhost:50030/ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T19:14:03.550

`dfs.http.address`通过在 conf/core-site.xml 中设置Namenode 和`mapred.job.tracker.http.address`Jobtracker 的属性来定义您选择的端口：

```
<configuration>

    <property>
        <name>dfs.http.address</name>
        <value>50070</value>
    </property>

    <property>
        <name>mapred.job.tracker.http.address</name>
        <value>50030</value>
    </property>

</configuration> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-07T02:23:19.320

这个问题很老，但可能值得指出的是，namenode 端口是通过 conf/hdfs-site.xml 中的 dfs.namenode.http-address 设置的。

```
<property>
         <name>dfs.namenode.http-address</name>
                          <value>0.0.0.0:50020</value>
</property> 
```

我被这个问题的其他答案误导了，所以希望这对其他人有帮助。至少 hadoop 2.6.0 是这样的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-20T07:21:29.650

默认的 Hadoop 端口如下：

```
Daemon                   Default Port  Configuration Parameter
-----------------------  ------------ ----------------------------------
Namenode                 50070        dfs.http.address
Datanodes                50075        dfs.datanode.http.address
Secondarynamenode        50090        dfs.secondary.http.address
Backup/Checkpoint node?  50105        dfs.backup.http.address
Jobracker                50030        mapred.job.tracker.http.address
Tasktrackers             50060        mapred.task.tracker.http.address 
```

如果我们希望更改任何端口，请在 conf/core-site.xml 中添加相应的端口

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-20T09:02:15.550

要查看所有正在运行的端口，我们可以通过它

netstat -plten | grep java

# php - php加密一个非常大的数字以产生一个较小的数字

> ID：13422771
> 
> 赞同：-3
> 
> 时间：2012-11-16T19:01:25.210
> 
> 标签：php, math, encryption, mcrypt

我正在处理非常大的数字。我的一种算法要求数字“x”小于另一个数字“n”，以便执行该算法。我想知道是否可以加密非常大的数字以产生较小的数字并存储密钥，以便我需要将数字解密回更大的数字？我看过mcrypt，但它并没有输出所有数字，从我所看到的它输出一个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:11:24.203

您在谈论的是所谓的“压缩”，而不是“加密”。

如果有的话，加密可能会产生比其输入*更大的*字符串。虽然您可以*压缩*数字，但这将是非常小的节省。

根据可能值的范围，您可以简单地构建一个包含每个可能的大数的数组，并使用数组索引而不是数字本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:18:56.073

您可以将数字转换为更高的基数以用更少的字符表示它。例如，如果您的数字以 10 为底，则将其转换为以 16 为底。您可以使用 GMP 库对这些不在以 10 为底的数字进行高精度数学运算。

您可以在此处阅读有关 GMP（Gnu 多精度）库的信息：[http ://www.php.net/manual/en/book.gmp.php](http://www.php.net/manual/en/book.gmp.php)

# math - vbulletin 论坛中的数学公式

> ID：13422777
> 
> 赞同：0
> 
> 时间：2012-11-16T19:02:00.030
> 
> 标签：math, vbulletin, formulas

***您好***，我有一个 vbulletin 论坛，我希望我的用户能够在他们的帖子中编写数学公式（又好又简单），您有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T22:16:16.760

您可以使用[MathJax](http://www.mathjax.org/)。我知道，例如[物理论坛](http://www.physicsforums.com)将其与 vBulletin 结合使用。

# java - 存储搜索栏数据

> ID：13422778
> 
> 赞同：1
> 
> 时间：2012-11-16T19:02:16.907
> 
> 标签：java, android, xml, store

我有一个页面，其中有一个新事件的按钮。当按下该按钮时，它会打开一个新活动，该活动具有时间选择器、日期和年份选择器以及将测量事件 1 2 3 优先级的搜索栏。我需要能够保存所有这些数据，以便以后使用将显示，并根据优先级排序（再次阅读上文，1 ,2 ,3）。数据必须显示在按钮下方的第一页上。稍后我可以自己完成显示部分，但我需要知道如何设置数据库或什么能够存储这些变量并对其进行排序。

这是所有文件的源代码。

**活动主.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Button
        android:id="@+id/new_event"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/new_event"
        android:onClick="openeditor"/>
    <ListView
        android:id="@+id/event_list"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        />

</LinearLayout> 
```

**活动新事件.xml**

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/scrollView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_weight="2.80" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:baselineAligned="false"
        android:orientation="vertical" >

        <EditText
            android:id="@+id/event_name"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="@string/event_name" />

        <TimePicker
            android:id="@+id/time_picker"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <DatePicker
            android:id="@+id/date_picker"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <SeekBar
            android:id="@+id/seekBar1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" 
            android:max="2"/>

        <Button
            android:id="@+id/create_event"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="@string/add_event" />

    </LinearLayout>
</ScrollView> 
```

**Main_Activity.java**

```
 package com.osah.tao;

    import android.app.Activity;
    import android.content.Intent;
    import android.os.Bundle;
    import android.view.Menu;
    import android.view.View;
    import android.view.View.OnClickListener;

public class MainActivity extends Activity implements OnClickListener {

    @Override

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        View new_event = findViewById(R.id.new_event);
        new_event.setOnClickListener(this);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    public void onClick(View v){
        switch (v.getId()) {
        case R.id.new_event:
        Intent a = new Intent(this, New_event.class);
        startActivity(a);
        break;

        }

    }
} 
```

**New_Event.java**

```
package com.osah.tao;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;

public class New_event extends Activity {

        @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.activity_newevent);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_newevent, menu);
        return true;
    }

} 
```

请详细说明。

# jquery - 将活动状态添加到 Jquery 背景位置动画

> ID：13422779
> 
> 赞同：1
> 
> 时间：2012-11-16T19:02:17.360
> 
> 标签：jquery, jquery-animate

我需要在我的 jquery 动画导航菜单中添加一个活动状态，但似乎无法让它工作。动画效果很好，但我需要它来停止活动选项卡（网站中的当前页面）上的动画并继续在其他选项卡上工作，依此类推。请帮助
这里是我的代码

html:

```
<div id="insideNav">
    <ul id="nav">
        <li><a href="index.php">Home</a></li>
        <li><a href="media.php">Media</a></li>
        <li><a href="overview.php">Overview</a></li>
        <li><a href="mobile.php">Mobile</a></li>
        <li><a href="options.php">Options</a></li>
        <li><a href="order.php">Order</a></li>
        <li><a href="contact.php">Contact</a></li>
    </ul>
</div> 
```

CSS：

```
ul#nav {
    width:1024px;
    margin: 0 auto;
    text-align:center;
    overflow:hidden;    
}
ul#nav li {
    float:left;
    list-style:none;    
}
ul#nav li a {
    display:block;
    width:108px;
    height:76px;
    padding:15px 0 0 0;
    margin:0 10px 0 10px;
    font: italic 16px Georgia,"Times New Roman", serif;
    color:#919090;
    text-decoration:none;
    background: url("../images/dropDown.png") 0 -149px no-repeat;   
}
ul#nav li a:hover {
    background: url("../images/dropDown.png") 0 0 no-repeat;    
    color:#ffffff;
} 
```

查询：

```
$(document).ready(function() {
    $("ul#nav li a").addClass("js");
    $("ul#nav li a").hover(
      function () {
        $(this).stop(true,true).animate({backgroundPosition:"(0 0)"}, 200);
        $(this).animate({backgroundPosition:"(0 -5px)"}, 150);
      }, 
      function () {
        $(this).stop(true,true).animate({backgroundPosition:"(0 -149px)"}, 200);

      }

    );

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:17:30.833

您可以使用 jQuery not() 函数并为当前页面添加一个活动类，例如

```
$('ul#nav li a').not('.active').hover( ... 
```

等等...

然后假设您当前的页面是媒体添加一个类：

```
<li><a href="media.php" class="active">Media</a></li> 
```

要完全删除悬停集 css：

```
ul#nav li a.active:hover { background-position: 0 -149px; } 
```

# xaml - PathListBox 在 Windows Phone 8 中无法正常工作

> ID：13422784
> 
> 赞同：2
> 
> 时间：2012-11-16T19:03:00.327
> 
> 标签：xaml, windows-phone-8

我正在将应用程序从 Windows Phone 7 移植到 Windows Phone 8，但 PathListBox 控件存在一些问题。

这是 XAML：

```
<Grid x:Name="LayoutRoot" Background="{StaticResource PhoneChromeBrush}">
        <Path x:Name="path" Data="M58,382 C59,378 67,156 162,216 C257,276 268,381 325,268 C382,155 470,188 345,107.999 C220,27.9988 191,-10.0014 51,46.9988 C-89,103.999 -106,203.999 18,185.999 C142,167.999 108,105.999 179,130.999" HorizontalAlignment="Left" Height="363.298" Margin="4.98,54.202,0,0" Stretch="Fill" Stroke="Red" UseLayoutRounding="False" VerticalAlignment="Top" Width="475.02" StrokeThickness="3"/>

        <mec:PathListBox HorizontalAlignment="Left" Height="100" VerticalAlignment="Top" Width="100">
            <mec:PathListBox.LayoutPaths>
                <mec:LayoutPath SourceElement="{Binding ElementName=path}"/>
            </mec:PathListBox.LayoutPaths>
            <mec:PathListBoxItem Content="PathListBoxItem" HorizontalAlignment="Left" Height="24" VerticalAlignment="Top" Width="100"/>
            <mec:PathListBoxItem Content="PathListBoxItem" HorizontalAlignment="Left" Height="24" VerticalAlignment="Top" Width="100"/>
            <mec:PathListBoxItem Content="PathListBoxItem" HorizontalAlignment="Left" Height="24" VerticalAlignment="Top" Width="100"/>
            <mec:PathListBoxItem Content="PathListBoxItem" HorizontalAlignment="Left" Height="24" VerticalAlignment="Top" Width="100"/>
        </mec:PathListBox>

    </Grid> 
```

PathListBoxItems 不像在 WPF、Silverlight 和 Windows Phone 7 中那样遵循路径。这是什么原因？

没有编译错误或警告，Visual Studio 2012 没有给我任何警告。在 Blend 5 的属性面板中的 LayoutPaths 列表中，在移除“-”按钮旁边的“路径”项上有一个黄色的小警告符号。用鼠标悬停图标时的工具提示状态：

***此对象不存在或者是此 PathListBox 的后代。***

鉴于我提供的 XAML，这似乎不是真的。

我已经尝试过使用矩形、椭圆和直线。我已经更改了它们的声明顺序。没关系，Blend 5 总是给我同样的小警告。还有其他人在使用 Windows Phone 8 PathListBox 时遇到过这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T21:51:38.010

我已经猜到了。wp8 变体缺少控件模板。我将 wp7 中的 itemcontainer 样式复制到 wp8 应用程序的本地资源中，它现在似乎可以工作了；

```
<phone:PhoneApplicationPage.Resources>
    <Style x:Key="PathListBoxStyle1" TargetType="mec:PathListBox">
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="UseLayoutRounding" Value="False"/>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <mec:PathPanel/>
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mec:PathListBox">
                    <Grid>
                        <!--
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="ValidationStates">
                                <VisualState x:Name="Valid"/>
                                <VisualState x:Name="InvalidUnfocused">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility" Storyboard.TargetName="ValidationErrorElement">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="InvalidFocused">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility" Storyboard.TargetName="ValidationErrorElement">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="IsOpen" Storyboard.TargetName="validationTooltip">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <System:Boolean>True</System:Boolean>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        -->
                        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="2" Padding="{TemplateBinding Padding}">
                            <ItemsPresenter/>
                        </Border>
                        <!--
                        <Border x:Name="ValidationErrorElement" BorderBrush="#FFDB000C" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2" Visibility="Collapsed">
                            <ToolTipService.ToolTip>
                                <ToolTip x:Name="validationTooltip" DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}" Placement="Right" PlacementTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Template="{StaticResource ValidationToolTipTemplate}">
                                    <ToolTip.Triggers>
                                        <EventTrigger RoutedEvent="Canvas.Loaded">
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible" Storyboard.TargetName="validationTooltip">
                                                        <DiscreteObjectKeyFrame KeyTime="0">
                                                            <DiscreteObjectKeyFrame.Value>
                                                                <System:Boolean>true</System:Boolean>
                                                            </DiscreteObjectKeyFrame.Value>
                                                        </DiscreteObjectKeyFrame>
                                                    </ObjectAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </ToolTip.Triggers>
                                </ToolTip>
                            </ToolTipService.ToolTip>
                            <Grid Background="Transparent" HorizontalAlignment="Right" Height="10" Margin="0,-4,-4,0" VerticalAlignment="Top" Width="10">
                                <Path Data="M 1,0 L6,0 A 2,2 90 0 1 8,2 L8,7 z" Fill="#FFDC000C" Margin="-1,3,0,0"/>
                                <Path Data="M 0,0 L2,0 L 8,6 L8,8" Fill="#ffffff" Margin="-1,3,0,0"/>
                            </Grid>
                        </Border>
                        -->
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

    </Style>

    <DataTemplate x:Key="DataTemplate1">
        <Grid>
            <TextBlock Text="{Binding Name}" />
            <TextBlock Text="{Binding ElementName, RelativeSource={RelativeSource  Mode=TemplatedParent}}" />
        </Grid>
    </DataTemplate>
    <ItemsPanelTemplate x:Key="ItemsPanelTemplate1">
        <mec:PathPanel/>
    </ItemsPanelTemplate>
    <mec:IsArrangedToScaleConverter x:Key="IsArrangedToScaleConverter"/>
    <Style x:Key="PathListBoxItemStyle1" TargetType="mec:PathListBoxItem">
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Top"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="mec:PathListBoxItem">
                    <Grid Background="{TemplateBinding Background}" RenderTransformOrigin="0.5,0.5">
                        <Grid.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform ScaleY="{Binding IsArranged, Converter={StaticResource IsArrangedToScaleConverter}, RelativeSource={RelativeSource TemplatedParent}}" ScaleX="{Binding IsArranged, Converter={StaticResource IsArrangedToScaleConverter}, RelativeSource={RelativeSource TemplatedParent}}"/>
                                <SkewTransform/>
                                <RotateTransform Angle="{Binding OrientationAngle, RelativeSource={RelativeSource TemplatedParent}}"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Grid.RenderTransform>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".35" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="fillColor"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="contentPresenter"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="Selected">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To=".75" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="fillColor2"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Duration="0" Storyboard.TargetProperty="Visibility" Storyboard.TargetName="FocusVisualElement">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Rectangle x:Name="fillColor" Fill="#FFBADDE9" IsHitTestVisible="False" Opacity="0" RadiusY="1" RadiusX="1"/>
                        <Rectangle x:Name="fillColor2" Fill="#FFBADDE9" IsHitTestVisible="False" Opacity="0" RadiusY="1" RadiusX="1"/>
                        <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}"/>
                        <Rectangle x:Name="FocusVisualElement" RadiusY="1" RadiusX="1" Stroke="#FF6DBDD1" StrokeThickness="1" Visibility="Collapsed"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</phone:PhoneApplicationPage.Resources> 
```

使用它；

```
 <mec:PathListBox x:Name="MyPathListBox" HorizontalAlignment="Left"
                             Height="100"
                             VerticalAlignment="Top"
                             Width="100"
                                Style="{StaticResource PathListBoxStyle1}"
                                ItemContainerStyle="{StaticResource PathListBoxItemStyle1}"
                             ItemsSource="{Binding Items}" 

                             >
                <mec:PathListBox.ItemTemplate>
                    <DataTemplate>
                    <Grid>
                        <TextBlock>bla</TextBlock>
                    </Grid>
                    </DataTemplate>
                </mec:PathListBox.ItemTemplate>
                <mec:PathListBox.LayoutPaths>
                    <mec:LayoutPath Orientation="OrientToPath" SourceElement="{Binding ElementName=path}" />
                </mec:PathListBox.LayoutPaths>
            </mec:PathListBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T11:30:45.580

如果您使用代码而不是 xaml，它似乎会更好地工作，但即便如此，它仍然会忽略一些设置；

```
private PathListBox AttachPathListBoxToShape(ViewModel viewModel, IEnumerable itemSource, Shape shape, string dataTemplateKey, string itemsPanelTemplateKey)
    {

        DataTemplate dataTemplate = (DataTemplate)Application.Current.Resources[dataTemplateKey];
        ItemsPanelTemplate itemsPanelTemplate = (ItemsPanelTemplate)Application.Current.Resources[itemsPanelTemplateKey];

        PathListBox dynoListBox = new PathListBox();
        dynoListBox.ItemsSource = itemSource; 
        dynoListBox.ItemTemplate = dataTemplate;
        dynoListBox.ItemsPanel = itemsPanelTemplate;
        LayoutPath dynoPath = new LayoutPath();
        dynoPath.SourceElement = shape;
        dynoPath.Distribution = Distribution.Even;
        dynoPath.Orientation = Microsoft.Expression.Controls.Orientation.OrientToPath;
        dynoListBox.LayoutPaths.Add(dynoPath);
        return dynoListBox;
    } 
```

# java - Arraylist 或 hashmap 用于添加随机整数同时保持唯一性

> ID：13422787
> 
> 赞同：0
> 
> 时间：2012-11-16T19:03:05.503
> 
> 标签：java, data-structures, collections, arraylist, hashmap

给定一个arraylist和Hashmap。

我想在这个集合中添加随机整数。添加时必须检查值是否已经输入。如果是，它应该返回true并且不应该添加到集合中，或者应该添加值。那么哪个集合是其中首选？？解释。

现在，如何将整数单独添加到 hashmap 或者如果我们添加到 hashmap 中的键值对是什么，这是模棱两可的？但这是面试中被问到的问题，需要给出一个答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:18:17.587

使用[Set](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html)，它会处理唯一的条目：

```
Set<Integer> set = new HashSet<Integer>();
//...
int randomNumber = ...
boolean unique = set.add(randomNumber);
if (unique) {
    System.out.println(randomNumber + " was added to set");
} else {
    System.out.println(randomNumber + " already was in set");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:21:58.210

如果在面试中给出这个问题，我会认为这是一个棘手的问题......如果添加的项目顺序很重要，那么使用 LinkedHashSet，否则使用 HashSet......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:08:12.863

您可以简单地使用 ArrayList 来添加值，也可以在添加值之前监控这些值，例如：

```
List list = new ArrayList();

if (list.contains(whatever)) {
 System.out.println("do something"); 
} else {
   } 
```

您也可以使用 Hashmap 来做同样的事情，但这取决于您要输入的问题的要求

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T19:08:31.433

您可以简单地使用`Collection#contains(...)`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T19:08:33.970

对于这个特殊的问题，我建议使用 HashMap，因为它本身就可以检查重复值，而无需您做任何事情。

如果你使用了一个 ArrayList，你需要用'indexOf'检查，如果之前已经添加了整数，这需要搜索整个数组。

此外，Hashmaps 是按 key 排序的，这使得搜索效率更高。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-16T19:15:36.540

就像是`IntHashSet`

......

[http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/util/collections/IntHashSet.html](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/util/collections/IntHashSet.html)

# php - 从 jquery 的 ajax 响应中获取额外的输入字符

> ID：13422790
> 
> 赞同：2
> 
> 时间：2012-11-16T19:03:11.620
> 
> 标签：php, jquery, ajax

我的项目有 MVC 架构，最近我遇到了一个奇怪的问题。每当我尝试通过在 PHP 中打印一些输出来响应 Ajax 请求时，我都会在输出之前得到 8 个输入字符。我注意到它只是在我想回显时放置这些字符，但我不知道当这些额外输入不在我尝试输出的字符串中时它们是如何出现的。我已经检查了我所有的文件编码，以确保它们不是问题。我什至将响应留空，以检查是否有一些脚本早先打印了某些东西，但事实并非如此，输出为空，没有任何字符。

有什么诀窍吗？

这是我的js：

```
$.ajax({
    url: _baseRoot + '/admin/request',
    type: 'post',
    data: "req=" + req + args,
    success: function(data)
    {
      var result = data.split(",");

      var m_type = "";

      switch(result[0])
      {
        case "error": m_type = "red"; break;
        case "warning": m_type = "yellow"; break;
        case "success": m_type = "blue"; break;
      }

      showMessage(m_type, result[1]);
    }
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:38:50.563

在没有看到后端的情况下无法真正查明它，但正如大多数 php 项目所进行的那样，这些可能来自各种包含的文件，这些文件并不意味着输出任何内容，而是`?>`在其末尾有一个和一个换行符。php 解释器只是简单地将所有内容传递给不在`<?php ?>`标签内的输出。

如果您不想从 php 文件中输出任何内容，则可以删除关闭`?>`，解释器只需将文件结尾检测为脚本结尾，并确保不会意外空白进入输出之后`?>`。

# visual-studio-2012 - 在 ASP.NET Web API 自托管应用程序中生成控制器

> ID：13422792
> 
> 赞同：2
> 
> 时间：2012-11-16T19:03:18.303
> 
> 标签：visual-studio-2012, asp.net-web-api

Visual Studio 2012 中的 ASP.NET Web API 项目模板是一个专门的 MVC4 项目，在创建此类项目的实例后，右键单击“控制器”文件夹会显示“添加 >> 控制器”菜单项，该菜单项会触发控制器生成器。（脚手架）

另一方面，也可以在控制台应用程序中托管 ASP.NET Web API 服务器，在文档中称为自托管应用程序。

[http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api](http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api)

我的问题是：如果我正在开发自托管控制台应用程序，如何使用“控制器脚手架”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T13:10:02.227

仍然通过包管理器控制台支持脚手架，例如[这里](http://webapiscaffolding.codeplex.com/)。

但是 MVC 特定的“添加控制器”对话框确实是为 MVC 项目文件保留的。

但是，您可以强制您的自托管项目包含此对话框。

这可以通过在项目文件中添加一行来“欺骗”Visual Studio 使其认为您的自托管应用程序是 MVC 应用程序来实现。有关详细信息，请参阅此问题[“添加控制器”/“添加视图”在混合 MVC/WebForms ASP.NET 应用程序中](https://stackoverflow.com/questions/1600426/add-controller-add-view-in-a-hybrid-mvc-webforms-asp-net-application)

如果你：

1.  在项目根目录下创建一个 Controllers 文件夹
2.  鼠标右键你自己的宿主项目文件和“卸载项目”
3.  鼠标右键你自己的宿主项目文件“编辑”
4.  在 Xml > Project -> PropertyGroup 下添加步骤下显示的节点
5.  节省
6.  鼠标右键你自己的宿主项目文件点击重新加载项目

    ```
    <ProjectTypeGuids> 
        {E3E379DF-F4C6-4180-9B81-6769533ABE47};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}
    </ProjectTypeGuids> 
    ```

完成此操作后，您可以开始使用 TT 文件（脚手架），以使它们更有用/特定于自托管[http://www.hanselman.com/blog/ModifyingTheDefaultCodeGenerationscaffoldingTemplatesInASPNETMVC.aspx](http://www.hanselman.com/blog/ModifyingTheDefaultCodeGenerationscaffoldingTemplatesInASPNETMVC.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T21:23:17.423

我认为目前这是不可能的。这种脚手架支持目前特定于 MVC 4 项目。

# javascript - 如何滑出旧 div 并滑入新 div 循环中的文本内容？

> ID：13422793
> 
> 赞同：0
> 
> 时间：2012-11-16T19:03:20.723
> 
> 标签：javascript, jquery, jquery-ui

如何制作两个 div，以便在单击按钮后将旧 div 滑出并滑入具有新内容的新 div？

我的概念但未对齐`inline`： [jsfiddle](http://jsfiddle.net/2xuKz/3/)

我发现了与我的概念相似的东西，但对于我的解决方案，我需要动态添加内容的无限循环：[示例 1](http://jsfiddle.net/iambriansreed/d4Ruz/)或[示例 2](http://jsfiddle.net/steweb/rWbFw/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T20:31:20.033

我对现有代码和 CSS 做了一些更改，但这应该可以满足您的需求。我还在重置按钮上添加了一个检查，以确保 slideOut 尚未隐藏。否则，动画将取消隐藏元素并再次隐藏它。

最好将东西放入 jQuery`$(document).ready()`函数中，以确保在尝试使用它们之前已经加载了所有元素。

[新的小提琴链接](http://jsfiddle.net/2xuKz/4/)

# ruby-on-rails - 生成这种类型的 URI http://localhost:3000/api/products?ids=1,2,3,4

> ID：13422795
> 
> 赞同：0
> 
> 时间：2012-11-16T19:03:22.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3, api, rest

我有这个`http://localhost:3000/api/products`请求，它返回带有产品对象列表的 json 格式输出。我听说在某些情况下最好使用 multi-gets 设计，您可以像这样在 URI 中列出产品 ID `http://localhost:3000/api/products?ids=1,2,3,4`。我的问题是如何配置路由以返回这样的 URI？下面是返回的json输出`http://localhost:3000/api/products`。提前谢谢

控制器

```
def index
@products=Product.all

respond_to do |format|
  format.json { render json: @products.to_json}
  format.xml
end
end 
```

json输出
[

```
{
    "category_id": null,
    "created_at": "2011-03-25T13:35:16Z",
    "details": "Molestias pariatur consequuntur ut voluptas aperiam facere et et autem ad laudantium ut qui dolorem iste sit ut in dignissimos. Et debitis et et sunt quidem qui est est et numquam in dolorum natus sapiente nihil ipsa ratione. Quisquam aut molestiae earum voluptas vero et officiis magnam quam provident voluptatibus quia",
    "id": 1,
    "product_name": "Velit",
    "publisher_id": 1,
    "updated_at": "2012-11-12T18:45:13Z",
    "publisher_details": "http://localhost:3000/api/users/1"
},
{
    "category_id": null,
    "created_at": "2012-01-10T23:16:53Z",
    "details": "Temporibus quis et quam eveniet hic consequatur maiores eum expedita molestiae velit eligendi laboriosam ut molestiae. Velit delectus aliquid nobis quia velit aut dolorem omnis numquam reprehenderit quo illo saepe molestiae nisi. Soluta nihil quae soluta facilis cumque voluptates eaque amet unde non in placeat id cupiditate illum at et vero. Laborum id eaque voluptas illo eius iure",
    "id": 2,
    "product_name": "Nam Laboriosam Et Sed",
    "publisher_id": 1,
    "updated_at": "2012-11-12T18:45:13Z",
    "publisher_details": "http://localhost:3000/api/users/1"
}] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:14:29.373

有一个已停产的 gem，它是为 sproutcore（现为 ember）编写的，开箱即用：[https ://github.com/drogus/bulk_api](https://github.com/drogus/bulk_api)

但实际上，它根本不必那么难。对于单个控制器，我只会做类似的事情

```
 def index
   ids = params[:ids]
   if ids.blank?
     @categories = Category.all
   else  
     wanted_ids = ids.split(',')
     @categories = Categoriy.where(:id => wanted_ids)
   end
   render :json => @categories
 end 
```

这有帮助吗？

# java - 最长关键字的搜索字符串

> ID：13422804
> 
> 赞同：-1
> 
> 时间：2012-11-16T19:04:26.803
> 
> 标签：java, string, algorithm, data-structures, trie

我正在使用 java，并且有一组大型（~15000）关键字（字符串），并且我有一个定期包含这些关键字的文档（字符串）。

我想找到文档中关键字每次使用的索引，优先选择更长的关键字（字符最多的关键字）。例如，如果我的关键字是“水”、“瓶子”、“喝”和“水瓶”，而我的文档是“我从我的水瓶中喝了水”，我想要以下结果：

2 喝

16水瓶

我最初的尝试是使用 trie，并逐个字符地遍历文档，并且每当子字符串与关键字匹配时，记录初始索引。但是有些关键字是较长关键字的前缀（例如“水”和“水瓶”），代码永远不会找到较长的关键字，因为它会记录“水”的索引，然后重新开始。

如果重要，关键字可能包含小写字母、大写字母、空格、连字符和撇号（以及大小写很重要）。

因此，我们将不胜感激找到最长关键字的任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:25:50.910

如果可以从较小的关键字构建关键字，那么您对有效代码所做的一切就是首先检查较长的关键字。请注意：我根本没有测试这个，我想我已经在这个问题上做了足够的工作！如果这对您有帮助，请不要忘记投票+接受。

IE

```
import java.util.TreeSet;
import java.util.Comparator;
import java.util.LinkedList;
import java.util.HashMap;
import java.util.Iterator;

public class KeywordSearcher {
    private TreeSet<String> ts;

    public KeywordSearcher() {
    ts = new TreeSet<String>(new Comparator<String>() {
    // Sort all the keywords by length, largest first
        public int compare(String arg0, String arg1) {
            if(arg0.length() > arg1.length()) return -1;
            if(arg0.length() == arg1.length()) return 0;
            return 1;
        }});
    }

    public void addKeyword(String s) {
        ts.add(s);
    }

    private LinkedList<Integer> findKeyword(String document, String s) {
        int start = 0;
        int index;
        LinkedList<Integer> indexes = new LinkedList<Integer>();        

        while(true) {
            index = document.indexOf(s, start);
            if (index == -1) break;
            indexes.add(index);
            start = index + s.length();
        }

        return indexes;
    }

    public HashMap<String, LinkedList<Integer>> findAllKeywords(String document) {
        Iterator<String> is = ts.iterator();
        HashMap<String, LinkedList<Integer>> allIndices = new HashMap<String, LinkedList<Integer>>();

        while(is.hasNext()) {
            String nextKeyword = is.next();
        // See if we found a larger keyword, if we did already, skip this keyword
        boolean foundIt = false;
        for (String key : allIndices.keySet()) {
                if(key.contains(nextKeyword)) {
                    foundIt = true;
                    break;
                }
        }
            if (foundIt) continue;

            // We didn't find the larger keyword, look for the smaller keyword
            LinkedList<Integer> indexes = findKeyword(document, nextKeyword);

            if (indexes.size() > 0) allIndices.put(nextKeyword, indexes);
        }

        return allIndices;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:02:46.130

如果我理解正确，如果您在文档中找到“水瓶”，您想跳过搜索“水”。这意味着您的关键字具有某种树结构。

我的建议是将您的关键字排列在这样的排序树上：

```
drank
water bottle
    bottle
    water 
```

在您的代码中，您将首先搜索根中的术语（“drank”和“water bottle”）。如果“水瓶”的匹配数为零，那么您将导航到下一个级别并搜索这些术语（“瓶子”和“水”）。

创建树需要一些工作。

但是使用这种树形结构，您可以拥有多个复合词。

```
clean water bottle
    clean bottle
        clean
    water bottle
        bottle
        water 
```

# file - FileHandler.level 没有覆盖全局级别

> ID：13422805
> 
> 赞同：1
> 
> 时间：2012-11-16T19:04:33.917
> 
> 标签：file, logging, java, java.util.logging

我正在使用 jdk 日志记录，并且在 logging.properties 中有以下内容：

```
handlers= java.util.logging.FileHandler
.level= INFO

java.util.logging.FileHandler.level = FINEST
java.util.logging.FileHandler.pattern = log/soap_%g.log
java.util.logging.FileHandler.limit = 50000
java.util.logging.FileHandler.count = 1
java.util.logging.FileHandler.formatter = java.util.logging.SimpleFormatter

# Limit the message that are printed on the console to INFO and above.
java.util.logging.ConsoleHandler.level = FINEST
java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter

############################################################
# Facility specific properties.
# Provides extra control for each logger.
############################################################

# For example, set the com.xyz.foo logger to only log SEVERE
# messages:
com.pvm.ccd.service.client=FINEST
com.pvm.ccd.service.client.handler=FINEST
com.pvm.ccd.service.client.util=FINEST 
```

正在创建日志文件 soap_0.log 和 lck 文件，但是，我在日志文件中看不到任何 log.fine(msg) 条目。由于我已将 FileHandler 级别设置为 FINEST，它应该覆盖全局 INFO 级别，不是吗？

我是java 1.6 u15。我究竟做错了什么？

我也在[这里](http://www.coderanch.com/t/598066/java/java/FileHandler-level-not-overriding-global#2728132)发布了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-18T20:37:05.400

从[LogManager](http://docs.oracle.com/javase/7/docs/api/java/util/logging/LogManager.html)文档中：

> 假定名称以“.level”结尾的所有属性都定义了 Logger 的日志级别。因此，“foo.level”为名为“foo”的记录器定义了一个日志级别，并（递归地）为其命名层次结构中的任何子级定义了一个日志级别。

以下行不正确：

`com.pvm.ccd.service.client=FINEST com.pvm.ccd.service.client.handler=FINEST com.pvm.ccd.service.client.util=FINEST`

要设置记录器的级别，它需要：

`com.pvm.ccd.service.client.level=FINEST`

# python - 插入 MySQL 时出现 Unicode 错误

> ID：13422806
> 
> 赞同：1
> 
> 时间：2012-11-16T19:04:39.150
> 
> 标签：python, mysql, character-encoding

我有一个脚本，将随机网页的内容存储到 mysql 数据库（[MySQLdb](http://mysql-python.sourceforge.net/MySQLdb.html)）中。对于某些页面，我得到：

```
...
File "/usr/lib/python2.7/dist-packages/MySQLdb/connections.py",
  line 264, in literal
return self.escape(o, self.encoders)                                         
File "/usr/lib/python2.7/dist-packages/MySQLdb/connections.py", 
  line 202, in unicode_literal
return db.literal(u.encode(unicode_literal.charset)) 

UnicodeEncodeError: 'latin-1' codec can't encode character
u'\u203a' in position 172550: ordinal not in range(256) 
```

当我使用[sqlite3](http://docs.python.org/2/library/sqlite3.html)时，我对此没有任何问题。

我试过这个，没有成功：

```
CREATE DATABASE the_base CHARACTER SET utf8 
```

问题：如何正确编码/解码数据，以便将其存储在数据库中而不会*出现任何问题*？

python下的PS字符编码是一个永无止境的故事……

**解决了**

为方法添加了编码`connect`：

```
MySQLdb.connect( ... charset='utf8', use_unicode=True ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:07:26.267

您不能将随机 unicode 存储在只有约 256 个可能条目的编码中（即 latin-1）。将数据库中的编码更改为例如 utf-8，您应该一切顺利。

# python - 递归类斐波那契累积

> ID：13422808
> 
> 赞同：-1
> 
> 时间：2012-11-16T19:04:46.560
> 
> 标签：python, recursion

> **可能重复：**
> [调用 func。改变输入](https://stackoverflow.com/questions/13397445/calling-func-change-the-input)

我必须编写一个递归函数，该函数接受输入中的数字列表并在输出中返回数字列表，例如这样调用：

```
rec_cumsum([2,2,2,3]) 
```

输出应该是这样的：

```
[2,4,6,9] 
```

问题是，我似乎无法解决这个问题..这让我质疑我的整个递归思维..到目前为止我所拥有的是：

```
newlist = []
k = 1
def rec_cumsum(numbers):
    if len(numbers) == 0:
        return 0
    if len(numbers) > 1 and len(numbers) != (k+1):
        newlist[k+1] == newlist[k+1] + newlist[k]
        k = k+1
        return rec_cumsum(numbers) 
```

但我遇到了对我来说没有任何意义的错误。递归应始终采用该数字，并将其添加到它之前的数字，而不是将其保存在列表的下一个位置..（新的或原始的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:14:12.257

我会这样写：

```
def cumulative_sum(lst,prev=0):
    if not lst:
        return []
    else:
        elem = prev+lst[0]
        return [elem] + cumulative_sum(lst[1:],prev=elem)

print cumulative_sum([2,2,2,3]) 
```

* * *

现在查看您的代码（*请注意*，我实际上并没有通过逻辑来决定它是否会给出正确的结果，以下仅解决您的代码可能抛出的可能异常）：

由于这一行，您可能会收到 IndexError ：

```
newlist[k+1] == newlist[k+1] + newlist[k] 
```

您正在分配一个尚不存在的列表位置。您可以预先分配您的列表：

```
newlist = [0]*len(lst) 
```

但即使你解决了这个问题，你的代码也会因为以下行而出现递归错误：

```
k = k + 1 
```

这里的问题是左侧`k`是局部的，而右侧`k`是全局的。所以基本上每次你运行它时，你得到的是本地的`k == 2`，而不是全局的。如果真的要修改全局`k`，需要通过声明`k`为全局`global k`。当然，`k`每次使用这个函数时都需要重新设置，这将是一个有点奇怪的 API。

# android - 难以从 sdcard 获取图像并在图库中显示

> ID：13422811
> 
> 赞同：0
> 
> 时间：2012-11-16T19:04:58.523
> 
> 标签：android, android-layout, android-intent

我似乎在从 sdcard 将图像加载到我的画廊时遇到问题。我知道我对代码做错了，但不知道是什么。谁能帮帮我吗。

这是我的 GalleryActivity.java：

```
import android.app.Activity;
import android.content.Context;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.content.res.TypedArray;
import android.widget.BaseAdapter;
import android.widget.Gallery;
import android.widget.ImageView;
import android.widget.Toast;

public class GalleryActivity extends Activity {

Cursor cursor;

String[] imageIDs = {MediaStore.Images.Thumbnails._ID};
GalleryActivity(MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, imageIDs, null, null,    MediaStore.Images.Thumbnails.IMAGE_ID);
cursor = cursor.getColumnIndexOrThrow(MediaStore.Images.Thumbnails._ID);
{
};
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
        setContentView(R.layout.gallery);
        Gallery gallery = (Gallery) findViewById(R.id.gallery1);
        gallery.setAdapter(new ImageAdapter(this));
        gallery.setOnItemClickListener(new OnItemClickListener()
    {

        public void onItemClick(AdapterView parent, View v,
            int position, long id)
        {
            Toast.makeText(getBaseContext(),"pic" + (position + 1)  + "selected", Toast.LENGTH_SHORT).show();
            }
    });
}

public class ImageAdapter extends BaseAdapter
{
    Context context;
    int itemBackground;
    public ImageAdapter(Context c)
{
        context = c;

        TypedArray a = obtainStyledAttributes(R.styleable.Gallery1);
        itemBackground = a.getResourceId (R.styleable.Gallery1_android_galleryItemBackground,0);
        a.recycle();
}

    public int getCount() {
        return imageIDs.length;
}

    public Object getItem(int position) {
        return position;
}

    public long getItemId(int position) {
        return position;
}

    public View getView(int position, View convertView, ViewGroup parent) {
            ImageView imageView;
                if (convertView == null) {
                    imageView = new ImageView(context);
                    imageView.setImageURI(Uri.withAppendedPath(MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, "" + imageIDs));

                    imageView.setScaleType(ImageView.ScaleType.FIT_XY);
                            imageView.setLayoutParams(new Gallery.LayoutParams(150, 120));
                } else {
                    imageView = (ImageView) convertView;
                }
                imageView.setBackgroundResource(itemBackground);
                return imageView;
    }
}
} 
```

错误在这段代码下，即从 cdcard 中检索图像（这是从 sdcard 中检索图像的正确代码吗？）

```
 String[] imageIDs = {MediaStore.Images.Thumbnails._ID};
 GalleryActivity(MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, imageIDs, null, null,   MediaStore.Images.Thumbnails.IMAGE_ID);
 cursor = cursor.getColumnIndexOrThrow(MediaStore.Images.Thumbnails._ID); 
```

希望有人能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T15:50:33.277

这些代码行已经进入了一个方法。您将它们写在任何方法之外。

```
GalleryActivity(MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, imageIDs, null, null,   MediaStore.Images.Thumbnails.IMAGE_ID);
 cursor = cursor.getColumnIndexOrThrow(MediaStore.Images.Thumbnails._ID); 
```

# java - 如何在android中每5秒调用一次方法？

> ID：13422818
> 
> 赞同：2
> 
> 时间：2012-11-16T19:06:04.653
> 
> 标签：java, android, android-layout, android-widget

我正在使用一个应用程序，当我选择（自动发送按钮打开）时，它必须每 5 秒向服务器发送一次 GPS 位置。我是 android 新手，所以我不知道如何制作开/关按钮，以及如何调用在按钮打开时每 5 秒发送一次数据的方法。

它必须每 5 秒调用一次的方法：

```
public void postData() throws ClientProtocolException, IOException, Exception {

    String longitude="UK";
    String latitude="UK";
    String altitiude="UK";
    String time="";
    String speed="";

    getCurrentLocation(); // gets the current location and update mobileLocation variables

    if (mobileLocation != null) {
        locManager.removeUpdates(locListener); // This needs to stop getting the location data and save the battery power.

         longitude = ""+mobileLocation.getLongitude();
         latitude = "" + mobileLocation.getLatitude();
         altitiude = "" + mobileLocation.getAltitude();
        String accuracy = "Accuracy" + mobileLocation.getAccuracy();
        time = "" + mobileLocation.getTime();
         speed =""+ (int)(4*mobileLocation.getSpeed());

        editTextShowLocation.setText(longitude + "\n" + latitude + "\n"
                + altitiude + "\n" + accuracy + "\n" + time+ "\n" + speed);
    } else {
        editTextShowLocation.setText("Sorry, location is not determined");

    }
        String url = "http://www.itrack.somee.com/post.aspx?id="+"f1"+"&long="+longitude+"&lat="+latitude+"&alt="+altitiude+"&speed="+speed;

        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(url);

        try {

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

        } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        } catch (IOException e) {
        // TODO Auto-generated catch block
        }

} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-16T19:21:36.490

我遇到了完全相同的问题，定期发送位置。我使用了一个处理程序及其`postDelayed`方法。

我的代码的定期调用部分如下所示：

```
private final int FIVE_SECONDS = 5000;
public void scheduleSendLocation() {
    handler.postDelayed(new Runnable() {
        public void run() {
            sendLocation();          // this method will contain your almost-finished HTTP calls
            handler.postDelayed(this, FIVE_SECONDS);
        }
    }, FIVE_SECONDS);
} 
```

然后你只需要`scheduleSendLocation`在你想开始你的经期电话时打电话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:25:29.467

Ridcully 是对的，可能没有理由每 5 秒发送一次当前位置。这是其背后的原因：

你真的只关心关于用户位置的两件事：

1.  他们现在在哪里？

2.  自从我得到他们的第一个位置后，他们搬家了吗？

因此，一旦您获得了令人满意的初始位置，您就可以在用户像这样移动时注册以获取回调：

```
private LocationListener mLocationListener;

@Override
public void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    mLocationListener = new LocationListener() {
        @Override
        public void onLocationChanged(final Location location) {
            updateLocation(location);
        }

        @Override
        public void onStatusChanged(final String provider,
                final int status, final Bundle extras) {
        }

        @Override
        public void onProviderEnabled(final String provider) {
        }

        @Override
        public void onProviderDisabled(final String provider) {
        }
    };
} 
```

话虽如此，您显然可以按照其他人所说的那样每 5 秒运行一次计时器。问题是，大多数好的位置需要 10-20 秒才能运行，因此您可能只想在该时间间隔内运行它。也仅供参考，这会杀死电池

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:09:29.963

查看 AlarmManager 类[http://developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html) ，尤其是 setRepeating 函数。它会比你想要的要复杂一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T19:15:12.953

您可以使用`Timer`. 但是我认为如果你只发送它的位置与你发送的最后一个位置改变了一定距离会更好。这样，您可以发送更少的数据而不会丢失任何信息。

# web-audio-api - 使用网络音频 api 没有声音

> ID：13422821
> 
> 赞同：2
> 
> 时间：2012-11-16T19:06:20.130
> 
> 标签：web-audio-api

我正在试验 Web Audio API

和

```
var context = new webkitAudioContext();
//alert(context);
//alert(context.createOscillator);
var oscillator = context.createOscillator(); 

oscillator.connect(context.destination);
oscillator.noteOn(0); 
```

但我没有声音，所以我想知道我错过了什么

注释掉的警报（上下文）打印 [object AudioContext] 但以下警报打印未定义

当我尝试 alert(context.decodeAudioData) 它的打印是一个函数

感谢您的帮助

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-15T19:12:21.260

您的问题是浏览器之间的 AudioContext 不同。有关固定版本，请参阅[此 jsfiddle](http://jsfiddle.net/vAPYu/1/)。

```
try {
    if (! window.AudioContext) {
        if (! window.webkitAudioContext) {
            bad_browser();
            return;
        }
        window.AudioContext = window.webkitAudioContext;
    }

    context = new AudioContext();
}
catch(e) {
    console.log('Web Audio API is not supported in this browser');
}

var oscillator = context.createOscillator(); 

oscillator.connect(context.destination);
oscillator.noteOn(0); 
```

# php - 在 mongodb 中使用 $in 获取字段

> ID：13422828
> 
> 赞同：1
> 
> 时间：2012-11-16T19:07:01.773
> 
> 标签：php, mongodb, limit

我有一个集合，示例数据是这样的，

{ L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"images", K:"asdd " } { L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"images", K: "asdd" } { L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"images", K:"asdd" } { L:"图片", K:"asdd" }

和其他字段是，{L:"cars",K:"asdff"},{L:"table",K:"asgeg"} 这些字段也至少有 20 个文档，结果我想要的是这样

{ L:"图像", K:"asdd" } { L:"图像", K:"asdd" }

{ L:"汽车", K:"asdd" } { L:"汽车", K:"asdd" }

{ L:"table", K:"asdd" } { L:"table", K:"asdd" }

我想根据他们的 L 字段获取文档，但我想将每个字段的结果限制为两个，我不知道如何管理这个，谢谢你的回复:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T04:11:05.637

鉴于您的架构，我认为没有办法在单个查询中执行您想要的操作。我建议使用带有简单[foreach](http://php.net/manual/en/control-structures.foreach.php)循环或类似循环的 PHP 脚本来提取所需的值，因为您将其标记为 PHP。

当然，您可以使用 3 个单独的查询来完成，每个 L 值一个，限制为 2。我假设我们真的在谈论很多不同的值，而不仅仅是列出的三个。

我不是一个 PHP 人，所以我无法帮助你，但你可以像这样使用 shell 的 JavaScript 功能（我将你的示例数据加载到一个名为 foo 的集合中，它自动添加了一个 _id 字段):

```
db.foo.distinct("L").forEach(function(key) {
    db.foo.find({"L" : key}, {_id : 0}).limit(2).forEach(
        function (value) {
            printjson(value);
        }
    )
}) 
```

我使用 distinct 来生成这三个值，但您可以轻松地将其作为数组传入第一行，如下所示：

```
['images', 'cars', 'table'].forEach(function(key) { 
```

无论哪种方式，该函数都给了我以下输出：

```
{ "L" : "images", "K" : "asdd" }
{ "L" : "images", "K" : "asdd" }
{ "L" : "cars", "K" : "asdd" }
{ "L" : "cars", "K" : "asdd" }
{ "L" : "table", "K" : "asdd" }
{ "L" : "table", "K" : "asdd" } 
```

# android - 按钮保持禁用状态直到第二次点击？

> ID：13422830
> 
> 赞同：0
> 
> 时间：2012-11-16T19:07:13.730
> 
> 标签：android, android-layout, android-emulator

早上好，

我有一个带有 prev 的项目列表。& 下一步按钮。当用户位于列表的开头时，上一个按钮被禁用。单击下一步会将它们带到下一条记录，并且我的单击处理程序将 prev 按钮设置为 true。但是在模拟器中它不显示启用的按钮。单击下一步将我移动到第三条记录，并且处理程序再次将 prev 按钮设置为启用，但这次它确实在模拟器中启用。我在这里抓住了稻草，但我需要使无效和重绘还是什么？我不明白为什么这样的基本任务不起作用。

在 XML 中：

```
<Button
    android:id="@+id/btn_PrevLift"
    ...
    android:enabled="false"
    android:onClick="btn_PrevLiftClick" /> 
```

在处理程序代码中：

```
private void UpdateNavButtonStatus(int z)
{
     ...
     btn_Next.setEnabled(true);
 btn_Prev.setEnabled(true);
     ....
} 
```

不只是为了向您展示我对自己在做什么知之甚少，当我在 Eclipse 调试中查看变量值时，我在任何状态下都看不到启用的属性？？？

![在此处输入图像描述](../Images/3e5769af22bb36dfd261a00540179219.png)

**更多信息** 至少对我来说很奇怪。如果我从使用 XML 定义的事件处理程序转变为以编程方式定义如下，它会很好用！！！？？？

```
btn_Nxt.setOnClickListener(new OnClickListener()
        {
public void onClick(View v)
    {
        //Call helper methods etc...
    }
 }); 
```

**我想我有，但不确定为什么**

因此，当我试图处理我的 Button 对象时，我使用的是 View.findViewById(etc)。当我从 XML 更改为以编程方式声明的事件处理程序时，我使用了 ViewGroup.findViewById。如果我使用 ViewGroup 恢复到 xml，我会得到一个似乎可以工作的“不同”句柄......？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:32:56.240

好的，所以你可以做的是声明一个变量 count 并在单击 f 按钮上增加 count 的值。然后单击 Back 按钮减少 count 的值并给出条件，而 count<0 的任务后退按钮没有做其他什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:39:15.160

我已经确定了问题，当然问题是我自己。我启用了按钮，然后 ListView 正在更新到下一条记录。当然，我的启用按钮在后面，所以当我第二次单击该按钮时，似乎突然启用，但事实并非如此。当我第二次单击时，我们移动到记录三并显示启用的记录二按钮。

看到我的按钮是我的 ListView 的一部分，并且正在为每条记录绘制新按钮。OOHHHH 现在一切的表现都非常有意义。

无论如何，我将按钮从 ListView 布局中移开，以便在用户浏览记录时它们保持不变。

# java - 如果第一张工作表已满，如何在 Excel 中添加其他工作表

> ID：13422838
> 
> 赞同：1
> 
> 时间：2012-11-16T19:07:46.327
> 
> 标签：java, jexcelapi

我正在使用 jExcel API 将数据写入 Excel 工作表。下面是我的代码，它工作正常。但是如果我将大量数据写入 Excel 工作表，我会遇到这个异常 -

```
jxl.write.biff.RowsExceededException: The maximum number of rows permitted on
a worksheet been exceeded 
```

下面是代码。如果第一张工作表不再容纳更多行，我如何将数据写入另一张工作表。有谁可以帮我离开这里吗？

```
 public void write() throws IOException, WriteException {

    readFileIPAddress();

    File file = new File(inputFile);
    WorkbookSettings wbSettings = new WorkbookSettings();

    wbSettings.setLocale(new Locale("en", "EN"));

    WritableWorkbook workbook = Workbook.createWorkbook(file, wbSettings);
    workbook.createSheet("Report", 0);
    WritableSheet excelSheet = workbook.getSheet(0);
    createLabel(excelSheet);
    createContent(excelSheet);

    workbook.write();
    workbook.close();
    }

    private void createLabel(WritableSheet sheet) throws WriteException {

    WritableFont times15pt = new WritableFont(WritableFont.TAHOMA, 11);
    times = new WritableCellFormat(times15pt);
    times.setWrap(true);

    WritableFont times10ptBoldUnderline = new WritableFont(WritableFont.TAHOMA, 13, WritableFont.BOLD, false, UnderlineStyle.SINGLE);
    timesBoldUnderline = new WritableCellFormat(times10ptBoldUnderline);
    timesBoldUnderline.setWrap(true);

    CellView cv = new CellView();
    cv.setFormat(times);
    cv.setFormat(timesBoldUnderline);
    cv.setAutosize(true);

    addCaption(sheet, 0, 0, "IP Address");
    addCaption(sheet, 1, 0, "Digital Element Country Code");
    addCaption(sheet, 2, 0, "Maxmind Country Code");
    addCaption(sheet, 3, 0, "Neustar City");
    addCaption(sheet, 4, 0, "Maxmind City");
    addCaption(sheet, 5, 0, "Neustar Zip Code");
    addCaption(sheet, 6, 0, "Maxmind Zip Code");
    }

     private void createContent(WritableSheet sheet) throws WriteException, RowsExceededException {

    NaEdgeDb edge = null;
    try {
    while (!workQueue.isEmpty()) {
        String ipAddress = workQueue.take();

        edge = new NaEdgeDb();
        edge.set_server_addr(serverIPAddress);
        edge.set_id(10);
        if (checkIPDuplicate.add(ipAddress)) {

            resp = GeoLocationService.getLocationIp(ipAddress, 0);
            edge.naQueryEdge(ipAddress);

            addNumber(sheet, 0, j, ipAddress);

            addNumber(sheet, 1, j, (edge.edge_twoLetterCountry));

            addNumber(sheet, 2, j, (resp.getLocation() != null ? resp.getLocation().getCountry() : null));

            addNumber(sheet, 3, j, (edge.edge_city));

            addNumber(sheet, 4, j, (resp.getLocation() != null ? resp.getLocation().getCity() : null));

            addNumber(sheet, 5, j, (edge.edge_postalCode));

            addNumber(sheet, 6, j, (resp.getLocation() != null ? resp.getLocation().getZipCode() : null));
            j++;
        } 
        } 
    } catch (Exception e) {
        getLogger().log(LogLevel.ERROR, e.fillInStackTrace());
        e.printStackTrace();
    }
  }

    private void addCaption(WritableSheet sheet, int column, int row, String s) throws RowsExceededException,
        WriteException {
    Label label;
    label = new Label(column, row, s, timesBoldUnderline);
    sheet.addCell(label);
    }

    private void addNumber(WritableSheet sheet, int column, int row, String str) throws WriteException,
        RowsExceededException {
    Label number;
    number = new Label(column, row, str);
    sheet.addCell(number);
    } 
```

**更新代码：-**

这仍然抛出相同的异常。不知道为什么？我已经在这段代码中处理了新工作表的创建？这段代码有问题吗？

```
 private void createContent(WritableSheet sheet, WritableWorkbook workbook2) throws WriteException, RowsExceededException {

    NaEdgeDb edge = null;
    WritableSheet ws2 = workbook2.createSheet("sheet2", 2);
    try {
    while (!workQueue.isEmpty()) {
        String ipAddress = workQueue.take(); // generateIPAddress();

        edge = new NaEdgeDb();
        edge.set_server_addr(serverIPAddress);
        edge.set_id(10);
        System.out.println(sheet.getRows());
        if (checkIPDuplicate.add(ipAddress) && sheet.getRows() <= 65536 ) {

            resp = GeoLocationService.getLocationIp(ipAddress, 0);
            edge.naQueryEdge(ipAddress);

            addNumber(sheet, 0, j, ipAddress);

            addNumber(sheet, 1, j, (edge.edge_twoLetterCountry));

            addNumber(sheet, 2, j, (resp.getLocation() != null ? resp.getLocation().getCountry() : null));

            addNumber(sheet, 3, j, (edge.edge_city));

            addNumber(sheet, 4, j, (resp.getLocation() != null ? resp.getLocation().getCity() : null));

            addNumber(sheet, 5, j, (edge.edge_postalCode));

            addNumber(sheet, 6, j, (resp.getLocation() != null ? resp.getLocation().getZipCode() : null));
            j++;
        } else {
            resp = GeoLocationService.getLocationIp(ipAddress, 0);
            edge.naQueryEdge(ipAddress);

            addNumber(ws2, 0, j, ipAddress);

            addNumber(ws2, 1, j, (edge.edge_twoLetterCountry));

            addNumber(ws2, 2, j, (resp.getLocation() != null ? resp.getLocation().getCountry() : null));

            addNumber(ws2, 3, j, (edge.edge_city));

            addNumber(ws2, 4, j, (resp.getLocation() != null ? resp.getLocation().getCity() : null));

            addNumber(ws2, 5, j, (edge.edge_postalCode));

            addNumber(ws2, 6, j, (resp.getLocation() != null ? resp.getLocation().getZipCode() : null));
            k++;
        }
        } 
    } catch (Exception e) {
        getLogger().log(LogLevel.ERROR, e.fillInStackTrace());
        e.printStackTrace();
    }
    System.out.println("Size of HashSet:" + checkIPDuplicate.size());
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:27:43.010

我认为您可以在需要时使用[**WritableWorkbook#createSheet(java.lang.String, int)**](http://jexcelapi.sourceforge.net/resources/javadocs/2_6_10/docs/jxl/write/WritableWorkbook.html#createSheet%28java.lang.String,%20int%29) ) 创建新工作表。

而不是，`WritableSheet`传入方法。使用一些计数器检查当前工作表中添加的行数。如果工作表已满（计数器 == MAX_ROWS），则创建一个新工作表并将行计数器重置为 0。`WritableWorkbook``createContent`

# algorithm - 搜索子目标

> ID：13422840
> 
> 赞同：1
> 
> 时间：2012-11-16T19:08:07.970
> 
> 标签：algorithm, search

我熟悉用于在搜索空间中查找最佳路径的[A* 算法](http://en.wikipedia.org/wiki/A%2a_search_algorithm)，并且正在寻找它的变体，我怀疑它必须是相当标准的。

非正式地，A* 在转换之后遍历一组状态。搜索由启发式函数引导，该函数为每个状态估计到达目标的成本下限。

在操作上，可以用以下值/函数来描述它（请原谅我的 Scala 符号，我相信它比数学更具可读性）：

```
val initial : State
val goal : State

def possibleTransitions(s : State) : Set[Transition]
def followTransition(s : State, t : Transition) : State
def estimateDistance(s1 : State, s2 : State) : Double 
```

...一旦找到过渡到，搜索就会终止`goal`。

我正在寻找一种稍微不同设置的算法：当将转换应用到状态时，我需要生成一*组新状态，而不是生成**一个*新状态。直观地说，这对应于一组子目标，我需要满足这些子目标才能达到最终目标。这会更改签名，如下所示：

 *```
def followTransition(s : State, t : Transition) : Set[State] 
```

当所有分支都解决时，搜索终止。

似乎解决此类问题的一种方法是将它们构建为 A* 问题，其中一个状态对应于我的一组状态，但我不禁相信必须有更好的方法来利用问题的结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T21:22:13.597

如果我正确理解您所追求的，您想要搜索 AND-OR 图。（要解决一个目标，您需要解决所有一组子目标或所有另一组子目标。）执行此操作的标准算法称为 AO*。任何关于人工智能的教科书都会对这个算法有很好的描述。[这里](http://www.cs.cf.ac.uk/Dave/AI2/node26.html)有方法本身的简要概述。搜索*和/或图形启发式搜索*会发现许多其他资源。*

# jquery - 模态框内的表单元素

> ID：13422842
> 
> 赞同：1
> 
> 时间：2012-11-16T19:08:08.837
> 
> 标签：jquery, twitter-bootstrap

我尝试将我的登录表单放入模式中，并将 data-dismiss="modal" 添加到提交按钮。模式已成功关闭，但 POST 方法似乎没有“触发”并且页面保持不变。还有其他人尝试将表单放入模态并使其正常工作吗？

```
 <div class="modal hide fade" id="signin-register" tabindex="-1" role="dialog" aria-labelledby="image-modal-label" aria-hidden="true">

    <div class="modal-body">
        <div class="row-fluid">
            <div class="span12">

            <div class="span6">
                <div class="row-fluid">
                    <div class="span12">

                        <legend>Sign in</legend>

                        <form class="navbar-form pull-right" method="POST" action="login/">
                          <input type="hidden" name="a" value="validate" />
                            <input class="input-small" type="text" placeholder="Username" name="username">
                            <input class="input-small" type="password" placeholder="Password" name="password">
                            <button class="btn btn-small btn-info" type="submit" class="btn2" data-dismiss="modal"><strong>sign in</strong></button>
                        </form>

                        <legend>Register</legend>

                        <form action="" method="POST" id="register_form">

                            <label>Username:*</label><input class="input-small" type="text" name="username" placeholder="Username" />

                            <label>Password:*</label><input class="input-small" type="password" name="password" placeholder="Password" />

                            <label>Email:*</label><input type="text" name="email" placeholder="E-mail" /><br>
                            <input type="submit" name="a" value="Register" data-dismiss="modal"/>

                         </form>

                    </div>
                </div>
            </div>

            <div class="span6">
                <div class="row-fluid">
                    <div class="span12">

                    </div>
                </div>
            </div>

            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</div> 
```

我再次确认登录表单在模式之外工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:16:56.907

分配`data-dismiss`给链接或按钮将拦截该按钮的单击事件并防止其冒泡。如果您放置`data-dismiss`表单提交按钮，则永远不会触发实际的“提交”操作并且不会提交表单。

如果您要通过 AJAX 提交表单，请让成功事件触发关闭表单。如果您正在做一个传统的表单发布，不要担心关闭模式，因为页面会重新加载或重定向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T19:13:49.113

元素`data-dismiss="modal"`应该是用于关闭模式，任何默认行为（如提交表单）都将被覆盖。

如果您需要提交表单，请不要在提交按钮上使用此属性。就那么简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T19:14:21.770

它很容易。您不需要提交时的 data-dismiss 属性。我正在使用 MVC4，并且经常这样做：

```
<div id="mdlProceed" class="modal hide fade" data-backdrop="static" data-keyboard="false">
        <div class="modal-header">
            <h3>Header</h3>
        </div>
        <div class="modal-body">
         Body
        </div>
        @using (Html.BeginForm(null, null,
                               new { area = "MyArea", controller = "MyController", action = "MyAction" }, FormMethod.Post))
        {
            @Html.AntiForgeryToken()

            <div class="modal-footer">
                <input type="button" name="cancel" id="cancel" accesskey="c" class="btn btn-warning" data-dismiss="modal" value="Cancel" alt="Return" />
                <input type="submit" name="start" id="start" accesskey="n" class="btn btn-primary" data-loading-text="Please Wait..." value="Continue" />
            </div>
        }
    </div> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-16T19:15:03.303

我试过了，效果很好！

```
<div style="width:800px"  class="modal hide fade">
    <div class="modal-header">Some header
    </div>
    <div class="modal-body">Some body
    <input...... fields..... >
    </div>
    <div class="modal-footer">  
       <input class="btn btn-primary" value="Submit" onclick="SubmitData();">
       <a href="#" class="btn" data-dismiss="modal" >Close</a>
    </div>
</div> 
```

# java - (URL) 字符串不能转换为 JSONObject

> ID：13422843
> 
> 赞同：0
> 
> 时间：2012-11-16T19:08:09.513
> 
> 标签：java, android, json, imageview

更新：代码很好。这只是指向数据库的错误指针。

我正在使用 JSONParser 方法发出 http 请求以获取 JSON 数据并从数据库返回 JSONObject。获取 JSONObject 并显示名称和电子邮件等字符串没有问题，但它没有检索图像的 URL。我没有收到任何错误，但它只是显示空字段。

但是，如果我从

```
String imageURL = directory.getString(TAG_IMG); 
```

对此

```
String imageURL = "http://mywebsite.com/images/photo1.png"; 
```

它工作正常。

```
//URL to make request
private static final String url_veiw_directory = "http://www.myweb.com/android/include/directory_detail_me.php";

private static final String TAG_SUCCESS = "success";
private static final String TAG_DIRECTORY = "directory";
private static final String TAG_ID = "user_id";
private static final String TAG_IMG = "photo"; // Image URLs stored in the DB
private static final String TAG_NAME = "name";
private static final String TAG_EMAIL = "email";

//Get JSONObject by httpRequest
JSONObject json = jsonParser.makeHttpRequest(url_veiw_directory, "GET", params);

Log.d("my profile", json.toString());

 if (success == 1) {

    JSONArray directoryObj = json.getJSONArray(TAG_DIRECTORY);  

    JSONObject directory = directoryObj.getJSONObject(0);

    //User Image                            
    int loader = R.drawable.loader; 

    String imageURL = directory.getString(TAG_IMG);                         
    ImageView imagePhoto = (ImageView) findViewById(R.id.photo);

    ImageLoader imgLoader = new ImageLoader(getApplicationContext());        
    imgLoader.DisplayImage(imageURL, loader, imagePhoto);

    //User Name and Email                           
    TextView txtName = (TextView) findViewById(R.id.name);
    TextView txtEmail = (TextView) findViewById(R.id.email);                            

    txtName.setText(directory.getString(TAG_NAME));
    txtEmail.setText(directory.getString(TAG_EMAIL));

//Image Loader Class

public void DisplayImage(String url, int loader, ImageView imageView)
    {
        stub_id = loader;
        imageViews.put(imageView, url);
        Bitmap bitmap=memoryCache.get(url);
        if(bitmap!=null)
            imageView.setImageBitmap(bitmap);
        else
        {
            queuePhoto(url, imageView);
            imageView.setImageResource(loader);
        }
    }

    private void queuePhoto(String url, ImageView imageView)
    {
        PhotoToLoad p=new PhotoToLoad(url, imageView);
        executorService.submit(new PhotosLoader(p));
    }

    private Bitmap getBitmap(String url)
    {
        File f=fileCache.getFile(url);

        //from SD cache
        Bitmap b = decodeFile(f);
        if(b!=null)
            return b;

        //from web
        try {
            Bitmap bitmap=null;
            URL imageUrl = new URL(url);
            HttpURLConnection conn = (HttpURLConnection)imageUrl.openConnection();
            conn.setConnectTimeout(30000);
            conn.setReadTimeout(30000);
            conn.setInstanceFollowRedirects(true);
            InputStream is=conn.getInputStream();
            OutputStream os = new FileOutputStream(f);
            ImageUtils.CopyStream(is, os);
            os.close();
            bitmap = decodeFile(f);
            return bitmap;
        } catch (Exception ex){
           ex.printStackTrace();
           return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:19:13.643

最可能的原因是`imageURL`字符串是空的，或者更有可能（因为您是从数据库中提取它）它被转义为使其无法用作 URL 的形式。我建议将其打印出来并查看您可能可以取消转义或进行一些字符替换的值

你可能会看到类似`http%3A//mywebsite.com/images/photo1.png`

# build - 找不到要作为输入文件资源嵌入的概念架构节点

> ID：13422851
> 
> 赞同：12
> 
> 时间：2012-11-16T19:08:34.770
> 
> 标签：build, error-handling, schema

刚刚使用 Entity Framework 5.0 更新到 .NET 4.5 框架，尝试构建时出现以下错误：

*   找不到要作为输入文件“E:\Builds\1\Mobooka v2\Mobooka.Services\Sources\Mobooka.DAL\Tracking.edmx”资源嵌入的概念架构节点。

*   找不到存储架构节点作为输入文件“E:\Builds\1\Mobooka v2\Mobooka.Services\Sources\Mobooka.DAL\Tracking.edmx”的资源嵌入。

*   找不到映射节点作为输入文件“E:\Builds\1\Mobooka v2\Mobooka.Services\Sources\Mobooka.DAL\Tracking.edmx”的资源嵌入。

我只通过谷歌找到了大约 3 篇与此问题相关的帖子，但没有一个提供解决方案。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T21:40:05.063

在 TFS 上构建时，您是否遇到过这个问题？

如果是这样，我今天遇到了同样的问题：

```
Could not find the Conceptual Schema node to embed as a resource for input file ...
Could not find the Storage Schema node to embed as a resource for input file ...
Could not find the Mapping node to embed as a resource for input file ... 
```

我们的[常驻构建专家](https://stackoverflow.com/users/200936/christopher-painter)告诉我 TFS 构建服务器没有加载 .NET 4.5。

为了解决这个问题，我将项目属性设置为 .NET 4.0 而不是 .NET 4.5，重新生成了我的 EDMX 文件/服务，并成功构建/签入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T22:31:54.590

您的服务器计算机上是否安装了 .NET 4.5？

就我而言，构建服务器上没有安装[.NET 4.5 。](http://www.microsoft.com/en-us/download/details.aspx?id=30653)尽管@Mike 的回答表明您可以改为针对 v4.0 进行构建，但只需在构建服务器上安装 .NET 框架 4.5 即可解决我的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-16T16:16:54.247

.net 4.5 is not installed on our build server, my projects are all targetting .net 4 and I am not in a position to update the framework version on the build server.

In my situation I downgraded the edmx file by editing the xml namespaces.

```
<edmx:Edmx Version="3.0" xmlns:edmx="http://schemas.microsoft.com/ado/2009/11/edmx"> 
```

Became:

```
<edmx:Edmx Version="2.0" xmlns:edmx="http://schemas.microsoft.com/ado/2008/10/edmx"> 
```

And:

```
xmlns="http://schemas.microsoft.com/ado/2008/09/edm"

xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" 
```

Became:

```
xmlns="http://schemas.microsoft.com/ado/2009/11/edm" annotation:UseStrongSpatialTypes="false"

xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" 
```

# mysql - 将连接成字符串的数据实体分开的最佳分隔符是什么？

> ID：13422855
> 
> 赞同：0
> 
> 时间：2012-11-16T19:09:01.833
> 
> 标签：mysql, string, string-concatenation

假设有多个数据实体需要保存在数据库（MySQL）中，例如*font-size*、*font-weight*、*color*等，其中一些具有固定值，而另一些是应用程序用户输入的字符串，所以他们可以保持任何角色。所有这些信息都需要连接起来并存储为一个长字符串。

在这些实体之间使用的最佳分隔符是什么（假设是一个小字符串），以避免在用户输入的文本中找到该分隔符的情况？

顺便说一句：我不能为每个单独的实体创建多个列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:16:29.883

也许使用一些像json这样的数据结构语言？

```
<?php 
// Array of strings
$strings = array('string1', 'string2', 'string3');

// Encode in json (return string)
$json = json_encode($strings);

// Add to your database
funcThatUpdateYourDatabase($json); 
```

之后：

```
<?php
// Retrieve json from database;
$json = funcThatRetrieveYourColumn($json);

// convert back in array
$strings = json_decode($json); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:15:14.507

尽管您的要求听起来很奇怪，但只需使用 /*^$%{] 之类的标点字符串来分隔值。偶然发生的可能性很小。显然，字符串越长使用起来就越安全。

# python - Python 类型错误：尝试打印字符串和整数时出错

> ID：13422856
> 
> 赞同：0
> 
> 时间：2012-11-16T19:09:04.847
> 
> 标签：python, string, syntax, integer, operators

现在，我正在编写一个程序来计算如果您要向一群人进行演示并且您必须打印演示文稿的副本，您需要购买多少令纸。当我去运行程序时，它会出现：

```
Traceback (most recent call last):
File "C:/Users/Shepard/Desktop/Assignment 5.py", line 11, in <module>
print ("Total Sheets: " & total_Sheets & " sheets")
TypeError: unsupported operand type(s) for &: 'str' and 'int'
>>> 
```

我想做的是：

```
print ("Total Sheets: " & total_Sheets & " sheets")
print ("Total Reams: " & total_Reams & " reams") 
```

我不应该使用 & 运算符将字符串和整数类型与打印结合起来吗？如果没有，我做错了什么？

这是我的整个程序。

```
ream = 500
report_Input = int (input ("How many pages long is the report?"))
people_Input = int (input ("How many people do you need to print for? -Automatically prints five extras-"))

people = people_Input + 5

total_Sheets = report_Input * people
total_Reams =((total_Sheets % 500) - total_Sheets) / people

print ("Total Sheets: " & total_Sheets & " sheets")
print ("Total Reams: " & total_Reams & " reams") 
```

**编辑：在我发布这个之后，我发现 Jon Clements 的答案是最好的答案，而且我还发现我需要输入一个 if 语句才能使其工作。这是我完成的代码，感谢所有帮助。**

```
ream = 500
report_Input = int (input ("How many pages long is the report?"))
people_Input = int (input ("How many people do you need to print for? -Automatically prints five extras-"))

people = people_Input + 5

total_Sheets = report_Input * people
if total_Sheets % 500 > 0:
    total_Reams =(((total_Sheets - abs(total_Sheets % 500))) / ream)+1
else:
    total_reams = total_Sheets / ream

print ("Total Sheets:", total_Sheets, "sheets")
print ("Total Reams:", total_Reams, "reams") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:11:08.010

首先`&`不是串联运算符（它是按位和运算符） - 那是，但即使在 a和...`+`之间也不起作用，您可以使用`str``int`

Python2.x

```
print 'Total Sheets:', total_Sheets, 'sheets' 
```

Python 3.x

```
print ('Total Sheets:', total_Sheets, 'sheets') 
```

或者，您可以使用字符串格式：

```
print 'Total Sheets: {0} sheets'.format(total_Sheets) 
```

（注意：从 2.7+ 开始，您可以省略位置参数，`{}`如果需要，只需使用）

# android - 当我点击通知时，活动不显示数据

> ID：13422857
> 
> 赞同：0
> 
> 时间：2012-11-16T19:09:05.170
> 
> 标签：android, push-notification

我正在使用包含在 android sdk 文件夹中的 android 推送通知的示例代码。我面临一个问题，即当我在通知栏中单击通知时，它会显示一个空白活动，我也尝试使用显示警报对话，但如果我在活动中，那么它将显示消息（在 TextView 中）和警报对话也不会。我该怎么做才能显示消息。我只想在单击通知时显示警报对话框。

**GCMIntentService.java**

```
package com.example.testgcm;

import static com.example.testgcm.CommonUtilities.SENDER_ID;
import static com.example.testgcm.CommonUtilities.displayMessage;

import android.app.AlertDialog;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.support.v4.app.NotificationCompat;
import android.support.v4.app.TaskStackBuilder;
import android.util.Log;
import com.google.android.gcm.GCMBaseIntentService;

public class GCMIntentService extends GCMBaseIntentService{

    public GCMIntentService()
    {
        super(SENDER_ID);
    }

    @Override
    public void onRegistered(Context context, String regId)
    {
        Log.i(TAG, "Device registered: regId = " + regId);
        String msg="Your device registred with GCM"+regId;
        //displayMessage(context, msg);
        /*Log.d("NAME", MainActivity.name);
        Server.register(context, MainActivity.name, regId);*/

    }

    @Override
    public void onUnregistered(Context context, String regId)
    { 
        Log.i(TAG, "Device unregistered");
        displayMessage(context, getString(R.string.gcm_unregistered));
        Server.unregister(context, regId);
    }

    @Override
    public void onMessage(Context context, Intent intent)
    {
        String message = intent.getExtras().getString("message");
        Log.i(TAG, "Received message");
        Log.i("Message: ", message);

        displayMessage(context, message);

        // notifies user
        generateNotification(context, message);
    }

    @Override
    protected void onError(Context context, String errorMsg) {
        Log.i(TAG, "Received error: " + errorMsg);
        displayMessage(context, getString(R.string.gcm_error, errorMsg));

    }

    @Override
    protected boolean onRecoverableError(Context context, String errorMsg) {
        Log.i(TAG, "Received recoverable error: " + errorMsg);
        displayMessage(context, getString(R.string.gcm_recoverable_error,errorMsg));
        return super.onRecoverableError(context, errorMsg);
    }

     @SuppressWarnings("deprecation")
    private static void generateNotification(Context context, String message) {
            int icon = R.drawable.ic_launcher;
            long when = System.currentTimeMillis();
            NotificationManager notificationManager = (NotificationManager)
                    context.getSystemService(Context.NOTIFICATION_SERVICE);
            @SuppressWarnings("deprecation")
            Notification notification = new Notification(icon, message, when);

            String title = context.getString(R.string.app_name);

            Intent notificationIntent = new Intent(context, MainActivity.class);
            notificationIntent.putExtra("NEW", message);
            // set intent so it does not start a new activity
            notificationIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP |
                    Intent.FLAG_ACTIVITY_SINGLE_TOP);

            PendingIntent intent =
                    PendingIntent.getActivity(context, 0, notificationIntent, 0);
            notification.setLatestEventInfo(context, title, message, intent);
            notification.flags |= Notification.FLAG_AUTO_CANCEL;

            // Play default notification sound
            notification.defaults |= Notification.DEFAULT_SOUND;

            // Vibrate if vibrate is enabled
            notification.defaults |= Notification.DEFAULT_VIBRATE;
            notificationManager.notify(0, notification);     
        }

} 
```

**MainActivity.java**

```
package com.example.testgcm;

import static com.example.testgcm.CommonUtilities.DISPLAY_MESSAGE_ACTION;
import static com.example.testgcm.CommonUtilities.EXTRA_MESSAGE;
import static com.example.testgcm.CommonUtilities.SENDER_ID;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.IntentFilter;
import android.util.Log;
import android.widget.TextView;
import android.widget.Toast;

import com.google.android.gcm.GCMRegistrar;

public class MainActivity extends Activity {

    AsyncTask<Void, Void, Void> mRegisterTask;
    TextView mDisplay;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mDisplay = (TextView) findViewById(R.id.display);

        GCMRegistrar.checkDevice(this);
        GCMRegistrar.checkManifest(this);

        registerReceiver(mHandleMessageReceiver, new IntentFilter(
                DISPLAY_MESSAGE_ACTION));

        final String regId = GCMRegistrar.getRegistrationId(this);
        if (regId.equals("")) 
        {
            GCMRegistrar.register(this, SENDER_ID);
            String rid=GCMRegistrar.getRegistrationId(this);
            Log.e("Registration ID: ", rid);
            Toast.makeText(getApplicationContext(), "Registration ID: " + rid, Toast.LENGTH_LONG).show();
            mDisplay.append("Registration ID: " + regId);
        } 
        else 
        {
            if (GCMRegistrar.isRegisteredOnServer(this)) 
            {
                Log.v(getClass().getSimpleName(), "Already registered");
                Log.e("Registration ID: ", regId);
                Toast.makeText(getApplicationContext(), "Registration ID: " + regId, Toast.LENGTH_LONG).show();
                mDisplay.append("Registration ID: \n" + regId);
            }
            else
            {
                final Context context = this;
                mRegisterTask = new AsyncTask<Void, Void, Void>() {

                    @Override
                    protected Void doInBackground(Void... arg0) {
                        // TODO Auto-generated method stub

                        //   Server.register(context, name,  regId);

                        return null;
                    }
                    @Override
                    protected void onPostExecute(Void result) {
                        mRegisterTask = null;
                    }   
                };
                mRegisterTask.execute(null, null, null);
            }
        }
    }

    private final BroadcastReceiver mHandleMessageReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            String newMessage = intent.getExtras().getString(EXTRA_MESSAGE);

            String message = intent.getExtras().getString("NEW");
            // Waking up mobile if it is sleeping
            WakeLocker.acquire(getApplicationContext());

            // Showing received message
            mDisplay.append(newMessage + "\n");
        //  Toast.makeText(getApplicationContext(), newMessage, Toast.LENGTH_LONG).show();
            displayAlert(newMessage);
            //  displayAlert( newMessage);

            // Releasing wake lock
            WakeLocker.release();
        }
    };

    @Override
    protected void onDestroy() {
        if (mRegisterTask != null) {
            mRegisterTask.cancel(true);
        }
        try {
            unregisterReceiver(mHandleMessageReceiver);
            GCMRegistrar.onDestroy(this);
        } catch (Exception e) {
            Log.e("UnRegister Receiver Error", "> " + e.getMessage());
        }
        super.onDestroy();
    }

    private void displayAlert(String message)
    {
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setMessage(message).setCancelable(
                false).setPositiveButton("Yes",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int id) {
                        dialog.cancel();
                    }
                }).setNegativeButton("No",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int id) {
                        dialog.cancel();
                    }
                });
        AlertDialog alert = builder.create();
        alert.show();
    }
} 
```

**CommonUtilities.java**

```
package com.example.testgcm;

import android.content.Context;
import android.content.Intent;

public class CommonUtilities {

    static final String SERVER_URL = "http://10.0.2.2/api/Product?";

    // Google project id
    static final String SENDER_ID = "xxxxxxxxxxxxx"; 

    static final String TAG = "Test App";

    static final String DISPLAY_MESSAGE_ACTION =
            "com.example.testgcm.DISPLAY_MESSAGE";

    static final String EXTRA_MESSAGE = "message";

    static void displayMessage(Context context, String message) {
        Intent intent = new Intent(DISPLAY_MESSAGE_ACTION);
        intent.putExtra(EXTRA_MESSAGE, message);
        context.sendBroadcast(intent);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T04:07:34.257

The problem is that the piece of code that sends the message broadcast intent gets executed when the notifications arrives, but not when the user opens the notification.

```
@Override
public void onMessage(Context context, Intent intent)
{
    String message = intent.getExtras().getString("message");
    Log.i(TAG, "Received message");
    Log.i("Message: ", message);

    displayMessage(context, message);

    // notifies user
    generateNotification(context, message);
} 
```

At the point where displayMessage(context, message) is executed, there's no BroadcastListener to catch your message event.

However, if the user has the activity open an another notification arrives, it will be displayed, since you have registered the listener within the activity context.

You should set the message to the TextView and on the MainActivity.onCreate or MainActivity.onResume method considering that you already have the "MSG" extra at that point. Leave the broadcaste receiver to update the activity textview everytime a new notification arrives.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-08T11:17:30.767

检查您是否已在`AndroidManifest.xml`

# javascript - 从 javascript 函数中取出一个变量

> ID：13422858
> 
> 赞同：0
> 
> 时间：2012-11-16T19:09:07.620
> 
> 标签：javascript, function, variables, document.write

我有这个功能（我没有写）：

```
 <script>
      ab(function(r) {  
        var field_number = r.get('field_number'); 
        alert(field_number); 
      });
    </script> 
```

警报工作正常，因此 field_number 是正确的，但 document.write 不起作用。我需要在函数之外提取 field_number 的值，以使其适用于 html 的其他部分：

```
<script>document.write(field_number);</script> 
```

我怎样才能把它弄出来？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:22:24.210

如果不是异步调用，`ab()`可以设置全局变量：

```
 <script>
      var field_number="";
      ab(function(r) {  
        field_number = r.get('field_number'); 
        alert(field_number); 
      });
      // you can use variable here
    </script> 
```

或者你可以从函数中返回它并分配给变量然后使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T07:00:31.647

最简单和最好的方法是：

```
<script>

var a="";    //global variable

    function process()
    {
        a=1;
    process_another(a)    //another function in which you want the value of a 

    }

    function process_another(a)
    {
        alert(a);   //value of a will be shown: 1 as it was in function process() 
        } 
          </script> 
```

# maven-3 - Maven/Tycho 构建中的第三方捆绑依赖项

> ID：13422859
> 
> 赞同：-1
> 
> 时间：2012-11-16T19:09:17.013
> 
> 标签：maven-3, maven-plugin, tycho

如何处理 Maven/Tycho 构建中的第三方捆绑包依赖项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T03:59:12.697

创建一个 P2 存储库，然后引用该存储库。这是推荐的方法。

如果您想保持构建位置独立，请将存储库存储在允许 HTTP 协议访问的位置。例如

*   具有文件写入权限的 Web 服务器
*   一个 webdav 商店
*   一个SVN版本控制系统。

创建 P2 存储库

1.  [创建一个eclipse目标](http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Fguide%2Ftools%2Ftarget_shared%2Fnew_target_wizard.htm&resultof=%22%74%61%72%67%65%74%22%20%22%64%65%66%69%6e%69%74%69%6f%6e%22%20%22%64%65%66%69%6e%69%74%22%20)，
2.  将所需的捆绑包安装到其中，然后
3.  [创建一个功能，添加插件](http://help.eclipse.org/juno/topic/org.eclipse.pde.doc.user/guide/tools/project_wizards/new_feature_project.htm?resultof=%22%66%65%61%74%75%72%65%22%20%22%66%65%61%74%75%72%22%20)
4.  [导出 P2 存储库。](http://help.eclipse.org/juno/topic/org.eclipse.pde.doc.user/guide/tools/export_wizards/export_features.htm?resultof=%22%65%78%70%6f%72%74%22%20)
5.  将存储库存储在众所周知的位置
6.  通过这三个选项之一引用第谷构建的位置
    1.  存储库定义中的 Eclipse 目标文件
    2.  存储库定义中的 URL
    3.  包定义 tycho 模块中的 eclipse 目标。

或者，作为来源

*   如果 3PD 在 Eclipse Orbit 中可用，您可以[直接参考 Orbit P2 站点](http://download.eclipse.org/tools/orbit/downloads/)
*   如果 3PD 在 Maven Central 中可用，您可以使用[Tycho POM first build](http://www.google.com.au/url?sa=t&rct=j&q=tycho%20pom-first&source=web&cd=2&ved=0CCoQFjAB&url=http%3A%2F%2Fwiki.eclipse.org%2FTycho%2FHow_Tos%2FDependency_on_pom-first_artifacts&ei=bwmnUPq4Js2jigejqYHoDg&usg=AFQjCNElm01Fwh2dvgOuZn2RrgxMEarljw&sig2=Z10yWtV6rihONfCvlbPZaA)。请注意此构建无法在同一反应堆运行中生成其他可交付成果的限制，如操作指南中所述。

# ubuntu-12.04 - 稀疏矩阵的红黑高斯西德尔

> ID：13422860
> 
> 赞同：1
> 
> 时间：2012-11-16T19:09:22.037
> 
> 标签：ubuntu-12.04

使用 Red-Black 方法，我们将解矩阵排列为 (n*n) 个元素的二维数组，并交替执行 R & B 计算。

在稀疏矩阵的情况下，我们是否也应该像对待 Jacobi 或正常 Siedel 一样单独考虑零项或仅考虑非零项？

对不起，如果这个问题太基本了。我是迭代求解器的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-15T12:56:07.383

我可以想到两种方法：

(1) 您没有以不同的表示形式表示稀疏矩阵，即您没有使用稀疏矩阵的数组或链表表示。在这种情况下，您肯定需要考虑所有条目，因为如果不访问特定条目，您将不知道条目是否为 0。

(2) 您已经使用数组或链接列表以较短的形式表示了稀疏矩阵。在这种情况下，更容易查看条目是否为 0，因为仅存储非零条目。因此，在这种情况下，您可能不会考虑为零的条目。

# c++ - 在 OpenGL c++ 项目中使用资源中的 .tga (targa) 文件

> ID：13422862
> 
> 赞同：1
> 
> 时间：2012-11-16T19:09:27.420
> 
> 标签：c++, opengl, resources

我正在尝试为我的 3D 模型创建纹理。只要我只加载图像文件，它就可以正常工作。我正在使用 Microsoft Visual C++ 2008 Express，我一直在寻找解决这个“问题”的方法，将资源中的 .tga 加载到我的项目中，并将其用作 OpenGL 纹理。

```
//resource.h
#define TEST_TGA 201

//resource.rc
TEST_TGA TGA "test.tga" 
```

我不知道我是否真的可以做到这一点？但我真的很难找到任何关于此的文章或主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:20:01.423

您可以使用[stb_image](http://nothings.org/stb_image.c)库来加载其他格式的 TGA 图像。您应该能够使用诸如[LoadResource](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648046%28v=vs.85%29.aspx)之类的 Windows API 函数获取资源数据。检查[此答案](https://stackoverflow.com/a/9240388/160539)以获取有关加载二进制资源的示例代码。

# .net - 多个线程等待 NetworkStream.Read

> ID：13422866
> 
> 赞同：0
> 
> 时间：2012-11-16T19:09:31.693
> 
> 标签：.net, multithreading, networking

我想知道如果有多个线程使用*System.Net.Sockets.NetworkStream.Read*等待数据可用会发生什么：

```
 numberOfBytesRead = myNetworkStream.Read(myReadBuffer, 0, myReadBuffer.Length); 
```

共享*myNetworkStream*的位置。当数据可用时，是只有一个线程看到它还是所有线程都看到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:14:40.623

从[文档](http://msdn.microsoft.com/en-us/library/system.net.sockets.networkstream.aspx)中：

> 对简单的单线程同步阻塞 I/O 使用 Write 和 Read 方法。如果要使用单独的线程处理 I/O，请考虑使用 BeginWrite 和 EndWrite 方法，或 BeginRead 和 EndRead 方法进行通信。
> 
> ...
> 
> 可以在 NetworkStream 类的实例上同时执行读取和写入操作，而无需同步。只要写操作有一个唯一线程，读操作有一个唯一线程，读写线程之间就不会发生交叉干扰，也不需要同步。

所以我会说行为是不确定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:42:39.413

如果您的 NetworkStream 是共享的，那么您的线程将相互干扰。根据我自己的经验，每个线程可以共享一个 Socket，例如，如果您为服务器执行此操作，则服务器上的每个线程都可以继续侦听同一个套接字，然后当客户端到达时，一个线程将开始为它服务，然后在另一个客户端到达后，其他线程将开始为它服务，并且它们不会相互干扰。

# intellij-idea - 设备配置显示没有默认设备。如何解决这个问题？

> ID：13422872
> 
> 赞同：6
> 
> 时间：2012-11-16T19:10:01.473
> 
> 标签：intellij-idea

全新安装的 IDEA 11 和设备配置屏幕如下所示。

![](../Images/006574b4f53355669f4921e12be6d1ed.png)

正如我从 IDEA 的文档中发现的那样，默认内容是从位于的 XML 文件中提取的

`Default configurations are stored in Sdk_Directory/tools/lib/devices.xml`

我找到了这个文件，发现里面内容很丰富。但是，设备配置屏幕仍然是空的。

重复一遍，全新安装 IDEA 11（与 IDEA 12 预览版相同）和全新安装 Android SDK。

为什么会发生这种情况以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T08:47:54.743

我是如何解决这个问题的！

IntelliJ 团队的这句话帮助了我

> ```
> 1\. Custom configurations are stored in Home_Directory/.android/devices.xml
> 2\. Default configurations are stored in Sdk_Directory/tools/lib/devices.xml 
> ```

1.  安装了全新的 Android SDK
2.  从中提取 devices.xml 文件`Sdk_Directory/tools/lib/devices.xml`
3.  复制到`Home_Directory/.android/devices.xml`

预览窗格返回到**所有设备**的先前状态。

PS。这是 Linux 的解决方案，但相同的文件也存在于 Windows 版本中

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-19T07:05:26.293

从以前版本的 SDK 中插入文件 %USER%\.android\devices.xml 数据。例如，下面：

```
 <?xml version="1.0"?>
<d:layout-devices
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:d="http://schemas.android.com/sdk/android/layout-devices/1">

    <d:device name="2.7in QVGA">
        <d:default>
            <d:screen-size>small</d:screen-size>
            <d:screen-ratio>notlong</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>ldpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>240</d:size>
                <d:size>320</d:size>
            </d:screen-dimension>
            <d:xdpi>145</d:xdpi>
            <d:ydpi>145</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="2.7in QVGA slider">
        <d:default>
            <d:screen-size>small</d:screen-size>
            <d:screen-ratio>notlong</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>ldpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:text-input-method>qwerty</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>240</d:size>
                <d:size>320</d:size>
            </d:screen-dimension>
            <d:xdpi>145</d:xdpi>
            <d:ydpi>145</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape, closed">
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
        <d:config name="Landscape, open">
            <d:keyboard-state>keysexposed</d:keyboard-state>
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="3.2in HVGA slider (ADP1)">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>notlong</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>mdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:text-input-method>qwerty</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>trackball</d:nav-method>
            <d:screen-dimension>
                <d:size>320</d:size>
                <d:size>480</d:size>
            </d:screen-dimension>
            <d:xdpi>180.6</d:xdpi>
            <d:ydpi>182</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape, closed">
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
        <d:config name="Landscape, open">
            <d:keyboard-state>keysexposed</d:keyboard-state>
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="3.2in HVGA (ADP2)">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>notlong</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>mdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>trackball</d:nav-method>
            <d:screen-dimension>
                <d:size>320</d:size>
                <d:size>480</d:size>
            </d:screen-dimension>
            <d:xdpi>180.6</d:xdpi>
            <d:ydpi>182</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="3.3in WQVGA">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>ldpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>240</d:size>
                <d:size>400</d:size>
            </d:screen-dimension>
            <d:xdpi>141</d:xdpi>
            <d:ydpi>141</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>
    <d:device name="3.4in FWQVGA">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>ldpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>240</d:size>
                <d:size>432</d:size>
            </d:screen-dimension>
            <d:xdpi>145</d:xdpi>
            <d:ydpi>145</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="3.7in WVGA (Nexus One)">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>hdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>trackball</d:nav-method>
            <d:screen-dimension>
                <d:size>480</d:size>
                <d:size>800</d:size>
            </d:screen-dimension>
            <d:xdpi>254</d:xdpi>
            <d:ydpi>254</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="3.7in FWVGA slider">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>hdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:text-input-method>qwerty</d:text-input-method>
            <d:nav-state>navhidden</d:nav-state>
            <d:nav-method>dpad</d:nav-method>
            <d:screen-dimension>
                <d:size>480</d:size>
                <d:size>854</d:size>
            </d:screen-dimension>
            <d:xdpi>265</d:xdpi>
            <d:ydpi>265</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape, closed">
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
        <d:config name="Landscape, open">
            <d:keyboard-state>keysexposed</d:keyboard-state>
            <d:screen-orientation>land</d:screen-orientation>
            <d:nav-state>navexposed</d:nav-state>
        </d:config>
    </d:device>

    <d:device name="4in WVGA (Nexus S)">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>hdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>480</d:size>
                <d:size>800</d:size>
            </d:screen-dimension>
            <d:xdpi>235</d:xdpi>
            <d:ydpi>235</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="4.65in 720p (Galaxy Nexus)">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>xhdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>720</d:size>
                <d:size>1280</d:size>
            </d:screen-dimension>
            <d:xdpi>316</d:xdpi>
            <d:ydpi>316</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="4.7in WXGA">
        <d:default>
            <d:screen-size>normal</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>xhdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>1280</d:size>
                <d:size>720</d:size>
            </d:screen-dimension>
            <d:xdpi>320</d:xdpi>
            <d:ydpi>320</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="5.1in WVGA">
        <d:default>
            <d:screen-size>large</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>mdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>480</d:size>
                <d:size>800</d:size>
            </d:screen-dimension>
            <d:xdpi>183</d:xdpi>
            <d:ydpi>183</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="5.4in FWVGA">
        <d:default>
            <d:screen-size>large</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>port</d:screen-orientation>
            <d:pixel-density>mdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>480</d:size>
                <d:size>854</d:size>
            </d:screen-dimension>
            <d:xdpi>181</d:xdpi>
            <d:ydpi>181</d:ydpi>
        </d:default>

        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="7in WSVGA (Tablet)">
        <d:default>
            <d:screen-size>large</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>land</d:screen-orientation>
            <d:pixel-density>mdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>1024</d:size>
                <d:size>600</d:size>
            </d:screen-dimension>
            <d:xdpi>169</d:xdpi>
            <d:ydpi>169</d:ydpi>
        </d:default>

        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="7in WXGA (Nexus 7)">
        <d:default>
            <d:screen-size>large</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>land</d:screen-orientation>
            <d:pixel-density>tvdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>1280</d:size>
                <d:size>800</d:size>
            </d:screen-dimension>
            <d:xdpi>195</d:xdpi>
            <d:ydpi>200</d:ydpi>
        </d:default>

        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
    </d:device>

    <d:device name="10.1in WXGA (Tablet)">
        <d:default>
            <d:screen-size>xlarge</d:screen-size>
            <d:screen-ratio>long</d:screen-ratio>
            <d:screen-orientation>land</d:screen-orientation>
            <d:pixel-density>mdpi</d:pixel-density>
            <d:touch-type>finger</d:touch-type>
            <d:keyboard-state>keyssoft</d:keyboard-state>
            <d:text-input-method>nokeys</d:text-input-method>
            <d:nav-state>navexposed</d:nav-state>
            <d:nav-method>nonav</d:nav-method>
            <d:screen-dimension>
                <d:size>1280</d:size>
                <d:size>800</d:size>
            </d:screen-dimension>
            <d:xdpi>149</d:xdpi>
            <d:ydpi>149</d:ydpi>
        </d:default>

        <d:config name="Landscape">
            <d:screen-orientation>land</d:screen-orientation>
        </d:config>
        <d:config name="Portrait">
            <d:screen-orientation>port</d:screen-orientation>
        </d:config>
    </d:device>
</d:layout-devices> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T22:34:00.153

在我的情况下也是如此。当我更新 ADT 时出现此问题。估计是有问题...

# php - 三页上的php POST和ECHO

> ID：13422873
> 
> 赞同：-5
> 
> 时间：2012-11-16T19:10:02.677
> 
> 标签：php

我想在第二页的第一页回显我的结果，然后从第二页获得相同的 ruslt 并在第三页回显

第 1 页：

```
<form action="page2.php" method="post">
<input type="text" name="name" /> 
<input type="submit" />
</form> 
```

第2页：

```
echo $_POST['code']; 
```

我应该在第二页添加什么并在第三页写什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:16:09.810

第 1 页：

```
<form action="page2.php" method="post">
<input type="text" name="name" /> 
<input type="submit" />
</form> 
```

第2页：

```
<?php
session_start();
$_SESSION['name'] = $_POST['name'];
echo $_POST['name'];
?>
<form action="page3.php" method="post">
<input type="text" name="age" /> 
<input type="submit" />
</form> 
```

第 3 页：

```
<?php
session_start();
$_SESSION['age'] = $_POST['age'];
echo $_SESSION['name'].'<br />';
echo $_SESSION['age'].'<br />';
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:21:27.743

你有不同的选择

在第一页中，输入文本必须与第二页具有相同的名称。

page1.php

```
<form action="page2.php" method="post">
<input type="text" name="code" /> 
<input type="submit" />
</form> 
```

第二页可以有另一个带有隐藏输入的表单

page2.php

```
<?php
echo $_POST['code'];
?>
<form action="page3.php" method="post">
<input type="hidden" name="code" value="echo $_POST['code']" /> 
<input type="submit" />
</form> 
```

page3.php

```
<?php
echo $_POST['code'];
?> 
```

或者，如果您使用链接 page2.php

```
<?php
echo $_POST['code'];
echo "<a href='page3.php?code=" .$_POST['code']. "'>LINK TO 3rd PAGE</a>";
?> 
```

page3.php

```
<?php
echo $_GET['code'];
?> 
```

# string - 为什么这是错误的！？生成字符串

> ID：13422880
> 
> 赞同：3
> 
> 时间：2012-11-16T19:10:53.470
> 
> 标签：string, compiler-errors, segmentation-fault

我一直在尝试以这种方式生成字符串：

一个

b

.

.

z

啊

抗体

.

.

Z Z

.

.

.

.

zzzz

我想知道为什么当它到达'yz'时会提示分段错误（核心转储）错误。我知道我的代码没有涵盖所有可能的字符串，例如“zb”或“zc”，但这还不是重点，我想知道为什么会出现这个错误。如您所见，我不是编码大师，因此请尝试清楚地解释一下。谢谢 ：）

```
#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <stdlib.h>

void move_positions (char s[]);

int main (int argc, char *argv[])
{
    char s[28]; 
    s[0] = ' ';
    s[1] = '\0';
    int a = 0;
    for(int r = 'a'; r <= 'z'; r++)
    {
        for(int t ='a';t <='z'; t++)
        {   
            for(int u = 'a';u <= 'z'; u++)
            {   
                for(int y = 'a'; y <= 'z'; y++)                                    
                {                                          
                    s[a] = (char)y;  
                    printf ("%s\n", s);                                                                    
                    if (s[0] == 'z')
                    {                                                                                      
                        move_positions(s);
                        a++;
                    } 
                }
                s[a-1] = (char)u;
            }
            s[a-2] = (char)t;
        }
        s[a-3] = (char)r;
    }
return 0;
}

void move_positions (char s[])
{
    char z[28];
    z[0] = ' ';
    z[1] = '\0';
    strcpy(s, strcat(z, s));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:43:05.390

首先，让我们在打开调试的情况下进行编译：

```
gcc -g prog.c -o prog 
```

现在让我们在调试器下运行它：

```
> gdb prog
GNU gdb 6.3.50-20050815 (Apple version gdb-1822) (Sun Aug  5 03:00:42 UTC 2012)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "x86_64-apple-darwin"...Reading symbols for shared libraries .. done

(gdb) run
Starting program: /Users/andrew/Documents/programming/sx/13422880/prog 
Reading symbols for shared libraries +............................. done
a
b
c
d
e
...

yu
yv
yw
yx
yy
yz

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x00007fffc0bff6c5
0x0000000100000c83 in main (argc=1, argv=0x7fff5fbff728) at prog.c:22
22                      s[a] = (char)y; 
```

好的，它在第 22 行崩溃，试图做`s[a] = (char)y`. 是什么`a`？

```
(gdb) p a
$1 = 1627389953 
```

因此，您正在设置数组的第 160 万个条目`s`。是什么`s`？

```
(gdb) ptype s
type = char [28] 
```

在 28 元素数组中保存 160 万个条目？那是行不通的。看起来您需要`a`在某些循环开始时重置为零。

# nginx - 使用 NGINX 将跟踪数据转发到 Flume

> ID：13422885
> 
> 赞同：1
> 
> 时间：2012-11-16T19:11:09.977
> 
> 标签：nginx, flume

我正在根据我们通过简单的图像信标收集的仪器数据为我们的网络资产提供分析。我们的数据管道从 Flume 开始，我需要尽可能快的方法来解析查询字符串参数，形成一个简单的文本消息并将其推入 Flume。

出于性能原因，我倾向于使用 nginx。由于已经支持从内存中提供静态图像，因此我的任务被简化为处理查询字符串并将消息转发到 Flume。因此，问题：

将 nginx 与 Flume 集成的最简单可靠的方法是什么？我正在考虑使用 syslog（Flume 支持 syslog 侦听器），但我很难配置 nginx 以将自定义日志消息转发到在远程服务器和自定义端口上运行的 syslog（或只是 TCP）侦听器。是否可以使用 nginx 的现有 3rd 方模块，还是我必须自己编写？

另外，您可以推荐用于编写快速 $args 解析器的任何现有内容将不胜感激。

如果您认为我走的是一条完全错误的道路，并且可以推荐性能更好的东西，请随时告诉我。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T13:59:34.920

您应该像 do 一样解析 nginx 日志文件`tail -f`，然后将结果传递给 Flume。这将是最简单可靠的方法。syslog 的问题在于它会阻塞 nginx，并且可能完全卡在高负载下或者如果出现问题（这就是 nginx 不支持它的原因）。

# c# - 比较 2 个字符数组的差异百分比

> ID：13422887
> 
> 赞同：-4
> 
> 时间：2012-11-16T19:11:19.423
> 
> 标签：c#, .net

我在按下按钮时有 2 个文本框（winforms 应用程序）我有以下代码：

```
 string new_text = txtnew.Text;
        string old_text = txtold.Text;

        char[] arr_new = new_text.ToCharArray();
        char[] arr_old = old_text.ToCharArray();
        double found  = 0.0;
        double not_found = 0.0;
        foreach (char c_old in arr_old)
        {
            foreach (char c_new in arr_new)
            {
                if (c_new == c_old)
                {
                    found++;
                }else{
                    not_found++;
                }
            }
        }
        double percentage //need help here..
        MessageBox.Show(percentage.ToString()); 
```

我一直在尝试做的是比较每个数组以查看来自 1 个数组的字符是否存在于另一个数组中，然后它应该以百分比形式输出差异。因此，如果 txtNew = "hello worl" 和 txtold="hello world" 那么差异会是 0.1% 吗？无论如何，它被修改得越多，差异就越大，直到它处于 60% 不同的安全状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:14:32.353

您可以通过除以`not_found`总数来计算百分比，如下所示：

```
double percentage = (100.0 * not_found) / (found + not_found); 
```

更精确的方法是计算字符串之间的[*编辑距离*](http://en.wikipedia.org/wiki/Edit_distance)，然后用原始字符串长度的百分比表示该距离（即使用编辑距离而不是`not_found`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:23:38.300

如果您`not_found`在内部循环中增加，它将达到`old_text.Length*new_text.Length`. 这将产生巨大的`not_found`数字，使您获得的百分比比我认为的要小得多。

也没有必要做 char 数组的东西，内部可以被`IndexOf`调用替换：

```
 string new_text = txtnew.Text;
    string old_text = txtold.Text;

    var found = 0;
    foreach (var c_old in old_text)
    {
        if (new_text.IndexOf(c_old) != -1)
        {
          found++;
        }
    }
    //percentage of characters in the old text that also appear in the new text
    double percentage = (100d * found) / old_text.Length;    
    MessageBox.Show(percentage.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T20:02:18.300

看看这个维基百科页面： [Damerau-Levenshtein distance](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)

该页面上提供了一个 C# 函数，我认为它完全符合您的要求。

编辑：刚刚意识到其他人已经提到了同样的算法，抱歉重复了。

# mysql - (MySQL) SQL 错误：错误 1054 (42S22)：未知列 ' '在'字段列表'

> ID：13422890
> 
> 赞同：2
> 
> 时间：2012-11-16T19:11:25.603
> 
> 标签：mysql, sql

不知道我在这里做错了什么：

```
mysql> use co_sysdev;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> select * from system_params;
Empty set (0.01 sec)

mysql> INSERT INTO system_params (NUM_ENGINE_D_PROCESSES,MAX_NUM_BATCHES_PER_CLIENT,MAX_NUM_BATCHES_PER_LOCATION) VALUES(5,8,2);
ERROR 1054 (42S22): Unknown column 'NUM_ENGINE_D_PROCESSES' in 'field list'
mysql> 
```

还：

```
 desc system_params;
+-----------+----------------------------------------------------------------------------------------------------+------+-----+---------+-------+
| Field     | Type                                                                                               | Null | Key | Default | Extra |
+-----------+----------------------------------------------------------------------------------------------------+------+-----+---------+-------+
| attribute | enum('NUM_ENGINE_D_PROCESSES','MAX_NUM_BATCHES_PER_CLIENT','MAX_NUM_BATCHES_PER_LOCATION') | NO   | PRI | NULL    |       |
| value     | varchar(256)                                                                                       | NO   |     | NULL    |       |
+-----------+----------------------------------------------------------------------------------------------------+------+-----+---------+-------+
2 rows in set (0.00 sec) 
```

还：

```
 show create table system_params;
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table         | Create Table                                                                                                                                                                                                                                                  |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| system_params | CREATE TABLE `system_params` (
  `attribute` enum('NUM_ENGINE_D_PROCESSES','MAX_NUM_BATCHES_PER_CLIENT','MAX_NUM_BATCHES_PER_LOCATION') NOT NULL,
  `value` varchar(256) NOT NULL,
  PRIMARY KEY (`attribute`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:17:32.667

您不能将枚举值用作字段名称。您的插入必须类似于

```
INSERT INTO system_params (attribute, value) VALUES ('NUM_ENGINE_D_PROCESSES', 'foo'); 
```

除非您可以在此处插入的可能值是无限的（例如最终用户可定义），否则您将走上一条非常痛苦的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:30:12.187

很明显，这个错误表明您使用了错误的列名 somwhere 并且`NUM_ENGINE_D_PROCESSES`是枚举值，并且您将其用作列... SQL 插入查询的语法应该是

```
INSERT INTO your_table_Name (ID, name, ...<column names goes here>...) 
VALUES ('1', 'John', ...<values goes here>...); 
```

在你的情况下

```
INSERT INTO system_params (attribute, value) VALUES ('NUM_ENGINE_BLA_BLA', 'foo'); 
```

# iphone - 当任何其他动画发生时，CAShapeLayer 会重绘自己吗？

> ID：13422891
> 
> 赞同：0
> 
> 时间：2012-11-16T19:11:28.117
> 
> 标签：iphone, ios, cocoa-touch, core-animation, core-graphics

我有一个由`CGMutablePaths`. 我正在使用这些`CGMutablePaths`，并`CAShapeLayers`根据它们所代表的图形的不同区域将它们分开。下面是用于完成此操作的代码片段：

```
_initialSize = _size = CGSizeMake(168.784,127.842);
CGRect shapeLayerFrame = CGRectMake(0, 0, _initialSize.width, _initialSize.height);

CAShapeLayer *eyeBallShapeLayer = [[CAShapeLayer alloc] init];
eyeBallShapeLayer.fillColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1].CGColor;
eyeBallShapeLayer.bounds = shapeLayerFrame;
CGMutablePathRef eyeBallMutablePath = CGPathCreateMutable();

CAShapeLayer *eyeWhiteShapeLayer = [[CAShapeLayer alloc] init];
eyeWhiteShapeLayer.fillColor = [UIColor colorWithRed:1 green:1 blue:1 alpha:1].CGColor;
eyeWhiteShapeLayer.bounds = shapeLayerFrame;
CGMutablePathRef eyeWhiteMutablePath = CGPathCreateMutable();

CGMutablePathRef mutablePath;

mutablePath = CGPathCreateMutable();
CGPathMoveToPoint(mutablePath, NULL, 168.78,127.79);
CGPathAddLineToPoint(mutablePath, NULL, 155.56,127.13);
CGPathAddCurveToPoint(mutablePath, NULL, 156.23,126.83,156.73,125.92,157.06,125.31);
CGPathAddCurveToPoint(mutablePath, NULL, 157.60,122.36,157.84,119.11,159.77,116.67);
CGPathAddCurveToPoint(mutablePath, NULL, 160.75,115.23,160.44,113.42,160.52,111.78);
CGPathAddCurveToPoint(mutablePath, NULL, 160.58,111.83,160.64,111.88,160.70,111.94);
CGPathAddCurveToPoint(mutablePath, NULL, 161.05,112.27,161.27,112.68,161.47,113.10);
CGPathAddCurveToPoint(mutablePath, NULL, 161.63,113.46,161.78,113.82,161.96,114.16);
CGPathAddCurveToPoint(mutablePath, NULL, 161.97,114.18,161.98,114.20,161.99,114.21);
CGPathAddCurveToPoint(mutablePath, NULL, 162.13,114.47,162.29,114.71,162.51,114.92);
CGPathAddLineToPoint(mutablePath, NULL, 162.52,114.92);
CGPathAddCurveToPoint(mutablePath, NULL, 162.96,115.28,163.36,115.65,163.74,116.05);
CGPathAddCurveToPoint(mutablePath, NULL, 165.44,117.86,166.53,120.17,167.18,122.59);
CGPathAddCurveToPoint(mutablePath, NULL, 167.25,122.86,167.32,123.13,167.38,123.40);
CGPathAddCurveToPoint(mutablePath, NULL, 167.63,124.48,167.79,125.58,167.89,126.67);
CGPathAddCurveToPoint(mutablePath, NULL, 167.90,126.94,168.05,127.13,168.23,127.30);
CGPathAddCurveToPoint(mutablePath, NULL, 168.41,127.47,168.63,127.62,168.78,127.79);
CGPathCloseSubpath(mutablePath);
CGPathAddPath(eyeBallMutablePath, NULL, mutablePath);
CGPathRelease(mutablePath);

//a whole lot of paths being loaded in much the same way as above

_shapeLayers = [[NSMutableArray alloc] init];

eyeBallShapeLayer.path = eyeBallMutablePath;
[_shapeLayers addObject:eyeBallShapeLayer];
CGPathRelease(eyeBallMutablePath);
[eyeBallShapeLayer release];

eyeWhiteShapeLayer.path = eyeWhiteMutablePath;
[_shapeLayers addObject:eyeWhiteShapeLayer];
CGPathRelease(eyeWhiteMutablePath);
[eyeWhiteShapeLayer release]; 
```

我将这些 shapeLayers 附加到 views`layer`属性，并且图形绘制得很好。我得到的问题是`CAShapeLayers`当任何动画发生时都在重绘自己。IE 如果一个模态视图被拉起或者有一个导航转换，它会重绘自己。我有当用户点击屏幕（如照片应用程序）时条形消失的功能，并且在此期间它会重新绘制自身。当我拖动形状时，它也会重新绘制自己。对于我的一些具有大量路径的图形，它会导致动画在重绘自身时出现断断续续的现象。

所以我的问题是，有人知道为什么会这样吗？我做错了什么导致这种情况发生？当我只是在drawRect中绘制图形时，这并没有发生，所以我有点困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:30:45.413

默认情况下，`CALayer`将为动画中的每一帧重新绘制 a。你需要做的是告诉你的图层他们应该被[光栅化](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/occ/instp/CALayer/shouldRasterize)。通过这样做，您的图层将仅在图层内容更改时重绘，而不是在它涉及动画时重绘。

如果为每个形状图层添加以下代码，动画应该运行得更流畅。

```
[shapeLayer setRasterizationScale:[[UIScreen mainScreen] scale]];
[shapeLayer setShouldRaseterize:YES]; 
```

# c++ - 如何更改默认语言环境的千位分隔符？

> ID：13422892
> 
> 赞同：5
> 
> 时间：2012-11-16T19:11:45.513
> 
> 标签：c++, visual-c++, locale, iostream

我可以

```
locale loc(""); // use default locale
cout.imbue( loc );
cout << << "i: " << int(123456) << " f: " << float(3.14) << "\n"; 
```

它会输出：

```
i: 123.456 f: 3,14 
```

在我的系统上。（德国窗户）

我想避免获得整数的千位分隔符——我该怎么做？

（我只想要用户默认设置，但没有任何千位分隔符。）

（我[发现](http://www.cplusplus.com/reference/std/locale/numpunct/thousands_sep/)的只是如何使用刻面*读取*千位分隔符......但我该如何更改它呢？）`use_facet``numpunct`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T19:58:26.273

只需创建并灌输您自己的[numpunct](http://www.cplusplus.com/reference/std/locale/numpunct/)方面：

```
struct no_separator : std::numpunct<char> {
protected:
    virtual string_type do_grouping() const 
        { return "\000"; } // groups of 0 (disable)
};

int main() {
    locale loc("");
    // imbue loc and add your own facet:
    cout.imbue( locale(loc, new no_separator()) );
    cout << "i: " << int(123456) << " f: " << float(3.14) << "\n";
} 
```

如果您必须创建一个特定的输出供另一个应用程序读取，您可能还需要覆盖`virtual char_type numpunct::do_decimal_point() const;`.

如果您想使用特定的语言环境作为基础，您可以从`_byname`方面派生：

```
template <class charT>
struct no_separator : public std::numpunct_byname<charT> {
    explicit no_separator(const char* name, size_t refs=0)
        : std::numpunct_byname<charT>(name,refs) {}
protected:
    virtual string_type do_grouping() const
        { return "\000"; } // groups of 0 (disable)
};

int main() {
    cout.imbue( locale(std::locale(""),  // use default locale
        // create no_separator facet based on german locale
        new no_separator<char>("German_germany")) );
    cout << "i: " << int(123456) << " f: " << float(3.14) << "\n";
} 
```

# jquery - 鼠标单击附近的工具提示位置

> ID：13422893
> 
> 赞同：1
> 
> 时间：2012-11-16T19:12:06.647
> 
> 标签：jquery

我的场景在此处描述并部分解决[了使用 jquery 1.3.2 创建的简单工具提示](https://stackoverflow.com/questions/13421563/simple-tooltips-created-using-jquery-1-3-2) 我想在单击 html 元素后显示简单的工具提示。但是，在我的页面上，工具提示 (.tooltip) 的 html 代码位于我页面的不同位置（底部）。现在我需要它显示在点击的 html 元素的正下方。到目前为止，代码如下所示：

```
$(document).ready(function(){

$('.somefield').click(showBox).mouseleave(hideBox);

function showBox(e){
    var x = e.pageX + 20;
    var y = e.pageY + 20;
    $('.tooltip').fadeIn();
    $('.tooltip').offset({ left: x, top: y });
}

function hideBox(){
    $('.tooltip').fadeOut();
}
}); 
```

它可以像这样在我的页面上运行[http://jsfiddle.net/HUG2Z/15/](http://jsfiddle.net/HUG2Z/15/) 我如何才能在 jquery 1.3.2 中通过鼠标单击来显示它？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:57:14.143

只需使工具提示绝对定位并将调用更改`offset()`为`css()`

为什么要在`pageX`and上加 70 `pageY`？那样的鼠标不会对的。

[http://jsfiddle.net/HUG2Z/22/](http://jsfiddle.net/HUG2Z/22/)

```
$(document).ready(function(){

    $('.somefield').click(showBox).mouseleave(hideBox);

    function showBox(e){
        $('.tooltip').fadeIn().css(({ left: e.pageX, top: e.pageY }));
    }

    function hideBox(){
        $('.tooltip').fadeOut();
    }
}); 
```

CSS

```
.tooltip {
    margin:10px;
    padding:12px;
    border:2px solid #666;
    width:60px;
    position: absolute;
    display: none;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:58:27.417

这是您的代码的更新：

[http://jsfiddle.net/HUG2Z/19/](http://jsfiddle.net/HUG2Z/19/)

最重要的事情发生在这里：

```
.tooltip {
    margin:10px;
    padding:12px;
    border:2px solid #666;
    width:60px;
    **position: absolute;**
    display: none;
} 
```

和这里

```
$('.tooltip').css({ left: x, top: y }); 
```

首先，您需要定位工具提示绝对位置，使其在正常盒子模型之外运行并且可以定位在任何地方。left 和 top 属性甚至没有生效，因为默认情况下大多数元素的位置都是静态的。在开始使用 jQuery 操作它之前，您可能应该更深入地研究整个职位主题（实际上并不那么复杂）。

# parsing - 使用 Scheme 解析字符串

> ID：13422894
> 
> 赞同：4
> 
> 时间：2012-11-16T19:12:06.743
> 
> 标签：parsing, scheme, sxml

我正在尝试编写一个简单的解析器，它从字符串创建一个 sxml 表达式，例如

```
"This is a [Test]" ===> (item "This is a" (subitem "Test")) 
```

任何想知道给定示例中的方括号的人都可以查看所谓的[Leiden 约定](http://en.wikipedia.org/wiki/Leiden_Conventions)。

这是我到目前为止写的代码：

```
(define my-sequence '("this" "[" "is" "a" "]" "test"))

(define (left-square-bracket? item)
  (or (equal? item "[")
      (eq? item #\x005b)))

(define (right-square-bracket? item)
  (or (equal? item "]")
      (eq? item #\x005d)))

(define (parse-sequence sequence)
  (cond ((null? sequence) '())
        ((left-square-bracket? (car sequence))
         (let ((subsequence (get-subsequence (cdr sequence))))
           (list subsequence)))
        (else
         (cons (car sequence)
               (parse-sequence (cdr sequence))))))

(define (get-subsequence sequence)
  (if (right-square-bracket? (car sequence))
      '()
      (cons (car sequence)
            (get-subsequence (cdr sequence))))) 
```

评估`(parse-sequence my-sequence)`产量`("this" ("is" "a"))`。已创建嵌套表达式，但程序在未计算最后一项的情况下完成`"test"`。问题是，我如何从`get-subsequence`to返回`parse-sequence`？

任何帮助表示赞赏，非常感谢提前！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T18:46:12.447

要解决您最初的问题，如何返回多个值：使用“值”表单。这是一个示例实现，其中内部过程返回要处理的剩余列表和到目前为止的结果。它在左括号上递归。

```
(define (parse-sequence lst)

  (define (parse-seq lst)
    (let loop ((lst lst) (res null))
      (cond
        ((null? lst) (values null res))
        ((string=? (car lst) "[")
         (let-values ([(lst2 res2) (parse-seq (cdr lst))])
           (loop lst2 (append res (list res2)))))
        ((string=? (car lst) "]")
         (values (cdr lst) res))
        (else
          (loop (cdr lst) (append res (list (car lst))))))))

  (let-values ([(lst res) (parse-seq lst)])
    res)) 
```

然后

```
(parse-sequence '("this" "is" "a" "test"))
(parse-sequence '("this" "[" "is" "a" "]" "test"))
(parse-sequence '("this" "[" "is" "[" "a" "]" "]" "test")) 
```

将产生

```
'("this" "is" "a" "test")
'("this" ("is" "a") "test")
'("this" ("is" ("a")) "test") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:31:07.263

我通过`open-input-string`结合使用取得了一些进展`read-char:`

```
(define my-sequence (open-input-string "this [is a] test"))

(define (parse-sequence sequence)
  `(item
    ,@(let loop ((next-char (read-char sequence)))
        (cond ((eof-object? next-char) '())
              ((left-square-bracket? next-char)
               (let ((subsequence (get-subsequence sequence)))
                 (cons subsequence
                       (loop (read-char sequence)))))
              (else
               (cons next-char
                     (loop (read-char sequence))))))))

(define (get-subsequence sequence)
  `(subitem
    ,@(let loop ((next-char (read-char sequence)))
        (if (right-square-bracket? next-char)
            '()
            (cons next-char
                  (loop (read-char sequence)))))))

(parse-sequence my-sequence)
===> (item #\t #\h #\i #\s #\space (subitem #\i #\s #\space #\a) #\space #\t #\e #\s #\t) 
```

现在工作还在继续，一步一步地进行。:)

任何意见和建议仍然受到赞赏。:)

# javascript - 像这样定义 JS 变量有什么意义： var appName = appName || {};

> ID：13422897
> 
> 赞同：2
> 
> 时间：2012-11-16T19:12:18.703
> 
> 标签：javascript

谁能告诉我在定义对象之前使用三元运算符检查对象是否已经存在的原因？

```
var message = message || "hello",
    messageOverwritten = "Variable wasn't overwritten",
    messageOverwritten = messageOverwritten || "Variable wasn overwritten";

console.log( message );
console.log( messageOverwritten );​

/* 
 * Output
 *
 * -> hello
 * -> Variable wasn't overwritten
 */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:15:53.943

这里发生的所有事情都是一个“或”陈述。例如，如果`message`是`null`或，它将在测试时评估为，而或语句将评估为右手边。然后，右侧将是设置为 的值。`undefined``false``message`

这样做背后的原因是因为有些人认为它比替代方案更简洁：

```
if (!message)
    message = "hello"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:04:00.510

wsanville 关于该语法的作用以及人们使用它的原因是正确的，但我认为您可能会问更多它的用处。我已经看到它主要用于为可选变量设置默认值。以函数为例

```
function foo(value){
   value = value || 'hello';
   console.log(value);
} 
```

然后你可以说`foo()`，你会得到“你好”，或者`foo('goodbye')`得到“再见”。

# python - Python：在数组中填充多边形区域

> ID：13422898
> 
> 赞同：3
> 
> 时间：2012-11-16T19:12:20.737
> 
> 标签：python, arrays, numpy, fill

我有一个光栅图像（Tiff 格式）和一个转换为数组的 shapefile 格式的多边形区域。我希望找到一种优雅的方法来创建一个数组，其中多边形边界内的所有元素都有 1 值，多边形外的所有元素都有值 0。我的最终目标是用从 shapefile 派生的数组屏蔽从图像派生的数组.

我有以下问题，感谢您的帮助：

*在使用np.zeros((ds.RasterYSize, ds.RasterXSize))*和我的多边形边界的地理空间坐标的像素位置创建一个空数组后，用 1 填充数组内的多边形的最佳解决方案是什么？

```
from osgeo import gdal, gdalnumeric, ogr, osr
import osgeo.gdal
import math
import numpy
import numpy as np

def world2Pixel(geoMatrix, x, y):
    """
    Uses a gdal geomatrix (gdal.GetGeoTransform()) to calculate
    the pixel location of a geospatial coordinate
    (source http://www2.geog.ucl.ac.uk/~plewis/geogg122/vectorMask.html)
    geoMatrix
    [0] = top left x (x Origin)
    [1] = w-e pixel resolution (pixel Width)
    [2] = rotation, 0 if image is "north up"
    [3] = top left y (y Origin)
    [4] = rotation, 0 if image is "north up"
    [5] = n-s pixel resolution (pixel Height)

    """
    ulX = geoMatrix[0]
    ulY = geoMatrix[3]
    xDist = geoMatrix[1]
    yDist = geoMatrix[5]
    rtnX = geoMatrix[2]
    rtnY = geoMatrix[4]
    pixel = np.round((x - ulX) / xDist).astype(np.int)
    line = np.round((ulY - y) / xDist).astype(np.int)
    return (pixel, line)

# Open the image as a read only image
ds = osgeo.gdal.Open(inFile,gdal.GA_ReadOnly)
# Get image georeferencing information.
geoMatrix = ds.GetGeoTransform()
ulX = geoMatrix[0] # top left x (x Origin)
ulY = geoMatrix[3] # top left y (y Origin)
xDist = geoMatrix[1] # w-e pixel resolution (pixel Width)
yDist = geoMatrix[5] # n-s pixel resolution (pixel Height)
rtnX = geoMatrix[2] # rotation, 0 if image is "north up"
rtnY = geoMatrix[4] #rotation, 0 if image is "north up"

# open shapefile (= border of are of interest)
shp = osgeo.ogr.Open(poly)
source_shp = ogr.GetDriverByName("Memory").CopyDataSource(shp, "")
# get the coordinates of the points from the boundary of the shapefile
source_layer = source_shp.GetLayer(0)
feature = source_layer.GetNextFeature()
geometry = feature.GetGeometryRef()
pts = geometry.GetGeometryRef(0)
points = []
for p in range(pts.GetPointCount()):
   points.append((pts.GetX(p), pts.GetY(p)))
pnts = np.array(points).transpose()

print pnts
pnts
array([[  558470.28969598,   559495.31976318,   559548.50931402,
    559362.85560495,   559493.99688721,   558958.22572622,
    558529.58862305,   558575.0174293 ,   558470.28969598],
    [ 6362598.63707171,  6362629.15167236,  6362295.16466266,
    6362022.63453845,  6361763.96246338,  6361635.8559779 ,
    6361707.07684326,  6362279.69352024,  6362598.63707171]])

# calculate the pixel location of a geospatial coordinate (= define the border of my polygon)

pixels, line = world2Pixel(geoMatrix,pnts[0],pnts[1])
pixels
array([17963, 20013, 20119, 19748, 20010, 18939, 18081, 18172, 17963])
line
array([35796, 35734, 36402, 36948, 37465, 37721, 37579, 36433, 35796])

#create an empty array with value zero using 
data = np.zeros((ds.RasterYSize, ds.RasterXSize)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:17:11.890

这本质上是一个[多边形内的点](http://en.wikipedia.org/wiki/Point_in_polygon)问题。

这是一个小库来解决这个问题。它来自[此](http://www.ariel.com.au/a/python-point-int-poly.html)页面，并进行了一些修改以使其更具可读性。

点子

```
#From http://www.ariel.com.au/a/python-point-int-poly.html
# Modified by Nick ODell
from collections import namedtuple

def point_in_polygon(target, poly):
    """x,y is the point to test. poly is a list of tuples comprising the polygon."""
    point = namedtuple("Point", ("x", "y"))
    line = namedtuple("Line", ("p1", "p2"))
    target = point(*target)

    inside = False
    # Build list of coordinate pairs
    # First, turn it into named tuples

    poly = map(lambda p: point(*p), poly)

    # Make two lists, with list2 shifted forward by one and wrapped around
    list1 = poly
    list2 = poly[1:] + [poly[0]]
    poly = map(line, list1, list2)

    for l in poly:
        p1 = l.p1
        p2 = l.p2

        if p1.y == p2.y:
            # This line is horizontal and thus not relevant.
            continue
        if max(p1.y, p2.y) < target.y <= min(p1.y, p2.y):
            # This line is too high or low
            continue
        if target.x < max(p1.x, p2.x):
            # Ignore this line because it's to the right of our point
            continue
        # Now, the line still might be to the right of our target point, but 
        # still to the right of one of the line endpoints.
        rise = p1.y - p2.y
        run =  p1.x - p2.x
        try:
            slope = rise/float(run)
        except ZeroDivisionError:
            slope = float('inf')

        # Find the x-intercept, that is, the place where the line we are
        # testing equals the y value of our target point.

        # Pick one of the line points, and figure out what the run between it
        # and the target point is.
        run_to_intercept = target.x - p1.x
        x_intercept = p1.x + run_to_intercept / slope
        if target.x < x_intercept:
            # We almost crossed the line.
            continue

        inside = not inside

    return inside

if __name__ == "__main__":
    poly = [(2,2), (1,-1), (-1,-1), (-1, 1)]
    print point_in_polygon((1.5, 0), poly) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-09T18:41:39.607

接受的答案对我不起作用。

我最终使用了 shapely 库。

```
sudo pip install shapely 
```

代码：

```
import shapely.geometry 

poly = shapely.geometry.Polygon([(2,2), (1,-1), (-1,-1), (-1, 1)])
point = shapely.geometry.Point(1.5, 0)

point.intersects(poly) 
```

# javascript - 如何将 JS 文件作为纯文本读取并将其作为字符串放入变量中

> ID：13422899
> 
> 赞同：1
> 
> 时间：2012-11-16T19:12:30.153
> 
> 标签：javascript, jquery

我有一个 test.js 文件，我想获取该文件的代码并将其作为字符串放入变量中，但不执行它我该怎么做？

我可以使用这个 jquery 代码

```
$j.get('/js/apu.js', function(data) {
    $j('#result').html(data);
}); 
```

但是这样做的问题是执行JS代码，我不想执行它，我只想将代码放入一个变量中（当然要在作为字符串/纯文本之后对其进行操作）

更新：

只是 $j.get('/js/apu.js'... 执行代码而不在页面中打印它的事实。我没有那种行为，我只需要以纯文本形式获取代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:46:08.350

至于问题的标题，`data`它本身就是一个字符串变量，其中包含纯文本的代码。

`<script></script>`除非包含在标签中，否则不会执行 Javascript 。但是如果您不希望浏览器将其解释为 html，则 html 实体可能需要转义。我不明白您计划进行什么样的操作，但如果您只想在页面中将其打印为纯文本，请`.text()`使用`.html()`：

```
$j('#result').text(data); 
```

*我还建议将结果作为`<pre>`或`<code>`标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:45:27.450

这会做到的

```
$("#container").load("/js/apu.js"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:49:41.257

尝试将 设置`dataType`为文本。

```
$j.get('/js/apu.js', function(data) {
    $j('#result').html(data);
}, "text"); 
```

# pyrocms - PyroCMS 输出配置文件自定义字段

> ID：13422904
> 
> 赞同：1
> 
> 时间：2012-11-16T19:12:50.567
> 
> 标签：pyrocms

我的用户个人资料中有以下自定义字段。我注意到的是这些将输出当前登录的用户字段。如何让这些字段显示在当前查看的用户个人资料中？我需要能够看到选定的用户配置文件数据，而不是登录的用户数据。

```
{{ user:your_address }}, {{ user:address_line3 }}, {{ user:state }} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T19:34:02.713

您可以将用户 ID 传递给用户插件标签。

```
{{ user:your_address user_id="4" }} 
```

如果您有多个标签，或者我们提供个人资料标签。

```
{{ user:profile user_id="4" }}

{{ your_address }}
{{ address_line3 }}

{{ /user:profile }} 
```

这是针对 PyroCMS 2.1 版的。如果您有旧版本，您可能需要更新用户插件。

从这里：[http ://docs.pyrocms.com/2.1/manual/plugins/user](http://docs.pyrocms.com/2.1/manual/plugins/user)

**编辑**

您可以像这样将变量传递给用户标签。

```
{{ user:your_address user_id="{{ user_id_var }}" }} 
```

但是，当您在控制器中构建模板时，您需要设置 id，并以某种方式将变量传递给页面（通过 URI 段？）。

```
$this->template->user_id_var = $this->uri->segment(2); 
```

# php - 使用插件不刷新提交表单（malsup）

> ID：13422905
> 
> 赞同：0
> 
> 时间：2012-11-16T19:13:07.943
> 
> 标签：php, javascript, jquery, html, forms

我刚刚创建了一个表单提交，没有使用这个插件刷新：http: [//malsup.github.com/jquery.form.js](http://malsup.github.com/jquery.form.js)

简单的例子可以在 [http://jquery.malsup.com/form/看到](http://jquery.malsup.com/form/)

我不知道我在做什么，在我修改了我不记得的东西之前它工作得很好。

当我单击 SAVE 时，它应该在后台处理，并且应该保持在同一页面上。但现在，它没有，它把我重定向到操作页面（process-001.php）

我使用相同的方法创建了另一个页面，它工作得很好。

你能看看我做错了吗？

这是表格：

```
<div id="submit-form">
<form action="web-block/forms/process-001.php" id="select-block" class="general-form" method="post" enctype="multipart/form-data">
<div class="input-wrap">
    <input class="clearme" name="Headline" value="<?php echo $Headline;?>" id="headline"/>
</div>
<div class="input-wrap">
    <textarea class="clearme" name="Sub-Headline" id="subheadline"><?php echo $SubHeadline ;?></textarea>
</div>
<label>Bottom Left Image</label>
<div class="up-mask">
    <span class="file-wrapper">
      <input type="file" name="Pics" class="photo" id="pics" />
      <span class="button">
         <span class="default-txt">Upload Photo</span>
      </span>
    </span>
</div><!-- .up-mask -->

<input type="hidden" name="Key" id="Key" value="<?php echo $Key;?>"/>
<input type="submit" class="submit-btn" value="SAVE" />
<span class="save-notice">Your changed has been saved!</span>
</form>
</div> 
```

Javascript：

```
<script> 
        // wait for the DOM to be loaded 
        $(document).ready(function() { 
            // bind 'myForm' and provide a simple callback function 
            $('#select-block').ajaxForm(function() { 
                alert("Thank you for your comment!"); 
            }); 
        }); 
</script> 
```

# qt - Qt 模型/视图/控制器示例

> ID：13422909
> 
> 赞同：15
> 
> 时间：2012-11-16T19:13:25.697
> 
> 标签：qt, model-view-controller, signals-slots

我刚刚开始使用 Qt，并试图获得模型-视图-控制器设计模式的简化工作示例。

到目前为止，我已经能够使用信号和插槽将按钮等基本小部件连接到 a `QLabel`，并在单击/释放按钮时修改视图。请参阅下面的代码以获取其工作示例（在`MainWindow`类中实现）。

我正在尝试定义一个类，在这种情况下，`Game`它将成为我的模型。我想`Game`拥有整个应用程序的所有数据和业务规则。我不要求它`Game`是特定于 Qt 的——它很可能是通用 C++。然而，在下面的代码中，它确实有一些特定于 Qt 的代码来实现 a`QTimer`这对于本示例的目的很有用。

我试图在这个例子中实现两件事：

1.  我想要一个模型，它能够在自身内部产生某种事件，比如随着时间的推移增加一个变量值，然后最终看到这种变化以某种方式反映在视图中。或者更好的是，`timeout()`的`QTimer`可能只是连接到某个插槽的信号，该插槽是模型中发生的某个事件。使用下面显示的代码，视图中的反射将是`label_1`（`MainWindow`类的一部分）的设置，以显示已经存储在`imageOn`或`imageOff`（也是`MainWindow`类的一部分）中的图像之一。
2.  `on_pushButton_clicked()`我希望与和插槽相关联的按钮`on_pushButton_pressed()`能够修改存储在模型中的某些值。然后，与第 1 项一起循环，让模型的更新反映在视图中。

如果到目前为止我的术语不正确或与 MVC 设计模式的 Qt 术语不一致，请见谅。我欢迎对此作出任何澄清。此外，如果我提供的示例代码过于复杂，无法在 Qt 中举例说明 MVC 设计模式，我非常愿意擦干净石板并从更合适的示例开始。我想做的只是开始使用 Qt 和 MVC，但以一种处理更复杂数据类型的方式。

我正在尝试开发一个示例，在该示例中我可以处理可能很复杂的模型和类`Game`——而不是简单的 QString 列表或保证更直接的东西。当我浏览与 MVC 相关的 Qt 文档时，我遇到了很多示例，这些示例使用该`setModel()`函数来尝试建立我在列表项 1 和 2 中基本上概述的连接。问题是我看不到一种方法使用具有更复杂数据类型的确切方法，例如`Game`可能是完整应用程序的整个数据模型（我知道`Game`在此示例中并不复杂，但最终可能会如此）。我需要一些可扩展和可扩展的东西，一些适用于整个应用程序的东西。如果那些`setModel()`-type 函数适用于此-它们很可能是，我只是无法自己弄清楚-我想知道如何实现本示例中处理`QLabel`图像的那些。

代码：

**游戏.h**

```
#ifndef GAME_H
#define GAME_H

#include <QtCore>

class Game : public QObject {

    Q_OBJECT

public:
    Game();
    void timed_job();

private:
    QTimer *timer;
};

#endif // GAME_H 
```

**游戏.cpp**

```
#include "game.h"
#include <QtCore>

Game::Game() {
}

void Game::timed_job() {
    timer = new QTimer(this);
    timer->start(1000);
    //connect(timer, SIGNAL(timeout()), this, SLOT(flip()));
} 
```

**主窗口.h**

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

namespace Ui {
    class MainWindow;
}

class MainWindow : public QMainWindow {
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private slots:
    void on_pushButton_clicked();
    void on_pushButton_pressed();

private:
    Ui::MainWindow *ui;
    QImage imageOn, imageOff;
};

#endif // MAINWINDOW_H 
```

**主窗口.cpp**

```
#include <QImage>
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow) {
    imageOn.load(":/Files/On.jpg");
    imageOff.load(":/Files/Off.jpg");

    ui->setupUi(this);
}

MainWindow::~MainWindow() {
    delete ui;
}

void MainWindow::on_pushButton_clicked() {
    ui->label_1->setPixmap(QPixmap::fromImage(imageOff));
}

void MainWindow::on_pushButton_pressed() {
    ui->label_1->setPixmap(QPixmap::fromImage(imageOn));
} 
```

**主文件**

```
#include <QtGui/QApplication>
#include <QLabel>
#include "mainwindow.h"
#include "game.h"

int main(int argc, char *argv[]) {
    QApplication a(argc, argv);

    MainWindow w;

    w.show();

    return a.exec();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T19:38:36.487

Qt 中的“控制器”在技术上可以由一个单独的`QObject`子类表示，只包含插槽。你会在你的模型和视图之间连接它。
但通常我所做的（和看到的）只是让你的模型包含业务逻辑，而你的视图子类包含处理它的用户交互的方法。我最接近控制器概念的是当我有代表应用程序的 QMainWindow（或对话框）类，并且上面有一堆 SLOTS 时。这些插槽连接到私有 UI 成员信号以将它们连接在一起。

示例：您的主窗口有一个模型、一个视图和一个按钮。在主窗口的 init 中，我将在视图中设置模型，并将“单击”的按钮连接到我的窗口上的插槽`refreshData()`。然后，此插槽将调用模型上的“更新”方法，该方法将自动传播到视图。因此，主窗口就像一个控制器。

您想要做的是制作某种类型的`QAbstractItemModel`或`QStandardItemModel`代表您的数据并执行您想要更新该数据的操作（如您建议的计时器）。由于标准界面，任何连接到模型的视图都可以看到它。您也可以只制作一个单独的计时器，将数据放入现有的 `QStandardItemModel`

*关于自定义 QAbstractItemModel 类的说明*

正如@hyde 所指出的，如果您在充分理解现有的具体模型类之前先尝试并尝试去做，那么跳入自定义模型可能会是一个挑战。这是我建议做的事情：

1.  熟悉方便的小部件（QListWidget、QTableWidget、QTreeWidget）
2.  然后尝试将 QStandardItemModel 与 QListView/QTableView 一起使用
3.  然后使用 QTreeView
4.  最后，当您确实需要对现有数据结构进行非常自定义的建模时，您可以对 QAbstractItemModel 进行子类化以使其使用您自己的内部结构。

# selenium - AutoIT For Chrome Not Working - Selenium WebDriver Automation 的基本身份验证对话框解决方法

> ID：13422913
> 
> 赞同：0
> 
> 时间：2012-11-16T19:13:47.023
> 
> 标签：selenium, selenium-webdriver, autoit, browser-automation

我正在尝试在 java 中使用 selenium webdriver 自动化我的测试用例。它涉及基本身份验证对话框。为了使用相同的方法使 IE、Chrome、FF 兼容，我必须使用 AutoIT 我已经完成了 IE 和 FF，但对于 Chrome，它不起作用。我正在使用`AutoIT Window Info`查找类和控件名称的工具。但是在这种情况下，Chrome 完全不同，有人可以帮忙吗？

这是工作 IE 和 FF 的代码

```
 $classForBasicAuthenticationWindow = "[CLASS:#32770]"
 $username = "XXXXXX"
 $password = "XXXXXX"

 WinWait($classForBasicAuthenticationWindow,"",120)
 If WinExists($classForBasicAuthenticationWindow) Then
    WinActivate($classForBasicAuthenticationWindow)
    Send($username)
    Send("{TAB}")
    Send($password & "{Enter}")   
  EndIf 
```

FF类似，以上是IE

对于 Chrome，到目前为止，如果您考虑使用该`window info`工具，您将了解弹出窗口不是 chrome 的不同窗口。所以它变得有点复杂。无论如何，这是我尝试过的：

```
$classForBasicAuthenticationWindow = "[CLASS:Chrome_WidgetWin_1]"
$username = "XXXXX"
$password = "XXXXX"

WinWait($classForBasicAuthenticationWindow,"",120)
If WinExists($classForBasicAuthenticationWindow) Then
WinActivate($classForBasicAuthenticationWindow)
While 1
   $isAuthenticationRequiredVisible = ControlGetHandle($classForBasicAuthenticationWindow, "", "[CLASS:ViewsTextfieldEdit; INSTANCE:2]")
  If $isAuthenticationRequiredVisible <> "" Then 
     MsgBox($isAuthenticationRequiredVisible)
     ExitLoop
  EndIf
WEnd
ControlSend($classForBasicAuthenticationWindow, "", "[CLASS:ViewsTextfieldEdit; INSTANCE:2]", $username)
EndIf 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T22:01:54.413

你为什么不打开你的 URL（通过在 URL 中传递登录凭据）

```
@driver.get "#{username}:#{password}@#{URL}" 
```

一个例子

```
@driver.get "user:pass@my.domain.com" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T08:23:46.437

**ControlSend 方法采用窗口标题而不是窗口的类。** 因此，请尝试给出出现在 Autoit Window Info Tool 中的窗口标题。

下面给出的代码对我有用。

```
$titleForBasicAuthenticationWindow = "Window Title As Given in Window Info Tool"
$username = "XXXXX"
$password = "XXXXX"

WinWait($classForBasicAuthenticationWindow,"",120)
If WinExists($classForBasicAuthenticationWindow) Then
 WinActivate($classForBasicAuthenticationWindow)
 ControlSend($classForBasicAuthenticationWindow, "", "[CLASS:ViewsTextfieldEdit; INSTANCE:2]", $username)
EndIf 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-10T07:01:03.530

对于 chrome，我尝试了所有方法，在基本 http 身份验证弹出窗口中输入凭据的最佳方法是通过 AutoIT。您只需要 `sleep(25000)` 在脚本的开头添加。确保 chrome 能够在 25 秒内打开该弹出窗口。如果没有，则增加睡眠时间。

# javascript - 从画布中获取元素

> ID：13422917
> 
> 赞同：2
> 
> 时间：2012-11-16T19:13:52.427
> 
> 标签：javascript, html, pdf, canvas, fabricjs

我想将我的画布导出到 PDF 中，并且只渲染添加到画布中的元素。例如：

我有这个画布，设置了背景图像。 [http://i49.tinypic.com/n7lv.png](http://i49.tinypic.com/n7lv.png)

这是我将其呈现为 PDF 时的结果（使用 Bytescout 库） [http://i50.tinypic.com/346ud7m.png](http://i50.tinypic.com/346ud7m.png)

这就是我希望它最终的结果：http: [//i50.tinypic.com/2q1s9hv.png](http://i50.tinypic.com/2q1s9hv.png)

意思是，我希望它最终没有圆角，没有背景图像。画布是使用织物框架完成的。我的想法是将所有元素添加到画布中，除了背景图像，然后从那里渲染 PDF。有什么指导方针吗？这是要走的路吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T21:21:35.860

您只需重新绘制整个场景，省略您不想写入 PDF 的部分。

如果您不想跟踪要重绘的所有内容，请创建第二个内存中的画布 ( `document.createElement('canvas')`) 并对该画布而不是您的普通画布执行所有绘图操作，然后将该画布作为用户绘制到您的普通画布上编辑而不是直接在普通画布上绘图。

老办法：

```
// First you round the corners permanently by making a clipping region:
ctx.roundedRect(etc)
ctx.clip();
//then a user draws something onto normal canvas, like an image
ctx.drawImage(myImage, 0, 0); 
```

新方式：

```
// make a hidden canvas:
var hiddenCanvas = document.createElement('canvas');
var hCtx = hiddenCanvas.getContext('2d');
// First you round the corners permanently by making a clipping region:
ctx.roundedRect(etc)
ctx.clip();
//then a user draws something onto HIDDEN canvas, like an image
// This image never gets its corners cut
hCtx.drawImage(myImage, 0, 0);
// Then you draw the hidden canvas onto your normal one:
ctx.drawImage(hiddenCanvas, 0, 0); 
```

打印时，您使用隐藏的画布，它没有背景图像，也没有剪角。

# jquery - 无法将 live() 函数转换为 on() jQuery 1.7.2

> ID：13422918
> 
> 赞同：1
> 
> 时间：2012-11-16T19:13:55.040
> 
> 标签：jquery, paste

我有一个使用已弃用的 live() 函数的函数，但无论我尝试什么，我似乎都无法使用 on() 来复制该功能。

这是工作的 live() 代码： `$("#video_url").live("paste", function(){`

这是*应该*工作的 on() 代码： `$(".post-modal").on("paste", "#video_url", function(){`

`.post-modal`是 的直接父级`#video_url`。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:16:04.753

尝试

```
$(document).on("paste", "#video_url", function(){ 
```

确保您将事件委托给的元素存在于 DOM 中，例如您的代码元素中的 class`.post-modal`应该比具有 id 的元素更高级别，`video-url`并且在事件附加到 DOM 时也存在于 DOM 中元素

# javascript - 使用jQuery根据表中`td`的值隐藏`tr`

> ID：13422923
> 
> 赞同：3
> 
> 时间：2012-11-16T19:14:08.533
> 
> 标签：javascript, jquery, html

我有一个表，其中填充了来自后端数据库的查询的动态内容。我想隐藏任何`tr`只包含零的东西。

这是我的桌子的样子：

```
<table id="table1" " cellspacing="0" style="width: 800px">
<thead id="tablehead">
</thead>
<tbody id="tabledata">
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.00%</td>
<td>0.00%</td>
<td>$0.00</td>
<td>$0.00</td>
<td>$0.00</td>
<td>$0.00</td>
<td>$0.00</td>
<td>$0.00</td>
</tr>
</tbody> 
```

现在如果前三个`td`是0 那么我想添加一个类来有效地隐藏该行。我将如何使用 jQuery 来做这件事？`tbody``==``tr`

***编辑：*** 抱歉忘记添加我尝试过的内容。以下是我尝试查看是否可以收集所有的测试`td`脚本

```
$(document).ready(function() {
    $("#table1 td").filter(function() {
        return $(this).text == 0;
    }).css("text-color", "red");

    }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T19:16:40.290

你可以这样做 ：

```
$('tr').each(function(){
    var tr = $(this);
    if (tr.find('td:eq(0)').text()=="0"
        && tr.find('td:eq(1)').text()=="0"
        && tr.find('td:eq(2)').text()=="0"
    ) tr.addClass('hidden');
}); 
```

[演示](http://jsfiddle.net/XULmA/)（隐藏类将颜色变为红色，更清晰...）

根据您的需要，您可能需要[修剪](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/Trim)文本或[解析](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)它们。

对于更复杂的测试，您可能会发现直接使用单元格内容数组很有用。你可以使用它

```
var celltexts = tr.find('td').map(function(){return $(this).text()}).toArray(); 
```

# svn - 我可以在 Ubuntu 12.10 系统上同时拥有 svn 1.6 和 1.7

> ID：13422924
> 
> 赞同：2
> 
> 时间：2012-11-16T19:14:10.700
> 
> 标签：svn, ubuntu, ubuntu-12.10

在我的 Windows 工作站上很容易在 NetBeans 中使用 Tortoise 1.7 和命令行 1.6。在Ubuntu中是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:50:46.917

正如@Pedro Romano 所说，svn 1.7 客户端与 svn 1.6 服务器完全兼容。参见[svn 1.7 兼容性](https://subversion.apache.org/docs/release-notes/1.7.html#compatibility)

你只需要做

```
$ svn updgrade working_dir1 working_dir2 ... 
```

和往常一样工作，升级保留本地修改。看[svn帮助升级](http://www.visualsvn.com/support/svnbook/ref/svn/c/upgrade/)

# c# - 使用复合视图模型进行局部视图验证

> ID：13422927
> 
> 赞同：0
> 
> 时间：2012-11-16T19:14:19.623
> 
> 标签：c#, .net, asp.net-mvc-3, validation, model

我有一个有两种形式的屏幕。一个允许登录到站点，另一个允许登录到 ftp。

Login 视图使用 WelcomeScreenViewModel（组合模型）进行强类型化。每个表单都是一个强类型的局部视图。

这是类定义。

```
public class LogOnViewModel
    {
        [LocalizedDisplayNameAttribute("username", typeof(MyLabels.labels))]
        [Required]
        public string UserName { get; set; }
        [LocalizedDisplayNameAttribute("password", typeof(MyLabels.labels))]
        [Required]
        public string Password { get; set; }
    }

    public class FTPViewModel
    {
        [LocalizedDisplayNameAttribute("username", typeof(MyLabels.labels))]
        [Required]
        public string UserName { get; set; }
        [LocalizedDisplayNameAttribute("password", typeof(MyLabels.labels))]
        [Required]
        public string Password { get; set; }
    }

    public class WelcomeScreenViewModel
    {
        public LogOnViewModel LogOnModel { get; set; }
        public FTPViewModel FTPModel { get; set; }
    } 
```

我的主页继承了 WelcomeScreenViewModel 并且我呈现我的部分视图，如下所示：

Html.RenderPartial("登录", Model.LogOnModel);

Html.RenderPartial("FTP", Model.FTPModel);

我的控制器代码：

```
// To display blank login on load of page
public ActionResult Login(string language)
        {
            WelcomeScreenViewModel combined = new WelcomeScreenViewModel();
            combined.FTPModel = new FTPViewModel();
            combined.LogOnModel = new LogOnViewModel();
            return View(combined);
        }

// Called when clicking submit on first form
[AcceptVerbs(HttpVerbs.Post)]
        public ActionResult Logon(string language, LogOnViewModel logon)
        {
            WelcomeScreenViewModel combined = new WelcomeScreenViewModel();
            combined.FTPModel = new FTPViewModel();
            combined.LogOnModel = logon;

            if (!ModelState.IsValid)
            {
                ViewData["result"] = "Invalid login info / Informations de connexion incorrectes";

                // This is the part I can't figure out.  How do I return page with validation summary errors
                return View(logon);
            }
            else
            {
                ...
            }            
        } 
```

到目前为止，我的问题是当我的 ModelState 无效时要返回什么。如何返回包含验证摘要错误的页面？上面显示的代码只返回部分视图表单（不在主视图内），没有验证。我究竟做错了什么？我开始使用[这篇文章](https://stackoverflow.com/questions/9682316/best-way-to-support-multiple-forms-in-mvc3-with-validation-annotiation)，但它没有显示足够的代码来帮助我。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:50:30.247

我的代码有 2 个问题。

1) 两个子模型的每个字段必须有不同的名称。

```
public class LogOnViewModel
    {
        [LocalizedDisplayNameAttribute("username", typeof(MyLabels.labels))]
        [Required]
        public string UserName { get; set; }
        [LocalizedDisplayNameAttribute("password", typeof(MyLabels.labels))]
        [Required]
        public string Password { get; set; }
    }

    public class FTPViewModel
    {
        [LocalizedDisplayNameAttribute("username", typeof(MyLabels.labels))]
        [Required]
        public string ftpUserName { get; set; }
        [LocalizedDisplayNameAttribute("password", typeof(MyLabels.labels))]
        [Required]
        public string ftpPassword { get; set; }
    } 
```

2）这是用于返回验证和值的代码：

```
return View("~/Views/Login/Login.aspx",combined); 
```

# asp.net-mvc-3 - 动态高级搜索库？

> ID：13422930
> 
> 赞同：0
> 
> 时间：2012-11-16T19:14:29.110
> 
> 标签：asp.net-mvc-3, search

我正准备制作一个 MVC 搜索页面，该页面将允许用户构建自己的查询。他们可能会按标题搜索某些内容，然后添加在特定日期之前发布的对象的“AND”标准，以及具有特定标签的“OR”对象。在我深入研究代码之前，是否有一个库或已经提供了这样的功能的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:24:30.147

这里看看[动态谓词构建器](http://www.albahari.com/nutshell/predicatebuilder.aspx)

# c++ - eclipse 无法从包含文件中包含一些枚举

> ID：13422939
> 
> 赞同：3
> 
> 时间：2012-11-16T19:15:01.963
> 
> 标签：c++, linux, build, ide

我使用 Indigo 版本已经有一段时间了。我不断遇到包含文件中定义的枚举不起作用的问题。IDE 报告无法解析符号，但如果我将其复制到文件中，则会抱怨冲突。

这表明它确实解决了它，但由于某种原因不喜欢它。

我真的很讨厌必须在许多不同的文件中编写相同的枚举。这不就是包含的全部内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T18:56:08.210

看看这个答案：[https ://stackoverflow.com/a/774914/132847](https://stackoverflow.com/a/774914/132847)

之后，您应该：

1.  检查您的 CDT 的 C++ 索引器配置。（我不知道您项目的大小，但它可能有助于增加缓存的大小。）

2.  以这种方式将您的标头目录添加到 Eclipse 项目配置中的包含路径（如果它们不属于您的项目）：

    > 从菜单中选择“项目 > 属性”。出现一个对话框。在左侧的树中打开：“C/C++ General > Paths and Symbols”。

    ![http://help.eclipse.org/galileo/topic/org.eclipse.cdt.doc.user/images/c_paths.png](../Images/13fa270c71aed87a954c3876a80e0593.png)

    > 将头文件的路径添加到包含路径

祝你好运，

塔尔

# centos - Webmin 文件管理器有替代品吗？

> ID：13422947
> 
> 赞同：6
> 
> 时间：2012-11-16T19:15:51.023
> 
> 标签：centos, webmin, file-manager, controlpanel

我想知道是否有任何第三方模块可以替换 Webmin Java 文件管理器。我在 Webmin 网站上找不到任何东西。那么有什么我可以尝试的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-11T06:49:56.490

是的，Android 设备不支持 java 小程序，但有时您只需要在移动/智能手机上快速编辑服务器 (webmin) 上的文件即可。它永远不会起作用......有黑客，裂缝和各种“非官方”的东西，但这不是我喜欢的。在 webmin 中替换基于 java-applet 的文件管理器会很棒，比如说 php 文件管理器，它具有相同或至少一半的功能，能够在 webmin 中随时随地编辑文件......计算机上的 Webmin = java小程序文件管理器，Android设备上的Webmin =其他有效的东西。

# css - 如何将固定元素放置在居中容器旁边

> ID：13422952
> 
> 赞同：0
> 
> 时间：2012-11-16T19:16:03.373
> 
> 标签：css, css-position

我想将我的固定菜单栏定位在我的居中容器旁边，但它的位置是相对于视口而不是容器，所以我在将它保持在容器旁边时遇到了问题。

将固定元素放置在容器旁边的最简单/最干净的方法是什么？

这是我的测试：[https ://dl.dropbox.com/u/10378684/index.html](https://dl.dropbox.com/u/10378684/index.html)

**HTML：**

```
<div id="container">
    <header>
        <hgroup>
            <h3>TIA1</h3>
            <h1>Contreformes</h1>
        </hgroup>

    </header>
    <nav>
        <ol>
            <li><a href="#">Grilles</a></li>
            <li><a href="#">Contreformes</a></li>
            <li><a href="#">Ligne de base</a></li>
        </ol>
    </nav>

    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Esse veritatis non autem blanditiis quo rerum sint quasi architecto quibusdam rem. Quibusdam dolores aliquid eum qui impedit architecto ipsum repellendus illum!</p>    

</div> 
```

**CSS：**

```
* {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;
}

body {
    background: black;
    color: white;
    font-size: 100%;
    font-family: "adelle", Helvetica, serif;
}

a {
    color: white;
    text-decoration: none;
    display: block;
    width: 100%;
    margin-bottom: 0px;
    font-size: 16px;
    text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.8);
    padding:  8px ;
    border-bottom: 2px solid black;
    -webkit-transition: all 0.1s ease-out;
    -moz-transition: all 0.1s ease-out;
    -o-transition: all 0.1s ease-out;
    -ms-transition: all 0.1s ease-out;
    transition: all 0.1s ease-out;
}

a:hover {
    background: rgba(223, 207, 191, 0.4);
    padding-left: 10px;
}

ol {
    color: rgba(223, 207, 191, 0.8);
    position: relative;
    list-style-position: inside;
    padding: 0px;
    width: 139px;
    font-size: 14px;
    background: rgba(223, 207, 191, 0.15);
    position: relative;
    float: left;

}

#container {
    position: relative;
    margin: 0 auto;
    width: 960px;
    background: rgba(34, 34, 34, 1.0);
    height: 900px;
}

h1, h3 {
    text-align: center;
    font-weight: normal;
    margin: 0px;
}

h3 {
    padding-top: 15px;
}

h1 {
    padding-bottom: 35px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T21:12:44.250

这实际上很容易做到。您需要做的就是对`nav`元素的定位使用一些数学知识。现场演示：http: [//jsfiddle.net/3suYg/embedded/result/](http://jsfiddle.net/3suYg/embedded/result/)

```
nav{
    width: 139px;
    position: fixed;
    left: 50%;
    margin-left: -619px; /* 480(half width of 960px container) + 139(width of nav) */
} 
```

显然，尽管您的布局选择会导致较小的屏幕出现问题，因为导航可能会部分或完全隐藏在视图之外。

# python - mac 10.8 上的 Python 2.7 pylab（无限运行）

> ID：13422954
> 
> 赞同：1
> 
> 时间：2012-11-16T19:16:05.767
> 
> 标签：python, macos, matplotlib

请，任何人都可以解释为什么这个代码：

```
import pylab
pylab.figure(1)
pylab.plot([1,2,3,4],[1,7,3,5])
pylab.show 
```

在我的 Mac OS 10.8 上执行火箭图标开始在 Dock 上跳跃，但什么也没发生？

PS我已经下载了32位的Python 2,7，64位的，下载EPD，但到处都是同样的问题（（

这里的视频[http://www.youtube.com/watch?v=faSyAKPpr4A&feature=youtu.be](http://www.youtube.com/watch?v=faSyAKPpr4A&feature=youtu.be)

请，如果有人知道它是什么，请解释一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T10:51:11.343

我有同样的问题。尝试安装freetype：

```
sudo port install freetype 
```

使用 MacPorts，或者，例如，

```
brew install freetype 
```

冲泡。

# clojure - clojure 中的弱引用

> ID：13422955
> 
> 赞同：6
> 
> 时间：2012-11-16T19:16:07.950
> 
> 标签：clojure, weak-references

我会在 clojure 中使用弱引用之类的东西。

我想跟踪特定函数的返回。目前我正在使用参考末尾的地图来执行此操作。这似乎工作得很好。但我想只保留那些没有从其他地方引用的。

在 Java 中，我会使用弱引用或弱哈希表。我在 clojure 中找不到类似的数据结构。有可能的？或者我应该只使用 Java 中的 WeakHashMap 吗？有问题的值是 clojure 记录。我想我可以把这些放到一个java集合中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:47:47.880

Clojure 的指导原则之一是拥抱它解决问题的主机平台。考虑到这一点，不包装普通的 Java 弱哈希映射是很有意义的。**不要为了包装而包装**

# python - 从 Python 连接到谷歌数据存储

> ID：13422958
> 
> 赞同：1
> 
> 时间：2012-11-16T19:16:14.723
> 
> 标签：python, export, google-cloud-datastore

> **可能重复：**
> [Google App Engine 的 PyDev 项目未找到 webapp2](https://stackoverflow.com/questions/7756981/pydev-project-for-google-app-engine-not-finding-webapp2)

我正在做 helloworld 教程，无法从 Python 连接；

这是 app.yaml 文件：

```
application: "ceemee11111"
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:

- url: /.*
  script: helloworld.app

builtins:
- remote_api: on 
```

这是 helloworld.py 的开始：

```
import cgi
import datetime
import urllib
import webapp2

from google.appengine.ext import db
from google.appengine.api import users

class Greeting(db.Model):
      """Models an individual Guestbook entry with an author, content, and date."""
      author = db.StringProperty()
      content = db.StringProperty(multiline=True)
      date = db.DateTimeProperty(auto_now_add=True) 
```

在 Python shell 我 chdir 到 helloworld 导入 helloworld

并得到导入错误“没有名为 webapp2 的模块”

该应用程序在 localhost 和 ceemee11111.appspot.com 中运行，没有错误。作为测试，我注释掉了“import webapp2”并再次尝试并收到错误“No module named google.appengine.ext”

请一些想法

担

应用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:04:29.367

好像python找不到库，所以

*   你有没有在系统中安装webapp2？您可以尝试使用“pip install webapp2”或“easy_install”

*   如果它们仍然丢失，也许你应该检查你的“PYTHONPATH”变量，检查python在哪里寻找库，并将你的添加到路径中。

# c# - 可以嗅探 odbcconnection 上的连接字符串吗？

> ID：13422959
> 
> 赞同：1
> 
> 时间：2012-11-16T19:16:23.117
> 
> 标签：c#, ado.net

我正在使用 OdbcConnection 与 DB2 数据库 ex 进行通信。

```
using (var conn = new ODBCConnection("Database=Database;UID=user;PWD=password"))
{
    conn.Open();
    …
} 
```

我担心有权访问机器的人可能会试图窃取数据库凭据。我已经混淆了代码，但是可以使用数据包嗅探器来获取连接字符串吗？如果是这样，有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:22:13.053

如果有人可以访问您的程序集或可执行文件，则可以使用[ildasm](http://msdn.microsoft.com/en-us/library/f7dy01k1%28v=vs.110%29.aspx)来读取 C# 编译成的中间语言 (CIL)。即使您混淆了代码，也很容易检索字符串文字。

混淆器通常会加密字符串文字，并在使用它们之前注入一个额外的方法调用来解密它们。这意味着可以获得解密程序的实现和密钥，并自己运行它们。

因此，要回答您的问题，您甚至不需要使用数据包嗅探器来获取凭据，只需检查 IL 即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:17:59.710

您可以将您的连接字符串存储在 App.Config/Web.Config 中，然后您可以加密您的连接字符串

[http://www.asp.net/web-forms/tutorials/data-access/advanced-data-access-scenarios/protecting-connection-strings-and-other-configuration-information-cs](http://www.asp.net/web-forms/tutorials/data-access/advanced-data-access-scenarios/protecting-connection-strings-and-other-configuration-information-cs)

[http://msdn.microsoft.com/en-us/library/zhhddkxy(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/zhhddkxy(v=vs.100).aspx)

# html - 如何在 AngularJS 中为 ngInclude 指令指定模型？

> ID：13422966
> 
> 赞同：44
> 
> 时间：2012-11-16T19:16:48.340
> 
> 标签：html, templates, angularjs

我想在 3 个地方使用相同的 HTML 模板，只是每次都使用不同的模型。我知道我可以从模板访问变量，但名称会有所不同。

有没有办法将模型传递给 ngInclude？

这是我想要实现的，当然属性 add-variable 现在不起作用。然后在我包含的模板中，我将访问 detailsObject 及其属性。

```
<pane title="{{projectSummary.ProjectResults.DisplayName}}">
    <h2>{{projectSummary.ProjectResults.DisplayName}}</h2>
    <ng-include src="'Partials/SummaryDetails.html'" init-variable="{'detailsObject': projectSummary.ProjectResults}"></ng-include>
</pane>

<pane  title="Documents" header="true"></pane>

<pane ng-repeat="document in projectSummary.DocumentResults" title="{{document.DisplayName}}">
    <h2>{{document.DisplayName}}</h2>
    <ng-include src="'Partials/SummaryDetails.html'" add-variable="{'detailsObject': document}"></ng-include>
</pane>

<pane ng-repeat="header in [1]" title="Languages" header="true"></pane>

<pane ng-repeat="language in projectSummary.ResultsByLanguagePairs" title="{{language.DisplayName}}">
    <h2>{{document.DisplayName}}</h2>
    <ng-include src="'Partials/SummaryDetails.html'" add-variable="{'detailsObject': language}"></ng-include>
</pane> 
```

如果我在使用 ng-include 时采取了不好的方法，还有什么我应该尝试的吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-12-17T16:13:18.853

有一个相当简单的解决方案，尽管我必须承认，这不是 Misko 推荐的。但是，如果创建指令对您来说太过分了并且获得 Brice 的补丁是不可行的，那么以下内容将对您有所帮助。

```
<div ng-repeat="name in ['A']" ng-include="'partial.html'"></div>
<div ng-repeat="name in ['B']" ng-include="'partial.html'"></div>

<script type="text/ng-template" id="partial.html">
   <div>{{ name }}</div>
</script> 
```

很明显它为什么起作用。在此处查看示例：http: [//jsfiddle.net/Cndc6/4/](http://jsfiddle.net/Cndc6/4/)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-11-16T19:31:54.493

**注意：这不是我最初的答案，但这是我在使用 angular 一段时间后会这样做的方式。**

我将创建一个带有 html 模板的指令作为将动态数据传递给指令的标记，如[本小提琴](http://jsfiddle.net/NMmyY/141/)所示。

此示例的步骤/注释：

1.  在用于将数据传递到指令中的和属性中定义一个带有标记`templateUrl`的指令（`type`在此示例中命名）。
2.  使用模板中的指令数据（`type`在本例中命名）。
3.  在标记中使用指令时，请确保将数据从控制器范围传递到指令（`<address-form type="billing"></address-form>`（其中计费正在访问控制器范围上的对象）。
4.  请注意，在定义指令时，名称是驼峰式的，但在标记中使用时，它是小写破折号分隔的（即，它`addressForm`在 js 中命名，但`address-form`在 html 中命名）。可以在[此处](https://docs.angularjs.org/guide/directive)的 angular 文档中找到有关此的更多信息。

这是js：

```
var myApp = angular.module('myApp',[]);

angular.module('myApp').directive('addressForm', function() {
    return {
        restrict: 'E',
        templateUrl: 'partials/addressform.html', // markup for template
        scope: {
            type: '=' // allows data to be passed into directive from controller scope
        }
    };
});

angular.module('myApp').controller('MyCtrl', function($scope) {
    // sample objects in the controller scope that gets passed to the directive
    $scope.billing = { type: 'billing type', value: 'abc' };
    $scope.delivery = { type: 'delivery type', value: 'def' };
}); 
```

带标记：

```
<div ng-controller="MyCtrl">
    <address-form type="billing"></address-form>
    <address-form type="delivery"></address-form>
</div> 
```

* * *

**原始答案（这与使用指令 BTW 完全不同）。**

注意：由于错误，下面我原始答案中的小提琴似乎不再起作用（但将其保留在这里以防它仍然有用）

Google Group 上对此进行了讨论，您可以[在此处查看](https://groups.google.com/d/topic/angular/5clM0kjHXq8/discussion)。

看起来此功能不支持开箱即用，但您可以使用 Brice 的补丁，如[本文](https://groups.google.com/d/msg/angular/5clM0kjHXq8/5Wj5716_QikJ)所述。

这是他的[jsfiddle](http://jsfiddle.net/briceburg/NMmyY/1/)的示例代码：

```
<script id="partials/addressform.html" type="text/ng-template">
    partial of type {{type}}<br>
</script>

<div ng-controller="MyCtrl">
  <ng-include src="'partials/addressform.html'" onInclude="type='billing'"></ng-include>
  <ng-include src="'partials/addressform.html'" onLoad="type='delivery'"></ng-include>
</div> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-01-23T17:58:46.243

有一个解决这个问题的方法，但它看起来已经死了： [https ://github.com/angular/angular.js/pull/1227](https://github.com/angular/angular.js/pull/1227)

在不修改 Angular 源代码的情况下，这将以一种可重用且不太老套的方式解决问题：

```
directive('newScope', function() {
    return {
        scope: true,
        priority: 450,
    };
}); 
```

还有一个例子：

```
<div new-scope ng-init="myVar = 'one instance'" ng-include="'template.html'"></div>
<div new-scope ng-init="myVar = 'another instance'" ng-include="'template.html'"></div> 
```

这是它的一个 Plunker： [http ://plnkr.co/edit/El8bIm8ta97MNRglfl3n](http://plnkr.co/edit/El8bIm8ta97MNRglfl3n)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-10-09T17:07:59.373

```
<div new-scope="myVar = 'one instance'" ng-include="'template.html'"></div>

directive('newScope', function () {
    return {
        scope: true,
        priority: 450,
        compile: function () {
            return {
                pre: function (scope, element, attrs) {
                    scope.$eval(attrs.newScope);
                }
            };
        }
    };
}); 
```

这是一个指令，它结合`new-scope`了[John Culviner 的答案](https://stackoverflow.com/a/21315914/3116322)和 Angular 的代码`ng-init`。

为了完整起见，这是[Angular 1.2 26 ng-init 源代码](https://raw.githubusercontent.com/angular/code.angularjs.org/master/1.2.26/angular.js)，您可以看到 new-scope 指令的唯一变化是添加了`scope: true`

```
{
  priority: 450,
  compile: function() {
    return {
      pre: function(scope, element, attrs) {
        scope.$eval(attrs.ngInit);
      }
    };
  }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-11-16T19:40:16.463

Quick'n'dirty 解决方案：

```
<div ng-init="details=document||language||projectSummary.ProjectResults"> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-10-25T18:10:07.903

我听你的！ng-include 不是那么可重用，因为它可以访问全局范围。这有点奇怪。

应该有一种方法来设置局部变量。[使用新指令而不是 ng-include](http://tech.fongmun.com/post/131863914487/scoping-variables-in-ng-include-without-ng-repeat)是一种更简洁的解决方案。

理想的用法如下所示：

```
<div ng-include-template="'Partials/SummaryDetails.html'" ng-include-variables="{ 'detailsObject': language }"></div> 
```

该指令是：

```
.directive(
  'ngIncludeTemplate'
  () ->
    {
      templateUrl: (elem, attrs) -> attrs.ngIncludeTemplate
      restrict: 'A'
      scope: {
        'ngIncludeVariables': '&'
      }
      link: (scope, elem, attrs) ->
        vars = scope.ngIncludeVariables()
        for key, value of vars
          scope[key] = value
    }
) 
```

您可以看到该指令不使用全局范围。相反，它从 ng-include-variables 读取对象并将这些成员添加到它自己的本地范围内。

它干净而通用。

# c++ - 编译时常量整数的模板特化

> ID：13422967
> 
> 赞同：1
> 
> 时间：2012-11-16T19:16:51.630
> 
> 标签：c++, templates, gcc, c++11

是否可以专门化一个函数（或至少一个类）以在常量（编译时！）整数和所有其他参数之间进行选择？如果是这样，最好只对特定的常量值进行专门化 (enable_if)。

在下面的示例中，这意味着输出“var”、“const”和“var”，而不是三个“var”。

```
#include <type_traits>
#include <iostream>
using namespace std;

struct test
{
    template <typename T>
    test& operator=(const T& var) { cout << "var" << endl; return *this; }
    template <int n> // enable_if< n == 0 >
    test& operator=(int x) { cout << "const" << endl; return *this; }
};

int main()
{
    test x;
    x = "x";
    x = 1;
    int y = 55;
    x = y;
    return 0;
} 
```

更新：编辑代码以强调它必须是编译时常量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:42:11.247

要进入`var, const, var`您的示例，您可以这样做。

```
struct test {
  template <typename T>
  test& operator=(const T& var) { cout << "var" << endl; return *this; }
  test& operator=(int &&x) { cout << "const" << endl; return *this; }
}; 
```

它适用于所有临时工，但它会失败：

```
const int yy = 55;
x = yy; 
```

要使其也适用于这种情况，您需要添加：

```
test& operator=(int &x)       { cout << "var" << endl; return *this; }
test& operator=(const int &x) { cout << "const" << endl; return *this; } 
```

# vba - 如何在 VBA 中使用带有条件检查的 Mouseout 功能？

> ID：13422969
> 
> 赞同：0
> 
> 时间：2012-11-16T19:16:53.373
> 
> 标签：vba

嗨，我有一个带有组合框选择选项的 VBA 应用程序。其中一个组合框选项是“其他”，当用户选择该选项时，会弹出一个不可见的标签并提示用户填写 txtOther 控件。现在我的问题是如何摆脱提示标签，并在用户填写 txtOther 并在其他控件中移动（聚焦）后使其不可见？这是我的应用程序的照片：

![在此处输入图像描述](../Images/b9211633714fcb07b1f4d515f6d9529b.png)

感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:47:29.557

这取决于您希望检查的频率或时间。我找不到向您展示所有这些的好参考，但您可以查看您的 VBE。

在用户表单后面的代码中，您可以使用文本框的事件。如果您希望每次离开文本框时都完成检查：

使用 TextBox_Exit 事件。

如果您希望它在内容更改时触发，请使用 TextBox_Change。有很多选择，但根据您的解释，我可能会使用 Exit。

这个答案显示了一些[使用 Textbox_Exit 事件的语法示例](https://stackoverflow.com/a/13400244/1316573)。

# javascript - 选择一个类而不是其他类jquery javascript的项目

> ID：13422975
> 
> 赞同：2
> 
> 时间：2012-11-16T19:17:19.860
> 
> 标签：javascript, jquery, class, select

我想选择一个类中的所有项目，而不是一组其他类中的所有项目。第一步，我想象这样的事情会起作用，但没有：

```
$('.class1,!.class2') 
```

我实际上拥有的是我不想选择的类列表：

```
dont_select = ['class2', 'class3', 'class4'] 
```

我想在 dont_select 的类数组中选择所有具有 class1 但没有任何类的项目（长度不同）。谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T19:20:49.157

试试这个：

```
$(".class1").not("." + dont_select.join(",.") ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:19:13.077

试一试：

```
$(".class1:not(.class2)")

$(".class1:not(" + dont_select.join() + ")"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T19:20:49.830

你应该使用`.not`函数。见下文，

```
dont_select = ['.class2', '.class3', '.class4']
$(selector).not(dont_select.join()) 
```

**注意：**添加了 . 到 dont_select 数组中的字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-15T13:35:02.117

您的简单选择器将与 Jquery 如下所示

```
$('div.class1').not('.class2,.class3'); 
```

在 jquery 的 .not 函数中，您可以在“，”之后放置任意数量的元素

或者如果你有数组，那么你也可以接受 Vega 的建议

```
dont_select = ['.class2', '.class3', '.class4']
$(selector).not(dont_select.join()) 
```

前进 ！！！

# mysql - 如何将 SQL 信息从一个数据库移动到另一个数据库

> ID：13422983
> 
> 赞同：1
> 
> 时间：2012-11-16T19:17:52.207
> 
> 标签：mysql, sql

我试图将 SQL 从一个脚本迁移到另一个脚本，即只是其中的一部分，但它们使用不同的“代码”。

基本上我试图移动“状态”的信息，这些信息在两个数据库中都作为一个数字保存。但是数字当然是不同的，例如亚利桑那州的一个是 12，另一个是 3425。

我试图找到一种方法来首先匹配两者中相同的客户 ID，然后从一个 DB 中获取数字，然后将其转换为它在新 DB 中的数字，并将其放在所述 DB 中的正确区域。

但是我的 SQL 技能非常缺乏，我找不到合理的解决方案。

正在使用的脚本：旧 - CRE 加载 4.2.1a 新 - OpenCart（当前版本）

编辑

这是我最好的解释数据库结构，如果它不是对数据库工作方式的最佳解释，请原谅：

这是所涉及的表的旧数据库结构：

address_book - 保存客户信息，州编号以数字格式保存在列 entry_zone_id 中，国家编号也以数字格式保存在 entry_country_id 中，“区域 ID”基于“国家 ID”，具体取决于国家/地区。

zone - 保存州和国家/地区 ID 信息，示例：对于 arizona，zone_id 为 4，zone_country_id 为 223（对于美国），zone_code 为 AZ，Zone_name 为 Arizona

客户 - 这包含主要的客户信息，不包括地址信息，customers_id 当然是与表地址簿中相同的客户 ID 对应的客户 ID 号。customers_default_address_id 也与 address_book 中的 ID 相对应。

现在至于新数据库：

oc_address - address_id 和 customer_id 标记客户 ID 号。country_id 告诉他们在哪个国家，它的数字格式。zone_id 保存状态的数据库编号。

oc_zone - "zone_id" 保存 Zones ID，"country_id" 保存国家 ID 号，例如 USA 是。“name”是州名。“代码”州或国家代码。示例：数据库中的 Arizona 显示如下：zone_id=3616，country_id=223，name=Arizona，code=AZ，status=1（显示已使用）

可能还需要知道一个：oc_country - 保存国家信息，country_id 保存国家代码，name 是国家名称，isa_code_2 和 iso_code_3 是国家 ISO 代码。

我希望这是有用的。

# eclipse - 在包“android”中找不到属性“layout_width”的资源标识符

> ID：13422986
> 
> 赞同：0
> 
> 时间：2012-11-16T19:18:06.013
> 
> 标签：eclipse

我在 eclipse 中有一个错误：

> **根元素之后的文档中的标记必须格式正确，**并且**在包 'android' 中找不到属性 'layout_width' 的资源标识符**

这个错误在`activy_main.xml`. 所有代码来自`activy_main.xml`：

*   [http://imageshack.us/photo/my-images/62/10025996.png/](http://imageshack.us/photo/my-images/62/10025996.png/)；
*   [http://imageshack.us/photo/my-images/834/23696260.png/](http://imageshack.us/photo/my-images/834/23696260.png/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:25:07.993

问题出在您的相对布局上，您在其中提供了一个按钮的 id，然后将其关闭...只需将其而不是您之前的相对布局，并告诉我它是否有效

```
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#000000"> 
```

# javascript - 按钮 - 仅当 JavaScript 函数返回 true 时才进行回发

> ID：13422988
> 
> 赞同：0
> 
> 时间：2012-11-16T19:18:17.027
> 
> 标签：javascript, jquery, asp.net, validation, postback

我在 ASP.NET 中有一个按钮。当用户单击按钮时，我想事先进行一些验证，因此只有在验证方法返回 true 时才会发生回发。

我的想法是使用按钮的 OnClientClick 的逻辑。如果你说 OnClientClick="return false;"，它不会回发，而返回 true 会。但是，这不起作用，因为结果行为是即使我的 jQuery 方法返回，它也不会进行回发。

目前我有：

标记：

```
<asp:Button runat="server" ID="ReplyBtn" OnClientClick="return ValidateInput();" OnClick="ReplyBtn_Click" CssClass="btn-large btn-success"
    Text="Answer" /> 
```

JavaScript：

```
function ValidateInput() {
        var value = stripHtml(CKEDITOR.instances['ReplyBox'].getData()).trim();
        var options = {
            type: "POST",
            url: "../../Services/ForumOperationService.svc/ReplyToPostFeedback",
            data: '{"content":"' + value + '"}',
            async: false,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(msg) {
                $("#StatusReplyLbl").text(msg.ReplyToPostFeedbackResult);

                if (msg.ReplyToPostFeedbackResult) {
                    return false;
                } else {
                    return true;
                }

            },
            error: function () {
                return true;
            }
        };
        $.ajax(options);
        return false;
    }

    function stripHtml(str) {
        return $('<div />', { html: str }).text();
    } 
```

所以基本上，这段代码有什么问题？以及如何在回发之前对我的按钮执行验证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T19:22:21.480

您的函数无条件返回`false`，因为您没有使用来自 ajax 对象的响应。例如，假设您的服务器端脚本在验证成功时返回文本“OK”。你可以尝试这样的事情：

```
function ValidateInput() {
    var value = stripHtml(CKEDITOR.instances['ReplyBox'].getData()).trim();
    var options = {
        type: "POST",
        url: "../../Services/ForumOperationService.svc/ReplyToPostFeedback",
        data: '{"content":"' + value + '"}',
        async: false,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(msg) {
            $("#StatusReplyLbl").text(msg.ReplyToPostFeedbackResult);
        }
    };
    var resp = $.ajax(options);
    return (resp.status==200 && resp.responseText == "OK");
} 
```

理想情况下，您要做的是无条件地返回 false，并在成功处理程序中自己触发回发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:28:47.027

不是 100% 满足您的要求，但我认为问题在于，即使您希望它从 ajax 请求返回 true，该函数也总是返回 false？

如上所述，运行 async 的 ajax 会导致这不起作用，但看起来您将 async 设置为 false。

问题是你的回报。

返回真；ajax函数里面返回的是ajax调用的成功函数，而不是整体函数。

我认为这不是实现您的目标的最佳方式，但根据您已经拥有的代码，这就是我认为您需要的。

```
function ValidateInput() {
    var replayToPost = false;
    var value = stripHtml(CKEDITOR.instances['ReplyBox'].getData()).trim();
    var options = {
        type: "POST",
        url: "../../Services/ForumOperationService.svc/ReplyToPostFeedback",
        data: '{"content":"' + value + '"}',
        async: false,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(msg) {
            $("#StatusReplyLbl").text(msg.ReplyToPostFeedbackResult);

            if (msg.ReplyToPostFeedbackResult) {
                replayToPost = false;
            } else {
                replayToPost = true;
            }

        },
        error: function () {
            return true;
        }
    };
    $.ajax(options);
    return replyToPost;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T19:32:54.723

您的 ajax 函数中的返回结果将是从成功或错误方法返回的结果，因此它不会对 ValidateInput() 方法产生影响。您需要在 ajax 调用范围之外声明一个变量，然后返回该结果。

```
function ValidateInput() {
    var value = stripHtml(CKEDITOR.instances['ReplyBox'].getData()).trim();
    var result = false;

    $.post("../../Services/ForumOperationService.svc/ReplyToPostFeedback", '{"content":"' + value + '"}', function (msg) {
            $("#StatusReplyLbl").text(msg.ReplyToPostFeedbackResult);
            if (!msg.ReplyToPostFeedbackResult){
                result = true;
            }
    });

    return result;
} 
```

# javascript - JQuery $.each 返回相同的数据集两次

> ID：13422990
> 
> 赞同：3
> 
> 时间：2012-11-16T19:18:30.827
> 
> 标签：javascript, jquery, each

我正在构建一个 Instagram 地图应用程序，并尝试使用 $.each 遍历返回的 JSON。我目前正在通过将图片的坐标返回到`<div>`. 它工作得很好，除了相同的数据出现两次。这是声明（注释掉的代码用于将其放在地图上）：

```
$.each(photos.data, function (index, photo) {
    if (photo.location) {
        /* var photocoords = google.maps.LatLng(photo.location.latitude,location.longitude);
                                var marker = new google.maps.Marker({
                                    position: photocoords,
                                    map: map,
                                    title: 'Test'
                                            });//end new marker

                                    */
        photo = photo.location.latitude + ' , ' + photo.location.longitude + '<br>';

        $('#photos-wrap').append(photo);
    } //end if
    else {
        return true
    }
}); 
```

它返回的数据：

```
38.9232268 , -77.0464289
35.046506242 , -90.025382579
35.189142533 , -101.987259233

38.9232268 , -77.0464289
35.046506242 , -90.025382579
35.189142533 , -101.987259233 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T08:31:05.613

将您的代码更改为此

```
 var new_photo = photo.location.latitude + ' , ' + photo.location.longitude + '<br>';
    $('#photos-wrap').append(new_photo); 
```

# vhdl - VHDL 结构与行为

> ID：13422993
> 
> 赞同：6
> 
> 时间：2012-11-16T19:18:44.187
> 
> 标签：vhdl

对于那些对 VHDL 有很好理解的人来说，这是一个问题。我是新手，但到目前为止，我一直在使用行为描述生成 VHDL。对我来说，它更容易思考，因为它类似于编写软件。我知道一个可能的失败是行为“执行”顺序，而结构在设计组件/过程中同时执行。

所以我很好奇，如果我有一个使用 8 位移位寄存器 (SISO) 进程的体系结构，并且我想创建这些（4x8 位移位寄存器）的 4 个实例，我会创建一个组件和 4过程的实例？

或者我会生成 4 个进程（彼此并行执行），然后用不同的名称调用每个进程？

此外，只是一个一般性问题，以就人们在那里使用的良好实践达成共识，您更喜欢哪个：结构性与行为性？什么时候是选择一个而不是另一个的好时机？我猜他们可能会通过使用允许内部并发与进程中顺序执行的组件“更快”执行来带来一些好处。虽然在我看来确实可以通过行为设计减少设计时间。

谢谢！〜狡猾的

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-16T20:26:41.383

就我而言，如今结构 HDL 的作用仅限于互连经过测试的工作行为模块（或将未经测试的行为模块连接到他们的测试平台！） - 我同意你关于行为 VHDL 在设计创建和测试时间方面的优势。

我也同意编写行为过程在某些方面类似于编写软件（在某些人的尖叫声中并非如此）

然而

不要陷入将行为等同于顺序或缓慢的陷阱！

给定你的移位寄存器，说

```
type reg_type is array(7 downto 0) of bit;
signal s_in, s_out : bit;

process(clk) is
variable reg : reg_type;
begin
   if rising_edge(clk) then
      s_out <= reg(7);
      reg   := reg(6 downto 0) & s_in;
   end if;
end; 
```

我可以简单地将其并行化如下：

```
signal p_in, p_out : array(1 to 4) of bit;

process(clk) is
variable reg : array(1 to 4) of reg_type;
begin
   if rising_edge(clk) then
      for i in reg'range loop
         p_out(i) <= reg(i)(7);
         reg(i)   := reg(i)(6 downto 0) & p_in(i);
      end loop;
   end if;
end; 
```

（是的，有更简单的方法来写这个！）重要的是要注意循环不再需要运行：它只是生成更多的硬件（在软件方面，它完全展开）。每次迭代都完全独立于其他迭代；如果他们不是，事情会更复杂。

不要担心结构和行为之间的学术差异。

担心进程中信号分配调度和变量分配调度之间的区别（了解什么是增量周期和延迟分配 - 这是与软件的关键区别之一，并且因为软件只有变量，而不是 VHDL 的信号而出现）。这将解释为什么我在这里颠倒了管道（输出优先） - 因为我使用了一个变量。

担心当 1 进程 SM 更简单、更安全时，为什么还有这么多人教愚蠢的 2 进程状态机。

查找并了解 Mike Treseler 的关于单进程模型的页面（希望它们还在线）

# c++ - 将 QLineEdit 设置为仅接受数字

> ID：13422995
> 
> 赞同：94
> 
> 时间：2012-11-16T19:18:52.517
> 
> 标签：c++, qt, qlineedit

我有一个`QLineEdit`用户应该只输入数字的地方。

那么是否有一个仅限数字的设置`QLineEdit`？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-11-16T19:36:40.303

`QLineEdit::setValidator()`， 例如：

```
myLineEdit->setValidator( new QIntValidator(0, 100, this) ); 
```

或者

```
myLineEdit->setValidator( new QDoubleValidator(0, 100, 2, this) ); 
```

请参阅：[QIntValidator](http://doc.qt.io/qt-5/qintvalidator.html)、[QDoubleValidator](http://doc.qt.io/qt-5/qdoublevalidator.html)、[QLineEdit:: setValidator](http://doc.qt.io/qt-5/qlineedit.html#setValidator)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-10-12T21:37:54.483

最好的是[`QSpinBox`](http://doc.qt.io/qt-4.8/qspinbox.html)。

对于双值使用[`QDoubleSpinBox`](http://doc.qt.io/qt-4.8/qdoublespinbox.html).

```
QSpinBox myInt;
myInt.setMinimum(-5);
myInt.setMaximum(5);
myInt.setSingleStep(1);// Will increment the current value with 1 (if you use up arrow key) (if you use down arrow key => -1)
myInt.setValue(2);// Default/begining value
myInt.value();// Get the current value
//connect(&myInt, SIGNAL(valueChanged(int)), this, SLOT(myValueChanged(int))); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2019-02-24T08:08:40.780

**正则表达式验证器**

到目前为止，其他答案只为相对*有限*的数字提供了解决方案。但是，如果您关心*任意*或*可变*数量的数字，您可以使用 a [`QRegExpValidator`](https://doc.qt.io/qt-5/qregexpvalidator.html)，传递一个只接受数字的正则表达式（如[user2962533 的评论](https://stackoverflow.com/questions/13422995/set-qlineedit-to-accept-only-numbers#comment63124415_13423244)所述）。这是一个最小的完整示例：

```
#include <QApplication>
#include <QLineEdit>
#include <QRegExpValidator>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    QLineEdit le;
    le.setValidator(new QRegExpValidator(QRegExp("[0-9]*"), &le));
    le.show();

    return app.exec();
} 
```

有其`QRegExpValidator`优点（这只是轻描淡写）。它允许进行许多其他有用的验证：

```
QRegExp("[1-9][0-9]*")    //  leading digit must be 1 to 9 (prevents leading zeroes).
QRegExp("\\d*")           //  allows matching for unicode digits (e.g. for 
                          //    Arabic-Indic numerals such as ٤٥٦).
QRegExp("[0-9]+")         //  input must have at least 1 digit.
QRegExp("[0-9]{8,32}")    //  input must be between 8 to 32 digits (e.g. for some basic
                          //    password/special-code checks).
QRegExp("[0-1]{,4}")      //  matches at most four 0s and 1s.
QRegExp("0x[0-9a-fA-F]")  //  matches a hexadecimal number with one hex digit.
QRegExp("[0-9]{13}")      //  matches exactly 13 digits (e.g. perhaps for ISBN?).
QRegExp("[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}")
                          //  matches a format similar to an ip address.
                          //    N.B. invalid addresses can still be entered: "999.999.999.999". 
```

**更多在线编辑行为**

根据[文件](https://doc.qt.io/qt-5/qlineedit.html#details)：

> 请注意，如果在行编辑上设置了验证器，则仅当验证器返回 QValidator::Acceptable 时才会发出 returnPressed()/editingFinished() 信号。

因此，即使尚未达到最小数量，行编辑也将允许用户输入数字。例如，即使用户没有针对正则表达式输入任何文本`"[0-9]{3,}"`（至少需要 3 位数字），行编辑仍然允许用户键入输入以*达到*最低要求。但是，如果用户没有满足“至少3位”的要求就完成了编辑，则输入*无效*；信号`returnPressed()`并且`editingFinished()`不会被发射。

如果正则表达式有一个最大界限（例如`"[0-1]{,4}"`），那么行编辑将停止任何超过 4 个字符的输入。此外，对于字符集（即`[0-9]`、`[0-1]`、`[0-9A-F]`等），行编辑仅允许输入来自*该特定集*的字符。

*[请注意，我只在 macOS 上使用 Qt 5.11 进行了测试，而不是在其他 Qt 版本或操作系统上进行了测试。但鉴于 Qt 的跨平台架构......]*

***[演示：[正则表达式验证器展示](https://github.com/TrebledJ/Qt-Examples/tree/master/%5Bwidgets%5D--regex-validators)]***

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-09-30T16:01:55.197

您还可以设置一个[`inputMask`](http://qt-project.org/doc/qt-4.8/qlineedit.html#inputMask-prop)：

```
QLineEdit.setInputMask("9") 
```

这允许用户只键入一个数字，范围从`0`到`9`。使用多个`9`'s 允许用户输入多个数字。[另请参阅可在输入掩码中使用的字符](http://qt-project.org/doc/qt-4.8/qlineedit.html#inputMask-prop)的完整列表。

（我的答案是在 Python 中，但将其转换为 C++ 应该不难）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-05-11T21:01:07.043

你为什么不使用 a`QSpinBox`来达到这个目的？您可以使用以下代码行将向上/向下按钮设置为不可见：

```
// ...
QSpinBox* spinBox = new QSpinBox( this );
spinBox->setButtonSymbols( QAbstractSpinBox::NoButtons ); // After this it looks just like a QLineEdit.
//... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-14T01:14:21.720

如果您使用的是 QT Creator 5.6，您可以这样做：

```
#include <QIntValidator>

ui->myLineEditName->setValidator( new QIntValidator); 
```

我建议你把那一行放在 ui->setupUi(this); 之后

我希望这有帮助。