# StackOverflow 问答 15026000-15026999

# python - 如何在 __init__.py 中使用 modulefinder replace_path 导入包

> ID：15026000
> 
> 赞同：2
> 
> 时间：2013-02-22T14:06:40.147
> 
> 标签：python, import, path, package

在目录 mydir 我有：

```
 x.py with:

     import mypackage.mymodule

 mymodule.py:
    def module()
 __init__.py 
```

我不想在 mydir 中创建一个子目录 mypackage 并在那里有另一个 __init__.py 。我知道不推荐我的原因超出了这里的范围。

我试图使用模块查找器修改模块名称和路径。我没有找到关于这个主题的好的文档；

我创建了一个文件：

```
 mymod.py:

    import mypackage.mymodule
    import x

and from \__init__.py:

        import modulefinder
        finder = modulefinder.ModuleFinder('/fullpath/mydir',0,['x.py'],['mypackage.mymodule',(('mypackage/mymodule','mymodule')
        finder.run_script('mymod')

I also tried:

    __init__.py:

      import modulefinder
      modulefinder.AddPackagePath('mypackage','/fullpath/mydir') 
```

我尝试的第三种方法是自己修改 sys.modules。也不适合我；我在 key() 上遇到了设置错误。

您能否为每种方法指定为什么它不起作用以及正确的抽动方法？

# php - Mysql php查询没有返回结果

> ID：15026003
> 
> 赞同：-1
> 
> 时间：2013-02-22T14:06:45.447
> 
> 标签：php, mysql

此代码不返回任何结果，现在显示错误。我想要的只是如果我点击一个 clink 它应该带我到一个新页面并显示该用户从两个表中选择的所有信息。如果我从 1 中选择它可以工作，但在 2 中它不会

```
$query ='SELECT  
 tish_clientinfo.client_id, tish_clientinfo.firstname,
 tish_images.image_name
    FROM  tish_clientinfo 
    INNER JOIN tish_images 
ON tish_clientinfo.user_id = tish_images.user_id
WHERE user_id= '. $_GET['user_id']; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:34:23.620

模糊的名称字段 user_id，也许？？..试试这个：

```
$query ="SELECT  
tish_clientinfo.client_id, tish_clientinfo.firstname,
tish_images.image_name
  FROM  tish_clientinfo 
  INNER JOIN tish_images 
ON tish_clientinfo.user_id = tish_images.user_id
WHERE tish_clientinfo.user_id= ". intval($_GET['user_id']).";"; 
```

萨卢多斯 ;)

# r - 在 facet_wrap() 中的所有绘图中添加一条恒定线

> ID：15026013
> 
> 赞同：0
> 
> 时间：2013-02-22T14:07:18.863
> 
> 标签：r, graph, ggplot2

我有以下代码：

```
p1 <- ggplot(df_test, aes(x=AA_Number,y=Energy_Profile,col='red')) + geom_line() + facet_wrap(~Model, ncol=3) + geom_hline(yintercept=-0.03, colour='blue') + geom_line(data=df_templates, colour="green")

print(p1) 
```

它产生这个输出：

![阴谋](../Images/9a4cec3b841b7762114674ad1f28dd7e.png)

我无法将绿色数据合并到一个图中，然后将其绘制在其他三个红色图上。

本质上，绿色图是我的常数，我想通过将绿色数据覆盖在每个红色图的顶部来查看我的红色数据如何与常数变化。

有人有什么想法吗？

数据：

`df_test`：

```
structure(list(Model = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("102", 
"103", "104", "105", "107", "108", "109", "118", "141", "143", 
"144", "145", "14x", "161", "162", "163", "164", "165", "167", 
"168", "169", "2", "21", "22", "25", "26", "27", "3", "31", "310", 
"32", "36", "37", "39", "51", "510", "52", "53", "54", "57", 
"61", "62", "64", "65", "66", "67", "68", "81", "84", "88", "910", 
"93", "95", "97"), class = "factor"), AA_Number = 1:614, AA = structure(c(1L, 
15L, 1L, 10L, 11L, 4L, 18L, 18L, 1L, 9L, 12L, 7L, 19L, 11L, 14L, 
16L, 4L, 4L, 10L, 11L, 16L, 9L, 11L, 16L, 1L, 18L, 2L, 2L, 10L, 
1L, 2L, 11L, 18L, 8L, 14L, 4L, 19L, 15L, 11L, 6L, 14L, 4L, 1L, 
6L, 1L, 2L, 13L, 11L, 6L, 19L, 1L, 6L, 1L, 17L, 6L, 19L, 10L, 
15L, 4L, 6L, 5L, 2L, 2L, 1L, 6L, 18L, 4L, 5L, 12L, 17L, 5L, 8L, 
2L, 3L, 4L, 14L, 5L, 13L, 3L, 2L, 5L, 13L, 8L, 8L, 7L, 4L, 7L, 
5L, 15L, 13L, 3L, 1L, 6L, 4L, 13L, 4L, 4L, 9L, 13L, 15L, 15L, 
9L, 13L, 7L, 5L, 8L, 1L, 2L, 5L, 15L, 2L, 5L, 2L, 14L, 1L, 16L, 
2L, 7L, 8L, 4L, 9L, 6L, 9L, 6L, 19L, 1L, 19L, 13L, 10L, 6L, 6L, 
16L, 10L, 16L, 6L, 8L, 11L, 2L, 16L, 9L, 15L, 18L, 3L, 10L, 14L, 
19L, 18L, 3L, 1L, 13L, 7L, 12L, 9L, 6L, 5L, 6L, 9L, 14L, 11L, 
16L, 10L, 3L, 19L, 11L, 9L, 14L, 1L, 7L, 19L, 7L, 3L, 7L, 5L, 
2L, 9L, 2L, 10L, 11L, 7L, 5L, 7L, 16L, 14L, 7L, 6L, 3L, 7L, 7L, 
14L, 3L, 7L, 4L, 10L, 17L, 10L, 19L, 9L, 8L, 9L, 1L, 14L, 8L, 
14L, 10L, 13L, 4L, 9L, 19L, 7L, 5L, 4L, 10L, 6L, 9L, 19L, 19L, 
14L, 19L, 15L, 14L, 17L, 6L, 1L, 1L, 10L, 7L, 1L, 11L, 19L, 16L, 
19L, 14L, 16L, 10L, 11L, 6L, 15L, 9L, 10L, 10L, 16L, 9L, 14L, 
14L, 7L, 15L, 5L, 1L, 7L, 5L, 2L, 10L, 2L, 19L, 11L, 7L, 11L, 
7L, 10L, 19L, 15L, 11L, 11L, 5L, 16L, 7L, 4L, 10L, 18L, 1L, 19L, 
10L, 11L, 9L, 19L, 12L, 14L, 14L, 11L, 14L, 4L, 6L, 3L, 16L, 
1L, 1L, 10L, 17L, 5L, 5L, 10L, 1L, 4L, 1L, 5L, 15L, 15L, 13L, 
4L, 14L, 2L, 11L, 4L, 17L, 7L, 11L, 1L, 1L, 15L, 1L, 10L, 11L, 
4L, 18L, 18L, 1L, 9L, 12L, 7L, 19L, 11L, 14L, 16L, 4L, 4L, 10L, 
11L, 16L, 9L, 11L, 16L, 1L, 18L, 2L, 2L, 10L, 1L, 2L, 11L, 18L, 
8L, 14L, 4L, 19L, 15L, 11L, 6L, 14L, 4L, 1L, 6L, 1L, 2L, 13L, 
11L, 6L, 19L, 1L, 6L, 1L, 17L, 6L, 19L, 10L, 15L, 4L, 6L, 5L, 
2L, 2L, 1L, 6L, 18L, 4L, 5L, 12L, 17L, 5L, 8L, 2L, 3L, 4L, 14L, 
5L, 13L, 3L, 2L, 5L, 13L, 8L, 8L, 7L, 4L, 7L, 5L, 15L, 13L, 3L, 
1L, 6L, 4L, 13L, 4L, 4L, 9L, 13L, 15L, 15L, 9L, 13L, 7L, 5L, 
8L, 1L, 2L, 5L, 15L, 2L, 5L, 2L, 14L, 1L, 16L, 2L, 7L, 8L, 4L, 
9L, 6L, 9L, 6L, 19L, 1L, 19L, 13L, 10L, 6L, 6L, 16L, 10L, 16L, 
6L, 8L, 11L, 2L, 16L, 9L, 15L, 18L, 3L, 10L, 14L, 19L, 18L, 3L, 
1L, 13L, 7L, 12L, 9L, 6L, 5L, 6L, 9L, 14L, 11L, 16L, 10L, 3L, 
19L, 11L, 9L, 14L, 1L, 7L, 19L, 7L, 3L, 7L, 5L, 2L, 9L, 2L, 10L, 
11L, 7L, 5L, 7L, 16L, 14L, 7L, 6L, 3L, 7L, 7L, 14L, 3L, 7L, 4L, 
10L, 17L, 10L, 19L, 9L, 8L, 9L, 1L, 14L, 8L, 14L, 10L, 13L, 4L, 
9L, 19L, 7L, 5L, 4L, 10L, 6L, 9L, 19L, 19L, 14L, 19L, 15L, 14L, 
17L, 6L, 1L, 1L, 10L, 7L, 1L, 11L, 19L, 16L, 19L, 14L, 16L, 10L, 
11L, 6L, 15L, 9L, 10L, 10L, 16L, 9L, 14L, 14L, 7L, 15L, 5L, 1L, 
7L, 5L, 2L, 10L, 2L, 19L, 11L, 7L, 11L, 7L, 10L, 19L, 15L, 11L, 
11L, 5L, 16L, 7L, 4L, 10L, 18L, 1L, 19L, 10L, 11L, 9L, 19L, 12L, 
14L, 14L, 11L, 14L, 4L, 6L, 3L, 16L, 1L, 1L, 10L, 17L, 5L, 5L, 
10L, 1L, 4L, 1L, 5L, 15L, 15L, 13L, 4L, 14L, 2L, 11L, 4L, 17L, 
7L, 11L, 1L), .Label = c("ALA", "ARG", "ASN", "ASP", "GLN", "GLU", 
"GLY", "HIS", "ILE", "LEU", "LYS", "MET", "PHE", "PRO", "SER", 
"THR", "TRP", "TYR", "VAL"), class = "factor"), Energy_Profile = c(-0.017, 
-0.018, -0.02, -0.021, -0.022, -0.024, -0.026, -0.027, -0.028, 
-0.028, -0.028, -0.026, -0.025, -0.024, -0.022, -0.021, -0.02, 
-0.02, -0.021, -0.022, -0.023, -0.024, -0.024, -0.026, -0.026, 
-0.025, -0.024, -0.023, -0.023, -0.022, -0.021, -0.02, -0.02, 
-0.02, -0.019, -0.018, -0.019, -0.019, -0.02, -0.02, -0.022, 
-0.023, -0.024, -0.025, -0.026, -0.027, -0.027, -0.026, -0.026, 
-0.027, -0.027, -0.027, -0.027, -0.026, -0.026, -0.025, -0.024, 
-0.022, -0.021, -0.021, -0.02, -0.02, -0.021, -0.023, -0.024, 
-0.025, -0.026, -0.027, -0.028, -0.028, -0.028, -0.027, -0.027, 
-0.027, -0.027, -0.027, -0.026, -0.026, -0.026, -0.025, -0.025, 
-0.024, -0.024, -0.024, -0.024, -0.024, -0.025, -0.026, -0.027, 
-0.028, -0.028, -0.028, -0.028, -0.028, -0.027, -0.026, -0.025, 
-0.026, -0.026, -0.025, -0.026, -0.027, -0.027, -0.027, -0.025, 
-0.024, -0.023, -0.022, -0.02, -0.019, -0.018, -0.019, -0.019, 
-0.02, -0.021, -0.022, -0.023, -0.024, -0.025, -0.027, -0.029, 
-0.031, -0.034, -0.035, -0.035, -0.035, -0.034, -0.032, -0.03, 
-0.026, -0.024, -0.023, -0.022, -0.022, -0.023, -0.024, -0.027, 
-0.029, -0.032, -0.035, -0.036, -0.037, -0.037, -0.037, -0.036, 
-0.035, -0.033, -0.032, -0.032, -0.031, -0.031, -0.032, -0.033, 
-0.034, -0.036, -0.038, -0.04, -0.041, -0.042, -0.044, -0.045, 
-0.044, -0.043, -0.041, -0.04, -0.037, -0.035, -0.032, -0.031, 
-0.029, -0.029, -0.029, -0.029, -0.03, -0.031, -0.031, -0.031, 
-0.031, -0.029, -0.027, -0.025, -0.023, -0.021, -0.019, -0.018, 
-0.017, -0.018, -0.019, -0.023, -0.026, -0.031, -0.036, -0.04, 
-0.043, -0.045, -0.044, -0.043, -0.039, -0.037, -0.033, -0.03, 
-0.028, -0.027, -0.027, -0.026, -0.025, -0.025, -0.025, -0.024, 
-0.023, -0.023, -0.024, -0.025, -0.026, -0.028, -0.029, -0.029, 
-0.029, -0.029, -0.029, -0.029, -0.028, -0.029, -0.031, -0.033, 
-0.034, -0.036, -0.037, -0.039, -0.039, -0.039, -0.038, -0.037, 
-0.036, -0.035, -0.033, -0.033, -0.032, -0.031, -0.03, -0.029, 
-0.028, -0.027, -0.025, -0.023, -0.022, -0.021, -0.02, -0.019, 
-0.019, -0.018, -0.019, -0.018, -0.018, -0.017, -0.017, -0.016, 
-0.015, -0.014, -0.013, -0.012, -0.011, -0.011, -0.013, -0.014, 
-0.017, -0.02, -0.024, -0.027, -0.03, -0.031, -0.032, -0.03, 
-0.029, -0.027, -0.025, -0.023, -0.021, -0.021, -0.022, -0.023, 
-0.025, -0.026, -0.028, -0.031, -0.033, -0.035, -0.035, -0.035, 
-0.036, -0.036, -0.034, -0.033, -0.031, -0.028, -0.025, -0.023, 
-0.021, -0.019, -0.017, -0.015, -0.014, -0.013, -0.012, -0.011, 
-0.011, -0.011, -0.012, -0.013, -0.016, -0.018, -0.02, -0.022, 
-0.024, -0.026, -0.027, -0.027, -0.026, -0.025, -0.024, -0.023, 
-0.022, -0.021, -0.02, -0.021, -0.022, -0.023, -0.024, -0.024, 
-0.024, -0.025, -0.025, -0.023, -0.022, -0.021, -0.021, -0.02, 
-0.018, -0.018, -0.018, -0.017, -0.016, -0.016, -0.016, -0.016, 
-0.016, -0.017, -0.019, -0.02, -0.021, -0.023, -0.024, -0.026, 
-0.027, -0.027, -0.027, -0.028, -0.028, -0.028, -0.028, -0.027, 
-0.026, -0.025, -0.023, -0.022, -0.02, -0.02, -0.02, -0.02, -0.021, 
-0.022, -0.023, -0.025, -0.025, -0.026, -0.026, -0.026, -0.026, 
-0.025, -0.025, -0.025, -0.025, -0.025, -0.025, -0.025, -0.025, 
-0.025, -0.025, -0.024, -0.024, -0.024, -0.024, -0.025, -0.025, 
-0.026, -0.027, -0.028, -0.028, -0.028, -0.028, -0.027, -0.027, 
-0.025, -0.025, -0.026, -0.026, -0.025, -0.026, -0.027, -0.027, 
-0.027, -0.025, -0.024, -0.023, -0.022, -0.02, -0.019, -0.018, 
-0.019, -0.019, -0.02, -0.021, -0.022, -0.023, -0.024, -0.025, 
-0.027, -0.029, -0.031, -0.034, -0.035, -0.036, -0.035, -0.034, 
-0.032, -0.03, -0.027, -0.025, -0.024, -0.023, -0.023, -0.024, 
-0.025, -0.027, -0.03, -0.032, -0.035, -0.036, -0.037, -0.037, 
-0.037, -0.036, -0.035, -0.033, -0.032, -0.032, -0.031, -0.031, 
-0.032, -0.033, -0.034, -0.036, -0.038, -0.04, -0.041, -0.042, 
-0.044, -0.044, -0.044, -0.043, -0.041, -0.039, -0.037, -0.034, 
-0.031, -0.03, -0.029, -0.028, -0.029, -0.029, -0.03, -0.031, 
-0.031, -0.032, -0.031, -0.029, -0.027, -0.025, -0.023, -0.021, 
-0.019, -0.018, -0.017, -0.018, -0.019, -0.023, -0.026, -0.031, 
-0.036, -0.04, -0.043, -0.045, -0.044, -0.043, -0.039, -0.037, 
-0.033, -0.03, -0.028, -0.027, -0.026, -0.026, -0.025, -0.025, 
-0.024, -0.023, -0.023, -0.024, -0.026, -0.027, -0.029, -0.03, 
-0.031, -0.031, -0.031, -0.03, -0.03, -0.029, -0.028, -0.029, 
-0.029, -0.031, -0.033, -0.035, -0.036, -0.039, -0.039, -0.04, 
-0.039, -0.039, -0.038, -0.037, -0.037, -0.036, -0.036, -0.035, 
-0.034, -0.032, -0.031, -0.028, -0.026, -0.024, -0.023, -0.022, 
-0.022, -0.021, -0.022, -0.022, -0.022, -0.022, -0.022, -0.021, 
-0.021, -0.02, -0.019, -0.018, -0.017, -0.015, -0.014, -0.014, 
-0.015, -0.017, -0.02, -0.023, -0.026, -0.029, -0.032, -0.033, 
-0.033, -0.031, -0.03, -0.029, -0.027, -0.025, -0.023, -0.023, 
-0.024, -0.025, -0.027, -0.029, -0.032, -0.034, -0.037, -0.039, 
-0.04, -0.041, -0.041, -0.04, -0.039, -0.036, -0.033, -0.03, 
-0.026, -0.023, -0.021, -0.019, -0.017, -0.016, -0.015, -0.015, 
-0.014, -0.014, -0.013, -0.013)), .Names = c("Model", "AA_Number", 
"AA", "Energy_Profile"), row.names = c(NA, 614L), class = "data.frame") 
```

`df_templates`：

```
structure(list(Model = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L), .Label = c("2kqx_renumberedA", 
"2kqx_renumberedB", "3lz8_renumbered"), class = "factor"), AA_Number = c(3L, 
4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 
18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, 28L, 29L, 30L, 
31L, 32L, 33L, 34L, 35L, 36L, 37L, 38L, 39L, 40L, 41L, 42L, 43L, 
44L, 45L, 46L, 47L, 48L, 49L, 50L, 51L, 52L, 53L, 54L, 55L, 56L, 
57L, 58L, 59L, 60L, 61L, 62L, 63L, 64L, 65L, 66L, 67L, 68L, 69L, 
70L, 71L, 72L, 73L, 310L, 311L, 312L, 313L, 314L, 315L, 316L, 
317L, 318L, 319L, 320L, 321L, 322L, 323L, 324L, 325L, 326L, 327L, 
328L, 329L, 330L, 331L, 332L, 333L, 334L, 335L, 336L, 337L, 338L, 
339L, 340L, 341L, 342L, 343L, 344L, 345L, 346L, 347L, 348L, 349L, 
350L, 351L, 352L, 353L, 354L, 355L, 356L, 357L, 358L, 359L, 360L, 
361L, 362L, 363L, 364L, 365L, 366L, 367L, 368L, 369L, 370L, 371L, 
372L, 373L, 374L, 375L, 376L, 377L, 378L, 379L, 380L, 115L, 116L, 
117L, 118L, 119L, 120L, 121L, 122L, 123L, 124L, 125L, 126L, 127L, 
128L, 129L, 130L, 131L, 132L, 133L, 134L, 135L, 136L, 137L, 138L, 
139L, 140L, 141L, 142L, 143L, 144L, 145L, 146L, 147L, 148L, 149L, 
150L, 148L, 150L, 151L, 153L, 154L, 155L, 156L, 157L, 158L, 159L, 
160L, 161L, 162L, 163L, 164L, 165L, 166L, 167L, 168L, 169L, 170L, 
171L, 172L, 173L, 174L, 175L, 176L, 177L, 178L, 179L, 178L, 180L, 
181L, 182L, 183L, 187L, 188L, 189L, 190L, 191L, 192L, 193L, 194L, 
195L, 196L, 197L, 198L, 199L, 200L, 201L, 202L, 203L, 204L, 205L, 
206L, 207L, 208L, 209L, 210L, 211L, 212L, 213L, 214L, 215L, 216L, 
217L, 218L, 219L, 220L, 221L, 219L, 221L, 222L, 223L, 224L, 225L, 
226L, 227L, 228L, 229L, 230L, 231L, 232L, 233L, 234L, 235L, 236L, 
237L, 238L, 239L, 240L, 241L, 242L, 243L, 244L, 245L, 246L, 247L, 
248L, 249L, 250L, 251L, 252L, 253L, 254L, 255L, 256L, 257L, 258L, 
259L, 260L, 261L, 262L, 263L, 264L, 265L, 266L, 267L, 268L, 269L, 
270L, 271L, 272L, 273L, 274L, 275L, 276L, 277L, 278L, 279L, 278L, 
280L, 281L, 282L, 283L, 284L, 285L, 286L, 287L, 288L, 289L, 290L, 
291L, 292L, 293L, 294L, 295L, 296L, 297L, 298L, 299L, 300L, 301L, 
302L, 303L, 301L, 303L, 304L, 422L, 423L, 424L, 425L, 426L, 427L, 
428L, 429L, 430L, 431L, 432L, 433L, 434L, 435L, 436L, 437L, 438L, 
439L, 440L, 441L, 442L, 443L, 444L, 445L, 446L, 447L, 448L, 449L, 
450L, 451L, 452L, 453L, 454L, 455L, 456L, 457L, 458L, 459L, 460L, 
151L, 461L, 462L, 463L, 464L, 465L, 466L, 467L, 158L, 467L, 468L, 
469L, 470L, 471L, 472L, 473L, 474L, 475L, 476L, 477L, 478L, 479L, 
480L, 481L, 482L, 483L, 484L, 485L, 176L, 485L, 486L, 487L, 488L, 
489L, 490L, 491L, 492L, 493L, 495L, 496L, 497L, 498L, 499L, 500L, 
501L, 502L, 503L, 504L, 505L, 506L, 507L, 508L, 509L, 510L, 511L, 
512L, 513L, 204L, 513L, 514L, 515L, 516L, 517L, 518L, 519L, 520L, 
521L, 522L, 523L, 524L, 525L, 526L, 527L, 528L, 529L, 530L, 531L, 
532L, 533L, 534L, 535L, 536L, 537L, 538L, 539L, 230L, 539L, 540L, 
541L, 542L, 543L, 544L, 545L, 546L, 547L, 548L, 549L, 550L, 551L, 
552L, 553L, 554L, 555L, 556L, 557L, 558L, 559L, 560L, 561L, 562L, 
563L, 564L, 565L, 566L, 567L, 568L, 571L, 572L, 573L, 574L, 575L, 
576L, 577L, 578L, 579L, 580L, 581L, 582L, 583L, 584L, 585L, 586L, 
587L, 588L, 589L, 590L, 591L, 592L, 593L, 594L, 595L, 596L, 597L, 
598L, 599L, 600L, 601L, 602L, 603L, 604L, 605L, 606L, 607L, 608L, 
609L, 610L, 611L), AA = structure(c(6L, 10L, 11L, 4L, 18L, 18L, 
1L, 9L, 12L, 7L, 19L, 11L, 14L, 16L, 4L, 4L, 10L, 11L, 16L, 9L, 
11L, 16L, 1L, 18L, 2L, 2L, 10L, 1L, 2L, 11L, 18L, 8L, 14L, 4L, 
19L, 15L, 11L, 6L, 14L, 4L, 1L, 6L, 1L, 2L, 13L, 11L, 6L, 19L, 
1L, 6L, 1L, 17L, 6L, 19L, 10L, 15L, 4L, 6L, 5L, 2L, 2L, 1L, 6L, 
18L, 4L, 5L, 12L, 17L, 5L, 8L, 2L, 6L, 10L, 11L, 4L, 18L, 18L, 
1L, 9L, 12L, 7L, 19L, 11L, 14L, 16L, 4L, 4L, 10L, 11L, 16L, 9L, 
11L, 16L, 1L, 18L, 2L, 2L, 10L, 1L, 2L, 11L, 18L, 8L, 14L, 4L, 
19L, 15L, 11L, 6L, 14L, 4L, 1L, 6L, 1L, 2L, 13L, 11L, 6L, 19L, 
1L, 6L, 1L, 17L, 6L, 19L, 10L, 15L, 4L, 6L, 5L, 2L, 2L, 1L, 6L, 
18L, 4L, 5L, 12L, 17L, 5L, 8L, 2L, 1L, 1L, 2L, 7L, 8L, 4L, 10L, 
6L, 9L, 6L, 19L, 1L, 19L, 13L, 10L, 6L, 6L, 16L, 10L, 1L, 6L, 
5L, 16L, 2L, 16L, 9L, 15L, 18L, 3L, 10L, 14L, 19L, 18L, 3L, 19L, 
13L, 13L, 13L, 7L, 9L, 6L, 15L, 6L, 16L, 14L, 11L, 16L, 10L, 
3L, 19L, 11L, 9L, 14L, 1L, 7L, 19L, 19L, 4L, 7L, 5L, 2L, 9L, 
2L, 10L, 11L, 7L, 5L, 5L, 7L, 16L, 14L, 7L, 7L, 14L, 3L, 7L, 
4L, 10L, 17L, 10L, 19L, 9L, 8L, 9L, 1L, 14L, 8L, 14L, 10L, 13L, 
4L, 9L, 19L, 7L, 8L, 3L, 10L, 6L, 9L, 19L, 10L, 14L, 10L, 1L, 
14L, 17L, 17L, 17L, 6L, 1L, 1L, 10L, 7L, 1L, 11L, 19L, 16L, 19L, 
14L, 16L, 10L, 11L, 6L, 15L, 9L, 10L, 10L, 16L, 19L, 14L, 14L, 
7L, 15L, 5L, 1L, 7L, 5L, 2L, 10L, 2L, 9L, 11L, 7L, 11L, 7L, 10L, 
19L, 15L, 11L, 16L, 8L, 16L, 7L, 4L, 10L, 13L, 1L, 19L, 9L, 11L, 
9L, 19L, 12L, 14L, 16L, 11L, 14L, 14L, 4L, 6L, 11L, 1L, 2L, 6L, 
10L, 17L, 5L, 5L, 10L, 1L, 1L, 1L, 6L, 1L, 15L, 13L, 4L, 14L, 
2L, 11L, 16L, 16L, 16L, 17L, 1L, 1L, 2L, 7L, 8L, 4L, 10L, 6L, 
9L, 6L, 19L, 1L, 19L, 13L, 10L, 6L, 6L, 16L, 10L, 1L, 6L, 5L, 
16L, 2L, 16L, 9L, 15L, 18L, 3L, 10L, 14L, 19L, 18L, 3L, 19L, 
13L, 7L, 12L, 9L, 9L, 6L, 15L, 6L, 16L, 14L, 11L, 16L, 16L, 16L, 
10L, 3L, 19L, 11L, 9L, 14L, 1L, 7L, 19L, 19L, 4L, 7L, 5L, 2L, 
9L, 2L, 10L, 11L, 11L, 11L, 7L, 5L, 7L, 16L, 14L, 7L, 6L, 3L, 
7L, 14L, 3L, 7L, 4L, 10L, 17L, 10L, 19L, 9L, 8L, 9L, 1L, 14L, 
8L, 14L, 10L, 13L, 4L, 4L, 4L, 9L, 19L, 7L, 8L, 3L, 10L, 6L, 
9L, 19L, 10L, 14L, 10L, 1L, 14L, 17L, 6L, 1L, 1L, 10L, 7L, 1L, 
11L, 19L, 16L, 19L, 14L, 14L, 14L, 16L, 10L, 11L, 6L, 15L, 9L, 
10L, 10L, 16L, 19L, 14L, 14L, 7L, 15L, 5L, 1L, 7L, 5L, 2L, 10L, 
2L, 9L, 11L, 7L, 11L, 7L, 10L, 19L, 15L, 8L, 16L, 7L, 4L, 10L, 
13L, 1L, 19L, 9L, 11L, 9L, 19L, 12L, 14L, 16L, 11L, 14L, 4L, 
6L, 11L, 1L, 2L, 6L, 10L, 17L, 5L, 5L, 10L, 1L, 1L, 1L, 6L, 1L, 
15L, 13L, 4L, 14L, 2L, 11L, 16L, 17L), .Label = c("ALA", "ARG", 
"ASN", "ASP", "GLN", "GLU", "GLY", "HIS", "ILE", "LEU", "LYS", 
"MET", "PHE", "PRO", "SER", "THR", "TRP", "TYR", "VAL"), class = "factor"), 
    Energy_Profile = c(-0.018, -0.019, -0.019, -0.02, -0.022, 
    -0.023, -0.024, -0.025, -0.025, -0.025, -0.025, -0.025, -0.025, 
    -0.026, -0.025, -0.026, -0.028, -0.029, -0.029, -0.027, -0.026, 
    -0.026, -0.026, -0.025, -0.023, -0.023, -0.024, -0.025, -0.025, 
    -0.024, -0.025, -0.025, -0.026, -0.025, -0.024, -0.024, -0.024, 
    -0.023, -0.024, -0.025, -0.025, -0.027, -0.028, -0.029, -0.029, 
    -0.029, -0.028, -0.027, -0.025, -0.023, -0.022, -0.022, -0.022, 
    -0.023, -0.024, -0.025, -0.027, -0.028, -0.029, -0.03, -0.03, 
    -0.032, -0.032, -0.033, -0.033, -0.033, -0.033, -0.033, -0.032, 
    -0.031, -0.029, -0.018, -0.019, -0.019, -0.02, -0.022, -0.023, 
    -0.024, -0.025, -0.025, -0.025, -0.025, -0.025, -0.025, -0.026, 
    -0.025, -0.026, -0.028, -0.029, -0.029, -0.027, -0.026, -0.026, 
    -0.026, -0.025, -0.023, -0.023, -0.024, -0.025, -0.025, -0.024, 
    -0.025, -0.025, -0.026, -0.025, -0.024, -0.024, -0.024, -0.023, 
    -0.024, -0.025, -0.025, -0.027, -0.028, -0.029, -0.029, -0.029, 
    -0.028, -0.027, -0.025, -0.023, -0.022, -0.022, -0.022, -0.023, 
    -0.024, -0.025, -0.027, -0.028, -0.029, -0.03, -0.03, -0.032, 
    -0.032, -0.033, -0.033, -0.033, -0.033, -0.033, -0.032, -0.031, 
    -0.029, -0.015, -0.019, -0.023, -0.026, -0.029, -0.032, -0.037, 
    -0.04, -0.044, -0.046, -0.047, -0.046, -0.046, -0.044, -0.042, 
    -0.039, -0.038, -0.037, -0.037, -0.038, -0.038, -0.039, -0.041, 
    -0.042, -0.043, -0.044, -0.044, -0.045, -0.045, -0.043, -0.035, 
    -0.024, -0.01, 0.0021, 0.014, 0.027, 0.037, 0.035, 0.026, 
    0.015, 0.0039, -0.008, -0.021, -0.032, -0.039, -0.042, -0.045, 
    -0.048, -0.049, -0.05, -0.049, -0.048, -0.046, -0.043, -0.04, 
    -0.039, -0.037, -0.036, -0.037, -0.037, -0.037, -0.035, -0.032, 
    -0.028, -0.024, -0.019, -0.012, -0.0097, -0.011, -0.013, 
    -0.014, -0.017, -0.023, -0.03, -0.035, -0.04, -0.044, -0.049, 
    -0.053, -0.055, -0.055, -0.053, -0.05, -0.048, -0.045, -0.043, 
    -0.041, -0.04, -0.041, -0.041, -0.041, -0.041, -0.042, -0.042, 
    -0.043, -0.044, -0.046, -0.047, -0.048, -0.049, -0.047, -0.042, 
    -0.038, -0.032, -0.027, -0.021, -0.015, -0.012, -0.011, -0.012, 
    -0.013, -0.015, -0.018, -0.024, -0.029, -0.034, -0.037, -0.04, 
    -0.043, -0.044, -0.045, -0.044, -0.045, -0.045, -0.045, -0.045, 
    -0.045, -0.043, -0.041, -0.039, -0.036, -0.034, -0.033, -0.033, 
    -0.034, -0.035, -0.036, -0.038, -0.039, -0.039, -0.04, -0.039, 
    -0.039, -0.039, -0.039, -0.04, -0.04, -0.039, -0.04, -0.041, 
    -0.042, -0.043, -0.044, -0.046, -0.048, -0.049, -0.05, -0.05, 
    -0.049, -0.046, -0.043, -0.037, -0.031, -0.025, -0.021, -0.017, 
    -0.015, -0.016, -0.021, -0.028, -0.034, -0.039, -0.044, -0.049, 
    -0.051, -0.049, -0.047, -0.045, -0.043, -0.04, -0.038, -0.036, 
    -0.035, -0.035, -0.033, -0.03, -0.026, -0.022, -0.017, -0.012, 
    -0.0058, -0.002, -0.0018, -0.0043, -0.0073, -0.012, -0.017, 
    -0.023, -0.029, -0.034, -0.038, -0.041, -0.044, -0.046, -0.047, 
    -0.046, -0.045, -0.043, -0.041, -0.038, -0.036, -0.034, -0.034, 
    -0.035, -0.035, -0.037, -0.039, -0.041, -0.043, -0.045, -0.046, 
    -0.047, -0.048, -0.05, -0.052, -0.054, -0.054, -0.051, -0.044, 
    -0.037, -0.027, -0.017, -0.0058, 0.0041, 0.0065, 0.0052, 
    0.0053, 0.0048, 0.0059, 0.0058, 0.0057, 0.0074, 0.007, 0.0014, 
    -0.0049, -0.015, -0.023, -0.031, -0.037, -0.04, -0.039, -0.039, 
    -0.037, -0.036, -0.034, -0.029, -0.023, -0.017, -0.009, -0.0017, 
    0.007, 0.011, 0.01, 0.0045, -0.0012, -0.0089, -0.017, -0.025, 
    -0.031, -0.033, -0.034, -0.035, -0.036, -0.038, -0.04, -0.042, 
    -0.046, -0.049, -0.052, -0.052, -0.051, -0.049, -0.046, -0.042, 
    -0.035, -0.027, -0.019, -0.013, -0.0065, -6.1e-05, 0.0045, 
    0.003, -0.0013, -0.0071, -0.014, -0.021, -0.029, -0.036, 
    -0.041, -0.044, -0.046, -0.046, -0.045, -0.044, -0.043, -0.041, 
    -0.039, -0.038, -0.038, -0.038, -0.039, -0.039, -0.038, -0.034, 
    -0.03, -0.025, -0.02, -0.013, -0.0082, -0.008, -0.011, -0.016, 
    -0.021, -0.028, -0.034, -0.04, -0.042, -0.043, -0.041, -0.04, 
    -0.038, -0.035, -0.033, -0.032, -0.032, -0.033, -0.034, -0.035, 
    -0.037, -0.038, -0.038, -0.039, -0.038, -0.038, -0.037, -0.037, 
    -0.036, -0.037, -0.036, -0.037, -0.039, -0.041, -0.043, -0.045, 
    -0.046, -0.048, -0.048, -0.047, -0.045, -0.043, -0.04, -0.038, 
    -0.037, -0.036, -0.037, -0.039, -0.041, -0.043, -0.046, -0.047, 
    -0.048, -0.048, -0.048, -0.046, -0.042, -0.04, -0.038, -0.036, 
    -0.033, -0.032, -0.031, -0.032, -0.032, -0.033, -0.034, -0.035, 
    -0.036, -0.037, -0.038, -0.039)), .Names = c("Model", "AA_Number", 
"AA", "Energy_Profile"), class = "data.frame", row.names = c(NA, 
-532L)) 
```

在我`df_test`在这里提供的数据中，当我达到字符限制时，我只能放置一个情节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:27:43.690

您的数据框`df_templates`也是多面的，因为它具有与`Model`中给出的相同的列`facet_wrap()`。例如，如果将此列重命名为`Model2`

```
colnames(df_templates)<-c("AA_Number","AA","Energy_Profile","Model2") 
```

那么这个数据框没有刻面。

```
ggplot(df_test, aes(x=AA_Number,y=Energy_Profile,col='red')) + geom_line()  + 
  geom_hline(yintercept=-0.03, colour='blue') + 
   geom_line(data=df_templates,colour="green")+
  facet_wrap(~Model,ncol=3) 
```

![在此处输入图像描述](../Images/7aba0022aceca63d87a62a43113ada69.png)

# javascript - AngularJS 忽略 HTTP 标头中的 Set-Cookie

> ID：15026016
> 
> 赞同：67
> 
> 时间：2013-02-22T14:07:25.730
> 
> 标签：javascript, angularjs, cookies, setcookie

我正在开发一个基于客户端的 AngularJS 和服务器端的 API（Tomcat + Jersey for WS）的应用程序。

我的 API 的某些路径受到限制，如果用户没有会话，则返回的响应状态为 401。在客户端，拦截 401 http 状态以将用户重定向到登录页面。

用户通过身份验证后，我在服务器端创建一个会话

```
httpRequest.getSession(true);
```

并且发送给客户端的响应在其标头中确实包含 Set-cookie 指令：

```
设置 Cookie：JSESSIONID=XXXXXXXXXXXXXXXXXXXXX；域=本地主机；路径=/api/; HttpOnly

```

问题是cookie永远不会放在客户端。当我检查 localhost 域的 cookie 时，它​​是空的，因此下一个请求的标头中没有这个 cookie，客户端仍然无法访问我的 API 的受限路径。

客户端和服务器在同一个域中，但它们没有相同的路径和相同的端口号：

客户 ：`http://localhost:8000/app/index.html`

服务器 ：`http://localhost:8080/api/restricted/`

附加信息：双方都启用了 CORS：

```
“访问控制允许方法”、“GET、POST、OPTIONS”
“访问控制允许来源”，“*”
“访问控制允许凭据”，真
```

使 Set-cookie 正常工作的任何想法？它是 AngularJS 相关的问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-25T16:43:59.093

I found an [issue in AngularJS](https://github.com/angular/angular.js/pull/1209) that help me to move forward.

It seems that `"Access-Control-Allow-Credentials" : true` was not set on the client side. Instruction `$httpProvider.defaults.withCredentials = true` was ignored.

I replace $resource call by a simple $http call with {withCredentials:true} in the config parameter.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-10-31T10:55:56.897

我已经设法解决了一个与您的问题非常相似的问题。我的游戏！后端尝试设置我无法在 Angular 中捕获或通过浏览器存储的会话 Cookie。

实际上，解决方案涉及到这个和那个。

假设您已经解决了最初的问题，只能通过将特定域添加到 Access-Control-Allow-Origin 并删除通配符来解决，接下来的步骤是：

1.  您必须从`Set-Cookie`标头中删除 HTTP-Only，否则您将永远无法接收由您的角度代码“生成”的 cookie
    **此设置已在 Firefox 中有效，但在 Chrome 中无效**

2.  要使其也适用于 Chrome，您需要：

    a) 使用您的 WS “托管”的域，在 cookie 中从 localhost 发送不同的域。你甚至可以使用通配符`.domain.com`代替`ws.domain.com`

    b) 然后您需要调用您在 cookie 中指定的域，否则 Chrome 将不会存储您的 cookie

    [可选] 我会删除该`/api`路径以支持`/`

这应该是诀窍。
希望能有所帮助

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-11-19T14:34:13.253

在客户端的发布请求中，确保添加以下内容：

对于 jquery ajax 请求：

```
$.ajax({
  url: "http://yoururlgoeshere",
  type: "post",
  data: "somedata",
  xhrFields: {
    withCredentials: true
  }
});
```

使用 Angular 的 $http 服务：

```
$http.post("http://yoururlgoeshere", "somedata", {
  withCredentials: true
});
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-06-02T17:39:02.540

您需要在服务器端和客户端工作。

**客户**

通过以下方式之一将`$http`config设置`withCredentials`为：`true`

1.  根据请求

    ```
    var config = {withCredentials: true};
    $http.post(url, config); 
    ```

2.  对于所有请求

    ```
    angular.module("your_module_name").config(['$httpProvider',
      function($httpProvider) {
        $httpProvider.interceptors.push(['$q',
          function($q) {
            return {
              request: function(config) {
                config.withCredentials = true;
                return config;
              }
            };
          }
        ]);
      }
    ]); 
    ```

**服务器**

将响应标头设置`Access-Control-Allow-Credentials`为`true`.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-02-22T14:22:11.873

添加[**HttpOnly**](http://en.wikipedia.org/wiki/HTTP_cookie#HttpOnly_cookie)意味着浏览器不应该让插件和 JavaScript 看到 cookie。这是最近用于更安全浏览的约定。应该用于 J_SESSIONID 但可能不在此处。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-20T20:13:45.957

刚刚解决了这样一个问题。

我正在这样做但没有工作......：

```
 $cookies.put('JSESSIONID', response.data); 
```

Cookies 保存在浏览器中，但是当我发送一个新请求时，所有的 Cookies 都被发送了，除了我的。（我的 cookie 是 JSESSIONID）

然后我查看了 chrome 检查器，我发现了这个： [![我的会话是 JsessionID](../Images/d365bf53d377b3e617e1496b150c16d9.png)](https://i.stack.imgur.com/eYaiC.png)

问题是那不是正确的路径！！！

然后我尝试了这个，我的 cookie 被发送了。耶！：

```
$cookies.put('JSESSIONID', response.data, {'path':'/'}); 
```

我不知道这是否是你的情况，但这对我有用。

问候！

# android - 图形布局不会显示我的按钮背景

> ID：15026019
> 
> 赞同：1
> 
> 时间：2013-02-22T14:07:48.817
> 
> 标签：android, eclipse

我在 res/drawable 目录中自己的“custom_easy_but.xml”中有一个按钮背景，如下所述：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
        <item android:drawable="@drawable/but_easy_p"
    android:state_pressed="true"/>

    <item android:drawable="@drawable/but_easy" />

</selector> 
```

然后我有一个名为 modeselect.xml 的布局，其中包含以下代码：

```
<Button
    android:id="@+id/easy"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginRight="10dp"
    android:background="@drawable/custom_easy_but"
    android:text="@string/Easy" /> 
```

然后我在名为 but_easy.png 和 but_easy_p.png 的文件中有一组不同大小的图像，分别位于 res/drawable-large 和 res/drawable-normal 目录中。该代码在各种手机上编译、运行和显示正确的按钮背景图像......但如果我使用 eclipse 查看文件 modeselect.xml 并切换到“图形布局”视图，我看不到背景图像根本没有，在我看到的图形视图下面

```
failed to parse file c:\blah\blah\res\drawable\custom_easy_but.xml 
```

和

```
couldn't resolve resource @drawable/but_easy_p 
```

真手机怎么能把所有的xml都整理出来，而eclipse却不能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:20:53.813

确保您在图形编辑器中设置了正确的屏幕尺寸。如果您选择了没有资源的屏幕尺寸，则不会显示您的布局。

# javascript - 将图像从移动 Web 应用程序（PhoneGap 和 JavaScript）上传到 SOAP Web 服务返回状态 0

> ID：15026024
> 
> 赞同：3
> 
> 时间：2013-02-22T14:07:57.823
> 
> 标签：javascript, soap, xmlhttprequest

我看过很多例子和论坛，但对我来说还不清楚。我想用手机拍照然后发送到WebService。
在 WebService 中，我有一个`UploadImage`将图像保存在网站中的功能。这个函数的参数是：

```
 <UploadImage xmlns="http://*********">
  <urlSite>http://********</urlSite>
  <iListName>{*************}</iListName>
  <iUpdateMode>*******</iUpdateMode>
  <iMetaData><Fields><Field Name=”Title” >Title of the Image</Field></Fields></iMetaData>
  <iAttachments><Attachments><Attachment Name=”Name of the file”&gt;file in the format Base64String</Attachment></Attachments></iAttachments>
  <iOverWrite>****</iOverWrite>
</UploadImage> 
```

发帖请求：

```
function sendImage ()
{
    var wsUrl = "*******?op=UploadImage";
    var soapRequest ='<?xml version="1.0" encoding="utf-8"?> \
        <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" \
         xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"> \
  <soap:Body> \
    <UploadImage xmlns="**********"> \
      <urlSite>**********</urlSite> \
      <iListName>{******}</iListName> \
      <iUpdateMode>********</iUpdateMode> \
      <iMetaData><Fields><Field Name=”Title” >Title of the Image</Field></Fields></iMetaData>
      <iAttachments><Attachments><Attachment Name=”Name of the file”&gt;file in the format Base64String</Attachment></Attachments></iAttachments> \
      <iOverWrite>*****</iOverWrite> \
    </UploadImage> \
  </soap:Body> \
</soap:Envelope>';
    var xmlhttp =  createXMLHttpRequest();

xmlhttp.open("POST", wsUrl, true,"username","password");

xmlhttp.setRequestHeader ("Post", "********");
xmlhttp.setRequestHeader ("Host", "*****");
xmlhttp.setRequestHeader ("Content-Type", "text/xml; charset=utf-8");
xmlhttp.setRequestHeader("Content-Length", soapRequest.length);
xmlhttp.setRequestHeader ("SOAPAction", "******");

xmlhttp.onerror = function(e) {
    alert("Error ocurred. Error = " + e.message);
}

xmlhttp.ontimeout = function(e) {
    alert("Timeout error!");
}

xmlhttp.onreadystatechange  = function () { 
    alert(xmlhttp.readyState);

    if (xmlhttp.readyState==4)
    {
        alert(xmlhttp.responseText);
        alert(xmlhttp.status);
        // if "OK"
        if (xmlhttp.status==200 || xmlhttp.status==0)
        {
            alert(xmlhttp.responseXML);
        //[Get xmlhttp.responseXML.xml and do something with it]

        }
        else
        {
        //[Get xmlhttp.responseXML.xml and do something with it in the case of an error]
        }
    }
}

xmlhttp.send(soapRequest); 
```

}

状态 t=returned 为 0。
在标签`<iAttachments><Attachments><Attachment Name=”Name of the file”&gt;file in the format Base64String</Attachment></Attachments></iAttachments>`中我应该发送一个 Base64 格式的文件，但是我不知道如何将这种格式的文件放在这个标签中，所以我发送了一个字符串，也许这是一个原因问题！

我试图用 jquery.ajax 发布它：

```
function sendReq()
{    var wsUrl = "*******";
    var soapRequest ='<?xml version="1.0" encoding="utf-8"?>'+
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'+
  '<soap:Body>'+
    '<UpdateImage xmlns="*******">'+
      '<urlSite>*********</urlSite>'+
      '<iListName>{*****}</iListName>'+
      '<iUpdateMode>****</iUpdateMode>'+
      '<iMetaData><Fields><Field Name="Title" >'+my_var1+'</Field></Fields></iMetaData>'+
      '<iAttachments><Attachments><Attachment Name="Nom du fichier 1">'+my_var2+'</Attachment></Attachments></iAttachments>'+
      '<iOverWrite>*****</iOverWrite>'+
    '</UpdateImage>'+
  '</soap:Body>'+
'</soap:Envelope>';
   $.ajax({
                    type: "POST",
                    url: wsUrl,
                    contentType: "text/xml; charset=utf-8",
                    dataType: "xml",
                    data: soapRequest,
                    beforeSend: function (xhr){ 
        xhr.setRequestHeader('Authorization', make_base_auth('username', 'password')); 
        xhr.setRequestHeader("SOAPAction", "****/UpdateImage");
    },                
    contentType: "text/xml; charset=utf-8",

                success: processSuccess,
                error: processError
            });
return false; 
```

}

结果是：`req.responseText=undefined`和`status=error`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T15:39:47.547

我会用一些在线工具（例如[http://www.opinionatedgeek.com/dotnet/tools/base64encode/](http://www.opinionatedgeek.com/dotnet/tools/base64encode/)）对文件进行base64编码，并将字符串硬编码到您的xml中。看看这是否有效，以检查您的其余代码是否正常。

如果可行，请查看此问题，了解如何在发送文件之前对其进行 base64 编码： [Get Base64 encode file-data from Input Form](https://stackoverflow.com/questions/6978156/get-base64-encode-file-data-from-input-form)

此外 - 调试代理在这种情况下非常有用，因此您可以看到正在发送的实际请求。如果您有一些已经可以使用此服务的东西，您可以使用 fiddler ( [http://fiddler2.com/](http://fiddler2.com/) ) 之类的东西来获取请求并将其与您的请求进行比较。

# xml - XSL-FO 测试值

> ID：15026028
> 
> 赞同：3
> 
> 时间：2013-02-22T14:08:10.193
> 
> 标签：xml, xslt, xsl-fo

我有一个 .xml 文件，我想生成一个 .pdf 文件。我使用 xsl-fo 来实现这一点。

问题是我无法请求当前页面的编号，以便将其存储到变量中，而不是根据其值做出不同的事情。

具体：如果当前页面是0模3，那么我需要在页面底部画一个“X”，如果当前页面是1模3，那么我需要在页面底部画一个“Y” ，如果当前页面是 2 模 3，那么我需要在页面的底部绘制“B”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T04:00:35.260

您可以做的最好的事情是`fo:page-sequence-master`为页面位置、奇数页或偶数页（通常用于定义边距）或空白页创建不同的内容。有关详细信息，请参阅 [1]。

如果有帮助，我可以举个例子。但无法查询页码生成内容。

[1] [http://www.w3.org/TR/xsl/#fo_conditional-page-master-reference](http://www.w3.org/TR/xsl/#fo_conditional-page-master-reference)

# vb.net - Visual Studio 在调试中运行程序时抛出虚假异常

> ID：15026031
> 
> 赞同：0
> 
> 时间：2013-02-22T14:08:29.210
> 
> 标签：vb.net, visual-studio-2010

我正在调试 Visual Studio 2010 (10.0.40219.1) (Windows XP 5.1 2600.xpsp-sp3-gdr.120821-1629) 中的 VB.Net 程序，并注意到在调试时它运行非常缓慢。当作为可执行文件（甚至是调试可执行文件）运行时，它会以极快的速度运行。

原因似乎是开发环境正在生成大量异常（出现在即时窗口中）。

> Microsoft.VisualBasic.dll 中出现了“System.ArgumentNullException”类型的第一次机会异常

有谁知道这可能是什么原因？它似乎对程序的运行没有任何不利影响，除了需要很长时间才能找到我试图找到错误的位。该异常似乎与任何特定的代码补丁，实际上大多数其他项目都不会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:16:05.770

我为您找到了类似问题的答案： [第一次机会例外](https://stackoverflow.com/questions/2020374/a-first-chance-exception)

我会特别注意 Marcus Andren 的建议：

> 如果要查明异常发生的位置，可以选择 Debug->Exceptions 菜单项，然后在出现的对话框中，选中“Common Language Runtime Exceptions”的第一个复选框。这将使调试器在发生异常时立即中断，而不是仅在未处理的异常上中断。
> 
> 这也是为什么捕获通用异常通常不是一个好主意的原因之一，除非您清楚地记录捕获的信息。

# jquery - JQuery 可拖动容器

> ID：15026034
> 
> 赞同：0
> 
> 时间：2013-02-22T14:08:48.707
> 
> 标签：jquery, jquery-ui, draggable

如何使元素在整个页面上可拖动。现在它只允许我在父 div 中拖动我的元素。

```
 $(thumb).draggable() 
```

我正在使用这个库：http: [//touchpunch.furf.com/](http://touchpunch.furf.com/)

```
 var thumb = document.createElement("img");
            $(thumb).draggable({containment: "html"});
            thinner.appendChild(thumb); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:12:02.573

This should work:

```
$(thumb).draggable({containment: "body"}); 
```

[Official demo on the *containment* option](http://jqueryui.com/draggable/#constrain-movement)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-22T22:47:23.857

In addition to containment, you may have to use the appendTo option to have your helper appended to the body while you drag it:

```
$(thumb).draggable({containment: "body", appendTo: "body"}); 
```

[http://api.jqueryui.com/draggable/#option-appendTo](http://api.jqueryui.com/draggable/#option-appendTo)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T16:15:09.353

如果要使用`$(thumb).draggable({containment: "body"});`，则必须将其添加到 CSS 中。

```
body{
   overflow: hidden;
} 
```

否则使用：

```
$(thumb).draggable({containment: "html"}); 
```

* * *

演示（无 CSS）：http: [//jsbin.com/ukotit/7/edit](http://jsbin.com/ukotit/7/edit)

演示（使用 CSS）：http: [//jsbin.com/ukotit/5/edit](http://jsbin.com/ukotit/5/edit)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-05T14:51:24.833

尝试`.draggable({containment: "body", scroll: false})`

# javascript - 自定义滚动条在触摸设备上不起作用

> ID：15026036
> 
> 赞同：0
> 
> 时间：2013-02-22T14:08:49.853
> 
> 标签：javascript, jquery, touch

以下问题。我使用了一个简单的 jquery 插件[，](https://github.com/thomd/jquery-scroll/) 到目前为止它工作正常，问题是当我在触摸设备（例如 ipad2）上测试它时，它不可能在 div 内滚动。它也不适用于 2 指滑动！我想这种行为与“标准”滚动条不同。但是有什么解决方案可以让这个可以触摸吗？

我在测试阶段，这意味着主体代码非常简单

```
$(document).ready(function() {

function appenddiv() {
    var $scrolling = $('<div id="test" class="scrolling">A lot of text in here ...<div id="scroll2"><img src="../images/31670035.jpg"></div></div>');

$scrolling.appendTo($('#container')).scrollbar();

}

$('#scrollbar-link').on('click', function() {
    appenddiv();
});
});

<body>
<a href="#" id="scrollbar-link">Klick mich!</a>

<div id="container">
</div>
</body> 
```

我需要像“可触摸”脚本这样可以滑动滚动条的东西吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:24:13.503

:-) 是的，这绝对是一个问题......

根本问题如下：
要创建自定义滚动条，您需要使 DIV 溢出：隐藏 - 隐藏 sys 滚动条。还行吧。但在移动（iPad 也是）设备上，从此时起，您的 DIV 将无法滚动。它将是（仅），如果您使用溢出：自动......这是合乎逻辑的 - 或多或少。但是让您感到头疼 :-)

因此，您必须在这一点上做出选择..

a) 您忘记了触摸设备上的自定义滚动条 - 保持溢出：自动
b) 您手动实现拖放功能 -如果您检测到移动设备

版本 b) 会很棘手 - 再次。因为我们知道的“mousedown”事件在触摸屏上的工作方式不同。不仅有一个 mousedown - 实际上可能有一系列“mousedown”，因为您用手指触摸屏幕，然后用另一根手指触摸屏幕，依此类推......所以在触摸屏上这是一个触摸[] 数组...

绝对有意义，但使事情复杂化...

无论哪种方式，我都不知道任何不太复杂的解决方案...如果有人知道，我也很好奇！:-)

在处理我们的[NiceScrollbars 库](http://www.nicescrollbars.com)项目时，我们进行了大量测试并为这个问题（以及其他问题）付出了很多努力......

如果你想更深入地讨论这个问题，我就在这里！会尽力帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-19T09:30:24.777

> 无论哪种方式，我都不知道任何不太复杂的解决方案......如果有人知道，我也很好奇！:-)

理论上，我们可以添加一个不透明度=0.000000000001的div，z-index -1（原始div的-1索引。即原始div的z-index为10，那么新div的z-index为9）和滚动=自动。新的 div 将是 div 的副本，在内容和 css 方面具有 scroll=hidden 属性。

滚动事件将通过隐藏的 div 触发，然后更新可见的 div。

太糟糕了，我们必须做到这一点，但它似乎是另一个干净的解决方案/hack，除了你必须复制内容或创建一个保持内容高度的元素。

# php - 如何添加到多维数组值

> ID：15026042
> 
> 赞同：1
> 
> 时间：2013-02-22T14:09:20.007
> 
> 标签：php, multidimensional-array

`var_dump($array);`给出：

```
Array
(
    [data] => Array
        (
            [0] => Array
                (
                    [name] => Mark O'Donel
                    [id] => 35802624
                )

            [1] => Array
                (
                    [name] => Da's Messager
                    [id] => 522505962
                )
        )
) 
```

知道如何添加斜线来排列值吗？尝试以下但它不起作用：

```
foreach($array as $list){
    foreach($list as $elt){
       $name = $elt['name'];
       $id = $elt['id'];

       echo 'before: '. $name .'<br><br>'; // Assuming $name= "Mark O'Donel"
       $list[$id] = addslashes($name);
       echo 'after: '. $elt['name'] .'<br><br>'; //suppose to give Mark O\'Donel
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:12:59.660

更改后的值必须分配给数组变量：

```
foreach($array as $list){
    foreach($list as $index=>$elt){
       $name = $elt['name'];
       $id = $elt['id'];

       echo 'before: '. $name .'<br><br>'; // Assuming $name= "Mark O'Donel"
       $list[$index]['name'] = addslashes($name);
       echo 'after: '. $elt['name'] .'<br><br>'; //suppose to give Mark O\'Donel
    }
} 
```

# cocoa - 使用 ScriptBridge 保存 Apple 邮件消息

> ID：15026053
> 
> 赞同：0
> 
> 时间：2013-02-22T14:09:51.783
> 
> 标签：cocoa, osx-mountain-lion, apple-mail

我正在尝试使用 ScriptBridge 从 Apple Mail 中保存选定的电子邮件。

我已经创建了 Mail.h 文件，并且在我的程序中，我已经成功地使用 Apple Mail ScriptBridge 完成了其他事情（比如转发消息等）

这是我当前的代码。我没有收到错误消息并且代码运行良好；只有文件永远不会被创建。

我正在使用 Xcode 4.6。在山狮 10.8.2 上。我的应用程序的部署目标是 10.8。

```
- (void)saveEmail {
    MailApplication *mailApp = [SBApplication applicationWithBundleIdentifier:@"com.apple.Mail"];

    SBElementArray *viewers = [mailApp messageViewers];

    for (MailMessageViewer *viewer in viewers) {

        NSArray *selectedMessages = [viewer selectedMessages];

        @try {
            for (MailMessage *selectedMessage in selectedMessages) {

                NSString *filePath = [NSString stringWithFormat:@"%@%@",@"/Users/patrick/Documents/",@"tmp.rtf"];
                NSURL *fileUrl = [NSURL fileURLWithPath:filePath];

                [selectedMessage saveIn:fileUrl as:MailSaveableFileFormatNativeFormat];
            }
        }
        @catch (NSException *exception) {
            NSLog(@"Exception:%@", exception);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T13:41:26.757

有完全相同的问题。似乎`saveIn`没有在 Mail 中实现。我对此代码有一个解决方法：

```
[message.source writeToURL:mailUrl
                            atomically:YES
                              encoding:NSUTF8StringEncoding
                                 error:nil]; 
```

`message`This的实例在哪里`MailMessage` 似乎在大多数情况下都能正常工作。但有时保存的邮件中的附件是空的。所以如果有人有更好的解决方案......

# c# - 在不同页面上从一个数据网格导航到另一个数据网格

> ID：15026054
> 
> 赞同：1
> 
> 时间：2013-02-22T14:09:55.773
> 
> 标签：c#, wpf, wpf-controls, wpfdatagrid

我的应用程序中有两个页面（使用 NavigationWindow）。当我在 page1 上单击我的 datagrid1 中的一行时，是否可以导航到第 2 页并在 page2 上的 datagrid 2 中填充详细信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:23:12.177

嗨 userXemY 看看[eventtaggregation](http://martinfowler.com/eaaDev/EventAggregator.html)或共享视图模型。

有很多框架使用 eventtaggregation 或其他形式在视图之间进行通信/导航。

喜欢：

*   [Caliburn.Micro](http://caliburnmicro.codeplex.com/wikipage?title=The%20Event%20Aggregator&referringTitle=Documentation)
*   [棱镜 4](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.40%29.aspx)
*   [MVVMLight](http://mvvmlight.codeplex.com/documentation)（我认为）

# mkmapview - 在 MapView 中使用 UIActivityViewController 的旋转问题

> ID：15026057
> 
> 赞同：1
> 
> 时间：2013-02-22T14:10:06.617
> 
> 标签：mkmapview, uipopovercontroller, mkannotation, mkannotationview, uiactivityviewcontroller

在我的 iOS 应用程序中，我有一个称为 Map View 的地图视图`mappa`。
我只是添加了一个 UIActivityViewController，当从注释视图中按下标注时，它会出现。
我使用此代码来显示它：

```
- (void)mapView:(MKMapView *)mapView
 annotationView:(MKAnnotationView *)view
 calloutAccessoryControlTapped:(UIControl *)control {

    [mappa deselectAnnotation:view.annotation animated:YES];

    if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 6.0) {

        UIActivityViewController *activityViewController = [[UIActivityViewController alloc] initWithActivityItems:@[self, [NSURL URLWithString:@"http://www.AppStore.com/iToretto"]]
                                                                                             applicationActivities:nil];

        activityViewController.excludedActivityTypes = @[UIActivityTypePostToWeibo, UIActivityTypeAssignToContact, UIActivityTypeCopyToPasteboard ];

        if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {

            UIPopoverController *pop = [[UIPopoverController alloc] initWithContentViewController:activityViewController];
            self.annotationPopoverController = pop;

            //show the popover next to the annotation view (pin)
            [pop presentPopoverFromRect:view.bounds
                                 inView:view
               permittedArrowDirections:UIPopoverArrowDirectionAny
                               animated:YES];
            self.annotationPopoverController.delegate = self; 
        }
    }
} 
```

我的问题是，当我旋转这个弹出框时，我有一个框架问题（[像这样](https://stackoverflow.com/questions/14659786/popover-frame-issue-in-iphone-sdk)）。我知道解决方案是覆盖：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation 
                                duration:(NSTimeInterval)duration; 
```

但是当我尝试以这种方式在横向模式下显示弹出框时，我遇到了多个错误：

```
if (UIInterfaceOrientationLandscapeLeft && [self.annotationPopoverController isPopoverVisible]) {
    [self.annotationPopoverController presentPopoverFromRect:view.bounds
                                                      inView:view
                                    permittedArrowDirections:UIPopoverArrowDirectionAny 
                                                    animated:YES];
} 
```

因为“view.bounds”和“view”是本地声明`MKAnnotation`

那么，我该如何解决呢？！有没有人有办法解决吗？！提前致谢。

# php - 使用准备好的查询更新/插入不会持久保存到数据库中

> ID：15026058
> 
> 赞同：0
> 
> 时间：2013-02-22T14:10:07.120
> 
> 标签：php, mysqli, prepared-statement

我对 MySQL 准备的查询有一些问题。特别是更新和插入。

```
$mysqliStmt->execute(); 
```

它不会更新或插入表中。它只是提供 stmt 结果。没有错误、警告或其他任何内容。（见下文）

我使用的插入查询：

```
INSERT INTO testdatabase.`test` (`test1`, `test2`) VALUES(?, ?) 
```

更新查询：

```
UPDATE testdatabase.`test` SET `test1` = ? WHERE `id` = ? LIMIT 1 
```

结果信息（更新）：

```
'fieldCount' => 0,
'affectedRows' => 1,
'numRows' => 0,
'paramCount' => 2,
'insertId' => 0,
'sqlstate' => '00000',
'threadId' => 5291,
'errno' => 0,
'error' => '',
'warningCount' => 0,
'warnings' => false
'connectErrno' => 0,
'connectError' => NULL,
'hostInfo' => 'Localhost via UNIX socket',
'protocolVersion' => 10,
'serverInfo' => '5.1.49-3',
'serverVersion' => 50149,
'clientInfo' => '5.0.27',
'clientVersion' => 50027,
'info' => 'Rows matched: 1  Changed: 1  Warnings: 0' 
```

编码：

```
$stmt = self::$_connection->prepare($query);
//binds params -> like/with $stmt::bind_param() but more generic
$this->_bindParameters($stmt) 
$stmt->execute(); 
```

现在更新/插入数据应该存储到数据库中还是我错了？

如果我使用 phpMyAdmin 或 MySQL 控制台来验证查询结果，则数据库表既没有更新，也没有插入新数据。

# azure - 加密 Web.config Windows Azure

> ID：15026059
> 
> 赞同：7
> 
> 时间：2013-02-22T14:10:25.617
> 
> 标签：azure

我正在使用来自 Windows Azure 的共享网站。我想加密我的 web.config 的一部分，但是，我收到了这个错误：

无法使用提供程序“RsaProtectedConfigurationProvider”解密。来自提供程序的错误消息：无法打开 RSA 密钥容器。

我的网站中有一个页面可以加密该文件，并且确实如此，但是，几个小时后我收到了这个错误。我需要将我的机器密钥发送到 Azure 还是他们有一个我可以使用？

要加密我的配置文件，我使用以下代码：

```
 /// <summary>
    /// About view for the website.
    /// </summary>
    /// <returns>Action Result.</returns>
    public ActionResult About()
    {
        Configuration objConfig =
          WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);
        AppSettingsSection objAppsettings =
          (AppSettingsSection)objConfig.GetSection("appSettings");
        if (!objAppsettings.SectionInformation.IsProtected)
        {
            objAppsettings.SectionInformation.ProtectSection(
                           "RsaProtectedConfigurationProvider");
            objAppsettings.SectionInformation.ForceSave = true;
            objConfig.Save(ConfigurationSaveMode.Modified);
        }

        return View();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T18:20:08.863

它可能不是您要查找的内容，但您可以使用 Azure 仪表板中的“配置”选项卡在运行时覆盖 AppSettings，这样 web.config 就不会存储任何实际的敏感数据。

[http://www.windowsazure.com/en-us/manage/services/web-sites/how-to-configure-websites/#howtochangeconfig](http://www.windowsazure.com/en-us/manage/services/web-sites/how-to-configure-websites/#howtochangeconfig)

> 应用程序设置 - 指定将由您的 Web 应用程序在启动时加载的名称/值对。对于 .NET 站点，这些设置将在运行时注入到您的 .NET 配置 AppSettings 中，覆盖现有设置。对于 PHP 和 Node 站点，这些设置将在运行时作为环境变量提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-02T10:31:19.437

我不确定在您提出问题时这是否可用，但是 Microsoft 的一位工程师为 Windows Azure 提出了一个新的 ProtectedConfigurationProvider。这是它的链接：[https](https://code.msdn.microsoft.com/Encrypt-Configuration-5a8e8dfe#content) ://code.msdn.microsoft.com/Encrypt-Configuration-5a8e8dfe#content 。

[他们已经提供了详细的步骤，说明在此处](https://code.msdn.microsoft.com/site/view/file/122365/1/Pkcs12ProtectedConfigurationProvider.htm)应该做什么。

# javascript - Highcharts - 甘特图绘图问题

> ID：15026060
> 
> 赞同：2
> 
> 时间：2013-02-22T14:10:28.347
> 
> 标签：javascript, jquery, highcharts, timeline, gantt-chart

我想绘制类似甘特图并使用[此解决方案](http://jsfiddle.net/highcharts/r6emu/)。只要我不开始使用大间隔，它就像一种魅力。

```
// Define tasks (unixtime * 1000)
var tasks = [{
    name: 'Eat',
    intervals: [{ // From-To pairs
        from: 1360800000000,
        to: 1360886400000
    }, {
        from: 1360368000000,
        to: 1360454400000,
    }, {
        from: 1360195200000,
        to: 1360281600000,
    }, {
        from: 1361059200000,
        to: 1361232000000
    }]
}]; 
```

这是[我的示例](http://jsfiddle.net/DimazzzZ/puZDM/)，基于上面的代码。如果您将鼠标悬停在间隔上，您将看到与预期不太一样：它显示来自其他间隔的错误工具提示。

我的代码有什么问题？可能我应该定义句点格式或类似的东西吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:30:09.217

时间序列数据必须按时间顺序排列。我像这样重新排序了您的列表，并且工具提示符合预期：

```
var tasks = [{
    name: 'Eat',
    intervals: [{
        from: 1360195200000,
        to: 1360281600000,
    },{
        from: 1360368000000,
        to: 1360454400000,
    },{
        from: 1360800000000,
        to: 1360886400000
    }, {
        from: 1361059200000,
        to: 1361232000000
    }]
}]; 
```

# syntax - 如何在 CIL 中声明值类型：`.class value` 或只是 `.class`？

> ID：15026065
> 
> 赞同：4
> 
> 时间：2013-02-22T14:10:53.877
> 
> 标签：syntax, definition, cil, value-type, ilasm

我查看了 ILDASM 中的 C# `struct FooStruct`，[并](http://msdn.microsoft.com/en-us/library/f7dy01k1.aspx)看到了以下内容：

![在此处输入图像描述](../Images/602290c9dc0ae39d1d809668733ed850.png)

ILDASM 在这里显示了两个不同的声明：

*   一个以（后窗和前窗的标题栏）开头`.class` **`value`** `public`
*   一个以`.class public`（前窗）开头

而且我想知道哪种语法（如果不是两者）是声明值类型的正确语法？修饰符是`value`绝对必要的、可选的还是语法错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:10:53.877

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T17:35:18.743

这本[好书](https://rads.stackoverflow.com/amzn/click/com/1590596463)包含简单的答案：当您提供`extends`子句时，`value`标志将被忽略，但如果您不提供 `extends`和使用，`value`则 ilasm 会将给定类型声明为值类型。

换句话说`value`，作为语法糖被引入，以快速声明值类型。

# php - Facebook PHP SDK fails on first page load

> ID：15026074
> 
> 赞同：0
> 
> 时间：2013-02-22T14:11:25.243
> 
> 标签：php, facebook, facebook-php-sdk

The FIRST time my index.php loads I get a value of 0 when calling:

```
$facebook->getUser();//returning 0 instead of id on first page load 
```

The call works fine on any subsequent page load.

This is my code:

```
$facebook = new Facebook(array(
        'appId'  => $FB_APP_ID, 
        'secret' => $FB_APP_SECRET
    ));
$user_id = $facebook->getUser();//Returns 0 on first load. 
```

Has anyone else experienced this? Maybe I should automatically reload the page if `$facebook->getUser();` does not return a valid user?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-22T15:09:26.023

可能不是第一次对其进行身份验证，您可以执行以下操作：

```
<?php

    $facebook = new Facebook(array(
        'appId'  => xxx, 
        'secret' => xxx
    ));

    $user_id = $facebook->getUser();

    if($user_id) {

      // We have a user ID, so probably a logged in user.
      // If not, we'll get an exception, which we handle below.
      try {

        $me = $facebook->api('/me','GET');
        echo "Name: " . $me['name'];

      } catch(FacebookApiException $e) {
        // If the user is logged out, you can have a 
        // user ID even though the access token is invalid.
        // In this case, we'll get an exception, so we'll redirect and
        // just ask the user to login again here.
        $login_url = $facebook->getLoginUrl(); 
        echo("<script>top.location.href = '" . $loginUrl . "';</script>");
      }   
    } else {

      // No user, redirect for the user to login
      $login_url = $facebook->getLoginUrl();
      echo("<script>top.location.href = '" . $loginUrl . "';</script>");

    }

  ?> 
```

**编辑：**

如果错误仍然存​​在，请尝试此编辑，只需更改此行：

```
$me = $facebook->api('/me','GET'); 
```

对此：

```
$me= $facebook->api('/'.$user_id, 'GET'); 
```

希望这能解决您的问题。

# javascript - Javascript unbind Anonymous callback Function

> ID：15026076
> 
> 赞同：2
> 
> 时间：2013-02-22T14:11:29.240
> 
> 标签：javascript, events, callback, anonymous-function

Is there any possibility to unbind anonymous callback function ...

```
link.addEventListener("click", function () {
     //Any piece of code
}, true);

link.removeEventListener("click", function () {
     //Any piece of code
}); 
```

Thanks, Ajain

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:15:12.747

不，因为那些匿名函数实际上是不同的。`{ a: 1 } === { a: 1 }`这与返回 false的原因相同。

您需要执行以下操作：

```
var func = function () { ... };

element.addEventListener( 'click', func, false );

element.removeEventListener( 'click', func, false ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T14:27:16.510

**是的。**您可以通过在某处保存匿名事件处理函数的句柄来做到这一点，`arguments.callee`然后使用此保存的引用解除绑定。

```
// binding
var el = document.getElementById('foo');
el.addEventListener('click', function(e) {
    alert('Hi'); 

    // this is where we save a handle to the anonymous handler
    // arguments.callee gives us a reference to this function
    el['_ev'] = arguments.callee;

}, false);

// unbinding
var el = document.getElementById('foo'), handler = el['_ev'];
if(handler) {

    // here we use the saved reference to unbind it        
    el.removeEventListener('click', handler);

    el['_ev'] = false;
} 
```

**演示：http:** [//jsfiddle.net/jrXex/2/](http://jsfiddle.net/jrXex/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T14:13:32.073

函数由指针标识。你没有指向你的匿名函数的指针，所以你没有任何东西可以传递给 remove() 来告诉它要删除哪个函数。

简单地传递一个重复的函数是行不通的，因为重复的有一个不同的指针。

您需要坚持将函数分配给变量，然后将该变量传递给 remove()。

# parsing - Haskell Parsec, adapting oneOf to [String]

> ID：15026081
> 
> 赞同：9
> 
> 时间：2013-02-22T14:11:54.573
> 
> 标签：parsing, haskell, parsec

I'm going through the Write yourself a scheme in 48 hours tutorial.

```
 symbol :: Parser Char
 symbol = oneOf "!#$%&|*+-/:<=>?@^_~" 
```

This is great for symbols, but what if I have a list of keywords? (i.e. struct, int)

can oneOf be adapted to lists? This is ideally what I want, depicted below.

```
keywords :: Parser String 
keywords = oneOf ["struct","int",..etc] 
```

Or should I import Text.Parsec.Char and try to mapM string over the list of keywords?

I'm attempting to tokenize and just wanted to know what best practices were from others who have gone down this road.

The docs say to use something like this:

```
 divOrMod    =   string "div" 
              <|> string "mod" 
```

[http://hackage.haskell.org/packages/archive/parsec/3.0.0/doc/html/Text-Parsec-Char.html](http://hackage.haskell.org/packages/archive/parsec/3.0.0/doc/html/Text-Parsec-Char.html)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-22T14:23:07.750

它的一般形式是[组合`choice`子](http://hackage.haskell.org/packages/archive/parsec/3.1.3/doc/html/Text-Parsec-Combinator.html#v:choice)，它具有以下类型：

```
choice :: Stream s m t => [ParsecT s u m a] -> ParsecT s u m a 
```

基本上，你给它一个解析器列表，它会按顺序尝试它们，直到一个成功。`choice`是使用 实现`(<|>)`的，因此与该方法相同。

在您的情况下，要匹配关键字列表但不匹配其他解析器，您可以映射s`string`列表`String`然后`choice`在其上使用。

另一方面，`mapM string`它会做一些完全不同的事情——它会期望*所有*的解析器都按顺序成功。

# php - Sending information via a PHP page

> ID：15026090
> 
> 赞同：0
> 
> 时间：2013-02-22T14:12:23.377
> 
> 标签：php, post, sms, case

Let's say I have sugarcrm cases where I know what the case id and or number is.

I want to use email to sms to send to the techs what their work is. So, the link that needs to be sent must have the id and number in it. I want to send them to a simple PHP page that just has a dropdown menu with the two options accept and complete.

so if they receive the sms, they click on the link, it takes them to the page where they click on dropdown to accept the case.

Updating from the PHP is easy: it's just an update my sql query. I need to know how to send header or info in the link that the tech receives.

something like [http://tech.com/caseupdate.php?case_number?case_id](http://tech.com/caseupdate.php?case_number?case_id)

so I can use that case number/id when updating

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:54:29.660

不知道这是否正确，但通过执行以下操作使其正常工作

```
<input type="hidden" name="casen" value=<?php echo $casen;?>> 
```

谢谢大家的帮助。

这是新手学习和获得帮助以解决问题的绝佳站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:42:45.330

你需要这样的东西：

查询字符串中的每个变量都应该用 & 分隔，正如 +War10ck 所说

即：http://tech.com/caseupdate.php?case_number=[num]&case_id=[id]

然后在您的 PHP 中，您可以使用 $_GET[] 获取这些变量。

```
<?php
if(isset($_GET['case_number'])  && isset($_GET['case_id'])) {
    $casen = (int) $_GET['case_number']; // assuming you need an Int value
    $caseid = (int) $_GET['case_id'];
    /* do your MySQL thing here now with $casen and $caseid */
}
?> 
```

# c++ - 基于模板参数的动态命名空间使用

> ID：15026092
> 
> 赞同：8
> 
> 时间：2013-02-22T14:12:36.043
> 
> 标签：c++, templates, boost, namespaces, typedef

我不知道这是否可行，但这是我想要实现的：在模板化类中，我想使用模板参数的命名空间。

例如。

```
template<class P>
class Foo
{
    public:
        Foo();
        virtual ~Foo();

        void doSomething(P&);
        void doSomethingElse();

    protected:
        // There I'm hardcoding "namespace1" but that's what I'd like to 
        // be possibly dynamic 
        // (I'm assuming template parameter P = namespace1::Type)
        void method1(namespace1::Type1&);
        ...
        void methodN(namespace1::TypeN&);
}

// Again, supposing P == namespace1::Type then I want to be using namespace1 
// everywhere in the implementation...
using namespace namespace1;

template<class P>
void Foo<P>::doSomething(P& parameter)
{
    ...
    Type1 type1 = P.getType1(); // There namespace1::Type1 is returned !!
    method1(type1);
    ...
}

template<class P>
void Foo<P>::doSomethingElse()
{
    ...
    TypeN typen; // There I want to instanciate a namespace1::TypeN !!
    ...
}

... 
```

当然，我不想专门化模板并为每个可能的`P`值提供专用的实现，并且我想避免传递所有类型，如`Type1`和`TypeN`作为模板参数，因为我可能有很多它们。

那可能吗 ？

该项目基于 C++3，欢迎任何提升解决方案。

**更新**

作为模板参数`P`本身就像任何`TypeN`参数一样，这可能是正确的方法：

```
template<typename NAMESPACE>
class Foo
{
    typedef typename NAMESPACE::Parameter MyParameter; 
    typedef typename NAMESPACE::Type1 MyType1; 
    typedef typename NAMESPACE::Type1 MyTypeN; 
    ...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:27:28.923

是和否。

是的，可以从主要类型中*推断出*次要类型，通常使用特征系统：

```
template <typename T> struct Trait { typedef typename T::Secondary Secondary; };

template <typename X>
struct Foo {
    typedef typename Trait<X>::Secondary Secondary;

    void foo(Secondary const& s);
}; 
```

不，您不能推断出*命名空间*，因此不能*使用*它；但请注意如何通过在类中使用本地别名 ( `typedef ...`) 没有必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:20:51.467

不，那是不可能的，但你可以使用丑陋的宏文件。

```
//my_class.inl
template<TYPE_ARG>
struct my_class_t<TYPE_ARG>
{
   foo()
   {
      NS_ARG::bar();
   }
}

//my.h
template<class T>
struct my_class_t{};

#define TYPE_ARG T1
#define NS_ARG std
#include "my_class.inl"

#define TYPE_ARG T2
#define NS_ARG boost
#include "my_class.inl"

#undef TYPE_ARG
#undef NS_ARG 
```

这样，您将自动化不同命名空间的类专业化。你真的需要这个吗？:o)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:46:26.883

如果您愿意在每个命名空间中添加一个结构来列出您需要的所有类型，那么您可以依靠 ADL 根据模板参数获取此结构：

```
#include <iostream>
#include <utility>

namespace Foo_ns
{
    struct T1
    {
        static void m() { std::cout << "Foo_ns::T1" << '\n'; }
    };
    struct Foo {};

    // List of all the types you need from this namespace
    struct Types
    {
        typedef Foo_ns::T1 T1;        
    };

    // dummy function needed for ADL        
    Types types(...);
}

namespace Bar_ns
{
    struct T1
    {
        static void m() { std::cout << "Bar_ns::T1" << '\n'; }
    };
    struct Bar {};

    struct Types
    {
        typedef Bar_ns::T1 T1;
    };

    Types types(...);
}

template <typename T>
void callMOnT1(const T &arg)
{
    typedef decltype(types(std::declval<T>())) Types; // ADL kicks in
    //typedef typename std::result_of<types(T)>::type Types;
    Types::T1::m();
}

int main()
{
    callMOnT1((Bar_ns::Bar())); // Bar_ns::T1
    callMOnT1((Foo_ns::Foo())); // Foo_ns::T1
} 
```

不幸的是，这个解决方案使用了一些 C++11 特性（即`decltype`和`declval`）。出于某种原因，我没有设法让代码使用`result_of`Boost 中存在（也许有人可以解释为什么使用的代码`result_of`无法编译？）。

# hex - 如何生成 .hex 文件？（蓝牙）

> ID：15026094
> 
> 赞同：2
> 
> 时间：2013-02-22T14:12:40.597
> 
> 标签：hex, bluetooth-lowenergy

我正在研究 BLE 112 模块。我已经制作了蓝牙配置文件并编写了一些 BGScript 代码，现在我想知道如何生成它的 .hex 文件？我将非常感谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-23T01:28:09.237

您可以使用作为 sdk 一部分的 bgbuild.exe。

见下文

[BLED 112 - 使用 SDK v1.1.1 更新基于 BGScript 的固件](https://stackoverflow.com/questions/17001811/bled-112-update-bgscript-based-firmware-with-sdk-v1-1-1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T15:16:24.127

我建议使用名为 IAR Embedded Workbench for 8051 的软件。祝你好运，RFPic

# jquery - WYSIHTML5 - 创建多个实例时非常慢

> ID：15026096
> 
> 赞同：0
> 
> 时间：2013-02-22T14:12:42.813
> 
> 标签：jquery, performance, wysiwyg, wysihtml5

我正在使用[WYSIHTML5](https://github.com/xing/wysihtml5)将 textarea 转换为编辑器。编辑器非常简单。它只提供基本功能，如粗体/下划线/斜体和插入自定义变量。

当我只加载一个 WYSIHTML5 实例时，一切正常，但是当我在列表中显示 5 或 10 时，它会冻结整个浏览器 1 到 2 秒。

我想我找到了需要这么长时间的原因。当我启动编辑器时，它会创建一个 iframe，它是实际的编辑器。这是它挂起的部分。

是否可以加载 div 而不是 iframe？我知道 WYSIHTML5 的开发团队采用 iframe 是有安全原因的，但无论如何 iframe 的速度很慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:55:00.647

我不确定 WYSIHTML5 输入框是如何生成的，但如果您在目标页面上包含所有必需的 JS 和 CSS 文件，是否有任何理由无法使用 ajax 或 php-include 检索所有内容？

例如

```
<?php include("source/of/the/editor.html");?> 
```

或者

```
 $.ajax({   
    type:"GET",
    url: "source/of/the/editor.html",
    data: "",
    success: function(data){
       $('.requiredDIVs').html(data);
    }
 }); 
```

# python - id() 函数的反函数来演示调用是 ref 和 value

> ID：15026105
> 
> 赞同：0
> 
> 时间：2013-02-22T14:13:02.750
> 
> 标签：python

我试图通过引用和值来演示调用以及python中变量的地址是什么：

```
x = 10

print x
10

x = id(x)

print x

3457569 
```

我通过引用将 x 传递给我的函数，因为 x **是一个地址**

```
def foo(d):

  print "the value of d is" ,**inverseid(d)** 
```

富（X）

3457569

我希望**inverse(d)**打印 10 但它打印地址！

是否存在 id() 的内置逆函数，或者有人可以告诉我如何生成类似于 C 中 * 运算符的地址值吗？

# python - 通过移动对象绘制像素轨迹

> ID：15026106
> 
> 赞同：0
> 
> 时间：2013-02-22T14:13:06.723
> 
> 标签：python, animation, pygame, pixel

我正在使用 Pygame 在 Python 中工作，我想知道如何根据用光标键移动某些对象来绘制像素。

所以，我想做的是画一个“运动轨迹”，例如当玩家向右移动他的对象时，程序必须在这个对象后面从运动开始到运动结束绘制像素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T06:27:01.493

您可以跟踪对象的过去位置。
在下面的代码中，pygame.Rect 正在使用箭头键移动。

你会感兴趣的部分在`Player`课堂上，即

1.  `lasts`（列表）

    *   这个列表记录了玩家之前的位置。
2.  `update_list()`（功能）
    *   此功能管理列表，
        *   将当前位置添加到列表中。
        *   删除第一个元素，一旦列表与`fade`.
3.  `draw()`（功能）
    *   实际上这里只有for循环，它使用索引并绘制褪色的矩形。

> **注意**：这不是最有效的代码。

**编码**

```
import pygame

bg = (255, 255, 255)

def add_colors(color1, color2):
    retval = []
    for i in range(3):
        c1 = color1[i]
        c2 = color2[i]
        c = c1+c2
        if c > 255: # just basic handling
            c -= 255
        retval.append(round(int(c)))
    return tuple(retval)

def calc_colors(color, fade):
    retval = []

    # calculating the color change rate
    diff_color = []
    for i in range(3):
        diff = bg[i] - color[i]
        c_diff = diff/float(fade)
        diff_color.append(c_diff)
    diff_color = tuple(diff_color)

    # get the fading colors
    lastcolor = bg
    for i in range(fade):
        new_color = add_colors(lastcolor, diff_color)
        retval.append(new_color)
        lastcolor = new_color

    return retval[::-1]

class Player:
    def __init__(self, color, fade, pygame_Rect_args):
        """Give arguments as given to pygame.Rect"""
        self.rect = pygame.Rect(*pygame_Rect_args)
        self.size = self.rect.size
        self.vx = 0.0
        self.vy = 0.0
        self.lasts = []

        self.maincolor = color
        self.colors = calc_colors(color,fade)
        self.fade = fade

    def draw(self):
        for i in range(len(self.lasts)):
            pos = self.lasts[i]
            c_color = self.colors[i]
            pygame.draw.rect(screen, c_color, pygame.Rect(pos, self.size))
        pygame.draw.rect(screen, self.maincolor, self.rect)

    def update_list(self):
        self.lasts.append(self.rect.topleft)
        if len(self.lasts) > self.fade:
            self.lasts.remove(self.lasts[0])

    def update(self):
        self.rect.x += int(round(self.vx))
        self.rect.y += int(round(self.vy))

    def handle_keys(self):
        key = pygame.key.get_pressed()
        if key[pygame.K_UP]:    self.vy -= 0.1
        if key[pygame.K_DOWN]:  self.vy += 0.1
        if key[pygame.K_LEFT]:  self.vx -= 0.1
        if key[pygame.K_RIGHT]: self.vx += 0.1

player = Player((255,255,0), 10, (10,10,10,10))

pygame.init()
screen = pygame.display.set_mode((640,480))
clock = pygame.time.Clock()

running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
            pygame.quit()
            break

    if not running:
        break

    player.handle_keys()
    player.update_list()
    player.update()

    screen.fill(bg)
    player.draw()
    pygame.display.flip()

    clock.tick(40) 
```

您可能还想完成[本教程](http://lorenzod8n.wordpress.com/category/pygame-tutorial/)（不是全部，而只是最后一部分 (#9)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T16:05:34.493

最简单的方法是[`surface.set_at()`](http://www.pygame.org/docs/ref/surface.html#Surface.set_at)：

```
surface.set_at((x, y), color) 
```

x 和 y 是移动物体的位置。颜色是一个 RGB 三元素元组，如`(100,0,200)`.

# php - 如何在 php 和 mysql 中获得每月总销售额？

> ID：15026113
> 
> 赞同：2
> 
> 时间：2013-02-22T14:13:34.307
> 
> 标签：php, mysql

我有以下代码查询数据库并显示结果：

```
<?php
include('connect.php');
$query="SELECT date1,month(date1) as month1,year(date1)as month2,(month( date1 )-month(date1 )) as difference,SUM(gtotal) AS daily_total,COUNT(id) AS num_orders FROM `sale` 
    where date1>='2012-01-28' AND date1<='2013-01-31' and tax_name='C.S.T. 4% ON SCRAP' and tin='Applied For' GROUP BY date1 ";

$qt=mysql_query($query);
echo mysql_error();
echo "<table border='1' cellspacing='1' cellpadding='0' width='400'>
    <tr valign='top' bgcolor=#363636 style='color:#ffffff;'>
        <td><b>No. of orders</b></td>
        <td><b>Date</b></td>
        <td><b>Month<br>(dt)</b></td>
        <td><b>Year<br>(dt2)</b></td>
        <td><b>difference</b></td>
    </tr>";
while($nt=mysql_fetch_array($qt))
{
    echo "<tr valign='top'>
        <td><font face='Verdana' size='2' >$nt[num_orders]</font></td>
        <td><font face='Verdana' size='2' >$nt[date1]</font></td>
        <td><font face='Verdana' size='2' >$nt[month1]</font></td>
        <td><font face='Verdana' size='2' >$nt[month2]</font></td>
        <td><font face='Verdana' size='2' >$nt[difference]</font></td>
         </tr>";

echo "<tr bgcolor=#c2c2c2>
    <td colspan=3></td>
    <td><b>Month Total</b></td>
    <td>$nt[daily_total]</td>
      </tr>";
}

echo "<tr valign='top'><td colspan=5></td></tr>";

$query1="SELECT * FROM `sale` where date1>='2012-01-28' AND date1<='2013-01-31' and  tax_name='C.S.T. 4% ON SCRAP' and tin='Applied For' and gtotal ";

$qt1=mysql_query($query1);
echo mysql_error();
$num=mysql_num_rows($qt1);
if($num)
{
    $p=0;
    $q=0;

    while($nt1=mysql_fetch_array($qt1))
    {
        $p=$p+$nt1['gtotal'];
        $q=$q+$nt1['subtotal'];
    }
}
echo "<tr valign='top' bgcolor=#c6c6c6>
    <td><font face='Verdana' size='2' >$C</font></td>
    <td><font face='Verdana' size='2' ><b>subtotal<br></b></font></td>
    <td><font face='Verdana' size='2' >$q</font></td>
    <td><font face='Verdana' size='2' ><b>gtotal<br></b></font></td>
    <td><font face='Verdana' size='2' >$p</td>
      </tr>";

echo "</table>";
?> 
```

但我有数百个数据项要计算。假设我在一月份有 5 个数据项，它们都应该在 5 行中看到，并且在月底应该有月份总数，依此类推，直到 12 个月。例如看这张图片：-![月总计](../Images/568222a232d60fff3202f157a9bee2ac.png)我希望你能理解我的问题并能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:28:50.003

[mysql 按日期选择总和组](https://stackoverflow.com/questions/937652/mysql-select-sum-group-by-date)

```
SELECT MONTHNAME(o_date), SUM(total) 
FROM theTable
GROUP BY YEAR(o_date), MONTH(o_date) 
```

或者你在 PHP 中计算月份总和，如下所示：

```
$query="SELECT date1, month(date1) as month,year(date1) as year,SUM(gtotal) AS daily_total FROM `sale` GROUP BY date1 ORDER BY date1";
$qt=mysql_query($query);
$month_total=0;
$last_month_year='';
while($nt=mysql_fetch_array($qt))
{
    if($last_month_year=='')
        $month_total=$nt['daily_total'];
    elseif($last_month_year==$nt['month'].$nt['year'])
        $month_total+=$nt['daily_total'];
    else
    {
        $month_total=$nt['daily_total'];
        echo "Month total: ".$month_total."<br>";
    }
    echo $nt['date1'].": ".$nt['daily_total']."<br>";
    $last_month_year=$nt['month'].$nt['year'];
} 
```

# openldap - LDAP 密码信息更新失败：推荐人无法从副本更改密码

> ID：15026115
> 
> 赞同：0
> 
> 时间：2013-02-22T14:13:34.780
> 
> 标签：openldap

我已经使用 slapd.conf 和 slurpd 配置了主/从。

问题是如果主服务器停止，我无法从从服务器更改客户端密码。

主服务器 -

```
[root@lr5dir01 ~]# service ldap stop
Stopping slapd:                                            [  OK  ]
Stopping slurpd:                                           [  OK  ]
[root@lr5dir01 ~]# 
```

从服务器 -

```
[root@lr5dir02 ldap]# service ldap restart
Stopping slapd:                                            [  OK  ]
Checking configuration files for slapd:  config file testing succeeded
                                                           [  OK  ]
Starting slapd:                                            [  OK  ]
[root@lr5dir02 ldap]# 
```

客户 -

```
[root@lr5dir02 ldap]# ssh ldaptest@10.40.109.94
ldaptest@10.40.109.94's password:
Last login: Tue Feb 19 21:14:27 2013 from lr5dir02.hk.intraxa
Could not chdir to home directory /home/ldaptest: No such file or directory
-bash-3.2$

-bash-3.2$ passwd
Changing password for user ldaptest.
Enter login(LDAP) password:
'New UNIX password:
Retype new UNIX password:
LDAP password information update failed: Referral

passwd: Permission denied
-bash-3.2$ 
```

主服务器 - slapd.conf

```
access to attrs=shadowLastChange,userPassword
      by self write
      by * auth

access to *
      by * read

replica host=10.40.101.231:389
        binddn="cn=Manager,dc=hk,dc=intraxa"
        credentials=secret
        bindmethod=simple
        tls=no 
```

从服务器 slapd.conf - 仅与主服务器相同

```
updatedn "cn=Manager,dc=hk,dc=intraxa"
updateref ldap://10.40.101.230:389/ 
```

客户帕姆-

```
[root@lr6tst01 ~]# more /etc/pam.d/passwd
#%PAM-1.0
auth       include      system-auth
account    include      system-auth
password   include      system-auth

[root@lr6tst01 ~]#

Log - Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: read active on 14
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: epoll: listen=7 active_threads=0 tvp=NULL
Feb 19 21:43:54 lr5dir02 slapd[7147]: conn=2 op=4 BIND dn="uid=ldaptest,ou=People,dc=hk,dc=intraxa" method=128
Feb 19 21:43:54 lr5dir02 slapd[7147]: conn=2 op=4 BIND dn="uid=ldaptest,ou=People,dc=hk,dc=intraxa" mech=SIMPLE ssf=0
Feb 19 21:43:54 lr5dir02 slapd[7147]: conn=2 op=4 RESULT tag=97 err=0 text=
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: activity on 1 descriptor
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: activity on:
Feb 19 21:43:54 lr5dir02 slapd[7147]:
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: epoll: listen=7 active_threads=0 tvp=NULL
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: activity on 1 descriptor
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: activity on:
Feb 19 21:43:54 lr5dir02 slapd[7147]:  14r
Feb 19 21:43:54 lr5dir02 slapd[7147]:
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: read active on 14
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: epoll: listen=7 active_threads=0 tvp=NULL
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: activity on 1 descriptor
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: activity on:
Feb 19 21:43:54 lr5dir02 slapd[7147]:
Feb 19 21:43:54 lr5dir02 slapd[7147]: daemon: epoll: listen=7 active_threads=0 tvp=NULL
Feb 19 21:43:54 lr5dir02 slapd[7147]: conn=2 op=5 MOD dn="uid=ldaptest,ou=People,dc=hk,dc=intraxa"
Feb 19 21:43:54 lr5dir02 slapd[7147]: conn=2 op=5 MOD attr=userPassword
Feb 19 21:43:54 lr5dir02 slapd[7147]: conn=2 op=5 RESULT tag=103 err=10 text=
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: activity on 1 descriptor
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: activity on:
Feb 19 21:43:56 lr5dir02 slapd[7147]:  14r
Feb 19 21:43:56 lr5dir02 slapd[7147]:
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: read active on 14
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: epoll: listen=7 active_threads=0 tvp=NULL
Feb 19 21:43:56 lr5dir02 slapd[7147]: connection_read(14): input error=-2 id=2, closing.
Feb 19 21:43:56 lr5dir02 slapd[7147]: conn=2 op=6 UNBIND
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: removing 14
Feb 19 21:43:56 lr5dir02 slapd[7147]: conn=2 fd=14 closed
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: activity on 1 descriptor
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: activity on:
Feb 19 21:43:56 lr5dir02 slapd[7147]:
Feb 19 21:43:56 lr5dir02 slapd[7147]: daemon: epoll: listen=7 active_threads=0 tvp=NUL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:05:27.147

如果您使用的是`slurpd`，则必须使用旧版本的 OpenLDAP —— 支持的复制配置是严格的单主 (RW)，具有只读副本节点。`slurpd`不再支持，部分原因是它只能支持这种模式。

发生的事情是只读节点知道它不能接受写入请求（除了来自主节点的请求），因此它向客户端提供*引用*，发送到可写节点（即发送到`updateref`配置中的 URI）。

您应该升级到 OpenLDAP 2.4，并使用*syncrepl*协议进行复制。这允许三种复制方案：

1.  单个 RW 主节点，多个 RO 副本节点
2.  完整的多主 RW（有一些警告）
3.  *mirrormode* hybrid (active hot-standby), 使用平衡器或代理

您可以将 syncrepl 与 OpenLDAP 2.3 一起使用，但我强烈建议您升级（或者您可能会错过长达 5 年的 syncrepl 增强功能和补丁，具体取决于您使用的软件包以及是否已向后移植任何修复程序）。

当前设置的唯一选择是手动更改 RO 节点的配置以在主节点离线时将其提升为主节点，因为您可以猜测这可能难以维护。

# php - 需要为特定行输入来自不同用户的列值的代码

> ID：15026116
> 
> 赞同：0
> 
> 时间：2013-02-22T14:13:36.500
> 
> 标签：php, mysql

嘿伙计们，我正在 mysql 中创建一个名为**result**的表，它将有 4 个字段，即

表格**结果**

```
name ,
subject1_score ,
sub2_score ,
sub3_score 
```

现在我正在做的是给 3 位老师单独的表格，让他们输入他们各自的科目分数。例如，*teacher_1* 将看到所有卷号，并且需要输入`subject1_score`然后提交。其他两位老师也一样。那么我必须使用什么代码`php`才能`mysql`为特定学生连续输入值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:23:56.273

有两种方法，第一种是用学生姓名/roll_nos 填充表格，第二种是保持空白。但是请为卷号保留一个字段，因为它们是唯一的并且可以作为主键。

在第一种方法中，您只需编辑已输入标记的特定卷号的特定行。为此，您只需要运行 mysql 的更新查询，例如，

```
mysql_query("UPDATE table_name SET subject1_score='$subject!_score' WHERE roll_no='$roll_no'"); 
```

等等。在这里，您必须通过 PHP 从表单中获取卷号和标记。

在第二种方法中，您必须首先通过运行`SELECT`查询并通过“mysql_num_rows”计算行数来检查数据库表中是否存在卷号。如果行数大于 0，则必须通过运行更新查询来更新 roll_no。如果返回的行数为 0，则需要通过运行插入查询来插入日期。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:22:41.287

我不确定名称代表什么（学生或老师），我假设有 3 个科目，每个老师都必须提交各自的分数，并且您希望将所有数据设置在一行中，例如 (roll_num, name,科目 1 分、科目 2 分、科目 3 分）。如果这是真的，那么这应该适合你：

```
if (isset("name") && isset("roll_number)){

$name = $_GET["name"];
$roll_no = $_GET["roll_number"];

if (isset("subject1_score")){
$subject = "subject1_score";
$score = $_GET['subject1_score'];
}elseif(isset("subject2_score")){
$subject = "subject2_score";
$score = $_GET['subject2_score'];
}elseif(isset("subject3_score")){
$subject = "subject3_score";
$score = $_GET['subject3_score'];
}else{
$subject = "";
$score = "";
}

$con = mysql_connect("host","username","password");
if (!$con) die('Could not connect: ' . mysql_error());
mysql_select_db($con, dbname);

$query1 = "SELECT * FROM result WHERE roll_number='$roll_no'";
$result1 = mysql_query($query1) or die(mysql_error());
$num = mysql_num_rows($result);

if($num == 0 && $subject != ""){
$query2 = "INSERT INTO result(roll_number, name, $subject) VALUES('$roll_no', '$name', '$score')";
mysql_query($query2) or die(mysql_error());
}elseif($num > 0 && $subject != ""){
$query2 = "UPDATE result SET $subject='$score' WHERE roll_number='$roll_no'"
}else{
echo "subject score is empty";
}
mysql_close($con); 
```

# java - 数组显示图像，需要另一种方法，带参数NUM

> ID：15026118
> 
> 赞同：1
> 
> 时间：2013-02-22T14:13:38.520
> 
> 标签：java, arrays, parameters

我在标题中可怕地解释了这一点，我很抱歉，我对 Java 很陌生，还不太了解其中的一些内容。

反正，

我的猫动画运行到屏幕中间，刮了两次，然后继续运行到最后，有没有办法编写一个方法来获取一个 INT NUM 并使猫刮 x 次？不知道该怎么做。

任何帮助都会很棒，

这是我当前的代码

```
/** Run the animation. */
public void nekoRun() {
    moveIn();
    scratch();
    //scratch2(5);
    moveOut();
}

/* Move Neko to the centre of the panel. */
private void moveIn() {
    for (int i = 0; i < getWidth()/2; i+=10) {
        xPos = i;
        // swap images
        if (currentImage == nekoPics[0]) 
            currentImage = nekoPics[1];
        else 
            currentImage = nekoPics[0];
        repaint();
        pause(150);
    }   
}
private void scratch() {
    for (int i = 0; i < 10; i++)  {

        // Swap images.
        currentImageIndex = nextImageList[currentImageIndex];
        currentImage = nekoPics[currentImageIndex];

            repaint();
            pause(150);
        }
}

private void moveOut() {
    for (int i = xPos; i < getWidth(); i+=10) {
        xPos = i;
        // swap images
        if (currentImage == nekoPics[0]) 
            currentImage = nekoPics[1];

        else 
            currentImage = nekoPics[0];
        repaint();
        pause(150);
    }   
} 
```

# javascript - Rails 中用于 Flash 通知的 Javascript 事件处理程序

> ID：15026125
> 
> 赞同：1
> 
> 时间：2013-02-22T14:13:55.417
> 
> 标签：javascript, ruby-on-rails-3

我只是想知道是否有任何方法可以做到这一点？

基本上，我有一些 javascript 想要在用户关闭页面加载时出现的 flash 通知后执行。我是否必须制作自定义 Flash 通知才能在其上获取事件处理程序，或者有没有办法在内置的 Rails Flash 通知上获取处理程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:19:39.563

您可以轻松地将 jquery 事件处理程序绑定到单击按钮以关闭 Flash 通知的用户。

```
`$().ready(function() {
  $("#button_id_that_user_clicks_to_dismiss_the_flash_notice").click(function() {
    alert("user has dismissed the flash notice")
  })
})`

您的 flash 元素可能位于 app/views/layouts/application.html.erb .. 编辑此文件以确保您正确标识了解除按钮

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2013-02-22T14:28:20.310

这是假设您使用的是咖啡脚本，目前在 Rails 中是默认设置：

```
jQuery ->
  $('#flash_close_button').on 'click', (ev) ->
    # close flash notice
    # do other stuff here 
```

这将要求您编辑 Flash 通知的 html。要在没有标识符的情况下执行此操作，您可能希望查看[此答案](https://stackoverflow.com/a/1225114/419017)。 
```

# typo3 - 如何对 pi_list_query（或 pi_exec_query）列表进行排序

> ID：15026127
> 
> 赞同：0
> 
> 时间：2013-02-22T14:13:56.787
> 
> 标签：typo3

我正在使用扩展 feuserlisting 向访问者展示网站成员列表，但我想按全名对列表进行排序。我知道我可以单击表格标题在屏幕上显示它时对其进行排序，但不知何故应该可以通过 TypoScript 设置默认排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:13:56.787

这样做的方法是使用 _DEFAULT_PI_VARS 机制。

```
plugin.tx_feuserlisting_pi1._DEFAULT_PI_VARS {
    sort = name:0
} 
```

feuserlisting 的列表视图方法通过调用`$this->pi_setPiVarDefaults()`（从 tslib_pibase 继承）来初始化，其中`_DEFAULT_PI_VARS`在建立 piVar 时会考虑密钥。

这种技术应该在所有使用这种调用初始化其 piVar 的 pibase 扩展中都可用。

# tfs - 如何在 TFS 2012 中创建工作项类型

> ID：15026132
> 
> 赞同：3
> 
> 时间：2013-02-22T14:14:02.257
> 
> 标签：tfs

如何在 TFS 2012 中创建自定义工作项类型？例如）我想创建一个名为“支持请求”的类型，而不仅仅是一个错误或任务等。我有一个 XML 模板文件。

问候， 昂

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:25:12.823

下载 TFS 2012 Power Tools 以安装进程编辑器。链接：http: [//visualstudiogallery.msdn.microsoft.com/b1ef7eb2-e084-4cb8-9bc7-06c3bad9148f](http://visualstudiogallery.msdn.microsoft.com/b1ef7eb2-e084-4cb8-9bc7-06c3bad9148f)

然后看看这个指南（它使用 TFS 2010 - 我想你无论如何都可以使用它）： [http ://www.dotnetcurry.com/ShowArticle.aspx?ID=755](http://www.dotnetcurry.com/ShowArticle.aspx?ID=755)

# monitoring - Monit 似乎在 conf 文件中没有除 '@' 并将其视为语法错误：错误：语法错误

> ID：15026133
> 
> 赞同：1
> 
> 时间：2013-02-22T14:14:02.127
> 
> 标签：monitoring, monitor, monit

我有以下配置文件监控：

```
check process rabbitmq-server with pidfile /var/lib/rabbitmq/mnesia/rabbit@ubuntu.pid
  start program = "/etc/init.d/rabbitmq-server start"
  stop program = "/etc/init.d/rabbitmq-server stop" 
```

当我运行时： sudo service monit restart

收到此错误：

```
Error: syntax error '/var/lib/rabbitmq/mnesia/rabbit@ubuntu.pid' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:11:06.307

看来如果它包含特殊字符，你需要使用引号“/var/lib/rabbitmq/mnesia/rabbit@ubuntu.pid”

# web - 在我的网站中嵌入 Google 版主

> ID：15026135
> 
> 赞同：0
> 
> 时间：2013-02-22T14:14:06.727
> 
> 标签：web, embedding, google-moderator

我正在开发一个网站，我需要在我的网站中嵌入谷歌版主，我通过谷歌的帮助但无法做到。那么将 Google 版主嵌入我的网站的步骤是什么。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:00:25.070

“嵌入谷歌版主”的第二个结果：

首先，将以下代码放在页面的 HEAD 部分：

```
<script src="https://www.google.com/moderator/static/moderator-embed-api.js" type="text/javascript"></script> 
```

接下来，在您的页面上创建一个具有指定 ID 的空元素，该 ID 将包含嵌入式主持人页面，例如

```
<div id=”moderator-embed-target”&gt;</div> 
```

在您的浏览器中，打开您想要嵌入的现有版主页面并检索 URL，例如：

```
https://www.google.com/moderator/#16/e=409f 
```

对于基本用途，在您上面创建的目标元素下方，在此代码中包含您的版主页面的 URL 和目标元素的 ID：

```
<script type="text/javascript">
MODERATOR_embed("https://www.google.com/moderator/#16/e=409f", "moderator-embed-target");
</script> 
```

对于高级用途，您可以使用如下代码指定嵌入页面的高度、宽度和语言，而不是使用 MODERATOR_embed 函数：

```
<script type="text/javascript"> 
var mod = new MODERATOR("https://www.google.com/moderator/#16/e=409f"); 
mod.hl = "es"; 
mod.width = 1000; 
mod.height = 500; 
mod.embed("moderator-embed-target"); 
</script> 
```

将它们放在一起：这是一个使用默认属性嵌入此版主系列的示例页面：

```
<html>
<head> 
  <title>Embedding Moderator Sample</title>
  <script src="https://www.google.com/moderator/static/moderator-embed-api.js" type="text/javascript"></script>
</head> 
<body> 
  <div id="moderator-embed-target"></div> 
  <script type="text/javascript">
    MODERATOR_embed("https://www.google.com/moderator/#16/e=409f", "moderator-embed-target"); 
  </script> 
</body> 
</html> 
```

您可以在浏览器中查看此示例：http: [//google-moderator-api-samples.googlecode.com/hg/samples/simple-embed-api/simple-embed-api-example.html](http://google-moderator-api-samples.googlecode.com/hg/samples/simple-embed-api/simple-embed-api-example.html)

**信息位于：** [https ://sites.google.com/site/moderatorhelpcenter/home/embedding-moderator](https://sites.google.com/site/moderatorhelpcenter/home/embedding-moderator)

# c# - 从图片单位到现实世界单位

> ID：15026138
> 
> 赞同：0
> 
> 时间：2013-02-22T14:14:09.213
> 
> 标签：c#, .net

我需要一个我正在研究的程序的最佳解决方案。程序应该拍摄一张带有一些单一黑色线条对象的图像（仅限黑白），如星形、圆形、矩形等。之后，程序应该找到每个黑点的位置并跟踪它。通过这个我根据那些位置我将进行一些计算以使我的步进电机相应地移动。想象一下有记号笔和白板，我希望通过指定大小将我电脑上的图片绘制在白板上。

我不知道，也许除了图像还有其他一些方法，什么单位更好，基于像素或......？需要一些建议和推荐。欣赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:18:45.853

对于打印、扫描和显示器，有一个术语 DPI（每英寸点数），这是您需要检查以确定图像的真实世界大小。通过图像中的像素数比较设备的 DPI。

请注意，DPI 以每平方英寸的点数表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:19:08.683

我不知道如何用 C# 做到这一点，但你可以使用 OpenCV 和它为 c# Emgu 包装，你可以读取你拥有的图像并将其转换为 YCbCr 颜色模型，你可以使用轮廓函数或 minmaxloc 函数。

# java - 在 Spring 中使用事务时创建提交后

> ID：15026142
> 
> 赞同：39
> 
> 时间：2013-02-22T14:14:30.613
> 
> 标签：java, spring, transactions

由于某些原因，我使用 Spring PlatformTransactionManager 手动执行事务提交和回滚，我需要做的是设置一个挂钩，以便在事务提交后执行提交后操作。

通过查看：

```
 void commit(TransactionStatus status) throws TransactionException; 
```

除了假设它之外，我看不到如何确定交易是否成功，所以如果没有抛出异常。

我可以使用 AOP 作为一种选择，但是如何以编程方式执行它，也许使用回调方法？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-02-22T14:49:40.347

你可以通过更简单的方式得到你想要的，使用[`TransactionSynchronizationManager`](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/transaction/support/TransactionSynchronizationManager.html)and[`TransactionSynchronization`](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/transaction/support/TransactionSynchronization.html)

使用`TransactionSynchronizationManager`，您可以使用静态方法来获取有关当前事务的信息，并且您可以注册一个`TransactionSynchronization`允许您在调用时自动执行 post-commit 的方法

```
TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronization(){
           void afterCommit(){
                //do what you want to do after commit
           }
}) 
```

请注意，TransactionSynchronization 是基于每个线程的（这对于基本的 Web 请求通常不是问题）。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-04-10T11:31:53.747

归功于 Grooveek 的回答和 Alex 在其下的评论 - 我把它放在这里是因为综合建议提供了一个在网络上很难找到的可靠和更清洁的解决方案。

使用 Spring 4+。如果您需要在`@Transactional`成功提交后对方法进行回调，只需在方法的开头添加：

```
@Service
public class OneService {

    @Autowired
    OneDao dao;

    @Transactional
    public void a transactionalMethod() {
        TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronizationAdapter(){
            public void afterCommit(){
                //do stuff right after commit
                System.out.println("commit!!!");

            }
        });
        //do db stuff
        dao.save();
    }
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2020-07-03T21:21:07.177

从 Spring 4.2 开始，可以使用基于注释的配置为提交后事件（或更一般的事务同步事件，例如回滚）定义侦听器。这是基于[核心 spring](https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#context-functionality-events)中的事件处理。使用这种方法更容易测试代码，因为您避免了对 TransactionSynchronizationManager 的直接依赖，这在单元测试中可能不会处于活动状态。您可以轻松地测试您的事务服务是否发布了一个事件，以及您的侦听器在您收到事件时是否执行正确的操作。

因此，事不宜迟，这就是如何设置它：

在此示例中，我们假设您有一个`Customer`实体和一个`CustomerRepository`（以及与之配套的 ORM）。

首先你需要一个新的事件类型`NewCustomerEvent`：

```
// NewCustomerEvent.java
// Just a regular pojo for the event
public class NewCustomerEvent {

    public String email;

    // constructor, setters and getters omitted
} 
```

然后你定义一个监听器使用[`@TransactionalEventListener`](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/event/TransactionalEventListener.html). 默认情况下，这将在成功提交后执行，但这可以使用`phase`参数进行更改：

```
// NewCustomerEventListener.java
@Component
public class NewCustomerEventListener {

    @TransactionalEventListener
    public void handleNewCustomerEvent(NewCustomerEvent newCustomerEvent) {
        // handle new customer event
    }
} 
```

[`ApplicationEventPublisher`](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/ApplicationEventPublisher.html)最后，一旦发送了所有事务语句，您就可以使用您调用的发布来扩充您的事务服务。

```
// CustomerRespositoryService.java
@Service
public class CustomerRepositoryService {

    @Inject
    private ApplicationEventPublisher applicationEventPublisher;

    @Inject
    private CustomerRepository customerRepository;

    @Transactional
    public void createCustomer(String email) {
        Customer customer = new Customer(email);
        customerRespotory.save(customer);
        applicationEventPublisher.publish(new NewCustomerEvent(email));
    }

} 
```

也可以看看：

*   [https://dzone.com/articles/simpler-handling-of-asynchronous-transaction-bound](https://dzone.com/articles/simpler-handling-of-asynchronous-transaction-bound)
*   [https://dzone.com/articles/transaction-synchronization-and-spring-application](https://dzone.com/articles/transaction-synchronization-and-spring-application)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T14:27:40.560

在我的一个项目中，由于某些原因，我也不得不使用`PlatformTransactionManager`. 所以我被迫使用`org.springframework.transaction.support.TransactionTemplate`.

[http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/support/TransactionTemplate.html](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/support/TransactionTemplate.html)

主要的好处是，如果你正确地实现了 PlatformTransactionManager，你就不需要手动提交/回滚了。如果您需要更具体的东西，至少 TransactionTemplate 的源代码可以帮助您。

使用起来非常简单：

配置文件

```
<bean name="transactionTemplate"
            class="org.springframework.transaction.support.TransactionTemplate">
    <property name="transactionManager" ref="platformTransactionManager"/>
</bean> 
```

MyServiceImpl.java

```
@服务
公共类 MyServiceImpl 实现 MyService {

    @自动连线
    私人交易模板交易模板；

    公共实体 getSomethingWithTx(final long id) {

        返回 transactionTemplate.execute(new TransactionCallback<Entity>() {
            @覆盖
            公共实体doInTransaction（TransactionStatus状态）{
                //TODO 实现
            }
        });
    }

```

# asp.net - 添加缺少的表

> ID：15026149
> 
> 赞同：1
> 
> 时间：2013-02-22T14:14:55.143
> 
> 标签：asp.net, entity-framework

我错过了我的数据模型中的一个表 我有一个现有的数据库，并尝试了： [EF Power Tools like THIS description](http://msdn.microsoft.com/en-us/data/jj200620)

表：

*   用户身份， ...）
*   项目（ID、名称、..）
*   时间戳（ID、开始、结束、用户 ID、项目 ID ..）

但我没有表“Poject_Favorit”（UserId，ProjectID）

所以我自己写了表：

```
public class Project_Favorite
{
    [Key]public Guid GuidUser { get; set; }
    public Guid GuidProject { get; set; }
} 
```

我补充说：

```
public DbSet<Project_Favorite> Project_Favorite { get; set; } 
```

到我的 DbContext

EF 搜索“dbo.Project_Favorite”，但它应该搜索“Timeworx.Project_Favorite”

所以我补充说：

```
modelBuilder.Configurations.Add(new Project_FavoriteMap()); 
```

到我的 DbContext

并创建了文件“Project_FavoriteMap.cs：

```
class Project_FavoriteMap : EntityTypeConfiguration<Project_Favorite>
{
    public Project_FavoriteMap() { 
        //Primary Key
        this.HasKey(t => t.GuidProject);
        this.HasKey(t => t.GuidUser);

        this.ToTable("Project_Favorite", "Timeworx");
    }        
} 
```

现在有一个错误。它说“...Project_Favorite 已经定义...”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:20:17.417

看起来该表是和`Poject_Favorit`之间的多对多连接。在这种情况下，您不需要相应的实体类。你的班级可能会有一个，你的班级可能会有一个. 这代表了一个多对多的层次结构。一个项目可以被很多用户收藏，一个用户可以收藏很多项目。因此，这两个集合。`User``Project``User``ICollection<Project>``Project``ICollection<User>`

# jquery - 下拉菜单上的自定义滚动条

> ID：15026151
> 
> 赞同：0
> 
> 时间：2013-02-22T14:15:00.807
> 
> 标签：jquery, html, drop-down-menu, scrollbar, tinyscrollbar

我有一个 HTML 下拉结构。具有以下内容：

```
 <div class="tl_l">
<div class="labeled"><label for="pers_il">İl</label></div>
<select id="ad_il" name="pers_il" class="">
<option>İstanbul</option>
<option>Ankara</option>
<option>Adana</option>
<option>Adıyaman</option>
<option>Aydın</option>
<option>Muğla</option>
<option>Eskişehir</option>
<option>Konya</option>
<option>Denizli</option>
<option>Bitlis</option>
<option>Yozgat</option>
<option>Antalya</option>
<option>Muğla</option>
</select>
</div> 
```

并使用[JGD Dropdown](http://www.dev4press.com/jquery/jgd-dropdown/) jquery 插件来自定义下拉菜单。但是我的清单太长了。所以，我想在这个列表中添加自定义 scollbar。安装[Tiny Scrollbar](http://baijs.nl/tinyscrollbar/)并添加我的 HTML。CSS：

```
#scrollbar1 { width: 520px; clear: both; margin: 20px 0 10px; }
#scrollbar1 .viewport { width: 500px; height: 200px; overflow: hidden; position: relative; }
#scrollbar1 .overview { list-style: none; position: absolute; left: 0; top: 0; }
#scrollbar1 .thumb .end,
#scrollbar1 .thumb { background-color: #003D5D; }
#scrollbar1 .scrollbar { position: relative; float: right; width: 15px; }
#scrollbar1 .track { background-color: #D8EEFD; height: 100%; width:13px; position: relative; padding: 0 1px; }
#scrollbar1 .thumb { height: 20px; width: 13px; cursor: pointer; overflow: hidden; position: absolute; top: 0; }
#scrollbar1 .thumb .end { overflow: hidden; height: 5px; width: 13px; }
#scrollbar1 .disable{ display: none; }
.noSelect { user-select: none; -o-user-select: none; -moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; } 
```

JS：

```
<script type="text/javascript">
    $(document).ready(function(){

        $('#scrollbar1').tinyscrollbar();

    });
</script> 
```

并在打开标签后添加 scrollbar1 id`select`但不起作用。通过 Firebug 检查任何错误时，未找到。我如何在我的结构上使用这个插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:30:19.033

要启用浏览器的内置滚动条，请确保指定容器的高度和溢出

```
``#scrollbar1 { 
  width: 520px; 
  clear: both; 
  margin: 20px 0 10px;
  height: 400px;
  overflow-y: auto;
}`` 
```

# mysql - 涉及 Joda 间隔的 JPA 查询

> ID：15026152
> 
> 赞同：0
> 
> 时间：2013-02-22T14:15:10.440
> 
> 标签：mysql, jpa, find, criteria

所以我使用 Play Framework (1.2.5) 来开发应用程序。但是我在检索一些特定数据时遇到了一些麻烦。

我有两个类：事件和站点。一个事件在一段时间内发生（定义为 Joda 间隔）并包含多个站点。每个站点都有一个位置（用 lat 和 lng 定义）。我想要做的是获取在特定时间段内（并且可能在地图边界内）参与事件的站点列表。

我将如何进行此查询？我试过使用 JPA 的 CriteriaBuilder 甚至自己写出查询，但我不知道如何处理时间段。

事件模型

```
@Entity
@Table(name = "event")
public class Event extends GenericModel {
    @Id
    @GeneratedValue
    public Long id;
    @Columns(columns = {
        @Column(name = "start"),
        @Column(name = "end")})
    @Type(type = "org.joda.time.contrib.hibernate.PersistentInterval")
    public Interval eventPeriod;
    public String title;
    @ManyToMany
    public List<Site> sites = new ArrayList<Site>();
} 
```

场地模型

```
@Entity
@Table(name = "site")
public class Site extends Model {
    @Column(name = "akey", unique = true, nullable = false)
    public String key;
    public Double latitude;
    public Double longitude;
} 
```

用于在 DB 中创建表的 SQL

```
CREATE  TABLE event (
    id BIGINT(20) NOT NULL AUTO_INCREMENT ,
    start DATETIME NOT NULL ,
    end DATETIME NOT NULL ,
    title VARCHAR(255) NOT NULL ,
    PRIMARY KEY (id)
);

CREATE  TABLE site (
    id BIGINT(20) NOT NULL AUTO_INCREMENT ,
    akey VARCHAR(255) NOT NULL ,
    latitude DOUBLE NOT NULL ,
    longitude DOUBLE NOT NULL ,
    PRIMARY KEY (id) ,
);

CREATE  TABLE event_site (
    event_id BIGINT(20) NOT NULL,
    sites_id BIGINT(20) NOT NULL,
    KEY FKevent_id (event_id),
    KEY FKsites_id (sites_id)
); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T05:47:01.120

Persistent Interval 增加了两个属性；“开始”和“结束”到您可以在查询期间访问的变量。作为你的例子，你会想要

```
from Event
where :targetDate between eventPeriod.start and evenPeriod.end 
```

它们在 java 文档中被提及，但我发现我必须阅读代码才能弄清楚如何使用它们。 [http://joda-time.sourceforge.net/contrib/hibernate/apidocs/org/joda/time/contrib/hibernate/PersistentInterval.html](http://joda-time.sourceforge.net/contrib/hibernate/apidocs/org/joda/time/contrib/hibernate/PersistentInterval.html)

# settings - 在工作站之间共享 Resharper 和其他设置

> ID：15026153
> 
> 赞同：0
> 
> 时间：2013-02-22T14:15:10.487
> 
> 标签：settings, resharper, share

如何在家庭和工作工作站之间共享 resharper 设置和其他设置？有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T07:38:28.353

如果您有 ReSharper 6.1 或更高版本，您可以使用 Dropbox、Google Drive 等共享设置文件。阅读[这篇文章](http://blogs.jetbrains.com/dotnet/2011/12/resharper61-settings-dropbox-and-company-wide/)以了解更多信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-22T14:15:10.487

我有一个在工作站（家庭、工作、笔记本电脑）之间共享 resharper 的解决方案。

所有相关文件都位于：C:\Users[username]\AppData\Roaming\JetBrains\ReSharper 甚至 C:\Users[username]\AppData\Roaming\JetBrains\

使用名为“junction link magic”的工具，我在此文件夹上创建了一个连接点，该连接点指向我的 skydrive 同步文件夹（或保管箱）中的一个文件夹。

每个拥有 skydrive 的工作站只需指向这条路径，如下所述。这样该文件夹中的所有内容都会同步（插件！！！！）

这实际上适用于许多人的想法：Visual Studio、Sql 管理工作室和其他工具......

# gwt - GWT 编辑器框架工作不工作

> ID：15026156
> 
> 赞同：0
> 
> 时间：2013-02-22T14:15:14.017
> 
> 标签：gwt

我有一个名为 SignUpBean 的 bean，它的编辑器是 SignUpBeanEditor，下面是它的 Driver 接口。

```
public interface SignUpDriver extends SimpleBeanEditorDriver<SignUpBean, SignUpEditor>{

} 
```

以下是入口点类

```
public class Signup implements EntryPoint {
private SignUpDriver signUpDriver;
private SignUpEditor signUpEditor;
private SignUpBean signUpBean;
private VerticalPanel verticalPanel;
private Label signUpLbl;
private Button submitButton;
private Button cancelButton;
private RequestBuilder requestBuilder;
final SignUpConverter signUpConverter=GWT.create(SignUpConverter.class);
public void onModuleLoad() {
    signUpLbl = new Label("Sign Up");
    signUpDriver = GWT.create(SignUpDriver.class);

    signUpBean = new SignUpBean();
    signUpEditor = new SignUpEditor();
    submitButton = new Button("Submit");
    cancelButton = new Button("Cancel");
    signUpDriver.initialize(signUpEditor);

signUpDriver.edit(signUpBean);

    System.out.println(signUpBean.getUserName());

    submitButton.addClickHandler(new ClickHandler() {

        @Override
        public void onClick(ClickEvent event) {
        SignUpBean  signUpBeanEdited=signUpDriver.flush();
}
}
}
} 
```

`signUpBeanEdited`在 UI 中赋值后，我只得到空值。如果我`SignUpBean`使用构造函数进行初始化，那么数据也不会绑定到 UI。我的问题是我无法使用编辑器框架在 GWT UI 中绑定数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T11:07:25.820

**SignUpEditor**中声明的字段（子编辑器）应至少为**DEFAULT**范围。我猜你将它们声明为私有的。如果是这样，则生成的 Editor Impl 类无法访问字段以绑定数据。

将范围更改为至少**DEFAULT**可能会解决您的问题。

# html - pt 和 px 中的字体大小看起来总是一样吗？

> ID：15026157
> 
> 赞同：1
> 
> 时间：2013-02-22T14:15:30.607
> 
> 标签：html, fonts

“像素”总是看起来和“点”一样吗？

```
<p style="font-size: 16px;">
    pixels
</p>
<p style="font-size: 12pt;">
    points
</p> 
```

**更新：**

我知道像素和点的区别，请回答我的问题，我不需要额外的文章！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:26:58.447

答案是不。这取决于浏览器和操作系统等因素。他们必须根据您给出的点值来计算像素。问题是所有系统的 ppi（每英寸像素数）都不相同。我认为应该是 72 ppi，但在不同的平台上它是不同的，比如 96 ppi 或 80 ppi。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:31:31.383

```
Points are much like Pixels 
```

和

```
Pixels are much like Points. 
```

但这`not look Same`取决于浏览器和操作系统。

转到此**[链接](http://reeddesign.co.uk/test/points-pixels.html)**，他们提供`Approximate Conversion from Points to Pixels`

# javascript - 将 div 元素中的文本与 Raphael SVG 元素一起动画化

> ID：15026158
> 
> 赞同：1
> 
> 时间：2013-02-22T14:15:32.583
> 
> 标签：javascript, animation, html, text, raphael

我想获得一个类似按钮的对象，该对象由一个 SVG 矩形作为背景和 HTML 文本在前景中组成。Raphael SVG 库为创建、修改和动画 SVG 元素提供了很好的可能性。

我[找到了一种解决方案](https://github.com/kreynolds/RaphaelJS-Infobox)，可以在沿/在 Raphael 对象上的 DIV 元素中绘制 HTML 文本。如何使用 Raphael 的动画方法使文本随背景移动？

我只对基本的 2D 运动感兴趣，没有旋转或变形……我知道我可以使用 Raphael 支持的 SVG 文本元素，但这不允许我进行文本换行、文本样式（css）。我试图找到一种在动画过程中获取动画对象坐标的方法，但没有成功。

这是受上述 mad eby Kelley Reynolds 示例启发的咖啡脚本中的一些示例代码。我的问题是如何将背景的移动与覆盖的 div 同步：

```
nodeBox = (paper, params, attrs) ->
params = params or {}
attrs = attrs or {}
@paper = paper
@x = params.x or 0
@y = params.y or 0
@width = params.width or @paper.width
@height = params.height or @paper.height
@xMargin = params.xMargin or 5
@yMargin = params.yMargin or 5
@rounding = params.rounding or 0
@backgBox = this.paper.rect(@x-@xMargin, @y-@yMargin, @width+2*@xMargin, @height+2*@yMargin, this.rounding).attr(attrs)
containerId = @backgBox.node.parentNode.parentNode.id
containerId = containerId or @backgBox.node.parentNode.parentNode.parentNode.id
@container = jQuery('#' + containerId)

@div = jQuery('<div style="position: absolute; overflow: auto; width: 0; height: 0;"></div>').insertAfter(@container)
jQuery(document).bind('ready', this, (event) ->
    event.data.update()
    )
jQuery(window).bind('resize', this, (event) ->
    event.data.update()
    )
return this

# update function
nodeBox::update = () ->
offset = @container.offset()
@div.css(
    'top': (@y + (@rounding) + (offset.top)) + 'px',
    'left': (@x + (@rounding) + (offset.left)) + 'px',
    'height': (@height - (@rounding*2) + 'px'),
    'width': (@width - (@rounding*2) + 'px')
)

# animate function
nodeBox::animate = (attrs, duration, type) ->
    @backgBox.animate(attrs, duration, type)
    ###
    Animation of the  div ???
    ###

$(document).ready ->
paper = new Raphael document.getElementById('canvas_container'), '100%', '100%'
node1 = new nodeBox(paper, x:200, y:200, width:200, height:60, rounding: 10, xMargin: 8, yMargin: 4, 'showBorder': true).attr(fill: 'lightblue', stroke: '#3b4449', 'stroke-width': 3)
node1.div.html('This is some crazy content that goes inside of that box that will wrap around.')
node1.div.css('font-family': 'Helvetica','font-size': 16, 'text-align': 'justify')

# animate :
node1.animate({x: moveX}, 1000, 'bounce') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T17:45:09.747

所以我自己想出了这个。第一种可能性是使用 Raphael 2.x 中已经附带的 eve 库。您可以使用 eve.on() 更新与背景框坐标相对应的动画每一帧上 div 的坐标：

```
nodeBox::animate = (attrs, duration, type) ->

offset = @canvasContainer.offset()
strokeWidth = @backgBox.attrs['stroke-width']
textBox = @div
rounding = @rounding
xMargin = @xMargin
yMargin = @yMargin

### we animate the underlying box
@backgBox.animate(attrs, duration, type, eve.unbind('raphael.anim.frame.' + @backgBox.id, onAnimate))

    ### the coordinates of the div are updated on every frame
eve.on('raphael.anim.frame.' + @backgBox.id, onAnimate = (animationObject) ->
    textBox.css(
        'top': (@attrs.y + (rounding) + (yMargin) + (offset.top) + strokeWidth) + 'px',
        'left': (@attrs.x + (rounding) + (xMargin) +  (offset.left) + strokeWidth) + 'px', # scrollbar width
        'height': (@attrs.height - (rounding*2) - (yMargin*2) - strokeWidth + 'px'),
        'width': (@attrs.width - (rounding*2) - (xMargin*2) - strokeWidth + 'px')
        )
    ) 
```

这个解决方案的缺点是，感觉不是很流畅，已经可以看到“跟随”框的文本。因此，我不会尝试带有 Raphael 插件的 GreenSock 动画平台，它应该提供矢量图形和上层 DOM 的同步动画。[看看这里](http://forums.greensock.com/topic/6059-animating-raphaeljs-elements-with-v12-js/)

# c - 在 C/whatever 中使用 ffmpeg 以编程方式捕获 X11 区域

> ID：15026161
> 
> 赞同：5
> 
> 时间：2013-02-22T14:15:39.293
> 
> 标签：c, ffmpeg

ffmpeg 有一个输入格式选项——`x11grab`它允许捕获指定区域并将其输出到文件/流。我正在尝试以编程方式做同样的事情，但我还没有找到任何关于 ffmpeg API 的非基本教程/参考。

我想知道，如何使用 avformat_input_file 或类似的东西打开 x11 区域。或者我应该用 XCopyArea/etc 来做吗？

（任何编程语言都会满足）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-26T02:07:05.450

有许多应用程序可以截取屏幕截图。主要提示：它是开源的，使用源代码。如果您在 ffmpeg 中找不到代码，任何示例应用程序都可以：

[http://git.gnome.org/browse/gnome-screenshot/tree/src/screenshot-utils.c#n425](http://git.gnome.org/browse/gnome-screenshot/tree/src/screenshot-utils.c#n425)

这是 gnome-screenshot 源代码。此示例使用 gdk_get_default_root_window()。

# ios - 如何在游戏中心实现排名

> ID：15026164
> 
> 赞同：0
> 
> 时间：2013-02-22T14:15:42.823
> 
> 标签：ios, game-center

我想通过使用 Game Center 来实现排名。

所以，我是这样实现的。

```
-(void)authenticateLocalPlayer
{

    GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];

    localPlayer.authenticateHandler = ^(UIViewController *vc,NSError *err){
        [self setLastError:err];
        if ([CCDirector sharedDirector].isPaused){
            [[CCDirector sharedDirector] resume];
        }
        if (localPlayer.authenticated){
            _gameCenterFeaturesEnabled = YES;

            // get localplayer's score.
            GKLeaderboard *board = [[GKLeaderboard alloc] init];

            // make a query

            board.timeScope = GKLeaderboardTimeScopeAllTime;
            // I want to get all player's score.
            board.playerScope = GKLeaderboardTimeScopeToday;

            // set my game category.
            board.category = @"com.nobinobiru.shooting";

            // I want to show top 3 score data.
            board.range = NSMakeRange(1, 3);

            [board loadScoresWithCompletionHandler:^(NSArray *scores, NSError *error) {
                NSString *s = [NSString stringWithFormat:@"%lld",board.localPlayerScore.value];
                [ud setObject:[NSString stringWithFormat:@"%@",s] forKey:@"bestScore"];
                if (scores){
                    // I want to 3 items but it returned only 1 item.
                    NSLog(@"score is %@",scores);
                }

            }];

        }else if (vc){
            [[CCDirector sharedDirector] pause];
            [self presentViewController:vc];
        }

    };
} 
```

然后，我创建了 3 个沙盒的用户帐户，并对其进行了测试。但它总是只显示当前用户的最好成绩。

我想显示 3 个沙盒的数据。

我不知道为什么会这样。我的代码在非沙箱环境中运行良好？你有什么主意吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T08:16:05.303

全部。6小时后完美运行...

我认为发生这种情况的原因是我创建的游戏中心帐户没有立即反映。

# mysql - 为什么mysql在子查询的组连接上返回错误？

> ID：15026165
> 
> 赞同：1
> 
> 时间：2013-02-22T14:15:50.410
> 
> 标签：mysql, sql

我`Subquery returns more than 1 row`在这个查询上有 mysql 错误`GROUP_CONCAT`。为什么我会出现此错误以及如何解决此问题？

```
 select SQL_CALC_FOUND_ROWS s.url, 
        GROUP_CONCAT(
        (select name 
             from labels_data ld, 
                  labels l 
             where ld.id=l.site_id=s.id 
         limit 2),
        ', '),
 ... more valid sql code ...
 as labels from sites s 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:17:03.640

您需要将 放入`group_concat`子查询中。*子*查询返回多于一行（至少正常情况下）。它有一个`limit 2`.

```
 (select group_concat(name , ', ')
    from labels_data ld join
         labels l 
         on ld.id=l.site_id=s.id 
    limit 2
  ) 
```

我还建议您使用正确的 ANSI 连接语法。

# android - Android项目突然崩溃，找不到R对象

> ID：15026167
> 
> 赞同：0
> 
> 时间：2013-02-22T14:15:56.080
> 
> 标签：android

R 无法解析为变量。所以我尝试做“修复项目设置”，但它无法识别其所有子内容，例如来自 my `xml`, `R.id.X`,的对象`R.drawable.Y`，它们都没有被识别。

我只是尝试遵循[http://developer.android.com/guide/topics/ui/controls/pickers.html](http://developer.android.com/guide/topics/ui/controls/pickers.html)指南并添加此类以有一个选择时间的对话框。

```
 Description Resource    Path    Location    Type
users cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 170    Java Problem
ic_launcher cannot be resolved or is not a field    MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 159    Java Problem
about cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 136    Java Problem
menu_user cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 133    Java Problem
imp_logo cannot be resolved or is not a field   MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 198    Java Problem
activity_main cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 44 Java Problem
timerCB cannot be resolved or is not a field    MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 64 Java Problem
timerTime cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 65 Java Problem
statusText cannot be resolved or is not a field MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 66 Java Problem
timerText cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 67 Java Problem
start_button cannot be resolved or is not a field   MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 68 Java Problem
stop_button cannot be resolved or is not a field    MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 69 Java Problem
activity_main cannot be resolved or is not a field  MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 123    Java Problem
menu_url cannot be resolved or is not a field   MainActivity.java   /RemoteSwitch/src/com/example/remoteswitch  line 130    Java Problem 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-27T10:42:18.547

只需删除即可`import android.R`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T14:17:54.193

做**项目-> 清洁**几次。

然后**构建**项目。

如果您仍然无法`R.java`在`gen`文件夹中找到，请检查您的文件中是否有任何错误`layout`，例如检查您的所有`xml files`和`drawables`是否仅以小写字母命名。

删除这些错误后，再次清理并构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T14:22:00.650

*   通过选择*Project - Clean来清理项目*
*   如果`R.java`没有创建，删除gen文件夹，然后手动重新创建，右键，*Build Path-用作源文件夹*，重建项目
*   如果`R.java`仍然不存在，则您的某些 XML 文件可能包含错误，请检查
*   如果您的项目的来源是 svn 存储库，则可能存在一些编译器无法识别的不可见配置文件。右键你的项目-*属性-资源-资源过滤器-添加-排除所有-文件和文件夹-名称匹配.svn*
*   如果您下载并导入了项目，请检查目标（SDK）并确保您已安装所需的软件包。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T14:24:51.070

上面的答案清楚地说明了这一点。看看你的布局文件和我的提示：当我用 strings.xml 文件填充时，我发现在那里复制一些颜色时，我用标签关闭了标签。这是很容易被忽视的事情，我打算编写一个检测到这一点的类，因为显然这不会很快得到修复（通过修复我的意思是至少给我们一个通知）。

# entity-framework - 过滤自引用实体中的子项

> ID：15026174
> 
> 赞同：0
> 
> 时间：2013-02-22T14:16:11.027
> 
> 标签：entity-framework

我有这个评论模型，每个评论都可以是其他评论的答案。

```
 public class Comment
 {
    public virtual int Id { get; set; }
    public virtual string Body { get; set; }
    public virtual DateTime? AddedDate { get; set; }
    public virtual bool IsApproved { get; set; }
    public virtual int LikeCount { get; set; }
    public virtual User User { get; set; }
    public virtual AnonymousUser AnonymousUser { get; set; }
    public virtual Post Post { get; set; }
    public virtual Page Page { get; set; }
    public virtual int? ParentId { get; set; }
    public virtual Comment Parent { get; set; }
    public ICollection<Comment> Children { get; set; }
    public virtual byte[] RowVersion { get; set; }
 } 
```

我尝试使用此代码来获取“IsApproved==true”的评论

```
this._comments
            .Where(comment => comment.Post.Id == postId).Include(comment => comment.User)
            .Include(comment => comment.AnonymousUser)
            .Include(comment => comment.Children).Where(comment => comment.IsApproved == true)
            .OrderBy(comment => comment.AddedDate)
            .Skip(page * count)
            .Take(count).ToList()
            .Where(comment => comment.Parent == null).ToList(); 
```

但是这个查询只返回“IsApproved==true”的**根**注释。

我应该怎么做才能过滤所有评论，甚至是孩子。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:27:00.597

通过子项过滤时尝试 Any。

```
this._comments
            .Where(comment => comment.Post.Id == postId).Include(comment => comment.User)
            .Include(comment => comment.AnnonymousUser)
            .Where(comment => comment.Children.Any(child=>child.IsApproved == true))
            .OrderBy(comment => comment.AddedDate)
            .Skip(page * count)
            .Take(count).ToList()
            .Where(comment => comment.Parent == null).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:40:30.913

由于`.Where(comment => comment.Parent == null)`.

但总的来说...

如果我对您的理解正确，您希望在平面列表中获得所有已批准且在特定帖子下的评论（包括子评论），对吗？

假设：每条评论都填充了帖子 - 甚至是儿童。

```
this._comments
        .Include(comment => comment.User)
        .Include(comment => comment.AnnonymousUser)
        .Include(comment => comment.Children)
        .Where(comment => comment.IsApproved && comment.Post.Id == postId)
        .OrderBy(comment => comment.AddedDate)
        .Skip(page * count)
        .Take(count)
        .ToList(); 
```

编辑：

或者，如果您只想过滤已批准的子项，请查看这篇文章[http://msdn.microsoft.com/en-us/data/jj574232.aspx ，](http://msdn.microsoft.com/en-us/data/jj574232.aspx)**在显式加载相关实体时应用过滤器**部分

# c# - 在 C# 中使用 itextsharp 创建 PDF 文件

> ID：15026177
> 
> 赞同：0
> 
> 时间：2013-02-22T14:16:34.810
> 
> 标签：c#, .net, pdf, itextsharp

我需要创建 PDF 文件，其中使用左侧、右侧和顶部的边距在页面上画线。但是在这里，由于这个原因造成的混乱，这些边距的计算是以像素值计算的。那么，如何通过像素值的边距设置画线呢？

示例代码如下：

```
 PdfContentByte contentByte = writer.DirectContent;
        contentByte.SetLineWidth(1);
        float x1, y1, x2, y2;
        x1 = myDocument.PageSize.Width - 84;
        x2 = myDocument.PageSize.Width - 36;
        y1 = myDocument.PageSize.Height - 56;
        y2 = myDocument.PageSize.Height - 56;
        contentByte.MoveTo(x1, y1);
        contentByte.LineTo(x2, y2);
        contentByte.Stroke(); 
```

实际上，我想绘制宽度为 48 的线，其右边距为 36px，上边距为 36px。

有什么想法来计算它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:25:52.283

试试这个方法：

```
string pdfpath = Server.MapPath("PDFs");
  Document doc = new Document();
  try
  {
    PdfWriter writer = PdfWriter.GetInstance(doc, new FileStream(pdfpath + "/Graphics.pdf", FileMode.Create));
    doc.Open();
    PdfContentByte cb = writer.DirectContent;
    ... 
```

现在我们有了一个工作的 PdfContentByte 对象，我们可以使用它开始绘制：

```
cb.MoveTo(doc.PageSize.Width / 2, doc.PageSize.Height / 2);
cb.LineTo(doc.PageSize.Width / 2, doc.PageSize.Height);
cb.Stroke();
cb.MoveTo(0, doc.PageSize.Height/2);
cb.LineTo(doc.PageSize.Width, doc.PageSize.Height / 2);
cb.Stroke(); 
```

从[这里取](http://www.mikesdotnetting.com/Article/88/iTextSharp-Drawing-shapes-and-Graphics)

# python - pil 用不同的颜色绘制文本

> ID：15026178
> 
> 赞同：13
> 
> 时间：2013-02-22T14:16:43.483
> 
> 标签：python, text, python-imaging-library, draw

嗨，用不同的选项绘制三个不同的文本：

1.  text-number-1 ，字体=arial，颜色=红色
2.  text-number-2 ，字体=阳台，颜色=蓝色，大小=30
3.  text-number-3 , font=tahoma, color=green, size=40 , align=center

文本必须换行。

```
def pil_image(request):
text = request.GET.get('text', None)
font = str(request.GET.get('font', 'arial'))
fontsize = int(request.GET.get('fontsize', '20'))
textcolor = str(request.GET.get('textcolor', '000'))

import Image, ImageDraw, ImageFont, textwrap

img = Image.open('media/text/transparent.png')
img = img.convert("RGBA")
datas = img.getdata()
w, h = img.size

newData = []
for item in datas:
    if item[0] == 255 and item[1] == 255 and item[2] == 255:
        newData.append((255, 255, 255, 0))
    else:
        newData.append(item)

img.putdata(newData)

draw = ImageDraw.Draw(img)
font = ImageFont.truetype("media/text/fonts/" + font + ".ttf", fontsize, encoding="unic")

margin = offset = 40
for line in textwrap.wrap(text, width=48):
    w, h = draw.textsize(line)
    draw.text((margin, offset), line, font=font, fill='#'+textcolor)
    offset += font.getsize(line)[1]

del draw 

img.save("media/text/custom.png", "PNG")

return HttpResponse("<img src='/media/text/custom.png'>"); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-22T15:00:12.237

“填充”参数应该是一个有 4 个数字的元组，因为您使用的是 RGBA 颜色模式。

对于不透明的红色：

```
draw.text((margin, offset), line, font=font, fill=(255,0,0,255) ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-05-08T12:27:09.980

使用十六进制值作为颜色，如下所示：

```
draw.text((margin, offset), line, font=font, fill="#000") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-29T10:31:53.260

只需这样做

```
# thicker border
draw.text((x-1, y-1), text, font=font, fill=shadowcolor)
draw.text((x+1, y-1), text, font=font, fill=shadowcolor)
draw.text((x-1, y+1), text, font=font, fill=shadowcolor)
draw.text((x+1, y+1), text, font=font, fill=shadowcolor) 
```

# javascript - 带有可移动画笔覆盖的 IE8 友好条形图？

> ID：15026181
> 
> 赞同：1
> 
> 时间：2013-02-22T14:16:58.680
> 
> 标签：javascript, d3.js, raphael, visualization, brush

我正在寻找一个可以生成如下内容的图表库：

![在此处输入图像描述](../Images/0d002c53fe8f08ff5549f0ee8bb2bca2.png)

换句话说，一个动态生成的条形图，带有可移动的画笔覆盖 - 用户应该能够通过单击和拖动来移动范围，并且该事件应该返回画笔的新限制。

我知道如何在[D3.js 中使用画笔覆盖](http://bl.ocks.org/mbostock/1667367)来做到这一点，但我需要使用对 IE8 友好的 JavaScript 库。

有没有人遇到过任何使用 IE8 友好库的示例——例如 Raphael？

# linux - 是否可以从 -L 标志中命名“屏幕”日志文件？

> ID：15026184
> 
> 赞同：32
> 
> 时间：2013-02-22T14:17:06.347
> 
> 标签：linux, logging, gnu-screen

在使用 -L 标志运行[Screen](https://en.wikipedia.org/wiki/GNU_Screen)时，会创建一个名为“screenlog.0”的文件并将所有输出写入其中（这很棒），但我将运行多个 Screen 会话，我需要使用唯一编号识别日志. 是否可以更改日志文件名？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2018-06-01T22:46:51.913

可能最简单的方法是使用以下方法：

```
screen -L -Logfile log_filename your_command 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-02-22T14:19:07.867

您可以编辑`.screenrc`文件并添加如下内容：

> 日志文件 /tmp/myownlog

它也在*[为屏幕输出指定日志名称而不依赖于 .screenrc](https://serverfault.com/questions/248193/specifying-a-log-name-for-screen-output-without-relying-on-screenrc)*中得到回答。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-06-21T17:47:26.123

或者，有一种交互方式。

`Ctrl`通过+进入 Screen 中的命令模式`a`，`:`并使用`logfile`您想要的文件名作为参数的命令，例如：

```
logfile whatevernameyoulike.log 
```

然后输入`Ctrl`+ `a`,`H`开始录制到您刚刚输入的文件名。

来源：[屏幕手册页](https://linux.die.net/man/1/screen)

# ruby-on-rails-3 - 在哪里初始化 Dalli::Client

> ID：15026188
> 
> 赞同：1
> 
> 时间：2013-02-22T14:17:15.463
> 
> 标签：ruby-on-rails-3, memcached, dalli

我刚刚开始使用 Dalli gem 进行内存缓存。

我只是想知道如果我想从缓存中获取一些数据或者我可以声明一个可以重用的单例，我是否需要在每个请求中创建一个 Dalli::Client 的实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-19T05:47:53.080

在你的`config/environments/production.rb`：

> config.cache_store = :dalli_store
> config.cache_store = :dalli_store, 'cache-1.example.com', { :namespace => NAME_OF_RAILS_APP, :expires_in => 1.day, :compress => true }

# java - 在文件上传期间从一个 JSP 获取标签值到另一个 JSP

> ID：15026192
> 
> 赞同：0
> 
> 时间：2013-02-22T14:17:26.363
> 
> 标签：java, html, forms, jsp

我的项目概念是将文件上传到数据库。下面的代码工作正常，但问题是我无法`<select>` 从一页到另一页获取值，它总是显示`null`值。

如何`<select>`在文件上传期间将元素值从一个 JSP 获取到另一个 JSP？

```
 <FORM ENCTYPE="multipart/form-data" ACTION="upload_page.jsp" METHOD=POST>
       <center>
       <table border="0" bgcolor=#ccFDDEE>
       <tr><center><td colspan="2" align="center"><B>UPLOAD THE FILE</B>
      <center></td></tr>
       <tr><td colspan="2" align="center"> </td></tr>
       <tr><td><b>Choose the file To Upload:</b></td><td><INPUT NAME="file" TYPE="file"> </td></tr>
       <tr><td colspan="2" align="center"> </td></tr>
       <tr><td colspan="2" align="center"><input type="submit" value="Send File">            </td></tr>
       <tr>
       <td>
       <select name="t1">
      <option value="mars">Mars</option>
      <option value="moon">Moon</option>
      <option value="sun">Sun</option>
      <option value="earth">Earth</option>
      </select>
      </td>

******** 
<% String s1=request.getParameter("t1"); System.out.println(s1); 
******** 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:35:42.820

您正在以`multipart/form-data`编码形式提交表单。这与默认使用的默认`application/x-www-form-urlencoded`编码`getParameterXxx()`方法不同。它们都会返回`null`，`multipart/form-data`因为`multipart/form-data`默认情况下不支持。

基本上，您需要使用与当前用于提取上传文件的 API 完全相同的 API 来提取常规表单字段。通常这是 Apache Commons FileUpload，所以我假设您也在使用它。您应该在某个地方进行`if (!fileItem.isFormField())`检查以获取文件字段。您需要挂钩`else`以获取正常的表单字段。

或者，如果您已经使用 Servlet 3.0，请将表单提交到带有`@MultipartConfig`注释的普通 servlet 并使用`getPart()`方法获取文件字段，您可以继续使用`getParameterXxx()`方法获取普通表单字段。

### 也可以看看：

*   [如何使用 JSP/Servlet 将文件上传到服务器？](https://stackoverflow.com/questions/2422468/how-to-upload-files-to-server-using-jsp-servlet/2424824#2424824)

* * *

**与具体问题无关**，使用 90 年代风格的大写 HTML 标记/属性名称并使用自 1998 年以来已弃用的`<center>`元素并使用 HTML 表格元素的不鼓励样式属性而不是 CSS 并没有给我这样的印象，即您正在学习基于正确的 HTML和最新的资源。确保您正在这样做。此外，十年来，将表单提交给 JSP 并使用*scriptlet*是[不受欢迎](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)的。确保您还阅读了健全的 JSP 资源。

# performance - 在 OSX 10.8.2 上的 safari 6.02 中网站加载速度非常慢

> ID：15026194
> 
> 赞同：2
> 
> 时间：2013-02-22T14:17:33.007
> 
> 标签：performance, safari, webpage

我正在为客户开发一个网站，我只是在我能想到的每个浏览器中对其进行了测试。网站几乎所有浏览器都能在 2 秒内正常加载。但由于某些原因，在 Safari 中加载该网站需要将近 20 秒。

我在 OSX 10.8.2 上使用 Safari 6.02 进行测试

[编辑] 网站地址已删除，因为它是一个开发服务器，请查看答案以获得有关该问题的演示的永久链接。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T10:36:53.047

原来是 css property: text-shadow 导致了我所有的问题。

这个网站的设计师在一些文本周围使用了一些粉红色的光芒，所以我在四个地方使用了这样的规则：

```
text-shadow: 
  0 0 10px rgba(60,3,64, 0.6), 
  0 0 20px rgba(60,3,64, 0.6), 
  0 0 30px rgba(60,3,64, 0.6), 
  0 0 40px rgba(60,3,64, 0.6), 
  0 0 70px rgba(60,3,64, 0.6), 
  0 0 80px rgba(60,3,64, 0.6), 
  0 0 100px rgba(60,3,64, 0.6), 
  0 0 150px rgba(60,3,64, 0.6); 
```

现在文本阴影工作正常，并且在几乎所有现代浏览器中看起来都相当不错，但它确实让 safari 6 缓慢地前进。事实上，在 iPad 上，它几乎使浏览器崩溃。客户抱怨说它也使他的 iMac 上的浏览​​器崩溃（尽管我没有能够复制这种行为，因为我没有 iMac）。

好的，所以我构建了一个演示，向其他人展示我在说什么：

[http://www.waspdigital.com/demo/text-shadow-on](http://www.waspdigital.com/demo/text-shadow-on) 和 [http://www.waspdigital.com/demo/text-shadow-off](http://www.waspdigital.com/demo/text-shadow-off)

请访问最新版本的 safari 中的两个链接，您会看到我在说什么。

# javascript - 解析配置文件值

> ID：15026195
> 
> 赞同：0
> 
> 时间：2013-02-22T14:17:33.447
> 
> 标签：javascript, regex, configuration-files

我有这个格式的配置文件：

```
ALPHA=123456789
BETA=12345
GAMMA=123467 
```

我想用正则表达式只获取 BETA 的数值（所以 12345）。我试过了

```
BETA=[^a-zA-Z0-9]+([0-9]+) 
```

但它不起作用。有什么建议么？

编辑：我将它与 JavaScript 一起使用。我正在写一个肉桂扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:19:38.693

你只需要这样：

```
BETA=(\d+) 
```

（与 相同`BETA=([0-9]+)`）

为了只获取数字部分，请使用您的语言获取第一个捕获组的方法（例如，在 Perl 中，`$1`成功匹配后将包含结果）。

您的正则表达式 ( `BETA=[^a-zA-Z0-9]+([0-9]+)`) 搜索 BETA=，然后是至少一个不是字母或数字的字符，然后是一个或多个数字。

这失败了，因为等号后没有“至少一个不是字母或数字的字符”。

# ios - 适用于 iOS 和 Storyboard 的 Scandit sdk（条形码阅读器）

> ID：15026198
> 
> 赞同：1
> 
> 时间：2013-02-22T14:17:44.583
> 
> 标签：ios, barcode, barcode-scanner

我下载了他们的 sdk 进行测试。

我阅读了他们的 sdk 提供的示例代码（和文档），我有一个问题：请你告诉我如何在带有故事板的 iOS 项目中使用条形码阅读器？

我有一个 iPad 应用程序，它带有一个带有多个选项卡的选项卡栏，以及在情节提要中定义的 navigationControllers。

我想（通过情节提要）添加一个 uiviewcontroller，它将包含一个阅读器视图（并且在同一个选项卡中具有阅读器视图、导航栏和 tabBar）。

你能帮助我吗 ？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T23:30:48.073

您要执行的操作相当容易。为您的视图控制器创建一个新类，然后按照网站上的说明[将 API 集成](http://www.scandit.com/support/getting-started-with-scandit-sdk-for-ios/)到您的应用程序中。在 iPhone 上，这很容易做到。我为我的应用程序的 iPad 版本创建了一个自定义界面，该界面使用了一个弹出框控制器，它需要做一些工作来创建弹出框，但是一旦你在自定义类中添加它就像在 Storyboard 中的任何其他内容一样。

# php - 为 Wordpress Starkers 主题创建菜单

> ID：15026199
> 
> 赞同：0
> 
> 时间：2013-02-22T14:17:47.813
> 
> 标签：php, wordpress

我对 Wordpress 还很陌生。我正在使用“裸体”斯塔克斯主题。这真是太棒了。 [http://starkers.viewportindustries.com/](http://starkers.viewportindustries.com/)

我唯一没有得到的是添加菜单或小部件。它说主题不支持自定义菜单。

主题也没有侧边栏。我是否必须在代码中添加一些内容才能使其正常工作？

也许有人熟悉 Starkers 主题并且可以将我引向正确的方向。非常感谢你。如果这是一个愚蠢的问题，我很抱歉。

这是代码：

```
 <?php Starkers_Utilities::get_template_parts( array( 'parts/shared/html-header',      'parts/shared/header' ) ); ?>

  <?php if ( have_posts() ) while ( have_posts() ) : the_post(); ?>
  <h2><?php the_title(); ?></h2>
  <?php the_content(); ?>
  <?php comments_template( '', true ); ?>
  <?php endwhile; ?>

  <?php Starkers_Utilities::get_template_parts( array(    'parts/shared/footer','parts/shared/html-footer' ) ); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:30:25.303

将以下代码添加到您的**functions.php**文件中以支持您的主题菜单：

```
register_nav_menu('primary', __('Primary Menu', 'rs')); 
```

并将此代码添加到**functions.php**文件中以将侧边栏添加到您的主题中。

```
if ( function_exists('register_sidebar') )
    register_sidebar(); 
```

# android - 如何让蓝牙适配器始终可发现？

> ID：15026201
> 
> 赞同：1
> 
> 时间：2013-02-22T14:17:50.527
> 
> 标签：android, bluetooth, dongle, discoverability

我有点不确定在哪里发布这个问题，所以如果有人认为我在错误的地方并且知道我应该在哪里发布它，你能指出我正确的方向吗？非常感激 ：）

继续我的问题，我正在开展一个项目，该项目允许通过在一些房间（笔记本电脑或 USB 插头等）周围放置 USB 蓝牙加密狗并将他们的信息保存在数据库中来跟踪建筑物内的人的位置。然后，使用 Android 手机，我希望能够在我随身携带设备时发现这些设备，然后使用最近的 3 计算位置。

我遇到的问题是我的 Android 设备不会发现我已插入各种笔记本电脑的加密狗，除非我将它们设置为“接收文件”，即可发现（我假设）。有谁知道是否可以将它们设置为始终可见或将其设置为默认设置以便我可以将其插入插座？如果这不是一个选项，是否可以在它们未设置为可发现时找到最近的加密狗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:20:46.853

这可能需要本机应用程序来执行此操作。基本操作系统中没有此设置。但据我所知，您应该能够通过蓝牙 API 调用发现过程。

# c# - C# 下载延迟

> ID：15026202
> 
> 赞同：0
> 
> 时间：2013-02-22T14:17:51.697
> 
> 标签：c#, winforms, download, lag

我有一个严重的问题。我目前正在做一个补丁程序。
程序中有一个“补丁”按钮，如果用户点击它，下载就开始了。
目前该程序需要下载 5 个文件。下载是正确的，这部分程序正在运行，但是当我点击补丁按钮时，程序开始滞后，我无法关闭，或者改变它的位置。这是代码：

private void button1_Click(object sender, EventArgs e) { Thread thread = new Thread(new ThreadStart(this.download)); 线程.Start(); }

```
 public void download()
    {
        int downloaded = 0;
        int all = 5;
        WebClient myWebClient = new WebClient();

        if (button1.InvokeRequired)
        {
            MethodInvoker MethodControll = new MethodInvoker(download);
            this.button1.Invoke(MethodControll);
        }
        else
        {

            double state;
            jelenlegidownload.Text = "alut.dll";
            myWebClient.DownloadFile(Files.alutDLL, "alut.dll");
            downloaded++;
            state = downloaded / all * 100;
            progressBar.Value = Convert.ToInt32(state);
            progressBar.Refresh();
            this.Refresh();  

            jelenlegidownload.Text = "BlackBox.dll";
            myWebClient.DownloadFile(Files.BlackBoxDLL, "BlackBox.dll");
            downloaded++;
            state = downloaded / all * 100;
            progressBar.Value = Convert.ToInt32(state);
            progressBar.Refresh();
            this.Refresh();

            jelenlegidownload.Text = "DevIL.dll";
            myWebClient.DownloadFile(Files.DevILDLL, "DevIL.dll");
            downloaded++;
            state = downloaded / all * 100;
            progressBar.Value = Convert.ToInt32(state);
            progressBar.Refresh();
            this.Refresh();

            jelenlegidownload.Text = "fltkdll.dll";
            myWebClient.DownloadFile(Files.fltkdllDLL, "fltkdll.dll");
            downloaded++;
            state = downloaded / all * 100;
            progressBar.Value = Convert.ToInt32(state);
            progressBar.Refresh();
            this.Refresh();

            jelenlegidownload.Text = "glut32.dll";
            myWebClient.DownloadFile(Files.glut32DLL, "glut32.dll");
            downloaded++;
            state = downloaded / all * 100;
            progressBar.Value = Convert.ToInt32(state);
            progressBar.Refresh();
            this.Refresh(); 
```

文件.cs：

```
public class Files
{
    public static string alutDLL = "https://dl.dropbox.com/s/62tt9w194xefk7t/alut.dll?token_hash=AAHQmybYdR44TRrS9bWQWV7jlZBzZQ-mmmjNy1Kv_qR4cg&amp;dl=1";
    public static string BlackBoxDLL = "https://dl.dropbox.com/s/vtdrl8qdpky8p08/BlackBox.dll?token_hash=AAHCtQPBJ5s-3aL5B4FqrmOUIGP6BVvW8ZQeWd-xBzysTw&dl=1";
    public static string DevILDLL = "https://dl.dropbox.com/s/spni307vmk4zng9/DevIL.dll?token_hash=AAEmZdQj3dv2NIEh6tcWwkgyJHCytSsX65QXZyNGY2Vl1w&dl=1";
    public static string fltkdllDLL = "https://dl.dropbox.com/s/fsa29pelfwgk5ha/fltkdll.dll?token_hash=AAF55SuU_8bfli5gIiPpA-VLWUmZKLbOK-Ys8iokuJ8_XA&dl=1";
    public static string glut32DLL = "https://dl.dropbox.com/s/cptiwxv17nhtywp/glut32.dll?token_hash=AAGCNXQPpwrByjp-uG_avBbkNyNjTfOJFxbY3ieNAfLzVw&dl=1";
} 
```

我该如何解决滞后问题？（正如我之前所说，如果我点击“补丁”按钮，文件正在下载，但程序“停止”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:19:42.700

要停止应用程序的下载部分以阻止应用程序的 UI 部分，为什么不在不同的线程上执行下载工作。这样，即使下载尚未完成，您的 UI 仍会响应。

编辑：我认为这是一篇适用于您的案例的好文章：

[http://www.developerfusion.com/article/4134/net-threading-part-i/](http://www.developerfusion.com/article/4134/net-threading-part-i/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:25:38.790

我想你误会了`InvokeRequired`。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired.aspx)：

> 获取一个值，该值指示调用者在对控件进行方法调用时是否必须调用调用方法，因为调用者位于与创建控件的线程不同的线程上。

基本上，您在另一个线程上开始下载。但是由于这将导致`InvokeRequired`为真，您可以回忆一下 GUI 线程上的方法，锁定应用程序。

如果删除此部分会更好吗？

```
 if (button1.InvokeRequired)
    {
        MethodInvoker MethodControll = new MethodInvoker(download);
        this.button1.Invoke(MethodControll);
    } 
```

**更新** 要排除您在进度条上做错了什么，请尝试将您的下载方法简化为：

```
public void download()
{
    WebClient myWebClient = new WebClient();

    myWebClient.DownloadFile(Files.alutDLL, "alut.dll");
    myWebClient.DownloadFile(Files.BlackBoxDLL, "BlackBox.dll");
    myWebClient.DownloadFile(Files.DevILDLL, "DevIL.dll");
    myWebClient.DownloadFile(Files.fltkdllDLL, "fltkdll.dll");
    myWebClient.DownloadFile(Files.glut32DLL, "glut32.dll");
} 
```

这*应该*使文件下载没有延迟，但您希望在进度栏中看到任何更新（显然）。

# svn - 如何获取 SVN 存储库的先前修订号？

> ID：15026204
> 
> 赞同：0
> 
> 时间：2013-02-22T14:17:53.863
> 
> 标签：svn, powershell

我计划创建一个 Powershell 脚本来检测多个 svn 存储库中的更改，然后对每个存储库执行一些操作，例如复制更改的文件或将整个存储库复制到构建站点。

我有一个简单的函数来获取最新版本的存储库：

```
function Get-SvnRevision($dir=".")
{
    ([xml](svn info $dir --xml)).info.entry.revision
} 
```

我的想法是，一旦我得到当前的修订号，将它与之前的修订号进行比较，如果它们不一样，然后执行上面提到的一些操作。

我如何获得以前的修订号，以便我可以将其与最新的版本号进行比较，然后进行一些操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:51:30.247

我会建议从另一边移动：使用[提交后挂钩](http://svnbook.red-bean.com/en/1.7/svn.ref.reposhooks.post-commit.html)

*   它在每次提交后自动触发
*   它可以是任何代码（也可以是Powershell），可以由服务器的操作系统执行
*   Subversion 将所有需要的（用于`svnlook`脚本中的子命令）详细信息（repo 的路径 + 修订 ID）作为参数传递给脚本

# excel - VBA：使用正确的日期格式

> ID：15026207
> 
> 赞同：-2
> 
> 时间：2013-02-22T14:17:57.150
> 
> 标签：excel, vba

我填充日期的单元格很少，后来我将它们用于计算（减法），所以告诉我在这里使用哪种日期格式比较好。这应该适用于所有区域语言和所有日期分隔符，如“-”、“/”、“.”。示例 - 12.1.2013。

我试过 - //Format 和 Formatdatetime 函数

请给我一些答案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T10:00:42.040

对于通用日期，我会按照我的偏好推荐三个日期之一：

1.  `01-FEB-2013`, 作为一种格式`dd-mmm-yyyy`
2.  `20130201`, 作为格式`yyyymmdd`
3.  `01022013`, 作为一种格式`ddmmyyyy`

# c# - Mongo C# 继承列表

> ID：15026213
> 
> 赞同：0
> 
> 时间：2013-02-22T14:18:13.210
> 
> 标签：c#, list, mongodb

我有一个类 (a)，它继承了 (b) 的列表。

```
public class a : List<b>
{

} 
```

现在，当我尝试将此类的对象保存到 Mongo 时，出现错误。

> 序列化器 EnumerableSerializer<b> 期望 ArraySerializationOptions 类型的序列化选项，而不是 DocumentSerializationOptions。

你有没有遇到过这样的事情，如果有人能提供一些启示，那就太好了。我在文档或网上找不到太多关于此的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T15:45:55.667

保存到 MongoDB 的顶级文档不能是列表，它必须是一个类。它还必须有一个 Id 字段。所以你可以做这样的事情：

```
public class C
{
    public ObjectId Id { get; set; }
    public A List { get; set; }
}

public class A : List<B>
{
} 
```

您在文档中封装了类型 A 的列表（在本例中为类型 C）。

但是，如果您决定保留 A 类型的类，请小心。如果向 A 类添加自定义属性，则必须编写自定义序列化程序以确保您添加的自定义值与列表值一起正确序列化。看：

[https://jira.mongodb.org/browse/CSHARP-460](https://jira.mongodb.org/browse/CSHARP-460)

# php - symfony2 学说在不创建完整结果数组的情况下获取

> ID：15026220
> 
> 赞同：2
> 
> 时间：2013-02-22T14:18:40.050
> 
> 标签：php, arrays, symfony, csv, doctrine

我希望使用学说导出到 csv 文件。但是，数据可能非常大。因此我不想将结果输出到一个完整的数组。我想迭代地遍历结果。

我试过看这里的 [学说文档](http://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/data-retrieval-and-manipulation.html)

**PHP 看起来像这样**

```
 $result = mysql_query("SELECT * FROM bigtable");
    while($row = mysql_fetch_assoc($result)) {
        // do code iteratively here
    } 
```

不知道你如何在 symfony2 的教义中做同样的事情

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T14:30:57.273

[这是来自关于批处理的原则文档](http://doctrine-orm.readthedocs.org/en/2.0.x/reference/batch-processing.html)：

```
$q = $this->_em->createQuery('select u from MyProject\Model\User u');
$iterableResult = $q->iterate();
foreach ($iterableResult AS $row) {
    // do stuff with the data in the row, $row[0] is always the object

    // detach from Doctrine, so that it can be Garbage-Collected immediately
    $this->_em->detach($row[0]);
} 
```

`'select u ....`相当于你的`SELECT * ...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:31:04.133

```
$result = mysql_query("SELECT * FROM bigtable");
while($row = mysql_fetch_assoc($result)) {
    // do code iteratively here
} 
```

是**Flat PHP**和 symfony2/doctrine 旨在避免它。[http://symfony.com/doc/2.0/book/from_flat_php_to_symfony2.html](http://symfony.com/doc/2.0/book/from_flat_php_to_symfony2.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T10:01:26.600

对 Dirk 表示敬意，他的回答是正确的。如果您想迭代整个实体模型，那么这就是要走的路。有时您可能没有返回的 sql 结果的模型映射设置。如果您想通过原始 sql 文件执行此操作，那么我就是这样做的。我很想听听更多的想法。

您通过控制器将教义连接传递给类

**控制器**

```
function indexAction(){
    $className = new ClassName($this->getDoctrine()->getEntityManager());
} 
```

然后，您可以创建原始 sql 查找

**实体**

```
function __construct($entity){
    $this->connection = $entity->getConnection();
}

function saveToCSV
{
    $stmt = $this->connection->prepare("SELECT * FROM bitTableExample ");
    $stmt->execute();

    while($row = $stmt->fetch()){
        // append to csv file
    }
} 
```

# python - 如何用南（django）处理重构？

> ID：15026230
> 
> 赞同：2
> 
> 时间：2013-02-22T14:19:13.543
> 
> 标签：python, database, django, migration, django-south

我已经安装了南并进行了一些迁移。现在文件夹应用程序中有一个“迁移”目录。我的问题是：当我重构模型时，迁移目录文件中的哪些条目必须应用更改？我认为有些条目与数据库模式直接相关，而另一些则与代码本身相关。我无法在南方文档中找到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:28:39.160

对模型进行更改，然后运行`python manage.py schemamigration yourapp --auto`。这将为您创建迁移（每次执行此过程时，您都会在迁移目录中看到一个新文件）。

有时您确实需要手动编辑迁移，但您应该尽量避免它。特别是如果您已经运行了迁移（南方应用程序会记录已运行的迁移，以便了解数据库的状态）。

South 旨在支持在不破坏数据库的情况下在不同版本的代码之间移动。migrations 目录中的每个迁移文件都代表您的代码的快照（特别是您的`models.py`. 您通过运行从一个版本迁移到另一个版本`python manage.py migrate yourapp version_no`

# java - JSON解析。位置 2 的意外字符 (t)。JAVA

> ID：15026233
> 
> 赞同：0
> 
> 时间：2013-02-22T14:19:30.800
> 
> 标签：java, json, parsing

我正在尝试从谷歌地图搜索中解析 JSON 数据。我已经尝试过 JACKSON，现在我正在尝试 JSON SIMPLE。他们都给出了同样的错误。

首先，我正在谷歌地图上进行搜索。

```
String urlString = "http://maps.google.com/maps?f=q&source=s_q&output=json&start=0&q="+ "Stockholm" + "+Gym"; 
```

给我 JSON while(1);{title:"stockholm Gym - Google Maps",url:"/maps?f=q\x26source=s_q\x26start=0\x26q=stockholm+Gym\x26ie=UTF8\x26hq=Gym ........等等。我将 while(1); 替换为 ""; 在我返回字符串之前。

当我试图解析它时的问题

```
JSONParser parser = new JSONParser();

    String jsonString = ""; 
```

// UriHandler.mapSearchJson 是返回 jsonString 的方法。

```
 String jsonData = UriHandler.mapSearchJSON(jsonString);

    Object obj = "";
    try {

        obj = parser.parse(jsonData);

    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    JSONObject jsonObj = (JSONObject) obj;

    String title = (String) jsonObj.get("title");
    System.out.println(title); 
```

这给了我一个例外。位置 2 的意外字符 (t)。

当我调试它时。一直到它试图解析字符串时。那么 obj 为 = null。

我到底做错了什么。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T14:24:23.630

正如其他人已经提到的，不带引号的字段名称不是标准的 JSON。然而，Jackson（也许还有其他人）有一[组选项设置](http://wiki.fasterxml.com/JacksonFeaturesNonStandard)，允许它使用非标准但常见的 JSON 衍生产品：

```
JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES 
```

将启用不带引号的字段名称的处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T14:21:08.910

响应不是有效的 JSON，因为键名没有用双引号引起来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T14:21:49.597

> {标题：“斯德哥尔摩体育馆”

是无效的 JSON，应该是这样的：

```
{"title":"stockholm Gym" 
```

注意如何`title`被`"`双引号包围

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-22T14:25:51.430

您正在撤回供该站点使用的 Javascript**代码。**`maps.google.com`

该响应中可能有任何 Javascript 代码，而不仅仅是作为搜索的一部分返回的 JSON。

您需要改为从他们的地图 API 请求：

[http://maps.googleapis.com/maps/api/geocode/json?address=Stockholm+Gym&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=Stockholm+Gym&sensor=false)

这将只返回 JSON 数据。

查看[Google Maps API](https://developers.google.com/maps/documentation/geocoding/#JSON)以获取更多选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-23T19:11:58.360

我在尝试解析从 kafka（kafka twitter 制作人）返回的 json 时遇到了这个错误。

返回的消息包含除 json (KeyedMessage(twitter-test_english,null,null)) 之外的一些额外文本。因此，我遇到了这个错误。

```
KeyedMessage(twitter-test_english,null,null,{"created_at":"Sat Apr 23 18:31:10 +0000 2016","id":723942306777337856,"id_str":"723942306777337856"} 
```

仅从返回的 json 传递消息部分并将其转换为字符串。

```
{"created_at":"Sat Apr 23 18:31:10 +0000 2016","id":723942306777337856,"id_str":"723942306777337856"}

message = new KeyedMessage("twitter-test_english", (String)queue.take());
//System.out.println("This is message"+message.message());
String message_string = message.message().toString();
JsonParse.toParseJson(message_string); 
```

# php - Codeigniter 无法解码加密密码

> ID：15026242
> 
> 赞同：5
> 
> 时间：2013-02-22T14:19:45.530
> 
> 标签：php, codeigniter, encryption

我制作了一个登录表单，用户在其中提交他的用户名和密码。如果用户名存在，我会解码密码并检查是否与提交的密码相同。

// 这是来自数据库

```
string(50) "v+bNPHNWHGQbcxrvu1vN8Ty++cMq0oEeaZesvfCfsLgNAFgZno" 
```

// 这是在解码上面的字符串之后

```
string(32) "ï¿½ï¿½ Uï¿½U{qï¿½0ï¿½4ï¿½ï¿½è€UCï¿½ï¿½oï¿½/ï¿½*ï¿½." 
```

但它应该返回**123456**

对于我使用的编码

```
$this->encrypt->encode('123456'); 
```

这是密钥

```
$config['encryption_key'] = 'kRlaMneym7rF'; 
```

// 编辑

问题是密码字段设置为 varchar 50

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T08:32:00.633

请在配置中检查您的 codeigniter 字符集

```
$config['charset'] = 'UTF-8'; 
```

与数据库的字符集相比。你的冲突可能来自那里。

将 Codeigniter 进行测试，看看它是否返回正确的结果。尝试像以前一样进行硬编码，或者在控制器中复制和测试它。

```
function testencrypting(){
  $str = '12345';
  $key = 'my-secret-key';
  $encrypted = $this->encrypt->encode($str, $key);
  echo $this->encrypt->decode($encrypted, $key);
  exit; 
```

}

我的产生预期结果：12345。如果有效，那么您的问题可能是字符集（CHARSET）。我在这里使用加密密钥。您可以通过省略编码和解码中的第二个参数来使用配置中的默认值。

让我知道这是否有帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T15:43:26.267

你想要散列，而不是加密，你可以使用 CodeIgniter 的加密库来做到这一点，该库使用 SHA1 进行散列。

```
$password = $this->encrypt->sha1('123456'); 
```

这将返回 7c4a8d09ca3762af61e59520943dc26494f8941b，它将存储在数据库中。

您*不能取消*哈希密码 - 您想根据数据库中的哈希检查哈希输入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T15:51:48.227

你有没有尝试过：

```
$this->encrypt->decode($string); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-03T12:34:46.670

一个可能的原因可能是数据库中该字段的长度，这就是我的情况。我的字段太短了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-28T07:46:30.353

我想通了。我发现这是因为我用来存储密码 unicode 的表是 latin1。我将用户表字段密码更改为 utf-8，这似乎解决了这个问题

# mysql - MySQL 按相关性排序

> ID：15026244
> 
> 赞同：9
> 
> 时间：2013-02-22T14:19:52.110
> 
> 标签：mysql, sql-order-by

我有一个搜索表单，它搜索站点内容表以拉回适当的结果。

我想搜索标题和内容字段并按相关顺序拉回结果。给予标题最高优先级。

假设我们有一个表 (tblContent)

```
intID | strTitle    | txtContent

1     | Smith John  | Lorem Ipsum
2     | Lorem Ipsum | Lorem John Smith Ipsum
3     | John Smith  | Lorem Ipsum Lorem Ipsum
4     | Lorem Ipsum | Lorem Ipsum Lorem Ipsum
5     | Lorem Ipsum | Lorem Ipsum Smith John 
```

而您正在搜索“John Smith”，结果应该按 3、2、1、5 的顺序返回

这怎么可能？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-22T14:33:48.000

我设法得到了很好的理解：

```
SELECT *, 
( (1.3 * (MATCH(strTitle) AGAINST ('+john+smith' IN BOOLEAN MODE))) + (0.6 * (MATCH(txtContent) AGAINST ('+john+smith' IN BOOLEAN MODE)))) AS relevance 
FROM content 
WHERE (MATCH(strTitle,txtContent) AGAINST ('+john+smith' IN BOOLEAN MODE) ) 
ORDER BY relevance DESC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-19T15:57:05.767

mysql全文搜索是一件好事，但它有一个最小4个字符的词被索引的限制。很难更改限制，但并非在所有情况下都可以更改服务器变量。在这种情况下，我建议按案例顺序建议的解决方案

```
select 
    *
from
mytable a
WHERE
    (a.title like 'somthing%'
    OR a.title like '%somthing%'
    OR a.title like 'somthing%')
ORDER BY case
WHEN a.title LIKE 'somthing%' THEN 1
WHEN a.title LIKE '%somthing%' THEN 2
WHEN a.title LIKE '%somthing' THEN 3
ELSE 4 END; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T14:23:49.107

可能有一种更有效的方法，并且考虑到搜索字符串可能超过 2 个单词，这可能是不可行的，但我会做类似的事情

```
ORDER BY CASE 
 WHEN strTitle LIKE '%John Smith%' THEN 1
 WHEN txtContent LIKE '%John Smith%' THEN 2
 WHEN strTitle LIKE '%Smith John%' THEN 3
 WHEN txtContent LIKE '%Smith John%' THEN 4
ELSE 5 END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T14:23:37.460

类似的东西怎么样

```
SELECT INT(id), strTitle, txtContent
FROM tblContent
WHERE name like '%John%'
GROUP BY strTitle
ORDER BY CASE WHEN strTitle like 'John %' THEN 0
           WHEN strTitle like 'John%' THEN 1
           WHEN strTitle like '% John%' THEN 2
           ELSE 3
      END, strTitle 
```

# android - 从服务发送消息到活动

> ID：15026246
> 
> 赞同：3
> 
> 时间：2013-02-22T14:19:59.067
> 
> 标签：android, android-service, android-handler

我有一个服务，我尝试像这样向我的主要活动发送消息：

```
public void callAsynchronousTask() {
    final Handler handler = new Handler();
    Timer timer = new Timer();
    TimerTask doAsynchronousTask = new TimerTask() {
        @Override
        public void run() {
            handler.post(new Runnable() {
                public void run() {
                    try {
                        Message m = new Message();
                        m.arg1 = 10;
                        m.arg2 = 15;
                        handler.sendMessage(m);
                        Log.i("Sent", "!");

                    } catch (Exception e) {}
                }
            });
        }

};
timer.schedule(doAsynchronousTask, 0, 3000); 
} 
```

如何在我的 Activity 中获取此消息数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:25:27.650

在您的活动中，您应该像这样创建一个处理程序，并在启动之前将处理程序的引用传递给服务......

```
handler = new Handler() {
  @Override
  public void handleMessage(Message msg) {
    //msg.arg1
  }
}; 
```

但是现在您正在服务中创建一个处理程序，但这不是您想要做的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:22:10.150

另一种方法是将您的活动绑定到您的服务，以便他们可以通信。

参考 [http://developer.android.com/reference/android/content/Context.html#bindService(android.content.Intent, android.content.ServiceConnection, int)](http://developer.android.com/reference/android/content/Context.html#bindService%28android.content.Intent,%20android.content.ServiceConnection,%20int%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T15:08:31.353

有一个[简单的示例](https://github.com/commonsguy/cw-android/tree/master/Service/Downloader)项目（由[CommonsWare](https://stackoverflow.com/users/115145/commonsware)创建），它展示了如何从`Service`到`Activity`via发送消息`Handler`。一探究竟

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T14:29:02.480

将您的数据放入`message.obj`并从您的活动中的该字段中获取。您的数据可以是一个类，您可以定义您想要的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-25T05:41:01.903

```
 //use this code to send data to activity

         Bundle data = new Bundle();
            data.putString("data", result);
            Message msg = Message.obtain();
            msg.setData(data);
            replyTo.sendMessage(msg);        //replyTo is handler declared in your main_Activity 

    //Pass this **replyTo** handler when you call your service from mainActivity..
          Handler replyTo= new Handler() {
            public void handleMessage(Message msg) {
            //get data here and do what you want..
        };
        }; 
```

希望能帮助到你..！

# mysql - CakePHP 2.2.4：为什么这个 Union $this->Model->query 不起作用？

> ID：15026247
> 
> 赞同：0
> 
> 时间：2013-02-22T14:20:12.443
> 
> 标签：mysql, cakephp, union, cakephp-2.1

我在我的 PhotosController.php 的视图操作中。我想要做的是给定我正在查看的当前照片的 id，创建一个照片轮播，其中包含当前照片之前的两张照片和当前照片之后的两张照片，当前照片在中间（总共 5 张）。

我被指出了[这个解决方案](https://stackoverflow.com/questions/10101606/select-before-and-after-rows-around-id-with-mysql)，但我似乎无法使用 $this->Photo->query 将其转换为 CakePHP。

我的控制器

```
$this->set('photos', $this->Photo->query("
    SELECT id, file FROM photos WHERE id <= $id AND page_id = $page_id ORDER BY id DESC LIMIT 3 
    UNION ALL
    SELECT id, file FROM photos WHERE id > $id AND page_id = $page_id ORDER BY id ASC LIMIT 2
")); 
```

不幸的是，当我打开调试时什么都看不到。id、file 和 page_id 都是 photos 表中的列。#id 和 $page_id 都从路由器传递给操作。我的语法错了吗？

**编辑：**如果我删除 UNION ALL 和第二个 SELECT 语句，那么查询工作正常，所以模型没有被加载不是问题，因为它是。

**编辑（解决方法）：**现在我正在做两个不理想的查询。

```
$this->set('photos_before', $this->Photo->find('all', array(
    'conditions' => array(
        'Photo.page_id' => $page_id,
        'Photo.id <' => $id
    ),
    'order' => array('Photo.id ASC'),
    'limit' => 2
)));

$this->set('photos_after', $this->Photo->find('all', array(
    'conditions' => array(
        'Photo.page_id' => $page_id,
        'Photo.id >' => $id
    ),
    'order' => array('Photo.id ASC'),
    'limit' => 2
))); 
```

我事先有一个包含只返回我需要的字段和相关模型。

下面是我想要显示的内容，它目前使用上面的两个查询工作，但我希望这可以通过一个对蛋糕友好的查询来实现

![这是我想要显示的内容，它目前使用上面的两个查询工作，但我希望这可以通过一个对蛋糕友好的查询来实现](../Images/9d669a4e4869c4b63ef76e3721ad5ee3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:16:23.180

我的猜测是您的原始查询是无效的 SQL。Afaik UNIONS 不能包含多个“order by”子句。作为一种解决方法，您可以考虑重写它以使用如下子查询：

```
SELECT * FROM (SELECT id, file FROM photos WHERE id <= $id AND page_id = $page_id ORDER BY id DESC LIMIT 3) AS suba
UNION ALL
SELECT * FROM (SELECT id, file FROM photos WHERE id > $id AND page_id = $page_id ORDER BY id ASC LIMIT 2) AS subb 
```

尽管我认真地认为这样的查询远非最佳。当然，我不知道您的应用程序的工作方式，但似乎带有 OFFSET/LIMIT 的标准分页查询是一种更合乎逻辑的方法。

请考虑我在您问题下方的评论；使用 model->query 不会自动处理清理/转义以防止 SQL 注入！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:29:34.210

您必须将模型加载为

```
 $this->loadModel('Photo'); 
```

在执行查询之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T18:46:11.143

您应该在 MySQL 中创建一个 VIEW，然后将其用作模型，并在其上执行传统的 CakePHP 查找。

阅读在 MySQL 中创建视图，然后根据该视图名称创建模型。

# xml - 使用空标签解析 SoapObject XML

> ID：15026252
> 
> 赞同：0
> 
> 时间：2013-02-22T14:20:44.127
> 
> 标签：xml, parsing, soap, envelope

大家好，我从 web 服务解析 Soaobject xml，然后 xml 标签不为空，一切正常，但它们是空的示例“ `<barcode></barcode>`”它生成字符串-anyType{}。并将其显示在我的列表中！:( 我应该怎么做才能从列表中删除这个词“anyType{}”并且它什么也没显示或我写的东西？信封.implicitTypes = false; --->这不起作用....仍然得到anyType{} ...这是我的代码：

**String[] xmlElements={"Id","name","Unit","Cost","description","barcode"};**

```
 SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
      envelope.dotNet=true;
      envelope.setOutputSoapObject(request);

      androidHttpTransport.call(SOAP_ACTION, envelope); 

      ArrayList<HashMap<String, String>> Tags = new ArrayList<HashMap<String, String>>();

      if ( xmlelements==null&& KEY_RAKTINIS==null){
          Object soapObj = (SoapObject)envelope.getResponse();
          soapObj = ((SoapObject) soapObj).getProperty(KEY_PATVIRTINIMAS);
         Toast.makeText(getActivity().getBaseContext(), soapObj.toString(), Toast.LENGTH_SHORT).show();

      }else {
            SoapObject soapObj = (SoapObject)envelope.getResponse();
   soapObj = (SoapObject) soapObj.getProperty(KEY_RAKTINIS);// su situo ieinu i butent customers punkta

      for (int  j = 0; j < soapObj.getPropertyCount(); j++) {
        SoapObject   soapObjMenu = (SoapObject) soapObj.getProperty(j);

    for (int  i = 0; i <1; i++) {
              HashMap<String, String> map = new HashMap<String, String>(); 
                    for( i=0; i < xmlelements.length;i++){

           if (soapObjMenu.getProperty(xmlelements[i])!="") { 
               map.put(xmlelements[i], (soapObjMenu.getProperty(xmlelements[i]).toString()));
               Log.v(xmlelements[i], "sitas");}
              }

                    Tags.add(map);
                                }} 
```

`<Items>`

`<Item>`

`<Id>1000</Id>`

`<name>LCD Television HD Black 42 inches</name>`

`<Unit>ea</Unit>`

`<Cost>2000.00</Cost>`

`<description>Simple SKU</description>`

`<barcode></barcode>`

`</Item>`

`<Item>`

`<Id>1001</Id>`

`<name>LCD Television Model 01</name>`

`<Unit>ea</Unit>`

`<Cost>4015.00</Cost>`

`<description></description>`

`<barcode></barcode>`

`</Item>`

`<Item>`

`<Id>1003</Id>`

`<name>Plasma Television Model 01</name>`

`<Unit>ea</Unit>`

`<Cost>4020.00</Cost>`

`<description></description>`

`<barcode></barcode>`

`</Item>`

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:33:48.657

我解决了问题，只需使用 .equals("that string")

例子

```
HashMap<String, String> map = new HashMap<String, String>(); 
                    for( i=0; i < xmlelements.length;i++){

                        if (!soapObjMenu.getProperty(xmlelements[i]).toString().equals("anyType{}")){ // use when tag is empty...
               map.put(xmlelements[i], (soapObjMenu.getProperty(xmlelements[i]).toString()));}else{ map.put(xmlelements[i], (" "));}
                            }
                    Tags.add(map);
                                }}} 
```

ps如果你不使用字符串中的空间它会成为问题然后你在这个map.put（xmlelements [i]，（“”））中从你的应用程序将它发送到服务所以必须改变它只是为了空间;）

没有人帮助，但我希望它对某人有所帮助；）

# c++ - 语言数组和 std::array 初始化有什么区别？

> ID：15026254
> 
> 赞同：1
> 
> 时间：2013-02-22T14:20:48.173
> 
> 标签：c++, arrays, c++11, initialization

std::array 支持聚合初始化，但这里有什么问题？如果使用代码 (1)，vc10.0 和 g++ 4.7.2 都会抱怨初始化程序太多。但是如果我改用代码（2），一切都很好。

```
#include <array>

struct elem_t {  char c;  unsigned n;};

struct my_struct_t
{
  int i;
  // std::array<elem_t, 2> a; // (1) cause error
  // elem_t a[2]; // (2) ok
};

int main()
{
  std::array<int, 3> ai[] = {{1,2,3},{4,5,6}}; // ok

  my_struct_t var[] =
  {
    { 0, { {'a',1U}, {'b',2U}} }, // in question?
  };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:24:24.057

尝试额外的大括号——你需要额外的一对`array`：

```
my_struct_t var[] = { { 0, { { { 'a', 1 } } } }
                    , { 1, { { { 'c', 3 } } } }
};

//                  ^-  mystruct[]
//                     ^-  mystruct
//                         ^-  array
//                           ^-  elem_t[2]
//                             ^-  elem_t 
```

大括号可以在顶层折叠，但这可能是不允许折叠的情况，或者编译器支持可能还不存在。

# security - 解码自定义 base 62 编码有多难/容易？

> ID：15026255
> 
> 赞同：1
> 
> 时间：2013-02-22T14:20:48.980
> 
> 标签：security, cryptography, encryption, base62

以下是我将要在永久链接中混淆数据库 ID 的方法：

> **1)用一个冗长的密钥对 id 进行**异或****
> 
>  ****2）以可逆的方式在异或整数中稍微**加扰（旋转，翻转，反转）位****
> 
>  ****3) Base 62**用我自己的所有字母数字字符的秘密加扰序列对结果整数进行编码 (A-Za-z0-9)****

 ******将我的 Base 62 编码转换回 Base 10 有多难？**

**另外，对整个过程进行逆向工程有多困难？**（显然没有在源代码或编译代码上取得高峰）我知道“只有 XOR”很容易受到基本分析的影响。

**编辑：**结果不应**超过 8-9 个字符长**，3DES 和 AES 似乎会产生很长的加密文本，并且不能在 URL 中实际使用

生成的字符串如下所示：

```
In [2]: for i in range(1, 11):
    print code(i)
   ...:     
9fYgiSHq
MdKx0tZu
vjd0Dipm
6dDakK9x
Ph7DYBzp
sfRUFaRt
jkmg0hl
dBbX9nHk4
ifqBZwLW
WdaQE630 
```

正如你所看到的，1 看起来一点也不像 2，所以这似乎非常适合混淆 id。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T16:19:23.637

任何试图开发自己的密码学的人的标准建议是“不要”。高级建议是阅读 Bruce Schneier[给业余密码设计师的备忘录](http://www.schneier.com/crypto-gram-9810.html#cipherdesign)，然后不要阅读。

您不是第一个需要混淆 ID 的人，因此已经有可用的方法。@CodesInChaos 在上面提出了一个好方法；您应该先尝试一下，看看它是否满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T15:10:02.837

如果允许攻击者玩弄输入，那么熟练的攻击者“解密”数据将是微不足道的。现代加密系统的一个关键特性是您的系统所缺乏的“[雪崩效应”。](http://en.wikipedia.org/wiki/Avalanche_effect)基本上，这意味着输出的每一位都与输入的每一位相连。

如果允许您系统的攻击者看到，例如，id = 1000 产生输出“AAAAAA”，id=1001 产生“ABAAA”，而 id=1002 产生“ACAAA”，那么算法可以很容易地反转，并且值获得的密钥。

* * *

也就是说，这个问题更适合[https://security.stackexchange.com/](https://security.stackexchange.com/)或[https://crypto.stackexchange.com/](https://crypto.stackexchange.com/)****

# doxygen - doxygen 单独的接口（.h）/实现（.c）文档

> ID：15026258
> 
> 赞同：0
> 
> 时间：2013-02-22T14:20:58.027
> 
> 标签：doxygen

我正在尝试生成一个 doxygen 文档，其中我有两个函数文档实例。一个描述从 .h 文件的函数头中提取的函数的用法（接口），另一个描述从 .c 文件中提取的函数的实现。我基本上想根据描述来自的文件（.h 或 .c）以两种不同的方式描述相同的功能。我认为这将有助于文档的可用性，因为如果您只关心如何使用这些功能，您可以轻松地忽略实现细节。我最好的尝试是尝试将 .h 和 .c 文件添加到这样的单独组中。

例子.h

```
/**
 * @defgroup exampleInterface Example Interface
 * @{
 */

/**
 * This is the header file so I describe how to use this function
 * @param arg
 * @returns something
 */   
 int someFunction(int arg);

/**
* @}
*/ 
```

例子.c

```
/**
 * @defgroup exampleImpl Example Implementation
 * @{
 */

/**
 * This is the .c file so I describe how this function is implemented.
 */   
 int someFunction(int arg)
 {
    ... Some code ...
 }
/**
 * @}
 */ 
```

结果是函数头描述仍然结合在一起。有没有办法在 doxygen 中做到这一点？也许我应该以另一种方式看待这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T05:55:33.507

您可以尝试的一种可能的技巧是使用 @internal 命令来实现，这意味着您将运行 doxygen 两次：一次没有内部（用于外部定义），另一次使用将它们结合起来的内部。

# architecture - ARM 编程 - 溢出寄存器意义

> ID：15026259
> 
> 赞同：0
> 
> 时间：2013-02-22T14:20:59.937
> 
> 标签：architecture, arm

我正在学习ARM中的程序，我教授的讲义以以下代码为例：

```
int leaf_examp(int g, int h,
int i, int j)
{
int f;
f = (g+h)-(i+j);
return f;
} 
```

他给出了以下作为上述过程的相应 ARM 代码：

```
Leaf_examp:
SUB sp, sp, #12
STR r6, [sp,#8]
STR r5, [sp,#4]
STR r4, [sp,#0]
ADD r5, r0, r1
ADD r6, r2, r3
SUB r4, r5, r6
MOV r0, r4
LDR r4, [sp,#0]
LDR r5, [sp,#4]
LDR r6, [sp,#8]
ADD sp, sp, #12
MOV pc, lr 
```

我不明白上面代码中包含“sp”的行是什么意思。我在教授的讲义中提到了它，它只是说它指的是溢出寄存器。我只是用谷歌搜索了它，但我对它的理解还不够好，无法理解上面的代码。有人可以向我解释吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:23:24.870

`sp`是堆栈指针。它是 的别名`r13`。在这种情况下，代码在堆栈上保留 12 个字节的空间以保留原始值，`r4-r6`因为这些寄存器用于函数内部的计算。退出时，原始值从堆栈恢复到这些寄存器中。

# android - 来自相机意图的文件路径

> ID：15026261
> 
> 赞同：1
> 
> 时间：2013-02-22T14:21:03.030
> 
> 标签：android, file, path

我正在尝试获取使用相机意图作为字符串拍摄的图片的文件路径，但字符串 filePath 始终为空。我究竟做错了什么？

```
 public void onClick(View arg0) {
        switch (arg0.getId()) {     
         case R.id.btnImageCapture:
            Intent openCamera = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
               startActivityForResult(openCamera, OPEN_CAMERA); 
                 break;
           }
        }

        @Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
         switch(requestCode){
         case OPEN_CAMERA:
             if (resultCode == RESULT_OK && data != null) {
                 Uri captureImage = data.getData();
                 String filePath = captureImage.getPath();
                 break;
              } 
           }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:29:06.633

这就是我如何获得用相机拍摄的图像。

我在保存图像之前创建文件，然后将其保存到我的文件中。

```
File externalFile = new File("Whatever you want the path to be...");
Uri uriSavedImage=Uri.fromFile(externalFile);
Intent launchcameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
launchcameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, uriSavedImage);
startActivityForResult(launchcameraIntent,CAMERA_PIC_REQUEST); 
```

然后在收到结果时。

```
protected void onActivityResult(int requestCode,int resultCode, Intent data) {
        if (resultCode == Activity.RESULT_OK) {
            if (requestCode == CAMERA_PIC_REQUEST) {
                  Bitmap photo = BitmapUtils.decodeFileForDisplay(new File("Whatever your file's path is");
            }
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:45:36.370

尝试以下将您的*captureImage* Uri 作为参数传递：

```
 public String getRealPathFromURI(Uri contentUri) {
        String[] projx = { MediaStore.Images.Media.DATA };
        Cursor cursor = managedQuery(contentUri, projx, null, null, null);
         int column_index = cursor
            .getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
} 
```

**编辑：**

这是 getData() 在某些设备上返回 null 的常见错误。您需要使用预先插入的 Uri 来防止这种情况。例子：

```
 Intent cameraIntent = new Intent(
                android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
 preinsertedUri = getContentResolver().insert(
                MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                new ContentValues());

        startActivityForResult(cameraIntent, CAMERA_PIC_REQUEST); 
```

得到结果：

```
 @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    switch (requestCode) {

    case CAMERA_PIC_REQUEST:

        if (resultCode != 0 && data != null) {

            Uri imageUri = preinsertedUri;
            }
              break; 
                 } 
```

# django - 在 Django 中记录 Web 服务请求

> ID：15026270
> 
> 赞同：2
> 
> 时间：2013-02-22T14:21:55.317
> 
> 标签：django, web-services, logging

我已经使用 Django 创建了一个 REST Web 服务。此 Web 服务有一个日志文件。我想在日志文件中记录所有 Web 服务 (http) 请求。但是，Web 服务请求处理由 Django 完成，我只设置 url-request 处理程序映射并创建请求处理程序（Django 命名法中的视图）。有没有办法在一个中心点记录所有请求，而不需要在其关联的请求处理程序（视图）中记录每个请求？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T17:14:50.827

是的，Django 有一个内置的[信号](https://docs.djangoproject.com/en/dev/ref/signals/#module-django.core.signals)框架。

它允许您注册一个在每次请求开始时调用的函数。

[这个文档](https://docs.djangoproject.com/en/dev/topics/signals/#connecting-receiver-functions)页面解释了如何一步一步地做到这一点

使用装饰器方法：

```
from django.core.signals import request_started
from django.dispatch import receiver

@receiver(request_started)
def my_callback(sender, **kwargs):
    # log the request here
    pass 
```

> 这段代码应该放在哪里？您可以将信号处理和注册代码放在您喜欢的任何地方。但是，您需要确保尽早导入它所在的模块，以便在需要发送任何信号之前注册信号处理。这使您的应用程序的 models.py 成为注册信号处理程序的好地方。

# iis - HTTP 错误 403.14

> ID：15026272
> 
> 赞同：0
> 
> 时间：2013-02-22T14:22:00.153
> 
> 标签：iis

我正在新的实时服务器上设置 MVC 站点。在其他非实时服务器上它工作但在实时我收到此错误

```
HTTP Error 403.14 - Forbidden

The Web server is configured to not list the contents of this directory. 
```

我已经安装了 MVC 3 和 MVC 4，但仍然出现此错误。我在 IIS 中重新启动站点并重新启动服务器，但没有任何效果。我有什么明显的遗漏吗？

我正在使用 IIS7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:29:38.627

您可能需要为该文件夹添加正确的权限。

1.  右键单击 Windows 资源管理器中的文件夹，然后单击属性。
2.  转到安全选项卡，然后单击“编辑”。
3.  然后单击“添加”。
4.  确保位置是您当前的计算机。
5.  在对象名称文本框中键入“IIS AppPool\MyApplicationPoolName”，其中 MyApplicationPoolName 是 IIS 中应用程序池的名称。
6.  单击确定。在权限窗口中，确保选择了新用户并勾选“修改”或您需要的任何权限。单击确定并关闭属性窗口。

希望这会有所帮助 - 确保您授予的权限不会超过您在实时环境中实际需要的权限，但通常修改适用于 Web 应用程序。

# jlayer - jlayer在将.mp3文件转换为.wav文件时增加文件大小

> ID：15026280
> 
> 赞同：1
> 
> 时间：2013-02-22T14:22:19.603
> 
> 标签：jlayer

我正在使用 jlayer 将 mp3 文件转换为 wav 格式。代码运行良好，但 wav 文件的大小增加了 mp3 文件大小的 5 倍左右。为了进行转换，我使用了 jlayer 提供的 jar 文件。
任何人都请告诉如何优化文件的大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T10:04:30.760

您无法优化 WAV 文件的大小，它的大小取决于写入其中的音频数据。音频质量越高，文件越大。音频长度越长，文件越大。

WAV 文件包含[PCM](http://en.wikipedia.org/wiki/Pulse-code_modulation)编码的数字音频。我们使用[MP3](http://en.wikipedia.org/wiki/Mp3)和其他音频编码格式的原因是为了减小文件大小，以换取质量。

因此，当您将文件从 WAV 转换为 MP3 时，您会得到一个较小的文件，但会丢失音频质量。

如果您将生成的文件从 MP3 转换为 WAV（这就是您所做的），您总是会得到一个更大的文件，并且您永远不会恢复到原始音频质量。

# java - 摆动线程通信

> ID：15026281
> 
> 赞同：2
> 
> 时间：2013-02-22T14:22:22.457
> 
> 标签：java, multithreading, swing

我正在创建一个小型摇摆应用程序，它绘制文件中给定的一组点。指南建议我为 GUI 调用一个新线程，为此我使用了以下代码。

```
java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new View().setVisible(true);
        }
    }); 
```

应用程序中的一个场景是打开一个文件（这是使用 完成的`JFileChooser`）。

```
private void openMenuItemActionPerformed(java.awt.event.ActionEvent evt) {
    int returnVal = fileChooser.showOpenDialog(this);
    if (returnVal == JFileChooser.APPROVE_OPTION) {
        File file = fileChooser.getSelectedFile();
        //some heavy operations
    } else {
        System.out.println("File access cancelled by user.");
    }
} 
```

在继续绘制点之前，需要完成一些繁重的操作。

我的问题是，是否建议在`GUI`线程中放置繁重的代码？是否可以将文件对象发送到主线程进行处理并将结果发送到`GUI`线程？

请注意，我不知道 Java 线程 API。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:26:37.527

use`SwingWorker`
`SwingWorker`提出了一种解决方法，方法是在另一个后台线程上执行耗时的任务，在此期间保持 GUI 响应。

看看这个

[http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)

[http://www.theeggeadventure.com/wikimedia/index.php/SwingWorker_Example](http://www.theeggeadventure.com/wikimedia/index.php/SwingWorker_Example)

[http://weblogs.java.net/blog/mkarg/archive/2010/01/03/did-you-know-swingworker-can-send-progress-status](http://weblogs.java.net/blog/mkarg/archive/2010/01/03/did-you-know-swingworker-can-send-progress-status)

[http://www.javaworld.com/javaworld/jw-06-2003/jw-0606-swingworker.html](http://www.javaworld.com/javaworld/jw-06-2003/jw-0606-swingworker.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:23:53.297

如果长时间运行任务的结果修改了一个 Swing 组件，您可以使用[`SwingWorker`](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html). 有关更多信息，请参阅[工作线程和 SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)。

# r - 生成 2 个 survdiff 对象之间的差异

> ID：15026282
> 
> 赞同：0
> 
> 时间：2013-02-22T14:22:26.817
> 
> 标签：r, survival-analysis

[是否可以使用生存](http://cran.r-project.org/web/packages/survival/index.html)包从 R 中的另一个对象中减去一个 survdiff 对象？

我想绘制一个图，显示一条生存曲线高于/低于另一条的间隔以及多少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:39:20.247

`survA`使用和`survB`作为`survdiff`-objects的一种可能解决方案：

```
interval <- 0:2500
# choose a different time interval if you want

sumA <- summary(survA, time = interval)
sumB <- summary(survB, time = interval)

both <- data.frame(time = interval, A = sumA$surv, B = sumB$surv)

both$diff <- both$B - both$A
# or both$diff <- both$A - both$B

plot(x = both$time, y = both$diff, type = "line") 
```

# jquery - 语法错误，无法识别的表达式：#[object HTMLElement] Error

> ID：15026284
> 
> 赞同：7
> 
> 时间：2013-02-22T14:22:28.513
> 
> 标签：jquery

我用 jQuery 做了一个 Overlay 部分。

我打电话给`<a href="javascript:slide(cms);">`.
但我得到这个错误：

> 错误：语法错误，无法识别的表达式：#[object HTMLElement] [http://localhost//js/jquery-1.9.1.min.js:4]

任何想法？这是幻灯片方法：

```
function slide(content) {
    $('#' + content).show(0);
    $('#' + content).animate({
        left: '0%'
    }, 500);
}
$('.c-close').click(function(){ 
    $('.slide').animate({
        left: '100%'
    }, 500);
    $('.slide').hide(0);
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T14:23:59.373

`content.toString()`是`[object HTMLElement]`。`content`一个元素（或我们看不到的代码部分中另一个错误的产物）也是如此。

作为`content`一个元素，而不是它的 id，你应该使用`$(content)`，而不是`$('#'+content)`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T14:27:24.650

正确答案取决于内容和 cms 是什么。

您发送 cms 是因为您的元素有一个名为“cms”的 id

如果 content 是一个 DOM 元素标识符，您应该确保 Id 作为字符串传递。

```
<div id="cms" ></div>
<a href="javascript:slide('cms');"> 
```

并重命名您的函数，以便更清楚地了解它的作用：

```
function slide(element_id) {
    $('#' + element_id).show(0);
    $('#' + element_id).animate({
        left: '0%'
    }, 500);
} 
```

还有一些其他的解决方案：

如果 cms 是先前设置的包含 DOm 元素的变量。

例如。

Javascript：

```
var cms = $('cms');

function slide(content) {
    content.show(0);
    content.animate({
        left: '0%'
    }, 500);
} 
```

或者：

```
var cms = document.getElementById("cms");

function slide(content) {
    $(content).show(0);
    $(content).animate({
        left: '0%'
    }, 500);
} 
```

html:

```
<a href="javascript:slide(cms);">. 
```

取决于你想要什么。

请记住，如果您使用@dystroy，他的解决方案非常好，而不是简单地将元素 id 作为变量发送。但实际上发送 dom 元素后选择。

我的解决方案是：

```
<div id="cms"></div>
<a href="#" id="slide">slide</a>
<script>
    (function(){
        $('slide').on('click',function(e){
            e.preventDefault();
            var slideElement = $('div#cms');
            slideElement.show(0);
            slideElement.animate({
                left: '0%'
            }, 500);
        });
    })();
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:24:45.500

要在 jQuery 选择器中使用变量，它应该是一个字符串。所以用'-->
包围你的**cms**`<a href="javascript:slide('cms');">`

# android - 通过带有图像（照片）的意图插入联系人（ContactsContract）

> ID：15026292
> 
> 赞同：13
> 
> 时间：2013-02-22T14:22:54.677
> 
> 标签：android, android-intent, android-contentprovider, android-image, contactscontract

有很多问答线程，但没有一个提供真正的答案，或者我找不到。

为了确保您，我在询问之前进行了搜索：

*   [Android：使用 ContactsContract 插入意​​图设置联系人照片](https://stackoverflow.com/questions/6446267/android-set-contact-photo-with-contactscontract-insert-intent)（无效答案）
*   [使用 ContactsContract 在 Android 中插入联系人](https://stackoverflow.com/questions/4459138/insert-contact-in-android-with-contactscontract)（接受的答案不使用 Intent）
*   [插入新的联系意图](https://stackoverflow.com/questions/14278587/insert-a-new-contact-intent)（不触及问题）
*   [如何在通话意图中插入照片？](https://stackoverflow.com/questions/7215615/how-to-insert-photo-in-call-intent)（不相关）
*   [将照片添加到联系人](https://stackoverflow.com/questions/8574192/add-photo-to-an-android-contact)（不使用意图）
    *   [https://stackoverflow.com/a/8574396/492624](https://stackoverflow.com/a/8574396/492624)（我有意尝试的答案的解决方案，包括PHOTO和DATA15字段，但不起作用）
*   [http://thinkandroid.wordpress.com/2009/12/30/handling-contact-photos-all-api-levels/](http://thinkandroid.wordpress.com/2009/12/30/handling-contact-photos-all-api-levels/)（不使用意图）

那么有没有人知道如何使用 Intent（如示例代码中所示）并插入保存在 Bitmap 中的照片？

我现在使用的示例代码为用户启动对话意图，让他在保存之前插入或取消并可能编辑字段：

```
// PrivateContactClass c;
// Bitmap photo;
Intent inOrUp = new Intent(ContactsContract.Intents.Insert.ACTION, ContactsContract.Contacts.CONTENT_URI);
inOrUp.setType(ContactsContract.Contacts.CONTENT_TYPE);
inOrUp.putExtra(ContactsContract.Intents.Insert.NAME, ModelUtils.formatName(c));
inOrUp.putExtra(ContactsContract.Intents.Insert.PHONE, getPrimaryPhone());
inOrUp.putExtra(ContactsContract.Intents.Insert.TERTIARY_PHONE, c.getMobile());
inOrUp.putExtra(ContactsContract.Intents.Insert.EMAIL, c.getMail());
inOrUp.putExtra(ContactsContract.Intents.Insert.JOB_TITLE, c.getFunction());
inOrUp.putExtra(ContactsContract.Intents.Insert.NOTES, getSummary());
inOrUp.putExtra(ContactsContract.Data.IS_SUPER_PRIMARY, 1);
startActivity(inOrUp); 
```

* * *

# 感谢 Julien 的回答，我找到了解决方案

不只使用意图，因为我怀疑我们可以传递 Data ContentProvider 保存的图像的 ID，或者直接在意图中传递位图。

从上面的代码扩展

## 使用带有常量请求代码的 startActivityForResult

```
// must be declared in class-context
private static final int CONTACT_SAVE_INTENT_REQUEST = 1;
...
startActivityForResult(inOrUp,CONTACT_SAVE_INTENT_REQUEST); 
```

## 添加 Intent 启动的活动的处理结果

```
@Override
protected void onActivityResult(int requestCode, int resultCode,
        Intent intent) {
    super.onActivityResult(requestCode, resultCode, intent);
    switch (requestCode) {
    case RESULT_INSERT_CONTACT:
        if (resultCode == RESULT_OK) {
            trySetPhoto();
        }
        break;
    }
} 
```

## 添加方法来设置照片

```
public boolean setDisplayPhotoByRawContactId(long rawContactId, Bitmap bmp) {
     ByteArrayOutputStream stream = new ByteArrayOutputStream();
     bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);
     byte[] byteArray = stream.toByteArray();
     Uri pictureUri = Uri.withAppendedPath(ContentUris.withAppendedId(RawContacts.CONTENT_URI, 
             rawContactId), RawContacts.DisplayPhoto.CONTENT_DIRECTORY);
     try {
         AssetFileDescriptor afd = getContentResolver().openAssetFileDescriptor(pictureUri, "rw");
         OutputStream os = afd.createOutputStream();
         os.write(byteArray);
         os.close();
         afd.close();
         return true;
     } catch (IOException e) {
         e.printStackTrace();
     }
     return false;
 } 
```

## 添加方法搜索联系人并添加联系人照片

```
private void trySetPhoto() {
    // Everything is covered in try-catch, as this method can fail on 
    // low-memory or few NPE
    try {
        // We must have an phone identifier by which we search for
        // format of phone number is not relevant, as ContentProvider will
        // normalize it automatically
        if (c.getMobile() != null) {
            Uri lookup = Uri.withAppendedPath(
                    ContactsContract.PhoneLookup.CONTENT_FILTER_URI,
                    Uri.encode(c.getMobile()));
            Cursor c = getContentResolver().query(lookup, null, null, null,
                    null);
            // Remember cursor can be null in some cases
            if (c != null) {
                // we can obtain bitmap just once
                Bitmap photo_bitmap = getPhotoBitmap();
                c.moveToFirst();
                // if there are multiple raw contacts, we want to set the photo for all of them
                while (c.moveToNext()) {
                    setDisplayPhotoByRawContactId(
                            c.getLong(c.getColumnIndex(ContactsContract.CommonDataKinds.Phone.RAW_CONTACT_ID)),
                            photo_bitmap);
                }
                // remember to clean up after using cursor
                c.close();
            }
        }
    } catch (Exception e) {
        // Logging procedures
    } catch (Error e) {
        // Logging procedures
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-29T01:13:40.453

```
Bitmap bit = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher); // your image

ArrayList<ContentValues> data = new ArrayList<ContentValues>();

ContentValues row = new ContentValues();
row.put(Data.MIMETYPE, ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE);
row.put(ContactsContract.CommonDataKinds.Photo.PHOTO, bitmapToByteArray(bit));
data.add(row);

Intent intent = new Intent(Intent.ACTION_INSERT, Contacts.CONTENT_URI);
intent.putParcelableArrayListExtra(Insert.DATA, data); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T09:25:11.640

为了帮助你，我找到了原始文档：http: [//java.llp2.dcc.ufmg.br/apiminer/docs/reference/android/provider/ContactsContract.RawContacts.DisplayPhoto.html](http://java.llp2.dcc.ufmg.br/apiminer/docs/reference/android/provider/ContactsContract.RawContacts.DisplayPhoto.html)

并阅读：http: [//java.llp2.dcc.ufmg.br/apiminer/docs/reference/android/provider/ContactsContract.RawContacts.html](http://java.llp2.dcc.ufmg.br/apiminer/docs/reference/android/provider/ContactsContract.RawContacts.html)

对我来说，一个简单的解决方案是如果您的代码有效调用：

```
startActivityForResult(inOrUp, CODE_INSERT_CONTACT); 
```

然后在“onActivityResult”中调用“setDisplayPhotoByRawContactId.”：

```
 /** @return true if picture was changed false otherwise. */
public boolean setDisplayPhotoByRawContactId(long rawContactId, Bitmap bmp) {
     ByteArrayOutputStream stream = new ByteArrayOutputStream();
     bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);
     byte[] byteArray = stream.toByteArray();
     Uri pictureUri = Uri.withAppendedPath(ContentUris.withAppendedId(RawContacts.CONTENT_URI, 
             rawContactId), RawContacts.DisplayPhoto.CONTENT_DIRECTORY);
     try {
         AssetFileDescriptor afd = getContentResolver().openAssetFileDescriptor(pictureUri, "rw");
         OutputStream os = afd.createOutputStream();
         os.write(byteArray);
         os.close();
         afd.close();
         return true;
     } catch (IOException e) {
         e.printStackTrace();
     }
     return false;
 } 
```

通常，此代码适用于 API 版本 14。我不得不对这个话题进行研究。

您可以按照文档中的说明获取 rawContactId：

```
Uri rawContactUri = RawContacts.URI.buildUpon()
      .appendQueryParameter(RawContacts.ACCOUNT_NAME, accountName)
      .appendQueryParameter(RawContacts.ACCOUNT_TYPE, accountType)
      .build();
long rawContactId = ContentUris.parseId(rawContactUri); 
```

我不确定，但文档会帮助你。对不起我的英语不好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-09T16:31:24.473

接受的答案不符合问题的要求。

请参阅[@yeo100](https://stackoverflow.com/users/2430665/yeo100)的[答案](https://stackoverflow.com/a/16803980/2190411)，该答案使用`ContactsContract.Intents.Insert.DATA`（[文档](http://developer.android.com/reference/android/provider/ContactsContract.Intents.Insert.html#DATA)- 有点晦涩难找：/），因为联系人照片保存在特定 mimetype 下的 Data 表中：

`Data.MIMETYPE`->`ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE`

这对我有用，而且更整洁，更容易管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-23T04:15:21.623

这与 yeo100 的答案相同，但在 Kotlin 中。

```
//Create Intent - I use ACTION_INSERT_OR_EDIT but you could use ACTION_INSERT
val intent = Intent(Intent.ACTION_INSERT_OR_EDIT).apply {
   type = ContactsContract.Contacts.CONTENT_ITEM_TYPE
}

intent.apply {

   //Add name, phone numbers, etc
   putExtra(ContactsContract.Intents.Insert.NAME, "John Smith")

   ...

   /*
   Start Adding Contact's Photo
   */

   //Get photo from an imageView into a byteArray
   var imageAsBitmap = (myImageView.drawable as BitmapDrawable).bitmap
   val stream = ByteArrayOutputStream()
   imageAsBitmap.compress(Bitmap.CompressFormat.PNG, 90, stream)
   val imageData = stream.toByteArray()

   //Add image data to an Array of ContentValues
   val data = ArrayList<ContentValues>()
   val row = ContentValues()
   row.put(ContactsContract.RawContacts.Data.MIMETYPE, ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE)
   row.put(ContactsContract.CommonDataKinds.Photo.PHOTO, imageData)
   data.add(photoRow)

   //Add array to your Intent as data
   putExtra(ContactsContract.Intents.Insert.DATA, data)
}

startActivity(intent) 
```

# java - Java 正则表达式匹配“字符串”

> ID：15026293
> 
> 赞同：2
> 
> 时间：2013-02-22T14:22:58.440
> 
> 标签：java, regex, lexical-analysis

我正在从头开始创建词汇，并且正在进入匹配部分`(")[\\w]+(")`。我有这个正则表达式`^(\")[\\w]+(\")$`，但它不会捕获字符串。

SSCCE：

```
Map<String, String> lexicalMap = new HashMap<>();
// add all regex to `lexicalMap` via `lexicalMap.put([regex], [tokentype])`

// Tokenize the string format of the syntax to `List<String> tokens`
// List<String> tokens contains ["string", "data", "=", "test"] on the syntax: string data = "test"
for(String element : tokens) {
    for(String regex : lexicalMap.keySet()) {
        if(element.matches(regex))
            System.out.print(lexicalMap.get(regex) + " ");
    }
}
System.out.println(); 
```

正则表达式：

```
identifier = ^[\\w]+$
operator = ^(\\=)$
string = ^(\")[\\w]+(\")$ // THE PROBLEM
keyword = ^(string)$ 
```

这是我关注的案例输入/输出：

输入：

```
"test"
""
test
string data = "test" 
```

输出：

```
string
string
identifier
keyword identifier operator string 
```

* * *

更新时间：2013 年 2 月 22 日

*   添加了 SSCCE 段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:31:54.600

我不知道发生了什么，但是在将正则表达式从更改为之后`^(\")[\\w]+(\")$`，`^(\")[\\w]*(\")?$`它可以正常工作。

# excel - 自动打开用于使用 VBA 执行另一个宏

> ID：15026296
> 
> 赞同：0
> 
> 时间：2013-02-22T14:23:09.463
> 
> 标签：excel, scheduled-tasks, vba

`Can Opener`我有一本由我的任务计划程序打开的 Excel 书。它在我的任务计划程序无法访问的共享驱动器上打开另一个工作簿，然后自行关闭.. `Can Opener`工作正常。我遇到的问题是，另一个工作簿的代码在打开时，如果是晚上 7 点系统时间执行更新宏以从服务器获取新数据。完成此操作后，文件将保存并关闭。数据工作簿打开，但没有发生更新，并且不会自动保存和关闭。我已将代码分解，因此它至少会更新，但这也不起作用。我已经检查了几个论坛和其他位置，但我仍然无法弄清楚问题是什么。我能得到一点帮助吗？

```
 Sub DataBook_Open()

Application.EnableCancelKey = xlDisabled

   If Hour(Now) = 7 And Weekday(Now, vbSunday) < 7 Then

       Run_Update

            Me.Save

            Application.Quit

    Else:   Me.Save
            Application.Quit

   End If

End Sub 
```

`Run_Update`是我的模块中的宏的名称，它仅执行模块中创建服务器连接并运行 SQL 的其他宏。如果手动运行或使用按钮运行，这工作正常，所以我知道错误不在这里。此外，我试图在每晚 7 点运行此代码。

我真的很感激我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T15:00:33.523

您确定 DataBook_Open() 是否执行？除非您从 Auto_Open() 或 Workbook_Open() 调用它，否则它可能不会。

试试这个最小的测试文件。用您的实际文件夹替换路径。

--can_opener.xlsm--

```
Sub OpenOtherWorkbook()

  Dim sWbkPath As String
  sWbkPath = ThisWorkbook.Path & "\" & "test_data.xlsm"

  Dim wbkData As Workbook
  Set wbkData = Workbooks.Open(sWbkPath)

End Sub 
```

--test_data.xlsm-- 在 ThisWorkbook 对象中

```
Private Sub Workbook_Open()

  If Hour(Now) = 9 Then 'replace with your condition
      UpdateData
      ThisWorkbook.Save
      DoEvents
  Else
      DoEvents
  End If

  ThisWorkbook.Close
  'Application.Quit

End Sub

Sub UpdateData()

  ThisWorkbook.Sheets(1).Range("A1").Value = Format(Now, "yyyy-mm-dd:hh\hmm")

End Sub 
```

# c# - 如何找到一行包裹在 dataGridView 单元格中的位置？

> ID：15026300
> 
> 赞同：0
> 
> 时间：2013-02-22T14:23:19.213
> 
> 标签：c#, datagridview

我有一个多行 DataGridView，您如何找到字符串中自动换行的位置`Cell.Value`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:15:52.603

```
 string testLength = "1";
    private void DataSheets_Load(object sender, EventArgs e) //DataGridView, 2 columns
    {
        clmData.DefaultCellStyle.WrapMode = DataGridViewTriState.True;
        Data.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.AllCells;
        Data.DefaultCellStyle.Font = new Font("Courier", 8);
        RunWidth();
    }

    void RunWidth()
    {
        int l1 = len(testLength);
        int l2 = len(testLength + testLength);
        int perChar = l2 - l1;
        int pad = l1 - perChar;
        int s7 = pad + (perChar * 75);
        int s5 = pad + (perChar * 50);
        Data.Columns[0].Width = s7;
        Data.Columns[1].Width = s5;
    }
    public int len(string text)
    {
        Size te = TextRenderer.MeasureText(text, new Font("Courier", 8));
        return te.Width;
    } 
```

我自己解决了它，但如果有人找到更多方法来找到适用的类似功能，请继续发布结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-27T08:40:25.800

仅仅因为它有很多很好的信息：
[这是一个非常详细的关于和之间差异的`TextRenderer.MeasureText()`答案`Graphics.MeasureString()`](https://stackoverflow.com/a/23230570/2505186)

我有一个类似的问题；[我想知道在自己](https://stackoverflow.com/q/44199977/2505186)[绘制 a 时`DataGridViewRow`](https://stackoverflow.com/q/44199977/2505186)通过换行创建了多少行（代码为 C++/CLI）：

```
void PaintRow (Object^ sender, DataGridViewRowPrePaintEventArgs^ e)
{
...
    int iCharacters = 0, iLines = 0;
    SizeF oLayoutArea ((float)dgvRow->Cells[ixCell]->Size.Width, 0);
    SizeF oTextSize = e->Graphics->MeasureString (sText,
                                        dgvRow->Cells[ixCell]->InheritedStyle->Font,
                                        oLayoutArea,
                                        oStringFormat,
                                        iCharacters,
                                        iLines); 
```

关于您的问题：
我会采用相同的代码并找出完整字符串创建了多少行，例如 2 行。
然后取一半的字符串，看看你得到了多少行，例如 1 行。
因为它的行数比以前少，所以我会再次获取更多文本（总是差一半）并再次测试。继续，直到您将其分解为一个字符并获得适合不换行的结果长度。

# java - 多个罐子，单个持久性单元解决方案？

> ID：15026302
> 
> 赞同：21
> 
> 时间：2013-02-22T14:23:26.583
> 
> 标签：java, jpa, persistence-unit

包括我在内的一些人一直在努力将来自不同模块（jar）的实体合并到一个持久性单元中（尤其是使用**JavaSE**，例如[JPA 2.0:Adding entity classes to PersistenceUnit *from different jar* automatically](https://stackoverflow.com/questions/6380728/jpa-2-0-adding-entity-classes-to-persistenceunit-from-different-jar-automatic)）。根据答案，没有简单的直接方法可以做到这一点。一种解决方案是在单个持久性单元文件中列出所有 jar 中的所有类，但这并不是很优雅。我可能不小心找到了另一种方法。通常我所有的实体类都是使用**annotations**映射的。至于解决方案：`persistence.xml`可以包含多个 XML 映射文件，例如：

*main.jar!META-INF/persistence.xml：*

```
<persistence-unit name="PU" transaction-type="RESOURCE_LOCAL">
  <mapping-file>META-INF/order-mappings.xml</mapping-file>
  <mapping-file>META-INF/customer-mappings.xml</mapping-file>
</persistence-unit> 
```

映射文件可以放在不同的 jar 中。我注意到它们可能包含**没有任何属性**`<entity>`的元素，例如：

 ***order.jar!META-INF/order-mappings.xml*

```
<entity-mappings>       
  <entity class="com.company.Order"></entity>    
</entity-mappings> 
```

即使映射文件没有映射任何属性**，Java 类中的注释也会被考虑在内**，一切似乎都很好！这意味着只需包含来自特定 JAR 的 XML 映射文件，就可以轻松地将来自多个 jar 的实体包含到单个持久性单元中。

我的问题是：这是允许的 JPA 映射文件使用还是我的持久性提供程序（Hibernate）的副作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-07T12:33:09.117

是的，这是 JPA 规范允许的。

XML 实体映射旨在覆盖 JPA 注释。除非您使用标记专门更改默认行为 `<xml-mapping-metadata-complete/>`，否则 JPA 提供程序将在没有 XML 映射的情况下使用注释。

[以下是JPA 2.0 规范](http://download.oracle.com/otndocs/jcp/persistence-2.0-fr-eval-oth-JSpec/)的摘录：

> **12.1 XML 描述符的使用**
> 
> ... entity-mappings 元素的 persistence-unit-defaults 子元素中包含的 xml-mapping-metadata-complete 子元素的缺失或存在控制是否使用 XML 对象/关系映射描述符来选择性地覆盖注释值，或者是否它是 Java 语言元数据注释的完整替代品。
> 
> 如果指定了 xml-mapping-metadata-complete 子元素，则持久性单元的完整映射元数据集包含在持久性单元的 XML 映射文件中，并且忽略类上的任何持久性注释。**

# dynamics-crm-2011 - Crm 2011\. 如何在 mvc 应用程序中获取当前用户

> ID：15026306
> 
> 赞同：2
> 
> 时间：2013-02-22T14:23:49.917
> 
> 标签：dynamics-crm-2011

我有一个自定义 mvc 应用程序，我想将其用作 crm 2011 的一部分（例如，我在 crm 面板上有一个按钮，它在我的 mvc 应用程序中调用操作）

我可以获取登录 crm 并按下按钮的用户凭据吗？

我使用此代码来运行组织服务。但是 WhoAmIRequest 返回 system 或 null（取决于 web.config 中的模拟属性）

```
var organizationUri = new Uri(Configuration.OrganizationUri());
var credentials = new ClientCredentials();

credentials.Windows.ClientCredential = (DefaultCredentials != null) ? DefaultCredentials : CredentialCache.DefaultNetworkCredentials;

IServiceConfiguration<IOrganizationService> orgConfigInfo = ServiceConfigurationFactory.CreateConfiguration<IOrganizationService>(organizationUri);

var service = new OrganizationServiceProxy(orgConfigInfo, credentials);

WhoAmIResponse response = (WhoAmIResponse)service.Execute(new WhoAmIRequest());
service.CallerId = response.UserId; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T10:09:07.220

您可以读取当前的用户名

`User.Identity.Name`

并将其与 MS CRM 中的域名进行比较。

# performance - 如何加速 magento 1.7 集合

> ID：15026312
> 
> 赞同：0
> 
> 时间：2013-02-22T14:24:00.023
> 
> 标签：performance, magento, search

我使用此代码对包含搜索字符串的数组进行了自定义目录搜索：

```
$collection =    Mage::getModel('catalog/product')->getCollection()
            ->addAttributeToSelect('*')
        ->addAttributeToFilter('visibility', $visibility);

        foreach($searchNames as $searchName){
            $collection->addAttributeToFilter(array(
                    array('attribute'=> 'name','like' => '%'.$searchName.'%'),
                    array('attribute'=> 'search_field','like' => '%'.$searchName.'%'),
                    array('attribute'=> 'sku','like' => '%'.$searchName.'%')));
        } 
```

当我得到 ~6k 结果时，搜索大约需要 5 秒。有没有办法加快这个速度？也许有一些我还没有找到的性能调整。

我已经为表 catalog_product_flat 中的这些字段设置了索引，但没有任何更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:11:35.450

Indexes will not work in your query for `name`, `search_field` and `sku` attributes! Because your LIKE value begins with a wildcard (%), and indexes can only work if it starts with a constant. Your query will speed up if you remove that leading `%` from LIKE values.

I don't understand why you are using foreach?

# java - Spring Security 可以接受同一用户的多个密码吗？

> ID：15026318
> 
> 赞同：5
> 
> 时间：2013-02-22T14:24:15.617
> 
> 标签：java, spring-security

我在我的应用程序中使用 Spring Security 以使用一个密码对用户进行身份验证。我正在尝试满足覆盖密码也将对同一用户进行身份验证的要求。

如何使用 Spring Security 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:35:38.707

`AuthenticationProvider`有可能，您可能必须通过扩展现有的`DaoAuthenticationProvider`（见`additionalAuthenticationChecks()`那里）来实现自己的。此外，默认情况下，用户只与
一个密码相关联（`UserDetails.getPassword()``UserDetailsService`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-26T02:46:38.027

通过提供多个 'AuthenticationProvider' 和 'UserDetailsS​​ervice' 很容易做到。

```
private DaoAuthenticationProvider userAuthProvider() {
    DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
    provider.setHideUserNotFoundExceptions(false);    
    provider.setPasswordEncoder(passwordEncoder);
    provider.setUserDetailsService(userDetailsService);
    return provider;
}

private DaoAuthenticationProvider superVisorAuthProvider() {
    DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
    provider.setHideUserNotFoundExceptions(false);
    provider.setUserDetailsService(supervisorDetailService);
    return provider;
} 
```

然后

```
@Autowired
public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {
    auth.authenticationProvider(userAuthProvider());
    auth.authenticationProvider(superVisorAuthProvider());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-06T06:29:20.127

正如已经提到的 - 你可以覆盖'additionalAuthenticationChecks' 希望这对某人有所帮助。

```
@Slf4j
@Service
class FlexibleAuthenticationProvider extends DaoAuthenticationProvider implements AuthenticationProvider {

    @Autowired
    UserDetailsService userDetailsService

    @Autowired
    PasswordEncoder passwordEncoder

    @PostConstruct
    def init() {
        super.setPasswordEncoder(passwordEncoder)
        super.setUserDetailsService(userDetailsService)
    }

    @Override
    protected void additionalAuthenticationChecks(
            UserDetails userDetails,
            UsernamePasswordAuthenticationToken authentication) throws AuthenticationException {
        try {
            super.additionalAuthenticationChecks(userDetails, authentication)
        } catch (AuthenticationException e) {
            log.error('Unable to authenticate with regular credentials')

            try {
                def mutableUserDetails = new MutableUser(userDetails)
                mutableUserDetails.password = 'alternatepassword'
                return super.additionalAuthenticationChecks(mutableUserDetails, authentication)
            } catch (AuthenticationException err) {
                log.error('Token based authentication failed')
            }

            throw e
        }
    }

    static class MutableUser implements UserDetails {

        private String password
        private final UserDetails delegate

        MutableUser(UserDetails user) {
            this.delegate = user
            this.password = user.password
        }

        String getPassword() {
            return password
        }

        void setPassword(String password) {
            this.password = password
        }

        ....

    }

}

@Configuration
class AuthWebSecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Autowired
    FlexibleAuthenticationProvider flexibleAuthenticationProvider

    ....

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.authenticationProvider(flexibleAuthenticationProvider)
    }

    ....

} 
```

# c# - 确保将 c# 项目依赖项复制到 Visual Studio 和 TFS 中的输出目录

> ID：15026326
> 
> 赞同：0
> 
> 时间：2013-02-22T14:24:29.010
> 
> 标签：c#, msbuild

我正在开发一个项目，该项目具有许多依赖项，这些依赖项是在与我不同的团队中开发的。我们使用 TFS 2010。我的许多应用程序都依赖于正在积极开发中的库和 xml 文件，因此我想让它们保持最新。我也不想为每个应用程序/项目创建 dll 和 xml 文件的单独副本，而是从同一源代码控制存储库中的各自位置获取它们。这应该可以使用相对路径。我尝试将以下内容放入我的 .csproj 文件中

```
 <ItemGroup>
     <Dependencies Include="..\..\Driver\Driver.dll">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
     </Dependencies>
 </ItemGroup> 
```

这在我的工作站或构建服务器上都不起作用，但是，文件在解决方案资源管理器中显示为依赖项，它允许我将副本更改为输出属性并显示文件的完整路径，其中已验证。

我尝试的另一件事是将 xcopy 作为预构建事件运行，它可以在我的本地计算机上运行，​​但不会将文件复制到输出/TFS 放置文件夹，因此它不会将其作为依赖项来选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T16:10:43.690

Try using the Private Element instead, set to True.

```
<ItemGroup>
     <Dependencies Include="..\..\Driver\Driver.dll">
        <Private>True</Private>
     </Dependencies>
 </ItemGroup> 
```

See [http://msdn.microsoft.com/en-us/library/bb629388.aspx](http://msdn.microsoft.com/en-us/library/bb629388.aspx)

# twitter-bootstrap - Twitter Bootstrap 网站中是否应该有多个容器 div？

> ID：15026328
> 
> 赞同：1
> 
> 时间：2013-02-22T14:24:36.077
> 
> 标签：twitter-bootstrap

我正在尝试将我购买的 Bootstrap 主题应用到我拥有的 Rails 应用程序中。布局似乎相当复杂，有多个容器，其中一些在导航栏内。我完全不明白。我想确保这种布局是正确的做事方式，而不是仅仅因为我买了它就相信它是正确的。

这是一个例子：

```
<div class="span2">

  <!-- Top navigation bar -->
  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <div class="nav-collapse">
          <ul class="nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Menu<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a class="menu" href="/item1">Item1</a></li>
                <li><a class="menu" href="/item2">Item2</a></li>
                <li><a class="menu" href="/item3">Item3</a></li>
              </ul>
            </li>
            <li><a href="#">Help</a></li>  
          </ul> <!-- nav -->
        </div><!-- nav-collapse -->
      </div> <!-- container -->
    </div> <!-- navbar-inner -->
  </div> <!-- navbar -->
</div> <!-- span2 -->

<!-- Main Content -->
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span9">
      <!-- stuff -->
    </div> <!-- span9 -->
  </div> <!-- row-fluid -->

  <div class="row-fluid">
    <div class="footer span12">
      <div class="well">
        <footer>
          &copy; MyCompany, LLC 2013
        </footer>
      </div>
    </div><!-- /span12 -->
  </div> <!-- row-fluid -->

</div> <!-- container-fluid --> 
```

这看起来很奇怪。

*   首先，我认为我有 12 列可以使用，但上面的 9 + 2 仅等于 11。

*   其次，the`span9`和the`span2`处于不同的层次。

*   第三，`container`我设置`spanN`div之前不是必须先用a建立网格吗？第一个`span2`只是悬挂在太空中。

如果我不得不提炼这个，我想我的主要问题是：Twitter Bootstrap 中容器的主要目的是什么？我似乎无法通过 Google 或 Bootstrap 文档找到该问题的答案。知道这一点可能会帮助我确定拥有多个容器是否有意义。感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:19:57.417

Twitter bootstrap 有很多预先编写的 CSS，您可以通过在 html 中调用它的类来使用它。如果您查看 twitter bootstrap 页面上的一些示例，您会发现所有 div 都存在是有原因的。当您使用 twitter bootstrap 定义的类时，请忽略非常规的 html 标签。

如果你看一下布局教程

[http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)

它解释了如何嵌套列来定位需要多个 div 的 div

导航教程在这里

[http://twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

回答您的容器问题。

固定布局

```
<div class="container"> required. 
```

[http://twitter.github.com/bootstrap/scaffolding.html#layouts](http://twitter.github.com/bootstrap/scaffolding.html#layouts)

希望能帮助到你

# python - 如何构建十六进制命令并将其发送到电视

> ID：15026329
> 
> 赞同：2
> 
> 时间：2013-02-22T14:24:36.663
> 
> 标签：python, serial-port, pyserial

我有一台 NEC PX-42VM5HA 等离子电视，我正在尝试通过连接的计算机进行控制。我有数据表，其中显示了控制电视和协议信息的所有代码。我不确定如何在 python 中构建正确的数据结构来发送 HEX 控制代码。下面是电源控制代码和通信协议。

```
Communication Protocol:
    Interface: RS-232C
    Communication: Asynchronous
    Baud Rate: 9600
    Data Length: 8bits
    Parity: Odd
    Stop Bit: 1bit
    Communication Code: Hex

Power Control Codes
    ON          9FH 80H 60H 4EH 00H CDH
    OFF         9FH 80H 60H 4FH 00H CEH 
```

这是我到目前为止的代码：

```
import time
import serial

ser = serial.Serial(
    port='COM1',
    baudrate=9600,
    parity=serial.PARITY_ODD,
    stopbits=serial.STOPBITS_ONE,
    bytesize=serial.EIGHTBITS
)

ser.close()
ser.open()
ser.isOpen()

ON=bytearray([0x9FH,0x80H,0x60H,0x4EH,0x00H,0xCDH])
OFF=bytearray([0x9FH,0x80H,0x60H,0x4FH,0x00H,0xCEH])

ser.write(OFF)
time.sleep(30)
ser.write(ON)
ser.close() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:29:01.480

将控制代码写成字符串

```
ON = "\x9f\x80\x60\x4e\x00\xcd"
ser.write(ON) 
```

# node.js - 无法使用 tls 连接 node.js 中的 socket.io

> ID：15026330
> 
> 赞同：1
> 
> 时间：2013-02-22T14:24:39.883
> 
> 标签：node.js, ssl, socket.io

我已经在 stackoverflow 中搜索并搜索了与 socket.io+tls 或 node.js+tls 或 ssl 等相关的任何线程......但我找不到任何构建我需要的方法：

**通过socket.io和tls连接到客户端的node.js服务器（只需要服务器认证）**

到目前为止，我已经在不使用 tls 的情况下连接了服务器和客户端。

当我创建我的 node.js 服务器（侦听端口 3000）并使用 tls 时，我可以使用以下命令：

```
openssl s_client -connect localhost:3000 
```

一切似乎都很好，但是我尝试连接我的socket.io客户端时总是出错。

这是我的简单服务器代码：

```
 var tls = require('tls');
 var fs = require('fs');

  var options = {
    key: fs.readFileSync('evServer-key.pem'),
    cert: fs.readFileSync('evServer-cert.pem'),
    requestCert: false,

  };

  var server = tls.createServer(options, function(cleartextStream) {
    console.log('server connected',
                cleartextStream.authorized ? 'authorized' : 'unauthorized');
    cleartextStream.write("welcome!\n");
    cleartextStream.setEncoding('utf8');
    cleartextStream.pipe(cleartextStream);
  });

  io = require('socket.io').listen(server);

  server.listen(3000, function() {
    console.log('server bound');
  });

  io.sockets.on('connection', function (socket) {

      // When new users join
    socket.on('join', function (data, fn) {
      console.log("User connected");
      socket.set('socketname', 'name', function () {
          socket.emit('Connection received')  ;  // for the current socket
      });
    });  
      // --------------- client events

    socket.on('clientjoin', function (data) {
          client_socket = socket;
          console.log("BT Client joined");
    });

    socket.on('hello', function (data) {
          client_socket = socket;
          console.log("Hello received");
          socket.emit('Hi there!');
    });

      // When a client disconnects
    socket.on('disconnect', function () {
          socket.get('nickname', function (err, nickname) {
          console.log(nickname + " logged out")
      });
    });
  }); 
```

这是客户端中的连接：

```
socket = new SocketIO("http://"+this.serverIpAddress+":3000/"); 
```

如果我使用：

```
http://localhost:3000 
```

我收到连接拒绝错误：

```
02-22 15:37:41.702: W/System.err(621): io.socket.SocketIOException: Error while handshaking
02-22 15:37:41.702: W/System.err(621):  at io.socket.IOConnection.handshake(IOConnection.java:322)
02-22 15:37:41.702: W/System.err(621):  at io.socket.IOConnection.access$600(IOConnection.java:39)
02-22 15:37:41.702: W/System.err(621):  at io.socket.IOConnection$ConnectThread.run(IOConnection.java:199)
02-22 15:37:41.702: W/System.err(621): Caused by: java.net.ConnectException: localhost/127.0.0.1:3000 - Connection refused
02-22 15:37:41.702: W/System.err(621):  at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:207)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:437)
02-22 15:37:41.712: W/System.err(621):  at java.net.Socket.connect(Socket.java:983)
02-22 15:37:41.712: W/System.err(621):  at  org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:75)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:48)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection$Address.connect(HttpConnection.java:322)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnectionPool.get(HttpConnectionPool.java:89)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getHttpConnection(HttpURLConnectionImpl.java:285)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.makeConnection(HttpURLConnectionImpl.java:267)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.retrieveResponse(HttpURLConnectionImpl.java:1018)
02-22 15:37:41.712: W/System.err(621):  at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:512)
02-22 15:37:41.742: W/System.err(621):  at io.socket.IOConnection.handshake(IOConnection.java:313)
02-22 15:37:41.742: W/System.err(621):  ... 2 more
02-22 15:37:41.742: I/io.socket(621): Cleanup
02-22 15:55:57.352: I/dalvikvm(621): Jit: resizing JitTable from 512 to 1024
02-22 16:00:54.763: I/AsyncTask(621): onPreExecute
02-22 16:00:54.772: I/ClientActivity(621): C: Connecting...
02-22 16:00:54.782: I/AsyncTask(621): onPostExecute: Completed.
02-22 16:00:54.792: I/AsyncTask(621): an Error occured
02-22 16:00:54.792: W/System.err(621): io.socket.SocketIOException: Error while handshaking
.
.
. 
```

如果我使用

```
https://localhost:3000 
```

我得到另一个空指针错误：

```
02-22 16:06:06.432: I/AsyncTask(666): onPreExecute
02-22 16:06:06.442: I/ClientActivity(666): C: Connecting...
02-22 16:06:06.503: I/AsyncTask(666): onPostExecute: Completed.
02-22 16:06:06.512: I/AsyncTask(666): an Error occured
02-22 16:06:06.512: W/System.err(666): io.socket.SocketIOException: Error while handshaking
02-22 16:06:06.512: W/System.err(666):  at io.socket.IOConnection.handshake(IOConnection.java:322)
02-22 16:06:06.512: W/System.err(666):  at io.socket.IOConnection.access$600(IOConnection.java:39)
02-22 16:06:06.512: W/System.err(666):  at io.socket.IOConnection$ConnectThread.run(IOConnection.java:199)
02-22 16:06:06.523: W/System.err(666): Caused by: java.lang.NullPointerException
02-22 16:06:06.523: W/System.err(666):  at io.socket.IOConnection.handshake(IOConnection.java:301)
02-22 16:06:06.523: W/System.err(666):  ... 2 more 
```

我也尝试过写我的外部 IP 地址而不是 localhost 或 127.0.0.1 但它仍然不起作用，我想做什么是不可能的吗？有什么想法或建议吗？

先感谢您。

* * *

更新：

我一直在努力，但我还没有实现连接客户端和服务器。我在客户端（android）中尝试过的，因为我正在使用 Gottox 的 socket.io 库并且我无法使用 user568109 提出的解决方案，所以将其添加到我的客户端代码中：

```
 CertificateFactory cf = CertificateFactory.getInstance("X.509"); 
        InputStream caInput = new BufferedInputStream(new FileInputStream("/sdcard/cacert.crt")); 
        Certificate ca; 
        try { 
            ca = cf.generateCertificate(caInput); 
        } finally { 
            caInput.close(); 
        } 

        // Create a KeyStore containing our trusted CAs 
        String keyStoreType = KeyStore.getDefaultType(); 
        KeyStore keyStore = KeyStore.getInstance(keyStoreType); 
        keyStore.load(null, null); 
        keyStore.setCertificateEntry("ca", ca); 

        SocketIO.setDefaultSSLSocketFactory(SSLContext.getInstance("SSL"));
        socket = new SocketIO("https://"+this.serverIpAddress+":3000/"); 
```

其中，cacert.crt 是我创建的证书颁发机构的证书，我用它来签署服务器的密钥。

我可以毫无问题地通过 https 将 Web 浏览器连接到我的服务器，但我的 android 应用程序抛出以下错误：

```
02-26 16:39:18.420: I/AsyncTask(27913): onPreExecute
02-26 16:39:18.420: I/ClientActivity(27913): C: Connecting...
02-26 16:39:18.445: E/ClientActivity(27913): C: Error
02-26 16:39:18.445: E/ClientActivity(27913): java.security.cert.CertificateException: org.apache.harmony.security.asn1.ASN1Exception: ASN.1 sequence identifier expected at [0], got 43
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.provider.cert.X509CertImpl.<init>(X509CertImpl.java:106)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.provider.cert.X509CertFactoryImpl.getCertificate(X509CertFactoryImpl.java:656)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.provider.cert.X509CertFactoryImpl.engineGenerateCertificate(X509CertFactoryImpl.java:109)
02-26 16:39:18.445: E/ClientActivity(27913):    at java.security.cert.CertificateFactory.generateCertificate(CertificateFactory.java:195)
02-26 16:39:18.445: E/ClientActivity(27913):    at com.android.locaalton.CommTask.doInBackground(CommTask.java:61)
02-26 16:39:18.445: E/ClientActivity(27913):    at com.android.locaalton.CommTask.doInBackground(CommTask.java:1)
02-26 16:39:18.445: E/ClientActivity(27913):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
02-26 16:39:18.445: E/ClientActivity(27913):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
02-26 16:39:18.445: E/ClientActivity(27913):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
02-26 16:39:18.445: E/ClientActivity(27913):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
02-26 16:39:18.445: E/ClientActivity(27913):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
02-26 16:39:18.445: E/ClientActivity(27913):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
02-26 16:39:18.445: E/ClientActivity(27913):    at java.lang.Thread.run(Thread.java:856)
02-26 16:39:18.445: E/ClientActivity(27913): Caused by: org.apache.harmony.security.asn1.ASN1Exception: ASN.1 sequence identifier expected at [0],  got 43
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.asn1.BerInputStream.expected(BerInputStream.java:464)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.asn1.BerInputStream.readSequence(BerInputStream.java:502)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.asn1.DerInputStream.readSequence(DerInputStream.java:105)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.asn1.ASN1Sequence.decode(ASN1Sequence.java:40)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.asn1.ASN1Type.decode(ASN1Type.java:91)
02-26 16:39:18.445: E/ClientActivity(27913):    at org.apache.harmony.security.provider.cert.X509CertImpl.<init>(X509CertImpl.java:101)
02-26 16:39:18.445: E/ClientActivity(27913):    ... 12 more 
```

对这个新问题有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T15:25:11.050

Web 套接字可以是未加密的 ws:// 或加密的 wss:// (ws+ssl)。Socket.io 允许使用如下安全选项在两者之间进行选择：

```
<script src="http://localhost:3000/socket.io/socket.io.js"></script>
socket = io.connect('http://localhost:3000', {secure:true});     //encrypted
socket = io.connect('http://localhost:3000', {secure:false});    //unencrypted 
```

这应该满足您所有的 websocket 加密要求。无论您遇到什么错误，都是因为您试图将 tls 服务器用作 http/https 服务器。 `openssl s_client -connect localhost:3000`是访问它的正确方法。`http://localhost:3000`将需要在该地址运行的 http 服务器，但您的服务器是 tls ( [http://nodejs.org/api/tls.html#tls_tls_ssl](http://nodejs.org/api/tls.html#tls_tls_ssl) )。

您应该将其用作 https 服务器。它是 tls.Server 的子类，并发出与 http.Server 相同的事件。[http://nodejs.org/api/https.html#https_class_https_server](http://nodejs.org/api/https.html#https_class_https_server)

```
var https = require('https');   //tls changed to https
var server = https.createServer(options, function(cleartextStream) {
    console.log('server connected', 
```

您的服务器现在是 https 并且您`https://localhost:3000`应该可以工作。尝试使用它连接到它`openssl s_client`以检查它是否正常工作。

**评论后更新**

user1249517 您应该在提问时指定错误的来源。您在 node.js 、ssl 和 socket.io 下标记了它，但它应该是 java、android 和 socket。socket.io 是 javascript 库，而您正在为 socket.io 使用 gottox java 库。

无论如何，当您使用浏览器查看站点时，证书由浏览器本身管理，当您使用 java 应用程序时，它应该处理证书。你得到的错误：

```
Caused by: org.apache.harmony.security.asn1.ASN1Exception: ASN.1 sequence identifier expected at [0],  got 43 
```

ASN.1 是 X.509 证书的编码格式。`ASN.1 sequence identifier expected`这意味着您的证书已损坏/无效的 ASN.1 格式。您不应直接使用您的证书，而应使用 . 将其转换为 ASN.1 格式[`openssl`](http://man.he.net/man1/asn1parse)。尝试这样的事情。

```
openssl asn1parse -in mycert.pem 
```

指定证书的输入格式并在解析之前对其进行验证。如果所有证书都有效，则代码中存在一些错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T12:05:46.603

我更新的解决方案是创建一个证书颁发机构，用它来签署服务器的证书，并将证书安装在 android 手机中。

解决后我不得不面对新的问题，这里处理的问题：

[https://github.com/Gottox/socket.io-java-client/issues/14](https://github.com/Gottox/socket.io-java-client/issues/14)

解决方案也在链接内

希望这对某人有帮助！

# linux - /usr/bin/ld: 找不到 -lGL Xubuntu 12.10 AMD 开源

> ID：15026334
> 
> 赞同：0
> 
> 时间：2013-02-22T14:24:56.293
> 
> 标签：linux, opengl, ubuntu

我正在尝试从以下网站编译示例：[http ://www.opengl-tutorial.org/beginners-tutorials/tutorial-1-opening-a-window/](http://www.opengl-tutorial.org/beginners-tutorials/tutorial-1-opening-a-window/)

一开始`CMake`找不到libGL.so，所以我把它指向了txt文件中lib所在的位置（/usr/lib/x86_64-linux-gnu/mesa/libGL.so）。之后我尝试`make all`了，这给了我以下内容`error: /usr/bin/ld: cannot find -lGL`。根据我的发现，这意味着 ld 无法找到 libGL.so，但如果我键入，`locate libGL`我会得到以下响应：

```
/home/jacko/.local/share/Steam/SteamApps/common/Cave Story+/lib/libGLU.so.1
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libGLEW.so.1.6
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libGLEW.so.1.6.0
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libGLU.so.1
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libGLU.so.1.3.08004
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime/i386/usr/share/doc/nvidia-cg-toolkit/examples/Tools/trace/libGL.so.1.gz
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime.old/i386/usr/lib/i386-linux-gnu/libGLEW.so.1.6
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime.old/i386/usr/lib/i386-linux-gnu/libGLEW.so.1.6.0
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime.old/i386/usr/lib/i386-linux-gnu/libGLU.so.1
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime.old/i386/usr/lib/i386-linux-gnu/libGLU.so.1.3.08004
/home/jacko/.local/share/Steam/ubuntu12_32/steam-runtime.old/i386/usr/share/doc/nvidia-cg-toolkit/examples/Tools/trace/libGL.so.1.gz
/opt/cave-story-plus/lib64/libGLU.so.1
/usr/lib/i386-linux-gnu/libGLU.so.1
/usr/lib/i386-linux-gnu/libGLU.so.1.3.1
/usr/lib/i386-linux-gnu/mesa/libGL.so.1
/usr/lib/i386-linux-gnu/mesa/libGL.so.1.2.0
/usr/lib/x86_64-linux-gnu/libGLU.a
/usr/lib/x86_64-linux-gnu/libGLU.so
/usr/lib/x86_64-linux-gnu/libGLU.so.1
/usr/lib/x86_64-linux-gnu/libGLU.so.1.3.1
/usr/lib/x86_64-linux-gnu/mesa/libGL.so
/usr/lib/x86_64-linux-gnu/mesa/libGL.so.1
/usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2.0
/usr/lib/x86_64-linux-gnu/qtcreator/libGLSL.so
/usr/lib/x86_64-linux-gnu/qtcreator/libGLSL.so.1
/usr/lib/x86_64-linux-gnu/qtcreator/libGLSL.so.1.0
/usr/lib/x86_64-linux-gnu/qtcreator/libGLSL.so.1.0.0
/usr/lib/x86_64-linux-gnu/qtcreator/plugins/Nokia/libGLSLEditor.so
/usr/lib32/libGL.so 
```

在我看来，libGL 是完全可用的。

还：

```
~$ sudo apt-get install libgl1-mesa-dev
Reading package lists... Done
Building dependency tree       
Reading state information... Done
libgl1-mesa-dev is already the newest version.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded. 
```

我正在使用开源 AMD 驱动程序运行 Xubuntu 12.10。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:40:53.940

如果其他人也遇到这种情况：/usr/lib/x86_64-linux-gnu/libGL.so 和 /usr/lib/x86_64-linux-gnu/mesa/libGL.so 之间的符号链接消失了。我做了`sudo apt-get remove --purge libgl1-mesa-dev`并`sudo apt-get install ibgl1-mesa-dev* libglu1-mesa-dev* libqt4-opengl-dev* qt-sdk*`解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-30T09:53:36.723

也许这个简单的脚本会帮助某人。1 个答案也对我有帮助，但这个脚本完成了缺失的内容。

```
#!/bin/bash

DEPENDS='libx11-dev'
DEPENDS+=' libxmu-dev'
DEPENDS+=' libglu1-mesa-dev'
DEPENDS+=' libgl2ps-dev'
DEPENDS+=' libxi-dev'
DEPENDS+=' libglfw-dev'
DEPENDS+=' g++'
DEPENDS+=' libzip-dev'
DEPENDS+=' libglew*-dev'

MISSING=
echo "Checking for missing packages ..."
for i in $DEPENDS; do
    if ! dpkg-query -W --showformat='${Status}\n' $i | grep "install ok installed" > /dev/null; then
        MISSING+="$i "
    fi
done

if [ -n "$MISSING" ]; then
    TXTCOLOR_DEFAULT="\033[0;m"
    TXTCOLOR_GREEN="\033[0;32m"
    echo -e $TXTCOLOR_GREEN"Missing packages: $MISSING.\nYou may be asked for your password for package installation."$TXTCOLOR_DEFAULT
    sudo apt-get --force-yes --yes install $MISSING
fi 
```

# linux - 如何在 linux 中安全地使用 http_proxy 变量

> ID：15026337
> 
> 赞同：2
> 
> 时间：2013-02-22T14:25:11.117
> 
> 标签：linux, proxy

我`http_proxy`对我们的 linux 服务器感到很复杂。问题是我们用来通过我们的代理，这是 ldap 上的首选，所以我必须使用我机器的登录名和密码`http_proxy`才能从 ssh 客户端下载一些东西。我可以用它进行编辑`bash_profile`，我可以使用 curl 的别名，就像`curlp`我可以设置代理登录名和代理密码一样。

但无论如何，我的密码对我所有的同事都是开放的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:49:28.233

试试这个：

创建密码的加密密码：

```
openssl enc -aes-256-cbc -in mypassword.txt -out mypassword.bin 
```

**注意：**运行上述命令后，删除`mypassword.txt`文件是痛苦密码

`mypassword.bin`使用您的秘密密码运行以下命令：

```
alias myproxy='PASSWORD=`openssl aes-256-cbc -d -in mypassword.bin`; PROXY="http://$USER:$PASSWORD@proxy:$PORT"; export http_proxy=$PROXY; export https_proxy=$PROXY; export ftp_proxy=$PROXY' 
```

# asp.net - 线程处理时发生未处理的 .Net Framework 异常

> ID：15026340
> 
> 赞同：0
> 
> 时间：2013-02-22T14:25:20.100
> 
> 标签：asp.net, caching, error-handling, visual-studio-2012, runtime

我正在一个 asp.net 网站上工作。我有大量数据（大约 2000 万）并且需要缓存它们以便在我的网站中更快地查询和显示数据。我正在使用线程来执行此操作，但在访问本地计算机上的某些页面后，我收到此错误： ![未处理的 .net 框架异常 w3wp.exe](../Images/469319bf5cdb122354620ffca8c257cc.png)

我怎样才能避免这个错误或者我需要检查什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:31:09.127

尝试这个：

将未处理的异常策略更改回 .NET Framework 1.1 和 .NET Framework 1.0 中发生的默认行为。

注意我们不建议您更改默认行为。如果忽略异常，应用程序可能会泄漏资源并放弃锁。

要启用此默认行为，请将以下代码添加到`Aspnet.config`位于以下文件夹中的文件中：

**`%WINDIR%\Microsoft.NET\Framework\v2.0.50727`**

```
<configuration>
    <runtime>
        <legacyUnhandledExceptionPolicy enabled="true" />
    </runtime>
</configuration> 
```

从[这里取](http://support.microsoft.com/kb/911816)

（或）尝试使用调试诊断工具来解决您的问题。链接在这里：-

[用于诊断 .NET（ASP.NET 应用程序）中的内存泄漏的工具](https://stackoverflow.com/questions/473760/tool-for-diagnosing-memory-leaks-in-net-asp-net-application)

我还发现了一篇关于内存泄漏的好文章，阅读这篇文章，看看你的代码是否有问题：-

[http://msdn.microsoft.com/en-us/magazine/cc163491.aspx](http://msdn.microsoft.com/en-us/magazine/cc163491.aspx)

# php - 如何删除PHP中除关键字之外的所有文本？

> ID：15026342
> 
> 赞同：0
> 
> 时间：2013-02-22T14:25:34.820
> 
> 标签：php, string, text, replace, except

例子 ：

```
$str="How are you?"; 
```

现在，我想`$str`变成`"you"`<< this 的关键字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:32:51.647

```
$key = 'you';
if (strpos($str, $key) !== false {
  $str = $key;
} 
```

如果需要，您可以将其包裹在一个循环中并遍历一组关键字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:39:24.677

可能是愚蠢的建议..但是如果您正在寻找一个单词，您知道为什么不检查它？

```
<?php
$str = "how young are you?";
$key = "you";
if( preg_match("/\b".preg_quote($key)."\b/", $str, $matches) )
  $str = $key;

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:39:29.900

```
$old="How are you?";
$new="";
$keyword="you";
$pos=strpos($old,$keyword);

if ($pos!==false) {
    $new=substr($old,$pos,strlen($keyword));
}

echo $new; 
```

注意：如果或`$new`，也将包含“你”`$old="check your head"``$old="http://www.dooyou.com"`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-22T14:30:49.927

```
$str = "How are you?";
$array = explode(' ', $str);
echo $array[2];

$final = substr_replace($array[2],"",-1);
echo $final; 
```

这将适用于您给定的示例

# entity-framework - 域实体跟踪数据的最佳实践？基类还是组合？

> ID：15026343
> 
> 赞同：4
> 
> 时间：2013-02-22T14:25:37.987
> 
> 标签：entity-framework, inheritance, domain-driven-design, composition

大多数大型项目的一个共同方面是需要许多域实体上的通用跟踪数据。例如，大多数大型项目跟踪许多域实体的以下属性：

```
DateTime DateCreated
User CreatedBy
DateTime LastModified
User LastModifiedBy 
```

该数据非常易于解释，该数据用于跟踪谁在何时对域对象做了什么。

问题是在为大型应用程序设计域模型时，处理这些跟踪数据的最佳方式是什么。

经典的方法是使用基类，然后让相关的域类从该基类继承。但这引发了我**[对继承的青睐敲响了](http://en.wikipedia.org/wiki/Composition_over_inheritance)**警钟。我从事的大型项目越多，我就越会拒绝继承，但这并不是说在某些情况下它是最佳选择，例如在这种情况下。另一种继承解决方案是使用**interface**，但是虽然这种解决方案的耦合度较低，但我没有看到很多在域实体上使用这种方法的示例。

第二种方法是使用**组合**向每个域实体添加各种跟踪对象。唯一的问题是必须明确指示数据层不要将它们表示为单独的表。一项次要任务，但如果没有回报就很难证明其合理性。

处理跟踪数据的最后一种方法是将数据层配置为透明地执行此操作。**我认为使用Entity-Framework**可能可以做到这一点，但过去没有实施过这个解决方案，这将是最前期的时间密集型解决方案。很难预见这种解决方案是否值得麻烦。

虽然这个问题看起来很客观，但这实际上是大多数大型项目必须以一种或另一种方式处理的常见任务。

设计用于跟踪元数据的域模型和/或大型项目的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:51:48.717

最佳实践通常是主观的，可能会导致与解决的问题一样多的问题。你应该什么时候继承？你应该什么时候作曲？学者们花费数年时间争论问题的细节。具有简单接口的基本继承是实用且有效的。**如果它是所有**实体的标准功能，那么继承可能是更好的选择。

我有一个带有审计属性的基类，并为这些属性实现了一个接口。`context.SaveChanges()`我使用以下代码拦截对 的调用。这很简单，而且很有效。如果任何被跟踪实体未实现该`IAudit`接口，它可能会扩展为失败。

```
 public override int SaveChanges()
    {
        var entities = this.GetChangedAuditDataEntities();

        foreach (var entity in entities)
        {
            this.SetModificationInfo(entity);
        }

        return base.SaveChanges();
    }

    private IEnumerable<IAuditData> GetChangedAuditDataEntities()
    {
        return (
            from entry in _context.ChangeTracker.Entries()
            where entry.State != EntityState.Unchanged
            select entry.Entity)
            .OfType<IAuditData>();
    }

    private void SetModificationInfo(IAuditData entity)
    {
        entity.lastModifiedBy = _currentUser.Name;
        entity.lastModified = System.DateTime.Now;
    } 
```

* * *

这是不会自动获得“正确”答案的问题之一。如果 Jon Skeet 回答这个问题，那么这将被认为是最佳实践。唯一的其他正确答案将必须确认您的特定偏见，或者至少要打出正确的知识点。

多年前，继承盛行，其中的众多阻力之一就是“价值构成优于继承”的口头禅。很好，但继承有它的位置。

我建议任何具有许多相同类型对象的架构层，例如域对象（“域对象”一词暗示公共层）可以通过拥有一个公共基类来大大增强。`System.Object`就是一个很好的例子。我再举一个例子。当我们为我们的解决方案定义异常装饰器时，我们决定扩展 ToString() 方法来创建一个可以唯一标识对象的值。

```
public override string ToString()
{
    if (this is IAuditData)
    {
        IAuditDataidentifiable = this as IAuditData;
        return string.Format(@"{0} {{ id: {1}, ETag: {2} }}",
            identifiable.GetType().Name,
            identifiable.id,
            identifiable.ETag);
    }
    else return base.ToString();
} 
```

7行代码——务实、简单、有效。从你的问题来看，你听起来完全反对继承，继承必须来自许多烧伤的手指。我也是；-) 但我仍然断言在这种情况下它是更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T00:31:45.930

我喜欢qujck在他的回答和评论中所说的话，但我想补充一点，如果跟踪信息代表一个基础设施概念，我会将它们放在一些负责审计或日志记录等的基础设施层中......，否则如果它们是域概念，如果它们属于域模型层，我真的很想保留它们，在这种情况下，我将使用一个复杂的对象（值对象）来表示它们，并减轻我在创建时手动设置它们的负担一个被跟踪的对象我会定义一个方法，每当请求一个被跟踪的对象时，我的工厂或 IoC 容器都会调用该方法，我的观点是集中更改并将概念保留在它们所属的位置。

# asp.net-web-api - Web API 中的每个请求的 DependencyResolver

> ID：15026349
> 
> 赞同：8
> 
> 时间：2013-02-22T14:25:52.893
> 
> 标签：asp.net-web-api, autofac, fluentvalidation

在 MVC 中，`ModelValidatorProvider`实例化并调用 a 来验证每个请求的模型。这意味着在 DI 环境中，它可以依赖于单个请求范围内的对象，例如工作单元或数据库上下文。在 Web API 中，这似乎已经发生了重大变化。不是按请求实例化，而是`ModelValidatorProvider`在应用程序启动时似乎是长期存在的和实例化的。WebAPI 然后缓存`ModelValidatorProvider`每个类型的结果，这意味着`ModelValidator`不能从 DI 获取任何依赖项。

我正在尝试`ModelValidator`使用服务定位器来实现我的使用工厂（请不要自动进行“反模式”评论！）。这将允许我在每个请求中构造一个内部验证器对象，该对象将能够从容器中获取依赖项。但是，我无法从 this 中获取范围为当前请求的 Dependency Resolver 或容器，`ModelValidator`它本质上是作为 Singleton 范围的。我试过使用`GlobalConfiguration.Configuration.DependencyResolver`，但这只会返回全局范围的服务（从根范围，也[提到这里](https://stackoverflow.com/a/11151148/163495)）

我在 Autofac 工作，因此特定于 autofac 的解决方案将是合适的（例如 MVC 有`AutofacDependencyResolver.Current`，内部使用`DependencyResolver.GetService`）。WebAPI 集成中没有等效的可用，大概是因为上面提到的原因，全局`DependencyResolver`只返回全局范围的服务。

我尝试这样做（以及我自己使用）的原因是为 FluentValidation 实现 Web API 集成，目前不存在。到目前为止已经进行了两次尝试，但是这些都没有处理依赖注入问题，而是产生了一个静态的 ModelValidator。

到目前为止我尝试过的事情：

*   使用`GlobalConfiguration.Configuration.DependencyResolver`（从根范围返回对象）
*   依赖于`Func<IComponentContext>`（总是返回根上下文）

在已被删除的答案中，建议`IModelValidatorProvider`从 Web API 配置中删除服务。这必须使用反射来完成，因为接口和实现类都定义为内部的，但它确实使验证器工作得更好（因为 ModelValidator 是根据请求构造的）。但是，由于使用反射来检查模型上的验证器及其拥有的每个属性，因此这样做会对性能造成重大影响，因此我不想采用此选项。

Filip W 的回答建议使用 HttpRequestMessage 来获取 Dependency Scope，但我没有找到任何东西，例如`HttpRequestMessage.Current`可以从长期存在的对象中提供对该对象的访问 - 如果可以实现，我相信一切都会到位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:59:38.473

要获得当前的依赖范围，您必须使用`GetDependencyScope()`当前的(surprise,surprise :) `HttpRequestMessage`（您可以[在 MSDN 上](http://msdn.microsoft.com/en-us/library/system.net.http.httprequestmessageextensions.getdependencyscope%28v=vs.108%29.aspx)阅读更多相关信息）而不是`GlobalConfiguration`.

不久前，我在博客上写了关于[每个请求的 Web API 依赖范围](http://www.strathweb.com/2012/11/asp-net-web-api-and-dependencies-in-request-scope/)- 这应该会有所帮助。

# javascript - 如何使用 javascript 在 windows8 中填充列表

> ID：15026352
> 
> 赞同：0
> 
> 时间：2013-02-22T14:26:02.357
> 
> 标签：javascript, windows-8

我正在尝试构建一个 windows8 应用程序，我使用 SplitApp 作为基础。只是试图从 AJAX 添加数据但它失败了。

在文件 data.js 我有：

```
(function () {

    var list = new WinJS.Binding.List();

    $.each(data(), function (key, item) {
        list.push(item);
    }); 

}
})(); 
```

在我拥有的文件 app.js 中**（这有效并填充了应用程序中的列表）**

```
function data() {

   var testGroupMeeting = [];
   var testMeeting = [];

   testGroupMeeting.push(new Group({ id: "1", title: "Group1" }));

   testMeeting.push(new Meeting({ group: testGroupMeeting[0], title: "Item Title: 1"       }));

   return testMeeting;

} 
```

但是，当我想使用 AJAX 获取数据并在填充时返回 testMeeting 时，它会崩溃。

在文件 app.js 我有**（不工作），但我需要让它工作**

```
function data() {

   var testGroupMeeting = [];
   var testMeeting = [];

$.ajax({
    url: "/json/json.php",
    dataType: 'json',
    contentType: 'text/json',
    type: 'GET',
    success: function (data) {

           //Data here is correct and mapped to the arrays, its the same as in the abow example, i have the same data in the arrays as in the above example

        }
        return testMeeting;
    }

});

} 
```

但问题似乎是 AJAX 不应该返回任何东西。而且我无法对 data.js 进行回调，因为您可以看到该函数是匿名的。

你会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:47:49.923

这不能以这种方式工作，因为 $.ajax 函数是异步的：它执行 ajax 调用，然后使用适当的数据调用“成功”函数。

您将重写 $.each(data() ... 以便调用 data() 并期望它返回 testMeeting ，而不是调用 data 并期望它使用 testMetting 对象调用回调。

就像是 ：

```
(function () {

    var list = new WinJS.Binding.List();

    getData(function (theMetting) {

        $.each(theMeeting, function (key, item) {
          list.push(item);
        }); 

 }
})();

// callback is a function that will be called with 
// something that is built from the server, after the ajax
// request is done
function getData(callback) {

 $.ajax({
    // ... everything you did ... 
    success: function (data) {

       // ... use the data to build the meeting object
       // and pass it to the callback
       callback(meeting)

    }
    return testMeeting;
}

});

} 
```

同步代码（返回函数）和异步调用（做一些工作，然后用结果调用回调）之间存在根本区别。$.ajax 是典型的异步函数。

理论上，您*可以*将“async”标志传递给 ajax，以便在 Ajax 调用完成之前 $.ajax 函数不会返回，但您可能不想这样做，因为它会阻止您的 UI。

希望这会有所帮助。

# python - 在 Python 中对文件使用 grep

> ID：15026357
> 
> 赞同：1
> 
> 时间：2013-02-22T14:26:12.857
> 
> 标签：python

我在这里搜索了 grep 答案，但找不到答案。他们似乎都在文件中搜索字符串，而不是文件**中的字符串列表**。我已经有一个可以工作的搜索功能，但是 grep 做得更快。我在文件 sn.txt 中有一个字符串列表（每行一个字符串，没有分隔符）。我想在另一个文件 (Merge_EXP.exp) 中搜索匹配的行并将其写入新文件。我正在搜索的文件有 50 万行，因此在没有 grep 的情况下在那里搜索几千行需要几个小时。

当我在 Windows 中从命令提示符运行它时，它会在几分钟内完成：

```
grep --file=sn.txt Merge_EXP.exp > Merge_EXP_Out.exp 
```

如何从 Python 调用相同的过程？我真的不想要 Python 中的替代品，因为我已经有了一个可以使用但需要一段时间的替代品。除非你认为你可以显着提高性能：

```
def match_SN(serialnumb, Exp_Merge, output_exp):
    fout = open(output_exp,'a')
    f = open(Exp_Merge,'r')
    # skip first line
    f.readline()
    for record in f:
        record = record.strip().rstrip('\n')
        if serialnumb in record:
            fout.write (record + '\n')
    f.close()
    fout.close()

def main(Output_CSV, Exp_Merge, updated_exp):

    # create a blank output
    fout = open(updated_exp,'w')

    # copy header records
    f = open(Exp_Merge,'r')
    header1 = f.readline()
    fout.write(header1)
    header2 = f.readline()
    fout.write(header2)
    fout.close()
    f.close()

    f_csv = open(Output_CSV,'r')
    f_csv.readline()
    for rec in f_csv:
        rec_list = rec.split(",")
        sn = rec_list[2]
        sn = sn.strip().rstrip('\n')
        match_SN(sn,Exp_Merge,updated_exp) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:37:38.773

这是纯python代码的优化版本：

```
def main(Output_CSV, Exp_Merge, updated_exp):
    output_list = []

    # copy header records
    records = open(Exp_Merge,'r').readlines()
    output_list = records[0:2]

    serials = open(Output_CSV,'r').readlines()
    serials = [x.split(",")[2].strip().rstrip('\n') for x in serials]

    for s in serials:
        items = [x for x in records if s in x]
        output_list.extend(items)

    open(updated_exp, "w").write("".join(output_list))

main("sn.txt", "merge_exp.exp", "outx.txt") 
```

**输入**

sn.txt：

```
x,y,0011
x,y,0002 
```

合并exp.exp：

```
Header1
Header2
0011abc
0011bcd
5000n
5600m
6530j
0034k
2000lg
0002gg 
```

**输出**

```
Header1
Header2
0011abc
0011bcd
0002gg 
```

试试这个，看看需要多少时间......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T17:52:42.260

当我使用 grep 位置的完整路径时，它起作用了（我将 grep_loc、Serial_List、Export 传递给它）：

```
import os

Export_Dir = os.path.dirname(Export)
Export_Name = os.path.basename(Export)

Output = Export_Dir + "\Output_" + Export_Name
print "\nOutput: " + Output + "\n"

cmd = grep_loc + " --file=" + Serial_List + " " + Export + " > " + Output
print "grep usage: \n" + cmd + "\n"
os.system(cmd)
print "Output created\n" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-08T07:07:39.117

我认为您没有为您的问题选择正确的标题：您想要做的是相当于数据库 JOIN。在此特定情况下，您可以使用 grep，因为您的一个文件只有键，没有其他信息。但是，我认为将来您的 sn.txt 很可能（但当然我不知道您的情况）也可能包含额外信息。

所以我会解决一般情况。有多种解决方案：

*   将所有数据导入数据库，然后执行 LEFT JOIN (in sql) 或等效操作
*   使用python大数据工具

对于后者，您可以尝试[numpy](http://numpy.org)或者推荐因为您正在使用字符串[pandas](http://pandas.pydata.org/)。Pandas 有一个优化的合并例程，根据我的经验，它非常快（在引擎盖下使用 cython）。

这是解决您问题的 pandas PSEUDO 代码。它接近真实代码，但我需要知道要匹配的列的名称。我假设这里的一列`sn.txt`被调用`key`，而匹配的列`merge_txt`被调用`sn`。我还看到您在 merge_exp 中有两个标题行，请阅读文档。

```
# PSEUDO CODE (but close)
import pandas
left = pandas.read_csv('sn.txt')
right = pandas.read_csv('merge_exp.exp')
out = pandas.merge(left, right, left_on="key", right_on="sn", how='left')
out.to_csv("outx.txt") 
```

# html - 语义正确的 HTML 5 布局？

> ID：15026358
> 
> 赞同：0
> 
> 时间：2013-02-22T14:26:16.770
> 
> 标签：html, semantics

我正在重新设计我的作品集，我想测试我整理的设计，我一直在阅读 HTML 5 医生和 Smashing Books（重新设计 web #3）等资源来尝试理解正确使用某些 HTML 5 标签。

任何人都可以就这些标签在我的带注释的屏幕截图中是否正确使用提供任何反馈吗？

绿色框都是`<article>`标签，因为我看不到其他适合它们用途的 html 5 标签。百分比圆圈是统计信息，底部链接在页脚中，我可以将它们更改为 A 标记吗？

![带注释的布局](../Images/00178375b4f2253ab372ca442fa9c3ab.png)

感谢您提供的任何帮助，如果这个问题有点模糊，对不起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:35:30.833

抱歉，如果我的回答有点含糊，但我看不出您在带注释的屏幕截图中使用 html 5 标签的方式有任何问题。

# javascript - 通过 POST 下载文件

> ID：15026360
> 
> 赞同：2
> 
> 时间：2013-02-22T14:26:26.413
> 
> 标签：javascript, post, download

我正在连接[WCS](http://www.opengeospatial.org/standards/wcs)服务，并且必须将带有 XML 的 HTTP POST 请求发送到服务器以检索（二进制）光栅文件。

我设法使用 jQuery ajax 下载了文件，但我无法将实际文件内容保存到本地文件系统。

有什么办法可以做到这一点？最好我想使用浏览器内置的下载管理器来处理下载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T11:33:34.517

是的，可以从 Javascript 保存文件。基本上，它会生成一个包含二进制数据的 blob，然后使用 HTML5“下载”属性创建指向该 blob 的链接以指定所需的文件名，最后模拟单击此链接。

```
// Limited browser support! (latest release versions of Firefox & Chrome are OK)
var DownloadAttributeSupport = 'download' in document.createElement('a');
function showSave(data, name, mimetype) {
    var blob, url, builder = new BlobBuilder();
    builder.append(data);
    if (!mimetype) mimetype = "application/octet-stream";
    if (DownloadAttributeSupport) {
        blob = builder.getBlob(mimetype);
        url = URL.createObjectURL(blob);
        var link = document.createElement("a");
        link.setAttribute("href",url);
        link.setAttribute("download",name||"Download.bin");
        // Now I need to simulate a click on the link.
        // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface
        // and object URLs, so we don't need the MS way to build an event object here.
        var event = document.createEvent('MouseEvents');
        event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);
        link.dispatchEvent(event);
} 
```

您应该查看[https://stackoverflow.com/a/13059556/2227298](https://stackoverflow.com/a/13059556/2227298)以获得有关不支持 HTML5 的浏览器的替代代码的更完整答案 <a download>

# c - 从不同大小的整数转换为指针

> ID：15026364
> 
> 赞同：1
> 
> 时间：2013-02-22T14:26:44.593
> 
> 标签：c, string, pointers, casting, warnings

```
client_t *client_create_no_window(char *in, char *out); 

// ...

char line[50];
while((c = getchar()) != EOF && c != '\n')
{
    line[pos] = c;
    pos++;
}
pos=0; 
```

然后我尝试`client_create_no_window`通过首先调用该函数

```
char* first = (char*) line[1];
char* second= (char*) line[2];
client_create_no_window(first, second); 
```

我不断收到从不同大小的整数转换为指针的错误。我已经看过一些以前关于这些的帖子，但仍然无法理解为什么会这样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:33:20.883

```
char line[50]; 
```

定义一个字符数组。第二个字符 ( `line[1]`) 存储在内存中的地址处，可以使用*“地址”*运算符 ( `&`):来检索该地址`&line[1]`。

```
char* second = (char*) line [1]; 
```

获取第二个字符 ( `line[1]`) 并将其转换为指向 的指针`char`，这是不正确的。指向第二个字符的指针应使用该字符所在的地址进行初始化：

```
char* second = &line[1]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T14:36:18.060

这：

```
char*first = (char*) lines[1]; 
```

获取at的*字符*`lines[1]`，通过强制转换将其转换为`char *`（指向字符的指针，即地址），并将其存储在字符指针`first`中。

这是错误的，因为字符不是地址，所以这个赋值没有意义。

您想要的可能是该字符的地址，您可以使用“address of”运算符获得`&`：

```
char *first = &lines[1]; 
```

也可以使用指针算术编写为：

```
char *first = lines + 1; 
```

但是请注意，C 索引从零开始，因此第一个字符实际上位于`lines[0]`：

```
char *first = &lines[0]; 
```

第二*个*是在`lines[1]`：

```
char *second = &lines[1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T14:36:46.907

首先，我确定这只是一个错字，但您声明`char lines[]`了而不是`char line[]`. 其次，您是否要将 的地址`line[0]`放入`first`？那将是：

```
char *first = line; 
```

或者

```
char *first = &line[0]; 
```

相似地：

```
char *second = &line[1]; 
```

请注意，第一个和第二个字符分别位于索引 0 和 1 处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-15T18:11:30.533

如下更改您的代码（假设您真的试图将指针分配给 line[1] 和 line[2] 的值）。如果你想指向 line[1] 和 line[2] 的地址，你可以像上面描述的那样做 &line[] 并且你不必使用 reinterpret_cast 来停止关于大小的警告消息：

```
line[1] = 2;
line[2] = 0x234234;

char* first = reinterpret_cast<char *>(line[1]);
char* second= reinterpret_cast<char *>(line[2]);
client_create_no_window(first, second); 
```

第一个将指向 0x000002 第二个将指向 0x234234

reinterpret_cast 获取值并将其转换为给定***指针的类型和大小***。在较旧的编译器中，只需执行 char *ptr = (char *)23 就足够了，但新编译器知道 int（23 将存储在 int 中）不是指针的大小（通常为 64 位），它会生成警告信息。reinterpret_cast 解决了这个问题。

# ruby - Ruby 的 Imagemagick 问题

> ID：15026367
> 
> 赞同：1
> 
> 时间：2013-02-22T14:26:46.900
> 
> 标签：ruby, imagemagick, rvm

我正在尝试从命令行运行 ruby​​ 脚本，并收到以下错误：

/Users/.../.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require': dlopen(/Users/.. ./.rvm/gems/ruby-1.9.2-p320@stitching_cron/gems/rmagick-2.13.2/lib/RMagick2.bundle, 9)：库未加载：/opt/local/lib/libMagickCore.6.dylib （加载错误）

我已经安装了 ImageMagick 使用

```
brew install imagemagick 
```

并且命令行实用程序按预期可用。不知道这里发生了什么。

我试着跑步

```
sudo find / -type f -name "libMagickCore.6.dylib" 
```

看看我是否可以将文件符号链接到 Ruby 正在寻找库的位置，但找不到它......

知道如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:35:56.877

试试这个：

```
rvm get head
rvm pkg remove
rvm reinstall 1.9.2-p320 --with-opt-dir=$(brew --prefix imagemagick) 
```

# mysql - MYSQL - 使用连接删除查询

> ID：15026368
> 
> 赞同：10
> 
> 时间：2013-02-22T14:26:47.550
> 
> 标签：mysql

我已经检查了已回答的问题。但是，解决方案对我不起作用。

```
DELETE FROM TEST2
INNER JOIN TEST1 on TEST1.FIELD2 = TEST2.FIELD2
WHERE TEST1.FIELD1 = 22; 
```

当我执行此查询时，我在 phpmyadmin 中收到以下错误。

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version 
for the right syntax to use near 'INNER JOIN TEST1 on TEST1.FIELD2 = TEST2.FIELD2' at line 2 
```

我有点累了。我需要帮助。提前致谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-22T14:28:52.827

这应该有效：

```
DELETE T
FROM TEST2 T
INNER JOIN TEST1 on TEST1.FIELD2 = T.FIELD2
WHERE TEST1.FIELD1 = 22; 
```

[小提琴演示示例](http://sqlfiddle.com/#!2/2e720/1)

我认为你也可以这样做`IN`：

```
DELETE FROM Test2
WHERE Field2 IN (
    SELECT Field2 
    FROM Test1
    WHERE Field1 = 22) 
```

# iphone - ios6中的UIImagePickerController chashes

> ID：15026379
> 
> 赞同：1
> 
> 时间：2013-02-22T14:27:15.280
> 
> 标签：iphone, button, uiimagepickercontroller

当我在 ios 6 中触摸我的拍照按钮时，我的应用程序崩溃了，我真的不明白如何修复它......（我是 n00b）:)

看看我的代码 Buttons.h ：

```
 @interface Buttons : UIViewController
    <UIImagePickerControllerDelegate,
    UINavigationControllerDelegate>

    @property BOOL newMedia;
    @property (strong, nonatomic) IBOutlet UIImageView *imageView;
    - (IBAction)useCamera:(id)sender;
    - (IBAction)useCameraRoll:(id)sender;
    @end

Buttons.m :

#import "Buttons.h"

 @implementation Buttons

    - (void) useCamera:(id)sender
    {
        if ([UIImagePickerController isSourceTypeAvailable:
             UIImagePickerControllerSourceTypeCamera])
        {
            UIImagePickerController *imagePicker =
            [[UIImagePickerController alloc] init];
            imagePicker.delegate = self;
            imagePicker.sourceType =
            UIImagePickerControllerSourceTypeCamera;
            imagePicker.mediaTypes = @[(NSString *) kUTTypeImage];
            imagePicker.allowsEditing = NO;
            [self presentViewController:imagePicker
                               animated:YES completion:nil];

        }
    }
    #pragma mark -
    #pragma mark UIImagePickerControllerDelegate

    -(void)imagePickerController:(UIImagePickerController *)picker
    didFinishPickingMediaWithInfo:(NSDictionary *)info
    {

        [self dismissViewControllerAnimated:YES completion:nil];

    }

    -(void)image:(UIImage *)image
    finishedSavingWithError:(NSError *)error
     contextInfo:(void *)contextInfo
    {
        if (error) {
            UIAlertView *alert = [[UIAlertView alloc]
                                  initWithTitle: @"Save failed"
                                  message: @"Failed to save image"
                                  delegate: nil
                                  cancelButtonTitle:@"OK"
                                  otherButtonTitles:nil];
            [alert show];
        }
    }
    -(void)imagePickerControllerDidCancel:(UIImagePickerController *)picker
    {
        [self dismissViewControllerAnimated:YES completion:nil];
    }
    @end

    @implementation UIImagePickerController (NonRotating)

    - (BOOL)shouldAutorotate
    {
        return NO;
    }

    - (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
    {
        return UIInterfaceOrientationMaskPortrait;
    }

    - (NSUInteger)supportedInterfaceOrientations
    {
        return UIInterfaceOrientationMaskAll;
    }
    @end 
```

对不起，如果我太n00b无法处理:)如果有人可以阅读我的代码并解决我的小问题......我将成为世界上最快乐的人......

马蒂斯

编辑：我不知道我是否发现了错误，但这出现了：

2013-02-22 16:35:09.886 Harold[81732:c07] *** 由于未捕获的异常“NSGenericException”而终止应用程序，原因：“只有在源控制器由 UINavigationController 的实例管理时才能使用推送序列。” *** First throw call stack: (0x1e1a012 0x13bae7e 0x754f31 0x746b99 0x746c14 0x13ce705 0x3022c0 0x302258 0x3c3021 0x3c357f 0x3c26e8 0x331cef 0x331f02 0x30fd4a 0x301698 0x2053df9 0x2053ad0 0x1d8fbf5 0x1d8f962 0x1dc0bb6 0x1dbff44 0x1dbfe1b 0x20527e3 0x2052668 0x2feffc 0x2c3d 0x2b65) libc++abi.dylib: terminate called throwing an exception (lldb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:13:33.910

尝试如下按钮操作并检查：

```
UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];

imagePicker.sourceType = UIImagePickerControllerSourceTypeCamera;

imagePicker.delegate = self;

[self presentViewController:imagePicker animated:YES completion:nil]; 
```

# windows-phone-7 - 触发项目控件的事件时如何访问 listboxitem 模板数据？

> ID：15026381
> 
> 赞同：0
> 
> 时间：2013-02-22T14:27:18.927
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-8

当从以下层次结构中单击按钮时，我想访问每个 listboxitem 模板控件的（图像和 4 个文本块控件）数据。

```
 <ListBox x:Name="lstBoxNearbyPlaces" ItemsSource="{Binding Items}" Grid.Row="2" Margin="0,10,0,0"  >
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Button Width="400" Height="150" Name="btnPlace" Click="btnPlace_Click_1">
                                    <Button.Content>                                            
                                        <StackPanel Orientation="Horizontal" >                                              
                                            <Image  Name="ImgPlace"  Source="{Binding PlaceIconURL}" Width="50" />
                                            <TextBlock Name="lblPlaceLat" Text="{Binding PlaceLatLocation}" Visibility="Collapsed"/>
                                            <TextBlock Name="lblPlaceLng" Text="{Binding PlaceLongLocation}" Visibility="Collapsed"/>
                                            <StackPanel Width="350" >                                                    
                                                <TextBlock FontSize="20"   Text="{Binding PlaceName}" Name="txtAddress" TextWrapping="Wrap" ></TextBlock>                                        
                                                <TextBlock FontSize="20" Text="{Binding PlaceVicinity}" Name="txtLocation" TextWrapping="Wrap"></TextBlock>
                                            <Line MinHeight="5"></Line>
                                            </StackPanel>
                                        </StackPanel>
                                    </Button.Content>
                                </Button>
                            </DataTemplate>

                        </ListBox.ItemTemplate>
                    </ListBox> 
```

触发按钮单击事件时，是否可以在此处获取或读取每个控件的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T04:33:10.277

您可以在 ListBox_SelectionChanged 中获取绑定对象作为选中项。

```
private void ListBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
      ItemModel model= listBox.SelectedItem as ItemModel ;
    } 
```

或者在 Buttonclick 事件中，您可以将其作为

```
 private void Button_Click(object sender, RoutedEventArgs e)
    {
        Button button = sender as Button;
        ItemModel model = button.DataContext as ItemModel;
    } 
```

这里的模型是您绑定到该模板的对象。

# php - 在 PHP 应用程序中嵌入 JSF 页面（magento）

> ID：15026383
> 
> 赞同：0
> 
> 时间：2013-02-22T14:27:20.813
> 
> 标签：php, magento, jsf

我有一个使用 JSF（primefaces）制作的高级产品选择器，它在专用服务器上运行，它是更大应用程序的一部分。我还有一个在我想嵌入此产品选择器的其他服务器上运行 PHP + Magento 的网上商店。是否有可能，或者我需要实现一个新的 PHP 产品选择器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:43:54.780

Magento 需要了解您的产品。这意味着您需要一种将产品输入 magento 的方法。恕我直言，最干净的方式是通过网络服务提供产品。一旦你有了这个，你有两个选择

1.  寻找一种从浏览器 (JavaScript) 上的现有选择器中“窃取”“添加到购物车”事件的方法，并在 magento 端调用“添加到购物车”URL。
2.  一旦你拥有了 magento 中的产品，你就拥有了基于 magento/PHP 编写自己的选择器所需的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T18:23:45.473

我使用 iframe html 元素解决了这个问题。它适用于 primefaces + ajax 请求。

# java - 每秒 100 万次远程函数调用

> ID：15026384
> 
> 赞同：2
> 
> 时间：2013-02-22T14:27:21.800
> 
> 标签：java, multithreading, networking, amazon-ec2

我想实现每秒 0.5-1 百万次远程函数调用。假设我们有一`Central`台开始计算的计算机和一`Worker`台进行计算的计算机。实际配置中会有很多 Worker 计算机。

让我们假设我们的任务是计算一个`sum of [(random int from 0 to MAX_VAL)*2], PROBLEM_SIZE times` 非常天真的原型是

`Worker:`

```
//The real function takes 0.070ms to compute.
int compute(int input) {
    return input * 2;
}

void go() {
    try {
        ServerSocket ss = new ServerSocket(socketNum);

        Socket s = ss.accept();
        System.out.println("Listening for " + socketNum);

        DataInput di = new DataInputStream(s.getInputStream());
        OutputStream os = s.getOutputStream();
        byte[] arr = new byte[4];
        ByteBuffer wrap = ByteBuffer.wrap(arr);

        for (; ; ) {
            wrap.clear();

            di.readFully(arr);
            int value = wrap.getInt();
            int output = compute(value);

            wrap.clear();
            byte[] bytes = wrap.putInt(output).array();
            os.write(bytes);
        }

    } catch (IOException e) {
        System.err.println("Exception at " + socketNum);
        e.printStackTrace();
    }
} 
```

`Central:`

```
void go(){    
    try {

        Socket s = new Socket(ip, socketNum);
        s.setSoTimeout(2000);
        OutputStream os = s.getOutputStream();
        DataInput di = new DataInputStream(s.getInputStream());

        System.out.println("Central socket starting for " + socketNum);

        Random r = new Random();

        byte[] buf = new byte[4];
        ByteBuffer wrap = ByteBuffer.wrap(buf);

        long start = System.currentTimeMillis();
        long sum = 0;

        for(int i = 0; i < n; i++) {
            wrap.clear();
            int value = r.nextInt(10000);

            os.write(wrap.putInt(value).array());

            di.readFully(buf);
            wrap.clear();

            int answer = wrap.getInt();
            sum += answer;
        }

        System.out.println(n + " calls in " + (System.currentTimeMillis() - start) + " ms");
    } catch(SocketTimeoutException ste) {
        System.err.println("Socket timeout at " + socketNum);
    }

    catch (Exception e) {
        e.printStackTrace();
    } 
```

如果 ping 为 0.150 毫秒，并且我们运行 1 线程 Worker 和 1 线程 Central，则每次迭代将花费约 0.150 毫秒。为了提高性能，我`N`在 Worker 和 Central 上运行线程，`n`-th 线程监听 port `2000+n`。每个线程停止后，我们对结果进行总结。

**基准**

首先，我在我同事的学校网络中运行了上面的程序。其次，我在两个 Amazon EC2 集群实例上运行它。结果差距非常大。

`CHUNK_SIZE = 100_000`在所有运行中。

**同学网络：**

我认为 3 年前它是可用的顶级配置（至强 E5645）。我相信它针对并行计算进行了高度优化，并且具有简单的 LAN 拓扑，因为它只有 20 台机器。

操作系统：Ubuntu

平均ping：~0.165ms

```
N=1 total time=6 seconds 
N=10 total time=9 seconds
N=20 total time=11 seconds
N=32 total time=14 seconds
N=100 total time=21 seconds
N=500 total time=54 seconds 
```

**亚马逊网络：**

我在同一个置放群组中启动的两个 Cluster Compute Extra Large Instance (cc2.8xlarge) 上运行了该程序。

操作系统是一些亚马逊的 linux

平均 ping：~0.170 毫秒。

结果有点令人失望：

```
N=1 total time=16 seconds 
N=10 total time=36 seconds
N=20 total time=55 seconds
N=32 total time=82 seconds
N=100 total time=250 seconds
N=500 total time=1200 seconds 
```

我对每个配置运行了 2-4 次，结果相似，大多为 +-5%

Amazon N=1 结果是有意义的，因为每个函数调用 0.170 毫秒 = 每秒 6000 次调用 = 每 16 秒 100_000 次调用。6秒对于Fellow的网络来说，其实是令人惊讶的。

我认为现代网络每秒的最大 TCP 数据包约为每秒 40-70k。它对应于 N=100, time=250 秒：N*CHUNK_SIZE / time = 100 * 100_000packets / 250sec = 10_000_000packets / 250sec = 40_000packets/second。

**问题是**，我的研究员的网络/计算机配置如何做到如此出色，尤其是在 N 值较高的情况下？

我的猜测：将每个 4 字节请求和 4 字节响应放入单个数据包是很浪费的，因为有大约 40 字节的开销。明智的做法是将所有这些微小的请求集中起来，例如 0.010 毫秒，并将它们放入一个大数据包中，然后将请求重新分配到相应的套接字。可以在应用程序级别实现池化，但似乎 Fellow 的网络/操作系统已配置为执行此操作。

更新：我玩过 java.net.Socket.setTcpNoDelay()，它没有改变任何东西。

**最终目标**：我使用非常大的树来近似具有数百万个变量的方程。目前，具有 200_000 个节点的树适合 RAM。但是，我对需要具有数百万个节点的树的近似方程很感兴趣。这将需要几 TB 的 RAM。算法的基本思想是从节点到叶子的随机路径，并沿着它改进值。当前程序是 32 线程的，每个线程每秒执行 15000 次迭代。我想将它移动到具有相同每秒迭代次数的集群。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:57:17.277

您可能希望启用 Nagle 算法：[wikipedia entry](http://en.wikipedia.org/wiki/Nagle's_algorithm)。

这是一个关于禁用它的链接，它可能会有所帮助：[在 linux 中禁用 Nagle 算法](https://stackoverflow.com/questions/14743971/disabling-nagles-algorithm-in-linux)

# javascript - SqueezeBox.initialize : 对象没有方法采用

> ID：15026386
> 
> 赞同：0
> 
> 时间：2013-02-22T14:27:26.083
> 
> 标签：javascript, jquery, squeezebox

我正在尝试在我的网站上实现 SqueezeBox.js，但遇到了问题。

这是我的代码：

```
<script type="text/javascript" src="/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="/js/mootools-1.2.6-core.js"></script>
<script type="text/javascript" src="/js/SqueezeBox/SqueezeBox.js"></script>
<script type="text/javascript">
    $(function() {
        $("#connect").click(function () {
            SqueezeBox.initialize({
                size: {x: 350, y: 400}
            });
            SqueezeBox.open('..\connect.php', {handler: 'iframe'});
        });
    });
</script>

...

<a id="connect" href="#">CONNEXION</a> 
```

当我点击我的链接时，Chrome 控制台显示：“未捕获的 TypeError：Object [object Object] has no method 'adopt'”

我试图将“ SqueezeBox.initialize({ }); ”从 Click 事件中删除，并且出现同样的错误。所以，SqueezeBox 似乎有问题，但我找不到。

有小费吗？

此致

* * *

好的，所以我决定查看 SqueezeBox.js 以了解发生了什么。

我在第 113 行看到，女​​巫是控制台报告的行：

```
$(this.doc.body).adopt(this.overlay, this.win); 
```

我只是将其替换为：

```
this.doc.body.adopt(this.overlay, this.win); 
```

它现在完美运行......

我猜它来自Jquery的版本或其他东西..

无论如何，谢谢，再见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:35:39.770

您在元素存在之前调用 .js 函数。您可以尝试将您的 javascript 移动到页面末尾，就在结束 '' 标记之前。更好的是，当你使用 jQuery 时，为什么不把它放在一个 '$(document).ready()' 块中呢？

```
$(document).ready(function() {
    $("#connect").click(function () {
        SqueezeBox.initialize({
            size: {x: 350, y: 400}
        });
        SqueezeBox.open(\'..\connect.php\', {handler: \'iframe\'});
    });
}); 
```

这样它在页面加载之前不会运行。

# c# - 如果原始图像不可用，如何显示默认图像？

> ID：15026387
> 
> 赞同：0
> 
> 时间：2013-02-22T14:27:26.490
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

在我看来，我正在使用此代码，我想显示设备图像，但如果没有上传原始图像，我想显示一个默认图像（NoImage.jpg），但默认图像不显示......

```
 @if (item.EquipImage != null)
          {
         <td><img src="@Url.Content("~/Content/EquipImages/" + System.IO.Path.GetFileName(item.EquipImage))" alt="" width="70" height="70"/> </td>
          }else
          {
               <td><img src="@Server.MapPath("~/Content/EquipImages/NoImage.jpg")" alt="" width="70" height="70"/> </td>
          } 
```

==================================================== =================== 在 Jsmith 和 Json 的帮助下，代码正在运行.. 我在这里粘贴的工作代码可能对某些人有帮助:)

```
 @if(! string.IsNullOrEmpty(item.EquipImage)){

            <td><img src="@Url.Content("~/Content/EquipImages/" + System.IO.Path.GetFileName(item.EquipImage))" alt="" width="70" height="70"/> </td>
            }else{
               <td><img src="@Url.Content("~/Content/EquipImages/NoImage.jpg")" alt="" width="70" height="70"/> </td>
          } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:46:27.507

为什么使用 Server.MapPath 作为默认图像而不是 Url.Content？改用 Url.Content 应该可以解决问题。

如果不存在，请检查您指定的路径中是否存在图像，但将路径粘贴到浏览器的 url 中并按 enter。或使用 Fiddler 或浏览器开发工具来帮助您

# iis - 在 IIS 7 中使用 existingResponse="PassThrough" 时如何显示静态文件的错误页面

> ID：15026390
> 
> 赞同：4
> 
> 时间：2013-02-22T14:27:30.497
> 
> 标签：iis, umbraco, custom-error-pages

为了能够让我的应用程序（Umbraco CMS）处理 404 错误，我需要在我的 web.config 中进行以下设置：

```
<httpErrors existingResponse="PassThrough" /> 
```

它适用于显示来自 Umbraco 的自定义 404 错误页面，但它不适用于在找不到静态文件时显示 404 错误页面。

例如[http://www.example.com/non-existing-file.png](http://www.example.com/non-existing-file.png)返回 404 状态码，但响应为空。这符合 PassThrough 模式的描述：

> PassThrough - 如果existingResponse 被视为“PassThrough”，自定义错误模块将始终传递来自模块的响应。如果模块未设置任何文本，此设置将使自定义错误模块返回空白响应。（[http://blogs.iis.net/ksingla/archive/2008/02/18/what-to-expect-from-iis7-custom-error-module.aspx](http://blogs.iis.net/ksingla/archive/2008/02/18/what-to-expect-from-iis7-custom-error-module.aspx)）

什么是“自定义错误模块”？以及如何让它返回非空白响应？

**更新**

在逐步完成 Umbraco 中的请求处理例程（使用调试器）之后，我对问题空间有了更好的理解。如上面的引文所述，当existingResponse="PassThrough" 时，所有http 错误的处理都在自定义模块中完成。因此，要回答我自己的问题，在这种情况下，“自定义错误模块”就是“UmbracoModule”。

解决此问题的一种方法是创建一个新的自定义模块，该模块将检查磁盘上是否存在静态文件。它可以做得很好，我从 IIS 中读取静态文件列表并从 web.config 中读取 customErrors 或 httpErrors 元素的配置以获取自定义错误页面。但我有点认为这是粗略的解决方案。我宁愿将责任转回给 IIS。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-24T22:03:49.967

你是对的。为了其他寻求帮助的人的利益，这里有一些关于 404 处理的额外信息。

*   [旧 Umbraco wiki 页面](https://our.umbraco.org/wiki/install-and-setup/configuring-404-pages)- 使用文件 /config/umbracoSettings.config 描述您的解决方案

*   [404 for files](https://our.umbraco.org/forum/umbraco-7/using-umbraco-7/58066-404-for-files) - 适用于 Umbraco 7 并描述标签 <httpErrors/> 的使用

*   [IIS 版本 6 修复](https://our.umbraco.org/forum/using/ui-questions/8244-IIS7-404)- 修复 IIS6 以及它与 IIS7 的比较

# javascript - 仍然收到带有过期标头的 304

> ID：15026396
> 
> 赞同：0
> 
> 时间：2013-02-22T14:27:44.857
> 
> 标签：javascript, http, apache2

我正在使用这个`.htaccess`

```
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 seconds"
  ExpiresByType image/x-icon "access plus 2692000 seconds"
  ExpiresByType image/jpeg "access plus 2692000 seconds"
  ExpiresByType image/png "access plus 2692000 seconds"
  ExpiresByType image/gif "access plus 2692000 seconds"
  ExpiresByType application/x-shockwave-flash "access plus 2692000 seconds"
  ExpiresByType text/css "access plus 2692000 seconds"
  ExpiresByType text/javascript "access plus 2692000 seconds"
  ExpiresByType application/x-javascript "access plus 2692000 seconds"
  ExpiresByType text/html "access plus 600 seconds"
  ExpiresByType application/xhtml+xml "access plus 600 seconds"
</IfModule>
<IfModule mod_headers.c>
  <FilesMatch "\\.(ico|jpe?g|png|gif|swf|css|js)$">
    Header set Cache-Control "max-age=2692000, public"
  </FilesMatch>
  <FilesMatch "\\.(x?html?|php)$">
    Header set Cache-Control "max-age=600, private, must-revalidate"
  </FilesMatch>
  Header unset ETag
  Header unset Last-Modified
</IfModule> 
```

我的大部分文件都是从浏览器缓存中加载的，但有些会得到 304。

其中一些只是网络服务器目录中的符号链接，但不是全部。任何想法为什么会发生这种情况？

# linux - 用于远程复制然后处理文件的 Shell 脚本

> ID：15026399
> 
> 赞同：0
> 
> 时间：2013-02-22T14:27:48.813
> 
> 标签：linux, shell, unix, hp-ux

下面的脚本工作正常。但是，当我尝试向远程副本添加命令，然后使用从远程副本接收到的文件分配变量 FILENAME 时，while 循环不起作用。我对脚本很陌生，所以我无法找出我缺少的东西。请帮忙！

```
#!/bin/sh
#SCRIPT:  File processing
#PURPOSE: Process a file line by line with redirected while-read loop.
SSID=$1
ASID=$2
##rcp server0:/oracle/v11//dbs/${SSID}_ora_dir.lst /users/global/rahul/${ASID}_clone_dir.lst
##FILENAME=/users/global/rahul/${ASID}_clone_dir.lst
count=0
while read LINE
do
echo $LINE | sed -e "s/${SSID}/${ASID}/g"
count=`expr $count + 1`
done < $FILENAME
echo -e "\nTotal $count Lines read"
grep -v -e "pattern3" -e "pattern5" -e "pattern6" -e "pattern7" -e "pattern8" -e "pattern9" -e "pattern10" -e "pattern11" -e "
pattern12" ${ASID}_.lst > test_remote.test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T07:31:51.297

当您说“while 循环不起作用”时，如果您收到错误消息，您应该将其包含在您的问题中，以便为我们提供线索。

你确定`rcp`命令成功了吗？完成后文件是否`/users/global/rahul/${ASID}_clone_dir.lst`存在`rcp`？

顺便说一句，您的`while`循环效率低下。这应该是等效的：

```
sed -e "s/${SSID}/${ASID}/g" < "$FILENAME"
count=$(wc -l "$FILENAME" | awk '{print $1}')
echo -e "\nTotal $count Lines read" 
```

# c# - 通过 NSubstitute 中的回调验证调用参数

> ID：15026401
> 
> 赞同：5
> 
> 时间：2013-02-22T14:27:55.183
> 
> 标签：c#, unit-testing, callback, mocking, nsubstitute

我在 NSubstitute 中有一个失败的测试，因为传递给替换调用的参数不匹配。以下是正在测试的相关代码：

```
// Arrange
PermissionsProviderSub = Substitute.For<IPermissionsProvider>();
MenuDataProviderSub = Substitute.For<IMenuDataProvider>();
PermissionsProviderSub.GetPermissions(UserId).Returns(ExpectedUserPermissions);
MenuDataProviderSub.GetMenuData(ExpectedUserPermissions.AuthorisedPageIds).Returns(Arg.Any<IList<BusinessFocusArea>>());            
var sut = new MenuViewModelFactory(MenuDataProviderSub, PermissionsProviderSub);

// Act
var result = sut.Create();

// Assert
MenuDataProviderSub.Received().GetMenuData(ExpectedUserPermissions.AuthorisedPageIds); 
```

问题出现在`ExpectedUserPermissions.AuthorisedPageIds`属性中，如下所示：

```
public IEnumerable<string> AuthorisedPageIds
{
    get
    {
        return ApplicationPagePermissions != null ? 
            ApplicationPagePermissions.Select(permissionSet => permissionSet.PageId) :
            Enumerable.Empty<string>();
    }
} 
```

如您所见，有一个 LINQ Select，它`PageId`从`ApplicationPagePermissions`集合中提取属性并将其作为`IEnumerable<string>`. 因为该属性中的投影创建了一个新对象，所以替换不匹配，因为它认为这 2 个对象是不同的。

**我可以在传入的参数上创建一个回调，`GetMenuData`以便我可以检查它的值吗？**

[NSubstitute 回调](http://nsubstitute.github.com/help/callbacks/)的文档只讨论了检查调用的返回值，而不是传递给调用的参数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T14:51:31.680

典型的。一旦我发布到 SO，答案就会出现。在创建替代调用时，我期望任何类型的实例并在检查实际验证值`IEnumerable<string>`的调用时创建回调，而不是期望特定对象。`Received()`替代调用变成了这样：

```
MenuDataProviderSub.GetMenuData(Arg.Any<IEnumerable<string>>()).Returns(Arg.Any<IList<BusinessFocusArea>>()); 
```

`Received()`支票变成了这样：

```
MenuDataProviderSub.Received().GetMenuData(Arg.Is<IEnumerable<string>>(a => VerifyPageIds(ExpectedUserPermissions.AuthorisedPageIds, a)));

private static bool VerifyPageIds(IEnumerable<string> expected, IEnumerable<string> actual)
{
    var expectedIds = expected.ToList();
    var actualIds = actual.ToList();
    return expectedIds.Count == actualIds.Count && expectedIds.All(actualIds.Contains);
} 
```

# java - 出现错误消息：HTTP 状态 404 - 没有为命名空间 / 和操作名称映射操作

> ID：15026405
> 
> 赞同：0
> 
> 时间：2013-02-22T14:28:07.543
> 
> 标签：java, struts2

```
<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.1//EN"
        "http://struts.apache.org/dtds/struts-2.1.dtd">

<struts>
    <constant name="struts.enable.DynamicMethodInvocation" value="false"/>
    <constant name="struts.devMode" value="false"/>

    <package name="loginPkg"  extends="struts-default">
        <global-results>
            <result name="unhandledException">/unhandled-exception.jsp</result>
        </global-results>

        <global-exception-mappings>
            <exception-mapping exception="java.lang.Exception" result="unhandledException"/>
        </global-exception-mappings>
        <action name="Login" class="loginPkg.Login_validate">
            <result name="success">/Home.jsp</result>
            <result name="admin">/AdminHome.jsp</result>
            <result name="error">/empLogin.jsp</result>
        </action>
        <action name="logout" class="loginPkg.Logout">
            <result name="success">/Logout.jsp</result>
            <result name="logout" type="redirect">/Logout.jsp</result>
        </action>
        <action name="empforgot_pass" class="loginPkg.forgotPswd">
            <result name="success">/empForgotPass.jsp</result>
        </action>
        <action name="empForgotPass" method="display" class="loginPkg.forgotPswd">
            <result name="none">/empForgotPass.jsp</result>
        </action>
    </package>

</struts> 
```

当我运行我的应用程序时，它给了我某种错误

```
HTTP Status 404 - There is no Action mapped for namespace / and action name . 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T18:05:58.960

您收到错误是因为您忘记设置`namespace`包声明的属性。Struts2 正在尝试获取您发出的请求的映射，但没有命名空间它无法为您创建映射，因此无法调用该操作，结果为 404。使用

```
<package name="loginPkg"  namespace="/" extends="struts-default"> 
```

# vba - 从批处理文件中启用 Office 2007 应用程序中的宏？

> ID：15026407
> 
> 赞同：0
> 
> 时间：2013-02-22T14:28:12.690
> 
> 标签：vba, batch-file, outlook

我正在使用批处理文件来启动 Outlook 和 Excel 2007，如下所示：

```
start "" "C:\Program Files\Microsoft Office\Office12\OUTLOOK.EXE"
start "" "C:\Program Files\Microsoft Office\Office12\EXCEL.EXE"
"C:\Users\username\Documents\Productivity\gtd_active.xlsm" 
```

Outlook 和 Excel 都包含我每次都必须启用的宏，我希望通过命令行来执行此操作。

我用 Excel 尝试了以下操作：

```
start "" "C:\Program Files\Microsoft Office\Office12\EXCEL.EXE"
"C:\Users\username\Documents\Productivity\gtd_active.xlsm" /mtestMeStartup 
```

尝试启动宏（这不起作用，我仍然会收到“启用宏”警告）。我曾希望这会自动触发“启用宏”选项。

如何传递参数（或其他方式）以从批处理文件启动 Excel/Outlook 并自动启用宏？

* * *

注意：[此链接](http://office.microsoft.com/en-us/word-help/command-line-switches-for-microsoft-office-word-2007-HP010164010.aspx)表明这可能是不可能的...：\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T16:51:12.843

您正在询问通过代码禁用宏，这将使安全性几乎没有使用。

您可以自行签署您的代码（[http://office.microsoft.com/en-us/excel-help/security-iii-sign-your-own-macros-for-stronger-security-RZ010238036.aspx?section= 5](http://office.microsoft.com/en-us/excel-help/security-iii-sign-your-own-macros-for-stronger-security-RZ010238036.aspx?section=5)），我相信你可以使用一个受信任的位置。在大多数情况下，我喜欢自签名代码，但它特定于您在其上创建证书的计算机。

# java - 未使用 log4j 配置

> ID：15026408
> 
> 赞同：1
> 
> 时间：2013-02-22T14:28:13.157
> 
> 标签：java, jakarta-ee, struts2, log4j

我的 log4j 记录器不想使用`log4j.xml`要配置的文件。该文件位于`src`文件夹中，如下所示：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration>
    <appender name="ROLLING" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="C:\debug\myproject\logfile.log" />
        <param name="MaxFileSize" value="10024KB" />
        <param name="MaxBackupIndex" value="5" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%-5p %d{dd-MM HH:mm:ss,SSS} (%F:%M:%L)  -%m%n" />
        </layout>
        <filter class="org.apache.log4j.varia.LevelRangeFilter">
            <param name="LevelMin" value="DEBUG" />
            <param name="LevelMax" value="FATAL" />
        </filter>
    </appender>
    <root>
        <level value="DEBUG" />
        <appender-ref ref="ROLLING" />
    </root>
</log4j:configuration> 
```

但是`logfile.log`仍然是空的，并且`DEBUG`控制台中没有行。

注意：这是一个基于 JBoss 7.1.0 并使用 Struts2 的 Java EE 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-02T17:04:49.887

**The following answer is not entirely mine. It was posted in the question itself by the OP, so I'm moving it into this community wiki answer.**

* * *

I resolved it by explicitely configuring the logging configuration.

Note that you won't be able to change the configuration at runtime if you configure it using a file.

For more information, see: [https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F](https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T16:00:18.453

确保 log4j.xml 文件位于`/WEB-INF/classes`Web 应用程序的目录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T18:58:25.333

问题出在日志文件上。如果您使用绝对文件名，请确保将反斜杠替换为斜杠。例如

```
<param name="File" value="C:/debug/myproject/logfile.log" /> 
```

# colors - 灰度 CMYK 像素

> ID：15026409
> 
> 赞同：3
> 
> 时间：2013-02-22T14:28:13.190
> 
> 标签：colors, rgb, grayscale, cmyk

我需要将 CMYK 图像转换为灰度 CMYK 图像。起初我以为我可以使用与 RGB -> 灰度转换相同的方法，例如 (R + G + B) / 3 或 max(r, g, b) / 2 + min(r, g, b)。但不幸的是，这对 CMYK 很不利，因为 CMY 和 K 是多余的。黑色 cmyk (0, 0, 0, 255) 将变为 64。我应该使用

```
int grayscaled = max((c + m + y) / 3, k) 
```

还是会更棘手？我不确定，因为 CMYK 实际上是一种冗余颜色模型，相同的颜色可以用不同的方式编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T02:16:28.433

有几种方法可以转换`RGB`为灰度，所提到的通道的平均值就是其中之一。使用`Y`来自颜色空间的通道`YCbCr`也是一个常见选项，以及`L`来自 的通道`LAB`，以及其他选项。

根据[http://www.easyrgb.com/index.php?X=MATH](http://www.easyrgb.com/index.php?X=MATH)中的公式转换`CMYK`为便宜，然后您可以使用众所周知的方法转换为灰度。假设, , , 和在 [0, 1] 范围内，我们可以将其转换为灰度亮度，如下所示：`RGB``c``m``y``k`

```
def cmyk_to_luminance(c, m, y, k):
    c = c * (1 - k) + k
    m = m * (1 - k) + k
    y = y * (1 - k) + k

    r, g, b = (1 - c), (1 - m), (1 - y)
    y = 0.299 * r + 0.587 * g + 0.114 * b
    return y 
```

另请参阅[http://en.wikipedia.org/wiki/Grayscale](http://en.wikipedia.org/wiki/Grayscale)了解更多关于此转换为灰度的信息。

# sql - PL/pgSQL 查询 - 遍历表问题

> ID：15026410
> 
> 赞同：-1
> 
> 时间：2013-02-22T14:28:15.230
> 
> 标签：sql, postgresql, concatenation, plpgsql

我在 PL/pgSQL 中编写了以下函数，它应该循环遍历一个表并`points`为每个现有行收集存储在列中的值。现在，我的问题是我不太确定是否可以将所有这些字段值连接到单个`character varying`数据类型对象中。

目前我的函数包含以下代码（但它仍然没有按预期工作）：

```
DECLARE 
     _r record;
     point character varying;
     test character varying;

BEGIN

FOR _r IN EXECUTE ' SELECT st_y(a.'|| quote_ident(column_name) || ') AS p1, st_x(a.'||  quote_ident(column_name) || ') AS p2
       FROM ' || quote_ident (table_name) ||' AS a'
LOOP
       test = _r;
       point = point || '|' || test;
END LOOP;

RETURN point;
END; 
```

关于如何以最简单的方式实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:35:11.463

是的，您可以使用内置`string_agg()`功能。如果只是这样，那么一个 SQL 函数就足够了。

```
create or replace function r()
returns text as $$

    select string_agg(s.*::text, ','::text)
    from (
        values (1, 2), (3, 4)
    ) s(a, b)
    ;
$$ language sql

select r();
      r      
-------------
 (1,2),(3,4) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:08:33.873

另外，这不会`point = point || '|' || test;`不断覆盖`point`吗？

应该是`point := point || '|' || test;`吗？

此外，`_r`被声明为记录，因此必须设置 test `_r.a`，因为这就是您命名的结果。

# java - @SuppressWarnings - 静态变量

> ID：15026412
> 
> 赞同：2
> 
> 时间：2013-02-22T14:28:21.213
> 
> 标签：java

**@SuppressWarnings**使用哪个参数来隐藏**警告（209.56）：静态变量应该由类型名称 javax.swing.ListSelectionModel 限定，而不是由表达式限定**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:42:13.257

这个：

```
@SuppressWarnings("static-access") 
```

对反对者来说，是的，理想情况下，代码是固定的。但在现实世界中，遗憾的是，这并不总是可能的。此外，这不是@user941059 要求的。

# mysql - 格式化magento集合查询？

> ID：15026415
> 
> 赞同：0
> 
> 时间：2013-02-22T14:28:39.660
> 
> 标签：mysql, magento

我正在加载一个 magento 集合，并通过 getSelect() 方法回显它的选择查询。但是，它返回给我一个巨大的未格式化的查询（全部在一行中）......很难以这种方式调试它......

有谁知道以某种方式简单地格式化 sql 查询的方法？

我知道在 phpmyadmin 中，如果您选择并运行它，它会以某种方式很好地格式化它，但是对于这个查询它不会发生。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:31:06.843

好的，谷歌搜索后找到了答案：

[http://www.dpriver.com/pp/sqlformat.htm](http://www.dpriver.com/pp/sqlformat.htm)

此链接将您带到一个网站，如果您需要在文本框中输入您的 sql 查询，选择语言（mssql、mysql..etc），然后只需单击 Format Sql，它就会为您呈现一个格式化的 sql 版本刚进

非常有用的网站:)

# mongodb - 基于 GUI 的 nosql 与 netbeans ide 的集成

> ID：15026418
> 
> 赞同：0
> 
> 时间：2013-02-22T14:28:45.200
> 
> 标签：mongodb, oracle-nosql, nosql

是否有没有像 Oracle 数据库那样的 GUI 而不是命令提示符的 No SQL 数据库？

我目前想要一个带有节点和列表的数据库。我发现 MongoDB 没有 GUI。另外，我想将它集成到我的 NeatBeans IDE 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-31T15:23:00.740

[NBMongo](https://github.com/le-yams/netbeans-mongodb)是一个与 MongoDB 交互的 NetBeans 插件。它适用于 NetBeans 7.4 和 8.0（您可以直接通过 NetBeans 更新中心安装它）。另请参阅[NetBeans 插件门户上的插件页面](http://plugins.netbeans.org/plugin/52638/nbmongo)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T03:29:20.030

据我所知，Oracle 数据库提供了一个桌面客户端。如果这就是您正在寻找的东西，那么可能会有一些东西在那里[1](http://mongohub.todayclose.com)

现在，如果您正在寻找的也可以是 Web 界面，那么我建议您看看[RethinkDB](http://www.rethinkdb.com)，它提供了一个精致的管理和数据浏览器，还有[CouchDB](http://couchdb.apache.org)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T17:18:28.273

[此处](http://docs.mongodb.org/ecosystem/tools/administration-interfaces/)列出了许多用于 MongoDB 的第三方 GUI

# sql - 如何在 DELETE 语句中使用行的物理位置 (ROWID)

> ID：15026420
> 
> 赞同：4
> 
> 时间：2013-02-22T14:28:47.533
> 
> 标签：sql, database, postgresql, rowid

我有一个有很多重复行且没有主键的表。
我只想删除重复的记录，但是当我尝试这样做时，它会删除所有对等点。

如何`ROWID`从 Postgres 的表中找到？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:28:47.533

在 PostgreSQL 上，行的物理位置称为 CTID。

因此，如果您想查看它，请使用如下查询：

```
SELECT CTID FROM table_name 
```

要在 DELETE 语句中使用它来删除重复的记录，请像这样使用它：

```
DELETE FROM table_name WHERE CTID NOT IN (
  SELECT RECID FROM 
    (SELECT MIN(CTID) AS RECID, other_columns 
      FROM table_name GROUP BY other_columns) 
  a); 
```

请记住，table_name 是所需的表，而 other_columns 是您要用于过滤的列。

IE：

```
DELETE FROM user_department WHERE CTID NOT IN (
  SELECT RECID FROM 
    (SELECT MIN(CTID) AS RECID, ud.user_id, ud.department_id
      FROM user_department ud GROUP BY ud.user_id, ud.department_id) 
  a); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T15:19:50.057

通过一个查询级别将其简化：

```
DELETE FROM table_name
WHERE  ctid NOT IN (
   SELECT min(ctid)
   FROM   table_name
   GROUP  BY $other_columns); 
```

.. 其中重复项由`$other_columns`.
无需在列表中包含`GROUP BY`子句中的`SELECT`列，因此您不需要另一个子查询。

[`ctid`在当前手册中。](http://www.postgresql.org/docs/current/interactive/ddl-system-columns.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-10T09:20:15.060

您应该考虑使用`row_number()`if want to delete 基于唯一的 id 列（或时间戳），因为`ctid`当您只想保留最近的记录等时，单独使用并不总是可靠的。

```
WITH d 
     AS (SELECT ctid c, 
                row_number() 
                  OVER ( 
                    partition BY s 
                    ORDER BY id) rn 
         FROM   t) 
DELETE FROM t 
WHERE  ctid IN (SELECT c 
               FROM   d 
               WHERE  rn > 1)  ; 
```

[**演示**](https://dbfiddle.uk/?rdbms=postgres_9.6&fiddle=619d215d2b7b4b804f136f8c55067b79)

# eclipse - 在 eclipse 和命令提示符下运行时，Lint 给出不同的结果

> ID：15026425
> 
> 赞同：1
> 
> 时间：2013-02-22T14:28:55.560
> 
> 标签：eclipse, random

我试图在我的 android 项目中找到所有未使用的资源。但是当我通过 Eclipse 运行 Lint 时，当我从命令行运行它时，结果是不同的。Lint 在 Eclipse 中显示的未使用资源的数量比从命令行运行时要多得多。谁能告诉我原因？

# c# - 隐藏控制台窗口

> ID：15026427
> 
> 赞同：1
> 
> 时间：2013-02-22T14:29:01.987
> 
> 标签：c#

我正在使用一个小的 C# 可执行文件来启动一个 java jar。我想恢复 jar 返回的退出代码，以便在需要时重新启动 jar。但是 c# 应用程序一直显示黑色控制台窗口，我无法摆脱它，有谁知道如何解决这个问题？我正在使用以下 C# 代码来启动该过程

```
System.Diagnostics.Process p = new System.Diagnostics.Process();
p.StartInfo.FileName = "jre/bin/java.exe";
p.StartInfo.Arguments = "-Djava.library.path=bin -jar readermanager.jar";
p.StartInfo.UseShellExecute = false;
p.StartInfo.CreateNoWindow = true;
p.StartInfo.RedirectStandardOutput = true;

p.Start();

p.waitForExit();
return p.ExitCode; 
```

控制台窗口仅在使用 waitForExit() 时保持可见；方法。没有它（并且没有 p.ExitCode），控制台窗口将关闭。我还尝试将 StartInfo.WindowStyle 设置为 Hidden 和 Minimized 但两者都对窗口没有任何影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:31:59.150

只需将 C# 程序的输出类型更改为“Windows 应用程序”而不是“控制台应用程序”。AC# Windows 应用程序并不真正关心您是否实际显示任何窗口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:32:36.627

来自[如何在隐藏控制台的情况下运行 C# 控制台应用程序](https://stackoverflow.com/questions/836427/how-to-run-a-c-sharp-console-application-with-the-console-hidden)

```
System.Diagnostics.ProcessStartInfo start =
  new System.Diagnostics.ProcessStartInfo();     
start.FileName = dir + @"\Myprocesstostart.exe";
start.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; 
```

但如果这不起作用，怎么样： http: [//social.msdn.microsoft.com/Forums/eu/csharpgeneral/thread/ea8b0fd5-a660-46f9-9dcb-d525cc22dcbd](http://social.msdn.microsoft.com/Forums/eu/csharpgeneral/thread/ea8b0fd5-a660-46f9-9dcb-d525cc22dcbd)

```
using System.Runtime.InteropServices;

[DllImport("user32.dll")]
public static extern IntPtr FindWindow(string lpClassName,string lpWindowName);

[DllImport("user32.dll")]
static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

IntPtr hWnd = FindWindow(null, "Window caption here");

if(hWnd != IntPtr.Zero)
{
    //Hide the window
    ShowWindow(hWnd, 0); // 0 = SW_HIDE
}

if(hWnd != IntPtr.Zero)
{
   //Show window again
   ShowWindow(hWnd, 1); //1 = SW_SHOWNORMA
} 
```

# xml - Magento 布局 XML 文件覆盖

> ID：15026435
> 
> 赞同：4
> 
> 时间：2013-02-22T14:29:08.737
> 
> 标签：xml, magento, layout, module, overriding

我正在尝试开发自己的 magento 模块，但我遇到了要覆盖的 xml 布局文件的问题。我正在研究一种从 /customer/account/login 个性化登录表单的方法。

为此，我有以下文件

```
app/
  etc/
    modules/
      - IT_CustomerCar.xml 
  code/
      local/
          IT/ 
              CustomerCar/ 
                  Block/
                      Customer/
                          From/
                              Login.php
                  controllers/
                    - AccountController.php
                  etc/
                    - config.xml
design/
    frontend/
        base/
            default/
              layout/
                  - customercar.xml
              template/
                  customercar/
                      form/
                          - login.phtml' 
```

我的目标是覆盖 /design/frontend/base/default/layout/customer.xml 文件以个性化登录表单。

现在，更具体地说明我的文件

config.xml 包含以下几行：

```
<config>
<modules>
    <it_customercar>
        <version>0.1.0</version>
    </it_customercar>
</modules>
<global>
    <rewrite>
        <it_customercar_customer_account>
            <from><![CDATA[#^/customer/account/#]]>
            </from>
            <to>/customercar/account/</to>
        </it_customercar_customer_account>
    </rewrite>
    <blocks>
        <customer>
            <rewrite>
                <form_login>IT_CustomerCar_Block_Customer_Form_Login</form_login>
            </rewrite>
        </customer>    
        <helpers>
            <customercar>
                <class>It_CustomerCar_Helper</class>
            </customercar>
        </helpers>
    </blocks>
</global>
<frontend>
    <routers>
        <it_customercar>
            <use>standard</use>
            <args>
                <module>IT_CustomerCar</module>
                <frontName>customercar</frontName>
            </args>
        </it_customercar>
    </routers>
    <layout>
        <updates>
            <it_customercar>
                <file>customercar.xml</file>
            </it_customercar>
        </updates>
    </layout> 
</frontend> 
```

我的 customercar.xml（假设是我的 xml 布局文件）如下：

```
<?xml version="1.0"?>
<layout version="0.1.0">
    <default>
    </default>
    <customercar_account_login>
        <label>MODULE : Customer Account Login Form</label>
        <reference name="content">
            <block type="core/template" name="customercar_form_login" output="toHtml" template="customercar/form/login.phtml" ></block>
        </reference>
    </customercar_account_login>
</layout> 
```

在我的块 IT_CustomerCar_Block_Customer_Form_Login 上，我添加了这一行`return $html . 'block';`以检查它是否确实被调用。它是。正如预期的那样，在我的登录表单下方有一个“阻止”字符串。

另一方面，customercar.xml 文件似乎被忽略了。我使用 Allan Storm LayoutViewer 模块来检查我的页面，布局仍然是来自核心的布局。

编辑：我还在`var_dump($this->getTemplate());`Block 类的 _toHtml 方法上添加了一个。它显示了这一行：`string(36) "persistent/customer/form/login.phtml"`。我真的不明白为什么顺便说一句。我期望“/customer/form/login.phtml”，而不是“持久”文件夹中的那个。

我想我遗漏了一些明显的东西，但我试图从论坛和教程中得到很多建议，但没有成功。这个问题似乎很常见，我想我可以快速解决它。我错了...我希望你能帮助我，

谢谢 ：）

## 解决方案

我设法用 dagfr 的答案解决了这个问题。

首先，我从后端和`/app/etc/modules/Mage_Persistent.xml`.

然后，我将我的 customercar.xml 文件更改为

```
<customer_account_login>
<reference name="customer_form_login">
    <action method="setTemplate"><template>customercar/form/login.phtml</template></action>
</reference> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T15:49:06.220

1）您必须删除持久的东西，它不会帮助发现问题，因为它没有使用正确的模板。

2) 您所做的更改将使 yoursite.com/customercar/account/login 页面使用您的模板，而不是 yoursite.com/customer/account/login 页面。这是你需要的吗？

3）你使用：

```
<block type="core/template" name="customercar_form_login" output="toHtml" template="customercar/form/login.phtml" ></block> 
```

这不应该是核心/模板块，而是 customer/form_login 块（被您的块覆盖）。

4）您更改其名称，因此如果您在正确的文件中没有 getChildHtml ，则不会调用它。

总而言之，你应该这样做：

```
<customer_account_login>
    <reference name="customer_form_login">
        <action method="setTemplate"><template>customercar/form/login.phtml</template></action>
    </reference>
</customer_account_login> 
```

这将表示登录块（被覆盖的）在原始页面中使用您的新模板

# android - 从 AdapterView 制作数组

> ID：15026437
> 
> 赞同：0
> 
> 时间：2013-02-22T14:29:27.863
> 
> 标签：android

是否可以从中获取视图数组`onItemSelected()`？因为我需要为当前视图设置动画并从其他视图中清除动画，这可能吗？

```
 @Override
        public void onItemSelected(AdapterView<?> adV, View view, int currentIndex, long l) 
        {

                view.startAnimation(AnimationUtils.loadAnimation(currentContext, R.anim.scale_anim));
                adV[currentIndex + 1].clearAnimation();
                adV[currentIndex - 1].clearAnimation();

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:56:22.333

您可以像这样遍历 AdapterView 的子项：

```
int count = adV.getChildCount();
for (int i = 0; i < count; i++) {
    View v = adV.getChildAt(i);
    view.clearAnimation();
} 
```

当然，您还需要检查视图是否是当前视图并跳过它。

# android - 关闭 Android 应用

> ID：15026443
> 
> 赞同：1
> 
> 时间：2013-02-22T14:29:46.077
> 
> 标签：android, android-activity

我有一个简单的问题。我设置了关闭我的应用程序的按钮：

```
Button turnoffbutt = (Button) findViewById(R.id.button3);
turnoffbutt.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View arg0) {
        System.exit(0);
    }
}); 
```

它工作得很好，但只有当我打开我的应用程序时。当我通过按钮打开另一个活动时

```
startActivity(new Intent(MenuActivity.this, SettingsActivity.class)); 
```

然后我回到无法退出我的应用程序的菜单（通过此按钮关闭）。它让我进入设置活动。我知道这个方法（startactivity）正在创建一个新的活动。这就是为什么我无法退出我的应用程序。但是如何解决这个问题呢？我是否必须在 turnoffbutt 上更改某些内容或使用其他方法才能进行其他活动？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:32:51.077

通常，您不应明确“退出”或“关闭”您的应用程序，因为这不是 Android 的设计方式。但是，如果你真的想做这样的事情，你可以只是`finish`活动，像这样：

```
Button turnoffbutt = (Button) findViewById(R.id.button3);
turnoffbutt.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View arg0) {
        finish();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:32:22.963

`finish()`在开始另一个活动之前调用。当您点击 SettingsActivity 中的后退按钮时，这将使您的应用关闭

我建议您阅读[这篇](http://blog.radioactiveyak.com/2010/05/when-to-include-exit-button-in-android.html)文章以更好地理解您所询问的内容

# javascript - 谷歌地图标记未显示 API v3

> ID：15026447
> 
> 赞同：13
> 
> 时间：2013-02-22T14:29:56.117
> 
> 标签：javascript, google-maps-api-3

标记没有出现，我阅读了文档但我找不到问题，有人可以帮我吗？

继承人的js：

```
function initialize() {
      var mapOptions = {
        center: new google.maps.LatLng(-8.064903, -34.896872),
        zoom: 16,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

      var marker = new google.maps.Marker({
          position: location,
          title:"Hello World!",
          visible: true
      });
      marker.setMap(map);
    } 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-22T14:33:01.537

我的猜测是你的`location`对象没有定义。尝试将标记位置设置为与地图中心相同的 LatLng 并查看它是否有效：

```
function initialize() {
  latLng = new google.maps.LatLng(-8.064903, -34.896872)
  var mapOptions = {
    center: latLng,
    zoom: 16,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

  var marker = new google.maps.Marker({
      position: latLng,
      title:"Hello World!",
      visible: true
  });
  marker.setMap(map);
} 
```

# javascript - 围绕轴问题旋转画布

> ID：15026450
> 
> 赞同：1
> 
> 时间：2013-02-22T14:30:03.113
> 
> 标签：javascript, html, canvas, graph, html5-canvas

我正在使用画布 3d 绘制一个 3d 图形，在该图形中我可以绘制 (1,5,4)、(-8,6,-2) 等点。所以我能够绘制所有正负 x， y 和 z 轴。我也可以通过使用箭头键来实现旋转效果。旋转说明： z 轴从屏幕中心向外延伸。

要绕 x 轴旋转，请按向上/向下箭头键。要绕 y 轴旋转，请按左/右箭头键。要绕 z 轴旋转，请按 ctrl+left/ctrl+down 箭头键。

我可以通过在我提供的文本字段中指定点来绘制点。现在的问题是，例如，如果我 plot(5,5,2) 它将正确绘制。但是如果我先旋转 x 轴然后旋转 y 轴，那么点将被正确绘制。如果我先旋转 y 轴然后旋转 x 轴，就会出现问题。该点将被错误地绘制。找到我遇到的问题的简单方法：如果您继续重复绘制同一点，这很容易找到。该点应绘制在同一点上方，以便只有单个点可见。但在我的情况下，同一点（对于ex（5,5,2）在旋转时在画布的不同位置绘制。只有当我先旋转y轴然后旋转x轴或者我先旋转z轴然后旋转y轴时才会出现这个问题。那又如何是我在编码中犯的错误。我是这个画布 3d 和 java 脚本的新手。所以请帮忙。

```
<html>

 <head>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<title>Canvas Surface Rotation</title>

<style>

  body {

    text-align: center;

  }

  canvas {

    border: 1px solid black;

  }

</style>

<script>  

var p1;
var p2;
var p3;
var p4;
var p5;
var p6;
var xangle=0;
var yangle=0;
var zangle=0;
  var constants = {

    canvasWidth: 600, // In pixels.

    canvasHeight: 600, // In pixels.

    leftArrow: 37,

    upArrow: 38,

    rightArrow: 39,

    downArrow: 40,

    xMin: -10, // These four max/min values define a square on the xy-plane that the surface will be plotted over.

    xMax: 10,

    yMin: -10,

    yMax: 10, 

    xDelta: 0.06, // Make smaller for more surface points. 

    yDelta: 0.06, // Make smaller for more surface points. 

    colorMap: ["#000080"], // There are eleven possible "vertical" color values for the surface, based on the last row of http://www.cs.siena.edu/~lederman/truck/AdvanceDesignTrucks/html_color_chart.gif

    pointWidth: 2, // The size of a rendered surface point (i.e., rectangle width and height) in pixels.

    dTheta: 0.05, // The angle delta, in radians, by which to rotate the surface per key press.

    surfaceScale: 24 // An empirically derived constant that makes the surface a good size for the given canvas size.

  };

  // These are constants too but I've removed them from the above constants literal to ease typing and improve clarity.

  var X = 0;

  var Y = 1;

  var Z = 2;

  // -----------------------------------------------------------------------------------------------------  

  var controlKeyPressed = false; // Shared between processKeyDown() and processKeyUp().

  var surface = new Surface(); // A set of points (in vector format) representing the surface.

  // -----------------------------------------------------------------------------------------------------

  function point(x, y, z)

  /*

    Given a (x, y, z) surface point, returns the 3 x 1 vector form of the point.

  */

  {       

    return [x, y, z]; // Return a 3 x 1 vector representing a traditional (x, y, z) surface point. This vector form eases matrix multiplication.

  }

  // -----------------------------------------------------------------------------------------------------

  function Surface()

  /*

    A surface is a list of (x, y, z) points, in 3 x 1 vector format. This is a constructor function.

  */

  {

    this.points = [];
    // An array of surface points in vector format. That is, each element of this array is a 3 x 1 array, as in [ [x1, y1, z1], [x2, y2, z2], [x3, y3, z3], ... ]

  }

  // -----------------------------------------------------------------------------------------------------  

  Surface.prototype.equation = function(x, y)

  /*

    Given the point (x, y), returns the associated z-coordinate based on the provided surface equation, of the form z = f(x, y).

  */

  {

    var d = Math.sqrt(x*x + y*y); // The distance d of the xy-point from the z-axis.

    return 4*(Math.sin(d) / d); // Return the z-coordinate for the point (x, y, z). 

  }

  // -----------------------------------------------------------------------------------------------------  

  Surface.prototype.generate = function()

  /*

    Creates a list of (x, y, z) points (in 3 x 1 vector format) representing the surface.

  */

  {

    var i = 0;

    for (var x = constants.xMin; x <= constants.xMax; x += constants.xDelta)

    {

      for (var y = constants.yMin; y <= constants.yMax; y += constants.yDelta)

      {

        this.points[i] = point(x, y, this.equation(x, y)); // Store a surface point (in vector format) into the list of surface points.              

        ++i;

      }

    }

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.color = function()

  /*

    The color of a surface point is a function of its z-coordinate height.

  */

  {

    var z; // The z-coordinate for a given surface point (x, y, z).

    this.zMin = this.zMax = this.points[0][Z]; // A starting value. Note that zMin and zMax are custom properties that could possibly be useful if this code is extended later.

    for (var i = 0; i < this.points.length; i++)

    {            

      z = this.points[i][Z];

      if (z < this.zMin) { this.zMin = z; }

      if (z > this.zMax) { this.zMax = z; }

    }   

    var zDelta = Math.abs(this.zMax - this.zMin) / constants.colorMap.length; 

    for (var i = 0; i < this.points.length; i++)

    {

      this.points[i].color = constants.colorMap[ Math.floor( (this.points[i][Z]-this.zMin)/zDelta ) ];

    }

    /* Note that the prior FOR loop is functionally equivalent to the follow (much less elegant) loop:       

    for (var i = 0; i < this.points.length; i++)

    {

      if (this.points[i][Z] <= this.zMin + zDelta) {this.points[i].color = "#060";}

      else if (this.points[i][Z] <= this.zMin + 2*zDelta) {this.points[i].color = "#090";}

      else if (this.points[i][Z] <= this.zMin + 3*zDelta) {this.points[i].color = "#0C0";}

      else if (this.points[i][Z] <= this.zMin + 4*zDelta) {this.points[i].color = "#0F0";}

      else if (this.points[i][Z] <= this.zMin + 5*zDelta) {this.points[i].color = "#9F0";}

      else if (this.points[i][Z] <= this.zMin + 6*zDelta) {this.points[i].color = "#9C0";}

      else if (this.points[i][Z] <= this.zMin + 7*zDelta) {this.points[i].color = "#990";}

      else if (this.points[i][Z] <= this.zMin + 8*zDelta) {this.points[i].color = "#960";}

      else if (this.points[i][Z] <= this.zMin + 9*zDelta) {this.points[i].color = "#930";}

      else if (this.points[i][Z] <= this.zMin + 10*zDelta) {this.points[i].color = "#900";}          

      else {this.points[i].color = "#C00";}

    }

    */

  }

  // -----------------------------------------------------------------------------------------------------

  function update(){
document.querySelector("#xa").innerHTML = xangle;
document.querySelector("#ya").innerHTML = yangle;
document.querySelector("#za").innerHTML = zangle;
}

  function appendCanvasElement()

  /*

    Creates and then appends the "myCanvas" canvas element to the DOM.

  */

  {

    var canvasElement = document.createElement('canvas');

    canvasElement.width = constants.canvasWidth;

    canvasElement.height = constants.canvasHeight;

    canvasElement.id = "myCanvas";

    canvasElement.getContext('2d').translate(constants.canvasWidth/2, constants.canvasHeight/2); // Translate the surface's origin to the center of the canvas.

    document.body.appendChild(canvasElement); // Make the canvas element a child of the body element.

  }

  //------------------------------------------------------------------------------------------------------

  Surface.prototype.sortByZIndex = function(A, B) 

  {

    return A[Z] - B[Z]; // Determines if point A is behind, in front of, or at the same level as point B (with respect to the z-axis).

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.draw = function()

  {

    var myCanvas = document.getElementById("myCanvas"); // Required for Firefox.

    var ctx = myCanvas.getContext("2d");
    var res;
    var xm;

   // this.points = surface.points.sort(surface.sortByZIndex); // Sort the set of points based on relative z-axis position. If the points are visibly small, you can sort of get away with removing this step.

    for (var i = 0; i < this.points.length; i++)

    {

      ctx.fillStyle = this.points[i].color; 

      ctx.fillRect(this.points[i][X] * constants.surfaceScale, this.points[i][Y] * constants.surfaceScale, constants.pointWidth, constants.pointWidth);

    }    

var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
ctx.font="12px Arial";
ctx.fillStyle = "#000000";
ctx.fillText("X",this.points[p1][X] * constants.surfaceScale, this.points[p1][Y] * constants.surfaceScale);
var c=document.getElementById("myCanvas");
var ctx1=c.getContext("2d");
ctx1.font="12px Arial";
ctx1.fillText("Y",this.points[p2][X] * constants.surfaceScale, this.points[p2][Y] * constants.surfaceScale);
var c=document.getElementById("myCanvas");
var ctx1=c.getContext("2d");
ctx1.font="12px Arial";
ctx1.fillText("Z",this.points[p3][X] * constants.surfaceScale, this.points[p3][Y] * constants.surfaceScale);

var c=document.getElementById("myCanvas");
var ctx1=c.getContext("2d");
ctx1.font="12px Arial";
ctx1.fillText("-Y",this.points[p4][X] * constants.surfaceScale, this.points[p4][Y] * constants.surfaceScale);

var c=document.getElementById("myCanvas");
var ctx1=c.getContext("2d");
ctx1.font="12px Arial";
ctx1.fillText("-Z",this.points[p5][X] * constants.surfaceScale, this.points[p5][Y] * constants.surfaceScale);

var c=document.getElementById("myCanvas");
var ctx1=c.getContext("2d");
ctx1.font="12px Arial";
ctx1.fillText("-X",this.points[p6][X] * constants.surfaceScale, this.points[p6][Y] * constants.surfaceScale);

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.multi = function(R)

  /*

    Assumes that R is a 3 x 3 matrix and that this.points (i.e., P) is a 3 x n matrix. This method performs P = R * P.

  */

  {

    var Px = 0, Py = 0, Pz = 0; // Variables to hold temporary results.

    var P = this.points; // P is a pointer to the set of surface points (i.e., the set of 3 x 1 vectors).

    var sum; // The sum for each row/column matrix product.

    for (var V = 0; V < P.length; V++) // For all 3 x 1 vectors in the point list.

    {

      Px = P[V][X], Py = P[V][Y], Pz = P[V][Z];

      for (var Rrow = 0; Rrow < 3; Rrow++) // For each row in the R matrix.

      {

        sum = (R[Rrow][X] * Px) + (R[Rrow][Y] * Py) + (R[Rrow][Z] * Pz);

        P[V][Rrow] = sum;

      }

    }     

  }
Surface.prototype.multipt = function(R)

  /*

    Assumes that R is a 3 x 3 matrix and that this.points (i.e., P) is a 3 x n matrix. This method performs P = R * P.

  */

  {

    var Px = 0, Py = 0, Pz = 0; // Variables to hold temporary results.

    var P = this.points; // P is a pointer to the set of surface points (i.e., the set of 3 x 1 vectors).

    var sum; // The sum for each row/column matrix product.

    for (var V = P.length-1; V < P.length; V++) // For all 3 x 1 vectors in the point list.

    {

      Px = P[V][X], Py = P[V][Y], Pz = P[V][Z];

      for (var Rrow = 0; Rrow < 3; Rrow++) // For each row in the R matrix.

      {

        sum = (R[Rrow][X] * Px) + (R[Rrow][Y] * Py) + (R[Rrow][Z] * Pz);

        P[V][Rrow] = sum;

      }

    }     

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.erase = function()

  {

    var myCanvas = document.getElementById("myCanvas"); // Required for Firefox.

    var ctx = myCanvas.getContext("2d");

    ctx.clearRect(-constants.canvasWidth/2, -constants.canvasHeight/2, myCanvas.width, myCanvas.height);

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.xRotate = function(sign)

  /*

    Assumes "sign" is either 1 or -1, which is used to rotate the surface "clockwise" or "counterclockwise".

  */

  {

    var Rx = [ [0, 0, 0],

               [0, 0, 0],

               [0, 0, 0] ]; // Create an initialized 3 x 3 rotation matrix.

    Rx[0][0] = 1;

    Rx[0][1] = 0; // Redundant but helps with clarity.

    Rx[0][2] = 0; 

    Rx[1][0] = 0; 

    Rx[1][1] = Math.cos( sign*constants.dTheta );

    Rx[1][2] = -Math.sin( sign*constants.dTheta );

    Rx[2][0] = 0; 

    Rx[2][1] = Math.sin( sign*constants.dTheta );

    Rx[2][2] = Math.cos( sign*constants.dTheta );

    this.multi(Rx); // If P is the set of surface points, then this method performs the matrix multiplcation: Rx * P

    this.erase(); // Note that one could use two canvases to speed things up, which also eliminates the need to erase.

    this.draw();

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.yRotate = function(sign)

  /*

    Assumes "sign" is either 1 or -1, which is used to rotate the surface "clockwise" or "counterclockwise".

  */      

  {

    var Ry = [ [0, 0, 0],

               [0, 0, 0],

               [0, 0, 0] ]; // Create an initialized 3 x 3 rotation matrix.

    Ry[0][0] = Math.cos( sign*constants.dTheta );

    Ry[0][1] = 0; // Redundant but helps with clarity.

    Ry[0][2] = Math.sin( sign*constants.dTheta );

    Ry[1][0] = 0; 

    Ry[1][1] = 1;

    Ry[1][2] = 0; 

    Ry[2][0] = -Math.sin( sign*constants.dTheta );

    Ry[2][1] = 0; 

    Ry[2][2] = Math.cos( sign*constants.dTheta );

    this.multi(Ry); // If P is the set of surface points, then this method performs the matrix multiplcation: Rx * P

    this.erase(); // Note that one could use two canvases to speed things up, which also eliminates the need to erase.

    this.draw();

  }

  // -----------------------------------------------------------------------------------------------------

  Surface.prototype.zRotate = function(sign)

  /*

    Assumes "sign" is either 1 or -1, which is used to rotate the surface "clockwise" or "counterclockwise".

  */      

  {

    var Rz = [ [0, 0, 0],

               [0, 0, 0],

               [0, 0, 0] ]; // Create an initialized 3 x 3 rotation matrix.

    Rz[0][0] = Math.cos( sign*constants.dTheta );

    Rz[0][1] = -Math.sin( sign*constants.dTheta );        

    Rz[0][2] = 0; // Redundant but helps with clarity.

    Rz[1][0] = Math.sin( sign*constants.dTheta );

    Rz[1][1] = Math.cos( sign*constants.dTheta );

    Rz[1][2] = 0;

    Rz[2][0] = 0

    Rz[2][1] = 0;

    Rz[2][2] = 1;

    this.multi(Rz); // If P is the set of surface points, then this method performs the matrix multiplcation: Rx * P

    this.erase(); // Note that one could use two canvases to speed things up, which also eliminates the need to erase.

    this.draw();

  }

Surface.prototype.xRotatept = function()

  {

    var Rx = [ [0, 0, 0],

               [0, 0, 0],

               [0, 0, 0] ]; 

    Rx[0][0] = 1;

    Rx[0][1] = 0; 

    Rx[0][2] = 0; 

    Rx[1][0] = 0; 

    Rx[1][1] = Math.cos(xangle);

    Rx[1][2] = -Math.sin(xangle);

    Rx[2][0] = 0; 

    Rx[2][1] = Math.sin(xangle);

    Rx[2][2] = Math.cos(xangle);

    this.multipt(Rx); 

    this.erase(); 

    this.draw();

  }

  Surface.prototype.yRotatept = function()

  {

    var Ry = [ [0, 0, 0],

               [0, 0, 0],

               [0, 0, 0] ]; 

    Ry[0][0] = Math.cos(yangle);

    Ry[0][1] = 0;

    Ry[0][2] = Math.sin(yangle);

    Ry[1][0] = 0; 

    Ry[1][1] = 1;

    Ry[1][2] = 0; 

    Ry[2][0] = -Math.sin(yangle);

    Ry[2][1] = 0; 

    Ry[2][2] = Math.cos(yangle);

    this.multipt(Ry); 

    this.erase(); 

    this.draw();

  }

  Surface.prototype.zRotatept = function()

  {

    var Rz = [ [0, 0, 0],

               [0, 0, 0],

               [0, 0, 0] ];

    Rz[0][0] = Math.cos(zangle);

    Rz[0][1] = -Math.sin(zangle);        

    Rz[0][2] = 0; 

    Rz[1][0] = Math.sin(zangle);

    Rz[1][1] = Math.cos(zangle);

    Rz[1][2] = 0;

    Rz[2][0] = 0

    Rz[2][1] = 0;

    Rz[2][2] = 1;

    this.multipt(Rz); 

    this.erase(); 

    this.draw();

  }

  // -----------------------------------------------------------------------------------------------------

  function processKeyDown(evt)

  {                    

    if (evt.ctrlKey)

    {

      switch (evt.keyCode)

      {

        case constants.upArrow: 

          // No operation other than preventing the default behavior of the arrow key.

          evt.preventDefault(); // This prevents the default behavior of the arrow keys, which is to scroll the browser window when scroll bars are present. The user can still scroll the window with the mouse.              

          break;

        case constants.downArrow:

          // No operation other than preventing the default behavior of the arrow key.

          evt.preventDefault();

          break;

        case constants.leftArrow:

          // console.log("ctrl+leftArrow");
                zangle=zangle-0.05;
                update();
        if(zangle<=-2*Math.PI)
        {
            zangle=0;

        }
          surface.zRotate(-1); // The sign determines if the surface rotates "clockwise" or "counterclockwise". 

          evt.preventDefault(); 

          break;

        case constants.rightArrow:

          // console.log("ctrl+rightArrow");
            zangle=zangle+0.05;
            update();
        if(zangle>=2*Math.PI)
        {
            zangle=0;

        }
          surface.zRotate(1);

          evt.preventDefault(); 

          break;

      }

      return; // When the control key is pressed, only the left and right arrows have meaning, no need to process any other key strokes (i.e., bail now).

    }

    // Assert: The control key is not pressed.

    switch (evt.keyCode)

    {

      case constants.upArrow:

        // console.log("upArrow");

        xangle=xangle+0.05;
        update();
        if(xangle>=2*Math.PI)
        {
            xangle=0;

        }

        surface.xRotate(1);

        evt.preventDefault(); 

        break;

      case constants.downArrow:

        // console.log("downArrow");
        xangle=xangle-0.05;
        update();
        if(xangle<=-2*Math.PI)
        {

            xangle=0;
        }

        surface.xRotate(-1); 

        evt.preventDefault(); 

        break;

      case constants.leftArrow:

        // console.log("leftArrow");
        yangle=yangle-0.05;
        update();
        if(yangle<=-2*Math.PI)
        {
            yangle=0;

        }
        surface.yRotate(-1);  

        evt.preventDefault(); 

        break;

      case constants.rightArrow:

        // console.log("rightArrow");
        yangle=yangle+0.05;
        update();
        if(yangle>=2*Math.PI)
        {
            yangle=0;

        }
        surface.yRotate(1);   

        evt.preventDefault(); 

        break;

    }

  }

  // -----------------------------------------------------------------------------------------------------
Surface.prototype.plot = function(x, y, z)
  /*
    add the point (x, y, z)  (in 3 x 1 vector format) to the surface.
  */
  {

        this.points.push(point(x, y, z)); // Store a surface point
        var x=0;
        for (var x = constants.xMin; x <= constants.xMax; x += constants.xDelta)
        {
        this.points.push(point(x, 0, 0));
        }
        p6=1;
        p1=this.points.length-1;
        p4=this.points.length;
        /*var y=-0.2
        for (var x = constants.xMax+1; x <= constants.xMax+2; x += constants.xDelta)
        {
        this.points.push(point(x, y, 0));
        y=y+0.002
        }*/

        /*for (var x = constants.xMax+1; x <= constants.xMax+2; x += constants.xDelta)
        {
        this.points.push(point(11, 0, 0))
        }*/
        for (var x = constants.xMin; x <= constants.xMax; x += constants.yDelta)
        {
        this.points.push(point(0, x, 0));   
        }
        p2=this.points.length-1;
        p5=this.points.length;
        for (var x = constants.xMin; x <= constants.xMax; x += constants.yDelta)
        {
        this.points.push(point(0,0,x)); 
        }
        p3=this.points.length-1;

  }
  Surface.prototype.plot1 = function(x, y, z)
  /*
    add the point (x, y, z)  (in 3 x 1 vector format) to the surface.
  */
  {      

        this.points.push(point(x, y, z)); // Store a surface point
    surface.xRotatept();
    surface.yRotatept();

    surface.zRotatept();
        this.draw();

  }

  function onloadInit()

  {

    appendCanvasElement(); // Create and append the canvas element to the DOM.

    surface.draw(); // Draw the surface on the canvas.

    document.addEventListener('keydown', processKeyDown, false); // Used to detect if the control key has been pressed.

  }

  // -----------------------------------------------------------------------------------------------------

  //surface.generate(); // Creates the set of points reprsenting the surface. Must be called before color().
surface.plot(0,0,0);
  surface.color(); // Based on the min and max z-coordinate values, chooses colors for each point based on the point's z-ccordinate value (i.e., height).

  window.addEventListener('load', onloadInit, false); // Perform processing that must occur after the page has fully loaded.

    </script>

 </head>

  <body>
<table align="center">
<tr><td>
<h5 style="color:#606">Enter the value of (X,Y,Z)</h5>
            <input type="text" value="5" class="num-input" width="50" size="2" id="x-input">
            <input type="text" value="5" class="num-input" width="50" size="2" id="y-input">
            <input type="text" value="2" class="num-input" width="50" size="2" id="z-input">
            <input type="button" value="Plot Point" onClick="surface.plot1(document.getElementById('x-input').value,document.getElementById('y-input').value,document.getElementById('z-input').value); ">

            </td></tr></table>
<table align="center"> <tr><td>
<span id="xa">0</span>deg<br>
<span id="ya">0</span>deg<br>
 <span id="za">0</span>deg</td></tr></table>
 </body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:56:30.520

沿多轴旋转的最终输出可能会根据您旋转轴的顺序而有所不同。您需要做的是跟踪沿每个轴的总旋转（作为三个数字，不使用矩阵）。并且每次更新旋转值时，以正确的顺序将所有三个总旋转应用于单位矩阵（尝试 x、y、z）。始终使用相同的顺序。然后用它来转换你的坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T12:37:44.073

这是我的意见：

**JAVASCRIPT**

```
var canvas = document.getElementById("myCanvas");
var ctx2 = canvas.getContext("2d");
ctx2.fillStyle='#333';

ctx2.fillRect(50,50,100,100);
var ctx = canvas.getContext("2d");

ctx.fillStyle='red';

var deg = Math.PI/180;

ctx.save();
    ctx.translate(100, 100);
    ctx.rotate(45 * deg);
    ctx.fillRect(-50,-50,100,100);
ctx.restore(); 
```

ctx2 是旧位置，ctx 是形状的新位置。您必须根据要放置形状的位置来平移具有相同 x,y 坐标的形状。然后您必须输入值以`ctx.fillRect(x,y,w,h);`将 x 和 y 保持为 -ve 值（高度和宽度的一半以将其保持在画布的对角线上，否则更改以操纵它）。和 h, w 作为您想要的值。

**[演示](http://jsfiddle.net/anshalexander/HTxGb/55/)**

# android - NDEF 签名记录 Android

> ID：15026451
> 
> 赞同：0
> 
> 时间：2013-02-22T14:30:03.433
> 
> 标签：android, nfc, record, signature, ndef

无论如何在Android中向我的NDEF消息添加签名记录？

我正在为我的论文开发一个 P2P 票务系统（因为在非 root 设备上无法访问 SE），并希望通过在发件人的 NDEF 消息中添加签名记录来增加安全性。

NFC 论坛在 2010 年发布了 NDEF 消息的签名记录类型定义（[http://www.nfc-forum.org/specs/spec_license/document_form/custom_layout?1361543311878](http://www.nfc-forum.org/specs/spec_license/document_form/custom_layout?1361543311878)），但无论如何我都找不到将其添加到我的消息中在安卓中。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:13:07.957

我的这个[Eclipse 插件支持签名记录，您可以使用](http://code.google.com/p/nfc-eclipse-plugin/)[这个](http://code.google.com/p/ndef-tools-for-android/)Android nfc 库以编程方式创建此类记录。然而，记录所代表的功能背后没有端到端。请参阅[此](http://code.google.com/p/nfcsigning/)站点作为起点，但请注意代码是在签名记录类型定义最终确定之前创建的。

# ruby-on-rails-3 - Rails 3 迁移和应用程序.rb

> ID：15026455
> 
> 赞同：0
> 
> 时间：2013-02-22T14:30:11.307
> 
> 标签：ruby-on-rails-3, migration

我继承了一个 Rails 项目并被要求对其进行更新，因此我将 Rails 2.2.2 项目迁移到 Rails 3.2。

我浏览了一些迁移教程并运行了 rails 升级脚本，当默认 /public/index.html 存在时，它可以正常加载。

然后我继续删除 /public/index.html，因此应用程序将指向 routes.rb 中指示的文件，然后我得到：

```
LoadError (Expected /var/www/vendor_sandbox/app/controllers/application.rb to define Application):
app/controllers/application_controller.rb:1:in `<top (required)>'
app/controllers/home_controller.rb:1:in `<top (required)>' 
```

导致错误的文件来自原始 Rails 2.2.2 代码库。我离开它是因为在迁移文档中没有任何迹象表明我正在阅读提到删除它，但显​​然有问题。

我觉得奇怪的是，我现在在 /config 中有一个 Rails 3 版本的 application.rb，在 /app/controllers/ 中有一个 application.rb

不确定如何处理 /app/controllers/application.rb。

以下是提到的文件：

```
 #### /app/controllers/application.rb
class ApplicationController < ActionController::Base
 helper :all # include all helpers, all the time

# See ActionController::RequestForgeryProtection for details
# Uncomment the :secret if you're not using the cookie session store
protect_from_forgery # :secret => 'mysecretkey'

# See ActionController::Base for details 
# Uncomment this to filter the contents of submitted sensitive data parameters
# from your application log (in this case, all fields with names like "password"). 
# filter_parameter_logging :password

def authenticate
  return true if session[:user_id].to_i > 0
  session[:after_login] = params
  redirect_to :controller => "login"
  return false
end

def authenticate_admin
  user = User.find(session[:user_id])
  @nav = [{:title => "Home", :action => {:controller => "home"}}]
  return true if user and user.is_admin?
  redirect_to :controller => "login"
  return false
end

def clean_date_for_4D date
  return "00/00/00" if !date or date == ""
  return date.strftime("%m/%d/%Y") if date.class.to_s == "Date"
  return Date.parse(date).strftime("%m/%d/%Y") # assume it's a string
end

def pad text, length=20
  while text.length < length do
    text = text + " "
   end
  return text
 end
end

 #### /config/routes.rb
 VendorSandbox::Application.routes.draw do

 match '/' => 'home#index'
 match '/:controller(/:action(/:id))'
end

#### /config/application.rb
require File.expand_path('../boot', __FILE__)
require 'rails/all'

if defined?(Bundler)

  Bundler.require(*Rails.groups(:assets => %w(development test)))

end

module VendorSandbox
  class Application < Rails::Application

    # Configure the default encoding used in templates for Ruby 1.9.
    config.encoding = "utf-8"

    # Configure sensitive parameters which will be filtered from the   log file.
  config.filter_parameters += [:password]

    # Enable escaping HTML in JSON.
    config.active_support.escape_html_entities_in_json = true

    config.active_record.whitelist_attributes = true

    # Enable the asset pipeline
    config.assets.enabled = true

    # Version of your assets, change this if you want to expire all your assets
    config.assets.version = '1.0'

    # Session key
     config.session_store(:cookie_store, {:key => '_vendor_sandbox_session', :secret => 'secretkey'

    # Time zone
   config.time_zone = 'Central Time (US & Canada)' #'UTC' # Had to change this to keep created_at from being 4 hours in advance!
 config.active_record.default_timezone = 'Central Time (US & Canada)'

  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:44:07.323

尝试将您的重命名`app/controllers/application.rb`为`application_controller.rb`.

我认为 Rails 期望您的控制器以`_controller`后缀命名，而`application.rb`您在控制器文件夹中的名称未遵循该约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-06T19:33:35.830

我想对@Zajn 的回答发表评论，但我没有所需的“50 声望”。

仅供参考，在 Rails 2.3`app/controllers/application.rb`中重命名为`application_controller.rb`

[http://guides.rubyonrails.org/2_3_release_notes.html#application-controller-renamed](http://guides.rubyonrails.org/2_3_release_notes.html#application-controller-renamed)

# mysql - 使用 concat 时获取额外的逗号 ','

> ID：15026458
> 
> 赞同：7
> 
> 时间：2013-02-22T14:30:17.740
> 
> 标签：mysql

我写了一个存储过程`sqlyog`。它很长并且执行除了*concat*语句之外的所有所需功能，因此我将仅列出该特定查询。

```
UPDATE recipes_new 
SET co_auths = CONCAT(co_auths,',',c1id) 
WHERE id = name_in; 
```

我基本上想要在两个字段中进行分隔，并且该语句放置在游标中，因此它是迭代的。`co_auths`目前为空，所以我得到的结果是*,1,2,3*我希望它是*1,2,3*。任何猜测最合适的解决方案是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T14:40:05.597

通过使用[`IF`](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_if)：

```
UPDATE recipes_new 
SET co_auths = IF(co_auths IS NULL, c1id, CONCAT(co_auths, ',', c1id))
WHERE id = name_in; 
```

如果 的值为`co_auths`空字符串而不是`NULL`：

```
UPDATE recipes_new 
SET co_auths = IF(LENGTH(co_auths), CONCAT(co_auths, ',', c1id), c1id)
WHERE id = name_in; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:39:01.977

这应该可以`CASE`用来检查它是否为NULL：

```
CONCAT(
    CASE 
        WHEN IFNULL(co_auths,'') = ''
        THEN '' 
        ELSE CONCAT(co_auths, ',') 
    END, c1id) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T14:41:25.690

[MySQL 返回一个空字段： CONCAT(nonEmpty1,empty2,nonEmpty3) = NULL](https://stackoverflow.com/questions/981214/mysql-returning-an-empty-field-concatnonempty1-empty2-nonempty3-null) CONCAT_WS 是你要找的

```
UPDATE recipes_new SET co_auths = CONCAT_WS(co_auths,',',c1id) WHERE id = name_in; 
```

# mysql - mysql查找条目匹配2个方向的2个字段

> ID：15026459
> 
> 赞同：0
> 
> 时间：2013-02-22T14:30:18.813
> 
> 标签：mysql, sql

可能是错误的标题我有一个帮助表确实在 2 个字段中保存了关系。

像 usera,userb

示例数据

```
a,b
1,2
1,5
1,6
2,1
2,3 
```

如果 2 个用户在两个方向上走到一起，则匹配。在我的示例中，这将是 1 和 2，因为两者都有一行包含 userb 中的对应项

谁能告诉我如何构造一个 mysql 查询来根据一个用户在表中找到这个匹配项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:38:35.720

试一试，*假设行是唯一的*

```
SELECT least(Col1, Col2) as x, 
       greatest(Col1, Col2) as y
FROM   Table1 
GROUP  BY x, y
HAVING COUNT(*) > 1 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/63bfc/4)

但如果行不是唯一的，那么你需要有`DISTINCT`关键字，

```
SELECT least(Col1, Col2) as x, 
       greatest(Col1, Col2) as y
FROM   Table1 
GROUP  BY x, y
HAVING COUNT(DISTINCT Col1, Col2) > 1 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/99448/2)

# r - 当前工作目录中的 setwd()

> ID：15026463
> 
> 赞同：6
> 
> 时间：2013-02-22T14:30:31.303
> 
> 标签：r

我有一个文件夹列表。在每个文件夹中都有一个与 R 相同的脚本，必须在文件夹中的文件上运行。我编写了一次脚本并将脚本复制到每个文件夹中。问题是我有一个大约 100 个文件夹的列表，所以我不可能在当前工作目录中手动设置 wd()。我想知道是否可以使用例如“。”来设置当前工作目录。这样：

```
setwd("/User/myname/./") 
```

或者以另一种简单的方式告诉 R 当前的工作目录，而不是每次都输入文件夹名称。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T14:46:39.427

这个怎么样？

```
# set the working directory to the main folder containing all the directories
setwd( "/user/yourdir/" )

# pull all files and folders (including subfolders) into a character vector
# keep ONLY the files that END with ".R" or ".r"
r.scripts <- list.files( pattern=".*\\.[rR]$" , recursive = TRUE )

# look at the contents.. now you've got just the R scripts..
# i think that's what you want?
r.scripts

# and you can loop through and source() each one
for ( i in r.scripts ) source( i ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T14:42:45.553

据我了解，您想触发一批 R 脚本，其中脚本分布在多个文件夹中。

就个人而言，我可能会编写一个 shell 脚本（或操作系统等效）来执行此操作，而不是在 R 中执行它。

```
for dir in /directoriesLocation/*/
do
    cat $dir/scriptName.R | R --slave --args $arg1 $arg2
done 
```

其中**$dir**是包含 R 脚本**scriptName.R的所有目录的位置**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T17:17:49.450

除了其他很好的答案之外，该`source`函数还有一个`chdir`参数，可以将工作目录临时更改为源文件所在的目录。

一种选择是使用`list.files`和/或其他工具为每个脚本文件创建一个带有文件名（包括路径）的向量。然后`source`每个文件并让`source`处理`chdir`为您设置工作目录。

# ruby-on-rails - 运行 RSpec 和 Mongoid 时数据库项不可用

> ID：15026464
> 
> 赞同：2
> 
> 时间：2013-02-22T14:30:35.287
> 
> 标签：ruby-on-rails, ruby, rspec, mongoid

我是 Rails 新手，所以可能我错过了一些明显的东西......我正在尝试编写一个使用 Mongodb 和 Mongoid gem 的 Rails 应用程序。

我在测试时遇到了一些麻烦。我想检查从 db 内容生成的 html 表是否正确。

我正在使用 Fabrication 在测试数据库中生成数据。

我的问题是生成的数据不可用于测试。为了使测试正确失败/通过，我必须运行它两次并避免清空集合。但这会给其他测试带来麻烦。

规格：需要'spec_helper'

```
describe "OperatorsPages" do
  let(:operator) { Fabricate(:operator) }
  subject { page }

  before do
    sign_in_operator operator
  end

  describe "index page " do
    before(:all) do
      3.times { Fabricate(:operator) }
      visit operators_path
    end

    after(:all) do
      Operator.all.destroy
    end

    Operator.all.each do |operator|
      it { should have_selector 'td', text: operator.name }
      it { should have_selector 'td', text: operator.email }
    end
  end
end 
```

如果测试针对空 db Operators.all.each.to_a 运行，则不会检查循环内的断言。如果我第二次运行它，则循环工作，但（显然）只有当我删除 after(:all) 过滤器时

如何让这个测试在第一次正确运行并在之后留下一个空集合？

# apache-flex - 移动性能下降

> ID：15026465
> 
> 赞同：1
> 
> 时间：2013-02-22T14:30:38.980
> 
> 标签：apache-flex, mobile

我制作了一个仅包含一些按钮的测试移动应用程序（比如 40 个）。当我按下一个按钮时，我会按下另一个视图。这是所有的了。但是，当我进入移动设备（在这种情况下是安卓）并按下一个按钮时，需要 3 秒或更长时间才能开始进入另一个屏幕。有什么问题？为什么这么慢？

# jquery - jQuery在向下滚动页面时使div滑入

> ID：15026466
> 
> 赞同：4
> 
> 时间：2013-02-22T14:30:38.843
> 
> 标签：jquery, html, scroll, jquery-animate

当用户向下滚动页面时，我想让一个 div 从右侧滑到我的页面上（该 div 将包含一个将它们带回页面顶部的链接）。这是我目前正在使用的代码：

```
jQuery(window).scroll(function() {
if (jQuery(this).scrollTop() > 100) {
    jQuery('.totop').animate({ right: '0px' });
} else {
    jQuery('.totop').animate({ right: '-300px' });
}
}); 
```

和CSS：

```
.totop {
position:fixed;
bottom:50%;
right:-300px;
width:300px;
height:100px;
font-size:30px;
color:white;
background:#f18500;
} 
```

div 的行为非常奇怪，当我向下滚动 div 大约需要 5 秒钟才能出现，然后它会出现，但看起来它正在尝试多次滑落，然后保持静止，当我滑回顶部时它消失了...但大约 5 秒后再次出现。请帮助找出我的代码有什么问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-22T14:34:59.713

您的动画正在排队，请使用`.stop()`：

```
jQuery(window).scroll(function () {
    if (jQuery(this).scrollTop() > 100) {
        if (jQuery('.totop').hasClass('visible') == false) {
            jQuery('.totop').stop().animate({
                right: '0px'
            }, function () {
                jQuery('.totop').addClass('visible')
            });
        }
    } else {
        if (jQuery('.totop').hasClass('visible') == true) {
            jQuery('.totop').stop().animate({
                right: '-300px'
            }, function () {
                jQuery('.totop').removeClass('visible')
            });
        }
    }
}); 
```

演示：http: [//jsfiddle.net/MkJwm/](http://jsfiddle.net/MkJwm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:41:01.603

像这样的东西：

```
$(window).scroll(function(){
    if ($(this).scrollTop() > 50) {
        $('#div-to-show').slideDown('slow');
    } else {
        $('#div-to-show').slideUp('slow');
    }
}); 
```

未测试。

# intersystems-cache - %XML.DataSet 创建无效的 xml

> ID：15026467
> 
> 赞同：0
> 
> 时间：2013-02-22T14:30:38.907
> 
> 标签：intersystems-cache

```
Class Services.TestClass Extends (%RegisteredObject, %XML.Adaptor)
{

Property DS As %XML.DataSet;

} 
```

以及我的 Web 服务类中的以下 Web 方法：

```
Method HelloWorld(name As %String) As Services.TestClass [ WebMethod ]
{
Quit ##class(Services.TestClass).%New()
} 
```

这将生成以下 XML：

```
<s:complexType name="TestClass">
<s:sequence>
<s:element minOccurs="0" name="DS" type="s0:DataSet"/>
</s:sequence>
</s:complexType>
<s:complexType name="s_DataSet">
<s:sequence>
<s:element ref="s:schema"/>
<s:any/>
</s:sequence>
</s:complexType>
</s:schema> 
```

我相信 s_DataSet 名称实际上应该只是 DataSet，因为 s0:DataSet 指向 DataSet，而不是 s_DataSet

当我使用使用该服务的客户端时，我收到以下错误：错误：找不到类型'DataSet@ [http://tempuri.org '。](http://tempuri.org)（来自 SoapUI）

当我将 DataSet 属性从 TestClass 中取出并直接返回时，一切都很好。到底是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T23:18:00.620

您向我们展示的是（部分）WebService（类）的 WSDL。s_Dataset 只是一个名称，架构部分指的是架构元素。

调用 webService ：

```
... Serivices.Client.cls?soap_method=HelloWorld&name=zzz 
```

只是产生：

```
<SOAP-ENV:Envelope>
    <SOAP-ENV:Body>
        <HelloWorldResponse>
            <HelloWorldResult/>
        </HelloWorldResponse>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

没有错误

# html - 使用 hpple 进行 Html 解析

> ID：15026469
> 
> 赞同：2
> 
> 时间：2013-02-22T14:30:53.183
> 
> 标签：html, xcode, parsing, hpple

我需要你的帮助。这是我第一次尝试解析 HTML，并且遇到了一些问题。我关注了关于 HTML 解析的[Rays 教程。](http://www.raywenderlich.com/14172/how-to-parse-html-on-ios)他使用**hpple**。我要解析的文件比他的要复杂得多。我想通过下面的代码提取一些变量：

```
<div id="status">
<div id="loading" style="display:none">Error:<br />Connection to demo board was lost.</div>
<div id="display">
    <span style="float:right;font-size:9px;font-weight:normal;padding-top:8px;text-indent:0px">(click to toggle)</span>
    <p>LEDs:<br /><span class="leds">
    <!-- <a id="led7" onclick="newAJAXCommand('leds.cgi?led=7');">&bull;</a>
    <a id="led6" onclick="newAJAXCommand('leds.cgi?led=6');">&bull;</a>
    <a id="led5" onclick="newAJAXCommand('leds.cgi?led=5');">&bull;</a>
    <a id="led4" onclick="newAJAXCommand('leds.cgi?led=4');">&bull;</a>
    <a id="led3" onclick="newAJAXCommand('leds.cgi?led=3');">&bull;</a>
    <a id="led2" onclick="newAJAXCommand('leds.cgi?led=2');">&bull;</a> -->
    <a id="led1" onclick="newAJAXCommand('leds.cgi?led=1');">&bull;</a>
    <!-- <a id="led0">&bull;</a> -->
    </span></p>
    <p>Buttons:<br />
    <!-- <span id="btn3">?</span> &nbsp; 
    <span id="btn2">?</span> &nbsp; 
    <span id="btn1">?</span> &nbsp;  -->
    <span id="btn0">?</span></p>
    <p>Potentiometer: <span id="pot0" style="font-weight:normal">?</span></p> 
    <p>Temperature: <span id="temp0" style="font-weight:normal">?</span></p> 
</div> 
```

到目前为止，我可以获得 LED、按钮、电位器和温度。**我无法得到他们的价值观。**（那些特定的 4 个字段的值）。

我正在使用下面的代码：

```
- (void)loadTutorials {
// 1
NSURL *tutorialsUrl = [NSURL URLWithString:@"http://192.168.0.112/"]; 
NSData *tutorialsHtmlData = [NSData dataWithContentsOfURL:tutorialsUrl];

// 2
TFHpple *tutorialsParser = [TFHpple hppleWithHTMLData:tutorialsHtmlData];

// 3
NSString *tutorialsXpathQueryString = @"//div[@id='display']/p"; 
NSArray *tutorialsNodes = [tutorialsParser searchWithXPathQuery:tutorialsXpathQueryString];

// 4
NSMutableArray *newTutorials = [[NSMutableArray alloc] initWithCapacity:0];
for (TFHppleElement *element in tutorialsNodes) {
    // 5
    Tutorial *tutorial = [[Tutorial alloc] init];
    [newTutorials addObject:tutorial];
    NSLog(@"Object=%@",element);
    // 6
    tutorial.title = [[element firstChild] content]; 

    // 7
    tutorial.url = [element objectForKey:@"???"]; //??? 
}

// 8
_objects = newTutorials;
[self.tableView reloadData]; 
```

}

我怀疑问题出在 objectForKey: 但我不确定。我测试了我能想象到的所有类型的键。任何帮助都将受到欢迎。

# javascript - 在 Kinectjs 画布上加载的大图像上绘制较小的可移动图像

> ID：15026476
> 
> 赞同：1
> 
> 时间：2013-02-22T14:31:11.137
> 
> 标签：javascript, html, canvas, layer, stage

我将一个大图像加载到 kinectjs 画布上。下面的代码：

```
 <div id ="imgarea" ></div>
   var imageToCanvas = function(){
   var stages = new Kinetic.Stage({
   container: "imgarea",

   });

   var layer = new Kinetic.Layer();

    var imageobj = new Image();
    imageobj.onload = function(){
    var img = new Kinetic.Image({
     x: 10,
     y: 10,
     image: imageobj,
   });
   layer.add(img);
   stages.add(layer);
 };
 imageobj.src = "foto/next.png";
  console.log(imageobj);
}; 

 $(document).ready( function(){
  imageToCanvas();
}); 
```

请我如何在我之前绘制的大图像上使用 onclick 事件绘制更小的可移动和可调整大小的图像（图标）。我尝试使用以下代码来做到这一点：

```
 <Img src="testImage.jpg" onclick="var layer = new Kinetic.Layer();  drawImage(this.src);"   /> 
```

但遗憾的是它不起作用:(....有人请帮忙。谢谢

# ruby-on-rails - i18n rails haml 的奇怪问题

> ID：15026485
> 
> 赞同：0
> 
> 时间：2013-02-22T14:31:37.300
> 
> 标签：ruby-on-rails, haml, rails-i18n

我正在研究[如何将 rails-i18n 与 HAML](https://stackoverflow.com/questions/10948333/how-to-use-rails-i18n-with-haml)一起使用，以了解 i18n 如何与 haml 一起工作，但遇到了一个我无法弄清楚的问题。

这有效：

**en.yml**

```
en:
  sitename: "Happy Sunday" 
```

**新的.haml**

```
%h1= t("sitename") 
```

当我将 yml 更改为

**en.yml**

```
en:
  home:
    sitename: "Happy Sunday" 
```

**新的.haml**

```
%h1= t("home.sitename") 
```

然后我收到以下错误：

```
ArgumentError in Devise/sessions#new
    Showing 
..../devise/sessions/new.html.haml where line #20 raised:

syntax error on line 4, col 6: `    home:'
Extracted source (around line #20):

17:       = flash[:alert]
18: .row
19:   .headline.pagination-centered
20:     %h1= t("home.sitename")
21:     %h2= t("slogan")
22: .row.headline.pagination-centered
23:   %a{:href => "/tour"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T17:27:21.053

消息：

```
syntax error on line 4, col 6: ` home:' 
```

提示您的 Yaml 中有错误。检查 en.yml，尤其是您没有使用制表符并且您的缩进是一致的。

# c# - 高级自定义多语言 url 处理/角色和成员资格 LoginUrl

> ID：15026488
> 
> 赞同：2
> 
> 时间：2013-02-22T14:31:42.403
> 
> 标签：c#, asp.net, asp.net-mvc-4, myprettycms

我正在为我的 cms (myprettycms.codeplex.com) 开发一个自定义的 FriendlyURL 分析器。该系统是多语言的：

*   [http://www.mydomain.com/en-us/friendly/url/friendly_url_page.htm](http://www.mydomain.com/en-us/friendly/url/friendly_url_page.htm)
*   [http://www.mydomain.com/fr-fr/friendly/url/friendly_url_page.htm](http://www.mydomain.com/fr-fr/friendly/url/friendly_url_page.htm)

如果您查看文件：

[https://myprettycms.codeplex.com/SourceControl/changeset/view/19148#457568](https://myprettycms.codeplex.com/SourceControl/changeset/view/19148#457568)

它是 2 个控制器的基类。一个是公共的，另一个是私人的。2个代码之间的区别是在私有代码中授权装饰。

登录 URL 取决于您尝试访问的页面的语言。

如果我在一个英文页面上，例如：

[http://www.mydomain.com/en-us/products/priduct_list.htm](http://www.mydomain.com/en-us/products/priduct_list.htm)

如果此页面是私有的（控制器设置为`DynaContentPrivateController`）并且我未通过身份验证，系统会将我的需求重定向`LoginURL`到`web.config`.

此时设置为“ `~/logon`”

我会有类似“ `~/{0}/logon`”的东西，并且知道在部分代码中我可以覆盖代码以替换**为我正在寻找的页面**`{0}`的语言。

 **你可以帮帮我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T22:34:39.303

我找到了解决方案...

我保留了 web.config 设置：

```
<authentication mode="Forms">
  <forms loginUrl="~/LogOn" timeout="2880" />
</authentication> 
```

[Codeplex 中的 Web.Config](http://myprettycms.codeplex.com/SourceControl/changeset/view/19221#457307)

在 RouteConfig.cs

```
routes.MapRoute(
    name: "LogOn",
    url: "LogOn/{action}",
    defaults: new { controller = "LogOn", action = "SelectLanguage" }
); 
```

并且在 RouteConfig.cs 中的语言路由循环

```
foreach (var l in Languages)
{
    ...
    routes.MapRoute(
    name: "LogOn" + l.Name.ToUpper(),
    url: l.Description + "/logon/{action}",
    defaults: new { controller = "LogOn", action = "Index", language = l.Description }
    );
    ...
} 
```

[codeplex 中的 routeconfig.cs](http://myprettycms.codeplex.com/SourceControl/changeset/view/19221#457313)

在控制器底座中

```
public string URLReferLanguage
{
    get
    {
        string toReturn = ConfigurationManager.AppSettings["DefaultLanguage"];
        string language = string.Empty;
        string[] tLanguages = ConfigurationManager.AppSettings["Languages"].Split(',');
        string urlReferrer = HttpContext.Request.UrlReferrer.AbsolutePath;
        if (urlReferrer != null)
        {
            if (urlReferrer.Length > 5)
            {
                language = urlReferrer.Substring(1, 5).ToLower();
                if (tLanguages.Contains(language))
                {
                    toReturn = language;
                }
            }
        }
        return toReturn;
    }
} 
```

[codeplex 中的 _Controller_Base](http://myprettycms.codeplex.com/SourceControl/changeset/view/19221#457022)

在安全层的登录控制器中

```
public ActionResult SelectLanguage()
{
    return Redirect(string.Format("/{0}{1}", base.URLReferLanguage, Request.Url.PathAndQuery));
}

/// <summary>
/// URL: /en-us/LogOn
/// </summary>
/// <returns></returns>
public ActionResult Index()
{
    string eMethod = eMethodBase + ".Index[GET]";
    using (DataRepositories _dataContext = new DataRepositories())
    {
        base.InitView(
            Resources.View_LogOn_PageTitle,
            string.Empty,
            specificCssCollection,
            specificJSCollection,
            dynamicJSCollection,
            specificJqueryJSCollection,
            jsVariables,
            externalCSS,
            Meta,
            _dataContext,
            false,
            base.RequestLanguage,
            false
        );
    }
    string returnUrl = Request.QueryString["ReturnUrl"];
    if (!string.IsNullOrEmpty(returnUrl))
    {
        ContentData.ReturnUrl = returnUrl;
    }
    return View(ContentData);
} 
```

[codeplex 中的 LogOn 控制器](http://myprettycms.codeplex.com/SourceControl/changeset/view/19221#457242)

因此，当用户通过标准角色和成员身份（我的 Provider 继承标准角色）重定向到 LoginForm 时，控制器会分析 UrlRefer 并添加语言来寻址并重定向到它。**

# facebook - Facebook 不允许我更改网站的 og:type

> ID：15026494
> 
> 赞同：2
> 
> 时间：2013-02-22T14:32:18.947
> 
> 标签：facebook, facebook-opengraph, meta-tags

我正在为我的雇主设置一个*即将推出的临时单页机，并在其上运行*[对象调试器](https://developers.facebook.com/tools/debug)之后，就像我通常在设置一个新站点时所做的那样，它会带来一个我以前从未见过的错误。

> **无法更改 og_type '** [http://www.example.com/](http://www.example.com/) ' 上的对象以前的类型为 'article' 并且不能更改为类型为 'website' 的对象以避免现有操作的数据损坏。

因此，即使我更改了网站上的元标记，图形 API 仍会返回 URL ( [https://graph.facebook.com/10150291357906791 ) 的旧 OGP 数据。](https://graph.facebook.com/10150291357906791)

该网址已经有 15 个赞，老实说，我真的不太在意它们，如果解决方案涉及失去它们，我完全赞成。

我找到了更改`og:type`子页面（[http://facebook.stackoverflow.com/a/14405329/859999](http://facebook.stackoverflow.com/a/14405329/859999)）的解决方案，但在这种情况下，页面是网站的根目录。所以……在这种情况下，发布的解决方案不可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:37:53.973

由于您不关心现有的喜欢，我建议为此使用新的 URL。

您说它是您页面的根 URL - 但如果它只是临时的，您可以从那里重定向到另一个地址（具有正确的元信息）。

（如果您担心您的 SEO 排名或其他问题，您可以只为 Facebook 抓取工具执行此重定向，并通过其用户代理识别它。）

# powershell - Powershell从函数结果中设置变量

> ID：15026497
> 
> 赞同：2
> 
> 时间：2013-02-22T14:32:26.500
> 
> 标签：powershell

我不确定我在这里做错了什么，但下面的代码返回以下错误消息：

术语“identityTest”未被识别为 cmdlet、函数、脚本文件或可运行程序的名称。检查名称的拼写，或者如果包含路径，请验证路径是否正确并重试。

这是我的示例/测试代码：

```
#Bunch of Global vars
$UrlToUse = identityTest

function identityTest
{
    $internalMatch = ".*inbound"
    $externalMatch = ".*outbound"
    $fqdn = "blahblah_inbound"

    if ( $fqdn -match $internalMatch )
    {
        return "http://in3"
        Write-Host "Inbound Hit"
    }
    if ( $fqdn -match $externalMatch )
    {
        return "http://out"
        Write-Host "Outbond Hit"
    }
    else
    {
        return "http://default"
        write-host "Default Hit"
    }
}    

function sampleTest
{
    write-host "will upload to the following URL: + $UrlToUse
}

Write-Host $UrlToUse 
```

不确定我是否在这里采取了正确的方法，但这是我想要完成的。我计划根据 indetityTest 函数中 if 语句的结果将 UrlToUse 设置为全局变量，该函数将确定并返回正确的变量。从那里我将在我的其余代码中使用相同的全局变量。我创建的一个示例将在另一个函数中使用相同的 var $UrlToUse，在本例中名称为 sampleTest。

我不明白为什么这不起作用。我来自 Perl 背景，可能会对 powershell 中的工作方式感到困惑。任何提示指针等将非常感激。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:37:48.830

在调用函数 identityTest 之前移动它。像这样：

```
function identityTest
{
    $internalMatch = ".*inbound"
    $externalMatch = ".*outbound"
    $fqdn = "blahblah_inbound"

    if ( $fqdn -match $internalMatch )
    {
        return "http://in3"
        Write-Host "Inbound Hit"
    }
    if ( $fqdn -match $externalMatch )
    {
        return "http://out"
        Write-Host "Outbond Hit"
    }
    else
    {
        return "http://default"
        write-host "Default Hit"
    }
}    

#Bunch of Global vars
$UrlToUse = identityTest

function sampleTest
{
    write-host "will upload to the following URL: + $UrlToUse"
}

Write-Host $UrlToUse 
```

# css - LESS CSS - 函数中的不同元素

> ID：15026499
> 
> 赞同：2
> 
> 时间：2013-02-22T14:32:27.517
> 
> 标签：css, function, stylesheet, less, mixins

我使用 LESS CSS。我的代码看起来像这样。

**可重复模式**

你看到我的代码中的模式了吗？两者唯一不同的是填充值和类名。

**问题**

是否有可能在 LESS CSS 中使用许多不同的元素来制作像这样的**块的函数/混合？**

**更少的 CSS**

```
&.pad-10 > [class*='cols-'] {
    background: #ccc;
    padding: 10px;

    &:first-child {
        padding-left: 0;
    }

    &:last-child {
        padding-right: 0;
    }
}

&.pad-20 > [class*='cols-'] {
    background: #ccc;
    padding: 20px;

    &:first-child {
        padding-left: 0;
    }

    &:last-child {
        padding-right: 0;
    }
} 
```

**Mixin 建议**

```
 do_padding( $value ) {
        &.pad-@value > [class*='cols-'] {
            background: #ccc;
            padding: @valuepx;

        &:first-child {
            padding-left: 0;
        }

        &:last-child {
            padding-right: 0;
        }
    }

    do_padding( 10 );
    do_padding( 20 ); 
```

我知道我的确切问题可以在没有 LESS CSS 的情况下通过其他方式解决，但我时常会遇到这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T15:50:29.980

是的，你只需要在 LESS 中设置一个合适的计数和循环结构。就是这样：

**较少的**

```
.do_padding(@startValue, @increment) {

  .loop(@value) when (@value > 0) {
    //set top amount
    &.pad-@{value} > [class*='cols-'] {
      background: #ccc;
      padding: @value * 1px;

      &:first-child {
        padding-left: 0;
      }

      &:last-child {
        padding-right: 0;
      }
    }
    // next iteration
    .loop(@value - @increment);
  }

  // end the loop when index is 0 or less
  .loop(@value) when not (@value > 0) {}

  //start the loop
  .loop(@startValue);
} 
```

**用它**

```
.myClass {
   .do_padding(30, 10);
} 
```

**CSS 输出**

```
.myClass.pad-30 > [class*='cols-'] {
  background: #ccc;
  padding: 30px;
}
.myClass.pad-30 > [class*='cols-']:first-child {
  padding-left: 0;
}
.myClass.pad-30 > [class*='cols-']:last-child {
  padding-right: 0;
}
.myClass.pad-20 > [class*='cols-'] {
  background: #ccc;
  padding: 20px;
}
.myClass.pad-20 > [class*='cols-']:first-child {
  padding-left: 0;
}
.myClass.pad-20 > [class*='cols-']:last-child {
  padding-right: 0;
}
.myClass.pad-10 > [class*='cols-'] {
  background: #ccc;
  padding: 10px;
}
.myClass.pad-10 > [class*='cols-']:first-child {
  padding-left: 0;
}
.myClass.pad-10 > [class*='cols-']:last-child {
  padding-right: 0;
} 
```

# jquery - 级联下拉菜单和选择链接到页面 onchange

> ID：15026506
> 
> 赞同：0
> 
> 时间：2013-02-22T14:32:57.937
> 
> 标签：jquery, html, onchange, html-select

我正在使用脚本来填充第二个 Select。使用第二个选择的值与第一个选择配对。

```
 $("#select1").change(function() { 
    if($(this).data('options') == undefined){
    $(this).data('options',$('#select2 option').clone());
    } 
    var id = $(this).val();
    var options = $(this).data('options').filter('[value=' + id + ']');
    $('#select2').html(options);
    }); 
```

我想在第二个选择上使用 onchange 链接到一个页面。这是我正在使用/想要使用的。

```
 <select ONCHANGE="location = this.options[this.selectedIndex].value;">
    <option value="http://www.apple.com/">Apple</option>
    </select> 
```

我的问题是：当我使用该值来识别第一个选择时，如何将 url 放入第二个选择的值中？

此外，当页面加载第二个选择时，会显示所有选项，直到选择第一个选择，然后它将仅显示具有匹配值的选项。

这是我的html：

```
 <div id="location_select">
    <table align="center">
    <tbody><tr>
    <th><label for="select1">Province:</label></th>
    <td>
  <select id="select1" name="select1">
<option select="selected" value="0"></option>
<option value="AB">Alberta</option>
<option value="BC">British Columbia</option>
</select></td>
</tr>
    <tr>
    <th><label for="select2">City:</label></th>
    <td>
    <select id="select2" name="select2">
    <option value="0"></option>
    <option value="AB"></option>
    <option value="AB">a</option>
    <option value="AB">b</option>
    <option value="AB">c</option>
    <option value="BC"></option>
    <option value="BC">d</option>
    <option value="BC">e</option>
    <option value="BC">f</option>
    </select>
    </td>
    </tr>
    </tbody></table>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:57:42.650

我稍微改变了你的代码：

Javascript：

```
$("#select2").attr("disabled", true);

$("#select1").change(function() { 
    if($(this).data('options') == undefined){
        $(this).data('options',$('#select2 option').clone());
    } 
    var id = $(this).val();
    var options = $(this).data('options').filter('[id=' + id + ']');
    $('#select2').html(options);
    $("#select2").attr("disabled", false);
});

$("#select2").change(function() { 
    var link = $(this).val();
    alert(link);
}); 
```

的HTML：

```
<div id="location_select">
    <table align="center">
    <tbody>
    <th><label class="select_location_label" for="select1">Province:</label></th>
    <td>
  <select id="select1" name="select1">
<option select="selected" value="0"></option>
<option value="AB">Alberta</option>
<option value="BC">British Columbia</option>
</select></td>
</tr>
    <tr>
    <th><label class="select_location_label" for="select2">City:</label></th>
    <td>
    <select id="select2" name="select2">
    <option id="0">Select Province first</option>
    <option id="AB" value="http://www.google.com"></option>
    <option id="AB" value="http://www.google.com">a</option>
    <option id="AB" value="http://www.google.com">b</option>
    <option id="AB" value="http://www.google.com">c</option>
    <option id="BC" value="http://www.google.com"></option>
    <option id="BC" value="http://www.google.com">d</option>
    <option id="BC" value="http://www.google.com">e</option>
    <option id="BC" value="http://www.google.com">f</option>
    </select>
    </td>
    </tr>
    </tbody></table>
    </div> 
```

请参阅 jsfiddle 的工作版本：http: [//jsfiddle.net/7qDgZ/1/](http://jsfiddle.net/7qDgZ/1/) 这应该可以帮助你

# asp.net-mvc - dotless MVC nuget 包不再工作

> ID：15026508
> 
> 赞同：1
> 
> 时间：2013-02-22T14:33:01.323
> 
> 标签：asp.net-mvc, visual-studio-2012, nuget, nuget-package, dotless

我在 VS2012 上安装了 dotless 1.3.1.0 nuget 包，并且从 2 天左右开始它不再工作了。甚至在我没有编辑的旧项目中也没有。整个 .less 文件保持无色，右侧没有实时样本，没有智能感知，并且不再编译到 .css 文件中。已经尝试重新安装它，但没有帮助。

还有其他人遇到问题吗？解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T00:13:23.260

由于似乎没有人回答（dotless 也很不为人知），我可以自己给出一个部分解决方案。我安装了 Mindscape [http://visualstudiogallery.msdn.microsoft.com/2b96d16a-c986-4501-8f97-8008f9db141a](http://visualstudiogallery.msdn.microsoft.com/2b96d16a-c986-4501-8f97-8008f9db141a)，它在左窗格中也没有突出显示，但它有一个正常工作的右 css 窗格。您可以看到它没有按应有的方式工作，但它可以编译，并且在我有一天重新安装 Visual Studio 之前这很好（我认为 VS 是问题所在）。也许这对其他人也有帮助:-D

# php - 添加到数据库时变为

> ID：15026510
> 
> 赞同：0
> 
> 时间：2013-02-22T14:33:08.527
> 
> 标签：php, html, mysql

我有一个脚本，我在其中将一个新项目写入我的数据库。在这个脚本中，我有一个 name="omschrijving" 的 textarea 元素。在这个文本区域中，用户可以指定我用 css 设置样式的 <li> 元素。

问题是，当我输入： <li>hello</li> 在我的数据库中变成： & lt;li>hello< ;/li> 。

我使用 mediumtext 类型的列来存储 textarea 的值。

我的表格代码：

```
<form action="nieuwproject.php?action=toevoegen" method="post">

                            <fieldset class=""> <!-- Set class to "column-left" or "column-right" on fieldsets to divide the form into columns -->

                                <p>
                                    <label>Naam</label>
                                    <input class="text-input medium-input datepicker" type="text" id="medium-input" name="naam" />
                                </p>

                                <p>
                                    <label>Categorie</label>
                                    <select name="categorie" class="text-input medium-input">
                                       <?php $oObj->getCategorieDropdown(); ?> 
                                    </select>
                                </p>

                                <p>
                                    <label>Opdrachtgever</label>
                                    <input class="text-input medium-input datepicker" type="text" id="medium-input" name="opdrachtgever" />
                                </p>

                                <p>
                                    <label>Omschrijving</label>
                                    <textarea class="text-input textarea wysiwyg" id="textarea" name="omschrijving" cols="79" rows="15"></textarea>
                                </p>

                                <p>
                                    <label>Werkzaamheden</label>
                                    <textarea class="text-input textarea wysiwyg" id="textarea" name="werkzaamheden" cols="79" rows="15"></textarea>
                                </p>

                                <p>
                                    <input class="button" type="submit" value="Submit" />
                                </p>

                            </fieldset>

                            <div class="clear"></div><!-- End .clear -->

                        </form> 
```

我的插入脚本的代码：

```
function addProject() {
    $this->sQuery = "INSERT INTO projecten (naam,opdrachtgever,omschrijving,werkzaamheden,categorie) 
        VALUES ('" . $_POST['naam'] . "','" . $_POST['opdrachtgever'] . "','" . $_POST['omschrijving'] . "','" . $_POST['werkzaamheden'] . "','" . $_POST['categorie'] . "')";
    $this->rResult = mysql_query($this->sQuery);
} 
```

有谁知道如何解决这一问题？我知道这个脚本对黑客来说是糖果，所以没有必要指出这一点。

亲切的问候，

迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:34:25.423

当然。
只需在代码中找到`htmlspecialchars/htmlentities`用于数据库的数据的位置并将其删除即可。

**我可以向您保证，数据库永远不会根据自己的意愿添加任何符号。**
更改/添加到数据中的每个符号都是一些 PHP 代码的结果。

请注意，您的查询格式不正确。
您必须通过单独格式化每个文字或使用准备好的语句来格式化它。
它与您的`li&gt`问题无关，但与您的应用程序错误和漏洞有关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:40:23.723

[http://php.net/manual/en/function.htmlentities.php](http://php.net/manual/en/function.htmlentities.php) [http://www.php.net/manual/en/function.htmlspecialchars.php](http://www.php.net/manual/en/function.htmlspecialchars.php)

据我所知，MySQL 不会像这样清理您的 html，因此您的代码中的某些内容正在通过您`$_POST['omschrijving']`的`htmlentities()`or `htmlspecialchars()`。这些函数中的任何一个都会产生您在数据库中看到的输出。

编辑：

刚刚看到您的评论，它是您的所见即所得编辑器。接得好！

# knockout.js - 使用淘汰映射，我如何自己映射整个数组属性？

> ID：15026511
> 
> 赞同：0
> 
> 时间：2013-02-22T14:33:10.510
> 
> 标签：knockout.js, knockout-mapping-plugin

从我的服务器我收到一个看起来像这样的对象：

```
var fromServer = { 
    foo: "Some foo", 
    barArray: [ "bar1", "bar2", "bar3", "bar4", "bar5" ] 
}; 
```

使用映射插件进行淘汰赛，我想自定义视图模型的构建方式并将数组分解为长度为 2 的子数组。像这样：

```
viewModel: {
    foo: "Some foo",
    barArray: [ ["bar1", "bar2"], ["bar3", "bar4"], ["bar5"] ]
} 
```

在去那里的路上，我意识到`create`每个数组项都会调用一次回调。这是我的看法：

```
<h1 data-bind="text: foo"></h1>
<ul data-bind="foreach: barArray">
    <li data-bind="text: $data.name"></li>
</ul> 
```

和javascript：

```
var fromServer = { foo: "Some foo", barArray: [ "bar1", "bar2", "bar3", "bar4", "bar5" ] };

var mapping = {
    'barArray': { 
        create: function(options) {
            return new barModel("This is " + options.data);
        }
    }
};

var barModel = function(data) {
   this.name = data; 
};

var viewModel = ko.mapping.fromJS(fromServer, mapping);

ko.applyBindings(viewModel); 
```

[这是一个显示行为的小提琴](http://jsfiddle.net/nieldw/tnqEZ/)

这是**真正的**问题：使用`create`回调，我可以一次访问整个数组，而不是每个元素吗？或者，我是否以错误的方式处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:03:21.003

您需要这样做，以便从 JSON 的根目录映射对象

```
 var mapping = {
            '': { 
                create: function(options) {
                    return new .....
                }
            }
        }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:15:05.607

查看[文档](http://knockoutjs.com/documentation/plugins-mapping.html)，传递给 create 方法的 options 参数有两个属性：

`data`: 包含此孩子数据的 JavaScript 对象

`parent`: 这个孩子所属的父对象或数组

因此您可以使用`options.parent`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T19:09:24.040

您可以在创建视图模型之前以使用它的方式重组传入数组。您可以将其转换为具有相应填充属性的对象数组，而不是使用以某种方式“按顺序分组”的数据数组。

我假设您的数据与工作日有某种关联，所以我创建了 WeekViewModel 来保存每个工作日的数据。在将数据映射到视图模型之前，我使用 ProcessBeforeCreatingViewModel 函数处理 if：

```
function WeekViewModel(data) {
    var self = this;
    ko.mapping.fromJS(data, {}, self);
}

function ProcessBeforeCreatingViewModel(data) {

 var tempObj = null;

 var data_processed = {
    foo: data ? data.foo : '',
    barArray: []
 };

 if (data && data.barArray) {

    data.barArray.forEach(function (barItem, index) {

        if (index % days.length == 0) {
            tempObj = {};
            days.forEach(function (dayName) {
                tempObj[dayName] = undefined;
            });
            data_processed.barArray.push(tempObj);
        }

        tempObj[days[index]] = barItem;
    });
 }

 return data_processed;
}

var mapping = {
    'barArray': { 
        'create': function(options) {
            return new WeekViewModel(options.data);
        }
    }
};

var fromServer_Processed = ProcessBeforeCreatingViewModel(fromServer);

var viewModel = ko.mapping.fromJS(fromServer_Processed, mapping);

ko.applyBindings(viewModel); 
```

这是一个小提琴：http: [//jsfiddle.net/JeJKP/](http://jsfiddle.net/JeJKP/)

# python - 在生成器中产生打印的效果？

> ID：15026513
> 
> 赞同：1
> 
> 时间：2013-02-22T14:33:14.550
> 
> 标签：python, generator

代码1

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        for f in walk_dir(path):
                           print f
                else:
                        yield path

for file in walk_dir("/tmp"):
  print  file 
```

代码2

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        for f in walk_dir(path):
                           yield f
                else:
                        yield path

for file in walk_dir("/tmp"):
  print  file 
```

当 code1 和 code2 运行时，它得到相同的输出，我想知道为什么？为什么`yield f`和`print f` 能得到同样的效果？

正如 Vanesa Milagros Fernandez 所说：print f # -----> 你打印 f 但不运行它。
让我们进行更多讨论。
代码3

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        for f in walk_dir(path):
                           pass
                else:
                        yield path

for file in walk_dir("/tmp"):
  print  file 
```

为什么code3不能得到正确答案？如果在 for 循环中添加 :print f`for f in walk_dir(path)`并且`print f`不会运行，为什么我不能代入通过？
考虑函数问题，将code2修改为code4，
code4

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        walk_dir(path)                      
                else:
                        print  path 
```

我把它改成一个简单的函数，当运行 walk_dir("/tmp") 时，我得到了正确的输出。

让我们将code4修改为code5
code5

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        walk_dir(path)                      
                else:
                        yield  path

for file in walk_dir("/tmp"):
  print  file 
```

code5 无法正确回答。
我觉得有什么让我困惑，你能说清楚吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:35:08.090

他们不做同样的事情。 `yield`将值发送回调用者。 `print`写东西到`sys.stdout`.

然而，在这种情况下，当调用者从 中获取一个值时`yield`，它只是打印它，所以最终结果是相同的......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T14:34:21.420

在后一个程序中，您`yield`在最后的循环中打印的所有内容。尝试将最后一行更改为

```
print("Yielded: " + file) 
```

看看我的意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:40:14.570

在这两个代码中，您都在打印 f。在第一个函数中打印 f ，在第二个代码中，您在最后一个循环中打印 f 。

看评论...

代码 1

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        for f in walk_dir(path):
                           print f # -----> You print f but don't runed it
                else:
                        yield path

for file in walk_dir("/tmp"):
  print  file 
```

代码 2

```
import os
def walk_dir(dirname):
        for d in os.listdir(dirname):
                path = os.path.join(dirname, d)
                if os.path.isdir(path):
                        for f in walk_dir(path):
                           yield f # --> You don't print f but return f to the loop
                else:
                        yield path

for file in walk_dir("/tmp"):
  print  file 
```

# c++ - 在 VC++ 2010 Express 中构建项目时出错

> ID：15026516
> 
> 赞同：0
> 
> 时间：2013-02-22T14:33:44.600
> 
> 标签：c++

我试图查看与这些错误消息相关的问题。我试图检查所有内容，但仍然没有找到错误的根源。

根据您的说法，obj 错误后跟错误 LNK2019: unresolved external symbol imp__is_CaptureVideo 在函数中引用，它的出处是什么？

我正在使用 Visual Express C++ 2010。

谢谢你。

```
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_CaptureVideo referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnButtonStart(void)" (?OnButtonStart@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_StopLiveVideo referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnButtonStop(void)" (?OnButtonStop@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_SetImageMem referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnBnClickedButtonLoadParameter(void)" (?OnBnClickedButtonLoadParameter@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_AllocImageMem referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnBnClickedButtonLoadParameter(void)" (?OnBnClickedButtonLoadParameter@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_SetColorMode referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnBnClickedButtonLoadParameter(void)" (?OnBnClickedButtonLoadParameter@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_AOI referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnBnClickedButtonLoadParameter(void)" (?OnBnClickedButtonLoadParameter@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_FreeImageMem referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnBnClickedButtonLoadParameter(void)" (?OnBnClickedButtonLoadParameter@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_ParameterSet referenced in function "private: void __thiscall CIdsSimpleLiveDlg::OnBnClickedButtonLoadParameter(void)" (?OnBnClickedButtonLoadParameter@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_EnableMessage referenced in function "private: bool __thiscall CIdsSimpleLiveDlg::OpenCamera(void)" (?OpenCamera@CIdsSimpleLiveDlg@@AAE_NXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_GetSensorInfo referenced in function "private: bool __thiscall CIdsSimpleLiveDlg::OpenCamera(void)" (?OpenCamera@CIdsSimpleLiveDlg@@AAE_NXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_RenderBitmap referenced in function "private: long __thiscall CIdsSimpleLiveDlg::OnUEyeMessage(unsigned int,long)" (?OnUEyeMessage@CIdsSimpleLiveDlg@@AAEJIJ@Z)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_ExitCamera referenced in function "private: void __thiscall CIdsSimpleLiveDlg::ExitCamera(void)" (?ExitCamera@CIdsSimpleLiveDlg@@AAEXXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_GetColorDepth referenced in function "private: int __thiscall CIdsSimpleLiveDlg::InitDisplayMode(void)" (?InitDisplayMode@CIdsSimpleLiveDlg@@AAEHXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_SetDisplayMode referenced in function "private: int __thiscall CIdsSimpleLiveDlg::InitDisplayMode(void)" (?InitDisplayMode@CIdsSimpleLiveDlg@@AAEHXZ)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_GetDuration referenced in function "private: int __thiscall CIdsSimpleLiveDlg::InitCamera(unsigned long *,struct HWND__ *)" (?InitCamera@CIdsSimpleLiveDlg@@AAEHPAKPAUHWND__@@@Z)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_InitCamera referenced in function "private: int __thiscall CIdsSimpleLiveDlg::InitCamera(unsigned long *,struct HWND__ *)" (?InitCamera@CIdsSimpleLiveDlg@@AAEHPAKPAUHWND__@@@Z)
1>IdsSimpleLiveDlg.obj : error LNK2019: unresolved external symbol __imp__is_ImageFormat referenced in function "private: void __thiscall CIdsSimpleLiveDlg::GetMaxImageSize(int *,int *)" (?GetMaxImageSize@CIdsSimpleLiveDlg@@AAEXPAH0@Z)
1>nafxcwd.lib(appcore.obj) : error LNK2001: unresolved external symbol ___argv
1>nafxcwd.lib(appcore.obj) : error LNK2001: unresolved external symbol ___argc
1>C:\Program Files\IDS\uEye\Develop\Source\SimpleLive\Debug\po.exe : fatal error LNK1120: 19 unresolved externals 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T11:05:58.100

> 我通过单击我的项目的属性添加了对应的库，然后将目录添加到库目录

似乎您已将“附加库目录”添加到您的 VS 项目中 - 但没有链接实际的库文件（Windows 扩展名：.lib）。我认为你所做的是

`Project Properties -> Configuration Properties-> Linker -> General -> Additional Library Directories`

并添加了您的第 3 方“.lib”所在的目录。但实际上这并没有链接到那个 '.lib' 文件本身（它只是添加了 VS 正在搜索链接的 .lib 文件的目录）。

尝试以下操作： `Right click on your project -> Project Properties -> Configuration Properties-> Linker -> Input -> Additional Dependencies`

有一个类似的列表：

```
'kernel32.lib;user32.lib;...;%(AdditionalDependencies)' 
```

里面的某个地方应该会出现你的“.lib 文件”的名称。如果没有，您必须在此处添加它。即，如果您的第 3 方库的库名为“myLib.lib”，则您将在其中插入

```
'kernel32.lib;user32.lib;...;myLib.lib;%(AdditionalDependencies)' 
```

# javascript - 什么是默认颜色 ?

> ID：15026517
> 
> 赞同：14
> 
> 时间：2013-02-22T14:33:46.723
> 
> 标签：javascript, html, css

谷歌运气不好，也存在`hr`颜色问题，导致如何改变`hr`颜色

我想创建一个`border`与默认颜色相同的`<hr>`颜色，但我不知道它到底是什么颜色。

有谁知道？

ps - 我知道如何更改 hr 标签的颜色.. 我想在更改之前找出它是什么

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-22T14:50:29.750

水平标尺的颜色取决于浏览器，但您可以`hr`像下面这样获取元素的颜色：

```
el = document.querySelector("hr");
color = window.getComputedStyle(el).getPropertyValue("border-top-color");
console.log(color); 
```

但是请注意，通常`border-style`是插图，因此您获得的颜色可能与您在屏幕上看到的“真实”值不同。您要么想要：

*   给你的边框与`hr`
*   将`hr`元素的边框样式设置为`solid`我在演示中所做的那样以获得“真实”颜色
*   获取`hr`-element 的边框样式并相应地调整您的颜色（可能很棘手并且取决于浏览器的计算）

查看[演示](http://jsfiddle.net/8Hxnq/3)获取相应颜色的演示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T14:37:14.347

颜色取决于浏览器/实现，因此不可能知道颜色。

相反，您可以`<hr>`使用 CSS 定义元素的颜色：

```
hr {
    color: red;
} 
```

现在你知道颜色是红色的了！

**更新：**似乎取决于浏览器需要使用`color`或`background-color`（见评论）。在你的 CSS 中同时使用这两者似乎是明智的：

```
hr {
    color: red;
    background-color: red;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T14:45:41.090

w3 没有为 hr 元素（[http://www.w3.org/TR/CSS21/sample.html](http://www.w3.org/TR/CSS21/sample.html)）定义默认颜色，html5 默认样式表尚未确认 afaik 但不应改变这一事实。

因此，每个浏览器都可以自由应用自己的默认设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T14:36:18.517

AFAIK 它依赖于操作系统（甚至设备）——所以没有“默认 HR 颜色”之类的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T14:55:26.443

请注意，某些浏览器不会将`<hr>`s 呈现为单色线。

`<hr>`这是Windows 上 Chrome 24左端的放大屏幕截图，背景为白色：

![在此处输入图像描述](../Images/70f68dc78cbc21be12418f63ef317d2b.png)

所以你有两种颜色可供选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-22T14:48:33.027

同时使用`color`和`background-color`

```
<hr />

hr {
    color: #f00;
    background-color: #f00;  
} 
```

工作小提琴：http: [//jsfiddle.net/D2UaZ/1/](http://jsfiddle.net/D2UaZ/1/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-30T10:59:31.517

hr的默认颜色是黑色

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-31T19:13:22.853

它是Internet Explorer 11 上的**#eee 。**

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-02-22T14:42:31.363

我不确定 hr 标签的确切颜色，但下面的 CSS 代码会将颜色更改为您选择的颜色。

```
hr { display: block; height: 1px;
    border: 0; border-top: 1px solid #ccc;
    margin: 1em 0; padding: 0; } 
```

# python - 纯 Python 比 Numpy 快？我可以让这个 numpy 代码更快吗？

> ID：15026519
> 
> 赞同：4
> 
> 时间：2013-02-22T14:33:50.357
> 
> 标签：python, numpy

我需要从特定的面/顶点列表中计算最小值、最大值和平均值。我尝试使用 Numpy 优化这种计算，但没有成功。

这是我的测试用例：

```
#!/usr/bin/python
# -*- coding: iso-8859-15 -*-
'''
Module Started 22 févr. 2013
@note: test case comparaison numpy vs python
@author: Python4D/damien
'''

import numpy as np
import time

def Fnumpy(vertices):
  np_vertices=np.array(vertices)
  _x=np_vertices[:,:,0]
  _y=np_vertices[:,:,1]
  _z=np_vertices[:,:,2]
  _min=[np.min(_x),np.min(_y),np.min(_z)]
  _max=[np.max(_x),np.max(_y),np.max(_z)]
  _mean=[np.mean(_x),np.mean(_y),np.mean(_z)]
  return _mean,_max,_min

def Fpython(vertices):
  list_x=[item[0] for sublist in vertices for item in sublist]
  list_y=[item[1] for sublist in vertices for item in sublist]
  list_z=[item[2] for sublist in vertices for item in sublist]
  taille=len(list_x)
  _mean=[sum(list_x)/taille,sum(list_y)/taille,sum(list_z)/taille]
  _max=[max(list_x),max(list_y),max(list_z)]
  _min=[min(list_x),min(list_y),min(list_z)]    
  return _mean,_max,_min

if __name__=="__main__":
  vertices=[[[1.1,2.2,3.3,4.4]]*4]*1000000
  _t=time.clock()
  print ">>NUMPY >>{} for {}s.".format(Fnumpy(vertices),time.clock()-_t)
  _t=time.clock()
  print ">>PYTHON>>{} for {}s.".format(Fpython(vertices),time.clock()-_t) 
```

结果是：

*麻木：*

> （[1.1000000000452519,2.20000000009038,3.300000000000000001]，3.2999999999998]，2.2999999999998]，3.2999999999998]，2.2000000000000001，2.299999999999998]），适用于**27.327068618S。**

*Python：*

> ([1.100000000045252, 2.200000000090504, 3.3000000001880174], [1.1, 2.2, 3.3], [1.1, 2.2, 3.3]) 为**1.81366938593s。**

纯 Python 比 Numpy 快 15 倍！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T14:54:47.063

你的速度较慢的原因`Fnumpy`是它包含一个额外的步骤`Fpython`：在内存中创建一个 numpy 数组。如果您将线移到定时部分`np_verticies=np.array(verticies)`之外，`Fnumpy`您的结果将非常不同：

```
>>NUMPY >>([1.1000000000452519, 2.2000000000905038, 3.3000000001880174], [1.1000000000000001, 2.2000000000000002, 3.2999999999999998], [1.1000000000000001, 2.2000000000000002, 3.2999999999999998]) for 0.500802s.
>>PYTHON>>([1.100000000045252, 2.200000000090504, 3.3000000001880174], [1.1, 2.2, 3.3], [1.1, 2.2, 3.3]) for 2.182239s. 
```

您还可以通过在创建 numpy 时向其提供数据类型提示来显着加快分配步骤。如果你告诉 Numpy 你有一个浮点数组，那么即使你将`np.array()`调用留在计时循环中，它也会击败纯 python 版本。

如果我更改`np_vertices=np.array(vertices)`为`np_vertices=np.array(vertices, dtype=np.float_)`并*保留它`Fnumpy`*，即使它必须做更多的工作，该`Fnumpy`版本也会击败：`Fpython`

```
>>NUMPY >>([1.1000000000452519, 2.2000000000905038, 3.3000000001880174], [1.1000000000000001, 2.2000000000000002, 3.2999999999999998], [1.1000000000000001, 2.2000000000000002, 3.2999999999999998]) for 1.586066s.
>>PYTHON>>([1.100000000045252, 2.200000000090504, 3.3000000001880174], [1.1, 2.2, 3.3], [1.1, 2.2, 3.3]) for 2.196787s. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T09:19:17.870

正如其他人已经指出的那样，您的问题是从列表到数组的转换。通过为此使用适当的`numpy`函数，您将击败 Python。我修改了你程序的主要部分：

```
if __name__=="__main__":
  _t = time.clock()
  vertices_np = np.resize(np.array([ 1.1, 2.2, 3.3, 4.4 ], dtype=np.float64), 
                          (1000000, 4, 4))
  print "Creating numpy vertices: {}".format(time.clock() - _t)
  _t = time.clock()
  vertices=[[[1.1,2.2,3.3,4.4]]*4]*1000000
  print "Creating python vertices: {}".format(time.clock() - _t)
  _t=time.clock()
  print ">>NUMPY >>{} for {}s.".format(Fnumpy(vertices_np),time.clock()-_t)
  _t=time.clock()
  print ">>PYTHON>>{} for {}s.".format(Fpython(vertices),time.clock()-_t) 
```

在我的机器上运行带有修改后的主要部分的代码：

```
Creating numpy vertices: 0.6
Creating python vertices: 0.01
>>NUMPY >>([1.1000000000452519, 2.2000000000905038, 3.3000000001880174], 
[1.1000000000000001, 2.2000000000000002, 3.2999999999999998], [1.1000000000000001, 
2.2000000000000002, 3.2999999999999998]) for 0.5s.
>>PYTHON>>([1.100000000045252, 2.200000000090504, 3.3000000001880174], [1.1, 2.2, 3.3], 
[1.1, 2.2, 3.3]) for 1.91s. 
```

尽管使用 Numpy 工具创建数组的时间仍然更长一些，因为使用 python 的列表乘法运算符创建嵌套列表（0.6s 对 0.01s），您获得了大约 ca 的因子。4 用于代码的运行时相关部分。如果我替换该行：

```
np_vertices=np.array(vertices) 
```

和

```
np_vertices = np.asarray(vertices) 
```

为了避免复制一个大数组，我的机器上 numpy 函数的运行时间甚至下降到 0.37s，比纯 python 版本快 5 倍以上。

在您的真实代码中，如果您事先知道顶点的数量，您可以通过 预先分配适当的数组`np.empty()`，然后用适当的数据填充它，并将其传递给函数的 numpy 版本。

# parsing - ANTLR4 整数解析失败

> ID：15026520
> 
> 赞同：1
> 
> 时间：2013-02-22T14:33:55.510
> 
> 标签：parsing, integer, parser-generator, antlr4

我正在尝试使用 antlr 4 解析文件，但我不明白为什么不解析多于一位的整数（第 79:44 行在输入“17”处没有可行的替代方案）。

这是整个语法[http://pastebin.com/rxktvUBi](http://pastebin.com/rxktvUBi)

这是int的定义

```
fragment DIGIT : [0-9] ;
integer : DIGIT+ ; 
```

这根本不起作用。这个版本

```
integer : ('0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9')+ ; 
```

仅适用于 1 位整数。

这是未解析的行的示例

```
 struct p_77_bound_17_or: ((bound(MEK)<=17) | (bound(MEKPP)<=17)) 
```

问题出在

```
 simple_expression:

     (integer)+ 
```

请注意，如果我使用标识符

```
ID:
  ('a'..'z'|'A'..'Z'|'0'..'9'|'_')+;

identifier: ID; 
```

而不是整数

```
 simple_expression:

     identifier 
```

这样可行。

为什么？任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T15:17:17.050

您的`integer`规则是解析器规则，而不是词法分析器规则。它引用的`'0'`,`'1'`等文字被隐式地转换为词法分析器规则，每个规则都匹配一个数字。您应该改为使用以下词法分析器规则：

```
INTEGER : '0'..'9'+; 
```

或者在 ANTLR 4 中，简单地说：

```
INTEGER : [0-9]+; 
```

# ios - iOS 使用多个滑动识别器

> ID：15026521
> 
> 赞同：0
> 
> 时间：2013-02-22T14:34:00.403
> 
> 标签：ios, uitableview, swipe, uiswipegesturerecognizer, swipe-gesture

我的视图上有左右滑动识别器以及表格。当用户在表格视图上向左->向右滑动时出现问题，表格处理它们并滑动表格内容而不是执行向左->右滑动识别器方法。如何提高左->右滑动识别器的灵敏度？

这是识别器的代码：

```
UISwipeGestureRecognizer *swipeRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeRight)];

swipeRecognizer.numberOfTouchesRequired = 1;

swipeRecognizer.direction = UISwipeGestureRecognizerDirectionRight;

[self.view addGestureRecognizer:swipeRecognizer];

UISwipeGestureRecognizer *swipeRecognizer1 = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeLeft)];

swipeRecognizer1.direction = UISwipeGestureRecognizerDirectionLeft;

swipeRecognizer1.numberOfTouchesRequired = 1;

[self.view addGestureRecognizer:swipeRecognizer1]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T00:07:25.447

您可以要求一个手势识别器在调用另一个手势识别器之前失败。

```
[lowerPriorityGestureRecognizer requireGestureRecognizerToFail:higherPriorityGestureRecognizer]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T23:46:02.337

如果您让我们知道视图是否在表格中/上方/下方，而不是说您同时拥有视图和表格，这将有很大帮助。这很重要。

# web - 在我的网站上获取 YouTube 视频评论

> ID：15026526
> 
> 赞同：1
> 
> 时间：2013-02-22T14:34:16.093
> 
> 标签：web, youtube, embedding

在我的网站中，我成功地嵌入了来自 YouTube 的视频，但我没有收到对这些视频的评论。那么有什么方法可以让评论嵌入到我的网站中的视频中。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-26T10:35:43.600

无需身份验证或 YouTube API 即可访问 YouTube 数据的最简单方法是使用 YouTube 查询 URL。

对于评论，处理此 URL：

`http://gdata.youtube.com/feeds/api/videos/{$videoId}/comments`

可以使用处理此 URL 访问视频的其他元数据：

`http://gdata.youtube.com/feeds/api/videos/{$videoId}`

# drupal-7 - Drupal7显示的用户名与用户名输入字段不同

> ID：15026530
> 
> 赞同：1
> 
> 时间：2013-02-22T14:34:30.250
> 
> 标签：drupal-7

在我们的 Drupal 7 站点上，我们试图强制 Drupal 使用某个用户名——名字、姓氏——无论用户在用户表单的用户名字段中输入什么内容。目前，有用户名、名字和姓氏的字段。有没有人有一个简单的方法来做到这一点？如果强制用户配置文件的 URL 使用 Drupal 创建的用户名，那也很好。

我环顾四周，没有看到任何关于此的问题-如果我错过了，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T10:54:37.393

有一个模块可以做到[RealName](http://drupal.org/project/realname)并且相当容易使用，如果需要，这是模块的[文档](http://drupal.org/documentation/modules/realname)。

[您可以使用Pathauto](http://drupal.org/project/pathauto)将用户配置文件链接更改为您想要的任何内容。

# arrays - 数组显示图片，需要另一种方法，带参数NUM来排序显示多少张图片

> ID：15026531
> 
> 赞同：1
> 
> 时间：2013-02-22T14:34:36.603
> 
> 标签：arrays, parameters

我在标题中可怕地解释了这一点，我很抱歉，我对 Java 很陌生，还不太了解其中的一些内容。

反正，

我的猫动画运行到屏幕中间，刮了两次，然后继续运行到最后，有没有办法写一个方法，需要一个 INT NUM 并使猫刮 x 次？不知道该怎么做。

任何帮助将非常感激

这是我当前的代码

```
/** Run the animation. */
public void nekoRun() {
    moveIn();
    scratch();
    //scratch2(5);
    moveOut();
}

/* Move Neko to the centre of the panel. */
private void moveIn() {
    for (int i = 0; i < getWidth()/2; i+=10) {
        xPos = i;
        // swap images
        if (currentImage == nekoPics[0]) 
            currentImage = nekoPics[1];
        else 
            currentImage = nekoPics[0];
        repaint();
        pause(150);
    }   
}
    //neko stops and scratches in the middle of the panel twice
private void scratch() {
    for (int i = 0; i < 10; i++)  {

        // Swap images.
        currentImageIndex = nextImageList[currentImageIndex];
        currentImage = nekoPics[currentImageIndex];

            repaint();
            pause(150);
        }
}
//Neko runs to the end of the panel
private void moveOut() {
    for (int i = xPos; i < getWidth(); i+=10) {
        xPos = i;
        // swap images
        if (currentImage == nekoPics[0]) 
            currentImage = nekoPics[1];

        else 
            currentImage = nekoPics[0];
        repaint();
        pause(150);
    }   
} 
```

# ruby-on-rails - 带有rails 3.2的搜索引擎的骨干vs turbolinks

> ID：15026534
> 
> 赞同：1
> 
> 时间：2013-02-22T14:34:41.803
> 
> 标签：ruby-on-rails, ruby-on-rails-3, backbone.js, ruby-on-rails-3.2, turbolinks

我正在开发一个带有轮胎和弹性搜索的小型搜索引擎。我刚开始这个项目，我希望搜索速度尽可能快。

为此，我应该使用什么技术，turbolinks 或backbone.js？

还。我想知道如何使用这些技术解决“Seo”问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:21:23.790

将 Backbone 与 ajax 请求一起使用将比使用 Turbolinks 稍快。

但是，Turbolinks 默认会提供 SEO，而您必须做很多工作才能使 Backbone 和 SEO 正常工作（[请参阅这个 StackOverflow 问题](https://stackoverflow.com/questions/7549306/single-page-js-websites-and-seo)）

如果使用 Backbone，则还必须编写大量 JavaScript，而使用 Turbolinks 则几乎不编写任何 JavaScript。

权衡利弊并决定哪种选择更适合您的情况确实取决于您。

# python - 从python中的文件循环一些ips？

> ID：15026536
> 
> 赞同：1
> 
> 时间：2013-02-22T14:34:50.500
> 
> 标签：python, pexpect

我有一个包含 ips 的 csv 文件，列在如下列中：

```
10.38.227.233,VLAN-A,23
10.38.227.233,VLAN-XYZ,27
10.38.227.233,VLAN-XZ,27
10,38.169.103,VLAN-ABCD,11
10,38.169.103,VLAN-ABCD,16
10,38.169.103,VLAN-ABD,17 
```

等等

对于每个 ip，我需要登录到 cisco 交换机并为 ip 10.38.227.233(VLAN-A,23|VLAN-XYZ,27|VLAN-XZ,27) 执行一些命令

所有 ips 都具有相同的密码，所以我试图只获取一次密码提示并循环文件中的 ips。

我是这方面的新手，并且已经开始这样但似乎不起作用。现在我通过在远程 *nix 机器上执行简单的**ls**开始了一些测试，但它不起作用

```
#!/usr/bin/python
import pexpect
import getpass
import time

iplist = ['10.39.5.41', '10.38.164.103', '10.38.227.229']

for ip in iplist:
                sshCmd = "ssh " + "auto21" + "@" + ip
                #auto21 is a username
                print "Command: " + sshCmd + "\n"

                answer = 'yes/no'
                prompt = 'password:'
                password = getpass.getpass('password:')

                #Sends answer based on target server response / known host
                p = pexpect.spawn(sshCmd)
                i = p.expect([answer,  prompt])
                print i
                if i==0:
                    print 'Sending yes...'
                    p.sendline('yes')
                    p.expect(prompt)
                    print 'Sending password...'
                    p.sendline(password)
                    p.sendline('ls\r')
                    p.expect(pexpect.EOF,timeout=20)
                    print p.before,p.after
                if i==1:
                    print 'Sending password...'
                    p.sendline(password)
                    p.sendline(password)
                    p.sendline('ls\r')
                    p.expect(pexpect.EOF)

                try:
                   p.interact()
                   sys.exit(0)
                except:
                   sys.exit(1) 
```

这就是我得到的：

```
bash-3.00# python ip.py
Command: ssh auto21@10.39.5.41

password:
1
Sending password...
Traceback (most recent call last):
  File "ip.py", line 35, in <module>
    p.expect(pexpect.EOF,timeout=20)
  File "/G4_Automation/user_mgmt/test/pexpect.py", line 1311, in expect
    return self.expect_list(compiled_pattern_list, timeout, searchwindowsize)
  File "/G4_Automation/user_mgmt/test/pexpect.py", line 1325, in expect_list
    return self.expect_loop(searcher_re(pattern_list), timeout, searchwindowsize)
  File "/G4_Automation/user_mgmt/test/pexpect.py", line 1409, in expect_loop
    raise TIMEOUT (str(e) + '\n' + str(self))
pexpect.TIMEOUT: Timeout exceeded in read_nonblocking().
<pexpect.spawn object at 0x15aef0>
version: 2.3 ($Revision: 399 $)
command: /usr/bin/ssh
args: ['/usr/bin/ssh', 'auto21@10.39.5.41']
searcher: searcher_re:
    0: EOF
buffer (last 100 chars): st login: Fri Feb 22 08:55:05 2013 from p13adv
Testgfs2
-sh-3.2$ ls
-sh-3.2$
-sh-3.2$
before (last 100 chars): st login: Fri Feb 22 08:55:05 2013 from p13adv
Testgfs2
-sh-3.2$ ls
-sh-3.2$
-sh-3.2$
after: <class 'pexpect.TIMEOUT'>
match: None
match_index: None
exitstatus: None
flag_eof: False
pid: 29911
child_fd: 3
closed: False
timeout: 30
delimiter: <class 'pexpect.EOF'>
logfile: None
logfile_read: None
logfile_send: None
maxread: 2000
ignorecase: False
searchwindowsize: None
delaybeforesend: 0.05
delayafterclose: 0.1
delayafterterminate: 0.1 
```

请帮忙

此外，我如何遍历文件中的 ips 并在 ssh 范围内执行一些命令。

**注意**：每个 ip 将有多个 VLAN，但每个 VLAN 只有一个 id（如 11,12）

**编辑**：我需要在 ssh 范围内运行一些命令

```
ssh username@hosname "config t
                      int VLAN-A
                      switchport access VLAN-A  23
                      wr
                     #then for next VLAN for the current ip
                      config t
                      int VLAN-A
                      switchport access VLAN-A  23
                      wr
                     #and so on...............                        
                      " 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:13:43.563

在开始循环之前，首先需要将 getpass 行移到，这样它只会要求输入一次密码。

您得到的错误是超时的结果，基本上 ssh 响应时间太长。

因为你想做的很简单。结帐支线（[https://pypi.python.org/pypi/spur](https://pypi.python.org/pypi/spur)）。它有一个非常干净的界面来发送命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-04T01:55:02.433

ssh -o NumberOfPasswordPrompts=1 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -l user [hostname or ip] -p 22

无需发送是

# excel - 尝试对三个不同值的数据进行排序时出现运行时错误 1004

> ID：15026539
> 
> 赞同：1
> 
> 时间：2013-02-22T14:34:59.960
> 
> 标签：excel, runtime-error, excel-2010, vba

我已经阅读了至少 15 篇不同的文章，并尝试了许多不同的可能解决方案。我正在尝试使用下面的 VBA 代码按三个不同级别对可变大小的工作表进行排序。

当我单步执行代码时，我在排序的 .apply 参数处收到错误 1004。

**运行时错误“1004”：**

**排序参考无效。确保它在您要排序的数据中，并且第一个排序依据框不是相同的或空白的。**

任何人都可以提出这个问题的原因或解决方案吗？

```
Sub Subbing()

Dim LastCell as String

Range("A2").End(xlDown).Select

LastCell = Selection.Offset(0, 13).Address
Worksheets("Sheet1").Activate

With ActiveWorkbook.Worksheets("Sheet1").Sort
        .SortFields.Clear
        .SetRange Range("A2", LastCell)
        .SortFields.Add Key:=ActiveWorkbook.Worksheets("Sheet1").Range("R2"), _ SortOn:=xlSortOnValues, Order:=xlAscending
        .SortFields.Add Key:=ActiveWorkbook.Worksheets("Sheet1").Range("S2"), _ SortOn:=xlSortOnValues, Order:=xlAscending
        .SortFields.Add Key:=ActiveWorkbook.Worksheets("Sheet1").Range("D2"), _ SortOn:=xlSortOnValues, Order:=xlAscending
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply

End With
End Sub 
```

我期待着您的回复。我知道这是一个常见问题，但我尝试了所有广泛建议的解决问题的方法，但无济于事。

亲切的问候

皮特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:41:36.410

在我看来，您选择了 A:N 进行排序，但是正在对 R 和 S 以及 D 的值进行排序。通过 Step 模式运行它并在 LastCell 上放置一个手表 - 如果我是对的，那不会是足够远让你真正排序你想要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:41:55.333

...您的标准范围在排序区域之外-您不能这样做。

我的意思是您的排序范围将在 A 列和 N 列之间（A 之后的 13 列），但您的标准在 R & S 列中。

如果你扩大你的排序范围，一切都会奏效。

希望这可以解决所有问题。

# c++ - 在 Mac OS X 上编译 Sphere_2.6a 库

> ID：15026540
> 
> 赞同：0
> 
> 时间：2013-02-22T14:35:00.527
> 
> 标签：c++, macos

我正在尝试在 Mac OS X 上编译 sphere_2.6a 库。开始时需要以下参数：

```
Defined Commands and Options:
  Compiler           = gcc
  Compiler options   = -g -m32 -DNARCH_UNIX
  Install            = cp
  Ranlib             = ranlib
  Archiver           = ar ru 
```

那是我得到以下错误输出：

```
Undefined symbols for architecture i386:
"_hs_getopt", referenced from:
   _main in cc36C6uK.o
"_hs_optind", referenced from:
   _main in cc36C6uK.o
"_sp_create_header", referenced from:
  _main in cc36C6uK.o
"_sp_fpcopy", referenced from:
  _main in cc36C6uK.o
"_sp_get_version", referenced from:
  _main in cc36C6uK.o
"_sp_verbose", referenced from:
  _main in cc36C6uK.o
"_sp_write_header", referenced from:
  _main in cc36C6uK.o
ld: symbol(s) not found for architecture i386
collect2: ld returned 1 exit status
make[2]: *** [h_add] Error 1 
```

有谁知道问题出在哪里？

非常感谢，乔瓦尼

# php - PEAR Mail，设置内容类型标头会破坏电子邮件

> ID：15026543
> 
> 赞同：0
> 
> 时间：2013-02-22T14:35:07.887
> 
> 标签：php, email, pear

我正在尝试使用 PEAR 发送 UTF-8 电子邮件，但是每当我设置内容类型标头时，发送的电子邮件都会以一种奇怪的方式被破坏。

这些是我用于标题和梨本身的设置：

```
$headers = array (
    'From' => $emailAdresa,
    'To' => $emailDest,
    'Subject' => $subiect,
    'Return-Path' => '****@****.eu',
    'X-Codent' => '['.$codent_header.']',
    'X-Ent' => '['.$ent_header.']',
    'X-Bzd' => '['.$baza_date.']',
    'X-Email' => '['.$email['Email'].']',
    'Content-Type' => 'text/html; charset=UTF-8'
);                                      
$hdrs = $mime->headers($headers, true);
$smtp = Mail::factory('smtp',
        array ('host' => $emailServer,
               'auth' => true,
               'port' => ''.$emailPort.'',
               'username' => $emailUtilizator,
               'password' => $emailParola));

$mail = $smtp->send($emailDest, $hdrs, $body); 
```

这是设置 Content-type 标头时我收到的电子邮件：

```
Return-Path: <*******>
Received: from localhost ([93.114.43.202])
        by mx.google.com with ESMTPS id fy17sm687802bkc.6.2013.02.22.06.23.42
        (version=TLSv1 cipher=RC4-SHA bits=128/128);
        Fri, 22 Feb 2013 06:23:43 -0800 (PST)
Message-ID: <51277f6f.9178cd0a.600a.2b1c@mx.google.com>
Date: Fri, 22 Feb 2013 06:23:43 -0800 (PST)
Content-Type: text/html; charset=UTF-8
MIME-Version: 1.0
From: ******
To: ******
Subject: test
Return-Path: ******
X-Codent: [230802]
X-Ent: [Note]
X-Bzd: [1]
X-Email: [******]

--=_f11764219c81f7cdd5e1729bb3b44ca6
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset=ISO-8859-1

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www=
=2Ew3.org/TR/REC-html40/loose.dtd">
<html><body><p>test ?&icirc;??&icirc;&acirc;</p>

<p>&nbsp;</p>
test<br>
abcd<br>
test semnatura<img height=3D"1px" width=3D"1px" src=3D"******" /></body>=
</html>

--=_f11764219c81f7cdd5e1729bb3b44ca6
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset=ISO-8859-1

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www=
=2Ew3.org/TR/REC-html40/loose.dtd">
<html><body><p>test ?&icirc;??&icirc;&acirc;</p>

<p>&nbsp;</p>
test<br>
abcd<br>
test semnatura<img height=3D"1px" width=3D"1px" src=3D"******" /></body>=
</html>

--=_f11764219c81f7cdd5e1729bb3b44ca6-- 
```

请注意，当我在没有内容类型标头的情况下发送它时，电子邮件会很好，但我希望它为 utf-8 编码以用于变音符号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:37:37.850

您还需要为从 $mime 对象返回的正文内容设置编码。

```
// set encoding and specify charsets
$mimeparams=array(); 
$mimeparams['text_encoding']="8bit";
$mimeparams['text_charset']="UTF-8";
$mimeparams['html_charset']="UTF-8";
$mimeparams['head_charset']="UTF-8"; 

// set the content
$mime->setTXTBody($text);
$mime->setHTMLBody($html);

// retrieve the body
$body = $mime->get($mimeparams); 
```

# solr - solr：使用 DIH 从不同的数据源导入

> ID：15026546
> 
> 赞同：1
> 
> 时间：2013-02-22T14:35:17.827
> 
> 标签：solr, dataimporthandler, dih

我正在尝试使用 DataImportHandler 从 2 个不同的数据源（xml 和 db）填充 Solr 索引。

第一次尝试：创建 2 个 data-config.xml 文件，一个用于 xml 导入，一个用于 db 导入。db-config 会读取`id`并让我们说 field `A`。xml-config 也`id`和 field `B`。

这对两者都有效（我可以从两个数据源导入），但索引每次都被覆盖（`clean=false`当然），所以我要么有`id`和`A`要么`id`和`B`

以此类推第二次尝试：将 2 个文件合并为一个

```
<?xml version="1.0" encoding="UTF-8"?>
<dataConfig>
    <dataSource 
        name="cr-db"
        jndiName="xyz"
        type="JdbcDataSource" />
    <dataSource 
        name="cr-xml" 
        type="FileDataSource" 
        encoding="utf-8" />

    <document name="doc">
        <entity 
            dataSource="cr-xml" 
            name="f" 
            processor="FileListEntityProcessor" 
            baseDir="/path/to/xml" 
            filename="*.xml" 
            recursive="true" 
            rootEntity="false" 
            onError="skip">
            <entity
                name="xml-data" 
                dataSource="cr-xml" 
                processor="XPathEntityProcessor" 
                forEach="/root" 
                url="${f.fileAbsolutePath}" 
                transformer="DateFormatTransformer" 
                onError="skip">
                <field column="id" xpath="/root/id" /> 

                <field column="A" xpath="/root/a" />
            </entity>

            <entity 
                name="db-data" 
                dataSource="cr-db"
                query="
                    SELECT  
                        id, b
                    FROM 
                        a_table
                    WHERE 
                        id = '${f.file}'">
                <field column="B" name="b" />
            </entity>
        </entity>
    </document>
</dataConfig> 
```

我猜 - 部分有点有趣`id = '${f.file}'`，但那是使用的 id。select 语句的格式正确，但是当我尝试在`dataimport.jsp`. 第一部分（xml）工作正常，但是当他到达 db 部分时，它会引发：

```
java.lang.RuntimeException: java.io.FileNotFoundException: 
Could not find file: SELECT id, b FROM a_table WHERE id = '12345678.xml'
at org.apache.solr.handler.dataimport.FileDataSource.getFile[..] 
```

有什么建议吗？提前致谢

* * *

**编辑** 我发现了 FileNotFoundException 的问题：在实体标签中，`datasource`-attributes 需要为驼峰式-> `dataSource`.. 现在它运行了，但结果与第一次尝试相同：只有字段`B`进入索引。如果我把 db-entity 拿出来，那么文件内容就会被索引（字段`A`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T17:13:04.837

尝试：

```
<entity name="db-data" dataSource="cr-db" 
```

这些属性区分大小写，因此您的错误大小写的属性名称将被忽略，并且您会回退到默认名称（不知何故是文件名称）。

# model-view-controller - 嵌套 MVC 通信模式

> ID：15026549
> 
> 赞同：17
> 
> 时间：2013-02-22T14:35:34.833
> 
> 标签：model-view-controller, design-patterns

这完全是一个最佳实践类型的问题，因此语言无关紧要。我了解 MVC 的基本原理，并且它有不同的微妙风格（即直接引用模型的视图与来自控制器的数据委托）。

我的问题是关于跨 MVC 通信，当这些 MVC 嵌套时。这方面的一个例子是绘图程序（如 Paint 或其他东西）。Canvas 本身可以是 MVC，但每个绘制的实体（例如 Shapes、Text）也可以。从模型的角度来看，拥有一个实体集合是有意义的`CanvasModel`，但是 和 应该`CanvasView`分别`CanvasController`拥有相应的实体视图和控制器集合吗？

另外，添加新绘制实体的最佳/最干净的方法是什么？假设用户激活了 CircleTool，他们在 Canvas 视图中单击并开始绘制形状。`CanvasView`可以触发`CanvasController`可以侦听的相关鼠标向下/移动/向上事件。然后控制器基本上可以将这些事件代理到 CircleTool（状态模式）。在鼠标按下时，CircleTool 会想要创建一个新的 Circle。该工具应该直接创建一个新的`CircleEntityController`并调用类似的东西`canvasController.addEntity(circleController)`吗？那么创建 Circle 的模型和视图的责任应该在哪里呢？

对不起，如果这些问题有些模糊:)

--**编辑**--

这是我正在谈论的伪代码示例：

```
CircleTool {
    ...
    onCanvasMouseDown: function(x, y) {
        // should this tool/service create the new entity's model, view, and controller?
        var model = new CircleModel(x, y);
        var view = new CircleView(model);
        var controller = new CircleController(model, view);

        // should the canvasController's add method take in all 3 components
        // and then add them to their respective endpoints?
        this.canvasController.addEntity(model, view, controller);
    }
    ...
}

CanvasController {
    ...
    addEntity: function(model, view, controller) {
        // this doesn't really feel right...
        this.entityControllers.add(controller);
        this.model.addEntityModel(model);
        this.view.addEntityView(view);
    }
    ...
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-13T04:14:11.883

哇，好吧，我可能对这个问题有一个令人惊讶的答案：我一直在抱怨 MVC 如何被认为是编程中完美的象征，没有人认为有任何问题。最喜欢的面试问题是“您在 MVC 中可能会遇到哪些问题或挑战？” 令人惊讶的是，这个问题经常以一种困惑、不安的表情迎接。

答案非常简单：MVC 依赖于多个消费者从单个共享模型对象满足其需求的概念。当各种观点提出不同的要求时，事情就真的开始走向地狱了。几年前有一篇文章，作者提出了分层 MVC 的概念。其他人在评论中出现并告诉他们，他们认为自己发明的东西已经存在：一种称为 Presentation-Abstraction-Controller (PAC) 的模式。您在模式文献中看到这一点的唯一地方可能是 Buschmann 的书，有时被称为五人帮，或 POSA（面向模式的软件架构）。有趣的是，每当我解释 PAC 时，我都会使用绘画程序作为完美的例子。

主要区别在于，在 PAC 中，表示元素往往有自己的模型，这就是 PAC 的 A：对于每个组件，您不必有，但可以有一个抽象。根据此处的其他一些响应，然后发生的是您有一个协调控制器，在这种情况下，它将统治画布。假设我们想在画布的一侧添加一个小视图，显示各种形状的数量（例如正方形 3、圆形 5 等）。该控制器将向协调控制器注册以监听两个事件：elementAdded 和 elementRemoved。当它收到每个通知时，它会简单地更新它在自己的抽象中的映射。想象一下，改变一堆组件用来添加对此类事物的支持的共享模型将是多么荒谬。此外，

分层部分是 PAC 中可以有多个控制器层：例如，Canvas 级别的协调控制器不会知道具有特殊行为的各种组件中的任何一个。我们可能会创建一个可以包含其他东西的形状，这需要逻辑来接受拖动等。该组件将具有自己的抽象和控制器，并且该控制器将与 CanvasController 协调其活动等。它甚至可能在它与包含的组件进行通信的某个点。

这是[POSA书](https://rads.stackoverflow.com/amzn/click/com/0471958697)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T01:51:34.050

有许多不同的方法来攻击它。我不同意这里发布的其他答案。

但是，我这样做的一种方法是使用观察者模式。让我解释一下原因。

观察者模式在这里是必要的，因为这些绘图工具没有画布就什么都不是。因此，如果您没有画布，则不能（或不应该）调用圆形工具。所以相反，我的画布上有许多观察者。

可以在画布上使用的每个工具都添加为可观察事件。然后，当一个事件被触发时——比如“开始绘制”——该工具作为上下文发送（在本例中为“圆圈”）。从那里开始执行圆形工具的动作。

另一种想象方式是，每一层都有自己的服务、模型和视图。控制器实际上位于外部级别并与画布相关联。因此，服务仅由其他服务或控制器调用。没有圆形工具控制器 - 所以只有另一个服务（在我们的例子中是观察到的事件）可以调用它。该服务负责聚合数据、构建模型和提供视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T08:36:35.803

如果我是你，我会在处理形状时选择复合模式。不管你是否有圆形、正方形、矩形、三角形、字母等，我都会把所有东西都当作一个形状。一些形状可以是简单的形状，如线条，其他形状可以是更复杂的复合形状，如图形、饼图等。一个好主意是定义一个引用基本形状和高级（复杂）形状的基类。基本形状和高级形状都是同一类型的对象，只是高级形状可以有孩子来帮助定义这个复杂的对象。

通过遵循此逻辑，您可以使用每个形状绘制自己并且每个形状都知道其位置的逻辑，并基于此应用某些逻辑和算法来询问单击了哪个形状并且每个形状可以响应您的事件。

根据[GoF 书](https://rads.stackoverflow.com/amzn/click/com/0201633612)：

## 意图

将对象组合成树结构以表示部分整体的层次结构。Composite 让客户可以统一处理单个对象和对象的组合。

## 动机

绘图编辑器和原理图捕获系统等图形应用程序允许用户使用简单的组件构建复杂的图表。用户可以对组件进行分组以形成更大的组件。[...]

复合模式的关键是一个代表基元及其容器*的抽象类。*对于图形系统，这个类是Graphics。Graphic 声明了诸如 Draw 之类的特定于图形对象的操作。它还声明了所有复合对象共享的操作，例如访问和管理其子对象的操作。

现在，回到你的问题。如前所述，其中一个基本功能是`Draw`方法。该方法可以在具有以下签名的基类中实现为抽象方法：

```
public virtual void Draw(YourDrawingCanvas canvas); 
```

每个形状都会实现它自己的 Draw 版本。您传递给它们的参数是对绘图画布的引用，每个形状都将在其中绘制自己。每个形状都可以在其内部结构中存储对自身的引用，并且可以用来将鼠标单击位置与这些坐标进行比较，以告知您单击了哪个形状。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T14:38:29.370

（`RenderingService` *由于缺乏更好的名称 - 管理形状交互的东西）*将实例化新的`Circle` [域对象](http://c2.com/cgi/wiki?DomainObject)并通知它*（直接或当视图请求新数据时）*视图。

似乎您仍然习惯于将所有应用程序逻辑（存储抽象和域对象之间的交互）转储到表示层（在您的情况下 - 控制器）。

PS我假设你不是在谈论HMVC。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T18:09:54.373

从我的角度来看，使用嵌套的 MVC 组件在这里有点矫枉过正：在每个时间点，模型都包含多个元素（不同的圆形、正方形等，它们可能是使用复合模式的嵌套构造，如另一个答案中所述） . *但是，显示元素的画布只是一个视图*！（并且对应于单个视图，只需要一个控制器。）

具有多个视图的一种情况可能是元素列表（例如，显示在画布旁边） - 然后您可以将画布和元素列表实现为同一个模型上的两个不同视图。

关于如何“最好”实现添加元素的问题：我会考虑以下事件序列：

*   视图通知其侦听器已绘制了一个新的圆形元素（例如，以中点和初始半径作为参数）。
*   控制器注册为视图的监听器，因此调用控制器的“draw-circle(point, radius)”监听器方法。
*   控制器在模型中创建一个新的圆实例（直接或通过作为模型一部分的工厂类 - 我认为有很多不同的方式来实现新元素的创建）。*控制器是“在控制中”（字面意思），所以我相信实例化一个新元素（或至少触发实例化）是控制器的责任*。
*   在模型中，上一步调用了某种“添加元素”方法。
*   该模型向其所有侦听器发出“新元素创建”通知（可能传递对新创建元素的引用）。
*   画布被注册为模型的监听器，因此画布的“新创建的元素（元素）”监听器方法被调用。
*   作为对后一个通知的响应，画布（在其自身上）绘制圆圈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T19:55:38.067

这只是一个想法，但请考虑中介者模式是否适用。

来自[四人组](http://en.wikipedia.org/wiki/Design_Patterns)：

> ## 意图
> 
> 定义一个对象，该对象封装一组对象如何交互。Mediator 通过阻止对象显式地相互引用来促进松散耦合，并且它允许您独立地改变它们的交互。
> 
> ## 适用性
> 
> 在以下情况下使用中介者模式
> 
> 1.  一组对象以定义明确但复杂的方式进行通信。由此产生的相互依赖是非结构化的并且难以理解。
> 2.  重用一个对象很困难，因为它引用了许多其他对象并与之通信。
> 3.  分布在多个类之间的行为应该是可定制的，无需大量子类化。
> 
> ## 结果
> 
> 中介者模式有以下优点和缺点：
> 
> *   它限制了子类化。中介者将原本会分布在多个对象之间的行为本地化。改变这种行为只需要继承 Mediator；同事类可以按原样重复使用。
> *   它使同事解耦。中介促进同事之间的松散耦合。您可以独立地改变和重用 Colleague 和 Mediator 类。
> *   它简化了对象协议。中介者用中介者与其同事之间的一对多交互来代替多对多交互。一对多关系更容易理解、维护和扩展。
> *   它抽象了对象如何协作。使调解成为一个独立的概念并将其封装在一个对象中，可以让您专注于对象如何与它们的个体行为之外的交互。这可以帮助阐明对象在系统中的交互方式。
> *   它集中控制。中介者模式用交互的复杂性换取中介者的复杂性。因为中介者封装了协议，所以它可能比任何单独的同事都复杂。这会使调解器本身成为难以维护的整体。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-12T23:39:24.253

*我假设类似 MSPaint 的行为，其中活动工具创建一个矢量图形字形，用户可以对其进行操作，直到他满意为止。当用户满意时，字形被写入图像，这是一个像素光栅。*

* * *

当圆形工具被选中时，我会让 CanvasController 取消选择先前活动工具的 MVC 三重奏（如果另一个工具处于活动状态）并创建一个新的 CircleToolController、CircleModel 和 CircleView。先前活动的字形变为最终字形并将其自身绘制到 CanvasModel。

CanvasView 需要传递对 CircleView 的引用，以便它可以在绘制 Circle 之前将 CanvasModel 的像素绘制到屏幕上。将圆圈实际绘制到屏幕上，我将委托给 CircleView。

因此，CircleView 将需要了解和观察除 CircleModel 之外的其他更通用的模型类，我正在考虑颜色选择/调色板模型，以及填充样式和线条粗细等模型。这些其他模型寿命一样长就像应用程序一样，并且有自己的视图和控制器。毕竟，它们与应用程序的其余部分完全不同。

* * *

作为旁注：您实际上可以将 CanvasView 的 CanvasModel 绘制（像素颜色的光栅）从整个屏幕更新的协调中分离出来。有一个更高级别的 PaintView，它知道 CanvasView 和活动 GlyphView（例如 CircleView）协调 CanvasView 和 GlyphView 之间的绘图。

# android - AnimationDrawable.isRunning() 总是返回 true

> ID：15026558
> 
> 赞同：2
> 
> 时间：2013-02-22T14:36:04.603
> 
> 标签：android, android-animation

我遇到了一个奇怪的行为。如果我从 开始`AnimationDrawable`，`start()`那么在动画完成后，方法`isRunning()`仍然会返回 true。它是“一次性”动画，没有循环播放。

这是一个示例代码：

```
public class MyActivity extends Activity {
    private AnimationDrawable cartoon;
    private ImageView iv;
    private BitmapDrawable frame0, frame1;
    private final int sleep=1000;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        cartoon = new AnimationDrawable();
        cartoon.setOneShot(true);
        frame0 = new BitmapDrawable(getResources(), BitmapFactory.decodeResource(getResources(), R.drawable.gridx0));
        frame1 = new BitmapDrawable(getResources(), BitmapFactory.decodeResource(getResources(), R.drawable.gridx1));
    }

    @Override
    protected void onStart() {
        super.onStart();
        if(iv==null) iv = (ImageView) findViewById(R.id.imageView);
        cartoon.addFrame(frame0, sleep);
        cartoon.addFrame(frame1, sleep);
        iv.setImageDrawable(cartoon);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if(cartoon.isRunning()) Log.d("AnimationTest", "Animation already started");
        else cartoon.start();
        return true;
    }
} 
```

这是输出：

```
02-22 14:18:42.187: DEBUG/AnimationTest(2043): Animation already started
02-22 14:18:52.093: DEBUG/AnimationTest(2043): Animation already started
02-22 14:18:52.166: DEBUG/AnimationTest(2043): Animation already started
...and so on. 
```

所以动画第一次运行，然后`isRunning`将永远返回 true。 [我还发现发布到 code.google.com 的类似问题](https://code.google.com/p/android/issues/detail?id=6945#c1)，但没有任何评论就关闭了

我的问题是：

1.  有真正的错误还是我误解了什么？
2.  我怎么知道什么时候`AnimationDrawable`完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:02:08.007

尝试扩展`AnimationDrawable`，声明您自己的布尔字段，该字段将用作标志。覆盖`isRunning()`并返回布尔字段。根据您的类动画侦听器（开始、重复、结束）更改标志。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T16:01:04.030

看了[源码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.0_r1/android/graphics/drawable/AnimationDrawable.java#AnimationDrawable)后，我只能得出结论，设置为oneshot就是真正*的*oneshot动画，不再赘述。至少，不是没有`stop()`先打电话。

如果您`stop()`在完成后调用，那么下一次调用就`start()`可以正常工作（至少在我的测试中）。你如何打电话`stop()`取决于你，但你可以安排一个计时器在你打电话时总持续时间过去后运行它`start()`。在这个类中没有回调确实有点糟糕。

如果您将经常使用此机制，则可能值得扩展`AnimationDrawable`以为其提供回调。如果你这样做了，你应该把它贴在某个地方，以便将来对你自己和其他人更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-11T08:17:16.977

处理动画结束的方法是计算总动画的持续时间并在持续时间到期后发送事件。

```
 private AnimationDrawable timerAnimation;

...

private void startTimerAnimation() {
    int timerAnimationDuration = calcTimerAnimationDuration();
    timerAnimation.start();
    timerAnimationEndHandler.sendEmptyMessageDelayed(0, timerAnimationDuration);
}

private int calcTimerAnimationDuration() {
    int total = 0;
    for (int i = 0; i < timerAnimation.getNumberOfFrames(); i++) {
        total += timerAnimation.getDuration(i);
    }
    return total;
}

private Handler timerAnimationEndHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        onTimerAnimatonFinished();
}; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-22T14:54:38.013

如果您尝试：

```
 @Override
public boolean onTouchEvent(MotionEvent event) {
    if(cartoon.isRunning()){
      Log.d("AnimationTest", "Animation already started");
      return false;
   }else{
       cartoon.start();
      return true;
    }

} 
```

# python - 如何在扭曲的 SSL 客户端中验证 SSL 服务器证书

> ID：15026559
> 
> 赞同：3
> 
> 时间：2013-02-22T14:36:13.660
> 
> 标签：python, ssl, ssl-certificate, twisted

如何在我的扭曲 SSL 客户端中验证 SSL 服务器证书？

我是 SSL 的初学者，我已经阅读了[扭曲的 SSL 教程](http://twistedmatrix.com/documents/11.0.0/core/howto/ssl.html)，但我仍然不清楚一些事情。

我的查询是：

*   `twisted.internet.ssl`我应该如何使用模块验证 SSL 服务器证书，

*   `ssl.ClientContextFactory.getContext`方法在处理 SSL 时如何有用，

*   如何告诉twisted SSL 客户端公钥文件的位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T02:42:03.690

自 Twisted 14.0 以来，`optionsForClientTLS`最好的方法是：

```
from twisted.internet.ssl import optionsForClientTLS
from twisted.internet.endpoints import SSL4ClientEndpoint

ctx = optionsForClientTLS(hostname=u"example.com")
endpoint = SSL4ClientEndpoint(reactor, host, port, ctx)
factory = ...
d = endpoint.connect(factory)
... 
```

`optionsForClientTLS`还接受其他（可选）参数，这也可能有用。

在 Twisted 14.0 之前，这个过程有点复杂：

建立连接并且 SSL 握手成功完成后（这意味着证书当前基于其`notBefore`和`notAfter`值有效，并且它由您指示受信任的证书颁发机构证书签名），您可以从传输中获取证书：

```
certificate = self.transport.getPeerCertificate() 
```

证书表示为 pyOpenSSL X509 实例。它有一个方法可以用来检索证书的主题名称：

```
subject_name = certificate.get_subject() 
```

主题名称是一个专有名称，表示为 pyOpenSSL X509Name 实例。您可以检查其字段：

```
common_name = subject_name.commonName 
```

这是一个字符串，例如`"example.com"`。

如果您需要检查`subjectAltName`而不是（您可能会这样做），那么您可以在证书的扩展中找到此信息：

```
extensions = certificate.get_extensions() 
```

这是 pyOpenSSL X509Extension 实例的列表。你必须解析每一个来找到它`subjectAltName`和它的值。

# c# - 将自定义对象映射到表单

> ID：15026560
> 
> 赞同：0
> 
> 时间：2013-02-22T14:36:14.427
> 
> 标签：c#, forms, map

我可以将对象映射或自动映射到表单，然后从表单映射到对象吗？我有以下代码：

```
// Class model
class Model1
{
    Property1;
    Property2;
    Property3;
    ...
}

// Form. I use this form to create and update data of Model1
public partial class FormModel1 : Form
{
    private Model1 model1;
    ...

    private void LoadData()
    {
        Property1Txt.Text = model1.Property1;
        Property2Txt.Text = model1.Property2;
        Property3Txt.Text = model1.Property3;
    }

    private void SaveButton_Click(object sender, EventArgs e)
    {
        model1.Property1 = Property1Txt.Text;
        model1.Property2 = Property2Txt.Text;
        model1.Property3 = Property3Txt.Text;

        model1.Save(); 
    }
} 
```

请注意，我已经简化了示例。我想将数据从我的模型设置到表单，从表单设置到我的模型。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:48:54.933

您可以按如下方式实现数据绑定

```
property1Txt.DataBindings.Add("Text", model1, "Property1"); 
```

要在属性更改时更新文本框，您还需要实现`inotifypropertychanged`. 请参阅[http://msdn.microsoft.com/en-us/library/ms743695.aspx](http://msdn.microsoft.com/en-us/library/ms743695.aspx)。

那么你将需要使用

```
property1Txt.DataBindings.Add("Text", model1, "Property1", false, DataSourceUpdateMode.OnPropertyChanged ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:37:15.220

实现此目的的一种方法是使用[Reflection](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.110%29.aspx)。

另一种方法是使用控件的[`DataBindings`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.databindings.aspx)属性。

看看这些，花点时间理解这些概念，如果你有任何问题，请回来。当然，在一个新问题中:)

快乐学习！

# mobiscroll - mobiscroll 实例 $('#scroller').mobiscroll('getInst'); 返回未定义

> ID：15026563
> 
> 赞同：0
> 
> 时间：2013-02-22T14:36:28.153
> 
> 标签：mobiscroll

我有这个功能来更新时间：

```
updateTimerView: function(hours, minutes, seconds){
        var inst = $('#scroller').mobiscroll('getInst');
        inst.temp = [hours, minutes, seconds];
} 
```

但我总是收到错误：TypeError: inst is undefined

如果我将 inst 作为参数传递，同样的函数也可以工作，例如使用 onBeforeShow: function (dw, inst) 检索 inst。因此，为了清楚起见，这有效：

```
updateTimerView: function(inst, hours, minutes, seconds){
        inst.temp = [hours, minutes, seconds];
} 
```

[这里](http://docs.mobiscroll.com/24/mobiscroll-core)也没有列出 getInst 方法：但[这里](http://docs.mobiscroll.com/24/mobiscroll-instance)说这是获取滚动条实例的一种方法。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:42:59.353

使用此代码修复：

> updateTimerView: function(hours, minutes, seconds){
> $('#scroller').mobiscroll('setValue', [hours, minutes, seconds], false, 0.5); }

# c# - 检查例程是否可以在 C# 中运行（和运行）的可能方法

> ID：15026566
> 
> 赞同：0
> 
> 时间：2013-02-22T14:36:41.280
> 
> 标签：c#, control-flow

我想知道在调用例程时如何检查例程的先决条件，以便它可以执行或通知其不可执行性。语言是 C#。

我正在使用一个 Controller 对象、一个 DataContainer 对象和一些 Task 对象来实现一个[Pipeline 设计模式。](http://stevenatkinson.wordpress.com/2009/03/02/pipeline-design-pattern/)当控制器要求执行任务时，每个任务都有责任检查其适用性。具体来说，它应该检查 DataContainer 对象的可用数据。

我可以想象一些在 Python 中做到这一点的方法：

```
# 
if Task.can_run():
    Task.run()
else:
    Task.notify_controller()

# 
if Controller.check_runnability(Task):
    Task.run()
else:
    Controller.do_something_else()

# Task.can_run() throws exception instead of returning boolean:
try:
    Task.can_run();
except:
    Controller.do_something_else()  # or maybe Task.notify_controller()
else:
    Task.run()

# not sure about syntax for the following assertion, but you get the idea
assert (Task.can_run(), Task.notify_controller())
Task.run() 
```

我想知道（但在 Google 中没有找到）是“规范”/最常见/“正确”的 C# 习惯用法，仅在满足某些先决条件时才开始例程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:56:01.800

第一个例子是最常见的模式。对我来说，第二个只是第一个的变体，具有较少的语义命名约定。

第三个例子我会远离。不应使用异常来指导正常的流程控制。[http://msdn.microsoft.com/en-us/library/vstudio/ms229030(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/ms229030(v=vs.100).aspx)

编辑：我收回了。第二个示例看起来很相似，但它要求控制器确定任务是否可以运行。如果“可运行性”仅基于任务对象的内容而不是基于控制器的某些状态，那么我认为没有必要通过在控制器中进行检查来使事情复杂化。如果逻辑足够相似，我会使用基本任务类来保持干燥。

编辑：我不清楚你的确切用例，但所以这可能完全不符合要求，但对我来说，控制器似乎会询问任务是否准备好运行，如果是，它将运行任务，如果不是，它会做点别的。

```
if (task.CanRun)
{
    controller.Run(task);
}

else
{
    //Do whatver.
} 
```

此外，如果逻辑封装在控制器中，即当任务无法运行时应该做什么，那么 run 方法可能应该返回一个布尔值，以便调用者可以在需要时做一些额外的事情。在这种情况下，调用者只需将任务传递给控制器​​运行方法，然后控制器在其中检查任务是否可以运行并采取相应措施。

# python - 使用日语字符时，在 OS X 上将文件名编码为 base64 不正确

> ID：15026567
> 
> 赞同：2
> 
> 时间：2013-02-22T14:36:46.233
> 
> 标签：python, encoding, python-2.7, base64, osx-mountain-lion

我有一堆以人名命名的文件（例如“john.txt”、“mary.txt”），但其中也有日文名称（例如“fūka.txt”、“tetsurō.txt”）。

我要做的是将“.txt”之前的名称转换为Base64。

唯一的问题是，当我使用文件名（不带扩展名）并使用基于 Web 的转换器时，我得到的结果与借助 Python 脚本进行编码不同。

所以......例如，当我复制没有扩展名的文件名部分并在[http://www.base64encode.org](http://www.base64encode.org)中编码“fūka”时，我得到“ZsWra2E =”。当我从 UTF-8 编码的 PostgreSQL 数据库中获取人名时，我得到的结果相同，将其设为小写并进行 base64 编码。

但是当我在下面使用 Python 脚本时，我得到“ZnXMhGth”

```
import glob, os
import base64

def rename(dir, pattern):
    for pathAndFilename in glob.iglob(os.path.join(dir, pattern)):

        title, ext = os.path.splitext(os.path.basename(pathAndFilename))

        t = title.lower().encode("utf-8")

        encoded_string = base64.b64encode(t) + ext

        p = os.path.join(dir, encoded_string)

        os.rename(pathAndFilename, p)

rename(u'./test', u'*.txt') 
```

我在 OS X 10.8 和 Linux（从 Mac 上传到 Linux 服务器的文件）中得到了相同的结果。Python 是 2.7。我也尝试了 PHP 脚本（结果与 Python 脚本相同）。

当我使用带有其他字符的名称（例如“tetsurō”）时，也会发生类似的差异。

更奇怪的事情......当我在 OS X 的终端应用程序中使用 Python 脚本输出文件名部分，然后将此文本复制为文件名......然后将文件名编码为 base64 时，我得到的结果与我在网页上的结果相同上文提到的。终端具有 UTF-8 编码。

有人可以解释一下我在做什么（或在想）错了吗？中间是否有一些小的字符替换正在进行？如何使 Python 脚本获得与上述网页相同的结果任何提示将不胜感激。

**解决方案：**

在 Marks 回答的帮助下，我修改了一个脚本，它就像一个魅力！谢谢马克！

```
import glob, os
import base64
from unicodedata import normalize

def rename(dir, pattern):
    for pathAndFilename in glob.iglob(os.path.join(dir, pattern)):

        title, ext = os.path.splitext(os.path.basename(pathAndFilename))

        t = normalize('NFC', title.lower()).encode("utf-8") # <-- NORMALIZE !!!

        encoded_string = base64.b64encode(t) + ext

        p = os.path.join(dir, encoded_string)

        os.rename(pathAndFilename, p)

rename(u'./test', u'*.txt') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:22:06.223

看来 Python 脚本使用的是规范化形式的 Unicode，其中`ū`已被分成两个字符`u`和一个[组合宏](http://www.fileformat.info/info/unicode/char/304/index.htm)。[另一种形式使用带有 macron](http://www.fileformat.info/info/unicode/char/16b/index.htm)的单字符[拉丁小写字母`u`](http://www.fileformat.info/info/unicode/char/16b/index.htm)。就 Unicode 而言，它们是相同的字符串，即使它们没有相同的二进制表示。

您可能会从这个 Unicode 常见问题解答中获得更多信息：[http ://www.unicode.org/faq/normalization.html](http://www.unicode.org/faq/normalization.html)

# ruby-on-rails-3 - 为什么 rspec-rails 跳过中间件？

> ID：15026571
> 
> 赞同：2
> 
> 时间：2013-02-22T14:37:03.700
> 
> 标签：ruby-on-rails-3, rack, rspec-rails, rack-middleware

我有一个 Rails 应用程序 (3.2.12)，我想通过 HTTP Accept-Language 标头添加区域设置切换。

**我为实现这一目标所做的工作：**

我将 rack-contrib 添加到我的 Gemfile 中：

```
gem 'rack-contrib', require: 'rack/contrib' 
```

运行`bundle install`，将中间件添加到我的`config/application.rb`：

```
config.middleware.use Rack::Locale 
```

并检查我的控制器的请求环境：

```
puts request.env.keys.select{|v| v=~/rack/ } 
```

我运行的规范是一个控制器规范，它包含`render_views`在其中。

**我的问题：**

请求环境中没有`rack.locale`密钥。我仔细检查了`rake middlware`，它在最后列出`Rack::Locale`，就在之前`run MyApp::Application.routes`。

经过一些调试后，我发现运行时从未调用过中间件

```
rspec spec/controllers/authentication_controller_spec.rb 
```

**但是：**在请求环境中运行相同的代码`script/rails s thin`会给我更多的键，即：

```
rack.request.cookie_string
rack.locale
rack.request.query_string
rack.request.query_hash 
```

所以，我想问题是：**为什么 RSpec 拒绝选择 Rack 中间件？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:53:27.457

控制器规范不通过堆栈，它们几乎直接调用控制器本身。您可能需要为此使用 Rspec 的请求类型测试。

# django - Django 等价于 Rails application_controller

> ID：15026577
> 
> 赞同：1
> 
> 时间：2013-02-22T14:37:29.403
> 
> 标签：django, views, django-views

在 Rails 中，我使用 application_controller 来控制诸如用户会话之类的东西，并创建对象来填充站点的某些部分，例如菜单。

这应该如何在 Django 中完成，因为没有“应用程序视图”？您是否必须使用自定义过滤器和部分模板才能包含在内，例如在基本模板中执行此操作？

我也一直在查看基于类的视图，但不确定是否是这样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T15:09:45.027

有几种方法可以做到这一点：

*   模板标签
*   上下文处理器
*   基于类的视图
*   中间件

这仅取决于您需要做什么。`request.user`始终存在于请求对象中，即使它是匿名用户，因此您无需执行任何特殊操作即可从模板或服务器端代码中访问该对象。

[包含标签](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#inclusion-tags)尽可能接近在 Rails 中呈现部分。 [信号](https://docs.djangoproject.com/en/1.4/topics/signals/)和[基于类的视图](https://docs.djangoproject.com/en/1.4/ref/class-based-views/)与您在控制器过滤器中找到的很接近。

在学习 Django（我从 Rails 转到 Django）时，我发现最有帮助的一本书是[Practical Django Projects](https://rads.stackoverflow.com/amzn/click/com/1430219386)。[Django 权威指南](http://djangobook.com/)也免费提供。

# shell - shell 脚本读取命令不与 ssh 一起等待

> ID：15026580
> 
> 赞同：0
> 
> 时间：2013-02-22T14:37:38.047
> 
> 标签：shell

大家好，我是 shell 脚本的新手，请在这种情况下帮助我。
我创建了一个名为 ./remote1 的 shell 脚本，如下所示。

> # ./remote1 文件
> ssh 用户名@xxxx 'bash -s' < ./createdir

这里'createdir'是我创建的另一个文件，如下所示

> # ./createdir file
> echo "give directory name"
> read name
> mkdir ~/$name

如果我在我的机器上单独运行 ./createdir ，它将毫无问题地执行。
如果我执行 ./remote1，它不会等待输入“读取”命令的数据。请任何人都可以帮我解决这个问题。
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:40:51.193

问题出在遥控器`read`上。为什么不在本地机器上执行读取，而不是远程执行？

例如，您可以将脚本更改为：

```
# ./remote1 file
echo "give directory name"
read name

ssh username@x.x.x.x "bash -s" < ./createdir "$name" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T06:55:24.780

感谢大家的大力支持。
但我已经解决了我的问题。

> # ./remote1 file
> ssh username@xxxx 'echo "给出目录名";
> 读取名称；
> mkdir ~/$name

这简单地解决了我的问题。

问候。

# ios - 如何使用 predicateWithFormat 查询 NSString 包含在 NSSet 中

> ID：15026586
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:03.973
> 
> 标签：ios, core-data, nspredicate

使用 StackMob 作为后端。我有一个`Event`实体，它的关系称为 user `users`(type `NSSet`)。现在我想获取某个用户的所有`username`事件`@"someuser"`。我的代码是这样的：

```
[self.client getLoggedInUserOnSuccess:^(NSDictionary *result) {
        NSString *currentlyLoggedInUser = [result valueForKey:@"username"];

        NSFetchRequest *request = [[NSFetchRequest alloc] init];
        NSEntityDescription *eventEntity = [NSEntityDescription entityForName:@"Event" inManagedObjectContext:self.managedOjbectContext];
        [request setEntity:eventEntity];

        NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY users.username = %@", currentlyLoggedInUser];
        NSLog(@"predicate: %@", predicate);
        [request setPredicate:predicate];
        NSLog(@"request: %@", request);
        events = [NSArray new];
        events = [self.managedOjbectContext executeFetchRequest:request error:nil];

        /* this is working...
        for (Event *e in events) {
            NSLog(@"%@",[e.users filteredSetUsingPredicate:[NSPredicate predicateWithFormat:@"username == %@", currentlyLoggedInUser]]);

        }
         */
        NSLog(@"events: %@", events);
    } onFailure:^(NSError *error) {

    }]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:48:37.303

如果我正确理解您的问题，您必须使用以下谓词：

```
NSString *userName = @"some user";
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY users.username = %@", userName]; 
```

它查找具有给定用户名的任何用户的所有事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T17:46:11.257

假设您有一个 User 实体和一个 Event 实体，您必须将一个 User 传递给谓词，而不仅仅是名称。

```
User *loggedInUser = // anything, e.g.
User *loggedInUser = [[allUsers filteredSetUsingPredicate:
                       [NSPredicate predicateWithFormat:
                         @"username == %@", currentlyLoggedInUser] anyObject];

fetchRequest.predicate = [NSPredicate predicateWithFormat:
                           @"%@ in users", loggedInUser] 
```

# git - Git 文件夹已删除，但并未消失

> ID：15026587
> 
> 赞同：3
> 
> 时间：2013-02-22T14:38:10.073
> 
> 标签：git, github

我想从我的计算机中删除一个 Git 文件夹，所以我没有进入 git 控制台，而是使用 Windows FS 删除了该文件夹。然而，每当我启动 git 控制台时，我意识到我刚刚删除的 Git 文件夹仍然存在。它不在我的计算机上，我可以看到，每次我尝试运行“rm -r FolderName”时，它都会弹出一条消息，询问我是否确定要删除一个写保护文件

```
"rm: remove write-protected file 'Folder/.git/objects/34/33535dg3e4t'?" 
```

这很好，但是有成千上万个，我不会整天坐在那里输入“y”。我也尝试输入

```
"git rm -r FolderName" 
```

但是这个命令不起作用，它说

```
"fatal: Not a git repository (or any of the parent directories): .git" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T14:42:18.787

怎么样`rm -rf FolderName`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-10T04:40:56.717

或者

```
yes | rm -r FolderName 
```

我通常更喜欢这种方法，因为我只是键入`Ctrl+A`转到命令提示符的开头，然后键入`yes |`，这比返回写入`-f`标志要快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:43:05.580

我所要做的就是跑

```
rm -rf ptp/ FolderName 
```

[无法完全删除 git 存储库](https://stackoverflow.com/questions/2384057/cannot-remove-git-repository-completely)

# wpf - Dev Express WPF GridControl - 自动缩小行为

> ID：15026588
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:09.533
> 
> 标签：wpf, devexpress, gridcontrol

我在 * 高度行中有一个 DX GridControl，如下所示：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>​
...​
    <Grid x:Name="ContainingGrid" Grid.Row="1">
        <dxg:GridControl Height="{Binding ActualHeight, ElementName=ContainingGrid}">
            <dxg:GridControl.Columns>
...
            </dxg:GridControl.Columns>
        </dxg:GridControl>
    </Grid>
</Grid> 
```

这很好用——行渲染，获得一个明确的 ActualHeight，并且 Grid 的 Height 绑定到这个，从而避免了指定 AllowInfinite​GridSize 属性的需要。

然而，这一切都包含在一个可调整大小的模块中。当我使这个模块更大时，Grid 随之增长，GridControl 也随着 Grid 增长，正如我所希望/期望的那样。但是，当我将模块重新调整为更小时，GridControl 的高度保持在更大的值。

我正在考虑一种附加行为，但不确定我应该在其中做什么。关于如何让 GridControl 向下调整大小以匹配其容器的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T13:07:40.190

我试图重现这个问题，但在我这边一切正常。我认为您的代码中有其他内容，这会导致此问题。我也无法理解您为什么要进行此绑定。GridControl 将在没有此绑定的情况下正确调整大小。请特别注意，GridControl 对其高度没有任何作用。如果您将 GridControl 更改为标准按钮，则此按钮将像网格一样工作。

# javascript - URL 字符串 获取目录

> ID：15026589
> 
> 赞同：3
> 
> 时间：2013-02-22T14:38:12.973
> 
> 标签：javascript, jquery

我有一个包含 URL 的字符串：

```
var url = "http://www.domain.com/Shared%20Documents/Test%20Plans/CC-12%20Test%20Plan.doc"; 
```

我正在尝试获取目录的 url（即删除文件名并保留其余部分。）我意识到这可能很简单，但我似乎找不到任何东西。

期望的结果：

```
var url = "http://www.domain.com/Shared%20Documents/Test%20Plans/"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:41:23.583

```
 var resultUrl = url.substring(0, url.lastIndexOf("/") + 1); 
```

Working [jsfiddle](http://jsfiddle.net/S7RtH/) here

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T14:41:56.097

使用子字符串如下....

```
url=url.substring(0,url.lastindexof("/")-1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T14:41:48.137

You can use the following expression:

```
location.protocol + '//' + document.domain + location.pathname 
```

with the *current* URL displayed in the address bar.

# c# - 接口和抽象之间有什么区别以及依赖注入如何

> ID：15026591
> 
> 赞同：-5
> 
> 时间：2013-02-22T14:38:20.447
> 
> 标签：c#, oop

`interface`我想知道 aan和`abstract`class之间有什么区别？有什么优点/缺点，我应该什么时候使用？

除了这些问题，我还能用抽象类做依赖注入吗？因为我正在使用 DI 并且想要声明静态字段/私有方法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:39:34.913

接口不能有实现。

抽象类可以有实现——这可以被继承/实现类型使用。

当您想在继承类型之间共享实现时使用抽象类，以允许代码重用（并保持[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)）。

此外，一个类可以实现任意数量的接口，但只能从一个类继承，所以这是另一个考虑因素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:39:41.997

一个区别是抽象类可以包含实现的成员，而接口成员没有任何实现/

另一个是接口不能有字段，抽象类可以。

抽象类鼓励为继承它的类重用基本代码，而接口则在实现相同接口的类之间创建兼容性。

如上所述，您可以实现多个接口，但您只能从一个类继承。

# ios - 在 iOS 的 UITableView 中滚动时索引错误

> ID：15026592
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:20.757
> 
> 标签：ios, cocoa-touch, uitableview, indexing

我正在尝试`UITableView`在我的应用程序中编制索引，例如 iOS 音乐应用程序的歌曲。

所以我写了以下代码。

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    return [[[UILocalizedIndexedCollation currentCollation] sectionTitles] objectAtIndex:section];
}

- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView {
    return [[UILocalizedIndexedCollation currentCollation] sectionIndexTitles];
}

- (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index {
    return [[UILocalizedIndexedCollation currentCollation] sectionForSectionIndexTitleAtIndex:index];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.arrayOfSongs count];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
   return [[[UILocalizedIndexedCollation currentCollation] sectionTitles] count];
} 
```

但是，当我索引`P`字母时，它仍然显示`A`字母数据，如下图所示。

![在此处输入图像描述](../Images/d492f0af557899055ed2faa6e64c840a.png)

当我索引另一个字母时它不会改变。

有什么地方我错了吗？

请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:02:03.157

除了为部分索引标题使用数组外，您还应该将数据“分区”为部分。

可以在这里找到一个很好的教程：[如何使用 UILocalizedIndexedCollat​​ion 将本地化索引添加到 UITableView（也就是将 AZ 索引添加到 UITableView）](http://benedictcohen.co.uk/blog/archives/230)

# c# - C# 不获取 FTP 服务器上的文件大小

> ID：15026593
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:23.363
> 
> 标签：c#, ftp, filesize

当我想在我的 ftp 服务器上获取文件的大小时，我什么也得不到。

有人在代码中看到问题吗？

在我看来这个方法很好

班上 ：

```
public string getFileSize(string fileName)
{
    try
    {
        ftpRequest = (FtpWebRequest)FtpWebRequest.Create(host + "/" + fileName);
        ftpRequest.Credentials = new NetworkCredential(user, pass);
        ftpRequest.UseBinary = true;
        ftpRequest.UsePassive = true;
        ftpRequest.KeepAlive = true;
        ftpRequest.Method = WebRequestMethods.Ftp.GetFileSize;
        ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();
        ftpStream = ftpResponse.GetResponseStream();
        StreamReader ftpReader = new StreamReader(ftpStream);
        string fileInfo = null;
        try { while (ftpReader.Peek() != -1) { fileInfo = ftpReader.ReadToEnd(); } }
        catch (Exception ex) { Console.WriteLine(ex.ToString()); }
        ftpReader.Close();
        ftpStream.Close();
        ftpResponse.Close();
        ftpRequest = null;
        return fileInfo;
    }
    catch (Exception ex) { Console.WriteLine(ex.ToString()); }
    return "";
} 
```

过程：

```
ftp ftpClientCheckFile = new ftp(@"ftp://******.******.fr", "***********", "********");
string ftpfileSize = ftpClientCheckFile.getFileSize(fileName);

if (ftpfileSize == localfilesize)
{
  this.Invoke(new Action(() => { MessageBox.Show(this, "*********", "***", MessageBoxButtons.OK, MessageBoxIcon.Information); }));
  ftpClientCheckFile = null;
}
else
{
  this.Invoke(new Action(() => { MessageBox.Show(this, "***** ", "*******", MessageBoxButtons.OK, MessageBoxIcon.Information); }));
} 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:50:43.757

您需要使用 ContentLength 属性来获取文件大小

```
Console.WriteLine(ftpResponse.ContentLength.ToString()); 
```

某些 ftp 服务器不支持`getfilesize`，因此您必须使用`ListDirectoryDetails`

# php - 可以在 PHP mail() $to 参数中注入标头吗？

> ID：15026596
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:34.160
> 
> 标签：php, security

我想知道这段代码是否安全，

```
$mail = mail($_POST['email'], 'foo' , 'foo'); 
```

它被 RIPS 报告为不安全。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T15:22:04.907

正如其他人已经说过的那样，`mail($_POST['email']...)`在您开始考虑标头注入攻击之前，使用不安全有几个原因。

允许将 POST 变量用作“收件人”地址是不安全的，因为您的表单可用于向任何人发送邮件。即使垃圾邮件发送者无法将他们的消息放入正文中，它仍然可以通过向某人​​的邮箱发送数千条消息来攻击他们。

其次，您没有向我们展示您的`$_POST['email']`变量是否已被清理。在将其用作电子邮件地址之前，您应该检查它是否是有效的电子邮件地址。否则，是的，它可能会被用来对您的邮寄者造成恶作剧。幸运的是，PHP 内置了电子邮件验证功能：

```
$sanitisedEmail = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);
if(!$sanitisedEmail) {die('your email address is invalid');} 
```

但除此之外，如果你想避免头部注入攻击，你应该`mail()`完全避免使用 PHP 的函数。内置`mail()`功能非常基础，有许多可以被黑客利用的弱点。最好使用高质量的包装库，[例如](http://code.google.com/a/apache-extras.org/p/phpmailer/)*phpMailer*。

phpMailer 的主要目的是使在 PHP 中发送电子邮件更加简单——`mail()`如果您需要开始添加标题或附件，使用标准函数所需的 PHP 代码可能会变得非常混乱；phpMailer 使这一切变得非常简单。

但除此之外，使用它也会让你的代码更加安全；phpMailer 为您完成所有必要的输入清理；作为标准流程的一部分，它会验证电子邮件地址并去除恶意标头攻击。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T14:41:14.830

Surely it's not secure and vulnerable to mail injection. Why do you ask?

SMTP protocol is very simple and very close to HTTP one.
It contains headers and each header separatted from another by a mere newline. So, having $_POST['email'] equal to

```
foo@example.com
To: bar@example.com 
```

your script will send 2 mails.
The same goes for almost every argument, including Subject.

Also, just like in HTTP, headers separated from the body by an empty line.
So, the attacker may also **rewrite the body** as well

To prevent that, just check user-entered fields ('cept for the body of course), for `\n` and `\r` characters.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-22T14:42:58.197

恶意用户无法注入标头，但他可以传递一长串逗号分隔的电子邮件地址，并使用您的服务发送垃圾邮件。

在将用户输入数据用于函数（或任何您需要的东西）之前，您应该始终对它们进行检查！

# python - 在python中具有contenteditable的HTML表格

> ID：15026599
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:38.997
> 
> 标签：python, html, flask

我想用 python 中的 contenteditable 字段创建一个 HTML 表。我正在使用python +烧瓶。我将数据准备好作为字典，需要创建一个动态页面并显示项目。我正在检查几个模块，如 pyh 和 html.py。但看起来没有什么适合我的。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:42:08.607

您需要使用 Jinja2 模板。您编写一个包含 python 代码插入的模板文件（有关文档，请参见[此处](http://jinja.pocoo.org/docs/)），然后使用 flask 方法将模板作为返回值呈现给请求方法。所以你用 . 结束你的请求方法`return render_template(args...)`。

# javascript - Google Maps API V3 - 检查坐标是否在后端的 DirectionRoute 附近

> ID：15026601
> 
> 赞同：0
> 
> 时间：2013-02-22T14:38:49.487
> 
> 标签：javascript, mysql, google-maps-api-3

我正在使用 Google Maps API V3 在我的 Java Web 应用程序中使用 MySql 作为数据库创建自定义地图。

我有一个功能可以通过前端添加自定义标记并将标记坐标（纬度/经度）保存在后端。

我打算在前端添加方向搜索功能并将结果（单条路线）保存在后端。

每当添加标记时，我想找出靠近标记位置的所有路线（预先保存）。

有人可以建议我一种存储路线详细信息的有效方法以及将其与标记坐标进行比较的方法。

笔记 ：

我已经了解了 Way points 和 overview_path，但它们都没有提供完整的坐标列表来与标记坐标进行比较。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:38:09.417

如果您将航路点的坐标保存在数据库中，您可以使用 [**Haversine 公式**](http://rosettacode.org/wiki/Haversine_formula) 搜索离您的标记最近的航路点 此查询包含该公式并使用 [**PDO**](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)

```
$stmt = $dbh->prepare("SELECT  name, lat, lng, ( 3959 * acos( cos( radians(?) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( lat ) ) ) ) AS distance FROM mytable HAVING distance < ? ORDER BY distance LIMIT 0 , 1");
    // Assign parameters
    $stmt->bindParam(1,$center_lat);//lat coordinate of user
    $stmt->bindParam(2,$center_lng);//lng coordinate of user
    $stmt->bindParam(3,$center_lat);//lat coordinate of user
    $stmt->bindParam(4,$radius);//Radius in miles 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T16:06:39.317

当您将路线保存在数据库中时，使用 geohashing 计算路线经过的所有边界框并将它们存储在另一个表中（有 2 个字段 - geohash，route_id 作为 PRIMARY）。

当您搜索路线时，计算以用户位置为中心、距离为半径的圆形中的所有边界框，然后使用带有 的查询`geohash IN (circle_hashes)`。

# magento - Magento 从单一商店迁移到多商店。重定向

> ID：15026607
> 
> 赞同：0
> 
> 时间：2013-02-22T14:39:14.660
> 
> 标签：magento

我现在有 1 个网站。例如，它的 URL 是 www.test.com。我想在同一个域上创建第二个网站，将商店代码添加到 URL。所以我的网址将是

```
www.test.com/first/
www.test.com/second/ 
```

但正如我所见，我以前所有的 URL 都会在打开时显示 404。所以如果我打开

```
www.test.com/product.html 
```

它会显示 404。这不好，因为我失去了我的 SEO。如果用户打开，我如何创建重定向

```
www.test.com/product.html 
```

他将被自动重定向到默认网站，例如

```
www.test.com/first/product.html 
```

我对此类重定向有任何问题吗？（就像 API 不起作用）或者 URL 是否可能

```
www.test.com/product.html 
```

从默认网站显示产品（如果存在）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:40:14.293

Magento 有一个非常好的 SEO 系统。

对于重写管理，这些是步骤：

1.登录管理员。2.将鼠标移到目录上，你会发现一个下拉菜单。3 选择 URL 重写管理。

目录 >> UrlRewrite 管理

4.然后点击添加网址重写按钮。

5.然后在下一个屏幕上从提供的选项中选择自定义

创建 URL 重写：选择自定义

现在遵循应该去的重要字段和值：

1.  请求路径（旧 URL）目标路径（新 URL）重定向（永久 301）。

注意：如果您的产品很少，这种方法会很好，但如果您的产品太多，那么建议使用一些 .htaccess 规则。

# jquery-plugins - 为了将可折叠菜单添加到我的轻量级网站，应该从引导响应式导航栏中获取什么？

> ID：15026610
> 
> 赞同：0
> 
> 时间：2013-02-22T14:39:17.160
> 
> 标签：jquery-plugins, twitter-bootstrap, menu, responsive-design, collapse

我创建了一个功能齐全的移动优先响应网站。在这一点上，我还没有使用来自像 Bootstrap 这样的网站的任何框架。我对 jquery 知之甚少，但我正在尝试实现 Bootstrap 提供的类似折叠菜单。我有一个三栏菜单图标，所以我假设我需要一个切换功能来折叠徽标下方的菜单。我正在创建的网站重量很轻，我不想添加巨大的引导响应 css 文件，也不想使用我已经制定的一些命名约定。是否可以仅从引导程序中获取折叠插件并将其调整为我的 css，如果可能，我应该执行哪些步骤？如果有人有知识或任何其他教程，我可以找到以另一种方式创建它的方法，将不胜感激。谢谢你。

下面是我的 html 设置。我不知道这是否有助于了解我是否需要添加 css 才能使折叠 jquery 工作。

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.js"></script>
</head>

<body>
    <section class="grid sticky">
        <div class="container"> 
            <header class="grid twelve header">
                <a class="menuButton not-desktop not-tablet" data-toggle="collapse" data-target=".nav-collapse">
                    <div class="iconBar"></div>
                    <div class="iconBar"></div>
                    <div class="iconBar"></div>
                </a>
                <div class="logoHolder">
                    <a class="logo" href="index.html">
                        <img src="img/logo/ks_logo.svg"> 
                    </a>
                </div>
                <!-- Main Nav, hidden below 768 px -->
                <nav class="mainNav  not-phone not-phoneSM">
                    <ul class="nav">
                        <li><a href="work.html">Work</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </nav>
            </header>
        </div>  
    </section>
<!-- Mobile Main Nav, called upon to relieve when screen is at 768 px -->
    <section class="not-desktop not-tablet">
            <header>
                <nav class="mobileMainNav nav-collapse collapse">
                    <ul>
                        <li><a href="work.html">Work</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </nav>
            </header>
    </section> 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:02:20.747

那么你所指的部分是

```
<div class="navbar">
 <div class="navbar-inner">
  <div class="container">

  <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </a>

  <!-- Be sure to leave the brand out there if you want it shown -->
  <a class="brand" href="#">Project name</a>

  <!-- Everything you want hidden at 940px or less, place within here -->
  <div class="nav-collapse collapse">
    <!-- .nav, .navbar-search, .navbar-form, etc -->
   </div>
  </div>
 </div>
</div> 
```

你总是可以下载 bootstrap css 和 bootstrap js，修改 css 然后缩小，怀疑它会影响你的性能。或者您可以提取您需要的部分并将其合并到您自己的设计中。在没有看到您的标记或响应式 css 的情况下，您已经实施了一种难以提供进一步建议的方法

# ruby-on-rails - rails 轮胎 elasticsearch 奇怪的错误

> ID：15026612
> 
> 赞同：3
> 
> 时间：2013-02-22T14:39:23.053
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已经在数据库`Car`中用一条汽车记录索引了一个模型。`mercedes benz`如果我搜索这个词，`benz`我会得到一个错误：

```
ActiveRecord::RecordNotFound in CarsController#index

Couldn't find all Cars with IDs (1, 3) (found 1 results, but was looking for 2) 
```

如果我搜索`hello`我得到：

```
Couldn't find Car with id=2 
```

其他随机搜索词可以返回准确的结果。

所以它基本上是随机搜索词产生的随机错误。这可能是什么原因？

控制器：

```
def index
 if params[:query].present?
    @cars = Car.search(params)
 else
    @cars = Car.paginate(:page => params[:page], :per_page => 10)
 end    
end 
```

模型：

```
 def self.search(params)
   tire.search(load: true, page: params[:page], per_page: 10) do |s|
    s.query { string params[:query]} if params[:query].present?
   end
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T06:54:00.560

发生这种情况是因为，您正在使用 load => true 选项从数据库加载搜索结果。数据库中似乎缺少活动记录，但弹性搜索索引包含相同的文档。

恕我直言，重新索引并不总是解决方案。

最好的解决方案是在 db 中删除文档时将其删除。您可以为此使用 after_destroy 回调。

Tire remove api 用于从索引中删除单个文档。

```
Tire.index('my-index-name').remove('my-document-type', 'my-document-id') 
```

参考：[https ://github.com/karmi/tire/issues/43](https://github.com/karmi/tire/issues/43)

# c# - 将 WCF 客户端终结点配置为使用相对地址（适用于 Azure）

> ID：15026621
> 
> 赞同：1
> 
> 时间：2013-02-22T14:39:47.247
> 
> 标签：c#, wcf, azure, wcf-binding, basichttpbinding

我有一个 Windows Azure 云服务项目，其中包含**多个 Web 角色**来托管一些服务。我想使用**相对**URL在**ServiceY中使用****ServiceX**（每个都在不同的**角色**上运行） 。

 ******这就是我托管 ServiceX 的方式：

```
<service name="ServiceX">
    <endpoint address="" binding="basicHttpBinding" contract="ServiceX" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
</service> 
```

现在我想在 ServiceY 中使用该服务。使用绝对 URL 可以正常工作：

```
<system.serviceModel>
    <client>
      <endpoint name="ServiceXProxy"
          address="http://mycloudservice.cloudapp.net:8080/ServiceX.svc"
          binding="basicHttpBinding"
          contract="ServiceX"/>
... 
```

但是如何在 ServiceY 中使用具有相对地址的 ServiceX？这不可能，因为它们运行在同一个云服务上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:22:30.353

您可以以编程方式使用相对地址，但您仍然需要知道基地址（*或仅使用 localhost:8080 作为*`web.config`基地址） -除非您构建自定义配置或利用，否则无法通过 使用相对地址`AppSettings`。

```
// create bindings & endpoints
var baseAddress = System.ConfigurationManager.AppSettings["baseAddress"];
var binding = new System.ServiceModel.BasicHttpBinding();
var endpoint = new EndpointAddress(baseAddress + "/ServiceX.svc"); 
```

您还可以从 加载客户端端点地址，并使用类似的方法`web.config`覆盖基地址。`UriBuilder`******

# jquery - 应用以下格式，除非视口小于容器 div - Jquery

> ID：15026623
> 
> 赞同：2
> 
> 时间：2013-02-22T14:40:03.740
> 
> 标签：jquery, if-statement, outerheight, outerwidth

我正在尝试在 Jquery 中创建以下内容，我要做的是仅当视口比 .container div 大时才将格式应用于 div。我已经写了以下内容，但我不确定我是否做得正确，因为我的 Jquery 不是那么好。

```
 $(document).ready(function(){
    $(window).width();   // returns width of browser viewport
    $(document).width(); // returns width of HTML document

    $(window).height();   // returns heightof browser viewport
    $(document).height(); // returns height of HTML document

    var width = $(window).width(); // the window width
    var height = $(window).height();  // the window height
    var containerwidth = $('.container').outerWidth(); // the container div width
    var containerheight = $('.container').outerHeight(); // the container div height

    if ((width >= containerwidth) && (height>=containerheight)){ //if the width and height of the window is bigger than the container run this function
    $(document).ready(function(){                  
     $(window).resize(function(){
      $('.container').css({
       position:'absolute',
       left: ($(window).width() 
         - $('.container').outerWidth())/2,
       top: ($(window).height() 
         - $('.container').outerHeight())/2
      });   
     });
     // To initially run the function:
     $(window).resize();
    });
    }
    });

    EDIT >> 
```

..................................................... ..

我在这里创建了一个 js fiddle，它现在似乎正在工作。

[http://jsfiddle.net/QgyPN/](http://jsfiddle.net/QgyPN/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:13:03.607

您测试窗口尺寸和容器尺寸的方式很好。

然而，你对待你的事件的说法存在问题。你有

```
$(document).ready(function() {
    //...
}); 
```

两次没有意义（顺便说一句，你在小提琴中修复了它，这可能就是它起作用的原因）。

据我了解，您正在尝试： 1\. 页面加载时，如果窗口足够大，请应用某些 CSS。2\. 在随后的页面调整大小时，做同样的事情

因此，我建议您隔离应用 CSS 的代码。这样你就可以多次使用它：

```
var positionContent = function () {
     var width = $(window).width(); // the window width
     var height = $(window).height();  // the window height
     var containerwidth = $('.container').outerWidth(); // the container div width
     var containerheight = $('.container').outerHeight(); // the container div height

     if ((width >= containerwidth) && (height>=containerheight)){
         $('.container').css({position:'absolute',
                             left: ($(window).width() - $('.container').outerWidth())/2,
                             top: ($(window).height() - $('.container').outerHeight())/2 });   
    } 
}; 
```

然后在需要时使用该功能：

```
//Call it when the window first loads
$(document).ready(positionContent);

//Call it whenever the window resizes.
$(window).bind('resize', positionContent); 
```

# c - 任何知道如何使用 c 编程实现多相滤波器的人

> ID：15026625
> 
> 赞同：-1
> 
> 时间：2013-02-22T14:40:08.360
> 
> 标签：c, signal-processing

有谁知道如何使用 C 编程实现多相滤波器。多相滤波器是滤波加下采样的组合。它使用 Fir 滤波器进行滤波，然后使用给定的抽取因子对其进行下采样。

我理解过滤是输入信号与脉冲响应的卷积，所以你只需要调用卷积函数。

简单来说，代码应该是这样的。

```
for ( i = 0; i < sampleCount; i++ ) 
{ 
    y[i] = 0; // set to zero before sum 
    for ( j = 0; j < kernelCount; j++ ) 
    { 
        y[i] += x[i - j] * h[j]; // convolve: multiply and accumulate 
    } 
} 
```

我的问题是我应该如何将这个基本算法转换为多相滤波器，因为它还有一个向下采样的步骤。我不明白我应该首先做什么，过滤然后下采样？或者有没有办法将两者结合起来做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T16:41:19.853

你有代码来计算每个点。对于任何点`i`，该代码都使用`x[i-j]`and中的数据`h[j]`（循环 的值`j`），并将结果写入`y[i]`.

对于下采样，您不需要所有点`y[i]`；你只想要其中的一些。所以编写代码，给定一个`i`，使用相同的数据`x[i-j]`并`h[j]`计算输出值。但是，不是对 的每个值都这样做，`i`而是只对抽取因子的倍数（比如说它被命名为`d`）执行此操作，并将结果写入`y[i/d]`而不是`y[i]`。

# php - 通过php将html添加到新创建的页面

> ID：15026626
> 
> 赞同：0
> 
> 时间：2013-02-22T14:40:11.087
> 
> 标签：php, html

我正在做一个项目，我正在通过 php 创建一个页面，但是创建的页面是空白的，我的意思是没有 html，但我需要做的是在该页面中也有 html

这是我正在创建页面的代码

```
 $ourFileName = $title.".php";
     $ourFileHandle = fopen($ourFileName, 'w') or die("can't open file");
     fclose($ourFileHandle); 
```

但是当页面创建时我希望这个html也在那个页面中

```
 <div class="content">
 <form action="" class="valid" method="post" enctype="multipart/form-data">
    <div class="row">
        <label>Title</label>
        <div class="right"><input type="text" name="title" value="<?php echo $row['title'];?>"
    /></div>
      </div>
                        <div class="row">
            <label>Link</label>
            <div class="right"><input type="text" name="link" value="http://localhost/admin/your page name"
    /></div>
      </div>
        <div class="row">
        <label></label>
            <div class="right">
            <button type="submit"><span>Enter menu item</span></button>
                                <input type="hidden" name="hidden" />
                            </div>
                        </div>
                    </form>
                </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:43:00.647

如果您的意思是要将**php 和 html 结合起来，**您可以将 php 包装到 html 站点中，例如：

```
<html>
<title>...</title>
<?php
echo 'this comes from php';
?>
<p>Some HTML Text</p>
<?php
echo '<b>You could also add some html tags here</b>';
?>
</html> 
```

确保保存它，`.php`以便它由 php 进程执行。

如果你想用**php 创建 html 文件，**你必须使用这样的东西：

```
<?php
file_put_contents('somefile.html', '<html>...</html>');
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:54:59.593

使用包含语句：

[http://php.net/manual/en/function.include.php](http://php.net/manual/en/function.include.php)

当您包含与 html 结合的标签时，请记住使用 php 扩展名，以避免忽略来自网络服务器的 php 代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:45:43.023

如果我正确理解了这个问题，那么您正在使用：

```
 $ourFileName = $title.".php";
 $ourFileHandle = fopen($ourFileName, 'w') or die("can't open file");
 fclose($ourFileHandle); 
```

添加包含页面中显示的代码的文件。

那不管用。除了您打开和关闭文件而不对其进行任何操作之外，您包含的文件/html 还包含 php.ini 文件。

如果要执行该文件中的 php，则需要包含该文件，而不是打开并编写它：

```
 $ourFileName = $title.".php";
 include $ourFileName; 
```

# c# - 打开一个站点时自动在文本框上添加文本

> ID：15026629
> 
> 赞同：1
> 
> 时间：2013-02-22T14:40:27.890
> 
> 标签：c#, asp.net, web-services

所以，我想把一个信息放在一个文本框中，在一个更特殊的文本框中，一个站点的 CNPJ：

> [http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao.asp](http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao.asp)

但我没有得到......所以，我尝试了什么......我试图将 cnpj 值放在链接的最后，如下所示：

> [http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao.asp?cnpj=00495835000160](http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao.asp?cnpj=00495835000160)

但是，该站点没有将值放在文本框中...

我如何使用网站上的 cnpj 值输入（网站上没有数字，就在链接中......）

而且，在 C# 中，我试过这个：

```
using System;
using System.IO;
using System.Net;
using System.Text;

namespace ReceitaFederal
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                WebRequest request = WebRequest.Create("http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao.asp");

                string strPost = "cnpj=00495835000160";

                request.Method = "POST";
                request.ContentLength = strPost.Length;
                request.ContentType = "application/x-www-form-urlencoded";

                StreamWriter writer = new StreamWriter(request.GetRequestStream());
                writer.Write(strPost);

                HttpWebResponse response = (HttpWebResponse)request.GetResponse();

                Stream dataStream = response.GetResponseStream();

                StreamReader reader = new StreamReader(dataStream);

                string responseFromServer = reader.ReadToEnd();

                reader.Close();
                dataStream.Close();
                response.Close();

                Console.WriteLine(responseFromServer);
            }
            catch (Exception exec)
            {
                Console.WriteLine(exec.GetType() + "" + exec.Message);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-24T00:39:59.003

解决了！！！首先添加这个 cookie 容器：

```
using System;
using System.Net;

namespace ConsultaCNPJ
{
    public class CookieAwareWebClient : WebClient
    {
        private CookieContainer _mContainer;

        public void SetCookieContainer(CookieContainer container)
        {
            _mContainer = container;
        }

        protected override WebRequest GetWebRequest(Uri address)
        {
            WebRequest request = base.GetWebRequest(address);
            var webRequest = request as HttpWebRequest;
            if (webRequest != null)
            {
                webRequest.CookieContainer = _mContainer;
                webRequest.KeepAlive = true;
                webRequest.ProtocolVersion = HttpVersion.Version10;
            }
            return request;
        }
    }
} 
```

然后将您的代码编辑为：

```
using System;
using System.Drawing;
using System.IO;
using System.Net;
using System.Text;
using System.Text.RegularExpressions;

namespace ConsultaCNPJ
{
    public class ConsultaCNPJBroker
    {
        private readonly CookieContainer _cookies = new CookieContainer();
        public String DominioReceitaFederal = "http://www.receita.fazenda.gov.br";
        public String GetDataReceitaFederal = "/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao2.asp";
        public String PostDataReceitaFederal = "/pessoajuridica/cnpj/cnpjreva/valida.asp";
        private String _viewState;

        public Bitmap GetCaptcha()
        {
            const string strViewState = "<input type=hidden id=viewstate name=viewstate value='";
            const string strImagemCaptcha = "<img border='0' id='imgcaptcha' alt='Imagem com os caracteres anti robô' src='";
            String htmlResult;

            using (var wc = new CookieAwareWebClient())
            {
                wc.SetCookieContainer(_cookies);
                wc.Headers[HttpRequestHeader.UserAgent] = "Mozilla/4.0 (compatible; Synapse)";
                wc.Headers[HttpRequestHeader.KeepAlive] = "300";
                htmlResult = wc.DownloadString(DominioReceitaFederal + GetDataReceitaFederal);
            }

            if (htmlResult.Length > 0)
            {
                _viewState = htmlResult;

                int posString = _viewState.IndexOf(strViewState, StringComparison.Ordinal);
                _viewState = _viewState.Substring(posString + strViewState.Length);
                posString = _viewState.IndexOf("'>", StringComparison.Ordinal);
                _viewState = _viewState.Substring(0, posString);

                String urlImagemCaptcha = htmlResult;
                posString = urlImagemCaptcha.IndexOf(strImagemCaptcha, StringComparison.Ordinal);
                urlImagemCaptcha = urlImagemCaptcha.Substring(posString + strImagemCaptcha.Length);
                posString = urlImagemCaptcha.IndexOf("'>", StringComparison.Ordinal);
                urlImagemCaptcha = urlImagemCaptcha.Substring(0, posString);
                urlImagemCaptcha = urlImagemCaptcha.Replace("amp;", "");

                if (urlImagemCaptcha.Length > 0)
                {
                    var wc2 = new CookieAwareWebClient();
                    wc2.SetCookieContainer(_cookies);
                    wc2.Headers[HttpRequestHeader.UserAgent] = "Mozilla/4.0 (compatible; Synapse)";
                    wc2.Headers[HttpRequestHeader.KeepAlive] = "300";
                    byte[] data = wc2.DownloadData(DominioReceitaFederal + urlImagemCaptcha);

                    return new Bitmap(
                        new MemoryStream(data));
                }
                return null;
            }
            _viewState = "";
            return null;
        }

        public Stream Consulta(string aCNPJ, string aCaptcha, bool removerEspacosDuplos)
        {
            var request = (HttpWebRequest) WebRequest.Create(DominioReceitaFederal + PostDataReceitaFederal);
            request.ProtocolVersion = HttpVersion.Version10;
            request.CookieContainer = _cookies;
            request.Method = "POST";

            string fviewstate = _viewState;
            fviewstate = Uri.EscapeDataString((fviewstate));

            string postData = "";
            postData = postData + "origem=comprovante&";
            postData = postData + "viewstate=" + fviewstate + "&";
            postData = postData + "cnpj=" + new Regex(@"[^\d]").Replace(aCNPJ, string.Empty) + "&";
            postData = postData + "captcha=" + aCaptcha + "&";
            postData = postData + "captchaAudio=&";
            postData = postData + "submit1=Consultar&";
            postData = postData + "search_type=cnpj";

            byte[] byteArray = Encoding.UTF8.GetBytes(postData);
            request.ContentType = "application/x-www-form-urlencoded";
            request.ContentLength = byteArray.Length;

            Stream dataStream = request.GetRequestStream();
            dataStream.Write(byteArray, 0, byteArray.Length);
            dataStream.Close();

            WebResponse response = request.GetResponse();
            return response.GetResponseStream();                
        }
    }
} 
```

就是这样！

特别感谢我的好朋友 CunhaW！

**用法：**

首先创建一个带有 PictureBox 和一个 TextBox 的表单以及这样的验证码代理

```
private readonly ConsultaCNPJBroker _broker = new ConsultaCNPJBroker();
this.ImgCaptcha = new System.Windows.Forms.PictureBox();
this.TbxCaptcha = new System.Windows.Forms.TextBox(); 
```

然后使用类似 2-Steps 查询，首先获取验证码，然后使用验证码进行查询

```
private void UpdateCaptcha()
{
    ImgCaptcha.Image = _broker.GetCaptcha();
    TbxCaptcha.Text = string.Empty;
} 
```

这里需要用户交互来解决验证码并填充文本框，最后

```
private void BtnExecute_OnClick(object sender, EventArgs e)
{
        var pessoaJuridica = _broker.Consulta(TbxCNPJ.Text, TbxCaptcha.Text, true);
        // here you can see props like pessoaJuridica.CNPJ
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T03:57:54.610

*也许这对你有帮助，它还没有工作......但几乎在那里......*

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Web;
using System.Windows.Forms;

namespace LeituraWeb
{
    public partial class Form1 : Form
    {

        String viewState;
        public String Dominio_ReceitaFederal = "http://www.receita.fazenda.gov.br/";
        public String GetData_ReceitaFederal = "pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao2.asp";
        public String PostData_ReceitaFederal = "pessoajuridica/cnpj/cnpjreva/valida.asp";

        public Form1()
        {
            InitializeComponent();
        }

        private void btnGo_Click(object sender, EventArgs e)
        {

            int PosString;
            String StrViewState = "<input type=hidden id=viewstate name=viewstate value='";
            String StrImagemCaptcha = "<img border='0' id='imgcaptcha' alt='Imagem com os caracteres anti robô' src='";
            String UrlImagemCaptcha = "";
            String HtmlResult = "";

            using (WebClient wc = new WebClient()){
                wc.Headers[HttpRequestHeader.ContentType] = "application/x-www-form-urlencoded";
                HtmlResult = wc.DownloadString(Dominio_ReceitaFederal + GetData_ReceitaFederal);
            }

            if (HtmlResult.Length > 0)
            {
                viewState = HtmlResult;

                // executando um crop do viewstate para utilizar no post
                PosString = viewState.IndexOf(StrViewState);
                viewState = viewState.Substring(PosString + StrViewState.Length);
                PosString = viewState.IndexOf("'>");
                viewState = viewState.Substring(0, PosString);

                //executando um crop na url da imagem 
                UrlImagemCaptcha = HtmlResult;
                PosString = UrlImagemCaptcha.IndexOf(StrImagemCaptcha);
                UrlImagemCaptcha = UrlImagemCaptcha.Substring(PosString + StrImagemCaptcha.Length);
                PosString = UrlImagemCaptcha.IndexOf("'>");
                UrlImagemCaptcha = UrlImagemCaptcha.Substring(0, PosString);
                UrlImagemCaptcha = UrlImagemCaptcha.Replace("amp;", "");                

                // populando a imagem do captcha dentro de um picturebox
                if (UrlImagemCaptcha.Length > 0)
                    pictureBox1.Image = new System.Drawing.Bitmap(new System.IO.MemoryStream(new System.Net.WebClient().DownloadData(Dominio_ReceitaFederal + UrlImagemCaptcha)));
            }
            else
            {
                viewState = "";
            }

        }

        private void button1_Click(object sender, EventArgs e)
        {

            WebRequest request = WebRequest.Create(Dominio_ReceitaFederal + PostData_ReceitaFederal);

            // Formatando o ViewState Recebido
            string fviewstate = viewState;
            fviewstate = System.Uri.EscapeDataString(System.Uri.UnescapeDataString(fviewstate));

            // inserindo os campos a serem postados
            string postData = "";
            postData = postData + "origem=comprovante&";
            postData = postData + "viewstate=" + fviewstate + "&";
            postData = postData + "cnpj=00000000000000&";
            postData = postData + "captcha=000000&";
            postData = postData + "captchaAudio=&";
            postData = postData + "submit1=Consultar&";
            postData = postData + "search_type=cnpj";

            // montando a requisicao

            byte[] byteArray = Encoding.UTF8.GetBytes(postData);           
            request.ContentType = "application/x-www-form-urlencoded";
            request.ContentLength = byteArray.Length;

            Stream dataStream = request.GetRequestStream();
            dataStream.Write(byteArray, 0, byteArray.Length);
            dataStream.Close();

            WebResponse response = request.GetResponse();           
            dataStream = response.GetResponseStream();
            StreamReader reader = new StreamReader(dataStream);
            string responseFromServer = reader.ReadToEnd();

            // ---------- erro aqui !!!
            // retorno da sefaz ---- sempre retorna -- Parametros Inválidos
            Console.WriteLine(responseFromServer);

            reader.Close();
            dataStream.Close();
            response.Close();
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T14:43:36.020

您必须确保目标站点支持您尝试执行的请求类型。

如果没有，那你就不走运了。请记住，Web 应用程序实施是制定规则的人，而不是您。

此外，您似乎正试图从巴西政府网站获取信息。通常，此类站点具有阻止您尝试实现的机制的机制，例如验证[码](http://en.wikipedia.org/wiki/CAPTCHA)和域验证。

好消息是，政府网站通常也会发布有关如何访问公共网络服务的规则和手册。但是，您通常也需要获得许可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-23T05:56:53.017

该页面使用框架：

```
<frame name="top" scrolling="no"  frameborder="0" marginheight="0" noresize="true" target="contents" src="cabecalho.htm" marginwidth="0" marginheight="0">
<frame  frameborder="0" name="main" SRC="cnpjreva_solicitacao2.asp" scrolling="auto" noresize="false" marginheight="0"  marginwidth="0"> 
```

主**框架**包含页面**`cnpjreva_solicitacao2.asp`**，因此调用[http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao2.asp?cnpj=00495835000160](http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao2.asp?cnpj=00495835000160)（见页面文件名中的**2**）将显示由参数传递的 CNPJ 填充的主框架的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-23T08:19:25.930

我说你可以注入 javascript，而不是制作生成的代码。

例如打开您发布的页面 `http://www.receita.fazenda.gov.br/pessoajuridica/cnpj/cnpjreva/cnpjreva_solicitacao.asp`

打开 JS 控制台并输入以下内容：

`document.getElementsByName("main")[0].contentDocument.getElementsByName("cnpj")[0].value = "MyNewValue"`

注意，表单在一个`frame`元素内，所以你需要先获取 frame 元素，然后是 input 元素。

您可以通过 Web 浏览器 API 执行相同的操作。

祝你好运解决验证码

# asp.net - IIS 不显示我的网页

> ID：15026631
> 
> 赞同：1
> 
> 时间：2013-02-22T14:40:30.567
> 
> 标签：asp.net, iis

我在使用 IIS 8.0 显示我的网页时遇到了一些问题。现在，当我打开我的页面时，我没有收到任何错误，`IIS`但现在它只出现：

* * *

本地主机 - /
日期时间文件夹名称
日期时间文件夹名称
日期时间文件夹名称

我应该怎么做才能显示我的网页？我已经选择`checked`了。`ASP.NET``Active or Desactive Windows Features``control panel`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:44:07.123

Did you check to make sure you have a default webpage? E.g. index.html, index.asp, default.html or default.asp? The names are based on the settings of the site of course.

Make a basic html page:

```
<html>
<body>
Hello world.
</body>
</html> 
```

Then put it in the directory IIS is looking for, for the website. You'll want to make sure you setup your DNS to reflect the domain you are trying to host, and then change your local network settings to use your computer's IP before any other DNS. This will allow you to see the website.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:53:16.743

如果您想为您的默认页面使用自定义页面名称，例如“mypages.aspx”，您可以在您的`web.config`

```
<system.webServer>
    <defaultDocument enabled="true">
        <files>
            <add value="~/mypages.aspx"/>
        </files>
    </defaultDocument>
</system.webServer> 
```

您可以在 IIS 中执行相同的操作，转到 IIS 中`DefaultDocument`部署的站点设置下的部分。检查[这个](http://www.iis.net/configreference/system.webserver/defaultdocument)和[这个问题](https://stackoverflow.com/questions/12899450/iis8-default-document-yields-404-not-found-error)，因为您正在使用 IIS8 获取更多信息。

# python - 山狮上的 virtualenvwrapper

> ID：15026632
> 
> 赞同：0
> 
> 时间：2013-02-22T14:40:31.057
> 
> 标签：python, terminal, osx-mountain-lion

按照本指南[http://virtualenvwrapper.readthedocs.org/en/latest/](http://virtualenvwrapper.readthedocs.org/en/latest/)。

我有全新安装的山狮（即不升级）

冉

```
pip install virtualenvwrapper
mkdir -p $DEV_HOME 
```

成功但是当我运行这一行时： source /usr/local/bin/virtualenvwrapper.sh

我得到**-bash: /usr/local/bin/virtualenvwrapper.sh: No such file or directory**

这只是存储在不同的位置吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T14:45:36.793

应该在`/usr/local/share/python/virtualenvwrapper.sh`.

如果不是，请尝试使用以下方法查找`find`：

```
$ find / -name virtualenvwrapper.sh 
```

或者尝试重新安装它并查看`pip`脚本的放置位置：

```
$ pip install -U --force-reinstall virtualenvwrapper

Downloading/unpacking virtualenvwrapper
...
...
changing mode of /usr/local/share/python/virtualenvwrapper.sh to 755    -- aha!
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:00:52.260

在 /Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh 中找到它

我发现它的方法是查看`pip install virtualenvwrapper`所有文件的放置位置

（可以运行两次，pip 会识别它们已经存在）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-04T17:52:10.023

在 El Capitan 我发现 virtualenvwrapper.sh 在

```
/Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenvwrapper.sh 
```

# python - Python 包的本地集合：导入它们的最佳方式？

> ID：15026634
> 
> 赞同：3
> 
> 时间：2013-02-22T14:40:34.923
> 
> 标签：python, module, package, local, software-distribution

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:49:05.287

乱搞`sys.path()`会导致痛苦......[现代包模板](https://pypi.python.org/pypi/modern-package-template)和[分发](http://pythonhosted.org/distribute/index.html)包含大量信息，并且部分设置为解决您的问题。

我要做的是设置 setup.py 将所有包安装到特定的站点包位置，或者如果你可以将它安装到系统的站点包。在前一种情况下，本地站点包将被添加到系统/用户的 PYTHONPATH 中。在后一种情况下，无需更改任何内容

您也可以使用批处理文件来设置 python 路径。或者将 python 可执行文件更改为指向包含修改后的 PYTHONPATH 的 shell 脚本，然后执行 python 解释器。当然，后者意味着您必须有权访问用户的机器，而您没有。但是，如果您的用户只运行脚本而不导入您自己的库，您*可以*使用自己的脚本包装器：

```
#!/path/to/my/python 
```

脚本将`/path/to/my/python`类似于：

```
#!/bin/sh
PYTHONPATH=/whatever/lib/path:$PYTHONPATH /usr/bin/python $* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T15:01:29.613

我认为你应该看看[路径导入钩子](http://www.python.org/dev/peps/pep-0302/)，它允许在搜索模块时修改 python 的行为。

例如，您可以尝试为 python 插件[1] 做类似 kde 的脚本引擎所做的事情。它添加了一个特殊的标记`sys.path`（就像`"<plasmaXXXXXX>"`是`XXXXXX`一个随机数，只是为了避免名称冲突），然后当 python 尝试导入模块并且在其他路径中找不到它们时，它会调用可以处理它的导入器。

一个更简单的替代方法是使用一个主脚本作为启动器，它只是添加路径`sys.path`并执行目标文件（这样您就可以安全地避免`sys.path.append(...)`在每个文件上放置该行）。

另一种适用于 python2.6+ 的替代方法是将库安装在 per-user site-packages 目录下。

* * *

`/usr/share/kde4/apps/plasma_scriptengine_python`[1] 你可以在使用 kde 的 linux 安装中找到源代码。

# mysql - How to count unique values in rows with PHPActiveRecord?

> ID：15026636
> 
> 赞同：0
> 
> 时间：2013-02-22T14:40:43.617
> 
> 标签：mysql, sql, count, unique, phpactiverecord

For example, I have table:

```
id | number
-----------
1  | 1
2  | 1
3  | 1
4  | 2
5  | 2
6  | 3 
```

i need to count unique `number`s (1, 2 and 3), that is 3

i have working SQL code:

```
SELECT COUNT(DISTINCT `number`) AS `total` FROM `some_table` 
```

but i don't know how better to do this with PHPActiveRecord

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:11:40.613

There is a `count()` function in phpAR, but you can't make it work with DISTINCT. So, I think the easiest is:

```
$total = SomeModel::first(['select' => 'COUNT(DISTINCT `number`) AS `total`'])->total; 
```

# java - Switching from null layout to GridBagLayout in Java

> ID：15026639
> 
> 赞同：0
> 
> 时间：2013-02-22T14:40:52.257
> 
> 标签：java, swing, layout-manager, gridbaglayout, null-layout-manager

Below is the runnable code for a calendar application. This application wasn't written by me, and it uses a null layout. I need much more flexibility for my purposes, so I'm trying to use a layout manager instead. However, nothing except the panel border shows up when I try it my way. Also, the original absolute-positioned code is commented out.

```
import javax.swing.*;
import javax.swing.table.*;
import java.awt.*;
import java.awt.event.*;
import java.util.*;

public class CalendarPanel extends JPanel{

    private static final long serialVersionUID = 1L;
    static JLabel lblMonth, lblYear;
    static JButton btnPrev, btnNext;
    static JTable tblCalendar;
    static JComboBox cmbYear;
    static DefaultTableModel mtblCalendar;
    static JScrollPane stblCalendar;
    static int realYear, realMonth, realDay, currentYear, currentMonth;
    private static GridBagLayout gridBag = new GridBagLayout();
    private GridBagConstraints constraints = new GridBagConstraints();

    public CalendarPanel(){
        super(gridBag);

        createControls();
        setBorder();
        registerActionListeners();
        addControls();
        setBounds();
        setDate();
        addHeaders();
        setBackground();
        setTableProperties();
        populateTable();
        refreshCalendar(realMonth, realYear);

    }

    private void createControls(){
        lblMonth = new JLabel ("January");
        lblYear = new JLabel ("Change year:");
        cmbYear = new JComboBox();
        btnPrev = new JButton ("<");
        btnNext = new JButton (">");
        mtblCalendar = new DefaultTableModel(){

            private static final long serialVersionUID = 1L;

        public boolean isCellEditable(int rowIndex, int mColIndex){return false;}};
        tblCalendar = new JTable(mtblCalendar);
        stblCalendar = new JScrollPane(tblCalendar);
    }

    private void setBorder(){
        this.setBorder(BorderFactory.createTitledBorder("Calendar"));
    }

    private void registerActionListeners(){
        btnPrev.addActionListener(new btnPrev_Action());
        btnNext.addActionListener(new btnNext_Action());
        cmbYear.addActionListener(new cmbYear_Action());
    }

    private void addControls(){
        GridBagLayout topGridBag = new GridBagLayout();

        JPanel topPanel = new JPanel(topGridBag);

        topGridBag.setConstraints(btnPrev, constraints);

        topGridBag.setConstraints(lblMonth, constraints);

        topGridBag.setConstraints(lblMonth, constraints);

    /*this.add(lblMonth);
    this.add(lblYear);
    this.add(cmbYear);
    this.add(btnPrev);
    this.add(btnNext);
    this.add(stblCalendar);
        */

    }

    private void setBounds(){
        /*this.setBounds(0, 0, 320, 335);
        lblMonth.setBounds(160-lblMonth.getPreferredSize().width/2, 25, 100, 25);
        lblYear.setBounds(10, 305, 80, 20);
        cmbYear.setBounds(230, 305, 80, 20);
        btnPrev.setBounds(10, 25, 50, 25);
        btnNext.setBounds(260, 25, 50, 25);
        stblCalendar.setBounds(10, 50, 300, 250);*/
    }

    private void setDate(){
        GregorianCalendar cal = new GregorianCalendar(); //Create calendar
        realDay = cal.get(GregorianCalendar.DAY_OF_MONTH); //Get day
        realMonth = cal.get(GregorianCalendar.MONTH); //Get month
        realYear = cal.get(GregorianCalendar.YEAR); //Get year
        currentMonth = realMonth; //Match month and year
        currentYear = realYear;
    }

    private void addHeaders(){
        String[] headers = {"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"};
        for (int i=0; i<7; i++){
            mtblCalendar.addColumn(headers[i]);
        }
    }

    private void setBackground(){
        tblCalendar.getParent().setBackground(tblCalendar.getBackground()); 
    }

    private void setTableProperties(){
        //No resize/reorder
        tblCalendar.getTableHeader().setResizingAllowed(false);
        tblCalendar.getTableHeader().setReorderingAllowed(false);

        //Single cell selection
        tblCalendar.setColumnSelectionAllowed(true);
        tblCalendar.setRowSelectionAllowed(true);
        tblCalendar.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

        //Set row/column count
        tblCalendar.setRowHeight(38);
        mtblCalendar.setColumnCount(7);
        mtblCalendar.setRowCount(6);
    }

    private void populateTable(){
        for (int i=realYear-100; i<=realYear+100; i++){
            cmbYear.addItem(String.valueOf(i));
        }
    }

    private static void refreshCalendar(int month, int year){
        //Variables
        String[] months =  {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};
        int nod, som; //Number Of Days, Start Of Month

        //Allow/disallow buttons
        btnPrev.setEnabled(true);
        btnNext.setEnabled(true);
        if (month == 0 && year <= realYear-10){btnPrev.setEnabled(false);} //Too early
        if (month == 11 && year >= realYear+100){btnNext.setEnabled(false);} //Too late
        lblMonth.setText(months[month]); //Refresh the month label (at the top)
        lblMonth.setBounds(160-lblMonth.getPreferredSize().width/2, 25, 180, 25); //Re-align label with calendar
        cmbYear.setSelectedItem(String.valueOf(year)); //Select the correct year in the combo box

        //Clear table
        for (int i=0; i<6; i++){
            for (int j=0; j<7; j++){
                mtblCalendar.setValueAt(null, i, j);
            }
        }

        //Get first day of month and number of days
        GregorianCalendar cal = new GregorianCalendar(year, month, 1);
        nod = cal.getActualMaximum(GregorianCalendar.DAY_OF_MONTH);
        som = cal.get(GregorianCalendar.DAY_OF_WEEK);

        //Draw calendar
        for (int i=1; i<=nod; i++){
            int row = new Integer((i+som-2)/7);
            int column  =  (i+som-2)%7;
            mtblCalendar.setValueAt(i, row, column);
        }

        //Apply renderers
        tblCalendar.setDefaultRenderer(tblCalendar.getColumnClass(0), new tblCalendarRenderer());
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame();
        JPanel calendarPanel = new CalendarPanel();
        frame.add(calendarPanel);

        frame.setSize(400, 400);
        frame.setLocationRelativeTo(null);
        //frame.setResizable(false);
        frame.setVisible(true);
    }

    static class tblCalendarRenderer extends DefaultTableCellRenderer{
        private static final long serialVersionUID = 1L;

        public Component getTableCellRendererComponent (JTable table, Object value, boolean selected, boolean focused, int row, int column){
            super.getTableCellRendererComponent(table, value, selected, focused, row, column);
            if (column == 0 || column == 6){ //Week-end
                setBackground(new Color(255, 220, 220));
            }
            else{ //Week
                setBackground(new Color(255, 255, 255));
            }
            if (value != null){
                if (Integer.parseInt(value.toString()) == realDay && currentMonth == realMonth && currentYear == realYear){ //Today
                    setBackground(new Color(220, 220, 255));
                }
            }
            setBorder(null);
            setForeground(Color.black);
            return this;  
        }
    }

    static class btnPrev_Action implements ActionListener{
        public void actionPerformed (ActionEvent e){
            if (currentMonth == 0){ //Back one year
                currentMonth = 11;
                currentYear -= 1;
            }
            else{ //Back one month
                currentMonth -= 1;
            }
            refreshCalendar(currentMonth, currentYear);
        }
    }
    static class btnNext_Action implements ActionListener{
        public void actionPerformed (ActionEvent e){
            if (currentMonth == 11){ //Forward one year
                currentMonth = 0;
                currentYear += 1;
            }
            else{ //Forward one month
                currentMonth += 1;
            }
            refreshCalendar(currentMonth, currentYear);
        }
    }
    static class cmbYear_Action implements ActionListener{
        public void actionPerformed (ActionEvent e){
            if (cmbYear.getSelectedItem() != null){
                String b = cmbYear.getSelectedItem().toString();
                currentYear = Integer.parseInt(b);
                refreshCalendar(currentMonth, currentYear);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:44:58.507

简短的回答是：您忘记将组件添加到容器中。我假设您认为 setConstraint() 方法都添加了具有指定约束的组件。实际上，您必须先添加组件，然后设置它们的约束。

# ruby-on-rails - Rails 3 Post to external web service

> ID：15026642
> 
> 赞同：1
> 
> 时间：2013-02-22T14:40:58.577
> 
> 标签：ruby-on-rails, json, web-services

Lets say I have a blog post that a user is creating and I want to send all of the data to an external web service as XML with a specific schema so it can be ingested into that web service.

I have been looking into the ActionDispatch::Request

And I read this [Using Ruby on Rails to POST JSON/XML data to a web service](https://stackoverflow.com/questions/7340052/using-ruby-on-rails-to-post-json-xml-data-to-a-web-service) post and answer

However I got an error saying content_type was not a valid method for request. So I changed that line to call the header method and create a header for content-type with the appropriate information

Ok... so now where to go?

This is my code so far:

```
url= URI.parse('http://10.29.3.47:8080/ingest')
response = Net::HTTP::Post.new(url.path)
request.headers["Content-Type"] = 'application/json'
request.body = 'all of my xml data and schema which is far too long to type here'
response = Net::HTTP.start(url.host, url.port) {|http| http.request(request)}
assert_equal '201 Created', response.get_fields('Status') 
```

I get an error saying that request.body is also not a valid method call, but when I look at the API the only thing matching body is "body()" which does not take arguments. So how do I pass the content of my post to the web service?

Thank you for the help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:28:33.823

你有`response = Net::HTTP::Post.new(url.path)`而不是，`request = Net::HTTP::Post.new(url.path)`你用 .[添加](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTPHeader.html#method-i-add_field)标题`add_field`。

```
require 'net/http'
require 'uri'
url= URI.parse('http://10.29.3.47:8080/ingest')
request = Net::HTTP::Post.new(url.path)
request.add_field 'Content-Type', 'application/json'
request.body = 'all of my xml data and schema which is far too long to type here'
response = Net::HTTP.start(url.host, url.port) {|http| http.request(request)} 
```

# android - Social sharing on Android

> ID：15026644
> 
> 赞同：2
> 
> 时间：2013-02-22T14:41:03.023
> 
> 标签：android, facebook, twitter, social-networking, google-plus

So sharing on social channels is a hot topic these days. I have done some research on how to share to Facebook, Twitter, LinkedIn and G+.

Lets start with an example.. I want to share text, and an image to 4 social channels (Facebook, Twitter, LinkedIn and G+), but without the user adding more text.

My findings so far:

1.  You can use `Intent.ACTION_SEND` but there are a lot of limitations like:

    *   You need to make your own chooser if you want to filter the social channels
    *   Sending text and image is not possible without the user adding more text
2.  Using default social channel APIs, but:

    *   Can be overhead, you only want to share.
    *   Are not always stable.
3.  There are some open source libraries you can use, but they are not as complete as you may think

4.  Use paid services (do I need to say more...)

So in conclusion, I need help. What is the way to go?.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:47:38.167

您无需为`Intent.ACTION_SEND`. 特别是因为列出的应用程序旨在处理此意图。

这应该很好，因为您宁愿让用户选择他们想要分享的内容，然后将他们限制为一个。我想说，如果您想分享，那么请坚持使用 android 上的标准并使用`ACTION_SEND`.

当用户可能更喜欢使用应用程序 B 时，您不能期望他们拥有应用程序 A。不要考虑约束。

另外，作为您对`ACTION_SEND`.. 限制的评论，我建议您重新阅读文档，因为我在任何地方都看不到该限制：http: [//developer.android.com/reference/android/content/Intent.html#ACTION_SEND](http://developer.android.com/reference/android/content/Intent.html#ACTION_SEND)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T13:05:01.800

您可以使用支持 10 个社交提供商的[SocialAuth](https://code.google.com/p/socialauth-android/)，它为您提供分享文本、上传图片、获取相册、提要等功能。

# php - 在 Amazon API 中，仅针对类别使用 ItemSearch

> ID：15026658
> 
> 赞同：2
> 
> 时间：2013-02-22T14:41:55.630
> 
> 标签：php, amazon-web-services, amazon

我正在使用亚马逊产品广告 API，我想检索一个类别的所有产品。我想知道的是我是否可以**只提供一个类别**而不将任何关键字传递给 ItemSearch 操作并检索完整的产品记录集，包括其子类别产品。

我尝试在不提供“关键字”项的情况下在数组中传递此参数：

```
$category = 'Software';    
$single = array(
      "Operation"     => "ItemSearch",
      "SearchIndex"   => $category,
      "Condition"     => "All",
      "ResponseGroup" => "Medium,Reviews"       
    ); 
```

但它不起作用。请帮我。

让我再次简短地解释一下，我想要的只是通过传递任何类别**而不传递任何 Keyword**来获得完整的 Products 列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T17:18:21.320

您可能想要执行`BrowseNodeLookup`. 此操作将允许您根据传递的浏览节点 ID 迭代地向上和向下导航祖先/子树。

这是该操作的文档：

[http://docs.aws.amazon.com/AWSECommerceService/latest/DG/BrowseNodeLookup.html](http://docs.aws.amazon.com/AWSECommerceService/latest/DG/BrowseNodeLookup.html)

顶级浏览节点 ID 的列表在这里：

[http://docs.aws.amazon.com/AWSECommerceService/latest/DG/BrowseNodeIDs.html](http://docs.aws.amazon.com/AWSECommerceService/latest/DG/BrowseNodeIDs.html)

然后，您可以使用您感兴趣的浏览节点 ID，并将其作为参数值传递给 ItemSearch。在这种情况下，您根本不需要包含关键字参数。

操作可能如下所示：

```
$browse_node_id = '409488'; // browse node id for Software in US or other browse node determined by using BrowseNodeLoookup   
$single = array(
  "Operation"     => "ItemSearch",
  "BrowseNode"    => $browse_node_id,
  "SearchIndex"   => "All", // we don't need to limit to certain category here as browse node does this
  "Condition"     => "All",
  "ResponseGroup" => "Medium,Reviews"       
); 
```

# excel - Excel：日期格式问题

> ID：15026667
> 
> 赞同：0
> 
> 时间：2013-02-22T14:42:18.853
> 
> 标签：excel, vba

我有几个单元格可以使用“FormatDatetime”函数填写日期，

代码：

```
Range("AX1") = FormatDateTime((Docx.getAttribute("r1ed")))
Range("AX2") = FormatDateTime((Docx.getAttribute("r2ed")))
Range("AX3") = FormatDateTime((Docx.getAttribute("r3ed")))
Range("AX4") = FormatDateTime((Docx.getAttribute("r4ed"))) 
```

如果日期用“.”分隔 所有单元格都将显示为“12.1.2013”​​，但如果我更改以“-”分隔的系统日期格式，“AX4”显示日期仍为“12.1.2013”​​。但其他显示正确。

我需要解决这个问题，因为我稍后在 VBA 中使用这些日期进行计算。

请提出一些答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-11T15:22:12.863

我认为你的问题是`FormatDateTime()`返回一个字符串，改为`DateValue()`改为。如果 return from`Docx.getAttribute()`包含点，您需要先用斜线替换它们。

所以;

```
'[AX1] is the same as Range("AX1")
[AX1] = DateValue(Docx.getAttribute("r1ed"))
[AX2] = DateValue(Docx.getAttribute("r2ed"))
[AX3] = DateValue(Docx.getAttribute("r3ed"))
[AX4] = DateValue(Docx.getAttribute("r4ed")) 
```

或者，如果有点；

```
[AX1] = DateValue(Replace(Docx.getAttribute("r1ed"), ".", "/"))
[AX2] = DateValue(Replace(Docx.getAttribute("r2ed"), ".", "/"))
[AX3] = DateValue(Replace(Docx.getAttribute("r3ed"), ".", "/"))
[AX4] = DateValue(Replace(Docx.getAttribute("r4ed"), ".", "/")) 
```

如果这不能解决问题，请您发布有关`Docx.getAttribute()`返回内容的更多信息。

* * *

编辑：另外，知道您需要单元格包含的格式会有所帮助 - 我假设正确的日期是可以接受的 - 您可能需要一个带有特定格式日期的字符串。如果是这种情况，您可以用类似的东西包装上面的内容；

```
[AX1] = Format(DateValue(Docx.getAttribute("r1ed")), "dd/mm/yyyy") 
```

可能`FormatDateTime()`是背叛了你，`Format()`可能更灵活

# android - 用户登录验证

> ID：15026668
> 
> 赞同：0
> 
> 时间：2013-02-22T14:42:28.573
> 
> 标签：android, android-sqlite

我正在申请。有一个登录页面，用户在该页面的编辑文本字段中输入用户名。然后将其传递给我的 databasehelper 类中的函数，该函数根据所有用户名所在的表中的条目检查用户名。

这是我在我的 databasehelper 类中为验证编写的函数：

```
public String verify_user(String is_user)
{
    String verify = " ";
    String check = " ";
    SQLiteDatabase fg = this.getReadableDatabase();
    Cursor c = fg.query(Login_Table, null, null, null, null, null, null);
    int iuser = c.getColumnIndex(colUsername);
    for(c.moveToFirst() ; !c.isAfterLast();c.moveToNext())
    {
        verify = c.getString(iuser);
        if(is_user == verify)
        {
            check = "Valid User!";
        }
        else
        {
            check = "Not Valid User!";
        }
    }
    return check;

} 
```

is_user 来自用户输入用户名的 .xml 布局文件......当我调试时，我发现了一个奇怪的行为。尽管在条件 is_user 和 verify 在某一点上具有相同的值，但仍然执行 else。所以我知道用户是有效的，这段代码说无效用户！. 请引导我完成。谢谢你！

来自一个新的建议：

```
String check = " ";
    SQLiteDatabase fg = this.getReadableDatabase();
    String[] args = new String[1];
    args[0] = is_user;
    Cursor c = fg.query(Login_Table, null, colUsername + " = ?", args, null, null, null);
    int iuser = c.getColumnIndex(colUsername);
    if(is_user.equals(c.getString(iuser)))
    {
        check = "Valid User!";
    }
    return check; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:46:32.607

在 Java 中，您使用 比较字符串`equals()`，而不是`==`

```
if(is_user.equals(verify)) 
```

此外，您不需要遍历所有用户。只需在查询中添加条件即可。有关更多信息，请参阅[文档](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query%28java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%29)。

*编辑*：好的查询是：

```
String[] args = new String[1];
args[0] = is_user;
Cursor c = fg.query(Login_Table, null, colUsername + " = ?", args, null, null, null); 
```

始终使用参数，从不连接 like `colUsername+"="+is_user`，这很容易受到[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:31:15.003

采用

```
.equals(...).

if(is_user.equals(verify)){
... 
```

# c++ - c++ 变量参数列表

> ID：15026671
> 
> 赞同：1
> 
> 时间：2013-02-22T14:42:37.733
> 
> 标签：c++, variadic-functions

我正在寻找答案，但找不到任何相关信息。让我们举个例子：

```
class MyClass
{
    //member functions and variables
};

void foo(int pivot,...)
{
    va_list arguments;  
    va_start(arguments,pivot);

    //va_arg(arguments,???)

    va_end(arguments);
}

void bar()
{
    MyClass a;
    MyClass * b = &a;
    const MyClass & c = a;
    foo(0,a,b,c);
} 
```

论据如何`a`，`b`并`c`通过？按值，或按引用以及如何使用 va_arg 要求它们？MyClass 的构造函数/析构函数呢？在 c++ 标准中，这种行为是在哪里指定的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:45:51.517

永远不要在 var-arg 函数中使用用户定义的类型。使用 C++11 可变参数模板。

如果您的课程不是 pod 类型 - 它未按标准指定，感谢 Vaughn Cato 的评论

n3337 5.2.2/7

> 传递具有非平凡复制构造函数、非平凡移动构造函数或非平凡析构函数的类类型（第 9 条）的潜在评估参数，没有相应的参数，由实现定义的语义有条件地支持。

否则，你可以而且它会是正确的，但你不应该。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T15:11:31.560

按价值。但请注意，如果`MyClass`不是 POD，程序具有未定义的行为（C++03，§5.2.2/7），或者如果`MyClass`具有非平凡的复制构造函数、移动构造函数或析构函数，则有条件地支持该操作，使用实现定义的语义（C++11，§5.2.2/7）。

在您的示例中，传递`a`和传递`c`是完全相同的操作（除了`c`不能绑定到非常量引用，但这不是问题，因为可变参数都是按值传递的）。因此，当调用 时`foo`，您传递`0`的副本`a`、指针`b`的副本和 的副本`a`。为了在 中访问它们， `foo`您需要将类型声明`va_arg`为`int`、`MyClass`和。`MyClass*``MyClass`

# javascript - 如何在表单集中应用 jQuery 自动完成功能？

> ID：15026673
> 
> 赞同：-1
> 
> 时间：2013-02-22T14:42:41.847
> 
> 标签：javascript, jquery, formsets

我一直在思考如何将 JS 代码应用于表单集。

我有这个 HTML：

```
<input id="id_form-0-city" name="id_form-0-city" type="hidden">
<input id="id_form-0-city_input" name="id_form-0-city_input"> 
```

我使用这个 JS/jQuery 代码来自动完成 #id_form-0-city_input 输入。

```
 // Autocomplete stuff  
    $( "#id_form-0-city_input" ).autocomplete({  // mudar!!!!
        source: function( request, response ) {
            $.ajax({
                url: "/internalapi/cidades/",
                dataType: "json",
                data: {
                    country: $('#id_country').find(":selected").val(),
                    term: request.term.toLowerCase()
                },
                success: function( data ) {
                    response($.map(data, function( item ) {    
                        return {
                            label: item.name + " (" + item.zone + ", " + item.municipality + ")",
                            value: item.name,
                               id: item.id
                        }     
                    }));
                }
            });
        },
        minLength: 2,
        select: function( event, ui ) {
            var selectedObj = ui.item;
            // Popular o campo id_city
            $( "#id_form-0-city" ).val(selectedObj.id);
        },
        search: function(event, ui) { 
            $("#id_form-0-city_input").addClass( "ui-autocomplete-loading" ); // mudar!!!!!
        },
        open: function() {
            $("#id_form-0-city_input").removeClass( "ui-autocomplete-loading" ); // mudar!!!!
            $( this ).removeClass( "ui-corner-all" ).addClass( "ui-corner-top" );
        },
        close: function() {
            $( this ).removeClass( "ui-corner-top" ).addClass( "ui-corner-all" );
        }
    }); 
```

上面的代码效果很好，但现在我需要在这种情况下使用这个自动完成代码：

```
<input id="id_form-0-city" name="id_form-0-city" type="hidden">
<input id="id_form-0-city_input" name="id_form-0-city_input">

<input id="id_form-1-city" name="id_form-0-city" type="hidden">
<input id="id_form-1-city_input" name="id_form-0-city_input">

<input id="id_form-2-city" name="id_form-0-city" type="hidden">
<input id="id_form-2-city_input" name="id_form-0-city_input">

<input id="id_form-3-city" name="id_form-0-city" type="hidden">
<input id="id_form-3-city_input" name="id_form-0-city_input">

<input id="id_form-4-city" name="id_form-0-city" type="hidden">
<input id="id_form-4-city_input" name="id_form-0-city_input">

...
... 
```

集合的数量可以是最小 1 和最大 10。

你能给我一些想法来重构 JS/jQuery 代码以使用表单集吗？我需要使用 for 循环吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:06:13.017

如果您不想使用类，可以在输入中添加 rel 元素，例如：

```
<input id="id_form-0-city" name="id_form-0-city" type="hidden">
<input id="id_form-0-city_input" name="id_form-0-city_input" rel="autocomplete">

<input id="id_form-1-city" name="id_form-0-city" type="hidden">
<input id="id_form-1-city_input" name="id_form-0-city_input" rel="autocomplete">

<input id="id_form-2-city" name="id_form-0-city" type="hidden">
<input id="id_form-2-city_input" name="id_form-0-city_input" rel="autocomplete">

<input id="id_form-3-city" name="id_form-0-city" type="hidden">
<input id="id_form-3-city_input" name="id_form-0-city_input" rel="autocomplete">

<input id="id_form-4-city" name="id_form-0-city" type="hidden">
<input id="id_form-4-city_input" name="id_form-0-city_input" rel="autocomplete"> 
```

然后只需在其中添加自动完成逻辑

```
$("input[rel='autocomplete']").autocomplete({  // mudar!!!!
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:21:55.857

只需使用 for 循环...

```
var inputLength = $('input:not(input[type="hidden"])').length; //find non-hidden inputs

for(var a = 0; a<inputLength; a++){
   // Autocomplete stuff  
    $( "#id_form-" + a + "-city_input" ).autocomplete({  // mudar!!!!
    source: function( request, response ) {
        $.ajax({
            url: "/internalapi/cidades/",
            dataType: "json",
            data: {
                country: $('#id_country').find(":selected").val(),
                term: request.term.toLowerCase()
            },
            success: function( data ) {
                response($.map(data, function( item ) {    
                    return {
                        label: item.name + " (" + item.zone + ", " + item.municipality + ")",
                        value: item.name,
                           id: item.id
                    }     
                }));
            }
        });
    },
    minLength: 2,
    select: function( event, ui ) {
        var selectedObj = ui.item;
        // Popular o campo id_city
        $( "#id_form-" + a + "-city" ).val(selectedObj.id);
    },
    search: function(event, ui) { 
        $("#id_form-" + a + "-city_input").addClass( "ui-autocomplete-loading" ); // mudar!!!!!
    },
    open: function() {
        $("#id_form-" + a + "-city_input").removeClass( "ui-autocomplete-loading" ); // mudar!!!!
        $( this ).removeClass( "ui-corner-all" ).addClass( "ui-corner-top" );
    },
    close: function() {
        $( this ).removeClass( "ui-corner-top" ).addClass( "ui-corner-all" );
    }
    }); 
} 
```

演示：http: [//jsfiddle.net/NcTpj/10/](http://jsfiddle.net/NcTpj/10/)

# scala - Scala 的类型参数化

> ID：15026677
> 
> 赞同：1
> 
> 时间：2013-02-22T14:42:45.970
> 
> 标签：scala, types, parameterization

以一个具体的方法为例，

```
def df(f: Float => Float, dt: Float) = (t: Float) => f(t + dt) - f(t) 
```

它可以编译和工作。但是，当我尝试以通用方式定义它时，

```
def df[T](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t) 
```

编译器说，

> “错误：类型不匹配；找到：T；必需：String def df[T](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t)” .

似乎无法添加类型 T。然后我尝试了另一种方法，

```
def df[T <: Double](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t) 
```

又失败了，

```
scala> def df[T <: Double](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t)
<console>:7: error: type mismatch;
 found   : Double
 required: T
       def df[T <: Double](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t)
                                                             ^ 
```

现在我所有的把戏都用完了。

我怎样才能做到？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T15:08:05.213

关于您的第一个定义：

```
def df[T](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t) 
```

这不可能是因为我们不知道类型 T 是否存在“+”或“-”方法。

你的第一个定义，

```
def df[T <: Double](f: T => T, dt: T) = (t: T) => f(t + dt) - f(t) 
```

短篇小说 - 无法扩展`Double`，即使您可以，该`+`方法也需要另一个 double，而不是`T`.

一般来说，要做到这一点，我们需要一个适用于所有数字类型并声明所有数字运算符的统一特征。不幸的是，在 Scala 中并非如此。但是我们有下一个最好的东西：类型类（有关一些信息，请参阅这个问题：[Scala 中的类型类有什么用处？](https://stackoverflow.com/questions/5408861/what-are-type-classes-in-scala-useful-for)）。类型类是在 Scala 中使用隐式实现的。

您的解决方案是：

```
def df[T](f: T => T, dt: T)(implicit num: Numeric[T]) = (t: T) => num.minus(f(num.plus(t, dt)), f(t)) 
```

该方法是通用的，但它还需要一个对象，该对象`num`知道如何对类型的对象执行诸如等之类的操作`plus`，并且该对象是隐式传递的。幸运的是，Scala 库为所有基本数字类型 Int、Double 等提供了实例，因此您不必这样做。`minus``T``Numeric`

后期编辑：

正如 Jesper Nordenberg 和 Régis Jean-Gilles 指出的那样，您实际上可以使用导入获得初始表达式：

```
def df[T](f: T => T, dt: T)(implicit num: Numeric[T]): (T => T) = {
  import num._
  (t: T) => f(t + dt) - f(t)
} 
```

这也是使用隐式转换来实现的。您可以查看源文件以`Numeric`获取有关正在发生的事情的更多信息：[Numeric.scala](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/math/Numeric.scala#L1)

不过你应该小心。如果您进行繁重的数学计算，这个解决方案可能会出现性能问题，主要是因为装箱。

希望能帮助到你 ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T15:02:51.803

你不能`t + dt`为任意类型做，`T`因为不能保证`+`存在`T`——事实上，大多数类型都没有定义`+`.

它也不起作用，`T <: Double`因为子类`+`上的方法`Double`返回 a `Double`，并`f`要求将 a`T`传递给它。

现在，您可能正在寻找一种进行通用数学的方法——也就是说，忽略传递给您的确切数字类型。这在 Scala 中并不容易做到，特别是如果您还想要性能的话。您可以访问[我的这个老问题](https://stackoverflow.com/q/485896/53013)，尽管现在有更有效的方法。如果您想要效率，请查看[Spire 。](https://github.com/non/spire)

# jira - SOAPpy - 创建一个 Jira 问题并定义一个组件？

> ID：15026679
> 
> 赞同：0
> 
> 时间：2013-02-22T14:42:48.820
> 
> 标签：jira, soappy, jira-rest-java-api

我不知道如何创建 jira 问题并使用 SOAPpy 定义其组件：

```
client = so.WSDL.Proxy(cfg_wsld)
auth_token = client.login(cfg_username, cfg_password)
issue_params = dict()
issue_params['project'] = project
issue_params['type'] = issue_type
issue_params['summary'] = summary
issue_params['description'] = summary
newissue = client.createIssue(auth_token, issue_params) 
```

此示例工作正常，但我尝试向其中添加组件 Jira 将返回 missmatchTypeException。

我尝试了各种变体：将数组、字符串、整数传递给它，但它不会选择其中的任何一个。

大多数尝试（同时传递字符串、整数、数组）都会导致 TypeMissmatch，这会导致 Jira 内部出现 NullPointerException：

```
issue_params['components'] = {u'Разное': {'id': '11143', 'name': u'Разное'}} 
```

我知道我想使用的问题类型的确切 ID，但是如何正确传递它？当我检索此类型的问题时，组件返回为 SOAPpy.Types.typedArrayType() 但这仍然失败：

```
issue_params['components'] = so.Types.typedArrayType(data={'id': '11143', 'name': u'Разное'})
newissue = client.createIssue(auth_token, issue_params)

(<class 'SOAPpy.Errors.Error'>, <Error : Data must be a sequence>, None) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:29:22.960

```
issue_params['components'] = so.Types.typedArrayType(data=[{'id': '11143', 'name': u'Разное'},]) 
```

这成功了——数据需要是一个数组。

# mongodb - Mongodb worker 角色抛出 System.IO.FileNotFoundException

> ID：15026680
> 
> 赞同：2
> 
> 时间：2013-02-22T14:42:50.037
> 
> 标签：mongodb, azure, azure-worker-roles, azure-storage

我有一个使用 mongodb 工作角色的 Azure 云项目。在本地模拟器中运行时一切正常，但是当我部署到 Azure 暂存区时，mongodb 工作人员角色卡在循环中并显示 System.IO.FileNotFoundException。我远程连接到其中一台虚拟机并查看事件查看器，发现以下错误：

> 发生未处理的异常。类型：System.IO.FileNotFoundException 进程 ID：1936 进程名称：WaWorkerHost 线程 ID：4 AppDomain 角色 MongoDB.WindowsAzure.MongoDBRole_IN_0 的未处理异常异常：无法加载文件或程序集'mswacdmi，版本 = 1.7.0.0，文化 = 中性， PublicKeyToken=31bf3856ad364e35' 或其依赖项之一。该系统找不到指定的文件。在 Microsoft.WindowsAzure.StorageClient.CloudDrive..ctor(Uri uri, StorageCredentials credentials) 在 Microsoft.WindowsAzure.StorageClient.CloudStorageAccountCloudDriveExtensions.CreateCloudDrive(CloudStorageAccount storageAccount, String pageBlobUri) 在 MongoDB.WindowsAzure.MongoDBRole.Utilities.GetMountedPathFromBlob(String localCachePath, String cloudDir，字符串 containerName，字符串 blobName，Int32 driveSize，

为什么这在本地工作而不是在 Azure 上工作？我对装配等不太了解，但我正在学习。网上建议的一件事是检查引用程序集的属性并将“复制本地”设置为真，我已经尝试过，但仍然是同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:00:28.680

在您的辅助角色项目中，确保您有一个 .NET 引用，`mswacdmi.dll`其中属性集[**Copy Local=true**](http://msdn.microsoft.com/en-us/library/vstudio/t1zz5y8c%28v=vs.100%29.aspx)。发布时 - [RDP 到您的 Azure 角色实例](http://msdn.microsoft.com/en-us/library/windowsazure/gg443832.aspx)，以验证您部署的角色在`/bin`目录中是否具有程序集。

还要确保您的目标是 x64 - 我`mswacdmi.dll`在这条路径上找到（*Azure SDK 1.8*）：

> C:\Program Files\Microsoft SDKs\Windows Azure.NET SDK\2012-10\bin\runtimes\storage\cloud\x64

# jquery - TinyMCE 代码清理？

> ID：15026681
> 
> 赞同：1
> 
> 时间：2013-02-22T14:42:56.840
> 
> 标签：jquery, tinymce

TinyMCE 很整洁，这是无可争议的。但是，我发现它生成的 HTML 有很多不足之处。例如，当一个人选择文本并更改颜色时，它会注入大量标签——在最好的情况下不需要，但在许多情况下足以让 TinyMCE 感到困惑。

我的问题 - 是否有一个 TinyMCE 插件可以清理它生成的 HTML？在谷歌上的简短搜索并没有产生任何有用的东西。

# java - SL4FJ 是否提供与 Log4J PatternLayout 等效的功能？

> ID：15026684
> 
> 赞同：0
> 
> 时间：2013-02-22T14:43:00.900
> 
> 标签：java, log4j, slf4j

我目前将 Log4J 用于库，并希望转向使用 SLF4J 以允许库的用户选择日志框架。

除了我用来在日志消息进入屏幕或日志之前替换日志消息中的文本的一类之外，一切都很好：

```
public class FilteringLayout extends PatternLayout {

    private static final String REPLACEMENT = "[APIKEY]";
    private static Pattern replacementPattern = Pattern.compile("DO_NOT_MATCH");

    public static void addReplacementString(String replacementString) {
        replacementPattern = Pattern.compile(replacementString);
    }

    @Override
    public String format(LoggingEvent event) {
        if (event.getMessage() instanceof String) {
            String message = event.getRenderedMessage();

            Matcher matcher = replacementPattern.matcher(message);
            if (matcher.find()) {
                String maskedMessage = matcher.replaceAll(REPLACEMENT);

                Throwable throwable = event.getThrowableInformation() != null
                        ? event.getThrowableInformation().getThrowable() : null;

                LoggingEvent maskedEvent = new LoggingEvent(event.fqnOfCategoryClass,
                        LoggerFactory.getLogger(event.getLoggerName()), event.timeStamp,
                        event.getLevel(), maskedMessage, throwable);

                return super.format(maskedEvent);
            }
        }
        return super.format(event);
    }
} 
```

我将如何使用纯 SLF4J 做到这一点并消除对 Log4J 的依赖？

编辑：为了更清楚起见，我想在将其发送到下游记录器之前自动从日志消息中删除一组字符序列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:02:13.687

我认为您可以使用 SLF4J 的映射诊断上下文功能来实现相同的目标。它同时使用 log4j 和 logback 作为后端。见[http://logback.qos.ch/manual/mdc.html](http://logback.qos.ch/manual/mdc.html)

引用[SLF4J 的手册](http://www.slf4j.org/manual.html)：

> “映射诊断上下文”本质上是由日志框架维护的映射，应用程序可以在其中提供键值对，然后由日志框架将其插入日志消息中。

### 编辑：

抱歉，我没有仔细阅读您的代码。我认为 SLF4J（只是一个日志 API）默认不支持过滤器和类似的功能。但是，您可以实现一个包装器，在转发日志消息之前对其进行处理。扩展`LoggerWrapper`并创建一个`LoggerFactory`可以在整个代码库中使用的对应项。`XLoggerFactory`以和`XLogger`in的来源`slf4j-ext`为例。

# java - 预定的任务流程

> ID：15026686
> 
> 赞同：0
> 
> 时间：2013-02-22T14:43:04.333
> 
> 标签：java

我需要创建一个从 somewere 检索数据的计划任务，然后执行解析 --> 然后操作 --> 然后创建输出文件 --> 然后发送输出文件

我想使用 5 个工作类：MainExecutor 类、Retriever 类、Reader 类、Builder 类、Sender 类 MainExecutor 类将使用*ScheduledThreadPoolExecutor*来调度 Retriever。

我想让这个应用程序可扩展。我是否需要将这些类（Reader、Builder、Sender）中的每一个都设为单独的线程？

我需要为每个人使用一个线程池吗？

实施该计划的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:49:31.393

Retriever 和 Sender 大概会阻塞等待网络，Reader 肯定是 IO 密集型的，Builder 可能是 CPU 密集型的。所以是的，在不同的线程上运行它们是有意义的。您只需要一个线程池即可。

这将使您的应用程序更具可扩展性，并且还将提高性能（吞吐量）。缺点是您需要组织线程之间的通信。

# html - CSS选择孩子

> ID：15026689
> 
> 赞同：0
> 
> 时间：2013-02-22T14:43:06.753
> 
> 标签：html, css, css-selectors

我的问题是关于选择 CSS 第一个或第二个图像。

```
<div class="ao-preview">
                    <input type="checkbox" id="ao-toggle" class="ao-toggle" name="ao-toggle" />
                    <img src="img/local.png"/>
                    <img src="img/local_big.jpg"/>
</div> 
```

CSS 代码

```
.ao-item img {
    margin: 0 auto;
    max-width: 100%;
    display: block;
    -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=80)";
    filter: alpha(opacity=80);
    opacity: 0.8;
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    -ms-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
}

input.ao-toggle:checked  +img{
        -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=99)";
        filter: alpha(opacity=99);
        opacity: 1;
        -webkit-transform: scale(0);
        -moz-transform: scale(0);
        -o-transform: scale(0);
        -ms-transform: scale(0);
        transform: scale(0);
} 
```

`input.ao-toggle:checked +img`设置第一张图片的属性。

所以问题是，在这种情况下我该如何选择第二张图片？因为我想通过单击使一个图像消失，另一个图像而不是第一个出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:44:52.753

`foo + img + img`将是 foo 之后的图像之后的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:48:57.170

更通用的方法可能是使用`nth-of-type`伪类

```
.ao-toggle:checked + img:nth-of-type(1) {
     //style for the 1st element here
}
.ao-toggle:checked + img:nth-of-type(2) {
     //style for the 2nd element here
} 
```

# c# - c# 命名约定

> ID：15026690
> 
> 赞同：1
> 
> 时间：2013-02-22T14:43:08.227
> 
> 标签：c#, naming-conventions

我开始了一个新项目，但在尝试实施一些命名约定时遇到了一些问题。

我曾经使用以大写和单数开头的类，例如 Car 或 User，而我的变量以小写开头，所以如果我需要声明一个具有一些 Car 和 User 类型变量的类，我会这样做：

```
public Car car;
private User user; 
```

现在我尝试使用一些属性，正如我所见，它们也应该是 PascalCase ，这意味着如果我需要声明相同的示例，我将是：

```
public Car Car { get; set; }
private User User { get; set; } 
```

你们都可以看到这里的问题是什么，或者你不认为这是一个问题？

所以我该怎么做？我在这里想念什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-22T14:55:57.040

C# 命名约定建议所有公共以及类、接口等都以大写字母开头。其余的应该以小写字母开头。

没有问题：

```
private User User { get; set; } 
```

...因为每个名称（单词）的位置定义了什么是什么。英语的工作方式相同。例如：“我爱爱。” （代词、动词、名词）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T15:32:42.900

您遇到的问题称为`Color Color`问题，因为它出现的最常见方式是“我需要一个称为`Color`类型的属性`Color`”。C# 专门设计用于`Color Color`优雅地管理情况。

有关详细信息，请阅读 C# 4 规范中的第 7.6.4.1 节“相同的简单名称和类型名称”。

情况的规则`Color Color`有点复杂（相信我，它们不会让编译器实现者的生活变得更轻松！）并且它们可能会导致一些有趣的极端情况。如果您对这个主题感兴趣，那么您应该阅读我的文章：

[http://blogs.msdn.com/b/ericlippert/archive/2009/07/06/color-color.aspx](http://blogs.msdn.com/b/ericlippert/archive/2009/07/06/color-color.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T14:47:25.887

我认为在许多情况下，上下文意味着您将有一个特定的名称 - 例如 Car customersCar 等。话虽如此，很多人对名称/类型相同没有问题 - 请参阅此链接： [属性是否应该有与其类型同名？](https://stackoverflow.com/questions/1095644/giving-a-property-the-same-name-as-its-class)

对于一般的命名约定，遵循 MS 并不是一个糟糕的开始 - [http://msdn.microsoft.com/en-gb/library/vstudio/ms229045(v=vs.100).aspx](http://msdn.microsoft.com/en-gb/library/vstudio/ms229045(v=vs.100).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T15:05:11.453

除了@Evelie 指出的内部类问题之外，将属性命名为与类型相同的属性应该没有任何问题——事实上，这并不是一种不常见的做法。.NET 到处都有`public Color Color`属性。

如以下程序所示，编译器可以区分实例调用和静态调用：

```
void Main()
{
    Car c = new Car();
    c.Test();
}

public class Car
{

    public Car()
    {
        User = new User();
    }

    public void Test()
    {
        User.Static();  // calls static method
        User.Instance();   // implies this.User
    }

    public User User { get; set; }
}
// Define other methods and classes here
public class User
{
   public static void Static()
    {
        Console.WriteLine("Static");
    }

    public void Instance()
    {
        Console.WriteLine("Instance");
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T14:46:39.037

那里没有问题。

因为在您将使用该类的上下文中，它不能被误认为是属性，反之亦然。

编辑：好的，我假设您在 carclass 中有 Userclass，如下所示：

```
public class Car
{
    private class User
    {

    }

    private User User
    {
        get;
        set;
    }
} 
```

这确实会产生问题。移出您的用户，问题就解决了。

```
public class Car
{

    private User User
    {
        get;
        set;
    }
}

public class User
{

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-22T14:52:11.120

这里没有问题；正如@NDJ 建议的那样，如果您感觉不舒服，可以应用上下文为属性添加额外的前缀；但这通常不会为上下文增加额外的含义。

作为一般的 Microsoft 样式指南，鼓励对属性使用 Pascal Case。

有关大写的更完整指南，请参阅以下[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms229043.aspx)

# php - 列出子文件夹问题的文件

> ID：15026692
> 
> 赞同：1
> 
> 时间：2013-02-22T14:43:16.803
> 
> 标签：php, mysql

我在一个文件夹中有数百万个文件，该文件夹中有几个子文件夹，每个子文件夹包含数千个文件。我可以使用 glob 函数列出给定文件夹的所有文件，但在这种情况下，由于它非常高，我收到了 php 致命错误。允许的内存大小用尽尝试分配更多内存我知道这可以通过在该子文件夹中保留一个 php.ini 文件来完成，但我真正想要的是列出所有。

```
 <?php
      foreach (glob("files/*") as $filename) {
       echo "uploads/" . "$filename" .  "\n</br>";
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:49:13.337

使用[opendir](http://php.net/manual/en/function.opendir.php)代替 glob()；

尝试这样的事情：

```
function printdirs($path) { 
if ($handle = opendir($path)) {
    while (false !== ($entry = readdir($handle))) {
        if ($entry != "." && $entry != "..") {
            if(is_dir($path.'/'.$entry))
                printdirs($path.'/'.$entry);
            else
            echo $path . "/" . $entry .  "\n</br>";
        }
    }
    closedir($handle);
}}

printdirs('uploads'); 
```

# django - 无法导入名称 format_html_join

> ID：15026694
> 
> 赞同：1
> 
> 时间：2013-02-22T14:43:33.520
> 
> 标签：django, django-admin

[此处](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.readonly_fields)的 Django 示例显示了以下导入的使用

```
from django.utils.html import format_html_join 
```

但是，无法解决此导入问题。

它改名了吗？还是搬家了？我现在在哪里可以找到它？

PS我正在使用Django 1.4.5（当前稳定版本）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:51:22.653

只出现在 Django 文档 1.5 中，你有什么版本的 Django？

```
>>> import django
>>> print django.VERSION 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T14:52:55.827

您正在查看 django 开发版本的文档。很可能您的机器上没有安装开发版本（当前稳定版本是 django 1.4.5，不包含该功能）。

这是1.4 版文档的[链接。](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.readonly_fields)

# python - 循环二值图像像素

> ID：15026696
> 
> 赞同：1
> 
> 时间：2013-02-22T14:43:41.443
> 
> 标签：python, numpy, python-imaging-library

我有这张图片，里面有两个人。它是二进制图像，仅包含黑白像素。

首先，我想遍历所有像素并在图像中找到白色像素。

比我想做的是，我想为某个白色像素找到 [x,y] 。

之后我想在图像中使用那个特定的[x，y]，它是图像中的白色像素。

使用 [x,y] 的坐标，我想将相邻的黑色像素转换为白色像素。不是完整的图像。

我想在这里张贴图片，但不幸的是我不能张贴。我希望我的问题现在可以理解了。在下图中，您可以看到边缘。

例如，我发现鼻子的边缘使用 [x,y] 循环，然后将所有相邻的黑色像素变成白色像素。

[这是二进制图像](http://img12.imageshack.us/img12/8206/helloq.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T17:20:40.933

所描述的操作称为膨胀，来自数学形态学。例如，您可以使用，也可以`scipy.ndimage.binary_dilation`实现自己的。

这是执行此操作的两种形式（一种是简单的实现），您可以检查生成的图像是否相同：

```
import sys
import numpy
from PIL import Image
from scipy import ndimage

img = Image.open(sys.argv[1]).convert('L') # Input is supposed to the binary.
width, height = img.size
img = img.point(lambda x: 255 if x > 40 else 0) # "Ignore" the JPEG artifacts.

# Dilation
im = numpy.array(img)
im = ndimage.binary_dilation(im, structure=((0, 1, 0), (1, 1, 1), (0, 1, 0)))
im = im.view(numpy.uint8) * 255
Image.fromarray(im).save(sys.argv[2])

# "Other operation"
im = numpy.array(img)
white_pixels = numpy.dstack(numpy.nonzero(im != 0))[0]
for y, x in white_pixels:
    for dy, dx in ((-1,0),(0,-1),(0,1),(1,0)):
        py, px = dy + y, dx + x
        if py >= 0 and px >= 0 and py < height and px < width:
            im[py, px] = 255
Image.fromarray(im).save(sys.argv[3]) 
```

# python - 对于不规则的分隔符，如何使 pandas read_csv 中的分隔符更加灵活 wrt 空格？

> ID：15026698
> 
> 赞同：97
> 
> 时间：2013-02-22T14:43:51.307
> 
> 标签：python, csv, pandas, dataframe, whitespace

`read_csv`我需要通过使用方法从文件中读取数据来创建数据框。但是，分隔符不是很规则：一些列由制表符 ( `\t`) 分隔，其他列由空格分隔。此外，某些列可以由 2 个或 3 个或更多空格分隔，甚至可以由空格和制表符的组合分隔（例如 3 个空格、两个制表符，然后是 1 个空格）。

有没有办法告诉熊猫正确处理这些文件？

顺便说一句，如果我使用 Python，我没有这个问题。我用：

```
for line in file(file_name):
   fld = line.split() 
```

它工作完美。它不关心字段之间是否有 2 个或 3 个空格。即使是空格和制表符的组合也不会造成任何问题。熊猫也可以吗？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2013-02-22T14:51:51.297

从[文档](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html)中，您可以使用正则表达式或`delim_whitespace`：

```
>>> import pandas as pd
>>> for line in open("whitespace.csv"):
...     print repr(line)
...     
'a\t  b\tc 1 2\n'
'd\t  e\tf 3 4\n'
>>> pd.read_csv("whitespace.csv", header=None, delimiter=r"\s+")
   0  1  2  3  4
0  a  b  c  1  2
1  d  e  f  3  4
>>> pd.read_csv("whitespace.csv", header=None, delim_whitespace=True)
   0  1  2  3  4
0  a  b  c  1  2
1  d  e  f  3  4 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-12-25T11:32:28.703

```
>>> pd.read_csv("whitespace.csv", header = None, sep = "\s+|\t+|\s+\t+|\t+\s+") 
```

将使用任意数量的空格和制表符的任意组合作为分隔符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-11-04T14:37:08.157

Pandas 有两个 csv 阅读器，仅在冗余前导空白方面灵活：

```
pd.read_csv("whitespace.csv", skipinitialspace=True) 
```

而一个不是

```
pd.DataFrame.from_csv("whitespace.csv") 
```

对于尾随空格，开箱即用也不是灵活的，请参阅正则表达式的答案。避免使用 delim_whitespace，因为它也只允许空格（不带 或 \t）作为分隔符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-27T04:26:58.690

我们可以认为这是处理所有组合以及零次或多次出现的情况。

```
pd.read_csv("whitespace.csv", header = None, sep = "[ \t]*,[ \t]*") 
```

# android - 如何在没有 id 的动态添加的 EditText 上设置错误？

> ID：15026705
> 
> 赞同：1
> 
> 时间：2013-02-22T14:44:26.027
> 
> 标签：android, validation, android-edittext

我有一个动态添加的 EditTexts 到我的布局中。他们没有身份证。此 EditTexts 都是必需的，不能留空。我有这个验证功能：

```
private boolean validate() {
    boolean valid = true;
    for (int i = 0; i < layout.getChildCount(); i++) {
        if (layout.getChildAt(i).getTag() != null && layout.getChildAt(i).getTag().toString().contains("required")) {
            String viewClass = layout.getChildAt(i).getClass().getName(); 
            if (viewClass.contains("EditText")) {
                EditText et = (EditText) layout.getChildAt(i);
                if (et.getText().toString().trim().isEmpty()) {
                    Log.d("#########", "EDIT TEXT ERROR");
                    et.setError("This field is required.", getResources().getDrawable(R.drawable.indicator_input_error));
                    valid = false;
                }
            }
        }
    }
} 
```

我的布局在哪里`layout`包含 EditTexts。它给了我日志，但没有显示错误。如果我`setError`用

```
et.setText("#########"); 
```

文本已正确更改。为什么不显示错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T07:01:34.713

这是另一个错误。问题中的代码工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-24T06:03:46.367

```
 private boolean validate() {
        boolean valid = false;
        System.out.println("getChildCount:"+ll.getChildCount());
        Log.d(TAG,"*****************1******************");
        for (int i = 0; i < ll.getChildCount(); i++) {
            if (ll.getChildAt(i).getTag() != null && ll.getChildAt(i).getTag().toString().contains("required")) {
                Log.d(TAG,"*****************2******************");
                String viewClass = ll.getChildAt(i).getClass().getName();
                if (viewClass.contains("EditText")) {
                    Log.d(TAG,"*****************3******************");
                    EditText et = (EditText) ll.getChildAt(i);
                    if (et.getText().toString().trim().isEmpty()) {
                        Log.d(TAG,"*****************4******************");
                        Log.d("#########", "EDIT TEXT ERROR");
                        Utils.showAlertDialog(activity, "Error", "The fields are required",getResources().getDrawable(R.mipmap.ic_error), new DialogInterface.OnClickListener() {
                            @Override`enter code here`
                            public void onClick(DialogInterface dialog, int which) {
                                dialog.dismiss();
                            }
                        });
                        valid = true;
                    }else{
                        Log.d(TAG,"**********else*******1******************");
                        valid = false;
                    }
                }else{
                    Log.d(TAG,"********else*********2******************");
                    valid = false;
                }
            }else{
                Log.d(TAG,"*********else********3******************");
                valid = false;
            }
        }
        return valid;
    } 
```

并尝试打电话

```
 if(validate()) {
                    Log.d(TAG,"********validate()*********1******************");
                    SaveRecords();
                }else{
                    Log.d(TAG,"**********else*******1******************");
                    Utils.showAlertDialog(activity, "Error", "The fields are required",getResources().getDrawable(R.mipmap.ic_error), new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            dialog.dismiss();
                        }
                    }); 
```

# linux - 在一个文件中查找单词并获取它们在另一个文件中的行：Bash 脚本

> ID：15026708
> 
> 赞同：0
> 
> 时间：2013-02-22T14:44:37.947
> 
> 标签：linux, bash, file, grep

我试图找出文件中与另一个文件中找到的单词相对应的所有行，然后制作第三个新文件，其中包含这些行。例如：

```
File 1
rs2132k34hh
rs234hk5kk4
rsklhh32432

File 2
Info   more info   otherstuff     rs2132k34hh somethings
Info   more info   otherstuff    rs234hk5kk4  somethings
Info   more info   otherstuff     rsklhh32432 somethings
Info   more info   otherstuff    rs234hk5kk4  somethings 
```

我认为这将是类似的东西

```
 egrep -l "(\s(rs\S+))" /filethatIamsearching.txt > newfile.txt 
```

从文件中grep rs并发送到新文件

但我知道这不是命令中应该包含的所有内容。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:53:46.210

尝试这个：

```
grep -F -f file1 file2 >newfile.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:50:40.843

尝试：

```
grep -wf file1 file2 > file3 
```

您可以使用该选项告诉`grep`从文件中读取模式。`-f`您还可以使用该`-w`选项仅搜索整个单词。

# xpages - 获取搜索（过滤）视图结果的列值

> ID：15026710
> 
> 赞同：0
> 
> 时间：2013-02-22T14:44:41.287
> 
> 标签：xpages, xpages-ssjs

我正在 viewPanel 上进行搜索查询。当结果显示在视图中时，我只想遍历返回的结果并为每一行构建一个名称数组。我的 Xpage 视图的第一列中有 Name 字段。我尝试了以下方法：

```
var viewControl = getComponent("namesPanel");
var view = viewControl.getDataModel().getDominoViewData().getDataObject();
var entries = view.getAllEntries();
var entry = entries.getFirstEntry();

var namesArray = [];
while(entry)
{
    namesArray.push(entry.getColumnValues().elementAt(0));
    entry = entries.getNextEntry();
}

getComponent("DisplayNames").setValue(namesArray); 
```

无论我的搜索查询如何，上面的代码都会返回后端 Notes 视图中的**每个**名称。我意识到有 getAllEntriesByKey()，但我的 Xpages 视图是通过搜索过滤的，而不是通过列值过滤的。

有没有一种方法可以在搜索后仅在视图中显示的结果上构建列值数组？感谢您的任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T15:32:08.203

我想我已经弄清楚了。在这里找到了一些帮助：[http ://www.xsptalk.com/Public/Website/Blog.nsf/dx/04032011122915CCOGNE.htm](http://www.xsptalk.com/Public/Website/Blog.nsf/dx/04032011122915CCOGNE.htm)

```
var temprows = getComponent("namesPanel");
var modelData = temprows.getDataModel();
var namesArray = [];

for(i=0; i < modelData.getRowCount(); i++)
{
    modelData.setRowIndex(i);
    var xspViewEntry=modelData.getRowData();
    var document=xspViewEntry.getDocument();
    namesArray.push(document.getItemValueString("name"));
}

getComponent("DisplayNames").setValue(namesArray); 
```

# python - 如何在windows上用python部署软件

> ID：15026712
> 
> 赞同：0
> 
> 时间：2013-02-22T14:44:43.403
> 
> 标签：python, windows

我已经使用 python 开发了一些简单的项目。在这个项目中，我使用 pygtk 创建了一个简单的 gui。GUI用于控制Arduino板，即控制网络摄像头旋转。

现在我想把这个应用程序作为一个完整的安装软件。即，我想在安装软件的 setup.exe 文件上创建。

一般来说，我想将用 python 开发的应用程序转换为完整的可安装软件。

同样在开发中，如果我使用一些第三方包，如“lxml”或“VedioCapture”，如何在生成可安装软件时处理这些类型的依赖项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:53:47.867

检查 py2exe 以使用您的 python 代码创建可执行文件。

要制作安装程序，请检查 innosetup。

[http://www.jrsoftware.org/isinfo.php](http://www.jrsoftware.org/isinfo.php)

[http://www.py2exe.org/](http://www.py2exe.org/)

# objective-c - 反对localizedStringFromDate: dateStyle: timeStyle:

> ID：15026719
> 
> 赞同：0
> 
> 时间：2013-02-22T14:45:01.037
> 
> 标签：objective-c, localization, nsdate, nsdateformatter

当我通过以下方式格式化日期时：

```
[NSDateFormatter localizedStringFromDate:date dateStyle:NSDateFormatterShortStyle timeStyle:NSDateFormatterNoStyle]]; 
```

将它保存在某个地方，然后尝试访问它，我得到一个 NSString。如何将其作为 NSDate？

顺便说一句：**我想要一种将 NSDateFormatterStyle 作为参数的方法。**否则它将是错误的-在不同的语言环境中它将被保存为不同的字符串，因此将其格式化为

```
[dateFormat setDateFormat:@"yy/MM/dd"]; 
```

或任何其他此类选项 - 将产生错误。或者至少我是这么认为的；）。感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:52:00.123

NSDateFormatter 返回 NSDate 对象的 NSString 表示。NSDate 对格式不敏感，这意味着它不依赖于某些语言环境，它实际上存储为一个数字。您使用 NSDateFormatter 将该数值呈现为本地化表示。

要将 NSString 转换回 NSDate，您可以使用以下内容：

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"yy/MM/dd"];
NSDate *myDate = [df dateFromString: dateString]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-16T19:10:21.530

听起来您想以一种可以完美解析两种方式的方式存储 NSDate 。在这种情况下，我建议将其存储为 ISO8601 日期，并且您需要使用更像自定义的 nsdateformatter 来执行此操作。github 或 stackoverflow 上有很多库/类别可以帮助您。

# context-free-grammar - CFG及其反向

> ID：15026736
> 
> 赞同：2
> 
> 时间：2013-02-22T14:45:52.563
> 
> 标签：context-free-grammar, computation-theory

我正试图把头绕在 CGS 上。让`E^*`'epsilon star'`e`成为空字符串，并`ww^r`在 w 的倒数旁边成为 w。

我知道建立一个 CFG 来接受`E^*`是一个简单的`S -> 0S | 1S | e`.

接受的 CGG`{ww^r} such that w in E^*`是一个简单的`S –&gt; 0S0 | 1S1 | e`.

这是否意味着接受 CFG`{wxw^r} such that w, x in E^*`是这两种结果的一种“组合” `S –&gt; 0S0 | 1S1 | e | B where B –&gt; 0B | 1B | e`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T16:22:12.200

是的，你的语法是正确的！

CFG to `{wxw^r} such that w, x in E^*`is`S –&gt; 0S0 | 1S1 | e | B where B –&gt; 0B | 1B | e`是正确的语法。

但重要的是 Language `{wxw^r} such that w, x in E^*`is [Regular Language](http://en.wikipedia.org/wiki/Regular_language)所以也可以写[**Left-Linear 和 Right-Linear Grammars**](https://stackoverflow.com/questions/13816439/left-linear-and-right-linear-grammars?answertab=oldest#tab-top)。

该语言的**Right-Liner 等效语法**是：

```
S --> 0B | 1A | ^
B --> 0B | 1B | 0
A --> 0A | 1A | 1 
```

和**左衬里**等效是：

```
S --> B0 | A1 | ^
B --> B0 | B1 | 0
A --> A0 | A1 | 1 
```

它的正则表达式是：

> 0(0 + 1)*0 + 1(0 + 1)*1 + ^

[我在对 DFA 的回答中描述了](https://stackoverflow.com/questions/14521300/why-l-wxwr-w-x-belongs-to-a-b-is-a-regular-language/14534863#14534863)一种类似的语言。

*注意：*语言结构相同但符号不同，也`^`不可能有空字符串。还有`+`在`( 0 + 1)`这里是`*`

它的 DFA

![DFA](../Images/9e3c0b00772ff7634b343d47e645bcf0.png)

此外，我还鼓励您查看`0(1 + 0)*0 + 1(1 + 0)*1`. 请注意 RE 的微小变化，`^`但 DFA 完全不同。

# jquery - 如何更改选择时列表项的背景图像？

> ID：15026737
> 
> 赞同：2
> 
> 时间：2013-02-22T14:46:05.293
> 
> 标签：jquery, jquery-selectors, onchange

所以我有一个 3 步列表项。

项目 1 项目 2 项目 3

我需要在每个选择上出现一个背景图像（一个箭头）。如果用户点击第 2 项，箭头将从第 1 项中消失并出现在第 2 项等中。

我试过这样的东西，但不确定......

```
 <script>
                $(".theSteps li").change(function () {
                $(".theSteps li:selected").each(function () {
                $('.theSteps li').css('background-image','url()');
                });
                $('.theSteps li').css('background-image','none');
                })
                .trigger('change');

            </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:49:49.567

您还没有提供 HTML，因此很难创建您需要的完整 JavaScript。如果你能把它加进去，我可以给你更多的细节。

最简单的方法是创建一个**CSS 类**，用于将背景图像设置为您要使用的图像的背景图像。

如果您在选择列表项时运行函数，则可以运行 jQuery 函数[`addClass`](http://api.jquery.com/addClass/)来添加新类以指定该选定项的背景图像 - 类似于：

```
$('#mylistitem').addClass('BackgroundImageClassName'); 
```

在此行之前，您可以使用以下命令从任何现有项目中删除该类：

```
$('li.BackgroundImageClassName').removeClass('BackgroundImageClassName'); 
```

假设您的 html 看起来像：

```
<ul class="theSteps">
  <li>first item</li>
  <li>second item</li>
</ul> 
```

您可以使用这样的代码：

```
$('ul.theSteps li').click(function() { 
  $('li.newBackgroundImageClass').removeClass('newBackgroundImageClass');
  $(this).addClass('newBackgroundImageClass');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:21:12.460

好的，我在这里为您提供了一个可行的解决方案。您需要做的就是将发光类修改为背景图像（并整理定位等）

[http://jsfiddle.net/jezzpin/5J698/](http://jsfiddle.net/jezzipin/5J698/)

正如上面的一些人在评论中所说的那样，最好的方法是使用一个仅在您刚刚单击的元素上有效的 CSS 类。在我的示例中，我将此类称为发光 ->

```
 .glow{
 background-color: #FF0000;   
 } 
```

它所要做的就是将元素的背景颜色更改为红色。

现在对于 jQuery 函数（可能与小提琴不同，因为它会自动调用 document.ready()）->

```
 jQuery(document).ready(function () {
          $('.theSteps').click(function() {
          $('.theSteps').removeClass('glow');
          $(this).addClass('glow');             
   });

   }); 
```

此函数从所有具有类 .theSteps 的元素中删除发光类，然后将其应用于刚刚单击的任何元素，我们可以使用 $(this) 引用该元素。

# asp.net - ASP.NET 使用 LinkBut ton 在代码中调用函数

> ID：15026738
> 
> 赞同：0
> 
> 时间：2013-02-22T14:46:07.400
> 
> 标签：asp.net, linkbutton, onclientclick

我这里有这个链接按钮

```
<asp:LinkButton runat="server" ID="EditBtn" CssClass="LinkButton" Text="Edit" Width="45px" OnClientClick="Profiles_Edit" CommandName="edit" /> 
```

我试图在我后面的代码中调用这个函数

```
protected void Profiles_Edit(Object sender, ListViewCommandEventArgs e)
    {
        //do something
    } 
```

但是当我点击按钮时......没有任何反应。我的 LinkBut​​ton 在 ItemTemplate 内，在 ListView 内，在 ContentTemplate 内，在 UpdatePanel 内......

我称呼它的方式有什么问题？

谢谢，J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:48:37.337

`OnClientClick`用于指定客户端浏览器上 JavaScript 函数的名称。

要调用服务器端事件，请使用`OnClick`.

此外，在这种情况下，您可能不需要该`CommandName`属性。目前尚不清楚它在哪里`LinkButton`。如果它在像 a 这样的容器中`ListView`，你会以不同的方式处理它。

# c++ - 在 C++ 中搜索树中节点的最快方法

> ID：15026742
> 
> 赞同：0
> 
> 时间：2013-02-22T14:46:22.860
> 
> 标签：c++, tree, traversal

```
#ifndef __TREE_H
#define __TREE_H
#include <cstdlib>
#include<string>

// structure of a tree node

struct TreeNode{
        string str;
        TreeNode *parent;
        TreeNode *leftChild;
        TreeNode *nextSibling;

        TreeNode(string str1){
                this->str = str1;
                this->parent = NULL;
                this->leftChild = NULL;
                this->nextSibling = NULL;
        }

};

class Tree{

        TreeNode* root;
        int size;

public:

        Tree();         //constructor

        void insert(string str1);       //insert a node

        string locate(string str1);     //locate a node

        TreeNode *ancestor(string str1, string str2);   //get lowest common ancestor
};

#endif 
```

这是一类通用树（不是二叉树）。实现定位功能的最快方法是什么？我应该先检查所有孩子，然后检查兄弟姐妹还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:49:06.733

如果树是无序的，则除了对所有节点进行蛮力测试并在找到元素时（如果找到）突破之外没有其他算法。在处理树时，递归通常是最简单的方法。伪算法可能类似于：

```
find(current_node,value):

if current_node.value == value
   return found
else 
   if find(current_node.left,value) == found
      return found
   else if find(current_node.right,value) == found
      return found
   else
      return not_found 
```

当然，当真正实现这一点时，您将需要测试空指针，等等。如果对树没有任何其他约束，则不能降低渐近复杂度。您可能会采用非递归方法或尾递归算法（基于上述），这可能会改善常数因子，但不要指望那里会有巨大的改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:57:50.483

如果节点是有序的，即子节点小于该节点而兄弟节点大于该节点，则进行比较，`str`并根据结果将该节点作为结果，或者向下搜索子节点或与兄弟节点进行比较

```
const TreeNode *TreeNode::locate(const string &str1) const
{
    int c = str.compare(str1);
    if (c == 0)
        return this;

    if (c > 0) {
        if (leftChild)
            return leftChild->locate(str1);

        return 0;
    }

    if (nextSibling)
        return nextSibling->locate(str1);

    return 0;
} 
```

在树中

```
const TreeNode *Tree::locate(const string &str1) const
{
    return root->locate(str1);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-23T14:59:33.623

您可以尝试几种树遍历算法，具体取决于您的信息在树节点之间的分布方式。

BFS、DFS 就是一些例子。

# php - 使用 PHP 删除所有非 HTML/JavaScript 等

> ID：15026746
> 
> 赞同：0
> 
> 时间：2013-02-22T14:46:27.743
> 
> 标签：php, regex

是否可以从没有正则表达式的变量中删除所有无效的 HTML 标记（包括注释） - 任何隐藏函数，如 strip_tags 但相反？

```
$var = "<html>" .
"<head>" .
"<script src="something"></script>" .
"<script>document.write('Hello');</script>" .
"<p>Some text</p>" .
"<!-- Comment -->" .
"Random text not in any markup." .
"</html>"; 
```

我希望 $var 在处理后包含：

```
<html>
<head>
<script src="something"></script>
<script>document.write('Hello');</script>
<p>Some text</p>
</html> 
```

# css - 可以像使用 JavaScript 的 SVG 一样编辑内部 CSS 模型还是不可编辑？

> ID：15026750
> 
> 赞同：0
> 
> 时间：2013-02-22T14:46:45.757
> 
> 标签：css, svg

我正在尝试重写我的应用程序以进行 SVG 处理，ATM 应该知道我是否应该将未触及的 CSS 模型保留在内存中（因为有可能对其进行更新）并在调用 SVG 元素时获取样式，或者如果它是不可编辑的，将其解压缩到 SVG 中。

虽然从我之前的经验来看，保持原样的 CSS 并且不从一开始就解压它似乎更合理（不要做你没有被告知要做的事情），但做出这样的设计可能更难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:26:20.233

在[这个页面](http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/css.html)上说：

> DOM 中的所有 CSS 对象都是“实时的”，也就是说，样式表中的更改会反映在计算样式和实际样式中。

这句话只是暗示 CSS 可以编辑，但从[2.2 节](http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/css.html#CSS-fundamental-h2)的 IDL可以明显看出，虽然规则中的值不能更改，但规则本身可以添加或删除。因此，考虑到 CSS 的特性，即覆盖规则的能力，可以编辑内部 CSS 模型（表示 RAM 中的 CSS 文件的模型）。

# c# - 让我的 Asp.Net 应用程序支持所有浏览器

> ID：15026751
> 
> 赞同：-6
> 
> 时间：2013-02-22T14:46:48.323
> 
> 标签：c#, jquery, asp.net, css, performance

我有一个 asp.net 应用程序，它最初是为仅支持 IE（Internet Explorer）而设计的。现在我想转换支持所有最新浏览器的应用程序，基本上它是由 Asp.net、CSS 和 Javascript（特定于 IE）开发的。有什么简单的方法可以转换，因为如果我只有 1 周的时间提交失败了，那么我需要报告它是否可能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T14:51:37.623

这是一个快速的答案——它可能需要你超过一周的时间:)

最好的办法是在不同的浏览器中查看您的网站，看看有什么问题。您的问题有点含糊，但您可能正在考虑解决 UI 问题和可能的 JavaScript 问题。

你支持哪个版本的IE？您需要考虑到这一点，因为开发跨浏览器支持意味着不仅要解决现代浏览器的问题，还要确保旧浏览器不会损坏。

这是一个非常开放的问题，我最好的建议就是上面的。没有办法将应用程序神奇地转换为跨浏览器兼容。不幸的是，这将是一项手工工作。

最重要的是，您需要衡量其他浏览器的糟糕程度，然后才能制定解决方案。

# netbeans - Netbeans 从文本文件调用 SQL 命令

> ID：15026763
> 
> 赞同：0
> 
> 时间：2013-02-22T14:47:48.570
> 
> 标签：netbeans, javadb

我想让 Netbeans 查看一个文本文件，我在该文件中编写了要执行的大量 SQL 命令。我确信它可以完成，但搜索并找不到如何。

我正在使用 Netbeans 7.3 Beta 2、OS X ML、Java DB 并用 Java 编写。

# mysql - 如何从 1 个表中的选择更新？

> ID：15026765
> 
> 赞同：0
> 
> 时间：2013-02-22T14:47:50.190
> 
> 标签：mysql

我有一个新闻表，其中每条记录都有字段：

```
news_id (INT), parent_id (INT) , subitems (INT) 
```

我希望每条记录都带有它的直接子项的总数（计数）

例如（我希望结果是这样的）

```
news_id: 1, parent_id: 0, subitems: 2

news_id: 2, parent_id: 1 , subitems: 0

news_id: 3, parent_id: 1 , subitems: 0 
```

我该如何正确地做这样的事情：

```
UPDATE news n 
SET subitems = (SELECT COUNT(*) FROM `news` AS `n2` 
WHERE `n2`.`parent_id` = `n`.`news_id`) 
```

由于上面给出了以下错误：

```
#1093 - You can't specify target table 'n' for update in FROM clause 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:05:32.483

这就是我解决它的方法：

**注意：这对于性能来说是丑陋的，可以只做一次，但不能用于正在进行的操作**

```
UPDATE news n 
SET subitems = (SELECT COUNT(*) 
FROM (SELECT parent_id FROM `news` AS `n2` 
WHERE `n2`.`parent_id` <> '0') AS n3 WHERE n3.parent_id = n.news_id)
WHERE n.parent_id = '0' 
```

# jquery - 如何在 Fancybox 内容上操作 DOM？

> ID：15026768
> 
> 赞同：1
> 
> 时间：2013-02-22T14:48:00.457
> 
> 标签：jquery, fancybox

我正在尝试访问使用 Fancybox 加载的 DOM 内容中的元素，但这是不可能的。

这是我的代码示例：

```
<div id="content"><!-- content of my FancyBox !-->
   blabla 
  <div class="myelement">blabla hiding</div>
</div>
<script type="text/javascript">
$.fancybox({
content : $('#content').html(),
afterLoad: function(){
  //do something with the element
  $('.myelement').hide();

}
);
</script> 
```

我的幻想框的内容没有发生任何事情（元素没有隐藏）。

谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T10:58:59.470

我修复了错误！

如果我想操作 FancyBox 动态添加的 DOM 内容，我必须使用回调 "afterShow" ：

```
 <script type="text/javascript">
$.fancybox({
content : $('#content').html(),
afterShow: function(){ //<====== FIX THE BUG !!!!!!!!!!!!!!!!!!!!!
  //do something with the element
  $('.myelement').hide();

}
);
</script> 
```

# android - Android 资产文件未显示。获取文件未找到错误

> ID：15026770
> 
> 赞同：1
> 
> 时间：2013-02-22T14:48:09.270
> 
> 标签：android

我在我的资产文件夹中包含了一些 html 文件，但是当我尝试在 web 视图中显示它们时，我收到了一个找不到文件的错误。我也无法在 fileexplorer 的 //data/data/files 文件夹中看到该文件。不知道是什么问题。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:56:22.363

我展示了一个帮助文件，该文件是由我放在资产文件夹中的静态 html 文件驱动的。这是我的代码：

```
BufferedReader in = null; 
StringBuilder buffer = new StringBuilder();

String assetFile = "help.html";

try { 

    in = new BufferedReader(new InputStreamReader(getAssets().open( assetFile ),"utf-8")); 
    String line; 

    /* line by line read in the file */
    while ((line = in.readLine()) != null) buffer.append(line); 

} catch (IOException e) { 
} finally { 
    try { in.close(); } catch (Exception e) {} 
} 

WebView wv = (WebView) findViewById(R.id.help_view);
wv.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
wv.loadDataWithBaseURL(null, buffer.toString(), "text/html", "utf-8",null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:54:33.777

到目前为止，我不知道您尝试了什么，但这是在运行时从 assets 文件夹中获取文件的一种正确方法：

```
InputStream is = getAssets().open("YourHTML.html"); 
```

# java - 如何对我的 Arraylist 进行排序？

> ID：15026771
> 
> 赞同：0
> 
> 时间：2013-02-22T14:48:14.217
> 
> 标签：java, sorting, arraylist

我有这个用户类

```
public class User {

public String userName;
public int highScore = 0;

public static ArrayList<User> userList = new ArrayList<User>(5);

public User(String name, int score) {
    this.userName = name;
    this.highScore = score;
    userList.add(this);

    Collections.sort(userList, new Comparator<User>() {
        @Override
        public int compare(User lhs, User rhs) {
            return lhs.highScore-rhs.highScore;
        }

    });

} 
```

}

用户对象具有属性名称和分数。我想根据用户的分数对我的列表进行排序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:58:20.297

```
 java.util.Collections.sort(userList, new Comparator<User>(){
        @Override
        public int compare(User lhs, User rhs) {
            return lhs.getScore() - rhs.getScore();
        }

    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:58:19.670

创建一个实现 Comparator 的对象：

[http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)

这实质上实现了两个对象之间的比较。由此，您可以使用自动排序方法。

```
public class UserComparator implements Comparator {
    public boolean compare(Object object1, Object object2) {
        return ... \\ result of comparison
    }
}
public static ArrayList<User> userList = new ArrayList<User>(5);

Collections.sort(usersList, new UserComparator()); 
```

返回值是一个 int。

```
0 if object1 equals object2
a negative int if object1 < object2
a positive int if object1 > object2 
```

# installation - 在 CMake 中，安装目标后如何运行脚本？

> ID：15026772
> 
> 赞同：5
> 
> 时间：2013-02-22T14:48:15.463
> 
> 标签：installation, cmake

我正在尝试在 CMake 安装完成后运行脚本。我[在 SO 上找到了这个线程](https://stackoverflow.com/questions/9998679/is-it-possible-to-add-post-install-commands-to-top-level-makefile-generated-by-c)，但它仍然不起作用，因为我的脚本取决于安装的目标。

基本上我的脚本在安装目标之前运行。这是因为 CMake 似乎将安装子目录目标的代码放在`cmake_install.cmake`

这是一个说明问题的示例；子目录 CMake 文件：

```
# src/CMakeLists.txt
add_executable(foo main.cpp)
install(TARGETS foo DESTINATION bin) 
```

顶级 CMake 文件：

```
# Top-level CMakeLists.txt
cmake_minimum_required(VERSION 2.8)
add_subdirectory(src)
install(CODE "execute_process(COMMAND ls ${CMAKE_INSTALL_PREFIX}/bin/foo)") 
```

运行`make install`产量：

```
-- Install configuration: "debug"
ls: cannot access /tmp/dummy/bin/foo: No such file or directory
-- Installing: /tmp/dummy/bin/foo 
```

知道如何解决这种行为吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T15:35:04.447

如果您发现 cmake 将子目录安装目标放在 cmake_install 的末尾，您可以添加另一个带有 cmake 的子目录，其中包含您需要在所有其他目标之后完成的操作。

# javascript - 在事件侦听器中为回调传递参数

> ID：15026776
> 
> 赞同：0
> 
> 时间：2013-02-22T14:48:31.327
> 
> 标签：javascript, arguments, addeventlistener

当我尝试在 addEventListener 中传递参数时，它的行为异常

```
var animateFunction = function (i) {
if (animBool) {
    Fn.slideData(values(i)); // To fetch some data
    util.animate.tweenAnimate(sliderWrapper, 0 , Math.ceil("-"+sliderWidth));
    animBool = 0;
} else {
    util.animate.tweenAnimate(sliderWrapper, Math.ceil("-"+sliderWidth) ,0);
    animBool = 1;
}
}; 

for (i = 0; i < annotateArray.length; i++) {
//To Remember the state of value "i"
(function (i) {
    //Custom Event Listener for fallback for IE
    util.addEvent(annotateArray[i], "click", animateFunction(i), true);
}(i));
}

 for (i = 0; i < annotateArray.length; i++) {

    //Custom Remove Event Listener for fallback for IE
    util.removeEvent(annotateArray[i], "click", animateFunction);

}

//Custom Bind Event Method
util.addEvent = function (obj, evt, callback, capture) {
    if (window.attachEvent) {
        obj.attachEvent("on" + evt, callback);
    } else {
        if (!capture) {
            capture = false;
        }
        obj.addEventListener(evt, callback, capture);
    }
}; 
```

我正在尝试将事件动态绑定到所有元素，但是当我单击该元素时，该函数的行为不符合预期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:58:43.887

您实际上是`undefined`作为事件处理程序传递的，而不是实际的回调。这里：

```
util.addEvent(annotateArray[i], "click", animateFunction(i), true); 
```

您正在调用该函数，该函数返回`undefined`. 您必须将函数引用传递给`addEventListener`. 你已经在你的循环中有一些“记住价值'i'的状态”，但你没有正确使用它。它应该是：

```
for (i = 0; i < annotateArray.length; i++) {
    //To Remember the state of value "i"
    (function (i) {
        // Custom Event Listener for fallback for IE
        util.addEvent(annotateArray[i], "click", function() {animateFunction(i)}, true);
    }(i));
} 
```

# javascript - 代码开头的分号仍然是好习惯吗？

> ID：15026777
> 
> 赞同：8
> 
> 时间：2013-02-22T14:48:31.697
> 
> 标签：javascript, minify

我被告知在 JavaScript 代码的开头始终插入分号是一个很好的做法，如下所示：

```
;(function(){

})(); 
```

然而，许多流行的 JavaScript 库/框架并不使用这个，例如 jQuery、Backbone 等。

我相信开头的分号应该防止坏代码破坏缩小/压缩的代码等。但是，为什么没有人再使用它了？

开头的分号是否由于某种原因变得无用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T14:56:28.247

更常见的做法是在文件末尾添加分号。问题是，当您像这样连接两个文件时：

```
// file1.js
(function() {
})()

// file2.js
(function() {
})() 
```

如果不在末尾添加分号`file1`，它将尝试使用函数 in 调用函数 in 的返回`file1`值`file2`。在每个文件的末尾放置一个分号将解决这个问题（就像将它们放在开头一样）。

另一种方法是将函数调用变成这样的语句：

```
!function() {
}(); 
```

我认为这也是 JSLint 推荐的，因为在这种情况下，您不必担心分号（尽管无论如何您都应该使用它们，但那是完全不同的讨论；）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T15:21:59.133

理想情况下，缩小和合并多个文件应该不会影响您的编码风格。您应该能够根据需要编写程序，然后使用自动化工具正确合并和缩小您的项目。

有很多自动化工具可以做到这一点。以[UglifyJS 2](https://npmjs.org/package/uglify-js2)为例。如果您环顾四周，我相信您将能够找到更多这样的工具。

回到这个问题，正如 Daff 所指出的，在立即调用的函数表达式之后插入分号很重要。但是，没有理由在它前面加上分号。如果你是一个好孩子，并且在每个语句和表达式之后加上一个分号，那么你就不应该有任何问题。

**不要让 JavaScript 为您自动插入分号。**

唯一可以不放分号的地方是在函数声明之后：

```
function foo() {} // it's alright to not put a semicolon here 
```

但是，如果您使用的是函数表达式，那么请始终使用分号。

```
(function foo() {})(); // you should put a semicolon here 
```

将分号放在其他任何地方只会令人困惑。尤其是在一行的开头。其他编程背景的人也可能认为这是行尾注释的开始。

# mongodb - 使用 python 从 mongoDB 获取特定范围的结果

> ID：15026781
> 
> 赞同：0
> 
> 时间：2013-02-22T14:48:39.093
> 
> 标签：mongodb, pymongo

我正在使用 mongoDB 和 python 创建一个实验博客网站。例如，我有 100 篇博文，我想分成 5 个部分。如何编写查询以检索前 20 篇博文，然后是后 20 篇博文（从 21 篇到 40 篇……） 显而易见的方法是将所有帖子检索到内存中并使用例如：

```
firstposts = posts[0, 20] 
```

但我想知道我是否可以直接检索 20 首帖子而不是

```
db.posts.find() 
```

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:51:33.460

在此处查看*skip(...)*和*limit(...)*方法：http: [//api.mongodb.org/python/current/api/pymongo/cursor.html](http://api.mongodb.org/python/current/api/pymongo/cursor.html)。

```
db.posts.find().skip(0).limit(20);
…
db.posts.find().skip(20).limit(20);
… 
```

# sql-server - SQL Server：从文本转换为 varchar，然后写入文本文件

> ID：15026784
> 
> 赞同：1
> 
> 时间：2013-02-22T14:48:56.323
> 
> 标签：sql-server, sql-server-2008, varchar

我在将`Text`数据类型转换为`varchar`. 我需要转换它，因为它被写入文本文件。问题是只有前 362 个字符`Text`转换为`varchar`：

这有效

```
DECLARE @txt varchar(362) = (SELECT Text FROM Whatever WHERE id = 1) 
```

不工作

```
DECLARE @txt varchar(1000) = (SELECT Text FROM Whatever WHERE id = 1) 
```

整个过程在此语句上失败，`@txt`不会写入文本文件（使用`xp_cmdshell`）

`varchar(MAX)`不工作

谢谢帮助

# java - 如何提示用户再次运行程序？

> ID：15026792
> 
> 赞同：0
> 
> 时间：2013-02-22T14:49:25.913
> 
> 标签：java

经过数小时的研究，我能够想出一个应该有帮助的 while 循环。唯一的问题是它会循环并且不会要求用户再次运行。它只是一遍又一遍地循环高尔夫程序。谁能指出出了什么问题？目前在初级班，所以我可能不太了解。

```
import java.util.Scanner;

class GolfEM
{ 
    public static void main (String[] args) 
    {
        Scanner kb = new Scanner(System.in);    
        boolean go = true;
        boolean run = true;

        while (go==true)
        {
            while (run)
            {
                System.out.println("Enter par for the hole: ");
                int par = kb.nextInt();
                System.out.println("Enter the number of strokes: ");
                int stroke = kb.nextInt();
                {

                    if (stroke==1)  
                    {
                        System.out.println("hole in one");
                        run=false;
                    }
                    else if (3==par-stroke)
                    {
                        System.out.println("double eagle");
                        run=false;
                    }
                    else if (2==par-stroke)
                    {
                        System.out.println("eagle");
                        run=false;
                    }
                    else if (1==par-stroke)
                    {
                        System.out.println("birdie");
                        run=false;
                    }
                    else if (par==stroke)
                    {
                        System.out.println("par");
                        run=false;
                    }
                    else if (-1==par-stroke)
                    {
                        System.out.println("bogey");
                        run=false;
                    }
                    else if (-2==par-stroke)
                    {
                        System.out.println("double-bogey");
                        run=false;
                    }
                    else if (-3==par-stroke)
                    {
                        System.out.println("triple-bogey");
                        run=false;
                    }
                    else if (-4==par-stroke)
                    {
                        System.out.println("four-over-par");
                        run=false;
                    }
                    else if (-5==par-stroke)
                    {
                        System.out.println("five-over-par");
                        run=false;
                    }
                    else if (-6==par-stroke)
                    {
                        System.out.println("six-over-par");
                        run=false;
                    }
                    else if (-7==par-stroke)
                    {
                        System.out.println("seven-over-par");
                        run=false;
                    }
                    else
                    {
                        System.out.println("Better luck next time");
                        run=false;
                    }
                }
            }
            run=false;
        }
        if (run==false)
            System.out.println("Run again? ");

        char again = kb.next().charAt(0);

        if (again == 'y')
        {
            run=true;
        }
        else if (again == 'n')
        {
            System.out.println("Goodbye.");
            go = false;
        }
        else
        {
            System.err.println("Invalid answer");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:47:13.017

您的代码有一些问题。

1.  外部 go 循环非常无用，因此完全删除它
2.  你的 if else 块看起来超级难看。Switch 语句更加简洁
3.  没有真正的意义来设置 run=false 每种情况，只是在最后做
4.  您的回复将以无效字符退出

我更改了下面的代码。看一眼。

```
import java.util.Scanner;
class GolfEM
{ 
    public static void main (String[] args) 
    {
        Scanner kb = new Scanner(System.in);    
        boolean run = true;

        while (run)
        {
            System.out.println("Enter par for the hole: ");
            int par = kb.nextInt();
            System.out.println("Enter the number of strokes: ");
            int stroke = kb.nextInt();                

            if (stroke==1)  {
                System.out.println("hole in one");
                run=false;
            }
            else{
                switch(par-stroke){
                    case 3:
                        System.out.println("double eagle");
                        break;
                    case 2:
                        System.out.println("eagle");
                        break;
                    case 1:
                        System.out.println("birdie");
                        break;

                    case 0:   
                        System.out.println("par");
                        break;
                    case -1:
                        System.out.println("bogey");
                        break;
                    case -2:
                        System.out.println("double-bogey");
                        break;
                    case -3:
                        System.out.println("triple-bogey");
                        break;
                    case -4:
                        System.out.println("four-over-par");
                        break;
                    case -5:
                        System.out.println("five-over-par");
                        break;
                    case -6:
                        System.out.println("six-over-par");
                        break;
                    case -7:
                        System.out.println("seven-over-par");
                        break;
                    default:
                        System.out.println("Better luck next time");

                }

            }                           
            run=false;        

            while(1){
                System.out.println("Run again? ");
                char again = kb.next().charAt(0);
                if (again == 'y')
                {
                run=true;
                break;
                }
                else if (again == 'n')
                {
                System.out.println("Goodbye.");
                break;
                }
                else
                {
                    System.err.println("Invalid answer");
                }
            }
        }
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:38:56.280

如果我能给出一些指示，那么这里不需要两个 while 循环。你真的只需要一个（比如说，外部的，'go' 循环）。

你的逻辑应该是这样的......

```
 boolean go = true;
    while (go) {
         // get input...
         // compute the result for this hole...
         // get user input...
         // decide whether to go again (go = false; or go = true;)
    } 
```

小心花括号。像其他人建议的那样，首先正确缩进您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T15:47:09.663

正如其他成员所建议的，使用体面的缩进。

在这里，您只是放错了几个大括号。

更正的代码：

```
import java.util.Scanner;
class GolfEM
{
public static void main (String[] args)
{
Scanner kb = new Scanner(System.in);
boolean go = true;
boolean run = true;
while (go==true)
    {
    while (run)
        {
System.out.println("Enter par for the hole: ");
int par = kb.nextInt();
System.out.println("Enter the number of strokes: ");
int stroke = kb.nextInt();

if (stroke==1)  {
System.out.println("hole in one");
run=false;
        }
else
if (3==par-stroke){
System.out.println("double eagle");
run=false;
        }
else
if (2==par-stroke){
System.out.println("eagle");
run=false;
        }
else
if (1==par-stroke){
System.out.println("birdie");
run=false;
        }
else
if (par==stroke){
System.out.println("par");
run=false;
        }
else
if (-1==par-stroke){
System.out.println("bogey");
run=false;
        }
else
if (-2==par-stroke){
System.out.println("double-bogey");
run=false;
        }
else
if (-3==par-stroke){
System.out.println("triple-bogey");
run=false;
        }
else
if (-4==par-stroke){
System.out.println("four-over-par");
run=false;
        }
else
if (-5==par-stroke){
System.out.println("five-over-par");
run=false;
        }
else
if (-6==par-stroke){
System.out.println("six-over-par");
run=false;
        }
else
if (-7==par-stroke){
System.out.println("seven-over-par");
run=false;
        }
else{
System.out.println("Better luck next time");
run=false;
        }
           run=false;
        }

    if (run==false)
    System.out.println("Run again? ");
    char again = kb.next().charAt(0);
        if (again == 'y')
        {
        run=true;}
        else if (again == 'n')
        {
        System.out.println("Goodbye.");
        go = false;}
        else
        {
        System.err.println("Invalid answer");
        }}
    }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T15:49:22.417

我真的不明白内`run`循环是干什么用的。它只运行一次，然后`run`设置为 false。但是，我假设您的代码是初步的，这部分将在以后填写。

关于您的实际问题：您的程序在无限循环中运行，因为询问用户是否再次运行程序的部分在循环*之外。*`go`只需将第一部分“花括号”向上移动就可以了。

# gcc - 构建 GCC 交叉编译器时找不到包含限制.h

> ID：15026794
> 
> 赞同：2
> 
> 时间：2013-02-22T14:49:30.903
> 
> 标签：gcc, cross-compiling, x86-64, include-path, sparc

我想用主机类型 Linux x86_64 和`--target=sparc-sun-solaris2.10`.

我已经成功构建了带有`--target`标志的 binutils 以及 GMP、MPFR 和 MPC。

我已将 Binutils 和 GCC 配置为使用`--with-build-sysroot=$SYSROOT`标志并递归复制

*   `/usr/include`
*   `/lib`
*   `/usr/lib`

从目标主机到它，以便我的`$SYSROOT`目录包含`usr`和`lib`.

在构建 GCC 之前，我还将 PATH 和 LD_LIBRARY_PATH 设置为我的前缀。

但是，当我尝试构建 GCC 时，尝试构建 libgcc（我相信是第二阶段）失败并出现错误：

`gcc/include-fixed/limits.h:169:61: error: no include path in which to search for limits.h`

我已经验证了它`limits.h`确实存在，`$SYSROOT/usr/include`那么为什么 GCC 不使用它呢？

请帮助解决这个问题。

如果我可以交叉编译我们的代码以在 x86_64 上工作，它将为我们的大公司节省大量工时。与 SPARC 相比，x86_64 的性能快如闪电，编译等待时间是我们生产力的一大瓶颈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T15:21:04.613

您可能会遇到[sysroot 值设置不正确](http://www.mail-archive.com/gcc@gcc.gnu.org/msg38085.html)的情况。您可能应该尝试使用详细选项进行构建......因为它可能会揭示这一点。

# php - WHERE 子句错误

> ID：15026796
> 
> 赞同：0
> 
> 时间：2013-02-22T14:49:32.173
> 
> 标签：php, html, mysql, sql

我正在尝试在 HTML 表中的数据库中显示特定值。语句是这样的：（这只是一个例子）

```
$sql = "SELECT * FROM tbl_trainings WHERE tbl_trainings.training='Meat Processing'"; 
```

我的问题是我有这个声明（加入表）：

```
$sql="SELECT 
tbl_info.id, 
tbl_info.firstname, 
tbl_info.middlename, 
tbl_info.lastname, 
tbl_trainings.id,
tbl_trainings.training,
tbl_trainings.info_id
  FROM tbl_info, tbl_trainings
  WHERE tbl_info.id = info_id 
  ORDER BY tbl_info.id"; 
```

我试图`WHERE tbl_trainings.training='Meat Processing'`在这样的语句中插入：

```
$sql="SELECT 
tbl_info.id, 
tbl_info.firstname, 
tbl_info.middlename, 
tbl_info.lastname, 
tbl_trainings.id,
tbl_trainings.training,
tbl_trainings.info_id
  FROM tbl_info, tbl_trainings
  WHERE tbl_info.id = info_id, tbl_trainings.training='Meat Processing'
  ORDER BY tbl_info.id"; 
```

但我得到了错误。错误是：

警告：mysql_fetch_array() 期望参数 1 是资源，在 C:\wamp\www\CLphpTest\meatproc.php 中给出的布尔值

谁能帮我纠正这个问题？（对不起。仍然是菜鸟）

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:50:53.650

`AND/OR`如果您在查询中有多个条件，请添加，例如

```
WHERE tbl_info.id = info_id AND
      tbl_trainings.training='Meat Processing' 
```

另一方面，使用较新的连接语法，

```
SELECT  tbl_info.id,
        tbl_info.firstname,
        tbl_info.middlename,
        tbl_info.lastname,
        tbl_trainings.id,
        tbl_trainings.training,
        tbl_trainings.info_id
FROM    tbl_info
        INNER JOIN tbl_trainings
            ON tbl_info.id = tbl_trainings.info_id
WHERE   tbl_trainings.training = 'Meat Processing'
ORDER   BY tbl_info.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:52:24.433

```
Should be "WHERE tbl_info.id = info_id AND tbl_trainings.training='Meat Processing' 
```

# php - 使用 DOM 和 PHP 获取“td”值

> ID：15026798
> 
> 赞同：0
> 
> 时间：2013-02-22T14:49:41.407
> 
> 标签：php, jquery, dom

我是编码世界的新手^_^，我正在研究一个名为“GLPI”的现有开源解决方案。他们使用 MVC 方法来管理他们的代码，所以我发现很难编辑代码以在页面的表格中不显示某些记录。另外，我担心我会破坏应用程序，这就是为什么我决定保留旧代码并在文档末尾添加一些额外的 PHP 代码以`td`从 HTML 表中删除一些与 MySQL 匹配的值查询结果：

1) 我真正需要的是`td`使用下表中的 DOM 和 PHP 获取值。

例如（包含两个单元格的表格）：

> PS：该表正在从 MySQL 查询中加载记录

```
 <form method="post" name="massiveaction_form" id="massiveaction_form"
    action="massiveaction.php">
        <div class="center">
          <table class="tab_cadrehov">
            <tbody>
               <tr>
                   <td>YassineKira</td>
               </tr>
               <tr>
                   <td>YassineEdouiri</td>
               </tr>
            </tbody>
          </table>
        </div>
    </form> 
```

使用这种方法：

```
$dom = new DOMDocument();
    $dom->loadHTML("users.html"); 
           .....................
           ..................... 
```

2）我还想执行一个 MySQL 查询，看看检索到的`td`值之一是否有一个 id = 1，然后删除`tr`包含`td`. 像这样的东西：

```
foreach (..(td value stored in an Array)... as $name ) {
   $IDq = mysql_query("select id from glpi_users where name = '".$name."'");
   $row = mysql_fetch_array($IDq);
   $ID = $row['id']; 
   if ($ID == 1) 
   {
       (....'tr->td'......).remove() ; 
   }

} 
```

我在上面使用 PHP，我不知道是否有组合的 PHP/jQuery 解决方案可以处理这个问题。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:56:13.020

我要在这里拍...

您可以像这样访问这些`td`值：

```
$(".tab_cadrehov td") 
```

这将为您提供一个元素数组，您可以使用循环或使用`each`.

```
$(".tab_cadrehov td").each(function(){
    // $(this) will you each TD element
}); 
```

# ruby-on-rails - 如何在 Rails 中添加每个条目具有唯一字段的模型？

> ID：15026799
> 
> 赞同：-1
> 
> 时间：2013-02-22T14:49:43.280
> 
> 标签：ruby-on-rails, rails-activerecord

我正在尝试设置一个具有英雄模型和能力模型的应用程序，每个英雄都有许多能力。

每个技能条目都有一些通用字段，例如名称、描述、伤害、范围、持续时间。等等。

但是每个条目都应该能够具有该条目唯一的字段，例如，一个单一的能力将具有以下字段：tether_duration 和 break_distance

我将如何设置我的模型以允许这样做？因为我现在无法理解它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:08:07.383

你总是可以通过命名和绘制它来分解它。

英雄有很多能力 能力有很多英雄 Abilities_attributes 属于能力。或者可能有很多能力。

如果您将所有内容分解为单词，它将帮助您建模。找出每个模型所需的列。如果您需要进一步分解这些列，您将需要另一个模型（如有必要）。

至于你的情况。

如果您的能力有子类别，您似乎需要创建另一个模型。

希望能帮助到你

# wpf - Awesomium 浏览器和不同机器上的对齐差异

> ID：15026800
> 
> 赞同：0
> 
> 时间：2013-02-22T14:49:45.333
> 
> 标签：wpf, c#-4.0, awesomium

我有一个使用 Awesomium 浏览器和 Microsoft Multipoint Mouse SDK 的 .Net 应用程序。问题是当我在两台不同的机器上运行它时，我得到的结果有点不同。在一台机器上，我可以看到浏览器的滚动条和我配置的鼠标对齐，这是完美的。但是在另一台机器上，鼠标对齐方式有点不同，滚动条没有出现，浏览器向右移动了一点……我试过了，但不知道问题可能出在哪里。两台机器的屏幕尺寸不同，第一台分辨率为1366x768，第二台分辨率为1280x1024。这个问题与决议有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T18:28:27.233

Win 7：控制面板/显示器。应显示选定的百分比（100、125、150）。如果在每台计算机上选择的 % 不同，您可能会有不同的缩放比例，这可能会导致您看到的结果。您可以同步每台计算机上的 %（并重新启动）以验证是否存在问题。FWIW，当 % 不是“默认”时，我没有在 Windows 上看到具有一致显示的单个应用程序。

# delphi - Delphi TcpClient(Sockets) 和 TcpServer(Sockets) 连接？

> ID：15026801
> 
> 赞同：0
> 
> 时间：2013-02-22T14:49:46.617
> 
> 标签：delphi, delphi-7, tcpclient, tcpserver

我正在尝试使用 TcpClient(Sockets) 和 TcpServer(Sockets) 从 PC 连接到 Delphi 中的另一台 PC。

可以这样连接吗？如果可能的话，我如何将它们相互连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:30:32.033

如果想在这 2 台电脑之间交换数据，您可以使用 indy 组件，在 source forge 上您将 [DEMO SAMPLES](http://sourceforge.net/projects/indy10clieservr/)

# android - ASMX 网络服务，安卓

> ID：15026803
> 
> 赞同：2
> 
> 时间：2013-02-22T14:49:52.073
> 
> 标签：android, security, service, web, ksoap2

Android App ksoap2 使用 HttpsTransportSE(SSL) 在 header 中传递用户名和密码。在 asmx Web 服务中验证用户名和密码。

我不希望任何人能够编写自己的应用程序并使用 Web 服务。但是，我不希望用户必须输入用户名和密码。我打算在代码中存储用户名和密码，但我不知道这种方法在 android 上的安全性如何。如果您有更好的建议，我将不胜感激。

谁能告诉我我可以做些什么来保护这个应用程序？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:31:30.560

就像我上面已经说过的答案一样，有很多选项可供您使用。

您可以使用[**SoapHeaders**](http://quickstarts.asp.net/QuickStartv20/webservices/doc/SoapHeaders.aspx)来实现 Web 服务的安全性。

或者，实施您自己的`Permimeter Service Router`以确保只有经过身份验证的用户才能访问您的专用网络。

这是MSDN上一篇关于[**Web 服务安全**](http://msdn.microsoft.com/en-us/library/Aa480545.aspx)性的优秀文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:23:36.587

一般来说，任何能够在没有**逆向工程**保护的情况下在应用程序中读取的内容。在您的代码中存储用户名和密码不是一个好主意。

但这取决于应用程序的类型。有很多方法可以保护您的 Web 服务。

以下是其中的几个：

*   使用用户名+密码进行基本身份验证
*   使用对称密钥的用户名认证
*   基于token的认证
*   SAML
*   等等

给你一些参考：

*   [http://metro.java.net/guide/ch12.html#ahicv1](http://metro.java.net/guide/ch12.html#ahicv1)
*   [http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf)

# c# - 如何允许用户在画布上选择/突出显示多个孩子？

> ID：15026804
> 
> 赞同：0
> 
> 时间：2013-02-22T14:49:57.083
> 
> 标签：c#, .net, wpf, xaml, graphics

所以我有一个画布，里面有 110 个从文本块继承的对象，每个对象都有自己的单击事件和鼠标悬停事件。单击将允许用户通过单击按钮来更改对象背后的属性。

例子：

用户单击他们想要更改数据的对象。然后他们将单击另一个按钮，该按钮将对应于其背后数据的特定更改......即用户单击标记为“105”的对象并将其“binCode”属性从0更改为1。

如何允许用户单击/选择/突出显示多个对象以允许他们一次更改所有数据。在许多情况下，整行对象都需要完全相同的数据更改。当用户应该能够突出显示整行并单击一次按钮时，让用户连续执行 10 次相同的事情是低效的。

任何帮助都会很棒，我真的不知道如何去做。

先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:19:54.747

首先，您需要跟踪单击的对象。这应该通过点击事件来完成。通过更改对象的属性或将对该特定对象的引用存储在列表中。

当您按下更改按钮时，您应该遍历所有单击的对象并对其进行更改。根据您跟踪单击的对象的方式，您可以遍历所有对象并检查它是否被单击，或者遍历单击的对象列表。

进行更改后，不要忘记“取消单击”对象。

# java - 如何在 SWT 中使用标准尺寸制作可调整大小的布局

> ID：15026807
> 
> 赞同：0
> 
> 时间：2013-02-22T14:50:15.740
> 
> 标签：java, eclipse, user-interface, layout, swt

我目前正在尝试使用 SWT 制作一个应用程序，我希望在 Finder 中有类似的东西，我可以通过拖动边缘来调整不同复合材料的大小。我还希望能够设置左右栏/复合材料的默认宽度。我首先尝试使用 BoxLayout，但切换到 GroupLayout 却收效甚微。

这是我现在得到的照片![这是现在的样子](../Images/b69733c8a24bb0aa5db97201e7add8be.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:57:13.320

简单的调整大小可以使用[`SashForm`](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fcustom%2FSashForm.html). [这](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/SashFormExample.htm)是一个简单的例子，展示了如何使用它。它看起来类似于：

![在此处输入图像描述](../Images/549992470d69692929d9ad2685835ebc.png)

至于默认宽度：如果你显示一些代码会更容易帮助。

# java - 用 JSONArray 中的空字符串替换所有空值

> ID：15026823
> 
> 赞同：1
> 
> 时间：2013-02-22T14:51:13.180
> 
> 标签：java, android

嗨，我有一个 JSONObject 已转换为 JSON 数组，我想知道如何循环遍历整个数组，找到任何 null 实例并将其替换为“”？

继承人我到目前为止，但不知道从这里去哪里

```
JSONObject fullNetworkfile = fullNetworkDataFromFile;
     JSONArray fullNetworkArray = new JSONArray();
     fullNetworkArray.put(fullNetworkfile); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T14:59:25.170

```
for (int i = 0; i < fullNetworkArray.length(); i++) {
    Object network = fullNetworkArray.get(i);
    if (network == null) {
        fullNetworkArray.put(i, "");
    }
} 
```

# c# - 使用 IIS7 和 Windows Server 的 .NET3.5 c# 中出现错误 0x5011

> ID：15026824
> 
> 赞同：1
> 
> 时间：2013-02-22T14:51:17.737
> 
> 标签：c#, asp.net, .net, iis-7, application-pool

我是 .NET 开发的新手，通常作为 DBA 工作。

我使用 c# 在 .NET 3.5 中开发了一个网站。该网站用于查询带有密码信息的数据库。我相信错误在于我的 IIS 设置或我的 web.config 文件，而不是我的 c# 代码，但我可能错了。

我得到错误：

```
Unknown error (0x5011) 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Runtime.InteropServices.COMException: Unknown error (0x5011)

Line 40:                 UserPrincipal user = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, VerifiedUser);
Line 41: 
Line 42:                 foreach (var group in user.GetGroups())
Line 43:                 {
Line 44: 

Stack Trace:

[COMException (0x5011): Unknown error (0x5011)]
System.DirectoryServices.ResultsEnumerator.MoveNext() +437216
System.DirectoryServices.AccountManagement.ADDNLinkedAttrSet.GetNextSearchResult() +195
System.DirectoryServices.AccountManagement.ADDNLinkedAttrSet.MoveNextMemberSearcher() +57
System.DirectoryServices.AccountManagement.ADDNLinkedAttrSet.MoveNext() +102
System.DirectoryServices.AccountManagement.ADDNConstraintLinkedAttrSet.MoveNext() +55
System.DirectoryServices.AccountManagement.FindResultEnumerator`1.MoveNext() +106
System.DirectoryServices.AccountManagement.FindResultEnumerator`1.System.Collections.IEnumerator.MoveNext() +9
_Default.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\PasswordVault\Default.aspx.cs:42
System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +25
System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +42
System.Web.UI.Control.OnLoad(EventArgs e) +132
System.Web.UI.Control.LoadRecursive() +66
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2428 
```

它在我的本地计算机（Windows 7）上总是可以正常工作，但是当我使用 IIS 7 传输到 Windows Server 2008 并将文件存储在 inetpub 的 wwwroot 文件夹中时，我会收到此间歇性错误。

我今天有错误，但昨天没有，但前一天就在那里。我花了几个小时修补 IIS 设置和应用程序池，但我真的需要知道是什么导致了问题。

不喜欢的代码是检查用户是否是特定 AD 组的成员，如果是，则返回基于该用户组的信息。我不相信代码是一个问题，因为它确实（有时）并且总是在我的本地机器上工作。我相信这个问题与 IIS 或 .NET 框架有关。

任何帮助将非常感激。

问候约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T19:34:56.550

这是 3.5 库中的一个问题。以下是问题的代码和描述：http: [//blogs.msdn.com/b/dsadsi/archive/2010/12/14/title-system-directoryservices-accountmanagetment-userprincipal-getgroups-will-throws-comexception -error-0x5011-s-ads-errorsoccurred-while-enumerating-the-principalsearchresult-collection.aspx](http://blogs.msdn.com/b/dsadsi/archive/2010/12/14/title-system-directoryservices-accountmanagetment-userprincipal-getgroups-will-throws-comexception-error-0x5011-s-ads-errorsoccurred-while-enumerating-the-principalsearchresult-collection.aspx)

这是一个可能的答案：[未知错误 (0x5011) with ActiveDirectory PrincipalContext](https://stackoverflow.com/questions/4630886/unknown-error-0x5011-with-activedirectory-principalcontext)。

# php - PHP / MySQL - 如何防止两个请求 *更新

> ID：15026825
> 
> 赞同：22
> 
> 时间：2013-02-22T14:51:19.813
> 
> 标签：php, transactions

我有一些问题......例如：用户会用他的美元买东西

1.  检查他的美元余额
2.  从他的账户中扣除美元
3.  下订单 -> 订单队列
4.  用户得到他的物品，另一个得到他的美元

可以说，用户在同一秒内发出 5 个请求（非常快）。所以有可能（并且发生）5 个请求正在运行。他只有从 1 个请求中购买的钱。现在请求太快了，脚本检查了他的余额，但没那么快，它从他的账户中扣除了钱。所以请求将通过两次！如何解决？

在开始进程之前，我在 mysql 中使用 LOCK：

1.  IS_FREE_LOCK - 如果没有，则检查该用户是否有锁 -> 2。
2.  GET_LOCK - 设置锁
3.  下订单/交易
4.  RELEASE_LOCK - 释放锁

但这并没有真正起作用。还有其他方法吗？

```
function lock($id) {
  mysql_query("SELECT GET_LOCK('$id', 60) AS 'GetLock'");
}

function is_free($id) {
  $query = mysql_query("SELECT IS_FREE_LOCK('$id') AS 'free'");
  $row = mysql_fetch_assoc($query);
  if($row['free']) {
    return true;
  } else {
    return false;
  }
}

function release_lock($id) {
  mysql_query("SELECT RELEASE_LOCK('$id')");
}

function account_balance($id) {
  $stmt = $db->prepare("SELECT USD FROM bitcoin_user_n WHERE id = ?");
  $stmt->execute(array($id));
  $row = $stmt->fetch(PDO::FETCH_ASSOC);

  return $row['USD'];
}

if(is_free(get_user_id())) {
  lock(get_user_id());
  if(account_balance(get_user_id()) < str2num($_POST['amount'])) {
    echo "error, not enough money";
  } else {
    $stmt = $db->prepare("UPDATE user SET USD = USD - ? WHERE id = ?");
    $stmt->execute(array(str2num($_POST['amount']), get_user_id()));
    $stmt = $db->prepare("INSERT INTO offer (user_id, type, price, amount) VALUES (?, ?, ?, ?)");
    $stmt->execute(array(get_user_id(), 2, str2num($_POST['amount']), 0));
} 
```

**更新** 用 SELECT ... FOR UPDATE 测试了事务功能

```
$db->beginTransaction();
$stmt = $db->prepare("SELECT value, id2 FROM test WHERE id = ? FOR UPDATE");
$stmt->execute(array(1));
$row = $stmt->fetch(PDO::FETCH_ASSOC);
if($row['value'] > 1) {
  sleep(5);
  $stmt = $db->prepare('UPDATE test SET value = value - 5 WHERE id = 1');
  $stmt->execute();
  $stmt = $db->prepare('UPDATE test SET value = value + 5 WHERE id = 2');
  $stmt->execute();
  echo "did have enough money";
} else {
  echo "no money";
}
$db->commit(); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-22T15:04:28.800

首先，您必须使用事务，但这还不够。在您的交易中，您可以使用[`SELECT FOR UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html).

它基本上是在说，*“我要更新我选择的记录”*，所以它设置的锁与 an 设置的锁相同`UPDATE`。但请记住，这必须发生在关闭自动提交的事务中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T14:53:16.630

使用[TRANSACTION](http://dev.mysql.com/doc/refman/5.0/en/commit.html)，如果失败，您可以回滚。

例如，假设当前余额为 20 美元。

```
Connection A               Connection B
=======================    ===========================
BEGIN TRANSACTION         
                           BEGIN TRANSACTION
SELECT AccountBalance  
                           SELECT AccountBalance
--returns $20
--sufficient balance,
--proceed with purchase
                           --returns $20
                           --sufficient balance,
                           --proceed with purchase

                            --update acquires exclusive lock
                           UPDATE SET AccountBalance
                              = AccountBalance - 20
--update blocked due
UPDATE SET AccountBalance
  = AccountBalance - 20

                           --order complete
                           COMMIT TRANSACTION

--update proceeds

--database triggers
--constraint violation
--"AccountBalance >= 0"

ROLLBACK TRANSACTION 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-13T12:38:15.630

很多年前我就是这么干的。。

```
results = query("UPDATE table SET value=value-5 WHERE value>=5 AND ID=1")
if (results == 1) YEY! 
```

（这仍然是一种可靠的方法吗？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-20T14:08:28.413

您需要在 SERIALIZABLE 隔离级别使用 TRANSACTION。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-09T10:43:01.210

您需要对 MySQL UPDATE 使用数据修订。

# excel - ActiveXObject - Excel.Application 不释放资源

> ID：15026827
> 
> 赞同：1
> 
> 时间：2013-02-22T14:51:26.270
> 
> 标签：excel, activex, activexobject, excellibrary, vba

我开发了这个脚本，我写在 xls 工作表上。

```
var excelFile = "C:\\TestActiveX\\Test.xls";
function readExcelFileAndUpdateView()
{
    var w =new ActiveXObject("Excel.Application");      
    w.Workbooks.Open(excelFile);  
    var objWorksheet1 = w.Worksheets(1);    
    var name =objWorksheet1.Cells(1,2);
    if(name==null){
        name="";
    }

    var objWorksheet2 = w.Worksheets(2);    
    var surname = objWorksheet2.Cells(1,2);
    if(surname==null){
        surname="";
    }

    var str = "Name is :"+name+"<br/>Surname is :"+surname;

    document.getElementById("txtAreaXLS").innerHTML=str;    
    w.Application.Quit();
    w.Quit();
    w = null;               
} 
```

问题是当这个函数完成执行时，我的 Windows 任务管理器中有 2 个 EXCELL 对象正在运行。在我的函数结束时释放资源似乎不起作用。

我也尝试过，`objWorksheet1.close(true);`但 没有运气。`w.Workbooks.Close(true);``w.ActiveWorkbook.Close(true);`

有谁知道哪些是开放的对象，我该如何摆脱它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T15:24:08.943

ActiveX 可能有一些奇怪的行为。您需要确保将对 ActiveX 对象（和子对象/成员）的所有引用设置为空。在您的代码中，您设置了 w = null，但您仍然有对 objWorksheet1、name、objWorksheet2、surname 的引用。也将它们设置为空。我会推荐一个 try/catch/finally 块，你可以在 finally 块中为空。

CodeProject上有一篇不错的文章推荐：Save、Close、Quit、null。尽管如此，除非您将所有对 ActiveX 对象及其成员的引用都归零，否则这无关紧要。

本文的第 12 和 13 节有一些很好的例子： http: [//www.codeproject.com/Articles/404688/Word-Excel-ActiveX-Controls-in-ASP-NET](http://www.codeproject.com/Articles/404688/Word-Excel-ActiveX-Controls-in-ASP-NET)

# python - 关闭 Tornado 处理程序

> ID：15026840
> 
> 赞同：0
> 
> 时间：2013-02-22T14:51:59.423
> 
> 标签：python, handler, tornado, self

我有个疑问。

我有这部分代码：

```
#Code for retrieving the MAC address of the node
    como_url = "".join(['http://', options.como_address, ':', options.como_port,
                        '/ztc_config?netid=', netid,
                        '&opcode_group=', opcodegroupr, 
                        '&opcode=', opcoder, '&start=-5m&end=-1s'])

    print como_url

    http_client = AsyncHTTPClient()
    response = yield tornado.gen.Task(http_client.fetch, como_url)

    ret = {}
    if response.error:
        ret['error'] = 'Error while retrieving the response'
        self.write(tornado.escape.json_encode(ret))
    else:
        for line in response.body.split("\n"):
            if line != "": 
                value = int(line.split(" ")[6])
                ret['response'] = value
        self.write(tornado.escape.json_encode(ret)) 
```

我希望，如果来自服务器的响应为空，则处理程序关闭。

我不知道这是否

```
 if response.error:
        ret['error'] = 'Error while retrieving the response'
        self.write(tornado.escape.json_encode(ret)) 
```

关闭处理程序并在页面中返回是正确的。或者，如果我必须做一个 self.finish .....

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T10:24:41.920

解决方案是：

```
if response.error:
        ret['error'] = 'Error while retrieving the response'
        self.write(tornado.escape.json_encode(ret))
        self.finish() 
```

# html - 如何用 HTML5 实现不同的屏幕

> ID：15026841
> 
> 赞同：-1
> 
> 时间：2013-02-22T14:51:59.330
> 
> 标签：html, html5-canvas

我曾使用 HTML5 创建一个单屏小游戏。这次我尝试制作一个具有多个屏幕的屏幕，例如菜单、游戏、结果屏幕。我不确定如何实现这一点。

游戏是一个测验，根据问题，一些测验屏幕可能必须显示文本、音频或视频（非硬编码，它们来自数据库）。出于这个原因，我担心稳定性。如何在 HTML5 中实现这些屏幕，以及如何以使我的游戏稳定的方式来实现？

我已经包含了一个屏幕流程图，以了解我正在实施哪些屏幕。

![在此处输入图像描述](../Images/ee5169c4de1ba9a71acdb5a8d4f5efc2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T18:18:22.980

对于我的游戏，我使用“状态”系统。将每个屏幕视为一个状态：

*   状态“加载”
*   国家“学生茂”
*   状态“注册”
*   状态“查看您的测验”
*   状态“尝试”
*   state "answer" 这只是一个枚举。

实际上，一个状态不仅是一个屏幕，还可以是多个屏幕（例如“玩游戏”状态，它包含“点击播放”子状态、“正在玩”子状态和“你输/赢”子状态。

每个状态都是一个类，有它的属性、方法、精灵……每个状态都封装了“setImage”、“render”、“processKeyboard”……方法。

应用程序的主类处理所有事件（键盘、鼠标、显示器、精灵表加载）并将它们分派到当前状态。如果要改变当前状态，调用主类的“setCurrentState”。

好吧，主类是应用程序的中心点，每个状态都只是一个插件。这样很容易添加新状态。

要获得完美的模板，您还需要一个工作流引擎，但这更适合大型游戏……您的应用程序中可能不需要这么大的功能。

对于帆布来说，它是完美的。加载状态是默认状态。它在主类加载 spritesheets 图像时呈现“加载”文本。当所有图像都加载完毕后，主类切换到“主页”状态。“主页”状态有自己的方法、按钮、...

您可以查看使用 cgSceneGraph 的示例（但无论有无框架，每个开发的设计都应该相同）： http: [//gwennaelbuchet.github.com/cgSceneGraph/examples/05_Game_CatchTheFlowers/js/class.main。 js](http://gwennaelbuchet.github.com/cgSceneGraph/examples/05_Game_CatchTheFlowers/js/class.main.js) （链接到[此处](http://gwennaelbuchet.github.com/cgSceneGraph/examples.html)的示例，选择“游戏：全部抓住”）。[可以在 GitHub 上找到模板peoject](https://github.com/GwennaelBuchet/cgSceneGraph/tree/master/examples/TEMPLATE_GAME)的代码（用于上一个游戏）：[https ://github.com/GwennaelBuchet/cgSceneGraph/tree/master/examples/TEMPLATE_GAME](https://github.com/GwennaelBuchet/cgSceneGraph/tree/master/examples/TEMPLATE_GAME)

随时询问有关实施的更多细节；我很乐意提供帮助:)

# python - 可以访问所有节点的变形/滤锅验证器？

> ID：15026844
> 
> 赞同：8
> 
> 时间：2013-02-22T14:52:17.443
> 
> 标签：python, pyramid, deform, colander

如何在 Deform/Colander 中定义一个自定义验证器，该验证器可以访问所有节点值。我需要访问两个字段中的值以确定特定值是否有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-27T06:44:22.593

要为所有滤锅字段放置验证器，我们可以简单地这样做

**验证器方法：**

```
def user_DoesExist(node,appstruct):
if DBSession.query(User).filter_by(username=appstruct['username']).count() > 0:
    raise colander.Invalid(node, 'Username already exist.!!') 
```

**架构：**

```
class UserSchema(CSRFSchema):
username = colander.SchemaNode(colander.String(), description="Extension of the user")
name = colander.SchemaNode(colander.String(), description='Full name')
extension = colander.SchemaNode(colander.String(),description='Extension')
pin = colander.SchemaNode(colander.String(), description='PIN') 
```

**看法：**

```
@view_config(route_name='add_user', permission='admin', renderer='add_user.mako')
def add_user(self):
    #Here you can provide validator method as a parameter. And you can validate any field you want.
    schema = UserSchema(validator = user_DoesExist).bind(request=self.request)
    form = deform.Form(schema, action=self.request.route_url('add_user'), buttons=('Add User','Cancel')) 
```

如果我在我的场景中错了，请纠正我。

谢谢

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-23T08:00:02.693

Tangibly the answer is:

```
def verify_email_validator(form, values):
    if values['email_address'] != values['verify_email']:
        raise Invalid(form, 'Email values do not match')

class MySchema(MappingSchema):

    def __init__(self, *args, **kwargs):
        super(KickEntrySchema, self).__init__(*args, **kwargs)
        self.validator=verify_email_validator  # entire form validator

    email_address = SchemaNode(Email())
    verify_email = SchemaNode(Email()) 
```

Note the form validator is invoked only if none of the individual field validators raise an error.

# django - Django：在模型选择中将惰性翻译与标记安全相结合

> ID：15026846
> 
> 赞同：9
> 
> 时间：2013-02-22T14:52:24.447
> 
> 标签：django, forms, model, translation, html-entities

是的，所以，我想为我的模型存储翻译的选择，但 Django 不同意我的观点。Django 的版本是 1.3，模型和选项如下所示：

```
from django.db import models
from django.utils.safestring import mark_safe          
from django.utils.translation import ugettext_lazy as _

RATE_CHOICES = (
    ('', _('Choose service rate')),
    ('5cpm_EUR', mark_safe(string_concat('&euro; 0,05 ', _('per minute')))),
    ('1cpm_EUR', mark_safe(string_concat('&euro; 0,01 ', _('per minute')))),
)

class Product(models.Model):
    service_rate = models.CharField(_('service rate'), max_length=10, blank=True, choices=RATE_CHOICES) 
```

此外，这些选择用于模型表单（对于另一个模型，所以我不得不重新声明该字段），如下所示：

```
service_rate = forms.ChoiceField(choices=RATE_CHOICES, widget=forms.Select(attrs={'class': 'chzn-select rate-select'}), required=False) 
```

问题是，无论我尝试什么；遵循 django docs 上的内容，颠倒 mark_safe 和翻译的顺序，不使用惰性翻译等。它总是归结为 mark_safe 工作或翻译工作。但从来没有两者...

如何正确结合这两个功能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T21:24:53.237

添加：

```
from django.utils import six  # Python 3 compatibility
from django.utils.functional import lazy
from django.utils.safestring import mark_safe
from django.utils.translation import ugettext_lazy as _

mark_safe_lazy = lazy(mark_safe, six.text_type) 
```

接着：

```
mark_safe_lazy(string_concat('&euro; 0,05 ', _('per minute'))) 
```

这被添加到 Django 1.4[文档](https://docs.djangoproject.com/en/dev/topics/i18n/translation/#other-uses-of-lazy-in-delayed-translations)中。

# ios - 通过 Objective-C 代码进行 XML 解析

> ID：15026848
> 
> 赞同：0
> 
> 时间：2013-02-22T14:52:36.177
> 
> 标签：ios, objective-c, xml, xcode, xml-parsing

我只想解析从发布响应收到的字符串，我知道有像 NSXMLParse 这样的库/类，苹果提供了一些示例，但不是我想要的，或者我还没有准备好理解该代码。

我收到这个：

```
<object>
<id>1</id>
<alias>juan</alias>
<email>jps@sol.pro</email>
</object>
<object>
<id>2</id>
<alias>juana</alias>
<email>jpsa@sol.pro</email>
</object> 
```

然后我需要解析，并得到这样的数据：

```
NSString *xmlThing = [response];
for xmlThing in-all <object>
{
    uint id = <id>1</id>
    NSString *alias = <alias>juan</alias>
    NSString *email = <email>email@email.com</email>
} 
```

为什么会这样？因为我认为这是处理和解析各种 html、xml 等文件的最简单方法。

我感谢各种帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-06T05:44:21.000

您可以使用 XMLReader 类轻松解析 XML 文件。有关更多详细信息，请查看[https://appengineer.in/2013/08/03/xml-parsing-using-xml-reader-in-objective-c/](https://appengineer.in/2013/08/03/xml-parsing-using-xml-reader-in-objective-c/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T15:09:12.610

您可以使用[NSXMLParser](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)及其委托方法。

示例：在 *.h 文件中添加 NSXMLDelegate：

```
@interface YourClass: NSObject <NSXMLParserDelegate> 
```

*.m 文件：

```
 @interface YourClass()
    @property NSMutableString *currentXMLValue;
    @property NSMutableArray *objects;
    @end

    @implementation YourClass{
    -(void) processXML {
    NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithData: data];
    self.objects = [[NSMutableArray alloc] init];
    [xmlParser setDelegate: self];
    [xmlParser parse];
    }

    -(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
    {
        //each time part of string is found append it to current string
        [self.currentXMLValue appendString:string];
    }

//here you can check when <object> appears in xml and create this object
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *) namespaceURI qualifiedName:(NSString *)qName
   attributes: (NSDictionary *)attributeDict
{
    //each time new element is found reset string
    self.currentXMLValue = [[NSMutableString alloc] init];
    if( [elementName isEqualToString:@"object"])
    {
        self.obj= [[YourObject alloc] init];
    }
}
//this is triggered when there is closing tag </object>, </alias> and so on. Use it to set object's properties. If you get </object> - add object to array.
    -(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
    {

        if ([elementName isEqualToString:@"id"]) {
           obj.id = [self.currentXMLValue intValue];
        }
        else if ([elementName isEqualToString:@"alias"]) {
           obj.alias = self.currentXMLValue;
        }
        else if ([elementName isEqualToString:@"object"]) {
        if (self.objects) {
            [self.object addObject:obj];
        }
        }
    //and so on
    } 
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T18:02:46.323

好吧，上面的答案似乎很完美，但是如果您有大量数据和更快的处理速度，我建议您使用其他解析器，您可以[在这里使用 TBXML、xml 比较](http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project)

# erlang - 杀死进程并在erlang中运行程序

> ID：15026851
> 
> 赞同：0
> 
> 时间：2013-02-22T14:52:44.990
> 
> 标签：erlang

我用erlang开发一个程序

我用这个命令运行这个程序：

```
 ./build.sh && ./deploy.sh ./erl_start.sh 
```

我想知道在我的程序的文件 model.erl 中存储的函数**验证**中做一个**测试**

 **在功能**验证**中， 我应该找到并终止我的程序（当前程序）的进程，并且我想运行该程序

```
verify(Val)->
if Val =:=40 ->
%% kill the process of my program
%% run this commande ./build.sh && ./deploy.sh ./erl_start.sh

true -> ok

end. 
```

所以我想我会尝试

```
 verify(Val)->
    if Val =:=40 ->
  exit(Pid,Reason), %%  but I should know the pid of the current program
   os_cmd("./build.sh && ./deploy.sh ./erl_start.sh");

    true -> ok

    end. 
```

知道当前程序的 pid --> 我有一个正在运行的应用程序，在这个应用程序的代码中我应该有办法知道这个应用程序的 pid 以便让它停止

目前

我尝试使用此功能：

```
verify(Val)->
    if Val =:=40 ->
Pid = self(), 

io:format("~w~n",[Pid]),
spawn(fun() -> exit(Pid, kill) end),
    LsOut = os:cmd("./build.sh && ./deploy.sh && ./erl_start.sh");

    true -> ok

    end. 
```

当我测试这个功能时，我有这个错误：

```
1> model:verify(40).
<0.144.0>
** exception exit: killed 
```

我的目标是：

我有一个用 Erlang 开发的应用程序来运行我需要做的这个应用程序：**./build.sh && ./deploy.sh && ./erl_start.sh**

我想创建一个函数（在我们的例子中是函数验证），它将与**Ctrl + C 执行相同的操作，然后执行 ./build.sh && ./deploy.sh && ./erl_start.sh 意味着停止应用程序并再次运行此应用程序**

我也测试了你的命令，我得到了这个结果：

```
1> [io:format("~p : ~p~n",[Pid,erlang:process_info(Pid,current_function)]) || Pid <- processes()].
<0.0.0> : {current_function,{init,loop,1}}
<0.3.0> : {current_function,{erl_prim_loader,loop,3}}
<0.5.0> : {current_function,{gen_event,fetch_msg,5}}
<0.6.0> : {current_function,{gen_server,loop,6}}
<0.8.0> : {current_function,{application_master,main_loop,2}}
<0.9.0> : {current_function,{application_master,loop_it,4}}
<0.10.0> : {current_function,{gen_server,loop,6}}
<0.11.0> : {current_function,{gen_server,loop,6}}
<0.12.0> : {current_function,{gen_server,loop,6}}
<0.13.0> : {current_function,{global,loop_the_locker,1}}
<0.14.0> : {current_function,{global,collect_deletions,2}}
<0.15.0> : {current_function,{global,loop_the_registrar,0}}
<0.16.0> : {current_function,{gen_server,loop,6}}
<0.18.0> : {current_function,{gen_server,loop,6}}
<0.19.0> : {current_function,{gen_server,loop,6}}
<0.20.0> : {current_function,{code_server,loop,1}}
<0.21.0> : {current_function,{gen_server,loop,6}}
<0.22.0> : {current_function,{standard_error,server_loop,1}}
<0.23.0> : {current_function,{gen_server,loop,6}}
<0.24.0> : {current_function,{user_drv,server_loop,5}}
<0.25.0> : {current_function,{group,server_loop,3}}
<0.26.0> : {current_function,{group,server_loop,3}}
<0.27.0> : {current_function,{shell,shell_rep,4}}
<0.28.0> : {current_function,{gen_server,loop,6}}
<0.29.0> : {current_function,{gen_server,loop,6}}
<0.36.0> : {current_function,{application_master,main_loop,2}}
<0.37.0> : {current_function,{application_master,loop_it,4}}
<0.38.0> : {current_function,{gen_server,loop,6}}
<0.39.0> : {current_function,{gen_event,fetch_msg,5}}
<0.40.0> : {current_function,{gen_server,loop,6}}
<0.41.0> : {current_function,{gen_server,loop,6}}
<0.44.0> : {current_function,{gen_server,loop,6}}
<0.45.0> : {current_function,{mnesia_locker,loop,1}}
<0.46.0> : {current_function,{gen_server,loop,6}}
<0.47.0> : {current_function,{mnesia_tm,doit_loop,1}}
<0.48.0> : {current_function,{gen_server,loop,6}}
<0.49.0> : {current_function,{gen_server,loop,6}}
<0.53.0> : {current_function,{gen_server,loop,6}}
<0.54.0> : {current_function,{gen_server,loop,6}}
<0.63.0> : {current_function,{disk_log,loop,1}}
<0.65.0> : {current_function,{gen_server,loop,6}}
<0.66.0> : {current_function,{gen_server,loop,6}}
<0.67.0> : {current_function,{gen_server,loop,6}}
<0.68.0> : {current_function,{gen_server,loop,6}}
<0.69.0> : {current_function,{mnesia_late_loader,loop,1}}
<0.105.0> : {current_function,{application_master,main_loop,2}}
<0.106.0> : {current_function,{application_master,loop_it,4}}
<0.107.0> : {current_function,{gen_server,loop,6}}
<0.108.0> : {current_function,{gen_server,loop,6}}
<0.109.0> : {current_function,{gen_server,loop,6}}
<0.110.0> : {current_function,{gen_server,loop,6}}
<0.111.0> : {current_function,{gen_server,loop,6}}
<0.112.0> : {current_function,{gen_server,loop,6}}
<0.113.0> : {current_function,{gen_server,loop,6}}
<0.114.0> : {current_function,{gen_server,loop,6}}
<0.115.0> : {current_function,{gen_server,loop,6}}
<0.117.0> : {current_function,{gen_server,loop,6}}
<0.118.0> : {current_function,{gen_server,loop,6}}
<0.119.0> : {current_function,{gen_server,loop,6}}
<0.120.0> : {current_function,{gen_server,loop,6}}
<0.121.0> : {current_function,{prim_inet,accept0,2}}
<0.123.0> : {current_function,{gen_server,loop,6}}
<0.124.0> : {current_function,{gen_server,loop,6}}
<0.125.0> : {current_function,{gen_server,loop,6}}
<0.126.0> : {current_function,{gen_server,loop,6}}
<0.127.0> : {current_function,{prim_inet,accept0,2}}
<0.129.0> : {current_function,{gen_server,loop,6}}
<0.130.0> : {current_function,{gen_server,loop,6}}
<0.131.0> : {current_function,{gen_server,loop,6}}
<0.132.0> : {current_function,{gen_server,loop,6}}
<0.133.0> : {current_function,{prim_inet,accept0,2}}
<0.135.0> : {current_function,{gen_server,loop,6}}
<0.136.0> : {current_function,{gen_server,loop,6}}
<0.137.0> : {current_function,{gen_server,loop,6}}
<0.138.0> : {current_function,{gen_server,loop,6}}
<0.139.0> : {current_function,{prim_inet,accept0,2}}
<0.140.0> : {current_function,{gen_server,loop,6}}
<0.143.0> : {current_function,{os,start_port_srv_loop,2}}
<0.144.0> : {current_function,{erl_eval,do_apply,5}}
[ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,
 ok,ok,ok,ok,ok,ok,ok,ok,ok,ok|...] 
```

并使用第二个命令：

```
1> [io:format("~p : ~p~n",[Pid,erlang:process_info(Pid,initial_call)]) || Pid <- processes()]. 
<0.0.0> : {initial_call,{otp_ring0,start,2}}
<0.3.0> : {initial_call,{erlang,apply,2}}
<0.5.0> : {initial_call,{proc_lib,init_p,5}}
<0.6.0> : {initial_call,{erlang,apply,2}}
<0.8.0> : {initial_call,{proc_lib,init_p,5}}
<0.9.0> : {initial_call,{application_master,start_it,4}}
<0.10.0> : {initial_call,{proc_lib,init_p,5}}
<0.11.0> : {initial_call,{proc_lib,init_p,5}}
<0.12.0> : {initial_call,{proc_lib,init_p,5}}
<0.13.0> : {initial_call,{erlang,apply,2}}
<0.14.0> : {initial_call,{erlang,apply,2}}
<0.15.0> : {initial_call,{erlang,apply,2}}
<0.16.0> : {initial_call,{proc_lib,init_p,5}}
<0.18.0> : {initial_call,{proc_lib,init_p,5}}
<0.19.0> : {initial_call,{proc_lib,init_p,5}}
<0.20.0> : {initial_call,{erlang,apply,2}}
<0.21.0> : {initial_call,{proc_lib,init_p,5}}
<0.22.0> : {initial_call,{standard_error,server,2}}
<0.23.0> : {initial_call,{proc_lib,init_p,5}}
<0.24.0> : {initial_call,{user_drv,server,2}}
<0.25.0> : {initial_call,{group,server,3}}
<0.26.0> : {initial_call,{group,server,3}}
<0.27.0> : {initial_call,{erlang,apply,2}}
<0.28.0> : {initial_call,{proc_lib,init_p,5}}
<0.29.0> : {initial_call,{proc_lib,init_p,5}}
<0.36.0> : {initial_call,{proc_lib,init_p,5}}
<0.37.0> : {initial_call,{application_master,start_it,4}}
<0.38.0> : {initial_call,{proc_lib,init_p,5}}
<0.39.0> : {initial_call,{proc_lib,init_p,5}}
<0.40.0> : {initial_call,{proc_lib,init_p,5}}
<0.41.0> : {initial_call,{proc_lib,init_p,5}}
<0.44.0> : {initial_call,{proc_lib,init_p,5}}
<0.45.0> : {initial_call,{proc_lib,init_p,5}}
<0.46.0> : {initial_call,{proc_lib,init_p,5}}
<0.47.0> : {initial_call,{proc_lib,init_p,5}}
<0.48.0> : {initial_call,{proc_lib,init_p,5}}
<0.49.0> : {initial_call,{proc_lib,init_p,5}}
<0.53.0> : {initial_call,{proc_lib,init_p,5}}
<0.54.0> : {initial_call,{proc_lib,init_p,5}}
<0.63.0> : {initial_call,{proc_lib,init_p,5}}
<0.65.0> : {initial_call,{proc_lib,init_p,5}}
<0.66.0> : {initial_call,{proc_lib,init_p,5}}
<0.67.0> : {initial_call,{proc_lib,init_p,5}}
<0.68.0> : {initial_call,{proc_lib,init_p,5}}
<0.69.0> : {initial_call,{proc_lib,init_p,5}}
<0.105.0> : {initial_call,{proc_lib,init_p,5}}
<0.106.0> : {initial_call,{application_master,start_it,4}}
<0.107.0> : {initial_call,{proc_lib,init_p,5}}
<0.108.0> : {initial_call,{proc_lib,init_p,5}}
<0.109.0> : {initial_call,{proc_lib,init_p,5}}
<0.110.0> : {initial_call,{proc_lib,init_p,5}}
<0.111.0> : {initial_call,{proc_lib,init_p,5}}
<0.112.0> : {initial_call,{proc_lib,init_p,5}}
<0.113.0> : {initial_call,{proc_lib,init_p,5}}
<0.114.0> : {initial_call,{proc_lib,init_p,5}}
<0.115.0> : {initial_call,{proc_lib,init_p,5}}
<0.117.0> : {initial_call,{proc_lib,init_p,5}}
<0.118.0> : {initial_call,{proc_lib,init_p,5}}
<0.119.0> : {initial_call,{proc_lib,init_p,5}}
<0.120.0> : {initial_call,{proc_lib,init_p,5}}
<0.121.0> : {initial_call,{proc_lib,init_p,5}}
<0.123.0> : {initial_call,{proc_lib,init_p,5}}
<0.124.0> : {initial_call,{proc_lib,init_p,5}}
<0.125.0> : {initial_call,{proc_lib,init_p,5}}
<0.126.0> : {initial_call,{proc_lib,init_p,5}}
<0.127.0> : {initial_call,{proc_lib,init_p,5}}
<0.129.0> : {initial_call,{proc_lib,init_p,5}}
<0.130.0> : {initial_call,{proc_lib,init_p,5}}
<0.131.0> : {initial_call,{proc_lib,init_p,5}}
<0.132.0> : {initial_call,{proc_lib,init_p,5}}
<0.133.0> : {initial_call,{proc_lib,init_p,5}}
<0.135.0> : {initial_call,{proc_lib,init_p,5}}
<0.136.0> : {initial_call,{proc_lib,init_p,5}}
<0.137.0> : {initial_call,{proc_lib,init_p,5}}
<0.138.0> : {initial_call,{proc_lib,init_p,5}}
<0.139.0> : {initial_call,{proc_lib,init_p,5}}
<0.140.0> : {initial_call,{proc_lib,init_p,5}}
<0.143.0> : {initial_call,{erlang,apply,2}}
<0.144.0> : {initial_call,{erlang,apply,2}}
[ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,ok,
 ok,ok,ok,ok,ok,ok,ok,ok,ok,ok|...] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:31:58.070

您可以使用 exit(Pid, Reason) 然后[os_cmd/1](http://www.erlang.org/doc/man/os.html#cmd-1)函数来执行您的命令。

如果要重启虚拟机，erl应该用-heart启动并使用init:reboot重启虚拟机

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T19:39:13.910

您可以使用该函数知道在虚拟机中运行的进程的 pid 是什么`erlang:processes()`。然后使用`erlang:process_info/1 or /2`您可以获得有关当前函数、初始调用者的信息...

例如从外壳调用，您可以打印：

```
1> [io:format("~p : ~p~n",[Pid,erlang:process_info(Pid,current_function)]) || Pid <- processes()].
<0.0.0> : {current_function,{init,loop,1}}
<0.3.0> : {current_function,{erl_prim_loader,loop,3}}
<0.5.0> : {current_function,{gen_event,fetch_msg,5}}
<0.6.0> : {current_function,{gen_server,loop,6}}
... 
```

或者：

```
2> [io:format("~p : ~p~n",[Pid,erlang:process_info(Pid,initial_call)]) || Pid <- processes()].    
<0.0.0> : {initial_call,{otp_ring0,start,2}}
<0.3.0> : {initial_call,{erlang,apply,2}}
<0.5.0> : {initial_call,{proc_lib,init_p,5}}
<0.6.0> : {initial_call,{erlang,apply,2}} 
```

如果您通过在正确的初始调用者上过滤杀死函数来替换 io:format/2 ，它就可以解决问题。

除此之外，我不完全明白你打算做什么。通常，如果一个进程被杀死，VM 不会停止，除非您为此编写一些代码（我从未尝试过，但它应该是可行的）。在这种情况下，您应该像@Vinod 所说的那样使用 opion -heart 和 init:reboot 重新启动 VM。

但是控制和重新启动进程的常用方法是在 VM 中使用主管树。然后，您可以调整重启策略以获得良好的可靠性和良好的服务。同样，正如@Vinod 所说，网站[learnyousomeerlang.com](http://learnyousomeerlang.com)是您的朋友。您将找到编写 OTP 兼容应用程序所需的几乎所有内容。**

# ios - 用户向下滚动时将大量数据加载到 iOS UITableView 的首选方式？

> ID：15026854
> 
> 赞同：2
> 
> 时间：2013-02-22T14:53:14.207
> 
> 标签：ios, objective-c, uitableview, lazy-loading

我有大约 5,000 个对象，我想将它们放入`UITableView`. 我目前正在通过一种机制来执行此操作，该机制从它们存储的数组中提取前 50 个，将它们复制到另一个数组，然后将该数组加载到 tableView 中。`willDisplayCell:forRowAtIndexPath`然后，当表格到达倒数第二个单元格时，我使用自动加载下一个 50。它通过跟踪它之前停止复制的位置来做到这一点，然后复制接下来的 50 个，然后重复该过程。

这提出了一个我还没有解决的问题：当我加载第三个 50 时，我应该卸载前 50 个。所以，我们从 0 到 50，然后从 50 到 100，然后从 100 到 150，然后那时，我需要删除 0-50。如果用户滚动回列表顶部，则需要再次加载前 50 个。基本上，该表在任何时候都不会超过 150 个条目，因此 0-150、或 50-200、或 100-250、或 150-300 等。

我想知道这是否是处理此类事情的最佳方式。当用户滚动到表格末尾时，减速没有问题，但我想知道异步加载数据之类的东西是否会更好？我对多线程真的很陌生，但如果它是一种更简单的方法，我很想尝试一下。

希望这是一个更加基于意见的问题不会成为问题，我意识到可能没有一个固定的答案，但如果我得到“不是一个真正的问题”，我的问题是：**上面描述的方法是最有效和最有效的吗？将大量数据逐渐加载到`UITableView`.**

编辑：我还要指出，绝大多数单元格不包含图像，它们只是几个`UILabel`实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:08:05.043

为什么要创建另一个数组？如果 5000 个对象已经在一个数组中，则浪费（恕我直言）复制其中的一部分并将其重新创建为表格单元格。它们已经在内存中了。所以在渲染单元之前是否需要进行一些转换？

如果数据已经在内存中，并且在数据和最终渲染之间完成的不是 CPU/IO 密集型任务，则进行异步加载不会有太大的不同。如果滚动感觉正确，那么我认为是尽可能快的。

另一件事是数据（构成原始阵列的数据）是否来自磁盘/网络或者是 CPU/密集型转换。那里是可以取得巨大收益的地方。

# android - Android 遍历所有首选项

> ID：15026855
> 
> 赞同：2
> 
> 时间：2013-02-22T14:53:16.410
> 
> 标签：android, iteration, preferences, flat

有没有办法迭代所有的偏好？
现在我正在询问每个偏好

```
private void doSomething( Preference p ) {
    if( p instanceof PreferenceCategory || p instanceof PreferenceScreen ) {
        PreferenceGroup pGroup = (PreferenceGroup) p;
        int pCount = pGroup.getPreferenceCount();
        for(int i = 0; i < pCount; i++) {
            doSomething(pGroup.getPreference(i)); // recursive call
        }
    } else {
        ... process single preference ...
    }
} 
```

我想这样做：

```
int pCount = getTotalPreferenceCount();
for(int i = 0; i < pCount; i++) {
    // process getFlatPreference(i);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T15:05:45.917

我不确定我是否看到您以这种方式进行迭代的问题，但如果您愿意，您可以实现以下内容

```
private void callingMethod(){
    ArrayList<Preference> list = getPreferenceList(prefScreen, new ArrayList<Preference>());
    for (Preference p : list) {
        doSomething(p);
    }
}

private ArrayList<Preference> getPreferenceList(Preference p, ArrayList<Preference> list) {
    if( p instanceof PreferenceCategory || p instanceof PreferenceScreen) {
        PreferenceGroup pGroup = (PreferenceGroup) p;
        int pCount = pGroup.getPreferenceCount();
        for(int i = 0; i < pCount; i++) {
            getPreferenceList(pGroup.getPreference(i), list); // recursive call
        }
    } else {
        list.add(p);
    }
    return list;
} 
```

这将允许您制作一个平面首选项列表，然后使用 foreach 循环遍历该列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-23T12:54:28.663

您也可以使用这种方法（PreferenceFragmentCompat 中的代码）：

```
for (String key : getPreferenceScreen().getSharedPreferences().getAll().keySet()) {
    Preference p = findPreference(key);
    if (p != null) //do smth with pref
} 
```

一些无用的迭代，但对我的项目来说不是问题

# c# - 日期时间格式转换

> ID：15026859
> 
> 赞同：0
> 
> 时间：2013-02-22T14:53:18.817
> 
> 标签：c#, datetime

在我的 c# 程序中，用户可以从 winforms 日期时间选择器中选择一个日期。这被命名为`dtpOutbox`。

这是我的代码：

```
DateTime selectedDate = dtpOutbox.Value.Date;
TimeSpan ts = new TimeSpan(23,59,59);
DateTime endOfSelectedDay = selectedDate + ts;

Console.WriteLine(selectedDate.ToString("yyyy-MM-dd hh:mm:ss"));
Console.WriteLine(endOfSelectedDay.ToString("yyyy-MM-dd hh:mm:ss")); 
```

现在，如果今天的日期是 2 月 22 日，我的理解是这应该输出（期望的输出）：

```
2013-02-22 00:00:00
2013-02-22 23:59:59 
```

但这种情况并非如此。我的输出是：

```
2013-02-22 12:00:00
2013-02-22 11:59:59 
```

我很确定这是一个格式问题，因为当我显示没有格式字符串的 DateTime 值 (selectedDate.ToString()) 时，它会正确显示 22/02/2013 00:00:00。但是，我需要格式为 22-02-2013 00:00:00 的日期。

任何想法为什么 C# 决定我的第一次约会将是中午，而我的第二次约会将是 11:59:59？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T14:54:37.970

`hh`是 12 小时时钟输出。

`HH`是 24 小时时钟输出。

您正在使用小写变体，但不输出 AM/PM 值。这可能是造成混乱的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T14:54:39.063

这就是您要查找的内容：

```
Console.WriteLine(selectedDate.ToString("yyyy-MM-dd HH:mm:ss")); 
```

对于 24 小时格式，请`HH`使用`hh`.

您可能想查看[自定义日期和时间格式文档](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。

# objective-c - 何时使用块？

> ID：15026861
> 
> 赞同：2
> 
> 时间：2013-02-22T14:53:35.193
> 
> 标签：objective-c, cocoa, objective-c-blocks

我们什么时候应该在我们的程序中使用可可块？

我知道一个块可以访问 ivars 和私有属性，并且可以像变量一样被调用/使用，并且比方法更快。我还看到苹果使用块对数组进行排序。但是我担心我们应该在什么要求下使用块？

请等待答复。

# git - 基于另一个分支创建 git 分支

> ID：15026864
> 
> 赞同：28
> 
> 时间：2013-02-22T14:53:46.057
> 
> 标签：git, git-branch

我想基于其他分支创建本地分支。例如我输入：

`git checkout -b feature1 release1.1.3`

之后我得到：

`fatal: git checkout: updating paths is incompatible with switching branches.`

这有什么问题？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2017-02-10T17:55:06.503

```
git branch <new-branch-name> <existing-branch-name> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-02-22T14:57:40.547

要基于另一个分支创建一个分支，最简单的方法是首先检出基础分支，然后从那里创建一个新分支。如果我正确理解您的问题，那正是您想要做的。

现在，当您`-b`在分支中使用标志时，您可能有想要保留的工作更改。如果是这种情况，您应该将它们推送到存储区，检查基本分支，创建新分支，然后弹出存储区。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-02-22T14:58:46.653

`git pull`首先确保所有本地分支机构都是最新的。然后你可以剪断树枝。

语法是

```
$ git checkout -b <branch> --track <remote>/<branch> 
```

或者

```
$ git checkout <remote>/<branch> -b <branch> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-22T14:57:11.870

您的意思是`git branch feature1 release1.1.3`假设您希望一个名为 feature1 的分支基于 release1.1.3 提交。您在那里调用的内容也应该有效，但您的工作树中还有一个名为“release1.1.3”的实际文件夹，git 对您是指分支/标签还是文件夹感到困惑。

您可以尝试仅提供 release1.1.3 的实际提交 ID。

# iphone - 如何仅在 iOS 应用程序上运行一次代码（甚至应用程序将被删除并重新安装）？

> ID：15026867
> 
> 赞同：1
> 
> 时间：2013-02-22T14:53:47.227
> 
> 标签：iphone, ios, ipad

如何仅在 iOS 应用程序上运行一次代码**（**甚至应用程序将被删除并重新安装）？

例如，我们需要为所有新用户制作礼物。但是，如果您使用它，则必须使用应用内购买再次购买。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T14:59:22.143

您可以在钥匙串中存储一个标志。即使在删除应用程序后，这种情况仍然存在于设备上。您还可以使用 iCloud 键值设置，该设置可用于控制同一帐户上的多个设备。

这是一个将信息（在这种情况下是用户是否购买了东西）添加到钥匙串并将其取回的示例。

```
 static NSString *kIAPKeyChainDescription =  @"MyAppPurchaseKey";

    static NSString *kPurchaseTag = @"YES";
    + (void)recordTransaction:(NSString *)productId
    {

        NSMutableDictionary* dict = [NSMutableDictionary dictionary];
        NSData *tag = [kPurchaseTag dataUsingEncoding:NSUTF8StringEncoding];

        [dict setObject: (id) kSecClassGenericPassword  forKey: (id) kSecClass];
        [dict setObject: kIAPKeyChainDescription forKey:(id) kSecAttrDescription];
        [dict setObject: productId      forKey: (id) kSecAttrService];
        [dict setObject: tag  forKey: (id) kSecValueData];

        OSStatus result = SecItemAdd ((CFDictionaryRef) dict, NULL);

        if (result != 0)
        NSLog(@"SecItemAdd error code is %ld",result);
    }

    + (BOOL)isPurchased:(NSString *)productId
    {
        NSMutableDictionary* query = [NSMutableDictionary dictionary];

        [query setObject: (id) kSecClassGenericPassword forKey: (id) kSecClass];
        [query setObject: productId forKey: (id) kSecAttrService];
        [query setObject:(id)kCFBooleanTrue forKey:(id)kSecReturnData];

        NSData* upgradeItemData = nil;
        OSStatus result = SecItemCopyMatching ( (CFDictionaryRef) query, (CFTypeRef*) &upgradeItemData );

        if (result != errSecSuccess && result != errSecItemNotFound){
            NSLog(@"SecItemCopyMatching errcode is %ld",result);
            return NO;
        }

        if ( !upgradeItemData || result == errSecItemNotFound)
        {
            return NO;
        }
        else
        {
            NSString* s = [[[NSString alloc] 
                            initWithData: upgradeItemData 
                    encoding: NSUTF8StringEncoding] autorelease];

            [upgradeItemData release];

            return [s boolValue];
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:57:10.960

你将不得不为它创建一个网络服务，我认为没有其他出路。保存设备令牌。

# android - 由于窗口管理器，旋转手机时应用程序崩溃

> ID：15026871
> 
> 赞同：0
> 
> 时间：2013-02-22T14:54:29.577
> 
> 标签：android, view

我的 andorid 应用程序在大多数情况下都可以正常工作，但有时会在手机旋转时崩溃，我得到下面的错误日志，我不明白。谁能解释为什么会这样？

这是错误日志：

```
02-22 14:44:52.175: D/AndroidRuntime(26784): Shutting down VM
02-22 14:44:52.175: W/dalvikvm(26784): threadid=1: thread exiting with uncaught exception (group=0x40e81300)
02-22 14:44:52.183: E/AndroidRuntime(26784): FATAL EXCEPTION: main
02-22 14:44:52.183: E/AndroidRuntime(26784): java.lang.IllegalArgumentException: View not attached to window manager
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.view.WindowManagerImpl.findViewLocked(WindowManagerImpl.java:653)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.view.WindowManagerImpl.removeView(WindowManagerImpl.java:349)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.view.WindowManagerImpl$CompatModeWrapper.removeView(WindowManagerImpl.java:160)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.app.Dialog.dismissDialog(Dialog.java:319)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.app.Dialog.dismiss(Dialog.java:302)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at com.example.chartviewer.JsonActivity$getChartItems.onPostExecute(JsonActivity.java:267)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at com.example.chartviewer.JsonActivity$getChartItems.onPostExecute(JsonActivity.java:1)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.os.AsyncTask.finish(AsyncTask.java:631)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.os.AsyncTask.access$600(AsyncTask.java:177)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.os.Looper.loop(Looper.java:137)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at android.app.ActivityThread.main(ActivityThread.java:4745)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at java.lang.reflect.Method.invokeNative(Native Method)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at java.lang.reflect.Method.invoke(Method.java:511)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-22 14:44:52.183: E/AndroidRuntime(26784):    at dalvik.system.NativeStart.main(Native Method) 
```

*更新*

这是 onPostExecuteMethod 的代码：

//当数据被获取时移除进度对话框

```
 protected void onPostExecute(String args) {
            progressDialog.dismiss();

            //Shows alert dialog if data is unavailable
            if(args != null && args.equals(noData)){

                 AlertDialog.Builder builder = new AlertDialog.Builder(JsonActivity.this);
                 builder.setIcon(R.drawable.artistlogo);
                 builder.setTitle("Musicmetric Charts");
                 builder.setMessage(noData);
                 builder.setOnCancelListener(new DialogInterface.OnCancelListener() {
                    @Override
                    public void onCancel(DialogInterface dialog) {
                        // finishes the activity and leads back to the list of charts 
                        JsonActivity.this.finish();

                    }

                });

                 AlertDialog alert = builder.create();
                 alert.show();

            }

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T14:59:28.703

这些是您的堆栈跟踪中的 2 条相关行：

```
com.example.chartviewer.JsonActivity$getChartItems.onPostExecute(JsonActivity.java:267) 
```

您已经实现了 AsyncTask 的 onPostExcecute 方法。此方法正在关闭一个对话框：

```
android.app.Dialog.dismiss(Dialog.java:302) 
```

当您旋转设备时，AsyncTask 会继续运行并尝试隐藏不再可见的对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:12:06.237

扩展ashtom的答案：尝试自己保持设备旋转：

```
 @Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
if(newConfig.equals(Configuration.ORIENTATION_LANDSCAPE)){
        // TODO
    }else if (newConfig.equals(Configuration.ORIENTATION_PORTRAIT)){
        // TODO
    }
} 
```

# facebook-graph-api - 检测 Facebook 帖子是否已被删除或具有较高的隐私设置

> ID：15026877
> 
> 赞同：1
> 
> 时间：2013-02-22T14:54:46.730
> 
> 标签：facebook-graph-api, facebook-page

我想通过 opengraph FB API 了解帖子是否被删除或具有高隐私设置。如果我向前面两个参数之一下的特定 post_id 发出请求，则响应类似于“不支持的获取请求”。

我的问题：有没有一种方法可以区分帖子是否存在（然后处于隐私设置下）或帖子是否不再存在（已删除）？

# c# - System.IndexOutOfRangeException c#

> ID：15026879
> 
> 赞同：-3
> 
> 时间：2013-02-22T14:54:47.870
> 
> 标签：c#, string

不知何故，这似乎在几年前起作用了；）或者我错过了什么？

帮助将提前获得。

```
else if (recStatus == 3)         
{
            ((TextBox)rref[1]).Text = read;

            //string readData = read;
            string[] readData = read.Split(new Char[] { ',' });

            //string[] readdata = read.Split(',');
            txtType.Text = readData[0];
            txtSerno.Text = readData[1]
            txtFirmware.Text = readData[2] + "." + readData[3];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:00:25.850

此代码中的 System.IndexOutOfRangeException 意味着 readData 的值小于 4，

你可以知道元素的数量

```
string[] readData = read.Split(new Char[] { ',' });
MessageBox.Show(readData.Length.ToString()); //you will found it less then 4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:10:13.917

我刚刚运行了您的示例，并且在控制台应用程序中没有出现错误（**这可能是因为您传递的文本放置了一个调试器并查看 ((TextBox)rref[1]).Text 上的实际文本** ）：

```
class Program
    {
        static void Main(string[] args)
        {
            string read = "A401,192,2,8" ;

            string[] readData = read.Split(new Char[] { ',' });

            //string[] readdata = read.Split(',');
            string a = readData[0];
            string b = readData[1] + "." + readData[2];
            string c = readData[3];

            Console.WriteLine(a + b + c);
        }
    } 
```

结果 ：

```
A401192.28
Press any key to continue . . . 
```

# c++ - 在 c++ Visual Studio 2010 中包括带有#ifdef 的附加库路径

> ID：15026885
> 
> 赞同：0
> 
> 时间：2013-02-22T14:55:05.547
> 
> 标签：c++, visual-studio-2010, linker, include

我在不同位置安装了 32 位和 64 位运行时库。库文件的名称相同。现在要制作一个 32 位应用程序，我需要为 64 位指定 32 位库路径和类似的东西。有没有办法做类似的事情

```
 #ifdef defined (_WIN64)
    include 64bit library path
  #else
    include 32bit library path
  #endif 
```

现在“#ifdef defined (_WIN64)”适用于 Windows 平台（我已经根据经验进行了检查）。从我的简单调查中，我了解到这可能不是确定目标应用程序是 64 位还是 32 位的最佳方法，但问题不在于这里。我想知道是否有办法让类似的条件语句适当地包含库路径。我正在使用 c++ Visual Studio 2010 在 Windows 中开发。在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:02:13.673

我同意更改库名称的评论，但要回答问题：[`#pragma comment`](http://msdn.microsoft.com/en-us/library/7f0aews7.aspx)用于指定[`/LIBPATH`](http://msdn.microsoft.com/en-us/library/1xhzskbe.aspx)：

```
#pragma comment(linker, "/LIBPATH:c:\\test\\") 
```

请注意，如果您更改库名称，您可以这样做：

```
#ifdef _WIN64
#pragma comment(lib, "mylib64.lib")
#else
#pragma comment(lib, "mylib32.lib")
#endif 
```

# asp.net-mvc - ModelState 验证不适用于 DropDownList 和嵌套对象

> ID：15026888
> 
> 赞同：4
> 
> 时间：2013-02-22T14:55:12.587
> 
> 标签：asp.net-mvc, asp.net-mvc-4, data-annotations

在我们的应用程序中，我们有一个域层，其中包含带有用于验证的 DataAnnotations 的类。

我们在 ASP.NET MVC ui 层的模型中使用这些类。

例如：

领域层：

```
public class Company
{
    public int Id { get; set; }

    [Required]
    [StringLength(50)]
    public string Description { get; set; }

    // ... some model logic abreviated
}

public class Supplier 
{
    public int Id { get; set; }

    [Required]
    public string Name { get; set; }

    [Required]
    public Company Company { get; set; }

    // ... some model logic abreviated
} 
```

在我们的 ASP.NET MVC 表示层中：

```
public class SupplierEditModel
{
    public Supplier Supplier { get; set; }
    public IEnumerable<Company> Company { get; set; }
    public int SelectedCompany { get; set; }

    // ... some model logic abreviated
} 
```

在这种情况下，我们有一个包含公司 DropDownList 的页面。该列表具有如下约束力：

```
@Html.DropDownListFor(m => m.SelectedCompany, new SelectList(Model.Companies, "Id", "Description", Model.SelectedCompany)) 
```

我们的问题出在控制器的 POST 方法上，当我们检查 ModelState.IsValid 时，模型无效，因为 Supplier.Company 为空。然后我们可以使用 SelectedCompany 获取公司，但我们的问题是这意味着我们不能做这样的事情：

```
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult Create(SupplierEditModel model)
{
    if (ModelState.IsValid)
    {
        model.CreateSupplier(_supplierService);
        return RedirectToAction("Index");
    }

    return RedirectToAction("Create");
} 
```

我们想在创建供应商之前使用验证。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T15:04:28.027

我看到你有（至少）两个选择：

`Supplier.Company`如果您的视图中不需要它，您可以展平您的视图模型并省略它。

```
public class SupplierEditModel
{
    public int SupplierId { get; set; }
    public string Name { get; set; }
    public Company Company { get; set; }
    public IEnumerable<Company> Company { get; set; }
    public int SelectedCompany { get; set; }

    // ... some model logic abreviated
} 
```

（注意：您的数据注释应该在视图模型上，而不是域模型上。）

或者

`ModelState`您可以在检查`IsValid`属性之前清除错误

```
ModelState.Remove(string key, ModelState); 
```

这里的最佳实践可能是使用扁平模型，原因有两个。第一，通常只发送视图需要的内容，仅此而已。如果视图没有对 Supplier.Company 做任何事情，那么它不应该是模型的一部分。第二，使用 ModelState.Remove 方法虽然有效，但可能被某些人认为有点笨拙。您可能会在代码审查中受到一些破坏；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T15:06:03.920

`Company`您可以在`ModelState`检查之前删除`IsValid`：`ModelState.Remove("Supplier.Company")`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-09-03T17:35:36.080

```
 public class OrderViewModel
    {
        [Display(Name = "Customer")]
        [Required(ErrorMessage = "Please select customer.", AllowEmptyStrings = false)]
        public string CustomerName { get; set; }

        public IEnumerable<CustomerViewModel> Customers { get; set; }
    }

   public class CustomerViewModel
    {
        public string CustomerID { get; set; }
        public string CompanyName { get; set; }
    }

     <div class="form-group">
        @Html.LabelFor(m => m.CustomerName, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.DropDownListFor(m => m.CustomerName, new SelectList(Model.Customers, "CustomerId", "CompanyName"), "- Please Select -", new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.CustomerName, null, new { @class = "text-danger" })
        </div>
    </div> 
```

# git - StreamReader 是否改变了我的行尾？

> ID：15026889
> 
> 赞同：1
> 
> 时间：2013-02-22T14:55:13.703
> 
> 标签：git, streamreader, line-endings

我注意到 GitHub for windows 报告了一些我认为不应该更改的文件。问题出现在我们的应用程序中读取的一些 .txt 文件中。运行程序后，报告所有读取的 .txt 文件的每一行结尾都加倍：例如：

```
Line1
Line2 
```

变成

```
Line1

Line2 
```

我有一种感觉，这与某些行尾问题有关，并且可能是 git 中的错误设置，所以我查看了显示所有字符的 Notepad++。在运行程序之前，文件如下所示：

```
Line1   CRLF
Line2   CRLF
Line3 
```

之后，它们变成：

```
Line1   CR
CRLF
Line2   CR
CRLF
Line3 
```

因此，GH4W 报告它们已更改似乎是正确的。问题是，他们不应该这样。我正在用这样的 StreamReader 阅读它们：

```
// ASCII.RodBarcodes holds path to RodBarcodes.txt
using (StreamReader sr = new StreamReader(ASCII.RodBarcodes))
        {
            int count = 0;
            string line = sr.ReadLine();
            while (line != null)
            {
                Rods.Add(new AnemometerRod());
                Rods[count].Barcode = line;
                line = sr.ReadLine();
                count++;
            }
        } 
```

这些额外的 CR 是从哪里来的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-03T17:18:23.183

既然这个问题得到了赞成，我想我最好自己回答。

`StreamReader`这个问题与（当然）无关。实际上发生的事情是，程序自动更新了来自网络共享的文件（我从别人那里接管了一个项目），其中行尾一团糟。从源头上修复它解决了这个问题。

# querydsl - QueryDSL 中的日期算术

> ID：15026895
> 
> 赞同：4
> 
> 时间：2013-02-22T14:55:29.033
> 
> 标签：querydsl

我想在 QueryDSL 中表达以下（Oracle）查询：

```
SELECT * FROM entity WHERE entity.created < (sysdate - entity.delayInDays) 
```

即我想做日期算术。不幸的是，a `com.mysema.query.types.path.DateTimePath`（由 返回`QEntity.entity.created`）不包含任何加法/减法方法，仅用于比较（如`before`or `gt`）。

我找到`com.mysema.query.types.Ops.DateTimeOps`了，但也没有什么可以帮助我。

我错过了什么还是 QueryDSL 不支持日期算术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T09:14:18.240

你说的对。目前 Querydsl 不支持日期算术，但请随时为其创建问题[https://github.com/mysema/querydsl/issues](https://github.com/mysema/querydsl/issues)

# sql-server-2008 - 将 varbinary(max) 列截断为指定长度

> ID：15026896
> 
> 赞同：0
> 
> 时间：2013-02-22T14:55:36.683
> 
> 标签：sql-server-2008, tsql, sql-server-2008-r2

我知道我可以使用

```
UPDATE table SET column = .WRITE (expression, @offset, @length) 
```

部分更新类型列的[成语](http://msdn.microsoft.com/en-us/library/ms177523.aspx)`varbinary(max)`。但是，我找不到有关如何设置现有 BLOB 长度的文档（即如何截断它）。

疯狂的猜测：`.WRITE (NULL, @offset, 0)`- 但是，即使这有效，这是否记录在案？

**编辑**：请注意，我对选择数据的一部分不感兴趣——我需要设置 BLOB 的长度，以便下一个`SELECT`将返回截断的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:48:12.507

经过一番仔细阅读，我在[文档](http://msdn.microsoft.com/en-us//library/ms177523.aspx)中找到了这段话：

> 如果*表达式*设置为`NULL`,`@Length`将被忽略，并且 in 的值在`column_name`指定的 处被截断`@Offset`。

疯狂的猜测似乎是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:41:39.620

这在 2008 R2 中对我有用：

```
update MyTable set MyColumn = cast(left(MyColumn, 100000000) as varbinary(max)) 
```

二进制数据和大数的使用似乎与[文档](http://msdn.microsoft.com/en-us/library/ms177601.aspx)不符。

如果我找到它们，我会更新更快的方法。

# ruby-on-rails - 如何让 Ambethia Recaptcha 与 simple_form .error_notification 一起使用？

> ID：15026897
> 
> 赞同：3
> 
> 时间：2013-02-22T14:55:44.313
> 
> 标签：ruby-on-rails, recaptcha, simple-form

我喜欢 simple_form 中的新 .error_notification 功能，但我不知道如何在其中包含我的 recaptcha。我的代码如下所示：

```
<%= simple_form_for(resource, :as => resource_name, :url =>      registration_path(resource_name)) do |f| %>
  <%= f.error_notification %>
  <div class="form-inputs">
    <%= f.input :email, :required => true, :autofocus => true %>
    <%= f.input :password, :required => true %>
    <%= recaptcha_tags %>
  </div>

  <div class="form-actions">
    <%= f.button :submit, "Sign up" %>
  </div>
<% end %> 
```

我想我需要以某种方式告诉 simple_form 更多关于 recaptcha 的信息，但我找不到太多关于 .error_notification 的信息。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-01T05:28:52.870

在控制器中：

```
unless verify_recaptcha
   @captcha_error="Word verification response is incorrect"
end 
```

鉴于：

```
<%= recaptcha_tags %>
<span class="help-block pull-left" style="color:#a94442;"><%=@captcha_error%></span> 
```

您可以使用变量来显示您的错误消息。

# android - Android中su二进制的suid标志

> ID：15026904
> 
> 赞同：1
> 
> 时间：2013-02-22T14:56:07.753
> 
> 标签：android, su, suid

在打包 system.img 文件之前，android 构建树的哪个脚本将“suid”标志赋予 su 二进制文件？我已经为“chmod +s”或“chmod 4”字符串“grepped”了，但现在没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T15:49:19.757

找到了解决方案。我正在搜索的文件是：

系统/核心/包含/私有/android_filesystem_config.h

Suid 二进制文件在“android_files”结构中定义。对于 su 二进制文件，有以下条目：

{ 06755, AID_ROOT, AID_ROOT, "system/xbin/su" },

# java - android sqlite - 没有这样的文件，没有这样的列

> ID：15026906
> 
> 赞同：0
> 
> 时间：2013-02-22T14:56:13.590
> 
> 标签：java, eclipse, sqlite

我的问题如下：

它是在控制台上写的。

```
[2013-02-24 14:30:40 - AdatBpro] Android Launch!
[2013-02-24 14:30:40 - AdatBpro] adb is running normally.
[2013-02-24 14:30:40 - AdatBpro] Performing hu.AB.example.adatbpro.MainActivity activity launch
[2013-02-24 14:30:40 - AdatBpro] Automatic Target Mode: Unable to detect device compatibility. Please select a target device.
[2013-02-24 14:30:47 - AdatBpro] Launch canceled!
[2013-02-24 14:31:04 - AdatBpro] emulator-5554 disconnected! Cancelling 'hu.AB.example.adatbpro.MainActivity activity launch'!
[2013-02-24 14:42:15 - AdatBpro] ------------------------------
[2013-02-24 14:42:15 - AdatBpro] Android Launch!
[2013-02-24 14:42:15 - AdatBpro] adb is running normally.
[2013-02-24 14:42:15 - AdatBpro] Performing hu.AB.example.adatbpro.MainActivity activity launch
[2013-02-24 14:42:16 - AdatBpro] Automatic Target Mode: launching new emulator with compatible AVD 'AVD412'
[2013-02-24 14:42:16 - AdatBpro] Launching a new emulator with Virtual Device 'AVD412'
[2013-02-24 14:42:16 - Emulator] WARNING: Data partition already in use. Changes will not persist!
[2013-02-24 14:42:16 - Emulator] WARNING: SD Card image already in use: C:\Users\Edit\.android\avd\AVD412.avd/sdcard.img
[2013-02-24 14:42:16 - Emulator] WARNING: Cache partition already in use. Changes will not persist!
[2013-02-24 14:42:16 - AdatBpro] New emulator found: emulator-5556
[2013-02-24 14:42:16 - AdatBpro] Waiting for HOME ('android.process.acore') to be launched...
[2013-02-24 14:43:32 - AdatBpro] HOME is up on device 'emulator-5556'
[2013-02-24 14:43:32 - AdatBpro] Uploading AdatBpro.apk onto device 'emulator-5556'
[2013-02-24 14:43:33 - AdatBpro] Installing AdatBpro.apk...
[2013-02-24 14:44:30 - AdatBpro] Success! 
```

程序正在运行并且数据库打开，但是当第一个模拟器什么也没写时。我再次尝试运行。第一个模拟器在那里打开并打开第二个模拟器并在第二个模拟器上写入所有内容。

它只在模拟器上制作。

它不在电话上运行。

为什么要做这个？我做错了什么？

我找不到解决方案。

公共类 DbConstants {

```
public static final String DATABASE_NAME = "tar.db";
public static final int DATABASE_VERSION = 1;
public static String DATABASE_CREATE_ALL = Todo.DATABASE_CREATE;
public static String DATABASE_DROP_ALL = Todo.DATABASE_DROP;

public static class Todo {
    // public static final String DATABASE_NAME = "data.db";
    public static final String DATABASE_TABLE = "todo";
    public static final String KEY_ROWID = "_id";
    public static final String KEY_KI = "ki";

    public static final String DATABASE_CREATE = "create table if not exists "
            + DATABASE_TABLE
            + "("
            + KEY_ROWID
            + " integer primary key autoincrement, "
            + KEY_KI
            + " text );";  

    public static final String DATABASE_DROP = "drop table if exists"
            + DATABASE_TABLE + "; ";

    private long id;
    private String ki;

    public Todo(String aKi)
    {

        ki = aKi;

    }

    @Override
    public String toString() {
        return ki;
    }

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getKi() {
        return ki;
    }

    public void setKi(String ki) {
        this.ki = ki;
    }

} 
```

}

公共类 MainActivity 扩展 ListActivity {

私有 TodoCursorAdapter 适配器；

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
//  setContentView(R.layout.activity_main);

    TodoDbLoader dbLoader = new TodoDbLoader(getApplicationContext());
    dbLoader.open();
    Cursor c = dbLoader.fetchAll();

    if (c.getCount() == 0) {
        dbLoader.createTodo(new Todo("ÉN"));
        dbLoader.createTodo(new Todo("Sári"));
        dbLoader.createTodo(new Todo("Saci"));

        c = dbLoader.fetchAll();
    }
    c.moveToFirst();
    Adapter = new TodoCursorAdapter(getApplicationContext(), c);
    setListAdapter(Adapter);
} 
```

}

公共类 DatabaseHelper 扩展 SQLiteOpenHelper {

```
public DatabaseHelper(Context context, String name){
    super(context, name, null, DbConstants.DATABASE_VERSION);
}

@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
    db.execSQL(DbConstants.DATABASE_CREATE_ALL);

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub
    db.execSQL(DbConstants.DATABASE_DROP_ALL);
    db.execSQL(DbConstants.DATABASE_CREATE_ALL);
} 
```

}

公共类 TodoDbLoader{

```
private Context ctx;
private DatabaseHelper dbHelper;
private SQLiteDatabase mDb;

public TodoDbLoader(Context ctx){
    this.ctx= ctx;
}
public void open()throws SQLException{
    dbHelper = new  DatabaseHelper(ctx,DbConstants.DATABASE_NAME);
    mDb = dbHelper.getWritableDatabase();
    dbHelper.onCreate(mDb);
}

public void close(){
    dbHelper.close();
}

public long createTodo(Todo todo){
    ContentValues values = new ContentValues();
    values.put(DbConstants.Todo.KEY_KI, todo.getKi());

    return mDb.insert(DbConstants.Todo.DATABASE_TABLE, null, values);
}

public boolean deleteTodo(long rowId){

    return mDb.delete(
            DbConstants.Todo.DATABASE_TABLE,
            DbConstants.Todo.KEY_ROWID + "=" + rowId, null) > 
    0;
}

public boolean deleteAllTodo(){
    return mDb.delete(DbConstants.Todo.DATABASE_TABLE , null, null) > 0;
}

public boolean updateProduct(long rowId, Todo newTodo){
    ContentValues values = new ContentValues();

    values.put(DbConstants.Todo.KEY_KI, newTodo.getKi());

    return mDb.update(DbConstants.Todo.DATABASE_TABLE,
            values,
            DbConstants.Todo.KEY_ROWID + "=" + rowId, null) > 
    0;
}

public Cursor fetchAll(){
    return mDb.query(DbConstants.Todo.DATABASE_TABLE, 
            new String[]{ DbConstants.Todo.KEY_ROWID,
            DbConstants.Todo.KEY_KI,
             }, null, null, null, null, DbConstants.Todo.KEY_KI);

}

public Todo fetchTodo(long rowId){
    Cursor c = mDb.query(DbConstants.Todo.DATABASE_TABLE, 
            new String[]{ DbConstants.Todo.KEY_ROWID,
            DbConstants.Todo.KEY_KI,
             },DbConstants.Todo.KEY_ROWID + "=" + rowId,
            null, null, null, DbConstants.Todo.KEY_KI);
    if (c.moveToFirst())
        return getTodoByCursor(c);
    return null;

}

public static Todo getTodoByCursor(Cursor c){
    return new Todo(                
            c.getString(c.getColumnIndex(DbConstants.Todo.KEY_KI)) 
            );
} 
```

}

公共类 TodoCursorAdapter 扩展 CursorAdapter {

```
public TodoCursorAdapter(Context context, Cursor c){
    super(context, c, false);
}

@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {

    final LayoutInflater inflater = LayoutInflater.from(context);
    View row = inflater.inflate(R.layout.todorow, null);
    bindView(row, context, cursor);
    return row;
}

@Override
public void bindView(View view, Context context, Cursor cursor) {

    TextView KiTV = (TextView) view.findViewById(R.id.textViewKi);

    Todo todo = TodoDbLoader.getTodoByCursor(cursor);

    KiTV.setText(todo.getKi());

}
@Override
public Todo getItem(int position) {
    getCursor().moveToPosition(position);

    return TodoDbLoader.getTodoByCursor(getCursor());
} 
```

}

# python - 将时间序列转换为数据帧，以便每一行都有相应的时间片

> ID：15026908
> 
> 赞同：1
> 
> 时间：2013-02-22T14:56:19.533
> 
> 标签：python, numpy, pandas

我有一个时间序列作为熊猫系列对象。我想知道我是否可以通过查看过去 60 天的值来预测一天的值。出于这个原因，我想将我的时间序列转换为如下所示的数据框（以便我可以将其提供给学习算法）；

```
Day 1    Day2     ... Day 60   value
986.55   990.95   ... 1618.86  1655.5
990.95   1017.85  ... 1655.5   1669.8
1017.85  1053.68  ... 1669.8   1707.2 
```

我该如何进行这种转换？

我的时间序列看起来像这样（索引是 pandas.tseries.index.DatetimeIndex）；

```
DATE
1991-01-02 986.55
1991-01-03 990.95
1991-01-04 1017.85
1991-01-05 1053.68 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:02:56.363

说`s`是你得到的系列。您可以通过日复一日地切片系列来从中创建一个 DataFrame：

```
df = pd.DataFrame([s[i:i+60].values for i in range(len(s)-60)]) 
```

然后重命名列：

```
df.columns=['Day '+str(i) for i in range(1,61)] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:14:00.857

```
doffset = pd.tseries.offsets.Day(60)

f = lambda x: pd.DataFrame(x.tolist()).T

pd.concat([f(df['value'].ix[i:i+doffset]) for i in df.index]) 
```

# android - 通过 ListItem 将数据发送到新 Intent - Android

> ID：15026909
> 
> 赞同：0
> 
> 时间：2013-02-22T14:56:19.017
> 
> 标签：android, android-intent, android-listview, android-activity

我使用 SimpleAdapter 从 MySQL 服务器在线获取数据，具有类似惰性列表的外观。在 ListItemClick 上，我想将信息发送到一个新活动，该活动将使用该数据（比如索引号）来显示特定结果，再次从 MySQL DB 获得。

由于列表是动态生成的，我需要一种将动态生成的数据发送到新活动的方法。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T16:53:49.050

如果您查看`OnItemSelected`这里有一个名为`long id`(last arg) 的东西的参数，则 id 是**`_id`**您在 SimpleCursorAdapter 中使用的 SqliteDB 表的。

因此，正如@Leondros 所提到的，您使用意图并使用 putExtra() 传递信息。

在这里，您将不得不使用解析来转换**`long _id`**为字符串，然后将其返回到您意图的接收方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:03:15.513

您已经设置了它，使用，您必须在侦听器的方法上`intent`发送它。`intent``onItemSelected``listview`

像这样：

```
Intent i = new Intent(this, YourActivity.class);
i.putExtra(name, yourId);
startActivity(i); 
```

并像这样在`onCreate`新的`activity`

```
Intent i = getIntent();
Bundle extras = i.getExtras();

if (extras != null) {
    int id = extras.getInt(name);
} 
```

# jquery - 表单提交未将自动填充值带到下一页

> ID：15026910
> 
> 赞同：1
> 
> 时间：2013-02-22T14:56:20.460
> 
> 标签：jquery, autocomplete

由于自动完成，我试图将搜索文本框的值带到下一页。但它只接受在搜索框中输入的值。

我正在使用的代码是：

```
function fill(thisValue) {
        var abc = $('#search').val(thisValue);
        alert(abc);
        $('#rad').show();
        setTimeout("$('#suggestions').hide();", 200);
        document.getElementById("Form1").submit();
    } 
```

html:

```
<form action="<?php echo $mainUrl?>/search" method="post" name="Form1" id="Form1" onsubmit="if( ( document.getElementById( 'search' ).value === '' ) || ( document.getElementById( 'search' ).value === 'Search billions of items at the single Platform' ) ){ document.getElementById( 'search' ).focus(); return false;};">
                <input type="text" name="search" placeholder="Search billions of items at the single Platform" id="search" onkeyup="lookup(this.value);" onblur="fill();" autocomplete='off' value="" />
                <input type="submit" name="submit_btn" value="search" class="button" id="button"   />
                <div class="suggestionsBox" id="suggestions" style="display: none;">
                <img src="<?php echo $mainUrl?>/resources/autocomplete/autoComplete/upArrow.png" style="position: relative; top: -12px; left: 30px;" alt="upArrow" />
                <div class="suggestionList" id="autoSuggestionsList">

and html

<input type="text" name="search" placeholder="Search billions of items at the single Platform" id="search" onkeyup="lookup(this.value);" onblur="fill();" autocomplete='off' value="" /> 
```

对此的任何建议将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:02:26.023

那是因为你在打电话`abc`。

如果你想提醒`thisValue`，那么你会这样写：

```
alert(thisValue); 
```

要将值带到下一页，您可以使用：

```
<form action="search.php" method="POST">
  <input type="text" name="search">`
  <input type="sbubmit" value="search">`
</form> 
```

并在搜索 PHP 中获取搜索值：

```
<?php
  $searchValue = $_POST["search"];`
  echo $searchValue;`
?> 
```

# javascript - 以异步方式设置函数参数

> ID：15026916
> 
> 赞同：0
> 
> 时间：2013-02-22T14:56:35.570
> 
> 标签：javascript, asynchronous

我有以下函数，我体验到函数启动有时在没有设置 params.name 的情况下被调用。我在异步函数方面不是那么强，所以我想知道这是否可能是因为 setName 在调用启动之前不一定返回？然后在初始化时将函数调用放在三元组中会有所帮助`self.params`吗？

```
projectLaunch: function(options) {
  var self = this;
  if (options.name === null || options.name === "undefined") {
    var name = self.setName();
  } else { 
    var name = options.name;
  };

   self.params = {
     name: name
   };
  launch(self.params);
},

setName = function() {
  return encodeBase64(User.name, Project.name)
} 
```

这都是一个更大对象的一部分，并且函数 projectLaunch 在外部被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T14:58:57.423

这里没有什么异步的（我没有你的实现，`encodeBase64`但我不明白为什么它会是异步的）。

但这不会将函数分配给任何名称，也不会调用它：

```
function(options) {
...
} 
```

所以`launch`不能从我们看到的代码中调用。

如果要制作[IIFE](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)，请将其修复为

```
(function(options) {
...
})({}); 
```

* * *

如果您期望 in 中的非空字符串`options.name`，使用传递的值或另一个值的最简单解决方案是：

```
var name = options.name || self.setName(); 
```

# c# - 在 .ashx 页面中使用文件的相对路径

> ID：15026919
> 
> 赞同：2
> 
> 时间：2013-02-22T14:56:44.073
> 
> 标签：c#, asp.net

双重道歉 - 首先，我对 ASP.net 完全陌生，所以我确信这是一个非常幼稚的问题，其次，看起来已经有一百个关于 ASP.NET 相对路径的问题。不幸的是 - 我找不到能回答我问题的人。

背景 - 我正在处理一个`.ashx`需要能够访问 Excel 文件的文件。

当我在本地运行并使用文件的绝对路径时，一切正常。这是我的代码：

```
<%@ WebHandler Language="C#" Class="MyHandler" %>
using System;
... [a bunch more "usings..."]
using Microsoft.Office.Interop.Excel;

public class MyHandler : IHttpHandler {
    public void ProcessRequest(HttpContext context) {
        string path = @"C:\Users\[...]\myExcelFile.xls";
        Workbook theWorkbook;
        Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();
        theWorkbook = app.Workbooks.Open(path); 
```

但是，我想在服务器上运行它，并使用`myExcelFile.xls`.

我的项目是这样设置的：

```
Main folder:
 - Default.aspx
 - myExcelFile.xls
 - Web.config
 - Global.asax
Styles folder
Scripts folder
Handler folder
 - MyHandler.ashx (that's reading the Excel File)
bin folder 
```

所以 - 您可以看到 Excel 文件位于应用程序的“根”中。

为了使路径相对，我尝试了以下方法但没有成功：

假设“相对”来自 myHandler.ashx：

```
string path = @"..\myExcelFile.xls": 
```

假设`~`指的是“根”：

```
string path = @"~\myExcelFile.xls"; 
```

只是猜测：

```
string path = @".\myExcelFile.xls"; 
```

简直绝望：

```
string path = "myExcelFile.xls"; 
```

这些都不起作用。

所以我在这里对 SO 做了一些研究，发现`System.IO.Path.GetFullPath`. 所以我尝试了：

```
string path = System.IO.Path.GetFullPath("myExcelFile.xls"); 
```

那没有用，但至少我可以看到的价值`path`是`C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\11.0\PinpointTool-DC.xls`

当然 - 我根本不明白 - 这条路离我的项目所在的地方很远（这意味着我不明白是什么`System.IO.Path.GetFullPath`......）

最后，我试过`Server.MapPath("myExcelFile.xls")`了，但这根本不起作用（至少在本地）：

```
Compiler Error Message: CS0103: The name 'Server' does not exist in the current context 
```

那么，我怎样才能让它工作（最好是在本地和服务器上？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T15:08:10.170

虽然您可以使用[`context.Server.MapPath`](https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcontext.server)，但您也可以使用您在该部分的“web.config”文件中定义的路径，`appSettings`并稍后在您的应用程序中阅读它：

网络配置：

```
...
<appSettings>
    <add key="myBasePath" value="C:\Some\Path" />
</appSettings>
... 
```

在您的 ASHX 处理程序中，您可以编写如下内容：

```
...
string path = Path.Combine(
    ConfigurationManager.AppSettings[@"myBasePath"],
    @"myExcelFile.xls");
... 
```

您可以（并且应该）为您的开发机器和生产环境使用不同的“web.config”文件。

对于第二[John Saunders](https://stackoverflow.com/questions/15026919/using-a-relative-path-to-a-file-in-an-ashx-page/15027125#comment21115757_15026919)关于**服务器上 Office 互操作**的评论，我强烈建议使用像

*   [Aspose.Cells](http://www.aspose.com/.net/excel-component.aspx)或
*   [Spire.XLS](http://www.e-iceblue.com/Introduce/excel-for-net-introduce.html)

我与他们两人都成功地合作过（不过是商业性的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T15:05:07.490

你有没有尝试过

```
System.IO.Path.Combine(HttpContext.Current.Server.MapPath("~/."),"myExcelFile.xls"); 
```

希望这会有所帮助

# javascript - Kendo Grid：触发更新点击回车键进行弹出编辑

> ID：15026920
> 
> 赞同：7
> 
> 时间：2013-02-22T14:56:45.820
> 
> 标签：javascript, kendo-ui, kendo-grid

我正在使用带有弹出编辑功能的 Kendo UI Grid。默认情况下，当用户在弹出编辑器中编辑字段并按回车键时，数据将呈现到网格（在弹出编辑器后面），但弹出窗口保持可见，并且在单击“更新”之前不会触发保存事件' 按钮。

我正在尝试更改该功能，以便当用户在编辑字段时按 Enter 键时，它会触发“更新”按钮单击 - 这意味着它将数据呈现到网格，触发保存事件并关闭弹出编辑器。

我当前的尝试只会关闭弹出编辑器，但不会触发保存事件并撤消对所选行的任何字段所做的更改。几乎就像触发了取消按钮一样。

```
options.edit = function (e) {
    $('.k-edit-field .k-input').on('keypress', function (e) {
        utils.onEnter(e, function () {
            $('.k-grid-update').trigger('click');
        });
    });
}; 
```

**如何触发“更新”按钮单击，或者至少模拟它的作用？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-25T18:43:05.033

我无法找到一个剑道方法来导致更改的字段变脏然后被保存，所以我使用了一个小 jQuery 并将焦点转移到更新按钮然后触发点击事件。按预期工作...

```
options.edit = function (e) {
    $('.k-edit-field .k-input').on('keypress', function (e) {
        utils.onEnter(e, function () {
            $('.k-grid-update').focus().trigger('click');

        });
    });
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T22:27:51.563

我建议使用[saveRow 方法](http://docs.kendoui.com/api/web/grid#saverow)来保存当前数据并关闭 PopUp 编辑器。

例如：

```
$("#grid").data("kendoGrid").saveRow(); 
```

# google-maps-sdk-ios - 如何在 iOS 的 google maps sdk 中使用位置设置中心地图视图

> ID：15026923
> 
> 赞同：3
> 
> 时间：2013-02-22T14:57:01.133
> 
> 标签：google-maps-sdk-ios

如何在 google maps sdk for iOS 中设置带有位置的中心地图视图？使用 mapkit，我们可以做 setCenter:Location。如何使用适用于 iOS 的 google maps sdk 执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T15:29:48.847

使用 GMSCameraPosition 构造函数创建一个新相机

`+ (GMSCameraPosition *)cameraWithTarget:(CLLocationCoordinate2D)target zoom:(CGFloat)zoom`

然后使用方法

```
- (void)animateToCameraPosition:(GMSCameraPosition *)cameraPosition; 
```

* * *

你也可以只使用

```
- (void)animateToLocation:(CLLocationCoordinate2D)location; 
```

但是如果您想更好地控制相机的最终外观，则前者允许您在相机构造函数中更改缩放、方位和视角。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T18:32:42.553

我使用这个辅助方法：

```
- (void)focusOnCoordinate:(CLLocationCoordinate2D) coordinate {
  [self.mapView animateToLocation:coordinate];
  [self.mapView animateToBearing:0];
  [self.mapView animateToViewingAngle:0];
  [self.mapView animateToZoom:ZOOM_LEVEL];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-12T00:14:20.310

正如我在上面的评论中所述，“动画...”解决方案不提供真正的中心（而是提供顶部中心），而“moveCamera：”确实提供了真正的中心（但不提供动画）。

我唯一的解决方法是在调用“moveCamera:”之后添加对“animateToZoom:”的调用。这提供了真正的中心，并为中心添加了一些“幻觉”动画。

```
[mapView moveCamera:[GMSCameraUpdate setTarget:marker.position]];
[mapView animateToZoom:zoom_marker_select]; 
```

更新：更优雅的动画解决方案，缩小，然后放大和真正的中心（在标记点击上）。

```
#define zoom_marker_select 17.0f

// GMSMapViewDelegate callback
- (BOOL)mapView:(GMSMapView *)mview didTapMarker:(GMSMarker *)marker
{    
   [self animateToCenterMarker:marker zoom:zoom_marker_select];

   // NO = should continue with its default selection behavior (ie. display info window)
   return NO;
}

// custom true center with animation function
- (void)animateToCenterMarker:(GMSMarker*)marker zoom:(float)zoom
{
    /*
     NOTE: '[mapView animateToLocation:marker.position]' (or others like it below)
        does NOT provide true center, they provide top center instead
        only found 'moveCamera:' to provide true center (but animation doesn't occur)
        - workaround: add call to 'animateToZoom:' right after 'moveCamera:' call
        - elegant workaround: zoom out, center, then zoom in (animation sequnce below)
     */
    //[mapView animateToLocation:marker.position];
    //[mapView animateToCameraPosition:marker.position];
    //[mapView animateWithCameraUpdate:[GMSCameraUpdate setTarget:marker.position]];

   [CATransaction begin];
      [CATransaction setAnimationDuration:0.5f];
      [CATransaction setCompletionBlock:^{

          // 2) move camera to true center:
          //     - without animation
          //     - while zoomed out
          [mapView moveCamera:[GMSCameraUpdate setTarget:marker.position]];

          [CATransaction begin];
              [CATransaction setAnimationDuration:0.5f];

              // 3) animate dur 0.5f:
              //     - zoom back in to desired level
              [mapView animateToZoom:zoom];
          [CATransaction commit];
      }];

      // 1) animate dur 0.5f:
      //     - zoom out to current zoom - 1
      //     - set location to top center of selected marker
      //     - set bearing to true north (if desired)
      float zoomout = mapView.camera.zoom -1;
      [mapView animateToZoom:zoomout];
      [mapView animateToLocation:marker.position];
      [mapView animateToBearing:0];
   [CATransaction commit];
} 
```

注意：如果您想设置自己的坐标，只需将 marker.position 替换为您自己的 CLLocationCoordinate2D

# c# - C# readonly vs Java final

> ID：15026924
> 
> 赞同：10
> 
> 时间：2013-02-22T14:57:01.747
> 
> 标签：c#, .net, clr, language-design, readonly

在 Java 中，`final`意味着一个变量只能被分配一次，但该分配可以发生在程序的任何地方。在 C# 中，`readonly`意味着只能在*构造函数*中分配字段，而 IMO 的用处明显减少。

众所周知，C# 深受 Java 设计的影响，但这种差异一直让我感到非常奇怪。有谁知道 CLR 中是否有**技术原因**导致 C#`readonly`与 Java 的行为不太有用`final`？

编辑：

回应评论；我想指出，我很清楚不变性的好处，而且我到处都在使用它。我认为`readonly`它不如 Java 有用，因为：

```
public class Foo 
{
    private readonly int _bar;

    Foo()
    {
        _bar = 5;
    }
} 
```

糟糕，我实际上需要在辅助方法中初始化该值！

```
public class Foo 
{
    private readonly int _bar;

    Foo()
    {
        initialize()
    }

    private void initialize()
    {
        _bar = 5; //Can't compile because of semantics of readonly
    }     
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-22T15:03:46.617

*的*行为有一个技术原因`readonly`：在创建的程序集的元数据中，该字段被标记为属性，该`initonly`属性将确保该字段不会在构造函数之外被修改。¹然而，虽然无法验证，但通过获取只读字段的地址，仍然可以更改其值。可验证的 IL 和 C# 不允许您这样做。

在编译时不可能对所有方法强制执行此操作，因为编译器必须分析调用方法的所有可能*顺序*。在运行时，如果它必须检查每个字段写入是否之前已写入，则可能会对 CLR 造成负担并对性能产生负面影响。相反，C# 和 CLR 只是不允许在任何地方为字段赋值，除非在构造函数的仔细分析范围内。

在我看来，这并没有`readonly`降低关键字的价值。*对于仅由构造函数*提供值的字段（例如创建列表或存储构造函数参数），我到处都使用它。C# 将确保我不会再更改该字段，确保我不会意外地将其设置为`null`或任何东西。

¹ ) 感谢 Eric Lippert 指出这一点。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-03-30T17:53:38.753

这是一个老问题，但我认为值得注意的是，这在 Java 15 中不起作用**：**

```
public class Main
{
   final int testInt;

   public Main()
   {
      init();
   }

   private void init() 
   {
      testInt = 3;
   }
} 
```

> java：变量testInt未在默认构造函数中初始化

所以看起来 C#`readonly`和 Java`final`的行为方式相同。

# vba - VBA OnError 异常处理不起作用

> ID：15026930
> 
> 赞同：1
> 
> 时间：2013-02-22T14:57:19.370
> 
> 标签：vba, excel

我的 VBA 中有以下示例代码。每当我遇到与系统相关的错误时，我想显示我自己的错误消息。但是下面的代码不起作用。

VBA 告诉

> 类型不匹配

我想

> 您好，您的日期无效

我的代码

```
Sub good()

Dim date_ As Date
date_ = "hello"

On Error GoTo Err1:

Err1:
    MsgBox "Hello your date is invalid"
    ' more code

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:59:30.357

您需要在发生错误*之前*`On Error`放置语句，通常在过程的最开始。将该语句视为一个指令，它告诉 VBA 如何处理过程中稍后遇到的任何错误。*`On Error`*

 *```
Sub good()

On Error GoTo Err1

Dim date_ As Date
date_ = "hello"

Exit Sub 'Make sure you include this so successful executions 
         'don't continue into the error block.

Err1:
    Select Case Err.Number
      Case 101 'Not the actual error number!
         MsgBox "Hello your date is invalid"
      Case 102 'Not the actual error number!
         MsgBox "Something else bad happened!"
      Case Else
         MsgBox "I don't know what happened - unexpected error!"
    End Select
    ' more code

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T15:01:27.050

您需要将`On Error`语句放在错误之前！

另外，不要忘记`Exit Sub`最后的，否则您的例程将始终运行错误代码：

```
Sub good()
    Dim date_ As Date

    On Error GoTo Err1:
    date_ = "hello"

    On Error Goto 0 'goes back to default, i.e. show debugger
    Exit Sub

Err1:
    MsgBox "Hello your date is invalid"
    ' more code

End Sub 
```

或者，您可以这样做

```
Sub good()
    Dim date_ As Date

    On Error Resume Next
    date_ = "hello"
    If Err.Number <> 0 Then
        MsgBox "Wrong type"
        Err.Clear
        Exit Sub
    End If

    On Error Goto 0

    ' more code

End Sub 
```

可以重复此方法以捕获单个错误...*

# android - 带有 HTML5 视频的 RTSP 流导致 Android 上的服务器死机错误 (100,0)

> ID：15026938
> 
> 赞同：4
> 
> 时间：2013-02-22T14:57:49.553
> 
> 标签：android, html, video-streaming, rtsp

我有一个非常简单的使用 Phonegap 构建的 Android 的 HTML5 视频流应用程序。我正在测试的设备是三星 Galaxy Tab 2。视频根本没有流式传输。我在 Eclipse Logcat 窗口中看到以下错误：

* * *

```
02-22 09:34:56.489: D/HTML5VideoView(6029): requestAudioFocus() called. proxy = Handler (android.webkit.HTML5VideoViewProxy) {4176a958}
02-22 09:34:56.489: D/HTML5VideoView(6029): requested AudioFocus. videoView = android.webkit.HTML5VideoFullScreen@416fbd50
02-22 09:34:56.512: V/MotionRecognitionManager(6029):   .registerListenerEvent : success. listener count = 0->1, motion_sensors=1, listener=android.webkit.HTML5VideoView$1@416fbdd0
02-22 09:35:04.504: E/MediaPlayer(6029): internal/external state mismatch corrected
02-22 09:35:04.504: W/IMediaDeathNotifier(6029): media server died
02-22 09:35:04.504: W/AudioSystem(6029): AudioFlinger server died!
02-22 09:35:04.504: E/MediaPlayer(6029): error (100, 0)
02-22 09:35:04.551: E/MediaPlayer(6029): Error (100,0)
*******************************************************************************************

Here's my HTML code and Javascript code:

  <script src="cordova-2.4.0.js"></script>
  <script>
     function onLoad(){
          document.addEventListener("deviceready", onDeviceReady, true);
     }
     function onDeviceReady(){
          navigator.notification.alert("PhoneGap is working!!");
     }
  </script>
  </head>
  <body onload="onLoad();">
       <h1>Digital Home HTML5 Video Streaming Test</h1>
       <video preload="metadata" src="rtsp://nnn.nnn.nnn.nnn/stream1" controls></video>
  </body> 
```

* * *

我想知道这是否是因为服务器在启动实际流之前发送了一个简短的介绍视频（或海报），而 Galaxy 选项卡将其解释为服务器已经死亡。我不知道应该为什么事件添加侦听器来处理这种行为。如果我为结束的事件添加一个侦听器，我可能最终会陷入无限循环？该流在 iPad 和我从 Android 市场下载的另一个 RTSP 播放器上运行良好。我错过了什么？

我可以用 VLC 播放流，所以 SDP 描述必须是好的

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-04T12:28:43.537

我认为问题在于 Html 5 视频目前不支持 rtsp 协议。就这么简单。

# objective-c - 在网络协议中使用的 NSString 中转义特殊字符的最佳方法

> ID：15026942
> 
> 赞同：0
> 
> 时间：2013-02-22T14:58:01.113
> 
> 标签：objective-c

我正在网络协议中构建一个字符串，我想转义我正在传输的键值对中的特殊字符。最好的方法是什么？

例如，在 URL 转义方案中，空格被替换为 %20。

所以有两个问题：

1）什么是最合适的转义方案（例如url转义）

2）如何执行实际的逃生？（例如 stringByAddingPercentEscapesUsingEncoding 如果 url 转义是最好的方案）

例如

```
metadata:key1=value1;key2=value2 
```

在这种情况下，我们希望转义将出现在键或值中的等号、冒号和分号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:03:03.293

如果你想删除所有 : ; = 那么你可以使用：

```
NSCharacterSet *yourCharacterSet = [NSCharacterSet characterSetWithCharactersInString:@";:="];
NSString *escapedString = [initialString stringByTrimmingCharactersInSet:yourCharacterSet]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:03:27.740

在构建字符串时，您必须分别调整每个键和值。

例如

```
NSMutableString *xmitText = [NSMutableString stringWithCapacity:100];

// for each key/value pair:
{
  NSString *key = ...
  key = [key stringByReplacingOccurrencesOfString:@"=" withString:@"\\="];
  key = [key stringByReplacingOccurrencesOfString:@":" withString:@"\\:"];
  key = [key stringByReplacingOccurrencesOfString:@";" withString:@"\\;"];

  // Same for value
  ...
  [xmitText appendFormat:@"%@=%@;", key, value];
} 
```

# android - android-应用程序/服务可见即使在应用程序关闭后仍在运行服务

> ID：15026949
> 
> 赞同：0
> 
> 时间：2013-02-22T14:58:41.157
> 
> 标签：android

我创建了一个运行活动和服务的 android 应用程序。

我已经在活动的 ondestroy() 函数中停止了服务。

但即使应用程序关闭并调用了 ondestroy()，该进程在设置 -> 应用程序 -> 运行服务中仍然可见。

我应该如何完全关闭它？

我用来启动服务的代码：

```
// initService is called from onCreate() in MainActivity
public void initService() {
    try {
        serviceConnection = new CallService();
        Intent serviceIntent = new Intent();
        serviceIntent.setClassName("com.example.working",
                com.example.working.MyService.class.getName());
        boolean ret = this.bindService(serviceIntent, serviceConnection,
                Context.BIND_AUTO_CREATE);
        Toast.makeText(MainActivity.this, "Service bound : " + ret,
                Toast.LENGTH_SHORT).show();         // Return true or false
    } catch (Exception e) {
        Toast.makeText(this, "initService(): " + e.toString(), Toast.LENGTH_SHORT)
                .show();
    }
}

class CallService implements ServiceConnection {
    @Override
    public void onServiceConnected(ComponentName name, IBinder boundInterface) {
        try {
            Toast.makeText(MainActivity.this, "Service Connected", Toast.LENGTH_SHORT)
                    .show();
            aidlObject = WorkingAidl.Stub.asInterface((IBinder) boundInterface);
        } catch (Exception e) {
            Toast.makeText(MainActivity.this, "onServiceConnected: " + e.toString(),
                    Toast.LENGTH_SHORT).show();
        }
    }

    @Override
    public void onServiceDisconnected(ComponentName paramComponentName) {
        aidlObject = null;
        Toast.makeText(MainActivity.this, "Service Disconnected", Toast.LENGTH_SHORT)
                .show();
    }
} 
```

谢谢

# cocos2d-x - Android chartboost cocos2d-x 集成

> ID：15026950
> 
> 赞同：1
> 
> 时间：2013-02-22T14:58:41.590
> 
> 标签：cocos2d-x, chartboost

我正在为我的项目使用 wenbin1988 教程 [chartboost cocos2d-x 集成]。我设法让项目为 ios 和 android 做好准备。chartboost 在 ios 中运行良好，但在 android 中存在问题。在 android 中调用了 chartboost，但没有打开窗口，也没有显示广告。eclipse中提到的错误是

02-22 19:35:44.520: D/PhoneWindow(18143): 无法保存哪个视图有焦点，因为焦点视图 org.cocos2dx.lib.Cocos2dxGLSurfaceView@463440b0 没有 id。

任何人都可以请帮助解决问题提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T13:42:50.167

在他们对 sdk 实现的帮助中，他们说在 Android 中，如果您使用的是 OpenGL（cocos2d-x 的情况），您需要设置：

```
cb.setImpressionsUseActivities(true); 
```

设置后，您还需要将以下代码放在 AndroidManifest 上：

```
<activity android:name="com.chartboost.sdk.CBImpressionActivity"
    android:excludeFromRecents="true"
    android:theme="@android:style/Theme.Translucent.NoTitleBar"/> 
```

希望这可以帮助。

# c# - HttpClient 请求类似浏览器

> ID：15026953
> 
> 赞同：31
> 
> 时间：2013-02-22T14:58:50.897
> 
> 标签：c#, windows-8, http-headers

当我通过 HttpClient 类调用网站 www.livescore.com 时，我总是收到错误“500”。可能服务器阻止了来自 HttpClients 的请求。

1）还有其他方法可以从网页获取html吗？

2）如何设置标题以获取 html 内容？

当我在浏览器中设置标题时，我总是会得到 stange 编码的内容。

```
 http_client.DefaultRequestHeaders.TryAddWithoutValidation("Accept", "text/html,application/xhtml+xml,application/xml");
    http_client.DefaultRequestHeaders.TryAddWithoutValidation("Accept-Encoding", "gzip, deflate");
    http_client.DefaultRequestHeaders.TryAddWithoutValidation("User-Agent", "Mozilla/5.0 (Windows NT 6.2; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0");
    http_client.DefaultRequestHeaders.TryAddWithoutValidation("Accept-Charset", "ISO-8859-1"); 
```

3）我怎样才能解决这个问题？有什么建议么？

我在 C# 和 HttpClientClass 中使用 Windows 8 Metro Style App

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-02-22T19:12:10.357

给你 - 注意你必须解压缩你得到的 gzip 编码结果[，按照](https://stackoverflow.com/a/15031419/3312) [mleroy](https://stackoverflow.com/users/470473/mleroy)：

```
private static readonly HttpClient _HttpClient = new HttpClient();

private static async Task<string> GetResponse(string url)
{
    using (var request = new HttpRequestMessage(HttpMethod.Get, new Uri(url)))
    {
        request.Headers.TryAddWithoutValidation("Accept", "text/html,application/xhtml+xml,application/xml");
        request.Headers.TryAddWithoutValidation("Accept-Encoding", "gzip, deflate");
        request.Headers.TryAddWithoutValidation("User-Agent", "Mozilla/5.0 (Windows NT 6.2; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0");
        request.Headers.TryAddWithoutValidation("Accept-Charset", "ISO-8859-1");

        using (var response = await _HttpClient.SendAsync(request).ConfigureAwait(false))
        {
            response.EnsureSuccessStatusCode();
            using (var responseStream = await response.Content.ReadAsStreamAsync().ConfigureAwait(false))
            using (var decompressedStream = new GZipStream(responseStream, CompressionMode.Decompress))
            using (var streamReader = new StreamReader(decompressedStream))
            {
                return await streamReader.ReadToEndAsync().ConfigureAwait(false);
            }
        }
    }
} 
```

像这样打电话：

```
var response = await GetResponse("http://www.livescore.com/").ConfigureAwait(false); // or var response = GetResponse("http://www.livescore.com/").Result; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-07-30T10:53:52.253

也可以尝试添加压缩支持：

```
var compressclient = new HttpClient(new HttpClientHandler() 
{ 
AutomaticDecompression = DecompressionMethods.Deflate | DecompressionMethods.GZip 
}); 
```

这也添加了标题。

根据 Windows Store 框架中的相同线程支持：http: [//social.msdn.microsoft.com/Forums/windowsapps/en-US/429bb65c-5f6b-42e0-840b-1f1ea3626a42/httpclient-data-compression-and -caching?prof=必需](http://social.msdn.microsoft.com/Forums/windowsapps/en-US/429bb65c-5f6b-42e0-840b-1f1ea3626a42/httpclient-data-compression-and-caching?prof=required)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-22T19:05:35.317

有几点需要注意。

1.  该站点要求您提供用户代理，否则它会返回 500 HTTP 错误。

2.  对 livecore.com 的 GET 请求以 302 响应 livecore.us。您需要处理重定向或直接请求 livecore.us

3.  您需要解压缩 gzip 压缩的响应

此代码使用 .NET 4 客户端配置文件，我会让您确定它是否适合 Windows 应用商店应用程序。

```
var request = (HttpWebRequest)HttpWebRequest.Create("http://www.livescore.com");
request.AllowAutoRedirect = true;
request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.57 Safari/537.17";

string content;

using (var response = (HttpWebResponse)request.GetResponse())
using (var decompressedStream = new GZipStream(response.GetResponseStream(), CompressionMode.Decompress))
using (var streamReader = new StreamReader(decompressedStream))
{
    content = streamReader.ReadToEnd();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T15:13:54.830

我认为你可以很确定他们已经尽一切努力阻止开发人员进行屏幕抓取。

如果我使用以下代码从标准 C# 项目中尝试：

```
 var request = WebRequest.Create("http://www.livescore.com ");
  var response = request.GetResponse(); 
```

我得到这个回应：

```
The remote server returned an error: (403) Forbidden. 
```

# .net - 即使 Outlook 关闭也发送 Outlook MailItem

> ID：15026961
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:11.620
> 
> 标签：.net, outlook, office-interop, office-2010

我有一个 .NET 应用程序，它允许用户单击一个按钮，该按钮将在 Outlook 中启动一条新的预填充消息。这在大多数情况下都很好用，只有一个小例外。如果用户在发送邮件时没有打开 Outlook，则邮件将进入他们的发件箱，直到他们实际启动 Outlook 主应用程序。只有这样，发送/接收才会真正发生。

这是我用来创建的代码片段`MailItem`：

```
Dim mailItem As Outlook.MailItem = Me.OutlookApplication.CreateItem(Outlook.OlItemType.olMailItem)
mailItem.To = "test@test.com"
mailItem.Subject = "Some Subject"
mailItem.HTMLBody = "Some Text"
mailItem.Display(False) 
```

我也加入了`ItemSend`事件`Outlook.Application`，所以我可以看到当用户从 中单击`Send`时`MailItem`，Outlook 成功引发了事件。

如果用户启动邮件时 Outlook 未运行，则会生成一个新的 OUTLOOK.EXE 进程。无论哪种情况，系统托盘中都会出现一个图标，表示 Outlook 已连接到外部应用程序。

我是否可以使用 Interop 以某种方式触发发送/接收，这样我就可以确保发送消息而无需用户单独打开 Outlook？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:47:37.030

尝试使用 Namespace.SendAndReceive

请记住，消息提交是异步的，因此您需要保持 Outlook.Application 处于活动状态，直到发送/接收完成。

# mysql - mysql 如果没有记录

> ID：15026962
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:12.460
> 
> 标签：mysql

我有这样的查询；

```
select value, date from table
where date in ('date1','date2','date3','date4','date5')
group by date 
```

仅当存在具有给定日期的记录时才会给出结果。但我想得到一个“0”值的行，即使没有给定日期之一的记录。我怎样才能做到这一点？

```
5 | 02/04/2012
8 | 02/05/2012
3 | 02/06/2012
4 | 02/08/2012 
```

>

```
5 | 02/04/2012
8 | 02/05/2012
3 | 02/06/2012
0 | 02/07/2012
4 | 02/08/2012 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:01:06.433

您需要使用日期表，或创建带有日期的临时表。但是，日期表将是您的最佳选择，因为它体积小且效率高。

您也错误地使用`GROUP BY`. 请阅读[MySQL Extensions to GROUP BY](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)。

# c# - 托管在远程服务器 jQuery Mobile MVC 上时，表单字段值未绑定到模型

> ID：15026963
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:15.127
> 
> 标签：c#, asp.net-mvc, jquery-mobile, asp.net-mvc-4

我的 jQuery mobile \ MVC 应用程序有一个稍微奇怪的问题，到目前为止我无法追踪。

在我看来，我有 2 个 HTML.HiddenFor 字段。当表单发布时，这些字段中的值将绑定到我的控制器中的模型类的属性。属性是 Double 类型。在我的本地开发机器上发布表单时，值绑定正常。但是，当我的应用程序部署到远程服务器时，模型绑定停止工作，让它再次工作的唯一方法是将属性类型从 Double 更改为字符串。

这是我的模型：-

```
 public class HomeViewModel
{
    public Double Latitude                  { get; set; }   //form value binds locally but does not bind on remote server
    public Double Longitude                 { get; set; }   //form value binds locally but does not bind on remote server
    public string LatitudeStr               { get; set; }   //form value binds 
    public string LongitudeStr              { get; set; }   //form value binds 
```

这是我的看法：-

```
 @using (Html.BeginForm("Index","Branches", FormMethod.Post, new { ID = "frmSearch", data_transition = "none" })){       
   @Html.HiddenFor(model => model.Latitude, new { id = "hdnLat" })  
   @Html.HiddenFor(model => model.Longitude, new { id = "hdnLong" }) 
```

这是我的控制器：-

```
 [HttpPost]
    public ActionResult Index(HomeViewModel model)
    { 
```

当我在提交表单后检查页面时，我可以看到 input-validation-error 类已附加到隐藏元素：

查看 Firebug 中的发布信息，我可以看到已发布值。

以上在本地工作正常，但不能从远程服务器运行。

据我所见，在本地和远程运行时，完全相同的值会发回服务器

如果有人能对此有所了解，那就太好了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T18:00:34.507

包括隐藏字段的验证器。您可能会收到您不知道的验证消息，或者将验证摘要设置为显示模型错误。在服务器上的文化与使用逗号作为分隔符的客户端发生冲突之前，我在浮动方面遇到了类似的问题，这可能就是为什么它作为字符串工作的原因，因为它在解析 Double 时不再失败。

# javascript - 2 个或更多 AJAX 请求

> ID：15026966
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:24.537
> 
> 标签：javascript, ajax

我使用 ajax 从 xml 获取数据。当我只使用一个 ajax 请求时它工作..当我添加第二个请求时，第一个请求停止工作..？为什么？有查询限制吗？

请求1（r1.php）

```
 downloadUrl("gxml.php", function(data) {
        var xml = data.responseXML;
        var markers = xml.documentElement.getElementsByTagName("marker");
        for (var i = 0; i < markers.length; i++) {

     function bindInfoWindow(marker, map, infoWindow, html, category) {
      google.maps.event.addListener(marker, 'click', function() {

       infoWindow.setContent(html);
        infoWindow.open(map, marker);

      });
    }
}
}
/**********************  ***************************************/
 function downloadUrl(url, callback) {
      var request = window.ActiveXObject ?
          new ActiveXObject('Microsoft.XMLHTTP') :
          new XMLHttpRequest;

      request.onreadystatechange = function() {
        if (request.readyState == 4) {
          request.onreadystatechange = doNothing;
          callback(request, request.status);
        }
      };
      request.open('GET', url, true);
      request.send(null);
    } 
```

请求2（r2.php）

```
/**
* Returns an XMLHttp instance to use for asynchronous
* downloading. This method will never throw an exception, but will
* return NULL if the browser does not support XmlHttp for any reason.
* @return {XMLHttpRequest|Null}
*/
function createXmlHttpRequest() {
 try {
   if (typeof ActiveXObject != 'undefined') {
     return new ActiveXObject('Microsoft.XMLHTTP');
   } else if (window["XMLHttpRequest"]) {
     return new XMLHttpRequest();
   }
 } catch (e) {
   changeStatus(e);
 }
 return null;
};

/**
* This functions wraps XMLHttpRequest open/send function.
* It lets you specify a URL and will call the callback if
* it gets a status code of 200.
* @param {String} url The URL to retrieve
* @param {Function} callback The function to call once retrieved.
*/
function downloadUrl(url, callback) {
 var status = -1;
 var request = createXmlHttpRequest();
 if (!request) {
   return false;
 }

 request.onreadystatechange = function() {
   if (request.readyState == 4) {
     try {
       status = request.status;
     } catch (e) {
       // Usually indicates request timed out in FF.
     }
     if ((status == 200) || (status == 0)) {
       callback(request.responseText, request.status);
       request.onreadystatechange = function() {};
     }
   }
 }
 request.open('GET', url, true);
 try {
   request.send(null);
 } catch (e) {
   changeStatus(e);
 }
};

/**
 * Parses the given XML string and returns the parsed document in a
 * DOM data structure. This function will return an empty DOM node if
 * XML parsing is not supported in this browser.
 * @param {string} str XML string.
 * @return {Element|Document} DOM.
 */
function xmlParse(str) {
  if (typeof ActiveXObject != 'undefined' && typeof GetObject != 'undefined') {
    var doc = new ActiveXObject('Microsoft.XMLDOM');
    doc.loadXML(str);
    return doc;
  }

  if (typeof DOMParser != 'undefined') {
    return (new DOMParser()).parseFromString(str, 'text/xml');
  }

  return createElement('div', null);
}

/**
 * Appends a JavaScript file to the page.
 * @param {string} url
 */
function downloadScript(url) {
  var script = document.createElement('script');
  script.src = url;
  document.body.appendChild(script);
} 
```

# jquery - JQuery YouTube 播放器 - 多个播放列表

> ID：15026971
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:32.403
> 
> 标签：jquery, css, youtube, youtube-api

我正在使用以下 jQuery YouTube 播放器将多个 YouTube 播放列表加载到视频播放器中。

[jQuery YouTube 播放器](http://badsyntax.github.com/jquery-youtube-player/examples/player-multiple-playlists.html)

它允许我在播放列表之间切换，并加载该播放列表中的第一个视频 - 但是，当我从该播放列表中选择不同的视频时，它不会响应/加载视频。

我的页面和原始页面之间唯一真正的区别是我使用的是 .php 页面而不是 .html。

[我的页面](http://www.carefusion-products.com/videos/index.php)

我怎样才能让它发挥应有的作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:12:39.667

Ive found the answer - there has been an update to the original JS which solves the problem. [https://github.com/badsyntax/jquery-youtube-player/blob/9730f872f80b7796d6634fa6380dd5b521f00805/js/jquery.youtube.player.js](https://github.com/badsyntax/jquery-youtube-player/blob/9730f872f80b7796d6634fa6380dd5b521f00805/js/jquery.youtube.player.js)

# c# - this.dispatcher.invoke() 不适用于多线程？

> ID：15026974
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:41.070
> 
> 标签：c#, wpf, multithreading

我再次遇到此错误：调用线程无法访问此对象，因为不同的线程拥有它。

这是我的代码：

```
 public void InitiateSignalAnalysisPlot()
        {
            if (_nActiveChannel > 0)    // timeDomainPlotter init
            {
                _dataX = new List<double[]>();
                _dataY = new List<double[]>();

                _dataX3 = new List<List<double[]>>();
                _dataY3 = new List<List<double[]>>();

                double[] dataXOneCh = new double[1];
                double[] dataYOneCh = new double[1];

                dataXOneCh[0] = 0;
                dataYOneCh[0] = 0;

                CirclePointMarker pm = new CirclePointMarker { Size = 5, Fill = Brushes.Transparent };

                for (int i = 0; i < _nActiveChannel; i++)
                {
                    if (_nActiveStatsOneChannel > 0)
                    {
                        for (int j = 0; j < _nActiveStatsOneChannel; j++)
                        {
                            _dataX.Add(dataXOneCh);    // data x-y mapping init
                            _dataY.Add(dataYOneCh);

                            EnumerableDataSource<double> xOneCh = new EnumerableDataSource<double>(dataXOneCh);
                            EnumerableDataSource<double> yOneCh = new EnumerableDataSource<double>(dataYOneCh);

                            xOneCh.SetXMapping(xVal => xVal);
                            yOneCh.SetXMapping(yVal => yVal);

                            CompositeDataSource dsOneCh = new CompositeDataSource(xOneCh, yOneCh);

                            Action InitiatePlotter = delegate()
                            {
                                LineAndMarker<MarkerPointsGraph> lam = timeDomainPlotter.AddLineGraph(dsOneCh,
                                                                                       new Pen(pm.Fill, 2),
                                                                                       pm,
                                                                                       new PenDescription("C" + Convert.ToString(i) + "S" + Convert.ToString(j)));
                            };

                            this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, InitiatePlotter);
                        }

                        _dataX3.Add(_dataX);
                        _dataY3.Add(_dataY);
                    }
                }

                timeDomainPlotter.FitToView();
            }
            else
            {
                return;
            }
        } 
```

错误发生在`"this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, InitiatePlotter);"` 这是由主窗口线程调用的 WPF 窗口后面的一段代码。我很困惑我使用 dispatcher.invoke() 来取消这个多线程冲突，为什么我仍然收到这个错误？如果我将这段代码放入被调用窗口的构造函数中，它可以工作，但我只是不想那样做。我可以做些什么改变来避免这个错误？谢谢。

可能有帮助的更多信息：timeDomainPlotter 在 wpf 窗口 B 中，它在窗口 A 中启动 (WindowB _windowB = new WindowB(); )；上面的代码 InitiateSignalAnalysisPlot() 也在窗口 B 中，但在窗口 A 中调用了 InitiateSignalAnalysisPlot()，类似于 _windowB,InitiateSignalAnalysisPlot();

如果我不 Dispatcher.Invoke() 它，也会有一个异常，即`The calling thread must be STA, because many UI components require this.`发生在

```
LineAndMarker<MarkerPointsGraph> lam = timeDomainPlotter.AddLineGraph(dsOneCh,
                                                                                       new Pen(pm.Fill, 2),
                                                                                       pm,
                                                                                       new PenDescription("C" + Convert.ToString(i) + "S" + Convert.ToString(j))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:26:09.363

你在哪里*创建*timeDomainPlotter？

在不同线程上创建的控件具有不同的 Dispatcher。我的猜测是您遇到此错误是因为您正在通过“this.Dispatcher”调用您的委托，但是您在该委托中触摸的控件是在不同的线程上创建的，因此具有不同的调度程序'这'。

如果它在不同的线程上，也许您可​​以为创建设置一个委托并通过 this.Dispatcher 调用该委托，然后控件将在您稍后尝试访问它的同一线程上创建。

# css - twitter为什么要实现这样的全屏图片

> ID：15026975
> 
> 赞同：7
> 
> 时间：2013-02-22T14:59:49.280
> 
> 标签：css

在 twitter 的首页有一个全屏图像。在源代码中，他们做了这样的事情：

HTML：

```
<div class="front-bg">
<img class="front-image" src="xxx.jpg">
</div> 
```

CSS：

```
.front-bg {
position: fixed;
width: 200%;
height: 200%;
left: -50%;
}
.front-bg img {
margin: auto;
min-width: 50%;
min-height: 50%;
top: 0;
left: 0;
right: 0;
bottom: 0;
} 
```

为什么他们将 top/left 属性设置为“.front-bg img”？如果我改变这样的事情：

```
.front-bg {
position: fixed;
width: 100%;
height: 100%;
}
.front-bg img {
min-width: 100%;
min-height: 100%;
} 
```

它也有效。为什么他们将宽度设置为 200% 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:14:20.383

> {顶部：0；左：0；右：0；底部：0；}

这部分根本没有在桌面上使用，因为这个图像没有设置位置属性，也许它在不同的设备上使用了额外的媒体查询？

我想说 200%/200% 和定位边距背后的原因必须与图像居中的首选方式有关。使用 %100/%100 场景图像将始终与较小屏幕上的浏览器窗口的左边框对齐。通过应用

> 边距：0 自动；最小宽度：50%；

它们使其与浏览器窗口一样宽并且始终居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:04:21.577

我认为这是为了考虑具有不同纵横比的不同屏幕，因此无论屏幕是纵向还是横向，图片的中心始终居中并且边缘有足够的“备用”。

# facebook-opengraph - URLmyurl 处的 Opengaph 对象无效，因为配置的 ':mycustomobject' 的 'og:type' 无效

> ID：15026976
> 
> 赞同：0
> 
> 时间：2013-02-22T14:59:54.503
> 
> 标签：facebook-opengraph

我在同一个域上托管了 3 个应用程序。每个应用程序都是不同的游戏。我只是使用不同的狂欢节网址 www.mywebsite.fr/fb/game.php?gameid={1-2-3}

为了测试 opengraph，我创建了 2 个自定义打开图形操作：连接到对象 Game 的 Win 和 Play

对于第一个应用程序确定没有问题的行动和故事正确发布。对象 Game 的 url 是 www.mywebsite.fr/fb/opengraph.php?gameid=1 我这样称呼它：

```
try{
    $response = $facebook->api(
     'me/myappname:play',
      'POST',
      array(
        'game' => 'www.mywebsite.fr/fb/opengraph.php?gameid=1'
      )
    );
} catch (FacebookApiException $e) {
        error_log($e);
    } 
```

现在我尝试对其他 2 个应用程序执行完全相同的操作，但我得到：

例外：URL ' [https://apps.facebook.com/myapp/](https://apps.facebook.com/myapp/) ' 的对象无效，因为配置的 ':game' 的 'og:type' 无效。

对象游戏的 url 是 www.mywebsite.fr/fb/opengraph.php?gameid=2 和 www.mywebsite.fr/fb/opengraph.php?gameid=3

我将对象 url 传递到调试工具中，一切都很好，响应代码 206 所有属性和 opengraph 信息都是正确的。

有任何想法吗 ？

# mysql - 如何在函数查询中设置返回值

> ID：15026977
> 
> 赞同：0
> 
> 时间：2013-02-22T15:00:01.473
> 
> 标签：mysql

在这里，我使用 mysql 函数进行了货币转换。请在下面，

```
CREATE  FUNCTION anycurrency_inr(book_id INT,pub_id INT) RETURNS DOUBLE
DETERMINISTIC
BEGIN
DECLARE publisher_currency VARCHAR(60);
DECLARE org_amount DOUBLE;
DECLARE inr_amount DOUBLE;
DECLARE convert_base DOUBLE;
DECLARE convert_current DOUBLE;
 select publishers.currency into publisher_currency from publishers,books where    publishers.user_id=pub_id and books.id=book_id;
select publisher_currency into org_amount from books where user_id=pub_id;
IF (publisher_currency ='inr_price') THEN
set inr_amount=org_amount;
ELSE
select base_value into convert_base from currencys where base_currency='publisher_currency';
select current_value into convert_current from currencys where base_currency='publisher_currency';
set inr_amount=org_amount * (convert_current/convert_base);
RETURN inr_amount;
END IF;
END 
```

上面的发布者表将货币值返回到 publisher_currency 中，它可能是（inr_price 或 doller_price 或 pound_price 或 euro_price），我的疑问是如何在另一个查询中传递返回值。在这里，我在货币表中传递 publisher_currency 值。它显示错误，因为结果包含多于一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:05:51.470

抛出此错误是因为您的请求返回了不止一行：

```
select base_value into convert_base from currencys where base_currency='publisher_currency'; 
```

`convert_base`并且不可能在变量中插入多个值

# asp.net - 用户名没有进入数据库

> ID：15026979
> 
> 赞同：1
> 
> 时间：2013-02-22T15:00:15.777
> 
> 标签：asp.net

我正在使用以下内容将当前用户名存储在一个变量中，该变量传递给我的存储过程，然后传递给我的数据库。这是通过单击按钮启动的。

```
string UserName = Page.User.Identity.Name.ToString(); 
```

使用以下命令发送变量：

```
cmd.Parameters.AddWithValue("@UserName", UserName); 
```

我在 Web Developer 2008 Express 中创建了一个 Web 表单，当我在 Web Developer 中显示浏览器时，我得到了想要的结果。当我从运行在 Mac 上的本机浏览器 (Firefox) 运行网页时，我什么也得不到。Web Developer 在 Windows 2008 Server 安装上运行。我需要为 Mac 做一些不同的事情吗？我将有大多数用户使用 Mac 而不是 Windows。

这是来自 aspx.cs 的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;
using System.Data.SqlClient;

namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void GridView1_SelectedIndexChanged(object sender, EventArgs e)
        {

        }

        protected void MasterData_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
        {

        }

        protected void btnUpdate_Click(object sender, EventArgs e)
        {

            using (SqlConnection con = new SqlConnection("server=(local);database=InvoiceSHC;Trusted_Connection=Yes"))
            {

                // Get the UserId of the logged in user 

                string UserName = HttpContext.Current.User.Identity.Name.ToString();
                string Timestamp = DateTime.Now.ToString();
                //Not sure why you need a SqlDataAdapter unused here.
                //SqlDataAdapter DA = new SqlDataAdapter("UpdateSHCInvoice", con);
                SqlCommand cmd = new SqlCommand("UpdateSHCInvoice", con);
                cmd.CommandType = CommandType.StoredProcedure;

                cmd.Parameters.AddWithValue("@Ref", dlRef.SelectedItem.Value);
                cmd.Parameters.AddWithValue("@PhaseName", dlPhase.SelectedItem.Value);
                cmd.Parameters.AddWithValue("@PageType", dlPageType.SelectedItem.Value);
                cmd.Parameters.AddWithValue("@Page", tbPage.Text);
                cmd.Parameters.AddWithValue("@Percent", dlPercent.SelectedItem.Value);
                cmd.Parameters.AddWithValue("@ChngType", dlChngType.SelectedItem.Value);
                cmd.Parameters.AddWithValue("@UserName", UserName);
                cmd.Parameters.AddWithValue("@Timestamp",Timestamp);
                con.Open();
                cmd.ExecuteNonQuery();

                GridView1.DataBind();

            }

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:29:08.383

我认为用户在从另一台计算机上的浏览器访问页面时*未*通过身份验证，但在从服务器访问时*已通过身份验证。*您可以通过像这样设置用户名来确定这一点：

```
string UserName = "";
if(HttpContext.Current.User.Identity.IsAuthenticated)
{
    UserName = HttpContext.Current.User.Identity.Name.ToString();
}
else
{
    UserName = "UnauthenticatedUser";
} 
```

如果我是正确的，那么您需要仔细检查您的身份验证程序（web.config 等）。如果您有任何问题，请立即告诉我。

# javascript - 单击时将文本插入 ul li

> ID：15026985
> 
> 赞同：0
> 
> 时间：2013-02-22T15:00:31.137
> 
> 标签：javascript, jquery

我是 javascript/jquery 的新手，可能需要一些帮助。当我单击测试按钮时，一个新`ul`的包含 an 的`li`内容将附加到正文中，并带有输入字段的值。单击`li`元素时，应将其删除。如果里面没有任何东西`ul`，也应该将其删除。如何使代码创建一次无序列表然后`li`在里面插入？`li`另外，当我点击它们时，我应该如何继续删除它们？

这是我现在的代码：

```
<input type="text" value="" id="text" />
<input type="button" id="test" value="Test" /> 
```

```
$(document).ready(function(){
    $("#test").click(function(){
        var t = document.getElementById("text").value;
        var UL = document.createElement('ul')
        var LI = document.createElement('li')
        $(UL).attr('id','main-list').appendTo(body)
        $(LI).appendTo("#main-list").text(t)
    });
    $("ul#main-list li").click(function(){
        $(this).remove()
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:03:12.657

你需要一种不同的选择器。

```
$(document).ready(function () {
    i = 0;
    $("#test").click(function () {
        var t = $('#text').val();
        var UL = document.createElement('ul');
        var LI = document.createElement('li');
        $(UL).attr('id', 'main-list' + i).appendTo('body');
        $(LI).text(t).appendTo("#main-list"+i);
        i++;
    });
    $(document).on('click', "ul li", function () {
        $(this).remove();
    });
}); 
```

* * *

它被称为[委托事件](http://api.jquery.com/on#direct-and-delegated-events)。我不知道确切的名字。

工作小提琴[链接](http://jsfiddle.net/DTGZL/)。

## 编辑

`id`必须是唯一的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:27:43.700

只需一个小改动就足够了：

```
$("body").on("ul#main-list li", 'click', function(){
    $(this).remove()
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T15:25:02.890

正如 Dream Eater 提到的，您需要使用添加单击事件，`on`除非您每次添加 LI 时都将添加单击处理程序。

要完成剩下的问题，您需要做一些事情。

如果要在列表为空时也将其删除，则不能盲目地删除列表项。为此，您需要在每次单击项目时检查列表中剩余的项目数。如果只有一个，那么您需要删除列表以及单击中的项目。

此外，如果您要在每次单击测试按钮时创建一个新列表，则您拥有正确的脚本，但听起来您希望拥有一个列表。为此，您需要在创建列表之前检查列表是否存在。

最后我修改了你的代码以利用 jQuery 方法的语法优势，我想出了这个：

```
$(document).ready(function(){
    $("#test").click(function(){
        var t = $('#text').val();
        var LI = $('<li/>');

        if($('#main-list').length == 0){
            var UL = $('<ul/>');
            UL.attr('id','main-list');
            $('body').append(UL)
        }
        LI.text(t).appendTo('#main-list');
        LI.appendTo("#main-list").text(t);
    });
    $(document).on('click', "#main-list li", function(){
        if($('#main-list').children('li').length ==1)
        {
            $(this).remove();
            $('#main-list').remove();
        }else{
            $(this).remove();
        }
    });
}); 
```

[这个例子](http://jsfiddle.net/vnjTs/1/)演示了它是如何工作的。通过在每次单击按钮时首先检查列表是否存在，您只会得到一个列表。通过在单击一个项目时检查列表中是否只有一个 LI，您可以轻松捕获“删除最后一个项目”单击。

我在这里建议的最后一件事是在文本框的值为空时[添加一些错误捕获。](http://jsfiddle.net/vnjTs/2/)

# list - Symfony 的选择列表作为 ul 在使用 twig 的视图中

> ID：15026989
> 
> 赞同：1
> 
> 时间：2013-02-22T15:00:42.757
> 
> 标签：list, symfony, twig, choice

我通常像这样将用户可选择的属性映射到相应的类

```
class Person {
  /**
   * @ORM\ManyToMany(targetEntity="HobbyClass")
   */
   private $hobby
}

class HobbyClass{
   private $name; // e.g. "Outdoors"
} 
```

要创建或编辑实体，我只需在表单中使用实体类型表单字段。然后，当我需要用 twig 显示实体视图时，我只需这样做：

```
 {% for item in person.hobby %}
        <li>{{ item.name }}</li> {# e.g. "Outdoors" #}
    {% endfor %} 
```

但是这次我使用了实现 ChoiceListInterface 的类 Selectables

```
class Entity {
   /**
    * @var array
    */
    private $properties
}

class Selectables implements ChoiceListInterface {
  ...
} 
```

然后我使用选择类型表单字段创建和编辑这个实体当然在树枝中我得到了键，而不是像以前那样的属性名称

```
 {% for item in entity.properties %}
        <li>{{ item }}</li> {#e.g. "property_key", whereas its name is "Sports"#}
    {% endfor %} 
```

问题是数据只是一个仅在表单中有意义的键数组。但我需要在实体视图中显示它是人类可读的。

使用 ChoiceListInterface 的原因是选择列表不会用 CRUD 更新，我可以在代码中维护它。使用起来会花费更少的精力，并且不需要连接和数据库表。

什么是最好的解决方案：

*   一个。像以前一样使用表和关联
*   湾。代码自定义树枝扩展，它将从 ChoiceListInterface 类中获取相应的值
*   C。使用选择列表并使键可翻译，以便它们显示为属性名称
*   d。还要别的吗

谢谢

# java - Java后台线程

> ID：15026996
> 
> 赞同：0
> 
> 时间：2013-02-22T15:01:10.897
> 
> 标签：java, multithreading

我想知道如何最好地实现背景来执行某些任务。根据任务中的某些条件，它将结束并返回调用者的状态。此外，当该后台线程正在运行时，它不应阻止调用者线程等待其完成。我已经尝试过 FutureTask，但它会同步执行所有操作。

请极客帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:14:52.773

正如@Gray 建议的那样，做研究可能是最好的选择。查看[Fork/Join Framework](http://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html)或[其他一些 Executor Services](http://docs.oracle.com/javase/tutorial/essential/concurrency/exinter.html)。如果不了解更多关于你在做什么的信息，就很难就什么是合适的提供更好的建议。

[这](https://stackoverflow.com/questions/452391/recommended-books-on-concurrency-synchronization-mechanisms)也给出了一些从哪里开始的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:21:34.767

这是一个非常简单的双线程示例。您应该能够对其进行修改以执行几乎任何您需要的操作。我会使用队列来返回您的结果。查看消费者如何`poll`排队，您可以在主线程中执行此操作以等待线程的结果。

```
public class TwoThreads {
  public static void main(String args[]) throws InterruptedException {
    System.out.println("TwoThreads:Test");
    new Test().test();
  }
  // The end of the list.
  private static final Integer End = -1;

  static class Producer implements Runnable {
    final Queue<Integer> queue;
    private int i = 0;

    public Producer(Queue<Integer> queue) {
      this.queue = queue;
    }

    @Override
    public void run() {
      try {
        for (int i = 0; i < 1000; i++) {
          queue.add(i++);
          Thread.sleep(1);
        }
        // Finish the queue.
        queue.add(End);
      } catch (InterruptedException ex) {
        // Just exit.
      }
    }
  }

  static class Consumer implements Runnable {
    final Queue<Integer> queue;
    private int i = 0;

    public Consumer(Queue<Integer> queue) {
      this.queue = queue;
    }

    @Override
    public void run() {
      boolean ended = false;
      while (!ended) {
        Integer i = queue.poll();
        if (i != null) {
          ended = i == End;
          System.out.println(i);
        }
      }
    }
  }

  public void test() throws InterruptedException {
    Queue queue = new LinkedBlockingQueue();
    Thread pt = new Thread(new Producer(queue));
    Thread ct = new Thread(new Consumer(queue));
    // Start it all going.
    pt.start();
    ct.start();
    // Wait for it to finish.
    pt.join();
    ct.join();
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T15:19:51.503

您可以使用执行器（自 java 1.5 起） [http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Executors.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Executors.html)

```
Executor executor= Executors.newSingleThreadExecutor();
Future<ReturnType> future = executor.sumbit(new MyCallable<ReturnType>());

// new thread running...
// .......

// synchronize/join.....
executor.shutdown();
executor.awaitTermination(30, TimeUnit.MINUTES);

// also you can do... (Get --> Waits if necessary for the computation to complete, and then retrieves its result.)
ReturnType myreturn = future.get(); 
```

# html - 使用 css3 的页面分割动画

> ID：15026997
> 
> 赞同：0
> 
> 时间：2013-02-22T15:01:11.667
> 
> 标签：html, css, animation, slice, divide

我正在研究我的投资组合，我想到了一把剑将我的 div/page 切成两半，然后露出下面的东西（见图：D）。但我不能让它动画，除了当我使用从左到右滑动的图像时..（这是一个很大的图像并且弄乱了我的网站）所以我想知道是否有任何方法可以做这个或者如果我应该把这个想法冲进马桶。

在此处查看图片：http: [//jvansuchtelen.nl/image.png](http://jvansuchtelen.nl/image.png)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:21:07.280

可以办到。看看我[的 Scriptaculous (2006) 的“wipes”插件，](http://preview.moveable.com/jm/jameslab/wipe/)了解一些想法。您可以使用 CSS 背景并将其定位在一堆克隆的 DIV 中，然后您可以移动 DIV，就好像它们真的是大像素一样。

# mysql - MySQL根据关键词选择文本片段

> ID：15026998
> 
> 赞同：0
> 
> 时间：2013-02-22T15:01:13.607
> 
> 标签：mysql

我有一个查询根据与搜索词的相关性提取搜索结果：

```
SELECT *, 
( (1.3 * (MATCH(strTitle) AGAINST ('+john+smith' IN BOOLEAN MODE))) + (0.6 * (MATCH(txtContent) AGAINST ('+john+smith' IN BOOLEAN MODE)))) AS relevance 
FROM content 
WHERE (MATCH(strTitle,txtContent) AGAINST ('+john+smith' IN BOOLEAN MODE) ) 
ORDER BY relevance DESC 
```

我还希望能够从描述中提取搜索匹配的第一个实例。因此，如果搜索“john smith”，我希望我的结果显示如下：

> **页面标题 1 ...与john smith**匹配的片段...
> 
> 页面标题 2 ...片段**约翰**匹配....
> 
> 页面标题 3 ....匹配**john的片段****smith** ...

 **等等等等

这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:04:51.910

您可以使用 case 语句执行此操作：

```
select *,
       ( (1.3 * (MATCH(strTitle) AGAINST ('+john+smith' IN BOOLEAN MODE))) + (0.6 * (MATCH(txtContent) AGAINST ('+john+smith' IN BOOLEAN MODE)))) AS relevance,
      (case when MATCH(strTitle) AGAINST ('+john+smith' IN BOOLEAN MODE)) > 0
            then 'snippet matching +john+smith'
            . . .
       end) 
```

就个人而言，我会将匹配项作为单独的变量放在子查询中：

```
select
from (select t.*,
             MATCH(strTitle) AGAINST ('+john+smith' IN BOOLEAN MODE)) as match_join_smith,
             . . .
      from t
     ) t 
```

然后将这些变量用于外部查询中的逻辑。**

# symfony - 缺少 Symfony2 Nginx 和 PHP-FPM 的堆栈跟踪

> ID：15026999
> 
> 赞同：4
> 
> 时间：2013-02-22T15:01:13.023
> 
> 标签：symfony, nginx, php

我最近从 Apache/fastCgi 切换到 Nginx/FPM 配置。到目前为止一切正常，除了 Symfony2 Stack 跟踪。

当我使用 Nginx 时，我得到正常的错误输出。当我使用 Apache 时，我得到了 Symfony2 的美化 StackTrace 输出。由于缺少 StackTrace，我的开发人员开始对我大发雷霆。我查看了我能想象到的每个配置文件（php.ini、vhost 配置、fpm 配置），似乎没有错误。也许你们中的一些人可以给我一个提示。

Nginx-Vhost 配置：

```
 server {
    listen 80;
    root /var/www/mirco/htdocs/public/sp2/web;
    server_name api.sp2.mirco.esg.com;
    error_log /var/www/mirco/logs/error-sp_api.log;
    access_log /var/www/mirco/logs/access-sp_api.log;

    # strip api.php/ prefix if it is present
    rewrite ^/api\.php/?(.*)$ /$1 permanent;

    # remove trailing slashes
    rewrite ^/(.*)/$ /$1 permanent;

    location / {
        index api.php;
        try_files $uri @rewriteapp;
    }

    location @rewriteapp {
        rewrite ^(.*)$ /api.php/$1 last;
    }

    location ~ ^/(t|api|api_dev)\.php(/|$) {
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        fastcgi_pass unix:/var/run/php-fpm.mirco.sock;

        fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
        fastcgi_param  SYMFONY_ENV        api_mirco;
        include fastcgi_params;
    }
   } 
```

Nginx-主配置

```
 user www-data;
  worker_processes 4;
  pid /var/run/nginx.pid;

  events {
        worker_connections 768;
        # multi_accept on;
  }

http {

        ##
        # Basic Settings
        ##

        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
        keepalive_timeout 300;
        types_hash_max_size 2048;
        # server_tokens off;

        # server_names_hash_bucket_size 64;
        # server_name_in_redirect off;

        include /etc/nginx/mime.types;
        default_type application/octet-stream;

        ##
        # Logging Settings
        ##

        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;
        rewrite_log on;

        ##
        # Gzip Settings
        ##

        gzip on;
        gzip_disable "msie6";

        # gzip_vary on;
        # gzip_proxied any;
        # gzip_comp_level 6;
        # gzip_buffers 16 8k;
        # gzip_http_version 1.1;
        # gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;

        ##
        # nginx-naxsi config
        ##
        # Uncomment it if you installed nginx-naxsi
        ##

        #include /etc/nginx/naxsi_core.rules;

        ##
        # nginx-passenger config
        ##
        # Uncomment it if you installed nginx-passenger
        ##

        #passenger_root /usr;
        #passenger_ruby /usr/bin/ruby;

  perl_modules perl/lib;

  perl_set $uri_lowercase 'sub {
  my $r = shift;
  my $uri = $r->uri;
  $uri = lc($uri);
  return $uri;
  }';

        ##
        # Virtual Host Configs
        ##

        include /etc/nginx/conf.d/*.conf;
        include /etc/nginx/sites-enabled/*;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T07:32:39.413

检查这个： [http ://wiki.nginx.org/Symfony](http://wiki.nginx.org/Symfony)

并可能尝试改变这一点：

```
ini_set('display_errors', 'On'); 
```

最好还是在 php.ini 中更改它