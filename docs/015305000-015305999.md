# StackOverflow 问答 15305000-15305999

# c++ - 看似无关的代码更改会产生不同的结果

> ID：15305001
> 
> 赞同：-7
> 
> 时间：2013-03-08T23:20:50.737
> 
> 标签：c++, g++

gnu 编译器，从命令行运行，使用没有 mods 的 sublime text 2。

显示递归函数的运行时间的简单程序，该函数采用 5000 索引数组，随机数在 0 和 1 之间均匀分布，并将它们相加（这意味着您应该在 2500 的球场某处得到一个值）。下面的代码始终可以正常工作，并产生相当接近预期值的东西。但是，在其中一个 couts 中添加一个新行/选项卡，一切都会在手提篮中陷入困境（见下文）。

```
#include <iostream>
#include <stdlib.h>
#include <time.h>
using namespace std;

double sumOfRandomNumbers(double arrayToFill[], int lengthOfArray){
    if(lengthOfArray == 0) return arrayToFill[lengthOfArray];
    return arrayToFill[lengthOfArray] + sumOfRandomNumbers(arrayToFill, lengthOfArray - 1);
}

double seconds(){return double(clock())/CLOCKS_PER_SEC;}

int main(){

    int sizeOfArray = 5000;
    double sum = 0.0, deltaT = 0.0, array[sizeOfArray];
    srand(time(NULL));

    for(int i = 0; i < sizeOfArray; i++) array[i] = double(rand())/double(RAND_MAX);

    cout << "\nRecursive Method\n";
    deltaT = seconds();
    for (int i = 0; i < 100000; i++){
        sum = sumOfRandomNumbers(array, sizeOfArray);
        if (i%10000 == 0) cout << i/1000 << " percent complete\n";
    }
    deltaT = seconds() - deltaT;
    cout << "\n\n\t\tRecursive method found sum to be " << sum;
    cout << "\n\t\tThis recursive calc took " << deltaT << " seconds to run.\n";

} 
```

输出

```
Recursive Method
0 percent complete
10 percent complete
20 percent complete
30 percent complete
40 percent complete
50 percent complete
60 percent complete
70 percent complete
80 percent complete
90 percent complete

                Recursive method found sum to be 2466.4
                This recursive calc took 12.226 seconds to run. 
```

这是更新后的代码，其中的更新与编译时完全相同。请注意奇怪的输出。我已将添加的代码加粗。如果它没有出现或很难看到，这就是变化

从

```
if (i%10000 == 0) cout << i/1000 << " percent complete\n"; 
```

至

```
if (i%10000 == 0) cout << "\n\t" << i/1000 << " percent complete\n"; 
```

..................................................... …………………………………………………………………………………………………………

```
#include <iostream>
#include <stdlib.h>
#include <time.h>
using namespace std;

double sumOfRandomNumbers(double arrayToFill[], int lengthOfArray){
    if(lengthOfArray == 0) return arrayToFill[lengthOfArray];
    return arrayToFill[lengthOfArray] + sumOfRandomNumbers(arrayToFill, lengthOfArray - 1);
}

double seconds(){return double(clock())/CLOCKS_PER_SEC;}

int main(){

    int sizeOfArray = 5000;
    double sum = 0.0, deltaT = 0.0, array[sizeOfArray];
    srand(time(NULL));

    for(int i = 0; i < sizeOfArray; i++) array[i] = double(rand())/double(RAND_MAX);

    cout << "\nRecursive Method\n";
    deltaT = seconds();
    for (int i = 0; i < 100000; i++){
        sum = sumOfRandomNumbers(array, sizeOfArray);
        if (i%10000 == 0) cout << "\n\t" << i/1000 << " percent complete\n";
    }
    deltaT = seconds() - deltaT;
    cout << "\n\n\t\tRecursive method found sum to be " << sum;
    cout << "\n\t\tThis recursive calc took " << deltaT << " seconds to run.\n";

} 
```

输出

```
Recursive Method

        0 percent complete

        10 percent complete

        20 percent complete

        30 percent complete

        40 percent complete

        50 percent complete

        60 percent complete

        70 percent complete

        80 percent complete

        90 percent complete

                Recursive method found sum to be 1.15021e+257
                This recursive calc took 12.262 seconds to run. 
```

注意我们是如何从一个非常合理的 2466.4 变成一个完全荒谬的 1.15 x 10^257。没有进行其他更改，即使经过数十次运行，这些数字也非常典型，您在上面看到的代码就是编译和运行的确切代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:25:34.283

您在此处拥有越界访问权限：

```
double sumOfRandomNumbers(double arrayToFill[], int lengthOfArray){
    if (lengthOfArray == 0) return arrayToFill[lengthOfArray];
    //                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
    return arrayToFill[lengthOfArray] + 
    //     ^^^^^^^^^^^^^^^^^^^^^^^^^^
           sumOfRandomNumbers(arrayToFill, lengthOfArray - 1);
} 
```

这会在您的程序中注入**[未定义的行为。](http://blog.regehr.org/archives/213)**当你的程序有未定义的行为时，一切都可能发生，包括有时程序[似乎运行得很好](http://liveworkspace.org/code/3FDYza%2446)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:27:14.563

您正在阅读 void memory ( `arrayToFill[lengthOfArray]`)。这是未定义的行为，所以它会变得很糟糕。也许你碰巧碰到了控制台的内存，谁知道呢。无论确切原因是什么，这都不是编译器中的错误。这是您的代码中的错误。

更新：

为了提供更多详细信息，因为`array`是堆栈中的最后一项，所以当应用程序启动时，超出它的内存通常不会被使用并且初始化为零（操作系统为安全而做的事情；确保您无法读取任何可能的旧密码例如，已被另一个程序留下）。

但是，如果调用另一个具有局部变量的函数，它将在该空间中放置一个值（不会被清除；您永远不应该访问它，并且操作系统不在乎您是否阅读*自己的*密码）。

可能是 cout 的`<<`运算符有一些内部条件，有时将它的第一个局部变量设置为非零值。也许第一个变量是`bool beganWithNewline`（人为的！），它将您读取的元素的第一个字节`1`设置为分数部分，但你明白了）。

# c++ - 让 DLL 调用带有函数指针的 exe 函数

> ID：15305002
> 
> 赞同：2
> 
> 时间：2013-03-08T23:20:53.937
> 
> 标签：c++, multithreading, winapi

谁能告诉我我做错了什么？我正在尝试在不同的线程上运行自定义主线程。

这是代码。

**.exe**
主要.cpp

```
#include "dll_class.h"
#include <iostream>
int main(void);
DllClass object(main);
int main(void)
{
    std::cout << "Enter the main code.\n";
    std::getchar();
} 
```

**.dll**
dll_class.h

```
#include "platform.h"
#include <iostream>
class DLL_API DllClass //DLL_API is just a macro for import and export.
{
public:
    DllClass(int(*main)(void))
    {
        std::cout << "Start application.\n";
        platform = new Platform(main);
    }
    ~DllClass(void)
    {
        delete platform;
    }
private:
    Platform* platform;
}; 
```

平台.h

```
class DLL_API Platform
{
public:
    Platform(main_t main_tp);
    ~Platform(void){}
}; 
```

平台.cpp

```
#include "platform.h"
#include "Windows.h"
#include <iostream>

HHOOK hookHandle;
int(*main_p)(void);//This will hold a the main function of the the .exe.
LRESULT CALLBACK keyHandler(int nCode, WPARAM wParam, LPARAM lParam);

DWORD WINAPI callMain(_In_  LPVOID lpParameter)
{
    std::cout << "Calling the main function.\n";
    main_p();
    return 0;
}

Platform::Platform(int(*main_tp)(void))
{
    main_p = main_tp;
    CreateThread(NULL, 0, callMain, NULL, 0, NULL);
    std::cout << "Setting hooks.\n";
    hookHandle = SetWindowsHookEx(WH_MOUSE_LL, keyHandler, NULL, 0);
    std::cout << "Enter message loop.\n";
    MSG message;
    while(GetMessage(&message, (HWND)-1, 0, 0) != 0){
        TranslateMessage( &message );
        DispatchMessage( &message );
    }
}

LRESULT CALLBACK keyHandler(int nCode, WPARAM wParam, LPARAM lParam)
{
    std::cout << "Inside the hook function.\n" << std::endl;
    return CallNextHookEx(hookHandle, nCode, wParam, lParam);
} 
```

它运行得很好，直到某个时刻。这是输出。

```
Start application.  
Setting hooks.  
Calling the main function.  
Enter message loop.  
Inside the hook function. (A lot of times of course). 
```

但它从来没有说：

```
Enter the main code. 
```

难道不能让dll调用exe函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:32:03.213

从共享库调用可执行文件中的函数是非常可能的。但是，正如另一个答案中提到的，C 标准不允许您调用`main`. 这与以下事实`main`有关`main`遇到问题。

如果您的目标是真正颠覆所做的事情`main`，那么您将不得不找到一种不同的方式来实现这一点 - 至少如果您希望它适用于多个特定的可执行文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:45:16.137

C++ 标准不允许调用 main() 或获取其地址，这就是您在这里所做的。请参阅引用 line 和 verse 的[此线程。](http://www.cplusplus.com/forum/beginner/55784/)所以，你在做什么是不确定的。

# c# - 如何在 Sql Server 中使用动态查询结果匹配和替换电子邮件模板

> ID：15305009
> 
> 赞同：1
> 
> 时间：2013-03-08T23:21:39.740
> 
> 标签：c#, sql, sql-server, tsql, str-replace

我们正在开发电子邮件系统，我们的电子邮件 html 模板保存在数据库列中

IE

> 你好用户{0}

同一行的另一列有与此模板相关的动态sql

IE

> 从 userTbl 中选择用户名作为“收件人”，其中 userid = @userid

我想编写一个存储过程，它可以
- 读取动态 sql
- 执行它并将结果存储在某处（可能是临时表）
- 然后获取 html 模板字符串并使用 html 模板匹配和替换来自 sql 语句的结果

最终结果应该是

> `<html><body>Hello User username</body></html>`

我的问题是如何存储动态 sql 值？我不应该在 sql 中执行此操作并在 c# 代码中加载所有内容并通过字符串生成器执行搜索和替换吗？

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:03:54.923

不要在数据库中执行此操作。这只是在路上自找麻烦。将数据留在数据库中，然后在应用程序中执行 BL。

# paypal - 贝宝 IPN 更改 | 有没有人在过去 24 小时内有任何运气

> ID：15305011
> 
> 赞同：0
> 
> 时间：2013-03-08T23:21:45.840
> 
> 标签：paypal, paypal-ipn

Paypal 似乎已经改变了他们的 IPN 测试界面。（将 IPN 欺骗到您的 IPN 页面进行测试。

以下是我现在从 IPN 收到的数据。

> 键：receipt_ID - 值：
> 
> 键：mc_handling1 - 值：1.67
> 
> 键：address_state - 值：CA
> 
> 关键：数量1 - 价值：
> 
> 键：reason_code - 值：
> 
> 关键：数量 - 价值：
> 
> 键：txn_id - 值：359726646
> 
> 键：姓氏 - 值：史密斯
> 
> 键：mc_currency - 值：1
> 
> 键：payer_status - 值：0
> 
> 键：address_status - 值：1
> 
> 键：auction_buyer_id - 值：
> 
> 关键：税 - 价值：2.02
> 
> 键：发票 - 值：abc1234
> 
> 关键：运输 - 价值：
> 
> KEY：address_street - VALUE：123，任何街道
> 
> 键：payer_email - 值：buyer@paypalsandbox.com
> 
> 键：mc_gross1 - 值：9.34
> 
> 键：item_name - 值：
> 
> 键：mc_shipping - 值：3.02
> 
> 键：cmd - 值：,_notify-validate
> 
> 键：名字 - 值：约翰
> 
> 关键：业务 - 价值：seller@paypalsandbox.com
> 
> 键：parent_txn_id - 值：
> 
> 键：payer_id - 值：TESTBUYERID01
> 
> 键：payment_date - 值：太平洋标准时间 2013 年 3 月 8 日 08:11:09
> 
> 键：address_country - 值：1
> 
> 键：payment_status - 值：2
> 
> 键：receiver_email - 值：seller@paypalsandbox.com
> 
> 键：for_auction - 价值：
> 
> 键：ipn_type - 值：4
> 
> 键：payment_type - 值：1
> 
> 键：address_zip - 值：95131
> 
> 键：address_city - 值：圣何塞
> 
> 键：mc_shipping1 - 值：1.02
> 
> 键：item_name1 - 值：某物
> 
> 键：mc_gross - 值：12.34
> 
> 键：item_number1 - 值：AK-1234
> 
> 键：mc_fee - 值：0.44
> 
> 键：residence_country - 值：美国
> 
> 键：address_country_code - 值：1
> 
> 键：notify_version - 值：2.4
> 
> 键：receiver_id - 值：seller@paypalsandbox.com
> 
> 键：pending_reason - 值：
> 
> 键：mc_handling - 值：2.06
> 
> 键：txn_type - 值：购物车
> 
> 键：自定义 - 值：xyz123
> 
> 键：auction_closing_date - 价值：
> 
> 键：item_number - 值：
> 
> 键：address_name - 值：约翰·史密斯
> 
> 键：notify_url - 值：[http ://www.sellwidget.com/IPN.aspx](http://www.sellwidget.com/IPN.aspx)

您会注意到对于某些响应，它们具有整数而不是值。就在昨天，情况并非如此。

这是一个错误，还是他们将这些更改为关系数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:51:32.940

是的，我们目前正在调查这个问题。
当您验证 IPN 数据时，IPN 模拟器生成的数据似乎会导致针对 www.paypal.com / www.sandbox.paypal.com 的 HTTP 400 响应。
我们很快就会解决这个问题。对于这给您造成的任何问题，我们深表歉意。

同时，如果您需要通过提出一个新问题来获得有关某些 IPN 参数的具体信息，请随时与我或我的一位同事（他们也在 SO 上）合作。

编辑：
原因似乎是IPN POST数据中的一个杂散'cmd ='。这导致我们的 IPN 验证服务返回 HTTP 400。
您可以在此期间从您的 IPN POST 数据中仅删除“&cmd=”，或者如果您可以稍等片刻，我们将对此进行修复尽早。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T04:52:52.220

谢谢。我通过设置 req.host = "www.paypal.com" 修复了 400 错误，但随后出现证书错误，因为沙箱不是 www.paypal.com，而是 www.sandbox.paypalcom。仅供参考。

（我认为您的新更改已在无意中生效。（发布的关于在添加新 ips 时添加到标题的公告）。

你能解释一下为什么我的 ipn 数据会用整数传回给我，比如 payment_status 等？这只是对数据的格式错误的连接，还是将转移到基于关系的参数系统？

这是公告： [https ://www.x.com/content/bulletin-ipn-and-pdt-scripts-and-http-1-1](https://www.x.com/content/bulletin-ipn-and-pdt-scripts-and-http-1-1)

# ios - iOS App：是否有可能确定用户是否购买了您的应用程序的某个版本

> ID：15305012
> 
> 赞同：2
> 
> 时间：2013-03-08T23:21:52.430
> 
> 标签：ios, app-store, versioning

在 iOS 中，有没有办法找出用户最初购买的应用程序版本？

例如，如果我只想为购买 v1.0 的用户实现一些特殊行为怎么办。一个明显的“功能”是禁用应用内购买，以便他们无需付费即可享受其余部分？我想出了一些方法来做到这一点，但不幸的是，如果用户删除了应用程序，它就无法通过测试，而且我没有足够早地使用 icloud 来保留这个元数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:18:13.647

不幸的是，这是无法做到的。至少不是以任何完美的方式。没有 API 可以获取有关用户及其购买的任何详细信息。如果您的 1.0 版本的应用程序还没有保留一些有意义的线索，那么您唯一的解决方案充其量只是部分解决方案。

如果您已经有较新版本的应用程序（例如 1.1）并且您希望将此新功能添加到较新版本（1.2 或 2.0），您的问题会变得更糟。没有办法知道是否有人曾经有过 1.0。

你基本上有两个选择：

1.  不要管它。您无法将付费应用程序转换为免费 IAP 应用程序而不损害至少部分现有客户。如果有的话，让应用程序付费，但为任何新功能添加 IAP。这样，每个人都为基本应用程序支付相同的费用，并且每个人都可以选择通过 IAP 为附加功能支付更多费用。
2.  根据您的道德规范和现有客户的数量，您可以进行转换并让现有客户再次为他们已经支付的功能付费。显然，这是一个坏主意，但它是一种选择。

# javascript - OSX Safari/quicktime 不发送带有媒体文件请求的 cookie

> ID：15305015
> 
> 赞同：3
> 
> 时间：2013-03-08T23:22:23.053
> 
> 标签：javascript, cookies, safari, html5-audio

我编写了一个 Web 应用程序，它通过 http 提供媒体文件以在 html5 音频元素中播放。在提供媒体文件之前，服务器会检查是否为 cookie 提供了当前 PHP 会话 ID，如下所示：

PHPSESSID=3u90bfmqepd14s4rvslmrv69d1

似乎 IE/Firefox/Chrome 都将 cookie 与对音频文件的请求一起发送，但是在 OSX Safari 中，请求是使用不同的用户代理字符串（包含“quicktime”）发送的，并且没有 cookie。这大概是因为 quicktime 负责浏览器的音频播放功能，不幸的是浏览器中设置的 cookie 没有被保留。

我是否必须向客户端发出一个临时访问代码，该代码可以与媒体文件请求一起通过查询字符串传递？或者有没有更简单的方法来解决这个问题？

谢谢阅读

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:57:57.690

我通过实施替代身份验证流程解决了这个问题。现在，对媒体文件的每个请求都会在查询字符串上发送一个身份验证令牌。此令牌是在每个用户登录时生成的，并且在会话期间有效。

如果设置了 cookie 或在查询字符串上传递了有效的身份验证密钥，则提供媒体文件。

为了提高安全性，请考虑将令牌存储在客户端 IP 服务器端，并在将媒体文件提供给客户端之前验证请求来自生成令牌的同一 IP

# c - C 指针数组、强制转换和/或内存

> ID：15305018
> 
> 赞同：1
> 
> 时间：2013-03-08T23:22:28.023
> 
> 标签：c, pointers, memory, casting

我不明白为什么这些指针值似乎是正确的，但我试图从中得到的值却不是。（我很久以前学过 C，最近我想重新学习它以获得乐趣）。

这是我面临的问题的一个工作示例，但我不确定我做错了什么 - 我是在错误地投射指针，没有正确管理内存，还是其他什么。

```
#include <unistd.h>
#include <stdio.h>
#include <dirent.h>
#include <string.h>
#include <sys/stat.h>
#include <stdlib.h>

#define Q_STACK_MAX 100

typedef struct
{
    void* value[Q_STACK_MAX];
    int top;
} Stack;

void push(Stack* S, void* val)
{
    S->value[S->top] = val; 
    (S->top)++;
}

void* pop(Stack* S)
{
    (S->top)--;
    return (S->value[S->top]);
}

void init(Stack* S)
{
    S->top = 0;
}

int full(Stack* S)
{
    return (S->top >= Q_STACK_MAX);
}

void recursive_dir(char* dir, char* search, Stack* S)
{
    DIR* dp;
    struct dirent* entry;
    struct stat statbuf;
    if((dp = opendir(dir)) == NULL) {
        fprintf(stderr, "error: %s\n", dir);
        return;
    }

    chdir(dir);
    while((entry = readdir(dp)) != NULL) {
        lstat(entry->d_name, &statbuf);

        if(S_ISDIR(statbuf.st_mode)) {
            if(strcmp(".", entry->d_name) == 0 ||
                strcmp("..", entry->d_name) == 0)
                    continue;

            recursive_dir(entry->d_name, search, S);
        } else {
            if( strstr(entry->d_name, search) != NULL ) {
                if(!full(S)) push(S, (void *)entry);

                printf("%p\n", entry);
                printf("%s [%x]\n", entry->d_name, entry->d_ino);
            } 
        }
    }
    chdir("..");
    closedir(dp);
}

int main() {
    Stack S;
    init(&S);
    int i;

    printf("\n");
    recursive_dir("/etc/", "conf", &S);
    printf("\n------------------------------\n");

    int top = S.top;
    struct dirent* entry;
    for (i=0; i<top; i++)
    {
        //struct dirent* entry = (struct dirent*)pop(&S);
        entry = (struct dirent*)S.value[i];

        printf("%p\n", entry);
        printf("%s [%x]\n", entry->d_name, entry->d_ino); 
    }

    printf("\n");

    return 0;
} 
```

它输出的是指向不同结构的指针值、该*结构*中的文件名和文件序列号。然后它尝试将指向该*直接*的指针转换为 (void*) 并将其存储在临时堆栈中。

后来，我尝试迭代堆栈（以及数组）中的值，将其转换回一个*dirent*，然后显示相同的信息。

这有时有效，有时无效。修剪后的输出示例：

```
...
0x7ff831806360
httpd-multilang-errordoc.conf [2cb6e07]
0x7ff831806398
httpd-ssl.conf [2cb6e08]
0x7ff8318063c0
httpd-userdir.conf [2cb6e09]
0x7ff8318063ec
httpd-vhosts.conf [2cb6e0a]
0x7ff831805250
httpd.conf [2cb6e0b]
0x7ff831805274
httpd.conf~previous [187a3]
0x7ff831807230
httpd-autoindex.conf [2cb6e10]
0x7ff831807260
httpd-dav.conf [2cb6e11]
0x7ff831807288
httpd-default.conf [2cb6e12]
0x7ff8318072b4
httpd-info.conf [2cb6e13]
...
--------------------------
...
0x7ff831807360
httpd-multilang-errordoc.conf [2cb6e17]
0x7ff831807398
httpd-ssl.conf [2cb6e18]
0x7ff8318073c0
httpd-userdir.conf [2cb6e19]
0x7ff8318073ec
httpd-vhosts.conf [2cb6e1a]
0x7ff831806250
 [0]
0x7ff831806230
320.whatis [2cb6ff6]
0x7ff8318042bc
asl.conf [2cb7d07]
0x7ff83180437c
autofs.conf [2cb6f5f]
0x7ff831805250
 [0]
0x7ff831805274
??$ [61666564]
0x7ff8318052e0
_response [6e7261]
... 
```

有时一切似乎都是正确的，而有时文件句柄和/或名称完全消失了。

一般来说，当我看到这样的事情时，是因为我没有正确地用记忆做某事——在垃圾收集世界中生活了这么久，我不会对此感到惊讶，但我不确定为什么或如何。

任何帮助，将不胜感激。

（我已经编码了很多年，我刚刚离开C领域有一段时间了。请放轻松。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T23:33:07.927

返回的`dirent`结构`readdir()`可以在重复调用时重用内存。如果要保存它们，则应将它们复制到动态对象中，或者先分配对象并调用`readdir_r()`.

# javascript - AngularJS，当输入发生变化时在按钮上设置类

> ID：15305035
> 
> 赞同：2
> 
> 时间：2013-03-08T23:23:43.803
> 
> 标签：javascript, angularjs

我有一个输入字段，它是一个长列表的过滤器。输入字段旁边是一个搜索图标。基本上当用户开始输入时，我需要更改图标类。

我的文本字段设置如下：

```
<input type="text" ng-change="change()" ng-model="query" />
<button class="btn"><i class="icon-search"></i></button> 
```

在我的控制器内部，我定义了：

```
$scope.change = function()
{
    //change the class of button based on the length of the input field     
} 
```

不太确定如何使用角度确定字段中是否有输入并更改类。我在这里采取了正确的方法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T23:29:33.563

您可以在 ng-model 上使用 ng-class

```
<i ng-class="{'icon-search': query.length}"></i> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:33:59.610

只需使用 ngClass。你的函数 $scope.change 应该返回类名，所以

```
<button ng-class="change()"><i class="icon-search"></i></button> 
```

你的控制器功能看起来像：

```
$scope.change = function() {
    if(something){
        return "classA";
    }
    else{
        return "classB";
    }
}; 
```

# java - Java 比较一个 BufferedImage 和另一个

> ID：15305037
> 
> 赞同：4
> 
> 时间：2013-03-08T23:23:55.003
> 
> 标签：java, bufferedimage

我需要比较两个缓冲图像，看看它们是否完全相同。简单地说如果那等于那是行不通的。我目前的方法是

```
 { 
                 Raster var1 = Img1.getData();    
                 Raster var2 = Img2.getData();

                 int Data1 = (var1.getDataBuffer()).getSize();
                 int Data2 = (var2.getDataBuffer()).getSize();

                 if (Data1 == Data2)
                         {
                         return true;
                         }
                 else 
                           {
                           return false;
                           }
                 } 
```

但这真的行不通。还有什么更靠谱的方法？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-08T23:30:19.843

显而易见的解决方案是逐个像素地比较它们是否相同。

```
boolean bufferedImagesEqual(BufferedImage img1, BufferedImage img2) {
    if (img1.getWidth() == img2.getWidth() && img1.getHeight() == img2.getHeight()) {
        for (int x = 0; x < img1.getWidth(); x++) {
            for (int y = 0; y < img1.getHeight(); y++) {
                if (img1.getRGB(x, y) != img2.getRGB(x, y))
                    return false;
            }
        }
    } else {
        return false;
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:26:18.590

是的，假设它们都采用相同的格式，将它们作为字节字符串读取并比较位字符串。如果一个是 jpg 而另一个是 png，这将不起作用。但我假设平等意味着它们是相同的。

这是一个关于如何进行文件读取的示例；

[http://www.java-examples.com/read-file-byte-array-using-fileinputstream](http://www.java-examples.com/read-file-byte-array-using-fileinputstream)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-01-04T15:50:23.547

哈希码呢？

```
img1.getData().hashCode().equals(img2.getData().hashCode()) 
```

# jquery - jquery追加为倒数第二

> ID：15305038
> 
> 赞同：7
> 
> 时间：2013-03-08T23:23:54.957
> 
> 标签：jquery

我想在添加之前添加第 3 项。我该怎么做？我考虑过使用索引，但即使我知道它应该放在哪里，我仍然不知道如何附加它。无论如何，这是[我的演示](http://jsfiddle.net/eC4a9/)

HTML：

```
<div id="main">
    <div class="item">Item 1</div>
    <div class="item">Item 2</div>
    <div class="Add">Add</div>
</div> 
```

JS：

```
$('<div class="item">Item 3</div>').appendTo('#main'); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-08T23:26:46.783

我建议：

```
$('<div class="item">Item 3</div>').insertBefore('div.add'); 
```

或者：

```
$('<div class="item">Item 3</div>').insertAfter('.item:last'); 
```

虽然我建议将节点创建中的语法更改为：

```
$('<div />',{class: 'item', text: 'Item 3'}) 
```

我发现以这种方式阅读会更容易一些（尽管绝对不是强制性的，甚至不是“最佳实践”）。

参考：

*   [`insertAfter()`](http://api.jquery.com/insertAfter).
*   [`insertBefore()`](http://api.jquery.com/insertBefore).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:27:08.620

您可以在最后一个之后附加`.item`：

```
$('.item').last().after($('<div class="item">Item 3</div>')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:30:28.540

这可以通过在#main 中找到倒数第二个 div

```
var newItemHTML = '<div class="item">Item 3</div>',
    $secondLast = $('#main').find('div:last-child').prev();

$( newItemHTML ).insertAfter( $secondLast ); 
```

# javascript - jQuery Click 事件在每次调整窗口大小时触发更多次

> ID：15305040
> 
> 赞同：4
> 
> 时间：2013-03-08T23:24:18.737
> 
> 标签：javascript, jquery, responsive-design

人们！

这是我第一次来这里问东西，到目前为止，当我遇到问题时，我都能在这里找到一个很好的答案。所以，首先，感谢这个了不起的社区！

现在**让我们来解决问题：**

我正在做一个响应式菜单来检查*window.resize*事件，当它适合最小浏览器宽度时，允许按钮的单击功能。如果浏览器宽度较大，则单击功能未绑定。我需要这样做，因为与移动版本上的按钮相同的元素是桌面版本上的视觉元素。

问题是，使用我现在拥有的代码，当页面加载时，点击功能可以正常工作。但是，如果我调整浏览器大小并再次单击元素，它会触发多次状态，有时会留下未触发功能的印象。而且，如果我再次调整浏览器的大小，它触发的点击功能比我上次点击的次数要多。真烦人。

为了帮助理解正在发生的事情，我做了一个简单的例子。这是简单的代码（只是为了检查点击功能问题）：

# **HTML：**

```
<ul>
    <li><span class="sub-toggle">Testing 01</span></li>
    <li><span class="sub-toggle">Testing 02</span></li>
    <li><span class="sub-toggle">Testing 03</span></li>
</ul> 
```

# **CSS：**

```
.sub-toggle{
    display:block;
    padding: 20px;
}

.sub-toggle.active{
    background-color: #ffcc00;
    color: #fff;
} 
```

# **Javascript（jQuery）：**

```
jQuery(function($){

    var i = 1;

    // check if browser size is compatible with click event
    onResize = function() {

        // if browser size is ok, do the click function
        if($(window).width() <= 480){

            // click function
            $('.sub-toggle').click(function(){

                alert('click');

                if($(this).hasClass('active')){
                    alert('active');
                    $(this).removeClass('active');
                } else {
                    $(this).addClass('active');
                }

            });     

        } else{
            // if browser size is greater than expected, unbind the click function
            $('.sub-toggle').removeClass('active').unbind('click');
        }

        // just checking how many times the resize function is triggered 
        console.log('resize: '+ i);
        i++;

    }

    $(document).ready(onResize);

    var timer;

    $(window).bind('resize', function(){
        timer && clearTimeout(timer);
        timer = setTimeout(onResize, 500);
    });

}); 
```

**（编辑删除一些不必要的代码）**

如果您想看到它的实际效果，我制作了一个 Fiddle（尝试调整输出框架的大小以使其正常工作）：http: [//jsfiddle.net/C7ppv/1/](http://jsfiddle.net/C7ppv/1/)

也许我错过了一些非常愚蠢的东西，因为我没有大量的 JavaScript 知识。但**我想做的只是触发一次点击事件**，即使多次调整大小。

我希望我能很好地解释我的问题。我已经搜索并没有找到解决这个问题的方法（或者我可能只是不太清楚要寻找什么）。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T23:36:25.490

`click`您的代码当前每次`onResize`调用该方法并且窗口宽度小于或等于时都会绑定一个新事件`480px`。

只需在绑定新事件之前取消绑定元素`click`上的任何现有事件。`.sub-toggle`

```
$('.sub-toggle').unbind('click').click(function() {
    ...
}); 
```

**[演示](http://jsfiddle.net/YYKwp/)**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-08T23:45:51.957

该`resize`事件在调整大小期间被触发多次，并且每次您绑定一个新的点击处理程序时。我的建议：从调整大小处理程序外部只绑定一次，并在调整大小时设置一个标志，让点击处理程序知道它是否应该做某事。

然后你甚至不需要像你正在做的那样推迟处理`resize`with 。`setTimeout`

[**演示**](http://jsfiddle.net/NWCF3/)

```
jQuery(function($){

    var i = 1;

    // flag to allow clicking
    var clickAllowed = true;

    // click function
    $('.sub-toggle').click(function(){
        if(clickAllowed) {
            alert('click');

            if($(this).hasClass('active')){
                alert('active');
                $(this).removeClass('active');
            } else {
                $(this).addClass('active');
            }
        }
    }); 

    // check if browser size is compatible with click event
    onResize = function() {

        //if browser size is ok, do the click function
        if($(window).width() <= 480){
            clickAllowed = true;
        }
        else{
            // if browser size is greater than expected, disallow clicking
            clickAllowed = false;

        }

        // just checking how many times the resize function is triggered 
        console.log('resize: '+ i);
        i++;

    }

    $(document).ready(onResize);

    var timer;
    $(window).bind('resize', onResize);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T23:43:30.610

`$('.sub-toggle').click(function(){...}`移出 onResize 事件处理程序并移入单击`if($(window).width() <= 480){...}`处理程序。

# c# - 字符（picturebox）与不同的picturebox碰撞

> ID：15305041
> 
> 赞同：0
> 
> 时间：2013-03-08T23:24:23.357
> 
> 标签：c#, picturebox, collision

我正在做一个简单的 C# 游戏我正在使用一个图片框作为我的角色移动代码可以工作但现在我有另一个问题我有其他图片框制成的障碍我已经编写了代码将它移动到起始位置但我不知道如何判断角色是否会接触裸机 将其移动到起始位置

如果 picturebox1.enter\ character movetostart()\my position detection 在障碍物上，我会看到这样

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T14:26:37.150

我不知道是否为时已晚，但你可以试试这个

在按键事件下键入以下内容：

if (picturebox1.Bounds.IntersectsWith(barrier.Bounds))

```
 {

             picturebox1.Location = new Point(0, 0);
        } 
```

# android - android：多个条件的 db.query 语法

> ID：15305043
> 
> 赞同：0
> 
> 时间：2013-03-08T23:24:38.627
> 
> 标签：android, android-sqlite

我在数据库中有一个这样的表：

```
db.execSQL(" CREATE TABLE IF NOT EXISTS "
        + DATABASE_TABLE + " ( " + KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT,"   + KEY_DATE + " TEXT, " + KEY_CATEGORY + " TEXT, "
        + KEY_SUB_CATEGORY + " TEXT, " + KEY_AMOUNT + " REAL, "
        + KEY_NOTE + " TEXT " + " );"); 
```

我想获取 KEY_CATEGORY = ("Income" or "Expense" ) 和 KEY_DATE = "March 2013" 的 trans_amount 值。

我如何查询才能得到它？我目前正在使用

```
db.ourDatabase.query(DATABASE_TABLE, 
   new String[] { KEY_AMOUNT } , " ( " 
   + KEY_CATEGORY + " = ? OR " 
   + KEY_CATEGORY + " = ? ) AND " + KEY_DATE + " = ? " , 
  new String[] { " VariableExpenses " , " FixedExpenses ", " March/08/2013 " }, 
  null, null, null, null); 
```

但我没有得到 KEY_AMOUNT 值。我在查询中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:30:50.293

最好将您的日期存储为自纪元以来的毫秒数（由`calendar.getTimeInMillis()`or返回`date.getTime()`）或单独的月/年列，如果您只关心月份和年份而不是文本，因为看起来您没有得到任何行返回日期格式：您的查询显示“March/08/2013”​​，而您说您想要“2013 年 3 月”。

# regex - 带有正则表达式的html5输入类型文本用于移动设备中的模式

> ID：15305045
> 
> 赞同：1
> 
> 时间：2013-03-08T23:24:47.763
> 
> 标签：regex, html, textinput

嗨，我正在尝试为显示数字和点的输入类型文本获取模式。翻阅[苹果文档](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)，我发现基本上可以使用正则表达式来仅提取键盘中的数字。就像是

```
<input type="text" pattern="[0-9]*"></input> 
```

我正在寻找一种方法来准确地做到这一点，而且在键盘上也有一个点。任何想法都非常感谢。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:26:15.553

只需在字符类中包含一个点。

```
[0-9.]* 
```

请注意，这也是“零个或多个数字和点”。

# php - PHP file_get_contents 特定编码

> ID：15305048
> 
> 赞同：0
> 
> 时间：2013-03-08T23:25:17.863
> 
> 标签：php, encoding, utf-8, character-encoding, file-get-contents

我对 PHP 中的 file_get_contents 有一个特殊问题，代码如下：

```
$html = file_get_contents("http://www.bratm.sk/trochu-harlem-inspiracie-zaslite-nam-svoj-super-harlem-shake-ak-bude-husty-zverejnime-ho"); 
```

它给了我这样的东西

```
í}KsŰĆŇčÚŽň!Ç& zRŚ|iI[#)öIkI ĆĺăĹŮÝĹÍý_ŐŃâ[EVßîV%Ů˙ëvĎ ř)śG#óčééééÇĚ çáÜöÁÖÉ;¤áˇ,rřĂăçť[DQ5íeaKÓśOśÉ?ě='šL¸ÔöLßä6ľ4mg_!JĂ÷˘Śu:L§án];9ŇÎV+Ş¨1|C 
```

在此页面的某些页面中，我可以使用 iconv 获得正确的编码和内容，但我无能为力，我该如何解决？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:27:43.647

该页面采用 UTF-8 格式。您需要设置标题以匹配：

`header('Content-Type: text/html; charset=utf-8');`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:31:33.160

我想你正在寻找这样的东西

```
$opts = array('http' => array('header' => 'Accept-Charset: UTF-8, *;q=0'));
$context = stream_context_create($opts);

$filename = "http://www.bratm.sk/trochu-harlem-inspiracie-zaslite-nam-svoj-super-harlem-    shake-ak-bude-husty-zverejnime-ho";
echo file_get_contents($filename, false, $context); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:36:42.497

使用卷曲。此函数是 file_get_contents 的替代函数。

```
function url_get_contents($Url) {
if (!function_exists('curl_init')){
    die('CURL is not installed!');
}
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $Url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$output = curl_exec($ch);
curl_close($ch);
return $output;
}
$data = url_get_contents("http://www.bratm.sk/trochu-harlem-inspiracie-zaslite-nam-svoj-super-harlem-shake-ak-bude-husty-zverejnime-ho/");
print_r($data); 
```

# c# - Asp.Net MVC 和部分视图以及混合 Ajax.BeginForm 和 Html.BeginForm

> ID：15305061
> 
> 赞同：0
> 
> 时间：2013-03-08T23:27:03.503
> 
> 标签：c#, .net, ajax, asp.net-mvc

我有一些通常使用小型模型数据的部分视图。我一直在将 Ajax.BeginForm 与 A​​jaxOptions 中定义的 js 函数一起使用，以在提交该部分时捕获部分回发的成功或失败。

我没有看到性能损失，因为我的数据很轻。目前，我一直在研究一个从 SSRS 报告中返回 HTMLFragment 的片段，该报告在控制器中呈现为“HTML40”格式。html 部分的 JSON 序列化需要**很长时间**，我不再将其视为一种选择。当我将 Ajax.BeginForm 更改为 Html.BeginForm 并预先渲染报告时，有效负载更轻，渲染时间更短，但现在我被卡住了。如何在不再次加载部分的情况下发出刷新命令？这就是我首先使用 Ajax.BeginForm 的原因 :( 也许有比我正在做的更好的加载数据的方法。我已经开始研究回调并以某种方式将报告片段作为原始字节 [] 或字符串反对使用 json 序列化。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:46:42.877

您可以使用 .load() jQuery 函数将整个部分加载到 div 中：

```
$("#someButton").click(function(){
  $("#someDive").load("/url", {type: 'POST'}, function(){
  });
}); 
```

现在，当您单击#someButton 时，将对/url 进行AJAX 调用。/url 可以返回一个 PartialView ，它将直接加载到您的 div 中：

```
//controller URL
[HttpPost]
public ActionResult Index(){
    return PartialView("MyPartialView");
} 
```

您可以像传递给常规视图一样传递模型。

# python - 打印字符由“+”分隔的字符串和字符串本身由“,”分隔的字符串

> ID：15305063
> 
> 赞同：0
> 
> 时间：2013-03-08T23:27:03.923
> 
> 标签：python, python-2.7

我有一些变量：

```
A1 = 'abc'
B1 = 'def'
C1 = 'ghi' 
```

我想编写以以下格式打印 A1、B1、C1 的代码：

`a+b+c, d+e+f, g+h+i`

所以在每个字符串值中，字符由 a 分隔，`+`字符串本身由 a 分隔`,`。

如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:28:44.487

```
In [11]: str.join?
Namespace:  Python builtin
Docstring:
S.join(iterable) -> string

Return a string which is the concatenation of the strings in the
iterable.  The separator between elements is S. 
```

```
In [12]: ", ".join("+".join(chars) for chars in [A1, B1, C1])
Out[12]: 'a+b+c, d+e+f, g+h+i' 
```

# regex - 正则表达式从字符串中提取版本

> ID：15305065
> 
> 赞同：0
> 
> 时间：2013-03-08T23:27:10.600
> 
> 标签：regex, shell, sed

我有一个低于值的字符串

> String1=winos-app-1.2.0-4.20120308.InLinuxOS.x86_64

我只需要从这个字符串中提取版本“1.2.0-4”

我已经尝试使用 sed 如下所述的正则表达式

```
sed -ne 's/[^0-9]*\(\([0-9]\.\)\{0,1\}[0-9][^.]\).*/\1/p' 
```

但我只得到结果“1.2.0-”，“-”后缺少数字，即 4。我尝试更正它，但它返回 null。

好心提醒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:36:38.380

```
sed -n 's/^.*-\([0-9.]*-[0-9]*\)\..*$/\1/p' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:30:19.443

grep 怎么样：

```
grep -Po "(?<=-)[\d.-]*(?=.\d{8})" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:48:48.673

这应该有效，并且还应该解释任何超过一位数的版本号。

```
String1=winos-app-1.2.0-4.20120308.InLinuxOS.x86_64
sed -n 's/[^0-9]*\(\([0-9]\+\.\)\{0,2\}[0-9]\+-[0-9]\+\).*/\1/p' <<< "$String1"
1.2.0-4 
```

顺便说一句，这也将匹配版本字符串，如（从你的问题中不清楚你是否想要这种行为）：

```
1-1
1.2-1 
```

如果你想强制执行`w.x.y-z`，你可以使用这个：

```
sed -n 's/[^0-9]*\(\([0-9]\+\.\)\{2\}[0-9]\+-[0-9]\+\).*/\1/p' <<< "$String1" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T14:01:23.247

您也可以尝试参数扩展：

```
string1=winos-app-1.2.0-4.20120308.InLinuxOS.x86_64
string2=${string1%".${string1#*-*-*-*.}"}
version=${string2#*-*-}
printf "%s\n" "$version" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T23:35:08.627

你能试试这个吗？

`[^0-9]*\(\([0-9]\.\)\{0,2\}[0-9][^.]\).*`

# web-services - 如何使用 Restify 增加服务器端的套接字超时？

> ID：15305068
> 
> 赞同：2
> 
> 时间：2013-03-08T23:27:35.367
> 
> 标签：web-services, node.js, restify, connection-reset, econnreset

我使用restify 来实现一个node.js 服务器。基本上，服务器根据 HTTP POST 请求运行一个耗时的过程，但不知何故，套接字被关闭，客户端收到如下错误消息：

```
[Error: socket hang up] code: 'ECONNRESET' 
```

根据错误类型，套接字肯定在服务器端关闭。

我可以在`createServer`restify 的方法中设置任何选项来解决这个问题吗？

**编辑：** 长时间运行的进程是使用 Mongoose 运行 MongoDB 进程。也许套接字挂断也可能是由与 MongoDB 的连接引起的？如何增加猫鼬的超时时间？我发现挂断恰好在 120 秒内发生，所以可能是因为某些默认超时配置？

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-09T22:07:59.990

您可以在对象上使用标准[套接字](http://nodejs.org/api/http.html#http_request_connection)`req`，并手动调用[setTimeout](http://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback)以增加节点挂起套接字之前的时间。默认情况下，节点在所有套接字上都有一个 2 分钟的不活动计时器，这就是为什么你会在 120 秒时挂断（这与 restify 无关）。作为增加它的示例，设置一个处理程序以在您的长时间运行的任务之前运行，如下所示：

```
server.use(function (req, res, next) {
    // This will set the idle timer to 10 minutes
    req.connection.setTimeout(600 * 1000);
    res.connection.setTimeout(600 * 1000); //**Edited**
    next();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T06:12:13.870

此接缝实际上并未实施

[https://github.com/mcavage/node-restify/issues/288](https://github.com/mcavage/node-restify/issues/288)

# c# - 调整图片框大小时如何使矩形移动

> ID：15305076
> 
> 赞同：1
> 
> 时间：2013-03-08T23:28:32.660
> 
> 标签：c#, graphics

我有一个带有图片作为应用程序背景的 PictureBox，设置了所有 Anchors，因此它可以随表单调整大小。在这个 PictureBox 上，我正在创建许多其他的东西，现在只有矩形。我在一些 X 和 Y 坐标上创建它们，这很好。添加图片以显示我正在尝试做的事情。创建的矩形实际上是浅蓝色的小方块。 ![在此处输入图像描述](../Images/f2e2e4643325d3086dea34f37013b8a4.png)

但是，当我调整表单的大小时，例如我最大化它，矩形保持在相同的坐标，这当然是在其他地方（只包括图像的一部分以节省空间）：![在此处输入图像描述](../Images/cca8a34d25702171fced04de4f6096dd.png) 我的问题是 - 我该怎么做在调整大小期间，矩形“棒”与它的位置相同吗？注意 - 他们将不得不稍后移动，比如每 2 秒左右，所以它不能是绝对静止的。

编辑：这是一些创建矩形的代码

```
 private void button1_Click(object sender, EventArgs e)
    {
        spawn = "aircraft";
        pictureBox1.Invalidate();
    }
private void pictureBox1_Paint(object sender, PaintEventArgs e)
    {
        switch (spawn)
        {
            case "aircraft":
                 Point[] points = new Point[2];
                 Point bod = new Point(750, 280);
                 points[0] = bod;    
                 aircraft letadlo = new aircraft(605, 180, "KLM886", 180, e.Graphics);
                 aircrafts[0] = letadlo;
                 letadlo.points = points;
                 break;
                 ...

        public aircraft(int x, int y, string csign, int spd, Graphics g)
    {
        Pen p = new Pen(Color.Turquoise, 2);
        Rectangle r = new Rectangle(x, y, 5, 5);
        g.DrawRectangle(p, r);
        p.Dispose(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:44:58.617

一种选择是在与 PictureBox 更改大小成比例的新坐标中重新绘制矩形。例如：

```
oldX, oldY // old coordinates of the rectangle should be saved
oldPictureBoxWidth, oldPictureBoxHeight // should be saved too

//and on the PictureBox Paint event You have the new:
newPictureBoxWidth and newPictureBoxHeight

//the new coordinates of rectangle: (resize ratio is in brackets)
newX = oldX * (newPictureBoxWidth / oldPictureBoxWidth)
newY = oldY * (newPictureBoxHeight / oldPictureBoxHeight) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:42:39.900

我认为你必须计算你的 x 和 y 从顶部和底部的距离之间的百分比，如果表格重新调整大小，只需使用你的 % 并再次绘制你的矩形！

例如：

x = 100 宽度是 200 所以 100 是 1/2 所以它是 50% 所以如果表格调整大小只需计算新大小和 (newsize * 50 ) / 100

希望能帮到你。

# javascript - 在 localStorage 中将项目标记为“完成”

> ID：15305080
> 
> 赞同：0
> 
> 时间：2013-03-08T23:29:12.643
> 
> 标签：javascript, local-storage

我有一个应用程序，我在其中向网页添加 li 元素。当我在网页上将元素标记为“完成”时，我需要在本地存储中将元素的类名更改为“完成”。（应该说完成：真的）。使用我当前的代码，我无意中在本地存储中制作了两项，一项已完成：true，另一项已完成：false。我将在这里展示我的代码：

```
function updateDone(e) {
  var spanClicked = e.target;
  var id = spanClicked.parentElement.id;
  var done = spanClicked.parentElement.className;
  spanClicked.innerHTML = "&nbsp;&#10004;&nbsp;";
  spanClicked.setAttribute("class", "done");
  var key = "todos" + id;

  for(var i = 0; i < todos.length; i++) {
    if(todos[i].id == id) {
      var mark = todos[i];
      mark.done = true;
      console.log(mark);
      spanClicked.setAttribute("class", "done");
      var newKey = JSON.stringify(mark);
      localStorage.setItem(key, newKey);

      if(mark.done == false) {
        spanClicked.setAttribute("class", "not done");
        spanClicked.innerHTML = "not done";
      }
    }
  }
} 
```

它们都标有相同的 id，这是我跟踪每个项目的方式，但其中有两个。此外，当我刷新页面时，会显示两个列表项，其中一个标记为完成。我的问题是如何防止创建另一个项目，而是在 localStorage 中仅将一个项目标记为已完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:51:29.913

您需要一种唯一标识每个项目的方法，因此您可以确保您的标记设置在您想要的项目上并且不会覆盖，因为您可能有两个项目具有相同的键。由于您正在*遍历 list*，也许您可​​以将键更改为由两部分组成。

`var parent_key = "todos" + parent_id;`

然后，在循环中：

`var store_key = parent_key + ":" + i;` `...` `localStorage.set(store_key,newKey);`

通过这种方式（只要顺序保持一致），您可以将多个列表元素从同一个父级中分离出来。

正如所评论的，jsFiddle 中的一个活生生的例子或其他东西将有助于更好地满足您的要求。

但是，如果此解决方案不充分，您可以尝试以下想法，在本地存储中有效地设置“表”。

```
var parent_key = "todos" + id;
var parent_table = {};
// for loop
    parent_table[i] = newKey;
// end of for loop
localStorage.set(parent_key,parent_table); 
```

因此，您在本地存储中有一个表，可以为您提供更精细的粒度。

# ios - 当我将 `translatesAutoresizingMaskIntoConstraints` 设置为 `NO` 时，视图消失了

> ID：15305083
> 
> 赞同：3
> 
> 时间：2013-03-08T23:29:43.690
> 
> 标签：ios, cocoa

我不知道这是一个错误还是我做错了什么：

```
- (BOOL)application:(UIApplication *)application
    didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

    UIWindow *window = [self window];

    UIViewController *main = [[UIViewController alloc] init];
    UIViewController *vc1 = [[UIViewController alloc] init];
    UIViewController *vc2 = [[UIViewController alloc] init];

    [main addChildViewController:vc1];
    [main addChildViewController:vc2];

    UIView *mainView = [main view];
    UIView *v1 = [vc1 view];
    UIView *v2 = [vc2 view];

    [v1 setBackgroundColor:[UIColor redColor]];
    [v2 setBackgroundColor:[UIColor blueColor]];
    [v1 setTranslatesAutoresizingMaskIntoConstraints:NO];
    [v2 setTranslatesAutoresizingMaskIntoConstraints:NO];
    [v1 setClipsToBounds:YES];
    [v2 setClipsToBounds:YES];

    [mainView setBackgroundColor:[UIColor yellowColor]];
    [mainView addSubview:v1];
    [mainView addSubview:v2];

    NSLayoutConstraint *constraint = [NSLayoutConstraint constraintWithItem:v1
        attribute:NSLayoutAttributeTop relatedBy:NSLayoutRelationEqual
        toItem:mainView attribute:NSLayoutAttributeTop multiplier:1.0
        constant:0.0];
    [mainView addConstraint:constraint];

    constraint = [NSLayoutConstraint constraintWithItem:v1
        attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual
        toItem:nil attribute:NSLayoutAttributeNotAnAttribute multiplier:1.0
        constant:240.0];
    [mainView addConstraint:constraint];

    constraint = [NSLayoutConstraint constraintWithItem:v2
        attribute:NSLayoutAttributeTop relatedBy:NSLayoutRelationEqual
        toItem:v1 attribute:NSLayoutAttributeBottom multiplier:1.0 constant:0.0];
    [mainView addConstraint:constraint];

    [window setRootViewController:main];
    [window setBackgroundColor:[UIColor greenColor]];
    [window makeKeyAndVisible];

    [main release];
    [vc1 release];
    [vc2 release];

    return YES;
} 
```

`v1`并且`v2`在我启动应用程序时无处显示。

如果我注释掉：

```
[v1 setTranslatesAutoresizingMaskIntoConstraints:NO];
[v2 setTranslatesAutoresizingMaskIntoConstraints:NO]; 
```

Cocoa 将无法满足我的约束，因为自动调整大小掩码已转换为约束。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:47:37.833

您没有任何水平约束，并且缺少 v2 的高度约束。使用你需要的视觉格式语言`|-[v1]-|`，`|-[v2]-|`和`V:[v2]-|`

```
NSArray *constraints;

constraints = [NSLayoutConstraint constraintsWithVisualFormat:@"|-[v1]-|" options:0 metrics:nil views:@{@"v1": v1}];
[mainView addConstraints:constraints]; 
```

# javascript - context.drawImage 是如何工作的

> ID：15305086
> 
> 赞同：0
> 
> 时间：2013-03-08T23:29:58.510
> 
> 标签：javascript, html, canvas

在 HTML5 中，使用画布对象可以绘制图像。

```
context.drawImage(imageObj, x, y); 
```

这在引擎盖下是如何工作的？浏览器是绘制像素还是使用 svg？我没有看到任何 svg 元素被添加到 dom 中，所以我假设浏览器正在绘制像素，但它是如何完成这一切的呢？是否有浏览器正在使用的库？

为了便于讨论，我想我们可以只考虑 Webkit，但我也会对其他浏览器 (IE) 的功能感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:47:04.770

**嗯……你问了！**

把画布想象成一个大的、活生生的位图……下面是细节：

[http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:48:03.717

[Canvas](https://developer.mozilla.org/en-US/docs/HTML/Canvas)是基于像素的界面，[SVG](https://developer.mozilla.org/en/docs/SVG)是矢量图形的标记语言，它们是两个非常独立的东西。

如果您将图像添加到画布，它首先将其加载到 dom 中，然后将其渲染到画布。

不过，您可以将 SVG 与 Canvas 结合使用。假设您希望您的画布应用程序可以缩放，您可以简单地将不同大小的 svg 文件重新渲染到画布上，[如此处所述](http://ajaxian.com/archives/canvg-using-canvas-to-render-svg-files)

因为 SVG 图形可以像图像一样使用，所以它们可以像图像一样渲染到画布上。

如果您想更深入地了解画布，只需[阅读规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html)

# c - C 虚拟操作

> ID：15305096
> 
> 赞同：1
> 
> 时间：2013-03-08T23:30:29.710
> 
> 标签：c

我无法想象编译器在没有左值时会做什么，例如：number>>1; 我的直觉告诉我，由于优化，编译器将从编译中丢弃这一行，如果优化被删除，会发生什么？它是否使用寄存器来进行操作？还是它的行为就像是函数调用一样，因此参数被传递到堆栈，并且使用的内存被标记为已释放？还是将其转换为 NOP 操作？我可以看到使用 VS++ 调试器发生了什么吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:35:52.543

在您给出的示例中，它丢弃了该操作。它知道操作没有副作用，因此不需要发出代码来执行语句以生成正确的程序。如果禁用优化，编译器可能仍会发出代码。如果启用优化，编译器也可能会发出代码——它并不完美。

`/FAsc`您可以使用Microsoft 编译器的命令行选项查看编译器发出的代码。该选项创建一个列表文件，其中包含编译器的目标代码输出和相关的源代码。

您也可以在调试器中使用“查看反汇编”来查看编译器生成的代码。

使用“查看反汇编”或`/FAsc`优化代码，我希望不会看到编译器发出的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:49:24.927

假设这`number`是一个整数类型的常规变量（not `volatile`），那么任何有能力的优化编译器（Microsoft、Intel、GNU、IBM 等）都将生成 NOTHING。不是 a `nop`，不使用寄存器等。

如果优化被禁用（在“调试构建”中），那么编译器很可能会“按照你的要求做”，因为它没有意识到它没有代码的副作用。在这种情况下，该值将被加载到寄存器中，并右移一次。结果不会存储在任何地方。编译器将执行“无用代码消除”作为优化步骤之一——我不确定是哪一个，但是对于这种相对简单的事情，我希望编译器能够通过相当基本的优化设置来解决。在某些情况下，涉及循环等，编译器可能不会优化代码，直到启用一些更高级的优化设置。

如评论中所述，如果变量是易失性的，则必须读取所代表的内存`number`，因为编译器必须读取`volatile`内存。

在 Visual Studio 中，如果您“查看反汇编”，它应该向您显示编译器生成的代码。

最后，如果这是 C++，也有可能变量不是常规整数类型，`operator>>`当编译器看到这段代码时正在调用函数——这个函数除了返回结果之外可能有副作用，所以可能必须执行。但在 C 语言中情况并非如此，因为没有运算符重载。

# java - 指定要调用的数组长度

> ID：15305097
> 
> 赞同：0
> 
> 时间：2013-03-08T23:30:41.710
> 
> 标签：java, arrays, listener

我将用一个例子来解释我的问题：

```
 buttons[0][0].addActionListener(new ActionListener() { 
```

在上面的代码中，我在左上角的按钮上添加了一个监听器。现在我想知道是否有一个选项，所以我可以调用整个行`[0][0-3]`，比如）。`0-3``-3`

我知道我可以通过一个一个地为按钮添加一个监听器来做到这一点，但我必须`if`声明当所有按钮都被按下时，它会返回一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:33:13.230

你不能在一次调用中做到这一点，最简单的方法是遍历它们：

```
ActionListener toAddToThoseButtons = new ActionListener() { /*...*/ };

for (int i=0; buttons[0].length; i++) {
    buttons[0][i].addActionListener(toAddToThoseButtons);
} 
```

# android - 向 listView 添加搜索字段破坏了我的代码

> ID：15305098
> 
> 赞同：0
> 
> 时间：2013-03-08T23:30:43.683
> 
> 标签：android, listview, search, android-activity

我有一个问题，我想这是一个简单的解决方案，但我无法弄清楚......

我有一个带有列表视图和搜索字段的活动，当我单击一个项目时，它会加载一个新视图，其中包含与单击的内容相关的内容...

无论如何，一切都很好，但是，现在我添加了搜索字段，它不再工作了......

我想出了问题，但我不明白我应该把它换成什么......

```
lv.setOnItemClickListener(new OnItemClickListener() {
      public void onItemClick(AdapterView<?> parent, View view,
          int position, long id) {

          // selected item
          String product = ((TextView) view).getText().toString(); //PROBLEM

          // Launching new Activity on selecting single List Item
          Intent i = new Intent(getApplicationContext(), BotafogoSingleListItem.class);
          // sending data to new activity
          i.putExtra("product", product);
          startActivity(i);

      }
    }); 
```

这人`String product = ((TextView) view).getText().toString();`有问题。。

当我查看调试面板时，这是我得到的： java.lang.ClassCastException: android.widget.LinearLayout cannot be cast to android.widget.TextView

我猜这条线得到的是线性布局而不是它里面的 TextView？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:34:33.570

`OnItemClick`的`view`参数是整个列表项的视图。在这种情况下，您似乎从对每个 list_item 使用单个 TextView 转变为使用自定义 LinearLayout（我假设它包含您的 TextView）。

在这种情况下，您需要将您的产品线替换为

```
String product = ((TextView) view.findById(R.id.your_text_view)).
    getText().toString(); 
```

其中 your_text_view 是与 TextView 关联的 android:id。

# javascript - Jquery Mobile - 页面加载时禁用对话框？

> ID：15305099
> 
> 赞同：0
> 
> 时间：2013-03-08T23:30:44.523
> 
> 标签：javascript, jquery, html, mobile

我的应用程序中有一个初始初始化页面，它充当入口点并加载我的登录页面。

```
<!DOCTYPE html> 
<html> 
<head> 
<title></title> 
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-      1.3.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>  
</head> 
<body>

<!-- initialse and load the application -->
<div data-role="page" id="init">

  <script type="text/javascript">   
    $('#init').live( 'pageinit', function() {
      window.location.href="views/login.html";
    });
  </script>

</div>

</body> 
</html> 
```

当我的登录页面加载时，有一个按钮可以加载一个对话框。此按钮最初不起作用，仅在手动刷新页面时加载对话框。为什么会发生这种情况，我该怎么做才能在页面加载后立即启用按钮/对话框。

```
<!DOCTYPE html> 
<html> 
<head> 
  <title></title> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
  <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>    
</head> 
<body>

<!-- login page -->
<div data-role="page" id="login">

<!-- css -->
  <link rel="stylesheet" href="../css/global.css" />
  <link rel="stylesheet" href="../css/login.css" /> 
<!-- page markup -->    
  <div data-role="header">
    <a href="#settings_dialog" data-rel="dialog" data-role="button" data-mini="true" data-inline="true" data-icon="gear" data-theme="b">Settings</a>
  </div>

</div>
<!-- end of page -->

<!-- settings dialog page -->
<div data-role="dialog" id="settings_dialog">

<!-- page markup -->
  <div data-role="header" style="text-align: left;">
    <a href="" data-rel="back" data-role="button" data-icon="delete" data-iconpos="notext" data-iconpos="left" data-inline="true"></a>
  </div>

  <div data-role="content">

  </div>

</div>
<!-- end of page -->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T16:23:36.083

不确定您是否已解决此问题，但它似乎与 DOM 缓存和 AJAX 有关。

我不确定你会怎么做，但尝试设置`ajax: false`当你重新加载窗口时。或者，您可以通过服务器端重定向（我建议这样做，因为如果用户关闭了 JS，它仍然可以工作。

为什么我想出这个是因为我有一个带有列表的页面，列表项将我发送到一个新页面，该页面上有一个跳转链接（#settings_dialog）。在每个列表项上设置`data-ajax="false"`以某种方式“刷新” DOM 并强制第二页加载“新鲜”，瞧——我的对话框现在 100% 工作。

因此，简而言之，关闭 AJAX 功能或（更好地）从服务器端重定向并开心！

# asp.net - 如何在 ASP.Net 中将 ASCII 码解码回字符串

> ID：15305101
> 
> 赞同：0
> 
> 时间：2013-03-08T23:31:03.587
> 
> 标签：asp.net, vb.net, ascii

我在将 ASCII 码解码回字符串时遇到问题。

首先，我从用户那里获取文本输入并将其转换为连续分配给标签的 ASCII 码。比我想将它从该标签转换回普通字符串。但我收到的不是字符串，而是一个随机符号。

我相信这是因为该函数无法区分某个字母的代码何时开始以及何时结束。任何想法如何设置分隔符或类似的东西？如果有的话当然可以解决问题

这是我使用的代码：

```
 Protected Sub Button4_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button4.Click
    Label3.Text = ""
    For x As Integer = 1 To TextBox3.Text.Length
        Label3.Text &= CStr(Asc(Mid$(TextBox3.Text, x, 1)))
    Next
End Sub

Protected Sub Button5_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button5.Click
    Label4.Text = ""
    For x As Integer = 1 To Label3.Text.Length
        Label4.Text &= Chr(Mid$(Label3.Text, x, 1))
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T06:14:55.173

试试这个。

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
  Label3.Text = ""
  For x As Integer = 1 To TextBox3.Text.Length
    Label3.Text &= CStr(Asc(Mid$(TextBox3.Text, x, 1))) & "|"
  Next
End Sub

Protected Sub Button2_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button2.Click
  Label4.Text = ""
  Dim value As Integer = 0
  Dim buf As String = ""
  For x As Integer = 1 To Label3.Text.Length
    If Mid$(Label3.Text, x, 1) <> "|" Then
      buf &= Mid$(Label3.Text, x, 1)
    Else
      Label4.Text &= Chr(Val(buf))
      buf = ""
    End If
  Next
End Sub 
```

# mysql - Flyway 2.1，MySQL 因“未使用 LOCK TABLES 锁定”而失败

> ID：15305103
> 
> 赞同：3
> 
> 时间：2013-03-08T23:31:07.427
> 
> 标签：mysql, flyway

从 Flyway 2.03 迁移到 2.1，在 MySQL 5.6 数据库上，Flyway 架构更新工作正常，但是每当我的应用程序尝试运行查询（通过存储过程）时，它都会失败，并显示“表 'SomeTable' 没有被 LOCK TABLES 锁定” . 再试一次，它仍然失败，但回滚到 2.03 版它又可以正常工作了。

那么，我是否错过了需要为新版本更新的内容，或者它是一个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:33:00.800

我相信这是一个错误，由这个[commit](https://github.com/flyway/flyway/commit/ceb4bbb4f49e802fc76e370c1af069bddae3380b)引起。

我在[这里创建了一个问题](https://github.com/flyway/flyway/issues/176)

当使用 MySQL 命令 LOCK TABLES 时，它期望之后有一个 UNLOCK TABLES，它不是由 flyway 发出的。希望它会很快得到修复，因为 2.1 版基本上无法与 MySQL 一起使用。

但是，如果您回到 2.0.3 版本，应该没有问题。

# android - 在多项选择应用程序中显示正确答案

> ID：15305105
> 
> 赞同：0
> 
> 时间：2013-03-08T23:31:19.740
> 
> 标签：android

我正在做一个有 4 个选择的多项选择应用程序。我已经下载了一个代码。但是如果他的答案是错误答案（同时）如何提示用户正确答案。这是代码示例。正确答案是绿色。错误答案是红色的。

```
 optionOne.setOnClickListener(this);     //On First Option selection
    optionTwo.setOnClickListener(this);     //On Second Option selection
    optionThree.setOnClickListener(this);   //On Third Option selection
    optionFour.setOnClickListener(this);    //On Forth Option selection

public void onClick(View v) {
    if(v.getId() == optionOne.getId()){
        onOptionSelected(optionOne.getText().toString(), v);
        optionOne.setBackgroundColor(Color.RED);
    }else if(v.getId() == optionTwo.getId()){
        onOptionSelected(optionTwo.getText().toString(), v);
        optionTwo.setBackgroundColor(Color.RED);
    }else if(v.getId() == optionThree.getId()){
        onOptionSelected(optionThree.getText().toString(), v);
        optionThree.setBackgroundColor(Color.RED);
    }else if(v.getId() == optionFour.getId()){
        onOptionSelected(optionFour.getText().toString(), v);
        optionFour.setBackgroundColor(Color.RED);
    }else if(v.getId() == pause.getId()){   //True when Game is Paused 

//When an option of a question is selected
private void onOptionSelected(String option, View v){
    if(!isGamePaused && !isGameEnded) { //true when game is being played
        ATriviaQuestion tTQuestion = myListOfTriviaQuestions.get(currentQuestionNumber);
        if(option.equals(tTQuestion.GetOptions().get(tTQuestion.GetAnswer() - 1))) {
            correct += 1;
            v.setBackgroundColor(Color.GREEN);

        }
        else{
            incorrect += 1;
            totalPoints -= pointsPerWrongAnswer;
        } 
```

如果用户答案不正确，我需要在这部分插入代码以在绿色背景中显示正确答案，但我不知道如何。

```
else{
incorrect += 1;
totalPoints -= pointsPerWrongAnswer; 
```

数据库问题在 .plist 中

```
<question>
<key>Question</key>
<string>What is the ....</string>
<key>Options</key>
<array>
<string>option 1</string>
<string>option 2</string>
<string>option 3</string>
<string>option 4</string>
</array>
<key>Answer</key>
<integer>2</integer>
</question> 
```

这是我的其他代码

```
public ATriviaQuestion(){
isThisQuestionAsked = false;
answer = -1;
answered = "";
}

public String GetQuestion()
{ return this.question; }

public void SetQuestion(String _question)
{ this.question=_question; }

public ArrayList<String> GetOptions()
{ return this.options; }

public void SetOptions(ArrayList<String> _options)
{ this.options = _options; }

public int GetAnswer()
{ return this.answer; }

public void SetAnswer(int _answer)
{ this.answer = _answer; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:53:55.193

我无法准确了解这里的内容，但是您可以循环浏览`options`直到文本等于`tTQuestion.GetOptions().get(tTQuestion.GetAnswer() - 1)`（这似乎是您获得正确答案的方式），然后将其`View`背景颜色设置为绿色。

# sql - 将完整日期拆分为日/月/季度/年列

> ID：15305106
> 
> 赞同：0
> 
> 时间：2013-03-08T23:31:20.430
> 
> 标签：sql, sql-server, sql-server-2008, data-warehouse

我有一个简单的表结构，我的`DATE`列有`yyyy-mm-dd`格式。我想将所有日期和它们拆分到我的时间维度表中，`INSERT`其中包含`day`、`month`和列。我不确定如何处理这个（尝试使用查询作为插入）。`quarter``year`

**示例**：`SPLIT 2010-03-01 AND INSERT 2010`进入`year`列，`03`进入`month`列，`01`进入`day`列和`1`进入`quarter`列。

此外，我想将名称分配给特定的日期部分（例如`month_name`一月`1`），将日期名称值存储在同一个表中是否是一种好习惯？

**编辑**：我刚刚意识到我可能犯了大错？`TIME`维度中是否`DATA WAREHOUSE`应该仅存储唯一数据（出于描述目的？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T01:04:19.140

通常，时间维度意味着时间（小时、分钟、秒）或日期时间。

听起来您只需要一个日期维度。大部分工作已经在这里为您完成：http: [//smehrozalam.wordpress.com/2009/06/09/t-sql-using-common-table-expressions-cte-to-generate-sequences/](http://smehrozalam.wordpress.com/2009/06/09/t-sql-using-common-table-expressions-cte-to-generate-sequences/)

如果您仍处于事实表的设计阶段，我建议您在维度上的 PK 教程中使用日期而不是 YYYYMMDD ID 格式。每行便宜一个字节，并启用日期数学。在 SQL 2008 之前，int dateid 格式是有意义的。现在该日期可用，这是一个更合适的选择。

至于唯一性，对于 ssas 中的层次结构和相关属性关系，我通常会结合必要的列来唯一标识周期。例如：

```
SELECT 
  CAST(YEAR(GETDATE()) as char(4)) + ' ' + DATENAME(MONTH,GETDATE()) MonthUniqueName
, CAST(YEAR(GETDATE()) as char(4)) + ' Q' + CAST(DATEPART(QUARTER,GETDATE()) as char(1)) QuarterUniqueName 
```

返回

```
MonthUniqueName     QuarterUniqueName
2013 March          2013 Q1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:45:45.523

这是你想要的吗？

```
select Datename(yy,yourDateColumn) as year, Datename(quarter,yourDateColumn), Datename(month, yourDateColumn),Datename(day, yourDatecolumn),CONVERT(varchar(3), yourDateColumn, 100)  from yourTable 
```

假设您的列类型为 DateTime

```
Insert into yourTable (yearColumn, quarterColumn, monthColumn, dayColumn) values 
Datename(yy,yourDateColumn) , Datename(quarter,yourDateColumn), Datename(month,  yourDateColumn),Datename(day, yourDatecolumn) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T07:57:54.467

```
-- First solution: date is stored and day, month, year and quarter are computed
DECLARE @Table1 TABLE (
    Dt DATE NOT NULL,
    DD AS CONVERT(TINYINT, DATEPART(DAY, Dt)) PERSISTED,
    MM AS CONVERT(TINYINT, DATEPART(MONTH, Dt)) PERSISTED,
    YYYY AS CONVERT(SMALLINT, DATEPART(YEAR, Dt)) PERSISTED,
    QQ AS CONVERT(TINYINT, DATEPART(QUARTER, Dt)) PERSISTED
);
INSERT  @Table1
VALUES  (GETDATE());

SELECT * FROM @Table1;

-- Second solution: day, month and year are stored and date and quarter are stored
DECLARE @Table2 TABLE (
    Dt AS CONVERT(DATE, DATEADD(DAY, DD-1, DATEADD(MONTH, MM-1, DATEADD(YEAR, YYYY-1, CONVERT(DATE, '00010101',112))))) PERSISTED,
    DD TINYINT NOT NULL CHECK(DD BETWEEN 1 AND 31),
    MM TINYINT NOT NULL CHECK(MM BETWEEN 1 AND 12),
    YYYY SMALLINT NOT NULL CHECK(YYYY BETWEEN 1 AND 9999),
    QQ AS CONVERT(TINYINT, ((MM-1)/3)+1) PERSISTED
);
INSERT  @Table2 (DD, MM, YYYY)
VALUES  (9,3,2013);

SELECT * FROM @Table2; 
```

结果：

```
Dt         DD   MM   YYYY   QQ
---------- ---- ---- ------ ----
2013-03-09 9    3    2013   1

Dt         DD   MM   YYYY   QQ
---------- ---- ---- ------ ----
2013-03-09 9    3    2013   1 
```

# c++ - 子类化控制

> ID：15305108
> 
> 赞同：1
> 
> 时间：2013-03-08T23:31:36.137
> 
> 标签：c++, winapi, subclassing

在 WINAPI 中，哪个是正确/必要的？

```
SetWindowLongPtr(HelpBox, GWLP_USERDATA, static_cast<LONG_PTR>(SetWindowLongPtr(HelpBox, GWLP_WNDPROC, (LONG_PTR)(Subclass)))); 
```

或者

```
SetWindowLongPtr(HelpBox, GWLP_WNDPROC, (LONG_PTR)(Subclass)); 
```

然后在 WM_DESTROY 我都喜欢：

```
SetWindowLong(HelpBox, GWLP_WNDPROC, (LONG) Original); 
```

为什么我应该使用第一个而不是第二个？我注意到它有两次 GWLP_USERDATA 和 setwindowlongptr .. 为什么？我在 MSDN 上看到了这两个示例，但我不知道何时使用第一个而不是第二个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:42:56.947

改为使用**[`SetWindowSubclass`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762102%28v=vs.85%29.aspx)**；它处理将数据与窗口相关联的负担。反正。第一个将旧的窗口 proc 地址存储在与窗口关联的用户数据存储中，除非窗口类是您自己定义的，否则您不能这样做。IE~~窗口确实存在这样的存储空间~~您可以保证该存储不会用于其他任何用途。

# ruby-on-rails - 配置乘客服务器和 Rails 应用程序

> ID：15305109
> 
> 赞同：0
> 
> 时间：2013-03-08T23:31:53.297
> 
> 标签：ruby-on-rails, apache, virtualhost, passenger

我有一个 Rails 应用程序，我想通过 apache 在默认端口 80 上运行它。所以我设置了Passenger服务器并配置了apache配置文件。

我的应用程序曾经在默认的 3000 端口上运行，而我的 routes.rb 看起来像这样：

```
ScwCentral::Application.routes.draw do
 resources :smoke
 resources :regression
.....
....
..... 
```

这些是我的应用程序“烟雾”和“回归”中的 2 个控制器。所以我的应用程序将在 localhost:3000/smoke 和 localhost:3000/regression 之类的 url 上运行。

现在，在设置好乘客服务器和所有内容之后，我将 apache 配置文件编辑为：

```
LoadModule passenger_module /usr/local/lib/ruby/gems/1.8/gems/passenger-3.0.19/ext/apache2/mod_passenger.so
PassengerRoot /usr/local/lib/ruby/gems/1.8/gems/passenger-3.0.19
PassengerRuby /usr/local/bin/ruby

# Rails_App Virtual Host

<VirtualHost *:80>                                                                                                                         
  ServerName www.mysite.com
  # !!! Be sure to point DocumentRoot to 'public'!
  DocumentRoot /a/rails_app_test/public/    
  <Directory /a/rails_app_test/public>
     # This relaxes Apache security settings.
     AllowOverride all
     # MultiViews must be turned off.
     Options -MultiViews
  </Directory> 
```

其中“/a/rails_app_test/”是我的应用程序的路径。

现在当我去 www.mysite.com 它说

```
Routing Error
No route matches [GET] "/" 
```

当我打开 www.mysite.com 时，我最好打开 localhost:3000/smoke。我需要在配置文件中进行更多更改吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T03:01:25.437

您没有根路由。例如，如果你做了

`rails g controller welcome index`

然后添加

`root :to => 'weclome#index'`

您的根路径 / 将显示欢迎索引页面。

# jquery - jQuery/CSS 过渡：三个可变高度之间的动画，1 为自动

> ID：15305110
> 
> 赞同：1
> 
> 时间：2013-03-08T23:31:56.243
> 
> 标签：jquery, css, height, css-transitions

根据我在 Stack 上找到的信息，我已经完成了以下操作，以将我的 div 的高度从设定高度设置为自动高度并返回。

```
$('.parent').each(function(){
    $(this).data('height',$(this).css('height'));
    $(this).css('height','20px');
});
$('.parent').click(function(){
    var el = $(this);
    if ($(this).css('height') == '20px') {
        $(this).css({
            height: $(this).data('height'),
            cursor: 'auto'
        });
        $(this).children('.closeButton').fadeIn();
    }
});
$('.closeButton').click(function(){
    var el = $(this).parent();
    var button = $(this);
    el.css('height','0');
    setTimeout(function(){
        el.css({
            height: '20px',
            cursor: 'pointer'
        });
        button.fadeOut();
    },150);
});
$('.makeBigger').click(function(){
   html = 'TONS OF CONTENT MAKES ME BIGGER<br/>TONS OF CONTENT MAKES ME BIGGER<br/>TONS OF CONTENT MAKES ME BIGGER<br/>';
   $('#bigger').append(html);
   $('#bigger').css('height','auto');
}); 
```

元素的 HTML 本质上是：

```
<div class="parent">
    <div class="closeButton">close</div>
    CONTENT
</div>

<div class="parent" id="bigger">
    <div class="closeButton">close</div>
    CONTENT
    <div class="makeBigger">EVEN BIGGER</div>
</div> 
```

CSS：

```
.parent {
    background: red;
    overflow: hidden;
    cursor: pointer;
   margin: 30px;
    transition: all .5s;
    -webkit-transition: all .5s;
    -moz-transition: all .5s;
}
.closeButton {
    display: none;
    cursor: pointer;
    float: right;
} 
```

[http://jsfiddle.net/3uFaq/](http://jsfiddle.net/3uFaq/)

这工作得很好。但是，我的一个 div 包含一些用户可以与之交互的表单字段，进而将更多数据附加到该 div。如何进一步为该 div 设置动画以使其更大？我已经尝试过广泛使用最大最小高度和其他东西，但没有找到合适的脚本组合来做到这一点。

# shell - 将脚本的输出传递到我的 .profile

> ID：15305114
> 
> 赞同：0
> 
> 时间：2013-03-08T23:32:08.973
> 
> 标签：shell, unix, scripting, .profile

我的*主目录*中有一个*脚本*。该*脚本*仅提供一条消息作为输出。我正在尝试让我的：执行*脚本*，以便我可以看到此消息。**`.profile`**

 ***我正在尝试将我的个人资料用作日志。所以我可以找到错误。

我的问题是，**既然*脚本*调用了一个基本`echo`请求，我是否必须将我的消息传递给一个变量，以便它可以传递给那个`.profile`？**

当我实施`ISPOD = Home/isProd export ISPROD`将其提供给我`.profile`的消息时，该消息不存在。我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:09:10.067

There are several things to consider here. When you do

```
ISPROD=$HOME/isProd 
```

the actual content of your variable is the isProd path, and not its output. If you want to execute the command and catch the output then try $(command) or `command`.

```
ISPROD=$($HOME/isProd) 
```

or

```
ISPROD=`$HOME/isProd` 
```

at this point ISPROD will contain the output of the script. But you still need to show the content, hence you need to add

```
echo "$ISPROD" 
```

But the same behaviour can be achieved just by executing the command without capturing the output and then echoing it. Try with putting directly

```
$HOME/isProd 
```

in the .profile and source it. Also, make sure that .profile is the actual file that the shell sources at login time (bash for example uses .bash_profile).***

# regex - 如何在正则表达式中排除某个单词？

> ID：15305117
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:32:22.940
> 
> 标签：regex, word

我正在使用这个表达式，它非常适合我的需要：

```
.*(cq|conquest).* 
```

它返回任何单词/短语/句子/等。里面有字母“cq”或“征服”这个词。但是，从这些比赛中，我想排除所有包含“征服力量”一词的内容。

例子：

*   `some conquest here`（*应该*匹配）
*   `another cq with some conquest here`（*应该*匹配）
*   `too much cq or conquest power is bad`（*不应该*匹配）

我怎样才能对上面的正则表达式做到这一点？它必须只有一个正则表达式，否则我正在使用的程序（Advanced Combat Tracker）将创建两个不同的选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T10:39:51.440

如果要匹配包含`"conquest"`or`"cq"`的任何字符串，但如果字符串包含 则不匹配`"conquest power"`，则正则表达式为

```
^(?!.*conquest power).*?(?:cq|conquest).* 
```

上面将尝试从字符串的开头匹配到行尾，如果您想从每行的开头匹配，如果可用，请打开多行模式 - 添加`(?m)`到正则表达式的开头可能会这样做。

如果要跨换行符进行匹配，请更改`.`为`[\s\S]`，或打开`singleline`模式（如果有）。

您通过说*“我想匹配'cq'或'conquest'”*以及*“我希望正则表达式提取那条线”让*人们感到困惑。

我假设你真的不想只匹配“cq”或“conquest”，你想匹配*包含*“cq”或“conquest”的字符串/行（？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:01:17.380

从您[最初的问题](https://stackoverflow.com/revisions/15305117/1)中，我得到您想要匹配所有包含“cq”或“conquest”但不包含“power”的字符串。对于这种情况，以下正则表达式有效：

```
^([^p]|p(?!ower))*(cq|conquest)([^p]|p(?!ower))*$ 
```

（[正则表达式](http://regexpal.com/?flags=gm&regex=%5E%28[%5Ep]|p%28%3F!ower%29%29*%28cq|conquest%29%28[%5Ep]|p%28%3F!ower%29%29*%24&input=some%20sentence%20with%20cq%20and%20powerstuff%0Aanother%20sen-power-tence%20with%20conquest%20and%20stuff%0Asome%20poweer%20with%20conquest%20or%20cq%20and%20so%20on)）

# ruby - 需要帮助使用 ruby nokogiri 对 xml 文件进行排序

> ID：15305123
> 
> 赞同：1
> 
> 时间：2013-03-08T23:32:52.627
> 
> 标签：ruby, nokogiri

我想对以下 xml 文件进行排序，以便 Tables 下的 Table 节点按其 Name 节点排序。我还希望 Columns 节点下的 Columns 成为它们的 Name 节点。
如何使用 ruby​​ 和 nokogiri 做到这一点？

我希望这个例子能让你知道我希望它如何排序（它不包括整个文件，输入太多）：

```
 ....
          <Table>
             <Name>Account</Name>
             ...
          </Table>
          <Table>
             <Name>Item</Name>
          </Table>
             <Name>Order</Name>
          <Table>
             <Name>Product</Name>
             ...
                <Column>
                   <Name>description</Name>
                </Column>
                <Column>
                   <Name>productid</Name>
                </Column>
                <Column>
                   <Name>productname</Name>
                </Column>
            ...
          </Table>
    .... 
```

不幸的是，我无法上传杂乱无章的文件。所以我得把它贴在这里：

```
 <Db xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://tedsdb.com/schemas" xsi:schemaLocation="http://tedsdb.com/schemas/Db.xsd">
      <Name>Store</Name>
      <Version>3</Version>
      <Catalog name="Store" version="3"></Catalog>
      <Tables>
         <Table>
            <Name>Product</Name>
            <Columns>
               <Column>
                  <Name>productid</Name>
                  <Length>11</Length>
               </Column>
               <Column>
                  <Name>productname</Name>
                  <Length>25</Length>
               </Column>
               <Column>
                  <Name>description</Name>
                  <Length>250</Length>
                  <Properties>
                     <Property>
                        <Name>Store_NAME</Name>
                        <Value>desc</Value>
                     </Property>
                  </Properties>
               </Column>
            </Columns>
         </Table>
         <Table>
            <Name>Order</Name>
            <Columns>
               <Column>
                  <Name>orderid</Name>
                  <Length>11</Length>
               </Column>
               <Column>
                  <Name>userid</Name>
                  <Length>11</Length>
               </Column>
               <Column>
                  <Name>orderdate</Name>
                  <Properties>
                     <Property>
                        <Name>NAME_IS_KEYWORD</Name>
                        <Value>desc_</Value>
                     </Property>
                     <Property>
                        <Name>Store_NAME</Name>
                        <Value>desc</Value>
                     </Property>
                  </Properties>
               </Column>
            </Columns>
            <Key>
               <Name>Order_PK</Name>
               <Type>PRIMARY</Type>
               <ColumnNames>
                  <Name>topid</Name>
               </ColumnNames>
            </Key>
         </Table>
         <Table>
            <Name>Item</Name>
            <Columns>
               <Column>
                  <Name>itemid</Name>
                  <Length>11</Length>
               </Column>
               <Column>
                  <Name>itemname</Name>
                  <Length>250</Length>
               </Column>
            </Columns>
            <Key>
               <Name>Product_PK</Name>
               <Type>PRIMARY</Type>
               <ColumnNames>
                  <Name>topid</Name>
               </ColumnNames>
            </Key>
         </Table>
         <Table>
            <Name>Account</Name>
            <Columns>
               <Column>
                  <Name>accountid</Name>
                  <Length>11</Length>
               </Column>
               <Column>
                  <Name>accountname</Name>
                  <Length>250</Length>
               </Column>
            </Columns>
            <Key>
               <Name>Product_PK</Name>
               <Type>PRIMARY</Type>
               <ColumnNames>
                  <Name>topid</Name>
               </ColumnNames>
            </Key>
         </Table>
      </Tables>
      <Links>
         <Link>
            <Name>Accounts.orders.link</Name>
         </Link>
      </Links>
   </Db> 
```

尝试提出答案后，我尝试了以下代码。我在 Windows 7 上使用 aptana studio。变量**doc**不为空，实际上有加载的文件，但**doc.at(//Tables)**返回 nil，因此它从那里失败：

```
require "rubygems"
require "nokogiri"

f = File.open("test.xml")
doc = Nokogiri::XML(f)
f.close

tables = doc.at('//Tables');

tables.search('./Table').each do |t|
  columns = t.at('//Columns')
  columns.search('./Column').sort_by { |l| l.at('Name').text }.each do |col|
    columns << col
  end
end

puts doc.to_xml 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T01:53:36.917

要对节点进行排序，只需按照您想要的顺序将它们重新插入父节点：

```
tables = doc.at('//Tables')
tables.search('./Table').sort_by{|t| t.at('Name').text}.each do |table|
  tables << table
end 
```

# php - 如何从 Zend Framework 1 中的模块加载 css 和 javascript 文件？

> ID：15305130
> 
> 赞同：1
> 
> 时间：2013-03-08T23:33:27.570
> 
> 标签：php, zend-framework, module, path, assets

我有休闲结构

```
/app
    application/
        configs/
        modules/
             default/
                   controllers/
                   layouts/
                   views/
                   forms/
             profile/
                   controllers/
                   layouts/
                   views/
                   forms/
                   assets/
                       css/
                       js/
                       images/
    library/
    public/
        css/
        js/
        images/
        uploads/ 
```

我如何加载 js 和 css 文件

`/application/modules/profile/assets/...`?

并使用类似的东西

`$this->view->headLink()->appendStylesheet('path/to/file');`

关于这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T10:54:50.287

虽然，我同意 P44T 的观点，即样式表应始终保存在公用文件夹中，但在某些情况下，您可能需要在模块中添加一些额外的样式。这样做的一个例子是，如果您想将模块与应用程序分开分发，并且您不想在添加模块的同时添加样式表。

这是从任何角度来看如何做到这一点的一个示例：

```
<?php $this->headStyle()->captureStart() ?>
    // add plain css or include a file like this:
    <?php include APPLICATION_PATH . 'modules/[modulename]/assets/css/style.css'; ?>
<?php $this->headStyle()->captureEnd() ?> 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:47:30.533

HeadLink[视图助手](http://framework.zend.com/manual/1.12/en/zend.view.helpers.html#zend.view.helpers.initial.headlink)仅管理对在 HTML 页面部分中呈现的 CSS 文件的引用。这些样式表应该始终有一个公共 URL，这意味着它们必须位于“公共”文件夹中的某个位置。

一种解决方案是将 CSS 文件移到那里。另一种解决方案是使用某种 PHP 脚本，它从“公共”文件夹之外的位置读取 CSS 文件，然后打印它的内容。Zend 框架没有为此提供标准组件，因此我建议重新组织项目，以便所有 CSS 都可以驻留在“公共”文件夹中的某个位置。

# performance - Corona - 使用 transition.to 移动组

> ID：15305132
> 
> 赞同：0
> 
> 时间：2013-03-08T23:33:34.637
> 
> 标签：performance, coronasdk, transition, game-engine

我想以不同的速度移动我的主要对象组。

我可以毫无问题地以相同的速度移动我的组，并根据需要将广告添加到 var 以进行删除。但是我如何让对象以不同的速度移动，没有for循环并查看组本身，因为如果我使用for循环，那么将需要多个变量来保存“补间”引用......

```
local transOptions = { 
                time = math.abs(distanceToMaxLeft / speedToMove), 
                x = BG_MIN_X_POS, 
                onComplete = cancelAnyExistingTransition(bg) 
            };
bg.tween = transition.to(mainSceneGroup, transOptions); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T23:17:44.933

使用 mainSceneGroup[ObjectIndex] 访问对象怎么样？

# php - fopen 什么时候失败？

> ID：15305133
> 
> 赞同：3
> 
> 时间：2013-03-08T23:33:38.847
> 
> 标签：php, file-io, fopen

在我的 PHP 代码中，我打开一个文件并向其附加文本。我使用这段代码：

```
$ourFileHandle = fopen($ourFileName, 'a') or die("can't open file"); 
```

加载 PHP 页面时会发生这种情况。现在如果两个人同时加载 PHP 页面会发生什么？此代码是否适用于其中一个人，而对于另一个人，它会执行`die()`吗？一般来说，什么时候会`fopen`失败？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:56:37.973

# TL;DR - 只需使用数据库

这不是一个简单的主题。对于多个并发请求，您正在做的事情肯定不会按预期工作，因为大多数系统将允许所有请求打开文件，并且可能多个脚本将能够同时写入文件，您最终可能会如果你这样做，文件中有垃圾。

可能的解决方法很多，但我将在这里介绍我认为最可行的三个。

1.  使用数据库。这几乎可以肯定是您尝试做的任何事情的最佳解决方案。RDBMS 将毫不犹豫地处理所有这些并发问题，如果您这样做，您将永远不会遇到任何并发问题。

2.  使用 请求对文件的排他锁`flock()`。此功能使用*咨询*锁定来防止多个并发进程同时访问文件。这将满足您对多个 PHP 进程的需求，但如果其他外部程序不支持 PHP 使用的同一类型的咨询锁定系统，它可能无法与其他外部程序一起使用。
    `flock()`“阻塞”，直到在文件上获得锁定。这意味着它会损害请求的并发性——一次只有一个请求能够写入文件。此外，它不能保证锁会按照它们被请求的顺序提供服务，因此您可能最终会遇到这样一种情况，即一个请求永远不会获得文件上的锁，而后来到达的其他请求却得到满足。

3.  使用后台进程来处理文件访问，并让您的脚本与该进程进行通信。这有点像滚动你自己的 1) 版本，它不适合胆小的人，但如果做得正确，它可以发挥很大的作用。
    使用此模型，可以使用某种形式的进程间通信将需要写入文件的数据中继到后台（持久）进程。然后，此后台进程管理对文件的写入，确保消息以正确的顺序完整写入。通常（当使用 PHP 时）此类 IPC 将使用套接字实现。这是非常重要的，但可能是最强大的解决方案。

* * *

从更一般的角度来看，`fopen()`通常由于权限问题或低级操作系统问题而失败。操作系统也可以提供“真正的”锁定机制，以防止其他程序打开文件。然而，`fopen()`很难提供一个真正的“可能失败的原因列表”，因为有很多可能性。

显然，如果您尝试以读取模式打开文件并且该文件不存在，这将失败。但是，您上面的代码是以写入模式打开文件 - 如果文件不存在，这*不一定*会失败 - 如果目录路径存在并且调用进程有权写入该目录，则将创建文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:37:21.700

`fopen`将失败主要是因为以下原因：

*   文件不存在
*   文件权限不允许打开此文件（写入、读取、执行等）
*   文件被另一个进程使用（即第 3 方应用程序）
*   文件被另一个 PHP 脚本/资产锁定

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:41:15.987

`fopen`如果您没有权限或存在其他低级操作系统问题，可能会失败，`fopen`多次 ing 没问题，但同时写入会导致“条带化”，因此请使用 (blocking) `flock`。

# input - 如何让脚本要求输入变量并将输入附加到文本文件

> ID：15305135
> 
> 赞同：1
> 
> 时间：2013-03-08T23:33:48.500
> 
> 标签：input, batch-file

所以我有一个可以工作的脚本，但是在脚本的最后我想记录日期、时间、%username%，并询问一个名称（将由用户输入）

这将全部进入“日志”文件。

我所拥有的是：

```
echo Data Secured by %username% On %date% At %time% >> testfile.txt 
```

这工作正常。但这并不是要求用户输入诸如名称之类的。我希望它是这样的：

-script 将询问“帮助者名称？：”并允许在此处输入任何内容。然后它将与上面的 echo 一起插入以读取：

```
 echo Data Secured by %username% & %helpername% On %date% At %time% >> testfile.txt 
```

“日志”文件中的结果如下所示：

```
Data Secured by John & Jason on Fri 03/08/2013 At 15:29:27.19 
```

助手名称可以是任何名称。

我以为我会使用类似的东西

```
set /p helpername=" ? " 
```

但这似乎是 YES NO 答案或您可以列出的答案，人名会改变。

我希望这一切都有意义....有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:12:07.020

您可以使用它来获取助手的名称：

```
SET /P HelperName=Enter Helper Name: 
```

然后将数据保存到文件中：

```
ECHO Data Secured by %username% ^& %helpername% On %date% At %time%>>testfile.txt 
```

# jquery - JSONP跨域GET请求不能跨域工作

> ID：15305139
> 
> 赞同：0
> 
> 时间：2013-03-08T23:34:05.367
> 
> 标签：jquery, ajax, web-services, cross-domain, jsonp

好的，所以我尝试使用 jsonp 进行跨域 ajax webservice 调用以返回类别列表以填充下拉列表并得到奇怪的结果。我已经遵循了尽可能多的示例，并且在我的域上得到了一个 jsonp 请求，但它在其他域上不起作用。

下面的代码：

```
 function parseJSON(item){
    return   JSON.parse(item, function (key, value) {
                    var type;
                    if (value && typeof value === 'object') {
                        type = value.type;
                        if (typeof type === 'string' && typeof window[type] === 'function') {
                            return new (window[type])(value);
                        }
                    }
                    return value;
                });
    };

    function getCategories() {
        var webserviceURL = 'http://www.theprintersinc.co.uk/TPIWS.asmx/getCategories';
        var myData;

        $.ajax({
            type: "GET",
            contentType: "application/json; charset=utf-8",
            url: webserviceURL,
            data: { galleryGuid: 1 },
            dataType: "jsonp",
            complete: function (msg) {
                if (msg) {

                var myObject = parseJSON(msg.responseText);
                var myCatList = parseJSON(myObject.d);

                        if (myCatList) {
                             catList = myCatList;
                             setCatDDL();
                        };
                };
                //reset close button
             },
            error: function (xhr, ajaxOptions, thrownError) {
                var err = "err";
            }
         });

    }; 
```

[您可以在http://www.theprintersinc.co.uk/stackHelp.html](http://www.theprintersinc.co.uk/stackHelp.html)看到这在我的域上运行。 但是，当我尝试从我的电脑或另一台服务器上的简单 html 文件运行此代码时，它不起作用。我只是从 jbug 得到一个语法错误。

提前非常感谢任何和所有帮助！

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T17:31:19.767

我不是专家，但是您可以考虑 jquery 文档中关于“同源策略”限制的规定：http: [//api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

”附注：由于浏览器安全限制，大多数“Ajax”请求都受同源策略的约束；请求无法成功从不同的域、子域或协议中检索数据。脚本和JSONP请求不受同源策略的约束原产地政策限制。”

要使用 JSONP，您应该添加 callback=? 到您的网址。在同一个 jquery 文档中，有一个例子。

# jquery - Internet Explorer 在我的代码中添加了不足的 br

> ID：15305149
> 
> 赞同：0
> 
> 时间：2013-03-08T23:35:02.943
> 
> 标签：jquery, css

本质上，在我的网站上呈现的是几行通过 css 设置为相同大小的 div。在 firefox、chrome 和 safari 中，该网站呈现良好，并允许 10 x 10 组的行显示为更大多维数据集（每行 10 个由 br 标签分隔）

关于我将从哪里开始“解决”这个问题的任何线索？我很想完全疏远用户，虽然......

[http://wet-monkey.com/rpgGame](http://wet-monkey.com/rpgGame)是链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:40:06.757

我注意到您的网页上没有包含 Doctype，您尝试添加一个吗？这可能是原因。

替代方法可能是`line-height`属性 - 尝试将其设置为 0px：

```
line-height:0px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:48:47.503

我建议检查`line-height`属性；将其设置为 100%。根据 IE 和您的版本`doctype`，它可能无法正确读取。

# python - lambda 与 tkinter 奇怪地工作

> ID：15305153
> 
> 赞同：2
> 
> 时间：2013-03-08T23:35:09.323
> 
> 标签：python, lambda, tkinter

我正在尝试使用 Tkinter 制作计算器。我一直在尝试清理代码，但遇到了障碍。创建按钮时，我使用以下代码：

```
Button(self,text="1",command=lambda: self.addkey("1"),width=self.defaultwidth,height=self.defaultheight).grid(row=5, column=0)
Button(self,text="2",command=lambda: self.addkey("2"),width=self.defaultwidth,height=self.defaultheight).grid(row=5, column=1)
Button(self,text="3",command=lambda: self.addkey("3"),width=self.defaultwidth,height=self.defaultheight).grid(row=5, column=2) 
```

以下是调用的命令

```
def addkey(self,key):
            # Adds a given key to the display
            if len(self.displaytext) + len(key) <= self.maxlength:
                self.displaytext += key
                self.display["text"] = self.displaytext 
```

当按顺序按下按钮 1、2 和 3 时，输出如下：

```
123 
```

我一直在尝试清理代码，使其看起来更像：

```
for i in range(3):
    Button(self,text=str(i+1),command=lambda: self.addkey(str(i+1)),width=self.defaultwidth,height=self.defaultheight).grid(row=5, column=i) 
```

这很好地添加了按钮，但是当按顺序按下 1、2 和 3 时，屏幕上会显示以下内容：

```
333 
```

我想知道我是否错过了什么，或者这根本不可能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T23:42:09.770

Ah, scoping. When you do this:

```
command=lambda: self.addkey(str(i)) 
```

You're **not** "resolving" the `i` to a number **right there and then**. You're just telling the lambda to reference `i` when it's invoked, **afterwards**.

At any time past the end of the `for` loop, `i = 3` (last value), so all of your lambdas get `3` when they ask for `i`.

If I'm not mistaken, you can add a function as means of indirection, and it will appropriately "capture" `i` from the surrounding scope.

```
def add_key_f(i):
    return lambda self: self.addkey(i) 
```

# c# - 创建一个返回 WebClient 的类或函数

> ID：15305155
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:35:13.617
> 
> 标签：c#, webclient

我`WebClient`用来下载图像的代码非常大，所以我试图将我的代码分成类。有人可以给我一个示例，说明如何将下面的代码放入类或函数中吗？

```
WebClient client = new WebClient ();
client.DownloadDataCompleted += 
    (object sender, DownloadDataCompletedEventArgs e) => 
    {
        byte[] result = e.Result;
        if (result != null) 
        {
            NSData data1 = NSData.FromArray (e.Result);
            UIImage img = UIImage.LoadFromData (data1);
            InvokeOnMainThread (delegate {
                avatar.Image = img;     
            });             
        }
   };

client.DownloadDataAsync(new Uri(
    "http://xx.xx.xx.xx/fbcache/" + 
    list[indexPath.Row].comentario_id_usuario + 
    ".jpg")); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-08T23:37:34.497

我想你可能会对什么是类以及它的用途感到困惑。至于将该代码放入函数中，请尝试从下面开始（尽管我怀疑您需要对正在进行的异步调用做一些事情以获得所需的结果）：

```
public WebClient MyFunctionName()
{
        #region Baixando as imagens e as exibindo
        WebClient client = new WebClient ();
        client.DownloadDataCompleted += (object sender, DownloadDataCompletedEventArgs e) => {
            byte[] result = e.Result;
            if (result != null) {
                NSData data1 = NSData.FromArray (e.Result);
                UIImage img = UIImage.LoadFromData (data1);
                InvokeOnMainThread (delegate {
                    avatar.Image = img;

                });

            }
        };
        client.DownloadDataAsync (new Uri ("http://xx.xx.xx.xx/fbcache/"+list [indexPath.Row].comentario_id_usuario+".jpg"));
        #endregion
        return client;
} 
```

# iphone - 如何正确解析子字符串的字符串？

> ID：15305157
> 
> 赞同：-2
> 
> 时间：2013-03-08T23:35:26.163
> 
> 标签：iphone, string, exception, range, substring

我是 iphone 开发的菜鸟，我正在尝试解析字符串的子字符串。我要解析的子字符串每次解析时的长度都会有所不同，因此我使用带范围的子字符串来指示子字符串始终介于其间的两个字符。问题是，当我得到一个异常时，异常 - [__NSCFString substringWithRange:]: Range or index out of bounds。任何帮助是极大的赞赏。

我的代码

```
NSString * storyLink = @"http://link.brightcove.com/services/link/bcpid1683318714001/bclid1644543007001/bctid2212677853001?src=mrss"//<--Parsing the numbers between "bctid" & "?src"
NSRange start = [storyLink rangeOfString:@"d" options:NSBackwardsSearch];
NSRange end = [storyLink rangeOfString:@"?" options:NSBackwardsSearch];
NSString *clipid = [storyLink substringWithRange:NSMakeRange(start.location, end.location)];//<--Exception thrown here
NSLog(@"clipid: %@", clipid); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:38:54.853

范围被解释为形式`{ begin, length }`。结构的成员`NSRange`被称为`location`and`length`而不是`begin`and是有原因的`end`。将您的代码更改为

```
NSMakeRange(start.location, end.location - start.location) 
```

它会正常工作。

# javascript - 将 div 附加到搜索文本框以创建类似 Gmail 的搜索框

> ID：15305159
> 
> 赞同：1
> 
> 时间：2013-03-08T23:35:36.287
> 
> 标签：javascript, jquery, twitter-bootstrap, search-box

我正在创建一个类似 Gmail 的搜索框，在其中单击文本框，它会打开一个新的 div，我可以在其中输入各个字段的搜索条件。如何将 TextBox('#searchTextBox) 或包含文本框的 div 与搜索表单 ('#gmailSearchBox) 的 div 紧密相连？此外，我正在使用引导响应，因此文本框的位置和大小会发生变化。所以只设置 div 样式 display:block 和 display:none 不起作用。谢谢。

html代码：

```
<div style="border:1px solid grey; border-radius:3px; max-width:300px; padding-right:0px; padding-left:0px;"class="container-fluid">
    <div style="left:0px;right:20px; line-height:inherit; float:left; width:100%; ">
        <input id="searchTextBox" type="text" style="border:none; width:95%; line-height:inherit; padding:0px 0px 0px 0px;"> 
        <a id="showSearchBox" href="#" style="height:20px">
             <span class="caret" style="vertical-align:middle; height:100%"> </span>
        </a>
    </input>
</div>
</div>
<input type="button" value="Search" Class="btn btn-primary" /><br>
Various<br>
Other<br>
Information<br>
Goes <br>
Here<br>
<div id='gmailSearchBox' class="gmailSearchBox" style="position:absolute; display:none; border:1px solid grey">
<form action="" method="post">
    From:<input type="text" id="fromDate">
    <br/>
    To: <input type="text" id="toDate">
    <br/>
    Type:<select id="logType">
            <option>--Select Type--</option>
        </select>
    <br/>
    Text:<input type="text" id="searchText">
    <br/>
    <input type="submit" class="btn btn-primary">
</form>
</div> 
```

Javascript代码

```
$('#showSearchBox').click(showSearchBox);
function showSearchBox() {
    $('#gmailSearchBox').css('display','block')
} 
```

JsFiddle 链接 - [http://jsfiddle.net/7FBax/](http://jsfiddle.net/7FBax/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:55:59.860

如果您想使用 css 执行此操作，您可能需要稍微更改您的标记。请参阅以下小提琴，它可以满足您的需求：http: [//jsfiddle.net/97BwC/1/](http://jsfiddle.net/97BwC/1/)

修改后的标记：

```
<div id="search" style=""class="container-fluid">
<div id="searchInputWrapper" style="">
    <input type="text" style=""> <a id="showSearchBox" href="#" style="height:20px">
             <span class="caret" style="vertical-align:middle; height:100%"> </span>
        </a>

    </input>
</div>
<div id='gmailSearchBox' class="gmailSearchBox" style="">
    <form action="" method="post">From:
        <input type="text" id="fromDate">
        <br/>To:
        <input type="text" id="toDate">
        <br/>Type:
        <select id="logType">
            <option>--Select Type--</option>
        </select>
        <br/>Text:
        <input type="text" id="searchText">
        <br/>
        <input type="submit" class="btn btn-primary">
    </form>
</div> 
```

的CSS：

```
 #search {
        position:relative;
        border:1px solid grey;
        border-radius:3px;
        max-width:300px;
        padding-right:0px;
        padding-left:0px;
    }
    #searchInputWrapper {
        left:0px;
        right:20px;
        line-height:inherit;
        float:left;
        width:100%;
    }
    #searchInputWrapper input {
        border:none;
        width:95%;
        line-height:inherit;
        padding:0px 0px 0px 0px;
    }
    #gmailSearchBox {
        position:absolute;
        bottom:-212px;
        right:0;
        display:none;
        border:1px solid grey;
        background-color:#fff;
    } 
```

**更新：**

如果搜索框的高度不是静态的，您可以使用 javascript 设置底部偏移量。这是一个更新的小提琴：http: [//jsfiddle.net/GPTJ4/2/](http://jsfiddle.net/GPTJ4/2/)

这是修改后的处理程序：

```
$('#showSearchBox').click(showSearchBox);

function showSearchBox() {
    var height = 0,
        $searchBox = $('#gmailSearchBox');

    $searchBox.css({display:'block'});

    //get the height of the search box
    height = $searchBox.height();

    //set the offset equal to the height
    $searchBox.css({bottom:-height +'px'});
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:05:48.873

如果您将 #gmailSearchBox 放在包含输入的同一 div 中，它将按您的意图工作。您可能还想为#gmailSearchBox 设置背景颜色。

# scala - 在 Scala 中读取键盘输入，键入的字符可见

> ID：15305160
> 
> 赞同：8
> 
> 时间：2013-03-08T23:35:36.803
> 
> 标签：scala, console, user-input

我知道从键盘读取输入`readInt`的`readLine`类似方法，并且能够使用用户键入的数据填充变量。但是在 REPL 中，输入字符时什么都不会显示。REPL 中是否有设置使它们可见？还是我应该使用其他方式来读取用户的输入？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T20:43:51.890

我很惊讶这还没有得到答复。不久前我遇到了同样的问题。尝试像这样运行 REPL：

```
C:\> scala -Xnojline 
```

这应该禁用 JLine 并允许您以`readLine`您期望的方式使用该方法（在您键入时显示键入的字符）。

# c++ - 如何解决错误：无法在 C++ CLR 中从 'OSamp::Weapon' 转换为 'OSamp::Weapon'

> ID：15305163
> 
> 赞同：0
> 
> 时间：2013-03-08T23:36:02.320
> 
> 标签：c++, visual-c++, c++-cli

我收到奇怪的错误，说无法将类型转换为自身！
谁能告诉我这里出了什么问题！?

```
public ref class Weapon{

private :
    int Slot_, Id_, Ammo_;
    System::String^ Name_;

public :
    Weapon(EWeapons Id, int Ammo) : Id_((int)Id), Ammo_(Ammo){}
    Weapon(int Id, int Ammo) : Id_(Id), Ammo_(Ammo){}

//other part of code...
}

property OSamp::Weapon Weapon{
    OSamp::Weapon get(){
        return OSamp::Weapon(1, 1000);
// error C2440: 'return' : cannot convert from 'OSamp::Weapon' to 'OSamp::Weapon'
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:04:39.390

您应该使用**[值类](http://www.drdobbs.com/ccli-value-class-types/184401955)**而不是引用类。

值类可以通过值传递，不需要通过引用指针传递。

# javascript - Node.js - 事件不会触发？

> ID：15305164
> 
> 赞同：0
> 
> 时间：2013-03-08T23:36:04.257
> 
> 标签：javascript, node.js, eventemitter

我有一些代码应该监听某些事件并处理它们，但要么这些事件实际上从未发出，要么监听器永远不会捕获它们。

这里有两个模块：监听的服务器和处理的应用程序（应用程序是主模块）。

server.js：

```
var events = require('events'),
    util   = require('util'),
    dgram  = require('dgram');

var Server = function() {
    this.self = this;
    events.EventEmitter.call(this);

    this.socket = dgram.createSocket('udp4');
    this.init = function(port) {
        this.socket.bind(port);
        console.log('Listening on port ' + port);
    }

    this.socket.on('message', function(buf, rinfo) {
        var rawInfo = buf.toString().split('&');
        var data = {};

        for (var i = 0; i < rawInfo.length; i++) {
            var key = rawInfo[i].split('=')[0];
            var val = rawInfo[i].split('=')[1];
            data[key] = val;
        }

        var type = data.type;

        console.log('emitting event type ' + type);
        this.emit(type, data);
    });
};

util.inherits(Server, events.EventEmitter);

// exports
module.exports = Server; 
```

（这是唯一可能创建的对象）：

```
{   type: 'login',
    name: 'x3chaos',
    displayname: 'x3chaos',
    world: 'world' } 
```

应用程序.js：

```
var dgram  = require('dgram');
var Server = require('./server');

var server = new Server();
server.init(41234);

// FIXME
server.on('login', function(data) {
    console.log('received data');
    console.log(data);
}); 
```

这里有什么问题：事件没有触发还是听众没有听？
它也可能只是我想念的东西。你知道他们怎么说两个头...

蒂亚:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:42:13.793

I think that this.emit wont work because you're in a callback, and this wont refer to the Server instance but to the callback context. Upthere, instead of this.self=this try to do var self=this and then inside the callback do self.emit...

# lisp - 基本 LISP 问题

> ID：15305166
> 
> 赞同：1
> 
> 时间：2013-03-08T23:36:11.063
> 
> 标签：lisp, common-lisp

所以`(car '(2 3)) -> 2`

```
(cdr '(2 3)) -> (3) 
```

我应该使用哪个函数来获得产生 3 的东西？

```
(function-name '(2 3)) -> 3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T23:40:39.220

简单地做应该没问题：

```
(car (cdr '(2 3))) 
```

这与以下内容相同：

```
(cadr '(2 3)) 
```

这是因为“car”获取表达式中的第一个元素，而 cdr 返回列表的其余部分，没有第一个元素。您已经展示了“(cdr '(2 3))”返回一个“(3)”列表。因此，这个的“汽车”是元素（不是列表），“3”。顺便说一句，“（cdr（cdr（'2 3）））”是“（cdr（3））”，即“（）”。

LISP 不好玩吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:42:37.383

Hints:

`car` refers to the first *element* in the list.

`cdr` refers to the *remainder* of the list, and is itself a list.

So what you need is a function that returns the first element from a list containing the last element.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T05:33:33.193

你也可以使用`(second '(2 3))`. `second`是 的另一个名称`cadr`。

# html - 如何让我的搜索查询显示在 URL 中？

> ID：15305167
> 
> 赞同：2
> 
> 时间：2013-03-08T23:36:13.587
> 
> 标签：html, asp.net-mvc, razor, asp.net-mvc-4, url-routing

使用 MVC 4

我有一个部分视图，我正在创建一个搜索框。单击提交按钮时，它将我的搜索值传递给控件以过滤我的组。

一切都过滤得很好。但是，我希望在执行操作后获得的 url 没有出现。我只是得到本地主机/

我想显示的是 localhost/mySearchValue

我的项目中的路由已设置，因此如果我要在本地主机之后键入一个值，它将像我的搜索按钮一样过滤组。

关于我需要做什么才能让我的搜索值显示在 URL 中的任何想法？

这是我的部分观点

```
@using (Html.BeginForm("List","Group"))
{ 
   @Html.TextBox(name: "search")
   <input type="submit"  value="search" />
} 
```

我的控制器

```
public ViewResult List(string search, int page = 1)
    {
        if (search == "")
        {
            search = null;
        }
        GroupsListViewModel model = new GroupsListViewModel
        {
            Groups = repository.Groups
            .Where(g => search == null || g.Tag == search || g.Tag2 == search)
            .OrderBy(g => g.GroupId)
            .Skip((page - 1) * PageSize)
            .Take(PageSize),
            PagingInfo = new PagingInfo
            {
                CurrentPage = page,
                ItemsPerPage = PageSize,
                TotalItems = repository.Groups.Count()
            },
            CurrentSearch = search
        }; 
```

*更新*

```
@Html.BeginForm("List","Group",FormMethod.Get) 
```

帮助我获取如下 localhost/?search=test 的 url，但是在调用控制器时未设置搜索，因此不会发生过滤。我用于搜索的 url 架构如下 localhost/test

这是我的路由信息

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(null, 
            "",
            new { 
                controller = "Group", action = "List",
                search = (string)null, page = 1
            }
    );

        routes.MapRoute(null,
            "Page{page}",
            new { controller = "Group", action = "List", search = (string)null },
            new { page = @"\d+" }
            );

        routes.MapRoute(null,
            "{search}",
            new { Controller = "Group", action = "List", page = 1 }
            );

        routes.MapRoute(null,
            "{search}/Page{page}",
            new { controller = "Group", action = "List" },
            new { page = @"\d+" }
        );

        routes.MapRoute(null, "{controller}/{action}");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:41:47.670

## Description

As long as i understand the question

Default form method is `POST` so you need set the form method to `GET` in order to see the search string in the url.

Please let me know (as a comment) if i dont understand what your want in order to help you more)

## Sample

```
@Html.BeginForm("List","Group",FormMethod.Get) 
```

## More Information

*   [MSDN - FormExtensions.BeginForm Method](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.formextensions.beginform%28v=vs.108%29.aspx)

# trading - Amibroker：每个代码个性化的公式

> ID：15305174
> 
> 赞同：1
> 
> 时间：2013-03-08T23:36:39.393
> 
> 标签：trading

是否可以为每个股票“个性化”一个公式？在 AFL，我想测试不同股票代码的“不同”购买条件。例如：

股票代码 AAPL，规则 A

股票代码 MSFT，规则 B

然后，每 5 分钟运行一次 AFL 测试。

具体例子：

> 股票代码='AAPL';
> 
> 买入=交叉（MACD（），信号（））；
> 
> Alertif(..."MAIL", "买苹果因为 Macd Cross");
> 
> ticker='MSFT' Buy = Close>EMA(Close,100);
> 
> Alertif(..."MAIL", "买苹果因为 Macd Cross");

等等。

可能吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T20:24:35.090

```
if ( Name()=="AAPL" )
{
Buy = Cross( MACD(), Signal() );
Alertif(..."MAIL", "Buy Apple beacuase Macd Cross");
}

if ( Name()=="MSFT" )
{
Buy = Close>EMA(Close,100);
Alertif(..."MAIL", "Buy Apple beacuase Macd Cross");
} 
```

# ajax - 使用 Ajax 和 Json 将数据加载到表单中的附加行

> ID：15305178
> 
> 赞同：0
> 
> 时间：2013-03-08T23:37:18.670
> 
> 标签：ajax, json, jquery

好的，我有一个表，用户可以在其中追加一行，如下所示：

```
// Append New Row To Email Change Form //
$(function () {
var count = 1000;
$('#AddRow').click(function () {
    $('table.subgrid tbody').append('<tr><td><input type="hidden" name="delete[]" value="No">No</td><td><input type="text" name="customernumber[]" id="' + count + '_cust" onChange="ajax_customer_info(' + count + ')" maxlength="6" /></td><td><span id="' + count + '_name"></span></td><td><select name="type[]"><option value="A">ACH</option><option value="C">Credit</option><option value="I">Invoice</option><option value="S">Statement</option></select></td><td><select name="deliverymethod[]"><option value="E">Electronic</option><option value="P">Print</option></select></td><td><input size="40" type="text" class="fieldname" maxlength="50" name="newemailaddress[]" /><input type="hidden" name="oldemailaddress[]" /><input type="hidden" name="companyid[]" value="1" /><input type="hidden" name="action[]" value="add" /></td></tr>');
    count++;
}); 
```

});

在这一行中，他们可以输入一个客户编号，通过 ajax 应该自动返回客户名称。这是阿贾克斯：

```
function ajax_customer_info(row) {
xmlHttp=GetXmlHttpObject();
if (xmlHttp!=null) {
    var url="/hq/servlet/customerinfo";
    url=url+"?customernumber="+document.getElementById(row+"_cust").value;
    url=url+"&sid="+Math.random();
    xmlHttp.onreadystatechange=function(row) {
        if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            xmlDoc=xmlHttp.responseXML;
            var data = JSON.parse(xmlHttp.responseText);
            document.getElementById(row+"_name").innerHTML=data.name;
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
} 
```

问题是这不会填充客户名称。我注意到如果我在此删除行+：

```
document.getElementById(row+"_name").innerHTML=data.name; 
```

并用 say ("name") 替换它，当然将相应的 id 更改为它工作的附加行中的那个。但是，我需要唯一的 id，因为用户可以附加多行。谁能告诉我我在这里做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:45:29.727

You are setting a parameter `row` to your ajax on ready state function, this will be used instead of the row value you passed to `ajax_customer_info`. Therefore use `xmlHttp.onreadystatechange=function()` instead of `xmlHttp.onreadystatechange=function(row)`

# dojo - 什么是 class="centerPanel"

> ID：15305181
> 
> 赞同：0
> 
> 时间：2013-03-08T23:37:30.883
> 
> 标签：dojo, dijit.layout

我看到许多 Dojo 示例和教程都传递了属性“class”：“centerPanel”，但我在任何地方都找不到任何文档。

它是什么？它似乎被传递给布局，但它是做什么用的？（我知道它是一个 CSS 类，但它在哪里定义？）

[这是 dojo 教程中的一个示例](http://dojotoolkit.org/documentation/tutorials/1.8/dijit_layout/demo/appLayout.php)

我想了解的片段是这样的：

```
 <div class="centerPanel"
         data-dojo-type="dijit/layout/ContentPane"
         data-dojo-props="region: 'center'">
        [...]
    </div> 
```

# php - 如何在 PHP 中读取 xfdf 字段 - 从提交的 PDF

> ID：15305184
> 
> 赞同：0
> 
> 时间：2013-03-08T23:37:36.847
> 
> 标签：php, pdf, fdf, xfdf

我正在向 php 脚本提交 PDF 表单（xfdf 格式）。然后 php 将文件（xfdf）和电子邮件（作为附件）保存到一些电子邮件中。我希望能够从 xfdf 文件（发件人姓名和电子邮件）中提取两个字段，用作包含 xfdf 附件的电子邮件上的“发件人：”。我不需要所有字段，而且我知道字段名称。如果可能的话，我想在不安装任何其他库的情况下使用简单的 php。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:05:11.713

XFDF 文件是 XML 文件（请参阅[Adob​​e XFDF Spec 3.0](http://partners.adobe.com/public/developer/en/xml/XFDF_Spec_3.0.pdf)）。

PHP 有许多[库](http://www.php.net/manual/en/refs.xml.php)可以让您从 XML 文件中提取数据。检查您的服务器设置，哪些库在您的安装中可用。由于您已经完成了 XFDF 上传和电子邮件发送工作，您需要做的就是：

*   打开上传的文件
*   阅读其内容
*   解析xml
*   提取您需要的数据

确切的步骤将取决于您的 XFDF 文件的内容和您选择的库。

# performance - node.js 中的动态路由性能与 express

> ID：15305188
> 
> 赞同：0
> 
> 时间：2013-03-08T23:37:48.560
> 
> 标签：performance, node.js, mongodb, routing, express

我必须在快速应用程序中创建 /:username 类型的路由。我可以想到两种方法，我想知道哪种方式更优化性能。第一个是通过调用 db 来动态提供路由服务，如果存在用户名来提供所需的配置文件。第二个是创建一个函数，以便在创建用户时将其个人资料 url 硬编码到应用程序中，然后在删除用户时将其删除。这样，每当请求这种类型的 url 时，就不会调用数据库。所以问题是第二种情况下的性能问题是什么，如果有的话，每种情况的优缺点是什么，主要是性能方面的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:47:18.477

做第一个。我不能谈论性能（但我觉得从长远来看第一个会更快），但是如果你的应用程序（不是说这会发生）像 Facebook 一样受欢迎，然后你有 1 000 000 000 会发生什么您的快速应用程序中的路线？即使尝试启动您的应用程序也会变得可笑。

数据库可以处理这个问题，如果你真的很担心，你可以保留已经检查过的用户名的缓存。第一次检查时添加它们，如果用户名被删除，则删除它们。

我现在也想到了；无论如何，您是否不必执行几乎相同的查询来获取信息以填充配置文件？如果您建议在创建帐户时为每个配置文件创建静态页面，请不要这样做。这就是数据库的设计目的，因此以这种方式使用它们是非常安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:24:40.073

我只是使用 /:username 并将它放在我的其他路线下方，因此它不会取代其他页面，例如 /login

如果该用户名没有用户，那么我将他们重定向到主页。

使用猫鼬，您可以执行以下操作：

```
//app.js
app.get('/:username', routes.profile.get);

//route handler
User.findOne({ username: req.params.username}, function(err, owner){
  if ( !owner ) {
      req.flash('error', 'Woops, looks like that account doesn\'t exist.');
      res.redirect('/');
  }

  //do something with owner
}); 
```

# c# - 在 ViewModel 中异步加载数据（使用 async 和 await）不适用于数据绑定

> ID：15305189
> 
> 赞同：15
> 
> 时间：2013-03-08T23:37:52.353
> 
> 标签：c#, data-binding, mvvm, windows-phone-8, async-await

我使用已经定义了视图模型的默认模板启动了一个电话应用程序。我修改了 MainViewModel 的 LoadData() 方法以异步调用 odata 服务。但它不适用于数据绑定。我已经验证调用成功返回但没有显示结果。

LongListSelector 的项目源绑定到视图模型中的 Items 属性。

```
<phone:LongListSelector ItemsSource="{Binding Items}" x:Name="MainLongListSelector" Margin="0,0,-12,0" SelectionChanged="MainLongListSelector_SelectionChanged">
                <phone:LongListSelector.ItemTemplate>
                    <DataTemplate>
                      <StackPanel Margin="0,0,0,17">
                            <TextBlock Text="{Binding UnReadCount}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}"/>
                            <TextBlock Text="{Binding description}" TextWrapping="Wrap" Margin="12,-6,12,0" Style="{StaticResource PhoneTextSubtleStyle}"/>
                      </StackPanel>
                    </DataTemplate>
                </phone:LongListSelector.ItemTemplate>
            </phone:LongListSelector> 
```

这是我对视图模型的修改（注意 async 和 await 的用法）：

```
public void LoadData()
    {
        FetchTileViewItems();        
    }

    private async void FetchTileViewItems()
    {
        var ret = await I2ADataServiceHelper.GetTileViewItemsAsync();
        this.Items = new ObservableCollection<TileViewItem>(ret);
        this.IsDataLoaded = true;
    } 
```

我像以前一样在页面上的 NavigatedTo 事件中调用 LoadData() 方法：

```
protected override void OnNavigatedTo(NavigationEventArgs e)
        {
            if (!App.ViewModel.IsDataLoaded)
            {
                App.ViewModel.LoadData();
                pr1.IsVisible = false;
            }
        } 
```

点击运行，什么都没有出现……我错过了什么吗？非常感谢任何指针。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-09T03:36:47.643

好的，快速回答是您可能缺少您的和/或设置器`INotifyPropertyChanged`上的通知。`Items``IsDataLoaded`

更长的答案需要一点时间。:)

首先，你应该避免`async void`. 我在我[的异步编程最佳实践](http://msdn.microsoft.com/en-us/magazine/jj991977.aspx)文章中详细描述了原因。在这种情况下，请考虑您的错误处理。很高兴您的快乐情况是“呼叫成功返回”，但悲伤的情况会破坏您的程序。

`async Task`所以，让我们尽可能地重写所有内容，并在我们这样做的时候[遵循`*Async`约定：](http://msdn.microsoft.com/en-us/library/hh873175.aspx)

```
public async Task LoadDataAsync()
{
    await FetchTileViewItemsAsync();
}

private async Task FetchTileViewItemsAsync()
{
    var ret = await I2ADataServiceHelper.GetTileViewItemsAsync();
    this.Items = new ObservableCollection<TileViewItem>(ret);
    this.IsDataLoaded = true;
}

protected override async void OnNavigatedTo(NavigationEventArgs e)
{
    if (!App.ViewModel.IsDataLoaded)
    {
        await App.ViewModel.LoadDataAsync();
    }
} 
```

`async`这是编写代码的更自然的方式。

接下来，让我们修复该错误情况。你*可以*做一个`try`/ `catch`in `OnNavigatedTo`：

```
protected override async void OnNavigatedTo(NavigationEventArgs e)
{
    try
    {
        if (!App.ViewModel.IsDataLoaded)
        {
            await App.ViewModel.LoadDataAsync();
        }
    }
    catch (Exception ex)
    {
        ...
    }
} 
```

但实际上我更倾向于使用以 ViewModel 为中心、数据绑定友好的系统来处理错误。这样，“断开连接”对于您的应用程序来说是一种非常自然的状态；即使它所做的只是显示一条错误消息，您的应用程序最终也是为偶尔连接的系统（即电话）而*设计的。*此外，生成的代码更具可测试性。

我在我的几篇博客文章中描述了这种方法：我在关于构造函数的文章中介绍了[异步初始化模式](http://blog.stephencleary.com/2013/01/async-oop-2-constructors.html)，特别是在关于属性的文章中介绍了[数据绑定。](http://blog.stephencleary.com/2013/01/async-oop-3-properties.html)我编写了一个名为的帮助程序类，它使您能够与数据绑定一起使用。`async``async`[`TaskCompletionNotifier`](http://nitoasyncex.codeplex.com/wikipage?title=TaskCompletionNotifier)`Task`

将这些设计落实到位，您的 ViewModel 代码最终看起来更像这样：

```
public sealed class MyViewModel : INotifyPropertyChanged
{
    public ObservableCollection<TileViewItem> Items
    {
      get { return _items; }
      private set { _items = value; RaisePropertyChanged(); }
    }

    public ITaskCompletionNotifier Initialization { get; private set; }

    public MyViewModel()
    {
        Initialization = TaskCompletionNotifierFactory.Create(InitializeAsync());
    }

    private async Task InitializeAsync()
    {
        var ret = await I2ADataServiceHelper.GetTileViewItemsAsync();
        this.Items = new ObservableCollection<TileViewItem>(ret);
    }
} 
```

（这是假设您要开始在构造函数中加载数据。）

然后你可以`Items`直接绑定到，你也可以绑定到`Initialization.IsSuccessfullyCompleted`快乐的情况，`Initialization.IsFaulted`悲伤`Initialization.ErrorMessage`的情况等。

# xml - xsl 方法中的自闭合标签：xml

> ID：15305190
> 
> 赞同：4
> 
> 时间：2013-03-08T23:37:56.317
> 
> 标签：xml, xslt, html, methods

我正在使用一个使用“xsl 方法：xml”来创建 html 模板的网站。但是，当 xsl 引擎呈现 html 页面时，我遇到了标签自动关闭的问题。

`<div></div>`转换为 =>`<div/>`

由于方法需要保留 xml，否则页面的其他组件将无法正确呈现，这一事实使这个问题更加复杂。

关于如何告诉 xsl 为节点做一个特殊例外的任何想法`<div>`？

这个问题和这个问题类似，只是我想保留method:xml。 [XSLT 自闭标签问题](https://stackoverflow.com/questions/887739/xslt-self-closing-tags-issue)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T23:57:19.540

默认情况下，method=xml 不可用。您可以通过以下几种方式处理它：

**选项 1 - 切换到 method=xhtml**

如果你不能切换到method=xml，并且你使用的是XSLT 2.0 解析器，也许你可以试试method=xhtml？

```
<xsl:output method="xhtml" indent="yes" /> 
```

这将使您的结束标签被呈现。

**选项 2 - 将空格添加到“div”标签**

或者，只需添加`<xsl:text> </xsl:text>`（标签之间有一个空格）以使您`<div>`不为空（当然，如果您可以使用空格）。

考虑以下 XML：

```
<div></div> 
```

当转换为：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

  <!-- output is xml -->
  <xsl:output method="xml" indent="yes" />

  <xsl:template match="div">
    <div>
      <!-- note space here -->
      <xsl:text> </xsl:text>
      <xsl:value-of select="text()" />
    </div>
  </xsl:template>
</xsl:stylesheet> 
```

它产生输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<div> </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-06T07:50:56.413

我有同样的问题。问题是 XmlTextWriter 只会弄乱 html。试试下面的代码：

```
public static string Transform(string xmlPath, string xslPath, XsltArgumentList xsltArgumentList)
    {
        string rc = null;
        using (System.IO.MemoryStream ms = new System.IO.MemoryStream())
        {
            XPathDocument myXPathDoc = new XPathDocument(xmlPath);
            XslCompiledTransform myXslTrans = new XslCompiledTransform();
            myXslTrans.Load(xslPath, new XsltSettings(true, true), null);
            myXslTrans.Transform(myXPathDoc, xsltArgumentList, ms);
            ms.Position = 0;
            using (System.IO.TextReader reader = new System.IO.StreamReader(ms, Encoding.UTF8))
            {
                rc = reader.ReadToEnd();
            }
        }
        return rc;
    } 
```

我使用 XsltArgumentList 将信息传递给 xslt。如果您不需要将参数传递给您的 xslt，您可以像这样调用该方法：

```
string myHtml = Transform(myXmlPath, myXslPath, new XsltArgumentList()); 
```

# comparator - 如何用四个 2 位比较器创建一个 8 位比较器？

> ID：15305191
> 
> 赞同：0
> 
> 时间：2013-03-08T23:38:32.100
> 
> 标签：comparator, fpga, xilinx

我正在 Xilinx ISE Project Navigator 中设计一个 8 位比较器。我的目标是添加四个 2 位比较器，如图所示。输入是一个 16 位的字面量，其中前 8 位是数字 A，第二个是数字 B (SW(15:8) -> A; SW(7:0) -> B)。有两个输入 BTN0 和 BTN1，我使用 BTN0 为第一个比较器提供 EQ 输入值 1。在 ISim 中，如果两个数字相等，比较工作正常，但当我尝试使用两个不同的数字时会变得很奇怪。我正在从多个来源工作，而且我是一个初学者，所以很容易出现我没有想到的错误/错误。 [http://25.media.tumblr.com/4e443e33d84b43e80e4f595b0044ab86/tumblr_mjd7vttpuc1r65yueo1_1280.png](http://25.media.tumblr.com/4e443e33d84b43e80e4f595b0044ab86/tumblr_mjd7vttpuc1r65yueo1_1280.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T10:11:36.653

恐怕2位比较器不正确。例如，如果 A1 = 1，A0 = 0，B1 = 0，B0 = 0，则 AND3B1 的输出为 0，AND4B1 的输出也将为 0，因此 AG = 0。

# matlab - Matlab while 循环；函数中的函数

> ID：15305192
> 
> 赞同：0
> 
> 时间：2013-03-08T23:38:46.857
> 
> 标签：matlab

如何在另一个函数中循环一个函数，直到双方相等？

例如

在我找到这个“f”之后

```
f = (1/(-1.8*log(((epsilon/D)/3.7)^2 + 6.9/Re)))^2; 
```

我想使用 f 的值并在此处输入

```
f = (1/ -2.0*log((epsilon/D) + (2.51/Re*sqrt(***f***))))^2 
```

该程序应该循环直到双方相等或相对接近。可接受的准确度或误差是`0.00001`.

以及如何显示给 mme wha 的 f 值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:09:08.563

I'm assuming that's fix point iteration you are attempting to use there, with your first code line being a starting estimate and your second code line being the actual fixed point iteration.

In this case you need to simply repeat that second statement while testing the difference between successive iterations. Something like this for example.

```
f = 1;
df = 1;

while abs(df) > 0.0001
  fnew = log(20/f);
  df = fnew - f;
  f = fnew;
end; 
```

BTW. The above is a simple example of fixed point iteration to solve f*exp(f)=20, [or equivalently f = ln(20/f)]. Apply the same logic to your particular equation for "f", but beware that not all equations are amenable to fixed point iteration.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:04:33.957

在我看来，您正在尝试解决表达式

```
f = somefun(f); 
```

其中 f 的初始值由下式给出

```
f = (1/(-1.8*log(((epsilon/D)/3.7)^2 + 6.9/Re)))^2 
```

您最好的选择（如果您可以使用）是使用 Matlab 的优化工具箱，您可以在其中将要最小化的函数设置为

```
f - somefun(f) 
```

以及您可以在哪里设置公差使用`optimset('TolFun', 1e-5);`

如果您没有工具箱，那么 drN 在使用牛顿方法的评论中的建议可能与任何其他方法一样好 - 您将通过自己的操作学到更多。

# filemaker - 在同一表的门户中显示 4 条记录

> ID：15305195
> 
> 赞同：0
> 
> 时间：2013-03-08T23:39:12.020
> 
> 标签：filemaker

我有一个包含学生成绩的表格。这些结果一般分为四种类型：term1、term2、term3 和 term4。因此，在一年多的时间里，一个学生在该表中最多可能有四个记录，其中包含他的结果。

我想创建一个包含门户的布局，该门户将在单个门户行中显示所有 4 条记录。有没有办法做到这一点？或者任何解决方法？

我不想在门户中将记录显示为四行的原因是因为科目不同，如果每个科目占四行并且学生可能会选择很多科目，那将是不对的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T02:47:09.283

我可以想到两种方法来解决这个问题，这两种方法都需要从您的**结果**表事件到基于结果的另一个表事件的关系，我们称之为**Results~SameStudentID**。（匹配字段是 Student 表的外键，FK_StudentID = FK_StudentID。）

1.  在结果表中创建 4 个计算字段：Result_1、Result_2、Result_n 等。用于每个计算的公式（从**结果**表出现的上下文开始）将是：

    ```
    GetNthRecord ( Results~SameStudentID::Result ; n ) 
    ```

    然后，只需在您的门户中包含 4 个“Result_n”字段

2.  使用以下公式仅创建一个字段 Results_1_4：

    ```
    Substitute ( List ( Results~SameStudentID::Result ) ; ¶ ; "    " ) 
    ```

# python - Python反向替换

> ID：15305196
> 
> 赞同：-5
> 
> 时间：2013-03-08T23:39:22.990
> 
> 标签：python

帮助修复反向方法...（文本到数字，然后反向，数字到文本）下面是未经编辑的完整代码。

```
chars=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","t","s","u","v","w","x","y","z","!","@","#","$","%","^","&","*","(",")","<",">","?","/","[","]","{","}","-","_","=","+"," "];
numbs1=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49"];
rechars1=dict(zip(chars,numbs1));
rechars2=dict(zip(numbs1,chars)); # ??
stringa=raw_input(""); #Letters and symbols only-->encrypt
stringb=''.join(rechars1.get(c,c) for c in stringa);
stringc=''.join(rechars2.get(c,c) for c in stringb); # ??
print "Plain:     ",stringa;
print "Encoded:   ",stringb;
print "Unencoded: ",stringc; #same as stringb?? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:41:43.390

*如果*您知道每个输入字符都被翻译（不包含数字或其他字符），那么您可以将其反转如下：

```
decipher = dict(zip(numbs1,chars)) 
stringc = ''.join(decipher[stringb[i:i+2]] for i in range(0, len(stringb), 2));
print "Decoded: ", stringc 
```

*但是*，如果单个输入字符没有被翻译，那么像这里这样的成对的字符是行不通的（因为每对字符在原始字符中不会排列成一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:13:01.337

障碍是如何将诸如*“20051920”之*类的字符串分解为两位数的列表。如果你克服了这个问题，你可以使用*rechars2*将其翻译回来。

我的解决方案使用正则表达式：

```
import re
stringb = '20051920'
print re.findall(r'\d\d', stringb) # ['20', '05', '19', '20'] 
```

# mysql - 第 29 行的错误 1115 (42000)：未知字符集：'utf32'

> ID：15305199
> 
> 赞同：3
> 
> 时间：2013-03-08T23:39:36.883
> 
> 标签：mysql, sql, database

我正在尝试将 mysqldump 文件导入本地数据库。我正在使用以下命令

```
mysql5 -u root -p fbpj < anthonyl_fbpj.sql 
```

并出现以下错误

```
ERROR 1115 (42000) at line 29: Unknown character set: 'utf32' 
```

__ 下面是在最底部抛出错误的转储部分。我对可能发生的事情感到困惑。

```
-- phpMyAdmin SQL Dump
-- version 3.4.11.1
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Mar 02, 2013 at 03:49 PM
-- Server version: 5.5.23
-- PHP Version: 5.2.17

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `anthonyl_fbpj`
--

-- --------------------------------------------------------

--
-- Table structure for table `comments`
--

CREATE TABLE IF NOT EXISTS `comments` (
  `id` varchar(36) NOT NULL,
  `project_id` varchar(36) NOT NULL,
  `user_id` varchar(36) NOT NULL,
  `task_id` varchar(36) NOT NULL,
  `data_type_id` varchar(36) NOT NULL,
  `data_path` varchar(255) DEFAULT NULL,
  `message` longtext,
  `created` datetime DEFAULT NULL,
  `modified` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_comments_users` (`user_id`),
  KEY `fk_comments_projects1` (`project_id`),
  KEY `fk_comments_data_types1` (`data_type_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf32; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T00:05:32.353

您的表`comments`设置为使用MySQL [v5.5.3](http://dev.mysql.com/doc/relnotes/mysql/5.5/en/news-5-5-3.html)`UTF32`之前不支持的字符集。

您可能正在尝试将此转储导入到早期版本的 MySQL 中。

在加载它之前，您可以通过在转储中更改`utf32`为来摆脱它。`utf8`

# ruby-on-rails - 使用 Heroku、CKEditor gem、Paperclip 和 Amazon S3 将内容从临时站点部署到生产

> ID：15305202
> 
> 赞同：0
> 
> 时间：2013-03-08T23:39:50.097
> 
> 标签：ruby-on-rails, heroku, amazon-s3, ckeditor, paperclip

我有一个使用 ckeditor 的 rails 站点，因此用户可以在该站点上构建页面。通常，他们在临时站点上开发页面并将更改推送到生产服务器。在用户在私有服务器上托管站点和任何图像之前，ckeditor 使用图像的相对路径。例如，在 ckeditor 创建的资产的内容字段中：

```
img src=\"/uploads/images/mypic.jpeg\" 
```

但是，我们现在正在过渡到 Heroku，并且我们正在使用 Amazon S3 来托管文件。结果，ckeditor 必须使用绝对路径。例如：

```
img src=\"http://mybucket_staging.s3.amazonaws.com/uploads/images/mypic.jpeg\" 
```

这使得从暂存到生产的部署成为问题，因为即使正确的图片在生产桶中，当数据库被推送到生产时，ckeditor 资产的内容字段仍将指向暂存桶。反正有没有让这更有活力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T11:53:40.337

如何使用一个[配置](https://devcenter.heroku.com/articles/config-vars)变量——在生产和登台上设置不同的变量——并根据这个变量的值填充路径？

# http - 流式传输 Http 请求的正文时如何处理错误

> ID：15305203
> 
> 赞同：36
> 
> 时间：2013-03-08T23:39:50.470
> 
> 标签：http, protocols

如何处理 Http 消息中间的服务器错误？

假设我已经发送了消息的标头并且正在流式传输消息的正文，当我遇到意外错误时该怎么办。

我还假设此错误是在生成内容时引起的，而不是连接错误。

（大大）简化代码：

```
// I can define any transfer encoding or header fields i need to.
send(header);  // Sends the header to the Http client.

// Using an iterable instead of stream for code simplicity's sake.
Iterable<String> stream = getBodyStream();
Iterator<String> iterator = stream.iterator();

while (iterator.hasNext()) {
    String string;
    try {
       string = iterator.next();   
    catch (Throwable error) { // Oops! an error generating the content.
        // What do i do here? (In regards to the Http protocol)
    }

    send(string);
} 
```

有没有办法告诉客户端服务器失败了，应该重试还是放弃连接，还是我很爽？

代码大大简化了，但我只询问协议而不是确切的代码。

谢谢你

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-09T00:22:57.410

以下其中一项应该做到这一点：

1.  关闭连接（重置或正常关闭）
2.  编写格式错误的块（并关闭连接），这将触发客户端错误
3.  添加一个[http 预告片](https://www.rfc-editor.org/rfc/rfc2616#section-14.40)，告诉您的客户出了点问题。
4.  更改您的更高级别的协议。您发送的最后一条数据是散列或长度，客户端知道要处理它。
5.  如果您可以在开始发送之前生成内容的哈希或长度（如果使用 http 块，则在自定义标头中），您可以在标头中发送它，以便您的客户知道会发生什么。

这取决于您希望客户如何处理数据（保留或丢弃）。您可能无法在客户端进行更改，因此例如最后一个选项将不起作用。

以下是有关关闭的不同方式的一些说明。[TCP 选项 SO_LINGER（零）- 需要时](https://stackoverflow.com/a/13088864/2073920)。

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2013-03-08T23:53:41.087

我认为服务器应该根据[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616#page-70)返回一个以 5xx 开头的响应代码。

> 服务器错误 5xx
> 
> 以数字“5”开头的响应状态代码表示服务器知道它已经出错或无法执行请求的情况。除了响应 HEAD 请求时，服务器应该包含一个实体，其中包含对错误情况的解释，以及它是暂时的还是永久的情况。用户代理应该向用户显示任何包含的实体。这些响应代码适用于任何请求方法。

# arrays - 访问matlab单元数组中的最后一个数据点

> ID：15305205
> 
> 赞同：1
> 
> 时间：2013-03-08T23:40:02.987
> 
> 标签：arrays, matlab, indexing, cell

如果我在 matlab 中的一维向量 (Y) 中有数据，我可以通过调用 'end' 来访问最后一个值，例如 answer = Y(end)。但是，在我的代码中，我使用元胞数组来存储各种长度的向量列表。每个向量都是一维元胞数组中的一个元胞。matlab 中是否有某种方法可以引用存储在特定单元格数组中的向量的最后一个值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T23:45:18.337

You can do this by writing `y{k}(end)` to grab the end of the kth item. Like this:

```
% Make some random vectors:
y1 = [ 1 2 3];
y2 = [ 1 5 9 12];
y3 = [9 48 2 1];

% create a cell array of them:
x = {y1, y2, y3};

% grab the end of the second vector:
k = 2;
x{k}(end) 
```

# opencl - 在 NVIDIA 硬件上运行 OpenCL 程序

> ID：15305212
> 
> 赞同：3
> 
> 时间：2013-03-08T23:40:41.023
> 
> 标签：opencl, gpgpu, gpu

我构建了一个简单的基于 OpenCL 的程序（在 C++ 中）并在带有 AMD FirePro V4900 卡的 Windows 8 系统上进行了测试。我正在使用 AMD APP SDK。

当我将我的二进制文件复制到另一台机器（带有 NVIDIA Quadro 4000 卡的 Windows 8）时，我得到“程序入口点 clReleaseDevice 无法位于动态链接库（我的程序的 exe）中”。第二台机器安装了最新的 NVIDIA 驱动程序和 CUDA 5。

关于我需要什么才能使其与 NVIDIA 硬件一起工作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-05T23:23:23.563

它是 OpenCL 1.1 vs 1.2 版本问题。Nvidia 仍在使用 OpenCL 1.1 版。您使用了 AMD 的 OpenCL 1.2。要获得同时在两个系统上运行的 OpenCL 应用程序，需要删除您的 clReleaseDevice API 调用和其他 1.2 调用，并使用带有 1.1 版本选项的 AMD SDK 重新编译。

# ruby - 为什么 ||= 在哈希上重新分配错误值？

> ID：15305215
> 
> 赞同：2
> 
> 时间：2013-03-08T23:41:11.617
> 
> 标签：ruby, hash

```
foo = { bar: false }
foo[:bar] ||= true 
```

我希望它能够发挥作用，`foo[:bar] = true unless foo.key? :bar`但事实并非如此。如果尚未声明哈希值，是否有更短的方法有条件地声明它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:44:20.000

You can use `.fetch` if you don't need to store the value

```
hash.fetch(:key, :default) 
```

Or give Hash a proc.

```
hash = Hash.new { |hash, key| hash[key] = 'default-value' }
hash[:a] = 'foo'
p hash[:b]
# => 'default-value' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:17:55.793

> 为什么 ||= 在哈希上重新分配错误值？

因为这就是它的用途：如果为假，则分配，否则不要理会。它还应该做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T23:49:07.800

已经讨论了您的代码不起作用的原因，例如[这里](https://stackoverflow.com/questions/995593/what-does-or-equals-mean-in-ruby#2505285)。

根据您的用例，为哈希设置默认值可能是最合适的解决方案：

```
foo = {}
foo.default = true 
```

# java - 未连接 ftp 站点时 GUI 冻结

> ID：15305219
> 
> 赞同：0
> 
> 时间：2013-03-08T23:41:35.853
> 
> 标签：java, swing, user-interface, ftp

这是我的主要课程：

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import javax.swing.UIManager.LookAndFeelInfo;
import java.io.*;
import java.lang.Process.*;

public class FTP {

  public static void main (String []args)
  {
    Runnable runner = new Runnable(){

      public void run()
      {

        LookAndFeel nimbusLook = new LookAndFeel();
        nimbusLook.NimbusLookAndFeel();

        JFrame frame = new JFrame("BNA FTP Diagnose");
        frame.setVisible(true);
        frame.setResizable(false);
        frame.setSize(540, 420);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLocation(150, 150);

        JMenuBar menuBar = new JMenuBar();
        frame.setJMenuBar(menuBar);

        JMenu fileMenu = new JMenu("File");
        menuBar.add(fileMenu);
        final JMenuItem exitMenuItem = new JMenuItem("Exit");
        fileMenu.add(exitMenuItem);

        JMenu helpMenu = new JMenu("Help");
        menuBar.add(new JPanel());
        menuBar.add(helpMenu);
        final JMenuItem aboutMenuItem = new JMenuItem("About");
        helpMenu.add(aboutMenuItem);

        JPanel titlePanel = new JPanel(new BorderLayout());
        frame.add(titlePanel, BorderLayout.NORTH);

        JLabel titleLabel = new JLabel("FTP Diagnose", JLabel.CENTER);
        titleLabel.setFont(new Font(null, Font.BOLD, 14));
        titleLabel.setForeground(Color.BLUE);
        titlePanel.add(titleLabel);

        JPanel gridPanel = new JPanel(new GridLayout(1, 1));
        frame.add(gridPanel);

        JPanel vendorPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        gridPanel.add(vendorPanel);

        final String vendor [] = {"LLesiant" ,"WK-CCH", "Proquest", "Notes", "Research Institute of America", "Thomson", 
          "BNAI PDF Processing", " TM Portfolios to Indexing", "Postscript to PRODLOGIN1", "www.firstdoor.net", "psp.bna.com", "WEST", "LexisNexis", "McArdle Printing Company", 
          "Breaking News Email", "Ex Libris", "Pandora", "Bloomberg Law", "Acquire Media Site 1", "Acquire Media Site 2", "Quicksite", "QA Quicksite"};
        final JComboBox vendorList = new JComboBox(vendor);
        vendorPanel.add(vendorList);

        JPanel diagnoseButtonPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT));
        gridPanel.add(diagnoseButtonPanel);
        final JButton diagnoseButton = new JButton("Diagnose");
        diagnoseButtonPanel.add(diagnoseButton);

        JPanel centerPanel = new JPanel(new BorderLayout());
        frame.add(centerPanel, BorderLayout.SOUTH);
        JPanel commandPanel = new JPanel(new GridLayout(1, 0));
        centerPanel.add(commandPanel);

        final JTextArea commandResultArea = new JTextArea(7, 0);
        JScrollPane scroll = new JScrollPane(commandResultArea, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
        commandPanel.add(scroll);
        commandResultArea.setEditable(false);

        ActionListener buttonListener = new ActionListener(){

          public void actionPerformed(ActionEvent ae)

          {
            int selectedIndex = vendorList.getSelectedIndex();

            String llesiant = "ftp.llesiant.com";
            String wkCCH = "FTP1.cch.com";
            String proquest = "ftp.proquest.com";
            String notes = "notes5.bna.com";

            //String lineThree = null;

            CommandClass readCommand = new CommandClass();

            if (selectedIndex == 0)
            {
              commandResultArea.setText(readCommand.getCommand(llesiant)); //these return strings

            }
            else if (selectedIndex == 1)
            {
              commandResultArea.setText(readCommand.getCommand(wkCCH));
            }
            else if (selectedIndex == 2)
            {
              commandResultArea.setText(readCommand.getCommand(proquest));
            }
            else if (selectedIndex == 3)
            {
              commandResultArea.setText(readCommand.getCommand(notes));
            }

          }

        };
        diagnoseButton.addActionListener(buttonListener);

        ActionListener exitListener = new ActionListener (){

          public void actionPerformed(ActionEvent el)
          {

            if (el.getSource()== exitMenuItem)
            {
              JOptionPane.showMessageDialog(null, "FTP Program will exit now!");
              System.exit(0);
            }

          }

        };

        exitMenuItem.addActionListener(exitListener);

        ActionListener aboutListener = new ActionListener()
        {
          public void actionPerformed(ActionEvent al)
          {

            if (al.getSource()== aboutMenuItem)

            {
              JOptionPane.showMessageDialog(null, "This Software was made for Editors to. \nDiagnose BNA Bloomberg client FTP site.");

            }
          }

        };
        aboutMenuItem.addActionListener(aboutListener);             
      }

    };
    EventQueue.invokeLater(runner);

  }

}

Here is my Look and feel class: 

import javax.swing.UIManager;
import javax.swing.UIManager.LookAndFeelInfo;

public class LookAndFeel {

    public void NimbusLookAndFeel()
    {

        try {
            for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (Exception e) {
            // If Nimbus is not available, you can set the GUI to another look and feel.
        }

    }

}

Here is my CommandClass: 

import java.io.IOException;
import java.io.InputStreamReader;

import javax.swing.JOptionPane;

public class CommandClass {

    public String getCommand(String ftpSite){
        String command = "ftp ";
        StringBuffer output = new StringBuffer();
        try{
             Process p = Runtime.getRuntime().exec(command +ftpSite);
            InputStreamReader ir = new InputStreamReader (p.getInputStream());
            int outputChar = 0;
            while((outputChar = ir.read()) != -1){
                output.append((char)outputChar);
            if(!ir.ready()){ // If the next read is not guarenteed, come out of loop.
                break;
            }
                }
              ir.close();
             JOptionPane.showMessageDialog(null, "FTP is connected");

        }catch (IOException e){
            e.printStackTrace();
        }
        return output.toString();
    }

} 
```

我有这个 FTP GUI，它假设连接到 FTP 站点并返回状态。如果已连接，则会显示连接提示。

当建立 FTP 连接时，我得到了`JTextArea`显示消息，但是当它没有连接到 ftp 站点（例如我的第 4 个 ftp 站点）时，`notes5.bna.com`它会冻结程序。还有一个小问题是，如果您有程序 FTP 到像“shlfsdklaflkhasdlhfas”这样的站点。`JOptionPane`只有在表明 FTP 已连接后才返回 ftp 站点未找到。我不确定它有什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:25:58.207

冻结的原因`notes5.bna.com`是该站点没有响应`FTP`连接请求。由于您只是`Runtime#exec`用来建立连接，这将无限期地阻止响应。考虑使用第 3^方FTP 客户端，例如[Apache FTPClient](http://commons.apache.org/proper/commons-net//javadocs/api-3.2/org/apache/commons/net/ftp/FTPClient.html)，它允许您指定*连接超时*。

一个相关的问题是某些网站要求用户名和密码才能访问。再次`FTPClient`允许您提供登录详细信息。

最后但同样重要的是，不要让重量级的非 UI 任务*冻结*您的 Swing 应用程序。Swing 具有处理这些的机制，例如[SwingWorker 对象](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)。

*   [相关的 Swingworker 网络示例](https://stackoverflow.com/questions/14617331/java-socket-swingworker-running-but-no-message-received-or-transmitted)

# css - 中心 bootstrap 的品牌和列表项

> ID：15305221
> 
> 赞同：4
> 
> 时间：2013-03-08T23:41:45.213
> 
> 标签：css, twitter-bootstrap, alignment

关于将 Twitter bootstrap 的品牌居中或将导航栏中的列表项居中有几个问题，但我还没有弄清楚如何将两者居中。

这是一个示例，在[Modify twitter bootstrap navbar](https://stackoverflow.com/questions/10568103/modify-twitter-bootstrap-navbar)中使用，但它只居中列表项，而不是品牌。下面是 HTML 的结构：

```
<div class="navbar navbar-fixed-top center">
     <div class="navbar-inner">
        ....
     </div>
</div> 
```

和CSS：

```
.center.navbar .nav,
.center.navbar .nav > li {
    float:none;
    display:inline-block;
    *display:inline; /* ie7 fix */
    *zoom:1; /* hasLayout ie7 trigger */
    vertical-align: top;
}

.center .navbar-inner {
    text-align:center;
} 
```

这里有一个现场演示：http: [//jsfiddle.net/C7LWm/](http://jsfiddle.net/C7LWm/)

我如何将品牌和列表项都居中，以便两者都居中在一行上？

**编辑**：

我刚刚注意到，如果您在导航栏中有一个下拉菜单（就像在您更新的答案中一样），下拉菜单真的很乱（下拉菜单根本不显示，如果它显示，表单背景就会消失）。更好的方法可能是，如果所有项目都没有居中并且有一行，那么它们应该都在一行上然后居中，类似于非响应视图，除了现在，还有第二个线。那可能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-04-10T05:26:20.050

要使 UL 居中，您无需编写任何课程。

Bootstrap 提供了您需要的一切，只需执行以下操作：

```
<ul class="list-inline center-block text-center">
 // your list
</ul> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T00:45:48.840

您需要集中的不是容器，`<li>`而是它们的容器。子元素是否浮动并不重要，**只有您真正想要居中的父元素需要是`inline-block`s**。

我不会说这很好，而且您可能需要在较小的屏幕上使用不同的行为，但这在[演示](http://jsfiddle.net/Sherbrow/C7LWm/60/embedded/result/)中有效：

```
.navbar .brand,
.nav-collapse {
    float:none;
    display:inline-block;
    *display:inline; /* ie7 fix */
    *zoom:1; /* hasLayout ie7 trigger */
    vertical-align: top;
}
.navbar-inner > .container { text-align:center; } 
```

确保您的选择器足够具体，仅针对您想要的元素（即不是折叠按钮）

* * *

**使用响应式导航栏**更新：**[响应式演示](http://jsfiddle.net/Sherbrow/C7LWm/63/embedded/result/)**

 **```
@media (max-width: 979px) {
    .navbar .brand,
    .nav-collapse {
        display: block;
    }
} 
```**

# php - PHP delete values from mysql bad

> ID：15305224
> 
> 赞同：-3
> 
> 时间：2013-03-08T23:42:08.410
> 
> 标签：php, mysql

I have a script which works without errors, but can't delete chosen value from mysql. It looks like: What problem could be?

```
include('opendb.php');
$a = $_GET['new_pav'];
$select = mysql_query("SELECT * from naujiena WHERE new_pav = '$a'");
while($row = mysql_fetch_row($select)){
    $result = mysql_query("DELETE FROM `naujiena` WHERE new_pav='".mysql_real_escape_string($a)."' ");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:17:27.313

首先，[**阅读此**](https://stackoverflow.com/a/12860046/765805)（及以下）：

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

红色警告框告诉您停止使用`mysql_*`任何新产品。

至于你的查询，`DELETE FROM x WHERE y=z`是一个有效的查询，所以错误可能来自你使用引号（如果`new_pav`是一个 int，那么这可以解释它）；字符串在 MySQL 中被引用。

此外，不要在 SQL 查询中插入/连接字符串，否则您将面临 SQL 注入的风险。查找[pdo](http://php.net/pdo)，并开始使用涉及状态（数据库连接）而不是变量和无数函数的类。（我最初在这里使用 mysqli ）：

```
try {
    $db = new PDO("mysql:dbname=$dbname;host=$dbhost", $dbuser, $dbpass);
    $query = $db->prepare("SELECT COUNT(*) FROM naujiena WHERE new_pav = :pav");

    if (!$query->bindParam(":pav", $_POST["new_pav"])) {
        die("Input incorrect; couldn't bind");
    }

    $query->execute();
    $rows = $query->fetchColumn(0); // fetch a single column. count(*) here.

    if ($rows !== 0) { // It has a result~
        $query = $db->prepare("DELETE FROM naujiena WHERE new_pav = :pav");
        $query->execute(array(":pav" => $_POST["new_pav"]));
    }
    $db = null; // explicitly close connection

} catch (PDOException $e) { // catch any exception PDO throws at you.
    // note that you should catch where appropriate.
    die("Connection Failed: " . $e->getMessage());
} 
```

请注意，使用 SQL 注入，我可以键入`' OR 1=1 --`并删除您的整个表。

正如您所看到的，这远非单线/两线，但**您绝*不能*相信添加到 SQL 中的任何不是您自己硬编码的东西，期间。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T08:29:10.790

除了使用`mysql_`您的代码库：

```
$select = mysql_query("SELECT * from naujiena WHERE new_pav = '$a'");
while($row = mysql_fetch_row($select)){
    $result = mysql_query("DELETE FROM `naujiena` WHERE new_pav='".mysql_real_escape_string($a)."' ");
} 
```

在`SELECT`你没有逃避价值`$a`但在删除你逃避它。

无论如何，如果您只是进行删除，则不需要`SELECT`or`while`循环。因此，您可以使用以下代码：

```
$result = mysql_query("DELETE FROM `naujiena` WHERE new_pav='".mysql_real_escape_string($a)."' "); 
```

# jsf - Primefaces Datatable unable to select row after ajax update

> ID：15305227
> 
> 赞同：1
> 
> 时间：2013-03-08T23:42:14.160
> 
> 标签：jsf, primefaces

I'm having what I can call a strange behavior.

I have a page with a panel with several drops downs for search purposes and a datatable in it to display the results. By default when the page is loaded the values get initialized by a PostContruct init().

I can perform my search without any problem including updating the datatable.

Now, the part where it gets hard for me is the following: I have a list of tickets with Open/Closed state. My search can be performed with either Open/Closed/ALL.

*   By default the datatable is loaded with only the open tickets and I can select them and redirect to another page using the selectedRow value.
*   When I choose to filter by Closed status and I click the button to search, the datatable gets updated I can select the rows but when I try to open any page I get a null pointer exception in the bean.
*   If I choose all, the datatable gets updated, I can select rows but I can only open the pages with the data that was showed in the first page load, so basically only the tickets that are in the open state. Those that are in Closed that I cannot open them

I'm using RequestScoped bean, I would like to have somehints what could be the problem for the selectRow not work with the new added data.

```
 <ui:define name="content">
        <h:form id="searchForm">
            <p:panelGrid id="searchPanel" style="width: 1000px" styleClass="ticketsPanel">
                <p:row>
                    <p:column>
                        <p:outputLabel for="lstStatus" value="Status"></p:outputLabel>
                    </p:column>
                    <p:column>
                        <p:selectOneMenu id="lstStatus" value="#{ticketController.searchStatus}">
                            <f:selectItem itemValue="Open" itemLabel="Open"></f:selectItem>
                            <f:selectItem itemValue="Closed" itemLabel="Closed"></f:selectItem>
                            <f:selectItem itemValue="ALL" itemLabel="ALL"></f:selectItem>
                        </p:selectOneMenu>
                    </p:column>
                    </p:row>
                <f:facet name="footer">
                    <p:row>
                        <p:column colspan="6" style="alignment-adjust: middle">
                            <p:commandButton value="Search" action="#{ticketController.search()}" update=":searchForm:lstTicketsTable"></p:commandButton>
                            <p:commandButton value="Create" action="/tickets/createticket.xhtml?faces-redirect=true"></p:commandButton>
                            <p:commandButton value="View" action="#{ticketController.doUpdateTicket()}"></p:commandButton>
                        </p:column>
                    </p:row>
                </f:facet>
            </p:panelGrid>

<p:dataTable id="lstTicketsTable" selectionMode="single" paginator="true"
                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {CurrentPageReport}  {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,15,50" rows="10" paginatorPosition="bottom"
                         value="#{ticketController.ticketList}" selection="#{ticketController.selectedTicket}" var="_tl" rowKey="#{_tl.number}">

                <p:column headerText="Ticket NR">
                    <p:outputLabel value="#{_tl.number}"></p:outputLabel>
                </p:column>
                <p:column headerText="Summary">
                    <p:outputLabel value="#{_tl.summary}"></p:outputLabel>
                </p:column>
                <p:column headerText="Contact From">
                    <p:outputLabel value="#{_tl.contactfrom}"></p:outputLabel>
                </p:column>
                <p:column headerText="Researcher">
                    <p:outputLabel value="#{_tl.researcher.email == null ? '' : _tl.researcher.email}"></p:outputLabel>
                </p:column>
                <p:column headerText="NSN SR">

                </p:column>
                <p:column headerText="SR / CR">

                </p:column>
                <p:column headerText="Release">
                    <p:outputLabel value="#{_tl.release}"></p:outputLabel>
                </p:column>
                <p:column headerText="Status">
                    <p:outputLabel value="#{_tl.status}"></p:outputLabel>
                </p:column>
                <p:column headerText="Age">
                    <p:outputLabel value="#{_tl.startdate}"></p:outputLabel>
                </p:column>
                <p:column headerText="Priority">
                    <p:outputLabel value="#{_tl.priority}"></p:outputLabel>
                </p:column>
            </p:dataTable>
        </h:form>
    </ui:define> 
```

And the backing bean functions doUpdateTicket is the one being called in the **View** button and the **Search** the one that updates the list of the datatable.

```
public void doUpdateTicket() {
    FacesContext fc = FacesContext.getCurrentInstance();
    ExternalContext ec = fc.getExternalContext();
    try {
        ec.redirect("/SupportSite/faces/tickets/updateticket.xhtml?tnr=" + this.selectedTicket.getNumber().toString());
    } catch (IOException ex) {
        Logger.getLogger(TicketController.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public void search() {
    FacesContext fc = FacesContext.getCurrentInstance();
    ExternalContext ec = fc.getExternalContext();
    if (this.searchTicketNR != null) {
        Ticket t = tjc.findTicket(Integer.parseInt(this.searchTicketNR));
        if (t != null) {
            try {
               //This works when search by ticket number only
                ec.redirect("/SupportSite/faces/tickets/updateticket.xhtml?tnr=" + t.getNumber().toString()); 
            } catch (IOException ex) {
                Logger.getLogger(TicketController.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    } else if (this.getSearchStatus() != "ALL") {
        setTicketList(tjc.findTicketByStatus(this.getSearchStatus()));
        this.init();
    } else {
        setTicketList(tjc.findTicketEntities());
        this.init();
    }
} 
```

# svn - 如何密封/关闭颠覆存储库

> ID：15305229
> 
> 赞同：1
> 
> 时间：2013-03-08T23:42:28.870
> 
> 标签：svn

我的项目从 svn 切换到了 mercurial。我需要关闭/密封 svn 存储库，这样就没有人再错误地提交它了。我不想关闭 svn 服务器，因为还有其他项目在使用它。

我的 google-fu 让我失望了。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:49:30.270

添加一个预提交钩子`./hooks/pre-commit`（当然是chmod +x）

```
#!/bin/sh
echo "Use the mercurial repository for new code please" 1>&2
exit 1; 
```

# facebook - Facebook api: List facebook users who work or worked for company / page

> ID：15305233
> 
> 赞同：0
> 
> 时间：2013-03-08T23:42:44.040
> 
> 标签：facebook, api

Does anyone know of a way to list facebook users that say on their profile that they work at a given company? or used to work at the company. Not sure if its even possible as i cant find anything in the api docs about this for the page object.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:03:46.683

您只能获取有关该用户的那些在个人资料中公开的信息。

欲了解更多信息，请访问这里 [http://developers.facebook.com/docs/reference/login/](http://developers.facebook.com/docs/reference/login/)

# jquery - Arrow keys gallery navigation

> ID：15305236
> 
> 赞同：0
> 
> 时间：2013-03-08T23:42:52.130
> 
> 标签：jquery

I'm trying to add arrow key navigation to [this image gallery](http://www.pixelfreak.com/x/).

It should work similar to [this](http://jsfiddle.net/N5g8P/)

```
var chosen = "";
$(document).keydown(function (e) { // 38-up, 40-down
    if (e.keyCode == 40) {
        if (chosen === "") {
            chosen = 0;
        } else if ((chosen + 1) < $('li.t').length) {
            chosen++;
        }
        $('li.t').removeClass('selected');
        $('li.t:eq(' + chosen + ')').addClass('selected');
        $('li.t').click(this);
        return false;
    }
    if (e.keyCode == 38) {
        if (chosen === "") {
            chosen = 0;
        } else if (chosen > 0) {
            chosen--;
        }
        $('li.t').removeClass('selected');
        $('li.t:eq(' + chosen + ')').addClass('selected');
        $('li.t').click(this);
        return false;
    }
}); 
```

…but I want each arrow key press to work like a click since it should load a page in the iframe and at the same time perform another click action (moving the yellow frame to the newly selected thumbnail) just like it does now when clicking.

Also it would be great if going down with the arrow keys could force scrolling to keep the selected thumbnail in view.

…if I got this to work I imagine the next issue I'd run into would be that I would lose focus on the main page and the arrow key navigation whenever something is clicked within the iframe. This is a negligible issue but if there was a simple solution for it I would like to use it.

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T03:30:33.393

使用您提供的 jsfiddle，您可以使用 jquery 的 trigger() 方法模拟用户点击。

```
$('li:eq('+whichIndex+') a').trigger("click"); 
```

这将导致单击事件上的当前代码运行。这样您就不必担心有逻辑来跟踪点击或按键。

**Javascript**

```
var chosen = "";
$(document).keydown(function(e){ // 38-up, 40-down
    chosen = $('li.selected').index(); //grab the current selection
    if (e.keyCode == 40) { 
        if(chosen === "") {
            chosen = 0;
        } else if((chosen+1) < $('li').length) {
            chosen++; 
        }
        selectImage(chosen);
        return false;
    }
    if (e.keyCode == 38) { 
        if(chosen === "") {
            chosen = 0;
        } else if(chosen > 0) {
            chosen--;            
        }
        selectImage(chosen);
        return false;
    }
});

function selectImage(whichIndex) {
    $('li:eq('+whichIndex+') a').trigger("click");
}
$("#selection a").click(function() {
    $('li').removeClass('selected'); 
    $(this).parent().addClass('selected');
}); 
```

在这个示例中，keydown 事件只是确定下一个“选择”的元素。一旦找到它，就会调用 selectImage() 函数，该函数基本上模拟鼠标单击所选元素。

单击元素（无论是用户单击，还是通过 jquery 调用的单击）将运行取消选择旧元素并选择新元素的实际逻辑。

可以在此处找到带有此工作示例的小提琴[http://jsfiddle.net/DPHWZ/](http://jsfiddle.net/DPHWZ/)

# cakephp - CakePHP 约定 (2.3.1.) 在不同服务器上的奇怪行为

> ID：15305239
> 
> 赞同：1
> 
> 时间：2013-03-08T23:43:06.730
> 
> 标签：cakephp, cakephp-2.3

我在 Windows 8 上的 XAMPP 数据包上创建了一个应用程序。它工作得很好。

现在，当我将它上传到服务器（Linux）上时，会出现一些问题。

比方说，“客户端状态”。

```
Controller name: "ClientStatuses".
File name: "ClientStatusesController.php".
Plural: "ClientStatuses".
Singular: "ClientStatus". 
```

但是在 Linux 服务器上，它说我必须有“ **ClientstatusesController.php** ”。这是为什么？我需要更改配置以使 XAMPP 和 Linux 服务器上的约定相同？它是.htaccess 中的东西吗？

任何信息都会很棒。谢谢你。:)

这是**CakePHP 2.3.1**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:12:25.270

控制器的约定总是“复数”，因此只有一个正确的名称：

```
ClientstatusesController 
```

见[http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html](http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html)

或尝试[http://inflector.cakephp.org/clientstatus](http://inflector.cakephp.org/clientstatus)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T08:27:47.053

似乎“*nix”对文件夹名称是区分大小写的。它必须是 ClientstatusesController.php。

好吧，在这里我想告诉你我在服务器上上传项目时解决的另一件事。

为了将 JavaScript 数组转换为 JSON，我使用过`JSON.stringify()`并且服务器`json_decode()`在转换回来时总是返回“null”。

我认为这是因为 3 个 BOM 字符。这解决了问题。

```
$table = json_decode(stripslashes($_REQUEST['table']), true); 
```

# android - How do I feed H.264 NAL units to Android MediaCodec for decoding?

> ID：15305241
> 
> 赞同：8
> 
> 时间：2013-03-08T23:43:14.173
> 
> 标签：android, h.264, decoding

I'm trying to figure out how to use Android's MediaCodec class to decode H.264 video. To start, I'm trying to manually parse the NAL units out of an H.264 file and feed them to MediaCodec for decoding. I believe I'm parsing the NAL units out of the file correctly (searching for 0x00 0x00 0x01 sequence in file, indicates the start of a NAL unit), but MediaCodec always times out and returns -1 each time I make a call to dequeueOutputBuffer(). Does anyone know the specifics of how to feed H.264 NAL units to MediaCodec for decoding? Am I supposed to strip off the 0x00 0x00 0x01 sequence before I send it a NAL unit? Do I need to ignore/drop certain NAL unit types? Do I need to prepend the extracted SPS and PPS info (with or without the 0x00 0x00 0x01 sequence) before each NAL unit? I'm playing around with a lot of ideas here and none of them are panning out. Any guidance in this realm would be very much appreciated.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-26T10:26:45.267

就我所经历的而言，只要您不向解码器提供 sps/pps 信息，解码器就会在 dequeueOutputBuffer() 上返回 -1。当你这样做时，解码器应该在 dequeueOutputBuffer() 上返回 INFO_OUTPUT_FORMAT_CHANGED 标志 (-2)，之后将正确返回解码的帧。

如果解码器仍然返回 -1，请尝试使用标志 BUFFER_FLAG_CODEC_CONFIG 将 sps/pps 信息添加到解码器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-30T08:20:12.630

AFAIK 您需要取出标头并将 SPS/PSS 作为第一个缓冲区提供给它，但是获得 -1 并不是什么大问题，这将是一种正常的行为。如果在其他 NAL 之前没有由 SPS/PPS 馈送某些设备，它们将会崩溃

# django - Grappelli - how to change text field size

> ID：15305242
> 
> 赞同：1
> 
> 时间：2013-03-08T23:43:14.313
> 
> 标签：django, django-grappelli

What is the best way to change text field size in Grappelli?

Standard text field with vTextField class is 758px width. I looks strange when used for phone number field.

I have figured out that one possibility is inject style attribute into form meta.

class CompanyForm(ModelForm):

```
class Meta:
    model = Company
    widgets = {
        'phone': TextInput(attrs={'size': 13}),
        'tax_id': TextInput(attrs={'size': 6}),
        'zip': TextInput(attrs={'size': 6, 'style' : 'width: 80px'}),
    } 
```

I am not sure this is the best solution and ....I do not like this (using style inline). Is there any other in the box solution?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:16:22.660

在模型管理中定义自定义样式表（媒体属性）

```
<style type="text/css">
    #id_phone { 
        width: 100px; !important
        }
    .......
</style> 
```

# asp.net-mvc - Controller per category or one controller for all

> ID：15305244
> 
> 赞同：0
> 
> 时间：2013-03-08T23:43:25.980
> 
> 标签：asp.net-mvc, asp.net-mvc-3

In my database I have a tables:

```
Products{ProductId, CategoryId, Name} // parent table
Procesors{ProductId...} // 1 to 1
HardDisks{ProductId...} // 1 to 1
MotherBoards{ProductId...} // 1 to 1
Categories{CategoryId, Name, ParentId} 
```

And products can be `procesor, hard disk, mother board etc.`
**Option 1:** Create controllers

```
ProcesorControllers
HardDiskController
MotherBoardController 
```

etc.
**Option 2:**

```
CategoryController
ProductController 
```

where `ProductController` have a method

```
public ActionResult Index(int categoryId, string category)
{... // return View(products); 
```

In aplication scenario I need CRUD, Filter products

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:47:14.967

CRUD 和过滤器是与任何产品类别无关的通用操作。您的应用程序可能会扩展，以便在一段时间后添加新产品。

考虑到这一点，我会说**选项 1**不会扩展。想象一下每次添加新产品时都会更改代码。

**选项 2**是我会尝试倾向于的。它还将帮助您编写不重复的代码，更少的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T01:51:00.040

简单地说，控制器应该充当给定上下文的容器，因此在 ProductController 中对产品进行分组似乎是合乎逻辑的。

不过这是个人喜好。您需要考虑的是大型控制器的可维护性，以及访问这些端点时要生成的 url。

# windows - Windows 8：如何在 Flipview 控件中禁用触摸？

> ID：15305247
> 
> 赞同：2
> 
> 时间：2013-03-08T23:43:57.217
> 
> 标签：windows, xaml, windows-8, microsoft-metro, windows-runtime

是否可以禁用翻转视图的触摸滚动？

例如，您可以通过将 Horizo​​ntalScrollMode 设置为 False 来禁用 scrollviewers 滚动模式

我只需要暂时禁用它，这样我就可以使用触摸手势操作翻转视图内的画布。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:54:09.243

您可以尝试使用 VisualTreeHelper 在 FlipView 的模板中获取 ScrollViewer 并禁用其滚动。

# c++ - devc++ input from file does not work

> ID：15305249
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:44:16.263
> 
> 标签：c++, dev-c++

I'm trying to redirect a .txt content to .exe

program.exe < file.txt

and contents of file.txt are

```
35345345345
34543534562
23435635432
35683045342
69849593458
95238942394
28934928341 
```

but the first index in array is the file path and the file contents is not displayed.

```
int main(int argc, char *args[])
   {
    for(int c = 0; c<argc; c++){
            cout << "Param " << c << ": " << args[c] << "\n";
    }
    system("PAUSE");
    return EXIT_SUCCESS;
} 
```

Desired output:

```
Param0: 35345345345
Param1: 34543534562
Param2: 23435635432
Param3: 35683045342
Param4: 69849593458
Param5: 95238942394
Param6: 28934928341 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T23:48:59.053

`myapp < file.txt`语法传递给`stdin`（或者`cin`如果你愿意），而不是参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:51:27.833

你误解了什么`argc`和`argv`是为了什么。它们包含程序的命令行参数。例如，如果您运行：

```
program.exe something 123 
```

指向的以空字符结尾的字符串`argv`将为`program.exe`、`something`和`123`。

您正在尝试将文件的内容重定向到`program.exe`使用`< file.txt`. 这*不是*命令行参数。它只是将文件的内容重定向到程序的标准输入。要获取这些内容，您需要从中提取`std::cin`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T23:48:29.213

当您说“但数组中的第一个索引是文件路径并且不显示文件内容”时。听起来您正在尝试从 argv 和 argc 读取输入。尖括号壳运算符不能那样工作。相反，标准输入（cin 和几个 C 函数读取的内容）具有该文件的内容。因此，要在上述情况下从文件中读取，您将使用 cin。

如果您*真的*想将文件自动插入到参数列表中，我无法帮助您使用 windows shell。但是，如果您可以选择使用`bash`，则以下内容将起作用：

```
program.exe `cat file.txt` 
```

反引号运算符扩展为其中包含的命令的结果，因此内容随后作为参数传递给 program.exe（同样，在`bash`shell 下而不是 windows shell 下）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T23:57:43.617

这段代码做了我期望对另一个做的事情。感谢所有帮助过的人。

```
#include <iostream>
#include <string>

using namespace std;

int main()
{
string line;
while (getline(cin, line))
    cout << "line: " << line << '\n';
} 
```

# java - 如何删除以这个词结尾的词？

> ID：15305264
> 
> 赞同：-3
> 
> 时间：2013-03-08T23:45:57.227
> 
> 标签：java, string

我想删除以这些字符串结尾的单词

```
hello_hi
sorry_hr
good_tt 
```

我想删除以 , 结尾的`_tt`单词`_hr`。怎么做？

```
 is this is good way?

       String word = word.replace("_hi", ""); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:29:59.313

所以你有一个像这样的字符串：

```
 String str = "hello_hi sorry_hr good_tt"; 
```

那么你想要的总结在这三个要应用的规则中：

1) 删除 hello_hi，因为它以 _hi 结尾

2）删除_hr并保留这个词，对于这种特殊情况，它会保持抱歉

3）保留good_tt，因为它没有*_hi或*_hr形式，而是*_tt

然后，最后的字符串将是“sorry good_tt”

让我们这样做

```
 String[] strings = str.split(" ");
    ArrayList processed = new ArrayList();
    for (String token : strings) {
        if (token.endsWith("_hr")){ //rule 2
            processed.add(token.replace("_hr", ""));
        } else if (token.endsWith("_hi")) { //rule 1
            continue;
        } else { //any other case, rule 3
            processed.add(token); 
        }
    } 
```

这样，您将在已处理列表中列出结果：**“sorry”**和**“good_tt”**

```
 System.out.println(processed.toString()); 
```

得到以下输出：

```
 [sorry, good_tt] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:56:27.440

我假设您有一个字符串，其中包含以 for 结尾的令牌，`_tt`并且您想从该字符串中删除该单词。

```
String[] tokens = yourStr.split(" ");
for (String t : tokens) {
   if (t.endsWith("_tt") {
       yourStr = yourStr.replaceAll(t, "");
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T23:52:58.830

使用[正则表达式](http://www.regular-expressions.info/java.html)怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T23:53:55.453

```
String[] tokens = str.split(" ");
List<String> good = Lists.newArrayList();
for (String token : tokens) {
    if (token.endsWith("_hr") || token.endsWith("_tt")) continue;
    good.add(clip_end(token));
}
join(good); 
```

`String clip_end(String str)`应该剪掉_hi。这只是对 indexOf 和 substring 的简单调用。

`String join(List<String> strs)`只是与空格连接。

本着 SO 的精神，您可以编写剪辑并加入。为了获得额外的功劳，请将`good`列表替换为 StringBuilder 并将您的输出直接写入其中。

# objective-c - 无法获取数组的索引并将其设为 NSString

> ID：15305265
> 
> 赞同：0
> 
> 时间：2013-03-08T23:46:01.003
> 
> 标签：objective-c, xcode, nsstring, nsarray

我从 JSON 中获取一个数组，并将其解析为一个`NSMutableArray`（这部分是正确的并且有效）。我现在想获取该数组并将第一个对象打印到标签。这是我的代码：

```
NSDictionary *title = [[dictionary objectForKey:@"title"] objectAtIndex:2];
arrayLabel          = [title objectForKey:@"label"];
NSLog(@"arrayLabel = %@", arrayLabel); // Returns correct 

//Here is where I need help

string = [arrayLabel objectAtIndex:1]; //I do not get the first label (App crashes)
NSLog(@"string = %@", string); 
```

我已经尝试过的其他事情如下：

```
string = [NSString stringWithFormat:@"%@", [arrayImage objectAtIndex:1]]; 
```

和

```
string = [[NSString alloc] initWithFormat:@"%@", [arrayImage objectAtIndex:1]]; 
```

非常感谢任何帮助！

编辑：该应用程序不返回单个值并崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:23:37.883

您的代码与 JSON 的结构不匹配。在您对已删除答案的评论中，您说您在发送`objectAtIndex:`到`NSString`. 在您的情况下，`arrayLabel`当您认为它不是数组时。

如果您的 JSON 有一个对象，您的代码需要将其视为`NSDictionary`. 同样适用于数组 and`NSArray`和字符串 and `NSString`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T03:23:43.723

除了发生的任何其他事情之外，您反复引用“first”，但使用索引 1。在大多数基于 C 的编程语言（以及其他语言）中，约定是数组的索引是从 0 开始的。因此，使用索引 0 来获取第一个元素。

# list - 使用 Redemption 创建 pst 文件

> ID：15305266
> 
> 赞同：0
> 
> 时间：2013-03-08T23:46:10.100
> 
> 标签：list, email, outlook-redemption, pst

我正在处理一个涉及解析 .pst 文件的 C# 项目，我的团队选择使用 Redemption 库来执行此操作。我们已经成功地将电子邮件文件解析为 RDOMail 对象，但是现在我们想要将这些电子邮件的一个子集写入一个新的 .pst 文件。我已经使用 email.SaveAs() 函数成功地将子集写入 .eml 文件，但我不知道如何将该列表保存为 .pst。我一直在筛选文档，但是还有很多不足之处。任何使用过救赎的人都可以为我指明正确的方向或提供一个例子吗？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:54:44.860

您将需要使用 RDOSession.Stores.AddPstStore（返回[RDOPSTStore](http://www.dimastr.com/redemption/rdostore.htm)对象）创建/打开 PST 文件。拥有商店后，您可以打开/创建文件夹（从 RDOStore.IPMRootFolder 开始）、创建消息 (RDOFolder.Items.Add) 并将旧消息复制到新消息中 (RDOMail.CopyTo(RDOMail/RDOFolder))。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-03T03:25:36.417

在过去的几个小时里，我一直在努力做到这一点，并希望将这段时间节省给其他人

您必须安装[兑换](http://www.dimastr.com/redemption/download.htm)并将其添加为对您的项目的引用才能正常工作

```
 RDOSession session = new RDOSession(); // throws exception 1

        session.LogonPstStore(@"c:\temp\output.pst");
        RDOFolder folder = session.GetDefaultFolder(rdoDefaultFolders.olFolderInbox);

        string[] fileEntries = Directory.GetFiles(@"C:\emlFiles\", "*.eml");

        foreach (string filePath in fileEntries)
        {
            RDOMail mail = folder.Items.Add("IPM.Mail");
            mail.Sent = true;
            mail.Import(filePath, 1024);
            // folder.Items.Add(mail);
            mail.Save();
        }

        session.Logoff(); 
```

[我还为它创建了一个小的示例 Windows 窗体应用程序，我知道代码很难看，但它可以解决问题](https://github.com/dietbald/EMlToPstTest)

# javascript - 在 webkit 中，在页面渲染与页面加载时发出运行脚本

> ID：15305267
> 
> 赞同：0
> 
> 时间：2013-03-08T23:46:20.397
> 
> 标签：javascript, google-chrome, webkit, rendering

我有一个使用一些元素偏移的脚本。我打算使用以下命令触发此脚本：

```
window.addEventListener('load', function() {
    ...
} 
```

当我使用这个方法时，所有的 DOM 元素都被定义了，但是偏移值是错误的。我可以通过关闭一些 css 值来获得提供的偏移量。我应用了一个快速/可怕的修复：

```
window.addEventListener('load', function() {
    function my_func(){
        ...
    }
    window.setTimeout(my_func, 1000);
}); 
```

这会呈现正确的偏移量，但我感觉就像它的胶带。

我最后一次尝试是强制 webkit 渲染，但这也有错误的偏移量：

```
 window.addEventListener('load', function() {
    function my_func(){
        ...
    }
    document.getElementById('wrap').style.display = 'none';
    document.getElementById('wrap').style.display = 'block';
    my_func();
}); 
```

有什么建议吗？或解释为什么会发生这种情况。我正在测试的浏览器是 Chrome。

编辑 ：

偏移量是 dom 结构：

```
<div id="wrap">
    <div>
        <p>...</p>
        <p>...</p>
        <p>...</p>
    </div>
    <div>
        <p>...</p>
    </div>
   ...
</div> 
```

我通过（for）遍历“#wrap div”的节点列表来访问偏移量。如果我关闭 line-height 和 font-size 我将获得在布局完全呈现之前计算的偏移量。

在使用 offsetHeight 之前调整每个 p 和 div 的 line-height、font-size 和 display 没有影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:58:24.353

您应该使用`load`而不是`ready`或*在页面渲染上*使用，因为您不知道 CSS 和图像何时完成加载。

如果您的偏移量不正确，`load`那么还有其他事情发生。

# android - 如何使用 EditText 和 DatePicker 创建对话框

> ID：15305271
> 
> 赞同：1
> 
> 时间：2013-03-08T23:46:56.047
> 
> 标签：android, dialog, datepicker, android-alertdialog

我正在尝试使用 EditText 和 DatePicker 制作一个对话框。不幸的是，我无法自定义 DatePickerDialog 并且 XML DatePicker 很糟糕（它显示了一个小日历，我不需要它）。

我当前的自定义对话框是：

```
<EditText
    android:id="@+id/title"
    android:inputType="textEmailAddress"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="16dp"
    android:layout_marginLeft="4dp"
    android:layout_marginRight="4dp"
    android:layout_marginBottom="4dp"
    android:hint="Title" />
<DatePicker 
    android:id="@+id/ad_date_picker"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:layout_margin="5dp"/> 
```

有人可以解释我该怎么做吗？

谢谢！

# perl - 将 lib 用于相对于模块的路径

> ID：15305272
> 
> 赞同：1
> 
> 时间：2013-03-08T23:46:58.430
> 
> 标签：perl, perl-module

我在确定`use lib`. 这是我正在尝试做的一个例子：

我有一个目录调用`foo`，其中包含一个名为`myscript.pl`. `myscript.pl`使用一个名为的模块，该模块`Mod1.pm`位于名为 的子目录中`bar`，所以在顶部`myscript.pl`我放了以下几行：

```
 use lib 'bar';
    use Mod1; 
```

这工作正常，直到我想`Mod1.pm`使用另一个模块，`foo/bar/asdf/Mod2.pm`. 如果我将 a`use lib 'asdf'`放在它的顶部`Mod1.pm`将不起作用，因为它相对于我正在运行的目录进行搜索`myscript.pl`。所以我做了一些搜索并找到了`FindBin`，并尝试将这些行添加到 Mod1.pm：

```
 use FindBin;
    use lib "$FindBin::Bin/asdf"; 
```

这也不起作用，因为`FindBin`找到了我正在运行的脚本 ( `myscript.pl`) 所在的目录，而不是使用的文件`FindBin`（在这种情况下`Mod1.pm`）。所以我的问题是，有没有一种方法可以相对于所在位置进行搜索`Mod1.pm`，以便`Mod2.pm`无论使用的脚本在哪里都可以找到`Mod1.pm`？

编辑：进一步解释我的情况以解决您的一些评论：

我正在处理存储库中的代码，所有 CPAN 库都需要安装在存储库的目录中。这意味着`use lib`s 不能有任何绝对路径。对于我的项目，有一个中央模块“Mod1.pm”，其中包含`use`很多 CPAN 模块，它们位于存储库的各个目录中。所有`use lib`语句的格式都是`use lib '../../foo/bar/asdf'`这样的，因此可以相对于您运行脚本的位置找到它们，但这限制了您可以运行使用 Mod1.pm 的脚本的位置，我试图避免这种情况。另一个恼人的副作用是我不能`perl -c Mod1.pm`确保我对 Mod1.pm 所做的任何编辑都是合理的，除非我在正确的位置运行它，而这不是 Mod1.pm 所在的位置。哦，加入一个已经有混乱代码的项目的乐趣......另一个令人讨厌的副作用是我不能使用你们中的任何人建议的任何 CPAN 模块来解决我的问题，因为我仍然需要一种方法找到那些。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T04:44:07.587

你应该`use lib`在`myscript.pl`，这是一个约定。

例如，您的文件组织为：

```
.
├── bar
│   ├── Mod1.pm
│   └── asdf
│       └── Mod2.pm
└── myscript.pl 
```

然后`use lib`在`myscript.pl`：

```
use File::Spec;
use FindBin qw($Bin);
use lib File::Spec->catdir($Bin, 'bar');
use Mod1; 
```

然后使用`Mod1.pm`，`Mod2.pm`就像使用其他 CPAN 模块一样。使用时记得在模块名前加上目录名`Mod2.pm`。

在`Mod1.pm`：

```
package Mod1;

use asdf::Mod2;

1; 
```

在`Mod2.pm`：

```
package asdf::Mod2;

1; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-09T05:17:49.297

*通常*您希望您的主程序自行查找其所有库，在这种情况下，您应该按照 Alec Chen 的回答进行操作。

在某些情况下，例如查找插件，您希望一个库能够找到与其位置相关的其他库。

您可以使用[`__FILE__`](http://perldoc.perl.org/functions/__FILE__.html)包含源代码当前文件的位置来执行此操作。

```
package Mod1;

use strict;
use warnings;

use File::Basename;

# Must put this in a BEGIN block so it happens at "compile time" while the
# "use"s are being executed.  But the "my" declaration must happen outside
# the BEGIN block else it can't be seen.
my $module_dir;
BEGIN { $module_dir = dirname(__FILE__); }

use lib $module_dir;

use Mod2; 
```

上面写的有趣的方式是因为每个 Perl 文件都有两个（或更多）执行阶段。“编译时间”和“运行时间”。 `use`语句发生在编译时。为了做到`use lib $module_dir`这一点，我们必须`$module_dir`在编译时设置一个`BEGIN`块。使困惑？有更简单的方法...

`@INC`模块全局更改是不好的形式。加载模块不应更改程序的全局状态（除非这是其功能的一部分）。相反，您将对其进行本地化。

```
package Mod1;

use strict;
use warnings;

use File::Basename;
my $module_dir = dirname(__FILE__);

{
    local @INC;
    push @INC, $module_dir;
    require Mod2;
} 
```

但是直接将其作为文件需要它可能更简单。

```
package Mod1;

use strict;
use warnings;

use File::Basename;
use File::Spec;
my $module_dir = dirname(__FILE__);
require File::Spec->catfile($module_dir, "Mod2.pm"); 
```

而且，这是 Perl，有一些模块可以处理插件，[Module::Pluggable](https://metacpan.org/module/Module%3a%3aPluggable)非常流行。

# c++ - Qt 5.0 包括个人标题问题

> ID：15305275
> 
> 赞同：0
> 
> 时间：2013-03-08T23:47:06.603
> 
> 标签：c++, qt, include

看起来我对使用 Qt 的 c++ 编程有点陌生，所以我已经在我的 win 7 64 位上下载了 5.0 版本。我创建了一个名为 Mafenetre 的类，我实现了它的代码，它看起来很完美，但是当我尝试运行主程序时，它显示 C:\Users\Zbart3i\Downloads\Programs\test\main.cpp:3: error: C1083:无法打开包含文件：“Mafenetre.h”：没有这样的文件或目录

这是我的专业代码：

```
SOURCES += \
    main.cpp \
    mafenetre.cpp

QT+=widgets

HEADERS += \
    mafenetre.h 
```

这是 Mafenetre.h 的代码：

```
#ifndef MAFENETRE_H
#define MAFENETRE_H

include <   QtWidgets>

class Mafenetre:public QWidget
{
public:
    Mafenetre();
private:
    QPushButton *m_bouton;

};

#endif // MAFENETRE_H 
```

这是 Mafenetre 的.cpp：

```
#include      "mafenetre.h"

Mafenetre::Mafenetre():QWidget()
{
    setFixedSize(300,150);

    m_bouton=new QPushButton("pimp mon bouton",this);

    m_bouton->setFont(QFont("monotype corsiva",15));
    m_bouton->setCursor(Qt::PointingHandCursor);

} 
```

和 main.cpp

```
#include<    QtWidgets/QApplication>
#include<    QtWidgets>
#include<    Mafenetre.h>

void main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    Mafenetre fenetre;

    fenetre.show();
    app.exec();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:37:09.387

In C++, you should use the *#include "name"*, not *#include* (Quote marks instead of triangle brackets), as they have different meanings.

*#include* looks in certain directories where libraries (including the standard library) is installed. *#include "name"* looks first in your project's folders, and then checks the other directories.

Well, to be technically accurate, what folders they look in, and in one order, is compiler-specific.

This:

```
#include <Mafenetre.h> 
```

Should be this:

```
#include "Mafenetre.h" 
```

Read this:

> [MinGW #include search directories](http://www.mingw.org/wiki/IncludePathHOWTO)
> 
> ## Other Directories Searched by Default
> 
> The minimal list of directories, identified as described above, specifies the only locations which will be searched by default, for system header files or for headers associated with user installed libraries; however, there is one exception. Astute readers may have noticed that the include file search path is itemised in a pair of sequential lists, with the second being concatenated to the first; however, the first, identified as the #include "..." search list appears to be empty. In reality, this apparent emptiness is possibly misleading; unless the user specifies the "-I-" option when invoking GCC, this list contains exactly one directory: the directory in which the source file containing the #include "file" directive resides.
> 
> **Notice that this one additional directory is not searched for headers specified with the `#include <file>` form of the #include directive; it applies only for those headers specified using the `#include "file"` form of the directive.**

And make sure your "Mafenetre.h" file is in the same folder as your main.cpp file. Otherwise you need to do #include "folderPath/fileName.h", and also add the path to the **SOURCES** or **HEADERS** variables in the .pro file.

Also make sure the spelling is identical, and that the proper case is used - sometimes it matters, sometimes it doesn't.

If you are still having trouble, try to compile a simple project consisting of just a single main.cpp, to make sure everything is installed correctly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:45:03.460

你确定你已经包含了正确的标题。此外，我没有看到您在头文件中使用 QObject 宏。它应该是这样的：

Mafenetre.h：

```
#ifndef MAFENETRE_H
#define MAFENETRE_H

#include <QWidget>

    class Mafenetre : public QWidget
    {
        Q_OBJECT
    public:
        explicit Mafenetre(QWidget *parent = 0);

    signals:

    public slots:

    };

    #endif // MAFENETRE_H 
```

Mafenetre.cpp：

```
#include "mafenetre.h"

Mafenetre::Mafenetre(QWidget *parent) :
    QWidget(parent)
{
} 
```

最后你的 main.cpp 应该是这样的，检查标题：

```
......
#include "mafenetre.h"

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    Mafenetre m;
    m.show();

    return a.exec();
} 
```

# php - 如何检查字符串是否包含特定文本

> ID：15305278
> 
> 赞同：100
> 
> 时间：2013-03-08T23:47:25.970
> 
> 标签：php

```
<?php
$a = '';

if($a exist 'some text')
    echo 'text';
?> 
```

假设我有上面的代码，如何编写语句“if($a exist 'some text')”？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2013-03-08T23:50:34.850

使用`strpos`函数： http: [//php.net/manual/en/function.strpos.php](http://php.net/manual/en/function.strpos.php)

```
$haystack = "foo bar baz";
$needle   = "bar";

if( strpos( $haystack, $needle ) !== false) {
    echo "\"bar\" exists in the haystack variable";
} 
```

在你的情况下：

```
if( strpos( $a, 'some text' ) !== false ) echo 'text'; 
```

请注意，我使用`!==`运算符（而不是`!= false`或`== true`什至只是`if( strpos( ... ) ) {`）是因为[PHP](http://php.net/manual/en/types.comparisons.php)处理`strpos`.

从 PHP 8.0.0 开始，您现在可以使用[str_contains](https://www.php.net/manual/en/function.str-contains.php)

```
<?php
    if (str_contains('abc', '')) {
        echo "Checking the existence of the empty string will always 
        return true";
    } 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-08T23:49:29.647

空字符串是错误的，所以你可以写：

```
if ($a) {
    echo 'text';
} 
```

尽管如果您询问该字符串中是否存在特定的子字符串，您可以使用它`strpos()`来执行此操作：

```
if (strpos($a, 'some text') !== false) {
    echo 'text';
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-08T23:50:03.213

[http://php.net/manual/en/function.strpos.php](http://php.net/manual/en/function.strpos.php) 我认为如果字符串中存在“某些文本”，您会很奇怪吗？

```
if(strpos( $a , 'some text' ) !== false) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-08T23:54:09.453

如果您需要知道字符串中是否存在某个单词，您可以使用它。由于您的问题尚不清楚您是否只想知道变量是否为字符串。其中 'word' 是您在字符串中搜索的单词。

```
if (strpos($a,'word') !== false) {
echo 'true';
} 
```

或使用 is_string 方法。whichs 在给定变量上返回 true 或 false。

```
<?php
$a = '';
is_string($a);
?> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-08T23:52:04.870

您可以使用`strpos()`或`stripos()`检查字符串是否包含给定的针。它将返回找到它的位置，否则将返回 FALSE。

在 PHP 中使用运算符`===`或 `!== 将 FALSE 与 0 区分开来。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-08T23:50:03.510

您可以使用`==` [比较运算符](http://php.net/manual/en/language.operators.comparison.php)来检查变量是否等于文本：

```
if( $a == 'some text') {
    ... 
```

您还可以使用`strpos`函数返回字符串的第一次出现：

```
<?php
$mystring = 'abc';
$findme   = 'a';
$pos = strpos($mystring, $findme);

// Note our use of ===.  Simply == would not work as expected
// because the position of 'a' was the 0th (first) character.
if ($pos === false) {
    echo "The string '$findme' was not found in the string '$mystring'";
} else {
    echo "The string '$findme' was found in the string '$mystring'";
    echo " and exists at position $pos";
} 
```

[查看文档](http://www.php.net/manual/en/function.strpos.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-08T23:52:52.077

你可以使用这个代码

```
$a = '';

if(!empty($a))
  echo 'text'; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-03-08T23:55:24.843

是否意味着检查 $a 是否为非空字符串？所以它只包含任何文本？然后以下将起作用。

如果 $a 包含一个字符串，您可以使用以下内容：

```
if (!empty($a)) {      // Means: if not empty
    ...
} 
```

如果您还需要确认 $a 实际上是一个字符串，请使用：

```
if (is_string($a) && !empty($a)) {      // Means: if $a is a string and not empty
    ...
} 
```

# python - 我们可以为不同的记录器使用相同的处理程序吗

> ID：15305281
> 
> 赞同：4
> 
> 时间：2013-03-08T23:47:36.817
> 
> 标签：python, logging

是否建议对 Python 中的不同记录器使用相同的处理程序。例如：

```
logger = logging.getLogger('sth')
logger.setLevel(logging.DEBUG)
handler = logging.StreamHandler()
formatter = logging.Formatter('[%(levelname)1.1s %(asctime)s %(funcName)s:%(lineno)d] - %(message)s', '%y%m%d %H:%M:%S')
handler.setFormatter(formatter)
handler.setLevel(logging.DEBUG)
logger.addHandler(handler)
logger.propagate = False

logging.getLogger().addHandler(handler)
logging.getLogger().setLevel(logging.DEBUG) 
```

在这里，我设置了两个记录器，一个名为“sth”，另一个是根记录器。我为两个记录器分配了相同的处理程序。到目前为止，我的使用情况似乎还不错，但我想知道路上*是否有任何问题？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T12:14:43.693

通常最好将处理程序添加到需要它们的最高级别记录器。在您的示例中，您可以通过仅将处理程序添加到根记录器而不将记录器`propagate`上的标志设置为.`sth``False`

将相同的处理程序添加到多个记录器应该没有什么害处，但是如果您不禁用传播，它可能会导致消息在日志中重复。

许多应用程序只是将处理程序添加到根记录器并让传播处理其余部分，其他应用程序仅为特定要求向非根记录器添加额外的处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:56:41.350

可能不是。也许是的。可能有。谁知道？

换句话说，它依赖于 Handler。它们不打算被重用：有些实现可能没问题，有些可能有内部状态可能会被搞砸。

根据经验，我会复制该对象，而不是重复使用它。

# android - 被垃圾回收破坏的活动和 backstack 中的所有片段都显示，而不是仅显示当前活动

> ID：15305284
> 
> 赞同：1
> 
> 时间：2013-03-08T23:47:45.090
> 
> 标签：android, android-fragments

因此，当您离开活动设置=>开发人员选项=>不保留活动时，我启用了销毁活动的设置

这应该基本上复制一个被垃圾收集的活动或片段，然后我必须通过包保存的实例状态恢复数据。

所以我理解它是如何工作的。但是，当我从片段 1 导航到片段 2，然后将应用程序置于后台，然后置于前台（破坏活动）时，片段 1 和片段 2 似乎同时显示。其中应该只显示片段 2。

我不知道这是否是我必须管理隐藏和显示片段 onsavedinstance 的标准。或者如果我的代码中的某些东西破坏了东西。以下是我推送片段的方式，希望对您有所帮助：

```
public void pushFragmentWithAnimation(FragmentManager fm, int parentId, Fragment currentFrag, Fragment newFrag, int animEntry, int animExit) {
    hideSoftKeyboard(currentFrag.getActivity());
    FragmentTransaction ft = fm.beginTransaction();
    // See: http://developer.android.com/reference/android/app/FragmentTransaction.html#setCustomAnimations(int, int, int, int)
    ft.setCustomAnimations(animEntry, animExit, animEntry, animExit);
    ft.add(parentId, newFrag, String.format("Entry%d", fm.getBackStackEntryCount())).hide(currentFrag).show(newFrag);
    ft.addToBackStack(null);
    ft.commit();
} 
```

片段 1 仍在后台堆栈中，因为当我按下返回时，我只看到片段 1。如果您知道为什么会发生这种情况，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:05:06.627

XML 添加的 Fragments 和以编程方式添加的 Fragments 的生命周期差异很大，以至于将它们混合在一起是个坏主意，如在[此处](http://portabledroid.wordpress.com/2011/04/19/programmatic-and-layout-fragments/)详细解释的那样。

解决此问题的最简单方法是通过将 XML 膨胀片段替换为相同 ID 的 FrameLayout 以编程方式添加所有片段，然后在 onCreate 添加

```
FragmentManager fragMgr = getSupportFragmentManager();
if (null == fragMgr.findFragmentByTag(FRAG_TAG))
{
    fragMgr.beginTransaction().
        add(R.id.fragment, new Fragment1(), FRAG_TAG).commit();
} 
```

`FRAG_TAG`任何唯一字符串在哪里。这确保了 Fragment1 仅在它不在布局中时才被创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T20:00:26.687

我不完全确定为什么这个解决方案有效。我假设它与活动是否被杀死有关，它不会跟踪当前显示的片段并显示所有片段。所以基本上我需要更换：

```
ft.add(parentId, newFrag, String.format("Entry%d", fm.getBackStackEntryCount())).hide(currentFrag).show(newFrag); 
```

和

```
ft.replace(parentId, newFrag, tag); 
```

然后当我在主要活动中创建初始片段时。我只会在

```
if(savedInstanceState==null){ 
```

我更新的代码如下：[https ://github.com/CorradoDev/FragmentTest/tree/2c53f9f42e835da768f61b0233f3ab5b3adf2448](https://github.com/CorradoDev/FragmentTest/tree/2c53f9f42e835da768f61b0233f3ab5b3adf2448)

# wolfram-mathematica - Mathematica 9：如何解决最大化问题？

> ID：15305285
> 
> 赞同：0
> 
> 时间：2013-03-08T23:47:49.007
> 
> 标签：wolfram-mathematica, maximization

如何`$\tau$`在 Mathematica 9 中最大化以下方程：

```
$$max_\tau \sqrt{(1 - \tau)y^i} + \sqrt{\tau y}$$ 
```

我想找到类似的东西

```
$$\tau^i = \frac{y}{y^i + y}$$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:00:52.390

令 x = Τ 然后 f(x, y) = sqrt((1-x)*y^c) + sqrt(xy)

我假设 c 是一个常数，所以这里只有两个自变量。

所以取 x 的一阶偏导数并将其设置为零。

[Wolfram Alpha](http://www.wolframalpha.com/input/?i=d/dx%20%28sqrt%28%281-x%29%2ay%5Ec%29%20%20%2b%20sqrt%28x%2ay%29%29)可以帮助您。

# php - 如何在 PHP 中使用羊群？

> ID：15305296
> 
> 赞同：7
> 
> 时间：2013-03-08T23:49:06.637
> 
> 标签：php

在我的 php 代码中，我想创建一个读写器代码。所以会有一个php代码枯萎读取或写入的文件。只能有 1 个写者，也可以有多个读者，但可以同时写和读。

如何在 PHP 中做到这一点？我相信你需要使用`flock`代码？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T23:54:35.453

我[同意 Danack 的评论](https://stackoverflow.com/questions/15305296/how-to-use-flock-in-php#comment21603309_15305296)- 的[php 文档](http://www.php.net/manual/en/function.flock.php)包含`flock()`一个非常好的示例：

```
$fp = fopen("/tmp/lock.txt", "r+");

if (flock($fp, LOCK_EX)) { // exclusive lock will blocking wait until obtained

    fwrite($fp, "Write something here\n");

    // or ...

    execute_code_that_shouldnt_run_twice_at_the_same_time();

    flock($fp, LOCK_UN); // unlock
} else {
    echo "failed to obtain lock";
}

fclose($fp); 
```

请注意，`flock()`在默认模式下会阻塞等待，直到它可以获取锁。如果其他进程当前获得锁，则通常是这种情况。

* * *

但不要对`flock()`功能抱有太大的期望。它使用所谓的*咨询锁*，其他进程可以忽略它。在 Linux 上，例如 PHP`flock()`使用内核函数`flock()`，`man 2 flock`解释它是如何工作的：

> flock() 仅放置咨询锁；给定文件的适当权限，进程可以自由地忽略flock() 的使用并在文件上执行I/O。

意义`flock()`只会给其他进程一个建议。如果他们不关心，无论锁（或锁的类型）如何，他们都可以读取甚至写入。然而，手册页是关于 Linux 的，其他系统可能会以不同的方式处理这个问题。（实际上并非如此）

但是，由于您是进程的编码员，因此您可以/并且应该关心`flock()`每次访问文件时使用的锁。但是您不能确定另一个进程（例如文本编辑器）不会覆盖您的文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:57:02.197

如果你想同时阅读和写作，那么你不能。这是不安全的行为。只需使用排他锁写入，您的读者（使用共享锁）将在等待能够读取它时阻塞。这样他们就永远无法从部分完成的文件中读取，但最终总是能够读取。

哦，不要锁定文件超过你需要的时间。如果您正在进行长时间的更改（例如等待网络活动），请将其锁定、更新、解锁，等到您获得更多数据，然后锁定、更新、解锁。或者更好的是，在内部缓冲数据并一次性写入。

# html - 连续 3 个带背景的 div

> ID：15305298
> 
> 赞同：0
> 
> 时间：2013-03-08T23:49:12.580
> 
> 标签：html, css-float

我正在尝试将 3 个 div 放在一行 [1][2][3] 中。

[1] 应该有一个向左重复的背景图像

[2] 必须居中。它的 1000 像素

[3] 应该有一个向右重复的背景图像

问题是 [1] 出现在 [2] 的顶部，[3] 在 [2] 的下方，而 [1] 和 [3] 的背景图像不出现。如果我只是放一种颜色而不是图像，它就会出现（路径是正确的）。

HTML：

```
 <div id="topleft">left</div> 
 <div id="top" >  
      <div class="container"/>  
          <div id="header">Menu</div>  
      </div> 
 </div> 
 <div id="topright">right</div> 
```

CSS：

```
#topleft {
  background-image: url(images/leftrepeat.png);
  background-repeat: repeat-x;
  float: left;
}

#top .container {  
  background-image:url(images/center.png);  
  background-repeat:no-repeat;  
  min-height:151px;  
  width:1000px;
  float: center;
}  

#topright {
  background-image: url(images/rightrepeat.png);
  float: right;
  background-repeat: repeat-x;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T04:15:37.830

您需要在 div 中有一些东西才能显示背景图像。你不能有只有背景图像的空 div... 就像上面说的，尝试在 div 上设置宽度和高度，你可以在里面放一些文本，可能与背景图像的颜色相同。或者您可以在 div 内放置一个具有正确宽度/高度的透明图像，然后将背景图像放在后面......

是的，漂浮在所有东西上！

尝试以百分比设置 div 的宽度。这样他们应该在屏幕大小/分辨率之后自动调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:58:22.083

将所有花车更改为

```
 float:left; 
```

将三个元素水平堆叠在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:00:37.540

您需要将 HTML 中的“容器”上方的“右上角”移动

```
<div id="topleft"> 
  left
</div> 

<div id="topright">  
     right
</div> 

 <div id="top" >  
      <div class="container"/>  
          <div id="header">  
           Menu
           </div>  
       </div> 
</div> 
```

然后容器的 CSS 应该删除 float: center; 并添加边距：0 auto；

至于图像，请确保它们应该出现的路径，并且 div 足够大以显示背景图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T00:03:22.340

`float:center;`无效 - 要将元素放在同一行，您可以将它们全部浮动。对于最右边的元素 (#topright)，您可以选择将其浮动到右侧，具体取决于您的布局。

如果您希望#top 与#topleft 和#topright 在同一行，则它需要是浮动元素，而不是.container。

对于您的背景图像 - 您是否尝试为#topleft 和#topright 设置宽度和高度？

# jquery - 带有嵌套 div 的悬停列表项

> ID：15305299
> 
> 赞同：0
> 
> 时间：2013-03-08T23:49:20.373
> 
> 标签：jquery

我使用的是旧的 jquery 版本，这就是下面使用 live() 的原因。

```
$('#searchresult li').live({
        mouseenter: function () {
            $(this).addClass('active');
        },
        mouseleave: function () {
            $(this).removeClass('active');
        }
}); 
```

我的html结构：

```
<ul id="searchresult">
    <li>
         <div>a</div>
    </li>
</ul> 
```

CSS：

```
.active { background-color: Red; } 
```

我的代码适用于除 IE7 以外的所有浏览器。背景颜色闪烁，我猜这是因为它只在我悬停列表元素而不是 div 时发生变化。

有什么方法可以包含 div 吗？

更新：

# [小提琴](http://jsfiddle.net/yTsw5/3/show/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:03:42.690

如果你只是简单地修改样式，你可以只使用[`:hover`](https://developer.mozilla.org/en-US/docs/CSS/%3ahover)CSS 中的伪类。

```
#searchresult li:hover {
    background-color: red;
} 
```

**[DEMO](http://jsfiddle.net/dRyW3/show/)**（用于支持 IE7 的 jsfiddle“显示”视图）

**更新：**

根据您[更新的小提琴示例](http://jsfiddle.net/yTsw5/3/show/)，我相信这是由您的[浮动元素](http://css-tricks.com/all-about-floats/)引起的问题。

在以下示例中，我使用的是[micro clearfix hack](http://nicolasgallagher.com/micro-clearfix-hack/)。确保将 clearfix 类（`cf`在本例中）添加到所有`searchitem`包含浮动子项的元素中。

**HTML**

```
<li class="searchitem cf">
    ...
</li>
... 
```

**CSS**

```
/* For modern browsers */
 .cf:before, .cf:after {
    content:"";
    display:table;
}
.cf:after {
    clear:both;
}
/* For IE 6/7 (trigger hasLayout) */
 .cf {
    zoom:1;
} 
```

**[更新的演示](http://jsfiddle.net/2ZWBE/4/show/)**

# php - MySQL，如何添加积分系统？（连续堆叠变量。）

> ID：15305303
> 
> 赞同：1
> 
> 时间：2013-03-08T23:49:41.270
> 
> 标签：php, mysql

我想要做的是在我的脚本中添加一个点系统，它会在他们的行中添加一个小点值，我已经尝试对我的数据库进行以下查询。（不是一下子，哈哈）

```
$query = "INSERT INTO `users` SET `points` = '$points' WHERE `username` = '$username'";
$query = "UPDATE `users` SET `points` + 5 WHERE `username` = '$username'";
$query = "UPDATE `users` SET `points` = '$points' WHERE `username` = '$username'"; 
```

我已经得到它来添加积分，但是每次我做另一个动作时，它会在我当前的积分余额中添加更多积分，它只是更新该积分数量，而不是将该积分总和添加到已经存在的余额中。

编辑：

我使用的点的变量是：

```
$points + 5; OR $points = $points + 5; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:52:19.700

关闭。试试这个：

```
$query = "UPDATE `users` SET points = points + 5 WHERE `username` = '$username'"; 
```

# c++ - Windows::工具栏::NM_CUSTOMDRAW。更改工具栏背景颜色

> ID：15305304
> 
> 赞同：1
> 
> 时间：2013-03-08T23:49:42.890
> 
> 标签：c++, winapi, toolbar

这是代码的摘录。创建前工具栏的样式：

```
DWORD styles = TBSTYLE_FLAT | WS_CHILD  | TBSTYLE_TOOLTIPS; //| TBSTYLE_CUSTOMERASE;//| WS_BORDER ;
DWORD cc_styles =  CCS_VERT | CCS_NODIVIDER | CCS_NORESIZE; 
```

处理 NM_CUSTOMDRAW：

```
 case WM_NOTIFY:
        switch ( ((LPNMHDR)lparam)->code )
{
...
        case NM_CUSTOMDRAW:
        {
            //LPNMHDR header_ptr = safe_ptr_cast< LPNMHDR >( &lparam );
            //if ( header_ptr->hwndFrom == m_ptr->get_operation_tab_toolbar_handle( ) )
            LPNMTBCUSTOMDRAW data_ptr = (LPNMTBCUSTOMDRAW) lparam;
            switch(data_ptr->nmcd.dwDrawStage) 
            {
                case CDDS_ITEMPREPAINT:
                    SetWindowTheme(m_ptr->get_operation_tab_toolbar_handle(), _T(""), _T(""));
                    //data_ptr->hbrMonoDither = GetStockBrush(BLACK_BRUSH);
                    SetBkColor( data_ptr->nmcd.hdc, RGB(0,0,0));
                    FillRect( data_ptr->nmcd.hdc, &data_ptr->nmcd.rc, RGB(0,0,0));
                    //FillRect( data_ptr->nmcd.hdc, &data_ptr->nmcd.rc, GetStockBrush(BLACK_BRUSH));
                    return CDRF_NEWFONT;
                case CDDS_PREPAINT:
                {
                    return CDRF_NOTIFYITEMDRAW;
                }
            }
        }
} 
```

我只收到 CDDS_PREPAINT。在文档[MSDN 自定义绘图文档中。](http://msdn.microsoft.com/en-us/library/windows/desktop/ff919569%28v=vs.85%29.aspx) 据说返回值 CDRF_NOTIFYITEMDRAW CDDS_ITEMPREPAINT 应该是下一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T13:07:27.993

当使用 TBSTYLE_FLATE 或 TBSTYLE_TRANSPARENT 或 TBSTYLE_TRANSPARENT 样式创建工具栏时，它使用父背景颜色。因此，要为工具栏实现不同的背景颜色，应为父窗口使用 SetClassLongPtr（用于 32x 和 64x 兼容性）。这样问题就解决了。

# c++ - 函数名 __func__ 的预定义宏

> ID：15305310
> 
> 赞同：30
> 
> 时间：2013-03-08T23:50:14.437
> 
> 标签：c++, visual-studio, gcc, c-preprocessor

我正在尝试构建一个调试日志消息函数，该函数记录调用日志消息的文件、行和函数。

```
#define DEBUG_PANIC(p) CLogging::Debuglogf( "Debug marker (%s) - ::%s() in file: %s(%d)", p, __func__ , __FILE__, __LINE__ ); 
```

上面的代码适用于一些编译器，但不是全部。我的代码需要与 GCC 以及 Microsoft Visual Studio 交叉兼容。我添加了以下定义以帮助兼容性。

```
#ifndef __FUNCTION_NAME__
    #if defined __func__ 
        // Undeclared 
        #define __FUNCTION_NAME__   __func__ 
    #elif defined __FUNCTION__ 
        // Undeclared
        #define __FUNCTION_NAME__   __FUNCTION__  
    #elif defined __PRETTY_FUNCTION__
        // Undeclared
        #define __FUNCTION_NAME__   __PRETTY_FUNCTION__
    #else
        // Declared
        #define __FUNCTION_NAME__   "N/A"   
    #endif // __func__ 

#endif // __FUNCTION_NAME__

#define DEBUG_PANIC(p) CLogging::Debuglogf( "Debug marker (%s) - ::%s() in file: %s(%d)", p, __FUNCTION_NAME__, __FILE__, __LINE__ ); 
```

上述代码片段的问题在于 #else 宏在所有编译器上都处于活动状态，而其他宏则没有。换句话说，在*预定义宏*`#if defined __func__`的编译器上是错误`__func__`的。

 *我的问题是

*   如何创建交叉编译器宏来查找函数名称？
*   如何判断 a 是否`__func__`可以使用？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-08T23:55:22.957

你假设`__func__`是一个宏，但它不是。它是有条件支持的预定义标识符，因此您不能使用`#if defined`or对其进行检查`#ifdef`。

如果编译器无法告诉您这是否受支持（他们可以通过 a`_FUNC_SUPPORTED`或其他方式，我并不是说他们实际上正在这样做），您将不得不检查编译器而不是实际标识符。

类似的东西：

```
#ifndef __FUNCTION_NAME__
    #ifdef WIN32   //WINDOWS
        #define __FUNCTION_NAME__   __FUNCTION__  
    #else          //*NIX
        #define __FUNCTION_NAME__   __func__ 
    #endif
#endif 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-06-30T11:22:02.923

[Boost](http://www.boost.org)通常是[`BOOST_CURRENT_FUNCTION`](http://www.boost.org/doc/libs/1_58_0/boost/current_function.hpp)定义在`<boost/current_function.hpp>`.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-01-06T22:47:28.490

我想补充一点，`__FUNCTION__`宏是为 GCC 和 MSVC 定义的。虽然是非标准的，但它在两个编译器上都可用。

[GCC 标准预定义宏](https://gcc.gnu.org/onlinedocs/cpp/Standard-Predefined-Macros.html)引用：

> C99 引入`__func__`，GCC 提供`__FUNCTION__`了很长时间。这两个都是包含当前函数名称的字符串（存在细微的语义差异；请参阅 GCC 手册）。它们都不是宏；预处理器不知道当前函数的名称。不过，它们往往与`__FILE__`and结合使用`__LINE__`。

[MSVC 预定义宏](https://msdn.microsoft.com/en-us/library/b0084kay%28v=vs.140%29.aspx)引用：

> `__FUNCTION__`
> 
> 仅在函数中有效。将封闭函数的未修饰名称定义为字符串文字。
> 
> `__FUNCTION__`如果您使用 /EP 或 /P 编译器选项，则不会展开。
> 
> 参见`__FUNCDNAME__`示例。

所以使用`__FUNCTION__`就可以了，因为两个编译器都实现了它。尽管您可能在两个编译器上得到的结果不同，但在某些情况下这可能是可以接受的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-03-08T23:55:11.490

> 它们既不是预处理器宏`__FILE__ and __LINE__`，也不是变量。

取自以下链接：

[http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Function-Names.html](http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Function-Names.html)

另外，请查看与您的问题类似的其他问题：

[如何检查 __PRETTY_FUNCTION__ 是否可以使用？](https://stackoverflow.com/questions/4164315/how-to-check-if-pretty-function-can-be-used)

例子：

```
#ifdef _MSC_VER // Visual Studio
    #define FUNCTION_NAME __FUNCTION__
#endif 
```*

# ios - 在 iOS 设备锁定时保持应用程序运行？

> ID：15305314
> 
> 赞同：4
> 
> 时间：2013-03-08T23:50:43.687
> 
> 标签：ios

我有一个大量使用视频输出的应用程序。在一个典型的用例中，我将 iPad 连接到外接显示器。我只想打开外接显示器；iPad 显示屏不需要一直亮着。

理想的情况是让某人连接到外接显示器，然后锁定他们的 iPad。但这会暂停我的应用程序。（目前，我正在调用 setIdleTimerDisabled 以防止 iPad 锁定和暂停我的应用程序。）

我想为用户提供锁定 iPad 的选项，但仍让我的应用程序运行并将图像发送到视频。（注意：我不是说在我的应用程序不在前台时保持运行。我只想在前台保持运行，但设备被锁定。）

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T01:14:08.357

I would say no, it is not possible. Here's why:

The [docs](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html) read:

> Pressing the Sleep/Wake button is another type of interruption that causes your app to be deactivated temporarily. When the user presses this button, the system disables touch events, moves the app to the background but sets the value of the app’s applicationState property to `UIApplicationStateInactive` (as opposed to `UIApplicationStateBackground`), and finally locks the screen.

Something interesting to note in the docs above is that a bit further down under "What to do when an interruption occurs" Apple recommends that you stop doing certain tasks.

> In response to this change, your app should do the following in its `applicationWillResignActive:` method:
> 
> *   Stop timers and other periodic tasks.
> *   Stop any running metadata queries.
> *   Do not initiate any new tasks.
> *   Pause movie playback (except when playing back over AirPlay).
> *   Enter into a pause state if your app is a game.
> *   Throttle back OpenGL ES frame rates.
> *   Suspend any dispatch queues or operation queues executing non-critical code. (You can continue processing network requests and other time-sensitive background tasks while inactive.)

This tells me that Apple doesn't want or expect your app to be doing much of anything in this state, other than preparing to be fully backgrounded.

On a related note here's a thread that shows how to determine whether you've hit the Sleep/Wake button or not:

[Is it possible to distinguish between locking the device and sending an app to background?](https://stackoverflow.com/questions/7754317/is-it-possible-to-distinguish-between-locking-the-device-and-sending-an-app-to-b)

# jakarta-ee - 如果应用程序使用 WorkManager API，如何从 Jboss 5.x 迁移到 Jboss 7.x

> ID：15305316
> 
> 赞同：4
> 
> 时间：2013-03-08T23:50:51.703
> 
> 标签：jakarta-ee, jboss, jboss7.x, jca, workmanagers

我们正在努力迁移生产环境中的现有应用程序，在某些情况下使用 WorkManager（作为垂直可扩展性）来并行化工作负载。

该应用程序也使用 JMS，但由于性能问题，某些部分使用**JBossWorkManagerTaskExecutor** [Spring 3.1] 实现，以便为所有正在运行的线程共享相同的 JVM 内存并避免在 Java EE 环境中打开本机线程。

我阅读了很多其他关于这个主题的讨论以及原因，因为 WorkManager API 在 Jboss 7.x 上不可用，例如：

[https://community.jboss.org/thread/169380](https://community.jboss.org/thread/169380)

[https://community.jboss.org/message/718053](https://community.jboss.org/message/718053)

但是我们真的不明白我怎样才能（**以非常快的方式**）将应用程序从 Jboss 5.x 迁移到 Jboss 7.x（Jboss EAP 5 到 Jboss EAP 6）而不影响源代码（或只是很小的影响） .

如果我理解正确，那么只有一种方法可以实现 JCA 资源适配器以使用 workmanager，因为 workmanager 不能通过 JMX 使用。这样对吗？

由于上述原因，我认为没有机会介绍 commonj。

目前我们无法重写源代码，我们希望避免打开本地线程以在非常短的时间内解决这种情况。

有人解决了这个问题吗？有人像以前版本的 Jboss 一样使用 WorkManager 实现 JCA 资源适配器吗？

# php - 如何更改 XML 节点值？

> ID：15305318
> 
> 赞同：2
> 
> 时间：2013-03-08T23:51:34.013
> 
> 标签：php, xml

我已经查看了有关此主题的许多帖子，并尝试对我的代码进行调整，但似乎无法使其正常工作，非常感谢任何帮助。

如何更新 cen_inst_units_z_name 的值？

**XML**

```
<?xml version="1.0" encoding="UTF-8" ?> 
<xfa:data xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/">
    <form1>
          <cen_inst_units_z_name>Department of School</cen_inst_units_z_name>
    </form1>
</xfa:data> 
```

**PHP**

```
<?php 
    $doc = new DOMDocument();
    $doc->load('52500_data.xml');
    $xpath = new DOMXPath($doc);

    $parent = $doc->getElementsByTagName('form1')->item(0);
    $query = $xpath->query('cen_inst_units_z_name',$parent);

    //Checked to make sure I was pulling the correct node
    echo $query->item(0)->textContent;

    $query->item(0)->nodeValue = 'Test123'; 
    $doc->saveXML();
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:56:01.947

我更改了代码以保存新文档并得到了我正在寻找的结果：

```
$doc->save("newdoc.xml"); 
```

# ruby - 使用 Angular JS 路由提供程序进行无限模板加载

> ID：15305324
> 
> 赞同：0
> 
> 时间：2013-03-08T23:52:04.483
> 
> 标签：ruby, angularjs, sinatra, erb, routes

**修复了它**检查 xhr 请求修复了无限循环

```
get '/about' do
    erb :about, layout: !request.xhr?
end 
```

* * *

我正在使用 Angular js 和 sinatra 创建一个页面。Angular 正在处理我的路线并调用模板

```
app.config(['$routeProvider', function ($routeProvider) {
    $routeProvider.
        when('/home', {templateUrl: '/home'}).
        when('/about', {templateUrl: '/about'}).
        when('/work', {templateUrl: '/work'}).
        when('/blog', {templateUrl: '/blog'}).
        when('/contact', {templateUrl: '/contact'}).
        otherwise({redirectTo: '/'});
}]); 
```

当我转到*/#/blog*时，模板加载正常。内容由 sinatra 提供

```
get '/blog' do
    'This is the work page!'
end 
```

但是，在执行 about 页面时，我得到了无限的视图加载。关于页面由提供

```
get '/about' do
    erb :about
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:48:56.327

```
get '/about' do
    erb :about, layout: !request.xhr?
end 
```

前面的代码加载包含 Angular js 代码的布局。js 代码再次调用 /about 并重复。由于来自 Angular js 路由的调用是 xhr，因此检查它可以解决问题。

# php - 如何为个人资料页面制作虚 URL

> ID：15305326
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:52:07.570
> 
> 标签：php, apache, mod-rewrite

例如，我想制作 www.profstream.com/profile-t.php?username=arunsood -> www.profstream.com/arunsood。我的链接都设置在我的网站上以访问原始 URL，但我只是希望它像地址栏中的重写示例一样显示，并在有人键入 www.profstream.com/arunsood 时被调用。

这是向我建议的 mod 重写规则，但它只是说当我尝试它时没有找到：

```
RewriteEngine On
RewriteRule ^([^/]*)$ /profile-t.php?username=$1 [L] 
```

有没有办法让它工作而不改变网站上已有的链接结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:56:23.037

试试这个

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ profile-t.php?username=$1 [L,QSA] 
```

# c# - 将联系人缩略图保存在文件中

> ID：15305328
> 
> 赞同：0
> 
> 时间：2013-03-08T23:52:31.760
> 
> 标签：c#, .net, windows-8

我想将个人资料图片保存在本地存储的文件中。

使用此代码检索 IRandomAccessStreamWithContentType 但我不明白如何将其保存在磁盘上。

```
var contactPicker = new Windows.ApplicationModel.Contacts.ContactPicker();
contactPicker.CommitButtonText = "Select";

var contact = await contactPicker.PickSingleContactAsync();

using (IRandomAccessStreamWithContentType stream = await contact.GetThumbnailAsync())
{
    //Save stream on LocalFolder
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-09T00:48:33.767

假设`IRandomAccessStreamWithContentType`像任何其他流一样工作，这应该可以解决问题：

```
using (IRandomAccessStreamWithContentType stream = await contact.GetThumbnailAsync())
{
     using(FileStream fs = new FileStream("path", FileMode.CreateNew))
     {
          stream.CopyTo(fs);
     }
} 
```

# mysql - 尝试将一张表插入另一张表时出现问题

> ID：15305333
> 
> 赞同：1
> 
> 时间：2013-03-08T23:53:12.950
> 
> 标签：mysql, sql, sql-insert

我在一个临时表中有一个 150 万条记录的 mysql 表，我想通过内部连接将它插入到主表中。

我的代码有效，但它在 103,613 条记录处停止。IT 不会继续前进。为什么会停下来？为什么它没有一路走到最后？

这是我当前的代码

```
INSERT INTO phone_calls(next_attempt, created_on, modified_on, status, call_subject,
account_number, call_code, last_attempt_on, total_attempts, account_id

,team_id
,campaign_id
,call_code_id
,result_code
,result_code_id
,time_zone_id
,trigger_on
,first_attempt_on
,first_attempt_by
,last_attempt_by
,modified_by
,client_id
,last_call_id
,call_notes
,owner_id
,industry_id
)

SELECT 
CASE WHEN next_attempt IS NULL OR next_attempt = '' THEN STR_TO_DATE(replace(t.next_attempt,'/',','),'%m,%d,%Y %T') END as next_attempt,
CASE WHEN t.created_on IS NULL OR t.created_on = '' THEN '0000-00-00 00:00:00' ELSE STR_TO_DATE(replace(t.created_on,'/',','),'%m,%d,%Y %T') END as created_on,
CASE WHEN t.modified_on IS NULL OR t.modified_on = '' THEN '0000-00-00 00:00:00' ELSE STR_TO_DATE(replace(t.modified_on,'/',','),'%m,%d,%Y %T') END AS modified_on,
CONVERT( CASE WHEN t.status IS NULL OR t.status = '' THEN 0 ELSE t.status END,  UNSIGNED INTEGER) AS status,
LEFT(IFNULL(t.call_subject, ''), 100),
t.account_number,
CONVERT( CASE WHEN t.callcode IS NULL OR t.callcode = '' THEN 0 ELSE t.callcode END , UNSIGNED INTEGER) AS callcode, STR_TO_DATE(replace(t.last_attempt_on,'/',','),'%m,%d,%Y %T') as last_attempt_on,
CONVERT( CASE WHEN t.New_Attempts IS NULL OR t.New_Attempts = '' THEN 0 ELSE t.New_Attempts END ,  UNSIGNED INTEGER) AS New_Attempts,
a.account_id
,0
,0
,0
,0
,0
,0
, '0000-00-00 00:00:00'
, '0000-00-00 00:00:00'
,1
,1
,1
,1
,0
,'IMPORTED FROM CRM'
,1
,1
FROM tmp_table_for_rdi_cms AS t
INNER JOIN accounts AS a ON a.account_number = t.account_number LIMIT 9999999999;
these 2 fields are indexed so it runs fast
a.account_number
t.account_number 
```

现在，我知道我没有为某些类型为无符号整数的字段插入任何值，但这没关系，因为我稍后会更新它。

如何在不丢失任何记录的情况下执行此 INSERT INTO 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:02:50.670

“没有默认值”的问题是源表在新表上定义为 S NOT NULL 且未使用默认值定义的列具有空*值*。

你有三个选择来解决这个问题：

1.  将目标列定义为可以为空（省略 NOT NULL）
2.  用默认值定义目标列，即`NOT NULL DEFAULT 'some value'`
3.  如果该列为空，则提供一个值，即`SELECT ifnull(source_column, 'some value)`

*截断不正确*的INTEGER 值 问题，您从 char 值中选择并将其放入 int 列中，但有些 vyes 是空白的，因此您需要处理：

```
select if(source_column = '', 0, source_column) 
```

存在数据被截断的*列*问题，因为源值大于/长于目标列可以容纳的值。要解决此问题，请将目标列定义为更大（bigint 而不是 int）或更长（例如 text 或 varchar(80) 而不是 varchar(20)）

# ruby-on-rails - 配置 Rails 路由

> ID：15305338
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:53:44.523
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, routes

我有一个 Rails 应用程序，它有一个名为“mastertest”的控制器

默认情况下，当我运行应用程序并转到 localhost:3000 时，我想重定向到 localhost:3000/mastertest。

有人可以帮我配置 routes.rb 文件吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:55:18.203

请搜索一下... [http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

```
root :to => 'pages#main' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:55:46.360

1) 删除 public/index.html 文件

2）更新你的路线文件 - 在这里阅读更多：http: [//guides.rubyonrails.org/routing.html#using-root](http://guides.rubyonrails.org/routing.html#using-root)

# c++ - C++ 中的 I/O 运算符重载错误

> ID：15305340
> 
> 赞同：0
> 
> 时间：2013-03-08T23:53:51.727
> 
> 标签：c++

拜托，也许，我太累了，因为我似乎无法弄清楚为什么这个输入流运算符重载函数会抱怨......这是.h声明：

```
friend std::istream& operator>>(std::istream& in,  IntOperatorClass& intoperatorClass) 
```

这是 .cpp 声明：

```
std::istream& operator >>(std::istream& in,  IntOperatorClass& intoperatorClass)
     {
         in>>intoperatorClass.value;
         return in;
     } 
```

该类有一个名为 value 的私有变量..

班上 ：

```
class IntOperatorClass{
     int value; //a value
     int arr[10];//an array value
 public:
     IntOperatorClass();//default constructor
     IntOperatorClass(int);//constructor with parameter
     IntOperatorClass(int arr[], int length);//an array constructor
     IntOperatorClass(const IntOperatorClass& intoperatorClass);//copy constructor
     IntOperatorClass& operator=(const IntOperatorClass& intoperatorClass);//assignment operator
     friend std::ostream& operator <<(std::ostream& out,  const IntOperatorClass& intoperatorClass);//output operator;
     friend std::istream& operator>>(std::istream& in,  IntOperatorClass& intoperatorClass);//input operator
     IntOperatorClass& operator++();//pre increment operator
     IntOperatorClass operator++(int);//post increment operator
     friend IntOperatorClass operator+(const IntOperatorClass intoperatorClassFirst , const IntOperatorClass intoperatorClassSecond);
     int GetValue(){return value;}
 }; 
```

是不是我做错了什么，因为编译器一直抱怨“>>”没有定义..

```
./op.cpp: In function 'std::istream& operator>>(std::istream&, IntOperatorClass&)':
../op.cpp:77: error: no match for 'operator>>' in 'in >> intoperatorClass->IntOperatorClass::value'
../op.cpp:75: note: candidates are: std::istream& operator>>(std::istream&, IntOperatorClass&) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T00:13:05.267

让我们分解错误：

`../op.cpp:77: error: no match for 'operator>>' in
'in >> intoperatorClass->IntOperatorClass::value'`

首先，编译器告诉你错误在`op.cpp`第 77 行

我打赌你就是这条线：

```
 in>>intoperatorClass.value; 
```

错误的下一点是：

```
no match for 'operator>>' in 'in >> intoperatorClass->IntOperatorClass::value' 
```

编译器说在你的内部`operator>>`它不知道如何使用另一个`operator>>`从一个提取`istream`到你的`value`成员中，这是一个`int`

然后它会告诉你它唯一看起来像 an 的候选人`operator>>`是你的候选人，它提取到一个`IntOperatorClass`not an`int`中。

它应该有很多其他候选对象，用于提取整数、双精度数、字符串和其他类型。编译器不知道如何做到这一点的唯一方法是，如果您没有包含定义的标头`istream`及其运算符。

这样做：

```
#include <istream> 
```

在`op.cpp`文件的顶部。

大概你`<iosfwd>`直接或间接地包含了某个地方，它声明`std::istream`为一种类型，但没有包含`<istream>`它完全定义它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T00:11:07.647

不要忘记包含适当的标题：

```
#include <istream> 
```

大概您包含一些标题，该标题`std::istream`以某种方式包含但不包含标题的全部内容`<istream>`。

# java - Android如何在使用webView时保持屏幕开启

> ID：15305348
> 
> 赞同：4
> 
> 时间：2013-03-08T23:54:50.557
> 
> 标签：java, android

首先，我是 Android 和 Java 编程的新手。也就是说，我不确定我想做的事情是否可以完成。我希望能够使用 webView 加载 url 并使用 keep_screen_on 来防止屏幕变暗。

下面是我正在使用的代码。我可以加载网页，但一分钟左右后屏幕变暗。

任何帮助表示赞赏。

这是 Java 页面：

```
package com.mysite;
import com.mysite.R;
import android.app.Activity;
import android.os.Bundle;
import android.view.WindowManager;
import android.webkit.WebView;

public class MainActivity extends Activity {
    public WebView myWebView = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.activity_flag);

        myWebView = new WebView(this);      
        myWebView.loadUrl("http://www.mysite.com");
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    }
} 
```

这是我的清单页面：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.mysite"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.mysite.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T00:34:42.620

# ruby - gem 安装失败并出现 openssl 失败

> ID：15305350
> 
> 赞同：63
> 
> 时间：2013-03-08T23:55:13.943
> 
> 标签：ruby, macos, rubygems, openssl, cocoapods

我试图在我的 OSX Mountain Lion 上安装 cocoapods ( [http://cocoapods.org/ )。](http://cocoapods.org/)

```
 moshe-mbp:~ moshem$ gem install cocoapods
 ERROR:  Could not find a valid gem 'cocoapods' (>= 0), here is why:
      Unable to download data from https://rubygems.org/ - SSL_connect returned=1 errno=0      state=SSLv3 read server key exchange B: bad ecpoint (https://rubygems.org/latest_specs.4.8.gz) 
```

首先我试过

```
 rvm reinstall all --force 
```

然后我尝试了

```
 brew upgrade openssl

    ==> Upgrading openssl
    ==> Downloading http://openssl.org/source/openssl-1.0.1e.tar.gz
    Already downloaded: /Library/Caches/Homebrew/openssl-1.0.1e.tar.gz
    ==> perl ./Configure --prefix=/usr/local/Cellar/openssl/1.0.1e --openssldir=/usr/local/etc/openssl zlib-dynamic shared d
    ==> make
    ==> make test
    ==> make install MANDIR=/usr/local/Cellar/openssl/1.0.1e/share/man MANSUFFIX=ssl
    ==> Caveats
    To install updated CA certs from Mozilla.org:

        brew install curl-ca-bundle

    This formula is keg-only: so it was not symlinked into /usr/local.

    Mac OS X already provides this software and installing another version in
    parallel can cause all kinds of trouble.

    The OpenSSL provided by OS X is too old for some software.

    Generally there are no consequences of this for you. If you build your
    own software and it requires this formula, you'll need to add to your
    build variables:

        LDFLAGS:  -L/usr/local/opt/openssl/lib
        CPPFLAGS: -I/usr/local/opt/openssl/include

    ==> Summary
      /usr/local/Cellar/openssl/1.0.1e: 429 files, 15M, built in 5.1 minutes 
```

然后我尝试了

```
openssl version 
```

仍然（！）获取旧版本

```
moshe-mbp:~ moshem$ openssl version
OpenSSL 0.9.8r 8 Feb 2011
moshe-mbp:~ moshem$ 
```

我究竟做错了什么？如何安装 cocoapods gem？

谢谢

* * *

编辑，尝试@sean 建议：

```
moshe-mbp:~ moshem$ brew update
Updated Homebrew from 672af665 to 10b4d426.
==> Updated Formulae
bash        wireshark
moshe-mbp:~ moshem$ brew install openssl
Error: openssl-1.0.1e already installed
moshe-mbp:~ moshem$ brew link openssl --force
Linking /usr/local/Cellar/openssl/1.0.1e... 1139 symlinks created
moshe-mbp:~ moshem$ brew install curl-ca-bundle
Error: curl-ca-bundle-1.87 already installed
moshe-mbp:~ moshem$ 
moshe-mbp:~ moshem$ openssl version
OpenSSL 0.9.8r 8 Feb 2011
moshe-mbp:~ moshem$ gem install cocoapods
ERROR:  Could not find a valid gem 'cocoapods' (>= 0), here is why:
          Unable to download data from https://rubygems.org/ - SSL_connect returned=1 errno=0 state=SSLv3 read server key exchange B: bad ecpoint (https://rubygems.org/latest_specs.4.8.gz) 
```

* * *

修复 brew doctor 的问题后编辑（2）

```
moshe-mbp:~ moshem$ gem install cocoapods
ERROR:  Could not find a valid gem 'cocoapods' (>= 0), here is why:
          Unable to download data from https://rubygems.org/ - SSL_connect returned=1 errno=0 state=SSLv3 read server key exchange B: bad ecpoint (https://rubygems.org/latest_specs.4.8.gz)
moshe-mbp:~ moshem$ openssl version
OpenSSL 0.9.8r 8 Feb 2011
moshe-mbp:~ moshem$ brew update
Updated Homebrew from 10b4d426 to 6a00bc3c.
==> Updated Formulae
clozure-cl  python  python3
moshe-mbp:~ moshem$ brew install openssl
Error: openssl-1.0.1e already installed
moshe-mbp:~ moshem$ 
moshe-mbp:~ moshem$ echo $PATH
/Users/moshem/.rvm/gems/ruby-2.0.0-p0/bin:/Users/moshem/.rvm/gems/ruby-2.0.0-p0@global/bin:/Users/moshem/.rvm/rubies/ruby-2.0.0-p0/bin:/Users/moshem/.rvm/bin:/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/git/bin:/tools:/platforms:/platform-tools:
moshe-mbp:~ moshem$ 
```

* * *

修改 /etc/paths 后编辑

我将 /etc/path 文件编辑为：

```
/usr/local/bin
/usr/bin
/bin
/usr/sbin
/sbin 
```

完全关闭终端并重新打开它仍然启动旧版本的openssl！

为什么？

```
moshe-mbp:~ moshem$ env $PATH
env: /Users/moshem/.rvm/gems/ruby-2.0.0-p0/bin:/Users/moshem/.rvm/gems/ruby-2.0.0-p0@global/bin:/Users/moshem/.rvm/rubies/ruby-2.0.0-p0/bin:/Users/moshem/.rvm/bin:/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/git/bin:/tools:/platforms:/platform-tools 
```

* * *

编辑，我的 bash_profile

```
source "`brew --prefix grc`/etc/grc.bashrc"

export PATH=${JAVA_HOME}/bin:$PATH
export PATH="$PATH:$ANDROID_SDK/tools:$ANDROID_SDK/platforms:$ANDROID_SDK/platform-tools:$ANDROID_NDK"

[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function* 
```

顺便说一句，我的机器上似乎不存在 /etc/grc.bashrc 。此行和末尾的 rvm 行都是由已安装的脚本添加的

* * *

编辑

```
moshe-mbp:~ moshem$ rvm pkg install openssl 
Fetching openssl-1.0.1c.tar.gz to /Users/moshem/.rvm/archives
Extracting openssl to /Users/moshem/.rvm/src/openssl-1.0.1c
Configuring openssl in /Users/moshem/.rvm/src/openssl-1.0.1c.
Compiling openssl in /Users/moshem/.rvm/src/openssl-1.0.1c.
Installing openssl to /Users/moshem/.rvm/usr

Please note that it's required to reinstall all rubies:

    rvm reinstall all --force

Updating openssl certificates
moshe-mbp:~ moshem$ openssl version
OpenSSL 1.0.1e 11 Feb 2013

moshe-mbp:~ moshem$ gem source -r http://rubygems.org/
http://rubygems.org/ removed from sources
moshe-mbp:~ moshem$ gem source -a https://rubygems.org/
Error fetching https://rubygems.org/:
    SSL_connect returned=1 errno=0 state=SSLv3 read server key exchange B: bad ecpoint (https://rubygems.org/specs.4.8.gz)
moshe-mbp:~ moshem$ gem install cocoapods
ERROR:  Could not find a valid gem 'cocoapods' (>= 0) in any repository 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-10-01T14:23:13.290

这可以通过避免使用 https 并改用不安全的 http 来解决。运行这个对我有用。

```
gem source -a http://rubygems.org/ 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2013-10-05T11:17:40.653

```
rvm osx-ssl-certs update all 
```

对我有用，红宝石2.0.0

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-03-10T17:46:30.093

尝试使用[http://rubygems.org/](http://rubygems.org/)（没有 SSL）作为源——这为我修复了错误。

```
gem source -r https://rubygems.org/
gem source -a http://rubygems.org/
gem install cocoapods 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-08-08T22:07:06.323

当前版本的 rvm 在处理这些事情上做得更好，运行：

```
rvm get head
rvm reload
rvm autolibs enable
rvm reinstall 1.9.3 --disable-binary 
```

确保遵循任何显示的说明 - 一切都可以为您提供帮助。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-09T01:44:15.740

我有同样的错误。要修复，只需运行以下命令（我知道你已经运行了一些但幽默我）：

```
brew update
brew install openssl
brew link openssl --force
brew install curl-ca-bundle 
```

之后，打开一个新的 shell 或获取你的文件，一切都应该很好:)

更新：

要更新您的路径，您需要编辑 /etc/paths 文件，因此请执行以下操作：

```
sudo vim /etc/paths 
```

那里应该看起来像：

```
/usr/bin
/bin
/usr/sbin
/sbin
/usr/local/bin 
```

您要做的是确保它`/usr/local/bin`位于文件的顶部。因此，将其更改为：

```
/usr/local/bin
/usr/bin
/bin
/usr/sbin
/sbin 
```

希望修复它！

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-12-17T20:49:56.840

*更新 2021-05-20：Rubygems 更改了他们使用的证书。我已经更新了证书的链接，但我还没有确认这个解决方案实际上仍然有效。*

这就是为我解决的问题：安装此证书：~~https://raw.githubusercontent.com/rubygems/rubygems/master/lib/rubygems/ssl_certs/AddTrustExternalCARoot-2048.pem~~

[https://raw.githubusercontent.com/rubygems/rubygems/master/lib/rubygems/ssl_certs/rubygems.org/GlobalSignRootCA_R3.pem](https://raw.githubusercontent.com/rubygems/rubygems/master/lib/rubygems/ssl_certs/rubygems.org/GlobalSignRootCA_R3.pem)

在此文件夹中：{rubyfolder}\lib\ruby\xxx\rubygems\ssl_certs

这样您就不必添加不安全的来源。

更多信息在这里：~~https://gist.github.com/luislavena/f064211759ee0f806c88~~ [https://www.develves.net/blogs/asd/2016-04-08-rubygems-and-ssl/](https://www.develves.net/blogs/asd/2016-04-08-rubygems-and-ssl/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-02-09T10:21:12.083

如果您在中国，请尝试使用[http://ruby.taobao.org/](http://ruby.taobao.org/) 作为来源——这为我解决了错误。同时，避免使用https。运行这个对我有用。

```
gem sources --remove https://rubygems.org/
gem sources -a http://ruby.taobao.org/
gem install cocoapods 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-03-11T11:56:42.353

以下让一切都为我工作！

```
rvm get stable

brew update

brew install libyaml
brew install pkg-config 
brew install libxml2 
brew install libxslt

brew install openssl
brew link openssl --force

brew install sqlite

brew install apple-gcc42

rvm install 2.0.0 --with-gcc=gcc-4.2 
```

如果这不起作用，请删除您现有的 ruby​​gems 并按照以下步骤操作：

```
rvm remove 2.0.0
rvm get head --autolibs=3
rvm requirements

#At this point, brew install anything that's missing, like apple-gcc42.

rvm install 2.0.0 --with-gcc=gcc-4.2 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-22T10:17:10.057

正如 Mike Slutsky 所描述的，您可以先安装更新的 openssl。要检查您的 openssl 版本：

```
$ openssl version 
```

在这里获取更新的：[http](http://www.openssl.org/source/) ://www.openssl.org/source/ 然后配置并安装它：

```
$ cd openssl-1.0.1f_src/
$ ./Configure --prefix=/Users/me/bin/openssl-1.0.1f_bin darwin64-x86_64-cc
$ make install 
```

现在用这个 openssl 配置 ruby​​：

```
$ cd ruby-2.1.0_src/
$ ./configure --with-openssl-dir=/Users/me/bin/openssl-1.0.1f_bin --prefix=/Users/me/bin/ruby-2.1.0_bin 
```

注意：新的 openssl 不需要在你的 $PATH 上。这对我来说适用于 ruby​​ 2.0 和 2.1。祝你好运 （-：

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-03-09T14:27:51.080

您可以尝试从源代码更新 OpenSSL：

```
curl -L -O http://www.openssl.org/source/openssl-1.0.1b.tar.gz.asc
curl -L -O http://www.openssl.org/source/openssl-1.0.1b.tar.gz
gpg --verify openssl-1.0.1b.tar.gz.asc
tar xvzf openssl-1.0.1b.tar.gz
cd openssl-1.0.1b
perl ./Configure shared zlib --prefix=/opt/local darwin64-x86_64-cc
make
make test
sudo make install 
```

[来源](http://railsapps.github.com/openssl-certificate-verify-failed.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-04-08T21:11:55.200

我通过仅附加到 ~/.bash_profile 中的 PATH 变量来修复它，在我的情况下，这意味着改变

```
export PATH="/usr/local/mysql/bin:$PATH"
export PATH=$M2:$PATH
export PATH=$JAVA_HOME/bin:$PATH 
```

到

```
export PATH="$PATH:/usr/local/mysql/bin"
export PATH=$PATH:$M2
export PATH=$PATH:$JAVA_HOME/bin 
```

在终端中，键入`nano ~/.bash_profile`以开始编辑。

# series - Maple 无法计算 x=0 处的“x^a*(1+x^b+exp(x))”的级数展开

> ID：15305351
> 
> 赞同：1
> 
> 时间：2013-03-08T23:55:16.233
> 
> 标签：series, maple

假设我们想获得`x^a*(1+x^b+exp(x))`at的级数展开`x=0`。（这只是 Maple 中许多级数展开问题的一个简单示例。）这可以在**Mathematica**中通过

```
Series[x^a (1 + x^b + Exp[x]), {x, 0, 2}] 
```

输出是`x^a (x^b+(2+x+x^2/2+O[x]^3))`。

然而，在**Maple**中，我们会得到一个错误。

```
series(x^a*(1+x^b+exp(x)), x = 0, 1); 
```

如果我们不使用该`MultiSeries`包，则输出为`Error, (in series/exp) unable to compute series`. 如果我们使用这个`MultiSeries`包，输出是`Error, (in MultiSeries:-multiseries) unable to sort exponents, {0, b}`.

有没有办法让 Maple 解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T13:31:29.767

从您显示的错误消息中得到提示，怎么样，

```
MultiSeries:-series(x^a*(1+x^b+exp(x)), x = 0, 3) assuming b>2;

          a    (1 + a)   1  (2 + a)    / (b + a)\
       2 x  + x        + - x        + O\x       /
                         2                       

MultiSeries:-series(x^a*(1+x^b+exp(x)), x = 0, 4) assuming b>3;

      a    (1 + a)   1  (2 + a)   1  (3 + a)    / (b + a)\
   2 x  + x        + - x        + - x        + O\x       /
                     2            6 
```

# ios - 多台电脑上的 Apple Developer 证书，一个单独的开发者帐户

> ID：15305352
> 
> 赞同：5
> 
> 时间：2013-03-08T23:55:18.030
> 
> 标签：ios, provisioning-profile, ios-provisioning

我可以为单个 Apple Dev 帐户提供 2 个单独的配置文件吗？

基本上我需要使用 2 台不同的笔记本电脑进行开发。如果不从我的第一台笔记本电脑+电子邮件中撤销已经存在的证书，我就无法生成新证书。我有办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-19T18:53:20.347

您可以这样做，但您需要两台机器上的私钥和证书。否则它将无法正常工作。将出现“未找到有效身份”错误。

# git-p4 - 如何使用 git-p4 克隆分支？

> ID：15305357
> 
> 赞同：9
> 
> 时间：2013-03-08T23:55:30.107
> 
> 标签：git-p4

我做了：

```
git p4 clone //depot/path/to/project/trunk/@all project 
```

创建 的`master`分支`project`。现在我想克隆`//depot/path/to/project/release`到. 这是怎么做的？`release``project`

更新：使用`--detect-branches`也不起作用。它报告它正在更新两个分支（当实际上有三个分支时）但`git branch`报告只有 master 存在。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T20:00:34.603

这是我使用 git-p4 时的设置说明。这可能会有所帮助：

*   下载[p4 linux 客户端](http://www.perforce.com/perforce/downloads/download/P4linux26x86_64essentials.html)。将文件存储在`~/bin`or`/usr/local/bin`和`chmod +x`

*   将 git-p4 设置为 root

    ```
    chmod 755 /usr/share/doc/git/contrib/fast-import/git-p4
    ln -s /usr/share/doc/git/contrib/fast-import/git-p4 /usr/local/bin 
    ```

*   为 git-p4 定义 Git 全局变量

    ```
    git config --global alias.p4 '!git-p4'
    git config --global git-p4.detectRenames true
    git config --global git-p4.detectCopies true 
    ```

*   设置直接“p4”使用的定义

    ```
    export P4PORT=SERVER_NAME:PORT_NUMBER 
    ```

*   设置登录凭据

    ```
    export P4USER=USER_NAME
    export P4PASSWD=PASSWORD 
    ```

*   使用 P4 'client' 选择 Perforce 分支

    运行“p4 client”命令，只添加您感兴趣的路径/分支。如果您想命名客户端工作空间，您可以在命令末尾添加一个可选的 CLIENT_NAME 参数。这将允许您在同一台机器上使用不同的客户端定义。

    ```
    $ p4 client [CLIENT_NAME]

    View:
    //depot/main... //CLIENT_NAME/main...
    //depot/patch... //CLIENT_NAME/patch...
    //depot/dev... //CLIENT_NAME/dev... 
    ```

*   克隆存储库

    *   简单导入

        ```
        git p4 clone --use-client-spec --detect-branches //depot@all GIT_DIR 
        ```

    *   高级导入

        ```
        git init PROJ; cd PROJ/
        git config git-p4.branchList main:patch
        git config --add git-p4.branchList main:dev
        git p4 clone --use-client-spec //depot@all . 
        ```

*   将更改提交回 Perforce

    为了向 Perforce 提交更改，它需要一个客户端工作区，与 git 工作树分开。建议工作区与 Perforce git 工作目录位于同一文件系统上。

    此外，对工作区路径的引用存储在 Perforce 服务器上，并将在`p4 submit`命令期间使用。

    第一步是创建本地客户端工作区。`CLIENT_NAME`是一个可选参数。如果您不定义它，p4 将使用您的主机名。

    ```
    p4 client [CLIENT_NAME] 
    ```

    在完成 p4 命令之前，您将被移至文件编辑器。这使您可以在将任何客户端设置发送到服务器之前更改它们。您必须将`Root`值更改为 git 树之外的新目录（例如 ../p4-working） 此外，在退出之前验证`Owner`和`Client` 值。这些值取自您的环境，无法在编辑器中更改。

    ```
    p4 clients | grep USERNAME 
    ```

    如果您没有使用默认客户端名称，则必须在本地 git config 中定义它：

    ```
    git config git-p4.client CLIENT_NAME 
    ```

    当您准备好推送代码更改时，请使用以下命令：

    ```
    git p4 rebase
    git p4 submit 
    ```

    您可以在不再使用时从服务器中删除客户端：

    ```
    p4 client -d CLIENT_NAME 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-12T21:25:53.770

在 Git 2.30（2021 年第一季度）中，“ ^（^([man](https://git-scm.com/docs/git-))^） p4”现在支持配置。[`git`](https://github.com/git/git/blob/ca8870d7c198b658a0e3004e27d1c36305702f7f/Documentation/git-.txt)`init.defaultBranch`

这可能是 `detect-branches`or的替代解决方案`--branch`：

请参阅[Johannes Schindelin ( ) 的](https://github.com/dscho)[提交 1b09d19](https://github.com/git/git/commit/1b09d1917f376d52e191102509d08303f8d26388)（2020 年 11 月 8 日[）](https://github.com/dscho)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([ca8870d 提交中](https://github.com/git/git/commit/ca8870d7c198b658a0e3004e27d1c36305702f7f))^(，2020 年 11 月 11 日）)[`dscho`](https://github.com/dscho)
^([`gitster`](https://github.com/gitster))

> ## [`p4`](https://github.com/git/git/commit/1b09d1917f376d52e191102509d08303f8d26388)： 尊重`init.defaultBranch`
> 
> ^(签字人：约翰内斯·辛德林)

> 在`git p4 clone`中，我们对分支名称进行硬编码，`master`而不是查看*实际*的初始分支名称。
> 让我们解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T07:51:39.510

我相信“检测分支”依赖于您拥有与仓库中的分支路径同名的分支映射。如果不是这种情况，您可能需要在运行 git-p4 clone 命令之前使用[建议的方法](https://www.kernel.org/pub/software/scm/git/docs/git-p4.html#_branch_detection)`git-p4.branchList`在空的 git 存储库中定义配置值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-19T22:34:05.487

答案太晚了，但是关于 git-p4 的文档太少了，我希望它仍然有用。

我还努力将分支添加到现有存储库，并且从未获得`detect-branches`使用分支映射的魔力。

我在手动阶段中取得了更多的成功，明确地告诉 git-p4 导入哪个路径并使用该`--branch`选项。我相信`release`在运行之前我还在现有存储库中手动创建了分支。

对于这个问题，那将是`git p4 sync //depot/path/to/project/release --branch=release`

我相信这也可以使用`clone`，因为克隆主要只是在 git-p4 代码中的幕后同步，但是一旦你已经有了一个存储库，我认为`sync`会更安全。

# c++ - 提升交叉口不起作用

> ID：15305360
> 
> 赞同：6
> 
> 时间：2013-03-08T23:55:50.833
> 
> 标签：c++, boost, boost-geometry

我对增强交叉口有一个大问题。我想将一个三角形与一个四边形相交，但我得到了一个剪辑：

![i46.tinypic.com/2nvuo01.png](../Images/ffc44f3ec0c1f73072d0e4259563c77c.png)

有人可以帮助我吗？

我试图改变几何的方向，没有任何反应。交点与其他三角形一起使用，但不适用于此。

```
typedef model::polygon<model::d2::point_xy<double> > polygon
std::deque<polygon> tmp;
bool ok = intersection(quad, triangle, tmp) 
```

三角形：

```
-213.57   -2.13163e-14   0 
-350      37.5           0 
-350      -2.84217e-14   0 
```

盒子：

```
BoundingBox(-300, -165, 2, 170, -0.1, 0.1) 
```

**更新：**

这是我的代码。我在 Ubuntu 12.10 上使用 gcc 4.7.2 和 boost 1.53.0

```
#include <deque>
#include <fstream>

#include <boost/geometry.hpp>
#include <boost/geometry/geometries/polygon.hpp>
#include <boost/geometry/geometries/point_xy.hpp>
#include <boost/geometry/io/wkt/wkt.hpp>
#include <boost/geometry/extensions/io/svg/svg_mapper.hpp>

using namespace boost::geometry;

int main()
{
    typedef model::polygon<model::d2::point_xy<double> > polygon;
    typedef typename model::d2::point_xy<double> point_type;

    polygon quad, triangle;

    read_wkt("POLYGON((-213.57 -2.131 , -350.0 37.5 , -350.0 -2.842 , -213.57 -2.131))", triangle);
    read_wkt("POLYGON((-300.0 2 , -300 170 , -165 170 , -165 2 , -300 2))", quad);

    std::deque<polygon> output;
    intersection(quad, triangle, output);

    std::string filename = "intersectiontest.svg";
    std::ofstream svg(filename.c_str());
    svg_mapper<point_type> mapper(svg, 600, 600);

    mapper.add(output[0]);
    mapper.map(output[0], "fill-opacity:0.5;fill:rgb(153,204,0);stroke:rgb(255,0,0);stroke-width:5");

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T02:18:23.777

我最好的猜测是，这与按逆时针顺序指定点有关，而默认情况下`polygon`希望这些点按顺时针顺序排列。因此，您需要按如下方式进行更改：

```
read_wkt("POLYGON((-213.57 -2.131 , -350.0 -2.842 , -350.0 37.5 , -213.57 -2.131))", triangle); 
```

[您可以在此处](https://stackoverflow.com/questions/8292202/boostgeometry-intersection-not-working-as-expected)阅读有关此问题的更多信息

# python - Python：斐波那契数列

> ID：15305362
> 
> 赞同：9
> 
> 时间：2013-03-08T23:56:12.413
> 
> 标签：python, fibonacci

我只是想通过制作一些基本功能来提高我的编程技能。

我想用斐波那契值填充一个列表，但我认为我的代码给出了所有数字的总和并打印出来。

```
numberlist = []
i = 0
for i in range(20):
    numberlist.append(i)

print numberlist

fibonaccinumbers = []

for n in numberlist:
    def fib(n):
        a, b = 0, 1
        for i in range(n):
            a, b = b, a + b
        return a
    a = fib(n)
    fibonaccinumbers.append(a)

print a 
```

我哪里出错了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-09T00:00:41.653

```
print a 
```

好吧，您打印最终值。

* * *

还有一些关于您的代码的评论：

```
numberlist = []
i = 0
for i in range(20):
    numberlist.append(i) 
```

您不需要在`i`那里初始化，for 循环会为您完成。此外，您可以通过这样做来简化整个块：

```
numberlist = list(range(20)) 
```

鉴于您实际上并不需要将其作为列表，您根本不需要构建它，但您可以`for n in range(20)`稍后运行。

然后你`fib`在循环中一遍又一遍地重新定义你的函数。您应该在它之外定义它并重用它。

此外，当您知道要创建多个斐波那契数字的列表时，只需存储您计算的所有数字都会有所帮助。这样你就不必一遍又一遍地做同样的事情。您还可以使用生成器函数使这一切变得更容易：

```
def fibGenerator():
    a, b = 0, 1
    yield 0
    while True:
        a, b = b, a + b
        yield a

fibonaccinumbers = []
fib = fibGenerator()
for n in range(20):
    fibonaccinumbers.append(next(fib)) 
```

无需遍历范围并`next`手动调用生成器，您还可以使用 itertools 中的[`take`-recipe](http://docs.python.org/3/library/itertools.html#itertools-recipes)来执行此操作，如下所示：

```
fibonaccinumbers = take(20, fibGenerator()) 
```

## 在发电机上

> 但是，仍然不太确定生成器的作用。

生成器是一个 Python 函数，它生成一系列返回值。这些值是延迟生成的，这意味着当您*请求*它时。您只需使用`yield`而不是`return`. A`yield`将“返回”一个值并*暂停*生成器。下次你请求一个值时，生成器将继续它停止的地方。

使用生成器可以创建无限序列。正如你在`fibGenerator`上面的定义中看到的，有一个无限循环，它有一个`yield`内部。当发电机停止时，尽管有这个循环，它也不会挂断。

这是一个不言自明的快速示例：

```
>>> def example():
    print('begin')
    i = 0
    while True:
        print('Calculating next value')
        yield i
        i += 1

>>> g = example()
>>> next(g)
begin
Calculating next value
0
>>> next(g)
Calculating next value
1
>>> next(g)
Calculating next value
2
>>> next(g)
Calculating next value
3
>>> next(g)
Calculating next value
4 
```

该函数是从*iterable*`next`请求下一个值的内置函数。可迭代是您可以迭代的任何东西（例如）；并且任何生成器也是可迭代的。*`for x in iterable: ...`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T00:01:37.390

问题在最后一行。我敢肯定，这是一种干扰：您应该打印列表，而不是`a`.

其他一些提示：

**1：**整个块只是重新创建返回的列表`range`：

```
numberlist = []
i = 0
for i in range(20):
    numberlist.append(i) 
```

分配`i = 0`也没有实际意义。相反，请尝试：

```
numberlist = range(20) 
```

在 python 3 中， call `list(range(20))`，因为`range`不会创建一个完整的列表。

**2：**每次循环都重新定义`fib`函数不会产生问题，但肯定没有必要。将定义移到外面:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-09T00:21:47.133

本着提高编程技能的精神：您可以使用[生成器](https://stackoverflow.com/questions/102535/what-can-you-use-python-generator-functions-for)和[itertools.islice()](http://docs.python.org/2/library/itertools.html#itertools.islice)来获取第一个`n`斐波那契数列：

```
from itertools import islice

def fib(a=0, b=1):
    yield a
    while True:
        yield b
        a, b = b, a + b

fibonacci_numbers = list(islice(fib(), 20))
print(fibonacci_numbers) 
```

### 输出

```
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-08T23:58:06.810

对不起，我是个白痴。我正在打印“a”，这是斐波那契的最后一次迭代计算..

我应该打印我的清单。

该死...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-05T02:14:27.220

以为我会分享一些pyLove：

```
def fib(n, a = 0, b = 1):
    seq = [a,b]
    while len(seq) < n:
        seq += [seq[len(seq)-1] + seq[len(seq)-2]]
    return seq

print(fib(13)) 
```

**输出是：**

```
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144] 
```

**或者：**

```
#or if you want to make up your own
print(fib(13, 1597, 2584)) 
```

**输出是：**

```
[1597, 2584, 4181, 6765, 10946, 17711, 28657, 46368, 75025, 121393, 196418, 317811, 514229] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-09T00:27:57.040

我将其浓缩并接受了“范围”或至少列表（范围（））创建自己的列表的事实：

```
numberlist = list(range(20))

def fib(n):
    a, b = 0, 1
    for i in range(n):
        a, b = b, a + b
    return a

fibonaccinumbers = [fib(n) for n in numberlist]

print fibonaccinumbers 
```

它似乎工作，打印每个斐波那契值直到第 20 次迭代。我怎么可以在 def 之外调用 'fib(n)' 而不会做一些奇怪的事情，例如：

```
a = fib(n) 
```

那是我以前习惯的风格。无论如何，程序现在看起来不错吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-18T19:33:33.073

斐波那契数列的第 n 项是：

![在此处输入图像描述](../Images/2c5849d9c55f8c0b982c0d7ba43e5fa6.png) 在哪里 ![在此处输入图像描述](../Images/39f2ae818383cc222927e06c2ac887fb.png) 和 ![在此处输入图像描述](../Images/69708389924c5113661e35b561fce498.png)

使用上面的身份，可以使用列表推导生成系列：

```
[int(((((1 + math.sqrt(5)) / 2) ** x) - (((1 - math.sqrt(5)) / 2) ** (x))) / math.sqrt(5)) for x in range(n)] //where n is the number of terms in the series 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-28T22:18:11.823

我只是使用公式并插入值：

```
import math 

def Fibs(n):

 for i in range (n):

     Fn=int(((((1+math.sqrt(5))**i) - ((1-math.sqrt(5)) **i))/(2**i) * (math.sqrt(5)))/5)
     print (Fn)

Fibs(int(input()) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-09T00:20:14.667

由于每个斐波那契数都是从所有先前的数中生成的，因此从头开始计算每个数是没有意义的。最好使用您收集斐波那契数的列表来计算每个后续数：

```
def FibList(n):
    rc = []
    for i in xrange(n):
        if i < 2:
            rc.append(1)
        else:
            rc.append(rc[i-2] + rc[i-1])

    return rc

print FibList(20) 
```

如果你真的想变得漂亮，你可以创建一个计算斐波那契值的生成器函数，并使用它来构建你的列表：

```
def Fib(n):
    n1 = 1
    n2 = 1

    for i in xrange(n):
        if i < 2:
            yield 1
        else:
            n3 = n1 + n2
            n1 = n2
            n2 = n3
            yield n3

fiblist = [x for x in Fib(20)]
print fiblist 
```

在生成器函数中，'yield' 关键字返回列表的每个值。使用称为“列表理解”的行`fiblist`使用生成器构建列表。您也可以在 for 循环中使用生成器：

```
for fnum in Fib(20):
    print fnum 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-03T07:57:13.863

```
def fibonacci(number):
        numbers = [0, 1]
        while len(numbers) < number:
            numbers[len(numbers):len(numbers)] = [numbers[len(numbers)-2] + numbers[len(numbers)-1]]
        return numbers 
```

每次循环运行时，列表中的最后两个值都会相加。在迭代到输入长度时，使用每个新的斐波那契值创建列表中的新位置。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-09-24T22:39:50.620

为什么不使用列表推导？这是我解决问题的方法。我将定义一个函数来计算斐波那契数列的第**n项，如下所示。**

```
def fibo(n):
    if n<=2:
        return 1
    else:
        res = fibo(n-1) + fibo(n-2)
    return res 
```

然后我会使用列表理解来获得我想要的序列。

```
fib_sequence = [fibo(i) for i in range(n+1)] 
```*

# capistrano - 是否可以根据服务器设置 Capistrano rvm_type 变量？

> ID：15305366
> 
> 赞同：0
> 
> 时间：2013-03-08T23:56:32.417
> 
> 标签：capistrano, rvm-capistrano

我有两台服务器需要部署到，一台在用户模式下安装了 RVM，另一台在系统模式下安装。我可以为两者编写部署脚本吗？

换句话说，有没有办法将 rvm_type 设置为：一台服务器的用户和另一台服务器的：系统？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:11:56.240

不，目前还没有办法，但您应该[为 rvm-capistrano 开一张票](https://github.com/wayneeseguin/rvm-capistrano/issues)并请求自动检测，我认为它不会很快添加 - 但值得考虑并且可能可以实施。

您可以尝试以下解决方法：

```
set :rvm_path, "$(
  [ -x /usr/local/rvm/bin/rvm ] && echo /usr/local/rvm || 
  [ -x $HOME/.rvm/bin/rvm     ] && echo $HOME/.rvm     || 
  false
)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T19:18:10.803

如果您需要它不同，例如，您的生产服务器与 qa 服务器不同，您可以在 deploy/.rb 文件中定义它，而不是 deploy.rb 文件。我已经使用许多特定于阶段的设置来完成此操作。

# java - 如何编辑 MANIFEST 文件以管理员身份运行 JAR？（视窗）

> ID：15305367
> 
> 赞同：2
> 
> 时间：2013-03-08T23:56:33.167
> 
> 标签：java

我需要在我的 Java 应用程序中进行一项操作，这需要管理员权限（在 Windows 7/8 上）。

从我读过的所有内容来看，只有三个选项：

1）以管理员身份运行 cmd，然后`java -jar myapp.jar`（或制作一个 .bat 文件来做同样的事情）

2) 制作一个启动器 JAR，它将运行我的主 JAR`Elevate.exe`以授予它管理员访问权限。

3) 编辑 MANIFEST.MF 文件以告诉 Windows 我的应用程序需要管理员访问权限。

前两种方法对我来说听起来像是 hack。
我喜欢编辑`MANIFEST.mf`文件的想法，但它看起来只有在我将 JAR 转换为 EXE 时才有效（至少从我发现的内容来看）。

无论如何，我的问题是 - 以管理员权限运行 JAVA GUI 程序的最佳方法是什么？如果您认为最好的方法是编辑 MANIFEST 文件 - 那么如何在 NetBeans 中进行呢？（假设我现在只有一个 NetBeans 程序，并且它是编译的 JAR）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T15:13:00.143

我目前正在使用[launch4j](http://launch4j.sourceforge.net/)将我的 jar 转换为 exe。此工具允许您选择包含清单文件，因此我根据[本文](http://msdn.microsoft.com/en-us/library/bb756929.aspx)创建了一个清单文件。

```
<requestedExecutionLevel
level="asInvoker|highestAvailable|requireAdministrator"
uiAccess="true|false"/> 
```

# android - 徒手绘画不能正常工作？

> ID：15305376
> 
> 赞同：5
> 
> 时间：2013-03-08T23:57:36.323
> 
> 标签：android, android-widget

我使用了一张我们可以从图库中选择的图像，或者使用相机。我正在使用自定义视图进行缩放和自由手绘。我已经使用画布和绘画在图像上进行编辑，但我的问题是，当我们开始在触摸事件上绘画时，它被绘制但 x,y 坐标不同，它显示在触摸点下方很多地方。请帮助我如何改进我的代码以实现我的目标我的代码在这里......

```
public class EditImage extends Activity implements OnTouchListener{ 
TouchImageView edit_img;//custom image view
Bitmap bitmap;    
String imagepath;
Bitmap alteredBitmap,alteredBitmap1;
Canvas canvas;
Paint paint;
Matrix matrix;
float downx = 0;
float downy = 0;
float upx = 0;
float upy = 0;
int count=0;

/** Called when the activity is first created. */   
@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.editscreen2);
    // TODO Auto-generated method stub
    Button back_btn=(Button)findViewById(R.id.back_button);
    back_btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {  
            // TODO Auto-generated method stub
            finish();
        }
    });

    Intent extras=getIntent();      
    Uri imageFileUri = Uri.parse(extras.getStringExtra("imagepath"));
    edit_img=(TouchImageView)findViewById(R.id.editimage);
    Log.i("imagepath2",imageFileUri+"");
    try {
        BitmapFactory.Options bmpFactoryOptions = new BitmapFactory.Options();
        bmpFactoryOptions.inJustDecodeBounds = false;
               bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream
                         (imageFileUri), null, bmpFactoryOptions);

        alteredBitmap = Bitmap.createBitmap(bitmap.getWidth(), bitmap
                .getHeight(), Config.ARGB_8888);

        canvas = new Canvas(alteredBitmap);
        paint = new Paint();  
        paint.setColor(Color.BLACK);
        paint.setAntiAlias(true);
        paint.setDither(true);

        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeJoin(Paint.Join.ROUND);
        paint.setStrokeCap(Paint.Cap.ROUND);

            paint.setStrokeWidth(5);     
        matrix = new Matrix();
        canvas.drawBitmap(bitmap, matrix, paint);
        Drawable drawable = (Drawable)new BitmapDrawable(alteredBitmap);
        edit_img.setBackgroundDrawable(drawable);

    } catch (Exception e) {   
        Log.v("ERROR", e.toString());
    }
    edit_img.setOnTouchListener(this);  
    setfunction();
}
private void setfunction()
{

    Button done_btn=(Button)findViewById(R.id.done);
    done_btn.setVisibility(View.VISIBLE);
    done_btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {       
            // TODO Auto-generated method stub
            String root = Environment.getExternalStorageDirectory().toString();
            //  File myDir = new File(root + "/saved_image);
            String imagename = "Image.png";
            File file = new File (root, imagename);
            if (file.exists ()) file.delete (); 
        try {
            FileOutputStream out = new FileOutputStream(file);
            alteredBitmap.compress(Bitmap.CompressFormat.PNG, 90, out);
                out.flush();    
                out.close();

            } catch (Exception e) {
                e.printStackTrace();
            }

            Intent intent=new Intent(EditImage2.this,SaveImage.class);
            intent.putExtra("imagepath",alteredBitmap);
            startActivity(intent);
        }
    }); 

    Button erase_btn=(Button)findViewById(R.id.erase);
    erase_btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub 
            canvas.drawColor(0, Mode.CLEAR);
            canvas.drawBitmap(bitmap,matrix, paint);
        }
    });
}
public boolean onTouch(View v, MotionEvent event) {
    if(event.getPointerCount()>1)   
    {
        edit_img.setMaxZoom(4f); 
    }
    else
    {
        int action = event.getAction();     
        switch (action) {
        case MotionEvent.ACTION_DOWN:
            downx = event.getX();      
            downy = event.getY();
            Log.i("touch points x,y",downx+"/"+downy);
            break;       
        case MotionEvent.ACTION_MOVE:
            upx = event.getX();
            upy = event.getY(); 
            Log.i("touch points upx,upy",upx+"/"+upy);
            canvas.drawLine(downx, downy, upx, upy, paint);
            downx = upx;
            downy = upy;
            Log.i("touch points x,y",downx+"/"+downy);
            //edit_img.invalidate();
            v.invalidate();
            break;
        case MotionEvent.ACTION_UP:
            upx = event.getX();  
            upy = event.getY();  
            break;
        case MotionEvent.ACTION_CANCEL:          
            break;   
        default:   
            break;
        }
    }
    return true;   
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:18:36.160

您使用的坐标 (from `event.getX/Y()`) 与您认为的点无关。检查文档，和/或放一些`System.out.printlns`来验证这一点。

例如，您可能需要使用手动偏移（由画布绝对位置给出）。

抱歉，我没有更具体：我已经离开 Android 很长时间了。这开始是一个评论，但有点长。

# perl - 如何在不更改 Perl 中的值的情况下将字符串值转换为十六进制？

> ID：15305379
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:58:11.273
> 
> 标签：perl

我有一个具有十六进制字符串值的变量。我希望 Perl 将其读取为十六进制值，以便我可以对其进行一些添加。但我不希望改变价值。

例如：

```
$string = 'AB320000'; 
```

我想，

```
$hex = $string = 'AB320000'; 
```

这样我就可以做到：

```
 $hex + 0x10 + 0x20; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:07:29.963

你不明白数学和计算机是如何工作的。你有十进制、十六进制和二进制——以及其他格式。这些只是符号，表示数字的方式。计算机往往只与他们有基本组件来操作的计算机一起工作。您使用的计算机可能需要二进制文件。所以这就是事情的运作方式。

1.  你要给你的魔法盒一个“字符串”。
2.  你要告诉你的魔法盒这个字符串是十六进制格式的数字。
3.  您的计算机会将该字符串转换为它可以操作的数字实现：例如 int 或 float——但它将以二进制形式存储。
4.  你将指示你的魔法盒做一些事情——比如计算那个 int 或 float 的加法。
5.  您将要求以十六进制格式任意呈现结果数字。

这就是它必须工作的方式。所以问题是，

1.  *如何将十六进制字符串转换为数字（在 Perl 中）？*
    *   如果您在代码中使用文字，则完全按照您在问题中所做的方式`0xFF`等。
2.  *如何在 Perl 中添加整数（或浮点数或其他）？*
    *   提示：它只是`+`您的问题中使用的运算符。
3.  *如何将整数呈现为十六进制字符串（在 Perl 中）？*
    *   暗示：`printf( '%x', 255 )`

而且，所有这些问题可能已经在 SO 上得到了回答。

# asp.net-mvc - 动态生成的剃刀部分

> ID：15305380
> 
> 赞同：2
> 
> 时间：2013-03-08T23:58:18.483
> 
> 标签：asp.net-mvc, asp.net-mvc-4, razor-2

我的 ASP.Net MVC 4 站点中有一个三层布局结构。我的页面引用了一个布局，并且该布局使用了一个超级布局。在我的超级布局中，我有这个代码......

```
@{
    tabCount = 0;
    foreach (string tabName in @ViewBag.LayoutConfiguration.LowerTabbing.Tabs) {
        tabCount++;
        var tabId = string.Format("BodyOfTab{0}", tabCount);
        <div id="@tabId">
            @RenderSection(tabId, false)   
        </div>
    }
} 
```

在我的页面中，我明确定义了许多这样的部分......

```
@section BodyOfTab1{
    <div id="detailBody1" />
}
@section BodyOfTab2{
    <div id="detailBody2" />
}
@section BodyOfTab3{
    <div id="detailBody3" />
} 
```

但是，我的中间布局阻止了所有这些工作，因为我似乎无法从`@ViewBag.LayoutConfiguration.LowerTabbing.Tabs`. 理想情况下，我想在中间布局中自动生成以下内容，但在编译时不知道节的数量......

```
@section BodyOfTab1{
    @RenderSection("BodyOfTab1")
}
@section BodyOfTab2{
    @RenderSection("BodyOfTab2")
}
@section BodyOfTab3{
    @RenderSection("BodyOfTab3")
} 
```

这有可能吗？

**更新：** 我试过这个，但由于某种原因我现在不太明白它不起作用......

```
@{
    DefineSection("BodyOfTab1", () =>
    {
        RenderSection("BodyOfTab1");
    });
    DefineSection("BodyOfTab2", () =>
    {
        RenderSection("BodyOfTab2");
    });
    DefineSection("BodyOfTab3", () =>
    {
        RenderSection("BodyOfTab3");
    });
} 
```

# ios - Objective C 中的 ASC-GZIP 解码

> ID：15305381
> 
> 赞同：0
> 
> 时间：2013-03-08T23:58:18.627
> 
> 标签：ios, xcode, gzip

我一直在互联网上搜索一个库或一段代码，它们将帮助我用这种类型的编码解压缩 XFDL 文件：application/x-xfdl;content-encoding="asc-gzip"。我处理过的所有以前的 XFDL 文件都有这种类型的编码：application/vnd.xfdl;content-encoding="base64-gzip"，而且我使用 Base64 和 GZIP 没有问题（github 上的两个库由尼克洛克伍德撰写）。我在 Python 中找到了可以解压缩这些类型的文件的代码，位于：[http](http://www.ourada.org/blog/archives/375) ://www.ourada.org/blog/archives/375 ，但我不知道如何将这段代码实现为一个Objective-C项目。

任何帮助或向正确方向轻推将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T03:56:39.887

我发现的`asc-gzip`例子实际上是 zlib，然后是 base-64 编码的。它被分成块，每个块前面都是按大端顺序压缩和未压缩的长度，每个块两个字节。

所以要解码：

1.  Base-64 解码整个事情。然后在解码的字节上：
2.  以大端顺序从前两个字节计算下一个压缩长度。称之为*c*。
3.  以大端顺序从接下来的两个字节计算下一个未压缩的长度。叫它*你*。
4.  使用[zlib](http://zlib.net/)解码由下一个*c*字节组成的 zlib 流。验证 zlib 是否准确解码了*c*字节，并且生成的未压缩数据长度正好为*u* 字节。
5.  从第 2 步开始重复，直到数据被消耗完。（它应该全部被完全消耗掉。）

有趣的是，“ `asc`”和“ `gzip`”都是编码名称的误称。 `asc`真正的意思是base 64，`gzip`真正的意思是zlib。去搞清楚。

# c++ - 强制模板类中的特定类型

> ID：15305388
> 
> 赞同：0
> 
> 时间：2013-03-08T23:58:42.580
> 
> 标签：c++

这是我的问题：

我有一个模板化的类

```
Template <class T>
SomeClass
{

    void func1(T* arg1)

    //many methods using T
    void func2(T* arg1);
} 
```

在大多数情况下，相同的类类型 T 被传递给类方法，它们基于 T 工作（因此代码可以是通用的）。对于某些特定情况，我想强制 func2 忽略 T 并使用我想要的，所以我可以这样做：

```
void func1(T* arg1)
{

    T* ptr2;
    int* ptr1;
    if (a specific case)
    {
    SomeClass<int>::func2(ptr1);
    }
    else
    {
    func2(ptr2)//so it will assume ptr2 is of type T*
    }
} 
```

似乎没有立即工作..

最终工作代码（对于其他面临类似问题的人）

```
#include<stdio.h>
template <class T>
class SomeClass
{
public:
    void func1(T arg1);

    template< typename U >
    void func2(U arg1);
};

template< typename T >
void SomeClass<T>::func1(T arg1)
{
    if (1)
    {
        func2<int>(5); // U will deduce to int
    }
}
template<class T> template<class U> void SomeClass<T>::func2(U arg1)
{
 printf("%d",arg1);
}

int main()
{
    SomeClass<float> c;
    c.func1(5.0);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:54:17.120

像这样的东西可能对你有用：

```
template <class T>
class SomeClass
{
    void func1(T* arg1)

    template< typename U >
    void func2(U* arg1);
}; 
```

和

```
template< typename T >
void SomeClass<T>::func1(T* arg1)
{
    T* ptr2;
    int* ptr1;
    if (a specific case)
    {
        func2(ptr1); // U will deduce to int
    }
    else
    {
        func2(ptr2); // U will deduce to T
    }
} 
```

# javascript - 密码输入字段在焦点/类型上从文本更改为密码？

> ID：15305389
> 
> 赞同：3
> 
> 时间：2013-03-08T23:58:51.533
> 
> 标签：javascript, html, css, passwords

我有一个注册表单，其中输入的标题在文本框中，当您单击该框时，文本会消失，但是在密码上，我希望预览文本保持为“密码”而不是“•• ••••••”。但是当用户点击文本框时应该清除文本，并且他们输入的文本应该显示为“•••••••”。

这是按钮的代码：

```
<form method="post" action="register_process.php">
    <input type="text" class="button" value="USERNAME" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'USERNAME') {this.value = '';}" onblur="if (this.value == '') {this.value = 'USERNAME';}" name="username"  />
    <input type="text" class="button" value="EMAIL" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'EMAIL') {this.value = '';}" onblur="if (this.value == '') {this.value = 'EMAIL';}" name="email"  />
    <input type="text" class="button" value="PASSWORD" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'PASSWORD') {this.value = '';}" onblur="if (this.value == '') {this.value = 'PASSWORD';}" name="password"  />
    <input type="text" class="button" value="PASSWORD CONFIRM" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'PASSWORD CONFIRM') {this.value = '';}" onblur="if (this.value == '') {this.value = 'PASSWORD CONFIRM';}" name="password_confirm"  />    <br/>
    <input type="submit" class="button" value="JOIN!" name="join!"  />
</form> 
```

其他一切正常，但我希望用户密码不要出现。同样，现在我已将密码字段保留为文本。

要查看它的操作，请参见此处：http: [//jsfiddle.net/e458S/](http://jsfiddle.net/e458S/)

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-09T00:09:02.330

You can use javascript `setAttribute`

```
<form method="post" action="register_process.php">
   <input type="text" class="button" value="USERNAME" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'USERNAME') {this.value = '';}" onblur="if (this.value == '') {this.value = 'USERNAME';}" name="username"  />
   <input type="text" class="button" value="EMAIL" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'EMAIL') {this.value = '';}" onblur="if (this.value == '') {this.value = 'EMAIL';}" name="email"  />
   <input type="text" class="button" value="PASSWORD" onclick="this.value='';this.onclick='test';this.style.color='#000'; setAttribute('type', 'password');" onfocus="if (this.value == 'PASSWORD') {this.value = ''; setAttribute('type', 'password');}"   onblur="if (this.value == '') {this.value = 'PASSWORD';setAttribute('type', 'text');}" name="password"  />
   <input type="text" class="button" value="PASSWORD CONFIRM" onclick="this.value='';this.onclick='test';this.style.color='#000'; setAttribute('type', 'password');" onfocus="if (this.value == 'PASSWORD CONFIRM') {this.value = ''; setAttribute('type', 'password');}" onblur="if (this.value == '') {this.value = 'PASSWORD CONFIRM'; setAttribute('type', 'text');}" name="password_confirm"  />   <br/>
   <input type="submit" class="button" value="JOIN!" name="join!"  />
</form> 
```

Example [here](http://jsfiddle.net/e458S/2/)

Finally I found one mistake, when password is typed, and before it I change the focus to another field, and returning back to password, the field clears. It's from `onclick="this.value=''";` if You want to handle event onclick just remove `this.value=''` because it works on onfocus, or just add the condition `if(this.value=='password')`, otherwise if use onclick event same as onfocus, better remove the onclick event handler, onfocus is enough.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T00:29:10.153

请记住以下几点：

*   密码字段应该是 of `input type='password'`，这允许浏览器应用不同的安全考虑（例如不允许复制）。此外，出于可用性目的，触摸设备可以选择性地提供显示/隐藏密码。

*   最好，脚本不应该是内联的。相反，更喜欢将自身附加到适当元素的不显眼的 JavaScript。

*   人们使用各种输入机制。

我建议使用带有特征检测的 HTML`placeholder`属性，以允许您在`placeholder`不支持时修改显示。

简单示例：http: [//jsfiddle.net/fbw7j/3/](http://jsfiddle.net/fbw7j/3/)

```
<input type="password" placeholder="enter a password">

// feature detection using the Modernizr library
if(!Modernizr.input.placeholder){
    // alter your markup
    $("input[type=password]").after("<span>Password</span>");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-20T21:59:59.747

看看[http://jsfiddle.net/e458S/39/](http://jsfiddle.net/e458S/39/)

```
<input type="text" class="button" value="PASSWORD-OK" onclick="this.value='';this.onclick='test';this.style.color='#000';" onfocus="if (this.value == 'PASSWORD-OK') {this.value = ''; this.type='password';}" onblur="if (this.value == '') {this.value = 'PASSWORD-OK'; this.type='text';}" name="password"/> 
```

但与占位符一起使用也很好。

```
<input type="password" placeholder="enter a password"> 
```

# c - 线程调度和屈服

> ID：15305392
> 
> 赞同：0
> 
> 时间：2013-03-08T23:59:08.470
> 
> 标签：c, multithreading, parallel-processing, pthreads, scheduling

如果我在四核上运行 4 个工作线程和 1 个 I/O 线程，则其中一个线程将与另一个线程重叠。我如何确保输入线程总是与另一个线程重叠，以便我可以 sched_yield() 将其当前时间片放弃给另一个线程。如果是重叠的两个工作线程，输入线程上的yield不会有任何影响，对吧？sched_yield 会从不同的核心带来另一个线程吗？

```
#include <sched.h>
#include <pthread.h>
void test(void*) {
   while(1) {}
}
int main (void) {
   pthread_t t; 
   for(int i = 0;i < 4;i++)
       pthread_create(&t,0,(void*(*)(void*))test,0); //workers
   while (1) {
       sched_yield(); //input thread
   }
   return 0;
} 
```

**编辑** 输入线程需要轮询传入的消息。我正在使用的库（MPI）不是中断驱动的，在这种情况下条件变量是无用的。我想在输入线程中做的是检查一次条件，然后放弃它的时间片。如果有足够的核心来运行所有线程，则输入线程将在自己的核心上运行。如果不是，它将运行最少数量的检查，即每个时间片一次。我希望我足够清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T08:38:37.243

嗯，MPI_recv 声称是阻塞的，除非你做一些特定的事情来改变它。MPI 的底层通信基础设施很复杂，我不知道“阻塞”是否延伸到通过调用 select() 等待网络套接字。你有点说它没有，考虑到 MPI 的复杂性，我完全可以相信这一点。

**MPI 的内部结构**

因此，如果 MPI_recv 在阻塞模式下不可避免地涉及轮询，则需要弄清楚下面的库正在做什么。希望这是一个明智的民意调查（即涉及调用 nanosleep() 的民意调查）。您可以查看该 (eek) 的 Open MPI 源代码，或者使用[它](http://www.omappedia.com/wiki/Installing_and_Using_Ftrace#Sched_switch_Tracer)和 GTKWave 以一种很好的图形方式查看它的调度行为（我假设您在 Linux 上）。

如果它在轮询循环中休眠，那么 Linux 内核的版本很重要。更现代的内核（可能需要 PREEMPT_RT 补丁集 - 恐怕我不记得了）即使在短时间内也会执行适当的计时器驱动的取消调度睡眠，因此不会占用 CPU 时间。较旧的实现只会进入一个繁忙的循环以进行短暂的睡眠，这对您没有好处。

如果它根本不睡觉，那就更难了。您必须在非阻塞模式下使用 MPI 并自己进行轮询/睡眠。

**线程优先级**

一旦您通过睡眠轮询您的或 MPI 的代码，您就可以依靠使用线程优先级和操作系统调度程序来解决问题。一般来说，将 I/O 线程置于比工作线程*更高*的优先级是一个好主意。它可以防止 I/O 另一端的进程被抢占 I/O 线程的工作线程阻塞。由于这个原因 sched_yield() 不是一个好主意，因为调度程序不会让你的线程进入睡眠状态。

**线程亲和力**

一般来说，我不会为此烦恼，至少现在还不会。你有 5 个线程和 4 个内核；这些线程之一将永远令人失望。如果您让内核尽可能地解决问题，那么只要您控制了轮询（如上所述），您应该没问题。

- 编辑 -

我已经去看看 MPI 和线程，并重新发现了我不喜欢它的原因。MPI 为进程相互通信，每个进程都有一个“等级”。虽然 MPI 是/可以是线程安全的，但线程本身并没有自己的等级。所以 MPI 不能在线程之间进行交互。在当今多核设备的时代，这是 MPI 的一个弱点。

但是，您可以有 4 个单独的*进程*并且没有 I/O 线程。就复制、移动和存储的数据量而言，这可能不是最佳的（它将是网络流量的 4 倍，使用的内存的 4 倍等）。但是，如果您有足够大的计算时间：I/O 时间比率，那么为了简单的源代码，您可能能够忍受这种低效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T03:45:26.180

您正在寻找的 Googleable 短语是“CPU 亲和力”。

参见例如[这个 SO question](https://stackoverflow.com/questions/1407786/how-to-set-cpu-affinity-of-a-particular-pthread)。

确保每个工作线程在不同的核心上运行将实现您的既定目标。

我认为许多评论者对您的应用程序的设计提出了一些合理的担忧，您可能需要考虑扩展这些对话，以确保您脑海中的设计实际上能够有效地实现您想要实现的最终目标。

# c# - 如何获取包含字符串的列表的索引

> ID：15305397
> 
> 赞同：4
> 
> 时间：2013-03-08T23:59:23.037
> 
> 标签：c#, winforms, list

我有一个`List<string>`，我检查它是否包含一个字符串：

```
if(list.Contains(tbItem.Text)) 
```

如果这是真的，我会这样做：

```
int idx = list.IndexOf(tbItem.Text) 
```

但是如果我有例如 2 个相同的字符串呢？我想获取所有具有此字符串的索引，然后使用 foreach 循环遍历它。我怎么能这样做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-09T00:04:51.200

假设*列表*是`List<string>`：

```
IEnumerable<int> allIndices = list.Select((s, i) => new { Str = s, Index = i })
    .Where(x => x.Str == tbItem.Text)
    .Select(x => x.Index);

foreach(int matchingIndex in allIndices)
{
    // ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:03:08.113

这个怎么样：

```
List<int> matchingIndexes = new List<int>();
for(int i=0; i<list.Count; i++)
{
    if (item == tbItem.Text)
        matchingIndexes.Add(i);
}

//Now iterate over the matches
foreach(int index in matchingIndexes)
{
    list[index] = "newString";
} 
```

或使用 linq 获取索引

```
int[] matchingIndexes = (from current in list.Select((value, index) => new { value, index }) where current.value == tbItem.Text select current.index).ToArray(); 
```

# android - Google Play 扩展文件位置

> ID：15305400
> 
> 赞同：5
> 
> 时间：2013-03-08T23:59:34.347
> 
> 标签：android, apk-expansion-files

我们有一个大约 600MB 的大型扩展文件，我们使用 Google Play 扩展 APK 机制获得。我们还必须解压缩此文件以供实际使用。因此，整个应用程序加上数据需要大约 1.4 GB 的存储空间。

据我所知，Google Play 坚持将 .obb 下载到“内部”SD，似乎没有任何方法可以改变这一点。我们有很多用户，他们的“外部”SD 卡上有很多可用空间，但内部 SD 卡上的空间有限。他们在尖叫应用程序占用了这么多空间。对此我们有什么可以做的吗？

我们目前将 .obb 文件扩展为：

getExternalStorageDirectory()/Android/数据

我想我们可以问用户他们想要它在哪里，他们可以选择真正的外部 SD 卡。然而，这仍然会在内部 SD 卡上留下一个（基本上没用的）.obb 文件，Google Play 说我们不能删除它。

有人对如何正确处理这个问题有任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:10:20.743

Per the [Expansion File Storage Location documentation](http://developer.android.com/google/play/expansion-files.html#StorageLocation), expansion files are stored in

```
<shared-storage>/Android/obb/<package-name>/ 
```

where `shared-storage` is what is returned by `getExternalStorageDirectory()`, which should be on the SD card for users that have an SD card.

Unfortunately, as stated on that same page:

> To ensure proper behavior, you must not delete, move, or rename the expansion files.

I would take special attention to this paragraph:

> If you must unpack the contents of your expansion files, **do not** delete the .obb expansion files afterwards and **do not** save the unpacked data in the same directory. You should save your unpacked files in the directory specified by [getExternalFilesDir()](http://developer.android.com/reference/android/content/Context.html#getExternalFilesDir%28java.lang.String%29). However, if possible, it's best if you use an expansion file format that allows you to read directly from the file instead of requiring you to unpack the data. For example, we've provided a library project called the [APK Expansion Zip Library](http://developer.android.com/google/play/expansion-files.html#ZipLib) that reads your data directly from the ZIP file.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T02:43:31.393

将 OBB 文件放在其他任何地方的问题是，当用户卸载您的应用程序时，它们不会被删除，这往往会让他们心情不好，委婉地说。但是，如果您认为收益大于成本，则没有什么技术可以阻止您更改存储位置，因为提供了执行 OBB 文件下载和验证的源代码，您可以修改其行为以满足您的需求。

例如，存储 OBB 文件的路径由以下提供`com.google.android.vending.expansion.downloader.Helpers`：

```
static public String getSaveFilePath(Context c) {
    File root = Environment.getExternalStorageDirectory();
    String path = root.toString() + Constants.EXP_PATH + c.getPackageName();
    return path;
} 
```

（还需要修改`getFilesystemRoot(String path)`& `isFilenameValid(String filename)`）

如果您也在使用 Google 的扩展 zipfile lib，那么您还需要更改`com.android.vending.expansion.zipfile.APKExpansionSupport`指定`Environment.getExternalStorageDirectory()`为根目录的 3 个方法。

这些变化至少应该让你成功一半。

另请注意，外部 SD 卡的问题在于它们的速度差异很大，通常内部 SD 至少会有不错的速度。也许您可以将 OBB 分成 2 个文件（假设您不需要更新文件功能），并将其中一个移动到外部 SD。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-04T07:42:38.897

我有同样的问题，但我找到了解决它的方法。

如果你删除了 OBB，doesFileExist（在 Helpers.java 中）将返回 false。在您的 ExpDownloaderActivity 中，您检查扩展文件已交付，您将使用此信息重新下载 OBB。

我已经更改了 dosFileExist 和 expansionFilesDelivered 以不返回布尔值而是返回具有以下含义的整数：

fileStatus == 0：OBB 丢失（必须下载）

fileStatus == 1：OBB可用，可以解压到其他地方

fileStatus == 2：OBB中的数据已经存储到另一个地方

现在技巧：将数据从 OBB 解压到我最喜欢的位置后，我将原始 OBB 替换为同名的文件，该文件仅包含原始 OBB 的文件大小作为字符串。这释放了 sdcard 上的占用空间。

进一步调用doesFileExist 和expansionFilesDelivered 将返回filestatus = 2，这意味着不需要任何操作。

这是我在 Helpers.java 中的更改：

```
static public int doesFileExist(Context c, String fileName, long fileSize,
        boolean deleteFileOnMismatch) {
    // the file may have been delivered by Market --- let's make sure
    // it's the size we expect

    File fileForNewFile = new File(Helpers.generateSaveFileName(c, fileName));
    if (fileForNewFile.exists()) {
        if (fileForNewFile.length() == fileSize) {
            return 1;
        } else if (fileForNewFile.length() < 100) {
            // Read the file and look for the file size inside
            String content = "";
            long isSize = 0;
            FileInputStream fis = null;
            try {
                fis = new FileInputStream(fileForNewFile);
                char current;
                while (fis.available() > 0) {
                    current = (char) fis.read();
                    content = content + String.valueOf(current);
                }

            } catch (Exception e) {
                Log.d("ReadOBB", e.toString());
            } finally {
                if (fis != null)
                    try {
                        fis.close();
                    } catch (IOException ignored) {
                }
            }
            try {
                isSize = Long.parseLong(content);
            } catch(NumberFormatException nfe) {
                Log.d("ReadOBBtoInt", nfe.toString());
            } 
            if (isSize == fileSize) {
                return 2;
            }
        }
        if (deleteFileOnMismatch) {
            // delete the file --- we won't be able to resume
            // because we cannot confirm the integrity of the file
            fileForNewFile.delete();
        }
    }
    return 0;
} 
```

如果 OBB 的文件大小不匹配，我会读取 OBB 并与存储在其中的文件大小进行比较（这是文件大小不应该的）。如果这给出了匹配，我知道该文件已被处理。

这是我在 ExpDownloaderActivity 中的更改：

```
int expansionFilesDelivered() {
    int fileStatus = 0;

    for (XAPKFile xf : xAPKS) {
        if (xf.mFileSize > 0) {
            String fileName = Helpers.getExpansionAPKFileName(this, xf.mIsMain, xf.mFileVersion);
            fileStatus = Helpers.doesFileExist(this, fileName, xf.mFileSize, false);
            if (fileStatus==0)
                return 0;
        }
    }
    return fileStatus;
} 
```

在 ExpDownloaderActivity 的 onCreate 中：

```
 initializeDownloadUI();

    int fileStatus = expansionFilesDelivered();
    if (fileStatus==0) {        // OBB is missing
            // ... Download the OBB file, same as on Downloader example
    } else if (fileStatus==1) {
        validateXAPKZipFiles(); // and, if OBB has no errors, unpack it to my favorite place
                                // if done, create a new OBB file with the original name
                                // and store a string with the original filesize in it.
    } else {
        finish();               // No action required        } 
```

因此，我可以在任何我想要的地方解压缩数据，并且 - 正如 OP 所提到的 - 不需要 sdcard 上的空间来存储完整的 OBB 和解**压缩**的数据。

# jquery - qtip 在 Internet Explorer 9 中引发错误

> ID：15305403
> 
> 赞同：0
> 
> 时间：2013-03-08T23:59:43.733
> 
> 标签：jquery, internet-explorer-9, iis-7.5, qtip2

我无法让 qTip (qTip2) 在 Internet Explorer 9 中显示到由我的本地 IIS 在 Windows 8 中提供的页面。

我在我的默认 IIS 网站（DefaultAppPool .NET4.0 集成托管管道）中将以下页面保存到 1.htm

```
http://localhost/1.htm 
```

...和一个远程网站 ( [http://imagehost.bigwavesoftware.net/qtip/1.htm](http://imagehost.bigwavesoftware.net/qtip/1.htm) )。

```
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="http://imagehost.bigwavesoftware.net/qtip/jquery.qtip.css">
</head>
<body>
    <div id="tooltip">Here is a tooltip</div>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.min.js"></script>
    <script src="http://imagehost.bigwavesoftware.net/qtip/jquery.qtip.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#tooltip').each(function () {
                $(this).qtip({
                    content: 'tooltip',
                    hide: {
                        fixed: true,
                        delay: 200
                    },
                    position: {
                        my: 'top left',
                        at: 'bottom center',
                        target: $(this)
                    }
                });
            })
        })
    </script>
</body>
</html> 
```

1.  如果我使用**Chrome**（最新）导航到[http://imagehost.bigwavesoftware.net/qtip/1.htm ，则工具提示可以正常工作。](http://imagehost.bigwavesoftware.net/qtip/1.htm)
***   如果我使用**IE9**导航到[http://imagehost.bigwavesoftware.net/qtip/1.htm](http://imagehost.bigwavesoftware.net/qtip/1.htm)，则工具提示可以正常工作。***   如果我使用**IE8**导航到[http://imagehost.bigwavesoftware.net/qtip/1.htm](http://imagehost.bigwavesoftware.net/qtip/1.htm)，则工具提示可以正常工作。***   **如果我在IE9**中直接从磁盘打开 1.htm ，则工具提示可以正常工作。

    *   `http://localhost/1.htm`如果我使用**IE9**导航到，工具提示会在 jQuery 库中引发错误。****** 

 ****在本地 IIS 中提供此页面的某些内容使 IE9 窒息。

关于可能导致这种情况的任何想法？

顺便说一句，以下示例中的 qtip 库托管在我的个人服务器上，并且是最新的 v2.0.1-31- 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:05:15.583

可能是跨域限制 - 在 IIS 下运行时，您要求站点`localhost:yourportnumber`从 获取数据`bigwavesofsoftware.net`，这通常是不允许的。直接加载文件不会触发，因为它不被视为来自另一个域的请求 - 它是来自源文件的直接请求。****

# sitecore - Sitecore - Assert.IsNotNull

> ID：15305407
> 
> 赞同：5
> 
> 时间：2013-03-09T00:00:21.877
> 
> 标签：sitecore, sitecore6

我见过几个在业务逻辑中使用以下代码的示例站点核心应用程序：

```
 Database database = Factory.GetDatabase(itemUri.DatabaseName);
 Assert.IsNotNull(database, itemUri.DatabaseName);
 return database.GetItem(attribute); 
```

有人可以澄清这是否是一个站点核心约定。我只将 Assert 用于单元测试场景，但不在逻辑范围内。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T05:30:55.280

我发现[这篇文章](http://briancaos.wordpress.com/2012/01/20/sitecore-diagnostics-assert-statements/)解决了你的大部分问题。有几点很重要：

*   .NET 断言与 Sitecore 断言不同。至少，Sitecore Assert 更加冗长。
*   在 Sitecore 中，使用断言检查方法输入被认为是最佳实践。（您会在 Sitecore 的代码和[Sitecore](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2013/02/Allow-Users-to-Unlock-Items-Locked-to-Others-in-the-Sitecore-ASPNET-CMS.aspx) [社区](http://www.sitecore.net/Community/Technical-Blogs/Getting-to-Know-Sitecore/Posts/2010/09/Roles-and-Rules-Part-2.aspx)的代码中发现这些断言始终如一（我无法告诉您 Field is null 有多烦人。））

我认为同样重要的是要注意，我似乎在 Sitecore 博客中找到的许多示例都是无论如何都会发生异常的情况。因此，`ArgumentIsNotNull`例如，如果要省略，那将导致 a `NullObjectException`，因此 Assert 实际上会稍微清理一下。在您的情况下，如果数据库不可用，那也会导致问题。Assert 使得错误的原因很清楚。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-19T00:36:33.137

这是一个可以在 sitecore.dll 中大量使用的约定。如果不满足该条件，它用于引发异常。

例如，如果您查看 Assert.IsTrue，如果不满足条件，系统将抛出“InvalidOperationException”

从 Search API 中反编译 a 方法我发现了这个。

```
 Assert.IsTrue(local_0 != null, "SearchConfiguration is missing"); 
```

然后如果我们反编译 IsTrue，它会给我们

```
 [AssertionMethod]
public static void IsTrue([AssertionCondition(AssertionConditionType.IS_TRUE)] bool condition, string message)
{
  if (!condition)
    throw new InvalidOperationException(message);
} 
```

要回答您的其他问题，您可以在应用程序代码中使用它，因为您可以看到它只是在不满足条件时引发异常的另一种方式。

混淆与断言一词的使用有关，正如您所说，这通常出现在传统 c# .NET 解决方案中的单元测试上下文中。只要您知道 Sitecore 断言在幕后所做的事情，是否使用它取决于您。

# jquery - 图片库幻灯片文本 - style="visibility: hidden can't make it work

> ID：15305413
> 
> 赞同：0
> 
> 时间：2013-03-09T00:00:44.923
> 
> 标签：jquery, hidden, slide

我正在做一个图片库，鼠标悬停时，文本会从图片中滑落。我的问题是我的文本 div ( `#portText-`) 有一个`style="visibility: hidden;"`，我不知道如何将它添加到代码中。

这是我的代码：

```
<script>
$(document).on("ready", function ()
{
  $('.moreInfo').hover(    
    function() {
      var myId= "#portText-" + $(this).data('id');
      (myId).slideDown(200).delay(2000);
    },
    function() {
      var myId= "#portText-" + $(this).data('id');
      $(myId).slideUp(2000);
    }
  );
}); 
</script> 
```

我的身体：

```
<div class="unidad">      

  <div class="moreInfo" data-id="1">
    <img src="img/01/rotate.php" height="417" width="550" border="none">
  </div>

  <div class="portText" id="portText-1" style="visibility: hidden;">

    <table class="resumen" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td><strong>Lorem Ipsum</strong> <br>
          Lorem Ipsum text Lorem Ipsum text Lorem Ipsum text Lorem Ipsum text<br>
          <p><a  href="mb01.html" target="_self"><strong>mas info</strong></a></p>
        </td>
      </tr>
    </table>

  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:03:40.483

如果您更改`visibility: hidden`为`display: none`，`.slideDown()`则应正确显示 div。

# javascript - javascript函数中有多个变量？

> ID：15305422
> 
> 赞同：0
> 
> 时间：2013-03-09T00:01:10.160
> 
> 标签：javascript, function, variables, innerhtml

标题可能不正确，我不知道如何聪明地表达这个问题。可能与缺乏智能有关……anyhoo：作为 CMS 的一部分，我有这个 javascript 函数，它可以生成输入到 HTML 表单 textarea 中的数据的预览。现在，表单显然包含更多的部分，而不仅仅是这个文本区域，我想扩展该函数以包括“标题”和“摘要”的变量。不知道javascript，我不知道如何做到这一点。因此，如果有任何善良的灵魂想要教育我（最好是通过视觉示例，而不仅仅是“你必须把东西放在东西里并摆动......”），我将不胜感激。

我的功能是这样的：

```
// generate preview
function updatePreview() {
    if (document.getElementById('txt')) {
    var body = document.getElementById('txt').value;
    document.getElementById('preview').innerHTML = body;
    }
} 
```

标题的表单字段命名为“title”，摘要文本区域命名为“sumtxt”，因此想象的函数类似于：

```
// generate preview
function updatePreview() {
    if (document.getElementById('title')+('txt')+('sumtxt')) {
    var body = document.getElementById('title')+('txt')+('sumtxt').value;
    document.getElementById('preview').innerHTML = body;
    }
} 
```

...但这看起来并不特别正确，即使对我来说也是如此。建议？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:02:51.030

`document.getElementById('txt')`是 DOMNode 或`null`,`document.getElementById('txt').value`是字符串，所以只需：

```
if (document.getElementById('title') !== null && document.getElementById('txt') !== null && document.getElementById('sumtxt') !== null) {
    var body = document.getElementById('title').value + document.getElementById('txt').value + document.getElementById('sumtxt').value;
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T05:08:38.543

你可以一一检查。

```
function updatePreview() {
    var body = "";
    if (document.getElementById('title')) {
        body += document.getElementById('title').value;
    }
    if (document.getElementById('txt')) {
        body += document.getElementById('txt').value;
    }
    if (document.getElementById('sumtxt')) {
        body += document.getElementById('sumtxt').value;
    }
    document.getElementById('preview').innerHTML = body;
} 
```

或者，您可以编写一个支持函数：

```
function getElementValueById(id){
    var node = document.getElementById(id);
    var value = null;
    if (node) {
        value = node.value;
    }
    return value;
} 
```

在 updatePreview() 中：

```
function updatePreview() {
    var title = getElementValueById("title");
    var txt = getElementValueById("txt");
    var sumtxt = getElementValueById("sumtxt");
    if(title && txt && sumtxt){
        document.getElementById('preview').innerHTML = title + txt + sumtxt;
    }
} 
```

希望它有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T05:39:55.267

对 Frits 的回答..

```
 var eleholder = ['title','txt','sumtxt'], body= "";
 for(i=0;i<eleholder.length;i++){
     if(document.getElementById(eleholder[i]) !== null){
         body += document.getElementById(eleholder[i]).value;
     }else{
       body = "";
       break;
     }
  } 
```

# iphone - 修补 AFJSONRequestOperation 以在运行前检查变量？

> ID：15305423
> 
> 赞同：0
> 
> 时间：2013-03-09T00:01:16.600
> 
> 标签：iphone, ios, afnetworking, nsoperation

我有一个 NSOperation，Authenticate，它通过服务器进行身份验证。

我还有另一个操作，AFJSONRequestOperation 类型的 fetchImage，它取决于 Authenticate 是否成功执行。

这是我想要实现的流程：

认证 -> fetchImage

如果身份验证失败，我根本不希望 fetchImage 运行。

不幸的是，AFJSONRequestOperation 没有提供在其请求之前执行操作的 API。它只提供一个 API 来处理请求已经完成的事情。

有没有人对此有很好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:14:27.537

与其更改 fetchImage 操作以使其*之前*发生某些事情，不如考虑让 fetchImage在 auth NSOperation*之后*开始，如下所示...

```
NSOperation *authOperation = ...

[authOperation setCompletionBlock:^{
    // start an AFJSONRequestOperation
}]; 
```

# javascript - Javascript - 将大对象文字转换为另一个对象文字

> ID：15305426
> 
> 赞同：3
> 
> 时间：2013-03-09T00:01:34.760
> 
> 标签：javascript, jquery, json, object, loops

我正在尝试将 Javascript 对象文字转换为另一个。我认为有一些循环是可能的，但我无法完成。目标结构如下所示，“convertedData”。

小提琴可以在这里找到：http: [//jsbin.com/ajemih/9/edit](http://jsbin.com/ajemih/9/edit)

这是 JSON 数据：

```
var data =

{
"29-10-2012": {
    "1a": {
            "allMovement": "1",
            "allLoad": "2",
            "loadMovement": "3"
    },
        "1b": {
            "allMovement": 4,
            "allLoad": 5,
            "loadMovement": 6
    }
},
    "22-02-2013": {
    "1a": {
            "allMovement": "7",
            "allLoad": "8",
            "loadMovement": "9"
    },
        "1b": {
            "allMovement": "10",
            "allLoad": "11",
            "loadMovement": "12"
    }
}
};

for (day in data) {

    for (id in data[day]) {

        document.write(data[day][id].allMovement+"<br>");
        document.write(data[day][id].allLoad+"<br>");
        document.write(data[day][id].loadMovement+"<br>");

    }
}

/*

convertedData = [[1,7],
             [2, 8],
             [3, 9],
             ["4","10"],
             ["5","11"],
             ["6", "12"]];

convertedData = [["1a-allMovement-29-10-2012","1a-allMovement-22-02-2013],
                 ["1a-allLoad-29-10-2012", "1a-allLoad22-02-2013"],
                 ["1a-loadMovement-29-10-2012", "1a-loadMovement-22-02-2013"],
                 ["1b-allMovement-29-10-2012","1a-allMovement-22-02-2013"],
                 ["1b-allLoad-29-10-2012","1b-allLoad22-02-2013"],
                 ["1b-loadMovement-29-10-2012", "1b-loadMovement-22-02-2013"]];

*/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T00:16:56.143

尝试这样的事情，根据需要进行调整：

```
var out = [],
    dateKey, idx, item, itemKey, inner;

for (dateKey in data) {
    if (data.hasOwnProperty(dateKey)) {
        idx = out.length;
        out[idx] = [];
        item = data[dateKey];
        for (itemKey in item) {
            if (item.hasOwnProperty(itemKey)) {
                inner = item[itemKey];
                out[idx].push(itemKey + '-' + inner.allMovement + '-' + inner.allLoad + '-' + inner.loadMovement);
            }
        } 
    }
}
console.log(out); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T12:54:00.933

使用 underscore.js：

```
var memo = {};

_.each(data, function (elem) { 
  _.each(elem, function (elem2, idx) {
    _.each (elem2, function(elem3, idx2) {
      if (typeof memo[idx + idx2] === 'undefined')
          memo[idx + idx2] = [];
      memo[idx + idx2].push(elem3);
    });
  });
});

memo = _.map(memo, function(e) { return e; });

// printing
document.write('[');
_.each(memo, function (e, idx) {
  document.write("[");
  _.each(e, function(ie, iidx) {
    if (typeof ie === 'string')
      document.write('"' + ie + '"');
    else
      document.write(ie);

    if (iidx != e.length - 1)
        document.write(",");
  });
  document.write("]");
  if (idx != memo.length - 1)
    document.write(",");
});
document.write(']'); 
```

输出是

```
[["1","7"],["2","8"],["3","9"],[4,"10"],[5,"11"],[6,"12"]] 
```

jsbin 链接 -> [http://jsbin.com/ajemih/11](http://jsbin.com/ajemih/11)

我认为你得到了混乱的输入数据，因为它不符合类型的输出。除非它也是这个练习的一部分...... :-)

PS。据我了解，您想要文字，这就是为什么有整个 document.write 部分的原因，但如果您不想打印它，您可以跳过它

mz

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T15:29:44.857

**演示：http:** [//jsfiddle.net/XvwkX/1/](http://jsfiddle.net/XvwkX/1/)

我已经完成了 2 遍，第 1 遍是构造一个简单的结果，它解析原始数据对象并创建以数字为键的字符串文字，第二遍是`convertedData`用相应的值更新 var。

```
var easyResult = {};
//first pass
$.each(data, function (d, o1) { //date, object1
    $.each (o1, function (t, o2) { //type, object2
        $.each(o2, function (s, n) { //string, ID
            easyResult[n] = t + '-' + s + '-' + d;
        });
    });
});

for (var i = 0; i < convertedData.length; i++ ) {
    for (var j = 0; j < convertedData[i].length; j++) {
        convertedData[i][j] = easyResult[""+convertedData[i][j]];
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-11T12:19:38.860

这是一个使用 jQuery.each() 函数的解决方案：

```
var convertedObj = {};
$.each(data, function(i0,val0) {
    $.each(val0, function(i1,val1) {
        $.each(val1, function(i2,val2) {
            if (!convertedObj[i1+"-"+i2]) convertedObj[i1+"-"+i2] = [];
            convertedObj[i1+"-"+i2].push(val2);            
        });
    });
});
var convertedData = [];
$.each(convertedObj, function(i,val) {
    convertedData.push(val);
}); 
```

这[**是 jsbin 小提琴的链接**](http://jsbin.com/oxivec/11/edit)

（查看控制台中的结果）

# java - 优化获取下拉列表数据的方式

> ID：15305428
> 
> 赞同：1
> 
> 时间：2013-03-09T00:01:39.767
> 
> 标签：java, drop-down-menu

我有一个部署在 Tomcat Web 服务器上的 Web 应用程序。这个网络应用程序有许多包含下拉列表的表单。我想优化加载这些列表的方式。

例如，我在做什么： - 我有一个带有最终静态 ArrayList 字段的单例类。- 所以，当我第一次调用单例时，它会加载所有列表 - 我用每个列表的 getter 调用这些列表

部署 Web 应用程序时是否可以告诉 Tomcat 加载这些列表？如果它可以做到，我怎样才能访问这些列表？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:31:22.153

在其方法中实现[`ServletContextListener`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContextListener.html)将列表存储在 Application 范围内的a。`contextInitialized`

# java - 在java中将随机数传递给二维数组

> ID：15305429
> 
> 赞同：0
> 
> 时间：2013-03-09T00:01:50.793
> 
> 标签：java, matrix, 2d, sparse-matrix

为什么我的代码中出现错误 - 我创建了两种方法，randomGen 生成随机数，matrixGen 使用随机数创建矩阵。我收到不兼容的类型错误。如果有人可以请指出我可能做错的正确方向..我仍处于学习阶段..这是我的代码：

```
import java.util.Random;

public class sparse{
    static int matrix [][] = new int[6][6];

    public static int randomGen(){
        int rA;
        Random r = new Random();
        rA = r.nextInt(100);
        return rA;
    }

    public static int[][] matrixGen(){
        for(int i=0; matrix[i].length < i; i++){
            for(int j=0; matrix[j].length <j; j++){
                matrix[i] = matrix[i].randomGen();
                matrix[j] = matrix[j].randomGen();
            }
        }
        return matrix[i][j];
    }

    public static void main(String args[]){
        new sparse();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T00:09:24.747

Get rid of randomGen, use this:

```
public static int[][] matrixGen(){
    Random r = new Random( );
    for(int i=0; i < matrix.length; i++){
        for(int j=0; j < matrix[i].length; j++){
            matrix[i][j] = r.nextInt( 100 );
        }
    }
    return matrix;
} 
```

3 (update: 4) things:

1.  you're using `Random` wrong. You should create it once, then get lots of numbers from it.
2.  you're trying to call randomGen on an int, which makes no sense; it's a property of `sparse`, not `int`. You could have done `matrix[i][j] = randomGen()`.
3.  you're doing something very odd indeed to access array elements. Hopefully this code will clear it up for you a bit.
4.  your loops are odd too. I've fixed them in this snippet.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:10:54.960

这个：

```
 matrix[i] = matrix[i].randomGen();
    matrix[j] = matrix[j].randomGen(); 
```

需要是这样的：

```
 matrix[i][j] = randomGen(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:11:10.120

你的`matrixGen`方法很混乱。您的外部`i`for 循环在达到数组长度时需要停止迭代`matrix`，而不是第一个`i`内部数组的长度。同样，您的内部`j`for 循环需要在达到`matrix[i]`数组长度时停止迭代。

如果您想为二维数组中的一个特定位置分配一个值，那么您需要一个分配，而不是两个；在左侧，`=`您需要同时*使用* `i`和`j`。

您不需要在调用之前添加`matrix[i]`or ，因为您在同一个类中定义了它。`matrix[j]``randomGen`

您甚至没有调用该`matrixGen`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T00:14:42.243

首先，在提供的代码中，你`main`什么都不做，因为你创建了一个你不使用的对象。我认为它会在未来继续。

至于您遇到的错误，我还必须做出假设，因为没有提供其他信息。

您遇到的错误可能在您的`matrixGen`方法中，我认为该方法应该填充静态矩阵。它应该是这样的：

```
public static void matrixGen(){
    for(int i=0; i < matrix.length; i++){
        for(int j=0; j < matrix[i].length; j++){
            matrix[i][j] = randomGen();
        }
    }
} 
```

1.  `void`，因为你正在修改你的矩阵，而不是创建一个新的；
2.  您的循环条件错误。索引会递增，直到它们达到各自的长度（`i`对于行和`j`列）；
3.  使用两个索引（行和列）访问矩阵*单元；*
4.  `randomGen`是来自 的方法`class sparse`，而不是来自数组的方法。

**编辑：**正如戴夫所指出的，您不应该`Random`每次都创建一个新实例。将 存储`Random`在一个变量中，就像您对矩阵所做的那样，或者在进入循环之前以相同的方法创建它。

# sql - SQL查询语句以显示具有多个表的相同列类型

> ID：15305430
> 
> 赞同：2
> 
> 时间：2013-03-09T00:01:51.220
> 
> 标签：sql, select, sql-view

我有一个表格视图，它尝试采用两个整数国家代码（起点和目的地）并将这些整数代码替换为实际的两个字母国家代码，同时保持第二个表的映射。

这是两个表的示例

**国家代码：**

```
integerCode twoDigitCode   fullName
     0           US      United States
     1           BE        Belgium
     2           CN         China
     ... 
```

**区域：**

```
origin destination col3 col4
   0        1       x    y
   0        2       z    a
   1        2       u    b
   2        0       x    x
   2        1       i    f
   ... 
```

我想要做的是在视图中得到这样的结果：

```
origin destination col3 col4
  US        BE       x   y
  US        CN       z   a
  ... 
```

我已经尝试了几个不同的 SQL 查询，像这样

```
SELECT twoDigitCode as origin, twoDigitCode as destination
FROM country INNER JOIN Zone ON zone.destination = country.twoDigitCode 
WHERE zone.origin = country.twoDigitCode 
```

但它似乎只是不断重复两次查找的结果。

我的第一个问题是我什至可以用 SQL 查询做我想做的事情吗？第二个是有一个很好的例子或网站可以解释我如何获得这样的结果。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:09:05.207

You simply need two separate JOINs:

```
SELECT c1.twoDigitCode origin, c2.twoDigitCode destination, z.col3, z.col4
FROM Zones z
JOIN Country c1 ON c1.integer.code=z.origin
JOIN Country c2 ON c2.integer.code=z.destination 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:30:20.203

好的，您正在尝试创建一个查询，该查询将通过用相应的两位国家代码替换每个`origin`and组件来“填充” Zones 表中的每条记录。`destination`换句话说，您正在解码源数据和目标数据。您可以在 Zones 表上执行两次 Join：一次填写源，第二次填写目标。

您可以将其分解为两个查询：

1.  通过将 Zones 表与 Country Codes 表连接起来对来源进行解码。例如

    ```
    SELECT *
    FROM Zones, Country Codes
    WHERE origin = integerCode 
    ```

    这将创建一个临时表，其中每行包含以下列：

    （起点、终点、col3、col4、integerCode、twoDigitCode、fullName）

2.  使用相同的过程解码目的地。也就是说，再次将第 1 步创建的表与 Country Codes 表连接起来，但这次 WHERE 子句应将目标与 integerCode 匹配。

免责声明：我是学生，不是专家。我不声称我的解决方案的效率、准确性或正确性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:06:17.347

您需要为 2 个查找列中的每一个加入国家代码表：

```
SELECT co.twoDigitCode as origin, cd.twoDigitCode as destination, z.col3, z.col4
FROM zones z
INNER JOIN country co ON country.integerCode = z.origin
INNER JOIN country cd ON country.integerCode = z.destination 
```

[注意：如果`origin`and`destination`列可以为空，您将使用左连接而不是内连接]

# c# - 如何在现有的 asp.net-mvc 站点上添加新路由而无需大量重写？

> ID：15305439
> 
> 赞同：2
> 
> 时间：2013-03-09T00:02:49.937
> 
> 标签：c#, sql-server, asp.net-mvc, nhibernate, refactoring

我有一个带有 SQL 服务器后端的 asp.net-MVC 网站。有 100 个不同的表，该站点适用于 300 人的组织。

我们现在想将它用于另一个组织，然后是如何扩展站点的技术问题。以下是一些要求：

## 背景：

有许多表可以在两个组织之间完全重用，**但**也有许多表我必须添加过滤器以确保我只获取与该特定组织相关的记录。

鉴于此，我有 像这个问题或[Joel 的播客上所讨论的](https://stackoverflow.fogbugz.com/default.asp?W24218)[那样做出单一或多数据库决定](https://stackoverflow.com/questions/255616/should-i-use-a-single-or-multiple-database-setup-for-a-multi-client-application) （如果可能，我试图将它保存到单一数据库，因为有用户想要查看两个组织）所以我排序[在多租户数据库决策](http://msdn.microsoft.com/en-us/library/aa479086.aspx)中必须使用共享

正如播客中所讨论的，作为示例，有一个**People**表。这很简单，因为如果我只是在查询**people表，它只是在查询中添加一个“** **where Person.Org = “A” 。但它也会影响与****People**表有直接或间接连接的任何查询。所以让我们说我有一个**Car**表，并且有一个**Owner**列（这将是**People**表的外键），如果我有一个 Cars 下拉列表，我首先必须加入**People**，然后添加该过滤器（在它只是**Select *来自汽车**）。我正在使用 nhibernate，但你明白了

 ******## 问题：

我现在的重点是我正在尝试确定如何围绕我的所有 asp.net-mvc 控制器操作进行额外的切换以支持这个新组织。因此，如果我有 40 个控制器并且每个控制器有 10 个操作，我必须更新 400 个操作和每个页面（以及所有视图和 JavaScript 代码以指向某些 URL。我需要首先确定我是哪种“模式”在确定我是否应该查询 org 1 或 org 2

我不想遍历每一个控制器操作并添加一个新参数或“组织名称”或类似的路由，所以我想看看是否有任何想法。即使它运行两个不同的网站，如果我想在单个代码库中运行它，我仍然必须有这个全局开关。

有没有建议可以避免在每个控制器操作上添加额外的参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T03:33:30.953

假设您有一组有限的表（至少，控制器操作的表较少）并且您的 CRUD 操作是集中的，您可以在用户登录时在会话中设置 orgId 并使用该值来过滤所有查询?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:37:03.983

`Customer ID / Name`在路线中添加有帮助吗？我在一个类似的应用程序上工作过，我的路由模式如下所示：

```
{customer}/{controller}/{action}/{id} 
```

因为您已经有一个代码库，您可以将客户添加为可选参数：

```
{controller}/{action}/{id}/{customer}

...
customer = UrlParameter.Optional 
```

无论哪种方式，您都需要在 Url 操作中提供路由值。在我的例子中，所有控制器都继承自一个基本控制器，该控制器通过自定义属性或代码来识别客户、检查安全性、授权等。基本控制器设置一个名为的受保护属性`CurrentCustomer`，其中包含所需的所有信息。它工作得很好，因为客户用户或管理员用户可以访问相同的界面。管理员用户可以访问多个客户的信息，并且该应用程序使用多个数据库（一个数据库可以包含多个客户）。

我认为您最好为每个客户拥有单独的数据库，以避免将客户 ID 传递给 SQL 语句/SP（并进行大量代码更改）。您只需要在运行时根据客户确定要使用哪个数据库。******

# python - 遍历 Python 中的字符串元素列表，并将该迭代器变为 int

> ID：15305442
> 
> 赞同：1
> 
> 时间：2013-03-09T00:02:51.810
> 
> 标签：python, list

我有这段代码，它将一个数字分成 5 个组，将它们放入一个列表中，然后将它们相乘。如果您感到困惑，这是 Project Euler 中的问题 8。它也没有完成，因为我需要找到其他可能的 5 个连续整数。

```
def split_number(number, n):

    line = str(number)

    split = [line[i:i+n] for i in range(0, len(line), n)]

    return split

splitnum = split_number((extremely long number), 5)

for x in enumerate(splitnum[:-1]):
    split5 = split_number(splitnum[x], 1)
    for n in split5:
        splitproduct = reduce(lambda x, y: x*y, splitnum[n])
    if (splitproduct > solution):
        solution = splitproduct

print solution 
```

当我尝试运行它时，我得到了错误

```
TypeError: list indices must be integers, not tuple 
```

我想当我遍历 splitnum 时，x 是一个元组。我需要它是一个整数，这样我才能正确使用 split5() 。

* * *

新代码：

```
def split_number(number, n):

    line = str(number)

    split = [line[i:i+n] for i in range(1, len(line)-n+1, n)]

    return split

number =

while len(split_number(number,1)) is not 0:

    splitnum = split_number((number), 5)

    solution = 0

    for x in splitnum[:-1]:
        split5 = split_number(x, 1)
        for n in split5:
            splitproduct = reduce(lambda x, y: x*y, n)
        if (splitproduct > solution):
            solution = splitproduct

    number = split_number(number, 1)
    del number[0]

print solution 
```

现在我在函数 split_number 的“拆分”行上遇到内存错误。这可能是因为数字非常长。但这不是主题问题，我只是想让你们看看我是如何实现他们的解决方案的（这很有效，因为程序实际运行）。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:08:06.360

[Enumerate](http://docs.python.org/2/library/functions.html#enumerate)返回元组，其中元组的第一个元素是序列的索引。

我认为您只想迭代`splitnum`，而不是使用枚举，因为您没有在任何地方使用索引（`for x in splitnum[:-1]`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T00:13:52.993

您需要做的就是将字符串的所有 5 长子字符串相乘，看看哪个是最大的：

```
import operator

n = map(int, '7316717653133062491922511967442657474235534919493496983520312774506326239578318016984801869478851843858615607891129494954595017379583319528532088055111254069874715852386305071569329096329522744304355766896648950445244523161731856403098711121722383113622298934233803081353362766142828064444866452387493035890729629049156044077239071381051585930796086670172427121883998797908792274921901699720888093776657273330010533678812202354218097512545405947522435258490771167055601360483958644670632441572215539753697817977846174064955149290862569321978468622482839722413756570560574902614079729686524145351004748216637048440319989000889524345065854122758866688116427171479924442928230863465674813919123162824586178664583591245665294765456828489128831426076900422421902267105562632111110937054421750694165896040807198403850962455444362981230987879927244284909188845801561660979191338754992005240636899125607176060588611646710940507754100225698315520005593572972571636269561882670428252483600823257530420752963450')

print max(reduce(operator.mul, n[i:i + 5]) for i in range(len(n) - 5)) 
```

# php - 如何确保函数返回将是字符串的实例？

> ID：15305446
> 
> 赞同：0
> 
> 时间：2013-03-09T00:03:31.833
> 
> 标签：php

我想使用 FILTER_VALIDADE_EMAIL 但它给了我一个警告说它需要一个字符串。我是 php 新手，我在尝试使用 OO 时遇到了麻烦。

```
<?php

Class User {

    private $id;
    private $login_name;
    private $hashed_password;
    private $email;

    public function __construct($login_name, $email){
        $this->login_name = $login_name;
        $this->email = $email;
    }

    public function getLoginName(){
        return $this->login_name;
    }

    public function setLoginName(String $login_name){
        $this->login_name = $login_name;
    }

    public function setEmail(String $email){
        $this->email = $email;
    }

    public function getEmail(String $email){
        return (string) $this->email;
    }
}?>

<?php

include("../lib/php/User.php");

class UserDAO {

    private $user;

    public function __construct(){
    }

    public function getUser(){
        return $this->user;
    }

    public function setUser(User $user){
        $this->user = $user;
    }

    public function insertUser(User $user){
        $email = $user->getEmail();
        $login_name = $user->getLoginName();
        //ver http://www.php.net/manual/en/function.filter-var.php
        if(filter_var($email, FILTER_VALIDATE_EMAIL) && empty($login_name)){
            echo "valid user";
        }
    }
}

$user = new User("user","user@gmail.com");
$userDAO = new UserDAO();
$userDAO->insertUser($user); ?> 
```

返回的错误是

PHP Catchable 致命错误：传递给 User::getEmail() 的参数 1 必须是 String 的实例，没有给出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:09:38.383

PHP has something quite similar to JavaScripts `typeof` function, and it's named `gettype`.

From PHP docs site:

> Returns the type of the PHP variable var. For type checking, use is_* functions.

[Info about this function can be found here.](http://php.net/manual/en/function.gettype.php)

* * *

Using this function you can check against your function, if it returns the type of "string", or any other data type you wish.

Since `(string)` is not an object in PHP, you cannot check if it is an instance of a string, unless you create a custom `String Class/Object` for that purpose, which is quite easy.

* * *

Basic example of `gettype` from PHP docs site:

```
$data = array(1, 1., NULL, new stdClass, 'foo');

foreach ($data as $value) {
    echo gettype($value), "\n";
} 
```

Example output of this example would be:

```
integer
double
NULL
object
string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:08:22.110

Remove your [type hinting](http://php.net/manual/en/language.oop5.typehinting.php) anywhere the type hint is String. String cannot be used in type hinting. Same goes for Int.

# php - 使用 PHP 编辑 Windows 安装程序 (.msi)

> ID：15305448
> 
> 赞同：0
> 
> 时间：2013-03-09T00:03:36.690
> 
> 标签：php, centos, windows-installer

好的，所以我在这一点上完全迷失了，我通常是一个前端开发人员，根据需要了解一点 php。不过，我有一个客户端，它需要一个下载门户，用户输入他们的电子邮件地址进行下载。这很容易，除了一次捕获。应用程序需要将该电子邮件存储在 xml 文件中。

我整天都在谷歌上搜索试图解决这个问题，可能只是我不知道要搜索什么，因为我是在 mac 上工作的前端 Web 开发人员。PHP 安装在 CENT OS 网络服务器上，该服务器需要能够提取 msi、插入 xml 文件，然后重新编译以提供给用户。

任何帮助或指导都会非常有帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T13:05:36.483

Windows 安装程序包 (.MSI) 是 OLE/COM 结构化存储。Microsoft 提供了一个 Win32 API (MSI.dll) 和一个 COM 自动化接口 ("WindowsInstaller.Installer")。

在 Unix 上，大部分 Win32 API 已被移植到 Wine。

现在我从来没有这样做过，但我看到了一些很有希望的东西。[有一个名为OpenMCDF](http://sourceforge.net/projects/openmcdf/)的开源项目。它是用 Visual Studio / .NET 编写的，但声称它支持 Mono。其中有一个测试应用程序（文档资源管理器），当你说 File | 打开它显示 .MSI 作为下拉选项，所以他们至少在考虑它。

无论如何，在源代码中，我看到了流和存储的类。准备好 MSI，您会发现文件被压缩到（Microsoft）CAB 档案中，并通过将其插入流中嵌入到 MSI 中。

在这种情况下，我可能会使用更新的 XML 文件创建一个新的文件柜，将其记录在媒体表中并更新文件表以反映新的序列号、文件大小和媒体 ID。

对于 MSI 专家来说，这在 C# 中是微不足道的。对于 .NET 专家来说，这真的很难。对于那些既不想在 CentOS 上用 PHP 做这件事的人……祝你好运。

另一种方法是使用未压缩的文件构建 MSI，然后将其用作模板来覆盖文件并构建自解压 EXE。这对你来说可能会容易得多。只需确保 MSI 和 XML 被缓存以进行修复事务。

或者只是设置一个 Windows 服务器并将构建传递给它并在完成后将其取回。

# css - -webkit-filter: grayscale() 导致我在悬停 css 上出现问题

> ID：15305454
> 
> 赞同：1
> 
> 时间：2013-03-09T00:03:53.400
> 
> 标签：css, webkit, hover

嘿，所以我正在制作 tumblr 主题，出于某种奇怪的原因，灰度效果有时只是在博客上的一些随机元素（包括图像）上添加填充。这是因为过滤器没有意义，但是当我关闭过滤器时，不会发生这种情况。我尝试了许多不同的方法，我将在下面列出一些：

```
.gray {

 -webkit-filter: grayscale(.7);
-webkit-transition: all 1s ease-in-out;
-webkit-transition: all 1s ease-in-out;
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;}
.gray:hover{

-webkit-filter: grayscale(0);
-webkit-transition: all 1s ease-in-out;
-webkit-transition: all 1s ease-in-out;
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;
}

----------------------------------------

    #content img {
 -webkit-filter: grayscale(.7);
-webkit-transition: all 1s ease-in-out;
-webkit-transition: all 1s ease-in-out;
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;}

#content:hover img{
-webkit-filter: grayscale(0);
-webkit-transition: all 1s ease-in-out;
-webkit-transition: all 1s ease-in-out;
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;
}

----------------------------------------

#content:hover img{
-webkit-filter: none;
-webkit-transition: all 1s ease-in-out;
-webkit-transition: all 1s ease-in-out;
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;
}
.gray {

 -webkit-filter: grayscale(.7);
-webkit-transition: all 1s ease-in-out;
-webkit-transition: all 1s ease-in-out;
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;} 
```

由于冗余，我不会继续前进，但你明白了！所以我在内容 ID 中有图像，我试图让它们变成黑白的，并且在悬停时变为正常，我这样做了，但由于某种原因，它有时会在悬停时添加填充。关于为什么会发生这种情况的任何线索，或者我做灰度的方式有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:42:49.217

> 我用我使用的代码做了一个小提琴，它没有问题

似乎有些风格是压倒一切的`:hover`。尝试添加`padding:0`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T07:18:09.100

在 IE 的 css 代码中添加以下内容

```
.fmcircle_in span {filter: alpha(opacity=0);}

.fmcircle_out:hover .fmcircle_in span{filter: alpha(opacity=100);} 
```

# java - 在 Java 中使用 COLT 求解线性系统

> ID：15305455
> 
> 赞同：0
> 
> 时间：2013-03-09T00:04:02.853
> 
> 标签：java, performance, linear-algebra, sparse-matrix, colt

我想解决一个线性系统。我的矩阵 A 的尺寸为 1200x1200，矩阵 b 的尺寸为 1200x1。所以通过公式 Ax = b，我想找到 x 为 1200x1。现在我主要关心的是我的矩阵 A 有很少的非零值，比如每行最多有 5 个非零值。所以你有什么建议？LU分解会对我有更多帮助吗？或任何其他分解，如稀疏分解。我使用java，因为线性系统是整个算法的一部分，我不想改变编程语言。我开始知道 COLT 有更好的解决方案。任何人都可以向我推荐一些使用 COLT 解决线性系统的示例代码吗？我正在实施的是一个策略迭代问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-21T13:52:21.287

您可以使用[Linear Algebra 4 Java](http://la4j.org/)，它是开源的并且支持稀疏矩阵。您也可以选择矩阵求解器（Gaussian、Jacobi、Seidel）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T22:11:40.657

有一个开源 java 库支持执行应用于矩阵和向量的最常见操作。它还具有求解 nxn 线性系统和进行 LU 分解的功能。您可以从以下网址下载所有的源代码和api文档：http: [//imr-lib.blogspot.com](http://imr-lib.blogspot.com) 这是一个非常易于使用的库，您可以在代码中查看实现；它使用数值分析技能来执行 LU 分解和求解 nxn 线性系统。

# c - 在 iMac 上做 C 教程，遇到挑战

> ID：15305456
> 
> 赞同：-8
> 
> 时间：2013-03-09T00:04:06.723
> 
> 标签：c, terminal, math.h

我正在 Xcode（Apple 的 Mac IDE）上进行 C 编程，并遵循 Big Nerd Ranch 的 Objective C 编程指南指南。挑战问题之一是使用 C 中的库来显示 1 弧度的正弦。我导入了 math.h 并做了

双罪=罪（3.14）；

但它给了我一个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:05:47.997

1 弧度不是 pi，它是 1。

您不能使用作为函数名称的变量名称。

你要

```
double myValue = sin(1.0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T00:05:41.113

不要将变量命名为与函数相同的名称。

尝试

```
double s = sin(3.14); 
```

# java - Java Applet 在文件宿主下运行

> ID：15305459
> 
> 赞同：2
> 
> 时间：2013-03-09T00:04:27.737
> 
> 标签：java, javascript, applet, embed

我是新来的，所以如果我做错了什么，请放过我。

我在我的网站后台运行一个 Java Applet 作为隐藏的“JavaScript iFrame”。它在我网站的每个页面上运行。每次我转到不同的页面时，它都会要求我运行它，只是在不同的 url 下。例子：

![在此处输入图像描述](../Images/18713e03ae1c2dce6603b02c89b2b3c6.png)

![在此处输入图像描述](../Images/4508103b8e3d1cb513c316d59d90843e.png)

我想让它只在一个链接下运行，例如： 位置：example.com/data/btc+.js 或类似的东西。

我知道我可以单击不再显示以自动运行它，但是您需要在每个页面上都这样做，这对我的用户来说会很烦人。

如果您需要更多信息，请告诉我！

TIA

# c# - 尝试从流中播放声音；文件以 .mp3 开头，然后是 byte[] 数组，然后是流。为什么它不起作用？

> ID：15305464
> 
> 赞同：0
> 
> 时间：2013-03-09T00:04:33.803
> 
> 标签：c#, audio

所以我有一个字节流：我可以保存带有 .mp3 扩展名的文件，它可以正常播放，但你会怎么做才能进行实时播放？它实际上是一个 mp3，但它是流式传输的，因此它位于一个字节数组中。您可以使用 .mp3 扩展名保存它，它会很好地播放，如果它是一个 mp3 文件，为什么不能从流中播放？我如何从流中播放它。

```
 byte[] d1 = mywave
            //System.IO.File.WriteAllBytes(@"C:\" + t.ToString() + ".mp3", d1);
            MemoryStream buff = new MemoryStream(d1);
            SoundPlayer sp = new SoundPlayer(buff);
            sp.Play(); 
```

抛出波头已损坏。/ 无效操作异常

那么我将如何在流上创建音频标头？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:39:42.890

我没有“玩过”它，但可能是因为它是 mp3 ......

```
The SoundPlayer class cannot play other file types, such as .wma or .mp3\.    
If you want to play other file types, you can use the Windows Media Player control 
```

[http://msdn.microsoft.com/en-us/library/system.media.soundplayer(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.media.soundplayer(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:39:53.280

SoundPlayer 类播放 WAV 文件，而不是 MP3。有几个库可以播放 MP3，请参阅[此](http://social.msdn.microsoft.com/Forums/en-SG/csharpgeneral/thread/2a797b38-e22c-457f-be0f-27a9d54a3e2c)MSDN 论坛帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:17:48.403

您可以通过文件开头的音频文件代码更改前 4 个字节！

..如果那是你需要的..祝你好运

# javascript - Javascript ajax 仅在添加虚拟行时唤醒

> ID：15305468
> 
> 赞同：0
> 
> 时间：2013-03-09T00:04:50.763
> 
> 标签：javascript, ajax, javascript-events

尽管我喜欢凌晨 2 点的谜团，但我认为最好问一下。

我正在使用 onblur 事件来传递“this”（例如 this = input.password）。出于某种原因，除非我在其中添加一行，否则 handleServerResponse 什么都不做，请看一下：

普通的ajax函数：

```
function ajaxFunction(obj) 
{
    var button = document.getElementById("submit");
    button.disabled = true;
    button.setAttribute("class", "test");
    var getdate = new Date();  //Used to prevent caching during ajax call
    xmlhttp.onreadystatechange  = handleServerResponse(obj);

    if(xmlhttp) 
    {
    //var input = document.forms["signup_form"].getElementsByTagName("input");
    xmlhttp.open("POST","register_ajax.php",true);

    xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

    xmlhttp.send(obj.name +"="+ obj.value);
    };
} 
```

处理服务器响应 - 不起作用

```
function handleServerResponse(obj) 
{
    if (xmlhttp.readyState == 4)
    {
        if(xmlhttp.status == 200) 
    {
            obj.value=xmlhttp.responseText; //Update the HTML Form element 
    }
    else 
    {
        alert("Error during AJAX call. Please try again");
    }
    }
} 
```

handleServerResponse - 工作的

```
function handleServerResponse(obj) 
{
    alert(xmlhttp.responseText);
    if (xmlhttp.readyState == 4)
    {
        if(xmlhttp.status == 200) 
    {
            obj.value=xmlhttp.responseText; //Update the HTML Form element 
    }
    else 
    {
        alert("Error during AJAX call. Please try again");
    }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:10:32.870

你的*“作品”*意外地起作用，它实际上不起作用。

会发生什么：

1.  发送 xmlhttp 请求（稍后会回复）。
2.  您立即尝试检查`readyState`，这还没有`4`，因为还没有准备好！

在另一种情况下，会发生这种情况：

1.  发送 xmlhttp 请求（稍后会回复）。
2.  您通过使用阻止浏览器`alert`。当警报打开时，AJAX 请求会返回。
3.  您立即检查`readyState`，现在它*是* `4`。

如果你关闭`alert` *得足够快，*它会再次破裂。

处理 AJAX（以及一般的异步）的正确方法是使用事件侦听器。

```
xmlhttprequest.addEventListener("onreadystatechange", function (event) {
    if (xmlhttprequest.readyState === 4) {
        // handle reply
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:11:20.073

在这条线上

```
xmlhttp.onreadystatechange  = handleServerResponse(obj); 
```

您正在调用`handleServerResponse`而不是设置 on readystate 更改处理程序。您必须为`xmlhttp.onreadystatechange`您正在做的事情分配一个功能，即分配`handleServerResponse(obj)`. 尝试

```
xmlhttp.onreadystatechange  = function(){
                                  handleServerResponse(obj);
                              }; 
```

第二个成功的原因也是因为警报阻止执行，并且在进行检查之前完成了 ajax 调用。

# android - 如何将compaign参数添加到flurry的横幅

> ID：15305470
> 
> 赞同：0
> 
> 时间：2013-03-09T00:04:51.837
> 
> 标签：android, flurry

我正在考虑使用flurry来推广我的android应用程序。似乎flurry可以将我的应用程序的广告作为横幅放在其他应用程序上。我的问题是如何在横幅上的 url 上附加活动参数，以便我可以了解有关来源的信息。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T09:37:40.890

在 Flurry 上，您可以为每次点击费用 (CPC) 和每次完成观看费用 (CPCV) 促销活动设置重定向 URL。但是，如果您正在运行每次安装费用 (CPI) 活动，则需要提供直接的 AppStore 链接。如果您希望监控各种获取渠道的性能，可以参考Flurry 提供的新[用户获取分析功能。](http://www.flurry.com/flurry-user-acquisition-analytics.html)

（全面披露：我在 Flurry 的支持团队工作）

# android - Android Socket 创建失败

> ID：15305474
> 
> 赞同：-1
> 
> 时间：2013-03-09T00:05:08.640
> 
> 标签：android, sockets

我有这种方法来启动套接字连接，以便我可以在我的 PC 和电话之间聊天。我的 PC 上已经有一台服务器正在等待来自 Android 的连接。

```
private void connectToServer() throws IOException
    {
        showMessage("Starting Connection...");
        connection = new Socket(InetAddress.getByName(serverIP), 0511);
        showMessage("\n Connection Established: "+connection.getInetAddress().getHostName());
    } 
```

这是我运行它时遇到的错误：

```
03-08 19:02:36.847: E/AndroidRuntime(2524): FATAL EXCEPTION: main
03-08 19:02:36.847: E/AndroidRuntime(2524): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.jister13.chattest/com.jister13.chattest.ChatRoom}: android.os.NetworkOnMainThreadException
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2088)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2113)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.ActivityThread.access$700(ActivityThread.java:139)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1224)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.os.Looper.loop(Looper.java:137)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.ActivityThread.main(ActivityThread.java:4918)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at java.lang.reflect.Method.invokeNative(Native Method)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at java.lang.reflect.Method.invoke(Method.java:511)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at dalvik.system.NativeStart.main(Native Method)
03-08 19:02:36.847: E/AndroidRuntime(2524): Caused by: android.os.NetworkOnMainThreadException
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1118)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at libcore.io.IoBridge.connect(IoBridge.java:112)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at java.net.Socket.startupSocket(Socket.java:565)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at java.net.Socket.<init>(Socket.java:225)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at com.jister13.chattest.ChatRoom.connectToServer(ChatRoom.java:88)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at com.jister13.chattest.ChatRoom.startRunning(ChatRoom.java:74)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at com.jister13.chattest.ChatRoom.onCreate(ChatRoom.java:69)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.Activity.performCreate(Activity.java:5048)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
03-08 19:02:36.847: E/AndroidRuntime(2524):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2052)
03-08 19:02:36.847: E/AndroidRuntime(2524):     ... 11 more 
```

有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:08:36.027

Read the error that's contained in the exception being thrown!

`Caused by: android.os.NetworkOnMainThreadException`

It has thrown an exception because you've attempted to do a networking operation on the main UI thread. In Android, you must do any time-consuming tasks (networking, database access, lengthy number crunching, and so on) off the UI thread.

You need to perform this on a separate, non-UI thread.

# jquery - nvd3.js 不会从 jquery 获取数据

> ID：15305479
> 
> 赞同：2
> 
> 时间：2013-03-09T00:05:31.810
> 
> 标签：jquery, d3.js, nvd3.js

我在使用 nvd3.js 库`stackedAreaChart`使用 jQuerys`$.getJSON`函数或该`d3.json`函数从 Web 服务获取数据时确实遇到了一些问题。我正在从 web 服务获取数据，但无法将数据放入图表中。我尝试过使用静态数据，这很有效，但是使用`$.getJSON`or时会出现问题`d3.json`。

我究竟做错了什么？你有没有更好的方法来做到这一点？有没有更好的图形制作框架（显示数据趋势）？在这方面找不到任何好的资源，所以感谢您的帮助！:)

```
<script>
var chart;
var data = [{
    "key": "HTTP 200",
    "values": getData()
}];
setupGraph();

    function setupGraph() {

        nv.addGraph(function() {

            chart = nv.models.stackedAreaChart()
                    .x(function(d) { return d[0] })
                    .y(function(d) { return d[1]/100 })
                    .color(d3.scale.category10().range())
                    .clipEdge(false);

            chart.xAxis
                .tickFormat(function(d) {
                    return d3.time.format('%H:%M')(new Date(d))
                });

            chart.yAxis
                .tickFormat(d3.format(',1f'));

            d3.select('#chart1 svg')
                .datum(data)
                .transition().duration(500)
                .call(chart);

            nv.utils.windowResize(chart.update);
            return chart;
        });
    }
function getData(){
    var arr = [];
    d3.json('http://localhost:8080/api', function(inndata){
        for(var i in inndata){
            var dataarr = new Array();
            dataarr[0] = new Date(inndata[i].date);
            dataarr[1] = inndata[i].count;
            arr.push(dataarr);
            //arr.push({x: new Date(inndata[i].date), y: inndata[i].count});
        }

    return arr;
}
</script>

The json string lookis like this:
[{"date": "2013-01-07 09:01", "count": 2}, {"date": "2013-01-07 05:02", "count": 2}, }] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T19:37:22.073

Javascript 是异步的 - 所以你必须在回调中提供 setupGraph() 到 d3.json 方法。所以做这样的事情：

```
var arr = [];
d3.json('http://localhost:8080/api', function(inndata){
    for(var i in inndata){
        var dataarr = new Array();
        dataarr[0] = new Date(inndata[i].date);
        dataarr[1] = inndata[i].count;
        arr.push(dataarr);
        //arr.push({x: new Date(inndata[i].date), y: inndata[i].count});
    }
    var data = [{
       "key": "HTTP 200",
       "values": arr
    }];
    setupGraph(data) // Pass through data to setupGraph
} 
```

# android - 如何在 Android 项目中使用 PowerMock？

> ID：15305490
> 
> 赞同：15
> 
> 时间：2013-03-09T00:06:15.330
> 
> 标签：android, mocking, mockito, powermock

我创建了一个新的 Android 测试项目。[我从https://code.google.com/p/powermock/downloads/list](https://code.google.com/p/powermock/downloads/list)下载了 powermock-mockito-junit-1-1.5.zip 。我将所有库添加到测试项目的`libs`文件夹中。测试类是一个非常简单的对象：

```
package com.test.test;

import org.junit.runner.RunWith;
import org.powermock.modules.junit4.PowerMockRunner;

import android.util.Log;

@RunWith(PowerMockRunner.class)
public class TestTestAndroid {

    public void testRuns() {
        Log.e("test", "Test case is called");
    }
} 
```

然后，我尝试从 Eclipse 运行项目，或者从命令行创建项目。我犯了同样的错误：

`Conversion to Dalvik format failed: Unable to execute dex: Multiple dex files define Lorg/hamcrest/Description;`

事实证明，两者`junit-4.8.2.jar`和`mockito-all-1.9.5.jar`定义`org.hamcrest.Description`. 出于显而易见的原因，我必须包含 Mockito jar - 我需要 Mockito。Android 提供了不同版本的 JUnit，但它是不包含`@RunWith`注解的旧版本。

有人可以回答如何在 Android 项目中使用 powermock 和 mockito，而不会出现冲突的`org.hamcrest.Description`问题吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-01T23:54:40.250

抱歉，你不能在 Dalvik VM 中使用 PowerMock。

[PowerMock 通过在使用Javassist](http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/)修改类的字节码的自定义 ClassLoader 下运行测试来工作。这在普通 JVM 上可以正常工作，但在 Dalvik 上，字节码和类格式不同，所以这种方法不起作用。需要重写 PowerMock 以使用[Dexmaker](https://code.google.com/p/dexmaker/)而不是 Javassist - 这绝对不是微不足道的，而且我在 PowerMock[问题列表](https://code.google.com/p/powermock/issues/list)中看不到任何类似的东西。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-12-05T05:54:44.567

实际上，我发现这完全不真实（至少在最新版本中）。

在我想要测试我的代码的模块的 gradle 设置中

```
// Mockito and PowerMock
androidTestCompile ('org.powermock:powermock-mockito-release-full:1.6.0') {
    exclude module: 'hamcrest-core'
    exclude module: 'objenesis'
} 
```

一切运行良好。只要我使用：

```
@RunWith(PowerMockRunner.class) @PrepareForTest(ClassToMock.class) 
```

注释我的课程（例如，不能用 Robolectric 运行它，在 CI 环境中仍然可以）

# c# - LINQ 语句优化 - 寻求更好设计的建议

> ID：15305493
> 
> 赞同：1
> 
> 时间：2013-03-09T00:06:41.813
> 
> 标签：c#, linq, wcf-data-services, odata

我正在寻求有关如何更好地设计以下 LINQ 查询（使用 WCF 数据服务）的建议。要求是通过组合框显示员工列表。

DB表结构如下：

一个员工可以分配到多个项目，一个项目可以有多个员工。这种关系是通过 3 个表设计的：`[Employees] 1--* [EmployeeProjects] *--1 [Projects]`. 在 dot country 中，就像我正在遍历对象树一样：`Employee.EmployeeProjects.Project`.

以下 LINQ 语句返回一个列表`EmployeeProjects`，但我所追求的是属于这些特定项目的一部分的 Employee 列表。理想情况下，执行 . 是有意义的，但由于链接（很多）`IQueryable<Employee>`，我不知道如何构造我的 LINQ 语句。`EmployeeProjects`你看到我的困境了吗？

我执行一个`IQueryable<EmployeeProject>`因为，正如您从下面的 LINQ 语句中看到的那样，我不必处理“许多”方面，因为 Employee 和 Project 双方都是 1 关系。在获得 的列表后`EmployeeProjects`，我对其执行另一条`.Select()`语句以返回我最终想要的内容，即唯一员工姓名的列表，例如`.Select(results => results.Employee.Name).Distinct()`。

```
private IQueryable<EmployeeProject> GetEmployeeProjects()
{
    var employeeProjects =  service
        .CustomQuery<EmployeeProject>()
        .Where(et => ep.Project.Name == "TrackerX 43" ||
                     ep.Project.Name == "AccountingX 11" ||
                     ep.Project.Name == "TopX 2" ||
                     ep.Project.Name == "SiteX 32" ||
                     ep.Project.Name == "BuildingX 3" ||
                     ep.Project.Name == "ReportX 321" ||
                     ep.Project.Name == "PrototypeX 78" ||
                     ep.Project.Name == ... more ...)
        .OrderBy(ep => ep.Employee.Name)
        .Select(ep => new EmployeeProject
        {
            Id = ep.Id
            Project = new Project
            {
                Name = ep.Project.Name
            },
            Employee = new Employee
            {
                Id = ep.Employee.Id,
                Name = ep.Employeet.Name
            }
        });

    return employeeProjects;
} 
```

任何有关设计更好的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:12:12.657

您需要创建一个新的`EmployeeProject`还是可以简单地返回现有的？

您可以做的一件事是将字符串组合成一个数组并像这样比较它们：

```
//Move inside the method call if you need it to be dynamic.
private readonly string[] compareProjectNames = new[]
{ 
   "AccountingX 11", "TopX 2", "SiteX 32", 
   "BuildingX 3", "ReportX 321", "PrototypeX 78"
};
private IQueryable<EmployeeProject> GetEmployeeProjects()
{
    var employeeProjects =  service.CustomQuery<EmployeeProject>()
        .Where(et => compareProjectNames.Contains(ep.Project.Name))
        .OrderBy(ep => ep.Employee.Name)
        .Select(ep => new EmployeeProject
        {
            Id = ep.Id,
            Project = new Project
            {
                Name = ep.Project.Name
            },
            Employee = new Employee
            {
                Id = ep.Employee.Id,
                Name = ep.Employee.Name
            }
        });
    return employeeProjects;
} 
```

**编辑：**

仔细阅读您的帖子后，您可能还在寻找类似的东西来找到不同的项目名称

```
List<EmployeeProject> employeeProjects = new List<EmployeeProject>();
employeeProjects
   .GroupBy(et => et.Project.Name)
   .Select(grp => grp.First()); 
```

或者，在 1 个语句中

```
List<EmployeeProject> employeeProjects = new List<EmployeeProject>();
employeeProjects
        .Where(et => compareProjectNames.Contains(et.Project.Name))
        .GroupBy(cust => cust.Project.Name) //groups them by name, so no need to order
        .Select(grp => grp.First()) //selects the first distinct name per group
        .Select(ep => new EmployeeProject
        {
            Id = ep.Id,
            Project = new Project
            {
                Name = ep.Project.Name
            },
            Employee = new Employee
            {
                Id = ep.Employee.Id,
                Name = ep.Employee.Name
            }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T21:47:56.253

如果您在服务器端使用 EF，您应该能够对客户端完全隐藏 EmployeeProject 表。EF 应该能够将您的数据库结构转换为两个实体集（员工和项目），它们之间存在多对多关系（详细地说，它将创建两个 1-Many 单向关系）。

因此，从客户端来看，它看起来像一个Employees实体集，其中每个实例都有一个属性Projects，这是员工参与的项目列表。类似地，一个实体集Projects，其中每个实例都有一个属性Employees，它是员工列表分配给那个项目。

那么上面的查询可能会简单得多（使用 URL 表示法是为了简短，LINQ 版本有点明显，也简化了项目名称列表）：

~/Projects?$filter=(Name eq 'TopX 2') 或 (Name eq 'SiteX 32')&$expand=Employess

这将为您提供具有指定名称的所有项目，并为每个项目提供所有分配的员工。

这假设中间表纯粹用于连接其他两个表，如果您还在其中存储一些有关连接的附加信息，那么这将不起作用。

# types - 为什么这个类型前面有一个加号？

> ID：15305499
> 
> 赞同：16
> 
> 时间：2013-03-09T00:07:33.273
> 
> 标签：types, map, ocaml

我正在浏览 ocaml 的标准库，并在 map.ml 文件中遇到了这段代码。

```
module type S =
  sig
    type key
    type +'a t
    val empty: 'a t' 
```

我想知道为什么有`type +'a t`，为什么作者使用它而不是简单地使用它`'a t`。
它的行为很奇怪，我无法推断出它的用法。

```
# type +'a t = 'a list;;
type 'a t = 'a list
# type +'a t = +'a list;;
Characters 13-14:
  type +'a t = +'a list;;
               ^
Error: Syntax error 
```

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-09T06:55:55.040

为了建立 Jeffrey 的回答，开发人员在这里将抽象类型标记为协变的原因可能*不会*帮助您使用子类型（基本上没有人在 OCaml 中使用子类型，因为通常首选参数多态），而是使用类型系统中更鲜为人知的方面称为“宽松的值限制”，这要归功于协变抽象类型允许更多的多态性。

你可以放心地忽略这些细微之处，直到有一天，你遇到了一个抽象类型的问题，它不像你想要的那样多态，然后你应该记住，签名中的协方差注释可能会有所帮助。

几个月前，我们[在 reddit/ocaml 上](http://www.reddit.com/r/ocaml/comments/t8g2e/pdf_relaxing_the_value_restriction_by_jacques/)讨论过这个问题：

> 考虑以下代码示例：
> 
> ```
> module type S = sig
>   type 'a collection
>   val empty : unit -> 'a collection
> end
> 
> module C : S = struct
>   type 'a collection =
>     | Nil
>     | Cons of 'a * 'a collection
>   let empty () = Nil
> end
> 
> let test = C.empty () 
> ```
> 
> 您获得的类型`test`是`'_a C.collection`，而不是`'a C.collection`您期望的类型。它不是多态类型（`'_a`是尚未完全确定的单态推理变量），在大多数情况下您不会对它感到满意。
> 
> 这是因为`C.empty ()`不是一个值，所以它的类型不是泛化的（~变成了多态的）。要从放宽的值限制中受益，您必须标记抽象类型`'a collection`协变：
> 
> ```
> module type S = sig
>   type +'a collection
>   val empty : unit -> 'a collection
> end 
> ```
> 
> 当然，这只是因为模块`C`是用签名密封的`S`: `module C : S = ...`。如果模块`C`没有给出明确的签名，类型系统会推断出最普​​遍的方差（这里是协方差），而人们不会注意到这一点。
> 
> 针对抽象接口进行编程通常很有用（在定义函子、执行幻像类型规则或编写模块化程序时），所以这种情况肯定会发生，然后了解放宽的值限制很有用。

如果您想了解该理论，价值限制及其放松在 2004 年的研究文章中讨论了Jacques Garrigue 的[放松价值限制](http://caml.inria.fr/pub/papers/garrigue-value_restriction-fiwflp04.pdf)，其前几页是对该主题和主要思想的相当有趣且易于理解的介绍。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-09T00:30:17.983

这将类型标记为相对于模块类型是协变的。假设您有两个键是相同类型的映射。这`+`表示如果一个映射 A 的值是另一个映射 B 的值的子类型，则映射 A 的整体类型是映射 B 的类型的子类型。[我在Jane Street 博客](https://blog.janestreet.com/a-and-a/)中找到了一个很好的描述。

# c# - 如何获取 PushNotificationChannel.PushNotificationReceived 事件处理程序来拦截通知？

> ID：15305500
> 
> 赞同：1
> 
> 时间：2013-03-09T00:07:36.447
> 
> 标签：c#, windows-8, notifications

期望的行为是拦截应用程序中的原始通知（不需要后台任务或用户放弃他们宝贵的后台任务点之一）。[根据http://msdn.microsoft.com/en-us/library/windows/apps/xaml/JJ709907(v=win.10).aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/JJ709907%28v=win.10%29.aspx)上的示例代码，我创建了一个事件处理程序来拦截原始通知。在我创建的一个应用程序中，使用 Azure 移动服务通过 WNS 发送通知，事件处理程序被触发并且效果很好。

但在第二个应用程序中，它不起作用。通知似乎很好。也就是说，当我的 Web 服务让 WNS 发送 Toast 通知时，它就会显示出来。此外，我可以调试/跟踪原始通知，它们似乎也被创建得很好。我缺少一些设置吗？

我通过 Fiddler 看到了请求和结果，但可能只是因为我在本地运行 MVC 4.0 Web API 项目？？？请求如下所示：

```
{Channel URI:              https://bn1.notify.windows.com/?token=AgYAAACuGgtx...
TTL:                      -
Cache:                    no
Request for status:       no
Tag:                      
Priority:                 Normal
Token retry count:        0

really
} 
```

然后我可以跟踪这一点（全部通过 WNSRecipe/NotificationsExtensions 代码完成，该代码是 WAT 示例的一部分）。我得到：

```
{Sent WNS notification: Received
Channel URI:              https://bn1.notify.windows.com/?token=AgYAAACuGgtx...
Notification status:      Received
Status code:              OK
Device connection status: NotApplicable
Error description:        
Debug Trace:              BN1WNS2011828
MessageId:                3FA318CE5C48E9CF
Timestamp:                3/8/2013 9:23:18 PM -07:00

- REQUEST ------------------------------------------------------------------
X-WNS-Type                    : wns/raw
Content-Type                  : application/octet-stream
Authorization                 : Bearer EgAaAQMAAAAEgAAACoAAx1d3DqT9jZxJdOFIUJ9...
Host                          : bn1.notify.windows.com
Content-Length                : 6

really

- RESPONSE -----------------------------------------------------------------
X-WNS-NOTIFICATIONSTATUS      : received
X-WNS-MSG-ID                  : 3FA318CE5C48E9CF
X-WNS-DEBUG-TRACE             : BN1WNS2011828
Content-Length                : 0
Date                          : Sat, 09 Mar 2013 04:23:11 GMT
} 
```

结果：

```
{Channel URI:              https://bn1.notify.windows.com/?token=AgYAAACuGgtx...
Notification status:      Received
Status code:              OK
Device connection status: NotApplicable
Error description:        
Debug Trace:              BN1WNS2011828
MessageId:                3FA318CE5C48E9CF
Timestamp:                3/8/2013 9:23:18 PM -07:00
} 
```

所以我假设正在发送通知。

更新：我已经返回并仔细检查了设置，并在应用程序中添加了一个测试按钮来发布我的请求。（所以我知道该应用程序处于活动状态，毫无疑问）。我添加`RequestForStatus = true`到我的通知请求中，并在事件查看器中返回“设备连接状态：已连接”以及新的日志条目集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T11:40:20.887

在考虑了各种可能的问题/解决方案之后，我终于发现了问题所在。罪魁祸首是我的事件处理程序代码。无论出于何种原因，使用 NewtonSoft JObject 的代码在我的其他测试项目中运行良好，但在该项目中却以一种令人讨厌和沉默的方式失败了。我切换到使用 ServiceStack.Text （无论如何我一直想要这样做，因为据称它更快......在路上，除了简洁的原始通知之外，我还将在应用程序中输入和输出更多数据）。

我首先回到最简单的代码，除了：

```
private async void OnPushNotification(PushNotificationChannel sender, PushNotificationReceivedEventArgs e)
{
    if (e.NotificationType == PushNotificationType.Raw)
    {
        e.Cancel = true;

        String notificationContent = String.Empty;

        notificationContent = e.RawNotification.Content;
    }
} 
```

这取代了（仅供参考）看起来像这样的问题方法：

```
private async void OnPushNotification(PushNotificationChannel sender, PushNotificationReceivedEventArgs e)
{
    String notificationContent = String.Empty;

    switch (e.NotificationType)
    {
        case PushNotificationType.Badge:
        case PushNotificationType.Tile:
        case PushNotificationType.Toast:
            notificationContent = e.TileNotification.Content.GetXml();
            break;

        case PushNotificationType.Raw:
            notificationContent = e.RawNotification.Content;
            break;
    }

    e.Cancel = true;

    try
    {
        JObject jObject = JObject.Parse(notificationContent);

        JToken jToken;

        jObject.TryGetValue("refresh", out jToken);

        bool refreshValue = jToken != null && Convert.ToBoolean(jToken.ToString());

        if (refreshValue)
        {
            await Dispatcher.RunAsync(CoreDispatcherPriority.Normal, RefreshTodoItems);
        }
    }
    catch (Exception err)
    {
        Debug.WriteLine(err.Message);
    }
} 
```

最后，我得到了这个，它工作得很好：

```
private async void OnPushNotification(PushNotificationChannel sender, PushNotificationReceivedEventArgs e)
{
    await Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =>
        {
            if (e.NotificationType != PushNotificationType.Raw) return;
            e.Cancel = true;

            try
            {
                // Use ServiceStack.Text.WinRT to get this
                var jsonObj = JsonSerializer.DeserializeFromString<JsonObject>(e.RawNotification.Content);

                // TODO: Do something with this value now that it works
            }
            catch (Exception err)
            {
                Debug.WriteLine(err.Message);
            }
        });
} 
```

# r - 基于较大 Data.Frame 的多个子集创建多个列表

> ID：15305507
> 
> 赞同：4
> 
> 时间：2013-03-09T00:08:16.950
> 
> 标签：r, subset, plyr

在 R 中工作，我有与下面类似结构的数据（代码块 1）。我希望创建一个具有以下特征的新 data.frame：

对于每个唯一的 ID_1 值，我想要两个新列，一个包含 (ID_2s that share ID_1 & Direction==1) 的列表，另一列包含 (ID_2s that share ID_1 & Direction==0 的列表), (见下一个代码块 2)

**数据集块 1（初始）：**

```
ID_1    ID_2    Direction
100001  1           1
100001  11          1
100001  111         1
100001  1111        0
100001  11111       0
100001  111111      0
100002  2           1
100002  22          1
100002  222         0
100002  2222        0
100003  3           1
100003  33          1
100003  333         1
100003  3333        0
100003  33333       0
100003  333333      1
100004  4           1
100004  44          1 
```

转换成：

**数据集块 2（所需输出）：**

```
ID_1    ID_2_D1             ID_2_D0
100001  1,11,111            1111,11111,111111
100002  2,22                222,222
100003  3,33,333,333333     3333,33333
100004  4,44 
```

我有执行此操作的代码（获取子集子集的循环），但是我在数百万个唯一的“ID_1”上运行它，这非常耗时（我告诉你几个小时！！）。

有什么建议——也许使用 apply() 或 plyr() 包可以让它运行得更快？

* * *

参考代码：

```
DF <- data.frame(ID_1=c(100001,100001,100001,100001,100001,100001,100002,100002,100002,100002,100003,100003,100003,100003,100003,100003,100004,100004)
                   ,ID_2=c(1,11,111,1111,11111,111111,2,22,222,2222,3,33,333,3333,33333,333333,4,44)
                   ,Direction=c(1,1,1,0,0,0,1,1,0,0,1,1,1,0,0,1,1,1)
                   ) 
```

我当前（太慢）的代码：

```
 DF2 <- data.frame( ID_1=DF[!duplicated(DF$ID_1),][,1])

  for (i in 1:length(unique(DF2$ID_1))){
    DF2$ID_2_D1[i] <- list(subset(DF,ID_1==unique(DF2$ID_1)[i] & Direction==1)$ID_2)
    DF2$ID_2_D0[i] <- list(subset(DF,ID_1==unique(DF2$ID_1)[i] & Direction==0)$ID_2)        
  } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T01:22:00.483

像这样：

```
library(reshape2)
dcast(DF, ID_1 ~ Direction, value.var = "ID_2", list)
#     ID_1                   0                  1
# 1 100001 1111, 11111, 111111         1, 11, 111
# 2 100002           222, 2222              2, 22
# 3 100003         3333, 33333 3, 33, 333, 333333
# 4 100004                                  4, 44 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-09T03:33:18.257

@flodel 的答案是迄今为止我能想到的最直接的答案，但这是使用`aggregate`and的基础 R 中的一个选项`merge`。它利用步骤中的“ `subset`”参数`aggregate`来获取“Direction == 0”和“Direction == 1”时的单独列。

```
temp1 <- aggregate(ID_2 ~ ., DF, as.vector, subset = c(Direction == 0))
temp2 <- aggregate(ID_2 ~ ., DF, as.vector, subset = c(Direction == 1))
merge(temp1[-2], temp2[-2], by = "ID_1", all = TRUE, suffixes=c("_0", "_1"))
#     ID_1              ID_2_0             ID_2_1
# 1 100001 1111, 11111, 111111         1, 11, 111
# 2 100002           222, 2222              2, 22
# 3 100003         3333, 33333 3, 33, 333, 333333
# 4 100004                NULL              4, 44 
```

一种相关的方法（不确定它是否会更快）将`split`用于创建子集，`lapply`覆盖`aggregate`结果列表，并`Reduce`促进`merge`：

```
Reduce(function(x, y) 
  merge(x, y, by = "ID_1", all = TRUE, suffixes = c("_0", "_1")), 
       lapply(split(DF[1:2], DF$Direction), 
              function(x) aggregate(ID_2 ~ ID_1, x, as.vector))) 
```

* * *

而且，当然，这是一种使用 的方法`data.table`，您可能需要考虑使用这种方法，因为您已经提到必须在*数百万个唯一的“ID_1”* 上工作。您不太可能从这个小示例中看到任何速度优势，但您应该使用实际数据。

```
library(data.table)
DT <- data.table(DF, key = "ID_1")
DT0 <- DT[Direction == 0, list(D0 = list(ID_2)), by = key(DT)]
DT1 <- DT[Direction == 1, list(D1 = list(ID_2)), by = key(DT)]
DT0[DT1]
#      ID_1                D0              D1
# 1: 100001 1111,11111,111111        1,11,111
# 2: 100002          222,2222            2,22
# 3: 100003        3333,33333 3,33,333,333333
# 4: 100004                              4,44 
```

### 更新

正如@Arun 在 R Public 聊天室中提到的，这是一种简化的`data.table`方法，可以避免创建两个单独的对象并将它们合并。

```
DT[, list(list(D0 = ID_2[Direction==0]), list(D1 = ID_2[Direction == 1])), by=ID_1] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-09T01:16:54.017

你当然可以在这里使用 apply 函数。我不确定你是否需要，（即你可以通过 subsetting 变得更快），但我想不出你现在会怎么做。你可以像这样实现你想要的：

```
# Direction = 1
d1 <- lapply( unique( DF$ID_1 ) , function(x){ subset( DF , ID_1== x & Direction == 1)$ID_2 } )
d1 <- sapply( d1 , function(x){ paste0( x , sep = "," , collapse = "" ) } )
# Direction = 0
d0 <- lapply( unique( DF$ID_1 ) , function(x){ subset( DF , ID_1== x & Direction == 0)$ID_2 } )
d0 <- sapply( d0 , function(x){ paste0( x , sep = "," , collapse = "" ) } )

# Results dataframe
resDF <- data.frame(ID_1 = unique(DF$ID_1), d1, d0)
resDF
              d1                 d0                  
[1,] "100001" "1,11,111,"        "1111,11111,111111,"
[2,] "100002" "2,22,"            "222,2222,"         
[3,] "100003" "3,33,333,333333," "3333,33333,"       
[4,] "100004" "4,44,"            "," 
```

我很想知道这种方式是否/多快。

# php - RegEx matches all text that applies to only some of the query?

> ID：15305508
> 
> 赞同：0
> 
> 时间：2013-03-09T00:08:21.663
> 
> 标签：php, regex, pattern-matching, preg-match-all

I'm working on a html parser for a client, and I have just started messing around with RegEx. I'm quite new to it but am learning quickly! In this part, I need to acquire all of the text that is 18.0pt size within the document. Here is the first RegEx I have tried (using a real-time RegEx tester):

```
<p.*?><span.*?style='.*?font-size:1 
```

Here is my test text:

```
<p class=MsoNormal><span style='font-size:14.0pt;font-family:"Comic Sans MS"'>3<sup>rd</sup>
Sunday in Lent - 2013c<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;font-family:"Comic Sans MS"'>Old
Testament – Isaiah 55:1-9<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;font-family:"Comic Sans MS"'>New
Testament – Luke 13:1-9<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:18.0pt;font-family:"Comic Sans MS"'><o:p>&nbsp;</o:p>
</span></p> 
```

It works correctly and highlights each line separately until the 1\. **The problem is, right when I change 1 to 18, instead of highlighting just the line with font-size:18, it highlights ALL THE WAY from the first line until the 18.** I would like to just grab the line with 18pt font. Thank you, and any help is appreciated! :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:35:46.500

Here's a better regexp:

```
<p[^>]*>[ \t\r\n]*<span[^>]* style='[^']*font-size:18 
```

Your one is doing exactly as you told it; finding `<p`, then any number of arbitrary characters, then `><span`, then more arbitrary characters, then `font-size:18`. So it finds the first `<p` then all the *arbitrary characters* until `font-size:18`. You were just lucky in the first example that all your spans had font-size specified.

This version doesn't allow so much; stopping at any `>`. Also to make it more robust, I allowed whitespace between the `<p>` and `<span>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:27:24.713

如果您匹配“除换行符以外的任何字符”，而不是匹配“任何字符”（带点），您将确保不要超出行尾：

```
<p.*?><span[^\n]*?style='[^\n]*?font-size:18 
```

现在通常`.`不匹配换行符，除非设置了某些标志（这取决于您的环境） - 特别是`s`标志。这可能是您的正则表达式测试器的默认设置吗？

另一个想法是限制您希望与 {} 匹配的字符数 - 例如

```
<p.{,20}> 
```

只要您的开始`<p>`标签中的字符不超过 20 个，这将起作用。

# python-2.7 - scrapy deploy -L returns nothing

> ID：15305510
> 
> 赞同：0
> 
> 时间：2013-03-09T00:08:30.900
> 
> 标签：python-2.7, scrapy, scrapyd

I'm trying to deploy my scrapy project, but I'm stuck

I definately do have working project and several spiders:

```
deploy@susychoosy:~/susy_scraper$ scrapy
Scrapy 0.17.0 - project: clothes_spider 
```

and when I do scrapy list it shows list of all spiders.

I modified my scrapy.cfg file so it looks like that:

```
[settings]
default = clothes_spider.settings
[deploy:scrapyd]
url = http://localhost:6800/
project = clothes_spider 
```

Then I do:

```
deploy@susychoosy:~/susy_scraper$ scrapy deploy -l
scrapyd              http://localhost:6800/ 
```

so everything seems to be fine, however in next step i dont see any projects available:

```
deploy@susychoosy:~/susy_scraper$ scrapy deploy -L scrapyd

deploy@susychoosy:~/susy_scraper$ 
```

I tried typing directly:

```
deploy@susychoosy:~/susy_scraper$ scrapy deploy -L scrapyd -p clothes_spider

deploy@susychoosy:~/susy_scraper$ 
```

But it didn't help.

Any suggestions what am I doing wrong?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T04:02:55.683

您必须首先将项目部署到目标：

```
$ scrapy deploy scrapyd -p clothes_spider 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T02:47:26.100

What's the output in the terminal of "scrapy server" when you type "scrapy deploy -L scrapyd"? It should be like this, with the "listprojects.json":

```
2013-03-13 10:43:33+0800 [HTTPChannel,0,127.0.0.1] 127.0.0.1 - - [13/Mar/2013:02:43:33 +0000] "GET /listprojects.json HTTP/1.1" 200 42 "-" "Python-urllib/2.7" 
```

# c++ - How do I create a and random path between two edge points of a 2D vector?

> ID：15305512
> 
> 赞同：-1
> 
> 时间：2013-03-09T00:08:37.290
> 
> 标签：c++, algorithm, design-patterns, random, implementation

I'm not sure if I worded that correctly or not, but I'm trying display a 2d vector as a grid - randomly choosing 2 points on the edges/border of the grid (where y=0 and x=0..) and essentially randomly place a common character as a path between those two points. I will show a mockup of what I mean and my approach so far for obtaining this task. My logic could be wrong, but I feel like I may be on to a valid approach.

```
 This is just a sample, but I want
               it to randomly do this every time 
               the function is called. Let '@'
               be the starting points.

                             width
               |--------------------------------|

           -   .............................@....
           |   .............................#....
           |   .............................#....
        h  |   @####........................#....
        e  |   ....###......................#....
        i  |   ......#......................#....
        g  |   ......#...................####....
        h  |   ......#########...........#.......
        t  |   ..............#############.......
           |   ..................................
           |   ..................................
           -   .................................. 
```

* * *

The class has:

*   a private 2d vector of chars.
*   default constructor level(int width, height)
    *   resizes the vector to the correct width and height and fills it all with '.'

This is the function that displays the level to the console:

```
// Dump level to console
void Level::displayLevel(){

    // Iterate the outer vector
    for( auto it = levelGrid.begin(); it != levelGrid.end(); it++ ){
            // Iterate the inner vector
            for( auto itInner = (*it).begin();
                    itInner != (*it).end();
                    itInner++ ){

                    cout << (*itInner);
            }
            // End of line as we just output a row
            cout << endl;
        }
} 
```

* * *

I have an idea of of to do it, but not exactly sure how to implement it. I explain what I think I should be doing in the comments of the function and will edit it as it comes together.

I have a global random generator: mt19937 mt; And I seed it in main. It's been awhile since i've used a random generator and I forget how the syntax works. I would greatly appreciate the quick tip :)

This is what I'm working on but barely have it started:

```
void Level::generatePath(){
    //randomly choose node locations: (rX,0) and (0,rY)
    int rX = //random int between 0 and width-1
    int rY = //random int between 0 and height-1

    /***
     * Lost my train of thought while thinking about the logic :(
     *
     * set levelGrid[rX][0] = '@'
     * set levelGrid[0][rY] = '@'
     *
     * choose a random adjacent spot (in the direction towards the opposite node)
     * from those locations?
     *
     * repeat?
     *
     **********/

} 
```

I'm really struggling with this and not exactly sure how or where to start from. I'll try anything that seems like it has potential to work and update this as I progress. Any suggestions will be greatly appreciated. Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:26:35.203

试试这样的东西，它现在不会编译，但经过一些抛光它会给你你需要的东西。（你需要注意不要超越国界）

```
bool Level:getNext(int X, int Y, pair<int, int> target, vector<pair<int,int>> &path, vector<vector<bool>> &used) {
  path.emplace_back(X,Y);
  used[X][Y] = true;
  if(target.first == X && target.second == Y) return true;
  vector<int> directions = {1,2,3,4};
  for(int i = 1; i <= 4; ++i) {
     int rand = // random from 0 to 4-i;
     int dir = directions[rand];
     int x=X, y=Y;
     directions.erase[rand];
     if (dir == 1) x = X+1;
     else if (dir == 2) x = X-1;
     else if (dir == 3) y=Y+1;
     else if (dir == 4) y=Y-1;
     if (!used[x][y])
        if (getNext(x, y, target, path, used)) return true;
  }  
  path.pop_back();
  used[X][Y] = false;
  return false;
} 
```

# javascript - Running tomcat from nodejs

> ID：15305513
> 
> 赞同：4
> 
> 时间：2013-03-09T00:08:39.537
> 
> 标签：javascript, node.js, tomcat

I am trying to use child process in nodejs to launch a tomcat server on local machine. It is am experiment that will help me understand the way child process works and will help with a project I am working on. I've been looking at the documentation here: [http://nodejs.org/api/child_process.html](http://nodejs.org/api/child_process.html) but I am having a little of an issue actually doing this.

What I am trying to do is to run nodejs somewhere locally, once I click somewhere (or even launch the page), the page should run a tomcat server, make sure it is up then load the localhost:8080 welcome page. Once I close the page here the nodejs APIs are being called, it should shutdown tomcat (this part is not necessary for now, but just part of the experiment). Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T02:11:04.750

**看看这个 npm 模块[Shelljs](https://npmjs.org/package/shelljs)**

> ShellJS - 用于 Node.js 构建状态的 Unix shell 命令
> 
> ShellJS 是基于 Node.js API 的 Unix shell 命令的可移植（Windows/Linux/OS X）实现。您可以使用它来消除您的 shell 脚本对 Unix 的依赖，同时仍保留其熟悉且强大的命令。你也可以全局安装它，这样你就可以从外部节点项目运行它——告别那些粗糙的 Bash 脚本！

**ShellJS 已经在许多相关项目中进行了测试**

**既然它可以调用脚本，那么你就可以控制Tomcat的启动和关闭脚本，继续你的实验:)**

**ShellJS 可以选择：**

> 执行（命令 [，选项] [，回调]）
> 
> 可用选项（默认全部为 false）：
> 
> ```
> async: Asynchronous execution. Defaults to true if a callback is provided.
> silent: Do not echo program output to console. 
> ```
> 
> 例子：
> 
> var version = exec('node --version', {silent:true}).output;
> 
> var child = exec('some_long_running_process', {async:true}); child.stdout.on('data', function(data) { /* ... 对数据做一些事情 ... */ });
> 
> exec('some_long_running_process', function(code, output) {
> console.log('Exit code:', code); console.log('Program output:', output); });
> 
> 除非另有说明，否则同步执行给定的命令。在同步模式下返回对象 { code:..., output:... }，包含程序的输出 (stdout + stderr) 及其退出代码。否则返回子进程对象，回调获取参数（代码、输出）。
> 
> 注意：对于长期存在的进程，最好异步运行 exec()，因为当前的同步实现会占用大量 CPU。这应该很快得到解决。

# javascript - Javascript - 用户通过 HTML 输入标签输入来设置 Javascript 变量？

> ID：15305527
> 
> 赞同：7
> 
> 时间：2013-03-09T00:09:42.313
> 
> 标签：javascript, html, input, user-input

我希望我的屏幕上有一个文本框（就像我现在正在输入的那个），您可以输入然后单击提交按钮，它将您在框中输入的任何内容发送到 javascript，然后 javascript 将其打印出来。这里是我的代码这是有效的部分。

```
<html>
<body>
    <input type="text" id="userInput"=>give me input</input>
    <button onclick="test()">Submit</button>
    <script>
        function test()
        {
            var userInput = document.getElementById("userInput").value;
            document.write(userInput);
        }
    </script>
</body>
</html> 
```

好的，这很好，但是假设我想要从该文本框和按钮输入，而我已经在一个函数中并且不想重新启动该函数？

谢谢，杰克

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-09T00:27:50.660

当您的脚本运行时，它会阻止页面执行任何操作。您可以使用以下两种方法之一解决此问题：

*   使用`var foo = prompt("Give me input");`，它将为您提供用户在弹出框中输入的字符串（或者`null`如果他们取消它）
*   将您的代码拆分为两个函数 - 运行一个函数来设置用户界面，然后提供第二个函数作为用户单击按钮时运行的回调。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-09T00:26:39.957

这是一种糟糕的风格，但我认为你有充分的理由做类似的事情。

```
<html>
<body>
    <input type="text" id="userInput">give me input</input>
    <button id="submitter">Submit</button>
    <div id="output"></div>
    <script>
        var didClickIt = false;
        document.getElementById("submitter").addEventListener("click",function(){
            // same as onclick, keeps the JS and HTML separate
            didClickIt = true;
        });

        setInterval(function(){
            // this is the closest you get to an infinite loop in JavaScript
            if( didClickIt ) {
                didClickIt = false;
                // document.write causes silly problems, do this instead (or better yet, use a library like jQuery to do this stuff for you)
                var o=document.getElementById("output"),v=document.getElementById("userInput").value;
                if(o.textContent!==undefined){
                    o.textContent=v;
                }else{
                    o.innerText=v;
                }
            }
        },500);
    </script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-24T19:36:38.823

晚读这个，但是..我读你的问题的方式，你只需要更改两行代码：

接受用户输入，函数在屏幕上写回。

```
<input type="text" id="userInput"=> give me input</input>
<button onclick="test()">Submit</button>

<!-- add this line for function to write into -->
<p id="demo"></p>   

<script type="text/javascript">
function test(){
    var userInput = document.getElementById("userInput").value;
    document.getElementById("demo").innerHTML = userInput;
}
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-15T14:28:07.483

我尝试将输入标签的值发送/添加到对我来说效果很好的 JavaScript 变量中，这里是代码：

```
<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript">
            function changef()
            {
            var ctext=document.getElementById("c").value;

            document.writeln(ctext);
            }

        </script>
    </head>
    <body>
        <input type="text" id="c" onchange="changef"();>

        <button type="button" onclick="changef()">click</button>
    </body> 
</html> 
```

# python - 使用 __import__() 和 reload() 将代码写入文件并作为模块重新导入

> ID：15305528
> 
> 赞同：0
> 
> 时间：2013-03-09T00:09:48.090
> 
> 标签：python

我一直在尝试为我的程序实现 __import__() 和 reload() ，但未能成功。我有一个字符串，我将其写入 .py 文件（模块），然后将其作为模块加载。然后我对该 .py 文件（模块）进行更改并写入它，但我似乎无法在新更新的模块中更改返回值。这是我的代码：

```
str1 = '''
def run():
    return 10

'''
f = open('mycode.py','w')
f.write(str1)
f.close()
mymodule = __import__('mycode')

es = 'number = mymodule.run()'
exec(es)
print "number", number

str2 = '''
def run():
    return 99

'''
f = open('mycode.py','w')
f.write(str2)
f.close()

mymodule = reload(mymodule)
mymodule = __import__('mycode')

es = 'number = mymodule.run()'
exec(es)
print "number", number

OUTPUT:
>> number 10
>> number 10 # should be 99 
```

我看过这里：[Re-import the same python module with __import__() in a fail-safe way](https://stackoverflow.com/questions/11966446/re-import-the-same-python-module-with-import-in-a-fail-safe-way)

这里：

[重新加载已导入另一个模块的模块](https://stackoverflow.com/questions/14015405/reloading-module-which-has-been-imported-to-another-module?rq=1)

和这里：

[如何卸载（重新加载）Python 模块？](https://stackoverflow.com/questions/437589/how-do-i-unload-reload-a-python-module/487718#487718)

但我无法想出解决方案。任何帮助，将不胜感激。谢谢。

保罗

**编辑**

我使用 exec(es) 的原因是因为如果我有多个参数，我想自定义 es。这是一个例子：

```
p = [2,1]
p2 = [3,4,5]
p3 = [100,200,300,500]

str1 = '''
def run(x,y):
        return x + y

'''

with open('mycode.py','w') as f:
    f.write(str)
import mycode as mymodule

# how do i do this dynamically, 
# how to handle it when # of paremeters for run() change?
print mymodule.run(p[0],p[1])  # hard-coded parameter passing
# or, print mymodule.run(p[0],p3[1],p[2]) # if run() is changed 
```

所以问题是我的 run() 可以有不同的参数。它可以是 run(x,y) 或 run(larry, moe, curly, hickory, dickory, dock)。如何动态地将多个参数传递给 run()？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:40:40.053

您在这里的实际问题非常简单。我将解释如何解决它。但实际上，你不应该这样做。无论你想做什么，你都做错了。

并不是说没有理由任何人都可能想做这样的事情。但我非常有信心，`exec`因为不知道您可以将函数作为一等值传递、`__import__`使用文字模块名称等调用而使用的任何人都没有这样的理由。如果你解释了你实际上想要做什么，我们可以解释它。

但与此同时：

当您执行第一个`import`时，它正在创建一个`mycode.pyc`文件，并且`reload`只是重新加载该文件。

您可以通过删除来验证这一点`mycode.pyc`，然后运行`python -B reloadtest.py`而不是`python reloadtest.py`. 这显然为您提供了一种可能的解决方法。

或者，您可以`os.unlink('mycode.pyc')`在调用`reload`. 我认为大多数人会认为这非常荒谬，但我认为这与您最初尝试做的事情一样。

最后，如果您创建一个新`mycode.py`文件而不是就地重写现有文件，我认为这将解决问题。

* * *

同时，您的代码与以下代码完全相同。（为了解决您在评论中的困惑：完全相同意味着它将有完全相同的问题，并且完全相同的解决方案将解决它。）它也更简单，更pythonic，更容易调试，因为它只涉及*一个*巨大的反模式（在交互式解释器之外的任何地方使用重新加载）而不是四个：

```
str1 = '''
def run():
    return 10

'''
with open('mycode.py', 'w') as f:
    f.write(str1)
import mycode as mymodule

print "number", mymodule.run()

str2 = '''
def run():
    return 99

'''
with open('mycode.py', 'w') as f:
    f.write(str2)

reload(mymodule)

print "number", mymodule.run() 
```

* * *

在您的编辑中，您解释说您正在使用`exec`，因为您想传递动态可变数量的参数：

> 它可以是 run(x,y) 或 run(larry, moe, curly, hickory, dickory, dock)。如何动态地将多个参数传递给 run()？

简单的。只需将`x, y`or`larry, moe, curly, hickory, dickory, dock`放入`tuple`,`list`或其他序列中，然后使用`run(*seq)`.

例如，我假设你有这样的代码：

```
es = 'number = mymodule.run({})'.format(','.join(params))
exec(es) 
```

您可以将其替换为：

```
number = mymodule.run(*params) 
```

事实上，几乎任何情况下你都可以想象你认为你需要的地方`exec`，有更好的方法来做到这一点。如果您无法弄清楚，您可以在 Google 或 StackOverflow 上进行快速搜索，如果失败了，只需询问如何操作即可。用于动态代码生成对于tcl`exec`来说是惯用的，并且在几年前曾经用于 PHP 和 JavaScript，但在 Python 中几乎从来都不是正确的做法。

而且，您现在可能已经猜到了，动态创建模块到`import`/// etc也是如此`reload`。`execfile`

例如，您的真实代码可能正在尝试执行以下操作：

```
def make_new_module(n):
    str = '''
    def run():
        return {}        
    '''.format(n)
    f = open('mycode.py','w')
    f.write(str1)
    f.close()
    return __import__('mycode') 
```

但是您可以动态定义函数：

```
def make_new_function(n):
    def run():
        return n
    return run 
```

如果你真的需要命名`mymodule.run`，你可以轻松地创建一个命名空间，如类、类实例`namedtuple`等，将其粘贴进去。

如果你真的需要，你甚至可以即时创建一个新模块（尽管我敢打赌你不需要）：

```
import types
def make_new_module(n):
    def run():
        return n
    mymodule = types.ModuleType('mymodule')
    mymodule.run = run
    return mymodule 
```

在现有模块中重新绑定函数更容易：

```
def change_mymodule_run(n):
    def run():
        return n
    mymodule.run = run 
```

是的，模块是一等值，就像函数一样，所以如果`module`是动态参数而不是静态值，你可以很容易地做到这一点：

```
def change_module_run(module, n):
    def run():
        return n
    module.run = run 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:19:18.973

正如一些评论者所说，您可能不需要编写模块来获得动态代码。这是一个替代实现，它创建了一个`run`函数的两个不同版本，它们给出了不同的结果：

```
def run_function_factory(n):
    def run_function():
        return n
    return run_function

run1 = run_function_factory(10)
print("run1 returns", run1()) # prints "run1 returns 10"

run2 = run_function_factory(99)
print("run2 returns", run2()) # prints "run2 returns 99" 
```

显然，您的实际代码会更复杂，但是对于您需要的几乎任何变化，都应该可以使用类似的编码风格（将函数视为一流对象）。例如，如果`run`接受两个参数，`a`并对`b`它们进行一些算术运算，然后`n`在返回之前，你会使用这样的东西：

```
def run_function_factory(n):
    def run_function(a, b):
        return a*n + b

run1 = run_function_factory(10)
for x in range(3):
    for y in range(2,5):
        print(run1(x,y)) # prints 2,3,4,12,13,14,22,23,24 (one per line) 
```

# mips - 查找指令集的范围

> ID：15305530
> 
> 赞同：0
> 
> 时间：2013-03-09T00:10:11.673
> 
> 标签：mips

（即离当前PC能走多远）

我正在尝试在 mips 上找到指令集的范围

您如何找到分支指令集、j/jal/ 和 jr 指令的范围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T23:09:28.817

分支指令有一个 16 位带符号的偏移字段。这是一个字偏移量，因此分支指令的目标地址范围是当前 PC 的 +/- 128kByte。

`J`and`JAL`指令有一个 26 位的偏移量。这是当前 256MB 对齐地址区域内的字偏移量，因此`J`和`JAL`指令的目标地址范围为：

*   从`(current-PC & 0xfc000000)`到 `(current-PC & 0xfc000000) + 256MB`。

`JR`and指令跳转到寄存器中包含的`JALR`地址，因此它们可以跳转到 4GByte 地址空间中的任何地址。

# jquery - Changing post url for the application in jQuery

> ID：15305532
> 
> 赞同：0
> 
> 时间：2013-03-09T00:10:22.023
> 
> 标签：jquery, grails, web

I have some jQuery code that looks like this:

```
$.post("/myapp/mycontroller/save", { myObject: JSON.stringify(jsonObject) })
    .done(function(data) {
        $("#successmsg").text(data);
        $("#successmsg").show();
    }); 
```

This all works fine on my local environment because name of my app when running on local environment is `myapp`

However, when I deploy to test environment, the name of the app is `mytestapp` so this code fails to work on test environment.

How do I resolve this problem? How can I simply take out the app name?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:51:13.697

我会避免指定基本 url，除非你必须（来自另一个应用程序的 Ajax 调用）。

如果您的电话来自同一个应用程序，那么您的问题应该可以通过执行以下操作轻松解决：

```
$.post("${g.createLink(controller:'mycontroller', 
        action: 'save')}", 
        { myObject: JSON.stringify(jsonObject) })
    .done(function(data) {
        $("#successmsg").text(data);
        $("#successmsg").show();
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T03:36:21.720

您的服务器 url 应该已经在您的配置中定义（`grails-app/conf/Config.groovy`除非您已更改它）：

```
grails.serverURL = "http://localhost:8080/myapp" 
```

然后在你的布局中（默认情况下，主布局是`grails-app/views/layouts/main.gsp`）

```
<g:javascript>var baseURL = '${grailsApplication.config.grails.serverURL}';</g:javascript> 
```

然后`baseURL`可以在你的任何`.js`文件中访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:19:29.310

使用url解析

```
var context = window.location.href.split('/')[3]
$.post("/"+context+"/mycontroller/save", ... 
```

我在一家铁路商店工作，这是一个经常出现的问题。这每次都能解决它，并在每个项目中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T00:20:05.950

将此添加到您的 html 中：

```
<script>
$(function() {
     var baseUrl = //YourDynamicallyGeneratedBaseURL;
});
</script> 
```

和 Ajax 调用会是这样的：

```
$.post(baseUrl + "/mycontroller/save", ... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-09T00:26:06.803

您可以[`<base>`](https://developer.mozilla.org/en/docs/HTML/Element/base)为所有相对 URL 使用具有基本 URL 的元素。

```
<base href="/myapp/"> 
```

通过这种方式，您可以以不同方式控制生产和开发环境的基本 URL。

例如，您的 AJAX URL 将变为：

```
$.post("mycontroller/save", {
  ...
}); 
```

# c# - C# 中的 Direct3D COM 对象调用

> ID：15305549
> 
> 赞同：2
> 
> 时间：2013-03-09T00:12:19.580
> 
> 标签：c#, com, interop, direct3d

有人尝试过从 C# 手动调用 Direct3D 接口吗？我编写了以下短代码并`result == S_OK`在调用`D3D11CreateDevice()`.

我希望`GetCreationFlags()`返回`32`，这是我调用时的参数之一`D3D11CreateDevice()`，但我得到了`AccessViolationException`。我在这里想念什么？

先感谢您。

```
[Guid("DB6F6DDB-AC77-4E88-8253-819DF9BBF140")]
interface ID3D11Device
{
    [return : MarshalAs(UnmanagedType.U4)]
    uint GetCreationFlags();
}

    [DllImport("d3d11.dll", CallingConvention = CallingConvention.StdCall)]
    private unsafe static extern int D3D11CreateDevice(
        void* arg0, int arg1, void* arg2, int arg3, void* arg4, int arg5, int arg6,
        [Out, MarshalAs(UnmanagedType.Interface)] out object arg7,
        void* arg8, void* arg9);

    public static void CreateDevice()
    {
        object deviceOut;
        int arg8;
        IntPtr arg9;

        unsafe
        {
            int result = D3D11CreateDevice(
                (void*)IntPtr.Zero, 1, (void*)IntPtr.Zero, 32,
                (void*)IntPtr.Zero, 0, 7,
                out deviceOut,
                &arg8,
                &arg9);
        }

        ID3D11Device dev = (ID3D11Device)deviceOut;

        uint i = dev.GetCreationFlags(); // System.AccessViolationException
    } 
```

供您参考，原型`D3D11CreateDevice`和`ID3D11Device::GetCreationFlags()`外观如下：

```
HRESULT D3D11CreateDevice(
  _In_   IDXGIAdapter *pAdapter,
  _In_   D3D_DRIVER_TYPE DriverType,
  _In_   HMODULE Software,
  _In_   UINT Flags,
  _In_   const D3D_FEATURE_LEVEL *pFeatureLevels,
  _In_   UINT FeatureLevels,
  _In_   UINT SDKVersion,
  _Out_  ID3D11Device **ppDevice,
  _Out_  D3D_FEATURE_LEVEL *pFeatureLevel,
  _Out_  ID3D11DeviceContext **ppImmediateContext
);

UINT GetCreationFlags(); 
```

# python - 键列表的递减值

> ID：15305551
> 
> 赞同：0
> 
> 时间：2013-03-09T00:12:34.633
> 
> 标签：python, key, decrement

我有一个键列表：带有附加到特定键的整数值的值...

这些整数值表示特定手牌中的字母数...

例如，这是一只手-

```
hand = {'a':1, 'q':1, 'l':2, 'm':1, 'u':1, 'i':1} 
displayHand(hand) # Implemented for you
a q l l m u i
hand = updateHand(hand, 'quail') # You implement this function!
hand
{'l': 1, 'm': 1}
displayHand(hand)
l m 
```

在这种情况下 - 这个电话 -

```
updateHand({'a': 1, 'i': 1, 'm': 1, 'l': 2, 'q': 1, 'u': 1}, quail) 
```

应该导致这个输出 -

```
{'a': 0, 'q': 0, 'u': 0, 'i': 0, 'm': 1, 'l': 1} 
```

注意到鹌鹑一词中的字母是如何全部减一的吗？

那么如果键的值大于零，如何通过减一来更改键的值？

这是我到目前为止的代码 -

```
for c in word:

    if c in hand:
        x = int(hand.get(c))
        x -= 1

return hand 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:08:50.203

这是你的代码：

```
def updateHand(hand, word):
    for c in word:
        if c in hand:
            x = int(hand.get(c))
            x -= 1
    return hand 
```

但这对`hand`. 为什么不？好吧，试图改变东西的那条线就是这`x -= 1`条线。但这只会改变 的值`x`，您刚刚将其定义为`int(hand.get(c))`。在 Python 中，这意味着如果`hand`值为`2`for `c`，您将设置`x = 2`. 但这*并不*意味着改变`x`会改变`c`in的值`hand`。相反，您需要做一些不同的事情：

```
def updateHand(hand, word):
    for c in word:
        if c in hand:
            hand[c] -= 1
    return hand 
```

* * *

在这种特殊情况下无关紧要，但这个函数实际上修改了输入`hand`，然后返回相同的。例如：

```
>>> hand = {'a': 1, 'i': 1, 'm': 1, 'l': 2, 'q': 1, 'u': 1}
>>> new_hand = updateHand(hand, 'quail')
>>> new_hand
{'l': 1, 'm': 1}
>>> hand
{'l': 1, 'm': 1} 
```

通常，您要么希望`updateHand`返回一个新字典而让旧字典不理会，要么让它不返回任何内容而只修改输入参数。因为看起来你已经获得了代码

```
hand = updateHand(hand, 'quail') 
```

你应该做这两个中的第一个。实现此目的的一种方法是添加`hand = hand.copy()`为`updateHand`; 然后它会留下旧的。

* * *

现在，另一件事是，如果它们曾经是 1，那么您的代码会将`0`值放入输出中，但您的分配根本不包括它们。我会让你弄清楚如何准确地处理这种情况，但作为一种方法的提示：你可以通过语句从字典中删除项目`del hand[c]`。

* * *

不建议您这样做，但作为@Jared 展示一下 Python 的旁白：:)

```
def updateHand(hand, word):
    return collections.Counter(hand) - collections.Counter(word) 
```

（在调用中包装返回值`dict`以使其完全成为所需的接口）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:09:17.377

嗯...在我们了解该语言之前，我遇到了麻烦，所以我不妨发布它，但它是 Javascript。不知道其中有多少可能是 Pythonizable ^©，但它给出了我评论的要点，并且有一个工作小提琴可供查看。

请注意，使用带有打开的 Javascript 控制台的浏览器来查看输出。

```
var hand = {a:1, q:1, l:2, m:1, u:1, i:1},
    quail = 'quail';

displayHand(hand);

hand = updateHand(hand, quail);

displayHand(hand);

function displayHand(obj) {
    var log = '',
        key;

    for (key in obj) {
        if (obj.hasOwnProperty(key) && obj[key]) {
            log += key;
        }
    }

    console.log(log.split('').join(' ') || 'Nothing');
}

function updateHand(obj, tokens) {
    var pos = 0,
        token;

    while (token = tokens[pos++]) {
        if (obj.hasOwnProperty(token) && obj[token] > 0) {
            obj[token]--;
        }
    }

    return obj;
} 
```

[http://jsfiddle.net/userdude/ybrn4/](http://jsfiddle.net/userdude/ybrn4/)

# php - MYSQLi 准备插入不起作用..

> ID：15305553
> 
> 赞同：1
> 
> 时间：2013-03-09T00:12:58.203
> 
> 标签：php, mysqli, prepare

我被困在 mysqli prepare 上。我几乎可以肯定准备好的语句中没有错误。然而，我得到了“调用非成员对象错误”..据我回忆，这个错误只有在事实上语句有错误时才会发生..“调用非对象上的成员函数 bind_param()”。 .我不太确定我是否使用了任何保留字..也许有人可以帮忙..

```
$stmt = $mysqli->prepare("INSERT INTO customers (cid, company, fname, sname, email,  mobile, email_notif, sms_notif, telephone, address, postcode, city, town, allowedLogin, date, addedby)
                          VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");

$stmt->bind_param("ssssssssssssssss", $id, $company, $fname, $sname, $email, $mobile, $emailnotif, $smsnotif, $telephone, $address, $postcode, $city, $town, $allowedLogin, $date, $addedby);

    if( $stmt->execute() )
    {   
        /* Free Result Set */
        $stmt->close();
        return true;    
    } 
   else
   {
        return "<p>".$mysqli->error."</p>";
   } 
```

ps我通过函数调用传递变量：

```
addCustomer($company,$fname,$sname,$email,$mobile,$smsnotif,$emailnotif,$telephone,$address,$postcode,$city,$town,$allowedLogin, $date, $addedby); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:27:35.833

`date`是一个[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。尝试在它周围添加反引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:24:30.027

我看到`$id`正在`bind_param`使用但没有从函数传递`addCustomer`

# shell - 用于检查文件是否存在的 Shell 脚本

> ID：15305556
> 
> 赞同：8
> 
> 时间：2013-03-09T00:13:16.680
> 
> 标签：shell

我正在尝试编写一个简单的脚本，它会告诉我 $Temp 中是否存在以字符串“Test”开头的文件名。

例如，我有这些文件

```
Test1989.txt
Test1990.txt
Test1991.txt 
```

然后我只想回显找到了一个文件。

例如，像这样：

```
file="home/edward/bank1/fiche/Test*"
if  test -s "$file" 
then 
    echo "found one"
else 
    echo "found none"
fi 
```

但这不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T00:24:06.377

一种方法：

```
(
  shopt -s nullglob
  files=(/home/edward/bank1/fiche/Test*)
  if [[ "${#files[@]}" -gt 0 ]] ; then
    echo found one
  else
    echo found none
  fi
) 
```

解释：

*   `shopt -s nullglob`*如果没有*文件与该模式匹配，将导致`/home/edward/bank1/fiche/Test*`扩展为空。（没有它，它将保持原样。）
**   `( ... )`设置一个子shell，防止`shopt -s nullglob`“逃逸”。*   `files=(/home/edward/bank1/fiche/Test*)`将文件列表放入名为`files`. （请注意，这仅在子外壳中；`files`在子外壳退出后将无法访问。）*   `"${#files[@]}"`是此数组中的元素数。*

 ** * *

**编辑以解决**后续问题（“如果我还需要检查这些文件中是否有数据并且不是零字节文件怎么办”）：

对于这个版本，我们需要使用`-s`（就像您在问题中所做的那样），它还测试文件是否存在，因此`shopt -s nullglob`不再使用：如果没有文件与模式匹配，那么`-s`模式将是错误的。所以，我们可以写：

```
(
  found_nonempty=''
  for file in /home/edward/bank1/fiche/Test* ; do
    if [[ -s "$file" ]] ; then
      found_nonempty=1
    fi
  done
  if [[ "$found_nonempty" ]] ; then
    echo found one
  else
    echo found none
  fi
) 
```

（这里`( ... )`是为了防止`file`和`found_file`“逃避”。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-23T03:02:47.210

您必须了解 Unix 如何*解释*您的输入。

标准的 Unix shell在将参数传递给程序之前会插入环境变量以及所谓的*glob 。*这与使程序解释扩展的 Windows 有点不同。

尝试这个：

```
 $ echo * 
```

这将回显当前目录中的所有文件和目录。在`echo`命令执行之前，shell 会插入`*`并扩展它，然后将该扩展参数传递回您的命令。您可以通过执行以下操作来查看它的实际效果：

```
$ set -xv
$ echo *
$ set +xv 
```

`set -xv`打开*xtrace*和*verbose*。_ Verbose 回显输入的命令，而*xtrace*回显将要执行的命令（即在 shell 扩展之后）。

现在试试这个：

```
$ echo "*" 
```

请注意，将某些内容放在引号中会对 shell 隐藏*glob 表达式*，并且 shell 无法扩展它。尝试这个：

```
$ foo="this is the value of foo"
$ echo $foo
$ echo "$foo"
$ echo '$foo' 
```

请注意，shell 仍然可以在双引号内展开环境变量，但不能在单引号内展开。

现在让我们看看你的陈述：

```
file="home/edward/bank1/fiche/Test*" 
```

双引号防止 shell 扩展*glob 表达式*，因此`file`等于文字`home/edward/bank1/finche/Test*`。因此，您需要这样做：

```
file=/home/edward/bank1/fiche/Test* 
```

缺少引号（以及重要的介绍性斜线！）现在将使文件等于与该表达式匹配的所有文件。（可能不止一个！）。如果没有文件，取决于外壳程序及其设置，外壳程序可能只是将文件设置为该文字字符串。

你当然有正确的想法：

```
 file=/home/edward/bank1/fiche/Test*
 if  test -s $file
    then 
        echo "found one"
    else 
       echo "found none"
 fi 
```

但是，如果有多个文件，您仍然可能会*发现没有返回。*相反，您可能会在命令中收到错误，`test`因为参数太多。

解决此问题的一种方法可能是：

```
if ls /home/edward/bank1/finche/Test* > /dev/null 2>&1
then
    echo "There is at least one match (maybe more)!"
else
    echo "No files found"
fi 
```

在这种情况下，我利用了`ls`命令的退出代码。如果`ls`找到一个它可以访问的文件，它会返回一个零退出代码。如果找不到匹配的文件，则返回非零退出代码。该`if`命令仅执行一个命令，然后如果该命令返回零，则假定该`if`语句为*真*并执行该`if`子句。如果命令返回非零值，`if`则假定语句为假，并执行`else`子句（如果有的话）。

该`test`命令以类似的方式工作。如果`test`为真，则该`test`命令返回零。否则，该`test`命令返回一个非零值。这对`if`命令很有用。实际上，该命令有一个*别名。*`test`尝试这个：

```
 $ ls -li /bin/test /bin/[ 
```

`i`打印出*inode*。*inode*是文件的真实 ID 。具有相同 ID 的文件是同一个文件。您可以看到，`/bin/test`并且`/bin/[`是相同的命令。这使得以下两个命令相同：

```
if test -s $file
then
    echo "The file exists"
fi

if [ -s $file ]
then
    echo "The file exists"
fi 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-09T00:59:54.373

您可以在一行中完成：

```
ls /home/edward/bank1/fiche/Test* >/dev/null 2>&1 && echo "found one" || echo "found none" 
```

要了解它的作用，您必须分解命令并对布尔逻辑有基本的认识。

直接来自 bash 手册页：

```
[...]
expression1 && expression2
     True if both expression1 and expression2 are true.
expression1 || expression2
     True if either expression1 or expression2 is true.
[...] 
```

在 shell 中（通常在 unix 世界中），布尔值 true 是一个以状态 0 退出的程序。

`ls`尝试列出模式，如果成功（意味着模式存在），则以状态 0 退出，否则以 2 退出（有关详细信息，请查看 ls 手册页）。

在我们的例子中，实际上有 3 个表达式，为了清楚起见，我会加上括号，尽管它们不是必需的，因为`&&`优先于`||`：

```
 (expression1 && expression2) || expression3 
```

因此，如果表达式 1 为真（即：`ls`找到模式），它将评估表达式 2（这只是一个回声，将以状态 0 退出）。在这种情况下，表达式 3 永远不会进行评估，因为左侧站点上的`||`内容已经是真实的，并且尝试评估右侧站点上的内容会浪费资源。

否则，如果 expression1 为 false，则不对 expression2 求值，但在本例中为 expression3。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-29T09:13:34.163

```
for entry in "/home/loc/etc/"/*
do

   if [ -s /home/loc/etc/$entry ]
   then
       echo "$entry File is available"
   else
       echo "$entry File is not available"
fi
done

Hope it helps 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-25T04:43:23.230

如果该脚本存在于指定变量中，则以下脚本将帮助您进入进程，

```
cat > waitfor.csh

    #!/bin/csh

    while !( -e $1 )

    sleep 10m

    end

ctrl+D 
```

这`-e`是用于处理文件，

`$1`是一个外壳变量，

睡10分钟

你可以通过执行脚本`./waitfor.csh ./temp ; echo "the file exits"`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-06T10:49:35.787

一个检查文件是否存在的衬垫 -

```
awk 'BEGIN {print getline < "file.txt" < 0 ? "File does not exist" : "File Exists"}' 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-09T00:23:19.203

通配符不会在带引号的字符串内展开。并且当通配符展开时，如果没有匹配则原样返回，不会展开为空字符串。尝试：

```
output="$(ls home/edward/bank1/fiche/Test* 2>/dev/null)"
if [ -n "$output" ]
then echo "Found one"
else echo "Found none"
fi 
```

如果通配符扩展为文件名，`ls`则将它们列在`stdout`; 否则它将在 上打印错误`stderr`，而在 stdout 上什么也没有。的内容`stdout`分配给`output`。

`if [ -n "$output" ]`测试是否`$output`包含任何东西。

另一种写法是：

```
if [ $(ls home/edward/bank1/fiche/Test* 2>/dev/null | wc -l) -gt 0 ] 
```*

# javascript - 如何使用 ajax 调用下载网页

> ID：15305557
> 
> 赞同：1
> 
> 时间：2013-03-09T00:13:22.150
> 
> 标签：javascript, ajax, web-scraping

我想在这里下载所有标题文章的列表， [http://seekingalpha.com/symbol/amzn](http://seekingalpha.com/symbol/amzn)

但是有一个“更多”按钮可以进行 Ajax 调用。有没有办法可以下载完整的文章列表？

我不熟悉 javascript 或 Ajax，所以任何建议都会非常有帮助。

这是按钮的javascript函数。

```
function portfolioPagination(type, page, direction){
  if ($(type + '_show_more')) {
    $(type + '_show_more').remove();
    $('show-more-preloader').style.display = "";
  }
  if (page == 0) return;
  new Ajax.Updater({success: 'headlines_'+type}, '/account/ajax_headlines_content', {
    parameters: { type: type, page: page, slugs: 'amzn', is_symbol_page : true},
    insertion: 'bottom',
    onComplete: function(){$('show-more-preloader').style.display = "none";}
  });
  if (window.pageTracker) pageTracker._trackEvent("Portfolio Tracking", 'Pagination', type+" - "+direction);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:16:18.267

使用 Chrome 检查器或 Firebug 或类似的东西来查看 AJAX 请求，可能类似于查看该请求`../account/ajax_headlines_content/..`的结果。有你想要的数据。

--

网址是：[http ://seekingalpha.com/account/ajax_headlines_content](http://seekingalpha.com/account/ajax_headlines_content)

数据为（表单数据）：

```
type: all
page: 2
slugs: amzn
is_symbol_page: true
_: 
```

看起来它也接受`$_GET`：[http ://seekingalpha.com/account/ajax_headlines_content?type=all&page=2&slugs=amzn&is_symbol_page=true&_=](http://seekingalpha.com/account/ajax_headlines_content?type=all&page=2&slugs=amzn&is_symbol_page=true&_=)

# java - java和python中的Unicode字符串支持

> ID：15305558
> 
> 赞同：0
> 
> 时间：2013-03-09T00:13:23.087
> 
> 标签：java, android, python, google-app-engine, unicode

我有一个 Android 应用程序，我在其中读取短信并将其发送到谷歌应用引擎服务器。一些用户抱怨某些语言无法正常通过。

```
 // Execute query
        cursor = context.getContentResolver().query(
                SMS_PROVIDER_URI,
                SMS_QUERY_FIELDS,
                "date >= " + startDate.getTime(),  // selection - get messages > startDate
                null,                              // selectionArgs
                "date ASC");                       // order - get oldest messages first

        // Iterate results
        if (cursor != null && cursor.moveToFirst()) {

            // read through all the sms and create a list
            do {
                String sender              = cursor.getString(0);
                String message             = cursor.getString(2);
                boolean isIncomingMessage  = cursor.getString(3).contains("1");
                Date date                  = new Date(cursor.getLong(1));

                String contactName = ContactLookup.lookup(context, sender);

                smsList.add(new SMSMessageInfo(sender, contactName,
                        message, isIncomingMessage, date));

            } while (cursor.moveToNext());
        } 
```

message 变量包含来自不同语言的短信。我如何支持它？另外，我需要将它发送到我的服务器（python），如何翻译服务器上的 unicode？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:57:35.283

在 Python 2.7 中有两类字符串，`str`（标准字符串，由字节组成）和`unicode`（由 unicode 字符组成，使用 u 前缀表示为文字：u"foo"）。转换是通过使用实例上的方法完成的：

```
u"blä".encode('utf8') → "bl\xc3\xa4"  # from unicode to str
"bl\xc3\xa4".decode('utf8') → u"blä"  # from str to unicode 
```

转换通常是隐式发生的，例如，如果您将 a 添加`str`到 a `unicode`，则在连接之前将其`str`提升为 a `unicode`（默认使用 encoding `ascii`）。

另一方面，`unicode`获得 ed 的实例`print`将被转换为`str`第一个，使用取决于它打印的流的编码（通常`ascii`也是如此）。

这些自动转换的场合往往是异常的来源（即如果转换失败）。如果你捕捉到太多异常，这些可能会被忽视，然后只是一些工具不起作用。

# java - 如何将地图转换为 XML

> ID：15305561
> 
> 赞同：0
> 
> 时间：2013-03-09T00:13:54.803
> 
> 标签：java, xml, xstream

我有一个 HashMap，我想将其转换为 XML 文件。本[教程演示](https://stackoverflow.com/questions/1537207/how-to-convert-xml-to-java-util-map-and-vice-versa)了如何使用 XStream 执行此操作，并且效果非常好。但是，就我而言，我不需要将 XML 解组为 Map。因此 unmarshal 方法变得多余。XStream 中是否有另一种方法可以在不实现 unmarshall 方法的情况下完成我想做的事情。或者是否有另一个友好的对象到 XML api 可以用来完成这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:04:36.680

我决定扩展一个 MapConverter 并覆盖它的 marshal 方法：

```
 public static class MapEntryConverter extends MapConverter {

public MapEntryConverter(Mapper mapper) {
    super(mapper);     
}

public boolean canConvert(Class clazz) {
    return ListMultimap.class.isAssignableFrom(clazz);
}

public void marshal(Object value, HierarchicalStreamWriter writer,
    MarshallingContext context) {

    ListMultimap<String, String> map = (ListMultimap<String, String>) value;
    for (String key : map.keys()) {
    writer.startNode(key);
    writer.setValue(map.get(key).get(0));
    writer.endNode();
    }
}

} 
```

当我整理我的地图时，我使用这个转换器：

```
 ListMultimap<String, String> multimap = LinkedListMultimap.create();
multimap.put("x", "1");
multimap.put("x", "2");
multimap.put("y", "3");

XStream xStream = new XStream(new DomDriver());
xStream.registerConverter(new MapEntryConverter(xStream.getMapper()));

xStream.alias("add", multimap.getClass());
String xml = xStream.toXML(multimap);
System.out.println(xml); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:20:59.093

如果您需要实现一半的接口（OO 纯粹主义者不寒而栗），最好的方法可能是这样做：

```
public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {
    throw new UnsupportedOperationException("Write this message");
} 
```

# android - 从正在运行的线程更新 UI

> ID：15305569
> 
> 赞同：0
> 
> 时间：2013-03-09T00:15:05.880
> 
> 标签：android, multithreading

我想编写一个下载管理器应用程序，在`activity`我添加一个进度条，向用户显示当前进度，现在如果用户触摸后退按钮并重新打开，`activity`这`ProgressBar`将不会被更新。

为了避免这个问题，我为每个下载创建一个具有唯一名称的单个线程，以保持进度可运行并检查该线程是否在`onResume`函数中运行，如果它是然后将其克隆到当前线程并再次重新运行新线程，但它也不会更新我的用户界面，有什么想法！？

```
@Override
public void onResume() 
{
    super.onResume();
    Set<Thread> threadSet = Thread.getAllStackTraces().keySet();
    Thread[] threadArray = threadSet.toArray(new Thread[threadSet.size()]);
    for (int i = 0; i < threadArray.length; i++)
        if (threadArray[i].getName().equals(APPLICATION_ID))
        {
            mBackground = new Thread(threadArray[i]);
            mBackground.start();
            downloadProgressBar.setVisibility(View.VISIBLE);
            Toast.makeText(showcaseActivity.this
                    , "Find that thread - okay", Toast.LENGTH_LONG).show();
        }
}

private void updateProgressBar()
{
    Runnable runnable = new updateProgress();
    mBackground  = new Thread(runnable);
    mBackground.setName(APPLICATION_ID);
    mBackground.start();
}

private class updateProgress implements Runnable
{
    public void run() 
    {
        while (Thread.currentThread() == mBackground)
            try 
            {
                Thread.sleep(1000); 
                Message setMessage = new Message();
                setMessage.what = mDownloadReceiver.getProgressPercentage();        
                mHandler.sendMessage(setMessage);
            }
            catch (InterruptedException e) 
            {
                Thread.currentThread().interrupt();
            } 
            catch (Exception e) 
            {/* Do Nothing */}
    }
}

private Handler mHandler = new Handler()
{
    @Override
    public void handleMessage(Message getMessage) 
    {
        downloadProgressBar.setIndeterminate(false);
        downloadProgressBar.setProgress(getMessage.what);
        if (getMessage.what == 100)
            downloadProgressBar.setVisibility(View.GONE);
    }
}; 
```

下载按钮代码：

```
downloadBtn.setOnClickListener(new View.OnClickListener()
{
    @Override
    public void onClick(View arg0) 
    {
        downloadProgressBar.setVisibility(View.VISIBLE);
        downloadProgressBar.setIndeterminate(true);
        downloadProgressBar.setMax(100);    
        Intent intent = new Intent(showcaseActivity.this, downloadManagers.class);
        intent.putExtra("url", "http://test.com/t.zip");
        intent.putExtra("receiver", mDownloadReceiver);
        startService(intent);
        updateProgressBar();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:21:54.030

我强烈建议您阅读有关[Painless Threading](http://android-developers.blogspot.com/2009/05/painless-threading.html)的 Android 开发人员博客文章。正如它所说，从另一个线程更新 UI 的最简单方法是使用[Activity.runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)。

# regex - 捕获第一个“和最后一个”之间的所有内容

> ID：15305574
> 
> 赞同：-1
> 
> 时间：2013-03-09T00:15:31.870
> 
> 标签：regex, perl

我正在寻找一个正则表达式，它捕获字符串的第一个“和最后一个”之间的所有内容，而不是可能包含更多的“。

```
$a='"xyz"kljhkljh"lkjhlkj"';
@b=$a=~ m/^"(.*)"$/m; 
```

好像不行？行尾没有\n。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-09T00:22:46.193

你的不工作的原因是你试图限制第一个引号出现在字符串的开头或紧随其中任何地方的换行符之后，最后一个引号出现在字符串的末尾或紧接之前任何地方的换行符。

这不是您的数据包含的内容。不要让这变得比它需要的更难。

如果您想要第一个双引号和最后一个双引号之间的所有内容，包括其他引号，那么您想要

```
($content)  = $string =~ /"(.*)"/sx; 
```

如果你想要很多，并且里面没有双引号，你想要：

```
(@contents) = $string =~ /"([^"]*)"/gx; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T01:13:09.483

在您对 tchrist 的回答的第二条评论中，您说第一个和最后一个引号应该在字符串的开头和结尾？如果是这种情况，您甚至根本不需要正则表达式，只需将整个字符串减去第一个和最后一个字符：

```
 substr($a, 1, -1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T01:05:52.417

出于某种原因，我无法添加评论，所以我正在创建一个答案来回答 bootware 对 tchrist 答案的评论。`($content)=$string=~/"(.*)"/sx`和之间的区别在于`$content=$string=~/"(.*)"/sx`前者在列表上下文中匹配，而后者在标量上下文中匹配。在标量上下文中，结果只是一个 1 或 0，指示字符串是否与正则表达式匹配。在列表上下文中，为匹配正则表达式的每个括号部分的子字符串返回一个列表，从左到右的顺序。在这种情况下，正则表达式中有一组括号，因此返回的列表有一个元素，即引号内的字符串部分。

奖励：您可以使用 $1, $2, ... 引用每组括号中匹配的子字符串

# android - 果冻豆数字时钟

> ID：15305575
> 
> 赞同：0
> 
> 时间：2013-03-09T00:15:41.543
> 
> 标签：android, android-layout, android-widget

我想制作一个像果冻豆一样的时钟（小时为粗体，分钟为正常），如下图所示： ![在此处输入图像描述](../Images/b2a2619ec93395e92bab423c6187930a.png)

我从 Android openSource 下载了 EditClock 小部件，时钟工作，但我无法使用此代码使“粗体”工作：使用 Jelly Bean 字体的[EditClock 源代码。](https://android.googlesource.com/platform/frameworks/base/+/android-4.2_r1/core/java/com/android/internal/widget/DigitalClock.java)这是我布局的一部分

```
<com.myApp.views.DigitalClock
        android:id="@+id/digitalClock1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/musicDashboard"
        android:layout_centerHorizontal="true" >

         <TextView android:id="@+id/timeDisplayBackground"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:singleLine="true"
            android:textColor="#ffffffff"
            android:textSize="@dimen/clock_text_size"

            android:textAppearance="?android:attr/textAppearanceMedium"
           android:layout_marginBottom="6dip"
            android:ellipsize="none"
            />

        <TextView android:id="@+id/timeDisplayForeground"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:singleLine="true"
            android:ellipsize="none"
             android:textStyle="bold"
            android:textColor="#ffffffff"
            android:layout_alignStart="@+id/timeDisplayBackground"
             android:textAppearance="?android:attr/textAppearanceMedium"
            android:layout_alignTop="@+id/timeDisplayBackground"
            android:layout_marginBottom="6dip"
            android:textSize="@dimen/clock_text_size"
            />
    </com.myApp.views.DigitalClock> 
```

我怎样才能使这项工作？在姜饼和向上？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:37:25.013

您可以修改 DigitalClock 小部件的代码以在文本的第一部分周围添加一个 Span。在方法中尝试此代码`updateTime()`：

```
CharSequence newTime = DateFormat.format(mFormat, mCalendar);
SpannableString spannable = new SpannableString(newTime);
int endIndex = spannable.indexOf(':');
spannable.setSpan(new StylePan(Typeface.BOLD), 0, endIndex, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
mTimeDisplayBackground.setText(spannable);
mTimeDisplayForeground.setText(spannable);
mAmPm.setIsMorning(mCalendar.get(Calendar.AM_PM) == 0); 
```

# jquery - jQuery：随机定位的 div

> ID：15305580
> 
> 赞同：0
> 
> 时间：2013-03-09T00:16:28.873
> 
> 标签：jquery, html, css, positioning

我希望在页面周围随机放置整个加载的 div（最终将包含图像），包含在 100% 内。问题是我不希望 div 重叠，而且所有 div 的大小都取决于图像。
我目前拥有的方法
：（这里也是 jsfiddle [http://jsfiddle.net/2z4rK/](http://jsfiddle.net/2z4rK/)）

```
 function randomFromTo(from, to){
            return Math.floor(Math.random() * (to - from + 1) + from);
        }

        function moveRandom() {
            var cPos = $('#block-container').offset();
            var cHeight = $('#block-container').height();
            var cWidth = $('#block-container').width();

            var pad = parseInt($('#block-container').css('padding-top').replace('px', ''));

            var bHeight = $('.block').height();
            var bWidth = $('.block').width();

            maxY = cPos.top + cHeight - bHeight - pad;
            maxX = cPos.left + cWidth - bWidth - pad;

            minY = cPos.top + pad;
            minX = cPos.left + pad;

      $('.block').each(function() {

              newY = randomFromTo(minY, maxY);
              newX = randomFromTo(minX, maxX);

        $(this).animate({
                  top: newY,
                  left: newX
                  }, 500, function() {
              });
      });
        }

moveRandom(); 
```

这没关系，但是 div 重叠，而且似乎它们都必须是相同的大小。div 将由客户端动态添加，因此我需要使其完全自给自足，这是我认为当前方法失败的地方。有没有办法随机定位div？
我正在努力实现的一个很好的例子：http: [//www.jormamueller.com](http://www.jormamueller.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:25:45.883

我不会给你写代码，只是给你一个大纲：

*   为每个矩形的左上角和右下角创建坐标（将它们存储在数组或对象中），并将它们添加到坐标数组中。

*   在新矩形的每一代中，检查其四个角的坐标是否大于其他任何矩形的左上角*并且*是否小于其他矩形的右下角（因此检查是否有任何角位于任何其他矩形）。

*   如果不是，则为矩形生成新的随机坐标。

如果我不清楚，您可以发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:48:35.593

您链接的网站使用以下技术：

*   有一个网格容器`div`，它有`width`浏览器窗口，也有`relative position`.
*   对于每个图像，都有一个`div`带有`absolute position`. 每个`div`人都有`full width`一个`random left`职位。`top`每个属性`div`是所有前 div 高度的总和。

* * *

如果我是你，我会使用标签创建一个像带有空单元格的表格的表格，`div`然后我会在这些单元格中随机放置图像。

这可以通过将所有图像源和细节放在一个数组中并将所有单元格 ID 放在另一个数组中来实现；然后你可以打乱两个数组并将一个图像分配给一个随机单元格。

# ios - 你如何在 iOS UIMapkit 中设置初始大小

> ID：15305582
> 
> 赞同：1
> 
> 时间：2013-03-09T00:16:51.417
> 
> 标签：ios, core-location

我希望我的 mapView 以初始大小（我确定的缩放级别）显示，手机位置在地图中居中。完成此操作后，我希望用户能够更改缩放级别并平移到他们心中的内容。下次他们进入应用程序时，我想像上次一样重新初始化地图。

问题是当我进来时，它似乎在获得有效的位置修复之前设置了地图大小。

任何人都可以指出一个最佳实践初始化的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:23:26.090

我用下一个方法解决这个问题。我认为代码是不言自明的

```
 - (void)mapView:(MKMapView *)mapView 
didUpdateUserLocation:(MKUserLocation *)userLocation
{
    if (!_userLocated && 
        userLocation.coordinate.latitude != 0.0 && 
        userLocation.coordinate.longitude != 0.0)
    {
        MKCoordinateRegion mapRegion;
        mapRegion.center = mapView.userLocation.coordinate;
        mapRegion.span = MKCoordinateSpanMake(0.04, 0.04);
        [mapView setRegion:mapRegion animated: YES];
        _userLocated = YES;
    }
} 
```

并且不要忘记设置`UIMapView`委托和`Shows user location`.

# devise - 将设计闪存消息从通知更改为错误

> ID：15305586
> 
> 赞同：2
> 
> 时间：2013-03-09T00:17:36.753
> 
> 标签：devise, ruby-on-rails-3.2

我知道您可以覆盖默认的设计控制器，我为注册和会话控制器这样做了。我知道您还可以在语言环境下更改设计中 Flash 消息的文本。但是，当用户名和密码的组合无效时，我不确定如何更改为会话控制器显示的 Flash 消息的类型。

创建方法看起来像

```
def create
  self.resource = warden.authenticate!(auth_options)
  set_flash_message(:notice, :signed_in) if is_navigational_format?
  sign_in(resource_name, resource)
  respond_with resource, :location => after_sign_in_path_for(resource)
end 
```

我怀疑验证是在后续通话期间完成的

```
warden.authenticate!(auth_options) 
```

但这是我不确定如何在我的应用程序中覆盖它的地方。

此外，我认为对于更改 Flash 通知颜色这样一个简单的用例来说，这是一个复杂的覆盖。

任何见解将不胜感激。

谢谢！缺口

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T17:06:29.633

您可以使用自定义故障应用程序来做到这一点。如您所见，此闪存消息正在[此处](https://github.com/plataformatec/devise/blob/v2.2.3/lib/devise/failure_app.rb#L50)设置，因此您可以在自定义故障应用程序中更改它。

所以一开始你从 Devise 的那个继承你的失败应用程序：

```
class CustomFailure < Devise::FailureApp
  def recall
    env["PATH_INFO"]  = attempted_path
    flash.now[:error] = i18n_message(:invalid)
    self.response = recall_app(warden_options[:recall]).call(env)
  end
end 
```

将此文件放在您的应用程序中的某个位置，然后说设计以像这样使用它（`config/initializers/devise.rb`）：

```
config.warden do |manager|
  manager.failure_app = CustomFailure
end 
```

# git - 在不提交的情况下丢弃所有非分阶段的更改？

> ID：15305588
> 
> 赞同：0
> 
> 时间：2013-03-09T00:17:52.307
> 
> 标签：git

有没有一种简单的方法可以在不先提交后者的情况下丢弃所有尚未暂存的更改？

例如，假设这`A`是一个跟踪文件，如

```
% git init -q
% echo "state 1" > A
% git add A && git commit -q -m 'initial commit'
% cat A
state 1 
```

下一个修改`A`，并将其分阶段：

```
% echo "state 2" > A
% git add A
% cat A
state 2 
```

最后，修改`A`了第三次，但这一次`A`仍然是未分级的：

```
% echo "state 3" > A
% cat A
state 3 
```

怎样才能恢复`A`到它的*阶段*状态，即**状态 2**。

编辑：我已经稍微改变了代码序列，希望现在更清晰。在发布问题后，我还发布了一个解决方案。这个解决方案让我觉得很迂回（必须有更直接的东西），但至少它清楚地显示了我想要`A`结束的状态，无论是在工作目录中还是在索引中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:26:06.350

假设这是您的工作流程：

1.  你提交了一个文件
2.  你做了一些改变并上演了它
3.  您进行了更多更改，但您希望恢复到第 2 步中的分阶段更改的版本。

你只需要运行`git checkout -- A`. 这将消除任何未暂存的更改，但会在第 2 步结束时保留更改。

看一下这个示例工作流，它将清除一切：

A的内容只是`version1`

```
$ echo "version1" > A 
```

提交更改 $ git add A && git commit -q -m 'initial commit'

```
$ git log
commit 4fd90642df048ca4beeb29c65c5f7a436e83055a
Author: Tuxdude <foo@bar>
Date:   Fri Mar 8 16:28:36 2013 -0800

    initial commit 
```

A的内容是现在`version2`

```
$ echo "version2" > A

$ cat A
version2 
```

暂存文件更改

```
$ git add A 
```

检查当前的 git 状态

```
$ git status
# On branch master
# Your branch is ahead of 'origin/master' by 1 commit.
#
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   modified:   A
# 
```

再做一些改变`A`

```
$ echo "version3" > A

$ cat A
version3 
```

现在你决定，你想摆脱 `A. 您只需要从 git 的缓存中检出文件，即暂存区。

```
$ git checkout -- A

$ cat A
version2 
```

您可以`git status`再次运行，它会让您知道分阶段的更改。

```
$ git status
# On branch master
# Your branch is ahead of 'origin/master' by 1 commit.
#
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   modified:   A
# 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:18:51.080

你只需要做

```
git checkout -- . 
```

如果要还原单个文件，请执行

```
git checkout -- myfile 
```

如果文件已被添加，您必须通过执行取消暂存它

```
git reset HEAD myfile 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:36:51.940

我想到了一个可能的答案来回答我的问题。它不是特别优雅，我不知道它是否有任何潜在的陷阱，但至少它清楚地显示了我想要`A`结束的状态。希望有人会知道一条不那么迂回的路线。

在原始问题中给出的顺序之后，执行以下操作：

```
% git stash -q -k
% git stash drop -q
% cat A
state 2 
```

# php - 我究竟做错了什么？在表单中编辑表格数据

> ID：15305593
> 
> 赞同：0
> 
> 时间：2013-03-09T00:18:33.630
> 
> 标签：php, database, forms, html-table, edit

我有一个表格，每行都有一个编辑链接和一个删除按钮。删除按钮工作正常，但编辑链接我不知道我做错了什么！

单击特定行的编辑链接会导致带有表单的编辑页面，但未填写数据。没有错误消息...我可以在 URL 字段中看到它是所选电影的正确 ID。

我错过了什么？我是否还需要在编辑页面上写任何查询等？我确实尝试将其设置为需要页面，因此当单击编辑按钮时，编辑表单会在索引页面上弹出。但我无法做到这一点。

我知道我使用的是过时的 mysql 函数，但我还没有添加 SQL 保护。

**该数据库称为moviedata，有2 个表。**

*   表一称为：电影
    *   字段/列 (5): **id** (primary key, AI), ****title** , **release_year** ,** ****genre_id**, **director****
*   表2称为：类别
    *   字段/列（2）：**genre_id**（主键，AI），**genre**

在genre_id（主键，表2）和genre_id（表1）之间存在关系（外键）。

**index.php 代码**

```
<!DOCTYPE html>

<html>

<head>

<title>My movie library</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="mall.css" />

</head>

<body>
<?php 

    require 'connect.inc.php';

    if (isset($_POST['delete']) && isset($_POST['id'])) {
        $id = $_POST['id'];
        $query = "DELETE FROM movies WHERE id=".$id." LIMIT 1";

        if (!mysql_query($query, $sql))
            echo "DELETE failed: $query<br>".
            mysql_error() . "<br><br>";
    }

    $query = "SELECT * FROM movies m INNER JOIN categories c ON m.genre_id = c.genre_id";
    $result = mysql_query($query);

    if (!$result) die ("Database access failed:" .mysql_error()) ;
    $rows = mysql_num_rows($result);

    echo '<table><tr><th>Title</th><th>Release year</th><th>Genre</th><th>Director</th><th>Update</th><th>Delete</th></tr>';

    while ($row = mysql_fetch_assoc($result)) {
    echo '<tr><td>' .$row["title"] . '</td>' ;
    echo '<td>' .$row["release_year"] . '</td>' ;
    echo '<td>' .$row["genre_id"] . '</td>' ;
    echo '<td>' .$row["director"] . '</td>' ;
    echo '<td>'."<a href='edit_movie.php?edit=" . $row["id"] . "'>Edit</a>".'</td>';
    echo '<td><form action="index.php" method="POST">
                <input type="hidden" name="delete" value="yes" />
                <input type="hidden" name="id" value="'. $row["id"] .'" /> 
                <input type="submit" value="Delete" /></form>
                </td></tr>' ;
    }
    echo '</table>'; 

?>

</body>

</html> 
```

**这是edit_movie.php页面上的代码。带有表单的编辑页面：**

```
<!DOCTYPE html>

<html>

<head>

<title>My movie library</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="mall.css" />

</head>

<body>

<?php

require 'connect.inc.php';

//close MySQL
mysql_close($sql);

?>

<p>Edit movie</p>
<div id="form_column">
<form action="edit_movie.php" method="post">
<input type="hidden" name="id" value="<?php if (isset($row["id"])) ?>" /> <br>
Title:<br> <input type="text" name="title" value="<?php if (isset($row["title"])) { echo $row["title"];} ?>" /> <br>
Release Year:<br> <input type="text" name="release_year" value="<?php if (isset($row["release_year"])) { echo $row["release_year"];} ?>" /> <br>
Director:<br> <input type="text" name="director" value="<?php if (isset($row["director"])) { echo $row["director"];} ?>" /> <br><br>
Select genre:
<br>
<br> <input type="radio" name="genre_id" value="1" checked />Action<br>
<br> <input type="radio" name="genre_id" value="2" />Comedy<br>
<br> <input type="radio" name="genre_id" value="3" />Drama<br>
<br> <input type="radio" name="genre_id" value="4" />Horror<br>
<br> <input type="radio" name="genre_id" value="5" />Romance<br>
<br> <input type="radio" name="genre_id" value="6" />Thriller<br><br>
<input type="submit" />
</form>
</div>

</body>

</html> 
```

**数据库连接位于单独的 connect.inc.php 文件中，这些文件的顶部需要该文件。您可以在下面看到 connect.inc.php 文件中的代码：**

```
<?php

//connect to MySQL
$servername = "localhost";
$username = "root";
$password = "";
$sql = mysql_connect($servername,$username,$password);
mysql_connect($servername,$username,$password);
//select database
mysql_select_db("moviedata");

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T04:55:54.280

好吧，你的代码有点乱，因为**它甚至不是程序性的**。**你在给自己制造麻烦。真的。**

在使用 PHP 开发应用程序时，您必须记住以下几点：

## 从不打印/回显 html 标签

. 尽量避免这种情况，因为这会使您的代码难以维护和阅读。请改用替代语法。

也就是说，PHP 本身应该用作**模板引擎**，而不是“生成”模板引擎。

## 职责分离。清楚而明智地

连接到数据库的函数不应在演示文稿中使用（在本例中为 HTML）。您将创建一个负责数据库的文件，另一个负责数据操作（例如 DELETE、CREATE、UPDATE 操作）等的文件。

## 不要忘记 SQL 注入和 XSS

永远不要相信您从超全局变量（如`$_GET`、`$_POST`和. 至少，应该用于您要处理的每个动态输入。`$_COOKIE``$_REQUEST``mysql_real_escape_string()`

一般来说，[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)允许通过上述超全局变量执行任何 JavaScript 代码，以及在通用标记中注入另一个 html 代码。为了防止这种情况，这里基本上`htmlentities()`就够了。

## 把东西包装成一个函数

因此，与其这样做，

```
if (isset($_POST['delete']) && isset($_POST['id'])) {
    $id = $_POST['id'];
    $query = "DELETE FROM movies WHERE id=".$id." LIMIT 1"; 
```

你应该像这样重写它：

```
function delete_movie_by_id($id){
   return mysql_unbuffered_query(sprintf("DELETE FROM `movies` WHERE id='%s' LIMIT 1", mysql_real_escape_string($id)));
}

if ( isset($_POST['delete'], $_POST['id']) ){

   delete_movie_by_id($_POST['id']); // it's safe & readable now
} 
```

## 了解 OOP 并切换到 PDO

好吧，当您开发这样的东西时，程序代码不是要走的路。下次你要写东西的时候，你真的会开始同时使用 PDO 进行数据库访问和 OOP。

* * *

**我可以继续，但最好现在停下来，转回你原来的问题。**

好吧，你没有说你到底得到了哪个错误。例如，您是否知道如果`mysql_select()`返回 FALSE（=== 数据库选择失败），这不会终止脚本！？根据您发布的代码，您不会以任何方式“跟踪它”。

**第一的**

所以，connect.inc.php 应该是这样的：

```
error_reporting(E_ALL); // <-- Important!

$servername = "localhost";
$username = "root";
$password = "";

if ( ! mysql_connect($servername,$username,$password) ){
   die(sprintf('Cannot connect to MySQL server because of "%s"', mysql_error()));
}

//select database
if ( ! mysql_select_db("moviedata") ){
  die(sprintf('Cannot select a database, because of "%s"', mysql_error()))
} 
```

**第二**

在edit_movie.php 页面中，此代码块根本不需要。当脚本终止时，连接将自动关闭。

所以只需删除这个：

```
<?php

require 'connect.inc.php';

//close MySQL
mysql_close($sql); 
```

**第三**

在那`edit_movie.php`，你清楚地问：`if ( isset($row['some_column']) )...`但它到底是怎么回事？本身在哪里`$row`？它没有在任何地方定义，所以你不会得到你所期望的。这里：

```
<input type="hidden" name="id" value="<?php if (isset($row["id"])) ?>" /> <br>
Title:<br> <input type="text" name="title" value="<?php if (isset($row["title"])) { echo $row["title"];} ?>" /> <br>
Release Year:<br> <input type="text" name="release_year" value="<?php if (isset($row["release_year"])) { echo $row["release_year"];} ?>" /> <br>
Director:<br> <input type="text" name="director" value="<?php if (isset($row["director"])) { echo $row["director"];} ?>" /> <br><br> 
```

好的，这就够了。

考虑一下，像这样重写您的应用程序：

文件：`movie.inc.php`

```
require_once('connect.inc.php');

/**
 * Fetch all movies from a table
 * @return array on success, FALSE on failure
 */
function get_all_movies(){

   $query = "SELECT * FROM movies m INNER JOIN categories c ON m.genre_id = c.genre_id";

   $result = mysql_query($query);

   if ( ! $result ){ 
     return false;
   } else {
     $return = array();

     while ($row = mysql_fetch_assoc($result)){

        $return[] = array('director' => $row['director'], 'genre_id' => $row['genre_id'], 'release_year' => $row['release_year'], 'title' => $row['title'], 'id' => $row['id']); 
     }
       return $return;
   }
}

function delete_movie_by_id($id){
  // I already wrote this, see above
} 
```

文件`index.php`

```
<?php

require('movie.inc.php');

if ( isset($_GET['delete']) && isset($_GET['id']) ){
   if ( delete_movie_by_id($_POST['id']) ){ //it's 100% safe
       die('Movie has been removed. Refresh the page now'); // or the like
   } else {
      // could not - handle here
   }
}

?>
<!DOCTYPE html>
<html>
<head>

<title>My movie library</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="mall.css" />

</head>
<body>

<table>
 <tr>
  <th>Title</th>
  <th>Release year</th>
  <th>Genre</th><th>Director</th>
  <th>Update</th>
  <th>Delete</th>
 </tr>

  <?php  foreach (get_all_movies() as $index => $row) : ?>
   <tr>
     <td><?php echo $row['title'];?></td>
     <td><?php echo $row['release_year']; ?></td>
     <td><?php echo $row['genre_id'];?></td>
     <td><?php echo $row['director'];?></td>
     <td><a href='<?php printf('edit_movie.php?edit=%s', $row['id']);?>>Edit</a></td>
     <td>
      <form action="index.php" method="GET">
              <input type="hidden" name="delete" value="yes" />
              <input type="hidden" name="id" value="<?php echo $row['id'];?>" /> 
              <input type="submit" value="Delete" />
      </form>
      </td>
    </tr>
    <?php endforeach; ?>
    </table>

</body>
</html> 
```

我现在累了，希望你能从这个答案中得到核心思想。

* * *

**更新**

制作电影“可编辑”的基本步骤：

1）您获取要编辑的数据（从表中）
2）您将编辑后的数据发送回服务器（php 脚本）
3）您验证输入
4）您运行`UPDATE`查询

就这样。

所以它会类似于这个（文件：**edit_movie.php**）：

```
<?php

require_once('movie.inc.php');

/**
 * Grabs the movie data by its id
 * 
 * @param $id A movie id 
 * @return array on succes, FALSE if $id is wrong
 */
function get_movie_by_id($id){

   $query = sprintf("SELECT * FROM `enter_movie_table_name_here` WHERE `id` = '%s' LIMIT 1", mysql_real_escape_string($id));

   $result = mysql_query($query);

   if ( ! $result ){
       return false;
   } else {
       return $result;
   }
}

function update_movie_by_id($id, array $data){

    $query = sprintf("UPDATE `the_movie_table` 
              SET `director` ='%s',
                  `genre_id` = '%s',
                  `relase_year` ='%s',
                  `title` = '%s' WHERE `id` = '%s' LIMIT 1"),

                   mysql_real_escape_string($data['director']),
                   mysql_real_escape_string($data['genre_id']),
                   mysql_real_escape_string($data['relase_year']),
                   mysql_real_escape_string($data['title']),
                   mysql_real_escape_string($id) );

    // not mysql_query() !!! but this
    return mysql_unbuffered_query($query); 
}

// Next thing is to get an id by query string,
// So if it was /movide_edit.php?id=1
// then id we have is 1

// So we need to handle that right now

if ( isset($_GET['id']) ){

   $movie = get_movie_by_id($_GET['id']);

   if ( ! $movie ){ // <- make sure that id isn't fake
      die(sprintf('Invalid movie id "%s"', $_GET['id']));
   }

} else {

   die('Please supply an id you want to edit'); // <- this makes sence
}

// Ok, we'll reserve this block for an update

if ( !empty($_POST) ){ // This will run when user clicked on Save button

      if ( update_movie_by_id($_POST['id'], array(

              'director' => $_POST['director'],
              'genre_id' => $_POST['genre_id'],
              'relase_year' => $_POST['relase_year'],
              'title'       => $_POST['title']

         )) ){

             die('Movie has been updated');
         } else {

          die('Could not update a movie for some wicked reason..');
         }

}

// That's all. Now it can:

//1) Fetch the data
//2) Edit accordingly 

?>
<!DOCTYPE html>
<html>

<!--

This is kinda quick and dirty form
You need to fix this later

-->

<body>

  <form method="POST">

     <label for="title">Title</label>
     <input type="text" name="title" value="<?php echo $movie['title']; " />

     <!--
           Add another elements this way..
      -->

    <button type="submit">Save</button>  

  </form>
</body>
</html> 
```

# php - 来自表单的值没有被传递 php html mysqli

> ID：15305595
> 
> 赞同：0
> 
> 时间：2013-03-09T00:18:43.937
> 
> 标签：php, html, forms, mysqli

我无法弄清楚为什么我的值没有从表单中传递。我无法发现错误。

表格代码：

```
$table = $_POST['table'];
$id = $_POST['id'];
$count = 0;    
$query = "SELECT * FROM `" . $table . "` WHERE id = " . $id;
        $result1 = mysqli_query($link, $query);     
        echo '<center><table style="text-align:center">';
        echo '<form action="edit-process.php" method="post">';
        while($row = mysqli_fetch_assoc($result1)){
            foreach($row as $key => $val){
                if ($count > 0){
                    echo "<tr>";
                    echo "<td>" . $key . "</td>";
                        echo '<td><input type="text" name="' . $key . '" value="' . $val . '"></td>';
                    echo "</tr>";
                    $count++;
                }
                else $count++;
            }
        }
        echo '<input type="hidden" name="table" value="' . $table . '" />';
        echo '<input type="hidden" name="id" value="' . $id . '" />';
        echo '<tr><td><input type="submit" value="Save Changes" /></td></tr>';
        echo "</form>";
        echo "</table>"; 
```

php文件：

```
$table = $_POST['table'];
$id = $_POST['id'];
$count1 = 0;
$count2 = 0;

$result = mysqli_query($link, "SHOW COLUMNS FROM `" . $table . "`");
    if (mysqli_num_rows($result) > 0) {
        while ($row = mysqli_fetch_assoc($result)) {
            $keyNames[$count2] = $row['Field'];
        $count2++;
        }
    }

while ($count1 < $count2){
    if ($count1 > 0) {
    $value = mysqli_real_escape_string($_POST[$keyNames[$count1]]);
    $query2 = "UPDATE `" . $table . "` SET `" . $keyNames[$count1] . "` = '" . $value . "' WHERE id = " . $id;
    echo $query2 . "<br>";
    $result2 = mysqli_query($link, $query2);
    $count1++;
}
else $count1++; 
```

}

我避免显示所有计数的 id 列。回显查询的输出是：

有任何想法吗？

**编辑** 一旦我弄清楚这个问题，我会负责将所有内容更改为程序样式。如果我摆脱 mysqli_real_escape_string，它会传递所有数据，除了那些带有空格的列。我以为这就是反引号的用途？我还能做些什么来让两个单词的列像一个单词一样传递数据吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T00:26:45.727

您需要切换这些行 -

```
echo '<center><table style="text-align:center">';
echo '<form action="edit-process.php" method="post">';
....
echo "</form>";
echo "</table>"; 
```

到

```
echo '<form action="edit-process.php" method="post">';
echo '<center><table style="text-align:center">';
....
echo "</table>";
echo "</form>"; 
```

里面`<form>`是`<table>`无效的代码。它要么需要包装，`<table>`要么在里面`<td></td>`。

另见 -
[表格内表格](https://stackoverflow.com/questions/11138560/form-inside-table)
[表格内表格](https://stackoverflow.com/questions/5967564/form-inside-a-table)

* * *

更新 #1-
在您的**编辑**
空间`<input name="">`中将被替换为，`_`因此您的`$_POST[]`姓名将与您的`<input name="">`. 从手册 - h​​ttp: [//www.php.net/manual/en/language.variables.external.php](http://www.php.net/manual/en/language.variables.external.php)

> **注意：**
> 变量名中的点和空格会转换为下划线。例如**`<input name="a.b" />`**变成**$_REQUEST["a_b"]**。

另请参阅 -
[PHP 中的 <input> 元素是否可以包含大写字母和空格](https://stackoverflow.com/questions/11221879/can-input-elements-have-capital-letters-and-spaces-in-php#11222084)

# actionscript-3 - Flex 4.6 绑定到 Spark GridColumn 宽度

> ID：15305597
> 
> 赞同：0
> 
> 时间：2013-03-09T00:18:55.220
> 
> 标签：actionscript-3, apache-flex, data-binding, flex4.5

我知道 Flex 漏洞百出，它需要很多技巧才能使其正常工作，但我认为我正走在正确的道路上。我将描述我正在尝试实施的问题和解决方案，希望您能指出我正确的道路。

我正在尝试做的是将 Spark DataGrid 列的宽度绑定到 Spark 标签的宽度，这是第一个洞： GridColumn 有一个绑定属性“width”，但在对象创建完成后它还没有准备好，它是仅在用户交互后发布。所以我想出了第一个技巧：一个从 DataGrid 本身提取列宽的函数，它绑定到在创建列或更改列大小时触发的事件，它可以工作：

```
[Bindable(event="creationComplete")]
[Bindable(event="columnStretch")]
[Bindable(event="propertyChange")]
public function columnWidth(grid:DataGrid, column:GridColumn):int {
    if(isNaN(column.width)){
        if(column.grid){
            return column.grid.getColumnWidth(grid.columns.getItemIndex(column));
        }
    }
    return column.width;
} 
```

它可以在创建时检索宽度，但是当我用光标设置列的宽度时它不起作用，因为任何可绑定属性都有效，所以事情是这样的：如果我这样设置标签的宽度：宽度在用户交互后更改，但在网格创建完成后不会更改。如果我在网格完成后设置宽度并更改宽度，但它不会对用户交互做出反应......

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T22:24:33.887

看起来我不久前遇到了同样的问题。并修复它：以下方法对我来说效果很好。假设您有一个根据列宽调整标签大小的函数：

```
protected function layoutTextInputs():void {
    var numCols:int = dataGrid.columns.length;
    var w:Number = 0;

    for (var i:int=1; i<numCols; i++) {
        var header:Rectangle = dataGrid.columnHeaderGroup.getHeaderBounds(i);
        var textInput:IVisualElement = textInputs.getElementAt(i - 1);

        textInput.left = header.x;
        textInput.width = header.width;
    }
} 
```

在此示例`textInputs`中`Group`，每列都包含一个 TextInput，它正好位于该列的上方并且宽度相同。

现在你想在每次用户调整列大小时调用这个函数，所以你这样做：

```
dataGrid.columnHeaderGroup.addEventListener(
    GridEvent.SEPARATOR_MOUSE_DRAG, onHeaderResize);
dataGrid.columnHeaderGroup.addEventListener(
    GridEvent.SEPARATOR_MOUSE_UP, onHeaderResize);

private function onHeaderResize(event:GridEvent):void {
    layoutTextInputs();
} 
```

但不幸的是，这不会在初始化时执行该方法，也不会在以任何其他方式改变列宽的方式重绘屏幕时，而不是通过用户交互。幸运的是，这很容易解决：

```
override protected function updateDisplayList(
    unscaledWidth:Number, unscaledHeight:Number):void 
{
    super.updateDisplayList(unscaledWidth, unscaledHeight);
    layoutTextInputs();
} 
```

* * *

**编辑**：关于 Flex 中“漏洞”的注释。

GridColumn 不是可视组件。它是一个表示模型，指示网格布局如何呈现其（实际）列。因此，您必须将其`width`属性解释为这样的指令，而不是列宽的实际值。
默认情况下，列的宽度取决于其内容和可用空间。该`width`属性指示网格布局改为使用自定义数量的像素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T12:16:44.740

我正在使用`mx:AdvancedDataGrid`. 我只是为数据网格列分配一个 ID。我`inputText`根据要求绑定了列宽属性。这个对我有用...

例如：

```
<s:textInput width="{myDatagridColumnID.width - 10}" /> 
```

我正在使用 Flash Builder 4.6。

# paypal - PalPAL 沙盒 IPN 处理器拒绝所有消息？

> ID：15305598
> 
> 赞同：1
> 
> 时间：2013-03-09T00:18:56.767
> 
> 标签：paypal, paypal-ipn

我整天都在使用 PalPal IPN 模拟器，没有任何问题，但在某些时候我被踢了出去，开发者门户也得到了升级。

从我离开的地方开始，我现在从沙箱接收 IPN 消息，但尝试验证消息返回 400 Bad Request。

现在，在您说“哦，您只需要执行 HTTP/1.1 并发送主机：”字段之前，我已经在这样做了（并且已经这样做了几个月）。

请求正文：

POST /cgi-bin/webscr HTTP/1.1 主机：www.sandbox.paypal.com 内容类型：application/x-www-form-urlencoded 内容长度：1008 连接：关闭

回复正文：

HTTP/1.1 400 Bad Request Date: Sat, 09 Mar 2013 00:07:26 GMT Server: Apache X-Frame-Options: SAMEORIGIN Set-Cookie: c9MWDuvPtT9GIMyPc3jwol1VSlO=%7chl7gnTEYtJzNIfLXr3W6GtWjMBrl6ln8aFetxEss8pSDsWPDwv59RMYj7ONKH0013betZW%7cnf1wC_g4C0pER3V0XtOw2969OSDVwC24TgW3akpoK6QHdkz0_7G0YdJ9Cnjz-JKZbESVG0%7c; 域=.paypal.com；路径=/; 安全的; HttpOnly Set-Cookie: cookie_check=yes; 过期=星期二，2023 年 3 月 7 日 00:07:26 GMT；域=.paypal.com；路径=/; 安全的; HttpOnly Set-Cookie: Apache=10.72.109.11.1362787646017906; 路径=/; expires=Mon, 02-Mar-43 00:07:26 GMT Connection: close Transfer-Encoding: chunked Content-Type: text/plain; 字符集=ISO-8859-1

只是我，还是门户坏了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:28:51.810

你是对的。目前在沙盒中验证 IPN 的能力已被破坏。我们目前正在努力解决这个问题，一旦我们有更新，我一定会更新你。

如果您在开发人员/沙盒环境中遇到任何其他问题，请告诉我，我一定会跟进。

# c++ - SetWindowshookEx 有时在 dll 注入后无法正常工作

> ID：15305605
> 
> 赞同：1
> 
> 时间：2013-03-09T00:20:08.610
> 
> 标签：c++, visual-studio, winapi, keyboard-hook, dll-injection

我正在使用这个库[http://code.google.com/p/injex/](http://code.google.com/p/injex/)来注入一个包含键盘钩子函数的 dll。dll 很简单，只需创建一个线程并使用“setWindowsHookEx”函数即可。

注入总是成功的，但键盘钩子并不适用于所有情况。

1.  我编写了一个简单的“hello world”win32 应用程序，并使用 injex.exe 将键盘挂钩 dll 注入其中。一切都按预期工作。

2.  如果我选择一个复杂的程序来注入（一个用delphi写的游戏），dll注入成功（可以看到注入的主窗体），但是没有勾上键盘。

所以我的问题是：

1.  键盘钩子失败是因为注入方法，还是键盘钩子功能？

2.  是否可以注入dll，但不能保证其功能？

所以欢迎任何建议。

这是dll代码：

```
// dllmain.cpp : Defines the entry point for the DLL application.
#include "stdafx.h"

#include <Windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <tchar.h>

//GUI==============================================================================
#define MYMENU_EXIT         (WM_APP + 101)
#define MYMENU_MESSAGEBOX   (WM_APP + 102) 

HINSTANCE  inj_hModule;          //Injected Modules Handle
HWND       prnt_hWnd;            //Parent Window Handle

//WndProc for the new window
LRESULT CALLBACK DLLWindowProc (HWND, UINT, WPARAM, LPARAM);

//Register our windows Class
BOOL RegisterDLLWindowClass(wchar_t szClassName[])
{
    WNDCLASSEX wc;
    wc.hInstance =  inj_hModule;
    wc.lpszClassName = (LPCWSTR)L"InjectedDLLWindowClass";
    wc.lpszClassName = (LPCWSTR)szClassName;
    wc.lpfnWndProc = DLLWindowProc;
    wc.style = CS_DBLCLKS;
    wc.cbSize = sizeof (WNDCLASSEX);
    wc.hIcon = LoadIcon (NULL, IDI_APPLICATION);
    wc.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
    wc.hCursor = LoadCursor (NULL, IDC_ARROW);
    wc.lpszMenuName = NULL;
    wc.cbClsExtra = 0;
    wc.cbWndExtra = 0;
    wc.hbrBackground = (HBRUSH) COLOR_BACKGROUND;
    if (!RegisterClassEx (&wc))
        return 0;
}
//Creating our windows Menu
HMENU CreateDLLWindowMenu()
{
    HMENU hMenu;
    hMenu = CreateMenu();
    HMENU hMenuPopup;
    if(hMenu==NULL)
        return FALSE;
    hMenuPopup = CreatePopupMenu();
    AppendMenu (hMenuPopup, MF_STRING, MYMENU_EXIT, TEXT("Exit"));
    AppendMenu (hMenu, MF_POPUP, (UINT_PTR) hMenuPopup, TEXT("File")); 

    hMenuPopup = CreatePopupMenu();
    AppendMenu (hMenuPopup, MF_STRING,MYMENU_MESSAGEBOX, TEXT("MessageBox")); 
    AppendMenu (hMenu, MF_POPUP, (UINT_PTR) hMenuPopup, TEXT("Test")); 
    return hMenu;
}

//Our new windows proc
LRESULT CALLBACK DLLWindowProc (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch (message)
    {
        case WM_KEYDOWN:
            if(wParam == VK_HOME) {
            //TextOut(hdc,15, 15, keydown, _tcslen(keydown));
            // etc.
                MessageBox(NULL, _T("Call to RegisterClassEx failed!"), _T("Win32 Guided Tour"), NULL);
            }
        break;
        case WM_COMMAND:
               switch(wParam)
               {
                    case MYMENU_EXIT:
                        SendMessage(hwnd, WM_CLOSE, 0, 0);
                        break;
                    case MYMENU_MESSAGEBOX:
                        MessageBox(hwnd, L"Test", L"MessageBox",MB_OK);
                        break;
               }
               break;
        case WM_DESTROY:
            PostQuitMessage (0);
            break;
        default:
            return DefWindowProc (hwnd, message, wParam, lParam);
    }
    return 0;
}

//HOOK LIB=====================================================================================================
// This will be called when keys are pressed.

HHOOK g_kbHook=NULL;

LRESULT CALLBACK KeyboardHook(int nCode,WPARAM wParam,LPARAM lParam)
{
    KBDLLHOOKSTRUCT* key;
    if(wParam == WM_KEYDOWN || wParam == WM_SYSKEYDOWN){
        key = (KBDLLHOOKSTRUCT*)lParam;
        if(key->vkCode == VkKeyScan('a')){
            //odprintf("You pressed 'a'");
            MessageBox(NULL, _T("Pressed a"), _T("Win32 Guided Tour"), NULL);
        }

        if(key->vkCode == VK_F1){
            MessageBox(NULL, _T("Pressed F1"), _T("Win32 Guided Tour"), NULL);
            //odprintf("You pressed F1");
        }
    }

    return 0;
}

LRESULT CALLBACK _KeyboardHookProc(int nCode,WPARAM wParam,LPARAM lParam){
    //g_kbHookFunction(nCode,wParam,lParam);
    KeyboardHook(nCode,wParam,lParam);
    return CallNextHookEx(g_kbHook,nCode,wParam,lParam);
};

//ENTRY POINT================================================================================================
//our start function, start everything here

DWORD WINAPI start(LPVOID lpParam){
    // START YOUR CODE HERE...

    // Lay some hooks, season libraly with pwnsauce.
    // Do whatever you want here, this is your thread to play with.
    // NOTE: This is used as the starting function in most examples.

    // STOP HERE.

    MSG messages;
    wchar_t *pString = reinterpret_cast<wchar_t * > (lpParam);
    HMENU hMenu = CreateDLLWindowMenu();
    RegisterDLLWindowClass(L"InjectedDLLWindowClass");
    prnt_hWnd = FindWindow(L"Window Injected Into ClassName", L"Window Injected Into Caption");
    HWND hwnd = CreateWindowEx (0, L"InjectedDLLWindowClass", L"mywindow", WS_EX_PALETTEWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, 400, 300, prnt_hWnd, hMenu,inj_hModule, NULL );
    ShowWindow (hwnd, SW_SHOWNORMAL);

    g_kbHook = SetWindowsHookEx(WH_KEYBOARD_LL,_KeyboardHookProc,GetModuleHandle(NULL),0);
    if (!g_kbHook) {

    }

    while (GetMessage (&messages, NULL, 0, 0))
    {
        TranslateMessage(&messages);
        DispatchMessage(&messages);
    }
    return 1;
    g_kbHook = NULL;
}

BOOL APIENTRY DllMain( HMODULE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved) {
    switch (ul_reason_for_call) {
        case DLL_PROCESS_ATTACH:
            // We create a new thread to do our bidding in, this way we don't hold the loader lock.
            // We close the handle to the thread for various reasons.
            inj_hModule = hModule;
            CloseHandle(CreateThread(NULL, 0, start, (LPVOID)hModule, 0, NULL));

        break;
        case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
        break;
    }

    return TRUE;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T04:26:12.257

如果您尝试挂钩的进程已经安装了自己的键盘挂钩，则该挂钩可能不会调用 CallNextHookEx() 将消息传递给您的挂钩。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644984%28v=vs.85%29.aspx)上的说明（请注意“返回值”部分中的说明）。如果这确实是您的问题的原因，您唯一的选择可能是在进程安装自己的挂钩之前安装您的挂钩。

# jquery - 未捕获的类型错误：对象 [object Object] 的属性“$”不是函数

> ID：15305606
> 
> 赞同：0
> 
> 时间：2013-03-09T00:20:11.820
> 
> 标签：jquery

JS初学者在这里。我一直在尝试在我的网站上制作slabtext，但出现错误。不知道如何解决它。

```
$(window).load(function() {
Uncaught TypeError: Property '$' of object [object Object] is not a function
    slabTextHeadlines();
});

// Function to slabtext the hero panel
function slabTextHeadlines() {
    $('html:not(.ie8)').find('.slab').slabText({
        // Don't slabtext the headers if the viewport is under 380px
        "viewportBreakpoint":380
    });
}; 
```

有任何想法吗？巴勃罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:35:02.737

Try this :

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js" > </script>
$(window).load(function() {
    slabTextHeadlines();
});

// Function to slabtext the hero panel
function slabTextHeadlines() {
    $('html:not(.ie8)').find('.slab').slabText({
        // Don't slabtext the headers if the viewport is under 380px
        "viewportBreakpoint":380
    });
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:25:45.867

你库 jquery 插件了吗？像 jquery.min 吗？

```
<script type="text/javascript" src="js/jquery.min" />
<script type="text/javascript" src="js/jquery-ui-1.8.22.custom.min" /> 
```

# bash - 如何从使用 winApi CreateProcess 调用的 bash 脚本中获取退出代码？

> ID：15305609
> 
> 赞同：1
> 
> 时间：2013-03-09T00:20:22.303
> 
> 标签：bash, winapi, visual-c++, process, cygwin

我正在使用 CreateProcess 通过 Cygwin 的 bash.exe 调用 bash 脚本。该脚本运行良好，我什至可以重定向 stdout 和 stderr 以显示在我自己的窗口中。唯一的问题是我似乎无法获得 bash 脚本的退出代码。

这是我启动脚本的方式：

```
PROCESS_INFORMATION pi;
ZeroMemory( &pi, sizeof(pi) );

STARTUPINFO si; 
si.cb = sizeof (STARTUPINFO); 
si.lpReserved = NULL; 
si.lpDesktop = NULL;
si.lpTitle = NULL; 
si.dwX = 0; 
si.dwY = 0; 
si.dwXSize = 0; 
si.dwYSize = 0; 
si.dwXCountChars = 0; 
si.dwYCountChars = 0; 
si.dwFillAttribute = 0; 
si.dwFlags = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW; 
si.wShowWindow = SW_HIDE; 
si.cbReserved2 = 0; 
si.lpReserved2 = NULL; 
si.hStdOutput = hChildStdOut;
si.hStdInput  = NULL;
si.hStdError  = hChildStdErr;

CreateProcessW( NULL, 
    L"bash.exe script.sh file_to_process", 
    NULL, 
    NULL, 
    TRUE, 
    CREATE_NEW_CONSOLE, 
    NULL, 
    NULL, 
    &si, 
    &pi);

hChildProcess = pi.hProcess; 
```

这是我尝试获取退出代码的方式：

```
WaitForSingleObject(hChildProcess, 0);
DWORD exitCode = 999;
GetExitCodeProcess(hChildProcess, &exitCode);
DWORD lastError = GetLastError(); 
```

无论脚本应返回的退出代码如何，exitCode 和 lastError 似乎都始终为零。

**更新**

正如 cwgem 指出的那样，该脚本`exit`用于退出脚本。我尝试将它们全部更改为`return`，其中 exitCode = 1，这不是脚本返回的值。一些谷歌搜索让我明白了`$(exit n)`，哪种工作，但我只从脚本中得到最终的退出代码（目前为 7 用于测试，但通常为 0）。

因此，例如，我的脚本中有以下块：

```
if [ `/cygdrive/c/cygwin/bin/find $root -name '*.xml' | grep -c .xml` -eq 0 ] ; then
echo No XMLs present in $root!
$(exit 2)
fi 
```

当我测试这条路径时，我在标准输出中得到了“No XMLs”消息，正如预期的那样，但我没有得到 2 作为我的退出代码。相反，我得到 7，正如我上面提到的，这是脚本中的最终退出语句。

我可以创建一个变量来存储我的退出代码并在最后返回它，但这感觉不是正确的解决方案，因为我可能会执行我不应该执行的代码。

我也许应该注意，我既不是脚本的作者，也不是维护者，我只是被要求从我的应用程序中运行它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T06:47:36.557

您应该检查脚本的执行流程，因为 bash 将作为退出代码返回最后一个运行命令的返回值，除非您：

*   使用强制退出`exit [returncode]`
*   `set -e`在脚本的开头，当任何命令以非零值退出时将立即退出

# iphone - 在 iPhone 4s 和更早版本上运行时 UIScrollView 被隐藏

> ID：15305611
> 
> 赞同：0
> 
> 时间：2013-03-09T00:20:35.230
> 
> 标签：iphone, ios, uiscrollview, hidden

为什么我`UIScrollView`在 3.5 英寸（iPhone 4s 和更早版本）iOS 模拟器上运行我的应用程序时会被隐藏？

在 iPhone 5（4 英寸）iOS 模拟器上正常显示...

感谢您的回答。

# path - 'which gem' 和 'which rvm' 打印 bash 脚本而不是位置

> ID：15305616
> 
> 赞同：0
> 
> 时间：2013-03-09T00:21:18.850
> 
> 标签：path, rubygems, rvm

我觉得这是 rvm 安装不起作用的症状，但我不知道出了什么问题；[我在https://rvm.io/m](https://rvm.io/m)上使用了命令（\curl -L [https://get.rvm.io](https://get.rvm.io) | bash -s stable --ruby）

注意：我可以成功安装gems

```
myprompt: which gem
gem () {
    typeset result
    (
        typeset rvmrc
        rvm_rvmrc_files=("/etc/rvmrc" "$HOME/.rvmrc") 
        if [[ -n "${rvm_prefix:-}" ]] && ! [[ "$HOME/.rvmrc" -ef "${rvm_prefix}/.rvmrc" ]]
        then
            rvm_rvmrc_files+=("${rvm_prefix}/.rvmrc") 
        fi
        for rvmrc in "${rvm_rvmrc_files[@]}"
        do
            [[ -s "${rvmrc}" ]] && source "${rvmrc}" || true
        done
        unset rvm_rvmrc_files
        command gem "$@"
    ) || result=$? 
    hash -r
    return ${result:-0}
}
myprompt: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T21:48:24.160

我遇到了同样的“问题”，在 Mac OS X 上使用 zsh。经过一番搜索，我发现它实际上是标准行为。要获得更全面的答案，请查看这个 SO 问题[Zsh `which rvm` or `which gem` 返回函数内容而不是路径](https://stackoverflow.com/questions/7719757/zsh-which-rvm-or-which-gem-returns-the-function-contents-instead-of-the-path)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:34:27.913

我不会担心那个输出；`gem`并且`rvm`应该是功能。

但我有点不明白为什么要`which`显示这些功能。您正在运行什么操作系统/发行版？还有什么壳？看起来你`which`是一个 shell 内置命令；在 bash 中它不是，所以也许你正在使用 csh 或 zsh。

# javascript - javascript中的正则表达式转义括号不起作用

> ID：15305621
> 
> 赞同：0
> 
> 时间：2013-03-09T00:21:56.467
> 
> 标签：javascript, regex, escaping

我有一大段代码正在做一些非常奇怪的事情。

```
function getQuerystring(key, default_){

  if (default_==null) default_=""; 
  key = key.replace(/[\[]/,'\\\[').replace(/[\]]/,'\\\]');
  var regex = new RegExp("[\\?&]"+key+"=([^&#]*)");
  var qs = regex.exec(window.location.href);
  if(qs == null)
    return default_;
  else
    return qs[1];
}

var isThankyou = getQuerystring('CONFIRMATION'); 
```

此函数检查参数的 URL（在本例中为 CONFIRMATION）。据我所知，一切都是正确的，但是当浏览器加载代码时，它会在控制台中引发错误。

> 未捕获的 SyntaxError：无效的正则表达式：缺少 /

最终，这段代码用于确定用户是否在 URL 的确认页面上。如果是，那么它会触发一些谷歌分析代码来跟踪 GA 中的电子商务购买信息。

给我带来麻烦的行是：

```
key = key.replace(/[\[]/,'\\\[').replace(/[\]]/,'\\\]'); 
```

当我在浏览器中加载页面并查看源代码时，会显示以下内容：

```
key = key.replace(/[\[]/,'\\\[').replace(/[\/,'\\\]'); 
```

之前有两个`]]`出现

这是奇怪的事情。当我复制注释掉第一行的行时，不会引发错误（但是`]]`仍然显示）：

```
//key = key.replace(/[\[]/,'\\\[').replace(/[\]]/,'\\\]');
  key = key.replace(/[\[]/,'\\\[').replace(/[\]]/,'\\\]'); 
```

我已经尝试了我能想到的所有方法，但都没有成功，我什至尝试取消链接替换方法以防万一导致问题。

```
key = key.replace(/[\[]/,'\\\[');
  key = key.replace(/[\]]/,'\\\]'); 
```

这会在浏览器源代码中产生以下结果：

```
key = key.replace(/[\[]/,'\\\[');
  key = key.replace(/[\/,'\\\]'); 
```

无论如何，问题似乎在于第二个 .replace 没有逃避一个`]`，甚至`]]`出于某种原因保留了两个。

我还尝试过清除缓存、cookie 并关闭所有插件。我已经在 Chrome、Firefox 和 Safari 中进行了测试，在所有 3 种浏览器上都得到了相同的结果。

这是您可以看到完整代码块的页面（最后在头部）：[https ://secure2.convio.net/ccod/site/Ecommerce?store_id=2841](https://secure2.convio.net/ccod/site/Ecommerce?store_id=2841)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:34:01.447

您的代码看起来有点复杂。这里有一些更简单的：

```
function getQueryString(key) {
    var index, url, parts, i, subparts;
    url = window.location.href;
    index = url.indexOf("?");
    if (index === -1) {
        return null;
    }
    url = url.substr(index);
    parts = url.split("&");
    for (i = 0; i < parts.length; i += 1) {
        subparts = parts[i].split("=");
        if (subparts[0] === key) {
            return subparts[1];
        }
    }
    return null;
} 
```

*（未经测试）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:32:59.017

这会导致错误：`key = key.replace(/[\/,'\\\]')`因为您在正则表达式末尾使用反斜杠转义正斜杠，如下所示：`/[\/`

试试这个`key = key.replace(/[\\/,'\\\]')`

# xcode - Xcode 如何知道在项目导航器中显示哪些文件？

> ID：15305623
> 
> 赞同：2
> 
> 时间：2013-03-09T00:21:58.707
> 
> 标签：xcode

我的文件系统和 pbxproj 中有一个文件，但是当我尝试在导航器中显示它时，找不到该文件。此外，使用其方法的文件会出现“找不到方法”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:26:20.097

它是什么样的文件？.m 或 .h 文件？

如果在导航器中找不到它，请尝试使用文件和文件夹列表底部的搜索字段。它看起来像这样：

![使用搜索字段](../Images/c798c7469350ddd19cf7893658d43208.png)

如果这不起作用，请打开 Target 的 Build Phases 并查看要编译的文件列表，如下所示。

![在项目导航器中显示](../Images/ad1ec37be0e4c265e923625801b88e95.png) 在单击所需文件的同时按住命令键将弹出一个带有“在项目导航器中显示”的上下文菜单。

如果在查看要编译的文件列表时没有看到该文件，则很有可能您只需*将文件添加*到项目中即可。

# android - Xamarin/Mono for Android - 自定义标题视图时 AlertDialog 崩溃

> ID：15305624
> 
> 赞同：2
> 
> 时间：2013-03-09T00:22:09.413
> 
> 标签：android, xamarin.android, android-alertdialog, xamarin

我想自定义警报对话框标题背景，应用程序崩溃而不显示警报对话框。（自定义视图只填充消息区域，不包括标题面板和按钮面板。我想自定义默认的标题面板和按钮面板，这里以标题为例。）

```
public static class MyAlertDialog
{
    private static AlertDialog _alertDialog;

    public static void Show(Context context)
    {
        var factory = LayoutInflater.From(context);
        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(context)
            .SetTitle("myTitle")
            .SetView(factory.Inflate(Resource.Layout.DialogRegister, null))
            .SetCancelable(true);

        _alertDialog = alertDialogBuilder.Create();
        var titleView = (TextView)_alertDialog.FindViewById(Android.Resource.Id.Title); //get title view from the Android resource not from my custom view
        //titleView.SetBackgroundResource(Resource.Color.PrimaryColor);
        titleView.SetBackgroundColor(Android.Graphics.Color.Red); 
        _alertDialog.Show();  

    }
} 
```

我从主要活动中调用对话框：

```
[Activity(Label = "My Activity", MainLauncher = true)]
public class HomeActivity : Activity
{
    protected override void OnCreate(Bundle bundle)
    {
        base.OnCreate(bundle);

        SetContentView(Resource.Layout.home);

        Button btnMyButton = FindViewById<Button>(Resource.Id.MyButton);
        btnMyButton.Click += (object sender, EventArgs e) =>
        {
            MyAlertDialog.Show(this);
        };

        ......
     }
 } 
```

VS 抛出运行时异常并要求我中断或继续。我点击继续。然后应用程序崩溃。日志：

```
03-09 11:10:47.057 E/mono    ( 1185): [0x4001f730:] EXCEPTION handling: Android.Util.AndroidRuntimeException: Exception of type 'Android.Util.AndroidRuntimeException' was thrown.
03-09 11:10:49.956 I/Email   (  451): ReconcilePopImapAccountsSync: start
03-09 11:10:50.276 I/Email   (  451): ReconcilePopImapAccountsSync: done
03-09 11:11:07.417 E/mono    ( 1185): [0x4001f730:] EXCEPTION handling: Java.Lang.NullPointerException: Exception of type 'Java.Lang.NullPointerException' was thrown.
03-09 11:11:07.727 E/mono    ( 1185): [0x4001f730:] EXCEPTION handling: Java.Lang.NullPointerException: Exception of type 'Java.Lang.NullPointerException' was thrown.
03-09 11:11:16.846 F/        ( 1185): * Assertion: should not be reached at /Users/builder/data/lanes/monodroid-lion-bigsplash/0e0e51f9/source/mono/mono/mini/debugger-agent.c:5980
03-09 11:11:16.846 I/mono    ( 1185): Stacktrace:
03-09 11:11:16.846 I/mono    ( 1185): 
03-09 11:11:16.866 E/mono    ( 1185): [0x2a118c70:] EXCEPTION handling: System.NullReferenceException: Object reference not set to an instance of an object
03-09 11:11:16.906 E/mono    ( 1185): 
03-09 11:11:16.906 E/mono    ( 1185): Unhandled Exception:
03-09 11:11:16.906 E/mono    ( 1185): System.NullReferenceException: Object reference not set to an instance of an object
03-09 11:11:16.937 I/mono    ( 1185): [ERROR] FATAL UNHANDLED EXCEPTION: System.NullReferenceException: Object reference not set to an instance of an object 
```

我在模拟器中使用 Android 4.1.2 armeabi-v7a 对其进行了测试。（该项目将支持架构 armeabi、armeabi-v7a 和 x86。）

谢谢你的帮助。（我知道我可以将带有消息的标题放在自定义内容视图中。但我也想自定义它的其他部分。所以我只是以标题为例。）

**我注意到虽然我 SetTitle("myTitle")，但 titleView.text 是一个空字符串。我在获取默认标题视图时错了吗**

```
var titleView = (TextView)_alertDialog.FindViewById(Android.Resource.Id.Title); 
```

同样，我的自定义视图不包含标题视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T09:39:40.283

你的代码很乱，可能有多个问题，但我认为这一行是你的问题

```
txView.SetBackgroundResource(Resource.Color.PrimaryColor); 
```

正如您在文档中看到[的](http://developer.android.com/reference/android/view/View.html#setBackgroundResource%28int%29)那样，您应该只传递对 a 的引用`Drawable`作为参数而不是 a `Color`。

您需要在[这里](http://developer.android.com/reference/android/view/View.html#setBackgroundColor%28int%29)使用此方法，如下所示： `txView.SetBackgroundColor(Resource.Color.PrimaryColor);`

问题中的代码也无法编译， txView 变量来自哪里？我假设它是titleView？

还有一件事；每次运行项目时都会显示您发布的日志条目，您可以忽略它。请参阅[此处](http://mono-for-android.1047100.n5.nabble.com/Runtime-version-supported-by-this-application-is-unavailable-tp5677802p5678753.html)了解更多信息。您应该发布的实际日志条目会晚得多（并且仅*在*您单击 Visual Studio 中的继续之后）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T01:21:34.277

您需要告诉在哪个视图中找到 id。所以`view`在获取`factory`.

```
var view = factory.Inflate(Resource.Layout.DialogRegister, null); 
```

因为`titleView`会引用null，所以会导致崩溃，

然后，您可以找到`title`使用`view`您刚刚创建的。需要指出的是， `Android.Resource`在 Mono for Android 中对 Android 框架资源的`Resource`引用，实际上是对您的布局、ID 等的引用。因此，代码如下：

```
var titleView = view.FindViewById<TextView>(Resource.Id.title); 
```

[`SetBackgroundResource`](http://developer.android.com/reference/android/view/View.html#setBackgroundResource%28int%29)只能将drawable作为有效参数，所以color在这种情况下不起作用。但是`SetBackgroundColor`会起作用，因为`Android.Graphics.Color.Red`它是一个[`Color`](http://developer.android.com/reference/android/graphics/Color.html)对象。

此外，您可以`SetView(view)`在构建对话框时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-21T02:52:49.653

我只会使用对话框。您重写 OnCreateDialog 方法。如果需要，您可以在那里设置内容视图并设置自定义标题。您还可以自定义对话框。这是一些示例代码，有一个 SetTitle 方法。这是一个简短的示例，更多可以在代码下方的链接中找到。

此代码显示如何连接按钮单击以显示对话框。单击按钮后，将调用 OnCreateDialog 并且系统将显示您的对话框。

```
const int NewGame = 1;
protected override Dialog OnCreateDialog(int id)
    {
        switch (id)
        {
            case NewGame:
                Dialog d = new Dialog(this);// Create the new dialog
                d.SetTitle("New Game");//Set the title.
                d.SetContentView(Resource.Layout.ActNewGame);//Set the layout resource.
                //here you can use d.FindViewById<T>(Resource)
             return d;
        }
        return null;
    } 
```

}

```
// wire up a button click in the OnCreate method.
btnNewGame.Click += (o, e) =>
        {

                ShowDialog(NewGame);
        }; 
```

[http://xandroid4net.blogspot.com/2014/09/xamarinandroid-ways-to-customize-dialogs.html](http://xandroid4net.blogspot.com/2014/09/xamarinandroid-ways-to-customize-dialogs.html)

# ruby-on-rails - 很抱歉，出了点问题（Ruby on Rails）

> ID：15305625
> 
> 赞同：3
> 
> 时间：2013-03-09T00:22:36.270
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

在我的本地服务器上一切正常，但是当我在将网站上传到生产环境后尝试执行某个功能时收到此错误消息`heroku`。

在 heroku 上，除了用户尝试发布内容时，一切正常。这是一个带有发布按钮的简单文本表单。当文本# 超过 2 或 3 行或其他内容时，我似乎只会收到此`We're sorry, but something went wrong`错误。这有点随机，因为所有 2 行或更短的帖子都可以，但是当它达到 2-3 行时，并不是全部都通过。当它超过3时，他们肯定不会通过。

有谁知道是什么导致了这个奇怪的错误？正如我所提到的，所有短文本帖子都可以正常工作，但是文本帖子越长，我就会开始收到此错误消息（比如我的文本框中超过 2 行）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T00:34:50.050

Most likely the error is because the field you're trying to input is a `string` field. Heroku uses `pg` which limits the length of string to 255 characters. You need to change your model to use `text` fields instead when the input will be long.

You can always look at your logs by doing:

`heroku logs`

and read more information on the error.

# sql - 一些 Transact-SQL 查询

> ID：15305628
> 
> 赞同：-4
> 
> 时间：2013-03-09T00:22:48.877
> 
> 标签：sql

我需要一些 SQL 选择语句的帮助。

我有 4 张桌子：

```
Product(ProductID, Name, DateOfBirth)
Customer(CustomerID, Name)
Comment(CommentID, CustomerID, ProductID, Status) 
```

1.  选择没有收到任何评论的产品。
2.  显示评论数最多的客户。例如：CusName - Tom，评论 - 3
3.  显示所有客户的年龄，20 岁以上为“老”，其他为“年轻”。
4.  将 Comment 表的 Status 列显示为 1 为“Enabled”，为 0 为“Disabled”。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:27:12.950

要回答您问题的第一部分，我会这样编写 SQL：

```
SELECT Product.ProductID 
FROM Product
LEFT OUTER JOIN Comment ON Product.ProductID = Comment.ProductID
WHERE Comment.CommentID IS NULL 
```

# python - Python Roguelike：库存消失

> ID：15305634
> 
> 赞同：0
> 
> 时间：2013-03-09T00:23:17.690
> 
> 标签：python, roguelike

今天我进一步学习了[这个 Python roguelike 教程](http://roguebasin.roguelikedevelopment.org/index.php?title=Complete_Roguelike_Tutorial,_using_python%2Blibtcod)，并进入了清单。到目前为止，我可以拿起物品并使用它们。唯一的问题是，在访问库存时，即使我使用了该`console_wait_for_keypress(True)`功能，它也只能在瞬间可见。我不确定它为什么会消失。这是显示菜单的代码（在本例中为库存）：

```
def menu(header,options,width):
    if len(options)>26: raise ValueError('Cannot have a menu with more than 26 options.')

    header_height=libtcod.console_get_height_rect(con,0,0,width,SCREEN_HEIGHT,header)
    height=len(options)+header_height

    window=libtcod.console_new(width,height)

    libtcod.console_set_default_foreground(window,libtcod.white)
    libtcod.console_print_rect_ex(window,0,0,width,height,libtcod.BKGND_NONE,libtcod.LEFT,header)

    y=header_height
    letter_index=ord('a')
    for option_text in options:
        text='('+chr(letter_index)+')'+option_text
        libtcod.console_print_ex(window,0,y,libtcod.BKGND_NONE,libtcod.LEFT,text)
        y+=1
        letter_index+=1

    x=SCREEN_WIDTH/2-width/2
    y=SCREEN_HEIGHT/2-height/2
    libtcod.console_blit(window,0,0,width,height,0,x,y,1.0,0.7)

    libtcod.console_flush()
    key=libtcod.console_wait_for_keypress(True)

    index=key.c-ord('a')
    if index>=0 and index<len(options): return index
    return None 
```

我很感激任何人对这个问题的帮助或意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T06:17:41.493

它可能与旧版本的库有关，当你按下一个键时有一个事件，当你释放它时有另一个事件。因此，这可能会导致它在您释放密钥时出现和消失。

因此，如果您按住该键，请尝试查看屏幕是否保持亮起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-26T20:01:33.047

`wait_for_keypress`确实会在新闻和发布事件上触发。要解决此问题，请替换`wait_for_keypress`为`sys_wait_for_event`, 指定仅在按下事件时触发。

[文档](http://doryen.eptalys.net/data/libtcod/doc/1.5.2/html2/console_blocking_input.html?c=false&cpp=true&cs=true&py=false&lua=true)

# java - 在 Eclipse IDE 中出现我无法突出显示或删除的奇怪符号

> ID：15305642
> 
> 赞同：13
> 
> 时间：2013-03-09T00:24:10.373
> 
> 标签：java, eclipse, ide, symbols

我突然得到了这些奇怪的符号。我假设我不小心打开了某些东西，但我不确定它是什么。任何帮助将不胜感激。

问题图片：问题的[Imgur 图片](http://i.imgur.com/M7gnGSq.png)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-09T00:28:49.873

查找此按钮：
![在此处输入图像描述](../Images/11056478a2c12f27f3eea49fc31a6527.png)
并禁用它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-09T00:28:16.620

您不小心将 Eclipse 设置为显示空白。你可以在这里修复它：

```
Window >> Preferences >> General >> Editors >> Text Editors:
  [x] Show whitespace characters 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-09T00:29:14.290

那是“可见的空白”。显示制表符、空格和换行符。

在首选项中，转到常规 > 编辑器 > 文本编辑器并取消选中“显示空白字符”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T00:28:25.690

这些是空白符号。禁用它们的热键是`CTRL .`（这是一个句号）。

这个问题也在这里得到了回答，但我不确定我们是否应该标记为重复。 [如何禁用 eclipse 中的格式化符号？](https://stackoverflow.com/questions/3957634/how-do-i-disable-the-formatting-symbols-in-eclipse)

# r - 使用 R 向数据集添加决策列

> ID：15305648
> 
> 赞同：0
> 
> 时间：2013-03-09T00:24:50.730
> 
> 标签：r

我有一个数据集“activityData”如下

```
subject activity       
1        walk   
2        lay       
3        sit   
4        stand     
5        run     
6        walk   
7        sit       
8        run 
```

*我想再添加一列“活动”，应该用“真”或“假”填充*

例子：

```
activityData$active <- with(activityData, ifelse( ((activity=="walk") || (activity=="run"), "TRUE", "FALSE")) 
```

希望上述语句将“活动”列合并到活动数据，如下所示

```
subject activity active      
1        walk    TRUE
2        lay     FALSE
3        sit     FALSE
4        stand   FALSE
5        run     TRUE
6        walk    TRUE
7        sit     FALSE
8        run     TRUE 
```

有人可以帮助我正确的**R**语法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:33:26.567

以下内容快速且易于理解。它使用 %in% 运算符。

```
activityData$active <- activityData$activity %in% c("walk","run") 
```

# php - 同一文件上的函数和类：未定义的函数

> ID：15305649
> 
> 赞同：4
> 
> 时间：2013-03-09T00:24:53.233
> 
> 标签：php, namespaces, psr-0

[根据PSR-0](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)定义（自动加载），我有一个包含类和函数定义的文件：

```
namespace Foo;

function b() {};

class Bar {} 
```

我有那个类的测试，放在同一个命名空间中：

```
namespace Foo;

class BarTest {} 
```

当我尝试访问`b()`测试类中的函数时，出现`undefined function`错误：

```
namespace Foo;

class BarTest extends PHPUnit_Framework_TestCase
{
    public function testSomething()
    {
        b();
        Foo\b();
        \b();
    }
} 
```

似乎没有任何效果。我怎样才能调用该函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T06:49:34.970

PHP 自动加载不支持函数。但是它确实适用于*静态*类方法：

```
namespace Foo;

abstract class Util
{
    static function doSomething() {

    }
} 
```

然后，您可以`use`将该类放在当前命名空间的其他一些文件中并调用静态方法：

```
use Foo\Util;

Util::doSomething(); 
```

由于这是一个类方法并且自动加载是针对类的，所以这确实有效。

请注意，在命名空间/类中对方法进行分组的更正确方法也可能是使其成为[*`final`^(Docs)*](http://php.net/language.oop5.final)，但是 PHP 不支持这一点（请参阅[*无法创建最终抽象类^(PHP Sadness #41）)*](http://phpsadness.com/sad/41)。

您可以在网站上的以下问答材料中找到这一点：

*   [自动加载功能](https://stackoverflow.com/questions/4737199/autoloader-for-functions)- 2011 年 1 月 19 日
*   [php 中的自动加载函数](https://stackoverflow.com/questions/4196881/autoload-functions-in-php)- 2010 年 11 月 16 日
*   [PHP 自动加载器功能是否也适用于静态方法调用？](https://stackoverflow.com/questions/2044514/does-the-php-autoloader-function-also-work-with-static-method-calls)- 2010 年 1 月 11 日

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:28:49.130

你的函数 b(); 必须有身体，把它改成

`function b(){};`

# actionscript-3 - 闪光投影仪定制

> ID：15305651
> 
> 赞同：0
> 
> 时间：2013-03-09T00:25:04.020
> 
> 标签：actionscript-3, flash

因此，假设我使用 flash 和 as3 制作游戏，然后将其发布为 .exe，如果我使用资源黑客等第三方软件定制投影仪，例如从默认 flash 图标和文本更改 .exe 图标和标题，我会介意“flash player 10”，然后分发那个.exe？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T09:54:08.270

对于投影仪，您将需要一个 3rd 方工具，但我认为您会发现资源黑客无法在 CS6 中工作，只能在 CS5 及更早版本中工作。
最好使用[MDM Zink](http://multidmedia.com/software/zinc/)之类的工具打包 exe ，您可以在其中自定义窗口。由于像 Zink 这样的工具已经存在了一段时间并且已经建立，我认为 Adob​​e 没有任何问题。

为什么不使用 AIR 发布？在那里，您可以完全控制窗口（Chrome）并拥有额外的桌面相关库。您可以打包为强制 .exe。

# c - 向上按钮应该带来以前传递的命令

> ID：15305652
> 
> 赞同：0
> 
> 时间：2013-03-09T00:25:05.200
> 
> 标签：c

所以我正在设计一个类似于 bash 的应用程序，当用户按下向上和向下键时，应该打印先前传递的输入（或命令）。我知道 Java 有关键的听众，但我不知道如何在 C 中做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:30:58.303

我会用[`GNU readline`](http://web.mit.edu/gnu/doc/html/rlman_2.html). 它实际上是 Bash 使用的。

# php - PHP session替代，大家共享

> ID：15305654
> 
> 赞同：0
> 
> 时间：2013-03-09T00:25:33.333
> 
> 标签：php, session

我们网站上的所有访问者都需要能够从稍微高级的数据结构中访问数据。

目前我们在会话变量中有数据结构，但据我所知，会话意味着我们所有的访问者都有自己的数据副本。

这不好，因为我们总是有越来越多的访客。

那么我们可以使用会话的替代方法吗？所有用户共享的替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:38:12.220

听起来您正在寻找数据库。但是我觉得您正在寻找比完整数据库更临时的东西，更多的东西来代表您的应用程序/网站的当前状态？如果我是对的，那么某种缓存应该适合您的需求。尝试[memcached](http://memcached.org/)或[Redis](http://redis.io/)。

# for-loop - 确定令牌数量 - BATCH

> ID：15305666
> 
> 赞同：3
> 
> 时间：2013-03-09T00:26:51.863
> 
> 标签：for-loop, batch-file, token

我目前正在通过 PowerShell 和 Batch 编写大量用户创建脚本。目前该脚本有 95 行，是我用 Batch 编写的最大的脚本。

我希望脚本尽可能自动化，并计划将其提供给需要帮助创建大量用户的客户。为此，我有一个 21 行的设置文件，我需要的变量之一是完整的域名（dsadd 需要这个）

这样做的问题是，用户可能有任意数量的变量——从测试实验室中的两个到学校等地方的四个。到目前为止，我能够分离令牌，但是我需要将它们全部存储为变量，如 %%a、%%b，而不是将所有内容存储为 %%a。令牌的数量将是动态的，因此我需要某种解决方案。像这样的东西（是的，我知道这不是正确的语法）：

```
if number of tokens=4 (
dsadd "cn=%%a,ou=%%b,dc=%DSuffix1%,dc=%DSuffix2%,dc=%DSuffix3%,dc=%Dsuffix4% ) 
```

在该行中，%%a 和 %%b 是稍后在从用户列表 excel 文件读取的代码中另一个 for 循环中的变量。对于从两个令牌到四个令牌的任何东西，我都需要类似的东西。我不介意这个问题的解决方案是否不是纯粹的 BATCH，但这是我的首选。

谢谢。

编辑：这是我目前拥有的 for 循环，它嵌套在另一个更大的 for 循环中，该循环添加了用户：

```
for /f "tokens=1,2,3,4 delims=." %%a in (Settings.ini) do (
set L=22
if !L!=22 set DSuffix1=%%a&& set DSuffix2=%%b&& set DSuffix3=%%c&& set DSuffix4=%%d
) 
```

settings.ini 文件包含各种设置，例如 Exchange 服务器和用户主目录的路径。我需要解释的行是第 22 行，如下所示：

DOMAINNAME.SUFFIX(.SUFFIX.SUFFIX.SUFFIX) 一个真实的例子是：testlab.local 或 testlab.ghamilton.local

对于测试实验室，设置只能是域名和后缀，但对于学校或机构等其他设置，域后缀的数量最多可以达到四个。我想解释一下。

编辑： 管理正确缩进代码，对不起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T05:21:50.600

如果我理解正确，您有一个字符串，例如`domain.foo.bar.baz`并且您想将其更改为`dc=domain,dc=foo,dc=bar,dc=baz`.

这个怎么样？

```
set domain=domain.foo.bar.baz
echo dc=%domain:.=,dc=% 
```

这应该与此相呼应：

```
dc=domain,dc=foo,dc=bar,dc=baz 
```

该`%domain:.=,dc=%`行正在扩展`%domain%`环境变量，但将全部替换`.`为`,dc=`. 有关详细信息，请参阅[http://ss64.com/nt/syntax-replace.html 。](http://ss64.com/nt/syntax-replace.html)

要在环境变量中进行字符串替换，您确实需要首先将值放在环境变量中。这是一个脚本，它将从 settings.ini 中读取第 22 行，并结合上述技术：

```
setlocal enabledelayedexpansion
set L=0
for /f %%a in (settings.ini) do (
    set /a L=!L! + 1
    if !L! equ 22 (
        set domain=%%a
        echo dc=!domain:.=,dc=!
    )
) 
```

`L`被用来计算我们在哪条线上。当我们到达第 22 行时，我们将环境变量设置为整行 ( `%%a`) 的值，然后像上面一样进行字符串替换（但使用`!`而不是`%`利用延迟扩展）。

当然，而不是 a `echo`，你会做类似的事情

```
dsadd "cn=%cn%,ou=%ou%,dc=!domain:.=,dc=!" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T05:27:25.360

这是我的小片段，用于演示如何获取单独的标记（分隔符是空格和制表符，但您可以更改它们）。

```
@echo off & setlocal enabledelayedexpansion
for /f "tokens=1,2,3,4" %%a in (test.txt) do (
    set token1=%%a
    set token2=%%b
    set token3=%%c
    set token4=%%d
    set full=%%a%%b%%c%%d
)
set token
set full
pause>nul 
```

`test.txt`包含：

```
first second third 
```

输出是：

```
token1=first
token2=second
token3=fourth
full=firstsecondthird 
```

所以，你可以通过类似的东西来判断有多少令牌

```
for /l %%i in (4,-1,1) do if not defined token%%i set amount=%%i 
```

或者类似的东西。

希望有帮助。

# javascript - AIR SocketServer 与远程基于 Web (javascript) 的 Socket Server 通信

> ID：15305667
> 
> 赞同：1
> 
> 时间：2013-03-09T00:26:56.663
> 
> 标签：javascript, actionscript-3, sockets

我有一个基于 AIR 的多人手机游戏，它可以通过 LAN 连接到基于 AIR 的服务器。不幸的是，无论出于何种原因，当 AIR 服务器仅通过远程公开可用的 Web IP 连接时，我都无法获得可靠的套接字连接。

作为替代方案，我想知道基于 AIR 的客户端应用程序是否可以通过套接字与完全基于浏览器的 (javascript) 套接字服务器进行通信？

如果这是可能的，是否有人知道任何在线演示或可以共享一些代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:38:16.627

阅读这篇文章。它可能会对您有所帮助：[使用 Adob​​e AIR ServerSocket 处理 websocket 连接](http://blog.aboutme.be/2011/06/07/handling-websocket-connections-with-adobe-air-serversocket/)

# java - 为什么在检查非空值时会收到 NullPointerException？

> ID：15305670
> 
> 赞同：-2
> 
> 时间：2013-03-09T00:27:28.657
> 
> 标签：java, generics, null, nullpointerexception

我有这个构造函数：

```
public class SentinelT<T> extends NodeT<T> {

    //constructs an empty Sentinel linked to no other Nodes
    public SentinelT() {
        super(null, null, null);
    this.prev = this;
    this.next = this;
    }
...
} 
```

因此，每当我尝试更改 this.prev 或 this.next 的值，或者尝试对这些值使用布尔运算符时，都会得到 NullPointerException。例如：

```
public boolean isEmpty() {
    return this.prev == this && this.next == this;
} 
```

抛出 NullPointerException。我有一种感觉，我只是不了解超级构造函数或空值...感谢您的帮助。

*编辑：添加了 NodeT 构造函数，将添加引发异常的实例化

```
//NodeT class for a doubly linked list of T
public class NodeT<T> {
    T data;
    NodeT<T> prev;
    NodeT<T> next;

    //constructs a Node object
    public NodeT(T data, NodeT<T> prev, NodeT<T> next) {
    this.data = data;
    this.prev = prev;
    this.next = next;
    } 
```

*edit2：不同的类，假设 stringHeader 是发生在 SentinelT 中的类的一个字段 stringHeader = new SentinelT();

```
 public void testIsEmpty(Tester t) {
    initData();

    t.checkExpect(stringHeader.isEmpty(), true);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:34:44.327

好吧，永远`this`不可能`null`。因此，要么 要么`prev`必须`next`是`null`。您的构造函数`this`同时分配给`prev`and `next`，因此这不能成为其中之一的原因`null`。因此，必须有其他您没有显示的代码将其中一个（或两个）设置为`null`.

**编辑**

再想一想，仅仅因为一个值为`null`, 并不意味着它会在这里抛出 NPE。

**第二次编辑**

随着`testIsEmpty`代码被揭示，那么要么`t`或`stringHeader`必须是`null`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:34:21.790

我很难在没有看到更多代码的情况下确定出了什么问题，但是您说在检查非空值时会收到“NullPointerException”。您是否使用过调试器，并在 isEmpty 中放置断点并证明在执行 isEmpty 期间 this.prev 和 this.next 不为空？我强烈建议使用断点来验证您对这些数据成员值的假设。

编辑 - 看到你的编辑：这是一个很好的例子，说明为什么你必须显示比你给出错误的地方更多的代码。故事往往还有更多。调试器是程序员最好的朋友。在调试器中验证您的假设。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:43:24.180

我能看到这种情况发生的唯一方法是如果`stringHeader`或者`t`是`null`......

（给 jlordo 的道具`t`）...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T01:53:43.310

让我们清楚这一点：

```
public boolean isEmpty() {
    return this.prev == this && this.next == this;
} 
```

该方法不能抛出`NullPointerException`. 它执行的任何操作都不会引发任何异常：

*   `this`不能`null`这样，`this.prev`也`this.next`不能抛出 NPE
*   用于将`==`引用与`null`（或任何其他引用）进行比较不能引发 NPE。

所以如果你得到一个 NPE，它来自其他地方......你误解了堆栈跟踪。

* * *

第二个例子：

```
t.checkExpect(stringHeader.isEmpty(), true); 
```

在这个例子中，有几种方法*可以*抛出 NPE。

*   如果`stringHeader`是，`null`那么`stringHeader.isEmpty()`将抛出一个 NPE。
*   如果`t`是，则调用`null`将抛出 NPE 。`t.checkExpect`

也有可能（理论上）在`checkExpect`or`isEmpty`调用中抛出 NPE，但堆栈跟踪将提供发生这种情况的证据。

* * *

从中吸取的教训：

*   仔细阅读堆栈跟踪，并学会正确解释它。
*   阅读您编写的代码。仔细阅读。
*   确保您了解 Java 构造可以和不能抛出 NPE ... 或其他内在异常。（在某些情况下有一些微妙之处......虽然不是在这里。）
*   不要贸然下没有证据支持的结论。'因为你这样做可能会浪费很多时间......如果你的“结论”被证明是不正确的。
*   如果您无法弄清楚，请寻找更多证据：
    *   使用调试器设置断点、检查变量、单步执行代码等
    *   添加日志记录或（临时）跟踪打印。
    *   在您的脑海中或在纸上“手动执行”。
*   如果您向其他人寻求帮助，他们将需要查看**所有**相关的代码堆栈跟踪和其他证据，以便他们可以自己推理。如果您只是提供对证据的（可能不正确的）解释，您将不会获得有用的帮助。
*   不要假设问题出在别人的代码中：*“也许这是我的教授让我们使用的这个测试程序包的问题？”* .... 错误的！

# jquery - 为什么菜单 jquery UI 小部件的名称很奇怪？

> ID：15305672
> 
> 赞同：0
> 
> 时间：2013-03-09T00:27:41.937
> 
> 标签：jquery, jquery-ui

我找不到这个问题 - 我会试一试。

我正在浏览一些 jQuery UI 小部件，我注意到一个我以前从未见过的函数名称的用法。我很好奇为什么使用这个约定。

我以前从未见过用作函数名的字符串选择器。他们为什么使用这种方法？

```
"mousedown .ui-menu-item > a": function( event ) {
   event.preventDefault();
},
"click .ui-state-disabled > a": function( event ) {
   event.preventDefault();
},
"click .ui-menu-item:has(a)": function( event ) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:35:39.817

他们本可以将其用作地图和/或使用 jQuery 的[.delegate( selector, eventType, handler(eventObject))](http://api.jquery.com/delegate/)。

```
var funcMap = {
    'foo': function(e) {
        console.log('foo');
    },
    'bar': function(e) {
        console.log('bar');
    }
};

funcMap['bar']();
funcMap['foo'](); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:44:35.033

这是将事件处理程序附加到事件

您看到的字符串是事件名称 + 选择器，一个可能在内部拆分并以某种方式使用选择器的字符串

# php - 通过电子邮件发送动态链接

> ID：15305673
> 
> 赞同：0
> 
> 时间：2013-03-09T00:27:45.467
> 
> 标签：php, html, email

我正在尝试使用此代码...

```
$message = '<a href="<?php echo curPageURL() ?> ">Click Here</a>';
mail($email, $subject, $message, $headers); 
```

我想通过电子邮件将我所在的当前页面与数据和超链接发送到电子邮件的原因。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:33:02.960

试试这个：

```
$message = '<a href="' . curPageURL() . '">Click Here</a>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:34:32.117

您已经在一个 php 标签中（由您使用 $message 显示），因此在分配它的值时不需要打开另一个标签。

```
$message = '<a href="'.curPageURL().'">Click Here</a>';
mail($email, $subject, $message, $headers); 
```

在 PHP 中`.`是连接器（它将两个字符串粘在一起）。

# soundcloud - Soundcloud 重定向 Https -> Http

> ID：15305674
> 
> 赞同：2
> 
> 时间：2013-03-09T00:27:50.500
> 
> 标签：soundcloud

我有一个使用 SoundCloud js sdk 流式传输音频的页面。初始化如下所示：

```
SC.initialize({
    client_id: myId,
    redirect_uri: "https://" + window.location.host + "/soundcloud-callback"
}); 
```

该页面使用`SC.whenStreamingReady`,`SC.get`并`SC.stream`在某种程度上等同于以下内容：

```
// Wait for SoundManager
SC.whenStreamingReady(function() {
    soundManager.onready(function() {

        // Get track metadata and stream the track itself
        SC.get("https://api.soundcloud.com/tracks/" + audioId, function(data) {
            SC.stream(data.stream_url, {...});
        });
    });
}); 
```

问题是`SC.stream`请求 https 页面 ( `"https://api.soundcloud.com/tracks/" + audioId + "/stream"`) 但 302 被重定向到 http 页面 ( [http://ec-media.soundcloud.com/...](http://ec-media.soundcloud.com/...) )。音频仍然有效，但我的浏览器栏中没有得到令人满意的锁定（并且这个请求是唯一阻止它的东西）。

难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T09:44:15.680

现在已解决此问题。

尝试从 https 导航到随机曲目

```
 https://api.soundcloud.com/tracks/82686108/stream?client_id=YOUR_CLIENT_ID 
 // will redirect you to  
 https://ec-media.soundcloud.com/SQyhrPCMQJyQ.128.mp3?%some_uuid%&AWSAccessKeyId=%amazon_access_key%&Expires=%expires%&Signature=%siganture% 
```

和http

```
 http://api.soundcloud.com/tracks/82686108/stream?client_id=YOUR_CLIENT_ID 
 // will redirect you to  
 http://ec-media.soundcloud.com/SQyhrPCMQJyQ.128.mp3?%some_uuid%&AWSAccessKeyId=%amazon_access_key%&Expires=%expires%&Signature=%siganture% 
```

# ravendb - RavenDB 复制问题 - 找不到数据库

> ID：15305678
> 
> 赞同：1
> 
> 时间：2013-03-09T00:28:18.643
> 
> 标签：ravendb

已遵循文档，但无法通过 WAN 为 RavenDB 进行复制。

设想：

*   使用 Raven 构建 #2261
*   Master DB：本地名称为“it23”
*   从数据库：有一个远程名称“ [http://184.169.xxx.xxx](http://184.169.xxx.xxx) ”（xxx 是为了隐私）

在两台服务器上，我都创建了一个名为“TonyTest”的数据库。

在主数据库上，我使用以下文档设置了复制：

```
{
  "Destinations": [
    {
      "Url": "http://184.169.xxx.xxx:8080",
      "Username": null,
      "Password": null,
      "Domain": null,
      "ApiKey": null,
      "Database": "TonyTest",
      "TransitiveReplicationBehavior": "None",
      "IgnoredClient": false,
      "Disabled": false,
      "ClientVisibleUrl": null
    }
  ]
} 
```

当使用相同的 URL 浏览远程服务器时：[http://184.169.xxx.xxx:8080](http://184.169.xxx.xxx:8080)，RavenDB 工作室正确启动，我可以看到 TestTony 数据库。这似乎证实了 URL 的格式正确。

但是，主数据库会立即生成一个显示失败的文档：

```
{   
  "Destination": "http://184.169.xxx.xxx:8080/databases/TonyTest",  
  "FailureCount": 142 
} 
```

当我们查看远程数据库的日志时，我们看到与主数据库有通信，但复制没有完成。

```
Debug   3/9/2013 12:19:44 AM    Document with key 'Raven/Replication/Sources/http://it23:8080/databases/TonyTest' was not found     Raven.Storage.Esent.StorageActions.DocumentStorageActions 
```

看起来远程服务器说找不到数据库“TonyTest”，但它已创建。

谁能发现我的错误？

根据 Ayende 的要求，以下是尝试设置复制后来自 LOCAL 服务器的一些日志示例（我再次将 IP 替换为 xxx 以保护隐私）。我们在 LOCAL db 的日志中看不到任何错误。我们确实在远程数据库日志中看到了错误弹出。这似乎暗示 LOCAL db 正在连接到 REMOTE db，但不会发生复制。以下是本地日志：

```
Debug   3/11/2013 3:17:00 PM    No work was found, workerWorkCounter: 17626, for: ReducingExecuter, will wait for additional work       Raven.Database.Indexing.WorkContext
Debug   3/11/2013 3:17:00 PM    Going to index 1 documents in IndexName: Raven/DocumentsByEntityName, LastIndexedEtag: 00000001-0000-0100-0000-000000002265: (Raven/Replication/Destinations/184.169.xxx.xxx8080databasesTonyTest)      Raven.Database.Indexing.AbstractIndexingExecuter
Debug   3/11/2013 3:17:00 PM    Document with key 'Raven/Studio/PriorityColumns' was not found      Raven.Storage.Esent.StorageActions.DocumentStorageActions
Debug   3/11/2013 3:16:56 PM    Going to index 1 documents in IndexName: Raven/DocumentsByEntityName, LastIndexedEtag: 00000001-0000-0100-0000-000000002256: (Raven/Replication/Destinations/184.169.xxx.xxx8080databasesTonyTest)      Raven.Database.Indexing.AbstractIndexingExecuter 
```

更新 3/11 8:24p 太平洋时间我现在在 MASTER/Local raven 日志中看到以下错误：

未能关闭响应

```
System.AggregateException: One or more errors occurred. ---> System.Net.HttpListenerException: An operation was attempted on a nonexistent network connection
   at System.Net.HttpResponseStream.Dispose(Boolean disposing)
   at System.IO.Stream.Close()
   at Raven.Database.Util.Streams.BufferPoolStream.Dispose(Boolean disposing) in c:\Builds\RavenDB-Stable\Raven.Database\Util\Streams\BufferPoolStream.cs:line 144
   at System.IO.Stream.Close()
   at Raven.Database.Impl.ExceptionAggregator.Execute(Action action) in c:\Builds\RavenDB-Stable\Raven.Database\Impl\ExceptionAggregator.cs:line 23
   --- End of inner exception stack trace ---
   at Raven.Database.Impl.ExceptionAggregator.ThrowIfNeeded() in c:\Builds\RavenDB-Stable\Raven.Database\Impl\ExceptionAggregator.cs:line 38
   at Raven.Database.Server.Abstractions.HttpListenerResponseAdapter.Close() in c:\Builds\RavenDB-Stable\Raven.Database\Server\Abstractions\HttpListenerResponseAdapter.cs:line 94
   at Raven.Database.Server.Abstractions.HttpListenerContextAdpater.FinalizeResponse() in c:\Builds\RavenDB-Stable\Raven.Database\Server\Abstractions\HttpListenerContextAdpater.cs:line 92
---> (Inner Exception #0) System.Net.HttpListenerException (0x80004005): An operation was attempted on a nonexistent network connection
   at System.Net.HttpResponseStream.Dispose(Boolean disposing)
   at System.IO.Stream.Close()
   at Raven.Database.Util.Streams.BufferPoolStream.Dispose(Boolean disposing) in c:\Builds\RavenDB-Stable\Raven.Database\Util\Streams\BufferPoolStream.cs:line 144
   at System.IO.Stream.Close()
   at Raven.Database.Impl.ExceptionAggregator.Execute(Action action) in c:\Builds\RavenDB-Stable\Raven.Database\Impl\ExceptionAggregator.cs:line 23<--- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T02:45:34.807

解决了这个问题。虽然我不明白为什么。

在 SLAVE 服务器上，您必须将 raven.server.exe 配置文件设置为具有以下键：

```
<add key="Raven/AnonymousAccess" value="All"/> 
```

默认是

```
<add key="Raven/AnonymousAccess" value="Get"/>. 
```

当 master 和 slave 在同一台机器上时，默认值工作正常。但是当主服务器和从服务器在不同的机器上时（无论是在 LAN 上，还是在 WAN 上），复制失败。

我永远无法在 master 上找到指向他的问题的日志条目。我能看到的唯一日志条目是从服务器上说找不到 Raven/Replication/Sources/。我意识到主服务器正在连接从服务器，但从服务器无法远程创建“Raven/Replication/Sources/”文档。

# java - Maven 和 Eclipse：向项目添加非 Maven 或外部 jar 的可靠方法？

> ID：15305679
> 
> 赞同：31
> 
> 时间：2013-03-09T00:28:19.833
> 
> 标签：java, eclipse, maven, m2eclipse, m2e

马文很棒。通过在配置中指定依赖包的版本，它主要让我远离 jar 依赖地狱`pom`，并自动应用它们。它还通过 m2e 与 Eclipse 进行了很好的集成，因此可以在 IDE 中无缝运行。

这对于 Maven 全局已知的依赖项来说非常有用。但是，有时，有些库需要包含在 Maven 存储库中不可用的项目中。在这种情况下，我通常将它们添加到`lib/`我项目中的目录中。只要它们在类路径中，就可以编译。

但是，问题是在导入项目时自动包含它们。长期以来，我一直在通过半生不熟的修复和黑客攻击来容忍这个问题。每次有人安装这个项目时，我都必须告诉他们手动将 jar 添加`lib/`到他们的 Eclipse 构建路径中，以便所有错误都消失。类似于以下内容：

![在此处输入图像描述](../Images/41061bf4e716894b44e0122f5c94bf76.png)

我正在寻找一种方法来自动化这个过程，这种方法既适用于`mvn`命令行程序，也适用于 Eclipse：更多的是强调 Eclipse，因为有项目在导入时就可以编译是件好事。

**我不想为此设置一个 repo 服务器，我也没有任何内部专有组件可以保证在本地设置任何东西。我只有一些开发人员不使用 Maven 的 jar 文件；我想和他们一起编译......我应该能够将它们包含在我的软件分发中，对吗？**

我真的在寻找一种合理的方法来实现这一点，它也可以在 Eclipse 中毫不费力地工作。[这是](http://charlie.cu.cc/2012/06/how-add-external-libraries-maven/)我发现有希望的一种解决方案，但似乎绝对没有针对此问题的权威解决方案。唯一接近的另一件事是[maven-addjars-plugin](http://code.google.com/p/addjars-maven-plugin/)，它可以正常工作，但只能在命令行上使用。这个插件还不错，配置也很合理：

```
<plugin>
    <groupId>com.googlecode.addjars-maven-plugin</groupId>
    <artifactId>addjars-maven-plugin</artifactId>
    <version>1.0.5</version>
    <executions>
        <execution>
            <goals>
                <goal>add-jars</goal>
            </goals>
            <configuration>
                <resources>
                    <resource>
                        <directory>${project.basedir}/lib/java-aws-mturk</directory>
                    </resource>
                    <resource>
                        <directory>${project.basedir}/lib/not-in-maven</directory>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

然而，试图让它在 Eclipse 中运行涉及将以下关于生命周期映射的混乱添加到您的`pom.xml`. 我什至不认为它被配置为实际向 Eclipse 构建路径添加任何内容。

```
<pluginManagement>
    <plugins>
        <!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself.-->
        <plugin>
            <groupId>org.eclipse.m2e</groupId>
            <artifactId>lifecycle-mapping</artifactId>
            <version>1.0.0</version>
            <configuration>
                <lifecycleMappingMetadata>
                    <pluginExecutions>
                        <pluginExecution>
                            <pluginExecutionFilter>
                                <groupId>
                                    com.googlecode.addjars-maven-plugin
                                </groupId>
                                <artifactId>
                                    addjars-maven-plugin
                                </artifactId>
                                <versionRange>
                                    [1.0.5,)
                                </versionRange>
                                <goals>
                                    <goal>add-jars</goal>
                                </goals>
                            </pluginExecutionFilter>
                            <action>
                                <execute />
                            </action>
                        </pluginExecution>
                    </pluginExecutions>
                </lifecycleMappingMetadata>
            </configuration>
        </plugin>
    </plugins>
</pluginManagement> 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-09T02:11:53.127

1）您可以使用系统范围依赖

```
 <dependency>
        <groupId>test</groupId>
        <artifactId>x</artifactId>
        <version>1.0</version>
        <scope>system</scope>
        <systemPath>${basedir}/lib/x.jar</systemPath>
    </dependency> 
```

2）您可以将您的 x.jar 复制到本地 maven 存储库

存储库/test/x/1.0/x-1.0.jar

并将依赖项添加为

```
 <dependency>
        <groupId>test</groupId>
        <artifactId>x</artifactId>
        <version>1.0</version>
    </dependency> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-09T01:13:19.150

您可以使用 maven 使用 maven-install-plugin 将文件从 project\lib 文件夹安装到本地 repo，如下所示。我以前用 JDBC 驱动程序做过这个。您可能必须为它创建一个单独的 pom 并使用 mvn -f installdeps.pom 或类似的东西执行它。

如果你能让它玩得很好并与 validate 之类的生命周期绑定，那么你可以将 m2e 插件与 Eclipse 一起使用，它可能会玩得很好并直接从 pom.xml 读取依赖项并根据需要将 jar 安装到本地回购。

```
 <plugin>
        <!-- We dont want children attempting to install these jars to the repo. -->
        <inherited>false</inherited>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-install-plugin</artifactId>
        <executions>
            <execution>
                <id>Microsoft JDBC Driver File 1</id>
                <phase>install</phase>
                <goals>
                    <goal>install-file</goal>
                </goals>
                <configuration>
                    <file>lib/sqljdbc4.jar</file>
                    <groupId>com.microsoft</groupId>
                    <artifactId>microsoft-jdbc-driver</artifactId>
                    <version>4.0</version>
                    <packaging>jar</packaging>
                </configuration>
            </execution>
            <execution>
                <id>ojdbc5</id>
                <phase>install</phase>
                <goals>
                    <goal>install-file</goal>
                </goals>
                <configuration>
                    <file>lib/ojdbc5.jar</file>
                    <groupId>com.oracle</groupId>
                    <artifactId>ojdbc5</artifactId>
                    <version>11.1.2</version>
                    <packaging>jar</packaging>
                </configuration>
            </execution>
        </executions>
    </plugin> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T01:12:52.880

在我看来，您可以使用[Maven 资源插件](http://maven.apache.org/plugins/maven-resources-plugin/)为您执行此操作。只需将资源的复制绑定到适当的生命周期阶段（编译之前的阶段）。您很可能需要调整 maven-compiler-plugin 以便这些库在编译和运行时位于类路径中。

# ios - ios 的 web 应用程序可以像原生一样流畅地运行吗？

> ID：15305683
> 
> 赞同：0
> 
> 时间：2013-03-09T00:28:48.457
> 
> 标签：ios, html, sencha-touch

是否有一个框架可以为 iOS 创建与原生应用程序一样流畅的 Web 应用程序？

我已经在我的 iPad 上查看了 Sencha Touch [http://www.sencha.com/products/touch](http://www.sencha.com/products/touch)的演示，触摸事件和识别它们的精确度有明显的延迟。这种感觉与原生应用程序不同。

是否有其他框架或技术可以提供与原生应用程序相同的体验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:31:26.920

这取决于您的应用程序。如果您的应用程序是一款硬核重型 3D 游戏，那么不会。如果您的应用主要显示静态内容……例如网页或照片集，那么您可能已经足够接近了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T00:38:20.097

想想你首先想要获得什么样的体验。如果你想要一个跨平台的应用程序并且你想避开商店（App Store、Google Play、BB App World），那么一定要考虑一个网络应用程序。

其他要考虑的事情，您估计用户需要在本地存储多少数据（HTML 应用程序在这方面受到更多限制）；没有网络连接时会丢失多少功能，并且这种功能丢失是否会使应用程序无法使用。

就像@RichardTurner 的回答一样，如果您需要在高端游戏（Infinity Blade 或 Modern Combat 3）中找到的那种性能，那么原生就是要走的路。

弄清楚你想要什么，然后你就会更好地了解要使用什么技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T02:07:22.723

不。原生应用每次都会比 Web 应用表现得更好。如果您想要流畅的体验，请选择原生。还要考虑到有些人拥有旧型号的 iOS 设备，并且在 Web 应用程序中在这些设备上实现性能将更加困难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-29T22:28:13.577

以下是 Sencha 应用程序与本机应用程序要考虑的一些事项。

1.  您正在在线浏览 Sencha Touch 应用程序，很可能它不是“打包”版本，因此您必须单独下载每个源文件。

2.  使用 Sencha，您可以利用 Sencha CMD 打包一个应用程序，该应用程序本质上构建一个单一的缩小 js 文件，其中仅包含 Sencha 库和您的应用程序（较小的 DOM）中所需的组件。您还可以查看利用 appcache 的生产版本。您会在这里看到一些性能提升。

3.  打包的原生 Touch 应用程序将包含实际的 JS、CSS 等文件作为应用程序源的一部分，因此无法从外部资源下载它们。

4.  您必须考虑到任何 HTML5 应用程序都会有约 300 毫秒的触摸延迟，更多信息请参见：http: [//updates.html5rocks.com/2013/12/300ms-tap-delay-gone-away](http://updates.html5rocks.com/2013/12/300ms-tap-delay-gone-away)

# php - 可以用jquery会话变量吗？调用一个php

> ID：15305687
> 
> 赞同：0
> 
> 时间：2013-03-09T00:29:02.010
> 
> 标签：php, javascript, jquery, ajax, json

我正在努力提高我的英语

我有一个 js 外观，通过 post 发送甚至 php 值，而这些值又将这些值存储在 php 变量中我显示我的文件或从中提取

index.html HTML 代码：

```
<!DOCTYPE HTML>
<html>
<head>
   <meta http-equiv="content-type" content="text/html" />
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    <script>
$(document).ready(function () {
     $('.add-music').click(function () {
         var songNew = JSON.stringify({
             title: $(this).attr('data-title'),
             artist: $(this).attr('data-artist'),
             mp3: $(this).attr('href')
         });
         var songIE = {json:songNew};
         $.ajax({
             type: 'POST',
             data: songIE,
             datatype: 'json',
             url: 'session.php',
             async: true,
             cache: false
         });
     });
 });
    </script>
</head>
<body>
        <b class="add-music" data-title="chika" data-artist="comppac" href="audios/song-little.mp3">Add to List</b>
        <b class="download-music" href="audios/song-little.mp3">Download</b>

        <b class="add-music" data-title="mediana" data-artist="comppam" href="audios/song-med.mp3">Add to List</b>
        <b class="download-music" href="audios/song-middle.mp3">Download</b>

        <b class="add-music" data-title="grande" data-artist="comppag" href="audios/song-big.mp3">Add to List</b>
        <b class="download-music" href="audios/song-big.mp3">Download</b>
</body>
</html> 
```

session.php PHP 代码：

```
<?php
 if(isset($_POST["json"])){
    $jakson = $_POST["json"];
session_start(); 
$_SESSION["playlist"][] = $jakson;
}
?> 
```

ok 现在我想要一个 index2.html 或 Live index.html 收集播放列表会话变量的内容，我创建一个名为 recoger.php 的测试文件并放入以下内容，以查看 recoger.php 中存储了什么 PHP 代码：

```
<?php 
echo '<pre>';
var_dump($_SESSION);
echo '</pre>';
echo '<br />';
 ?> 
```

并向我展示以下内容

PHP代码：

```
array(1) {
  ["playlist"]=>
  array(4) {
    [0]=>
    string(111) "{"title":"emo","artist":"a href=","mp3":"/audios/01%20-%20Survie.mp3"}"
    [1]=>
    string(158) "{"title":"Las Voces de L@s del Bosque","artist":"","mp3":"/audios/La%20voces%20de%20l%40s%20del%20Bosque%20copy.mp3"}"
    [2]=>
    string(143) "{"title":"radio novela waO1","artist":"","mp3":"/audios/radionovela%20wagia%20final.mp3"}"
    [3]=>
    string(174) "{"title":"o a La Comunicación","artist":"","mp3":"/audios/Cun%CC%83aunicacion.mp3"}"
  } 
```

我如何使用 jquery ajax 活髓每次单击获得这些结果，并将值添加到立即收听此节目的其他 ajax 会话的变量数组中

欢迎任何想法帮助谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:57:50.957

创建ajax调用

```
...
$.ajax('getSession.php', {...}, function(response){
...
});
... 
```

到您的 getSession.php 文件，即

```
<?php 
// some code
echo json_encode($_SESSION['playlist']) ; 
```

所以在ajax回调正文中使用变量响应将是你的`$_SESSION['playlist'];`

# python - 尽管 __debug__ 为 True，但条件 __debug__ 语句未执行

> ID：15305688
> 
> 赞同：10
> 
> 时间：2013-03-09T00:29:05.167
> 
> 标签：python, debugging, iis-7, python-ldap

**简洁版本**

我有一段正在调试的代码，它检查它的值`__debug__`并在它为 True 时执行一些代码。

```
if __debug__:
  <stuff happens> 
```

问题是“东西”永远不会发生，即使`__debug__`看起来是真的。

**长版/详情**

为了检查这一点，我正在`__debug__`使用以下模式在函数执行时将几个变量的值打印到文件中，最值得注意的是。（我正在使用`os.open`，因为`open`已在此模块中定义。）

```
try:
  myfile = os.open("test.txt", os.O_RDWR|os.O_CREAT|os.O_APPEND)
  # work + some print statements to check the value of __DEBUG__
finally:
  os.close(myfile) 
```

我最困惑的一段代码如下所示：

```
os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, __debug__))
os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, type(__debug__)))
os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, bool(__debug__)))
if __debug__:
  os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, __debug__))
if bool(__debug__):
  os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, __debug__))
if True:
  os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, __debug__))
if __debug__:
  os.write(myfile, "LINE %s | LDAP FUNCTION __DEBUG__: %s \n" %(sys._getframe(0).f_lineno, __debug__)) 
```

输出文件如下所示：

```
LINE 82 | LDAP FUNCTION __DEBUG__: True 
LINE 83 | LDAP FUNCTION __DEBUG__: <type 'bool'> 
LINE 84 | LDAP FUNCTION __DEBUG__: True 
LINE 88 | LDAP FUNCTION __DEBUG__: True 
LINE 90 | LDAP FUNCTION __DEBUG__: True 
```

前 3 条语句（第 82-84 行）是我能想到的检查是否`__debug__`“真实”的所有方式，所有 3 条都暗示那`__debug__`是真实的。同样，转换`__debug__`为布尔值然后评估`if`（第 88 行）也可以按预期工作。第 90 行是一个愚蠢的完整性检查。

`__debug__`在可能导致这种情况的工作方式中，我有什么遗漏吗？

*注意*：我在处理模块中的`_ldap_function_call`函数时遇到的错误时发现了这一点。`python-ldap`我只在使用 IIS 时收到此错误 - 在 Django 的开发服务器上一切正常。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-09T01:04:54.370

如果你重新绑定`__debug__`，它可能会导致完全像这样的症状。

这是因为`__debug__`有点神奇。在模块编译期间，处理文字的相同代码也处理魔术常量`...`、`None`、`True`、`False`和`__debug__`。（例如，参见[`expr_constant`](http://hg.python.org/cpython/file/2.7/Python/compile.c#l3184)。）

如果您`dis`在代码上运行以转储字节码，您会看到`if __debug__:`语句要么被完全删除，要么`LOAD_CONST`用于加载编译时常量`debug`，而`if bool(__debug__):`语句用于`LOAD_GLOBAL`加载`__debug__`.

当然，这些保证是相同的……除非你重新绑定`__debug__`。在 2.3 左右的某个地方，只写`__debug__ = False`. 在 2.7 和 3.0 中，绑定*任何*名为 的属性是非法的`__debug__`，这意味着你不能再做类似`sys.modules[__name__].__debug__ = False`. 但是您仍然可以这样做，例如`globals()['__debug__'] = False`.

无论哪种方式，您都会得到相同的效果：

```
if __debug__:
    print "debug"
if bool(__debug__):
    print "bool"

import sys
sys.modules[__name__].__debug__ = False

if __debug__:
    print "debug2"
if bool(__debug__):
    print "bool2" 
```

这打印出来：

```
debug
bool
debug2 
```

同样对于在运行时将其设置为 True 的代码`python -O`。

# javascript - 使用 javascript 子字符串指定字符长度

> ID：15305691
> 
> 赞同：1
> 
> 时间：2013-03-09T00:29:48.567
> 
> 标签：javascript, html

我的网页上有一个标题，我想限制为一定数量的字符。标题用于博客文章，因此标题会更改。这基本上是我想要完成的。

```
<body>

   <script>
    var x= document.getElementById("entry-title");
    document.write(x.substring(0,10));
   <script> 

    <h1 id="entry-title">This is a sample blog title</h1>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:32:18.720

试试看

```
 <body>

   <script>
   window.onload = 
   function (){
    var x= document.getElementById("entry-title");
    x.innerText = x.innerText.substring(0,10);
    }
   </script> 

    <h1 id="entry-title">This is a sample blog title</h1>

</body> 
```

那里有jquery的代码

```
<html>
<head>
<script src="http://code.jquery.com/jquery-1.9.1.min.js" ></script>
</head>
<body>

   <script>

       $(document).ready(

       function (){
           var text = $("#entry-title").text();
           var x= $("#entry-title").text(text.substring(0,10));
       }
    );
   </script> 

    <h1 id="entry-title">This is a sample blog title</h1>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:43:38.497

```
<h1 id="entry-title">This is a sample blog title</h1>
<script>
(function() {
    var el = document.getElementById("entry-title"),
        supportedProp = el.textContent != null ? 'textContent' : 'innerText';

    el[supportedProp] = el[supportedProp].substring(0, 10);
}());
</script> 
```

[**演示**](http://jsbin.com/ahoyob/2/edit)

您必须将脚本放在要引用的元素下方，或者使用`DOMContentLoaded`或窗口`load`事件处理程序延迟其执行。

此外，W3C 标准属性`textContent`代替了 IE 的专有（并被 Chrome 采用）`innerText`属性。因此，如果要同时支持 Firefox 和 IE，则需要进行一些功能检测。Chrome 接受任一属性。

# objective-c - 为什么这段代码不绘制白色文本？

> ID：15305692
> 
> 赞同：0
> 
> 时间：2013-03-09T00:29:48.677
> 
> 标签：objective-c, cocoa

此代码不绘制白色文本，为什么？

```
NSMutableParagraphStyle* style = [[NSMutableParagraphStyle alloc] init];
[style setAlignment:NSCenterTextAlignment];
NSFont *font = [NSFont fontWithName:@"System" size:13];
NSDictionary *attrs = [NSDictionary dictionaryWithObjectsAndKeys:style, NSParagraphStyleAttributeName, font, NSFontAttributeName, [NSColor whiteColor], NSForegroundColorAttributeName, nil];

[button.title drawInRect:textRect withAttributes:attrs]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:37:34.513

[(Assuming the [cocoa] tag doesn't mean cocoa touch)]

It's because NSButton is likely overriding the choice you've made to draw it's text in when it's `-drawRect:` gets called again. You can apply the attributes you've given in that dictionary to an NSAttributedString and call `setAttributedTitle:` to keep your style choices around.

If you need more fine-grain control over text rendering, either edit and move your logic into `-drawRect:` if it isn't already there, or provide an NSTextField or NSTextView as appropriate.

The main problem with the code you've provided is that @"System" isn't a font name.

# javascript - 如何编写onclick函数以防止冒泡

> ID：15305695
> 
> 赞同：0
> 
> 时间：2013-03-09T00:30:11.593
> 
> 标签：javascript, jquery, event-bubbling

晚上的家伙，我有一个问题，其中有一个`<td>`标签和一个`<p>`标签，两者都有 onclick 事件，这是`<p>`onclick 运行`<td>`onclick 而不是它自己的教科书情况。根据我在这里和其他地方的研究，我了解到这是由冒泡引起的。然而，显然知道只是成功的一半，因为我似乎无法找到解决此问题的方法。这是我目前正在尝试解决的方法

html:

```
<table>
    <tr>
        <td>
            <p>text</p>
        </td>
    </tr>
</table> 
```

jQuery：

```
$(function(){
var show = function(){
    $('#editentry').css({'display': 'block'}); //this is column 3
}
//run var show on click
$('td p').click(function(event){
    show;
    event.stopPropagation();//stop bubbling
});
});//end function 
```

我也试过这个：

```
$(function(){
var show = function(event){
    $('#editentry').css({'display': 'block'}); //this is column 3
    event.stopPropagation();
}
//run var show on click
     $('td p').click(show);
});//end function 
```

据我了解，这应该可以工作，抱歉，如果我错过了一些简单的事情，我对 jquery 有点陌生，这似乎是一个复杂的主题。提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:47:19.863

你所拥有的应该可以正常工作。这正是您使用`stopPropagation`.

这是一个示例，显示它如何阻止事件冒泡：

HTML：

```
<table>
  <tr>
    <td>
        <p>inside paragraph</p> outside paragraph
    </td>
  </tr>
</table> 
```

Javascript：

```
$(function(){

  $('td').click(function(event){
    alert('cell');
  });
  $('td p').click(function(event){
    event.stopPropagation();
    alert('paragraph');
  });
}); 
```

演示：http: [//jsfiddle.net/39n5X/](http://jsfiddle.net/39n5X/)

如果您单击“段落内”，它将仅显示“段落”消息，如果您单击“段落外”，它将显示“单元格”消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:34:59.027

尝试用这个替换你的停止冒泡线：

```
event.preventDefault ? event.preventDefault() : (event.returnValue=false);
event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true); 
```

# powershell - 从 Powershell 以管理员身份运行 .bat 文件

> ID：15305696
> 
> 赞同：0
> 
> 时间：2013-03-09T00:30:13.497
> 
> 标签：powershell

所以我一直在这一个上旋转我的轮子。我正在 powershell gui 中创建一个小型应用程序，它需要通过传递从文本框中输入的凭据来运行 .bat。我一直试图弄清楚当在 GUI 上单击按钮时如何传递这些凭据。

我在 GUI 上有两个框，用户在那里传递凭据。

```
$userTextBox.Text
$passwordTextBox.Text 
```

然后，当单击按钮时，.bat 文件需要以用户\密码运行。下面的代码更像是伪代码，因为此时我不确定如何执行此操作。我在网上和野生动物园书籍上看过，但我找不到一个例子。我确实找到了一个，但它正在做一些不同的事情，我不明白。

```
$StartButton.Add_Click({Start-Process 
runas $userTextBox.Text\$passwordTextBox.Textc:\temp\Scripts\MapCopyTuner.bat
}) 
```

任何帮助都非常感谢，因为你可以说我在这里很环保。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T02:11:56.163

您需要将用户名\密码转换为 PSCredential，并将其传递给 Start-Process

这是一个示例 powershell 片段（如果您愿意，可以通过内联变量来减少冗长）。

```
$password= convertto-securestring $passwordTextBox.Text -asplaintext –force
$credential = new-object -typename System.Management.Automation.PSCredential -argumentlist $userTextBox.Text,$password
$script = "c:\temp\Scripts\MapCopyTuner.bat"
Start-Process powershell -Credential $credential -ArgumentList "-noprofile -command &{Start-Process $script -verb runas}" 
```

# asp.net - 301 重定向适用于本地计算机，但不适用于实时服务器（Asp.Net）

> ID：15305699
> 
> 赞同：0
> 
> 时间：2013-03-09T00:30:45.647
> 
> 标签：asp.net, iis, redirect

我需要对某些页面进行 301 重定向，并在 application_beginRequest() 的 global.asax 中添加了代码。它在我的本地机器上运行良好。当我在实时服务器上更新站点的 dll 时，它不起作用。有任何想法吗？会不会是 IIS 服务器配置？

我在本地使用 VS2012 和 Asp.Net Webforms 3.5 Framework。

```
 protected void Application_BeginRequest(object sender, EventArgs e)
    {
        string path = HttpContext.Current.Request.Url.AbsolutePath;

        if (path.EndsWith(".xml") || !path.Contains("."))
        {
            RedirectOldPages(path);
        }
    }

    private void RedirectOldPages(string path)
    {

        //PagesToBeRedirected is a static class with a dictionary in it
        if (PagesToBeRedirected.RedirectPages.ContainsKey(path))
        {
            //301 Permanent Redirect Page
            Response.Redirect(PagesToBeRedirected.RedirectPages[path], false);
            Response.StatusCode = (int)HttpStatusCode.MovedPermanently;
            CompleteRequest();
        }

     } 
```

# ruby-on-rails - 从 ruby on rails 中的数据库字段下拉

> ID：15305704
> 
> 赞同：0
> 
> 时间：2013-03-09T00:31:27.583
> 
> 标签：ruby-on-rails, ruby

我正在尝试从数据库字段创建一个下拉列表，`product.color_available`其数据存储为逗号分隔的形式，例如`color_available="red,blue,green"`for`product_id=10`

希望上面的解释是有道理的。我想显示下拉菜单，用户应该能够选择颜色并将其添加到购物车。我不想将我的选项存储在传递外键的不同表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:19:35.350

要获得一个数组，您可以这样做`color_available.split(",")`，这将为您提供一个由逗号分隔的所有值的数组。然后，在您的视图中，包含一个`select_tag`或`f.select`（如果您使用的是表单构建器）并将数组作为您的集合传递。

# excel - 从任务计划程序启动 excel 正在工作，现在失败

> ID：15305707
> 
> 赞同：9
> 
> 时间：2013-03-09T00:31:49.623
> 
> 标签：excel, vba, vbscript, scheduled-tasks, wsh

我已经使用任务计划程序和 cscript 和 vbscript 运行我的 excel 2000 vba 程序大约一年了。几天前它停止了工作。我可以手动运行程序。每当任务计划程序启动它时，黑色窗口会显示大约 1-2 秒，然后关闭。

我试过注释掉错误处理，但我总是得到相同的结果。我尝试显示`MsgBoxes`，但结果仍然相同。

我在您的论坛上找到了一种更简单的方法，并且我尝试了相同的结果。

那么我需要做什么来调试呢？

这是我从这个论坛尝试的代码：

```
Option Explicit

Dim xlApp, xlBook

Set xlApp = CreateObject("Excel.Application")
'~~> Change Path here
Set xlBook = xlApp.Workbooks.Open("C:\My Documents\___Stocksfilter.xls", 0, True)
xlApp.Run "A_Pick"
xlBook.Close
xlApp.Quit

Set xlBook = Nothing
Set xlApp = Nothing

WScript.Echo "Finished."
WScript.Quit 
```

这是我一直在使用的代码：

```
'Script to start my filter.xls program with named macro
'MsgBox "In RunExcel"

' Create an Excel instance
Dim myExcelWorker
Set myExcelWorker = CreateObject("Excel.Application") 

' Disable Excel UI elements
myExcelWorker.DisplayAlerts = False
myExcelWorker.AskToUpdateLinks = False
myExcelWorker.AlertBeforeOverwriting = False
myExcelWorker.FeatureInstall = msoFeatureInstallNone

' Open the Workbook 
Dim oWorkBook
Dim strWorkerWB
strWorkerWB = "C:\My Documents\___Stocks\filter.xls"

'MsgBox "Opening filter"

on error resume next 
Set oWorkBook = myExcelWorker.Workbooks.Open(strWorkerWB)
if err.number <> 0 Then
    ' Error occurred - just close it down.
    MsgBox "open Error occurred"
End If
err.clear
on error goto 0 

'MsgBox "Running macro"

Dim strMacroName
strMacroName = "A_Pick"
on error resume next 
' Run the macro
myExcelWorker.Run strMacroName
if err.number <> 0 Then
    ' Error occurred - just close it down.
    MsgBox "run macro Error occurred"
End If
err.clear
on error goto 0 

' Clean up and shut down
Set oWorkBook = Nothing
myExcelWorker.Quit
Set myExcelWorker = Nothing
Set WshShell = Nothing 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T19:16:53.180

解决了！首先我做了一个运行命令并使用了 wscript。也可以按照 joseph4tw 的建议使用 cscript /I，但我不知道。

这向我显示了它找不到 VBScript 引擎的错误。我在互联网上查看，vbscript.dll 应该在我的 98 计算机的 Windows/系统文件中。它不在那里。我找到了网站 www.dll-files.com 并下载了该文件。然后我重新启动。然后我执行了一个运行命令来安装它，如下所示：运行 regsvr32 vbscript.dll。它给出了一个成功的信息，现在它可以工作了。

我相信这是由恶意软件引起的。我无法从我的 98 计算机上删除恶意软件，因为我无法运行任何较新的防病毒软件。

由于我的新 XP 计算机，我正在制作磁盘映像并使用 linux 恢复 CD。那个linux，我想会在98上运行，我希望我可以运行杀毒软件来清理那台电脑。

感谢大家的帮助，因为它使我找到了解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T22:29:47.607

我将在这里大胆猜测。

“*它在我运行 cscript 时有效，但在任务运行时无效*”让我认为这是一个权限问题。当您设置 Windows 计划任务时，您应该能够将其设置为以特定用户身份运行（并且还可以设置在用户未登录时是否运行）。我不确定 Win 98，但你能找出任务属性的含义吗？当您自己运行代码时，会使用*您的*权限，并且计划任务可能正在使用无权运行它的用户。

如果您不进行任何更改，怎么会发生这种情况？我唯一能想到的是：

1.  计划任务使用的用户已不存在或权限发生变化
2.  用户有密码到期日期，最近已过
3.  如果计划任务使用您的用户名，您是否将密码保存在任务属性中，然后最近更改了密码，但没有更新计划任务的密码？

此外，某些防病毒产品会停止使用某些 vbscript。你有没有可能在它停止工作之前安装任何新东西？

检查错误可能来自哪里（希望这可行，因为我对 Win98 机器不是很熟悉）：

1.  找出哪个用户被设置为运行计划任务
2.  以另一个用户身份启动命令提示符（我认为它是 Shift+右键单击 --> 运行方式... [注意，我不了解 Windows 98，所以我祈祷你能做到这一点]）
3.  从命令提示符运行 cscript：（`C:\>cscript <dir>\myscript.extension \I`注意，`\I`是交互模式，它应该显示错误（[有关更多信息，请参见此处](http://technet.microsoft.com/en-us/library/ff920171%28v=ws.10%29.aspx)）

我真的希望这会有所帮助。我会把它放在评论中，但它的文字太多了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-11T10:30:10.673

我刚刚遇到了同样的问题。

我制作了一个 .bat 文件，我在其中调用了 .exe 文件。

```
call filelocation/application.exe 
```

最后，我从任务调度程序操作中调用了 .bat 文件。

它工作正常。

# jquery - 使用 Spring Mvc 从服务器加载图像时如何创建进度条

> ID：15305710
> 
> 赞同：1
> 
> 时间：2013-03-09T00:31:57.470
> 
> 标签：jquery, ajax, spring, jsp, progress-bar

我正在尝试在我的 JSP 文件中插入一个进度条（它不需要显示下载了多少文件直到现在，它只需要显示页面正在等待加载），而文件是加载。我已经看到这个网站要创建和 .git 这将是我的进度条。

[http://preloaders.net/](http://preloaders.net/)

我正在使用以下方法从 Spring 服务器中检索图像：

```
<img class="ImgMapa" alt="${andar.caminhoImagem}" src="UploadServlet?getfile=${andar.nomeImagem}" /> 
```

当我单击链接时，从服务器检索此图像。

```
<a href="#${andar.numero}" class="btn btn-primary" data-toggle="tab">${andar.numero}º Andar</a> 
```

我如何知道图像何时通过 jQuery 完全下载？这样我可以显示进度条 GIF，然后，当图像加载时，我可以隐藏它。

有更好的方法吗？如果没有，我如何使用这个想法在下载图像时显示 GIF？

编辑：

这是我获取图像的方法：

```
 @RequestMapping("UploadServlet")
        public void doGet(HttpServletRequest request,
                HttpServletResponse response) throws ServletException, IOException {
if (request.getParameter("getfile") != null
                    && !request.getParameter("getfile").isEmpty()) {
                File file = new File(request.getServletContext().getRealPath("/")
                        + "resources/imgs/" + request.getParameter("getfile"));
                if (file.exists()) {
                    int bytes = 0;
                    ServletOutputStream op = response.getOutputStream();

                    response.setContentType(getMimeType(file));
                    response.setContentLength((int) file.length());
                    response.setHeader("Content-Disposition", "inline; filename=\""
                            + file.getName() + "\"");

                    byte[] bbuf = new byte[1024];
                    DataInputStream in = new DataInputStream(new FileInputStream(
                            file));

                    while ((in != null) && ((bytes = in.read(bbuf)) != -1)) {
                        op.write(bbuf, 0, bytes);
                    }

                    in.close();
                    op.flush();
                    op.close();
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:21:19.437

您的进度条可能看起来像这样：

```
<img id="progressBar" style="display:none;" src="...../loading.gif"> 
```

所以

```
jQuery(function () {
    $('a.btn-primary').click(function () {
        $('#progressBar').show();
    });
    $('img.ImgMapa').load(function () {
        $('#progressBar').hide();
    });
}); 
```

不知道您使用的是什么版本的 jQuery，但`.load()`最近被贬低了。

所以如果最新版本：

```
$('img.ImgMapa').on('load',function () {
    $('#progressBar').hide();
}); 
```

试试这个，也许该节点在页面 init 上不存在

```
$(document).on('load','img.ImgMapa', function () {
   $('#progressBar').hide();
}); 
```

您可以`document`用图像中最接近的父级进行替换以获得更好的性能。

# java - 通过对 Swing 表的数据修改生成 SQL

> ID：15305712
> 
> 赞同：1
> 
> 时间：2013-03-09T00:32:03.807
> 
> 标签：java, sql, jdbc

我想构建一个 jdbc 客户端工具。它将在 Swing 表中显示 select 查询返回的数据，并允许用户编辑表上的数据。我的问题是生成标准 sql 字符串（**插入删除更新**）以将修改保存回数据库的最佳方法是什么？

1.  有没有开放图书馆可以帮助我？
2.  我需要支持mysql、oracle、db2、sysbase、informix等常用数据库。
3.  我需要支持任意 sql 查询，没有使用 ORM 框架。
4.  如果您认为我应该自己做，您有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:07:11.420

1) 你可以使用[Apache Cayenne](http://cayenne.apache.org)

2）支持常用数据库（如mysql、oracle、db2、sysbase、informix）

[http://cayenne.apache.org/docs/3.0/database-support.html](http://cayenne.apache.org/docs/3.0/database-support.html)

3) 您可以使用**SQLTemplate**类来使用任意 SQL 查询。它允许自定义 SQL 方言。

[http://cayenne.apache.org/docs/3.0/sqltemplate-basics.html](http://cayenne.apache.org/docs/3.0/sqltemplate-basics.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:36:49.070

Look into Hibernate (Java)

or

Java DB OBjects

[http://dbobjects.sourceforge.net/](http://dbobjects.sourceforge.net/)

# node.js - 什么是更快的基于事件或基于延迟的处理？

> ID：15305716
> 
> 赞同：0
> 
> 时间：2013-03-09T00:33:24.340
> 
> 标签：node.js, events, nested, deferred, promise

什么更快：

```
Event.once('some_event', function() { // wait until an event fired from somewhere
  defer.resolve('resolved')
})
...
// somewhere else
Event.emit('some_event') 
```

或类似：

```
defer = doSmthDeferred(); // to get the deferred resolved/rejected from somewhere else
...
// somewhere else
doSmthDeferred = function() {
  defer
  if ...
    defer.resolve();
  else
    defer.reject();
} 
```

即：什么是更好的 - 事件处理或嵌套承诺/延迟处理？承诺/延迟是否基于事件处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T13:29:15.997

这几乎是一个红鲱鱼。事件和承诺解决之间的速度差异几乎总是很小。

事件是为经常发生的事情而设计的。例如，请求到达网络服务器或用户单击按钮。当您将它们用于异步操作时，它们会变得混乱，因为它们不能正确支持组合，即很难等待两个事件都发生 Promise 是为异步操作而设计的（例如从服务器请求网页）。它们只能解决一次，因此不适合事件之类的事情。如果您有多个并行或串行发生的异步操作，则 Promise 使组合它们变得非常容易。如果您正在寻找一个好的承诺库，我建议您查看[Q](https://github.com/kriskowal/q)

# xml - 通过应用 xslt 转换从 wxs 文件中删除不需要的节点

> ID：15305718
> 
> 赞同：6
> 
> 时间：2013-03-09T00:33:30.077
> 
> 标签：xml, xslt, wix, heat

我正在尝试通过应用 xml 转换来清理 heat.exe 生成的 wxs 文件。

下面是 heat.exe 的示例文件输出。

```
<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Fragment>
            <DirectoryRef Id="APPFOLDER">
                <Component Id="cmp78E9FF58917B1844F3E9315A285F3147" Guid="SOME-GUID">
                    <File Id="fil093D6D7CB723B5B62730D7B4E575F154" KeyPath="yes" Source="PQR.Some.dll" />
                </Component>
                <Component Id="cmp0B084126FAE7577FD84DB29766AC6C2B" Guid="SOME-GUID">
                    <File Id="filB20C8708D7EB02EDFBCC4D70F9FE7F8A" KeyPath="yes" Source="ABC.Another.dll" />
                </Component>
                <Component Id="cmp83BB1954DECD7D949AAE4ACA68806EC3" Guid="SOME-GUID">
                    <File Id="fil0E29FBFF7DB39F307A2EE19237A0A579" KeyPath="yes" Source="ABC.OneMore.dll" />
                </Component>
            </DirectoryRef>
        </Fragment>
        <Fragment>
            <ComponentGroup Id="AppFiles">
                <ComponentRef Id="cmp78E9FF58917B1844F3E9315A285F3147" />
                <ComponentRef Id="cmp0B084126FAE7577FD84DB29766AC6C2B" />
                <ComponentRef Id="cmp83BB1954DECD7D949AAE4ACA68806EC3" />
            </ComponentGroup>
        </Fragment>
    </Wix> 
```

我想删除其子文件节点具有包含字符串“ABC”的源属性的组件节点。我知道如何使用正确的匹配模式找到这样的节点。因此，在我删除 Component 节点之前，我想存储组件的 Id，然后使用它来删除带有我刚刚记录的 Id 的 ComponentRef 节点。

有没有办法通过 XML 转换来实现这一点？我想我正在寻找可以创建变量“X”来存储我删除的 Component 节点的 Id，并使用“X”来查找要删除的 ComponentRef 节点的东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-09T03:21:29.723

您可以在没有变量的情况下执行此操作。像这样：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:wi="http://schemas.microsoft.com/wix/2006/wi">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:strip-space elements="*"/>
  <xsl:key name="kCompsToRemove"
           match="wi:Component[contains(wi:File/@Source, 'ABC')]"
           use="@Id" />

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="*[self::wi:Component or self::wi:ComponentRef]
                        [key('kCompsToRemove', @Id)]" />
</xsl:stylesheet> 
```

在您的示例输入上运行时，这会产生：

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <DirectoryRef Id="APPFOLDER">
      <Component Id="cmp78E9FF58917B1844F3E9315A285F3147" Guid="SOME-GUID">
        <File Id="fil093D6D7CB723B5B62730D7B4E575F154" KeyPath="yes" Source="PQR.Some.dll" />
      </Component>
    </DirectoryRef>
  </Fragment>
  <Fragment>
    <ComponentGroup Id="AppFiles">
      <ComponentRef Id="cmp78E9FF58917B1844F3E9315A285F3147" />
    </ComponentGroup>
  </Fragment>
</Wix> 
```

# python - 从多个列表中选择组合

> ID：15305719
> 
> 赞同：20
> 
> 时间：2013-03-09T00:33:59.403
> 
> 标签：python, python-2.7

我是 python 新手，我正在努力形成多个列表的组合。所以，我有三个（可能更多）看起来像这样：

```
uk_rock_stars=[1,2,3,4,5,6,7,8,9]
uk_pop_stars=[10,11,12,13,1,4,6,22,81]
us_stars=[22,34,44,7,33,99,22,77,99]
.
. 
```

具有相同长度的所有列表。现在，我想生成它们的组合列表，其中 N 是上面列表的总数。我正在寻找如下结果：

```
comb=[(1,10,22),(1,10,34),(1,10,44)...etc (all combinations)....] 
```

这样，每个组合，比如 (1,10,22) 的长度与原始列表的数量相同（在本例中为 3）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-09T00:44:40.127

阅读这个[http://docs.python.org/2/library/itertools.html#itertools.product](http://docs.python.org/2/library/itertools.html#itertools.product)，它解释了一切。

`itertools`是一个包，它具有大量用于迭代集合的有用功能。一个有用的功能是`product`创建一个生成器的函数，该生成器将迭代你给它的任意数量的可迭代集合的笛卡尔积。

结果`itertools.product`不是列表，而是生成器。python 生成器类似于其他语言中的协程。这意味着它将根据需要计算您的组合。如果您计算三个每个大小为 100 的可迭代对象的乘积，但您只使用前 10 个左右，`itertools.product`则只会计算 10 个组合，而不是计算所有 100^3 个组合。

如果您实际上想要一个列表对象而不是生成器（也许您想要计算切片或其他东西），请调用该`list`函数并将您的生成器对象作为参数传递。

以下代码生成所有组合并打印结果。

**代码：**

```
import itertools

uk_rock_stars=[1,2,3,4,5,6,7,8,9]
uk_pop_stars=[10,11,12,13,1,4,6,22,81]
us_stars=[22,34,44,7,33,99,22,77,99]

for combination in itertools.product(uk_rock_stars, uk_pop_stars, us_stars):
    print combination 
```

**输出：**

```
(1, 10, 22)
(1, 10, 34)
(1, 10, 44)
(1, 10, 7)
(1, 10, 33)
(1, 10, 99)
(1, 10, 22)
(1, 10, 77)
(1, 10, 99)
(1, 11, 22)
(1, 11, 34)
(1, 11, 44)
(1, 11, 7)
(1, 11, 33)
(1, 11, 99)
(1, 11, 22)
(1, 11, 77)
(1, 11, 99)
...
etc. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-09T00:38:15.893

我想这就是你要找的：

```
import itertools
comb = itertools.product(uk_rock_stars, uk_pop_stars, us_stars) 
```

它会给你一个迭代器对象，它可能是也可能不是你想要的。要将其转换为普通列表，只需使用以下命令：

```
comb = list(comb) 
```

# for-loop - 在处理中拖动对象

> ID：15305722
> 
> 赞同：2
> 
> 时间：2013-03-09T00:34:08.157
> 
> 标签：for-loop, draggable, drag, processing, offset

我在将 Daniel Shiffman 的超棒拖动[示例](http://www.learningprocessing.com/examples/chapter-5/draggable-shape/%22example%22)应用到我的草图中时遇到问题。我以前用过它，它很棒，但是我试图用一些“花哨的”循环将它应用到多个对象（在本例中为文本），但无济于事。一切正常，除了对象不应该拖动。从逻辑上讲，这是因为`Line`类中的 offsetX 和 offsetY 属性不断更新，从而迫使对象保持静止。我确信有一个解决方案，但我无法弄清楚。也许我已经盯着它太久了。我真的很感激帮助！

```
String[] doc; //array of Strings from each text documents line
int tSize; //text size
float easing; //easing
int boundaryOverlap; //value for words to overlap edges by
PFont font; //font
Lines lines;
boolean clicked = false;

void setup(){
  size(displayWidth/2,displayHeight); 
  background(255);
  fill(0);

  boundaryOverlap = 20; //value for words to overlap edges by
  tSize = 32; //text size

  //loads and formats text
  doc = loadStrings("text.txt"); 
  font = loadFont("Times-Roman-48.vlw");
  textFont(font, tSize);

  //lines object
  lines = new Lines(doc);

  //populate xAddition and yAddition arrays
  lines.populateArrays();
}

void draw(){
  background(255);
  fill(0);

  //loops through each line in .txt
  for(int i = 0; i <= doc.length-1; i++){
    if(clicked) lines.clicked(i);
    lines.move(i, clicked); //update doc[i] positions //deletes 
    lines.display(i); //draws text for each line of text in text.txt
   }
}

void mousePressed(){
   clicked = true;
}

void mouseReleased(){
   clicked = false; 
   lines.dragging = false;
} 
```

这是线类：

```
class Lines{
  //class properties
  float[] x; //array holding random values to be added to x for placement
  float[] y; //array holding random values to be added to y for placement
  float offsetX;
  float offsetY;
  String[] doc;

  boolean dragging = false; //boolean for dragging

  //construct
  Lines(String[] tempDoc){
    doc = tempDoc;
  }

  //fills x and y arrays
  void populateArrays(){
    x = new float[doc.length];
    y = new float[doc.length];

    //populates x and y arrays
    for(int i = 0; i <= doc.length-1; i++){   
      x[i] = int(random(0-boundaryOverlap, width-boundaryOverlap));
      y[i] = int(random(0, height-boundaryOverlap));
      }
  }

  //draws text
  void display(int i){
       text(doc[i], x[i], y[i]); //draw text
       //if(addition[i] != null) text(addition[i], x[i], y[i]+20);
  }

  void clicked(int i){
    if(mouseX > x[i] &&
       mouseX < x[i]+textWidth(doc[i]) &&
       mouseY < y[i] &&
       mouseY > y[i]-tSize){
       dragging = true;
       offsetX = x[i] - mouseX;
       offsetY = y[i] - mouseY;  
    }
  }

  //updates text positions
  void move(int i, boolean clicked){

       //if mouseOver text hover gray
       if( mouseX > x[i] &&
       mouseX < x[i]+textWidth(doc[i]) &&
       mouseY < y[i] &&
       mouseY > y[i]-tSize){

         fill(100); //gray text fill

         if(dragging){
           x[i] = mouseX + offsetX;
           y[i] = mouseY + offsetY;
         }

       }

       else{
         fill(0); //if not text not mouseOver fill is black
         dragging = false;
       }
  }

  //delete 
  void delete(int i){
    //if "delete" is pressed 
    if (keyPressed){
      if(key == 8){
        doc[i] = ""; // doc[line String that is being hovered over] is replaced with null
        keyCode = 1;
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:21:39.407

首先，不要使用 vlw 字体。当每个人都安装了 Times New Roman 时，实际上没有理由使用位图图像文件。只需使用 createFont("Times New Roman",48)。现在您甚至可以更改文本大小而不会看起来很糟糕，因为您只是加载了字体，而不是位图图像。

也就是说，这段代码并不是那么好......但是使用它，问题就在这里：

```
 for(int i = 0; i <= doc.length-1; i++){
    if(clicked) lines.clicked(i);
    lines.move(i, clicked); //update doc[i] positions //deletes 
    lines.display(i); //draws text for each line of text in text.txt
  } 
```

您检查是否已单击，如果是，则将该行标记为已单击。然后你完全忽略它并移动所有行，而不查看“单击”状态（它根本不用于移动功能）。

也就是说，你想要做的事情可以做得更好，更干净：

```
LineCollection lines;
float textSize;

void setup(){
  size(400,400);
  // fix the text size, reference a real font
  textSize = 32; 
  textFont(createFont("Times New Roman", textSize));
  // parse strings, construct Lines container
  String[] textValues = new String[]{"lol","cat"};
  lines = new LineCollection(textValues);
  // Do not loop! only update when events warrant,
  // based on redraw() calls  
  noLoop();
}
// fall through drawing
void draw() { background(255); lines.draw(); }
// fall through event handling
void mouseMoved() { lines.mouseMoved(mouseX,mouseY); redraw(); }
void mousePressed() { lines.mousePressed(mouseX,mouseY); redraw(); }
void mouseDragged() { lines.mouseDragged(mouseX,mouseY); redraw(); }
void mouseReleased() { lines.mouseReleased(mouseX,mouseY); redraw(); }

/**
 * A collection of lines. This is *only* a collecton,
 * it is simply responsible for passing along events.
 */
class LineCollection {
  Line[] lines;
  int boundaryOverlap = 20;

  // construct
  LineCollection(String[] strings){
    lines = new Line[strings.length];
    int x, y;
    for(int i=0, last=strings.length; i<last; i++) {
      x = (int) random(0, width);
      y = (int) random(0, height);
      lines[i] = new Line(strings[i], x, y);   
    }
  }

  // fall through drawing   
  void draw() {

    // since we don't care about counting elements
    // in our "lines" container, we use the "foreach"
    // version of the for loop. This is identical to
    // "for(int i=0; i<lines.size(); i++) {
    //    Line l = lines[i];
    //    [... use l here ...]
    //  }"
    // except we don't have to unpack our list manually.

    for(Line l: lines) { l.draw(); }
  }

  // fall through event handling
  void mouseMoved(int mx, int my) { for(Line l: lines) { l.mouseMoved(mx,my); }} 
  void mousePressed(int mx, int my) { for(Line l: lines) { l.mousePressed(mx,my); }} 
  void mouseDragged(int mx, int my) { for(Line l: lines) { l.mouseDragged(mx,my); }}
  void mouseReleased(int mx, int my) { for(Line l: lines) { l.mouseReleased(mx,my); }}
}

/**
 * Individual lines
 */
class Line {
  String s;
  float x, y, w, h;
  boolean active;
  color fillColor = 0;
  int cx, cy, ox=0, oy=0;

  public Line(String _s, int _x, int _y) {
    s = _s;
    x = _x;
    y = _y;
    w = textWidth(s);
    h = textSize;
  }

  void draw() {
    fill(fillColor);
    text(s,ox+x,oy+y+h);
  }

  boolean over(int mx, int my) {
    return (x <= mx && mx <= x+w && y <= my && my <= y+h);
  }

  // Mouse moved: is the cursor over this line?
  // if so, change the fill color
  void mouseMoved(int mx, int my) {
    active = over(mx,my);
    fillColor = (active ? color(155,155,0) : 0);
  }

  // Mouse pressed: are we active? then
  // mark where we started clicking, so 
  // we can do offset computation on
  // mouse dragging.
  void mousePressed(int mx, int my) {
    if(active) {
      cx = mx;
      cy = my;
      ox = 0;
      oy = 0; 
    }
  }

  // Mouse click-dragged: if we're active,
  // change the draw offset, based on the
  // distance between where we initially
  // clicked, and where the mouse is now.
  void mouseDragged(int mx, int my) {
    if(active) {
      ox = mx-cx;
      oy = my-cy;
    }
  }

  // Mouse released: if we're active,
  // commit the offset to this line's
  // position. Also, regardless of
  // whether we're active, now we're not.  
  void mouseReleased(int mx, int my) {
    if(active) {
      x += mx-cx;
      y += my-cy;
      ox = 0;
      oy = 0;
    }
    active = false;
  }
} 
```

**更新**

解释了此代码中使用的“for”的 foreach 版本。

# c++ - std::is_signed 之间的区别 和 std::numeric_limits ::is_signed?

> ID：15305723
> 
> 赞同：7
> 
> 时间：2013-03-09T00:34:14.423
> 
> 标签：c++, c++11, std, numeric-limits

两者`std::is_signed<T>`和`std::numeric_limits<T>::is_signed`都应该给出关于 的签名的答案`T`。
为什么现在有**两个**符号指示符（即从 C++11 开始）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-09T00:48:01.847

我将冒险猜测唯一的区别是是否`std::numeric_limits<T>`专门用于用户定义的类型。这样一个用户定义的类型当然可以为`is_signed`. 但是除非已经独立专门化，否则对这种类型的请求`std::is_signed<T>::value`将始终返回。`false``std::is_signed<T>`

似乎`std::is_signed<T>`代表的条件是

```
is_arithmetic<T>::value && T(-1) < T(0) 
```

* * *

**更新**：知识渊博的 Howard Hinnant[指出](https://stackoverflow.com/questions/15305723/difference-between-stdis-signedt-and-stdnumeric-limitstis-signed/15305830#comment21604593_15305830)，虽然`std::numeric_limits<>`可以在法律上进行专门化，但`<type_traits>`除非另有说明，否则不允许专门化任何内容，并且`is_signed`未指定为可专门化。

因此，`std::numeric_limits<T>::is_signed` *可能会*返回`true`用户定义的类型（如果它已被专门化），但`std::is_signed<T>::value`始终会返回`false`用户定义的类型。

# android - 我无法从 adb 版本 1.0.29 升级

> ID：15305725
> 
> 赞同：14
> 
> 时间：2013-03-09T00:34:27.737
> 
> 标签：android, adb

我正在尝试将我的 nexus 7 与我的 linux mint 机器连接起来。设备始终显示为离线。我知道这个问题来自于 adb 早于 1.0.31。我一直在安装平台工具 rev 21.1，截至上个月它是应该安装 adb 1.0.31 的最新版本，但每次我运行命令“adb version”时，它都会返回说它是 1.0.29 版。有没有其他方法可以让它升级？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-04-15T08:27:34.797

这解决了 Ubuntu 上的这个问题（运行旧的 adb）：

1.  拔下设备
2.  adb 杀死服务器
3.  亚行版本
    *   Android 调试桥版本 1.0.29
4.  cd 到 android sdk 目录
    *   cd /home/XXX/adt-bundle-linux-x86_64/sdk/platform-tools/
5.  将新的 adb 复制到 /usr/bin
    *   sudo cp adb /usr/bin/
6.  亚行版本
    *   Android 调试桥版本 1.0.31
7.  adb 杀死服务器
8.  亚行设备
    *   守护进程没有运行。现在在端口 5037 上启动它 *
    *   守护进程成功启动 * 连接的设备列表
9.  插入设备，在设备上出现关于 RSA 的对话框
10.  在设备上接受
11.  亚行设备
    *   附加设备列表
    *   04cefca0e29085aa 设备

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-10T21:11:55.557

**Windows 的答案：**

您需要检查最新驱动程序的位置并将此值放入**PATH**系统变量中。为此：

1.  打开 Android SDK 管理器（Android Studio/Tools/Android/SDK 管理器；或从 Eclipse）。

2.  在左上角（就在菜单下方），您将看到“SDK 路径”。这是最新驱动程序所在的位置。

3.  打开`Control Panel\System and Security\System`，点击“高级系统设置”，找到“环境变量...”按钮。

4.  在列表中找到 PATH 变量（检查两个列表）。找到旧的 platrom-tools 路径。将旧路径替换为新的 onreplace 那里的 SDK 路径 +“平台工具”（例如“c:\Android2013\sdk\platform-tools”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T06:25:44.737

可以执行以下两个步骤来解决此问题。

1.  可能有另一个`adb`在后台运行。用于`adb kill-server`停止 adb 服务器，然后重新启动`adb`.

2.  如果要更新`adb`，可以通过从安装 SDK 位置运行 SDK Manager 来完成。升级“平台工具”以升级 adb。

3.  上述问题可能与以下相同。请检查以下帖子。
    [Android 4.2.2 - adb 离线，即使在 SDK 升级后](https://stackoverflow.com/questions/15073165/android-4-2-2-adb-offline-even-after-sdk-upgrade)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T03:44:52.487

您应该首先检查是否为您的设备安装了正确的驱动程序。以下链接可以帮助您。

[http://developer.android.com/tools/device.html](http://developer.android.com/tools/device.html)

此外，如果您想升级`adb`，还有另一种方法。转到：[https ://launchpad.net/ubuntu/+source/android-tools/](https://launchpad.net/ubuntu/+source/android-tools/)

单击量子版本（4.2.2-something）。下载 .xz、.dsc 和 .tar.gz 和十个：

`# sudo apt-get build-dep android-tools`

`# sudo apt-get install libselinux-dev`

`# dpkg-source -x android-tools*.dsc`

`# cd android-tools*`

`# fakeroot dpkg-buildpackage`

`# cd ..`

`# sudo dpkg -i android-tools-adb*`

此解决方案在这里介绍： [https ://bugs.launchpad.net/ubuntu/+source/android-tools/+bug/1131163](https://bugs.launchpad.net/ubuntu/+source/android-tools/+bug/1131163)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T01:26:48.100

我发现的最佳解决方案是：

1.  使用命令检查您的 adb 版本：Windows 的 adb 版本和 Linux 系统的 ./adb 版本
2.  如果显示 1.0.29，请将其升级到 1.0.31，因为 1.0.29 不会响应 JB 4.2.X
3.  它将解决您的设备离线问题
4.  如果您的系统已经有新的 adb(1.0.31) 并面临这个问题，在这种情况下打开 sdk 并将平台工具升级到 16.0.1
5.  至少重新启动一次您的设备.. :) 它适用于所有设备...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-29T18:09:31.813

我按照以下步骤在我的 Windows 机器上解决了这个问题：

1.  从 SDK 管理器安装更新
2.  将对应的 adb 文件（dll 和 exe）复制到 C:\Windows\System32
3.  adb 杀死服务器
4.  亚行版本

Android 调试桥版本 1.0.31

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-14T16:21:05.687

这些都不适合我。更新 sdk 仍然显示较旧的 1.0.29 版本。[我从这里](https://code.google.com/p/sudolee/downloads/detail?name=adb-fastboot.zip&can=2&q=)下载了 1.0.31 版本并用它替换了旧的 adb 并且它有效。现在该设备在 4.2.2 中被 adb 识别。希望这可以帮助某人并节省一些时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-22T06:25:33.817

我通过**更新**Android Studio 解决了这个问题。

您可以通过 **选择 Help > Check for Updates**
(Android Studio > Check for Updates on macOS) 来获取更新

# python - Python matplotlib 减小颜色条标签的大小

> ID：15305737
> 
> 赞同：62
> 
> 时间：2013-03-09T00:36:12.470
> 
> 标签：python, attributes, matplotlib, labels, colorbar

我需要你的帮助！我有一个绘图代码，如下所示：

```
fig = plt.figure()
ax1 = fig.add_subplot(111)

imax1 = ax1.imshow(data,interpolation = 'nearest', origin = 'lower',cmap=cm.jet)#plot
cbar = plt.colorbar(imax1, extend='neither', spacing='proportional',
                orientation='vertical', shrink=0.7, format="%.0f")
cbar.set_label(r"ET [mm/month]", size=10)

titlestr = "Evapotranspiration in mm/month"
plt.title(titlestr)
#plt.xlabel("Longitude")
#plt.ylabel("Latitude")
imax1.set_clim(0,60)
labels = [item.get_text() for item in ax1.get_xticklabels()]
for ii in range(np.shape(labels)[0]):
    labels[ii] = str(grid_lon[75*ii/np.shape(labels)[0]])

ax1.set_xticklabels(labels, rotation = 45, ha='right', size = 10)

labels = [item.get_text() for item in ax1.get_yticklabels()]
for ii in range(np.shape(labels)[0]):
    labels[ii] = str(grid_lat[75*ii/np.shape(labels)[0]])

ax1.set_yticklabels(labels, size = 10)

pngname = "./out/2d_"+variable+"_"+mm+".png"
print "save ", pngname
plt.savefig(pngname, dpi=None, facecolor='w', edgecolor='w',
    orientation='portrait', papertype=None, format=None,
    transparent=False, bbox_inches=None, pad_inches=0.1)

print "plot finished" 
```

我想将颜色条标签（例如 0、10、20、...60）的标签大小设置为 10 或更小。这可能会进入“imax1.set_clim(0,60) 行。有什么想法吗？我也有兴趣将 imax1 对象的信息打印到命令行。我该怎么做？例如 imax1 的可用属性和功能.

我非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2013-03-09T01:06:50.870

啊哈！[在这里](https://stackoverflow.com/a/6568248/1062948)找到答案：

```
cbar.ax.tick_params(labelsize=10) 
```

PS 支持[这个](https://stackoverflow.com/a/6568248/943773)答案并给保罗一些爱！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-10-28T14:32:35.530

如果您在这里是因为您试图增加字体大小，但是由于上述答案的大尺寸而有些数字消失了，您可以这样做

```
cbar = plt.colorbar()
for t in cbar.ax.get_yticklabels():
     t.set_fontsize(20) 
```

# c++ - 计算一个选择结果数

> ID：15305738
> 
> 赞同：0
> 
> 时间：2013-03-09T00:36:40.293
> 
> 标签：c++, qt, sqlite

我正在创建一个接口来运行 SQL 查询（C++ 和 QT），但我想分页并计算结果。

就像是：

```
select count (User select) as count and select (user select) limit 100; 
```

例子：

```
select count (select * from tbl_data where id >10); 
```

有没有办法做到这一点或使用 SQLITE3 库来做到这一点？

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:40:32.897

我找到了一个方法

```
select count(*) from (select tbl_name, sql FROM sqlite_master WHERE type='table') as data; 
```

谢谢

# php - Sending $_POST without submitting a form?

> ID：15305739
> 
> 赞同：0
> 
> 时间：2013-03-09T00:36:45.847
> 
> 标签：php

I'm working on a script for forms that submits the data to itself to check for errors, if there are no errors it uses header() to send them to the next page. Is there a way I can send the $_POST data to the next page as well without the form being re-submitted?

```
 <?php

if (isset($_POST['submit'])) {
    $errors = array();
    $moo = array();

    if (empty($_POST['a'])) {
        $errors[] = 'You forgot to answer Question 1!<br/>';
    } else {
        $moo = $_POST['a'];
    }

    if (empty($_POST['b'])) {
        $errors[] = 'You forgot to answer Question 2!<br/>';
    }

    if (empty($_POST['c'])) {
        $errors[] = 'You forgot to answer Question 3!<br/>';
    }

    if (empty($errors)) {

        $_POST['aids'] = "RAWR";
        $url = "http://localhost/test/test.php?page=2";
        header("Location: $url");
        exit();
    } else {
        foreach ($errors as $error) {
            echo $error;
        }
    }
}

echo "
    <form action=\"test.php?page=1\" method=\"post\">
        <input type=\"text\" name=\"a\" value=\"" . $_POST['a'] . "\">
        <input type=\"text\" name=\"b\" value=\"" . $_POST['b'] . "\">
        <input type=\"text\" name=\"c\" value=\"" . $_POST['c'] . "\">
        <input type=\"submit\" name=\"submit\">
    </form>
";

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:41:18.720

您应该使用 AJAX 请求来检查错误，如果所有信息都正确，则将表单提交到 $url 的位置。

但是，如果您想在没有错误的情况下将数据存储在 $_SESSION 变量中，您将能够在下一页检索它。

```
...
if (empty($errors)) {

    $_POST['aids'] = "RAWR";
    $url = "http://localhost/test/test.php?page=2";
    $_SESSION['post'] = $_POST;
    header("Location: $url");
    exit();
} else {
    foreach ($errors as $error) {
        echo $error;
    }
}
... 
```

甚至可以使用 url 的查询字符串发送数据，例如

```
$url = "http://localhost/test/test.php?page=2&data=whatever"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:44:46.813

那么有很多方法可以解决这个问题。首先想到的是将数据存储在`$_SESSION`变量中，然后将其存储在数据库中......

如果您不想过多地更改脚本的结构，而不是在验证数据后进行重定向，只需`include()`运行其他页面的代码 -

```
if (empty($errors)) {
  ...
  // this will simply insert the contents of the script and execute it.
  include('test.php?page=2');
} else {
   ...
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-09T00:40:35.890

尝试不使用任何内容作为操作 url。这使当前页面成为目标：

```
<form action="" method="post"> 
```

编辑。误读问题。在第一页试试这个：

```
<?php  
  if(isset($_POST['submit'])){
    // check for errors here...
    if (empty($errors)) {
      $valuea = 'a';
      $valueb = 'b';
      $url = "http://domain/test/test.php?vala=".$valuea."&valb=".$valueb."";
      header("Location: $url");
      exit();
    }
  }       
?> 
```

在第 2 页

```
<?php
$valuea = $_GET['vala'];
$valueb = $_GET['valb'];
?> 
```

这只是通过 url 传递值。否则，您将需要一个会话或数据库来使用 PHP 传递值。

# actionscript-3 - Actionscript：DisplayObject 相对宽度可能吗？

> ID：15305745
> 
> 赞同：0
> 
> 时间：2013-03-09T00:36:56.863
> 
> 标签：actionscript-3, displayobject

是否有可能使任何子 DisplayObject 相对于它的父对象具有例如 100% 的宽度，就像在 HTML 中一样？

例如，在舞台调整大小时自动调整大小。

避免手动重绘所有 ui。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T12:50:37.030

如果您希望在整个舞台上完成此操作，请使用
`stage.scaleMode=StageScaleMode.EXACT_FIT;`
[此处的 exactFit 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/StageScaleMode.html#EXACT_FIT)
或使用 Flex

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:58:46.273

我通常处理这个问题的方式是我有一个扩展的自定义类，它在舞台上`Sprite`监听`Event.RESIZE`，然后在每个类中覆盖该函数，因为通常我没有一个单一的解决方案来说明我希望显示对象如何在调整大小时起作用。您可以修改它以用于您的目的。

```
public class ResizeableSprite extends Sprite {

    public function ResizeableSprite()
    {
        addEventListener(Event.ADDED_TO_STAGE, onAddedToStage, false, 0, true);
        addEventListener(Event.REMOVED_FROM_STAGE, onRemovedFromStage, false, 0, true);
    }

    protected function onResize(eventObject:Event):void {
        // override
    }

    protected function onAddedToStage(eventObject:Event):void {
        root.stage.addEventListener(Event.RESIZE, onResize, false, 0, true);
    }

    protected function onRemovedFromStage(eventObject:Event):void {
        root.stage.removeEventListener(Event.RESIZE, onResize);
    }

    public function destroy():void {            
        removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
        removeEventListener(Event.REMOVED_FROM_STAGE, onRemovedFromStage);
    }
} 
```

# c# - 从 Windows Store App 导出 Sqlite 数据库

> ID：15305758
> 
> 赞同：0
> 
> 时间：2013-03-09T00:38:21.027
> 
> 标签：c#, sqlite, windows-store-apps, filepicker

我有一个 Sqlite 数据库，我在 Windows Store 应用程序中填充它。现在我想在重新安装应用程序时说数据库可用，因此如果我是对的，我必须将它作为文件添加到我的项目中。

现在我正在尝试使用 PickSaveFileAsync() 方法导出数据库文件。不幸的是，一旦我拿到文件，我真的不知道该怎么做。这是我到目前为止所得到的：

```
 private async void exportDB_Click(object sender, RoutedEventArgs e)
    {
        StorageFile database = await ApplicationData.Current.LocalFolder.GetFileAsync("Hashes.db");
        var picker = new FileSavePicker();
        picker.FileTypeChoices.Add("Database File", new string[] { ".db" });
        picker.CommitButtonText = "Save DB";
        picker.SuggestedFileName = "Database";
        StorageFile file = await picker.PickSaveFileAsync();
        if (file != null)
        {
            // What to do here?
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T10:05:21.647

我很难弄清楚你到底想要达到什么目的。

查看代码，您似乎想将数据库文件复制到用户定义的位置。为此，只需在`if`块中添加以下代码：

```
using (var srcStream = await database.OpenStreamForReadAsync())
{
    using (var destStream = await file.OpenStreamForWriteAsync())
    {
        await srcStream.CopyToAsync(destStream);
    }
} 
```

阅读介绍性文本，您似乎正在尝试将文件包含在您的应用程序中。在这种情况下，您确实应该将其添加`Content`到您的项目中。然后，您可以从代码中访问它，如下所示：

```
var dbFile = Package.Current.InstalledLocation.GetFileAsync(@"db\Hashes.db"); 
```

如果您不知道，可以`LocalFolder`在以下目录中找到文件：

```
C:\Users\Username\AppData\Local\Packages\PackageName\LocalState 
```

# c# - MSDN 中的 XmlSerializer 示例失败

> ID：15305760
> 
> 赞同：3
> 
> 时间：2013-03-09T00:38:43.283
> 
> 标签：c#, xml, serialization, xmlserializer

我正在尝试学习如何使用 XMLSerializer。我使用以下示例代码创建了一个 VS2010 项目：http: [//msdn.microsoft.com/en-us/library/tz8csy73](http://msdn.microsoft.com/en-us/library/tz8csy73(v=vs.100).aspx) (v=vs.100).aspx 。

该代码应该将一个简单的 XML 文档反序列化为一个简单的 C# 对象。它编译并运行没有错误，但无法恢复 C# 对象。所有字段都保持为 0 或 null。

我有示例要求的 .NET Framework 4.0。我在最后一个 Console.Write 上放了一个断点，可以看到所有值都是 0 或 null。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T00:43:48.903

问题在于示例中的 XML 文件。元素的名称以 XML 命名空间为前缀，这导致序列化程序无法将它们映射到`OrderedItem`类型中的原始字段。如果您删除 XML 文件中的名称空间，此示例将正确运行。

或者，您可以装饰`OrderedItem`类型以包含 simple.xml 文件中使用的正确命名空间

```
public class OrderedItem
{
    [XmlElement(Namespace = "http://www.cpandl.com")]
    public string ItemName;
    [XmlElement(Namespace = "http://www.cpandl.com")]
    public string Description;
    [XmlElement(Namespace = "http://www.cohowinery.com")]
    public decimal UnitPrice;
    [XmlElement(Namespace = "http://www.cpandl.com")]
    public int Quantity;
    [XmlElement(Namespace = "http://www.cohowinery.com")]
    public decimal LineTotal;

    // A custom method used to calculate price per item.
    public void Calculate()
    {
        LineTotal = UnitPrice * Quantity;
    }
} 
```

# chef-infra - 检查 chef 是否以 chef-solo 身份运行

> ID：15305761
> 
> 赞同：14
> 
> 时间：2013-03-09T00:38:43.967
> 
> 标签：chef-infra, vagrant, chef-recipe

我正在使用 Vagrant 和 chef-solo 来测试我的食谱，但我有一个需要 chef-server 的特定食谱（它使用搜索）。我希望我的默认配方如下所示：

```
include_recipe 'some_recipe'
include_recipe 'some_other_recipe'
unless running_as_chef_solo?
  include_recipe 'a_recipe_that_requires_chef_server'
end 
```

如何检查厨师是否在食谱中作为厨师独奏运行，以便我可以跳过不受支持的食谱？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-09T09:13:52.140

使用`Chef::Config`对象：

```
unless Chef::Config[:solo]
  include_recipe 'a_recipe_that_requires_chef_server'
end 
```

# ruby-on-rails - 模型没有像我认为的那样连接

> ID：15305763
> 
> 赞同：1
> 
> 时间：2013-03-09T00:39:15.167
> 
> 标签：ruby-on-rails, has-many-through, has-many, belongs-to

为什么我在 Bids 中选择 _form 时收到此错误？

```
=>  undefined method `request_for_proposal' for  
# <ActionView::Helpers::FormBuilder:0x002aaad671c9c8> 
```

request_for_proposal **has_many** bids **bids_to** request_for_proposal
_

 **```
====================================================
Inside views/bids/_form.html.erb

  <div class="field">  
    <%= bid.label :vendor_name %>  
    <%= bid.select :vendor_id, bid.request_for_proposal.vendors.collect { |rfpvi|  
        [rfpvi.friendly_name + "  :  " + rfpvi.rfp_number, rfpvi.id] } %>  
  </div> 
```

在投标中，我需要通过 RFP 获得“invited_vendors”，以便我以后可以限制或限制可以实际提交投标的供应商。

```
class Bid < ActiveRecord::Base

  attr_accessible :cost, :request_for_proposal_id, :vendor_id

  belongs_to :request_for_proposal
  belongs_to :vendor
------------------------------------------------

mysql> desc bids;
+-------------------------+---------------+------+-----+---------+----------------+
| Field                   | Type          | Null | Key | Default | Extra          |
+-------------------------+---------------+------+-----+---------+----------------+
| id                      | int(11)       | NO   | PRI | NULL    | auto_increment |
| cost                    | decimal(10,0) | YES  |     | NULL    |                |
| request_for_proposal_id | int(11)       | YES  | MUL | NULL    |                |
| vendor_id               | int(11)       | YES  | MUL | NULL    |                |
| contact_id              | int(11)       | YES  | MUL | NULL    |                |
| created_at              | datetime      | NO   |     | NULL    |                |
| updated_at              | datetime      | NO   |     | NULL    |                |
+-------------------------+---------------+------+-----+---------+----------------+  

================================================
class RequestForProposal < ActiveRecord::Base

  attr_accessible   :rfp_number, :name, :description, :title,
                    :contact_id, :business_owner_id

  has_many   :bids
  has_many   :rfp_vendors
  has_many   :vendors, :through => :rfp_vendors

  has_and_belongs_to_many   :business_owners, :class_name => :Contact,
                            :foreign_key => :business_owner_id
  has_and_belongs_to_many   :evaluators,      :class_name => :Contact,
                            :foreign_key => :evaluator_id
 ----------------------------------------------- 

mysql> desc request_for_proposals;
+----------------------------+--------------+------+-----+---------+----------------+
| Field                      | Type         | Null | Key | Default | Extra          |
+----------------------------+--------------+------+-----+---------+----------------+
| id                         | int(11)      | NO   | PRI | NULL    | auto_increment |
| rfp_number                 | varchar(255) | NO   |     | NULL    |                |
| contact_id                 | int(11)      | YES  |     | NULL    |                |
| vendor_id                  | int(11)      | YES  |     | NULL    |                |
| name                       | varchar(255) | NO   |     | NULL    |                |
| description                | varchar(255) | YES  |     | NULL    |                |
| title                      | varchar(255) | NO   |     | NULL    |                |
| bid_id                     | int(11)      | YES  |     | NULL    |                |
| business_owner_id          | int(11)      | YES  |     | NULL    |                |
| evaluator_id               | int(11)      | YES  |     | NULL    |                |
| created_at                 | datetime     | NO   |     | NULL    |                |
| updated_at                 | datetime     | NO   |     | NULL    |                |
+----------------------------+--------------+------+-----+---------+----------------+

================================================
class Vendor < ActiveRecord::Base

    attr_accessible :friendly_name

    has_many :rfp_vendors
    has_many :request_for_proposals, :through => :rfp_vendors
    has_many :bids
------------------------------------------------

mysql> desc vendors;
+-------------------------+--------------+------+-----+---------+----------------+
| Field                   | Type         | Null | Key | Default | Extra          |
+-------------------------+--------------+------+-----+---------+----------------+
| id                      | int(11)      | NO   | PRI | NULL    | auto_increment |
| friendly_name           | varchar(255) | YES  |     | NULL    |                |
| created_at              | datetime     | NO   |     | NULL    |                |
| updated_at              | datetime     | NO   |     | NULL    |                |
+-------------------------+--------------+------+-----+---------+----------------+

================================================
================================================

mysql> desc bids_contacts;
+------------+---------+------+-----+---------+-------+
| Field      | Type    | Null | Key | Default | Extra |
+------------+---------+------+-----+---------+-------+
| bid_id     | int(11) | NO   |     | NULL    |       |
| contact_id | int(11) | NO   |     | NULL    |       |
+------------+---------+------+-----+---------+-------+

mysql> desc bids_vendors;
+-----------+---------+------+-----+---------+-------+
| Field     | Type    | Null | Key | Default | Extra |
+-----------+---------+------+-----+---------+-------+
| bid_id    | int(11) | NO   |     | NULL    |       |
| vendor_id | int(11) | NO   |     | NULL    |       |
+-----------+---------+------+-----+---------+-------+

mysql> desc rfp_vendors;
+-------------------------+----------+------+-----+---------+----------------+
| Field                   | Type     | Null | Key | Default | Extra          |
+-------------------------+----------+------+-----+---------+----------------+
| id                      | int(11)  | NO   | PRI | NULL    | auto_increment |
| vendor_id               | int(11)  | YES  |     | NULL    |                |
| request_for_proposal_id | int(11)  | YES  |     | NULL    |                |
| created_at              | datetime | NO   |     | NULL    |                |
| updated_at              | datetime | NO   |     | NULL    |                |
+-------------------------+----------+------+-----+---------+----------------+ 
```

??????????????????????????????????????????????????? ??

在我克服了无法“看到”request_for_proposals 的烦人之后，

我将需要通过 :through => :rfp_venders 联系供应商。

我会担心到达 Vendors.friendly_name 的细微差别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:45:27.763

从您显示的 irb 错误来看，您似乎正在调用`request_for_proposal`表单构建器实例，而不是 ActiveRecord 实例本身。

如果你有`form_for @my_instance do |f|`，那么在块内`f`是一个表单构建器实例，与 ; 不是同一个对象`@my_instance`。您应该使用`@my_instance`or`f.object`来访问 ActiveRecord 实例。**

# javascript - AngularJS，用按钮清除输入文本

> ID：15305764
> 
> 赞同：7
> 
> 时间：2013-03-09T00:39:38.307
> 
> 标签：javascript, angularjs

使用`AngularJS`，清除文本字段值的正确方法是什么？我有一个输入字段，旁边有一个按钮。用户输入它并点击按钮来清除或重置它。

我知道我可以`ng-click`在按钮本身上添加一个事件并调用一个函数，但我不确定这是正确的方法。

现在我只有：

```
<input type="text" ng-model="searchQuery" />
<button class="btn" <!--do something here maybe?-->>
  <i class="icon-search" ng-class="{'icon-refresh': searchQuery.length}"></i>
</button> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-02-01T14:41:23.993

我有同样的问题。也许简单是最好的？

无需在控制器中调用方法。也不需要指令。只是一个简短的声明来清除您在输入标签中声明的模型。像这样：

```
<input ng-model="searchQuery">
<button class="btn" ng-click="searchQuery = ''"></button> 
```

当输入中没有文本时，您也可以隐藏清除按钮，如下所示：

```
<button class="btn" ng-show="searchQuery.length" ...></button> 
```

顺便说一句，也许将清除按钮放在输入框内的指令会很好。就像你在 iPhone 上看到的那样。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-09T00:51:21.133

`ng-click`是“角”的方式来做到这一点

只需在您的范围内声明一个函数并将其附加到按钮的 ng-click

如果您想要更高级的东西，那么“Angular 方式”建议创建一个**指令**来包装您想要的功能并将其以某种方式附加到您的按钮（取决于您如何实现指令）

如果你想要一个例子，请在评论中告诉我

# xcode - 为什么在 Xcode 导航器中单击项目会显示原始 pbxproj 文件

> ID：15305766
> 
> 赞同：9
> 
> 时间：2013-03-09T00:39:47.240
> 
> 标签：xcode

...而不是用于构建阶段、目标等的 gui？

我经常看到gui。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-09T00:44:52.920

有时会发生这种情况，因为您处于版本控制视图中。共有三个按钮：普通视图、助手视图和版本控制视图。确保你在前两个之一。

![在此处输入图像描述](../Images/8e09b97fc7aab81cca9ff6ec03f3cb8a.png)

编辑：另外，我有另一个想法。“pbxproj”？？？当前的后缀是“xcodeproj”，并且已经存在了很长时间。您可能只是想打开一个对于您的 Xcode 版本来说太旧的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:43:26.047

*听起来*您的 pbxproj 文件可能略有损坏。

您是否有机会退出最近的更改并查看 Xcode 是否能再次很好地打开项目？

当 Info.plist 文件损坏时，这就是 Xcode 遵循的行为（而不是显示 plist 编辑器，Xcode 只会打开一个文本编辑器，显示 plist 文件的原始 XML-ish-ness）。

# facebook - 允许用户选择他们给予什么权限？

> ID：15305775
> 
> 赞同：0
> 
> 时间：2013-03-09T00:41:30.357
> 
> 标签：facebook, facebook-graph-api, authentication, login, permissions

我正在开发一个 Facebook 应用程序，我在用户登录时要求他们提供相当多的权限。**我在这里指的是用户和朋友权限**。
我想让用户选择授予应用程序的权限，因为其中一些权限对于应用程序不是必需的，但可能与某些功能绑定。我想通过提供一些复选框并仅接收用户选择授予的权限来做到这一点。或与扩展权限类似，提供一个按钮以从列表中删除权限。
有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T06:25:37.920

您几乎可以完全按照您所说的去做：在显示 facebook oauth 对话框之前，显示一个带有权限复选框的表单，这些权限对于您的应用程序是可选的。然后，您可以从复选框构建您的权限列表。但是，不要依赖它来打开和关闭需要扩展权限的功能，因为用户可以通过 oauth 对话框撤销这些功能。

您已经提到您希望让用户选择向他们提供哪些 JSON 字段。您可以在用户授予您的应用权限后执行此步骤，并为他们提供另一组可用于自定义数据的复选框。

# android - 令人费解的 Android xmlns 错误

> ID：15305778
> 
> 赞同：3
> 
> 时间：2013-03-09T00:41:44.733
> 
> 标签：android

我在许多地图示例中遇到过这样的代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <fragment
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

</RelativeLayout> 
```

但是，对于他们所有人来说，我得到了错误

> 描述资源路径位置类型为标签片段activity_msmap.xml/example/res/layout第8行找到意外的命名空间前缀“xmlns” Android Lint 问题

在线

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android" 
```

所以...这里发生了什么？我在任何地方的示例中都可以看到它，但它会在我的 Eclipse/Android 中导致错误？另外，为什么在父元素中也定义了相同的 xml 命名空间？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T02:03:40.247

您不能在 xml 布局中定义命名空间两次。只需从您的片段中删除它，RelativeLayout 已经定义了 xmlns:android 命名空间。

```
<fragment
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" /> 
```

# html - 防止 Bootstrap 在必要时调整边距宽度

> ID：15305781
> 
> 赞同：0
> 
> 时间：2013-03-09T00:42:14.413
> 
> 标签：html, css, twitter-bootstrap, media-queries

我喜欢 Bootstrap，它很棒，但是当我喜欢它们当前的宽度时，它会不断尝试让我的`.span3`类元素越来越靠近。如何让 Bootstrap 冷静下来，直到`.span3`需要调整使用该类的元素？可以说，当屏幕尺寸为 1170 像素或更大时，一切都很好，但是，当我达到 980 像素左右时，Bootstrap 将一切都拉近了一点，但我不需要它。我怎样才能告诉 Bootstrap 放松调整，直到屏幕尺寸达到 767px 左右。

我也为你们优秀的天才创建了一个[JSFiddle 。](http://jsfiddle.net/6FvEx/1/)

据我所知，媒体查询将是最好的调用，例如：

```
@media (min-width: 768px){
    .span3: chill out;
}
@media (max-width: 767px){
    .span3: do yo thang;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:09:44.960

这是 Bootstrap 响应能力的一部分。在常规尺寸下，网格列之间的间距为 20 像素，但在巨大的屏幕宽度（1200 像素以上）下，它会将间距放松到 30 像素。

**1) 如果您手动编辑 LESS 文件**

在“variables.less”中查找这一行。

```
@gridGutterWidth768:      20px; 
```

将其更改为 30 像素。重新编译 LESS。

**2) 如果您正在创建覆盖 CSS 文件**

将此包含在您的自定义 CSS 文件中，并确保在引导后包含/导入它。

```
@media (min-width: 768px) and (max-width: 979px) {
  .row {
    margin-left: -30px;
  }
  [class*="span"] {
    margin-left: 30px;
  }
} 
```

# vectorization - zgemm 在 Intel 的 MIC 上

> ID：15305784
> 
> 赞同：1
> 
> 时间：2013-03-09T00:42:55.003
> 
> 标签：vectorization, sse, matrix-multiplication, avx, intel-mic

我必须使用 MIC 的 512 位向量单元完成以下任务：

```
M->|b4|a4|b3|a3|b2|a2|b1|a1|
I->|d4|c4|d3|c3|d2|c2|d1|c1|

O-> O + |a4d4+b4c4|a4c4-b4d4|a3d3+b3c3|a3c3-b3d3|a2d2+b2c2|a2c2-b2d2|a1d1+b1c1|a1c1-b1d1| 
```

我想到的方法类似于英特尔为 SSE 提出的方法，也适用于 AVX：

使用`_mm512_swizzle_pd()`函数形成：

m0 = |a4|a4|a3|a3|a2|a2|a1|a1| 和 m0_t = |b4|b4|b3|b3|b2|b2|b1|b1| in0 = |d4|c4|d3|c3|d2|c2|d1|c1| in0_r = |c4|d4|c3|d3|c2|d2|c1|d1|

将上述两者相乘并使用类似于 MIC 的 addsub_pd() 的东西。但似乎没有相应的内在。

关于如何实现这一目标的任何建议？

英特尔的 MIC (Xeon Phi) 也有几个 FMA 内在函数，如 fmadd、fmsub、fnmadd、fnmsub，它们应该适合这种情况，我有以下两种方法：

```
'O' is the output register
Approach 1 :
1\. _mm512_fmadd_pd(m0,in0,O);
2\. Explicitly set m0_t using _mm512_set_pd() to make it: |b4|-b4|b3|-b3|b3|-b3|b1|-b1| 
3\. _mm512_fmadd_pd(m0_r,in0_r,O);

Approach 2:
1\. _mm512_fmadd_pd(m0,in0,O);
2\. _mm512_mask_fmadd_pd(m0_r,k1,in0_r,O); with k1=10101010
3\. _mm512_mask_fnmadd_pd(m0_r,k2,in0_r,O); with k2=01010101 
```

有更好的方法吗？这些方法有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T00:18:41.957

```
tmp = _mm512_mul_pd(mo_t,in_r);
tmp = _mm512_mask3_fmadd_pd(m0,in0,tmp,k1); with k1=10101010
res = _mm512_mask3_fmsub_pd(m0,in0,tmp,k2); with k2=01010101 
```

为什么要使用 _mm512_fnmadd_pd(v1,v2,v3)？这个内在函数的输出是 (~(v1*v2)) - v3

# c++ - 无需读者锁定即可实现对值的多线程访问的任何方式

> ID：15305785
> 
> 赞同：4
> 
> 时间：2013-03-09T00:43:09.827
> 
> 标签：c++, c++11, synchronization, thread-safety, smart-pointers

我正在尝试实现一个简约的同步机制，其中一个对象包含一些 type 的值`Foo`，这`Foo`可能是一个重量级的类型，但很少改变它的值。该对象可以从多个线程访问，几乎 100% 读取。

我正在尝试一种方法来完成这项工作，而不需要对读者有任何锁定要求。我的第一次尝试是让我的类`Foo`通过类型的共享指针成员包含`std::shared_ptr<Foo>`。读取操作将简单地复制构造共享指针，取消引用它，然后使用该值的“版本”来做任何他们想做的事情。

写操作应该将它们的更改应用到 Foo 的新副本中，一旦完成，尝试`Foo`用新版本替换当前版本。

我意识到这是不可能的，`shared_ptr<Foo>`因为复制构造函数可能会进入读/写竞争，试图更新它，并读取损坏的值。我可以使用`boost::intrusive_ptr<Foo>`原子计数器解决这个问题并使用 CAS 操作进行版本更新，但仍然存在我无法摆脱的竞争条件：读者可以在调用`intrusive_ptr_add_ref`即将获取的实例之前暂停被另一个将计数降低到 0 的线程销毁。

这种方法似乎从根本上破坏了某些东西。

有什么方法可以不依赖临界区、读写器锁或成熟的 RCU（读取-复制-更新）来实现这一点？也许我错过了一些简单的东西。平台为 Win7+/x86/x64。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T00:52:29.047

解决方案是首先拥有一个`std::shared_ptr<Foo>`具有新的本地并通过[原子分配](http://en.cppreference.com/w/cpp/memory/shared_ptr/atomic)方法`Foo`将其分配给全局。澄清：不要使用简单的分配。从链接中，您可以使用：`std::shared_ptr`

```
atomic_store( &global_ptr, std::make_shared<Foo>(...) ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:12:27.687

这会工作..

```
Foo * globalFoo;
.
.

Foo* newFoo = new Foo();
Foo* temp;
do {
    temp = globalFoo;
} while(! std::atomic_compare_exchange_weak(temp, globalFoo, newFoo)); 
```

# python - Django：Form 或 Field 类如何呈现小部件？过程是什么？

> ID：15305787
> 
> 赞同：0
> 
> 时间：2013-03-09T00:43:24.440
> 
> 标签：python, django, forms, validation, widget

我已经实现了一个扩展类，`Widget`我需要为这个类实现一个验证系统，但我认为这与`Field`类不兼容，因为我应用了自定义`render()`方法，可能这违反了[LSP 原则](https://en.wikipedia.org/wiki/Liskov_substitution_principle)（不确定）。这是一个例子：

```
from django import forms
from django.utils.safestring import mark_safe
from django.utils.encoding import force_unicode
from django.utils import formats
from django_future import format_html, flatatt

class InputGeneric(forms.Widget):
"""
Base class for all <input> widgets
"""
input_type = None # Subclasses must define this.
_to_str = None

def __init__(self, attrs=None, single_attrs=None):
    super(InputGeneric, self).__init__(attrs)
    self.single_attrs = single_attrs or ''

def get_attrs(self):
    return self.attrs

def get_attr(self, key):
    return self.attrs.get(key, None)

def render(self, name=None, value=None, attrs=None, single_attrs=None):
    '''
    *The default arguments of this function are:
    (self, name, value, attrs=None)
    - - - -
    single_attrs: is a string of HTML5 single attributes like "required", disabled"
    Example:
    render(single_attrs='required disabled')
    '''
    name = name or self.attrs.get('name', None)

    if name:
        final_attrs = self.build_attrs(attrs, type=self.input_type, name=name)
    else:
        final_attrs = self.build_attrs(attrs, type=self.input_type)

    value = self.attrs.get('value', None)
    if value:
        # Only add the 'value' attribute if a value is non-empty.
        final_attrs['value'] = force_unicode(self._format_value(value))

    self._to_str = format_html('<input{0} {1} />', flatatt(final_attrs), single_attrs)
    return self._to_str

def get_rendered(self):
    return self.render(attrs=self.attrs, single_attrs=self.single_attrs)

def __str__(self):
    if self._to_str:
        return self._to_str
    self._to_str = self.render()
    return self._to_str

class InputText(InputGeneric):
input_type = 'text'

def __init__(self, attrs=None, single_attrs=None):
    if attrs.get('type', None) is not None:
        del attrs['type']
    super(InputText, self).__init__(attrs, single_attrs) 
```

## django_future.py：

**注意：** Django1.3的`six`库在这里可用： [https ://github.com/django/django/blob/1.5/django/utils/six.py](https://github.com/django/django/blob/1.5/django/utils/six.py)

```
'''
This Lib contains functions from future implemantations of Django (After v1.3).
'''
from django.utils.safestring import mark_safe
from django.utils.html import conditional_escape
from django.utils import encoding
import datetime
from decimal import Decimal

    #The six lib is not included in Django 1.3
    #If you have 1.3 (as i have) you can search here in a future version of Django:
    #django.utils -> six
import six

def flatatt(attrs):
    """
    Convert a dictionary of attributes to a single string.
    The returned string will contain a leading space followed by key="value",
    XML-style pairs. It is assumed that the keys do not need to be XML-escaped.
    If the passed dictionary is empty, then return an empty string.

    The result is passed through 'mark_safe'.
    """
    return format_html_join('', ' {0}="{1}"', sorted(attrs.items()))

def format_html(format_string, *args, **kwargs):
    #django.utils.html
    """
    Similar to str.format, but passes all arguments through conditional_escape,
    and calls 'mark_safe' on the result. This function should be used instead
    of str.format or % interpolation to build up small HTML fragments.
    """
    args_safe = map(conditional_escape, args)
    kwargs_safe = dict([(k, conditional_escape(v)) for (k, v) in
                        six.iteritems(kwargs)])
    return mark_safe(format_string.format(*args_safe, **kwargs_safe))

def format_html_join(sep, format_string, args_generator):
    #django.utils.html
    """
    A wrapper of format_html, for the common case of a group of arguments that
    need to be formatted using the same format string, and then joined using
    'sep'. 'sep' is also passed through conditional_escape.

    'args_generator' should be an iterator that returns the sequence of 'args'
    that will be passed to format_html.

    Example:

    format_html_join('\n', "<li>{0} {1}</li>", ((u.first_name, u.last_name)
    for u in users))

    """
    return mark_safe(conditional_escape(sep).join(
            format_html(format_string, *tuple(args))
            for args in args_generator))

def is_protected_type(obj):
    return isinstance(obj, six.integer_types + (type(None), float, Decimal,
        datetime.datetime, datetime.date, datetime.time))

def force_text(s, encoding='utf-8', strings_only=False, errors='strict'):
    if isinstance(s, six.text_type):
        return s
    if strings_only and is_protected_type(s):
        return s
    try:
        if not isinstance(s, six.string_types):
            if hasattr(s, '__unicode__'):
                s = s.__unicode__()
            else:
                if six.PY3:
                    if isinstance(s, bytes):
                        s = six.text_type(s, encoding, errors)
                    else:
                        s = six.text_type(s)
                else:
                    s = six.text_type(bytes(s), encoding, errors)
        else:
            s = s.decode(encoding, errors)
    except UnicodeDecodeError as e:
        if not isinstance(s, Exception):
            raise encoding.DjangoUnicodeDecodeError(s, *e.args)
        else:
            s = ' '.join([force_text(arg, encoding, strings_only,
                    errors) for arg in s])
    return s 
```

所以，我想问一下`Field`类（或`Form`类）究竟如何从 中获取原始值（html），`Widget`以及如何应用验证过滤器并返回结果。请提供一个带有描述的小示例，以便理解该过程。

***请注意**，我已经看过 [Django 代码][3]，不幸的是我无法完全理解该过程。

谢谢是提前。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:07:14.123

首先我不得不说我的方法是不正确的。由于确实违反了*LSP 原则*`name`，因此删除和`value`退出的论点是错误的决定。此外，输入字段最基本的东西是它们也包含在*POST*请求中。`render()`*`name``value`*

 **之后我发现了[forms.py](https://github.com/django/django/blob/1.3/django/forms/forms.py)中的渲染过程。小部件在类中呈现，`BoundField()`该类在调用时会自动调用该`as_widget()`函数。所以[forms.py](https://github.com/django/django/blob/1.3/django/forms/forms.py)完成了所有的渲染过程。

*接下来，我使用示例应用程序演示该过程。*

# 应用结构

* * *

1）首先我们有我们的表单类：

### my_form.py：

```
from django import forms

class ContactForm(forms.Form):
    subject = forms.CharField(min_length = 2, max_length = 100, widget = forms.TextInput(attrs = {'placeholder':'Type a subject...'}))
    email = forms.EmailField(required=True, widget = forms.TextInput(attrs={'class': 'span3', 'placeholder': 'Your email...'}))
    message = forms.CharField(widget=forms.Textarea(attrs={'rows': '5', 'placeholder': 'Type a message...'}))

    def clean_message(self):
        message = self.cleaned_data['message']
        num_words = len(message.split())
        if num_words < 4:
            raise forms.ValidationError("Not enough words!")
            return message 
```

2）其次我们的观点：

### 视图.py：

```
def contact(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            cd = form.cleaned_data
            try:
                send_mail(
                    cd['subject'],
                    cd['message'],
                    cd.get('email', 'noreply@anonymous.com'),
                    ['myemail@ahost.com'],
                )
            except BadHeaderError:
                return HttpResponse('Invalid header found.')

            return HttpResponseRedirect('thank-you/')
    else:
        form = ContactForm()

    return render_to_response('/contact.html', {'form': form}) 
```

3) 模板：

### 联系人.html

```
{% if form.errors %}
    <p style="color: red;">
        Please correct the error{{ form.errors|pluralize }} below.
    </p>
{% endif %}

<form action="" method="post">
    <fieldset>
        <legend>Contact</legend>
        <div class="field">
            {{ form.subject.errors }}
        </div>
        {{ form.as_table }}
        <br />
        <button type="submit" class="btn">Submit</button>
    </fieldset>
</form> 
```

# 处理步骤

* * *

1) 用户点击指向我们的*views.py* `contact()`函数的链接，该函数调用我们的表单并将其与我们的模板一起提供。

2）在调用模板时`{{ form.as_table }}`，应用程序进入[forms.py](https://github.com/django/django/blob/1.3/django/forms/forms.py)并找到`BaseForm()`类，然后找到这个函数（复制粘贴）：

```
def as_table(self):
    "Returns this form rendered as HTML <tr>s -- excluding the <table></table>."
    return self._html_output(
        normal_row = u'<tr%(html_class_attr)s><th>%(label)s</th><td>%(errors)s%(field)s%(help_text)s</td></tr>',
        error_row = u'<tr><td colspan="2">%s</td></tr>',
        row_ender = u'</td></tr>',
        help_text_html = u'<br /><span class="helptext">%s</span>',
        errors_on_separate_row = False) 
```

3）上面的函数调用了另一个函数，当然`self._html_output(...)`也存在于`BaseForm()`其中。该函数负责输出调用其他较小的函数或类所呈现的最终结果。

## 一些笔记

* * *

*   当在*views.py*`form = ContactForm()`中执行时，我们知道它被称为类。但是这个类是一个子类，它存在于*forms.py*中，也是类的子类。这意味着继承自.*`ContactForm()``Form`*`Form()``BaseForm()``ContactForm()``BaseForm()`**
***   `Form()`班级是空的。仅继承自`BaseForm()`并用于继承目的。每个表单的真正父级是`BaseForm()`类。*   在初始化的时候当`ContactForm()`和他的父母`Form()`和`BaseForm()`被称为一些非常重要的变量发生时，比如`self.fields`其中包含了所有孩子的字段。在我们的示例中：`subject`, `email`, `message`. 其他重要的变量是：
    *   `self.data`: 包含*POST*数据
    *   `self._errors`：在调用 clean() 后存储错误。**

 **## 代替`_html_output()`

* * *

这个函数迭代`self.fields`（在我们的例子中是 over `subject`, `email`, ）并为每一个`message`调用类，如下所示：`BoundField()`

`bf = BoundField(frm_clss, field, name)`

第一个参数`frm_clss`是`BaseForm()`类。第二个是字段列表中的当前字段（例如`subject`），第三个是里面给出的字段的实际名称`ContactForm()`，所以三个名称分别是：“主题”、“电子邮件”和“消息”。

最后，此函数返回一个“已编译”并标记为所有呈现的小部件的安全字符串。

```
output.append(normal_row % {
    'errors': force_unicode(bf_errors),
    'label': force_unicode(label),
    'field': unicode(bf),
    'help_text': help_text,
    'html_class_attr': html_class_attr
    })

    .
    .
    .

return mark_safe(u'\n'.join(output)) 
```

## BoundField() 类

* * *

默认情况下调用`render()`小部件的方法并将 html 字符串返回给`BaseForm()`类 ( `_html_output()`)。****

# parsing - 使用 flex+bison 解析 bibtex：重新访问

> ID：15305789
> 
> 赞同：1
> 
> 时间：2013-03-09T00:43:32.003
> 
> 标签：parsing, bison, flex-lexer, bibtex

在过去的几周里，我正在尝试使用 flex 和 bison为 bibtex ( [http://www.bibtex.org/Format/ ) 文件编写一个解析器。](http://www.bibtex.org/Format/)

```
$ cat raw.l
%{
#include "raw.tab.h" 
%}
value [\"\{][a-zA-Z0-9 .\t\{\} \"\\]*[\"\}]
%%
[a-zA-Z]*               return(KEY);
\"                          return(QUOTE);
\{                          return(OBRACE);
\}                          return(EBRACE);
;                           return(SEMICOLON);
[ \t]+                  /* ignore whitespace */;
{value}     {
    yylval.sval = malloc(strlen(yytext));
    strncpy(yylval.sval, yytext, strlen(yytext));
    return(VALUE);
}

$ cat raw.y
%{
#include <stdio.h>
%}

//Symbols.
%union
{
 char *sval;
};
%token <sval> VALUE
%token KEY
%token OBRACE
%token EBRACE
%token QUOTE
%token SEMICOLON 

%start Entry
%%

Entry:
     '@'KEY OBRACE VALUE ',' 
     KeyVal
     EBRACE
     ;

KeyVal:
      /* empty */
      | KeyVal '=' VALUE ','
      | KeyVal '=' VALUE 
      ;
%%

int yyerror(char *s) {
  printf("yyerror : %s\n",s);
}

int main(void) {
  yyparse(); 
```

}

%% 一个示例 bibtex 是：

```
@Book{a1,
    author = "a {\"m}ook, Rudra Banerjee",
    Title="ASR",
    Publisher="oxf",
    Year="2010",
    Add="UK",
    Edition="1",
}
@Article{a2,
    Author="Rudra Banerjee",
    Title="Fe{\"Ni}Mo",
    Publisher={P{\"R}B},
    Issue="12",
    Page="36690",
    Year="2011",
    Add="UK",
    Edition="1",
} 
```

当我试图解析它时，它给出了语法错误。使用 GDB，它显示它期望声明 KEY 中的字段（可能），

```
Reading symbols from /home/rudra/Programs/lex/Parsing/a.out...done.
(gdb) Undefined command: "".  Try "help".
(gdb) Undefined command: "Author".  Try "help".
(gdb) Undefined command: "Editor".  Try "help".
(gdb) Undefined command: "Title".  Try "help".
..... 
```

如果有人在这方面帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T02:06:19.893

很多问题。首先，您的词法分析器很困惑，试图将带引号的字符串和大括号的东西识​​别为`VALUE`单个字符，并试图识别像`"`and之类的单个字符`{`。对于引号，让词法分析器识别整个字符串是有意义的，但对于要解析的结构性事物（如花括号列表），您需要返回单个标记以供解析器解析。其次，在为字符串分配空间时，您不会为 NUL 终止符分配空间。最后，您的语法看起来很奇怪，想要将诸如`= VALUE = VALUE`KeyValue 之类的东西解析为与 bibtex 文件中的任何内容都不对应的东西。

首先，对于词法分析器。您想识别带引号的字符串和标识符，但其他内容应该是单个字符：

```
[A-Za-z][A-Za-z0-9]*      { yylval.sval = strdup(yytext); return KEY; }
\"([^"\]|\\.)*\"          { yylval.sval = strdup(yytext); return VALUE; }
[ \t\n]                   ; /* ignore whitespace */
[{}@=,]                   { return *yytext; }
.                         { fprintf(stderr, "Unrecognized character %c in input\n", *yytext); } 
```

现在您需要一个用于条目的解析器：

```
Input: /* empty */ | Input Entry ;  /* input is zero or more entires */
Entry: '@' KEY '{' KEY ',' KeyVals '}' ;
KeyVals: /* empty */ | KeyVals KeyVal ; /* zero or more keyvals */
KeyVal: KEY '=' VALUE ',' ; 
```

那应该解析你给出的例子。

# android - AlertDialog - 自定义视图和标题/按钮之间的差距

> ID：15305791
> 
> 赞同：0
> 
> 时间：2013-03-09T00:43:44.850
> 
> 标签：android, xamarin.android, android-alertdialog, xamarin

我为 AlertDialog 使用自定义视图。在模拟器中，customeView 的上方和下方都有一些空间。如果我为 AlertDialog 设置标题和按钮，我可以看到标题面板/按钮面板和 customView 之间的差距。我怎样才能消除差距？

![在此处输入图像描述](../Images/1a44d451f7d4ecc1c5aa6fca13b98084.png)

我打开 AlertDialog 的代码：

```
 btnShowDialog.Click += (object sender, EventArgs e) => 
        { 
            var customView = LayoutInflater.Inflate(Resource.Layout.myDialog, null); 
            var builder = new AlertDialog.Builder(this); 
            builder.SetTitle("Title"); 
            builder.SetView(customView); 

            builder.Create().Show(); 
        }; 
```

customView 布局：

```
<?xml version="1.0" encoding="utf-8"?> 
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:background="#FFFFFF">
    <TextView 
        android:id="@+id/DialogText" 
        android:text="This is my custom view. Blur Blur Blur" 
        android:layout_marginLeft="10dp" 
        android:layout_marginRight="10dp" 
        android:layout_height="wrap_content" 
        android:layout_width="wrap_content" />
    <EditText 
        android:id="@+id/EnterPhone" 
        android:inputType="phone" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:layout_marginLeft="10dp" 
        android:layout_marginRight="10dp" 
        android:hint="enter your number" />
</LinearLayout> 
```

我已经在 android 4.0.3 和 4.1.2 模拟器中测试了 AlertDialog 并得到了同样的问题。

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T21:00:29.000

而不是像这样使用`AlertDialog`尝试使用：`Dialog`

```
var dialog = new Dialog(this);
dialog.SetTitle("Hey there");

dialog.SetContentView(Resource.Layout.myDialog);
dialog.Show(); 
```

这给了我一个底部没有间隙的对话框。

![没有底部间隙的对话框](../Images/43739645d969d25f5ce6447031676b3e.png)

`Dialog`您也可以留下标题并用您的自定义视图填充整个标题。

```
var dialog = new Dialog(this);
dialog.RequestWindowFeature((int)WindowFeatures.NoTitle);

dialog.SetContentView(Resource.Layout.myDialog);
dialog.Show(); 
```

并使用此布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#FFFFFF">
    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="#000000">
        <TextView
            android:text="Hey there"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_margin="10dp"
            style="@android:style/TextAppearance.DialogWindowTitle" />
    </LinearLayout>
    <TextView
        android:id="@+id/DialogText"
        android:text="This is my custom view. Blur Blur Blur"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content" />
    <EditText
        android:id="@+id/EnterPhone"
        android:inputType="phone"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:hint="enter your number" />
</LinearLayout> 
```

![没有间隙的对话](../Images/90bec3dfe17346cb1158531766cf3efa.png)

# javascript - nvd3 显示大黑点，且未完全渲染

> ID：15305801
> 
> 赞同：4
> 
> 时间：2013-03-09T00:44:48.730
> 
> 标签：javascript, d3.js, nvd3.js

我正在尝试使用 d3.js 和[nvd3](http://nvd3.org/)创建折线图，但我不断收到渲染错误，这似乎导致多个元素绘制不正确或根本不绘制。

错误控制台中显示的错误是`Error: Problem parsing d="MZ"`

在查看 nvd3 的代码后，我发现代码加入了一个顶点列表，使用`L`, （所以一个正确点的例子是`d="M0 0L1 1L1 0Z`）

我创建图表的代码是：

```
nv.addGraph(function () {
  var chart = nv.models.stackedAreaChart()
    .x(function (d) {
    return d[0]
  })
    .y(function (d) {
    return d[1]
  })
    .showControls(false)
    .showLegend(false);

  d3.select('#mygraph')
    .datum(data2)
    .call(chart);

  nv.utils.windowResize(chart.update);

  return chart;
}); 
```

错误的一个例子是在线[here](http://jsfiddle.net/Sssv7/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:50:52.420

`CSS`缺少（从这里）[。](http://nvd3.org/src/nv.d3.css)
我已经更新了 jsfiddle：http: [//jsfiddle.net/Sssv7/2/](http://jsfiddle.net/Sssv7/2/)。
您必须添加 CSS 或添加您自己的类来自定义它的外观。

# c# - 在运行时动态定义通用类型 T

> ID：15305804
> 
> 赞同：0
> 
> 时间：2013-03-09T00:45:00.870
> 
> 标签：c#, fluentvalidation

1\. 我有一个以对象响应作为参数的函数 DoSomeService。响应是不同的类，内部代码决定在运行时动态使用哪一个。

2\. 我有一个通用的 Fluent Validator<T>，它接受响应类的类型，然后对其进行验证。

现在，我可以一一进行类型检查：

```
public override void DoSomeService(object response) {
    object validator = null;
    if (response.GetType()==typeof(TypeA_Response)) validator= new Validator<TypeA_Response>();
    if (response.GetType()==typeof(TypeB_Response)) validator= new Validator<TypeB_Response>();
    if (response.GetType()==typeof(TypeC_Response)) validator= new Validator<TypeC_Response>();
    //......
    if (response.GetType()==typeof(TypeX_Response)) validator= new Validator<TypeX_Response>();
        if (validator.IsValid) {
        //do more stuff ...
    }
} 
```

但这并不好，尤其是当我有很多回复时。我想要一些简短而通用的东西。

```
//response could be TypeA_Response, TypeB_Response, TypeX_Response
public override void DoSomeService(object response) {
    var validator = new Validator<T>();
    if (validator.IsValid) {
        //do more stuff ...
    }
} 
```

当然，这行不通，因为我需要为 Fluent Validator 定义 T。如何检测什么类型是“对象响应”并在运行时将其动态填充到 T 中？

**或者我如何避免一起做这一切，并为我的验证器<T>提供更好的结构？**

请注意，我无法更改基础服务类和 DoSomeService 函数签名，它是来自 3rd 方包的覆盖函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:50:18.757

如果您真的希望这是动态的，最好的方法是使用反射

```
void DoSomething(object response)
{
    var type = typeof(Validator<>);
    var boundType = type.MakeGenericType(response.GetType());
    var validator = Activator.CreateInstance(boundType);
} 
```

即使使用此解决方案，您也无法`Validator<T>`在此上下文中使用，因为您仍然不知道是什么`T`。 `T`必须静态定义才能以这种方式使用。您将需要分解`Validator<T>`为泛型和非泛型基类型，并在`DoSomething`方法中使用非泛型类型

```
Validator valdiator = Activator.CreateInstance(boundType); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T00:48:42.733

这并不是泛型的真正用途。相反，您将拥有一个具有执行验证的虚拟方法的基类，或者要求具体类型实现一个具有验证方法的特定接口。

# heroku - 无法将 ruby on rails 应用程序推送到 Heroku - 网络问题？

> ID：15305806
> 
> 赞同：2
> 
> 时间：2013-03-09T00:45:13.320
> 
> 标签：heroku

我在一个班级，要求我们将我们的 ruby​​ on rails 应用程序放在 Heroku 上。他们给了我们一步一步的指导来设置 Heroku，我照做了。我可以从命令行登录到 heroku，但是当我尝试将我的应用程序推送到它时，我得到了这个：

```
Read from socket failed: Connection reset by peer
fatal: The remote end hung up unexpectedly 
```

我已经ping了服务器，它工作正常。我试过重新启动，一天后回来，重新创建应用程序，效果很好。我检查以确保我有 Heroku 工具带。我花了几个小时搜索谷歌。我还没有找到解决方案。

跑步后`ssh -vvv mylogin@heroku`我得到了

```
OpenSSH_5.9p1 Debian-5ubuntu1, OpenSSL 1.0.1 14 Mar 2012
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: Applying options for *
debug2: ssh_connect: needpriv 0
ssh: Could not resolve hostname heroku: Name or service not known 
```

跑步后`ssh git@heroku.com -T`我得到了

```
Warning: Permanently added the RSA host key for IP address '50.19.85.154' to the list of known hosts.
Permission denied (publickey). 
```

所以我`git push heroku master`再次尝试并得到了

```
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T22:16:17.360

所以我开始工作了！感谢那些做出回应的人 - 他们让我走上了解决问题的道路。所以这就是我所做的。

我跑了`ssh -vvv reneeggallison@gmail.com@heroku`，这给了我

```
OpenSSH_5.9p1 Debian-5ubuntu1, OpenSSL 1.0.1 14 Mar 2012
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: Applying options for *
debug2: ssh_connect: needpriv 0
ssh: Could not resolve hostname heroku: Name or service not known 
```

在研究了这个错误后，我决定运行`ssh git@heroku.com -T`，收到这个是响应：

```
Warning: Permanently added the RSA host key for IP address '50.19.85.154' to the list of known hosts.
Permission denied (publickey). 
```

`git push heroku master`这改变了我的错误

```
Read from socket failed: Connection reset by peer
fatal: The remote end hung up unexpectedly 
```

到

```
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

因此，在研究了该错误后，我运行了`heroku keys:add ~/.ssh/id_rsa.pub`它返回：

```
Uploading SSH public key /home/renee/.ssh/id_rsa.pub... done 
```

这对我来说似乎很好，我`git push heroku master`再次跑步并取得了成功。所以谢谢大家，祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T08:17:32.907

尝试使用以下命令进行调试：

```
ssh -vvv yourlogin@heroku 
```

[以下是来自 SO 答案的一些调试提示](https://stackoverflow.com/questions/922210/unable-to-git-push-master-to-github/922461#922461)

# c# - 获取在线好友 C# facebook.dll

> ID：15305808
> 
> 赞同：-1
> 
> 时间：2013-03-09T00:45:28.117
> 
> 标签：c#, facebook, facebook-fql

我想获取在线朋友列表，我有 `An unhandled exception of type 'Facebook.FacebookApiException' occurred in Facebook.dll Additional information: (104) Requires valid signature`

我的代码有什么问题？谢谢！

```
var fb = new FacebookClient();
dynamic myInfo = fb.Get("vasya.pupkin");
var uId = myInfo.id;

dynamic friends = fb.Query("SELECT uid FROM user WHERE online_presence IN ('active', 'idle')           AND uid IN (SELECT uid2 FROM friend WHERE uid1 = "+uId+")");

//WriteLine(friends.Count); 
```

而且我不明白`uid`, `uid2`, `uid1`- 的含义是什么，它必须写成它，或者我必须在那里写一些 id（因为我在行尾写 +uId+ ？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:58:28.837

好吧，Facebook 需要一个身份验证令牌。该变量通常由那些 Key 和 Secret 请求分配。如果 Facebook 用户没有接受正确的身份验证或应用程序，它将无法工作。

我提到*Token*的原因是因为 UID 通常是配置文件或应用程序标识符之后的数字，如下所示：

![UID 示例](../Images/44ed3c2b76b8384b4de5fb3fe03d9447.png)

我不确定你在哪一步，但是： ![Facebook 密钥和秘密](../Images/0f25785e36c98f556709e61069d0c412.png)

您必须创建一个使用应用程序 ID 和应用程序秘密的应用程序。没有该令牌，您实际上无法访问 Facebook。

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <appSettings>
    <add key="EnableSqlDependency" value="true" />
    <add key="ApplicationId" value="<YOUR APP ID GOES HERE>" />
    <add key="ApplicationUrl" value="" />
    <add key="ApiKey" value="" />
    <add key="ApplicationSecret" value="<YOUR APP SECRET GOES HERE>" />
    <add key="ExtendedPermissions" value="offline_access" />
  </appSettings>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0" />
  </startup>
</configuration> 
```

将需要进入您的`app.config`.

现在在 Facebook 内部：

```
var fb = new FacebookClient(this.AccessToken);
dynamic result = fb.Post("me/feed", new { message = 
     "My second wall post using Facebook C# SDK" }); 
```

您将有权访问。

UID 基本上是您尝试识别的应用程序 ID 或用户 ID。这就是为什么您不断收到该错误的原因。您没有有效的会话来物理访问它。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:24:45.710

在查看了 FQL 文档并进一步搜索 StackOverflow 之后，我建议您看一下：[如何使用 FQL 和 facebook API 获取在线好友列表？](https://stackoverflow.com/questions/1795934/how-to-get-list-of-online-friends-using-fql-with-facebook-api)

您可能还需要看看这里：[Facebook 在线朋友](https://stackoverflow.com/questions/5666153/facebook-online-friend)

我建议你下次多花点时间浏览 StackOverflow 网站，因为它花了 10 秒时间和谷歌查询“facebook api get online friends”来找到我提供的答案。

# c# - MS Windows 服务和 https

> ID：15305809
> 
> 赞同：-1
> 
> 时间：2013-03-09T00:45:38.240
> 
> 标签：c#, .net, ssl, https, windows-services

我有一个安装了 SSL 的网站，所以它在 FirstData.com 的 HTTPS 下工作

现在我必须创建 MS Windows 服务，它应该像网站在 SSL 下所做的那样做同样的事情。

所以我关于将 SSL 与 MS Windows 服务一起使用的问题......有没有可能做任何线索？

我的意思是通过 https 以某种方式使用 MS Windows 服务在 SSL 下与 FirstData.com 交互。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:03:15.613

```
System.Net.HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(new Uri("https://mydomain.com/etc")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T02:01:29.287

您可以使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)类向安全站点发出请求。

一个例子是

```
var request = WebRequest.Create(new Uri("https://www.example.com")) as HttpWebRequest; 
```

但是，请记住，安全站点可能具有无效的证书。如果您信任您的端点并希望忽略“证书无效”警告，[则此](https://stackoverflow.com/a/561242/326543)答案将讨论如何执行此操作。

# javascript - Google Maps API 按纬度/经度删除标记

> ID：15305811
> 
> 赞同：1
> 
> 时间：2013-03-09T00:45:46.657
> 
> 标签：javascript, google-maps, marker

我有一个谷歌地图，我不断用标记更新。如果标记重叠（完全相同的位置），我有一个计数器可以添加到标记内的数字。问题是每次我添加一个新标记时，它并不总是把它放在另一个标记的顶部。因此，例如，标记中有数字 10。一个新的标记出现 11，在动画之后它隐藏在 10 后面。有时在几个标记之后，顶部标记将是正确的数字，例如 21 而不是 10。

那么有没有办法在添加新标记之前按纬度/经度删除标记？这是我所拥有的：

```
for (var i=0; i<response.trans.length; i++) {
    //add to location 
    location[response.trans[i].location_id] += 1;

    latLng = new google.maps.LatLng(response.trans[i].latitude, response.trans[i].longitude);
    marker = new google.maps.Marker({
         map:map,                                                           
         position: latLng, 
         icon: 'http://chart.apis.google.com/chart?chst=d_map_spin&chld=1|0|FF0000|12|_|'+client[response.trans[i].location_id], 
         animation: google.maps.Animation.DROP
   });
   markers.push(marker);
} 
```

谢谢雷蒙德！你把我推向了正确的方向

这是对我有用的代码：

```
for (var i=0; i<response.trans.length; i++) {
    //add to total count
    totalCount += 1;

    //add to location
    location[response.trans[i].location_id] += 1;

    markerChanged = false;
    for(x=0; x < markers.length; x++){
        if(markers[x].getPosition().lat().toFixed(6) == response.trans[i].latitude.toFixed(6) && markers[x].getPosition().lng().toFixed(6) == response.trans[i].longitude.toFixed(6)){
            markers[x].setIcon('http://chart.apis.google.com/chart?chst=d_map_spin&chld=1|0|FF0000|12|_|'+location[response.trans[i].location_id]);
            markers[x].setAnimation(google.maps.Animation.DROP);
            markerChanged = true;
        }
    }

    if(markerChanged === false){
        latLng = new google.maps.LatLng(response.trans[i].latitude, response.trans[i].longitude);
        marker = new google.maps.Marker({
            map:map,
            position: latLng, 
            icon: 'http://chart.apis.google.com/chart?chst=d_map_spin&chld=1|0|FF0000|12|_|'+location[response.trans[i].location_id], 
            animation: google.maps.Animation.DROP
        });
        markers.push(marker);
     }
 } 
```

所以我添加了内部 for 循环，它检查当前标记。我不得不使用 toFixed(6) 将其更改为字符串。浮点精度正在抛弃准确性。因此，如果标记相同，它将更改图标。如果它是一个新标记，它会将其添加到地图中。我添加了 DROP 动画，因为我仍然希望它明显更新。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:51:50.737

我相信您可以在将标记添加到地图之前汇总列表的信息。那是，

```
var location = {};

for (var i = 0; i < response.trans.length; i++) {
  location[response.trans[i].location_id] += 1;
}

for (location_id in location) {
  if (location.hasOwnProperty(location_id)) {
    /* add marker */
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:01:44.993

如果它们是相同的确切位置，您可以尝试：

```
for(i=0; i < markers.length; i++) {
    if(markers[i].getPosition().lat() == response.trans[i].latitude && markers[i].getPosition().lng() == response.trans[i].longitude)
        markers[i].icon = "number11.png"
} 
```

# php - 使用 php 进行无监督文本分类

> ID：15305817
> 
> 赞同：3
> 
> 时间：2013-03-09T00:46:10.713
> 
> 标签：php, text, classification

是否有任何预制的 PHP 库可用于帮助处理涉及无监督文本分类^([信息](http://en.wikipedia.org/wiki/Document_classification#Automatic_document_classification))的任务？

我在网站上查看了其他问题，但我一直无法找到类似的问题。

我想学习如何实现一个无监督的分类系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T10:18:01.670

[https://github.com/gburtini/Learning-Library-for-PHP](https://github.com/gburtini/Learning-Library-for-PHP)

这里已经实现了一些通用的无监督算法。也许它会对你有用。

# python - Twisted：connectTCP后关闭连接而不丢失其他连接

> ID：15305820
> 
> 赞同：3
> 
> 时间：2013-03-09T00:46:34.590
> 
> 标签：python, tcp, twisted

我是 Twisted 的新手，我正在尝试弄清楚如何实现以下内容。我有一个服务器，它从客户端接收消息。但是，此服务器在收到消息后将消息从客户端发送到另一台服务器。所以它看起来像：

```
Client --->   Server1  --->   Server2 
```

因此，Server1 本质上既充当服务器又充当客户端。但是，在 Server1 向 Server2 发送信息后，我想断开 Server1 与 Server2 的连接。我不确定我该怎么做。

我现在工作的是客户端向 Server1 发送信息。然后我稍微修改输入，然后`reactor.connectTCP()`成功连接并将信息发送到 Server2。我的问题是如何关闭连接而不必完全关闭 Server1。我尝试使用`transport.loseConnection( )`，但这会在与 Server2 断开连接时关闭 Server1。

我正在考虑`reactor.spawnProcess()`以某种方式使用，但我无法让它工作。据我所知，当我关闭连接时，它会关闭进程，所以如果我可以与另一个进程进行 connectTCP，它不应该影响其他进程。

这是我的代码

```
import time, datetime
import re
from twisted.internet import stdio, reactor, protocol
from twisted.protocols import basic

result = 'The AT message is unavailable (no previous talk with client)'

class DataForwardingProtocol(protocol.Protocol):
    def __init__(self):
        self.output = None
        self.normalizeNewlines = False

    def dataReceived(self, data):
        if self.normalizeNewlines:
            data = re.sub(r"(\r\n|\n)", "\r\n", data)
        if self.output:
            self.output.write(data)

class StdioProxyProtocol(DataForwardingProtocol):
    global result
    def connectionMade(self):
        inputForwarder = DataForwardingProtocol()
        inputForwarder.output = self.transport
        inputForwarder.normalizeNewlines = True
        stdioWrapper = stdio.StandardIO(inputForwarder)
        self.output = stdioWrapper
        self.transport.write(result)
        self.transport.loseConnection( )

class StdioProxyFactory(protocol.ClientFactory):
    protocol = StdioProxyProtocol

    def clientConnectionLost(self, transport, reason):
        reactor.stop()

    def clientConnectionFailed(self, transport, reason):
        print reason.getErrorMessage()
        reactor.stop()

class EchoProtocol(basic.LineReceiver):

    def dataReceived(self, line):
      #Do stuff with the input sent from the client.  This is irrelevant to my problem.
                #UPDATE OTHER SERVERS
                reactor.connectTCP('localhost', 12771, StdioProxyFactory())   

class EchoServerFactory(protocol.ServerFactory):
    protocol = EchoProtocol

if __name__ == "__main__":
    port = 12770
    reactor.listenTCP(port, EchoServerFactory( ))
    reactor.run( ) 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T15:03:25.767

您的 Server1 正在关闭，因为您调用`reactor.stop()`了工厂的`clientConnectionLost()`方法，而不是因为`transport.loseConnection()`调用。您可能不想在第一个传出连接丢失后立即关闭整个反应器。

# java - 字符串无法转换为 JSON 数组

> ID：15305828
> 
> 赞同：-3
> 
> 时间：2013-03-09T00:47:56.587
> 
> 标签：java, php, android, json, parsing

每次尝试执行我的代码时，我都会收到以下错误：

```
03-09 00:41:23.022: E/JustDealsUtils(1163): Error parsing to json on getJarrayFromString(); org.json.JSONException: Value Database of type java.lang.String cannot be converted to JSONArray
03-09 00:41:23.022: E/ActivityTab(1163): Error at fillPromotionList(): java.lang.NullPointerException 
```

Java 为`fillPromotionList()`：

```
public void onTaskCompleted(String result) {
  try {
    // converting the response into json array
    if(result != "") {
      jarray = utils.getJarrayFromString(result);

      // total number of rows for a query
      int mysqlSize = (jarray.getJSONObject(0)
        .getInt("numRows"));

      Log.i(DEBUG, "From " + from + " to " + mysqlSize);

      if(from <= mysqlSize) {
        int rows;
        if(jarray.length() > 0) {
          Log.i(DEBUG, "From " + from + " to " + Math.floor(mysqlSize / nr) * nr);
          if(from + 5 <= Math.floor(mysqlSize / nr) * nr) {
            rows = jarray.length();
          } else {
            rows = mysqlSize % nr + 1;
            Utils.IS_ENDED_PROMO_LIST = true;
          }
          ArrayList < String > list = new ArrayList < String > ();
          for(int i = 1; i < rows; i++) {
            JSONObject row = jarray.getJSONObject(i);
            soid.add(row.getInt("bid"));
            soTitle.add(row.getString("bTitle"));
            soCode.add(row.getString("bCode"));
            soPrice.add(row.getString("bPrice") + "£");
            soDescription.add(row.getString("bDescription"));
            soModule.add(row.getString("bModule"));
            soImage.add(Utils.PATH + row.getString("bImage"));
            soDiscount.add(row.getInt("bSpecialDiscount"));
            list.add(row.getString("bImage"));
            if(!db.hasIDBooks(row.getInt("bid"))) db.createRowOnBooks(row.getInt("bid"), row.getString("bTitle"), row.getString("bCode"), row.getString("bPrice"), row.getString("bDescription"), row.getString("bModule"), Utils.PATH + row.getString("bImage"), row.getString("bSpecialOffer"), row.getInt("bSpecialDiscount"), row.getString("bDateAdded"));
          }
          new DownloadImages(list, soAdapter)
            .execute();
        }
      }
      postParameters.removeAll(postParameters);
    } else {
      Utils.IS_ENDED_PROMO_LIST = true;
      if(rlLoading.isShown()) {
        rlLoading.startAnimation(fadeOut());
        rlLoading.setVisibility(View.INVISIBLE);
      }
    }
  } catch(Exception e) {
    Log.e(DEBUG, "Error at fillPromotionList(): " + e.toString());
  }
}
}); 
```

我为另一个列表函数编写了相同的代码，它工作正常。我无法纠正问题。

而且，它还指向一个空指针异常？？

这是此代码的我的 PHP API：

```
<?php
    include("MysqlConnection.php");
    $from = $_POST["from"];
    $nr = $_POST["nr"];
    // those variables are for search
    $title = $_POST["title"];
    $code = $_POST["code"];
    $price = $_POST["price"];
    $module = $_POST["module"];
    $order = $_POST["order"];
    $by = $_POST["by"];

    $sql = "SET CHARACTER SET utf8";
    $db->query($sql);

    if(isset($from) && isset($nr)){
        // we need to know how many rows are in total for this query
        $sql = "SELECT * FROM `books` WHERE `bSpecialOffer='true' AND `bCode` LIKE '%$code%' AND `bTitle` LIKE '%$title%' AND `bModule` LIKE '%$module%'";
        $query = $db->query($sql);

        $rows = array();
        $rows[] = array("numRows"=>$db->numRows($query));

        // if those 2 var are set then we order the query after them
        if(isset($order) && isset($by)){
            $sql .= " ORDER BY `$order` $by LIMIT $from, $nr";
        }else{
            $sql .= "LIMIT $from, $nr";
        }

        $query = $db->query($sql);

        if($db->numRows($query)!=0){
            while($row = mysql_fetch_assoc($query)) {
                $rows[] =  $row;
            }
            print_r(json_encode($rows));
        }
    }

    $db->closeConnection();
?> 
```

其实error也提到了`DATABASE VALUE`。这是否意味着错误在于 PHP API？

最后，这是我的 JSON 数组部分`utils.java`：

```
 public JSONArray getJarrayFromString(String result) {
   // Parsing string to JSON Array
   try {
     jarray = new JSONArray(result);
   } catch(JSONException e) {
     Log.e(DEBUG, "Error parsing to json on getJarrayFromString(); " + e.toString());
   }

   return jarray;
 } 
```

您的建议和意见将不胜感激。非常感谢。

来自 SQL 数据库的 BOOKS 表的片段。

```
CREATE TABLE `books` (
  `bid` int(11) NOT NULL auto_increment,
  `bCode` varchar(50) NOT NULL,
  `bTitle` varchar(100) NOT NULL,
  `bPrice` int(50) NOT NULL,
  `bDescription` longtext NOT NULL,
  `bModule` varchar(50) NOT NULL,
  `bImage` varchar(80) NOT NULL,
  `bDateAdded` date NOT NULL,
  `bSpecialOffer` varchar(5) NOT NULL,
  `bSpecialDiscount` int(3) NOT NULL,
  PRIMARY KEY  (`bid`),
  UNIQUE KEY `bTitle` (`bTitle`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=49 ;

--
-- Dumping data for table `books`
--

INSERT INTO `books` VALUES(1, "MDAI001", "Apocalyptic AI", 50, "Author: Robert M.Geraci\r\n\r\nEdition: 5th Edition \r\n\r\nTopics: Intelligence Agents,Solving problems by seraching, Beyond classical search, Algorithms and Adversarial search, logical agents", "MDAI72", "image26.jpg", "2013-01-12", "true", 30);
INSERT INTO `books` VALUES(19, 'MDAI002', 'Programming Game AI by Example', 15, 'Author: Mat Buckland\r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: Learning from examples, Knowledge in learning, Reinforcement learning, Learning probabalistic model, Non parametric models', 'MDAI72', 'image27.jpg', '2013-01-25', 'false', 0);
INSERT INTO `books` VALUES(20, 'MDAI003 ', 'Artificial Inteligence', 26, 'Author: George F Luger\r\n\r\nEdition: 1st Edition \r\n\r\nTopics: Artificial neural networks, Language models, Speech recognition, Syntactic analysis, Image formation, Reconstructing the 3D world, Machine translation ', 'MDAI72', 'image28.jpg', '2012-05-18', 'false', 0);
INSERT INTO `books` VALUES(21, 'MDAI004 ', 'Artificial Intelligence Programming', 10, 'Author: Peter Narvig\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: Learning from examples, Knowledge in learning, Reinforcement learning, Learning probabalistic model, Non parametric models\r\n', 'MDAI72', 'image29.jpg', '2012-03-17', 'false', 0);
INSERT INTO `books` VALUES(22, 'MDAI005', 'Artificial Intelligence: A Systems Approach', 35, 'Author: Dan Jones\r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: Robotic perception, Robotic software architectures, Strong AI vs Weak AI,  The ethics and risks of developing AI, Can machines really think? \r\n', 'MDAI72', 'image30.jpg', '2012-01-20', 'false', 0);
INSERT INTO `books` VALUES(24, 'MDSC001 ', 'Distributed and Cloud Computing', 30, 'Author: Kay Hwang\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: Modern distributed models, Peer-to-peer computing, Open source and commercial vendors', 'MDSC48', 'image21.jpg', '2012-02-16', 'false', 0);
INSERT INTO `books` VALUES(25, 'MDSC002', 'Computing in the Social Sciences and Humanities', 12, 'Author: Orville Vernon Burton \r\n\r\nEdition: 5nd Edition \r\n\r\nTopics:A lively, hands-on introduction for teachers and scholars in the humanities and social sciences, this book-and-CD package will inspire even the faint-hearted to take the technological bull by the horns and make efficient, informed use of computer and Internet resources. New technology is changing the very nature of research and teaching in the social sciences and humanities.', 'MDSC48', 'image22.jpg', '2012-03-17', 'false', 0);
INSERT INTO `books` VALUES(26, 'MDSC003', 'Identity in the age of Cloud Computing ', 30, 'Author: J.D.Lasica\r\n\r\nEdition: 1st Edition \r\n\r\nTopics: The Mobile Generation: Global Transformations at the Cellular Level, Civic Engagement on the Move: How Mobile Media Can Serve the Public Good, Identity in the Age of Cloud Computing: The next-generation Internet’s impact on business, governance and social interaction', 'MDSC48', 'image23.jpg', '2012-10-10', 'false', 0);
INSERT INTO `books` VALUES(27, 'MDSC004', 'To the Cloud- Powering an Enterprise', 23, 'Author: Pankaj Arora\r\n\r\nEdition: 4th Edition \r\n\r\nTopics: Understand the Cloud\r\nUnderstand the Value Proposition\r\nChart the Cloud Landscape', 'MDSC48', 'image24.jpg', '2012-01-12', 'true', 20);
INSERT INTO `books` VALUES(28, 'MDSC005 ', 'Building Virtual Communities', 35, 'Author: K. Ann Renninger\r\n\r\nEdition: 1st Edition \r\n\r\nTopics: Building Virtual Communities examines how learning and cognitive change are fostered by online communities. Contributors to this volume explore this question by drawing on their different theoretical backgrounds, methodologies, and personal experience with virtual communities. Each chapter discusses the different meanings of the terms community, learning, and change', 'MDSC48', 'image25.jpg', '2012-09-23', 'false', 0);
INSERT INTO `books` VALUES(29, 'MDSE001', 'Software Engineering: Principles and Practice', 12, 'Author: Hans Van Vliet \r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: \r\nIntroduction to Software Engineering Management, The Software Life Cycle Revisited, Configuration Management, People Management and Team Organization, On Managing Software Quality, Cost Estimation, Project Planning and Control \r\n', 'MDSE80', 'image16.jpg', '2012-05-17', 'false', 0);
INSERT INTO `books` VALUES(30, 'MDSE002', 'Software Engineering: A Practioners Approach', 25, 'Author: Roger.S.Pressman\r\n\r\nEdition: 7th Edition \r\n\r\nTopics: \r\nThe seventh edition is considerably more than a simple update. The book has been revised and restructured to improve pedagogical flow and emphasize new and important software engineering processes and practices. In addition, a revised and updated “support system,” illustrated below, provides a comprehensive set of student, instructor, and professional resources to complement the content of the book.\r\n', 'MDSE80', 'image17.jpg', '2012-07-19', 'false', 0);
INSERT INTO `books` VALUES(31, 'MDSE003', 'Software Engineering for Students: A programming approach', 25, 'Author: Douglas Bell\r\n\r\nEdition: 4th Edition \r\n\r\nTopics: Software Engineering for Students presents a range of current techniques and tools for people who have experienced the pleasures of writing programs and who want to see how things change in the scale up to large programs and software systems.\r\n\r\n', 'MDSE80', 'image18.jpg', '2012-04-13', 'false', 0);
INSERT INTO `books` VALUES(32, 'MDSE004', 'Object Oriented Software', 32, 'Author: Michael Smith \r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: The book covers ANSI C++ and is illustrated with numerous programming examples. The first few chapters introduce computer programming for those who have no previous programming knowledge. The book avoids the early use of low level constructs such as pointers so that the key object-oriented concepts can be fully introduced', 'MDSE80', 'image19.jpg', '2012-04-17', 'false', 0);
INSERT INTO `books` VALUES(33, 'MDPG001', 'iPhone Programming', 14, 'Author: Alasdair Allan\r\n\r\nEdition: 1st Edition \r\n\r\nTopics: The book guides you through developing your first application for the iPhone, from opening Xcode for the first time, to submitting your application to the App Store. You''ll learn about Objective-C and the core frameworks needed to develop for the iPhone by writing applications that use them, giving you a basic framework for building your own applications independently.\r\n', 'MDPG70', 'image6.jpg', '2012-07-19', 'false', 0);
INSERT INTO `books` VALUES(34, 'MDPG002', 'Java: Introduction to Problem Solving and Programming', 29, 'Author: Walter Savitch\r\n\r\nEdition: 1st Edition \r\n\r\nTopics: For introductory Computer Science courses using Java (CS1with Java), and other introductory programming courses in departments of Computer Science, Computer Engineering, Computer Information Systems, Management Information Systems, Information Technology, and Business.', 'MDPG70', 'image7.jpg', '2012-07-12', 'false', 0);
INSERT INTO `books` VALUES(35, 'MDSE005', 'Object-Oriented and Classical Software Engineering', 26, 'Author: Stephen R.Schach\r\n\r\nEdition: 8th Edition \r\n\r\nTopics: Building on seven strong editions, the eighth edition maintains the organization and approach for which "Object-Oriented and Classical Software Engineering" is known while making significant improvements and additions to content as well as problems and projects.\r\n', 'MDSE80', 'image20.jpg', '2012-10-17', 'false', 0);
INSERT INTO `books` VALUES(36, 'MDPG003', 'Web Services with Perl', 18, 'Author: Randy J. Ray\r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: Given Perl''s natural fit for web applications development, it''s no surprise that Perl is also a natural choice for web services development. It''s the most popular web programming language, with strong implementations of both SOAP and XML-RPC, the leading ways to distribute applications using web services. But books on web services focus on writing these applications in Java or Visual Basic, leaving Perl programmers with few resources to get them started. Programming Web Services with Perl changes that, bringing Perl users all the information they need to create web services using their favorite language.', 'MDPG70', 'image8.jpg', '2012-07-20', 'false', 0);
INSERT INTO `books` VALUES(37, 'MDPG004', 'Effective TCP/IP Programming: 44 Tips to Improve Your Network Programs', 34, 'Author: Jon C. Snader\r\n\r\nEdition: 4th Edition \r\n\r\nTopics: An excellent next-step for students who have read Stevens'' TCP/IP Illustrated series, this book is designed to boost programmers to a higher level of competence by focusing on the protocol suite''s more subtle features and techniques. In forty-four concise, self-contained lessons, this book offers experience-based tips, practices, and rules of thumb for learning high-performance TCP/IP programming techniques. Moreover, it shows you how to avoid many of TCP/IP''s most common trouble spots.', 'MDPG70', 'image9.jpg', '2012-02-25', 'false', 0);
INSERT INTO `books` VALUES(38, 'MDPG005', 'Pro Java Programming', 34, 'Author: Brett Spell\r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: Pro Java Programming, Second Edition covers the J2SE 5.0 platform and the core Java development kit. It takes advantage of the finer points of the core and standard edition of Java 2\. You''ll discover the particulars of working with the Java language and APIs to develop applications in many different contexts.', 'MDPG70', 'image10.jpg', '2012-10-20', 'false', 0);
INSERT INTO `books` VALUES(39, 'MDEC001', 'E-commerce: Business. Technology. Society', 26, 'Author: Kenneth C. Laudon\r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: Electronic commerce: Business. Technology. Society. provides an overview of the current and next generations of e-commerce. The book emphasizes the three major driving forces behind e-commerce: business development, technology change, and social controversies.', 'MDEC20', 'image11.jpg', '2012-08-18', 'false', 0);
INSERT INTO `books` VALUES(40, 'MDEC002 ', 'E-commerce Technology Foundations', 17, 'Author: Davis and Benamati\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: In E-Commerce Basics, the authors introduce the basic technological infastructure and business issues to understand when analyzing the feasibility of e-commerce initiatives\r\n', 'MDEC20', 'image12.jpg', '2012-10-16', 'false', 0);
INSERT INTO `books` VALUES(41, 'MDEC003', 'E-business and E-commerce Management', 21, 'Author: Dave Chaffey\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics:A comprehensive assessment of the management issues faced in implementing e-business solutions, this book is suitable for students or practitioners of e-business, e-commerce or e-marketing at any level. Each chapter contains management issues, activities and answers, case studies, questions for debate, self-assessment exercises, discussion, essay and exam questions, further reading, web links and more.\r\n', 'MDEC20', 'image13.jpg', '2012-05-13', 'false', 0);
INSERT INTO `books` VALUES(42, 'MDEC004', 'The Complete E-Commerce Book', 22, 'Author: Janice Reynolds \r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: The Complete E-Commerce Book offers a wealth of information on how to design, build and maintain a successful web-based business.... Many of the chapters are filled with advice and information on how to incorporate current e-business principles\r\n', 'MDEC20', 'image14.jpg', '2012-08-27', 'false', 0);
INSERT INTO `books` VALUES(43, 'MDEC005', 'Design and Launch an E-Commerce Business in a Week (ClickStart Series)', 35, 'Author: Jason Rich\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: In just days, you can build your own eCommerce website, reach potential customers by the millions, process orders 24/7 and accept payments from all over the world—with no technical background or graphic design skills!\r\n', 'MDEC20', 'image15.jpg', '2012-08-20', 'false', 0);
INSERT INTO `books` VALUES(44, 'MDCS001', 'Corporate Computer Security', 30, 'Author: Randall J. Boyle\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: A strong business focus through a solid technical presentation of security tools. Boyle/Panko provides a strong business focus along with a solid technical understanding of security tools. This text gives readers the IT security skills they need for the workplace. This edition is more business focused and contains additional hands-on projects, coverage of wireless and data security, and case studies.', 'MDCS10', 'image1.jpg', '2012-08-10', 'false', 0);
INSERT INTO `books` VALUES(45, 'MDCS002', 'Computer Security: Art and Science', 29, 'Author: Matt Bishop\r\n\r\nEdition: 5th Edition \r\n\r\nTopics: This book provides a thorough and comprehensive introduction to computer security. It covers both the theoretical foundations and practical aspects of secure systems.', 'MDCS10', 'image2.jpg', '2012-08-01', 'false', 0);
INSERT INTO `books` VALUES(46, 'MDCS003', 'Introduction to Computer Security ', 10, 'Author: Ralph Argiento\r\n\r\nEdition: 3rd Edition \r\n\r\nTopics: Introduction to Computer Security is a teaching and learning tool that was designed for use in a classroom setting, encouraging students to learn by using these new technologies hands-on.\r\n', 'MDCS10', 'image3.jpg', '2012-10-22', 'false', 0);
INSERT INTO `books` VALUES(47, 'MDCS004', 'A basic Introduction to Computer Security ', 17, 'Author: Addison Wesley \r\n\r\nEdition: 3rd Edition \r\n\r\nTopics:  Introduction to Computer Security, 1e does NOT focus on the mathematical and computational foundations of security, and it does not assume an extensive background in computer science. Instead it looks at the systems, technology, management, and policy side of security, and offers students fundamental security concepts and a working knowledge of threats and countermeasures with “just-enough” background in computer science. The result is a presentation of the material that is accessible to students of all levels.', 'MDCS10', 'image4.jpg', '2012-07-22', 'false', 0);
INSERT INTO `books` VALUES(48, 'MDCS005 ', 'Principles of Computer Security CompTIA Security + and Beyond', 21, 'Author: Gregory White\r\n\r\nEdition: 2nd Edition \r\n\r\nTopics: This up-to-date, full-color guide discusses communication, infrastructure, operational security, attack prevention, disaster recovery, computer forensics, and much more.\r\n', 'MDCS10', 'image5.jpg', '2012-10-22', 'false', 0); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:04:17.537

在 PHP 中，`print_r`用于调试，并打印关于变量的人类可读信息。你想用`print`

# algorithm - 找到覆盖空间中大多数点的圆

> ID：15305833
> 
> 赞同：9
> 
> 时间：2013-03-09T00:48:15.980
> 
> 标签：algorithm, computational-geometry, graph-algorithm

我参加了一家高频交易公司的面试。他们问我一个算法`O(n)`：

*   给定`n`空间点
*   给定一个散列函数，它返回平面中的点`O(1)`，
*   找到一个覆盖空间中最多点的最佳匹配圆。

## 要求：

*   圆心必须有整数坐标，它的半径是`3`。
*   圆内的点不一定有整数坐标

我用谷歌搜索并做了一些研究。有一个**O(n) 算法（来自普林斯顿大学的 Chazelle 的最佳圆圈放置）**，但它有点超出我的理解水平，并在 10 分钟内将其放在一起解释它。我已经知道`O(n^2)`和`O(n^3)`算法。

请帮我找到一个`O(n)`算法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T01:32:02.180

我猜整数坐标约束显着简化了问题。这对我来说看起来像 O(n)：

- 制作空间中所有整数点的字典，并将条目设置为 0。

- 对于每个数据点，找到半径 3 内的整数点，并将字典的相应条目加 1。这样做的原因是，可以作为该特定数据点所在的圆心的点集是围绕该数据点具有相同半径的圆的整数限制。可以对位于长度为 6 的正方形上的所有点进行搜索（认为并非所有点都需要明确评估，因为内接超立方体内的这些点肯定在里面）。

- 返回对应于字典最大值的整数点，即大多数数据点在圆内的中心。

**编辑：**我猜有些代码比解释更好。这是使用 numpy 和 matplotlib 工作的 python。阅读起来应该不会太难：

```
# -*- coding: utf-8 -*-
"""
Created on Mon Mar 11 19:22:12 2013

@author: Zah
"""

from __future__ import division
import numpy as np
import numpy.random
import matplotlib.pyplot as plt
from collections import defaultdict
import timeit
def make_points(n):
    """Generates n random points"""
    return np.random.uniform(0,30,(n,2))

def find_centers(point, r):
    """Given 1 point, find all possible integer centers searching in a square 
    around that point. Note that this method can be imporved."""
    posx, posy = point
    centers = ((x,y) 
        for x in xrange(int(np.ceil(posx - r)), int(np.floor(posx + r)) + 1)
        for y in xrange(int(np.ceil(posy - r)), int(np.floor(posy + r)) + 1)        
        if (x-posx)**2 + (y-posy)**2 < r*r)
    return centers

def find_circle(n, r=3.):
    """Find the best center"""
    points = make_points(n)
    d = defaultdict(int)
    for point in points:
        for center in find_centers(point, r):
            d[center] += 1
    return max(d , key = lambda x: d[x]), points

def make_results():
    """Green circle is the best center. Red crosses are posible centers for some
    random point as an example"""
    r = 3
    center, points = find_circle(100)
    xv,yv = points.transpose()
    fig = plt.figure()
    ax = fig.add_subplot(111)
    ax.set_aspect(1)
    ax.scatter(xv,yv)
    ax.add_artist(plt.Circle(center, r, facecolor = 'g', alpha = .5, zorder = 0))
    centersx, centersy  = np.array(list(find_centers(points[0], r))).transpose()
    plt.scatter(centersx, centersy,c = 'r', marker = '+')
    ax.add_artist(plt.Circle(points[0], r, facecolor = 'r', alpha = .25, zorder = 0))
    plt.show()

if __name__ == "__main__":
    make_results() 
```

结果： ![结果图](../Images/2920877d769d05a2a35b6121c6d8f267.png) 绿色圆圈是最好的，红色的东西展示了如何为某个随机点挑选中心。

```
In [70]: %timeit find_circle(1000)
1 loops, best of 3: 1.76 s per loop

In [71]: %timeit find_circle(2000)
1 loops, best of 3: 3.51 s per loop

In [72]: %timeit find_circle(3000)
1 loops, best of 3: 5.3 s per loop

In [73]: %timeit find_circle(4000)
1 loops, best of 3: 7.03 s per loop 
```

在我非常慢的机器上。行为显然是线性的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T03:35:55.760

有一个不同于（1）中所述的想法，它将要检查的圆圈数量减少到`O(n)`

**关键发现：** - 对于一个数据点 p，应该只有有限数量的半径为 3 的圆可以包含数据点 p！换句话说：具有（1st）半径3（2nd）整数作为中心点坐标和（3rd）包含一个特定数据点的圆的数量是O（1）！

**关键思想：** 迭代所有半径为 3 的潜在圆，并为每个圆计算它将包含的数据点的数量。

**算法：** - 我们初始化一个空哈希表 h，它映射一个圆中心点 - 即 (i,j) 的组合，其中 i 和 j 都是整数 - 到整数

```
- For data point p_i in p_1 ... p_n // this loop takes O(n)
    - determine all the centerpoints c_1, c_2 ... c_k of circles which 
      can include p_i (in O(1))
    - for each centerpoint c_j in c_1... c_k // this loop takes O(1)
       - lookup if there is an entry hashtable i.e. test h[c_j]==nil
       - if h[c_j]==nil then h[c_j]:=1 end
       - else h[c_j] := h[c_j] +1 end
    - end for 
 end for 
```

// 最后一个最大值确定需要 O(n) - 遍历 h 中的所有 c_k - 确定键 c_max，其中 h_[c_max] 是 h 中的最大值

你怎么看？欢迎任何意见。

# linux - Ubuntu root Cron 作业未完成

> ID：15305834
> 
> 赞同：1
> 
> 时间：2013-03-09T00:48:20.070
> 
> 标签：linux, bash, ubuntu, ubuntu-10.04

我正在我的 Ubuntu 10.04 LTS 服务器上从根 cron 运行组合备份脚本。

根 cron 如下所示：

```
# m h  dom mon dow   command
0 1 * * 2-6 /home/cbhiadmin/archive 
```

它按预期执行。归档命令启动几个单独的设施备份。代码如下：

```
#!/bin/bash

# This script executes several individual facility archive processes & logs success.

/home/cbhiadmin/archive104
/home/cbhiadmin/archive106

if [ $? -ne 0 ]; then
  echo "$(date '+%m/%d/%y-%H:%M') Nightly Addon backup SUCCESSFUL" >> /home/cbhiadmin/addon_backups/addon_backup.log
  exit
  fi 
```

然后最后一部分是单独的设施备份，如下所示：

```
#!/bin/bash

# This script archives a facility, FTPs the archive to 10.5.2.76, & logs failure.

today=$(date '+%m%d%y')
site="106"

cd /home/cbhiadmin/addon_backups/"$site"

if [ ! -f "$site"adata_"$today".tar.gz ]; then

tar --exclude *.CSV --exclude *.csv -czf "$site"adata_"$today".tar.gz -C /usr/bbx/aon/ "$site"/ADATA/

  if [ $? -ne 0 ];then
  echo "$(date '+%m/%d/%y-%H:%M') $site: Nightly Addon backup FAILED" >> /home/cbhiadmin/addon_backups/addon_backup.log
  fi

fi

cp "$site"adata_"$today".tar.gz /home/cbhiadmin/SAN/"$site"

find ~/SAN/"$site"/*.tar.gz -maxdepth 1 -mtime +60 -exec rm {} + 
```

我的问题是最后一行似乎不适用于根 cron，但是当我自己以根用户身份运行存档时有效。

少了什么东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:52:19.607

```
find ~/SAN/"$site"/*.tar.gz -maxdepth 1 -mtime +60 -exec rm {} + 
```

“~”指的是用户的主目录。但是，当由 cron 运行时，它不使用您的用户，因此不使用您的主目录。将其更改为引用绝对路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T16:41:20.397

请按照以下步骤操作，它应该可以解决您的问题：

1.  类型`cd ~/SAN/`
2.  类型`pwd`
3.  用命令的结果替换“~/SAN/” `pwd`。

# python - 如何在 Python 中执行将数据写入标准输入的进程？

> ID：15305843
> 
> 赞同：9
> 
> 时间：2013-03-09T00:49:01.023
> 
> 标签：python, subprocess, stdout, stdin, io-redirection

我的 Python 脚本中有一个标志，它指定我是否设置和使用外部进程。这个过程是一个被调用的命令`my_command`，它从标准输入中获取数据。如果我要在命令行上运行它，它会是这样的：

```
$ my_command < data > result 
```

我想使用 Python 脚本`data`通过修改标准输入并将其提供给`my_command`.

我正在做这样的事情：

```
import getopt, sys, os, stat, subprocess

# for argument's sake, let's say this is set to True for now
# in real life, I use getopt.getopt() to decide whether this is True or False
useProcess = True

if useProcess:
    process = subprocess.Popen(['my_command'], stdin=subprocess.PIPE, stdout=subprocess.PIPE)

for line in sys.stdin:
    # parse line from standard input and modify it
    # we store the result in a variable called modified_line
    modified_line = line + "foo"

    # if we want to feed modified_line to my_command, do the following:
    if useProcess:
        process.stdin.write(modified_line)

    # otherwise, we just print the modified line
    else:
        print modified_line 
```

但是，它的`my_command`行为就好像它没有收到任何数据并以错误状态退出。我究竟做错了什么？

**编辑**

假设我的 Python 脚本名为`my_Python_script`. 假设我通常会传递一个通过标准输入`my_command`调用的文件：`data`

```
$ my_command < data > result 
```

但现在我将其传递给`my_Python_script`：

```
$ my_Python_script < data > some_other_result 
```

我想`my_Python_script`有条件地设置一个`my_command`在内容上运行的子进程（在传递给之前被`data`修改）。这更有意义吗？`my_Python_script``my_command`

如果我`bash`用作脚本语言，我会有条件地决定运行两个函数之一。一种是将数据线传输到`my_command`. 另一个不会。这可以用 Python 完成吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-09T01:11:58.890

写入标准输入后，您需要将其关闭：

```
 process.stdin.write(modified_line)
    process.stdin.close() 
```

### 更新

我没有注意到它`process.stdin.write()`是在 for 循环中执行的。在这种情况下，您应该将 移到`process.stdin.close()`循环之外。

此外，Raymond 提到我们也应该跟`process.wait()`注。所以更新后的代码应该是：

```
for ...
    process.stdin.write(modified_line)

process.stdin.close()
process.wait() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T02:19:22.903

除了`process.stdin.close()`@HaiVu 提到的那样，您是否`process.wait()`在获得结果之前等待命令完成？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:57:04.420

看起来您可能会混淆参数和标准输入。你的命令应该是

```
$ <data> | mycommand result 
```

一旦命令被调用，数据就会被传入。

`raw_input`使用内置函数完成输入。（[http://docs.python.org/2/library/functions.html](http://docs.python.org/2/library/functions.html)）

# c++ - Mac GUI 应用程序如何在不使用 Sparkle 的情况下重新启动自身？

> ID：15305845
> 
> 赞同：2
> 
> 时间：2013-03-09T00:49:14.670
> 
> 标签：c++, objective-c, c, macos, relaunch

我正在向 Mac 程序添加一项功能以删除其首选项 .plist 文件，然后使用有效的“出厂设置”重新启动。然而，客户对使用 Sparkle 等外部框架持谨慎态度。我在网上查找了示例代码，但其中大部分似乎过于复杂（例如，向 NSApplication 添加类别）。此外，当您无法使用某些 API 从非 GUI 进程启动 GUI 进程时，其中一些根本无法在 Lion 或更高版本中运行。

那么有没有一种简单的方法可以让 Mac GUI 应用程序自行重新启动？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-09T00:49:14.670

至少对于 Mountain Lion 来说，稍微花哨的 fork/exec 版本可以正常工作：

```
void    RelaunchCurrentApp()
{
    // Get the path to the current running app executable
    NSBundle* mainBundle = [NSBundle mainBundle];
    NSString* executablePath = [mainBundle executablePath];
    const char* execPtr = [executablePath UTF8String];

#if ATEXIT_HANDLING_NEEDED
    // Get the pid of the parent process
    pid_t originalParentPid = getpid();

    // Fork a child process
    pid_t pid = fork();
    if (pid != 0) // Parent process - exit so atexit() is called
    {
        exit(0);
    }

    // Now in the child process

    // Wait for the parent to die. When it does, the parent pid changes.
    while (getppid() == originalParentPid)
    {
        usleep(250 * 1000); // Wait .25 second
    }
#endif

    // Do the relaunch
    execl(execPtr, execPtr, NULL);
} 
```

我遇到了一个问题，即重新启动的应用程序可以在后台结束。在执行的早期这样做可以解决这个问题：

```
[[NSApplication sharedApplication] activateIgnoringOtherApps : YES]; 
```

# html - 在我的 CSS 下拉菜单中需要第 3 级

> ID：15305849
> 
> 赞同：0
> 
> 时间：2013-03-09T00:50:17.160
> 
> 标签：html, css, menu, web

我在菜单中有一个 2 级下拉菜单，看起来很棒。现在我想添加第三级。我怎么做？

这是我的菜单 HTML：

```
<ul class="nav">
        <li class="home"><a href="index1.php">Home</a></li>
        <li><a href="aboutus.html">About Us</a></li>
        <li><a href="#">Residential</a>
         <ul>
                <li><a href="carpet.html">Carpet</a></li>
                <li><a href="upholstary.html">Upholstery</a></li>
                <li><a href="rugs.html">Rugs</a></li>
                <li><a href="airducts.html">Air Ducts</a></li>
            </ul>
        </li>
        <li><a href="#">Commercial</a>
            <ul>
                <li class="sub"><a href="com_carpet.html">Carpet</a>
                <ul><a href="com_carpet.html">tester</a></ul>
                </li>
                <li><a href="com_upholstery.html">Upholstery</a></li>

            </ul>
        </li>

        <li class="activeitem"><a href="general-house-cleaning.html">General House Cleaning </a></li>
        <li><a href="contactus.php">Contact Us</a></li>
        <li class="lastnav"><a href="fr/grand_manage.html">Français</a></li>
    </ul>
</div> 
```

这是我的CSS：

```
ol, ul {
    list-style: none;
    line-height: 24px;
}

.nav {
    clear:both;
    background:url(../images/navbg.png) 0 0 no-repeat;
    height:46px;
    border-top: solid 3px #72592a;
    padding: 1px 0 0 0;
}
.nav li {
    float: left;
    line-height: 45px;
    border-right: solid 1px #56713c;
    position: relative;
}
.nav li:hover {
    background: url(../images/activebg.png) 0 0 repeat-x;
}

.nav .home:hover {
background: url(../images/home_active_bg.png) bottom left repeat-x;
}
.nav li.activeitem {
    background: url(../images/activebg.png) 0 0 repeat-x;
}
.nav li.activehome {
    background: url(../images/home_active_bg.png) 0 0 repeat-x;
}

.nav li.lastnav {
    float: right;
    border: 0 none;
    padding: 0 0px 0 0;
}

.nav li.lastnav:hover {
    -webkit-border-bottom-right-radius: 6px;
-moz-border-radius-bottomright: 6px;
border-bottom-right-radius: 6px;
}

.nav li.lastnav a {
    color: #000;
    border-right:none;
    font-size:12px;
}
.nav li.lastnav img {
    float: left;
    padding: 17px 5px 0 0;
}

.nav li a {
    display: block;
padding: 0 15px;
font-size: 13px;
color: white;
border-right: solid 1px #A6C079;
font-weight: bold;
text-transform: uppercase;
}
.nav li ul {
    position: absolute;
    display: none;
    width: 200px;
    background: #54703a;
    z-index: 6500;
}
.nav li:hover ul {
    display: block;
}
.nav li ul li {
    border: none;
    float: none;
    border-bottom: solid 1px #fff;
    line-height:32px;
    background:#F0F0F0;

}
.nav li ul li a {
font-size:12px;
color:#000;
}
.nav li a:hover {
text-decoration:none;
}
.nav li ul li a:hover {
text-decoration:none;
color:#fff;
} 
```

任何帮助，将不胜感激

谢谢 ！最好的问候伊斯梅尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:56:17.717

```
<ul class="nav">
  <li>
    <a></a>
    <ul>
      <li>
        <a></a>
        <ul>
          <li>
            <a></a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul> 
```

CSS也像以前一样

`.nav li ul li ul`, `.nav li ul li ul li`,`.nav li ul li ul li a`

# html - iframes...导航窗格

> ID：15305853
> 
> 赞同：1
> 
> 时间：2013-03-09T00:50:57.070
> 
> 标签：html, navigation, pane

所以我有一个用于外部水平导航菜单的 iframe。我的代码是：

```
<p>
<iframe src="C:\Users\redacted\Desktop\project\nav_menu.html" name="sidebar_a" frameborder="0" width="100%" height="25" seamless="seamless" scrolling="no"></iframe>
<p>   
<p>Your browser does not support iframes.</p>
<p>
</iframe> 
```

我该怎么做才能解决这个问题？当我点击一个链接时，iframe 充当一个单独的网站。

如果 iframe 应该这样做，我如何从外部源插入导航窗格？

# php - 在asp中回显值

> ID：15305854
> 
> 赞同：0
> 
> 时间：2013-03-09T00:51:06.257
> 
> 标签：php, facebook, facebook-graph-api, asp-classic

[https://developers.facebook.com/docs/reference/api/realtime/](https://developers.facebook.com/docs/reference/api/realtime/)

**然后它应该只回显 hub.challenge 值，这向 Facebook 确认该服务器已配置为接受回调，并防止拒绝服务 (DDoS) 漏洞。**

什么是经典asp中的“回声”等价物。我以为是 response.write 所以我写了下面的代码，但是当我测试它时它不起作用。

```
fbMode          = Request.QueryString("hub.mode")
fbChallenge     = Request.QueryString("hub.challenge")
fbVerify_token  = Request.QueryString("hub.verify_token")

Response.Write fbChallenge 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T02:35:07.163

它是 Response.Write。我猜你的查询字符串参数是空白的。

# sql - 向现有表中添加一列，其值依赖于其他列

> ID：15305857
> 
> 赞同：2
> 
> 时间：2013-03-09T00:51:29.923
> 
> 标签：sql, oracle, ddl

我想向现有表中添加一列，其值取决于另一列 STORE。STORE 有两个值，T 或 D。如果存储值为 T，那么我希望添加列中的值为 1，否则为零。有什么办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T01:24:19.960

一个虚拟列可以在 11g 中完成：

```
SQL> create table yourtab (store varchar2(1));

Table created.

SQL> alter table yourtab add col as (case store when 'T' then 1 else 0 end);

Table altered.

SQL> insert into yourtab (store) values ('T');

1 row created.

SQL> insert into yourtab (store) values ('D');

1 row created.

SQL> select * from yourtab;

S        COL
- ----------
T          1
D          0 
```

如果您使用的是 10g 或更早版本，则为触发方法：

```
SQL> create table yourtab (store varchar2(1), col number);

Table created.

SQL> create trigger yourtab_biu
  2  before insert or update on yourtab
  3  for each row
  4  declare
  5  begin
  6    :new.col := case :new.store when 'T' then 1 else 0 end;
  7  end;
  8  /

Trigger created.

SQL> insert into yourtab (store) values ('T');

1 row created.

SQL> insert into yourtab (store) values ('D');

1 row created.

SQL> select * from yourtab;

S        COL
- ----------
T          1
D          0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T01:07:31.300

Oracle 不支持在 create 或 alter table 命令上执行此操作。

相反，使用：

```
ALTER TABLE your_table ADD c INTEGER;

UPDATE your_table SET c = CASE WHEN store = 'T' THEN 1 ELSE 0 END; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T00:58:38.277

视图可能是一个解决方案：

```
create view v_your_table as
select  your_table.*, case when STORE = 'T' than 0 else 1 end as comp from your_table; 
```

# azure - 如何将 Windows Azure VM 移动到不同的关联组？

> ID：15305858
> 
> 赞同：6
> 
> 时间：2013-03-09T00:51:31.623
> 
> 标签：azure, azure-blob-storage, azure-virtual-network

我在 Windows Azure 的美国西部数据中心创建了一个 VM。现在我发现它需要与我在 Windows Azure 的美国东部数据中心的另一台机器上创建的另一个 VM 频繁连接。第二台机器已经属于一个关联组。如果我可以将第一台 VM 移动到与第二台机器相同的关联组，那将是最好的。因为第一个虚拟机中已经有相当多的数据，数据迁移可能会很痛苦。帮助！

经过一番实验，我终于放弃了。虽然我可以成功地将 vhd 从一个数据中心复制到另一个数据中心，但配置不起作用。可以让它工作，但您需要运行 sysprep 命令来清除以前数据中心的配置信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-17T00:34:52.380

在新的 SDK 中，模板命令是：

> 天蓝色虚拟机磁盘上传“<a href="http://sourcestorage.blob.core.windows.net/vhds/sample.vhd" rel="nofollow">http://sourcestorage.blob.core.windows.net/ vhds/sample.vhd” “<a href="http://destinationstorage.blob.core.windows.net/vhds/sample.vhd" rel="nofollow">http://destinationstorage.blob.core.windows. net/vhds/sample.vhd” “DESTINATIONSTORAGEACCOUNTKEY”</p>

不要忘记将 VHD 设为“public”并在 Portal 上的“Managed Key”选项中获取 KEY。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T02:07:31.533

您可以执行从美国西部到美国东部（从一个存储帐户到另一个）的异步 Blob 复制，复制虚拟机的 VHD。此时，您应该能够在正确的关联组内基于该 vhd 在美国东部启动虚拟机。

从虚拟机创建映像需要做一些工作——[这个 msdn 资源](http://msdn.microsoft.com/en-us/library/windowsazure/jj672979.aspx)应该是一个很好的起点。

**编辑：**您可以通过 Windows Azure 跨平台命令行工具执行异步 blob 副本，该工具可用于 Windows、Mac 和 Linux（[在此处](http://www.windowsazure.com/en-us/downloads/)下载）。语法是：

`azure vm disk upload <source-url> <target-url>`

源 url 是公共 blob 或具有共享访问签名的私有 blob。目标 url 使用您通过命令行工具配置的存储帐户信息：

`azure config set defaultStorageAccount`

有关命令行工具的更多信息，请[点击此处](http://www.windowsazure.com/en-us/manage/linux/other-resources/command-line-tools/)，包括下载订阅信息的说明。

# asp-classic - 阻止用户绕过 Login.asp 复制和粘贴 url？

> ID：15305866
> 
> 赞同：-1
> 
> 时间：2013-03-09T00:52:52.657
> 
> 标签：asp-classic, vbscript

我有 2 页

```
/login.asp
/menu.asp 
```

我想这样做，所以用户必须登录才能查看`/menu.asp`。

但截至目前，用户`/menu.asp`无需先登录即可复制粘贴并输入它。

如果用户在没有先登录的情况下进入，我将如何做到这一点`/menu.asp`，它会迫使他们返回`/login`屏幕？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T07:00:43.730

在正常的经典 asp 方式中，我期望：

1.  您正在 login.asp 中设置会话变量（例如 sesssion("loginsucceeded") = true）。
2.  您检查所有其他页面上的会话变量，如果未登录，则重定向到 login.asp。

像这样：

```
if (not session("loginsucceeded") = true) then 
    response.redirect login.asp : 
end if 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T01:19:34.433

在几个大类中有很多选项。

最简单的可能是登录成功后在 menu.asp 中设置浏览器 cookie。然后在 menu.asp 中读取该 cookie（以及您想要限制的任何其他页面），如果它不存在，只需执行 META 或 JS 重定向到登录页面。如果需要，您可以将 cookie 设置为过期。

这样做的安全性很糟糕（如果用户足够努力，他可以编辑自己的 cookie），但它可能适用于原型设计。更安全的系统将涉及发布令牌而不是静态 cookie，并检查令牌在服务器端是否有效。

# for-loop - 从文件dos中循环并解析字符串

> ID：15305868
> 
> 赞同：0
> 
> 时间：2013-03-09T00:53:20.580
> 
> 标签：for-loop, scripting, batch-file, dos, command-line-arguments

我正在尝试使用 DOS 命令从命令行中的一行解析一个单词

如果字符串包含 _(" 那么我想将它存储在一个文件中。例如：

```
 js\.svn\text:        $errors=      '</b> - ' . _("LABEL") . ' '      . _('ERR 
```

如果没有，那么我想继续忽略它。

我很难弄清楚 delim 是如何工作的，或者我是否应该为此使用它。我看到很多关于输出整行的例子，但不是字符串。

或者......我在想可以通过每个单词查看for循环，直到该行中不再有......如果单词开头匹配_（“那么我会将它输出到文件中？

像这样的东西？

```
 for /F "tokens=1*" %%i in (get_list.txt) do(
   for %%A in (%%j) do(
      if (%%A == "_("")) >> get_id.txt
  )
 ) 
```

有人可以纠正我的语法或以任何方式指导我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T16:35:43.457

不需要外部实用程序或“FOR”。试试这条线：

```
 >get_id.txt findstr _(\" get_list.txt 
```

\ “转义” Quotesign。以下行将不起作用：

```
 findstr _(\" get_list.txt >get_id.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T13:07:08.610

**编辑**

重新阅读您的问题后，我不完全确定您想要什么。您是说要将*整行*转储到文本文件中，而不仅仅是匹配项？

我也不清楚其他事情。是否`get_list.txt`包含 PHP-ish 代码，或者它是否包含您要检查 PHP-ish 代码的文件列表？

如果`get_list.txt`是代码并且您希望将匹配的行转储到`get_id.txt`，那么您只需要`findstr "_(" "get_list.txt" >> "get_id.txt"`.

* * *

以下答案是根据我最初的假设提交的，即您想要的`get_id.txt`只是完全匹配，例如`match`字符串 _(" `match`" 中的单词。

* * *

**路径 1**

好吧，如果我是你，我会使用[grep -o](http://gnuwin32.sourceforge.net/packages/grep.htm)来执行此操作。可以使用 for 循环完成，但使用 grep 可以更轻松地完成。

```
grep -P -o "(?<=_\([\'\"])\w+" get_list.txt >> get_id.txt 
```

...如果您要捕获的内容将始终用引号引起来，或者...

```
grep -P -o "(?<=_\()[^\)]+" get_list.txt | grep -P -o "\w+" >> get_id.txt 
```

...如果可能有一些未引用的整数、布尔值或其他未引用的数据类型。

* * *

**路径 2**

如果您坚持使用普通的批处理脚本，那么第二个最有效的方法是使用 JScript 混合脚本来利用 JScript 的正则表达式匹配。

```
@if (@x==@y) @end /*

:: batch portion

@echo off
setlocal
for /f "delims=" %%I in ('findstr "_(" "get_list.txt"') do (
    cscript /nologo /e:jscript "%~f0" %%I >> get_id.txt
)

goto :EOF

:: JScript portion */
var m=WSH.arguments(0).match(/_\([\'\"]?\w+/g);
for (var i=0; i<m.length; i++ ) {
    WSH.echo(m[i].replace(/_\([\'\"]?/,''));
} 
```

* * *

**路径 3**

如果您真的想像示例中那样逐字解析文本文件，我认为这是您正在寻找的语法。如果您的文本文件很大，我认为这将是最慢的解决方案，因为批处理循环有时会非常慢。

```
@echo off
setlocal enabledelayedexpansion

for /f "delims=" %%I in ('findstr "_(" "get_list.txt"') do (
    for %%x in (%%I) do (
        set word=%%x
        set word=!word:_^(=!
        if not !word!==%%x (
            set word=!word:"=!
            set word=!word:'=!
            >> get_id.txt echo !word:^)=!
        )
    )
) 
```

# git - Git 和部署：本地更改暂存、提交和推送，未在远程显示

> ID：15305869
> 
> 赞同：1
> 
> 时间：2013-03-09T00:53:21.970
> 
> 标签：git, deployment, version-control, repository

我知道这似乎很常见，但我已经用谷歌搜索并搜索过这个，但我看到的大多数回复似乎只是告诉我做我已经做过的事情......

1.  进行了更改
2.  暂存文件
3.  在本地提交更改
4.  推送到远程源/主

成绩单一直说“一切都是最新的”，但没有任何已提交的更改出现在远程分支中。（SSH 和查看目录仅显示 .git 文件夹，没有推送的更改。）

遥控器是一个设置为裸 ( `# git config --bool core.bare true`) 的空仓库。

master 分支在本地签出。

### 更新

根据下面的讨论，我认为澄清最初的意图是谨慎的......

遥控器旨在成为一个实时站点，因此不需要一个裸仓库，并且在遥控器上需要一个工作树，但仍然需要促进“推送”更新的能力。

对于这种特殊情况，另请参阅下面我的回答......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T01:04:01.727

推送到一个 repo 不会改变 repo 的工作树，即使它有一个。但是，裸仓库没有工作树，而且通常您只会推送到裸仓库。

换句话说，推送到另一个 repo 将*永远不会*更改与该远程关联的任何文件，除了存储所有 repo 数据的 .git 目录中的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T16:17:38.420

我阅读了这种行为，发现在“推送”操作期间不更新远程工作树是一个深思熟虑的设计决定：

*   [为什么在“git push”之后我看不到远程仓库的变化？](https://git.wiki.kernel.org/index.php/GitFaq#Why_won.27t_I_see_changes_in_the_remote_repo_after_.22git_push.22.3F)

我通常不使用远程工作树（裸存储库），但如果您使用 Git 进行部署，此功能显然会带来一些痛苦。值得庆幸的是，有一个使用提交挂钩来触发树更新的解决方案。看：

*   [推送到 git 远程工作副本](http://jennyandlih.com/pushing-remote-git-working-copy)
*   [Git 提示：通过 post-receive 钩子自动更新工作树](http://debuggable.com/posts/git-tip-auto-update-working-tree-via-post-receive-hook:49551efe-6414-4e86-aec6-544f4834cda3)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T01:08:53.160

我建议，删除远程 repo 目录，mkdir 新目录，执行 git init --bare，然后再试一次。然后检查 ssh 到服务器，转到 repo 目录并执行 git log，你应该在那里看到你的更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T12:58:08.777

*注意：此答案包含在 OP 中的特定案例中。其他答案在一般情况下很有帮助。*

正如@Ryan Stewart 正确指出的那样，推送不会更新工作树（在 OP 的情况下是实时站点的实际内容），但是裸仓库没有工作树。

而且由于需要一个裸仓库才能推送到，因此 Apache 需要一个独立的工作树才能真正充当实时站点。

我不确定这是否是最佳实践，但要做到这一点，你基本上可以......

## 在服务器上执行此操作（与本地克隆分开）：

1.  使用实时站点的工作目录创建一个 repo
2.  创建一个单独的裸仓库
3.  使裸仓库成为实时仓库的远程，并将实时主机推送到它
4.  在主存储库和裸存储库之间创建挂钩（脚本）以保持它们同步

我对 Git 中的 hooks 概念不熟悉，所以我不会进一步详细说明，因为害怕进一步的大吃大喝，所以我向您推荐源代码：

[http://git-scm.com/book/en/Customizing-Git-Git-Hooks](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)

# c# - 在 Visual Studio 2010 中未获取 Intellisense 函数参数

> ID：15305876
> 
> 赞同：0
> 
> 时间：2013-03-09T00:54:28.093
> 
> 标签：c#, .net, visual-studio-2010, intellisense

使用`Visual Studio 2010`，我输入一个函数的名称，如下所示：

```
MyClass mc = MyClassOfStaticMethods.GetMyClassInstance( 
```

该方法`GetMyClassInstance`有两个参数，但是当我输入上面的内容时，我没有看到`Intellisense`该方法的参数列表。为什么不？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:22:47.380

可能的猜测

*   `GetMyClassInstance`是实例方法，因此智能感知无法选择方法本身，因此无法选择参数。
*   方法对智能感知隐藏。
*   您对该方法的期望与现实不符（即您期望您实际拥有的方法的更新/旧版本）。

# opengl - glPushMatrix 已弃用，GL30-GL43 解决方案？基本框示例

> ID：15305879
> 
> 赞同：0
> 
> 时间：2013-03-09T00:55:24.690
> 
> 标签：opengl, matrix, render, glu

我正在开发一个渲染基本框的程序，但是通过谷歌搜索，我还没有找到在屏幕上绘制一张脸（或一组脸）的解决方案。

目前我发现的每个教程都像这样使用 glPushMatrix/glBegin/glEnd/glPopMatrix

```
GL11.glPushMatrix();

GL11.glRotatef(pit, 1, 0, 0);
GL11.glRotatef(yaw, 0, 1, 0);
GL11.glRotatef(rol, 0, 0, 1);
GL11.glTranslatef(pos.x, pos.y, pos.z);

GL11.glBegin(GL11.GL_QUADS);
GL11.glVertex3f(-1.0f, -1.0f,  1.0f);   // Bottom Left Of The Quad
GL11.glVertex3f( 1.0f, -1.0f,  1.0f);   // Bottom Right Of The Quad
GL11.glVertex3f( 1.0f,  1.0f,  1.0f);   // Top Right Of The Quad
GL11.glVertex3f(-1.0f,  1.0f,  1.0f);   // Top Left Of The Quad
//insert similar code here for all 6 faces
GL11.glEnd();

GL11.glPopMatrix(); 
```

我已经在 OGL 3.0 中读到他们弃用了 glPushMatrix/glBegin/glEnd/glPopMatrix 但我似乎无法找到渲染对象的“正确”方式。有我应该使用的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:57:28.807

您需要忘记 OpenGL 为您管理矩阵的想法。您将需要使用矢量数学库自己实现这些东西。java 3D Api 在提供一组健壮的 Matrix 和 Vector 类和方法方面做得很好。很抱歉告诉您，您还有更多工作要做，但这是图形编程的发展方向。

# jsoup - Jsoup Document.baseUri() 问题

> ID：15305883
> 
> 赞同：2
> 
> 时间：2013-03-09T00:56:01.833
> 
> 标签：jsoup

如果我尝试从该域中检索 URL 的 Document.baseUri() -

[http://www.deliciousmagazine.co.uk/articles/mid-week-meals](http://www.deliciousmagazine.co.uk/articles/mid-week-meals)

它返回[http://www.deliciousmagazine.co.uk](http://www.deliciousmagazine.co.uk)。

对于其他 URL，Document.baseUri() 返回整个 URL。

例如

[https://stackoverflow.com/about](https://stackoverflow.com/about)

将返回

[https://stackoverflow.com/about](https://stackoverflow.com/about)。

我注意到的唯一一件事是 HTML 响应返回带有以下信息的标记。

```
<base href="http://www.deliciousmagazine.co.uk/" /> 
```

这是我能想到的唯一导致此问题的原因。即使这个元素存在，如果我想要整个 URL 怎么办？我可以在 Document 上调用什么方法来检索它？

示例代码

```
Document doc = null;
try {
   doc = Jsoup.connect(url).userAgent("Mozilla").get();
} catch (IOException e) {
        e.printStackTrace();
}
System.out.println(doc.baseUri()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:42:23.513

基本 URI 的要点是将源 ( `<a href="/foo">`) 中的相对 URL 解析为绝对 URL。文档可以使用元标记作为基本 URI；如果未设置，则默认为获取的位置。

您需要获取源 URL 的用例是什么？难道你不知道它是什么（因为你是怎么得到它的）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-03T11:34:12.847

Response 对象有一个 url() 方法，它应该给你最终的 url。所以你可以这样做

```
String url = "http://t.co/i5dE1K4vSs";
Response response = Jsoup.connect(url).followRedirects(true).execute();
System.out.println(response.url()); 
```

# amazon-web-services - EC2 无法为实例存储创建 AMI

> ID：15305886
> 
> 赞同：1
> 
> 时间：2013-03-09T00:56:22.610
> 
> 标签：amazon-web-services, amazon-s3, amazon-ec2, ec2-ami

我在尝试创建实例存储服务器包时遇到问题

Ubuntu 12.10

```
ec2-bundle-vol \
--user $EC2_USER \
--privatekey $EC2_PRIVATE_KEY \
--cert $EC2_CERT \
--arch x86_64 \
--exclude /mnt,/tmp,/var/tmp \
--destination /mnt/bundles/$BUNDLE_NAME/ \
--prefix $BUNDLE_NAME

Excluding: 
     /
     /proc
     /sys
     /sys/fs/fuse/connections
     /sys/kernel/debug
     /sys/kernel/security
     /dev
     /dev/pts
     /dev
     /media
     /mnt
     /proc
     /sys
     /etc/udev/rules.d/70-persistent-net.rules
     /etc/udev/rules.d/z25_persistent-net.rules
     /mnt
     /tmp
     /var/tmp
     /mnt/bundles/130309
     /mnt/img-mnt
1+0 records in
1+0 records out
1048576 bytes (1.0 MB) copied, 0.0024517 s, 428 MB/s
mke2fs 1.42.5 (29-Jul-2012)
loop: can't delete device /dev/loop0: No such device or address
Bundling image file...
ERROR: can't convert Fixnum into String 
```

有什么想法可能是错的吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T16:40:41.730

您可以应用此补丁并继续使用 ruby​​1.9。请参阅原始文章：[ec2_upload_bundle 和 ruby​​ 1.9：无法将 Fixnum 转换为字符串](http://blog.winding-lines.com/2009/11/ec2uploadbundle-and-ruby-19-cant.html)（非常感谢*decodeideas*！）

*从原始文章复制粘贴*：

以下适用于以下场景

*   ubuntu 业力，ec2 ami
*   ruby 1.9.2 安装为 /usr/bin/ruby
*   最新的 ec2 工具

当您使用 ec2_upload_bundle 重新捆绑您修改的 AMI 时，您将收到错误

```
ERROR: can't convert Fixnum into String 
```

调试它的技巧是将 --debug 传递给 ec2 命令。该修复位于 /usr/lib/ec2-ami-tools/lib/ec2/amitools/util.rb 的第 19 行，您需要将 ?A 更改为 ?A.ord 才能获得此行：

```
(0..19).inject("") {|ident, n| ident+(?A.ord + Kernel.rand(26)).chr} 
```

在进行更改之前，您可以使用

```
ruby1.9 -r /usr/lib/ec2-ami-tools/lib/ec2/amitools/util -e 'puts gen_ident' 
```

应用补丁后，您应该会得到一个简短的随机字母序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:51:17.047

从 1.9 降级到 ruby​​ 1.8 或安装 ruby​​ 1.8 开始。似乎 AMI 工具不兼容 1.9。

```
apt-get install ruby1.8 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T08:59:55.703

dev 目录是设备目录，因此您不应该复制，而 loop0 是回送连接器，通常是对另一个已安装文件系统的引用。

我注意到您的排除行：

```
--exclude /mnt,/tmp,/var/tmp \ 
```

您不`/dev`直接排除，但确实排除`/mnt`了，所以我猜您不希望将外部文件系统滚动到您的映像中。但是该`/dev`目录在输出中提到了两次，您是否尝试在命令行参数中排除或明确`/dev`排除`/dev/loop0`？`/dev/loop*`

# c++ - c ++如何为类的模板化转换运算符指定参数

> ID：15305891
> 
> 赞同：4
> 
> 时间：2013-03-09T00:56:59.550
> 
> 标签：c++, templates, syntax, conversion-operator

我正在尝试为类的模板化转换运算符指定模板参数，但我似乎无法正确使用语法。

```
#include <iostream>
using namespace std;

class C
{
   int i_;
public:
   C(int i) : i_(i) {}
   template<int adder> int get() { return i_ + adder; }
   template<int adder> int operator()() { return i_ + adder; }
   template<int adder> operator int() { return i_ + adder; } 
   // If I add a default argument to operator int()'s adder template parameter this compiles fine 
   // (of course, I still can't figure out how to specify it...)
};

int main(int, char*[])
{
   C c(10);
   cout << c.get<2>() << endl;            // I can specify template argument here the regular way.
//   cout << c() << endl;                 // No template argument specified, so I wouldn't have expected this to work.
   cout << c.operator()<3>() << endl;     // We have to call it this way.
//    cout << (int)c << endl;             // In the same vein I wouldn't expect this to work either.
   cout << c.operator int<4>() << endl;   // But how do I specify template argument here? This seems to be an error for some compilers.
   return 0;
} 
```

相同的代码在[http://liveworkspace.org/code/35sqXe$4](http://liveworkspace.org/code/35sqXe%244)

使用 g++ 4.7.2 编译时

```
$ g++ -std=c++11 -Wall -W -pedantic "template conversion operator.cpp"

Compilation finished with errors:
source.cpp: In function 'int main(int, char**)':
source.cpp:23:23: error: 'int' is not a template
source.cpp:23:30: error: no matching function for call to 'C::operator int()'
source.cpp:23:30: note: candidate is:
source.cpp:11:24: note: template<int adder> C::operator int()
source.cpp:11:24: note: template argument deduction/substitution failed:
source.cpp:23:30: note: couldn't deduce template parameter 'adder' 
```

使用 g++ 4.8.0 编译时 (20130224)

```
$ g++ -std=c++11 -Wall -W -pedantic "template conversion operator.cpp"

Compilation finished with errors:
source.cpp: In function 'int main(int, char**)':
source.cpp:23:23: error: 'int' is not a template
    cout << c.operator int<4>() << endl; 
                       ^
source.cpp:23:30: error: no matching function for call to 'C::operator int()'
    cout << c.operator int<4>() << endl;
                              ^
source.cpp:23:30: note: candidate is:
source.cpp:11:24: note: template<int adder> C::operator int()
    template<int adder> operator int() { return i_ + adder; }
                        ^
source.cpp:11:24: note: template argument deduction/substitution failed:
source.cpp:23:30: note: couldn't deduce template parameter 'adder'
    cout << c.operator int<4>() << endl;
                              ^ 
```

使用 clang++ 3.2 编译时

```
$ clang++ -std=c++11 -Wall -W -pedantic "template conversion operator.cpp"

Compilation finished with errors:
source.cpp:23:12: error: reference to non-static member function must be called
   cout << c.operator int<4>() << endl;
           ^~~~~~~~~~~~~~
source.cpp:23:30: error: expected expression
   cout << c.operator int<4>() << endl;
                             ^
2 errors generated. 
```

使用 icc 13.0.1 编译时

```
$ icc -std=c++11 -Wall -W -pedantic "template conversion operator.cpp"

Compilation finished with warnings:
source.cpp(11): warning #488: constant "adder" is not used in declaring the parameter types of function template "C::operator int"
     template<int adder> operator int() { return i_ + adder; }
                  ^ 
```

除了警告之外， icc 似乎工作正常。

这些是编译器错误吗？还是我的语法有问题？

编辑

由于 Yakk 询问我的原始/实际问题是什么：
我有一个类 Ptr（以它指向的类型为模板），并且我想将 Ptr 转换为 const T。（尽管我知道在在这种情况下，）如果 T 已经是 const 类型，我希望转换运算符不存在。由于您没有为转换运算符指定返回类型或方法参数，因此我将 enable_if 作为方法模板参数的一部分。

正如 Yakk （以及其他问题中的其他人）所发布的那样， A simple`template <typename = typename std::enable_if<!std::is_const<T>::value>::type>`不起作用，因为当 Ptr 被实例化时， T 在编译器到达此声明时就已经知道了。由于没有推导出 T，因此没有 SFINAE。因为我们知道`!is_const<T>::value`是假的，所以没有“类型”成员并且声明是无效的。使模板依赖于新类型 (U)，推导出 U，然后检查 U 是否与 T 相同，并且 T 不是 const，然后具有无效声明是 SFINAE 的有效使用并且有效正如预期的那样。

```
template <typename T>
class Ptr
{
   template <typename U,
             typename = typename std::enable_if<std::is_same<T, U>::value &&
                                                !std::is_const<U>::value>::type>
   operator Ptr<const U>() const { return active; }
}; 
```

但后来我对自己说，这是一个模板化的成员函数。这些模板参数不必保留为默认值，任何实例化该函数的人都可以指定它们。对于任何其他 operator xxx 函数，执行此操作的语法很明显并且有效（参见上面的 operator()）。对于这个例子：

```
Ptr<const int> ci;
ci.operator Ptr<const int><const int, void>(); // assuming this syntax is valid 
```

void（或任何其他类型）将指定转换运算符的第二个模板参数，并且不考虑包含 enable_if 的默认值。当我试图使它不存在时，这将使该方法存在。

但是 gcc、clang 和 msvc 似乎对这种语法有问题。我假设由于转换运算符是拼写的`operator typename`，因此具有模板参数会使编译器混淆，认为它们是用于类型名而不是运算符。

确实有一些解决方法（只包括转换运算符，当 T 已经是 const 时转换为 const T 不会有任何伤害），但这是针对这个特定问题的。也许不可能为转换运算符指定模板参数，所以让这些类型被推导/默认是好的。或者也许有它的语法（icc 似乎接受它......），所以我向指定模板参数和实例化我不想要它们的方法的用户开放自己。我已经有了针对我的特定问题的解决方案（在类型确实重要的时候，在转换运算符中的类型检查上使用 static_assert），但是这个问题是关于 C++ 语言及其语法的。顶部的 C 类只是我能想到的搜索该语法的最简单方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:36:45.427

有点不清楚您要实现什么...实际上没有充分的理由将所有这些成员函数都作为模板，您也可以将它们作为常规函数`adder`作为参数。

嗯，这个`get`函数并没有真正*得到*，而是*添加*，所以你可以调用它`add`。函数调用运算符`operator()()`可以很好地接受一个`int`as 参数。转换运算符 to`int`作为模板实际上没有任何意义，并且不能按照定义的方式调用。如果您坚持将`get`and`operator()`作为模板，您可以将它们称为：

```
C c(0);
c.get<5>(); // 5
c<5>();     // 5 
```

`int`但我建议你重新考虑设计，决定你真正需要什么以及模板是否是要走的路......（请注意，即使在非模板版本中，进行转换也没有意义*价值*，你不是在**转换**，而是在创造一个不同的`int`！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:40:27.413

这是您没有问的问题的答案，如何`enable_if`对隐式转换运算符执行 SFINAE 操作，根据类本身的模板参数启用或禁用它们：

```
#include <iostream>
#include <type_traits>

template<int n>
struct Foo {
   template<typename T,typename=typename std::enable_if<std::is_convertible<T,int>::value && (n!=0)>::type>
   operator T() const { return n; }
};

int main() {
   Foo<0> zero;
   Foo<1> one;
   int x = 0;
   x = one;
   int y = 0;
   // y = zero; -- does not compile, because Foo<0> cannot be converted to int
   std::cout << x << "," << y << "\n";
} 
```

这并不完美，因为`is_convertible`我们生成了大量的隐式类型转换，但它相对接近。

以下是如何将模板参数传递给强制转换运算符，或者至少是一种近似它的方法：

```
template<int n>
struct int_wrapper {
  int i;
  operator int() const { return i; }
  int_wrapper( int i_ ):i(i_) {}
};
// in class C:
template<int adder> operator int_wrapper<adder>() { return i_ + adder; } 
```

在这里，我创建了一个玩具类型`int_wrapper`，它封装了 int 参数。除了允许将模板参数显式传递给`operator int_wrapper<n>`. 虽然返回 an`int_wrapper<...>`并不是 an 的完美替代品`int`，但它非常接近。

# php - 如何将 PHP 后端连接到 Google Analytics API

> ID：15305893
> 
> 赞同：6
> 
> 时间：2013-03-09T00:57:10.127
> 
> 标签：php, google-analytics, google-api-php-client

我正在尝试直接在我们公司的后端显示我们 Google Analytics 帐户中的一些基本数据。我正在使用[Google API PHP 客户端](https://code.google.com/p/google-api-php-client/)。

我遵循了[Hello Analytics API](https://developers.google.com/analytics/solutions/articles/hello-analytics-api)教程，但它让我有义务从浏览器进行连接。我需要从服务器本身获得信息（没有浏览器客户端连接），因为我想从 Cron 任务中自动执行查询。

我想做的事可能吗？我是否使用了正确的 PHP API？有没有其他方法可以取回 GA 数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T01:01:24.080

[你为什么不用Piwik 之](http://piwik.org/)类的东西替换你的谷歌分析服务！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T03:53:02.673

我浏览了您提供的链接，据我所知，它并不*要求*您从浏览器进行连接。首先，您确定您查看了该教程中的“php”选项卡吗？该演练使用浏览器交互，但您可以轻松地使其执行其他操作而不是输出到浏览器。我猜也许 2.6*可能*是您感到困惑的地方...但这只是提示用户登录的一个示例，假设您正在制作 Web 界面。出于您的目的，您将使用 2.4 进行身份验证，并且就 2.6 而言，如果该条件为真，您可以让您的脚本执行其他操作（例如记录“连接失败”错误）。而不是`printResults`回显一些东西（因为本教程假定浏览器界面）你可以用它做其他事情，比如写入数据库或其他东西。IOW 我在该教程中没有看到任何需要浏览器交互的内容，除了他们只是为了教程而将其作为示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-10T00:43:52.687

真正的天才@rkarbowski 在别处给出了答案。

[服务应用程序和 Google Analytics API V3：服务器到服务器 OAuth2 身份验证？](https://stackoverflow.com/questions/9863509/service-applications-and-google-analytics-api-v3-server-to-server-oauth2-authen)

我相信，如果您遵循[Hello Analytics API](https://developers.google.com/analytics/solutions/articles/hello-analytics-api)教程，然后仔细阅读 @rkarbowski 的答案，尤其[是更新](https://stackoverflow.com/a/10089698/1347953)，您将能够使其正常工作。我有，而且我不是天才。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-04T19:42:11.103

您可以使用浏览器连接到应用程序并执行脚本。（如果您遵循 Hello 教程并且一切正常）

然后让脚本将结果导入 Excel 或 PDF 并通过电子邮件发送出去。

我有几个每天使用 GA API 运行的 cron，并踢出每日统计数据等的电子邮件。

理论上，您可以构建一个调用 API 的 PHP 应用程序，但它比仅在浏览器上运行脚本要工作得多。

# python - 在 Python 中，确定每行代码执行多长时间的最佳方法是什么？

> ID：15305899
> 
> 赞同：2
> 
> 时间：2013-03-09T00:57:53.987
> 
> 标签：python, performance

对于任何特定的代码，有没有一种方法可以轻松地分解每行执行多长时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T01:04:32.243

Python 代码*不会*按原样执行，您输入的程序会被编译成经过优化的中间格式。因此，同一条线很可能会根据周围的线而花费不同的时间。此外，Python 对其数据有复杂的操作，操作所花费的时间将取决于处理的确切值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T01:04:05.573

在 shell 中，您可以将 cProfile 模块作为脚本运行：

```
python -m cProfile nameofscriptfile.py 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-09T01:04:26.757

```
import timeit

timeit.timeit("5+3") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-09T02:34:46.443

这是一种快速而肮脏的方法。

步骤 1\. 运行它并以秒为单位获得端到端的总体时间。如果它真的很快，请在它周围包裹一个临时的外环，使其至少需要几秒钟。

步骤 2\. 获取一堆随机时间堆栈样本，[*如本例所示*](https://stackoverflow.com/a/4299378/23771)。如果运行时间很短，您可以在多次运行中执行此操作。

您感兴趣的任何行都会出现在部分样本上。例如，如果它出现在 10 个样本中的 3 个上，这意味着在总时间的 30%（大约）期间，该语句正在执行。

# angularjs - angularJS ng-model输入类型号到rootScope不更新

> ID：15305900
> 
> 赞同：13
> 
> 时间：2013-03-09T00:58:00.550
> 
> 标签：angularjs

我有一个输入类型号设置为

```
<input type="number" ng-model="inputModel"/> 
```

`inputModel`在哪里`$rootScope.inputModel`。每次我更改输入框时，该值都不会保留在`$rootScope`. 不能将输入框绑定到 a`$rootScope`吗？我在这里想念什么？
我基本上有另一个控制器对给定执行计算`$rootScope`，这些计算根据输入框的值而变化。
非常感谢您的帮助

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-09-23T16:10:35.800

看到[这个问题](https://stackoverflow.com/questions/22216441/what-is-the-difference-between-scope-root-and-rootscope)- 您可以使用`$root`范围上的属性，绑定将是

```
<input type="number" ng-model="$root.inputModel"/> 
```

这将直接绑定在根范围上，而无需在控制器中显式分配它。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-10-24T10:09:20.410

正如其他人指出的那样，这是一个典型的继承问题。您的输入模型是在当前范围内生成的，而不是在 rootScope 中生成的。

始终使用“。” 在你看来。这将起作用：

```
rootScope.fields = {
    inputModel: ''
} 
```

和

```
<input type="number" ng-model="fields.inputModel"/> 
```

# game-physics - 目标预测交集背后的数学是如何工作的？

> ID：15305901
> 
> 赞同：1
> 
> 时间：2013-03-09T00:58:05.873
> 
> 标签：game-physics, 2d-games

所以目前，我正在开发一款塔防游戏，并尝试了两种技术——HOming 和导弹/目标交叉预测 p——发射导弹以击中目标。

从美学上讲，我更喜欢后一种方法，因为它看起来是无缝的。问题是我基本上只是从这个线程 [2d 游戏的第二篇文章中复制了数学：通过预测射弹和单位的交叉点向移动目标开火，](https://stackoverflow.com/questions/2248876/2d-game-fire-at-a-moving-target-by-predicting-intersection-of-projectile-and-u)老实说，我不知道这家伙是如何制定这个方程的。

我有一些数学背景，理解什么是二次公式，但我不明白他是怎么想出来的。我搜索了一些示例二次公式问题，但问题似乎太简单或无关紧要。

*谁能引导我到一本书或网站来帮助我更好地理解这个数学？*

谢谢

# python - os.rename() 上的“WindowsError 183”

> ID：15305903
> 
> 赞同：0
> 
> 时间：2013-03-09T00:58:17.507
> 
> 标签：python, windowserror

```
#Opens a directory and outputs a text file there that lists every subdirectory in it

import os
from shutil import move

pathname = raw_input('Enter path for music directory (ex. C:\\Music): ')
fn = raw_input('Enter desired file name for all converted files: ')
ft = raw_input('Enter the file extension you want the program to look for (ex. .jpg): ')
changepath = []
os.chdir(pathname)
for path, subdirs, files in os.walk(pathname):
        for name in files:
            changepath.append(os.path.join(path, name))
for idx, val in enumerate(changepath):
    if val.lower().endswith(ft):
        os.rename(val, (fn + ft))
print('Complete') 
```

我正在使用它将音乐文件夹中的所有专辑插图重命名为一个东西，比如 new.jpg。

此代码在第 16 行“os.rename(val, (fn + ft))”上失败，错误为 183。当我使用“os.rename(val, val + (fn + ft))”时，它可以工作，但会调用文件类似 old.jpgnew.jpg 而不是 new.jpg 这正是我想要的。

当代码失败时（如上块所示），我在音乐目录中得到一个 new.jpg 文件。这是第一个子目录重命名的专辑封面，但第一个子目录之后没有专辑封面文件被重命名。成功重命名第一个图像后失败，但由于某种原因将其移出其原始目录并进入父“音乐”目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T01:13:19.933

**更新的答案**

好的，我没有看到应用不同方法的部分。这个：

```
os.rename(val, (fn + ft)) 
```

至：

```
os.rename(val, (os.path.dirname(val) + fn + ft)) 
```

可能是你想要的

**旧答案**

Windows 中的错误 183 是针对[已存在的文件](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx)。稍微查看一下您的代码：

```
fn = raw_input('Enter desired file name for all converted files: ')
ft = raw_input('Enter the file extension you want the program to look for (ex. .jpg): ') 
```

这里没有明显的路径信息，所以：

```
for idx, val in enumerate(changepath):
    if val.lower().endswith(ft):
        os.rename(val, (fn + ft)) 
```

路径在哪里`fn + ft`？根据您的逻辑，它最终会出现在您最初 chdir'ed 的任何位置。鉴于此`fn`，它`ft`似乎是静态值，这就是为什么你会得到文件已经存在的原因。

# c - 无法将引用（带 & 号的变量）传递给另一个变量

> ID：15305906
> 
> 赞同：0
> 
> 时间：2013-03-09T00:59:10.387
> 
> 标签：c

我试图将对对象的引用分配给另一个变量

```
scene_t temp = &scene; 
```

但是，我收到此错误消息

```
error: incompatible types when assigning to type 'scene_t' from type 'struct scene_t *' 
```

我也尝试使用指针

```
scene_t temp = *scene 
```

我得到了一个不同的错误

```
type argument of unary '*' (have 'scene_t') 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:08:47.127

假设类型`scene`是`scene_t`那么很明显类型`&scene`是`scene_t*`，这是编译器抱怨的。如果`scene_t`是 a`typedef`或非`struct`数组内置类型，您应该只写

```
scene_t temp = scene; 
```

或者

```
scene_t* temp = &scene; 
```

取决于你想要的语义。大概是前者。

* * *

如果`scene_t`实际上是数组类型，那么上面的第一个选项将不起作用。第二个*会*，但实际上比你需要的更冗长。这样做就足够了

```
thing_scene_t_is_an_array_of * temp = scene; 
```

无论哪种方式，您都只是得到一个指向旧数据的新指针，并覆盖一个覆盖另一个，所以要小心。

* * *

请注意，在地址运算符 ( `&`) 的上下文中使用“引用”一词表明您是从 c++ POV 中查看的。C 没有 c++ 样式引用，您不应该`&`以这种方式考虑。

# php - HTML 锚导致我的 php $_POST 变量被设置为数组

> ID：15305908
> 
> 赞同：1
> 
> 时间：2013-03-09T00:59:16.170
> 
> 标签：php, html, forms, post, anchor

我有一个在我的网页上绘制图像的 php 语句。当我单击该网页时，我会在另一个 php 语句中询问 $_POST isset 并且它总是评估为 true 并在我执行时打印出 Array()`print_r($_POST)`

我用来导航到将帖子显示为空数组的页面的代码是......

```
echo 'Create a New Link<a href="createlink.php"><img src="images/add.png" width="5%" height="5%"/></a>'; 
```

它的作用是在屏幕上写出*创建一个新链接*，然后创建一个锚点，最后显示一个图像。然后，如果用户单击图像，它会将他们带到*createlink.php*，这就是我出于某种原因设置了 $_POST 变量的地方。

我所做的所有研究都表明锚点默认使用 $_GET。我还对 $_GET 进行了测试以查看它是否已设置并且它也设置为空数组。

长话短说，`isset($_POST)`如果我通过锚链接进入该页面，我不想返回 true。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T01:05:23.120

我认为可以在[php.net](http://php.net/manual/en/reserved.variables.post.php)找到答案：

> [$_POST] 是一个“超全局”或自动全局变量。这仅仅意味着它在整个脚本的所有范围内都可用。

我认为您所能做的就是检查它是否为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T01:05:36.950

这是不可能的，只需在浏览器中打开任何脚本（使用 get）并执行`var_dump($_POST);`，结果是一个空数组；它总是设置的。

您可能需要修复检查是否发布帖子的位置；检查是否发出发布请求的更好方法是：

```
if ($_SERVER['REQUEST_METHOD'] === 'POST') 
```

# java - 如何解决 Java IOException: Negative Seek Offset？（Java ID3 标记库）

> ID：15305910
> 
> 赞同：1
> 
> 时间：2013-03-09T00:59:30.913
> 
> 标签：java, mp3, ioexception, id3-tag, id3v2

我正在尝试使用[Java ID3 Tag Library](http://javamusictag.sourceforge.net/)操作 MP3 文件中的 ID3 标签。但是，当我尝试使用“MP3File”类做任何事情时，我得到 IOException: Negative Seek Offset;

这是一个示例代码和堆栈跟踪：

```
package com.test;

import java.io.File;
import java.io.IOException;

import org.farng.mp3.MP3File;
import org.farng.mp3.TagException;

public class MP3Test {

    public static void main(String[] args) throws IOException, TagException {

        File f = new File("test.mp3");

        MP3File mp = new MP3File(f);

        System.out.println(mp.getFrequency());
    }

    }
--------------------------------------------------------------------------------

Exception in thread "main" java.io.IOException: Negative seek offset
    at java.io.RandomAccessFile.seek(Native Method)
    at org.farng.mp3.id3.ID3v1.seek(Unknown Source)
    at org.farng.mp3.id3.ID3v1.read(Unknown Source)
    at org.farng.mp3.id3.ID3v1.<init>(Unknown Source)
    at org.farng.mp3.MP3File.<init>(Unknown Source)
    at org.farng.mp3.MP3File.<init>(Unknown Source)
    at com.test.MP3Test.main(MP3Test.java:15) 
```

如您所见，即使是基本操作也会给我抛出异常，这让我很难真正开发一些东西......我正在尝试阅读的 MP3 文件工作得非常好。那么，关于为什么会发生这种情况和/或如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:23:55.437

> 那么，关于为什么会发生这种情况和/或如何解决它的任何想法？

冒着说明显而易见的风险，问题有两个可能的原因：

*   MP3 文件以某种微妙的方式被破坏，但这并不能阻止它“工作”......我认为这意味着在一些非 Java 播放器中播放。
*   该库是错误的，它没有正确处理某些东西。

解决方案？

*   尝试不同的 MP3 文件。
*   尝试来自不同来源的多个文件，以防它与特定软件生成的 MP3 文件有关。
*   使用 Java 调试器运行该库以找出实际导致异常的原因。这可能需要阅读 MP3 规范来确定 1) 代码、2) 规范和 3) 文件中的字节之间是否存在一些不匹配。

* * *

^(您将此作为编程问题提出，所以我假设您是一名程序员，并且一般能够进行故障排除，特别是在查找/阅读规范和调试 Java 方面。)

* * *

好的......因为您自己似乎没有在这方面取得任何进展，所以我查看了我在[这里](http://grepcode.com/file/repo1.maven.org/maven2/net.sf.javamusictag/jid3lib/0.5.4/org/farng/mp3/id3/ID3v1.java)找到的源代码。（当然，这可能是错误的版本，但你没有说你使用的是什么版本的库......）

看来问题出现在方法的第 309`org.farng.mp3.id3.ID3v1.java`行`seek`：

```
// If there's a tag, it's 127 bytes long and we'll find the tag
file.seek(file.length() - 128); 
```

现在，唯一*可能*给出负查找偏移异常的方法是`file.length()`返回小于 128 的文件长度。对于有效的 MP3 文件，这种情况永远不会发生。

所以我的猜测是，要么您尝试读取*截断*的MP3 文件，要么根本不是 MP3 文件的文件，或者您正在尝试从无法正确报告文件大小的某些设备/文件系统中读取文件。

（值得阅读 javadocs 以`File.length()`了解为什么它可能会返回一个奇怪的值；例如零。）

# java - 自己插入一个 LeafElement

> ID：15305912
> 
> 赞同：1
> 
> 时间：2013-03-09T00:59:40.460
> 
> 标签：java, user-interface, jeditorpane, defaultstyleddocument

我试图在 JEditorPane 的覆盖 DefaultStyledDocument（也提供自定义 EditorKit）中插入一个 LeafElement：但我得到一个 javax.swing.text.StateInvariantError。因此，按照[JGuru 论坛主题](http://www.jguru.com/forums/view.jsp?EID=482205#)的指导，我添加了 writeLock() 和 writeUnlock() 调用，但这次我的 JEditorPane 仍然为空。那么我应该如何覆盖 AbstractDocument 的 fireXXX() 方法，以便通知文档的所有侦听器？

这是我的主要课程：MyFrame.java

```
import javax.swing.JEditorPane;
import javax.swing.JFrame;
import javax.swing.JScrollPane;

public class MyFrame extends JFrame {

    public MyFrame(){
        setSize(400, 300);
        JEditorPane editorPane = new JEditorPane();
        editorPane.setEditorKit(new MyEditorKit());
        add(new JScrollPane(editorPane));
    }

    public static void main(String[] args) {
        new MyFrame().setVisible(true);
    }

    private static final long serialVersionUID = -2122161377842820073L;

} 
```

这是我的班级 MyEditorKit.java

```
import javax.swing.text.Document;
import javax.swing.text.StyledEditorKit;

public class MyEditorKit extends StyledEditorKit {

    @Override
    public Document createDefaultDocument() {
        return new MyDocument();
    }

    private static final long serialVersionUID = -5973765338689236766L;

} 
```

我的班级 MyDocument.java

```
import javax.swing.JLabel;
import javax.swing.text.DefaultStyledDocument;
import javax.swing.text.SimpleAttributeSet;
import javax.swing.text.StyleConstants;

public class MyDocument extends DefaultStyledDocument {

    public MyDocument(){
        BranchElement rootElement = (BranchElement) getDefaultRootElement();

        writeLock();
        LeafElement black10Element = (LeafElement) createLeafElement(rootElement, new SimpleAttributeSet(),0, 1);
        JLabel black10 = new JLabel("10 ...");
        StyleConstants.setComponent(black10Element, black10);
        writeUnlock();
    }

    private static final long serialVersionUID = -7424640574620960694L;

} 
```

这是我用 writeLock() 和 writeUnlock() 注释行时的错误堆栈跟踪：

```
 Exception in thread "main" javax.swing.text.StateInvariantError: Illegal cast to MutableAttributeSet
    at javax.swing.text.AbstractDocument$AbstractElement.checkForIllegalCast(AbstractDocument.java:2050)
    at javax.swing.text.AbstractDocument$AbstractElement.addAttributes(AbstractDocument.java:1983)
    at javax.swing.text.AbstractDocument$AbstractElement.<init>(AbstractDocument.java:1777)
    at javax.swing.text.AbstractDocument$LeafElement.<init>(AbstractDocument.java:2502)
    at javax.swing.text.AbstractDocument.createLeafElement(AbstractDocument.java:1275)
    at MyDocument.<init>(MyDocument.java:13)
    at MyEditorKit.createDefaultDocument(MyEditorKit.java:9)
    at javax.swing.JEditorPane.setEditorKit(JEditorPane.java:1058)
    at MyFrame.<init>(MyFrame.java:11)
    at MyFrame.main(MyFrame.java:16) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T21:31:10.857

我终于解决了我的问题：

只需将 MyDocument.java 更改为：

```
import javax.swing.JLabel;
import javax.swing.event.DocumentEvent.EventType;
import javax.swing.text.DefaultStyledDocument;
import javax.swing.text.SimpleAttributeSet;
import javax.swing.text.StyleConstants;

public class MyDocument extends DefaultStyledDocument {

    public MyDocument(){
        BranchElement rootElement = (BranchElement) getDefaultRootElement();

        writeLock();

        LeafElement black10Element = (LeafElement) createLeafElement(rootElement, new SimpleAttributeSet(), 0, 1);
        JLabel black10 = new JLabel("10 ...");
        StyleConstants.setComponent(black10Element, black10);

        /////////////////// Added lines
        DefaultDocumentEvent documentEvent = this.new DefaultDocumentEvent(0, 1, EventType.INSERT);
        try {
            getContent().insertString(0, " ");
        } catch(BadLocationException e){
            e.printStackTrace();
        }
        insertUpdate(documentEvent, black10Element);
        documentEvent.end();
        fireInsertUpdate(documentEvent);
        /////////////////////////////////////

        writeUnlock();
    }

    private static final long serialVersionUID = -7424640574620960694L;

} 
```

为什么要添加这些行？

那么 JGuru 主题链接建议应该生成一个新的 DocumentEvent ：在我的例子中，它是一个插入事件。所以 ：

1.  我创建了这个 DocumentEvent 实例
2.  在将字符串插入到 Document 的内容中（否则，它不会增长：即使我只是使用 JComponent 也是如此强制）=> getContent().insertString(offset, String)
3.  我使用它来应用文档中的更改 (insertUpdate())
4.  我将其标记为“不再进行中”（end()）
5.  我通知所有文档侦听器 (fireInsertUpdate())

# jquery - 引导按钮在移动设备上“卡住”

> ID：15305914
> 
> 赞同：14
> 
> 时间：2013-03-09T00:59:44.920
> 
> 标签：jquery, css, dom, mobile, twitter-bootstrap

每当我使用移动设备（android）在 twitter boostrap 按钮上单击按钮时，按钮的样式就会变得奇怪，就像鼠标仍然在上方并且在我单击另一个元素之前不会释放。这不是应用于元素的活动类。 ![这是点击前按钮的样子](../Images/0e0ece5ddf9b8951bafca34f7561d872.png)

![这是点击后按钮的样子注意阴影和背景](../Images/be0eb3e75a4d50867cb5305ce9298eb8.png)

这很微妙但很烦人，尤其是当我尝试将样式应用于按钮时，它们直到我单击不同的元素才会显示。

尝试在移动设备上访问[http://twitter.github.com/bootstrap/base-css.html#buttons](http://twitter.github.com/bootstrap/base-css.html#buttons)并单击一个按钮，您会明白我的意思

我尝试用 jquery 触发各种事件，但没有任何效果，这是我在我的 javascript 结尾处的一个片段

```
$(document).on('tapclick', '.btn', function() {
          $(this).blur(); 
          $(this).trigger('mouseup'); 

        }); 
```

并尝试在悬停时覆盖 CSS 样式

```
.btn a:hover,.btn a:link,.btn a:visited,.btn a:active{
text-decoration: none !important;
cursor: default !important;
background-color: transparent !important;
background-image: none !important;
 } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-09-11T16:08:17.527

如果您只是为移动设备开发，那么您可以简单地完全覆盖悬停 css，例如：

```
.btn:hover {
    background-color: inherit;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T12:08:51.907

我通过在 touchend 事件的按钮上添加一个类，然后覆盖默认的引导程序背景位置来解决这个问题。

javascript:

```
$("button").on("touchstart", function(){ 
    $(this).removeClass("mobileHoverFix");
});
$("button").on("touchend", function(){ 
    $(this).addClass("mobileHoverFix");
}); 
```

CSS：

```
.mobileHoverFix:hover,
.mobileHoverFix.hover{
    background-position: 0 0px;
} 
```

# ruby-on-rails - 如何使用 active_model_serializers 默认包含所有属性并过滤它们？

> ID：15305916
> 
> 赞同：8
> 
> 时间：2013-03-09T01:00:01.417
> 
> 标签：ruby-on-rails, active-model-serializers

我正在使用[active_model_serializers](https://github.com/rails-api/active_model_serializers)并且想找到一种方法来默认包含所有模型的属性，然后使用类似这样的东西

```
 exclude :date_created, :first_name 
```

指定我不需要的那些。

到目前为止，除了文档中的属性之外，我还没有找到一种方法来指定导出的属性，这是通过枚举所有需要的属性来完成的：

```
 attributes :title, :body 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-31T00:58:03.497

你可以在你的模型序列化器上做这样的事情（以用户作为模型的例子）：

```
class UserSerializer < ApplicationModelSerializer
   attributes(*User.attribute_names.map(&:to_sym))
end 
```

有关 ActiveRecord 属性名称的更多信息可以在这里找到：http: [//apidock.com/rails/ActiveRecord/AttributeMethods/attribute_names](http://apidock.com/rails/ActiveRecord/AttributeMethods/attribute_names)

# performance - 记录许多堆栈跟踪有多糟糕？

> ID：15305920
> 
> 赞同：0
> 
> 时间：2013-03-09T01:00:40.853
> 
> 标签：performance, node.js, logging, log4j

日志文件中有很多堆栈跟踪不是很糟糕吗？

我的意思是，您可以查看是否有问题 - 您可以查看它的来源。

但是性能呢？对于具有这种日志记录格式的应用程序来说，情况会有多糟糕？

在普通记录器中，如何在有和没有堆栈跟踪的日志之间切换系统？通过日志级别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:16:12.840

在日志文件中包含堆栈跟踪通常会更好——这样会更容易找到问题代码。

如果您只对堆栈跟踪生成性能感兴趣 - 我写了一篇关于在 Java 中引发异常需要多长时间的文章。大部分时间都被堆栈跟踪生成所消耗： [在Java中抛出异常非常慢](http://java-performance.info/throwing-an-exception-in-java-is-very-slow/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T02:17:22.810

我可以假设您正在谈论在挂钟时间中断上触发的堆栈跟踪吗？这些对于定位性能问题很有价值。（如果它们包含发生调用的行号信息，而不仅仅是函数/方法名称，则它们更有价值。）

但是，它们只有在您可以检查它们时才有价值，而且您无法检查数百万个它们，因此以接近高频的方式获取它们没有任何价值。几乎任何大到值得修复的性能问题都可以在 20 个或更少的堆栈样本中找到，前提是它们是在您关心的整个执行阶段随机抽取的。许多人发现这个数字令人惊讶，但这[*是数学*](https://scicomp.stackexchange.com/a/2719/1262)。

原则上，如果你有一个统计总结器，你可以使用更多它们，就像[*Zoom*](http://www.rotateright.com/) profiler 一样，但实际上你可以手动做得更好，因为你的大脑比任何统计数据都能更好地识别浪费的处理。

# sql-server - sql server 存储过程中的 CASE 语句出现问题

> ID：15305925
> 
> 赞同：2
> 
> 时间：2013-03-09T01:01:14.370
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2

我刚刚开始在 sql server 中使用存储过程，并且进展顺利，但我现在遇到了一个我无法理解的问题。我一直在寻找答案，但老实说，我不确定我问的是正确的问题。

我的sp是：

```
ALTER PROCEDURE [FindName]
    @Square nvarchar(100) = null,
    @Location nvarchar(100) = null,
    @Name nvarchar(100) = null,
    @NormalizedName nvarchar(100) = null,
    @SharedLand int = 0,
    @FieldNumber int = 0,
    @Description nvarchar(255) = null,
    @Dwelling nvarchar(100) = null
AS

BEGIN
    SELECT * FROM [Holdings]
    WHERE 
        ([Square] LIKE @Square OR @Square IS NULL)
        AND ([Location] = @Location OR @Location IS NULL)
        AND ([Name] LIKE @Name OR @Name IS NULL)
        AND ([NormalizedName] LIKE @NormalizedName OR @NormalizedName IS NULL)
        AND ([SharedLand] = @SharedLand OR @SharedLand = 0)
        AND ([FieldNumber] = @FieldNumber OR @FieldNumber = 0)
        AND ([Description] LIKE @Description OR @Description IS NULL)
        AND ([Dwelling] LIKE @Dwelling OR @Dwelling IS NULL)
        ORDER BY
            CASE WHEN (@NormalizedName IS NOT NULL) THEN [NormalizedName]
            ELSE [No]
        END
END 
```

这一切都适用于所有使用任何或所有参数但没有 CASE 但使用 CASE 语句的 EXEC，以下工作：

```
EXEC FindName @Square = '%D%'
EXEC FindName @SharedLand = 1 
```

但是当我尝试时：

```
EXEC dbo.cafgFindName @NormalizedName = '%Thomas%' 
```

我收到错误消息： *将 nvarchar 值“Thomas”转换为数据类型 int 时转换失败。*

我无法理解的是转换发生在哪里，如果这确实是问题。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T01:13:29.963

这是因为 CASE 语句必须解析为单一类型。在这种情况下（没有双关语：）您正在考虑使用 nvarchar 或 int（我认为 [No] 是 int）。

有关更多详细信息，请参见此处： [CASE 中的排序方式和不同类型](https://stackoverflow.com/questions/5214613/order-by-and-different-types-in-a-case)

# mysql - SQL 查询 DATEDIFF 返回 NULL

> ID：15305927
> 
> 赞同：3
> 
> 时间：2013-03-09T01:01:30.770
> 
> 标签：mysql, datediff

我正在 mySQL DB 中编写此查询。该表`listing`有两列`StartDate`& `EndDate`。我想使用`Duration`ie 返回这两个日期之间的天数`DATEDIFF`。我的查询是：

```
SELECT DATEDIFF(StartDate, EndDate) as 'Duration' FROM listing; 
```

该表在 Duration 列中返回 NULL。

如果我写，

```
SELECT DATEDIFF(day, StartDate, EndDate) as 'Duration' FROM listing; 
```

返回

```
Error Code: 1582\. Incorrect parameter count in the call to native function 'datediff'   0.000 sec 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T08:22:33.097

问题是`DATEDIFF()`期望日期的格式`YYYYMMDD`和列输入，`StartDate`而`EndDate`我给出的是`MMDDYYYY`. 我将其更改为`YYYYMMDD`并且有效。因此，以下带有 YYYYMMDD 格式日期的表达式可以正常工作。

```
SELECT DATEDIFF(StartDate, EndDate) as 'Duration' FROM listing; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:12:00.713

两个参数是正确的。如果您得到 NULL，可能是因为这些列中的值不是日期或日期时间类型。

来自 MySql 文档：

```
DATEDIFF(expr1,expr2)
DATEDIFF() returns expr1 – expr2 expressed as a value in days from one date to the other. expr1 and expr2 are date or date-and-time expressions. Only the date parts of the values are used in the calculation.

mysql> SELECT DATEDIFF('2007-12-31 23:59:59','2007-12-30');
    -> 1
mysql> SELECT DATEDIFF('2010-11-30 23:59:59','2010-12-31');
    -> -31 
```

# python - 从客户端接收的 TCP 服务器有时不起作用

> ID：15305930
> 
> 赞同：1
> 
> 时间：2013-03-09T01:01:48.160
> 
> 标签：python, sockets, networking, protocols

我正在为我自己的协议使用 Python 编写的服务器，但我遇到了问题。客户端连接到服务端，得到了`sendall()`三组数据：一个包标识字节，一个字符串长度，一个UTF-8编码字符串。

在客户端，我没有收到任何错误，但在服务器端，这是：

```
error: [Errno 10054] An existing connection was forcibly closed by the remote host 
```

发生。错误每次都发生在不同的行，有时在`recv()`识别字节时，有时在读取字符串长度时，有时在读取字符串本身时，有时它工作得非常好，就像它应该做的那样。

这里发生了什么？服务器计算机有防火墙例外。客户端连接，连续发送三条数据，然后关闭套接字。我这样做是不是太快了？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:36:49.570

好吧，这不是一个长期存在的问题。

看起来我关闭套接字客户端的速度太快了，在添加限制后，我停止了错误。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T09:25:49.290

此问题的通常原因是写入已被对等方关闭的连接：换句话说，应用程序协议错误，写入永远不会被读取的数据。

# wix - 如何将属性从烧录本机引导程序中的 EditBox 控件传递到 MSI

> ID：15305932
> 
> 赞同：4
> 
> 时间：2013-03-09T01:02:02.497
> 
> 标签：wix, installation, windows-installer, burn

我在本机引导程序应用程序的选项对话框中有一个 EditBox 控件：

```
<Editbox Name="MyEditBox" X="221" Y="151" Width="-100" Height="21" TabStop="yes" FontId="3" /> 
```

在 bundle.wxs 文件中，我有：

```
<Variable Name="MyEditBox" bal:Overridable="yes"/> 
```

在要向其传递用户在 EditBox 控件中输入的值的 MSI 元素下，我有：

```
<MsiProperty Name="FIRE" Value="[MyEditBox]"/> 
```

但是，未设置 MyEditBox，并且 FIRE 作为空字符串传递给 MSI。上述方法基于此：[使用附加输入自定义 WiX Burn 主题](https://stackoverflow.com/questions/12323106/customising-the-wix-burn-theme-with-additional-inputs)

似乎上面提到的链接不适用于 EditBoxes。为了解决这个问题，我设置 `DisplayInternalUI="yes"`了 MSI。但是，我仍然希望不显示 MSI 对话框，而是使用 EditBox 控件通过 WiX BA 对话框传递属性。随着时间的推移，我将编写一个可以完成这项工作的托管 BA，但我现在需要使用本机 BA 来完成这项工作。根据他的链接： http: [//www.mail-archive.com/wix-users@lists.sourceforge.net/msg54024.html](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg54024.html)似乎 EditBox 控件实际上可以用于将属性传递给 MSI，但我没有无法让它发挥作用。任何见解将不胜感激。

**更新：** 我编写了一个自定义托管引导程序，它使我们能够解决这个问题。正如 Rob 所提到的，在默认 BA 中存在一个现有的功能请求来实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T05:07:26.987

有一个功能请求允许任意编辑框将其数据存储到刻录变量中。截至今天，该功能请求尚未实现，尽管有人表示有兴趣实现它。

# nsdocument - Cocoa：在基于文档的应用程序中，每个文档的首选项存储在哪里？

> ID：15305936
> 
> 赞同：3
> 
> 时间：2013-03-09T01:02:21.500
> 
> 标签：nsdocument

在制作基于文档的应用程序时，每个文档都可能有与之关联的设置：排序顺序、拆分视图大小、窗口大小、字体大小等。其中一些我可以看到包含在窗口恢复中，但其他一些似乎很尴尬那。

是否有一种基于每个文档存储首选项的规范方法？我习惯了 NSUserDefaults 但那些是应用程序范围的；我从来没有为 NSDocument 应用程序这样做过。

# javascript - Javascript“抽象方法”

> ID：15305938
> 
> 赞同：13
> 
> 时间：2013-03-09T01:02:29.353
> 
> 标签：javascript, jquery, oop, overloading, object-literal

我的术语有点不对劲，因此请在必要时进行更正。我想在 javascript 和“基类”中重载一个函数，以利用重载的方法以及继承的类来访问基类的方法。到目前为止，我想出了一个（工作的）`jquery.extend()`对象字面量组合，但这看起来并不漂亮。我想知道是否有更好的方法（可以使用 jquery）。

```
var Base = new function(args, m) {
   $.extend(this, m);
   var self = this;
   this.bar = function() {
     self.foo();
   }
   this.foo = function() {
     self.blah();
   }
   this.dosomething = function() {}
};

var Child = function(arg1) {
   $.extend(this, new Base(args, {
     blah: function() {
       self.dosomething()
     }
   }));
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-09T01:18:15.463

What you're looking for is a way to share functionality across objects. This is **exactly** the sort of thing the JavaScript prototypical inheritance model excels at.

There's no need to use jQuery or other libraries in order to accomplish this. Consider going *with* the language's way of doing things.

### Prototypes

In JavaScript, objects have 'prototypes'. When JavaScript looks for a method in an object that does not have it, it looks for it up on the prototype 'chain'. So all you need to do is override that functionality at a lower level on that chain.

This is explained in detail in [the tutorial about it on MDN.](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_and_the_prototype_chain)

### Your specific case

If I want a `Base` and `Child` class, where the `Base` has a method that `Child` needs to override, all we need to do is assign it anywhere lower in that chain.

The order of look-up is

```
Child Object --> Child's prototype (a Base object) --> Base's prototype (an Object) 
```

For example, let's say you have a class Base

```
function Base(){

}
Base.prototype.bar = function() {
     //bar logic here
     console.log("Hello");
};
Base.prototype.foo= function() {
     //foo logic here
};

Function Child(){

}

Child.prototype = new Base(); 
```

I'd like Child to implement Bar differently, in which case I can do

```
Child.prototype.bar = function(){
   console.log("World");
} 
```

Which results in

```
var a = new Base();
a.bar(); //outputs "Hello" to the console
var b = new Child();
b.bar(); //outputs "World" to the console
         //The Base instance that is the prototype of b has the bar method changed above 
```

### Note On Abstract Classes in JavaScript

Two of the primary reasons abstract methods inheritance is used in languages that are based on classical inheritance (like Java) is Polymorphism and code sharing.

In JavaScript neither are a problem. Code sharing can be done using prototypical inheritance just as easily. Moreoever, you can take just about any function and run it in another context. For example, I can even call the `bar` method of a `Child` object on an empty array by doing `b.bar.call([])`.

As for polymorphism JavaScript is a dynamic language with duck typing. This means it looks at objects based on their ability and not the way they were declared. If several objects have a method called `bar` I would have [no problem](http://jsbin.com/ukomos/1/) calling that method on each of them if they are in an array or other collection. In Java that would require a common interface,type or ancestor.

For these reasons, things like *abstract classes* don't play a big role in JavaScript.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T01:15:53.330

I recommend doing it the way [CoffeeScript](http://coffeescript.org/) does it. You can put the first `var` declaration in a separate file to keep the code looking nice. As far as I know `__extends` is equivalent to `$.extends`

```
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

var Fruit = (function() {

  function Fruit() {
    console.log("New fruit");
  }

  return Fruit;

})();

var Apple = (function(_super) {

  __extends(Apple, _super);

  function Apple() {
    console.log("New apple");
    Apple.__super__.constructor.apply(this, arguments);
  }

  return Apple;

})(Fruit);

var apple = new Apple(); 
```

Or, if you can use CoffeeScript, it looks like this:

```
class Fruit
  constructor: ->
    console.log "New fruit"

class Apple extends Fruit
  constructor: ->
    console.log "New apple"
    super 
```

# wordpress - 如何找到我的 Facebook 页面 ID？

> ID：15305948
> 
> 赞同：1
> 
> 时间：2013-03-09T01:04:18.183
> 
> 标签：wordpress, facebook-page

我试过使用`findmyfacebookid.com`，但它回来了：

```
Unable to lookup Facebook numeric ID. You can try again, or see this tutorial for an alternate method. 
```

我也尝试了另一种方法，但没有运气。任何想法如何获取页面的 Facebook 标识符？

该页面是`www.facebook.com/mickandsheilagillmortgageexperts`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:10:00.010

使用该链接`http://graph.facebook.com/username`将有效地返回一个 JSON 数组`username`的详细信息。

使用该字段`id`获取用户的页面标识符。[这是使用扎克伯格个人资料](http://graph.facebook.com/zuck)的示例。

```
{
   "id": "4",
   "name": "Mark Zuckerberg",
   "first_name": "Mark",
   "last_name": "Zuckerberg",
   "link": "https://www.facebook.com/zuck",
   "username": "zuck",
   "gender": "male",
   "locale": "en_US"
} 
```

# ruby-on-rails - 控制器操作不与 link_to 功能一起运行

> ID：15305954
> 
> 赞同：0
> 
> 时间：2013-03-09T01:04:36.117
> 
> 标签：ruby-on-rails, link-to

我需要使用 link_to 通过我的视图调用一个简单的控制器操作。

在首选项 > index.html.erb 中：

```
<%= link_to "My link", :controller => 
:preferences, :action => :produces_text %> 
```

请注意，我也尝试过使用这种格式的 index.html.erb，但没有成功：

```
<%= link_to "My link", {:controller =>
:preferences, :action => :produces_text } %> 
```

在preferences_controller.rb 中：

```
def produces_text
  puts "test"
  redirect_to preferences_url
end 
```

在路线：

```
resources :preferences do
  member do
    get 'produces_text'
  end
end 
```

当我单击“我的链接”并且我也没有重定向到preferences_url 时，终端中不会产生“test”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:10:49.930

```
resources :preferences do
    collection do
        get 'produces_text', as: :produces_text
    end
end

<%= link_to "Link", produces_text_preferences_path %> 
```

# c# - 在初始页面加载时从服务器获取类对象并进入 js 对象的好方法是什么？

> ID：15305955
> 
> 赞同：1
> 
> 时间：2013-03-09T01:04:38.293
> 
> 标签：c#, javascript, asp.net-mvc, asp.net-web-api

目前，我在我的应用程序中做这样的事情：

```
// Foo Controller
public ActionResult Details(int id)
{
    ViewBag.id = id;
    return View();
}

// Foo Details View
<script type="text/javascript">
    var viewBag = {
        'id': @ViewBag.id
    };// *Note: MVC will cry about a syntax error here, everything's ok though
</script>
<script type="text/javascript" src="@Url.Content("~/Views/Foo/details.js")"></script>

// details.js
$(function(){
    var jqXHR = $.ajax({
        'url': '/api/foo/getData/' + viewBag.id,
        'type': 'GET'
    });
    jqXHR.done(function(data){
        ...do stuff with data object...
    });
});

// Foo Api Controller
// Instantiates the data class object to be serialized and returned 
```

我这样做是因为在`<javascript>`元素中，我不希望对象的巨大 JSON 字符串只是挂在这里。理想情况下，我只想对 Foo 控制器进行一次调用，让它实例化数据类对象，将其序列化为 JSON 字符串，并将其分配给 ViewBag.dataModel 或类似的东西。

当然，我无法访问`@ViewBag`.js 文件，因为它是服务器端对象。有谁知道这样做的更整洁的方法，而不是来回有点不必要的？

一种想法是解析参数的 URL，但这可能会根据路由结构变得难看，我仍然需要等待`get`视图的初始值才能让 js 脚本完成所有这些工作，但最终还是不得不无论如何都要打第二个电话。

我不知道这是否可能，但有没有一种方法可以在创建视图期间动态生成一个 .js 文件，该文件可以用作 js ViewBag，在 details.js 文件加载之前将其添加到页面，然后能够以这种方式访问​​它吗？或者可以即时修改 details.js 文件（如果需要缩小/捆绑，这可能不是理想的）？

期望的结果是，我正在使用 knockoutJS，并且我试图传递的初始对象是我想要绑定到包含我想要使用的服务器的所有初始数据的页面的 ViewModel。我从服务器获取的数据对象是 ViewModel，我将其映射到可观察对象并绑定到 DOM。我正在使用的当前方法似乎工作正常并且似乎没有太多开销，但如果我可以避免在页面初始加载时对服务器进行第二次调用，那将是理想的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:28:06.863

首先，我不会将动态信息写入脚本标签。而是将您的数据编码为 JSON，然后将其写入隐藏字段。

当您使用 MVC4 时，您已经有了对 JSON.NET 的引用，因此您应该能够做到这一点：

**在控制器中**

```
public ActionResult Details(int id)
{
    var myModel = GetMyModelData(id);
    string modelJson = JsonConvert.SerializeObject(product); 
    return View(modelJson);
} 
```

**在视图中**

```
<input type="hidden" id="model" value="@Model" /> 
```

**在 Javascript 中**

```
var modelJson = $('#model').val();
var modelObj = JSON.parse(modelJson); 
```

# java - 如何在打印的字符串周围添加“”引号？

> ID：15305956
> 
> 赞同：10
> 
> 时间：2013-03-09T01:04:48.240
> 
> 标签：java, string, printing

我想在java中打印倒引号。但是如何打印呢？

```
for(int i=0;i<hello.length;i++) {
    String s=hello[i].toLowerCase().trim();
    System.out.println(""+s+"");
} 
```

预期的OP：“嗨”.....

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-09T01:08:55.120

因为双引号*分隔*字符串值，自然你必须将它们转义以编码文字双引号，但是你可以这样做*而不用*像这样转义：

```
System.out.println('"' + s + '"'); 
```

在这里，双引号字符 ( `"`) 已被编码为`char`值。我发现这种风格比“笨拙”的反斜杠方法更容易阅读。但是，这种方法只能在附加*单个*字符常量时使用，因为“char”（当然）恰好是一个字符。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-09T01:06:37.830

由于 Java 源代码中使用引号来表示字符串，因此您需要对它们进行转义以创建包含引号的字符串

```
 System.out.println("\""+s+"\""); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-09T01:06:53.493

您必须转义引号：`\"`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-09T01:14:22.287

Assuming that by "Inverted" quotes you meant "Left" and "Right" specific quotation marks, you could do it like this:

```
System.out.println('\u201C'+s+'\u201D'); // Prints: “s”
System.out.println('"'+s+'"');           // Prints: "s" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-09T01:13:34.113

# git - 如何从 git 分支中拆分工作？

> ID：15305961
> 
> 赞同：0
> 
> 时间：2013-03-09T01:05:27.293
> 
> 标签：git, split

有时在一个分支工作你最终会得到比你计划的更多的东西，并意识到将你所做的一些事情拆分到另一个分支是值得的。

例如，在修复妨碍您的错误、添加文档或进行一些您在途中注意到的小功能修复时。

将您所做的一些工作拆分到新分支中的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:05:27.293

用于`checkout -i`以交互方式将您想要的位选择到新分支中，提交该位，然后`git revert`在大分支上使用以删除您拆分的内容。

例如

```
---A         - @{upstream}
    \
     \--B--C - LargeBranch 
```

在 LargeBranch 所基于的同一个上游分支上创建一个新分支`SplitBranch`，并以交互方式选择您想要的更改：

```
git checkout -b SplitBranch @{upstream}
git checkout -i LargeBranch
git commit 
```

导致：

```
---A         - @{upstream}
   |\
   | \--B--C - LargeBranch
    \
     \--D    - SplitBranch 
```

然后，使用以下命令轻松删除已拆分`SplitBranch`的内容`git revert`：

```
git checkout LargeBranch
git revert halfFoo

---A            - @{upstream}
   |\
   | \--B--C--E - LargeBranch,  E is inverse of D.
    \
     \--D       - SplitBranch 
```

现在，`LargeBranch`您移入的内容不再存在`SplitBranch`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T01:13:37.920

I'd create a new branch to receive the "too much" changes at some convenient point before the mess, `git cherry-pick` the commits from the original to it, and then `git rebase -i` them out of the original. You might split some of the commits before the cherry picking.

To make sure nothing gets lost, start with a `git branch save` at the HEAD, that way you can mess around with the existing branches; blow all away and start over.

# asp.net - IIS 网站逐渐变慢，直到重新启动

> ID：15305965
> 
> 赞同：1
> 
> 时间：2013-03-09T01:06:04.610
> 
> 标签：asp.net, performance, iis, windows-server, iis-8

我在 Windows Server 2012 上的 IIS8 上有一个 ASP.NET 2.0 网站。

网站刚开始时速度很快，但一天下来会逐渐变慢。如果我重新启动 IIS，问题就解决了，它又变快了，但是循环继续，它变慢了。

我可以从哪里开始尝试诊断这个问题..？

# c - 从另一个结构访问结构数据

> ID：15305971
> 
> 赞同：0
> 
> 时间：2013-03-09T01:07:09.477
> 
> 标签：c

我正在尝试从另一个节点访问一个节点的数据。

```
struct orderNode 
{
  int price;
  int quantity;
};

struct lnode
{
  struct lnode* data;
  struct lnode* next;
  struct lnode* prev;
}; 
```

我如何使用 lnode 值（数据）来访问值（价格和数量）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T01:10:19.280

```
struct orderNode 
{
   int price;
   int quantity;
};

struct lnode
{ 
  struct lnode* next;
  struct lnode* prev;
  struct orderNode* oNode;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T01:17:57.427

If you want `lnode.data` to access an `orderNode` your definition is wrong, it'd have to be:

```
struct lnode
{
   struct orderNode *data;
   ... 
```

You can then use `lnode.data->price` or `lnode.data->quantity`, assuming you've assigned the `data` pointer to a valid `orderNode` struct.

# c# - 确定在抛出 OutOfMemoryException 之前可以使用的可用内存

> ID：15305976
> 
> 赞同：4
> 
> 时间：2013-03-09T01:08:22.047
> 
> 标签：c#, .net, memory-management, out-of-memory

在`OutOfMemoryException`系统本身内存不足之前，我的应用程序会被抛出，如：
[MSDN 博客 - 内存不足？增加程序可用内存的简单方法。](http://blogs.msdn.com/b/calvin_hsia/archive/2010/09/27/10068359.aspx)

> 当你运行你的 C# 应用程序时，你可能会被`OutOfMemoryException`抛出，即使你的机器有很多内存。[...] 4 Gigs 分为两半：用户应用程序获得下半部分，操作系统获得上半部分。（这个边界可以改变：见下文）。

根据要求，我需要可视化我的应用程序可用的内存量和当前使用情况。当前使用情况可以使用`Process.GetCurrentProcess();`和其他方法检索，但如何确定我的应用程序在运行时可用的内存？我就是想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:22:40.247

您可以使用[MemoryFailPoint](http://msdn.microsoft.com/en-us/library/system.runtime.memoryfailpoint.aspx)在大分配之前进行检查。这并不完全是您所要求的，但如果您的失败发生在特定的已知大型分配点，这至少允许您在分配失败发生时干净利落地处理它。

# protocols - 通信包/帧图：记录协议

> ID：15305979
> 
> 赞同：4
> 
> 时间：2013-03-09T01:08:30.777
> 
> 标签：protocols, communication, diagram

你能给我推荐一个图表软件，我可以在其中绘制像这样的图表（尽可能开箱即用）： ![在此处输入图像描述](../Images/bf236cc08220e47881fbb442b394f2ee.png)

这些类型的图表通常用于记录通信协议，因此人们可以很容易地理解数据包/帧是如何组成的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-11-20T00:19:38.997

可能最好的（但不是开箱即用的）解决方案是在矢量图形编辑器（例如[Inkscape](https://inkscape.org/en/)）中绘制它。

我偶然发现了这个问题，正在寻找相同的问题解决方案。我认为如果我分享我的发现，它可能对其他人有用。可以[使用 packetdiag](http://blockdiag.com/en/nwdiag/packetdiag-examples.html)绘制一些不同的 PDU 结构图，[在 wavedrom 编辑器中](http://wavedrom.com/editor.html)或[使用 TeX 进行描述](https://tex.stackexchange.com/questions/95405/designing-packet-structure-of-a-protocol)。

在相关问题的答案中也有一些相关信息：~~https~~ ://stackoverflow.com/questions/2034636/best-way-to-document-a-packet-protocol （RFC中如何描述数据包结构）。问题现已删除，但您可以[在 webarchive](https://web.archive.org/web/20150512154204/https://stackoverflow.com/questions/2034636/best-way-to-document-a-packet-protocol)中找到它。

如果分享您解决此问题的方式，那就太好了。

# hadoop - 使用 Hadoop 查找两个数据集的差异

> ID：15305992
> 
> 赞同：1
> 
> 时间：2013-03-09T01:09:48.550
> 
> 标签：hadoop, hive, apache-pig

我在文件中有两个数据集，其中包含以下数据（每个文件中约 500 百万行）：

```
Dataset1:
a1
a2
a3
a4

Dataset2:
a1
a2 
```

我想在 Dataset1 中找到 Dataset2 中不存在的元素所以，结果应该是：

```
Dataset3
a3
a4 
```

使用 Hadoop 执行此操作的最佳方法是什么？任何与加入相关的机制、Pig 或其他什么？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T01:58:58.663

您可以使用 HIVE 轻松完成。
1.[创建表](https://cwiki.apache.org/Hive/languagemanual-ddl.html#LanguageManualDDL-CreateTable)
2.[加载数据](https://cwiki.apache.org/Hive/languagemanual-dml.html#LanguageManualDML-Loadingfilesintotables)
3.查询，简单的LEFT JOIN：

```
SELECT Dataset1.a LEFT JOIN Dataset1.a=Dataset2.a WHERE Dataset2.a IS NULL 
```

完毕！GL！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T01:02:36.803

Pig 使用`COGROUP`操作符很容易做到这一点：

```
dataset1 = LOAD '/path/to/dataset1' USING PigStorage('\n') AS (line:chararray);
dataset2 = LOAD '/path/to/dataset2' USING PigStorage('\n') AS (line:chararray);

grpd = COGROUP dataset1 BY line, dataset2 BY line;
d1_only = FOREACH (FILTER grpd BY IsEmpty(dataset2)) GENERATE FLATTEN(dataset1); 
```

# jquery - jQuery UI 滑出内容，新内容进入

> ID：15305998
> 
> 赞同：1
> 
> 时间：2013-03-09T01:11:01.663
> 
> 标签：jquery, user-interface, slide

我正在努力实现这一目标：

[http://i.imgur.com/fQM4ZR8.gif](http://i.imgur.com/fQM4ZR8.gif)

使用[jQuery UI](http://jqueryui.com/) | [滑动](http://docs.jquery.com/UI/Effects/Slide)

遗憾的是，我没有要修复的代码，我正在寻找你能给我的如何实现这一目标的任何方向。它需要离开设定的距离，然后返回到它的初始起点并显示与他们单击的锚点相关的内容。很抱歉没有代码开始，我对 JavaScript 相当陌生。

非常感谢您提供的任何帮助或建议，

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:22:25.203

使用该`.animate()`函数更容易，因为它为动画提供了回调函数

```
$(function () {
    var wid = $('.content').width(); 
    $('.content').animate({"margin-right": "-" + wid + "px"}, 500, function ()   {

        $(this).text("new content");
        $('.content').animate({"margin-right": "0px"}, 500);
    });
}); 
```

工作示例：http: [//jsfiddle.net/JMqpe/1/](http://jsfiddle.net/JMqpe/1/)

此代码会将框一直向右移动（与宽度相同），更新内容，现在它已隐藏，然后返回其原始位置（假设它的 margin-right 开始时为 0）

# facebook - OpenID 不工作 - gmail

> ID：15305999
> 
> 赞同：0
> 
> 时间：2013-03-09T01:11:28.297
> 
> 标签：facebook, openid

我使用我的电子邮件 ID xxxxxx@hotmail.com 注册了 facebook longback。现在我添加了我的 gmail ID xxxxxx@gmail.com

我想使用 OpenID 登录 facebook - 首先我想使用我的 gmail ID 和 gmail 密码登录我的 gmail，然后我在新的 TAB 中打开 facebook（在同一个浏览器中）它不应该询问我的 facebook 用户名和 Facebook密码。

但在我的情况下它不起作用，即使在登录 gmail 之后，facebook 也会要求提供 facebook 用户 ID 和 facebook 密码。

您能否帮助使用 openID 的正确程序（即使用 facebook 的 gmail 用户凭据进行 gmail 登录）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:37:15.137

我不认为 Facebook 支持 OpenID 登录。您可以将 OpenID 用于 Google 帐户，也可以使用 Facebook 自己的登录方案，也可以使用 OAuth。

[https://developers.google.com/accounts/docs/OpenID](https://developers.google.com/accounts/docs/OpenID) [https://developers.facebook.com/docs/concepts/login/](https://developers.facebook.com/docs/concepts/login/) [https://developers.facebook.com/docs/reference/dialogs/oauth/](https://developers.facebook.com/docs/reference/dialogs/oauth/)