# StackOverflow 问答 16156000-16156999

# ruby-on-rails - 测试分页方法和助手

> ID：16156004
> 
> 赞同：0
> 
> 时间：2013-04-22T20:20:52.060
> 
> 标签：ruby-on-rails, view-helpers

好的，我有一些对象（在这里真的不重要），我添加了 \ 分页方法和 hepler。现在我想测试它的外观以及它是如何工作的。问题是我想检查它的 10,20 等页数。但是创建这么多要分页的对象来测试它真的很耗时吗？还有其他选择吗？

编辑：诀窍是有包括唯一性在内的复杂验证，所以我不能只在控制台中编写一个从 1 到 200 的循环来创建所需数量的对象。

# c++ - 在 C++ 项目中链接 crypt 时遇到问题

> ID：16156005
> 
> 赞同：0
> 
> 时间：2013-04-22T20:20:52.413
> 
> 标签：c++, c, encryption, crypt

我正在尝试使用[GNU C 库 crypt](http://www.gnu.org/software/libc/manual/html_node/crypt.html)`crypt()`中包含的方法。我看过这些类似的问题，[1](https://stackoverflow.com/questions/2565427/c-crypt-function) , [2](https://stackoverflow.com/questions/5989444/problem-with-crypt-h-in-c) , [3](https://stackoverflow.com/questions/6127921/is-the-crypt-function-declared-in-unistd-h-or-crypt-h)但无法得到任何提供的解决方案。

我只是包括这两件事

```
#include <unistd.h>
#include <crypt.h> 
```

编译器告诉我

```
hashtable.h:7:19: error: crypt.h: No such file or directory
make: *** [pass.x] Error 1 
```

如何让编译器识别 crypt.h？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:24:24.977

你的系统上安装了 crypt 吗？如果是，找到带有 crypt.h 的目录并将其添加到编译器的头文件搜索路径：-I/path/to/crypt/headers

您还需要使用 -lcrypt 链接到 crypt 库，可能使用 -L 选项告诉链接器库在哪里。

在 OSX 上使用 crypt 的说明：[在 OS X 上使用 crypt_r](https://stackoverflow.com/questions/14045543/using-crypt-r-on-os-x)

# python - 如何在循环中创建文件描述符并随后写入它

> ID：16156012
> 
> 赞同：0
> 
> 时间：2013-04-22T20:21:28.433
> 
> 标签：python, file-io

[在Python Multiple file writing question](https://stackoverflow.com/questions/6351007/python-multiple-file-writing-question)上提出了一个类似的问题，但它并没有解决我的问题，因为文件描述符是唯一的，而且我不知道如何在循环中动态创建文件描述符。

我有一个巨大的文件，格式如下：

```
field1  field2  field3  field4  field5
a   _   b   _   c
d   e   f   g   g
l   _   _   m   _
_   n   o   _   p 
```

我需要创建 5 个单独的文件“field1.txt”、“field2.txt”、“field3.txt”、“field4.txt”和“field5.txt”。

我只想读取一次输入文件。对于每一行，我检查是否一个字段不是空白（'_'），然后将完整的行写入以相应字段名称开头的文件中。

例如，由于第 1 行的第一个、第三个和第五个字段不为空，因此该行将写入文件“field1.txt”、“field3.txt”和“field5.txt”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:28:51.873

想到这样的事情：

```
# TESTED
f = open('inputfile.txt')
line1 = next(f)
line1 = line1.split()
output_files = [open(fname+'.txt', 'w') for fname in line1]

for line in f:
  for output_file, field in zip(output_files, line.split()):
    if field != '_':
      output_file.write(line) 
```

# c# - 如何保留数据库中项目的最新条目

> ID：16156014
> 
> 赞同：0
> 
> 时间：2013-04-22T20:21:32.780
> 
> 标签：c#, sql, asp.net-mvc, linq, datetime

在我的数据库中，比方说，我有一个巨大的气象广播集合。

例如，我想从特定城市获取所有的气象广播，但只返回气象广播的最新条目而不是全部。所以我会得到一份来自该市所有城镇/地区的气象广播列表。

所以假设我有这个方法：

```
internal List<METEO> ListLatestMeteoByRegion(int _id)
{
    var meteoQry = from meteo in db.METEO
                   where meteo.REGION.REGIONID == _id
                   // SORT METEO BY DATETIME???
                   select meteo;

    List<METEO> listToReturn = new List<METEO>;

    listToReturn.AddRange(meteoQry);
} 
```

METEO 就是这个模型：

```
public class METEO
{
    public int METEOID { get; set;} 

    public int REGIONDID { get; set; }

    public Region region { get;set; }

    public int DISTRICTID { get; set; }

    public District district { get; set;}

    public DateTime DATEMETEOBROADCAST { get; set; }

    public string METEOOUTSIDE { get; set;}
} 
```

现在这是不完整的，因为气象数据库可能在同一天有许多来自同一个城市的条目，我想随时获得绝对最新的。同样，由于一些懒惰的家伙（你明白了），它可能会在几天内“没有”任何条目。

我如何检查数据库以确保我只获取并保留此类气象广播的最新条目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:23:31.957

我不完全确定我理解你的问题。此查询将返回您的最新记录`REGIONID`：

```
var meteoQry = (from meteo in db.METEO
                   where meteo.REGION.REGIONID == _id
                   orderby meteo.DATEMETEOBROADCAST descending
                   select meteo).First(); 
```

在 Jason 在评论中发布的链接中，请记住：

> 如果 source 不包含任何元素，First(IEnumerable) 方法将引发异常。要在源序列为空时返回默认值，请使用 FirstOrDefault 方法。

编辑：

根据 Herve 的评论，上面的代码将返回一个对象而不是 List<>。如果您想改用列表（仅包含一项），请尝试：

```
var meteoQry = (from meteo in db.METEO
                   where meteo.REGION.REGIONID == _id
                   orderby meteo.DATEMETEOBROADCAST descending
                   select meteo).Take(1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:28:01.230

如果您可以在具有以下内容的数据库中创建一个视图，我建议您创建一个视图`vwLatestMeteoDateMetroBroadcast`：

```
Select REGIONID, DATEMETEOBROADCAST
From meteo.REGION
Group By REGIONID 
```

然后，您可以加入`meteo.Region`以`meteo.vwLatestMeteoDateMetroBroadcast`获取最新的

（假设您永远不会有来自同一区域的多行完全相同`DATEMETEOBROADCAST`）

# php - PHP 表单中的大文件上传中断提交

> ID：16156019
> 
> 赞同：0
> 
> 时间：2013-04-22T20:21:42.227
> 
> 标签：php, forms, file-upload

我有一个简单的 PHP 表单，可以通过电子邮件发送一些文本数据和单个文件附件。我相信，只要上传不打破服务器的任何限制，例如大小或执行时间，一切都运行良好。当文件突破这些限制时，浏览器会显示上传 0% - 100% 就好了，但不是提交表单，而是刷新页面，没有发送 POST 数据。

我没有增加任何限制的选项。我正在开发一个项目，我无法通过 php.ini、.htaccess 或 ini_set() 增加上传大小或执行时间的限制。这很好，我可以接受这个特定客户的托管公司给我的限制。

但是，当用户尝试上传超出限制的大文件时，我只需要一种用户友好的方式来提交表单，而不是完全停止执行并且页面刷新没有 POST 数据。在这一点上，我什至无法在提交时向用户显示任何错误，例如“文件必须小于 10MB”，因为当文件太大时表单实际上不会被发布。

如果需要任何澄清，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:02:48.233

显然，如果您的脚本用于将文件作为电子邮件附件发送，那么您的文件确实应该小于 10 个月，因为许多邮件服务器会拒绝较大的电子邮件。

出于安全原因，您无法从浏览器访问有关文件的信息。但是一旦在表单的文件字段中选择了文件，您就可以使用 HTML5 文件 API。[有关完整的演示文稿，请参阅此页面](http://www.html5rocks.com/en/tutorials/file/dndfiles/)。

这是您在提交之前需要处理文件大小的代码部分：

```
<input type="file" id="a_file" name="a_file" />
<script>
  function fileSelect(evt) {
    var file = evt.target.files[0];
    var size_mo = (file.size / (1024 * 1024)).toFixed(3);

    if (size_mo >= 10)
    {
        alert('Your file is too big ('+size_mo+'Mo).');
        // eventually reset the form with window.your_form.reset() to avoid submit
    }
    else
    {
        alert('Your file is ready for upload ('+size_mo+'Mo)');
    }
  }
document.getElementById('a_file').addEventListener('change', fileSelect, false);
</script> 
```

但是，此解决方案将仅支持最新的浏览器，并且与低于 10 的 Internet Explorer 版本不兼容。

没有其他使用 HTML 或 JS 的解决方案。如果您想获得全面支持，您将需要 Flash 或 Java（请记住，还有一些计算机未安装这些技术）。因此，您可以做的最好的事情是使用带有浏览器检测的 HTML5 代码，并且如果您无法读取文件大小并在支持 HTML5 时具有良好的行为，请不要警告用户。

# rest - 从 JavaFX 应用程序使用 RESTFul 服务

> ID：16156024
> 
> 赞同：3
> 
> 时间：2013-04-22T20:21:47.657
> 
> 标签：rest, javafx-2

我试图了解从 JavaFX 应用程序使用部署在 Websphere 上的 RESTFul 服务的最佳方法是什么。我知道的几个选项是：

1.  球衣
2.  高枕无忧
3.  春天3

鉴于 JavaFX 应用程序的消耗，我不确定它们如何适应。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:03:44.203

*API 选择*

以上任何一项都可以正常工作。

JavaFX 对此并没有什么特别之处。

您可以在网上搜索您的候选客户端 rest 客户端 api 的比较，或者只需下载其中一个并开始使用它。

* * *

*实现指针*

您需要做的就是将您选择的 REST 客户端框架的 jar 包含在您的应用程序中，然后为您的 REST 客户端和您正在使用的 RESTful 服务编写文档化的 api 代码。

您可能希望将[DataFX 库](http://www.javafxdata.org/)视为一种从其余 api 检索到的数据到您的 JavaFX 控件的方法。

您列出的大多数库都托管在公共 maven 存储库中，因此您可以使用[JavaFX maven 插件](https://github.com/zonski/javafx-maven-plugin)将它们与您的应用程序捆绑在一起。[使用标准JavaFX 部署工具](http://docs.oracle.com/javafx/2/deployment/jfxpub-deployment.htm)或[NetBeans](https://netbeans.org/kb//docs/java/javafx-setup.html)构建也可以正常工作。

您将希望在后台线程上进行休息调用，因此请查看[JavaFX 并发](http://docs.oracle.com/javafx/2/threads/jfxpub-threads.htm)资源以了解这是如何完成的。

除非您需要独立于平台的数据传输格式和协议，或者您正在使用现有的 rest 服务，否则使用远程方法或对象调用协议与服务器通信（例如[spring remoting](http://www.zenjava.com/2012/02/25/going-remote-javafx-and-spring-remoting/)或[hessian](http://www.zenjava.com/2011/11/03/client-server-with-javafx-2-and-hessian-guice-fxml/)）可能更简单。此类协议通常处理传输错误条件以及将 java 对象编组和解组为传输格式的自动化。使用 REST API，您通常需要自己实现这些功能。

* * *

*示例代码*

查看[Henley Sales 示例](http://www.oracle.com/technetwork/java/javafx/samples/index.html)，其中包括用于生成和使用 rest api 以及在 JavaFX UI 中利用结果数据的客户端和服务器组件。

# java - Android 字符串资源上标

> ID：16156032
> 
> 赞同：3
> 
> 时间：2013-04-22T20:22:11.627
> 
> 标签：java, android, string, subscript, superscript

我有一个字符串资源文件，我想从中提取字符串，并且我希望其中一个字符串包含一些上标。

从[http://developer.android.com/guide/topics/resources/string-resource.html](http://developer.android.com/guide/topics/resources/string-resource.html)看来，支持的标签包括`<b>`、`<i>`和`<u>`。我很好奇它是否应该适用于其他相关标签，例如`<sup>`......如果是这样，那么我的问题就解决了。

测试上面应该很容易，我只是在寻找更深入的理解，看看是否所有的处理都类似于[Android中的下标和上标字符串，](https://stackoverflow.com/questions/3543454/subscript-and-superscript-a-string-in-android)或者从资源字符串文件中提取字符串时是否发生了额外的处理.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-08-10T17:01:24.657

您可以使用 X\u00B2 直接在 xml 中创建 X^2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-28T21:12:07.017

我正在使用这个技巧：在字符串资源中：

```
<string name="text1">x!sup@2!/sup@</string> 
```

然后在活动中：

```
text1.setText(Html.fromHtml(getString(R.string.text1).replace("!", "<").replace("@", ">"))); 
```

这个技巧奏效了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-06T08:01:40.580

`<string name="sup_string"> a<sup><small>n</small></sup> b </string>`

一个^n b

这对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-10T08:27:43.067

# Android String Resource Superscript and Subscript for letters

You can copy and paste any of these Superscripts and Subscripts directly into your Android String Resource.

Example:

```
 <string name="word_with_superscript" translatable="false">Trademark ᵀᴹ&lt;/string> 
```

Result:Trademark ᵀᴹ</p>

**Superscript and Subscript letters**

***Superscript capital*** ᴬ ᴮ ᴰ ᴱ ᴳ ᴴ ᴵ ᴶ ᴷ ᴸ ᴹ ᴺ ᴼ ᴾ ᴿ ᵀ ᵁ ⱽ ᵂ</p>

***Superscript minuscule*** ᵃ ᵇ ᶜ ᵈ ᵉ ᶠ ᵍ ʰ ⁱ ʲ ᵏ ˡ ᵐ ⁿ ᵒ ᵖ ʳ ˢ ᵗ ᵘ ᵛ ʷ ˣ ʸ ᶻ</p>

***Subscript minuscule*** ₐ ₑ ₕ ᵢ ⱼ ₖ ₗ ₘ ₙ ₒ ₚ ᵣ ₛ ₜ ᵤ ᵥ ₓ

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-11T14:41:18.423

你可以像这样逃脱：

```
<string name="acceleration"><![CDATA[%1$f m.s<sup><small>-2</small></sup>]]></string> 
```

# xpath - 使用 XPath 检查 Soap 信封是否包含子节点

> ID：16156037
> 
> 赞同：2
> 
> 时间：2013-04-22T20:22:36.850
> 
> 标签：xpath

我正在尝试确定肥皂信封主体是否包含特定节点。

我正在使用的信封示例：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
    <soapenv:Body>
        <Response>
            <Result>Failure</Result>
            <Error id="40020" value="">An Unkown Error Occured</Error>
        <Response>
    </soapenv:Body>
</soapenv:Envelope> 
```

我想检查是否包含节点“响应”，因此我可以对其执行条件操作。我对 XPath 比较陌生，所以我不确定完整的表达式应该是什么。

我目前拥有的 XPath 表达式是

```
[name(//soapenv:Body/*[1]) = 'Response'] 
```

我知道 name(//soapenv:Body/*[1]) 将返回“响应”的值，我只是不知道如何将该结果与另一个值进行比较并返回真/假。

也许像这样作为另一种表达方式？

```
//soapenv:Body/*[contains(Name, "Response")] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:25:29.657

试试这些：

```
//soapenv:Body/*[name()='Response'] 
```

或者，如果 Response 可以比 Body 的子级更深（不应该是这样）

```
//soapenv:Body/descendant::*[name()='Response'] 
```

# ruby-on-rails-3 - Rspec/Rails 和测试 validates_uniquess_of 与范围

> ID：16156039
> 
> 赞同：2
> 
> 时间：2013-04-22T20:22:39.860
> 
> 标签：ruby-on-rails-3, rspec, tdd, shoulda

这是我的测试代码：

```
require 'spec_helper'

describe Classroom, focus: true do

  let(:user) { build_stubbed(:user) }

  describe "associations" do
    it { should belong_to(:user) }
  end

  describe "validations" do
    it { should validate_presence_of(:user) }
    it { should validate_uniqueness_of(:name).scoped_to(:user_id) }

    context "should create a unique classroom per user" do

      before(:each) do
        @class = build_stubbed(:classroom, name: "Hello World", user: user)
        @class2 = build_stubbed(:classroom, name: "Hello World", user: user)
      end

      it "should not create the second classroom" do
        @class2.should have(1).errors_on(:name)
      end
    end
  end

  describe "instance methods" do

    before(:each) do
      @classroom = build_stubbed(:classroom)
    end

    describe "archive!" do

      context "when a classroom is active" do
        it "should mark classroom as inactive" do
          @classroom.stub(:archive!)
          @classroom.active.eql? false
        end
      end

    end

  end

end 
```

这是我的课堂模型：

```
class Classroom < ActiveRecord::Base
  attr_accessible :user, :name

  belongs_to :user

  validates :user, presence: true
  validates_uniqueness_of :name, scope: :user_id, message: "already exists"

  def archive!
    update_attribute(:active, false)
  end
end 
```

当我运行测试时，我收到以下错误：

```
1) Classroom validations 
     Failure/Error: it { should validate_uniqueness_of(:name).scoped_to(:user_id) }
       Expected errors to include "has already been taken" when name is set to "arbitrary_string", got errors: ["user can't be blank (nil)", "name already exists (\"arbitrary_string\")"]
     # ./spec/models/classroom_spec.rb:13:in `block (3 levels) in <top (required)>'

  2) Classroom validations should create a unique classroom per user should not create the second classroom
     Failure/Error: @classroom2.should have(1).errors_on(:name)
       expected 1 errors on :name, got 0
     # ./spec/models/classroom_spec.rb:24:in `block (4 levels) in <top (required)>' 
```

我对编写测试相当陌生（尤其是使用 using `Rspec`）。只是想找人给我一些关于我做错了什么的建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T08:06:13.943

1.  **第一次验证失败**：
    在您的模型中，您已经覆盖了 rspec 为唯一性验证生成的默认消息。所以在测试这样的验证时，你必须使用shoulda**的 'with_message'**选项。所以测试应该像
    **“it { should validate_uniqueness_of(:name).scoped_to(:user_id) }.with_message('already exists')”**

2.  **第二个验证失败：**
    当您像第二个示例一样自己编写唯一性验证规范时，您必须创建一个已经存在于数据库中的记录并使用类似参数构建第二个记录。那么这个重复记录将无效，并且会出现预期的错误。
    所以在**before(:each) 块中，将第一条 @classroom 记录保存在数据库中，而不是仅仅构建它**

# c++ - 使用 gcc 4.6.1 使用 mex 启用 AVX 指令

> ID：16156042
> 
> 赞同：1
> 
> 时间：2013-04-22T20:22:56.850
> 
> 标签：c++, matlab, optimization, gcc, avx

我想弄乱一些 AVX 内在函数。如果可能的话，我希望 gcc 专门使用 AVX，类似于`/arch:AVX`在 Visual Studio 中。有没有办法在 gcc 和 mex 中做到这一点？

我尝试使用类似的东西：

`mex -g -O $CFLAGS='$CFLAGS -march=corei7-avx' ncorr_alg_rgdic.cpp standard_datatypes.o ncorr_datatypes.o`

但编译器说`eval: 1: = -march=corei7-avx: not found`. 有谁知道我应该使用哪个标志以及如何让 mex 接受它？默认情况下，它似乎正在使用 SSE 指令（查看汇编输出，我看到了一些`mulsd`s），但我不想将 SSE 与 AVX 混合，因为我在[这里](https://stackoverflow.com/questions/7839925/using-avx-cpu-instructions-poor-performance-without-archavx/7841251#7841251)读到它可能会导致问题。

**编辑1：**

我正在使用带有 gcc 4.6.1 的 ubuntu 11.04。

**编辑2：**

编译： `mex CXXOPTIMFLAGS='-mtune=corei7-avx -S' ncorr_alg_rgdic.cpp standard_datatypes.o ncorr_datatypes.o`

产量：

```
movsd   -304(%rbp), %xmm1
movsd   .LC16(%rip), %xmm0
mulsd   %xmm0, %xmm1 
```

编译： `mex CXXOPTIMFLAGS='-mavx -S' ncorr_alg_rgdic.cpp standard_datatypes.o ncorr_datatypes.o` 和`mex CXXOPTIMFLAGS='-march=corei7-avx -S' ncorr_alg_rgdic.cpp standard_datatypes.o ncorr_datatypes.o` 两者都产生：

```
vmovsd  -304(%rbp), %xmm1
vmovsd  .LC16(%rip), %xmm0
vmulsd  %xmm0, %xmm1, %xmm1 
```

现在我很确定`mulsd`是 sse 指令。是`vmulsd`AVX 指令（奇怪的是谷歌搜索它没有产生任何结果）？我也没有看到`ymm`正在使用的寄存器，这很奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:33:31.157

我发现 mex 使用这种格式：

> mex -v CFLAGS='$CFLAGS -Wall' LDFLAGS='$LDFLAGS -w' yprime.c

您应该尝试删除第一个 $ 符号。不过，-mtune=corei7-avx 应该是正确的。

# python - 如何使用 Pyramid 优雅地处理 python 子进程

> ID：16156045
> 
> 赞同：1
> 
> 时间：2013-04-22T20:23:13.877
> 
> 标签：python, subprocess, pyramid

我将一些虚拟代码放在一起，启动一个进程（exist_view），该进程调用一个 shell 脚本，然后循环通过一个状态页面，该页面定期检查进程是否产生了返回码，然后呈现结果。

但是，我得到的结果是子进程锁定客户端上的渲染直到它完成，这使得“客户端的定期状态更新”没有实际意义。我真的需要能够向客户展示事情正在进行中，因为最终项目将运行几个连续的子流程，其中一些可能需要几分钟（这是针对自定义设备，而不是某些网站）。下面的代码片段。有什么建议么？

请注意，我正在使用 Python 2.6.5 和 Pyramid 1.4。

```
@view_config(route_name='waiting', renderer='waiting.mako')
def waiting_view(request, process):
    while process.poll() == None:
        time.sleep(1)
    print str(process.returncode)
    return {}

@view_config(route_name='exist', renderer='exist.mako')
def exist_view(request):
    process = subprocess.Popen(['bash', '-c', './dummy.sh'], stdout=subprocess.PIPE)
    return HTTPFound(request.route_url('waiting', process=process)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:36:33.697

我的幻想在#pyramid IRC 频道中消除了。

tl;dr 是有 3 个选项：

1.  分叉进程而不是使用子进程
2.  使用队列引擎（如 Celery）
3.  使用生成器在结果进入时对其进行解析。

这是聊天记录以供进一步说明：

```
<phira> hewhocutsdown: that's never going to work
<phira> hewhocutsdown: I can see what you're trying to do, but the threading/request system doesn't work like that
* chrisrossi has quit (Ping timeout: 264 seconds)
<hewhocutsdown> hrm... is there another approach I could take, or is that strictly precluded?
<phira> hewhocutsdown: what you want is most likely to use one of the queue engines like celery or gearman to run the process from a pool
<phira> that approach is probably the most normal production approach to take
<phira> if you're after a simpler, quicker hack you have two options. The first is to fork the whole process and have it write to a file or something, that waiting_view can read from to get status
<phira> the second is to use a generator as the return on exist_view and let it feed out the results of the process bit by bit as they arrive, effectively turning it into a long poll
<hewhocutsdown> yeah, I looked at Celery but I don't have enough server control to be able to load it. // the forking idea could be done // what do you mean by a generator?
<hewhocutsdown> and to clarify; the .sh is basically copying and configuring Xen images
<hewhocutsdown> so they're simple scripts but they may take a while to respond
<pdobrogost> graffic: it doesn't need to be stable to be used in trasactions. what you see (or you image you see) is irrelevant here
<phira> ok, in that case I'd go with the forking thing
<phira> the one problem you're gonna have is that you can lose track of the processes (ie you fork one, and forget its there and it zombies or similar), you can deal with this in a variety of ways using process pools but they're not really a pyramid issue
<phira> the key point to remember is that you can't set a variable in one view, and have another view do things with it. Your views are (often) in separate thread contexts and unless you play a very careful game of thread safety they can't talk to each other like that, any info they want to share needs to go through the database or filesystem.
<hewhocutsdown> yeah, I don't have a db, at present it's just filesystem (calling shell scripts/reading return codes/writing text files). I'll take a stab at prototyping the fork method. Just so I know, how would the generator method work?
<phira> with the generator you return aresponse that basically returns the lines as they arrive from the script or similar, slowly (so the request takes ages, basically, but starts feeding out information almost immediately). You can then use xhr on the client side to call that url (once) to start the process and read the results as they happen
<phira> the risk of doing so is that you have no way of restarting it. If the client loses the connection, they cannot re-poll the endpoint because that will start a new process, instead of talk to the old one
<hewhocutsdown> got it. yes, I did something similar before I switched to using return codes.
<phira> there are strategies to get around that, but it's rarely worth the effort.
<hewhocutsdown> alright, I'll look into forking and process pooling.
<hewhocutsdown> thank you
<phira> no problem
<phira> also for what it's worth, this is probably the right place for almost any pyramid related question, the people here know all the things and they're usually around. THat's not always the case for some channels so I figure it's worth saying. 
```

# android - 持久化大数据

> ID：16156049
> 
> 赞同：0
> 
> 时间：2013-04-22T20:23:25.323
> 
> 标签：android

我在我的活动中获得了大量数据，我需要将其保存在配置更改中并重用它以减少网络请求。我正在考虑共享偏好或将数据放入 Bundle。共享偏好似乎是更昂贵的操作，但我不确定。请建议采取哪种方法更好。

是否也可以将数据保存在单独的线程中，如果活动被破坏，它不会停止吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:20:22.177

如果您只关心通过配置更改来持久化数据，那么您不需要在任何地方持久化它。您可以将对数据的引用放在静态变量中。它将适用于所有活动。

但是请注意，如果您的应用程序进入后台并且 Android 终止了该进程，那么数据将会丢失。如果您需要处理这种情况，那么最好将数据放入数据库中。Shared Preferences 适用于简单数据（原始数据、字符串等），但不适用于结构化数据（复杂对象、列表等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:21:04.857

使用您用来从服务器检索数据并将其存储在数据库中的同一线程。如果你没有 - 创建它。

`Activity`由于生命周期问题，我建议不要在里面做线程。扩展`Application`和使用`Activity.getApplication`.

# php - 图像转换时的 ob_start、标题和读取问题

> ID：16156052
> 
> 赞同：0
> 
> 时间：2013-04-22T20:23:32.103
> 
> 标签：php

我正在尝试将图像从 url 转换为 jpg，必要时调整大小并输出。

问题是，生成的图像不可读。

```
 require('SimpleImage.php');

function BildInBLOB($linkadresse)
{
    $maxsize = 65536;   

   ob_start();
   header('Content-Type: image/jpeg');
   $image = new SimpleImage();     
   $image->load($linkadresse);  
  $width = 150;
  $height = 150;
  if ($image->getWidth() > $image->getHeight())
  {    
    $ratio = 150 / $image->getWidth();
    $height = $image->getheight() * $ratio;
  }
  else
  {
    $ratio = 150 / $image->getHeight();
    $width = $image->getWidth() * $ratio;
  }      
  $image->resize($width,$height);  

   $image->output();

   $data = ob_get_contents();
   ob_end_clean();

  $serialized_data = serialize($data);

  $size = strlen($serialized_data);

    if ($size < $maxsize) {
        $imgData  = mysql_escape_string($data);
        return $imgData;        
    }
  else
  {
    return false;
  }
}
header('Content-Type: image/jpeg');
echo BildInBLOB('http://www.example.com/image.png');
die; 
```

如果我删除

```
header('Content-Type: image/jpeg'); 
```

它看起来像普通的 jpeg 代码，但如果我保留它，我将无法打开文件。

这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:32:38.447

从您的代码中删除以下部分：

```
$imgData = mysql_escape_string($data); 
```

那会破坏形象。

# python - 使用 Amazon s3 boto 库，如何获取已保存密钥的 URL？

> ID：16156062
> 
> 赞同：54
> 
> 时间：2013-04-22T20:24:17.217
> 
> 标签：python, amazon-s3, boto

我正在使用以下方法保存存储桶的密钥：

```
 key = bucket.new_key(fileName)
    key.set_contents_from_string(base64.b64decode(data))
    key.set_metadata('Content-Type', 'image/jpeg')
    key.set_acl('public-read') 
```

保存成功后，如何访问新建文件的URL？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2013-04-22T23:20:35.257

如果密钥是公开可读的（如上所示），您可以使用[`Key.generate_url`](http://boto.readthedocs.org/en/latest/ref/s3.html#boto.s3.key.Key.generate_url)：

```
url = key.generate_url(expires_in=0, query_auth=False) 
```

如果密钥是私有的，并且您想生成一个过期 URL 以与没有直接访问权限的人共享内容，您可以执行以下操作：

```
url = key.generate_url(expires_in=300) 
```

其中`expires`是 URL 过期前的秒数。这些将产生 HTTPS 网址。如果您更喜欢 HTTP url，请使用以下命令：

```
url = key.generate_url(expires_in=0, query_auth=False, force_http=True) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2015-10-23T07:43:25.350

对于 Boto3，您需要按照以下方式进行操作...

```
import boto3

s3 = boto3.client('s3')
url = '{}/{}/{}'.format(s3.meta.endpoint_url, bucket, key) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-02-13T21:21:06.950

```
import boto
from boto.s3.connection import S3Connection

conn = S3Connection('AWS_ACCESS_KEY', 'AWS_SECRET_KEY')

secure_https_url = 'https://{host}/{bucket}/{key}'.format(
    host=conn.server_name(),
    bucket='name-of-bucket',
    key='name_of_key')

http_url = 'http://{bucket}.{host}/{key}'.format(
    host=conn.server_name(),
    bucket='name-of-bucket',
    key='name_of_key') 
```

这就是我在 boto 2.23.0 中为公共 URL 所做的。我无法让 expires_in=None 参数起作用。

请注意，对于 HTTPS，您不能使用子域。

# jquery - jquery循环遍历每一行并将两个行值划分为彼此

> ID：16156063
> 
> 赞同：1
> 
> 时间：2013-04-22T20:24:18.570
> 
> 标签：jquery, function

我有一个表，其中包含一些由 jquery 填充的输入。

我想将 jquery 值除以用户输入的数量。

我正在尝试使用下面称为 qtypercheckas 的函数来执行此操作：

```
function qtypercheck(){
     //for each table row 
        // var lineqty= input[name^="product"] divide input[name^="checkedsizes"]
        //set value of input[name^="qtypercheck"]=lineqty    
} 
```

完整的小提琴可以在这里看到[http://jsfiddle.net/emL6x/36/](http://jsfiddle.net/emL6x/36/)

如果我尝试循环遍历表格`$('.authors-list tr').each(function(){`循环不是每行一个，所以不确定。

总而言之，需要`cubespercheck`用结果填充字段`qty`用/`checkedsizes`

一如既往地感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:32:18.540

我会放弃 qtypercheck() 函数，只需在您的 countchecks() 函数中添加一行：

```
function countChecks() {
    $('.authors-list tr').each(function () {
        var count = 0;

        var hdn = $(this).find('input[name^="checkedsizes"]');
        count = $(this).find(':checkbox:checked').length;
        hdn.val(count);
        if(count>0) $(this).find('input[name^="qtypercheck"]').val($('input', this).eq(1).val() / count);
    });
   // qtypercheck();
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/emL6x/37/)**

# jquery - 使用脚本重新加载部分

> ID：16156066
> 
> 赞同：0
> 
> 时间：2013-04-22T20:24:23.087
> 
> 标签：jquery, ruby-on-rails

我正在尝试使用以下内容重新加载一个部分...

```
jQuery('#account_alert').replaceWith("<div id='account_alert'><div class='msg success'>" + data.message + "</div></div>");

jQuery('#subaccount_balances').load("edit #subaccount_balances"); 
```

问题是`.load()`不会从网页加载脚本，所以我的手风琴都展开了，所有的表单链接都被破坏了......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:07:27.400

`.load()`当正在加载的 URL 中有选择器时，不执行脚本。

更改您的`edit`服务器脚本，使其采用名为`section`. 当给出这个值时，它应该只返回 HTML 的那个部分而不是整个页面。然后你可以这样做：

```
jQuery('#subaccount_balances').load("edit?section=subaccount_balances"); 
```

# wordpress - 如何在 Wordpress 中增加最大文件上传？

> ID：16156069
> 
> 赞同：3
> 
> 时间：2013-04-22T20:24:38.013
> 
> 标签：wordpress

我在 php.ini 中设置

```
upload_max_filesize = 64M
post_max_size = 64M 
```

然后尝试 .htaccess 文件

```
php_value  upload_max_filesize  64M
php_value  post_max_size  64M 
```

而在 wp-config.php`define('WP_MEMORY_LIMIT', '64M');`但没有任何帮助。最大上传大小为 32px；

如何在 Wordpress 中增加最大文件上传？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T21:17:07.740

之前在 wp-config.php 之后添加总是对我有用`define('WP_MEMORY_LIMIT', '64M');`。`<?php`对于最新的 wordpress 版本，它不起作用。我不知道它背后的实际原因，但它仍然适用于我去年从未更新过的旧 wordpress 网站。

按照以下步骤获取最新的 Wordpress：

1）把它放在你的 php.ini 的末尾

```
upload_max_filesize = 512M
post_max_size = 512M
max_execution_time = 300 
```

2）重启apache（重启apache后设置生效）

[测试和工作](http://i.imgur.com/gpFQVBb.png)。

> **我也在 wp-admin 方法上**尝试了**.htaccess**和php.ini ，它们也不起作用。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:29:02.390

您可以在 PHP 中尝试：

```
ini_set('post_max_size', 100000); // 10Mo
ini_set('upload_max_filesize', 100000); 
```

但是请注意，对于某些服务器供应商，您无法更改此限制...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T00:07:21.167

我尝试了不同的方式，比如尝试

```
1\. change my limit directly on my server
2\. through the .htaccess file 
3\. wp-config.php 
```

但这些变化都没有对我有用。然后我在某处发现了一篇我在一篇博文中总结的帖子（见下文）

```
All you need to do is 
1\. create a php.ini 
2\. upload to admin directory 
```

如果您想了解更多信息，这里是一个链接[http://ecarobar.com/increase-max-upload-file-size-in-wordpress/](http://ecarobar.com/increase-max-upload-file-size-in-wordpress/)**

# python - 如何在屏幕上打印标准/本机 MySQL 输出？

> ID：16156070
> 
> 赞同：1
> 
> 时间：2013-04-22T20:24:39.730
> 
> 标签：python, mysql, mysql-python

正如标题所说：有没有办法在屏幕上打印标准/本机 MySQL 输出？我说的是，例如这样的：

```
san@pcjq:~$ mysql -uroot -p mysql -t -e "SELECT Host,User FROM user;"
Enter password: 
+-----------+------------------+
| Host      | User             |
+-----------+------------------+
| %         | slvUser          |
| 127.0.0.1 | root             |
| localhost | debian-sys-maint |
| localhost | root             |
| localhost | sant00           |
+-----------+------------------+ 
```

我正在使用`MySQLdb`和打印`fetchall()`根本不这样做。

```
In [11]: cur.execute("SELECT Host,User FROM user")
Out[11]: 5L

In [12]: print cur.fetchall()
(('%', 'slvUser'), ('127.0.0.1', 'root'), ('localhost', 'debian-sys-maint'), ('localhost', 'root'), ('localhost', 'sant00')) 
```

任何人都知道如何做到这一点，或者是否有可能？干杯！！

# ubuntu - 如何检查 Apache2 是否在 Ubuntu 中停止？

> ID：16156079
> 
> 赞同：25
> 
> 时间：2013-04-22T20:25:20.713
> 
> 标签：ubuntu, process, apache2

我想确保 apache2 服务已停止。

```
1\. I need to verify if apache2 is installed or not. 
```

当我输入：

```
sudo /etc/init.d/apache2 stop 
```

我有：

```
sudo: /etc/init.d/apache2: command not found 
```

这是否意味着没有安装apache2？还是安装在其他地方？

```
2\. check apache2 process: 
```

当我输入：

```
ps a | grep apache2 
```

我有：

```
10448 pts/4    S+     0:00 grep --color=auto apache2 
```

这是否意味着apache2正在运行？

```
3\. http://localhost test 
```

我有：

```
Google Chrome could not connect to localhost 
```

如何验证 Apache2 是否已停止？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-04-22T20:27:54.767

在命令行类型中`service apache2 status`，然后按回车键。结果应该说：

> Apache2 正在运行 (pid xxxx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-22T20:31:47.940

您还可以键入“top”并查看正在运行的进程列表。

# javascript - 获取 Angular 中所选选项的 $index

> ID：16156086
> 
> 赞同：5
> 
> 时间：2013-04-22T20:25:57.967
> 
> 标签：javascript, angularjs

例如：

```
<select ng-model="selectedCategory" ng-options="category as category.title for category in categories"></select> 
```

显然，这是行不通的：

```
<button ng-click="removeCategory($index)">remove</button> 
```

如果不在中继器中，如何访问 $index？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T20:45:07.517

您不需要跟踪索引，只需从 removeCategory 函数中的类别模型中删除 selectedCategory ：

你的控制器可能看起来像这样**[JSFiddle](http://jsfiddle.net/Riffic/BXHmM/)**：

```
app.controller("myCtrl", ['$scope', function($scope){
  $scope.model = {
    selectedCategory: {},
    categories: [
        {title: "Cat1"},
        {title: "Cat2"}
    ]
  }
  //init
  $scope.model.selectedCategory = $scope.model.categories[0];

  $scope.removeCategory = function(){
    var ind = $scope.model.categories.indexOf( $scope.model.selectedCategory );
    $scope.model.categories.splice( ind, 1 );
    $scope.model.selectedCategory = $scope.model.categories[0];
  }
}]) 
```

# asp.net-web-api - 如何将 Asp.Net web api 部署到虚拟机上的 IIS？

> ID：16156087
> 
> 赞同：2
> 
> 时间：2013-04-22T20:26:02.050
> 
> 标签：asp.net-web-api

我在 Mac OSX Lion 上托管的 VMWare Fusion 5 虚拟机上运行 Windows 7 Prof

1.  使用 VS2012 Express for Web 通过 File New 项目创建了一个新的 ASP.Net MVC4 WebAPI 项目
2.  点击 F5，默认网页显示在浏览器中
3.  在 IIS 上创建一个名为 MyApi 的新网站，侦听端口 90 并将其绑定到 C:\MyApi
4.  右键单击 VS2012 中的项目并使用发布选项选择上面创建的网站
5.  当我导航到`http://localhost:90/`而不是默认网页（从步骤 1 开始）时，我收到 403.14 目录列表禁止错误。
6.  新网站配置为在配置为以我的登录帐户运行的 MyApi 应用程序池下运行。

我错过了什么？如何让 MyAPI 启动并运行。

我想将它托管在 Win 7 上的 IIS 中，这样我就可以从我的 iPhone 上运行的应用程序调用 web 服务。

任何帮助高度赞赏

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T23:32:49.163

这个问题的答案解决了我的问题

[在 IIS 7.5 中托管的 Web Api 中找不到 HTTP 404 页面](https://stackoverflow.com/questions/9703090/mvc-4-web-api-iis7-5-http-404-page-not-found)

```
<system.webServer>
    .....
    <modules runAllManagedModulesForAllRequests="true" />
    .....
</system.webServer> 
```

# javascript - 如何使用单选按钮值设置复选框选择的限制

> ID：16156088
> 
> 赞同：0
> 
> 时间：2013-04-22T20:26:03.143
> 
> 标签：javascript, jquery, html

我有一组单选按钮：

```
<input type="radio" name="attending_days" value="06-18-13"/>Tuesday June 18, 2013
<input type="radio" name="attending_days" value="06-18-13"/>Wednesday June 19, 2013
<input type="radio" name="attending_days" value="both_days"/>Both days 
```

复选框：

```
<div id="checkboxes">
<input type="checkbox" name="checkboxes" value ="1"/>One<br />
<input type="checkbox" name="checkboxes" value ="2"/>Two <br />
<input type="checkbox" name="checkboxes" value ="3"/>Three 
```

所以，20个这样的复选框。

根据选择的单选按钮值，我想限制我的复选框。

例如，对于选项一或两个，只能选择 4 个（共 20 个）复选框，并且两天（单选 3）可以选择八个复选框。

我不知道如何解决这个问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:55:38.283

演示：http: [//jsfiddle.net/terryyounghk/xLCzp/](http://jsfiddle.net/terryyounghk/xLCzp/)

```
$('input[name=checkboxes]').on('click', function () {
    var lastOneChecked = $('input[name=attending_days]:last:checked').length,
        iLimit = lastOneChecked ? 8 : 4,
        iChecked = $('input[name=checkboxes]:checked').length;

    if (iChecked > iLimit) {
       return false;
    }

    return true; // added so that anonymous function always returns something
});

$('input[name=attending_days]').on('click', function () {
    $('input[name=checkboxes]').prop('checked', false);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:36:07.177

一个例子是使用`classes`. 你给每个`radio button`和它`checkboxes`的一个类。

```
<input type="radio" class='both' name="attending_days" value="both_days"/>Both days 
```

和复选框：（请注意，复选框已**禁用**）

```
<input type="checkbox" class='both' name="checkboxes" value ="1" disabled/>One
<input type="checkbox" class='both' name="checkboxes" value ="2" disabled/>Two 
```

然后是 JS

```
$('input[type="radio"]').click(function(){
   if($(this).is(':checked')){
     var class = $(this).attr('class');
     $('input[type="checkbox"]').prop('disabled', true); 
     $('.'+class).prop('disabled', false);
   }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:01:26.387

您可以创建 Id 或值的全局查找表。

```
var lookup = {}; 

lookup['rdo1'] = ['rdo2','rdo3','rdo4']; 
lookup['rdo2'] = ['rdo5','rdo6','rdo7'];
...and so on... 
```

然后，当单击单选按钮时，在处理程序中

```
// grabs all of the ids from the lookup
var ids = lookup[$(this).attr('id').toString()]

for (var i = 0; i < ids.length; i++) {
    $('#' + ids[i].toString()).addClass('enabledCss');
}
// then loop through the rest of the table and set all of their classes to 'disabledCss' or whatever. 
```

您可以采取的另一条路线是将依赖 ID 存储在`data-*`属性中并从那里获取它们。

```
<input type="radio" data-dependents="2,3,4,5".../> 
```

然后，您可以使用 `var idStr= $(this).attr('data-dependents');` Replace all spaces 将它们拉出并将它们拆分为一个数组，然后使用该数组适当地启用/禁用。变量`myArr = idStr.split(idStr.replace(' ',''),',');`

这段代码必须扩展到你所有的可能性，但这是要点。这`data-*`可能是最简洁的方式。

*注意*这是粗略的、未经测试的代码。我只是想让你指出正确的方向。你必须充分充实它，因为其余的基本上是重复我已经多次展示的内容。

# c++ - 如何在 C/C++ 代码中使用 HTMLElement 类

> ID：16156089
> 
> 赞同：0
> 
> 时间：2013-04-22T20:26:03.940
> 
> 标签：c++, html, c, com, mshtml

我们一直在使用 IHTMLElement 和 IHTMLElement2 脚本接口来访问 Web 对象及其属性。现在我们处于一种情况，想知道元素占用的客户区域，减去边框和滚动条占用的任何区域。我遇到了具有方法 ClientRectangle() 的 HTMLDocument 类。它的文档听起来与我们正在查看的非常相似。如果可能的话，我真的不确定如何访问此方法。

谁能告诉我是否可以创建这个 HTMLDocument 类的实例并访问它的方法？

链接到我正在谈论的课程的 MSDN 文档。 [http://msdn.microsoft.com/en-us/library/system.windows.forms.htmlelement.clientrectangle.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmlelement.clientrectangle.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T23:09:48.693

由于您的问题有点宽泛，我提供的解决方案有点大但完整且经过测试。如果您已经有一个指向有效 IHTMLDocument 或 IHTMLElement 对象的指针，您可以很容易地检索元素的位置和尺寸。获取尺寸的唯一要求是文档必须附加到 IHTMLWindow / IWebBrowser 对象。我已经包含了一个支持函数，它创建 IWebBrowser 和 IHTMLDocument 对象以进行测试。

我已经包含了一些评论，以帮助您一路走来。这是在带有 Internet Explorer 9 的 Windows 7 系统上使用 Visual Studio 2010 测试的。这是我从示例中得到的结果集：

> 矩形 = x=8 y=89 宽度=992 高度=31
> 
> 内容=你好

```
#include <comutil.h>    // _bstr_t
#include <mshtml.h>     // IHTMLDocument and IHTMLElement
#include <exdisp.h>     // IWebBrowser2
#include <atlbase.h>    // CComPtr
#include <string>
#include <iostream>

// Make sure we link in the support library!
#pragma comment(lib, "comsuppw.lib")

static const std::wstring
    exampleHtml(L"<body><html><br><br><p id=\"someid\">hello</p></body>");

HRESULT CreateBrowserDocument(
    const std::wstring& html,
    CComPtr<IWebBrowser2>& returnBrowser,
    CComPtr<IHTMLDocument3>& returnDoc);

int main()
{
    ///////////////////////////////////////////////////////////////////////////
    // In order to get the position and dimension of an element we need to
    // have a browser object that owns the document we will work on. If you
    // create and use a IHTMLDocument object through CoCreateInstance it does
    // not have any rendering capabilities by default.
    ///////////////////////////////////////////////////////////////////////////
    HRESULT hr;

    hr = CoInitialize(NULL);
    if(SUCCEEDED(hr))
    {
        // Make sure these two items are scoped so CoUninitialize doesn't gump
        // us up.
        CComPtr<IWebBrowser2> browser;
        CComPtr<IHTMLDocument3> document;

        hr = CreateBrowserDocument(exampleHtml, browser, document);

        if(SUCCEEDED(hr))
        {
            CComPtr<IHTMLElement> element;

            ///////////////////////////////////////////////////////////////////
            // We grab the element by id to make the example easier. in some
            // cases you may need to iterate through all of the elements of the
            // document or parent element to find the one you want the
            // dimensions for.
            ///////////////////////////////////////////////////////////////////

            hr = document->getElementById(_bstr_t(L"someid"), &element);
            if(SUCCEEDED(hr) && element != NULL)
            {
                ///////////////////////////////////////////////////////////////
                // Now that we have the browser object, document object and the
                // element we want to get the dimensions for .... do it the
                // easy way.
                ///////////////////////////////////////////////////////////////
                _bstr_t contents;
                long left, top, width, height;

                // I skip the error checking here. Add it when you implement
                // your solution.
                hr = element->get_innerHTML(contents.GetAddress());
                hr = element->get_offsetLeft(&left);
                hr = element->get_offsetTop(&top);
                hr = element->get_offsetWidth(&width);
                hr = element->get_offsetHeight(&height);

                std::cout
                    << "Rect = "
                    << "x=" << left << " "
                    << "y=" << top << "  "
                    << "width=" << width << " "
                    << "height=" << height << std::endl
                    << "contents=" << contents << std::endl;
            }
        }
    }

    CoUninitialize();

    return 0;
}

// Here we create web browser and document objects. The additional browser
// object is required for layout management. I have taken a shortcut here and
// create an instance Internet Explorer instead. This allows the browser to
// create and initializes a HTMLDocument when we call IWebBrowser::Navigate.
HRESULT CreateBrowserDocument(
    const std::wstring& html,
    CComPtr<IWebBrowser2>& returnBrowser,
    CComPtr<IHTMLDocument3>& returnDoc)
{
    CComPtr<IHTMLDocument2> document;
    CComPtr<IWebBrowser2> browser;
    HRESULT hr;

    hr = CoCreateInstance(
        CLSID_InternetExplorer,
        NULL,
        CLSCTX_SERVER,
        IID_IWebBrowser2,
        reinterpret_cast<void**>(&browser));
    if(SUCCEEDED(hr))
    {
        // The browser does not contain a document by default. We can force
        // one though by navigating to the `about` page. This is fast and
        // does not require an internet connection.
        VARIANT empty;

        VariantInit(&empty);

        hr = browser->Navigate(
            _bstr_t(L"about:"), &empty, &empty, &empty, &empty);

        //  Wait for the load.
        if(SUCCEEDED(hr))
        {
            READYSTATE state;

            while(SUCCEEDED(hr = browser->get_ReadyState(&state)))
            {
                if(state == READYSTATE_COMPLETE) break;
            }
        }

        // The browser now has a document object. Grab it.
        if(SUCCEEDED(hr))
        {
            CComPtr<IDispatch> dispatch;

            hr = browser->get_Document(&dispatch);
            if(SUCCEEDED(hr) && dispatch != NULL)
            {
                hr = dispatch.QueryInterface<IHTMLDocument2>(&document);
            }
            else
            {
                hr = E_FAIL;
            }
        }
    }

    if(SUCCEEDED(hr))
    {
        // Since the about page is empty we can just write out our test HTML
        // directly to the document. Takes some effort since we need to
        // use a safe array to send it to the document.
        SAFEARRAY *pString = SafeArrayCreateVector(VT_VARIANT, 0, 1);
        if (pString != NULL)
        {
            VARIANT *param;

            hr = SafeArrayAccessData(pString, reinterpret_cast<void**>(&param));
            if(SUCCEEDED(hr))
            {
                const _bstr_t htmlString(SysAllocString(html.c_str()));

                param->vt = VT_BSTR;
                param->bstrVal = htmlString;

                hr = SafeArrayUnaccessData(pString);
                if(SUCCEEDED(hr))
                {
                    hr = document->write(pString);
                    document->close();
                }
            }

            SafeArrayDestroy(pString);
        }

        //  Set the return values
        if(SUCCEEDED(hr) && document != NULL && browser != NULL)
        {
            CComPtr<IHTMLDocument3> temp;
            hr = document.QueryInterface<IHTMLDocument3>(&temp);
            if(SUCCEEDED(hr) && temp != NULL)
            {
                document = temp;
            }
            else 
            {
                hr = E_FAIL;
            }

            CComPtr<IHTMLDocument3> tempDoc;
            if(SUCCEEDED(hr))
            {
                hr = document.QueryInterface<IHTMLDocument3>(&tempDoc);
            }

            if(SUCCEEDED(hr) && tempDoc != NULL)
            {
                returnDoc = tempDoc;
                returnBrowser = browser;
            }
        }
        else if(!FAILED(hr))
        {
            hr = E_FAIL;
        }
    }

    return hr;
} 
```

[**编辑1**：删除不必要的调用`IWebBrowser::put_RegisterAsBrowser`]

[**编辑 2**：通过使用`IHTMLElement::get_OffsetXXX`而不是简化获取尺寸`IHTMLElement::get_clientXXX`]

# xcode - dyld：库未加载：/System/Library/Frameworks/Social.framework/Social

> ID：16156091
> 
> 赞同：5
> 
> 时间：2013-04-22T20:26:09.380
> 
> 标签：xcode, execution, dyld

当应用程序在模拟器上运行时，我遇到以下执行问题：

```
dyld: Library not loaded: /System/Library/Frameworks/Social.framework/Social
Referenced from: /Users/Development1/Library/Application Support/iPhoneSimulator/4.3.2/Applications/730C5B6A-130C-471D-B8C8-CE119B06ACF5/Emisora Atlantico.app/Emisora Atlantico
Reason: image not found 
```

有谁知道如何修理它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-22T21:11:29.820

该`Social`框架是在 iOS 6.0 中添加的。您不能在 iOS 4.3 或 5.x 下使用它。您需要适当的运行时检查，以确保当您在 6.0 之前的 iOS 设备（或模拟器）上运行时，您不会尝试访问框架中的任何类。

您还需要将社交框架弱链接到您的项目。

有关执行正确运行时检查的完整详细信息，请参阅[SDK 兼容性指南。](https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/cross_development/Introduction/Introduction.html#//apple_ref/doc/uid/10000163i)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-28T09:55:44.790

除了[rmaddy 提供的答案之外](https://stackoverflow.com/a/16156802/377384)，一个快速的解决方案可能是在 XCode 中目标设置的**构建阶段选项卡中将库从****必需**更改为**可选。**

 *** * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-09-24T06:06:36.317

**Xcode 11 + 加密套件**

我在这里遇到了与 iOS 13 可用的新`CryptKit`框架相同的问题。在我的情况下，我需要弱链接整个框架，如此处所述以解决问题：[https ://developer.apple.com/library/archive/文档/MacOSX/Conceptual/BPFrameworks/Concepts/WeakLinking.html](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Concepts/WeakLinking.html)**

# php - 使用 Mysql 数据库中的 Javascript 旋转文本

> ID：16156092
> 
> 赞同：0
> 
> 时间：2013-04-22T20:26:18.567
> 
> 标签：php, javascript, mysql

我正在尝试每 5 秒旋转一次表格单元格中的文本。但我需要从 mysql 数据库中获取数据。这是我拥有的使用 html 字幕的当前代码。（代码在 php 中）。

```
echo "<marquee behavior=\Slide\" scrollamount=\"3\" direction=\"left\"height=\"100px\">";  
echo "<a href=\"".$root."Index.php?page=diary\"><table><tr><td ><h2>--Upcoming Events--</h2></td></tr></table></a>";
echo "<table width=\"50px\"><tr><td></td></tr></table>";
for($count = 0; $count < $num_rows; $count++)
{
    $row = mysql_fetch_array($result);
    echo "<a href=\"".$root."Index.php?page=diary\"><table class=\"footer-inner\"><tr><td><p2>Event: ".$row['Title']."</p2></td><td width=\"10px\"></td>";
    echo "<td><p2>Date: ".$row['Date']."</p2></td></tr>";
    echo "<tr> <td><p2>Start Time: ".$row['Start Time']."</p2></td><td width=\"10px\"></td>";
    echo "<td rowspan=\"3\"><p2>Details: ".$row['Text']."</p2></td></tr>";
    echo "<tr><td><p2>End Time: ".$row['End Time']."</p2></td></tr>";
    echo "<tr><td><p2>Location: ".$row['Location']."</p2></td></tr></table></a>";
    echo "<table width=\"50px\"><tr><td></td></tr></table>";
}
echo "</marquee>"; 
```

我一直在对此进行一些研究，并且我发现了如何每 x 秒旋转一次文本，代码如下：

```
<html>
<head>
<title>Rotating Text</title>
<script type="text/javascript">
var rotatingTextElement;
var rotatingText = new Array();
var ctr = 0;

function initRotateText() {
rotatingTextElement = document.getElementById("textToChange");
rotatingText[0] = rotatingTextElement.innerHTML; // store the content that's already on the page
rotatingText[1] = "Ten Reason to Buy Gumballs";
rotatingText[2] = "White House bla bla";
setInterval(rotateText, 5000);
}
function rotateText() {
ctr++;
if(ctr >= rotatingText.length) {
ctr = 0;
}
rotatingTextElement.innerHTML = rotatingText[ctr];
}
window.onload = initRotateText;
</script>
</head>
<body>
<span id="textToChange">New Release... Leopard</span>
</body>
</html> 
```

但是正如你所看到的那样，这是一行，是的，我可以为表中的每个值都这样做，我对此很满意。但是我如何从 mysql 数据库中获取我想要的并将其插入到数组中呢？

我使用 php 作为页面，我可以使用 php 获取我需要的所有信息，只需将其更改为 java 脚本格式。

- - -编辑 - - -

是否可以在同一段代码中将 php 数组转换为 javascript 数组？

例如

```
var rotatingText = Arrayfuction('{php tag} echo $phparray; {php tag}'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:36:22.883

在这里，检查一下：

[http://jsfiddle.net/WJk8Q/3/](http://jsfiddle.net/WJk8Q/3/)

我认为您的 php 代码将与此类似：

```
for($count = 0; $count < $num_rows; $count++)
{
    texts.push( ".$row['Text'].");  
} 
```

# javascript - 从嵌入的视频录制音频

> ID：16156096
> 
> 赞同：0
> 
> 时间：2013-04-22T20:26:31.770
> 
> 标签：javascript, html, webrtc, web-audio-api

我喜欢使用音频上下文分析器来接收网页的组合音频输出并进行处理。我有一个嵌入的 youtube 视频和一个同时运行的音轨，并且喜欢使用分析功能来可视化组合的音频。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T01:24:55.390

还没有，没有。这还不可能。至少在某些情况下会是这样，但它今天不起作用。

# html - 我想实现从 MP3 音频数据到 Web 的流式传输

> ID：16156097
> 
> 赞同：2
> 
> 时间：2013-04-22T20:26:41.597
> 
> 标签：html, node.js, streaming, webkitaudiocontext

My Client Web（HTML5实现）从Web服务器（Node.js实现）获取MP3音频数据，音频数据有16位PCM编码数据和通用二进制数据两种。

即使我遵循了一些示例和解释，我也无法解决我遇到的问题。

现在我想知道如何播放这个你能指导我为什么我在方法'context.decodeAudioData'中得到一个错误吗？

提前谢谢你的帮助。祝你好运！~

```
 ----   html5 source code ----

<!DOCTYPE html>
<html lang="en" manifest="web.appcache">
<head>
<meta charset="utf-8" />
<title>index.html</title>
<script src="sounds/ufo.js"></script>
<script src="js/base64-binary.js"></script>
    <!-- base64-binary.js : https://github.com/alexgibson/offlinewebaudio/blob/master/js/base64-binary.js-->
      <script type="text/javascript">
            var context = new webkitAudioContext();
            var ws = new WebSocket("ws://localhost:8080");
            ws.binaryType = 'arraybuffer';
            ws.onmessage = function (evt) {
                 var byteArray = Base64Binary.decodeArrayBuffer(evt.data);
                context.decodeAudioData( byteArray, function(buffer) {
                            console.log("Success");
                            var src = context.createBufferSource();
                            src.buffer = buffer;
                            src.connect(context.destination);
                            src.noteOn(0);  //play immediately
                            console.log('Finished decoding');

                        },   function(error) {
                            console.log("Error");
                        }
                );
            };
            <script>
</body>
</html>

                    ----Node.js source code ----

    var net = require('net');
    var http = require('http');
    var fs = require('fs');

var server = http.createServer( function(req, res){
    fs.readFile('index.html', function (error, data) {
        res.writeHead(200, { 'Content-Type': 'text/html' });
        res.end(data);
    });  
}); server.listen("8888", "127.0.0.1");

    var WebSocketServer = require('ws').Server;
    wss = new WebSocketServer({port: 8080});

    wss.on('connection', function(ws) {
        console.log("웹서버에 연결됨..");
        var readStream = fs.createReadStream("1.mp3",
            {'flags': 'r',
                'encoding': 'binary',
                'mode': 0666,
                'bufferSize': 64 * 1024});

        readStream.on('data', function(data) {        
            ws.send(data,{binary: true ,mask: false } );
        });
    }); 
```

# powershell - 以编程方式将 Visual Studio 2012 连接到 TFS 2012

> ID：16156101
> 
> 赞同：3
> 
> 时间：2013-04-22T20:26:59.553
> 
> 标签：powershell, visual-studio-2012, tfs, automation

我正在构建一个基本的开发人员机器映像，这样当新的开发人员加入团队时，我们可以为开发人员提供一台安装和配置了所有工具的机器。

我正在尝试设计一种通过 PowerShell 脚本或命令行批处理文件将 Visual Studio 连接到 TFS 的方法，以便 Visual Studio 将使用开发人员的凭据连接到 TFS 服务器。

我知道新开发人员可以打开 Visual Studio，打开`Team`菜单，选择`connect to team foundation server...`Add a Server to the `Servers...`dialog，然后选择`Team Projects`并单击`Connect`。然而，这整个过程是我想自动化的过程。

我不是在寻找这样做的代码，尽管它会被接受。相反，我正在寻找有关在何处找到 Visual Studio 的 API 调用以修改此类设置的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-22T17:15:58.490

您可以使用以下代码来执行此操作：

```
# Add servers to vs 2012
Add-Type -AssemblyName 'Microsoft.TeamFoundation.Client, Version=11.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'

function Add-Collection([string]$url) {
    $uri = New-Object Uri($url)
    $ttpc = New-Object Microsoft.TeamFoundation.Client.TfsTeamProjectCollection($uri)
    $projs = [Microsoft.TeamFoundation.Client.RegisteredTfsConnections]::RegisterProjectCollection($ttpc)
}

Add-Collection -url 'http://mytfsserver:8080/tfs/DefaultCollection' 
```

**注意：**如果您同时安装了 VS 2010 和 2012，这只会将注册添加到 2012。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T06:32:18.767

也许[这篇文章](http://social.msdn.microsoft.com/Forums/en-US/tfspowertools/thread/f796a935-9760-4590-9335-9213be764f2f)可以帮助你找到答案。否则你可以用`command prompt and`tf.exe`试试

> C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE

# jquery - 将 jQuery 转换为 Angular 需要帮助

> ID：16156102
> 
> 赞同：-2
> 
> 时间：2013-04-22T20:27:00.520
> 
> 标签：jquery, angularjs, angularjs-scope

我们有一个使用以下代码通过 jQuery ajax 填充的表：

```
$.ajax({
    type:  "POST",
    cache: false,
    url:   "/files/event_lister.php", // script that gets data from
                                      // DB and responds with JSON sample shown below
    data:  input_data,
    dataType: "json",
    success: function(data) {
        var html = "";
        $.each(data["events"], function(id, event) {
            course_url = "/courses/" + group_titles[event["ProgramGroup"]] + 
                         "/" + url_titles[event["ProgramCode"]] + "/" +
                         event["EventCode"] ;
            html += "<tr>" +
            "          <td>" + event["Course_Type"] + "</td>" +
            "          <td>" + event["FormalDate"] + "</td>" +
            "          <td>" + event_lookup[event["ProgramCode"]] + "</td>" +
            "          <td>" + (parseInt(event["Price"]) > 0 ? "$" + parseInt(event["Price"]) : "&nbsp;") + "</td>" +
            "          <td class="nb">" +
            "            <a href=\"" + course_url + "\">Details</a>" +
            "        </td>" +
            "      </tr>";
        });
        if (html ==  "") {
            html="<tr><td colspan=5 class="fullspan"><p>No Results to display.</p></td></tr>";
        }
        $("#events_tbody").html(html); // #events_body is tbody of table
    }
}); 
```

我正在尝试修改此小提琴中的示例代码以使用我的数据：

[http://jsfiddle.net/SAWsA/11/](http://jsfiddle.net/SAWsA/11/)

[http://jsfiddle.net/Mrbaseball34/aEypQ/](http://jsfiddle.net/Mrbaseball34/aEypQ/)

上面列出的第二个小提琴中有 JSON 数据...

```
<table class="table table-striped table-condensed table-hover">
    <thead>
    <tr>
        <th class="lb">Location<a ng-click="sort_by('Course_Type')"><i class="icon-sort"></i></a></th>
        <th width="75px">Date<a ng-click="sort_by('FormalDate')"><i class="icon-sort"></i></a></th>
        <th>Program<a ng-click="sort_by('Program')"><i class="icon-sort"></i></a></th>
        <th>Cost</th>
        <th>Information</th>
    </tr>
    </thead>
    <tfoot>
    <td colspan="6">
        <div class="pagination pull-right">
            <ul>
                <li ng-class="{disabled: currentPage == 0}">
                    <a href ng-click="prevPage()">« Prev</a>
                </li>
                <li ng-repeat="n in range(pagedItems.length)"
                    ng-class="{active: n == currentPage}"
                    ng-click="setPage()">
                    <a href ng-bind="n + 1">1</a>
                </li>
                <li ng-class="{disabled: currentPage == pagedItems.length - 1}">
                    <a href ng-click="nextPage()">Next »</a>
                </li>
            </ul>
        </div>
    </td>
    </tfoot>
    <tbody>
    <tr ng-repeat="item in pagedItems[currentPage] | orderBy:sortingOrder:reverse">
        <td>{{item.Course_Type}}</td>
        <td>{{item.FormalDate}}</td>
        <td>{{item.Program}}</td>
        <td>{{item.Price}}</td>
        <td>{{item.Info}}</td>
    </tr>
    </tbody>
</table> 
```

数据不可编辑，因此双向不是问题。我们只填写表格，用户点击 course_url 链接将课程添加到我们的购物车。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:31:30.950

这是一个工作的[plunker](http://plnkr.co/edit/hB1yzCr16RAyDCdZwRKx?p=preview)，但搜索还没有工作，你可以自己修复它。
希望这有帮助。

# c# - 如何使列大小适合窗口大小？

> ID：16156103
> 
> 赞同：0
> 
> 时间：2013-04-22T20:27:02.457
> 
> 标签：c#, winforms, listview

如何使列表视图的列范围适合当前窗口大小。这样它会在最大化窗口模式下伸展吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T23:44:40.447

无论您如何要求，ListView 仅支持两种自动调整列大小的方式：按列内容的长度，或按列*标题*内容的长度。

由于这显然不是您想要的，因此您需要自己编写代码来执行此操作。为此，请将处理程序方法附加到表单的[`ResizeEnd`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.resizeend.aspx)事件。只要用户或通过代码以编程方式调整表单的大小，就会引发该事件。据推测，您已经在 ListView 控件上使用了`Anchor`和/或`Dock`属性，以确保它可以根据其父窗体调整大小，因此这应该涵盖所有情况。

在该事件处理程序方法中，您将计算每列的新大小并相应地调整 ListView 控件。这是唯一困难的部分，确定要用于列大小调整的算法。

如果您有这样的 ListView：

```
| Order # | Customer Name | Phone Number | Status |
|---------|---------------|--------------|--------|
|         |               |              |        | 
```

您可能决定希望“订单号”和“状态”列的宽度相同且最窄（因为它们要显示的信息量最少）。“客户姓名”需要最长（因为它要显示的信息量最多），“电话号码”可以在中间的某个位置。

因此，您所要做的就是根据 ListView 控件的总可用宽度按比例调整每列的大小，您可以通过查询其[`ClientSize`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.clientsize.aspx)属性来检索它；例如，

```
float totalWidth = myListView.ClientSize.Width; 
```

您将[在此处](http://nickstips.wordpress.com/2010/11/10/c-listview-dynamically-sizing-columns-to-fill-whole-control/)找到此方法的一个非常优雅且可重用的演示。

# tsql - 从单独 TABLE 上的 SELECT 查询更新单独 TABLE 中的字段

> ID：16156104
> 
> 赞同：1
> 
> 时间：2013-04-22T20:27:06.003
> 
> 标签：tsql, sql-server-2012

我有一个查询，提供当月供应商的库存美元。我有一个`Inventory_Summary`保存历史数据的表。我希望查询能够更新`Inventory_Summary`表中最新月份的数据。这是用于提取需要进入`Inventory_Summary`表的库存数据的查询。

```
SELECT 
    Vendor,
    SUM(Cost*QOH) AS InvDlr
FROM
    dbo.Inventory
WHERE
    Division NOT IN ('9999')
AND
    Class NOT IN ('5500')
AND
    Vendor IN ('AA','BB','CC','DD','EE')
GROUP BY
    Vendor 
```

我需要这个结果集进入的表结构如下：

```
Inventory_Summary

Vendor
Vendor_Name
MonthNum
Year
InvDlr 
```

如何每天更新当月的最新数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:45:42.017

从一张`UPDATE`桌子到另一张桌子相当简单，使用以下模式`UPDATE Table SET fields FROM Joined Tables`：

```
UPDATE S
SET S.InvDlr = I.InvDlr
FROM (SELECT 
          Vendor,
          SUM(Cost*QOH) AS InvDlr
      FROM
          dbo.Inventory
      WHERE
          Division NOT IN ('9999')
      AND
          Class NOT IN ('5500')
      AND
          Vendor IN ('AA','BB','CC','DD','EE')
      GROUP BY
          Vendor) I
JOIN Inventory_Summary S on I.Vendor = S.Vendor
WHERE S.MonthNum = MONTH(GETDATE())
  AND S.Year = YEAR(GETDATE()) 
```

在此示例中，我只是删除了`SELECT`您在子查询中提供的内容，并为其赋予了别名`I`. 然后这`Inventory_Summary`由`Vendor`字段连接。最后，将该`InvDlr`字段设置为子查询中的金额。此外，该`Inventory_Summary`表仅针对当前月份和年份进行过滤。

演示：[http](http://www.sqlfiddle.com/#!3/2e663/1) ://www.sqlfiddle.com/#!3/2e663/ 1（我离开`Division`了`Class`字段，但这不应该影响演示）。

# c - 为指向结构数组的指针分配内存

> ID：16156105
> 
> 赞同：-1
> 
> 时间：2013-04-22T20:27:10.880
> 
> 标签：c, file, structure

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "queue.h"
#include "stack.h"

#define RECORDS_SIZE 100
#define NAME_SIZE    20

typedef struct Student
{
    char nameStudent[NAME_SIZE];
    int  TimeIn;
    int  TimeUpdate;
}STUDENT;

typedef struct TUTOR
{
    char nameTutor[NAME_SIZE];
    int TutorTIme;
    STUDENT *ptr;
}TUTOR;

QUEUE *queue1;
STACK *stack1;

void getData(STUDENT *studentArr[RECORDS_SIZE]);

int main (void)
{

    STUDENT *studentArr[RECORDS_SIZE];
    FILE *fp = NULL;

    getData(studentArr);

    return 0;
} 

void getData(STUDENT *studentArr[RECORDS_SIZE])
{
    FILE *fp;
    char fileName[NAME_SIZE];
    char buffer[RECORDS_SIZE];
    int count = 0;

    printf("Enter file name: ");
    gets(fileName);
    fp = fopen(fileName, "r");
    if (fp == NULL)
    {
       printf("Error! The file does not exist!\n");
    }

    fgets(buffer, RECORDS_SIZE, fp);
    *studentArr = (STUDENT*) malloc(buffer[0]*sizeof(STUDENT));
    while (fgets(buffer, RECORDS_SIZE, fp) != NULL)
    {
        printf("%s", buffer[count]);
       *studentArr[count]->nameStudent = (char*) malloc(strlen(buffer)*sizeof(char));
        studentArr[count]->TimeIn = (int) malloc(strlen(buffer)*sizeof(int));
        sscanf(buffer,"%[,],%d", *studentArr[count]->nameStudent, &studentArr[count]->TimeIn);

        printf("%s%d\n", studentArr[count]->nameStudent, &studentArr[count]->TimeIn);
       count++;
    }

    return;
} 
```

有一个警告说，该赋值从没有强制转换的指针中生成整数 [默认启用]| 在我为 *studentArr[count]->nameStudent 分配内存的行上，为什么会收到此警告？

这就是我的文件的样子

```
4
A,10
B,12
C,60
D,120
tutorY 
```

我尝试在第一行中读取，然后使用第一行上的数字来分配指向结构数组的指针并继续读取，然后分配结构的其余成员

我认为我的while循环错误，可能是我不应该调用fgets然后在while循环中重用它，因为它似乎在那里有错误。如何修复此功能？

预先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:36:57.820

### 修改后的问题

> `nameStudent`是一个 20 个字符的数组，我认为这可能会在分配时引起问题。

在这种情况下，您根本不需要动态分配`nameStudent`字段。创建学生结构时，名称的所有空间都将作为学生结构的一部分进行分配。

* * *

### 早期的观察

如果你真的有：

```
*studentArr[count]->nameStudent = (char*) malloc(strlen(buffer)*sizeof(char)); 
```

那么对于合理的类型`nameStudent`

```
 struct Xxxx
 {
     ...
     char *nameStudent;
     ...
 }; 
```

你有`*`在前面取消引用一个未定义的指向 char 的指针。这就是您收到警告的原因：

```
 assignment makes integer from pointer without a cast [enabled by default] 
```

具有固定大小的学生姓名的结构可能会更好地为您服务：

```
 struct Xxxx
 {
     ...
     char nameStudent[32];
     ...
 }; 
```

* * *

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T20:39:54.380

```
*studentArr[count]->nameStudent = (char*)... 
```

尽管您没有提供 的定义`STUDENT`，但这肯定是错误的……如果 nameStudent 是`char*`，您正试图通过该初始值将其存储到它的第一个字节中`*`。您的代码还有其他错误，例如`(int)`下一行的演员表。我建议对 C 语言进行更多的研究，并更加仔细地关注您的程序是否以及如何满足其要求。C 语言要求很高的精度。

更新：

由于`nameStudent`是一个数组，它不能也不应该有一个指针分配给它。

您的代码还包含许多其他错误。

```
fgets(buffer, RECORDS_SIZE, fp); 
```

这会读取 RECORDS_SIZE 个字节，而不是一条 STUDENT 记录。

```
*studentArr = (STUDENT*) malloc(buffer[0]*sizeof(STUDENT)); 
```

`buffer[0]`在这里没有意义。只设置 of 的第一个元素是`studentArr`没有意义的......你没有在循环中设置任何其他元素。循环外不应该有一个`fgets`调用......一个永远不会检查错误或EOF的调用。

你的程序包含太多错误和误解，如果不为你编写代码就无法回答你的问题。

# android - 在外部存储器/SD卡上缓存图像的推荐路径

> ID：16156108
> 
> 赞同：5
> 
> 时间：2013-04-22T20:27:20.993
> 
> 标签：android, android-sdcard, android-external-storage

当我在 Android 文件传输或 Astro 文件管理器中查看我的 sd 卡根目录时，它一团糟，因为应用程序到处都存储文件。

作为开发人员，我们通过缓存图像/文件等来遵循最佳实践，以使我们的应用程序更快，并且我们使用`Environment.getExternalStorageDirectory()`来获取外部存储的根目录（而不是硬编码 /sdcard）。但是接下来应该怎么做？理想情况下，我们会遵循将缓存文件转储到作为外部存储的开放字段的约定吗？

以下是我从自己的设备/经验中看到的几个选项：

*   **`/.cache/app_name/`**
*   `/.app_name/`
*   `/cache/<app_name>/`
*   `/data/<app_name>/`
*   `/com.package.name/`
*   `/app_name/`

我目前更喜欢在设备文件管理器中默认隐藏第一个选项。

有谁知道谷歌的推荐或几个流行/大牌应用程序遵循的约定？或原因这是一个坏主意？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T14:34:48.080

根据开发者文档

> **保存缓存文件**
> 
> 如果您使用 API 级别 8 或更高版本，请使用 getExternalCacheDir() 打开一个文件，该文件代表您应该保存缓存文件的外部存储目录。如果用户卸载您的应用程序，这些文件将被自动删除。但是，在应用程序的生命周期中，您应该管理这些缓存文件并删除那些不需要的以保留文件空间。
> 
> 如果您使用 API 级别 7 或更低，请使用 getExternalStorageDirectory() 打开表示外部存储根目录的文件，然后将缓存数据写入以下目录：
> 
> /Android/data/<package_name>/cache/
> 
> <package_name> 是您的 Java 样式的包名称，例如“com.example.android.app”。

更多信息在这里

[http://developer.android.com/guide/topics/data/data-storage.html#filesExternal](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T14:26:58.010

[开发人员指南](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)指出文件应该存储在目录中，这`/Android/data/<package_name>/files/`似乎是少数应用程序存储文件的地方。作为一个额外的好处，一旦你的应用程序被卸载，这里的文件就会被删除，并且不会弄乱根目录。我认为将缓存文件放入`/Android/data/<package_name>/cache/`可能是一个不错的选择！

# javascript - 跨域共享策略 - 在 Chrome 上使用 color-thief.js 加载颜色

> ID：16156110
> 
> 赞同：-1
> 
> 时间：2013-04-22T20:27:25.587
> 
> 标签：javascript, jquery, google-chrome, colors

我正在尝试对图像进行颜色分析，但 Chrome 的 dang 跨域共享策略阻碍了[http://jsfiddle.net/mrcactu5/d6Qka/15/](http://jsfiddle.net/mrcactu5/d6Qka/15/)

```
Cross-origin image load denied by Cross-Origin Resource Sharing policy. 
```

我曾在 StackOverflow 上询问过，并在以前的版本中对其进行了修复。 [http://jsfiddle.net/mrcactu5/d6Qka/6/](http://jsfiddle.net/mrcactu5/d6Qka/6/)

```
var image = new Image();
image.crossOrigin = '';
image.src = 'http://upload.wikimedia.org/wikipedia/commons/0/07/Honeycrisp-Apple.jpg';
image.width=200; 
```

基本上，我的脚本从 Tumblr 下载图像链接并运行[color-thief.js](http://lokeshdhakar.com/projects/color-thief/)。很简单，对吧？

```
imgs = Array(); // stores image links

$.getJSON(url, function(data) { 
    for(var i = 0; i < data.response.length; i++){
        if(data.response[i].photos != undefined){
            //console.log(data.response[i].photos[0].alt_sizes[0].url);
            imgs.push(data.response[i].photos[0].alt_sizes[0].url);
        }

    }
}).success( function(imgs){  analyze(imgs); }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T17:19:53.700

不要认为你可以绕过跨域错误，除非你使用[document.domain](https://developer.mozilla.org/en-US/docs/DOM/document.domain)设置。[此处](https://stackoverflow.com/questions/14459894/js-on-tumblr-cross-origin-resource-sharing-policy-error)、[此处](https://stackoverflow.com/questions/14474194/cross-origin-resource-sharing-policy-between-subdomains-in-js)和[此处](https://stackoverflow.com/questions/9972049/cross-origin-data-in-html5-canvas)已提出此问题。

您可以查看执行类似操作的不同 javascript 库，演示 [http://www.maxnov.com/getimagedata/#examples-2](http://www.maxnov.com/getimagedata/#examples-2)

或者，您可以[在本地运行您的脚本](https://github.com/mrdoob/three.js/wiki/How-to-run-things-locally)。

# php - 如果单击通过另一个查询进入另一个组合，则 php、javascript 和 mysql 如何成为一个组合

> ID：16156119
> 
> 赞同：0
> 
> 时间：2013-04-22T20:28:00.013
> 
> 标签：php, javascript, mysql

我试图通过这个论坛的许多不同的帖子来解决问题。但无法达到我的具体目标。
我正在尝试将表中的列中的数据添加到组合中，然后如果单击任何一个数据，它应该根据单击的数据从另一个表中的另一列列出到另一个组合。
请检查我的网站：raihans.co.uk，用户：dbuser，passwd。然后将鼠标悬停在用户登录/注销上，单击“数据库测试”。
作为示例，您可以查看顶部创建的组合。在底部，我已经尝试过使用 mysql、javascript 和 php。成功地从我的一个表中填充了我在 1st Combo 中的第一列。但不能进行到第二或第三。
请看一下代码。我已经习惯了填充这两个组合。我不确定，我在哪里做错了。请帮助我。提前谢谢你。

```
<html><div><head><?php
    $link = mysql_connect("localhost","db_user_name","db_user_passwd");
    if (!$link) {    die('Could not connect to Database: ' . mysql_error());   }
    mysql_select_db("db_name",$link);
?>

<script type="text/javascript">
<?php
    $category = array();
    $query = "SELECT State_Name FROM Test_State";
    $q_result = mysql_query($query);
    if (!$q_result) {     die('Could not make query: ' . mysql_error());      }
    while($row = mysql_fetch_assoc($q_result))  {    ?>
category[] = ["<?php  $row;    }    ?>"];

function fillSelect(sel,ary,nxt){
 if (ary&&sel.form){
 var frm=sel.form,nme=sel.name.replace(/\d/g,""),i=Number(sel.name.replace(/\D/g,""))+1,nxt=frm[nxt],opts=sel.options,oary=[],z0=nxt==sel?0:1,z1=0,z1a;
 while (frm[nme+i]){
   frm[nme+i].length=1;
   frm[nme+i].selectedIndex=0;
   i++;
 }
 for (;z0<opts.length;z0++){
   if (opts[z0].selected&&ary[opts[z0].value]){
     oary=oary.concat(ary[opts[z0].value]);
 }  }
 if (nxt){
   for (;z1<oary.length;z1++)  {    nxt.options[z1+1]=new Option(oary[z1],oary[z1]);   }
 nxt.selectedIndex=0;
 }   }   }
 function getValue(isValue) {   alert(isValue);   }

 function init() {   fillSelect(document.forms[0]['List1'],category,'List1')   }

 navigator.appName == "Microsoft Internet Explorer" ? attachEvent('onload', init, false) : addEventListener('load', init, false);
 </script></div></head>

 <body>
 <form action="">

 <select name='List1' onchange="fillSelect(this,category,'List2')">
     <option value="" selected>Select a country</option>
 <?php
    $category = "SELECT Country_Name FROM Test_Country";
    $query_result = mysql_query($category);
    while($result = mysql_fetch_assoc($query_result))
    {    ?>
 <option value = "<?php echo $result['Country_Name']?>"><?php echo $result['Country_Name']?></option>
 <?php    } ?>
 </select>

 <select name='List2' onchange="getValue(this.value)">
 <option selected>Select State</option>
 </select>
 </form></body></html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T00:53:42.153

我认为对您来说最好的技术是完全按原样使用示例代码，但有一个变化：当您在 PHP 中构建页面时，您希望动态创建类别数组。您可以通过在 PHP 中创建数组来非常巧妙地做到这一点，然后使用[json_encode()](http://www.php.net/manual/en/function.json-encode.php)将其转换为 javascript。

在这里，我试图向您展示如何构建`$categories`可以与现有 Javascript 一起使用的变量。我还没有测试它，所以你应该预料到一些错误。但是技术才是最重要的。

```
<html><div><head>
    <?php
        $link = mysql_connect("localhost","db_user_name","db_user_passwd");
        if (!$link)
            die('Could not connect to Database: ' . mysql_error());
        mysql_select_db("db_name",$link);

        $categories = array();

        $countryQuery = "select State_Name FROM Test_State";
        $countryResult = mysql_query($countryQuery);
        while( $row = mysql_fetch_assoc($countryResult) )
            $categories['startList'][] = $row['State_Name'];

        /*  I don't know your db schema, so I'm making it up as I go along
            A db row of "California","SFO" becomes:
                $categories["California"] = array("SFO");
            Subsequent airports in California are appended to the same array.
        */
        $airportQuery = "select Airport_Name, State_Name from Test_Airport";
        $airportResult = mysql_query($airportQuery);
        while( $row = mysql_fetch_assoc($airportResult) )
            $categories[$row['State_Name']][] = $row['Airport_Name'];

        // you can use the same technique to build a map of airports->resorts
    ?>

    <!-- Now we just need to export the big PHP array as a Javascript variable.
        Use the json_encode() function. -->
    <script type="text/javascript">
        $category = <?php echo json_encode($categories); ?> ;
    </script> 
```

我也有一些额外的说明给你：

首先，不要使用 mysql 库。它已被新代码弃用。请改用[mysqli](http://www.php.net/manual/en/book.mysqli.php)或[PDO](http://www.php.net/manual/en/book.pdo.php)。

其次，我认为您对 PHP 和 Javascript 如何交互感到困惑。总之，他们没有。PHP 运行并创建页面，然后浏览器加载页面并运行 Javascript。看起来您希望 Javascript 与 PHP 交互，除非您使用 AJAX 技术，否则这不会发生。您还没有为 AJAX 做好准备。

第三，如果你要让其他人阅读你的代码，你应该先把它格式化好。凌乱的代码很难阅读，大多数人只会避开它而不回答你的问题。如果您希望其他人帮助您编写代码，则需要愿意为您的问题付出一些额外的努力。

# angularjs - 如何在 AngularJS 中创建自定义 TabControl 指令

> ID：16156126
> 
> 赞同：1
> 
> 时间：2013-04-22T20:28:26.340
> 
> 标签：angularjs, angularjs-directive

我目前正在为我的 CSS/Grid 框架使用 Zurb Foundation 4，他们有一个非常好的选项卡控件。但是，当它位于通过 ng-view 加载的页面上时，选项卡控件无法正常工作。

所以，我想我会编写自己的指令，因为我将在我们的网站上使用它。然而，一旦我进入它，我很快意识到我在我的头上。

我提供了一个我正在尝试做的示例，然后是我的实际代码混乱示例

静态示例：这是我想要完成的。请参阅 JsFiddle 上的完整代码示例。 [http://jsfiddle.net/aYTaN/1/](http://jsfiddle.net/aYTaN/1/)

```
<div class="tab-container">

    <p class="active-tab">
        <a href="">Tasks</a>
    </p>
    <p>
        <a href="">Parts</a>
    </p>

    <section>
        Tab 1 content
    </section>

    <section style="display:none">
        Tab 2 Content
    </section>

</div> 
```

这是我没有工作的实际代码：http: [//jsfiddle.net/dxwc9/3/](http://jsfiddle.net/dxwc9/3/)

```
app.directive('tabControl', function($rootScope) {
    'use strict';

    return {

        restrict: 'E',

        link: function(scope, element, attrs) {

            console.log(attrs.tabs);

            var tabs = attrs.tabs.split(',');

            var tabContainer = angular.element('<div class="tab-container"></div>'),
                tab = angular.element('<p><a href=""></a></p>'),
                content = angular.element('<section></section>');

            for (var i = 0; i<tabs.length; i++){

                tabContainer.append(tab);

                var title = tab.find('a');

                title.html(tabs[i]);

                tabContainer.append(content);

            }

        }

    }

}); 
```

我真的很感激任何帮助。

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-22T21:28:50.267

angularui/bootstrap 项目有一个非常简单的实现，带有选项卡和窗格（您的部分等效）。**[在Github](https://github.com/angular-ui/bootstrap/blob/master/src/tabs/tabs.js)**上查看

基本思想是创建两个指令（一个用于选项卡，一个用于部分）并让一个公共控制器在它们之间进行通信。

# intuit-partner-platform - SalesTax 快速手册在线 sdk

> ID：16156127
> 
> 赞同：0
> 
> 时间：2013-04-22T20:28:29.360
> 
> 标签：intuit-partner-platform, quickbooks-online, qbxml

我正在尝试通过 sdk 添加发票，但我收到以下消息：“您在不允许的交易中选择了纳税义务帐户，或者没有指定税率。” 这是我的xml。

```
<InvoiceAdd>
<CustomerRef>
    <ListID>2</ListID>  
    <FullName>Adam West</FullName>
</CustomerRef>
<ARAccountRef>
    <ListID>54</ListID>
    <FullName>Accounts Receivable (A/R)</FullName>
</ARAccountRef>
<TxnDate>2013-04-22</TxnDate>
<RefNumber>1017</RefNumber>    
<TermsRef>
    <ListID>3</ListID>
    <FullName>Net 30</FullName>
</TermsRef>
<DueDate>2013-05-22</DueDate>
<IsToBePrinted>false</IsToBePrinted>
<InvoiceLineAdd>
    <ItemRef>
        <ListID>3</ListID>
        <FullName>Engine</FullName>
    </ItemRef>
    <Quantity>1</Quantity> 

    <Rate>500</Rate>
    <Amount>500.00</Amount>
    <IsTaxable>true</IsTaxable>
</InvoiceLineAdd>
<InvoiceLineAdd>
    <Desc>TAX</Desc>
    <RatePercent>5</RatePercent>
    <Amount>25.00</Amount>  

    <IsTaxable>false</IsTaxable>
</InvoiceLineAdd>
<SalesTaxLineAdd>
    <RatePercent>5</RatePercent>
    <AccountRef>
        <ListID>59</ListID>
        <FullName>Batman's Payable</FullName>
    </AccountRef>
</SalesTaxLineAdd> 
```

我从我在 gui 中创建的发票创建了这个 xml。然后我做了一个 Invoicerq，得到了这个 xml，我把它改成了上面的 xml。

```
<InvoiceRet>
<TxnID>34</TxnID>
<TimeCreated>2013-04-22T12:17:56</TimeCreated>
<TimeModified>2013-04-22T12:17:56</TimeModified>
<EditSequence>0</EditSequence>
<TxnNumber>34</TxnNumber>
<CustomerRef>
    <ListID>2</ListID>  
    <FullName>Adam West</FullName>
</CustomerRef>
<ARAccountRef>
    <ListID>54</ListID>
    <FullName>Accounts Receivable (A/R)</FullName>
</ARAccountRef>
<TxnDate>2013-04-22</TxnDate>
<RefNumber>1017</RefNumber>    
<TermsRef>
    <ListID>3</ListID>
    <FullName>Net 30</FullName>
</TermsRef>
<DueDate>2013-05-22</DueDate>
<Subtotal>525.00</Subtotal>
<SalesTaxPercentage>5</SalesTaxPercentage>
<SalesTaxTotal>25.00</SalesTaxTotal>  
<AppliedAmount>0.00</AppliedAmount>
<BalanceRemaining>525.00</BalanceRemaining>
<IsPaid>false</IsPaid>
<IsToBePrinted>false</IsToBePrinted>
<InvoiceLineRet>
    <TxnLineID>1</TxnLineID>
    <ItemRef>
        <ListID>3</ListID>
        <FullName>Engine</FullName>
    </ItemRef>
    <Quantity>1</Quantity> 

    <Rate>500</Rate>
    <Amount>500.00</Amount>
    <IsTaxable>true</IsTaxable>
</InvoiceLineRet>
<InvoiceLineRet>
    <TxnLineID>2</TxnLineID>
    <Desc>TAX</Desc>
    <RatePercent>5</RatePercent>
    <Amount>25.00</Amount>  

    <IsTaxable>false</IsTaxable>
</InvoiceLineRet>
<SalesTaxLineRet>
    <RatePercent>5</RatePercent>
    <AccountRef>
        <ListID>59</ListID>
        <FullName>Batman's Payable</FullName>
    </AccountRef>
</SalesTaxLineRet> 
```

如果在 SalesTaxLineAdd 标记中删除 AccountRef，它会为名为“原始销售税”的订单创建一个包含销售税的发票。

但是，我想要我创建的税率。为什么我可以使用税率而不是通过 xml 创建发票？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T17:37:12.013

我假设您使用的是 QuickBooks API 的第 2 版。有一个限制，您无法使用 API 设置税码，因此很遗憾，您无法对 QuickBooks Online 中出现的“原始销售税”执行任何操作。

根据 Intuit 的说法，版本 3 允许您执行此操作，但它仅在上周发布给有限数量的开发人员：

[http://ippblog.intuit.com/blog/2013/04/quickbooks-api-v3-april-release.html](http://ippblog.intuit.com/blog/2013/04/quickbooks-api-v3-april-release.html)

# ios - NSJSONSerialization 在 DBL_MAX 上失败

> ID：16156129
> 
> 赞同：7
> 
> 时间：2013-04-22T20:28:39.560
> 
> 标签：ios, json, parsing

我在反序列化包含大双精度的 JSON 时遇到了问题。基本上，我可以像这样序列化字典

```
NSDictionary *dict = @{@"doubleVal": @DBL_MAX}; 
```

序列化没有麻烦

```
{"doubleVal":1.797693134862316e+308} 
```

但是，如果我尝试反序列化数据，它就会爆炸。

一个演示问题的小单元测试：

```
- (void)test_600_doubleJSON {
    NSDictionary *dict = @{@"doubleVal": @DBL_MAX};
    NSError *jsonError, *jsonResponseError;

    NSData *data = [NSJSONSerialization dataWithJSONObject:dict
                                                   options:0
                                                     error:&jsonError];
    id jsonResponse = [NSJSONSerialization JSONObjectWithData:data
                                                      options:0
                                                        error:&jsonResponseError];

    STAssertNil(jsonError, @"JSON error: %@", jsonError.localizedDescription);
    STAssertNil(jsonResponseError,
                @"JSON response error: %@",
                jsonResponseError.localizedDescription);
} 
```

最后一个断言失败，原因如下：

```
JSON response error: The operation couldn’t be completed. (Cocoa error 3840.) 
```

如果我`DBL_MAX`用（小得多）的值替换，则测试按预期完成。

# c++ - 为什么我的程序这么慢？

> ID：16156130
> 
> 赞同：9
> 
> 时间：2013-04-22T20:28:40.370
> 
> 标签：c++, benchmarking, google-nativeclient

有人决定做一个快速测试，看看本机客户端在速度方面与 javascript 相比如何。他们通过运行 10 000 000 sqrt 计算并测量所花费的时间来做到这一点。使用 javascript 的结果：0.096 秒，使用 NaCl：4.241 秒……这怎么可能？速度不是首先使用 NaCl 的原因之一吗？还是我缺少一些编译器标志或其他东西？

这是运行的代码：

```
clock_t t = clock();
float result = 0;
for(int i = 0; i < 10000000; ++i) {
    result += sqrt(i);
}
t = clock() - t;      
float tt = ((float)t)/CLOCKS_PER_SEC;
pp::Var var_reply = pp::Var(tt);
PostMessage(var_reply); 
```

[PS：这个问题是本机客户端邮件列表](https://groups.google.com/forum/?fromgroups=#!topic/native-client-discuss/F7Wdmtp0K74)中出现的内容的编辑版本

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-22T20:30:52.020

[注意：此答案是本机客户端邮件列表](https://groups.google.com/forum/?fromgroups=#!topic/native-client-discuss/F7Wdmtp0K74)中出现的内容的编辑版本

微基准很棘手：除非您非常了解自己在做什么，否则很容易产生与您想要观察/测量的行为完全无关的苹果与橘子的比较。

我将使用您自己的示例进行详细说明（我将排除 NaCl 并坚持现有的“经过验证的”技术）。

这是您作为本机 C 程序的测试：

```
$ cat test1.c
#include <math.h>
#include <time.h>
#include <stdio.h>

int main() {
  clock_t t = clock();
  float result = 0;
  for(int i = 0; i < 1000000000; ++i) {
      result += sqrt(i);
  }
  t = clock() - t;
  float tt = ((float)t)/CLOCKS_PER_SEC;
  printf("%g %g\n", result, tt);

}
$ gcc -std=c99 -O2 test1.c -lm -o test1
$ ./test1
5.49756e+11 25.43 
```

好的。我们可以在 25.43 秒内完成十亿次循环。但是让我们看看需要时间：让我们替换“result += sqrt(i);” 用“结果+=我；”

```
$ cat test2.c
#include <math.h>
#include <time.h>
#include <stdio.h>

int main() {
  clock_t t = clock();
  float result = 0;
  for(int i = 0; i < 1000000000; ++i) {
      result += i;
  }
  t = clock() - t;
  float tt = ((float)t)/CLOCKS_PER_SEC;
  printf("%g %g\n", result, tt);
}
$ gcc -std=c99 -O2 test2.c -lm -o test2
$ ./test2
1.80144e+16 1.21 
```

哇！95% 的时间实际上都花在了 CPU 提供的 sqrt 函数上，其他所有时间都花在了不到 5% 上。但是如果我们稍微修改一下代码会怎样：替换 "printf("%g %g\n", result, tt);" 与“printf（“%g\n”，tt）；“ ?

```
$ cat test3.c
#include <math.h>
#include <time.h>
#include <stdio.h>

int main() {
  clock_t t = clock();
  float result = 0;
  for(int i = 0; i < 1000000000; ++i) {
      result += sqrt(i);
  }
  t = clock() - t;
  float tt = ((float)t)/CLOCKS_PER_SEC;
  printf("%g\n", tt);
}
$ gcc -std=c99 -O2 test3.c -lm -o test3
$ ./test
1.44 
```

嗯......看起来现在“sqrt”几乎和“+”一样快。怎么会这样？printf 如何影响前一个周期？

让我们来看看：

```
$ gcc -std=c99 -O2 test1.c -S -o -
...
.L3:
        cvtsi2sd        %ebp, %xmm1
        sqrtsd  %xmm1, %xmm0
        ucomisd %xmm0, %xmm0
        jp      .L7
        je      .L2
.L7:
        movapd  %xmm1, %xmm0
        movss   %xmm2, (%rsp)
        call    sqrt
        movss   (%rsp), %xmm2
.L2:
        unpcklps        %xmm2, %xmm2
        addl    $1, %ebp
        cmpl    $1000000000, %ebp
        cvtps2pd        %xmm2, %xmm2
        addsd   %xmm0, %xmm2
        unpcklpd        %xmm2, %xmm2
        cvtpd2ps        %xmm2, %xmm2
        jne     .L3
 ...
$ gcc -std=c99 -O2 test3.c -S -o -
...
        xorpd   %xmm1, %xmm1
...
.L5:
        cvtsi2sd        %ebp, %xmm0
        ucomisd %xmm0, %xmm1
        ja      .L14
.L10:
        addl    $1, %ebp
        cmpl    $1000000000, %ebp
        jne     .L5
...
.L14:
        sqrtsd  %xmm0, %xmm2
        ucomisd %xmm2, %xmm2
        jp      .L12
        .p2align 4,,2
        je      .L10
.L12:
        movsd   %xmm1, (%rsp)
        .p2align 4,,5
        call    sqrt
        movsd   (%rsp), %xmm1
        .p2align 4,,4
        jmp     .L10
... 
```

第一个版本实际上调用了 sqrt 十亿次，但第二个版本根本不这样做！相反，它检查数字是否为负并仅在这种情况下调用 sqrt！为什么？编译器（或者更确切地说，编译器作者）在这里试图做什么？

好吧，这很简单：因为我们在这个特定版本中没有使用“result”，所以它可以安全地省略“sqrt”调用......如果值不是负数，那就是！如果它是负数，那么（取决于 FPU 标志） sqrt 可以做不同的事情（返回无意义的结果，使程序崩溃等）。这就是为什么这个版本快几十倍的原因——但它根本不计算平方根！

这是最后一个示例，它显示了错误的微基准测试如何：

```
$ cat test4.c
#include <math.h>
#include <time.h>
#include <stdio.h>

int main() {
  clock_t t = clock();
  int result = 0;
  for(int i = 0; i < 1000000000; ++i) {
      result += 2;
  }
  t = clock() - t;
  float tt = ((float)t)/CLOCKS_PER_SEC;
  printf("%d %g\n", result, tt);
}
$ gcc -std=c99 -O2 test4.c -lm -o test4
$ ./test4
2000000000 0 
```

执行时间是……零？怎么会这样？十亿次计算在不到一眨眼的时间内？让我们来看看：

```
$ gcc -std=c99 -O2 test1.c -S -o -
...
        call    clock
        movq    %rax, %rbx
        call    clock
        subq    %rbx, %rax
        movl    $2000000000, %edx
        movl    $.LC1, %esi
        cvtsi2ssq       %rax, %xmm0
        movl    $1, %edi
        movl    $1, %eax
        divss   .LC0(%rip), %xmm0
        unpcklps        %xmm0, %xmm0
        cvtps2pd        %xmm0, %xmm0
... 
```

呃，哦，循环完全消除了！所有计算都发生在编译时，雪上加霜的是，两个“时钟”调用都是在循环体启动之前执行的！

如果我们将它放在单独的函数中怎么办？

```
$ cat test5.c
#include <math.h>
#include <time.h>
#include <stdio.h>

int testfunc(int num, int max) {
  int result = 0;
  for(int i = 0; i < max; ++i) {
      result += num;
  }
  return result;
}

int main() {
  clock_t t = clock();
  int result = testfunc(2, 1000000000);
  t = clock() - t;
  float tt = ((float)t)/CLOCKS_PER_SEC;
  printf("%d %g\n", result, tt);
}
$ gcc -std=c99 -O2 test5.c -lm -o test5
$ ./test5
2000000000 0 
```

还是一样？？？怎么会这样？

```
$ gcc -std=c99 -O2 test5.c -S -o -
...
.globl testfunc
        .type   testfunc, @function
testfunc:
.LFB16:
        .cfi_startproc
        xorl    %eax, %eax
        testl   %esi, %esi
        jle     .L3
        movl    %esi, %eax
        imull   %edi, %eax
.L3:
        rep
        ret
        .cfi_endproc
... 
```

哦哦：编译器很聪明，可以用乘法代替循环！

现在，如果您在一侧添加 NaCl，在另一侧添加 JavaScript，您将得到一个如此复杂的系统，其结果实际上是不可预测的。

这里的问题是，对于微基准测试，你试图隔离一段代码，然后评估它的属性，但是编译器（无论是 JIT 还是 AOT）会试图阻止你的努力，因为它试图从你的程序中删除所有无用的计算！

微基准测试很有用，当然，但它们是取证分析工具，而不是您想用来比较两个不同系统的速度的工具！为此，您需要一些“真实的”（从某种意义上说：不能被过度渴望的编译器优化成碎片的东西）工作量：特别是排序算法很流行。

使用 sqrt 的基准特别讨厌，因为正如我们所见，它们通常花费超过 90% 的时间执行一条 CPU 指令：sqrtsd（如果是 32 位版本，则为 fsqrt），当然，这对于 JavaScript 和 NaCl 是相同的. 这些基准（如果实施得当）可以作为试金石（如果某些实施的速度与简单的本机版本表现出的差异太大，那么你做错了什么），但它们对于比较 NaCl、JavaScript、C# 的速度是没有用的或 Visual Basic。

# contact-form - php 代码在表单字段中显示为纯文本

> ID：16156132
> 
> 赞同：0
> 
> 时间：2013-04-22T20:28:48.307
> 
> 标签：contact-form, php

我想实现一个联系表单，但浏览器将 php 代码显示为纯文本。这是代码：

```
<div id="main-container">

    <div id="form-container">
    <h1>Fancy Contact Form</h1>
    <h2>Drop us a line and we will get back to you</h2>

    <form id="contact-form" name="contact-form" method="post" action="submit.php">
      <table width="100%" border="0" cellspacing="0" cellpadding="5">
        <tr>
          <td width="15%"><label for="name">Name</label></td>
          <td width="70%"><input type="text" class="validate[required,custom[onlyLetter]]" name="name" id="name" value="<?=$_SESSION['post']['name']?>" /></td>
          <td width="15%" id="errOffset">&nbsp;</td>
        </tr>
        <tr>
          <td><label for="email">Email</label></td>
          <td><input type="text" class="validate[required,custom[email]]" name="email" id="email" value="<?=$_SESSION['post']['email']?>" /></td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td><label for="subject">Subject</label></td>
          <td><select name="subject" id="subject">
            <option value="" selected="selected"> - Choose -</option>
            <option value="Question">Question</option>
            <option value="Business proposal">Business proposal</option>
            <option value="Advertisement">Advertising</option>
            <option value="Complaint">Complaint</option>
          </select>          </td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td valign="top"><label for="message">Message</label></td>
          <td><textarea name="message" id="message" class="validate[required]" cols="35" rows="5"><?=$_SESSION['post']['message']?></textarea></td>
          <td valign="top">&nbsp;</td>
        </tr>
        <tr>
          <td><label for="captcha"><?=$_SESSION['n1']?> + <?=$_SESSION['n2']?> =</label></td>
          <td><input type="text" class="validate[required,custom[onlyNumber]]" name="captcha" id="captcha" /></td>
          <td valign="top">&nbsp;</td>
        </tr>
        <tr>
          <td valign="top">&nbsp;</td>
          <td colspan="2"><input type="submit" name="button" id="button" value="Submit" />
          <input type="reset" name="button2" id="button2" value="Reset" />

          <?=$str?>          <img id="loading" src="img/ajax-load.gif" width="16" height="16" alt="loading" /></td>
        </tr>
      </table>
      </form>
      <?=$success?>
    </div>
    <div class="tutorial-info"> 
    This is a Tutorialzine demo. View the <a href="http://tutorialzine.com/2009/09/fancy-contact-form/">original tutorial</a>, or download the <a href="demo.zip">demo files</a>.    </div>

</div> 
```

所以，我得到了这些

```
<?=$_SESSION['post']['name']?>
<?=$_SESSION['post']['email']?>
<?=$_SESSION['post']['message']?> 
```

以纯文本形式显示在表单字段中。做错了什么？请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:30:39.733

您的 php.ini 配置是否支持[短标签？](http://php.net/manual/en/ini.core.php)可能就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T20:34:51.240

在 PHP 5.4.0 之前，速记语句受`short_open_tag`配置影响。你可能想检查一下。请注意，不建议使用这些速记语句而只是回显您的值。它产生更健壮和可移植的代码。

[http://www.php.net/manual/en/ini.core.php#ini.short-open-tag](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T20:31:07.993

在某些服务器中，你不能使用`<?=`，所以你必须使用这个：

```
<?php echo $_SESSION['post']['name']; ?> 
```

或者只是在 php.ini 中启用短标签

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T20:31:14.963

短标签可能在 PHP.ini 中被禁用，你不应该使用它们

更改`<?=` 为

```
<?php echo 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-22T20:32:03.560

试试这个

```
 value="<?php echo $_SESSION['post']['name']; ?>" 
```

第二个

```
value="<?php echo $_SESSION['post']['email'] ; ?>" 
```

第三个

```
 <?php echo $_SESSION['post']['message'] ; ?> 
```

等等

# c - 从微控制器发送命令以通过 SPI 显示并接收结果

> ID：16156146
> 
> 赞同：0
> 
> 时间：2013-04-22T20:29:38.160
> 
> 标签：c, interface, embedded, microcontroller, msp430

好的，这个问题可能有点宽泛，因为我真的不知道从哪里开始。我会尽量说清楚。

我有一个带有已知显示驱动程序的手机显示器，我有数据表。该显示器将通过 SPI 与微控制器（msp430g 类型）通信。

发送到显示器的某些命令不会产生响应，但有些会产生响应，响应可能是几个“字节”（9 位数据）。

我首先认为我应该有一个 fifo 缓冲区，微控制器向其提供命令，以便微控制器可以在命令被移出时执行其他操作。但是我觉得在有响应的情况下，命令会与可能的响应“断开”。我不知道如何处理。

我的第二个想法是将所有命令作为函数来执行相关命令所需的 (write->[read*x])。但这感觉就像我会让微型站在那里等待 SPI 接口的方式。

在这种情况下，“正常”的事情是什么？我想有很多答案，但我确信已经编写了很多代码，它们使用某些接口与某些设备进行通信，但在接口“工作”时执行其他操作。

如果对我要做什么有任何含糊之处，请告诉我，我会尽力澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T09:14:27.330

SPI 是主从，所以从从机接收（我假设显示器是从机）你需要**传输**一个虚拟字节的数据（所以主机在摆动时钟线），你应该得到 Rx 数据在您的 Rx (In/Rx/MISO) 引脚上计时。

如果有可以自主处理的硬件 SPI 接口，那么您可以将其全部留在后台工作，并在完成后获得中断。

我不能代表 MSP，但在 Coldfire 上，SPI 硬件可以加载一些东西到 Tx/Rx 并且会去做，在你的例子中，你会在 Tx 数据的末尾附加一个虚拟字节和当“就绪”中断发生时，回复字节将位于 RX 缓冲区的最后一个插槽中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T23:22:26.153

为了以有效的方式安排读取和写入，我建议使用中断。MSP430 在发送字节和接收字节时都会产生中断。当中断触发时，加载下一个要发送的字节（用于 tx），或存储接收到的字节（用于 rx）。发送命令后，您可以设置一个标志以获取响应（如果您期望得到响应）。收到回复后，您可以为主循环设置一个标志来处理回复。

# android - 如何从 C 客户端连接到 android 服务并注入 Key 事件？

> ID：16156148
> 
> 赞同：0
> 
> 时间：2013-04-22T20:29:43.393
> 
> 标签：android, android-ndk, native

我正在寻找一种将键/触摸事件从 C 应用程序注入到 android 输入队列的方法。我检查了可以从命令行执行此操作的“输入”android 应用程序的源代码。它是一个绑定到Window Service 并调用injectKeyEvent 的Java 应用程序。但我喜欢从本机代码中做同样的事情。

我不希望这个应用程序可以在任何安卓手机或平板电脑上运行。这适用于我们制造的 android 设备，我们可以在其中访问 android 平台和交叉编译器工具链。

“输入”命令以如下方法实现此功能。我正在寻找一种从本机应用程序执行此操作的方法。

```
私人无效的sendKeyEvent（字符串事件）
{
        int eventCode = Integer.parseInt(event);
        现在很长 = SystemClock.uptimeMillis();
        Log.i("SendKeyEvent", event);
        尝试 {
            KeyEvent down = new KeyEvent(now, now, KeyEvent.ACTION_DOWN, eventCode, 0);
            KeyEvent up = new KeyEvent(now, now, KeyEvent.ACTION_UP, eventCode, 0);
            (IWindowManager.Stub
                .asInterface(ServiceManager.getService(Context.WINDOW_SERVICE,Display.DEFAULT_DISPLAY)))
                .injectKeyEvent(down, true);
            (IWindowManager.Stub
                .asInterface(ServiceManager.getService(Context.WINDOW_SERVICE,Display.DEFAULT_DISPLAY)))
                .injectKeyEvent(up, true);
        }
        捕获（远程异常 e）
        {
            Log.i("输入", "DeadOjbectException");
        }
    }

```

编辑：我做了更多的研究 grepping android 平台代码。我看到一个示例，其中 AudioFlinger 正在从 C++ 代码访问 MediaPlayer 服务。

```
静态无效 addBatteryData（uint32_t 参数）{
    sp 粘合剂 =
        defaultServiceManager()->getService(String16("media.player"));
    sp service = interface_cast(binder);
    if (service.get() == NULL) {
        LOGW("无法连接到 MediaPlayerService 进行电池跟踪");
        返回;
    }

    服务->addBatteryData（参数）；
}

```

上面的代码包含了 IMediaPlayerService.h。我正在寻找 IWindowManager.h 来访问 WindowManager 服务，但我在 android 源代码树中没有看到它。

2013 年 4 月 30 日编辑：我看到 frameworks/base/cmds/service/*/Service.cpp 允许您从 C++ 调用远程绑定程序调用。目前尚不清楚测试代码是如何为活页夹调用等提供 id 的。

我放弃了这种方法。我用平台签名的 Java 服务包装了我的 C lib。我使用 Java api 绑定到 IWindowManager 而不是我追求的本机方法取得了很大进展。

# python - 计算单词列表中的元音与单词长度的比率

> ID：16156151
> 
> 赞同：8
> 
> 时间：2013-04-22T20:29:54.347
> 
> 标签：python

这是我的功能的代码：

```
def calcVowelProportion(wordList):
    """
    Calculates the proportion of vowels in each word in wordList.
    """

    VOWELS = 'aeiou'
    ratios = []

    for word in wordList:
        numVowels = 0
        for char in word:
            if char in VOWELS:
                numVowels += 1
        ratios.append(numVowels/float(len(word))) 
```

现在，我正在处理一个超过 87,000 个单词的列表，这个算法显然非常慢。

有一个更好的方法吗？

编辑：

我测试了以下类提供的算法@ExP：

```
 import time

    class vowelProportions(object):
        """
        A series of methods that all calculate the vowel/word length ratio
        in a list of words.
        """

        WORDLIST_FILENAME = "words_short.txt"

        def __init__(self):
            self.wordList = self.buildWordList()
            print "Original: " + str(self.calcMeanTime(10000, self.cvpOriginal, self.wordList))
            print "Generator: " + str(self.calcMeanTime(10000, self.cvpGenerator, self.wordList))
            print "Count: " + str(self.calcMeanTime(10000, self.cvpCount, self.wordList))
            print "Translate: " + str(self.calcMeanTime(10000, self.cvpTranslate, self.wordList))

        def buildWordList(self):
            inFile = open(self.WORDLIST_FILENAME, 'r', 0)
            wordList = []
            for line in inFile:
                wordList.append(line.strip().lower())
            return wordList

        def cvpOriginal(self, wordList):
            """ My original, slow algorithm"""
            VOWELS = 'aeiou'
            ratios = []

            for word in wordList:
                numVowels = 0
                for char in word:
                    if char in VOWELS:
                        numVowels += 1
                ratios.append(numVowels/float(len(word)))

            return ratios

        def cvpGenerator(self, wordList):
            """ Using a generator expression """
            return [sum(char in 'aeiou' for char in word)/float(len(word)) for word in wordList]

        def cvpCount(self, wordList):
            """ Using str.count() """
            return [sum(word.count(char) for char in 'aeiou')/float(len(word)) for word in wordList]

        def cvpTranslate(self, wordList):
            """ Using str.translate() """
            return [len(word.translate(None, 'bcdfghjklmnpqrstxyz'))/float(len(word)) for word in wordList]

        def timeFunc(self, func, *args):
            start = time.clock()
            func(*args)
            return time.clock() - start

        def calcMeanTime(self, numTrials, func, *args):
            times = [self.timeFunc(func, *args) for x in range(numTrials)]
            return sum(times)/len(times) 
```

输出是（对于 200 个单词的列表）：

```
Original: 0.0005613667
Generator: 0.0008402738
Count: 0.0012531976
Translate: 0.0003343548 
```

令人惊讶的是，Generator 和 Count 比原来的还要慢（如果我的实现不正确，请告诉我）。

我想测试@John 的解决方案，但对树木一无所知。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T20:48:14.000

您应该优化最里面的循环。

我很确定有几种替代方法。这是我现在能想到的。我不确定他们将如何比较速度（相对于彼此和您的解决方案）。

*   使用生成器表达式：

    ```
    numVowels = sum(x in 'aeiou' for x in word) 
    ```

*   使用`str.count()`：

    ```
    numVowels = sum(word.count(x) for x in 'aeiou') 
    ```

*   使用`str.translate()`（假设没有大写字母或特殊符号）：

    ```
    numVowels = len(word.translate(None, 'bcdfghjklmnpqrstxyz')) 
    ```

有了所有这些，您甚至可以在一行中编写整个函数，而无需`list.append()`.

我很想知道哪个结果是最快的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-22T20:48:17.080

由于您只关心每个单词中元音与字母的比例，您可以首先将所有元音替换为`a`. 现在您可以尝试一些可能更快的方法：

*   您在每一步测试一个字母而不是五个字母。那肯定会更快。
*   您也许可以对整个列表进行排序并搜索从元音（现在分类为`a`）到非元音的点。这是一个树形结构。单词中的字母数是树的级别。元音的数量是左分支的数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T20:55:14.927

使用正则表达式匹配元音列表并计算匹配数。

```
>>> import re
>>> s = 'supercalifragilisticexpialidocious'
>>> len(re.findall('[aeiou]', s))
16 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T22:31:29.700

```
import timeit

words = 'This is a test string'

def vowelProportions(words):
    counts, vowels = {}, 'aeiou'
    wordLst = words.lower().split()
    for word in wordLst:
        counts[word] = float(sum(word.count(v) for v in vowels)) / len(word)
    return counts

def f():
    return vowelProportions(words)

print timeit.timeit(stmt = f, number = 17400) # 5 (len of words) * 17400 = 87,000
# 0.838676 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-22T20:49:00.913

```
for word in wordlist:
    numVowels = 0
    for letter in VOWELS:
        numVowels += word.count(letter)
    ratios.append(numVowels/float(len(word))) 
```

更少的决策，应该意味着更少的时间，也使用内置的东西，我相信它工作得更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-22T23:21:35.880

以下是如何在 Linux 上使用一个命令行来计算它：-

`cat wordlist.txt | tr -d aeiouAEIOU | paste - wordlist.txt | gawk '{ FS="\t"; RATIO = length($1)/ length($2); print $2, RATIO }'`

输出：

```
aa 0
ab 0.5
abs 0.666667 
```

注意：中的每一行都`wordlist.txt`包含一个单词。空行将产生除以零错误

# c++ - 确定 mandelbrot 缩放的坐标

> ID：16156152
> 
> 赞同：0
> 
> 时间：2013-04-22T20:29:56.207
> 
> 标签：c++, math, zooming, mandelbrot

我有一个想要放大的 mandelbrot 集。mandelbrot 是围绕中心坐标、mandelbrot 大小和缩放级别计算的。原始 mandelbrot 以 real=-0.6 和 im=0.4 为中心，real 和 im 的大小均为 2。

我希望能够单击图像中的一个点并计算一个新的点，并在该点周围放大

包含它的窗口是800x800px，所以我想这会使右下角的点击等于real=0.4和im=-0.6的中心，左上角的点击是real=-1.6和im =1.4

我用以下方法计算它：
对于实际值
800a+b=0.4 => a=0.0025
0a+b=-1.6 => b=-1.6

对于虚数
800c+d=-0.6 => c=-0.0025
0c+d=1.4 => d=1.4

但是，如果我继续使用 2 的 mandelbrot 大小和 2 的缩放级别，这将不起作用。我是否遗漏了有关缩放级别坐标的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T15:50:33.233

我在放大我的 C# Mandelbrot 时遇到了类似的问题。我的解决方案是以百分比计算从点击位置到中心的差异，将其与中心的最大单位（宽度/缩放 * 0.5，宽度 = 高度，缩放 = n * 100）相乘，并将其添加到当前价值。所以我的代码是这样的（假设我从点击中获取`sx`和`sy`作为参数）：

```
 double[] o = new double[2];

        double digressLRUD = width / zoom * 0.5; //max way up or down from the center in coordinates

        double shiftCenterCursor_X = sx - width/2.0; //shift of cursor to center
        double shiftCenterCursor_X_percentage = shiftCenterCursor_X / width/2.0; //shift in percentage
        o[0] = x + digressLRUD * shiftCenterCursor_X_percentage; //new position

        double shiftCenterCursor_Y = sy - width/2.0;
        double shiftCenterCursor_Y_percentage = shiftCenterCursor_Y / width/2.0;
        o[1] = y - digressLRUD * shiftCenterCursor_Y_percentage; 
```

这可行，但您必须更新缩放（我用它乘以 2）。

还有一点就是将选中的中心移动到图像的中心。我使用一些计算来做到这一点：

```
 double maxRe = width / zoom;
        double centerRe = reC - maxRe * 0.5;

        double maxIm = height / zoom;
        double centerIm = -imC - maxIm * 0.5; 
```

这将为您带来必须通过算法的坐标，以便渲染选定的位置。

# entity-framework - 为什么需要在具有 .dll 作为数据访问层的消费应用程序的 app.config 文件中声明连接字符串

> ID：16156153
> 
> 赞同：2
> 
> 时间：2013-04-22T20:29:59.707
> 
> 标签：entity-framework, dll, app-config

我敢肯定这可以追溯到最基本的问题，但我很好奇：

我有一个处理与数据库的实体框架连接的 dll。即我的模型与静态类一起在这个 dll 中，以帮助管理 CRUD 方法或验证。

我的问题是：一旦我引用了这个 dll，为什么我必须在我的消费应用程序的 app.config 文件中包含 ModelEntites 连接字符串，而这已经在 dll 的 app.config 文件中完成了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:47:17.963

共享库没有单独的 app.config，因为 app.config 是应用程序级别的配置文件。因此，您要在 app.config 级别为共享库（包括连接字符串）设置的任何设置都需要在当前应用程序的 app.config 中进行。

虽然您的共享库中可能有一个 app.config 文件，但 .NET 框架不会自动使用它。[如果你真的需要的话，有一些方法可以包含它](https://stackoverflow.com/questions/5190539/equivalent-of-app-config-for-library-dll)，但在我看来，它们可能比仅仅在标准 app.config 中为每个使用该库的应用程序包含相关信息更麻烦。

# mongodb - 如何在地理空间搜索中返回与 MongoDB 和 Mongoose 的距离？

> ID：16156157
> 
> 赞同：4
> 
> 时间：2013-04-22T20:30:22.170
> 
> 标签：mongodb, mongoose

我正在使用带有 Node.js 0.8.8 的 Mongoose 3.5.3，我很惊讶地发现结果中没有返回到给定点的距离。是否可以允许返回距离？它必须有它，因为我的结果似乎是按照人们所期望的距离排序的。

```
exports.nearBuilding = function (req, res, next) {
    var area = {
        center: [parseFloat(req.params.longitude), parseFloat(req.params.latitude)],
        radius: parseFloat(req.params.distance) / 3963.192 };

    var query = Building.find().where('coords').within.centerSphere(area);

    query.exec(function (error, docs) {
        var records = {'records': docs};
        if (error) {
            process.stderr.write(error);
            res.send(error, 500);
        }
        if (req.params.callback !== null) {
            res.contentType = 'application/javascript';
        }
        res.send(records);
        return next();
    });
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-23T15:46:48.403

您可以使用返回距离的 geoNear 函数：

```
Building.collection.geoNear(longitude, latitude, {maxDistance: radius }, cb); 
```

以下是 API 选项：

```
/**
 * Execute the geoNear command to search for items in the collection
 *
 * Options
 *  - **num** {Number}, max number of results to return.
 *  - **maxDistance** {Number}, include results up to maxDistance from the point.
 *  - **distanceMultiplier** {Number}, include a value to multiply the distances with allowing for range conversions.
 *  - **query** {Object}, filter the results by a query.
 *  - **spherical** {Boolean, default:false}, perform query using a spherical model.
 *  - **uniqueDocs** {Boolean, default:false}, the closest location in a document to the center of the search region will always be returned MongoDB > 2.X.
 *  - **includeLocs** {Boolean, default:false}, include the location data fields in the top level of the results MongoDB > 2.X.
 *  - **readPreference** {String}, the preferred read preference ((Server.PRIMARY, Server.PRIMARY_PREFERRED, Server.SECONDARY, Server.SECONDARY_PREFERRED, Server.NEAREST).
 *
 * @param {Number} x point to search on the x axis, ensure the indexes are ordered in the same order.
 * @param {Number} y point to search on the y axis, ensure the indexes are ordered in the same order.
 * @param {Objects} [options] options for the map reduce job.
 * @param {Function} callback this will be called after executing this method. The first parameter will contain the Error object if an error occured, or null otherwise. While the second parameter will contain the results from the geoNear method or null if an error occured.
 * @return {null}
 * @api public 
```

在你的情况下，你会做这样的事情：

```
 exports.nearBuilding = function (req, res, next) {

        var query = Building.collection.geoNear(parseFloat(req.params.longitude), parseFloat(req.params.latitude), { distance: parseFloat(req.params.distance) / 3963.192}, function (error, docs) {

            if (error) {
                process.stderr.write(error);
                res.send(error, 500);
            }
            if (req.params.callback !== null) {
                res.contentType = 'application/javascript';
            }
            // Docs are turned as an array of objects that contain distance (dis) and the object (obj). 
            // Let's concatenate that into something cleaner - i.e. the distance as part of object

            var results = []
            docs.forEach(function(doc) {
                doc.obj.distance = doc.dis;
                results.push(doc.obj);
            });
            var records = {'records': results};      

            res.send(records);
            return next();
        });
    }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-06T02:53:52.940

如果您使用 2dsphere 坐标（您应该这样做），代码应如下所示。距离 d 以米为单位。

```
var point = { coordinates: [lng, lat], type: 'Point' };           

Entity.geoNear(point, {maxDistance: d, spherical: true}, function(err, docs) {
  if (err) { return next(err); }

  var entities = [];

  docs.forEach(function(doc) {
    doc.obj.distance = doc.dis;
    entities.push(doc.obj);
  });

  res.json(entities);
});
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-21T02:22:49.167

当前的 (3.8) Mongoose 构建为此提供了一个[`geoNear`](http://mongoosejs.com/docs/api.html#model_Model.geoNear)方法：`Model`

```
Building.geoNear(
    [long, lat], 
    { maxDistance: 300, spherical: true },
    function(err, results, stats) {
        // results is an array of result objects like:
        // {dis: distance, obj: doc}
    }
); 
```

# android - 安卓应用重启

> ID：16156164
> 
> 赞同：0
> 
> 时间：2013-04-22T20:30:45.810
> 
> 标签：android, android-lifecycle

我对 Android 还很陌生，刚刚在 App to Google Play 上发布。我已经彻底测试了适用于 Android 2.3 和 Android 4.0 的应用程序。

我收到了两封来自用户的电子邮件，当他们返回应用程序时，应用程序重新启动到主活动，他们必须重新登录——这对他们来说是一种糟糕的体验。在我的测试过程中我没有检测到这些，当应用程序恢复时它回到了相同的屏幕，不需要登录。我确实从一位用户那里得知他们的手机上安装了 4.1.2，但我不确定与 4.0 相比是否有所改变。

关于为什么应用程序可能从主活动（登录）而不是用户离开的地方开始的任何想法？

在我的代码中，我列出了以下内容，但不要调用这些：

```
public void onStart() {
    super.onStart();
}

public void onRestart() {
    super.onRestart();
}

public void onResume() {
    super.onResume();

}

public void onPause() {
    super.onPause();
}

public void onStop() {
    super.onStop();
}

public void onDestroy() {
    super.onStop();
} 
```

# javascript - JQuery 用复杂的选择器序列化

> ID：16156172
> 
> 赞同：1
> 
> 时间：2013-04-22T20:31:08.900
> 
> 标签：javascript, jquery, forms, serialization

我有要序列化的表格，其中包含表格：

```
<form id="myForm" method="post">
    <table>
        <tr class="hide">
            <td><input /></td>
        </tr>
        <tr>
            <td><input /></td>
        </tr>
        ...
    </table>
</form> 
```

我想使用 JQuery 序列化，但没有类元素中的表单`<tr>`元素`hide`。我试过这个：

```
$('#myForm').not('.hide').serialize() 
```

但是选择器仅在表单元素中`not`查找。`hide`有没有办法检查选择器`<tr>`中类的父最近元素`not`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:34:18.320

要在序列化之前从表单中删除元素，首先克隆表单然后删除不需要的元素并序列化可能更容易：

```
var cloned_form = $('#myForm').clone(false);
    cloned_form.remove('.hide');

var serialized = cloned_form.serialize(); 
```

另一种方法是定位表单内的所有元素，并过滤掉元素内的任何`.hide`内容，如下所示：

```
$('*','#myForm').filter(function() {
    return !$(this).closest('.hide').length;
}).serialize(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T20:36:28.973

我认为你可以这样做：

```
$("#myForm :input:not(.hide input)").serialize(); 
```

# php - CodeIgniter - CI_DB_mysql_result 类的对象无法转换为 int

> ID：16156176
> 
> 赞同：0
> 
> 时间：2013-04-22T20:31:15.667
> 
> 标签：php, codeigniter-2

我有一个看起来像的控制器

```
class Products extends CI_Controller    {

    public function __construct(){
        //
        parent::__construct();
    }   

    public function index() {
        //
        $this->load->model('products_model');
        $data = $this->products_model->getProducts();

        $this->load->view('products',$data);    
    } 
```

}

并使用 Active Record 建模

```
class Products_model extends CI_Model {

    private function getMake()
    {
        $this->db->order_by('make');
        return $this->db->get('manufacturer');
    }

    public function getProducts() {

        $meta_title = "Meta Title";
        $meta_keywords = "keywords";
        $meta_description = "Page description"; 

        $make = array('' => 'Select a make')+$this->getMake();      

        return array("make" => $make, "meta_title" => $meta_title,"meta_keywords" => $meta_keywords,"meta_description" => $meta_description);   

    }
} 
```

还有一个视图，它是一个简单的下拉菜单：

```
<? echo form_dropdown('make',$make,$this->input->post('make')); ?> 
```

上面的整个组合在一行上向我抛出了一个错误“CI_DB_mysql_result 类的对象无法转换为 int”

```
$make = array('' => 'Select a make')+$this->getMake(); 
```

任何线索为什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:43:14.467

你有两个问题。首先，您尝试使用数字运算符将对象与数组连接，其次您尝试将对象用作数组。

你要

```
array_merge(array(''=>'Select a make'), $this->getMake()->result()); 
```

错误的实际原因是`+ $this->getMake()`. 您不能简单地在 PHP 中添加对象，您需要添加对象的属性或值。因为 PHP 不支持这一点，它想，“啊！a `+`！我知道如何处理这些了！让我们把所有东西都变成一个数字！” 所以它接受了结果，`getMake`然后当它发现它与数字无关时非常生气。

您的第二个问题是 CodeIgniter 不返回一个数组，`get`它返回一个结果对象。[您可以在此处找到有关它们](http://ellislab.com/codeigniter/user-guide/database/results.html)的更多信息，但总而言之，您要`result`在尝试将其与数组合并之前调用它。

# javascript - 用于在 html 中替换文本的 Javascript 二维数组

> ID：16156178
> 
> 赞同：1
> 
> 时间：2013-04-22T20:31:20.200
> 
> 标签：javascript, arrays, replace

嘿有一些“简单”的文本替换问题......有一个 html 页面，想用二维字段做一些简单的替换

函数“createArray”没有类似问题的答案，但我无法让它工作：

```
<script type="text/javascript">
 function createArray(length) {
    var arr = new Array(length || 0),
        i = length;

    if (arguments.length > 1) {
        var args = Array.prototype.slice.call(arguments, 1);
        while(i--) arr[length-1 - i] = createArray.apply(this, args);
    }

    return arr;
}

window.onload = function(){
    var tabelle = createArray(14, 2);
        tabelle[0][0]="Comment:Header";     tabelle[0][1]="test";
        tabelle[1][0]="Comment:Lane";       tabelle[1][1]=" ";
        tabelle[2][0]="Comment:VS";         tabelle[2][1]=" ";
        tabelle[3][0]="Comment:Early1";     tabelle[3][1]=" ";
        tabelle[4][0]="Comment:Early2";     tabelle[4][1]=" ";
        tabelle[5][0]="Comment:Early3";     tabelle[5][1]=" ";
        tabelle[6][0]="Comment:Mid1";       tabelle[6][1]=" ";
        tabelle[7][0]="Comment:Mid2";       tabelle[7][1]=" ";
        tabelle[8][0]="Comment:Mid3";       tabelle[8][1]=" ";
        tabelle[9][0]="Comment:Late1";      tabelle[9][1]=" ";
        tabelle[10][0]="Comment:Late2";     tabelle[10][1]=" ";
        tabelle[11][0]="Comment:Late3";     tabelle[11][1]=" ";
        tabelle[12][0]="Comment:etc1";      tabelle[12][1]=" ";
        tabelle[13][0]="Comment:etc2";      tabelle[13][1]=" ";
    for (var i = 0; i < tabelle.length; i++)
        document.body.innerHTML = 
        document.body.innerHTML.replace(tabelle[i][0], tabelle[i][1]);
    };
</script> 
```

thx 已经 ;D

编辑：http: [//jsfiddle.net/kF7kg/](http://jsfiddle.net/kF7kg/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:36:08.910

有关您的错误的更多信息会有所帮助，但我确实注意到您有：

```
for (var i = 0; i <= 14; i++) 
```

而不是正确的：

```
for (var i = 0; i < 14; i++) 
```

甚至更好：

```
for (var i = 0; i < tabelle.length; i++) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T23:16:49.727

我会以不同的方式处理这个问题。

```
var replacements = {
        "Comment:Header": "test",
        "Comment:whatever": "test2",
        // etc..
};
window.onload = function(event) {
    for (var key in replacements) {
        if (replacements.hasOwnProperty(key)) {  
            document.body.innerHTML =
               document.body.innerHTML.replace(key, replacements[key]);
        };
    };
}; 
```

我真的会避免整个麻烦。对于您正在尝试做的事情，有一种更简单、更合适的方法。而且这也是处理此类事情的默认方式。

*   更少的代码。
*   更具可读性。
*   易于维护。
*   易于检查是否存在替代品（`typeof replacements["Comment:whatever"] !== 'undefined'`）。O(1)，不需要转换。无需搜索算法。
*   没有 JS 怪异和无意义的操作。
*   执行速度更快，性能增益可以忽略不计，但存在。
*   可以国际化。

这里是工作小提琴[。](http://jsfiddle.net/LuZxV/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T20:46:19.150

你的代码对我很有用。您遇到的问题是因为您忘记在页面加载后运行脚本。所以你可能会在还没到的`document.body.innerHTML`时候打电话。`document.body`

记得把它们包起来

```
window.onload = function() {
   //doing something here
}; 
```

这是一个工作演示：http: [//jsfiddle.net/9aP86/1/](http://jsfiddle.net/9aP86/1/)

希望能帮助到你。

# c# - 在 PDF 中生成包含列表视图控件的网页时每页两行？

> ID：16156180
> 
> 赞同：0
> 
> 时间：2013-04-22T20:31:27.130
> 
> 标签：c#, asp.net, web-applications

使用下面的代码，当我的 apsx 页面生成为 PDF 页面时，我尝试在列表视图控件的每两行之后分页...但是有些它不起作用..有人可以在这里检查我做错了什么或建议任何其他方法来实现它

```
<asp:ListView ID="ListView1" runat="server"  
    DataSourceID="DS_DvtImages" GroupItemCount="2">
        <ItemTemplate>

            <td id="Td1" runat="server"   class='<%# ((ListViewDataItem)Container).DisplayIndex % 2 == 0 ?  "page-break-before: always" : "" %>'    style="color: #333333; border-style:solid;"  >
                <asp:Image ID="Image1"   runat="server"   ImageUrl='<%# "~/ImageHandler.ashx?MaxHeight=500&MaxWidth=500&AttachmentId=" + Eval("ATTACHMENTID") %>' Height="300px" Width="300px" />
                &nbsp;<br />
                <span  style="width:300px; background-color:Gray">       
          <asp:Label ID="Label1" runat="server" Text='<%# Eval("ATT_name") %>' 
             Font-Size="10pt" ForeColor="Black" Width="100%" />
           </span>
                    </td>

        </ItemTemplate>
    <LayoutTemplate>
            <table id="Table1" runat="server"  class="ListViewMainTable">
                <tr id="Tr1" runat="server">
                    <td id="Td2" runat="server">
                        <table ID="groupPlaceholderContainer" runat="server" border="1"  
                            style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;font-family: Verdana, Arial, Helvetica, sans-serif;">
                            <tr ID="groupPlaceholder" runat="server">
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr id="Tr2" runat="server">
                </tr>
            </table>
      </LayoutTemplate>
        <GroupTemplate>
            <tr ID="itemPlaceholderContainer" runat="server">
                <td ID="itemPlaceholder" runat="server">
                </td>
            </tr>
        </GroupTemplate>
</asp:ListView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T23:10:42.787

page-break-before：始终是样式，而不是类。您必须创建一个样式为 page-break-before: 的类，然后引用该类

# java - 在 Java 中对 Stripes 框架的 Ajax 调用导致请求正文为空

> ID：16156181
> 
> 赞同：0
> 
> 时间：2013-04-22T20:31:30.807
> 
> 标签：java, javascript, jquery, ajax, stripes

环境：运行 Tomcat v7.0 的 Eclipse，使用适用于 Java 的 Stripes 框架，并通过 JQuery ajax 调用提交给服务。

Javascript：

```
jQuery( function(){
jQuery('#testForm').submit( function(e) {
    e.preventDefault();

    var dataString = jQuery('#testInput').val();  //  Pulled from a textarea for testing purposes.
    var urlString = jQuery('#urlDropdown').val();  //  Pulled from a dropdown for testing purposes.
    if( (jQuery('#urlId') != "" )   &&
        (!isNaN(parseInt( jQuery('#urlId').val() )) )   ){  //  Pulled from an input type=text for testing purposes.
        urlString += '?id=' + parseInt( jQuery('#urlId').val() );
    }
    alert("urlString:  " + urlString);
    jQuery.ajax({  
        type: "POST",  
        url: urlString,
        data: dataString,  
        dataType:  'json',
        success: function( returnData ) {  
            jQuery('#content').html(JSON.stringify(returnData));
        },
        fail: function( returnData ) {  
            alert("FAIL");
        }
    });  
});
}); 
```

条纹拦截器：

```
@Before(stages=LifecycleStage.BindingAndValidation, on={"setClient"})
private Resolution intercept() {
    String rbody = getRequestBody();
    log.info("BODY: " + rbody);

    this.setBody( rbody );

    return null;
} 
```

以及正在使用的`getRequestBody`方法：

```
protected String getRequestBody(){
    StringBuffer body = new StringBuffer();
    String line = null;
    try {
        BufferedReader reader = getContext().getRequest().getReader();
        while ((line = reader.readLine()) != null)
            body.append(line);
    } catch (Exception e) {
        log.error("Buffered Reader Failed", e);
        e.printStackTrace();
    }

    log.info("BODY: " + body.toString());
    return body.toString();
} 
```

我正在使用 Firebug 来测试输入，请求的 post body 确实充满了多肉的 json。

那里的`log.info`调用输出一个完全空的字符串。如果我打电话给`getContentLength()`在 getRequest 上调用 ，它会告诉我内容具有适当数量的字符。但内容本身显示为空。

我 99.99% 确信代码中没有其他地方是正在使用的请求正文。目前，这是我在 Stripes 框架中唯一的操作文件，因为我已经删除了所有其他文件。

不知何故，请求正文完全是空的。它应该充满了丰富的json。帮助我，Stack Overflow，你是我唯一的希望！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:33:29.383

感谢 Stripes IRC 频道上的好人，我有答案了！我需要这样添加`contentType: "application/json",`：

```
jQuery.ajax({  
    type: "POST",  
    url: urlString,
    contentType: "application/json",
    data: dataString,
    dataType:  'json',
    processData: false,
    success: function( returnData ) {  
        jQuery('#content').html(JSON.stringify(returnData));
    },
    fail: function( returnData ) {  
        alert("FAIL");
    }
}); 
```

# python - 从文件中读取一行并将其拆分 - python

> ID：16156182
> 
> 赞同：1
> 
> 时间：2013-04-22T20:31:41.553
> 
> 标签：python

我有一个只有 1 行数据的文件（接近 3 MB）我需要将其拆分为更小的行并将输出写入一个新文件。

例如：

> sample.txt - 文件 434D012000100009362D00000000069E0F0007000000DA434D010300100100030080000000000000000000000009C434D01200010000 .... 等等

我想将整行拆分为更小的行，每行 23 个字节。即我如何编写一个python脚本来告诉这么多字符后的break

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:35:47.523

以 23 字节块读取文件：

```
from functools import partial

with open('sample.txt', 'rb') as inputfile, open(outputfilename, 'wb') as output:
    for chunk in iter(partial(inputfile.read, 23), ''):
        # chunk is 23 bytes small
        output.write(chunk + '\n') 
```

在这里，我们使用带有哨兵的[`iter()`函数](http://docs.python.org/2/library/functions.html#iter)`''`来循环函数，直到该函数返回空字符串。我们循环的函数每次都使用参数 23[`functools.partial()`](http://docs.python.org/2/library/functools.html#functools.partial)进行调用。`inputfile.read()`您可以改用 lambda ( `lambda: inputfile.read(23)`)，但`partial()`速度更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:37:00.113

使用函数作为生成器。我非常喜欢[array-module](http://docs.python.org/2.7/library/array.html#module-array)。

```
def bytesfromfile(f):
    while True:
        raw = array.array('c')
        raw.fromstring(f.read(23))
        if not raw:
            break
        yield raw 
```

用于`'c'`将值解释为字符。`'B'`作为无符号字符，即 0-255。

# html - DOCTYPE 标签是怎么来的？

> ID：16156186
> 
> 赞同：-3
> 
> 时间：2013-04-22T20:31:53.183
> 
> 标签：html, doctype

我想知道 DOCTYPE 标签是如何产生的。

我理解标签的目的是提醒浏览器它应该如何呈现 HTML 文档，但我不明白为什么他们为它创建了一个新标签，而不是将这些信息作为 HTML 标签的属性： HTML 标记已经可以采用语言属性。

我认为这可能与预处理有关，因为每个文档的开头都需要文档类型（尽管如果文档类型不存在，HTML 标记将位于文档的开头），但我希望有更多比我自己的猜想更确定的答案。

我尝试在 Google 中使用多个查询来获得答案，但大多数都返回“为什么应该使用 doctype”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:45:02.397

> 我理解标签的目的是提醒浏览器它应该如何呈现 HTML 文档

不。

Doctype 将 SGML 文档与 DTD 相关联。DTD 用于验证（描述在哪里允许哪些元素和属性），以及扩展实体引用。HTML 4.x 及更低版本是 SGML 应用程序。

XML 派生自 SGML，而 Doctype 在 XML 中用于相同目的。XHTML 是一个 XML 应用程序。

确定呈现模式的用途是浏览器供应商试图处理围绕浏览器中的错误设计的网页的一种黑客行为。

HTML 5 重新发明了 Doctype 的用途，以向后兼容呈现模式开关。

> 我不明白为什么他们为它创建了一个新标签，而不是将这些信息作为 HTML 标签的属性

然后，验证器必须先解析 HTML 开始标记，然后才能知道 HTML 开始标记是否被允许在那里，并且必须先解析它，然后才能扩展其属性值中使用的任何实体引用。

# java - 创建和使用自定义 jar 文件的问题

> ID：16156194
> 
> 赞同：1
> 
> 时间：2013-04-22T20:32:26.167
> 
> 标签：java, maven, jar, dependencies

我准备了一些实用类。我计划将它们制作为 jar 并将其分发给所需的项目。

我的 util 类使用一些已经存在的以 jar 文件形式提供的自定义代码。

我的代码依赖于“MainUtil.jar”，内部依赖于 Java Servlet、Commons IO、Commons Codec 等等......

我的 POM 依赖项如下所示。

```
<dependency>
    <groupId>com.solutions</groupId>
    <artifactId>sol-core</artifactId>
    <version>2.3</version>          
</dependency>
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-rt-ws-security</artifactId>
    <version>${cxf.version}</version>
</dependency>
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-rt-ws-policy</artifactId>
    <version>${cxf.version}</version>
</dependency>
<dependency>
    <groupId>org.bouncycastle</groupId>
    <artifactId>bcprov-jdk16</artifactId>
    <version>1.46</version>
</dependency> 
```

当我打包我的罐子时，它看起来很好。

但是当我的 jar 用于使用这些我的 util 类的项目中时，我可能会看到一个奇怪的问题。

commonc-codec jar文件打包时不包含在工程包中。需要此通用编解码器的代码也失败了。

当我明确包含 commons-codec 依赖项时，一切正常。

我的困惑是，当我应该由 Maven 基于自定义 jar 文件的 POM 解决时，为什么要显式添加编解码器依赖项。以及为什么这个问题只发生在 commons-codec 上而不是其他依赖项上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T04:40:31.047

您的代码取决于所有其他 jar。当您为项目创建 jar 时，jar 文件不包含所有依赖的 jar 类。

无论你在哪里使用你的 jar，你都必须使用其他依赖的 jar。你还没有提到你是否也在使用 Maven。如果是，那么如果您定义了依赖项，那么所有依赖的 jar 都将位于类路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T19:20:29.587

你的依赖解决问题是，

您项目中的现有依赖项可能对此 jar 进行了一些依赖项管理。这就是原因，旧 jar 优先于您的自定义 jar 依赖项。尝试在您已经存在的 jar 中为这个通用编解码器 jar 添加排除项。

喜欢

```
<dependency>
 <... Your existing dependency ..>
     <exclusions>
            <exclusion>
                <groupId>commons-codec</groupId>
                <artifactId>commons-codec</artifactId>
            </exclusion>
        </exclusions>
</dependency> 
```

使用此命令并检查您的依赖关系是如何解决的。

```
 mvn dependency:resolve 
```

那么一切都应该没问题。

# delphi - 如何获得笔记本电脑或台式机支持的最大内存大小？

> ID：16156195
> 
> 赞同：2
> 
> 时间：2013-04-22T20:32:26.907
> 
> 标签：delphi, winapi, wmi

我正在使用 Delphi 构建一个软件来获取一些硬件信息，我需要使用 delphi 获取笔记本电脑或台式机支持的最大内存 (RAM) 大小，到目前为止，我一直在寻找 WinApi 或 WMI 函数来获取该信息，但我没有找到任何与此相关的信息。如何获得笔记本电脑或台式机支持的最大内存大小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T21:12:21.237

您可以使用[SMBIOS](http://dmtf.org/standards/smbios)获取该信息，尝试阅读有关[`Physical Memory Array (Type 16)`](http://dmtf.org/sites/default/files/standards/documents/DSP0134_2.8.0.pdf)表的文档。您可以[手动解析和提取 SMBIOS 表](http://theroadtodelphi.wordpress.com/2011/08/02/reading-the-smbios-tables-using-delphi/)或使用类似[TSMBIOS](http://code.google.com/p/tsmbios/)的库。

试试这个使用 TSMBIOS 库的示例。

```
{$APPTYPE CONSOLE}

uses
  Classes,
  SysUtils,
  uSMBIOS in '..\..\Common\uSMBIOS.pas';

function  GetMaxMemoryCapacity : UInt32;
Var
  SMBios : TSMBios;
  LPhysicalMemArr  : TPhysicalMemoryArrayInformation;
begin
  result:=0;
  SMBios:=TSMBios.Create;
  try
      if SMBios.HasPhysicalMemoryArrayInfo then
      for LPhysicalMemArr in SMBios.PhysicalMemoryArrayInfo do
      begin
        if LPhysicalMemArr.RAWPhysicalMemoryArrayInformation.MaximumCapacity<>$80000000 then
          result:=result+(LPhysicalMemArr.RAWPhysicalMemoryArrayInformation.MaximumCapacity*LPhysicalMemArr.RAWPhysicalMemoryArrayInformation.NumberofMemoryDevices)
        else
          result:=result+((LPhysicalMemArr.RAWPhysicalMemoryArrayInformation.ExtendedMaximumCapacity div 1024)*LPhysicalMemArr.RAWPhysicalMemoryArrayInformation.NumberofMemoryDevices);
      end
      else raise Exception.Create('No Physical Memory Array Info was found');
  finally
   SMBios.Free;
  end;
end;

begin
 try
    Writeln(Format('Max Memory Capacity installable %d kb',[GetMaxMemoryCapacity]));
 except
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-22T21:01:02.457

您可以使用[`Win32_PhysicalMemoryArray`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394348%28v=vs.85%29.aspx)WMI 类和 MaxCapacity 属性。

> MaxCapacity ：可为此特定内存阵列安装的最大内存大小（以字节为单位）。如果大小未知，则为该属性指定值 0（零）。

此属性可以以字节或千字节为单位返回大小，因此您必须[`Units`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393650%28v=vs.85%29.aspx)在使用它之前检查该属性的限定符。

试试这个样本

```
{$APPTYPE CONSOLE}

uses
  SysUtils,
  ActiveX,
  ComObj,
  Variants;

function  GetQualifierValue(Const NameSpace, ClassName, PropName, QualifName : string) :string;
const
  wbemFlagUseAmendedQualifiers = $00020000;
Var
  Properties        : OleVariant;
  Qualifiers        : OleVariant;
  rgvarProp         : OleVariant;
  rgvarQualif       : OleVariant;
  objSWbemLocator   : OleVariant;
  objSWbemObjectSet : OleVariant;
  objWMIService     : OleVariant;
  EnumProps         : IEnumVariant;
  EnumQualif        : IEnumVariant;
  pceltFetched      : Cardinal;
  Lindex            : Integer;
begin
  Result:='';
  objSWbemLocator  := CreateOleObject('WbemScripting.SWbemLocator');
  objWMIService    := objSWbemLocator.ConnectServer('localhost', NameSpace, '', '');
  objSWbemObjectSet:= objWMIService.Get(ClassName, wbemFlagUseAmendedQualifiers);
  Properties := objSWbemObjectSet.Properties_;
  EnumProps         := IUnknown(Properties._NewEnum) as IEnumVariant;
  while EnumProps.Next(1, rgvarProp, pceltFetched) = 0 do
  begin
    if SameText(rgvarProp.Name, PropName) then
    begin
      Qualifiers      := rgvarProp.Qualifiers_;
      EnumQualif     := IUnknown(Qualifiers._NewEnum) as IEnumVariant;
      while EnumQualif.Next(1, rgvarQualif, pceltFetched) = 0 do
      begin
        if SameText(QualifName, rgvarQualif.Name) then
        begin
           if not VarIsNull(rgvarQualif.Value)  then
            Result:=rgvarQualif.Value;
           Break;
        end;
        rgvarQualif:=Unassigned;
      end;
      Break;
    end;
    rgvarProp:=Unassigned;
  end;
end;

function  GetMaxMemoryCapacity : UInt32;
var
  FSWbemLocator : OLEVariant;
  FWMIService   : OLEVariant;
  FWbemObjectSet: OLEVariant;
  FWbemObject   : OLEVariant;
  oEnum         : IEnumvariant;
  iValue        : LongWord;
  UnitsName     : string;
begin;
  Result:=0;
  FSWbemLocator := CreateOleObject('WbemScripting.SWbemLocator');
  FWMIService   := FSWbemLocator.ConnectServer('localhost', 'root\CIMV2', '', '');
  UnitsName     := GetQualifierValue('root\CIMV2','Win32_PhysicalMemoryArray','MaxCapacity','Units');
  FWbemObjectSet:= FWMIService.ExecQuery('SELECT MaxCapacity,MemoryDevices FROM Win32_PhysicalMemoryArray','WQL',$00000020);
  oEnum         := IUnknown(FWbemObjectSet._NewEnum) as IEnumVariant;
  while oEnum.Next(1, FWbemObject, iValue) = 0 do
  begin
    if SameText('kilobytes', UnitsName) then
     Result:=Result+(UInt32(FWbemObject.MaxCapacity)*UInt32(FWbemObject.MemoryDevices))
    else
     Result:=Result+((UInt32(FWbemObject.MaxCapacity) div 1024)*UInt32(FWbemObject.MemoryDevices));
    FWbemObject:=Unassigned;
  end;
end; 
```

# c# - 突然关机时 XML 文件数据丢失

> ID：16156203
> 
> 赞同：2
> 
> 时间：2013-04-22T20:33:25.333
> 
> 标签：c#, shutdown, xelement

我有一个应用程序，它使用 XElement 对象的 .Save("path") 方法每 500 毫秒将数据存储在 XML 文件中。问题是：当突然关机时，文件的内容被删除，所以下次运行应用程序时该文件无法使用。

如何防止/确保数据不会丢失？PS：我在 Windows 7 下使用 .NET 2010 C#

我做了一个实验：每次都没有写入我创建的同一个 data.xml 文件（通过从原始文件复制）一个新文件，并且当从 data.xml 文件复制时断电时它会损坏所有以前创建的文件?!?!?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T20:35:23.510

假设您的文件是`data.xml`. 不要一直写入，而是写入`data.xml`临时文件`data.xml.tmp`，完成后将其重命名为`data.xml`. 但是如果您已经有一个文件，重命名将不起作用`data.xml`，因此您需要先将其删除，然后重命名临时文件。

这样，`data.xml`将包含最后的安全数据。如果您突然关机，不完整的文件将是临时的`data.xml.tmp`. 如果您的程序稍后尝试读取文件并且没有`data.xml`文件，则意味着在删除和重命名操作之间发生了关闭，因此您将不得不读取临时文件。我们知道它是安全的，否则会有一个`data.xml`文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T20:35:38.107

您可以使用两阶段提交：

1.  将新 XML 写入具有不同名称的文件
2.  删除旧文件
3.  将新文件重命名为旧名称

这样，总会有至少一个完整的文件。
如果您重新启动，并且标准名称不存在，请检查不同的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-19T09:36:22.597

这可能是一个生命的救星，但只需付出更多的努力。应该有一个单独的过程

*   每当文件更新时，自动备份到其存储区。
*   它在内部维护一个链表中的两个版本。
*   如果文件被更新，那么最新的应该被更新到，并且可以删除`HEAD using linkedList.AddFirst()`指向的最小版本。`TAIL``linkedList.RemoveLast()`
*   当然，它应该在启动期间扫描并加载有关存储中可用的最新版本的存储。

在硬关机的情况下，下次系统启动时，这个进程应该检查文件是否有效/损坏。如果损坏，则`HEAD`使用`FileChanged`简单的`FileSystemWatcher`.

这种方法经过了很好的测试。

**看到的问题**

*   如果在更新时发生硬关机`HEAD`怎么办？-- 好吧，我们在旁边的藏匿处有另一个版本`HEAD`
*   如果在更新`HEAD`存储为空时发生硬关机怎么办？- 我们知道文件在更新时是有效的`HEAD`。该进程将在下次启动时再次尝试复制，因为它没有损坏。
*   如果存储为空且文件已损坏怎么办？——这是死坑，没有解决办法。但这种情况只有在文件损坏发生后部署此恢复过程时才会发生。

# html - 标签末尾的翡翠注释

> ID：16156204
> 
> 赞同：0
> 
> 时间：2013-04-22T20:33:26.073
> 
> 标签：html, pug

我想知道是否可以在输出文件中的 html 标记末尾添加翡翠注释。

例子：

```
<div class="header">
   ....
</div> <!-- ./this comment --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T06:40:35.710

可能不是一个好主意。但如果你真的想要它，只需在 div 之后添加注释即可。它不会与`</div>`. 它会向管道发送更多的 html，因此我不建议将其用于生产用途。

```
.header
    hello
//./header 
```

如果您使用`//-`注释，它不会进入浏览器的视图源。对私人评论很有用。

# javascript - 使用 Jquery 进行动态 onchange

> ID：16156205
> 
> 赞同：-2
> 
> 时间：2013-04-22T20:33:29.490
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery 在文本字段中动态填充 onChange 属性以运行多个函数。但是我在控制台中收到错误说明

```
TypeError: required is not a function 
```

当我输入控制台时需要（'test'）；该函数存在并返回true。

HTML

```
 <input id="test"> 
```

jQuery

```
var list_of_functions = get_validation(); //this returns a string "required('test'); valid('test');"  
$('#test').attr('onChange', list_of_functions); 
```

然后，当我去更改字段文本时，我收到一个错误，该函数不存在。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T15:17:10.137

感谢所有超级有用的评论。我找到了一个更好的选择来代替我试图做的事情。 [如何将字符串转换为 javascript 函数调用？](https://stackoverflow.com/questions/912596/how-to-turn-a-string-into-a-javascript-function-call)

# android - 调试不在 Play 商店中的 android 应用程序（日志收集）

> ID：16156210
> 
> 赞同：1
> 
> 时间：2013-04-22T20:34:01.170
> 
> 标签：android, debugging, logcat

我已经向大约 5-10 位我的好朋友发布了一个 Android 应用程序来测试它。我刚刚向他们发送了我的 .apk 文件。问题是，当它崩溃时（经常发生，因为我处于开发早期）我无法查看日志。如果我已将应用程序发布到 Google Play，他们将能够按“发送错误报告”，然后我可以在我的 Google Play 开发者帐户中看到它。在这种第三方应用程序开发环境中，是否有任何简单的方法可以从这些崩溃中获取日志？

我唯一能想到的就是让他们安装[一个Logcat](https://play.google.com/store/apps/details?id=org.jtb.alogcat)，然后给我发一个日志。但这显然很麻烦。特别是对于非技术用户。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T20:38:41.140

使用 Android 应用程序崩溃报告[http://acra.ch/](http://acra.ch/)

由于 Google Docs 遗留表单已完全停止， [http://www.bugsense.com/docs/android#acra](http://www.bugsense.com/docs/android#acra)似乎是作为后端的不错选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:37:05.997

您可以将其发布在 Play 商店中，然后`Unpublish`就可以了。这样您就可以使用相同的功能，而不会让不受欢迎的人偶然发现它。

当您觉得该应用程序已准备就绪时，您可以简单地再次发布它。

编辑：

请注意，这`Unpublish`不会从商店中删除您的应用，只会使其不可见，但您仍然可以通过 URL 浏览到 Play 商店列表。

编辑2：

要查看`Unpublished`应用程序，请附加您的包 ID：

```
https://play.google.com/store/apps/details?id=<package_id> 
```

# sql-server - 身份插入的 SQL 算术溢出

> ID：16156214
> 
> 赞同：1
> 
> 时间：2013-04-22T20:34:12.870
> 
> 标签：sql-server, sql-insert, identity-column, unique-index, ignore-duplicates

我在将行 ID 设置为 TINYINT 数据类型的查找表中插入值时出现算术溢出错误。这不是唯一记录数超过 255 个值的情况。这有点不寻常，并且在此设置的第一次测试期间没有发生。

下面代码的生产版本实际上只有 66 个唯一值，但随着时间的推移，可能会添加新值（缓慢且数量非常少）...... 255 个可用插槽对于这个生命周期来说应该绰绰有余分析过程。

我最初的想法是，这可能是由于缓存计划识别分层源表具有超过 255 个值（实际上有 1028 个），并评估这可能超出目标表的容量。然而，我已经测试过这是不正确的。

```
-- This table represents a small (tinyint) subset of unique primary values.
CREATE TABLE #tmp_ID10T_Test (
ID10T_Test_ID tinyint identity (1,1) not null,
ID10T_String varchar(255) not null
PRIMARY KEY CLUSTERED
(ID10T_String ASC)
WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = ON, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON)
) ON [PRIMARY]

-- This table represents a larger (smallint) set of non-unique source values, defined by a secondary key value (Value_Set).
CREATE TABLE #tmp_ID10T_Values (
ID10T_Value_ID smallint identity (1,1) not null,
ID10T_Value_Set tinyint not null,
ID10T_String varchar(255) not null
) ON [PRIMARY]

-- Create the initial dataset - 100 unique records; The insertion tests below illustrate that the INDEX is working
--  correctly on the primary key field for repetative values, however something is happening with the IDENTITY field...
DECLARE @ID10T tinyint
, @i tinyint -- A randomized value to determine which subset of printable ASCII characters will be used for the string.
, @String varchar(255)

SET @ID10T = 0
WHILE @ID10T < 100
    BEGIN

    SET @String = ''
        WHILE LEN(@String) < (1+ROUND((254 * RAND(CHECKSUM(NEWID()))),0))
        BEGIN
            SELECT @i = (1 + ROUND((2 * RAND()),0)) -- Randomize which printable character subset is drawn from.
            SELECT @String = @String + ISNULL(CASE WHEN @i = 1 THEN char(48 + ROUND(((57-48)* RAND(CHECKSUM(NEWID()))),0))
            WHEN @i = 2 THEN char(65 + ROUND(((90-65) * RAND(CHECKSUM(NEWID()))),0))
            WHEN @i = 3 THEN char(97 + ROUND(((122-97) * RAND(CHECKSUM(NEWID()))),0))
            END,'-')
        END

    INSERT INTO #tmp_ID10T_Values (ID10T_Value_Set, ID10T_String)
    SELECT 1, @String

    SET @ID10T = @ID10T + 1

    END

-- Demonstrate that IGNORE_DUP_KEY = ON works for primary key index on string-field
 SELECT * FROM #tmp_ID10T_Values

-- Method 1 - Simple INSERT INTO: Expect Approx. (100 row(s) affected)
INSERT INTO #tmp_ID10T_Test (ID10T_String)
SELECT DISTINCT ID10T_String
FROM #tmp_ID10T_Values
GO

-- Method 2 - LEFT OUTER JOIN WHERE NULL to prevent dupes.
--  this is the test case to determine whether the procedure cache is mixing plans
INSERT INTO #tmp_ID10T_Test (ID10T_String)
SELECT DISTINCT T1.ID10T_String
FROM #tmp_ID10T_Values AS T1
LEFT OUTER JOIN #tmp_ID10T_Test AS t2
ON T1.ID10T_String = T2.ID10T_String
WHERE T2.ID10T_Test_ID IS NULL
GO

-- Repeat Method 1: Duplicate key was ignored (0 row(s) affected).
INSERT INTO #tmp_ID10T_Test (ID10T_String)
SELECT DISTINCT ID10T_String
FROM #tmp_ID10T_Values
GO 
```

这似乎不是查询计划缓存问题 - 如果这是真的，我应该会看到方法 1 重新测试的算术错误。

```
-- Repeat Method 1: Expected: Arithmetic overflow error converting IDENTITY to data type tinyint.
INSERT INTO #tmp_ID10T_Test (ID10T_String)
SELECT DISTINCT ID10T_String
FROM #tmp_ID10T_Values
GO 
```

我特别好奇为什么会抛出异常。我可以理解，在方法 1 中测试了所有 100 个唯一值......因此可以想象，查询代理在第二次插入尝试后看到了 200 条记录的潜力；我不明白为什么它会在第三次重复后看到 300 条记录的潜力——第二次尝试导致 0 行，所以最多可能有 200 个唯一值。

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:47:58.890

使用 IGNORE_DUP_KEY 的事件序列是：

1.  记录已准备好插入，包括 IDENTITY 值的消耗。这使得 IDENTITY 序列上升到 200
2.  记录被插入。观察到 IGNORE_DUP_KEY 并且插入失败

现在，您失败的一批 INSERT 实际上会生成 IDENTITY 值 201-300，超过 255 的任何值都会溢出您的`tinyint`列。

通过运行可以轻松验证这一点

```
select ident_current('tmp_ID10T_Test') 
```

自由地贯穿你的代码。因此，对于您的代码，注释如下：

```
-- Method 1 - Simple INSERT INTO: Expect Approx. (100 row(s) affected)
   -- ident_current = 1

-- Method 2 - LEFT OUTER JOIN WHERE NULL to prevent dupes.
   -- ident_current = 100
   -- NOTE: The SELECT doesn't produce any rows. No rows to insert

-- Repeat Method 1: Duplicate key was ignored (0 row(s) affected).
   -- ident_current = 200
   -- NOTE: SELECT produced 100 rows, which consumed IDENTITY numbers. Later ignored

-- Repeat Method 1: Expected: Arithmetic overflow error converting IDENTITY to data type tinyint.
   -- ident_current = 255
   -- error raised when IDENTITY reaches 256 
```

# java - 为什么在对 LinkedList 使用 add() 和 getFirst() 时出现此错误？

> ID：16156216
> 
> 赞同：1
> 
> 时间：2013-04-22T20:34:28.890
> 
> 标签：java

这是我的代码：

```
public class FlightMap implements FlightMapInterface {

LinkedList<City> cityList = new LinkedList<City>();
LinkedList<City> nextCity = new LinkedList<City>();

/**
 * Creates an empty FlightMap
 */
public FlightMap() {        
}

public void loadFlightMap(String cityFileName, String flightFileName)
        throws FileNotFoundException {

    File cityList = new File(cityFileName);
    File flightsTo = new File (flightFileName);

    Scanner theCityFile = null;
    Scanner theFlightFile = null;
    Scanner theRequestFile = null;

    ArrayList<String> cityStringList = new ArrayList<String>();
    int counter = 0;

    try {
        theCityFile = new Scanner (cityList);
        theFlightFile = new Scanner (flightsTo);
    }
    catch (FileNotFoundException e) {
        System.out.println("No such file exists.");
    }

    while (theFlightFile.hasNextLine()) {
        cityStringList.add((theFlightFile.nextLine()).replaceAll("\t", ""));
    }

    while (theCityFile.hasNextLine()) {
        LinkedList<City> tempList = new LinkedList<City>();
        String tempCity = theCityFile.nextLine();
        nextCity.add(tempList); // ERROR
        nextCity.get(counter).add(new City(tempCity)); // ERROR

        for (int x = 0; x < cityStringList.size(); x++) {
            if (cityStringList.get(x).charAt(0) == tempCity.charAt(0)) {
                insertAdjacent(nextCity.get(counter).getFirst(), // ERROR
                        new City(cityStringList.get(x)).charAt(1) + "");  // ERROR
            }
        }
        cityList.add(new City(tempCity)); // ERROR
        counter++;
    }
} 
```

对于我的错误：

*   线程“main”java.lang.Error 中的异常：未解决的编译问题：
*   LinkedList 类型中的方法 add(City) 不适用于参数 (LinkedList)
*   未定义 City 类型的 add(City) 方法
*   未定义 City 类型的 getFirst() 方法
*   charAt(int) 方法未为 City 类型定义

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:39:20.340

您不能`add()`列出您的`LinkedList<City>`- 它的元素必须是 type `City`，而不是 type `List<City>`。你可以`addAll`改用。然后，您尝试`add`a `City`to your `City`，而不是 to your `List`- 显然`City`没有`Add`方法。`getFirst`与 the和 the -类似，`charAt`您一直将`City`对象视为`List`s 或`String`s。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T20:37:45.543

正是错误所说的。

```
LinkedList<City> tempList = new LinkedList<City>();
String tempCity = theCityFile.nextLine();
nextCity.add(tempList); 
```

应该是

```
String tempCity = theCityFile.nextLine();
nextCity.add(tempCity); 
```

您试图将 a 添加`LinkedList`到另一个`LinkedList`. 您只能将类型`City`的“节点”添加到`LinkedList`您声明的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T20:39:41.650

首先 nextCity 的类型是 LinkedList<City> 所以你不能添加一个 LinkedList 到它：

```
nextCity.add(tempList); 
```

改用：

```
nextCity.addAll(tempList); 
```

同样的问题是：

```
nextCity.get(counter).add(new City(tempCity)); 
```

您正在获取城市并再次向其中添加城市。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T20:38:00.167

你正在尝试做一些没有意义的事情，所以你会得到这些错误。

> LinkedList 类型中的方法 add(City) 不适用于参数 (LinkedList)

您正在尝试将城市列表添加到城市列表。

> 未定义 City 类型的 add(City) 方法

您正在尝试将城市添加到城市（而不是城市列表，并且您还没有定义这样的方法。

> 未定义 City 类型的 getFirst() 方法 未定义 City 类型的 charAt(int) 方法

你还没有定义这些方法，所以你不能调用它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-22T20:38:28.303

在此代码中：

```
 LinkedList<City> tempList = new LinkedList<City>();
    String tempCity = theCityFile.nextLine();
    nextCity.add(tempList); 
```

您正在尝试将错误状态 添加`LinkedList<City>`到您的列表中。`nextCity`

# c# - 用 HtmlAgilityPack 包裹一个元素？

> ID：16156217
> 
> 赞同：2
> 
> 时间：2013-04-22T20:34:30.517
> 
> 标签：c#, html-agility-pack

我有一个`HtmlDocument`可能或可能有一个适当的`<head>`和`<body>`部分，或者可能只是一个 html 片段。无论哪种方式，我都想通过一个函数来运行它，以确保它具有（更多）正确的 html 结构。

我知道我可以通过查看是否有身体来检查它是否有身体

```
doc.DocumentNode.SelectSingleNode("//body"); 
```

一片空白。如果它没有正文，我将如何将 doc.DocumentNode 的内容包装在一个`<body>`元素中并将其分配回`HtmlDocument`？

**编辑：**我想做什么似乎有些困惑。在 jquery 方面：

```
$doc = $(document);
if( !$doc.has('body') ) {
    $doc.wrapInner('body');
} 
```

基本上，如果没有 body 元素，则在所有内容周围放置一个 body 元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T08:14:23.303

你可以这样做：

```
HtmlDocument doc = new HtmlDocument();
doc.Load(MyTestHtm);
HtmlNode body = doc.DocumentNode.SelectSingleNode("//body");
if (body == null)
{
    HtmlNode html = doc.DocumentNode.SelectSingleNode("//html");
    // we presume html exists

    body = CloneAsParentNode(html.ChildNodes, "body");
}

static HtmlNode CloneAsParentNode(HtmlNodeCollection nodes, string name)
{
    List<HtmlNode> clones = new List<HtmlNode>(nodes);
    HtmlNode parent = nodes[0].ParentNode;

    // create a new parent with the given name
    HtmlNode newParent = nodes[0].OwnerDocument.CreateElement(name);

    // insert before the first node in the selection
    parent.InsertBefore(newParent, nodes[0]);

    // clone all sub nodes
    foreach (HtmlNode node in clones)
    {
        HtmlNode clone = node.CloneNode(true);
        newParent.AppendChild(clone);
    }

    // remove all sub nodes
    foreach (HtmlNode node in clones)
    {
        parent.RemoveChild(node);
    }
    return newParent;
} 
```

# ember.js - 通过与 EmberData 和 rails API 的简单关系嵌套路由？

> ID：16156218
> 
> 赞同：1
> 
> 时间：2013-04-22T20:34:39.360
> 
> 标签：ember.js, ember-router

我想我已经关闭了 Ember 的嵌套资源（主详细信息）。但我试图通过`has_many`我的数据中的关系将嵌套更深一层。我使用 EmberData 和 Rails 作为 API，我相信它可以按预期设置和工作。但是在我的模板和路由器中嵌套一层让我很难过，我似乎找不到那里的例子......

这是我当前的路由器（我认为使用 RC1）：

```
EmberGallery.Router.map(function() {
  this.resource('uploads', function() {
    this.resource('upload', { path: ':upload_id' });
  });
  this.resource('collections', function() {
    this.resource('collection', { path: ':collection_id' });
    this.route('new');
  });
}); 
```

产生：

```
/#/uploads/1
/#/collections/1 
```

不错，厉害 但是在我的应用程序中上传了一个集合`has_many`，所以我试图访问这个 url (master-detail-detail)：

```
/#/collections/1/2 
```

id:1 是`collection_id`（其中包含一堆上传，这很好用）

id:2 是一个`upload_id`（我该怎么做？）

我的路由器会是什么样子？这还需要什么才能起作用？

编辑：我正在添加我的收藏模板，该模板显示并链接到属于单个收藏的上传内容。基本上这会正确显示相关的上传，但链接会将我带回到 #/uploads/1 而不是 #/collections/1/2 （2 是集合 1 中的上传）。显然我的链接是错误的，但我怀疑我真正的问题是我正在拉取收藏的上传不正确。

模板/collection.js.hbs

```
<aside class="span8">
  <header>
  <h4>Collection: {{title}}</h4>
  </header>
  <ul class="thumbnails">
      {{#each upload in uploads}}
        <li class="span3">
          <aside class="thumbnail">
         {{#linkTo 'upload' this}}<img {{bindAttr src="upload.url"}} alt="{{upload.title}}">{{/linkTo}}
          {{title}}
          </aside>
        </li>
      {{/each}}
  </ul>
</aside>
<article class="span4">
  {{outlet}}
</article> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T23:27:07.737

你必须让你的路由`collections.collection`成为拥有这种 url 的资源。去做这个：

```
EmberGallery.Router.map(function() {
    this.resource('uploads', function() {
        this.resource('upload', { path: ':upload_id' });
    });
    this.resource('collections', function() {
        this.resource(
            'collection',
            { path: ':collection_id' },
            function() {
                this.route('upload', { path: ':upload_id' });
            }
        );
        this.route('new');
    });
}); 
```

您将隐式创建路线`collection.index`（不是）。`collections.collection.index`url`/collections/1/2`将定位到 route `collection.upload`。

# jquery - Chrome contenteditable 插入符号对齐

> ID：16156220
> 
> 赞同：2
> 
> 时间：2013-04-22T20:34:41.927
> 
> 标签：jquery, html, css

我在为 Chrome 使用 contenteditable 时遇到问题。我在 span 的 onmouseover 事件上使用了 contenteditable 属性和一些填充。当跨度集中（编辑）时，插入符号在 Chrome 中测试时与跨度的底部边框对齐，在 Firefox 上很好。

HTML

```
<div>
    Some <span onmouseover="this.contentEditable=true;">Editable</span> Text
</div> 
```

CSS

```
[contenteditable]:focus {
    background: rgba(255,220,0,0.3);
    padding: 10px;
} 
```

[在这里](http://jsfiddle.net/ZE8mn/)提琴

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T06:57:44.463

添加`display: inline-block`到跨度

```
[contenteditable]:focus {
    background: rgba(255,220,0,0.3);
    padding: 10px; 
    display: inline-block;
} 
```

# javascript - 从 TinyMCE 的对话框中获取输入字段值

> ID：16156221
> 
> 赞同：12
> 
> 时间：2013-04-22T20:34:45.157
> 
> 标签：javascript, tinymce

全部。

我很难弄清楚这一点，这是我第二次需要用 tinyMCE 做某事，但这次我找不到答案。

这就是我想要做的：我在我的编辑器上添加了一个按钮，它打开一个带有单个文本输入字段和一个按钮的新弹出窗口。我想单击按钮并获取我在输入字段中设置的值，然后使用该值来修改我在编辑器中的内容。

这是我到目前为止所拥有的 - 只有相关的代码：

```
 init : function( ed, url ) {
        ed.addCommand( 'mceTooltip', function() {
            ed.windowManager.open({
                file: 'imageurl.html',
                width: 480,
                height: 180,
                inline: 1,
                title: 'Please enter an image URL'
            }, {});
        });
    } 
```

这就是 imageurl.html 所具有的：

```
<input type="text" id="image-url" />
<input type="button" id="submit-image-url" value="Ok" /> 
```

所以，我需要做的是在我单击“确定”按钮时获取任何“image-url”文本输入，并在我的编辑器中使用该文本。我知道我可以使用 ed.selection.setContent( fieldValue )，它会用 image-url 值替换我选择的文本，我只是不知道如何获取 image-url 值。

我能找到的最详细的信息是[http://www.tinymce.com/wiki.php/How-to_implement_a_custom_file_browser](http://www.tinymce.com/wiki.php/How-to_implement_a_custom_file_browser)但我不能让它满足我的需要。谁能帮我解决这个问题？我敢肯定，对于在这方面有更多经验的人来说，这应该很简单。

谢谢大家的关注。

****更新了 imageurl.html ******

 **```
 <script>
            document.getElementById( 'submit-image-url' ).onclick = function(){
                var imageUrl = document.getElementById( 'image-url' ).value;

                window.parent.tinyMCE.activeEditor.execCommand( 'mceInsertContent', 0, imageUrl );
                window.parent.tinyMCEPopup.close(); // this line gets me this error: "Uncaught TypeError: Cannot read property 'windowManager' of undefined "
            };
        </script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T07:25:07.247

好吧，这应该不难。

在 imageurl.html 底部的脚本标签中发出此问题，或使用文档就绪的 javascript 函数。以下将为您的按钮添加一个 onclick 处理程序，该处理程序将获取 image_url 并将其写入 tinymces 选择。

```
$('#submit-image-url').bind('click', function(){
    var image_url = $('#image-url').val();

    // in case you are using a real popup window
    window.opener.tinymce.activeEditor.selection.setContent(image_url);

    // in case you use a modal dialog
    tinymce.activeEditor.selection.setContent(image_url);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-30T08:27:02.687

您已经打开了一个窗口，因此您当前位于具有 imageurl.html 的 IFrame 中。

你要做的是

在父页面上创建一个全局类型的变量，例如

```
var image_url = ""; 
```

现在在 imageurl 页面上像这样在正文部分创建一个脚本

```
<body>
<script>
$("#button").click(function(){
window.parent.image_url = $('image-url').val();
});
</script>
</body> 
```

确保你在 imgurl 上有 jquery。或以其他方式使用 addeventlistener 或 attachevent 方法

逻辑是从 iframe 中获取父窗口的元素并从 iframe 中保存它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-01T15:48:50.823

好的，我发现了问题。我必须在 imageurl.html 中包含 tiny_mce_popup.js，这就是 tinyMCEPopup.close() 不起作用的原因：

```
 <script type="text/javascript" src="js/tinymce/tiny_mce_popup.js"></script>
    <script>
        document.getElementById( 'submit-image-url' ).onclick = function(){
            var imageUrl = document.getElementById( 'image-url' ).value;

            tinyMCEPopup.execCommand( 'mceInsertContent', 0, imageUrl );
            tinyMCEPopup.close();
        };
    </script> 
```

我错误地认为它正在加载，因为我能够看到弹出窗口。

本来我并不想修改imageurl.html，但看起来这只是它必须完成的方式......

无论如何，我已经知道如何从 imageurl.html 文件中解决其中一些任务，并且我已经看到 tinyMCEPopup 有一个 close() 方法，但为了公平起见，我会接受我的人的回答感觉更积极地试图帮助我。

感谢大家。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-17T17:18:16.940

最终的代码会喜欢 this.working ...

```
imageurl.html

<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="tiny_mce_popup.js"></script>
</head>
<body>
    <input type="text" id="image-url" />
<input type="button" id="submit-image-url" value="Ok" />
    <script>
        document.getElementById( 'submit-image-url' ).onclick = function(){
            var imageUrl = document.getElementById( 'image-url' ).value;

            tinyMCEPopup.execCommand( 'mceInsertContent', 0, imageUrl );
            tinyMCEPopup.close();
        };
    </script>
</body>
</html> 
```**

# node.js - NodeJS net.Socket on("data") 数据未刷新

> ID：16156223
> 
> 赞同：0
> 
> 时间：2013-04-22T20:34:56.297
> 
> 标签：node.js, sockets

我在每个线路事件上都收到相同的消息。我收到每条消息的 1 个事件。任何人都知道为什么。这似乎是直截了当的。

```
var rli = require("readline").createInterface({
    input: socket,
    output: socket,
    terminal: false
});
rli.on("line", handleServerMessage);
function handleServerMessage(msg) {
    console.log("Received msg from from server. msg=", msg);
} 
```

# css - 如何根据移动设备更改 CSS？

> ID：16156225
> 
> 赞同：23
> 
> 时间：2013-04-22T20:35:01.857
> 
> 标签：css, mobile, responsive-design

在以下示例中，我只想显示一个`div`，具体取决于设备。

我熟悉如何使用`@media`来覆盖 CSS 类，但不熟悉如何执行条件。

```
<style type="text/css">
   @media (max-width : 770px) {
     ...
   }

  @media (max-width : 320px) {
   ...
  }
  //do I need another for the desktop?
</style>

//if desktop
<div style="width: 400px; float: left;">
    this is desktop
    <a href="somepage.html"><img src="aLargeImage.png"/></a>
</div>

//if mobile
<div style="width: 200px; float: left;">
    this is mobile
    <a href="somepage.html">just text</a>
</div> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-22T23:18:29.193

这是一个示例，说明如何在没有 javascript 的情况下有条件地完成它：

```
//CSS
.visibledevice {display:none;}
.visibledesktop {display:display;}

@media (max-width : 320px) {
    .visibledevice {display:block;}
    .visibledesktop {display:none;}
}

//in the page
<div class="visibledesktop">this displays for desktop and tablet</div>

<div class="visibledevice">this displays for mobile</div> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-22T20:41:03.450

嗯，我认为创建 2 个或更多 css 文件并通过基于设备的 javascript 加载它们更容易。onload 函数内部的类似内容：

```
var cssPath = "standard.css";
if (navigator.platform == "iPad")
    cssPath = "iPad.css";

var fileref = document.createElement("link");

fileref.setAttribute("rel", "stylesheet");
fileref.setAttribute("type", "text/css");
fileref.setAttribute("href", cssPath);

document.getElementsByTagName("head")[0].appendChild(fileref); 
```

更短、更易读的 css 文件易于交换。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-24T00:09:28.267

如何进行条件 css 媒体查询：

```
@media only screen and (width : 1024px) and (orientation : landscape) {    
    .selector1 { width:960px; }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-11-23T22:52:04.587

在这种简单的情况下，这就是您所需要的：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

尝试使用例如`width:100%`或`max-width`- 而不是固定宽度。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-19T20:48:10.250

我知道这是一个旧线程，但我想出了一个更好的选择.. 至少对我来说

```
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=1">
<?php 
if(preg_match('/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i',$useragent)||preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i',substr($useragent,0,4)))
{   echo '<link type="text/css" rel="stylesheet" media="all" href="/styles/mobile.css">';
}
else{
echo '<link type="text/css" rel="stylesheet" media="all" href="/styles/desktop.css">';
};
?> 
```

# javascript - 将 sType 设置为动态 jquery 数据表上的所有 aoColumns

> ID：16156230
> 
> 赞同：0
> 
> 时间：2013-04-22T20:35:29.317
> 
> 标签：javascript, jquery, datatable

我正在研究一个巨大的自定义数据表函数，我有一个简单的问题，我需要将“sType”设置为所有“aoColumns”，但这些表是动态的，所以它们可能有 6 或 10 列，我可以找不到办法，我已经尝试了以下选项：

```
//doesn't work
"aoColumns": [{"sType":"string", "aTargets": ["_all"]}],

//this works, but its not dynamic :/
"aoColumns": [{"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}], 
```

我不能使用服务器端来做到这一点

**obs.: 我有一个列数的 var**

```
6 columns
"aoColumns": [{"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}],
10 columns
"aoColumns": [{"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}, {"sType":"string"}], 
```

不管怎么说，还是要谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:52:38.853

服务器端 PHP：好吧，如果您在 php 中创建表，那么您应该能够构建一个包含所有需要的数组部分的字符串，您可以将其插入 javacript。

```
<?php
$colnum = 6;
$i = 1;

$aocolumns = array();

while($i <= $colnum){
  $aocolumns[] = '{"sType":"string"}';
  $i++;
}

$aocolumns = join(",",$aocolumns);
$aocolumns = '[' . $aocolumns . ']';

?> 
```

然后像

```
"aoColumns": <?=$aocolumns?> 
```

Javascript：假设您从 ajax 获取列作为称为“cols”的数组，您可以尝试这个 for 循环。：

```
var aocolumns = [];
for(i in cols){
  var ao = {"sType":"string"}; 
  aocolumns.push(ao);
}
alert(aocolumns); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-08T16:56:10.610

其他答案比他们需要的更复杂。

**Javascript版本：**

```
var i, aoColumns = [];
for (i = 0; i < totalCol; i++) {
  aoColumns.push( { 'sType': 'string' } );
} 
```

**ECMAScript 6 版本：**

```
aoColumns.fill( { 'sType': 'string' }, 0, totalCol ) 
```

`array.fill`如果您使用的任何库中的 JavaScript 命令存在 polyfill，这可能适用于您的浏览器。

**PHP（服务器端）版本：**

```
<?php
//  array( 'stype' => "string" ); for old PHP
$columns = 6;
$aoColumns = array_fill( 0, $columns, [ 'stype' => 'string' ] );
print json_encode($aoColumns);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:20:31.317

我通过使用 parseJSON 并将字符串转换为 JSON 解决了​​这个问题：

```
aoColumns = '[{"sType":"string"}';
i = 0;
tc = totalCol;
while(i<tc){
    aoColumns += ',';
    aoColumns += '{"sType":"string"}';
    i++;
}
aoColumns += ']';

// if totalCol == 3 then
// aoColumns will return [{"sType":"string"}, {"sType":"string"}, {"sType":"string"}]
aoColumns = $.parseJSON(aoColumns); 
```

这行得通！

# wpf - 显示问题数据网格

> ID：16156232
> 
> 赞同：0
> 
> 时间：2013-04-22T20:35:32.073
> 
> 标签：wpf

我遇到了一个问题：如果列标题的名称中有一个点，则它不会显示该列中单元格的值。

如何在不更改列名称的情况下解决此问题？

```
var ds = new DataSet();
            var dataPylons = new DataTable();
            ds.Tables.Add(dataPylons);

foreach (var i in pylonItem)
            {
                cl = new DataColumn(i.Code + "\n" + i.Sheme, typeof(string));
                dataPylons.Columns.Add(cl);
            }

// In the cycle fill cell 
dataPylons.Rows[i][j] =...;
...
DataGridPylons.ItemsSource = ds.Tables[0].DefaultView; 
```

错误示例： [https ://docs.google.com/file/d/0B3wJRn2hp50hTm9uX2FkRUg1dTQ/edit?usp=sharing](https://docs.google.com/file/d/0B3wJRn2hp50hTm9uX2FkRUg1dTQ/edit?usp=sharing)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T00:17:40.977

Datagrid 列遵循与 SQL 列命名标准相同的标准，如下所示：http: [//msdn.microsoft.com/en-us/library/ms175874.aspx](http://msdn.microsoft.com/en-us/library/ms175874.aspx)

你需要坚持这一点。

# c# - 使用 WebBrowserControl 发送客户端证书

> ID：16156238
> 
> 赞同：0
> 
> 时间：2013-04-22T20:35:42.540
> 
> 标签：c#, webbrowser-control

我有一个应用程序需要在 WebBrowser 控件中托管一个网页（来自第 3 方）。

为了访问 Web 应用程序，我需要动态添加客户端证书。我需要在这里实现类似解决方案的东西：[https](https://stackoverflow.com/a/2066735/67038) ://stackoverflow.com/a/2066735/67038但使用 WebBrowser 控件（该示例使用 System.Net.WebClient）

# java - 重新设计面向个人的 OOP 拆分组合接口

> ID：16156241
> 
> 赞同：0
> 
> 时间：2013-04-22T20:35:47.973
> 
> 标签：java, oop, architecture, polymorphism

我试图了解如何以一种干净且“可设计”的方式避免重复输入以下场景：

```
public interface ICommandAble
{ }

public interface ILogAble extends ICommandAble
{ }

public interface IMonitorAble extends ICommandAble
{ }

public abstract class ClassAbs
{ }

public class A extends ClassAbs implements IMonitorAble, ILogAble
{ } 
```

**测试方法：**

```
public void test()
{
   A a=new A();
   List<ICommandAble>commandList=new ArrayList<ICommandAble>()
   if (a instanceof ILogAble)
   {
       ILogAble logAbleItem=(ILogAble)a;
       commandList.add(logAbleItem);
   }
   if (a instanceof IMonitorAble) {
       IMonitorAble monitorAbleItem=(IMonitorAble)a;
       commandList.add(monitorAbleItem);
   }
   for(ICommandAble item: commandList)
   {
        if(item instanceof IMonitorAble)
        {
          log.debug("is monitorable");
        }
        if(item instanceof ILogAble)
        {
          log.debug("is logable");
        }
} 
```

输出是：

> 2013-04-22 18:25:00,498 com ... [DEBUG] 是可监控的
> 
> 2013-04-22 18:25:02,150 com.... [DEBUG] 是可登录的
> 
> 2013-04-22 18:25:08,322 com.... [DEBUG] 是可监控的
> 
> 2013-04-22 18:25:08,977 com.... [DEBUG] 是可登录的

这将导致我的程序对每个“xAble”执行双重执行

我希望看到：

> 2013-04-22 18:25:00,498 com ... [DEBUG] 是可监控的
> 
> 2013-04-22 18:25:02,150 com.... [DEBUG] 是可登录的

我应该如何重新设计这个（以一种干净的方式）第二个迭代器条件将基于引用类型而不是实例类型。得到这样的东西：

```
2013-04-22 18:25:00,498 com... [DEBUG] is monitorable

2013-04-22 18:25:02,150 com.... [DEBUG] is logable 
```

*   认为将来我可能会有更多的“能力”

谢谢，雷。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:44:10.723

由于您只是将项目添加到 中`List`，因此您可以更改代码以验证它是否是 的实例`ICommandAble`，如下所示：

```
if (a instanceof ICommandAble) {
   commandList.add(a);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:57:51.543

这是因为您`a`两次添加到 commandList 中，一次是可记录的，另一次是可监控的。

您应该将 2 个 if 语句合并为 1 个：

```
if (a instanceof ILogAble || a instanceof IMonitorAble)
{
    commandList.add(a);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:21:10.303

如果您正在测试对象以查看它们是否是接口的实例，那么它们必须实现该接口。他们也总是可以实现其他接口。在您的场景中，要实现所需的输出，您必须使对象仅实现两个接口之一。

```
public class Test {
  public interface ICommandAble {
  }

  public interface ILogAble extends ICommandAble {
  }

  public interface IMonitorAble extends ICommandAble {
  }

  public abstract class ClassAbs {
  }

  public class A extends ClassAbs implements IMonitorAble, ILogAble {
  }

  public class B extends ClassAbs implements IMonitorAble {
  }

  public class C extends ClassAbs implements ILogAble {
  }

  public void test() {
    A a = new A();
    B b = new B();
    C c = new C();
    List<ICommandAble> commandList = new ArrayList<ICommandAble>();
    commandList.add(a); // Remove this line to just get the two printouts.
    commandList.add(b);
    commandList.add(c);
    for (ICommandAble item : commandList) {
      if (item instanceof IMonitorAble) {
        System.out.println(item.getClass().getSimpleName() + " is monitorable");
      }
      if (item instanceof ILogAble) {
        System.out.println(item.getClass().getSimpleName() + " is logable");
      }
    }
  }

  public static void main(String args[]) {
    new Test().test();
  }
} 
```

印刷

```
A is monitorable
A is logable
B is monitorable
C is logable 
```

我也在`A`列表中添加了一个来展示差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T02:56:55.253

将实例添加到哈希集而不是列表中，这样即使添加了多次，实例也会出现一次

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:21:13.063

正如其他答案已经解释的那样，你想要的东西是不可能的。您将需要使用多个列表。您可以在 Map 中组织此列表以使其更易于维护，但也许您应该重新考虑您的设计。

这是一种轻松使用多个列表的方法：

```
public interface ICommandAble {}

public interface ILogAble extends ICommandAble {}

public interface IMonitorAble extends ICommandAble {}

public abstract class ClassAbs {}

public class A extends ClassAbs implements IMonitorAble, ILogAble {}

public List<ICommandAble> getList(LinkedHashMap<Class<? extends ICommandAble>, List<ICommandAble>> commandList,
        Class<? extends ICommandAble> clazz) {
    if (commandList.get(clazz) != null)
        return commandList.get(clazz);
    ArrayList<ICommandAble> l = new ArrayList<>();
    commandList.put(clazz, l);
    return l;
}

public void test() {
    A a = new A();
    LinkedHashMap<Class<? extends ICommandAble>, List<ICommandAble>> commandList = new LinkedHashMap<>();

    if (a instanceof ILogAble)
        getList(commandList, ILogAble.class).add(a);

    if (a instanceof IMonitorAble)
        getList(commandList, IMonitorAble.class).add(a);

    for (Class<? extends ICommandAble> clazz : commandList.keySet())
        for (ICommandAble item : commandList.get(clazz)) {
            if (clazz.equals(IMonitorAble.class))
                log("is monitorable");
            if (clazz.equals(ILogAble.class))
                log("is logable");
        }
} 
```

# c++ - 如何将代码直接运行到带有文件系统的处理器中？

> ID：16156242
> 
> 赞同：0
> 
> 时间：2013-04-22T20:35:53.567
> 
> 标签：c++, filesystems, fpga

我有一个简单的各向异性过滤器 c/c++ 代码，它将处理一个 .pgm 图像，该图像是一个文本文件，每个像素都有灰度信息，完成处理后，它将生成一个应用了过滤器的输出图像。

该程序需要几秒钟才能在运行窗口的 x86 CPU 上进行大约 10 次迭代。

我和一个完成应用计算硕士学位的学者，我们需要在 FPGA（Altera DE2-115）下运行代码，看看直接在处理器（NIOS 2）上运行代码是否有相当大的性能提升。

我们已经成功启动了FPGA下的SO uClinux，但是设备硬件出现了一些错误，导致我们无法访问SD-Card甚至以太网，所以我们无法将代码和图像导入FPGA中为了测试它的性能。

因此，我在这里寻求一种替代方法，将我们的代码性能直接测试到具有文件系统的 CPU 中，以便代码可以读取图像并生成另一个图像。

另一种选择可以是使用成本低且易于使用的产品（我在想树莓派），或者如果我可以将代码上传到自动运行的地方并给我报告。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:58:02.800

what you're trying to do is benchmarking some software on a multi GHz x86 Processor vs. a soft-core processor running 50MHz? (as much as I can tell from Altera docs) I can guarantee that it will be even slower on the FPGA! Since it is also running an OS (even embedded Linux) it also has threading overhead and what not. This can not be considered running it "directly" on CPU (whatever you mean by this)

If you really want to leverage the performance of an FPGA you should "convert" your C-Code into a HDL and run it directly in hardware. Accessing the data should be possible. I don't know how it's done with an Altera board but Xilinx has some libraries accessing data from a SD card with FAT.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T01:14:55.760

您可以使用板载 SRAM 或 DDR2 RAM 来运行操作系统和您的应用程序。FPGA 中的硬件设计必须有内存控制器。在 SOPC 或 Qsys 中选择外部存储器作为复位向量并编译设计。

然后打开 Eclipse 的 NioSII 构建工具。在 Eclipse 中，通过选择 NiosII Application 和 BSP 项目来创建新项目。创建项目后，转到 BSP 属性并在链接器选项卡中键入外部存储器的偏移量并生成 BSP。编译项目并作为 Nios II 硬件运行。这将通过外部存储器运行您的应用程序。您将无法看到图像，但可以在控制台上打印表示内存中图像的二维数组。

# excel - Excel VBA 代码提交多个用户表单数据以填充工作表

> ID：16156244
> 
> 赞同：0
> 
> 时间：2013-04-22T20:35:59.127
> 
> 标签：excel, matching, userform, vba

编码超级新手，请帮助并请原谅缺乏一般知识：

VBA中是否有等效的匹配函数？

我有一个用户表单，其中包含以下内容： - 用于选择员工姓名的组合框 - 用于选择项目编号的组合框 - 用于输入工作时间的文本框 - 用于输入加班时间的文本框

在名为“输入模板”的 Sheet2 上，我有一张需要保持这种格式的工作表：项目编号从 B11 行开始，员工姓名从 A12 列垂直开始。每个名称都是重复的，以允许 RegHrs 和 OTHrs。

例子：

```
 Project 1     Project 2   Project 3 
```

能源部，简

注册时间

* * *

能源部，简
OTHrs

* * *

史密斯，约翰
RegHrs

* * *

史密斯，
约翰

我需要用户表单中的“提交时间”命令按钮，并将选定的数据填充到相应的列/行中的工作表中。例如，如果条目是 Doe, Jane Project 2, 40 RegHrs 6 OT Hrs。我如何编写代码，以便在单击提交时将简的工作时间填充到正确的位置？

我还需要它来清除用户表单，以便他们可以输入下一个员工的工作时间，直到他们完成并关闭。

我希望这不会太混乱。感谢大家的帮助~~~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:15:45.060

因此，您将在 UserForm**提交时间**命令按钮*Click 事件*中编写的代码需要执行以下操作：

1.  声明变量
2.  将 Userform 字段（文本框和组合框）的值放入变量中。
3.  找到正确的项目和正确的人名，并确定是常规时间还是 O/T 时间
4.  基于上述，插入值
5.  清除用户窗体字段

您知道，您可以使用左列中的行标题和上面的列标题添加命名范围以使其更容易。

*   要了解如何在 Excel VBA 中使用变量，请参阅[Ozgrid：在宏代码中使用变量](http://www.ozgrid.com/VBA/variables.htm)
*   要了解如何在 Excel VBA 中使用**Find ，请参阅**[Siddharth Rout (Excel MVP) - Find in VBA](http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/)
*   要了解 VBA 中的 Excel 对象模型，请参阅MSDN 库：Excel 对象模型和MSDN 库[的超级简单指南](http://msdn.microsoft.com/en-us/library/office/aa203714%28v=office.11%29.aspx)[：引用单元格和范围](http://msdn.microsoft.com/en-us/library/office/aa221536%28v=office.11%29.aspx)
*   要了解 Excel VBA 中的工作单元格和范围，请参阅[MSDN 库：使用单元格和范围 [Excel 2003 VBA 语言参考]](http://msdn.microsoft.com/en-us/library/office/aa272263(v=office.11).aspx)
*   要了解 Excel VBA 中的用户窗体和控件，请参阅[Chandoo.org：VBA 中的用户窗体和控件](http://chandoo.org/wp/excel-vba/user-forms/)

因此，在您**编写了一些代码**后，如果您需要帮助，请联系我们

以下是一些其他网站供您阅读：

*   Excel MVP 站点：[上下文 Excel](http://www.contextures.com/tiptech.html)
*   Excel VBA 网站：[Chip Pearson](http://www.cpearson.com/Excel/Topic.aspx)
*   Excel MVP 网站：[Ron De Bruin](http://www.rondebruin.nl/win/section9.htm)
*   电子表格先生 (John Walkenbach)：[电子表格页面](http://spreadsheetpage.com/index.php/tips)
*   Excel先生：[Excel先生网站](http://www.mrexcel.com/)
*   Charley Kydd Excel MVP: [Excel User dot Com](http://exceluser.com/explore/index.htm)
*   McGimpsey & Associates Excel MVP 网站[J.E. McGimpsey 的 XL 页面](http://www.mcgimpsey.com/excel/index.html)

祝你好运

菲利普

# python - 如何将一列字符串添加到 numpy 字符串矩阵？

> ID：16156247
> 
> 赞同：1
> 
> 时间：2013-04-22T20:36:09.713
> 
> 标签：python, string, matrix, numpy

我有一个字符串矩阵。如何在前面添加一列，例如

```
[['a','b'],   ==>   [['e','a','b'],
 ['c','d'],          ['e','c','d'],
 ['a','b'],   ==>    ['e','a','b'],
 ['c','d'],          ['e','c','d'],
 ['a','b'],   ==>    ['e','a','b'],
 ['c','d']]          ['e','c','d']] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T03:25:06.273

[@Paul 评论中](https://stackoverflow.com/questions/5064822/numpy-how-to-add-items-into-an-array/5068182#5068182)的答案说明了一切。为了完整起见，在此处添加。

```
In [1]: a = np.tile(np.array([["a","b"], ["c","d"]]), (3,1))

In [2]: a 
Out[2]: array([['a', 'b'],
       ['c', 'd'],
       ['a', 'b'],
       ['c', 'd'],
       ['a', 'b'],
       ['c', 'd']], 
      dtype='<U1')

In [3]: e = np.tile("e", a.shape[0])[None].T # REF: https://stackoverflow.com/a/11885718/155813

In [4]: e 
Out[4]: array([['e'],
       ['e'],
       ['e'],
       ['e'],
       ['e'],
       ['e']], 
      dtype='<U1')

In [5]: np.hstack([e, a]) 
Out[5]: array([['e', 'a', 'b'],
       ['e', 'c', 'd'],
       ['e', 'a', 'b'],
       ['e', 'c', 'd'],
       ['e', 'a', 'b'],
       ['e', 'c', 'd']], 
      dtype='<U1') 
```

# c# - 错误：“T”必须是具有公共无参数构造函数的非抽象类型才能将其用作参数“T”

> ID：16156248
> 
> 赞同：4
> 
> 时间：2013-04-22T20:36:12.137
> 
> 标签：c#, generics

我正在尝试实现一个接受泛型 T 并返回 T 列表的方法。

```
 public static List<T> GetMessages<T>(string query, int count, SqlConnection sqlconnection)
        where T : ITable, new()
    {
        List<T> messages = new List<T>();
        List<T> errorMessages = new List<T>();

        DataSet response = DBUtils.ExecuteQueryScriptWithConnection(query, sqlconnection);

        for (int i = 0; i < response.Tables[0].Rows.Count; ++i)
        {
            T message = new T();

            DataRow row = response.Tables[0].Rows[i];
            message.Id = Convert.ToInt32(row[0]);
            message.CreatedDate = Convert.ToDateTime(row[1]);                
        }

        return messages;
    } 
```

但是当我从另一个方法调用它时，我得到了错误：

> “T”必须是具有公共无参数构造函数的非抽象类型，以便在泛型类型或方法“”中将其用作参数“T `CIHelpers.TableHelpers.GetMessages<T>(string, int, System.Data.SqlClient.SqlConnection)`”

我从中调用的代码：

```
 List<T> messages = TableHelpers.GetMessages<T>(query, 1000, sqlconnection); 
```

实现 ITable 的类（我传递的类型 T 在这里。

```
public class MessageReceived : ITable
{
    public int Id { get; set; }
    public DateTime CreatedDate { get; set; }

    string query = String.Format(@"select Id, CreatedDate, from MessageReceived where createddate > '2013-04-18 00:00:00.0000000'");

    public MessageReceived()
    {

    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T20:37:37.317

调用代码中的`T`需要具有相同的约束。

否则，有人可能会使用`T`没有构造函数的 a 来调用您的包装函数。

# powershell - 使用 powershell 安装 topshelf 服务

> ID：16156249
> 
> 赞同：5
> 
> 时间：2013-04-22T20:36:19.600
> 
> 标签：powershell

我正在尝试使用 powershell 安装 topshelf 服务，但我真的很难让 powershell 运行安装程序。

```
Function EnsureTopshelfService([string]$serviceName, [string]$servicePath){
    $service = get-service $serviceName -ErrorAction SilentlyContinue 
    if ($service –ne $null){
        "$serviceName is already installed on this server";
    }
    else{
        Write-Host "Installing $serviceName...";

        #the problem is here
        & "`"$servicepath`" install --sudo"
    }
} 
```

当我运行此命令时，我得到以下信息

> 安装 test... & : 术语 '"c:\A Test\Test.exe" install --sudo' 未被识别为 cmdlet、函数、脚本文件或可运行程序的名称。检查名称的拼写，或者如果包含路径，请验证路径是否正确并重试。在 C:\Users\luke.mcgregor\Documents\Test.ps1:11 char:11 + & " `"$servicepath`" install --sudo" + ~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~ + CategoryInfo : ObjectNotFound: ("c:\A Test\Test.exe" install --sudo:String) [], CommandNotFoundException + FullyQualifiedErrorId : CommandNotFoundException

在命令提示符下运行`"c:\A Test\Test.exe" install --sudo`可以正常工作，因此这是我如何调用现有程序的问题。有谁知道我要去哪里错了？我对powershell很陌生，所以我猜它是一件非常简单的事情。

**编辑：** 以下是上述的工作示例

```
Function EnsureTopshelfService([string]$serviceName, [string]$servicePath){
    $service = get-service $serviceName -ErrorAction SilentlyContinue 
    if ($service –ne $null){
        "$serviceName is already installed on this server";
    }
    else{
        Write-Host "Installing $serviceName...";

        & "$servicepath" install --sudo
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T22:03:53.627

您需要通过用空格分隔来进行标记。所以 -

```
& "`"$servicepath`" install --sudo" 
```

应该是 3 个令牌 -

```
& $servicepath install --sudo 
```

与号是 PowerShell 调用运算符。它之后的任何内容都与您在 CMD.exe 窗口中键入它一样。如果单个标记中有空格，则需要引用它。

[在此处](http://ss64.com/ps/call.html)查看有关呼叫运营商的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-17T05:34:43.300

如果您不喜欢 (weird/crazy/take-your-pick) 语法，请在参数名称和值之间添加一个冒号。

因此，假设您使用 topshelf 构建了 EXE，`C:\Services\ItJustWorks\ItJustWorks.exe`那么您可以从 powershell 运行以下命令：

```
PS C:\Services\ItJustWorks> .\ItJustWorks.exe install -servicename:"ItJustWorks" 
```

# eclipse - Eclipse cvs 合并问题，合并充当比较

> ID：16156255
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:02.147
> 
> 标签：eclipse, merge, cvs

我该如何解决这个合并问题？

我的项目有 1 个分支，用于生产和负责人。2次将生产分支合并到头部。每次我在合并后创建一个标记的头，以便为下一次合并提供一个起点。需要注意的是，我不会在每次合并后创建新分支，而是重用分支。

问题是，如果我尝试将我的分支合并到头部。即使文件头版本大于文件分支版本，eclipse cvs 的行为就像它正在比较所有文件并将其列为“要更新”。

例如：头文件版本是 1.8，分支文件版本是 1.6。此文件已在上次合并中合并。尝试合并时，我将上次合并后创建的 head 标签指定为“通用基础版本”。尽管如此，eclipse cvs 还是建议覆盖 head 修改并使用分支版本。此行为适用于所有文件。

我不知道该怎么办。我不想手动合并数百个文件。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T20:22:53.873

看例子：

```
 |tag_h1    |tag_h2
 -----------------------------------------> trunk
      \          ^           ^
       \        /           /
        \----------------------------------> my_branch
              |tag_b1      |tag_b2 
```

在分支上有标签`tag_b1`，并且`tag_b2`在每次合并之前，在主干中，标签`tag_h1`和`tag_h2`.

对于从分支到主干的下一次合并，Eclipse 的“通用基础版本”将是带有`tag_b2`. 使用 CVS 更新，如果您指定两个参数，您将在您的工作目录中合并这两个参数之间的修改。给出`Branch or version to be merged (end tag)=my_branch`并将`Common base version (start tag)=tag_b2`合并从`tag_b2`直到`my_branch`结束的更改，例如从命令行调用 CVS：

`$ cvs up -j tag_b2 -j my_branch`

我总是从我将合并的位置以及合并之前和之后标记，如下所示：

```
 |tag_before        |tag_after
---------------------------------> 
                    ^
                   /
    ------------------------------>
               |tag_from 
```

给标签一个我能识别的名字。

# python - 如何避免在python中舍入浮点数？

> ID：16156259
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:10.090
> 
> 标签：python, json, floating-point

我有一些 json 对象，当我将它们转换为 python 中的字典时，它们会四舍五入：

```
-112.07393329999999  ->  -112.0739333 
```

我的代码是：

```
for line in open("c:\\myfile","r+").readlines():          
     d = json.loads(line)
     logtv = d['logtv'] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T20:39:20.927

它只是相同（二进制，64 位）数字的更紧凑表示。

```
In [12]: -112.07393329999999 == -112.0739333
Out[12]: True

In [17]: struct.pack('d', -112.0739333)
Out[17]: 've\xbcR\xbb\x04\\\xc0'

In [18]: struct.pack('d', -112.07393329999999)
Out[18]: 've\xbcR\xbb\x04\\\xc0' 
```

如果您想要这个精确的小数，则无法在 JSON 中将其表示为数字。您必须在 JSON 中使用字符串，在 python 中使用小数/字符串，在数据库中使用小数字段。

[SQL Server 浮点数最多也是 64 位（53 位有效位）。](http://msdn.microsoft.com/en-us/library/ms173773.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T20:51:58.443

答案是不要使用浮点数。在大多数语言中，浮点数只有大约 6 位有效数字，对于双精度数并没有太多（注意 python 浮点数是双精度数）。如果您知道确切的精度，请使用小数。对于 JSON，将其作为字符串或带隐含小数点的 int 发送。

**肥皂盒**：花车被过度使用了。任何你不会用科学记数法表示的东西都不应该使用浮点数，因为那是它们真正的底层。

*注意*：数据库通常不使用浮点数，它们使用定点数。这正是小数的含义。

**澄清**

在编写 json 文件之前，请执行以下操作

```
with  open("c:\\myfile","w") as my_file:
    for key in d:
        if isinstance(d[key], Decimal):
            d[key] = str(d[key])
    my_file.write(json.dumps(d)) 
```

然后在读取 json 时，您可以将值按原样放入数据库中，或者如果您需要更多地使用它，可以将其转换回 Decimal。

# mysql - 有人可以帮我优化这个mysql语句吗？

> ID：16156260
> 
> 赞同：3
> 
> 时间：2013-04-22T20:37:12.557
> 
> 标签：mysql, subquery, correlated-subquery, in-subquery

我有一张表，用于在我的数据库中构建组。该表包含组名称和 ID 的列表。我有另一个包含用户的表，以及显示关系的第三个表。（用户标识，组标识）。

情况是这样的，我需要创建一个属于特定组子集的用户 ID 列表。例如，我想要组 1、3 和 8 中的所有用户。这很简单。但它变得更加复杂，我可能需要一个包含在组 1、3 和 8 或 1、2 和 8 中的所有用户的列表。然后我可能需要排除符合该标准但也在组中的用户27.

所以我有一个脚本动态地创建一个查询，使用子查询在一定程度上起作用。我有两个问题。我认为我没有正确处理非部分，因为当我广告标准时，最终它只是有点挂起。（我认为这是我使用子选择而不是连接的结果，但我无法弄清楚如何使用连接来构建它。）

下面是一个带有 4 个 ANDed OR 组和 2 个 NOT 子句的查询示例。

请让我知道是否有更好的方法来优化这个 stmt。（我可以在 PHP 中处理它的动态构建）

如果我需要澄清任何事情或提供更多细节，请告诉我。

```
 select * from users_table where username IN
(
    select user_id from
    (
        select distinct user_id from group_user_map where user_id in 
        (
            select user_id from 
            (
                select * from 
                (
                    select count(*) as counter, user_id from  
                    (
                        (
                            select distinct(user_id) from group_user_map where group_id in (2601,119)
                        ) 
                        union all
                        (
                            select distinct(user_id) from group_user_map where group_id in (58,226)
                        ) 
                        union all
                        (
                            select distinct(user_id) from group_user_map where group_id in (1299,525)
                        ) 
                        union all
                        (
                            select distinct(user_id) from group_user_map where group_id in (2524,128)
                        ) 
                    ) 
                    thegroups group by user_id
                ) 
                getall where counter = 4
            ) 
            getuserids
        ) 
        and user_id not in 
        (
            select user_id from group_user_map where group_id in (2572)
        ) 
    ) 
    biggergroup 
); 
```

请注意，查询的第一部分是将 id 与用户名进行比较。这是因为我将用户名存储为另一个表中的 id。（这整个事情是两个完全不同的数据库之间的链接）。

（另外，如果看起来我有任何额外的子查询，那就是试图强制 mysql 首先评估内部查询。）

谢谢。

亚伦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T20:22:32.323

如果您发布表结构和一些示例数据，将更容易理解您的问题。但这里有一些基于您当前查询的建议，您可能可以使用它们。

这些查询减少了您正在使用的子查询的数量。一个明显的变化是它获取`user_id`每个组的 's 列表的方式不同：

```
select user_id
from group_user_map 
where group_id in (2601,119)
union all
select user_id 
from group_user_map 
where group_id in (58,226)
union all
select user_id 
from group_user_map 
where group_id in (1299,525)
union all
select user_id 
from group_user_map 
where group_id in (2524,128); 
```

这使用`UNION ALL`将列出所有的，`user_id`即使它们是重复的。一旦你有了这个`user_id`'s 列表，你就可以`count`通过应用 a`count(distinct user_id)`并使用`HAVING`子句来查找那些出现 4 次的 's 。

首先，您可以将当前查询合并到`WHERE`子句中的以下版本：

```
select * 
from users_table 
where username IN (select user_id
                  from
                  (
                    select user_id
                    from group_user_map 
                    where group_id in (2601,119)
                    union all
                    select user_id 
                    from group_user_map 
                    where group_id in (58,226)
                    union all
                    select user_id 
                    from group_user_map 
                    where group_id in (1299,525)
                    union all
                    select user_id 
                    from group_user_map 
                    where group_id in (2524,128)
                  ) thegroups
                  where user_id not in (select user_id 
                                        from group_user_map 
                                        where group_id in (2572)) 
                  group by userid
                  having count(distinct userid) = 4); 
```

`WHERE`或者，您可以在您加入的子查询中使用该子句中的查询：

```
select ut.* 
from users_table ut
inner join
(
  select user_id
  from
  (
    select user_id
    from group_user_map 
    where group_id in (2601,119)
    union all
    select user_id 
    from group_user_map 
    where group_id in (58,226)
    union all
    select user_id 
    from group_user_map 
    where group_id in (1299,525)
    union all
    select user_id 
    from group_user_map 
    where group_id in (2524,128)
  ) thegroups
  where user_id not in (select user_id 
                        from group_user_map 
                        where group_id in (2572)) 
  group by userid
  having count(distinct userid) = 4
) biggergroup
  on ut.username = biggergroup.user_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T09:15:26.620

避免用于 IN 子句的子选择：-

```
SELECT * 
FROM users_table
INNER JOIN 
(
    SELECT Sub1.user_id 
    FROM (
            SELECT COUNT(*) AS counter, user_id   
            FROM (
                SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2601,119)
                UNION ALL
                SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (58,226)
                UNION ALL
                SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (1299,525)
                UNION ALL
                SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2524,128)
            ) thegroups
            GROUP BY user_id
            HAVING counter = 4
    ) Sub1
    LEFT OUTER JOIN (SELECT user_id FROM group_user_map WHERE group_id IN (2572)) Sub2
    ON group_user_map.user_id = Sub2.user_id
    WHERE Sub2.user_id IS NULL
) Sub3
ON  users_table.username = Sub3.user_id 
```

或者避免使用 COUNT 来检查所有 4 个表中是否存在用户 ID，而是使用内部联接

```
SELECT * 
FROM users_table
INNER JOIN 
(
    SELECT Sub1.user_id 
    FROM (
        SELECT z.user_id   
        FROM (
            SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2601,119)) z
            INNER JOIN
            (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (58,226)) y ON z.user_id = y.user_id
            INNER JOIN
            (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (1299,525)) x ON z.user_id = x.user_id
            INNER JOIN
            (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2524,128)) w ON z.user_id = w.user_id
    ) Sub1
    LEFT OUTER JOIN (SELECT user_id FROM group_user_map WHERE group_id IN (2572)) Sub2
    ON group_user_map.user_id = Sub2.user_id
    WHERE Sub2.user_id IS NULL
) Sub3
ON  users_table.username = Sub3.user_id 
```

稍微清理一下第二个查询

```
SELECT * 
FROM users_table
INNER JOIN 
(
    SELECT z.user_id   
    FROM (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2601,119)) z
    INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (58,226)) y 
    ON z.user_id = y.user_id
    INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (1299,525)) x 
    ON z.user_id = x.user_id
    INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2524,128)) w 
    ON z.user_id = w.user_id
    LEFT OUTER JOIN (SELECT user_id FROM group_user_map WHERE group_id IN (2572)) Sub2
    ON z.user_id = Sub2.user_id
    WHERE Sub2.user_id IS NULL
) Sub3
ON  users_table.username = Sub3.user_id 
```

在下面的评论中使用您的 SQL，可以将其清理为：-

```
select SQL_NO_CACHE id 
from users_table 
INNER JOIN ( SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (0, 67) ) ij1 
ON users_table.username = ij1.user_id 
LEFT OUTER JOIN ( SELECT user_id FROM group_user_map WHERE group_id IN (0) ) Sub2 
ON users_table.username = Sub2.user_id 
WHERE Sub2.user_id IS NULL 
```

以同样的方式清理我的 SQL：-

```
SELECT users_table.* 
FROM users_table
INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2601,119)) z ON users_table.username = z.user_id
INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (58,226)) y ON users_table.username = y.user_id
INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (1299,525)) x ON users_table.username = x.user_id
INNER JOIN (SELECT distinct(user_id) FROM group_user_map WHERE group_id IN (2524,128)) w ON users_table.username = w.user_id
LEFT OUTER JOIN (SELECT user_id FROM group_user_map WHERE group_id IN (2572)) Sub2 ON users_table.username = Sub2.user_id
WHERE Sub2.user_id IS NULL 
```

删除子选择并直接进行连接（可能有帮助或有阻碍，怀疑这取决于每组 group_id 记录有多少重复的 user_id 记录）

```
SELECT DISTINCT users_table.* 
FROM users_table
INNER JOIN group_user_map z ON users_table.username = z.user_id AND z.group_id IN (2601,119)
INNER JOIN group_user_map y ON users_table.username = y.user_id AND y.group_id IN (58,226)
INNER JOIN group_user_map x ON users_table.username = x.user_id AND x.group_id IN (1299,525)
INNER JOIN group_user_map w ON users_table.username = w.user_id AND w.group_id IN (2524,128)
LEFT OUTER JOIN group_user_map Sub2 ON users_table.username = Sub2.user_id AND Sub2.group_id IN (2572)
WHERE Sub2.user_id IS NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-28T02:14:18.487

当您说“我想要组 1、3 和 8 中的所有用户”然后写下时，您的意思并不完全清楚

```
select distinct(user_id) from group_user_map where group_id in (58,226) 
```

因为英语建议您需要一个同时属于所有三个组的用户，但 SQL 会为您提供属于任一组中的用户。所以你需要更清楚你到底想要什么。

有点难以相信您正在尝试查找所有 4 个超级组中的用户，每个超级组正好由 2 个组组成。这让我质疑你在做什么以及为什么。

根据您真正要遇到的情况，我可以想到几种不同的方法。显然，最简单的方法是将其分解为多个查询并将结果组合到您的代码中。如果组表不太大，您可以自动加入组表，但可能太大而无法加入 3 次。你可能会得到`NOT EXISTS`比 with更好的性能，`NOT IN`但可能不会。您可以尝试进一步利用聚合函数和`CASE`函数来计算中间表中的成功值，但这变得非常疯狂。更有可能你最好重新设计你的数据结构。

我看到您现有解决方案的主要问题是您创建的大量临时表。通常，您将需要某种临时表来执行如此复杂的操作，因此我将专注于将其限制为两个表，每个表都小于关系表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-02T11:36:04.970

这是正确的查询吗

```
 select * from users_table where username IN    
            (
(select distinct(user_id) from group_user_map where group_id in (2601,119)) a 
inner join
(select distinct(user_id) from group_user_map where group_id in (58,226)) b 
on a.user_id = b.user_id inner join 
(select distinct(user_id) from group_user_map where group_id in (1299,525)) c 
on a.user_id = c.user_id inner join 
(select distinct(user_id) from group_user_map where group_id in (2524,128)) d
on a.user_id = d.user_id 
)  and user_id  not in (select user_id from group_user_map where group_id in (2572)) 
```

我没有将所有联合并最终使用计数器为 4 进行过滤，而是替换为相交。请检查结果是否正确并且运行速度快？

维尼特

# svn - 从命令行将 svn:externals 设置为存储库 url

> ID：16156261
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:21.700
> 
> 标签：svn, svn-externals, svn-propset

我试图从命令行将 svn externals 直接设置为存储库 url。我想知道是否有办法在不检查工作副本的情况下完成此操作

谢谢怡保多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-05T01:43:43.627

您可以尝试命令**svnmucc**。它可以完全满足您的需求。该链接是[http://svnbook.red-bean.com/en/1.8/svn.ref.svnmucc.re.html](http://svnbook.red-bean.com/en/1.8/svn.ref.svnmucc.re.html)。

根据上面的链接，用法是：

**道具**名称值 URL

将目标 URL 上的属性 NAME 的值设置为 VALUE。

**propsetf**名称文件 URL

将目标 URL 上的属性 NAME 的值设置为文件 FILE 的内容。

# java - Java - 反向选择排序

> ID：16156262
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:28.813
> 
> 标签：java, arrays, sorting

我正在尝试创建一个执行选择排序但向后的程序。如，找到最大的数字并将其与最后一个交换。我不知道为什么这不起作用。

根据评论更新代码。

```
 import java.util.Scanner;

public class Problem20 {

    public static void main(String[] args){

        int data[] = new int[10];
        Scanner scan = new Scanner(System.in);

        System.out.print("Please enter 10 numbers: ");
        for (int i = 0; i < 10; i++)
        {
        data[i] = scan.nextInt();
        }

        sortBig(data);

    }

    public static void sortBig(int[] data){

        int i, j, maxIndex, tmp;

          for (i = data.length - 1; i >= 0; i--) 
          {
                maxIndex = i;

                for (j = i-1; j >=0; j--)
                    if (data[j] > data[maxIndex])
                      maxIndex = j;
                    if (maxIndex != i) 
                    {
                      tmp = data[data.length - 1];
                      data[data.length - 1] = data[maxIndex];
                      data[maxIndex] = tmp;
                    }             
          }

        for (int r = 0; r < data.length; r++){
            System.out.print(data[r] + " ");
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:39:19.470

您需要反转您的第一个 for 循环 -`for(int i = data.length - 1; i >= 0; i--)`

您还需要修改第二个 for 循环以反映第一个 for 循环中的更改（循环内部看起来不错，但循环初始化块需要更正）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T05:51:25.470

Here is a simple test I wrote to find and make it easy to debug the code.

```
import org.junit.Test;

import java.util.Arrays;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

public class Problem20 {

    @Test
    public void testSorting() {
        // passes
        assertTrue(Arrays.equals(new int[]{1, 2, 3}, sortBig(3, 2, 1)));
        // failed previously
        assertTrue(Arrays.equals(new int[]{1, 2, 3, 4}, sortBig(4, 3, 2, 1)));
        // create an array of unique values in pseudo random order
        int[] largeArray = new int[1000];
        for (int i = 0; i < largeArray.length; i++)
            largeArray[i] = (i * 29) % largeArray.length;
        int[] sortedArray = sortBig(largeArray);
        for (int i = 0; i < largeArray.length; i++)
            assertEquals(i, sortedArray[i]);
    }

    public static int[] sortBig(int... data) {
        for (int i = data.length - 1; i >= 0; i--) {
            int maxIndex = i;

            for (int j = i - 1; j >= 0; j--)
                if (data[j] > data[maxIndex])
                    maxIndex = j;
            if (maxIndex != i) {
//                int tmp = data[data.length - 1];
                int tmp = data[i];
//                data[data.length - 1] = data[maxIndex];
                data[i] = data[maxIndex];
                data[maxIndex] = tmp;
            }
        }
        return data;
    }
} 
```

The simplest list I found which failed to sort was 4,3,2,1 and by debugging it I could see you were always swapping with the last element, not the last element `data.length -1` being searched `i` after making that substitution the tests worked even for a large array.

# sql-server-2008 - 查找用于命令行卸载的 SQL 2008 setup.exe

> ID：16156266
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:40.277
> 
> 标签：sql-server-2008, bootstrapper, setup.exe

我正在编写一个将数据存储在命名 SQL 实例中的小 .Net 应用程序。我需要能够以编程方式卸载实例。使用卸载参数调用 setup.exe 很容易（我在这篇文章中找到了它们：[https ://stackoverflow.com/questions/16068490/how-do-i-remove-an-sql-2008-instance-from -command-prompt-wo-removing-the-server](https://stackoverflow.com/questions/16068490/how-do-i-remove-an-sql-2008-instance-from-command-prompt-w-o-removing-the-server)），但困难的部分是可靠地找到 setup.exe。

我在其中找到了 setup.exe 的副本

```
C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\
C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\SQLServer2008R2\ 
```

最后我找到了“setup100.exe”

```
C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\SQLServer2008R2\x86 
```

我怎么知道该使用哪一个？到目前为止，我发现我必须使用其中的一个：

```
C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\ 
```

但我仍然不确定为什么我在那个 SQLServer2008R2 文件夹中找到了 setup.exe。

有一些方法可以查询卸载命令，但是当您卸载命名实例时它们是不可靠的...... :(。Win32_Product 可以工作，但在调用它时会破坏。Windows.Installer 会记录曾经安装的所有内容，所以如果我有安装了几个版本的 SQL（令人惊讶的常见）我不知道该使用哪个版本。

现在我只是在查询数据库的安装位置，使用我在

```
"\100\Setup Bootstrap\setup.exe" 
```

并希望最好的：P。

编辑：找到另一个：P

```
"C:\Program Files\Microsoft SQL Server\100\Setup Bootstrap\Release\x86\setup100.exe" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:46:05.573

您可以查看注册表：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\100\Bootstrap 
```

你想要的关键是`BootstrapDir`.

FWIW，我在 Setup Bootstrap 文件夹中没有（setup100.exe 或 setup.exe），只有在`SQLServer2008R2`子文件夹中。这可能是因为我没有安装 SQL Server 2008，只有 2008 R2。

那么，如果找不到您所追求的文件（因为尚未安装 2008，或者因为用户在不明智的尝试中删除它以释放一些空间），您打算怎么做？

# facebook - Facebook 的 Graph API 中似乎缺少信息

> ID：16156267
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:43.117
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk

考虑以下情况： ID 为 1 的朋友处于恋爱关系中，并且他的生日数据也被填写了 ID 为 2 的朋友也在恋爱关系中并且他的生日数据也被填写

ID 1 和 2 的用户都是朋友，如果我登录 Facebook，我可以毫无问题地看到上述信息。

然后我使用 Facebook SDK 调用 Graph API，所以我做了类似的事情：

```
$this->_facebook->api("/1"); 
```

对于这个 ID，在返回的数组中我可以看到关系状态、生日等。

然而

```
$this->_facebook->api("/2"); 
```

不返回此信息，仅返回诸如“姓名”、“身份”和“性别”之类的绝对基础信息——我正在使用简单的 print_r() 语句转储返回的数组。启动登录时，我通过“范围”参数发送正确的权限（因此我可以看到属于 ID 为 1 的用户的信息）。

所以问题是：如果我在界面上看到两个用户的生日和 rel 状态，为什么我只能通过 api 调用看到一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:45:34.580

我假设在您的示例中，用户“1”使用您的应用程序或者是您的应用程序用户的朋友（假设您有适当的 friends_* 权限）？

其他用户的信息将无法通过 API 获得 - 即使您可以通过您有权访问的其他数据来推断该信息 - 通常您只能代表您的应用程序的用户及其朋友访问数据，以及隐私设置可以覆盖您可以访问的有关用户朋友的信息，即使您的用户可以在 facebook.com 上看到信息

# ajax - Webdav.Net Ajax 文件浏览器：无法连接到 FireFox 20.0.1 中的 webdav 服务器

> ID：16156271
> 
> 赞同：0
> 
> 时间：2013-04-22T20:37:50.823
> 
> 标签：ajax, webdav, ithit-ajax-file-browser

我正在使用下面的代码在 .Net Web 应用程序项目中显示 ajax 文件浏览器控件，我使用开发 Web 服务器在自动分配的端口上本地运行该项目。

webdav 服务器在 IIS 7（端口 80）上本地运行，它是一个使用 webdav.net 服务器库的 .net 应用程序。应用程序中的安全设置为 Windows 身份验证。我还允许匿名用户提出 OPTIONS 请求。

该页面在 IE 和 Chrome 中运行良好，但 FireFox 无法连接，它返回消息：找不到位置“.../WebDav/”。

我启用了 Firebug，问题是 Webdav 服务器向 OPTIONS 请求返回 401 Unauthorized。

有什么办法可以让它在 FireFox 中也能正常工作吗？

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<dynamic>" %>

<!DOCTYPE HTML>
<html>
<head>
<title>IT Hit AJAX File Browser</title>

<!-- Always set width and height for html and body if you would like to set width and height for Ajax File Browser control to 100% -->
<style type="text/css">
    @import "AjaxFileBrowser/themes/ih_vista/include.css";
    html, body {margin: 0px; padding: 0px; width: 100%; height: 100%;}
</style>

<script src="AjaxFileBrowser/ITHitAJAXFileBrowser.js" type="text/javascript"></script>

<script type="text/javascript">
    function InitAjaxFileBrowser() {

        // Here we assume that your server is located on site root (http://server/) on the domain from which this page is loaded. 
        // If your WebDAV server is located on a different domain or on a different port the server must attach the Access-Control-Allow headers to server responses.
        var port = window.location.port == '' ? '' : ':' + window.location.port;
        var webDavServerPath = window.location.protocol + '//' + window.location.hostname + port;
        webDavServerPath = "http://localhost/WebDav";

        // Create the AJAX File Browser Settings object.
        var settings = {
            Id: 'AjaxFileBrowserContainer',     // (required) ID of the HTML control in which Ajax File Browser will be created
            Url: webDavServerPath,              // (required) the root folder to be displyed in Ajax File browser
            Style: 'height: 100%; width: 100%', // (required) always provide size of the control
            FileIconsPath: '/TestWebDavAjaxFileBrowser/AjaxFileBrowser/icons/',           // (required) path to the folder where file icons are located
            MsOfficeTemplatesPath: webDavServerPath + '/', // path to MS Office templates, always specify full path
            SelectedFolder: webDavServerPath,                        // folder to be selected, same as SetSelectedFolder call
            PluginsPath: '/TestWebDavAjaxFileBrowser/AjaxFileBrowser/plugins/'                                 // path to Java applet that opens documents directly from server
        };

        //Create control.
        var ajaxFileBrowser = new ITHit.WebDAV.Client.AjaxFileBrowser.Controller(settings);
    }
</script>
</head>
<body class="ih_vista" onload="InitAjaxFileBrowser();">
<div id="AjaxFileBrowserContainer" style="width: 100%; height: 100%"></div>
</body>
</html> 
```

谢谢

更新1：

我在这里尝试了为 Safari 概述的解决方案：[http](http://www.webdavsystem.com/ajaxfilebrowser/programming/authentication_ssl) ://www.webdavsystem.com/ajaxfilebrowser/programming/authentication_ssl ，但是它不起作用（Safari 和 FireFox 都没有）。系统提示我输入密码，但选项请求仍然未经授权。

我还在 .Net 项目属性 - Web 选项卡中启用了 NTLM 身份验证。仍然无效，OPTIONS 请求以未经授权的形式返回。

更新 2：

当我在 IIS 中运行客户端 .Net 应用程序而不是开发 Web 服务器（.Net 客户端 Web 应用程序和 webdav 服务器在 IIS 的 80 端口上本地运行）时，我让它在 FireFox 中工作。当我在 IIS 中运行它时，FireFox 可以工作，但 Safari 不能。Safari 一直提示我输入密码。我仍然很好奇在本地开发 Web 服务器中运行客户端应用程序时是否有解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:31:48.820

尝试在 web.config 中使用它：

```
<authorization>
  <!-- 
  To support Windows Shell (Miniredirector/Web Folders) on XP and Server 2003 as well as Firefox CORS requests, OPTIONS must be 
  processed without authentication. To enable authentication of OPTIONS request, remove "allow OPTIONS" from the list below.
  -->
  <allow users="*" verbs="OPTIONS"/>
  <deny users="?"/>
  <allow users="*"/>
</authorization> 
```

# linux - grep 查找字符串，如果匹配则查找匹配行上方包含特定单词的行

> ID：16156275
> 
> 赞同：1
> 
> 时间：2013-04-22T20:38:01.123
> 
> 标签：linux, grep

我正在寻找如下所示的文件中的模式。在这个例子中，我需要 grep 来获取一个字符串`mgrpRFC822MailMember: foo.foo2@example.com`

如果上面的字符串匹配然后上去找到第一`dn:`行并打印

```
test-d@example.com 
```

现在，问题是，该行`dn:`并不总是相同的数字（在下面的示例中`dn:`，该行在 grep'ed 行上方 3 行`mgrpRFC822MailMember: foo.foo2@example.com`）

这并不总是正确的。它可以在任何数字之前`mgrpRFC822MailMember: foo.foo2@example.com`

这是条件：

1.  字符串的 grep -`mgrpRFC822MailMember: foo.foo2@example.com`

2.  如果匹配，则查找该行上方的 FIRST dn: 行并仅打印 `test-d@example.com`

任何帮助是极大的赞赏。

```
time: 1364633264
dn: mailRoutingAddress=test-d@example.com,ou=MessageRecipientGroups,dc=example,dc=com
changetype: modify
delete: mgrpRFC822MailMember
mgrpRFC822MailMember: foo.foo2@example.com
-
replace: entryCSN
entryCSN: 20130330084739Z#00000b#00#000000
-
replace: modifiersName
modifiersName: uid=distlist-cleanup,ou=SysAccounts,dc=example,dc=com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T00:09:05.010

您也可以使用 sed，它可能会更快。将以下内容放入文件中，例如`x.sed`，不要添加任何空格或制表符

```
/dn:/h
/MailMember:/{
g
s/.*RoutingAddress.//
s/,.*//p
} 
```

然后像这样运行 sed

```
sed -n -f x.sed filename 
```

对于您的示例，它会打印出来

```
test-d@example.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:58:03.593

```
awk '/dn: /{bar=$2} /MailMember:/{print bar}' FS='[=,]' 
```

*   找`dn: `线
*   将行另存为`bar`变量
*   找`MailMember:`线
*   打印`bar`变量

# ios - 无法从游戏层 Cocos2d 调用 HUD 层方法

> ID：16156276
> 
> 赞同：0
> 
> 时间：2013-04-22T20:38:04.903
> 
> 标签：ios, cocos2d-iphone, hud

我可以让 HUD 层出现，但我似乎无法更新它。我在 Ray 的教程中得到了它，但由于某种原因，我无法在我自己的应用程序中得到它。我做了一个新的 Cocos2d 项目，这样我就可以尝试隔离问题，我也遇到了同样的问题……也许你们可以帮忙。（我没有收到任何错误，并尝试尽我所能为 StackOverflow 修复缩进 ..）

问题：我无法更新 scoreLabel

代码：

**游戏HUD.h**

```
#import <Foundation/Foundation.h>
#import "cocos2d.h"

@interface GameHUD : CCLayer {

    CCLabelTTF *scoreLabel;

}

- (void) updateScore:(int)score;

@end 
```

**游戏HUD.m**

```
#import "GameHUD.h"

@implementation GameHUD

- (id) init {

    if (self = [super init]) {

        scoreLabel = [CCLabelTTF labelWithString:@"00000" dimensions:CGSizeMake(240,100) hAlignment:kCCTextAlignmentRight fontName:@"Arial" fontSize:32.0f];
        scoreLabel.anchorPoint = ccp(0,0);
        scoreLabel.position = ccp(200,0);
        scoreLabel.color = ccc3(255, 200, 100);

        [self addChild:scoreLabel];

    }

    return self;
}

- (void)updateScore:(int)score {
    scoreLabel.string = [NSString stringWithFormat:@"%i",score];
}

@end 
```

**HelloWorldLayer.h**

```
#import "cocos2d.h"
#import "GameHUD.h"

@interface HelloWorldLayer : CCLayer
{
    GameHUD *_hud;
}

@property (nonatomic,retain) GameHUD *hud;

+(CCScene *) scene;

@end 
```

**HelloWorldLayer.m**

```
#import "HelloWorldLayer.h"
#import "AppDelegate.h"

#pragma mark - HelloWorldLayer

@implementation HelloWorldLayer
@synthesize hud = _hud;

+(CCScene *) scene
{
    CCScene *scene = [CCScene node];

    HelloWorldLayer *layer = [HelloWorldLayer node];
    [scene addChild: layer];

    GameHUD *hud = [GameHUD node];
    [scene addChild:hud];

    layer.hud = hud;
return scene;
}

-(id) init
{
if( (self=[super init]) ) {

    // create and initialize a Label
    CCLabelTTF *label = [CCLabelTTF labelWithString:@"Layer A" fontName:@"Marker Felt" fontSize:64];

    // ask director for the window size
    CGSize size = [[CCDirector sharedDirector] winSize];

    // position the label on the center of the screen
    label.position =  ccp( size.width /2 , size.height/2 );

    // add the label as a child to this Layer
    [self addChild: label];

     // Try to update the scoreLabel in the HUD (NOT WORKING)
     [_hud updateScore:74021];

}
return self;
}

// on "dealloc" you need to release all your retained objects
- (void) dealloc
{
    [super dealloc];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T01:28:11.563

当您在尚未创建 HUD`init`时调用时调用 ，即is 。向对象发送消息是一个无效操作，它不会像在“NULL”对象上调用函数那样崩溃。`[HelloWorldLayer node]``_hud``nil``nil`

# javascript - Angular JS 中继器 + Bootstrap 轮播

> ID：16156277
> 
> 赞同：4
> 
> 时间：2013-04-22T20:38:07.763
> 
> 标签：javascript, html, twitter-bootstrap, angularjs

我正在尝试用来自 AngularJS 的数据填充 Bootstrap Carousel 组件。基本上我正在`carousel-inner`像这样填充类内的项目：

```
 <div class="carousel-inner">
     <div class="item" ng-repeat="screen in app.screens">
       <img ng-src="screens/{{screen}}"  class="center"/>
     </div>
 </div> 
```

这会很好，但起初我看不到任何图片，我认为这是因为我的物品都没有`active`类。

在官方文档中：

```
<div class="carousel-inner">
    <div class="active item">…&lt;/div>
    <div class="item">…&lt;/div>
    <div class="item">…&lt;/div>
</div> 
```

第一个 div 具有“活动”类，它是可见的，当我尝试在没有 Angular JS 的情况下编写示例时，它可以工作。

如何将 ng-repeat 中的第一项设置为“活动”类？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-22T20:42:46.387

使用以下内容：

```
<div class="item" ng-repeat="screen in app.screens" ng-class="{active : $first}"> 
```

[**在这里**](http://docs.angularjs.org/api/ng.directive:ngRepeat)，您可以看到在本地范围内公开了哪些属性。

# java - Spring 不会反序列化 json 字符串（未引用的属性）

> ID：16156281
> 
> 赞同：1
> 
> 时间：2013-04-22T20:38:32.827
> 
> 标签：java, spring-mvc

当我发送 json 数组时，Spring 会抛出错误。我不确定我在这里缺少什么。

**请求体**

```
{
"deliverySessionId":"c1fb327b-98a8-46d4-9e82-ce7507b5be93",
imageNames: ["name1", "name2"]
} 
```

**端点**

```
@RequestMapping(value = { "/examImages/" }, method = { RequestMethod.POST } )
public @ResponseBody ImageResponseCommand streamExamImages( @RequestBody ImageResponseCommand imageResponseCommand ) { 
```

**错误**

```
 The request sent by the client was syntactically incorrect. 
```

如果我的请求不包含 imageNames 属性，它可以正常工作。

```
 { "deliverySessionId":"c1fb327b-98a8-46d4-9e82-ce7507b5be93" } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T20:44:46.973

您的 JSON 字符串格式不正确。对象键需要用引号括起来。

```
{
    "deliverySessionId":"c1fb327b-98a8-46d4-9e82-ce7507b5be93",
    "imageNames": ["name1", "name2"]
} 
```

# eclipse - 避免使用 Hibernate 生成工具生成标题注释

> ID：16156283
> 
> 赞同：3
> 
> 时间：2013-04-22T20:38:38.187
> 
> 标签：eclipse, hibernate, hibernate-tools

在生成 DTO 对象时，hibernate 工具会在 header 中生成注释：

```
// Generated 22 avr. 2013 20:29:27 by Hibernate Tools 3.4.0.CR1 
```

每一代评论都会改变（因为它们包含生成日期/时间）。

问题是在我的 SVN 中我最终有许多无用的更改，所以我必须检查每个生成的文件以查看是提交（如果它包含实际更改）还是覆盖它（如果它只是标题）。

有没有办法避免生成上述标题？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:44:33.067

您必须自定义 Freemarker 模板，该模板位于`hibernate-tools.jar`. 导航到`/pojo/Pojo.ftl`并删除该行`// Generated ${date} by Hibernate Tools ${version}`。

检查这一点可能会有所帮助：[https ://forum.hibernate.org/viewtopic.php?f=6&t=989777&view=next](https://forum.hibernate.org/viewtopic.php?f=6&t=989777&view=next)

一个 Hibernate 工具 Ant 任务的示例（通过指定`templatepath`和`hbmtemplate`属性：

```
<hibernatetool destdir="hibernate-model-gen/pojo" templatepath="hibernate-model-gen/customized-templates">
    <jdbcconfiguration configurationfile="hibernate-model-gen/hibernate.cfg.xml" packagename="open.pub.proto.core.model" revengfile="hibernate-model-gen\gen-conf\hibernate.reveng.xml" detectmanytomany="true" />
    <hbmtemplate templateprefix="pojo/" template="pojo/Pojo.ftl" filepattern="{package-name}/{class-name}.java">
        <property key="jdk5" value="true" />
        <property key="ejb3" value="true" />
    </hbmtemplate>
</hibernatetool> 
```

# android - 如何从 getScanResults() 连接到网络

> ID：16156287
> 
> 赞同：2
> 
> 时间：2013-04-22T20:39:12.393
> 
> 标签：android, android-wifi

我想通过 WifiManager.getScanResults() 的结果连接到信号最强的 wifi 热点。`boolean b`但不知何故，即使显示为真，我也无法让我的设备访问网络。

```
 wc.SSID = "\".xxxxx\"";//result from the getScanResults()
            wc.preSharedKey  = "\"abcdefg111\"";
            wc.hiddenSSID = true;
            wc.status = WifiConfiguration.Status.ENABLED;        
            wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.TKIP);
            wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.CCMP);
            wc.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_PSK);
            wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.TKIP);
            wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.CCMP);
            wc.allowedProtocols.set(WifiConfiguration.Protocol.RSN);
            int res = wifi.addNetwork(wc);
            Log.d("WifiPreference", "add Network returned " + res );
            boolean b=false;
            b= wifi.enableNetwork(res, true);        
            Log.d("WifiPreference", "enableNetwork returned " + b ); 
```

# android - onClickListner 在 popUpWindow 中不起作用 - 空指针异常

> ID：16156297
> 
> 赞同：0
> 
> 时间：2013-04-22T20:39:55.347
> 
> 标签：android, onclicklistener, popupwindow

我正在尝试用两个按钮实现一个弹出窗口。我能够成功显示带有按钮的弹出窗口。我正在尝试实现按钮操作。但我得到空指针异常。

这是我的代码。

```
View pview =inflater.inflate(R.layout.popupxml(ViewGroup)findViewById(R.layout.activity_event_detail));
popUp = new PopupWindow(pview);
registerBtn = (Button) findViewById(R.id.registerButton);
registerBtn.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub      

            signUp = (Button) findViewById(R.id.signUpExplore);
            notNow = (Button) findViewById(R.id.notNow);

            final OnClickListener notNowClickListner = new OnClickListener() 
              {
                public void onClick(View v) 
                {
                    popUp.dismiss();
                    click = true;
                }
              };

            if (click) {
// I get the null pointer exception in this line.                   
                notNow.setOnClickListener(notNowClickListner);
                popUp.showAtLocation(v, Gravity.CENTER_VERTICAL, 0, 0);
                popUp.update(0, 50, 300, 150);

                click = false;

            } else {
                popUp.dismiss();
                click = true;
            }

        }
    }); 
```

这是logCAT

```
04-22 15:42:07.269: E/AndroidRuntime(8575): FATAL EXCEPTION: main
04-22 15:42:07.269: E/AndroidRuntime(8575): java.lang.NullPointerException
04-22 15:42:07.269: E/AndroidRuntime(8575): at com.strive.gostrive.EventDetailActivity$1.onClick(EventDetailActivity.java:153)
04-22 15:42:07.269: E/AndroidRuntime(8575): at   android.view.View.performClick(View.java:2485)
04-22 15:42:07.269: E/AndroidRuntime(8575): at android.view.View$PerformClick.run(View.java:9080)
04-22 15:42:07.269: E/AndroidRuntime(8575): at android.os.Handler.handleCallback(Handler.java:587)
04-22 15:42:07.269: E/AndroidRuntime(8575): at android.os.Handler.dispatchMessage(Handler.java:92)
04-22 15:42:07.269: E/AndroidRuntime(8575): at android.os.Looper.loop(Looper.java:130)
04-22 15:42:07.269: E/AndroidRuntime(8575): at android.app.ActivityThread.main(ActivityThread.java:3687)
04-22 15:42:07.269: E/AndroidRuntime(8575): at java.lang.reflect.Method.invokeNative(Native Method)
04-22 15:42:07.269: E/AndroidRuntime(8575): at java.lang.reflect.Method.invoke(Method.java:507)
04-22 15:42:07.269: E/AndroidRuntime(8575): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
04-22 15:42:07.269: E/AndroidRuntime(8575): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
04-22 15:42:07.269: E/AndroidRuntime(8575): at dalvik.system.NativeStart.main(Native Method) 
```

我确实参考了很多例子。但没有什么对我有用。

需要帮忙！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:43:53.730

我相信你需要`buttons`像这样初始化你的

```
signUp = (Button) popUp.findViewById(R.id.signUpExplore);
notNow = (Button) popUp.findViewById(R.id.notNow); 
```

调用后`popUp.setContentView(pview)`；

你找错地方了，所以他们回来了`null`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-23T06:57:27.930

看看这个[如何处理android弹出窗口内按钮的onclick事件](https://stackoverflow.com/questions/2997338/how-to-handle-onclick-event-of-button-inside-popup-window-in-android)

您需要像这样在弹出窗口中找到 ImageButton：

```
ImageButton imgBtn = (ImageButton)popupView.findViewBy(R.id.imgBtn); 
```

# string - htaccess 删除查询字符串

> ID：16156301
> 
> 赞同：0
> 
> 时间：2013-04-22T20:40:01.947
> 
> 标签：string, .htaccess, mod-rewrite

我对正则表达式不太熟悉，我无法实现我想要的。

我正在处理的网站曾经有一个 wordpress 博客，并且互联网上有指向[http://www.website.com/?p=](http://www.website.com/?p=(random) （随机数）的现有链接。

我现在拥有的当前代码似乎不起作用：

```
RewriteCond %{QUERY_STRING} p=(.*)
RewriteRule http://www.website.com/ [R=301,L] 
```

事实上，如果有一种方法可以删除索引页面的任何类型的查询字符串，那就更好了。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:42:58.193

如果您想删除所有查询字符串，不管

```
RewriteCond %{QUERY_STRING} .
RewriteRule ^$ /? [R,L] 
```

这会测试是否有任何查询字符串`.`，然后在没有查询字符串的情况下重定向到主页`/?`。

*永远不要*在启用的情况下进行测试，有关详细信息`301`，请参阅此答案 [提示调试 .htaccess 重写规则](https://stackoverflow.com/a/9204355/1741542) 。

# wpf - 模仿当前画布的 WPF 循环动画

> ID：16156302
> 
> 赞同：0
> 
> 时间：2013-04-22T20:40:04.257
> 
> 标签：wpf, animation, canvas

我在 wpf 中实现了一个图形动画，并参考了附加的图片（显然我不是艺术家......）。正方形代表可见形式，而整个图像代表从页面转换到页面的画布。动画从右侧的 1->2->3->4->1 和左侧的 4->3->2->1->4 滚动和环绕。

正如您从图片中的彩色箭头中看到的那样，我之前的实现允许我使用与所需图片相同的前后门廊。当动画移动到正面或背面图片时，使用瞬时动画在用户不知情的情况下快速移动到真实页面。

到目前为止，这效果很好并且非常顺利。问题在于我的实现不仅仅是简单的图像。每个页面本身都会有复杂的动画。使用相同的实现，我必须镜像 4 个真实页面中的每个动画，就像我必须在仅存在平滑动画滚动的最后页面中一样。

显然，由于许多原因，这将是非常浪费和不理想的......

我的一个想法是从首页 1 和 4 创建一个图像，并使用另一个画布将该图像覆盖在前后门廊上。但这似乎仍然太难了，应该有更简单的方法。

有没有比这更受欢迎或更简单的方法？我正在寻找某种可以模仿其他画布的画布，这样我就不必担心这个了。要么是那个，要么是一个全新的算法来包裹最后的页面。

我已经在互联网上查看了这个滚动例程，但还没有找到任何东西。感谢您的任何帮助！对不起，很长的帖子。

![在此处输入图像描述](https://i.stack.imgur.com/Eypdk.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:35:33.320

看起来我通过使用 VisualBrush 并将其绑定到画布找到了我的问题的答案。

```
 <Canvas Name="backgroundCanvas" Visibility="Visible"  Height="{StaticResource animHeight}" Width="6144">

        <Canvas Name="menuFrontCanvas" Visibility="Visible" Margin="0,0,0,0" Height="{StaticResource animHeight}" Width="{StaticResource animWidth}">
            <Rectangle HorizontalAlignment="Left" VerticalAlignment="Top" Width="{StaticResource animWidth}" Height="{StaticResource animHeight}">
                <Rectangle.Fill>
                    <VisualBrush Visual="{Binding ElementName=menu4Canvas}" />
                </Rectangle.Fill>
            </Rectangle>
        </Canvas>

        <Canvas Name="menu1Canvas"  Visibility="Visible" Margin="1024,0,0,0" Height="{StaticResource animHeight}" Width="{StaticResource animWidth}">
            <Image Name="alpsLogoImage" Canvas.ZIndex="99"  Stretch="None" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Visible" 
                IsEnabled="True" StretchDirection="Both" Source="WPFResources/ALPSLogo.png" />
            <Image Name="menu1Image" Stretch="None" HorizontalAlignment="Left" VerticalAlignment="Top"
                IsEnabled="True" StretchDirection="Both" Source="WPFResources/Backgrounds/menu1Image.png" />
        </Canvas>

        <Canvas Name="menu2Canvas" Visibility="Visible" Margin="2048,0,0,0" Height="{StaticResource animHeight}" Width="{StaticResource animWidth}">
            <Image Name="menu2Image" Stretch="None" HorizontalAlignment="Left" VerticalAlignment="Top"
                IsEnabled="True" StretchDirection="Both" Source="WPFResources/Backgrounds/menu2Image.png" />
        </Canvas>

        <Canvas Name="menu3Canvas" Visibility="Visible" Margin="3072,0,0,0" Height="{StaticResource animHeight}" Width="{StaticResource animWidth}">
            <Image Name="menu3Image" Stretch="None" HorizontalAlignment="Left" VerticalAlignment="Top"
                IsEnabled="True" StretchDirection="Both" Source="WPFResources/Backgrounds/menu3Image.png" />
        </Canvas>

        <Canvas Name="menu4Canvas" Visibility="Visible" Margin="4096,0,0,0" Height="{StaticResource animHeight}" Width="{StaticResource animWidth}">
            <Image Name="menu4Image" Stretch="None" HorizontalAlignment="Left" VerticalAlignment="Top"
                IsEnabled="True" StretchDirection="Both" Source="WPFResources/Backgrounds/menu4Image.png" />  
        </Canvas>

        <Canvas Name="menuBackCanvas" Visibility="Visible"   Margin="5120,0,0,0" Height="{StaticResource animHeight}" Width="{StaticResource animWidth}">
            <Rectangle HorizontalAlignment="Left" VerticalAlignment="Top" Width="{StaticResource animWidth}" Height="{StaticResource animHeight}">
                <Rectangle.Fill>
                    <VisualBrush Visual="{Binding ElementName=menu1Canvas}" />
                </Rectangle.Fill>
            </Rectangle>
        </Canvas>

    </Canvas> 
```

# asp.net-mvc - 如何禁用不在数据库中的属性的实体框架验证

> ID：16156304
> 
> 赞同：0
> 
> 时间：2013-04-22T20:40:13.597
> 
> 标签：asp.net-mvc, entity-framework, entity-framework-4

我首先使用数据库来生成我的模型，对于其中一个类 Foo，我在这样的部分类中创建了一个单独的文件，其中包含一些额外的东西

```
public partial Class Foo 
{
   public typename Bar{get {blahblah}}
} 
```

我注意到，在将表单提交给操作时，在加载操作时输入 Bar 的 getter，然后再点击我的任何代码。它似乎是实体框架验证的一部分（它通过反射调用它。我注意到它称为 ReflectPropertyDescriptor 和 MethodInfoInvoke）

有没有办法在所有情况下关闭对 Bar 的验证？或者至少在行动开始时？

# jquery - jquery-隐藏表中存在行跨度的列

> ID：16156305
> 
> 赞同：0
> 
> 时间：2013-04-22T20:40:19.150
> 
> 标签：jquery, gridview, toggle

我需要隐藏表格中的列，但涉及行跨度，它会破坏功能。我很感激任何帮助。以下是我的代码的链接：

[http://jsfiddle.net/SEwVP/73/](http://jsfiddle.net/SEwVP/73/)

这是函数（在示例中，我试图隐藏第 3 列）：

```
$('#toggle').click(function(){
var lastChilds = $('#tbl td:nth-child(3)');
lastChilds.each(function(i){
    var rowSpan = $(this).attr('rowspan');
    if(rowSpan !== undefined){
      lastChilds.splice(i+1, rowSpan-1);

    }
     $(this).toggle();

  });
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T23:05:07.087

我最初对此很感兴趣，因为它看起来微不足道，但实际上令人难以置信。我尝试了各种方法来解决`rowspan`s 来切换正确的单元格。我最初是昨天回答的，但我很快就把它删除了，因为我知道它失败得很惨。

当我们说“第 3 列”时，它并不一定意味着该`<td>`行的第三个子行，因为就 HTML 和`rowspan`s 的工作方式而言。

然后是顿悟：表格是完美的网格，例如，所有**“视觉上感知”**为第三列的单元格都共享一个共同点，**它们都共享相同的 offset left**。

这是迄今为止我能得到的最接近的方法，这可能是一种**基于一个重要假设的有点激进的方法：`colspan`整个 table 中不涉及 s**。（否则，一切都会变成便便）

这个演示允许你切换你想要的**任何**列，希望具有任何行跨复杂度。

（如果有更优雅的解决方案，我当然想了解自己）

**演示**：http: [//jsfiddle.net/terryyounghk/nGEHW/](http://jsfiddle.net/terryyounghk/nGEHW/)

```
$(document).ready(function () {

    var $table = $('#tbl');

    (function scanTable($table) {

        var $rows = $table.find('tr'),
            $cells = $table.find('td'),
            map = {};

        // the first row will always have all n columns of cells,
        // so this is the safest row to collect each columns offset().left
        $rows.first().find('td').each(function (i, cell) {
            var $cell = $(cell),
                left = Math.floor($cell.offset().left);
            map[left] = i+1;
            $cell.attr({
                'data-nth-col': i+1
            });
        });

        // now for the rest of the rows, 
        $rows.not(':first').each(function (i, row) {
            var $row = $(row),
                $cells = $row.find('td');

            $cells.each(function (j, cell) {
                var $cell = $(cell),
                    left = Math.floor($cell.offset().left);
                $cell.attr({
                    'data-nth-col': map[left]
                });
            });
        });
    })($table); // scan the entire table ONCE. 
                // We don't want to do this on every toggle

    $('button[name=toggle]').on('click', function () {
        var n = +$(this).val();
        $table.find('td[data-nth-col='+n+']').toggle();
    });

}); 
```

# c# - 部分视图没有转到正确的位置

> ID：16156310
> 
> 赞同：1
> 
> 时间：2013-04-22T20:40:41.113
> 
> 标签：c#, asp.net-mvc-4

**部分视图**没有转到正确的位置，并且总是打开一个新页面。

我需要在正确的位置（index.cshtml）打开**部分视图。**如何解决？

```
public class HomeController : Controller
{ 
  public PartialViewResult LatestNews()
  {
     var p = new Person();
     p.FirstName = " NAME " + DateTime.Now; // To test only
     return PartialView("_News", p);
  } 
```

**索引.cshtml**

```
@Ajax.ActionLink("Click here!", "LatestNews", "Home", 
   new AjaxOptions { UpdateTargetId = "latestNewsDiv", InsertionMode = InsertionMode.Replace, HttpMethod = "GET", LoadingElementId = "progress" })

<div id="latestNewsDiv">
</div>

<div id="progress">
    <p>Loading...</p>
</div> 
```

`_News.cshtml`在**共享**文件夹下

```
@model MvcApplication1.Models.Person
<h2>News !!!</h2>
<div>
    @Model.FirstName
</div> 
```

**更新**

* * *

感谢达林·季米特洛夫

最初我把

```
 <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script> 
```

在`HEAD`部分

`body`但是当我把它放在标签的底部并且之后`@Scripts.Render("~/bundles/jquery")`它工作正常！

```
 @Scripts.Render("~/bundles/jquery")
        <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>
         @RenderSection("scripts", required: false)
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T20:44:18.027

确保您已将`jquery.unobtrusive-ajax.js`脚本包含到您的页面中。而这个脚本包含显然应该发生在`jquery.js`. 如果您使用的是 ASP.NET MVC 4 捆绑包，您应该`~/bundles/jqueryval`在布局中简单地呈现捆绑包，就在 jquery 之后：

```
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jqueryval")
@RenderSection("scripts", required: false) 
```

如果您在 jquery 之后没有将`jquery.unobtruisve-ajax.js`脚本包含在标记中，那么`Ajax.*`帮助程序将毫无用处。他们所做的只是`data-*`在相应的 DOM 元素上生成虚拟的 HTML5 属性，但是如果没有正确的脚本，就绝对没有任何东西可以解释这些属性和 AJAXify 元素。

# java - 如果调整窗口大小，则绘制图像并更新它

> ID：16156311
> 
> 赞同：0
> 
> 时间：2013-04-22T20:40:43.757
> 
> 标签：java, swing, file-io, bufferedimage

我正在用 Java 绘制图像，如果调整大小，我想将图像更新为窗口的大小。但由于我是初学者，我根本不知道我应该做什么。

```
public class ImageCanvas extends JFrame {

    private static final long serialVersionUID = 1L;
    JPanel panel; 
    JLabel label; 
    ImageIcon icon; 
    BufferedImage image; 

    public ImageCanvas() throws IOException{
        draw();
        icon = new ImageIcon(image); 
        label = new JLabel(icon); 
        panel = new JPanel(); 
        panel.add(label); 
        getContentPane().add(panel); 
        setSize(image.getWidth()+10, image.getHeight()); 
        setLocationRelativeTo(null); 
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        setVisible(true); 
        File f = new File("c:\\img.png");
        ImageIO.write(image, "png", f);
    }

    private void draw() {
        int width = 640, height = 480; 
        image = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB); 
        WritableRaster raster = image.getRaster(); 
        ColorModel model = image.getColorModel(); 

        Color c1 = Color.BLACK; 
        int argb1 = c1.getRGB(); 
        Object data1 = model.getDataElements(argb1, null); 

        Color c2 = Color.RED; 
        int argb2 = c2.getRGB(); 
        Object data2 = model.getDataElements(argb2, null); 
            for (int i = 0; i < width; i++) { 
                for (int j = 0; j < height; j++) { 
                    raster.setDataElements(i, j, data1); 
                    if(i==j){
                        raster.setDataElements(i, j, data2);
                    }
                } 
            }
    }

    public static void main(String args[]) throws IOException { 
        new ImageCanvas(); 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T03:53:51.530

JLabel 总是将图标绘制为其实际大小。每次调整标签大小时，您都需要重新创建图像。

一种更简单的方法是进行动态绘画，这将根据需要调整图像大小。[背景面板](http://tips4java.wordpress.com/2008/10/12/background-panel/)可以为您做到这一点。

# c# - RFID连接！工作正常，但导致打开多种形式

> ID：16156312
> 
> 赞同：1
> 
> 时间：2013-04-22T20:40:44.060
> 
> 标签：c#, rfid

我已经对软件进行了编码，它工作正常，并且 RFID 设备在登录框中也能正常工作，一旦人们使用 RFID 设备密钥登录，它就会进入主页但是 RFID 连接仍然打开并且不会关闭，当有人将其他密钥放在 RFID 设备附近时, 又打开一个窗口并使用其他登录 ID 自动登录，如何阻止它？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlServerCe;
//using System.Diagnostics;
//using System.IO.Ports;
using System.Speech.Synthesis;
using Phidgets;
using Phidgets.Events;

namespace GYM_Management
{
  public partial class Login : GYM_Management.Form1
  {

    RFID   rfid1;
    string lastRFIDTag;
    Int32  TagCtr;

    public Login()
    {
        InitializeComponent();
        lastRFIDTag = "";
        TagCtr = 0;
    }
    connection cc = new connection();
    SpeechSynthesizer sp = new SpeechSynthesizer();

    private void Login_Load(object sender, EventArgs e)
    {
        textBox4.Enabled = true;
        rfid1 = new RFID();
        rfid1.Attach += new AttachEventHandler(rfid_Attach);
        rfid1.Detach += new DetachEventHandler(rfid_Detach);
        rfid1.RFIDTag += new TagEventHandler(rfid_Tag);
        rfid1.RFIDTagLost += new TagEventHandler(rfid_TagLost);
        rfid1.open();

        Text = cc.Title() + " ( Login )";
        groupBox1.Visible = false;
        groupBox2.Visible = true;
    }

    public void RFIDLogin()
    {

        if (textBox4.Text.Length == 10)
        {
            SqlCeConnection con = new SqlCeConnection(cc.connectDB());
            con.Open();
            SqlCeCommand cmd = new SqlCeCommand("delete from log", con);
            cmd.ExecuteNonQuery();
            SqlCeCommand cmd1 = new SqlCeCommand("select * from Login where RFID='" + textBox4.Text + "'", con);
            cmd1.ExecuteNonQuery();
            SqlCeDataReader c = cmd1.ExecuteReader();
            if (c.Read() == true)
            {
                SqlCeCommand cmd2 = new SqlCeCommand("select typeid from Login where RFID='" + textBox4.Text + "'", con);
                Int32 count = (Int32)cmd2.ExecuteScalar();
                if (count == 1)
                {
                    SqlCeCommand cmd3 = new SqlCeCommand("insert into log values ('" + 1 + "')", con);
                    cmd3.ExecuteNonQuery();
                    cmd3.ExecuteNonQuery();
                    Menu shw = new Menu();
                    shw.Show();
                    textBox4.Enabled = false;
                    txtTag.Enabled = false;
                    this.Hide();
                    sp.SpeakAsync("Welcome To Canvey Island GYM");

                }
                else
                    if (count == 2)
                    {
                        SqlCeCommand cmd3 = new SqlCeCommand("insert into log values ('" + 2 + "')", con);
                        cmd3.ExecuteNonQuery();
                        Menu shw = new Menu();
                        shw.Show();
                        textBox4.Enabled = false;
                        txtTag.Enabled = false;
                        this.Hide();
                        sp.SpeakAsync("Welcome To Canvey Island GYM");
                    }

            }
            else
            {
                //MessageBox.Show("Login Failed");
                sp.SpeakAsync("Login Failed");
            }

        }
    }

    public void ent()
    {
        try
        {
            SqlCeConnection con = new SqlCeConnection(cc.connectDB());
            con.Open();
            SqlCeCommand cmd = new SqlCeCommand("delete from log", con);
            cmd.ExecuteNonQuery();
            SqlCeCommand cmd1 = new SqlCeCommand("select * from Login where username='" + textBox1.Text + "' and password='" + textBox2.Text + "'", con);
            cmd1.ExecuteNonQuery();
            SqlCeDataReader c = cmd1.ExecuteReader();
            if (c.Read() == true)
            {
                SqlCeCommand cmd2 = new SqlCeCommand("select typeid from Login where username='" + textBox1.Text + "' and password='" + textBox2.Text + "'", con);
                Int32 count = (Int32)cmd2.ExecuteScalar();
                if (count == 1)
                {
                    SqlCeCommand cmd3 = new SqlCeCommand("insert into log values ('" + 1 + "')", con);
                    cmd3.ExecuteNonQuery();
                }
                else
                    if (count == 2)
                    {
                        SqlCeCommand cmd3 = new SqlCeCommand("insert into log values ('" + 2 + "')", con);
                        cmd3.ExecuteNonQuery();
                    }
                sp.SpeakAsync("Welcome To Canvey Island GYM");
                Menu shw = new Menu();
                shw.Show();
                textBox4.Enabled = false;
                this.Hide();

            }
            else
            {
                sp.SpeakAsync("Login Failed");
            }
        }
        catch (Exception ee)
        {
            MessageBox.Show(ee.Message);
        }
    }
    private void button1_Click(object sender, EventArgs e)
    {
        ent();
    }

    //private void textBox2_KeyDown(object sender, KeyEventArgs e)
    //{
    //    if (e.KeyCode == Keys.Enter)
    //    {
    //        ent();
    //    }
    //}

    private void button2_Click(object sender, EventArgs e)
    {
        groupBox1.Visible = false;
        groupBox2.Visible = true;   
    }

    private void button3_Click(object sender, EventArgs e)
    {
        groupBox2.Visible = false;
        groupBox1.Visible = true;
    }

    private void textBox4_TextChanged(object sender, EventArgs e)
    {
        RFIDLogin();
        rfid1.close();
    }

    void rfid_Tag(object sender, TagEventArgs e)
    {
        textBox4.Text = e.Tag;
        txtTag.Text = e.Tag;
        lastRFIDTag = txtTag.Text;
        rfid1.LED = true;       // light on
    }

    void rfid_TagLost(object sender, TagEventArgs e)
    {
        txtTag.Text = "";
        rfid1.LED = false;      // light off
        //write held Tag ID to listview
        lbPrevRFIDTags.Items.Insert(0,
            string.Format("Tag: {0} - {1}", ++TagCtr, lastRFIDTag));
    }

    void rfid_Detach(object sender, DetachEventArgs e)
    {
        lblAttached.Text = "Not Attached";
    }

    void rfid_Attach(object sender, AttachEventArgs e)
    {
        Phidgets.RFID phid = (Phidgets.RFID)sender;
        lblAttached.Text = "Attached: " + phid.Name;
        lblSerial.Text = " Serial: " + phid.SerialNumber;
        lblVersion.Text = " Version: " + phid.Version;
    }

    private void cboxAntenna_CheckedChanged(object sender, EventArgs e)
    {
        rfid1.Antenna = cboxAntenna.Checked;
    }

  }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:20:53.143

我不熟悉这个 RFID 设备，当阅读器单选时，我的设备会继续在 tagEventHandler 中一遍又一遍地拾取相同的标签。我所做的只是创建一个

```
bool scantag = true; 
```

然后在您希望它拾取标签时用它控制您的 RFID 方法

```
void rfid_Tag(object sender, TagEventArgs e)
{

if(scantag == true)
{        

scantag = false;
textBox4.Text = e.Tag;
txtTag.Text = e.Tag;
lastRFIDTag = txtTag.Text;
rfid1.LED = true;       // light on

}

//wait for user to remove tag
System.Threading.Thread.Sleep(5000);

// enable the handler again
scantag = true;

} 
```

# c# - 如何在 MonoGame for Windows 中制作屏幕截图？

> ID：16156315
> 
> 赞同：2
> 
> 时间：2013-04-22T20:41:09.650
> 
> 标签：c#, monogame

因此，我一直在尝试从当前游戏窗口（本质上是屏幕截图）创建图像文件，但到目前为止我所尝试的只是不起作用。MonoGame 开发人员尚未实现用于 Windows 的`RenderTarget2D.SaveAsPng()`方法`RenderTarget2D.SaveAsJpeg()`...

所以我想知道，还有其他选择吗？

这是一个示例代码，运行时会抛出 NotImplemented 错误，任何好奇的人：

```
Stream stream = new FileStream("screenshot.jpg", FileMode.Create, FileAccess.Write, FileShare.None);
screenshot.SaveAsJpeg(stream, 320, 180);
stream.Close(); 
```

变量`screenshot`是`RenderTarget2D`绘制游戏画面的对象。

感谢阅读，希望能得到一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:04:03.653

SaveAsJpeg 定义为：

```
public void SaveAsJpeg(Stream stream, int width, int height)
{
#if WINDOWS_STOREAPP
    SaveAsImage(BitmapEncoder.JpegEncoderId, stream, width, height);
#elif WINDOWS_PHONE

    var pixelData = new byte[Width * Height * GraphicsExtensions.Size(Format)];
    GetData(pixelData);

    var waitEvent = new ManualResetEventSlim(false);
    Deployment.Current.Dispatcher.BeginInvoke(() =>
    {
        var bitmap = new WriteableBitmap(width, height);
        System.Buffer.BlockCopy(pixelData, 0, bitmap.Pixels, 0, pixelData.Length);
        bitmap.SaveJpeg(stream, width, height, 0, 100);
        waitEvent.Set();
    });

    waitEvent.Wait();
#elif MONOMAC
    SaveAsImage(stream, width, height, ImageFormat.Jpeg);
#else
    throw new NotImplementedException();
#endif
} 
```

可以加吗

```
#define WINDOWS_STOREAPP 
```

在你的主要课程中。

# java - Java - 为什么我的插入这么慢？

> ID：16156320
> 
> 赞同：3
> 
> 时间：2013-04-22T20:41:41.857
> 
> 标签：java, mysql

不知何故，我的 MySQL 插入真的很慢。即使我使用“批量插入”。大约 50 次插入最多需要 2000 毫秒。这是正常的还是有办法改进我的代码？

```
 String sql = "INSERT INTO wlw ( wlw_level, wlw_name, wlw_url, wlw_processing, wlw_finished, wlw_source )"
                        + "VALUES(?, ?, ?, ?, ?, ?)";
            PreparedStatement preparedStatement = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);

            for(QueryStore qs : QueryStore) {
                preparedStatement.setInt(1, qs.level);
                preparedStatement.setString(2, qs.anchor);
                preparedStatement.setString(3, qs.url);
                preparedStatement.setInt(4, qs.processing);
                preparedStatement.setInt(5, qs.finished);
                preparedStatement.setLong(6, qs.id);
                preparedStatement.addBatch();
                System.out.println("Adding URL: " + qs.url);
            }
            System.out.println("Start saving ...");
            long then = System.currentTimeMillis(); 
            preparedStatement.executeBatch();
            long now = then - System.currentTimeMillis();
            System.out.println("SAVING END - Took me " + now + "ms"); 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T20:45:39.403

尝试添加`rewriteBatchedStatements=true`到您的连接参数。

# ios - iPad OpenGL ES 极慢 glResolveMultisampleFramebufferAPPLE()

> ID：16156323
> 
> 赞同：1
> 
> 时间：2013-04-22T20:41:59.473
> 
> 标签：ios, ipad, opengl-es, multisampling

我正在使用 OpenGL ES 分析器。它表明调用 glResolveMultisampleFramebufferAPPLE() 需要大约 90% 的运行时间。这是典型的，还是我的代码效率低下？这是我的绘图代码：

```
glBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

// Draw Stuff . . . 

glBindFramebuffer(GL_DRAW_FRAMEBUFFER_APPLE, defaultFramebuffer);
glBindFramebuffer(GL_READ_FRAMEBUFFER_APPLE, sampleFramebuffer);
glResolveMultisampleFramebufferAPPLE();

const GLenum discard1[]  = {GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT};
glDiscardFramebufferEXT(GL_READ_FRAMEBUFFER_APPLE, 2, discard1);
const GLenum discard2[]  = {GL_DEPTH_ATTACHMENT};
glDiscardFramebufferEXT(GL_DRAW_FRAMEBUFFER_APPLE, 1, discard2);

glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);
[[EAGLContext currentContext] presentRenderbuffer:GL_RENDERBUFFER]; 
```

场景很复杂，每帧渲染超过一百万个三角形。我认为我的慢帧速率（10 fps）是由于绘制调用 - 而不是多重采样。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T23:13:35.077

如果你在 iPad 上，尤其是在 Retina 上，多重采样可能会非常昂贵，所以这对我来说并不奇怪。我知道在许多图形视频卡上，他们不再吹嘘自己有能力抽出数百万个多边形，因为每个人都知道你推了多少 tris 并不重要，因为你的后期处理和你的着色器真的占用了你所有的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T17:14:47.820

这是一个棘手的问题。我不能说我所做的更改所有的细节都是正确的，但我相信我从 OpenGL ES Analyzer 和我自己的日志信息中得到了相互矛盾的信息。我自己的日志告诉我，每次单独调用 glDrawElements() 所花费的时间，这表明三角形的数量是问题所在。我开始根据所需的细节使用不同的 VAO，这很有帮助。

# c - Linux 套接字上的 SO_SNDBUF 和 SO_RCVBUF

> ID：16156326
> 
> 赞同：2
> 
> 时间：2013-04-22T20:42:09.853
> 
> 标签：c, sockets, linux-kernel

我正在编写客户端服务器应用程序。简单地说，服务器可以为每个客户端使用 UDP 或 TCP。

我希望 TCP 客户端和 UDP 客户端都打印 and 的默认值 `SO_SNDBUF`，`SO_RCVBUF`但是当我在连接建立之前打印 sndbuf 和 rcvbuf 的默认值时，我很惊讶，值为 0。

**注意**：我使用的是 Ubuntu 12.10

这是我的代码：

```
//assume all variables initialized correctly.

/* SO_RCVBUF options */

len = sizeof(rcvbuf);
getsockopt(sockfd, SOL_SOCKET, SO_RCVBUF, &rcvbuf, &len);
len = sizeof(mss);
getsockopt(sockfd, IPPROTO_TCP, TCP_MAXSEG, &mss, &len);
printf("defaults: SO_RCVBUF = %d, MSS = %d\n", rcvbuf, mss);

rcvbuf = 9973;      /* a prime number */
setsockopt(sockfd, SOL_SOCKET, SO_RCVBUF, &rcvbuf, sizeof(rcvbuf));
len = sizeof(rcvbuf);
getsockopt(sockfd, SOL_SOCKET, SO_RCVBUF, &rcvbuf, &len);
printf("SO_RCVBUF = %d (after setting it to 9973)\n\n\n\n", rcvbuf); 

/* SO_RCVBUF options */

/* SO_SNDBUF options */

len2 = sizeof(sndbuf);
getsockopt(sockfd, SOL_SOCKET, SO_SNDBUF, &sndbuf, &len2);
//len2 = sizeof(mss2);
getsockopt(sockfd, IPPROTO_TCP, TCP_MAXSEG, &mss2, &len2);
printf("defaults: SO_SNDBUF = %d, MSS = %d\n", sndbuf, mss2);

sndbuf = 9979;      /* a prime number */
setsockopt(sockfd, SOL_SOCKET, SO_SNDBUF, &sndbuf, sizeof(sndbuf));
len2 = sizeof(sndbuf);
getsockopt(sockfd, SOL_SOCKET, SO_SNDBUF, &sndbuf, &len2);
printf("SO_SNDBUF = %d (after setting it to 9979)\n", sndbuf);

/* SO_SNDBUF options */ 
```

**样本输出：**

> 默认值：SO_RCVBUF = 0，MSS = 0
> 
> SO_RCVBUF = 9973（设置为 9973 后）
> 
> 默认值：SO_SNDBUF = 0，MSS = 0
> 
> SO_SNDBUF = 9979（设置为 9979 后）
> 
> tcp_time nes411_server
> 
> 当前时间是（TCP）：Mon Apr 22 23:40:46 2013

连接后：

> SO_SNDBUF = 170840，MSS = 16384

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:58:27.217

显然，发送缓冲区和接收缓冲区是在您`connect(),`之前调用时分配的。您可能即将使用套接字进行侦听，在这种情况下，两个缓冲区都将完全浪费空间。或者一无所有，同上。

注意为什么你使用质数？通常使用 2 的幂作为缓冲区大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-08T09:59:46.850

您可以从下面的代码中检查默认套接字缓冲区。

```
int rcvBufferSize;
int sockOptSize = sizeof(rcvBufferSize);
getsockopt(udp_fd, SOL_SOCKET, SO_RCVBUF, &rcvBufferSize, &sockOptSize);
printf("initial socket receive buf %d\n", rcvBufferSize); 
```

[https://gist.github.com/rdp/8198697](https://gist.github.com/rdp/8198697)

# php - 虽然循环不会结束

> ID：16156329
> 
> 赞同：-3
> 
> 时间：2013-04-22T20:42:18.950
> 
> 标签：php, while-loop

我正在运行一个基于文本的游戏，并试图让一个函数使用 while 循环重复自身，但是当满足条件时它不会停止。

```
<?php
/****************************************************************/
/*********************** Created By Seker ***********************/
/**** Feel free to modify in any way, but keep this section. ****/
/****************************************************************/
session_start();
require "global_func.php";
if ($_SESSION['loggedin'] == 0)
{
header("Location: login.php");
exit;
}
$userid = $_SESSION['userid'];
require "header.php";
$h = new headers;
$h->startheaders();
include "mysql.php";
global $c;
$is =
    mysql_query(
            "SELECT u.*,us.* FROM users u LEFT JOIN userstats us ON u.userid=us.userid WHERE u.userid=$userid",
            $c) or die(mysql_error());
$ir = mysql_fetch_array($is);
check_level();
$fm = money_formatter($ir['money']);
$cm = money_formatter($ir['crystals'], '');
$lv = date('F j, Y, g:i a', $ir['laston']);
$h->userdata($ir, $lv, $fm, $cm);
$h->menuarea();

switch ($_GET['action'])
{
case 'walk':
walk();
break;

case 'walk2':
 walk();
 break;

default:
home();
break;
}

function home()
{

global $ir,$h,$c,$userid;

$q=mysql_query("SELECT u.*,c.* FROM users u LEFT JOIN cities c ON u.location=c.cityid WHERE u.userid=$userid");
$r=mysql_fetch_array($q);

$city = $r['cityname'];
$trav = $ir['steps'];

echo "
    <table width='70%' border='1'>
        <tr>
            <td align='center'>
                <font size='3'><b><u>The $city Streets</u></b></font>
            </td>
        </tr>
        <tr>
            <td align='center'>
                Take your chances with a walk through the $city streets!
            </td>
        </tr>
        <tr>
            <td align='center'>
                Each day, you get <b>10</b> steps! <b>25</b> if you are a donator!
            </td>
        </tr>
        <tr>
            <td align='center'>
                While traveling, you can find crystals, cash, or even gain experience!
            </td>
        </tr>
        <tr>
            <td align='center'>
                But, be careful! There are dangers in the streets!
            </td>
        </tr>
    </table>
";

echo "
    <table width='70%' border='1'>
        <tr>
            <td align='center' colspan='2'>
                <font size='3'><b><u>What would you like to do?</u></b></font>
            </td>
        </tr>
        <tr>
            <td align='center' colspan='2'>
                You can travel <b>{$trav}</b> more times today!
            </td>
        </tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'>[Go For A Walk]</a>
            </td>
            <td align='center' width='50%'>
                <a href='index.php'>[Change Your Mind]</a>
            </td>
        </tr>
    </table>
";
}

function walk()
{
do
{

global $ir,$h,$c,$userid;

$q=mysql_query("SELECT u.*,c.* FROM users u LEFT JOIN cities c ON u.location=c.cityid WHERE u.userid=$userid");
$r=mysql_fetch_array($q);

$chance = mt_rand(1,100);
$city = $r['cityname'];
$trav = $ir['steps'];

if ($ir['steps'] <= 0)
{
    echo "
        You have traveled enough for today! Come back tomorrow!
        <a href='index.php'>Home</a>";
        exit($h->endpage());
}

if ($ir['hospital'])
{
    echo "
        You cannot travel while in the hospital!
        <a href='index.php'>Home</a>";
        exit($h->endpage());
}

if ($ir['jail'])
{
    echo "
        You cannot travel while in jail!
        <a href='index.php'>Home</a>";
        exit($h->endpage());
}

echo "
    <table width=70% border='1'>
        <tr>
            <td align='center' width='50%'>
                <font size='2'>You start your journey through the $city streets!</font>
            </td>
            <td align='center' width='50%'>
                <font size='2'>You can travel up to <b>{$trav}</b> more times today!</font>
            </td>
        </tr>
        <tr>";

if ($chance <= 10)
{
    $rewardtok = mt_rand(5,15);

    mysql_query("UPDATE users SET crystals=crystals+$rewardtok,steps=steps-1 WHERE userid=$userid");

    echo "
                <td align='center' colspan='2'>
                    Congratulations! You found <b>$rewardtok</b> crystals while walking through the streets!
                </td>
            </tr>
            <tr>
                <td align='center' width='50%'>
                    <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
                </td>
                <td align='center' width='50%'>
                    <a href='streets.php'><b>[Back]</b></a>
                </td>
            </tr>
        </table>";
}

if (($chance >= 15) && ($chance <= 30))
{
    $rewardg = mt_rand(100,5000);
    $reward = money_formatter($rewardg);

    mysql_query("UPDATE users SET money=money+$rewardg,steps=steps-1 WHERE userid=$userid");

    echo "
                <td align='center' colspan='2'>
                    Congratulations! You found <b>$reward</b> while walking through the streets!
                </td>
            </tr>
            <tr>
                <td align='center' width='50%'>
                    <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
                </td>
                <td align='center' width='50%'>
                    <a href='streets.php'><b>[Back]</b></a>
                </td>
            </tr>
        </table>";
}

if (($chance >= 40) && ($chance <= 50))
{
    $rewardexp = mt_rand(5,50) * ($ir['level'] /2);

    mysql_query("UPDATE users SET exp=exp+$rewardexp,steps=steps-1 WHERE userid=$userid");

    echo "
                <td align='center' colspan='2'>
                    Congratulations! You gained <b>$rewardexp<b> experience while walking through the streets!
                </td>
            </tr>
            <tr>
                <td align='center' width='50%'>
                    <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
                </td>
                <td align='center' width='50%'>
                    <a href='streets.php'><b>[Back]</b></a>
                </td>
            </tr>
        </table>";
}

if (($chance >= 55) && ($chance <= 65))
{
    $rewardexp = mt_rand(5,50);

    mysql_query("UPDATE users SET exp=exp+$rewardexp,steps=steps-1 WHERE userid=$userid");

    echo "
                <td align='center' colspan='2'>
                    Congratulations! You gained <b>$rewardexp<b> experience while walking through the streets!
                </td>
            </tr>
            <tr>
                <td align='center' width='50%'>
                    <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
                </td>
                <td align='center' width='50%'>
                    <a href='streets.php'><b>[Back]</b></a>
                </td>
            </tr>
        </table>";
        }

 if (($chance >= 75) && ($chance <= 85))
    {
     $rewardtok = mt_rand(5,15);

    mysql_query("UPDATE users SET crystals=crystals+$rewardtok,steps=steps-1 WHERE userid=$userid");

    echo "
                <td align='center' colspan='2'>
                    Congratulations! You found <b>$rewardtok</b> crystals while walking through the streets!
                </td>
            </tr>
            <tr>
                <td align='center' width='50%'>
                    <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
                </td>
                <td align='center' width='50%'>
                    <a href='streets.php'><b>[Back]</b></a>
                </td>
            </tr>
        </table>";
 }
if ((($chance > 10) && ($chance < 15)) || (($chance > 30) && ($chance < 40)) || (($chance > 50) && ($chance < 55)) || (($chance > 65) && ($chance < 75)) || ($chance > 85))
{
     $rewardtok = mt_rand(5,15);
      mysql_query("UPDATE users SET steps=steps-1 WHERE userid=$userid");

    echo "
                <td align='center' colspan='2'>
                    You found nothing while walking through the streets
                </td>
            </tr>
            <tr>
                <td align='center' width='50%'>
                    <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
                </td>
                <td align='center' width='50%'>
                    <a href='streets.php'><b>[Back]</b></a>
                </td>
            </tr>
        </table>";

  }

 }
while ($ir['steps'] > 0);
}
$h->endpage(); 
```

该函数应该运行直到 step 值为 0，当函数运行一次时，它会从总数中减去。但是当它达到 0 时它并没有停止，我得到这样的东西“步骤：-15535”

我相信这是“重生代码”

```
function walk()
{
do
{

global $ir,$h,$c,$userid;

$q=mysql_query("SELECT u.*,c.* FROM users u LEFT JOIN cities c ON u.location=c.cityid WHERE u.userid=$userid");
$r=mysql_fetch_array($q);

$chance = mt_rand(1,100);
$city = $r['cityname'];
$trav = $ir['steps'];

if ($ir['steps'] <= 0)
{
echo "
    You have traveled enough for today! Come back tomorrow!
    <a href='index.php'>Home</a>";
    exit($h->endpage());
}

if ($ir['hospital'])
{
echo "
    You cannot travel while in the hospital!
    <a href='index.php'>Home</a>";
    exit($h->endpage());
}

if ($ir['jail'])
{
echo "
    You cannot travel while in jail!
    <a href='index.php'>Home</a>";
    exit($h->endpage());
}

echo "
<table width=70% border='1'>
    <tr>
        <td align='center' width='50%'>
            <font size='2'>You start your journey through the $city streets!</font>
        </td>
        <td align='center' width='50%'>
            <font size='2'>You can travel up to <b>{$trav}</b> more times today!</font>
        </td>
    </tr>
    <tr>";

if ($chance <= 10)
{
$rewardtok = mt_rand(5,15);

mysql_query("UPDATE users SET crystals=crystals+$rewardtok,steps=steps-1 WHERE userid=$userid");

echo "
            <td align='center' colspan='2'>
                Congratulations! You found <b>$rewardtok</b> crystals while walking through the streets!
            </td>
        </tr>
        <tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
            </td>
            <td align='center' width='50%'>
                <a href='streets.php'><b>[Back]</b></a>
            </td>
        </tr>
    </table>";
}

if (($chance >= 15) && ($chance <= 30))
{
$rewardg = mt_rand(100,5000);
$reward = money_formatter($rewardg);

mysql_query("UPDATE users SET money=money+$rewardg,steps=steps-1 WHERE userid=$userid");

echo "
            <td align='center' colspan='2'>
                Congratulations! You found <b>$reward</b> while walking through the streets!
            </td>
        </tr>
        <tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
            </td>
            <td align='center' width='50%'>
                <a href='streets.php'><b>[Back]</b></a>
            </td>
        </tr>
    </table>";
}

if (($chance >= 40) && ($chance <= 50))
{
$rewardexp = mt_rand(5,50) * ($ir['level'] /2);

mysql_query("UPDATE users SET exp=exp+$rewardexp,steps=steps-1 WHERE userid=$userid");

echo "
            <td align='center' colspan='2'>
                Congratulations! You gained <b>$rewardexp<b> experience while walking through the streets!
            </td>
        </tr>
        <tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
            </td>
            <td align='center' width='50%'>
                <a href='streets.php'><b>[Back]</b></a>
            </td>
        </tr>
    </table>";
}

if (($chance >= 55) && ($chance <= 65))
{
$rewardexp = mt_rand(5,50);

mysql_query("UPDATE users SET exp=exp+$rewardexp,steps=steps-1 WHERE userid=$userid");

echo "
            <td align='center' colspan='2'>
                Congratulations! You gained <b>$rewardexp<b> experience while walking through the streets!
            </td>
        </tr>
        <tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
            </td>
            <td align='center' width='50%'>
                <a href='streets.php'><b>[Back]</b></a>
            </td>
        </tr>
    </table>";
    }

 if (($chance >= 75) && ($chance <= 85))
{
 $rewardtok = mt_rand(5,15);

mysql_query("UPDATE users SET crystals=crystals+$rewardtok,steps=steps-1 WHERE userid=$userid");

echo "
            <td align='center' colspan='2'>
                Congratulations! You found <b>$rewardtok</b> crystals while walking through the streets!
            </td>
        </tr>
        <tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
            </td>
            <td align='center' width='50%'>
                <a href='streets.php'><b>[Back]</b></a>
            </td>
        </tr>
    </table>";
 }
if ((($chance > 10) && ($chance < 15)) || (($chance > 30) && ($chance < 40)) || (($chance > 50) && ($chance < 55)) || (($chance > 65) && ($chance < 75)) || ($chance > 85))
{
 $rewardtok = mt_rand(5,15);
  mysql_query("UPDATE users SET steps=steps-1 WHERE userid=$userid");

echo "
            <td align='center' colspan='2'>
                You found nothing while walking through the streets
            </td>
        </tr>
        <tr>
            <td align='center' width='50%'>
                <a href='streets.php?action=walk'><b>[Continue Traveling]</b></a>
            </td>
            <td align='center' width='50%'>
                <a href='streets.php'><b>[Back]</b></a>
            </td>
        </tr>
    </table>";

  }

 }
while ($ir['steps'] > 0);
}
$h->endpage(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:44:13.220

```
$ir['steps'] 
```

在任何地方都没有改变/减少。

在循环结束之前递减它：

```
$ir['steps'] -= 1; 
```

就在循环的右括号之前。

# python - 读取文件文件夹？

> ID：16156333
> 
> 赞同：0
> 
> 时间：2013-04-22T20:42:44.297
> 
> 标签：python, file, list, python-3.x

我被分配编写一个捕捉抄袭者的程序。给定一个文件文件夹，我将如何逐个文件地遍历它们，构建每个文件中所有 6 词短语的列表。这方面的一个例子是

现在是所有好人来援助他们国家的时候了。

包含 6 个单词的短语：现在是所有人的时间，是所有人的时间，是所有人的时间，所有人的时间，所有人的时间，......等等。

```
ExampleFile=F.read('File')
index1=0
index2=5
List1=[]
while True:
     index1+=1
     index2+=1
     List1+= Examplefile[index1:index2] 
```

到目前为止，我已经创建了 6 个单词短语的列表。那么我将如何对每个文件执行此操作，然后比较这些结果以查看是否有任何两个文件有超过 200 个相同的短语？我在 Python 中使用文件方面做得很少，所以尽可能地把所有东西都简化了。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:34:01.037

由于这是家庭作业，我认为几个链接对您的帮助不仅仅是完整的代码。

查看[`os.listdir`](http://docs.python.org/3/library/os.html#os.listdir)列出文件夹中所有文件并[`os.walk`](http://docs.python.org/3/library/os.html#os.walk)遍历目录树的列表。

然后，您可以制作一个列表，其中每个项目都是短语的容器。我建议[`set`](http://docs.python.org/3/library/stdtypes.html#set-types-set-frozenset)对每个文件使用 a of 短语，以及此类集合的列表，或者可能是 a `set`of `frozenset`s。

然后，您可以采用这些集合的所有成对组合，[`itertools.combinations`](http://docs.python.org/3/library/itertools.html#itertools.combinations)并计算每对的[交集](http://docs.python.org/3/library/stdtypes.html#set.intersection)。如果任何交叉点的大小超过阈值，您就找到了抄袭者。

* * *

对您当前代码的评论：有一个命名约定，变量名称应以小写字母开头，大写名称用于类。

# redirect - 需要一种更好的方法来隐藏我的网站的附属链接

> ID：16156337
> 
> 赞同：-1
> 
> 时间：2013-04-22T20:43:00.413
> 
> 标签：redirect, affiliate

我有一个交易网站，其中包含来自每个附属商店（如 snapdeal、flipkart 等）的 100 个产品链接。所以我在我的主目录中编写了一个 php 文件 redirect.php。

我所有的产品链接[http://productlink.com](http://productlink.com)都带有前缀：[http://mysite.com/redirect.php?url=http://productlink.com](http://mysite.com/redirect.php?url=http://productlink.com)。因此，当用户单击 [http://mysite.com/redirect.php?url=http://productlink.com](http://mysite.com/redirect.php?url=http://productlink.com)时，产品链接的 GET url 参数[http://productlink.com](http://productlink.com)将传递给 redirect.php。

现在，redirect.php 处理 url GET 参数[http://productlink.com](http://productlink.com)，检查商店名称并根据商店名称适当地为其添加前缀和后缀，以将产品链接转换为附属链接并重定向到商店。

但问题是我的产品链接本身可能包含？。所以在我的网址中，我将有 2 个 ?'seg [http://mysite.com/redirect.php?url=http://productlink.com?id=red](http://mysite.com/redirect.php?url=http://productlink.com?id=red)。

现在redirect.php 将只接收“红色”作为查询获取参数。

那么我应该怎么做才能避免这个问题？？？？尽快等待帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:46:05.487

最简单的解决方案可能是使用`urlencode`和`urldecode`功能。

它们在这里被描述：

[http://php.net/manual/en/function.urlencode.php](http://php.net/manual/en/function.urlencode.php)

[http://www.php.net/manual/en/function.urldecode.php](http://www.php.net/manual/en/function.urldecode.php)

# java - 使用 RGBA 中的 alpha 使图像不透明度

> ID：16156343
> 
> 赞同：2
> 
> 时间：2013-04-22T20:43:15.523
> 
> 标签：java, image, opacity, rgb, rgba

我尝试制作一个简单的程序来加载图像，使其具有蓝色效果，并使其半透明。我通过在图像像素上运行并更改 RGB 的蓝色值和 alpha 值来做到这一点。我成功地为图像制作了漂亮的蓝色效果。但我无法改变图像的不透明度。似乎无论我如何更改像素的 alpha 值，它都不会影响图像。

这是我的代码：

```
try {
    image1 = ImageIO.read(new File("image1.png"));
} catch(IOException e) {e.printStackTrace();}

for(int x=0;x<image1.getWidth();x++) {
    for(int y=0;y<image1.getHeight();y++) {
        int rgb = image1.getRGB(x, y);
        Color color = new Color(rgb);
        int r = color.getRed();
        int g = color.getGreen();
        int b = color.getBlue();
        int a = color.getAlpha();

        System.out.println(a);
        a= 100;
        if(b<155)
            b+=100;
        else
            b=255;

        color = new Color(r,g,b,a);

        image1.setRGB(x, y, color.getRGB());
    }
} 
```

更新：我也试过这个。仍然不起作用：

```
for(int x=0;x<image1.getWidth();x++) {
    for(int y=0;y<image1.getHeight();y++) {
        int rgb = image1.getRGB(x, y);
        Color color = new Color(rgb,true);
        int r = color.getRed();
        int g = color.getGreen();
        int b = color.getBlue();
        int a = color.getAlpha();

        a= 100;
        if(b<155)
            b+=100;
        else
            b=255;

        rgb = rgb | b;
        rgb = rgb & 0x33ffffff;

        image1.setRGB(x, y, rgb);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T21:15:25.280

使用[AlphaComposite](http://docs.oracle.com/javase/tutorial/2d/advanced/compositing.html)：

```
BufferedImage img = //some code here
BufferedImage imgClone = //some clone of img, but let its type be BufferedImage.TYPE_INT_ARGB
Graphics2D imgCloneG = imgClone.createGraphics();
imgCloneG.setComposite(AlphaComposite.getInstance(AlphaComposite.DST_IN, 0.5f));
imgCloneG.drawImage(img, 0, 0, null);
//imgClone is now img at half alpha 
```

`imgClone`可以这样制作：

```
...
imgClone = new BufferedImage(img.getWidth(), img.getHeight(), 
                             BufferedImage.TYPE_INT_ARGB);
Graphics2D imgCloneG = imgClone.createGraphics();
imgCloneG.drawImage(img, 0, 0, null);
imgCloneG.setComposite(AlphaComposite.getInstance(AlphaComposite.DST_IN, 0.5f));
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:51:06.017

仅采用 an的`Color`构造函数会`int`创建不透明的颜色（使用 alpha 255）。当你再次用 取出 alpha 时`getAlpha()`，这里总是 255。

相关的 Java`Color`代码，来自第 413 行（至少在 Java 1.7 中）：

```
public Color(int rgb) {
    value = 0xff000000 | rgb;
} 
```

设置了最重要的 8 个字节，覆盖了那里的任何 alpha 组件。

要保留 alpha 分量，您需要使用[`Color`构造函数](http://docs.oracle.com/javase/7/docs/api/java/awt/Color.html#Color%28int,%20boolean%29)，该构造函数接受`int`值*和*`boolean`是否具有 alpha 分量。

```
Color color = new Color(rgb, true); 
```

# jquery - 删除链接并根据日期添加课程

> ID：16156345
> 
> 赞同：2
> 
> 时间：2013-04-22T20:43:31.220
> 
> 标签：jquery

我有一个用 html 和 php 构建的日历，我有以下格式来列出月份链接：

```
 <ul class="month-list">
        <li class="nolink">Jan</li>
        <li class="nolink">Feb</li>
        <li class="nolink">Mar</li>
        <li><a href="?month=April">Apr</a></li>
        <li><a href="?month=May">May</a></li>
        <li><a href="?month=June">Jun</a></li>
        <li><a href="?month=July">Jul</a></li>
        <li><a href="?month=August">Aug</a></li>
        <li><a href="?month=September">Sep</a></li>
        <li><a href="?month=October">Oct</a></li>
        <li><a href="?month=November">Nov</a></li>
        <li><a href="?month=December">Dec</a></li>
    </ul> 
```

如果月份已过，我需要与 jQuery 进行日期比较以删除链接，并添加 nolink 类，但无法找到正确的语法。

我正在寻找本质上执行此操作的语法：如果 Month = Current Month，则删除前几个月的链接并添加类“nolink”

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:49:44.517

使用`:lt()`jQuery 选择器和 JS`new Date().getMonth()`很简单：

`**[LIVE DEMO](http://jsbin.com/igukuy/6/edit)**`

```
var m = new Date().getMonth(); // Returns the curr. month "zero" based (0 -> 11)

$('.month-list li:lt('+ m +')').each(function(){
  $('a', this).contents().unwrap('a').parent('li').addClass('nolink');
}); 
```

用所有月份来测试它，而不是在演示中`var m = new Date().getMonth();`手动输入值 from `0`to 。`11`这会有点棘手，但只要考虑当前月份是`a value -1`

# c++ - 使用“new”关键字时，sSYSMALLOc 断言失败

> ID：16156347
> 
> 赞同：0
> 
> 时间：2013-04-22T20:43:37.067
> 
> 标签：c++, gdb, new-operator, valgrind

> **编辑：**为清楚起见，我将保持原样。问题似乎是`Kameleon`该类使用`boost`，并且由于我自己的代码也使用它，因此可能存在冲突的版本，这就是问题所在。

**原始问题：**

很多信息，但我试图将其归结为有趣的部分。我正在编写一个应用程序，它使用类的实例`Kameleon`（我自己没有编写）来执行各种任务。当我尝试使用`new`关键字分配实例时，我遇到了麻烦。这是问题的缩小版本：

```
#include <ccmc/Kameleon.h>

int main() {
  ccmc::Kameleon k;
  ccmc::Kameleon *k2 = new ccmc::Kameleon(); // <-- crashes with this line
  delete k2:
  return 0;
 } 
```

旁注：注释掉`new`分配`k2`并仅运行`ccmc::Kameleon k`作品，我可以使用该变量。但是，当我尝试时 main() 返回时，程序会出现段错误。析构函数什么都不做。

`Kameleon 构造函数执行以下操作：

```
// Kameleon.cpp
/*47*/ Kameleon::Kameleon() : model(NULL), // model is a non-const pointer 
/*48*/                        modelName("NA"), // modelName is a non-const std::string
/*49*/                        missingValue(0.f) // missingValue is a non-const float
/*50*/ {} 
```

我已经尝试了错误消息、gdb 和 valgrind 的问题，但似乎找不到源。这是运行程序给我的：

```
FurnaceApp: malloc.c:2451: sYSMALLOc: Assertion `(old_top == (((mbinptr) (((char *) &((av)->bins[((1) - 1) * 2])) - __builtin_offsetof (struct malloc_chunk, fd)))) && old_size == 0) || ((unsigned long) (old_size) >= (unsigned long)((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))+((2 * (sizeof(size_t))) - 1)) & ~((2 * (sizeof(size_t))) - 1))) && ((old_top)->size & 0x1) && ((unsigned long)old_end & pagemask) == 0)' failed.
Aborted (core dumped) 
```

gdb 告诉我以下内容：

```
(gdb) bt
#0  0x00007ffff6b1c425 in __GI_raise (sig=<optimized out>) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64
#1  0x00007ffff6b1fb8b in __GI_abort () at abort.c:91
#2  0x00007ffff6b6415d in __malloc_assert (assertion=<optimized out>, file=<optimized out>, line=<optimized out>, function=<optimized out>)
    at malloc.c:300
#3  0x00007ffff6b67664 in sYSMALLOc (av=0x7ffff6e9e720, nb=48) at malloc.c:2448
#4  _int_malloc (av=0x7ffff6e9e720, bytes=27) at malloc.c:3892
#5  0x00007ffff6b68fb5 in __GI___libc_malloc (bytes=27) at malloc.c:2924
#6  0x00007ffff746cded in operator new(unsigned long) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#7  0x00007ffff7455a89 in std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) ()
   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#8  0x00007ffff7457495 in char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#9  0x00007ffff74575e3 in std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#10 0x00007ffff7757caf in ccmc::Kameleon::Kameleon (this=0x67d920) at Kameleon.cpp:49
#11 0x0000000000415516 in main () 
```

最后，valgrind 给了我很多输出，但这部分看起来最像前面的错误：

```
==11789== Invalid write of size 8
==11789==    at 0x52ECC8D: ccmc::Kameleon::Kameleon() (buckets.hpp:128)
==11789==    by 0x415515: main (in /home/vsand/OpenSpace/Furnace/FurnaceApp)
==11789==  Address 0x6683a00 is 0 bytes after a block of size 464 alloc'd
==11789==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==11789==    by 0x41550A: main (in /home/vsand/OpenSpace/Furnace/FurnaceApp)
==11789== 
==11789== Invalid write of size 8
==11789==    at 0x52ECC94: ccmc::Kameleon::Kameleon() (table.hpp:226)
==11789==    by 0x415515: main (in /home/vsand/OpenSpace/Furnace/FurnaceApp)
==11789==  Address 0x6683a28 is not stack'd, malloc'd or (recently) free'd
==11789== 
==11789== Invalid write of size 8
==11789==    at 0x52ECC9F: ccmc::Kameleon::Kameleon() (Kameleon.cpp:49)
==11789==    by 0x415515: main (in /home/vsand/OpenSpace/Furnace/FurnaceApp)
==11789==  Address 0x6683a30 is not stack'd, malloc'd or (recently) free'd
==11789== 
```

到处看看，似乎这些错误通常在使用`malloc`不当和超出分配的内存等写入时出现。类中有很多代码`Kameleon`，但由于我自己没有编写它，所以我在尝试追踪它时遇到了问题。任何错误搜寻技巧将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:47:26.830

你能试一下吗：

```
Kameleon::Kameleon(): model(NULL), modelName("N/A") {
    // ...
} 
```

是`modelName`const 吗？

您还可以删除构造函数中的所有 unesseray 代码`CDFReader`以隔离错误吗？甚至更好：

```
#include "Kameleon.h" // or whatever

int main(){
    ccmc::Kameleon k;
    ccmc::Kameleon *k2 = new ccmc::Kameleon();
    delete k2;
} 
```

是`Kameleon`派生类吗？它会使`new`操作员过载吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T03:58:58.883

```
==11789== Invalid write of size 8
==11789==    at 0x52ECC8D: ccmc::Kameleon::Kameleon() (buckets.hpp:128)
==11789==    by 0x415515: main (in /home/vsand/OpenSpace/Furnace/FurnaceApp)
==11789==  Address 0x6683a00 is 0 bytes after a block of size 464 alloc'd
==11789==    at 0x4C2B1C7: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==11789==    by 0x41550A: main (in /home/vsand/OpenSpace/Furnace/FurnaceApp) 
```

这意味着：

*   您分配实例的代码`ccmc::Kameleon`认为`sizeof(ccmc::Kameleon)`是 464，而
*   您的代码实际上实现了`ccmc::Kameleon::Kameleon()`对 bytes 的写入`[this+464, this+472)`。

最可能的原因：

*   您已更改 中的类的定义`buckets.hpp`，并且
*   您没有重新编译*所有*使用它的代码，因此违反了[单一定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)。

您*必须*重建*所有*使用 的代码`Kameleon`，一旦这样做，您的问题就会消失。

> buckets.hpp 来自 boost 标头

另一种可能性是您正在链接一个针对不同版本的 Boost 编译的库。那*行不通*，您*必须*使用完全相同版本的Boost。

最后一种可能性是 Boost 是用一组不一致的`-DXX`标志编译的，导致`Kameleon`类的不同定义（并且再次违反了一个定义规则）。

# php - 完成的表格保存到新页面

> ID：16156350
> 
> 赞同：1
> 
> 时间：2013-04-22T20:43:43.093
> 
> 标签：php

我有一个 HTML 表单，当提交时它会转到一个 php 页面，该页面编写一个新的 HTML，其中新的 HTML 具有写入它的第一个 HTML 页面的值。

前任。在输入：文本中，我输入“hi”并点击提交。然后进入一个 php 页面，该页面创建新的 HTML，其中 input:text 具有 value="hi"

我在下面发布的代码有效，但我必须放置一个“虚拟”名称=“x”来替换为值=“myvalue”。有没有办法将它添加到元素中而不是替换某些东西。

还有一种方法可以使用它来将值放入 textarea 中吗？

使用此问题的帮助：[使用 wkhtmltopdf 将当前页面打印为 pdf](https://stackoverflow.com/questions/15983018/printing-the-current-page-to-pdf-using-wkhtmltopdf)我正在使用此代码：

```
$documentTemplate = file_get_contents ("form.html");

foreach ($_POST as $key => $postVar)
{
if($postVar == "on")
    $documentTemplate = preg_replace ("/name=\"$key\"/", "checked", $documentTemplate);

else
    $documentTemplate = preg_replace ("/name=\"$key\"/", "value=\"$postVar\"",         $documentTemplate);
}

file_put_contents ("form_complete.html", $documentTemplate);

$html = file_get_contents("form_complete.html");

echo $html; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:53:19.650

无需使用 file_get_contents 将所有 HTML 加载到变量中，只需将 PHP 文件用作 HTML 模板。无论你想在哪里使用 PHP 变量，添加：

```
<?php echo $somevar; ?> 
```

确保在渲染之前验证您在模板中回显的变量是否存在。您可能希望在模板顶部放置一个 PHP 块，以验证和设置您要使用的所有变量：

```
<?php
if(isset($_POST['on'])){
  $on = $_POST['on'];
}
else
{
  $on = '';
}
?>

<html>
  <head>
  </head>
  <body>
    <form action="thispage.php" method="POST">
      <input type="text" name="on" value="<?php echo $on; ?>">
    </form>
  </body>
</html> 
```

您会及时发现您希望将它们分成多个文件，在这种情况下，您可以将 HTML 放入一个文件中`view.php`，然后将验证代码放入一个文件中，`validate.php`然后您可以使用 require（或 require_once）方法来包含在验证器的末尾查看。

有一些常用的模式用于分离逻辑和显示。谷歌MVC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T20:46:55.747

这可以简单地通过将表单的值传递给`somepage.php`使用`POST`or来完成`GET`- 我`POST`在下面的示例中使用过。`somepage.php`然后将检查以确保向其传递了一个值，如果确实传递了一个值，则将生成一个表单，其中包含一个包含发布数据的输入字段。

```
<form action="somepage.php" method="post">
    <input type="text" name="some_field" />
</form> 
```

Somepage.php

```
if(isset($_POST['some_field'])){
echo '
    <form action="">
        <input type="text" value="' . $_POST['some_field'] . '" />
    </form>';
}
else
{
echo 'post data below: <br>';
echo '<pre>';
print_r($_POST);
echo '</pre>';
} 
```

# jquery - 带有复选框和多列的 HTML 选择

> ID：16156352
> 
> 赞同：0
> 
> 时间：2013-04-22T20:43:48.500
> 
> 标签：jquery, html

有人知道一个 jquery 脚本来制作带有复选框和多列的 html 选择选项吗？

类似于此[http://code.google.com/p/dropdown-check-list/](http://code.google.com/p/dropdown-check-list/)但不是那么复杂并且可能包含多个列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:00:10.270

除了我在评论中提到的 Infragistics igCombo 控件之外，还有 jQuery ComboBox 模板 ( [http://jqcmbx.codeplex.com/](http://jqcmbx.codeplex.com/) )，它似乎有一个基于模板的组合框。这应该允许您根据需要设置组合框项目的样式，包括多个列和复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:05:02.297

你可以看到[这个](http://tympanus.net/codrops/2010/07/14/ui-elements-search-box/)

它有一个现场演示和源代码。

# mysql - 使用 MySQL 数据库的 Ruby on Rails 项目

> ID：16156357
> 
> 赞同：1
> 
> 时间：2013-04-22T20:44:05.007
> 
> 标签：mysql, ruby-on-rails, ruby

我是 ror 的初学者。我正在开发 ubuntu。

我可以使用默认数据库创建一个新的 ror 项目，一切正常。但我想创建一个具有 mysql 数据库的项目。

我使用这个命令：

```
railse new myproject -d mysql 
```

然后，我在 database.myl 文件上设置了我的 mysql 用户名和密码，但是当我尝试启动服务器时，我收到了这个错误消息，所以它不起作用：

```
=> Booting WEBrick
=> Rails 3.2.13 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/mysql2-0.3.11/lib/mysql2/client.rb:44:in `connect': no implicit conversion of Fixnum into String (TypeError)
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/mysql2-0.3.11/lib/mysql2/client.rb:44:in `initialize'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/mysql2_adapter.rb:16:in `new'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/mysql2_adapter.rb:16:in `mysql2_connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:315:in `new_connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:325:in `checkout_new_connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:247:in `block (2 levels) in checkout'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `loop'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `block in checkout'
    from /home/mehmet/.rvm/rubies/ruby-2.0.0-p0/lib/ruby/2.0.0/monitor.rb:211:in `mon_synchronize'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:239:in `checkout'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:102:in `block in connection'
    from /home/mehmet/.rvm/rubies/ruby-2.0.0-p0/lib/ruby/2.0.0/monitor.rb:211:in `mon_synchronize'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:101:in `connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_pool.rb:410:in `retrieve_connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_specification.rb:171:in `retrieve_connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/connection_adapters/abstract/connection_specification.rb:145:in `connection'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/activerecord-3.2.13/lib/active_record/railtie.rb:88:in `block in <class:Railtie>'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/initializable.rb:30:in `instance_exec'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/initializable.rb:30:in `run'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/initializable.rb:54:in `each'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/initializable.rb:54:in `run_initializers'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/application.rb:136:in `initialize!'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /home/mehmet/Desktop/ror/neistersin/config/environment.rb:5:in `<top (required)>'
    from /home/mehmet/Desktop/ror/neistersin/config.ru:3:in `require'
    from /home/mehmet/Desktop/ror/neistersin/config.ru:3:in `block in <main>'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize'
    from /home/mehmet/Desktop/ror/neistersin/config.ru:in `new'
    from /home/mehmet/Desktop/ror/neistersin/config.ru:in `<main>'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/builder.rb:40:in `eval'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/builder.rb:40:in `parse_file'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/server.rb:200:in `app'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/commands/server.rb:46:in `app'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/server.rb:304:in `wrapped_app'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/rack-1.4.5/lib/rack/server.rb:254:in `start'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/commands/server.rb:70:in `start'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/commands.rb:55:in `block in <top (required)>'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/commands.rb:50:in `tap'
    from /home/mehmet/.rvm/gems/ruby-2.0.0-p0/gems/railties-3.2.13/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-11T01:20:22.477

在 database.yml 中：

密码：123

应该

密码：'123'

笔记： '

这可能不是最终解决方案，而是解决问题的第一步。

# liquibase - 如何从 Liquibase 生命周期调用 Java 代码？

> ID：16156359
> 
> 赞同：1
> 
> 时间：2013-04-22T20:44:12.510
> 
> 标签：liquibase

我想在 liquibase 中应用变更集后运行代码。基本上，在将列添加到表后，我需要调用我的 DBA 提供的存储过程。我一直在研究 Liquibase API，但还没有发现任何明显的东西。

谢谢，赎金

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:44:00.607

今天早上有一些时间玩 liquibase 并想出了这个，这不是很好，但应该适用于我现在所拥有的。

```
 Database database = DatabaseFactory.getInstance().findCorrectDatabaseImplementation(new JdbcConnection(connection));
    Liquibase liquibase = new Liquibase("update.xml", new FileSystemResourceAccessor(), database);
    List<ChangeSet> changeSets = liquibase.listUnrunChangeSets(null);
    liquibase.update(null);
    for (RanChangeSet ranChangeSet: database.getRanChangeSetList()) {
        ChangeSet found = null;
        for (ChangeSet changeSet: changeSets) {
            if (ranChangeSet.isSameAs(changeSet)) {
                found = changeSet;
                break;
            }
        }

        if (found == null) {
            // ran previously
            continue;
        }
        System.out.println(ranChangeSet.getChangeLog());
        for (Change change: found.getChanges()) {
            if (change instanceof CreateTableChange) {
                System.out.println(( (CreateTableChange)change ).getTableName());
            }
            // handle others
        }
    } 
```

# c# - 列表 .Add() 创建重复 c#

> ID：16156363
> 
> 赞同：0
> 
> 时间：2013-04-22T20:44:31.940
> 
> 标签：c#, .net, list, ado.net

我围绕 System.Data.SQLite 构建了一个包装器方法，它允许我执行参数化查询。

当我尝试通过 .Add() 将 SQLiteParameter[] 添加到列表中时，列表中的所有项目都成为添加的最后一个项目的重复项。

这是代码：

```
string sql = "INSERT INTO request_flow (request_id, sequence, date_assigned " +
            "VALUES (@request_id, @sequence, @date_assigned);";

List<SQLiteParameter[]> paramList = new List<SQLiteParameter[]>();

SQLiteParameter[] param = new SQLiteParameter[3];

SQLiteParameter p1 = new SQLiteParameter("request_id", DbType.Int32);
SQLiteParameter p2 = new SQLiteParameter("sequence", DbType.Double);
SQLiteParameter p3 = new SQLiteParameter("date_assigned", DbType.String);

for (int i = 0; i < assigneeIDs.Count; i++)
{
    p1.Value = requestID;
    p2.Value = Convert.ToDouble(last_seq + "." + (i + 1));
    p3.Value = DateTime.Now.ToString(ThisAddIn.FullDate);

    param[0] = p1;
    param[1] = p2;
    param[2] = p3;

    paramList.Add(param);
}

int inserted = SQLite.ExecuteParams(sql, paramList); 
```

我确实在每个循环之后放置了一个标点以进行调试，并且我确认第一次迭代后的值符合预期。但是，在下一次迭代中，第一项（索引 0 处）以某种方式被第二次迭代的值覆盖。所以最后添加的项目总是会覆盖列表中的每一个前一个项目。

我做错了什么？

**编辑：**这是一个更简单（需要较少依赖）的示例代码，具有相同的行为：

```
List<string[]> paramList = new List<string[]>();

string[] param = new string[3];

string p1 = "";
string p2 = "";
string p3 = "";

for (int i = 0; i < 3; i++)
{
    p1 = i.ToString() + ".1";
    p2 = i.ToString() + ".2";
    p3 = i.ToString() + ".3";

    param[0] = p1;
    param[1] = p2;
    param[2] = p3;

    paramList.Add(param);
}

foreach (string[] s in paramList)
{
    this.textBox1.Text += String.Join(",", s) + "\r\n";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:48:33.380

您不是在每次迭代中创建一个新的参数数组，也不是在每次迭代中创建新参数，您只是一遍又一遍地改变相同的参数。您需要确保在循环的每次迭代中创建一个新数组，并且为循环的每次迭代创建新参数。在这种情况下，您根本不应该在循环之外定义这些变量；在循环内定义它们：

```
for (int i = 0; i < assigneeIDs.Count; i++)
{
    SQLiteParameter[] param = new SQLiteParameter[3];

    SQLiteParameter p1 = new SQLiteParameter("request_id", DbType.Int32);
    SQLiteParameter p2 = new SQLiteParameter("sequence", DbType.Double);
    SQLiteParameter p3 = new SQLiteParameter("date_assigned", DbType.String);

    p1.Value = requestID;
    p2.Value = Convert.ToDouble(last_seq + "." + (i + 1));
    p3.Value = DateTime.Now.ToString(ThisAddIn.FullDate);

    param[0] = p1;
    param[1] = p2;
    param[2] = p3;

    paramList.Add(param);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:51:05.360

我认为这是因为您正在处理“param”的同一个实例。尝试在循环中实例化它。

# angularjs - 使用卫星数据更新范围

> ID：16156364
> 
> 赞同：0
> 
> 时间：2013-04-22T20:44:32.717
> 
> 标签：angularjs, angularjs-directive

假设您的作用域中有一个对象数组，并且您想使用指令对其进行更新。我怎样才能做到这一点 ？我不确定应该怎么做。

要点是我想用名称和“卫星数据”更新范围，在这种情况下是 id，但我们可以想象我们有更多。

问题：如果我不费心在 UI 中显示它，为什么我仍然需要一个 id 值？想象一下，我们正在与数据库交谈，并且数据库正在返回一个基于输入值 + 相应 id 的值。例如，在提交表单时将使用此 ID。

还有一件事：我们不想直接访问指令中的 people 变量，因为这样指令就不是通用的。我在这里创建了一个 plunk：http: [//plnkr.co/edit/D2ybe8uPSdzeIxTFzad5](http://plnkr.co/edit/D2ybe8uPSdzeIxTFzad5)

HTML 文件：

```
<body ng-controller="MainCtrl">
<span ng-repeat="val in people">
     <input customattr type = "text" ng-model="val.name" />   
    <br /> <br/>  Children :
  <span ng-repeat="v in val.children">
 <input customattr type = "text" ng-model="v.name" />   
  </span>
</span>    
</body> 
```

JS文件：

```
var app = angular.module('plunker', []);

app.controller('MainCtrl', function($scope) {
  $scope.people = [{"name":"Toto", "id":1,
    "children": [
      {"name":"John","id":2},
      {"name":"Mary","id":3}      
      ]
    }];

});

app.directive('customattr', function () {
  return {
      restrict: 'A',
      link: function (scope, element, attrs) {
          element[0].onblur = function() {
           console.log("Hello there" + element[0].value);
           // make some magic processing of the input with a XHR request here...
           // for the demonstration the XHR request is replaced by findTheNewDict
           var newDict = findTheNewDict(element[0].value);
           console.log(newDict);
           // Now we want to update the scope with the data
           // How can we do that ?
           scope.$apply(function(s) {
            // We have no knowledge of the variable people here
            // We just know that the data is a dict containing a name and an id
           });
          }              
          findTheNewDict = function(input) {
            // Just a dummy return : it doesn't matter what is returned
            // The main point is that I want to update the right variable
            // in the scope with this data
            return {"name": input + "a", "id":input.length};
          }
      } 

  }; 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:52:48.933

控制器中的 $scope 是绑定到视图的内容。假设您的视图元素（div 等）绑定到 $scope 对象中的属性，只需像任何其他 JavaScript 对象一样更新属性，框架将处理其余部分。

您可能必须将更新逻辑包装在 $scope.$apply 函数周围，具体取决于您运行它的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T01:57:29.723

您似乎试图做的比您的指令中必要的要多。'newDict' 有什么用？为什么要更改 id 值？为什么到名字的长度？？！

我在您的 plunk 中添加了以下行，它允许您在键入时看到正在修改的“人员”对象：

```
<p>{{people}}</p> 
```

您的“customattr”指令什么也没做，所以我没有使用它。您可能想要在每个“家庭”中“添加孩子”和“添加父母”的按钮？它们可以在 html 中，直接调用控制器的函数；我也添加了这些。

见：[http ://plnkr.co/edit/ABaCc8lu5fBJJjpii5LP?p=preview](http://plnkr.co/edit/ABaCc8lu5fBJJjpii5LP?p=preview)

# jquery - 我正在尝试从查询字符串中提取一个变量，并使用该值在我的表单中填充一个隐藏变量。

> ID：16156365
> 
> 赞同：0
> 
> 时间：2013-04-22T20:44:33.560
> 
> 标签：jquery, variables, hidden, assign

我正在尝试从 url 中提取一个变量并使用 jquery 在我的表单中填充一个隐藏变量。

我已经坚持了几个小时了，我希望比我更擅长 jquery 的人可以帮助我。我找到了几种解决方案，但它们似乎都不适用于我的代码。我可以使用警报并确认我正在从字符串中提取 'ad' 值并分配给我的 'adtest' 变量，但我没有尝试更新代码中的 'meta_adtracking' 隐藏变量。非常感谢任何输入！

我的网址是： [http ://www.mysite.com?ad=cl55](http://www.mysite.com?ad=cl55)

我用来从查询字符串中提取变量的脚本：

```
<script type="text/javascript">
function getURLParameter(name) {
return decodeURI(
    (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
}

jQuery(document).ready(function(){
    var adtest = getURLParameter('ad');
    $('input[name=meta_adtracking]').val(adtest);
});
</script> 
```

我的表单代码是：

```
<form accept-charset="utf-8" action="https://app.getresponse.com/add_contact_webform.html" method="GET">
...
    <input type="hidden" id="adtrack1" name="meta_adtracking" value="" />
...
</form> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:34:03.157

试试这个 $('input[name=meta_adtracking]').attr('value', adtest)

# javascript - 创建头像生成器

> ID：16156366
> 
> 赞同：2
> 
> 时间：2013-04-22T20:44:38.910
> 
> 标签：javascript, jquery, django, html, css

我即将创建[类似的](http://platogo.com/avatars)东西。也就是说，一个卡通人物应该可以通过点击按钮来实时改变。

我的计划是将 javascript (jQuery) 与 HTML5 和 CSS3 一起使用，并将其与 Django 集成。我希望能提供一些关于如何处理此任务的建议，例如可以使用哪些功能/技术/API。如果您知道可能对这项任务有用的 Django 应用程序，我会非常高兴。

例如，SVG 适合这项任务还是我应该使用画布？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:59:05.090

Because you want it real-time I'd advise client-side processing. Given that 'flash is dead' (and not supported on apple iphoney stuff), I think canvas is a better solution (over SVG, that I find way to quircky).

One of the main advantages to canvas in this specific scenareo is that users can right-click the client-side (in canvas) generated image and save it just like any other image.

To get you started you might want to look at [tektek's dream avatar creator](http://www.tektek.org/dream/), this also uses canvas.

# java - Phonegap 与原生 Android 性能测试

> ID：16156370
> 
> 赞同：5
> 
> 时间：2013-04-22T20:44:45.150
> 
> 标签：java, javascript, android, cordova, native

我的最后一年的项目有一个严重的问题。我被告知要使用**PhoneGap**开发一个移动应用程序来支持多个平台。然后我被告知要比较**PhoneGap**与**Native**的性能，所以我决定在 android 上进行测试。

***我编写了一个示例函数，并测量了在JavaScript*** for **PhoneGap**和***Java*** for **Native Android**中实现它的时间。有趣的是，JavaScript 函数的完成时间缩短了**10**倍，而且我一直认为 Native 函数要快得多。

这是我在 JavaScript 中用于 PhoneGap 的代码：

```
 var array = new Array();
        var start = new Date().getTime();
            for (var i = 0; i < 1000000; i++) {
                var j = i + Math.random();
                if (j % 2 == 0)
                    j = 1;
                else
                    j = 0;
                array.push(j);
            }
            var end = new Date().getTime();

            var time = end-start;
            var div = document.getElementById('result');

            div.innerHTML = "Result time= " + time; 
```

我在 Java 中的 Native 代码：

```
 long startTime = System.currentTimeMillis();
            ArrayList<Integer> array = new ArrayList<Integer>();
            for (int i = 0; i < 1000000; i++) {
                Random r = new Random();
                int j = i + r.nextInt();
                if (j % 2 == 0)
                    j = 1;
                else
                    j = 0;
                array.add(j);
            }
            long endTime = System.currentTimeMillis();

            long time = endTime - startTime;
            t1.setTextColor(Color.BLACK);
            t1.setText("Result time= "
                    + Long.toString(time)); 
```

第一个的输出是：平均**350 毫秒**

第二个的输出是：平均**3600ms**

我正在测试

> 三星 Galaxy Note 10.1 平板电脑。

这是正确的吗？还是我错过了什么并犯了严重的错误？

非常感谢你的帮助。

- - - - - - - 更新 - - - - - - -

放好后

> 随机 r = 新随机（）

在循环之外，执行循环所需的新时间是**750ms**。但是使用Phonegap 速度仍然是两倍快，我可以得出结论，对于数值处理，**Phonegap**比Android 上的**Native更好吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T19:06:39.060

并非所有随机数生成器的性能都一样。为了公平比较，您最好进行确定性计算。

您的测试还应包括其他功能，例如测试 GUI 响应时间、网络、数据库访问等。最有趣的是 GUI 响应时间，因为这是大多数应用程序花费大部分时间的地方。所有其他比较就像在代码中寻找微优化一样。

请分享您的结果，因为这就是我访问这个问题的真正原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T17:15:00.447

来，试试这个

```
package com.zeroblitz.benchmark1;
import java.util.ArrayList;
import java.util.Random;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {
private TextView tvTest1;
private TextView tvTest2;
private Button btnStart;
private int v[]=new int[1000000];
private Random random=new Random(System.currentTimeMillis());
private int n_v=0;
private ArrayList<Integer> array=new ArrayList<Integer>();
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    initViews();
}
private void initViews(){
    tvTest1=(TextView)findViewById(R.id.tvTest1);
    tvTest2=(TextView)findViewById(R.id.tvTest2);
    btnStart=(Button)findViewById(R.id.btnStart);

    btnStart.setOnClickListener(startButtonListener);
}
OnClickListener startButtonListener=new OnClickListener() {
    public void onClick(View v) {
        new AsyncTest1(tvTest1).execute();
    }
};

public class AsyncTest1 extends AsyncTask<Void, Void, Void>{
    private TextView tv;
    long time=0;
    public AsyncTest1(TextView tv){
        this.tv=tv;
    }
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        tv.setText("Testing 1 ....");
    }
    protected Void doInBackground(Void... params) {
        n_v=0;
        long start=System.currentTimeMillis();
        for(int i=0;i<1000000;i++)
            v[n_v++]=1-(i+random.nextInt())%2;
        time=System.currentTimeMillis()-start;
        return null;
    }
    @Override
    protected void onPostExecute(Void result) {
        super.onPostExecute(result);
        tv.setText(String.format("Test 1 = %.3f", time/1000.f));
        new AsyncTest2(tvTest2).execute();
    }
}
public class AsyncTest2 extends AsyncTask<Void, Void, Void>{
    private TextView tv;
    long time=0;
    public AsyncTest2(TextView tv){
        this.tv=tv;
    }
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        tv.setText("Testing 2 ....");
    }
    protected Void doInBackground(Void... params) {
        //n_v=0;
        array.clear();
        array.trimToSize();
        long start=System.currentTimeMillis();
        for(int i=0;i<1000000;i++){
            //int j=i+random.nextInt();
            int j=i+new Random().nextInt();
            if(j%2==0)j=1;
            else j=0;
            array.add(j);
        }
            //array.add(1-(i+random.nextInt())%2);
        time=System.currentTimeMillis()-start;
        return null;
    }
    @Override
    protected void onPostExecute(Void result) {
        super.onPostExecute(result);
        tv.setText(String.format("Test 2 = %.3f", time/1000.f));
    }
}
} 
```

# wicket - 如何在 Wicket 中正确创建无状态表单和无状态结果页面

> ID：16156379
> 
> 赞同：3
> 
> 时间：2013-04-22T20:45:34.800
> 
> 标签：wicket, wicket-1.5

我有一个具有复杂表单的 Web 应用程序：

1.  执行字段验证，
2.  将值转换为易于为下一页解析的输入格式（数组）。
3.  将用户重定向到下一页（数据在 URL 中传递）
4.  然后下一页加载数据执行计算并显示结果。

这一切都是在 Wicket 中无状态地完成的。我在想我是怎么做到的。感觉不“对”。转换为数组并重定向“工作”，但必须有更好的方法。

**更新**
*为什么表单是无状态的：*
有问题的 Web 应用程序与其他 2 个 Web 应用程序共享服务器。`OutOfMemoryException`部署此应用程序的新版本后，我遇到了s。当我在将表单转换为无状态*之前*检查 Tomcat 管理器应用程序时，我通常会看到 ~150 或“活动会话”。现在表单/结果页面是无状态的，我看到了 5 个“活动会话”。这大大减少了我的内存使用量。（我认为）。不过，我仍然有一个挥之不去的疑问：[https ://stackoverflow.com/questions/16049219/how-to-handle-a-hibernate-bi-directional-mapping-for-a-set-properly](https://stackoverflow.com/questions/16049219/how-to-handle-a-hibernate-bi-directional-mapping-for-a-set-properly)

*建议：*
我开始怀疑是否应该删除“结果”页面安装点并将其转换为面板。这样我就可以直接将我的复杂对象传递给它，并在整个页面刷新中交换面板。这在无状态页面中是否可能？

*POST*
另外我不相信 wicket 本身支持 POST 重定向： [如何在 wicket 中使用 post 方法](https://stackoverflow.com/questions/11954498/how-to-use-post-method-in-wicket)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-28T13:26:19.610

你仔细看了`OutOfMemoryError`吗？通常，在重新部署应用程序时，您会耗尽 permgen 空间，而不是用户内存。Permgen 空间泄漏非常常见且难以消除。可能这与 Wicket 无关，而更多的是与保持加载的类有关。您应该尝试使用 Java 8（没有永久生成）或更新版本的 Tomcat（和 Wicket），因为类加载器泄漏通常在更新版本的框架和容器中得到解决。

另请参阅本文：[避免 Apache Tomcat 内存不足错误](http://www.mulesoft.com/tcat/tomcat-oome-out-of-memory-error)

# facebook - Facebook 将应用程序更改为沙盒模式

> ID：16156389
> 
> 赞同：0
> 
> 时间：2013-04-22T20:46:11.147
> 
> 标签：facebook, facebook-graph-api, web

Facebook 已将我的应用程序更改为沙盒模式，除开发人员外，没有人可以使用该应用程序。我该如何解决？当它变成沙盒模式时，我满足了为应用程序创建描述、图标和图像等要求，但它的状态有待审查。应用程序是用于生产模式的网站！！！我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T09:54:49.747

您可以随时在应用设置中[禁用](https://developers.facebook.com/apps)沙盒模式。

# javascript - 警报功能 - Javascript 作为等待功能

> ID：16156392
> 
> 赞同：0
> 
> 时间：2013-04-22T20:46:14.337
> 
> 标签：javascript, asp.net-mvc, alert, setinterval

我的应用程序是 aps.net MVC，我是否使用 ajax 加载多个图像，通过获取鼠标 Y 位置，它可以工作，但是如果我将鼠标移动超过一个像素，例如 100，它会一次加载所有图像！为了测试脚本，我添加了警报，当用户单击确定时，图像按预期前进。我尝试了 setInterval 和 Timeout，都没有奏效。这是我的代码：

```
 $("#container2").bind('mousemove', function (e) {

        lastX = e.pageX - position.x;
        lastY = e.pageY - position.y;
        coordinate = "x=" + lastX + ", y=" + lastY;
        $('#pValue').val(coordinate);
        $('#lastX').val(lastX);
        $('#lastY').val(lastY);

        waitStep = lastY >= 0 ? 1 : -1;
        waitInc = waitStep;
        waitCounter = lastY;

        for (var n = 0; n < Math.abs(lastY); n += 1) {
            //    imageSequence[n] = new Image();
            dicom1.src = '/Home/GenerateImage?' + $.param({
                pX: pointXF,
                pY: pointYF,
                pZ: waitInc * sThickness
            });
            waitInc = waitInc + waitStep;
            alert(waitInc);

        } 
```

非常感谢您的建议，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:00:06.103

尝试 ：

```
var speed = 15;
var timeout = 0;
$("#container2").bind('mousemove', function (e) {
    if (!timeout) {
        timeout = setTimeout(function(){
            timeout = 0;
            lastX = e.pageX - position.x;
            lastY = e.pageY - position.y;
            coordinate = "x=" + lastX + ", y=" + lastY;
            $('#pValue').val(coordinate);
            $('#lastX').val(lastX);
            $('#lastY').val(lastY);

            waitStep = lastY >= 0 ? 1 : -1;
            waitInc = waitStep;
            waitCounter = lastY;

            for (var n = 0; n < Math.abs(lastY); n += 1) {
                //    imageSequence[n] = new Image();
                    dicom1.src = '/Home/GenerateImage?' + $.param({
                    pX: pointXF,
                    pY: pointYF,
                    pZ: waitInc * sThickness
                });
                waitInc = waitInc + waitStep;
                alert(waitInc);
           }
        }, speed);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T12:27:47.637

要在 15 上执行一次代码，您可以尝试：

```
var speed = 0;
$("#container2").bind('mousemove', function (e) {
    ++speed;
    if (speed % 15 == 0) {
            lastX = e.pageX - position.x;
            lastY = e.pageY - position.y;
            coordinate = "x=" + lastX + ", y=" + lastY;
            $('#pValue').val(coordinate);
            $('#lastX').val(lastX);
            $('#lastY').val(lastY);

            waitStep = lastY >= 0 ? 1 : -1;
            waitInc = waitStep;
            waitCounter = lastY;

            for (var n = 0; n < Math.abs(lastY); n += 1) {
                //    imageSequence[n] = new Image();
                    dicom1.src = '/Home/GenerateImage?' + $.param({
                    pX: pointXF,
                    pY: pointYF,
                    pZ: waitInc * sThickness
                });
                waitInc = waitInc + waitStep;
                alert(waitInc);
           }
    }
}); 
```

# greasemonkey - Greasemonkey 没有在 Facebook 上看到对 DOM 所做的更改

> ID：16156393
> 
> 赞同：-1
> 
> 时间：2013-04-22T20:46:18.187
> 
> 标签：greasemonkey

我正在使用我的 GM 脚本链接多个页面。如果我创建一个只包含以下代码的脚本：（我正在使用 jQuery btw）

```
$(".rfloat.uiButton").trigger('click'); 
```

它会喜欢列表中的页数。但是底部有一个按钮，上面写着“查看更多结果”。这些是由 Ajax 加载的。因此，我更新了我的脚本以监听附加到 DOM 的元素，如下所示：

```
$("#pagelet_search_results_objects").bind("DOMSubtreeModified",HandleDOM_ChangeWithDelay);

var zGbl_DOM_ChangeTimer = null;

function HandleDOM_ChangeWithDelay (zEvent) {
    if (typeof zGbl_DOM_ChangeTimer == "number") {
        clearTimeout (zGbl_DOM_ChangeTimer);
        zGbl_DOM_ChangeTimer = '';
    }
    zGbl_DOM_ChangeTimer = setTimeout (HandleDOM_Change, 333);
}

function HandleDOM_Change () {
    alert("New content loaded"); // This fires once
    $("a.rfloat.uiButton").trigger('click');
} 
```

单击“查看更多结果”并将新页面结果添加到 DOM 后会触发警报。但是点击触发器不会触发。就好像 GM 没有看到已应用于 DOM 的更改。

为什么是这样？

**编辑：**

做的时候

```
alert($("a.rfloat.uiButton").length); 
```

它正在显示更新的数字，但仍未单击它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T02:22:25.243

错误控制台 ( `Ctrl``Shift``J`) 说什么？

到目前为止，我没有看到任何匹配的 Facebook 页面`$("a.rfloat.uiButton")`。链接到一个。

FB 很可能对添加的链接使用不同的事件处理，而[jQuery`.trigger()`仅对一小部分事件进行操作。](https://stackoverflow.com/a/10423628/331508)

尝试：

```
jQuery ('a.rfloat.uiButton').each ( function () {
    var clickEvent  = document.createEvent ('MouseEvents');
    clickEvent.initEvent ('click', true, true);
    this.dispatchEvent (clickEvent);
} 
```

* * *

也有可能新链接甚至不会触发点击。请参阅[“在 AJAX 驱动的站点上选择和激活正确的控件”](https://stackoverflow.com/a/15052467/331508)。

* * *

运行`$("a.rfloat.uiButton").trigger('click');`不止一次会重新点击之前的链接。这*可能会*导致问题。

# html - 无序列表子菜单水平

> ID：16156396
> 
> 赞同：2
> 
> 时间：2013-04-22T20:46:26.073
> 
> 标签：html, css

我正在尝试使无序列表的子菜单水平。我尝试了很多东西，包括：

浮动：左显示：内联

这些似乎已在其他地方被推荐给面临类似问题的人。但是，当“子菜单按钮”悬停在上方时，我无法让我的子菜单保持水平。

如您所知，这是形成网站的主导航菜单。

我的 HTML 代码在这里：

```
 <ul id="menu" >
    <li><a href="#">Home</a></li>
    <li class="sub">
    <a href="#">Sub Menu Button</a>
    <ul>
    <li><a href="#">Button 1</a></li>
    <li><a href="#">Button 2</a></li>
    <li><a href="#">Button 3</a></li>
    <li><a href="#">Button 4</a></li>
    </ul>
    </li>
    <li><a href="#">Button 5</a></li>
    <li><a href="#">Button 6</a></li>
    <li><a href="#">Button 7</a></li>
    </ul> 
```

我的 CSS 代码在这里：

```
 #menu {
    margin: 0;
    padding: 0.15%;
    background: #201f5f;
    height: 3em;
    list-style: none;
    font-family:arial;
    }

    #menu > li {
    height: 100%;
    margin-right: 0.5em;
    padding: 0 1em;
    background:#201f5f;
    }

    #menu > li > a {
    height: 3em;
    color: #ffffff;
    text-decoration: none;
    line-height: 3;
    font-weight: bold;
    text-transform: uppercase;
    }

    #menu > li > a:hover {
    color: #41A044;
    text-decoration: underline;
    }

    #menu > li.sub {
    position: relative;
    }

    #menu > li.sub ul {
    margin: 0;
    padding: 0.5em 0;
    list-style: none;
    background: #000000;
    position: absolute;
    top: -1000em;
    }

    #menu > li.sub ul li {
    width: 90%;
    margin: 0 auto 0.3em auto;
    }

    #menu > li.sub ul li a {
    height: 100%;
    display: inline;
    float: left;
    padding: 0.4em;
    color: #fff;
    font-weight: bold;
    text-decoration: none;
    }

    #menu > li.sub ul li a:hover {
    background: #41A044;
    text-decoration: underline;
    }

    #menu > li.sub:hover ul {
    top: 3em;
    }

    #menu{
    text-align:center;
    }

    li{
    display:inline-block;
    } 
```

我对 HTML 和 CSS 都非常陌生，所以如果代码一团糟，我深表歉意，但是，正如我所说的那样，它确实有效，我希望子菜单变为水平而不是垂直。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:15:30.290

将您的 CSS 更新为具有固定宽度的这样，以便更好地控制您的布局：

在这里执行：http: [//jsfiddle.net/ShaADm/6/](http://jsfiddle.net/ShADm/6/)

```
#menu {
    margin: 0;
    padding: 0.15%;
    background: #201f5f;
    height: 3em;
    list-style: none;
    font-family:arial;
    width: 800px;
    }

    #menu > li {
    height: 100%;
    margin-right: 0.5em;
    padding: 0 1em;
    background:#201f5f;
    }

    #menu > li > a {
    height: 3em;
    color: #ffffff;
    text-decoration: none;
    line-height: 3;
    font-weight: bold;
    text-transform: uppercase;
    }

    #menu > li > a:hover {
    color: #41A044;
    text-decoration: underline;
    }

    #menu > li.sub {
    position: relative;
    }

    #menu > li.sub ul {
    margin: 0;
    padding: 0.5em 0;
    list-style: none;
    background: #000000;
    position: absolute;
    top: -1000em;
    left: -160px;
    width: 803px;
    }

    #menu li.sub ul li a {
    height: 100%;
    display: inline;
    float: left;
    padding: 0.4em;
    color: #fff;
    font-weight: bold;
    text-decoration: none;
    }

    #menu > li.sub ul li a:hover {
    background: #41A044;
    text-decoration: underline;
    }

    #menu > li.sub:hover ul {
    top: 3em;
    }

    #menu{
    text-align:center;
    }

    li{
    display:inline-block;
    } 
```

这是影响：http: [//jsfiddle.net/ShaADm/6/](http://jsfiddle.net/ShADm/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:32:33.520

```
#menu li>ul{

position:absolute;
visibility:hidden;
}

#menu li:hover>ul{

position:relative;
visibility:visible;
} 
```

你需要去`<ul>`嵌套在里面`<li>`，使那个内部列表去到一边。您更倾向于影响`<ul>`而不是列表项的结果。

我最近制作了一个菜单，它可能包含无限嵌套的类别列表，我构建的菜单基本上是这样的：

```
<ul class="menu">
<ul id="menu">
    <li class="menu_side"><a href="" name="categories">Categories</a>
        <ul>
            <li class="menu_down"><a href="" name="new">New</a>
                <ul>
                    <li><a href="" name="abc">Abc</a></li>
                </ul>
            </li>
        </ul>
    </li>
 </ul>
</ul> 
```

我设置它的方式是，如果任何父类中的类别是一个类别数组，它会移到一边，否则它会下移。这是内置在我用来在菜单上生成列表的代码中的。就像我说的，它有可能在类别列表中拥有无限嵌套的列表，就像目录树一样。我在这个系统上扔了超过 5k 个预制类别，在我把它弄下来之后它就没有问题了。

```
ul#menu li ul{

    visibility:hidden;
    position:absolute;
    opacity:0;
    box-shadow:0px 0px 2px #000;
    background-color:#004080;
    padding:0;
    }

ul#menu .menu_side ul{

    visibility:hidden;
    opacity:0;
    position:absolute;
    left:0%;
    top:-25px;
    }
ul#menu .menu_side:hover>ul{

    visibility:visible;
    opacity:1;
    position:relative;
    left:100%;
    top:-25px;
    z-index:1;
    }

ul#menu .menu_down ul{

    visibility:hidden;
    opacity:0;
    position:absolute;
    top:0%;

    }

ul#menu .menu_down:hover>ul{

    visibility:visible;
    opacity:1;
    position:relative;
    z-index:1;
    background-color:#6666ff;
    }
ul#menu .menu_side:hover{
    height:25px;
} 
```

这可能不是最有效的方法，但它可以为我完成工作。

# asp.net - 使用 Active Directory 凭据连接到 SQL Server

> ID：16156398
> 
> 赞同：0
> 
> 时间：2013-04-22T20:46:33.577
> 
> 标签：asp.net, sql, active-directory

我认为这很简单，但我似乎无法弄清楚。我想要 ac# 表单询问用户名和密码。然后我想通过询问 SQL 用户帐户是否可以登录到 SQL 数据库来验证用户。我尝试了一种基本方法，只需将用户名和密码放在连接字符串中，但这不起作用，我收到一条错误消息“用户某某无权访问”我是假设是因为密码没有正确传递。这就是我所拥有的：

网络配置：

```
<connectionStrings>
  <add name="connectionname" 
     connectionString="Data Source=myserver;Initial Catalog=mydb;Integrated Security=SSPI;" 
     providerName="System.Data.SqlClient"/>
</connectionStrings>
<system.web>
   <identity impersonate="true" />
   .... 
```

我的代码背后：

```
 try
 {
    SqlConnection con = new SqlConnection();
    con.ConnectionString = "Data Source=myserver;Initial Catalog=mydb;User ID=" + useridTextBox.Text + ";Password=" + passwordTextBox.Text;
    con.Open();
    con.Close();
    //successful login
    validDBLogin = true;
    pageMsg.Text = "Successful AD and DB login";
  }
  catch (Exception err) //if error Opening, catch the error, and display
  {
    pageMsg.Text = "No access to the Database";
    pageMsgAdditional.Text = err.Message.ToString();
    validDBLogin = false;
   } 
```

必须有办法做到这一点？我的目标是使用 SQL 完成身份验证。如果用户想要访问，我让他们访问数据库，这就是我所要做的。我还希望以这种方式集成安全性，以便我可以跟踪哪个用户运行了哪个 sql 查询。（不确定这是否有区别，但我们正在为这些帐户使用 Active Directory，到目前为止没有任何问题）。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:24:49.327

您误解了 SQL Server 中的 SSPI 集成。

**连接字符串 1 (SSPI)：**

```
Data Source=myserver;Initial Catalog=mydb;Integrated Security=SSPI; 
```

这告诉 SQL Server 检查拥有尝试连接的进程的用户的凭据。在这种情况下，ASP.Net 应用程序池标识是“Active Directory 用户”的上下文。

**连接字符串 2（用户/密码）：**

```
Data Source=myserver;Initial Catalog=mydb;User ID=xxxx;Password=yyyy; 
```

这告诉 SQL Server 将用户 ID“xxxx”作为 SQL Server 登录进行身份验证。

这不会**为**SQL Server 提供域用户“xxxx”进行身份验证。即使您使用“域\xxxx”格式也不行。你就是不能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T23:04:37.043

无法为活动目录 ID 传递用户名密码。它始终使用运行网站的应用程序池的 ID。

# canvas - canvas.toDataURL() 用于大画布

> ID：16156402
> 
> 赞同：10
> 
> 时间：2013-04-22T20:46:53.297
> 
> 标签：canvas, html5-canvas, fabricjs

我`.toDataURL()`对大画布有疑问。我想`base64`对 php 文件进行编码和解码，但如果我有一个大画布，则`strDataURI`变量为空。

我的代码：

```
var strDataURI = canvas.toDataURL();
strDataURI = strDataURI.substr(22, strDataURI.length);
$.post("save.php",
{ 
   str: strDataURI
}; 
```

是否有任何替代`.toDataURL()`或某种方式来更改大小限制？

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-23T15:48:54.673

我不确定画布尺寸是否有限制，但数据 URL 有限制，具体取决于浏览器：[数据 URL 大小限制](https://stackoverflow.com/questions/695151/data-protocol-url-size-limitations)。

您可以尝试使用 Node.js + node-canvas（服务器端）重新创建画布。我一直在使用这些从画布元素创建可打印图像，并且到目前为止使用 toDataURL 没有任何问题/限制。

你在使用 fabric.js 库吗？我注意到你也在他们的论坛上发帖。Fabric.js 可以在 Node.js 中使用，并且有一个[toDataURLWithMultiplier](https://github.com/kangax/fabric.js/blob/master/src/static_canvas.class.js#L718-763)方法，它可以缩放画布/上下文，允许您更改 dataurl 图像大小。您可以检查方法源以了解这是如何完成的。

### 编辑：

由于您使用的是 fabric.js，我建议使用 Node.js 来处理画布以在服务器上进行图像处理。[您将在此处](http://fabricjs.com/fabric-intro-part-4/#node)找到有关如何在 Node.js 上使用 fabric.js 的更多信息。

这是一个使用 Node.js 和 express 的简单服务器：

```
var express = require('express'),
    fs = require('fs'),
    fabric = require('fabric').fabric,
    app = express(),
    port = 3000;

var allowCrossDomain = function (req, res, next) {
    res.header('Access-Control-Allow-Origin', '*');
    res.header('Access-Control-Allow-Methods', 'POST, OPTIONS');
    res.header('Access-Control-Allow-Headers', 'Content-Type');
    next();
}

app.configure(function() {
    app.use(express.bodyParser());
    app.use(allowCrossDomain);
});

app.options('/', function(req, res) {
    res.send(200);
});

app.post('/', function(req, res) {
    var canvas = fabric.createCanvasForNode(req.body.width, req.body.height);

    console.log('> Loading JSON ...');
    canvas.loadFromJSON(req.body.json, function() {
        canvas.renderAll();

        console.log('> Getting PNG data ... (this can take a while)');
        var dataUrl = canvas.toDataURLWithMultiplier('png', req.body.multiplier),
            data = dataUrl.replace(/^data:image\/png;base64,/, '');

        console.log('> Saving PNG to file ...');
        var filePath = __dirname + '/test.png';
        fs.writeFile(filePath, data, 'base64', function(err) {
            if (err) {
                console.log('! Error saving PNG: ' + err);
                res.json(200, { error: 'Error saving PNG: ' + err });
            } else {
                console.log('> PNG file saved to: ' + filePath);
                res.json(200, { success: 'PNG file saved to: ' + filePath });
            }
        });
    });
});

app.listen(port);
console.log('> Server listening on port ' + port); 
```

当服务器运行时，您可以向它发送数据 ( `postData`)。服务器期望`json`,`width`并`height`重新创建画布，并 a`multiplier`来缩放数据 url 图像。客户端代码如下所示：

```
var postData = {
    json: canvas.toJSON(),
    width: canvas.getWidth(),
    height: canvas.getHeight(),
    multiplier: 2
};

$.ajax({
    url: 'http://localhost:3000',
    type: 'POST',
    contentType: 'application/json; charset=utf-8',
    data: JSON.stringify(postData),
    dataType: 'json',
    success: function(data) {
        console.log(data);
    },
    error: function(err) {
        console.log(err);
    }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T00:43:19.297

您应该首先考虑这一点：上传的大小是有限的。该限制取决于浏览器、操作系统和服务器环境。你可以看看这篇文章：[http ://www.motobit.com/help/scptutl/pa98.htm](http://www.motobit.com/help/scptutl/pa98.htm)

一般来说，你可以尝试这样的事情：首先我们需要一个函数来将 dataURI 转换为 blob：

```
function convertDataURItoBlob(dataURI) {
        'use strict'

        var byteString,
            mimestring

        if(dataURI.split(',')[0].indexOf('base64') !== -1 ) {
            byteString = atob(dataURI.split(',')[1])
        } else {
            byteString = decodeURI(dataURI.split(',')[1])
        }

        mimestring = dataURI.split(',')[0].split(':')[1].split(';')[0]

        var content = new Array();
        for (var i = 0; i < byteString.length; i++) {
            content[i] = byteString.charCodeAt(i)
        }
        var rawContent = new Uint8Array(content),
            returnBlob = new Blob([rawContent], {type: mimestring})

        return returnBlob;

} 
```

接下来是上传文件的函数，使用 XMLHttpRequest2：

```
function upload(blob) {
  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/yourServerEndPoint', true);
  xhr.onload = function(e) { ... };

  xhr.send(blob);
} 
```

现在您可以将您`strDataURI`的文件传递给第一个函数，然后使用第二个函数上传文件。

您可以在此处更深入地了解 XMLHTTPRequest2：http://www.html5rocks.com/en/tutorials/file/xhr2/[以及](http://www.html5rocks.com/en/tutorials/file/xhr2/)此处 的 blob 构造函数：[https ://developer.mozilla.org/en-US/docs /DOM/Blob](https://developer.mozilla.org/en-US/docs/DOM/Blob)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T04:04:57.343

您总是可以将图像分成更小的部分并单独保存，这可能不是一个坏主意。基本上你会有一个类似的功能

```
var largeCanvas = document.getElementById('yourGiantCanvas').getContext('2d'),
    slice = document.createElement('canvas').getContext('2d');

slice.canvas.width = 1000;
slice.canvas.height = 1000;

for (var y=0; y < canvas.height; y+=1000){
  for (var x=0; x < canvas.width; x+=1000){
    slice.clearRect(0, 0, slice.canvas.width, slice.canvas.height);
    slice.drawImage(largeCanvas.canvas, x, y, 1000, 1000, 0, 0, 1000, 1000);

    var imagePiece = slice.canvas.toDataURL();

    //Now just save the imagePiece however you normally were planning to
    //and you can build the image again using these slices. You can create 
    //a much better user experience this way too. 
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-20T16:55:43.533

已更新代码以将画布拆分为更小的画布对象。效果很好，还添加了一个跟踪器：

这允许跟踪上传过程，我认为总体上对用户来说更好。我在稍后阶段使用 PHP 重新加入。

它避免了画布/浏览器等的大小问题。

我的第一篇文章希望对你有帮助！

// 传入文件名的类型

```
function sliceCanvas(type, canvasId){
var largeCanvas = document.getElementById(canvasId).getContext('2d');
var slice = document.createElement('canvas').getContext('2d');

var baseSize = 500;

fileH = largeCanvas.canvas.height / baseSize;
fileW = largeCanvas.canvas.width / baseSize;

slice.canvas.width = baseSize;
slice.canvas.height = baseSize; 
count = 1;

numFiles = Math.ceil(fileH) * Math.ceil(fileW);

for (var y=0; y < largeCanvas.canvas.height; y+=baseSize){
  for (var x=0; x < largeCanvas.canvas.width; x+=baseSize){
    slice.clearRect(0, 0, slice.canvas.width, slice.canvas.height);
    slice.drawImage(largeCanvas.canvas, x, y, baseSize, baseSize, 0, 0, baseSize, baseSize);

    var imagePiece = slice.canvas.toDataURL();

    typeFinal = type + count;

    exportSlice(typeFinal, imagePiece, numFiles);
    count++;

  } 
}
} 
```

Ajax 上传：

```
function exportSlice(type, dataURL, fileNum){

percent = 0;
percentComplete = 0;

    $.ajax({
         type: "POST",
          url: YourServerSideFiletoSave,
          data: {image: dataURL, type: type}
        })
        .done(function( response ) {
            console.log(response);
            percent++;
            percentComplete = Math.ceil(Number(percent/fileNum*100));
           return true;
         })
          .fail(function(response) {
            console.log("Image FAILED");

            console.log(response);

            return false;

        })
        .always(function(response) {
          console.log( "Always");
        });

  } 
```

# assembly - 编写自己的 SVC 调用 ARM 程序集

> ID：16156404
> 
> 赞同：5
> 
> 时间：2013-04-22T20:47:02.047
> 
> 标签：assembly, arm, hardware, microcontroller

我想知道在基于 ARM 的微控制器上编写 SVC 调用的正确方法。

到目前为止，我的理解是 ARM 有一个异常向量表，这意味着任何程序中的第一条指令都必须分支到适当的处理程序：

```
RESET          ;Handles reset
UNDEFINED      ;Undefined instructions
SVC             BL            SVC_Entry 
PRE_ABORT      ;Prefetch abort
DAT_ABORT      ;Data abort 
```

然后，每次运行 SVC 指令时，模式切换到监督模式，SVC 提供的编号存储在 R0 中，程序将跳转到适当的处理程序：

```
;== Handling SVC calls ========================================================

Max_SVC     EQU 1

SVC_Entry   CMP R0, #Max_SVC            ;Check upper limit
            BHI SVC_end                 ;Does nothing if unknown    
            ADD R0, PC, R0, LSL #2      ;Calculate table address
            LDR PC, [R0, #0]        

Jump_table  DEFW    SVC_0                   ;Halt
            DEFW    SVC_1                   ;Print string

;== SVC calls ================================================================

SVC_1       B   SVC_end

SVC_end     MOVS    PC, LR          ;Exiting 
```

所以，如果我们有这些说明：

```
ADR R1, string       ;R1 points to the string
SVC 1                ;SVC_1 handles the printing 
```

程序必须切换到主管模式，将数字“1”存储在 R0 中，然后按照跳转表分支到 SVC_1，运行代码并切换回用户模式。

这个对吗？我做对了吗？

到目前为止，我遇到的问题是我的编译器对这一行说“操作员预期”：

```
SVC             BL            SVC_Entry 
```

在 Internet 上很难找到有关此主题的信息，我只想知道如何在 ARM 微控制器上正确使用 SVC 调用。

非常感谢。

**编辑：**底层处理器是时钟频率约为 240 MHz 的 ARM9。这存在于 AT91 微控制器中。它所在的实验室板已经过修改，以适应我大学的需要。

代码通过串行端口使用定制程序加载到板上。该程序还允许调试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-04-30T21:30:31.430

如前所述，不要使用BL跳转到SVC入口，使用B。先有一个例程来确定SVC号。（我的称为 SVC_dispatcher）。你在哪所大学？我将尝试彻底解释这一点，不对您知道或不知道多少做任何假设。我已经输入了正确的术语，因此如果我的评论不清楚或您想要更深入，您可以在谷歌上搜索更多信息。我不确定用冒号标记的方法，我习惯了旧的指令集。

祝你好运

```
SVC_dispatcher
            PUSH    {LR}              ;  always save your LR
            LDR     R14, [LR, #-4]    ; its been stacked, so we can it (LR is R14)
   ; the link register is the line after the SVC instruction
   ; above, we load the instruction that is one before the 
   ; link register (#-4 preindexed load) means instruction (SVC 1) into R14\.                      

   ; Use bit clear to remove the mnemonic from the  32 bit instruction, 
  ; leaving the data (1)     
             BIC     R14, R14, #&FF000000  

SVC_entry
            CMP     R14, #Max_SVC
            BHI     SVC_unknown
            ADR     R1, Jump_Table        ; use this format, never add to the PC
            LDR     PC, [R1, R14, LSL #2] 
       ; Beware: PC can be changed by IRQs **AT ANY TIME**

Jump_Table                                 ; you know the drill here
            DEFW    SVC_0            
            DEFW    SVC_1

SVC_0       B       SVC_end

SVC_1       BL      printString     ; consider stacking registers that printString 
            B       SVC_end         ; will corrupt

SVC_end     POP     {LR}            ; restore link register 
            MOV     PC, LR 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-13T17:51:34.443

只是补充上面 Yoker 的回答以进行澄清：

正如 Yoker 的答案示例所示，传统上 SVC 指令中的数字不存储在 R0 中（如您在问题中所述），您应该从代码中检索它，直接从 svc 指令中读取立即值。

为此，您需要在返回地址之前获取指向指令的指针，例如，如果您有以下指令：

```
0x800010: ADR R1, string       ;R1 points to the string
0x800014: SVC 1                ;SVC_1 handles the printing
0x800018: ADD R1, R2           ;The next instruction after the SVC where LR will point to 
```

返回地址将是LR=0x800018，然后我们可以检索SVC指令LR-4=0x800014的地址，读取该地址内容（即SVC 1指令）并仅获取它的第一个字节（我们忽略svc操作码，只得到立即值）。

因此，在 Yoker 的示例中，我们可以看到以下说明正是这样做的：

```
LDR     R14, [LR, #-4]
BIC     R14, R14, #&FF000000 
```

这是在皮质 M0 中使用 C 代码的另一个示例（拇指指令）：

```
void SVC_Handler(void)
{
    // Get stack pointer, assuming we the thread that generated
    // the svc call was using the psp stack instead of msp
    unsigned int *stack;
    asm volatile ("MRS %0, psp\n\t"  : "=rm" (stack) );

    // Stack frame contains:
    // r0, r1, r2, r3, r12, r14, the return address and xPSR
    // - Stacked R0 = stack[0]
    // - Stacked R1 = stack[1]
    // - Stacked R2 = stack[2]
    // - Stacked R3 = stack[3]
    // - Stacked R12 = stack[4]
    // - Stacked LR = stack[5]
    // - Stacked PC = stack[6]
    // - Stacked xPSR= stack[7]

    // Thumb instructions have 2 bytes instead of 4, then get
    // the first byte of the instruction right before the
    // instruction pointed by the stacked PC
    unsigned int svc_number = ((char *)svc_args[6])[-2];
    switch(svc_number) {
        case 0:
            ...
            break;
        case 1:
            ...
            break;
    } 
```

# php - 如何用php修复修改后的地址栏

> ID：16156410
> 
> 赞同：1
> 
> 时间：2013-04-22T20:47:30.620
> 
> 标签：php, url, address-bar, tampering

PHP新手，我正在尝试使我的网站防篡改。如果有人在浏览器地址栏中修改了 url，我想重新加载页面 url。我想到的一种方法是将页面 url 存储在会话变量中，以便在需要时重复使用。
下一页 url 来自基于用户选择的 SQL 查询（可能有几十个），所以我事先不知道该 url 是什么。我想做的是恢复当用户单击链接时传输到服务器的地址（当您将鼠标悬停在链接上时，Firefox 在左下角显示的地址）并将其存储在会话变量中. 这可能吗？如果可以，我怎样才能用 PHP 恢复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:54:31.640

您真的不需要多个 URL。您可以在整个页面序列中使用相同的 URL，因为服务器知道下一步该做什么。

了解“有限状态机”以及它们如何帮助您创建一个工作流，该工作流仅允许基于您提供给用户的选择的一组非常有限的操作。您很可能需要为此进行一次会话。

正确完成后，用户无法篡改 URL，因为所有其他 URL 将导致 404 或其他内容，并且尝试摆弄接受用户选择的一个 URL 只有在所需的步骤在允许的步骤列表中时才有效 -否则没有任何改变。

为了显示：

第一个状态是“开始”，允许的转换是“答案 1”和“答案 2”。这些正在过渡到两个结束状态，没有进一步的过渡。因此，每当用户进入“已回答 1”状态时，他就无法进入其他状态，除了创建一个新会话，如果机器状态与会话无关，也可以禁止该会话，而是用户帐户。

# wpf - 将实体绑定到 WPF 表单 MVVM

> ID：16156411
> 
> 赞同：1
> 
> 时间：2013-04-22T20:47:43.360
> 
> 标签：wpf, vb.net, entity-framework, mvvm

我的问题可能需要几个答案或一个很好的例子我可能会做错事，我感谢任何帮助。

本质上，我正在尝试将 WPF 表单绑定到我的实体框架工作模型，同时我正在尝试为我的 WPF 表单学习 MVVM，因此应该有很多示例已经使用了很多来获得我的位置，但我不能找一个把它钉在一起，无济于事，我对 c# 的熟练程度不足以阅读它，我必须一直把它放在翻译器上。

-

我想我需要创建一个继承自我的实体之一的新类，以托管我的视图模型所需的额外属性

```
Public Property IsSelected As Boolean
Public Property IsReadOnly As Boolean 
```

和所有其他人......

但是，我还希望实体框架工作上下文来跟踪我的实体，因此这些实体上的导航属性仍然​​有效，我可以调用 SaveChanges ...如果我有新类，这似乎不起作用。
**这就是它的症结所在，我无法弄清楚我是如何让 EF 和 MVVM 很好地结合在一起的。**

我唯一能想到的就是用我的实体之一作为私有创建一个类，然后手动重新创建所有属性，但这肯定是继承的重点。

```
Class Observation_View
Private Co_Observations_TBL as Observations_TBL

Public New (ByVal Observation as Observations_TBL)
Co_Observations_TBL = Observation 
End Sub

Public Property Observed_Value as Single
 Get
  Return Co_Observations_TBL.Observed_Value  
 End Get
 Set
  Co_Observations_TBL.Observed_Value =  value
  RaiseEvent PropertyChanged(Me, New System.ComponentModel.PropertyChangedEventArgs("Observed_Value"))
 End Set
End Property 
```

（我可能需要在构造函数中使用上下文注册实体。）

只是感觉这不是我应该做的方式，我必须重新实现 PropertyChanged 和各种只是一团糟。

谢谢蒂姆

旁注我是初学者，我似乎无法找到一种优雅的方式来使用父对象或使用子对象的父对象来构造子类，我似乎必须通过所有对象属性，这真的对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:59:23.227

MVVM 中缺少的一件事是 ViewModel。

基本上，您需要创建一个 ViewModel，然后公开属性。这些属性是来自您的模型的对象。然后将 xaml 页面的 DataContext 设置为该 ViewModel 的实例。您可以在构造它时从构造函数或其他任何地方加载要显示的对象。

例如，您可以有一个 ObservationViewModel，它公开一个观察列表和一个 SelectedObservation：

```
Public Class ObservationViewModel

    Public Property Observations As IEnumerable(Of Observation)
    ' implement the property and raise PropertyChangedEvent here in the setter (omitted for brevity)

    Public Property SelectedObservation as Observation
    ' implement the property and raise PropertyChangedEvent here in the setter (omitted for brevity)    
End Class 
```

然后在您的视图中将观察和选定的观察绑定到您的 ViewModel：

```
<ListBox ItemsSource="{Binding Observations}" SelectedItem="{Binding SelectedObservation, Mode=TwoWay}" /> 
```

要将更改保存到数据库，请使用命令。您在 ViewModel（如上所示的类）中声明一个命令，如下所示：

```
 ' Note: to use RelayCommand you should add an MVVM-framework such as MVVM Light
 Public Property SaveCommand as New RelayCommand(
     Sub()
         ' Save the list of objects that have changed here
     End Sub()
 ) 
```

之后，您可以像这样在 XAML 中绑定保存按钮：

```
<Button Command="{Binding SaveCommand}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-29T17:19:51.177

我发现将您的 EF 集合放入 ObservableCollection 是最简单的方法，并为您的 WPF 绑定实现 INotifyPropertyChanged 和 INotifyCollectionChanged。

```
Dim _dbcontext as New EntityFrameworkEntities
Dim _PrivateCollection as ObservableCollection(Of T)

Public Property Collection as ObservableCollection(Of T)
  Get 
    Return _PrivateCollection
  End Get
  Set(value as ObservableCollection(Of T))
    [Insert Validation Here]
    _PrivateCollection = Value
    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs("Collection"))
  End Set
End Property 
```

然后确保在构造函数中填充集合，并添加处理程序以从实体框架中添加或删除对象。

```
Public Sub New()
  _PrivateCollection = New ObservableCollection(Of T)(dbcontext.EFCollectionName.ToList)
  AddHandler Collection.CollectionChanged, AddressOf OnEFCollectionChanged
End Sub

Public Event CollectionChanged(Sender as Object, e As NotifyCollectionChangedEventArgs) Implements INotifyCollectionChanged.CollectionChanged

Private Sub OnEFCollectionChanged(Sender as Object, e as NotifyCollectionChangedEventArgs)
  If e.Action = NotifyCollectionChangedAction.Add Then
    For Each Item In e.NewItems
      dbcontext.EFCollectionName.Add(Item)
    Next
  End If
  If e.Action = NotifyCollectionChangedAction.Remove Then
    For Each Item In e.OldItems
      dbcontext.EFCollectionName.Remove(Item)
    Next
  End If
End Sub 
```

显然，将 Private Collection 和 Collection 名称更改为您希望它们被调用的任何名称。然后将 EFCollectionName 更改为实体框架中调用的任何实体。

现在只需在您的 ViewModel 中添加 SaveChanges 命令并从保存按钮调用它，或者您想要连接它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:01:59.417

如果我理解，您试图仅通过 ViewModel 将模型绑定到 View 的 DataContext。所以这就是为什么你试图在模型中添加视图管理属性，这是错误的。模型只是可以通过 ViewModel 绑定到视图的一部分。您需要做的是将其自身的 ViewModel 对象绑定到 View 的 DataContext。
实体框架是您的应用程序和数据库之间的一种数据层。你可能需要先掌握 MVVM 而不是实体框架

# r - 基于随机森林对象预测响应填充数据

> ID：16156414
> 
> 赞同：1
> 
> 时间：2013-04-22T20:47:49.220
> 
> 标签：r, random-forest

使用`randomForest`，我得到一个 RF 对象。
例如`forest <- randomForest(as.formula(generic),data=train, mtry=2)`）

使用`predict`I 可以预测测试数据集上的响应。
响应为 A、B 或 C。

```
prediction <- predict(forest, newdata=test, type='class')
mytable <- table(test$class_w,prediction)
sum(mytable[row(mytable) != col(mytable)]) / sum(mytable)#show error 
```

调用森林对象我得到混淆矩阵：

```
 A     B    C     class.error
A   498    79   170   0.3333333
B   115    353  237   0.4992908
C   96     99   967   0.1678141 
```

例如**测试数据集**：

```
id |class_w| valueA | valueB |
1  |  C    |  0.254 |  0.334 |
2  |  A    |  0.654 |  0.334 |
3  |  A    |  0.554 |  0.314 |
4  |  B    |  0.454 |  0.224 |
5  |  C    |  0.354 |  0.332 |
6  |  C    |  0.264 |  0.114 |
7  |  C    |  0.264 |  0.664 | 
```

我想知道我是否可以创建一个包含 2 列的新数据集，其中包含前一个数据集的 id 和预测的响应（RF 给出）。例如

```
row id of test dataset  |  predicted response
1                       |  A  #failed
2                       |  B  #failed
3                       |  B  #failed
4                       |  B  #TRUE! 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:40:20.243

我认为您可能只是想创建一个新的数据框：

```
data.frame(id = test$id,response = prediction) 
```

假设这`id`实际上是 中的一列`test`，而不是行名。如果它们是行名，那么你会想要这样做：

```
data.frame(id = rownames(id),response = prediction) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-03T05:30:37.647

另一种方法是只写这样的东西：

```
yourNewDataSet$someNewColumnCreated= Predict(forest,yourNewDataSet,type="class") 
```

这应该会在新数据集中为您提供一个名为“someNewColumnCreated”的新列

当应用于这个新数据集时，它将包含您模型的所有预测。

# c# - 如何在 C# 中接收对 UDP 消息的 ICMP 响应“端口不可达”

> ID：16156416
> 
> 赞同：3
> 
> 时间：2013-04-22T20:47:51.030
> 
> 标签：c#, udp, icmp

我正在尝试接收对 UDP 消息的 ICMP 响应“端口无法访问”，`C#`这就是我正在尝试做的事情：

```
IPEndPoint remoteEndpoint = new IPEndPoint(IPAddress.Parse("192.168.211.133"), 0);
var udpClient = new UdpClient("192.168.211.133", 20);
Byte[] messagebyte = Encoding.Default.GetBytes("hi".ToCharArray());
int s = udpClient.Send(messagebyte, messagebyte.Length);
Byte[] ReceiveBuffer = new Byte[256];
ReceiveBuffer = udpClient.Receive(ref remoteEndpoint); 
```

但程序卡在

```
ReceiveBuffer = udpClient.Receive(ref remoteEndpoint); 
```

我究竟做错了什么？

请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T09:50:25.510

如果您捕获到异常并且 SocketErrorCode == SocketError.ConnectionReset，则意味着您收到“端口无法访问”。

或者，您可以设置一个套接字使用协议 Icmp，如下所示：

`Socket icmp = new Socket(AddressFamily.InterNetwork, SocketType.Raw, ProtocolType.Icmp);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T22:03:06.390

UDP的全部意义在于可能没有响应。经过一定时间后，您需要假设目的地不可读。

看看这个[其他问题](https://stackoverflow.com/questions/2281441/can-i-set-the-timeout-for-udpclient-in-c)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-17T13:36:31.507

该地址似乎是我尝试过的问题，如果您将其更改为 127.0.0.1，您确实会收到 icmp 消息

# php - 表单中的 jquery searchabledropdown 无法获取 $_POST 或 $_GET 值

> ID：16156420
> 
> 赞同：0
> 
> 时间：2013-04-22T20:47:59.173
> 
> 标签：php, jquery, forms, submit

每当我尝试使用 jquery searchabledropdown 插件时，我都无法为我的选择字段获取 php POST 变量。如果我注释掉 jquery，我可以很好地获取 POST 表单数据。但是，如果我添加下拉列表（从数据库中提取数据并将值分配给选择来源，则 $_POST 变量将返回空白。对于使用插件和下拉列表的每个实例，所有浏览器都会发生这种情况。我有上周搜索了这个论坛并尝试分配隐藏值和所有其他类似的解决方案都没有成功。jquery guru可以提供一些帮助吗？

编辑类.php

```
<script src='/app/js/spectrum.js'></script>
<link rel="stylesheet" type="text/css" href='/app/css/spectrum.css' />
<script type="text/javascript" src="/app/js/jquery.searchabledropdown-1.0.8.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    $("#grade").searchable();
});
</script>

<?php
$sql="select value,type_id from type where category='grade' and active_flg=1 order by value";
$result=mysql_query($sql);
$gradevalues="<option value=0>Search:</option>";
while($row=mysql_fetch_array($result)){
    if($teacherid1==$row['person_id']){$selected1="selected";}else{$selected1="";}
    $grade=$row['value'];
    $typeid=$row['type_id'];
    $gradevalues.='<option '.$selected1.' value="'.$typeid.'">'.$grade.'</option>';
}?>

  <form action="/app/forms/editclass_post.php"  method="POST" >
     <select name="grade" id="grade">
          <?php echo $gradevalues;?>
        </select>
<input type="submit" name="submit"  value="Update Class" class="button">
</form>

editclass_post.php

<?php

echo $_POST['grade'];
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T14:40:58.447

你不应该也包括jquery，例如：

```
<script type="text/javascript" src="/app/js/jquery-1.9.1.min.js"></script><br />
<script type="text/javascript" src="/app/js/jquery.searchabledropdown-1.0.8.min.js"></script> 
```

# perl - Internet Explorer 9 真的是 7 版吗？

> ID：16156421
> 
> 赞同：3
> 
> 时间：2013-04-22T20:48:00.823
> 
> 标签：perl, internet-explorer

我看到用户系统上的 IE 版本有一些奇怪的东西。我的 perl cgi 应用程序说版本是“MSIE 7”，当你在网络浏览器中单击帮助时，它说它是 MSIE 9。

浏览器数据的 Perl 代码：

我的 $browser_data = $ENV{'HTTP_USER_AGENT'};

为什么说 IE 是版本 7 而不是 9？

谢谢！！

约翰

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-22T20:51:42.707

您的用户为您的站点启用了“Intranet 设置”或“兼容性视图”。

这两个 IE 特性使 IE8 和 IE9 都伪装成 IE7。

`Trident`您可以从User-Agent 字符串中的存在中判断它在说谎，并得出真实版本- 请参阅 MSDN 上[的了解用户代理字符串](http://msdn.microsoft.com/en-gb/library/ms537503%28v=vs.85%29.aspx)。

# ios - 登录xcode成功后移动到另一个页面

> ID：16156423
> 
> 赞同：1
> 
> 时间：2013-04-22T20:48:03.380
> 
> 标签：ios, sql-server, modalviewcontroller

在从我的服务器成功发送基本登录应用程序的消息后，我试图移动到一个页面。目前，当我获得成功的日志时，它会移动到黑屏，就像它看起来不存在的视图控制器一样。但是，有一个视图控制器与我要上的课程相匹配。到目前为止，这是我的代码

```
 if([serverOutput isEqualToString:@"Yes"])
    {
        NSLog(@"Yes there was a match");
        WelcomeScreenViewController *newview =[[WelcomeScreenViewController alloc] init];
        [self presentViewController:newview animated:YES completion:nil];
        UIAlertView *alertsuccess = [[UIAlertView alloc] initWithTitle:@"Congrats" message:@"You are authorized"
                                                              delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];

        [alertsuccess show];
       `} 
```

为什么我成功登录后没有将我带到欢迎屏幕？我是否需要将欢迎设置为 rootcontroller，然后推送登录屏幕。为什么我不能使用 if 语句以编程方式移动到视图控制器？

`- (IBAction)loginbuttonpressed:(id)sender {

```
//Trim white space off username/password
NSString *rawEmail = [_UIEmailTextField text];
NSString *rawPass = [_UIPasswordTextField text];
NSString *trimmedEmail = [rawEmail stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];
NSString *trimmedPass = [rawPass stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];

//Check if text field is empty
if([_UIEmailTextField.text length] > 0 && [_UIPasswordTextField.text length] > 0)
{
    NSString *post =[NSString stringWithFormat:@"userName=%@&userPassword=%@",trimmedEmail, trimmedPass];
    NSString *hostStr = @"http://server name?";
    hostStr = [hostStr stringByAppendingString:post];
    NSData *dataURL =  [NSData dataWithContentsOfURL: [ NSURL URLWithString: hostStr ]];
    NSString *serverOutput = [[NSString alloc] initWithData:dataURL encoding: NSASCIIStringEncoding];
    if([serverOutput isEqualToString:@"Yes"])
    {
        NSLog(@"Yes there was a match");
        WelcomeScreenViewController *newview =[[WelcomeScreenViewController alloc] init];
        [self presentViewController:newview animated:YES completion:nil];
        UIAlertView *alertsuccess = [[UIAlertView alloc] initWithTitle:@"Congrats" message:@"You are authorized"
                                                              delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];`

    So all of this is run when you hit a log in button. I had it being a seque when you click log in but then if the log in fails it still logs in. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:52:46.743

当在 segue 之前测试一个值时，你应该从 viewController 而不是 UIButton 中隐含一个 segue。然后使用 performSegueWithIdentifier 执行添加到控制器的 segue。然后在您的 prepareForSegue 中，您可以测试不同的 segue 并将内容传递给destinationViewController。

[以编程方式执行 Segue 并将参数传递给目标视图](https://stackoverflow.com/questions/9248798/perform-segue-programmatically-and-pass-parameters-to-the-destination-view)

# python - 如何从多个列表中制作字典？

> ID：16156438
> 
> 赞同：2
> 
> 时间：2013-04-22T20:49:00.663
> 
> 标签：python, list, dictionary

我有许多相互对应的列表，如下所示：

```
ID_number = [1, 2, 3, 4, 5, 6, ...]
x_pos = [43.2, 53.21, 34.2, ...]
y_pos = [32.1, 42.1, 8.2, ...]
z_pos = [1.3, 67.1, 24.3, ...] 
```

等等

我希望能够根据 ID_number 对数据进行排序、拉取和执行操作，所以我想从这些列表中制作一个字典，如下所示，

```
dictionary = {'id1':[x_pos1, y_pos1, z_pos1], 'id2':[x_pos2, y_pos2, z_pos2], ...} 
```

其中键是 ID 号，值是包含该 ID 号对应数据的列表。我将如何在 python 中有效地做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T20:55:10.313

使用[`zip`](http://docs.python.org/2/library/functions.html#zip)两次：

```
>>> ids = [1,2,3,4]
>>> x_pos = [1.32, 2.34, 5.56, 8.79]
>>> y_pos = [1.2, 2.3, 3.4, 4.5]
>>> z_pos = [3.33, 2.22, 10.98, 10.1]
>>> dict(zip(ids, zip(x_pos, y_pos, z_pos)))
{1: (1.32, 1.2, 3.33), 2: (2.34, 2.3, 2.22), 3: (5.56, 3.4, 10.98), 4: (8.79, 4.5, 10.1)} 
```

与 genexp 的时序比较：

```
>>> import timeit
>>> timeit.timeit('dict(zip(ids, zip(x_pos, y_pos, z_pos)))', 'from __main__ import ids, x_pos, y_pos, z_pos')
1.6184730529785156
>>> timeit.timeit('dict((x[0], x[1:]) for x in zip(ids, x_pos, y_pos, z_pos))', 'from __main__ import ids, x_pos, y_pos, z_pos')
2.5186140537261963 
```

因此，使用`zip`两次比使用生成器表达式快大约 1.5 倍。显然，结果取决于迭代的大小，但我对使用 double 的事实非常有信心`zip`，至少在 CPython 2 上总是比显式循环快。生成器异常或`for`循环需要解释器比单次调用更多的工作`zip`，这消除了迭代过程的一些开销。

使用[`itertools.izip`](http://docs.python.org/2/library/itertools.html#itertools.izip)而不是`zip`不会改变太多时间，但对于大数据集来说内存效率要高得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T20:51:52.067

[`zip()`](http://docs.python.org/2/library/functions.html#zip)实现这一点非常有用。例如：

```
>>> ID_number = [1,2,3]
>>> x_pos = [43.2, 53.21, 34.2]
>>> y_pos = [32.1, 42.1, 8.2]
>>> z_pos = [1.3, 67.1, 24.3]
>>> dict((x[0], x[1:]) for x in zip(ID_number, x_pos, y_pos, z_pos))
{1: (43.200000000000003, 32.100000000000001, 1.3), 2: (53.210000000000001, 42.100000000000001, 67.099999999999994), 3: (34.200000000000003, 8.1999999999999993, 24.300000000000001)} 
```

如果数据集非常大，您可以`zip()`通过使用来避免创建整个数据集的全新副本[`itertools.izip()`](http://docs.python.org/2/library/itertools.html#itertools.izip)。此函数将返回一个迭代器，该迭代器将在请求时提供每个压缩元素，而不是将整个新结构保存在内存中。（结果将是相同的，但在更大的数据集上应该更快。）

```
>>> import itertools
>>> dict((x[0], x[1:]) for x in itertools.izip(ID_number, x_pos, y_pos, z_pos))
{1: (43.200000000000003, 32.100000000000001, 1.3), 2: (53.210000000000001, 42.100000000000001, 67.099999999999994), 3: (34.200000000000003, 8.1999999999999993, 24.300000000000001)} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T20:55:29.257

```
dictionary = {'id' + str(i): [x, y, z]
              for i, x, y, z in zip(ID_number, x_pos, y_pos, z_pos)} 
```

对于大型数据集，使用`itertools`'可能更快`izip()`。

# android - 更改代码时无法更新 AVD

> ID：16156440
> 
> 赞同：0
> 
> 时间：2013-04-22T20:49:06.870
> 
> 标签：android, avd, eclipse-adt

我可以打开 AVD 并运行应用程序，但它只运行旧版本的应用程序，即我第一次运行它时使用的那个。它不显示对布局或功能的任何更改。

如果我确实对代码的某些部分进行了更改，例如按钮，那么该按钮将不再工作或做任何事情，即使它应该这样做。代码没问题。没有错误。

这一切都是第一次工作，我只是不知道当我做出改变时如何让它更新

# javascript - 同一页面上的多个版本的脚本 (d3.js)

> ID：16156445
> 
> 赞同：17
> 
> 时间：2013-04-22T20:49:28.720
> 
> 标签：javascript, jquery, d3.js

我需要在同一页面上有多个版本的 javascript 库。除了手动重构一个版本以避免命名冲突之外，我该如何实现这一点？

有很多关于如何使用 Jquery 执行此操作的示例（[示例](https://stackoverflow.com/questions/1566595/can-i-use-multiple-versions-of-jquery-on-the-same-page)）。然而，这似乎依赖于 jQuery 的优点。如何为任意脚本执行此操作？

更多细节：我正在使用[d3.js](http://d3js.org/)，并且我正在插入其他人使用 d3 制作的可视化。问题是，其中一个可视化需要一个 d3 版本，另一个需要更新版本。这两个可视化应该在同一页面上可用 - 用户通过单击缩略图交换显示哪个可视化，然后使用 js 隐藏一个可视化并构建另一个可视化。因此，似乎也可以选择交换脚本而不是以无冲突的方式加载两者。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-22T20:57:00.320

如果您看一下主要的 d3 源文件：[https ://github.com/mbostock/d3/blob/master/d3.js](https://github.com/mbostock/d3/blob/master/d3.js)

你看到它开始了：

```
d3 = function() {
  var d3 = {
    version: "3.1.5"
  };
  //..... 
```

所以 d3 只是一个对象。我不确定这是否是最好的方法，但我认为以下方法可行：

1.  包括一个版本的 d3
2.  把这条线：`d3versionX = d3;`
3.  包括下一个版本
4.  与 2 相同，但版本号不同。
5.  将`d3 = d3versionX`X 放置在页面加载时可视化的默认版本的位置
6.  在触发版本切换的缩略图上放置一个事件处理程序，并将 d3 变量设置为适当的版本号作为发生的第一件事。

## 使用示例代码更新

有关工作示例，请参阅[此 jsbin 。](http://jsbin.com/naqidebino/edit?html,js,console,output)相关代码：

```
 <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.0/d3.min.js"></script>
  <script>
    d3version4 = d3
    window.d3 = null
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
  <script>
    d3version3 = d3
    window.d3 = null
    // test it worked
    console.log('v3', d3version3.version)
    console.log('v4', d3version4.version)
  </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-01T12:01:34.327

我遇到了和你类似的问题，一些可视化需要 d3 v3，而另一些需要 v4。这就是我实现它的方式。

1.  在 index.html 中包含 d3 v3（因为我的大部分可视化都在 v3 上）
2.  在 index.html 上包含 require.js 脚本 //你可以使用 cdn 路径
3.  转到需要 v4 的 JavaScript。
4.  在顶部写下以下代码。

    ```
    function graphicviz(id) {   
        require.config({
            paths: {
                d3: "https://d3js.org/d3.v4.min"
            }
        });

        require(["d3"], function(d3) {
            //... D3 Code Here...
        });
    }

    //Call The Function
    graphicviz(id); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T20:57:20.870

你需要使用这个一般原则

```
var x = {
    version: 1,
    alert1: function() {
        alert("1hi1");
    },
    alert2: function() {
        alert("1hi2");
    }
};

var y = x;

var x = {
    version: 2,
    alert1: function() {
        alert("2hi1");
    },
    alert2: function() {
        alert("2hi2");
    }
};

y.alert1();
x.alert1(); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/SdHV3/)

jquery 提供了它的`noconflict`方法，许多库提供了相同的（不一定是名称）方法。但是您可以通过参考我的示例自己完成，具体取决于您正在加载的脚本的复杂性。

以下是如何注入 2 个不同的版本，并使用上述原理将它们分配给不同的变量。

```
<div id="version1"></div>
<div id="version2"></div>

var script1 = document.createElement("script"),
    script2 = document.createElement("script"),
    oldD3;

function noConflict() {
    oldD3 = d3;
    console.log("loaded old");
    script2.type = 'text/javascript';
    script2.src = "http://d3js.org/d3.v3.min.js";
    script2.addEventListener("load", ready, false);
    document.head.appendChild(script2);
}

function ready() {
    console.log("loaded new");
    console.log(d3, oldD3);
    document.getElementById("version1").textContent = oldD3.version;
    document.getElementById("version2").textContent = d3.version;
}

script1.type = 'text/javascript';
script1.src = "http://d3js.org/d3.v2.min.js";
script1.addEventListener("load", noConflict, false);
document.head.appendChild(script1); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/AXg99/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-12T15:28:39.767

从 d3 版本 d3.v4 开始，脚本的标题看起来有点不同。您可以将标识符**global.d3**更改为**global.d3v4**，使其看起来像这样

```
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (factory((global.d3v4 = global.d3v4 || {})));
}(this, (function (exports) { 'use strict';

var version = "4.8.0";
... 
```

现在你可以调用`d3`函数了`d3v4`。

# java - 在python中搜索列表以查找项目的更好方法

> ID：16156447
> 
> 赞同：3
> 
> 时间：2013-04-22T20:49:34.993
> 
> 标签：java, python, for-loop, foreach

有时我有一个列表列表，我需要在所有列表中搜索单个项目。我使用这个 python 代码：

```
boolean found = false

for(hayStack : listOfHayStacks){
   found = findNeedle(hayStack)

   if(found)
      break;
}

if(!found){
    // error case
} 
```

我似乎经常遇到这种情况，我总觉得应该有更好的方法来处理这种情况。

是否有一个总结所有结果的：“atLeastOne”结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:02:30.353

Python 对此有特殊的语法。

```
for haystack in haystacks:
    if find_needle(haystack):
        break
else:
    # error case (did not break) 
```

根据您在代码中需要多少逻辑，您还可以执行以下操作：

```
some_needles_exist = any(find_needle(x) for x in haystacks)
all_stacks_have_needles = all(find_needle(x) for x in haystacks) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:58:59.250

您始终可以创建一个单独的函数，在该函数中使用双 for 循环。它可能更具可读性：

```
for (hayStack : listOfHayStacks) {
    for (needle : hayStack) {
        if needle satisfies criteria
            return true
    }
}
return false 
```

搜索所有干草堆的问题在于，如果您可以在最初的几个干草堆中返回，那么您可能会浪费大量时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T03:27:09.377

如果您要更多地专注于在大海捞针中找到或不找到针的操作，那么您可以执行以下操作：

```
>>> criteria = lambda n: n == 3
>>> def found(needle):
    if criteria(needle):
        print("Doing something as found")
        return True
    else: return False

>>> def missed():
    print("Doing missed action")
    return False

>>> wasfound = any(found(i) for i in range(2)) or missed()
Doing missed action
>>> wasfound
False
>>> wasfound = any(found(i) for i in range(4)) or missed()
Doing something as found
>>> wasfound
True
>>> 
```

# .net - 线程安全属性

> ID：16156448
> 
> 赞同：1
> 
> 时间：2013-04-22T20:49:39.667
> 
> 标签：.net, vb.net, concurrency, parallel-processing, parallel.foreach

我有一个具有许多属性的类，它们是`Integer`和`Single`。我想以多线程方式使用该类，以便可以将属性用作累加器（该类是报告方案的基础）。所以我希望能够做这样的事情：

```
Public Class ReportTotals
    Property Count As Integer
    Property Total As Single
    Property Tax As Single
    Property Shipping As Single
    Property ItemsSold As Integer

    Public Function GetReport() As String
    ...
    End Function
End Class

Public Function BuildReportData As ReportTotals

    Dim myReport As New ReportTotals
    With myReport
        Parallel.ForEach(UserSales, Sub(userSale)
                .Count += 1
                .Total += userSale.Total
                .Tax += userSale.Tax
                .Shipping += userSale.Shipping
                .ItemsSold += userSale.ItemsSold

                'more complicated stuff and property assignments

            End Sub)
    End With
End Function 
```

根据我的研究，我知道这一点`Integer`并且`Single`是原子的，但我不确定这是否扩展到作为类的一部分的整数。我不想假设，因为多线程错误可能会在以后出现并咬我。

更新：显然，`Single`不是线程安全的，所以我必须在那个上使用锁，但是呢`Integer`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:51:58.840

您可以使用[Interlocked.Increment](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)以原子方式递增整数，即使它们是类成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T22:26:11.833

这听起来像你想要的是[与 local state 一起工作](http://msdn.microsoft.com/en-us/library/dd991486.aspx)[的重载`Parallel.ForEach()`](http://msdn.microsoft.com/en-us/library/dd991486.aspx)。

在`localInit`委托中，您将创建一个新实例，`ReportTotals`并在锁定`localFinally`中将本地值添加到全局值。`ReportTotals`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:02:04.043

也许[SyncLock](http://msdn.microsoft.com/en-us/library/3a86s51t.aspx)是您正在寻找的。

```
 Public Sub sale(s As String)
     SyncLock _lock
          //'thread safe code'
     End SyncLock
 End Sub

 Public Function BuildReportData as ReportTotals

 Dim myReport As New ReportTotals
 With myReport
     Parallel.ForEach(UserSales, sale(userSale))

 End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T22:07:54.687

至少在有人有更好的主意之前，我决定做的是`ReportTotals`在例程中创建大量对象`Parallel.ForEach`并将它们全部放入`ConcurrentBag`. 然后，在`Parallel.ForEach`语句结束后，我使用常规语句将对象中的`For Each`所有值累积到一个新对象中，然后我将其返回。`ReportTotals``ConcurrentBag``ReportTotals`

所以我正在做这样的事情：

```
Public Class ReportTotals
    Property Count As Integer
    Property Total As Single
    Property Tax As Single
    Property Shipping As Single
    Property ItemsSold As Integer

    Public Function GetReport() As String
    ...
    End Function
End Class

Public Function BuildReportData As ReportTotals

    Dim myReport As New ReportTotals
    Dim myReports As New ConcurrentBag(Of ReportTotals)

    Paralle.ForEach(UserSales, Sub(userSale)
            Dim workingReport As New ReportTotals
            With workingReport
                .Count += 1
                .Total += userSale.Total
                .Tax += userSale.Tax
                .Shipping += userSale.Shipping
                .ItemsSold += userSale.ItemsSold

                'more complicated stuff and property assignments

            End With
        End Sub)

    For Each report In myReports 
        With myReport
            .Count += report.Count
            .Total += report.Total
            .Tax += report.Tax
            .Shipping += report.Shipping
            .ItemsSold += report.ItemsSold
        End With
    Next

    Return myReport
End Function 
```

# c++ - c++ new 运算符可以在 Windows 上自动使用大页面吗？

> ID：16156451
> 
> 赞同：1
> 
> 时间：2013-04-22T20:49:43.527
> 
> 标签：c++, windows, memory-management

假设我使用 Visual Studio 编写了一个 C++ 程序，它使用 new 运算符来分配内存。我想知道是否有一种方法可以让 new 自动使用大页面而不是标准的 4KB 页面（即，我的程序没有显式调用 VirtualAlloc）。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:13:15.147

您可以覆盖所有**新的**和**删除**的运算符。例如

```
void * operator new(size_t size)
{
    return malloc(size);
}

void operator delete(void * pointer)
{
    free(pointer);
} 
```

您还应该覆盖此运算符的所有变体：

*   [http://www.cplusplus.com/reference/new/operator%20new/](http://www.cplusplus.com/reference/new/operator%20new/)
*   [http://www.cplusplus.com/reference/new/operator%20new%5B%5D/](http://www.cplusplus.com/reference/new/operator%20new%5B%5D/)
*   [http://www.cplusplus.com/reference/new/operator%20delete/](http://www.cplusplus.com/reference/new/operator%20delete/)
*   [http://www.cplusplus.com/reference/new/operator%20delete%5B%5D/](http://www.cplusplus.com/reference/new/operator%20delete%5B%5D/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:41:39.770

> Implementation specific, once again. All libraries are not restricted to doing that since all the standard says AFAIK is that new allocates memory for C++. For Microsoft's implementation, new always calls HeapAlloc.

[http://cboard.cprogramming.com/cplusplus-programming/98364-new-invokes-virtualalloc.html](http://cboard.cprogramming.com/cplusplus-programming/98364-new-invokes-virtualalloc.html)

My understanding is that unless you're running in a virtual machine, the OS has full control over the default heap and stack memory allocation. The above link also brings up a good point in line with Raymond's response to your question: Are you sure you need to use large pages? You open yourself to a good deal of internal fragmentation by doing so.

# scala - 在 Jackson 中使用计算的默认值而不是 null

> ID：16156456
> 
> 赞同：4
> 
> 时间：2013-04-22T20:49:59.230
> 
> 标签：scala, jackson, default-value

我正在使用杰克逊 2.1.3。我的目标是在从 JSON 反序列化 bean 时为字段使用一些默认值。具体来说，我是在 Scala 上编写的，所以我希望反序列化器使用字段的默认值，如果 JSON 中未指定字段，但在 scala 类的构造函数中指定了默认值。我可以在运行时为已知的构造函数和索引或缺少参数的名称检索默认值，但我找不到在 bean 反序列化器中使用该值的方法。

我知道，这个问题在 Jerkson 中得到了解决，但首先我不能使用它，因为它不能在 Scala 2.10 上运行，其次他们通过使用自己的案例类反序列化器而不是 Jacksons 的 BeanDeserializer 来解决它 - 所以他们失去了一些基本的杰克逊特征。

我尝试将 AnnotationIntrospector 与定义的“findDeserializer”方法一起使用。我用自定义的“getNullValue”扩展了 DelegatingDeserializer，但是委托人有问题——我没有找到在“findDeserializer”方法上下文中获得好的反序列化器的方法，而不会丢失一些类型信息。

然后我花了很多时间阅读杰克逊的源代码，我没有找到任何方法来为 bean 反序列化的字段提供默认值，而没有复制粘贴杰克逊库的一半，在少数字段上使用弱访问修饰符。

# twitter-bootstrap - 如何使用 Ember.js 和 Handlebars.js 渲染（Twitter Bootstrap）网格？

> ID：16156458
> 
> 赞同：5
> 
> 时间：2013-04-22T20:50:05.980
> 
> 标签：twitter-bootstrap, ember.js, handlebars.js

我很难找到一种使用 Ember.Handlebars 呈现以下标记的方法：

```
<div class="row-fluid">
  <div class="span4">Item #1 (row #1 / column #1)</div>
  <div class="span4">Item #2 (row #1 / column #2)</div>
  <div class="span4">Item #3 (row #1 / column #3)</div>
</div>
<div class="row-fluid">
  <div class="span4">Item #4 (row #2 / column #1)</div>
  <div class="span4">Item #5 (row #2 / column #2)</div>
  <div class="span4">Item #6 (row #2 / column #3)</div>
</div>
<div class="row-fluid">
  <div class="span4">Item #7 (row #3 / column #1)</div>
</div> 
```

使用纯 JavaScript，我会做这样的事情：

```
var array = ['Item 1', 'Item 2', 'Item 3', 'Item 4', 'Item 5', 'Item 6', 'Item 7'],
    output = '<div class="row-fluid">';

for (var i = 0, j = array.length; i < j; i++) {
  output += '<div class="span4">' + i + '</div>';

  if ((i + 1) % 3 == 0) {
    output += '</div><div class="row-fluid">';
  }
}

output += '</div>'; 
```

理想情况下，我会将它放在自定义 Handlebars 助手中（从而从模板中删除逻辑），但[Ember 文档](http://emberjs.com/guides/templates/writing-helpers/)只解释了如何编写简单的助手，我真的不知道如何编写更复杂的块助手而不丢失属性绑定。

有谁知道将 Twitter Bootstrap 的网格系统与 Ember 模型集合一起使用的最佳方式？

先感谢您！最好的祝福，

大卫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:42:10.410

戴夫

尝试使用“无序列表”而不是使用行和 div 来制作块网格

的HTML

```
<ul class="row-fluid block-grid-3">
  <li>Item #1 (row #1 / column #1)</li>
  <li>Item #2 (row #1 / column #2)</li>
  <li>Item #3 (row #1 / column #3)</li>
  <li>Item #4 (row #2 / column #1)</li>
  <li>Item #5 (row #2 / column #2)</li>
  <li>Item #6 (row #2 / column #3)</li>
  <li>Item #7 (row #3 / column #1)</li>
</ul> 
```

然后CSS看起来像这样。

```
ul.block-grid-3 {
   display: block;
   overflow: hidden;
   padding: 0;
   -webkit-box-sizing: border-box;
   -moz-box-sizing: border-box;
   box-sizing: border-box;
}
ul.block-grid-3 > li {
   width: 33.33333%;
   float: left;
   padding: 0 12px 12px;
   display: block;
   height: auto;
   -webkit-box-sizing: border-box;
   -moz-box-sizing: border-box;
   box-sizing: border-box;
}
ul.block-grid-3 > li:nth-of-type(3n+1) {
   clear: left;
} 
```

然后，如果您想更改为四个块，可以将 css 更改为：

```
ul.block-grid-4 > li {
   width: 25%;
   float: left;
   padding: 0 12px 12px;
   display: block;
   height: auto;
   -webkit-box-sizing: border-box;
   -moz-box-sizing: border-box;
   box-sizing: border-box;
}  
ul.block-grid-4 > li:nth-of-type(4n+1) {
   clear: left;
} 
```

[jsfiddle 示例](http://jsfiddle.net/Kiwiupover/BHB9m/)是一个更强大的解决方案。

您还可以查看这个 ember 应用程序[Open-pos](http://open-pos.herokuapp.com/#/orders/72)产品是使用这种方法进行布局的。

Zurb 的 css 框架“基础”作为称为[block-grid](http://foundation.zurb.com/docs/components/block-grid.html)的出色解决方案。这个系统非常容易改变 3 up grid 的其他数字，只需在 css 中进行少量更改。您可以将[块网格代码](https://github.com/zurb/foundation/blob/master/scss/foundation/components/_block-grid.scss)放入您的引导程序 scss。如果您有任何问题，请告诉我。

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T11:31:08.663

对于那些感兴趣的人，这是处理这种情况的一种非常干净的方法。

这是模板：

```
{{#each post in posts}}
  {{#if post.first}}
    <div class="row-fluid">
  {{/if}}
    <div class="span4">
      <div class="post">
        {{post.title}}
      </div>
    </div>
  {{#if post.lastOfRow}}
    </div>
    <div class="row-fluid">
  {{/if}}
  {{#if post.last}}
    </div>
  {{/if}}
{{/each}} 
```

以及对应的控制器：

```
App.PostsController = Ember.ArrayController.extend({
  posts: function () {
    var length = this.get('length');

    return this.map(function (post, i) {
      // Checks if it’s the last post
      if ((i + 1) == length) {
        post.last = true;
      } else {
        post.last = false;

        // Checks if it’s the first post
        if (i == 0) {
          post.first = true;
        } else {
          post.first = false;
        }

        // Checks if it’s the last post of a row
        if ((i + 1) % 3 == 0) {
          post.lastOfRow = true;
        } else {
          post.lastOfRow = false;
        }
      }

      return post;
    });
  }.property('content.@each')
}); 
```

`<td>`这对于生成表（嵌套在）也可能很有用`<tr>`......即使我最终使用了 kiwiupover 的解决方案！;-)

问候，

D.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-20T03:58:21.653

接受的答案效果很好，但如果你有动态的行和跨度将在模型/属性更改`posts`时重新绘制。`posts`如果内容很小，这可能没问题，但在我的情况下，我为每个块都有一个图表，当它们都同时重绘时很明显。

就我而言，我决定覆盖引导 css；但是，您可能希望通过其他媒体查询来考虑各种屏幕尺寸。

这是针对最大网格并确保`span4`在每个“行”上正确对齐的 3 s（注意这是 BS 2.3.2）的规则，但在单个 s 内`row-fluid`：

```
 .row-fluid [class*="span4"]:nth-of-type(3n+1) {
    margin-left: 0;
  }
  .row-fluid [class*="span4"]:nth-of-type(n+4) {
    margin-top: 10px;
  } 
```

# php - Mysql PHP 查询运行完美，但返回为 false

> ID：16156463
> 
> 赞同：1
> 
> 时间：2013-04-22T20:50:20.627
> 
> 标签：php, mysql

我有一些 mysql_query() 可以正常工作，但是如果我将它们放在 if else 语句中，它们会返回 false。任何想法？

```
 public function delete_post() {

        $id = $_GET['post_id'];

        mysql_query("DELETE FROM posts WHERE post_id='$id' LIMIT 1");

        if ( !mysql_query() ) {
            echo ('Could not be Deleted');
        } else { 
            echo 'Deleted Successfully'; 
        }
    } 
```

当我运行它时，它会删除帖子，但返回“无法删除”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T20:53:32.510

您正在使用空 SQL 语句运行查询，这不是正确的 SQL。尝试这个。

```
$result = mysql_query("DELETE ...");
if (!$result) {
    echo ('Could not be Deleted');
} else {
    echo 'Deleted Successfully';
} 
```

区别在第 2 行（我的代码）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T20:53:18.640

**注意：不推荐使用** [mysql_query()](http://php.net/manual/en/function.mysql-query.php)。你真的应该使用[PDO::query](http://www.php.net/manual/en/pdo.query.php)代替。

**如果您仍想使用它，请执行以下操作：**

```
$result = mysql_query("DELETE FROM posts WHERE post_id='$id' LIMIT 1");
if (!$result) 
{
    echo ('Could not be Deleted');
} 
```

**解释：**

在您的原始代码中，您调用`mysql_query()`了两次。第二次，没有参数，所以它不起作用，这就是你的代码所报告的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T20:54:59.163

我认为这是一个非常相似的问题/答案：[成功的 MySQL DELETE 会返回什么？如何检查 DELETE 是否成功？](https://stackoverflow.com/questions/922398/what-does-a-successful-mysql-delete-return-how-to-check-if-delete-was-successfu)

你能试试它的建议，看看它是否对你有用吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T20:54:06.080

你可以试试：

```
public function delete_post() {

        $id = $_GET['post_id'];

        $query = mysql_query("DELETE FROM posts WHERE post_id='$id' LIMIT 1");

        if ( !$query ) {
            echo ('Could not be Deleted');
        } else { 
            echo 'Deleted Successfully'; 
        }
    } 
```

# php - 召回要在网站上显示的部分 excel 文件

> ID：16156464
> 
> 赞同：0
> 
> 时间：2013-04-22T20:50:23.150
> 
> 标签：php, xml, excel, joomla2.5

我已经在很多网站上看到了这一点，但就是想不通。我有一个 excel 文件，上面有祈祷时间的时间表，每天都会改变这个网站在页面的左上角 - [http://www.centralmosque.org.uk](http://www.centralmosque.org.uk)。现在我已经对其进行了排序，以便通过 iframe 导入通用通用信息以获取某些信息。其余的在一个 excel 文件中，并且将有 'Jamaat' 时间，它需要根据当前日期提取....有没有一种方法可以让我每天从一个 excel 文件中提取 5 位信息并显示在网站上作为表格...我可以下载 excel 文件，以便它包含一整年的数据工作 - 但只是不确定使用哪个软件来实现它 亲切的问候 shad

# ruby-on-rails - Rails 渲染 ajax 错误

> ID：16156467
> 
> 赞同：1
> 
> 时间：2013-04-22T20:50:34.983
> 
> 标签：ruby-on-rails, ruby, ajax, jquery

我有一个这样的 index.html.erb

```
<div id="carte_items">
  <ul id="nav">
    <li id="category_14" class="category-group">
      <p class="category">Pizzas tradicionais</p>

      <ul class="tags">
        <li>
          <div class="links" style="display: none;">
            <a href="#" data-method="delete" data-remote="true" rel="nofollow">
              <i class="icon-trash icon-white"></i>
            </a>

            <a href="#" data-remote="true">
              <i class="icon-pencil icon-white"></i>
            </a>
          </div>
          Pizza X
        </li>

        <li>
          <div class="links" style="display: none;">
            <a href="#" data-method="delete" data-remote="true" rel="nofollow">
              <i class="icon-trash icon-white"></i>
            </a>

            <a href="#" data-remote="true">
              <i class="icon-pencil icon-white"></i>
            </a>
          </div>
          Pizza X
        </li>
      </ul>
    </li>
  </ul>
</div> 
```

所以，我的 products.js.coffee 中有这个

```
$("ul.tags li").on('mouseover', () ->
 $(this).find('.links').show()
).on('mouseout', () ->
 $(this).find('.links').hide()
) 
```

当我第一次访问我的 index.html.erb 时，一切正常。但是对于在我第一次访问时仍然有效的链接，我必须将 products.js.coffee 中的源代码复制到下面的 index.js.erb 中。就像当我使用我的搜索时，使用 ajax 进行搜索一样，如果我没有像下面那样复制源代码，“.links”就不会再显示了。

他们我有这样的 index.js.erb

```
$("#carte_items").html("<%= j(render 'carte_items') %>");
$("ul.tags li").on('mouseover', function() {
  return $(this).find('.links').show();
}).on('mouseout', function() {
  return $(this).find('.links').hide();
}); 
```

为什么一定要复制源码？它不必只使用文件 products.js.coffee 中的源代码而无需复制到 index.js.erb 就可以正常工作？

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T17:32:57.943

来自 jQuery API 文档：

[。上（）](http://api.jquery.com/on/)

*描述：将一个或多个事件的事件处理函数附加到选定元素。*

[。代表（）](http://api.jquery.com/delegate/)

*描述：基于一组特定的根元素，为现在或将来匹配选择器的所有元素附加一个处理程序到一个或多个事件。*

代表：“……现在或**将来**”。所以尝试`delegate()`代替`on()`.

希望它有效！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T17:30:44.013

尝试这个：

```
$("ul.tags").delegate('li', 'mouseover', () ->
 $(this).find('.links').show()
).delegate('li', 'mouseout', () ->
 $(this).find('.links').hide()
) 
```

或者：

```
$("ul.tags").on('mouseover', 'li', () ->
 $(this).find('.links').show()
).on('mouseout', 'li', () ->
 $(this).find('.links').hide()
) 
```

# c - 弹出堆栈的唯一成员

> ID：16156470
> 
> 赞同：0
> 
> 时间：2013-04-22T20:50:53.013
> 
> 标签：c, stack

我使用双向链表在 C 中构建了一个堆栈结构，并且在弹出列表的最后一个元素时遇到了段错误。这是 pop 方法和一些相关的全局变量：

```
typedef struct node {

    int value;
    struct node *prev;
    struct node *next;

} node;

node *head = NULL;
node *tail = NULL;
int stackSize = 0;

int removeFromStack(){
    node *tempNode = head;

    if(stackSize <= 0){
        emptyStackError();
    }

    int val = head->value;

    if(stackSize == 1){
        head = NULL; //Segfaults here
        tail = NULL;
    }

    else{
        head = head->next;
        head->prev = NULL;
    }

    free(tempNode);
    stackSize--;
    return val;
} 
```

很明显，我不应该只是将头部和尾部设置为空。我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:58:43.717

The error is not likely to be where you said. You just assign a value to a pointer. My guess is that it is coming from two lines above.

Before:

```
int val = head->value; 
```

Please add:

```
assert(head != NULL && "Oops, the counter is messed up"); 
```

And try to run your code again.

If the assert fires, track all usage of `stackSize`. If it does not, it doesn't necessarily mean that the pointer is not random, or points on de-allocated space. Comment everything but `head->value` in this function. Then try to create a list, push one element, then try call `removeFromStack`. Then try push two elements, pop one and try `removeFromStack` again.

My guess is your counter get corrupted somewhere in another function.

# java - Java 错误：类 PaintballPlayer 中的方法 recordShot 不能应用于给定类型；

> ID：16156472
> 
> 赞同：0
> 
> 时间：2013-04-22T20:51:00.523
> 
> 标签：java

当我编译我的代码时，我得到了这个错误：

“PaintballPlayerTest.java:19：错误：PaintballPlayer 类中的方法 recordShot 不能应用于给定类型；sheldon.recordShot(0)；需要 ^：未找到参数：int 原因：实际参数列表和正式参数列表的长度不同”

这非常令人沮丧，我希望这里有人可以帮助我。代码如下......

矿：

```
import java.util.*;

public class PaintballPlayer
{
private String firstName, middleName, lastName;
private String secFirst, secLast;
private int id;
private int count;
private static int totalPlayers;
private int playerID;
private int players;
private int shots;
private static int shotsFired;

public PaintballPlayer(String first, String middle, String last)
{
    count = 0;
    id = totalPlayers++;
    players = count++;
    shots = count++;
    firstName = first;
    middleName = middle;
    lastName = last;

}

public PaintballPlayer(String f, String l)
{
    this (f,"",l);
    id = count++;

}

   public PaintballPlayer() 
{
totalPlayers++;
    }

   public static int getTotalPlayers() 
{
return totalPlayers;
}

public int recordShot()
{
    return count;
}

public String toString()
{
    String name;
    String n;
    name = firstName + " " + middleName + " " + lastName;

    return name;

}

public int getPlayerID()
{
    playerID = count;
    return playerID;
}

} 
```

测试代码：

```
public class PaintballPlayerTest
{

public static void main (String [] args)
{
//Part 1 check constructor & toString --(make sure ID is working too)
PaintballPlayer sheldon = new PaintballPlayer ("Sheldon", "Lee", "Cooper");
PaintballPlayer leonard = new PaintballPlayer ("Leonard", "Hofstadter");
PaintballPlayer amy = new PaintballPlayer ("Amy", "Farrah", "Fowler");

System.out.println(sheldon);
System.out.println(leonard);

//Part 2 test getTotalPlayer --should be 3
System.out.println("The team has this many players " + PaintballPlayer.getTotalPlayers());

//Part 3 test recordShot
sheldon.recordShot(0);
sheldon.recordShot(1);
leonard.recordShot(0);
leonard.recordShot(0);
sheldon.recordShot(0);
sheldon.recordShot(1);
leonard.recordShot(2);
} 
```

我的问题在于标有第 3 部分的区域。我感谢我得到的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:52:31.173

> 必需：未找到参数：int 原因：实际参数列表和正式参数列表的长度不同”

异常消息非常清楚。

你有`recordShot()`没有参数`PaintballPlayer`

```
public int recordShot()
{
    return count;
} 
```

但是用`int`参数调用`PaintballPlayerTest`

```
sheldon.recordShot(0); 
```

您需要在调用时更改`recordShot()`为`recordShot(int cnt)`（或）删除传递值`recordShot()`

# jquery - jQuery UI Accordion 在 IE8、IE9 和 IE10 中失败

> ID：16156484
> 
> 赞同：1
> 
> 时间：2013-04-22T20:51:35.340
> 
> 标签：jquery, css, jquery-ui, internet-explorer, jquery-ui-accordion

jQuery UI Accordion 出现了非常奇怪的错误。

**版本信息**

*   Internet Explorer 8、9 和 10 --> 打开了“兼容性视图”。
*   jQuery UI 1.10.1
*   jQuery 核心 1.9.1

**问题场景**

我有多个垂直堆叠的独立手风琴。当我单击标题以折叠或展开顶部的手风琴时，下面的元素会上下滑动，就像您希望为出现/消失的内容腾出空间一样。但是，正下方的手风琴标题保持在原地悬停，而其他所有内容都向下滑动。看起来真的很糟糕。当您将鼠标光标悬停在此*流氓浮动标题*上时，它会弹回应位于的位置。

**代码**

希望我以后可以建立一个 jsFiddle，如果/当我的工作解除对站点的阻塞（翻白眼）。现在，这是代码的简化版本：

```
<script>
    $(document).ready(function ()
    {
        $(".accordion").accordion(
        {
            collapsible: true,
            active: 0,
            heightStyle: 'content',            
            icons: { "header": "ui-icon-plus", "activeHeader": "ui-icon-minus" }
        });
    });
</script>
<style>
    .whitebackground { background-color: #FFF; }
    .contentDiv { height: 70px; background-color: lightblue; }
</style>
<div>    
    <div class="whitebackground">
        <table>
            <tr>
                <td>
                    <div class="accordion">
                        <h3>Accordion Header 1</h3>
                        <div>
                            <div class="contentDiv">
                                Some content here 1
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
        <table>
            <tr>
                <td>
                    <div class="accordion">
                        <h3>Accordion Header 2</h3>
                        <div>
                            <div class="contentDiv">
                                Some content here 2
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</div> 
```

**重现错误**

要重现该错误，只需尝试通过单击标题折叠顶部手风琴，您将立即看到问题。

**我已经缩小了范围...**

我已经能够缩小导致此问题的确切问题的范围。如果您删除 whitebackground CSS 类，问题就会消失。为什么会发生这种情况？这对你们来说似乎是一个错误吗？

**请阅读最后一部分**

是的，我需要保持我的 HTML 结构原样。我已经为这个例子大大简化了它，同时仍然保持错误。我只想说我确实想保留 TABLE 元素。无需建议删除它。而且我需要让包含 TABLE 的 DIV 也能够指定 CSS 背景颜色。另外，我不能让用户在 IE 中关闭“兼容性视图”，因为我们的 AD 组策略会在访问内部 Web 应用程序时强制所有人启用它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T16:52:39.263

这似乎是由应用于 .ui-accordion-header 的 position:relative css 规则引起的。将其注释掉似乎可以解决 IE 兼容模式下的问题。

```
.ui-accordion .ui-accordion-header {
    display: block;
    cursor: pointer;
    /*position: relative;*/
    margin-top: 2px;
    padding: .5em .5em .5em .7em;
    min-height: 0; /* support: IE7 */
} 
```

但是，这会导致标题图标显示在错误的位置。你必须调整他们的 CSS 来弥补。也可能有其他副作用。

# c++ - Visual C++ 和 Allegro5：无法从头文件中识别抽象类中的对象

> ID：16156491
> 
> 赞同：0
> 
> 时间：2013-04-22T20:51:58.643
> 
> 标签：c++, intellisense, header-files, dynamic-memory-allocation, allegro5

我是 allegro 的初学者，对 C++ 不太熟悉，但我了解这门语言，所以我想编写一个国际象棋游戏。但是因为我想在这个游戏中使用图像，所以我研究了 Allegro 5 对其进行编程。我想出了一个（当然不完整）头文件来初始化游戏中的每个棋子：

片断.h

```
#pragma once
#include <allegro5/allegro.h>
#include <allegro5/allegro_native_dialog.h>
#include <allegro5/allegro_primitives.h>
#include <allegro5/allegro_image.h>
#include <iostream>
#include <string>

using namespace std;

class Piece
{
    private:

        int pieceX;
        int pieceY;
        bool inGame;
        char pieceColor;
        string imgAddress;
        ALLEGRO_BITMAP *pieceImage;

    public:

        Piece(int pieceX, int pieceY, bool inGame, char pieceColor, string imgAddress)
        {
            this->pieceX = pieceX;
            this->pieceY = pieceY;
            this->inGame = inGame;
            this->pieceColor = pieceColor;
            this->imgAddress = imgAddress;
            pieceImage = al_load_bitmap(imgAddress.c_str());
        }

        int getPieceX()
        {
            return pieceX;
        }

        int getPieceY()
        {
            return pieceY;
        }

        bool isInGame()
        {
            return inGame;
        }

        char getPieceColor()
        {
            return pieceColor;
        }

        string getImageAddress()
        {
            return imgAddress;
        }

        void setPieceX(int newx)
        {
            pieceX = newx;
        }

        void setPieceY(int newy)
        {
            pieceY = newy;
        }

        void setinGame(bool newingame)
        {
            inGame = newingame;
        }

        void setImageAddress(string newimgaddr)
        {
            imgAddress = newimgaddr;
        }

        void reloadImage()
        {
            pieceImage = al_load_bitmap(imgAddress.c_str());
        }

        Piece(void)
        {

        }

        ~Piece(void)
        {

        }

}; 
```

其他一切都将在主类 Chess.cpp 中处理

```
#include <allegro5/allegro.h>
#include <allegro5/allegro_native_dialog.h>
#include <allegro5/allegro_primitives.h>
#include <allegro5/allegro_image.h>
#include "Piece.h"
#include <iostream>
#include <string>
#include <cstring>

using namespace std;

const int SIDELENGTH = 50;
const int ROWCOLSPAN = 8;
const int WINDOW_WIDTH = (SIDELENGTH * ROWCOLSPAN) + 240;
const int WINDOW_HEIGHT = (SIDELENGTH * ROWCOLSPAN) + 40; 
const float FPS = 60;
const int MAXPIECES = ROWCOLSPAN * 2;
const int MAXSPACES = ROWCOLSPAN * ROWCOLSPAN;

setupBoard(Piece [MAXPIECES], Piece [MAXPIECES], char [MAXSPACES]);

int main()
{
    ALLEGRO_DISPLAY *gameDisplay;

    if (!al_init()) cout << "Failed to load Allegro 5 for Chess++..." << endl;

    gameDisplay = al_create_display(WINDOW_WIDTH, WINDOW_HEIGHT);
    al_set_window_title(gameDisplay, "Chess++");

    if (!gameDisplay) cout << "Couldn't create Allegro 5 display for Chess++..." << endl;

    al_init_primitives_addon(); //allows to load primitives
    al_install_keyboard(); //allows for keyboard use*/
    al_install_mouse(); //installs the mouse to be able to use it
    al_init_image_addon(); //prepares image loading

    ALLEGRO_EVENT_QUEUE *gameQueue = al_create_event_queue(); //queue that receives events and acts them in order
    al_register_event_source(gameQueue, al_get_keyboard_event_source()); //registers keyboard events to be recognized within event_queue

    ALLEGRO_KEYBOARD_STATE keyState;
    ALLEGRO_TIMER *gameTimer = al_create_timer(1.0 / FPS);

    al_register_event_source(gameQueue, al_get_keyboard_event_source()); //registers keyboard events to be recognized within event_queue
    al_register_event_source(gameQueue, al_get_timer_event_source(gameTimer)); //registers a timer to work within event_queue
    al_register_event_source(gameQueue, al_get_display_event_source(gameDisplay)); //registers the window to be able to give it events
    al_register_event_source(gameQueue, al_get_mouse_event_source()); //register the installed mouse

    bool gameOver = false;
    bool draw = false;
    bool quitclose = false;

    int X = 0;
    int Y = 0;

    Piece blackPieces[MAXPIECES];
    Piece whitePieces[MAXPIECES];

    //The 8 by 8 board with the pieces; lowercase for black, uppercase for white
    char chessboard[] = "rnbqkbnr\n"
                        "pppppppp\n" 
                        "--------\n"
                        "--------\n"
                        "--------\n"
                        "--------\n"
                        "--------\n"
                        "PPPPPPPP\n"
                        "RNBQKBNR";

    //setupBoard(blackPieces, whitePieces, chessboard);

    al_start_timer(gameTimer); //starts the specified timer

    gameloop:
    while(!gameOver)
    {
        ALLEGRO_EVENT gameEvents; //create receiver for events
        al_wait_for_event(gameQueue, &gameEvents); //waits for an event from event_queue to be passed on to ALLEGRO_EVENT events

        if (gameEvents.type == ALLEGRO_EVENT_KEY_UP/*DOWN*/)
        {

        }
        else if (gameEvents.type == ALLEGRO_EVENT_DISPLAY_CLOSE)
        {
            quitclose = true;
            gameOver = true;
        }
        else if (gameEvents.type == ALLEGRO_EVENT_MOUSE_AXES) //determines the movement of the mouse coordinates
        {

        }
        else if (gameEvents.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN) //if a mouse button is pressed
        {

        }

        if (gameEvents.type == ALLEGRO_EVENT_TIMER)
        {
            draw = true;
        }

        if (draw)
        {
            draw = false;

            int squareX = 20;
            int squareY = 20;
            bool colorchange = true;
            for (int i = 1; i <= MAXSPACES;i++)
            {               
                ALLEGRO_COLOR squarecolor = al_map_rgb(255, 255, 255);
                if (!colorchange) squarecolor = al_map_rgb(0, 100, 0);

                al_draw_filled_rectangle(squareX, squareY, squareX + SIDELENGTH, squareY + SIDELENGTH, squarecolor);
                squareX += SIDELENGTH;
                if (i % ROWCOLSPAN != 0) colorchange = !colorchange;

                if (i % ROWCOLSPAN == 0)
                {
                    squareY += SIDELENGTH;
                    squareX = 20;
                }

            }

            al_flip_display();          
            al_clear_to_color(al_map_rgb(0, 0, 0)); //clears the canvas (display) like Java's repaint()
        }

    }

    if (quitclose)
    {
        int quit = al_show_native_message_box(gameDisplay, "CHES++: QUIT", "ARE YOU SURE YOU WANNA QUIT?", "Please select YES or NO", NULL, ALLEGRO_MESSAGEBOX_YES_NO);
        if (quit == 0)
        {
            gameOver = false;
            goto gameloop;
        }
    }

    al_destroy_display(gameDisplay);

    /*cin.sync();
    cout << "\n\nPress any key to finish...";
    cin.get();*/
    return 0;
}

void setupBoard(Piece bp[MAXPIECES], Piece wp[MAXPIECES], char cb[])
{
    int barrindex = 0;
    int warrindex = 0;
    int x = 20;
    int y = 20;

    for (int i = 0; i < MAXSPACES; i++)
    {
        if (cb[i] == 'r')
        {
            bp[barrindex] = new Piece(x, y, true, 'b', "images/br.png");
            barrindex++;
            x += SIDELENGTH;
        }     
        if (cb[i] == 'n')
        {
            bp[barrindex] = new Piece(x, y, true, 'b', "images/bn.png");
            barrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'b')
        {
            bp[barrindex] = new Piece(x, y, true, 'b', "images/bb.png");
            barrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'q')
        {
            bp[barrindex] = new Piece(x, y, true, 'b', "images/bq.png");
            barrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'k')
        {
            bp[barrindex] = new Piece(x, y, true, 'b', "images/bk.png");
            barrindex++;
            x += SIDELENGTH;
        } 
        if (cb[i] == 'p')
        {
            bp[barrindex] = new Piece(x, y, true, 'b', "images/bp.png");
            barrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'R')
        {
            wp[warrindex] = new Piece(x, y, true, 'w', "images/wr.png");
            warrindex++;
            x += SIDELENGTH;
        }     
        if (cb[i] == 'N')
        {
            wp[warrindex] = new Piece(x, y, true, 'w', "images/wn.png");
            warrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'B')
        {
            wp[warrindex] = new Piece(x, y, true, 'w', "images/wb.png");
            warrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'Q')
        {
            wp[warrindex] = new Piece(x, y, true, 'w', "images/wq.png");
            warrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == 'K')
        {
            wp[warrindex] = new Piece(x, y, true, 'w', "images/wk.png");
            warrindex++;
            x += SIDELENGTH;
        } 
        if (cb[i] == 'P')
        {
            wp[warrindex] = new Piece(x, y, true, 'w', "images/wp.png");
            warrindex++;
            x += SIDELENGTH;
        }
        if (cb[i] == '-')
        {
            x += SIDELENGTH;
        } 
        if (cb[i] == '\n')
        {
            y += SIDELENGTH;
            x = 20;
        }
    }
} 
```

在添加 setupBoard() 函数和两个 Piece 对象（blackPieces 和 whitePieces）之前，我的程序会运行，它会显示一个漂亮的“棋盘”，它基本上是使用 allegro 的原始库绘制的 64 个正方形，所以我想我已经正确安装了库和驱动程序。然而，我得到的错误超出了我的能力范围：

1.  首先setupBoard是一个void，只是为了修改其他变量来组织代码。然而 Intellisense 给了我一个错误：`this declaration has no storage class or type specifier`

2.  我没有收到错误`#include "Piece.h"`，但是在声明数组 blackPieces 和 whitePieces 时，我得到了`identifier "Piece" is undefined`

3.  在 Chess.cpp 底部的 setupBoard 函数中，我读取了 char 数组 cb，它来自 chessboard，其中包含用于将棋子放置在棋盘中的特定字符。并且根据哪个字符，一个 Piece 对象被动态分配到其各自的 Piece 数组中，如下所示：

`bp[barrindex] = new Piece(x, y, true, 'b', "images/br.png");`

然后控制板的 x 和 y 的整数相应地递增以将它们绘制在不同的位置。但是，虽然除了 之外似乎没有错误`new Piece(`，我猜这是因为错误 2，但我收到了这个错误：

```
error C2679: binary '=' : no operator found which takes a right-hand operand of type 'Piece *' (or there is no acceptable conversion) 
```

我确定我一定是分配错误，但我不知道是怎么回事，我从来没有遇到过这种错误。现在，我总是可以尝试用 Java 或 C# 做一个国际象棋游戏，但我想用 C++ 制作某种游戏（我认为制作 AI 的逻辑与语言知识无关）。请，如果有人知道如何解决这些错误，我将非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T13:09:54.993

```
setupBoard(Piece [MAXPIECES], Piece [MAXPIECES], char [MAXSPACES]); 
```

你需要一个`void`在前面。

这些是不同的东西：

```
Piece bp[MAXPIECES]
Piece* bp[MAXPIECES] 
```

你拥有它的方式，你需要这样做：

```
wp[warrindex] = Piece(x, y, true, 'w', "images/wn.png"); 
```

要了解两者之间的区别，请阅读堆栈与堆内存分配。你真的很可能想通过使用堆`Piece* bp[MAXPIECES]`并保持你的`new`电话。

# c# - 如何从 SQL 数据库中检索 asp:CheckBox 值？

> ID：16156493
> 
> 赞同：0
> 
> 时间：2013-04-22T20:52:04.397
> 
> 标签：c#, asp.net, sql-server

我有一个 CheckBoxes 表，它们作为“True”和“False”插入到 SQL 数据库中。但是，我想通过加载事件再次检索这些值，但我无法获取它们。这是我的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (auditChecklist != null)
    {
        //for loading audit checklist
        getAuditChecklist();
    }

} 
```

我尝试使用以下函数检索它们，我认为它可能会这样做：

```
 private void getAuditChecklist()
{

    //int i = 0;
    SqlCommand cmd = null;
    string conn = ConfigurationManager.ConnectionStrings["PSCV1ConnectionString"].ConnectionString;
    string queryString = @"SELECT * FROM AUDIT_CHECKLIST " +
        "WHERE SITE_ID = @SiteID";

    using (SqlConnection connection =
               new SqlConnection(conn))
    {
        SqlCommand command =
            new SqlCommand(queryString, connection);
        connection.Open();
        cmd = new SqlCommand(queryString);
        cmd.Connection = connection;            

        cmd.Parameters.Add(new SqlParameter("@SiteID", //the name of the parameter to map
              System.Data.SqlDbType.NVarChar, //SqlDbType value
              20, //The width of the parameter
              "Site_ID")); //The name of the column source
        //Fill the parameter with the value retrieved
        //from the text field
        cmd.Parameters["@SiteID"].Value = foo.Site_ID;

        SqlDataReader reader = cmd.ExecuteReader();

        if (CheckBox1.Checked == true)
        {                
            while (reader.Read())
            {
            cmd.Parameters.Add(new SqlParameter("@Mount", //the name of the parameter to map
               System.Data.SqlDbType.NVarChar, //SqlDbType value
               20, //The width of the parameter
               "Mount")); //The name of the column source
            //Fill the parameter with the value retrieved
            //from the text field
            cmd.Parameters["@Mount"].Value = "True";
            }
        }
        else
        {
            cmd.Parameters.Add(new SqlParameter("@Mount", //the name of the parameter to map
               System.Data.SqlDbType.NVarChar, //SqlDbType value
               20, //The width of the parameter
               "Mount")); //The name of the column source
            //Fill the parameter with the value retrieved
            //from the text field
            cmd.Parameters["@Mount"].Value = "False";

        }
        reader.Close();
    }
} 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T05:34:28.397

如果我正确地回答了您的**问题**...问题出在您的**数据类型**中。我认为它有点领域。

```
sqlCommand.Parameters.Add(new SqlParameter("@Mount", SqlDbType.Bit));
sqlCommmand.Parameters["@Mount"].Value = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T01:10:39.130

您提到您的值被*插入为 'True' 和 'False'*，但您将 1 和 0 传递到 nvarchar 字段中。数据库字段是 nvarchar 还是位？

如果是位字段，请将参数更改为位数据类型：

```
sqlCommand.Parameters.Add(new SqlParameter("@Mount", SqlDbType.Bit));
sqlCommand.Parameters["@Mount"].Value = 1; 
```

如果它是一个 nvarchar 字段，您应该重新考虑您的架构，因为您确实应该使用位数据类型。但是，为了这个问题，你可以这样做：

```
sqlCommand.Parameters.Add(new SqlParameter("@Mount", SqlDbType.NVarChar));
sqlCommand.Parameters["@Mount"].Value = "True"; 
```

但是，您正在添加`@Mount`参数，但您`queryString`没有引用`@Mount`参数。我不确定你的意图是什么，但我想这就是你的问题所在。

我建议您从[这里](http://msdn.microsoft.com/en-us/library/haa3afyz%28v=vs.80%29.aspx)开始，开始从数据库中读取数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T14:48:53.833

> 这就是我从数据库中读取/获取复选标记值的方式：

```
 private void getAuditChecklist()
{
SqlCommand cmd = null;
string conn =    ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
string queryString = @"SELECT Mount, Braker, Access, Conn_Net, Log_Book, Pictures, Floor, Cb_Lenght, Channel FROM AUDITOR_CHECKLIST " +
    "WHERE SITE_ID = @SiteID";        

using (SqlConnection connection =
           new SqlConnection(conn))
{
    SqlCommand command =
        new SqlCommand(queryString, connection);
    connection.Open();
    cmd = new SqlCommand(queryString);
    cmd.Connection = connection;

    cmd.Parameters.Add(new SqlParameter("@SiteID", //the name of the parameter to map
          System.Data.SqlDbType.NVarChar, //SqlDbType value
          20, //The width of the parameter
          "SITE_ID")); //The name of the column source
    //Fill the parameter with the value retrieved
    //from the text field
    cmd.Parameters["@SiteID"].Value = foo.Site_ID;

    SqlDataReader reader = cmd.ExecuteReader();
while (reader.Read())
 {                    
CheckBox1.Checked = (reader.GetBoolean(reader.GetOrdinal("Mount")));
CheckBox2.Checked = (reader.GetBoolean(reader.GetOrdinal("Braker")));
CheckBox3.Checked = (reader.GetBoolean(reader.GetOrdinal("Access")));
CheckBox4.Checked = (reader.GetBoolean(reader.GetOrdinal("Conn_Net")));
CheckBox5.Checked = (reader.GetBoolean(reader.GetOrdinal("Log_Book")));
CheckBox6.Checked = (reader.GetBoolean(reader.GetOrdinal("Pictures")));
CheckBox8.Checked = (reader.GetBoolean(reader.GetOrdinal("Floor")));
CheckBox9.Checked = (reader.GetBoolean(reader.GetOrdinal("Cb_lenght")));
CheckBox10.Checked = (reader.GetBoolean(reader.GetOrdinal("Channel")));
 } 
reader.Close();
 }        
} 
```

# c++ - Visual C++ Express Brace-Completion

> ID：16156494
> 
> 赞同：0
> 
> 时间：2013-04-22T20:52:05.850
> 
> 标签：c++, visual-c++, autocomplete, express, braces

我真的很喜欢用于高效 C++ 编码的 Visual C++ Express 版本。我只是缺少自动大括号完成的功能，例如当我输入 { 并按 Enter 时，ist 应该会自动添加 }。我用谷歌搜索了很多，但只是找到了专业版或 C#-Versions 的插件。没有任何可能让这个工作吗？我真的很想知道为什么这还不是标准功能，因为它既不是实现它的行为，也不是在 C#-Edition 中的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:01:52.887

不幸的是，这在 Visual Studio C++ 编辑器中不可用。至少如果你有特快版。如您所说，使用其他版本可以下载或创建插件/扩展来获得此结果。

如中所述：[visual studio 2010 C++：大括号自动完成](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/e882f1fd-3a78-40e3-a169-2eadd9bfae3b/)

如果您决定切换到不同版本的 Visual Studio 2010，我可以推荐这个插件：[Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/)，它允许大量自定义，包括自动括号。

# php - strpos、strlen 和 substr 的问题

> ID：16156500
> 
> 赞同：0
> 
> 时间：2013-04-22T20:52:27.077
> 
> 标签：php

所以我正在尝试使用以下函数剖析我的列名

```
function disectColumnName($columnName){
    echo "fieldname: " .$columnName. "<br>";
    $periodLengths = array("min","hr","dy","wk");   # Array of periodLength Options
    $periodLength = $periodLengths[array_search($columnName, $periodLengths)];  # Find which periodLength is used in columnName and sa
    $periodDuration = substr($columnName, 0, strpos($columnName,$periodLength));
    echo 'periodLength: '.$periodLength . "<br>";
    echo 'periodDuration: '.$periodDuration . "<br>";
    $movingAverages = array("e","s");
    $movingAverageLoc = $movingAverages[array_search($columnName, $movingAverages)];
    echo "movingAverageLoc: " .$movingAverageLoc . "<br>";
    $startOfString = strpos($columnName,$periodLength)+strlen($periodLength);
    $stringLength = strpos($columnName,$movingAverageLoc)-(strpos($columnName,$periodLength)+strlen($periodLength));
    # strpos($columnName,$movingAverageLoc) returns blank, should return strpos when movingAverages = "S"
    echo "StartOf: ". $startOfString . "<br>";
    echo "StrLen: ". $stringLength . "<br>";
    $movingAverage = substr($columnName,$startOfString,$stringLength);
    echo 'movingAverage: '.$movingAverage;
} 
```

`disectColumnName`处于一个循环中，该循环通过以下列标题数组进行处理 -

```
 array(12) { [0]=> string(7) "14min3e" [1]=> string(7) "14min4e" [2]=> string(8) "14min41e" [3]=> string(7) "14min3s" [4]=> string(8) "14min41s" [5]=> string(8) "14min32s" [6]=> string(9) "14min321s" [7]=> string(9) "15min321s" [8]=> string(8) "15min41s" [9]=> string(9) "15min321e" [10]=> string(8) "15min41e" [11]=> string(8) "15min32e" } 
```

问题是以结尾的列标题`'s'`没有生成正确的`StringLength`或`movingAverageLoc`（它显示`e`而不是`S`）。但是，如果列名以 . 结尾`'e'`，它可以完美运行，什么给出？

这是当前正在输出的内容：

```
fieldname: 14min3e
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: 1
movingAverage: 3

fieldname: 14min4e
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: 1
movingAverage: 4

fieldname: 14min41e
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: 2
movingAverage: 41

fieldname: 14min3s
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: -5
movingAverage: 

fieldname: 14min41s
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: -5
movingAverage: 

fieldname: 14min32s
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: -5
movingAverage: 

fieldname: 14min321s
periodLength: min
periodDuration: 14
movingAverageLoc: e
StartOf: 5
StrLen: -5
movingAverage: 

fieldname: 15min321s
periodLength: min
periodDuration: 15
movingAverageLoc: e
StartOf: 5
StrLen: -5
movingAverage: 

fieldname: 15min41s
periodLength: min
periodDuration: 15
movingAverageLoc: e
StartOf: 5
StrLen: -5
movingAverage: 

fieldname: 15min321e
periodLength: min
periodDuration: 15
movingAverageLoc: e
StartOf: 5
StrLen: 3
movingAverage: 321

fieldname: 15min41e
periodLength: min
periodDuration: 15
movingAverageLoc: e
StartOf: 5
StrLen: 2
movingAverage: 41

fieldname: 15min32e
periodLength: min
periodDuration: 15
movingAverageLoc: e
StartOf: 5
StrLen: 2
movingAverage: 32 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:06:23.697

```
list($periodDuration, $periodLength, $movingAverage, $movingAverageLoc) =
    sscanf($columnName, '%d%[a-z]%d%[a-z]'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:17:10.843

在这一行：

```
$movingAverageLoc = $movingAverages[array_search($columnName, $movingAverages)]; 
```

这部分：

```
array_search($columnName, $movingAverages) 
```

正在搜索数组，array("e","s") 中的列名，例如“15min41e”。除非您的列名是“e”或“s”，否则它总是会返回 false。因此，对于您的所有示例数据，它基本上是这样做的：

```
$movingAverageLoc = $movingAverages[false]; 
```

这与以下内容相同：

```
$movingAverageLoc = $movingAverages[0]; 
```

这就是为什么 $movingAverageLoc 总是得到“e”的原因。你至少需要修复那条线。

但是，有很多更容易（不那么混乱）的方式来做你想做的事情。使用[preg_split](http://www.php.net/manual/en/function.preg-split.php)之一：

```
$string = "1wk2dy5hr15min431e";
$res = preg_split('~([0-9]+)([a-z]+)~i', $string, -1, PREG_SPLIT_DELIM_CAPTURE|PREG_SPLIT_NO_EMPTY);
print_r($res); 
```

结果是：

```
Array
(
    [0] => 1
    [1] => wk
    [2] => 2
    [3] => dy
    [4] => 5
    [5] => hr
    [6] => 15
    [7] => min
    [8] => 431
    [9] => e
) 
```

# python - 从 Quality Center 检索测试参数值

> ID：16156505
> 
> 赞同：0
> 
> 时间：2013-04-22T20:52:48.820
> 
> 标签：python, hp-quality-center

我一直在尝试从质量中心获取我的测试配置中设置的参数的实际值。我正在通过 python 使用 OTA API。除了默认值，我似乎什么都得不到。

我应该从哪里检索参数的值？测试、设计步骤、测试配置、测试集？如果有人能指出我正确的方向，那将有所帮助。

谢谢！杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T12:37:25.700

你可以发布你的代码。我可能会帮你。看看下面的代码。假设您知道如何设置连接：（您需要测试实验室-> 测试集通常以 Root 开头）-希望这会有所帮助

```
GetTest=test_lab_folder.TestSetFactory
TestSetFilter=GetTest.Filter
GetTSList=GetTest.NewList(TestSetFilter.Text)
for j in range (1,GetTSList.Count + 1):
    TestSet=GetTSList.Item(j)
    print TestSet.Name
    LabTests=TestSet.TSTestFactory
    LabTestSet=LabTests.NewList("")
    for k in range(1,LabTestSet.Count +1 ):
        LabTest=LabTestSet.Item(k)
        TestsetParam=LabTest.ParameterValueFactory
        ParamFilter=TestsetParam.Filter
        NewParamList=TestsetParam.NewList(ParamFilter.Text)
        for n in range (1,NewParamList.Count + 1):
            param=NewParamList.Item(n)
            print param.ActualValue 
```

# blogs - 通过typo3 中的打字稿添加一个TemplaVoila FCE

> ID：16156516
> 
> 赞同：0
> 
> 时间：2013-04-22T20:53:33.243
> 
> 标签：blogs, typo3, templavoila

我有一个带有 TemplaVoila 模板的typo3。各种页面布局，如完整，带侧边栏是 FCE。对于普通页面，这很好，但我想在我的页面中插入一个博客（typo3_blog）。

为此，我想要所有博客页面都应具有的某种布局（带侧边栏的页面）。我不能只为所有博客页面添加 FCE，因为扩展使用所有添加的 FCE 作为博客内容。

那么如何使用打字稿将 FCE 添加到页面中呢？还是有更好的方法来做到这一点？

我能想到的唯一替代方法是定义一个全新的页面模板，但我不想仅仅为此映射整个模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T11:21:41.017

通过typoscript添加FCE很简单，

此代码将获取您的 ID 为 133 的内容元素，因此它可能是您的 FCE

```
lib.tsfce = COA
lib.tsfce {
    10 = RECORDS
    10 {
        tables = tt_content
        source = 133
    }
} 
```

如果您想从任何子页面获取内容集合，请尝试此代码段

```
lib.aside_mistif = COA
lib.aside_mistif {
    1 = CONTENT
    1 {
        table = tt_content
        select {
            pidInList = 41
        }
    }
} 
```

或者您可以使用此扩展程序[http://typo3.org/extensions/repository/view/kb_tv_cont_slide](http://typo3.org/extensions/repository/view/kb_tv_cont_slide) 从父页面滑到一边

# jira - Confluence 配置问题中的 Jira Gadget

> ID：16156518
> 
> 赞同：0
> 
> 时间：2013-04-22T20:53:50.340
> 
> 标签：jira, confluence

我有一个我写的 Jira 小工具，我想在 Confluence 中使用它。我有 Jira 和 Confluence 在我的机器上本地运行。我已将我的小工具安装到我的 jira 实例中，并且我将两个实例都以完全信任的方式链接为应用程序链接。我已经在管理员的外部小工具部分安装了我的小工具。然后我创建了一个简单的页面并通过选择宏添加了我的小工具。当我单击我的小工具时，我的配置屏幕显示出现问题。它似乎缺少我的 i18n 资源，因为我看到这个标签是 gadget.common.project.label。此外，iframe 并未扩展为包含我的所有配置。

这是我的小工具在融合中的样子：

![在此处输入图像描述](https://i.stack.imgur.com/pZw8w.png)

这是我的小工具 gadget.xml 的头部：

```
<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="__MSG_gadget.title__" 
             directory_title="__MSG_gadget.title__"
             description="__MSG_gadget.description__"
             author="__MSG_gadget.author__"
             thumbnail='#staticResourceUrl("TechnicalDebtTracker:TechnicalDebtTracker-resources", "thumbnail.png")'>
    <Optional feature="gadget-directory">
        <Param name="categories">
            . JIRA
        </Param>
    </Optional>
    <Optional feature="atlassian.util"/>
    <Optional feature="auth-refresh"/>
    <Require feature="setprefs" />
    <Require feature="dynamic-height"/>
    <Require feature="settitle"/>
    <Require feature="views"/>
    <Require feature="oauthpopup"/>
    #oauth
    #supportedLocales("gadget.common,gadget.user.activity")
    <Locale messages="__ATLASSIAN_BASE_URL__/download/resources/TechnicalDebtTracker/i18n/ALL_ALL.xml"/>
</ModulePrefs>
<UserPref name="isConfigured" datatype="hidden" default_value="false" />
<UserPref name="project" datatype="hidden" required="true" />
<UserPref name="methodology_type" datatype="hidden" required="true" default_value="scrum" />
<UserPref name="warning_threshold" datatype="hidden" required="true" default_value="10" />
<UserPref name="critical_threshold" datatype="hidden" required="true" default_value="20" />
<UserPref name="paid_down_period" datatype="hidden" required="true" default_value="90" />
<UserPref name="normal_color" datatype="hidden" required="true" default_value="#61F553" />
<UserPref name="warning_color" datatype="hidden" required="true" default_value="#FFFA66" />
<UserPref name="critical_color" datatype="hidden" required="true" default_value="#FF7A66" />
<UserPref name="refresh" datatype="hidden" default_value="false" />
<Content type="html">
    <![CDATA[
        #requireResource("com.atlassian.gadgets.publisher:ajs-gadgets")
        #requireResource("com.atlassian.jira.gadgets:g-filter-results")
        #requireResource("TechnicalDebtTracker:TechnicalDebtTracker-resources")
        #includeResources()

(function () 
        {       
        var gadget = AJS.Gadget({
            baseUrl: "__ATLASSIAN_BASE_URL__",
            useOauth: "/rest/gadget/1.0/currentUser",
            config: {
                descriptor: function(args) {
                    var gadget = this;

                    var projectPicker = AJS.gadget.fields.projectPicker(gadget, "project", args.projectOptions);
                    return {
                        fields: [
                            projectPicker,
                            {
                                id: "methodology_type-id",
                                userpref: "methodology_type",
                                label: "__MSG_gadget.config.SetMethodology__",
                                description: "",
                                type: "select",
                                selected: gadget.getPref("methodology_type"),
                                options: [
                                            {
                                                label:"Scrum",
                                                value:"scrum"
                                            },
                                            {
                                                label:"Kanban",
                                                value:"kanban"
                                            }
                                         ]
                            },
                            {
                                id: "warning_threshold-id",
                                userpref: "warning_threshold",
                                label: "__MSG_gadget.config.SetWarning__",
                                description: "__MSG_gadget.config.InStoryPoints__",
                                type: "text",
                                value: gadget.getPref("warning_threshold")
                            },
                            {
                                id: "critical_threshold-id",
                                userpref: "critical_threshold",
                                label: "__MSG_gadget.config.SetCritical__",
                                description: "__MSG_gadget.config.InStoryPoints__",
                                type: "text",
                                value: gadget.getPref("critical_threshold")
                            },
                            {
                                id: "paid_down_period-id",
                                userpref: "paid_down_period",
                                label: "__MSG_gadget.config.SetPaidDownPeriod__",
                                description: "__MSG_gadget.config.InDays__",
                                type: "text",
                                value: gadget.getPref("paid_down_period")
                            },
                            {
                                id: "normal_color-id",
                                userpref: "normal_color",
                                label: "__MSG_gadget.config.SetNormalColor__",
                                description: "__MSG_gadget.config.HexCode__",
                                type: "text",
                                value: gadget.getPref("normal_color")
                            },
                            {
                                id: "warning_color-id",
                                userpref: "warning_color",
                                label: "__MSG_gadget.config.SetWarningColor__",
                                description: "__MSG_gadget.config.HexCode__",
                                type: "text",
                                value: gadget.getPref("warning_color")
                            },
                            {
                                id: "critical_color-id",
                                userpref: "critical_color",
                                label: "__MSG_gadget.config.SetCriticalColor__",
                                description: "__MSG_gadget.config.HexCode__",
                                type: "text",
                                value: gadget.getPref("critical_color")
                            },
                            AJS.gadget.fields.nowConfigured()
                        ]
                    };
                },
                args: function()
                {
                    return [
                        {
                            key: "projectOptions",
                            ajaxOptions:  "/rest/gadget/1.0/filtersAndProjects?showFilters=false"
                        },
                    ];
                }()
            }, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-07T15:23:39.663

看看我的“projectPicker”。我认为这可能会有所帮助：

```
AJS.$.extend(true, {}, AJS.gadget.fields.projectPicker(gadget, "project", args.projectOptions),
    {description: "select a project", 
     label: "Project"}
) 
```

在那里你可以像这样添加你的消息：

```
AJS.$.extend(true, {}, AJS.gadget.fields.projectPicker(gadget, "project", args.projectOptions),
    {description: "__MSG_gadget.common.project.label__", 
     label: "__MSG_gadget.common.project.description__"}
) 
```

# c# - C# Dynamic SQL INSERT ... SELECT

> ID：16156519
> 
> 赞同：4
> 
> 时间：2013-04-22T20:53:51.010
> 
> 标签：c#, mysql, sql

I am using the INSERT ... SELECT syntax to select existing rows from a table and insert then into another table. In addition to the existing data from each row I also need to add a BillingID and TimeStamp. Because these fields are in the SELECT part of the SQL statement I cannot parametrize them. I solved the TimeStamp issue using the SQL function NOW(), however I am still left with BillingID which I have added to the query via sting concatenation as follows:

```
static void UpdateMonthlyData(int BillingID, DateTime HistoryDate, int CompanyID)
{   
        String conString = ConfigurationManager.ConnectionStrings["xxx"].ConnectionString;
        MySqlConnection connection = new MySqlConnection(conString);

        String command = "INSERT INTO MonthlyData SELECT " + BillingID + ", d.*, NOW() "  
                       + "FROM CurrentData d WHERE d.CompanyID = @CompanyID AND d.HistoryDate = @HistoryDate";

        MySqlCommand cmd = new MySqlCommand(command, connection);
        cmd.Parameters.Add(new MySqlParameter("@CompanyID", CompanyID));
        cmd.Parameters.Add(new MySqlParameter("@HistoryDate", HistoryDate));

        cmd.CommandType = CommandType.Text;

        cmd.Connection.Open();
        cmd.ExecuteNonQuery();
        cmd.Connection.Close();                          
} 
```

I am not concerned with SQL Injection as this is a console app that is run on an automated schedule and has no user interaction whatsoever. (BillingID is auto-generated). Despite that, I don't like using concatenated strings as they are not very readable. Is there a more elegant way of doing this?

Edit:

To sum things up, I thought that since since you cant do this:

```
SELECT @field FROM @table 
```

I presumed that parameters are not allowed in the SELECT part of a SQL statement. However since I am specifying a value in the select statement rather than selecting a column, as @cdhowie pointed out I can use a parameter there. In essence my query translated is something like this:

```
SELECT 25 FROM table_name, not  SELECT field FROM table_name 
```

So now thanks to @cdhowie I understand that a parameter can be anywhere a literal value can be

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:56:22.673

A query parameter is valid anywhere that a literal value would be, assuming that the query parameter is of the correct type (e.g. `... LIMIT @Foo` should work as long as you bind an integer -- or something the SQL server can successfully convert to an integer -- to the Foo parameter). This assumes no particular quirks in the SQL dialect you are using, of course.

In other words, there is no reason that you shouldn't be able to pass `BillingID` using a query parameter.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:00:01.057

You could use String.Format for any **safe** fields that cannot be added via parameterization:

```
String command = String.Format("INSERT INTO MonthlyData SELECT {0}, d.*, NOW() FROM CurrentData d WHERE d.CompanyID = @CompanyID AND d.HistoryDate = @HistoryDate", BillingID); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-22T21:00:03.143

You can use .Net [string.format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)

Example :

```
 string query = string.format{"insert into MonthlyData select {0} from CurrentData",
                                  BillingId); 
```

You can parameterize your query a lot more with cleaner code.

Good luck

# sql - 存储过程中的多重错误处理

> ID：16156520
> 
> 赞同：3
> 
> 时间：2013-04-22T20:53:52.573
> 
> 标签：sql, sql-server, tsql

我想知道是否有人能指出我正确的方向。这是我第一次尝试在 SQL 中进行任何类型的错误处理，我担心我要么完全遗漏了某些东西，要么误解了错误处理的概念。

我有一个程序，它基本上接受 3 个值，然后尝试查看其中一个值是否存在。如果是，则执行更新语句。

本质上，我想做以下事情： - 如果没有遇到错误，则返回“1” - 如果 Select 语句未能找到记录，则返回错误 - 如果 Update 语句未能更新任何记录，则返回错误

下面是我的程序。目前，每当我运行它时，它都会返回一个“1”，这表明没有错误，这不是我期望它工作的方式，因为我正在传递虚假值并试图破坏它。有人可以帮助指出我做错了什么，或者这是否可能？

```
alter PROCEDURE [dbo].prc_update_SPRO_refill_status                             
@result_code char(2),                             
@result_string char(10),                                                      
@rx_id char(20)        

AS                            
BEGIN                            

SET NOCOUNT ON; 
BEGIN TRANSACTION                                
BEGIN TRY   

DECLARE @prescription_orders_id varchar(20)
DECLARE @ErrorVar INT;
DECLARE @RowCountVar INT;

IF @result_code = 0
BEGIN
SELECT @prescription_orders_id = prescription_orders_id
FROM prescription_orders
WHERE rx_external_id = @rx_id
       -- Return error if record not found

UPDATE prescription_orders_fills
SET fill_status_code = 'R'
WHERE prescription_orders_id = @prescription_orders_id
    AND fill_status_code = 'P'
    AND fill_number > 1 
      -- return error if record not found
      -- return error if more then 1 record update

END                                               
END TRY
BEGIN CATCH
SELECT
    ERROR_NUMBER() AS ErrorNumber
    ,ERROR_SEVERITY() AS ErrorSeverity
    ,ERROR_STATE() AS ErrorState
    ,ERROR_PROCEDURE() AS ErrorProcedure
    ,ERROR_LINE() AS ErrorLine
    ,ERROR_MESSAGE() AS ErrorMessage;
IF @@TRANCOUNT > 0
    ROLLBACK TRANSACTION;
END CATCH;
IF @@TRANCOUNT > 0
BEGIN
COMMIT TRANSACTION
 SELECT 1 as ERROR_NUMBER   
END                                                       
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:14:59.710

我认为这里的问题很简单：当没有引发异常时，您期望`TRY`失败并撞到块中。`CATCH`想一想：以下查询是否仅仅因为没有更新行而引发错误？

```
CREATE TABLE #foo(a INT);

UPDATE #foo SET a = 1 WHERE a = 2; 
```

这里没有错误信息，所以没有理由`CATCH`被触发。如果你想测试你的错误处理，把一个*真正的*错误条件放在那里。例如：

```
BEGIN TRY
  IF @force_error = 1
  BEGIN
    SELECT 1/0;
  END
END TRY
BEGIN CATCH
  -- now you should get here...
END CATCH 
```

同样正如我在评论中提到的 - 用于`RETURN`将错误号/状态代码发送回调用者。没有理由调用记录集返回单个标量值所需的所有脚手架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:26:59.853

我的 2 美分

```
alter PROCEDURE [dbo].prc_update_SPRO_refill_status                             
@result_code char(2),                             
@result_string char(10),                                                      
@rx_id char(20)        

AS                            
BEGIN                            

SET NOCOUNT ON; 
```

> [设置 XACT_ABORT 开](http://msdn.microsoft.com/en-us/library/ms188792.aspx)；**// 1 , 最好在尝试之前实现这个**

```
BEGIN TRY   
BEGIN TRANSACTION  ; **// 2 start transaction after try**

DECLARE @prescription_orders_id varchar(20)
DECLARE @ErrorVar INT;
DECLARE @RowCountVar INT;

IF @result_code = 0
    BEGIN
        ...
        ...
        ...
        ...  
    END                          

END TRY
BEGIN CATCH
    SELECT
        ERROR_NUMBER() AS ErrorNumber
        ,ERROR_SEVERITY() AS ErrorSeverity
        ,ERROR_STATE() AS ErrorState
        ,ERROR_PROCEDURE() AS ErrorProcedure
        ,ERROR_LINE() AS ErrorLine
        ,ERROR_MESSAGE() AS ErrorMessage;
    IF @@TRANCOUNT > 0
        ROLLBACK TRANSACTION;
END CATCH;

   IF @@TRANCOUNT > 0
    BEGIN
        COMMIT TRANSACTION;
        SELECT 1 as ERROR_NUMBER  ;
    END 

END 
```

# android - ScrollView 不显示内容

> ID：16156525
> 
> 赞同：3
> 
> 时间：2013-04-22T20:54:05.170
> 
> 标签：android, android-layout, textview, scrollview

有人可以解释一下为什么滚动视图不显示他的子元素吗？我在线性布局垂直中有很多文本视图，线性布局在滚动视图内......

但我没有看到任何滚动视图，文本视图也没有..

这是 XML 布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/description"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/scrollViewCheck"
        android:gravity="center"
        android:padding="10dip"
        android:text="Pick which items you want to count"
        android:textAppearance="?android:attr/textAppearanceMedium" >
    </TextView>

    <ScrollView
        android:id="@id/scrollViewCheck"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/bottomSettings"
        android:scrollbarFadeDuration="0" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:orientation="vertical" >

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:text="Test"
                android:textAppearance="?android:attr/textAppearanceMedium" />
        </LinearLayout>
    </ScrollView>

    <RelativeLayout
        android:id="@id/bottomSettings"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/timeButton"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Choose Count Time" />

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_below="@id/timeButton"
            android:orientation="horizontal" >

            <Button
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Back" />

            <Button
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Start" />
        </LinearLayout>
    </RelativeLayout>

</RelativeLayout> 
```

提前致谢 ;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:15:55.613

视图的问题与底部的 RelativeLayout 有关。这应该可以解决您的问题。将底部的 RelativeLayout 替换为：

```
 <LinearLayout
        android:id="@+id/bottomSettings"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:layout_alignParentBottom="true">

    <Button
            android:id="@+id/timeButton"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Choose Count Time" />

    <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_below="@id/timeButton"
            android:orientation="horizontal" >

        <Button
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Back" />

        <Button
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Start" />

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:20:41.263

您正在使用 a`RelativeLayout`作为根布局并且缺少布局说明，例如`android:layout_below`or `android:layout_above`。

这就是为什么元素相互重叠而你看不到你的`ScrollView`.

将您的根布局更改为`LinearLayout`具有属性的 a `android:orientation="vertical"`，您将看到所有小部件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:10:51.333

我认为您不能将`ScrollView`高度定义为“wrap_content”。由于内容远远大于屏幕上的大小。通常您需要将 a 的高度定义`ScrollView`为某个固定值。如果您希望 ScrollView 尽可能多地占据屏幕，同时仍然具有页眉和页脚视图，您可以尝试以下操作：

```
 android:layout_height="1dp"
   android:layout_weight="1" 
```

这基本上会将屏幕上的所有剩余空间分配给`ScrollView`. 我这里没有一台机器来测试这个，但是试一试，让我知道它是如何工作的。

# jquery - jquery yql值不显示

> ID：16156533
> 
> 赞同：0
> 
> 时间：2013-04-22T20:54:36.567
> 
> 标签：jquery, function, variables, yql

我正在尝试获取平均租金。我的 yql 代码有效并提供了正确的值，但我试图将其显示在平均租金旁边：但它不起作用。我想也许我获取租金价格的功能放错了地方，或者我错误地处理了变量，但我不知道如何找出来。

```
 <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></    script>
    <script type="text/javascript">
        function evaluateHome() {
            document.getElementById('loading').style.display = 'inline-block';

            var postcode = $('#postcode').val();
            var address = $('#address').val();

            $.get(makeUrl('http://www.realtor.com/propertyrecord-search/' + postcode),
                    function(data) {
                        var context = $('<div />').html($(data).find('content').text());

                        $('#avgDays').html($(context).find('table.summaryTable strong:eq(3)').text());
                         $('#avgList').html($(context).find('table.summaryTable strong:eq(4)').text()
                        + ' - ' + $(context).find('table.summaryTable strong:eq(1)').text());

                    });

       function makeUrl(url) {
            return 'http://query.yahooapis.com/v1/public/yql?q=' +
                    encodeURIComponent('select content from data.headers where url="' + url)
                    + '"&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys'
        }

    </script>

</head>
<body>

    <div>
        <table>
            <tr>
                <td><strong>Please enter postcode: </strong></td>
                <td><input id="postcode" type="text"/></td>
            </tr>
            <tr>
                <td><strong>Please enter address: </strong></td>
                <td><input id="address" type="text"/></td>
            </tr>
          <script>
function handleResponse (json) {
var ul = document.getElementsByTagName( 'ul' )[0],
    avgRent = null;
for ( var i = 0; i < json.query.count; i++ ) {
    avgRent = document.createElement('avgRent');
    avgRent.innerHTML = json.results[i];
     ul.appendChild(avgRent);
}
}
</script>
<script src="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fwww.zillow.com%2Fwidgets%2Fzestimate%2FZestimateSmallWidget.htm%3Fdid%3Dzillow-shv-small-iframe-widget%26type%3Diframe%26forRent%3Dtrue%26address%3D'+ address.replace(/\ /g, '%2B') +'%2B'+postcode+'%22%20and%20xpath%3D'%2F%2Fdiv%5B%40id%3D%22zestimate-rate-container%22%5D%2Fspan%5B2%5D'&callback=handleResponse"></script>  
            <tr>
                <td colspan="2" style="text-align: center;">
                    <button onclick="evaluateHome()">Evaluate!</button>
                    <img id="loading" src="http://www.laneaviation.com/wp-content/themes/laneaviation/images/loading.gif" height="15"/>
                </td>
            </tr>
        </table>
    </div>
    <div>
        <table>
            <tr>
                <td><strong>Avg Marketing Days: </strong></td>
                <td><div id="avgDays"></div></td>
            </tr>
            <tr>
                <td><strong>Estimated Value: </strong></td>
                <td><div id="estimatedVal"></div></td>                    
            </tr>
            <tr>
                <td><strong>Average List: </strong></td>
                <td><div id="avgList"></div></td>                    
            </tr>

            <tr>
                <td><strong>Bedrooms: </strong></td>
                <td><div id="bedrooms"></div></td>                    
            </tr>
            <tr>
                <td><strong>Baths: </strong></td>
                <td><div id="baths"></div></td>                    
            </tr>
            <tr>
                <td><strong>Home Sq Ft: </strong></td>
                <td><div id="homeSize"></div></td>                    
            </tr>
            <tr>
                <td><strong>Lot Sq Ft: </strong></td>
                <td><div id="lotSize"></div></td>                    
            </tr>
            <tr>
                <td><strong>Year Built: </strong></td>
                <td><div id="builtYear"></div></td>                    
            </tr>
            <tr>
                <td><strong>Last Sold Date: </strong></td>
                <td><div id="soldDate"></div></td>                    
            </tr>
            <tr>
                <td><strong>Last Sold Amount: </strong></td>
                <td><div id="soldAmount"></div></td>                    
            </tr>
            <tr>
                <td><strong>Tax Assessed Value: </strong></td>
                <td><div id="taxVal"></div></td>                    
            </tr>
            <tr>
    <td><strong>Average Monthly Rent: </strong></td>
                <td><div id='ul.appendChild(avgRent)'></div></td>
            </tr>
    <tr>
    <td><strong>Better to Sell/Buy or Rent?: </strong></td>
                <td><div id="decision"></div></td>                    
            </tr>
    <tr>
    <td><strong>Add 1 bedroom: </strong></td>
                <td><div id="improveBed"></div></td>                    
            </tr>
    <tr>
    <td><strong>Add 1 bath: </strong></td>
                <td><div id="improveBath"></div></td>                    
            </tr>

        </table>
    </div>
    <script type="text/javascript">
        document.getElementById('loading').style.display = 'none';
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:56:50.887

该`evaluateHome()`函数似乎没有结束大括号 ( `}`) 字符。而且，不要忘记在某处调用该函数。

![在此处输入图像描述](https://i.stack.imgur.com/UTdJw.png)

# java - 如何制作棋盘格？

> ID：16156534
> 
> 赞同：-1
> 
> 时间：2013-04-22T20:54:48.733
> 
> 标签：java, arrays, for-loop, int

如何制作棋盘格？

0代表白色，1代表黑色

我一开始把它们都设为 0，然后尝试添加 1，但它给了我

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 8
    at unit1.Lesson35CheckerboardTask.main(Lesson35CheckerboardTask.java:33)

                public static void main(String[] args){ 

    int a[][] = new int [8][8];

    for (int test = 0; test < a.length; test++)
    {
        int row = 0;
        int col = 0;
    for (int col1 =0; col1 < 8;col1++)
    {
        a[row][col] = 1;
        col = col + 2;

    }
    row = row + 1;
    col = (col - 6);

    }

                //(this prints it out)      

    for (int row = 0; row < a.length; row++)
    {
        for(int col = 0; col <a[row].length; col++)
        {
            System.out.print(a[row][col] + "\t");
        }
        System.out.println("");
    }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:00:57.367

例外是因为您在内部循环中，尝试执行

```
 col = col + 2; 
```

8 次，导致您越界访问数组。

为避免这种情况，您可以使用模运算符`%`来大大简化循环：

```
int[][] a = new int[8][8];
for (int row = 0; row < a.length; row++) {
    for (int col = 0; col < 8; col++) {
        a[row][col] = (row + col) % 2;
    }
} 
```

这将在整个板上很好地在`0`s 和s之间交替。`1`

# perl - 根据 perl 中的存在性从字符串中删除子字符串

> ID：16156538
> 
> 赞同：-2
> 
> 时间：2013-04-22T20:55:03.440
> 
> 标签：perl, grep, substring

我有一个数组——`@values`包含这样的元素。

```
abcd
ijk.*
alba
^defg
xyz.domain.example.com 
```

我正在对数组进行这样的检查：

```
foreach $val(@values)
{
    if(!`grep $val /tmp/list` && (!grep /$val/,@anotherlist )
    {
        #Perform an action;
    }
} 
```

我的`/tmp/list`和`@anotherlist`可能/可能不包含类似`xyz`或正则表达式值但不包含`xyz.domain.example.com`. 这`domain`是可变长度的。

那么，`.domain.example.com`如果我在字符串中找到它，你能建议一种方法来删除它吗？我还在一个名为`@domain`.

我希望在我当前的 if 语句中使用操作解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:32:46.593

循环中的索引变量`for/foreach`是数组元素的别名。如果您对索引变量进行更改，那么您也在对数组元素进行更改。

```
#Perform an action;
$val =~ s/\.domain\.example\.com//; 
```

# magento - Magento 1.7 - 如何从订单视图页面链接到产品的管理员编辑页面？

> ID：16156542
> 
> 赞同：9
> 
> 时间：2013-04-22T20:55:29.307
> 
> 标签：magento, magento-1.7

在查看订单时，我的员工希望能够单击产品名称或 SKU，并将其作为指向该产品产品信息编辑页面的链接。

我想出了如何将产品名称更改为链接，该链接是前端产品页面的 url，但我不希望链接转到前端，我需要它链接到产品编辑管理仪表板中的页面。

这是我使用的代码：

app/design/adminhtml/default/default/template/sales/order/view/items/renderer/ **default.phtml**

```
<div class="item-text">
<?php $_pullProduct = Mage::getModel('catalog/product')->loadByAttribute('sku', $_item->getData('sku')); ?>
<a target="_blank" rel="external" href="<?php echo Mage::getUrl() . $_pullProduct->getData('url_path'); ?>"><?php echo $this->getColumnHtml($_item, 'name') ?></a>
</div> 
```

...这将我正确链接到产品前端页面。现在，正如我所说，这不是我想要的，那么我如何让它成为产品管理仪表板编辑页面的链接？

我尝试将同一文件中的上述代码更改为：

```
<div class="item-text">
<?php $_pullProduct = Mage::getModel('catalog/product')->loadByAttribute('sku', $_item->getData('sku')); ?>
<a target="_blank" rel="external" href="<?php echo Mage::getSingleton('adminhtml/url')->getUrl('adminhtml/catalog_product/edit', array('id' => $this->getProduct()->getId()))?>"><?php echo $this->getColumnHtml($_item, 'name') ?></a>
</div> 
```

...但是这是不对的，当我尝试这个时，订单视图页面会中断。我觉得我快要接近了，请你们帮助我朝着正确的方向前进吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-06T20:51:58.490

好的，所以下面的代码，在 app/design/adminhtml/default/default/template/sales/order/view/items/renderer/ **default.phtml中使用**

完美运行！[这个答案是Marius](https://magento.stackexchange.com/users/146/marius)在 Magento Stack Exchange 网站上给我的。谢谢马吕斯！

```
<div class="item-text">
<?php $_pullProduct = Mage::getModel('catalog/product')->loadByAttribute('sku', $_item->getData('sku')); ?>
<a target="_blank" rel="external" href="<?php echo Mage::helper('adminhtml')->getUrl('adminhtml/catalog_product/edit', array('id' => $_pullProduct->getId()))?>"><?php echo $this->getColumnHtml($_item, 'name') ?></a>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T00:56:26.907

我不确定这是否有帮助，但希望这将使您走上正确的道路。关于 Mage 1.7.0.2 中的管理链接，我遇到了类似的问题

如果用户尝试通过观察者功能编辑已标记为不是他的产品（我使用属性来存储产品的管理员用户），我试图将用户重定向到目录产品列表页面。

我使用了以下代码：

```
Mage::app()->getResponse()->setRedirect(Mage::getUrl('adminhtml/catalog_product/index'))->sendResponse(); 
```

有用。以前所有重定向都只会指向前端。您需要弄清楚如何将此代码放入 .phtml 文件中。我的建议是扩展此模板的核心块。

# c++ - 我如何将 std::cin.getline() 与字符串一起使用

> ID：16156545
> 
> 赞同：2
> 
> 时间：2013-04-22T20:55:39.753
> 
> 标签：c++, string

我对 C++ 中的字符串有疑问

我想从用户 22 字符中读取并将它们存储在字符串中

我试过了：

```
std::string name;
std::cin.getline(name,23); 
```

它显示一个错误。

将 cin.getline 与字符串一起使用的解决方案是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T20:57:02.233

你使用[`std::getline(std::istream&, std::string&)`](http://en.cppreference.com/w/cpp/string/basic_string/getline)from`<string>`代替。

如果您想将内容限制为 22 个字符，您可以`std::string`像将其传递给任何 C 样式 API 一样使用：

```
std::string example;
example.resize(22); // Ensure the string has 22 slots
stream.getline(&example[0], 22); // Pass a pointer to the string's first char
example.resize(stream.gcount()); // Shrink the string to the actual read size. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:04:02.800

有两种不同的`getline`功能。一个是istream类的成员，大致是这样的：

```
std::istream &std::istream::getline(char *buffer, size_t buffer_size); 
```

另一个是自由函数，如下所示：

```
std::istream &std::getline(std::istream &, std::string &); 
```

你试图打电话给前者，但真的想要后者。

虽然我不相信前者被正式弃用，但我怀疑大多数真正跟上他们的“游戏”的 C++ 程序员会考虑这种方式——为了向后兼容性，它可能无法删除，但机会相当大你永远不应该使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:06:25.737

此代码读取 22 个字符并将它们放入一个字符串中。

```
char buf[22];
cin.read(buf, 22);
string str(buf, 22); 
```

如果这确实是您想要的，那么这就是代码。

# php - 编辑 php.ini 文件以解决不需要的异常

> ID：16156548
> 
> 赞同：0
> 
> 时间：2013-04-22T20:55:58.160
> 
> 标签：php, pdo

我正在将我的网站转移到另一台服务器上，并在尝试加载主索引文件时遇到此错误：

```
Fatal error: Uncaught exception 'PDOException' with message 'could not find driver' in /htdocs/www/demoportal/login.php:8 Stack trace: #0 /htdocs/www/demoportal/login.php(8): PDO->__construct('mysql:host=db2....', '???', '???') #1 /htdocs/www/demoportal/index.php(3): require('/htdocs/www/dem...') #2 {main} thrown in /htdocs/www/demoportal/login.php on line 8 
```

显然给出错误的行如下：

```
$db = new PDO("mysql:host=" . $host . ";dbname=" . $database, $user, $password); 
```

我系统上的 PHP 版本是 PHP Version 5.3.19-1~dotdeb.0。

![在此处输入图像描述](https://i.stack.imgur.com/pODeM.png)

我不确定我需要在 php.ini 文件中查找什么来修改或编辑。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:58:12.123

You don't have the MySQL PDO drivers installed/loaded.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:00:53.463

> 我需要在 php.ini 文件中查找什么

```
extension=php_pdo_mysql.so (or .dll) 
```

# xml - Camel 中的 REST API - POST 不起作用（XML 解析错误）

> ID：16156550
> 
> 赞同：0
> 
> 时间：2013-04-22T20:56:00.037
> 
> 标签：xml, cxf, apache-camel, cxfrs

我正在尝试创建一个示例 Camel 路由，作为基于简单资源类构建的 RESTful API 的种子，提供 XML 有效负载。

我遇到的问题是我的 GET 正在工作（它所做的只是构建一段 XML）但我的 POST 返回以下错误：-

```
JAXBException occurred : ParseError at [row,col]:[1,1]
Message: Premature end of file.. ParseError at [row,col]:[1,1]
Message: Premature end of file.. 
```

我正在使用通过 xjc 从 XSD 构建的类来定义 XML。我知道这不是 XML 有效负载结构的问题，因为当我将 GET 返回的 XML 复制到 POST 时它甚至会失败！尽管如此，鉴于 JAXB 抱怨第一个字符，我想知道它是否抱怨编码。我使用 cURL 和 Chrome Postman 作为客户端，都收到相同的响应。

我想我只是缺少一个简单的注释或设置，它使 POST 方法 ( `newCustomer`) 能够解析传入的 XML 有效负载。

这是我的路线 XML：-

```
<?xml version="1.0" encoding="UTF-8"?>
<blueprint
    xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jaxrs="http://cxf.apache.org/blueprint/jaxrs"
    xmlns:cxf="http://cxf.apache.org/blueprint/core"
    xmlns:camel="http://camel.apache.org/schema/blueprint"
    xsi:schemaLocation="
http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
http://cxf.apache.org/blueprint/jaxrs http://cxf.apache.org/schemas/blueprint/jaxrs.xsd
http://cxf.apache.org/blueprint/core http://cxf.apache.org/schemas/blueprint/core.xsd
http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd
">

    <camelContext id="goochjs-cameltest-customer" trace="false" xmlns="http://camel.apache.org/schema/blueprint">

        <route id="jetty">
            <from uri="jetty:http://0.0.0.0:8892/rest?matchOnUriPrefix=true" />
            <log logName="goochjs" loggingLevel="INFO" message="Request received 1: ${body}" />
            <to uri="cxfbean:customerResource" />
        </route>
    </camelContext>

    <bean id="customerResource" class="org.goochjs.cameltest.CustomerResourceImpl" />
</blueprint> 
```

...和我的资源类...

```
package org.goochjs.cameltest;

import javax.ws.rs.Consumes;
import javax.ws.rs.DefaultValue;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.QueryParam;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

@Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })
@Consumes({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })
@Path("/customers")
public class CustomerResourceImpl {

    @POST
    @Path("/{type}")
    public Response newCustomer(Customer customer, @PathParam("type") String type, @QueryParam("active") @DefaultValue("true") boolean active) {
        return Response.ok(type).build();
    }

    @GET
    @Path("/{type}")
    public Response getCustomer(@PathParam("type") String type) {
        Customer output = new Customer();
        output.setId(987654);
        output.setName("Willy Wonka");

        return Response.ok(output).build();
    }
} 
```

最后，这是我的示例 XML：-

```
<?xml version="1.0" encoding="UTF-8"?>
<Customer>
    <name>Willy Wonka</name>
    <id>987654</id>
</Customer> 
```

感谢您的任何指示。如果更容易查看，整个项目都打包在[我的 github 站点上](https://github.com/goochjs/camel-test)。

J。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:40:44.450

经过几个小时的挠头，我已经解决了这个问题。问题是没有消息体被呈现给资源类。在我添加`streamCache="true"`到 Camel XML 中的路由节点后，它开始工作。

这是 Camel 网站上的相关页面 - [http://camel.apache.org/stream-caching.html](http://camel.apache.org/stream-caching.html)。

我认为[使用`cxfrs://`](http://camel.apache.org/cxfrs.html)作为*来自*端点的模式隐含地做到了这一点。但是，我无法让它在 Blueprint XML 中工作，这就是我预先部署 Jetty 的原因。

J。

# django - 用户上的 OneToOne 字段导致一些 ID 问题

> ID：16156551
> 
> 赞同：0
> 
> 时间：2013-04-22T20:56:00.903
> 
> 标签：django, django-south

我在使用 django-registration 和信号时遇到了一些问题。基本设置是我有一个 django 1.4.3 设置，带有 django-south 和 django-registration（数据库是 SQLite 的价值）。

*编辑：我稍微改变了这个问题，因为shell中的效果是一样的，所以注册不是原因（编辑是斜体）。*

我有一个与 User 模型相关的模型，其方式如下：

```
class MyUserProfile(models.Model):
    user = models.OneToOneFiled(User)
    #additional fields 
```

我使用南初始化基地。当我稍微`sqlall`检查一下应该在里面的sql时，我可以清楚地看到：

```
CREATE TABLE "myApp_myuserprofile" (
    "id" integer NOT NULL PRIMARY KEY
    "user_id" integer NOT NULL UNIQUE REFERENCES "auth_user" ("id"),
    #other fields
) 
```

之后，如果用户激活其帐户，我想初始化数据。所以在models.py中我把

```
from django.dispatch import receiver
from registration.signals import user_activated
#Models....
@receiver(user_activated)
def createMyProfile(sender, **kwargs):
    currentUser = kwargs['user']
    profile = Profile(user = currentUser, #other fields default value)
    profile.save()
    #And now the reverse relation:
    currentUser.myuserprofile = profile
    currentUser.save() 
```

当我在那里时，一切似乎都很好，如果我打印 ids（用于用户和个人资料），并且如果我在 2 之间来回移动，我会看到一些似乎正确的东西。

*如果我禁用这部分代码并使用 shell 进行相同类型的初始化，我会得到相同的结果。*

但在那之后，一切都错了。如果我打开一个shell并导入相关事项，我对每个X值都有以下内容

```
MyUserProfile.objects.get(pk=X) 
#DoesNotExist Exception
User.objects.get(pk=X).myuserprofile.pk
1
MyUserProfile.objects.all()[X].pk
1 
```

好像有点奇怪不是吗？

现在如果我去 sql shell

```
select id from myApp_myuserprofile;
1
1
1
1
... 
```

所以我有一个主列，到处都是相同的值。这很好......至少可以说令人尴尬（并且确实会导致问题，因为每个人都有一个具有相同 ID 的个人资料）。

任何想法可能是问题的原因以及我如何解决它？

PS：请注意，相关关系中的外键是正确的，并且保留了它们的唯一性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T19:08:44.430

看起来问题确实来自 SQLite 和 South 的使用。

该[文档](http://south.readthedocs.org/en/latest/databaseapi.html#database-specific-issues)指出：

> SQLite 本身根本不支持太多的模式更改，但 South 有允许删除/更改列的解决方法。但是，仍然不支持唯一索引；South 会默默地忽略任何此类命令。

（我认为）情况就是这样，因为我没有从一开始就创建这种关系，而是通过后一种迁移。我刚刚重置了基础和迁移，瞧。

请参阅[使用 Django South 重置迁移历史记录的推荐方法是什么？](https://stackoverflow.com/questions/4625712/whats-the-recommended-approach-to-resetting-migration-history-using-django-sout)用于迁移和简单`./manage.py reset myApp`的基本重置。

# jquery - 使用 Ajax 重新加载 div

> ID：16156555
> 
> 赞同：-1
> 
> 时间：2013-04-22T20:56:26.687
> 
> 标签：jquery, ajax

所以我搜索了 SO 以帮助创建以下请求以`div`在特定时间间隔刷新 a。

```
 $(document).ready(function() {
             $("#trigger-newsfeed").load("getNewsfeed.php");
           var refreshId = setInterval(function() {
              $("#trigger-newsfeed").load('getNewsfeed.php');
           }, 4000);
    }); 
```

虽然我想知道是否可以通过使用 Ajax 来提高效率（如果它在我没有意识到的情况下还没有使用 Ajax）。

我曾尝试使用其他一些 Ajax 代码来执行此操作，这也确实有效，但是，其他解决方案将等待间隔完成然后加载数据。因此，例如，如果间隔设置为 5 秒，则每次访问该页面时，用户都必须等待 5 秒，然后才会加载；所以这是我发现的唯一一个最好的片段，*首先*传递信息，然后按间隔刷新；虽然我不确定这是否是 jquery 的最佳用途。

我问这个是因为大多数关于`div`刷新的在线搜索都指向 Ajax 的使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:31:43.893

您所拥有的将起作用，但是如果网络连接/计算机速度较慢或服务器由于某种原因陷入困境，则请求可能会开始备份，如果这种情况发生太多，则可能会使浏览器崩溃。

要解决此问题，请使用 a`setTimeout`而不是间隔，以便它仅在收到上一个请求的响应后 4 秒才请求新数据。

```
function refreshNewsFeed() {
    $("#trigger-newsfeed").load("getNewsfeed.php",function(){
        setTimeout(refreshNewsFeed,4000);
    });
}
$(document).ready(refreshNewsFeed); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T20:58:57.163

You can do this.

```
$(document).ready(function() {
    var loadNewsFeed = function () {
        $("#trigger-newsfeed").load('getNewsfeed.php');
    };
    loadNewsFeed();
    var refreshId = window.setInterval(loadNewsFeed, 4000);
}); 
```

In .ready we declare a function and assign it to the variable loadNewsFeed. Then we execute the function. Then, we setup the interval to execute every 4 seconds after that.

# java - Java Swing + 计时器？在 JPanel 上移动一条线

> ID：16156556
> 
> 赞同：0
> 
> 时间：2013-04-22T20:56:28.107
> 
> 标签：java, swing, animation, timer, java-2d

我想做的很简单。我有一个 JLayeredPane，里面有两个面板。面板 2（较高的 Z 索引）具有透明背景，仅显示从 Y = 0 到 Y = max 的 Line2D 元素。我需要 X 值每隔这么多毫秒增加一次，然后重画线。我已经做好了一切准备，除了我不知道如何通过计时来做酒吧的运动。

我做了一些研究，每次我看到提到计时器类（我觉得它能够完成我想要做的事情）时，人们都建议不要使用它。我想不出使用计时器类来在屏幕上滑动我的栏的替代方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-15T14:56:58.720

希望这段代码对您有所帮助。它完全符合您的要求。

```
import javax.swing.JFrame;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.image.BufferedImage;
import java.io.*;
import javax.imageio.ImageIO;
import javax.swing.JPanel;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.Random;
import java.util.Arrays;
import java.awt.EventQueue;
import javax.swing.JFrame;

public class FloorPlaner extends JFrame {
     public int x=0;

     public FloorPlaner(){ 
          super("FloorPlaner");

          requestFocus(); 

          setContentPane(new DrawingPane());

          setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 

          setSize(400, 400);

          setResizable(true); 

          setVisible(true); 

          while (true) { 
              x++;
              repaint();
              try {
              Thread.sleep(40); //25 FPS
              } catch(InterruptedException bug) {
              Thread.currentThread().interrupt();
              System.out.println(bug);
              }
          }
     }

     class DrawingPane extends JPanel { //Where you actually draw on
        public void paintComponent(Graphics g) { //Drawing method
           g.drawLine(x,0,x,400);
        }   
     }
     public static void main(String args[]) {
            new FloorPlaner(); //Start it
     }
} 
```

# java - 如何处理被 2 个线程使用的变量？

> ID：16156558
> 
> 赞同：0
> 
> 时间：2013-04-22T20:56:28.973
> 
> 标签：java, multithreading, swing

一个线程不断读取从`BufferedReader`. 数据来自一个`SerialPort`。

在主线程上，`JMenuItem`单击串行端口时会关闭并且 BufferedReader 应该停止接收消息。

问题是：

如果我在读取消息时尝试关闭，应用程序将卡住并且串行端口不会关闭，直到端口停止发送消息。

所以基本上，我应该在关闭串口之前关闭阅读器。如果我这样做，有时我会得到一个空指针异常，因为我在读取缓冲读取器时关闭了它。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:09:51.153

听起来您可以使用`stop`阅读器类中的方法来解决此问题（从菜单项的`click`事件中调用）

```
private boolean isStopped = false;

public void stop() {
    isStopped = true;
}

while(bufferedReader.isReady()) {
    bufferedReader.read();
    if(isStopped) {
        bufferedReader.close();
    }
} 
```

这样，您可以确保`close`在所有`read`呼叫完成之前您不会打电话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:47:32.460

最简单的做法是创建一个 SynchronizedReader 类来包装你的`BufferedReader`. 但是如果没有更多上下文，我不能保证这会起作用，特别是如果您有调用代码，该代码`Reader`对`synchronized(reader)`

```
import java.io.IOException;
import java.io.Reader;
import java.nio.CharBuffer;

public class SynchronizedReader extends Reader {

    private Reader reader;

    public SynchronizedReader(Reader reader) {
        super();
        this.reader = reader;
    }

    @Override
    public synchronized int read(char[] cbuf, int off, int len) throws IOException {
        return reader.read(cbuf, off, len);
    }

    @Override
    public synchronized void close() throws IOException {
        reader.close();
    }

    @Override
    public synchronized int hashCode() {
        return reader.hashCode();
    }

    @Override
    public synchronized int read(CharBuffer target) throws IOException {
        return reader.read(target);
    }

    @Override
    public synchronized int read() throws IOException {
        return reader.read();
    }

    @Override
    public synchronized int read(char[] cbuf) throws IOException {
        return reader.read(cbuf);
    }

    @Override
    public synchronized boolean equals(Object obj) {
        return reader.equals(obj);
    }

    @Override
    public synchronized long skip(long n) throws IOException {
        return reader.skip(n);
    }

    @Override
    public synchronized boolean ready() throws IOException {
        return reader.ready();
    }

    @Override
    public synchronized boolean markSupported() {
        return reader.markSupported();
    }

    @Override
    public synchronized void mark(int readAheadLimit) throws IOException {
        reader.mark(readAheadLimit);
    }

    @Override
    public synchronized void reset() throws IOException {
        reader.reset();
    }

    @Override
    public synchronized String toString() {
        return reader.toString();
    }

} 
```

# delphi - Delphi 7 将密码箱 2 迁移到密码箱 3 河豚加密

> ID：16156563
> 
> 赞同：3
> 
> 时间：2013-04-22T20:56:36.367
> 
> 标签：delphi

在 LB 2 中，我有这个功能

```
blowfish : tlbblowfish

blowfish.ciphermode := cmECB;

someVar := blowfish.encryptstring(someString); 
```

LB 3 完全不同。如何从包含的函数之一获得相同的结果？也许与 TCodec 类？我很确定那是正确的使用方法，但它现在有很多旧课程中没有的选项。所以我不确定要设置哪些设置。

谢谢。

更新：我想我几乎拥有它，但似乎 LB3 在加密时需要密码，而 LB2 不需要。没有密码是不行的。所以也许我需要知道旧的默认密码或空密码是什么？

# javascript - 如何在 WPF 和 WinRT 中调用 .NET 中的 Javascript？

> ID：16156564
> 
> 赞同：1
> 
> 时间：2013-04-22T20:56:36.833
> 
> 标签：javascript, .net, windows-runtime

这是一个用例。我需要：

*   从 .NET (C#) 代码调用 JavaScript
*   JavaScript 不会被编译，它来自动态源
*   我需要将 .NET 对象传递给该 javascript 代码，最好是动态对象
*   我还需要从此 javascript 代码接收对象
*   我需要此代码在 WPF (Windows 7) 和 Windows Store (WinRT) 中运行

到目前为止，我只看到过激活 Windows 脚本引擎（即[IActiveScript](http://msdn.microsoft.com/en-us/library/xawadt95%28VS.85%29.aspx)）或使用开源项目。

我更愿意远离开源项目，更愿意使用 IE JavaScript 引擎（Chakra）。Windows 脚本引擎似乎不适用于 WinRT。我可以忍受在我的应用程序中托管浏览器，因为它是一个 UI 应用程序。

WPF 和 WinRT 中的代码不需要相同（我可以编写一些东西来将这两个实现包装在一个公共接口后面）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:59:34.070

Chakra 不公开公共托管接口，因此如果不在应用程序中托管 V8 之类的东西，您将无法做您想做的事情。

Metro 应用程序的另一个选择是使用 JavaScript 构建主应用程序，并在大部分工作中调用用 .NET 编写的 WinRT 对象。虽然不会在 WPF 中帮助你。

# json - Elasticsearch 删除映射属性

> ID：16156565
> 
> 赞同：22
> 
> 时间：2013-04-22T20:56:37.740
> 
> 标签：json, rest, lucene, elasticsearch

我试图找出一种方法来删除弹性搜索索引中特定属性的所有条目并删除该属性的所有类型映射。

我一直在看以下两个文档页面：[放置映射](http://www.elasticsearch.org/guide/reference/api/admin-indices-put-mapping/)和[删除映射](http://www.elasticsearch.org/guide/reference/api/admin-indices-delete-mapping/)

从第二个链接：

> “允许删除映射（类型）及其数据。REST 端点是 /{index}/{type} 和 DELETE 方法。”

我想我需要的是一个`/{index}/{type}/{property}`？

我是否需要重新创建整个索引来完成此操作，即在类型之间移动和操作数据？

例如，在映射上调用 GET：

```
curl -XGET 'http://.../some_index/some_type/_mapping' 
```

结果：

```
{
  "some_type": {
    "properties": {
      "propVal1": {
        "type": "double",
        "index": "analyzed"
      },
      "propVal2": {
        "type": "string",
        "analyzer": "keyword"
      },
      "propVal3": {
        "type": "string",
        "analyzer": "keyword"
      }
    }
  }
} 
```

在此删除操作`propVal3`后将返回：

```
curl -XGET 'http://.../some_index/some_type/_mapping' 
```

结果：

```
{
  "some_type": {
    "properties": {
      "propVal1": {
        "type": "double",
        "index": "analyzed"
      },
      "propVal2": {
        "type": "string",
        "analyzer": "keyword"
      }
    }
  }
} 
```

并且所有数据`propVal3`都将通过索引删除。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-22T21:16:05.237

你不能这样做。只是忘记这个值存在...... ;-) 如果你真的需要删除它，你将不得不重新索引你的文档。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-08-10T12:57:47.990

您可以为此使用新的`_reindex`api，您甚至可以`_mapping`在运行重新索引之前将新的 dest 索引放入，这样您就可以更改索引中字段的属性。

要重新索引并删除属性，您可以这样做：

```
POST /_reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
  },
  "script": {
    "inline": "ctx._source.remove('whatever')"
  }
} 
```

如果您将它与[_aliases API](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-aliases.html)结合使用，您可以修改索引而无需任何“停机时间”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-22T21:15:51.360

目前无法从映射中删除属性。为了从所有记录中删除某个属性的所有值，您需要重新索引删除此属性的所有记录。

# jquery - simulate ipad click sound with mp3/ogg (web development)

> ID：16156568
> 
> 赞同：0
> 
> 时间：2013-04-22T20:56:51.570
> 
> 标签：jquery

I am simulating a "click" sound on every anchor tag and submit button click on the mobile website that I'm working on using the following code:

```
 <audio id="mySoundClip" style=" display:none; visibility:hidden;">
            <source src="@Url.Content("~/Content/audio/Click.ogg")" type="audio/ogg">
            <source src="@Url.Content("~/Content/audio/Tock.mp3")" type="audio/mpeg">
              Your browser does not support the audio element.
          </audio>

        <script type="text/javascript">
          var homeURL = '@Url.Action("Index", "Home")';

          var audio = $("#mySoundClip")[0];
          $("[href]").click(function () {
            //alert("a clicked");
            audio.play();
          });

          $(":submit").click(function () {
            //alert("submit button clicked");
            audio.play();
          });
     </script> 
```

It's working as expected but there is a slight delay in when the sound file actually plays while clicking the anchor tags/submit buttons. Is there a way to play the sound file a little sooner than when it actually plays so it will seem like a native click?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:03:16.520

尝试将`preload="auto"`属性添加到您的音频标签

# c++ - 在 A .rs 资源文件 C++ 控制台中使用参数

> ID：16156573
> 
> 赞同：1
> 
> 时间：2013-04-22T20:57:16.400
> 
> 标签：c++, windows, winapi, resource-files

[这里](https://stackoverflow.com/questions/3537159/using-resource-files-with-parameters)有一个类似的问题，但我正在寻找**C++**版本。

我想创建一个带有**DialogBox的****.rs**文件，该文件使用**字符串作为变量**而不是“”，以便我可以在程序中更改它。

 ****例如：在

```
DEFPUSHBUTTON   "Hello World", IDOK, 8, 24, 75, 14 
```

将`"Hello World"`成为一个变量名，我可以在程序中*“定义”*或*设置*。

为什么？我正在尝试制作一个 DialogBox，例如**'template'**，并在程序周围制作许多实例，其中包含**不同的 Text 但**其中的按钮相同。

希望我的胡言乱语能被理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T22:57:29.327

不幸的是，这是不可能的。控件的标题文本必须是常量字符串，因为资源文件实际上是与您的应用程序分开编译的，并且不知道程序代码中其他地方定义的变量。

资源文件确实支持字符串表，但即使这些也要求字符串是常量值。优点是您可以修改资源文件而无需访问源代码的其余部分，这使得本地化之类的事情成为可能，即使是外部翻译人员也是如此。

所以你被困在硬编码你的`DEFPUSHBUTTON`. 它可以是空字符串或您想要的任何值；你只需要一个占位符。您可以将所有可能的标题放在一个字符串表中（我建议这样做），但您不能使用任何自动机制将两者联系起来。

您需要自己编写代码来执行此操作。您当然可以*动态*生成资源，但这有点麻烦。我认为最简单的方法就是创建对话框（使用您的“模板”资源文件），检索要更改其标题文本的控件的句柄，并向它们`WM_SETTEXT`发送带有新字符串的消息。实际上，该[`SetDlgItemText`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645521.aspx)功能将为您完成此任务。

也许用一些代码更容易解​​释。假设您定义了一个对话框资源，包括所有控件。您希望修改的所有控件都需要为每个控件分配一个唯一 ID，以便您可以在运行时区分它们。*您在资源文件中分配的初始*值是什么并不重要，因为您将立即更改它们。它可能看起来像这样：

```
IDD_TEMPLATE DIALOG DISCARDABLE  0, 0, xx, xx
STYLE DS_MODALFRAME | WS_POPUP | WS_CAPTION
CAPTION "Dialog Template"
FONT 8, "MS Sans Serif"
BEGIN
    CTEXT           "Placeholder text", IDC_MESSAGE, xx, xx, xx, xx
    DEFPUSHBUTTON   "Placeholder",      IDOK,        xx, xx, xx, xx
    PUSHBUTTON      "Cancel",           IDCANCEL,    xx, xx, xx, xx
END 
```

然后，在您的对话过程 ( [`DialogProc`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645469.aspx)) 中，[`WM_INITDIALOG`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645428.aspx)按如下方式处理消息：

```
INT_PTR CALLBACK TemplateDialogProc(HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
  switch (uMsg)
  {
    case WM_INITDIALOG:
    {
      // Load the caption strings you want to use from the string table
      // in the resource file, or get them from wherever you want.
      // These are the "variables" you wanted to use in the question.
      TCHAR* pszMessage;
      LoadString(hInstance,   /* instance handle for app or resource DLL */
                 IDS_MESSAGE, /* ID of the string resource to load       */
                 reinterpret_cast<LPTSTR>(&pszMessage),
                 0);
      TCHAR* pszOkBtn;
      LoadString(hInstance, IDS_OKBUTTON, reinterpret_cast<LPTSTR>(&pszOkBtn), 0);
      // ...etc.

      // Set the caption text for each control.
      SetDlgItemText(hwndDlg,     /* handle to the dialog box window */
                     IDC_MESSAGE, /* ID of the control to modify     */
                     pszMessage); /* variable containing text to set */
      SetDlgItemText(hwndDlg, IDOK, pszOkBtn);
      // ...etc.

      // And, if you want to set some other properties, you can do that too.
      // For example, you might set the caption of the dialog itself.
      TCHAR* pszTitle;
      LoadString(hInstance, IDS_DLGCAPTION, reinterpret_cast<LPTSTR>(&pszTitle), 0);
      SetWindowText(hwndDlg, pszTitle);
      // ...etc.

      return TRUE;  // set the default focus
    }
    // ...process other messages as necessary
  }
  return FALSE;  // we did not process the message
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:32:40.703

虽然我认为 Cody Gray 的答案更好，但始终可以选择在内存中创建对话框模板，并在创建对话框的新实例时对其进行修改。除非你觉得这种事情很有趣，否则我不会推荐它（*我就是*其中之一）。我当然不会根据您的要求推荐它，但从技术上讲，它是一种选择...

[`DialogBoxIndirect`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms645457%28v=vs.85%29.aspx)接受一个指向结构的指针，该结构由[`DLGTEMPLATE`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms645394%28v=vs.85%29.aspx)描述对话框本身的标题 ( ) 和指定数量的控件 ( [`DLGITEMTEMPLATE`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms644997%28v=vs.85%29.aspx)) 组成。

每次您想要一个在按钮上具有不同文本的 DialogBox 时，您都可以有效地使用上述方法构建一个新的内存中对话框模板。但是，如果您真正想做的只是更改一些文本，这有点极端，正如 Cody 所说，您可以使用`SetDlgItemText`.

如果你*真的很*好奇，[这里有一个例子](http://blogs.msdn.com/b/oldnewthing/archive/2005/04/29/412577.aspx)。****

# python - Using cURL with 127.0.0.1 to connect to django dev server is not working

> ID：16156574
> 
> 赞同：0
> 
> 时间：2013-04-22T20:57:17.703
> 
> 标签：python, django

If I start my django dev server using the command `python manage.py runserver` I can connect to it using the command (from another terminal) `curl http://localhost:8000/` but I can't connect with `curl http://127.0.0.1:8000/`, the terminal responds "503 Service Unavailable".

**Question:** Are 127.0.0.1 and localhost not supposed to be the same?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:56:19.577

本地主机被翻译成 127.0.0.1，但如果你得到一个 503 错误，这意味着你有另一个 HTTP 服务器在端口 8000 上**回复。**

您可以运行另一个实例。（Apache、其他 Django 实例等）检查两次。

如果需要，请使用 netstat 进行验证。

然后尝试运行：

```
python manage.py runserver 0.0.0.0:8000 
```

在每个地址上绑定开发服务器。

如果它不起作用，请尝试在不同的端口上再次启动 devserver。

# deployment - Azure Continuous Integration Overwriting App_Data even with WebDeploy file specified to "exclude app data"

> ID：16156576
> 
> 赞同：1
> 
> 时间：2013-04-22T20:57:24.343
> 
> 标签：deployment, azure, web-deployment, azure-web-app-service

I have a Windows Azure Website and I've setup Azure Continuous Integration with hosted Team Foundation Server. I make a change on my local copy, commit to TFS, and it gets published to Azure. This is great, the problem is that I have an Access database in the ~\App_Data\ folder and when I check-in the copy on Azure gets overwritten.

I setup a web-deploy publish profile to "Exclude App_Data" and configured the build task to use the web-deploy profile, and now it DELETES my ~\App_Data\ folder.

Is there a way to configure Azure Continuous Integration to deploy everything and leave the App_Data alone?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T23:04:53.523

我在 Visual Studio 中使用“发布 Web”工具，但我认为原理是相同的：

*   如果您在本地修改文件并发布，它将覆盖网络上的任何内容
*   如果您在本地没有文件 - 但该文件存在于网络上 - 发布后它仍将存在于网络上

默认情况下，App_Data 文件夹在此行为中没有特殊处理。这是有道理的 - 如果您在本地修改了 .aspx 或 .jpg 文件，您会希望最新版本在网络上发布，对吗？

我还使用 App_Data 存储一些我希望 Web 服务器（ASP.NET 代码）修改并使其在 Web 上保持最新的文件。

解决方案是：

1.  允许网络发布上传 App_Data，不排除。
2.  不要将要在 Web 上修改的文件存储在 App_Data（本地）中。
3.  让 Web 服务器专门负责创建和修改文件。

理想情况下，您不必更改任何代码，并且服务器可以在需要开始时创建一个空白文件。

但是，如果您必须从某些内容开始，例如一个新的空白 .mdf 文件，您可以执行以下操作：

1.  在本地/在源存储库中，创建 App_Data/blank.mdf（这将是一个起点，而不是工作文件）。
2.  在 Global.asax 中，修改“Application_Start”以从空白起始文件创建真正的工作 .mdf 文件：

    ```
    // If the real file doesn't exist yet (first run),
    // then create it using a copy of the placeholder.
    // If it exists then we re-use the existing file.
    string real_file = HttpContext.Current.Server.MapPath("~/App_Data/working.mdf");
    if (!File.Exists(real_file))
        File.Copy(HttpContext.Current.Server.MapPath("~/App_Data/blank.mdf"), real_file); 
    ```

# python - Python - 难以调用父（ElementTree）类的方法

> ID：16156582
> 
> 赞同：0
> 
> 时间：2013-04-22T20:57:56.330
> 
> 标签：python, class, inheritance, parent-child, elementtree

这是我导入 ElementTree 的方式：

```
try:
    import xml.etree.cElementTree as ET
except ImportError:
    import xml.etree.ElementTree as ET 
```

这是我的课程的一个片段：

```
class Foo(ET.ElementTree):
    def __init__(self, *args):
        if args[0] == "file":
            # populate from xml file
            self = load_xml(self, *args[1:])
        elif args[0] == "user_input":
            # populate from user_input
            self = load_from_user_input(self, *args[1:])
        else:
            raise ValueError("Error initializing Foo: Invalid argument")

    def save_xml(self, file_name):
        self.write(file_name + FOO_EXTENSION, xml_declaration=True, encoding='utf-8', method='xml') 
```

*init*和 save_xml 按预期工作。当我需要在方法中使用 Foo 对象的根时，事情变得令人困惑，例如将某些内容附加到 Foo ElementTree 的根：

```
root = self.getroot()
root.append(something) 
```

这会产生此错误：

```
AttributeError: getroot 
```

*   如何从 Foo 中正确调用 getroot()？

*   为什么 self.getroot() 不起作用，但 self.write() 起作用？

*   我从 ElementTree 对象继承的方式有什么问题吗？

*   我是否在不知不觉中遇到了一个重要的面向对象的概念障碍？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:47:04.647

我不熟悉 ET.ElementTree 类，但它基本上是这样的

```
class Base(object):
    def __init__(self,*args,**kwargs):
       print "Base Constructor Recieved:",args,kwargs
       pass #do something with the args and kwargs

    def do_something(self,*args):
       print "CALLED BASE DO SOMETHING!"

class InheritsFromBase(Base):
    def __init__(self,*args,**kwargs):
        #modify args and kwargs how you want
        new_args = ["a","b","v"]
        super(Base,self).__init__(*new_args,**kwargs) #initialize super class

    def do_something(self,operator,lhs,rhs):
        print "Do Something InheritsFromBase %s%s%s"%(lhs,operator,rhs)
        super(Base,self).do_something("arg1","arg2","arg3","...")

x = InheritsFromBase()
x.do_something("%",5,4) 
```

如果基类不继承自对象，则可能无法使用 super 语句，下面提供了替代方法（仅 init 方法）

```
def __init__(self,*args,**kwargs):
    #modify args and kwargs how you want
    new_args = ["a","b","v"]
    Base.__init__(self,*new_args,**kwargs) #initialize super class 
```

我怀疑这里的某个地方是你所缺少的。您可能需要以某种方式调用超级构造函数。

# jquery - 我不明白这个 jquery 代码

> ID：16156583
> 
> 赞同：0
> 
> 时间：2013-04-22T20:58:00.403
> 
> 标签：jquery

我有这个 jQuery 代码：

```
$('#switcher button').click(function (event) {
    var bodyClass = this.id.split('-')[1];
    $('body').removeClass().addClass(bodyClass);
    $('#switcher button').removeClass('selected');
    $(this).addClass('selected');
    event.stopPropagation();
}); 
```

我不明白的行：

```
$('#switcher button').removeClass('selected');
$(this).addClass('selected'); 
```

我认为他们正在做同样的事情。因为“这个”对我来说就是“#switcher 按钮”......如果我错了，“这个......”是谁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:00:14.223

`this`指您单击的特定按钮。所以第一行删除了所有这些类，然后下一行将类添加到您单击的单个按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:59:29.193

`selected`您正在从 ID 为 的元素内的按钮中删除 的类`switcher`。然后将该类添加回当前单击的按钮，该按钮由`this`

# java - Removing element from array error

> ID：16156588
> 
> 赞同：0
> 
> 时间：2013-04-22T20:58:17.270
> 
> 标签：java, arrays, string, arraylist, joptionpane

In the following code, if the size of the array is larger than 20, I'm trying to remove anything after 20 from the array. In my loop, I have userinput.remove(20 + i); However, I'm getting that it can't find the symbol remove? I'm not sure why it's doing this if the error.add itself is actually working.

**userinput is defined earlier in the code**

```
public static void checknames(String[] userinput){

ArrayList<String> error = new ArrayList<String> ();

    if(userinput.length > 20){

        for(int i=0; i<userinput.length - 20; i++){
            error.add(userinput[20 + i]);
            userinput.remove(20 + i);}
            JOptionPane.showMessageDialog(null, "You can only enter up to 20
            employees. \n The following employees exceed this limit." + error);

            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:01:54.870

错误是正确的——数组没有这样`remove`的方法。您应该：

*   改用 a `List`，就像`ArrayList`您使用的`error`.
*   创建一个短 1 个元素的新数组，并复制除您要删除的元素之外的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:01:37.363

您不能调用`remove`数组。您无法更改数组的大小。但是您可以将该元素设置为`null`：

```
userinput[20 + i] = null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:01:47.640

```
userinput.remove(20 + i); 
```

`userinput`是 的数组`String[]`。没有`remove(..)`可用于数组的方法。

可能您需要`null`为大于 20 的索引设置值（或）创建一个`String`只有前 20 个元素的新数组并丢弃`userinput`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T21:04:51.367

尝试这个：

```
public static void checknames(String[] userinput) {

    List<String> error = new ArrayList<String>();

        for(int i=20; i<userinput.length; i++) {
            error.add(userinput[i]);
            userinput[i] = null;
        }
        JOptionPane.showMessageDialog(null, "You can only enter up to 20
            employees. \n The following employees exceed this limit." + error);

} 
```

只是一些小改动。您应该始终在左侧制作`ArrayList`这样的 s（带）。`List<...>`另外，我删除了该`if`语句并稍微更改了您的循环，因此您不需要它。正如其他人提到的那样，`.remove(...)`它不适用于数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-22T21:26:05.117

如果您坚持保留 String[]，您可以将“肮脏的工作”委托给现有的 API 方法，即[Arrays.copyOfRange(Object[] src, int from, int to)](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange%28T%5B%5D,%20int,%20int%29)

* * *

简短、独立、正确（可编译），示例：

```
import java.util.Arrays;

public class R {
    public static String[] trimEmployees(String[] employees, int maxSize) {
        return Arrays.copyOfRange(employees, 0, maxSize);
    }

    public static void main(String[] args) {
        String[] employees = new String[] { "Jennifer", "Paul", "Tori",
                "Zulema", "Donald", "Aleshia", "Melisa", "Angelika", "Elda",
                "Elenor", "Kimber", "Eusebia", "Mike", "Karyn", "Marinda",
                "Titus", "Miki", "Alise", "Liane", "Suzanne", "Dorothy" };
        int max = 20;

        System.out.println(String.format("Input employees (len=%d): %s ",
                employees.length, Arrays.toString(employees)));
        if (employees.length > max) {
            employees = trimEmployees(employees, max);
            System.out.println(String.format("Trimmed employees (len=%d): %s",
                    employees.length, Arrays.toString(employees)));
        }
    }
} 
```

印刷：

```
输入员工 (len=21): [Jennifer, Paul, Tori, Zulema, Donald, Aleshia, Melisa, Angelika, Elda, Elenor, Kimber, Eusebia, Mike, Karyn, Marinda, Titus, Miki, Alise, Liane, Suzanne, Dorothy ]
精简员工 (len=20)：[Jennifer, Paul, Tori, Zulema, Donald, Aleshia, Melisa, Angelika, Elda, Elenor, Kimber, Eusebia, Mike, Karyn, Marinda, Titus, Miki, Alise, Liane, Suzanne]
```

# android - How to receive open cv imge in android phone

> ID：16156589
> 
> 赞同：0
> 
> 时间：2013-04-22T20:58:18.183
> 
> 标签：android, c++, opencv, image-processing, imageview

I want to send a photo in open cv saved in cv::Mat object to android phone and I want to show it in an ImageView on android side I succeed to send the photo data and I received them in an array of integers (int[]) on android But my problem How to make bitmap from them to show as I don't know the construction of photo in android and its relation with open cv Mat;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:17:06.930

首先，将 Mat 转换为 Android Bitmap（这是 OpenCV 的 Android 界面的代码）：

```
try {
    Utils.matToBitmap(mat, bitmap);
} catch (Exception e) {
    bitmap.recycle();
    bitmap = null;
} 
```

然后，将 Bitmap 设置为 ImageView 的内容（您已在 XML 布局文件中定义）：

```
ImageView imageView = (ImageView) findViewById(R.id.imageView);
imageView.setImageBitmap(bitmap); 
```

如果您将 OpenCV 的 C++ 接口与 Native Development Kit 一起使用，最好在 C++ 中执行第一步并从 C++ 方法返回位图，然后像以前一样在 Java 中执行第二步。

# c# - 应该如何在程序集中传递公共引用？

> ID：16156590
> 
> 赞同：2
> 
> 时间：2013-04-22T20:58:28.247
> 
> 标签：c#, oop, design-patterns, singleton, static-classes

我正在尝试摆脱代码库中的静态类、静态辅助方法和单例类。目前，它们几乎遍布整个代码，尤其是实用程序类和日志库。这主要是由于需要模拟能力以及面向对象的设计和开发问题，例如可扩展性。将来我可能还需要引入某种形式的依赖注入，并愿意为此敞开大门。

基本上，我遇到的问题是关于传递常用引用的方法。这些是代码库中几乎每个类都使用的对象，例如日志接口、实用程序（帮助程序）类接口，可能还有一个类的实例，该类的实例为大多数类相关的程序集保存内部公共状态。

据我所知，有两种选择。一种是定义一个存储公共引用的类（或接口），如果您愿意，还可以定义一个上下文，并将上下文传递给创建的每个对象。另一种选择是将几乎每个类的每个公共引用作为单独的参数传递，这将增加类构造函数的参数数量。

这些方法中哪一种更好，每种方法的优缺点是什么，是否有更好的方法来完成这项任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:03:52.747

我通常使用上下文对象方法，并将上下文对象传递给对象的构造函数或方法——取决于哪个最有意义。

上下文对象模式可以采用几种形式。

您可以定义一个具有您需要的成员的接口，或者您可以生成一种容器类。例如，在编写松散耦合的组件时，我倾向于让我实现的每个组件都有一个匹配的接口，以便在需要时可以重新实现它。然后我在“管理器”对象上注册对象，如下所示：

```
public interface IServiceManager
{
    public T GetService<T>();
    public T RequireService<T>();
    public void RegisterService<T>(T service);
    public void UnregisterService<T>(T service);
} 
```

在幕后有一个从类型到对象的映射，这使我能够非常快速地将大量不同的组件组装成一个工作整体。每个组件都通过接口请求其他组件，而管理器对象将它们粘合在一起。（如果您正确地编写了组件，您甚至可以在进程运行时将一项服务换成另一项服务！）

可以按照以下方式注册服务：

```
class FooService : IFooService { }

// During process start-up:
serviceManager.RegisterService<IFooService>(new FooService()); 
```

由于字典查找，这种方法比平面接口方法有更多的开销，但它允许我构建非常复杂的系统，可以很容易地使用不同的服务实现重新部署。（而且，像往常一样，我遇到的任何瓶颈都不是从字典中查找服务对象，而是在其他地方，例如数据库。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:11:36.893

你会得到不同的意见，但*通常*为每个依赖项向构造函数传递一个单独的参数是首选的，原因如下：

*   它清楚地定义了类的实际依赖关系——使用“上下文”，如果不深入研究代码，您不知道使用了上下文的哪些部分。
*   通常，构造函数有很多参数是一种设计味道，因此使用构造函数注入可以帮助您发现设计缺陷。
*   测试时，您可以模拟单个依赖项，而不必模拟整个上下文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:02:20.737

我建议将作为参数传递给构造函数。这对于依赖注入和单元可测试性（模拟）都有很大的优势。

# coldfusion - cfInclude 不带 cfoutput 标签

> ID：16156592
> 
> 赞同：1
> 
> 时间：2013-04-22T20:58:35.207
> 
> 标签：coldfusion, cfml, openbd

好的，我有模板文件，我**知道**它们需要在标签之间，但是在 a周围`<cfoutput>`放置标签是行不通的，任何带有 a 的东西都行不通，因为这不允许我操纵范围。`<cfoutput>``<cfinclude>``<cfmodule>``variables`

那么，任何想法——无论多么复杂——都可以让我包含这样一个模板文件并让它像在`<cfoutput>`标签之间一样工作？

* * *

一点上下文：这是我正在研究的“框架”，并且要求每个模板文件都以`<cfoutput>`标签开头和结尾似乎是一种真正的浪费，*特别是*因为模板文件看起来越不“冷融合”，IMO就越好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T01:15:56.673

我打算建议这个`render()`选项，但需要注意的是，它是 OpenBDML（或任何他们想称之为他们的 CFML 版本）中的一个非常糟糕的功能，我认为应该避免。我看不出它如何不会导致每个请求都重新编译 CFML，这是一个巨大的开销。我认为你最好在保存/读取标记时修改标记以将其包装/解包到`<cfoutput>`标签中，这样生成的 CFML 只有在文件实际更改时才会重新编译。这真的比阅读的频率要少得多。

根据您的问题，我[写了一些关于 CFML 编译过程的文章](http://adamcameroncoldfusion.blogspot.co.uk/2013/04/cfml-compilation-into-java-class-files.html)，说明了为什么将`<cfoutput>`标签放在单独的文件中不起作用。很抱歉花了这么长时间来写和跟进这里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T13:12:01.350

我们在轮子中所做的只是用 cfsavecontent 标记包装 cfinclude

```
<cffunction name="renderInclude">
  <cfargument name="template" value="string" required="true">
  <cfset var myOutput = "">

  <cfsavecontent variable="myOutput"><cfoutput><cfinclude template="#arguments.template#"></cfoutput></cfsavecontent>

  <cfreturn trim(myOutput)>
</cffunction> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T22:24:21.743

找到了解决此问题的[OpenBD特定方法。](http://openbd.org/)显然我不是唯一遇到这个问题的人，OpenBD 包含一个有用的[render()](http://openbd.org/manual/?/function/render)负责评估 cfml 内容。所以我结束了

```
<cfset cfml = fileRead(expandPath(...))>
...
<cfoutput>#render("<cfoutput>"&cfml&"</cfoutput>")#</cfoutput> 
```

这不是一个漂亮的解决方案，因为我破坏了引擎本来会执行的每页编译，但是由于这些页面上的 cfml 相对简单，我认为这不是太大的问题。至少它应该比实际将文件写入磁盘对性能的影响要小。

# html - 如何更改文本区域的边框颜色：focus

> ID：16156594
> 
> 赞同：168
> 
> 时间：2013-04-22T20:58:47.880
> 
> 标签：html, css

原谅我这是一个愚蠢的问题，但我需要帮助。我想在焦点上更改 TEXTAREA 的边框颜色。但我的代码似乎无法正常工作。

[请在fiddle](http://fiddle.jshell.net/ffS4S/)上查看代码。

```
<form name = "myform" method = "post" action="insert.php"  onsubmit="return validateform()" style="width:40%">
    <input type="text" placeholder="Enter Name." name="name" maxlength="300" class="input">
    <input type="email" placeholder="Enter E-mail." name="address" maxlength="300" class="input">
    <textarea placeholder="Enter Message." name="descrip" class="input" ></textarea>    
    <br>
    <input class="button secondary" type=submit name="submit" value="Submit" >
</form> 
```

这是CSS

```
.input {
    border:0; 
    padding:10px; 
    font-size:1.3em; 
    font-family:"Ubuntu Light","Ubuntu","Ubuntu Mono","Segoe Print","Segoe UI";
    color:#ccc; 
    border:solid 1px #ccc; 
    margin:0 0 20px; 
    width:300px;
    -moz-box-shadow: inset 0 0 4px rgba(0,0,0,0.2); 
    -webkit-box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.2); 
    box-shadow: inner 0 0 4px rgba(0, 0, 0, 0.2);
    -webkit-border-radius: 3px; 
    -moz-border-radius: 3px; 
    border-radius: 3px;    
  }

input:focus { 
    outline: none !important;
    border-color: #719ECE;
    box-shadow: 0 0 10px #719ECE;
 } 
```

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2013-04-22T21:03:06.687

```
.input:focus {
    outline: none !important;
    border:1px solid red;
    box-shadow: 0 0 10px #719ECE;
  } 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2015-09-07T13:54:54.230

**有一个 input:focus 因为有一个 textarea:focus**

```
 input:focus { 
        outline: none !important;
        border-color: #719ECE;
        box-shadow: 0 0 10px #719ECE;
    }
    textarea:focus { 
        outline: none !important;
        border-color: #719ECE;
        box-shadow: 0 0 10px #719ECE;
    } 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2019-07-26T11:29:11.377

可能更合适的*更改*轮廓颜色的方法是使用[`outline-color`](https://developer.mozilla.org/en-US/docs/Web/CSS/outline-color)CSS 规则。

```
textarea {
  outline-color: #719ECE;
} 
```

或用于输入

```
input {
  outline-color: #719ECE;
} 
```

`box-shadow`不是完全相同的东西，它可能看起来与轮廓不同，特别是如果您将自定义样式应用于您的元素。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-02-26T23:27:02.580

很简单 ：

```
 outline-color : green!important; 
```

我的 react-boostrap 按钮的整个 CSS 是：

```
 .custom-btn {
     font-size:1.9em;
     background: #2f5bff;
     border: 2px solid #78e4ff;
     border-radius: 3px;
     padding: 50px 70px;
     outline-color : blue !important;
     text-transform: uppercase;
     user-select: auto;
     -moz-box-shadow: inset 0 0 4px rgba(0,0,0,0.2);
     -webkit-box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.2);
     -webkit-border-radius: 3px;
     -moz-border-radius: 3px;
 } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-02-02T23:21:14.267

试试这个可能会奏效

```
input{
outline-color: #fff //your color
outline-style: none // it depend on you 
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2022-01-23T10:28:25.647

这将正常工作。

```
input:focus{
    outline: none;
    border:1px solid red;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-08T07:25:06.767

你只需要在 scss 变量中

```
$input-btn-focus-width:       .05rem !default; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-02-10T04:08:17.910

您可以使用 CSS`pseudo-class`来做到这一点。伪类用于定义元素的特殊状态。

有一个`::focus`伪类用于选择具有焦点的元素。所以你可以像这样把它挂在你的 CSS 中

**使用类**

```
.my-input::focus {
  outline-color: green;
}
```

**使用 ID**

```
#my-input::focus {
  outline-color: red;
}
```

**直接选择元素**

```
input::focus {
  outline-color: blue;
}
```

**使用属性选择器**

```
input[type="text"]::focus {
  outline-color: orange;
}
```

# python - 如何将 Windows 时区转换为 pytz 理解的时区？

> ID：16156597
> 
> 赞同：11
> 
> 时间：2013-04-22T20:59:00.037
> 
> 标签：python, timezone, pytz

在 windows python 环境中，我可以像这样获得本地时区，但它不适用于 pytz：

```
>>> import win32timezone
>>> win32timezone.TimeZoneInfo.local()
TimeZoneInfo(u'US Mountain Standard Time', True)
>>> win32timezone.TimeZoneInfo.local().timeZoneName
u'US Mountain Standard Time'
>>> tz = pytz.timezone(win32timezone.TimeZoneInfo.local().timeZoneName)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python27\lib\site-packages\pytz\__init__.py", line 185, in timezone
    raise UnknownTimeZoneError(zone)
pytz.exceptions.UnknownTimeZoneError: 'US Mountain Standard Time' 
```

将输出转换为时区名称 pytz.timezone() 的好方法是什么？

* * *

`tzlocal`这是使用（感谢马特）的答案：

```
>>> from tzlocal.win32 import get_localzone_name
>>> get_localzone_name()
'America/Phoenix'
>>> tz = pytz.timezone(get_localzone_name())
>>> tz
<DstTzInfo 'America/Phoenix' MST-1 day, 17:00:00 STD> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-22T21:46:03.857

不要根据其名称对 Windows 时区 ID 的含义做出任何假设。例如`US Mountain Standard Time`，实际上是亚利桑那州大部分地区的 Windows 时区，因为它不实施夏令时，所以它永久处于 MST 中。但是山区其他时区的 Windows ID 是`Mountain Standard Time`-在山区夏令时期间*确实*遵循夏令时，但时区 ID 不会改变！这两个区域的 ID 之间的唯一区别是“US”前缀。在 IANA/Olson 数据库中，这是两个非常不同的区域 -`America/Phoenix`和`America/Denver`.

您需要的是 Unicode CLDR 项目提供的从 Windows 到 Olson 时区 ID 的映射。阅读[TimeZone 标签 wiki](https://stackoverflow.com/tags/timezone/info)以获取信息和链接。我不确定是否已经有一个在 Python 中实现它的库——你可能需要做一些研究，或者自己从原始数据中实现它。

**更新**

经过一番搜索，我找到了一个名为[tzlocal](https://github.com/regebro/tzlocal)的 Python 库，它具有 CLDR 映射。甚至可以包含一个脚本，该脚本将从 CLDR 网站获取当前映射并自行更新。我自己没有尝试过，但它似乎有正确的方法。它主要专注于返回当前系统时区，在适合与 pytz 一起使用的 IANA/Olson id 中。 [这是作者的博客文章，描述了它的用法。](http://regebro.wordpress.com/2012/09/12/presenting-tzlocal-a-simple-way-to-get-your-local-timezone-for-pytz/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-22T21:28:51.350

[Anurag Uniyal 发布](https://stackoverflow.com/a/8328904/190597)了另一种方法来发现与计算机报告的 tzname 和 utcoffset 一致的时区名称。

* * *

跟进 Matt Johnson 的解决方案，以下是如何加载从 Windows 时区 ID 到 Olson 时区名称的[Unicode 通用区域设置数据存储库 (CLDR) 映射：](http://unicode.org/repos/cldr/trunk/common/supplemental/windowsZones.xml)

```
import lxml.etree as ET
import collections
import pprint
result = {}
doc = ET.parse('http://unicode.org/repos/cldr/trunk/common/supplemental/windowsZones.xml')
for zone in doc.xpath('//mapZone'):
    attrib = zone.attrib
    if attrib['territory'] == '001':
        result[attrib['other']] = attrib['type']
pprint.pprint(dict(result)) 
```

产量

```
{'AUS Central Standard Time': 'Australia/Darwin',
 'AUS Eastern Standard Time': 'Australia/Sydney',
 'Afghanistan Standard Time': 'Asia/Kabul',
 'Alaskan Standard Time': 'America/Anchorage',
 'Arab Standard Time': 'Asia/Riyadh',
 'Arabian Standard Time': 'Asia/Dubai',
 'Arabic Standard Time': 'Asia/Baghdad',
 'Argentina Standard Time': 'America/Buenos_Aires',
 'Atlantic Standard Time': 'America/Halifax',
 'Azerbaijan Standard Time': 'Asia/Baku',
 'Azores Standard Time': 'Atlantic/Azores',
 'Bahia Standard Time': 'America/Bahia',
 'Bangladesh Standard Time': 'Asia/Dhaka',
 'Canada Central Standard Time': 'America/Regina',
 'Cape Verde Standard Time': 'Atlantic/Cape_Verde',
 'Caucasus Standard Time': 'Asia/Yerevan',
 'Cen. Australia Standard Time': 'Australia/Adelaide',
 'Central America Standard Time': 'America/Guatemala',
 'Central Asia Standard Time': 'Asia/Almaty',
 'Central Brazilian Standard Time': 'America/Cuiaba',
 'Central Europe Standard Time': 'Europe/Budapest',
 'Central European Standard Time': 'Europe/Warsaw',
 'Central Pacific Standard Time': 'Pacific/Guadalcanal',
 'Central Standard Time': 'America/Chicago',
 'Central Standard Time (Mexico)': 'America/Mexico_City',
 'China Standard Time': 'Asia/Shanghai',
 'Dateline Standard Time': 'Etc/GMT+12',
 'E. Africa Standard Time': 'Africa/Nairobi',
 'E. Australia Standard Time': 'Australia/Brisbane',
 'E. Europe Standard Time': 'Asia/Nicosia',
 'E. South America Standard Time': 'America/Sao_Paulo',
 'Eastern Standard Time': 'America/New_York',
 'Egypt Standard Time': 'Africa/Cairo',
 'Ekaterinburg Standard Time': 'Asia/Yekaterinburg',
 'FLE Standard Time': 'Europe/Kiev',
 'Fiji Standard Time': 'Pacific/Fiji',
 'GMT Standard Time': 'Europe/London',
 'GTB Standard Time': 'Europe/Bucharest',
 'Georgian Standard Time': 'Asia/Tbilisi',
 'Greenland Standard Time': 'America/Godthab',
 'Greenwich Standard Time': 'Atlantic/Reykjavik',
 'Hawaiian Standard Time': 'Pacific/Honolulu',
 'India Standard Time': 'Asia/Calcutta',
 'Iran Standard Time': 'Asia/Tehran',
 'Israel Standard Time': 'Asia/Jerusalem',
 'Jordan Standard Time': 'Asia/Amman',
 'Kaliningrad Standard Time': 'Europe/Kaliningrad',
 'Korea Standard Time': 'Asia/Seoul',
 'Magadan Standard Time': 'Asia/Magadan',
 'Mauritius Standard Time': 'Indian/Mauritius',
 'Middle East Standard Time': 'Asia/Beirut',
 'Montevideo Standard Time': 'America/Montevideo',
 'Morocco Standard Time': 'Africa/Casablanca',
 'Mountain Standard Time': 'America/Denver',
 'Mountain Standard Time (Mexico)': 'America/Chihuahua',
 'Myanmar Standard Time': 'Asia/Rangoon',
 'N. Central Asia Standard Time': 'Asia/Novosibirsk',
 'Namibia Standard Time': 'Africa/Windhoek',
 'Nepal Standard Time': 'Asia/Katmandu',
 'New Zealand Standard Time': 'Pacific/Auckland',
 'Newfoundland Standard Time': 'America/St_Johns',
 'North Asia East Standard Time': 'Asia/Irkutsk',
 'North Asia Standard Time': 'Asia/Krasnoyarsk',
 'Pacific SA Standard Time': 'America/Santiago',
 'Pacific Standard Time': 'America/Los_Angeles',
 'Pacific Standard Time (Mexico)': 'America/Santa_Isabel',
 'Pakistan Standard Time': 'Asia/Karachi',
 'Paraguay Standard Time': 'America/Asuncion',
 'Romance Standard Time': 'Europe/Paris',
 'Russian Standard Time': 'Europe/Moscow',
 'SA Eastern Standard Time': 'America/Cayenne',
 'SA Pacific Standard Time': 'America/Bogota',
 'SA Western Standard Time': 'America/La_Paz',
 'SE Asia Standard Time': 'Asia/Bangkok',
 'Samoa Standard Time': 'Pacific/Apia',
 'Singapore Standard Time': 'Asia/Singapore',
 'South Africa Standard Time': 'Africa/Johannesburg',
 'Sri Lanka Standard Time': 'Asia/Colombo',
 'Syria Standard Time': 'Asia/Damascus',
 'Taipei Standard Time': 'Asia/Taipei',
 'Tasmania Standard Time': 'Australia/Hobart',
 'Tokyo Standard Time': 'Asia/Tokyo',
 'Tonga Standard Time': 'Pacific/Tongatapu',
 'Turkey Standard Time': 'Europe/Istanbul',
 'US Eastern Standard Time': 'America/Indianapolis',
 'US Mountain Standard Time': 'America/Phoenix',
 'UTC': 'Etc/GMT',
 'UTC+12': 'Etc/GMT-12',
 'UTC-02': 'Etc/GMT+2',
 'UTC-11': 'Etc/GMT+11',
 'Ulaanbaatar Standard Time': 'Asia/Ulaanbaatar',
 'Venezuela Standard Time': 'America/Caracas',
 'Vladivostok Standard Time': 'Asia/Vladivostok',
 'W. Australia Standard Time': 'Australia/Perth',
 'W. Central Africa Standard Time': 'Africa/Lagos',
 'W. Europe Standard Time': 'Europe/Berlin',
 'West Asia Standard Time': 'Asia/Tashkent',
 'West Pacific Standard Time': 'Pacific/Port_Moresby',
 'Yakutsk Standard Time': 'Asia/Yakutsk'} 
```

如果您不希望您的程序依赖于 lxml 或网络连接，您可以将此 dict 粘贴在模块中并从那里使用它。

# android - 浏览器图像显示不正确

> ID：16156602
> 
> 赞同：0
> 
> 时间：2013-04-22T20:59:22.117
> 
> 标签：android, html, css, jpeg, gif

只是想知道是否有人知道为什么我的网站在 Android 浏览器上看起来像垃圾。

在 iOS 上看起来不错，在某些 Android 手机上偶尔看起来还不错，但通常看起来像这样：

[看起来像垃圾](http://i.stack.imgur.com/heTea.png)

如果您从桌面或 iOS 访问，实际站点是[www.macey.3owl.com](http://www.macey.3owl.com)，看起来很完美（除了不是 100% 完成 =））

我开始认为这可能是一个超时问题，但我真的不知道。只是看起来它正在以 256k 或其他方式加载所有内容。用 Photoshop 制作并使用 Photoshop 制作的简易缩略图和 gif 压缩的 Jpeg。

任何见解都会很棒。

编辑：在 HTC Sensation Z710e 和 Dolphin HD、股票浏览器和 Chrome 中的 Nexus 4 上查看，每个都有相同的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:43:27.730

不知道为什么我之前没有注意到，但我想我会回答我自己的问题。

这是血腥的 3G 网络压缩。

任何遇到相同问题的人都可以关闭压缩，例如：[Accelerator.orange.co.uk或者您可以使用](http://accelerator.orange.co.uk)[Data URI](http://en.wikipedia.org/wiki/Data_URI_scheme)内联图片，您可以将 HTTP 标头设置为

```
cache-control: no-transform 
```

但并非所有代理都遵循这一点，因此您可以切换到 HTTPS，或者像我一样简单地将图像更改为 PNG 格式。

# javascript - 弹出窗口失去焦点

> ID：16156608
> 
> 赞同：0
> 
> 时间：2013-04-22T20:59:37.617
> 
> 标签：javascript, asp.net, vb.net, popup

我在 asp.net 页面上有一个打印预览按钮，该按钮打开一个新窗口，其中包含当前屏幕上的 pdf 版本，以便用户可以将其打印出来。但是，此窗口会失去焦点，因为父页面上的 iframe 在弹出页面加载后会自行刷新。有什么方法可以防止 iframe 刷新或将焦点恢复到弹出窗口？

下面是我用来打开新窗口的代码。

```
Dim url As String = "frmPrintPreview.aspx"
                btnPrintPreview.OnClientClick = "Javascript:window.open('" & url & "','printpreview','height=420,width=550,toolbar=yes,status=yes,scrollbars=yes,resizable=yes');" 
```

这是 iframe 的代码：

```
<iframe id="FrameLeft" runat="server" name="FrameLeft" scrolling="no" style="border-right: silver 1px inset;
                    border-top: silver 1px inset; z-index: 110; left: 603px; border-left: silver 1px inset;
                    width: 464px; border-bottom: silver 1px inset; position: absolute; top: 32px;
                    height: 675px" visible="false"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:23:36.797

尝试这个：

```
Dim url As String = "frmPrintPreview.aspx"
                btnPrintPreview.OnClientClick = "Javascript:var win = window.open('" & url & "','printpreview','height=420,width=550,toolbar=yes,status=yes,scrollbars=yes,resizable=yes'); setTimeout(win.focus, 0);" 
```

# extjs - Sencha TOUCH ListPaging 从现有商店发送参数

> ID：16156609
> 
> 赞同：0
> 
> 时间：2013-04-22T20:59:57.420
> 
> 标签：extjs, sencha-touch, sencha-touch-2, sencha-touch-2.1

您好，我有一个分页列表，我想在加载时发送一个参数，这个参数来自另一家商店。

```
Ext.define('WE3Chamados.store.Chamados', {
    extend: 'Ext.data.Store',
    config: {
        model: 'WE3Chamados.model.Chamado',
        autoLoad: false,
        proxy: {
            type: 'jsonp',
            url: 'http://XXX/chamados.php',
            callbackKey: 'callback',
            reader: {
                type: 'json',
                rootProperty : 'chamados',
                successProperty: 'success'
            }
        }
    }
}); 
```

像这样

```
login_store = Ext.getStore('Login');
param_to_send_default = login_store.getAt(0).data.cod_usuario; 
```

并将其作为默认参数发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:13:52.227

您可以使用对象的`extraParams`配置`proxy`：

```
proxy: {
    type: 'jsonp',
    ...
    extraParams: {
        param_to_send_default: Ext.getStore('Login').getAt(0).get('cod_usuario)
    }
} 
```

# java - 如何生成 5% 乱序文本文件

> ID：16156616
> 
> 赞同：-2
> 
> 时间：2013-04-22T21:00:08.600
> 
> 标签：java, sorting, random, integer

我和我的班级正在为 Java 编写一个编程任务，测试不同排序算法的运行时间。我们生成存储不同数量的随机生成整数的文本文件。大小为：100、1000、10 000、100 000、1 000 000。我能够在这些文件上正确运行排序算法，但不知道下一步该怎么做。

我们需要创建或修改这些文本文件，因此只有 5% 的随机整数不合适。我不能只移动最后的 5%，因为它必须均匀分布。此外，他说，在“打乱”这些文件时，不应再次移动已移出位置的整数，以防止将其移回原来的位置。任何人有任何想法我会如何做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:14:45.623

```
List<Integer> numbers = new ArrayList<Integer>();

int n = 100;
for (int i=0; i<n; i++) {
  numbers.add(i);
}
//The array is now 1, 2, 3, ..., 99, 100\. Critically, it is sorted.

List<Integer> disordered = new ArrayList<Integer>();
for (int i=0; i<n; i++) {
  if (Math.random() < 0.05) {
    // 5% chance of taking a number from numbers and adding it to disordered
    numbers.remove(i);
    disordered.add(i);
  }
}

while (!disordered.isEmpty()) {
  int x = disordered.remove(0); // Pick a number from disordered
  int position = Math.random()*numbers.size(); // Generate a random number in the domain of numbers
  numbers.add(position, x);
} 
```

我希望这就是您所说的“5% 故障”的意思。请注意，数字可能会显示在它们原来的位置，但不会移动两次。

# java - 如何在一个while循环中同时检查所有数组索引Java

> ID：16156622
> 
> 赞同：-3
> 
> 时间：2013-04-22T21:00:22.180
> 
> 标签：java, arrays, while-loop

我有一个大小为 5 的数组，如果任何索引都没有，我想从随机函数中分配值。

```
while(positionXtoStart==array1[0] || positionXtoStart==array1[1] || 
      positionXtoStart==array1[2] || positionXtoStart==array1[3] || 
      positionXtoStart==array1[4])
{    
    positionXtoStart = (rand1.nextInt(400) + 1)+30;  
} 
```

此解决方案适用于小尺寸数组，但如果我有大小为 1000 的数组，我无法在 while 循环中输入 1000 个条件。

我尝试了带有 if-else 条件的 For 循环，但问题是，我想同时检查**所有数组索引。**

> 请试着理解我在问什么。我想同时检查所有数组索引值**（一次）**。

在 For 循环中，我们一次只能检查一个值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:02:09.857

如果我理解正确，您只需要遍历数组，检查每个值。

```
for (int i = 0; i < array1.length; i++)
{
    if (array1[i] == positionXtoStart)
    {
         positionXtoStart = (rand1.nextInt(400) + 1)+30;

         break; // exit the loop
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:03:31.470

你在找这样的东西吗？

```
for(int i=0; i<array1.length; i++)
    if(array[i] == whatever)
    {
        // do stuff
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:06:58.273

如果您必须检查每个条目，则必须遍历整个数组。一个无序数组并不适合通过它进行搜索。也许您应该考虑将数据结构更改为 BST 之类的东西，这样您就可以保证 O(logn) 搜索。

要比较无序数组中的所有元素，您需要线性时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T21:43:44.443

不幸的是，你问的是不可能的。即使在您的代码中：

```
while(positionXtoStart==array1[0] || positionXtoStart==array1[1] || 
  positionXtoStart==array1[2] || positionXtoStart==array1[3] || 
  positionXtoStart==array1[4]) 
```

计算机一次检查一个条件。它并没有像您想象的那样一次完成所有条件。您发布的代码等同于 @Supericy 和 @Samiam 发布的代码。

除非有原因 forloops 不适用于您的情况，否则我会说使用此处发布的答案。

# c# - 将 XML 文件转换为使用 DataGridView 显示的数据集时如何跳过属性

> ID：16156623
> 
> 赞同：1
> 
> 时间：2013-04-22T21:00:23.107
> 
> 标签：c#, xml, linq-to-dataset

正如我的问题所述，

我有一个输出如下的 XML 文件：

```
<cme Type="Object" Class="cme">
<sId Type="String">1</sId>
<conc Type="Double">18,6511073619</conc>
  </cme>
<cme Type="Object" Class="cme">
<sId Type="String">2</sId>
<conc Type="Double">18,3226889524</conc>
</cme>
<cme Type="Object" Class="cme">
<sId Type="String">3</sId>
<conc Type="Double">4,7920021996</conc>
</cme>.... 
```

我在 Visual Studio 中创建了一个新表单，并添加了以下代码：

```
 cmDataSet.ReadXml(filePath,XmlReadMode.InferSchema);
        cmDataGrid.DataSource = cmDataSet;
        cmDataGrid.AutoGenerateColumns = true;
        cmDataGrid.DataMember = "cme"; <-- Parent Node 
```

但是当显示表单时，当行数与计数匹配时，单元格将填充属性值，而不是实际值，以这种方式：

```
Object  cme
Object  cme
Object  cme
Object  cme 
```

如何跳过评估属性以仅显示实际值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T22:04:38.043

我相信您需要为您的 xml 文件创建 xsd 架构。并添加`cmDataSet.ReadXmlSchema`对代码的调用：

```
cmDataSet.ReadXmlSchema(xsdFilePath);
cmDataSet.ReadXml(filePath, XmlReadMode.InferSchema);
cmDataGrid.DataSource = cmDataSet;
cmDataGrid.AutoGenerateColumns = false;
cmDataGrid.DataMember = "cme"; <-- Parent Node 
```

您需要模式，因为当前数据集将包含 3 个数据表`cme`：`sId`和`conc`. 这不是你要找的。

实际上，如果 xml 文件没有架构，则它与使用“尖括号分隔的文本”一样好且易于使用。

另一种方法是使用 LINQ to XML 并构造匿名对象（或创建强类型对象并映射到它）来表示您的数据网格行：

```
var doc = XDocument.Load(filePath);
var rows = doc.Root.Elements("cme")
.Select(e => new
{
    cId = e.Element("sId").Value,
    conc = e.Element("conc").Value
});

cmDataGrid.DataSource = rows.ToList();
cmDataGrid.AutoGenerateColumns = true; 
```

使用 LINQ 投影是显示数据的一种快速简便的方法，但在实施“添加/更新/编辑行”方案期间可能会浪费大量时间。

# c - 在C中返回一个没有指针的结构数组

> ID：16156624
> 
> 赞同：0
> 
> 时间：2013-04-22T21:00:24.080
> 
> 标签：c

我一直在独自完成 Kochan 的“Programming in C”第 3 版，为明年的研究生院做准备，但我第一次被困住了。我离指针还有一章，但是最近关于字符串的这一章末尾的练习有一个问题，我自己的研究似乎表明只能通过使用指针来解决。

问题与数据结构有关`entry`：

```
struct entry {
    char word[15];
    char definition[50];
}; 
```

我们创建一个条目数组：

```
struct entry dictionary[10] = 
{{"aardvark", "a burrowing African mammal"},
 {"abyss", "a bottomless pit"},
 {"addle", "to become confused"},
 {"aerie", "a high nest"},
 {"ajar", "partially opened"},
 {"acumen", "mentally sharp; keen"},
 {"affix", "to append; attach"},
 {"agar", "a jelly made from seaweed"},
 {"ahoy", "a nautical call of greeting"},
 {"aigrette", "an ornamental cluster of feathers"}}; 
```

提示内容为：“编写一个名为的函数`dictionary_sort`，将字典按照[上面]的定义按字母顺序排序。”

我知道与函数有关的结构和数组有一些微妙之处，以及函数如何将它们作为参数或将它们作为返回值返回。对我来说似乎有意义的唯一方法是返回一个结构，或者特别是一个结构数组，但我认为我在这里没有正确应用它：

```
struct entry dictionary_sort(struct entry dictionary) 
```

总的来说，我当前的程序版本如下：

```
#include <stdio.h>
#include <stdbool.h>

struct entry {
    char word[15];
    char definition[50];
};

// Function to compare two character strings

int compare_strings(const char s1[], const char s2[])
{
    int i = 0, answer; 

    while (s1[i] == s2[i] && s1[i] != '\0' && s2[i] != '\0')
        i++;

    if (s1[i] < s2[i])
        answer = -1; // s1 < s2
    else if (s1[i] == s2[i])
        answer = 0; // s1 == s2
    else
        answer = 1; // s1 > s2

    return answer;
}

// Function to sort a dictionary structure

struct entry dictionary_sort(struct entry dictionary[])
{
    int dictionary_length = sizeof(dictionary) / sizeof(dictionary[0]);
    int i, j, minimum;
    struct entry temp;

    for (i = 0; i < dictionary_length; i++) {
        minimum = i;
        for (j = i + 1; j < dictionary_length; j++) {
            if (compare_strings(dictionary[j].word, 
                                dictionary[minimum].definition) == -1)
                minimum = j;
        }
        temp = dictionary[minimum];
        dictionary[minimum] = dictionary[i];
        dictionary[i] = dictionary[minimum];
    }

    return dictionary;
}

int main(void)
{
    struct entry dictionary[10] =
    {{"aardvark", "a burrowing African mammal"},
     {"abyss", "a bottomless pit"},
     {"addle", "to become confused"},
     {"aerie", "a high nest"},
     {"ajar", "partially opened"},
     {"acumen", "mentally sharp; keen"},
     {"affix", "to append; attach"},
     {"agar", "a jelly made from seaweed"},
     {"ahoy", "a nautical call of greeting"},
     {"aigrette", "an ornamental cluster of feathers"}};
    int i, dictionary_length = sizeof(dictionary) / sizeof(dictionary[0]);

    dictionary = dictionary_sort(dictionary);

    for (i = 0; i < dictionary_length; i++)
        printf("%s - %s.\n", dictionary[i].word, dictionary[i].definition);

    return 0;
} 
```

字符串比较函数的行为与预期一样，因为它只返回一个整数。我真的不知道如何在不了解指针的情况下拥有所需的功能。有足够多的*带有*指针的示例可供查找，但我很好奇我在这里缺少什么基本原则，因为我觉得书中的其他所有内容对我来说都非常自然。

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:06:12.800

你根本不需要返回任何东西，你甚至不需要显式指针，这些都不需要。就地排序，不要重新发明轮子：使用`strcmp()`和`qsort()`（[现场演示](http://ideone.com/BstOez)）：

```
struct entry dictionary[] = {
    { "def", "second entry" },
    { "abc", "first entry" },
    { "ghi", "third entry" },
    { "mno", "fifth entry" },
    { "jkl", "fourth entry" }
};

int compare_entry(const void *l, const void *r)
{
    const struct entry *ll = l;
    const struct entry *rr = r;
    return strcmp(ll->word, rr->word);
}

#define COUNT(x) (sizeof(x) / sizeof(x[0]))

qsort(dictionary, COUNT(dictionary), sizeof(dictionary[0]), compare_entry); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T19:11:09.940

虽然并不完美并且仍然需要明确定义指针，但这个答案在问题和本书的范围内，而不仅仅是调用库。

```
#include <stdio.h>
#include <stdbool.h>

struct entry {
    char word[15];
    char definition[50];
};

// Function to compare two character strings

int compare_strings(const char s1[], const char s2[])
{
    int i = 0, answer; 

    while (s1[i] == s2[i] && s1[i] != '\0' && s2[i] != '\0')
        i++;

    if (s1[i] < s2[i])
        answer = -1; // s1 < s2
    else if (s1[i] == s2[i])
        answer = 0; // s1 == s2
    else
        answer = 1; // s1 > s2

    return answer;
}

// Function to sort a dictionary structure

void dictionary_sort(struct entry *dictionary, int dictionary_length)
{
    int i, j, minimum;
    struct entry temp;

    for (i = 0; i < dictionary_length - 1; i++) {
        minimum = i;
        for (j = i + 1; j < dictionary_length; j++) {
            if (compare_strings(dictionary[j].word, 
                                dictionary[minimum].word) == -1)
                minimum = j;
        }
        temp = dictionary[minimum];
        dictionary[minimum] = dictionary[i];
        dictionary[i] = temp;
    }
}

// Prints the dictionary in its current state

void print_dictionary(struct entry *dictionary, int dictionary_length)
{
    int i;

    for (i = 0; i < dictionary_length; i++) {
        printf("%s - %s.\n", dictionary[i].word, dictionary[i].definition);
    }
}

// Demostrates the dictionary_sort function

int main(void)
{
    struct entry dictionary[10] =
    {{"aardvark", "a burrowing African mammal"},
     {"abyss", "a bottomless pit"},
     {"addle", "to become confused"},
     {"aerie", "a high nest"},
     {"ajar", "partially opened"},
     {"acumen", "mentally sharp; keen"},
     {"affix", "to append; attach"},
     {"agar", "a jelly made from seaweed"},
     {"ahoy", "a nautical call of greeting"},
     {"aigrette", "an ornamental cluster of feathers"}};

    int i, dictionary_length = sizeof(dictionary) / sizeof(dictionary[0]);

    print_dictionary(&dictionary, dictionary_length);
    printf("\nSorting...\n\n");
    dictionary_sort(&dictionary, dictionary_length);
    print_dictionary(&dictionary, dictionary_length);
    printf("\n");

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:04:39.747

当你用 声明一个函数参数时`[]`，你已经使用了指针。函数定义

```
int compare_strings(const char s1[], const char s2[]) 
```

在功能上与

```
int compare_strings(const char *s1, const char *s2) 
```

与 相同`struct entry dictionary_sort(struct entry dictionary[])`。

由于您获得了指向`struct entry`参数的指针`dictionary`，因此也`return dictionary`返回了*指向*的指针`struct entry`。

而且您所做的所有更改`dictionary`都已经在外部可见，因为您修改了数组本身而不是某个本地数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T21:11:19.903

像这样的语句`"Returning an array of structs without pointers in C"`在 C 中是一个悖论，因为在 C 中传递或返回数组的唯一方法是通过指针。即使看起来像`char *foo(char arr_demo[]){}`在传递数组之类的东西，本质上它是一个被传递的指针，因为它减少到`char *foo(char *arr_demo){}`.

# java - 如何将文件从 Hadoop 集群复制到本地文件系统

> ID：16156627
> 
> 赞同：1
> 
> 时间：2013-04-22T21:00:39.490
> 
> 标签：java, hadoop, mapreduce, hdfs

## **设置：**

我有一个 map-reduce 工作。在映射器类（显然在集群上运行）中，我有一个类似这样的代码：

```
try {
.
.
.
} catch (<some exception>) {
    // Do some stuff
} 
```

## **我想改变的：**

在 catch{} 子句中，我想将日志从集群复制到本地文件系统

## **问题：**

如果我从命令行检查，我可以在节点上的目录中看到日志文件。但是当我尝试使用 org.apache.hadoop.fs.FileSystem.copyToLocalFile(boolean delSrc, Path src, Path dst) 复制它时，它说该文件不存在。

谁能告诉我我做错了什么？我对 Hadoop 很陌生，所以我可能遗漏了一些明显的东西。如果需要，请询问我任何澄清问题，因为我不确定我是否提供了所有必要的信息。

谢谢

**编辑 1:** : 由于我试图将文件从集群复制到本地并且 java 代码也在集群上运行，我什至可以使用`copyToLocalFile()`吗？还是我需要做一个简单的`scp`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:28:21.307

MapReduce 日志文件通常位于运行 Map/Reduce 程序的数据节点的本地文件系统路径 HADOOP_LOG_DIR/userlogs/mapOrReduceTask 上。每个 MapReduce 程序都会在上述目录中生成 syslog/stdout/stderr。

使用任务跟踪器的 Web UI 查看本地日志文件会更容易，或者您可以通过 ssh 连接到机器并查看上述目录中的日志。

默认情况下，任务跟踪器 Web UI URL 是`http://machineName:50060/`

# android - 用于在 android 系统/应用程序中搜索 .odex 文件是否存在的批处理文件

> ID：16156628
> 
> 赞同：0
> 
> 时间：2013-04-22T21:00:40.860
> 
> 标签：android, search, if-statement, batch-file, find

我正在处理一个大型批处理文件，并且有一小部分需要帮助。我想做以下事情。对于 \mod 文件夹中的每个 *.apk，在手机 /system/app 中搜索 mod 中文件名的 .odex 版本。打印它是否存在。以下是我到目前为止的代码。如果我删除 for 语句并输入 apkname 而不是变量，它将起作用。但是一旦我添加了 for 行，它总是返回一个大于 1 的错误级别，所以它总是说它存在，不管它是否存在。非常感谢您的帮助。

```
SETLOCAL ENABLEDELAYEDEXPANSION
for /r "%~dp0"\mod %%f in (*.apk) DO (
set apkname=%%~nf
set mobile_path=/system/app
adb shell ls %mobile_path% | find /c "!apkanme!.odex" >NUL
if %ERRORLEVEL% == 0 (
    echo the file exists
) else (
    echo the file does not exist
)
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:04:56.543

你有一些错误和一些错别字，试试这个：

```
@echo off &SETLOCAL ENABLEDELAYEDEXPANSION
for /r "%~dp0\mod" %%f in (*.apk) DO (
    set "apkname=%%~nf"
    set "mobile_path=\system\app"
    adb shell ls !mobile_path! | find /i "!apkname!.odex" >NUL
    if !ERRORLEVEL! equ 0 (echo the file exists) else echo the file does not exist
) 
```

顺便提一句。我知道批次，不是`adb`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:21:50.130

工作批次部分的最终结果如下。@echo off 已在批处理文件的另一部分中设置。

```
SETLOCAL ENABLEDELAYEDEXPANSION
for /r "%~dp0"\mod %%f in (*.apk) DO (
    set apkname=%%~nf
    set mobile_path=/system/app
    adb shell ls !mobile_path! | find /c "!apkname!.odex" >NUL
    if !ERRORLEVEL! == 0 (
        echo the file exists
    ) else (
        echo the file does not exist
    )
) 
```

# mysql - php mySQL 检查行是否与对象类匹配的可靠方法

> ID：16156631
> 
> 赞同：0
> 
> 时间：2013-04-22T21:00:54.860
> 
> 标签：mysql, sql, database

我正在寻找一种可靠的方法来检查数据库条目是否与 php.ini 中的等效对象类匹配。

我目前的方法不可靠，我希望有人能提供更好的解决方案。

我目前的解决方案似乎大部分时间都有效，但在大约 600 个条目中，我会随机返回大约 5 个误报条目。

这是我使用的简化对象类

```
 class MemberData
{
     public $AccountID;
     public $AccountName;
     public $Website;
} 
```

然后我使用反射循环遍历类中的每个属性并以以下形式构建我的查询字符串：

```
SELECT 1 WHERE `Property1` = value1 AND `Property2` = value2 AND `Property3` = value3 
```

但是，就像我提到的那样，我的代码仅在大多数情况下才有效，并且我无法确定为什么我会误报的常见链接。它看起来是随机的。

下面是我的全部功能。

```
//Pass in a member class and see if there is a matching database entry
function SqlDoRowValuesMatch($memberData)
{
    //declare global vars into this scope
    global $host, $user, $password, $dbname, $tableName;    

    //initiate the connection using mysqli
    $databaseConnection = new mysqli($host, $user, $password, $dbname);

    if($databaseConnection->connect_errno > 0)
    {
        die('Unable to connect to database [' . $databaseConnection->connect_error . ']');
    }

    //Get all the properties in the MemberData Class
    //Using Reflection
    $reflect = new ReflectionClass($memberData);
    $props = $reflect->getProperties(ReflectionProperty::IS_PUBLIC);

    //Build the query string
    $sql =  "SELECT 1 FROM `".$tableName."` WHERE ";

    foreach($props as $prop)
    {
        if(!is_null($prop->getValue($memberData)))
        {                       
            $sql = $sql.$prop->getName()."=".addSingleQuotes(addslashes($prop->getValue($memberData)))." AND ";                 
        }
    }

    //Cut Trailing operator
    $sql = rtrim($sql, " AND ");    

    if(!$result = $databaseConnection->query($sql))
    {
            die('There was an error creating [' . $databaseConnection->error . ']');
    }

    $databaseConnection->close();

    //Check for a value of 1 to indicate that a match was found
    $rowsMatch = 0;

    while($row = $result->fetch_assoc())
    {       
        foreach($row as $key => $value)
            {
                if($value == 1)
                {
                    $rowsMatch = 1;
                    break;
                 }
            }
    }   

    return $rowsMatch;  //0 = false, 1 = true
} 
```

# android - 为什么 GPS 提供商在设备无法访问天空时返回位置更新？

> ID：16156632
> 
> 赞同：0
> 
> 时间：2013-04-22T21:00:56.397
> 
> 标签：android, gps

我在 Samsung Galaxy Tab 2 (Android 4.0.3) 上测试了我的应用程序，发现了奇怪的行为。

位置提供者和启用的网络和 GPS。当应用程序获得`onLocationChanged`更新时，一些`Location`报告来自网络提供商，一些来自 GPS 提供商。

奇怪的是，我把平板电脑放在离最近的窗户大约 3 米的地方。据我所知，在这种情况下，GPS 应该无法调谐到 GPS 卫星。那么为什么 GPS 提供商会返回正确的`Location`更新呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:04:01.573

对于一个好的 GPS 天线来说，距离窗口 3m 是没有问题的，可以接收一个（坏的）位置。所以你描述的情况不是有保证的 GPS 屏蔽。

# core-data - 未在 UIManagedDocument 上创建 NSPersistentStoreCoordinator

> ID：16156637
> 
> 赞同：1
> 
> 时间：2013-04-22T21:01:02.923
> 
> 标签：core-data, icloud, uimanageddocument, nspersistentstore

我开始了解`UIManagedDocument`它的能力。据我了解，它是一种存储在文档目录中某个位置的数据库形式。

无论如何，我试图将它用作数据库，通过将数据存储在其中`NSManagedObjectContext`但是，在创建`UIManagedDocument`数据并将数据保存到其上下文几秒钟后（在我猜测超时之后），应用程序崩溃并告诉我没有持久的存储协调器。

Apple 文档上似乎没有太多关于如何在创建托管文档后创建持久存储协调器的指导。

我该怎么做？

谢谢！

***编辑***

我正在使用的代码：

```
NSURL *url = [[self iCloudDocumentsURL] URLByAppendingPathComponent:nameOfDocument];

NSMutableArray *books = [self.books mutableCopy];
[books addObject:url];

[self setBooks:books];

UIManagedDocument *document = [[UIManagedDocument alloc] initWithFileURL:url];

NSDictionary *options = @{ NSMigratePersistentStoresAutomaticallyOption : @YES,
                           NSInferMappingModelAutomaticallyOption : @YES,
                           NSPersistentStoreUbiquitousContentNameKey : document.fileURL.lastPathComponent,
                           NSPersistentStoreUbiquitousContentURLKey : [self iCloudCoreDataLogFilesURL] };
[document setPersistentStoreOptions:options];

if (document.documentState == UIDocumentStateClosed) {
    [document openWithCompletionHandler:^(BOOL success) {
        Book *book = [Book newBookWithTitle:bookTitle
                     inManagedObjectContext:document.managedObjectContext];

        [document updateChangeCount:UIDocumentChangeDone];
    }];
} 
```

***更新***

在后台线程上执行此代码后。打开文档后，我的应用程序仍会在完成处理程序上成功记录“否”。但是，我的应用程序没有崩溃，而是得到以下日志：

```
2013-04-23 00:01:08.381 Notable[193:4b0b] -[_PFUbiquityRecordsImporter rollResponseOperation:encounteredAnError:whileTryingToAdoptBaseline:](1545): CoreData: Ubiquity:  <PFUbiquityBaselineRollResponseOperation: 0x1fa561d0> localPeerID: mobile.2DDB96C5-A317-5BE5-8F29-9F5E6681A27A, storeName: A-B893A0AB-B764-42F1-9402-38790DCEF96B, modelVersionHash: NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=
    ubiquityRootLocation: <PFUbiquityLocation: 0x1e59b790>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs

Encountered an error while trying to respond to the roll of baseline: <PFUbiquityBaseline: 0x1e54deb0>(0)
    permanentLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip
    safeLocation: <PFUbiquityLocation: 0x1f8eb1b0>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/mobile.2DDB96C5-A317-5BE5-8F29-9F5E6681A27A
    currentLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip

    storeName: A-B893A0AB-B764-42F1-9402-38790DCEF96B
    modelVersionHash: NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=
    baselineArchiveLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip

Error: Error Domain=NSCocoaErrorDomain Code=134310 "The operation couldn’t be completed. (Cocoa error 134310.)" UserInfo=0x1f8d2ae0 {baseline=<PFUbiquityBaseline: 0x1e54deb0>(0)
    permanentLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip
    safeLocation: <PFUbiquityLocation: 0x1f8eb1b0>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/mobile.2DDB96C5-A317-5BE5-8F29-9F5E6681A27A
    currentLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip

    storeName: A-B893A0AB-B764-42F1-9402-38790DCEF96B
    modelVersionHash: NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=
    baselineArchiveLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip
, localStoreKV=<PFUbiquityKnowledgeVector: 0x1f8220c0> ()}
userInfo: {
    baseline = "<PFUbiquityBaseline: 0x1e54deb0>(0)\n\tpermanentLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip\n\tsafeLocation: <PFUbiquityLocation: 0x1f8eb1b0>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/mobile.2DDB96C5-A317-5BE5-8F29-9F5E6681A27A\n\tcurrentLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip\n\n\tstoreName: A-B893A0AB-B764-42F1-9402-38790DCEF96B\n\tmodelVersionHash: NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=\n\tbaselineArchiveLocation: <PFUbiquityLocation: 0x1f8e7120>: /private/var/mobile/Library/Mobile Documents/my~app~identifier/Logs/.baseline/A-B893A0AB-B764-42F1-9402-38790DCEF96B/NK3BysbustJxxyi2O8bX8eof15YimkUnegxqX6HDkas=/baseline.zip\n";
    localStoreKV = "<PFUbiquityKnowledgeVector: 0x1f8220c0> ()";
} 
```

此方法还创建一个“DocumentMetaData.plist”（根据我在评论中提到的 CS193P 视频中提到的这些文件，我认为这是必要的）而不是一个名为“persistentStore”的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-07T11:30:57.170

不确定您是否曾经修复过此 Adam，但您的 persistentStore 不应该在云端。始终在本地存储中创建 uiManagedDocument，并为 addPersistentStore 设置 iCloud 选项。CoreData 将提供一个即时存储供您的应用程序在构建真实版本时使用，并从 iCloud 获取任何数据（如果有）。完成后，它会将您切换到本地的 iCloud 连接商店。只有交易日志会发布到 iCloud，但这是在幕后为您完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T22:19:34.853

使用 UIManagedDocument 时，您不应该自己创建它——这会发生在您身上。*但是*在实践中它并不那么可靠。在内部，UIManagedDocument 设置持久存储和持久存储协调器。**但这**不会发生，直到底层 iCloud 代码完成其动作、与服务器通信、下载任何新数据等。与此同时，您无法保存更改，因为在此过程完成之前，无处保存这些变化。

此外，有时 iCloud 会无缘无故地无法协调行动，这在您的控制之下。

您可能需要检查`success`打开完成处理程序中的值。如果是`NO`，你有点卡住了。当 iCloud 崩溃时，没有恢复路径，除非*有时*如果你很幸运，你可以再试几次，直到它起作用。请提交错误，我们需要 Apple 来解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:16:00.260

[UIDocument Class Reference](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIManagedDocument_Class/Reference/Reference.html)和[Core Data Programming Guide](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdUsingPersistentStores.html#//apple_ref/doc/uid/TP40006453-SW2)中有示例代码。您还可以通过使用 Master-Detail 模板创建基于 Core Data 的项目来查看 Core Data 堆栈设置的示例。

如果这是您第一次接触 Core Data，我建议您阅读有关该主题的书籍，要么是*Core Data for iOS*，作者 Tim Isted 和 Tom Harrington，要么是*Core Data (2nd edition): Data Storage and Management for iOS 、OS X 和 iCloud*，作者：Marcus Zarra。

我看到一些看起来很奇怪的事情：

*   是否`[self iCloudDocumentsURL]`指向本地文件系统？

*   为什么将 URL 插入到书籍数组中？

*   `success`在假设打开成功之前测试块中的变量。

即使在 iOS 6.x 中，iCloud Core Data 也没有准备好迎接黄金时间。这当然不是新的 iOS 开发者想要解决的问题。看看 Black Pixel 非常聪明的人对他们自己的产品之一的评价：http: [//blackpixel.com/blog/2013/03/the-return-of-netnewswire.html](http://blackpixel.com/blog/2013/03/the-return-of-netnewswire.html)。

# android - Android - 如何将标签的文本与其轴对齐？

> ID：16156643
> 
> 赞同：1
> 
> 时间：2013-04-22T21:01:26.190
> 
> 标签：android, graph, axis, achartengine, axis-labels

我正在使用 chartengine。我不知道如何将标签的文本与其轴对齐。在某些屏幕上，文本以轴为中心；在其他屏幕上，它们位于轴的底部或顶部。

有没有办法将它们全局放在轴的中心？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T22:55:00.520

我认为您可以使用以下内容：

```
mRenderer.setYLabelsAlign(Align.LEFT, 0) 
```

如果要在网格右侧设置对齐，只需设置 Align.LEFT，这意味着它们在左侧对齐。

阅读这两个线程可能会更清楚：[Android AChartEngine - Unable to change textColor of Y-Axis Labels](https://stackoverflow.com/questions/11893870/android-achartengine-unable-to-change-textcolor-of-y-axis-labels)和[AChartEngine : Align Y-Axis Labels on the right side of Axis itself](https://stackoverflow.com/questions/14546816/achartengine-align-y-axis-labels-on-right-side-of-axis-itself)

希望能帮助到你。

# python - SQLAlchemy __init__ 没有运行

> ID：16156650
> 
> 赞同：11
> 
> 时间：2013-04-22T21:01:46.967
> 
> 标签：python, sqlalchemy

我有以下代码：

```
session = scoped_session(sessionmaker(autocommit=False, autoflush=True, bind=engine))

Base = declarative_base()
Base.query = session.query_property()

class CommonBase(object):
  created_at = Column(DateTime, default=datetime.datetime.now)
  updated_at = Column(DateTime, default=datetime.datetime.now, onupdate=datetime.datetime.now)

class Look(Base, CommonBase):
  __tablename__ = "looks"
  id = Column(Integer, primary_key=True)

  def __init__(self):
    print "__init__ is run"
    Base.__init__(self)
    self.feedback = None

  def set_feedback(self, feedback):
    """Status can either be 1 for liked, 0 no response, or -1 disliked.
    """
    assert feedback in [1, 0, -1]
    self.feedback = feedback

  def get_feedback(self):
    return self.feedback 
```

我收到以下错误：

```
Traceback (most recent call last):
  File "/Volumes/Data2/Dropbox/projects/Giordano/venv/lib/python2.7/site-packages/flask/app.py", line 1701, in __call__
    return self.wsgi_app(environ, start_response)
  File "/Volumes/Data2/Dropbox/projects/Giordano/venv/lib/python2.7/site-packages/flask/app.py", line 1689, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "/Volumes/Data2/Dropbox/projects/Giordano/venv/lib/python2.7/site-packages/flask/app.py", line 1687, in wsgi_app
    response = self.full_dispatch_request()
  File "/Volumes/Data2/Dropbox/projects/Giordano/venv/lib/python2.7/site-packages/flask/app.py", line 1360, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Volumes/Data2/Dropbox/projects/Giordano/venv/lib/python2.7/site-packages/flask/app.py", line 1358, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Volumes/Data2/Dropbox/projects/Giordano/venv/lib/python2.7/site-packages/flask/app.py", line 1344, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/Volumes/Data2/Dropbox/projects/Giordano/src/giordano/web/backend.py", line 94, in wrapped
    ret = f(*args, **kwargs)
  File "/Volumes/Data2/Dropbox/projects/Giordano/src/giordano/web/backend.py", line 81, in decorated
    return f(*args, **kwargs)
  File "/Volumes/Data2/Dropbox/projects/Giordano/src/giordano/web/backend.py", line 187, in next
    json_ret = ge.encode(results)     # automatically pulls the tags
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py", line 201, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py", line 264, in iterencode
    return _iterencode(o, 0)
  File "/Volumes/Data2/Dropbox/projects/Giordano/src/giordano/__init__.py", line 54, in default
    jsonable = self.convert_to_jsonable(obj)
  File "/Volumes/Data2/Dropbox/projects/Giordano/src/giordano/__init__.py", line 40, in convert_to_jsonable
    image_url=obj.image_url, feedback=obj.get_feedback())
  File "/Volumes/Data2/Dropbox/projects/Giordano/src/giordano/models.py", line 100, in get_feedback
    return self.feedback
AttributeError: 'Look' object has no attribute 'feedback' 
```

在我看来，我的`__init__`方法没有运行，因为我在日志中看不到任何打印语句。

有人可以解释为什么我`__init__`没有运行，我该怎么做？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-22T21:38:02.460

查看[有关重建的 SQLAlchemy 文档](http://docs.sqlalchemy.org/en/latest/orm/constructors.html)：

> `__init__`从数据库行重新创建对象时，SQLAlchemy ORM 不会调用。ORM 的过程有点类似于 Python 标准库的 pickle 模块，调用低级`__new__` 方法，然后直接在实例上悄悄恢复属性，而不是调用`__init__`.
> 
> 如果您需要在数据库加载实例准备好使用之前对其进行一些设置，您可以使用 @reconstructor 装饰器将方法标记为`__init__`. SQLAlchemy 将在每次加载或重建您的一个实例时不带参数地调用此方法。这对于重新创建通常在您的 中分配的瞬态属性很有用`__init__`：

```
from sqlalchemy import orm

class MyMappedClass(object):
    def __init__(self, data):
        self.data = data
        # we need stuff on all instances, but not in the database.
        self.stuff = []

    @orm.reconstructor
    def init_on_load(self):
        self.stuff = [] 
```

> 当执行 obj = MyMappedClass() 时，Python`__init__` 正常调用该方法并且需要 data 参数。在查询操作期间加载实例时，如在 query(MyMappedClass).one() `init_on_load`中调用。

# php - 为上传的文件和数据库添加时间

> ID：16156654
> 
> 赞同：1
> 
> 时间：2013-04-22T21:01:53.400
> 
> 标签：php, mysql

我正在向我的网站添加文件上传系统，但我似乎无法让文件链接与生成的文件名相匹配。我在文件名的前面添加了一个时间函数以使其唯一（它根据时间生成一个数字）。它确实这样做了，但由于某种原因，该唯一名称没有保存在数据库中。有人可以帮我解决这个问题吗？

```
//This is the directory where images will be saved 
 $target = "files/"; 
 $target = $target. time(). basename( $_FILES['photo']['name']); 
 echo $target;

//postThis gets all the other information from the form 
 $tfid=$_POST['tfid']; 
 $fname=$_POST['fname']; 
 $lname=$_POST['lname']; 
 $hca=$_POST['hca'];
 $file=($_FILES['photo']['name']);

//Writes the information to the pic table 
 mysql_query("INSERT INTO pic
(tfid, file) 
VALUES ('$tfid', '$file')")
or die(mysql_error());
ECHO "<strong>pic table has been saved.<br></strong>";

//Writes the photo to the server 
if(move_uploaded_file($_FILES['photo']['tmp_name'], $target)) 
{ 

//Tells you if its all ok 
echo "<strong>The file has been uploaded</strong>"; 
 } 
else { 

  //Gives an error if its not 
 echo "<strong>Sorry, there was a problem uploading your file.</strong>"; 
 } 
 echo '<br>';
require 'insertbuttons.php'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:14:47.140

我明白现在发生了什么。对评论感到抱歉。您需要将`$target`变量保存在数据库中。发布的变量与目标不匹配。因此，在`$file`您的 SQL 语句中，您可能会想要`$target`。这应该给你文件的名称，但没有它看起来像的扩展名。

# r - Twitter 的 API v1.1 需要 OAuth 身份验证

> ID：16156656
> 
> 赞同：2
> 
> 时间：2013-04-22T21:01:56.703
> 
> 标签：r, twitter, twitter-oauth, rstudio

我正在将我的第一个推文加载到 Rstudio 以练习一些文本挖掘。我正在使用**twitterR**包（带有**Rcurl**）。

我的代码是：`rdmTweets <- searchTwitter("#beer", n=500)`

但我得到：

```
Error in twInterfaceObj$doAPICall(cmd, params, "GET", ...) : 
  OAuth authentication is required with Twitter's API v1.1 
```

我有几次谷歌错误，但似乎没有得到任何有用的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-26T16:46:27.267

看看[这里](https://stackoverflow.com/questions/17964444/unauthorized-error-with-roauth/19328951#19328951)。我以这种方式解决了同样的问题。

最好的，

# php - 第一行文本的 PHP 单引号正则表达式

> ID：16156657
> 
> 赞同：0
> 
> 时间：2013-04-22T21:01:56.550
> 
> 标签：php, regex, mediawiki-api

我有一个 wiki 网站 (MediaWiki)，我需要从每个 wiki 文章页面的第一行中提取一些纯文本。每个 wiki 文章页面的第一行都有我想要的文本，但文本位于 wiki 标记标签内，例如：

```
$text = "Text that I DO NOT want '''Text that I do want, inside wiki tags''' text that I DO NOT want"; 
```

我已经找到了 PHP 正则表达式来获取文本到第一行的末尾：

```
if(preg_match("/^.*/", $text, $match)){
  echo "<br>This is the text in the first line of the wiki article page: ".$match[0];
} 
```

我需要将`/^.*/`上面的表达式与 PHP 正则表达式结合起来，以仅查找`'''`wiki 标记内的文本。我在这样做时遇到了麻烦。有人可以帮我弄这个吗？另外我如何转义`'''`单引号？
感谢你的帮助。

彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:05:35.383

尝试这个：

```
$parts = explode("'''",$text,3);
$part_you_want = $parts[1]; 
```

这比使用正则表达式便宜得多，并且希望也能减少混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T00:11:47.040

尝试这个：

```
$text = "Text that I DO NOT want '''Text that I do want, inside wiki tags''' text that I DO NOT want";
if(preg_match("/'''(.*)'''/", $text, $match)){
  echo "<br>This is the text in the first line of the wiki article page: ".$match[1];
} 
```

# c# - C# 将文件上传到 Filezilla 服务器 (XAMPP) 错误：无法在传输连接上写入数据

> ID：16156658
> 
> 赞同：1
> 
> 时间：2013-04-22T21:01:57.450
> 
> 标签：c#

我正在尝试使用 FTP 将文件上传到我的服务器（我使用 xampp 构建了它，因此它具有 Apache 和 FileZilla 服务器）。

AC# 应用程序运行良好几个小时然后我得到这个异常并且应用程序停止上传文件。

（我保持连接有效。代码已调试且一致。我在其他机器上使用 xampp 进行了一些测试并遇到了同样的问题。）

这是返回的消息：

```
System.Net.WebException: Eccezione durante una richiesta WebClient. ---> System.IO.IOException: Impossibile scrivere dati sulla connessione di trasporto: Connessione in corso interrotta forzatamente dall'host remoto. ---> System.Net.Sockets.SocketException: Connessione in corso interrotta forzatamente dall'host remoto
in System.Net.Sockets.Socket.Send(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
in System.Net.Sockets.NetworkStream.Write(Byte[] buffer, Int32 offset, Int32 size)
--- Fine dell'analisi dello stack dell'eccezione interna ---
in System.Net.Sockets.NetworkStream.Write(Byte[] buffer, Int32 offset, Int32 size)
in System.Net.FtpDataStream.Write(Byte[] buffer, Int32 offset, Int32 size)
in System.Net.WebClient.UploadBitsState.WriteBytes()
in System.Net.WebClient.UploadBits(WebRequest request, Stream readStream, Byte[] buffer, Byte[] header, Byte[] footer, CompletionDelegate completionDelegate, AsyncOperation asyncOp)
in System.Net.WebClient.UploadFile(Uri address, String method, String fileName)
--- Fine dell'analisi dello stack dell'eccezione interna ---
in System.Net.WebClient.UploadFile(Uri address, String method, String fileName) 
```

# jdeveloper - 如何将jdeveloper序列图导出为任意图像格式？

> ID：16156667
> 
> 赞同：0
> 
> 时间：2013-04-22T21:02:17.920
> 
> 标签：jdeveloper, sequence-diagram

晚上好，我在 jdeveloper 上制作了一个序列图，我想将它导出为任何图像格式而不是 .sequence 扩展名，有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-05T20:34:49.120

在 JDeveloper 11.1.2.4 中，右键单击图表并选择发布图表或在菜单中选择图表，然后选择发布图表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:19:27.443

您还可以为项目生成文档并以 HTML 格式获取图表。从构建菜单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T08:51:55.113

如果不知道您使用的是什么版本的 JDeveloper，很难为您提供帮助。一般来说，您可以在 JDeveloper 中右键单击图表并选择 Publish Diagram 选项，在出现的对话框中，您可以使用多种文件格式将图表另存为。

# silverlight - Silverlight 应用程序跨 Web 应用程序访问文件——clientaccesspolicy.xml 要求登录

> ID：16156670
> 
> 赞同：1
> 
> 时间：2013-04-22T21:02:28.767
> 
> 标签：silverlight, sharepoint, iis, sharepoint-2010

在 SharePoint 2010 中，我有一个在 WebApp1 上运行的 Silverlight 应用程序，它访问 WebApp2 上的文件。

每次发生这种情况时，我都会看到一个登录窗口弹出来提供访问 WebApp2 的凭据。在提琴手中，我可以看到这是在`401`响应尝试访问`ClientAccessPolicy.xml`WebApp2 之后发生的

输入凭据后，我不再看到登录窗口，但一旦我的会话到期，系统就会再次提示我输入。

我以管理员身份登录该框，并且我是 WebApp1 和 WebApp2 的域管理员。

我已经检查了文件夹和项目权限，`ClientAccessPolicy.xml`并且“每个人”至少具有读取权限。我也尝试过给自己明确的完全控制权限。

**我怎样才能让它停止提示我？**

除了将 WebApp1 和 WebApp2 的完全限定 URL 添加到 IE9 中的“受信任站点”之外，我还使用了大量 IIS 安全设置（IIS 范围的身份验证、站点级身份验证、IIS 管理器权限......），我设置`User Authentication`的地方`Automatic logon with current user name and password`

# php - 如何从 php 中的 SQL 时间日期格式获取时间间隔

> ID：16156673
> 
> 赞同：0
> 
> 时间：2013-04-22T21:02:39.043
> 
> 标签：php, sql, datetime

我从数据库中获得两个时间间隔，例如：

`PickUpDateTime = "2013-4-20 12:00:00"` 和`returndatetime ="2013-4-20 14:00:00"`。

如何在 PHP 中找到这两次之间的时间间隔？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:08:24.507

我想你可以使用[Mysql TIMESTAMPDIFF](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_timestampdiff)：

```
SELECT TIMESTAMPDIFF(SECOND, returndatetime, pickUpDateTime) as diffInSeconds FROM table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:09:09.687

您可以使用 strtotime 将它们转换为时间戳。然后减/除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:10:56.630

将 转换为秒，然后减去。

```
$date1 = strtotime($mysqldate1);
$date2 = strtotime($mysqldate2);
$diff_in_seconds = abs($date1 - $date2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T21:06:27.730

我会使用`TIMEDIFF()`mysql 函数

[https://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_timediff](https://dev.mysql.com/doc/refman/4.1/en/date-and-time-functions.html#function_timediff)

# php - date() 类在我的日期格式中添加换行符

> ID：16156675
> 
> 赞同：1
> 
> 时间：2013-04-22T21:02:39.787
> 
> 标签：php, html, css

我正在格式化我的日期以显示在我的网站的消息传递程序的表格中。
它在日期中添加换行符。因此，例如它应该显示为

2013 年 4 月 16 日，星期二

但它在表格中显示为这样。

周二，

16

四月

2013

这是我的代码：

```
<?php
    $from = "username";
    $subject = "test";
    $date = date('D, d M Y',1366129280);
    echo "<table>
              <tr style='font-weight:bold;'>
                  <td>From</td>
                  <td>Title</td>
                  <td>Date</td>
              </tr>
              <tr>
                  <td style='width:20%;'><a href='#'>".$from."</a></td>
                  <td style='width:60%;'><a href='#'>".$subject."</a></td>
                  <td style='width:20%;'><a href='#'>".$date."</a></td>
              </tr>
         </table>";
 ?> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:06:54.270

看起来桌子可能不够宽，无法容纳日期。您的日期调用或格式没有任何内容可以使其插入换行符。浏览器会将表格详细信息 (td) 的大小缩小到 20%，即使这意味着将某些文本推送到多行。

尝试从 td 中删除宽度说明符，看看会发生什么。主题可能仍然太大，并挤压该列。如果是这样，您可以尝试暂时删除该列。

无论哪种情况，您的 php 日期代码都没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:09:28.313

我同意 mbarlocker - 你的 PHP 很好，但它会根据你的浏览器的大小而挤压。尝试去这个[JsFiddle](http://jsfiddle.net/vL2dH/)并调整你的窗口大小 - 你会看到它太小时它会自动转到下一行，因为：

```
<td style='width:20%;'> 
```

# jquery - ReferenceError：运行 JasmineHeadlessWebkit 时找不到变量：$

> ID：16156679
> 
> 赞同：1
> 
> 时间：2013-04-22T21:02:56.623
> 
> 标签：jquery, coffeescript, jasmine, jasmine-jquery, jasmine-headless-webkit

至少在过去的两个小时里，我一直试图找到答案，但没有任何运气。我希望这里有人可以提供帮助。

我在`ReferenceError: Can't find variable: $`使用 JasmineHeadlessWebkit 运行我的 Jasmine 规范时得到了这个。

奇怪的是，这只发生在我说

```
$ ->
  game.init() 
```

在我的`game.coffee`档案中。

我可以在`$`没有任何问题的情况下使用`game.coffee`. 例如：

```
window.game =
  init: ->
    $('.gamelayer').hide()
    $('#gamestartscreen').show() 
```

这完全没有问题。

此外，测试在 Chrome 中运行良好。

所以，我假设这与 jQuery 没有及时加载有关，但我不知道为什么。

我有 jQuery in `specs/javascripts/helpers/`and in`jasmine.yml`我提到了`helpers`之前的`spec_files`and`src_files`但这似乎并没有真正的区别。

因此，如果有人知道如何确保在运行 Jasmine 的规范时完全加载 jQuery，我将非常感谢任何帮助。

另外，如果您需要任何其他信息，请告诉我。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-17T19:12:51.650

我也遇到了这个问题。我通过在加载其余 javascript 文件之前更改我的 jasmine.yml 以加载 jquery 来修复它：

```
src_files：
  - 公共/js/jquery.js
  - 公共/js/**/*.js

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:09:47.150

您可以尝试两种解决方案：

第一个延迟 game.init() 等待 jQuery 被加载：

```
function initJQuery() {
    if (typeof(jQuery) == 'undefined') {
        setTimeout("initJQuery()", 50);
    } else {
        game.init();
    }
} 
```

第二个调用一个 jQuery 函数来防止与库发生冲突（在代码开头运行它）：

```
jQuery.noConflict() 
```

您可以尝试，但我不确定这是否是您情况下的最佳解决方案。请注意使用此解决方案，您必须将所有 '$' 更改为 'jQuery'

# mongodb - 我在哪里可以找到 Laravel 中 Mongor 捆绑包的分类文档？

> ID：16156682
> 
> 赞同：0
> 
> 时间：2013-04-22T21:03:05.593
> 
> 标签：mongodb, bundle, laravel, laravel-3, mongor

我已经在互联网上搜索了 4 个小时，但找不到任何关于如何在 Laravel 中使用 Mongor 的好文档。任何参考将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:55:08.130

我不相信 Mongor 有任何文档，作者最后一次更改是在 2010 年 7 月（除了 4 个月前合并拉取请求）。我能找到的唯一可能有帮助的帖子是：

*   [http://forums.laravel.io/viewtopic.php?pid=10133#p10133](http://forums.laravel.io/viewtopic.php?pid=10133#p10133)

# ruby - 合并重复的数组项

> ID：16156691
> 
> 赞同：0
> 
> 时间：2013-04-22T21:03:38.033
> 
> 标签：ruby, arrays, hash

我有一个哈希数组...

```
array = [
{
    'keyword' => 'A',
    'total_value' => 50
},
{
    'keyword' => 'B',
    'total_value' => 25
},
{
    'keyword' => 'C',
    'total_value' => 40
},
{
    'keyword' => 'A',
    'total_value' => 10
},
{
    'keyword' => 'C',
    'total_value' => 15
}] 
```

我需要用相同的`keyword`值合并散列。通过巩固，我的意思是结合`total_values`。例如，合并上述数组后，应该只有一个带有`'keyword' => 'A'`with a 的hash`'total_value => 60`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:06:46.740

一个简单的方法是在将项目添加到集合时执行此操作。开始添加项目，检查关键字是否存在。如果 (a) 它在那里，那么只需将新项目的 total_value 添加到其上。否则 (b) 将新项目添加到集合中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:28:08.237

```
array =  [
{
    'keyword' => 'A',
    'total_value' => 50
},
{
    'keyword' => 'B',
    'total_value' => 25
},
{
    'keyword' => 'C',
    'total_value' => 40
},
{
    'keyword' => 'A',
    'total_value' => 10
},
{
    'keyword' => 'C',
    'total_value' => 15
}]

m = array.inject(Hash.new(0)) do |hs,i| 
    hs[i['keyword']] += i['total_value'] 
    hs 
end
p m 
```

***输出：***

```
{"A"=>60, "B"=>25, "C"=>55} 
```

> 通过合并，我的意思是合并总价值。例如，合并上述数组后，应该只有一个 'keyword' => 'A' 和 'total_value => 60

这是如何完成的：

```
m = array.each_with_object(Hash.new(0)) do |h,ob| 
     if h['keyword'] == 'A'
        h['total_value'] += ob['total_value']
        ob.update(h)
     end
end
p m
#=> {"keyword"=>"A", "total_value"=>60} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T05:35:05.793

```
array.group_by{|h| h["keyword"]}
.map{|k, v| {
  "keyword" => k,
  "total_value" => v.map{|h| h["total_value"]}.inject(:+)
}} 
```

# windows-phone-7 - Windows Phone 8 全球应用栏本地化

> ID：16156694
> 
> 赞同：1
> 
> 时间：2013-04-22T21:03:59.487
> 
> 标签：windows-phone-7

我正在尝试创建一个本地化的 windows phone 8 应用程序，并且我正在创建一个全局应用程序栏。但是我无法使用资源设置栏内项目的文本，有人知道该怎么做吗？我也无法在代码中得到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:29:03.280

您可以重用模板的 MainPage.xaml.cs 中的注释代码：

```
private void BuildLocalizedApplicationBar()
{
  // Set the page's ApplicationBar to a new instance of ApplicationBar.
  ApplicationBar = new ApplicationBar();

  // Create a new button and set the text value to the localized string from AppResources.
 ApplicationBarIconButton appBarButton = new ApplicationBarIconButton(new Uri("/Assets/AppBar/appbar.add.rest.png", UriKind.Relative));
 //Search in AppResources.Search is a key of a string in the resource files (.resx)
 appBarButton.Text = AppResources.Search;
 ApplicationBar.Buttons.Add(appBarButton);

 // Create a new menu item with the localized string from AppResources.
 //Search in AppResources.Search is a key of a string in the resource files (.resx)
 ApplicationBarMenuItem appBarMenuItem = new ApplicationBarMenuItem(AppResources.Search);
 ApplicationBar.MenuItems.Add(appBarMenuItem);
} 
```

不幸的是，应用栏不是传统的 Silverlight 控件，因此如果您想要本地化，您必须在每个页面中以编程方式创建。

# perl - 如何确定 perl 的范围迭代器的最大范围？

> ID：16156698
> 
> 赞同：4
> 
> 时间：2013-04-22T21:04:03.433
> 
> 标签：perl, int, range, limit

我可以像这样超过 perl 的迭代范围，有或没有`-Mbigint`：

```
$» perl -E 'say $^V; say for (0..shift)' 1e19
v5.16.2
Range iterator outside integer range at -e line 1. 
```

我怎样才能确定这个上限，而不是简单地尝试直到超过它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T21:26:52.707

这是静脉注射。

`>>`同样适用于整数，因此您可以使用

```
my $max_iv = -1 >> 1;
my $min_iv = -(-1 >> 1) - 1; 
```

它们也可以从 IV 的大小得出。

```
my $max_iv = (1 << ($iv_bits-1)) - 1;
my $min_iv = -(1 << ($iv_bits-1)); 
```

IV的大小可以使用

```
use Config qw( %Config );
my $iv_bits = 8 * $Config{ivsize}; 
```

或者

```
my $iv_bits = 8 * length pack 'j', 0; 
```

# c# - C# 从主应用程序文件夹中删除只读

> ID：16156699
> 
> 赞同：0
> 
> 时间：2013-04-22T21:04:15.663
> 
> 标签：c#, visual-studio-2010, windows-installer

我正在尝试使用自动/自我更新程序构建应用程序。该文件将检查更新，然后立即下载文件并替换必要的文件。我一直在尝试将其放入安装程序包中，但遇到了应用程序文件夹只读的问题。我尝试使用多个 SO [this one](https://stackoverflow.com/questions/2316308/remove-readonly-of-folder-from-c-sharp)中的代码删除 readonly 参数，但是在安装程序后，该文件夹仍然是只读的。

```
[System.Security.Permissions.SecurityPermission(System.Security.Permissions.SecurityAction.Demand)]
public override void Install(IDictionary stateSaver)
{
    base.Install(stateSaver);
    try
    {
        string path = this.Context.Parameters["targetdir"];
        path = path.Substring(0, path.Length - 1);

        DirectoryInfo di = new DirectoryInfo(path);
        di.Attributes &= ~FileAttributes.ReadOnly;
        di.Refresh();
    }
    catch (Exception e)
    {
    }
} 
```

我也试过把它放在 Commit 方法中。路径肯定被拉了（MessageBox.Show 显示了正确的路径）。

我是否需要做一些不同的事情来更改应用程序的主文件夹？

* * *

我不明白为什么更新程序进程在这个问题的上下文中很重要，但它是如何工作的：

*   用户将更新程序应用程序作为主应用程序的一种“门户”启动。
*   更新程序检查服务器以获取特定于该设备的更新。
*   下载新文件并替换当前未锁定的所有文件。
*   然后该 exe 调用一个辅助 exe 并自行关闭。帮助程序 exe 更新剩余的文件（即更新程序本身）
*   助手然后启动主应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:41:59.930

[http://support.microsoft.com/kb/981778](http://support.microsoft.com/kb/981778)

I ended up doing a self-elevation (restart run-as) for the updater. This will only ask for permission if there is an update available.

```
// During update process:
if (!IsAdministrator()) 
{
    // Launch itself as administrator
    ProcessStartInfo proc = new ProcessStartInfo();
    proc.UseShellExecute = true;
    proc.WorkingDirectory = Environment.CurrentDirectory;
    proc.FileName = Application.ExecutablePath;
    proc.Verb = "runas";

    try
    {
        Process.Start(proc);
    }
    catch
    {
        // The user refused to allow privileges elevation.
        // Do nothing and return directly ...
        return false;
    }
    Application.Exit();
}

public static bool IsAdministrator()
{
    var identity = WindowsIdentity.GetCurrent();
    var principal = new WindowsPrincipal(identity);
    return principal.IsInRole(WindowsBuiltInRole.Administrator);
} 
```

Another solution that is working, although not entirely how I would like it, is to go through each project's properties -> Security -> Enable ClickOnce security settings and then building the installer. This is annoying because it asks for permission every time the file runs on a UAC account. However, it is working and doesn't require some looping exe launching.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:08:21.270

您不是要删除只读标志，而是要提高在该文件夹中写入的权限 - 它一开始就不是只读的。

为此，您可以使用“RunAs”运行您的安装程序应用程序：

```
// launcher code
  if (CheckIfUpdateAvailable()){
    ProcessStartInfo startInfo = new ProcessStartInfo ("MyUpdater.exe");  
    startInfo.Verb = "runas";
    System.Diagnostics.Process.Start (startInfo); 
    Application.Quit();
  } 
```

启动器生成的进程将有权写入您的应用程序文件夹

并且您的更新程序必须是与您的应用程序一起部署的可执行文件 - 您会发现很难覆盖正在运行的可执行文件的文件

或者您可以切换到 ClickOnce，这是免费的。授予 - 使用 ClickOnce 安装程序可以执行的操作有一些小的限制。

# ios - UITableView 静态滚动

> ID：16156700
> 
> 赞同：0
> 
> 时间：2013-04-22T21:04:21.397
> 
> 标签：ios, uitableview

我有一个使用自定义 UITableViewCells 的简单 UITableView。UITableView 的属性上设置的选项只是样式设置为 Grouped。当我试图向下滚动浏览不同的项目时，滚动非常跳跃。我已经研究了很多[关于提高 iPhone UITableView 滚动性能的技巧？](https://stackoverflow.com/questions/1352479/tricks-for-improving-iphone-uitableview-scrolling-performance)以及本网站上的其他一些问题。虽然我还没有真正找到解决方案。

编辑**** 我使用 WSDL Web 服务将数据加载到 UITableViewCells 中。这些单元格中只有一个 UITextView 和三个按钮。

编辑 ****

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"NavigatorCell";

    NewCell *cell = (NewCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"NewCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];
    }

    cell.postId = [[items objectAtIndex:indexPath.row] objectForKey:@"PostID"];
    cell.post.text = [[items objectAtIndex:indexPath.row] objectForKey:@"Post"];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:26:33.843

我看到你`NewCell`的子类。

不要忘记将此方法包含在您的 NewCell.m 中

```
- (NSString *) reuseIdentifier
{    
    return @"Cell Identifier";
} 
```

当然`@"Cell Identifier"`应该与您在`cellForRowAtIndexPath:`. 如果您未能实现此方法，则每个单元格都将从头开始生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:15:19.073

你在使用 dequeReusableCellWithIdentifier 吗？请遵循以下格式。由于您现在提到您正在从网络加载数据，因此您需要异步执行此操作以允许平滑滚动。要从 web 服务（异步）加载，[这里有一个不错的项目](https://github.com/nicklockwood/AsyncImageView)

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath     *)indexPath
{
    static NSString *CellIdentifier = @"yourCellName";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    return cell;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:22:06.853

将 tableview 设置为 Reuse cells 是确保良好性能的最基本方法。基本上，这意味着不是为表格视图中的每个单元格创建一个新单元格，而是您的表格视图将回收屏幕外的单元格。基本设置如下，更多内容可以从[此处链接的 UITableViewDelegate 上的苹果文档中了解](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html)

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
        {
            NSString *CellIdentifier = @"Cell Identifier";

            CustomCellClassName *cell = (CustomCellClassName *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

                if (cell == nil){
                    cell = [[CustomCellClassName alloc] initWithFrame:CGRectMake(0, 0, tableView.frame.size.width, tableView.frame.size.height)];
                    //Do basic cell construction common to all cells of this type here
                    //Set background, image etc.  
                }

                //Do specific cell construction here
                return cell; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T21:25:13.433

如果您通过网络为每个单元加载数据，您会发现性能很差。批量获取数据，然后当它准备好时告诉你的 tableview 重新加载自己。

使用 Core Data 作为临时后备存储，并使用 NSFetchedResultsController 从 Core Data 检索信息，将为您节省一些工作。

# android - android如何使用seekBar调整流音量？

> ID：16156701
> 
> 赞同：1
> 
> 时间：2013-04-22T21:04:39.773
> 
> 标签：android, android-audiomanager

我正在尝试`stream volume`使用`SeekBar`（audioMan IS 已初始化）调整 a：

```
 sbTest = (SeekBar)findViewById(R.id.seekBar1);
    sbTest.setMax(audioMan.getStreamMaxVolume(AudioManager.STREAM_MUSIC));
    sbTest.setProgress(audioMan.getStreamVolume(AudioManager.STREAM_MUSIC));
    sbTest.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {

        @Override
        public void onStopTrackingTouch(SeekBar seekBar) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onStartTrackingTouch(SeekBar seekBar) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onProgressChanged(SeekBar seekBar, int progress,
                boolean fromUser) {
            audioMan.adjustStreamVolume(AudioManager.STREAM_MUSIC,
                    progress, AudioManager.FLAG_SHOW_UI);

        }
    }); 
```

`IllegalArgumentException`我一触碰应用程序就会崩溃`SeekBar`。LogCat 的第一行（后面是大量系统类的行号）：

```
 04-22 22:58:28.400: E/AndroidRuntime(28881): FATAL EXCEPTION: main
      04-22 22:58:28.400: E/AndroidRuntime(28881): java.lang.IllegalArgumentException: Bad direction 8 
```

我想我传递给该方法的整数参数是无效的。那么如何使用 SeekBar 调整流音量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T21:19:53.587

我在[我的 Volumizer 示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/SystemServices/Volume)中使用`setStreamVolume()`而不是：`adjustStreamVolume()`

```
/***
  Copyright (c) 2008-2012 CommonsWare, LLC
  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy
  of the License at http://www.apache.org/licenses/LICENSE-2.0\. Unless required
  by applicable law or agreed to in writing, software distributed under the
  License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS
  OF ANY KIND, either express or implied. See the License for the specific
  language governing permissions and limitations under the License.

  From _The Busy Coder's Guide to Android Development_
    http://commonsware.com/Android
*/

package com.commonsware.android.syssvc.volume;

import android.app.Activity;
import android.content.Context;
import android.media.AudioManager;
import android.os.Bundle;
import android.widget.SeekBar;

public class Volumizer extends Activity {
  SeekBar alarm=null;
  SeekBar music=null;
  SeekBar ring=null;
  SeekBar system=null;
  SeekBar voice=null;
  AudioManager mgr=null;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    mgr=(AudioManager)getSystemService(Context.AUDIO_SERVICE);

    alarm=(SeekBar)findViewById(R.id.alarm);
    music=(SeekBar)findViewById(R.id.music);
    ring=(SeekBar)findViewById(R.id.ring);
    system=(SeekBar)findViewById(R.id.system);
    voice=(SeekBar)findViewById(R.id.voice);

    initBar(alarm, AudioManager.STREAM_ALARM);
    initBar(music, AudioManager.STREAM_MUSIC);
    initBar(ring, AudioManager.STREAM_RING);
    initBar(system, AudioManager.STREAM_SYSTEM);
    initBar(voice, AudioManager.STREAM_VOICE_CALL);
  }

  private void initBar(SeekBar bar, final int stream) {
    bar.setMax(mgr.getStreamMaxVolume(stream));
    bar.setProgress(mgr.getStreamVolume(stream));

    bar.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
      public void onProgressChanged(SeekBar bar, int progress,
                                    boolean fromUser) {
        mgr.setStreamVolume(stream, progress,
                            AudioManager.FLAG_PLAY_SOUND);
      }

      public void onStartTrackingTouch(SeekBar bar) {
        // no-op
      }

      public void onStopTrackingTouch(SeekBar bar) {
        // no-op
      }
    });
  }
} 
```

# django - 统一 Django 表单媒体

> ID：16156705
> 
> 赞同：5
> 
> 时间：2013-04-22T21:04:48.493
> 
> 标签：django, forms, media

我有几个 Django 模板，其中一些具有不同的形式。一些表单使用需要自己的 JS 和 CSS 资源的自定义小部件。这些资源在每个[`form.media`](https://docs.djangoproject.com/en/dev/topics/forms/media/)

我发现放置所有媒体引用的正确位置是在我的`<head>`标签中，就在我自己的`css`文件上方。如果我愿意，这将允许我覆盖自定义小部件的外观。所以在我的模板中我有类似的东西：

```
{% block form_media %}
{{ form1.media }}
{{ form2.media }}
{% endblock %} 
```

（有些模板有不止一种形式）

现在，如果两个表单都使用相同的小部件，那么相同的 JS 和 CSS 文件将被引用两次。这*可*不好。有没有合理的方法来统一所有媒体参考？

这只是*请求*一个自定义`{% context_form_media %}`标签，它将在请求的上下文中呈现所有表单的媒体。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-10-29T09:20:06.273

您可以使用块和继承来做到这一点。

base.html：

```
<head>
    {% block form_css %}
        {# base css #}
    {% endblock form_css %}
    {# rest of head #}
</head>
{# rest of html #} 
```

任何form.html：

```
{% extends "base.html" %}
{% block form_css %}
    {# your form css #}
{% endblock form_css %}
{# your form #} 
```

这样你就可以只注入适用于该页面的 css/js。如果您还想包含该块的所有上游内容，您可以使用 {{ block.super }} 开始它。

# plugins - 声纳插件 - 查看源代码

> ID：16156710
> 
> 赞同：0
> 
> 时间：2013-04-22T21:05:16.600
> 
> 标签：plugins, abap, sonarqube

我正在为 Abap 代码编写一个小型声纳插件。我已经在 Sonar 中提供了指标，并且在 Sonar 数据库中也有一些 Abap 文件的源代码（我用 sql 客户端检查了它）。但现在我真的不知道如何用声纳呈现这个源代码。我已经查看了声纳源代码和一些声纳插件（比如 CXXPlugin [https://github.com/SonarCommunity/sonar-cxx](https://github.com/SonarCommunity/sonar-cxx)也有输出源代码的功能），但我没有变得更聪明。有没有一种简单的方法可以使用声纳 api 呈现源代码？[Sonar Core ( https://github.com/SonarSource/sonar](https://github.com/SonarSource/sonar) )中是否有任何类型的 SourceViewer 部分。

* * *

编辑：我现在更近了一步，但我对向下钻取视图有问题。我的 erb 文件有以下代码片段：

```
 %= format_measure(loc_measure, :suffix => '', :url => url_for_drilldown(loc_measure)) -%> 
```

但是我的钻取视图没有列出我的文件夹中由声纳分析的源： ![在此处输入图像描述](https://i.stack.imgur.com/CUt95.jpg)

在我的数据库中，我查看了表“项目”： ![在此处输入图像描述](https://i.stack.imgur.com/C75Lm.jpg)

之后，我尝试在钻取视图中直接链接到源文件（在这种情况下，id 为 122）并且它起作用了： ![在此处输入图像描述](https://i.stack.imgur.com/W7ANY.jpg)

所以我的问题是，为什么子文件夹和源文件没有像普通 Java 项目中的类和包一样列出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T07:24:54.367

您可以查看我们为 Sonar 开发的一些开源语言插件。例如，你可以去看看[Javascript 插件](https://github.com/SonarCommunity/sonar-javascript)——这可能是一个更好的选择，而不是我们开发的 CXX 插件，那里可能不完全符合我们的约定和编码最佳实践和指南。

总结一下：

*   创建一个源导入器，如[JavascriptSourceImporter](https://github.com/SonarCommunity/sonar-javascript/blob/master/sonar-javascript-plugin/src/main/java/org/sonar/plugins/javascript/core/JavaScriptSourceImporter.java)

*   创建一个着色器，就像你可以在“ [org.sonar.plugins.javascript.colorizer](https://github.com/SonarCommunity/sonar-javascript/tree/master/sonar-javascript-plugin/src/main/java/org/sonar/plugins/javascript/colorizer) ”包中找到的一样

*   显然不要忘记在你的插件类中声明这些扩展

# android - Android + Robolectric - ContentProvider 中 queryBuilder.query() 中的 RuntimeException / InstantiationException

> ID：16156711
> 
> 赞同：6
> 
> 时间：2013-04-22T21:05:28.930
> 
> 标签：android, sqlite, junit, instantiation, robolectric

我对只使用 SQLite 的 ContentProvider 进行了大约十次测试；all pass 保存在 Content Provider 的 query() 方法中通过 queryBuilder.query() 的两个。

正在测试的方法在实际应用程序中有效！

这适用于 API 17 r2 和 RoboLectric：robolectric-2.0-alpha-3-20130417.013705-46-jar-with-dependencies.jar

```
@Override
public Cursor query(Uri uri, String[] projection, String selection,
        String[] selectionArgs, String sortOrder) {
    Log.d(Constants.TAG, "MyContentProvider.query()");
    switch(matcher.match(uri)) {
    case ITEM: // OK
        selection = "_id = ?";
        selectionArgs = new String[]{ Long.toString(ContentUris.parseId(uri)) };
    case ITEMS: // OK
        break;
    default:
        throw new IllegalArgumentException("Did not recognize URI " + uri);
    }
    // build the query with SQLiteQueryBuilder
    SQLiteQueryBuilder qBuilder = new SQLiteQueryBuilder();
    qBuilder.setTables(TABLE_NAME);

    // query the database and get result in cursor
    final SQLiteDatabase db = mDatabase.getReadableDatabase();
    Cursor resultCursor = qBuilder.query(db,    // Line 112 in trace
            projection, selection, selectionArgs, null, null, sortOrder,
            null);
    resultCursor.setNotificationUri(getContext().getContentResolver(), uri);
    return resultCursor;
} 
```

这是回溯：

```
java.lang.RuntimeException: java.lang.InstantiationException
    at org.robolectric.bytecode.ShadowWrangler.createShadowFor(ShadowWrangler.java:300)
    at org.robolectric.bytecode.ShadowWrangler.initializing(ShadowWrangler.java:74)
    at org.robolectric.bytecode.RobolectricInternals.initializing(RobolectricInternals.java:90)
    at android.database.sqlite.SQLiteQuery.$$robo$init(SQLiteQuery.java)
    at android.database.sqlite.SQLiteClosable.<init>(SQLiteClosable.java:26)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:41)
    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:37)
    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:44)
    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1314)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:400)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:333)
    at com.example.readingsprovider.ReadingsContentProvider.query(ReadingsContentProvider.java:112)
    at com.example.readingsprovider.test.ContentProviderTest.testUpdateMultipleWithoutWhere(ContentProviderTest.java:110)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.robolectric.RobolectricTestRunner$2.evaluate(RobolectricTestRunner.java:267)
    at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.robolectric.RobolectricTestRunner$1.evaluate(RobolectricTestRunner.java:202)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.InstantiationException
    at sun.reflect.InstantiationExceptionConstructorAccessorImpl.newInstance(InstantiationExceptionConstructorAccessorImpl.java:30)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at java.lang.Class.newInstance0(Class.java:357)
    at java.lang.Class.newInstance(Class.java:310)
    at org.robolectric.bytecode.ShadowWrangler.createShadowFor(ShadowWrangler.java:293)
    at org.robolectric.bytecode.ShadowWrangler.initializing(ShadowWrangler.java:74)
    at org.robolectric.bytecode.RobolectricInternals.initializing(RobolectricInternals.java:90)
    at android.database.sqlite.SQLiteQuery.$$robo$init(SQLiteQuery.java)
    at android.database.sqlite.SQLiteClosable.<init>(SQLiteClosable.java:26)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:41)
    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:37)
    at android.database.sqlite.SQLiteDirectCursorDriver.$$robo$$SQLiteDirectCursorDriver_7ac1_query(SQLiteDirectCursorDriver.java:44)
    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java)
    at android.database.sqlite.SQLiteDatabase.$$robo$$SQLiteDatabase_ab15_rawQueryWithFactory(SQLiteDatabase.java:1314)
    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java)
    at android.database.sqlite.SQLiteQueryBuilder.$$robo$$SQLiteQueryBuilder_ba4d_query(SQLiteQueryBuilder.java:400)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java)
    at android.database.sqlite.SQLiteQueryBuilder.$$robo$$SQLiteQueryBuilder_ba4d_query(SQLiteQueryBuilder.java:333)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java)
    at com.example.readingsprovider.ReadingsContentProvider.query(ReadingsContentProvider.java:112)
    at com.example.readingsprovider.test.ContentProviderTest.testUpdateMultipleWithoutWhere(ContentProviderTest.java:110)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    ... 21 more 
```

请问这是 Robolectric 的限制，还是我的错？非常感谢！

PS 如果反射 API 将失败的类名放在 InstantiationException 消息中，那不是很梦幻吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-14T16:08:25.313

我的项目也遇到了同样的问题，终于可以通过谷歌搜索和 U Avalos 的先前答案来解决它

### 1.创建自定义SQLiteShadow

```
@Implements(value = SQLiteDatabase.class, inheritImplementationMethods = true)
public class CustomSQLiteShadow extends ShadowSQLiteDatabase {

    @Implementation
    public Cursor rawQueryWithFactory (SQLiteDatabase.CursorFactory cursorFactory,
                                     String sql,
                                     String[] selectionArgs,
                                     String editTable,
                                     CancellationSignal cancellationSignal) {
      return rawQueryWithFactory(cursorFactory,
                                 sql,
                                 selectionArgs,
                                 editTable);
    }
} 
```

### 2.`@Config`为您的测试添加注释

要使用自定义阴影类，可以使用`@Config`robolectric2 中的注解

```
@RunWith(RobolectricTestRunner.class)
@Config( shadows = {CustomSQLiteShadow.class})
public class ContentProviderTest { 
```

### 参考

[http://robolectric.blogspot.co.at/2013/05/configuring-robolectric-20.html](http://robolectric.blogspot.co.at/2013/05/configuring-robolectric-20.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-26T02:48:52.643

Android API 16 引入了这种新方法（mtholdefer 提到过）：

```
public Cursor rawQueryWithFactory (SQLiteDatabase.CursorFactory cursorFactory, String sql, String[] selectionArgs, String editTable, CancellationSignal cancellationSignal) 
```

截至 2013 年 7 月 25 日，roboelectric 不实施此方法。但是，它实现了一个不使用 CancellationSignal 的类似方法。将此方法添加到 ShadowSqlLiteDatabase 使我的问题消失了：

```
@Implementation
public Cursor rawQueryWithFactory (SQLiteDatabase.CursorFactory cursorFactory,
                                 String sql,
                                 String[] selectionArgs,
                                 String editTable,
                                 CancellationSignal cancellationSignal)
{
  return rawQueryWithFactory(cursorFactory,
                             sql,
                             selectionArgs,
                             editTable);
} 
```

（是的，您需要将 roboelectric 作为子模块。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-20T11:48:41.737

I have been running into a similar issue and I believe the problem is that SQLiteQueryBuilder is not supported in Robolectric. You can read more about that [here](https://github.com/robolectric/robolectric/issues/70). Basically the rawQueryWithFactor() method that SQLiteQueryBuilder uses is not overridden in ShadowSQLiteDatabase. Because of this the cusor is returned as null

I just started instantiating my cursors via SQLiteDatabaseInstance.query and that works perfectly in conjunction with Robolectric. Good luck and let me know if you find a more elegant solution do I can test my queryBuilders as well!

# c# - 当我不将 [DataMember] 添加到 [DataContract] 中的字段时会发生什么？

> ID：16156716
> 
> 赞同：1
> 
> 时间：2013-04-22T21:05:55.863
> 
> 标签：c#

我特别想知道该特定字段是否被序列化。

例如，我有：

```
[DataContract]
public class Node {
   [DataMember]
   public string Name;

   [DataMember]
   public int ID;
} 
```

我只对序列化名字感兴趣，还需`ID`要用`DataMember`属性来装饰吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T21:07:10.880

如果您省略该属性，则该值将不会被序列化。

所以如果只需要名字就不需要修饰ID

# sql - SQL：根据其他列中的多个条件计算一列中的不同值

> ID：16156717
> 
> 赞同：7
> 
> 时间：2013-04-22T21:06:02.063
> 
> 标签：sql, sql-server, count, distinct, multiple-columns

**我正在尝试根据多个标准计算不同的值。** 示例数据练习包括在下面。

```
           表格1
╔════════╦════════╦══════╗
║ Bug ID ║ 状态 ║ 测试 ║
╠════════╬════════╬══════╣
║ 1 ║ 打开 ║ w ║
║ 2 ║ 关闭 ║ w ║
║ 3 ║ 打开 ║ w ║
║ 4 ║ 打开 ║ x ║
║ 4 ║ 打开 ║ x ║
║ 5 ║ 关闭 ║ x ║
║ 5 ║ 关闭 ║ x ║
║ 5 ║ 关闭 ║ y ║
║ 6 ║ 打开 ║ z ║
║ 6 ║ 打开 ║ z ║
║ 6 ║ 打开 ║ z ║
║ 7 ║ 关闭 ║ z ║
║ 8 ║ 关闭 ║ z ║
╚════════╩════════╩══════╝
      期望的查询结果
╔══════╦═══════════╦════════════╗
║ 测试 ║ 打开错误 ║ 总错误 ║
╠══════╬═══════════╬════════════╣
║ w ║ 2 ║ 3 ║
║ x ║ 1 ║ 2 ║
║ 是 ║ 0 ║ 1 ║
║ z ║ 1 ║ 3 ║
╚══════╩═══════════╩════════════╝

```

一个给定的错误可以在多个测试中找到，对于同一个测试可以多次找到（例如：6），或者两者兼而有之（例如：5）。

**以下查询可以很好地准确提供“总错误”**

```
SELECT
Test,
COUNT(DISTINCT Bug ID) AS "Total Bugs"
FROM
Table1
GROUP BY Test 
```

**我的研究使我对以下查询产生了变化。他们错过了明显的错误，因此为“打开的错误”列返回不正确的结果（显示在查询下方）**

```
SELECT
Test,
SUM(CASE WHEN Status <> 'Closed' THEN 1 ELSE 0 END) AS "Open Bugs"
FROM
Table1
GROUP BY Test 
```

```
╔══════╦═══════════╗
║测试║打开Bugs║
╠══════╬═══════════╣
║ w ║ 2 ║
║ x ║ 2 ║
║ 是 ║ 0 ║
║ z ║ 3 ║
╚══════╩═══════════╝

```

**当然，我的最终结果必须在一个表中提供两个计数列（而不是像我为演示目的所做的那样使用单独的查询）。**

我不想依赖多个子查询，因为我的实时示例将有两个以上的列，它们的计数来自同一个表，但标准不同。

我正在使用 SQL Server（不确定发布）。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-22T21:08:45.723

您可以`count(distinct)`使用以下代码设置条件：

```
SELECT Test, COUNT(DISTINCT "Bug ID") AS "Total Bugs",
count(distinct (CASE WHEN "Status" <> 'Closed' THEN "Bug ID" END)) as "Open Bugs"
FROM Table1
GROUP BY Test 
```

该`case`语句检查条件。当为真时，它返回`Bug ID`. 如果不存在，则默认为 NULL，因此不计算 id。

# android - 从 android 模板打开调频收音机

> ID：16156721
> 
> 赞同：0
> 
> 时间：2013-04-22T21:06:20.733
> 
> 标签：android

我正在尝试创建一个非常简单的应用程序，例如只有一个广播电台的 Tune-In。

我试图从 SWF 流式传输 URL，但 SWF 在 android 上不起作用。

我的无线电流代码是这样的：-

```
<embed width="395" height="20" flashvars="file=http://radio.arabhosters.com:8015/;stream.nsv&amp;type=mp3&amp;volume=20&amp;autostart=true" allowscriptaccess="always" allowfullscreen="true" quality="high" bgcolor="#FFFFFF" name="ply" id="ply" style="undefined; margin-bottom: 0px;" src="player.swf" type="application/x-shockwave-flash"> 
```

为这个非常模糊的问题道歉，但我还没有找到任何关于这个具体问题的详细记录。

我怎样才能在我的安卓模板上打开它。

# node.js - 使用 Jade 从 Express 传递的渲染数组

> ID：16156732
> 
> 赞同：9
> 
> 时间：2013-04-22T21:06:45.697
> 
> 标签：node.js, express, pug

大多数与此相关的问题似乎都是关于将服务器端 JS 对象传递给客户端 JS 对象。也许我遗漏了一些东西，但我想做的就是使用服务器端 JS 对象呈现 HTML。

在服务器上：

```
app.get '/', (req, res) ->

  res.render 'index',
    data:
      keywords: [
        'one'
        'two'
      ] 
```

使用[这些](https://github.com/visionmedia/jade#a9)文档，文件中没有以下内容`index.jade`：

```
- var keywords = [#{data.keywords}]
each kw in keywords
  li= kw

- var keywords = ["#{data.keywords}"]
each kw in keywords
  li= kw

- var keywords = "#{data.keywords}"
each kw in keywords
  li= kw

- var keywords = #{data.keywords}
each kw in keywords
  li= kw 
```

当我这样做时，该数组*确实打印到一个字符串：*

```
p "#{data.keywords}" 
```

这可能吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-22T21:11:12.987

怎么样

```
each kw in data.keywords
  li= kw 
```

?

# node.js - 有没有关于 Node.js 的在线练习

> ID：16156736
> 
> 赞同：15
> 
> 时间：2013-04-22T21:06:59.347
> 
> 标签：node.js

我是 Node.js 的新手，我需要一些练习，那么是否有任何与[http://www.codecademy.com/](http://www.codecademy.com/)相同 的 node.js 在线练习？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-02-26T00:15:44.943

CodeSchool 有一门 node.js 课程（第一节课免费，之后 $29/月）： http: [//node.codeschool.com/](http://node.codeschool.com/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-22T21:23:23.290

只需在阅读教程*时进行*教程。尝试设置一个网络服务器并提供一个显示“你好”的页面。我不确定您是否会为 nodejs 之类的东西找到诸如 codeacademy 之类的交互式练习。

我再次认为你最好的选择是之前的 SO 问题[我如何开始使用 Node.js](https://stackoverflow.com/questions/2353818/how-do-i-get-started-with-node-js)

# c# - 使用 JSON 数组的 RestSharp 反序列化

> ID：16156738
> 
> 赞同：19
> 
> 时间：2013-04-22T21:07:07.983
> 
> 标签：c#, json, restsharp

我有一个 JSON 响应，我试图用[RestSharp](http://restsharp.org/)反序列化，它看起来像这样：

```
{"devices":[{"device":{"id":7,"deviceid":"abc123","name":"Name"}},
            {"device":{"id":1,"deviceid":"def456","name":"Name"}}],
 "total":2,
 "start":0,
 "count":2} 
```

根据我发现的一些建议，我尝试像这样设置我的 POCO：

```
public class DevicesList
{
    public List<DeviceContainer> Devices;
}

public class DeviceContainer
{
    public Device Device;
}

public class Device
{
    public int Id { get; set; }
    public string DeviceId { get; set; }
    public string Name { get; set; }
} 
```

然后我的执行看起来像这样：

```
// execute the request
var response = client.Execute<DevicesList>(request); 
```

但是，`response.Data`它是 NULL，我尝试了其他变体但没有运气。

那么，这种情况应该使用什么类结构和映射呢？我也试过这个没有额外的`DeviceContainer`课程。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-05-28T02:37:27.087

当我的反序列化 POCO 包含一个数组时，我遇到了一个稍微不同的问题。

将其更改`Devices[]`为`List<Devices>`解决问题并正确反序列化。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-22T21:47:12.750

RestSharp*只*对属性进行操作，它不会反序列化为字段，因此请确保将您的`Devices`和`Device`字段转换为属性。

此外，请仔细检查`Content-Type`响应，如果响应是非默认的，RestSharp 可能根本不使用 JsonDeserializer。反序列化 JSON 响应时，请参阅我在[RestSharp 客户端上的答案将所有属性都返回为 null](https://stackoverflow.com/questions/11087508/restsharp-client-returns-all-properties-as-null-when-deserializing-json-response/11087824#11087824)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-17T00:44:35.973

我遇到的问题是，如果您使用的接口如：IEnumerable 或 IList，则它不起作用，它必须是具体类型。

这是行不通的，就像 json.net 等其他一些 json 序列化程序一样。

```
public class DevicesList
{
    public IEnumerable<DeviceContainer> Devices { get; set; }
}

public class DeviceContainer
{
   ...
} 
```

它必须是这样的：

```
public class DevicesList
{
    public List<DeviceContainer> Devices { get; set; }
}

public class DeviceContainer
{
   ...
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-22T21:33:33.287

RestShartp 不支持 DataAnnotation/DataMember，重命名你的属性没有 maj：

*   设备 -> 设备
*   设备 -> 设备

并且不要忘记`{get; set;}`;)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-14T22:35:51.450

我的问题完全不同，我天真地认为`JsonDeserializer`支持`JsonProperty`属性，但事实并非如此。所以当试图反序列化成

```
public class AvailableUserDatasApi
{
    [JsonProperty("available-user-data")]
    public List<AvailableUserDataApi> AvailableUserDatas { get; set; }
} 
```

它失败了..但是更改`AvailableUserDatas`为`AvailableUserData`足以让事情开始工作。

# c++ - 以下代码的输出是什么？

> ID：16156760
> 
> 赞同：-8
> 
> 时间：2013-04-22T21:08:51.977
> 
> 标签：c++

代码的输出将是什么

> `int a=3,b=4;`
> `++a*=++b;`
> `cout<<a<<endl;`

编译器显示输出`a=20`。 这里是如何使用的？`precedence``operator associativity`

# 我的理解是：

首先`b`在左边`++a*=++b;`是递增我们它的`unary`运算符然后是轮到`*=`所以表达式变成`++a = a * ++b;`了现在所以它变成了`a=3`然后被分配和递增。最后得到但编译器给出`b=5``15``15``a``16``20`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:13:11.420

在您的特定编译器的特定情况下，似乎首先 a 递增到 4 并且 b 递增到 5，然后执行 a *= b 并且 a 变为 20 (4*5)。然而，其他编译器可能会给出不同的结果，因为它不是人们在评论中提到的定义行为

# apache - 错误：启动后 PID 文件 /run/httpd/httpd.pid 不可读（还没有？）。（阿帕奇）

> ID：16156761
> 
> 赞同：3
> 
> 时间：2013-04-22T21:08:58.380
> 
> 标签：apache, archlinux

有谁知道是什么会导致 Apache 的错误日志中出现这个错误（特别是在 Arch Linux 中）：

```
PID file /run/httpd/httpd.pid not readable (yet?) after start. 
```

该错误不会阻止 Apache 正常运行（一旦启动），但可能会显着减慢我的服务重启时间。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-30T15:40:40.090

解决办法是调整文件`/usr/lib/tmpfiles.d/apache.conf`。默认值是错误的。你必须改变这个

```
d /run/httpd 0755 root root - 
```

至

```
d /run/httpd 0755 http http - 
```

.

重新启动 apache 后，将创建 PID 文件，`chown http:http`而不是`chown root:root`.

**资源**：

*   [https://mailman.archlinux.org/pipermail/arch-general/2013-July/033891.html](https://mailman.archlinux.org/pipermail/arch-general/2013-July/033891.html)
*   [https://mailman.archlinux.org/pipermail/arch-general/2013-July/033900.html](https://mailman.archlinux.org/pipermail/arch-general/2013-July/033900.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-26T14:16:39.543

我的看法是这个错误是一个特性：我所做的一切都无法摆脱它（尝试了这里建议的所有内容，然后尝试了一些），但软件运行良好。所以，我把它当作一个稍微写错的成功信息——我已经开始了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-15T08:36:43.097

我遇到了这个问题：

> PID 文件 *.pid 在启动后不可读（还没有？）。

最近几天，我的 apache 服务器正在从包发布的版本编译为`httpd-2.4.12.tar.gz`. 这是我的 httpd.service 内容，在此之后我的问题得到了解决。希望这可以帮助遇到此问题的任何人。

```
[Unit]
Description=The Apache HTTP Server
After=network.target remote-fs.target nss-lookup.target

[Service]
Type=forking
ExecStart=/usr/local/apache/bin/apachectl start -DFOREGROUND
PIDFile=/run/apache/apache.pid
ExecReload=/usr/local/apache/bin/apachectl restart
ExecStop=/user/local/apache/bin/apachectl stop
PrivateTmp=True

[Install]
WantedBy=multi-user.target 
```

# node.js - 使用 mongoosejs 映射减少

> ID：16156762
> 
> 赞同：1
> 
> 时间：2013-04-22T21:08:58.607
> 
> 标签：node.js, mongoose

我正在尝试使用 Nodejs、mongoose 和 MongoDB 进行 map reduce 操作。我有一个相当平坦的模式结构，我想获得每个“命名”对象的值/日期对列表。map reduce 函数显然有问题，但我不知道如何修复它以获得我想要的格式。

MongoDB 文档架构如下：

```
{ "name" : "object1", "value" : "123", "date" : "2013-01-02 01:00:00" }
{ "name" : "object1", "value" : "456", "date" : "2013-01-02 02:00:00" }
{ "name" : "object2", "value" : "123", "date" : "2013-01-02 02:00:00" } 
```

我在 Mongoose Schema 中使用的 map reduce 函数如下：

```
var o = {};
o.map = function () { 
  emit(
    { 'name': this.name },
    {'data': [ { 'value': this.value, 'date': this.date} ] }
  )
}

o.reduce = function (k, vals) { 
  var reduced = {'data': []};
  for (var i in vals) {
    reduced.data.push(vals[i]);
  }
  return reduced;
}

this.mapReduce(o, function(err, model) {
  if(err) console.log(err);
  model.find().exec(cb);
}); 
```

我想看到的是一些 JSON

```
[
  {
    "name": "object1",
    "data": [
      {
        "value": "123",
        "date": "2013-01-02T01:00:00.123456"
      },
      {
        "value": "456",
        "date": "2013-01-02T02:00:00.123456"
      },
    ]
  },
  {
    "name": "object2",
    "data": [
      {
        "value": "123",
        "date": "2013-04-22T13:10:03.893018"
      },
      ...
    ]
  },
  ... 
```

但我最终得到了这个嵌套的混乱！有人可以给我指点一下我错过了什么！！

```
[
  {
    "_id": {
      "name": "object1"
    },
    "value": {
      "data": [
        {
          "data": [
            {
              "data": [
                {
                  "data": [
                    {
                      "value": "123",
                      "date": "2013-01-02T02:00:00.123456"
                    }
                  ]
                },
                {
                  "data": [
                    {
                      "value": "465",
                      "date": "2013-01-02T01:00:00.123456"
                    }
                  ]
                },
                ... etc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:17:47.197

尝试这样的事情：（未经测试，但我认为这个想法就在这里:)）

```
var o = {};
o.map = function () { 
  emit(this.name, { 'value': this.value, 'date': this.date} )
}

o.reduce = function (k, vals) { 
  var reduced = {name: k, data : []};
  for (var i in vals) {
    reduced.data.push(vals[i]);
  }
  return reduced;

  // or just return vals? it's already the array you want.
} 
```

# sql - 将多个不同的数据库同步到一个数据库（sql Server 2008）

> ID：16156763
> 
> 赞同：0
> 
> 时间：2013-04-22T21:09:00.100
> 
> 标签：sql, database, sql-server-2008, ssis, sync

我需要有关如何完成此任务的建议...

我有 3 个员工解决方案 每个解决方案都有自己的数据库

我想做的是将所有这三个数据库统一为一个。我还希望足够灵活，以便将来添加一些其他员工解决方案。

我也想使用 SSIS。

我一直在想的是，创建一个 SSIS 包，在其中打开一个数据库并导入所有数据，这个 SSIS 包将使用“某物”，它表示某些数据库的列映射，因此 SSIS 知道什么 clumns 导入...

我试图尽可能清楚......有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T23:18:51.143

因此，如果您将新员工添加到中央数据库，则应该将其推送到其他三个。如果其他 3 个具有不同的架构和不同的平台，那么当您添加一个员工时，您需要确定它要去哪个数据库，并且您需要为每个数据库自定义插入代码。此外，您还需要考虑如果同一个人被意外添加到中央数据库和远程数据库，但信息略有不同，会发生什么情况。您最终会在远程数据库中得到一个副本。如果我正确理解您的要求，这更像是一个主数据应用程序而不是一个报告应用程序。

您的第一步是为您的中央数据库提出一个模式，这必须容纳三个远程数据库中的所有信息。然后，您需要考虑跨所有这些数据库合并信息的规则。即，如果一个数据库有“眼睛颜色”而另外两个没有，然后您在中央数据库中创建一个眼睛颜色的员工，但目标数据库没有该字段，可以吗？如果有人更改源数据库中的 DOB 会发生什么，这意味着更新中央数据库。如果您同时在两个数据库中这样做会怎样——谁是赢家？

您要解决的业务问题是什么？

# opengl - OpenGL 在对象旁边绘制文本

> ID：16156764
> 
> 赞同：1
> 
> 时间：2013-04-22T21:09:04.160
> 
> 标签：opengl, text, draw

我有这个正在工作的渲染功能：

```
 void RenderFunction(void)
{
    ++FrameCount;

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    drawGraph();
    drawAxis(); 

    glutSwapBuffers();
    glutPostRedisplay();
} 
```

这是给我一个点图。我希望能够显示一个小文本。我读了这篇文章：http: [//www.codersource.net/MFC/OpenGL/DisplayingTextOpenGLTutorial5.aspx](http://www.codersource.net/MFC/OpenGL/DisplayingTextOpenGLTutorial5.aspx)，唯一需要做的就是复制该函数并更新我的代码：

```
void RenderFunction(void)
{
    ++FrameCount;

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glLoadIdentity();
    drawBitmapText("Osama Hosam's OpenGL Tutorials",200,200,0);

    drawGraph();
    drawAxis(); 

    glutSwapBuffers();
    glutPostRedisplay();
} 
```

renderFunction 在里面被调用`glutDisplayFunc(RenderFunction);`

对此有任何想法。我想要任何建议，因为它没有显示任何内容。

更新：

```
void drawGraph(){
    glBindVertexArray(VaoId);
    glEnable(GL_LINE_SMOOTH);
    glLineWidth(0);
    glDrawElements(GL_LINES, 48, GL_UNSIGNED_BYTE, (GLvoid*)0);
    glPointSize(10);
    glDrawElements(GL_POINTS, 48, GL_UNSIGNED_BYTE, (GLvoid*)0);
}

void drawAxis(){
    glDisable(GL_LINE_SMOOTH);
    glBindVertexArray(VaoIdAxis);
    glDrawElements(GL_LINES, 4, GL_UNSIGNED_BYTE, (GLvoid*)0);
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/3ekcJ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T00:42:33.640

问题已解决。出于某种原因，在某些 OpenGL 上下文中不支持 drawBitmapText()。最初我有：

```
glutInitContextVersion(3, 3);
glutInitContextFlags(GLUT_FORWARD_COMPATIBLE);
glutInitContextProfile(GLUT_CORE_PROFILE); 
```

这会阻止应用程序呈现文本。我刚刚评论了 3 行，一切都很顺利。

# asynchronous - 分页中内容的异步加载

> ID：16156767
> 
> 赞同：2
> 
> 时间：2013-04-22T21:09:09.110
> 
> 标签：asynchronous, pagination, controls, javafx-2

我正在搜索用于从服务器异步加载数据的分页示例。我不知道如何使用 javafx 的分页控制来解决这个问题。好吧，我有一个示例，其中一个可观察列表在后台加载了 10k 个项目。但我只想在实际需要时加载页面的项目。因此，只有当用户切换到下一页时，我才想通过任务抓取接下来的 20 个项目。任务完成后，应呈现页面..

感谢您的任何建议和帮助！

链接到可观察示例： [https ://forums.oracle.com/forums/thread.jspa?messageID=10976705#10976705](https://forums.oracle.com/forums/thread.jspa?messageID=10976705#10976705)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T12:44:36.367

一旦用户单击页面，您所需要做的就是为您的任务启动一个后台线程。请参阅下一个示例，该示例使用站点下载来完成长期任务：

```
public class Pages extends Application {

    @Override
    public void start(Stage primaryStage) {
        final Pagination root = new Pagination(urls.length, 0);

        root.setPageFactory(new Callback<Integer, Node>() {
            // This method will be called every time user clicks on page button
            public Node call(final Integer pageIndex) {
                final Label content = new Label("Please, wait");
                content.setWrapText(true);
                StackPane box = new StackPane();
                box.getChildren().add(content);

                // here we starts long operation in another thread
                new Thread() {
                    String result;
                    public void run() {

                        try {
                            URL url = new URL(urls[pageIndex]);
                            URLConnection urlConnection = url.openConnection();
                            urlConnection.setConnectTimeout(1000);
                            urlConnection.setReadTimeout(1000);
                            BufferedReader breader = new BufferedReader(new InputStreamReader(urlConnection.getInputStream()));

                            StringBuilder stringBuilder = new StringBuilder();

                            String line;
                            while ((line = breader.readLine()) != null) {
                                stringBuilder.append(line);
                            }

                            result = stringBuilder.toString();
                        } catch (Exception ex) {
                            result = "Download failed";
                        }

                        // once operation is finished we update UI with results
                        Platform.runLater(new Runnable() {

                            @Override
                            public void run() {
                                content.setText(result);
                            }
                        });
                    }
                }.start();

                return box;
            }
        });

        Scene scene = new Scene(root, 300, 250);

        primaryStage.setTitle("Pages!");
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    private final static String[] urls = {"http://oracle.com", "http://stackoverflow.com", "http://stackexchange~.com", "http://google.com", "http://javafx.com"};

    public static void main(String[] args) {
        launch(args);
    }
} 
```

# joomla - Joomla JInput 默认值

> ID：16156771
> 
> 赞同：0
> 
> 时间：2013-04-22T21:09:23.483
> 
> 标签：joomla, joomla2.5

如果我使用以下方法从控制器中的表单中获取值：

```
$jinput = JFactory::getApplication()->input;
$add_name = $jinput->get('name', 'Default name', 'STRING'); 
```

我希望将默认值设置为一个名为`Default name`.

但是，如果我对此进行测试，它似乎认为没有价值：

```
if (!empty($add_name))
{
    //do stuff
    //I expect to be here because $add_name="Default name"
}
else
{
    //I actually go here
} 
```

我误解了默认值吗？

**编辑**

如果使用空字符串提交表单，那么这就是将返回的内容。我明白了（现在）。`Default name`但是在什么情况下会分配默认值`$add_name`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:43:23.703

如果您在表单中提交了一个空字符串，则使用它而不是默认值。JInput 会`isset()`检查， not `empty()`，因此空字符串被视为有效值。

# java - 如何将 bufferedInputStream 附加到字符串？

> ID：16156773
> 
> 赞同：0
> 
> 时间：2013-04-22T21:09:25.213
> 
> 标签：java, buffer, inputstream

基本上，我试图通过将现有的 BufferedInputStream(System.in) 切换到我自己的缓冲输入流来自动化击键。我想制作一个 BufferedInputStream() 对象，该对象附加到可以异步控制的字符串之类的东西上。

这就是我想做的..

```
StringBuilder stringBuilder=new StringBuilder;
BufferedInputStream output=new something(new something(stringBuilder)); 
```

目前我能看到的唯一选择是检查文件是否存在，然后打开一个缓冲的输入流。

我不太确定该怎么做，但我需要写一些可以代替 System.in inpustream 的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T02:48:18.103

我为此投入了 10 个小时的坚实时间……这就是我想出的……管道流是我需要的

```
 int BUFFER = 4096;
    PipedOutputStream toAppPipedOutputStream;
    PipedInputStream toAppPipedInputStream;

    static BufferedReader fromAppBufferedReaderfinal;
    BufferedOutputStream fromAppOutputStream;
    PipedOutputStream fromAppPipedOutputStream;
    PipedInputStream fromAppPipedInputStream;

    /* constructor sets up logging and parameters */

           try { 
                fromAppPipedInputStream = new PipedInputStream(BUFFER);
                fromAppOutputStream=new BufferedOutputStream(new PipedOutputStream(fromAppPipedInputStream));
                fromAppBufferedReaderfinal=new BufferedReader(new InputStreamReader(fromAppPipedInputStream));
                CASUAL.Log.out = new PrintStream(fromAppOutputStream);

                toAppPipedInputStream = new PipedInputStream(BUFFER);
                toAppPipedOutputStream=new PipedOutputStream(toAppPipedInputStream);
                CASUAL.CASUALInteraction.in= new BufferedReader(new InputStreamReader(toAppPipedInputStream)); 
```

在我的日志和输出类中，默认情况下，我写入指向 System.in 的缓冲读取器/写入器。我可以劫持它，因为它是一个公共静态，这是可能的。现在我可以读取和写入我的应用程序，就好像它在我自己的应用程序内的命令行上运行一样

# android - Android 错误 java.lang.NoSuchMethodError: android.view.MenuItem.getActionProvider

> ID：16156778
> 
> 赞同：1
> 
> 时间：2013-04-22T21:09:44.840
> 
> 标签：android, shareactionprovider

我启用了`ShareActionProvider`，我得到了这个错误：

```
java.lang.NoSuchMethodError: android.view.MenuItem.getActionProvider 
```

但是我使用这个类的方式是这样的：

```
 // SHARING ONLY ENABLED in SDK 14 which is Ice Cream Sandwich
    try
    {           
        if ( android.os.Build.VERSION.SDK_INT >= 14 )
        {
            Button share = (Button)findViewById(R.id.share_button); 
            share.setOnClickListener(new Button.OnClickListener() 
            {  
                public void onClick(View v) 
                {                   
                    openOptionsMenu();
                }
            });        
        }
        else
        {
            // HIDE THE TWO PAGE ELEMENTS
            Button share = (Button)findViewById(R.id.share_button); 
            TextView share_prompt = (TextView)findViewById(R.id.share_prompt); 

            share.setVisibility(View.GONE);
            share_prompt.setVisibility(View.GONE);              
        }
    }
    catch ( Exception e )
    {

    } 
```

所以我认为我不会显示早期sdk的共享按钮，我会没事的。但是我遇到了很多崩溃。

我无法真正对此进行测试，因为我没有带有早期版本 SDK 的手机。但这是否意味着所有使用早期 SDK 版本的人都会崩溃这些页面？还是只是点击分享的人？如何防止这种崩溃？

我在课堂上有这些方法。如果 sdk 小于 14，我应该不运行它们吗？

```
@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    getMenuInflater().inflate(R.layout.menu, menu);
    MenuItem item = menu.findItem(R.id.menu_item_share);
    myShareActionProvider = (ShareActionProvider)item.getActionProvider();
    myShareActionProvider.setShareHistoryFileName(
      ShareActionProvider.DEFAULT_SHARE_HISTORY_FILE_NAME);
    myShareActionProvider.setShareIntent(createShareIntent());
    return true;
}

private Intent createShareIntent() 
{
       Intent shareIntent = new Intent(Intent.ACTION_SEND);
       shareIntent.setType("text/plain");
       shareIntent.putExtra(Intent.EXTRA_TEXT, 
         "Some text");
       return shareIntent;
}

// Somewhere in the application.
public void doShare(Intent shareIntent) 
{
    // When you want to share set the share intent.
    myShareActionProvider.setShareIntent(shareIntent);
} 
```

谢谢。亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:33:07.677

`ShareActionProvider`仅适用于 API 14+，这意味着在早期版本中您无法使用它。如果你想在你的应用程序中添加分享按钮并支持旧的 API 级别，我可以建议你使用[ActionBarSherlock](https://github.com/JakeWharton/ActionBarSherlock) - 一个让你有机会在旧版本的 Android 中使用 ActionBar 的库。使用这个库你可以做这样的事情来添加分享按钮：

```
MenuItem actionItem = menu.findItem(R.id.menu_item_share_action_provider_action_bar);
ShareActionProvider actionProvider = (ShareActionProvider) actionItem.getActionProvider();
actionProvider.setShareHistoryFileName(ShareActionProvider.DEFAULT_SHARE_HISTORY_FILE_NAME);
actionProvider.setShareIntent(createShareIntent());

private Intent createShareIntent() {
    Intent shareIntent = new Intent(Intent.ACTION_SEND);
    shareIntent.setType("image/*");
    Uri uri = Uri.fromFile(getFileStreamPath("shared.png"));
    shareIntent.putExtra(Intent.EXTRA_STREAM, uri);
    return shareIntent;
} 
```

这将共享一个图像文件。如果您不想支持较旧的 API 级别，我建议您只检查 API 级别并根据使用情况`ShareActionProvider`。

希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:37:03.817

在文档中，您可以看到来自 14 API 的[MenuItem.getActionProvifer()](http://developer.android.com/reference/android/view/MenuItem.html#getActionProvider%28%29)，当然您会`java.lang.NoSuchMethodError`发现旧版本（每次使用新 API 中的方法或类时都会发现错误）。

使用 try-catch 并不能拯救你:) 你需要使用不同的实现和不同的关键 API 版本的解决方法 hanler-classes。

如果您将使用[ActionBarSherlock](http://actionbarsherlock.com/)，您可以在 Android API >= 8 中使用该方法。尝试为 maximem API 保存功能，这会很棒！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:28:49.720

是的，您需要对菜单项进行相同的检查。请参阅[`getActionProvider`](http://developer.android.com/reference/android/view/MenuItem.html#getActionProvider%28%29). 它仅在 14+ 上受支持。要在没有设备的情况下测试这种东西，您可以尝试使用旧版本 Android 的模拟器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-04T09:20:37.857

有一点晚....

> ShareActionProvider 和一般的 ActionProviders 从 Android 4.0（API 级别 14）添加到 Android 框架。但 AndroidSupportLibrary 也帮助我们在以前的版本中支持此功能。但通常我们从 Android SDK 框架导入 ShareActionProvider 而不是 SupportLibrary 时会出错。

*   代码：

-->在main.xml中：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">
    <item android:id="@+id/menu_share" android:title="@string/menuitem_detail_share"
        app:showAsAction="always"
        app:actionProviderClass="android.support.v7.widget.ShareActionProvider" />
</menu> 
```

**注意**：注意使用了“app”命名空间而不是“android”命名空间“为什么？=> 当使用支持库定义的任何 XML 属性时，这是必需的，因为这些属性在旧设备的 Android 框架中不存在。因此，您必须使用自己的命名空间作为支持库定义的所有属性的前缀。

--> 在 Activity 的 onCreateOptionsMenu() 中：

```
ShareActionProvider mShareActionProvider = (ShareActionProvider) MenuItemCompat.getActionProvider(menuItem);
Intent shareIntent = new Intent(Intent.ACTION_SEND);
        shareIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
        shareIntent.setType("text/plain");
        shareIntent.putExtra(Intent.EXTRA_TEXT, "The Text you want to share);
        mShareActionProvider.setShareIntent(shareIntent); 
```

**注意**：ShareActionProvider是从“import android.support.v7.widget.ShareActionProvider”导入的，观察“MenuItemCompat.getActionProvider()”的用法，获取ActionProvider实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-22T21:32:17.277

当您支持较低的 API 同时仍使用较高的 API 调用时，您需要添加条件。在这种情况下，IT 将失败，因为还没有这样的方法。我建议通过替换以下行来稍微提高代码的可读性：

```
if ( android.os.Build.VERSION.SDK_INT >= 14 ) 
```

和

```
if ( android.os.Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWITCH ) 
```

# ruby-on-rails-3 - rails check_box 总是有 0 值

> ID：16156783
> 
> 赞同：0
> 
> 时间：2013-04-22T21:10:02.270
> 
> 标签：ruby-on-rails-3

我有一个带有复选框的表格。表单映射到模型。根据 rails 文档以防止在未单击复选框且未发送此字段的任何内容时出现问题，rails 在复选框之前生成隐藏字段，值为 0。这是正确的。

不正确的是，在我单击复选框并提交表单后，我可以在发布请求中看到首先发送值 1，然后发送值 0（来自隐藏字段）因此，复选框始终值 0。

当文档说参数提取获取查询字符串中任何重复键的最后一次出现时，文档是正确的，但是发布请求中的顺序不正确？？？？

我使用导轨 3.2.11。

**看法**

```
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put }) do |f| %>
  <%= devise_error_messages! %>
    <p><%= f.label :name %><br />
    <%= f.text_field :name %></p>
...
    <div><%= f.label :send_dayplan_info %><br />
    <%= f.check_box :send_dayplan_info %>
    <div><%= f.submit "Update" %></div>
<% end %> 
```

**控制器** ...

```
def update  
    ...  
    if resource.update_with_password(params[resource_name])  
      ....  
    end  
end 
```

**摘要**
当我调试和评估 params[resource_name] 时，它始终包含 send_dayplan_info 字段的值 0。
当我单击复选框时，我可以在 firebug 发布请求中看到包含值：
user[send_dayplan_info]=1
user[send_dayplan_info]=0

当我取消单击复选框时，我可以在 firebug post request 中看到包含值：
user[send_dayplan_info]=0

下面是单击复选框
utf8 的表单数据：✓<br> _method: putauthentity_token
:....
user[name]:....
user[send_dayplan_info]:1
user[send_dayplan_info]:0

而生成的html的源代码是：
...

```
<div><label for="user_send_dayplan_info">Send dayplan info</label><br />  
<input name="user[send_dayplan_info]" type="hidden" value="0" /><input id="user_send_dayplan_info" name="user[send_dayplan_info]" type="checkbox" value="1" />  
<div><input name="commit" type="submit" value="Update" /></div> 
```

# javascript - 悬停时在链接下划线

> ID：16156784
> 
> 赞同：-1
> 
> 时间：2013-04-22T21:10:06.503
> 
> 标签：javascript, css

我正在寻找一种在鼠标悬停时在链接下方拍摄下划线并在鼠标未悬停时再次消失的方法。我不确定我是否做得很好，所以如果你不明白，请告诉我。我很确定这不能用实际的下划线来完成，也许用`<hr>`标签？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:12:53.887

```
a {
    text-decoration: none;
    display: inline-block;
    border-bottom: 1px solid blue;    
    margin-right: 39px; 
    width: 0px;
    -webkit-transition: 0.5s ease;
            transition: 0.5s ease;
}

a:hover {
    -webkit-transition: 0.5s ease;
            transition: 0.5s ease;
    border-bottom: 1px solid blue;
    width: 30px;
    margin-right: 9px;
} 
```

取自这里：[下划线 css3 过渡](https://stackoverflow.com/questions/15489203/underline-css3-transition)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:44:21.663

这是非常简单的 CSS：

```
a {
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
} 
```

但这只是为了悬停效果，如果你想要一个过渡，那么上面的答案应该可以工作。

# python - 如何将图像从 scikit-image 转换为 opencv2 和其他库？

> ID：16156788
> 
> 赞同：12
> 
> 时间：2013-04-22T21:10:18.097
> 
> 标签：python, opencv, image-processing, contour, scikit-image

我试图在使用 scikit-image 创建的骨架化图像中使用 cv2 python 库查找轮廓，但出现此错误：

```
 contours, hierarchy = cv2.findContours(skel,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)
TypeError: <unknown> data type = 0 is not supported 
```

我的问题是：我必须做什么才能转换为 cv2，反之亦然？

我知道 opencv 使用 numpy.uint8 类型来表示二进制图像而不是 scikit-image numpy.float64

我还使用了 mahotas (numpy.bool) 和 pymorph 库。如何从 scikit-image 转换为这些库，反之亦然？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-23T11:22:17.503

`scikit-image`提供不同数据类型之间的转换例程，也正确保留缩放：

```
from skimage import img_as_ubyte

cv_image = img_as_ubyte(any_skimage_image) 
```

更新：scikit-image 用户指南现在有一个更详细的部分：[http ://scikit-image.org/docs/stable/user_guide/data_types.html#working-with-opencv](http://scikit-image.org/docs/stable/user_guide/data_types.html#working-with-opencv)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-25T09:19:00.240

这对我有用：

```
image = skimage.io.imread(mpath)
img = image[:, :, ::-1] # convert image from RGB (skimage) to BGR (opencv)
cv2.namedWindow('original', cv2.WINDOW_NORMAL)
cv2.imshow('original',img) 
```

# android - Android ViewFlipper showNext 后黑屏

> ID：16156790
> 
> 赞同：2
> 
> 时间：2013-04-22T21:10:34.457
> 
> 标签：android

使用 ViewFlipper 时遇到奇怪的问题。在我调用 ViewFlipper.showNext(); 我有黑屏。当我将活动发送到后台并重新打开它时，视图按预期显示。这发生在 AVD 模拟器 API 15 上，API 10 上的相同代码按预期工作。我无法在真实设备上测试此问题，因为我只有 API 8 设备。

我的代码如下所示：

```
ViewFlipper vf = findViewById(R.id.viewFliper1);
vf.invalidate();
vf.showNext();
methodcall-it sets some TextView inside shown view 
```

我尝试了几乎所有无效、显示文本和方法调用顺序的组合，但仍然没有成功。由于这项工作在 API 级别 10 AVD 而不是 API 级别 15 AVD 中工作，我不确定这个 AVD 错误还是我的问题。

也许 ViewFlipper 是 TabHost 的一部分的信息对于为您解决这个问题很有用......

提前致谢...

# r - 配对 data.table 中的行

> ID：16156791
> 
> 赞同：4
> 
> 时间：2013-04-22T21:10:40.130
> 
> 标签：r, data.table

我有一个类似于使用以下命令获得的数据表：

```
dt <- data.table(
  time = 1:8,
  part = rep(c(1, 1, 2, 2), 2),
  type = rep(c('A', 'B'), 4),
  data = rep(c(runif(1), 0), 4)) 
```

基本上，这样的表包含两种不同类型的实例（A 或 B）。时间列包含请求到达或离开某个部分的时间戳。如果实例类型为 A，则时间戳说明到达时间（进入），如果类型为 B，则时间戳说明离开时间（退出）。

```
 time part type      data
1:    1    1    A 0.5842668
2:    2    1    B 0.0000000
3:    3    2    A 0.5842668
4:    4    2    B 0.0000000
5:    5    1    A 0.5842668
6:    6    1    B 0.0000000
7:    7    2    A 0.5842668
8:    8    2    B 0.0000000 
```

我想将A和B实例配对，得到如下数据表：

```
 part data        enter.time exit.time
1:    1 0.4658239   1          2
2:    1 0.4658239   5          6
3:    2 0.4658239   3          4
4:    2 0.4658239   7          8 
```

我尝试了以下方法：

```
pair.types <- function(x) {
  a.type <- x[type == 'A']
  b.type <- x[type == 'B']
  return(data.table(
      enter.time = a.type$time,
      exit.time = b.type$time,
      data = a.type$data))
}

dt[, c('enter.time', 'exit.time', 'data') := pair.types(.SD), by = list(part)] 
```

但是，这给了我以下，这不是我想要的：

```
 time part type      data enter.time exit.time
1:    1    1    A 0.3441592          1         2
2:    2    1    B 0.3441592          5         6
3:    3    2    A 0.3441592          3         4
4:    4    2    B 0.3441592          7         8
5:    5    1    A 0.3441592          1         2
6:    6    1    B 0.3441592          5         6
7:    7    2    A 0.3441592          3         4
8:    8    2    B 0.3441592          7         8 
```

它有点接近，但由于保留了“类型”列，所以有些行是重复的。也许，我可以尝试删除列“时间”和“类型”，然后删除行的后半部分。但是，我不确定这是否适用于所有情况，我想学习一种更好的方法来执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:23:10.930

假设您的数据看起来像您的示例数据：

```
dt[, list(part = part[1],
          data = data[1],
          enter.time = time[1],
          exit.time = time[2]),
     by = as.integer((seq_len(nrow(dt)) + 1)/2)]
#    by = rep(seq(1, nrow(dt), 2), each = 2)]
#    ^^^ a slightly shorter and a little more readable alternative 
```

这个想法非常简单 - 将行分组为 2 组（这就是`by`部分），即每个组将是一个 A 和一个 B，然后对于每个组先取第一`part`，`data`然后进入和退出时间只是第一和第二`time`的分别。如果您遵循手动逻辑，这可能就是您执行此操作的方式，使其易于阅读（一旦您对工作原理了解一点点`data.table`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:29:22.670

另一种方式：

```
setkey(dt, "type")
dt.out <- cbind(dt[J("A"), list(part, data, entry.time = time)][, type := NULL], 
      exit.time = dt[J("B"), list(time)]$time)
#    part      data entry.time exit.time
# 1:    1 0.1294204          1         2
# 2:    2 0.1294204          3         4
# 3:    1 0.1294204          5         6
# 4:    2 0.1294204          7         8 
```

如果你愿意，你现在`setkey(dt.out, "part")`可以得到相同的订单。

* * *

这个想法：你的问题对我来说似乎是一个简单的“重塑”问题。我接近它的方式是首先创建一个键列作为`type`. 现在，我们可以通过以下方式为键列中的特定值设置 data.table 的子集：`dt[J("A")]`。这将返回整个`data.table`. 由于您希望`time`重命名列，因此我明确提到要使用哪些列进行子集化：

```
dt[J("A"), list(part, data, entry.time = time)] 
```

当然，这也会返回`type`我们必须删除的列 (= A)。因此，我添加了一个通过引用`[, type := NULL]`删除列`type`。

现在我们有了第一部分。我们需要的只是`exit.time`. 这可以类似地获得：

```
dt[J("B"), list(time)] # I don't name the column here 
```

但这给出了`data.table`当您只需要时间列时，可以通过以下方式访问：

```
dt[J("B"), list(time)]$time 
```

因此，在使用`cbind`此列时，我`exit.time`将最终结果命名为：

```
cbind(dt[J("A"), list(part, data, entry.time = time)][, type := NULL], 
      exit.time = dt[J("B"), list(time)]$time) 
```

希望这可以帮助。

# ruby - Linux 不使用 CURL 安装 RVM

> ID：16156792
> 
> 赞同：1
> 
> 时间：2013-04-22T21:10:45.297
> 
> 标签：ruby, linux, ubuntu, curl, rvm

由于某种原因，我当前的环境（包括公司代理）不允许我使用 CURL 或 WGET 安装 RVM。在没有这些实用程序的情况下，是否有另一种从源代码安装 RVM 的方法？我所做的每个网络搜索都会返回“卷曲”方式。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T23:33:51.680

**修改 rvm 脚本不是一个好主意**

我在想睡觉的时候想着你的问题/我的答案……如果不给你写另一个答案，我就无法闭上眼睛。破解 rvm 安装脚本真的不是你应该做的。Rvm 在任何地方都使用 curl（安装、下载 rubies、更新……）。而且你必须下载更多的东西——例如宝石。替换每个脚本中的每个 curl 调用是不可维护的。

**建议的解决方案**

rvm 的好处是，它将*所有*数据存储在`~/.rvm`目录中。考虑到这一点，您可以在远程计算机（或 VM）上安装 rvm，它与您的开发计算机*尽可能相似*（相同的操作系统、相同的操作系统版本、相同的库）。安装所有你需要的红宝石、宝石和宝石。然后将压缩`~/.rvm`目录移动到您的开发计算机并将其解压缩为`~/.rvm`.

别忘了做

```
echo "source $HOME/.rvm/scripts/rvm" >> ~/.bash_profile 
```

在加载 bash 时获取 rvm。

如果您必须更新或安装 gems 或 ruby​​ 版本，请在远程计算机上执行您的业务，然后`~/.rvm`再次复制。

**我对此设置的体验**

我现在使用这个设置（尽管它是通过我们的 CI 服务器自动化的）已有 2 年时间，用于生产环境，它位于类似的邪恶公司网络中。更换宝石/红宝石比应有的困难，但它可以在没有互联网连接的情况下工作。

编辑：添加了一段关于我对此设置的体验

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T22:20:05.790

[您可以在此处](https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)找到 rvm 安装脚本。你可以

1.  下载它
2.  修改使用 curl 的部分
3.  执行脚本，现在引用手动下载的文件

**1\. 下载**

[将此文件](https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)下载到`/tmp/rvm-installer`. 现在将[rvm.tar.gz](https://github.com/wayneeseguin/rvm/archive/1.19.6.tar.gz)文件下载到`/tmp/rvm-1.19.6.tar.gz`

**2.修改文件**

在第 148 行开始 function `fetch_version`。将其替换为以下函数：

```
fetch_version()
{
    echo '1.19.6' # the current version, as of writing this
} 
```

在第 161 行（在 内`install_release`）`get_and_unpack`调用该函数。将函数调用替换为：

```
get_and_unpack \
  /tmp/rvm-${_version}.tar.gz \
  rvm-${_version}.tar.gz 
```

在第 212 行（内`get_and_unpack`）替换

```
__rvm_curl ${_url} -o ${rvm_archives_path}/${_file} || 
```

和：

```
mv ${_url} ${rvm_archives_path}/${_file} || 
```

**3.最后安装rvm**

```
cd /tmp
cat rvm-installer | bash -s -- --version latest --autolibs=enabled 
```

免责声明：这仍然是一个黑客。它安装了 rvm，但我不知道更新（这里 rvm 再次使用 curl）。祝你好运 ：）

# python - 如何不放自我。在初始化 Python 类中的每个属性时？

> ID：16156797
> 
> 赞同：5
> 
> 时间：2013-04-22T21:11:14.047
> 
> 标签：python

问候。
我搜索了很长时间，发现很多相关问题没有给我答案。尽管我的似乎是一个简单的初学者疑问。

我们有一个（我猜）典型的类定义：

```
class Town:
    def __init__(self, Name, Ruler = "Spanish Inquisition"):
        self.Name = Name
        self.Population = 0
        self.LocationX = 0
        self.LocationY = 0
        self.Religion = "Jedi"
        self.Ruler = Ruler
        self.Products = ["Redstone", "Azaleas"] 
```

你明白了。很多属性。我需要所有这些。

问题是：**有没有捷径可以拯救所有这些“自我”？**我是不是太懒了？我希望有类似的东西：

```
with self:
    Name = Name
    Population = 0
    ... 
```

我当然知道这是行不通的（这不是“with”的使用，并且参数位于错误的名称空间中。...我猜对了吗？）。

我想有很多替代方案可以达到相同的结果，但我真的很好奇 Python 类的强大功能，我认为其他人问这个问题没有成功。

（一个相关问题：[组织类属性、构造函数参数和子类构造函数默认值的大多数“pythonic”方式？](https://stackoverflow.com/questions/1118006/most-pythonic-way-of-organising-class-attributes-constructor-arguments-and-su)）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T21:12:46.610

简短的回答：不，你不能。`self`在 Python 中访问实例成员（属性、方法）时必须使用它。

澄清：`self`不是 Python 中的关键字。原则上，您可以给方法的第一个参数起任何名称，但约定要求您应该调用它`self`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-22T21:18:52.370

你不会交任何朋友，但有一种方法......：

```
class Town2:
    def __init__(self, name, ruler = 'Spider Pig'):
        self.__dict__.update(dict(
            Name = name,
            Population = 0,
            LocationX = 0,
            LocationY = 0,
            Religion = "Jedi",
            Ruler = ruler,
            Products = ["Redstone", "Azaleas"])) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-22T21:33:36.613

这是一种避免过度`self`打字的方法，同时与 DRY 保持一致：

```
class Town(object):
    def __init__(self, name, data={}):
        setattr(self, 'name', name)
        for k,v in data.iteritems():
            setattr(self, k, v)

default_town_info = {
    'population': 0,
    'location_x': 0,
    'location_y': 0
    }

a = Town('foo', default_town_info)
print a.name
print a.population
print a.location_x 
```

这仍然允许您访问您的属性，返回：

```
foo
0
0 
```

所以是的，有 2 种自我用途，但如果您总是传递一个字典来确保提供您需要的属性，例如“名称”，它可以减少。

# javascript - 使用jQuery向下滚动到一定数量的像素

> ID：16156801
> 
> 赞同：5
> 
> 时间：2013-04-22T21:11:26.947
> 
> 标签：javascript, jquery, html, css

您可以使用 jQuery 将页面向下滚动到某个像素吗？

我正在构建一个在滚动时具有固定导航栏的网站，当单击按钮时，它将使用 jQuery 平滑滚动插件滚动到某个锚点。

问题是导航栏与该部分重叠，因此它会切断一半的文本。

随着 jQuery 动画网站数量的增加，我确信之前一定有人遇到过这个问题，但我似乎找不到答案。

我已经在有问题的 Wordpress 网站上安装了 Smooth scroll 插件，并且在该部分中有以下代码：

```
<div id="web"></div>, <div id="app"></div>, <div id="seo"></div> 
```

每个按钮应滚动到总共三个部分。

网址：www.gogoblondie.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:24:12.433

无需使用奇怪的插件；）
这应该给您一个想法：

`**[LIVE DEMO](http://jsbin.com/ucijan/2/edit)**`

```
 <nav>
    <ul>
      <li><a href="#web">WEB</a></li>
      <li><a href="#app">APP</a></li>
      <li><a href="#seo">SEO</a></li>
    </ul>
  </nav>  

  <div id="web" class="page" style="margin-top:200px;">WEB</div>
  <div id="app" class="page">APP</div>
  <div id="seo" class="page">SEO</div> 
```

CSS：

```
nav{ 
  position:fixed;
  top:0px;
  width:100%;
  height:200px;
  background:#cf5;
  z-index:2;
}
.page{ 
  position:relative;
  min-height: 800px; 
} 
```

问：

```
var navHeight = $('nav').outerHeight();

$('nav a').click(function( e ){
  e.preventDefault();
  var myHref = $(this).attr('href');
  var newPos = $(myHref).offset().top;
  $('html, body').stop().animate({scrollTop: newPos-navHeight}, 1300);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:14:29.883

[scrollTo](https://github.com/flesler/jquery.scrollTo)是一个不错的 jQuery 插件，它可以让你滚动到一个带有偏移量的元素。

# php - Android浏览器显示php隐藏字段数据？

> ID：16156803
> 
> 赞同：0
> 
> 时间：2013-04-22T21:11:32.640
> 
> 标签：php, android

我使用隐藏字段通过 php 表单传递数据。对于windows浏览器，我没有任何问题。使用 Android 浏览器，隐藏的字段将可见并导致一些问题。如何修改我的代码？

谢谢！

罗杰

# iphone - UITableView 在添加元素时调整大小

> ID：16156807
> 
> 赞同：0
> 
> 时间：2013-04-22T21:11:49.143
> 
> 标签：iphone, ios, uitableview, storyboard

我正在为 iPhone 开发 IRC 客户端，但我的 UITableView 出现问题。

首先，我调整了 tableview 的大小，以便在用户输入消息时工具栏和键盘适合屏幕。看起来像这样：

![用户输入模式](https://i.stack.imgur.com/wR6Pc.png)

但问题是，当用户完成输入并想要发送消息（发送到流并添加到表格视图）时，表格视图被调整大小并且工具栏被放在底部但键盘仍然存在，我不知道哪个文本字段要辞去第一响应者的职务，我想在按下发送按钮之前和之后将键盘和工具栏保持在其位置。看起来像这样：

![失败模式](https://i.stack.imgur.com/zQsPa.png)

这是我的一些代码：

- 调整窗口大小

```
// Keyboard will show
- (void)keyboardWillShow {
    [UIView animateWithDuration:0.25 animations:^{
        [self.tableView setFrame:CGRectMake(0, 0, 320, 177)];
    }];

    [UIView animateWithDuration:0.25 animations:^{
        [self.toolBar setFrame:CGRectMake(0, 177, 320, 43)];
    }];    
}

// Keyboard will hide
- (void)keyboardWillHide {
    [UIView animateWithDuration:0.25 animations:^{
        [self.tableView setFrame:CGRectMake(0, 0, 320, 481)];
    }];

    [UIView animateWithDuration:0.25 animations:^{
        [self.toolBar setFrame:CGRectMake(0, 393, 320, 43)];
    }];    
} 
```

- 向表格视图添加元素

```
// Retrieve the sender and the message from the input and add it to the data context
- (void)addMessage:(NSString *) input isSender: (BOOL) sender {
    Message *messageToBeAdded = [[Message alloc] init];
    [messageToBeAdded setIsSender:sender];

    NSArray *arr = [input componentsSeparatedByString:[NSString stringWithFormat:@"PRIVMSG %@ :",[connection channel]]];
    [messageToBeAdded setMessage:[arr objectAtIndex:1]];

    arr = [input componentsSeparatedByString:@"!"];

    if (sender) {
        [messageToBeAdded setSender:[connection nick]];
    } else {
        NSString *tmp = [arr objectAtIndex:0];
        [messageToBeAdded setSender:[tmp substringWithRange:NSMakeRange(1, [tmp length]-1)]];
    }

    [_messageList addObject:messageToBeAdded];

    NSIndexPath *indexPath = [NSIndexPath indexPathForRow:[_messageList count]-1 inSection:0];
    [self.tableView insertRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
} 
```

我到处看了，我确定它与 tableview 的添加部分有关。我将不胜感激任何帮助或指导。

谢谢！

编辑：我刚刚意识到这与使用自定义单元格有关。我创建了一个新项目并尝试逐步模拟我所做的事情。在我使用带有 UILabel 的自定义单元格时，一切都运行良好。UILabel 通过插座连接到 UITableViewCell 类，这就是问题发生的地方。

```
#import <UIKit/UIKit.h>

@interface CustomCell : UITableViewCell

@property (strong, nonatomic) IBOutlet UILabel *myLabel;
@end 
```

有没有想过这里可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T00:23:15.913

文本字段控制键盘，因此 resignfirstresponder 向键盘发送一条消息以删除自己。乐队是移动到屏幕底部还是在按下发送按钮后被移除。无论哪种方式，按照迈克尔说的去做，一旦键盘消失，你就会知道横幅会发生什么。我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:20:15.200

我猜你`UITextField`的工具栏中有一个。尝试...

```
[aTextField resignFirstResponder]; 
```

...当您处理按下发送/返回按钮时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T05:28:37.827

您可以使用 UITextFieldDelegate -

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField
{
     [textField resignFirstResponder];
} 
```

或者，如果您有 textField 的 IBOutlet，则在“键盘将隐藏”中调用 resignFirstResponder

```
// Keyboard will hide
- (void)keyboardWillHide {

      [self.myTextField resignFirstResponder];

      [UIView animateWithDuration:0.25 animations:^{
          [self.tableView setFrame:CGRectMake(0, 0, 320, 481)];
      }];

      [UIView animateWithDuration:0.25 animations:^{
          [self.toolBar setFrame:CGRectMake(0, 393, 320, 43)];
      }];    
} 
```

# iphone - 跟踪精灵

> ID：16156808
> 
> 赞同：-1
> 
> 时间：2013-04-22T21:12:17.560
> 
> 标签：iphone, ios, objective-c, cocos2d-iphone

我正在创建一个 Cocos2D 应用程序，该应用程序将具有 4 - 12 个用户可以与之交互/移动的精灵（图片中的精灵 1 - 4）。将有相同数量的目标精灵，用户将能够将其他精灵拖到（图中的目标 1 - 4）。我正在考虑为所有精灵添加标签以区分它们。我遇到的困难是确定跟踪可移动精灵的正确方法，这些可移动精灵与每个精灵都位于哪些目标精灵之上。

我应该如何跟踪这些关系？

*   精灵 1 - 目标 3
*   精灵 2 - 目标 1
*   精灵 3 - 目标 2
*   精灵 4 - 目标 4

![精灵和目标](https://i.stack.imgur.com/7SrOT.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:10:14.647

创建两个不同的可变数组来保存你的对象和一个数组来保存你的正确答案，即

```
//In your .h
NSMutableArray *_targets;
NSMutableArray *_moveableSprites;
NSArray *_answers;

//In your .m
_targets = [[NSMutableArray alloc] init];
_moveableSprites = [[NSMutableArray alloc] init];
_answers = [[NSArray alloc] initWithObjects:@"101", @"103", @"102", @"104", nil]; 
```

当你创建你的精灵时，为它们分配一个标签值，即

```
CCSprite *target1 = [CCSprite spriteWithFile:@"file.png"];
//Make sure target tags start from 0 and increment up
target1.tag = 0; 
```

然后在将每个精灵添加到图层之前，将它们添加到各自的数组中，即

```
[_targets addObject:target1]; 
```

然后，您可以编写一个方法来检查精灵位置（类似于此）：

```
- (void)checkSprites {
    for(CCSprite *sprite in _moveableSprites) {
        for(CCSprite *target in _targets) {
            if(CGRectIntersectsRect(sprite.boundingBox, target.boundingBox)) {
                if(sprite.tag == [_answers objectAtIndex:target.tag]) {
                    // Correct sprite in target.....do stuff
                } else {
                    // Not correct sprite.....do stuff
                }
            }
        }
    }
} 
```

# asp.net - Nancy中不同客户端的不同HttpStatusCode

> ID：16156809
> 
> 赞同：0
> 
> 时间：2013-04-22T21:12:18.520
> 
> 标签：asp.net, nancy, dhc

导航到下面的代码后[，Restlet](https://chrome.google.com/webstore/detail/dev-http-client/aejoelaoggembcahagimdiliamlcdmfm)`http://localhost:57645`为 DHC 返回 200（OK），为“Chrome 浏览器”返回 500（InternalServerError）。

```
public class SampleModule : Nancy.NancyModule
{
    public SampleModule()
    {
        Get["/"] = _ =>
        {
            return Negotiate
                .WithStatusCode(HttpStatusCode.OK)
                .WithModel(10);
        };
} 
```

这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:45:43.693

您在第一个示例中遇到的行为是预期的。浏览器正在请求`text/html`

`Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8`

Nancy 试图根据 type 定位视图`10`，因为`10`它是 的类型`Int32`，Nancy 试图找到一个视图，`Int32`因为它试图用 View 响应，因为这是浏览器要求的。

默认情况下，您在 Chrome 中使用的开发客户端很可能会发送 JSON 请求，这就是它似乎可以正常工作的原因。

您可以在此处阅读有关此内容的更多信息：

[http://www.philliphaydon.com/2013/04/nancyfx-revisiting-content-negotiation-and-apis-part-1/](http://www.philliphaydon.com/2013/04/nancyfx-revisiting-content-negotiation-and-apis-part-1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T13:37:52.563

找到了！在我的情况下最好使用

```
return Response.AsJson(10); 
```

# requirejs - 使用 requireJS 加载 javascript 模板文件失败

> ID：16156811
> 
> 赞同：0
> 
> 时间：2013-04-22T21:12:26.443
> 
> 标签：requirejs

以下代码不起作用：

```
define([
  'jquery',
  'lodash',
  'backbone',
  'mustache',
  'text!/app/js/templates/TreeCombo/TreeCombo.html' //Is this right?
  ], function($, _, Backbone, Mustache, MyTemplate){
 ...
}) 
```

我在控制台中收到以下错误消息：

```
GET http://localhost:8888/app/js/text.js 404 (File not found) 
```

似乎 requireJS 无法识别“文本！” 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:15:45.413

您需要在项目中包含[“文本”插件](https://github.com/requirejs/text)（并在需要时设置它的路径`require.config`）。它没有捆绑在一起。

# delphi - 如何将多个文件夹压缩到一个存档中？

> ID：16156812
> 
> 赞同：1
> 
> 时间：2013-04-22T21:12:35.423
> 
> 标签：delphi, zip, archive, subdirectory, delphi-xe3

我有一些压缩组件（如 KAZip、JVCL、zLib）并且完全知道如何使用它们来压缩文件，但是我想将多个文件夹压缩到一个存档中并在提取后保持文件夹结构，我该怎么做？

* * *

在所有这些组件中，我只能给出一个要压缩的文件列表，我不能给出要提取的文件夹结构，没有办法（或者我找不到）告诉每个文件必须在哪里提取：

我在文件夹 FOLDER_A 中有一个名为 myText.txt 的文件，在文件夹 FOLDER_B 中有一个同名的文件 myText.txt：

```
|  
|__________ FOLDER_A  
|   |________ myText.txt  
|  
|__________ FOLDER_B  
|   |________ myText.txt  
| 
```

我可以提供要压缩的文件列表：myList(myText.txt, myText.txt) 但我无法提供解压缩文件的结构，找到哪个文件属于哪个文件夹的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T10:06:31.657

zip 格式只是没有文件夹。嗯，它有点，但它们是一种空的占位符，只有在你需要像用户访问权限这样的元数据存储时才插入。但除了那些相当罕见的高级东西 - 根本不需要文件夹。真正做了什么——你可以观察到在记事本中打开 zip 文件并滚动到最后——每个文件都有它的路径，从“归档根”开始。在您的示例中，zip 文件应该有两个条目（两个文件）：

*   FOLDER_A/myText.txt
*   FOLDER_B/myText.txt

请注意，使用的分隔符是真正的斜杠，在 UNIX 世界中很常见，而不是在 DOS/Windows 世界中使用的反斜杠。有些库会为您修复反斜杠，有些则不会 - 只是做您的测试。

现在，让我们假设该树包含在`D:\TEMP\Project`- 仅作为示例。

*   D:\TEMP\Project\FOLDER_A\myText.txt
*   D:\TEMP\Project\FOLDER_B\myText.txt

还有两个问题（路径分隔符除外）：其中是否有更多文件夹`D:\TEMP\Project\`应该被忽略，而不是压缩（比如可能`D:\TEMP\Project\FOLDER_C\*.*`？并且您的 zip-library 是否有直接 API 来打包文件夹及其内部子文件夹和文件或你应该逐个文件吗？

在选择图书馆时，您应该问自己并检查这三个问题。代码草案会有所不同。

现在让我们开始为库本身起草：

* * *

默认变体只是使用 Delphi 本身。

1.  枚举文件夹中的文件：[http://docwiki.embarcadero.com/CodeExamples/XE3/en/DirectoriesAndFilesEnumeraion_(Delphi)](http://docwiki.embarcadero.com/CodeExamples/XE3/en/DirectoriesAndFilesEnumeraion_(Delphi))
2.  如果该枚举的结果是从一开始`absolute paths`就去掉共同点`D:\TEMP\Project`：类似于`If AnsiStartsText('D:\TEMP\Project\', filename) then Delete(filename, 1, Length('D:\TEMP\Project\'));`. 您应该获得相对于所选包含位置的路径。特别是如果您不压缩整个路径并且将一些 FOLDER_C 保存在存档之外。
3.  也许您还应该调用`StringReplace`将文件名上的 '\' 更改为 '/'
4.  [然后您可以使用http://docwiki.embarcadero.com/Libraries/XE2/en/System.Zip.TZipFile.Add](http://docwiki.embarcadero.com/Libraries/XE2/en/System.Zip.TZipFile.Add)压缩它们- 注意指定正确的相对关系`ArchiveFileName`，如前所述`FOLDER_A/myText.txt`

* * *

您可以使用 ZipMaster 库。它非常受 VCL 约束，可能会导致使用线程或 DLL 出现问题。但对于简单的应用程序，它只是工作。[http://www.delphizip.org/](http://www.delphizip.org/)

最后一个版本页面有指向“设置”包的链接，该包有源代码、帮助和演示。在演示中有一个功能齐全的存档浏览器，能够存储文件夹。因此，您可以直接从中读取代码。[http://www.delphizip.org/191/v191.html](http://www.delphizip.org/191/v191.html)

* * *

您谈到了 JVCL，这意味着您已经安装了 Jedi CodeLib。JCL 带有一个适当的类和函数，根据名称判断也可以直接做你想做的事：`function TJclSevenzipCompressArchive.AddDirectory(const PackedName: WideString; const DirName: string = ''; RecurseIntoDir: Boolean = False; AddFilesInDir: Boolean = False): Integer;`

*实际上，所有这些库在基本级别上都非常相似，当我进行 XLSX 导出时，我只是创建了一个统一的压缩 API，它与实际安装的压缩引擎没有区别。但它适用于内存中的 TStream 而不是磁盘文件，因此不会直接帮助您。但是我刚刚了解到，除了地面上的一些怪癖（例如即时与延迟压缩）之外，所有这些库的工作方式都是一样的。*

# jsf - 如何将通用内容包含到多级模板页面中

> ID：16156817
> 
> 赞同：3
> 
> 时间：2013-04-22T21:12:48.393
> 
> 标签：jsf, facelets

我正在尝试在模板中包含一个通用页面，但我得到的只是一个没有错误的空白页面。

common.xhtml 实际上有 template.xhtml 中指示的内容。似乎 template.xhtml 无法识别两级包含。

模板.xhtml

```
<html xmlns="http://www.w3.org/1999/xhtml" 
 xmlns:ui="http://java.sun.com/jsf/facelets"
 xmlns:h="http://java.sun.com/jsf/html"
 xmlns:f="http://java.sun.com/jsf/core"
 xmlns:s="http://jboss.com/products/seam/taglib"
 xmlns:c="http://java.sun.com/jstl/core"
 xmlns:ub="http://jboss.com/products/seam/ub-taglib"
 xmlns:rich="http://richfaces.ajax4jsf.org/rich">

<head>
  <ui:insert name="css" />  
  <ui:insert name="header" />
</head>

<body>
 <ui:insert name="body" />  
</body>
</html> 
```

自定义.xhtml

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:rich="http://richfaces.ajax4jsf.org/rich"
    xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
    xmlns:c="http://java.sun.com/jstl/core"
    template="template.xhtml">

    <ui:define name="css">
        <link rel="stylesheet" type="text/css" href="/custom.css/>
    </ui:define>

    <ui:include src="common.xhtml" />

</ui:composition> 
```

common.xhtml

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:rich="http://richfaces.ajax4jsf.org/rich"
    xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
    xmlns:c="http://java.sun.com/jstl/core"
    template="template.xhtml">

    <ui:define name="header">
        <h1>header</h1>
    </ui:define>
    <ui:define name="body">
        <table><tr><td>Table</td></tr></table>
    </ui:define>    
</ui:composition> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:21:43.013

这确实行不通。`<ui:define>`应该在模板客户端（即带有 的页面）中使用`<ui:composition template="...">`，而不是在包含文件中（即`<ui:composition>`没有的页面`template`）。但是，您可以仅从现有主模板“扩展”。

从中删除`custom.xhtml`：

```
<ui:include src="common.xhtml" /> 
```

在某一方面的变化`common.xhtml`

```
template="custom.xhtml" 
```

并打开`common.xhtml`而不是`custom.xhtml`在浏览器中。

### 也可以看看：

*   [如何使用 JSF 2.0 Facelets 在 XHTML 中包含另一个 XHTML？](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets/4793959#4793959)

* * *

**与具体问题无关**，为防止最终用户表单无法打开`custom.xhtml`或`template.xhtml`直接在浏览器中打开，建议将其移至`/WEB-INF`文件夹中。此外，您知道`<h:head>`和`<h:outputStylesheet>`组件吗？我建议利用它们。此外，`<h1>`最终以最终结束`<head>`是没有意义的。也许你的意思是`<ui:insert name="header">`在里面`<body>`？此外，您可以轻松地将其`<h1>`放入模板中，这样您就无需在每个模板客户端中重复它们。

`/WEB-INF/templates/template.xhtml`

```
<html ...>
    <h:head>
    </h:head>
    <h:body>
        <ui:insert name="header" />
        <ui:insert name="body" />
    </body>
</html> 
```

`/WEB-INF/templates/custom.xhtml`（CSS文件放在`/resources`文件夹中）

```
<ui:composition ... template="/WEB-INF/templates/template.xhtml">
    <ui:define name="header">
        <h1><ui:insert name="custom-header" /></h1>
    </ui:define>
    <ui:define name="body">
        <h:outputStylesheet name="custom.css" target="head" />
        <ui:insert name="custom-body" />
    </ui:define>
</ui:composition> 
```

`/page.xhtml`

```
<ui:composition ... template="/WEB-INF/templates/custom.xhtml">
    <ui:define name="custom-header">
        header
    </ui:define>
    <ui:define name="custom-body">
         <table><tr><td>Table</td></tr></table>
    </ui:define>
</ui:composition> 
```

### 也可以看看：

*   [我需要将哪些 XHTML 文件放入 /WEB-INF 而哪些不需要？](https://stackoverflow.com/questions/9031811/which-xhtml-files-do-i-need-to-put-in-web-inf-and-which-not)
*   [如何在 Facelets 模板中引用 CSS / JS / 图片资源？](https://stackoverflow.com/questions/8367421/how-to-reference-resource-in-facelets-template/8368727#8368727)

# javascript - 如何通过添加资源的 Javascript 启动 Alfresco 工作流

> ID：16156819
> 
> 赞同：3
> 
> 时间：2013-04-22T21:12:49.193
> 
> 标签：javascript, alfresco, activiti

在 Alfresco 中开始使用规则和简单的 javascript 非常容易，但我坚持尝试通过 javascript 添加资源来启动工作流。

我的目标是添加用于启动流程的文档（或多个文档），这样我就可以在 Alfresco WorkDesk 的 Alfresco BPM 的“OW_ATTACHMENTS”中获得参考。我已经用 bpm:workflowpagckage 或 bpm:package 尝试了很多次，但都没有运气......帮助！

编辑：

```
 function startWorkflow(name,docNode)
{    
    var workflow = actions.create("start-workflow");
    workflow.parameters["bpm:workflowPackage"] = docNode;
    workflow.parameters.workflowName = "activiti$AdHocactivitiTimer";
    workflow.parameters["bpm:assignee"] = people.getPerson("admin");
    workflow.parameters["bpm:workflowDescription"] = "test";
    workflow.parameters["bpm:workflowPriority"] = "2";
    workflow.parameters["bpm:sendEMailNotifications"] = true;
    workflow.parameters["initiator"] = people.getPerson("admin"); 
    var today = new Date();
    var duedate = today.getDate() + 1; 
    workflow.parameters["bpm:workflowDueDate"] = duedate;
    workflow.execute(document);
}

function main()
{    
    var docNode = search.findNode(document.nodeRef); 
    var name = document.name;  
        startWorkflow(name,docNode); 
}

main(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T14:17:11.253

bpm:package 或 bpm_package 在开始之前不可用。因此，您将文档添加到 bpm_package 会发生什么。

在您的工作流程中，您可以将**bpm_package**作为变量访问。并使用**bpm_package.addNode(doc);** 您可以添加节点。

这些节点可以通过 search/childbynamepath/xpath 等找到。

如果您不使用该操作，另一种方式是：

```
var workflowAction = workflow.getDefinitionByName('activiti$AdHocactivitiTimer');
var package= workflow.createPackage();
package.addNode(document);
workflowAction.startWorkflow(package, parameters); 
```

# php - jquery ajax错误参数如何使用

> ID：16156820
> 
> 赞同：8
> 
> 时间：2013-04-22T21:12:52.857
> 
> 标签：php, jquery, ajax, error-handling, callback

我正在寻找一个简单的示例和/或说明如何`error`使用`.ajax`.

这个问题（[jQuery ajax 错误函数](https://stackoverflow.com/questions/6792878/jquery-ajax-error-function)）指向我不理解的这个 jQuery 文档（ [http://api.jquery.com/jQuery.ajax/ ）。](http://api.jquery.com/jQuery.ajax/)

我有以下代码不起作用，我不知道为什么。我希望错误参数会有所帮助：

jQuery：

```
 <script> 
    // wait for the DOM to be loaded 
    $(document).ready(function() { 
        // bind 'myForm' and provide a simple callback function 
        $("#myForm").submit(function(){
                var user_input = $("#signup_id_email").val();
                $.ajax
                ({
                      type: "POST",
                      url: "ajax_test.php",
                      dataType: 'json',
                      data: {email: user_input},
                      **error: ""**
                })
                .done(function(r) 
                {
                    $("#answer_id").append(r.email);
                });
            });
    }); 
</script> 
```

PHP (ajax_text.php)

```
<?php
echo json_encode($_POST);
?> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-22T21:33:07.870

$.ajax 参数对象的错误“属性”用于为 $.ajax 方法提供一个称为闭包的回调函数。换句话说，如果在 ajax 请求期间发生错误，您需要提供一个匿名函数来处理错误。这是一个基本的例子。

```
 $.ajax({
       type: "POST",
       url: "ajax_test.php",
       dataType: 'application/json',
       data: {email: user_input},
       success: function(result) {
                 // You can use success instead of .done
       },
       error: function(requestObject, error, errorThrown) {
            alert(error);
            alert(errorThrown);
       }
     }); 
```

请记住，只有在请求实际出错时才会调用错误回调函数。如果您的代码根本没有返回任何内容，但请求仍返回 200 状态，则您必须在成功回调函数中处理该异常。

希望这可以帮助。

编辑：请注意，我删除了链接事件的使用，现在所有回调函数都在传递给 $.ajax 的原始参数对象内处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:34:51.260

我怀疑你甚至发送请求。您的空白已关闭。

Javascript 不需要在语句末尾使用分号。因此，它有时会在您不想要它们的地方推断它们。

尝试将 '({' 与 '$.ajax' 放在同一行。您没有看到错误，因为没有错误。$.ajax 是一个有效的语句，即使它什么也不做。同样，您在括号内创建的对象是一个有效的对象，即使它也不做任何事情。

```
$.ajax({
    type: "POST",
    ...
}).done(function(r) {
  ....
}); 
```

要回答您的原始问题，错误将函数作为参数。此函数按以下顺序接受 3 个参数：

1.  XHR（请求）
2.  请求的状态
3.  抛出的错误（可以未定义）

一个示例如下所示：

```
$.ajax({
    ...
    error: function(xhr, status, error) {
        alert("oh no!");
    }
}) 
```

# node.js - 路由正在覆盖中间件

> ID：16156821
> 
> 赞同：1
> 
> 时间：2013-04-22T21:12:53.773
> 
> 标签：node.js, express

我的静态文件中间件调用被我的路由覆盖，即使我以正确的顺序运行它：

首先，我设置我的静态文件，如下所示：

```
app.use('/public/', express.static('/home/skerit/temp'));
app.use('/public/', express.static('/home/skerit/app/public')); 
```

然后我添加我的路线：

```
app.get('/:controller/:action', callback); 
```

而现在，当我尝试获取 /public/empty.txt 时，路由被执行。当我删除路线时，它工作得很好。

而且我确信它们以正确的顺序发生。（首先是 app.use，然后是 app.get）

那么这里有什么问题呢？

编辑：既然我说我以正确的顺序执行它们，这里有一些证据。我在代码的执行中添加了简单的日志语句：

```
[调试] - [stages.js:186] 静态中间件已设置！
[调试] - [stages.js:191] 开始路线！
[debug] - [routes.js:7] 设置控制器路由
[info] - [database.js:79] 已建立默认数据库连接
[info] - [database.js:93] MongoDB 服务器默认存储过程
[info] - [database.js:120] 创建到所有数据源的连接
[调试] - [stages.js:202] 设置 /:controller/:action

```

如您所见：“已设置静态中间件”首先出现。只有这样它才开始设置其他路线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T06:15:40.823

~~`app.get`不是决定路由是在中间件之前还是之后运行的决定因素，而是`app.use(app.router)`这样做的。你需要`app.use(app.router)`在 app.use(express.static);~~

这里有两个例子：

```
var http = require('http');
var express = require('express');
app = express();
app.use(app.router);
app.use('/public/', express.static('/home/skerit/temp'));
app.get('/:controller/:action', function (req, res) {
    res.send(req.params.controller);
});
var server = http.createServer(app);
server.listen(process.env.port || 3000); 
```

这个片段不起作用，当你运行 localhost:3000/public/somefile - 你会得到“public”返回。但是，如果您使用以下代码段：

```
var http = require('http');
var express = require('express');
app = express();
app.use('/public/', express.static('/home/skerit/temp'));
app.get('/:controller/:action', function (req, res) {
    res.send(req.params.controller);
});
app.use(app.router);
var server = http.createServer(app);
server.listen(process.env.port || 3000); 
```

~~localhost:3000/public/somefile 应该返回文件的内容。注意 app.use(app.router) 的位置。（如果你不添加它，默认情况下它应该是最后一个）。~~

另请注意，如果 /home/skerit/temp/somefile 不存在，则控件将传递给下一个中间件，并且看起来 express.static 不起作用，因此请确保您的路径正确。

编辑：
在发表评论后，我被告知我的原始答案不正确，也就是说，app.get 确实决定了中间件堆栈 app.router 的放置位置。即第一次使用 app.router或 app.get 被使用。
在这种情况下，我怀疑您的问题很可能是由于您使用的 url 指向一个不存在的文件。

# ios - 如何在 IOS 5 及更高版本中找到最前面的应用程序的紫色端口？

> ID：16156831
> 
> 赞同：11
> 
> 时间：2013-04-22T21:13:37.210
> 
> 标签：ios, iphone-privateapi

我正在尝试编写一个在后台运行并向跳板或其他应用程序注入触摸的应用程序。我了解我将使用私有 API 和结构。该应用程序是企业应用程序，不需要获得 AppStore 的批准。

我正在使用 KennyTM 建议的 GSEvent 结构，并对 IOS 5/6 进行了一些小的修改。我可以通过发送 GSSystemEvents 将触摸事件和其他事件发送到 Springboard。

我还需要能够将类似的事件发送到其他应用程序，但我无法找到最前面的应用程序的端口。

有没有办法为预先运行的应用程序获取端口，以便我可以将我的 GSEvents 发送到应用程序？

如果有人可以为我指出示例或向我展示如何获得最前端应用程序的紫色端口，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-22T22:04:02.493

**更新：我没有在 ios7 上测试过这个。**

我之前碰巧在完全相同的要求上工作。

要获取紫色端口，您可以使用 GSCopyPurpleNamedPort() 并将捆绑 ID 作为参数。

如果需要在 SpringBoard 上模拟触摸，请使用 GSGetPurpleSystemEventPort。

使用下面的代码，您应该能够获取端口并使用它在整个系统范围内注入触摸。

```
#import <dlfcn.h>
// Framework Paths
#define SBSERVPATH  "/System/Library/PrivateFrameworks/SpringBoardServices.framework/SpringBoardServices"
-(mach_port_t)getFrontMostAppPort
{
    bool locked;
    bool passcode;
    mach_port_t *port;
    void *lib = dlopen(SBSERVPATH, RTLD_LAZY);
    int (*SBSSpringBoardServerPort)() = dlsym(lib, "SBSSpringBoardServerPort");
    void* (*SBGetScreenLockStatus)(mach_port_t* port, bool *lockStatus, bool *passcodeEnabled) = dlsym(lib, "SBGetScreenLockStatus");
    port = (mach_port_t *)SBSSpringBoardServerPort();
    dlclose(lib);
    SBGetScreenLockStatus(port, &locked, &passcode);
    void *(*SBFrontmostApplicationDisplayIdentifier)(mach_port_t *port, char *result) = dlsym(lib, "SBFrontmostApplicationDisplayIdentifier");
    char appId[256];
    memset(appId, 0, sizeof(appId));
    SBFrontmostApplicationDisplayIdentifier(port, appId);
    NSString * frontmostApp=[NSString stringWithFormat:@"%s",appId];
    if([frontmostApp length] == 0 || locked)
        return GSGetPurpleSystemEventPort();
    else
        return GSCopyPurpleNamedPort(appId);
} 
```

我已经测试过...这在 iOS 5 和 6 上运行良好。如果您在锁定屏幕出现时不注入，您可能不需要锁定部分。希望这可以帮助。

# javascript - javascript倒计时到下一个真正的5分钟

> ID：16156832
> 
> 赞同：-4
> 
> 时间：2013-04-22T21:13:49.917
> 
> 标签：javascript

我需要创建一个 javascript 计时器，它将倒计时到接下来的 5 分钟。例如，假设时间是 00:07:30，如果时间是 15:42:00，则时间会说 02:30，计时器会说 03:00 我真的想不出任何好的方法来解决这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-22T21:38:13.237

有很多方法可以做到这一点。我的想法是找出当前时间除以五分钟（300 秒）的提醒。

演示：http: [//jsfiddle.net/txwsj/](http://jsfiddle.net/txwsj/)

```
setInterval(function () {
    var d = new Date(); //get current time
    var seconds = d.getMinutes() * 60 + d.getSeconds(); //convet current mm:ss to seconds for easier caculation, we don't care hours.
    var fiveMin = 60 * 5; //five minutes is 300 seconds!
    var timeleft = fiveMin - seconds % fiveMin; // let's say now is 01:30, then current seconds is 60+30 = 90\. And 90%300 = 90, finally 300-90 = 210\. That's the time left!
    var result = parseInt(timeleft / 60) + ':' + timeleft % 60; //formart seconds back into mm:ss 
    document.getElementById('test').innerHTML = result;

}, 500) //calling it every 0.5 second to do a count down 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T23:59:42.103

相反，您可以尝试`window.setInterval()`像这样使用：

```
 window.setInterval(function(){
        var time = document.getElementById("secs").innerHTML;
        if (time > 0) {
            time -= 1;
        } else {
            alert ("times up!");
            //or whatever you want
        }
        document.getElementById("secs").innerHTML = time;
    }, 1000); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-22T21:27:35.620

如果你想在你的网页上做一个计时器，你可以尝试使用这样的东西：

```
<html>  
  <head>
    <script type="text/javascript">
      var now = new Date().getTime();
      var elapsed = new Date().getTime() - now;
      document.getElementById("timer").innerHtml = elapsed;
      if (elapsed > 300000 /*milliseconds in 5 minutes*/) {
        alert ("5 minutes up!");
        //take whatever action you want!
      }
    </script>
  </head>
  <body>
    <div id="timer"></div>
  </body>
</html> 
```

# ruby - 从 EC2 VPC 内上传到 S3

> ID：16156833
> 
> 赞同：1
> 
> 时间：2013-04-22T21:13:51.167
> 
> 标签：ruby, amazon-web-services, amazon-s3, amazon-ec2, amazon-vpc

如果我们从 AWS VPC 中将文件上传到 S3，除了通过标准 URL 上的 S3 API 启动上传之外，我们是否需要做任何特别的事情？

我们计划使用 aws-s3 Ruby gem 来进行传输，只是想弄清楚是否需要进行更改以确保数据传输是免费的。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:33:04.193

无论您在 AWS 网络内还是外，以上传形式传输的数据始终是免费的。但是，您必须为网络内外的 LIST/PUT/COPY/POST 请求付费。

当您将 S3 发送到 AWS 实例时，您可以免费从 S3 传输出去，这与您在 AWS 之外获取数据的方式相同。他们对 S3 url 进行解析并在内部路由它，不需要不同的语法。同样，您仍然为 GET 请求付费，但这次您节省了传输带宽的费用。

但是请注意，如果您连接到您所在的 AWS 区域之外的 S3（即连接到 S3 Northern VA -> AWS West），您将必须为出站 S3 流量付费。

# java - 数独检查器 Java

> ID：16156834
> 
> 赞同：-2
> 
> 时间：2013-04-22T21:13:59.400
> 
> 标签：java, sudoku, solver

我有一个关于我正在编写的代码的问题的问题。我需要创建一个数独棋盘检查器。目标是通过使用 5 个特定方法来扩展数独类（制作 CheckableSudoku 类），我必须使用 public boolean checkAll() 来检查所有方法，如果它们通过则返回 true。这是我的代码！对不起，如果我解释得太混乱了：/

```
import java.util.Scanner;
public class CheckableSudoku extends Sudoku
{
    public int getCell(int xColumn, int yRow)
    {
        return this.board[xColumn][yRow];
    }

    public boolean checkRow (int yCoord)
    {
        int sum = 0;

        for ( int x = 0; x <9; x++)
        {
            sum = sum + getCell (x,yCoord);
        }
    return( true );
    }

    public boolean checkColumn (int xCoord)
    {
        int sum = 0;
        for (int y = 0; y < 9 ;y++)
        {
            sum = sum + getCell (xCoord, y);
        }
        return( true );
    }

    public boolean checkBlock (int col0to2, int row0to2)
    {
        int sum = 0;
        for (int x=0; x<3; x++)
        {
            for (int y=0; y<3;y++)
            {
                sum = sum + getCell (col0to2+x, row0to2+y);
            }
        }
        return( true);
    }

    public boolean checkAll()
    {
    // this is the method that checks all the other methods above
    return true;
    }

    public static void main(String[] a)
    {
        CheckableSudoku me = new CheckableSudoku();
        Scanner sc = new Scanner(System.in);
        me.read(sc);
        System.out.print(me);

        System.out.println(me.checkAll());
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:17:53.663

这是一个有关如何检查它们是否都返回 true 的示例：

```
public boolean checkAll() {
    return (method1() && method2() && method3() && method4() && method5());
} 
```

或者：

```
// Same thing but more typing.
public boolean checkAll() {
    if (method1() && method2() && method3() && method4() && method5())
         return true;
    else 
         return false;
} 
```

到目前为止，无论如何，您的所有方法似乎都返回了 true。不确定它是否只是一个例子。如果没有，你需要检查你的逻辑。

# java - 没有 Struts 和 Maven 的 JSP Tiles

> ID：16156835
> 
> 赞同：1
> 
> 时间：2013-04-22T21:14:09.737
> 
> 标签：java, jsp, maven, tomcat7, tiles

您可以在屏幕截图异常和配置tiles-defs.xml 的web.xml 文件中看到。

但我不明白瓷砖有什么问题？它是错误的 web.xml 瓷砖配置吗？感谢您的关注。

web.xml

```
<context-param>
    <param-name>
        org.apache.tiles.impl.BasicTilesContainer.DEFINITIONS_CONFIG</param-name>
    <param-value>/WEB-INF/tiles-defs.xml</param-value>
</context-param> 
```

瓷砖-defs.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE tiles-definitions PUBLIC
   "-//Apache Software Foundation//DTD Tiles Configuration 2.1//EN"
   "http://tiles.apache.org/dtds/tiles-config_2_1.dtd">
  <tiles-definitions>
  <definition name="homepage" template="/view/layouts/home.jsp">
   <put-attribute name="cssPaths" value="/view/tiles/common/cssPaths.jsp"/>
   <put-attribute name="metas" value="/view/tiles/common/metas.jsp"/>
   <put-attribute name="header" value="/view/tiles/common/header.jsp"/>
   <put-attribute name="footer" value="/view/tiles/common/footer.jsp"/>
   <put-attribute name="sliders" value="/view/tiles/common/sliders.jsp"/>
   <put-attribute name="featureditems" value="/view/tiles/common/featureditems.jsp"/>
   <put-attribute name="scripts" value="/view/tiles/common/scripts.jsp"/>
   <put-attribute name="brands" value="/view/tiles/common/brands.jsp"/>
  </definition>
 </tiles-definitions> 
```

pom.xml

```
 <project xmlns="http://maven.apache.org/POM/4.0.0"    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
             <modelVersion>4.0.0</modelVersion>
             <groupId>com</groupId>
            <artifactId>ecommerce</artifactId>
           <packaging>war</packaging>
            <version>0.0.1-SNAPSHOT</version>
           <name>ecommerce Maven Webapp</name>
            <url>http://maven.apache.org</url>
       <dependencies>
        <dependency>
          <groupId>junit</groupId>
           <artifactId>junit</artifactId>
           <version>3.8.1</version>
          <scope>test</scope>
        </dependency>
        <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>javax.servlet.jsp</groupId>
      <artifactId>jsp-api</artifactId>
      <version>2.1</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>taglibs</groupId>
      <artifactId>standard</artifactId>
      <version>1.1.2</version>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.24</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-extras</artifactId>
        <version>3.0.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-api</artifactId>
        <version>3.0.1</version>
    </dependency>    
  </dependencies>
  <build>
    <finalName>ecommerce</finalName>
  </build>
</project> 
```

例外

```
HTTP Status 500 -

type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: An exception occurred processing JSP page /index.jsp at line 14

11: <title>Urunler</title>
12: </head>
13: <body>
14:     <tiles:insertDefinition name="homepage"/>
15: </body>
16: </html>

Stacktrace:
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:510)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:419)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
root cause

java.lang.NullPointerException
    org.apache.tiles.access.TilesAccess.getContainer(TilesAccess.java:124)
    org.apache.tiles.access.TilesAccess.getContainer(TilesAccess.java:107)
    org.apache.tiles.access.TilesAccess.getCurrentContainer(TilesAccess.java:174)
    org.apache.tiles.template.InsertDefinitionModel.execute(InsertDefinitionModel.java:95)
    org.apache.tiles.jsp.taglib.InsertDefinitionTag.doTag(InsertDefinitionTag.java:254)
    org.apache.jsp.index_jsp._jspx_meth_tiles_005finsertDefinition_005f0(index_jsp.java:93)
    org.apache.jsp.index_jsp._jspService(index_jsp.java:66)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
note The full stack trace of the root cause is available in the Apache Tomcat/6.0.29 logs.

Apache Tomcat/6.0.29 
```

![例外](https://i.stack.imgur.com/IHwXh.png) ![在此处输入图像描述](https://i.stack.imgur.com/epRmY.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T02:17:28.910

关于[在您的 Web 应用程序中配置 Tiles](http://tiles.apache.org/framework/tutorial/configuration.html)，它提到如下： -

### 1 所需库

```
<dependency>
    <groupId>org.apache.tiles</groupId>
    <artefactId>tiles-extras</artefactId>
    <version>3.0.1</version>
</dependency> 
```

### 2 启动瓷砖引擎

通过在 web.xml 文件中使用适当的侦听器来加载切片容器。

```
<listener>
    <listener-class>
        org.apache.tiles.extras.complete.CompleteAutoloadTilesListener
    </listener-class>
</listener>

<servlet>
    <servlet-name>Tiles Dispatch Servlet</servlet-name>
    <servlet-class>org.apache.tiles.web.util.TilesDispatchServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>Tiles Dispatch Servlet</servlet-name>
    <url-pattern>*.tiles</url-pattern>
</servlet-mapping> 
```

AFAIU，我们应该配置`listener`和/或`Tiles Dispatch Servlet`来启动 Tiles 引擎。请在以下链接中查看更多信息：-

1.  [Apache Tiles：教程](http://tiles.apache.org/framework/tutorial/index.html)
2.  [Apache Tiles：入门](http://tiles.apache.org/framework/getting_started.html)
3.  [Apache Tiles：配置参考](http://tiles.apache.org/framework/config-reference.html)

我希望这可能会有所帮助。

# javascript - JavaScript - 如何在 If/Else 语句中提取字符串

> ID：16156837
> 
> 赞同：1
> 
> 时间：2013-04-22T21:14:14.867
> 
> 标签：javascript, string, variables, if-statement

在搜索 imgNumber 变量后，我正在尝试使用 If/Else 语句在屏幕上写入某些文本。出于某种原因，无论 imgNumber 变量中包含哪些文本，它都只写入字符串 'cockroaches'。

此外，imgNumber 是一个随机字符串（它始终是 myImages 变量中的字符串之一）。

我在这里想念什么？

```
<script type="text/javascript">

function changeImg(imgNumber) {
var myImages = ["images/homepage/homepage-header.jpg", "images/homepage/homepage-header-3.jpg", "images/homepage/homepage-header-5.jpg"];
var imgShown = document.body.style.backgroundImage;
var newImgNumber =Math.floor(Math.random()*myImages.length);
document.body.style.backgroundImage = 'url('+myImages[newImgNumber]+')';

var imgNumber = myImages[newImgNumber];

if (imgNumber = "images/homepage/homepage-header-5.jpg")
  {
  document.write('cockroaches');
  }
else if (imgNumber = "images/homepage/homepage-header-3.jpg")
  {
  document.write('ants');
  }
else
  {
  document.write('termites');
  } 

var n=myImages.indexOf("images/homepage/homepage-header-5.jpg");
document.write(n);

}
window.onload=changeImg;
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:15:35.017

您的`if`条件错误，您需要使用 2 个等号进行比较。所以：`==`不是`=` 你在那里做的是将字符串的值分配给你的`imgNumber`变量......

[您可以在MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/if...else)上找到有关此的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:15:39.843

使用`=`是分配值。要比较值，您需要`==`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T09:18:12.853

1）像之前回答的那样，使用 == 2）将来，使用更正确的变体：

```
var imgNumber = Number("a4r t 4r43 43a b345b 123 cc gaeg4".replace(/\D+/g,""));
switch (imgNumber) {
 case 0:
  // code here
 break;
 case 1:
  // code here
 break;
 default:
  // code here
 break;
} 
```

# php - 在 Span 类中获取值

> ID：16156842
> 
> 赞同：0
> 
> 时间：2013-04-22T21:14:30.353
> 
> 标签：php, class, get

我无法让 GET 值代替我标记的值（TEST）。这种类型的代码需要什么格式？

```
<span class="example" data-example-username="(TEST)"></span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:17:50.590

尝试：

```
<span class="example" data-example-username="<?php echo $_GET['u']; ?>"></span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:27:41.313

几个选项：

```
# Check to see if the GET param is set at all
if(isset($_GET['user'])){
    $user = $_GET['username']; # Assign the value
} else {
    $user = 'no-user-specified';
}

# Echo your span
echo "<span ... data-example-username='$user'></span>"; 
```

还有你不应该做的...

```
echo "<span ... data-example-username='{GET['user']}></span>"; 
```

这种方法存在许多问题。首先，这里假设您根本没有清理该值或检查其有效性。其次，如果您假设它未设置，它将引发错误（因此调用`isset()`）。

最后，如果您不想在 PHP 中使用整个字符串而只想回显变量，您可以这样做：

```
<span ... field="<?php echo $value; ?>"></span> 
```

或者

```
<span ... field="<?php echo $GET['email']; ?>"></span> 
```

（同样，你不应该这样做:-)

# unit-testing - 运行测试后分析代码覆盖率抛出错误

> ID：16156849
> 
> 赞同：5
> 
> 时间：2013-04-22T21:14:53.957
> 
> 标签：unit-testing, visual-studio-2012, mstest

当我在 2012 年尝试使用 MSTest 分析代码覆盖率时，我得到以下结果。它也发生在一个新项目和新测试中。

```
Exception was thrown: Code Coverage Analysis engine threw exception(s):

Coverage file "xxxx" is invalid or corrupt. 
```

# java - 用于识别所有本地化格式的所有数字的正则表达式

> ID：16156854
> 
> 赞同：4
> 
> 时间：2013-04-22T21:15:26.867
> 
> 标签：java, regex

我正在使用 Scanner 对象扫描文本，比如说`lineScanner`. 以下是声明：

```
String myText= "200,00/100,00/28/65.36/21/458,696/25.125/4.23/6.3/4,2/659845/4524/456,65/45/23.495.254,3";
Scanner lineScanner = new Scanner(myText); 
```

有了这个`Scanner`，我想找到第一个`BigDecimal`，然后找到第二个，依此类推。我宣布 a`BIG_DECIMAL_PATTERN`匹配任何情况。

以下是我定义的规则：

*   千位分隔符后始终紧跟 3 位数字
*   小数点后总是正好有 1 或 2 位数字。
*   如果千位分隔符是逗号符号，那么小数点是点符号，反之亦然
*   千位分隔符是可选的，作为数字的小数部分

* * *

```
String nextBigDecimal = lineScanner.findInLine(BIG_DECIMAL_PATTERN); 
```

现在，这是`BIG_DECIMAL_PATTERN`我声明的：

```
private final String BIG_DECIMAL_PATTERN=
      "\\d+(\\054\\d{3}+)?(\\056\\d{1,2}+)?|\\d+(\\056\\d{3}+)?(\\054\\d{1,2}+)?)"; 
```

`\\054`是 ASCII 八进制表示`","`

`\\056`是 ASCII 八进制表示`"."`

我的问题是它不能很好地工作，因为当第一部分的模式被发现时，第二部分（在 之后`|`）没有被检查，在我的例子中，第一个匹配将是`200`而不是`200,00`。所以我可以试试这个：

```
private final String BIG_DECIMAL_PATTERN=\\d+([.,]\\d{3}+)?([,.]\\d{1,2}+)? 
```

但是有一个新的问题：逗号和点不是互斥的，我的意思是如果一个是千位分隔符，小数点应该是另一个。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T13:30:28.943

你能做一个非此即彼的正则表达式吗？例如：

```
private final String BIG_DECIMAL_PATTERN
    = "\\d+((\\.\\d{3}+)?(,\\d{1,2}+)?|(,\\d{3}+)?(\\.\\d{1,2}+)?)" 
```

注意 - 我没有检查你的正则表达式是否真的有效 - 并且怀疑这可能不是实现你想要做的事情的最佳方式。我在这里所做的一切都是为了让您启动并运行，建议您可以尝试使用`(regex1|regex2)`where `regex1`is dots after commas 和`regex2`is commas after dots。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:27:01.100

我相信您的第二个 RegEx 的变体会为您工作。考虑这个正则表达式：

```
^\\d+(?:([.,])\\d{3})*(?:(?!\\1)[.,]\\d{1,2})?$ 
```

### 现场演示：[http ://www.rubular.com/r/vHlEdBMhO9](http://www.rubular.com/r/vHlEdBMhO9)

**说明：**它的作用是首先捕获捕获组#1 中的逗号或点。然后使用负前瞻确保相同的捕获组#1 不会出现在小数点处。换句话说，这确保了如果逗号先出现，那么点将在后出现，反之亦然。

# android - Android facebook applicationId 不能为空

> ID：16156856
> 
> 赞同：71
> 
> 时间：2013-04-22T21:15:30.303
> 
> 标签：android, facebook

我一直在按照以下教程将我的应用程序与 Facebook 集成。 [脸书教程](https://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/)

我已经按照教程中的所有内容进行了操作，但是我遇到`applicationId cannot be null`了两种情况，这真的很令人沮丧。

我`FacebookActivity` `onCreate`的有以下，和教程一模一样：

```
public void onCreate(Bundle savedInstanceState) 
{ 
    super.onCreate(savedInstanceState);
    uiHelper = new UiLifecycleHelper(this, callback);
    uiHelper.onCreate(savedInstanceState);
    setContentView(R.layout.main_fb);

    FragmentManager fm = getSupportFragmentManager();
    fragments[SPLASH] = fm.findFragmentById(R.id.splashFragment);
    fragments[SELECTION] = fm.findFragmentById(R.id.selectionFragment);

    FragmentTransaction transaction = fm.beginTransaction();
    for(int i = 0; i < fragments.length; i++) 
    {
        transaction.hide(fragments[i]);
    }
    transaction.commit();
} 
```

但是，当我尝试显示我得到的活动时`applicationId cannot be null`，LogCat 指向我的行是：`uiHelper.onCreate(savedInstanceState);`

因此，我尝试注释掉该行，并显示活动。但是现在当我点击 时`LoginButton`，我得到了同样的错误，但这一次是指向我来自 Facebook 的 LoginButton 类中的 applicationId 字段。

我的字符串值和清单中已经有 Id，如下所示：

```
<meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/APP_ID"/> 
```

我尝试使用代码获取 ID，但没有任何改变。

究竟是什么导致了这一切？

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2013-04-22T21:19:13.450

> TL; DR：您**必须**`strings.xml`在您的然后引用（即）中写入应用程序的 ID `@strings/fb_app_id`，因为如果您直接将其（作为值）放入`AndroidManifest.xml`它将不起作用。

你必须像这样定义你`applicationId`的`AndroidManifest.xml` ：

`<meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/>`

在`<application android:label="@string/app_name"....`标签下

`app_id`你的`strings.xml`.

* * *

样本：

```
 <application android:label="@string/app_name"
                 android:icon="@drawable/icon"
                 android:theme="@android:style/Theme.NoTitleBar"
            >
        <activity android:name=".HelloFacebookSampleActivity"
                  android:label="@string/app_name"
                  android:windowSoftInputMode="adjustResize">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
        <activity android:name="com.facebook.LoginActivity"
                  android:theme="@android:style/Theme.Translucent.NoTitleBar"
                  android:label="@string/app_name" />
        <meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/>
    </application> 
```

** 请注意`<meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/>`在`<application>`标签内

-- 在 strings.xml 中

```
<string name="app_id">1389xxxxxxxx</string> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-06-16T22:48:31.393

从今天开始，答案并不完全正确。如果有人没有使用这个： `AppEventsLogger.activateApp(this);`

自上次更新以来，您必须这样做，否则您的应用程序将崩溃。你也应该在这里传递**Application**而不是**Context**

[https://developers.facebook.com/docs/android/getting-started](https://developers.facebook.com/docs/android/getting-started)

```
// Add this to the header of your file:
import com.facebook.FacebookSdk;

public class MyApplication extends Application {
    // Updated your class body:
    @Override
    public void onCreate() {
        super.onCreate();
        // Initialize the SDK before executing any other operations,
        FacebookSdk.sdkInitialize(getApplicationContext());
        AppEventsLogger.activateApp(this);
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-08T16:01:06.867

问题是 id 被转换为整数： [https ://code.google.com/p/android/issues/detail?id=78839](https://code.google.com/p/android/issues/detail?id=78839)

在我的情况下，每个风味`facebook_app_id`都是从文件中设置的。`build.gradle`

解决方案是用 id 包装`"`：

```
flavor.resValue "string", "facebook_app_id", "\"1111111111111\"" 
```

或者如果您宁愿避免转义：

```
flavor.resValue "string", "facebook_app_id", '"1111111111111"' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-17T08:39:28.160

活动中的这个小代码修改帮助了我。

```
@Override
    protected void onCreate(Bundle savedInstanceState) {

        FacebookSdk.sdkInitialize(getApplicationContext());
        AppEventsLogger.activateApp(getApplication());

        super.onCreate(savedInstanceState);
        ...................
        ...................    
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-06-07T23:09:12.360

实际上，您不必在 gradle 中使用风味代码...

如果您的数字超过 4 个字节，您应该在 strings.xml 中使用此代码

> **注意**：注意这个引号（**“**）

```
<string name="facebook_app_id">"1111111111111"</string> 
```

# javascript - document.getElementById 不适用于 custom tag I'm developing a Google Chrome extension and I want to add <li> to <ul> tag via JavaScript: var newLI = document.createElement("LI"); 问问题 问问题 2013-04-22T21:15:30.950 2281 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I'm developing a Google Chrome extension and I want to add <li> to <ul> tag via JavaScript: var newLI = document.createElement("LI"); var ul = document.getElementById('tag_list'); ul.appendChild(newLI); newLI.innerHTML = "<a href=\"dddaaaa\">" + json + "</a>"; and HTML: <template id="box#add-feeds"> <ul class="search-ac" id="tag_list" name="tag_list"></ul> </template> When I remove the <template> tag this code works well but with this tag I have this error: Cannot call method 'appendChild' of null I can't remove the template tag so I have to change JavaScript code. Any idea about why getElementById doesn't work if a tag is in a custom tag <template>? Why does this Powershell function return more than just true/false? Function lyncNotFocused { # We need to check if the Lync window (conversation?) has focus or not. $hwnd = [WhichWindowActive]::GetForegroundWindow() $proc = [IntPtr]::Zero [WhichProcessActive]::GetWindowThreadProcessId($hwnd, [ref] $proc); Write-Host "DEBUG: Focused - hwnd $hwnd, process $proc" if (Get-Process -ID $proc -ErrorAction "SilentlyContinue" | Where { $_ -notmatch "lync" }) { return $true } else { return $false } } It returns something like "12412 True" or "9867 False". Never just the plain boolean value. The numbers correspond to the PIDs I'm looking up, and it seems the Get-Process cmdlet is pooping the bed here. How do I get it to shut up? javascripthtmldomgoogle-chrome-extensionhtml5-template 4 2 回答 2 This answer is useful 2 该<template标签不是自定义标签；这是一个新的 HTML5 功能。 标签的全部意义<template>在于它们实际上并不在文档中。 这包括 ID。 您可以使用标记的 DOM 元素的content属性检查或操作模板的内容。<template> 于 2013-04-22T21:17:21.220 回答 This answer is useful 1 模板可供您克隆它们。 鉴于此 HTML 代码： <template id="add-feeds"> <ul class="search-ac" id="tag_list" name="tag_list"></ul> </template> 如果您尝试这样的事情，它将不起作用（将返回null）： var ul = document.getElementById('tag_list'); // ul is *null* 要走的路是： 克隆模板（想想实例化一个类）。 让我在div您的基本 html 中添加一个： <template id="add-feeds"> <ul class="search-ac" id="tag_list" name="tag_list"></ul> </template> <div id="show_list"></div> //div used as DOM-entry-point for our new created list 现在克隆模板： var template= document.querySelector("#add-feeds"); my_template_clone = template.content.cloneNode(true); // clone the template var my_ul = my_template_clone.getElementById('tag_list'); //now you can find the *ul* var newLI = document.createElement("LI"); //create random stuff newLI.innerHTML="hello"; my_ul.appendChild(newLI); //append it to the ul var div = document.getElementById('show_list'); div.appendChild(my_ul); //now add it into the DOM 在这里你有一个工作的jsfiddle 于 2020-12-28T11:46:02.827 回答 Related 1 php - Opencart：插入批量产品，product_id 不唯一 1 android - 文件未在 Android 上写入 3 jquery - Angular.js 内联编辑 1 php - 如何在 PHP 中编写动态 SQL 查询？ 1 ios - iOS：让应用程序始终处于领先地位的可能性 1 java - 将某些字符/键的输入重新映射到 JTextComponent 的最佳方法？ 3 c# - Windows 窗体触地事件 1 mysql - 如何使用 MYSQL 循环使用逗号分隔符的列数据 6 jquery - 单击同一单元格中的链接时获取隐藏字段值 3 java - 上传 File Struts 中的 java.lang.NullPointerException Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16156857
> 
> 赞同：2
> 
> 时间：
> 
> 标签：javascript, html, dom, google-chrome-extension, html5-template

I'm developing a Google Chrome extension and I want to add `<li>` to `<ul>` tag via JavaScript:

```
var newLI = document.createElement("LI");
var ul = document.getElementById('tag_list');
ul.appendChild(newLI);
newLI.innerHTML = "<a href=\"dddaaaa\">" + json + "</a>"; 
```

and HTML:

```
<template id="box#add-feeds">
    <ul class="search-ac" id="tag_list" name="tag_list"></ul>
</template> 
```

When I remove the `<template>` tag this code works well but with this tag I have this error:

> Cannot call method 'appendChild' of null

I can't remove the template tag so I have to change JavaScript code. Any idea about why `getElementById` doesn't work if a tag is in a custom tag `<template>`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:17:21.220

该[`<template`标签](http://www.html5rocks.com/en/tutorials/webcomponents/template/)不是自定义标签；这是一个新的 HTML5 功能。

标签的全部意义`<template>`在于它们实际上并不在文档中。
这包括 ID。

您可以使用标记的 DOM 元素的`content`属性检查或操作模板的内容。`<template>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-28T11:46:02.827

模板可供您**克隆**它们。

鉴于此 HTML 代码：

```
<template id="add-feeds">
    <ul class="search-ac" id="tag_list" name="tag_list"></ul>
</template> 
```

如果您尝试这样的事情，它将*不起作用*（将返回`null`）：

```
var ul = document.getElementById('tag_list'); // ul is *null* 
```

**要走的路是：**

**克隆**模板（想想*实例化一个类*）。

让我在`div`您的基本 html 中添加一个：

```
<template id="add-feeds">
    <ul class="search-ac" id="tag_list" name="tag_list"></ul>
</template>

<div id="show_list"></div>   //div used as DOM-entry-point for our new created list 
```

现在克隆模板：

```
var template= document.querySelector("#add-feeds");
my_template_clone = template.content.cloneNode(true); // clone the template 
var my_ul = my_template_clone.getElementById('tag_list'); //now you can find the *ul*

var newLI = document.createElement("LI"); //create random stuff
newLI.innerHTML="hello";
my_ul.appendChild(newLI);  //append it to the ul

var div = document.getElementById('show_list'); 
div.appendChild(my_ul); //now add it into the DOM 
```

在这里你有一个工作的[jsfiddle](http://jsfiddle.net/v7npz84w/19/)

# powershell - 为什么这个 Powershell 函数返回的不仅仅是真/假？

> ID：16156858
> 
> 赞同：1
> 
> 时间：2013-04-22T21:15:31.093
> 
> 标签：powershell, scripting

```
Function lyncNotFocused {
  # We need to check if the Lync window (conversation?) has focus or not.
  $hwnd = [WhichWindowActive]::GetForegroundWindow()
  $proc = [IntPtr]::Zero
  [WhichProcessActive]::GetWindowThreadProcessId($hwnd, [ref] $proc);
  Write-Host "DEBUG: Focused - hwnd $hwnd, process $proc"

  if (Get-Process -ID $proc -ErrorAction "SilentlyContinue" | Where { $_ -notmatch "lync" }) { return $true }
  else { return $false }
} 
```

它返回类似“12412 True”或“9867 False”的内容。永远不要只是简单的布尔值。这些数字与我正在查找的 PID 相对应，似乎 Get-Process cmdlet 在这里大便。如何让它闭嘴？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:33:34.720

听起来你需要`| out-null`在`[WhichProcessActive]`代码行上做一个。它可能会返回 PID 并将其设置在参数中。

PowerShell 会将所有内容发送到管道中，因此除非您将方法返回值分配给变量，或者使用 或 丢弃它，`[void]`否则`Out-Null`它也将被返回。

# ruby-on-rails - 我如何测试rails缓存功能

> ID：16156862
> 
> 赞同：6
> 
> 时间：2013-04-22T21:15:41.023
> 
> 标签：ruby-on-rails, caching, rspec

这是我的标签模型，我不知道如何测试 Rails.cache 功能。

```
class Tag < ActiveRecord::Base
  class << self
    def all_cached
      Rails.cache.fetch("tags.all", :expires_in => 3.hours) do
        Tag.order('name asc').to_a
      end
    end
    def find_cached(id)
      Rails.cache.fetch("tags/#{id}", :expires_in => 3.hours) do
        Tag.find(id)
      end
    end
  end

  attr_accessible :name
  has_friendly_id :name, :use_slug => true, :approximate_ascii => true
  has_many :taggings #, :dependent => :destroy
  has_many :projects, :through => :taggings
end 
```

你知道如何测试它吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-22T21:44:06.437

好吧，首先，您不应该真正测试框架。Rails 的缓存测试表面上为您涵盖了这一点。也就是说，请参阅[此答案](https://stackoverflow.com/questions/5035982/optionally-testing-caching-in-rails-3-functional-tests)以获取您可以使用的小帮手。然后，您的测试将类似于：

```
describe Tag do
  describe "::all_cached" do
    around {|ex| with_caching { ex.run } }
    before { Rails.cache.clear }

    context "given that the cache is unpopulated" do
      it "does a database lookup" do
        Tag.should_receive(:order).once.and_return(["tag"])
        Tag.all_cached.should == ["tag"]
      end
    end

    context "given that the cache is populated" do
      let!(:first_hit) { Tag.all_cached }

      it "does a cache lookup" do
        before do
          Tag.should_not_receive(:order)
          Tag.all_cached.should == first_hit
        end
      end
    end
  end
end 
```

这实际上并没有检查缓存机制——只是`#fetch`没有调用该块。它很脆弱并且与 fetch 块的实现有关，所以要小心，因为它会成为维护债务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-04T14:03:26.033

我同意[@chris-heald 的](https://stackoverflow.com/users/271475/chris-heald) [回答](https://stackoverflow.com/a/16157274/3676469)。为了使测试不那么脆弱，你可以这样改变你的代码：

```
def self.all_cached
  Rails.cache.fetch('tags.all', expires_in: 3.hours) do
    all_uncached
  end
end

def self.all_uncached
  Tag.order('name asc').to_a
end 
```

并通过以下方式对其进行测试：

```
describe Tag do
  context 'retrieving all tags' do
    let(:tag) { Tag.create! }
    before do
      allow(Tag).to receive(:all_uncached) do
        fail 'Database hit!' if @database_hit
        @database_hit = true
        [tag]
      end
    end

    context 'when the cache is populated' do
      before { Tag.all_cached }

      it 'should not hit the database' do
        expect(Tag.all_uncached).to raise_error 'Database hit!'
        expect(Tag.all_cached).to eq [tag]
      end
    end
  end
end 
```

# c# - C# .NET Web 服务 Microsoft.Office.Interop.Word 崩溃

> ID：16156874
> 
> 赞同：0
> 
> 时间：2013-04-22T21:16:06.800
> 
> 标签：c#, .net, web-services

我面临有关 Word 互操作库的问题。我安装了一个打开 docx 文档的 C# .NET 3.5 Web 服务。相同的代码不变，直到发生变化（我不知道发生了什么变化）。
现在，当尝试创建 Word.Application 对象时，Web 服务会停止（没有日志，没有错误消息）。

```
var wordApp = new Word.Application(); 
```

我也尝试过 Word.ApplicationClass()，结果相同。我使用的是安装在 Windows 2003 Web Server 上的版本 14 - Office 2010。我还为 Office 2010 安装了 PIA 可再发行组件。我已删除并再次添加 Word COM 引用、重建等。

你知道我怎样才能找到丢失的东西吗？我已经做了很多谷歌搜索，所以如果这个问题被重复，我真的很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:15:44.197

最后，

Word 因许可证到期而崩溃！

谢谢您的意见！

# c# - 如何从int中取出一个值？C＃

> ID：16156875
> 
> 赞同：-1
> 
> 时间：2013-04-22T21:16:15.550
> 
> 标签：c#, random, int

问题出在第 3 行，我需要取走 1-3 之间的一个数字并保存该值，以便可以取走更多。

```
Random randomhit = new Random();
int randomNumberhit = randomhit.Next(1, 4);
int life = life - randomNumberhit;
Console.WriteLine(life); 
```

有任何想法吗？我做错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:19:14.467

您正在声明变量`life`并为其分配`life - randomhit`. `life`如果还没有值，你怎么知道计算的结果？

尝试这样的事情：

```
int life = 100;
...
Random randomhit = new Random();
int randomNumberhit = randomhit.Next(1, 4);
life = life - randomNumberhit;
Console.WriteLine(life); 
```

但是，您可能希望改为使`life`类变量。像这样的东西会起作用：

```
public class MyGuy
{

    public int Life { get; set; }

    public MyGuy()
    {
        this.Life = 100; // starting life
    }

    public void Hit()
    {
        Random randomhit = new Random();
        int randomNumberhit = randomhit.Next(1, 4);
        this.Life -= randomNumberhit;
        Console.WriteLine(this.Life);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:18:51.167

生活需要被初始化

```
int life = 100; //Or some other value
Random randomhit = new Random();
int randomNumberhit = randomhit.Next(1, 4);
life = life - randomNumberhit;
Console.WriteLine(life); 
```

另请注意，当生命被重新分配 ( `life = life - randomNumberhit;`) 时，不需要 int。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:18:29.177

你正在做`life-randomNumberhit`，但那时你的变量`life`还不存在。您应该将`life`变量初始化为您想要的任何值：

```
Random randomhit = new Random();
int randomNumberhit = randomhit.Next(1, 4);
int life = 0; // for instance, 0
Console.WriteLine(life - randomNumberhit); 
```

# jquery - jquery - hide css if select dropdown is chosen

> ID：16156878
> 
> 赞同：2
> 
> 时间：2013-04-22T21:16:43.180
> 
> 标签：jquery

I have a dynamic form that creates drop downs and increments the names correctly. What i need to do is hide a text box if the user selects a certain dropdown value. This i can do, but what i need help on is hiding the right thing as the names are incremental.

```
$("select[id^=Profession]").change(function() {
 if(jQuery(this).find("option:selected").val() == "2") {
    jQuery("#ADA_1").hide();
} else {
    jQuery("#ADA_1").show();
};  }); 
```

Working Sample: [jsfiddle](http://jsfiddle.net/5nVHX/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:22:32.207

尝试这个：

```
$("select[id^=Profession]").change(function() {
 var id = $(this).attr('id').split('Profession')[1];
 if(jQuery(this).find("option:selected").val() == "2") {
    jQuery("#ADA_"+id).hide();
 } else {
    jQuery("#ADA_"+id).show();
 }
}); 
```

见[**工作小提琴**](http://jsfiddle.net/5nVHX/6/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:21:58.807

尝试这个：

```
$("select[id^=Profession]").change(function () {
    index = $(this).attr('id').substr(-1);
    if (jQuery(this).find("option:selected").val() == "2") {
        jQuery("#ADA_"+index).hide();
    } else {
        jQuery("#ADA_"+index).show();
    }
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/5nVHX/3/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:25:31.333

你也可以这样做：

```
$("select[id^=Profession]").change(function () {
    if (jQuery(this).find("option:selected").val() == "2") {
        jQuery(this).parent().next("[id^=ADA_]").hide();
    } else {
        jQuery(this).parent().next("[id^=ADA_]").show();
    }
}); 
```

[**jsfiddle 演示**](http://jsfiddle.net/darkajax/LqCuA/3/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-22T21:30:26.450

```
$("select[id^=Profession]").change(function () {
    var id = $(this).attr('id').replace('Profession', '');
    if (jQuery(this).find("option:selected").val() == "2") {
        jQuery("#ADA_"+id).hide();
    } else {
        jQuery("#ADA_"+id).show();
    }
}); 
```

[演示](http://jsfiddle.net/5nVHX/7/)

# c++ - 使用 cin 调用对象的成员以获取对象名称

> ID：16156879
> 
> 赞同：0
> 
> 时间：2013-04-22T21:16:53.883
> 
> 标签：c++, oop, object, user-input

我试图找到一种方法来调用对象的成员，但使用用户输入来确定哪个对象。所以，我有 3 个对象：obj1、obj2、obj3。然后我要求用户输入他们想要操作的对象。然后使用这个输入，我调用相应对象的成员函数。

```
string input;
cin >> input; 
input.memberfunc();//where input is obj1, for example 
```

我知道这显然不是办法，我首先必须转换字符串等，但如果能就实现我的要求的最佳方式提供任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:35:50.617

你可以创建一个对象数组

```
Object *objects[3] = {&obj1, &obj2, &obj3};
int index;
cin >> index;
if ((index > 0) && (index < 4))
{
   object[index]->memberfunc();
} 
```

或者如果你想通过字符串选择，你可以使用地图来完成；

```
std::map<std::string, Object *> objectmap;
objectmap["obj1"] = &obj1;
objectmap["obj2"] = &obj2;
objectmap["obj3"] = &obj3;
std::string input;
cin >> input;
if (objectmap.find(input) != objectmap.end())
{
    objectmap[input]->memberfunc();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T01:35:24.857

您可以按照 VX 的建议进行操作。`objectmap["objn"] = &objn`如果“objn”与容器中任何已存在元素的键不匹配，则调用会插入一个新元素。

你也可以使用`map::insert`：

`objectmap.insert( std::pair<std::string,Object*>( "objn", &objn ));`

这是有关[地图](http://www.cplusplus.com/reference/map/map/)的更多详细信息的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T01:58:33.550

使用@VX answer动态添加书籍：

```
std::map<std::string, Book* > bookmap;
bookmap["obj1"] = &obj1;
bookmap["obj2"] = &obj2;
bookmap["obj3"] = &obj3;

//Dynamically loaded book:    
Book* newBook = new Book(/* any arguments you need */);
bookmap[ newBook->getIdentifier() ] = newBook;

std::string input;
cin >> input;
if (bookmap.find(input) != bookmap.end())
{
    bookmap[input]->bookmap();
} else {
    cerr << "Error: book '" << input << "' not found." << endl;
} 
```

# qt - QT：没有这样的插槽/如何创建新的 makefile？

> ID：16156880
> 
> 赞同：0
> 
> 时间：2013-04-22T21:17:02.760
> 
> 标签：qt, signals, slot

嘿，我几乎整个晚上都在寻找答案，但找不到。我的 QT creator 应用程序中有以下错误。我将向您发布我的 mainwindow.h 、 main.cpp 和 mainwindow.cpp ，我找到了一些我必须重新生成一些文件的答案，因为编译器不会自己生成并找到一些命令（例如 qmake - tp vc projectname.pro）在帮助中，但它没有用:(所以请帮助我，我差点哭了:D我只想更改每个插槽的主窗口的中央小部件；）

**错误**

```
QObject::connect: No such slot MainWindow::scW(mainwindow1)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow2)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow3)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow1)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow2)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow3)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow1)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scw(mainwindow2)
QObject::connect:  (receiver name: 'MainWindow')
QObject::connect: No such slot MainWindow::scW(mainwindow3)
QObject::connect:  (receiver name: 'MainWindow') 
```

**主窗口.h**

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

public slots:
    void scW(QWidget *widget);

private:
    Ui::MainWindow *ui;
};

#endif // MAINWINDOW_H 
```

**主窗口.cpp**

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
}

void MainWindow::scW(QWidget *widget){
   this->setCentralWidget(widget);
}

MainWindow::~MainWindow()
{
    delete ui;
} 
```

**主文件**

```
#include "mainwindow.h"
#include <QApplication>
#include <QWidget>
#include <QPushButton>
#include <QVBoxLayout>
#include <QHBoxLayout>
#include <QGridLayout>
#include <QLabel>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    MainWindow *w=new MainWindow;

        QWidget *mainwindow1=new QWidget;
        QWidget *mainwindow2=new QWidget;
        QWidget *mainwindow3=new QWidget;
        QGridLayout *gridlay1=new QGridLayout;
        QGridLayout *gridlay2=new QGridLayout;
        QGridLayout *gridlay3=new QGridLayout;
        QWidget *window11=new QWidget;
        QWidget *window21=new QWidget;
        QWidget *window31=new QWidget;
        QVBoxLayout *vblay1=new QVBoxLayout;
        QVBoxLayout *vblay2=new QVBoxLayout;
        QVBoxLayout *vblay3=new QVBoxLayout;
        QPushButton *button_eins1=new QPushButton("Menü 1");
        QPushButton *button_zwei1=new QPushButton("Menü 2");
        QPushButton *button_drei1=new QPushButton("Menü 3");
        QPushButton *button_eins2=new QPushButton("Menü 1");
        QPushButton *button_zwei2=new QPushButton("Menü 2");
        QPushButton *button_drei2=new QPushButton("Menü 3");
        QPushButton *button_eins3=new QPushButton("Menü 1");
        QPushButton *button_zwei3=new QPushButton("Menü 2");
        QPushButton *button_drei3=new QPushButton("Menü 3");

        vblay1->addWidget(button_eins1);
        vblay1->addWidget(button_zwei1);
        vblay1->addWidget(button_drei1);
        vblay2->addWidget(button_eins2);
        vblay2->addWidget(button_zwei2);
        vblay2->addWidget(button_drei2);
        vblay3->addWidget(button_eins3);
        vblay3->addWidget(button_zwei3);
        vblay3->addWidget(button_drei3);
        window11->setLayout(vblay1);
        window21->setLayout(vblay2);
        window31->setLayout(vblay3);

        gridlay1->addWidget(window11,0,0);
        gridlay2->addWidget(window21,0,0);
        gridlay3->addWidget(window31,0,0);

        //Untermenü1
        QWidget *window12=new QWidget;
        QVBoxLayout *vblay12=new QVBoxLayout;
        QLabel *label1=new QLabel("willkommen!");
        vblay12->addWidget(label1);
        window12->setLayout(vblay12);

        gridlay1->addWidget(window12,0,1);
        //Ende Untermenü1

        //Untermenü2
        QWidget *window22=new QWidget;
        QVBoxLayout *vblay22=new QVBoxLayout;
        QLabel *label2=new QLabel("Untermenü 1!");
        vblay22->addWidget(label2);
        window22->setLayout(vblay22);

        gridlay2->addWidget(window22,0,1);
        //Ende Untermenü

        //Untermenü3
        QWidget *window32=new QWidget;
        QVBoxLayout *vblay32=new QVBoxLayout;
        QLabel *label3=new QLabel("Untermenü 2!");
        vblay32->addWidget(label3);
        window32->setLayout(vblay32);

        gridlay3->addWidget(window32,0,1);
        //Ende Untermenü

        mainwindow1->setLayout(gridlay1);
        mainwindow2->setLayout(gridlay2);
        mainwindow3->setLayout(gridlay3);

        w->setCentralWidget(mainwindow1);

        QObject::connect(button_eins1,SIGNAL(clicked()),w,SLOT(scW(mainwindow1)));
        QObject::connect(button_zwei1,SIGNAL(clicked()),w,SLOT(scW(mainwindow2)));
        QObject::connect(button_drei1,SIGNAL(clicked()),w,SLOT(scW(mainwindow3)));
        QObject::connect(button_eins2,SIGNAL(clicked()),w,SLOT(scW(mainwindow1)));
        QObject::connect(button_zwei2,SIGNAL(clicked()),w,SLOT(scW(mainwindow2)));
        QObject::connect(button_drei2,SIGNAL(clicked()),w,SLOT(scW(mainwindow3)));
        QObject::connect(button_eins3,SIGNAL(clicked()),w,SLOT(scW(mainwindow1)));
        QObject::connect(button_zwei3,SIGNAL(clicked()),w,SLOT(scw(mainwindow2)));
        QObject::connect(button_drei3,SIGNAL(clicked()),w,SLOT(scW(mainwindow3)));
        w->show();

    return a.exec();
} 
```

**编辑**

这是我与一个创建者和一个 qwidget 类的 3 个插槽编写的新代码，我添加到 main.cpp 的主窗口中。我仍然收到插槽映射的错误（a，b，c 不存在。请帮助： D 格力兹

```
#include "window1.h"
#include "window2.h"
#include "window3.h"
#include "window4.h"
#include <QPushButton>
#include <QSignalMapper>
#include <QVBoxLayout>
#include <QGridLayout>
#include <QWidget>
#include <QObject>
#include <QLabel>

window1::window1(QWidget *parent) :
    QWidget(parent)
{
    int a=1,b=2,c=3;
    QWidget *menu_win=new QWidget;
    window3 *cont_two_win=new window3();
    window4 *cont_three_win=new window4();
    QPushButton *buttone_one=new QPushButton("one");
    QPushButton *buttone_two=new QPushButton("two");
    QPushButton *buttone_three=new QPushButton("three");
    QVBoxLayout *vblay=new QVBoxLayout;
    QGridLayout *gridlay=new QGridLayout;
    QSignalMapper *signalmapper=new QSignalMapper();

    vblay->addWidget(buttone_one);
    vblay->addWidget(buttone_two);
    vblay->addWidget(buttone_three);

    menu_win->setLayout(vblay);
    gridlay->addWidget(menu_win,0,0);
   // gridlay->addWidget(cont_win,0,1);
    this->setLayout(gridlay);

    QObject::connect(buttone_one,SIGNAL(clicked()),signalmapper,SLOT(map()));
    QObject::connect(buttone_two,SIGNAL(clicked()),signalmapper,SLOT(map()));
    QObject::connect(buttone_three,SIGNAL(clicked()),signalmapper,SLOT(map()));

    signalmapper->setMapping(buttone_one,a);
    signalmapper->setMapping(buttone_two,b);
    signalmapper->setMapping(buttone_three,c);

    QObject::connect(signalmapper,SIGNAL(mapped(a)),this,SLOT(change_cont_one(&gridlay)));
    QObject::connect(signalmapper,SIGNAL(mapped(b)),this,SLOT(change_cont_two(&gridlay)));
    QObject::connect(signalmapper,SIGNAL(mapped(c)),this,SLOT(change_cont_three(&gridlay)));
}

void window1::change_cont_one(QGridLayout **gridlay){
    window2 *cont_one_win=new window2();
    QLabel *label=new QLabel("Test1");
    QVBoxLayout *vblay=new QVBoxLayout;
    vblay->addWidget(label);
    cont_one_win->setLayout(vblay);
    (*gridlay)->addWidget(cont_one_win,0,1);
}

void window1::change_cont_two(QGridLayout **gridlay){
    window2 *cont_one_win=new window2();
    QLabel *label=new QLabel("Test2");
    QVBoxLayout *vblay=new QVBoxLayout;
    vblay->addWidget(label);
    cont_one_win->setLayout(vblay);
    (*gridlay)->addWidget(cont_one_win,0,1);
}

void window1::change_cont_three(QGridLayout **gridlay){
    window2 *cont_one_win=new window2();
    QLabel *label=new QLabel("Test3");
    QVBoxLayout *vblay=new QVBoxLayout;
    vblay->addWidget(label);
    cont_one_win->setLayout(vblay);
    (*gridlay)->addWidget(cont_one_win,0,1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:29:43.380

您只能连接兼容的信号和插槽。无需通过“兼容性”深入了解细节，您可以考虑类似的参数（按数量和类型匹配）。

在您的情况下，您正在尝试连接两个不兼容的事物。信号：void clicked() 和槽：void scW(QWidget *widget);

如果您想保持原样，您需要 QSignalMapper 将 clicked() 映射到您的方法。像这样的东西：

```
QSignalMapper * mapper = new QSignalMapper();

connect(mapper, SIGNAL(mapped(QWidget*)), w, SLOT(scW(QWidget*)));

connect(button_eins1,SIGNAL(clicked()),mapper,SLOT(map()));
mapper->setMapping(button_eins1, mainwindow1);

connect(button_zwei1,SIGNAL(clicked()),mapper,SLOT(map()));
mapper->setMapping(button_eins1, mainwindow2);
... 
```

# c++ - 检查以确保 argv[1] 是整数 c++

> ID：16156881
> 
> 赞同：2
> 
> 时间：2013-04-22T21:17:04.507
> 
> 标签：c++, integer, argv, argc

对于我的程序，我必须确保用户只输入一个正整数。例如，如果用户输入 12hi 它不应该运行程序并打印到 std 错误。我不太确定如何实现这一点。

```
int main(int argc, char *argv[])   
{ 
    if(atoi(argv[1]) < 1)
    {
        cerr << "ERROR!"<< endl;
        return 1;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T21:35:34.187

将其传递给 a[`std::istringstream`](http://en.cppreference.com/w/cpp/io/basic_istringstream)并确保所有数据都已处理：

```
if (a_argc > 1)
{
    std::istringstream in(a_argv[1]);
    int i;
    if (in >> i && in.eof())
    {
        std::cout << "Valid integer\n";
    }
} 
```

[请参阅http://ideone.com/8bEYJq](http://ideone.com/8bEYJq)上的在线演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:33:58.820

好的，我修改后的答案。sscanf 并没有像我想象的那样表现，而 strtol 提供了非常便携的最佳类 C 解决方案。

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char* argv[])
{
  for (int i=1; i < argc; i++){
      char* end;
      long val = strtol(argv[i], &end, 10);
      if (argc >= 2 && !end[0] && val >= 0){
          printf("%s is valid\n", argv[i]);
      } else {
          printf("%s is invalid\n", argv[i]);
      }
  }
  return 0;
} 
```

样本输出：./a.out 10 -1 32 1000 f -12347 +4 --10 10rubbish

```
10 is valid
-1 is valid
32 is valid
1000 is valid
f is invalid
-12347 is valid
+4 is invalid
--10 is invalid
10rubbish is invalid 
```

这是有效的，因为 strtol 会将参数转换为 long int。然后如果 end[0] 不在字符串的末尾，它将是非零的，这意味着它会抛出 10rubbish 的错误，但对于像 10 这样的值是可以的。当然我们只想要正整数，我已经在该集合中包含值 0。

**atoi()**本身还不够好，因为它会在失败时返回零。0 可能是有效输入。

**sscanf()**本身也不够好，因为它会成功转换像 10rubbish 这样的字符串并返回值 10。

我意识到 op 只需要 argv[1]，这个答案会扫描所有提供的 args，只是为了显示大量有效和无效条目的输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T22:34:09.520

由于您显然不反对使用标准 C 库，因此该函数

```
long strtol (const char* str, char** endptr, int base) 
```

from`<cstdlib>`足以确保命令行参数是一个（长）整数，带有可选的“-”或“+”前缀，仅此而已。您只需要检查`char *`存储在`endptr`返回地址'\0'，它告诉您该函数已经消耗了整个参数。

```
#include <cstdlib>
#include <iostream>

using namespace std;

int main(int argc, char *argv[])   
{
    if (argc < 2) {
        return 1;
    }

    char * endp;
    long i = strtol(argv[1],&endp,10);
    if (!*endp) {
        cout << "The value of \"" << argv[1] << "\" is " << i << endl;
        return 0;
    }
    cerr << "\"" << argv[1] << "\" is not an integer" << endl;
    return 1;
} 
```

**稍后**......或迎合史蒂夫杰索普的评论：

```
#include <cstdlib>
#include <iostream>
#include <climits>

using namespace std;

int main(int argc, char *argv[])   
{
    if (argc < 2) {
        return 1;
    }

    char * endp;
    long i = strtol(argv[1],&endp,10);

    if (*endp) {
        cerr << "\"" << argv[1] << "\" is not an integer :(" << endl;
        return 1;
    }
    if (endp == argv[1]) {
        cerr << "Empty string passed :(" << endl;
        return 1;
    }
    if (i < 0) {
        cerr << "Negative " << i << " passed :(" << endl;
        return 1;
    }
    if (i <= INT_MAX) {
        cout << "Non-negative int " << i << " passed :)" << endl;
    } else {
        cout << "Non-negative long " << i << " passed :)" << endl;
    }
    return 0;

} 
```

包装函数将是为了这种程度的区分。并且仍然存在非常极端的情况，即 的输入`ULONG_MAX`将被接受为`LONG_MAX`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T21:24:37.407

您可以尝试检查其中的所有字符`argv[1]`是否都是数字（可能带有前导减号）。可以使用标准库函数进行检查`isdigit()`。

[http://www.cplusplus.com/reference/cctype/isdigit/](http://www.cplusplus.com/reference/cctype/isdigit/)

基于 OP 实际代码的完整解决方案（也可在[http://codepad.org/SUzcfZYp 获得](http://codepad.org/SUzcfZYp)）：

```
#include <stdio.h>          // printf()
#include <stdlib.h>         // atoi()
#include <ctype.h>          // isdigit()

int main(int argc, char *argv[])   
{ 
    if( argc != 2 ) {
        return 0;
    }

    char * pWord = argv[ 1 ];
    char c = 0;
    for( int i = 0; c = pWord[ i ], c ; ++i ) {
        if( ! isdigit( c ) ) {
            return 0;
        }
    }

    int argvNum = atoi( argv[ 1 ] );
    printf( "argc = %d, argv[ 1 ] = %s, argvNum = %d\n",
        argc, argv[ 1 ], argvNum );
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-23T00:44:44.693

我是 C++ 新手，所以如果这是错误的，请不要激怒我，但你不能抛出异常并允许用户重新更正输入吗？

我学会了几种处理错误的方法：

1.  If/Else 处理
2.  断言
3.  抛出异常

1.如果/否则#include

```
int main(int argc, int **argv) {
    if (!isdigit(argv[1])) {
        // handle code if it's not a digit.
        return 0;
    }
} 
```

这可能是最简单的方法来确保

* * *

2.断言#include

```
int main(int argc, int *argv[]) {
    assert(isdigit(argv[1]));
} 
```

## * 如果 argv[1] 不是数字，断言将终止程序

3.抛出#include

```
using namespace std;

class Except {};

int main(int argc, int **argv) {
    try {
        isdigit(argv[1]);
        throw Except();
        // this code will not be executed
        // if argv[1] is not a digit
    }
    catch (Except) {
        cout << "argv[1] is not a digit.";
        // handle exception or rethrow
    } 
} 
```

绝对值得注意的是，**抛出异常将创建堆栈跟踪**，并且在抛出异常和捕获异常的块之间的所有代码都不会被执行。

# javascript - 如何设置 GWT 滑块小部件的宽度

> ID：16156888
> 
> 赞同：0
> 
> 时间：2013-04-22T21:17:28.250
> 
> 标签：javascript, gwt, slider, smartgwt

我正在使用水平相邻的 3 个垂直滑块（com.smartgwt.client.widgets.Slider）（如 | | | ）我似乎无法弄清楚如何设置它们的宽度，以便让它们靠得更近. 我在 CSS 文件中尝试了 .setWidth 属性和一些类似的设置。有一些属性可以设置滑块本身的宽度，但不能设置小部件的整体大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T05:57:22.607

我不知道您希望它们有多接近，但是当您使用诸如 firebug 之类的工具查看时，您可以看到小部件的组成，并看到标签宽度与滑块的总宽度协作（可能与滑块的其他部分一样） . 我用这个方法做了一个测试，`slider.setLabelWidth(10);`整体宽度在变化。是不是你想要的。如果不提供一点代码。

# jquery - jquery 循环遍历表单项返回带有标题、id 的值

> ID：16156889
> 
> 赞同：0
> 
> 时间：2013-04-22T21:17:29.157
> 
> 标签：jquery, forms, dom

我想遍历所有填写的表单项、输入、选择、单选、复选框等以提取值。

以下代码运行良好

```
var fields = $(":input").serializeArray();
$("#results").empty();
jQuery.each(fields, function(i, field){
$("#results").append(field.value + " "); 
```

但是，我想将多个属性附加到返回的值，例如名称、id、标题等。不幸的是，我在这方面的尝试无济于事。

```
var fields = $(":input").serializeArray();
$("#results").empty();
jQuery.each(fields, function(i, field){
var vTitle = $(each).attr('title');
$("#results").append(vTitle + " " + field.value + " "); 
```

不工作

任何帮助，将不胜感激

干杯

编辑...感谢您的输入，但返回的是“未定义”。这是我正在使用的 HTML

编辑显示所有内容

**结果：**

```
<form>
<select title="Staff:" name="single">
  <option>Single</option>
  <option>Single2</option>
  <option>Single3</option> 
 </select>
 <select name="multiple" multiple="multiple">
  <option selected="selected">Multiple</option>
  <option>Multiple2</option>

  <option selected="selected">Multiple3</option>
 </select><br/>
 <input title="Staff:" type="checkbox" name="check" value="check1" id="ch1"/>

 <label for="ch1">check1</label>
 <input type="checkbox" name="check" value="check2" checked="checked" id="ch2"/>

 <label for="ch2">check2</label>
 <input type="radio" name="radio" value="radio1" checked="checked" id="r1"/>

 <label for="r1">radio1</label>
 <input type="radio" name="radio" value="radio2" id="r2"/>

 <label for="r2">radio2</label>
</form>
<script>
function showValues() {
var fields = $(":input");
$("#results").empty();
jQuery.each(fields, function(i, v){
$("#results").append(v.title + " " + v.value + " ");
});
}

$(":checkbox, :radio").click(showValues);
$("select").change(showValues);
showValues();
</script>

</body> 
```

我需要查看附加到选择值的“员工：”

这对我有用

```
function showValues() {
var fields = $(":input");
$("#results").empty();
var val;

jQuery.each(fields, function (i, v) {
        // if doesn't have checked property then get value - 
        // if checked return value 
        // else return empty string
        val = this.checked == undefined ? this.value : this.checked ? this.value : "";    
    if (val != ''){
            $("#results").append(v.title + " " + val + " " + v.id + "<br/> ");
    }
});
}
$("select,:checkbox, :radio").change(showValues);
showValues(); 
```

这会遍历表单元素并仅在元素具有值时返回元素值和标题属性...非常感谢@wirey

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:21:24.210

您在最后一个每个循环中有一个错误：

```
var fields = $(":input");
$("#results").empty();
jQuery.each(fields, function(i, field){
    var vTitle = $(this).attr('title'); // each should be called this
    $("#results").append(vTitle + " " + field.value + " ");
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:21:45.333

代替：

```
var vTitle = $(each).attr('title'); 
```

做

```
var vTitle = $(field).attr('title'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:31:08.483

如果您想访问除名称/值之外的其他属性，请不要使用[.serializeArray() .. jQuery 文档说明了这一点](http://api.jquery.com/serializeArray/)

> 将一组表单元素编码为名称和值的数组。

```
var fields = $(":input");
$("#results").empty();
jQuery.each(fields, function(i, v){
   $("#results").append(v.title + " " + v.value + " ");
}); 
```

[小提琴](http://jsfiddle.net/7bcTX/)

# wpf - Newline or carriage returns in Multibind StringFormat

> ID：16156890
> 
> 赞同：9
> 
> 时间：2013-04-22T21:17:36.500
> 
> 标签：wpf, xaml, textblock, multibinding

So i've got the following:

```
<TextBlock.Text>
  <MultiBinding StringFormat="So and so will donate {0:C0}&#x0d;&#x0a;to {1}, bringing the&#x0d;&#x0a;total amount to {2:C0}.">
    <Binding Path="VisitorTotal" />
    <Binding Path="EventName" />
    <Binding Path="EventTotal" />
  </MultiBinding>
</TextBlock.Text> 
```

I've tried `&#x0d;&#x0a;`, `&#10;`, `\n`, `\\n`, and various combinations thereto. Nothing will give me a newline. What's the deal?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-22T21:21:20.773

My preference is to use `Environment.NewLine` directly:

```
<MultiBinding StringFormat="So and so will donate {0:C0}{3}to {1}, bringing the{3}total amount to {2:C0}.">
  <Binding Path="VisitorTotal" />
  <Binding Path="EventName" />
  <Binding Path="EventTotal" />
  <Binding Source="{x:Static System:Environment.NewLine}"/>
</MultiBinding> 
```

However, you'll also need to make sure the [`TextBlock.TextWrapping`](http://msdn.microsoft.com/en-us/library/system.windows.controls.textblock.textwrapping%28v=vs.110%29.aspx) is set appropriately.

# php - PHP目录下载

> ID：16156894
> 
> 赞同：0
> 
> 时间：2013-04-22T21:17:44.830
> 
> 标签：php, apache, debian

我正在寻找一种最佳实践方法，以便将目录内容下载给用户。

目前，我向用户提供两种技术： - 使用 PHP 和 XSendFile for Apache 逐一下载，以获得更好的文件 - 用于“压缩”临时目录（24 小时）的堆栈并下载包含整个目录的 zip 与目录层次结构。

但我正在寻找对 PHP（或其他）整个目录下载的更好支持。您是否有任何想法来降低 CPU/内存成本并更快地获得整个目录？

（唯一的限制是在服务器端并且用户正在通过网络浏览器导航）

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:25:01.283

平均而言，Gzip 会比 zip 为您提供更好的压缩，但我会坚持使用 zip，因为它具有可移植性（Windows 仅支持这个）。

[如何[递归地]压缩PHP中的目录？](https://stackoverflow.com/questions/1334613/how-to-recursively-zip-a-directory-in-php)

[哪个更高效：使用系统命令压缩还是使用 PHP ZipArchive？](https://stackoverflow.com/questions/7079674/which-is-more-efficient-zipping-with-a-system-command-or-using-php-ziparchive)

# if-statement - ASP 如果 x = y 然后包含文件 a

> ID：16156898
> 
> 赞同：1
> 
> 时间：2013-04-22T21:18:00.457
> 
> 标签：if-statement, asp-classic, include

首先，ASP 不是我的东西，coldfusion 是。我正在帮助一个非营利性动物救援组织在他们的网站上更新一些看似简单的项目，但我并不精通 ASP，所以事实证明它比我预期的要难。为他们设置网站的人将滑块放在每个页面上。他们想要做的是只在 index.asp 上有页面。

我想出了以下代码逻辑，但它不起作用。我已经对其进行了研究，并且知道它*为什么*不起作用，但我无法弄清楚*如何*使它起作用。
**更新：**

```
<% if(Request.ServerVariables("SCRIPT_NAME") = "index.asp") { %>
<!--#include file ="_slider.asp"-->
<% } %> 
```

任何*建设性*的指导或链接或小提琴将不胜感激。我不打算在网站上提供太多帮助，直到主要开发人员从现役返回。

**更新**：我更新了我的代码以包含滑块，如下所示，但我仍然收到非描述性页面错误。

```
<% 
Dim ThisPage
ThisPage = getFileName(Request.ServerVariables("SCRIPT_NAME"))
if ThisPage = "index.asp" Then %>
    <!--#include file="/includes/_mainPage_slider.asp"-->   
<% End If %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:34:41.293

你有2个问题。
首先，
Request.ServerVariables("SCRIPT_NAME") 返回完整路径和文件名。如果只想获取文件名，可以使用这个函数：

```
Function getFileName()
  Dim lsPath, arPath

  ' Obtain the virtual file path
  lsPath = Request.ServerVariables("SCRIPT_NAME")

  ' Split the path along the /s. This creates an
  ' one-dimensional array
  arPath = Split(lsPath, "/")

  ' The last item in the array contains the file name
  GetFileName =arPath(UBound(arPath,1))
End Function 
```

其次，
您使用的是**PHP**，但您说您使用的是**asp-classic**。不知道你是否知道。上面的示例使用 VBScript（主要的经典 ASP 语言）。如果您使用的是 PHP，那么您应该能够弄清楚如何翻译它。

如果您尝试使用 ASP，则使用上述函数，您的代码应如下所示：

```
<% if(getFileName(Request.ServerVariables("SCRIPT_NAME")) = "index.aspx") Then %>
<!--#include file ="_slider.aspx"-->
<% End If %> 
```

[参考](http://www.kamath.com/codelibrary/cl005_filename.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T07:40:02.480

您尝试做的事情是正确的，但 Classic ASP 的语法是错误的。尝试...

```
<% if Request.ServerVariables("SCRIPT_NAME") = "index.asp" then %>
<!--#include file ="_slider.asp"-->
<% end if %> 
```

# python - Django LoginFormMiddleware breaks with class based views

> ID：16156899
> 
> 赞同：0
> 
> 时间：2013-04-22T21:18:15.800
> 
> 标签：python, django, django-class-based-views

As per a few [other SO answers](https://stackoverflow.com/questions/2734055/putting-a-django-login-form-on-every-page), I'm using middleware to show a login form on every page of my project, such that a user can login in-place. I am aware some frown upon this, but it really does make for a much better user experience. Ideally it'd be asynchronous, but I haven't gotten there.

Anyway, middleware.py:

```
from MyProj.forms import MyProjTopLoginForm
from django.http import HttpResponseRedirect
from django.core.urlresolvers import reverse

#Notes: https://stackoverflow.com/questions/2734055/putting-a-django-login-form-on-every-page
class LoginFormMiddleware(object):

    def process_request(self, request):

        # if the top login form has been posted
        if request.method == 'POST' and 'top_login_form-username' in request.POST:

            # validate the form
            form = MyProjTopLoginForm(prefix="top_login_form", data=request.POST)
            if form.is_valid():

                # log the user in
                from django.contrib.auth import login
                login(request, form.get_user())

                # if this is the logout page, then redirect to /
                # so we don't get logged out just after logging in
                if reverse('logout') in request.get_full_path():
                    return HttpResponseRedirect('/')
                #return HttpResponseRedirect('/')

        else:
            form = MyProjTopLoginForm(request, prefix="top_login_form")

        # attach the form to the request so it can be accessed within the templates
        request.top_login_form = form

class LogoutFormMiddleware(object):
    def process_request(self, request):
        if request.method == 'POST' and request.POST.has_key('logout-button') and request.POST['logout-button'] == 'logout':
            from django.contrib.auth import logout
            logout(request)
            request.method = 'GET' 
```

and views.py:

```
from django.shortcuts import render, redirect
from django.contrib.auth.decorators import login_required
from django.db.models import Count
from django.core.urlresolvers import reverse

from django.views.generic import TemplateView

class Index(TemplateView):
    template_name = 'KReport2/index.djhtml'

'''
def index(request):
    return render(request, 'KReport2/index.djhtml')
'''

def logoutpage(request):
    from django.contrib.auth import logout
    logout(request)
    return redirect(index) 
```

You'll note that I've commented the old index view function and replaced it with a class-based view. Normally I wouldn't subclass, but instead pass template_name in urls.py, but that's besides the point here. My problem seems to be that the middleware breaks. Filling in UN/Pass on the index page, then submitting, the middleware captures the form and logs me in, but then django goes on to return a blank http response. No error, but also no rendered index page. I've just got no idea where the break is happening.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:48:48.523

在基于类的视图中，默认的[调度](https://docs.djangoproject.com/en/1.5/ref/class-based-views/base/#django.views.generic.base.View.dispatch)方法尝试委托给与 HTTP 方法相对应的方法。

[`TemplateView`](https://github.com/django/django/blob/master/django/views/generic/base.py#L147)唯一实现了一个方法`get()`，所以它只适用于 GET 请求。当您使用`POST`请求登录时，调度方法会查找`TemplateView.post()`方法。因为这不存在，所以它返回 HTTP 错误 405（不允许方法）。

在您的中间件中，我建议您在成功登录后重定向到相同的 url。这个[Post/Redirect/Get](https://github.com/django/django/blob/master/django/views/generic/base.py#L147)模式通常是很好的建议。浏览器将跟随重定向，并`IndexView`使用 GET 请求获取，这将成功。

```
if form.is_valid():
    # log the user in
    from django.contrib.auth import login
    login(request, form.get_user())

    # if this is the logout page, then redirect to /
    # so we don't get logged out just after logging in
    if reverse('logout') in request.get_full_path():
        return HttpResponseRedirect('/')
    # redirect to the same url after a successful POST request.
    return HttpResponseRedirect('') 
```

最后，浏览器可能会显示一个空白页面，但还有更多信息可用于调试。Django 开发服务器将显示它返回了 405 错误代码。使用浏览器的开发人员工具栏，它应该会显示错误代码的描述`405 METHOD NOT ALLOWED`，以及`Allow:get, head`告诉您视图不允许发布请求的标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:23:43.903

为了最终确定这个问题，Alasdair 的回答很到位。我使用的最终代码是

```
from MyProj.forms import MyProjTopLoginForm
from django.http import HttpResponseRedirect
from django.core.urlresolvers import reverse

#Notes: http://stackoverflow.com/questions/2734055/putting-a-django-login-form-on-every-page
class LoginFormMiddleware(object):

    def process_request(self, request):

        # if the top login form has been posted
        if request.method == 'POST' and 'top_login_form-username' in request.POST:

            # validate the form
            form = MyProjTopLoginForm(prefix="top_login_form", data=request.POST)
            if form.is_valid():

                # log the user in
                from django.contrib.auth import login
                login(request, form.get_user())

                # if this is the logout page, then redirect to /
                # so we don't get logged out just after logging in
                if reverse('logout') in request.get_full_path():
                    return HttpResponseRedirect('/')
                # Redirect to the same page after successfully handling the login form data.
                return HttpResponseRedirect('')
                # We could also do:
                # request.method = 'GET'
                # instead of a redirect, but if a user refreshes the page, they'll get prompted to re-send post data,
                # which is super annoying.

        else:
            form = MyProjTopLoginForm(request, prefix="top_login_form")

        # attach the form to the request so it can be accessed within the templates
        request.top_login_form = form

class LogoutFormMiddleware(object):
    def process_request(self, request):
        if request.method == 'POST' and request.POST.has_key('logout-button') and request.POST['logout-button'] == 'logout':
            from django.contrib.auth import logout
            logout(request)
            # Same as above. Handle the post data, then redirect to a new GET (not POST) request. 
            return HttpResponseRedirect('') 
```

这解决了原始问题，并在成功处理（登录、注销）数据时发出重定向，以便用户触发的刷新不会提示重新发送表单。

# android - AVD 管理器：无法创建 Android 虚拟设备

> ID：16156900
> 
> 赞同：0
> 
> 时间：2013-04-22T21:18:27.103
> 
> 标签：android, avd

当我尝试创建新的 AVD 设备时，确定按钮显示为灰色。我检查了更新并安装了 ARM EABI v7a 系统映像（以及后面的系统映像）。

我无法选择 CPU/ABI。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T06:36:03.630

据我所知，发生这种情况是因为任何一个字段没有正确填写或不可用。

# cross-browser - How effective is the Chrome developer tools user-agent override at emulating other browsers?

> ID：16156904
> 
> 赞同：5
> 
> 时间：2013-04-22T21:18:49.543
> 
> 标签：cross-browser, internet-explorer-7, google-chrome-devtools

The Chrome developer tools have a feature to change the user-agent to spoof servers enabling developers to test applications for other devices and browsers without having to leave the comfort of the Chrome browser on a desktop terminal. I assume that Chrome emulates these other browsers rather than them virtually. How standards compliant is Chrome with regard to JavaScript, CSS, and other technical browser differences? For instance, has anyone done a comprehensive test to determine if the Chrome emulation of Internet Explorer 7 and the actual Internet Explorer 7 render identical pages, pixel for pixel?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-28T11:24:45.287

当用户代理字符串更改时，Chrome 根本*不会***尝试**模拟其他浏览器。 要验证此断言，只需使用 Internet Explorer 特定的功能，例如条件编译、条件注释、ActiveX、VB 脚本……这些在 Chrome 中都没有。

 *如果您想让 Chrome 像 Internet Explorer 一样呈现页面，请安装[IE Tab Chrome 扩展程序](https://chrome.google.com/webstore/detail/ie-tab/hehijbfgiekmjfkfjpbkbammjbdenadd)。但需要现有 Internet Explorer 安装，这意味着不支持 Linux 和 Mac 等非 Windows 操作系统。*

# playframework-2.0 - 如何在 play framework 2 中共享模块

> ID：16156909
> 
> 赞同：2
> 
> 时间：2013-04-22T21:18:57.077
> 
> 标签：playframework-2.0, sbt

我正在尝试使用 play framework 2 (JAVA) 构建 2 个使用相同核心功能的网站。挑战在于如何设置项目，以便可以在 2 个项目之间共享核心部分。在 play 1 中，我们可以有一个公共模块并由应用程序将其汇集，但我找不到使用 play 2 的方法。我知道我可以创建一个模块目录并将核心代码放在那里，但这不会对我来说是一个理想的解决方案，因为模块中的代码需要与多个项目共享。有人知道如何解决这个问题吗？

到目前为止，我试图通过创建一个包含 3 个模块的项目来解决这个问题，一个是核心模块，另一个是网站。

```
-mainProject
      -modules
           -core
           -website1
           -website2 
```

但问题是我无法从其他模块中的代码调用核心中的函数。加上不方便的是，我保留了多个构建文件和路由文件，并且根据我要构建的网站，我重命名它们。

请注意，核心需要在控制器中有自己的路由和操作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T02:32:11.970

我不认为 Play 内置了多模块支持，但您也许可以在 Play 之上使用 Maven 组合解决方案。

你可以做什么来制作 3 个不同的 Play 项目，Core、Website1 和 Website2 各一个。由于您需要“导出”核心项目，您可以使用 Maven 来执行此操作。

在 Core 项目中，您创建一个 pom.xml（一个 Maven 构建文件），可以[将 Core 项目打包为 JAR](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)。然后运行[​​mvn install:install](http://maven.apache.org/plugins/maven-install-plugin/usage.html)在本地存储库中安装核心 JAR，然后可以在其他网站项目中使用它。（旁注，这里有一个[Maven-Play 桥](https://code.google.com/p/play2-maven-plugin/wiki/Rationale)，您可能会发现它很有用）

现在，在您的 Website1 和 Website2 Play 项目中，您将在 Build.scala 文件中添加对这个 JAR的[依赖项。](http://www.playframework.com/documentation/2.0/SBTDependencies)您将其添加到 appDependencies

```
val appDependencies = Seq(
    "your-core-project-artifact-name" % "your-core-project-project-name" % "1.0.0.0",
    "javax.mail" % "mail" % "1.4" // Existing libraries
) 
```

最后，将您的本地存储库（正在安装核心项目的位置）添加为您的 Website1 和 Website2 项目中的解析器

```
resolvers += (
    "Local Maven Repository" at "file://"+Path.userHome.absolutePath+"/.m2/repository"
) 
```

你有它。当您构建您的 Website1/Website2 项目时，Play 应该将依赖项添加到您的核心项目中，您将能够从您的网站项目中调用核心项目中的方法

# php - 已定义路线上的地理编码距离

> ID：16156914
> 
> 赞同：1
> 
> 时间：2013-04-22T21:19:17.053
> 
> 标签：php, geocode

我正在为 MS Bike 活动开发一个移动网站。我已经有用于标记电子邮件请求的地理代码，以及一个签到站点，用于根据乘客的位置将乘客签到某个位置。我想将距离添加到下一个休息站/终点。我知道如何计算两个位置之间的距离。我对此的所有研究，都是为了让谷歌提供路线。但由于这是一项赛事，车手们有一个预定的路线。

有人对如何解决这个问题有任何想法吗？我有路线的纬度/经度（每个拐角和转弯），并且我有 kml 格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:06:57.847

如果路点的分辨率足够明显，我可以看到两种情况：最近的路点要么是下一个点，要么是前一个点：

![在此处输入图像描述](https://i.stack.imgur.com/4INGZ.png)

因此，如果您不仅计算到最近点的距离，还计算到上一个和下一个点的距离，您应该能够简单地确定下一个是哪一个。

正如所写，这要求点之间的分辨率足够好。例如，如果您有一个 180 度曲线的课程，那么事情的评估就不再那么好了：

![在此处输入图像描述](https://i.stack.imgur.com/mpNkr.png)

解决方案是在这些区域有足够的航路点。所以这可能适合也可能不适合您的问题。很抱歉这些垃圾图形，但我希望它们能很好地说明这一点。这个概念也有点粗糙，但可能足以创建第一个模拟。

# java - 我正在尝试逐行反转数组

> ID：16156915
> 
> 赞同：4
> 
> 时间：2013-04-22T21:19:17.507
> 
> 标签：java, arrays

澄清一下，这是一个家庭作业。我只是在寻找建议，我不是在找人为我做功课。

我已经完成了前半部分。它使用两个数组来打印 Asterisk 设计（在这种情况下，是字母“S”。效果很好。然后，我跳过两行并打印设计但翻转了（所以每行都颠倒了）。它似乎工作正常,但是当我运行程序时,它会打印两个 S 并且第二个没有反转。关于我做错了什么的任何想法？

```
public class Design {
   public static void main (String [] args) {
       char [] array = new char [150];
       for (int index = 0; index < array.length; index ++) 
       {
         array [index] = '#';
       }
       int [] indexNumbers = {
           0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,
           60,70,71,72,73,74,75,76,77,78,79,89,99,109,119,129,139,140,
           141,142,143,144,145,146,147,148,149
       };
       for (int i = 0; i < indexNumbers.length; i++) 
       {
         array [indexNumbers[i]] = ' ';
       }
      for (int index = 0; index < array.length; index ++)
      {
         if (index % 10 == 0 && index > 0) 
         System.out.println();
         System.out.print (array[index]);
      }

      //Now, to reverse the letter

      System.out.println();
      System.out.println();

      int lines = 5;
      for (int i = 0; i< array.length; i++){
        if (i >= lines)
          lines += 10;
        char temp = array [i];
        array [i] = array [lines - i - 1];
        array [lines - i - 1] = temp;
      }
      for (int index = 0; index < array.length; index ++)
      {
        if (index % 10 == 0 && index > 0) 
          System.out.println();
          System.out.print (array[index]);
      }
    }
  } 
```

编辑：是的......设计在空间中，其他一切都是星号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:46:09.513

你的倒车有点混乱......如果你在两个循环中做它会更容易。

```
for (int row = 0; row < (array.Length / 10); row++)
{
    for (int col = 0; col < 5; col++)
    {
        int rowStart = row * 10;
        int rowEnd = rowStart + 9;
        char temp = array[rowStart + col];                    
        array[rowStart + col] = array[rowEnd - col];
        array[rowEnd - col] = temp;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T21:30:34.567

首先，你为什么不使用`String[]`or `char[][]`？相反，您正在使用一个简单的数组在其中放置多行。这会使您的代码混乱和脆弱。

要交换数组，规则通常很简单：获取第一行和最后一行并交换它们。得到第二个和倒数第二个，然后交换它们，得到第三个和倒数第三个，然后交换它们......直到你到达中间。`String[]`如果您有一个每个元素都是一行的数组（例如在 an 中或在 an 中） ，这将容易得多`char[][]`。

如果您需要保持`char[]`每个 10 字符块是一行的简单概念，只需像我上面所说的那样交换每个 10 字符块。

如果您不想更改程序的一般行为，这是有问题的块：

```
 int lines = 5;
  for (int i = 0; i< array.length; i++){
     if (i >= lines)
        lines += 10;
    char temp = array [i];
    array [i] = array [lines - i - 1];
    array [lines - i - 1] = temp;
  } 
```

您不是在此处交换行，而是在交换字符。这样，您的 if 不是检查和跳过行，而是检查和跳过字符。

这个更好：

```
 int lines = array.length / 10;
  for (int i = 0; i<= lines / 2; i++){
      for (int j = 0; j < 10; j++) {
          char t = array[i * 10 + j];
          array[i * 10 + j] = array[(lines - i - 1) * 10 + j];
          array[(lines - i - 1) * 10 + j] = t;
      }
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T22:14:31.610

所以..

首先，首先打印`'#'`而不是`' '`，而`'.'`不是`'#'`。你会更清楚地看到发生了什么。

其次，你逆向有问题，你实际上并没有逆向任何东西，你计算指数的方式`lines - i - 1`是错误的。好办法是`(i / 10) * 10 + (10 - (i % 10)) -1`。是的，有点可怕，但如果你想在一行中使用一维数组，那就是它。现在由您来理解它，并将其集成到您的代码中；）

# javascript - Google Maps API 圆相交检测

> ID：16156917
> 
> 赞同：0
> 
> 时间：2013-04-22T21:19:32.113
> 
> 标签：javascript, google-maps-api-3

我试图弄清楚是否有可能检测到两个谷歌地图圆圈（围绕标记）何时相交或相互碰撞。

我想要完成的是，如果两个圆圈相交，我想提出一个事件。我不确定这是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T00:33:11.513

计算两个圆心之间的距离，如果小于两个圆的半径之和，则它们相交。

[概念证明小提琴](https://jsfiddle.net/geocodezip/o5veapsx/7/)

（基于 Larry Dukek 答案中的代码，但使用几何库中的原生 Google Maps Javascript API v3 函数）

[![示例截图](https://i.stack.imgur.com/AZVLv.png)](https://i.stack.imgur.com/AZVLv.png)

**代码片段：**

```
let map;

function initMap() {
  // Create the map.
  map = new google.maps.Map(document.getElementById('map'), {
    center: {
      lat: 41.081301,
      lng: -98.214219
    },
    zoom: 25
  });

  var c0 = new google.maps.Circle({
    strokeColor: '#0000FF',
    strokeOpacity: 1,
    strokeWeight: 1,
    fillColor: '#0000FF',
    fillOpacity: 0.2,
    map: map,
    center: {
      lat: 41.082953,
      lng: -98.215285
    },
    radius: 200
  });

  var c1 = new google.maps.Circle({
    strokeColor: '#FF0000',
    strokeOpacity: 1,
    strokeWeight: 1,
    fillColor: '#FF0000',
    fillOpacity: 0.2,
    map: map,
    center: {
      lat: 41.081070,
      lng: -98.214027
    },
    radius: 34.692866520
  });
  console.log("c1 & c0 hasIntersections returns:" + hasIntersections(c1, c0));
  var c2 = new google.maps.Circle({
    strokeColor: '#00FF00',
    strokeOpacity: 1,
    strokeWeight: 1,
    fillColor: '#00FF00',
    fillOpacity: 0.2,
    map: map,
    center: {
      lat: 41.083313,
      lng: -98.211635
    },
    radius: 34.692866520
  });
  console.log("c2 & c0 hasIntersections returns:" + hasIntersections(c2, c0));
}

function hasIntersections(circle0, circle1) {
  var center0 = circle0.getCenter();
  var center1 = circle1.getCenter();

  var maxDist = circle0.getRadius() + circle1.getRadius();
  var actualDist = google.maps.geometry.spherical.computeDistanceBetween(center0, center1);

  return maxDist >= actualDist;
}
```

```
/* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

#map {
  height: 100%;
}

/* Optional: Makes the sample page fill the window. */

html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}
```

```
<!DOCTYPE html>
<html>

<head>
  <title>Circles</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
  <!-- jsFiddle will insert css and js -->
</head>

<body>
  <div id="map"></div>

  <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCkUOdZ5y7hMm0yrcCQoCvLwzdM6M8s5qk&callback=initMap&libraries=geometry&v=weekly&channel=2" async></script>
</body>

</html>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-18T14:12:36.460

这里有一些 JavaScript 可以检测两个圆是否相交

```
 var e = Math;         // shortcut for the mathematical function 
 var D2R = e.PI/180.0; // value used for converting degrees to radians

 Number.prototype.toRadians = function() {
   return this * D2R;
 };

 function distance(lat0,lng0,lat1,lng1){

   // convert degrees to radians
   var rlat0 = lat0.toRadians();
   var rlng0 = lng0.toRadians();
   var rlat1 = lat1.toRadians();
   var rlng1 = lng1.toRadians();

   // calculate the differences for both latitude and longitude (the deltas)
   var Δlat=(rlat1-rlat0);
   var Δlng=(rlng1-rlng0);

   // calculate the great use haversine formula to calculate great-circle distance between two points
   var a = e.pow(e.sin(Δlat/2),2) + e.pow(e.sin(Δlng/2),2)*e.cos(rlat0)*e.cos(rlat1);
   var c = 2*e.asin(e.sqrt(a));
   var d = c * 6378137;  // multiply by the radius of the great-circle (average radius of the earth in meters)

   return d;
 }

  function hasIntersections(circle0,circle1){
    var center0 = circle0.getCenter();
    var center1 = circle1.getCenter();

    var maxDist = circle0.getRadius()+circle1.getRadius();
    var actualDist = distance(center0.lat(),center0.lng(),center1.lat(),center1.lng());

    return maxDist>=actualDist;
  } 
```

只需使用对您圈子的引用调用 hasIntersections 即可。这是一个示例，显示两个圆圈几乎接触（返回假），如果您将 c1 中的零更改为一，它们将接触（返回真）。

```
 map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: 41.081301, lng: -98.214219},
      zoom: 25
    });

    var c0 = new google.maps.Circle({
        strokeOpacity: .1,
        strokeWeight: 1,
        fillColor: '#0000FF',
        fillOpacity: .2,
        map: map,
        center: {lat:41.082953, lng:  -98.215285},
        radius: 200
      });

    var c1 =new google.maps.Circle({
        strokeOpacity: .1,
        strokeWeight: 1,
        fillColor: '#FF0000',
        fillOpacity: .2,
        map: map,
        center: {lat:41.081070, lng: -98.214027},
        radius: 34.692866520
      });
      console.log(hasIntersections(c1,c0)); 
```

# c# - 尝试在 SignalR 自托管服务器和客户端之间传递消息时出现 500 内部服务器错误

> ID：16156918
> 
> 赞同：2
> 
> 时间：2013-04-22T21:19:36.223
> 
> 标签：c#, mono, signalr

我正在尝试在 Mono 解决方案上创建一个 SignalR 自托管服务器的简单示例，以向我们的执行部门演示。我遵循了 github 示例代码，并且我有一半的功能工作。当按下“广播”按钮时，文本框中的消息会在服务器控制台中回显，但不会广播回客户端。

服务器代码：

```
 public class Global : System.Web.HttpApplication
    {
        void Application_Start(object sender, EventArgs e)
        {
            //Initialize your application
            new AppHost().Init();

            WebApplication.Start<Startup>("http://127.0.0.1:10000");
        }

        protected void Application_BeginRequest(object src, EventArgs e)
        { 
            this.Context.Response.AddHeader("Access-Control-Allow-Headers", "accept,origin,authorization,content-type");

            #if DEBUG
            Profiler.Start();
            #endif
        }

        protected void Application_EndRequest(object src, EventArgs e)
        {
            #if DEBUG
            Profiler.Stop();
            #endif
        }
    }

    class Startup
    {
        public void Configuration(IAppBuilder app)
        {
            app.MapHubs(new HubConfiguration { EnableCrossDomain = true });
        }
    }

    public class Chat : Hub
    {
        public void Send(string message)
        {
            Console.WriteLine(message);
            Clients.All.addMessage(message);
        }
    }
} 
```

客户端代码：

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js" type="text/javascript">   </script>
<script src="Scripts/jquery.signalR.min.js" type="text/javascript"></script>
<!--  If this is an MVC project then use the following -->
<!--  <script src="~/signalr/hubs" type="text/javascript"></script> -->
<script src="http://127.0.0.1:10000/signalr/hubs" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        $.connection.hub.url = "http://127.0.0.1:10000/signalr";
        $.connection.hub.logging = true;

        // Proxy created on the fly          
        var chat = $.connection.chat;

        // Declare a function on the chat hub so the server can invoke it          
        chat.client.addMessage = function (message) {
        $('#messages').append('<li>' + message + '</li>');
        };

        // Start the connection
        $.connection.hub.start({ jsonp: true }).done(function() {
            $("#broadcast").click(function () {
                // Call the chat method on the server
                    chat.server.send($('#msg').val());
            });
        });
    });
</script>

  <div>
    <input type="text" id="msg" />
    <input type="button" id="broadcast" value="broadcast" />

    <ul id="messages">
    </ul>
  </div> 
```

当我启动客户端时，我确实在协商过程中遇到了一个奇怪的错误，这看起来很奇怪，因为客户端可以成功地将消息推送到服务器。

```
[17:13:54 GMT-0400 (EDT)] SignalR: Auto detected cross domain url. jquery.signalR.min.js:10
[17:13:54 GMT-0400 (EDT)] SignalR: Negotiating with 'http://127.0.0.1:10000/signalr/negotiate'. jquery.signalR.min.js:10
[17:13:54 GMT-0400 (EDT)] SignalR: SignalR: Initializing long polling connection with server. jquery.signalR.min.js:10
[17:13:54 GMT-0400 (EDT)] SignalR: Attempting to connect to 'http://127.0.0.1:10000/signalr/connect?transport=longPolling&connectionToke…kjVpNzqCLDXzDDRkE&connectionData=%5B%7B%22name%22%3A%22chat%22%7D%5D&tid=2' using longPolling. jquery.signalR.min.js:10
GET http://127.0.0.1:10000/signalr/connect?transport=longPolling&connectionToke…D&tid=2&callback=jQuery191021586751635186374_1366665233871&_=1366665233874 500 (Internal   Server Error) jquery-1.9.1.min.js:5
send jquery-1.9.1.min.js:5
b.extend.ajax jquery-1.9.1.min.js:5
s jquery.signalR.min.js:10
(anonymous function) jquery.signalR.min.js:10
[17:13:54 GMT-0400 (EDT)] SignalR: Longpolling connected 
```

任何帮助将不胜感激。

# php - 将 php 包含到另一个 php 并保持包含？

> ID：16156921
> 
> 赞同：1
> 
> 时间：2013-04-22T21:19:54.833
> 
> 标签：php, include

我正在寻找类似于 php include 方法的解决方案，除了在 html 的 iframe 标记处，如果我单击包含的 php 上的超链接，我不希望浏览器将整个选项卡导航到新的 url，但只有导航包含的页面而不获取父页面更改/消失。

## **更新：**

好的，感谢您的快速回答，似乎我没有问正确的问题:) 所以这里有一些背景信息：整个页面本身是一个单文件网站，使用与您完全相同的 javascript+hiddendivs 页面更改方法刚写的。我的问题是：我正在使用平面文件 CMS 来让没有编码知识的人可以管理我的新闻页面。所以我为CMS制作了一个自己的模板，只显示新闻本身。然后我使用 php include 方法将 CMS 的 index.php 嵌入到我的父 index.php 中，它看起来非常好，除了我的问题是，当我点击“早期帖子”时，它导航到 CMS 的 index.php 并加载早期的新闻那里。我希望它可以加载较早的新闻而无需在任何地方导航，就像在 html 的 iframe 方法中一样。（如果没有其他解决方案，我将使用 iframe，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:45:20.803

您可能做的最好的事情是使用 jquery/javascript 并操作一个 div（或 iframe）到它在与之交互时导航到 X 链接的位置。您实际上可以使用 jquery 更改 iframe 的 url 并将其重新加载到您想要的任何 url。[使用 jQuery 重新加载 iframe](https://stackoverflow.com/questions/4249809/reload-an-iframe-with-jquery)就是一个很好的例子。为了与 iframe 的内容进行交互和挖掘，而不仅仅是更改它的属性，请查看[http://developer.vimeo.com/player/js-api](http://developer.vimeo.com/player/js-api)。

请记住，第二个链接是针对媒体播放器的，但它仍然显示（并且以非常简单的方式）如何与 iframe 进行良好交互。您可以使用 jquery 向最初加载到 iframe 的页面中的链接插入 id 或类，然后让“父页面”上的脚本在单击 iframe 时将其导航到其中一个链接。只是玩弄它并从中获得乐趣；学习经历并不总是像个人地狱一样。我稍后再回来看看结果如何！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:24:42.170

从所描述的操作看来，您正在寻找的实际上不是 PHP，而是客户端 JavaScript。AJAX 可以完全按照您的描述执行，并且有一个名为 jQuery 的非常简单的库可以帮助您以最小的努力做到这一点。

[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/) [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

您可以将您的按钮绑定到一个 JavaScript 函数，该函数随后可以触发 AJAX，获取您的其他 PHP 页面的结果并在 HTML 中的 .class 或 #id 中显示给用户，而无需离开当前页面。

如果您寻找的行为更高级且“类似于应用程序”，您还可以考虑整个 MVC JavaScript 框架，例如 Backbone.js 或 Ember.js

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T22:00:45.193

为此，您必须了解您正在处理的内容。

加载到用户浏览器中的`*.php`页面是经过处理和解析的页面。此解析发生在服务器端，并由服务器上的 PHP 处理器处理。现在，在`*.php`处理文件后，与它的任何交互都会丢失。用户（客户端）唯一看到的是这个处理的结果。因此，要与此页面通信，必须发送信息。

通常，浏览器会发送请求页面的信息。这就是[HTTP](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)协议的工作原理。

由于用户是客户端，他必须按照协议的规则发送相关信息（标头、变量等）。这意味着，用户必须请求页面，并通过此请求发送数据。

AJAX 技术允许您在后台动态打开[HTTP](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)请求，同时页面仍在运行，无需刷新。它根据协议的约定发送相关数据，并允许您触发回调函数来处理来自服务器的答案。

[在这里](https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started)您可以找到初学者教程，它将为您提供必要的信息以帮助您入门。

附言

我强烈建议你不要在一开始就使用常见的外部库，如 jQuery、node.js、Backbone.js 等。这些库是为简化高级开发人员的代码编写而创建的工具。它们可能会使您感到困惑并弄乱您的编程逻辑和学习路径。

祝你好运！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-22T21:27:35.477

听起来您希望新内容出现在页面上，而不会将用户定向到新页面。您可以使用 jQuery 来实现这一点。这是一个简单的例子。

**HTML：**

```
<p>
    <a href="#" id="1">Page 1</a> <a href="#" id="2">Page 2</a> <a href="#" id="3">Page 3</a>
</p>
<div>
    <div id="content1">
        This is page 1.
    </div>
    <div id="content2">
        This is page 2.
    </div>
    <div id="content3">
        This is page 3.
    </div>
</div> 
```

**jQuery：**

```
$('#content2, #content3').hide();

$('a').click(function() {
    var id = $(this).attr('id');
    $('#content' + id).show().siblings().hide();
}); 
```

**现场示例：http:** [//jsfiddle.net/VxZKs/1](http://jsfiddle.net/VxZKs/1)

# javascript - normalizeTypeName 未定义

> ID：16156925
> 
> 赞同：0
> 
> 时间：2013-04-22T21:20:17.673
> 
> 标签：javascript, breeze

我正在尝试将元数据从我的“联系人”对象中取回，以便将元数据映射到“contactdto”对象。在服务器上，我有一个名为 GetContactsMetadata 的 Web API 函数

```
 [HttpGet]
    public IQueryable<Contact> GetContactsMetadata()
    {
        return _contextProvider.Context.Contacts.Take(1);
    } 
```

我确定一旦运行此示例，我将删除 IQueryable 和/或列表。在客户端我有以下

```
 //GetContactsMetadata
        var myJsonResultsAdapter = new breeze.JsonResultsAdapter({
            name: "GetContactsMetadata",
            extractResults: function (json) {
                return json.results;
            },
            visitNode: function (node, parseContext, nodeContext) {
                var entityType = normalizeTypeName(node.$type);
                var propertyName = nodeContext.propertyName;
                var ignore = propertyName && propertyName.substr(0, 1) === "$";

                return {
                    entityType: entityType,
                    nodeId: node.$id,
                    nodeRefId: node.$ref,
                    ignore: ignore
                };
            }
        });
        var dataService = new breeze.DataService({
            serviceName: 'api/contacts',
            jsonResultsAdapter: myJsonResultsAdapter
        });
        var manager = new breeze.EntityManager({ dataService: dataService }); 
```

它在 chrome 中不断出错：“未定义 normalizeTypeName”。我正确调用 JsonResultsAdapter 了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T22:12:41.733

我应该在示例中更清楚。

*normalizeTypeName*方法是您作为开发人员编写的一种方法，它将获取节点上的某些属性并返回 Breeze EntityType 或 Breeze EntityType 名称。如果您确实知道类型名称并且仅将此适配器用于单一类型的查询，则可以执行如下简单的操作：

```
 visitNode: function (node, parseContext, nodeContext) {
     return {
         entityType: "Contact" // or "ContactDTO" depending on what you are calling the type on the client.
     };
 } 
```

# assembly - Intel x86 汇编语法中寄存器上的括号

> ID：16156933
> 
> 赞同：3
> 
> 时间：2013-04-22T21:20:45.503
> 
> 标签：assembly, syntax, x86, nasm, cpu-registers

我坚信我理解 x86 程序集中的括号。在此示例中，寄存器`ax`应包含`X`，因为括号表示 的当前地址`LABEL`。

```
mov ax, [LABEL]

LABEL:
db "X", 0 
```

但我不明白以下两条装配线：

```
mov al, [ebx] 
```

为什么我需要括号？是因为`ebx`是32位寄存器和`ax`16位吗？有什么区别：

```
mov al, ebx 
```

或者这个，我不明白为什么我需要括号......

```
mov [edx], ax 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-22T21:36:24.870

括号表示法用于让您访问寄存器或标签的“指向的值”。

```
mov ax, [LABEL]

LABEL:
db "X", 0 
```

您正在从标记为 的内存中`ax`加载**值**`LABEL`。在这种情况下，您将 'X' (0x58 ASCII) 复制到`ax`寄存器中，同时复制`0`到`ax`. 因此`ax = 0x0058`，与`ah = 0`, `al = 0x58`。

`LABEL`附在“X”所在的地址上。

* * *

这不是一个有效的操作：

```
mov al, ebx 
```

和这个：

```
mov [edx], ax 
```

您正在将值移动`ax`到“指向的值”的前两个字节中`edx`，因为`ax`它是一个 16 位寄存器，并且`edx`只是保存应该写入的内存地址。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-05T07:43:55.300

如果我们使用括号中的 32 位寄存器“EDX”作为地址寄存器，那么 EDX 内部的值将用作指向 ram 位置的地址。从这个位置开始，我们可以读取或写入一个字节、两个字节或四个字节。

写一个字节、两个字节和四个字节的例子：

```
location DB ?, ?, ?, ?
mov edx, offset location
mov eax, 04030201h 
```

写一个字节：

```
mov [edx], al
result:
location DB 01, ?, ?, ? 
```

写另一个字节：

```
mov [edx], ah
result:
location DB 02, ?, ?, ? 
```

写两个字节：

```
mov [edx], ax
result:
location DB 01, 02, ?, ? 
```

写入四个字节：

```
mov [edx], eax
result:
location DB 01, 02, 03, 04 
```

短剑

# bash - 保存分隔符之间的内容并进行比较

> ID：16156934
> 
> 赞同：0
> 
> 时间：2013-04-22T21:20:47.050
> 
> 标签：bash, shell, comparison

我很难提取之间分隔的内容`'[ ]'`并使用shell脚本进行比较。之后我需要用`[]`.

我收到了文件名内容 som`[xxxx]`模式的文件，其中一个很有用，我用它来对它们进行分类。

一个例子：

```
Input: sample[t.225][lb.445][21042013][0913605].extension
Output (pattern lb.445): sample[lb.445].extension 
```

我知道我可以在模式中使用 grep，但之后我不知道如何删除文件名中的其他字段。我认为使用 grep 的策略不是最好的选择，并且在 shell 脚本和模式比较中使用循环的选项听起来很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:38:50.137

awk 在这种情况下可能会有所帮助：

```
awk -F'[][]' '{print $1"["$4"]"$NF}' input 
```

上面的行从第二个`[...]`块中获取文本

以您的问题为例：

```
kent$  echo "sample[t.225][lb.445][21042013][0913605].extension"|awk -F'[][]' '{print $1"["$4"]"$NF}'                                                                       
sample[lb.445].extension 
```

# javascript - CSS/ Javascript - 使用 css3 或 javascript 复制图像样式（贴纸样式）

> ID：16156939
> 
> 赞同：2
> 
> 时间：2013-04-22T21:21:07.203
> 
> 标签：javascript, jquery, css

嗨，有没有人可以给我一些关于如何将你看到的图像复制成纯 css 字体+样式的建议？

![在此处输入图像描述](https://i.stack.imgur.com/JvUfQ.png)

我试过这个：[JSFIDDLE](http://jsfiddle.net/sdk2S/5/) **css**

```
 *{
        font-family: 'Asap', sans-serif;
        font-size:130px;
        color:#444;
        font-weight:bold;
        letter-spacing:-3px;
    }
    body{
        background:url('http://img.ly/system/uploads/007/221/887/large_antani.png') no-repeat left 190px ;
    }
    img{
        width:auto;
        height:auto;
    }
    a{

        text-shadow:
           3px 3px 0 #fff,
         -1px -1px 0 #fff,  
          1px -1px 0 #fff,
          -1px 1px 0 #fff,
           1px 1px 0 #fff,
            0px 2px 2px #ccc, 0px 4px 4px #ccc,0px 6px 6px #ccc;
    } 
```

**html**

```
<a>asd</a> 
```

任何建议appriciated。

如果您还认为无法复制，请告诉我，因为如果不可能，我会在上面浪费时间，我将使用 image 而不是 pure `css`。注意：对于文本渐变颜色，我知道 css 是不可能的，所以我打算使用这样的东西：[https ://github.com/mrnix/pxgradient](https://github.com/mrnix/pxgradient)

但对我来说最大的问题是使文本阴影出现在图像中谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:26:17.957

我将您的文本阴影更改为：

```
text-shadow: 0 0 0 20px white, 4px 4px 4px 20px #ccc; 
```

它只适用于支持文本阴影传播的浏览器（据我所知，它只是 IE10），但它更接近图像中的效果。

不幸的是，文本颜色不可能从浅蓝色渐变到略深的蓝色，因此您必须选择最适合您的纯色。

当然，对于跨浏览器兼容的解决方案，图像是您最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:42:31.680

我个人认为在这种情况下你应该选择一张图片。对于这样一个简单的 png 来说，绝对不值得 imo 努力，而且您将拥有最好的跨浏览器支持。而且我也相信，当涉及到标志时，你需要完全的跨浏览器兼容性。它定义了您的品牌以及人们识别您的方式，因此不应允许任何变化。

如果您坚持“编码”您的徽标，我认为您应该选择 svg 以获得最接近的匹配。我可能会在 Illustrator 中复制徽标（如果您还没有它）并从那里将其保存为 svg。将它集成到网页中应该很容易......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T22:00:59.717

[这是该图像最接近的复制品。](http://jsfiddle.net/fVwmG/)

`-webkit-background-clip: transparent;`在对文本进行渐变效果的同时，也需要复制锚点来剪除阴影。是的，这不是跨浏览器兼容的。

HTML：

```
<div class="replica">
    <a class="link">asd</a>
    <a class="shadow">asd</a>
</div> 
```

CSS：

```
.replica {
    position: relative;
}
a {
    font-style:italic;
    background: -webkit-gradient(linear, left top, left bottom, from(#99FFFF), to(#0DC4F3));
    -webkit-text-fill-color: transparent;
    -webkit-background-clip: text;
}
a.link {
    position: absolute;
    left:0;
    top:-2px;
    background: -webkit-gradient(linear, left top, left bottom, from(#99FFFF), to(#0DC4F3));
    -webkit-text-fill-color: transparent;
    -webkit-background-clip: text;
}
a.shadow {
    text-shadow: 3px 3px 0 #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff, 0px 2px 2px #ccc, 0px 4px 4px #ccc, 0px 6px 6px #ccc;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-22T22:52:34.757

如果你想变得疯狂并且可能减慢一切，你可以使用 jquery 为每个角度制作文本阴影。

按照这个[小提琴](http://jsfiddle.net/sdk2S/91/)试试

我只是做了一些 jquery 来为每个特定角度制作阴影......它很慢，我敢肯定更多元素会更糟......但它就在那里。

```
function stroke(thisEle) {
    var spread = 10; // how far you want the stroke to be
    var shadows = []; //Start an array for every textshadow
    for(var i = 0; i <= 361; i++){ //For every angle
        var angle = i;
        var pointX = spread*(Math.sin(angle)); //find the direction 
        var pointY = spread*(Math.cos(angle)); //of the text shadow
        if(i == 361){ //Give one last text shadow that is black underneath
            var shadow = '20px 20px 20px black'; 
        } else {
            var shadow = pointX + 'px ' + pointY + 'px 0 white';
        }
        shadows.push(shadow); //Add this shadow to the array
    }

    thisEle.css({
        textShadow: shadows //show all shadows (SLOW)
    });
}

$('a').each(function(){ //for each - do everything above
    var thisEle = $(this);
    stroke(thisEle);  
}); 
```

然后，要进行渐变，只需按照本教程操作：[http](http://css-tricks.com/snippets/css/gradient-text/) ://css-tricks.com/snippets/css/gradient-text/（仅限 CSS3 和 WEBKIT）

否则，尝试这样的事情：[http ://webdesignerwall.com/tutorials/css-gradient-text-effect](http://webdesignerwall.com/tutorials/css-gradient-text-effect)

# objective-c - 为什么在 iOS 中为 NSArrays 使用 @property

> ID：16156943
> 
> 赞同：0
> 
> 时间：2013-04-22T21:21:10.860
> 
> 标签：objective-c, properties

为什么要使用`@property`with `NSArray`？

我提出问题的原因是因为我的印象`@properties`是主要用于利用您在使用时免费获得的**getter**和**setter**`@property`，但是当您将 an 分配`NSArray`给一个属性时，您知道您永远不会使用 getter 和 setter要访问数组中的对象，为什么要在这种情况下使用属性。这是否与**ARC**有关，换句话说，这是否被认为是一种更好的内存管理实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:24:09.763

您使用属性来获取或设置整个数组。您还可以使用该属性来访问数组的各个元素。

将属性与数组一起使用与 ARC 或 MRC 无关。属性是封装数据的一种方式。而已。

如果您不想提供对整个数组的访问权限，请不要使用属性。如果合适，添加方法来设置/获取内部数组的各个元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T21:30:22.847

除了其他答案已经说过的话，`copy`出于安全目的，我通常喜欢我的阵列。

如果您接受`NSArray`客户的请求，她可能会为您提供一个`NSMutableArray`实例。如果是这种情况，并且您想确保您正在使用的数组不会意外更改，那么您最好`copy`使用它而不是`retain`它。

在这种情况下，属性会派上用场，因为您可以声明

```
@property (nonatomic, copy) NSArray * myArray; 
```

并确保在分配后您是该数组的唯一所有者。

每当我关心数据的所有权时，我通常会将此策略用于具有可变子类的任何类，例如 、 等`NSString`。`NSArray``NSSet`

这种策略的缺点当然是内存效率，但归根结底，工程是智能妥协的艺术。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-22T21:23:42.070

在单个方法或类之外使用数组。ClassA.array = ClassB.array; 或者简单地以同一类的不同方法从数组中读取，因为数组将在执行后立即释放。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-22T21:51:48.450

> 但是当您将 NSArray 分配给一个属性时，您知道您永远不会使用 getter 和 setter 来访问数组中的对象，为什么在这种情况下使用属性。

出于与其他对象使用属性相同的原因：

*   **访问器：**访问器用于数组本身，而不是数组中的对象。一次获取或设置整个数组并不少见：

    ```
    NSArray *kids = frank.children; // 获取数组
    玛丽.children = @[@“尼克”，@“山姆”，@“苏珊”]；// 设置数组
    ```

*   **抽象：**使用属性而不是直接访问底层数组可以更容易地在以后更改实现，如果有必要的话。

*   **KVC 合规性：**您可以通过属性免费获得它。借助数组之类的集合，KVC 为您提供了强大的功能。您可以使用集合运算符`@avg`和 @`max`以及索引访问器：

    ```
    int employees = [会计 countOfEmployees]; // 与 [accounting.employees count] 相同
    员工 *thirdEmployee = [工程对象InEmployeesAtIndex:2]; // 与 [engineering.employees objectAtIndex:2] 相同
    ```

# java - 为什么锁会迫使您等到您真正拥有锁？

> ID：16156944
> 
> 赞同：2
> 
> 时间：2013-04-22T21:21:15.137
> 
> 标签：java, locking, reentrantreadwritelock

在 Java 的实现锁中，没有办法将锁从读锁自动升级为写锁。例如，以下代码片段失败

```
ReentrantReadWriteLock lock = new ...

lock.readLock().lock();

boolean mustWrite = false;
// do somestuff and determine you must instead write! :-O
if(mustWrite) {
    lock.writeLock().lock();
    writeSomeStuff();
    lock.writeLock().unlock();
}
lock.readLock.unlock(); 
```

写锁获取必须等待所有读锁完成，以便它知道它没有覆盖读者可能正在读取的数据。那很糟。所以解决方法是做这样的事情：

```
if(mustWrite) {
    lock.readLock().unlock(); // let go of read before writing
    lock.writeLock().lock();
    writeSomeStuff();
    lock.writeLock().unlock();
    lock.readLock().lock(); // get back to reading
} 
```

但这并不理想 - 当您解锁读取和拿起写入时，有人可能会去做一些事情。现在，无论如何仔细检查这些条件可能是一个好主意，但仍然 - 它很难看。

现在通常，当您获得锁时，您希望强制代码等待它实际获得，然后再执行您正在做的事情。您不想只相信您的锁定机制，它会在您开始弄乱数据之前为您提供锁定。

但是为什么它会强迫你从你发出想要锁的信号到你真正读到等待时停止执行呢？例如，为什么它不能允许这样的事情：

```
lock.writeLock().notifyIntentToLock(); // puts you in line to get the write lock
                                       // everyone else will block until you both
                                       // acquire and release the lock
lock.readLock().unlock(); // proceed with the unlock so you don't deadlock
lock.writeLock().makeGoodOnIntentToLock(); // actually acquire that lock 
```

所以从某种意义上说，当前的锁功能可以被理论化为它们都是同时完成的，比如

```
public void lock() {
    this.notifyIntentToLock();
    this.makeGoodOnIntentToLock();
} 
```

什么样的设计决策会让他们不允许某种延迟的意图锁定？像我根本没有看到的那样的锁设计是否存在严重问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-26T20:45:47.147

在决定采用独占锁之后，您所要做的就是：

*   离开读锁，
*   获取写锁和
*   **再次检查条件**
*   根据结果​​，要么继续，要么退出。

至于取写锁的意图，当多个并发意图存在时会发生什么？可能他们所有人都必须检查初始条件，因为无法确定谁会成为受害者（在获胜者之后授予锁定）。

还有更多 - impl。RW 锁的启动很糟糕，因为读取会修改导致一致性流量的元数据 - 因此 RW 锁不能很好地扩展。

# javascript - 如何将 Stripe 放入主干视图？

> ID：16156946
> 
> 赞同：1
> 
> 时间：2013-04-22T21:21:16.610
> 
> 标签：javascript, backbone.js, stripe-payments

这是通过 Stripe.js 提交信用卡表单的通用代码。我需要将其放入我粘贴在下面的 Backbone 视图中：

```
// Add Submit Btn Event Listener and Stripe Token Generator from fields
    jQuery(function($) {
      $('#payment-form').submit(function(event) {
            event.preventDefault();
            var $form = $(this);
            // Disable the submit button to prevent repeated clicks
            $form.find('button').prop('disabled', true);
            Stripe.createToken($form, stripeResponseHandler);
            // Prevent the form from submitting with the default action
            return false;
      });
    }); // End jQuery random function
    var stripeResponseHandler = function(status, response) {
    var $form = $('#payment-form');
        if (response.error) {
            // Show the errors on the form
            $form.find('.payment-errors').text(response.error.message);
            $form.find('button').prop('disabled', false);
        } else {
            // token contains id, last4, and card type
            var token = response.id;
            // Insert the token into the form so it gets submitted to the server
            $form.append($('<input type="hidden" name="stripeToken" />').val(token));
            // and submit
            $form.get(0).submit();
        }
    }; // End stripeResponseHandler 
```

**我尝试将其装入主干视图（不起作用）：**

```
WhiteDeals.Views.ProgramPayment = Backbone.View.extend({

initialize: function() {
    _.bindAll(this);
}, 

events: {
    "submit form#payment-form":  "createStripeToken"
},

createStripeToken: function(event) {
    event.preventDefault();
    var $form = $(this);
    // Disable the submit button to prevent repeated clicks
    $form.find('button').prop('disabled', true);
    Stripe.createToken($form, stripeResponseHandler);
    // Prevent the form from submitting with the default action
    return false;
},  // createStripeToken

stripeResponseHandler: function(status,response) {
    var $form = $('#payment-form');
    if (response.error) {
        // Show the errors on the form
        $form.find('.payment-errors').text(response.error.message);
        $form.find('button').prop('disabled', false);
    } else {
        // token contains id, last4, and card type
        var token = response.id;
        // Insert the token into the form so it gets submitted to the server
        $form.append($('<input type="hidden" name="stripeToken" />').val(token));
        // and submit
        $form.get(0).submit();
    }
}, 

render: function () {
    var dealProgram = this.model.toJSON()
    this.$el.html(JST['program/payment']({ dealProgram: this.model.toJSON() }));
    // Show Payment Modal
    $('#payment-modal').modal({
      show: true,
      keyboard: true,
      backdrop: true
    })
    return this;
} 
```

});

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T22:03:31.283

上下文将不一样。当您将侦听器与`events`视图中的对象绑定时，上下文将自动绑定到视图本身。
改变：

```
var $form = $(this); 
```

至

```
var $form = this.$('#payment-form'); 
```

# c# - 如何迭代Excel工作表仅从特定列中提取数据

> ID：16156951
> 
> 赞同：7
> 
> 时间：2013-04-22T21:21:43.767
> 
> 标签：c#, excel, .net-4.0, excel-interop

您如何遍历具有多个工作表的 Excel 工作簿，仅从“C”、“E”和“F”列中提取数据？

这是我到目前为止的代码：

```
public static string ExtractData(string filePath)
    {
        Excel.Application excelApp = new Excel.Application();
        Excel.Workbook workBook = excelApp.Workbooks.Open(filePath);

        string data = string.Empty;

        int i = 0;
        foreach (Excel.Worksheet sheet in workBook.Worksheets)
        {
            data += "*******   Sheet " + i++.ToString() + "   ********\n";

            //foreach (Excel.Range row in sheet.UsedRange.Rows)
            //{
            //    data += row.Range["C"].Value.ToString();
            //}

            foreach (Excel.Range row in sheet.UsedRange.Rows)
            {
                foreach (Excel.Range cell in row.Columns)
                {
                    data += cell.Value + "   ";
                }
                data += "\n";
            }
        }

        excelApp.Quit();

        return data;
    } 
```

非常感谢您的时间，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-24T14:08:44.023

编辑你的方法，这里应该做你正在寻找的东西：

```
public static string ExtractData(string filePath)
{
    Excel.Application excelApp = new Excel.Application();
    Excel.Workbook workBook = excelApp.Workbooks.Open(filePath);
    int[] Cols = { 3, 5, 6 }; //Columns to loop
                 //C, E, F
    string data = string.Empty;

    int i = 0;
    foreach (Excel.Worksheet sheet in workBook.Worksheets)
    {
        data += "*******   Sheet " + i++.ToString() + "   ********\n";

        foreach (Excel.Range row in sheet.UsedRange.Rows)
        {
            foreach (int c in Cols) //changed here to loop through columns
            {
                data += sheet.Cells[row.Row, c].Value2.ToString() + "   ";
            }
            data += "\n";
        }
    }

    excelApp.Quit();

    return data;
} 
```

我创建了一个 int 数组来指示您想读取哪些列，然后在每一行上我们只是循环遍历数组。

HTH，Z

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T22:58:39.017

您可以使用类似这样的方法来获取 C 列，例如：

```
var numberOfRows = sheet.UsedRange.Columns[3, Type.Missing].Rows.Count;
var values = sheet.Range["C1:C" + numberOfRows].Value2; 
```

numberOfRows 保存工作表中的行数（我认为它不会跳过顶部的空白行，不确定）。之后，您选择从 C1 到 CN 的范围并获取包含这些值的 Value2。请注意，值数组实际上是一个二维数组。您现在可以轻松地执行 for 循环来获取项目：

```
for (int i = 1; i <= values.Length; i++){
   sb.Append(values[i, 1] + " ");
} 
```

这可以在列彼此相邻的情况下进行优化，但是上面的代码应该可以帮助您入门。

# c# - 如何通过进程 ID 而不是窗口句柄向特定进程发送消息？

> ID：16156954
> 
> 赞同：6
> 
> 时间：2013-04-22T21:21:55.903
> 
> 标签：c#, .net, sendmessage, inter-process-communicat

为了解决 GenerateConsoleCtrlEvent 的限制，我必须创建一个中间“中间人”进程来处理启动一些控制台应用程序。该进程的主要目的是在其自身上调用 GenerateConsoleCtrlEvent，导致自身和所有子进程干净地关闭以响应 ctrl+break 信号（而不是使用 Process.Kill）。这种需求源于 GenerateConsoelCtrlEvent 基本上没有效果，除非进程组 id 为零，这意味着它只对调用进程组本身有效。请参阅：[https ://stackoverflow.com/a/2431295/88409](https://stackoverflow.com/a/2431295/88409)

所以无论如何......我已经创建了这个中间进程，它启动了一个线程，该线程在处理特定用户定义消息的表单上调用 Application.Run。

我的问题是......如何向这个进程发送消息来控制它？

我有 Process 对象及其进程 ID，仅此而已。Process.MainWindowHandle 为零。

所以我需要一种向特定进程发送消息或将消息广播到特定进程中的所有窗口的方法。

FindWindow 不是一个选项，因为它试图在任何进程上通过名称和类来识别窗口，这是不可靠的。我想毫无歧义地向特定进程发送消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-22T22:16:40.510

在 3 种情况下，可以将消息*视为*已发送或发布到进程：

1.  我可以将 [window] 消息“发送”或“发布”到特定进程，方法是将其发送到该进程中的第一个枚举窗口
2.  我可以通过将 [thread] 消息发布到进程中的第一个枚举线程来将其“发布”到特定进程。
3.  我可以通过将 [thread] 消息“发布”到特定进程，方法是将其发布到拥有该进程的第一个枚举窗口的线程。

方法 1 可能过于具体，因为它针对的是一个具体但任意的窗口。方法 2 可能不够具体，因为第一个枚举线程是任意的并且可能没有消息循环。方法 3 是一种混合方法，它首先标识一个窗口，然后将线程消息发布到该窗口的线程，因此它不是针对特定窗口（即它是“线程消息”），而是针对一个线程可能有一个消息循环，因为线程至少拥有一个窗口。

以下是支持所有三种方法以及“send”和“post”两种方法的实现。方法 1 包含在下面的方法 SendMessage 和 PostMessage 中。方法 2 和 3 包含在下面的 PostThreadMessage 方法中，具体取决于您是否设置了可选参数`ensureTargetThreadHasWindow`（true = 方法 3，false = 方法 2）。

```
public static class ProcessExtensions
{
    private static class Win32
    {
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        public static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam);

        [return: MarshalAs(UnmanagedType.Bool)]
        [DllImport("user32.dll", SetLastError = true)]
        public static extern bool PostMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

        [return: MarshalAs(UnmanagedType.Bool)]
        [DllImport("user32.dll", SetLastError = true)]
        public static extern bool PostThreadMessage(uint threadId, uint msg, IntPtr wParam, IntPtr lParam);

        public delegate bool EnumThreadDelegate (IntPtr hWnd, IntPtr lParam);
        [DllImport("user32.dll")]
        public static extern bool EnumThreadWindows(uint dwThreadId, EnumThreadDelegate lpfn, IntPtr lParam);

        [DllImport("user32.dll", SetLastError=true)]
        public static extern uint GetWindowThreadProcessId(IntPtr hWnd, out uint lpdwProcessId);
    }

    //Sends a message to the first enumerated window in the first enumerated thread with at least one window, and returns the handle of that window through the hwnd output parameter if such a window was enumerated.  If a window was enumerated, the return value is the return value of the SendMessage call, otherwise the return value is zero.
    public static IntPtr SendMessage( this Process p, out IntPtr hwnd, UInt32 msg, IntPtr wParam, IntPtr lParam )
    {
        hwnd = p.WindowHandles().FirstOrDefault();
        if (hwnd != IntPtr.Zero)
            return Win32.SendMessage( hwnd, msg, wParam, lParam );
        else
            return IntPtr.Zero;
    }

    //Posts a message to the first enumerated window in the first enumerated thread with at least one window, and returns the handle of that window through the hwnd output parameter if such a window was enumerated.  If a window was enumerated, the return value is the return value of the PostMessage call, otherwise the return value is false.
    public static bool PostMessage( this Process p, out IntPtr hwnd, UInt32 msg, IntPtr wParam, IntPtr lParam )
    {
        hwnd = p.WindowHandles().FirstOrDefault();
        if (hwnd != IntPtr.Zero)
            return Win32.PostMessage( hwnd, msg, wParam, lParam );
        else
            return false;
    }

    //Posts a thread message to the first enumerated thread (when ensureTargetThreadHasWindow is false), or posts a thread message to the first enumerated thread with a window, unless no windows are found in which case the call fails.  If an appropriate thread was found, the return value is the return value of PostThreadMessage call, otherwise the return value is false.
    public static bool PostThreadMessage( this Process p, UInt32 msg, IntPtr wParam, IntPtr lParam, bool ensureTargetThreadHasWindow = true )
    {
        uint targetThreadId = 0;
        if (ensureTargetThreadHasWindow)
        {
            IntPtr hwnd = p.WindowHandles().FirstOrDefault();
            uint processId = 0;
            if (hwnd != IntPtr.Zero)
                targetThreadId = Win32.GetWindowThreadProcessId( hwnd, out processId );
        }
        else
        {
            targetThreadId = (uint)p.Threads[0].Id;
        }
        if (targetThreadId != 0)
            return Win32.PostThreadMessage( targetThreadId, msg, wParam, lParam );
        else
            return false;
    }

    public static IEnumerable<IntPtr> WindowHandles( this Process process )
    {
        var handles = new List<IntPtr>();
        foreach (ProcessThread thread in process.Threads)
            Win32.EnumThreadWindows( (uint)thread.Id, (hWnd, lParam) => { handles.Add(hWnd); return true; }, IntPtr.Zero );
        return handles;
    }
} 
```

要在 Process 对象上使用此扩展方法：

```
Process process = Process.Start( exePath, args );
IntPtr hwndMessageWasSentTo = IntPtr.Zero; //this will receive a non-zero value if SendMessage was called successfully
uint msg = 0xC000; //The message you want to send
IntPtr wParam = IntPtr.Zero; //The wParam value to pass to SendMessage
IntPtr lParam = IntPtr.Zero; //The lParam value to pass to SendMessage

IntPtr returnValue = process.SendMessage( out hwndMessageWasSentTo, msg, wParam, lParam );
if (hwndMessageWasSentTo != IntPtr.Zero)
   Console.WriteLine( "Message successfully sent to hwnd: " + hwndMessageWasSentTo.ToString() + " and return value was: " + returnValue.ToString() );
else
   Console.WriteLine( "No windows found in process.  SendMessage was not called." ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T21:31:44.170

您不能向进程发送或发布消息，但可以向线程发布消息。当然，该线程必须启动一个消息循环来处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T21:29:28.833

使用[EnumWindows](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633497%28v=vs.85%29.aspx)扫描顶级窗口，并使用[GetProcessHandleFromHWnd](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318087%28v=vs.85%29.aspx)确定窗口是否在您的目标进程中。

然后，您可以向该 hwnd 发送消息，并且它们应该被您的目标进程接收（如果您的目标进程具有消息循环）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-05T01:35:02.300

[我刚刚在这里](https://stackoverflow.com/a/61603909/420400)回答了一个非常相似的问题（带有示例代码）。快速的答案是`PostThreadMessage()`。

# objective-c - UIButton 按下触发方法动作

> ID：16156959
> 
> 赞同：1
> 
> 时间：2013-04-22T21:22:04.690
> 
> 标签：objective-c, methods, uibutton

我有 PhotoView 类（UIButton 的子类），我希望当我按下 PhotoView 类的任何按钮时，应该触发相同的操作。

我试过类似的东西：

```
- (void)didSelectButton:(PhotoView *)sender
{
    // do something
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:34:41.230

在视图控制器的 viewDidLoad 方法中，您可以迭代视图子视图（以及它们自己的子视图，递归样式），以便找到 PhotoView 类的实例并在这些实例上使用 addTarget。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:28:38.157

在您的`PhotoView` `init...`方法中，设置`self`为自己的目标：

```
[self addTarget:self selector:@selector(didSelectButton:) forControlEvents: UIControlEventTouchUpInside]; 
```

请注意，这是一个糟糕的设计。你`PhotoView`应该是一个`UIView`包含一个`UIButton`.

# javascript - 使用 JS 查询 JSON（使用未知父级）

> ID：16156961
> 
> 赞同：0
> 
> 时间：2013-04-22T21:22:07.977
> 
> 标签：javascript, json

让我们说我们有一个看起来像这样的对象。

```
 // first name - of employee 3
    company.employees.employeeId[3].first

    // last name - of employee 3
    company.employees.employeeId[3].last

    // department - of employee 3
    company.employees.employeeId[3].department 
```

有没有办法/图书馆做这样的查询

```
 // looking for all employees in department Z
    result = company.employees.[*].department['accounting'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T21:24:00.033

你可以[`.filter()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)：

```
var result = company.employees.employeeID.filter(function(employee) {
    return employee.department === 'accounting';
}); 
```

# java - JAVA中的原子操作

> ID：16156965
> 
> 赞同：-2
> 
> 时间：2013-04-22T21:22:31.833
> 
> 标签：java

我知道为什么要在 Java 中使用同步，但我找不到这个问题的答案：

```
do I need to synchronized an atomic operation? 
```

如果是，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:28:30.860

如果它真的是原子的，那么不是。

您需要同步来提供一致的状态。根据原子的定义，任何原子操作都会导致一致的状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T21:51:47.087

Java 中很少有真正的原子操作。来自[原子访问](http://docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html)Java 教程：

*   `long`对于引用变量和大多数原始变量（除and之外的所有类型）而言，读取和写入都是原子的`double`。
*   `volatile`对于声明的所有变量（*包括* `long`和`double`变量），读取和写入都是原子的。

请注意，同步不仅用于互斥，而且对于线程之间的可靠通信也是必需的。即使您正在处理原子可读和可写的数据，也无法保证一个线程何时会看到另一个线程所做的更改。出于这个原因，您需要同步对共享数据的访问，或者确保已声明共享变量`volatile`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-22T21:32:45.130

您需要确保您的原子操作不会扩展到多个读取和更新操作。像递增和递减操作这样的简单表达式确实会扩展为多个动作，因此 i++ 和 i--**不是**原子操作。因此，大多数情况下，如果您从多个线程读取和更新变量，那么您最好使用同步方法。

更多详细信息： http: [//docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html)

# java - 将 InputStream 转换为 byte[] 的最有效方法？

> ID：16156970
> 
> 赞同：12
> 
> 时间：2013-04-22T21:22:39.557
> 
> 标签：java, inputstream

```
ChannelBufferInputStream responseStream = (ChannelBufferInputStream) response.getBodyAsStream();
ArrayList<Byte> arrayList = new ArrayList<Byte>();
try {
    while (responseStream.available() > 0) {
        arrayList.add(responseStream.readByte());
    }
} catch (IOException e) {
    e.printStackTrace();
    return internalServerError();
}
Iterator<Byte> iterator = arrayList.iterator();
byte[] bytes = new byte[arrayList.size()];
int i = 0;
while (iterator.hasNext()) {
    bytes[i++] = iterator.next();
} 
```

在我的网络应用程序的每个页面加载时都会调用此代码。它似乎运行得很快，但是有什么可以使它运行得更快吗？

编辑 - 使用字节数组输出流更新

```
ChannelBufferInputStream responseStream = (ChannelBufferInputStream) response.getBodyAsStream();
ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
try {
    int read = responseStream.read();
    while (read != -1) {
        byteArrayOutputStream.write(read);
        read = responseStream.read();
    }
} catch (IOException e) {
    e.printStackTrace();
    return internalServerError();
}
byte[] bytes = byteArrayOutputStream.toByteArray();
return ok(bytes).as(response.getHeader("Content-type")); 
```

编辑 - 基准测试代码

```
ChannelBufferInputStream responseStream = (ChannelBufferInputStream) response.getBodyAsStream();
long t1 = System.nanoTime();

ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
try {
    int read = responseStream.read();
    while (read != -1) {
        byteArrayOutputStream.write(read);
        read = responseStream.read();
    }
} catch (IOException e) {
    e.printStackTrace();
    return internalServerError();
}
byte[] bytes = byteArrayOutputStream.toByteArray();

long t2 = System.nanoTime();
System.out.println(t2-t1);
return ok(bytes).as(response.getHeader("Content-type")); 
```

100+ 次请求后的平均时间 - 46873

```
ChannelBufferInputStream responseStream = (ChannelBufferInputStream) response.getBodyAsStream();
long t1 = System.nanoTime();

ArrayList<Byte> arrayList = new ArrayList<Byte>();
try {
    while (responseStream.available() > 0) {
        arrayList.add(responseStream.readByte());
    }
} catch (IOException e) {
    e.printStackTrace();
    return internalServerError();
}
Iterator<Byte> iterator = arrayList.iterator();
byte[] bytes = new byte[arrayList.size()];
int i = 0;
while (iterator.hasNext()) {
    bytes[i++] = iterator.next();
}

long t2 = System.nanoTime();
System.out.println(t2-t1);
return ok(bytes).as(response.getHeader("Content-type")); 
```

100+ 次请求后的平均时间 - 522848

```
long t1 = System.nanoTime();
byte[] bytes;
try {
    bytes = org.apache.commons.io.IOUtils.toByteArray(responseStream);
} catch (Exception e) {
    return internalServerError();
}

long t2 = System.nanoTime();
System.out.println(t2-t1); 
```

100+ 次请求后的平均时间 - 45088

```
long t1 = System.nanoTime();
byte[] bytes;
try {
    bytes = sun.misc.IOUtils.readFully(responseStream, -1, true);
} catch (Exception e) {
    return internalServerError();
}

long t2 = System.nanoTime();
System.out.println(t2 - t1); 
```

100+ 次请求后的平均时间 - 20180

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-22T21:30:37.997

是的。使用 a`ByteArrayOutputStream`而不是 ArrayList。然后从 InputStream 中读取字节块（不使用`available()`，这几乎总是不应该使用）并将这些块写入 ByteArrayOutputStream，直到该`read()`方法返回 -1。然后在你的`ByteArrayOutputStream`.

您可以使用 Guava 的[`ByteStreams.toByteArray()`](https://google.github.io/guava/releases/snapshot-jre/api/docs/com/google/common/io/ByteStreams.html#toByteArray-java.io.InputStream-)方法，它为您完成所有这些工作，或者您可以阅读它的源代码以更好地了解它是如何做到的。阅读[IO 教程](http://docs.oracle.com/javase/tutorial/essential/io/bytestreams.html)也可能有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-22T21:47:18.060

[Apache Commons IO IOUtils.toByteArray](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html#toByteArray%28java.io.InputStream%29)方法有什么问题？为此目的已经优化了很多年。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:42:56.843

为什么？这段代码完全等效，`read(byte[])`只是它对整个数据做了两个额外的复制步骤。你不需要这些。一个简单`read(byte[])`的速度会快几倍。

的使用`available()`也是无效的。您需要整个响应，而不仅仅是可以在没有阻塞的情况下读取的部分。你需要循环。

# javascript - 遍历表单中除一个以外的所有元素

> ID：16156973
> 
> 赞同：0
> 
> 时间：2013-04-22T21:22:50.270
> 
> 标签：javascript, forms

我希望我`while`能遍历表单中除一个元素之外的所有元素。这是我的代码：

```
while (i < elnum && !empty) {
        if (form.elements[i].value == "" && form.elements[i] != form.referral) {
            error.innerHTML += 'All fields are required.</br>';
            empty = true;
        }
        i++;
    } 
```

`elnum`元素的数量在哪里。

不幸的是，即使我只`form.referral`留空，它仍然会进入`if`. 基本上，我希望对除该字段之外的所有字段进行检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T21:29:51.820

与其尝试比较元素，不如尝试以下方法：

```
if( form.elements[i].name == "referral") continue; 
```

将它放在循环中，在检查空值的条件之前。

话虽这么说，做这样的事情可能会更好：

```
while(i < elnum) {
    if( form.elements[i].hasAttribute("required") && form.elements[i].value == "") {
        error.innerHTML += "All fields are required.<br />";
        // re-add `empty=true` if the variable is needed elsewhere
        // if it's only used to end the loop, then this is better:
        break;
    }
    i++;
} 
```

并确保将`required`属性添加到所有必填字段。这是一个更好的解决方案，因为这样它将利用浏览器的原生能力来处理 HTML5 表单（如果有的话）。

# java - 在模拟器中拍照后相机崩溃

> ID：16156975
> 
> 赞同：0
> 
> 时间：2013-04-22T21:23:02.390
> 
> 标签：java, android, android-emulator, android-camera

我正在开发一个应用程序，通过`Intent`. 我一直在研究记事本演示的代码。当我拍照并确认时会出现问题。应用程序崩溃并且 logcat 给了我这个：

```
04-10 20:18:29.896: D/gralloc_goldfish(6154): Emulator without GPU emulation detected.
04-10 20:18:35.897: I/Choreographer(6154): Skipped 282 frames!  The application may be doing too much work on its main thread.
04-10 20:18:42.977: W/IInputConnectionWrapper(6154): showStatusIcon on inactive InputConnection
04-10 20:18:44.007: I/Choreographer(6154): Skipped 344 frames!  The application may be doing too much work on its main thread.
04-10 20:18:45.456: D/AndroidRuntime(6154): Shutting down VM
04-10 20:18:45.456: W/dalvikvm(6154): threadid=1: thread exiting with uncaught exception (group=0x40a71930)
04-10 20:18:45.516: E/AndroidRuntime(6154): FATAL EXCEPTION: main
04-10 20:18:45.516: E/AndroidRuntime(6154): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=100, result=-1, data=null} to activity {com.android.demo.notepad3/com.android.demo.notepad3.Notepadv3}: java.lang.NullPointerException
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3319)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:3362)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.ActivityThread.access$1100(ActivityThread.java:141)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1282)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.os.Looper.loop(Looper.java:137)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at java.lang.reflect.Method.invokeNative(Native Method)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at java.lang.reflect.Method.invoke(Method.java:511)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at dalvik.system.NativeStart.main(Native Method)
04-10 20:18:45.516: E/AndroidRuntime(6154): Caused by: java.lang.NullPointerException
04-10 20:18:45.516: E/AndroidRuntime(6154):     at com.android.demo.notepad3.Notepadv3.onActivityResult(Notepadv3.java:205)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.Activity.dispatchActivityResult(Activity.java:5293)
04-10 20:18:45.516: E/AndroidRuntime(6154):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3315)
04-10 20:18:45.516: E/AndroidRuntime(6154):     ... 11 more 
```

我现在唯一的线索是它与我的`onActivityResult`配置方式或我将代码保存图像文件的位置有关。现在我在一项活动中拥有所有这些：

```
public void takePhoto (View view) {
    // create Intent to take a picture and return control to the calling application
    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

    fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE); // create a file to save the image
    intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri); // set the image file name

    // start the image capture Intent
    startActivityForResult(intent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);

}

private static File getOutputMediaFile(int type){
    // To be safe, you should check that the SDCard is mounted
    // using Environment.getExternalStorageState() before doing this.

    File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
              Environment.DIRECTORY_PICTURES), "Notepadv3");
    // This location works best if you want the created images to be shared
    // between applications and persist after your app has been uninstalled.

    // Create the storage directory if it does not exist
    if (! mediaStorageDir.exists()){
        if (! mediaStorageDir.mkdirs()){
            Log.d("Notepadv3", "failed to create directory");
            return null;
        }
    }

    String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date(type));
    File mediaFile;
    if (type == MEDIA_TYPE_IMAGE){
        mediaFile = new File(mediaStorageDir.getPath() + File.separator +
        "IMG_"+ timeStamp + ".jpg");
    } else if(type == MEDIA_TYPE_VIDEO) {
        mediaFile = new File(mediaStorageDir.getPath() + File.separator +
        "VID_"+ timeStamp + ".mp4");
    } else {
        return null;
    }

    return mediaFile;
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
        if (resultCode == RESULT_OK) {
            // Image captured and saved to fileUri specified in the Intent
            Toast.makeText(this, "Image saved to:\n" +
                     data.getData(), Toast.LENGTH_LONG).show();
        } else if (resultCode == RESULT_CANCELED) {
            // User cancelled the image capture
        } else {
            // Image capture failed, advise user
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:57:34.303

在您使用意图中的数据发布 Toast 之前，您应该测试它是否不为空

```
if (data!=null){
    Toast.makeText(this, "Image saved to:\n" +
                 data.getData(), Toast.LENGTH_LONG).show();
} 
```

在您的情况下，您的 Activity 返回 null，可以在这一行的 logcat 中看到

```
java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=100,
 result=-1, **data=null**} to activity     
{com.android.demo.notepad3/com.android.demo.notepad3.Notepadv3}: 
java.lang.NullPointerException 
```

# c - 有没有办法用位字段声明无符号固定宽度整数？

> ID：16156976
> 
> 赞同：3
> 
> 时间：2013-04-22T21:23:03.380
> 
> 标签：c, embedded

首先，有可能做到吗？如果是，我在下面的声明中做错了什么？

```
struct mybitfields
{
    uint8_t a : 4;
    uint16_t c : 12;
} test; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:40:15.053

Although what you are doing is *possible*, it is not *portable*: C99 standard says that bit-field base type must be a `_Bool`, `signed int`, or `unsigned int`, allowing implementation-defined types to be used with bit-fields (C90 requires a signed on an unsigned `int`as bit-field's base type; no other types are allowed).

See [this answer](https://stackoverflow.com/a/10906280/335858) for references to appropriate chapters of the C99 and C90 standards.

If your goal is to define a `struct` of bit-fields of size that is smaller than an `unsigned int`, you would be better off using bit shifts for portability.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T21:41:32.007

Your code will be accepted by most compilers, but strictly speaking the base type of a bitfield must be a `(signed / unsigned) int`.

`uint8_t` is a typedef for `unsigned char`, and `uint16_t` is probably a typedef for `unsigned short`, and bitfields made from these types are non-conforming.

# php - 使用 solr php 响应时的 eval 阶段错误

> ID：16156980
> 
> 赞同：0
> 
> 时间：2013-04-22T21:23:22.227
> 
> 标签：php, solr

我们使用 Solr PHP 响应来获取 Solr 搜索结果，如下所示，

```
$php_code = $this->file_get_contents($solr_url);
eval("\$ret_array = " . $php_code . ";"); 
```

它大部分时间都可以正常工作，但偶尔我们会看到一些 php 短语错误，如下所示，

```
PHP Parse error:  syntax error, unexpected '<' in .... 
```

看起来 Solr PHP 响应返回了一些错误的数据。eval 函数没有捕捉到导致这个错误的真正搜索，所以很难知道发生了什么。

有什么建议么？

# c# - 尝试创建自定义部分设置文件

> ID：16156982
> 
> 赞同：0
> 
> 时间：2013-04-22T21:23:24.723
> 
> 标签：c#, visual-studio-2010, app-config, settings.settings

我正在尝试创建一个自定义设置类来存储一些用户范围的设置。几个月前我这样做了，效果很好，但我不记得所有细节，也无法再访问源代码。这是我到目前为止所拥有的：

**自定义设置.cs**

```
internal sealed partial class CustomSettings : global::System.Configuration.ApplicationSettingsBase
{
    private static CustomSettings defaultInstance = ((CustomSettings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new CustomSettings())));

    public static CustomSettings Default
    {
        get
        {
            return defaultInstance;
        }
    }

    [global::System.Configuration.UserScopedSettingAttribute()]
    public global::System.Collections.Generic.List<global::LearningProject.Types.Product> Products
    {
        get
        {
            return ((global::System.Collections.Generic.List<global::LearningProject.Types.Product>)(this["Products"]));
        }
        set
        {
            this["Products"] = value;
        }
    }
} 
```

**产品.cs**

```
[Serializable]
public class Product
{
    [XmlAttribute("Name")]
    public string Name { get; set; }

    [XmlAttribute("Id")]
    public int Id { get; set; }
} 
```

这是**App.config**文件，其中包含一个示例`Product`：

```
<configuration>
<configSections>
    <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="LearningProject.Settings1" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
      <section name="LearningProject.CustomSettings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
    </sectionGroup>
</configSections>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup>
  <userSettings>
        <LearningProject.CustomSettings>
          <setting name="Products" serializeAs="Xml">
            <ArrayOfProduct>
              <Product>
                <Name>Product1</Name>
                <Id>ProductID</Id>
              </Product>
            </ArrayOfProduct>
          </setting>
        </LearningProject.CustomSettings>
    </userSettings>
</configuration> 
```

现在，`null`当我尝试获取以下列表时，我得到了`Products`：

```
List<Product> products = CustomSettings.Default.Products; 
```

这意味着我做错了什么（可能是xml属性？）或者我错过了一个步骤。另请注意，`Settings1.settings`（由 VS 生成）已经存在，我的`CustomSettings`类只是将方法添加到默认的自动生成的设置文件中。我只是想知道是否有人这样做过。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T06:20:48.397

在 app.config 中替换

```
<setting name="Products" serializeAs="Xml">
  <ArrayOfProduct>
    <Product>
      <Name>Product1</Name>
      <Id>ProductID</Id>
    </Product>
  </ArrayOfProduct>
</setting> 
```

至

```
<setting name="Products" serializeAs="Xml">
  <value>
    <ArrayOfProduct>
      <Product Name="Product1" Id="1" />
    </ArrayOfProduct>
  </value>
</setting> 
```

我是如何意识到这一点的

```
CustomSettings.Default.Products = new List<Product>();
CustomSettings.Default.Products.Add(new Product() { Id = 1, Name = "Product1" });
CustomSettings.Default.Save(); 
```

现在本地配置 (%appdatalocal%\project_name..\user.config) 包含正确的值

# visual-studio - 使用 PowerShell 递归遍历 Visual Studio 解决方案

> ID：16156984
> 
> 赞同：2
> 
> 时间：2013-04-22T21:23:27.727
> 
> 标签：visual-studio, powershell, recursion, envdte

我需要以编程方式从包含近 150 个项目的解决方案中提取信息。解决方案文件虽然不是平面的，但一些项目被组织到文件夹中，文件夹层次结构可以更深层次。这适合递归解决方案：我可以编写一个函数，它枚举一个列表，如果元素是一个项目，它会检查它，如果它是一个文件夹，它会进入文件夹并递归调用自身来检查文件夹的内容。它的要点：

```
$dte = [System.Runtime.InteropServices.Marshal]::GetActiveObject("visualstudio.dte.11.0")

function traverseproject {
    param([object]$prjnode, [int]$level)
    if ($prjnode.Kind -eq "{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}")
    {
        Write $prjnode.Name
        Write $level
    }
    if ($prjnode.Kind -eq "{66A26720-8FB5-11D2-AA7E-00C04F688DDE}")
    {
        foreach ($prjsubnode in $prjnode)
        {
            traverseproject($prjsubnode, $level + 1)
        }
    }
}

foreach($prjn in $dte.solution.projects)
{
    traverseproject($prjn, 0)
} 
```

问题是递归函数得到的 $prjnode 对象很奇怪。 `Write $prjnode.Name`不输出任何东西。可能出于同样的原因，我无法遍历文件夹对象的节点。现在在上面的代码中，它`foreach ($prjsubnode in $prjnode)`只是没有默默地做任何事情。我试过`foreach ($prjsubnode in $prjnode.ProjectItems)`了，这给出了错误。我尝试了任何一种组合。

从错误消息看来，[链接](http://msdn.microsoft.com/en-us/library/ak940968%28v=vs.110%29.aspx)的`$prjnode`类型是. 我可以打印出该属性，它似乎是有效的，但我在界面上看不到任何可以获取包含元素的属性。所以也许这就是我不能迭代的原因？不可能？我在链接的 MSDN 页面底部看到了 Visual Basic 示例，但我需要一个有效的 PowerShell 解决方案。`DTE` `ProjectItem` `8E2F1269-185E-43C7-8899-950AD2769CCF``Count`

该函数的第一次调用似乎工作正常，例如它看到了`$prjnode.Kind`属性，但在第一次递归调用之后，事情就丢失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-14T18:00:40.797

由于您已经在加载 dte，请查看[http://studioshell.codeplex.com/](http://studioshell.codeplex.com/)

最能帮助您的功能：

*   以一致且可发现的方式管理您的项目、引用、断点、堆栈框架局部变量、菜单、工具栏、Visual Studio 设置、IDE 窗口，甚至是来自 PowerShell 脚本的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T20:07:29.453

这是使用 StudioShell 获取所有已加载项目的方法

```
$projects = ls -path "DTE:\solution\Projects" -recurse
  | where {$_.FileName -match ".csproj"} 
```

请注意，大型解决方案最多可能需要 15 分钟。

# windows - 在Windows登录屏幕之前显示消息？

> ID：16156986
> 
> 赞同：1
> 
> 时间：2013-04-22T21:23:31.380
> 
> 标签：windows, login, fullscreen, gina, modal-popup

我有一个程序应该在触发火警时在所有计算机上运行并显示全屏消息并播放 .mp3 文件。我可以在没有人登录的情况下在计算机上播放声音，它仍然在“按 ctrl alt del 登录”屏幕，但我无法打开全屏消息，因为没有活动会话打开它。有谁知道在有人登录到 Windows 之前是否有办法在“按 ctrl alt del 登录”屏幕上显示一条消息。

我当前的应用程序是用 C# 编写的，但如果有人知道我可以使用另一种语言显示此消息的方法，我会用另一种语言重写它。

所有的计算机都将是 Windows 7 机器。

我发现您可以自定义登录屏幕[http://msdn.microsoft.com/en-gb/magazine/cc163489.aspx](http://msdn.microsoft.com/en-gb/magazine/cc163489.aspx)但这仍然在 ctrl alt del 屏幕之前。我还读到病毒可以在计算机加载 ctrl alt del 屏幕之前放入一个屏幕，但这似乎正在引导到另一个屏幕，我希望它能够在收到消息时显示。

如果我无法在 ctrl alt del 屏幕上显示屏幕，是否可以在桌面加载之前登录并加载全屏消息？

# regex - 正则表达式，逗号必须跟随 1 或 2 位数字

> ID：16156990
> 
> 赞同：1
> 
> 时间：2013-04-22T21:23:49.730
> 
> 标签：regex

我正在尝试编写一个正则表达式，以确保如果有逗号，那么以下文本应该是 1 位或 2 位数字。

这是我到目前为止所拥有的。

```
(^\d{0,2})+(,\d{0,2})*$ 
```

在大多数情况下有效，但它认为以下内容是有效的。

```
12,22,,,,,,,,,, and 12,22,,,,,,,,,,12,12 
```

我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T21:27:10.073

`\d{0,2}`表示“介于 0 和 2 位之间”。它应该是`\d{1,2}`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-22T21:30:48.383

您在逗号后匹配 0 到 2 位数字而不是 1 或 2 以下应该可以解决问题

```
(^\d{1,2})+(,\d{1,2})*$ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-22T21:26:42.717

使用否定前瞻断言逗号后没有 3 位数字，并保持主正则表达式简单地“所有逗号或数字”

```
^(?!.*,\d{3})[,\d]+$ 
```

# c++ - 保存、加载和重玩游戏。C++

> ID：16156991
> 
> 赞同：0
> 
> 时间：2013-04-22T21:23:53.477
> 
> 标签：c++, visual-studio-2010

基本上，作为一个团队的一员，我不得不为我的大学课程创建一个类似吃豆人的游戏，只是僵尸而不是幽灵。到目前为止，我们已经构建了所有游戏，并且它似乎运行得非常好。我们当前的问题是我们必须保存游戏（使用用户名和分数），将游戏加载到曾经保存的位置，使用正确的用户名和分数，最后能够提供重播选项，用户可以查看他们之前所做的所有动作（以及僵尸所做的动作）。僵尸将始终做出与用户相同的动作，因为它们旨在追逐用户。

我的问题是执行保存、加载和重新加载选项的最佳方法是什么？我们不能使用向量、堆栈或队列。我们只能真正使用字符串、数组和其他基本变量。
我们正在考虑通过将所有内容添加到字符串的末尾然后从字符串中弹出最后一个值来进行重新加载。然后我们可以将每一个延迟一秒，用户将能够看到他/她的动作。

至于保存我们不确定，还有孔（0 符号）和药丸（* 符号）要考虑在内。所以需要保存角色、僵尸、药丸和洞的位置。角色可以从任何随机位置开始，几乎所有其他内容都放在后面。

我们进行加载的方式将取决于您建议我们进行保存的方式。

有人对我们应该如何保存、加载和重播有任何建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T01:22:55.497

我能想到的最简单的方法是保存用户输入。

这样，您可以通过将输入发送到游戏引擎来轻松地重玩游戏（这可能需要根据游戏引擎的设计进行大量重组）。为了加速加载，您还可以在保存时保存游戏状态（通过序列化）。

这就是想法，怎么做……你需要一个不断扩展的数组来记录用户输入，所以让我们使用一个链表。

```
struct Node {
    T data;
    Node* next_node;
};
//Google for the rest of the code, it is a reeeaaallly
//    basic/fundamental data structure. 
```

数据将是用户输入和它们发生的时间。要保存数据，您只需遍历链表并将其附加到 std::ostream& （通用，具体为 std::ofstream& ）。

您可以在用户输入之前或之后添加一些其他有用的信息（例如游戏状态和高分）（甚至在另一个文件中，这对于高分确实有意义）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T00:32:44.287

您需要阅读一些序列化。我在这里写了一些文章，但这对你们来说太过分了：[http ://www.randygaul.net/2013/01/05/c-reflection-part-5-automated-serialization/](http://www.randygaul.net/2013/01/05/c-reflection-part-5-automated-serialization/)

您可以使用一些非常简单的序列化将每个僵尸的动作写到一个文件中。然后，当您想要重新加载此信息时，您将反序列化文件中的信息。每个动作都可能以某种形式的链接列表存储，因此您必须想出一种在反序列化时重新创建此类列表的方法。

你的问题很广泛，所以我的回答也必须很广泛。真的由你来研究解决方案并实施它。

# java - 使用 Atmosphere 仅向一位客户广播

> ID：16156995
> 
> 赞同：5
> 
> 时间：2013-04-22T21:24:18.497
> 
> 标签：java, atmosphere

如何使用 Atmosphere (Meteor) 从一个客户端向另一个客户端广播消息？我目前有这个基于流星教程的实现

```
@Override
public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException {
    Meteor.build(req).addListener(new AtmosphereResourceEventListenerAdapter());
}

@Override
public void doPost(HttpServletRequest req, HttpServletResponse res) throws IOException {
    String body = req.getReader().readLine().trim();
    //some DAO lookups - here I would like to say I want to broadcast only to concrete client
    BroadcasterFactory.getDefault().lookup(DefaultBroadcaster.class, "/*").broadcast(UserDAO.getInstance().getUser(name));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-30T22:36:31.523

我相信的另一种解决方案：仅针对一个客户，您不需要广播，您可以这样做：

```
 try
     {
        r.getResponse().write(message);
     }
     catch(IllegalStateException e)
     {
        logger.error("Could not send message through atmosphere " + userId);
     } 
```

其中 r 是您可以在程序中记住的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T19:47:03.763

这是他们 wiki 上的 Atmosphere 常见问题解答：[https ://github.com/Atmosphere/atmosphere/wiki/Creating-private-channel-of-communication-between-Browsers](https://github.com/Atmosphere/atmosphere/wiki/Creating-private-channel-of-communication-between-Browsers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T06:05:33.837

```
BroadcasterFactory.getDefault().lookup(atmosphereResource.uuid()).broadcast('something'); 
```

# c# - 当 asp.net 编辑模板验证控制组运行时，C# IsVaild 不会翻转为 False，应该返回 false

> ID：16156996
> 
> 赞同：0
> 
> 时间：2013-04-22T21:24:20.357
> 
> 标签：c#, asp.net, validationgroup

我有一个页面可以为我们的人力资源系统跟踪公司假期，但是现在如果您尝试编辑假期的结束日期并且用户不小心输入了开始日期之前的结束日期，它仍然会验证为 true 并且允许将编辑写入数据库表。

我错过了什么使页面始终验证为 True？我在此页面上还有一个 DetailsView，它使用一组验证控件，它正在工作，并且当某些内容未通过验证时将验证为 false。

```
protected void HolidaysDS_Updated(object sender, SqlDataSourceStatusEventArgs e)
{
    if (e.Exception != null)
    {
        lblNullUpdate.Text = "One of your updated fields is invalid. Your update did not occur.";
        lblNullUpdate.Visible = true;

        e.ExceptionHandled = true;
    }
}

protected void gvHolidays_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    Page.Validate("EditValidationControls");

    if (Page.IsValid == false)
    {
        e.Cancel = true;
    }
    lblNullUpdate.Visible = false;
} 
```

如果用户在更新中传递 null 以及应该验证页面并检查一切是否有效的事件，那是我当前的 C# 处理异常。

```
<h2>Holidays</h2>
        <asp:Label ID="lblHolidayYear" runat="server" Text="Holiday Year:" AssociatedControlID="ddlHolidayYears"></asp:Label>
        <asp:DropDownList ID="ddlHolidayYears" runat="server" AutoPostBack="True" 
            DataSourceID="HolidayYearDS" DataTextField="HYear" DataValueField="HYear">
        </asp:DropDownList>
        <asp:GridView ID="gv_Holidays" runat="server" AutoGenerateColumns="False" 
        DataKeyNames="HolidayID" 
            DataSourceID="HolidaysDS" 
            AllowSorting="True"  
            CssClass="gvhours"
            HeaderStyle-CssClass="header"
            AlternatingRowStyle-CssClass="alternating"
            SortedAscendingHeaderStyle-CssClass="sortasc-header"
            SortedDescendingHeaderStyle-CssClass="sortdesc-header"
            CommandRowStyle-CssClass="command" 
            PagerStyle-CssClass="page"
            OnRowUpdating="gvHolidays_RowUpdating">
            <AlternatingRowStyle CssClass="alternating" />
            <Columns>
                <asp:CommandField ShowEditButton="true" 
                    ValidationGroup="EditValidationControls" />
                <asp:BoundField DataField="HolidayID" HeaderText="HolidayID" InsertVisible="False" 
                    ReadOnly="True" SortExpression="HolidayID" Visible="False" 
                    ShowHeader="False"  />
                <asp:BoundField DataField="HYear" HeaderText="Year" SortExpression="HYear" Visible="false" />
                <asp:BoundField DataField="HStartDate" DataFormatString="{0:MM/dd/yyyy}" 
                    HeaderText="Start Date" SortExpression="HStartDate" />
                <asp:BoundField DataField="HEndDate" DataFormatString="{0:MM/dd/yyyy}" 
                    HeaderText="End Date" SortExpression="HEndDate" />
                <asp:BoundField DataField="HDescription" HeaderText="Description" 
                    SortExpression="HDescription" />
            </Columns>
            <HeaderStyle CssClass="header" />
            <PagerStyle CssClass="page" />
            <SortedAscendingHeaderStyle CssClass="sortasc-header" />
            <SortedDescendingHeaderStyle CssClass="sortdesc-header" />
        </asp:GridView>
        <asp:Label ID="lblNullUpdate" runat="server" Font-Bold="True" Font-Size="Large" 
            ForeColor="Red" Text="Label" Visible="False"></asp:Label>
        <asp:SqlDataSource ID="HolidaysDS" runat="server" OnInserted="HolidaysDS_Inserted"
            OnUpdated="HolidaysDS_Updated"
            ConnectionString="<%$ ConnectionStrings:TigerTimeTrackerConnectionString %>" 
            ProviderName="<%$ ConnectionStrings:TigerTimeTracker_ConnectionString.ProviderName %>" 
            InsertCommand="usp_Holidays_Add_Holiday" 
            InsertCommandType="StoredProcedure" 
            SelectCommand="usp_Holidays_Get_Holidays_By_Year" 
            SelectCommandType="StoredProcedure" 
            UpdateCommand="usp_Holidays_Update_Holiday" 
            UpdateCommandType="StoredProcedure"> 
               <SelectParameters>
                   <asp:ControlParameter ControlID="ddlHolidayYears" Name="Year" 
                       PropertyName="SelectedValue" Type="String" />
               </SelectParameters>
               <UpdateParameters> 
                   <asp:Parameter Name="HolidayID" Type="Int32"  />
                   <asp:ControlParameter ControlID="ddlHolidayYears" Name="HYear" PropertyName="SelectedValue" Type="String" />
                   <asp:Parameter Name="HStartDate" Type="DateTime" />
                   <asp:Parameter Name="HEndDate" Type="DateTime" />
                   <asp:Parameter Name="HDescription" Type="String" />
               </UpdateParameters>
               <InsertParameters>
                   <asp:Parameter Name="Year" Type="String" />
                   <asp:Parameter Name="StartDate" Type="DateTime" />
                   <asp:Parameter Name="EndDate" Type="DateTime" />
                   <asp:Parameter Name="Description" Type="String" />
               </InsertParameters>
            </asp:SqlDataSource> 
            <asp:SqlDataSource ID="HolidayYearDS" runat="server"
                ConnectionString="<%$ ConnectionStrings:TigerTimeTracker_ConnectionString %>" 
                ProviderName="<%$ ConnectionStrings:TigerTimeTracker_ConnectionString.ProviderName %>" 
                SelectCommand="usp_Holidays_Get_Distinct_Holiday_Years" 
                SelectCommandType="StoredProcedure" >
            </asp:SqlDataSource>
            <asp:DetailsView ID="dvHolidays" runat="server" Height="50px" Width="125px" 
            AutoGenerateRows="False"
            DataKeyNames="HolidayID"
            DataSourceID="HolidaysDS" 
            DefaultMode="Insert" 
            CssClass="dView"
            HeaderStyle-CssClass="header" 
            FieldHeaderStyle-CssClass="fieldHeader"
            AlternatingRowStyle-CssClass="alternating"
            CommandRowStyle-CssClass="command" 
            PagerStyle-CssClass="page"
            FooterStyle-CssClass="footer" 
            OnItemInserted="dvHolidays_ItemInserted"
            OnItemInserting="dvHolidays_ItemInserting">
                <AlternatingRowStyle CssClass="alternating" />
            <CommandRowStyle CssClass="command" />
            <FieldHeaderStyle CssClass="fieldHeader" />
            <Fields>
                <asp:BoundField DataField="HolidayID" HeaderText="HolidayID" 
                    InsertVisible="False" ReadOnly="True" SortExpression="HolidayID" />
                <asp:TemplateField HeaderText="Year: " SortExpression="HYear">
                    <InsertItemTemplate>
                        <asp:TextBox ID="txtHolidayYear" runat="server" Text='<%# Bind("Year") %>'></asp:TextBox>
                        <asp:RequiredFieldValidator ID="YearRequiredValidator" runat="server" ValidationGroup="InsertValidationControls" ControlToValidate="txtHolidayYear" 
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                        <asp:RegularExpressionValidator ID="YearLengthValidator" runat="server" ValidationGroup="InsertValidationControls" ControlToValidate="txtHolidayYear"
                            ValidationExpression="^[0-9]{4,4}$" ErrorMessage="The Year can only be numeric(0-9), and has to be four digits."></asp:RegularExpressionValidator>
                    </InsertItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Start Date: " SortExpression="HStartDate">
                    <EditItemTemplate>
                        <asp:TextBox ID="txtHolidayStartEdit" runat="server" Text='<%# Bind("HStartDate") %>' ClientIDMode="Static"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="HolidayStartEditRequiredValidator" runat="server" ValidationGroup="EditValidationControls" ControlToValidate="txtHolidayStartEdit"
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                    </EditItemTemplate>
                    <InsertItemTemplate>
                        <asp:TextBox ID="txtHolidayStartInsert" runat="server" Text='<%# Bind("StartDate") %>' ClientIDMode="Static"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="HolidayStartInsertRequiredValidator" runat="server" ValidationGroup="InsertValidationControls" ControlToValidate="txtHolidayStartInsert"
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                    </InsertItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="End Date: " SortExpression="HEndDate">
                    <EditItemTemplate>
                        <asp:TextBox ID="txtHolidayEndEdit" runat="server" Text='<%# Bind("HEndDate") %>' ClientIDMode="Static"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="HolidayEndEditRequiredValidator" runat="server" ValidationGroup="EditValidationControls" ControlToValidate="txtHolidayEndEdit"
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                        <asp:CompareValidator ID="HolidayRangeCheckEdit" runat="server" ValidationGroup="EditValidationControls" ControlToValidate="txtHolidayEndEdit" ErrorMessage="End Date must be after Start Date."
                            ControlToCompare="txtHolidayStartEdit" Operator="GreaterThanEqual" Type="Date"></asp:CompareValidator>
                    </EditItemTemplate>
                    <InsertItemTemplate>
                        <asp:TextBox  ID="txtHolidayEndInsert" runat="server" Text='<%# Bind("EndDate") %>' ClientIDMode="Static"></asp:TextBox> 
                        <asp:RequiredFieldValidator ID="HolidayEndInsertRequiredValidator" runat="server" ValidationGroup="InsertValidationControls" ControlToValidate="txtHolidayEndInsert"
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                        <asp:CompareValidator ID="HolidayRangeCheckInsert" runat="server" ValidationGroup="InsertValidationControls" ControlToValidate="txtHolidayEndInsert"
                            ControlToCompare="txtHolidayStartInsert" Operator="GreaterThanEqual" Type="Date" ErrorMessage="Please enter an End Date that is after the Start Date."></asp:CompareValidator>
                    </InsertItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Description: " SortExpression="HDescription">
                    <EditItemTemplate>
                        <asp:TextBox ID="txtHolidayDescriptionEdit" runat="server" Text='<%# Bind("HDescription") %>'></asp:TextBox>
                    </EditItemTemplate>
                    <InsertItemTemplate>
                        <asp:TextBox ID="txtHolidayDescriptionInsert" runat="server" Text='<%# Bind("Description") %>'></asp:TextBox>
                    </InsertItemTemplate>
                </asp:TemplateField>
                <asp:CommandField ShowInsertButton="true" 
                    ValidationGroup="InsertValidationControls"/>
            </Fields>
            <FooterStyle CssClass="footer" />
            <HeaderStyle CssClass="header" />
            <PagerStyle CssClass="page" />
            </asp:DetailsView>
        <asp:Label ID="lblInsertUniqueError" runat="server" Font-Bold="True" 
            Font-Size="Large" ForeColor="Red" Text="Label" Visible="False"></asp:Label>
       </asp:View> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:16:18.463

整个时间的问题是我在gridview中使用绑定字段而不是模板字段。这是我为遇到此问题的其他人更新的代码。

```
<asp:GridView ID="gv_Holidays" runat="server" AutoGenerateColumns="False" 
        DataKeyNames="HolidayID" 
            DataSourceID="HolidaysDS" 
            AllowSorting="True"  
            CssClass="gvhours"
            HeaderStyle-CssClass="header"
            AlternatingRowStyle-CssClass="alternating"
            SortedAscendingHeaderStyle-CssClass="sortasc-header"
            SortedDescendingHeaderStyle-CssClass="sortdesc-header"
            CommandRowStyle-CssClass="command" 
            PagerStyle-CssClass="page"
            OnRowUpdating="gvHolidays_RowUpdating">
            <AlternatingRowStyle CssClass="alternating" />
            <Columns>
                <asp:CommandField ShowEditButton="true" 
                    ValidationGroup="EditValidationControls" />
                <asp:BoundField DataField="HolidayID" HeaderText="HolidayID" InsertVisible="False" 
                    ReadOnly="True" SortExpression="HolidayID" Visible="False" 
                    ShowHeader="False"  />
                <asp:BoundField DataField="HYear" HeaderText="Year" SortExpression="HYear" Visible="false" />
                <asp:TemplateField HeaderText="Start Date" SortExpression="HStartDate" >
                    <EditItemTemplate>
                        <asp:TextBox ID="txtHolidayStartEdit" runat="server" Text='<%# Bind("HStartDate", "{0:MM/dd/yyyy}") %>' ClientIDMode="Static"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="HolidayStartEditRequiredValidator" runat="server" ValidationGroup="EditValidationControls" ControlToValidate="txtHolidayStartEdit"
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                    </EditItemTemplate>
                    <ItemTemplate>
                        <asp:Label ID="lblStartItem" runat="server" Text='<%# Bind("HStartDate", "{0:MM/dd/yyyy}") %>' ></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="End Date" SortExpression="HEndDate" >
                    <EditItemTemplate>
                        <asp:TextBox ID="txtHolidayEndEdit" runat="server" Text='<%# Bind("HEndDate", "{0:MM/dd/yyyy}") %>' ClientIDMode="Static"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="HolidayEndEditRequiredValidator" runat="server" ValidationGroup="EditValidationControls" ControlToValidate="txtHolidayEndEdit"
                            ErrorMessage="Required"></asp:RequiredFieldValidator>
                        <asp:CompareValidator ID="HolidayRangeCheckEdit" runat="server" ValidationGroup="EditValidationControls" ControlToValidate="txtHolidayEndEdit" ErrorMessage="End Date must be after Start Date."
                            ControlToCompare="txtHolidayStartEdit" Operator="GreaterThanEqual" Type="Date"></asp:CompareValidator>
                    </EditItemTemplate>
                    <ItemTemplate>
                        <asp:Label ID="lblEndItem" runat="server" Text='<%# Bind("HEndDate", "{0:MM/dd/yyyy}") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:BoundField DataField="HDescription" HeaderText="Description" 
                    SortExpression="HDescription" />
            </Columns>
            <HeaderStyle CssClass="header" />
            <PagerStyle CssClass="page" />
            <SortedAscendingHeaderStyle CssClass="sortasc-header" />
            <SortedDescendingHeaderStyle CssClass="sortdesc-header" />
        </asp:GridView> 
```

# excel - 将范围项目从一张工作表复制到新创建的工作表时出现运行时错误

> ID：16156997
> 
> 赞同：0
> 
> 时间：2013-04-22T21:24:24.153
> 
> 标签：excel, vba

我似乎无法将内容从一个工作表复制并粘贴到另一个工作表 - 我收到一个运行时错误，我不明白为什么......请赐教..

这是代码：

```
Dim cell As String

 For i = 2 To cat_lastRow
    Sheets("Sheet1").Select
    cell = ActiveSheet.Cells(i, cat_col).Value
    Sheets("skeleton").Range("A1:S21").Copy

    If Not worksheetExists(cell) Then
        ActiveWorkbook.Sheets.Add.Name = cell
    Else
        Sheets(cell).Cells.Clear
    End If

    Sheets(cell).Paste
    ...

 Next i 
```

我浏览代码直到 Shees(cells).Paste

实际上，如何将所有项目从一个工作表复制到另一个工作表 - 如果存在具有该名称的工作表，则将其清除，然后从头开始将内容粘贴到其中。

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T21:38:11.753

...未经测试，但其他操作可能会放弃选择。尝试将 .Copy-line 直接放在 .Paste-line 之前，然后给出起始单元格，就像`Sheets(cell).Range("A1").Paste`或者直接

```
Sheets("skeleton").Range("A1:S21").Copy Sheets(cell).Range("A1") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T21:49:49.267

包括您重新复制整个工作表的问题；您可能可以复制整个工作表并粘贴到新工作表中，而不必先清除单元格，或者您可以删除工作表（如果存在），然后复制所需的工作表并重命名：

```
Dim cell As String

For i = 2 To cat_lastRow
    Sheets("Sheet1").Select
    cell = ActiveSheet.Cells(i, 1).Value

    ' Turn off alert that you are deleting sheet
    Application.DisplayAlerts False
    ' Resume next on error if the sheet does not already exist
    On Error Resume Next
    Sheets(cell).Delete
    ' Rest your error handle
    On Error GoTo 0
    Sheets("skeleton").Copy after:=Sheets("Sheet3")
    ActiveSheet.Name = cell
 Next i 
```

确保将 Application.DisplayAlerts True 放在代码的末尾，并且一旦删除了工作表，您可能还需要更改 on error。