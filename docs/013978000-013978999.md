# StackOverflow 问答 13978000-13978999

# javascript - Jquery 不会全选

> ID：13978006
> 
> 赞同：-3
> 
> 时间：2012-12-20T18:09:23.517
> 
> 标签：javascript, jquery, html, select

> **可能重复：**
> [jQuery id 选择器仅适用于第一个元素](https://stackoverflow.com/questions/11114622/jquery-id-selector-works-only-for-the-first-element)

我希望 jquery 选择所有 id = box 的 div：

```
<!DOCTYPE html>
    <head>
    <link rel="stylesheet" href="css/main.css" type="text/css"/>
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="js/sizer.js"></script>
        <title>
        Design tests
        </title>
    </head>
    <body>
        <div id="box" style="width:300px;">
        Hallo
        </div>

        <div id="box" style="width:300px;">
        Hallo
        </div>

    <script>    
    $(document).ready(function(){
        $("#box").mouseenter(function(){ $(this).css("border", "1px gray outset");}).mouseleave(function(){ $(this).css("border", "none");});
    });
    </script>
    </body>
</html> 
```

但它只选择第一个。有人能帮帮我吗？这不难吧？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T18:10:00.810

HTML 只允许一个具有给定 id 的元素。这就是原因（jQuery 内部使用[getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)来返回一个元素）。

从[规格](http://www.w3.org/TR/html401/struct/global.html#h-7.5.2)：

> id = 名称 [CS]
> 
> 此属性为元素分配名称。此名称在文档中必须是唯一的。

如果要选择多个元素，请使用类，而不是 id ：

```
 <div class="box" style="width:300px;">
    Hallo
    </div>

    <div class="box" style="width:300px;">
    Hallo
    </div>

<script>    
$(document).ready(function(){
    $(".box").mouseenter(function(){ $(this).css("border", "1px gray outset");}).mouseleave(function(){ $(this).css("border", "none");});
});
</script> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T18:10:34.477

您不能拥有超过 1 个相同的 ID，请改用一个类

```
<!DOCTYPE html>
    <head>
    <link rel="stylesheet" href="css/main.css" type="text/css"/>
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="js/sizer.js"></script>
        <title>
        Design tests
        </title>
    </head>
    <body>
        <div class="box" style="width:300px;">
        Hallo
        </div>

        <div class="box" style="width:300px;">
        Hallo
        </div>

    <script>    
    $(document).ready(function(){
        $(".box").mouseenter(function(){ $(this).css("border", "1px gray outset");}).mouseleave(function(){ $(this).css("border", "none");});
    });
    </script>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T18:13:36.880

将您的选择器更改为`div#box`，它会像这样工作

```
$(document).ready(function(){
    $("div#box").mouseenter(function(){ $(this).css("border", "1px gray outset");}).mouseleave(function(){ $(this).css("border", "none");});
}); 
```

另请注意，让多个元素具有相同的 id 是不好的做法。​</p>

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-20T18:13:57.770

语法 $('#box') 意味着去选择第一个 id 匹配“box”的元素。你想要做的是使用 class ，或者如果你坚持使用 id $('div[id="box"]') 会做你想做的事

# python - Flask-Restless GET 请求抛出 SQLAlchemy 错误

> ID：13978010
> 
> 赞同：1
> 
> 时间：2012-12-20T18:09:40.657
> 
> 标签：python, flask, flask-sqlalchemy, flask-extensions

我需要为我的 Flask 应用程序实现一个 API，并且已经看到了针对 [`Flask-Restless`](https://flask-restless.readthedocs.org/en/latest/index.html). 我遇到了这个库的基本用法，并希望使用它的人可以提供帮助。

创建 API 管理器和端点...

```
manager = APIManager(app, flask_sqlalchemy_db=db)
manager.create_api(Gallery, methods=['GET', 'POST', 'PUT', 'DELETE']) 
```

...以及随之而来的模型

```
class Gallery(db.Model):
    __tablename__ = 'galleries'
    id = db.Column(db.Integer, primary_key=True)

    title = db.Column(db.String(25))

    def __init__(self, title):
        self.title = title 
```

现在，为了插入新条目，我使用了这个 jQuery ajax POST 请求。这工作正常。我已经在 sqlite db 查看器中对其进行了测试，并且可以看到条目。

```
$('#form').on('submit', function(e){
        $.ajax({
            type: 'post',
            url: '/api/galleries',
            contentType:"binary/octet-stream",
            data: JSON.stringify({'title': $('#title').val()}),
            success: function(){
                alert('Success!');
            }
        });
        e.preventDefault();
    }); 
```

这就是问题所在。我进入`http://localhost:5000/api/galleries`浏览器并收到以下消息：

> **sqlalchemy.orm.exc.NoResultFound**
> NoResultFound：没有找到一个（）的行

`api/galleries`奇怪的是，它会在应该返回数据库条目列表时尝试运行 one() 。我尝试`api/galleries/1`得到完全相同的错误。我仔细检查了一下，主 ID 是 1。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:58:55.947

我今天遇到了同样的问题，并通过一些解决方法解决了它。

**这是我的模型的样子：**

```
 class User(db.Model):
        id = db.Column(db.Integer, primary_key=True)
        ...

    class Key(db.Model):
        user_id = db.Column(db.Integer, db.ForeignKey('auth_user.id'))
        user = db.relationship('User', backref=db.backref('keys', lazy='dynamic'))
        ... 
```

**原因：**

查询时收到相同的错误消息`users`。我发现 flask-restless 正在尝试查询`keys`我的相关信息`users`，不幸的是，我的`key`表是空的，我收到了错误消息。

**解决方法：**

创建 API 时使用**include_columns**或**exclude_columns**排除列：`keys`

```
 api_mgr.create_api(User, include_columns = ['email', 'username']) 
```

或者：

```
 api_mgr.create_api(User, exclude_columns = ['keys', 'SOME_OTHER_COLUMNS']) 
```

您可以检查是否有任何相关表导致问题。如果是原因，您可以使用**include_columns**或**exclude_columns**关键字参数。

# php - 如何在 Ajax 站点上使用 file_get_contents

> ID：13978016
> 
> 赞同：4
> 
> 时间：2012-12-20T18:10:02.140
> 
> 标签：php, html, ajax, file-get-contents

当您使用`file_gets_contents($website)`或[**cURL**](http://davidwalsh.name/curl-download) 加载网站时，它会加载整个网站吗？我最感兴趣的是使用**cURL**。

我正在使用它来加载一个网页，然后使用 AJAX 获取一些内容，例如价格，并且在获取价格时遇到了一些问题。

当我使用 file_get_contents 时，它是否像浏览器上的整个网站一样正常加载，加上使用 Ajax 加载的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:17:26.087

不会。使用`file_get_contents()`只会返回页面内容，不会在页面本身上执行任何 JavaScript。这种行为的模拟几乎等同于浏览器中的“查看页面源代码”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:13:53.333

片段

```
$website = 'http://stackoverflow.com/';
file_gets_contents($website) 
```

**加载 HTTP 请求的结果，仅此而已**。因此，调用会加载由 URL 返回的 html 页面的源代码`http://stackoverflow.com/`。

特别是，`file_gets_contents()` **不加载**由 .指向的页面引用的内容`http://stackoverflow.com/`。

**使用 PHP 评估 JavaScript 代码**

如果您想**使用 PHP-script 评估 HTML 代码中的 JavaScript**，您可能希望使用[V8 JavaScript 引擎](http://php.net/manual/en/book.v8js.php)，它需要编译到您的 PHP 二进制文件中：

*   [http://php.net/manual/en/book.v8js.php](http://php.net/manual/en/book.v8js.php)

在此处查找如何[使用 V8 JavaScript 引擎](http://php.net/manual/en/v8js.examples.php)的示例。

# xslt - 使用 xslt 我如何使用选择/何时从文档中删除元素

> ID：13978019
> 
> 赞同：1
> 
> 时间：2012-12-20T18:10:07.103
> 
> 标签：xslt, case-when, xsl-choose

这是我的示例文档

```
<a >
 <b flag='foo'>
 <c/>
 <d/>
 </b>
</a> 
```

仅当 b 上的标志属性为“bar”时，我才希望删除“c”元素。即如果 flag='foo' 则不应删除“c”元素。我的电脑上目前没有 xsl 调试工具，也找不到显示 xslt 错误信息的在线工具，并且一直在[http://xslttest.appspot.com/](http://xslttest.appspot.com/)上运行以下测试 xsl 转换：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
<xsl:output method="xml" indent="yes" version="1.0" encoding="ISO-8859-1"/>
    <!--Identity template to copy all content by default-->
    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>
    <xsl:choose>
    <xsl:when test="/a/b[@flag='bar']">
    <xsl:template match="/a/b/c"/>
    </xsl:when>
    </xsl:choose>
</xsl:stylesheet> 
```

当我运行它时，我得到错误：无法编译样式表。检测到 3 个错误。我正在寻求帮助 (1) 解决 xsl 代码的问题和 (2) 任何可以调试/测试 xsl 代码片段的 xsl jsfiddle 之类的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:13:25.960

你不能把 a 放在`choose`外面`template`，但你不需要 - 你可以在匹配表达式中使用谓词，所以只需声明你的无操作模板来匹配你想要删除的元素：

```
<xsl:template match="b[@flag='bar']/c" /> 
```

或更一般地，如果元素的父`c`元素可能有不同的名称

```
<xsl:template match="c[../@flag='bar']" /> 
```

或者

```
<xsl:template match="*[@flag='bar']/c" /> 
```

# java - Hibernate 4.1.9：我需要哪些 jar 文件？

> ID：13978020
> 
> 赞同：10
> 
> 时间：2012-12-20T18:10:10.540
> 
> 标签：java, hibernate

[我从“ Hibernate 3.2 in Simple Steps](http://www.amazon.co.uk/Hibernate-Simple-Steps-John-Wilfred/dp/8177228897) ”一书中开始学习 Hibernate 框架，但我下载了最新版本的 Hibernate 4.1.9。根据这本书，我们需要将许多基本 jar 添加到类路径中，例如

*   Anttr-2.7.6.jar
*   asm.jar
*   asm-attrs.jar
*   cglib-2.1.3.jar
*   commons-collections-2.1.1.jar
*   commons-logging-1.0.4.jar
*   . . . 等等

但是我在新版本中找不到所有需要的罐子。那么，如果不使用旧版本，我该怎么办？？我只需要在所需的文件夹中添加罐子吗，，谁能告诉我我应该添加哪些罐子来添加类路径（4.1.9版本）。这个问题可能很愚蠢，但我是初学者，我被困在这里。请帮我。谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-20T18:13:51.570

```
antlr-2.7.7.jar
commons-collections-3.2.1.jar
dom4j-1.6.1.jar
javassist-3.12.1.GA.jar
hibernate-core-4.0.1.Final.jar
hibernate-commons-annotations-4.0.1.Final.jar
hibernate-jpa-2.0-api-1.0.1.Final.jar
jboss-logging-3.1.0.CR2.jar
jboss-transaction-api_1.1_spec-1.0.0.Final.jar 
```

您下载的 zip 文件将在 lib 中有一个必需的文件夹。它将包含所有必要的 jar。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T18:17:55.007

这在[Hibernate 文档](http://docs.jboss.org/hibernate/orm/4.1/quickstart/en-US/html/ch01.html#hibernate-gsg-setup-releaseBundle)中得到了很好的解释（当有大量好的在线材料可用时，永远不要仅仅依赖一本书，就像 Hibernate 的情况一样）：

> lib/required/ 目录包含 Hibernate 所需的所有 JAR。此目录中的所有 jar 文件也必须包含在项目的类路径中。

您需要的所有 jar 文件都在您已下载的 .zip 文件中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-06T07:14:19.573

假设您在以下位置下载了 Hibernate 软件 ( **[http://hibernate.org/](http://hibernate.org/)** )。

```
Hibernate_HOME = /home/rangareddy/Hibernate/hibernate-release-4.2.7.Final 
```

罐子文件：

```
%Hibernate_HOME%/lib/required/antlr-2.7.7.jar
%Hibernate_HOME%/lib/required/dom4j-1.6.1.jar
%Hibernate_HOME%/lib/required/hibernate-commons-annotations-4.0.2.Final.jar
%Hibernate_HOME%/lib/required/hibernate-core-4.2.7.Final.jar
%Hibernate_HOME%/lib/required/hibernate-jpa-2.0-api-1.0.1.Final.jar
%Hibernate_HOME%/lib/required/javassist-3.18.1-GA.jar
%Hibernate_HOME%/lib/required/jboss-logging-3.1.0.GA.jar
%Hibernate_HOME%/lib/required/jboss-transaction-api_1.1_spec-1.0.1.Final.jar
%Hibernate_HOME%/lib/jpa/hibernate-entitymanager-4.2.7.Final.jar 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-23T04:36:28.030

我建议先学习使用**maven**或**gradle**，然后让它们帮助您设置依赖项。

在 Java 开发这样的日子里使用依赖管理工具是重要且有用的，所有知名的 Java 库都支持这种方式，并且也被推荐。

一本技术书可能很快就会过时，对于这种细节，官方文档永远是首选。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-01-06T12:45:43.633

如果使用 maven，请将此代码添加到您的 pom 文件中

```
 <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.0.1.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>4.2.0.Final</version>
    </dependency>        
    <dependency>
        <groupId>org.hibernate.common</groupId>
        <artifactId>hibernate-commons-annotations</artifactId>
        <version>4.0.1.Final</version>
        <classifier>tests</classifier>
    </dependency>
    <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <version>1.0.1.Final</version>
    </dependency>      
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>4.0.1.Final</version>
    </dependency>       
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.4</version>
    </dependency>
    <dependency>
        <groupId>org.jboss.logging</groupId>
        <artifactId>jboss-logging</artifactId>
        <version>3.1.0.CR2</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.6.4</version>
    </dependency> 
```

# html - 从 html 页面中提取元素

> ID：13978021
> 
> 赞同：1
> 
> 时间：2012-12-20T18:10:25.897
> 
> 标签：html, xml, phantomjs, scrape

我下载了一些 youtube 评论页面，我想从以下代码块中提取用户名（或用户显示名）和链接：

```
 <p class="metadata">
      <span class="author ">
        <a href="/channel/UCuoJ_C5xNTrdnc4motXPHIA" class="yt-uix-sessionlink yt-user-name " data-sessionlink="ei=CKG174zFqbQCFZmaIQodtmyE0A%3D%3D" dir="ltr">Sabil Muhammad</a>
      </span>
        <span class="time" dir="ltr">
          <a dir="ltr" href="http://www.youtube.com/comment?lc=S2ZH2gSPYaef43vTRkLDxUzo2fYicVUc3SFvmYq2jrs">
            il y a 1 jour
          </a>
        </span>
    </p> 
```

我想提取 /channel/UCuoJ_C5xNTrdnc4motXPHIA 和 Sabil Muhammad

html页面中当然有很多很多行，但我只想像上面那样专注于代码块并提取所有用户名和相应的链接，并将它们放入日志文件中

有什么好的脚本吗？我知道 bash 和 c/c++

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:13:54.673

如果你使用 jQuery，这很容易。但是，如果您使用 bash 或 c/c++ 执行此操作，则需要检索页面内容并解析您感兴趣的元素。您可以将元素视为 XML 并相当容易地解析属性。

您可以使用正则表达式或与子字符串匹配的简单文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:15:35.013

使用 awk（如果你擅长 bash），你可以逐行阅读页面并放置一个过滤器来捕获`<p class="metadata">`并开始复制并结束复制，如果你遇到`</p>`

然后处理提取的部分，依此类推......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:15:48.817

您可以使用[jQuery](http://jquery.com/)通过遍历所有 ' `metadata`' 类并提取您需要的内容来完成类似的事情：

```
//After including jQuery within your page
$(document).ready(function()
{
    //Iterates through each of the metadata tags
    $('.metadata').each(function()
    {
          //Pulls the username
          var username = $('.yt-user-name', this).text();
          //Pulls the link
          var link = $('.time a', this).attr('href');
          //Process each accordingly
          alert(username + ':' + link);
    });
}); 
```

**[工作示例](http://jsfiddle.net/AGNa6/3)**

# linux - 多线程程序核心转储上的系统负载

> ID：13978027
> 
> 赞同：1
> 
> 时间：2012-12-20T18:10:48.033
> 
> 标签：linux, multithreading, coredump

如果内存占用较大的程序转储内核，则需要一段时间并以 100% cpu 运行。如果我正在运行一个具有实时优先级的多线程程序并且它转储了核心，它是否会用完所有具有实时优先级的机器上的核心，而让其他所有东西都挨饿一段时间？如果是这样，有没有办法让核心转储只使用一个 cpu 而不会固定进程本身这样做？

# jquery - 如何更改所有 jQuery Mobile 文本的默认字体

> ID：13978029
> 
> 赞同：2
> 
> 时间：2012-12-20T18:10:58.233
> 
> 标签：jquery, html, css, jquery-mobile

我正在尝试覆盖整个网站的 jQuery 移动默认字体。

我已经看到有 jQuery 主题滚轮，但我认为添加整个主题只是为了更改字体有点过分。

css 中是否有一个选择器可以帮助我选择所有文本然后应用我的字体？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:29:45.003

# 解决方案

您可以像这样简单地设置它：

```
* {
    font: 14px Calibri,Arial !important;
} 
```

这是一个例子：

[http://jsfiddle.net/Gajotres/AzXdT/](http://jsfiddle.net/Gajotres/AzXdT/)

# 最后的笔记

如果您想了解更多关于如何自定义 jQuery Mobile 页面和小部件的信息，请查看这篇**[文章](http://www.gajotres.net/learn-how-to-customize-jquery-mobile-application/)**。它附带了许多工作示例，包括为什么 !important 对于 jQuery Mobile 是必需的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:13:48.370

您需要做的就是查看 jQuery Mobile CSS，找出字体当前设置的选择器，然后在您自己的 CSS 中覆盖该选择器的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-29T08:43:31.813

这些是我到目前为止找到的课程：

```
.ui-body-a, .ui-body-a input, .ui-body-a select, .ui-body-a textarea, .ui-body-a button, .ui-btn-up-a,
.ui-body-b, .ui-body-b input, .ui-body-b select, .ui-body-b textarea, .ui-body-b button, .ui-btn-up-b,
.ui-body-c, .ui-body-c input, .ui-body-c select, .ui-body-c textarea, .ui-body-c button, .ui-btn-up-c,
.ui-body-d, .ui-body-d input, .ui-body-d select, .ui-body-d textarea, .ui-body-d button, .ui-btn-up-d,
.ui-dialog > *, .ui-widget input 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T18:30:54.787

您需要在 jquery-mobile css 文件中找到以下行并对其进行修改以指定所需的字体。

```
.ui-body-a, .ui-body-a input, .ui-body-a select, .ui-body-a textarea, .ui-body-a button {
    font-family: Helvetica,Arial,sans-serif;
} 
```

如果您使用 -b、-c 等样式，您还需要修改它们

# wordpress - 当网站在 wordpress 中时，Fancybox 出现在页面底部

> ID：13978030
> 
> 赞同：0
> 
> 时间：2012-12-20T18:11:00.923
> 
> 标签：wordpress, fancybox

我最初建立了一个静态站点，现在正在将其转换为 wordpress 站点。你可以在[这里](http://training.mercury.stellarbluewebdesign.com/LittlestTumorFoundation/)找到它右栏中的最后一张图片，当点击时，应该打开一个花式框并播放视频。它在静态站点中运行良好，但由于某种原因，在 wordpress 中，该框出现在页面底部而不是中心。我很确定它正在查看 css，因为我可以单击链接并找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:40:30.607

这是您的页面验证的结果

[http://validator.w3.org/check?uri=http://training.mercury.stellarbluewebdesign.com/LittlestTumorFoundation/](http://validator.w3.org/check?uri=http://training.mercury.stellarbluewebdesign.com/LittlestTumorFoundation/)

**注意**评论：

```
Byte-Order Mark found in UTF-8 File.
The Unicode Byte-Order Mark (BOM) in UTF-8 encoded files
is known to cause problems for some text editors and older
browsers. 
```

另请注意

```
Line 1, Column 1: Non-space characters found without seeing a 
doctype first. Expected <!DOCTYPE html> 
```

在模式下通过编辑器传递您的代码`ansi`（并显示所有符号），这就是我得到的：

![在此处输入图像描述](../Images/27ca6e1f31b07ca210129ff668a6a54d.png)

文档中之前的那些隐藏字符`DOCTYPE`使您的浏览器在怪癖模式下运行，因此fancybox的意外行为（需要标准模式下的文档才能正常运行）

您需要做的是使用`UTF-8 without BOM`编码将您的 WP (php) 文件保存在编辑器中并再次上传它们（或者强制您的 ftp 软件以二进制模式上传）

# python - 使用 Elixir 创建生成式搜索

> ID：13978033
> 
> 赞同：0
> 
> 时间：2012-12-20T18:11:23.883
> 
> 标签：python, sqlalchemy, tornado, python-elixir

我一直在使用 Elixir，而且我目前有一种非常混乱的方式来搜索我想改进的数据库。该文档提供了有关如何进行基本生成搜索的见解，但我需要逐步完成许多不同的类，我更喜欢使用 Elixir 而不是自己浏览列表。

这是一个例子：

```
Class Student:
hobby = Field(String)
additional_info = OneToOne('AdditionalInformation', inverse='student')
user_profile = OneToOne('UserProfile', inverse='student')

Class AdditionalInformation:
 state = Field(String)
 city = Field(String)
 student = OneToOne('Student', inverse='additional_info')

Class UserProfile:
 username = Field(String)
 date_signed_up = Field(DateTime)
 student = OneToOne('Student', inverse = 'user_profile') 
```

在这个例子中，我想找到所有的学生：

1.  2008 年后注册
2.  来自加利福尼亚
3.  以“电子游戏”为爱好

我想应该有办法让我去：

```
result = UserProfile.query.filter_by(date_signed_up>2008)
result.query.filter_by(UserProfile.student.hobby='blabla')
result.query.... 
```

目前我正在将它们放入列表并寻找一组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:06:33.000

我没有用过 Elixir，但我用过 SQLAlchemy。鉴于当前的设置，我认为您无法做自己想做的事情。据我所知，没有办法直接按关系过滤。

目前尚不清楚您是在创建新表还是在处理现有表，因此我将向您提供一些信息，希望其中一些有用。

您可以在 SQLAlchemy 中将表连接在一起（假设 UserProfile 上有一个名为 student_id 的外键）。这将为您提供自 2008 年以来注册的所有学生。

```
result = Student.query.join(UserProfile).filter(Student.id==UserProfile.student_id).filter(UserProfile.date_signed_up>2008).all() 
```

您可以像我上面所做的那样将 .filter() 链接在一起，或者您可以将多个参数传递给它们。我发现这对于处理未知数量的过滤器特别有用，就像您从搜索表单中获得的一样。

```
conditions = [UserProfile.date_signed_up>2008] 

if something_is_true:
  conditions.append(UserProfile.username=="foo")

result = Student.query.join(UserProfile).filter(Student.id==UserProfile.student_id).filter(and_(*conditions)).all() 
```

您还可以使用混合属性执行更复杂的操作，但这在这里似乎不合适。

# vb.net - 获取TXT文件到Excel

> ID：13978036
> 
> 赞同：1
> 
> 时间：2012-12-20T18:11:34.523
> 
> 标签：vb.net

我有以下代码将文本文件获取到 Excel 工作簿。

```
 Dim XlApp As Excel.Application = New Excel.Application
    Dim XlWbk As Excel.Workbook = XlApp.Workbooks.Add
    Dim SheetName As String = "Sheet1"
    Dim XlWkst As Excel.Worksheet = FindSheet(XlWbk, SheetName)
    Dim XlRng As Excel.Range = Nothing

    If XlWkst Is Nothing Then
        XlWkst = DirectCast(XlWbk.Sheets.Add(After:=XlWbk.Sheets(XlWbk.Sheets.Count), _
        Count:=1, Type:=Excel.XlSheetType.xlWorksheet), Excel.Worksheet)
    End If

    Dim Lines() As String = File.ReadAllLines("C:\TEMP\FlowgateNNL_Mar2011_base.txt")
    Dim RC(Lines.Length - 1)() As String
    For I As Integer = 0 To Lines.Length - 1
        RC(I) = Lines(I).Split(CChar(vbTab))
    Next

    XlRng = XlWkst.Range("a1")
    XlRng.Value = RC

    XlApp.Visible = True 
```

这种方法似乎是读取和解析 CSV 文件以在我的计算机上转储到 Excel 的最快方法。它令人窒息`XlRng.Value = RC`。Excel 似乎不喜欢 RC。

让 Excel 接受数据的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:34:56.807

您正在将单元格的值设置为包含整个 CSV 的数组？我猜这会引发类型错误。这可能更符合您想要的。

```
 Dim XlApp As Excel.Application = New Excel.Application
    Dim XlWbk As Excel.Workbook = XlApp.Workbooks.Add
    Dim SheetName As String = "Sheet1"
    Dim XlWkst As Excel.Worksheet = FindSheet(XlWbk, SheetName)
    Dim XlRng As Excel.Range = Nothing

    If XlWkst Is Nothing Then
        XlWkst = DirectCast(XlWbk.Sheets.Add(After:=XlWbk.Sheets(XlWbk.Sheets.Count), _
        Count:=1, Type:=Excel.XlSheetType.xlWorksheet), Excel.Worksheet)
    End If

    Dim Lines() As String = File.ReadAllLines("C:\TEMP\FlowgateNNL_Mar2011_base.txt")

    For I As Integer = 0 To Lines.Length - 1
        XlRng = XlWkst.Range("a1").Offset(I, 0)
        Dim RC() As String = Lines(I).Split(CChar(vbTab))
        For J As Integer = 0 To RC.Length - 1
            XlRng = XlRng.Offset(0, J)
            XlRng.Value = RC(J)
        Next
    Next

    XlApp.Visible = True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-08T09:57:10.727

如果您有一个有效的 CSV 文件，请帮自己一个忙，并使用一个专门的 CSV 数据阅读器，它可以处理 CSV 的所有奇怪问题（引号等）。就我个人而言，我非常喜欢**[http://kbcsv.codeplex.com/](http://kbcsv.codeplex.com/)** - 它是使用简单且快速。

然后只需转储互操作部分并使用**EPPLUS**库将数据写入 excel 文件 - 它速度更快，而且简单得令人难以置信。您的工作流程如下所示：使用 KBCSV 将数据加载到数据表中。使用EPPLUS的方法“LoadFromDataTable”生成一个新的excel文件并保存。完毕！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-08T08:15:57.537

您是否尝试直接打开 CSV 文件，如下所示：

```
Dim XlApp As Excel.Application = New Excel.Application
Dim XlWbk As Excel.Workbook = XlApp.Workbooks.Open("C:\TEMP\FlowgateNNL_Mar2011_base.txt")
XlApp.Visible = True 
```

# mysql - codeigniter - 来自 mysql 表的甘特图报告

> ID：13978042
> 
> 赞同：1
> 
> 时间：2012-12-20T18:11:50.907
> 
> 标签：mysql, codeigniter, foreach, timeline, gantt-chart

我想用从mysql表到我的ci-view的数据生成一些甘特报告（在html表内）。视图应该是这样的：

```
| name  | week#1 | week#2 | week#3 | week#4 |

| wawan |    200 |    340 |      0 |    100 |

| wewe  |    210 |    340 |    120 |    100 |

| elias |    200 |    360 |      0 |    170 | 
```

*   周与字段“周”不同。
*   名称与字段“用户”不同。
*   数字是 x 周内用户为“姓名”的表中的 sum(qtyfield)

我已经尝试过这种方法，但数字（“数量”字段的总和）不会显示：

1.  将周行获取到 foreach 循环内的表头块 -> 完成。

2.  将名称行提取到 foreach 循环内的表行块 -> 完成。

3.  sum(qty) 是基于表行中的名称和表头中的周的查询->？

知道怎么做吗？语法帮助或只是逻辑思想表示赞赏..在此先感谢..

# python - 处理属性的名称和值

> ID：13978049
> 
> 赞同：3
> 
> 时间：2012-12-20T18:12:13.553
> 
> 标签：python, attributes

我可能正在接近这个错误，但希望能被理顺。

我希望能够同时使用类的某些属性的值和名称

样本：

```
class DoStuff(object):
    def __init__(self):
        self.a="Alpha"
        self.b="Beta"
        self.c="Gamma"
    def printStuff(self):
        for thing in [self.a, self.b, self.c]:
            print NAMEOFTHING, thing 
```

我想要的是：

> ```
> a Alpha
> b Beta
> c Gamma 
> ```

我怎么能得到那个？

编辑：有些混乱，因为我的示例显示我打印所有值。相反，我想要这个：

> ```
> a Alpha
> c Gamma 
> ```

我的打印方法的列表中只有“a”和“c”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T18:17:24.323

您的类和`for`循环的设置方式，没有什么可以代替您`NAMEOFTHING`获取这些变量的名称。以下是一些关于如何修改方法的替代方法：

*   使用字典而不是单个属性，然后在`for`循环中提供键列表：

    ```
    class DoStuff(object):
        def __init__(self):
            self.names = {"a": "Alpha",
                          "b": "Beta",
                          "c": "Gamma"}
        def printStuff(self):
            for name in ['a', 'b', 'c']:
                print name, self.names[name] 
    ```

*   使用列表中的属性名称，然后使用`getattr()`：

    ```
    class DoStuff(object):
        def __init__(self):
            self.a="Alpha"
            self.b="Beta"
            self.c="Gamma"
        def printStuff(self):
            for name in ['a', 'b', 'c']:
                print name, getattr(self, name) 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T18:13:56.960

你能得到的最接近的是：

```
for thing in ['a', 'b', 'c']:
    print thing, getattr(self, thing) 
```

变量可以有多个名称并且不知道它们自己的名称，因此如果您知道它是“a”，那么您可以使用它`getattr`来解析查找。

另一种选择（虽然与上面没有太大不同）

```
to_get = ['a', 'b', 'c']
from operator import attrgetter
blah = zip(to_get, attrgetter(*to_get)(self)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T18:54:37.433

按照 Jon 的回答，您可能还会发现将要包含在输出中的属性列表设置为可选参数很有帮助：

```
def printStuff(self, included=['a', 'c']):
    for thing in included:
        print thing, getattr(self, thing) 
```

这可以很容易地生成*两个*输出，`DoStuff().printStuff()`只需获取 和 的值`a`，`c`或者`DoStuff().printStuff(['a', 'b', 'c'])`获取所有三个值。当然，这*允许*不同的输出——如果明确的设计目标是打印的字段集是不变的，那么这将适得其反。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T18:21:56.890

```
# You can use __dict__
>>> class x:
>>>     def __init__(self):
>>>         self.a = 1
>>>         self.b = 2
>>>         self.c = 3
>>>         self.d = 4

>>>     def prnt(self):
>>>         limit = "b", "c"
>>>         return {k:v for (k, v) in self.__dict__.iteritems()if k in limit}

>>> r = x()
>>> print r.prnt()
    {'b': 2, 'c': 3}

# __dict__ can be also done outside the class

limit = "b", "c"
print {k:v for (k, v) in r.__dict__.iteritems()if k in limit} 
```

# java - eclipse 为 WSDL 客户端使用哪个代码生成器？

> ID：13978050
> 
> 赞同：2
> 
> 时间：2012-12-20T18:12:22.697
> 
> 标签：java, eclipse, wsdl, code-generation

我总是在 WSDL 文件上使用 Eclipse 中的右键菜单由 SOAP 客户端生成。今天我面临一个问题，我认为我可以通过稍微参数化一代来解决它。

这是我正在谈论的用户界面： ![在此处输入图像描述](../Images/df4c8fa992f96e9ae319b8650237fa1c.png)

eclipse为此工具使用哪个生成器？

# macos - Qt OSX 不正确的鼠标行为

> ID：13978051
> 
> 赞同：0
> 
> 时间：2012-12-20T18:12:25.647
> 
> 标签：macos, qt, opengl, opencv, user-interface

我的应用程序使用 OpenCV、OpenGL 和 Qt 来显示网络摄像头源。它在 Ubuntu 上完美运行（单击按钮正常工作），但在 OSX 上似乎存在 UI 问题。窗口显示，但我无法单击，我很快就得到了正在加载的旋转风车，它不会停止，直到我强制退出应用程序。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:00:16.687

我通过在我的 gui 小部件的初始化中添加一个计时器来解决这个问题：

```
m_timer = new QTimer();
connect(m_timer, SIGNAL(timeout()), this, SLOT(gotNewImage()));
m_timer->start(1); 
```

其中 gotNewImage() 是我调用以获取新图像的函数。

# clojure - lein-autodoc 与 Leiningen 2

> ID：13978057
> 
> 赞同：2
> 
> 时间：2012-12-20T18:13:22.370
> 
> 标签：clojure, leiningen, autodoc

我正在尝试使用[lein-autodoc](https://github.com/tomfaulhaber/lein-autodoc)，因为我相信它是 Clojure 的首选文档生成器。我已`:dev-dependencies [[lein-autodoc "0.9.0"]]`按照 lein-autodoc github 页面上的说明添加到我的项目定义中。

运行`lein deps`没有问题，但是`lein autodoc`失败，声称 autodoc 不是任务。

我怀疑问题是 lein-autodoc 设置为与 leiningen 1 一起使用。但是，我使用的是 leiningen 2。我应该用 autodoc 调用 lein 的另一种方法吗？或者 lein-autodoc 包没有设置为与 lein 2 一起使用？如果没有，是否有另一个首选的与 lein2 兼容的文档生成选项？

**编辑：**

在 Cubic 下面的提示之后，我创建`~/.lein/profiles.clj`如下：

```
{:user {:plugins [[lein-autodoc "0.9.0"]]}} 
```

现在，运行`lein autodoc`结果如下：

```
$ lein autodoc
Exception in thread "main" java.lang.IllegalAccessError: sh does not exist
    at clojure.core$refer.doInvoke(core.clj:3778)
    at clojure.lang.RestFn.applyTo(RestFn.java:139)
    at clojure.core$apply.invoke(core.clj:603)
    at clojure.core$load_lib.doInvoke(core.clj:5279)
    at clojure.lang.RestFn.applyTo(RestFn.java:142)
    at clojure.core$apply.invoke(core.clj:603)
    at clojure.core$load_libs.doInvoke(core.clj:5298)
    (...) 
```

这表明 autodoc 可能与 Lein 2 不兼容？如果没有，是否有任何适用于 Lein 2 的文档系统？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T21:45:30.757

autodoc 曾经是更常见的文档生成器，但如今它主要仅用于 Clojure 本身（并且针对任务进行了优化）。我强烈建议您改用[codox](http://github.com/weavejester/codox)。它非常好。你可以在我自己的一个项目中看到它在[这里](http://raynes.github.com/laser/)

（我知道这在另一个答案中已经说过，但是为了让我的答案完整，我还是需要添加它）

此外，在 leiningen 2 中没有`:dev-dependencies`钥匙。相反，有一个`:dev`配置文件。查看 Leiningen 个人资料文档以获取更多信息。在这种情况下，您需要做的就是`:plugins`使用您想要的插件（如 codox、autodoc 等）为您的项目或全局用户配置文件添加一个密钥。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T21:12:30.387

lein 2中没有`:dev-dependencies`，您必须使用[profiles](https://github.com/technomancy/leiningen/blob/master/doc/PROFILES.md)来完成。

我不确定 autodoc 是否真的适用于 lein 2。请记住，clojure 和它的环境发展得非常快，而且那里有很多过时的信息。

# android - 我可以在 Android 中有全局缓冲区吗？其他进程可以在哪里进行通信，甚至可以从本机 C++ 代码进行通信

> ID：13978060
> 
> 赞同：0
> 
> 时间：2012-12-20T18:13:38.103
> 
> 标签：android, c++, message

我知道我们可以使用 Intents 或 Binder 或 AIDL 进行通信，但是我可以在 Android 中使用全局缓冲区吗？其他进程可以进行通信，甚至可以从本机 C++ 代码进行通信。它更像是从我的应用程序中的不同进程/服务接收消息。

欢迎提出建议:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T18:20:35.407

是的，它被称为文件。并且由于 Android 2.3+ 使用 Ext4，延迟分配将大大减少所需的物理访问次数。

一个稍微棘手的解决方案是`/dev/ashmem/`，它可能会在内存压力的情况下丢失，因为它只是在 RAM 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:40:29.697

一个充当“服务器”并为其提供套接字连接以访问其缓冲区的服务怎么样？

# android - Vertical ViewPager - 垂直浏览片段

> ID：13978063
> 
> 赞同：2
> 
> 时间：2012-12-20T18:13:50.360
> 
> 标签：android, android-viewpager, swipe

我想在我的应用程序中实现一个 Viewpager，它不会水平滑动片段（有时称为滑动视图）而是垂直滑动。是否有已经涵盖此的实现？我可以以某种方式扩展 ViewPager 以实现此效果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:32:06.403

Jack Wharton有一个[图书馆](https://github.com/JakeWharton/Android-DirectionalViewPager)`Android DirectionalViewPager`。

> 兼容性库 ViewPager 类的实现，该类支持 > 垂直和水平分页以及在运行时在两者之间进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T13:31:42.710

当您按下主页按钮时，DirectionalViewPager 出现问题，它将在那里显示“无法暂停活动”NullPointerException。我在 DirectionalViewPager 中添加`super.setAdapter(adapter);`，`setAdapter(PagerAdapter adapter)`到目前为止一切都很好......

当我尝试使用新的 android.support.v4.jar 并从 DirectionalViewPager进行一些[快速修复时，发现了更多问题](https://github.com/readwise/Android-DirectionalViewPager)

# php - 循环遍历 JSON NSDictionary

> ID：13978071
> 
> 赞同：1
> 
> 时间：2012-12-20T18:14:04.447
> 
> 标签：php, ios, json, nsarray, nsdictionary

我正在尝试使用 JSON 格式的 PHP 打印 MySQL 结果集，并使用 iOS 读取它。

这是我的**JSON 字符串**：

```
[{"partnerid":"1","code":"SUMU6003","partnerName":"Company name","street":"Some Street 5323","zipCode":"8732","city":"Berlin","languages":"English","workers":"Name 1, Name 2","lineup":"Kids"},{"partnerid":"2","code":"DEMO8884","partnerName":"Partner 2","street":"Third street 2","zipCode":"383838","city":"Berlin","languages":"Greek","workers":"Petra","lineup":"Kids"}] 
```

在这种**方法**中，我得到`NSDictionary`：

```
#pragma mark - ServiceConnectorDelegate -

-(void)requestReturnedData:(NSData *)data { 
    NSDictionary *dictionary = [NSDictionary dictionaryWithJSONData:data];
    # process dictionary and grep strings from json-string
    # ...
} 
```

你能告诉我如何在循环中访问不同的结果集吗？我想分别访问每个键。

我知道`NSDictionary`包含数据，因为`NSLog(@"%@",dictionary);`打印：

```
2012-12-20 19:13:20.661 myapp[576:907] (
        {
        city = Berlin;
        code = SUMU6003;
        languages = English;
        lineup = Kids;
        partnerName = "Company name";
        partnerid = 1;
        street = "Some Street 5323";
        workers = "Name 1, Name 2";
        zipCode = 8732;
    },
        {
        city = Berlin;
        code = DEMO8884;
        languages = Greek;
        lineup = Kids;
        partnerName = "Partner 2";
        partnerid = 2;
        street = "Third street 2";
        workers = Petra;
        zipCode = 383838;
    }
) 
```

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:22:03.613

有时内省在这里很有用。例如 NSLog(@"dictionary is of type: %@", [dictionary class]);

我之所以这么说是基于您的输出，看来字典实​​际上是一个包含两个 NSDictionaries 的数组。如果是这种情况，你会想要做这样的事情：

```
for (NSDictionary *actualDictionary in dictionary<this is really an array>)
{
  NSString *myStringValue = [actualDictionary objectForKey:@"city"];
  // etc...
} 
```

不过，您必须首先找出您实际处理的数据类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:23:36.540

做这个：

`#import <objc/runtime.h>`

`NSLog(@"The class name is %s", object_getClassName(dictionary);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T20:46:00.227

您拥有的响应字典包含**字典数组，**因此您可以通过快速枚举字典来运行字典值并将每个字典转换为字典并获取其值，如下所示：

```
-(void)requestReturnedData:(NSData *)data { 
    NSDictionary *dictionary = [NSDictionary dictionaryWithJSONData:data];
    # process dictionary and grep strings from json-string
    for(id item in dictionary ) 
    {
        NSDictionary *dic = (NSDictionary *)item;
        NSLog(@"%@",[dic objectForKey:@"city"]);
        NSLog(@"%@",[dic objectForKey:@"code"]);
        ......
    }
 } 
```

# ruby-on-rails - 无论何时 rake 任务调度

> ID：13978076
> 
> 赞同：2
> 
> 时间：2012-12-20T18:14:23.587
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, whenever

您好，我试图使用when gem 使用此计划代码每5 分钟运行一次rake 任务

```
set :output, "#{path}/log/cron.log"

every 10.minutes do
  rake "delete:old_offers"
end 
```

但是代码永远不会执行。如果我尝试使用以下方式运行我的任务：

> 耙删除：old_offers

一切正常，所以问题出在计划文件中。请我需要你的帮助来解决这个问题。

我计划在我的 heroku 应用程序中每 60 天执行一次这个任务，所以我可以在 heroku 上也可以工作。

提前致谢。

* * *

更新

对不起伙计们，我必须像这样设置开发环境

```
set :environment, 'development' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:22:38.123

编写日程表后，您需要实际更新您的 crontab：

```
whenever --update-crontab 
```

简单地单独运行`whenever`命令只会以 cron 格式显示计划。

# api - 保护子域上的 API - 用户使用 OAuth 提供程序登录

> ID：13978077
> 
> 赞同：2
> 
> 时间：2012-12-20T18:14:30.937
> 
> 标签：api, asp.net-mvc-4, dotnetopenauth

我有一个 MVC 4 网站 (http://myWebsite.com)，它使用一些 OAuth 提供程序（Google、Facebook、Twitter、MS Live）供用户登录 - 它使用 DotNetOpenAuth 库。

我在子域 (http://api.myWebsite.com) 上也有一个 API。

当用户想要更新记录时，我需要检查他们是否有权（被授权）来更改记录。

所以问题是，如何最好地在子域上的 API 上授权用户？

到目前为止，我的想法包括以下内容：

我可以将用户的身份验证令牌添加到 HTTP 请求标头中的 API，然后我相信我有两个选择。

i）我在网站上创建了一个方法来处理所有用户权限并将令牌发送给它并询问用户是否被授权。

ii) 我将 DotNetOpenAuth dll 添加到 API 解决方案中，然后可以简单地使用访问它们所需的角色来装饰 API 方法。这行得通吗？

第三种选择是将更新的记录发布回网站并对其运行授权，然后如果它通过将数据发送到 API，但这似乎有异味。

我确定我在这里遗漏了一些明显的东西，因此发布了这篇文章。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T01:29:26.477

您的用户登录方式与您授权其他客户端调用您的 API 子域的方式完全正交。不要*只*在您的 API 中接受身份验证令牌——身份验证被滥用为授权，会带来很大的安全漏洞。

授权客户端调用您的 API 需要一个授权协议，例如 OAuth 1 或 2，DotNetOpenAuth 都支持这两种协议。查看 DNOA OAuthAuthorizationServer 和 OAuthResourceServer 示例，开始为您的 API 添加 OAuth 2 支持。

# c++ - std::regex_replace 给了我意想不到的结果

> ID：13978080
> 
> 赞同：2
> 
> 时间：2012-12-20T18:14:48.410
> 
> 标签：c++, regex, windows, c++11

我`std::regex_replace`在 C++ Windows 项目（Visual Studio 2010）中使用。代码如下所示：

```
std::string str("http://www.wikipedia.org/");
std::regex fromRegex("http://([^@:/]+\\.)?wik(ipedia|imedia)\\.org/", std::regex_constants::icase);
std::string fmt("https://$1wik$2.org/");
std::string result = std::regex_replace(str, fromRegex, fmt); 
```

我希望`result`是`"https://www.wikipedia.org/"`，但我得到了`"https://www.wikipedia.wikipedia.org/"`。

快速检查`sed`给了我预期的结果

```
$ cat > test.txt
http://www.wikipedia.org/
$ sed 's/http:\/\/([^@:\/]+\.)?wik(ipedia|imedia)\.org\//https:\/\/$1wik$2.org\//' test.txt
http://www.wikipedia.org/ 
```

我不明白差异来自哪里。我检查了可以与 一起使用的标志`std::regex_replace`，我没有看到在这种情况下会有所帮助的标志。

**更新**

这些变体工作正常：

```
std::regex fromRegex("http://([^@:/]+\\.)wik(ipedia|imedia)\\.org/", std::regex_constants::icase);
std::regex fromRegex("http://((?:[^@:/]+\\.)?)wik(ipedia|imedia)\\.org/", std::regex_constants::icase);
std::regex fromRegex("http://([a-z]+\\.)?wik(ipedia|imedia)\\.org/", std::regex_constants::icase);
std::regex fromRegex("http://([^a]+\\.)?wik(ipedia|imedia)\\.org/", std::regex_constants::icase); 
```

但不是这些：

```
std::regex fromRegex("http://([^1-9]+\\.)?wik(ipedia|imedia)\\.org/", std::regex_constants::icase);
std::regex fromRegex("http://([^@]+\\.)?wik(ipedia|imedia)\\.org/", std::regex_constants::icase);
std::regex fromRegex("http://([^:]+\\.)?wik(ipedia|imedia)\\.org/", std::regex_constants::icase); 
```

对我来说完全是无稽之谈...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:39:47.073

正则表达式中有一个细微的错误。不要忘记字符串文字中的转义序列是由编译器扩展的。所以改变

```
"http://([^@:/]+\.)?wik(ipedia|imedia)\.org/" 
```

至

```
"http://([^@:/]+\\.)?wik(ipedia|imedia)\\.org/" 
```

也就是说，用一对反斜杠替换两个单反斜杠中的每一个。

编辑：不过，这似乎不会影响问题。在我尝试的两个实现（Microsoft 和 clang）上，没有出现原始问题，我们没有双反斜杠。（如果没有，您会收到有关无效转义序列的编译器警告，但生成的`.`通配符与`.`目标序列中的字符匹配，就像`\.`会一样）

# actionscript-3 - 我似乎在运行这部分游戏时出错。除了它是一个逻辑错误并且不会出现在编译器中

> ID：13978085
> 
> 赞同：0
> 
> 时间：2012-12-20T18:15:13.620
> 
> 标签：actionscript-3, flash

**这部分编码用于塔防游戏中的炮塔。截至目前，它没有出现，如果有人看到错误帮助将不胜感激。**

```
 package 
    {
        import flash.display.MovieClip;
        import flash.events.*;
        public class Turret extends MovieClip
        {
            private var _root:MovieClip;

            public function Turret()
            {
                this.addEventListener(Event.ADDED, beginClass);
                this.addEventListener(Event.ENTER_FRAME, eFrameEvents);
            }
            private function beginClass(e:Event):void
**//Where I make the turret itself**            
{
                _root = MovieClip(root);
                this.graphics.beginFill(0xFFD700);
                this.graphics.drawCircle(0,0,12.5);
                this.graphics.endFill();
                this.graphics.beginFill(0xFFD700);
                this.graphics.drawRect(-2.5, 0, 5, 20);
                this.graphics.endFill();
            }
            private function eFrameEvents(e:Event):void
            {

                if (_root.gameOver)
                {
                    this.removeEventListener(Event.ENTER_FRAME, eFrameEvents);
                    MovieClip(this.parent).removeChild(this);
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:31:45.410

在函数之前放置注释的地方存在语法错误。去掉前面的星号...

```
...
private function beginClass(e:Event):void
//Where I make the turret itself            
{
    _root = MovieClip(root);
    ... 
```

# java - Java Regex：检查 URL 是否属于 facebook 个人资料或页面

> ID：13978090
> 
> 赞同：4
> 
> 时间：2012-12-20T18:15:40.097
> 
> 标签：java, regex

我想检查字符串是否是使用 java regex 的 facebook 的 URL。
例如：facebook.com/username

如果它使用协议 http 或 https
[http://www.facebook.com/xyz](http://www.facebook.com/xyz)
[https://www.facebook.com/xyz ，它也应该匹配](https://www.facebook.com/xyz)

或没有协议也
www.facebook.com/xyz

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-20T18:17:48.433

我不会使用正则表达式，创建一个新[URL](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html)并使用[getHost](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#getHost%28%29)获取主机名并检查它是否适合您。（也可以查看其他网址信息）

```
if (!urlString.startsWith("http")) {
    urlString = "http://" + urlString;
}
String hostname = new URL(urlString).getHost(); 
```

如果您坚持使用正则表达式，您可以使用以下内容：

```
String regex = "((http|https)://)?(www[.])?facebook.com/.+";
someURL.matches(regex); 
```

应该匹配`http`/`https`有或没有的任何组合`www`

# magento - 产品平面数据错误 - PHP 致命错误：在非对象上调用成员函数 reindexAll()

> ID：13978097
> 
> 赞同：0
> 
> 时间：2012-12-20T18:16:15.633
> 
> 标签：magento, indexing

由于 Magento 安装中的属性数量，我遇到了 MySQL 中的行限制问题，因此我将扩展“Mage_Catalog_Model_Resource_Product_Flat_Indexer”类的扩展名放在一起，使用以下代码将字符限制重写为 64。

```
protected function _MySQLCharLimit()
{
    if (!$this->_isFlatTableExists($store)) {

        $sql = "CREATE TABLE {$tableNameQuote} (n";

        foreach ( $columns as $field => $fieldProp ) {
            if ( $fieldProp['type'] == "varchar(255)" )
            $fieldProp['type'] = "varchar(64)";
                $sql .= sprintf( "  %s,n",
                $this->_sqlColunmDefinition( $field, $fieldProp ) );
        }
        foreach ($addIndexes as $indexName => $indexProp) {
            $sql .= sprintf(' ADD %s,',
            $this->_sqlIndexDefinition( $indexName, $indexProp ) );
        }
        $sql = rtrim($sql, ",");
        $sql = str_replace( "varchar(255)","varchar(64)",$sql );
        $this->_getWriteAdapter()->query( $sql );
    }
} 
```

我从这里得到的[http://www.sonassi.com/knowledge-base/magento-kb/mysql-limitations-on-the-flat-catalogue-in-magento/](http://www.sonassi.com/knowledge-base/magento-kb/mysql-limitations-on-the-flat-catalogue-in-magento/)。

在尝试重新索引后，我注意到它把我送到了一个空白页面，当我点击返回时，“产品平面数据”索引卡在处理中。

我通过 SSH 从“shell”文件夹运行 indexer.php，它报告了这个错误：

PHP 致命错误：在第 296 行的 Mage/Catalog/Model/Product/Flat/Indexer.php 中的非对象上调用成员函数 reindexAll()

有没有人知道出了什么问题或我该如何纠正这个问题？谢谢。

**编辑：**完整代码

```
<?php
class GDModules_MySQLCharLimit_Catalog_Model_Resource_Product_Flat_Indexer extends Mage_Catalog_Model_Resource_Product_Flat_Indexer
{
    public function mySQLCharLimit()
    {
        if (!$this->_isFlatTableExists($store)) {

            $sql = "CREATE TABLE {$tableNameQuote} (n";

            foreach ( $columns as $field => $fieldProp ) {
                if ( $fieldProp['type'] == "varchar(255)" )
                $fieldProp['type'] = "varchar(64)";
                    $sql .= sprintf( "  %s,n",
                    $this->_sqlColunmDefinition( $field, $fieldProp ) );
            }
            foreach ($addIndexes as $indexName => $indexProp) {
                $sql .= sprintf(' ADD %s,',
                $this->_sqlIndexDefinition( $indexName, $indexProp ) );
            }
            $sql = rtrim($sql, ",");
            $sql = str_replace( "varchar(255)","varchar(64)",$sql );
            $this->_getWriteAdapter()->query( $sql );
        }
    }
} 
```

**XML**

```
<?xml version="1.0" encoding="UTF-8"?>

<!-- The root node for Magento module configuration -->
<config>

    <!--
    The module's node contains basic
    information about each Magento module
    -->
    <modules>

        <!--
        This must exactly match the namespace and module's folder
        names, with directory separators replaced by underscores
        -->
        <GDModules_MySQLCharLimit>

            <!-- The version of our module, starting at 0.0.1 -->
            <version>0.0.1</version>
        </GDModules_MySQLCharLimit>
    </modules>

    <!-- Configure our module's behaviour in the global scope -->
    <global>
        <!-- Defining models -->
        <models>
            <catalog_resource>
                <rewrite>
                    <product_flat_indexer>GDModules_MySQLCharLimit_Catalog_Model_Resource_Product_Flat_Indexer</product_flat_indexer>
                </rewrite>
            </catalog_resource>
        </models>
    </global>
</config> 
```

# htmlunit - HtmlUnit 禁止外部请求

> ID：13978098
> 
> 赞同：2
> 
> 时间：2012-12-20T18:16:16.410
> 
> 标签：htmlunit

我使用 HtmlUnit 对我的站点进行自动化测试。我的站点使用 gmaps api - 发送外部站点请求需要花费大量时间（我有数百个测试和数千个页面加载）。

我需要一些方法来告诉 HtmlUnit 只加载本地页面（存储在 IIS express 中），并禁止加载外部资源以使我的测试运行得更快。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T02:49:08.303

您可以阻止 HTMLUnit 使用 as 访问某些 URL `WebConnectionWrapper`：

```
browser.setWebConnection(new WebConnectionWrapper(browser) {
  @Override
  public WebResponse getResponse(final WebRequest request) throws IOException {
    if (<<CONDITION HERE(such as `request.getUrl().toString().contains("uq.edu.au")`)>>) {
      return super.getResponse(request);
    } else {
      return new StringWebResponse("", request.getUrl());
    }
  }
}); 
```

除非您需要测试它们，否则您可能需要考虑禁用 JavaScript 和 CSS 等项目，我发现这也可以加快速度。

# python - 即使发生错误，Python subprocess.Popen.wait() 也会返回 0

> ID：13978101
> 
> 赞同：6
> 
> 时间：2012-12-20T18:16:17.523
> 
> 标签：python, command-line, error-handling, subprocess, return-value

我正在通过 Python 的子进程模块运行命令行实用程序。我使用命令行参数和 stdout=subprocess.PIPE 创建了一个 subprocess.Popen() 对象，然后我使用 subprocess.wait() 等待任务完成并返回应该指示任务是否成功完成的返回码.

```
translate = subprocess.Popen(['gdal_translate', '-of', 'HFA', 'inDataset', 'outDataset'], stdout=subprocess.PIPE)
if translate.wait() == 0: print "Success"
else: print "Fail - %s" % translate.stdout.read() 
```

如果我在 windows 命令提示符下运行我的脚本，我可以看到 gdal_translate 提供的消息，他们说存在导致进程失败的错误，但我的脚本仍然打印“成功”。

如果返回码始终为 0，如何检查命令行实用程序报告的错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T19:42:50.767

您可能会输出错误但返回码仍然为零。在您的代码中，您只捕获标准输出而不是标准错误。在下面的run函数中会运行一条命令，等待执行结束，然后读取returncode标准错误和标准输出。如果标准错误中有任何内容或返回码不为零，那么它将视为失败。您可以在代码中看到四个示例调用。第一个是正常的成功调用，第二个返回代码为 0，但有错误输出和标准输出。第三个有一个非零返回码和错误输出，而最后一个例子有一个非零返回码，根本没有输出。

**代码**

```
from subprocess import Popen, PIPE

def run(cmd):
    print '-'*40
    print 'running:', cmd
    p = Popen(cmd, stderr=PIPE, stdout=PIPE, shell=True)
    output, errors = p.communicate()
    print [p.returncode, errors, output]
    if p.returncode or errors:
        print 'something went wrong...'

run("echo all is well")
run("echo out;echo error 1>&2")
run("this-will-fail")
run("exit 1") 
```

**输出**

```
----------------------------------------
running: echo all is well
[0, '', 'all is well\n']
----------------------------------------
running: echo out;echo error 1>&2
[0, 'error\n', 'out\n']
something went wrong...
----------------------------------------
running: this-will-fail
[127, '/bin/sh: this-will-fail: not found\n', '']
something went wrong...
----------------------------------------
running: exit 1
[1, '', '']
something went wrong... 
```

# heroku - 在 Heroku 上运行 Dart 应用程序

> ID：13978103
> 
> 赞同：2
> 
> 时间：2012-12-20T18:16:24.030
> 
> 标签：heroku, dart

我正在关注[此博客](http://blog.sethladd.com/2012/08/running-dart-in-cloud-with-heroku.html)以将 Dart 应用程序上传到 Heroku 并运行它。我已经到了应用程序成功部署到 Heroku 的地步，但应用程序没有运行。以下来自 Heroku 日志：

```
2012-12-20T18:04:57+00:00 heroku[web.1]: Starting process with command `dart TestApp.dart`
2012-12-20T18:04:57+00:00 app[web.1]: bash: dart: command not found
2012-12-20T18:04:58+00:00 heroku[web.1]: Process exited with status 127
2012-12-20T18:04:58+00:00 heroku[web.1]: State changed from starting to crashed 
```

以下是我的内容`Procfile`

```
web: dart TestApp.dart 
```

谁能指出我解决此错误的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T20:04:00.247

您应该忘记将*buildpack*添加到配置中。请参阅[Heroku Buildpack for Dart 的入门](https://github.com/igrigorik/heroku-buildpack-dart#getting-started)。

基本上，您必须使用以下命令：

```
$> heroku create myapp_name -s cedar
$> heroku config:add BUILDPACK_URL=https://github.com/igrigorik/heroku-buildpack-dart.git 
```

**警告**：在最新版本的 buildpack 中，命令似乎`dart`不再存在于`PATH`. 一种解决方法是使用完整路径`Procfile`：

```
web: ./dart-sdk/bin/dart TestApp.dart 
```

# ios - 根据其他字段的值有条件地从字典中检索字段

> ID：13978106
> 
> 赞同：-1
> 
> 时间：2012-12-20T18:16:48.173
> 
> 标签：ios, nsarray, compare, nsdictionary

> **可能重复：**
> [迭代实体数组并根据“其他键”匹配的值获取某个键的值](https://stackoverflow.com/questions/13975702/iterar-over-array-of-entity-and-get-value-of-some-key-based-on-value-of-other-k)

`salary`拜托，如果状态字段不为空，任何人都可以给我一个提示或提示，告诉我如何获取字典中所有字段的值吗？我只想`salary`从字典 where 中的那些对象中检索字段`status != null`。请注意，我的字典是动态的，这意味着我可能有四个以上的条目。非常感谢任何帮助或提示。先感谢您。

```
myArray=(
        {
        Name = "john1";
        Address = "san diego";
        Status = "active";
        salary = "100;

    },
        {
        Name = "steve ";
        Address = "birmingham";
        Status = "<null>";
        salary = "100;
    },
        {
         Name = "allan";
        Address = "san diego";
        Status = "active";
        salary = "100;
    },

     {
         Name = "peter";
        Address = "san diego";
        Status = "<null>";
        salary = "100;
    },
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:25:52.353

尝试快速枚举...

```
NSMutableArray* retreivedSalaries;

for (NSDictionary* dict in myArray) {
    if (![[dict objectForKey:@"Status"] isEqualToString:@"<null>"])
        [retreivedSalaries addObject:[dict objectForKey:@"salary"]];
 }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:27:17.373

我没有测试，所以你可能需要改变这个

```
for (int i=0;i< [myArray count];i++)
{
    if ([[[myArray objectAtIndex: i] objectForKey: @"Status"] isEqualToString: @"active"]) {

       NSLog(@"Salary is %@",[myArray objectAtIndex: i] objectForKey: @"salary"] )
    } else {
        NSLog(@"Status is not active");
    }
} 
```

或者你可以使用这样的东西

```
 for (NSDictionary *salary in myArray)
    {
        if([message valueForKey:@"Status"] isEqualToString: @"active")
           NSLog(@"Salary is %@",[message valueForKey:@"salary"]);      

    } 
```

**排序工资**

*您可以对键进行排序，然后通过迭代它们来创建 NSMutableArray。* [从这里回答](https://stackoverflow.com/questions/3583020/can-i-sort-the-nsdictionary-on-basis-of-key-in-objective-c)

```
NSArray *sortedKeys = [[myArray allKeys] sortedArrayUsingSelector: @selector(compare:)];
NSMutableArray *sortedValues = [NSMutableArray array];
for (NSString *key in sortedKeys)
    [sortedValues addObject: [myArray objectForKey: key]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:27:37.247

尝试这个：

```
 NSDictionary *salaries = nil;
  NSArray *myArray .... ;

for (NSString * salary in salaries) {

    if ([myArray containsObject:@"salary"]) {

        if ([salaries objectForKey:@"salary"] != NULL) {

            NSLog (@"do something with salary: %@", salary);
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T18:49:56.050

我认为这是 iOS，myArray 是一个 NSArray，每个人的信息都是一个 NSDictionary，如果这是重点，您可以执行以下操作：

```
for (NSDictionary *info in myArray) {

    if ([info objectForKey:@"Status"] != nil && ![[info objectForKey:@"Status"] isEqual:@"<null>") {
        // Store salary whatever you need and in the formar you need
        NSString *salary = [info objectForKey:@"salary"]; 
    }

} 
```

我在没有编译器的情况下编写了代码，所以可能存在一些编译器错误（抱歉）。如果我很好地理解了您的问题，那么您可以在 Status 不为空时获得薪水。

希望有帮助！

# html - 重置单选框和复选框的样式，但保留其他输入样式

> ID：13978108
> 
> 赞同：3
> 
> 时间：2012-12-20T18:17:02.337
> 
> 标签：html, css

创建了几个表单，我按照我希望它们的外观设置了文本输入和文本区域的样式。我现在开始使用单选按钮和复选框，它们自然继承了其他输入的样式。

有没有办法重置它并将它们恢复为默认样式？我从来没有真正遇到过这个问题。仅寻找 css 或 html 解决方案。

这是正在发生的事情的图片：http: [//i.imgur.com/pAic3.jpg](http://i.imgur.com/pAic3.jpg)

这是我的相关CSS

```
/* style drop down box */
#panel_body select {
    width:243px;
    height:40px;
    border:1px solid #9b9b9b;
    border-radius:8px;
}

/* style input elements */
#panel_body input, #panel_body textarea {
    width:243px;
    height:40px;
    border:1px solid #9b9b9b;
    border-radius:8px;
    background: -webkit-linear-gradient(top, #ffffff, #adadad);
    background: -moz-linear-gradient(top, #ffffff, #adadad);
    background: -o-linear-gradient(top, #ffffff, #adadad);
    background: -ms-linear-gradient(top, #ffffff, #adadad);
    background: linear-gradient(top, #ffffff, #adadad);
    filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,
 StartColorStr='#FFffff', EndColorStr='#adadad');

}

/* style textareas */
#panel_body textarea {
    box-sizing: border-box;
    ms-box-sizing: border-box;
    webkit-box-sizing: border-box;
    moz-box-sizing: border-box;
    height:100px;
    padding:5px;
    font-family: Calibri, Arial, sans-serif;
}

/* input elements hover and select state */
#panel_body input:hover, #panel_body textarea:hover,  
#panel_body input:focus, #panel_body textarea:focus {  
    border-color: #025389;  
    -webkit-box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 8px;  
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:22:12.753

采用：

```
input[type=radio], input[type=checkbox] {
    // Reset attributes here
} 
```

或者使用比`input`其他 CSS 更具体的选择器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:31:27.747

如果要设置*除*复选框和单选之外的所有输入的样式，则可以使用此选择器：

```
input:not([type="checkbox"]):not([type="radio"]) 
```

[http://jsfiddle.net/29CTy/](http://jsfiddle.net/29CTy/)

我相信您会发现还有其他输入类型您也希望保持其无样式状态（尤其是`date`and`time`集合）。就个人而言，我只对*文本*类型输入进行样式设置，因为该列表通常比我希望不设置样式的类型列表短：

```
input[type="text"], input[type="password"], input[type="search"], input[type="email"], input[type="tel"], input[type="url"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:25:56.140

用于`#panel_body input[type="text"],#panel_body textarea`在文本框和文本区域上添加 CSS

并使用`input[type="radio"]`and`input[type="checkbox"]`在复选框和单选按钮上添加 CSS。

# java - 枚举是否意味着静态类？

> ID：13978112
> 
> 赞同：8
> 
> 时间：2012-12-20T18:17:16.440
> 
> 标签：java, enums

我在这里有一个困惑。

如果我不能将一个类声明为静态，那么**枚举**是如何工作的？它看起来像一个静态类，因为它自己被实例化并且可以在任何地方调用。看起来我可以像使用其他**静态字段**一样使用枚举。

使用**enum**是否安全？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-20T18:17:50.983

`enum`类型自动是静态的。你不能有一个非`static`枚举，所以`static`隐含了。

[JLS 8.9](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.9)：

> 嵌套枚举类型是隐式静态的。可以将嵌套枚举类型显式声明为静态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:22:39.460

您在枚举类型中声明的每个枚举都是枚举类型的静态成员。枚举变量的类型是枚举的类型，简而言之，它们是自类型的。

# php - 数据库失败的 PHP 更新 - 没有错误

> ID：13978122
> 
> 赞同：0
> 
> 时间：2012-12-20T18:17:50.820
> 
> 标签：php, pdo

我正在尝试使用此表单更新我的数据库条目：

```
<form method="post" action="inc/update.php">
    <?php foreach ($links as $row) {
        ?>
        <div class="btn_admin">
            <p>
                <label>Titulo</label>
                <input type="text" name="title[]" value="<?php echo $row["desc"] ?>">
            </p>
            <p>
                <label>Url</label>
                <input type="text" name="url[]" value="<?php echo $row["url"] ?>">
                <input type="hidden" name="id[]" value="<?php echo $row["id"] ?>" />
            </p>

        </div>
    <?php }
    ?>
    <input type="submit" name="submit" value="Update Links" />
</form> 
```

在我的 update.php 文件中：

```
if ($_SERVER["REQUEST_METHOD"] == "POST"
        && $_POST["submit"] == "Update Links") {

    include_once 'db.php';
    $db = new PDO(DB_INFO, DB_USER, DB_PASS);

    foreach($_POST['id'] as $id ) {

    $title=$_POST["title"][$id-1];
    $url=$_POST["url"][$id-1];

    $sql = "UPATE index_links
                SET desc=?, url=?
                WHERE id=?";
    $stmt = $db->prepare($sql);
    $stmt->execute(array($title, $url, $id-1));
    $stmt->closeCursor();
    }
} 
```

我已经遍历了 $title 和 $url 并且一切都被正确地“抓取”了，但是查询以某种方式失败而没有错误。

我什至尝试弄乱错误的查询语法（如上面示例中的查询 - “UPATE”），没有任何错误……是的，正在访问 foreach 循环。

这似乎是介绍级别的东西，但我看了一个小时左右，没有头脑=吹...我的项目中还有其他查询（不是更新的）运行良好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T18:28:55.113

在您的情况下，查询可能会失败，因为`desc`它是[mySQL 中的保留字。](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

默认情况下，PDO 可能对其错误消息非常保密。请参阅[此问题](https://stackoverflow.com/questions/3726505/how-to-squeeze-error-message-out-of-pdo)以了解如何更改。

# ajax - cakephp2 无法通过 $this->request->data 获取文件数据数组

> ID：13978125
> 
> 赞同：0
> 
> 时间：2012-12-20T18:18:02.870
> 
> 标签：ajax, cakephp, file-upload

通常，我们从 $this->request->data 中获取我们需要的所有数据。但如果我使用 ajax 文件上传，我无法获取该数据，例如：tmp_name、大小等。

我的 javascript 代码是这样的：

```
function uploadFile(file_blob_chunk, file_name, file_part, total_file_chunk, file_id) {
fd = new FormData();
    fd.append("file_for_upload", file_blob_chunk);
    fd.append("somestring", "This is some extra data");

    xhr = new XMLHttpRequest();             
xhr.open("POST", "files/index/" + file_id + '/' + file_part, true);

//Onload happened after file finished uploaded
xhr.onload = function(e) {
    //alert(file_name + "done");     
};

xhr.upload.addEventListener("progress", function(evt) {        
    if (evt.lengthComputable) {
    }}, false);

xhr.send(fd);
} 
```

在 FilesController.php 中

```
public function index($file_id = null, $file_part = null) { 
    if ($this->request->is('post')) {
        //I can't use $this->request->data, to get the file details
    }
} 
```

如果我使用

```
debug($this->request->data); 
```

我只会得到

```
array(
    'somestring' => 'This is some extra data'
) 
```

我无法获取文件数据

除非我使用调试（$_FILES），否则我不会得到

```
array(
    'file_for_upload' => array(
        'name' => 'blob',
        'type' => 'application/octet-stream',
        'tmp_name' => 'C:\xampp\tmp\phpAC42.tmp',
        'error' => (int) 0,
        'size' => (int) 9304862
    )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T00:25:56.583

如果你想使用`$this->request->data`你的帖子数据应该是蛋糕期望的格式，例如：`data[Model][some_field]`

你有`CustomField`

# javascript - 使用 JavaScript 动态更新视口元数据时出现意外的 iOS Safari 行为

> ID：13978126
> 
> 赞同：1
> 
> 时间：2012-12-20T18:18:15.297
> 
> 标签：javascript, ios, orientation, mobile-safari

我正在为 iPhone iOS Safari 浏览器改编一个网站。由于我希望内容在两个设备方向上都占据整个视口，因此我正在对`meta[name='viewport']`标签进行动态更新。

这是我在里面默认设置的`meta[name='viewport']`：

```
<meta name="viewport" content="width=device-width, initial-scale=0.51, minimum-scale=0.51, maximum-scale=0.51" /> 
```

然后，在页面加载后，我正在执行以下 JavaScript 代码以确保整个视口都被网站占用并居中：

```
var viewport = $("html head meta[name='viewport']");

function switchViewport() {
    var wider = "0.765",
        shorter = "0.51";

    switch (window.orientation) {  
        case 0:  
        case 180:
            viewport.attr("content", "width=device-width, initial-scale=" + wider + ", minimum-scale=" + wider + ", maximum-scale=" + wider + "");
        break; 

        case -90:  
        case 90:  
            viewport.attr("content", "width=device-width, initial-scale=" + shorter + ", minimum-scale=" + shorter + ", maximum-scale=" + shorter + "");
        break;
    }
}

$(window).on("orientationchange", switchViewport);

switchViewport(); 
```

当我在真正的 iPhone（4、4S）上测试**试图旋转设备时，甚至会触发“onorientationchange”，它完全符合我对上面代码的期望，除了 first turn**。当我进行第一次设备旋转以改变方向时，它没有按我的计划呈现。但是，当转动更多次时，它会恢复正常。只是因为某些事情，第一回合失败了。

这是一个网站： http: [//goo.gl/VXyBg](http://goo.gl/VXyBg)我正在研究，所以你可以直接用你的真 iPhone 或模拟器进行测试。更好的真实，因为模拟器在这种特殊情况下与真实设备相比没有给出相同的结果。

如果有人面临类似情况或对问题所在有知识和经验，我将不胜感激。

# solr - 当 groups.ngroups=true 时，Solr 3.6.1 分布式搜索上的组总数不正确

> ID：13978142
> 
> 赞同：1
> 
> 时间：2012-12-20T18:19:23.820
> 
> 标签：solr, grouping, distributed

我设置了许多 solr 核心 [Solr 3.5 & Jetty 7.4.5]，具有相同的架构，并且每个核心都有唯一的键。当使用“groups.ngroups=true”进行分布式搜索[例如2个分片]时，每次返回的总组值是每个分片的组值的总和，而不是分组后结果的总和[例如（唯一值Shard A) + (Shard B 的唯一值)，而不是(Shard A 和 Shard B 组合的唯一值)]。

我希望 SOLR-3436 [https://issues.apache.org/jira/browse/SOLR-3436] 解决了这个问题，因此在 Solr 3.6.1 中得到了纠正，但是当我将 Solr 版本更新为3.6.1，不正确的组总数仍然存在。我的问题是这种行为 [Total groups value is the sum of each distinct shards group total] 是否是 Solr 3.6.1 中的预期行为，或者我的 Solr 安装中有某种错误，我没有看到来自 SOLR-3436 的更正版本。

任何帮助将不胜感激。——罗恩·文斯特拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T11:13:58.900

Solr 目前不支持此功能。

要获得预期的行为，您需要确保用于分组的字段具有相同值的所有文档都在同一个分片上。[SOLR-2592](https://issues.apache.org/jira/browse/SOLR-2592)解决了这个问题，但您必须等待 Solr 4.1 版本才能利用它。

# python - Emacs python-mode.el 注释开始一个新行

> ID：13978147
> 
> 赞同：2
> 
> 时间：2012-12-20T18:19:51.270
> 
> 标签：python, emacs, comments, indentation, python-mode

我在 Emacs 中使用 python-mode.el 来编辑一些 Python 代码，它具有最烦人的功能，它会自动缩进注释然后开始新行。例如，如果我有这个：

```
def x():
    y = 1
<cursor is here, at root indentation level> 
```

然后在根缩进级别添加一个#：

```
def x():
    y = 1
    #
<cursor is now here> 
```

它会自动缩进，插入 #，并在 # 之后插入回车。这让我疯狂。我希望我的评论保持在我放置它们的位置！有什么建议么？

我查看了该模式的 elisp 代码，但找不到任何东西，也无法在网上其他地方找到任何东西。我所能找到的只是评论不会用于未来的缩进（py-honor-comment-indentation），但与评论本身无关。也不是奇怪的回车。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:29:19.937

在提交错误报告

[https://bugs.launchpad.net/python-mode/+bug/1092847](https://bugs.launchpad.net/python-mode/+bug/1092847)

Mx 自定义 py-electric-comment-p RET

将其设置为“nil”应该可以解决它。

另见变量“py-indent-comments”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:34:11.430

好的，找到了。

有问题的功能是 py-electric-comment。

默认情况下，可以在插入 # 后调用它。您可以通过将 py-electric-comment-p 设置为 nil 来禁用此功能。

您还可以通过编辑这部分功能来编辑 py-electric-comment：

```
 (let ((orig (copy-marker (point)))
                (indent (py-compute-indentation)))
      (unless (eq (current-indentation) indent)
            (goto-char orig)  ;;; REMOVE THIS LINE
              (beginning-of-line)
              (delete-horizontal-space) 
```

这将使您保持启用 py-electric-comment 但不会尝试返回到原始缩进级别，从而解决原始问题。

# asp.net-mvc - LINQ 联合总是返回空集

> ID：13978150
> 
> 赞同：0
> 
> 时间：2012-12-20T18:20:20.137
> 
> 标签：asp.net-mvc, linq, entity-framework, linq-to-sql

我正在做一些 LINQ 来查找在文本框中键入的关键字。每个关键字都以“;”结尾 我需要寻找至少包含其中一个键的项目。

我以为我可以通过这个循环来实现这一点

```
IEnumerable<ItemFAQ> allResults = null;
                    foreach (var item in termosPesquisaIsolados)
                    {
                        IEnumerable<ItemFAQ> tempResults = 
                                _dbHelpDesk.ItemFAQ
                                    .Where(x => x.DescricaoResposta.Contains(item) || x.TituloTopico.Contains(item))
                                    .ToList()
                                    .Select(x => new ItemFAQ
                                    {
                                        IdPergunta = x.IdPergunta,
                                        TituloTopico = x.TituloTopico,
                                        DescricaoResposta = x.DescricaoResposta.Substring(0, 100)
                                    });

                        if (allResults != null)
                            allResults = allResults.Union(tempResults);
                        else
                            allResults = tempResults;
                    } 
```

在第一次迭代 tempResult 在测试中返回 3 个元素，然后它传递给 allResult，一切正常。

第二次迭代，tempResult 返回 2 次......然后根据代码 allResult 应该接收 AllResult 和 TempResults 的联合，但无论我做什么，当我使用联合子句时，结果都是空集中的。

所以 3 + 2 = 0 在使用 Union 后结束。

你们是否可以在这种平静的代码中看到错误或知道一些可能导致此错误的问题？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:30:29.400

尝试替换这一行：

```
allResults = allResults.Union(tempResults); 
```

和：

```
allResults = allResults.Union(tempResults).ToList(); 
```

# git - .gitignore 并没有忽略自己

> ID：13978151
> 
> 赞同：14
> 
> 时间：2012-12-20T18:20:21.690
> 
> 标签：git, gitignore

我在我的文件中添加了 .gitignore 和另一个目录`.gitignore`，但是当我`git status`,`.gitignore`仍然出现时！

我觉得我错过了一些非常明显的东西。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-20T18:32:23.097

正如[Carl Norum](https://stackoverflow.com/a/13978226/758345)指出的那样，不允许跟踪文件以使其被忽略。你将不得不打电话

```
git rm --cached .gitignore 
```

为了让它实际上被忽略。

但是你试图做的是一个非常糟糕的主意。应该跟踪 .gitignore 文件，因此可以确保其中列出的内容实际上在所有客户端计算机上都被忽略了。如果不是这种情况，另一个开发人员可能会向你想要忽略的 repo 添加一个文件，你会遇到麻烦。

即使运行上面的命令也可能会造成麻烦，因为它会为每个开发者删除该文件。

如果出于某种原因您只想忽略机器上的内容（并且您确信这是个好主意），您需要将其添加到`.git/info/exclude`. 该文件具有与 相同的功能`.gitignore`，但不应与其他开发人员共享。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T18:25:04.177

您的`.gitignore`文件只忽略未跟踪的文件。由于您可能正在跟踪您的`.gitignore`文件，因此您将在`git status`.

如果您想忽略某些内容但又不想将其签入，请将其添加到您的全局 git 忽略文件中，而不是签入存储库中的那个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T18:26:56.733

停止跟踪 .gitignore 文件：

[如何停止跟踪并忽略 Git 中文件的更改？](https://stackoverflow.com/questions/936249/removing-a-file-from-git-source-control-but-not-from-the-source)

```
git rm --cached .gitignore 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T18:26:01.033

可能是因为您过去已经添加了 .gitignore 文件。

> 请注意，在将规则添加到此文件以忽略它之前，git 不会忽略已经跟踪的文件。在这种情况下，必须取消跟踪文件，通常使用`git rm --cached filename`

来自[https://help.github.com/articles/ignoring-files](https://help.github.com/articles/ignoring-files)

# ios - RestKit 0.2：扁平化 JSON 中的层次结构

> ID：13978153
> 
> 赞同：1
> 
> 时间：2012-12-20T18:20:24.927
> 
> 标签：ios, core-data, restkit

也许这里有一个类似的问题，但我找不到。所以我有 RestKit 0.2pre4 并想映射这样的 JSON ...

```
{
    "location": {
        "position": {
            "latitude": 53.9675028,
            "longitude": 10.1795594
        }
    },
    "id": "da3224f2-5919-42f2-9dd8-9171088f4ad7",
    "name": "Something even more beautiful",
} 
```

...对于这样一个对象：

```
@interface FavoritePlace : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSString * placeId;
@property (assign, nonatomic) double latitude;
@property (assign, nonatomic) double longitude;

@end 
```

如您所见，关键是我不想创建关系并将“位置”对象单独存储在数据库中 - 这没有任何意义。因此，我想将那些嵌套的东西（location.position.latitude 和 location.position.longitude）分配给对象本身的特定属性。如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:07:42.983

Apparently, I did a wild ass guess and it worked! Here's the mapping which does the trick:

```
[placeMapping addAttributeMappingsFromDictionary:@{
     @"id": @"placeId",
     @"name": @"name",
     @"location.position.latitude": @"latitude",
     @"location.position.longitude": @"longitude"     
     }]; 
```

Have not found this in documentation, but maybe it's just me... Anyway, if something logical, but undocumented, works, then framework should be good. :) RestKit FTW!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:34:33.343

您可以将包含 json 字符串的字符串传递给 nsdata

```
NSData* jsonData = [jsonString dataUsingEncoding:NSUTF8StringEncoding]; 
```

然后，您将能够使用 iOS API 解析 de json 数据

```
NSError *error;
NSDictionary *json = jsonData ? [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error] : nil; 
```

现在，检查生成的 NSDictionary（例如使用 NSlog），填充您的“FavoritePlace”对象并将其持久化。

希望有所帮助！

# sql - 我想通过执行触发器从 table1 中删除值并存储在 table1 中

> ID：13978159
> 
> 赞同：0
> 
> 时间：2012-12-20T18:20:58.170
> 
> 标签：sql, sql-server, sql-server-2008

在执行删除语句之前，我应该如何以及编写什么查询来执行触发器......

我想从 table1 中删除值，在删除值之前，我将这些值存储在 table2 中，但问题是，每当我执行 trigger 和 then 语句时，两者都会执行，但 table1 中的值不会被删除。触发器正确执行（使用 SQL Server 2008）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:31:26.517

您可以在使用 SQL Server 2008 及更高版本更容易的过程或触发器中使用“合并”语句。合并启用插入、更新和删除，并在一个语句中提供所有输出。

此处使用示例：http: [//blog.sqlauthority.com/2008/08/28/sql-server-2008-introduction-to-merge-statement-one-statement-for-insert-update-delete/](http://blog.sqlauthority.com/2008/08/28/sql-server-2008-introduction-to-merge-statement-one-statement-for-insert-update-delete/)

# c++ - 如何在 C++ 中运行另一个应用程序并与之通信，跨平台

> ID：13978162
> 
> 赞同：2
> 
> 时间：2012-12-20T18:21:06.983
> 
> 标签：c++, linux, windows, cross-platform, process

我想从我的 C++ 代码运行另一个程序。`system()`返回 int，因为每个程序只能将 int 返回给操作系统。但是，我要调用的另一个程序将在我的基本应用程序中生成我需要的字符串。如何将其发送到父进程？

这两个应用程序将在同一个文件夹中，所以我认为子应用程序可以将字符串保存到“temp.txt”，然后主应用程序可能会读取并删除它（这不是性能关键过程，我将调用另一个进程只是在我的主 opengl 应用程序中调用打开文件对话框）。然而这有点丑陋的解决方案，有更好的跨平台解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:23:30.537

您可以使用[`popen()`](http://msdn.microsoft.com/en-us/library/96ayss4b%28v=vs.71%29.aspx)，这将打开一个您可以写入和读取数据的进程。AFIK 这也是跨平台的

```
// crt_popen.c
/* This program uses _popen and _pclose to receive a 
 * stream of text from a system process.
 */
#include <stdio.h>
#include <stdlib.h>

int main(void) {

   char   psBuffer[128];
   FILE   *pPipe;

        /* Run DIR so that it writes its output to a pipe. Open this
         * pipe with read text attribute so that we can read it 
         * like a text file. 
         */

   if((pPipe = _popen("dir *.c /on /p", "rt")) == NULL)
      exit(1);

        /* Read pipe until end of file. */

   while(!feof(pPipe)) {
      if(fgets(psBuffer, 128, pPipe) != NULL)
         printf(psBuffer);
   }

        /* Close pipe and print return value of pPipe. */

   printf("\nProcess returned %d\n", _pclose(pPipe));

   return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T18:23:37.677

尽管它不是 C++ 标准的一部分，但几乎所有当前合理的系统都提供了一个`popen`（或者`_popen`，在 Microsoft 的情况下），它可以让您生成一个子进程并从其标准输出中读取作为`FILE *`父级中的 C 样式。至少如果内存服务，`popen`包含在 POSIX 中，因此您可以期望它存在于基本上所有类 Unix 系统中（并且，如上所述，它也可以在 Windows 上使用，至少在大多数编译器中）。

换句话说，您可能遇到的唯一不可用的地方是小型嵌入式系统，它可能毫无意义（例如，没有文件系统可以在其中找到其他可执行文件，并且很可能没有能力也可以创建新进程）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T18:38:52.493

尽管没有实现进程间通信的标准方法，但有一个相对无痛的库，可移植到许多操作系统/编译器：[Boost.Interprocess](http://www.boost.org/doc/libs/1_52_0/doc/html/interprocess.html)。它涵盖了大多数必需品：

*   共享内存。
*   内存映射文件。
*   信号量、互斥体、条件变量和可升级互斥体类型，以将它们放置在共享内存和内存映射文件中。
*   这些同步对象的命名版本，类似于 UNIX/Windows sem_open/CreateSemaphore API。
*   文件锁定。
*   相对指针。
*   消息队列。

# c# - 如何访问存储在服务帐户中的 X.509 证书？

> ID：13978164
> 
> 赞同：3
> 
> 时间：2012-12-20T18:21:12.587
> 
> 标签：c#, x509, syncfusion

我正在尝试使用 Syncfusion PDF 10.4 对 PDF 文档进行数字签名，如下所示：

```
PdfLoadedDocument document = new PdfLoadedDocument(inputStream);
PdfCertificate certificate = PdfCertificate.FindBySubject(certificateStoreType, certificateSubjectName);

PdfSignature signature = new PdfSignature(document, document.Pages[0], certificate, "Signatur");
signature.Bounds = new RectangleF(new PointF(5, 5), new SizeF(100, 100)); 
```

在使用 MMC 安装合适的证书后，这对我的本地用户帐户非常有用（为*我的用户帐户添加**证书*管理单元并将其存储在*Personal*中），但不适用于服务（这次选择*服务帐户*，并选择我的服务） . 运行相同的代码会导致找不到合适的证书，即为空。此外，抛出一个，我认为这是 Syncfusion 端的一个错误。***`certificate``PdfCertificate.GetCertificates()``AccessViolationException`***

 ***但是，我可以在没有 Syncfusion 代码的情况下重现同样的问题：

```
var store = new System.Security.Cryptography.X509Certificates.X509Store("My");
store.Open(System.Security.Cryptography.X509Certificates.OpenFlags.ReadOnly);
foreach (var item in store.Certificates)
{
    …
} 
```

以我自己的用户身份运行，证书会显示出来（就像 MMC 中*Personal*下显示的所有其他证书一样），但是如果我调试服务（通过运行它，然后调用`System.Diagnostics.Debugger.Launch()`），我只会得到一个“CN=LOCAL SERVICE”证书，根本没有出现在MMC中。

我假设我需要 A) 告诉它打开正确的证书存储，或 B) 更改服务的安装或运行方式，例如为其赋予不同的身份、启用 UserInteraction 等。目前，它使用 LocalService 并禁用 UserInteraction 运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T21:34:00.787

据我所知，Windows 机器帐户（如 LocalService）使用机器证书存储。这意味着在您的代码中，您必须使用`StoreLocation.LocalMachine`.

```
var store = 
   new System.Security.Cryptography.X509Certificates.X509Store(StoreLocation.LocalMachine); 
```

请注意，如果您决定以特定身份运行服务，您应该先以身份登录，然后将证书导入个人存储，然后使用`StoreLocation.CurrentUser`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-24T14:44:51.043

[答案似乎是](https://stackoverflow.com/a/5150071/1600).NET 不支持在没有 P/Invoke 或类似的情况下访问服务帐户证书存储：

> 我认为任何 .NET API 都不允许访问服务证书存储。
> 
> 但是，您可以将证书安装到运行该服务的帐户的 CurrentUser 存储中。

我已将服务更改为在其自己的用户下运行（不需要管理员权限），`mmc.exe`使用 runas 以该用户身份运行，并将证书导入该用户的个人商店。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-23T08:00:44.803

我遇到了这个问题，要解决它必须允许“本地服务”帐户使用“WinHttpCertCfg”工具访问“本地计算机”证书存储

这里详细描述：

[https://support.microsoft.com/en-us/help/901183/how-to-call-a-web-service-by-using-a-client-certificate-for-authentication-in-an-asp-网络网络应用程序](https://support.microsoft.com/en-us/help/901183/how-to-call-a-web-service-by-using-a-client-certificate-for-authentication-in-an-asp-net-web-application)***

# java - 根据HashMap中的对象改变HashMap数组的顺序

> ID：13978165
> 
> 赞同：-4
> 
> 时间：2012-12-20T18:21:20.420
> 
> 标签：java

我有一个`ArrayList<HashMap<String,String>>`.

有没有办法改变 HashMaps 数组的顺序？例如，如果字符串“firstName”在 HashMap 中，我可以按该值对 HashMap 的 ArrayList 进行排序吗？为了清楚起见，我不需要在 HashMaps 中对键和对象进行排序。我需要在 Arraylist 中订购 HashMaps。

什么是最好的方法？

我试着从例子做：

```
class MapComparator implements Comparator<HashMap<String, String>>
{
    private final String key;

    public MapComparator(String key)
    {
        this.key = key;
    }

    public int compare(HashMap<String, String> first,
            HashMap<String, String> second)
    {
        // TODO: Null checking, both for maps and values
         String firstName1 = first.get(key);
            String firstName2 = second.get(key);
            if(firstName1 == null)
                if(firstName2 == null)
                    return 0;
                else
                    return -1; // treat null as less than any non-null
            else
                if(firstName2 == null)
                    return 1; // treat null as less than any non-null
                else
                    return firstName1.compareTo(firstName2);

    }
} 
```

并使用：

```
 Log.e(THIS_FILE, "before ->" + addedRows);
                Collections.sort(addedRows, new MapComparator("name"));
                Log.e(THIS_FILE, "after ->" + addedRows); 
```

并且没有任何排序（确保我将一个联系人重命名为以字母 a 开头，名称 = as ice:) 的哈希图必须是第一个）：

```
> E/ContactsActivity(23571): before ->[{type=, contactID=4, name=Office
> O}, {type=, contactID=2912, name=Test Text Last}, {type=,
> contactID=2915, name=as ife:) Eng}, {type=, contactID=2914,
> name=life:) Rus}, {type=, contactID=2913, name=life:) Ukr}, {type=,
> contactID=2897, name=дима куплеватскиц}] E/ContactsActivity(23571):
> after ->[{type=, contactID=4, name=Office O}, {type=, contactID=2912,
> name=Test Text Last}, {type=, contactID=2915, name=as ife:) Eng},
> {type=, contactID=2914, name=life:) Rus}, {type=, contactID=2913,
> name=life:) Ukr}, {type=, contactID=2897, name=дима куплеватскиц}] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:27:49.843

我相信您遇到的问题是[HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)是完全无序的。如果要为 HashMap 中的数据添加顺序，经典的解决方案是使用[TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)。

根据您的情况，您可能无法开始使用`TreeMap`. 如果是这样，您将需要将您的转换`HashMap`为`TreeMap`：

```
TreeMap treeMap = new TreeMap();
treeMap.putAll(hashMap);           // where "hashmap" was already filled 
```

结果`TreeMap`将根据您的`HashMap`.

但是，如果您想为 中的数据添加顺序，经典的解决方案类似于使用[TreeList](http://commons.apache.org/collections/api-3.1/org/apache/commons/collections/list/TreeList.html)。

如果您想使用 each 中的值对 an `ArrayList`of `HashMap`s 进行排序`HashMap`，您需要做的就是创建 a`TreeMap`并将其放入 a`TreeList`中。如果您想`ArrayList`按原始键以外的其他内容进行排序`HashMap`，那么您遇到了问题，需要重新考虑您对数据结构的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:49:34.210

听起来你想要的是：

```
java.util.Collections.sort
(
    list,
    new java.util.Comparator<Map<String,String>>()
    {
        public int compare(Map<String,String> map1, Map<String,String> map2)
        {
            String firstName1 = map1.get("firstName");
            String firstName2 = map2.get("firstName");
            if(firstName1 == null)
                if(firstName2 == null)
                    return 0;
                else
                    return -1; // treat null as less than any non-null
            else
                if(firstName2 == null)
                    return 1; // treat null as less than any non-null
                else
                    return firstName1.compareTo(firstName2);
        }
    }
); 
```

（`list`类型变量的名称在哪里`ArrayList<HashMap<String,String>>`）。

# vb.net - 无法获取 Windows 服务的“StartMode”。VB.NET

> ID：13978169
> 
> 赞同：0
> 
> 时间：2012-12-20T18:21:27.887
> 
> 标签：vb.net, windows-services, comexception

我想知道服务启动模式是否设置为“自动”，如果是，请将其设置为“手动”

我有这个代码：

```
 If objService("StartMode").ToString = "Automatic" Then
            objService.ChangeStartMode("Manual")
        End If 
```

但是当我编译我的项目时，Visual Studio 会报告该错误：

COMException 未处理：未找到成员。（来自 HRESULT 的异常：0x80020003 (DISP_E_MEMBERNOTFOUND)）

在 `If objService("StartMode").ToString = "Automatic" Then`

请帮我解决这个问题？这对我来说非常重要。谢谢。

我在管理员帐户上使用 Visual Studio 2008、VB.NET、Windows XP Sp3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:04:37.737

```
 If objService("StartMode").ToString = "Automatic" Then 
```

您正在使用后期绑定，这是一种使用 COM 对象的方式，当您不正确地使用它们的属性和方法时，往往会给您带来运行时错误。您可以通过使用 System.Management 命名空间中的类来避免此类问题。

该语句没有执行您认为的操作，它调用接口的默认属性并将“StartMode”作为参数传递给该默认属性的属性获取器。这不是该接口的正确用法，StartMode 本身就是一个属性，它不是默认属性。使固定：

```
 If objService.StartMode = "Automatic" Then 
```

# c++ - C++，通过 const 引用访问 std::map 元素

> ID：13978170
> 
> 赞同：9
> 
> 时间：2012-12-20T18:21:37.573
> 
> 标签：c++, stl, stdmap

我对 const 有疑问。说我有：

```
class A{
    friend std::ostream& operator<<(std::ostream& os,const A& myObj);

   private:
    std::map<int,int> someMap;
    int someInteger;
 };
 std::ostream& operator<<(std::ostream& os,const A& myObj){
  os<<myObj.someInteger<<std::endl;
  os<<myObj.someMap[0]<<std::endl;
  } 
```

由于与地图的 const 冲突，这种代码在编译时会产生错误（如果我注释打印地图值的行一切都很好），如果我去掉函数原型中的“const”一切都很好。实在看不出问题出在哪里。。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-20T18:24:11.007

[`std::map::operator[]`](http://en.cppreference.com/w/cpp/container/map/operator_at)不是 const，因为如果一个元素不存在，它会插入一个元素。在 c++11 中，您可以[`std::map::at()`](http://en.cppreference.com/w/cpp/container/map/at)改用：

```
myObj.someMap.at(0) 
```

否则，您可以先使用 , 检查元素是否存在[`std::map::find`](http://en.cppreference.com/w/cpp/container/map/find)，

```
if (myObj.find(0) != myObj.end())
{
  // element with key 0 exists in map
} else 
{
  // do something else.
} 
```

# python - API中对象初始化的OO设计模式

> ID：13978182
> 
> 赞同：5
> 
> 时间：2012-12-20T18:22:27.280
> 
> 标签：python, api, oop

在 python 中创建 API 时，我不确定在使用 init 创建基本对象的实例时采用什么方法。

在 API 中创建对象的实例时，用户很可能希望该对象是以下两种情况之一：

1.  在调用 API 的对象中已经存在的对象实例
2.  在调用 API 的对象中创建一个新对象

是否有一个公认的设计模式？init 是否应该只创建一个空对象，然后消费者必须调用 get 或 set 方法？或者也许 init 应该接受一个参数来判断这是一个 get 还是 set？或者最后，应该从 init 的参数中推断出 get 或 set 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:31:25.610

我想不出与您所描述的完全匹配的设计模式，因为：

*   [工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)通常处理一个类家族（层次结构）。
*   [构建器模式](http://en.wikipedia.org/wiki/Builder_pattern)通常处理由许多类组成的复杂对象。

如何将 API 重载到以下内容？

不带参数调用时：

```
custom_API() 
```

然后只需创建一个具有一些合理默认值的新基本对象，并让消费者使用 get / set 来配置它。

当使用某种查找键调用时：

```
custom_API("abc") 
```

然后返回对应的对象，或者查找键的对象列表不明确，或者`None`找不到匹配的对象。

# macos - autoreconf 失败 - libtoolize

> ID：13978186
> 
> 赞同：4
> 
> 时间：2012-12-20T18:23:00.343
> 
> 标签：macos, terminal

在山狮上运行，我无法让 autoreconf 成功运行。

|红宝石-1.9.3-p194| Tylers-MacBook-Pro 在 ~/Desktop/code/telepathic-critterdrug ○ → autoreconf -fi

无法执行“libtoolize”：/sw/share/autoconf/Autom4te/FileUtils.pm 第 345 行第 4 行没有这样的文件或目录。 autoreconf：无法运行 libtoolize：没有这样的文件或目录 autoreconf：需要 libtoolize，因为这个包使用 Libtool

# ruby-on-rails - 用于omniauth 注册的自定义字段

> ID：13978189
> 
> 赞同：0
> 
> 时间：2012-12-20T18:23:09.257
> 
> 标签：ruby-on-rails, omniauth

我在我的应用程序中使用设计和omniauth-facebook 进行身份验证。注册表单具有所有常用字段 - 姓名、电子邮件、密码，以及一些自定义字段（性别、年龄和一些嵌套属性作为复选框）。

如何保存自定义字段中的数据并在创建用户时使用它（在我的 omniauth 回调操作中）？*只*使用omniauth和scrap devise会更有意义吗？也许具有omniauth身份？

这里的 Rails 新手 - 如果问题很愚蠢，对不起......感谢您花时间阅读本文，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:38:09.453

我有一个类似的问题，我使用 OAuth 状态参数解决了它。您可以在 'state' 参数中将这些参数沿请求传递给 facebook。取回控件后，您可以从此参数取回数据。

[在此处](https://stackoverflow.com/questions/13032160/oauth-callback-url-parameters-with-doorkeeper)查看我的原始问题和答案。

顺便说一句，如果您要连接到用户的 Facebook，您也可以向 Facebook 查询信息，而不是在表单中询问。请注意不要在数据上违反 Facebook 的 TOS。

# android - AndroidRuntimeException “从 Activity 上下文外部调用 startActivity() 需要 FLAG_ACTIVITY_NEW_TASK 标志”

> ID：13978190
> 
> 赞同：5
> 
> 时间：2012-12-20T18:23:09.573
> 
> 标签：android, runtime-error

我在列表视图中创建了多个布局，但是当我单击时，我得到一个 AndroidRuntimeException “从 Activity 上下文外部调用 startActivity() 需要 FLAG_ACTIVITY_NEW_TASK 标志。这真的是你想要的吗？”

我添加

> Intent.FLAG_ACTIVITY_NEW_TASK

符合我的意图，但我得到了同样的信息！=(

```
 @Override
            public View getView(int position, View convertView, ViewGroup parent) {

                    retval=LayoutInflater.from(getApplicationContext()).inflate(R.layout.layout_anuncio, null);
                    ImageView image=(ImageView) retval.findViewById(R.id.imageAD);
                    LoadAds loadAds= new CargaAnuncios();
                    clickUrl = LoadAds.cargaImagenAnuncio(image, mContext, GlobalInfo.ANUNCIO_CARRIL_PORTADA);
                    image.setOnClickListener(new OnClickListener(){

                        @Override
                        public void onClick(View view) {
                            Bundle bundle=new Bundle();
                            bundle.putString("url", clickUrl);
                            Intent intent =new Intent(mContext,CustomWebView.class);
                            intent.putExtras(bundle);
                            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                            mContext.startActivity(intent);
                        }

                    });
            return retval;
        } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-20T18:32:41.260

替换`getApplicationContext()`为`this`。最有可能的是，您应该在您拥有的代码中的任何地方都这样做`getApplicationContext()`——仅`getApplicationContext()`在您特别需要该`Application`对象时使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-14T05:42:55.367

旧线程，但认为这个简单的解决方案可能会对某人有所帮助。与其传递上下文，不如从视图中获取它。例如：`view.getContext()`

```
@Override
public void onClick(View view) {
    Bundle bundle=new Bundle();
    bundle.putString("url", clickUrl);
    Intent intent =new Intent(view.getContext(),CustomWebView.class);
    intent.putExtras(bundle);
    intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    view.getContext().startActivity(intent);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:25:42.397

我已经添加了：

> parent.getApplicationContext()

而不仅仅是：

> 获取应用程序上下文（）

整行是：

```
retval=LayoutInflater.from(parent.getApplicationContext()).inflate(R.layout.layout_anuncio, null); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-11T16:07:41.763

Warren Lankie Van Tonder 的解决方案*几乎*是好的：

-您应该避免使用 Activity 上下文，而是选择 Application Context，以防止内存泄漏。Android 开发人员的这篇博客解释说[http://android-developers.blogspot.be/2009/01/avoiding-memory-leaks.html](http://android-developers.blogspot.be/2009/01/avoiding-memory-leaks.html)

-但是在活动上下文的情况下，您的代码是唯一的解决方案（可能用于从活动外部调用另一个活动）并且关于上面的链接，您必须在每个 onPause() 中释放静态引用

> AppGlobals.setAppContext(null);

作为回报，在 onResume 而不是 onCreate 中设置静态字段。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-21T08:55:42.687

```
CustomAdapter mAdapter = new CustomAdapter( getApplicationContext(), yourlist); 
```

或者

```
Context mContext = getAppliactionContext();

CustomAdapter mAdapter = new CustomAdapter( mContext, yourlist); 
```

**改为下面**

```
CustomAdapter mAdapter = new CustomAdapter( this, yourlist); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-01-20T08:55:34.297

感谢 CommonsWare，我想出了这个效果最好的解决方案。

我添加了一个新课程

```
package com.test.test;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;

public class AppGlobals extends Activity {
    private static Context appContext;

    public static Context getAppContext(){
        return appContext;
    }

    public static void setAppContext(Context context){
        appContext = context;
    }

    public static void StartActivity(Intent intent){
        appContext.startActivity(intent);
    }
} 
```

然后我需要做的就是在我导航到的每个活动 onCreate 上添加以下代码。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_login);
    AppGlobals.setAppContext(this);
} 
```

这允许新意图开始，就好像它与正常的应用程序流一起工作，这样我就不必为意图设置标志。

调用 start Activity 方法很简单：

```
Intent totalTimerIntent = new Intent(AppGlobals.getAppContext(), TotalTimer.class);
AppGlobals.StartActivity(totalTimerIntent); 
```

希望这对某人有所帮助，因为它对我有所帮助。

谢谢CommonsWare。

# css - 带有div和同一类的css html lyout

> ID：13978193
> 
> 赞同：0
> 
> 时间：2012-12-20T18:23:23.597
> 
> 标签：css, html

请帮忙。我想实现黄色框上的文本和按钮左右对齐（左侧的文本 - 边距 20 px；右侧的按钮 - 边距 20 px）并且页脚中的菜单与黄色框对齐。

无法添加图片，抱歉。

编辑：添加了 JSFiddle - [http://jsfiddle.net/wqBEf/](http://jsfiddle.net/wqBEf/)

这是我的 CSS 代码：

```
 #page
    {
        width: 960px;
        margin-left: auto;
        margin-right: auto;
        border: 1px solid red;
        background-color: blue;
    }

    #page > #main
    {
        border: 1px solid #000;
        width: 650px;
        margin-left: auto;
        margin-right: auto;
        background: white;
        border-radius: 5px;
        margin-top: 20px;
    }

    #main > #inner
    {
        margin: 20px;

    }

    #page-title h1
    {
        font-size: 24px;
        text-align: center;
    }

    #footer-hotline
    {
        height: 50px;
        background-color: rgb(255,207,0);
        border-radius: 5px;
        box-shadow: 0px 3px 3px #999999;

        margin-top: 20px;
        border: 1px solid #000;
        width: 650px;
        margin-left: auto;
        margin-right: auto;

        position: relative;
        z-index: 2;
    }

    #footer-hotline > .part
    {
        float: left; width: 33%;
        margin-left: 20px;
        line-height: 50px;
        font-size: 16px;
        font-weight: bold;
    }
    #footer-hotline > .part input
    {
        vertical-align:middle;
    }

    #footer
    {
        margin-top: -25px;
        height: 100px;
        line-height: 25px;
        background-color: white;
        text-transform: uppercase;
        border: 1px solid black;
    }

    #footer > .link
    {
        float: left;
        border-right: 1px solid #000;
        margin-top: 50px;
    }

    #footer > .link > div
    {
        margin-left: 5px;
        margin-right: 5px;
    } 
```

这是我的html代码：

```
<div id="page">
<div id="main">
    <div id="inner">
        <div id="page-title">
            <img src="myLogo.png" alt="Schulz logo" />
            <h1>Some title</h1>
        </div>
        <div id="content">RenderBody</div>        
    </div>
    <div class="f-c"></div>       
</div>
<div id="footer-hotline">
    <div class="part">Hotline: 0800/888 888</div>
    <div class="part"><input type="submit" class="button" id="callback-button" value="callback" name="callback-button" /></div>
</div> 
<div class="f-c"></div>
<div id="footer">
    <div class="link"><div><a href="#">GTC</a></div></div>
    <div class="link"><div><a href="#">About</a></div></div>
    <div class="link"><div><a href="#">Help</a></div></div>
    <div class="link"><div><a href="#">Language</a></div></div>
</div> 
```

感谢您的回答、建议和评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:35:52.420

有关更新，请参阅[http://jsfiddle.net/wqBEf/1/](http://jsfiddle.net/wqBEf/1/)。

值得注意的变化。

*   我分别为浮动和文本对齐添加了`left align-left`和类。`right align-right`
*   我将您的链接设置为，`display: inline`因为它是水平居中项目列表的最简单方法。

这是主要的两个变化。其余的更改只是为了支持上述两个，例如删除/添加一些边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:40:40.010

您可以使用`:first-child`伪类来解决使这两个项目一起工作的问题（这仅在您一次只有两个项目时才有效）。[回到 IE7](http://kimblim.dk/css-tests/selectors/)也得到很好的支持

您还需要实现`float:right`、`direction:rtl`和`margin-right`：

```
#footer-hotline > .part
{
    float: right; width: 33%;
    direction: rtl;             
    margin-right: 20px;
    line-height: 50px;
    font-size: 16px;
    font-weight: bold;
}
#footer-hotline > .part:first-child
{
    direction: ltr;
    float: left;      
    margin-left: 20px;
} 
```

[Eli Gassert 的](https://stackoverflow.com/questions/13978193/css-html-lyout-with-divs-and-same-class#answer-13978384)回答应该足以使导航居中

来源： http: [//jsfiddle.net/YZ2Uz/](http://jsfiddle.net/YZ2Uz/)
演示：http: [//jsfiddle.net/YZ2Uz/show](http://jsfiddle.net/YZ2Uz/show)

# objective-c - 如何在 Objective-C 中保存另一个类正在使用的类对象？

> ID：13978197
> 
> 赞同：1
> 
> 时间：2012-12-20T18:23:30.770
> 
> 标签：objective-c, directory, filepath, save, nscoding

我正在为 iPad 和 iPod 制作一个 Cookbook 应用程序，并且我的 Cookbook 类中有一系列我的 Recipe 类。

```
@interface Cookbook : NSObject<NSCoding>{
NSMutableArray* recipes;
} 
```

那是在我的食谱课上，在我的食谱课上我有这个：

```
@interface Recipe : NSObject<NSCoding>{
NSString* name;
NSMutableArray* ingredients; //List of ingredients for the recipe
UIImage* recipePicture;
NSMutableArray* instructions;
unsigned int prepTime;//in seconds
NSDate* dateAdded;
} 
```

（实际上我这里有更多变量，但我不想过多地淹没它）

我的问题基本上在于保存/加载功能。我之前在这里问过一个类似的问题： [如何保存不是属性列表对象的 Objective-C 对象，或者有比属性列表更好的方法吗？](https://stackoverflow.com/questions/13327020/how-can-i-save-an-objective-c-object-thats-not-a-property-list-object-or-is-the)

这让我决定最好使用 NSCoding，而且我也已经按照 NSCoding 建议的方式为它实现了一个方法。

我的主要问题是我无法存储和成功检索食谱。

我也很难将目录添加到我的 RecipeList.plist 文件中以存储食谱。

任何帮助将不胜感激，因为这是我无法继续制作此应用程序的原因。

在我的 Cookbook.m 中，我有：

```
-(id) initWithCoder:(NSCoder *)aDecoder{
NSLog(@"Init With Coder - Cookbook");
if(self = [super init]){
    recipes = [aDecoder decodeObjectForKey:@"recipes"];
}
return self;
} 
```

在我的食谱中：

```
-(id) initWithCoder:(NSCoder *)aDecoder{
if(self = [super init]){
    name = [aDecoder decodeObjectForKey:@"name"];
    ingredients = [aDecoder decodeObjectForKey:@"ingreds"];
    recipePicture = [aDecoder decodeObjectForKey:@"recipePict"];
}
return self;
} 
```

再一次，我有更多的变量，这只是为了简单。此外，这是我尝试获取 RecipeList.plist 的文件路径：

```
+(NSString*) filePath{
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,     NSUserDomainMask, YES);
NSString *path = [paths objectAtIndex:0];
path = [path stringByAppendingPathComponent:@"RecipeList.plist"];

NSLog(@"%@",path);
return path;
} 
```

我在 AppDelegate.m 中尝试保存方法：

```
-(void) save:(NSString *)path cookbook:(Cookbook *)cookbook{
BOOL b = [[NSFileManager defaultManager] fileExistsAtPath:path];
NSLog(@"File exists: %i",b); //1 = exists, 0 = doesn't

NSMutableData* data = [[NSMutableData alloc] init];
if(data){ //If the data object was successfully initialized
    NSKeyedArchiver* archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];
    if(archiver){
        //Encode the recipe using the coder method defined in recipe.
        [archiver encodeInt:1 forKey:@"Version"];
        [archiver encodeObject:cookbook forKey:@"Cookbook"];
        [archiver finishEncoding];

        [data writeToFile:path atomically:YES];
    }
}
} 
```

和我的加载方法：

```
-(Cookbook *) loadCookbook:(NSString *)path{
BOOL b = [[NSFileManager defaultManager] fileExistsAtPath:path];
NSLog(@"File exists: %i",b);

Cookbook* ret = nil;
NSData* data = [NSData dataWithContentsOfFile:path];
if(data){
    NSKeyedUnarchiver* unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];
    int version = [unarchiver decodeIntForKey:@"Version"];
    if(version == 1){
        ret = (Cookbook*) [unarchiver decodeObjectForKey:@"Cookbook"];
    }
    [unarchiver finishDecoding];
}
return ret;
} 
```

我的 Recipe 类也有一个与此非常相似的保存和加载方法。

再一次，我们将不胜感激任何帮助，并感谢您花时间阅读本文。

编辑：这是 Recipe.m 中的 encodeWithCoder 方法，为简洁起见省略了一些变量：

```
-(void) encodeWithCoder:(NSCoder *)aCoder{
NSLog(@"Encoding Recipe.");
[aCoder encodeObject:name forKey:@"name"];
[aCoder encodeObject:ingredients forKey:@"ingreds"];
[aCoder encodeObject:recipePicture forKey:@"recipePict"];
[aCoder encodeObject:instructions forKey:@"instructs"];
[aCoder encodeObject:category forKey:@"categ"];
[aCoder encodeObject:dateAdded forKey:@"dateAdd"];
[aCoder encodeInt:prepTime forKey:@"prepTime"];

} 
```

在 Cookbook.m 中：

```
-(void) encodeWithCoder:(NSCoder *)aCoder{
NSLog(@"Encoding cookbook.");
[aCoder encodeObject:recipes forKey:@"recipes"];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T09:19:28.957

我已经“几乎”复制粘贴了您的代码，经过一些小的调整后，我已经启动并运行了它。

在食谱中，我添加了：

```
- (id)init {
    if (self = [super init]) {
        recipes = [NSMutableArray array];
    }
    return self;
} 
```

和

```
- (void)addRecipe:(Recipe *)recipe {
    [recipes addObject:recipe];
} 
```

你可能已经有了这些？我假设您正在某处实例化数组？

然后使用这个测试例程，完美地创建、使用和保存食谱：

```
NSString *path = [self filePath];
Cookbook *cookbook = [self loadCookbook:path];

if (cookbook) {
    NSLog(@"Loaded cookbook: %@", cookbook);
}
else {
    cookbook = [[Cookbook alloc] init];
}

Recipe *recipe = [[Recipe alloc] init];
recipe->name = @"The name";
[cookbook addRecipe:recipe];

[self save:path cookbook:cookbook];
NSLog(@"Saved cookbook: %@", cookbook); 
```

**仅供参考**：为简洁起见，我将配方的实例变量设为@public；希望您正在使用访问器（@property）。

您使用自动或手动引用计数？

# cuda - 编写一个 cuda 程序来编译 sm_1x 和 sm_2x

> ID：13978201
> 
> 赞同：2
> 
> 时间：2012-12-20T18:23:37.203
> 
> 标签：cuda

[我的问题与此链接](https://stackoverflow.com/questions/10161387/how-can-i-compile-a-cuda-program-for-sm-1x-and-sm-2x-when-i-have-a-surface-decla)非常相​​似，但我无法修复它。

我有一个使用 cuda 分层纹理的 CUDA 程序。此功能仅适用于 Fermi 架构（计算能力大于或等于 2.0）。如果 GPU 不是 Fermi，我使用 3d 纹理代替分层纹理。在声明纹理引用（纹理引用需要是全局的）时，我在代码中使用 __CUDA_ARCH__，如下所示：

```
#if __CUDA_ARCH__ >= 200
    texture<float, cudaTextureType2DLayered> depthmapsTex;
#else
    texture<float, cudaTextureType3D> depthmapsTex;
#endif 
```

我遇到的问题是 __CUDA_ARCH__ 似乎没有定义。

我尝试过的事情：

1) __CUDA_ARCH__ 能够在 cuda 内核中正常工作。我从 NVCC 文档中知道 __CUDA_ARCH__ 无法在主机代码中正常工作。我必须将纹理参考定义为全局变量。它属于主机代码吗？正在编译的文件的扩展名为 .cu。

2）我有一个使用分层纹理正常工作的程序。然后我以两种方式添加 __CUDA_ARCH__ 宏：

```
#ifdef __CUDA_ARCH__
    texture<float, cudaTextureType2DLayered> depthmapsTex; 
#endif 
```

和

```
#ifndef __CUDA_ARCH__
    texture<float, cudaTextureType2DLayered> depthmapsTex; 
#endif 
```

我发现它们都不起作用。两者都有相同的错误。**错误：标识符“depthmapsTex”未定义**。看起来好像 MACRO __CUDA_ARCH__ 已定义但未同时定义。我怀疑这与编译有两个阶段有关，并且只有一个阶段可以看到 __CUDA_ARCH__，但我不确定到底发生了什么。

我使用 cmake + visual studio 10 设置项目并编译代码。我怀疑这里是否有什么问题。

我不确定我是否提供了足够的信息。任何帮助表示赞赏。谢谢！

**编辑：** 我试图在 Nvidia CUDA SDK 5.0 中找到使用 __CUDA_ARCH__ 的任何示例。以下代码从项目grabcutNPP中的文件GPUHistogram.h中的第20行到第24行提取。

```
#if __CUDA_ARCH__<300
#define PARALLEL_HISTS 64
#else
#define PARALLEL_HISTS 8
#endif 
```

从第 216 行到第 219 行，它使用 MACRO PARALLEL_HISTS：

```
int gpuHistogramTempSize(int n_bins)
{
    return n_bins * PARALLEL_HISTS * sizeof(int);
} 
```

但是我发现这里有问题。PARALLEL_HISTS 未正确定义。如果我将第一个子句更改为**#if defined(__CUDA_ARCH__)&& __CUDA_ARCH__<300**，我发现**CUDA_ARCH**没有定义。CUDA SDK 示例是否以错误的方式使用**CUDA_ARCH**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T20:47:09.790

我不确定我是否理解可能有一个优雅解决方案的确切问题。这是我过去使用的一种不雅的蛮力方法。在两个单独的 .cu 文件中创建两个具有相同签名但名称不同的内核（例如 foo_sm10()、foo_sm20()。为 sm_10 编译一个文件，为 sm_20 编译另一个文件。将独立于计算能力的通用代码移动到头文件，并从前面提到的两个 .cu 文件中包含它。在主机代码中，创建一个函数指针以调用依赖于体系结构的内核。根据计算能力初始化指向适当的体系结构依赖内核的函数指针在运行时检测到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:43:52.527

如果你想弄清楚你的 GPU 的计算能力，你可以尝试这样的事情：

```
int devID;    
cudaDeviceProp props;
CUDA_SAFE_CALL( cudaGetDevice(&devID) );
CUDA_SAFE_CALL( cudaGetDeviceProperties(&props, devID) );

float cc;
cc = props.major+props.minor*0.1;
printf("\n:: CC: %.1f",cc); 
```

但我不知道如何解决你的问题。

# linq - 使用Linq从参数列表中返回所有匹配的所有记录

> ID：13978203
> 
> 赞同：1
> 
> 时间：2012-12-20T18:23:45.073
> 
> 标签：linq, entity-framework

我有一个带有 CustomerID 和 ProductCode 的简单表。使用以下 Linq 查询，我得到了所有购买了 10EDUC**或**12CONV 而没有购买 10CONV 和 11CONV 的 ID 的列表。我需要做的是让它返回那些购买了 10EDUC**和**12CONV 而没有购买 10CONV 和 11CONV 的人的 ID。

有什么想法吗？TIA

```
var IncludePredicate = PredicateBuilder.True<Products>(); 
var ExcludePredicate = PredicateBuilder.True<Products>(); 
List<string> IncludeProducts = new List<string>();
List<string> ExcludeProducts = new List<string>();
ExcludeProducts.Add("10CONV");
ExcludeProducts.Add("11CONV");

IncludeProducts.Add("10EDUC");
IncludeProducts.Add("12CONV");
IncludePredicate = IncludePredicate.And(m=>IncludeProducts.Contains(m.Service));
ExcludePredicate = ExcludePredicate.And(m => ExcludeProducts.Contains(m.Service));
var IncludeResults = (from d in Products
                          .AsExpandable()
                          .Where(IncludePredicate)
                          .Distinct()
                              select d.CustomerID
                              )
                              .Except(from ex in Services
                                          .Where(ExcludePredicate)
                                          select ex.CustomerID); 
```

# html - 在切换位置之前调整大小？

> ID：13978205
> 
> 赞同：0
> 
> 时间：2012-12-20T18:23:58.990
> 
> 标签：html, css

我有一个像这样的简单设置：

```
<div id="div0">
 <div id="div1">Content</div>
 <div id="div2">Content</div>
</div> 
```

中间的两个 div(1,2) 有 width:100% 和 max-width:390px 加上 floatLeft。当调整浏览器的大小时，div2 会向下跳一行，当宽度小于 390 时，它们都将开始调整大小。

我需要先调整到最小宽度，然后跳到第二行。

我怎么做？

编辑1：示例：http: [//jsfiddle.net/dwDZx/](http://jsfiddle.net/dwDZx/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:57:57.723

这是您所问问题的响应示例。我更改了一些宽度，以便更容易理解示例并查看数字的来源。 [http://jsfiddle.net/dwDZx/4/](http://jsfiddle.net/dwDZx/4/)

我更改了不同响应式布局中的背景颜色，以向您显示在调整浏览器大小时哪个部分处于活动状态。

我对标记所做的唯一更改是在 div1 和 div2 中创建一个“内容”div。这让我可以设置边界。如果我将 div1 和 div2 的宽度设置为 50%*并*设置边框，那么总宽度将为 50%+2px（左 1px + 右 1px），这将导致浮动环绕。通过将边框放在内容 div 上，它将边框*放在*50% 的内部而不是外部。

CSS：

```
* { margin: 0; padding: 0; }

.content { border: 1px solid black; }

#div1, #div2
{
        float:left;
}

@media (min-width: 801px)
{
    #div1, #div2
    {
        width:          400px;
        background: green;
    }
}

@media (min-width: 400px) and (max-width: 800px)
{
    #div1, #div2
    {
        width: 49.9%;
    background: red;
    }        
}

@media (max-width: 399px)
{
    #div1, #div2
    {
        float: none;
        width: 100%;
    }
} 
```

编辑：我考虑了一下并简化了一些事情。见[http://jsfiddle.net/dwDZx/5/](http://jsfiddle.net/dwDZx/5/) CSS 变化如下：在父 div 上设置一个 max-width 为 div1+div2 的最大宽度。那么你只需要一种媒体状态：当它 < 400px 并且应该在一行时。

CSS：

```
* { margin: 0; padding: 0; }

.content { border: 1px solid black; }
#container { max-width: 800px; }

#div1, #div2
{
    float:left;
    width: 50%;
    background: green;
}

@media (min-width: 400px) and (max-width: 800px)
{
    #div1, #div2
    {
        background: red;
    }        
}

@media (max-width: 399px)
{
    #div1, #div2
    {
        float: none;
        width: 100%;
        background: blue;
    }
} 
```

# ruby-on-rails - 嵌套表单错误 - ArgumentError（参数数量错误（0 表示 1））：

> ID：13978213
> 
> 赞同：0
> 
> 时间：2012-12-20T18:24:25.933
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我按照这个截屏视频制作了一个嵌套模型表单。 [http://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)

现在，我正在尝试在我的应用程序中包含这样一个嵌套模型表单，但我收到了一个参数错误（参数数量错误（0 代表 1））。

我似乎无法弄清楚我哪里出错了，我想就我可以尝试什么以及为什么可能会发生一些错误寻求一些建议。

错误发生在主题模型中的这一行。

```
has_many :lessons, :dependent => destroy 
```

其他相关代码：

主题控制器：

```
 def new
    @subject = Subject.new
    #3 times one for lecture one for lab one for tut.
    3.times{@subject.lessons.build}

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @subject }
      format.js
    end
  end 
```

主题模型

```
class Subject < ActiveRecord::Base
  has_many :lessons, :dependent => destroy
  attr_accessible :lesson_attributes, :acad_unit, :cohort_size, :discipline, :remarks, :subject_code, :subject_name, :year_of_study
  accepts_nested_attributes_for :lessons, :reject_if => lambda { |a| a[:lesson_type].blank? }, :allow_destroy => true
end 
```

课程模型

```
class Lesson < ActiveRecord::Base
  belongs_to :subject
  attr_accessible  :frequency, :lesson_type, :no_of_lesson, :possible_venues
end 
```

_form.html.erb

```
 <%= form_for(@subject,:remote=>true) do |f| %>
  <% if @subject.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@subject.errors.count, "error") %> prohibited this subject from being saved:</h2>

      <ul>
      <% @subject.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :subject_code %><br />
    <%= f.text_field :subject_code %>
  </div>
  <div class="field">
    <%= f.label :subject_name %><br />
    <%= f.text_field :subject_name %>
  </div>
  <div class="field">
    <%= f.label :year_of_study %><br />
    <%= f.text_field :year_of_study %>
  </div>
  <div class="field">
    <%= f.label :discipline %><br />
    <%= f.text_field :discipline %>
  </div>
  <div class="field">
    <%= f.label :acad_unit %><br />
    <%= f.text_field :acad_unit %>
  </div>
  <div class="field">
    <%= f.label :cohort_size %><br />
    <%= f.text_field :cohort_size %>
  </div>
  <div class="field">
    <%= f.label :remarks %><br />
    <%= f.text_field :remarks %>
  </div>

  <ol>
  <%= f.fields_for :lessons do |builder| %>
    <%= render "lesson_fields", :f => builder %>
  <% end %>
  </ol>

<% end %> 
```

_lesson_fields.html.erb

```
<p>
<div class="field">
    <%= f.label :lesson_type %><br />
    <%= f.text_field :lesson_type %>
  </div>
  <div class="field">
    <%= f.label :no_of_lesson %><br />
    <%= f.text_field :no_of_lesson %>
  </div>
  <div class="field">
    <%= f.label :frequency %><br />
    <%= f.text_field :frequency %>
  </div>
  <div class="field">
    <%= f.label :possible_venues %><br />
    <%= f.text_field :possible_venues %>
    </div>
</p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:58:49.863

我猜你想要：

```
has_many :lessons, :dependent => :destroy 
```

?

[在这里](https://stackoverflow.com/questions/2797339/rails-dependent-destroy-vs-dependent-delete-all)，您会找到关于主题的精彩讨论。

# ios - 在 UITextView 中定义后取消选择单词

> ID：13978222
> 
> 赞同：0
> 
> 时间：2012-12-20T18:24:51.557
> 
> 标签：ios, cocoa-touch, uitextview, uimenucontroller

我有一个`UIViewController`与`UITextView`它的观点。当用户选择文本时，有*定义*系统菜单项用于`UIReferenceLibraryViewController`定义单词。问题是在字典被解散后单词仍然被选中。我希望它被取消选择（就像在 iBooks 中所做的那样）。

我试图取消选择这个词使用`UIMenuControllerDidHideMenuNotification`：

```
[[NSNotificationCenter defaultCenter] addObserverForName:UIMenuControllerDidHideMenuNotification object:nil queue:nil usingBlock:^(NSNotification *notification) {
    [textView setSelectedRange:NSMakeRange(0, 0)];
}]; 
```

这会取消选择该单词，但也会冻结我`UIViewController`的以下消息：

```
2012-12-20 19:18:45.553 Pilcrow[7018:c07] Warning: Attempt to dismiss from view controller <_UIFallbackPresentationViewController: 0x75b8300> while a presentation or dismiss is in progress!
2012-12-20 19:18:45.963 Pilcrow[7018:c07] Unbalanced calls to begin/end appearance transitions for <_UIFallbackPresentationViewController: 0x75b8300>. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T19:11:41.620

解雇可能需要大约 0.25-0.33 秒。那么在这个持续时间之后做一个`performSelectorAfterDelay`或`dispatch-after`之后怎么样？

# php - fwrite 漏洞

> ID：13978224
> 
> 赞同：-2
> 
> 时间：2012-12-20T18:25:02.897
> 
> 标签：php, file-upload

这是我在我的网站上上传文本文件的原始代码：

```
<?php
$myFile = $_GET['myFile'];
$fh = fopen($myFile, 'w') or die("can't open file");
$stringData = $_GET['stringData'];
fwrite($fh, $stringData);
fclose($fh);
?> 
```

它对你来说足够安全吗，还是我应该使用这样的东西：

```
<?php
if (isset($_GET['myFile'])) {
    $myFile = basename($_GET['myFile']);
    $fh = fopen($myFile, 'w') or die("can't open file");
}
$stringData = $_GET['stringData'];
fwrite($fh, $stringData);
fclose($fh);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:29:15.417

第一个代码不会将文件上传到您的服务器，它只是创建一个具有客户端指定的名称和内容的文本文件。

如果您不指定 的值，第二个代码可能会失败`myFile`： 第二部分将尝试写入一个从未创建过的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:29:25.130

您基本上允许将任何文件上传到当前目录....

例如上传一个 php 脚本，它可以做任何攻击者想要的事情

不......你不应该写那样的代码。

1.  确保仅将文件上传到特定位置。
2.  你给他们起名字——从不接受用户。
3.  学到更多...

# c++ - LIBTIFF 无法使用 C++ 项目

> ID：13978225
> 
> 赞同：0
> 
> 时间：2012-12-20T18:25:02.320
> 
> 标签：c++, libtiff

Libtiff 是一个 C 库，但我想将它与 Qt Creator 中的 C++ 项目一起使用。有谁知道如何做到这一点？当我尝试使用 C 库时出现编译时错误，所以我不确定该怎么做。

我得到的编译时错误是：

c:\libtiff\libtiff\tiff.h:69：错误：C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

对于该行： typedef TIFF_INT8_T int8;

加上一堆更相似的错误。有人请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:53:43.347

您需要将包含语句包装在 extern C 块上——

```
extern "C"{
#include "tiff.h"
} 
```

这告诉编译器将这些文件视为 C，而不是 C++，因此您不应收到严格的 C++ 错误。

# animation - SVG 动画 stroke-dashoffset 行为奇怪

> ID：13978240
> 
> 赞同：1
> 
> 时间：2012-12-20T18:25:59.073
> 
> 标签：animation, svg, smil

我有以下（简化的）SVG：

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" viewBox="0 0 120 100" preserveAspectRatio="none" >
   <script type="text/ecmascript">
       <![CDATA[
        function getPathLength(path)
        {
           alert(path.getTotalLength());
        }
       ]]>
    </script>
   <rect x="0" y="0" width="100%" height="100%" fill="black"/>

   <path id="word" onclick="getPathLength(this);" fill="none" stroke="red" stroke-dasharray="83,83" 
    d="M 8.90625 3.78125 C 8.5377448 3.8134782 8.1622587 3.965423 7.8125 4.21875 C 6.5568946 6.0743722 5.8966744 8.1275786 5.125 10.15625 C 5.2012388 11.683341 4.3280721 13.093169 4.34375 14.59375 C 3.5435523 17.003468 4.9013748 18.393271 4.125 20.90625 C 3.8249969 23.220653 3.3490969 25.389271 2.96875 27.71875 C 2.775721 29.626027 1.7870007 33.314518 4.6875 33.4375 C 6.6892564 33.267533 8.9446263 33.620664 10.6875 32.53125 C 12.308551 32.345986 13.845824 31.488491 14.96875 30.4375 C 15.336184 29.709947 14.506173 29.249547 15.09375 28.53125 C 15.464699 26.390933 13.333175 28.42555 12.53125 28.4375 C 10.625482 29.096293 8.8511553 29.69647 6.875 29.65625 C 5.6218253 29.22028 6.5435685 27.168764 6.34375 26.03125 C 6.6314225 24.872659 6.8389714 23.78868 7.0625 22.53125 C 7.4982943 20.310119 8.0925706 18.009049 8.5 15.84375 C 9.2688601 14.209069 9.0995411 12.312299 9.71875 10.5625 C 10.027547 9.1134942 10.141384 7.3374588 10.5 5.90625 C 10.999008 4.514099 10.011766 3.6845653 8.90625 3.78125 z ">
      <animate attributeName="stroke-dashoffset" begin="0s" from="100%" to="0%" dur="5s" fill="freeze" />
   </path>
</svg> 
```

当我单击路径以获取长度时，Firefox v16 报告 82.4... 这是我用于 dasharray 的。但它从已经绘制的部分路径开始，擦除它然后再次绘制完整路径！？我修改了他的 dasharay 值，当我使用 110 时它可以工作，但我不知道为什么！

我还没有尝试过其他浏览器或更新版本的 Firefox...

注意完整的问题是将单词转换为路径。路径是不连续的 - 它有 5 个部分（脚本形式的“e”、“z”和“h”有一个循环，第一个字母“L”不与其余部分连接）。我想做的是让它看起来像激光正在绘制字母。在之前的问题中，我了解到为 dashoffset 设置动画可以达到这种效果。我终于能够使用 Inkscape 将文本转换为路径。现在我在制作动画时遇到了麻烦。

我尝试为 dasharray 设置动画。这适用于正确的长度，但是对于更大的完整单词示例（7 个字母长和 822 个单位长），它看起来好像有多个路径在起作用——不仅仅是 5 个不连续的部分，而是 9 个不同的路径。当我尝试为完整单词上的 dashoffset 设置动画时，我根本看不到任何动画 - 单词刚刚完全形成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T13:47:25.610

你认为 100% 是路径长度的 100% 吗？如果是这样，那就是你出错的地方，因为它是[viewport width 的 100%](http://www.w3.org/TR/SVG/painting.html#StrokeDashoffsetProperty)。我不认为 Opera 和 Firefox 在这里有错误，特别是因为它们恰好显示相同的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T16:01:47.777

弄清楚了。我试图通过使用百分比来变得可爱，这样我就不必在每个动画命令中输入长度——我所有的动画都是 100% 到 0%。当我用实际长度替换百分比时，它按预期工作。

所以看起来至少是 Firefox 和 Opera 的 SVG 实现中的一个错误，因为文档清楚地表明你可以使用百分比......

# sql - ORA-22275 错误: 指定的 LOB 定位器无效

> ID：13978242
> 
> 赞同：9
> 
> 时间：2012-12-20T18:26:03.350
> 
> 标签：sql, oracle, plsql, oracle11g

我有一个用 PDF 文档填充 BLOB 变量的过程。我要做的是添加逻辑以仅在静态日期后的 60 天内显示 PDF 文档。见下文：

```
check_staticdate     number(1); 

function DisplayPDF (audit in number) RETURN blob is

person_id     person.person_id%type;
z_lob         blob;
blob_length   NUMBER;

CURSOR getPDF(audit number) IS
   select report
   from report_table
   where report_type = 'PDF'
   and job_no = audit order by rec_no;

begin

/* Check Valid ID */
if not package.ValidID(person_id, check_only=>TRUE) then
   return z_lob;
end if;

/* Here is the case statement.*/
select case
   when exists
      (
       SELECT 'x' from table
       where table_id = person_id
       and trunc(sysdate) < trunc(table_static_date + 60)
      )

    then 1
    else 0
   end into check_staticdate
from dual;

if (check_staticdate = 0) then
   return z_lob;
end if;

open getPDF(audit);
fetch getPDF into z_lob;
close getPDF;
return z_lob;

end DisplayPDF; 
```

我收到的错误是：`ORA-22275: invalid LOB locator specified.`

我是 Oracle SQL 的新手，我不确定为什么我的 ValidID 检查通过返回 z_lob 起作用，但我的 case 语句却没有。

**编辑：添加完整的错误堆栈**

```
Failed to execute target procedure ORA-22275: invalid LOB locator specified

ORA-06512: at "SYS.WPG_DOCLOAD", line 51

ORA-06512: at "User.Package", line 733

ORA-06512: at line 33 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-02-26T06:44:51.950

首先用临时初始化你的 lob

```
DBMS_LOB.CREATETEMPORARY(z_lob,true); --true if you want it to be cached. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T00:21:35.923

您的函数可能会返回（取决于您的`audit`参数值）一个带有 NULL 值的 blob 到`SYS.WPG_DOCLOAD`抛出您看到的未处理异常的方法。

也许你可以修改你`return z_lob;`的`return nvl(z_lob, empty_blob());`

# facebook - Session.ReauthorizeRequest 的替代品是什么？

> ID：13978243
> 
> 赞同：3
> 
> 时间：2012-12-20T18:26:07.507
> 
> 标签：facebook, authentication, facebook-android-sdk

在最终的 3.0 SDK 中，ReauthorizeRequest 类消失了。如何替换以下代码？

```
Session.ReauthorizeRequest request = new Session.ReauthorizeRequest(this, PERMISSIONS);
request.setRequestCode(REAUTHORIZE_ACTIVITY);
request.setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK);
request.setCallback(this);
session.reauthorizeForPublish(request); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T07:27:28.380

他们现在正在使用 NewPermissionsRequest。在这里查看：[https ://developers.facebook.com/docs/reference/android/3.0/Session](https://developers.facebook.com/docs/reference/android/3.0/Session)

```
Session.NewPermissionsRequest request = new Session.NewPermissionsRequest(this, PERMISSIONS);
request.setRequestCode(REAUTHORIZE_ACTIVITY);
request.setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK);
request.setCallback(this);
session.requestNewPublishPermissions(request); 
```

# asp.net - Visual Studio 2008 在打开 RDLC 报告时立即关闭

> ID：13978244
> 
> 赞同：1
> 
> 时间：2012-12-20T18:26:15.217
> 
> 标签：asp.net, visual-studio-2008, rdlc

我不知道我是否真的能得到这个问题的答案..

场景：-当我打开解决方案时，RDLC 没有任何问题，并且设计会在屏幕上加载..但是在构建解决方案之后，如果我尝试打开 RDLC，Visual Studio 会意外关闭。这是一个相当大的解决方案，包含大约 230 多个 RDLC 报告

我使用 C# 语言，我的系统 RAM 是 8 GB

有任何想法吗 ？....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T07:51:02.067

场景：-当我打开解决方案时，RDLC 没有任何问题，并且设计会在屏幕上加载.. 但是在构建解决方案之后，如果我尝试打开 RDLC，Visual Studio 会立即关闭

解决方案：- 但是当我删除“Environment.exit(-1)”时

问题得到解决..但我不知道问题仅在构建解决方案后所有 RDLC 报告发生的真正原因..

# java - 驱动器快速入门 NullPointerException

> ID：13978250
> 
> 赞同：6
> 
> 时间：2012-12-20T18:26:46.640
> 
> 标签：java, android, google-drive-api

我正在尝试运行 Google Drive 快速入门示例，但我总是会遇到 RuntimeException。这似乎来自我使用的 API 的深处。

有没有人有同样的问题然后我可以帮助我解决它？这是我的错误代码。

> ```
> 12-20 19:19:54.920: E/AndroidRuntime(15682): FATAL EXCEPTION: Thread-2016
> 12-20 19:19:54.920: E/AndroidRuntime(15682): java.lang.NullPointerException
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at java.net.URI.parseURI(URI.java:353)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at java.net.URI.<init>(URI.java:204)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at com.google.api.client.http.GenericUrl.<init>(GenericUrl.java:100)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at com.google.api.client.googleapis.media.MediaHttpUploader.upload(MediaHttpUploader.java:269)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.executeUnparsed(AbstractGoogleClientRequest.java:408)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.executeUnparsed(AbstractGoogleClientRequest.java:328)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.execute(AbstractGoogleClientRequest.java:449)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at com.example.drivequickstart.MainActivity$1.run(MainActivity.java:97)
> 12-20 19:19:54.920: E/AndroidRuntime(15682):  at java.lang.Thread.run(Thread.java:856)
> 12-20 19:19:55.100: D/OpenGLRenderer(15682): Flushing caches (mode 0)
> 12-20 19:19:55.130: D/OpenGLRenderer(15682): Flushing caches (mode 1)
> 12-20 19:20:19.750: I/Process(15682): Sending signal. PID: 15682 SIG: 9 
> ```

我从 Drive Quickstarttutorial 复制了代码，这是一个 [链接](https://developers.google.com/drive/quickstart-android)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T16:58:46.327

似乎[最初的可恢复上传请求](https://developers.google.com/drive/manage-uploads#resumable)失败，可能是因为授权失败，这导致了 NullPointerException。

确保您使用的是最新版本的客户端库，并在 API 控制台、包名称和 SHA1 指纹中仔细检查您的凭据。

如果这仍然不起作用，请尝试按照通过相同快速入门应用程序设置的分步视频进行操作：[http ://www.youtube.com/watch?v=Ied1CjJ0iP0](http://www.youtube.com/watch?v=Ied1CjJ0iP0)

# jquery - 在 div 中插入元素，并在该 div 中插入具有类的特定元素

> ID：13978254
> 
> 赞同：0
> 
> 时间：2012-12-20T18:26:52.393
> 
> 标签：jquery, dom-manipulation

所以，我没有掌握它。我想要做的是在一个 div 中添加一个脚本元素，该元素有一个带有“colorpick”类的输入标签。

```
<div class="field">
    <input type="text" value="#fefefe" class="colorpick" >
</div> 
```

所以我想要实现的是：

```
<div class="field">
    <input type="text" value="#fefefe" class="colorpick" >
    <script type="text/javascript">$( function() { $('.colorpick').colorpicker(); }); </script>
</div> 
```

这就是我使用外部文件添加内联脚本的方式

```
(function ($) {
    $(document).ready(function () {
        var code = "$( function() { $('.colorpick').colorpicker(); }); ";
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.text = code;
        $("input.colorpick").insertAfter(script);
    });
 })(jQuery); 
```

但不知何故，我无法让它工作，它真的让我很烦恼。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:31:58.203

为什么要尝试使用脚本添加脚本？您可以通过 jquery 添加输入字段，然后通过调用初始化颜色选择器

```
$('.colorpick').colorpicker(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:37:39.343

回答您的问题，您想使用[`$.fn.after`](http://api.jquery.com/after/)not `$.fn.insertAfter`。

```
$("input.colorpick").after(script); 
```

前者在匹配元素之后插入参数，而后者在参数之后插入匹配对象。

> **`.after()`**和**`.insertAfter()`**方法执行相同的任务。主要区别在于语法——特别是内容和目标的位置。使用`.after()`，方法前面的选择器表达式是插入内容的容器。`.insertAfter()`另一方面，内容在方法之前，作为选择器表达式或作为动态创建的标记，它被插入到目标容器之后。

* * *

话虽如此，我也认为您应该直接执行代码。

```
(function($){
  $(function(){
    $('.colorpick').colorpicker();
  });
})(jQuery); 
```

# php - 从 PHP 5.3.8 升级到 5.3.20 后，开始收到无法重新声明类错误

> ID：13978258
> 
> 赞同：1
> 
> 时间：2012-12-20T18:27:01.040
> 
> 标签：php

我最近将 PHP 5.3.8 升级到 5.3.20。升级完成后，我开始收到大量**无法重新声明**的错误：

> [2012 年 12 月 20 日 11:15:00 America/New_York] PHP 致命错误：无法在第 3 行的 /var/www/htdocs/includes/mysql.php 中重新声明类用户

在我的一个 PHP 类中，我使用如下代码在构造函数中实例化一个 mysql 类：

```
class foo {
  function foo() {  
    global $db;

    require '/var/www/htdocs/includes/mySQL.php';
    $db = new mydb_driver();
  }

  function show_text() {
    require '/var/www/htdocs/includes/mySQL.php';
    $db2 = new mydb_driver();
  }
} 
```

在同一个类中，我创建了一个函数，该函数使用不同的变量实例化同一个 mysql 类，以便我可以连接到不同的数据库。第二个要求是触发错误的原因，我不确定为什么。如果我从 show_text 中删除 require 或将其更改为 require_once 它工作正常。

有谁知道这两个版本之间发生了什么变化会导致此代码失败？我什至不确定 $db2 是如何在没有要求的情况下正确初始化的。是否需要类构造函数使其在文件中全局可见？

**编辑：** 这不是日志记录问题，并且在升级之前没有发生错误。在升级之前，这些应用程序运行良好。这就是我在错误日志中启用错误的方式：

```
error_reporting  = E_ALL & ~E_NOTICE 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:28:44.013

试试这个

```
require_once '/var/www/htdocs/includes/mySQL.php';

class foo {
  function foo() {  
    global $db;

    $db = new mydb_driver();
  }

  function show_text() {
    $db2 = new mydb_driver();
  }
} 
```

Requires 属于文件的顶部，虽然速度较慢，但`require_once`​​会阻止文件被要求两次，给你那个错误

不能真正假设知道您要做什么。但是您也可以将其切换为类似的东西，以摆脱全局变量并将更多内容限制为 PSR 标准

```
require_once '/var/www/htdocs/includes/mySQL.php';

class foo {
  private $db;

  public function __construct( )
  {
      $this->db = new mydb_driver();
  }
  public function bar() {  
      // Do bar stuff with $this->db
  }

  public function show_text() {
      // Doo show_text stuff with $this->db
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:32:36.503

在您的班级中，更改`require`为`require_once`. 这可确保文件最多加载一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T18:35:23.880

您在以前的 PHP 版本中也遇到了这些错误。只是您现在才启用错误（这是您在开发环境中应该始终做的事情）。您只能“加载”一次课程。当您要将它部署到产品环境时，您应该仍然启用错误，但只记录它们而不是显示它们。

要启用错误报告，您可以执行以下操作：

```
error_reporting(-1); // or you could do `E_ALL` in PHP 5.4
ini_set("display_errors", 1); 
```

此外，您应该停止使用`global`关键字。这是不好的做法，因为您无法测试代码，引入紧密耦合并可能引入不可预测的结果。

```
class foo {
    private $db;

    public function __construct($db) {
        $this->db = $db;
    }

    public function foo() {  
        $this->db->doSomething();
    }

    public function show_text() {
        $this->db->doSomething();
    }
}

require '/var/www/htdocs/includes/mySQL.php';
$db = new Mydb_driver();
$foo = new Foo($db); 
```

*注意：我还为您的方法添加了可见性（`public`）。尽管默认情况下它们是公开的，但添加它总是更好，这样人们就不会认为这是一个错误。*

您可能还想阅读[自动加载类](http://php.net/manual/en/function.spl-autoload.php)/这会阻止您和朋友这样做`require_*`，`include_*`因此它有助于保持代码清洁，在忘记加载类时防止错误，并且还可以防止像现在这样的错误。

# .net - CLI Reflector 如何存储构造函数可以使用的类型对象

> ID：13978261
> 
> 赞同：1
> 
> 时间：2012-12-20T18:27:17.623
> 
> 标签：.net, generics, containers, command-line-interface, reflector

我会尽量让自己清楚:)。我想实现某种解释器，并且我希望能够以某种方式将类存储为不是对象，而是更像是蓝图，然后可以用来构造这些类的实例。

例如。

这是一个示例道具文件

```
[class]
   myClass 
```

这是一个示例解析器函数

```
Dictionary<String^,Type>^ parserios(String^ file)
{
     /*bla bla bla parsing and we get **Dictionary<String^,Type>^** thatholds string name of class and its blueprint*/
} 
```

让我们为 BaseClassOfSomeSort “**类**”制作静态字典，它将保存*parserios*函数的结果；

现在正在构造函数

```
BaseClassOfSomeSort^ constructFunct(String^ type, array<Object^>^ args)
{
     return gcnew BaseClassOfSomeSort::classes[type](args);
} 
```

我认为可以通过使用 Type::GetType(String^) 函数，然后在返回的 Type 对象上调用 gcnew ，但遗憾的是它不能以这种方式完成。那么有什么办法吗？

# windows-runtime - 如何在 WinRT 中的 ListView 项上捕捉 LongPress？

> ID：13978263
> 
> 赞同：1
> 
> 时间：2012-12-20T18:27:21.077
> 
> 标签：windows-runtime

如何在 WinRT 中的 ListView 项上捕捉 LongPress？

我有一个 ListView，我可以添加一个 OnSelectedItemChanged，但没有像 OnItemLongPress 这样的东西。

怎么做？我需要它来检测应该从列表中删除哪个项目

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:00:06.893

可能有足够的黑客攻击，但推荐的方法是简单地选择项目并以应用程序栏的形式提供上下文菜单。

# html - 缩写标签中的大写还是小写？

> ID：13978264
> 
> 赞同：3
> 
> 时间：2012-12-20T18:27:22.287
> 
> 标签：html, semantic-markup, linguistics, abbreviation, abbr

由于[HTML5 不支持](http://html5doctor.com/the-abbr-element/)Microsoft 的`<acronym>`标签，我们只需要使用 abbreviation 元素：

```
<abbr title="Microsoft">MS</abbr> 
```

当谈到大写时，类似的情况很明显：它需要大写。

但是，在其他上下文中单词本身通常不大写的情况呢？

例如：

```
<p>What is a <abbr title="chief technical officer">CTO</abbr>?</p> 
```

如果要切换标题和实际文本，那似乎很好。

但是当鼠标悬停时，它看起来有点奇怪：

![首席技术官悬停](../Images/2c75319f3e33c165bb6fd13de8807dbb.png)

这同样适用于：

```
<p><abbr title="Chief technical officers">CTOs</abbr> are usually skilled technically.</p> 
```

如果切换缩写和实际文本是有道理的，但悬停也看起来有点“奇怪”：

![在此处输入图像描述](../Images/31d2f24535b5fd097720803789954cf9.png)

现在，如果我们将缩写词大写，就好像它们是标题一样呢？

例如：

```
<p>Wouldn't capitalizing <abbr title="Away From Keyboard">AFK</abbr> look weird?</p> 
```

如果 the`title`被替换为缩写，它会，但是在鼠标悬停时它看起来“更好”：

![在此处输入图像描述](../Images/ce29c1bf5640b131453190ae6bcd7837.png)

但什么是正确的语义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:44:06.707

替换文本应反映被替换后的真实文本。首字母缩略词通常不是由专有名词构成的，因此替换文本应全部小写。

您永远不会真正输入“首席技术官”（除非您错误地认为它们是专有名词）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:47:03.993

来自*芝加哥风格手册*

> 民事、军事、宗教和专业头衔在紧接在个人姓名之前时大写，因此用作姓名的一部分（通常替换头衔持有人的名字）。在正式的散文和其他通用文本（与促销或仪式上下文或标题相反）中，标题通常在名称后面或代替名称时使用小写

所以很明显，你不应该大写 CTO（除非你指的是中央条约组织）。

我不同意你的担忧 - 非大写版本对我来说看起来不错。如果它是用于工具提示样式的弹出窗口，则可以将所有小写字母强制为房屋样式。

和远离键盘真的看起来很奇怪......

（请原谅我的混合拼写，英国英语引用我们英语......）

# python - Django：ImportError，没有名为 urls 的模块

> ID：13978266
> 
> 赞同：7
> 
> 时间：2012-12-20T18:27:33.707
> 
> 标签：python, django, django-urls

我的项目目录中有以下`urls.py`文件：

```
from django.conf.urls import patterns, include, url
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('wb.views',
    url(r'^areas/$', 'arealist'),
    url(r'^areas/(?P<area_id>\d+)/$', 'area_roomlist'),
    url(r'^areas/(?P<area_id>\d+)/rooms/(?P<room_id>\d+)/$', 'area_roomdetail'),
    url(r'^areas/add_area/$','add_area'),
    url(r'^areas/area_added/$', 'area_added'),
    url(r'^rooms/$', 'roomlist'),
    url(r'^rooms/(?P<room_id>\d+)/$', 'roomdetail'),
    url(r'^rooms/add_room/$', 'add_room'),
    url(r'^rooms/room_added/$', 'room_added'),
    url(r'^room_exits/$', 'room_exit_list'),
    url(r'^room_exits/add_room_exit/$', 'add_room_exit'),
    url(r'^room_exits/room_exit_added/$', 'room_exit_added'),
)

urlpatterns += patterns('',
    url(r'^admin/', include(admin.site.urls)),
) 
```

每当我尝试加载页面时，都会收到以下错误：

```
ImportError at /page/, No module named urls 
```

有谁知道发生了什么？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T14:39:08.017

ROOT_URLCONF 在 settings.py 中设置为错误的 urls.py 路径。对不起！

# android - Android ImageView PinchZoom 多种布局

> ID：13978277
> 
> 赞同：0
> 
> 时间：2012-12-20T18:28:21.850
> 
> 标签：android, xml, layout, dynamic, zooming

只是卡在这里，我不知道如何在多个 xml 文件中显示。我有 button1.xml、button2.xml 和 button3.xml。我希望能够在活动中动态切换这些视图。

```
> <LinearLayout
> xmlns:android="http://schemas.android.com/apk/res/android"
>     android:orientation="vertical"
>     android:layout_width="match_parent"
>     android:layout_height="match_parent" >
>       <com.apps.example.TouchImageView
>       android:id="@+id/snoop"
>       android:layout_width="match_parent"
>       android:src="@drawable/keutamaandua"
>       android:layout_height="match_parent" /> 
```

文件

```
public class TouchImageViewActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.button1);
        TouchImageView img = (TouchImageView) findViewById(R.id.snoop);
        img.setImageResource(R.drawable.keutamaandua);
        img.setMaxZoom(4f); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:19:23.450

`setVisibility()`应该可以解决您的问题。使用`view.setVisibility(View.VISIBLE)`和`view.setVisibility(View.GONE)`在活动布局中动态显示和隐藏视图。或者，如果您有多个 xml 文件并且您想在同一个活动中显示它们，那么只需`setContentView(id)`再次使用适当的 id 调用。

# mysql - 检查日期范围内的房间可用性

> ID：13978278
> 
> 赞同：4
> 
> 时间：2012-12-20T18:28:22.690
> 
> 标签：mysql, subquery

您好，我有 2 个桌子房间和预订，但我的桌子结构有点不同，在预订表中有房间、日期、状态，例如：

```
101,2012-12-10,0
101,2012-12-11,0
101,2012-12-12,1
101,2012-12-13,0
102,2012-12-10,0
102,2012-12-11,0
102,2012-12-12,0 
```

我想根据这个要求在 2012 年 12 月 10 日和 2012 年 12 月 13 日之间找到可用的房间，只有房间 102 应该返回。

我试过了

```
SELECT id 
FROM status 
WHERE status='0' 
  AND date between '2012-12-10' AND '2012-12-13' 
GROUP BY id 
```

它不起作用，因为即使只找到一个可用行它也会为 101 返回 true

所以 101 可用于 2012-12-11，然后显示为可用但不适用于我们的数据范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:34:17.057

如果日期有与之关联的时间，则需要执行以下操作：

```
SELECT id 
FROM status 
WHERE status='0' 
  AND date between '2012-12-10 00:00:00' AND '2012-12-13 23:59:59' 
GROUP BY id 
```

您也可以使用 Date(date) 而不是包括时间，但这可能效率较低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:35:36.170

您应该能够使用以下内容：

```
SELECT roomid 
FROM status s1
WHERE status='0' 
  AND date between '2012-12-10' AND '2012-12-13' 
  and not exists (select roomid
                  from status  s2
                  where status='1' 
                    AND date between '2012-12-10' AND '2012-12-13'
                    and s1.roomid = s2.roomid)
GROUP BY roomid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/58797/6)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T18:38:09.920

试试这个：

```
SELECT rd.* 
FROM room_details rd 
INNER JOIN (SELECT DISTINCT roomid FROM bookings 
            WHERE roomid NOT IN (SELECT roomid FROM bookings 
                                WHERE STATUS =0 AND DATE BETWEEN '2012-12-10' AND '2012-12-13')
                ) AS a ON rd.roomid = a.roomid 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T18:39:07.813

`status=1`这将选择在您选择的间隔内没有行的所有房间。请注意，我没有使用`between`：如果`status=1`在 12 月 13 日，房间在此期间仍然可用，这就是我使用的原因`>= and <`：

```
SELECT roomid
FROM status
WHERE `date` >= '2012-12-10'
      AND `date` < '2012-12-13'
GROUP BY roomid
HAVING sum(status.status=1)=0 
```

如果您的表中还可能缺少一些天数，并且这意味着房间未预订但也没有可用，您也可以使用此查询：

```
SELECT roomid
FROM status
WHERE `date` >= '2012-12-10'
      AND `date` < '2012-12-13'
      AND status=0
GROUP BY roomid
HAVING count(*)=DATEDIFF('2012-12-13', '2012-12-10') 
```

检查间隔中的天数是否等于状态 = 0 的行数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T18:43:03.900

SQL BETWEEN 条件将返回表达式在 value1 和 value2（包括）范围内的记录。所以`101,2012-12-10,0`应该为上述查询返回行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-30T09:28:42.720

试试这个：

```
SELECT roomid
FROM status
WHERE 'date_from' <= "2012-12-10"  AND 'date_to' > "2012-12-10" AND 'status'= 0; 
```

# ruby-on-rails - ActiveRecord：另一个 has_many 中的 Has_many - 使用 rails3

> ID：13978279
> 
> 赞同：2
> 
> 时间：2012-12-20T18:28:24.973
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, has-many

所以我正在建立一个页面和应用程序以及应用程序内容的系统。其中一个页面 has_many :app_instances 和 app_instances has_many :app_contents。

我有模型：page、app、app_instance、app_content

在我的模型中：

```
class Page < ActiveRecord::Base
  has_many :app_instances
end

class App < ActiveRecord::Base
  belongs_to :page
end

class AppInstance < ActiveRecord::Base
  belongs_to :page
  belongs_to :app
  has_many :app_contents
end

class AppContent < ActiveRecord::Base
  belongs_to :app_instance
  belongs_to :app
end 
```

我想要一个对象，其中所有内容都在应用程序实例下的单个内容下......但是有没有办法做到这一点？

我在我的一个控制器中设置了这个：

```
@page = Page.includes(:app_instances).find(params[:id]) 
```

我可以成功调试@page.app_instances，但我一说@page.app_instances.app_contents 就会出错。我猜这只是因为我缺少包含中的包含，但不确定我是如何写的，或者即使这是“好习惯”

我知道我可能会这样做：

```
has_many :app_contents, :through => :app_instances 
```

但我宁愿让对象与保存内容的实例一起组织（这是有道理的，对吗？）......所以我可以遍历所有实例，并打印出实例的内容

我的数据库架构有意义吗？还是我走错路了

乔尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:40:33.300

您可以使用以下方法包含嵌套：

```
Page.includes(:app_instances=>[:app_contents]) 
```

但是您收到错误的主要原因是，在`@page.app_instances.app_contents` page.app_instances 中没有任何`app_contents`. 你会寻找`app_contents`所有`app_instances`的联合`@page`

因此可以通过以下方式完成：

```
@page.app_instances.app_contents.each{|ai| (list || =[]) << ai.app_contents}
list.flatten! 
```

或者

在模型中定义`page has many app_contents through app_instances`关系。

第一种情况将为**每个**app_instances 运行查询，但是使用如前所述的包含将导致单个查询*。*第二种情况会导致单个连接查询加入 app_contents、app_instances 表

# sql-server - Sql Service Broker 和事务

> ID：13978281
> 
> 赞同：3
> 
> 时间：2012-12-20T18:28:37.827
> 
> 标签：sql-server, queue, service-broker

MSDN 上的所有示例都将发送和接收语句放在事务中。以下脚本来自[http://msdn.microsoft.com/en-US/library/bb839499(v=sql.100).aspx](http://msdn.microsoft.com/en-US/library/bb839499(v=sql.100).aspx)

*问题1：*为什么所有的例子都没有`begin try...end try begin catch...end catch`用来处理异常？

*问题2：*如果消息消费/处理需要很长时间怎么办？可以对 SSB 语句进行长期事务吗？最好的方法是什么？

*问题 3：*如果消息名称不是，则以下代码不会结束对话`'//AWDB/1DBSample/RequestMessage'`。它是一个错误吗？

```
DECLARE @RecvReqDlgHandle UNIQUEIDENTIFIER;
DECLARE @RecvReqMsg NVARCHAR(100);
DECLARE @RecvReqMsgName sysname;

BEGIN TRANSACTION;

WAITFOR
( RECEIVE TOP(1)
    @RecvReqDlgHandle = conversation_handle,
    @RecvReqMsg = message_body,
    @RecvReqMsgName = message_type_name
  FROM TargetQueue1DB
), TIMEOUT 1000;

-- Process.... May take a long time

IF @RecvReqMsgName =
   N'//AWDB/1DBSample/RequestMessage'
BEGIN
     DECLARE @ReplyMsg NVARCHAR(100);
     SELECT @ReplyMsg =
     N'<ReplyMsg>Message for Initiator service.</ReplyMsg>';

     SEND ON CONVERSATION @RecvReqDlgHandle
          MESSAGE TYPE 
          [//AWDB/1DBSample/ReplyMessage]
          (@ReplyMsg);

     END CONVERSATION @RecvReqDlgHandle;
END

SELECT @ReplyMsg AS SentReplyMsg;

COMMIT TRANSACTION; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T15:29:37.640

*答案 1：*所有示例都没有使用 begin try...end try begin catch...end catch 来处理异常，因为它们是示例 - 所以它们应该简洁明了以便理解，而不是包含用于在生产中实现的代码.

*答案 2：*可以对 SSB 语句进行长期事务。SSB 有助于避免关键的长期事务。您可以使用 SSB 开始异步处理，并立即在您的关键代码中更进一步。也许您应该找到除 SSB 之外的另一种解决方案，特别是针对您的情况。

*答案 3：*这不是错误，因为`RECEIVE TOP(1)`可能包含其他消息，例如错误消息。因此，您似乎需要将处理代码重新定位在`IF...END`部分内，这意味着您收到了正确的消息并且应该处理它：

```
IF @RecvReqMsgName =
   N'//AWDB/1DBSample/RequestMessage'
BEGIN

 -- Process.... May take a long time

 DECLARE @ReplyMsg NVARCHAR(100);
     SELECT @ReplyMsg =
     N'<ReplyMsg>Message for Initiator service.</ReplyMsg>';

     SEND ON CONVERSATION @RecvReqDlgHandle
          MESSAGE TYPE 
          [//AWDB/1DBSample/ReplyMessage]
          (@ReplyMsg);

     END CONVERSATION @RecvReqDlgHandle;
END 
```

# java - 使用 jquery 更改菜单的背景颜色

> ID：13978282
> 
> 赞同：5
> 
> 时间：2012-12-20T18:28:37.563
> 
> 标签：java, php, jquery, css

我正在尝试用 Zenphoto 建立一个照片库。他们使用 php，可以像这样添加自定义菜单：

```
 <div id="navmenu">
    <?php printCustomMenu('main_menue'); ?>
    </div> 
```

我在样式表中更改了整个事物的外观，如下所示：

```
#navmenu {
        width: 1000px;
        height: 42px;
        margin: 0px auto 30px auto;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        text-align: left;
        font-size: 21px;
        background-color: #000000
        }

#navmenu li {
        display: inline; 
        }

#navmenu a {
        color: #eee;
        display: inline;
        line-height: 2em;
        padding: 0.375em 0.5em;
        text-decoration: none;
            }

#navmenu a:hover {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-size: 21px;
        color: #000000;
        background-color: #ffff33;
        padding: 0.375em 0.5em;
            } 
```

现在我想更改各个菜单项的背景颜色，以便每个菜单项都有自己的颜色。随机与否我不在乎。我创建了一个正确连接的 js 文件。

我已经尝试了几段找到的代码，但没有任何效果。现在我试着这样做，看看我是否可以改变颜色：

```
 $(document).ready(function() {

 $("navmenu").hover(function(){
  $(this).css('background-color', '#eeeeee')
 });
}); 
```

不工作。我是所有这些编程的新手，我将非常感谢任何帮助。如果你能回答傻瓜，那就太好了，这样我就可以理解了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:33:19.493

利用：

```
$("#navmenu").hover(function(){ 
```

您错过了 ID`#`选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:41:13.507

您需要使用 # 作为 ID 或 . 对于一个类：

```
$(document).ready(function() {

$("#navmenu").hover(function(){
  $(this).css('background-color', '#eeeeee')
 });
}); 
```

给初学者的提示：如果你没有得到你期望的结果，你可以通过在任何地方抛出控制台日志消息来验证函数是否被调用，如下所示：

```
$(document).ready(function() {
    console.log("document ready!");
    $("#navmenu").hover(function(){
        console.log("hover activated");
        $(this).css('background-color', '#eeeeee')
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:41:52.650

您可以尝试这样的事情，因为它会`random color`打开`hover`并切换回事件的`#EEE`背景`hover out`：

**jQuery：**

```
$(function () {
    $("#navmenu a").hover(function () {
        var newColor = Math.floor(Math.random() * 16777215).toString(16);
        $(this).css('background-color', '#' + newColor);
    }, function () {
        $(this).css('background-color', '#EEE')        
    });
});​ 
```

工作示例：http: [//jsfiddle.net/Qc4R7/](http://jsfiddle.net/Qc4R7/)

# list - Haskell 检查 Int 列表是否完整

> ID：13978290
> 
> 赞同：3
> 
> 时间：2012-12-20T18:29:48.110
> 
> 标签：list, haskell

很难解释这一点，但我会尝试。我想我把我的方法和一些 C 混淆了，但它是这样的：

我想检查一个列表是否完整，如下所示：

```
main> check 1 [1,3,4,5]
False

main> check 1 [1,2,3,4]
True 
```

它是一个有限列表，并且不必对列表进行排序。但在列表中，最有可能错过的数字是 True。在第一种情况下，它是数字 2。

这是我的版本，但它甚至没有编译。

```
check :: Eq a => a -> [a] -> Bool
check n [] = False
check n x | n/=(maximum x) = elem n x && check (n+1) x
          | otherwise = False 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:49:30.423

因此，如果我理解正确，您需要检查列表中的所有元素在排序时是否形成一个没有间隙的序列。这是一种方法：

```
noGaps :: (Enum a, Ord a) => [a] -> Bool
noGaps xs = all (`elem` xs) [minimum xs .. maximum xs] 
```

`[minimum xs .. maximum xs]`创建从最低到最高值的所有值的顺序列表。然后您只需检查它们是否是`all` `elem`原始列表的条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T18:49:54.230

您的函数无法编译，因为您的类型约束大于您声明的约束。你说`a`那只需要是`Eq`- 的一个实例，但是你向它添加了一些东西，这要求它是一个`Num`. 您使用该函数的方式对于您声明的签名也没有意义 -在您的示例中`check [1,2,3,4]`是 a `Bool`，但在您提供的代码中`Eq a => [[a]] -> Bool`（如果它首先编译）。

你只需要这个来处理整数吗？如果不是，请举例说明在这种情况下“完成”是什么意思。如果是，那么它们总是以 1 开头吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:20:37.700

这是对该问题的另一种看法，它使用了一个适用于排序列表的函数，并将其与排序输入一起使用。

以下将检查提供的`n`Int 列表是否包含从`1`to的所有值`n`：

```
 check :: (Num a, Ord a) => [a] -> Bool

  import List

  check l = check_ 1 (sort l)
     where check_ n [] = True
                 check_ n [x] = n == x
                 check_ n (x:y:xs) = (x+1)==y && check_ (n+1) (y:xs) 
```

请注意使用`List.sort`来为在 中实现的真实检查准备列表`check_`。

# vb.net - Lambda 函数 - 修剪或删除字符串返回类型 VB - 休闲查询

> ID：13978292
> 
> 赞同：0
> 
> 时间：2012-12-20T18:30:05.280
> 
> 标签：vb.net, string, lambda

这不是世界上最重要的问题，实际上这是我在工作日结束时给自己设定的一个小挑战。

基本上，我已经将标准函数转换为 Lambda，但不能用进一步的 Remove 语句完全替换扩展。那么任何热衷于 VB 中的 Lambda 的人都可以解释一下我该怎么做吗？

```
 Property Inquery As Func(Of List(Of Integer), String) = Function(x) x.Aggregate("IN(", Function(current, id) current & (id & ",")).ToString.qtrim

<Extension()>
Function qTrim(str As String)
    qTrim = str.Remove(str.Length - 1, 1) & ")"
End Function 
```

由于 Meta-Knight 很友好地为我提供了一个很好的答案，我认为包含我现在使用的版本是公平的，如果他们想要的话，可以为其他人包含三元 if 语句:)

```
 Property Inquery As Func(Of List(Of Integer), String) = Function(intList) If(intList.count > 0, "IN(" & String.Join(",", intList) & ")", "-1") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:30:20.063

我建议你使用更简单的`String.Join`方法：

```
Property Inquery As Func(Of List(Of Integer), String) = Function(intList) "IN(" & String.Join(",", intList) & ")" 
```

使用包含数字 1 到 5 的列表，我得到以下输出：

> 输入（1,2,3,4,5）

# cakephp - 在 CakePHP 中翻译月-日组合

> ID：13978297
> 
> 赞同：2
> 
> 时间：2012-12-20T18:30:15.297
> 
> 标签：cakephp, date, translate, cakephp-2.3

`.po`我可以使用我的文件翻译单个月份或日期：

```
echo __('December'); //becomes diciembre
echo __('Thursday'); //becomes jueves
//...etc 
```

但是，当我使用这样的日期格式时：

```
 echo __(date("j F, Y"));  //becomes 20 December 2012 
```

它不翻译 - 我假设是因为我每个月和每一天的翻译都在单独的行中。

通常我会做这样的事情：

```
__(date('j')) . ' ' . __(date('F')) . ' ' . __(date('Y')); 
```

但是，在 CMS 中，管理员可以将日期更改为他们想要的任何格式。所以，它可以是“j F，Y”或“Ymd”，或者......其他任何东西。

我想也许我可以做一个助手或其他东西，将日期分解成碎片，并返回 a 中的每个部分`__()`，但是 - 这似乎有点矫枉过正。是否有捷径可寻？

我在 AppController 中设置我的语言环境：

```
setlocale(LC_ALL, $currentLanguage['locale']);
Configure::write('Config.language', $currentLanguage['code2']); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T23:34:42.060

原来 CakePHP 有一个[TimeHelper`i18nFormat`函数](http://api.cakephp.org/class/time-helper#method-TimeHelperi18nFormat)：

```
$time = time();
$timestring = $this->Time->format('Y-m-d H:i:s', $time);
$this->Time->i18nFormat($timestring, "%A %e %B %Y"); 
```

创建一个文件“LC_TIME”（无扩展名）并将其放在您的`/Locale/ara/`文件夹中（或将“ara”替换为您想要的任何 3 字符语言代码）

复制[CakePHP 的 time_test LC_TIME 文件](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Test/test_app/Locale/time_test/LC_TIME)的内容并将其放入您的文件中（当然要保存）。

然后将其内容更改为您想要的任何语言（我相信该示例是西班牙语）。

就是这样！

**笔记：**

此处有关 LC_TIME 文件的更多详细信息：http: [//pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp ?topic=%2Fcom.ibm.aix.files%2Fdoc%2Faixfiles%2FLC_TIME.htm](http://pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp?topic=%2Fcom.ibm.aix.files%2Fdoc%2Faixfiles%2FLC_TIME.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:59:59.977

该类`CakeTime`（因此也是`TimeHelper`）使用“蛋糕”域进行日期和月份名称的翻译。所以把这些翻译放在`cake.po`文件中而不是`default.po`

# c# - 将 C# 引用传递给 C++ 指针并返回

> ID：13978300
> 
> 赞同：4
> 
> 时间：2012-12-20T18:30:17.197
> 
> 标签：c#, interop, pinvoke, marshalling, dllimport

我想将 C# 引用传递给 C/C++ 代码（指针），然后从指向 C#reference 的指针中取回它。我有很多对（uint，Object）。我在 C 代码中创建了排序机制，因为它比 C# 快得多。只需要键（uint）和值（对象引用）。C 代码使用键进行排序，并且没有更改值（指针）。有什么简单的方法吗？我需要使用编组吗？C 函数会被调用很多次（甚至可能是一百万次），所以我担心编组速度太慢，我什至不知道如何编组。我相信当 GC 更改对象地址时，C# 引用的地址不会更改。因此不需要将对象放置在固定内存中。我说得对吗？现在我可以使用 DllImport 调用 C 函数，我可以存储对 C 指针的 C# 引用，

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:31:47.997

无法将任何变量直接从托管 c# 代码传递到本机 c++ 代码。解决方案是 pinvoke，您可以在其中编组数据。

这工作正常，但你应该知道这不是每次都快速的解决方案。在每次调用时，都必须复制内存，并可能根据数据类型进行转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:13:19.640

我对类似问题的解决方案，我在 Fortan 中有一些旧代码。我将此代码转换为 c，然后创建了一个托管 c++ 项目。在 c# 中，我将这个管理的 c++ 项目称为。

c# 代码如下所示：

> unsafe
> {
> double* input = (double*)utils.Memory.Alloc(sizeof(double) * n);
> 双* 输出 = (double*)utils.Memory.Alloc(sizeof(double) * n);
> //调用c++代码
> c_plus_plus.code(input,output); //现在输出包含输出
> //（您可以使用相同的数组作为输入和输出
> }

我希望这有帮助。

# c# - 将选项对话框中的日期/时间值发送到服务器组件

> ID：13978303
> 
> 赞同：1
> 
> 时间：2012-12-20T18:30:24.703
> 
> 标签：c#, scope, datetimepicker

我需要设置日期和时间（我打算使用 DateTimePicker）来在用户界面软件模块的选项对话框中设置任意日期和时间。然后我需要将它传递给一个单独的服务器组件，该组件将使用该值作为当前日期和时间，并从那里正常增加时间。服务器还将通过 TCP/IP 或 RS232 将日期和时间发送到一个字符串变量到客户端设备。

我怀疑服务器代码需要包含以下内容

```
TimeSpan duration = new TimeSpan();
string futureDay = string.Format("{0:dd}", DateTime.UtcNow.Add(duration));
string futureMonth = string.Format("{0:MM}", DateTime.UtcNow.Add(duration)); 
```

等等，对于所有日期/时间字段（现在我想到了，我可能只使用“日期”和“时间”字段而不进一步分解它们）。

作为编程新手，我不确定如何将值从选项对话框一直传递到服务器上的持续时间对象，或者我是否应该使用配置文件来存储日期和时间值并以某种方式拥有它配置文件对服务器对象可见，并使用那里的值。

最终，这些值将被放入 GPS NMEA 语句中，例如，使时间可配置的目的是测试设备对夏令时的反应。

# c# - 如何使用asp.net c#将表添加到数据库（SQL Server）

> ID：13978304
> 
> 赞同：-2
> 
> 时间：2012-12-20T18:30:25.637
> 
> 标签：c#, asp.net, database

> **可能重复：**
> [以编程方式创建 sql 表](https://stackoverflow.com/questions/10033758/create-sql-table-programmatically)

因此，对于我的项目，我需要创建一个名册表（其中包括员工列表及其一周的工作时间，周六至周五）。但是，我不知道如何将此特定表添加到数据库中。我知道如何将文本框中的特定字段添加到我的 sql server 数据库中，但我无法将表保存到数据库中！想法是将这些每周花名册表添加到数据库中。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:41:33.743

您可能不想每周为每个名册添加一个新表到数据库中。这将使历史查询（例如，员工在过去 4 周内工作的小时数）变得比他们需要的要困难得多。更好的方法可能是使用您预先创建的几个表：

```
Rosters
-------
INT RosterId (or GUID, or whatever type of ID you want)
DATETIME Week

RosterRecords
-------------
INT RosterId
INT EmployeeID (or however employees are identified)
DECIMAL Hours 
```

Rosters 中的 RosterId 链接到 RosterRecords 中的 RosterId。然后，您只有一堆名册记录，每个员工每周/名册一个。现在您不需要以编程方式为每周创建新表；您只需在 Rosters 中注册一个新的名册并在 RosterRecords 中创建其成员；如果在查询中需要，您可以稍后进行联接以将名册与其记录相关联。

# build - EA 在 Java 版本中代表什么？

> ID：13978309
> 
> 赞同：17
> 
> 时间：2012-12-20T18:30:41.830
> 
> 标签：build, version, java

`> java -version`

```
java version "1.7.0_10-ea"                                   <----      !
Java(TM) SE Runtime Environment (build 1.7.0_10-ea-b15)
Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode) 
```

请问我是最后一个`JDK 7u10`吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-20T18:32:40.570

EA 代表“Early Access”，EA 是该软件即将发布的版本的预览版。

查看此**[链接](http://java.com/en/download/faq/oem.xml)**：-

> **EA 发布**
> 
> EA 代表“Early Access”，EA 是该软件即将发布的版本的预览版。此版本可能包含许多新功能和错误修复，并且作为预览版可能包含一些意外问题。不建议在生产环境中使用此预览版。请在 java.com 上升级到最新版本

**附带说明：-**

还有两个版本：-

> **OEM 发布**
> 
> OEM 代表“原始设备制造商”。向 OEM 提供了 Java 1.6.0-oem 的早期版本。OEM 术语将不会在 1.6 的后续版本中使用。请在 java.com 上升级到最新版本
> 
> **测试版**
> 
> Beta 版是经过错误测试的“稳定”预览版。Beta 版本通常可供公众下载和测试。请在 java.com 上升级到最新版本

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-20T18:33:12.323

`-ea`代表“早期访问”：

> [http://java.com/en/download/faq/oem.xml](http://java.com/en/download/faq/oem.xml)
> 
> EA 代表“Early Access”，EA 是该软件即将发布的版本的预览版。此版本可能包含许多新功能和错误修复，并且作为预览版可能包含一些意外问题。不建议在生产环境中使用此预览版。请在 java.com 上升级到最新版本

# spring - 通过 spring mvc 加载框架/iframe

> ID：13978312
> 
> 赞同：1
> 
> 时间：2012-12-20T18:31:03.240
> 
> 标签：spring, jsp, spring-mvc, iframe

我有一个问题，当用户按下页面顶部的提交按钮时，另一个 jsp 被加载到下面的框架/iframe 中。我使用的是 Spring MVC 架构，jsp 由控制器决定。我应该如何让控制器将 jsp 映射到 iframe？对于所有以前的映射，我使用了 @RequestMapping 注释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T00:55:44.757

我会使用 Javascript 执行此操作，例如使用 JQuery，您可以`onSubmit`在表单上调用 even 以在 iframe 中加载响应（html 内容）时执行 ajax 调用：

```
$('form').submit(function() {
    jQuery.ajax({
        type : 'POST',
        data : jQuery(this).serialize(),
        url : '/post_action',
        success : function(data, textStatus) {
            jQuery('#iframeId').contents().find('body').append('data');
        },
        error : function(XMLHttpRequest, textStatus, errorThrown) {
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T19:42:10.087

就用这个东西—— $("#iFrameId").attr("src", "controller.mth");

这样从控制器返回的 jsp 将被加载到 iframe 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-10T09:26:30.423

使用 Spring MVC，我`request.getContextPath`在 scriptlet 中使用后，ajax url 就可以工作了。

我的控制器收到此更改后的请求并返回 jsp 页面。`append('data')`在将示例更改为之后，jsp 然后显示在 iframe`append(data)`中。请注意，**删除**了数据中的引号以使其正常工作。

```
function openPage() {
  jQuery.ajax({
     type : 'POST',
     data : jQuery(this).serialize(),
     url : '<%=request.getContextPath()%>/post_action',
     success : function(data, textStatus) {
     jQuery('#iframeId').contents().find('body').append(data);
     },
     error : function(XMLHttpRequest, textStatus, errorThrown) {
     }
  });
} 
```

# php - 使用 PHP 和 CodeIgniter 将包含变量的多行字符串保存到文件中

> ID：13978319
> 
> 赞同：0
> 
> 时间：2012-12-20T18:31:31.087
> 
> 标签：php, string, codeigniter, codeigniter-2, fwrite

**我正在尝试以纯文本格式**保存多行字符串，如下所示：

```
define host {
        use                     template;
        host_name               $host_name;
        address                 46.224.2.220;
        contacts                $email;
} 
```

**但是变量，例如 $host_name 和 $email 必须用它们的值替换。s**

我想不通。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:00:31.500

您可以使用[str_replace](http://php.net/manual/en/function.str-replace.php)

```
$plain_text = "define host {
        use                     template;
        host_name               $host_name;
        address                 46.224.2.220;
        contacts                $email;
}";

$find = array("$host_name", "$email");
$replace = array($host_name, $email);

$new_plain_text = str_replace($find, $replace, $plain_text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T00:38:17.307

`$variables`当字符串用双引号或使用 heredoc 语法 ( [reference](http://php.net/manual/en/language.types.string.php#language.types.string.parsing) ) 指定时，将展开。所以你可以简单地做：

```
$host_name = 'foo';
$email = 'bar';

$plain_text = "define host {
        use                     template;
        host_name               $host_name;
        address                 46.224.2.220;
        contacts                $email;
}"; 
```

但是，变量必须在字符串表达式之前定义。如果不是，您可以使用`str_replace()`其他答案中解释的方法。

# sql - 如何按 SQL 中的两列之一分组？

> ID：13978327
> 
> 赞同：0
> 
> 时间：2012-12-20T18:32:11.597
> 
> 标签：sql, sqlite, greatest-n-per-group

我有一张表格：

```
创建表消息（
    id VARCHAR(40),
    src VARCHAR(40),
    目标 VARCHAR(40),
    时间 TIMESTAMP 默认 CURRENT_TIMESTAMP
);
```

我想编写一个查询，它将返回所有 id 的列表（src 或 dest 字段）以及对应于最新消息的消息 id。我不太明白如何以`GROUP BY`这种方式使用。此外，此查询需要快速（这就是为什么我不想简单地合并两个查询：一个用于 src，一个用于 dest）。但归根结底，性能是关键，不管它是如何完成的。

样本数据：

```
id、src、dest、时间
0, 0, 1, '2012-10-19 01:15:15'
1, 1, 0, '2012-10-20 01:15:15'
2, 0, 1, '2012-09-19 01:15:15'
3, 1, 0, '2012-04-20 01:15:15'
4, 2, 1, '2013-04-20 01:15:15'
5, 1, 0, '2012-04-20 01:15:15'

```

预期输出：

```
身份证，人
1, 0
4, 1
4, 2

```

当前查询：

```
SELECT m1.id,m1.src AS person FROM Messages m1 WHERE m1.time IS (SELECT MAX(time) FROM Messages m2 WHERE m2.src=m1.src OR m2.dest=m1.src)
联盟
SELECT m1.id,m1.dest AS person FROM Messages m1 WHERE m1.time IS (SELECT MAX(time) FROM Messages m2 WHERE m1.dest=m2.dest OR m1.dest=m2.src)

```

但是，对于具有 5163 行的表，这需要 19.99 秒。该查询有 26,661,730 步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:21:36.097

我怀疑您的查询的问题不是`union`相关的子查询，而是相关的子查询。这是一种使用技巧来获取与最大时间关联的 id 的方法。它将 id 附加到时间的末尾，然后应用`max()`函数：

```
select substr(MAX(maxtime||maxtimeid), 19) as id, person
from (select src as person, substr(MAX(sent||CAST(id as varchar(20))), 19) as maxtimeid, MAX(sent) as maxtime
       from Messages
       group by src
       union all
      select dest as person, substr(MAX(sent||CAST(id as varchar(20))), 19) as maxtimeid, MAX(sent) as maxtime
       from Messages
       group by dest
     )
group by person 
```

尽管此查询具有聚合，但它没有连接。尝试一下，看看你是否能获得更好的性能。请注意，我没有对此进行测试，因此可能存在小的语法错误。

我不知道 SQLite 中联合与外连接的相对性能。但是，您也可以将其表述为：

```
select (case when src.maxtime > dest.maxtime or dest.maxtime is null
             then src.maxtimeid
             else dest.maxtimeid
        end) as id,
       coalesce(src.person, dest.person) as person
from (select src as person, substr(MAX(sent||CAST(id as varchar(20))), 19) as maxtimeid, MAX(sent) as maxtime
       from Messages
       group by src
      ) src full outer join
      (select dest as person, substr(MAX(sent||CAST(id as varchar(20))), 19) as maxtimeid, MAX(sent) as maxtime
       from Messages
       group by dest
     ) dest
     on src.person = dest.person 
```

# php - 如何处理（转义）mysqlclient（C 库）中的 % 登录

> ID：13978330
> 
> 赞同：1
> 
> 时间：2012-12-20T18:32:18.890
> 
> 标签：php, session, session-cookies, mysql

我正在使用mysqlclient，

在我的一个查询中，如下所示

```
sprintf (query, "select user from pcloud_session where id = '%s'", sid); 
```

这里有一段时间这个 sid 像例子一样用 % 登录

```
2Cq%yo4i-ZrizGGQGQ71eJQ0 
```

但是当有这个 % 这个查询总是失败时，我想我必须逃避这个 %，但是如何？

我尝试使用 \ 和 %% ，但这两个都不起作用，请在这里帮助我

**更新：**

当使用 session.hash_bits_per_character = 6 时，在 php session 中，默认字符集包含一个字符（逗号），它将始终被 urlencoded（这里是 %2C）。这会导致 cookie 值中包含此 %2C，但会话 db 中包含逗号而不是逗号。关于解决这个问题的任何想法？..抱歉造成混淆

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:40:00.257

没有必要`'%'`在 MySQL 查询文本中转义文字。

当您说查询“总是失败”时，是对`mysql_query`返回错误的函数的调用吗？它是返回 SQL 异常代码，还是只是不返回您期望的结果集（行）？

对于调试，我建议您`query`在调用`sprintf`. 我们希望字符串的内容是：

```
select user from pcloud_session where id = '2Cq%yo4i-ZrizGGQGQ71eJQ0' 
```

而且我没有看到该 SQL 构造有任何问题（假设该`id`列存在于`pcloud_session`并且是字符数据类型。即使 id 被定义为整数类型，该语句通常也不会引发异常，字符串文字只是解释为 2 的整数值。）

在 sprintf 的目标格式中包含 '%' 文字应该没有问题。在 MySQL 查询文本中包含 '%' 文字应该没有问题。

（当然，我假设这`sid`是由函数调用填充的`mysql_real_escape_string`。）

* * *

同样，我建议您`query`在调用 sprintf 之后回显 的内容。我还建议您确保没有其他代码与该字符串的内容混为一谈，这是作为参数传递给`mysql_query`函数的实际字符串。（如果您正在使用该`mysql_real_query`函数，请确保您传递了正确的长度。）

* * *

**更新**

**Oxi 说：** “它没有返回 SQL 异常代码，只是没有返回我期望的结果 [set]。我确实打印了查询，它打印了 % 。”

**@Oxi**

这里有一大堆问题可能会帮助您找出问题所在。

您是否从 mysql 命令行客户端运行了该查询文本的测试，并返回您期望的行？

该`id`列是否定义为长度为（至少）24 个字符的 VARCHAR（或 CHAR）？列上的排序规则设置为不区分大小写，还是区分大小写？

```
show create table pcloud_session ; 
```

（我没有看到任何会导致字符集转换出现问题的字符，尽管如果您的应用程序与数据库字符集编码不匹配，这可能是问题的根源。）

您是否使用 LIKE 谓词针对该 id 列测试查询？

```
SELECT id, user FROM pcloud_session WHERE id LIKE '2Cq\%yo4i-%' ESCAPE '\\'
 ORDER BY id LIMIT 10 ;

SELECT id, user FROM pcloud_session WHERE id LIKE '2Cq%'
 ORDER BY id LIMIT 10 ; 
```

当您期望一行时，您是否没有返回任何行？您是否返回了太多行，或者您得到的行与您期望的行不同？

`id`对于一列来说，这是一个奇怪的值。起初，它看起来好像该值是以 base-64 编码表示的，但它不是任何标准编码，因为它包含 '%' 和 '-' 字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:45:33.717

如果您打算在没有接口库的情况下在 C 中执行此操作，则**必须**使用[`mysql_real_escape_string`](http://dev.mysql.com/doc/refman/5.0/en/mysql-real-escape-string.html)正确的 SQL 转义。

在 MySQL中使用 '% `inside of a string, though, as the only context in which it has meaning is either directly in`printf `type functions or as an argument to`LIKE` 应该没有任何本质上的错误。

事实证明这很烦人，但这是绝对必要的。这将使您的代码变得更加复杂，这就是为什么在 C 中使用低级 MySQL 通常是一个坏主意。C++ 包装器将为您提供更多支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:49:47.767

你真的不应该自己逃避字符串。最安全的选择是让 MySQL API 为您处理它。

对于最大长度为 n 的字符串，首先分配长度为 2*n+1 的字符串：

```
int sidLength = strlen(sid);
// worst-case, we need to escape every character, plus a byte for the ASCIIZ
int maxSafeSidLength = sidLength * 2 + 1;
char *safeSid = malloc(maxSafeSidLength);

// copy "sid" to "safeSid", escaping as appropriate
mysql_real_escape_string(mysql, safeSid, sid, sidLength);

// build the query
// ...

free(safeSid); 
```

dev.mysql.com上的页面上有一个更长的示例[`mysql_real_escape_string`](http://dev.mysql.com/doc/refman/5.6/en/mysql-real-escape-string.html)，他们在其中构建了整个查询字符串，但上述方法应该适用于向 sprintf 提供 safeSid。

# jbox2d - JBox2d TestbedMain.java“选择不包含主要类型”

> ID：13978332
> 
> 赞同：0
> 
> 时间：2012-12-20T18:32:27.557
> 
> 标签：jbox2d

我已经在 Eclipse Juno 上通过 Maven 安装了 JBox2D，为了测试安装是否正常，我应该尝试运行 TestbedMain.java 但 Eclipse 不断给我错误“选择不包含主类型”，有时“编辑器没有不包含主要类型”。我尝试关闭并重新打开项目、文件和 Eclipse，但没有任何帮助。如果有人知道为什么会发生这种情况或我该如何解决它，那么我将很乐意尝试。我也刚刚开始更深入地学习 Eclipse，所以如果有更深入的步骤，请为我拼写出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T20:06:35.263

确保将所有项目作为 Maven 项目导入，因此您应该会看到列出的 4 个项目。然后确保您右键单击 testbed 或 testbed-jogl 项目:)

# javascript - 验证仅在所有文本输入为空白时才有效，而不是任何文本输入为空白

> ID：13978337
> 
> 赞同：0
> 
> 时间：2012-12-20T18:32:44.443
> 
> 标签：javascript, html, css

当问题中的任何文本输入为空时，我想在警报中生成验证消息。因此，例如，如果问题 1 有 2 个空白文本输入，如果两个文本输入均为空白，则会显示验证消息`You have not entered in a value in all the Indivdiaul Marks textbox`。

但问题是，例如，对于问题 1，如果 1 个文本输入为空白但另一个不是空白，则它不会显示验证消息，即使它应该这样做，因为并非所有文本输入都已为问题 1 填写。

我的问题是，如果每个问题有任何空白文本输入，我如何才能显示验证消息？

这是一个小提琴，因此您可以对其进行测试：http: [//jsfiddle.net/cbyJD/87/](http://jsfiddle.net/cbyJD/87/)

下面是validation()函数代码：

```
function validation() {

    // only keeping track of the final message
    var alertValidation = "",
        // toggle for showing only one error
        showOnlyOneError = true;

    $("input[data-type='qmark']").each(function(i) {  
        var questions = $(this).attr("data-qnum");
        var marks = parseInt($("[class*=q" + (i+1) + "_ans_text]").text()); 
        var txtinput = $(this).val(); 

        // the message for this question
        var msg = '';

        if (txtinput == '') {
            msg += "\n\u2022 You have not entered in a value in all the Indivdiaul Marks textbox \n";
        }

        if (marks < 0) {
            msg += "\n\u2022 Your Total Marks Remaining does not equal 0 \n - You Need To Remove " + Math.abs(marks) +  " Marks";   
        } else if (marks > 0) {
            msg += "\n\u2022 Your Total Marks Remaining does not equal 0 \n - You Have " + marks +  " Marks Remaining";   
        }

        // if there is an error for the question, add it to the main message
        if (msg.length) {
            alertValidation += alertValidation.length ? '\n\n' : '';
            alertValidation += "You have errors on Question Number: " + questions + "\n";
            alertValidation += msg;
            // stop if we only care about the first error
            return !showOnlyOneError;
        }
    });

    // show the error messages
    if (alertValidation != "") {
        alert(alertValidation);
        return false;
    }

    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:06:25.157

`num_groups`首先，添加一个包含组总数的隐藏变量。

```
<p>
  <input type='hidden' id='num_groups' name='num_groups' value='2'>
  <input id="submitBtn" name="submitMarks" type="submit" value="Submit Marks" />
</p> 
```

其次，将`validate`函数更改为处理一组问题：

```
function validation(group) {
  var msg = [];

  var nb = 0;     // Number of blank values
  $("input[data-qnum='" + group + "']").each(function() {
    if ($(this).val() == '') {
      nb++;
      return false;
    }
  });
  if (nb != 0) {
    msg.push("\u2022 You have not entered in a value in all the Individual Marks textbox");
  }

  var marks = parseInt($("[class*=q" + group + "_ans_text]").text()); 
  if (marks != 0) {
    msg.push("\u2022 Your Total Marks Remaining does not equal 0");
    if (marks < 0) {
      msg.push("- You Need To Remove " + -marks + " Marks");
    } else if (marks > 0) {
      msg.push("- You Have " + marks + " Marks Remaining");
    }
  }

  if (msg.length > 0) {
    alert("You have errors on Question Number: " + group + "\n\n" + msg.join("\n"));
    return false;
  } else {
    return true;
  }
} 
```

第三，更改`myClickhandler`函数以验证所有组：

```
myClickHandler = function(e) {
  var ng = $('#num_groups').val();
  for (var group = 1; group <= ng; group++) {
    if (!validation(group)) return false;
  }
  if (confirm("Are you sure you want to Proceed?")) {
    $.ajax({
      url: "insertmarks.php",
      data: $("#markstbl").serialize(),
      async: false,
      type: "POST"
    });
    return true;
  } else {
    return false;
  }
} 
```

JsFiddle[在这里](http://jsfiddle.net/ePRM8/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T05:57:10.870

无论找到什么，该`validation()`函数都会返回。`true`

您需要在此函数的顶部声明一个名为`errors`或类似的变量，其值为`false`. 对于在函数中发现错误的任何地方，将 的值设置`errors`为`true`。

在函数结束时...

```
return !errors; // return the value of errors NOT'ed 
```

然后你在测试中调用 call `validation()`，就像这样......

```
if (validation()) {
    // everything is groovy
} else {
    // make them do the form over, or something
} 
```

# php - 如果字符串包含带有特殊字符的字母数字值，preg_match 中验证字符串的正确语法是什么

> ID：13978338
> 
> 赞同：-6
> 
> 时间：2012-12-20T18:32:45.653
> 
> 标签：php, regex, preg-match

我用过这个...我在某个网站上看到过这个..但它对我的帮助不是很好。

```
if(preg_match("/^[A-Za-z0-9-_\",'\s]+$/",$newPass)) {
    //is valid..
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:16:34.443

如果要测试字符串是否包含至少一个字母数字字符串和至少一个非字母数字字符串，请使用以下正则表达式：

```
/^(?=.*[a-z0-9])(?=.*[^a-z0-9])/i 
```

分手：

*   `/`正则表达式的开始
*   `^`匹配字符串的开头
*   `(?=`如果存在以下内容：
    *   `.*`任何东西（换行符除外），然后
    *   `[a-z0-9]`一个字母数字字符
*   `)`前瞻结束
*   `(?=`如果存在以下内容：
    *   `.*`任何东西（换行符除外），然后
    *   `[^a-z0-9]`非字母数字字符
*   `)`前瞻结束
*   `/`正则表达式的结尾
*   `i`不区分大小写

用法：

```
if(preg_match("/^(?=.*[a-z0-9])(?=.*[^a-z0-9])/i",$newPass)) {
    //is valid..
} 
```

如果您需要字母和数字都存在，请将第一个前瞻替换为两个：

```
/^(?=.*[a-z])(?=.*[0-9])(?=.*[^a-z0-9])/i 
```

# sql - SQL UPDATE 查询优化与规则

> ID：13978339
> 
> 赞同：6
> 
> 时间：2012-12-20T18:32:48.670
> 
> 标签：sql, sql-server, tsql, sql-server-2008-r2

我有两个表`FactLik`（200 万行）和`UpdateStPrice`（500k 行）。我需要`FactLik`使用规则更新表。

## 更新价格

```
| PRODUCTKEY | WAREHOUSEKEY | STARTDATE |  ENDDATE | PRIORITY | UNITPRICE |
---------------------------------------------------------------------------
|      36975 |            6 |  20120630 | 20121011 |        0 |       395 |
|      36975 |            6 |  20121018 | 20291231 |        0 |       371 |
|      36975 |            6 |  20121126 | 20121211 |      120 |       313 |
|      36975 |            6 |  20121126 | 20121219 |      120 |       288 |
|      36975 |            6 |  20121212 | 20291231 |      120 |       313 | 
```

## FactLik

```
|  TIMEKEY | PRODUCTKEY | PRODUCTGROUPKEY | WAREHOUSEKEY |  PRICE |
-------------------------------------------------------------------
| 20121205 |      36975 |              89 |            6 | (null) | 
```

## 更新 FactLik 行的规则

1.  同样`ProductKey`，在MAX 和 和之间的行中`WarehouseKey`找到。`UpdateStPrice``Priority``FactLik.TimeKey``StartDate``EndDate`
2.  现在找到`StartDate`MAX所在的行。
3.  现在找到`EndDate`MIN 所在的行。

预期结果来自`UpdateStPrice`：

```
| PRODUCTKEY | WAREHOUSEKEY | STARTDATE |  ENDDATE | PRIORITY | UNITPRICE |
---------------------------------------------------------------------------
|      36975 |            6 |  20121126 | 20121211 |      120 |       313 | 
```

结果`FactLik`：

```
|  TIMEKEY | PRODUCTKEY | PRODUCTGROUPKEY | WAREHOUSEKEY |  PRICE |
-------------------------------------------------------------------
| 20121205 |      36975 |              89 |            6 |    313 | 
```

**[小小提琴](http://sqlfiddle.com/#!3/c32eb)**

[**大提琴**](http://sqlfiddle.com/#!3/76bb5)

我的[**我的查询**](http://sqlfiddle.com/#!3/c32eb/6) 非常慢，实际上她的运行速度超过了 12 个小时。我在两个表上都有一些索引（建议执行计划），但它们根本没有帮助:)

因此，如果您能帮助我优化此查询，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:00:54.790

我认为你可以通过从 UpdateStPrice 订购数据来做到这一点：

```
UPDATE factlik
SET price =
  (SELECT TOP 1 up.unitprice
   FROM updatestprice up
   WHERE up.productkey = factlik.productkey
   AND up.warehousekey = factlik.warehousekey
   AND factlik.timekey >= up.startdate
   AND factlik.timekey <= up.enddate
   ORDER BY priority desc, startdate desc, enddate 
) 
```

sqlfiddle[在这里](http://sqlfiddle.com/#!3/76bb5/13)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:50:14.470

在子查询表参考中，这似乎是为窗口函数量身定制的：

```
UPDATE factlik SET price = up.unitprice
FROM factlik
JOIN (SELECT factlik.timekey, factlik.productkey, factlik.warehousekey,
             up.unitprice,
             ROW_NUMBER() OVER(ORDER BY up.priority DESC, 
                                        up.startdate DESC, 
                                        up.enddate ASC) as rownum
      FROM updatestprice up
      JOIN factlik
        ON up.productkey = factlik.productkey
           AND up.warehousekey = factlik.warehousekey
           AND up.startdate <= factlik.timekey
           AND up.enddate > factlik.timekey) up
  ON up.timekey = factlik.timekey
     AND up.productkey = factlik.productkey
     AND up.warehousekey = factlik.warehousekey
     AND up.rownum = 1 
```

（[运行与前面的示例相同](http://sqlfiddle.com/#!3/c32eb/55/1)。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:46:41.437

这应该工作：

```
UPDATE factlik
SET price =
    (SELECT 
        unitprice
    FROM 
        updatestprice u INNER JOIN
            (SELECT 
                ms.productkey,
                ms.warehousekey,
                max_priority,
                max_start,
                MIN(enddate) AS min_end
            FROM
                updatestprice u INNER JOIN
                factlik f ON
                    u.productkey = f.productkey AND
                    u.warehousekey = f.warehousekey AND
                    timekey >= startdate    AND 
                    timekey <= EndDate INNER JOIN
                (SELECT 
                    mp.productkey,
                    mp.warehousekey,
                    max_priority,
                    MAX(startdate) AS max_start
                FROM
                    updatestprice u INNER JOIN
                    factlik f ON
                        u.productkey = f.productkey AND
                        u.warehousekey = f.warehousekey AND
                        timekey >= startdate    AND 
                        timekey <= EndDate INNER JOIN
                        (SELECT 
                            u.productkey,
                            u.warehousekey,
                            MAX([priority]) AS max_priority
                        FROM
                            updatestprice u INNER JOIN
                            factlik f ON
                            u.productkey = f.productkey AND
                            u.warehousekey = f.warehousekey AND
                            timekey >= startdate    AND 
                            timekey <= EndDate
                        GROUP BY
                            u.productkey,
                            u.warehousekey  ) mp ON
                    u.productkey = mp.productkey AND
                    u.warehousekey = mp.warehousekey AND
                    u.priority = mp.max_priority
                GROUP BY
                    mp.productkey,
                    mp.warehousekey,
                    max_priority
                ) ms ON
                u.productkey = ms.productkey AND
                u.warehousekey = ms.warehousekey AND
                u.priority = ms.max_priority AND
                u.startdate = ms.max_start 
            GROUP BY
                ms.productkey,
                ms.warehousekey,
                max_priority, 
                max_start           
                ) me ON
        u.productkey = me.productkey AND
        u.warehousekey = me.warehousekey AND
        u.priority = me.max_priority AND
        u.startdate = me.max_start AND
        u.enddate = me.min_end) 
```

返回：

```
PRODUCTKEY  WAREHOUSEKEY    STARTDATE   ENDDATE     PRIORITY    UNITPRICE
36975       0               20121018    20291231    0          371
36975       0               20120630    20121011    0          395
36975       0               20121126    20121211    100        313
36975       0               20121212    20291231    100        313
36975       0               20121126    20121219    100        288
36975       6               20120630    20121011    0          395
36975       6               20121018    20291231    0          371
36975       6               20121126    20121211    120        313
36975       6               20121126    20121219    120        288
36975       6               20121212    20291231    120        313 
```

# linqpad - 最终用户计算机找不到 System.Data.SQLite

> ID：13978346
> 
> 赞同：0
> 
> 时间：2012-12-20T18:33:12.427
> 
> 标签：linqpad, system.data.sqlite

Linqpad v4.26

这个过程在我的 Dev box 上效果很好。我手动复制到最终用户安装文件夹 linqpad.exe、linqpad.exe.config、custom.dll、system.data.sqlite.dll 和 system.data.sqlite.linq.dll。

我创建一个连接，单击单选按钮使用您自己的程序集的类型化数据上下文。选择实体框架，选择下一步，浏览到我的自定义 dll。选择提供者单选按钮到其他。System.Data.SQLite 不在下拉列表中。

我在我的 Dev box 上运行了 sqlite setup-bundle 安装程序，以便在 GAC 中安装 sqlite 以支持 VS2010 设计器。

谢谢，

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:51:10.443

显示数据库提供程序的下拉列表填充有`System.Data.Common.DbProviderFactories.GetFactoryClasses()`。如果 SQLite 未列出，则它尚未在 machine.config 中注册。但是，LINQPad 不会阻止您手动输入提供程序的名称，就像您在构造实体框架连接字符串时所做的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:36:19.920

+1，因为即使我可以在下拉列表中看到它，它似乎也无效。

我现在做了以下无济于事：

1.  在客户端机器上运行 sqlite-netFx40-Setup-x86-2010-1.0.82.0.exe。
2.  从 readme.htm 部分复制/粘贴到 Linqpad.exe.config 文件中。
3.  将 System.Data.SQLite.dlls 从 Program Files\System.data.sqlite 复制到我安装 Linqpad 的应用程序目录。
4.  启动 linqpad 选择了我的自定义提供程序。它显示了所有表，但是一旦我尝试运行任何查询，我就会得到异常。

# c# - Parallel.Foreach 中出现意外的线程争用

> ID：13978347
> 
> 赞同：0
> 
> 时间：2012-12-20T18:33:13.267
> 
> 标签：c#, multithreading, parallel-processing, task-parallel-library

我尝试使用`Parallel.Foreach`. 我认为进行并行处理很简单，因为它没有同步问题。它基本上是一个蒙特卡洛树搜索，我在其中并行探索每个孩子。蒙特卡洛的东西并不是很重要，你只需要知道我有一个方法可以工作在某个树上，并且我`Parallel.Foreach`在根子节点上调用它。这是进行并行调用的片段。

```
 public void ExpandParallel(int time, Func<TGame, TGame> gameFactory)
    {
        int start = Environment.TickCount;

        // Creating all of root's children
        while (root.AvailablePlays.Count > 0)
            Expand(root, gameInstance);

        // Create the children games
        var games = root.Children.Select(c =>
        {
            var g = gameFactory(gameInstance);
            c.Play.Apply(g.Board);
            return g;

        }).ToArray();

        // Create a task to expand each child
        Parallel.ForEach(root.Children, (tree, state, i) =>
        {
            var game = games[i];

            // Make sure we don't waste time
            while (Environment.TickCount - start < time && !tree.Completed)
                Expand(tree, game);
        });

        // Update (reset) the root data
        root.Wins = root.Children.Sum(c => c.Wins);
        root.Plays = root.Children.Sum(c => c.Plays);
        root.TotalPayoff = root.Children.Sum(c => c.TotalPayoff);
    } 
```

委托是一个克隆工厂，因此`Func<TGame, TGame>`每个孩子都有自己的游戏状态克隆。如果需要，我可以解释该`Expand`方法的内部结构，但我可以保证它只访问当前子树和游戏实例的状态，并且没有`static`任何这些类型的成员。我认为这可能`Environment.TickCount`是导致争用的原因，但我进行了一个实验，只是`EnvironmentTickCount`在一个`Parallel.Foreach`循环内调用，并获得了近 100% 的处理器使用率。

我在 Core i5 上的使用率只有 45% 到 50%。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:56:28.943

这是 GC 抖动的常见症状。在不了解更多关于您在 Expand 方法中所做的事情的情况下，我最好的猜测是这将是您的根本原因。某些共享数据访问也可能是罪魁祸首，要么通过调用远程系统，要么通过锁定对共享资源的访问。

在你做任何事情之前，你需要使用探查器或其他工具来确定确切的原因。不要猜测，因为这只会浪费您的时间，也不要在这里等待答案，因为没有完整的程序是无法回答的。正如您从实验中已经知道的那样，没有任何东西`Parallel.ForEach`会导致这种情况。

# jquery - 如何无限期循环播放此动画？

> ID：13978348
> 
> 赞同：2
> 
> 时间：2012-12-20T18:33:13.033
> 
> 标签：jquery, animation

我对jquery有点陌生，我设法编写了一个淡入淡出两张图片的小动画。

我现在的问题是，在它完成循环之后，它就停止了。当它到达终点时，我需要它从头开始。它应该继续。

这是代码

```
$(document).ready(function() {
    $('img.banner1').fadeOut(5000);
    $('img.banner2').delay(1000).fadeIn(5000);
    $('img.banner2').delay(1000).fadeOut(5000);
    $('img.banner1').fadeIn(5000).delay(1000);
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T18:36:24.327

这段代码将在启动最终淡入后的 1000 毫秒延迟后重新启动函数。不过，您可能需要更长的延迟，因为您需要 5000 毫秒来淡入该横幅......

```
function animateBanners() {
    $('img.banner1').fadeOut(5000);
    $('img.banner2').delay(1000).fadeIn(5000);
    $('img.banner2').delay(1000).fadeOut(5000);
    $('img.banner1').fadeIn(5000).delay(1000).queue(animateBanners);
}

$(document).ready(function() {
    animateBanners();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:38:26.673

您可以将其移至函数并使用 setInterval 调用。

```
function AnimateBanners() {
    $('img.banner1').fadeOut(5000);
    $('img.banner2').delay(1000).fadeIn(5000);
    $('img.banner2').delay(1000).fadeOut(5000);
    $('img.banner1').fadeIn(5000).delay(1000);
}

$(document).ready(function() {
    setInterval(AnimateBanners, 10000); //Will run every 10 seconds
}); 
```

​</p>

# javascript - 为什么 Knockout 为具有相同值的所有行填充一列？

> ID：13978351
> 
> 赞同：0
> 
> 时间：2012-12-20T18:33:29.733
> 
> 标签：javascript, jquery, data-binding, knockout.js

这是一个省略了一些东西的小提琴：http: [//jsfiddle.net/YwTBk/](http://jsfiddle.net/YwTBk/)

基本上，获得下图所需的只是编辑第一行。出于某种原因，Knockout 正在用相同的值填充该列下的所有行。它发生在`amount`, `nrAmount`，当然还有计算`total`列。其他列都没有这个问题。

有趣的是，将绑定从 更改`amount`为`$data.amount`具有使计算列`nrAmount`不再工作的效果，但不会导致所有行都被填充。

![用相同的值填充的列](../Images/a3f4446707afaae43ea396a45d411089.png)

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:44:27.727

我猜这是一个“有效”的更新小提琴 - [http://jsfiddle.net/YwTBk/2/](http://jsfiddle.net/YwTBk/2/)。您对问题的描述与您引用的小提琴不匹配，因此很难确定。

我修复的更大问题如下：

1.  正如 Niko 所提到的，您需要`var self = this;`在视图模型的顶部。
2.  我将 addBlankRecord 移到您的视图模型中，以便`self`addBlankRecord 方法中的引用起作用。
3.  我更新了 populateBlankRecords 方法，以便它引用 ViewModel 上的 addBlankRecord
4.  对于您的绑定，我将类别和 removeRecord 的绑定更新为 $parent.categories 和 $parent.removeRecord，因为在 Record 视图模型中都找不到这些绑定。

我猜还有几个较小的问题是由于从您的代码中删除了一些东西。其中一些被其他评论引用。

*   removeRecord、GetDepartments 和 GetCategories 方法不存在
*   没有表格 HTML 标记
*   没有引用 jQuery 或 KnockoutJS

这能解决您的问题吗？如果没有，如果您能提供一个演示问题的小提琴，那将非常有帮助。

# c# - 在 C# 中检测来自 localhost 的请求

> ID：13978353
> 
> 赞同：0
> 
> 时间：2012-12-20T18:33:57.393
> 
> 标签：c#, asp.net-mvc

我有一个挑战，我相信有一个比我更聪明的开发人员可以提供一些见解。

我有一个网络服务。此 Web 服务是用 C# 中的 ASP.NET MVC 编写的。我想让开发人员调用这个网络服务。当开发人员编写代码时，我认识到 Web 应用程序通常从 localhost 运行。当他们调用此服务时，我希望能够确定请求是否来自本地主机。但是，如果我查看 IP 地址，它是他们机器的 IP 地址。

我有办法做到这一点吗？显然 Request.IsLocal 将不起作用，因为我的 Web 服务在完全不同的机器上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:32:41.210

调用 Web 服务时，浏览器通常会在 Referer 标头中传递页面。因此，您可以检查该值是否以“http://localhost”开头。几乎可以伪造 http 请求中的任何内容（包括这个），所以要小心根据这些数据做出什么样的决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:36:59.270

如果不传递一些额外的数据以及来自应用程序的请求，您将无法知道任何方式。

您将只能获取用于向您的 Web 服务发出请求的 IP 地址或主机名，听起来您希望能够找到用于向您发出请求的主机名 (localhost)应用程序（然后触发对 Web 服务的调用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:37:12.693

然后，您将如何定义本地（从您的服务的角度）？您最好在不同的 API 端点上设置开发服务，而不是试图猜测这一点。

所有生产级 API 调用都可以`api.yourservice.com`通过`dev.yourservice.com`.

然后，您可以拥有两个单独的服务，或者让您的服务读取所请求的 URL 并据此进行区分。

# java-7 - Java-7 中的签名多态方法

> ID：13978355
> 
> 赞同：12
> 
> 时间：2012-12-20T18:34:04.560
> 
> 标签：java-7, java-8, methodhandle

据我所知，随着 Java 7 中 MethodHandle 的引入，编译器生成的方法重载也随之引入。

[MethodHandle](http://download.java.net/jdk7/archive/b123/docs/api/java/dyn/MethodHandle.html)的javadoc状态（我已经修剪了示例）：

> 以下是一些使用示例：
> 
> ```
> Object x, y; String s; int i;
> mh = ...
> // (Ljava/lang/String;CC)Ljava/lang/String;
> // (String, char, char) -> String
> s = (String) mh.invokeExact("daddy",'d','n');
> 
> // (Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
> // (Object, Object, Object) -> Object
> x = mh.invokeExact((Object)1, (Object)2, (Object)3);
> 
> // (Ljava/util/List;)I
> // (List) -> int
> i = (int) mh.invokeExact(java.util.Arrays.asList(1,2,3));
> 
> // (Ljava/io/PrintStream;Ljava/lang/String;)V
> // (PrintStream, String) -> void
> mh.invokeExact(System.out, "Hello, world."); 
> ```
> 
> 上面的每个调用都会生成一个单独的 invokevirtual 指令，其名称为 invoke 和注释中指示的类型描述符。参数类型直接取自实际参数，而返回类型取自立即应用于调用的强制转换。这个演员表可能是一个原始人。如果缺少它，如果调用发生在使用返回值的上下文中，则类型默认为 Object。如果调用作为语句发生，则不可能进行强制转换，并且没有返回类型；通话无效。

实际上，invokeExact 和朋友的行为就好像参数和返回类型的每个可能组合都有一个重载。

我听说 MethodHandles 正在为 Java 8 中的功能做准备，比如 lambdas。（我知道它们对于脚本语言已经很有用了。）

[/介绍]

那么，Java 中是否还有更多这些编译器生成的重载？是否有暗示将来会有更多的它们（例如，使用扩展方法）？为什么首先需要它？仅仅是速度？它如何帮助 lambdas（~~我认为 lambdas 会编译为匿名内部类~~）？

简而言之，理由是什么？为什么它们（生成的重载）现在和将来有用？

**更新**：我在这里称之为*编译器生成的*重载，Oracle 人称之为*签名多态*。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-22T06:17:43.947

我刚刚在[MethodHandles 和 invokedynamic上看到了一个 Hotspot 内部 wiki](https://wikis.oracle.com/display/HotSpotInternals/Method+handles+and+invokedynamic)

它提出了一些有趣的观点来回答这些问题（以及更多）。

*   问题中所谓*的编译器生成的重载*，java 家伙称***签名多态。***
*   `MethodHandle.invokeExact`和朋友**是独一无二的，**是唯一的签名多态方法。
*   在 HotSpot VM 上，`invokevirtual`MethodHandle.invoke* 的字节码被秘密转换为**`invokehandle`**指令。
    *   `invokehandle`就像`invokedynamic`; 一些内部结构不同，每条`invokedynamic`指令必须指向它自己的常量池缓存条目（CPCE），`invokehandle`s 可以共享 CPCE。
*   `invokedynamic`**`MethodHandle.invokeBasic`**在 HotSpot VM 上 使用非公共
    *   `MethodHandle.invokeBasic`类似于 invokeExact 但更松散；一方面，它不会检查调用站点的类型与被调用者的类型。
*   热方法句柄（包括`invokedynamic`）可以进行**JIT 编译**

此外，**lambda 表达式**将[通过`invokedynamic`](http://cr.openjdk.java.net/~briangoetz/lambda/lambda-translation.html). （从 Edwin Dalorzo 的回答中得到。）这意味着 lambda 表达式

*   将间接`MethodHandle.invokeBasic`在 HotSpot VM 上使用（见上文），并且
*   有资格进行 JIT 编译

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T12:26:22.090

这两个链接可能无法回答您的所有问题，但它们可能是一个很好的起点：

*   [Lambda 表达式的翻译](http://cr.openjdk.java.net/~briangoetz/lambda/lambda-translation.html)
*   [从 Lambda 到字节码](http://medianetwork.oracle.com/video/player/1113272510001)

这是来自目前在 JDK 8：Project Lambda 中工作的专家组的参考资料。幸运的是，您可以在那里找到一些解释，尤其是关于您对 lambda 表达式作为内部类的误解。

# c# - Winform 和 WPF 窗口边框

> ID：13978368
> 
> 赞同：-4
> 
> 时间：2012-12-20T18:35:03.420
> 
> 标签：c#, wpf, winforms, border

> **可能重复：**
> [更改 WinForm 边框的样式？](https://stackoverflow.com/questions/2613418/change-the-style-of-winform-border)
> [表格边框大小和颜色](https://stackoverflow.com/questions/13976546/form-border-size-and-color)

好的，我正在重写这个问题[https://stackoverflow.com/questions/13976546/form-b](https://stackoverflow.com/questions/13976546/form-border-size-and-color) ​​order-size-and-color ，不知道他们为什么关闭它。我想知道如何更改表单（WINFORM）和 WPF 窗口的边框大小和颜色。我现在使用 Fixed Tool Window 作为边框类型。我还隐藏了按钮（最小化 - 最大化 - 关闭）。但是边框仍然很厚，我不想有windows主题，而是黑色边框。有人知道如何实施吗？我不需要调整大小。

一些考虑：

*   该解决方案需要在 Winform 和 WPF 中都有用。
*   窗口或表单需要是可移动的。
*   我想为我的应用更改 Window OS 边框的颜色和大小。但我知道它使用 Windows API，这可能很难。

如果您不理解，请不要投反对票，请询问。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:37:15.430

`.FormBorderStyle = None`应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:29:11.570

WinForms 和 WPF 都没有好的解决方案。所以你的问题并不能真正回答。

您获得所需内容的唯一方法是自己绘制边框并自己处理调整大小/移动。

但是，所有这些操作在 WPF 和 WinForms 之间都是不同的。它们可以在两者中完成。但两者都不一样。所以你的问题没有一个答案。

此外，如果你真的展示了你尝试过的东西，你可能会与人们走得更远（而不是那么多的反对票）。您是否以特定方式遇到了障碍？还是您要求我们为您集思广益？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:40:01.570

可能你想要这样的东西吗？您需要删除所有“Windows 样式”，然后使用例如`Border`元素作为窗口的容器对其进行自定义。希望这可以帮助。

```
<Window x:Class="YourNamespace.YourWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Width="800"
        Height="600"       
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        Background="Transparent"
        ShowInTaskbar="True"
        AllowsTransparency="True">
    <Border CornerRadius="5"
            BorderBrush="#FFAAAAAA"
            BorderThickness="1">
        <Border.Background>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="#DD000000" Offset="1"/>
                <GradientStop Color="#DD333333" Offset="0.50"/>
                <GradientStop Color="#DD393939" Offset="0.49"/>
                <GradientStop Color="#DD666666"/>
            </LinearGradientBrush>
        </Border.Background>
        <Grid>
            <TextBlock Foreground="White" FontWeight="Bold" Text="Hello World!" FontSize="16"/>
        </Grid>
    </Border>
</Window> 
```

# java - 单击按钮后管理mysql连接

> ID：13978370
> 
> 赞同：0
> 
> 时间：2012-12-20T18:35:04.847
> 
> 标签：java, android, mysql, multithreading, android-asynctask

我的目标是插入某个 db 2 值、id 和 pass。我有一个注册页面，要求提供该数据和一个按钮来完成操作。那么在按钮监听器上我应该做什么？许多人告诉我使用 AsyncTask（我不知道如何使用）而不是 Thread。请记住，此类需要获取 2 个参数 id 并传递 .. 据我所知，线程在使用调用 run 方法的 start() 方法后启动，而 run 方法没有参数.. 那么我该如何传递这些2个参数？无论如何，我很困惑。另一件事是，如果我在 catch 块上遇到任何类型的错误，我会将错误放在某个字符串上，例如： String error = exceptionInstance.toString(); 然后我可以从注册页面中查看该字符串并打印错误。

myThreadInstance.start(); textViewInstance.setText(myThreadInstance.getError());

这是一场马拉松……我很困惑！！！！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:57:02.500

根据我的说法，使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)而不是 an，`Thread`因为它易于使用，并且您可以更好地控制后台线程，而无需执行额外的代码来创建单独的逻辑以在线程执行完成时更新 Ui，计算进度单位以便用户执行操作需要多少时间完成等

您的**第一个**问题是如何发送`username`和单击按钮。为此，请使用`password`构造函数：`AsyncTask``AsyncTask`

```
LoginOperation loginopertion=new LoginOperation(strusername, strpassword);
loginopertion.execute(""); 
```

您的**第二个**答案是我们如何在任务完成时接收和更新 Ui `username`，以便在执行完成时更新 Ui，例如：`password``AsyncTask``onPostExecute``AsyncTask``doInBackground`

```
public class LoginOperation extends AsyncTask<String, Void, String> {
    String strusername,strpassword;

    public LoginOperation(String strusername, String strpassword){
        this.strusername=strusername;
        this.strpassword=strpassword;
    }
    @Override
    protected void onPreExecute() {
        //show progressbar here 
    }
    @Override
    protected String doInBackground(String... params) {
        string result="";
        try
        {
            result=="success or fail";
            //do your network opertion here
        }
        catch(SQLException e)
        {
            result="ERROR";
        }
        return result;
    }      

    @Override
    protected void onPostExecute(String resultmsg) {    
        // show error here and update UI
        //or other opertion if login success
        textViewInstance.setText(resultmsg);
    }

} 
```

有关 AsyncTask 方法的更多信息，请参见

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# arrays - 在动态文本字段中显示数组中的所有项目 [Actionscript 3]

> ID：13978372
> 
> 赞同：1
> 
> 时间：2012-12-20T18:35:12.257
> 
> 标签：arrays, actionscript-3, dynamic, textfield

我有一组项目，我想在动态文本字段中显示这些项目以形成高分列表。数组列表中的项目数量取决于添加了多少高分。它是这样创建的：

```
var lvl1ScoreArray:Array = new Array(); 
```

并在以下代码中添加项目：

```
if (currentLevel == 1)
{
    lvl1highScores.push({score:int(vinylCollected) , player:String(highScoreInput.text)});
    lvl1highScores.sortOn("score", Array.DESCENDING | Array.NUMERIC);
} 
```

我显然可以跟踪数组中的所有项目，如下所示：

```
for (var i:int = 0; i < lvl1highScores.length; i++)
{
    trace(lvl1highScores[i].score, lvl1highScores[i].player);
} 
```

但我想在一个名为 highScoreTxt 的动态文本字段中执行此操作。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:45:48.893

这很简单，只需创建一个包含文本字段的影片剪辑，其中的实例名称为`txt`. 命名影片剪辑`HighScoreTF`并将其链接设置为`HighScoreTF`然后你的 for 循环看起来像这样

```
for (var i:int = 0; i < lvl1highScores.length; i++)
{
    var tf:HighScoreTF = new HighScoreTF();
    tf.txt.text = lvl1highScores[i].score + " - " + lvl1highScores[i].player;
    tf.y = i * tf.height; //-- you can replace tf.height with a number to adjust spacing
    addChild(tf);
} 
```

# jquery - 选择后每个选择元素上的 .blur()

> ID：13978374
> 
> 赞同：0
> 
> 时间：2012-12-20T18:35:21.587
> 
> 标签：jquery

我想知道是否有办法使用 jquery 在触发选择后取消聚焦每个选择元素？

谢谢。

*注意：我知道如何一次处理一个元素，这个问题是针对选择元素的全局行为*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:37:44.753

我会这样，但没有太多信息，我不确定它对你是否正确。

```
$('select').on ('change', function () {
    $(this).trigger('blur');
}); 
```

请注意，如果“选择”事件是指个性化事件，只需按您的事件更改“**更改**”即可。

正如@grinn 所指出的，您可以使用委托设置事件以供将来创建的选择：

```
$(document.body).on ('change', 'select', function () {
    $(this).trigger('blur');
}); 
```

# php - 架构/部署决策

> ID：13978379
> 
> 赞同：2
> 
> 时间：2012-12-20T18:35:34.240
> 
> 标签：php, database, cakephp, database-design, payment

我一直在用 cakePHP 开发员工调度系统。现在，随着应用程序接近部署阶段，我被告知我的客户不仅想为他的公司使用它，而且还想为其他公司出售应用程序服务（作为会员）。该应用程序非常简单，现在的数据库非常简单。目前只有 3 个表：员工、客户、时间表（每个元组包含 empployeeId、customerId 和在客户处花费的时间）。employees 和 customers 表通常每个会保存约 50 条记录，并且时间表可能会达到 15k。我从来没有遇到过这样的事情，所以我对此有些怀疑。现在每个公司都应该有自己的数据库吗？如何接收付款和盛大/拒绝访问？

任何关于该案例和最佳实践的评论、建议都非常受欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:39:45.643

如果您的架构不允许您按公司选择记录，那么每个记录都必须有自己的。

如果您不能以安全的方式访问各个公司的记录，那么每个公司都必须拥有自己的记录。

我认为你很疯狂地卖掉设计和制造的东西，而不是考虑向外界销售和支持。

潜在客户会疯狂购买它。

# svn - 选择适合我们部署需求的分支策略

> ID：13978383
> 
> 赞同：2
> 
> 时间：2012-12-20T18:35:46.390
> 
> 标签：svn, deployment, teamcity, branching-strategy

## 背景

因此，我在上个月的大部分时间里都在使用 MSDeploy、SSDT 和 TeamCity 自动化我们的 web + db 部署。唯一的问题是，出于演示目的，我只在我们的主干分支工作。不用说，当您考虑需要进行并行开发工作（由 SVN 中的分支隔离）时，这种方法很快就会失败。这就是我卡住的地方，希望能找到一些帮助。

## 我们的情况

*   我们**永远**不必支持我们软件的多个并发版本
*   客户**始终**使用当前版本

## 我想出什么（到目前为止）

如我所见，我们实际上只需要源代码控制中的两个分支：

1.  **当前：** trunk - 部署发生的地方
2.  **Next：**当前迭代的开发分支

在新迭代开始时，**Current**将被分支（让我们将该分支称为**Next**）。该迭代的所有开发都将提交给**Next**，同时，当前版本所需的任何错误修复都将提交给**Current**。在某个时刻，**Next**将*“完成”*，因此，合并回**Current**。

### 部署

就部署而言，**Next**永远不会部署到任何环境中。**但是， Current**将由 TeamCity 定期（每次提交、每晚等）自动打包/部署到内部环境。在某些时候，其中一个包会被认为“足够好”，因此会被推到部署流中（通过登台、生产）。

### 注意事项

鉴于上述过程，将**Next**合并到**Current将保证****Current**上的“代码冻结” ，在此期间不能向客户发布新的错误修复。这种错误冻结将持续到**Current**被认为“足够好”以发布给客户端，此时**Current**将被标记并且整个过程将重新开始。

## 问题

1.  这种方法/思路合理吗？
2.  这种方法在哪里失败？
3.  有没有更好的方法来解决这个问题？

非常感谢任何见解/文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:40:17.763

由于该软件只有一个版本，因此在发布给客户时更容易标记主干，并继续在主干上进行开发。

您不需要分支，除非您在开发时必须对软件进行修复。

您必须决定是否为开发分支比为生产错误修复分支更适合您和您的开发组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:49:18.877

我认为在这些情况下的主要指令是您必须始终能够快速修复生产错误，而无需部署非生产代码。我觉得“在代码冻结期间不修复错误”警告会扼杀您灵活应对问题（不可避免地）出现的能力。

我们的流程与您的流程非常接近。我们通过这样的策略取得了很好的成功：

**树干**就是树干。
**Prod**从树干上分支出来。产品修订被标记，我们从这些标记进行部署。错误已修复并从此分支部署；这些修复合并回主干。
**接下来**是一个或多个功能开发分支，它们在完成后重新集成到主干中。

当我们准备好发货时，我们会制作一个新的**Prod**并重新开始循环。

我们喜欢这个模型，因为：

*   我们可以随时部署生产错误修复，而不必担心包含未烘焙的代码；
*   将这些生产错误修复恢复到主线很容易；
*   我们的主干本质上是一个合并日志，并且保持相当干净。在任何时候，主干都可以合理地分支到 Prod；
*   我们在重新集成后删除了特征分支，这是一种宣泄和满足。

我们的管理层喜欢这个模型，因为我们可以快速响应问题并且回归的可能性很小。

# python - 如何让 Python 向后打印输入的消息？

> ID：13978387
> 
> 赞同：-2
> 
> 时间：2012-12-20T18:36:27.513
> 
> 标签：python, reverse, slice

> **可能重复：**
> [在 Python 中反转字符串](https://stackoverflow.com/questions/931092/reverse-a-string-in-python)

尽管我最初认为这很简单，但它一直困扰着我。

最初，我认为我会通过使用切片让它从最后一个字母到第一个字母来向后打印字符串的元素。

但是我尝试过的没有任何效果。代码只有几行，所以我不认为我会发布它。这样做非常令人沮丧。

我只能使用“for”、“while”、“If”函数。我可以使用元组。以及索引和切片。但就是这样。有人可以帮忙吗？

（我试图让字符串中的每个字母都变成一个元组，但它给了我一个错误。我这样做是为了向后打印元组，这给了我与第一个相同的问题）

我**不知道这个词的最后一个字母可能是什么，所以我无法给出一个端点让它倒数。我似乎也不能指定第一个字母在最后，所有其他字母都在它之前。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T18:38:35.707

你可以做：

```
>>> 'Hello'[::-1]
'olleH' 
```

[样本](http://ideone.com/19T5EI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:56:53.323

正如上面的**Mike Christensen**所写，您可以轻松做到`'Hello'[::-1]`.

但是，这是特定于 Python 的事情。如果您使用其他语言（包括不允许进行负面列表切片的语言）工作，一般情况下您可以做的事情更像是：

```
def getbackwards(input_string):
   output = ''
   for x in range(0,len(input_string),-1):
       output += input_string[x]
   return output 
```

你当然不会在 Python 中真正做到这一点，只是想给你一个例子。

# windows-8 - Windows 8 和 Windows Phone 8 应用程序开发

> ID：13978389
> 
> 赞同：0
> 
> 时间：2012-12-20T18:36:37.383
> 
> 标签：windows-8

我是否必须获得开发人员许可证才能在 Windows 8 上开发基本示例应用程序？我厌倦了用 Visual Studio 2012 打开一个 Windows 商店项目，它说获得开发人员许可证。我看不到设计模式。我看不到我的应用程序的样子？我无法运行它。如何在没有开发人员许可证的情况下在 Visual Studio 上运行调试？我只想开发一个基本的应用程序并在我的 Windows 8 系统上运行它？这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:42:08.360

对于开发人员许可证，您只需要一个实时 ID，因此基本上需要 30 秒的时间才能获得一个。之后，您可以在计算机上自由构建和运行项目。

# haskell - 在 Haskell 中覆盖 fromInteger

> ID：13978395
> 
> 赞同：8
> 
> 时间：2012-12-20T18:37:27.400
> 
> 标签：haskell, numeric, typeclass

所以我喜欢 Haskell，但对 Num 类不满意。所以我想为代数类型创建自己的类型类层次结构。
问题是，即使我导入 Prelude 隐藏 Num 以及与之相关的所有内容，仍然使文字 1 具有类型 t 的唯一方法是使 t 实例化 Num。
我很想制作自己的 fromInteger 类，并将 Num 完全排除在图片之外，就像这样

```
import Prelude hiding (everything having to do with Num)
import qualified Prelude (everything having to do with Num)

class (Eq fi) => FromInteger fi where
  fromInteger :: Integral -> fi

foo :: (FromInteger fi) => fi -> String
foo 1 = "that was a one"
foo 0 = "that was a zero"
foo n = "that was neither zero nor one" 
```

然后我会为全新的类型适当地实现 fromInteger，而不必对 Num 说任何话。

有没有办法告诉解析器使用不同的 fromInteger 方法？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-20T18:59:18.860

您正在寻找 GHC 的[RebindableSyntax 扩展](http://www.haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#rebindable-syntax)。

通过放置启用它

```
{-# LANGUAGE RebindableSyntax #-} 
```

在源文件的顶部。

# gcc - 我想知道 rand() 在 linux 的 gcc 编译器中生成随机数的确切方法。

> ID：13978396
> 
> 赞同：-1
> 
> 时间：2012-12-20T18:37:37.483
> 
> 标签：gcc, random

我想知道在 linux 的 gcc 编译器中用于生成随机数的确切方法。

我知道线性同余生成器用于在 gcc 中生成随机数，它具有一般公式：

X(n+1) = (a* X(n) +c) mod m

我开始知道使用的通用公式具有维基百科中给出的这些常数值： [http ://en.wikipedia.org/wiki/Linear_congruential_generator](http://en.wikipedia.org/wiki/Linear_congruential_generator)

其中 m=2^3, a =1103515245 和 12345

但是将这些常量放入的结果与 gcc 中的 rand() 函数得到的结果不匹配。

有人可以帮助我哪里错了，或者有什么我不知道的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-06T13:52:55.917

看起来像是对 DES::SetKey(unsigned long long int); 的调用 在 stdlib.h 中不知道这是否与随机生成器函数有关，但您永远不知道，因为 DES 加密/解密算法有一个更快的版本，它曾经在旧版本中使用过GNUPG 实际上使用 DES 作为选择的加密/解密系统，所以这就是他们可能用来生成随机数的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:44:55.200

数字是否与此相符：http: [//www.mathstat.dal.ca/~selinger/random/](http://www.mathstat.dal.ca/~selinger/random/)

否则，源代码在 这里：http: [//sourceware.org/git/](http://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/rand.c;h=92916e833f7fc94ac16a2bd047c33f8a6ef6ec49;hb=HEAD) ?p=glibc.git;a=blob;f=stdlib/rand.c;h=92916e833f7fc94ac16a2bd047c33f8a6ef6ec49;hb=HEAD 导致这里： [http ://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/random.c;h=ff6bdd2b5d5a8f7633a914282f4c6ab1991df0cf;hb=HEAD](http://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/random.c;h=ff6bdd2b5d5a8f7633a914282f4c6ab1991df0cf;hb=HEAD)

# sorting - 在Haskell中对谓词的二维列表进行排序

> ID：13978399
> 
> 赞同：1
> 
> 时间：2012-12-20T18:37:45.740
> 
> 标签：sorting, haskell

我有一个元组列表 ( `[[(Int, Custom)]]`) 列表，我想通过将整数相互比较来对外部列表进行排序。它应该像普通的二维排序一样，即它应该按第一个列表项对第一个项进行排序，然后按第二个项进行排序，依此类推——但比较的是第一个部分而不是整个元组。

对于我会使用的一维列表`sortBy (comparing fst)`，但我完全迷失了将它们包裹在另一个列表中。我知道如果我将我`Custom`的一个实例 [`Ord`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html)作为排序自动工作，它会自动工作，但它并不是真正可订购的。

如果您想要一个示例和预期结果，请发表评论。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:53:18.637

呃，在问完这个问题后，它像中风一样击中了我：

[`comparing`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#v%3acomparing)需要一个返回可排序结果的函数，而不是 Ordering 或排序的部分列表`[(Int, Custom)]`（不可排序）：

```
comparing :: Ord a => (b -> a) -> b -> b -> Ordering
comparing = on compare 
```

所以我必须返回的是可排序整数的列表，即`map fst`. 共：

```
sortBy (compare `on` map fst)
  :: Ord a => [[(a, b)]] -> [[(a, b)]] 
```

# java - 使用目录名称对测试进行分组，而不是为 Maven SureFire 进行注释

> ID：13978402
> 
> 赞同：2
> 
> 时间：2012-12-20T18:38:04.177
> 
> 标签：java, maven, maven-plugin

我有 TestNG 测试，这些测试与 (groups = "unit") 注释分组为单元或集成，并使用以下 Maven 配置运行：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.7.2</version>
            <configuration>
                <groups>${test.group}</groups>
                <includes>
                    <include>**/*Test.java</include>
                    <include>**/Test*.java</include>
                    <include>**/When*.java</include>
                </includes>
                <argLine>${test.args.unit} -Xmx1024m</argLine>
            </configuration>
        </plugin> 
```

我想通过目录结构而不是注释来分隔测试组，并将单元测试放在一个名为 unit 的目录下。

因此，例如一个单元测试：src/test/java/foo/FooTests/MyFoo.java 我想将它移动到：src/test/java/foo/unit/FooTests/MyFoo.java。然后更改 Maven 配置以获取单元子目录下的 Java 文件以进行单元测试。

我尝试通过更改插件配置来使用以下包括：

```
 <groups>${test.group}</groups>
            <includes>
                <include>**/unit/**/*Test.java</include>
                <include>**/unit/**/Test*.java</include>
                <include>**/unit/**/When*.java</include>
            </includes> 
```

但这似乎不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:23:26.243

如果您将单元测试命名为“*Test”，将集成测试命名为“*IT”，那么插件将选择正确的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:56:20.847

第一件事是您应该使用更新的[maven-surefire-plugin](http://maven.apache.org/surefire/maven-surefire-plugin/) (2.12.4) 并且不要使用包含，因为 maven-surefire-plugin 具有单元测试的默认值。如果您有集成测试，最好使用[maven-failsafe-plugin](http://maven.apache.org/plugins/maven-failsafe-plugin/)并适当地命名它们。如果您结合使用 TestNG，它听起来更像是集成测试。

# c# - WCF 服务 API 的散列

> ID：13978409
> 
> 赞同：4
> 
> 时间：2012-12-20T18:38:39.983
> 
> 标签：c#, wcf, hash, wcf-security

我们正准备通过 API 公开大量 WCF 服务，我们希望所有服务都具有共同的身份验证/授权。

我们正在考虑对每个请求都要求一个散列值（可能是用户名和密码），但我不确定这是否是最佳实践方式，甚至是正确的方式。此外，如果不是，那是什么？如果是，那么独立于语言的算法将能够支持哪种散列算法。我们的目标是不局限于任何特定的语言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:27:07.003

我的一家初创公司也遇到了同样的问题，我们进一步希望避免使用 SSL，因此我们决定加密所有流量并向我们的客户提供私钥。也就是说，我们发现跨平台加密是困难的。事实上，我们最终发现唯一合适的选择是一家名为 Chilkat (http://www.chilkatsoft.com/) 的公司。

在 Windows 和非 Windows 环境之间切换时，我们经历的其他选项都存在问题。Chilkat 工作得更好，但要小心你使用的加密算法，并注意如果你想要 UTF-8 over ASCII，你需要更改它们的一些设置。

最终，我们还通过提供要求提供公司名称、电子邮件地址和联系人姓名的服务来自动化私钥部分，然后我们使用这些服务自动生成用户级私钥并将其通过电子邮件发送给客户。然后，他们使用我们提供的 .NET 或 Java 库最终对其进行加密。

# tsql - 比较两个表中的行数

> ID：13978410
> 
> 赞同：0
> 
> 时间：2012-12-20T18:38:41.640
> 
> 标签：tsql, join

我有两个表，它们共享一个列，这不是唯一的。我想要表 A 的共享列的值比表 B 多的所有记录。

```
TABLE A:
Shared_Column|User_ID|Department
123          |    joe|     sales
123          |    joe|     sales
123          |    joe|     sales
124          |    sam|       ops
124          |    sam|       ops

TABLE B
Shared_Column|Other_Column
123          |           1
123          |           1
124          |           4
124          |           4 
```

从这些数据中，我想要`joe|sales`但不是`sam|ops`。我也可以将此作为输出：

```
USER|TABLE_A_COUNT|TABLE_B_COUNT
 joe|            3|            2
 sam|            2|            2 
```

编辑：我尝试过这样的加入：

```
select a.user_ID, count(a.shared_column) as 'TABLE_A_COUNT', count(b.shared_column) as 'TABLE_B_COUNT'
from a inner join b on a.shared_column = b.shared_column
group by a.user_ID 
```

但这似乎会产生交叉连接，我得到`joe|6|6`的是 3 和 2

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:54:42.113

看起来你想要这样的东西：

```
select a.user_id,
  count(a.shared_column) TableA,
  TableB
from tablea a
inner join
(
  select count(*) TableB, Shared_column
  from tableb
  group by shared_column
) b
  on a.Shared_Column = b.Shared_Column
group by a.user_id, TableB 
```

请参阅[带有演示的 Sql Fiddle](http://sqlfiddle.com/#!3/7ffd8/1)

结果：

```
| USER_ID | TABLEA | TABLEB |
-----------------------------
|     joe |      3 |      2 |
|     sam |      2 |      2 | 
```

# git - Git 中的合并冲突与 Subversion 中的合并冲突有何不同？

> ID：13978417
> 
> 赞同：3
> 
> 时间：2012-12-20T18:39:02.690
> 
> 标签：git, svn, merge, conflict

当我在 Subversion 工作时，我总是`svn update`在`svn commit`. 如果有任何冲突，我会在更新时收到警告。然后，在我的工作目录中，我得到`filename.java`、`filename.java.mine`、`filename.java.r10`和`filename.java.r13`. 基于这些文件，我弄清楚如何解决冲突，将其标记为已解决，然后提交。

我对 Git 比较陌生，所以我试图弄清楚上述工作流程对 git 的影响。哪些 git 命令可能会导致合并冲突？我的工作目录中是否有上述文件的等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:01:32.587

有许多`git`子命令可能导致合并冲突，包括`merge`（并且`pull`因为它本质上`fetch`跟在 后面`merge`）、`cherry-pick`等`rebase`。`git`但是，以完全不同的方式处理合并冲突。它不是为不同的版本创建单独的文件，而是创建一个文件，其中的部分用分隔符标记，以指示它们来自三向合并方程的哪一部分。因此，您编辑一个冲突的文件并删除您不想要的部分和分隔符，或者如果任何一方都不完全正确，则将其替换为适当的手动合并混合，然后`git add`和`git commit`. 分隔符是 7 `<`、`=`和`>`( 有时`|`，如果您`diff3`配置了格式）字符看起来像这样：

```
<<<<<<<
stuff from your version of the file
|||||||
stuff from the common ancestor of the two
=======
stuff from the version you're merging in
>>>>>>> 
```

如果您不使用`diff3`-styled 冲突标记，`|`则缺少分隔符和共同祖先行。

您可以键入`git help merge`以阅读有关它的更多信息。

# javascript - 创建服务器以存储 javascript 游戏的高分列表的最简单方法？

> ID：13978419
> 
> 赞同：8
> 
> 时间：2012-12-20T18:39:11.253
> 
> 标签：javascript, database, arrays, webserver

好的，所以我正在做一个学校项目，我必须用 JavaScript 实现 Space Invaders。基本上已经完成了，但是老师希望有一个分数表。我只想要一个服务器，我可以在其中使用 jQuery 发布玩家的分数，并在游戏结束后从服务器获取现有分数。基本上我想像这样实现它（可能不是最明智的解决方案）：

1.  玩家玩游戏
2.  游戏结束 -> 从服务器获取所有分数作为数组
3.  将当前分数添加到数组
4.  对数组进行降序排序
5.  拼接数组，这样只有 5 个最好的分数
6.  向玩家显示得分列表
7.  将当前分数发布到服务器
8.  重复

那么有什么建议如何创建这种简单的服务器（发布分数和获取分数）？我对这些东西不是很熟悉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:45:48.743

似乎[这个 Parse 教程](https://parse.com/docs/js_guide)是为你创建的！（这个例子甚至是一个高分的例子。）

Parse 是一个持久性库，可让您在不编写任何服务器代码的情况下正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:54:58.743

如果您已经了解客户端 JS 开发，您可以查看[NodeJS](http://nodejs.org)（服务器端 JavaScript 环境）并将结果存储在 CSV 或文本文件中。

另一种选择是使用[Google 电子表格 API](https://developers.google.com/gdata/samples/spreadsheet_sample) for Javascript 来存储/获取游戏结果。

# c# - WCF 服务 Web 服务并发.Single

> ID：13978421
> 
> 赞同：2
> 
> 时间：2012-12-20T18:39:18.913
> 
> 标签：c#, wcf, service, web

我有一个 WCF 服务，我想一次处理来自所有客户端的一个请求。我希望客户端 A 的请求得到处理，客户端 B 等到客户端 A 完成，然后服务甚至尝试查看它。我认为下面的代码完成了这一点。

```
[ServiceContract]
public interface IRestServiceImpl
{...}

[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Single)]
public class RestServiceImpl : IRestServiceImpl
{...} 
```

如何允许一次只处理一个客户端并强制其他客户端排队等待？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:01:10.873

您需要控制服务实例的数量以及并发模式。默认情况下，您的服务将配置为`InstanceContextMode.PerSession`. 这意味着客户端 A 的所有请求都将按顺序处理，客户端 B 的请求也将按顺序处理，但它们不会按顺序处理，因为它们没有使用相同的服务实例。

尝试修改您`ServiceBehavior`的如下：

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Single, 
                 InstanceContextMode=InstanceContextMode.Single)]
public class RestServiceImpl : IRestServiceImpl
{...} 
```

有关该主题的更多信息，请查看[有关会话、实例化和并发的 MSDN 文档。](http://msdn.microsoft.com/en-us/library/ms731193.aspx)

# ios - 如何在imageview上将喜欢的数量显示为数字

> ID：13978426
> 
> 赞同：0
> 
> 时间：2012-12-20T18:39:30.723
> 
> 标签：ios, uiimageview, uikit, uilabel

我正在开发一个社交网络应用程序，用户有时可以喜欢另一个用户写下的评论。现在我有一个图像视图，其中包含一个代表用户写的东西的图像，我希望能够在该图像的右上角显示一个小数字，其中包含他获得了多少个赞，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:41:40.523

为什么不简单地把`UILabel`喜欢的数量放在上面`UIImageView`呢？

# php - jquery.post 不创建会话

> ID：13978427
> 
> 赞同：2
> 
> 时间：2012-12-20T18:39:39.290
> 
> 标签：php, ajax, session, jquery

我有一个奇怪的问题。我正在使用 jquery`$.post()`从`PHP`脚本发送/接收变量。

**JavaScript：**

```
$("#r_submit").click(function()
{
    $.post("http://" + server + "/msws/", 
    {
        action: "register",
        sub_action: "register_validate"
    },
    function(json) 
    {
        json = $.parseJSON(json);
        alert(json.cell_is_good);
    });
}); 
```

**PHP**：

[http://textuploader.com/?p=6&id=S7zDD](http://textuploader.com/?p=6&id=S7zDD)

**问题：**

如果我在我的电脑**（WAMP）**上运行代码，它可以正常工作，但是如果我将它上传到我的服务器**（justhost）**，那么如果我在创建会话时提醒会话，它就不会保留会话，它就在那里，但是当我稍后尝试获取会话，它已经消失了，我认为这与服务器认为浏览器已关闭，因此它破坏了会话有关？谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:00:22.330

您在没有会话 ID 的情况下开始会话。为此，您的 PHP 必须配置为使用默认禁用的[透明会话 id 。](http://php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)因此，您必须在具有 AJAX 调用的脚本中启动会话，并`session_id()`在 POST 请求中提交，然后在 PHP 中启动会话，如下所示：

```
if (!isset($_POST['SID'])) {
    die('{}');
}
session_start($_POST['SID']); 
```

另外，我会省略您正在调用的 url 的主机部分，`$.post`以避免跨域 ajax 调用问题（这很可能不会解决您的问题）。它只能在同一台服务器上工作，因此您可以像这样编写 ajax 调用：

```
$.post("/msws/", //... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:49:29.630

检查您是否有多个会话 cookie。

我和codeigniter有同样的情况，我发现每个新页面都会创建自己的会话

# css - 为什么我的嵌套列表导航中的所有列表项都直接重叠显示？

> ID：13978428
> 
> 赞同：0
> 
> 时间：2012-12-20T18:39:43.430
> 
> 标签：css, positioning

嵌套列表导航没有像我预期的那样显示第二个列表（垂直向下列出的块）。相反，所有项目都直接放在彼此的顶部。

[http://jsfiddle.net/HL69H/3/](http://jsfiddle.net/HL69H/3/)

```
<div id="linksLeft">
        <ul class="menu">
            <li class="current"><a href="">about</a></li>
            <li class="current" id="active"><a href="">portfolio</a>
                <ul class="subMenu" id="subNav">
                    <li><a href="">editorial</a></li>
                    <li><a href="">advertising</a></li>
                    <li><a href="">packaging</a></li>
                    <li><a href="">photography</a></li>    
                </ul>
            </li>
        </ul>
    </div>

#nav {
width:48em;
margin:auto;
text-align:center;
padding-top:6em;
list-style-type:none;
}

#outerBox {
margin:0;
padding:0;
}

#linksLeft{
float:left;
border-top:2px solid #93b9bb;
border-bottom:2px solid #93b9bb;
margin-top:60px;
padding:5px 0px;
}

#linksLeft li {
display:inline-block;
padding:0 3em;
position:relative;
}
#linksLeft li ul li {
display:block;
}

#subNav li{
position:absolute;
padding:1em;
left:50%;
/*display:none;*/
}

#linksRight li{
display:inline-block;
padding:0 3em;
position:relative;
} 
```

![在此处输入图像描述](../Images/1d56a71abb82b22d499b5e4cae2ff9c8.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:45:38.317

`position: absolute;`正在堆放它们。将其更改为相对，并在父容器上使用绝对定位将其定位到您想要的位置。

```
#subNav li{
    position:relative;
    padding:1em;
    left:50%;
    /*display:none;*/
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:48:07.247

问题是你的'#subnav li'的CSS。您为 ul 而不是 li 应用的样式。

CSS

```
#subNav {
    position:absolute;
    padding:1em;
    left:0;
    /*display:none;*/
}

#menu li{
    position:relative;
} 
```

这给了你你想要的

# automationelement - TreeScope 上的自动化 FindFirst 找不到元素

> ID：13978431
> 
> 赞同：1
> 
> 时间：2012-12-20T18:39:55.423
> 
> 标签：automationelement

在搜索 Name 属性和 ControlType 属性时，TreeScope 在 Internet Explorer 中查找元素时遇到问题。

mainElement 是表示“Internet Explorer_Server.

UISpy 中的 mainElement 下列出了所有自动化元素。

公共 Auto.AutomationElement GetElementByNameAndControlType(Auto.AutomationElement mainElement, System.Windows.Automation.ControlType controlType, string propertyName)

{

```
 Auto.AutomationElement target = null;

  Auto.PropertyCondition typeCondition1 = new Auto.PropertyCondition  (Auto.AutomationElement.ControlTypeProperty, controlType);

   Auto.PropertyCondition typeCondition2 = new Auto.PropertyCondition(Auto.AutomationElement.NameProperty, propertyName);

   Auto.AndCondition andCondition2 = new Auto.AndCondition(typeCondition1, typeCondition2);

   target = mainElement.FindFirst(Auto.TreeScope.Descendants, andCondition2);

        return target;
    } 
```

我终于能够使用下面的代码找到元素，但真的很想了解为什么上面的代码不起作用。

公共 Auto.AutomationElement GetElementByIsValuePatternAvailablePropertyAndName（Auto.AutomationElement mainElement，字符串名称，Auto.ControlType controlType）

{

```
 Auto.AutomationElement target = null;

   Auto.Condition conditions = new Auto.AndCondition(new Auto.PropertyCondition(Auto.AutomationElement.IsEnabledProperty, true),

   new Auto.PropertyCondition(Auto.AutomationElement.IsValuePatternAvailableProperty, true));

   // Find all children that match the specified conditions.
    Auto.AutomationElementCollection elementCollection = mainElement.FindAll  (Auto.TreeScope.Descendants, conditions);

  foreach (Auto.AutomationElement ae in elementCollection)
  {
      if (ae.Current.Name == name)
      {
                target = ae;
                break;
       }
  }

  return target; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-07T13:42:00.180

请在您的项目中添加 UIAutomationClient 和 UIAutomationTypes 的程序集引用；-) [通过马丁的回答](http://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/62819228-740a-4fa8-8367-14da77cc84b9/missing-using?forum=windowsaccessibilityandautomation)

# ant - Ant 构建多台服务器

> ID：13978439
> 
> 赞同：1
> 
> 时间：2012-12-20T18:40:12.593
> 
> 标签：ant

我需要为多台服务器创建 Ant 构建的建议。我有大约 25 台服务器。如果可能的话，我想通过运行一次 ant 来为所有服务器实现部署战争文件。我有以下问题需要考虑

*   并非所有服务器的配置参数都相同。
*   一些配置参数我必须设置部署应用程序的服务器主机 ip。有 25
    台服务器，想要一些关于如何处理这个问题的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-21T18:07:31.857

我有同样的目标。

您可以编写一个 Maven 脚本，以便在[Jayan提到的 Jenkins 上设置持续集成](https://stackoverflow.com/search?q=user:54506&tab=newest)

或者您可以像您提到的那样创建一个 ANT 脚本。

```
<!-- Define custom properties -->
<property name="build.dir" location="${basedir}/target" />
<property name="host.dev" value="YOUR IP" />
<property name="host.live" value="YOUR IP 2" />
<property name="ssh.timeout" value="60000" />
<property name="username.dev" value="username" />
<property name="username.live" value="username 2" />
<property name="password.dev" value="password" />
<property name="password.live" value="password 2" /> 
```

创建您自己的 ssh macrodef 任务以使用 ssh 命令：

```
<!-- Define ssh commands sshexec -->
<macrodef name="ssh_cmd">
    <attribute name="host" />
    <attribute name="command" />
    <attribute name="usepty" default="false" />
    <attribute name="username" />
    <attribute name="password" />
    <sequential>
        <echo>Executing command : @{command} on @{username}@@@{host}</echo>
        <sshexec host="@{host}" failonerror="true" username="@{username}" password="@{password}" timeout="${ssh.timeout}" command="@{command}" usepty="@{usepty}" trust="true" />
    </sequential>
</macrodef> 
```

向您的服务器发送命令，例如：

```
<ssh_cmd host="${host.dev}" command="YOUR COMMAND (ex: sudo start yourservice onlinux)" username="${username.dev}" password="${password.dev}"/> 
```

不要忘记使用以下内容导入 sshexec / scp ant 任务：

```
<property environment="env" />
<taskdef resource="net/jtools/classloadertask/antlib.xml">
    <classpath>
        <fileset dir="${ant.home}/lib" includes="ant-classloader*.jar" />
    </classpath>
</taskdef> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:58:59.410

您可以在 Ant 中手动编写逻辑代码来执行此操作，但可能需要大量工作，具体取决于您的服务器配置有多么不同。相反，我建议使用适当的配置管理工具（例如[Chef](http://wiki.opscode.com/display/chef/Home)或[Puppet](http://puppetlabs.com/puppet/what-is-puppet/)）来自动化您的部署，并且只使用 Ant 来构建已部署的文件。

# objective-c - 获取所有表格视图单元格，即使是不可见的

> ID：13978448
> 
> 赞同：0
> 
> 时间：2012-12-20T18:40:39.447
> 
> 标签：objective-c, uitableview

我需要遍历不同部分的表格视图单元格以计算每个部分的内容；但是，当我尝试这样做时：

```
CustomCell * c = (CustomCell *)[self.table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:i] 
```

如果“i”部分不可见，我无法获取里面的内容。

我必须说，在我调用calculate方法之前，我要在每个单元格中计算的内容会有所不同，所以我无法填充tableview然后计算。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:46:40.267

你不应该基于对象的内容进行*计算*`UITableViewCell`，因为它们本质上属于*表现*层；表示层不应该进行任何计算，只是隐藏和显示事物。

对于计算，您应该直接转到从中`UITableViewDataSource`获取数据的层（大概是您的*模型*类）并在那里进行计算。更好的是，将计算移至模型层，并提出一种按需获取的方法。

如果您正在修改其他人编写的现有代码，请首先检查 中的`tableView:cellForRowAtIndexPath:`方法`UITableViewDataSource`以查看它从何处获取数据。大概，那个地方有所有可用的数据，不管它是否显示在屏幕上。

# sql - 使用内部联接删除查询不起作用

> ID：13978452
> 
> 赞同：2
> 
> 时间：2012-12-20T18:41:07.907
> 
> 标签：sql

一个简单的查询有问题：

```
DELETE FROM t_meter_value mv
 INNER JOIN t_channel c ON mv.t_channel_id = c.id
      WHERE (c.t_device_device_address = 16777216 OR 
             c.t_device_device_address = 33619968)
        AND c.t_channelspec_channel_address NOT IN
            (256, 257, 259, 263, 261, 326, 271, 281, 273, 32778); 
```

我在内部得到一个语法错误，我不知道为什么。当我使用 select 变体时，它工作正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:43:19.237

相反，请尝试：

```
delete mv from t_meter_value mv
inner join t_channel c on mv.t_channel_id = c.id
where (
    c.t_device_device_address = 16777216 or 
    c.t_device_device_address = 33619968
  ) and 
  c.t_channelspec_channel_address not in (
    256, 257, 259, 263, 261, 326, 271, 281, 273, 32778
  ); 
```

请注意，别名`mv`是在`delete`和 之间添加的`from`。

这表明应该删除哪个表的记录...您还可以选择使用`delete c from`.

# phpmailer - phpmailer 发送电子邮件但不包含附件

> ID：13978456
> 
> 赞同：1
> 
> 时间：2012-12-20T18:41:14.550
> 
> 标签：phpmailer

我有以下代码通过 phpmailer 发送电子邮件，如果我不包含 AddAttachment 行，它工作正常，所以知道所有其他常量和变量都可以翻译。

```
$mail = new PHPMailer();
$mail->IsSMTP();
$mail->Host = EW_SMTP_SERVER;
$mail->SMTPAuth = TRUE;
$mail->Username = EW_SMTP_SERVER_USERNAME;
$mail->Password = EW_SMTP_SERVER_PASSWORD;
$mail->From = EW_SENDER_EMAIL;
$mail->FromName = EW_SENDER_EMAIL;
$mail->Subject = $mail_subject;
$mail->Body = $mail_message;
$mail->WordWrap = 50;
$mail->AddAttachment($mail_attachment);
$mail->AddAddress("something@yahoo.co.uk");
$mail->Send(); 
```

如果我包含附件行，则发送的电子邮件不带附件，并且不会提供任何错误消息。

如果我回显 $mail_attachment 它会给我 'leaflets/Booklet.pdf', 'leaflets/timetable-12.pdf'

我的脚本在一个名为“iytinfo”的文件夹中运行，而“leaflets”文件夹就在这个文件夹中。这 2 个文件肯定存在于“传单”文件夹中 - 我是否错误地指定了路径，或者还有什么我遗漏的东西？

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:47:10.690

您不能通过一次调用来添加多个文件`AddAttachment`。您必须像这样拨打两个电话：

```
// ... 
$mail->AddAttachment('leaflets/Booklet.pdf');
$mail->AddAttachment('leaflets/timetable-12.pdf');
// ... 
```

或者你循环通过你的文件名数组或其他任何东西。

# vim - 如何使 vim :source 接受不同的行尾？

> ID：13978457
> 
> 赞同：6
> 
> 时间：2012-12-20T18:41:14.490
> 
> 标签：vim, line-endings

`:source`在带有 dos 行结尾的 vimscript 文件上使用 vim 的命令会给我带来无法处理`^M`字符的错误。

这些`^M`字符是 dos 行结尾的一部分，但不是 unix 行结尾的一部分。所以它正在尝试`:source`使用unix文件格式的文件。

问题是，我已经`:set fileformats=unix,dos`开始了。*打开*和*编辑*文件（不是-ing）时`:source:`，没有行尾问题。Vim 看到一个带有纯 dos 行结尾的文件，并根据`fileformats`它进行相应的调整。

`:help fileformats`仅提供最简单的线索，即在*dos 系统*上，如果您有`:set fileformats=unix,dos`，vim 会执行它应该使用的临时检测（作为一个不相关的细节，此`:source`检测处理混合行结尾的方式与*打开*文件的方式不同）。

我在一个现代的 mac 系统上，我如何把它放到`:source`一个 dos 行结束文件中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T19:09:54.510

这在 讨论[`:h :source_crnl`](http://vimdoc.sourceforge.net/htmldoc/repeat.html#:source_crnl)。

在包括 Mac OS X 在内的 UNIX 系统上，没有自动 CRLF 检测，并且行尾的实际 CR*可能会*~~引发~~ 错误，*例如在映射*中。从帮助：

 **> 在其他系统上，Vim 期望 ":source"ed 文件以 <NL> 结尾。这些总是有效的。如果您正在使用带有 <CR><NL> <EOL> 的文件（例如，在 MS-DOS 上制作的文件），所有行都将有一个尾随 <CR>。

为获得最佳兼容性，最好让 Vim 脚本文件始终使用 NL 换行符。只要脚本的第一行由于某种原因没有以 CR 结尾并且`'fileformats'`不为空（默认情况下不为空），这些将始终在任何地方工作。

简而言之，考虑将行尾转换为 LF。**

# vba - 在列 vba 中按日期对行进行排序

> ID：13978458
> 
> 赞同：0
> 
> 时间：2012-12-20T18:41:25.503
> 
> 标签：vba, date, sorting, excel, autofilter

我试图让我的数据按 N 列中出现的日期对每一行进行排序。现在它只是按 istelf 对 n 列进行排序，而不改变任何其他信息。 **如何重新编写我的代码，以便整行移动，而不是仅移动该行中的单个单元格？**

```
 Sub SortByDate()
 Dim rSortRange As Range
 Dim ws As Worksheet

 Set ws = Sheets("Copy")
 Set rSortRange = ws.Range("N11", "N111")
 rSortRange.Sort Key1:=ws.Range("N11"), Order1:=xlAscending, _
            Key2:=Range("N20"), Order2:=xlAscending, _
            Key3:=Range("N29"), Order3:=xlAscending, _
            Header:=xlNo, OrderCustom:=1, MatchCase:=False, _
            Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, _
            DataOption2:=xlSortNormal, DataOption3:=xlSortNormal
 End Sub 
```

用下面的宏代码搞定了

```
 Sub SortByDate()
 Dim rSortRange As Range
 Dim ws As Worksheet

 Set ws = Sheets("Copy")
 Set rSortRange = ws.Range("N11", "N111")
 rSortRange.Sort Key1:=ws.Range("N11"), Order1:=xlAscending, _
            Key2:=Range("N20"), Order2:=xlAscending, _
            Key3:=Range("N29"), Order3:=xlAscending, _
            Header:=xlNo, OrderCustom:=1, MatchCase:=False, _
            Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, _
            DataOption2:=xlSortNormal, DataOption3:=xlSortNormal
 End Sub 
```

有时我忘记了录制宏是多么容易！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:18:04.867

```
 Sub SortByDate()
  Dim rSortRange As Range
  Dim ws As Worksheet

  Set ws = Sheets("Copy")
  Set rSortRange = ws.Range("N11", "N111")
  rSortRange.Sort Key1:=ws.Range("N11"), Order1:=xlAscending, _
        Key2:=Range("N20"), Order2:=xlAscending, _
        Key3:=Range("N29"), Order3:=xlAscending, _
        Header:=xlNo, OrderCustom:=1, MatchCase:=False, _
        Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, _
        DataOption2:=xlSortNormal, DataOption3:=xlSortNormal
  End Sub 
```

# iphone - 如何从非标准 URL NSString 对象中提取参数？

> ID：13978463
> 
> 赞同：4
> 
> 时间：2012-12-20T18:41:51.480
> 
> 标签：iphone, objective-c, ios

我正在深入研究 iOS 开发，并且我的 iPhone 应用程序有一个自定义 URL 方案，看起来像`myApp://?q=200`. 我有以下代码来获取查询参数...

```
NSString *urlString = [url absoluteString];
NSString *query = [urlString stringByReplacingOccurrencesOfString:@"myApp://?q=" withString:@""]; 
```

...但如果我添加更多参数，我想让它更具前瞻性。如何以更安全的方式提取“q”参数？

提前感谢您的智慧！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:52:38.500

`&`您可以使用and拆分从 URL 返回的查询`=`，并将它们放入字典中。

```
NSURL *url = [NSURL URLWithString:@"myApp://?q=200"];

NSArray *query = [[url query] componentsSeparatedByString:@"&"];
NSMutableDictionary *parameters = [NSMutableDictionary dictionaryWithCapacity:[query count]];
for(NSString *parameter in query)
{
    NSArray *kv = [parameter componentsSeparatedByString:@"="];
    [parameters setObject:[kv count] > 1 ? [[kv objectAtIndex:1] stringByReplacingPercentEscapesUsingEncoding:NSISOLatin1StringEncoding] : [NSNull null]
               forKey:[[kv objectAtIndex:0] stringByReplacingPercentEscapesUsingEncoding:NSISOLatin1StringEncoding]];
}

NSLog(@"Parameters: %@", parameters);
NSLog(@"q = %@", [parameters objectForKey:@"q"]); 
```

在此示例中，如果参数没有值，我只需将其设置为`NSNull`. 这意味着您需要检查`NSNull`或更改逻辑以跳过带有值的键或将它们设置为空字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:55:10.397

这从我的头顶可以工作，但还没有包括错误检查输入

```
-(NSDictionary*) parameterDictionaryFromString: (NSURL*) url {
//input can be something like: "myApp://?q=one&q2=two&q3=three"
NSString *requestString = [url query];

//now we have q=one&q2=two&q3=three

NSArray *requests = [requestString componentsSeparatedByString: @"&"];

NSMutableDictionary *resultDictionary = [NSMutableDictionary dictionary];

for (NSString *singleParameter in requests) {
    NSArray *keyValuePair = [singleParameter componentsSeparatedByString: @"="];
    [resultDictionary setObject: [keyValuePair objectAtIndex: 1] forKey: [keyValuePair objectAtIndex: 0]];
}
NSURL *u = [NSURL URLWithString: @"myApp://something?q=1&check=yes"];
NSLog(@"paramStr = %@", [u parameterString]);

return [resultDictionary copy]; 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T02:26:07.617

1.  通过不同的分隔符打破查询字符串，
2.  确保在 index:1 处提供的有价值的内容（查询字符串中断的右侧）
3.  然后在有价值的内容中使用下游，或设置为上游变量。

* * *

```
//Your Example:
//@"myApp://?q=200"

//Break:
NSArray *queryParts = [urlString componentsSeparatedByString:@"?q="];

//Assure Content:
if ([[array objectAtIndex:1] length]>0) {

    //Setter:
    NSString *queryString = [array objectAtIndex:1];

    //... Use away...
} 
```

关键是利用 NSArray 类而不是 StringReplace。

# eclipse - 导入项目：有没有办法将根目录设置为 workspace_loc

> ID：13978469
> 
> 赞同：1
> 
> 时间：2012-12-20T18:42:07.763
> 
> 标签：eclipse, filepath

在对话框中

```
File->Import->General->Existing Projects 
```

根目录默认为我的 windows 机器的顶层。是否有选择根目录的简写`workspace_loc`或首选项来设置此对话框的默认行为？

目前，我剪切和粘贴，或者只是在对话框中手动向下钻取，但想检查是否有更好的方法。

# java - com.apple.eawt - 我应该安装什么

> ID：13978471
> 
> 赞同：11
> 
> 时间：2012-12-20T18:42:08.950
> 
> 标签：java, macos, osx-mountain-lion

我正在使用 Max OS X Mountain Lion，java -version 返回“1.6.0_37”。但我无法使用导入的 com.apple.eawt.* 类编译项目。

我必须安装什么才能在我的系统上安装 Apple Java 扩展？

任何帮助，将不胜感激！

**更新**：

我从编译器收到以下错误：

```
java: package com.apple.eawt does not exist 
```

**更新 2**：

XCode 版本 4.5.2 已安装

**更新 3**：

我的问题的原因是在类路径中错过了 ui.jar。感谢@Ian Roberts

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T21:37:07.243

无需下载 JAR 或安装任何额外内容，这些类是 Mac OS X 上 JDK 的一部分。在 Apple Java 6 JDK 中，它们位于`Contents/Classes/ui.jar`JDK 捆绑包（例如`/System/Library/Java/JavaVirtualMachines/1.6.0.jdk`或`/Library/Java/JavaVirtualMachines/1.6.0_37-b06-434.jdk`）下，在 Oracle Java 7 中，它们`lib/rt.jar`位于JRE 主目录（`/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home`或`/Library/Java/JavaVirtualMachines/jdk1.7.0*.jdk/Contents/Home/jre`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-07-07T17:05:00.133

# Java 9 及更高版本的解决方案

> 在 JDK 9 中，内部 API（例如 Mac OS X com.apple.eawt 包中的 API）将不再可访问。

见： http: [//openjdk.java.net/jeps/272](http://openjdk.java.net/jeps/272)

`com.apple.eawt`已被替换。
此处介绍了一些功能：[https ://docs.oracle.com/javase/9​​/docs/api/java/awt/Taskbar.html](https://docs.oracle.com/javase/9/docs/api/java/awt/Taskbar.html)

在 mac os 中设置停靠图标的示例实现可以在这里找到：
[https ://stackoverflow.com/a/56924202/5276779](https://stackoverflow.com/a/56924202/5276779)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-05T20:18:04.510

以防万一您仍在寻找并且其他人点击了此功能，MacOS GestureUtilities 仍可用于该平台。查看[Java 9 中 GestureUtilities 的替代方法](https://stackoverflow.com/questions/48535595/what-replaces-gestureutilities-in-java-9)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-20T21:21:09.047

就像任何其他外部库一样，您必须将包含这些类的 JAR 添加到您的类路径中。仅仅因为您在 Mac 上运行并不意味着现有的 Java JDK 是“扩展的”——否则，它就不会真正独立于平台。

# ember.js - Ember.js：一种真正的捕获所有路线的方法？

> ID：13978472
> 
> 赞同：4
> 
> 时间：2012-12-20T18:42:43.273
> 
> 标签：ember.js, routes, ember-router, catch-all

我知道可以做[这样](https://stackoverflow.com/questions/12025459/emberjs-is-there-a-way-to-create-a-catch-all-route)的事情，但我要求的是一个`else`与以前未定义的任何 URL（或状态）匹配的路由。

如果用户试图访问无效的状态或 URL，这可能会很方便。

但是，如果有其他方法可以做到这一点：D

希望这是有道理的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-01T16:38:03.427

这是从另一个问题的答案中得出的，[因此请投票赞成](https://stackoverflow.com/a/15098585/980459)：

```
App.Router.map(function() {
  this.route('catchAll', { path: '*:' });
});

App.CatchAllRoute = Ember.Route.extend({ 
    redirect: function() {
        this.transitionTo('index'); 
    }
}); 
```

# mysql - Mysql左连接，仅当字段is_active = 1时才覆盖行

> ID：13978474
> 
> 赞同：1
> 
> 时间：2012-12-20T18:42:49.810
> 
> 标签：mysql, join, union

上午 9 点我从以前的帖子中获得了有关查询的帮助，但我有一个新问题。请耐心等待我的解释......

设置，2 个表：`cal_events`其中包含日历的动态事件和在一天内对其进行更新的重复事件。此外，`cal_events_recurring`它包含重复事件。下面的查询是一个示例，其中包含将由 PHP 传递的虚拟数据。我从 12 月 15 日开始，所以返回当天的所有活动。重要的部分是重复事件仅在没有匹配的动态对应项时才返回。如果`cal_events`, `is_overwrite`= 1 及其`overwrite_id`= (上午 9:00`cal_events_recurring`事件的唯一 id，则只返回动态表行。这意味着，“嘿，我是每天上午 9:00 发生的事件（示例），但是看，在 12 月 15 日，9:00 的重复事件已根据动态表更新了当天的唯一 ID =，`overwrite_id`所以返回那个。”

```
select * from(
    select
        ifnull(ce.time, cer.time) as time,
        ifnull(ce.title, cer.title) as title,
        ce.is_overwrite
    from cal_events_recurring cer
    left join cal_events ce on ce.overwrite_id = cer.id
    where cer.is_daily = 1
    or cer.day_index = 6
    or cer.day_num = 15
    union
    select time as time, title, is_overwrite 
    from cal_events where date = '2012-12-15' 
    and is_active = 1 and is_overwrite = 0) as e order by time asc 
```

这一切都很好，数据是正确的，问题是`is_active`字段。我将再次离开上午 9:00 的示例。我为 16 日上午 9:00 创建了一个动态事件，它将覆盖 16 日的重复事件。现在，如果我稍后决定要恢复到常规重复事件，我将`is_active`匹配动态事件的字段设置为 0。问题是仍然返回动态事件。如果我添加`and ce.is_active = 0`事件仍然返回。我将如何编写它，以便如果其动态对应项未激活，它仍会返回重复事件？

如果您需要任何其他信息，请告诉我！

编辑*输出：

```
time      title 
08:00:00  recurring everyday 8am
09:00:00  dynamic 9am update 

(9am should be the recurring event because the dynamic    is_active = 0) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:44:35.120

将该条件放入`ON`子句中：

```
select * from(
    select
        ifnull(ce.time, cer.time) as time,
        ifnull(ce.title, cer.title) as title,
        ce.is_overwrite
    from cal_events_recurring cer
    left join cal_events ce on ce.overwrite_id = cer.id
        and ce.is_overwrite = 1     -- Added this line
    where cer.is_daily = 1
    or cer.day_index = 6
    or cer.day_num = 15
    union
    select time as time, title, is_overwrite 
    from cal_events where date = '2012-12-15' 
    and is_active = 1 and is_overwrite = 0) as e order by time asc
) 
```

将特殊条件放入连接条件意味着您仍然可以获得左连接，但仅适用于应该连接的行。

如果您将条件放在 where 子句中，您将“破坏”左连接和 的意图，`ifnull()`原因如下：

联接子句中的条件`ON`在进行联接时执行，因此您不想联接的行不会被联接，也不会将它们的值放入`ifnull()`函数中。

一个常见的误解是，连接条件只能是“键相关的”，而实际上它们可以是任何东西。

如果将条件放入 where 子句，它会在连接完成*后*执行- where 子句*过滤*结果集，所以为时已晚 -`ifnull()`已经有动态表的数据。

# puppet - 如何使用 puppet 安装 iptraf 等网络工具

> ID：13978479
> 
> 赞同：0
> 
> 时间：2012-12-20T18:43:03.877
> 
> 标签：puppet

我[在github上使用iptraf的例子](https://github.com/duritong/puppet-iptraf.git)

我做了一个 git clone，然后 sudo puppet apply init.pp

但我没有看到 ubuntu 11.04 主机上安装了 iptraf

现在这个木偶只是一个客户端实例，没有主人。

从另一个示例中，我看到我可以将 apache2 安装为：

```
 class basic_services {

      ##Get Apache
      package { 'apache2':
        ensure => 'installed',
      }

      ##Edit the Apache Conf
      file { "/etc/apache2/sites-available/default":
          require => Package["apache2"],
          owner => "root",
          group => "root",
          content => "$some_variables::apache_config",
      }

      ##Make sure Apache is running, and restarts on changes to conf
      service {'apache2':
        require => Package["apache2"],
        ensure => running,
        subscribe => File["/etc/apache2/sites-available/default"],
      }
} 
```

所以对于iptraf：

```
init.pp
class iptraf {
  include iptraf::base
}

base.pp

class iptraf::base {
  package{'iptraf': ensure => installed }  
} 
```

我将以此示例为基础来开发测试工具的清单

那么我在这里缺少什么，就像我跑步之后一样：

sudo puppet apply init.pp ，并尝试访问 iptraf，我收到消息：

```
iptraf
The program 'iptraf' is currently not installed.  You can install it by typing:
sudo apt-get install iptraf 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:07:06.047

在目录中：/etc/puppet/modules/iptraf - 创建一个文件：iptraf.pp - 内容：

package { "iptraf": ensure => "installed" } - 发出命令：

puppet apply iptraf.pp /Stage[main]//Package[iptraf]/ensure: 确保将 'purged' 更改为 'present' 完成目录在 2.71 秒内运行

在命令行上运行 iptraf，UI 弹出。完毕！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:40:13.017

将 iptraf 目录移动到模块中。你的目录结构应该是这样的：

/etc/puppet/modules/iptraf/manifests/{init.pp,base.pp}

然后做，

sudo puppet apply -e '包括 iptraf'

那应该安装iptraf。

sudo iptraf 应该在您的终端中打开一个漂亮的屏幕:)

# c++ - 使用 freopen() 打印到文件和屏幕

> ID：13978480
> 
> 赞同：12
> 
> 时间：2012-12-20T18:43:05.427
> 
> 标签：c++, freopen

我正在尝试使用 freopen() 打印到文本文件和屏幕，但我只是实现打印到文件。

我想知道是否可以轻松地将程序输出保存到文件并将其打印到屏幕上？因为我以另一种方式工作，但我最终不得不将每条语句打印两次。一个用于文件，另一个仅用于输出。

注意：我是 C++ 的新手，我正在尝试为下学期的课程学习它，所以需要直接的答案，因为我已经在网上查找过，除了这个解决方案之外找不到任何简单的答案。

这是我到目前为止所拥有的：

```
#include<iostream>
#include<time.h>
#include<stdlib.h>
#include<fstream>

using namespace std; 

void menu(){
    cout << "\t********************************************************\n"
         << "\t* Welcome to slot machine.                             *\n"
         << "\t* Would you like to play? (1 to play, 2 not to play)   *\n"
         << "\t********************************************************\n\n";
    return;
}

void update(int arr[], int &token) {
    if (arr[0]==arr[1] && arr[1]==arr[2]) {
        token+=4;
        cout << "You win\n\n";
    } else if (arr[0]==arr[1] || arr[1]==arr[2] || arr[0]==arr[2]) {
        token+=1;
        cout << "You got two out of three\n\n";
    } else {
        token-=1;
        cout << "You lose\n\n";
    }
}

int main() {
    freopen("file.txt", "w", stdout);
    int x, arr[3], token=4;
    srand(time(0));
    menu();
    cin >> x;
    while(token!=0) {
        cout << "You have " << token << " tokens\n\n"
             << "Pull? (1 to pull, 2 not to pull)\n\n";
        cin>>x;
        if(x==1) {
            for(int i=0; i<3; i++) {
                arr[i]=1+rand()%10;
            }
            cout << "\t\t";
            for(int j=0; j<3; j++) {
                cout << arr[j] << " ";
            }
            cout << "\n\n";
            update(arr,token);
        }
        else{  
            cout << "OK\n";
        }
    }
    cin.get();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T18:59:09.267

我不知道实现这一目标的简单方法，但我设法以某种方式解决了这个问题。

使用 fstreams，您可以像写入控制台一样输出到文件。

```
#include <fstream>

int main()
{
     std::ofstream f("file.txt");
     f << "something";
} 
```

现在有一点我们可以开始了：有没有一种方法可以同时输出到控制台和文件？

我最近编写了流解复用器来解决这个问题：

```
#include <vector>
#include <ostream>
class stream_demultiplexer
{
private:
    typedef std::vector<std::ostream*> str_cont;
    str_cont d;
public:
    stream_demultiplexer& put(std::ostream::char_type ch)
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (*it)->put(ch);
        return *this;
    }

    stream_demultiplexer& write(const std::ostream::char_type* s, std::streamsize count)
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (*it)->write(s, count);
        return *this;
    }

    stream_demultiplexer& flush()
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (*it)->flush();
        return *this;
    }

    template<typename T>
    stream_demultiplexer& operator<<( const T& obj )
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (**it) << obj;
        return *this;
    }

    stream_demultiplexer& operator<<(std::ios_base& (*func)(std::ios_base&))
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (**it) << func;
        return *this;
    }

    template<typename CharT, typename Traits>
    stream_demultiplexer& operator<<(std::basic_ios<CharT,Traits>& (*func)(std::basic_ios<CharT,Traits>&) )
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (**it) << func;
        return *this;
    }

    stream_demultiplexer& operator<<(std::ostream& (*func)(std::ostream&) )
    {
        for(str_cont::iterator it = d.begin(); it != d.end(); ++it)
            (**it) << func;
        return *this;
    }

    void add_stream(std::ostream& ss)
    {
        d.push_back(&ss);
    }
}; 
```

你可以像这样使用它：

```
stream_demultiplexer spl;
std::ofstream f("file.txt");
spl.add_stream(f);
spl.add_stream(std::cout);
spl << 55 << " HELLO WORLD"; 
```

我的方法的优点是操纵器和未格式化的输出可以正常工作：

```
spl << 76 << " " << std::hex << 76 << std::endl;
spl.put('a');
spl.write("ABCDE", 5); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T18:58:33.027

在类 UNIX 环境中，最简单的方法是使用 shell 命令`tee`：

```
$ my-program | tee output.txt 
```

将 stdout 复制到终端，也复制到文件`output.txt`.

* * *

如果您必须在代码中执行此操作，您可以使用自己的输出流而不是`cout`，它将每一个转发`operator<<`到两个（或更多）`ostreams`。（对我来说）这感觉比在 C++ ostream 底层的 C 输出文件中乱七八糟更好`cout`。

```
#include <ostream>

class Tee {
    std::ostream &first, &second;

    template<typename T> friend Tee& operator<< (Tee&, T);

public:
    Tee(std::ostream &f, std::ostream &s) : first(f), second(s) {}
};

template <typename T>
Tee& operator<< (Tee &t, T val)
{
    t.first << val;
    t.second << val;
    return t;
} 
```

然后，如果您将 freopen 行替换为：

```
std::ofstream outfile("file.txt");
Tee tee(std::cout, outfile); 
```

你可以只使用`tee <<`而不是`cout <<`.

请注意，您要么需要传递`tee`给您的函数，要么将其设为全局函数才能正常工作。

# sql - 如何在 Sql Server 2008 中设置唯一约束

> ID：13978481
> 
> 赞同：0
> 
> 时间：2012-12-20T18:43:09.203
> 
> 标签：sql, sql-server, sql-server-2008, constraints, unique-constraint

> **可能重复：**
> [SQL Server 2005 如何创建唯一约束？](https://stackoverflow.com/questions/64981/sql-server-2005-how-create-a-unique-constraint)
> [在 SQL Server 2008 GUI 中添加唯一约束？](https://stackoverflow.com/questions/13643023/add-unique-constraint-in-sql-server-2008-gui)

我在 Sql Server 2008 中有一个名为 customer 的表。我想在电子邮件字段中添加一个唯一约束——这样电子邮件就不应该重复（不使用查询）。我尝试了如图所示的方式，但无法设置约束。请帮忙。 ![在此处输入图像描述](../Images/0938630c8c63e015ab53f8dd2c779685.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:50:17.143

检查约束用于检查一行中的数据是否与公式匹配 - SSMS 是正确的，你不能在那里有一个空白的论坛。

您要做的是转到 Indexes/Keys 并在电子邮件字段上添加一个新索引并将其设置为 Is Unique=Yes 并输入 Unique Key（如 hvd 所建议的，您还可以通过选择 Type 从此处创建一个唯一索引=索引）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:57:28.493

电子邮件**不应该是 TEXT**类型

![在此处输入图像描述](../Images/d2691b4255b61fe2553e1a2eb67dfa15.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T18:59:25.017

您可以执行以下操作：

```
ALTER TABLE Comment ADD CONSTRAINT uc_Comment UNIQUE (CommentId, Comment) 
```

CommentId 是 PK。

我相信它实际上为此创建了一个索引。

# javascript - 使用表单时输入按钮不起作用

> ID：13978483
> 
> 赞同：0
> 
> 时间：2012-12-20T18:43:22.480
> 
> 标签：javascript, html

这是我的代码：

```
<form>
    <input type="text" id="input"/>
    <br/>
    <div id="buttons">
        <input id="search" onclick="search()" type="button" value="Search"/>
        <input type="button" value="Random"/>
        <script type="text/javascript">
        function search() {
            var search = document.getElementById('search');
            var int = setInterval(function() {
                if (search.value.length == 6) search.value = 'Searchi';
                else if (search.value.length == 7) 
                    search.value = 'Searchin';
                else if (search.value.length == 8) 
                    search.value = 'Searching';
                else {
                    search.value = 'Search';
                }
                //clearInterval( int ); // at some point, clear the setInterval
            }, 500);
        }​
        </script>
    </div>
    </form> 
```

`<form>`当元素在代码中时，按钮功能不起作用。通过删除表单元素，您将看到 JavaScript 工作正常！我想知道是什么问题？我该如何解决？

另外，我想要的结果是否有更好的代码？有人告诉我，我使用的是旧的 JavaScript 方法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:48:10.800

`search`更改IE中隐藏全局对象功能的元素id-search ：

```
<input id="search" onclick="search()" type="button" value="Search"/> 
```

应该：

```
<input id="search-suffix" onclick="search()" type="button" value="Search"/> 
```

附言

[`int`是 javascript 中的保留字](http://msdn.microsoft.com/en-us/library/ttyab5c8.aspx)，虽然它同时不做任何事情，就像`class`等`private`'，因此应该避免。

# ruby - Kanwei minheap 慢红宝石

> ID：13978484
> 
> 赞同：4
> 
> 时间：2012-12-20T18:43:24.377
> 
> 标签：ruby, heap, containers, min

我在 ruby​​ 中实现了一个最小堆，我想针对更专业的代码进行测试，但我无法让 Kanwei 的 MinHeap 正常工作。这个：

```
mh = Containers::MinHeap.new # Min_Binary_Heap.new
for i in 0..99999
    mh.push(rand(9572943))
end

t = Time.now
for i in 0..99999
    mh.pop
end
t = Time.now - t
print "#{t}s" 
```

我的版本在 2.2 秒内对 100,000 个值执行相同的弹出操作，我认为这非常慢，但这甚至不会完成运行。这是预期的还是我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:36:48.110

我不认为你做错了什么。

查看源代码（[https://github.com/kanwei/algorithms/blob/master/lib/containers/heap.rb](https://github.com/kanwei/algorithms/blob/master/lib/containers/heap.rb)），在完成堆设置时放置一个 puts 语句。将元素放入（可能每次都使用）看起来像是一个非常占用内存的操作，因此它可能会帮助您完成它。

我也不确定他是否为每个实际节点创建一个节点类。由于它们不会被清理，所以当你完成时，内存中将有大约 100,000 个对象。

不确定这有多少帮助，也许看看来源与您的尝试有何不同？

# c# - 用于冗余库的 C# .NET 包装程序集开发

> ID：13978494
> 
> 赞同：2
> 
> 时间：2012-12-20T18:44:24.353
> 
> 标签：c#, .net, api, interface, wrapper

假设我需要开发一个允许使用多个底层框架中的任何一个的包装程序集。后者可能用于数据访问、图形或其他。这是假设所有底层库都提供基本相同的功能，但无论出于何种原因，您可能不得不在不同的情况下使用其中一个或另一个。

调用者希望将代码编写为单一规范并在要使用的任何底层框架中进行交换，而无需更改源代码。

C# 和 .NET 中的哪些语言和框架功能可以最好地避免维护包装类库的多个副本，因为这种冗余会导致需要对包装 API 进行多次更新以修复和增强？C# 接口和委托是我想到的两个特性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:46:46.263

您将使用接口为包装器创建大纲。

然后，您将为使用特定底层框架的每个包装器实现这些接口。

然后可以轻松地相互交换各个包装器，而无需更改调用代码。

根据您的需要，您还可以使用配置值在运行时动态实例化给定的包装器。这将允许您交换包装器而无需重新编译您的代码。

# javascript - FB页面上的地理定位帖子不起作用

> ID：13978495
> 
> 赞同：3
> 
> 时间：2012-12-20T18:44:33.897
> 
> 标签：javascript, facebook, facebook-graph-api

我可以让我的帖子显示正确的链接、状态、图像等，但我似乎无法让定位正常工作。这是我在 json 定位字段中发布的内容：

```
{
  ...
  message: "test status message",
  targeting: "{"cities":[{"name":"Austin, TX","key":2525495,"subtext":"TX, United States"},    {"name":"San Marcos, TX","key":2529779,"subtext":"TX, United States"},{"name":"Round Rock,   TX","key":2529681,"subtext":"TX, United States"},{"name":"Cedar Park, TX","key":2526105,"subtext":"TX, United States"},{"name":"Georgetown, TX","key":2527173,"subtext":"TX, United States"},{"name":"Blanco, TX","key":2525726,"subtext":"TX, United States"}]}",
  ...
} 
```

我在帖子中看到的结果是：

```
Shared with: Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra
News feed targeting: Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra, Aixàs, Andorra 
```

在另一个测试中，我尝试发送以下内容：

```
{
...
targeting: "{'countries':['US'],'regions':[{'key': 25,'name': 'Massachusetts','country_code': 'US'}]}"
...
} 
```

虽然发布了帖子，但结果却一无所获：

```
Shared with: 
```

任何人都可以对此有所了解。第一个很有趣，因为我试图以六个城市为目标，并在安道尔获得六个城市的副本。我不太确定我做错了什么。我查看了所有文档，甚至从 autocomplte api 复制了我的数据。

任何帮助将不胜感激。

谢谢，大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T17:06:40.497

看来您现在必须使用`feed_targeting`参数而不是`targeting`帖子中的参数。`targeting`现在用于称为“门控”的东西，它不仅针对指定区域，而且限制他们与该区域以外的任何人重新分享帖子的能力（通常用于区域法律/权利问题）。

此外，除非您使用“页面访问令牌”而不是“用户访问令牌”，否则您仍然无法定位帖子，如下[所述](https://developers.facebook.com/docs/reference/api/page/#page_access_tokens)：

> 要以 Page 而非当前用户的身份执行以下操作，您必须使用 Page 的访问令牌，而不是通常用于读取 Graph API 对象的用户访问令牌。可以通过向具有 manage_pages 权限的 /USER_ID/accounts 发出 HTTP GET 来检索此访问令牌。这将返回用户具有管理权限的页面列表（包括应用程序配置页面），以及这些页面的 access_tokens。或者，您可以通过向具有 manage_pages 权限的 /PAGE_ID?fields=access_token 发出 HTTP GET 来获取单个特定页面的页面访问令牌，如上所述。除非另有说明，否则发布到页面还需要 publish_stream 权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T09:58:06.883

虽然现在这可能通过从定位转移到 feed_targeting 来解决，但我想分享一个我们遇到的相关问题，因为我们花了几个小时才发现出了什么问题。

我们在安道尔的 Aixàs 也出现了所有封闭的帖子。在我们的案例中，我们对实际上不允许的城市进行门控，您只能对国家和语言进行门控。Facebook 以某种方式匹配到 Aixàs、安道尔的所有门控，也许它们是表中的第一个条目？

当我们从门控选项中删除城市时，一切正常。

# java - 我如何弄清楚为什么我的 Struts 2 动作没有被映射？

> ID：13978497
> 
> 赞同：0
> 
> 时间：2012-12-20T18:44:36.480
> 
> 标签：java, struts2, struts-config

> **可能重复：**
> [没有为命名空间/和动作名称教程映射的动作](https://stackoverflow.com/questions/13978955/there-is-no-action-mapped-for-namespace-and-action-name-tutorial)

当我尝试执行 Struts 2 操作时，我收到以下错误消息：

```
There is no Action mapped for namespace / and action name getTutorial. - [unknown    location] 
```

我正在使用 Eclipse indigo IDE、Tomcat 7 和 JDK 1.7。我包含的jar文件是commons-logging-1.0.4.jar、freemarker-2.3.8.jar、ognl-2.6.11.jar、struts2-core-2.0.11.jar、xwork-2.0.4.jar。我将 struts.xml 放在 WEB-INF 的 classes 文件夹中，我也尝试将它放在
src 文件夹中，但我无法做到。

# struts.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration  
  2.0//EN" "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
  <package name="default" extends="struts-default">
    <action name="tutorial" class="com.test.TutorialAction">
      <result name="success">/success.jsp</result>
      <result name="failure">/failure.jsp</result>
    </action>
  </package>
</struts> 
```

# java - 工厂方法的 Spring 注解

> ID：13978501
> 
> 赞同：2
> 
> 时间：2012-12-20T18:44:43.820
> 
> 标签：java, spring

我定义了以下 oracle 连接池工厂。问题是我是否必须将整个工厂实例注入 bean 或以某种方式注入`OracleConnectionPoolDataSource`bean？

```
 <bean id="oraclePooledDataSourceFactory" class="oracle.ucp.jdbc.PoolDataSourceFactory" factory-method="getPoolDataSource">
    <!-- DataSource Class to be used -->
    <property name="connectionFactoryClassName" value="oracle.jdbc.pool.OracleConnectionPoolDataSource"/>
    <!-- Connection -->
    <property name="URL">
        <value>${jdbc.connection.url}</value>
    </property>
    <property name="user">
        <value>${jdbc.connection.username}</value>
    </property>
    <property name="password">
        <value>${jdbc.connection.password}</value>
    </property> 
```

***豆注：？？***

```
 @Autowired
@Required
@Qualifier("oraclePooledDataSource") <------ ????
public void setDatabaseSource(OracleConnectionPoolDataSource databaseSource) {
    this.databaseSource = databaseSource;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:00:21.823

我希望这可行...从您的`oraclePooledDataSourceFactory`定义中删除 factory-method 属性并引入另一个 bean 定义。

```
<bean id="oraclePooledDataSource" factory-bean="oraclePooledDataSourceFactory"
  factory-method="getPoolDataSource"/> 
```

在你的课堂上，自动接线保持你提到的方式。我不确定你是否需要`@Required`属性

# php - 使用 jquery 显示帖子结果

> ID：13978502
> 
> 赞同：0
> 
> 时间：2012-12-20T18:44:44.677
> 
> 标签：php, jquery, ajax

我正在尝试用 jquery 制作一个简单的发送表单。这是我的代码：

**jQuery：**

```
$(document).ready(function() {
 $(".someButton").click(function(){
     var response = $('#dle-poke').val()
     var responses = $('#dle-pokes').val()
     $.post(dle_root + 'engine/ajax/fastpm.php', {text:response, texts:responses, action:"fastqpro"},

  function(data) {      
  });   

});
}); 
```

**PHP：**

```
if ($_POST['action'] == "fastqpro") {
  $title= $db->safesql($text);
  $db->query("INSERT INTO dle_post (`autor`, `title`) values ('{$name}', '{$title}')");
} 
```

一切正常，但我需要显示发送结果。

例如，如果标题为空或类似这样：

```
if ($_POST['action'] == "fastqpro") {
  if($text == "" ){
    "Title is empty"
  };
  $title= $db->safesql($text);
  $db->query("INSERT INTO dle_post (`autor`, `title`) values ('{$name}', '{$title}')");
} 
```

而且，如果一切正常，我需要显示 OK 消息并隐藏表单。

**HTML：**

```
<div class="area">
  <input id='dle-pokes' type='text' /><br>
  <textarea name='dle-poke' id='dle-poke'></textarea>
  <div id='resault'></div>
</div> 
```

我如何从我的 php 代码中获取并显示结果并在 html 页面中显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:48:26.763

你错过`echo`了你的 PHP 代码。

它应该是

```
if($text == "" ){
    echo "Title is empty";
}; 
```

要显示结果，请将`div`其添加到`function(data)`：

```
$('#resault').html(data); 
```

你的 div id 有错别字，但我想这里没关系，请注意 jquery 中的 div id 和选择器是相同的 :)

一般应该是：

jQuery：

```
$.post('mywebsite.com/adress.php', {variable1_name: var1_value, variable2: value2}, function(data) {
    $('element_selector').html(data);
}); 
```

PHP：

```
$var1 = $_POST['variable1_name'];
$var2 = $_POST['variable2'];

//..... do something

echo $result; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:57:06.617

请尝试这种方式：

```
 if ($_POST['action'] == "fastqpro") {
  if($text == "" ){
    echo "Title is empty";
  }else{
  $title= $db->safesql($text);
  $db->query("INSERT INTO dle_post (`autor`, `title`) values ('{$name}', '{$title}')");
  echo "Success Message";
  }
} 
```

之后在jquery脚本区域之后 `function(data){`

```
$('#resault').html(data); 
```

# python - 如何让两个模型相互引用 Django

> ID：13978503
> 
> 赞同：32
> 
> 时间：2012-12-20T18:44:47.680
> 
> 标签：python, django, django-models, model

我有以下代码：

```
class Game(models.Model):
    title = models.CharField(max_length=50)
    summery = models.CharField(max_length=500)
    key = models.IntegerField()
    pin = models.CharField(max_length=12)
    complete = models.BooleanField()
    invite_sent = models.DateTimeField()
    on = models.ForeignKey(Member, blank = True) #<----

class Member(models.Model):
    email = models.CharField(max_length=100)
    color = models.CharField(max_length=11)
    game = models.ForeignKey(Game) #<---- 
```

“打开”外键链接到成员之一（轮到它）。游戏的所有成员都将他们的“游戏”外键设置为他们所在的游戏。问题是Django不允许我在声明之前引用一个类，因为我不能同时声明它们......

编辑：为了澄清事情，这里有一个例子。如果有五个成员玩一个游戏，那么所有五个成员都将拥有该游戏的外键。另一方面，游戏将有一个外键指向轮到该特定成员的特定成员。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-12-20T20:18:16.100

[ForeignKey 字段](https://docs.djangoproject.com/en/4.0/ref/models/fields/#django.db.models.ForeignKey)的Django 文档指出：

> 如果您需要在尚未定义的模型上创建关系，您可以使用模型的名称，而不是模型对象本身。

所以在你的情况下，那将是：

```
class Game(models.Model):
    # Other fields...
    on = models.ForeignKey('Member', blank = True)

class Member(models.Model):
    # Other fields...
    game = models.ForeignKey(Game) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-20T18:53:50.130

您不需要让两个模型使用外键相互引用。删除行：

```
on = models.ForeignKey(Member, blank = True) #<---- 
```

从逻辑上讲，您`Member`的 's 仍将与不同`Game`的 's 相关联（这更有意义，因为一个成员一次可以属于一个游戏，而一个游戏可以有多个成员）。

您可以使用[反向关系](https://docs.djangoproject.com/en/dev/topics/db/queries/)来确定哪些成员在特定游戏中。

# c# - PictureBox上的动态点击事件

> ID：13978506
> 
> 赞同：0
> 
> 时间：2012-12-20T18:44:56.103
> 
> 标签：c#, .net

我从目录中获取图片列表并将文件名存储在`List<String>`. 然后我遍历其中的每一个并`PictureBox`为它们中的每一个创建一个，然后我为每个添加相同的点击事件。控件位于`FlowLayoutPanel`

```
foreach(String file in this._files){
    PictureBox box = new PictureBox();
    box.Height = 50;
    box.Width = 50;
    box.ImageLocation = file;
    box.SizeMode = PictureBoxSizeMode.Zoom;
    box.Click += this.PictureClick;

    this.flowLayoutPanel1.Controls.Add(box);
}

private void PictureClick(object sender, EventArgs e){
    // how do I get the one that has been clicked and set its border color
} 
```

如何获取已单击的并设置其边框颜色？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T18:49:52.857

`sender`是`PictureBox`被点击的：

```
private void PictureClick(object sender, EventArgs e) {
    PictureBox oPictureBox = (PictureBox)sender;
    // add border, do whatever else you want.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:49:27.357

该`sender`参数确实是您的`PictureBox`，向下转换为对象。以这种方式访问​​它：

```
var pictureBox = sender as PictureBox; 
```

在它周围绘制边框并不容易，因为您必须重写`OnPaint`PictureBox 的方法，或者处理`Paint`事件。

您可以使用此类在图像周围绘制黑色细边框。

```
public class CustomBorderPictureBox : PictureBox
{
    public bool BorderDrawn { get; private set; }

    public void ToggleBorder()
    {
        BorderDrawn = !BorderDrawn;
        Invalidate();
    }

    protected override void OnPaint(PaintEventArgs pe)
    {
        base.OnPaint(pe);
        if (BorderDrawn)
            using (var pen = new Pen(Color.Black))
                pe.Graphics.DrawRectangle(pen, 0, 0, Width - 1, Height - 1);
    }
} 
```

# c - 列出linux系统中所有内核任务的最通用方法是什么？

> ID：13978511
> 
> 赞同：3
> 
> 时间：2012-12-20T18:45:31.213
> 
> 标签：c, linux, shell, linux-kernel, kernel-module

我试图找出编写跨平台内核代码/shell脚本以列出dis中的所有内核任务`{(pid/tid , name)}`的最佳方法。`linux`机器。它应该是最普遍的。我尝试使用`ps -T`，但它似乎不准确，并且某些平台在他们的`busybox`. 有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T04:24:26.297

如果您想将用户进程与内核任务区分开来，那么这是之前关于该主题的讨论：[识别内核线程](https://stackoverflow.com/questions/12213445/identifying-kernel-threads/13984231#13984231)

我对这个问题的回答不需要任何工具，它只是读取 /proc//stat 的内容，因此它应该适用于任何发行版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:57:36.470

你可以试试

```
ps -e -o pgrp= -o pid= -o cmd= | sed -ne 's/^ *0 *// p' 
```

尽管它假定所有内核任务都属于进程组 0。

# php - 检查 PHP 会话是否处于活动状态；

> ID：13978513
> 
> 赞同：5
> 
> 时间：2012-12-20T18:45:33.513
> 
> 标签：php, session

基本上我想要实现的是这个，下面的不起作用，但你应该明白。

```
if (session_status() == PHP_SESSION_ACTIVE) {
  show specific icons
}
else
{
  don't show specific icons
} 
```

我究竟做错了什么。如何可靠地检查会话是否在 php 5.4 中启动。我在某处读到这是推荐的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T18:51:28.537

[session_status](http://php.net/session-status)适用于 PHP v5.4 及更高版本，也许这就是原因。

您可以尝试使用[session_id](http://php.net/session_id)：

> session_id() 返回当前会话的会话 ID，如果没有当前会话（不存在当前会话 ID），则返回空字符串 ("")。

正是 PHP 低于 5.4 所需要的！;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:48:06.853

// 你可以创建你的变量并检查它是否存在。

例如

```
session_name('My_SESSION_HUMANS'); // Create a unique instance of your session variables
session_start();
if(!empty($_SESSION['my_var']))
{
   // IF Session exist.
}
else
{
   // Oops no Session ?
   $_SESSION['my_var'] = 'Yeahaaah!!!!';
} 
```

# asp.net-web-api - WebAPI OData 日期时间错误

> ID：13978514
> 
> 赞同：3
> 
> 时间：2012-12-20T18:45:35.980
> 
> 标签：asp.net-web-api, odata

这里问了同样的问题[http://forums.asp.net/post/5243863.aspx](http://forums.asp.net/post/5243863.aspx)但还没有答案。

像 $filter=TimeRequested eq datetime'2012-12-17' OR $filter=TimeRequested eq datetime'2012-12-17T08:36:06' 这样的过滤器查询出错

Microsoft.Data.OData.ODataException：检测到类型不兼容的二元运算符。找到运算符类型“Equal”的操作数类型“Edm.String”和“Edm.DateTime”。

# c# - 单击 jquery 对话框上的链接或按钮下载文件

> ID：13978516
> 
> 赞同：0
> 
> 时间：2012-12-20T18:45:37.520
> 
> 标签：c#, jquery, asp.net, download, jquery-ui-dialog

> **可能重复：**
> [在服务器中创建文件后使用 jQuery 下载文件](https://stackoverflow.com/questions/13954657/download-a-file-using-jquery-after-creating-it-in-the-server)

我有一个包含一些 HTML 内容的 jQueryUI 对话框。在用户进行输入并单击“确定”按钮后，将使用 AJAX 建立对服务器的调用。在引用的静态方法中，会根据用户输入创建一个文件。创建文件后，用户应该能够下载它。我如何实现这一目标？我听说过“在该对话框中创建一个表单，其中操作正在发布到服务器，但我不知道如何执行此操作。

请注意，[此问题](https://stackoverflow.com/questions/13954657/download-a-file-using-jquery-after-creating-it-in-the-server/13958836#13958836)涵盖了同一问题的服务器端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:52:16.060

让您的 AJAX 调用创建文件并将其存储在服务器上的某个位置。在`success`AJAX 调用的处理程序中，将`iframe`页面上的源设置为创建文件的 URL。

# perl - 使用 perl 提取多个 substr 并匹配和替换

> ID：13978519
> 
> 赞同：0
> 
> 时间：2012-12-20T18:45:50.470
> 
> 标签：perl, substr

我需要从一行中提取固定位置的多个子字符串，同时替换另一个位置的空格。

例如，我有一个字符串 '01234567890'。我想提取位置 1、2、6、7、8 的字符，同时如果位置 12、13 是空格，我想用 0101 替换它们。它都是基于位置的。

使用 perl 实现这一目标的最佳方法是什么？

我可以使用 substr 和字符串比较，然后将它们连接在一起，但代码看起来相当笨重......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:22:57.633

我可能会将字符串拆分（或：分解）为单个字符数组：

```
my @chars = split //, $string; # // is special with split 
```

现在我们可以做数组切片：一次提取多个参数。

```
use List::MoreUtils qw(all);

if (all {/\s/} @chars[12, 13]) {
   @chars[12, 13] = (0, 1);
   my @extracted_chars = @chars[1, 2, 6..8];
   # do something with extracted data.
} 
```

然后我们可以把`@chars`后面变成一个字符串，比如

```
$string = join "", @chars; 
```

如果要*删除*某些字符而不是提取它们，则必须`slice`在循环中使用 s ，这是一个丑陋的任务。

### 用漂亮的界面完成子来做这种事情

```
sub extract (%) {
   my ($at, $ws, $ref) = @{{@_}}{qw(at if_whitespace from)};
   $ws //= [];
   my @chars = split //, $$ref;
   if (all {/\s/} @chars[@$ws]) {
      @chars[@$ws] = (0, 1) x int(@$ws / 2 + 1);
      $$ref = join "", @chars;
      return @chars[@$at];
   }
   return +();
}

my $string = "0123456789ab \tef";
my @extracted = extract from => \$string, at => [1,2,6..8], if_whitespace => [12, 13];

say "@extracted";
say $string; 
```

输出：

```
1 2 6 7 8
0123456789ab01ef 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T01:54:58.313

这是两个独立的操作，应该这样编码。这段代码似乎可以满足您的需要。

```
use strict;
use warnings;

my $str = 'abcdefghijab  efghij';

my @extracted = map { substr $str, $_, 1 } 1, 2, 6, 7, 8;
print "@extracted\n";

for (substr $str, 12, 2) {
  $_ = '01' if $_ eq '  ';
}
print $str, "\n"; 
```

**输出**

```
b c g h i
abcdefghijab01efghij 
```

# asp.net - 从 DataTable 中删除空行的方法？

> ID：13978526
> 
> 赞同：2
> 
> 时间：2012-12-20T18:46:35.430
> 
> 标签：asp.net, vb.net, datatable

我解析了一个 Excel 电子表格，并将整个结果作为 DataTable 返回。但是，这个 Excel 电子表格有几个空行，我想从生成的 DataTable 中删除它们。特别是，每个空行都以一个空单元格开始。所以，我知道如果第一个索引处的单元格的值为空，则整行都是空的。请注意，我不能简单地修改 Excel 电子表格，因为我必须准确地处理客户发送给我的内容。基于这些信息，我假设我可以执行以下函数来删除空行：

```
' DataTable dt has already been populated with the data

For Each row As DataRow In dt.Rows
    If dt.Rows.Item(0).ToString = "" Then
        dt.Rows.Remove(row)
    ElseIf dt.Rows.Item(0) Is Nothing Then
        dt.Rows.Remove(row)
    End If
Next 
```

但是，在制定此解决方案后，我收到以下错误：

```
Collection was modified; enumeration operation might not execute. 
```

我现在意识到我无法在访问集合时更改它。我怎样才能解决这个问题？我想知道是否应该使用非空行创建一个新的 DataTable。这是最好的方法还是有更好的选择？

编辑：我也尝试过向后迭代行：

```
For i = dt.Rows.Count() - 1 To 0
    If dt.Rows.Item(i).Item(0).ToString = "" Then
        dt.Rows.RemoveAt(i)
    End If
Next 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T19:02:31.127

使用 枚举集合时不能修改集合`For Each`，但可以使用一个简单的`For`循环。您需要向后循环以避免在删除的行之后跳过该行。

你的测试也是错误的；如果`Item(0)`返回`Nothing`，`Item(0).ToString`则将抛出一个`NullReferenceException`.

我假设这`dt.Rows.Item(0)`是一个错字，应该改为阅读`row.Item(0)`。

```
For i As Integer = dt.Rows.Count - 1 To 0 Step -1
    Dim row As DataRow = dt.Rows(i)
    If row.Item(0) Is Nothing Then
       dt.Rows.Remove(row)
    ElseIf row.Item(0).ToString = "" Then
       dt.Rows.Remove(row)
    End If
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-29T06:53:40.783

Vb.Net 使用 linq

```
 Dtset.Tables(0).AsEnumerable().Where(Function(row) row.ItemArray.All(Function(field) field Is Nothing Or field Is DBNull.Value Or field.Equals(""))).ToList().ForEach(Sub(row) row.Delete())
        Dtset.Tables(0).AcceptChanges() 
```

# php - 使用外键时显示备用列

> ID：13978527
> 
> 赞同：0
> 
> 时间：2012-12-20T18:46:34.463
> 
> 标签：php, mysql, foreign-keys

我有一个关于 PHP、MySql 和外键的问题。我了解外键并在两个表之间建立了如下所述的关系：

假设我有 2 个表：“*车辆*”和“*制造商*”。

*“车辆*”表中的每一行都包含一个manufacturerId 列，该列是与“*制造商*”表相关的外键。*这设置得很好，在 PhpMyAdmin 中，当我在“车辆*”表中插入新行时，manufacturerId 列有一个下拉菜单，manufacturerId 列为选项。非常好。

但是：在我的应用程序中，当然，我不希望用户在添加新车时必须知道（或必须猜测）“福特”或“宝马”的正确数字是多少，我希望他们可以按名称选择制造商。

但是应用程序如何根据manufacturerId 知道制造商名称呢？应用程序如何知道这两个表之间存在关系？我应该在应用程序中对关系进行硬编码吗？我是否应该修改所有查询以在 2 个表之间进行 JOIN？或者每次我想显示制造商下拉列表时硬编码查询以获取制造商列表？

有没有办法让应用程序了解表之间的关系并能够显示来自文本列而不是用作 ID 的 int 列的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:07:14.510

假设您的 2 表结构如下：

```
VEHICLES
id
manufacturerId
vehicleName

MANUFACTURERS
id
manufacturerName 
```

您可以通过像这样查询数据库来为用户创建您的汽车制造商选择菜单：

```
// query the database
$q = 'SELECT id, manufacturerName FROM manufacturers';
$r = mysqli_query($link, $q);

// display a select menu using id and manufacturerName  
echo '<select name="manufacturer">';
while($row = mysqli_fetch_assoc($r)) {
    echo '<option value="'.$row['id'].'">'.$row['manufacturerName'].'</option>';
}
echo '</select>'; 
```

要使用该菜单中的发布数据将车辆和制造商 ID 添加到您的车辆表中：

```
$q = "INSERT INTO vehicles (manufacturerId, vehicleName) VALUES ({$_POST['manufacturer']}, '{$_POST['vehicleName']}')";
mysqli_query($link, $q); 
```

最后，如果您希望在同一查询中选择车辆名称和制造商，您可以像这样连接表：

```
// Select vehicle name and manufacturer for vehicle with id of 1
$q = "SELECT v.vehicleName, m.manufacturerName, v.id AS vehicleId, m.id AS manufacturerId
    FROM vehicles AS v, manufacturers AS m 
    WHERE v.manufacturerID = m.id
    AND v.id = 1";
mysqli_query($link, $q); 
```

我认为这应该以一种或另一种方式回答你所有的问题！

# actionscript-3 - 随机“未定义”错误

> ID：13978532
> 
> 赞同：0
> 
> 时间：2012-12-20T18:46:55.570
> 
> 标签：actionscript-3

我是 ActionScript 3 的初学者，我正在尝试遍历一组 MovieClips 并从中挑选出数百个随机剪辑并将这些实例放在舞台上，但有时代码会产生未定义的错误。我很困惑为什么代码在大多数情况下都运行良好并且从来没有任何编译时错误。

这是我的代码：

```
for(var i:int = 0; i<100;i++)
{

   var rndNum:Number = Math.round(Math.random()*arr.length);
   this.addChild(arr[rndNum]);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:03:01.017

因为您正在四舍五入随机生成的索引，这可能导致索引超出范围异常，那是因为您生成的数字最多为数组的 Length 并且表示数组总长度的数字永远不能成为有效索引该数组，因为索引从 0 开始。

只需更改`Math.round`为`Math.floor`

```
var rndNum:Number = Math.floor(Math.random()*arr.length); 
```

或从 arr 的长度做 -1 ：

```
var rndNum:Number = Math.round(Math.random()*(arr.length-1)); 
```

# c# - WPF DrawingContext 在我的对象后面绘制

> ID：13978536
> 
> 赞同：0
> 
> 时间：2012-12-20T18:47:09.133
> 
> 标签：c#, wpf, drawingcontext

我有一个带有一些图像的画布，并且我也在使用 DrawGeometry 来绘制一个在时间流逝时正在填充的圆圈。

这就是我在 DrawingContext 中绘制圆圈的方式：

```
protected override void OnRender(DrawingContext drawingContext)
{
    base.OnRender(drawingContext);
    MyUtils.RenderProgressClock(drawingContext, clockPosition, 50, gameTime / totalTime);
} 
```

并调用 InvalidateVisual(); 调用它。

但是这样做我的圈子在我的图像后面，我看不到它，我怎么能在它们前面画呢？

我对 WPF 完全陌生，这让我很难过....

这是请求的其他方法代码：

```
 private static PathGeometry GetClockGeometry(Point position, double percentage, double radius)
        {
            const double innerFactor = 0.90;
            double innerRadius = radius * innerFactor;

            PathGeometry pie = new PathGeometry();

            PathFigure pathFigure = new PathFigure();
            pathFigure.StartPoint = new Point(0, -innerRadius);
            pathFigure.IsClosed = true;

            if (percentage > kMaxClockPercentage)
            {
                percentage = kMaxClockPercentage;
            }
            double angle = 360.0 * percentage;

            // Starting Point
            LineSegment inOutLine = new LineSegment(new Point(0, -radius), true);

            // Arc
            ArcSegment outerArc = new ArcSegment();

            outerArc.IsLargeArc = angle >= 180.0;
            outerArc.Point = new Point(Math.Cos((angle - 90) * Math.PI / 180.0) * radius, Math.Sin((angle - 90) * Math.PI / 180.0) * radius);
            outerArc.Size = new Size(radius, radius);
            outerArc.SweepDirection = SweepDirection.Clockwise;

            LineSegment outInLine = new LineSegment(new Point(outerArc.Point.X * innerFactor, outerArc.Point.Y * innerFactor), true);

            ArcSegment innerArc = new ArcSegment();
            innerArc.IsLargeArc = angle >= 180.0;
            innerArc.Point = pathFigure.StartPoint;
            innerArc.Size = new Size(innerRadius, innerRadius);
            innerArc.SweepDirection = SweepDirection.Counterclockwise;

            pathFigure.Segments.Add(inOutLine);
            pathFigure.Segments.Add(outerArc);
            pathFigure.Segments.Add(outInLine);
            pathFigure.Segments.Add(innerArc);

            pie.Transform = new TranslateTransform(position.X, position.Y);
            pie.Figures.Add(pathFigure);

            return pie;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:36:55.323

好的，现在我对发生的事情有了更好的了解，我发现我的初始答案不会直接对您有用。但是，我也看到你有一点问题。

OnRender 工作方式的一般性质意味着您绘制的内容总是会出现在图像的后面，以及您添加到窗口中的其他内容。

除此之外，您将所有这些用于特定功能（进度时钟）的绘图代码放入窗口本身，这个解决方案感觉有点不对劲。

您可能想探索一些替代方案。

一个简单的方法是创建一个 UserControl 来绘制时钟。该 UserControl 可以具有应填充的 % 的 DependencyProperty。您可以在 UserControl 中使用（大致）相同的 OnRender 代码，或者您可以使用其他一些奇特的方式来实现（我确信在所有 XAML 中都有某种方式可以做到这一点，尽管我不知道它在我的脑海中）。然后，您只需像所有其他图像/控件一样将该时钟放入窗口中。

您也可以创建一个 CustomControl，尽管这需要更多关于 WPF 和资源的知识，以及了解它的工作原理。由于您是 WPF 的新手，所以现在可能有点多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-10T08:18:35.620

您需要向我们展示您的圈子是如何添加到画布中的。

WPF 是一个保留的绘图系统，因此控件出现在它的可视化树中的顺序决定了它们的堆叠顺序。`OnRender()`真正的意思`AccumulateDrawingObjects()`是它不直接绘制，它只是创建一组要绘制的对象。

此外，如果对象保持相同大小，则不需要这样做`InvalidateVisual()`，因为它会导致非常昂贵的重新布局。

More efficient ways to re-render are to use a DependencyProperty with `AffectsRender`... Or to create a `DrawingGroup`, add it to the `DrawingContext` during `OnRender()`, then anytime later you can `DrawingGroup.Open()` to change the drawing commands in the `DrawingGroup`.

# ruby - 如何咖喱一个方法？

> ID：13978538
> 
> 赞同：8
> 
> 时间：2012-12-20T18:47:12.403
> 
> 标签：ruby

考虑这段代码

```
def f x, y
  x + y
end

g = lambda(&method(:f)).curry.(1)

g.(2) # => 3 
```

for 的表达`g`太难读了。可以简化吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-10-14T05:05:04.977

如果您使用的是 Ruby 2.2.0 或更高版本，则可以使用[Method#curry](http://www.ruby-doc.org/core-trunk/Method.html#method-i-curry)：

```
def f(x, y)
  x + y
end
g = method(:f).curry[1]
p g[2] # => 3 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-20T18:52:43.717

我认为你能得到的最短（也是最易读的！）是

```
 g = method(:f).to_proc.curry[1]
  g[2] # => 3 
```

# c# - CS0234 - 无法在 ASP.NET 中实例化 C# 类

> ID：13978539
> 
> 赞同：1
> 
> 时间：2012-12-20T18:47:16.600
> 
> 标签：c#, asp.net

*我在标准文件（ Site.Master*、*Web.Config*、*Default.aspx*等）中使用这两个类在 VS2010 和 MonoDevelop 中制作了相同的 ASP.NET C# 项目，并在底部看到了同样的错误（CS0234） .

登录.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using mynamespace;

namespace mynamespace
{
    public partial class Logon 
    {
        public void btnClicked(object sender, EventArgs e)
        {

            //ERROR IS HERE:
        mynamespace.Test session = new mynamespace.Test();

            //Obviously, this doesn't work either:
            Response.Write(session.echoUser());

        }
    }

} 
```

测试.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using mynamespace;

namespace mynamespace
{
    public class Test
    {
        public string echoUser()
        {
            return "foobar";
        }
    }
} 
```

我在两个 IDE 中都收到相同的错误，这是 MonoDevelop 错误：

> 命名空间“mynamespace”中不存在类型或命名空间“Test”（您是否缺少程序集引用？）（CS0234）Logon.cs

基本上，类 Test 拒绝实例化。任何输入表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:50:41.247

如果您还没有这样做，您需要将项目相互参考。我猜你没有智能感知来显示另一个命名空间中的类，对吧？

您可以在项目视图下的右侧（大多数情况下）看到*参考。*您可以右键单击那里并选择*添加参考*。然后您从 pther 项目浏览到二进制文件。（你也可以指出项目本身——我现在没有 VS。）

此外，命名空间使用驼峰式大小写是一种惯例，因此它应该是*MyNameSpace*。

如果这些类在同一个项目中，您可能希望跳过*使用 mynamespace*并通过*Test*而*不是 mynamespace.Test*来引用该类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:21:32.580

如果您在 ASP.Net Web 项目中有该 Test 类，那么您需要将它放在 App_Code 文件夹中，而不仅仅是站点中的任何位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:15:05.303

如果它们都在同一个项目中，请检查两个文件是否都包含在项目中并将“构建操作”属性设置为“编译”。还请检查所有这些命名空间的拼写和大小写是否完全匹配。

# php - 如何从数据库请求中获取多行

> ID：13978543
> 
> 赞同：3
> 
> 时间：2012-12-20T18:47:34.050
> 
> 标签：php, mysql

这就是我到目前为止所拥有的。它调用数据库并接收一条评论和所有与之相关的值，但我想获得具有相同 id 的多条评论。如何设置数组以获取多个评论？

```
function get_comment_by_id($lake_id) {

        global $connection;
        $query = "SELECT * ";
        $query .= "FROM comments ";
        $query .= "WHERE lakeId=" . $lake_id ." ";
        //$query .= "LIMIT 1";
        $result_set = mysql_query($query, $connection);
        confirm_query($result_set);

        // REMEMBER:
        // if no rows are returned, fetch_array will return false
        if ($comment = mysql_fetch_array($result_set)) {
            return $comment;
        } else {
            return NULL;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:48:57.013

你只需要把它放在一个while循环中。代替

```
if ($comment = mysql_fetch_array($result_set)) {
    return $comment;
} else {
    return NULL;
} 
```

做

```
$rows = array();
while($comment = mysqli_fetch_array($result_set))
    $rows[] = $comment;

return $rows; 
```

并且您还需要使用`mysqli_*`函数，因为这些`mysql_*`函数已被弃用。

在调用函数中，您应该检查空数组而不是空值

# javascript - 在 SQL 事务完成之前进行 For 循环

> ID：13978545
> 
> 赞同：2
> 
> 时间：2012-12-20T18:47:47.263
> 
> 标签：javascript, sql, for-loop, webkit

我正在处理的数据库应用程序遇到一些问题。似乎我的 javascript 函数在我的 SQL 事务完成之前继续进行。下面是我所经历的一个非常简化的版本。在实际函数中，我试图在移至 for 循环中的下一个值之前对表做一些工作。它似乎在 for 循环中做所有事情，然后完成 SQL 事务。

这是示例代码：

```
function fillTables(){
    db.transaction(function (tx){
        for(var i=0; i<3; i++){
            console.log('Filling row '+i);
            tx.executeSql(
                        'INSERT INTO Numbers (Value) VALUES (?)',
                        [i],
                        function (){
                            console.log('Inserted Row');    
                        },
                        errorCB);
            console.log('moving on...');
        }
    });
} 
```

我希望看到的控制台日志是：

```
Filling Row 0
Inserted Row
moving on...
Filling Row 1
Inserted Row
moving on... 
Filling Row 2
Inserted Row
moving on... 
```

但是，我得到：

```
Filling row 0 
moving on... 
Filling row 1 
moving on... 
Filling row 2 
moving on... 
Inserted Row 
Inserted Row 
Inserted Row 
```

关于如何实现预期结果的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:54:29.817

`tx.executeSql()`是一个异步函数，并且行为适当。我将为您寻找同步方法并编辑我的回复。

因此，根据我所阅读的内容，该功能仅由于 HTML5 规范而异步。此外，如果您以某种方式同步运行它，它将返回“无效状态”错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:00:57.947

tx.executeSql() 是一个异步函数，在这种情况下，您需要在函数完成后执行递归调用。

```
function fillTables() {
    db.transaction(function (tx){
        var recursiveFunction = function (index, length) {
            if (index < length) {
                console.log('Filling row ' + index);
                tx.executeSql(
                    'INSERT INTO Numbers (Value) VALUES (?)',
                    [index],
                    function (){
                        console.log('Inserted Row');
                        console.log('moving on...');
                        recursiveFunction(++index, length);    
                    },
                    errorCB);
             }
        }

        recursiveFunction(0, 3);
    });
} 
```

# javascript - JavaScript framekiller 和 XSS 漏洞

> ID：13978546
> 
> 赞同：3
> 
> 时间：2012-12-20T18:47:52.163
> 
> 标签：javascript, iframe, xss

所有[已知的](http://en.wikipedia.org/wiki/Framekiller) [javascript framekillers 都](http://css-tricks.com/snippets/javascript/break-out-of-iframe/)容易受到 XSS 的攻击吗？

`window.location`如果是，在突破 iframe 之前进行消毒是否足够？
最好的方法是什么？
您能否举一个可能的 XSS 攻击示例？

谢谢！

**UPD：**我问的原因是因为我收到了一个漏洞扫描警报，说包含的 JS framekiller 代码是由用户控制的`top.location.replace(document.location)`XSS 漏洞。`document.location`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T21:09:56.890

他们的描述是正确的：' *document.location* '、' *window.location* '、' *self.location* '之类的变量（部分）由不受信任的用户控制。这是因为在不可信域和页面位置（'http://non.trusted.domain.com/mypage'）和不可信请求字符串（'http://my.domain'）中选择**（**子）**字符串**.com/? **myrequest** ') 是根据用户的意图形成的，可能并不总是对你有好处。

 ****出了什么问题：这种用户依赖性不一定是 XSS 漏洞。事实上，要形成 XSS，您需要有一些代码有效地*使用*页面输出流中某处不受信任的用户控制的内容。在简单的 framekiller 示例中，`top.location.replace(window.location)`没有 XSS 的危险。

我们可以谈论 XSS 的一个例子是这样的代码

`document.write('<a href="' + document.location + '?newvar=newvalue">Click here</a>')`

用您的代码构造类似 URI`http://test.com/?dummy"<script>alert("Test")</script>"dummy`并替换*document.location*将在受信任网页的上下文中触发不受信任的脚本。由于构建这样的 URI 并将其不转义传递是一项挑战，真正的 XSS 将在一些更复杂的场景中工作，这些场景包括将不可信变量逐字插入语言指令流中，无论是 HTML、CSS、JS、PHP 等。

另一个著名的 XSS 无感知开发示例是[JSON](http://www.json.org)的发明历史。虽然 JSON 非常受欢迎（我也是它的支持者之一），但最初它的目的是作为将 JS 数据存储为纯 JS 格式数据结构片段的“quick-n-dirty”方式。为了“解析” JSON 块，只需对它们进行*eval()*就足够了。幸运的是，人们很快就意识到这整个想法有多么有缺陷，所以现在任何头脑清醒的知识渊博的开发人员都会使用适当的安全 JSON 解析器来代替。****

# jquery - 使用 JQuery 动画和旋转页面，

> ID：13978549
> 
> 赞同：1
> 
> 时间：2012-12-20T18:48:01.523
> 
> 标签：jquery, loops, jquery-animate, slideshow, settimeout

我正在为网站创建滑动/动画页面模板。

默认情况下，我在用户屏幕上显示 3 页。在左侧，我们可以看到上一页的 10%。在屏幕中央，我正在显示当前页面，在右侧，我们可以看到 10% 的下一页。

在这个网站上，有一个顶部菜单允许我们选择任何项目并在页面之间导航。每个项目都链接到本网站的 5 个当前页面之一，并显示相应的页面标题。

当我单击顶部菜单的一项时，我将向左或向右滑动/动画页面，直到我设置并到达链接到所选菜单项的正确页面。

这是“myLoopright”函数，我可以在其中多次调用 sliddingright 函数。

```
 function myLoopright () 
        {          
            //  create a loop function
            setTimeout(function () 
            {   
                sliddingright(page_id_target_right,previous_right_old,previous_right,next_right,pages_numbers,loop);
                loopcount++;    //  increment the counter

                if (loopcount <= (difference_pages-1)) 
                {   
                   myLoopright();       //  ..  again which will trigger another 
                }                        
            }, 1100) //  ..  setTimeout()
        } // closing myLoop function 
```

这是向右滑动的功能

```
function sliddingright(page_id_target_right,previous_right_old,previous_right,next_right,pages_numbers,loop)
{

        duration=1000;
        //Update top Menu DOM items
        $('ul#navigation #'+page_id_target_right).addClass('active');
        $('ul#navigation #'+next_right).addClass('next');
        $('ul#navigation #'+pages_numbers).addClass('previous');

         //Update DOM pages                     
            previous_right_old=parseInt(pages_numbers-1);           
            // PREVIOUS TO HIDDEN
            $('#content .'+previous_right_old).css({ 'left' : '-73%','background-color' : '#EAEAEA'}).animate({'left' : '-151%'}, duration, easing, function(){$('#content .'+previous_right_old).addClass('hidden')});
            // ACTIVE TO PREVIOUS           
            $('#content .'+pages_numbers).css({ 'margin' : '0 6%', 'left' : '5%', 'right' : '5%'}).animate({'left' : '-73%', 'margin-right' : '0%', 'margin-left' : '0%', 'backgroundColor' : '#EFF0F1' }, duration, easing, function(){$('#content .'+pages_numbers).removeClass('hidden').addClass('previous')});                     
            // NEXT TO ACTIVE           
            $('#content .'+page_id_target_right).css({ 'left' : '95%','background-color' : '#EAEAEA'}).animate({'left' : '5%', 'margin-right' : '6%', 'margin-left' : '6%', 'backgroundColor' : '#FFFFFF' }, duration, easing, function(){$('#content .'+page_id_target_right).addClass('active').removeClass('hidden');});
            // HIDDEN TO NEXT
            $('#content .'+next_right).removeClass('hidden').addClass('next').appendTo('#content').css({ 'left' : '173%', 'backgroundColor' : '#EFF0F1'}).animate({'left' : '95%'}, duration);
    } 
```

这段代码可以工作，但是，当我必须滑动很多页面时，滑动效果并不流畅。

所以我想在sliddingright函数的所有动画完成后调用“myLoopright”函数并删除setTimeout函数。

要查看我的开发代码，你可以去这里：http: [//jsfiddle.net/K2xZB/89/](http://jsfiddle.net/K2xZB/89/)

干杯

# java - AWT 中的抽象是什么

> ID：13978550
> 
> 赞同：2
> 
> 时间：2012-12-20T18:48:05.447
> 
> 标签：java

有人可以解释一下 Abstract Window Toolkit 中的 Abstract 是什么意思吗？

它与抽象（不完整的定义）有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:57:22.580

正如 Jean Sebastien 在[他的论坛帖子](http://www.coderanch.com/t/343687/GUI/java/AWT-abstract)中所说：

> 它是实际显示组件的底层系统（windows、linux、mac os...）的抽象。
> 
> 当您使用 AWT 组件（例如 Button）时，Java 使用本机库来显示按钮（想想类似“Windows.displayButton(myButton)”或“Linux.displayButton(myButton)”之类的东西）。
> 
> 底层系统为“抽象”AWT 组件提供“具体”实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T18:52:55.500

它是抽象的，因为它对底层的本机用户界面具有一定程度的抽象。例如，创建 AWT 复选框将导致 AWT 直接调用创建复选框的底层本机子例程。

它是“不完整的”，因为用户不需要使用诸如Windows 平台上的[CreateWindowEx之类的调用在本机级别的操作系统上创建组件。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632680%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:49:42.993

它与 Abstract 无关（定义不完整）。它是抽象的，它与操作系统或特定的窗口系统无关。

# python - 是否可以在 SQLAlchemy 中创建列，该列将在上次插入/更新时自动填充时间？

> ID：13978554
> 
> 赞同：38
> 
> 时间：2012-12-20T18:48:08.720
> 
> 标签：python, python-3.x, sqlalchemy

是否可以在 SQLAlchemy 中创建列，该列将在上次插入/更新时自动填充时间？

我创建了模型，继承自基类

```
class Base(object):
    def __tablename__(self):
        return self.__name__.lower()
    id = Column(Integer, primary_key=True)
    last_time = Column(TIMESTAMP, server_default=func.now())

Base = declarative_base(cls=Base)

class EntityModel(Base):
    __tablename__ = 'entities'
    settlement_id = Column(Integer, ForeignKey('settlements.id'), nullable=False)
    type = Column(String(20), nullable=False)
    level = Column(Integer, nullable=False, default=0)
    energy = Column(Float, nullable=False, default=0)
    position_x = Column(Integer, default=0)
    position_y = Column(Integer, default=0)

    def __repr__(self):
        return "<Entity('%s')>" % (self.type) 
```

每次更新 EntityModel 时，我都希望`last_time`在`system function.now()`. 我可以使用触发器在数据库级别执行此操作，但如果可能的话，我宁愿在应用程序级别执行此操作。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-12-20T19:02:54.020

在 Base 类中，在最后一条语句中添加 onupdate，如下所示：

```
from sqlalchemy.sql import func

last_time = Column(TIMESTAMP, server_default=func.now(), onupdate=func.current_timestamp()) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-20T19:43:02.343

如果你使用 MySQL，我相信你只能有一个自动更新的 datetime 列，所以我们使用 SQLAlchemy 的事件触发器来代替。

您只需将侦听器附加到“before_insert”和“before_update”挂钩并根据需要进行更新：

```
from sqlalchemy import event

@event.listen(YourModel, 'before_insert')
def update_created_modified_on_create_listener(mapper, connection, target):
  """ Event listener that runs before a record is updated, and sets the create/modified field accordingly."""
  target.created = datetime.utcnow()
  target.modified = datetime.utcnow()

@event.listen(YourModel, 'before_update')
def update_modified_on_update_listener(mapper, connection, target):
  """ Event listener that runs before a record is updated, and sets the modified field accordingly."""
  # it's okay if this field doesn't exist - SQLAlchemy will silently ignore it.
  target.modified = datetime.utcnow() 
```

我知道没有人会记得将它添加到新模型中，所以我试图变得聪明并为他们添加它。

我们所有的模型都继承自一个我们巧妙地称为“DatabaseModel”的基础对象。我们检查谁继承了这个对象，并动态地将触发器添加到所有这些对象中。

如果模型没有 created 或 modified 字段也没关系 - SQLAlchemy 似乎默默地忽略它。

```
class DatabaseModel(db.Model):
  __abstract__ = True

  #...other stuff...

  @classmethod
  def _all_subclasses(cls):
    """ Get all subclasses of cls, descending. So, if A is a subclass of B is a subclass of cls, this
    will include A and B.
    (Does not include cls) """
    children = cls.__subclasses__()
    result = []
    while children:
      next = children.pop()
      subclasses = next.__subclasses__()
      result.append(next)
      for subclass in subclasses:
        children.append(subclass)
    return result

def update_created_modified_on_create_listener(mapper, connection, target):
  """ Event listener that runs before a record is updated, and sets the create/modified field accordingly."""
  # it's okay if one of these fields doesn't exist - SQLAlchemy will silently ignore it.
  target.created = datetime.utcnow()
  target.modified = datetime.utcnow()

def update_modified_on_update_listener(mapper, connection, target):
  """ Event listener that runs before a record is updated, and sets the modified field accordingly."""
  # it's okay if this field doesn't exist - SQLAlchemy will silently ignore it.
  target.modified = datetime.utcnow()

for cls in DatabaseModel._all_subclasses():
  event.listen(cls, 'before_insert',  update_created_modified_on_create_listener)
  event.listen(cls, 'before_update',  update_modified_on_update_listener) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-12T09:58:44.510

毫无价值的是，如果您遵循 Rachel Sanders 的建议，您绝对应该这样做：

```
if object_session(target).is_modified(target, include_collections=False):
    target.modified = datetime.utcnow() 
```

作为 update_modified_on_update_listener() 事件侦听器的一部分，否则您将执行大量冗余数据库更新。查看“ before_update ”部分下的[http://docs.sqlalchemy.org/en/latest/orm/events.html#mapper-events以获取更多信息。](http://docs.sqlalchemy.org/en/latest/orm/events.html#mapper-events)

# python - Python：计算 pi 时“long int too large to convert to float”

> ID：13978556
> 
> 赞同：4
> 
> 时间：2012-12-20T18:48:13.137
> 
> 标签：python, python-3.x, pi, python-3.3

使用使用 Gauss-Legendre 算法计算 pi 的 python 脚本时出现此错误。在得到这个之前，您最多只能使用 1024 次迭代：

```
 C:\Users\myUsernameHere>python Desktop/piWriter.py
    End iteration: 1025
    Traceback (most recent call last):
      File "Desktop/piWriter.py", line 15, in <module>
        vars()['t' + str(sub)] = vars()['t' + str(i)] - vars()['p' + str(i)] * math.
    pow((vars()['a' + str(i)] - vars()['a' + str(sub)]), 2)
    OverflowError: long int too large to convert to float 
```

这是我的代码：

```
import math

a0 = 1
b0 = 1/math.sqrt(2)
t0 = .25
p0 = 1

finalIter = input('End iteration: ')
finalIter = int(finalIter)

for i in range(0, finalIter):
        sub = i + 1
        vars()['a' + str(sub)] = (vars()['a' + str(i)] + vars()['b' + str(i)])/ 2
        vars()['b' + str(sub)] = math.sqrt((vars()['a' + str(i)] * vars()['b' + str(i)]))
        vars()['t' + str(sub)] = vars()['t' + str(i)] - vars()['p' + str(i)] * math.pow((vars()['a' + str(i)] - vars()['a' + str(sub)]), 2)
        vars()['p' + str(sub)] = 2 * vars()['p' + str(i)]
        n = i

pi = math.pow((vars()['a' + str(n)] + vars()['b' + str(n)]), 2) / (4 * vars()['t' + str(n)])
print(pi) 
```

理想情况下，我希望能够插入一个非常大的数字作为迭代值，稍后再回来查看结果。

任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:06:24.467

浮点数只能表示最大为 sys.float_info.max 或 1.7976931348623157e+308 的数字。一旦你有一个超过 308 位（或更多）的 int，你就会被卡住。当 p1024 有 309 位时，您的迭代失败：

```
179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137216L 
```

您必须为 pi 找到一种不同的算法，它不需要这么大的值。

实际上，您必须小心周围的浮点数，因为它们只是近似值。如果你修改你的程序来打印 pi 的逐次逼近，它看起来像这样：

```
2.914213562373094923430016933707520365715026855468750000000000
3.140579250522168575088244324433617293834686279296875000000000
3.141592646213542838751209274050779640674591064453125000000000
3.141592653589794004176383168669417500495910644531250000000000
3.141592653589794004176383168669417500495910644531250000000000
3.141592653589794004176383168669417500495910644531250000000000
3.141592653589794004176383168669417500495910644531250000000000 
```

换句话说，仅在 4 次迭代之后，您的近似值就不再变得更好了。这是由于您使用的浮点数不准确，可能以`1/math.sqrt(2)`. 计算 pi 的许多位需要非常仔细地理解数字表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:26:07.493

如上一个答案所述，该`float`类型具有数字大小的上限。在典型实现中，`sys.float_info.max`是 1.7976931348623157e+308，它反映了 64 位浮点数中指数字段使用 10 位加号。（注意 1024*math.log(2)/math.log(10) 大约是 308.2547155599。）

[您可以使用Decimal number 类型](http://docs.python.org/2/library/decimal.html)在指数大小上再增加半个十进制数。这是一个示例（从 ipython 解释器会话中截取）：

```
In [48]: import decimal, math    
In [49]: g=decimal.Decimal('1e12345')    
In [50]: g.sqrt()
Out[50]: Decimal('3.162277660168379331998893544E+6172')
In [51]: math.sqrt(g)
Out[51]: inf 
```

这说明小数的`sqrt()`函数在比 更大的数字时正确执行`math.sqrt()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:25:21.250

如上所述，获得大量数字会很棘手，但是看着所有这些数字`vars`会伤害我的眼睛。因此，在 (1) 将您的使用替换为`vars`字典和 (2) 使用`**`而不是数学函数之后，这是您的代码版本：

```
a, b, t, p = {}, {}, {}, {}
a[0] = 1
b[0] = 2**-0.5
t[0] = 0.25
p[0] = 1

finalIter = 4

for i in range(finalIter):
    sub = i + 1
    a[sub] = (a[i] + b[i]) / 2
    b[sub] = (a[i] * b[i])**0.5
    t[sub] = t[i] - p[i] * (a[i] - a[sub])**2
    p[sub] = 2 * p[i]
    n = i

pi_approx = (a[n] + b[n])**2 / (4 * t[n]) 
```

`vars`我没有用来玩游戏，而是使用[字典](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)来存储值（那里有官方 Python 教程的链接），这使您的代码更具可读性。您现在甚至可以看到一两个优化。

如评论中所述，您实际上不需要存储所有值，只需要存储最后一个值，但我认为更重要的是，您了解如何在不动态创建变量的情况下做事。除了 a `dict`，您也可以简单地将值附加到 a `list`，但列表始终是零索引的，您不能轻易“跳过”并在任意索引处设置值。在使用算法时，这有时会让人感到困惑，所以让我们从简单的开始。

无论如何，上面给了我

```
>>> print(pi_approx)
3.141592653589794
>>> print(pi_approx-math.pi)
8.881784197001252e-16 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T18:11:19.310

一个简单的解决方案是安装和使用现在支持 Python 3 的任意精度[`mpmath`](http://mpmath.org)模块。但是，由于我完全同意 DSM 的观点，即您使用动态`vars()`创建变量是实现算法的一种不受欢迎的方式，因此我基于我对[他重写](https://stackoverflow.com/a/13980699/355230)您的代码的回答并[微不足道地]对其进行了修改以用于进行`mpmath`计算。

如果您坚持使用`vars()`，您可能会做类似的事情——尽管我怀疑它可能会更难，结果肯定更难阅读、理解和修改。

```
from mpmath import mpf  # arbitrary-precision float type

a, b, t, p = {}, {}, {}, {}
a[0] = mpf(1)
b[0] = mpf(2**-0.5)
t[0] = mpf(0.25)
p[0] = mpf(1)

finalIter = 10000

for i in range(finalIter):
    sub = i + 1
    a[sub] = (a[i] + b[i]) / 2
    b[sub] = (a[i] * b[i])**0.5
    t[sub] = t[i] - p[i] * (a[i] - a[sub])**2
    p[sub] = 2 * p[i]
    n = i

pi_approx = (a[n] + b[n])**2 / (4 * t[n])
print(pi_approx)  # 3.14159265358979 
```

# android - 没有活动的广播接收器

> ID：13978559
> 
> 赞同：0
> 
> 时间：2012-12-20T18:48:25.870
> 
> 标签：android

我有一个在启动完成后启动的 Activity，Autostart 类调用一个 Activity（通知）。我需要在没有活动的情况下启动 Notify.class。我将如何更改通知代码？谢谢！

```
AutoStart

public class AutoStart extends BroadcastReceiver{

@Override
public void onReceive(Context context, Intent intent) {
        Intent i = new Intent(context, Notify.class);  
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(i);  
}

Notify

public class Notify extends Activity{

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

Calendar cal1 = Calendar.getInstance();
cal1.set(Calendar.HOUR_OF_DAY, 05);
cal1.set(Calendar.MINUTE, 45);
cal1.set(Calendar.SECOND, 00);

Calendar cal2 = Calendar.getInstance();
cal2.set(Calendar.HOUR_OF_DAY, 17);
cal2.set(Calendar.MINUTE, 30);
cal2.set(Calendar.SECOND, 00);

Calendar now = Calendar.getInstance();
if(now.after(cal1))
    cal1.add(Calendar.HOUR_OF_DAY, 24);
if(now.after(cal2))
    cal2.add(Calendar.HOUR_OF_DAY, 24);

Intent intent = new Intent(this, AlarmReceiver.class);
PendingIntent morningAlarm = PendingIntent.getBroadcast(getApplicationContext(), 0, intent, 0);
PendingIntent eveningAlarm = PendingIntent.getBroadcast(getApplicationContext(), 1, intent, 0);

AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal2.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, eveningAlarm); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:28:38.383

您不需要 Activity 来发出通知，但您确实需要一个 Android 组件。什么是开机启动？无论哪个类都可以发出通知。

# php - 从第一个获取内容 ...

> ID：13978562
> 
> 赞同：0
> 
> 时间：2012-12-20T18:48:31.797
> 
> 标签：php, regex

我在数据库中有字段`<p>intro content</p><p>rest of content....</p>`

我想参加介绍内容的部分意味着首先之间的内容`<p>...</p>`

之后，我想`<p>intro content</p>`从内容部分中删除介绍内容。

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:51:59.143

如果你想对 HTML 进行任何类型的解析，[你真的不应该使用 regex](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。但是，如果您想要的`<p>`只是字符串中第一个标签的文本内容，那么您的问题就相当简单了：

```
preg_match('@<p>.*?</p>@', $string, $matches); 
```

# mysql - 将 AUTO_INCREMENT 列添加到 Rails 模型时出错 - MySQL

> ID：13978565
> 
> 赞同：0
> 
> 时间：2012-12-20T18:49:00.863
> 
> 标签：mysql, ruby-on-rails, ruby, ubuntu

我目前有一个现有模型 Document，它需要一个新的自动递增列。不幸的是，我在迁移过程中遇到了错误。

我采取的步骤是：

`ruby script/generate migration add_index_column_to_Document`

`.rb`正确生成了标题为空的

`20121220182429_add_index_column_to_document.rb`

接下来，我将文件编辑为如下所示：

```
class AddIndexColumnToDocument < ActiveRecord::Migration
  def self.up
    execute 'ALTER TABLE documents ADD index INT NOT NULL AUTO_INCREMENT PRIMARY KEY'
  end

  def self.down
    execute 'ALTER TABLE documents DROP index'
  end
end 
```

然后我执行迁移`rake db:migrate`并得到以下错误：

```
==  AddIndexColumnToDocument: migrating =======================================
-- execute("ALTER TABLE documents ADD index INT NOT NULL AUTO_INCREMENT PRIMARY KEY")
rake aborted!
An error has occurred, all later migrations canceled:

Mysql::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INT NOT NULL AUTO_INCREMENT PRIMARY KEY' at line 1: ALTER TABLE documents ADD index INT NOT NULL AUTO_INCREMENT PRIMARY KEY 
```

MySQL版本，根据`apt-cache show mysql-server`是：**5.5.28-0ubuntu0.12.04.2**

对我来说不幸的是，我的 SQL 代码与我可以在网上找到的所有示例相匹配，所以我不确定它为什么不起作用。提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T18:58:25.750

尝试转义保留的单词“index”。更好的是，让 Rails 为您完成：

```
class AddIndexColumnToDocument < ActiveRecord::Migration
  def change
    add_column :documents, :index, :primary_key
  end
end 
```

# php - time() 根据服务器返回不同的时间戳

> ID：13978567
> 
> 赞同：3
> 
> 时间：2012-12-20T18:49:15.643
> 
> 标签：php, unix, timestamp, unix-timestamp

我现在搜索了好几个小时，似乎以前没有人遇到过这个问题。

我在两台服务器上运行一个脚本，将当前时间戳写入数据库。两者都有相同的操作系统、软件……和相同的时区。

现在我发现，一些时间戳和当前 time() 之间的差异是一个负数（是的，计算是正确的`time() - $older_timestamp`：）

我在两台服务器上都转储了 time()，结果：相差正好一小时。一探究竟：

*   [服务器 #1 上的 time()：-1 小时](http://100prorealty.de/unixtime.php)
*   [服务器 #2 上的 time()：正确的时间戳](http://brainedia1.de/maklerprojekt/unixtime.php)

由于 time() 应该始终基于 UTC，我无法解释这是如何发生的。

有人有什么想法吗？

来自亚琛的问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T18:54:03.720

显然服务器一和服务器二设置为不同的时间。检查**BIOS**和**服务器的操作系统**时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:09:50.040

为了增加欢乐，我给你另一个选择。

操作系统的时区可能设置不正确。如果两个时钟显示相同的时间，但一个服务器认为它在伦敦，而另一个认为它在亚琛，则从系统调用返回的 UTC 时间将相差一小时。

但是，如果您要安装，则说`NTPD`这一切都不会发生。（通常）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:58:37.060

`php.ini`这可能是由于Apache中的时区设置不正确造成的。检查`php.ini`文件`date.timezone =`并将其更改为您的时区。可以在此处找到 PHP 时区列表：http: [//php.net/manual/en/timezones.php](http://php.net/manual/en/timezones.php)

例如：

```
date.timezone = 'America/Chicago' 
```

[`ini_set`](http://us1.php.net/manual/en/function.ini-set.php)如果您不能`php.ini`直接编辑文件，您也可以使用。

```
ini_set('date.timezone', 'America/Chicago'); 
```

# deployment - 可以将大型二进制文件放入 RabbitMQ 队列

> ID：13978576
> 
> 赞同：2
> 
> 时间：2012-12-20T18:49:43.183
> 
> 标签：deployment, rabbitmq, setup-deployment, updatemodel

我正在尝试设计一个多服务器更新部署系统，我在想大二进制字符串是否有任何限制。例如，如果我将一个 100MB 文件中的字符串放入队列中？

谢谢，
佩德罗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T19:18:30.713

我已经做到了，我不一定会推荐它。将文件存储在 GridFS (MongoDB) 之类的文件中，然后在 RabbitMQ 消息中引用 _id 可能会更好。然后，您可以使用 Mongo 的界面将文件拉到消费者上，并在完成后将其删除。

我在 GridFS 中运行了大约 20M 个对象，并且它坚如磐石。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T19:10:37.543

搜索“ [RabbitMQ 大文件](https://www.google.com/#hl=en&tbo=d&output=search&sclient=psy-ab&q=rabbitmq+large+files&oq=rabbitm&gs_l=hp.3.0.35i39j0i20j0l2.2416.4859.0.5803.9.8.1.0.0.0.203.998.3j4j1.8.0.les;..0.0...1c.1.sqp7rTPUVDE&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.1355534169,d.dmQ&fp=6eb1946313ccd7d2&bpcl=40096503&biw=1280&bih=899)”发现了大量关于该主题的建议。

标准的反应似乎是理论上它应该能够处理它，但您可能会发现您的经纪人变得没有响应。

如果您**拥有队列的两端**（发送方/接收方），那么您可以考虑将数据分块为更易于管理的数据“块”。例如 100KB 块。这对您的经纪人会更好。上面的搜索命中之一有一个链接，指向一个用 ruby​​ 编写的“流”发件人，该发件人进行了分块。

如果您**不拥有队列的两端，请**考虑使用“[声明检查](http://eaipatterns.com/StoreInLibrary.html)”的形式，其中您的消息包含更适合它的存储位置中的大 blob/文件/数据的位置。

这可能是非常有趣的背景信息：[http ://rabbitmq.1065348.n5.nabble.com/Can-RabbitMQ-handle-big-messages-tt566.html#a569](http://rabbitmq.1065348.n5.nabble.com/Can-RabbitMQ-handle-big-messages-tt566.html#a569)

# java - Netbeans构建有时会失败

> ID：13978589
> 
> 赞同：1
> 
> 时间：2012-12-20T18:50:19.080
> 
> 标签：java, netbeans, ant

自 2009 年以来，我一直是 NetBeans 用户，但现在我遇到了一些我无法解释的问题。我的项目依赖于其他一些项目，它们也依赖于其他一些项目（这是一件大事），在清理和构建时，有时我会得到这样的结果：

[http://pastebin.com/gigXVLsc](http://pastebin.com/gigXVLsc)

我没有打开任何可以阻止此删除的内容。此外，如果我再次单击“清理并构建”（就在此失败之后），我会设法执行该操作。

[http://pastebin.com/mzuvqM0R](http://pastebin.com/mzuvqM0R)

我不知道是什么原因造成的，也许我应该删除所有内容并重新链接所有项目？

我在使用 Netbeans 7.2 的 Windows 8 64 位下

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T22:01:18.057

自 6 及更高版本的最新版本以来，我们一直在使用 NetBeans 遇到此问题。

经过大量的搜索和阅读，我添加`-J-Dorg.netbeans.modules.masterfs.watcher.disable=true`到`netbeans_default_options`了`etc/netbeans.cfg`NetBeans 安装文件夹中的 。

虽然这并没有让我完全摆脱这个问题，但它大大减少了这个问题。

*   转到您的 Netbeans 安装位置，打开`netbeans.cfg`您的`etc`文件夹。
*   找到`netbeans_default_options`（复制退出选项并在行首添加一个`#`以将其注释掉`
*   添加`-J-Dorg.netbeans.modules.masterfs.watcher.disable=true`到行尾（确保它在引号内）
*   重新启动 NetBeans...

希望这有助于减少问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:58:12.717

清理服务器时似乎正在运行，并且不允许您删除某些 .jar 文件，或者以某种方式占用了这些 jar 文件

# c# - 如何修复编码，当它应该是常规空格时，我得到 63 的 ascii 值

> ID：13978590
> 
> 赞同：0
> 
> 时间：2012-12-20T18:50:19.373
> 
> 标签：c#, encoding

在我的 c# 代码中，我从 pdf 中提取文本，但是它返回的文本有一些奇怪的字符，如果我在知道 pdf 文档中有文本“CLE action”时搜索“CLE action”，它给出我是假的，但是我发现提取文本后，两个单词之间的空格的ascii字节值为63...

有没有快速修复文本编码的方法？

目前我正在使用这种方法，但我认为它很慢并且只适用于那个角色。有没有适用于所有角色的快速方法？

```
 public static string fix_encoding(string src)
    {
        StringWriter return_str = new StringWriter();
        byte[] byte_array = Encoding.ASCII.GetBytes(src.Substring(0, src.Length));
        int len = byte_array.Length;
        byte byt;
        for(var i=0; i<len; i+=1)
        {
            byt = byte_array[i];
            if (byt == 63)
            {
                return_str.Write(" ");
            }
            else
            {
                return_str.Write(Encoding.ASCII.GetString(byte_array, i, 1));
            }
        }
        return return_str.ToString();
    } 
```

这就是我调用此方法的方式：

```
 StringWriter output = new StringWriter();
                output.WriteLine(PdfTextExtractor.GetTextFromPage(reader, page, new SimpleTextExtractionStrategy()));
                currentText = fix_encoding(output.ToString()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T20:47:39.233

您从 pdf 文件中提取的空格可能不是真正的空格（“”），而是在 unicode 中定义的其他类型的空格。例如“em 空格”或“不间断空格”，请参阅[此列表](http://www.cs.tut.fi/~jkorpela/chars/spaces.html)或[此处](https://stackoverflow.com/a/1627502/33499)以获取概述。

如果提取的文本包含这样的空格，而您在文本中搜索一个普通空格，您将找不到它，因为它并不相同。

您的 fix_encoding 函数[将字符串转换为 ASCII](http://msdn.microsoft.com/en-us/library/system.text.encoding.ascii.aspx)。ASCII 中不存在所有不寻常的空格。默认情况下，非 ASCII 字符被[转换为问号](http://msdn.microsoft.com/en-us/library/system.text.encoding.decoderfallback.aspx)。因此，在您的 fix_encoding 函数中，您会看到一个问号，即使原始文本具有不同的字符。

这意味着在您的 fix_encoding 函数中，您不应转换为 ASCII，而应将不寻常的空格替换为正常空格。以下函数将转换所有非 ASCII 字符，但您也可以使用[Char.IsWhiteSpace](http://msdn.microsoft.com/en-us/library/1x308yk8.aspx)来确定用普通空格替换哪些字符。

```
public static string remove_non_ascii(string src)
{
    return Regex.Replace(src, @"[^\u0000-\u007F]", " ");
} 
```

# c - 如何用C编程检查文件中是否已经存在ID

> ID：13978594
> 
> 赞同：0
> 
> 时间：2012-12-20T18:51:03.397
> 
> 标签：c, file, validation, search

我在下面有这个编码（仅发布客户管理）。

这是一个数据库，每次通过时我都会在其中添加一个客户。现在我需要检查作为客户端 ID 的 c.ID 是否存在。

我尝试做一个名为 searchID 的方法，如果找到它则返回 1，如果找不到则返回 -1。问题是当我尝试运行该程序时，该程序实际上挂在那里。无论我按 23 还是“ENTER”都没有任何反应，我需要使用 CTRL + C 退出它；

这就是它的工作原理：

当我添加一个客户（这是一个结构）时，它会保存到文件中，但我首先需要检查数据库中是否存在该 ID，否则我需要要求用户输入另一个 ID 或返回主菜单

请问有什么建议吗？？谢谢你

```
#include<io.h>
#include<fcntl.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <ctype.h>
#include "..\Headers\common.h"
#include "..\Headers\customerManagement.h"

static FILE *cfp;
static customer c;
#define STRUCTSIZE sizeof (customer)

/** This is the Customers's Main Menu in which the various sections can be
 *  accessed from here
 */
boolean  customerMainMenu()
{

    int optionC;
    clrscr();

    copyright();

    printf ("\n\n\n\n\t\t    ************* Customer's Main Menu *************\n \n \n");

    printf ("Press [1] to add a new Customer\n");
    printf ("Press [2] to edit a Customer\n");
    printf ("Press [3] to list all Customers\n");
    printf ("Press [4] to Show a Customer's last Order\n");
    printf ("Press [5] to go back to Main Menu\n\n\n");

    if (scanf ("%d",&optionC) == 1)
    {
        switch (optionC)
        {

        case 1:
        {
            clrscr();
            getchar();
            addCustomer();
            break;
        }
        case 2:
        {
            printf ("Edit a Customer\n");
            break;
        }

        case 3:
        {
            clrscr();
            listCustomers();
            getchar();
            while (getchar()!='\n')
            {

            }
            break;
        }
        case 4:
        {
            printf ("Customer's Last Order\n");
            break;
        }
        case 5:
        {
            system ("PAUSE");
            break;
        }
        default:
        {
            if (optionC != 1 || optionC != 2 || optionC != 3 || optionC != 4 || optionC !=5)
            {
                clrscr();
                printf ("Invalid option!\n");
                system ("PAUSE");
                customerMainMenu();
            }
            break;
        }
        }
    }
    return TRUE;

}

/**
 *  This following method will append a customer to the
 *  database at the end of the file
 *
 *  */

void addCustomer ()
{
    char ch;
    copyright();

    printf ("\n\n\n\n\t\t    ************* Add Client **********\n \n \n");

    if ((cfp = fopen ("customers.dat","a+b")) == NULL)
    {
        fputs("Can't open customers.dat file\n",stderr);
    }

    printf ("\tThis will add another customer to the the database\n");
    printf ("\tPress 'Y' to confirm or 'N' to return to the Client Main Menu\n\tWITHOUT adding a customer\n");
    ch = getchar();

    if (ch == 'n' || ch == 'N')
    {
        customerMainMenu();
    }
    else if (ch == 'y' || ch == 'Y')
    {

        clrscr();
        printf ("\n\n\n\n\t\t    ************* Add Client **********\n \n \n");
        printf ("Please enter Name:\n");
        while (scanf ("%s", c.name) == 0 || cCheck(c.name,100) == FALSE);
        {

        }

        printf ("Please Enter Surname: \n");
        while (scanf ("%s",c.surname) == 0 && cCheck (c.surname,100) == FALSE);
        {

        }

        printf ("Please Enter ID Card, [NOTE! Only numbers are allowed!]\n");
        int cID;
        cID = 0;
        while (scanf ("%d",&cID)==0)
        {
            printf ("Only Numbers are allowed!\n");
            while (getchar() != '\n')
            {
            }
        }

        if (searchID(cID) == 1)
        {
            printf ("This ID already exists. Client already exists!\n");
            printf ("Do you want to input another ID or return to Main Menu?\n");
            printf ("Press 'Y' if you enter another ID, press any other key to return to Main Menu\n:");

            ch = getchar();
            if (ch == 'y' || ch == 'Y')
            {
                printf ("Enter another ID:\n");
                while (scanf ("%d",&cID)==0)
                    {
                        printf ("Only Numbers are allowed!\n");
                        while (getchar() != '\n')
                        {
                        }
                    }
                searchID(cID);
            }
            else if (searchID(cID) == -1)
            {
                cID = c.ID;
                getchar();
            }

        }

        while (getchar()!='\n')
        {

        }

        printf ("Please Enter Address:\n");
        gets(c.address);

        fwrite (&c,STRUCTSIZE, 1, cfp);

        printf ("For Testing purposes:\n");
        printf (" %s\n %s\n %s\n %d\n", c.name, c.surname, c.address, c.ID);
        askAnother();

    }
    else
    {
        printf ("\nInvalid choice! Either Y or N is accepted\n");
        system ("PAUSE");
        getchar();
        addCustomer();
    }
}

void listCustomers()
{

    if ((cfp = fopen ("customers.dat","rb")) == NULL)
    {
        fputs("Can't open customers.dat file\n",stderr);
        printf ("Returning to Customer Main Menu");
        system ("PAUSE");
        customerMainMenu();
    }

    rewind (cfp);

    while (fread (&c,STRUCTSIZE,1,cfp)==1)
    {
        printf ("Customer: %s %s ID: %d\n", c.surname, c.name, c.ID);
    }
    fclose (cfp);
    //  system ("PAUSE");

}

void askAnother()
{
    printf ("Do you want to add another Customer?\n");
    printf ("Enter 'Y' for yes and 'N' to return to the Main Menu\n");

    char input;
    input = getchar();

    if (input == 'Y' || input == 'y')
    {
        getchar();
        addCustomer();
    }
    else if (input == 'N'|| input == 'n')
    {

        fclose (cfp);
        customerMainMenu();

    }
    else
    {
        printf ("Invalid Option! Only Y or N are allowed\n");
        system ("PAUSE");
        askAnother();

    }

}

boolean cCheck(char *test, int max)
{
    int x;
    for (x =0; x<max; x++)
    {
        if (isdigit(test[x]))
        {
            return FALSE;
        }
        if (x==max)
        {
            return TRUE;
        }
        x++;

    }
    return TRUE;
}

int fileSize()
{
    int lengthOfFile;
    int file;

    file = open("Customers.dat",O_RDONLY,0);
    lengthOfFile = lseek (file,0, SEEK_END);

    return lengthOfFile;
}

int getNoOfRecords()
{
    return (fileSize()/(STRUCTSIZE));
}

/**
 *  This method will compare the ID passed from the ID of the customer to check
 *  whether it is exists or not. If it exists it will output 1 otherwise it
 *  will output -1\. This will make sure that the Person's ID is unique
 *
 */

int searchID (int cID)
{
    // for the while loop
    int index;
    index = 0;
    //gets the number of records currently held in the file.
    int records;
    records = getNoOfRecords();

    //User will input the ID into this variable and it will be checked
    //whether it exists or not

    int IDstatus;
    IDstatus = 0;

    while (index != records)
        {
            fread (&c,STRUCTSIZE,1,cfp);
            if (c.ID == cID)
            {
                IDstatus = 1;
            }
            else
            {
                IDstatus = -1;
            }
        }

    return IDstatus;

} 
```

* * *

编辑：

有两件事：

该方法无法使用 SearchID() 方法，因为即使我有 2 个现在为 0 的 ID，它们仍在接受它

或者因为 c.ID 保持为 0。

当我输入数据时，它正在接受它但是当我尝试输出整个记录时，客户端 ID 保持为 0。

除此之外，它让我有两个 0 的 ID，所以很可能该方法不起作用....感谢到目前为止的所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:55:57.883

你错过了增加索引，当然你应该在找到 id 时退出循环：

```
while (index != records)
    {
        fread (&c,STRUCTSIZE,1,cfp);
        if (c.ID == cID)
        {
            IDstatus = 1;
            break; // <<<< otherwise IDStatus will be overwritten by next iteration
        }
        else
        {
            IDstatus = -1;
        }
        index++; // <<< otherwise endless loop
    } 
```

# lisp - 获取所有可能的 x 布尔值组合（球拍，方案）

> ID：13978595
> 
> 赞同：2
> 
> 时间：2012-12-20T18:51:08.993
> 
> 标签：lisp, scheme, racket

我有个问题。如何在 Racket 中获得所有可能的 x 布尔值组合？（在低语言水平上）

我需要这样的东西：

对于 x=1 (list (list false) (list true))

对于 x=2 (list (list false false) (list false true) (list true false) (list true true))

for x=3 (list (list false false) (list false false true) (list false true false) (list false true true) (list true false false) (list true false true) (list true false) (list真实真实真实））

等等

我不知道如何在 Racket 中做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:09:59.493

您要求 list 的所有 n 大小*排列*（不是*组合*！），`'(#t #f)`允许重复。为球拍改编[这个答案：](https://stackoverflow.com/a/3181532/201359)

```
(define (permutations size elements)
  (if (zero? size)
      '(())
      (append-map (lambda (p)
                    (map (lambda (e)
                           (cons e p))
                         elements))
                  (permutations (sub1 size) elements)))) 
```

像这样使用它：

```
(permutations 3 '(#t #f))

=> '((#t #t #t) (#f #t #t) (#t #f #t) (#f #f #t)
     (#t #t #f) (#f #t #f) (#t #f #f) (#f #f #f)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T19:18:29.533

这是将数字转换为布尔值列表的一种方法。要生成所有组合，请按照您的描述在循环中使用它。

```
 (map (λ (x) (eqv? x #\1)) 
       (string->list (number->string 12345 2))) 
```

将 12345 替换为任意数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T17:45:02.267

您实际上在做的是为一组大小 x 构建幂集。

幂集是所有可能子集的集合。例如， (list 1 2 3) 的幂集是 (list (list 1 2 3) (list 1 2) (list 1 3) (list 1) (list 2 3) (list 2) (list 3) empty) .

（一个集合是它自己的一个子集，而空集是所有集合的一个子集。）

为什么您正在做的事情描述了幂集是因为一个元素可以在或不在一个子集中。所以 apply (list true true true) to (list 1 2 3) 将返回 (list 1 2 3) 并且 (list false true true) 将返回 (list 2 3)。

这是我解决您问题的代码。

```
(define baselist (list  (list true) (list false)))
;; List1 List2 -> List of Lists
;; Where List1 is any list of lists, and list2 is a list of lists of size 2
;; and all of the lists within list 2 has one element
(define (list-combination list-n list-two)
  (cond [(empty? list-n) empty]
        [else (cons (append (first list-n) (first list-two))
                    (cons (append (first list-n) (second list-two))
                          (list-combination (rest list-n) list-two)))]))
;; tflist Number -> List of Boolean Lists
;; creates baselistn
(define (tflist n)
  (cond [(= 1 n) baselist]
        [else (list-combination (tlist (sub1 n)) baselist)])) 
```

所以 (tflist 3) 会返回你原来的问题。现在要制作一个powerset，您可以执行以下操作...

```
;; subset List1 ListofBooleans -> List
;; Determines which elements of a set to create a subset of
;; List1 and LoB are of the same length
(define (subset set t-f-list)
  (cond [(empty? t-f-list) empty]
        [(first t-f-list) (cons (first set) (subset (rest set) (rest t-f-list)))]
        [else (subset (rest set) (rest t-f-list))]))
;;powerset set -> Powerset
;; produces a  powerset of a set
(define (powerset set)
  (local ((define upperbound (expt 2 (length set)))
          (define tflist (tlist (length set)))
          (define (powerset set n)
            (cond [(= n upperbound) empty]
                  [else (cons (subset set (list-ref tflist n)) (powerset set (add1 n)))])))
    (powerset set 0))) 
```

# linux - 如何确定有多少 Linux meminfo 的缓存值可以免费使用？

> ID：13978597
> 
> 赞同：1
> 
> 时间：2012-12-20T18:51:14.380
> 
> 标签：linux, memory

我试图找出可用的缓存和缓冲区的数量并计为空闲内存（在 free 和 /proc/meminfo 中列出）。如果我 drop_caches 我得到一些免费的，但它是怎么做的？我在哪里可以找到它的源代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T20:20:27.300

您是否尝试使用某些代码获取这些值？无论如何，您都可以从“/proc/meminfo”中获取所有内存信息。

在我的机器上，我可以看到：

```
MemTotal:        2051856 kB
MemFree:          522948 kB
Buffers:           74036 kB
Cached:           760480 kB 
```

如果你必须通过一些程序来获得它，那么你可以轻松地解析这个文件。（前提是您可以访问 proc 文件系统）

# c# - 移动要托管的 XML 文件

> ID：13978601
> 
> 赞同：2
> 
> 时间：2012-12-20T18:51:30.033
> 
> 标签：c#, windows-phone-7

请温柔一点。我不是一个非常熟练的开发人员！

所以这是我认为完成之前需要在我的 Windows Phone 7.5 应用程序中修复的最后一件事。简而言之，菜单上的数据源是由一个 xml 文件驱动的。该文件与应用程序一起存储在本地。我想将该文件存储在 Internet 上的某个位置）。目前，如果我需要对此 xml 文件进行更改，我必须在更改生效前大约 5 天将应用程序重新提交到 Marketplace。2003年的我怎么了。

所以我无法弄清楚他们期望在下面的代码中返回什么。我已经破解了，它总是给出一些我不明白的错误。

我已将文件名变量设置为 Internet 上文件的 URL，但显然不支持。所以我要么需要一种新的方式让整个部分工作，要么需要一种将托管文件名转换为可以工作的东西的方法。

* * *

```
private static void FirstLaunch()
    {
        // On the first launch, just add everything from the OPML file

        string filename;

//This file should really be hosted on the Internet somewhere.

        filename = "/RSSReader;component/LyncNews-opml.xml";

        StreamResourceInfo xml = App.GetResourceStream(new Uri(filename, UriKind.Relative));
        List<RSSPage> rssPages = ParseOPML(xml.Stream);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:05:29.207

您可以将其设置为 URL，但您需要下载内容，而不是通过 App.GetResourceStream。试试看`WebClient`，简单易行。

一个简单的用法：

```
WebClient client = new WebClient();

    client.DownloadStringCompleted += new DownloadStringCompletedEventHandler(Client_DownloadStringCompleted);
    Uri token = new Uri("your url");

    client.DownloadStringAsync(token); 
```

并在事件中处理 xml 解析。

# iphone - 我如何从 viewdidload 调用按钮的方法

> ID：13978603
> 
> 赞同：0
> 
> 时间：2012-12-20T18:51:40.900
> 
> 标签：iphone, objective-c, ios

我有 10 个`UIButton`对象。我为所有这些定义了一个动作。`UIScrollView`当我在相关按钮上时，我想将动画设置到所需的图像位置。我已经使用情节提要实现了这个项目，并且我对所有 10 个按钮都有一种方法。我给文件中的每个按钮一个标签，`viewDidLoad`像`viewcontroller.m`这样

```
button1.tag = 10;
button1.tag = 11;
button1.tag = 12;
button1.tag = 13;
button1.tag = 14;
button1.tag = 15;
button1.tag = 16;
button1.tag = 17;
button1.tag = 18;
button1.tag = 19; 
```

// viewcontroller.m 文件

```
-(IBAction) Button1:(id) sender
{

 [self performSegueWithIdentifier:@"nextView" sender:sender];
} 
```

这个按钮方法将带我到 nextviewcontroller 并且它工作正常，但是在`nextviewctontroller.m`文件中我想动画到我`UIScrollView`想要的位置。我在`nextviewcontroller.m`文件中这样做，但它不起作用。

```
viewDidload
{
if ([sender tag] == 10)
{
[yourScrollView scrollRectToVisible:CGRectMake(0,0,100,100) animated:YES];
}
else if ([sender tag] == 11)
{
[yourScrollView scrollRectToVisible:CGRectMake(320,0,100,100) animated:YES];
}
/*
.
.
.
.
.
.
.
and its continue to the last tag 
*/

} 
```

它不会将动画`UIScrollView`移动到所需的位置，并且记住一件事，我已在头文件中声明`sender`为类型。`id`请告诉我当我点击相应的按钮时如何动画`UIScrollView`到所需的位置。我还想说我没有从我的 xcode 项目中复制和粘贴这段代码。我写这段代码只是让你知道我想要什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:59:53.677

此时，您处于第二个 viewController 中，不再可以访问按钮上的标签。除非您引用了第一个视图控制器（您不应该引用），否则它们此时超出了范围。

您应该在“nextViewController”上创建一个标签或偏移属性。然后，根据您从第一个视图控制器到达那里的方式，您需要让第一个视图控制器在第二个视图控制器上设置该属性。然后，您可以在第二次访问它。如果您使用 segue，您应该在第一个视图控制器的 prepareForSegue 方法中执行此操作。

如果您将它推送到导航控制器上，您将在分配第二个视图控制器之后并将其推送到导航堆栈之前设置该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:57:23.157

在下一个视图控制器的标题中添加这个

```
@property (nonatomic, strong) UIButton *buttonBeingPassedIn; 
```

在第一个视图控制器中，您要全局创建一个 UIButton，以便您可以在该文件中的任何方法中访问它，将其命名为：buttonThatWasTapped。然后你可以做这样的事情：

```
-(IBAction) Button1:(id) sender
{
    buttonBeingPassedIn = (UIButton *)sender;
    // Notice this has been changed to sender: self
    [self performSegueWithIdentifier:@"nextView" sender:self];
} 
```

在第一个视图控制器中，您需要添加此方法

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
      nextViewController *vc = (nextViewController *)segue.destinationViewController;
      vc.buttonBeingPassedIn = buttonThatWasTapped;
} 
```

然后你就可以做

```
viewDidload
{
    if (buttonBeingPassedIn == 10)
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-20T18:55:50.897

尝试在 viewWillAppear 而不是 viewDidLoad 中执行此操作。您不应该在 viewDidLoad 中放置与几何相关的内容，因为此时未设置视图的几何（框架等）。

# c# - 在 SQL Server 中创建 NationalInstruments.Common.Native.dll

> ID：13978604
> 
> 赞同：0
> 
> 时间：2012-12-20T18:51:43.963
> 
> 标签：c#, sql-server, visual-studio-2012, sql-server-2012, .net-4.5

我编写了一个要部署到 SQL Server 2012 数据库的存储过程。书面存储过程引用了许多程序集，包括`NationalInstruments.Common.Native.dll`.

当我尝试发布存储过程时，出现以下错误：

> *SQL72014：.Net SqlClient 数据提供者：消息 6503，级别 16，状态 12，第 1 行程序集“nationalinstruments.visans，版本=9.0.40.156，文化=中性，publickeytoken=dc6ad606294fc298。” 在 SQL 目录中找不到。*

`CREATE ASSEMBLY with PERMISSION_SET=UNSAFE`我尝试使用and将程序集添加到数据库中`TRUSTWORTHY ON`。在添加`System.Messaging`到数据库时，这对我有用。对 执行相同操作时`NationalInstruments.Common.Native.dll`，出现以下错误：

> *消息 6544，级别 16，状态 1，第 2 行为
> 程序集“NationalInstruments.Common.Native”创建程序集失败，因为程序集“NationalInstruments.Common.Native”格式错误或不是纯 .NET 程序集。无法验证的 PE 标头/本机存根。*

我了解 SQLCLR 不支持以本机（非托管代码）编写的程序集。但是，我真的需要`NationalInstruments.Common.Native.dll`，因为它被 引用`NationalInstruments.Common.dll`，而 又被 引用`NationalInstruments.VisaNS`，这对我的存储过程的功能至关重要。

有没有办法绕过使用`NationalInstruments.Common.Native.dll`，或以某种方式将其转换为托管代码的纯 .NET 程序集？

（我不知道这是否相关，但存储过程是使用 Visual Studio 2012 用针对 .NET Framework 4.5 的 C# 编写的。）

# javascript - Backbone (Parse.com) 集合添加忽略重复项

> ID：13978607
> 
> 赞同：1
> 
> 时间：2012-12-20T18:51:50.170
> 
> 标签：javascript, backbone.js, parse-platform

我正在使用**Parse.com** Javascript API（*Backbone*）。

我正在尝试将`add`结果`Query`（模型数组）转换为 a `collection`，但出现此错误：`Duplicate id: can't add the same model to a collection twice.`

## 样本：

```
var GameScore = Parse.Object.extend("GameScore");

// A Collection containing all instances of TestObject.
var TestCollection = Parse.Collection.extend({
  model: GameScore
});
var collection = new TestCollection();

var query = new Parse.Query(GameScore);
query.equalTo("playerName", "Dan Stemkoski");
query.find({
  success: function(results) {
    collection.add(results);
  },
  error: function(error) {}
}); 
```

## 问题：

是否可以调用忽略重复模型的添加方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:59:35.370

这是因为 Parse.com Javascript API 基于旧版本的骨干网。较新的主干版本会静默跳过添加到集合中的重复模型。

您可以简单地用较新的主干版本替换/扩充 Parse collection.add() 方法。

我使用下划线来扩展我的 Parse Collection 和我需要的新方法。

例如，为了解决将重复模型添加到集合时的问题，我添加了较新版本的 collection.add()，如下所示：

_.extend(selectedUsersCol, newBackboneAddMethod()); 其中 newBackboneAddMethod() 是来自新版本 Backbone/Underscore 的 add 方法的副本。

在 parse.com 上查看此答案：[https ://www.parse.com/questions/what-version-of-backbone-is-parse-javascript-api-based-on](https://www.parse.com/questions/what-version-of-backbone-is-parse-javascript-api-based-on)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:58:44.903

如果您想保存这两个模型，您应该更改（请参阅[http://underscorejs.org/#uniqueId](http://underscorejs.org/#uniqueId)）或从获取的模型中删除 ID 属性。如果你想用 fetched 替换重复的模型，你应该使用[http://backbonejs.org/#Collection-update](http://backbonejs.org/#Collection-update)。或者，如果您想替换所有旧数据，您应该使用[http://backbonejs.org/#Collection-reset](http://backbonejs.org/#Collection-reset)

# c++ - Eclipse CDT 无法解析类型 boost::units::derived_dimension

> ID：13978613
> 
> 赞同：1
> 
> 时间：2012-12-20T18:52:26.880
> 
> 标签：c++, boost, eclipse-cdt, boost-units

我在下面的标题中定义了一个新的derived_dimension 类型specific_entropy_dimension 和一个单位specific_entropy。这编译得很好，没有使用 g++ 的警告，但是，Eclipse CDT 的索引器无法解析类型并出现错误：

> 类型 'derived_dimension< length_base_dimension, 2, time_base_dimension, -2, temperature_base_dimension, -1 >::type' 无法解析

它是我代码中唯一的错误，我想解决这个问题，以便获得“干净”的分析。我需要做什么才能让 CDT 解决这种类型？

单位.h

```
#ifndef UNITS_H_
#define UNITS_H_

#include <boost/units/systems/si/energy.hpp>
#include <boost/units/systems/si/force.hpp>
#include <boost/units/systems/si/length.hpp>
#include <boost/units/systems/si/electric_potential.hpp>
#include <boost/units/systems/si/current.hpp>
#include <boost/units/systems/si/resistance.hpp>
#include <boost/units/systems/si/temperature.hpp>
#include <boost/units/systems/si/mass_density.hpp>
#include <boost/units/physical_dimensions/specific_energy.hpp>
#include <boost/units/systems/si/io.hpp>
#include <boost/units/conversion.hpp>
#include <boost/units/cmath.hpp>
#include <boost/units/derived_dimension.hpp>

using namespace boost::units;
using namespace boost::units::si;

typedef derived_dimension<length_base_dimension, 2, time_base_dimension, -2,
        temperature_base_dimension, -1>::type specific_entropy_dimension;

typedef ::boost::units::unit<specific_entropy_dimension, si::system> specific_entropy;

#endif /* UNITS_H_ */ 
```

请注意，我的标题包含更多派生维度，但这说明了问题。

# spring - Spring 在将字符串转换为 Long 时删除空格

> ID：13978614
> 
> 赞同：2
> 
> 时间：2012-12-20T18:52:27.223
> 
> 标签：spring

我正在使用 Spring 3.1 开发一个项目。我们正在做我们所有的验证服务器端，但是当请求参数绑定到 Long 或 Integer 对象时遇到了问题。虽然大多数无效值最终会导致异常并显示错误消息，但当请求参数包含数字之间的空格时，情况并非如此。例如，当绑定“12345 6789”时，我们预计会出现验证错误，但空白只是被修剪掉了。

我使用调试器发现这发生在 org.springframework.util.NumberUtils 中。调用 StringUtils.trimAllWhitespace 以从所有输入中删除空格。这似乎是一个足够常见的用例，但到目前为止我一直无法找到任何有好的解决方案的人。在只接受数字的情况下，将请求参数上的字符串简单转换为 Long 或 Integer 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T01:11:57.593

一个解决方案是创建一个满足您需求的自定义验证器。

取自[文档](http://static.springsource.org/spring/docs/3.0.0.RC3/reference/html/ch05s07.html)的示例：

**约束声明：**

```
@Target({ElementType.METHOD, ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy=MyConstraintValidator.class)
public @interface MyConstraint {
} 
```

**约束实现**

```
import javax.validation.ConstraintValidator;

public class MyConstraintValidator implements ConstraintValidator {

    @Autowired;
    private Foo aDependency;

    ...
} 
```

**编辑：**

创建自定义属性转换器[文档](http://static.springsource.org/spring/docs/2.5.5/reference/mvc.html)。

@Controller 公共类 MyFormController {

```
 @InitBinder
    public void initBinder(WebDataBinder binder) {
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        dateFormat.setLenient(false);
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, false));
    }

    // ...
} 
```

# android - Android 虚拟设备管理器和模拟器

> ID：13978616
> 
> 赞同：1
> 
> 时间：2012-12-20T18:52:27.023
> 
> 标签：android, android-emulator

当我在 andorid 中打开 AVD 并启动模拟器时，它会发出一条消息

`emulator window was out of view and was recentered`.

所以我无法最大化模拟器窗口。

有人请说我可以为此做些什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:15:18.153

重启 Eclipse 文件->重启。如果还没有解决。检查此[链接](http://android.okhelp.cz/emulator-window-was-out-of-view-and-was-recentred-android-emulator-warning/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T18:59:38.847

它有时会发生。擦除 AVD 配置可能会有所帮助，或者一个简单的 Eclipse 应该可以修复它。

# jquery - jQuery清除焦点上的输入文本

> ID：13978621
> 
> 赞同：12
> 
> 时间：2012-12-20T18:52:44.080
> 
> 标签：jquery, input, focus

我有这个`jQuery`脚本：

```
$(document).ready(function() {
    $(':input:enabled:visible:first').focus();
    $('.letters').keyup( function() {
        var $this = $(this);
        if($this.val().length > 1)
            $this.val($this.val().substr(0, 1));
            $(this).next('input').focus();
        });
}); 
```

它将焦点放在`input='text'`页面加载的第一个字段上。当用户输入一个字符时，它会将焦点移动到下一个输入字段。它还将限制每个字段中允许的字符数（当前为 1 个字符）。

我想知道是否可以清除焦点上输入字段的当前值。无论是当用户单击光标以聚焦该字段时，还是当`$(this).next('input').focus();`集合聚焦于下一个输入字段时。

也可以验证字符只允许字母字符吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-20T18:59:25.880

要过滤输入，请使用

```
​$('input').on('keydown', function(e) {
    if( !/[a-z]|[A-Z]/.test( String.fromCharCode( e.which ) ) )
        return false;
});​​​​​​​​ 
```

要清除`click`&上的输入字段`focus`，请使用

```
$('input').on('click focusin', function() {
    this.value = '';
}); 
```

请注意，当您单击当前形式的非焦点*输入控件时，此事件将触发两次。*

*演示*：http: [//jsfiddle.net/xbeR2/](http://jsfiddle.net/xbeR2/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-20T18:57:39.350

要回答您的焦点问题，是的，您可以这样做：

```
$("input").focus(function() {
  this.value = "";
}); 
```

要回答唯一允许字母的问题，这已经[被](https://stackoverflow.com/questions/2980038/allow-text-box-only-for-alphabets-using-jquery) [问](https://stackoverflow.com/questions/4827535/jquery-trapping-allow-only-letters) [过了](https://stackoverflow.com/questions/10016693/allow-only-letters-and-spaces-jquery-validation-plugin)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-09T21:27:12.487

用这个

```
$( document ).ready(function() {
  var search_text_s = "WYSZUKAJ";

  // author ZMORA
  // search input focus text
  $("#searchClear").focus(function() {
    if(this.value == search_text_s){
      this.value = "";
    }
  }).blur(function() {
    if(this.value != search_text_s){
      this.value = search_text_s;
    }
  });
}); 
```

# clojure - 如何在环项目中运行任意启动功能？

> ID：13978623
> 
> 赞同：14
> 
> 时间：2012-12-20T18:52:53.160
> 
> 标签：clojure, compojure, ring

我有一个我目前运行的组合/环应用程序`lein ring server`，我想编译为 .war 以便我可以部署它。然而，我有一个定义，就像

```
 (def foo (start-scheduler)) 
```

这会阻止 .war 的编译和生成。为了避免这种情况，我考虑过将调用转移到启动函数，但是当服务器启动时我将如何调用它呢？

如果我将调用放在处理程序中，我最终会遇到与以前相同的问题。

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-20T23:09:56.320

在`project.clj`声明 Ring 处理程序时，您还可以指定在应用程序启动时运行的 init（和 destroy）函数：

```
:ring {:init myproject.core/init
       :destroy myproject.core/destroy
       :handler myproject.core/handler} 
```

这记录在这里：[https ://github.com/weavejester/lein-ring#general-options](https://github.com/weavejester/lein-ring#general-options)

# c# - 实体框架 MVC 4 类问题

> ID：13978625
> 
> 赞同：1
> 
> 时间：2012-12-20T18:52:58.103
> 
> 标签：c#, entity-framework-4, asp.net-mvc-4

我正在尝试使用带有 ASP.Net MVC 4 的实体框架构建代码优先数据库。

我是 MVC 和实体框架的新手，我正在努力设计我的类对象。

我想要一个像下面这样的成员类，它具有 AddressInformation 类的数据属性：-

```
 public class Member
    {
        public virtual int MemberID { get; set; }
        public virtual string Forename { get; set; }
        public virtual string Surname { get; set; }
        public virtual int age { get; set; }
        public virtual AddressInformation Address { get; set; }
        public virtual string EmailAddress { get; set; }
        public virtual string HomePhoneNumber { get; set; }
        public virtual string MobileNumber { get; set; }
    }

public class AddressInformation
    {
        public virtual int MemberID { get; set; }
        public virtual string HouseNoName { get; set; }
        public virtual string StreetName { get; set; }
        public virtual string Town { get; set; }
        public virtual string County { get; set; }
        public virtual string PostCode { get; set; }
        public virtual string Country { get; set; }
    } 
```

我还有另一个继承自 DbContext 的类：-

```
public class CentralDataStore :DbContext
    {
        public DbSet<Member> Members { get; set; }
        public DbSet<AddressInformation> AddressInfo { get; set; }
    } 
```

当我添加控制器时，我无法输入地址信息，只有成员信息已填充到我的视图中。

任何人建议最好的方法来攻击这个？正如我所说，我是 MVC 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:18:38.830

据我所知，用于生成视图的标准模板没有实现嵌套对象的输入字段。但是有一个选项来扩展 MVC 应用程序的标准模板，就像在这个[链接](http://www.hanselman.com/blog/ModifyingTheDefaultCodeGenerationscaffoldingTemplatesInASPNETMVC.aspx)中一样。如果您熟悉 T4 模板，则可以在此处为嵌套类添加输入字段的生成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T19:53:28.047

**你必须小心使用这个模板，你可以很容易地得到一个stackoverflow**

**尤其是在使用 Entity Framework 时，当您有两个具有导航属性的实体相互指向时**

默认`Object`模板防止递归到特定深度以防止无限循环。我不喜欢这样，所以我自己写了：

**/Views/Shared/object.cshtml**

```
@model object

@using System.Text;
@using System.Data;

@{
  ViewDataDictionary viewData = Html.ViewContext.ViewData;
  TemplateInfo templateInfo = viewData.TemplateInfo;
  ModelMetadata modelMetadata = viewData.ModelMetadata;

  System.Text.StringBuilder builder = new StringBuilder();

  string result;

  // DDB #224751
  if (templateInfo.TemplateDepth > 2) 
  { 
    result = modelMetadata.Model == null ? modelMetadata.NullDisplayText 
                                         : modelMetadata.SimpleDisplayText;
  }

  foreach (ModelMetadata propertyMetadata in modelMetadata.Properties
    .Where(pm => pm.ShowForEdit
           && pm.ModelType != typeof(System.Data.EntityState)
           && !templateInfo.Visited(pm))) 
  {
      builder.Append(Html.Editor(propertyMetadata.PropertyName).ToHtmlString());
  }

  result = builder.ToString();
}

@Html.Raw(result) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T21:47:38.380

您不需要将所有属性设为虚拟，只需将用于导航的属性设为虚拟即可。您需要使用 Fluency API 设置 Member 和 AddressInformation 之间的关系。此外，您的主键需要命名为 Id 或使用属性或 Fluency API 来指定它是主键。您还缺少用于将成员映射到 AddressInformation 的 id。这是您的类定义的样子。

```
public class Member
{
    public int ID { get; set; }
    public string Forename { get; set; }
    public string Surname { get; set; }
    public int age { get; set; }
    public virtual int AddressId { get; set; }
    public virtual AddressInformation Address { get; set; }
    public string EmailAddress { get; set; }
    public string HomePhoneNumber { get; set; }
    public string MobileNumber { get; set; }
}

public class AddressInformation
{
    public int ID { get; set; }
    public string HouseNoName { get; set; }
    public string StreetName { get; set; }
    public string Town { get; set; }
    public string County { get; set; }
    public string PostCode { get; set; }
    public string Country { get; set; }
} 
```

注意我添加了属性 AddressId 以提供到 AddressInformation 对象/表的映射。像这样在 Fluency API 中配置关系。

```
public class MemberConfig : EntityTypeConfiguration<Member>
{
    internal MemberConfig()
    {
        this.HasKey(m => m.ID);
        this.HasRequired(m => m.Address)
            .WithRequiredDependent(a => a.ID)
            .HasForeignKey(m => m.AddressId);

    }
 } 
```

通过设置外键关系，EF 会自动将 AddresssInformation 加载到 Member 对象中。

# c# - 了解 WCF 客户端到服务器

> ID：13978626
> 
> 赞同：0
> 
> 时间：2012-12-20T18:53:00.617
> 
> 标签：c#, wcf, service

我很难完全掌握 Windows Communication Foundation 的特定功能。我一个接一个地阅读教程，一本书又一本书。所以我对整个概念性质充满信心。

一部分除外；这是几乎像魔术一样的部分。这实际上使学习有点困难。

我将使用网络上最常见的示例。

我将从`DataContract`：

```
[DataContract]
public class Customer
{

    // Declerations:
    private Guid id;
    private string firstName;
    private string lastName;
    private string emailAddress;

    [DataMembers]
    public Guid Id
    {
       get { return id; }
       set { id = value; }
    }

    [DataMember]
    public string FirstName
    {
         get { return firstName; }
         set { firstName = value; }
    }

    [DataMember]
    public string LastName
    {
         get { return lastName; }
         set { lastName = value; }
    }

    [DataMember]
    public string EmailAddress
    {
         get { return emailAddress; }
         set { emailAddress = value; }
    }

} 
```

现在我创建了一个对象；我想暴露给我的客户。

所以我然后创建我的`ServiceContract`.

```
[ServiceContract]
public interface ICustomer
{

     [OperationContract]
     Customer AddCustomer(Customer info);

} 
```

所以这就是我一直困惑自己的地方；假设您有一个客户端应用程序。您已使用该服务。您在单独的程序集/命名空间中有三个文本框。客户提出标准：

*   名
*   姓
*   电子邮件地址

如果您将这些文本框设置为日期；他们将在元数据中转移。但是在服务器上；我怎样才能把那个信息变量拉出来？我只是参考`private Guid and private string variables`吗？

我看到了一个关于如何将它添加到数据库的教程；但我并不完全理解 WCF 实际在做什么。这与我想要的相似。我想获取客户端接口输入并将其写入数据库和单独的日志文件。

我可以按照教程进行操作；但我想知道如何组装客户对象数据及其变量以在服务器上使用。

任何帮助都将是惊人的，一些澄清。

对不起，如果我的问题很愚蠢；我不是要开始辩论。只想了解如何提取这些变量并在服务器上使用它们。

提前致谢。如果我没有正确格式化问题，请告诉我。我真的很想了解它在概念上的作用。

*更新：* 我的真正意图是了解客户端接口如何引用该对象；因此，当进行调用时，服务器具有一个不为空的有效对象。

文本框中的客户端类型 ---> 代理发送 ---> 反序列化 ---> 服务 ---> 序列化 ---> 使属性可供使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:41:19.997

实际*类型*（例如您的`Customer`类）并没有真正通过网络传输。但是，这些类型中的公共信息是通过称为序列化的过程发送的。序列化允许以允许其通过网络传输的方式表示类型。这通常使用 SOAP、JSON 或 XML 等格式来表示。WCF 甚至允许您准确控制对象的序列化方式，允许您根据需要编写自己的格式化程序。基本上，当`AddCustomer`被调用时，WCF 正在服务器上构造一个`Customer`对象，对其进行序列化，然后通过网络发送这些位。

现在，在客户端上，您将拥有一个`Customer`称为代理的匹配对象。它可能看起来像：

```
public class Customer
{
    public Guid Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string EmailAddress { get; set; }
} 
```

基本上，只有服务器版本的数据成员的缩小版本，没有代码或逻辑。在客户端， 的序列化表示`Customer`被反序列化回这个本地代理类的实例，在那里它可以用于各种客户端目的，包括绑定到本地 UI 元素。

[Web 服务可以使用WSDL](http://en.wikipedia.org/wiki/Web_Services_Description_Language)（一种用于描述 Web 服务契约的 XML 格式）公开这种类型的信息。Visual Studio（使用 wsdl.exe 工具）可以自动为您编写这些代理类，让一切都神奇地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:01:29.010

我不确定，但可能这就是您正在寻找的 [数据传输和序列化](http://msdn.microsoft.com/en-us/library/ms730035.aspx)

特别是您可以检查[DataContractSerializer](http://msdn.microsoft.com/en-us/library/ms731072.aspx)

您也可以查看这篇文章：[Windows Communication Foundation 中的序列化](http://www.codeproject.com/Articles/30279/Serialization-in-Windows-Communication-Foundation)

# android - ClickableSpan 与自定义背景颜色状态列表（按下状态）

> ID：13978632
> 
> 赞同：6
> 
> 时间：2012-12-20T18:53:39.477
> 
> 标签：android, textview

我有一个 TextView，它包含一个可点击的文本，后跟一个普通的文本，然后是一个可点击的文本。我想为可点击的文本而不是整个 TextView 设置自定义的按下颜色。现在我可以删除下划线，通过子类化（[参见this](https://stackoverflow.com/questions/10446079/textview-clickablespan-styling-for-pressed-state)）ClickableSpan来更改文本，但无法设置按下状态颜色。
请建议。

# php - 如果数组值以

> ID：13978635
> 
> 赞同：0
> 
> 时间：2012-12-20T18:53:42.573
> 
> 标签：php

我有一个值数组。

我的爬虫扫描网页并插入所有链接，链接的标题和描述是一个多维数组。

但现在我有一个新数组，我只想要链接、描述和标题等，如果它们以数组中的任何值开头 ($bbc_values)

但我真的不知道该怎么做。我在实际代码方面已经走了很长一段路，但是谁能给我任何想法a）为什么我的代码不起作用b）对我的问题的建议？

```
$bbc_values = array('http://www.bbc.co.uk/news/health-', 'http://www.bbc.co.uk/news/politics-', 'http://www.bbc.co.uk/news/uk-', 'http://www.bbc.co.uk/news/technology-',  'http://www.bbc.co.uk/news/england-', 'http://www.bbc.co.uk/news/northern_ireland-', 'http://www.bbc.co.uk/news/scotland-', 'http://www.bbc.co.uk/news/wales-', 'http://www.bbc.co.uk/news/business-', 'http://www.bbc.co.uk/news/education-', 'http://www.bbc.co.uk/news/science_and_enviroment-', 'http://www.bbc.co.uk/news/entertainment_and_arts-', 'http://edition.cnn.com/');

foreach ($links as $link) {
    $output = array(
        "title"       => Titles($link), //dont know what Titles is, variable or string?
        "description" => getMetas($link),
        "keywords" => getKeywords($link), 
        "link"        => $link                 
    );

    if (empty($output["description"])) {
        $output["description"] = getWord($link);
    }
}
$data = implode( " , ", $output['link']);
foreach ($output as $new_array) {
    if (in_array($output, $bbc_values)) {
    $news_stories[] = $new_array;
}

var_dump($news_stories);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:06:11.227

变成`$bbc_values`正则表达式：

```
$bbc_re = '/^('.implode('|', array_map('quotemeta', $bbc_values)).')/'; 
```

然后使用此正则表达式过滤链接。

```
foreach ($links as $link) {
  if (preg_match($bbc_re, $link)) {
    /* Do stuff with $link */
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:04:14.730

好的，我不完全理解这里的代码。但我认为 $output 数组应该在第一个 foreach 循环之外声明，并且每个数组都应该附加到它上面？因为从您正在编写的代码中，只有最后一个 $link 的详细信息将存储在 $output 中

另外，这里的 $data 是什么？你用它做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:07:31.600

我假设你想要的是一个数组，其中的链接以 中的链接开头，`bbc_values`另外还有一个字符串`$data`，其中包含所有链接的逗号分隔列表。试试这个：

```
<?php

$bbc_values = array('http://www.bbc.co.uk/news/health-', 'http://www.bbc.co.uk/news/politics-', 'http://www.bbc.co.uk/news/uk-', 'http://www.bbc.co.uk/news/technology-',  'http://www.bbc.co.uk/news/england-', 'http://www.bbc.co.uk/news/northern_ireland-', 'http://www.bbc.co.uk/news/scotland-', 'http://www.bbc.co.uk/news/wales-', 'http://www.bbc.co.uk/news/business-', 'http://www.bbc.co.uk/news/education-', 'http://www.bbc.co.uk/news/science_and_enviroment-', 'http://www.bbc.co.uk/news/entertainment_and_arts-', 'http://edition.cnn.com/');

$news_stories = array();
$all_links = array();
$news_links = array();

foreach ($links as $link) {
    $item = array(
        "title"       => Titles($link), 
        "description" => getMetas($link),
        "keywords" => getKeywords($link), 
        "link"        => $link                 
    );

    if (empty($item["description"])) {
        $item["description"] = getWord($link);
    }

    foreach($bbc_values as $bbc_value) {
        // note the '===' . this is important
        if(strpos($item['link'], $bbc_value) === 0) {
            $news_stories []= $item;
            $news_links []=$item['link'];
            break;
        }
    }

    $all_links[] = $item['link'];
}

$data_all_links = implode(' , ', $all_links);
$data_news_links = implode(' , ', $news_links);
var_dump($news_stories); 
```

# c# - 通过 System.Net.WebClient 访问 asp.net 网站的受保护区域

> ID：13978641
> 
> 赞同：1
> 
> 时间：2012-12-20T18:54:12.550
> 
> 标签：c#, asp.net, authentication, webclient

我有一个运行带有 url 身份验证的 asp.net 2.0 的网站。网站有一个受保护的区域，要求用户登录才能访问受保护的文件。是否可以使用 System.Net.WebClient 对象在受保护区域中下载文件来做同样的事情？

如果您尝试手动输入受保护文件、资源、页面等的 url，它会将您转发到登录页面。每当我执行下面的代码时，我也会在“protectedFile.zip”中获取登录页面的 html。

```
public void test()
{
        try
        {
            using (var client = new CookieAwareWebClient())
            {
                //Not sure which name values to include, so I used what was in the post output in Firefox's firebug.
                var values = new NameValueCollection
            {
                { "ctl00$ContentPlaceHolder1$Login1$UserName", "testUsername" },
                { "ctl00$ContentPlaceHolder1$Login1$Password", "testPassword" }
            };
                retValue = client.UploadValues("www.test.com/login.aspx", values);
                //retValue contains the login page?
                Console.WriteLine(ASCIIEncoding.ASCII.GetString(retValue));
                // If the previous call succeeded we now have a valid authentication cookie??
                client.DownloadFile("www.test.com/protected/protectedFile.zip", "protectedFile.zip");
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
            Console.WriteLine(ASCIIEncoding.ASCII.GetString(retValue));
        }
}

public class CookieAwareWebClient : WebClient
{
    public CookieAwareWebClient()
    {
        CookieContainer = new CookieContainer();
    }
    public CookieContainer CookieContainer { get; private set; }

    protected override WebRequest GetWebRequest(Uri address)
    {
        var request = (HttpWebRequest)base.GetWebRequest(address);
        request.CookieContainer = CookieContainer;
        return request;
    }
} 
```

我查看了以下相关问题，但没有一个有我能理解的最终解决方案。

[asp.net 从受保护的服务器下载文件](https://stackoverflow.com/questions/11185317/asp-net-download-files-from-protected-server)

[如何验证 WebClient 请求？](https://stackoverflow.com/questions/1883655/how-do-i-authenticate-a-webclient-request?rq=1)

[C# WebClient 登录网站](https://stackoverflow.com/questions/1459501/c-sharp-webclient-log-onto-website?rq=1)

[WebClient 使用凭据访问页面](https://stackoverflow.com/questions/11118712/webclient-accessing-page-with-credentials)

[无法使用 WebClient 登录 asp.net 网站](https://stackoverflow.com/questions/13906771/cant-login-into-asp-net-website-with-webclient)

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:08:56.633

如果您试图“欺骗”一个 ASP.Net Web 表单`Postback`，您将遇到阻止您这样做的问题。你必须处理[`VIEWSTATE`和`EVENTVALIDATION`](http://msdn.microsoft.com/en-us/magazine/cc163512.aspx#S3)

> __EVENTVALIDATION 隐藏字段是 ASP.NET 2.0 新增的安全措施。该功能可防止潜在恶意用户从客户端发送未经授权的请求。为了**确保每个回发和回调事件都源自预期的用户界面元素**，页面添加了额外的事件验证层。

# c# - 如何在 MVC 站点之间共享通用样式信息（css、图像等）？

> ID：13978643
> 
> 赞同：9
> 
> 时间：2012-12-20T18:54:17.027
> 
> 标签：c#, css, tfs, asp.net-mvc-4, visual-studio-2012

在多个 MVC 项目之间共享功能非常简单。您只需将代码放入自己的项目中，并在尽可能多的解决方案中引用它即可。干净、标准、光荣。

有没有办法为代码样式做这个？我希望在一个地方拥有我们的通用 CSS 文件，这些文件使我们的应用程序具有相似的外观和感觉。现在我必须为每个新应用程序生成新副本。因此，如果需要修复某些东西，则需要在十几个地方修复十多次。

有没有其他人处理过这个？我不能将 CSS 文件分离到他们自己的项目中，我也不想拥有一个*只是*css 的 Web 应用程序，以便所有应用程序都可以通过完全限定的 Urls 远程使用这些文件。您是否可以使用源代码控制将文件链接在一起的 TFS 技巧？有什么我没有想到的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-27T12:34:41.310

这是在不使用 CDN、LESS、SASS、NuGet 等的情况下在项目之间共享 Web 资源的“非常简单”的解决方案：

1.  创建包含要共享的资源的通用*解决方案文件夹*，或者简单地将其中一个项目指定为主项目。
2.  根据需要使用“添加为链接”将共享资源文件添加到每个项目中。
3.  将*AfterBuild*任务添加到每个项目文件，将链接文件复制到项目文件夹。仅需要这样做，以便 Visual Studio 测试/调试 (F5) 可以在本地工作。

如果您需要有关如何执行此操作的详细信息，请继续阅读。

**为共享资源配置解决方案文件夹**

***请注意，如果您只是要将文件从一个项目直接共享到一个或多个其他项目，则可以跳过此步骤。*

Visual Studio 解决方案文件夹不必反映物理文件系统文件夹，但这样做有助于保持理智。因此，首先在本地文件系统上创建文件夹并将资源文件复制到其中。新文件夹应位于您的解决方案文件夹下。例如：

```
\MySolution
   \Common
      \Images
      \Scripts
      \Styles 
```

返回 Visual Studio，右键单击*解决方案项目*文件夹并使用*添加解决方案文件夹*复制新的文件系统文件夹。

接下来，通过右键单击每个文件夹并使用*Add Existing Item*添加文件夹的内容，将文件添加到新的解决方案文件夹中。

**将共享资源添加为链接**

对于将使用共享资源的每个项目，右键单击项目文件夹并选择*Add Existing Item*。浏览到公用文件夹，选择所需文件，单击“添加”按钮旁边的下拉箭头，然后选择“添加为链接”。

您可能会收到有关添加项目目录结构之外的文件的源代码控制警告，但这可以忽略，因为链接的文件将在其源代码控制下。

**添加*AfterBuild*任务以复制文件**

当您将应用程序发布到服务器时，链接的文件将复制到它们链接到的项目文件夹中，并且一切都按预期工作。但是，在开发环境中，链接文件实际上并不位于项目文件夹中。因此，当您在 VS 中按 F5 测试您的应用程序时，共享资源将丢失。

简单的解决方案是添加一个 MSBuild 任务，以便在每次构建后从其源中复制链接文件。需要对包含共享资源链接的每个项目执行此操作。

右键单击项目并选择*Unload Project*。再次右键单击该项目并选择*Edit <ProjectFileName>*。滚动到底部并添加以下内容（就在“</Project>”上方）：

```
 <Target Name="AfterBuild">
    <!-- Copy linked content files to local folders so that they are available in the debugger. 
         This is only an issue when running the application locally. The linked files should 
         be automatically published to the correct folder when publishing to a web server. -->
    <Copy SourceFiles="%(Content.Identity)"
          DestinationFiles="%(Content.Link)"
          SkipUnchangedFiles='true'
          OverwriteReadOnlyFiles='true'
          Condition="'%(Content.Link)' != ''" />
  </Target> 
```

***复制任务改编自TheCodeDestroyer 答案中的[此链接。](http://mattperdeck.com/post/Copying-linked-content-files-at-each-build-using-MSBuild.aspx)*

保存项目文件，然后右键单击并选择*Reload Project*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:57:59.397

为什么不让一个站点托管基本样式，而其他站点引用这些样式？我看不出这有什么问题。

您也可以创建一个 CDN 应用程序来执行此操作。

**MVC 应用程序 #1**

```
<link src="~/css/styles.css" /> 
```

**MVC 应用程序 #2**

```
<link src="http://mvcapp1.com/css/styles.css" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T19:47:13.713

好吧，我对asp.net开发了解不多，请见谅，如果不是这样，但是

如果项目中的资源文件将*Build Action*设置为**None**或**Content** and *Copy to Output Directory*设置为**Copy...**，您可以轻松创建项目的**类库**类型并将所有文件放在那里（保留路径），然后在需要文件的每个项目中引用此“类库”。每个文件都将复制到解决方案构建时的每个引用项目。

对于**嵌入式资源**构建操作，它也可以工作，但是，您需要找到一种方法来指定包含这些文件的程序集（因为它不同于`Assembly.GetEntryAssembly`）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-19T13:28:21.737

就我个人而言，我不喜欢或不希望 CDN 解决方案就像您有很多页面一样，它们依赖于 CDN 100% 的正常运行时间。经过一些研究，我发现这个解决方案非常适合我的使用，我希望谁会寻找替代方案，这是其中之一：

[http://mattperdeck.com/post/Copying-linked-content-files-at-each-build-using-MSBuild.aspx](http://mattperdeck.com/post/Copying-linked-content-files-at-each-build-using-MSBuild.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-20T19:47:00.313

# 1 - 研究 CSS 模板系统，如前所述：

SASS-Lang Less

[http://css-tricks.com/sass-vs-less/](http://css-tricks.com/sass-vs-less/)（非常好的文章开始，许多相关项目在他的相关帖子小部件中）

这些允许您以有组织的方式对样式表进行编码。您可以轻松快速地添加动态配置和全局更改。

# 2 - 开发您自己的 CSS 全局列表系统：

如果你不想使用上面的 CSS 样式表系统。例子

```
//cdn.com/assets/css/reset.css
//cdn.com/assets/css/main.css
//cdn.com/assets/css/page_home.css
//cdn.com/assets/css/page_cart.css 
```

甚至...

```
//cdn.com/assets/global/form_styles.css
//cdn.com/assets/global/global_shortcuts.css 
```

在这些中，同form padding、table和tr等padding规则。例子

```
.black{color:#000 !important}
.right{float:right}
.left{float:left} 
```

我知道我听起来像框架心态，但它有效..

您可以快速更改全局以确保更新所有页面。

CDN 存储和指南针建议也是有效的。您会看到存储在 CDN 上将省去担心应用程序故障/速度/负载的麻烦。

您的应用程序可以简单地像

```
/cloud/servers/settings/global/db
/cloud/servers/settings/global/librarys
/cloud/servers/settings/global/css_config.php (example)

/cloud/servers/1/webapp.com/
/cloud/servers/1/webapp.com/model
/cloud/servers/1/webapp.com/view
/cloud/servers/1/webapp.com/view/themes/tpl
/cloud/servers/1/webapp.com/inc

/cloud/servers/1/webapp2.com/
/cloud/servers/1/webapp2.com/model
/cloud/servers/1/webapp2.com/view
/cloud/servers/1/webapp2.com/view/themes/tpl
/cloud/servers/1/webapp2.com/inc

//cdn.com/assets/css 
```

# 3 - 方法的配置

我个人认为问题应该是关于你的整体开发方法的方法。将 CSS 放在 CDN 应用程序上，或者将 CSS 放在与 CDN 同步以用于生产实时模式的单独服务器上是一个好主意 - 将其分开并通过样式表语言进行维护会更好。然后，您可以快速使用皮肤、css 库、图像库等。使事情井井有条，更快，更好，令人愉悦，并以编码为荣。

保留它并使用更好的系统是我们所需要的。您应该使用文件夹结构 IMO 的手动和经典方法。您不必担心移动/平板电脑的响应式应用程序设计和其他轴承问题，因为更新所有应用程序甚至单个应用程序的 CSS 行 - 甚至是语言，以及与多站点开发团队打交道。

**只是我的拙见**

还强烈推荐一种 CSS 样式表语言，当然很多人讨厌它们。但是它们变得非常有用，尤其是 SAAS，它不像 NodeJS 那样大肆宣传......它确实有效。并创造奇迹。看看 TopShop、GorgeousCouture.. Arcadia 网站.. 多种语言、多种货币.. 服务器和团队在同一个跨品牌和每个商店的多个应用程序上工作..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-15T17:25:47.060

我们遇到了同样的问题，出于我们的目的，我们将所有通用 CSS/JS/Images/Layout View 放入 NuGet 包中，并在我们需要的每个应用程序中重用它。它非常适合我们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-20T19:30:31.207

如果您愿意使用 Sass，那么 Compass 扩展可能正是您所需要的。

[http://compass-style.org/help/tutorials/extensions/](http://compass-style.org/help/tutorials/extensions/)

一个扩展，当捆绑为一个 gem 时，允许您从安装了 gem 的系统上的任何位置轻松地包含 gem 中包含的样式。我最近在我的最新应用程序中使用了它（一个专门的多用户 CMS，每个用户都有自己的子域，具有自定义布局，但所有组件/小部件在整个应用程序中都具有相同的样式）。设置新子域的样式就像运行单个命令并自定义我设置的具有简单布局骨架的模板一样简单。

Compass 扩展*可*用于将图像和 JavaScript 文件作为*模板*的一部分保存，但部署的文件不会像样式那样自动更新（来自 Compass 扩展的模板与样式表不同，因为模板用于复制而样式表是用于导入）。

# asp.net-mvc - 如何在 model.property 上编写 if 语句

> ID：13978644
> 
> 赞同：0
> 
> 时间：2012-12-20T18:54:18.930
> 
> 标签：asp.net-mvc, razor

对于以下“if”语句，我收到一个错误：
“名称模型在当前上下文中不存在”。

```
 @if (model.OrderStatusId == 1)
      {

      } 
```

此行未显示错误：

```
 @Html.DisplayNameFor(model => model.OrderStatusId) 
```

'if' 语句的正确语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T18:56:12.720

```
@if (Model.OrderStatusId == 1)
      {

      } 
```

模型上的大写 M

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T18:56:22.087

您需要使用大写字母`M`才能正常工作

`Model`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T18:58:07.740

在此声明中，`Model`是您的`View`. 注意大写的**M**。

```
@if (Model.OrderStatusId == 1)
{

} 
```

这里，`model`是表达式方法参数的一部分，可以任意命名。

```
@Html.DisplayNameFor(model => model.OrderStatusId) 
```

# macos - mac上.profile中的导出路径

> ID：13978654
> 
> 赞同：22
> 
> 时间：2012-12-20T18:55:00.597
> 
> 标签：macos, terminal, profile, .profile

我不敢相信谷歌搜索后没有任何关于这个的教程。有人可以指出我的方向或解释这些行和变量在 mac 上的 .profile 中的含义吗？有人如何配置它们？

```
export PATH=/opt/local/bin:/opt/local/sbin:$PATH
# Finished adapting your PATH environment variable for use with MacPorts.
#export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:$PATH"
export PATH=$PATH:/usr/local/mysql/bin
#export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:$PATH"
#export PATH=/Applications/MAMP/Library/bin:/Applications/MAMP/bin/php5/bin:/Applications/MAMP/htdocs/cake/cake/console:/opt/local/bin:/opt/local/sbin:$PATH
export PATH=/android-sdks/platform-tools:~/android-sdks/tools:$PATH
export PATH=/Users/android-sdks/platform-tools:/Users/android-sdks/tools:$PATH 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-12-20T19:10:02.503

任何以开头的行`#`都是注释。`PATH=`设置`PATH`变量的值，$PATH 扩展为当前值，`export`开头的 使该值可用于从终端运行的程序。

假设 PATH 的初始值为`/usr/bin:/bin`.

```
export PATH=/opt/local/bin:/opt/local/sbin:$PATH 
```

替换`$PATH`为 $PATH 的先前值。所以上面设置`PATH`为

```
/opt/local/bin:/opt/local/sbin:/usr/bin:/bin 
```

向前进，

```
export PATH=$PATH:/usr/local/mysql/bin 
```

同样，将 $PATH 替换为以前的值：

```
/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/local/mysql/bin 
```

后

```
export PATH=/android-sdks/platform-tools:~/android-sdks/tools:$PATH 
```

我们有

```
/android-sdks/platform-tools:~/android-sdks/tools:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/local/mysql/bin 
```

（这`~`是一个特殊的标记，将替换为您的主目录的路径，但您应该得到图片。）

最后，之后

```
export PATH=/Users/android-sdks/platform-tools:/Users/android-sdks/tools:$PATH 
```

我们得到

```
/Users/android-sdks/platform-tools:/Users/android-sdks/tools:/android-sdks/platform-tools:~/android-sdks/tools:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/local/mysql/bin 
```

`PATH`用于查找您在命令行中输入的命令。因此，如果您键入`foo`，shell 将按照指定的顺序查找以下名称：

```
/Users/android-sdks/platform-tools/foo
/Users/android-sdks/tools/foo
/android-sdks/platform-tools/foo
~/android-sdks/tools/foo
/opt/local/bin/foo
/opt/local/sbin/foo
/usr/bin/foo
/bin/foo
/usr/local/mysql/bin/foo 
```

要查看 PATH 的当前值，请运行

```
echo $PATH 
```

您应该将新目录添加到 的开头`PATH`还是结尾？这并不总是很重要，但有时确实如此。这取决于您希望系统首先检查哪些位置。

如果目标是在查看默认目录之前搜索其他目录，则应添加到开头。例如，`git`是一个用于管理源代码的实用程序。如果我想`git`在 ~/git 中安装更新版本并默认使用*它*，我会这样做：

```
export PATH=~/git/bin:$PATH 
```

这意味着 ~/git/bin/git 将覆盖 /opt/local/bin/git。

另一方面，我可能更喜欢让管理员在`git`系统范围内安装。*如果我只想*在管理员将其提供给所有人之前使用我的本地副本，那么这更有意义：

```
export PATH=$PATH:~/git/bin 
```

在这种情况下，只有在不存在的情况下`~/git/bin/git`才会使用，因为路径中较早。`/opt/local/bin/git``/opt/local/bin`

很多命令不会存在于一个以上的地方。例如，您可以将其写入`my-backup-script`并放在 Apple Time Capsule 上`/Volumes/Capsule/scripts`。在任何其他位置调用的命令不太可能`my-backup-script`发生冲突。因此，以下任一命令都可以让您键入`my-backup-script`并运行正确的脚本：

```
export PATH=/Volumes/Capsule/scripts:$PATH 
```

或者

```
export PATH=$PATH:/Volumes/Capsule/scripts 
```

一个更好吗？我的建议是做后者。请记住，系统将需要按`$PATH`顺序搜索目录中的每个需要查找的命令。大多数命令将在本地系统上，因此将较慢的网络存储放在路径的末尾是最有意义的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-20T18:59:02.677

从[`man`页面](http://ss64.com/bash/export.html)，`export`只需设置一个环境变量。

环境变量告诉您​​的`PATH`Mac 在哪里查找您在命令行上键入的命令，按照它应该查找的顺序。它是一个路径列表，由冒号分隔。

该值`$PATH`是`PATH`环境变量的当前值。

因此，像这样的一行

```
export PATH=/foo:$PATH 
```

前置`/foo`_`PATH`

和

```
export PATH=$PATH:/foo 
```

附加`/foo`到`PATH`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-06T10:27:01.027

跑`man`

然后将问题回答为`export`

您可以查看当前`PATH`值并观察到存在多个路径。

（我的是`/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin`）

观察它`:`代表单个路径的结束。

您可以使用`$PATH`

现在，当您想在此列表中再添加一个路径时，您需要将当前路径附加到新路径，例如`/newPath:$PATH`or `$PATH:/newPath`。

最后为了保存它，你需要使用`export PATH=$PATH:/newPath`.

> 注意：此答案适用于新手开发人员。

# php - PHP CLI 处理的大型 XML 文件上的“字符串无法解析为 XML”

> ID：13978661
> 
> 赞同：2
> 
> 时间：2012-12-20T18:55:34.703
> 
> 标签：php, xml-parsing, simplexml, command-line-interface

我目前在导入大型 XML 文件时遇到问题，我不知道为什么。我们从合作伙伴那里得到一个大小约为 443MB 的 XML 输出。我得到的错误如下：

```
PHP Warning:  SimpleXMLElement::__construct(): Entity: line 1: parser error : internal error in /home/imports/catalog.php on line 54

Warning: SimpleXMLElement::__construct(): Entity: line 1: parser error : internal error in /home/imports/catalog.php on line 54
PHP Warning:  SimpleXMLElement::__construct(): ch to marriage, parenting, entrepreneurship, etc will be significantly upgraded. in /home/imports/catalog.php on line 54

Warning: SimpleXMLElement::__construct(): ch to marriage, parenting, entrepreneurship, etc will be significantly upgraded. in /home/imports/catalog.php on line 54
PHP Warning:  SimpleXMLElement::__construct():
 ^ in /home/imports/catalog.php on line 54

Warning: SimpleXMLElement::__construct():
 ^ in /home/imports/catalog.php on line 54
PHP Fatal error:  Uncaught exception 'Exception' with message 'String could not be parsed as XML' in /home/imports/catalog.php:54
Stack trace:
#0 /home/imports/catalog.php(54): SimpleXMLElement->__construct('<?xml version="...')
#1 {main}
  thrown in /home/imports/catalog.php on line 54

Fatal error: Uncaught exception 'Exception' with message 'String could not be parsed as XML' in /home/imports/catalog.php:54
Stack trace:
#0 /home/imports/catalog.php(54): SimpleXMLElement->__construct('<?xml version="...')
#1 {main}
  thrown in /home/imports/catalog.php on line 54 
```

代码的第 54 行很简单：

```
$xml = new SimpleXMLElement(file_get_contents($_CFG_XML_URL)); 
```

据我所知，错误似乎出现在包含`ch to marriage, parenting, entrepreneurship, etc will be significantly upgraded.`. 不幸的是，这对文件来说还有很长的路要走，而且由于它的大小，很难读取内容。我的大文件阅读器一次读取一行，而这个 XML 都在一行上，所以它无法优雅地处理，即使在具有 32GB RAM 和 64 位编辑器的工作站上也是如此。

我试过几次重新下载文件，但问题总是一样的。我已经将脚本的可用内存翻了一番，但它仍然在同一个地方失败。

因此，我联系了合作伙伴并要求提供此特定项目的 XML，他们提供了以下内容：

```
<EBook EAN="9792219192201">
    <Title>Success-a-Phobia</Title>
    <SubTitle>Discovering And Conquering Mankinds Most Persuasive, but Unknown, Phobia</SubTitle>
    <Publisher>The Benjamin Consulting Group, LLC</Publisher>
    <PublicationDate>29/09/2012</PublicationDate>
    <Contributors>
        <Contributor Code="A01" Text="By (author)">Benjamin, Marcus D.</Contributor>
    </Contributors>
    <Formats>
        <Format Type="6"/>
    </Formats>
    <ShortDescription>People today still desire to be successful in matters of family, finance or business even though we are in the midst of major social, political and economic challenges. Have you every been at that moment where you wanted to do something significant, yet you were paralyzed from making the necessary choices to realize your dream? Have you experienced failure and are now sitting in the stands, paralyzed from getting back in the &amp;quote;game of life?&amp;quote;  Are you at the verge of a major decision that could affect your life for many years? If you are in this category, this is your book of the year!    With humor, real-life antidotes, real-life examples and solid narration, Marcus Benjamin will guide you toward discovering the most pervasive, yet unknown, phobia in the history of mankind.  Once this phobia is discovered, the second half of the book shows you how to rid yourself of this phobia for good. Not only will this book impact your life, but your approach to marriage, parenting, entrepreneurship, etc will be significantly upgraded.</ShortDescription>
</EBook> 
```

XML 没有给我敲响任何警钟，但很明显 PHP 中途出现了问题。元素内容中似乎有 978 个字符，但这对我来说并没有敲响任何特别的警钟。

PHP 脚本从 Amazon EC2 实例中的命令行运行。操作系统是 Amazon Linux (RHEL)

所以，基本上，我被卡住了。有没有人知道什么可能导致这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:36:43.240

978可能不会响起任何铃声，但1000可能！行首有 4 个空格，然后是 18 个字符用于 '<ShortDescription>' 将提供所需的 22 个字符。像 1000 这样的整数可能会使某种缓冲区长度限制更有可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:12:31.860

尝试使用 .xml 验证 xml `xmllint`。它可用作 linux 的命令行工具。

如果文件有效。您应该仔细检查您的`memory_limit`ini var. 请记住，DOM 进程（就像简单的 xml 一样）需要将整个文件保存在内存中。在您的情况下，memory_limit 应设置为至少 500MB。

如果你不能增加你的内存限制，你将不得不考虑一种更少的内存消耗方式来解析 xml。SAX 可能适合这种情况，尽管它需要更多的编程注意。

在 PHP 中，SAX 可通过 xml 扩展获得，并且默认启用。在这里你可以找到[文档](http://php.net/manual/en/book.xml.php)

# android - 从堆栈调用活动而不是启动新实例

> ID：13978674
> 
> 赞同：1
> 
> 时间：2012-12-20T18:56:38.210
> 
> 标签：android, android-activity, stack

如何从堆栈调用活动而不是启动新实例？这是一个场景：

1.  使用参数调用活动 A 以检索数据
2.  从 A 导航到 B
3.  从 B 导航到 C
4.  我想再次启动 A 但不使用新实例，我想从堆栈中获取它，因此无需传递参数并等待检索数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:59:18.660

如果我正确理解了您的观点，您可以简单地使用 退出您的活动 B 和`finish();`C。

因此，如果您 ActivityC 完成并且 ActivityB 也完成，则 ActivityA 应该出现在前面，这应该是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:20:49.503

尝试使用[FLAG_ACTIVITY_REORDER_TO_FRONT](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_REORDER_TO_FRONT)。例如：

```
Intent intent = new Intent(BActivity.this, AActivity.class);     
intent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
startActivity(intent); 
```

来自 javadocs：

> public static final int FLAG_ACTIVITY_REORDER_TO_FRONT
> 在 API 级别 3中添加
> 
> 如果在传递给 Context.startActivity() 的 Intent 中设置，则此标志将导致已启动的活动被带到其任务历史堆栈的前面（如果它已经在运行）。
> 
> 例如，考虑一个由四个活动组成的任务：A、B、C、D。如果 D 调用 startActivity() 的 Intent 解析为活动 B 的组件，则 B 将被带到历史堆栈的前面，结果顺序为：A、C、D、B。如果还指定了 FLAG_ACTIVITY_CLEAR_TOP，则此标志将被忽略。

# objective-c - 尽管设置了配置文件，但无法在 iPhone 设备上调试

> ID：13978675
> 
> 赞同：1
> 
> 时间：2012-12-20T18:56:49.177
> 
> 标签：objective-c, ios, xcode, ios-simulator

我是 iPhone 开发新手，我正在使用**xCode 4.4.1**

1.  我已经设置了一个 Provisioning 配置文件，并且之前能够在我的 iPhone 设备上进行调试
2.  我已将设备与机器断开连接并重新启动
3.  重新连接后，我的设备不会出现在可用的方案目标上

话虽如此：

*   我已验证在我的设备上正确设置了配置文件 @ **Settings->General->Profile**
*   使用**xCode->Organizer->Devices**，我已经验证了在开发机器上正确设置了 Provisioning 配置文件。

**自从重新启动我的物理 iPhone 设备后，我无法使用它进行调试，为什么？**

任何帮助将不胜感激。

~纳达夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:59:27.277

问题是，当我尝试生成 armv6 代码时，我正在尝试使用 xcode v4.4.1，这个 xcode 版本不支持 iOS 6，因此它无法识别我的设备。

# winnovative - PDF 生成为 jpg 而不是文本。

> ID：13978676
> 
> 赞同：5
> 
> 时间：2012-12-20T18:56:49.730
> 
> 标签：winnovative

在 .net 4 上使用 Winnovative html 到 pdf 转换器 v. 6，通常 pdf 呈现为文本，并带有嵌入的图像。但有时整个文档会呈现为单个 jpeg。根本没有可选择的文本。如何控制这种行为？它似乎因服务器而异。我们无法重现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-08T08:19:11.693

Winnovative HTML to PDF converter does not use anymore IE as rendering engine and the problem described here is not present anymore in the latest version of the software available on our website for download. The converter doesn't depend anymore on any other tool for redenring. It uses its own new rendering engine compatible with WebKit.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T12:23:16.273

我找到了一个解决方法，它是在应用程序池上更改为以下设置。

![在此处输入图像描述](../Images/dbcf4717987eacf1e87404635ec65790.png)

我还升级到了组件的第 8 版，但这并没有自动解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T22:17:51.827

我们遇到了同样的问题，它发生在服务器升级时。如果升级到 IE9，要在本地重现此问题，您将看到此问题。

我们要做的是升级到当前版本（版本 8），这似乎解决了我们的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T13:48:51.637

有点旧但简单修复：对于 winnovative V8，只需从 config/WnvHtmlToPDF-v8.0.zip 安装 IE9Config.exe

在本地和服务器上为我工作

# java - 循环Java中的恒定线程数

> ID：13978677
> 
> 赞同：0
> 
> 时间：2012-12-20T18:56:56.290
> 
> 标签：java, multithreading

我正在使用 Java 中的线程编写应用程序，并且在循环中保持恒定数量的线程时遇到问题（新线程与新数据一起传入）。我使用 ExecutorService 来限制线程的数量，但是我在启动新线程时遇到了问题。

我有类似的东西：

```
ExecutorService execDownload = Executors.newFixedThreadPool(5);
UniqList<String> documentList = new UniqList<String>("startfile.txt");
        Future<UniqList<String>> future;
        while( !execDownload.isShutdown()) {
            future = execDownload.submit(new Parser(documentList.get(i)));
            i++;
            try {
                documentList.addAll(future.get());
            } catch (InterruptedException | ExecutionException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        } 
```

Parser 是一个可调用对象，它返回 UniqList。我将此列表中的元素添加到我的全局列表中，该列表是所有文档名称的集合。问题是：我希望同时运行恒定数量的解析器。如果我在程序启动之前知道所有文件的名称，那将很简单，因为如果我有 100 个文件名，我只应该调用 ExecutorService submit() 方法，即 100 次，但我不知道所有文件的名称 - 名称通过调用以下代码进行解析：

```
new Parser(documentList.get(i)) 
```

并且名称在文件中。所以再问一次问题 - 当新数据到达时，如何保持恒定数量的线程？在上面的代码中，我只有一个 Future 对象，我认为这是我最大的问题 - 我应该创建 Futures 数组吗？但是然后如何检测来自 ExecutorService 的某个线程何时刚刚返回了一些新数据......

算法应该是（我认为）：

1.  使用初始参数启动程序（第一个文档名称）
2.  项目清单
3.  通过将 Parser 类提交给 ExecutorService 来启动 Parser 类，并从开始文件中提取所有文档名称
4.  将 #2 中的文档名称添加到全局文档名称列表
5.  创建另一个线程并使用全局文档名称列表中的名称解析文档。启动最大线程数（受 ExecutorService 限制）。解析每个下一个文件并从中提取新文件名
6.  将 #3 中的名称添加到全局文档名称 List back to #4

如您所见，它就像递归。我觉得和解析网站一样的问题，1个起始节点，一级分类，二级文章等等。

链接或示例代码将非常有用。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:15:38.870

我建议放弃未来，构建解析器以了解执行者：

```
execDownload.submit(new Parser(execDownload, documentList.get(i))); 
```

让 Parser 将此“execDownload”ExecutorService 存储为成员变量。

在 Parser.run() 结束时，当您获得新解析的文档名称列表时，您可以为它们创建新的解析器，并安排它们：

```
foreach (String newDoc: UniqList)
{
     execDownload.submit(new Parser(execDownload, newDoc));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:12:53.520

您的代码几乎是连续的：future.get() 阻塞直到任务完成，因此只要前一个任务正在运行，您就无法提交新任务。您可以：

*   在一个循环中提交 N 个任务并存储未来然后尝试调用 get on one if the future 并提交一个新任务
*   但这将是重新发明轮子：[CompletionService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorCompletionService.html)似乎完全可以满足您的需求。

# java - 为什么maven突然开始用旧版本的Java编译？

> ID：13978679
> 
> 赞同：2
> 
> 时间：2012-12-20T18:57:05.747
> 
> 标签：java, maven

几天来，我一直在使用 maven 进行 Java 开发。今天我根据[这些说明](http://maven.apache.org/shared/maven-archiver/examples/classpath.html)编辑了我的 pom.xml 。突然运行`mvn compile`给了我错误，就好像我正在使用旧版本的 java 进行编译一样。像这样的东西：

> 错误：-source 1.3 不支持泛型

现在我已将 pom.xml 与其原始内容配对，但*仍然*出现此错误。我已经完成`mvn clean`并删除了目标下的所有内容，但仍然遇到这个问题。

这是运行编译阶段的 Maven 片段：

```
[INFO] 正在扫描项目...
[信息]                                                                         
[信息] --------------------------------------------- -------------------------
[INFO] 构建 bahToBeh 1.0-SNAPSHOT
[信息] --------------------------------------------- -------------------------
[信息]
[信息] --- maven-resources-plugin:2.3:resources (default-resources) @ bahToBeh ---
[警告] 使用平台编码（实际上是 UTF-8）复制过滤的资源，即构建依赖于平台！
[INFO] 跳过不存在的资源目录 /home/doug/lucid/bah-bio-demo/bahToBeh/src/main/resources
[信息]
[信息] --- maven-compiler-plugin:2.0.2:compile (default-compile) @ bahToBeh ---
[INFO] 编译 9 个源文件到 /home/doug/lucid/bah-bio-demo/bahToBeh/target/classes
[信息] --------------------------------------------- -------------------------
[信息] 构建失败
[信息] --------------------------------------------- -------------------------
[INFO] 总时间：2.880s
[INFO] 完成时间：2012 年 12 月 20 日星期四 13:52:06 EST
[INFO] 最终内存：7M/105M
[信息] --------------------------------------------- -------------------------
[错误] 无法执行目标 org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile (default-compile) on project bahToBeh: Compilation failure: Compilation failure:
[错误] /home/doug/lucid/bah-bio-demo/bahToBeh/src/main/java/com/lucid/bahdemo/parsers/pm/MeshReader.java:[23,4] 错误：不支持泛型-源 1.3

```

还有我配对的 pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.lucid</groupId>
  <artifactId>bahToBeh</artifactId>
  <packaging>jar</packaging>
  <version>1.0-SNAPSHOT</version>
  <name>bahToBeh</name>
  <url>http://maven.apache.org</url>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.8.1</version>
      <scope>test</scope>
  </dependency>
    <dependency>
      <groupId>com.digitalpebble</groupId>
      <artifactId>behemoth-core</artifactId>
      <version>1.0</version>
  </dependency>
  <dependency>
      <groupId>org.apache.hadoop</groupId>
      <artifactId>hadoop-core</artifactId>
      <version>1.0.4</version>
  </dependency>
  <dependency>
      <groupId>marc4j</groupId>
      <artifactId>marc4j</artifactId>
      <version>2.4</version>
  </dependency>
  </dependencies>
</project> 
```

直到今天，这一直运行良好。我不确定我可能更改了哪些设置或如何修改我的项目。我什至仔细检查了是否安装了正确版本的 java：

```
doug@doug-VirtualBox:~/lucid/bah-bio-demo/bahToBeh$ java -version
java版本“1.7.0_10”
Java(TM) SE 运行时环境 (build 1.7.0_10-b18)
Java HotSpot(TM) 64 位服务器 VM（内部版本 23.6-b04，混合模式）
doug@doug-VirtualBox:~/lucid/bah-bio-demo/bahToBeh$ javac -version
javac 1.7.0_10

```

这里是 JAVA_HOME

```
doug@doug-VirtualBox:~/lucid/bah-bio-demo/bahToBeh$ echo $JAVA_HOME
/usr/lib/jvm/java-7-oracle

```

Maven *IS*使用 pom.xml 我认为是，如果我运行`mvn -X compile`我得到：

> 调试] (f) 项目 = MavenProject: com.lucid:bahToBeh:1.0-SNAPSHOT @ /home/doug/lucid/bah-bio-demo/bahToBeh/pom.xml

我还删除了我的 maven repo`rm -rf ~/.m2`并看到 maven 重新下载了所有相同的问题。

**编辑——它突然神秘地工作** 了我不知道发生了什么，但现在它突然开始工作了。我认为我改变的一件事是我注释掉了一个测试。我去取消注释测试然后运行`mvn compile`，这次它编译了。某处的某些状态不同步，现在事情神奇地起作用了？

我讨厌不知道为什么我的工具突然变得不稳定，所以这不是问题的答案，只是更多信息。

**编辑——它也只是突然停止工作，** 看起来像是完全指定要编译的版本，但丁丁就是赢家。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T19:27:44.127

明确设置源和目标 java 版本。[http://maven.apache.org/plugins/maven-compiler-plugin/examples/set-compiler-source-and-target.html](http://maven.apache.org/plugins/maven-compiler-plugin/examples/set-compiler-source-and-target.html)

```
<project>
  [...]
  <build>
    [...]
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.0</version>
        <configuration>
          <source>1.7</source>
          <target>1.7</target>
        </configuration>
      </plugin>
    </plugins>
    [...]
  </build>
  [...]
</project> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T19:11:34.213

作为一种解决方法，您可以尝试这个（鉴于它非常特定于环境，这可能会有所帮助）。

您可以使用插件强制执行编译版本。 [Maven 编译插件](http://maven.apache.org/plugins/maven-compiler-plugin/examples/set-compiler-source-and-target.html)。

祝你好运！

# pandas - 将分类变量级别更改为我提供的/合并级别两个分类变量

> ID：13978682
> 
> 赞同：2
> 
> 时间：2012-12-20T18:57:18.233
> 
> 标签：pandas

下面的情况经常出现在我的数据分析中。假设我有两个数据向量，x 和 y，来自一些观察。x 有更多的数据点，因此包含一些在 y 中没有观察到的值。现在我想把它们变成分类变量。

```
x=['a','b','c','d','e']  #data points
y =['a','c','e']         #data of the same nature as x but with fewer data points  

fx = pandas.Categorical.from_array(x)
fy = pandas.Categorical.from_array(y)

print fx.index
print fy.index

Categorical: 
array([a, b, c, d, e], dtype=object)
Levels (5): Index([a, b, c, d, e], dtype=object) Categorical: 
array([a, c, e], dtype=object)
Levels (3): Index([a, c, e], dtype=object) 
```

我看到现在它们有不同的级别，标签意味着不同的东西（1 在 fx 中表示 b，但在 fy 中表示 c）。

这显然使得同时使用 fx 和 fy 的代码变得困难，因为他们期望 fx.labels 和 fy.labels 具有相同的编码/含义。

但是我看不到如何“规范化” fx 和 fy 以使它们具有相同的级别并`fx.lables`具有`fy.lables`相同的编码。`fy.labels = fx.lables`显然不起作用。如下所示，它将标签 [ace] 的含义更改为 [abc]。

```
fy.levels = fx.levels
print fy

Categorical: 
array([a, b, c], dtype=object)
Levels (5): Index([a, b, c, d, e], dtype=object) 
```

有没有人有任何想法？

另一个相关场景是我有一个现有的已知索引，并且希望将数据分解到该索引中。例如，我知道每个数据点都必须采用五个值之一 [a, b, c, d, e] 并且我已经有一个索引`Index([a, b, c, d, e], dtype=object)`并且我想分解向量 y=['a','c' ,'e'] 转换为一个分类变量，`Index([a, b, c, d, e], dtype=object)`其级别为。我也不确定如何做到这一点，并希望知道的人提供一些线索。

PS在R中做这样的事情是可能的但很麻烦。

谢谢，汤姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:28:22.027

```
In [6]: fxd = {fx.levels[i]: i for i in range(len(fx.levels))}

In [7]: fy.labels = [fxd[v] for v in fy]

In [8]: fy.levels = fx.levels

In [9]: fy
Out[9]: 
Categorical: 
array([a, c, e], dtype=object)
Levels (5): Index([a, b, c, d, e], dtype=object) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T12:40:21.587

该`get_indexer()`方法可用于创建索引数组：

```
x=['a','b','c','d','e']  #data points
y =['a','c','e']         #data of the same nature as x but with fewer data points  
idx = pd.Index(pd.unique(x+y))
cx = pd.Categorical(idx.get_indexer(x), idx)
cy = pd.Categorical(idx.get_indexer(y), idx) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-24T07:12:33.217

关于加勒特的回答：在我的熊猫版本（0.20.3）中`fx.levels`引发了一个 AttributeError: 'Categorical' object has no attribute 'levels'，但有效的是：

```
missing_levels = set(fx) - set(fy)
fy = fy.add_categories(missing_levels) 
```

或`inplace=True`（快一点）：

```
missing_levels = set(fx) - set(fy)
fy.add_categories(missing_levels, inplace=True) 
```

# jquery - jQueryUI 可排序和可拖动目标不会水平滚动以进行放置，但会进行排序

> ID：13978686
> 
> 赞同：2
> 
> 时间：2012-12-20T18:57:36.447
> 
> 标签：jquery, jquery-ui, scroll, draggable, jquery-ui-sortable

我有两个包含多个 div 并且可以滚动的 div。我有一个垂直 div，它在包含的 div 上有可拖动的。我的水平 div 是可排序的，我通过 connectToSortable 将可拖动对象连接到它。

重新排列项目时，水平排序可以水平滚动。但是，如果我从垂直拖动到水平，它不会像我进行纯排序时那样滚动水平 div。

我已经阅读了此处的所有条目，用于使用 scrollTo 和衍生工具等插件滚动 div，但它们对我的特定问题没有帮助。我正在使用 jQuery 1.8.3 和 jQuery UI 1.9.2

我可以放入视口，但我希望我的用户能够像排序时那样拖动并让水平滚动工作。如果我放在可见区域然后排序，它将滚动 div。

谢谢！

```
$(".playboxresults, .playboxrecommended").draggable({
        revert: "invalid",
        opacity: 0.95,
        containment: 'document',
        connectToSortable: "#divCurrentList",
        helper: function () {
            $copy = $(this).clone();
            return $copy;
        },
        appendTo: 'body',
        scroll: true,
        start: function (e, ui) {
            draggedItem = ui.item;
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T09:09:04.217

这是因为当您使用 append to body 时，helper 成为 body 的一部分，因此不会滚动水平 div。

[我也正在实现此功能，并通过sdespont](https://stackoverflow.com/users/1109988/sdespont)找到了解决方法

```
helper: function(){
     $('#horizontalDiv').append('<div id="clone">' + $(this).html() + '</div>');
     $("#clone").hide();
     setTimeout(function(){
         $('#clone').appendTo('body');
         $("#clone").show();
     },1);
     return $("#clone");
}, 
```

这首先使您的水平 div 的助手部分，然后将其附加到正文。

希望这可以帮助。

你也可以参考[这个](https://stackoverflow.com/questions/14241994/jquery-ui-draggable-not-scrolling-the-sortable-container)

# vb.net - DataTable.Select.Where VB.Net - 删除行

> ID：13978687
> 
> 赞同：2
> 
> 时间：2012-12-20T18:57:38.130
> 
> 标签：vb.net, datatable, where, delete-row

我目前正在使用不允许篡改的查询来提取信息：

```
Dim dt As DataTable = BLL.GetData(variable).Tables(0) 
```

紧接着，我将删除字段以特定值开头的所有记录：

```
For Each dr As DataRow In dt.Rows
    If dr.Item(2).ToString().StartsWith("value") Then
        dr.Delete()
    End If
Next 
```

我真正想做的是：

```
dt.Select.Where(field1 => field1.StartsWith("value")).Delete() 
```

我知道这不是它的语法，我可能与它的样子很不一样。`For Each`工作正常，我只是想“简化”它。任何想法？任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:00:04.803

实际上，您的初始代码可能是最干净和最直接的。

要使用 LINQ 删除项目，您首先需要将它们读入一个单独的集合，然后遍历该集合并在每条记录上调用 Delete。如果你宁愿走那条路，你可以尝试：

```
Dim records = dt.Rows.Where(Function(r) r.StartsWith("value")).ToList()
For Each r In records
    r.Delete()
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-03T20:43:18.320

我认为您正在寻找的答案来自微软。[https://msdn.microsoft.com/en-us/library/det4aw50(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2](https://msdn.microsoft.com/en-us/library/det4aw50(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2)

暗表作为 DataTable = DataSet1.Tables("Orders")

```
' Presuming the DataTable has a column named Date.
Dim expression As String
expression = "Date > #1/1/00#"
Dim foundRows() As DataRow

' Use the Select method to find all rows matching the filter.
foundRows = table.Select(expression)

Dim i As Integer
' Print column 0 of each returned row.
For i = 0 to foundRows.GetUpperBound(0)
   Console.WriteLine(foundRows(i)(0))
Next i 
```

# opencv - 平衡拼接图像之间的对比度和亮度

> ID：13978689
> 
> 赞同：7
> 
> 时间：2012-12-20T18:57:47.400
> 
> 标签：opencv, computer-vision, brightness, contrast

我正在做一个图像拼接项目，我知道处理图像的对比度和亮度有不同的方法。我当然可以在缝合图像之前处理这个问题，但结果并不像我希望的那样一致。所以我的问题是，是否有可能在拼接后“平衡”或“均衡”彩色图片的对比度和亮度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T13:47:43.240

您不想从整个图像中确定直方图均衡函数，而是在它们将接触或重叠的区域上确定。您显然希望在重叠区域具有相同的直方图，因此这是您计算函数的地方。然后，您可以在整个图像上应用实现此目的的均衡函数。如果您有两个以上的针迹，您仍然希望事先进行全局均衡，然后使用重叠均衡函数的加权应用程序，以减少您远离缝合边缘时的影响。

抱歉，如果这对您来说已经很明显了，但是您的一般性问题使我得到了一般性的答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T15:54:03.003

你可能想看看OpenCV 提供的[Exposure Compensator 类。](http://docs.opencv.org/modules/stitching/doc/exposure_compensation.html)

曝光补偿分三步完成：

1.  创建您的曝光补偿器

    `Ptr<ExposureCompensator> compensator = ExposureCompensator::createDefault(expos_comp_type);`

2.  您输入所有图像以及每个图像的左上角。默认情况下，您可以将蒙版完全保留为白色，除非您想指定要处理的图像的某些部分。

    `compensator->feed(corners, images, masks);`

3.  现在它具有图像如何重叠的所有信息，您可以单独补偿每个图像

    `compensator->apply(image_index, corners[image_index], image, mask);`

补偿后的图像将存储在`image`

# c - strcpy-sse2-unaligned.S 未找到

> ID：13978692
> 
> 赞同：20
> 
> 时间：2012-12-20T18:57:56.117
> 
> 标签：c

我正在编译下面的简单代码，并在 gdb 中运行它。我在 strcpy 行设置了一个断点，一旦我为输入例如 abc 运行它，然后按 s，我得到以下错误：

```
Breakpoint 1, main (argc=2, argv=0x7fffffffdd98) at ExploitMe.c:9
9           strcpy(buffer, argv[1]);
(gdb) s
__strcpy_sse2_unaligned () at ../sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S:48
48  ../sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S: No such file or directory. 
```

我正在使用 ubuntu 12.04 AMD64 和 gcc 2.15。任何的想法？

* * *

```
main(int argc, char *argv[]) {

    char buffer[80];

    strcpy(buffer, argv[1]);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-20T19:21:28.863

在调试时忽略这些“错误”是完全无害的。

错误只是因为 GDB 正在寻找`strcpy`函数的来源。libc 中您没有源代码的任何函数都会出现类似的错误，例如：

```
int *p = malloc(sizeof *p); 
```

然后...

```
(gdb) s
5       int *p = malloc(sizeof *p);
(gdb) s
__GI___libc_malloc (bytes=4) at malloc.c:2910
2910    malloc.c: No such file or directory. 
```

您可以随时下载 GNU libc 的源代码并将其与 GDB 链接：

```
git clone https://github.com/jeremie-koenig/glibc /opt/src/glibc 
```

然后...

```
(gdb) dir /opt/src/glibc/malloc
(gdb) s
5       int *p = malloc(sizeof *p);
(gdb) s
__GI___libc_malloc (bytes=4) at malloc.c:2910
2910              }
(gdb) s
2915          } else if (!in_smallbin_range(size)) 
```

...这将让您逐步了解`malloc`的源代码。它不是特别有用，但有时会派上用场。

# android - 使用 OpenCV 进行运动检测

> ID：13978700
> 
> 赞同：5
> 
> 时间：2012-12-20T18:58:19.977
> 
> 标签：android, opencv, motion-detection

我看到与 opencv 运动检测相关的查询，但我的要求要简单得多，所以我再次问这个问题。我想分析视频帧，看看帧中是否发生了变化。帧中发生的任何类型的运动都已被识别。我只想在有事情发生时得到通知。我不需要跟踪/绘制轮廓。

**尝试**：

1) 使用 OpenCV (TM_CCORR_NORMED) 进行模板匹配。

我使用 cvMinMaxLoc & 得到相似度指数

```
if( sim_index > threshold ) 
    "Nothing chnged"
   else
    "Changed 
```

**面临的问题**：

我找不到决定如何设置阈值的方法。错误匹配和完美的值非常接近。

2) 方法2
a) 做移动平均
b) 取当前帧和移动平均之间的绝对差。
c）对其进行阈值化并使其成为二进制
d）计算非零值的数量
再次陷入如何设置阈值的问题，因为即使对于非常相似的帧，我也会得到大量的非零值。

请告诉我我应该采取什么方法。我是否使用上述两种方法朝着正确的方向前进，或者是否有一种简单的方法可以在所有最通用的情况下工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T13:40:27.823

方法 2 通常被认为是最简单的运动检测方法，如果您的视频中没有水、摇曳的树木或高度可变的照明条件，则非常有效。通常你是这样实现的：

```
motion_frame=abs(newframe-running_avg);
running_avg=(1-alpha)*running_avg+alpha*newframe; 
```

如果需要，您可以对motion_frame 设置阈值，然后计算非零值。但是您也可以将motion_frame 的元素和阈值相加（确保使用浮点数）。为此优化参数非常简单，只需制作两个轨迹栏并使用它。通常 alpha 约为 [0.1; 0.3]。

最后，在整个帧上执行此操作可能有点矫枉过正，您可以只使用二次采样版本，结果将非常相似。

# excel - 计算范围内与不同单元格内容匹配的单元格数

> ID：13978701
> 
> 赞同：17
> 
> 时间：2012-12-20T18:58:20.847
> 
> 标签：excel, worksheet-function, countif

我试图`COUNTIF`在 Excel 中使用来查找范围中有多少项与单独单元格的内容匹配。这个想法是，范围包含每个人对给定问题的答案（一个单词，非数字的答案）；比较列包含正确答案。我想知道有多少人答对了。

我试过：`=COUNTIF(C16:BT16,"=BU16")`

但它似乎`COUNTIF`不允许我引用其中包含条件的单元格 - 它需要直接在公式中匹配条件，例如`=COUNTIF(C16:BT16,"DEN")`. 当然，我可以这样做，但是每次评估答案时我都必须编辑几十个公式，如果我可以在 BU 列中输入答案，那么耗时会少得多。

我也试过`COUNTIFS`；它允许多个条件，但也不允许将条件引用到不同的单元格。也搜索了几个不同的 Excel 网站，有什么建议吗？非常感谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-20T19:05:42.677

尝试从中删除引号和等号`"=BU18"`- 这将表明您正在该单元格中传递值，我相信这就是您正在寻找的。

```
=COUNTIF(C16:BT16,BU18) 
```

假设`BU18`包含`DEN`. 您的第一个示例 ( `"=BU18"`) 是说“如果这些单元格中的任何一个具有 的值，则计数`"=BU18"`，这将不匹配任何内容（除非他们回答了一些奇怪的问题 :)）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T19:05:49.863

试试这个：

```
=COUNTIF(C16:BT16;BU18) 
```

请注意，您可能需要使用“;” 而不是“，”，具体取决于您所在的地区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T19:08:50.407

*   如果你使用 Excel 2010，你会更幸运[`COUNTIFS`](http://office.microsoft.com/en-sg/excel-help/countifs-function-HA010047494.aspx)

*   无论如何，您可以使用搜索范围和匹配范围[`countif`](http://www.techonthenet.com/excel/formulas/countif.php)

    例如`=COUNTIF(SEARCH RANGE, CRITERIA RANGE)`

# maven - ClassNotFoundException Netbeans Maven 库包装器

> ID：13978715
> 
> 赞同：1
> 
> 时间：2012-12-20T18:59:00.953
> 
> 标签：maven, wrapper, netbeans-platform

我能够按照[这里](http://netbeans.dzone.com/how-to-nb-djnative-swing)的教程并将其转换为 Maven 应用程序。

我得到了正确的加载部分，但是当我尝试使用它时，它找不到合适的 swt 类（从 Windows 64 运行时）。我是在一个 Maven 项目上做的。这是 Windows 64 模块的相应 pom 的相关部分：

```
 <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>nbm-maven-plugin</artifactId>
                <extensions>true</extensions>
                <configuration>
                    <!-- To have the jar plugin pickup the nbm generated manifest -->
                    <useDefaultManifestFile>true</useDefaultManifestFile>
                    <moduleType>normal</moduleType>
                    swt.windows.64/1</codeNameBase>
                    <publicPackages>
                        <publicPackage>org.eclipse.swt</publicPackage>
                    </publicPackages>
                </configuration>
            </plugin> 
```

我翻译成 org.eclipse.swt.*。这似乎是一个 Maven 模块问题，因为它已经尝试从正确的模块加载。

```
Caused: java.lang.ClassNotFoundException: org.eclipse.swt.SWT starting from ModuleCL@25e0dee5[djproject.core] with possible defining loaders [ModuleCL@6783113b[swt.windows.64]] and declared parents [ModuleCL@32821bf7[org.netbeans.api.annotations.common]]

Caused: java.lang.NoClassDefFoundError: org/eclipse/swt/SWT
    at chrriis.dj.nativeswing.swtimpl.core.SWTNativeInterface.initialize_(SWTNativeInterface.java:213)
    at chrriis.dj.nativeswing.swtimpl.NativeInterface.initialize(NativeInterface.java:71)
    at chrriis.dj.nativeswing.swtimpl.core.SWTNativeInterface.open_(SWTNativeInterface.java:337)
    at chrriis.dj.nativeswing.swtimpl.NativeInterface.open(NativeInterface.java:100)
    at synamicd.windows64.support.Windows64BrowserProvider.initialize(Windows64BrowserProvider.java:25) 
```

任何帮助都非常受欢迎！

**编辑：** 代码可[在此处](https://javydreamercsw@bitbucket.org/javydreamercsw/multi-os-swt-netbeans-support)获得。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T07:37:18.970

当我尝试在 bitbucket 位置构建应用程序时，它的构建顺序表明应用程序中没有使用任何 swt 模块 - [http://screencast.com/t/LMxIPy6A6ZUL](http://screencast.com/t/LMxIPy6A6ZUL)

# ios - kCLAuthorizationStatusRestricted 显示在我的一个应用程序中，但在同一设备上没有显示另一个应用程序

> ID：13978724
> 
> 赞同：5
> 
> 时间：2012-12-20T18:59:28.367
> 
> 标签：ios, core-location

我有一个我正在维护的应用程序，它最近停止报告用户位置。这发生在以前工作的许多设备上。在我的设备上，我确定 CLLocationManager 的身份验证状态为 kCLAuthorizationStatusRestricted。这会阻止应用程序提示用户许可。

我没有围绕核心位置设置任何限制，我的另一个运行完全相同的帮助类来管理位置的应用程序在同一设备上运行良好。它会提示用户许可。

有谁知道除了限制之外会导致 kCLAuthorizationStatusRestricted 出现的任何事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T01:37:04.723

在“设置”应用程序（在 iOS 6 中）中，查看“常规”下的“限制”。如果启用了限制，则向下滚动到隐私部分。这是为定位服务设置限制的地方。

这是与第一个屏幕上的隐私部分不同的一组隐私限制，可以使用密码锁定。

# mysql - 在 SQL 中查找重复的值对

> ID：13978726
> 
> 赞同：3
> 
> 时间：2012-12-20T18:59:39.173
> 
> 标签：mysql, select, group-by

我有一个数据库，它使用用户 ID 存储名字和姓氏。该表如下所示：

```
uid value
1   Fred
1   Keller
2   Tim
2   LaChef
3   Adam
3   Adam 
```

有一个副本`uid`很好，但我想找到所有具有相同名字和姓氏的条目？像`uid`3\. 任何 SQL 想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-20T19:04:16.907

试试这个：

```
SELECT uid FROM tablename 
GROUP BY uid, name HAVING COUNT(*) = 2; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T19:33:17.047

要仅返回每个“重复”的单个副本，则：

```
SELECT t.uid
     , t.value
  FROM mytable t
 GROUP
    BY t.uid
     , t.value
HAVING COUNT(1) > 1
 ORDER
    BY t.uid
     , t.value 
```

要返回重复的“所有”条目，而不仅仅是一份副本，并且如果您不需要返回任何 NULL 值，则：

```
SELECT a.uid
     , a.value
  FROM mytable a
  JOIN ( SELECT t.uid
              , t.value
           FROM mytable t
          GROUP
             BY t.uid
              , t.value
         HAVING COUNT(1) > 1
       ) d
     ON d.uid = a.uid
    AND d.value = a.value
  ORDER
     BY a.uid
      , a.value 
```

* * *

如果您确实想返回 NULL（其中 NULL 是重复的），则将 ON 子句中的比较运算符更改为 null 安全的相等比较： `<=>`

```
 ON d.uid <=> a.uid
    AND d.value <=> a.value 
```

# php - joomla 中的 php 或 javascript 搜索

> ID：13978727
> 
> 赞同：0
> 
> 时间：2012-12-20T18:59:38.497
> 
> 标签：php, javascript, joomla

我希望你们能帮助我，我相信它很简单。

我想制作一个 joomla 模块或使用允许我添加 Javascript 或 Php 的自定义模块之一（不确定我需要使用哪个）。

我想要做的是有一个文本框，当那个人在该文本框中输入内容时，它会转到该页面。

例如：我在文本框中输入：房屋出租

然后将打开的页面是：www.mywebsite.com/somesearch/house for rent

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:06:52.653

问题很模糊。因此，与其提供所有代码来制作自己的代码，我建议您使用诸如[RokAjaxSearch 之](http://www.rockettheme.com/extensions-joomla/rokajaxsearch)类的扩展，它是一个强大的搜索模块，它使用 Ajax 来防止页面刷新。它还可以选择包含 Google 结果。

***更新***

您还可以使用默认的 Joomla 搜索模块。在 Joomla 后端，在**Components**（顶部菜单）下，转到**Smart Search**，然后单击ton 选项卡上的**Search Filter 。**添加一个新过滤器并设置为**Search All**。完成后，转到**模块管理器**并打开**智能搜索**模块。为模块设置一个位置并选择您之前创建的过滤器。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:20:39.237

这个问题不是很清楚，但假设页面 www.mywebsite.com/somesearch/searchtext 正在解析为可以访问 URL 中的查询字符串并使用 searchtext 处理搜索的页面，您可以执行以下操作：

```
<html>
<head>
<script>
$('#searchButton').click(function(){
   var searchText = document.getElementById('searchBox').value;
   window.location.href = 'http://www.mywebsite/somesearch/'+encodeURIComponent(searchText);
})
</script>
</head>
<body>
<input type='text' id='searchBox' />
<input type='submit' id='searchButton' value='Search' />
</body>
</html> 
```

您可以使用可让您编写 JavaScript、HTML 或 PHP 代码的可用模块之一作为此处列出的模块：http: [//extensions.joomla.org/extensions/edition/custom-code-in-modules](http://extensions.joomla.org/extensions/edition/custom-code-in-modules)

如果你这样做，你可以跳过 html、head 和 body 标签。只需放置`<script>...</script>`，然后`input`.

还要小心直接处理用户输入，而不是逃避可能的 sql 注入攻击。

# java - JavaFX、tableview 和数据库表

> ID：13978729
> 
> 赞同：3
> 
> 时间：2012-12-20T18:59:54.090
> 
> 标签：java, javafx-2, javafx

我目前正在使用 JavaFX 显示来自 SQL Server 数据库的数据。我根据数据库中一个表的内容创建了一个 TableView。数据库表是 Products 的集合，所以 TableView 声明为：

```
@FXML
private TableView<Products> productTable; 
```

TableView 中的每一行都声明如下：

```
@FXML
private TableColumn<Products, String> productName; 
```

每列都有一个 ValueFactory，其中包含一个 PropertyValueFactory，它将数据从数据库映射到列。现在我真正想做的是让我的表包含来自 2 个数据库表的数据，因为产品和成本表之间存在一对一的关系。但是，我还没有找到一个聪明的方法来做到这一点。

有人有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:34:27.927

如果您已经定义了 Products 模型与这些表模型的关系，则可以编写自定义单元格值工厂。在下面的代码中，“产品的成本和模型”列使用 2 个相关的表格模型来呈现其单元格，即成本和模型。

```
TableColumn<Person, String> costAndModelCol = new TableColumn<Person, String>("Cost and Model of the product");
costAndModelCol.setCellValueFactory(new Callback<TableColumn.CellDataFeatures<Person, String>, ObservableValue<String>>() {
    public ObservableValue<String> call(TableColumn.CellDataFeatures<Person, String> p) {
        return SimpleStringProperty(p.getValue().getCost().getValue() + " (model: "+ p.getValue().getModel().getYear() +")");
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T02:14:50.713

另一个可能适用于您的问题的解决方案是将两个表中的数据组合成一个 JDBC 连接的 RowSet 对象，然后使用 jdbcRowSet 对象作为 TableView 的数据源。您可以轻松编写一个 SQL 查询，将您需要的两个表中的数据组合到一个行集对象中。

不是将数据从数据库映射到 TableView，而是从行集对象映射到 TableView。当然，只有当您能够自己对数据库执行 SQL 查询时，才能使用此解决方案。如果您仅限于通过数据访问对象或其他 CRUD 方法访问数据库，那么这不适用于您的情况。

# python - 从 python 读取 /etc/fstab 条目

> ID：13978731
> 
> 赞同：0
> 
> 时间：2012-12-20T19:00:05.463
> 
> 标签：python

是否有一个知道如何解析`fstab`文件的python包？也许类似于`getmntent(3)`in `linux`。

诚然，用 python（或`awk(1)`等）来理解这一点并不难，但我想知道那个轮子是否已经被发明了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:10:13.323

一个简单的谷歌搜索会给你这个：

[https://launchpad.net/python-fstab](https://launchpad.net/python-fstab)

# asp.net - ASP.Net MVC3 SessionState 超时

> ID：13978744
> 
> 赞同：0
> 
> 时间：2012-12-20T19:01:25.833
> 
> 标签：asp.net, session-state, session-timeout

我把它设置为 120 分钟，但它不会持续那么长时间。我不确定它会持续多久，但我知道它不是 2 小时。

```
<sessionState timeout="120" /> 
```

这仅在默认的 Web.config 中设置，而不是在 Views 目录或 Web.Debug.config 或 Web.Release.config 中的设置。

由于默认会话超时为 20 分钟，这会有所不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:04:43.153

为保证您的会话不会因 w3wp.exe 崩溃或应用程序池回收而终止，您应该将会话状态移动到单独的存储中。最简单的是 ASP.Net State Server 服务。确保在主机上启动服务并将其添加到您的 web.config 中：

```
<sessionState mode="StateServer"
    stateConnectionString="tcpip=SampleStateServer:42424"
    cookieless="false"
    timeout="120"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T03:41:39.427

**我认为你应该定义会话状态模式**

ASP.NET 中有不同的会话状态 [http://msdn.microsoft.com/en-us/library/ms178586(v=VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms178586(v=VS.80).aspx)

**In-Process Mode** 默认为`<sessionState mode="InProc" timeout="10" />`, 重建项目后会话将被清除

**State Server Mode** 我们可以用这个，但是记得打开服务——ASP.NET State Service

```
<sessionState mode="StateServer"
  stateConnectionString="tcpip=localhost:42424"
  sqlConnectionString="data source=.\SQLEXPRESS; User ID=sa;Password=12345678; Integrated Security=SSPI"
  cookieless="false"
  timeout="2"
/> 
```

**SQL Server 模式**我们可以在通过命令创建 DB ASPSate 后使用它，请查看此站点以获取详细信息 - [http://www.brianstevenson.com/blog/aspstate-concurrently-running-for-net-1011-and-net- 20](http://www.brianstevenson.com/blog/aspstate-concurrently-running-for-net-1011-and-net-20)

```
<sessionState mode="SQLServer"
  stateConnectionString="tcpip=localhost:63586"
  sqlConnectionString="data source=.\SQLEXPRESS; User ID=sa;Password=12345678; Integrated Security=SSPI"
  cookieless="false"
  timeout="2"
/> 
```

State Server Mode & SQL Server Mode 下的会话在重建项目后不会被清除，有利于开发

# zend-framework2 - ZF2：如何在 Module 类中的事件上附加监听器？

> ID：13978748
> 
> 赞同：0
> 
> 时间：2012-12-20T19:01:32.760
> 
> 标签：zend-framework2, zend-framework-mvc, zend-framework-modules, zend-framework-routing

`basePath`对于给定的请求，我想为我的 Mvc 的每个组件设置相同的 a。我的意思是当我调用这些方法时，我想得到相同的结果，让我们说`'/spam/ham/'`：

```
echo $this->headLink()->prependStylesheet($this->basePath() . '/styles.css')  // $this->basePath() has to be '/spam/ham/'

$this->getServiceLocator()
     ->get('viewhelpermanager')
     ->get('headLink')
     ->rependStylesheet($this->getRequest()->getBasePath() . '/styles.css')   // $this->setRequest()->getBasePath() has to be /spam/ham/ 
```

如何设置`basePath`我已经找到的第一个案例，[这是我的问题](https://stackoverflow.com/questions/13955426/zf2-how-can-i-set-basepath-to-be-the-same-for-a-whole-application)。顺便说一句，原始手册没有我从答案中收到的任何信息。

现在第二个 -`basePath`必须设置在`Request`：

```
$this->getRequest()->getBasePath() 
```

在这里，我找到了一些实际上根本不起作用的答案[http://zend-framework-community.634137.n4.nabble.com/Setting-the-base-url-in-ZF2-MVC-td3946284.html](http://zend-framework-community.634137.n4.nabble.com/Setting-the-base-url-in-ZF2-MVC-td3946284.html)。如前所述[，此处](http://zf2.readthedocs.org/en/latest/modules/zend.event-manager.event-manager.html#quick-start) `StaticEventManager`已弃用，因此我将其更改为`SharedEventManager`：

```
// In my Application\Module.php

namespace Application;
use Zend\EventManager\SharedEventManager

    class Module {
        public function init() {             

                $events = new SharedEventManager(); 
                $events->attach('bootstrap', 'bootstrap', array($this, 'registerBasePath')); 
            } 

            public function registerBasePath($e) { 

                $modules = $e->getParam('modules'); 
                $config  = $modules->getMergedConfig(); 
                $app     = $e->getParam('application'); 
                $request = $app->getRequest(); 
                $request->setBasePath($config->base_path); 
            } 
        } 
    } 
```

在我的`modules/Application/configs/module.config.php`我添加：

```
'base_path' => '/spam/ham/' 
```

但它不起作用。问题是：

1）运行永远不会到达`registerBasePath`函数。但它必须。我在`init`函数中附加了一个带有监听器的事件。

2）当我改变它`SharedEventManager`恰好`EventManager`来到`registerBasePath`函数但抛出异常时：

```
Fatal error: Call to undefined method Zend\EventManager\EventManager::getParam() 
```

我做错了什么？为什么程序运行不来`registerBasePath`函数？如果这是设置`basePath`全局的唯一方法，那么该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:59:34.283

我知道文档缺少这些东西。但是您的方法是正确的：

1.  早点（所以在引导程序中）
2.  从应用程序中获取请求
3.  在请求中设置基本路径

文档缺少此信息，并且您引用的帖子很旧。最快和最简单的方法是使用以下`onBootstrap()`方法：

```
namespace MyModule;

class Module
{
    public function onBootstrap($e)
    {
        $app = $e->getApplication();
        $app->getRequest()->setBasePath('/foo/bar');
    }
} 
```

如果要从配置中获取基本路径，可以在此处加载服务管理器：

```
namespace MyModule;

class Module
{
    public function onBootstrap($e)
    {
        $app = $e->getApplication();
        $sm  = $app->getServiceManager();

        $config = $sm->get('config');
        $path   = $config->base_path;

        $app->getRequest()->setBasePath($path);
    }
} 
```

# wordpress - 为 wordpress 中的专业插件提供自动更新

> ID：13978749
> 
> 赞同：2
> 
> 时间：2012-12-20T19:01:38.237
> 
> 标签：wordpress

我想实现 WordPress pro 插件自动更新功能。

我的插件是专业的，所以它在 WordPress 插件目录中不可用。我找到了一些解决方案，但是当我当时向用户提供更新功能时，WordPress 提供了查看版本信息链接并打开了一个带有插件更新详细信息的模型，但还包含安装插件按钮。

我不希望在 WordPress 打开模型以获取插件更新信息时显示该按钮。

请帮助我，我在 Google 上花费了太多时间，但没有找到任何合适的解决方案。

任何形式的帮助表示赞赏。

谢谢

# slickgrid - 在 SlickGrid 中使用带有 autoEdit:true 的 CellSelectionModel

> ID：13978752
> 
> 赞同：1
> 
> 时间：2012-12-20T19:01:53.317
> 
> 标签：slickgrid

我的网站上有一个 SlickGrid，并实现了一些复制/粘贴功能。这要求我使用 CellSelectionModel，这要求我将网格的 autoEdit 设置为 false。

我希望 autoEdit 是真实的，并且仍然能够使用我的选择模型。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T19:52:24.807

您可以使用 autoEdit true 来获得复制/粘贴功能。我有它。

您可以在这里自己尝试：http: [//labs.nereo.com/SlickGrid/examples/example-excel-compatible-spreadsheet.html](http://labs.nereo.com/SlickGrid/examples/example-excel-compatible-spreadsheet.html)

现在，使用 javascript 控制台，编写：

```
grid.setOptions({autoEdit:true}) 
```

您仍然可以复制/粘贴。选择一系列单元格更加困难......（你不能有任何活跃的单元格，没有更多的发展）。

但是，简短的回答是，你可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-29T18:59:29.417

我知道这是一个老歌，但如果有人仍然在这个问题中运行......在 CellExternalCopyManager.init() 中查找以下行并将它们删除或注释掉。代码上方有一条注释解释了它为什么存在，但我无法重现它在删除时描述的问题。我多年来一直在使用这个解决方案，没有人报告任何问题。

> cellSelectionModel.onSelectedRangesChanged.subscribe(function(e, args){ _grid.focus(); });

# java - 错误用户输入 Java 的异常处理

> ID：13978754
> 
> 赞同：3
> 
> 时间：2012-12-20T19:01:55.290
> 
> 标签：java, exception, try-catch, user-input, java.util.scanner

我需要帮助 使用错误的用户输入进行异常处理。我正在创建一个基于文本的游戏，它欢迎用户，然后进入主菜单。然后它告诉用户选项，然后寻找用户输入。出于某种原因，每当我输入 1 或 2 时，它都会显示：“您的输入无效，请重试”并返回选择。我不知道我到底哪里出错了，希望有人能帮助我。此外，它也不会捕获不匹配异常。希望你能帮忙！谢谢，山丹

```
 public static void main(String[] args) {

    System.out.println("Welcome to Spec Ops!");
    System.out.println("Please state your name:");
    Scanner name = new Scanner(System.in);
    String Name = name.next();

    System.out.println("Hello "+Name);
    mainMenu();

    }

public static void mainMenu() {

    System.out.println("1\. Story Mode");
    System.out.println("2\. Infinant Combat");

    Scanner input = new Scanner(System.in);

    Object Selection = input.nextInt();

    boolean validOption = true;
    Integer x;

    try {
    x = (Integer)Selection;
    } catch(ClassCastException cce){
        System.out.println("Your input is invalid, please try again");
        validOption = false;
    } catch(InputMismatchException ime){
        System.out.println("Your input is invalid, please try again");
        validOption = false;

    }

if(validOption) {
    System.out.println("Hello!");
}

else {
    mainMenu();
}

} 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T19:10:00.460

Scanner.nextInt 返回 ant int，因此无需 go `Object selection = scanner.nextInt()`，然后强制转换为 int，您只需将`int selection = scanner.nextInt()`其包围在 try catch 中即可 chatches `java.util.InputMismatchException`，这是用户键入字母而不是数字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:22:25.037

您可以临时更改代码并使用 Pokemon 异常处理并检查堆栈跟踪以查看您应该实现哪种异常：

```
try {
    //do something
} catch(Exception e) {
    //Gotta catch 'em all!
    e.printStackTrace();
} 
```

一旦你知道确切的异常，放置一些断点并相应地重构你的代码。

此外，您不必通过更改 catch 块内的布尔变量来控制程序的流程：

```
boolean isValidOption = false;
Integer x;

try {
     x = (Integer)Selection;
     isValidOption = true;
} catch... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T19:35:45.490

当您阅读名称时，您正在使用scanner.next()。这不会读取行尾字符，因此当您调用scanner.nextInt() 时，它会读取新行并且无法解析为int。

您应该将读取的名称更改为scanner.nextLine()，如果您想处理来自用户的无效int 输入，则对nextInt 的调用需要在您的try 块中并捕获InputMismatchException 而不是ClassCastException。

# javascript - JavaScript：在 hashchange 上按名称调用函数

> ID：13978756
> 
> 赞同：0
> 
> 时间：2012-12-20T19:02:01.927
> 
> 标签：javascript, jquery, hashchange

我正在尝试调用给定哈希字符串中的函数名称的函数。我有以下代码：

```
$(window).on('hashchange', function() {
  //alert(location.hash.substring(1, location.hash.length));
  window[location.hash.substring(1, location.hash.length)];
});

function test() {
  alert('123!');
} 
```

有趣的是，当我取消注释`alert`呼叫时，一切都按预期工作。但是，当`alert`被评论时，它不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:04:40.027

```
window[location.hash.substring(1, location.hash.length)]; 
```

不调用函数。

如果你想调用名字为 的函数`location.hash.substring(1, location.hash.length)`，你可以这样做

```
window[location.hash.substring(1, location.hash.length)](); 
```

**边注 ：**

```
location.hash.substring(1, location.hash.length) 
```

可以缩短为

```
location.hash.slice(1) 
```

# objective-c - 如何解析 cocos2D 的 xml 文件

> ID：13978763
> 
> 赞同：-1
> 
> 时间：2012-12-20T19:02:41.517
> 
> 标签：objective-c, xcode, cocos2d-iphone

我正在尝试在我的项目的资源文件夹中解析一个 xml 文档。该项目是一个 cocos2D 项目，我正在尝试创建某种类型的方法来解析 xml 文件以加载我的游戏的关卡。

解析文档的最佳方法是什么？一个例子会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:06:09.570

你可以在 cocos2d 中使用任何 Objective-c XML 解析器，
我建议你使用[TBXML](http://www.tbxml.co.uk/TBXML/TBXML_Free.html)
但不要在你`xml`的`plist`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T01:27:54.443

如果 1) 解析速度和 2) 从 xml 文件中检索数据的便利性很重要 3) 您不介意 C++ 接口，那么最适合您的解析器是开源的： [http ://code.google.com/p /pugixml/](http://code.google.com/p/pugixml/)

**pugixml**是一个轻量级的 C++ XML 处理库。它具有： • 具有丰富遍历/修改功能的类 DOM 接口 • 极快的非验证 XML 解析器，它从 XML 文件/缓冲区构造 DOM 树 • **XPath 1.0 实现，用于复杂的数据驱动的树查询** • 使用 Unicode 完全支持 Unicode接口变体和自动编码转换 该库非常便携，**易于集成和使用**。

我已经针对其他解析器测试了速度和内存使用情况，并使用了过去 5 年。文档在这里： http: [//pugixml.googlecode.com/svn/tags/latest/docs/quickstart.html](http://pugixml.googlecode.com/svn/tags/latest/docs/quickstart.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-21T09:06:19.120

即使帖子很旧，我也在这里写下解决方案，以帮助将来像我这样的其他人。解决方案很简单： - 第 1 步：使用 FileUtils 读取文件内容 - 第 2 步：将文件内容解析为 tinyxml2（支持我已尝试并成功在 cocos2d 3.8 中加载和读取 XML 文件

```
#include "tinyxml2/tinyxml2.h"

auto s = FileUtils::getInstance()->getStringFromFile("data.xml");
tinyxml2::XMLDocument *pDoc = new tinyxml2::XMLDocument();
tinyxml2::XMLError errorId = pDoc->Parse(s.c_str(), s.size());
if (errorId == 0) {
     // Write your code here
} 
```

data.xml 放置在 Resource 文件夹中。

请阅读[http://www.cocos2d-x.org/docs/manual/framework/native/v3/xml-parse/zhparse/zh](http://www.cocos2d-x.org/docs/manual/framework/native/v3/xml-parse/zhparse/zh)了解如何迭代 tinyxml2 XMLDocument。请注意，您不能使用此链接中的教程从文件加载。它总是返回 ERROR_FILE_NOT_FOUND。

# java - 以编程方式创建的相同类型和名称的文件

> ID：13978764
> 
> 赞同：0
> 
> 时间：2012-12-20T19:02:45.633
> 
> 标签：java, ftp, filesystems

我的应用程序如何设法上传（到 FTP 服务器）相同名称和类型的文件的副本，而不是覆盖第一个文件？

```
2012-11-09.log      52  Text Document       11/9/2012 8:44:00 PM        -rw-rw-r--
2012-11-09.log      49  Text Document       11/9/2012 8:41:00 PM        -rw-rw-r--
2012-11-09.log      59  Text Document       11/9/2012 8:44:00 PM        -rw-rw-r--
2012-11-09.log      53  Text Document       11/9/2012 8:41:00 PM        -rw-rw-r--
2012-11-09.log      57  Text Document       11/9/2012 8:40:00 PM        -rw-rw-r-- 
```

我如何写入 FTP 服务器并没有什么特别之处。这是一个Java片段：

```
String dest = "ftp://[USERNAME]:[PASSWORD]@[FTP].com/DR/"+Util.putDateStamp() + ".log";
u = new URL(dest);
uc = u.openConnection();
uc.setDoOutput(true);
OutputStream outgoing = uc.getOutputStream();

outgoing.write(dataToSend.getBytes());
outgoing.close(); 
```

我无法重命名或删除文件，因为它会引发错误“找不到文件”。不幸的是，我重现它的努力符合预期——它覆盖了第一个同名文件。所以，我无法重现该错误。请记住，我在 FTP 服务器上的权限有限。它不是我的。我最后的手段是告诉管理员我以某种方式损坏了它。这没什么大不了的，但不知道它是怎么发生的真的让我很困扰。我意识到当文件不唯一时有一个用于重命名文件的 FTP 命令，但这不是问题。

我的问题是：这是怎么发生的，因为我无法重现它，我怎样才能避免再次这样做？

来自 Util 的代码：

```
public static String putDateStamp(){
    String currentdate = "";
    Calendar cal = Calendar.getInstance();
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
    currentdate = sdf.format(cal.getTime());
    return currentdate;
} 
```

**编辑：**

服务器操作系统：UNIX 类型：L8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T14:05:31.877

已解决 - 基本上 Filezilla 不允许在文件名中转义空格，也不显示空格。因此自定义命令`DEL " filename.log"`会引发 file-not-found 错误。

这些文件的名称前有不同数量的空格，可能是使用 JDatePicker 后在表单中输入的。

这些文件正在使用不同的 FTP 客户端删除。

# javascript - 需要更简单的方法来用 HTML 等价物替换嵌套的自定义标签

> ID：13978766
> 
> 赞同：6
> 
> 时间：2012-12-20T19:02:46.587
> 
> 标签：javascript, regex

我正在寻找一种方法来用它们的 HTML 等价物正确替换嵌套的自定义标签。例如，假设我们有以下文本：

```
This is {b:bold text} 
```

应该变成：

```
This is <b>bold text</b> 
```

我知道我可以 - 并且可能应该 - 使用带有“粗体”类的跨度之类的东西，而不是旧的“b”标签，但出于本示例的目的，我坚持使用“b”是有原因的. 我可能有嵌套标签：

```
This is {b:bold text and {i:italic}} 
```

应该变成：

```
This is <b>bold text and <i>italic</i></b> 
```

但是，我有这些正则表达式（与 replace() 函数一起使用）：

```
/\{b:([\s\S]*?)\}/gm
/\{i:([\s\S]*?)\}/gm 
```

然后结果会变成：

```
This is <b>bold text and <i>italic</b></i> 
```

标签未正确嵌套。同样，在这种情况下，使用 span 可以解决这个问题，但是对于诸如“ul”、“li”、“h1”之类的东西不起作用……如果文本看起来像这样，贪婪的正则表达式也会导致问题：

```
This is {b:bold text} and {i:italic} 
```

所以我目前的解决方案是先用 span 替换所有内容，使用 data-tag 属性来指示它实际上应该是什么，然后使用 jQuery 查找所有 span 节点并用适当的标签替换它们：

```
{h:This is a header}
becomes
<span data-tag='h1'>This is a header</span>
becomes
<h1>This is a header</h1> 
```

它运作良好，但我想知道是否有更简单的方法来做到这一点。中间方法感觉有点像胶带解决方案，我想“美化”它。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:26:09.447

一个简单的堆栈有很长的路要走

```
function doReplace( str ) {
    var stack = [],
        ret = [],
        ch;
    for( var i = 0, l = str.length; i < l; ++i ) {
        var ch = str.charAt(i);

        if( ch === "{" ) {
            var pos = str.indexOf( ":", i+1);
            if( pos < 0 ) {
                throw new SyntaxError();
            }
            var tagName = str.substring( i + 1, pos);
            if( /[^A-Za-z0-9]/.test(tagName)) {
                throw new SyntaxError();
            }
            ret.push( "<" + tagName + ">" );
            stack.push( tagName);
            i+= tagName.length + 1;
        }
        else if( ch === "}" ) {
            if( !stack.length ) {
                throw new SyntaxError();
            }
            var tagName = stack.pop();
            ret.push( "</" + tagName + ">" );
        }
        else {
            ret.push( ch );
        }
    }

    if( stack.length ) {
        throw new SyntaxError();
    }

    return ret.join("");
}

doReplace( "This is {b:bold text {i:italic text{i:italic text{i:italic text{i:italic text{i:italic text{i:italic text}}}}}}}")
//"This is <b>bold text <i>italic text<i>italic text<i>italic text<i>italic text<i>italic text<i>italic text</i></i></i></i></i></i></b>" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:06:40.443

抛弃正则表达式并使用许多模板工具之一，例如[Mustache](http://mustache.github.com/)或[t.js](https://github.com/jasonmoo/t.js)。

**编辑：** *固定！*

...但是，如果您要避免生活中的这种简单性，那么以下是使用正则表达式的方法：

```
var rex = /\{(b|i):([^{}]*)\}/igm,
    parse = function(txt) {
        var cnt = 0,
            more = true;
        while (more) {
            txt = txt.replace(rex, function(match, $1, $2) {
                return "<" + $1 + ">" + $2 + "</" + $1 + ">";
            });
            more = rex.test(txt);
            cnt++;
        }
        return txt;
    }; 
```

因此，您调用`parse`并将其传递给您的字符串。它递归地解析您的字符串，直到找不到其他标记。这个新的反向工作，解析出其中*没有*项目的项目，然后向外移动。

要实现您添加的 H1 示例，您可以代替我们`{h1:This is the header}`并将其添加到子句中，或者在替换函数中`(b|i)`使用语句而不是仅返回 $1。`switch`

这是[JSFiddle](http://jsfiddle.net/Hc5GR/3/)。

# java - JBoss：无法连接到 MySQL 数据库

> ID：13978767
> 
> 赞同：2
> 
> 时间：2012-12-20T19:02:48.177
> 
> 标签：java, mysql, jboss, jboss7.x, mysql-connector

我`JBoss`作为独立版本运行。我想连接到我的本地`mysql database`

我在模块文件夹中复制了 mysql 连接器

```
me@air~/Downloads/jboss/standalone/configuration - 10:56:18  $ ls ../../modules/org/mysql/main/
mysql-connector-java-5.1.22-bin.jar 
```

接下来我将`standalone.xml`in更改`jboss/standalone/configuration`为

```
 <drivers>
                    <driver name="com.mysql" module="org.mysql" />
                    <driver name="h2" module="com.h2database.h2"> <!-- default provided-->
                        <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>
                    </driver>
                </drivers> 
```

然后我将数据源添加为

```
 <datasource jndi-name="java:/bb" pool-name="bb-pool" enabled="true" use-java-context="true" use-ccm="true">
                    <connection-url>jdbc:mysql://127.0.0.1:3306/mydb</connection-url>
                    <driver>mysql</driver>
                    <pool>
                        <min-pool-size>10</min-pool-size>
                        <max-pool-size>100</max-pool-size>
                        <prefill>true</prefill>
                    </pool>
                    <security>
                        <user-name>bb</user-name>
                        <password>bb</password>
                    </security>
                    <statement>
                        <prepared-statement-cache-size>100</prepared-statement-cache-size>
                        <share-prepared-statements>true</share-prepared-statements>
                    </statement>
                </datasource> 
```

我正在使用`JBoss AS 7.1`. 当我在控制台上启动服务器时，我看到了错误

```
10:54:47,458 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-1) JBAS010400: Bound data source [java:jboss/datasources/ExampleDS]
10:54:47,671 INFO  [org.jboss.as.controller] (Controller Boot Thread) JBAS014774: Service status report
JBAS014775:    New missing/unsatisfied dependencies:
      service jboss.jdbc-driver.mysql (missing) dependents: [service jboss.data-source.java:/bb] 

10:54:47,676 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015951: Admin console listening on http://127.0.0.1:9990
10:54:47,676 ERROR [org.jboss.as] (Controller Boot Thread) JBAS015875: JBoss AS 7.1.1.Final "Brontes" started (with errors) in 2000ms - Started 134 of 212 services (2 services failed or missing dependencies, 74 services are passive or on-demand) 
```

当我击球时`Ctrl+C`，我看到了

```
^C10:54:54,998 INFO  [org.jboss.as.osgi] (MSC service thread 1-8) JBAS011942: Stopping OSGi Framework
10:54:55,004 INFO  [org.jboss.as.logging] JBAS011503: Restored bootstrap log handlers
10:54:55,007 INFO  [com.arjuna.ats.jbossatx] ARJUNA032018: Destroying TransactionManagerService
10:54:55,008 INFO  [com.arjuna.ats.jbossatx] ARJUNA032014: Stopping transaction recovery manager
10:54:55,010 INFO  [org.apache.catalina.core.StandardContext] Container org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/] has not been started
10:54:55,039 INFO  [org.apache.coyote.http11.Http11Protocol] Pausing Coyote HTTP/1.1 on http--127.0.0.1-8080
10:54:55,039 INFO  [org.apache.coyote.http11.Http11Protocol] Stopping Coyote HTTP/1.1 on http--127.0.0.1-8080
10:54:55,043 INFO  [org.jboss.as.controller] JBAS014774: Service status report
JBAS014776:    Newly corrected services:
      service jboss.jdbc-driver.mysql (new available)

10:54:55,044 INFO  [org.jboss.as] JBAS015950: JBoss AS 7.1.1.Final "Brontes" stopped in 47ms 
```

我是 JBoss 的新手，不知道如何解决此问题或了解我在这里做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T17:16:33.550

首先，您的驱动程序定义名称与`<datasource>`定义下的驱动程序名称不匹配。替换`<driver name="com.mysql" ...`为`<driver name="mysql" ...`使其工作。

第二，你添加了`module.xml`文件吗？复制文件夹中的 MySQL 连接器 jar 是不够的`./modules/com/mysql/main`，您还必须添加`module.xml`文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<module xmlns="urn:jboss:module:1.1" name="com.mysql">
  <resources>
    <resource-root path="mysql-connector-java-5.1.26-bin.jar"/>
  </resources>
  <dependencies>
    <module name="javax.api"/>
    <module name="javax.transaction.api"/>
  </dependencies>
</module> 
```

此外，在使用 MySQL 连接器版本 5.0.8 时，我遇到了一个类似的问题，其中找不到/识别驱动程序。当我切换到更新的 5.1.26 版本时它消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T04:19:15.907

我认为在您的数据源中您引用了驱动程序`mysql`，但您命名了驱动程序`com.mysql`。

尝试将驱动程序名称更改为`mysql`.

请注意：最好使用 CLI 安装驱动程序并使用 CLI 或 Web 控制台构建数据源。使用 AS7 的目的是这些工具用于您的所有配置，您应该自己接触 XML 的理由很少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T02:24:34.403

我犯了完全相同的错误。我花了几个小时才知道它有多愚蠢。

在我的情况下，我在 jboss-as 用户下将 jboss 作为服务运行，既好又简单。除了当我创建 mysql/main 目录以及其中的文件时，我在另一个用户下。jboss-as guy 没有权限。

modules/ 目录上的一个简单的 chown 完成了这项工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-12T14:23:48.010

确保您使用的是最新版本`mysql jdbc connector`，我通过更换最新的 mysql 连接器解决了我的相同问题

# java - SQLite 数据库未更新

> ID：13978773
> 
> 赞同：0
> 
> 时间：2012-12-20T19:03:34.363
> 
> 标签：java, android, sqlite

我有一个活动，如果以前不存在数据库，我想创建一个数据库并在其中输入数据。否则，我想更新之前输入的值。

我试图通过实现'if-else'来做到这一点。

这是在两种可能性之间进行选择的代码：

```
public void submitusername(View view) {
    userdatabase name = new userdatabase(this);
    name.open();
    String user = name.getusername();
    name.close();

    EditText cinone = (EditText) findViewById(R.id.username);
    username = cinone.getText().toString();

    if(user == null){
        userdatabase entry = new userdatabase(Editprofile.this);
        entry.open();
        entry.createEntry(username, null, null, null);
        entry.close();

        Context context = getApplicationContext();
        CharSequence text = "Added new user!";
        int duration = Toast.LENGTH_LONG;

        Toast toast = Toast.makeText(context, text, duration);
        toast.show();

    } else {
        userdatabase update = new userdatabase(Editprofile.this);
        update.open();
        update.updateUsername(username);
        update.close();

        Context context = getApplicationContext();
        CharSequence text = "Username updated!";
        int duration = Toast.LENGTH_SHORT;

        Toast toast = Toast.makeText(context, text, duration);
        toast.show();
    }
} 
```

这是从数据库中调用“用户名”的方法：

```
public String getusername() {                                                               
    String[] columns = new String[]{USER_NAME};
    Cursor c = userDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);

    String result = "";

    int iName = c.getColumnIndex(USER_NAME);

    for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {
        result = result + c.getString(iName);
    }

    return result;
} 
```

更新用户名的方法：

```
public void updateUsername(String name) {                                                       
    ContentValues cvUpdate = new ContentValues();
    cvUpdate.put(USER_NAME, name);

    userDatabase.update(DATABASE_TABLE, cvUpdate, KEY_ROWID + "=" + 0 , null);
} 
```

**我遇到的问题是，** 当我运行程序并且数据库不存在（没有用户名）时，单击按钮时，我仍然得到 toast “用户名已更新”并且没有插入数据。当它明确应该创建数据库时，第一次插入用户名并显示吐司“添加新用户！”

此外，如果我删除了“if-else”条件，则不检查现有数据而只保留“createEntry”部分一切正常；数据被正确插入。所以，这意味着我的“createEntry”部分是正确的。

可能是什么问题呢？我已经在其他活动中实现了 getusername() 并且效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:18:06.933

更改代码后尝试：

```
 userdatabase name = new userdatabase(Editprofile.this);
    name.open();
    String user = name.getusername();
    name.close();

    EditText cinone = (EditText) findViewById(R.id.username);
            username = cinone.getText().toString();

  if(user.equals("")){

        //your code here
    }

    else {
          //your code here
    } 
```

并将您的`getusername()`方法更改为：

```
public String getusername() {                                                               
    String[] columns = new String[]{USER_NAME};
    Cursor c = userDatabase.query(DATABASE_TABLE, 
                                         columns,
                     null,
                     null,
                     null,
                     null,
                     null);

    String result = "";
    c.moveToFirst();
    if(c.getCount()>0){

      int iName = c.getColumnIndex(USER_NAME);

      for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {

        result = result + c.getString(iName);
       }
     }
    return result;
} 
```

# c++ - 如何避免#include 对外部库的依赖

> ID：13978775
> 
> 赞同：17
> 
> 时间：2012-12-20T19:03:44.947
> 
> 标签：c++, dependencies, static-libraries, header-files

如果我正在创建一个带有如下头文件的静态库：

```
// Myfile.h

#include "SomeHeaderFile.h" // External library

Class MyClass
{

// My code

}; 
```

在我自己的项目中，我可以告诉编译器（在我的例子中是 Visual Studio）在哪里寻找 SomeHeaderFile.h。但是，我不希望我的用户关心这一点——他们应该能够包含我的头文件，而不必通知*他们的*编译器 SomeHeaderFile.h 的位置。

这种情况一般如何处理？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-20T19:25:30.843

这是一个经典的“编译防火墙”场景。有两个简单的解决方案：

1.  从外部库前向声明您需要的任何类或函数。然后仅在您的 cpp 文件中包含外部库的头文件（当您实际需要使用您在头文件中前向声明的类或函数时）。

2.  使用 PImpl 成语（或 Cheshire Cat），您可以在其中前向声明一个“实现”类，该类您仅私下声明和定义（在 cpp 文件中）。您使用该私有类来放置所有依赖于外部库的代码，以避免在您的公共类（在您的头文件中声明的那个）中有任何痕迹。

这是使用第一个选项的示例：

```
#ifndef MY_LIB_MY_HEADER_H
#define MY_LIB_MY_HEADER_H

class some_external_class;  // forward-declare external dependency.

class my_class {
  public:
    // ...
    void someFunction(some_external_class& aRef);  // declare members using the forward-declared incomplete type.
};

#endif

// in the cpp file:

#include "my_header.h"
#include "some_external_header.h"

void my_class::someFunction(some_external_class& aRef) {
  // here, you can use all that you want from some_external_class.
}; 
```

以下是选项 2 的示例：

```
#ifndef MY_LIB_MY_HEADER_H
#define MY_LIB_MY_HEADER_H

class my_class_impl;  // forward-declare private "implementation" class.

class my_class {
  private:
    std::unique_ptr<my_class_impl> pimpl; // a vanishing facade...
  public:
    // ...
};

#endif

// in the cpp file:

#include "my_header.h"
#include "some_external_header.h"

class my_class_impl {
  private:
    some_external_class obj;
    // ...
  public:
    // some functions ... 
};

my_class::my_class() : pimpl(new my_class_impl()) { }; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T19:21:16.420

假设外部头文件包含以下内容：

外部.h

```
class foo
{
public:
   foo();
}; 
```

在您的库中，您使用 foo：

我的头文件.h：

```
#include "external.h"

class bar
{
...
private:
   foo* _x;
}; 
```

要编译您的代码，您所要做的就是转发声明 foo 类（之后您可以删除包含）：

```
class foo;

class bar
{
...
private:
   foo* _x;
}; 
```

然后，您必须在源文件中包含 external.h。

# regex - mod_rewrite：后向引用可以被引用两次吗？

> ID：13978780
> 
> 赞同：4
> 
> 时间：2012-12-20T19:04:04.480
> 
> 标签：regex, apache, mod-rewrite

我有一个重写规则（在 Apache htaccess 文件中），它试图从一次捕获（$1）中使用两次反向引用：

```
RewriteRule ^([A-Za-z0-9_-]+)/?$ $1.php?nav=$1 
```

查询字符串似乎是空的，比如

```
example.com/new 
```

被重写为

```
example.com/new.php?nav= 
```

我想要的是

```
example.com/new.php?nav=new 
```

我的问题：我可以在表达式中引用两次 $1 吗？

**更新：**

mod_rewrite 上的 Apache[文档](http://httpd.apache.org/docs/current/rewrite/intro.html)表明您可以在重写规则的替换部分中多次引用捕获。但是，在尝试了几天后，我无法使其工作。我确实让我的规则通过了在线正则表达式测试器，但不在我的网站上。最后我重新设计了我的菜单系统，以便我可以使用更简单的重写规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:10:28.263

您使用的这个正则表达式是错误的：

```
^(A-Za-z0-9-_)$ 
```

范围仅允许在方括号中，并且您需要使用`+`访问器来匹配超过 1 个字符。

将您的 RewriteRule 替换为：

```
RewriteRule ^([a-z0-9_-]+)/?$ $1.php?nav=$1 [L,NC,QSA] 
```

# jsf - 标签库支持命名空间：http://richfaces.org/rich，但没有为名称定义标签：dataList

> ID：13978781
> 
> 赞同：2
> 
> 时间：2012-12-20T19:04:09.223
> 
> 标签：jsf, richfaces, datalist

我已经定义了名称空间 xmlns:rich="http://richfaces.org/rich"，但仍然收到错误消息“标签库支持名称空间：[http](http://richfaces.org/rich) ://richfaces.org/rich ，但没有为名称：数据列表”。

这是代码：

```
<rich:dataList var="var" value="#{backingBean.value}" rows="5">
   <h:outputText value="#{var.property1}"/>
</rich:dataList> 
```

知道为什么会这样。

谢谢，拉维

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T18:36:24.377

该`dataList`组件在版本 4.0.0 中已弃用。从[迁移指南](http://docs.jboss.org/richfaces/4.0.X/4.0.0.Milestone5/Migration_Guide/en-US/html_single/#sect-Migration_Guide-Deprecated_components_and_behaviors-richdataList_richdataDefinitionList_and_richdataOrderedList)：

```
The functionality of the old <rich:dataList>, <rich:dataDefinitionList>, and 
<rich:dataOrderedList> components is now available through the 
<rich:list> component. 
```

您应该能够使用该`list`组件。

另一种确认标签库可用的方法是检查提供它们的 jar 文件中的标签库定义。例如，您应该能够引用richfaces-components-ui.jar:META-INF/rich.taglib.xml 文件来查看该特定版本可用的标签和属性。

# python - 如何将给定的行“i”或列“j”与标量相乘？

> ID：13978789
> 
> 赞同：4
> 
> 时间：2012-12-20T19:04:44.637
> 
> 标签：python, numpy

```
import numpy as np

M = np.matrix([
        [-1,-2,-3],
        [-4,-5,-6]
    ])

print(M) 
```

1.  如何将给定的行`i`或列`j`与标量相乘？
2.  如何将给定的列或行作为列表访问？
3.  如何设置给定的列或行，给定一个列表（适当的长度）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T19:08:11.017

要乘以特定列：

```
M[:,colnumber] *= scalar 
```

或一行：

```
M[rownumber,:] *= scalar 
```

当然，将它们作为可迭代访问是一回事：

```
col_1 = M[:,1] 
```

虽然，这给了你一个新的矩阵，而不是一个`list`. 虽然，老实说，我似乎无法弄清楚所有这些与`matrix`对象的操作——而且这些看起来并不像`matrix`类型操作。您是否有理由使用`matrix`而不是`array`对象？如果你想要矩阵乘法，你总是可以使用`np.dot(array_mat1, array_mat2)`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T19:08:24.043

您可以使用[切片](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing)来完成此操作：

```
>>> M = np.matrix([
...         [-1,-2,-3],
...         [-4,-5,-6]
...     ])
>>> M[1,:] *= 2          # multiply all elements in second row by 2
>>> M
matrix([[ -1,  -2,  -3],
        [ -8, -10, -12]])
>>> M[:,1] *= 2          # multiply all elements in second column by 2
>>> M
matrix([[ -1,  -4,  -3],
        [ -8, -20, -12]]) 
```

要将给定的列或行分配给列表：

```
>>> M[:,1] = [[0], [0]]        # note the nested lists to reassign column
>>> M
matrix([[ -1,   0,  -3],
        [ -8,   0, -12]])
>>> M[1,:] = [2, 2, 2]         # flat list to reassign row
>>> M
matrix([[-1,  0, -3],
        [ 2,  2,  2]]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:11:29.817

**使用 Python 2.7**

1）您可以将一行或一列乘以`s`这样的标量：

```
M[i, :] *= s
M[:, j] *= s 
```

2）您可以像这样访问行或列：

```
M[i, :]
M[:, j] 
```

3）您可以将行或列设置为这样的列表`l`：

```
M[i, :] = l
M[:, j] = l 
```

请注意，在最后一个中，您的列表（如果您要设置列）必须是列表中的列表（即外部列表充当行，内部列表充当列）。

# xml - 使用 XSLT 从 param 获取确切的单词？

> ID：13978790
> 
> 赞同：2
> 
> 时间：2012-12-20T19:04:46.110
> 
> 标签：xml, xslt, xpath

我正在尝试从参数中选择一些文本并将其放入变量中，该变量只有纯文本。

```
<xsl:variable name="Underline">
  <xsl:choose>
    <xsl:when test="contains($style-name, 'u')">true</xsl:when>
  </xsl:choose>
</xsl:variable> 
```

此参数 ( *$style-name* ) 的值可以是来自于**strike、em、u、strong、sub 和sup 的任何值或它们的组合。**

`$style-name: "strike em u sub"`

问题是当我使用上面的代码时，它也认为**sub**和**u**是相同的，因为它找到了字符 u。这就是包含的本质。

*我在这里做了一些研究：*

[http://www.w3.org XPATH](http://www.w3.org/TR/xpath/#section-String-Functions)

[XPath 只返回包含文本的元素，而不是它的父元素](https://stackoverflow.com/questions/2994198/xpath-to-return-only-elements-containing-the-text-and-not-its-parents)

但我找不到任何适合我的东西。如果您需要更多信息，请告诉我。

这也只是 XSLT 1.0。我正在使用 Visual Studio 2012，我不是 100% 确定引擎是什么。

我可以提供输入，但它超出了问题的范围，它只是一个子问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:12:43.460

**XSLT 2.0 解决方案**

分解成一系列标记并使用以下方法进行比较`=`：

```
<xsl:when test="tokenize($style-name,' ') = 'u')">true</xsl:when> 
```

这会将所有以空格分隔的标记转换为一个序列，并且`= 'u'`如果任何标记匹配“u”，则将匹配。

**XSLT 1.1 解决方案**

```
<xsl:template name="tokenize">
  <xsl:param name="token" />
  <xsl:param name="text"/>
  <xsl:if test="string-length($text)">
     <token><xsl:value-of select="substring-before(concat($text,$token),$token)"/></token>
     <xsl:call-template name="tokenize">
       <xsl:with-param name="text" select="substring-after($text,$token)"/>
       <xsl:with-param name="token" select="$token"/>
     </xsl:call-template>
  </xsl:if>
</xsl:template>

...

<xsl:variable name="tokens">
  <xsl:call-template name="tokenize">
     <xsl:with-param name="text" select="$style-name"/>
     <xsl:with-param name="token" select="' '"/>
  </xsl:call-template>
</xsl:variable>

<xsl:when test="$tokens/token = 'u'">true</xsl:when> 
```

**XSLT 1.0 解决方案**

需要包含在每个主要 XSL 处理器（包括 MSXSL）中的扩展。将此命名空间声明添加到您的样式表：

```
xmlns:msxsl="urn:schemas-microsoft-com:xslt" 
```

并更改@test：

```
<xsl:when test="msxsl:node-set($tokens)/token = 'u'">true</xsl:when> 
```

对于 ESLT 感知处理器（Saxon、xsltproc、Xalan-J、jd.xslt 和 4XSLT），使用`xmlns:exsl="http://exslt.org/common"`和`exsl:node-set()`. 对于 Xalan-C 使用`xmlns:xalan="http://xml.apache.org/xalan"`和`xalan:nodeset()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-20T22:35:04.277

这实际上不需要标记化。它应该像这样简单：

```
<xsl:variable name="Underline">
  <xsl:if test="contains(concat(' ',$style-name,' '),' u ')">true</xsl:if>
</xsl:variable> 
```

或者甚至更好

```
<xsl:variable name="Underline">
  <xsl:if test="contains(concat(' ',normalize-space($style-name),' '),' u ')">true</xsl:if>
</xsl:variable> 
```

也就是说，如果保证您有一个空格分隔的列表。

# android - 同步 Google Chrome 书签 Android

> ID：13978795
> 
> 赞同：1
> 
> 时间：2012-12-20T19:04:58.873
> 
> 标签：android, google-chrome, bookmarks

我一直在尝试找到某种方法来从 Android 读取 Google Chrome 的书签（不是 Google 的书签）。我正在尝试开发一个不需要在浏览器上安装插件即可同步的应用程序。书签。顺便说一句，我知道一个名为 CMarks 的应用程序已经完成了我需要的工作，但我想自己学习如何做。

问题是我还没有找到办法。我的问题与我认为的[这个](https://stackoverflow.com/questions/6315545/where-are-google-chrome-sync-bookmarks-stored)问题有关，但它没有“答案”。

我发现[了这个](http://www.chromium.org/developers/design-documents/sync)，这应该是谷歌浏览器同步的方式。书签，但我看不到实现它的方法（没有 OAuth 端点或我理解的任何东西）。

如果有人能指出我正确的方向（教程、手册等），那就太好了。我在 Google 上找到的所有内容都与 Google Chrome 插件有关，但与外部应用程序（Java、Android、C++ 等）无关。

我使用 fiddler 查看 GChrome 同步时的连接位置。它似乎连接到 Google Talk。

# oracle - 线表列大小更改时，如何更改物化视图列大小？

> ID：13978796
> 
> 赞同：7
> 
> 时间：2012-12-20T19:05:00.830
> 
> 标签：oracle, oracle11g

线表列大小更改时，如何更改物化视图列大小？这是 Linux 上的 oracle 11gR2 db。我尝试重新编译MV，它没有工作。请不要将此问题自动迁移到另一个数据库站点，我想留在 stackoverflow 中。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-21T04:16:28.990

如果您更改表，您还必须更改物化视图。

```
--Create simple table and materialized view
create table test1(a varchar2(1 char));
create materialized view mv_test1 as select a from test1;

--Increase column width of column in the table
alter table test1 modify (a varchar2(2 char));

--Insert new value that uses full size
insert into test1 values('12');

--Try to compile and refresh the materialized view
alter materialized view mv_test1 compile;
begin
    dbms_mview.refresh(user||'.MV_TEST1');
end;
/

ORA-12008: error in materialized view refresh path
ORA-12899: value too large for column "JHELLER"."MV_TEST1"."A" (actual: 2, maximum: 1)
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 2563
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 2776
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 2745
ORA-06512: at line 3

--Increase column width of column in the materialized view and refresh
alter materialized view mv_test1 modify (a varchar2(2 char));
begin
    dbms_mview.refresh(user||'.MV_TEST1');
end;
/
select * from mv_test1;
A
--
12 
```

# android - Android 光标崩溃

> ID：13978797
> 
> 赞同：2
> 
> 时间：2012-12-20T19:05:06.273
> 
> 标签：android, cursor

我在 web 和 stackoverflow 上搜索过，但找不到我需要的解决方案。在我的应用程序中，我将加速度计坐标值记录到数据库中，然后当用户单击按钮时，它会将其写入文件并为此坐标值生成一些特征（如标准偏差、平均值、最大值、最小值等）给定时间间隔）最后，它也将此功能写入文件。但是，当我尝试生成这些功能并将其写入文件时，它崩溃并给出了它。

```
Failed to read row 0, column -1 from a CursorWindow which has 1 rows, 1 columns.
FATAL EXCEPTION: main
java.lang.IllegalStateException: Couldn't read row 0, col -1 from CursorWindow.  Make sure the Cursor is initialized correctly before accessing data from it.
    at android.database.CursorWindow.nativeGetDouble(Native Method)
    at android.database.CursorWindow.getDouble(CursorWindow.java:543)
    at android.database.CursorWindow.getFloat(CursorWindow.java:594)
    at android.database.AbstractWindowedCursor.getFloat(AbstractWindowedCursor.java:81)
    at com.example.coordinates.MainActivity.generateFeatures(MainActivity.java:259)
    at com.example.coordinates.MainActivity.dosyayaYaz(MainActivity.java:239)
    at com.example.coordinates.MainActivity.onDialogPositiveClick(MainActivity.java:668)
    at com.example.coordinates.dialogFragement$1.onClick(dialogFragement.java:54)
    at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:167)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4898)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
    at dalvik.system.NativeStart.main(Native  Method) 
```

这是我认为我得到错误的地方。

```
private void generateFeatures(String label){

        boolean bitti=false;

        Cursor firstTimeHandler=db.rawQuery("SELECT MIN(zaman) FROM Koordinatlar", null);
        firstTimeHandler.moveToFirst();

        float firstTime= firstTimeHandler.getFloat(firstTimeHandler.getColumnIndex("zaman"));
        float nextTime=firstTime+3000;

        Cursor lastTimeHandler=db.rawQuery("SELECT MAX(zaman) FROM Koordinatlar", null);
        lastTimeHandler.moveToFirst();

        float lastTime=lastTimeHandler.getFloat(firstTimeHandler.getColumnIndex("zaman"));

        while(!bitti){

            calculateAverage(firstTime,nextTime);
            calculateStandartDev(firstTime,nextTime);
            calculateAverageAbsoluteDifferance(firstTime,nextTime);
            calculateAverageResultant(firstTime,nextTime);
            calculateMax(firstTime,nextTime);

            firstTime=nextTime;
            nextTime=nextTime+3000;

            if(nextTime>=lastTime){
                nextTime=lastTime;

                calculateAverage(firstTime,nextTime);
                calculateStandartDev(firstTime,nextTime);
                calculateAverageAbsoluteDifferance(firstTime,nextTime);
                calculateAverageResultant(firstTime,nextTime);
                calculateMax(firstTime,nextTime);

                bitti=true;

            }

        }

        dosyayaYaz2(label);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:23:57.350

我建议 cursor.getFloat(0) 因为您的光标中只有一列，并且正如其他人所说的 MIN(zaman) 的命名很棘手

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:14:54.270

您的日志显示出了什么问题 `Couldn't read row 0, col -1 from CursorWindow.`

基本上，它试图访问一个不存在的字段。这是由此处的行引起的：或/和 firstTime 声明。

```
 float lastTime=lastTimeHandler.getFloat(firstTimeHandler.getColumnIndex("zaman")); 
```

所以基本上该领域`zaman`不存在。

但它会吗？

检查案件。由于某些奇怪的原因，它的**大小写敏感。**您的列可能**`Zaman`**未命名**`zamon`**

为什么sql不区分大小写，这个获取列索引的android api，不是。

# vb.net - 内存泄漏 Directory.GetFiles() VB.NET

> ID：13978798
> 
> 赞同：0
> 
> 时间：2012-12-20T19:05:07.383
> 
> 标签：vb.net, memory-leaks

我有一个我编写的启动器实用程序，用于`Directory.GetFiles()`跟踪`Timer`开始菜单中的快捷方式。

但是，它有内存泄漏。我没有做任何奇怪的事情，所以我不明白为什么它会泄漏......我让程序保持打开状态，几天后，它达到了 300mb。我使用 CLR Profiler 尝试定位泄漏，它说内存泄漏来自`String`分配的实例`Directory.GetFiles`，`Directory.GetFileNameWithoutExtension`这是我正在使用的代码：

```
Private Sub tmr_Tick(ByVal sender As Object, ByVal e As System.EventArgs) Handles tmr.Tick
    IndexStartMenu()
    GC.Collect()
End Sub

Private Sub IndexStartMenu()

    Dim startMenu As IO.DirectoryInfo
    Dim shortcuts() As IO.FileInfo

    'Enumerate current user's start menu
    startMenu = New IO.DirectoryInfo(Environment.GetFolderPath(Environment.SpecialFolder.StartMenu))
    shortcuts = startMenu.GetFiles("*.lnk", IO.SearchOption.AllDirectories)
    For Each lnk As IO.FileInfo In shortcuts
        Dim newRow As DataRow = dtApps.NewRow
        newRow("Application") = IO.Path.GetFileNameWithoutExtension(lnk.FullName)
        newRow("Window") = "Launch"
        newRow("Hwnd") = ""
        newRow("IsShortcut") = True
        newRow("ShortcutPath") = lnk.FullName
        dtApps.LoadDataRow(newRow.ItemArray, LoadOption.Upsert)
        newRow = Nothing
    Next

    'Enumerate all users' start menu
    startMenu = New IO.DirectoryInfo(allUsersStartMenuPath)
    shortcuts = startMenu.GetFiles("*.lnk", IO.SearchOption.AllDirectories)
    For Each lnk As IO.FileInfo In shortcuts
        Dim newRow As DataRow = dtApps.NewRow
        newRow("Application") = IO.Path.GetFileNameWithoutExtension(lnk.FullName)
        newRow("Window") = "Launch"
        newRow("Hwnd") = ""
        newRow("IsShortcut") = True
        newRow("ShortcutPath") = lnk.FullName
        dtApps.LoadDataRow(newRow.ItemArray, LoadOption.Upsert)
        newRow = Nothing
    Next

    'Trying to fix memory usage
    startMenu = Nothing
    Array.Clear(shortcuts, 0, shortcuts.Length)
    shortcuts = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T01:02:54.247

根据您发布的方法，计时器不会每隔一段时间触发一次并重复添加这些目录的内容吗？如果 dtApps 是一个范围为在应用程序期间持续存在的类的 DataTable 字段，那么您只是重复地将行添加到 DataTable 导致它增长。这不是内存泄漏，而是自然事件。检查 dtApp 的行数。我的猜测是您打算只添加新行。

[此外，您可以改进上述解决方案，并通过使用FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher%28v=vs.100%29.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)消除基于计时器轮询两个目录的需要。当文件系统发生更改时，FileSystemWatcher 将通过触发事件来通知您。

# .net - 递归 xslt 模板未替换找到的所有字符

> ID：13978800
> 
> 赞同：0
> 
> 时间：2012-12-20T19:05:27.023
> 
> 标签：.net, xml, xslt-1.0

我在下面创建了这个 XSLT 模板来解析正在转换为 HTML 页面的文本块。该模板在多个位置使用，但是，它没有成功转换我一直指定的字符。一个例子如下：

我希望“二”有“帮助”，我继续多看“四”，但我发现的只是“空虚”。

结果是：我希望“两个”有“帮助”，我继续寻找“寻求”更多，但我发现的只是“空虚”。

有什么想法吗？

```
<xsl:template name="PreserveQuotations">
  <xsl:param name="text"/>
  <xsl:choose>
    <xsl:when test="contains($text,'&#8220;')">
      <xsl:value-of select="substring-before($text,'&#8220;')"/>
      <xsl:text>"</xsl:text>
      <xsl:call-template name="PreserveQuotations">
        <xsl:with-param name="text">
          <xsl:value-of select="substring-after($text,'&#8220;')"/>
        </xsl:with-param>
      </xsl:call-template>
    </xsl:when>
    <xsl:when test="contains($text,'&#8221;')">
      <xsl:value-of select="substring-before($text,'&#8221;')"/>
      <xsl:text>"</xsl:text>
      <xsl:call-template name="PreserveQuotations">
        <xsl:with-param name="text">
          <xsl:value-of select="substring-after($text,'&#8221;')"/>
        </xsl:with-param>
      </xsl:call-template>
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="$text"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T16:45:31.747

如果您考虑以下形式的字符串的情况，您应该会清楚这个问题

```
aaa &#8221; bbb &#8220; ccc 
```

有两个明显的解决方案：（1）检查字符串包含两个特殊字符的情况，然后处理第一个出现的情况；或 (2) 对每个字符的字符串进行一次传递。（要么将模板拆分为两个模板，要么指定在参数中查找哪个字符。）

# javascript - 属性“if”的值为 null 或未定义，而不是 Function 对象

> ID：13978803
> 
> 赞同：-6
> 
> 时间：2012-12-20T19:05:43.033
> 
> 标签：javascript, object, properties, null

我正在创建一个用于模块评估的测验模板。在此过程中，我创建了一个带有单选按钮的 True/False 问题。当我单击得分按钮检查我的答案时，我得到属性“if”的值为 null 或未定义，而不是函数对象。”我检查了单选按钮 id 以确保它与我的 If ( document.getElementById('answer_true').checked) 声明。我所有其他带有单选按钮的多项选择题都可以正常工作。我似乎无法将手指放在问题的根源上。得分按钮调用 check_tfQ 函数并告诉我问题出在 if 语句中。任何帮助将不胜感激。

```
<script language="JavaScript" type="text/javascript">
<!--
// variable declarations
score=0;
counter=0;
c=1;
correct="Correct! ";
incorrect="Incorrect! ";
// function declarations for each question

function Question1()
{
document.getElementById("main_ques").innerHTML="1\. Put question 1 here.";
document.getElementById("choice1").innerHTML="Put answer 1.1 here.";
document.getElementById("choice2").innerHTML="Put answer 1.2 here.";
document.getElementById("choice3").innerHTML="Put answer 1.3 here.";
document.getElementById("counter").innerHTML="Counter is "+c;
}
function checkQ1()
{
c+=1;
if (document.getElementById('answer_a').checked)
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
else if (document.getElementById('answer_a').checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
}
}
function Question2()
{
document.getElementById("main_ques").innerHTML="2\. Put question two here.";
document.getElementById("choice1").innerHTML="Put answer 2.1 here.";
document.getElementById("choice2").innerHTML="Put answer 2.2 here.";
document.getElementById("choice3").innerHTML="Put answer 2.3 here.";
document.getElementById("counter").innerHTML="Counter is "+c;
}
function checkQ2()
{
c+=1;
if (document.getElementById('answer_a').checked)
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
else if (document.getElementById('answer_a').checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
}
}
function Question3()
{
document.getElementById("main_ques").innerHTML="3\. Put question 3 here.";
document.getElementById("choice1").innerHTML="Put answer 3.1 here.";
document.getElementById("choice2").innerHTML="Put answer 3.2 here.";
document.getElementById("choice3").innerHTML="Put answer 3.3 here.";
document.getElementById("counter").innerHTML="Counter is "+c;
}
function checkQ3()
{
c+=1;
if (document.getElementById('answer_b').checked)
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
else if (document.getElementById('answer_b').checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
}
}
function Question4()
{
document.getElementById("main_ques").innerHTML="4\. Put question 4 here.";
document.getElementById("choice1").innerHTML="Put answer 4.1 here.";
document.getElementById("choice2").innerHTML="Put answer 4.2 here.";
document.getElementById("choice3").innerHTML="Put answer 4.3 here.";
document.getElementById("counter").innerHTML="Counter is "+c;
}
function checkQ4()
{
c+=1;
if (document.getElementById('answer_a').checked)
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
else if (document.getElementById('answer_a').checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
}
}
function Question5()
{
document.getElementById("main_ques").innerHTML="5\. Put question 5 here.";
document.getElementById("choice1").innerHTML="Put answer 5.1 here.";
document.getElementById("choice2").innerHTML="Put answer 5.2 here.";
document.getElementById("choice3").innerHTML="Put answer 5.3 here.";
document.getElementById("counter").innerHTML="Counter is "+c;
}
function checkQ5()
{
c+=1;
if (document.getElementById('answer_a').checked)
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
else if (document.getElementById('answer_a').checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
}
}
// function reveals fill in the blank question
function fitbQ()
{
document.getElementById("fitb_ques").style.visibility="visible";
document.getElementById("main_ques").innerHTML="";
document.getElementById("answer_a").style.visibility="hidden";
document.getElementById("answer_b").style.visibility="hidden";
document.getElementById("answer_c").style.visibility="hidden";
document.getElementById("choice1").innerHTML="";
document.getElementById("choice2").innerHTML="";
document.getElementById("choice3").innerHTML="";
document.getElementById("counter").innerHTML="Counter is "+c;
}
// function checks fill in the blank question
function check_fitbQ()
{
c+=1;
var fitb_answer=document.getElementById("fitb_ans").value;
if (fitb_answer=="balloon")
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
else if (document.getElementById("fitb_ans").checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
}
}
// function for True/False question
function tfQ()
{
document.getElementById("main_ques").innerHTML="";
document.getElementById("fitb_ques").style.visibility="hidden";
document.getElementById("answer_a").style.visibility="hidden";
document.getElementById("answer_b").style.visibility="hidden";
document.getElementById("answer_c").style.visibility="hidden";
document.getElementById("choice1").innerHTML="";
document.getElementById("choice2").innerHTML="";
document.getElementById("choice3").innerHTML="";
document.getElementById("counter").innerHTML="Counter is "+c;
document.getElementById("tf_ques").innerHTML="7\. Put question 7 here.";
document.getElementById("tf_ques").style.visibility="visible";
document.getElementById("T").style.visibility="visible";
document.getElementById("F").style.visibility="visible";
document.getElementById("answer_true").style.visibility="visible";
document.getElementById("answer_false").style.visibility="visible";
document.getElementById("T").innerHTML="True";
document.getElementById("F").innerHTML="False";
}
// function checks True/False question
function check_tfQ()
{
c+=1;
If (document.getElementById('answer_true').checked)
{
score+=1;
document.getElementById("reply_b").innerHTML=correct;
document.getElementById("testscore").innerHTML=score;
}
/* else if (document.getElementById("answer_true").checked==false)
{
document.getElementById("reply_a").innerHTML=incorrect;
} */ 
}
// function declaration for clearing the form
function clearform(form)
{
document.Questions.reset(form);
document.getElementById("reply_a").innerHTML="";
document.getElementById("reply_b").innerHTML="";
document.getElementById("testscore").innerHTML="";
}
// function declaration to disable all radio buttons after checking answers
function holdAnswers()
{
var obj=document.forms["Questions"]; 
            for (i=0;i<obj.length;i++) { 
                with (obj[i]) { 
                    if (type=='radio') { 
                        disabled=true; 
                    } 
                } 
            } 
}
function releaseAnswers()
{
var obj=document.forms["Questions"]; 
            for (i=0;i<obj.length;i++) { 
                with (obj[i]) { 
                    if (type=='radio') { 
                        disabled=false; 
                    } 
                } 
            } 
}
// function changes questions after each answer
function qlogger()
{
switch (c)
{
case 1:
Question1();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 2:
Question2();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 3:
Question3();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 4:
Question4();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 5:
Question5();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 6:
fitbQ();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 7:
tfQ();
releaseAnswers();
document.getElementById("tally").disabled=false;
break;
case 8:
results(score,c);
break;
}
}
//function declaration to check all answers to questions and provide output
function checkAll(c)
{
switch (c)
{
case 1:
checkQ1();
break;
case 2:
checkQ2();
break;
case 3:
checkQ3();
break;
case 4:
checkQ4();
break;
case 5:
checkQ5();
break;
case 6:
check_fitbQ();
break;
case 7:
check_tfQ();
break;
case 8:
results();
}
holdAnswers();
document.getElementById("tally").disabled=true;
}
function results(score,c)
{
grade=Math.round((score/(c-1))*100);
document.getElementById("main_ques").innerHTML="";
document.getElementById("answer_a").style.visibility="hidden";
document.getElementById("answer_b").style.visibility="hidden";
document.getElementById("answer_c").style.visibility="hidden";
document.getElementById("choice1").innerHTML="";
document.getElementById("choice2").innerHTML="";
document.getElementById("choice3").innerHTML="";
document.getElementById("counter").innerHTML="";
document.getElementById("tally").style.visibility="hidden";
if (grade>=80)
{
document.getElementById("results1").innerHTML="Congratulations! <br/>"; 
document.getElementById("results2").innerHTML="You passed with a score of "+ grade+"%";
}
else
{
document.getElementById("results1").innerHTML="Sorry. <br>";
document.getElementById("results2").innerHTML="You failed with a score of "+grade+"%";
}
}
//-->
</script> 
</head>
<body onload="clearform(); qlogger()">
<div id="title">Module Title</div>
<div id="subtitle">Module Subtitle</div>
<div class="questions">
<form name="Questions">
<!-- Multiple choice question placeholder is here -->
<div id="main_ques">1\. Please state your question here?</div>
<!-- Correct or Incorrect response -->
<div id="reply_a" class="response"></div>
<div id="reply_b" class="response2"></div>
<!-- Test score displays here -->
<div id="testscore" class="showscore"></div>
<!-- Test results displays here -->
<div id="results1" class="results1"></div>
<div id="results2" class="results2"></div>
<br>
<!-- Multiple choice radio buttons go here -->
<input type="radio" name="Q_ans" id="answer_a" class="answer_a" value="ans_a"/><br><div id="choice1" class="choice1"></div>
<input type="radio" name="Q_ans" id="answer_b" class="answer_b" value="ans_b"/><br><div id="choice2" class="choice2"></div>
<input type="radio" name="Q_ans" id="answer_c" class="answer_c" value="ans_c"/><br><div id="choice3" class="choice3"></div>
<!-- Put fill in the blank question here -->
<div id="fitb_ques" class="fitb_ques">6\. Please state your fill in the <input name="fitb_ans" id="fitb_ans"> question here.</div>
<!-- Put True/False question here -->
<div id="tf_ques" class="tf_ques">7\. Please state your T/F question here.</div>
<input type="radio" name="TF_ans" id="answer_true" class="true_btn" value="true_ans"/><br><div id="T" class="T">Put choice one here.</div>
<input type="radio" name="TF_ans" id="answer_false" class="false_btn" value="false_ans"/><br><div id="F" class="F">Put choice two here.</div> 
<div id="counter"></div>
<br>
<input type="button" name="tally" id="tally" value="score" onclick="checkAll(c)">
</form>
</div>
<div id="nextbutton">
<input type="image" src="pics/next_button.png" alt="Next Button" height="50" width="120" onclick="clearform();qlogger()">
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T19:08:05.200

你有一个大写的“我”在`If (...`。将其更改为小写：`if (...`. JavaScript 区分大小写。

# primefaces - PrimeFaces Mobile DataList 中的 CommandLink 在过滤后未引用正确的元素

> ID：13978805
> 
> 赞同：1
> 
> 时间：2012-12-20T19:05:52.410
> 
> 标签：primefaces

我正在开发 PrimFaces 移动员工目录应用程序，但遇到了障碍。它是一个简单的应用程序，由两个屏幕组成（员工过滤器/列表 + 员工详细信息）。

我能够毫无问题地加载数据列表。单击命令链接会正确加载员工详细信息。然后我能够实现一个自定义的员工过滤器，这有点痛苦，但我得到了它的工作。过滤器通过使用过滤结果重新填充员工数据列表的模型来工作。

问题是，在我使用过滤器重新填充/过滤数据列表后，单击员工（commandlink）不会将正确的员工 ID 传递回模型。而是传递执行过滤器之前存在的员工 ID。就像 JSF 模型与 DOM 不匹配一样。

我在用着：

*   TomEE (MyFaces 2.1.7)
*   PrimeFaces 移动版 0.9.3
*   PrimeFaces 3.3

我的两个支持模型都是@ViewScoped

```
<pm:view id="peopleDirView" onload="">
        <pm:header title="People Directory" fixed="true">
        </pm:header>

        <pm:content>
            <h:form id="form">
                <div data-role="fieldcontain">
                    <fieldset data-role="controlgroup">
                        <p:inputText id="searchCriteria" value="#{peopleDirectoryBean.criteria}" type="search"
                            onkeyup="delay(function() {filterResults();}, 500);" />
                    </fieldset>
                </div>

                <p:dataList id="peopleDataList" value="#{peopleDirectoryBean.people}" var="person" rowIndexVar="rowIndex">
                    <p:column>
                        <p:commandLink action="#{peopleDirectoryDetailBean.loadPersonDetail(person.employeeId)}" update=":personDetailView">
                            <img src="/phonedir/people/image/#{person.employeeId}?width=75&amp;height=100" width="90" height="100"
                                onerror="missingImage(this);" id="per-search-picture" />
                            <h1>#{person.nameLast}, #{person.nameFirst}</h1>
                            <p>#{person.deptName}</p>
                            <p>#{person.jobTitle}</p>
                        </p:commandLink>
                    </p:column>
                </p:dataList>
                <p:remoteCommand name="filterResults" update="peopleDataList" action="#{peopleDirectoryBean.peopleSearch}" />
            </h:form>
        </pm:content>

        <pm:footer fixed="true">
            <pm:navBar>
                <p:button value="People" icon="home" href="#peopleDirView?reverse=true" styleClass="ui-btn-active" />
                <p:button value="Locations" icon="info" href="#locationsView?reverse=true" />
                <p:button value="Conference" icon="search" href="#conferenceRoomsView?reverse=true" />
            </pm:navBar>
        </pm:footer>

        <script>
            var delay = (function() {
                var timer = 0;
                return function(callback, ms) {
                    clearTimeout(timer);
                    timer = setTimeout(callback, ms);
                };
            })();

            function missingImage(image) {
                image.onerror = "";
                image.src = "missing-person.jpg";
                return true;
            }
        </script>

</pm:view> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T13:15:49.483

好吧，看来是我犯了错误。

在我的支持 bean 中，我使用了 javax.inject.Named (@Named)，因为我试图利用我的容器执行 CDI 的能力。一旦我将其更改为 javax.faces.bean.ManagedBean (@ManagedBean )，问题就消失了。TomEE 文档声明它支持@Named，所以我不确定这笔交易是什么。

# tfs - 如何在 tfs 2012 预览版中包含周末？

> ID：13978806
> 
> 赞同：1
> 
> 时间：2012-12-20T19:05:59.333
> 
> 标签：tfs

我正在使用 TFS 2012 预览版，我的 sprint 包括周末的工作，但是 tfs 预览版在它的 sprint 计算中不包括周末。我怎样才能包括周末？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T18:55:51.070

目前无法在 Team Foundation Service（以前称为 TFS 预览版）上执行此操作，因为您无法自定义流程模板。

虽然产品团队很乐意提供此功能，但目前没有植入时间框架。随着产品的发展，这导致了升级模板的复杂性，如果您进行更改，他们将无法再为您升级。

如果您有本地 Team Foundation Server，则可以进行此自定义。

我建议您在以下位置提出请求：http: [//visualstudio.uservoice.com](http://visualstudio.uservoice.com)

# java - ByteBuffer.allocateDirect(size) 没有在 Android 2.2 模拟器中创建支持字节 []

> ID：13978809
> 
> 赞同：0
> 
> 时间：2012-12-20T19:06:03.577
> 
> 标签：java, android, bytebuffer

我是安卓新手。我似乎无法找到相关的论坛帖子。

让我感到困惑的是，它`allocateDirect()` **确实**在 Android **4.2**模拟器中创建了支持字节 []。

更具体地说，我分配了一个 ByteBuffer，并`buffer.put(byte[])`多次调用写入 ByteBuffer 的内容。然后我想交出支持字节 [] 进行压缩。它正在访问引发 UnsupportedOperationException 的支持字节 []。

这是运行 Android 2.2 模拟器时写入后生成的缓冲区内容：

![在此处输入图像描述](../Images/7636d71e9b73d227848840544065c7e2.png)

这是运行 Android 4.2 模拟器时写入后生成的缓冲区内容：

![在此处输入图像描述](../Images/2e2826799b2d7ea91df2fce019d27763.png)

区别似乎在于是否`bufferRef.block`创建（它是在Android 4.2模拟器中分配ByteBuffer时创建的）。我宁愿总是使用直接的 ByteBuffer。作为一种解决方法，我检查是否可以访问支持字节 []，如果没有，则使用`ByteBuffer.allocate(size)`.

```
 ByteBuffer buf;
        try {
            buf = ByteBuffer.allocateDirect(this.maxBufferSize);
            if(!buf.hasArray()) { //some API levels either don't expose or create the backing byte[]  
                buf = null;
                buf = ByteBuffer.allocate(this.maxBufferSize);
            }
        } catch (Exception e) {
            return false;
        } 
```

所以，我的问题是，有没有办法保证直接字节缓冲区总是有一个支持字节[]（假设有足够的内存）？还是我必须接受这种解决方法？

环境：

ADT 版本：v21.0.0-519525

Android 2.2 模拟器配置：

更新了基于 Android 2.2、ARM (armeabi) 处理器的 AVD 'AVD_for_Galaxy_Nexus_by_Google' [2012-12-20 10:09:34 - SDK Manager]，硬件配置如下：

[2012-12-20 10:09:34 - SDK 管理器] hw.sdCard=no

[2012-12-20 10:09:34 - SDK 管理器] hw.device.manufacturer=Google

[2012-12-20 10:09:34 - SDK 管理器] hw.mainKeys=no

[2012-12-20 10:09:34 - SDK 管理器] hw.lcd.density=320

[2012-12-20 10:09:34 - SDK 管理器] hw.accelerometer=yes

[2012-12-20 10:09:34 - SDK 管理器] hw.dPad=no

[2012-12-20 10:09:34 - SDK 管理器] hw.device.hash=-708107041

[2012-12-20 10:09:34 - SDK 管理器] hw.trackBall=no

[2012-12-20 10:09:34 - SDK 管理器] hw.device.name=Galaxy Nexus

[2012-12-20 10:09:34 - SDK 管理器] hw.camera.back=none

[2012-12-20 10:09:34 - SDK 管理器] hw.sensors.proximity=yes

[2012-12-20 10:09:34 - SDK 管理器] hw.battery=yes

[2012-12-20 10:09:34 - SDK 管理器] disk.dataPartition.size=200M

[2012-12-20 10:09:34 - SDK 管理器] hw.audioInput=yes

[2012-12-20 10:09:34 - SDK 管理器] hw.sensors.orientation=yes

[2012-12-20 10:09:34 - SDK 管理器] hw.camera.front=none

[2012-12-20 10:09:34 - SDK 管理器] hw.gps=yes

[2012-12-20 10:09:34 - SDK 管理器] skin.dynamic=no

[2012-12-20 10:09:34 - SDK 管理器] hw.keyboard=yes

[2012-12-20 10:09:34 - SDK 管理器] vm.heapSize=64

[2012-12-20 10:09:34 - SDK 管理器] hw.ramSize=512

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:01:24.410

更好的答案是`.allocateDirect()`不创建支持数组。您必须调用`ByteBuffer.get(byte[])`以从给定缓冲区填充数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T05:14:17.713

Android 2.2 没有字节缓冲区。缓冲区是可选的。它在以后的版本中实现。

# apache-flex - VerifyError：错误 #1014：找不到类 mx.controls.advancedDataGridClasses::AdvancedDataGridRendererProvider

> ID：13978810
> 
> 赞同：1
> 
> 时间：2012-12-20T19:06:04.137
> 
> 标签：apache-flex, actionscript

我正在将 Flex 应用程序从 4.1 移植到 4.5，并且在找到 AdvancedDataGrid 类时遇到了一些问题。该应用程序在 4.5.1 下编译正常，但在运行时出现以下错误：

VerifyError：错误 #1014：找不到类 mx.controls.advancedDataGridClasses::AdvancedDataGridRendererProvider。

似乎旧的 datavisualization.swc 被划分为库（advancedgrids_4.5.21328.swf 和 charts_4.5.21328.swf），这两个库都存在于我的项目中。配置中有什么需要更新的吗？

我目前正在为 Web 开发人员使用 Eclipse Java EE IDE（Helios Service Release 1）

非常感谢，

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T13:12:12.807

您必须将库合并到代码中。这可能会有所帮助 -

[验证错误：错误 #1014：找不到类](https://stackoverflow.com/questions/8019471/verifyerror-error-1014-class-could-not-be-found)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T07:00:53.767

验证错误确实意味着您尝试在运行时访问的类版本有问题。首先，您可以尝试使用 'merged/rsl' 设置。其次，您可以仔细检查您的包含或尝试在 ide 之外构建您的应用程序，例如使用 ant 任务。

# .net - Entity Framework 4.3 与 5.0 更新差异

> ID：13978816
> 
> 赞同：7
> 
> 时间：2012-12-20T19:06:33.883
> 
> 标签：.net, entity-framework, entity-framework-4, entity-framework-5

几个月来，我一直在研究我的 ASP.NET MVC 应用程序。当我第一次开始研究它时，我使用的是 Entity Framework 4.3 (Code-First w/Migrations)。当我这样做时，我在尝试对 MainClient 表进行更新时遇到了一些问题。MainClient 包含客户的所有基本信息，并与 BPClient 表具有 1:1 的关系，该表包含有关该客户的更多具体信息，与他们的 BP 模块许可协议有关。两者都可以在选项卡控件的同一页面上进行编辑。但是，在尝试将 MainClient 对象的 EntityState 更改为 EntityState.Modified 时，我不断收到以下异常：

```
System.InvalidOperationException : An object with the same key already exists 
in the ObjectStateManager. The ObjectStateManager cannot track multiple objects 
with the same key. 
```

我在调试时注意到，当对象进入我的 Controller 类进行保存时，它本身被认为是分离的。作为这个问题的解决方法，我对[这篇博](http://blog.felipel.com/2009/07/ef-objectcontext-attach-and-objectstatemanager/)文和[这个 SO question](https://stackoverflow.com/questions/5672255/an-object-with-the-same-key-already-exists-in-the-objectstatemanager-the-object)中发现的问题应用了类似的解决方案。考虑到在名为 MainClient 的对象中传递了 Edit 方法，下面是重新附加对象的代码之后的样子（我知道很乱）`client`：

```
var newClientObject = new MainClient { ClientID = client.ClientID };
Db.MainClients.Attach(newClientObject);
Db.Entry(newClientObject).CurrentValues.SetValues(client);

var bpClient = new BPClient { ClientID = client.ClientID, BaseClient = newClientObject };
if (client.BPClient != null)
{
    Db.BostonpostClients.Attach(bpClient);
    Db.Entry(bpClient).CurrentValues.SetValues(client.BPClient);
}

Db.SaveChanges() 
```

这在所有测试用例中都工作得很好而且很花哨。直到最近。

最近，我升级了我的应用程序以使用 Entity Framework 5（仍然使用 Code-First）。但是，当我再次测试 MainClient 编辑页面时，我发现了一些相当不稳定的行为。某些字段在编辑时可以毫无问题地保存。其他人永远不会致力于数据库。还有一些会很好，但前提是它们是被编辑对象的唯一部分。我调试了 Controller 类中的 DbContext ，发现，相当烦人的是，不仅页面上所做的更改被发送到 Controller 类，而且 ObjectStateManager 中同时包含 MainClient 和 BPClient 对象它也*与页面上所做的更改一起！*顺便提一下，我在调试它时没有收到一个错误，即使在 SaveChanges() 之后也没有。

我决定尝试将代码恢复到原来的样子，也就是说这样做的逻辑方式：

```
Db.Entry<BPClient>(client.BPClient).State = EntityState.Modified;
Db.Entry<MainClient>(client).State = EntityState.Modified;

Db.SaveChanges(); 
```

现在它工作得很好。没有 InvalidOperationException。所以这已经很好地解决了。

仍然困扰着我的是试图弄清楚 5.0 中的哪些变化使我之前的修复停止工作并且对我来说很不稳定。为什么该代码在 4.3 中可以正常工作，但在 5.0 中却不行？是什么在 5.0 中使使用该代码提交到数据库如此不稳定？

有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T15:37:27.643

我自己也有这个问题。我正在使用 IDbSet 类来填充数据库表，我发现当我使属性虚拟 EF5 执行延迟加载（我的虚拟属性在数据库中的其他对象处）时。这意味着我收到了虚拟财产的新主键。好吧，如果我没有与我想引用的对象关联的特定 ID，EF 5 会尝试建立双向关系。如果您没有明确告诉 EF 在 DBContext 中映射到哪个属性，它会为同一个对象设置两个外键，这是不允许的。希望这可以帮助。

# javascript - 媒体元素音频源节点如何播放

> ID：13978818
> 
> 赞同：6
> 
> 时间：2012-12-20T19:06:38.160
> 
> 标签：javascript, html, audio, webkit, web-audio-api

所以我遇到了一个问题，我试图从标签创建一个网络音频源节点。代码如下所示：

```
OBJECT.musicContext= new webkitAudioContext();  
OBJECT.audio = new Audio();
OBJECT.audio.src = self.file;
OBJECT.source = OBJECT.musicContext.createMediaElementSource(OBJECT.audio);

var analyser= OBJECT.musicContext.createAnalyser();
analyser.fftSize=1024;
OBJECT.analyser=analyser    

OBJECT.gain = self.musicContext.createGain();
OBJECT.gain.gain.value = .01    
OBJECT.source.connect(OBJECT.gain)
OBJECT.gain.connect(OBJECT.analyser)
OBJECT.analyser.connect(OBJECT.musicContext.destination)

OBJECT.play = function(){OBJECT.source.play();}
OBJECT.stop = function(){OBJECT.source.stop();} 
```

问题在于最后两行。我似乎无法通过 webkit 音频上下文播放音频...

如果我做

```
OBJECT.play = function(){OBJECT.audio.play();} 
```

声音将开始播放，但不会通过音频节点（这是有道理的）

我也试过

```
OBJECT.play = function(){OBJECT.source.noteOn(0);}
OBJECT.stop = function(){OBJECT.source.noteOff(0);} 
```

无济于事...

非常感谢任何帮助或建议，并提前感谢您的时间！

艾萨克

编辑：当 console.logging OBJECT.source 声称有零输入和 1 输出时。这对于源节点是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:41:21.773

You should try your page in Chrome as [Safari currently doesn't send the correct data to the Analyzer Node](https://stackoverflow.com/questions/13958158/why-isnt-safari-able-to-process-audio-from-a-mediaelementsourcenode). If you're using an `Audio()` object with the Web Audio API then you should be able to control the playback with it instead of using `.noteOn()/.noteOff()`.

Here's the test case: [http://screamingrobots.com/misc/safariaudiobug/](http://screamingrobots.com/misc/safariaudiobug/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T16:36:32.987

Figured it out finally, but don't know exactly what the issue was...

rather then using

```
audio = new Audio();
audio.src = self.file; 
```

and connecting this, I instead used

```
audio = document.querySelector('audio'); 
```

to select an element I had previously put into the page. I am not sure if this works simply because it gave it more time to load, or if there is something intrinsic to the API

# javascript - 关于更改 javascript 函数运行的上下文

> ID：13978820
> 
> 赞同：1
> 
> 时间：2012-12-20T19:06:44.797
> 
> 标签：javascript, scope, call

我解决了我遇到的一个问题，意识到如果你在某个上下文中定义一个 javascript 函数，你就不能调用它来在不同的上下文中运行。现在，我一直在探索实现这一目标的方法。

我的目标是：我有三个窗口：第一个是主窗口，我的函数是在其中创建的。第二个是使用`window.open`. 第二个窗口有一个按钮可以打开第三个也是最后一个窗口，打开后，第三个窗口应该运行与第一个窗口中定义的相同的功能。

我试图在主函数中引用第三个窗口，如下所示：

（假设我的`window.open`变量的名称是`w`）

```
var w;
function main() {
    console.log(w);
    ...rest of the code....
} 
```

所以我希望它能给 main 函数一个提示，W 的存在，我稍后会打开的窗口。

然后，从第二个窗口中，我将创建一个按钮并制作一个`onclick`：

```
w.main; 
```

这是行不通的...

是否有不同的方法（或更改此方法的方法）来使函数意识到创建它的不同上下文的存在，因此当未来时刻到来时，能够在其中运行吗？

我现在正在阅读关于适应`call()`我的目的。这有意义吗，或者你会建议一种不同的方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:14:13.993

假设窗口 1 打开窗口 2，窗口 2 打开窗口 3，并且您试图从窗口 3 调用窗口 1 中的 main 方法

```
window.opener.opener.main(); 
```

在窗口 2 中打开时将窗口 1 中的 w 设置为窗口 3 引用：

```
window.opener.w = window.open(); 
```

好的，我对此进行了测试。窗口 3 打开后，将打开一个对话框，在窗口 1 中显示“测试”

窗口1.html：

```
<html>
<head>

    <script type="text/javascript">
        var child = window.open("window2.html", "window2");

        function test() {
            alert("test");
        }
    </script>

</head>
<body>
</body>
</html> 
```

窗口2.html：

```
<html>
<head>

    <script type="text/javascript">
        var child = window.open("window3.html", "window3");
    </script>

</head>
<body>
</body>
</html> 
```

窗口3.html：

```
<html>
<head>

    <script type="text/javascript">
        window.opener.opener.test();
    </script>

</head>
<body>
</body>
</html> 
```

# unix - 使用 awk 删除第 n 行

> ID：13978822
> 
> 赞同：1
> 
> 时间：2012-12-20T19:06:48.447
> 
> 标签：unix, sed, awk

在设定的记录间隔内，我需要删除 4 行/记录。这可以用 awk 或 sed 完成吗？

我有一个文件，每 70 条记录就有一个换页符。这导致在我的输出中打印一个空行。

我想使用 awk 或 sed 删除换页前的四 (4) 行，因此我的页面现在有 66 行长。

那应该消除我的空白页。

我传递的文件是一个假脱机文件中的数千条记录，我希望有一个简单的解决方案。我试过了

```
sed -n -e '65~68p; 
```

但我认为我的 unix 机器上没有可用的，因为当我尝试运行该命令时出现错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:19:11.403

```
awk '{if ((NR%70) <65) print $0;}' inputfile 
```

应该做的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:27:15.740

```
sed 'H;g;s:[^\n]::g;/.\{64\}/{N;N;N;s:.::g; x;s:\n::p;d};${x;s:\n::;p};d' FILE 
```

此行将删除第 65, 65*2, ..., 65*K 行之后的下 3 行。

如果要删除多于 3 行，请添加更多 N;N;N;。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:26:29.940

pbhd 在我发布之前给出了一个很好的解决方案，但如果你想使用 python 来做的话：

```
 import sys
    s = sys.stdin.read()
    for page in s.split('\f'):
        lines = page.splitlines()
        print '\n'.join(lines[:-4]) + '\f' 
```

# castle-windsor - 解决温莎城堡中注册实例的依赖关系

> ID：13978825
> 
> 赞同：0
> 
> 时间：2012-12-20T19:06:53.113
> 
> 标签：castle-windsor, ioc-container, excel-addins

我想知道 Castle 容器在注册时是否可以解决对实例的依赖，如下所示：

```
var inst = Globals.Ribbons.TestRibbon;
this.container.Register(
    Component
        .For<TestRibbon>()
        .Instance(inst)
    ); 
```

长话短说，我在 Excel 插件上工作，使用 Castle.Windsor 作为 IoC 容器，在某些点交互发生在自定义 Ribbon 和 CustomTaskPane 之间，因为 Ribbon 由 Excel 实例化和加载，我无法注册类型然后解决它有依赖关系（或者有办法？）

我有两种解决方法，做一些手动属性注入或从功能区内部引用容器，无论哪种方式都感觉很尴尬。

有没有办法向 Castle 容器注册实例，以便它自动解决对该实例的依赖关系？

# django - django 会话密钥在身份验证时更改

> ID：13978828
> 
> 赞同：14
> 
> 时间：2012-12-20T19:07:17.600
> 
> 标签：django, django-admin, django-views

我有一个 Django 应用程序，它记录用户对两个经过身份验证的用户的产品选择。`request.session.session_key`如果用户决定稍后注册，我的意图是使用该变量将匿名数据与用户相关联，例如这篇文章：

[Django 存储匿名用户数据](https://stackoverflow.com/questions/13938805/django-storing-anonymous-user-data)

但是，似乎会话密钥在用户登录/注册时发生了变化，因此会话密钥无法再与用户关联。这是 Django 会话框架的正确行为吗？有没有一种可靠的方法来实现我正在寻找的功能？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-07T17:22:50.367

在 settings.py

```
SESSION_ENGINE = 'youapp.session_backend' 
```

在文件 session_backend.py 中的目录 youapp 中

```
from django.contrib.sessions.backends.db import SessionStore as DbSessionStore

class SessionStore(DbSessionStore):
    def cycle_key(self):
        pass 
```

登录后会话未更改

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-03T09:03:52.150

虽然*nnmware*建议的方法可能适用于这种特殊情况，但还有更好的方法。

`cycle_key`我们应该调用 super 方法然后保存会话，而不是在里面什么都不做。

因为如果您查看原始`cycle_key`函数内部，您会看到旧会话中的数据被复制到新会话中，但实际上并未保存。

在 settings.py

```
SESSION_ENGINE = 'yourapp.session_backend' 
```

检查 SESSION_ENGINE 是否指向模块（.py 文件），而不是后端类！

现在，在您的 'yourapp/session_backend.py' 中执行以下操作：

```
from django.contrib.sessions.backends.db import SessionStore as DbSessionStore

class SessionStore(DbSessionStore):
    def cycle_key(self):
        super(SessionStore, self).cycle_key()
        self.save() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-04T14:52:42.383

解决方案之一也是更新会话存储中的旧会话数据：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from django.contrib.sessions.backends.db import SessionStore as DbSessionStore
from shop.models.cart import Cart

class SessionStore(DbSessionStore):
    def cycle_key(self):
        old_session_key = super(SessionStore, self).session_key
        super(SessionStore, self).cycle_key()
        self.save()
        Cart.objects.filter(session_key=old_session_key).update(session_key=self.session_key) 
```

# objective-c - 通过 writeToFile 以编程方式将视网膜和非视网膜图像添加到本地存储？

> ID：13978833
> 
> 赞同：0
> 
> 时间：2012-12-20T19:08:01.830
> 
> 标签：objective-c, ios, image, save, nsfilemanager

您好：我的应用程序中有一个照片上传器，可以让玩家上传他们自己的照片以在我的应用程序中使用。我裁剪并调整每个上传的图像的大小以创建两个图像：一个 X×X 像素图像（用于非视网膜显示器）和一个 2X×2X 像素图像（用于视网膜显示器）。

然后我将这两个图像保存到本地播放器的 Private Documents 目录，其中 photoDataNonRetina`[photoDataNonRetina writeToFile:pathNonRetina atomically:YES]`和`[photoDataRetina writeToFile:pathRetina atomically:YES]`photoDataRetina 是 NSData 对象，每个图像的文件名分别是`photo.png`和`photo@2x.png`。

随后我应该如何从本地 Private Documents 目录中检索我的图像，以便根据设备是否具有视网膜显示器来检索适当的图像？现在我猜想做一些类似于以下的事情：

```
NSString *path = [[self pathForPlayer:player] stringByAppendingPathComponent:@"photo.png"];
return [UIImage imageWithContentsOfFile:path]; 
```

除了这似乎只加载非视网膜图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:17:36.333

尝试这个：

```
if ([[UIScreen mainScreen] respondsToSelector:@selector(displayLinkWithTarget:selector:)]            &&
([UIScreen mainScreen].scale == 2.0)) {
  // Retina display
} else {
  // non-Retina display
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:23:48.300

只需从文件名中删除扩展名。

```
NSString *path = [[self pathForPlayer:player] stringByAppendingPathComponent:@"photo"];
return [UIImage imageWithContentsOfFile:path]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:21:36.047

也许这个？

```
if ([[UIScreen mainScreen].scale > 1) {
  NSString *path = [[self pathForPlayer:player] stringByAppendingPathComponent:@"photo@2x.png"];
  UIImage * image = [UIImage imageWithContentsOfFile:path];
  UIImage * retinaImage = [UIImage imageWithCGImage:[image CGImage] scale:2 orientation:[image imageOrientation]];
  return retinaImage;
} else {
  NSString *path = [[self pathForPlayer:player] stringByAppendingPathComponent:@"photo.png"];
  return [UIImage imageWithContentsOfFile:path];
} 
```

# vim - vim中的查找命令获取不完整的路径

> ID：13978838
> 
> 赞同：1
> 
> 时间：2012-12-20T19:08:19.337
> 
> 标签：vim

在 vim 中，当我使用 :find 打开另一个文件时，它会丢失相对路径的第一个组件。

例如，如果我正在查找位于以下位置的文件：

```
./foo/bar/file.txt 
```

我会打字

```
:find **/file.txt 
```

它找到文件，然后尝试打开

```
bar/file.txt 
```

如果我输入它可以正常工作

```
./**/file.txt 
```

但是我很懒，不想打字那么多。我是否缺少一些可以正确定位并打开此路径的配置？

## 我的解决方案

我只是将主要源代码目录附加到我的路径

```
exec "set path^=src/**" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:04:05.207

你的`'path'`套吗？那（IMO）是一种非常方便的方法，甚至可以避免输入`**/`位。

在我的设置中，有一个环境变量定义了我当前所在的项目，所以我使用它并构建一个以它为根的路径。简而言之：

```
let s:rootdir = $PROJECT_DIR
let s:path = 'src/**;' . s:rootdir . ',scripts/**;' . s:rootdir
execute "set path=" . s:path 
```

然后我就可以`:find a_file.txt`搜索我的 src 层次结构，然后搜索我的脚本层次结构来查找文件。

# git - msysgit 和 git-cheetah 在带有“Git Bash”上下文菜单的 winXP 上遇到问题

> ID：13978842
> 
> 赞同：1
> 
> 时间：2012-12-20T19:08:34.213
> 
> 标签：git, msysgit

我在 Windows XP 上安装了 msysgit 版本 1.8.0，我选择使用插件“高级”版本作为上下文菜单。如果我从快捷方式图标启动 git bash，它就可以正常启动。但是，如果我使用右键单击上下文菜单，则会出现以下错误：

```
Welcome to Git (version 1.8.0-preview20121022)

Run 'git help git' to display the help index.
Run 'git help <command>' to display help for specific commands.
sh: /bin/stty: No such file or directory 
sh: /bin/stty: No such file or directory
sh: hostname: command not found
sh: unalias: cm: not found
:Desktop/2 part Auth/GoogleAuth> 
```

我在我的 Windows 7 机器上使用了相同的版本，完全没有问题。

有什么线索吗？

谢谢，贾斯汀

# php - 从方法 GET 表单 url 中删除方括号 []

> ID：13978843
> 
> 赞同：1
> 
> 时间：2012-12-20T19:08:36.383
> 
> 标签：php, forms, get

我正在使用带有方法 GET 和复选框数组的表单：

```
foreach ($foo AS $key=> $value) {
$i++;
echo '<label for="'.$i.'">'.$value.'</label>
  <input type="checkbox" name="foo[]" value="'.$value.'"" />';
} 
```

输出如下网址：

```
form.php?id=34&foo[]=c1&foo[]=c2&foo[]=c3 
```

有没有办法删除方括号，`[]`然后将表单方法更改为 POST 这不是真正的选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:14:44.103

不可以。如果您希望允许多个可能的值并将其作为单个数组在对应于复选框的 PHP 端使用，则需要使用方括号对其进行命名。通常这不是问题，因为您通常会提交带有帖子的表单并且看不到参数。

# c# - 如果由于 c# 泛型，它们的内容相同，是否值得合并这些接口？

> ID：13978849
> 
> 赞同：0
> 
> 时间：2012-12-20T19:09:02.863
> 
> 标签：c#, design-patterns

我有一个公司和用户的仓库，但他们的界面是一样的

```
 public interface ICompanyRepository
    {
        void RollbackChanges();
        void SaveChanges();
        IQueryable<T> Set<T>() where T : class;
    }
  public interface IUsersRepository
    {
        void RollbackChanges();
        void SaveChanges();
        IQueryable<T> Set<T>() where T : class;
    } 
```

你认为值得将它们组合成一个类，即 IRepository

```
 public interface IRepository
        {
            void RollbackChanges();
            void SaveChanges();
            IQueryable<T> Set<T>() where T : class;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:10:40.473

是的，将通用功能移至通用界面。它将减少代码中的重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:10:56.990

对于相同概念的事物，拥有两个相同的独立接口是没有意义的。

是的 - 合并它们。[遵循DRY 原则](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)，您将在需要时在一个地方进行更改。

# xml - 针对 XML 错误的 xml 架构

> ID：13978850
> 
> 赞同：1
> 
> 时间：2012-12-20T19:09:11.307
> 
> 标签：xml, xsd

我正在针对 xml 文件编写 xml 模式。我收到以下代码的此错误，但无法弄清楚原因。有什么建议吗？

cvc-type.3.1.1：元素'employees'是一个简单类型，所以它不能有属性，除了那些名称空间名称与'http://www.w3.org/2001/XMLSchema-instance'相同并且其[本地名称] 是“type”、“nil”、“schemaLocation”或“noNamespaceSchemaLocation”之一。但是，找到了属性“essns”。发现问题始于：simpleType。

```
<xs:element name="employees" >
      <xs:simpleType>
        <xs:list itemType ="xs:integer"/>
      </xs:simpleType>
      </xs:element>
      <xs:element name= "projectsControlled">
      <xs:simpleType>
        <xs:list itemType ="xs:integer" />
      </xs:simpleType>
      </xs:element> 
```

以下是xml代码

```
<employees essns="888665555"/>
<projectsControlled pnos="20"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T23:28:00.793

元素可能有简单类型或复杂类型。

具有简单类型的元素只不过是适当类型的有效值的包装器。不允许有其他内容，不允许有子元素，不允许有属性。

也就是说，只有复杂类型管理的元素才允许具有属性。（如您的错误消息中所述，xsi:nil、xsi:type、xsi:schemaLocation 和 xsi:noNamespaceSchemaLocation 存在异常。）

您的 'employees' 元素被声明为具有简单类型：整数列表。因此允许它包含一个整数列表，但您没有为它声明任何属性。如果你想这样做，你可以将它声明为具有“具有简单内容的复杂类型”——本质上，一种通过添加属性来扩展简单类型的复杂类型。

```
<xs:simpleType name="list-of-integers">
  <xs:list itemType="xs:integer"/>
</xs:simpleType>

<xs:element name="employees">
  <xs:complexType>
    <xs:simpleContent>
      <xs:extension base="tns:list-of-integers">
        <xs:attribute name="essns" 
                      type="tns:list-of-integers"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:element> 
```

或者，您可能打算将其声明`employees`为具有名为属性的空元素，该属性`essns`的值可以是整数列表。在那种情况下，您不想要具有简单内容的复杂类型，因为您想要的不是简单内容而是**没有**内容。

```
<xs:element name="employees-sib">
  <xs:complexType mixed="false">
    <xs:sequence/>
    <xs:attribute name="essns" 
                  type="tns:list-of-integers"/>
  </xs:complexType>
</xs:element> 
```

# haskell - Haskell：显式类型绑定中的类型错误

> ID：13978854
> 
> 赞同：1
> 
> 时间：2012-12-20T19:09:23.453
> 
> 标签：haskell

我正在尝试创建一个函数，该函数将删除字符串中给定字符的所有出现，但作为 Haskell 业余爱好者，我遇到了一些难以入睡的问题。

这是我的代码：

```
remove:: Char -> String -> Int
remove[] = []
remove (char : list) = char : remove (filter (\elm -> not (char == elm) ) list) 
```

使用类型定义，我得到以下错误代码：

```
ERROR "a5.hs":17 - Type error in explicitly typed binding
*** Term           : char : list
*** Type           : [a]
*** Does not match : Char 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:14:13.090

类型签名表示`remove`接受两个参数， a`Char`和 a `String`，并返回 a `Int`。

错误消息指的是第二个等式，它试图将第一个参数 (a `Char`) 与`(char : list)`(a list) 匹配。

也许你的意思是

```
remove char list = ... 
```

?

更多错误：

1.  第一个等式犯了同样的错误（试图将空列表与`Char`参数匹配）。

    也许这应该是

    ```
    remove _ [] = ... 
    ```

    （`_`意味着匹配任何东西。）

2.  类型签名表示结果是`Int`，但您的方程式给出了`String`结果。

还有更多的错误。但这会让你开始。

* * *

**编辑：**针对您的第一条评论：

1.  类型签名应该是

    ```
    remove :: Char -> String -> String 
    ```

    `remove`接受 a`Char`和 a`String`并返回 a `String`。

    当你放`remove :: Char -> String`时，这意味着`remove`需要 a`Char`并返回 a `String`。

2.  `(\elm -> flip (==) elm)`

    是相同的`(\elm -> (==) elm)`

    是相同的`(\elm birch -> (==) elm birch)`

    是相同的`(\elm birch -> elm == birch)`

    也一样`(==)`。

    此表达式具有类型`a -> a -> Bool`，但您将其作为第一个参数传递给`filter`，它需要一个具有类型的函数`a -> Bool`（即，它需要一个接受一个参数的函数，而不是一个接受两个参数的函数）。

    （这就是错误消息告诉您的内容。）

# magento - 分层导航中的 Magento 多选属性行为

> ID：13978855
> 
> 赞同：1
> 
> 时间：2012-12-20T19:09:34.150
> 
> 标签：magento, attributes, navigation, multi-select, layered

我正在使用 Magento 的分层导航让用户选择过滤器来确定他们的选择。因为我有很多选择，所以我选择使用多选属性，这样属性的数量就会更少。

Magento 的正常行为如下（即鞋子）： - 用户想要找到红色和黄色的鞋子，使用过滤器“颜色” - 用户选择“红色”和“黄色”作为过滤器选项，仅此而已。

就我而言，所选选项相互依赖。例如，当用户可以过滤应用程序时。- 用户想要找到一种可以在厨房和客厅使用的产品。

当该用户选择“厨房”和“客厅”作为过滤选项并且可能的产品不适合“浴室”时，过滤选项“浴室”必须消失。

我尝试使用只有一个选项的单独选择属性来执行此操作，但是属性的数量不断增长，并且在执行此操作时我失去了概述。

根据上面的示例，如何更改 Magento 中用于分层导航的多选属性的行为？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T08:42:15.987

如果要更改分层导航的行为，则需要重写 Block/Layer/.. 和 Model/Layer 中的分层导航

您可以使用法力过滤器模块，它允许您拥有来自同一类型的多个过滤器，然后您可以为选择实现自己的过滤器类（例如价格过滤器，它在分层导航中有自己的类）等..！

[http://www.manadev.com/advanced-layered-navigation-ce](http://www.manadev.com/advanced-layered-navigation-ce)

还有付费模块amasty分层导航

# python - Python UDP 程序多连接与选择

> ID：13978859
> 
> 赞同：0
> 
> 时间：2012-12-20T19:09:51.827
> 
> 标签：python, select

我正在制作一个连接多个客户端/邻居的 UDP 程序。没有服务器每个人都在使用相同的程序。我正在尝试使用 localhost 对其进行测试，因此请考虑邻居的所有 IP 和端口都按预期工作。使用 127.0.0.1 作为所有 IP 并连接到不同的端口。所以我的问题是为什么我会收到我在 while 循环之前发送的启动数据但我不能发送任何数据？似乎我对 sys.stdin 做错了什么。

```
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.bind((HOST, PORT))
going = True

input = [s]
while going:

  i,o,e = select.select(input,[],[],)
  try :
    for x in i:
      if x == sys.stdin: 
        data = sys.stdin.read()
        for i in neighbors:
          addr = (i[1][0], int(i[1][1]))
          s.sendto(data, addr)
      else:
        msg, addr = s.recvfrom(100)
        print msg
  except socket.error, msg:
    print 'Error Code : ' + str(msg[0]) + ' Message ' + msg[1]
    sys.exit()   
s.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T20:33:25.117

`input`is always `[s]`, so `i`is always going to be `[s]`, so `x == sys.stdin`is never going to be `True`（因为`x`is always `s`），所以只有`else`子句才会执行。

也许你的意思是`input = [s, sys.stdin]`？

# git - 不小心拉下同名分支

> ID：13978860
> 
> 赞同：1
> 
> 时间：2012-12-20T19:09:52.530
> 
> 标签：git, branch, git-branch, branching-and-merging

我不小心拉下了一个与本地分支同名的分支

```
* 909a2b5 - (HEAD, feature/form) xxxx <imrane>
* c9d6bc5 - xxxx <imrane>
| * 6e96409 - (origin/feature) xxx <anandmv>
|/  
*   38e35d8 - (origin/develop, origin/HEAD, develop) xxx <imrane> 
```

我已将所有更改提交到本地分支，然后运行

```
git fetch origin 
```

然后尝试跟踪远程分支并得到以下错误

```
git checkout --track origin/feature
error: there are still refs under 'refs/heads/feature'
fatal: Failed to lock ref for update: Is a directory 
```

问题：
1\. 如何在不丢失功能/表单上的提交的情况下还原
2\. 如何在不发生命名冲突的情况下拉下分支？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T19:39:21.403

您稍微误解了您的情况：

*   你不需要恢复任何东西，你没有失去任何东西
*   您的情况如下：您有一个名为 的本地分支`feature/form`，远程有一个名为 的分支`feature`。现在这可能会让人感到意外，但这些名称相互冲突。`feature/form`实际上创建了一个名为“feature”的*文件夹*，其中包含一个名为“form”的分支。因此，您无法创建名为“feature”的分支，因为具有该名称的文件夹已经存在。
*   `git checkout --track origin/feature`尝试创建一个名为“feature”的分支，这是不可能的，所以它失败了。
*   关于问题 2：嗯，只是*存在*命名冲突——这两个分支不能在您的本地存储库中共存。但是您**可以**在远程`feature`分支上工作，而无需删除或重命名本地`feature/form`分支——尽管我不建议这样做，因为在那里很容易混淆。
*   运行此命令：

    ```
    git checkout -b mylocalname --track origin/feature 
    ```

    将生成一个名为的本地分支`mylocalname`，用于跟踪 remote`feature`上的远程分支`origin`。

# facebook - 为 oauth 请求点击 Facebook 图形 URL 时收到异常

> ID：13978861
> 
> 赞同：0
> 
> 时间：2012-12-20T19:09:53.557
> 
> 标签：facebook, scribe

我正在尝试找出调试/验证 facebook 图形 URL 的最佳方法（我正在尝试在 URL 中为 oauth 指定权限），例如：

```
https://graph.facebook.com/me?fields=name,picture,email,likes,interests,gender,id,locale,friends,first_name,last_name,link,user_about_me,friends_about_me&access_token=%s 
```

但是，我不断收到一条错误消息，指出 socialauth 无法正常工作（我在调试模式下使用 scribe/Java）。我找不到其他错误消息。我可以使用较小的 URL 正确地运行 oauth 并且我不确定问题是出在我要求的权限还是我正在创建的字符串上。任何有关如何解决或解决问题的见解将不胜感激。对于任何反对者，寻求生活！

编辑：如帖子中所述，我正在使用 scribe-java 进行 oauth。我尝试了上面的 URL（正如我在帖子中提到的那样），但它在 scribe 中给了我一个异常（我对 scribe 使用了调试模式，但除了“社交身份验证无法正常工作”之外，我没有看到任何错误消息）。当我尝试相同的 URL 但 URL 中没有“ **user_about_me,friends_about_me** ”时，我会收到来自 Facebook 的成功 oauth 响应。值“user_about_me,friends_about_me”对于 oauth URL 是否无效，或者我可能需要更深入地了解 scribe 如何将其传达给 FB？如果我正在做的事情不正确，我不会感到惊讶——我只需要了解如何最好地解决这个问题。

# javascript - 尝试协助 JavaScript 垃圾收集器有意义吗？

> ID：13978873
> 
> 赞同：18
> 
> 时间：2012-12-20T19:10:43.433
> 
> 标签：javascript, garbage-collection

随着我越来越多地将 JavaScript 用作高级面向对象的语言，我发现自己像完成对象后的 C/C++ 程序员一样思考。我知道 GC 最终会运行并清理我的烂摊子，但是我能做些什么来真正帮助它吗？

例如，我有一个大/复杂的主要对象数组......每个主要对象可能有数组和其他辅助对象引用。如果我完成了一个主要对象并将其从数组中删除，那么 GC 可能最终会找出该对象本身指向的所有其他内容，循环内部引用等等。但是，从存储数组中删除主要对象以通过它并且 array.length=0 任何数组和 reference=null 任何对象基本上使 GC 工作更容易（例如，显式删除引用对 GC 来说意味着更少追踪）？如果你愿意的话，一种手动析构函数。这样做是否值得，还是我浪费时间/精力而获得很少/没有收益？

我想这更像是 GC 问题的一般理论（Java 等），但出于这个问题的目的，我主要对 JavaScript 感兴趣。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T19:36:07.147

很少。

这与从未不同。

通常，如果您以合理的方式进行开发，未使用的对象将适当地超出范围，垃圾收集器将按预期工作。除非您真正了解自己在做什么，否则帮助垃圾收集器完成其工作的努力通常不会按预期工作。垃圾收集是由各种 Javascript 引擎的创建者进行了重大优化的领域。一般来说，你不应该弄乱它，除非：

*   您已经通过分析工具的硬数据向自己**证明了存在真正的需求，并且**
*   您可以展示对**实际需要更改**的内容的真正理解，以帮助垃圾收集器。

这些都不是容易实现的。

所以也许最好的答案是，除非你已经足够先进来理解异常，否则你可能不应该担心这个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T19:52:42.270

这可能取决于特定的垃圾收集器，因此答案取决于您使用的 JavaScript 引擎。

首先，我会注意到最好的应用程序代码会做两件事。它实现了功能和性能的技术目标，并且能够适应变化。附加代码应该足以证明增加的复杂性是合理的。

话虽如此，根据[谷歌关于 V8 的注释](https://developers.google.com/v8/design#garb_coll)，这是 Chrome 使用的 JavaScript 引擎，

> V8 回收被称为垃圾收集的过程中不再需要的对象使用的内存。为了确保快速的对象分配、短的垃圾收集暂停和没有内存碎片，V8 采用了一个停止世界的、分代的、准确的垃圾收集器。这意味着 V8：
> 
> *   执行垃圾回收周期时停止程序执行。
> *   在大多数垃圾回收周期中只处理对象堆的一部分。这最大限度地减少了停止应用程序的影响。
> *   总是知道所有对象和指针在内存中的确切位置。这避免了将对象错误地识别为可能导致内存泄漏的指针。
> 
> 在 V8 中，对象堆被分成两部分：创建对象的新空间，以及在垃圾回收周期中幸存的对象被提升到的旧空间。如果在垃圾回收周期中移动了一个对象，V8 会更新所有指向该对象的指针。

分代垃圾收集器倾向于在堆之间移动对象，其中所有活动对象都被移动到目标堆中。任何未移动到目的地的东西都被视为垃圾。目前尚不清楚 V8 垃圾收集器如何识别活动对象，但我们可以查看其他一些 GC 实现来寻找线索。

作为一个记录良好的 GC 实现的行为示例，Java 的 Concurrent Mark-Sweep 收集器：

1.  停止应用程序。
2.  构建可从应用程序代码访问的对象列表。
3.  恢复应用程序。同时，CMS 收集器运行一个“标记”阶段，在此阶段它将传递可到达的对象标记为“非垃圾”。由于这与程序执行并行，它还跟踪应用程序所做的引用更改。
4.  停止应用程序。
5.  运行第二个（“remark”）阶段以标记新可到达的对象。
6.  恢复应用程序。同时，它“清扫”所有标识为垃圾的对象并回收堆块。

它基本上是一个图遍历，从一组特定的节点开始。由于无法访问断开连接的对象，因此它们与其他断开连接的对象的连接不应该发挥作用。

[在http://www.oracle.com/technetwork/java/javase/memorymanagement-whitepaper-150215.pdf](http://www.oracle.com/technetwork/java/javase/memorymanagement-whitepaper-150215.pdf)上有一份关于 Java 垃圾收集工作方式的不错的白皮书，虽然有些过时。垃圾收集并不是 Java 独有的，所以我怀疑 Java 虚拟机和其他运行时（如 JavaScript 引擎）采用的各种方法之间存在一些相似之处。

Raymond Chen 写了[一篇博文](http://blogs.msdn.com/b/oldnewthing/archive/2012/01/05/10253268.aspx)指出，即将释放的步行记忆会对性能产生负面影响。上下文是在应用程序关闭时手动释放内存。由于块可能已被交换到磁盘，遍历引用的行为可能会导致这些块被交换。在这种情况下，程序正在遍历刚刚被标记为可用且保持不变的块。

因此，在操作系统可能已经换出一些块的情况下，“协助”垃圾收集器的行为，特别是在寿命较长的对象上，最终可能会减慢速度。

如果您没有生成足够的数据来担心换出，那么合理的垃圾收集器不会花费足够长的时间来注意到。

So chances are it's not worth the effort, and could be counterproductive. Although it probably makes sense to drop the references to the heap "dominators". These are the objects that, if collected, would allow the collection of many other objects. So drop the reference to the collection itself, but not to each item within the collection.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-20T19:33:03.587

非常聪明的人在这些垃圾收集模型上下了很大功夫。您所做的任何事情都会大大提高他们实施的性能的可能性相对较低。

如果垃圾收集正在成为您的主要成本，那么您最好专注于减少必须进行垃圾收集的对象数量（考虑[对象池模式](http://en.wikipedia.org/wiki/Object_pool_pattern)）

# c# - C# 和任务 - UI 线程挂起 - Pre-Async/Await 关键字

> ID：13978879
> 
> 赞同：5
> 
> 时间：2012-12-20T19:11:08.547
> 
> 标签：c#, asynchronous, task-parallel-library, async-await

当我无权访问用于检索数据的客户端库时，我试图了解异步获取一组数据的正确代码。我指定了一个端点和一个日期范围，我应该检索一个播放列表列表。在 Start() 调用之后，我现在再也没有回来过。注意：这是在 WinForm 中运行的。我试图更好地理解任务，而不只是想跳到等待或 BackgroundWorker。我知道我在某个地方迷路了。

```
 private void GoButtonClick(object sender, EventArgs e)
    {
        string baseUrl = "http://someserver/api";
        var startDateTime = this._startDateTimePicker.Value;
        var endDateTime = this._endDateTimePicker.Value;
        _getPlaylistsFunc = delegate()
            {
                var client = new PlaylistExportClient(baseUrl);
                return client.GetPlaylistsByDateRange(startDateTime, endDateTime).ToList();
            };
        var task = new Task<List<Playlist>>(_getPlaylistsFunc);
        task.ContinueWith((t) => DisplayPlaylists(t.Result));
        task.Start();
    }

    private void DisplayPlaylists(List<Playlist> playlists)
    {
        _queueDataGridView.DataSource = playlists;
    } 
```

**更新** 我做了这些更改，但现在应用程序似乎挂起 UI 线程。

```
 private void GoButtonClick(object sender, EventArgs e)
    {
        string baseUrl = "http://someserver/api";
        var startDateTime = this._startDateTimePicker.Value;
        var endDateTime = this._endDateTimePicker.Value;
        var token = Task.Factory.CancellationToken;

        var context = TaskScheduler.FromCurrentSynchronizationContext();
        Task.Factory.StartNew(() =>
            {
                var client = new PlaylistExportClient(baseUrl);
                _queueDataGridView.DataSource = client.GetPlaylistsByDateRange(startDateTime, endDateTime).ToList();

            },token,TaskCreationOptions.None,context);

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T20:31:43.410

我建议您使用基于任务的异步模式。这很简单：

```
private async void GoButtonClick(object sender, EventArgs e)
{
    string baseUrl = "http://someserver/api";
    var startDateTime = this._startDateTimePicker.Value;
    var endDateTime = this._endDateTimePicker.Value;
    var playlists = await Task.Run(() =>
    {
        var client = new PlaylistExportClient(baseUrl);
        return client.GetPlaylistsByDateRange(startDateTime, endDateTime).ToList();
    });
    _queueDataGridView.DataSource = playlists;
} 
```

请注意，这将阻塞线程池线程；如果您可以将库修改为具有`GetPlaylistsByDateRangeAsync`方法，则可以提高效率。

**编辑：**如果您卡在 .NET 4.0 上，您可以安装[Microsoft.Bcl.Async](https://nuget.org/packages/Microsoft.Bcl.Async)以获得完整的`async`/`await`功能。如果 - 由于某些莫名其妙的原因 - 你*仍然*不能使用`async`/ `await`，那么你可以这样做：

```
private void GoButtonClick(object sender, EventArgs e)
{
    string baseUrl = "http://someserver/api";
    var startDateTime = this._startDateTimePicker.Value;
    var endDateTime = this._endDateTimePicker.Value;
    var context = TaskScheduler.FromCurrentSynchronizationContext();
    Task.Run(() =>
    {
        var client = new PlaylistExportClient(baseUrl);
        return client.GetPlaylistsByDateRange(startDateTime, endDateTime).ToList();
    }).ContinueWith(t =>
    {
        _queueDataGridView.DataSource = t.Result;
    }, context);
} 
```

但是，请注意，使用这种方法您的错误处理更加复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T20:16:40.280

看起来您正在分配给后台线程中的 UI 控件的属性。这通常是坏消息。当您这样做时，WPF 通常会引发异常，不确定 WinForms。

在后台线程中捕获数据，但在将其分配给 UI 控件之前切换回主 UI 线程。尝试使用类似的方式将数据发布到 UI 线程

```
 var uiSync = SynchronizationContext.Current;
    Task.Factory.StartNew(() =>
        {
            var client = new PlaylistExportClient(baseUrl);
            var list = client.GetPlaylistsByDateRange(...).ToList();
            uiSync.Post(() => _queueDataGridView.DataSource = list, null);
        },token,TaskCreationOptions.None,context); 
```

# javascript - 静态表更改上的 DOM 侦听器

> ID：13978883
> 
> 赞同：0
> 
> 时间：2012-12-20T19:11:30.513
> 
> 标签：javascript, dom, events, listener, dom-events

我正在尝试将侦听器添加到我的表中以调用另一个 jJavascript 函数。

我的应用程序是一个简单的上传脚本，当用户选择它上传的文件并在表中创建新行时。因此，在每次创建新行时，我都想调用一个 Javascript 函数。

我的示例代码如下：

```
$("#fayls").bind("DOMNodeInserted", function() {
    $(".chzn-select").chosen();
    alert('ha cambiato')
}); 
```

`fayls`我的桌子的ID在哪里。

当我运行此代码时，它会无限调用此事件而不仅仅是一个事件。

我应该如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:28:06.437

我认为问题在于，Chosen 插件会转换该容器内带有`"#fayls"`ID 的元素。考虑一下：

HTML：

```
<div id="something"></div>
<div id="completely_different"></div>
<button id="change_something" type="button">Change!</button> 
```

JS：

```
$('#change_something').click(function() {
    $('#something').append($('<p>Internal P</p>'));
});
$('#something').bind("DOMNodeInserted", function(event) {
    alert(event.target);
    $("#completely_different").append($('<p>SOme p</p>'));
}); 
```

[JS小提琴](http://jsfiddle.net/bPEQn/2/)

它按预期工作（每次单击按钮都会将一个`<p>`元素添加到两个 div 中）。

现在让我们稍微改变一下我们的 HTML：

```
<div id="something">
    <div id="completely_different"></div>
</div>
<button id="change_something" type="button">Change!</button> 
```

[JS小提琴](http://jsfiddle.net/bPEQn/)

...现在该事件将无限期地触发 - 因为当我们更新内部 div 时，DOMNodeInserted 仍然会冒泡到外部。

另请注意，DOMNodeInserted 事件现在被认为[已弃用](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)（但在 IE9 中它的支持仍然存在缺陷，如此[处](http://help.dottoro.com/ljmcxjla.php)所述）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:43:25.760

您遇到了问题，因为该事件也将在父节点（气泡）处分派

来自 W3C

> DOMNodeInserted: - 当一个节点被添加为另一个节点的子节点时触发。- 在插入发生后调度此事件。
> - 这个事件的目标是被插入的节点。- 气泡：是 - 可取消：否 - 上下文信息：relatedNode 持有父节点

添加行并绑定它以更新组合框时尝试调度自定义事件

绑定事件使用：

```
$('#something').bind('row.added', function(event) {
    event.stopPropagation();
    //your code here
} 
```

触发事件（添加行后）使用：

```
$('#something').trigger('row.added'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T13:36:23.663

正如你们都提到的，问题是由选择引起的，对于选择的每个下拉框项目，它都会触发 DOM 事件，因此我将有无限循环。

我通过过滤不必要的事件找到了一个简单的解决方案：

```
 $("#listenMe").bind("DOMNodeInserted", function(event) {

        var targetName =  event.target.nodeName.toString() ;
        if (targetName == "TR") {
            $(".chzn-select").chosen();
            //alert('ha cambiato - Event Node Name:' + event.target.nodeName)
        }
    }); 
```

因此，它仅在将新行添加到表中时运行

# php - 解析错误：语法错误，文件意外结束（注册脚本）

> ID：13978885
> 
> 赞同：-3
> 
> 时间：2012-12-20T19:11:31.810
> 
> 标签：php, file, parsing

我的脚本有问题：S

> 这是错误：解析错误：语法错误，文件意外结束

这是完整的代码。我搜索了未闭合的括号或其他东西，但没有找到任何东西：S 我希望你们中的一些人能找到问题。

```
<?php
include "header.php";
include "menu.php";
?>
<div class="wrapper">
<table width=100%>
    <td valign=top width=230px>
        <div class="login">
        <form name="register" method="post" action="$_SERVER[PHP_SELF]" onsubmit="return validateregister()">
        <input type="text" name="username" placeholder="Username"/><br />
        <input type="password" name="password" placeholder="Password"/><br />
        <input type="password" name="passwordagain" placeholder="Password again"/><br />
        <input type="text" name="email" placeholder="E-mail"/><br />
        <input type="text" name="mcname" placeholder="Minecraft Name"/><br />
        <?php
        $captchaquery = mysql_query('SELECT * FROM general');
        $captcha = mysql_fetch_array($captchaquery);
        if($captcha['captcha'] == 'enabled')
        {
            require_once('functions/recaptchalib.php');
            $publickey = $captcha['captchapublic'];
            echo recaptcha_get_html($publickey);
        }
        ?>
        <input class="btn" type="submit" name="register" value="Register" />
        </form>
        </div>
    </td>
    <td valign=top>
        <div id="errors" style="width:80%; margin-left:auto; margin-right:auto;"></div>
    </td>
</table>
<?php
if(isset($_POST['register']))
{
    if($captcha['captcha'] == 'enabled')
    {
        require_once('recaptchalib.php');
        $privatekey = $captcha['captchaprivate'];
        $resp = recaptcha_check_answer ($privatekey,
                                $_SERVER["REMOTE_ADDR"],
                                $_POST["recaptcha_challenge_field"],
                                $_POST["recaptcha_response_field"]);

        if (!$resp->is_valid) {
        die ("The reCAPTCHA wasn't entered correctly. Go back and try it again." . "(reCAPTCHA said: " . $resp->error . ")");
    }
    else
    {
    registerUser($_POST['username'], $_POST['password'], $_POST['passwordagain'], $_POST['email'], $_POST['mcname']);
    }
}
include "footer.php";
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T19:12:43.410

您忘记了此语句的右括号：

```
if (!$resp->is_valid) {
    die ("The reCAPTCHA wasn't entered correctly. Go back and try it again." . "(reCAPTCHA said: " . $resp->error . ")");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:13:33.263

```
if (!$resp->is_valid) {
    die ("The reCAPTCHA wasn't entered correctly. Go back and try it again." . "(reCAPTCHA said: " . $resp->error . ")"); 
```

if 没有右花括号。

# emacs - 如何删除 Emacs 中的空格和回车符号？

> ID：13978887
> 
> 赞同：2
> 
> 时间：2012-12-20T19:11:40.967
> 
> 标签：emacs, whitespace, carriage-return

每当我编辑 Python 或 ELisp 脚本时，Emacs 会为每个回车显示一个“$”，并为每个空格显示一个居中的点。我不知道如何禁用或摆脱此设置。在 Google 上查看后，我尝试禁用本地和全局空白模式，但没有运气。

我试图注释掉 .Emacs 文件中所有可能的行，但当这不起作用时，我完全删除了主路径中的 .Emacs 文件。我在 OSX 10.7 上运行 Emacs 24.2。

有谁知道我可以做些什么来删除这些字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:15:37.987

您可以在此处获取完整文档：

[http://emacswiki.org/emacs/WhiteSpace](http://emacswiki.org/emacs/WhiteSpace)

> 要在本地停用 WhiteSpace，请键入：Cu 0 Mx whitespace-mode RET
> 
> 要全局停用 WhiteSpace，请键入：Cu 0 Mx > global-whitespace-mode RET

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T16:08:24.753

我能够通过执行以下操作来解决此问题：

Mx customize 在编辑字段中，我输入了“空格”。

这将我带到了一个设置菜单，我可以在其中将 global-whitespace-mode 设置为“nil”。

现在，我又爱上了我的 EMACS....

# git - 上传时远程拒绝 git push 错误

> ID：13978889
> 
> 赞同：0
> 
> 时间：2012-12-20T19:11:50.300
> 
> 标签：git, open-source, repository

有没有人在执行 git push 之前看到过这个错误？调试或克服错误的任何提示？

```
mkdir opensource && cd opensource
git clone git://git.qinc.com/platform/vendor/q-opensource/wcn/prime.git
cd prime
git checkout -b jb_2.5 origin/jb_2.5
git cherry-pick -x ..7174961054435d3ae9d233c81227b0715cfc1715
git push ssh://review-android.qinc.com:29418/platform/vendor/q-opensource/wcn/prime.git jb_2.5:refs/for/jb_2.5

test@wcn-linux5:/local/mnt2/workspace2/test/LA_builds/opensource_JB2.5/prime$ git push ssh://review-android.qinc.com:29418/platform/vendor/q-opensource/wlan/prime.git jb_2.5:refs/for/jb_2.5
Enter passphrase for key '/usr2/test/.ssh/id_rsa':
Counting objects: 662, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (100/100), done.
Writing objects: 100% (148/148), 534.35 KiB, done.
Total 148 (delta 88), reused 97 (delta 47)
remote: Resolving deltas: 100% (88/88)
remote: Processing changes: refs: 1, done   
remote: (W) be1d372: no files changed, was rebased
To ssh://review-android.qinc.com:29418/platform/vendor/q-opensource/wlan/prime.git
! [remote rejected] jb_2.5 -> refs/for/jb_2.5 (no changes made)
error: failed to push some refs to 'ssh://review-android.qinc.com:29418/platform/vendor/q-opensource/wlan/prime.git' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:19:30.450

看起来在推送更改之前您没有拉出推送，因此它会覆盖主分支。您应该拉出 master 分支，然后在您可以推送整个分支后与您的变更集合并。

或者，如果您有权限，您可以使用 push -f，但它会杀死其他人的 push。

# ruby-on-rails-3 - Rails 使用 HAML 闪现消息

> ID：13978891
> 
> 赞同：12
> 
> 时间：2012-12-20T19:12:06.140
> 
> 标签：ruby-on-rails-3, haml

我开始学习 HAML：我无法将闪存块转换为 HAML：

```
<% flash.each do |key, value| %>
  <div class="alert alert-<%= key %>">
    <button type="button" class="close" data-dismiss="alert">×</button>
    <strong><%= value %></strong>
  </div>        
<% end %> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-20T19:16:20.717

干得好：

```
= flash.each do |key, value|
  .alert{ :class => "alert-#{key}" }
    %button.close{ :data => { :dismiss => "alert" } } x
    %strong
      = value 
```

仅供参考，您可以通过在声明后将属性附加为哈希来将属性添加到任何元素。如果您不指定元素，仅指定类或 ID，HAML 会将该元素作为具有给定类或 ID 的 div。但是你可以通过多种方式做到这一点。例如，这些都是一样的：

```
%div{:class => 'foo bar', :id => 'test' }
.foo{:class => 'bar', :id => 'test'}
#test.bar{:class => 'foo'}
#test.foo.bar 
```

所有输出：`<div class="foo bar" id="test"></div>`

您需要将计算属性放入哈希中，即：

```
- klass = "bar"
%div{ :class => klass } 
```

输出：`<div class="bar"></div>`

另外，请注意，在上述所有示例中，`:attribute => 'value'`可以表示为`attribute: 'value'`，例如：

```
%button.close{ data: { dismiss: 'alert' } } x 
```

希望有帮助。

# php - imagemagick没有输出

> ID：13978892
> 
> 赞同：1
> 
> 时间：2012-12-20T19:12:21.377
> 
> 标签：php, imagemagick, imagick

这是我的代码：

```
<?php
error_reporting(E_ALL) ;
$orig = "original.jpg";
$out = "output.jpg";
$cmd = "-sepia-tone 90%";
exec("/usr/bin/convert $orig $cmd $out ");
?> 
```

在我运行这个之后，我期望一个名为 output.jpg 的 original.jpg 的棕褐色版本。当我检查目录时， output.jpg 不存在。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:15:46.410

`<? php`应该是`<?php`。

# javascript - 休假时的 Javascript 拖放无法正常工作

> ID：13978893
> 
> 赞同：1
> 
> 时间：2012-12-20T19:12:25.620
> 
> 标签：javascript, jquery, drag-and-drop

我正在尝试实现与 imgur.com 类似的拖放图像上传功能。您从桌面拖动图像，当您拖动文档时，会出现一个带有“上传”字样的大覆盖 div。

我的问题是，当我拖动 h1 标签内的实际单词“上传”时，屏幕会闪烁。发生这种情况是因为我有一个 dragleave 事件来删除带有上传 h1 标签的覆盖 div 但是我不知道如何修复它。

您可以在此处看到问题的实际效果：[JS Fiddle](http://jsfiddle.net/JUBwS/7/)，只需将任何图像从桌面拖到文档并将鼠标悬停在“上传”一词上，您就会看到我在说什么。任何帮助，将不胜感激。

HTML：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Drag and Drop</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    </head>
    <body>
        <div id="upload-global-drop-overlay" style="display: none;"><h1>upload</h1></div>
    </body>
</html>​ 
```

Javascript代码：

```
$(document).on('dragover', function () {
    $('#upload-global-drop-overlay').css({'display': 'block'});
});

$('#upload-global-drop-overlay').on('dragleave', function () {
    $('#upload-global-drop-overlay').css({'display': 'none'});
});

$(document).on('drop', function (e) {
    $('#upload-global-drop-overlay').css({'display': 'none'});
    e.preventDefault();
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T20:21:12.340

嘿，希望你找到了答案，如果不是，这里有一个小例子，在我看来，它看起来像 imgur，使用你的代码。

**jsFiddle**：http: [//jsfiddle.net/JUBwS/74/](http://jsfiddle.net/JUBwS/74/)

**HTML**：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Drag and Drop</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    </head>
    <body>
        <div id="upload-global-drop-overlay" style="display: none;"><h1>upload</h1></div>
    </body>
</html>​ 
```

**CSS**：

```
#upload-global-drop-overlay {
background: none repeat scroll 0 0 #424242;
height: 100%;
width: 100%;
position: fixed;
top: 0;
left: 0;
opacity: .8;
filter: alpha(opacity=80);
-moz-opacity: .8;
z-index: 10001;
display: none;
}

#upload-global-drop-overlay h1 {
font-size: 72pt;
display: block;
position: absolute;
line-height: 50px;
top: 50%;
left: 50%;
margin: -82px 0 0 -180px;
text-shadow: 3px 3px 4px black;
color: white;
z-index: -1;
}​ 
```

**Javascript**：

```
var isDragging = null;
$(document).on('dragover', function () {
    if(isDragging==null)
        doDrag();

    isDragging = true;
});

$(document).on('drop', function (e) {
    e.preventDefault();
    isDragging = false;
});

$(document).on('dragleave', function (e) {
    isDragging = false;
});

var timerId=0;
function doDrag()
{
  timerId = setInterval(function()
  {
    if(isDragging)
        $('#upload-global-drop-overlay').fadeIn(500);
    else
    {
        $('#upload-global-drop-overlay').fadeOut(500);
        isDragging = null;
        clearInterval(timerId);
    }
  },200);
}​ 
```

此示例使用计时器，但它仅在将某些内容拖入表单时才处于活动状态。我肯定会在未来使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T18:04:45.000

我实际上找到了另一个解决方案，我认为它更简单一些，因为它不使用 setInterval。我已经为任何感兴趣的人实现了实际的拖放功能。

下面提供了具有拖放功能的整个工作示例。

**jsFiddle - 演示：http:** [//jsfiddle.net/6SV9P/1/](http://jsfiddle.net/6SV9P/1/)

**HTML**：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Drag and Drop</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    </head>
    <body>
        <div id="upload-global-drop-overlay" style="display: none;"><h1>upload</h1</div>
        <div id="image"></div>
    </body>
</html>​ 
```

**CSS**：

```
#upload-global-drop-overlay {
    background: none repeat scroll 0 0 #424242;
    height: 100%;
    width: 100%;
    position: fixed;
    top: 0;
    left: 0;
    opacity: .8;
    filter: alpha(opacity=80);
    -moz-opacity: .8;
    z-index: 10001;
    display: none;
}

#upload-global-drop-overlay h1 {
    font-size: 72pt;
    display: block;
    position: absolute;
    line-height: 50px;
    top: 50%;
    left: 50%;
    margin: -82px 0 0 -180px;
    text-shadow: 3px 3px 4px black;
    color: white;
    z-index: -1;
}​ 
```

**JS：**

```
var dragDropFromDesktop = (function ($) {
    $(document).on('dragenter', function () {
        $('#upload-global-drop-overlay').fadeIn(200)
    });

    $('#upload-global-drop-overlay').on('dragleave', function (e) {
        if (e.originalEvent.pageX < 10 || e.originalEvent.pageY < 10 || $(window).width() - e.originalEvent.pageX < 10 || $(window).height - e.originalEvent.pageY < 10) {
            $("#upload-global-drop-overlay").fadeOut(200);
        }
    });

    $('#upload-global-drop-overlay').on('dragover', function (e) {
        e.stopPropagation();
        e.preventDefault();
    });

    // Handle dropped image file - only Firefox and Google Chrome
    $('#upload-global-drop-overlay').on('drop', function (e) {
        $('#upload-global-drop-overlay').fadeOut(200);
        var files = e.originalEvent.dataTransfer.files;
        if (files === undefined) {
            alert('Your browser does not support file Drag and Drop!')
        } else {
            var file = files[0];
            if (typeof FileReader !== "undefined" && file.type.indexOf("image") != -1) {
                var reader = new FileReader();
                reader.onload = function (evt) {
                    var img = new Image();
                    img.src = evt.target.result;
                    $('#image').html('<img src="' + img.src + '">');

                };
                reader.readAsDataURL(file);
            }
        }
        e.preventDefault();
        e.stopPropagation();
    });

})(jQuery);​ 
```

# java - 处理多个 HTTP 连接

> ID：13978897
> 
> 赞同：5
> 
> 时间：2012-12-20T19:12:41.840
> 
> 标签：java, multithreading, http

我完成了一个使用 25 个不同线程的 java 应用程序的编码，每个线程都是一个无限循环，其中发送一个 http 请求并处理返回的 json 对象（小对象）。特定线程发送的两个请求之间的时间必须小于 500 毫秒，这一点至关重要。但是，我对我的程序做了一些基准测试，时间远远超过 1000 毫秒。所以我的问题是：除了创建多个线程之外，还有更好的方法来处理多个连接吗？我迫切需要帮助，所以我很感谢您提供的任何建议！

PS：我有一个不错的互联网连接（我对请求目标服务器的 ping 大约是 120 毫秒）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:16:27.477

我建议看看[Apache HttpClient](http://hc.apache.org/httpcomponents-client-ga/)：

具体来说，您将对构建具有池连接管理器的客户端感兴趣。然后，您可以利用相同的客户端。

```
PoolingClientConnectionManager connectionManager = new PoolingClientConnectionManager();
connectionManager.setMaxTotal(number);

HttpClient client = new DefaultHttpClient(connectionManager); 
```

这是处理您的用例的特定示例：

*   [PoolingConnectionManager 示例](http://hc.apache.org/httpcomponents-client-ga/httpclient/examples/org/apache/http/examples/client/ClientMultiThreadedExecution.java)

# html - 如何在表格 td 中添加边距

> ID：13978904
> 
> 赞同：7
> 
> 时间：2012-12-20T19:12:57.470
> 
> 标签：html, css, html-table

***CSS：***

```
.chash, .java, .php, .jscript, .jQuery, .cplus, .python, .asp, .dotnet, .html,
.objectivec, .iOS, .sql, .css, .rubyr, .c, .xml, .AJAX, .xcode, .linux, .windows,
.vbdotnet, .json, .Apache, .wordpress, .oracle, .Perl, .ActionScript, .flash,
.dothtaccess, .VisualStudio, .GoogleAppEngine, .jsp,. PostgreSQL, .ZendFramework,
.email, .GoogleMaps {  
    background: none repeat scroll 0 0 #FFFFFF;
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.4);
    margin: 10px;
    padding: 5px;
    width: 250px;
    height: 180px;
 }

td {
   padding-right: 20px;
   margin: 10px;
} 
```

***HTML：***

```
<div class="Languages">
  <table>
    <tr>
      <td class="chash"></td>
      <td class="java"></td>
      <td class="php"></td >
      <td class="jscript"></td>
    </tr>
    <tr>
      <td class="jQuery"></td>
      <td class="Perl"></td>
      <td class="dothtaccess"></td>
      <td class="flash"></td>
    </tr>
    <tr>  
      <td class="cplus"></td>
      <td class="python"></td >
      <td class="asp"></td>
      <td class="dotnet"></td>
    </tr>
    <tr>
      <td class="html"></td>
      <td class="email"></td >
      <td class="GoogleMaps"></td>
      <td class="ActionScript"></td>
    </tr>
    <tr>
      <td class="objectivec"></td>
      <td class="iOS"></td>
      <td class="sql"></td>
      <td class="ZendFramework"></td>
    </tr>
    <tr>
      <td class="PostgreSQL"></td>
      <td class="oracle"></td >
      <td class="jsp"></td>
      <td class="css"></td>
    </tr>
    <tr>
      <td class="rubyr"></td >
      <td class="c"></td>
      <td class="xml"></td>
      <td class="AJAX"></td>
    </tr>
    <tr>
      <td class="xcode"></td>
      <td class="wordpress"></td>
      <td class="linux"></td>
      <td class="windows"></td>
    </tr>
    <tr>
      <td class="vbdotnet"></td>
      <td class="json"></td >
      <td class="Apache"></td>
      <td class="GoogleAppEngine"></td>
      <td class="VisualStudio"></td>
    </tr>
  </table>
</div> 
```

**[现场演示](http://www.doers.lk/)**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-20T19:18:48.140

这是在表格单元格之间获得一些间距的一种方法。[在 JSFiddle 上查看](http://jsfiddle.net/K5qwg/)

## HTML

```
​&lt;table>
  <tr>
    <td>
      hi
    </td>
    <td>
      hello
    </td>
  </tr>
</table> 
```

## CSS

```
table {
  border-collapse:separate;
  border-spacing:10px 10px;
}​​​​​​​​​​​​​ 
```

如果您不使用 HTML5：

## HTML4

```
<table cellspacing="5"> 
```

# c++ - Direct2d CreateBitmapfromWICBitmap 在 ATL 中给出断言错误

> ID：13978907
> 
> 赞同：0
> 
> 时间：2012-12-20T19:13:03.680
> 
> 标签：c++, visual-studio-2010, com, atl, direct2d

我有一个简单的函数，它加载一个 Png 文件并将其作为 ID2D1Bitmap 返回。但是当它试图调用 CreateBitmapfromWicBitmap 函数时，它会给出一个调试断言错误。有趣的是，我首先在一个单独的项目中创建了一个 imageload 函数，它在那里工作得很好。这两个函数具有相同的代码，而第二个函数给出错误。

这是错误代码：

```
ID2D1Bitmap* Wnd::LoadPng(LPCWSTR Path) {
    CComPtr<IWICBitmapDecoder> pDecoder;
    CComPtr<IWICBitmapFrameDecode> pFrame;
    CComPtr<ID2D1Bitmap> pBit;
    CComPtr<IWICFormatConverter> pConv;
    HRESULT Hr;

    Hr = m_pWICFactory->CreateDecoderFromFilename(Path,NULL,GENERIC_READ,WICDecodeMetadataCacheOnDemand,&pDecoder);

    if (SUCCEEDED(Hr)) {
        Hr = m_pWICFactory->CreateFormatConverter(&pConv);
    }

    if (SUCCEEDED(Hr)) {
        Hr = pDecoder->GetFrame(0,&pFrame);
    }

    if (SUCCEEDED(Hr)) {
        Hr = pConv->Initialize(pFrame,GUID_WICPixelFormat32bppPBGRA,WICBitmapDitherTypeNone,0,0.f,WICBitmapPaletteTypeCustom);
    }

    if (SUCCEEDED(Hr)) {
        Hr = m_pRT->CreateBitmapFromWicBitmap(pConv,0,&pBit);
    }
    return pBit;
} 
```

错误发生在 atlcomcli.h 函数 _NoAddRefReleaseOnCComPtr 的第 182 行。

我仔细检查了所有头文件和库，它们在两个项目中都是相同的（在第二个项目中有一些额外的头文件）。

这是有效的代码：

```
 CComPtr<IWICFormatConverter> Conv;
        m_pWICFactory->CreateFormatConverter(&Conv);
        CComPtr<IWICBitmapFrameDecode> Frame;
        m_pDecoder->GetFrame(0,&Frame);
        Frame->GetSize(&W,&H);
        Conv->Initialize(Frame,GUID_WICPixelFormat32bppPBGRA,WICBitmapDitherTypeNone,0,0.f,WICBitmapPaletteTypeCustom);
        CComPtr<ID2D1Bitmap> Bit;
        Hr = m_pRT->CreateBitmapFromWicBitmap(Conv,0,&Bit);
        m_pBitmap.push_back(Bit); 
```

BitmapDecoder 在这里预定义，但它与第一​​个片段中的完全相同。

- - - - - - - - - - - - - - - - 固定的 - - - - - - - - - ----------

第三次我忘记为我的渲染目标调用初始化函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:28:40.120

断言失败警告您正在尝试通过模板“使用”`NULL`接口指针。`CComPtr`您应该在调用堆栈上查找您所在的代码的确切行，以及哪个变量包含您希望为非 NULL 的 NULL 指针。或者，只需使用调试器单步执行您的代码。

# java - Java 的异常行为实例

> ID：13978909
> 
> 赞同：9
> 
> 时间：2012-12-20T19:13:13.273
> 
> 标签：java, boolean, instanceof

谁能解释为什么下面的 if 语句评估为假？

```
public void addShapeToWhiteboard(PolyLine shape)
{
   Window.alert("2");
   if(shape instanceof PolyLine)
   {
      Window.alert("3");
      this.whiteboard.add((PolyLine)shape);
      Window.alert("3.5");
   }    
   this.whiteboard.draw();
   Window.alert("4");
} 
```

它接受一个“PolyLine”对象，但 instanceof 返回 false，因为我收到“2”警报，然后是“4”警报，并且不知道它是如何可能的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-20T19:16:05.913

也许形状为空？在这种情况下，instanceof 返回 false。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-20T19:16:25.127

我打赌`shape`作为 传递`null`，并且`null`不是任何类的实例。

# java - 比较数组字符串

> ID：13978915
> 
> 赞同：0
> 
> 时间：2012-12-20T19:13:37.753
> 
> 标签：java, arrays, list

用户输入一个数字数组，例如“123456789”，然后用户应该输入一个命令字符串，例如“PE”，我的程序将检查字符串中的每个字符。

P = 删除最后输入的数字，即 9
E = 打印出最终结果。

至此，一切正常。

但我的问题是，当用户输入“P（任意数字）”时，我必须能够读取命令，并且我必须将该数字放在数字数组的末尾。

因此，如果它是 P(4)，则结果将是“1234567894”。

我怎样才能做到这一点 ？

这就是我现在对P和E的看法。

```
if (commandList.get(x).equals("P(")) {
    JOptionPane.showMessageDialog(null, "HI");
}
else if (commandList.get(x).equals("P")) {
    strList.remove(strList.size()-1);
    x++;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:51:35.367

据我了解，您的问题是从字符串“P（*数字）”中**提取*“*数字*”？

 *那么你必须解析输入字符串，例如，通过搜索边界字符，这里是'（'和'）'。例如通过这样的事情：

```
String s = "P(3)";
String number = s.substring(s.indexOf("(") + 1, s.indexOf(")"));
strList.append(number); 
```

但这也将接受括号内的*任何*内容，例如“P(foooo)”中的“foooo”，如果找不到')'，它会崩溃，例如，s =“P(123”，它会接受“ P(3)blah54" 严格来说是无效的。为了改进您的解析器，您可以使用正则表达式，例如，检查输入是否恰好是单个数字的“P(2)”形式，您可以使用

```
String s = "P(3)";
if (!s.matches("P\\(\\d\\)"))
    throw new RuntimeException("invalid input format: " + s);
String number = s.substring(s.indexOf("(") + 1, s.indexOf(")"));
strList.append(number); 
```

如果您明确想要将数字转换为 int，您可以查看 Integer.parseInt(...)，例如，

```
int i = Integer.parseInt(number); 
```*

# c++ - 将可变参数列表插入向量中？

> ID：13978916
> 
> 赞同：29
> 
> 时间：2012-12-20T19:13:44.290
> 
> 标签：c++, c++11, variadic-functions

如果这已经回答了，请原谅我，因为我找不到它......

基本上我有一个对象需要在它的构造函数中获取一个可变参数列表并将参数存储在一个向量中。如何从可变参数构造函数的参数初始化向量？

```
class GenericNode {
public:
    GenericNode(GenericNode*... inputs) {
            /* Something like... */
        // inputs_.push_back(inputs)...;
}
private:
    std::vector<GenericNode*> inputs_;
}; 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-20T20:11:33.997

*最好*的办法是使用初始化列表

```
#include <initializer_list>
#include <vector>
class GenericNode {
public:
    GenericNode(std::initializer_list<GenericNode*> inputs) 
        :inputs_(inputs) {} //well that's easy
private:
    std::vector<GenericNode*> inputs_;
};
int main() {
    GenericNode* ptr;
    GenericNode node{ptr, ptr, ptr, ptr};
} //compilation at http://stacked-crooked.com/view?id=88ebac6a4490915fc4bc608765ba2b6c 
```

最接近你已经拥有的，使用 C++11 是使用向量的 initializer_list：

```
 template<class ...Ts>
    GenericNode(Ts... inputs) 
        :inputs_{inputs...} {} //well that's easy too
    //compilation at http://stacked-crooked.com/view?id=2f7514b33401c51d33677bbff358f8ae 
```

这是一个完全没有 initializer_lists 的 C++11 版本。它丑陋且复杂，并且需要许多编译器缺少的功能。使用初始化列表

```
template<class T>
using Alias = T;

class GenericNode {
public:
    template<class ...Ts>
    GenericNode(Ts... inputs) { //SFINAE might be appropriate
         using ptr = GenericNode*;
         Alias<char[]>{( //first part of magic unpacker
             inputs_.push_back(ptr(inputs))
             ,'0')...,'0'}; //second part of magic unpacker
    }
private:
    std::vector<GenericNode*> inputs_;
};
int main() {
    GenericNode* ptr;
    GenericNode node(ptr, ptr, ptr, ptr);
} //compilation at http://stacked-crooked.com/view?id=57c533692166fb222adf5f837891e1f9
//thanks to R. Martinho Fernandes for helping me get it to compile 
```

与一切无关，我不知道那些是否拥有指针。如果是，请`std::unique_ptr`改用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-20T20:55:14.753

```
 // inputs_.push_back(inputs)...; 
```

这不起作用，因为您不能将参数包扩展为语句，只能在某些上下文中，例如函数参数列表或初始化程序列表。

此外，您的构造函数签名是错误的，如果您尝试编写可变参数模板，它必须是模板！

正确编写构造函数签名后，答案很简单，只需使用包扩展构造向量：

```
#include <vector>

class GenericNode
{
public:
  template<typename... T>
    GenericNode(T*... inputs) : inputs_{ inputs... }
    { }
private:
    std::vector<GenericNode*> inputs_;
}; 
```

（您可以改为在构造函数主体中设置它：

```
inputs_ = { inputs... }; 
```

但是很酷的孩子在构造函数体中使用成员初始化器而不是赋值。）

此解决方案的缺点是模板构造函数接受任何类型的指针参数，但如果参数不可转换为`GenericNode*`. 您可以将模板限制为仅接受`GenericNode`指针，但是如果您按照其他答案的建议并使构造函数采用 a `std::initializer_list<GenericNode*>`，那么这就是自动发生的事情，然后您就不需要任何丑陋的`enable_if`SFINAE 技巧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-20T20:06:42.537

除非它是模板，否则您不能使用可变参数列表，如前所述，您可以像这样使用 initializer_list：

```
class GenericNode {
public:
    GenericNode(std::initializer_list<GenericNode*> inputs) : inputs_(inputs)
    {
    }
private:
    std::vector<GenericNode*> inputs_;
};

template <class ... T>
GenericNode* foo(T ... t)
{
    return new GenericNode({t...});
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-29T02:11:03.210

```
class Blob
 {
    std::vector<std::string> _v;
 public:

    template<typename... Args>
    Blob(Args&&... args)
    : _v(std::forward<Args>(args)...)
    {  }

};

int main(void)
{
    const char * shapes[3] = { "Circle", "Triangle", "Square" };

    Blob b1(5, "C++ Truths"); 
    Blob b2(shapes, shapes+3);
} 
```

C++11 Truths 中的示例看起来很简单......;) 不是一个完整的解决方案，但可能会给你一些想法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-21T00:18:54.950

另一种方法：

```
#include <iostream>
#include <vector>

using std::vector;

template <typename T>
void variadic_vector_emplace(vector<T>&) {}

template <typename T, typename First, typename... Args>
void variadic_vector_emplace(vector<T>& v, First&& first, Args&&... args)
{
    v.emplace_back(std::forward<First>(first));
    variadic_vector_emplace(v, std::forward<Args>(args)...);
}

struct my_struct
{
    template <typename... Args>
    my_struct(Args&&... args)
    {
        variadic_vector_emplace(_data, std::forward<Args>(args)...);
    }

    vector<int>& data() { return _data; }

private:
  vector<int> _data;
};

int main()
{
    my_struct my(5, 6, 7, 8);

    for(int i : my.data())
      std::cout << i << std::endl;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-28T04:47:15.570

我最近编写了以下函数，它接受一个带有 {1} 、 {2} 、 {3} ... 的字符串并替换参数列表。我遇到了同样的问题，直到我决定让编译器使用 auto 关键字自行解决。

```
#include <string>
#include <vector>

using std::string;
using std::vector;

template<typename S, typename... Args>
string interpolate( const S& orig , const Args&... args)
{
   string out(orig);

   auto va = {args...};
   vector<string> v{va};

   size_t i = 1;

   for( string s: v)
    {
      string is = std::to_string(i);
      string t = "{" +  is + "}";
      try
         {
           auto pos = out.find(t);
           if(pos != out.npos) 
              {
                 out.erase(pos, t.length());
                 out.insert( pos, s); 
              }                  
           i++;
         }
    catch( std::exception& e)
       {
          std::cerr << e.what() << std::endl;
       }
     } // for

   return out;
 } 
```

显然，只要类型正确排列就足够了。在这种情况下，我始终只使用 std::string 。我认为这是一种优雅的技术，但它可能有缺点。

# r - apply() 很慢 - 如何让它更快或者我的选择是什么？

> ID：13978918
> 
> 赞同：16
> 
> 时间：2012-12-20T19:14:03.500
> 
> 标签：r, apply, r-faq

我有一个相当大的数据框，大约有 1000 万行。它有列`x`和`y`，我想要计算

```
hypot <- function(x) {sqrt(x[1]^2 + x[2]^2)} 
```

对于每一行。使用`apply`它会花费大量时间（大约 5 分钟，从较小的尺寸进行插值）和内存。

但这对我来说似乎太多了，所以我尝试了不同的东西：

*   编译`hypot`函数减少了大约 10% 的时间
*   使用函数 from`plyr`大大增加了运行时间。

做这件事的最快方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-20T19:21:26.360

怎么样`with(my_data,sqrt(x^2+y^2))`？

```
set.seed(101)
d <- data.frame(x=runif(1e5),y=runif(1e5))

library(rbenchmark) 
```

两种不同的每行功能，一种利用矢量化：

```
hypot <- function(x) sqrt(x[1]^2+x[2]^2)
hypot2 <- function(x) sqrt(sum(x^2)) 
```

也尝试编译这些：

```
library(compiler)
chypot <- cmpfun(hypot)
chypot2 <- cmpfun(hypot2)

benchmark(sqrt(d[,1]^2+d[,2]^2),
          with(d,sqrt(x^2+y^2)),
          apply(d,1,hypot),
          apply(d,1,hypot2),
          apply(d,1,chypot),
          apply(d,1,chypot2),
          replications=50) 
```

结果：

```
 test replications elapsed relative user.self sys.self
5       apply(d, 1, chypot)           50  61.147  244.588    60.480    0.172
6      apply(d, 1, chypot2)           50  33.971  135.884    33.658    0.172
3        apply(d, 1, hypot)           50  63.920  255.680    63.308    0.364
4       apply(d, 1, hypot2)           50  36.657  146.628    36.218    0.260
1 sqrt(d[, 1]^2 + d[, 2]^2)           50   0.265    1.060     0.124    0.144
2  with(d, sqrt(x^2 + y^2))           50   0.250    1.000     0.100    0.144 
```

As expected the `with()` solution and the column-indexing solution à la Tyler Rinker are essentially identical; `hypot2` is twice as fast as the original `hypot` (but still about 150 times slower than the vectorized solutions). As already pointed out by the OP, compilation doesn't help very much.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-20T23:04:05.167

While Ben Bolkers answer is comprehensive, I will explain other reasons to avoid `apply` on data.frames.

`apply` will convert your `data.frame` to a matrix. This will create a copy (waste of time and memory), as well as perhaps causing unintended type conversions.

Given that you have 10 million rows of data, I would suggest you look at the `data.table` package that will let you do things efficiently in terms of memory and time.

* * *

For example, using `tracemem`

```
x <- apply(d,1, hypot2)
tracemem[0x2f2f4410 -> 0x2f31b8b8]: as.matrix.data.frame as.matrix apply 
```

This is even worse if you then assign to a column in `d`

```
d$x <- apply(d,1, hypot2)
tracemem[0x2f2f4410 -> 0x2ee71cb8]: as.matrix.data.frame as.matrix apply 
tracemem[0x2f2f4410 -> 0x2fa9c878]: 
tracemem[0x2fa9c878 -> 0x2fa9c3d8]: $<-.data.frame $<- 
tracemem[0x2fa9c3d8 -> 0x2fa9c1b8]: $<-.data.frame $<- 
```

4 copies! -- with 10 million rows, that will probably come and bite you at somepoint.

If we use `with`, there is no `copying` involved, if we assign to a vector

```
y <- with(d, sqrt(x^2 + y^2)) 
```

But there will be if we assign to a column in the data.frame `d`

```
d$y <- with(d, sqrt(x^2 + y^2))
tracemem[0x2fa9c1b8 -> 0x2faa00d8]: 
tracemem[0x2faa00d8 -> 0x2faa0f48]: $<-.data.frame $<- 
tracemem[0x2faa0f48 -> 0x2faa0d08]: $<-.data.frame $<- 
```

Now, if you use `data.table` and `:=` to assign by reference (no copying)

```
 library(data.table)
 DT <- data.table(d)

tracemem(DT)
[1] "<0x2d67a9a0>"
DT[,y := sqrt(x^2 + y^2)] 
```

No copies!

* * *

Perhaps I will be corrected here, but another memory issue to consider is that `sqrt(x^2+y^2))` will create 4 temporary variables (internally) `x^2`, `y^2`, `x^2 + y^2` and then `sqrt(x^2 + y^2))`

The following will be slower, but only involve two variables being created.

```
 DT[, rowid := .I] # previous option: DT[, rowid := seq_len(nrow(DT))]
 DT[, y2 := sqrt(x^2 + y^2), by = rowid] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T01:53:31.097

R is vectorised, so you could use the following, plugging in your own matrix of course

```
X = t(matrix(1:4, 2, 2))^2
>      [,1] [,2]
 [1,]    1    4
 [2,]    9   16

rowSums(X)^0.5 
```

Nice and efficient :)

# java - 单元测试的适当方法封装

> ID：13978919
> 
> 赞同：5
> 
> 时间：2012-12-20T19:14:10.437
> 
> 标签：java, unit-testing, methods, junit, encapsulation

我的课程包含`14 private methods`和`1 public method`。公共方法直接或通过其他私有方法间接调用所有私有方法。

公共方法还调用了`DAO`查询数据库的 a 。我为班级写了一个单元测试。由于您不能为私有方法编写单元测试，因此我将所有私有方法更改为默认访问并为它们编写单元测试。

有人告诉我，我不应该仅仅为了测试目的而更改封装。但是我的公共方法调用了 DAO 并从调用中获取其数据。即使我要为 public 方法编写一个测试，我假设它会非常长和复杂。

我应该如何处理这个问题。一方面，我必须为访问 DAO 的公共方法编写一个非常复杂的测试，另一方面，更改方法的访问级别并为它们编写简短、简单的测试方法。我该怎么办？

任何建议将不胜感激

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T19:42:29.580

纯粹主义者会告诉你，私有方法可以提取到另一个提供可访问方法的辅助类中，他们可能是对的。

但是如果将这些实用方法保留在类中是有意义的，如果该类不是公共 API 的一部分并且不打算被子类化（例如，它可能是最终的），我认为制作没有任何问题它的一些私有方法受到包保护或保护。特别是如果记录了这种非私有可见性，例如使用 Guava 注释`@VisibleForTesting`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-20T19:31:08.200

好像你在这里有两个问题：

1.  如何测试私有方法（假设在 Java 中）：

    我会看这个问题：[如何测试具有私有方法、字段或内部类的类？](https://stackoverflow.com/questions/34571/whats-the-proper-way-to-test-a-class-with-private-methods-using-junit)

    我个人喜欢[特朗普的](https://stackoverflow.com/users/2822/trumpi)回应：

    > 测试私有方法的最佳方法是通过另一种公共方法。如果无法做到这一点，则以下条件之一为真：
    > 
    > > 1.  私有方法是死代码
    > > 2.  您正在测试的课程附近有一种设计气味
    > > 3.  您尝试测试的方法不应该是私有的

2.  如何打破DAO的依赖

    您可以尝试使用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)来摆脱对 DAO 的依赖。然后，您可以模拟 DAO 并将其注入您的测试用例。好处是它真正变成了单元测试而不是集成测试。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-20T20:07:55.523

如果它很复杂，可能是因为你的班级有不止一个责任。通常，当您拥有执行不同操作的私有方法时，您可以拥有不同的类和为您执行此操作的公共方法。您的课程将变得更易于阅读、测试，并且您将分担责任。14个私有方法通常表明这种事情：P

例如，你可以有类似的东西

```
public class LeFooService {
    private final OtherServiceForConversion barService;
    private final FooDao fooDao;

    public LeeFooService(FooDao dao, OtherServiceForConversion barService) {
        this.barService = barService;
        this.fooDao = dao;
    }

    public void createAsFoo(Bar bar) throws ConversionException {
        Foo foo = convert(bar);

        fooDao.create(foo);
    }

    private Foo convert(Bar bar) {
        // lots of conversion stuff, services calling D:
    }
} 
```

为了正确测试，您必须测试转换是否正确完成。因为它是私有的，所以您必须捕获`foo`发送到`FooDao`并查看所有字段是否设置正确。您可以使用[`argThat`](http://mockito.googlecode.com/hg-history/1.5/javadoc/org/mockito/Matchers.html#argThat%28org.hamcrest.Matcher%29)捕获发送到的内容`fooDao`来测试转换。你的测试看起来像

```
....
@Test
public void shouldHaveConvertedFooCorrectly() {
     // given
     Bar bar = mock(Bar.class);

     // when
     fooService.createAsFoo(bar);

     // then
     verify(fooDao).create(argThat(fooIsConvertedCorrectly());
}

private ArgumentMatcher<Foo> fooIsConvertedCorrectly() {
     return new ArgumentMatcher<Foo>() { /*test stuff*/ };
}
.... 
```

但是，如果您将转换分离到另一个类，如下所示：

```
public class LeFooService {
    private final BarToFooConverter bar2FooConverter;
    private final FooDao fooDao;

    public LeeFooService(FooDao dao, BarToFooConverter bar2FooConverter) {
        this.bar2FooConverter = bar2FooConverter;
        this.fooDao = dao;
    }

    public void createAsFoo(Bar bar) throws ConversionException {
        Foo foo = bar2FooConverter.convert(bar);

        fooDao.create(foo);
    }
} 
```

您将能够测试对 LeeFooService 真正重要的内容：调用流程。`Foo`从到转换的测试`Bar`将是单元测试的责任`BarToFooConverter`。LeeFooService 的一个示例测试是

```
@RunWith(MockitoJUnitRunner.class)
public class LeFooServiceTest {
     @Mock
     private FooDao fooDao;
     @Mock
     private BarToFooConverter converter;
     @InjectMocks
     private LeeFooService service;

     @Test(expected = ConversionException.class)
     public void shouldForwardConversionException() {
         // given 
         given(converter.convert(Mockito.any(Bar.class))
            .willThrown(ConversionException.class);

         // when
         service.createAsFoo(mock(Bar.class));

         // then should have thrown exception
     }

     @Test
     public void shouldCreateConvertedFooAtDatabase() {
         // given 
         Foo convertedFoo = mock(Foo.class);
         given(converter.convert(Mockito.any(Bar.class))
            .willReturn(convertedFoo); 

         // when
         service.createAsFoo(mock(Bar.class));

         // then
         verify(fooDao).create(convertedFoo);
     }
} 
```

希望以某种方式有所帮助:)

一些可能有用的链接：

[坚硬的](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)

[BDD Mockito](http://docs.mockito.googlecode.com/hg/org/mockito/BDDMockito.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-22T19:40:02.133

正如父母会告诉他们的孩子：**不要暴露你的隐私！**

你不需要公开你的私有方法来测试它们。您可以获得 100% 的类测试覆盖率，包括那些私有方法，而不会暴露它们。

问题是有些人认为单元测试中的“单元”是函数，而实际上是类。

例如：我有一个带有 1 个公共方法的类：bool CheckIfPalindrome(string wordToCheck)。

在内部，我有私有方法来验证 wordToCheck 的长度，如果它是 null，如果它是空的，bla bla bla。

但作为测试人员，我不需要知道或关心开发人员如何组织（或将组织）内部代码。我正在测试接口的实现。

'假设单词是 "Mike"，当 CheckIfPalindronme 被调用时，它应该返回 false'

'鉴于单词是“妈妈”，当调用 CheckIfPalindronme 时，它​​应该返回 true'

'给定单词是 ""，当 CheckIfPalindronme 被调用时，它应该返回 false'

'鉴于单词为空，当调用 CheckIfPalindronme 时，它​​应该抛出一个错误'

如果我涵盖所有可能的输入和预期输出，我将测试您的私有函数。

这是 TDD / BDD 的基础，没有这个，TDD 就不可能，因为我们必须等着看你决定如何组织你的代码，然后才能编写我们的测试。

TDD / BDD 说在你写代码之前写你的测试（顺便说一句，它工作得很好！它可以非常快速地识别需求/设计中的缺陷）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-21T12:56:59.437

包含一个公共方法和 14 个私有方法的类几乎无法测试。如果没有看到它，我愿意打赌，它非常不稳定。就像 JB Nizet 说的那样；我和我的纯粹主义同事会将大部分或所有私有方法提取到帮助类。原因是：

*   易于测试
*   易于重构
*   易于阅读
*   易于重复使用

不提取的原因： * 很多！！类 * 提取需要时间 * 有时，性能问题会阻碍“正确”设计的美观性。

恕我直言，在以下情况下应始终考虑逻辑提取：

*   私有方法
*   大类（当我的编辑器窗口中出现垂直滚动条时，我通常开始想到它）
*   循环内循环

这里的关键词是单一职责（SRP）。

# jquery - 如何从测试中排除 Ie9 或更高版本？

> ID：13978924
> 
> 赞同：1
> 
> 时间：2012-12-20T19:14:34.940
> 
> 标签：jquery, internet-explorer-9

我在页面中添加了以下 javascript，因为当文本过长时，某些下拉列表不会在 IE 中显示全部内容。

```
$(".dropdown").mousedown(function () {
    if ($.browser.msie) {
        //Do something
    }
}); 
```

现在我已经解决了这个问题，我才意识到 IE9 没有这个问题。那么如何从上述测试中排除 IE9 或更高版本？

感谢您的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T19:17:20.527

```
if ($.browser.msie && parseInt($.browser.version, 10) < 9) {
    // your code here for IE < 9
} 
```

**更新**

`$.browser`已弃用。

确保您的代码仅在`IE`< 9 上运行的一种方法是使用条件语句。

```
<!--[if lt IE 9]>
    <script src="path-to-js.js" type="text/javascript"></script>
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T19:16:44.850

您可以在页面的 HEAD 中执行此操作：

```
<!--[if gt IE 8]>
<script src="myscript.js"></script>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T19:18:39.953

`$.browser`还有另一个名为 version 的属性，用它来检测正在使用的版本。

```
console.log($.browser.version) 
```

你真的不应该使用`$.browser`它，它在 jQuery 的下一个版本（1.9 和 2.0）中消失了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T19:23:34.550

使用 jQuery：

```
if ($.browser.msie  && parseInt($.browser.version, 10) > 9) {
    //exclude
} 
```

这是纯 Javascript 中的相同方法：

```
<script>

    function getIEVersion() {
        var rv = -1; // Return value assumes failure.
        if (navigator.appName == 'Microsoft Internet Explorer') {
            var ua = navigator.userAgent;
            var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
            if (re.test(ua) != null)
                rv = parseFloat( RegExp.$1 );
        }
        return rv;
    }

    function checkVersion() {
        var ver = getIEVersion();

        if ( ver != -1 ) {
            if (ver > 9.0) {
                // do something
            }
        }
    }

    checkVersion();

</script> 
```

但最好的方法是不使用 UA 嗅探，而是使用像[Modernizr](http://modernizr.com/)这样的特征检测。

# java - 设置方法的状态

> ID：13978925
> 
> 赞同：0
> 
> 时间：2012-12-20T19:14:38.857
> 
> 标签：java, swing, enums, jcombobox

在我的 GUI 我有

```
@Override
public void actionPerformed(ActionEvent ae) { 
state = new JComboBox(EnumStates.values());
state =(JComboBox)ae.getSource()
state.getSelectedItem() //this returns what I want 
```

然后我有一些其他类的对象，比如使用 EnumStates

```
CallmeClass obj; 
```

当我尝试使用 JComboBox 的结果设置枚举的状态时，像这样

```
 obj.setState(state.getSelectedItem()); 
```

我得到编译错误

**1\. 需要状态但找到对象**

所以我的问题是`is there a way to make the setState take as argument state.getSelectedItem() withouth changing the return type of the method setState() or re declaring the enums in the gui`。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:50:02.450

我猜你的声明`setState`是这样的：

```
public void setState(State state){
    ...
} 
```

问题是 JComboBox 是无类型的（至少在 Java7 之前是这样的）。所以`getSelectedItem()`总是返回一个需要转换为你的类型的对象。因此，您可以在获得项目时进行演员表：

```
obj.setState((State)state.getSelectedItem()); 
```

或者您可以将您的方法声明更改为对象并在那里进行转换：

```
public void setState(Object state){
    if(state instanceof State){
        State realState = (State)state;
        ...
    }
} 
```

# c# - 使用事件处理构建动态 DropDownList

> ID：13978928
> 
> 赞同：0
> 
> 时间：2012-12-20T19:14:46.037
> 
> 标签：c#, asp.net, .net, c#-4.0

我想建立一个动态`DropDownList`并添加一些列表项。使用下面的代码，我可以做到。

```
protected void BuildDynamicDropDown()
{
    DropDownList ddl = new DropDownList();
    ddl.ID = "newDDL";
    ddl.SelectedIndexChanged += dynamicDDL_SelectedIndexChanged;
    ddl.Items.Add(new ListItem("stack1", "stack1"));
    ddl.Items.Add(new ListItem("stack2", "stack2"));
    ddl.Items.Add(new ListItem("stack3", "stack3"));
    ddl.AutoPostBack = true;
    Panel1.Controls.Add(ddl);
}

protected void dynamicDDL_SelectedIndexChanged(object sender, EventArgs e)
{
    //this part of code should trig another dynamic dropdown
} 
```

但**我想使用 SelectedIndexChanged 事件来更改另一个动态下拉值**。

你有什么主意吗？

在此链接[上，如何在 C# 中为动态下拉列表创建事件处理程序，](https://stackoverflow.com/questions/3649357/how-to-create-event-handler-for-dynamic-drop-down-list-in-c-sharp) 一个解决方案如下所示

```
ddlFilter.SelectedIndexChanged += new EventHandler(ddl2_SelectedIndexChanged);
ddlFilter.AutoPostBack = true;

void ddlFilter_SelectedIndexChanged(object sender, EventArgs e)
{
    //your code 
} 
```

不久，我想构建多个动态下拉列表并假设 3 个下拉列表，我想处理它们的`selectedindexchange`事件以便它们之间进行交互。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T11:45:44.650

如果我得到你的查询！您可以使用下拉列表的 Items 数组并循环遍历它并检查条件并在所选索引上的另一个下拉列表的项目列表中进行更改。

# google-chrome - 无法安装我自己的 Google Chrome 扩展程序

> ID：13978929
> 
> 赞同：0
> 
> 时间：2012-12-20T19:14:46.147
> 
> 标签：google-chrome, google-chrome-extension

我创建了非常简单的扩展，它在“加载解压模式”甚至 .crx 文件中运行良好。但我无法从 Chrome 商店安装它，它在我尝试安装时显示“无文件”。其他用户报告同样的问题。我这边或谷歌那边有什么东西吗？

附言。扩展[页面](https://chrome.google.com/webstore/detail/imgleprosoriumcom/igbklfloandhoogdlppdegbaceppicop)，[源代码](https://github.com/crea7or/imgLeprosoriumCom)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:28:11.617

[如果满足以下任一条件，Google Chrome 就会认为文件是可安装的](https://developer.chrome.com/extensions/hosting.html)：

```
The file has the content type application/x-chrome-extension
The file suffix is .crx and both of the following are true:
    The file is not served with the HTTP header X-Content-Type-Options: nosniff
    The file is served with one of the following content types:
        empty string
        "text/plain"
        "application/octet-stream"
        "unknown/unknown"
        "application/unknown"
        "*/*" 
```

看看[这里](https://developer.chrome.com/extensions/hosting.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T13:37:51.273

我有同样的问题，不幸的是我的坏了2天。我设法通过提高版本号并重新上传 zip 文件来解决它。

# java - 使用键绑定将操作绑定到 3 个或更多键的组合

> ID：13978930
> 
> 赞同：0
> 
> 时间：2012-12-20T19:14:47.973
> 
> 标签：java, swing, key-bindings, modifiers

我了解如何将修饰符与键绑定一起使用，`CTRL_DOWN_MASK + some key`但我希望能够将特定操作绑定到当控件、某些字母（即“W”）和向上箭头都被按下时。类似的东西`CTRL_DOWN_MASK + some key + Up Arrow`。

我会用它来改变某个声音片段的音量。因此，当我`CTRL_DOWN_MASK + W + Up Arrow`全部按下时，分配给 W JButton 的声音剪辑的音量会增加，如果我有`CTRL_DOWN_MASK + W + Down Arrow`，所述声音剪辑的音量会降低。

```
 public void bindKey(JPanel base)
    {

        base.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(key, InputEvent.CTRL_DOWN_MASK),"Volume"+key);
        base.getActionMap().put("Volume"+key, new AbstractAction(){
            public void actionPerformed(ActionEvent e) 
            {
                //if(Up Arrow is being pressed.)
                setGain(currentGain() + 1.0f);

                //if(Down Arrow is being pressed.)
                setGain(currentGain() - 1.0f);
            }
        });
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T19:58:17.410

你需要更多的手......我认为这就是他们将其限制为修饰符和主键的原因。您是否考虑过 ctrl+w 启动界面，然后您可以按向上或向下调整音量？

您的另一个选择是在 ctrl+w 和 ctrl+up 键上映射键绑定。然后，只要它们都处于活动状态，请执行您的操作。您需要设置标志并有两个映射 - 一个用于按下，一个用于释放。您可以查看[Keystroke 类](http://docs.oracle.com/javase/6/docs/api/javax/swing/KeyStroke.html#getKeyStroke%28java.lang.String%29)以获取有关设置键以进行映射的更多详细信息。

# java - 接受多种类型作为单个参数的 Java 方法

> ID：13978936
> 
> 赞同：6
> 
> 时间：2012-12-20T19:15:05.827
> 
> 标签：java, generics, types

假设我有两个自定义类和一个方法，如下所示：

```
class A {
  public void think() {
    // do stuff
  }
}

class B {
  public void think() {
    // do other stuff
  }
}

Class C {
  public void processStuff(A thinker) {
    thinker.think();
  }
} 
```

有没有办法写成`processStuff()`这样（只是说明）：

```
public void processStuff({A || B} thinker) {...} 
```

或者，换句话说，有没有办法用一个参数来编写一个接受多种类型的方法，以避免`processStuff()`多次键入该方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T19:16:50.230

在接口中定义您想要的行为，拥有`A`并`B`实现接口，并声明您`processStuff`将接口实例作为参数。

```
interface Thinker {
    public void think();
}

class A implements Thinker {
    public void think() { . . .}
}

class B implements Thinker {
    public void think() { . . .}
}

class C {
    public void processStuff(Thinker thinker) {
        thinker.think();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T19:17:15.677

这种情况下，最简单的就是定义一个接口

```
interface Thinker {
   public void think();
} 
```

然后让你的类实现它：

```
class A implements Thinker {
  public void think() {
    // do stuff
  }
} 
```

并将其用作参数类型：

```
Class C {
  public void processStuff(Thinker t) {
    t.think();
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-20T19:17:45.303

定义`Thinker`为接口：

```
public interface Thinker
{
    public void think();
} 
```

然后有类`A`并`B`实现它：

```
public class A
implements Thinker 
```

最后，定义`processStuff()`以 a`Thinker`作为参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T19:17:37.667

您可以创建一个包含该`think`方法的通用接口，并让`A`并`B`实现它。

或者你可以重载`processStuff()`并有两个实现，每个实现一个类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-20T19:29:34.990

在这种情况下，您可以简单地使用多态性。为此，您需要重载您的方法——创建具有相同名称但参数类型不同的方法。java 不检查方法名称，它检查方法签名（方法名称+参数+返回类型），例如：

```
public class foo
{
       public int add(int a, int b)
       {
            int sum = a+b ;
            return sum ; 
       }

       public String add(String a, String b)
       {
            String sum = a+b ;
            return sum ; 
       }

       public static void main(String args[])
       {
            foo f = new foo() ;
            System.out.printf("%s\n",f.add("alpha","bet));
            System.out.printf("%d", f.add(1,2);
       }

 } 
```

此代码应返回

```
alphabet
3 
```

如您所见，两个方法签名不同，因此没有错误。请注意，这只是可以做的一个例子。

# java - 在 Java Swing 中计算 JPanel 中两点之间路径的算法

> ID：13978938
> 
> 赞同：3
> 
> 时间：2012-12-20T19:15:22.103
> 
> 标签：java, algorithm, swing

首先，我不想要 A*、Dijkstra 之类的算法，因为这些算法会计算出最佳和最短的方法。我在 JPanel 中有两个点，我必须用一根由点阵列组成的电缆将它们连接起来。唯一允许的方向是向上、向下、向左和向右，并且**电缆必须具有最少的方向变化次数**。这是最重要的要求，当然算法不计算最短路径。我该怎么做？有没有类似的算法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T19:20:45.267

我认为您应该再次查看传统的最短路径算法。与边缘相关的权重与物理距离完全无关。

构建一个图，其中潜在的角为顶点，顶点之间的每个直线连接都有一条边，每条边的权重为一个。您想要的路径是通过该图的“最短”路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T19:31:57.687

对于这个简单的问题，“算法”这个词是不是太花哨了？两者之间的最短路径`A(X1,Y1) and B(X2,Y2)`通过`C(X1,Y2) or D(X2,Y1)`任一方式，两种方式的距离相同，以防万一，`X1 != X2 && Y1 != Y2`但如果两点之间的任一坐标相同，则它是一条没有中断的直线。路径的长度为`abs(X2-X1)+abs(Y2-Y1)`。

# javascript - 是否有可能拥有一个对 SEO 友好的 Express.js 网站？

> ID：13978939
> 
> 赞同：3
> 
> 时间：2012-12-20T19:15:26.250
> 
> 标签：javascript, node.js, seo, webserver, express

如果 Express 提供传统的路径结构（即[http://yoursite.com/foo](http://yoursite.com/foo)），这些页面是否会显示在 Google 的搜索引擎结果页面上，类似于使用相同路径结构的 Wordpress 博客或 PHP 网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:18:38.153

你的资源是什么？恕我直言，您的信息是错误的。Url 可用于一些合并逻辑数据。

这与缓存无关，与您的网络服务器的响应标头有很大关系：

*   Etag：用于识别内容是否发生变化的标签
*   Last-Modified：一种检查内容是否同时发生变化的方法
*   Expires：页面应该在不重新联系服务器的情况下缓存多长时间。

有关更多详细信息，另请参阅[wikipedia](http://en.wikipedia.org/wiki/HTTP_header)或[RFC2616](http://www.ietf.org/rfc/rfc2616.txt)。

# php - 一些粘性帖子

> ID：13978940
> 
> 赞同：0
> 
> 时间：2012-12-20T19:15:31.497
> 
> 标签：php, wordpress, sticky

我有 2 个循环。在第一个循环中，显示了 3 个最近的置顶帖子。在第二个帖子中显示了所有帖子（粘性和非粘性）。现在我想在第二个循环中删除 3 个最近的置顶帖子。

我尝试了类似的方法，但它从两个循环中删除了所有粘性帖子，而不是从 loop2 中删除了一些粘性帖子。// 编辑：我的两个循环的代码：

```
<?php
$sticky = get_option('sticky_posts'); // Get all sticky posts.
rsort($sticky); // Sort sticky posts in reverse order.
$sticky = array_slice($sticky, 0, 3); // Number of sticky posts to show.
$latestStickyPosts = $sticky;

$loop1query = new WP_Query(array('post__in' => $sticky, 'ignore_sticky_posts' => 1));

// START 1ST LOOP.
while ($loop1query->have_posts()) : $loop1query->the_post();
$do_not_duplicate[] = $post->ID; // global. ?>
<div> ... </div>
<?php endwhile;
// END 1ST LOOP.

$showposts = 5; // Show posts per page. 
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$args = array('category__in' => $cat, 'showposts' => $showposts, 'paged' => $paged);

$loop2query = new WP_Query($args);

// START 2ND LOOP.
query_posts($args); if(have_posts()) : while (have_posts()) : the_post(); 
if( in_array($post->ID, $latestStickyPosts ) continue; ?>
<div> ... </div>
<?php endwhile; endif;
// END 2ND LOOP. ?> 
```

我不在乎帖子在后端是否真的不粘。它们应该以这种方式显示：loop1 = 3 最近的便笺。loop2 = 其余的置顶帖和所有非置顶帖

感谢您的任何帮助或建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:38:59.807

我没有在您的代码中看到第一个循环，但由于您正在循环第二个中的所有帖子，您可以保留一个数组，其中包含您不需要再次显示的粘性帖子的 3 个 ID。

假设你有一个数组`$latestStickyPosts`，那么你可以这样做：

```
query_posts($args); if(have_posts()) : while (have_posts()) : the_post(); 
if (in_array($post->ID, $latestStickyPosts)) continue; ?> 
```

有关更多信息，请查看[此文档](http://codex.wordpress.org/The_Loop#Multiple_Loops_Example_2)。

# c# - 隐藏/显示 XAML 元素或阻止 LostFocus 事件

> ID：13978947
> 
> 赞同：3
> 
> 时间：2012-12-20T19:16:09.250
> 
> 标签：c#, xaml, uwp

我有一个包含两个 StackPanel 的页面，每个 StackPanel 包含一个 TextBox 和一个 Button：

```
<StackPanel x:Name="Row1">
<TextBox x:Name="TextBox1" Text="" GotFocus="OnFocusHandler" LostFocus="OffFocusHandler"/>
<Button x:Name="Button1" Content="Convert" Click="OnClickHandler" Visibility="Collapsed"/>
</StackPanel>

<StackPanel x:Name="Row2">
<TextBox x:Name="TextBox2" Text="" GotFocus="OnFocusHandler" LostFocus="OffFocusHandler"/>
<Button x:Name="Button2" Content="Convert" Click="OnClickHandler" Visibility="Collapsed"/>
</StackPanel> 
```

我想做以下事情：

*   当一个文本框有焦点时，另一个文本框必须被隐藏并且相应的按钮必须显示
*   当一个文本框失焦时，我们回到原来的显示：只有空的文本框是可见的
*   我不希望按钮能够触发 OffFocusHandler

这是我为三个处理程序拥有的当前代码：

```
private void OnFocusHandler(object sender, RoutedEventArgs e)
{
    TextBox SenderTextBox = (TextBox)sender;

    if (SenderPanel.Name == "TextBox1")
    {
        Button1.Visibility = Visibility.Visible;
    }
    else if (SenderPanel.Name == "TextBox2")
    {
        Button2.Visibility = Visibility.Visible;
    }
}

private void OffFocusHandler(object sender, RoutedEventArgs e)
{
    TextBox1.Text = "";
    TextBox2.Text = "";
    Button1.Visibility = Visibility.Collapsed;
    Button2.Visibility = Visibility.Collapsed;
}

private void OnClickHandler(object sender, RoutedEventArgs e)
{
    // some stuff unrelated to my issue
} 
```

如何避免单击按钮触发`OffFocusHandler`代码？还有另一种编码方式吗？我是一个完整的初学者，所以我可能不会想到正确的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T21:49:39.400

您可以只绑定到`TextBox.IsFocused`Xaml 中的属性，并使用`BooleanToVisibilityConverter`显示/隐藏按钮。

例子：

```
<Window x:Class="WpfApplication4.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication4"
       Title="MainWindow" Height="300" Width="400" Name="UI" >
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolTovisible" />
    </Window.Resources>

    <Grid>
        <StackPanel x:Name="Row1" Height="54" VerticalAlignment="Top">
            <TextBox x:Name="TextBox1" Text="" />
            <Button x:Name="Button1" Content="Convert" Visibility="{Binding ElementName=TextBox1, Path=IsFocused, Converter={StaticResource BoolTovisible}}"/>
        </StackPanel>

        <StackPanel x:Name="Row2" Margin="0,60,0,0" Height="51" VerticalAlignment="Top">
            <TextBox x:Name="TextBox2" Text="" />
            <Button x:Name="Button2" Content="Convert" Visibility="{Binding ElementName=TextBox2, Path=IsFocused, Converter={StaticResource BoolTovisible}}"/>
        </StackPanel>
    </Grid>
</Window> 
```

# java - 没有为命名空间/和动作名称教程映射的动作

> ID：13978955
> 
> 赞同：0
> 
> 时间：2012-12-20T19:16:32.307
> 
> 标签：java, struts, struts2-config-browser

我无法执行我的 struts2 应用程序。我正在使用 eclipse indigo IDE、tomcat 7 和 jdk 1.7。

我包含的jar文件是：

*   commons-logging-1.0.4.jar，
*   freemarker-2.3.8.jar,
*   ognl- 2.6.11.jar，
*   struts2-core-2.0.11.jar,
*   xwork-2.0.4.jar

我将`struts.xml`in classes 文件夹放入其中`WEB-INF`，我也尝试将其放入
`src`文件夹中，但我无法做到。我在控制台上收到以下错误

```
There is no Action mapped for namespace / and action name tutorial. - [unknown    location] 
```

### 索引.jsp

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"   
"http://www.w3.org/TR/html4/loose.dtd">  
<html>  
<head>  
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  
    <title>Insert title here</title>  
</head>  
<body>  
    <form action="./tutorial.action">  
        Username: <input type="text" />  
        <input type="submit" value="Submit" />  
    </form>  
</body>  
</html> 
```

### struts.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration  
2.0//EN" "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
    <package name="default" extends="struts-default">
        <action name="tutorial" class="com.test.TutorialAction">
            <result name="success">/success.jsp</result>
            <result name="failure">/failure.jsp</result>
        </action>
    </package>
</struts> 
```

### web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"   
xmlns="http://java.sun.com/xml/ns/javaee"   
xmlns:web="http://java.sun.com/xml/ns/javaee/web-
app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee   
http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">

    <display-name>Struts2Starter</display-name>
    <filter>
        <filter-name>struts2</filter-name>
        <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class> 
    </filter>
    <filter-mapping>
        <filter-name>struts2</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>
    </web-app> 
```

### TutorialAction.java

```
package com.test;   

public class TutorialAction {   
    public String execute() {
        System.out.println("Hello from execute");   
        return "success";   
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T16:03:22.487

正如其他人指出的那样，您的映射中没有 getTutorial 操作，只有“教程”。但是，我将跳过这一点并建议您学习如何对 Struts2 应用程序进行健全性检查。任何时候你正在设置一项新技术，即使你正在使用熟悉的技术，了解如何进行基本的健全性检查是非常有用的——在这种情况下，你需要验证你的 struts xml 是否已经成功解析并且框架知道您的操作。

我强烈建议您将[Struts 2 Config Browser 插件](http://struts.apache.org/2.3.4.1/docs/config-browser-plugin.html)添加到您的 struts 2 应用程序中。要添加插件，您只需[获取 jar](http://search.maven.org/#search%7Cgav%7C1%7Cg%3a%22org.apache.struts%22%20AND%20a%3a%22struts2-config-browser-plugin%22)（所有 struts 2 插件都是 jar）并放入您的 webapp 的 lib 目录中。而已。当你开始你的应用程序时，点击这个 URL：

```
http://localhost:8080/starter/config-browser/index.action 
```

它向您展示了框架知道的所有操作以及其他配置。Essentialy struts 2 诊断工具，而且好用不使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-01T22:13:21.237

我有同样的问题，我在这个问题上看到了多个帖子......这是可能的解决方案

我很确定我已经准确地映射了我的所有操作，但它在上面显示了相同的错误......所以我只是清理了项目，然后再次运行它......它工作得非常好......试一试！

我遇到过很多次......所以为了避免这种事情，**我只是在快捷方式图标属性中添加了“../eclipse.exe -clean”......这很有效，你可以忘记获得这种错误实际上不是错误....！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-21T09:58:55.777

出现错误是因为服务器无法找到 struts.xml 的正确路径。最好将 struts.xml 与 src 文件夹或 WEB-INF/classes 并行放置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T07:26:19.947

尝试将`namespace`属性添加到文件`package`元素中`struts.xml`。

像这样：

```
<struts>
<package name="default" extends="struts-default" namespace="/">
    <action name="tutorial" class="com.test.TutorialAction">
        <result name="success">/success.jsp</result>
        <result name="failure">/failure.jsp</result>
    </action>
</package>
</struts> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-21T06:53:18.513

试试这个一次不要附加`.action`

```
<form action="tutorial"> 
```

将您的 struts.xml 文件放在包外的 src 或 WEB-INF 类文件夹中。

# forms - VBA表单显示单元格值

> ID：13978957
> 
> 赞同：0
> 
> 时间：2012-12-20T19:16:33.993
> 
> 标签：forms, vba

我有一个 Excel VBA 表单可以将数据输入到工作表中。我的工作表 CC 的最后一列包含一个计算一些输入字段的公式。这是一个很长但很简单的公式。

是否有可能当我在表单中输入数据时，VBA 表单本身中的一个字段会不断向我显示基于工作表列 CC 中的公式进行的输入的运行结果？我不知道如何在 VBA 中编写那个长公式，所以想知道是否有办法解决它。

如果不可能，那么在表格中输入数据时，有一个按钮检查结果。单击此按钮可暂时将表单数据输入到电子表格中，填充 CC 单元格，并且该结果显示为消息框，而 VBA 数据表单仍处于打开状态。此结果消息框可能有两个按钮，确认输入或取消。如果单击取消，则删除电子表格中输入的数据。如果单击确认，则输入的数据将保留。

如果有人可以提出解决方案，那有点紧迫。我添加了我的 VBA 表单的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T09:39:29.537

In the most basic manner to answer your sub question:

"Is it possible that while I am entering the data in the form, a field in the VBA form itself keeps showing me running result of the inputs made based on the formula in the worksheet column CC?"

Yes it's possible.

*   Asumming have a working formula anywhere in the sheet. Which you do according to your question.
*   Assuming your Sheet doesn't have a code like `Application.Calculation = xlCalculationManual` , to say your Sheet is in automatic calculation mode it will show you the running results.
*   You use key press or enter events in the Form to update the Sheet column `CC`

Your approach with buttons and message box seems fine. Why don't you give it a try and let us know with any issues you face.

Some hints:

*   `UserForm1.Show vbModeless` [property](http://social.msdn.microsoft.com/Forums/en-IE/exceldev/thread/13a79f7d-9622-45ab-9af1-f4dcaec53205)
*   [Allow worksheet access while user form is open](http://www.ozgrid.com/forum/showthread.php?t=150208)
*   [Editing spreadsheet while user form is open](http://www.mrexcel.com/forum/excel-questions/415566-editing-spreadsheet-while-userform-open.html)
*   How to show messagebox from cell changed event while user form is open?

# c - 从这个例子中确定 LR(k) 的 k？

> ID：13978958
> 
> 赞同：5
> 
> 时间：2012-12-20T19:16:35.477
> 
> 标签：c, algorithm, parsing

我准备了以下生成 C 逻辑和整数算术表达式子集的语法：

```
Expression:
    LogicalOrExpression
    LogicalOrExpression ? Expression : LogicalOrExpression

LogicalOrExpression:
    LogicalAndExpression
    LogicalOrExpression || LogicalAndExpression

LogicalAndExpression:
    EqualityExpression
    LogicalAndExpression && RelationalExpression

EqualityExpression:
    RelationalExpression
    EqualityExpression EqualityOperator RelationalExpression

EqualityOperator:
    ==
    !=

RelationalExpression:
    AdditiveExpression
    RelationalExpression RelationalOperator AdditiveExpression

RelationalOperator:
    <
    >
    <=
    >=

AdditiveExpression:
    MultiplicativeExpression
    AdditiveExpression AdditiveOperator MultiplicativeExpression

AdditiveOperator:
    +
    -

MultiplicativeExpression:
    UnaryExpression
    MultiplicativeExpression MultiplicativeOperator UnaryExpression

MultiplicativeOperator:
    *
    /
    %

UnaryExpression:
    PrimaryExpression
    UnaryOperator UnaryExpression

UnaryOperator:
    +
    -
    !

PrimaryExpression:
    BoolLiteral    // TERMINAL
    IntegerLiteral // TERMINAL
    Identifier     // TERMINAL
    ( Expression ) 
```

我想尝试使用 shift/reduce 解析，所以想知道这个语法是 LR(k) 的最小 k（如果有的话）是多少？（更一般地说，如果可能的话，如何从任意语法中确定 k？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:59:38.103

示例文法（几乎）是运算符优先文法，或弗洛伊德文法（FG）。要使其成为 FG，您必须对右侧仅由单个终端组成的非终端进行宏扩展，因为运算符优先级语法必须是运算符语法，并且运算符语法具有没有右-手边有两个连续的非终结符。

所有运算符优先级文法都是`LR(1)`. 显示运算符语法是否具有优先级属性也是微不足道的，特别是在每个终端恰好出现在右侧的情况下，就像在您的语法中一样。每个终结符恰好出现在右侧的运算符文法始终是运算符优先文法 [1]，因此始终是`LR(1)`.

FG 是一大类语法，其中一些甚至有用（例如，Algol 60 由 FG 描述），因此很容易回答关于它们是`LR(k)`for some的问题`k`，因为答案总是“是的，有`K == 1`”。只是为了精确，这里是属性。我们使用常规约定，其中语法`G`是 4 元组 (N, Σ, P, S)，其中`N`是一组非终结符；`Σ`是一组终端，`P`是一组产生式，`S`是开始符号。我们`V`为`N ⋃ Σ`. 在任何语法中，我们都有：

`N ⋂ Σ = ∅`
`S ∈ N`
`P ⊂ V^+ × V*`

“无上下文”要求受到限制`P`，因此每个左侧都是一个非终端：

`P ⊂ Σ × V*`

在操作符文法中，`P`进一步限制：没有右边是空的，也没有右边有两个连续的非终结符：

`P ⊂ Σ × (V^+ − V*ΣΣV*)`

在运算符优先语法中，我们定义了三个优先关系，⋖、⋗和≐。这些是根据关系`Leads`和`Trails`[2] 定义的，其中 `

`T Leads V iff T is the first terminal in some string derived from V`
`T Trails V iff T is the last terminal in some string derived from V`

然后：

`t[1] ⋖ t[2] iff ∃v ϶ t[2] Leads v ∧ N→V*t[1]vV* ∈ P`
`t[1] ⋗ t[2] iff ∃v ϶ t[1] Trails v ∧ N→V*vt[2]V* ∈ P`
`t[1] ≐ t[2] iff N→V*t[1]t[2]V* ∈ P ∨ N→V*t[1]V't[2]V* ∈ P`

考虑这些关系的一种直观方式是：通常当我们进行推导时，我们只是将 RHS 替换为 LHS，但假设我们`⋖ RHS ⋗`改为替换。然后我们可以通过删除非终结符并将连续的 ⋖ 和 ⋗ 字符串折叠为单个符号来修改推导，最后在没有中间运算符的任意两个连续终结符之间添加 ≐。从那里，我们只是读出了关系。

现在，我们可以在任何运算符文法上执行该计算，但没有什么可以强制上述关系是排他的。如果这三个关系是互斥的，那么运算符文法就是 Floyd 文法。

验证运算符语法是否具有互斥优先关系是直截了当的；`Leads`并且`Trails`需要对 and 进行传递闭包`First`，`Last`大致是（它实际上是非终结符的数量和产生的数量的乘积）；从那里，可以通过对语法中的所有产生式进行一次线性扫描来计算优先关系，即.`O(|G|²)``O(|G|)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:59:16.417

摘自 Donald Knuths 论从左到右[的语言翻译](http://classes.engr.oregonstate.edu/eecs/winter2012/cs480/assignments/Knuth-1965-TranslationofLanguages.pdf)，在摘要中，

> 证明了一个文法对于*某个 k*是否为 LR(k) 的问题是不可判定的，

换句话说，

> 给定一个文法 G，“∃k.G ∊ LR(k)”是不可判定的。

*因此，*我们通常能做的最好的事情是尝试为 LR(0)、LR(1)、LR(2) 等构造一个解析器。在某个时候你会成功，或者你可能在某个时候放弃*k*变大。

## 这个特定的语法

在这种特定情况下，我碰巧知道您给出的语法是 LALR(1)，这意味着它因此必须是 LR(1)。我知道这一点是因为我已经为类似的语言编写了 LALR 解析器。由于显而易见的原因，它不能是 LR(0)（语法 {A -> x, A -> A + x} 不是 LR(0)）。

# jquery - 对对话框的 JQuery 验证

> ID：13978963
> 
> 赞同：0
> 
> 时间：2012-12-20T19:17:04.900
> 
> 标签：jquery, validation, dialog

我搜索了论坛，并找到了一些使用对话框的验证示例。我使用了其中之一的代码，但我无法让它工作。我已经在下面发布了 Jquery 代码。我的对话框是否必须已经存在于 html 中，如果是，我该如何定义它？这是我正在使用的验证功能：

```
<script>
$(document).ready(function(){

    $('form[name="_Deal"]').validate({
         submitHandler: function (form) {
                    //form.submit();
                 },
        rules: {
                TransCloseDate: { required: true, date: true }
        },   
        messages: {
            TransCloseDate: "Please enter a valid date."
        },
                errorPlacement: function (error, element) {
                error.appendTo($("#dialog"));
            },

    invalidHandler: function() {
    $("#dialog").dialog('open');
},

                errorContainer: "#dialog",
                errorLabelContainer: "#dialog ul",
                wrapper: "li", debug: true,
                onfocusout: false,
                onclick: false
    });
        $("#dialog").dialog({
            autoOpen: false,
            modal: true,
            close: function (event, ui) {
                $("#dialog").html("");
            },
           title: 'Please fix the following:',
            resizable: false,
            width: 300
        });
  }); 
```

# python - Speeding up pymongo inserts in this loop

> ID：13978969
> 
> 赞同：1
> 
> 时间：2012-12-20T19:17:16.453
> 
> 标签：python, mongodb, insert, pymongo

I need to integrate just over half a terabyte of data into MongoDB (about 525GB).

They are visits to my website, each line of the file is a tab delimited string

This is my main loop:

```
f = codecs.open(directoryLocation+fileWithData, encoding='utf-8')
count = 0 #start the line counter

for line in f:
    print line
    line = line.split('\t')

    document = {
        'date': line[0],     # a date as a string
        'user_id': line[1],  # a string 
        'datetime': line[2], # a unix timestamp
        'url': line[3],      # a fairly long string
        'ref_url': line[4],  # another fairly long string
        'date_obj': datetime.utcfromtimestamp(float(line[2])) #a date object
    }

    Visits.insert(document)

    #line integration time/stats
    count = count + 1 #increment the counter
    now = datetime.now()
    diff = now - startTime
    taken = diff.seconds
    avgPerLine = float(taken) / float(count)
    totalTimeLeft = (howManyLinesTotal-count) * avgPerLine
    print "Time left (mins): " + str(totalTimeLeft/60) #output the stats
    print "Avg per line: " + str(avgPerLine) 
```

I'm currently getting about 0.00095 seconds per line, which is REALLY slow considering the amount of data I need to integrate.

I̶'̶m̶ ̶g̶o̶i̶n̶g̶ ̶t̶o̶ ̶e̶n̶a̶b̶l̶e̶ ̶t̶h̶e̶ ̶p̶y̶m̶o̶n̶g̶o̶ ̶C̶ ̶v̶e̶r̶s̶i̶o̶n̶ ̶s̶i̶n̶c̶e̶ ̶I̶ ̶c̶h̶e̶c̶k̶e̶d̶ ̶t̶h̶a̶t̶ ̶p̶y̶m̶o̶n̶g̶o̶.̶h̶a̶s̶_̶c̶(̶)̶ ̶i̶s̶ ̶F̶a̶l̶s̶e̶.̶ PyMongo C version now enabled, its hovering about 0.0007 or 0.0008 seconds per line. Still pretty slow. 3.3Ghz intel i3 with 16GB ram.

What else will be bottlenecking this loop? I pretty much have to have the 3 different dates, but could ask to get rid of one if its totally slowing things down

The stats are really useful because it shows me how much longer is left during these huge integrations. However, I guess their calculations might be slowing things down on a large scale? Could it be all the printing to terminal?

EDIT:

I've put the loop minus the actual insert into cProfile and this is the result of 99999 sample lines:

```
 300001 function calls in 32.061 CPU seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   32.061   32.061 <string>:1(<module>)
        1   31.326   31.326   32.061   32.061 cprofiler.py:14(myfunction)
   100000    0.396    0.000    0.396    0.000 {built-in method now}
    99999    0.199    0.000    0.199    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
    99999    0.140    0.000    0.140    0.000 {method 'split' of 'str' objects} 
```

EDIT 2: Solved by Matt Tenenbaum - the solution- only output to the terminal once every 10,000 or so lines.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T20:26:16.140

1.  `Delete all indexes` which exists in collection
2.  If you have a replication than set `w=0, j=0`
3.  Use `bulk inserts`

Some performance tests: [http://www.arangodb.org/2012/09/04/bulk-inserts-mongodb-couchdb-arangodb](http://www.arangodb.org/2012/09/04/bulk-inserts-mongodb-couchdb-arangodb)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T22:29:25.613

As Zagorulkin says, it's important not to be doing a bunch of indexing while inserting, so make sure there are no operative indexed.

Beyond that, you probably want to limit the feedback to every 1000 lines (or some useful number based on how many lines you have to input, or how much feedback you want). Instead of doing all the calculations to produce the feedback on each iteration, change the last block of your code to qualify it against `count` so that it only passes the test once every 1000 iterations:

```
 #line integration time/stats
    count = count + 1 #increment the counter
    if count % 1000 == 0:
        now = datetime.now()
        diff = now - startTime
        taken = diff.seconds
        avgPerLine = float(taken) / float(count)
        totalTimeLeft = (howManyLinesTotal-count) * avgPerLine
        print "Time left (mins): " + str(totalTimeLeft/60) #output the stats
        print "Avg per line: " + str(avgPerLine) 
```

Again, 1000 might not be the right number for you, but something like that will prevent a lot of this work from happening, while still giving you the feedback you're looking for.

# .htaccess - .htaccess 允许如果 url 包含一个单词

> ID：13978979
> 
> 赞同：0
> 
> 时间：2012-12-20T19:17:57.053
> 
> 标签：.htaccess

我想允许访问特定域。例如，如果 domain 包含单词 asdf 它应该允许访问。问之前我最后的尝试是：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^.*asdf.*$ [NC,OR]
RewriteCond %{HTTP_REFERER} !^.*1234.*$
#RewriteRule .* - [F] 
```

所以在这里我试图限制对除包含 asdf 或 1234 的域之外的所有域的访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T19:23:22.487

您需要`%{HTTP_HOST}`用于检查 URL 中的域，而不是`%{HTTP_REFERER}`.

你可以试试这个代码：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^.*(asdf|1234)\. [NC]
RewriteRule .* - [F] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T20:05:25.160

Anubhava 给了我一个线索，但不是 http_host。最后的问题是 OR。现在下面的工作就像一个魅力：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^.*(1234|asdf).* [NC]
RewriteRule .* - [F] 
```

所以 HTTP_REFERER 做了它应该做的（检查域访问）。和 | 作为我需要的 or 论点。

# algorithm - 在 2 个排序数组的联合中查找第 k 个最小元素

> ID：13978981
> 
> 赞同：0
> 
> 时间：2012-12-20T19:18:00.143
> 
> 标签：algorithm

我认为这个问题被问了很多次，但仍然没有任何明确的解决方案！无论如何，这就是我在 O(k) 中找到的好答案（也可能是 O(logm + logn)）。但我不明白，如果 M_B > M_A（或其他方式）我们应该在 M_B 之后丢弃元素。但这里它的反向投掷元素在 M_B 之前。谁能解释一下为什么？

[http://www.cs.cmu.edu/afs/cs.cmu.edu/academic/class/15451-s01/recitations/rec03/rec03.ps](http://www.cs.cmu.edu/afs/cs.cmu.edu/academic/class/15451-s01/recitations/rec03/rec03.ps)

另一个问题是 K/2 ......我们应该这样做，但这对我来说并不明显。

[编辑 1]

```
Example
A = [2, 9, 15, 22, 24, 25, 26, 30]
B = [1, 4, 5, 7, 18, 22, 27, 33]
k= 6

Answer is 9 (A[1]) 
```

这是我的想法，如果我想在 O(Log k) 中解决......每次都需要抛出 k/2 个元素。基本解决方案：如果 K < 2：从 - A[0]、A[1]、B[0]、B[1] 返回第二个最小元素，否则：比较 A[k/2] 和 B[k/2]：如果 A[k/2] < B[k/2]: 那么第 k 个最小元素将在 A[1 ... n] 和 B[1 ... K/2] 中 ...好吧，我在这里投掷 k/ 2（可以对 A[k/2] > B[k/2] 做类似的事情。所以现在的问题是下一次 k 索引也是 K 还是 k/2？

我做的对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T05:21:16.277

该算法还不错——在我看来，它比 SO 上通常引用的算法要好，因为它要简单得多——但它有一个巨大的缺陷：它要求两个向量都至少有`k`元素。（问题是它们都有相同数量的元素，`n`但从未指定过`n ≥ k`；该函数甚至不允许您告诉它向量有多大。但是，这很容易解决。我将其留作练习现在。一般来说，我们需要一个像这样的算法来处理不同大小的数组，它确实如此；我们只需要清楚先决条件。）

`floor`and的使用`ceil`很好而且很具体，但可能会令人困惑。让我们以最一般的方式来看这个。此外，引用的解决方案似乎假设数组是 1 索引的（即`A[1]`是第一个元素，而不是`A[0]`）。然而，我将要写的描述使用更像 C 的伪代码，所以它假定这`A[0]`是第一个元素。因此，我将编写它来查找`k`组合集中的元素，即元素。最后，我要描述的解决方案与提出的解决方案略有不同，这在最终条件下会很明显。恕我直言，它稍微好一点。`(k+1)^(th)`

好的，如果`x`是序列中的元素，则序列`k`中恰好有`k`小于 的元素`x`。（我们不会处理有重复元素的情况，但差别不大。见注3。）

假设我们知道`A`并且`B`每个都有一个元素`k`。（请记住，这意味着它们每个都至少有`k + 1`元素。）选择*任何小于`k`*;的非负整数。我们会调用它`i`。让我们`j`成为`k - i - 1`（这样`i + j == k - 1`）。[参见下面的注释 1。] 现在，看看元素`A[i]`和`B[j]`. 假设`A[i]`更小，因为我们只需要在另一种情况下更改所有名称。请记住，我们假设所有元素都是不同的。所以这就是我们目前所知道的：

1 )有`i`元素`A``< A[i]`

2 )有`j`元素`B``< B[j]`

3)`A[i] < B[j]`

4）从（2）和（3），我们知道：

5 )至多`j`有`B``< A[i]`

6) 由 (1) 和 (5) 可知：

7）至多有`i + j`元素在里面`A`并且`B`一起是`< A[i]`

8) 但是`i + j`是`k - 1`，所以实际上我们知道：

9)`k`合并数组的元素必须大于`A[i]`（因为`A[i]`最多为 element `i + j`）。

因为我们知道答案必须大于`A[i]`，所以我们可以丢弃 A[0] 到 A[i] （实际上，我们只是增加一个数组指针，但实际上我们会丢弃它们）。但是，我们现在已经`i + 1`从原始问题中丢弃了元素。所以在新的元素集（在缩短`A`的和原始的`B`）中，我们需要 element `k - (i + 1)`，而不是 element `k`。

现在，让我们检查前提条件。我们说两者`A`都有`B`一个元素`k`元素，所以它们都至少有`k + 1`元素。在新问题中，我们想知道缩短`A`的和原始的是否`B`都至少有`k - i`元素。很明显`B`，因为`k - i`没有更大的`k`。此外，我们`i + 1`从`A`. 最初它至少有`k + 1`元素，所以现在它至少有`k - i`元素。所以我们在那里没问题。

最后，让我们检查终止条件。一开始我说过我们选择非负整数`i`等等`j`。`i + j == k - 1`如果 ，那是不可能的`k == 0`，但可以做到`k == 1`。所以我们只需要在`k`达到 0 时做一些特殊的事情，在这种情况下我们需要做的是 return `min(A[0], B[0])`。[这是一个比您查看的算法更简单的终止条件，请参见注 2。]

那么有什么好的挑选策略`i`呢？我们最终会从问题中删除一个`i + 1`或多个`k - i`元素，我们希望它尽可能接近一半的元素。所以我们应该选择`i = floor((k - 1) / 2)`。尽管它可能不会立即显而易见，但这会使`j = floor(k / 2)`.

我忽略了我解决问题的地方`A`并且`B`元素更少的地方。这并不复杂；我鼓励你自己考虑一下。

* * *

[1] 您正在查看的算法选择`i + j == k`（如果`k`是偶数），并删除其中一个`i`或`j`元素。我的选择`i + j == k - 1`（总是）可能会使其中一个更小，但随后它会下降`i + 1`或`j + 1`元素。所以它应该收敛得更快一些。

`i + j == k`[2] 选择（他们的）和（我的）之间的区别在`i + j == k - 1`最终条件下很明显。在他们的表述中，两者`i`和都`j`必须是正数，因为如果其中一个为 0，则存在丢弃 0 个元素的风险，这将是一个无限递归循环。所以在他们的表述中， 的最小值可能`k`是 2，而不是 1，因此他们的终止情况必须处理`k == 1`，这涉及到四个元素之间的比较，而不是两个。对于它的价值，我相信“从两个排序向量中找到第二小的元素”的最佳解决方案是： min(max(A[0], B[0]), min(A[1], B[1 ]))，这需要三个比较。这不会使他们的算法变慢；只是更复杂。

[3] 假设元素可以重复。其实这并没有改变什么。该算法仍然有效。为什么？好吧，我们可以假设 in 中的每个元素`A`实际上是一对具有实际值和实际索引的对，对于 in 中的每个元素也是`B`如此，并且在比较向量中的值时，我们使用索引作为决胜局。在向量之间，我们优先考虑`A`if中的所有元素`A[i] ≤ B[j]`；否则对`B`. 这实际上并没有改变实际的代码，因为我们实际上不需要做任何不同的比较，但它使证明中的所有不等式都有效。

# api - 为 Eventbrite 编写 API？

> ID：13978988
> 
> 赞同：0
> 
> 时间：2012-12-20T19:18:18.907
> 
> 标签：api, eventbrite

有没有办法让我的用户访问他们的 eventbrite 帐户，并从我的网络应用程序发布事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:19:39.597

是的，事实上：

[http://developer.eventbrite.com/](http://developer.eventbrite.com/)

和

[http://developer.eventbrite.com/doc/getting-started/](http://developer.eventbrite.com/doc/getting-started/)

# c++ - 调整结构中的向量的大小

> ID：13978990
> 
> 赞同：1
> 
> 时间：2012-12-20T19:18:35.130
> 
> 标签：c++, vector

我定义了两个`struct`s

```
class foo() {
public:
    struct spatialEntry {
        bool block;
        CoherenceState_t state;
    };

    struct accumulationEntry {
        uint64_t offset;
        std::vector<spatialEntry> pattern;
    };

    std::vector<int> v;
    std::list<accumulationEntry> accumulationTable;

    foo() {
        v.resize(16);
    }
}; 
```

现在我想将`std::vector<spatialEntry>`16的大小初始化为`v`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:23:21.563

只需为包含该成员的类定义一个构造函数，然后`resize()`为：

```
class foo() {
public:
   //...
   struct accumulationEntry 
   {
       uint64_t offset;
       std::vector<spatialEntry> pattern;
       accumulationEntry()
       {
            pattern.resize(16);  //<--------- this is what you want?
       }
    };
    std::vector<int> v;
    std::list< accumulationEntry > accumulationTable;
    foo()
    {
       v.resize(16);
    }
}; 
```

但是，如果您使用`resize`，那么最好这样做：

```
 accumulationEntry() : pattern(16)  //<--- note this
       {
            //pattern.resize(16);
       } 
```

即使用成员初始化列表。也这样做`foo`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:21:46.200

`accumulationEntry`只是一种类型。您还没有该类型的对象，因此无需`std::vector<spatialEntry>`调整大小。大概你会在`accumulationEntry`你的`accumulationTable`. 你可以这样做：

```
accumulationTable.push_back(accumulationEntry()); 
```

完成此操作后，您可以调整`vector`包含在例如第 0 个元素中的大小，如下所示：

```
accumulationTable[0].pattern.resize(16); 
```

或者，您可以提供一个构造函数来`accumulationEntry`调整其`pattern`成员的大小：

```
struct accumulationEntry {
  // ...
  accumulationEntry()
  {
    pattern.resize(16);
  }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T19:26:38.387

```
class foo() {
public:
 struct spatialEntry {
   bool block;
   CoherenceState_t state;
 };
 struct accumulationEntry {
 accumulationEntry()
     : pattern(16)  //  Calling pattern's c'tor
 {
 }
   uint64_t offset;
   std::vector<spatialEntry> pattern;
 };
 std::vector<int> v;
 std::list< accumulationEntry > accumulationTable;
 foo()
 {
    v.resize(16);
 }
}; 
```

# php - 如何删除PHP中的第一段内容？

> ID：13978995
> 
> 赞同：0
> 
> 时间：2012-12-20T19:18:38.967
> 
> 标签：php, parsing

我在数据库中有字段`<p>intro content</p><p>rest of content....</p>`

`<p>intro content</p>`如何使用 PHP删除第一段内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:21:46.667

假设 mysql

```
SELECT SUBSTRING_INDEX(content_field, '</p>', 1) as cut from TABLE 
```

在数据库中替换：

```
update [table_name] set [field_name] = replace([field_name],SUBSTRING_INDEX([field_name], '</p>', 1),''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:26:47.577

使用 DOM 解析器。也许[PHPQuery](http://code.google.com/p/phpquery/)。然后，您可以从 DOM 中选择第一个元素并将其删除

**伪**代码：

```
$dom->firstChild()->remove(); 
```

# facebook - 我可以将 Facebook 应用 ID 用于多个域吗？

> ID：13978996
> 
> 赞同：0
> 
> 时间：2012-12-20T19:18:40.513
> 
> 标签：facebook, facebook-like

我的意思是当我在这里为我的喜欢按钮生成代码时：

[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

我只想获得一个代码，而不是为每个小型 wordpress 网站创建一个新的应用程序 ID。

我可以为所有客户及其网站使用一个吗？

我将使用任何likebox 和like 按钮没有FB 登录等。

如果可能，有哪些缺点/安全问题（如果有的话）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:00:05.723

如果您只需要点赞按钮，则不需要应用程序。