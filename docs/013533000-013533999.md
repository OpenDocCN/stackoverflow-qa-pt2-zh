# StackOverflow 问答 13533000-13533999

# cucumber - 黄瓜场景失败

> ID：13533002
> 
> 赞同：0
> 
> 时间：2012-11-23T16:45:14.877
> 
> 标签：cucumber

我在我的场景中有这条线，第二条失败了：

```
Then I should see "blogger_1"
And I should not see "blogger_2"

And I should not see "blogger_2"                                        # features/step_definitions/web_steps.rb:147
  expected #has_no_content?("blogger_2") to return true, got false (RSpec::Expectations::ExpectationNotMetError)
  ./features/step_definitions/web_steps.rb:149:in `/^(?:|I )should not see "([^"]*)"$/'
  features/merge_articles.feature:46:in `And I should not see "blogger_2"' 
```

有一个来自 cpybara 的保存页面：

[http://ge.tt/3VNhKDS/v/0](http://ge.tt/3VNhKDS/v/0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T09:13:28.687

我已经做了这个步骤定义来检查那个单词不在表格单元格中

```
Then /^(?:|I )should not see "([^"]*)" in table$/ do |text|
  regexp = Regexp.new('<td>'+text+'</td>')
  assert page.body =~ regexp ? false : true
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:33:37.880

似乎您的 html 选项中出现了 blogger_2，因此您需要更复杂的定义来检查正确位置的文本，例如[https://makandracards.com/makandra/5793-test-whether-a-form-现场存在黄瓜和水豚](https://makandracards.com/makandra/5793-test-whether-a-form-field-exists-with-cucumber-and-capybara)

# c - Do...While 和 getche() 在 C 中

> ID：13533006
> 
> 赞同：1
> 
> 时间：2012-11-23T16:45:32.957
> 
> 标签：c

在我的程序中的以下代码中：

```
do
    {
        printf("\nEnter records of student %d: \n", i++);
        printf("Name: ");
        fgets(record.name, sizeof(record.name), stdin);
        printf("\nAddress: ");
        fgets(record.address, sizeof(record.address), stdin);
        printf("\nClass Level: ");
        scanf("%d", &record.classlevel);
        printf("\nTelephone Number: ");
        scanf("%ld",&record.telephone);
        fwrite(&record, sizeof(record),1,fptr);
        printf("\n\nAdd another record? [y/n]: ");

    }while(getche()=='y'); 
```

当我看到输出时，它第一次工作正常

> 输入学生 1 的记录
> 
> 名称：<一些输入>
> 
> 地址：<一些输入>
> 
> 类级别：<一些输入>
> 
> 电话号码：<一些输入>
> 
> 添加另一个记录？[y/n]：<按下 Y>
> 
> 输入学生 2 的记录
> 
> 名称：<没有光标出现，无法在此处提供输入>
> 
> 地址：<这里只能输入>
> 
> .
> 
> .
> 
> ..... ETC..

发生了什么事，为什么在 do...while 循环中的第一次迭代后我无法输入名称。getche() 有什么问题吗？

希望得到您的帮助

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T16:50:06.093

你需要`fflush(stdin)`在你的开头`do{...}while`因为`getche()`在输入缓冲区中留下一个换行符。

# git - TortoiseGit Git Sync 和 Pull 之间的区别？

> ID：13533008
> 
> 赞同：26
> 
> 时间：2012-11-23T16:45:33.480
> 
> 标签：git, sync, tortoisegit, git-pull

我来自 SVN 环境，我正在使用 TortoiseGit 探索 Git。

当我右键单击“签出”的 Git 存储库时，我可以执行`Git Sync`命令，也可以执行`Pull`命令。

这两个功能之间有什么区别？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-26T01:43:48.287

TortoiseGit Sync Dialog 可以在一个对话框中执行多个同步操作，包括

*   拉（或取或...）
*   推
*   子模块更新

“同步”不是 Git 的概念，它是 TortoiseGit 独有的！

TortoiseGit 拉取对话框只执行拉取操作，但它有更多高级选项供用户选择。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-23T17:50:55.187

我没有 TortoiseGit，但是，从脑海中：拉是单向数据传输（从远程到本地），同步（如它所写）是双向（拉+推）并将本地更改发布到远程

# webdriver - Launching Chrome Driver, but not able to do any actions?

> ID：13533009
> 
> 赞同：0
> 
> 时间：2012-11-23T16:45:40.473
> 
> 标签：webdriver, selenium-chromedriver

I am trying to run my webdriver tests in Chrome. Here are the steps I'm using to launch Chrome driver:

Set the chrome binary path

```
System.setProperty("webdriver.chrome.driver", "paht\\chromedriver.exe");
DesiredCapabilities capabilities = DesiredCapabilities.chrome();
capabilities.setCapability("chrome.switches", Arrays.asList("--start-maximized"));
capabilities.setJavascriptEnabled(true);
capabilities.setCapability("AcceptUntrustedCertificates", true);
capabilities.setCapability("AssumeUntrustedCertificateIssuer", true);
capabilities.setCapability("chrome.switches", Arrays.asList("--ignore-certificate-errors"));
driver = new ChromeDriver( capabilities); 
```

My Chrome browser is launched, but its not running any tests, like open url etc? Can some please assist me with the steps needed to launch working chromium browser

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T23:43:07.890

你哪儿也不去。您实际上只是在打开浏览器，仅此而已。

在此处阅读入门页面：

[http://code.google.com/p/selenium/wiki/GettingStarted](http://code.google.com/p/selenium/wiki/GettingStarted)

本质上，您正在寻找类似的东西：

```
driver.get("http://www.google.com"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T07:03:01.170

您必须从此[链接下载更新的 Chromedriver](http://code.google.com/p/chromedriver/downloads/list)

```
 File file = new File("E://chromedriver.exe"); // set driver path 
    System.setProperty("webdriver.ie.driver", file.getAbsolutePath());
    WebDriver driver = new InternetExplorerDriver();
    driver.get("http://google.com"); 
```

&

```
 public class chrome 
 {

 public static void main(String[] args) {

   System.setProperty("webdriver.ie.driver", "E://chromedriver.exe"); //path of chrome driver
   WebDriver driver = new InternetExplorerDriver();
   driver.get("http://www.google.com");

   }

  } 
```

检查此代码，它对我有用。

# sparql - Get schema from Sparql dataset?

> ID：13533014
> 
> 赞同：0
> 
> 时间：2012-11-23T16:46:02.753
> 
> 标签：sparql

I downloaded Categorys (Labels) dataset in .nt format, from this [page](http://wiki.dbpedia.org/Downloads38),

And I would like to figure out what is available for querying. I tried this,

```
select distinct ?Category where {[] a ?Category } LIMIT 100 
```

which is a modification of this [example query](http://dbpedia.org/sparql)

But it failed. So I need to figure out how to query this dataset. I would like to view the schema or something similar.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T13:39:34.367

（假设“失败”是指您的查询没有返回任何结果：）

您下载的数据集仅包含该模式的三元组`<.../resource/...> rdfs:label "label"@en .`。
在 SPARQL 中，谓词`a`是 的缩写`rdf:type`，在文件中不可用。因此，如果您查询此文件，您的查询将不匹配任何内容。

要了解 DBpedia 下载的内容，您可以查看预览。对于 DBpedia 3.8 下载页面上的每个下载，在 N-Triples、N-Quads 和/或 Turtle 文件的链接旁边都有一个问号，链接到文件的预览。

从[下载的描述](http://wiki.dbpedia.org/Downloads38#h238-1)看来，DBpedia 中的类似乎可以在 Ontology Infobox Types 文件中找到（参见[英文 .nt 文件的预览](http://downloads.dbpedia.org/preview.php?file=3.8_sl_en_sl_instance_types_en.nt.bz2)）。如果您在此文件上执行查询，则应返回可用的类。
部分本体也列于[本文 (PDF)](http://jens-lehmann.org/files/2009/dbpedia_jws.pdf)第 8 页的表 1 中。

完整的 DBpedia 本体可以在[这里](http://mappings.dbpedia.org/server/ontology/dbpedia.owl)找到。

（编辑：添加了完整本体的链接。）

# c++ - C++, lint: lint does not discover taking reference to a local variable and passing it on to another function

> ID：13533017
> 
> 赞同：1
> 
> 时间：2012-11-23T16:46:11.773
> 
> 标签：c++, variables, reference, local, lint

Why does lint not complain in any of the following three lines in the code sample below?

```
timeout(&a);
timeout(&b);
if (pthread_create(&t1, NULL, timeout, (void*) &a) != 0) 
```

Isn't it in always considered unsafe to pass on a pointer to a local variable? And both variables are local...

```
#include <stdio.h>
#include <pthread.h>

static void* timeout(void* c)
{
    int d = *(*((int**)c));
}

static void sendMessage(int* a)
{
    timeout(&a);
    int* b = new int(2);
    timeout(&b);

    pthread_t t1;
    if (pthread_create(&t1, NULL, timeout, (void*) &a) != 0)
    {
        printf("pthread_create() error\n");
    }
}

int main() 
{
    printf("Running..\n");
    int* e = new int(1);
    sendMessage(e);
    delete e;
    return 0;
} 
```

Joachim

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T19:11:59.083

我不确定您是否在这里谈论 PC Lint，但如果您是，这可能是一个原因：将指向局部变量的指针传递给您调用的函数基本上是无害的，除非该函数保留指针以供以后使用，可能在之后调用者已经结束，因此局部变量不再有实例化。

现在，您的标题通过谈论引用误导了我，而示例仅使用指针和地址运算符，而 pthreads 是 AFAIK 一个 C 库，所以我只会考虑指针。

如果在 PC Lint 中您想指示调用的函数可能会获取指针并保留其副本以供以后使用，您可以使用 'semantic' 选项向 PC Lint (9.0) 描述这一点，例如

```
//lint -sem(pthread_create,custodial(4)) 
```

这将告诉 Lint`pthread_create`将“保管”作为第四个参数提供的指针。在这种情况下，Lint 可以生成更多有用的消息。快速检查没有发现更多警告。您的问题会更复杂，因为您可能需要`timeout`在调用时保管指针`pthread_create`，以释放在调用超时时分配的内存`a`，但 PC Lint 目前不支持这种复杂的语义。我希望这个解释无论如何都会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T16:52:17.087

将局部变量的地址传递给函数是非常有效和常见的。有时它是不正确的，是的，但是让它成为 lint 会抱怨的东西会产生过多的噪音/误报。

# javascript - 在远程计算机javascript中显示当前时间

> ID：13533019
> 
> 赞同：1
> 
> 时间：2012-11-23T16:46:20.820
> 
> 标签：javascript, jquery, datetime

我尝试在我的服务器中显示当前时间（它在我的服务器中的网页），但是当我打开网页时，我得到了运行该页面的计算机上的时间。

有没有办法做到这一点 ？

这是我的代码：

```
function startTime(){
  var today=new Date();
  var h=today.getHours();
  var m=today.getMinutes();
  var s=today.getSeconds();

  m=checkTime(m);
  s=checkTime(s);
  $('#cTime').val(h+":"+m+":"+s);
  t=setTimeout(function(){startTime()},500);
}

function checkTime(i){
  if (i<10) {
         i="0" + i;
      }
  return i;
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T16:47:25.373

JavaScript 将始终返回运行它的计算机上的时间，因为它是在客户端执行的。

您可以在服务器上编写一个简单的脚本来输出当前时间并*通过*JavaScript 向该脚本发送请求。

你可以这样做：

**PHP**

```
<?php
    // get_time.php
    // Simple!
    echo time();
?> 
```

**JavaScript**

```
// Using jQuery's GET function...
$.get('get_time.php', function(data){
    // The variable 'data' should equal the result from the PHP time() function!
    alert(data);
}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T16:50:17.900

如果您使用的是 php（您在下面提到），请在第一次加载时将时间放在页面中，然后您可以使用 Javascript 来显示并更新它，而无需进行重复的 ajax 调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T16:49:42.113

不确定您使用的是哪种服务器端技术，但您始终可以对服务器进行 ajax 调用以获取服务器时间，然后在 Javascript 中使用它来创建新的日期时间对象，然后继续执行上述逻辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T17:08:37.770

其他回复说要写一个脚本来通过ajax获取时间，但是为什么输出一个页面然后ajax返回服务器呢？你想要你的服务器时间，首先回应它。PHP 示例：

```
<?php echo '<script>var today=new Date("'.date("Y-m-d H:i:s").'");</script>'; ?> 
```

`echo date("jS F Y H:i");`例如，如果您只想显示时间而不用它做任何事情

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-23T17:46:02.520

PHP 可以实现它，但是如果 javascript 需要调用函数来显示时间而不是每次都刷新整个页面，它可能就不那么灵活了。

视需求而定。在这种情况下，只需使用 AJAX 向后端 php 发送 http 请求，以将时间回显到 javascript。

# windows - Windows - 检查当前是否正在安装更新

> ID：13533021
> 
> 赞同：2
> 
> 时间：2012-11-23T16:46:34.410
> 
> 标签：windows, updates

有什么办法可以查出windows当前是否正在安装更新？我的基本目标是防止我的程序执行某些操作或在安装更新时关闭电脑。是否有类似布尔注册表值或要检查的东西？

# ruby-on-rails - RoR 教程 Michael Hartl 5.27

> ID：13533022
> 
> 赞同：3
> 
> 时间：2012-11-23T16:46:35.020
> 
> 标签：ruby-on-rails, ruby, railstutorial.org

我正在关注 Michael Hartl 的 Ruby on Rails 教程，但在[第 5 章的第三个练习中](http://ruby.railstutorial.org/chapters/filling-in-the-layout#sec-layout_exercises)遇到了一些麻烦。我已经创建了 application_helper_spec.rb ，其代码与书中的代码完全相同，而 utility.rb 现在只有[清单 5.38](http://ruby.railstutorial.org/chapters/filling-in-the-layout#code-rspec_utilities_simplified)中指示的行，但是当我运行测试套件时出现此错误：

```
C:.../sample_app/spec/helpers/appliaction_helper_spec.rb:1: syntax error, unexpected tIDENTIFIER, expecting $end (SyntaxError)
desc...ApplicationHelper do 
```

该文件的第一行是：`require 'spec_helper'`，当我删除这一行时，我没有收到此错误，但我真的不认为这是正确的解决方案。

这是文件中的代码（与书中的相同）

```
require 'spec_helper'

  describe ApplicationHelper do

    describe "full_title" do
      it "should include the page title" do
        full_title("foo").should =~ /foo/
      end

      it "should include the base title" do
        full_title("foo").should =~ /^Ruby on Rails Tutorial Sample App/
      end

      it "should not include a bar for the home page" do
        full_title("").should_not =~ /\|/
      end
    end
  end 
```

[编辑] spec_helper：

```
# This file is copied to spec/ when you run 'rails generate rspec:install'
ENV["RAILS_ENV"] ||= 'test'
require File.expand_path("../../config/environment", __FILE__)
require 'rspec/rails'
require 'rspec/autorun'

# Requires supporting ruby files with custom matchers and macros, etc,
# in spec/support/ and its subdirectories.
Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}

RSpec.configure do |config|
  # ## Mock Framework
  #
  # If you prefer to use mocha, flexmock or RR, uncomment the appropriate line:
  #
  # config.mock_with :mocha
  # config.mock_with :flexmock
  # config.mock_with :rr

  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures
  config.fixture_path = "#{::Rails.root}/spec/fixtures"

  # If you're not using ActiveRecord, or you'd prefer not to run each of your
  # examples within a transaction, remove the following line or assign false
  # instead of true.
  config.use_transactional_fixtures = true

  # If true, the base class of anonymous controllers will be inferred
  # automatically. This will be the default behavior in future versions of
  # rspec-rails.
  config.infer_base_class_for_anonymous_controllers = false

  # Run specs in random order to surface order dependencies. If you find an
  # order dependency and want to debug it, you can fix the order by providing
  # the seed, which is printed after each run.
  #     --seed 1234
  config.order = "random"
end 
```

[编辑] application_helper.rb

```
module ApplicationHelper

  #Returns the full title on a per-page basis.
  def full_title(page_title)
    base_title = "Ruby on Rails Tutorial Sample App"
    if page_title.empty?
      base_title
    else
      "#{base_title} | #{page_title}"
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:13:53.497

您的文件名有错字：

```
appliaction_helper_spec.rb => application_helper_spec.rb 
```

# unique - ormlite中的唯一属性是否区分大小写？

> ID：13533031
> 
> 赞同：1
> 
> 时间：2012-11-23T16:47:01.367
> 
> 标签：unique, case-sensitive, ormlite

我对数据库中表中的字符串字段有唯一约束，我想知道 ormlite 中的唯一属性是否区分大小写？

例如，对于唯一约束，“Bob Smith”和“BOB SMITH”是否相同？

感谢您的回答和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T02:01:55.907

我怀疑这是依赖于数据库的。您将需要检查您的数据库文档以了解它的作用。 [ORMlite](http://ormlite.com/)没有对`UNIQUE`SQL 子句做任何特别的事情——它只是使用它。

例如，这里是 MySQL 的答案：[SQL unique varchar casesensitive question](https://stackoverflow.com/questions/6448825/sql-unique-varchar-case-sensitivity-question)

# ruby-on-rails - 当用户未通过身份验证时，如何设计重定向到 Facebook 登录？

> ID：13533037
> 
> 赞同：1
> 
> 时间：2012-11-23T16:47:35.677
> 
> 标签：ruby-on-rails, devise, omniauth

使用设计和omniauth 进行身份验证的Rails 应用程序。只允许 facebook 用户。Facebook 登录运行良好，omniauth 回调运行良好。

我的 Gemfile 包括基本的，其中包括：

```
gem 'devise'
gem 'omniauth'
gem 'omniauth-facebook' 
```

在我的“书籍”视图控制器中，我添加了设计身份验证：

```
class BooksController < ApplicationController
before_filter :authenticate_user! 
```

问题：当用户 authenticate_user！失败，设计重定向到登录页面（用户输入用户名、电子邮件、密码、确认）。我不想要这种行为，因为我只想要 facebook 用户。如果 authenticate_user 失败，我需要设计重定向到 facebook 登录。

当用户未通过身份验证时，如何设计重定向到 Facebook 登录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:10:52.210

最好的方法是使用 a`custom devise failure app`并覆盖该`redirect`功能。

像下面这样的东西会起作用：

1.  创建一个初始化程序，例如`custom_failure_app.rb`.
2.  创建一个`CustomFailureApp`将继承的类`Devise::FailureApp`
3.  覆盖`redirect`函数。

    ```
    class CustomFailureApp < Devise::FailureApp

      # will be called wen some failure occurs. 
      # Like unauthorized, session_expiry etc
      def redirect 
        message = warden.message || warden_options[:message]
        if message == :timeout
            # session expires
        else
            # unauthorized
            # redirect_to "facebook.com"
        end
      end
    end 
    ```

4.  添加另一个初始化程序，例如`devise.rb`并将以下代码放入其中。

    ```
    Devise.setup do |config|
      config.warden do |manager|
        manager.failure_app = CustomFailureApp
      end
    end 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T16:59:20.717

您可以尝试添加

```
match '/auth/failure', :to => 'your_controller#failure' 
```

到您的`routes.rb`，然后从控制器内部的故障方法中重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-05T15:26:50.060

Ryan Bates 提供了很棒的截屏视频[http://railscasts.com/episodes/360-facebook-authentication](http://railscasts.com/episodes/360-facebook-authentication)如何使用“omniauth-facebook” gem。您可以使用此修复程序使用标准的设计方法登录：[使用omniauth-facebook 登录到设计](https://stackoverflow.com/questions/16941850/sign-in-to-devise-using-omniauth-facebook)

# java - 会话范围的 bean 作为 Spring MVC 控制器的类属性

> ID：13533038
> 
> 赞同：3
> 
> 时间：2012-11-23T16:47:44.373
> 
> 标签：java, spring, scope

我有一个用户类：

```
@Component
@Scope("session")
public class User {
    private String username;
} 
```

和一个控制器类：

```
@Controller
public class UserManager {
    @Autowired
    private User user;

    @ModelAttribute("user")
    private User createUser() {
        return user;
    }

    @RequestMapping(value = "/user")
    public String getUser(HttpServletRequest request) {
        Random r = new Random();
        user.setUsername(new Double(r.nextDouble()).toString());
        request.getSession().invalidate();
        request.getSession(true);
        return "user";
    }
} 
```

我使会话无效，以便下次我到达 /users 时，我得到另一个用户。由于用户的会话范围，我期待一个不同的用户，但我得到的是同一个用户。我在调试模式下检查，它在内存中是相同的对象 id。我的 bean 是这样声明的：

```
 <bean id="user" class="org.synchronica.domain.User">
        <aop:scoped-proxy/>
    </bean> 
```

我是春天的新手，所以我显然做错了什么。我希望每个会话都有一个 User 实例。如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:01:34.390

这是预期的行为。当您使用代理标记 bean 时，`<aop:scoped-proxy/>`会为它创建一个代理。如果有 bean 的接口，则创建 java 动态代理，否则创建基于 CGLIB 的代理 - 在您的情况下，由于您的 User 类没有父类/接口，将为您创建基于 CGLIB 的代理。

现在要注意的是，这个代理将被注入到你的所有类中，这就是为什么你只看到 1 个实例（本质上是代理的），代理知道如何管理范围 - 只要你去通过你的类的方法，所以在你的情况下，如果你通过 getter 和 setter 调用来获取你的 User 类的属性，你应该看到适合反映会话的值。

# c# - 在 Visual Studio 中将应用程序拆分为多个解决方案之前，我应该考虑哪些因素？

> ID：13533039
> 
> 赞同：8
> 
> 时间：2012-11-23T16:47:55.407
> 
> 标签：c#, visual-studio, design-patterns, architecture, domain-driven-design

过去，我的项目变得难以管理，尤其是当我必须在几年后重新访问以重做或对某个部分进行重大更新而不必重做所有内容时。这一次，我将重点放在使“可插拔”应用程序设计变得容易和可能，以允许我重新访问和重做一个部分，而无需触及所有内容。

我在想这个结构：

![应用程序结构](../Images/f4be2a8da41fae95ff076577ca2dbbd6.png)

所以我想要的是能够在有界上下文 2 上工作，并在未来几个月/几年内使用许多新功能扩展它，而有界上下文 1 保持原样。我还将处理 UI，尤其是与限界上下文 2 相关的部分。我还想让用户能够在其他设备上使用限界上下文 2。

最好甚至在有界上下文 2 的 UI 中使用的 Web 技术也会更新，因为这是我们的主要关注领域并且使用最多，因此将其放入自己的 Web UI 项目中并拥有一个“登陆”网站，提供管理用户和让用户登录等常用功能。

现在我正在考虑将所有这些分离到 Visual Studio 中的单独解决方案中以简化管理。但是我可以为每个解决方案创建一个文件夹，然后将所有内容放在那里。

我的问题是推荐的方法是什么，在分成不同的**解决方案**之前我应该​​考虑什么？

*有没有关于如何管理这个的最佳实践？有经验的人吗？*

顺便说一句：由于这是由有界上下文划分的，因此系统的各个部分之间需要进行通信，尽管没有直接依赖关系（即上下文 1 管理和维护用于注册员工的业务逻辑，这在上下文 2 中再次需要）。

**更新** 我意识到需要更多信息。

有界上下文比这两个多。它们都不像一个部门，即员工管理是当他们需要组织/归档与管理他人相关的信息并获得重要事件提醒时的上下文管理器。采购是员工在为一个部门购买商品并进行库存时所处的环境，可能有 20-40 个组织部门使用它。我正在考虑“报告”是否是一个单独的有界上下文（尽管没有非常有趣的逻辑和行为）。这些往往从提供基本功能的小规模开始，然后随着更多功能的添加和人们“发现”新的需求而增长。它们是单独更新的，我希望它们中的一些能够及时成长为更大的系统，即使它们开始解决相当基本的需求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:58:29.410

因此，您有一堆代码，并且希望在不加载与其他部分相关的*项目*的情况下处理代码的某些部分。那么是的，您可以将每个部分作为单独的 Visual Studio*解决方案*。

关键是 VS 解决方案只是一个 [.sln] 文件，描述了该解决方案对哪些项目进行分组。不要仅为此目的制作项目的单独副本。您必须只维护所有项目一次（每个副本一份），然后创建单独的解决方案并包含您认为与此解决方案相关的项目（代码的这一部分）。

例如，您可能会认为“员工管理”是一个仅包含 3 个（总共 40 个）项目的解决方案。然后您继续创建一个包含这三个项目的解决方案。可能您最终会拥有单独的较小解决方案，以便与其他解决方案分开工作。

您不妨考虑拥有一个包含所有项目的大型解决方案（同样，**每个项目只有一个实例，但可以是多个解决方案的一部分**）。这种大解决方案可能对构建/发布准备等主要操作很有用。

我怀疑您是在试图夸大解决方案的重要性。实际上，您拥有的所有代码都是一个巨大的统一体，因为它们相互引用并且如果不[重新]编译其他代码就无法构建。即使您可能会尝试提出以某种方式与您的业务需求相对应的解决方案结构，但它似乎仍然是与解决方案无关的问题的另一个方向。这可能类似于解决划分为程序集、动态加载和可扩展性等问题。

结论：根据您在使用源代码时想要实现的便利性将代码拆分为*解决方案*，因为这只是将源代码划分为子部分，仅此而已。

**编辑/添加：**

您也可以决定将解决方案拆分为独立的解决方案，但这是不同的。这意味着解决方案项目只能引用其他解决方案中其他项目的输出（dll、exe）文件。当每个解决方案都将另一个解决方案视为 3-rd 方代码（没有直接的项目引用，但只有输出引用）时，可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:56:35.633

我认为在决定是否应该有多个解决方案时，答案是您是否真的设想在其他不同应用程序中使用构成有界上下文的一个（或多个）程序集，这将暴露所有完全相同的用途您的有界上下文管理的情况。如果是这种情况，那么单独的解决方案是有意义的。但是，如果您的所有 UI 层在概念上都是同时发布的同一个应用程序，那么我会将其保留在一个解决方案中，除非您的项目太多以至于 Visual Studio 变得无法使用。

不过，如果您真的要让另一个应用程序使用相同的有界上下文，我会感到惊讶。如果您考虑一下，您是否希望仅将更新版本的逻辑部署到您的 Web 服务，而不是您的 Windows 窗体应用程序？可能不会，因为逻辑更改可能会引入奇怪的问题，其中数据不是应用程序所期望的。

您所拥有的听起来像是一个平台，并且该平台的所有部分（UI 层）都应该运行完全相同的逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:29:25.770

解决方案的观点不是我猜的主要问题。我会选择在文件夹中组织我的项目。每个有界上下文一个，Web UI 在另一个有界上下文中（如果考虑的话，它可以被认为是它自己的一个有界上下文）。

您可能有一些共享内核，由您的所有 bc 共享，您也可能将其放在不同的文件夹中。

通常每个 bc 应该是独立的（共享程序集除外），并且您的 UI 应该通过它们的接口只知道 bc（例如 WCF 合同）

全局解决方案可能包含 (MyApplicationName.sln) 中的每个文件夹和项目，但您可以考虑仅在部分解决方案上工作的专用解决方案，例如 MyApplication_BCName 仅包含 bc 文件夹、共享程序集和 UI（如果适合）您的需求，并且您不希望有一个庞大的解决方案来处理。

从小事做起，在真正需要时尽快做事。要特别注意交叉引用，在 vs 中设置的方式实际上并不重要。如果程序集是松耦合的，那么您可以在以后随时按照您想要的方式重新排列它们。

我不是一流的程序员，我只是碰巧认为这样的事情对于我参与的最新项目来说似乎很好，它可能会在几个月内完全改变（几个小时..??;)）

# mysql - JPA（Hibernate，Mysql）在使用 setmaxresults 时获取计数

> ID：13533041
> 
> 赞同：1
> 
> 时间：2012-11-23T16:48:06.003
> 
> 标签：mysql, hibernate, jpa, count, jpa-2.0

嗨，在 mysql 中，有一种方法可以在使用 LIMIT 选择后获得总计数，只需选择 FOUND_ROWS。有没有办法在 jpa 中做到这一点？

我使用 JPA 和 Hibernate 作为持久性提供程序和 MySQL 作为底层数据库。

如果解决方案不是“纯”jpa 甚至休眠，那就没问题了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:45:48.787

不，JPA 中没有这样的构造，Hibernate 中也没有开箱即用。

直接的解决方案当然是通过单独的查询来获得总数。如果这不是一个选项，那么一种可能性是创建拦截器，如此[处](http://blog.kennardconsulting.com/2011/03/mysql-performance-leveraging.html)所述。

# c++ - std::map 和 boost::ptr_map 模板和继承的返回值变坏

> ID：13533042
> 
> 赞同：1
> 
> 时间：2012-11-23T16:48:06.323
> 
> 标签：c++, stdmap, boost-ptr-container

在我工作的公司，我们创建了一个名为“RestrictedMap”的类。这提供了与常规 std::map 相同的接口，但不允许您使用 [] 运算符。还提供了一些其他功能以舒适地使用该类。该类在内部包装了一个 std::map。

我现在正在尝试创建一个类似的类，它对 boost::ptr_map 执行相同的操作，称为“RestrictedPointerMap”。为此，我创建了**RestrictedMapBase**，它接受作为模板参数的映射类型，它应该包装并包含大部分实现。两个类派生它并指定要包装的映射类型：

*   **RestrictedMap**与我们以前拥有的相同并包装 std::map
*   和**RestrictedPointerMap**是新的并包装了 boost::ptr_map。

这是代码，为了完整起见，我没有简化类，但我稍后会命名相关函数。

受限地图.h

```
 #pragma once

    #include <boost/ptr_container/ptr_map.hpp>
    #include <boost/static_assert.hpp>
    #include <boost/assign/list_of.hpp>
    #include <boost/foreach.hpp>
    #include <map>

    /**
    * Class that has the benefits of a map, but does not add an entry if it does not exists. 
    * Do not use RestrictedMapBase directly but use one of the derived classes (RestrictedMap or RestrictedPointerMap).
    */
    template <typename MAP>
    class RestrictedMapBase
    {
    public:
       RestrictedMapBase(const MAP& map): 
          m_map(map)
       {}

       template<class InputIterator>
       RestrictedMapBase(InputIterator first, InputIterator last): 
          m_map(first, last)
       {}

       RestrictedMapBase()
       {}

       /************************************************************************/
       /* std::map interface                                                   */
       /************************************************************************/

       typedef typename MAP::iterator iterator;
       typedef typename MAP::const_iterator const_iterator;
       typedef typename MAP::value_type value_type;
       typedef typename MAP::key_type key_type;
       typedef typename MAP::mapped_type mapped_type;
       typedef typename MAP::size_type size_type;

       iterator begin() { return m_map.begin(); }
       iterator end() { return m_map.end(); }
       const_iterator begin() const { return m_map.begin(); }
       const_iterator end() const { return m_map.end(); }
       bool empty() const { return m_map.empty(); }
       size_type size() const { return m_map.size(); }
       iterator find(const key_type& key) { return m_map.find(key); } 
       const_iterator find(const key_type& key) const { return m_map.find(key); }
       void clear() { m_map.clear(); }
       void erase(iterator where) { m_map.erase(where); }

       bool operator==(const typename RestrictedMapBase<MAP>& other) const { return m_map == other.m_map; }
       bool operator!=(const typename RestrictedMapBase<MAP>& other) const { return m_map != other.m_map; }
       bool operator<(const typename RestrictedMapBase<MAP>& other) const { return m_map < other.m_map; }

       /************************************************************************/
       /* extra                                                                */
       /************************************************************************/

       void erase(const key_type& key)
       {
          iterator iter(find(key));
          assert(found(iter));
          erase(iter);
       }

       void eraseIfExists(const key_type& key)
       {
          m_map.erase(key);
       }

       bool exists(const key_type& key) const
       {
          return found(find(key));
       }

       mapped_type& getValue(const key_type& key)
       {
          return const_cast<mapped_type&>(static_cast<const RestrictedMapBase<MAP>&> (*this).getValue(key));
       }

       const mapped_type& getValue(const key_type& key) const
       {
          const_iterator iter(find(key));
          assert(found(iter));
          return getData(iter);
       }

       mapped_type getValueIfExists(const key_type& key) const
       {
          BOOST_STATIC_ASSERT(boost::is_pointer<mapped_type>::value);
          const_iterator iter(find(key));
          if (found(iter)) {
             return getData(iter);
          } else {
             return 0;
          }
       }

       void setValue(const key_type& key, const mapped_type& value)
       {
          iterator iter(find(key));
          assert(found(iter));
          setData(iter, value);
       }

       void add(const key_type& key, const mapped_type& value)
       {
          assert(!exists(key));
          insert(key, value);
       }

       void add(const RestrictedMapBase<MAP>& mapToAdd)
       {
          BOOST_FOREACH(value_type element, mapToAdd.m_map)
          {
             add(element.first, element.second);
          }
       }

       void addOrReplace(const key_type& key, const mapped_type& value)
       {
          iterator iter(find(key));
          if (found(iter)) {
             setData(iter, value);
          } else {
             insert(key, value);
          }
       }

       mapped_type* addDefaultConstructed(const key_type& key)
       {
          assert(!exists(key));
          return &m_map[key];
       }

    private:
       bool found(const const_iterator& iter) const 
       {
          return iter != end();
       }

       const mapped_type& getData(const const_iterator& iter) const
       {
          return const_cast<const mapped_type&>(iter->second);
       }

       mapped_type& getData(const iterator& iter)
       {
          return const_cast<mapped_type&>(static_cast<const RestrictedMapBase<MAP>&>(*this).getData(iter));
       }

       void setData(const iterator& iter, const mapped_type& value)
       {
          getData(iter) = value;
       }

       virtual void insert(const key_type& key, const mapped_type& value) = 0;

    protected:
       MAP& getMap()
       {
          return m_map;
       }

    private:
       MAP m_map;
    };

    template <typename KEYTYPE, typename DATATYPE>
    class RestrictedMap: public RestrictedMapBase<std::map<KEYTYPE, DATATYPE> >
    {
    public:
       RestrictedMap(const std::map<typename KEYTYPE, typename DATATYPE>& map): RestrictedMapBase(map)
       {}

       template<class InputIterator>
       RestrictedMap(InputIterator first, InputIterator last): RestrictedMapBase(first, last)
       {}

       RestrictedMap()
       {}

       virtual void insert(const KEYTYPE& key, const DATATYPE& value)
       {
          getMap().insert(std::make_pair(key, value));
       }
    };

    template <typename KEYTYPE, typename DATATYPE>
    class RestrictedPointerMap: public RestrictedMapBase<boost::ptr_map<KEYTYPE, DATATYPE> >
    {
    public:
       RestrictedPointerMap(const boost::ptr_map<typename KEYTYPE, typename DATATYPE>& map): RestrictedMapBase(map)
       {}

       template<class InputIterator>
       RestrictedPointerMap(InputIterator first, InputIterator last): RestrictedMapBase(first, last)
       {}

       RestrictedPointerMap()
       {}

       virtual void insert(const KEYTYPE& key, DATATYPE* const& value)
       {
          /* boost::ptr_map::mapped_type does not equal the DATATYPE template parameter passed to it. Therefore this 
           * functions signature *looks* different from the RestrictedMapBase::insert signature */
          getMap().insert(key, std::auto_ptr<DATATYPE>(value));
       }
    }; 
```

这主要是有效的，除非我想在 RestrictedPointerMap 上调用**getValue 。**函数**getData返回正确的值，但之后在****getValue**函数中出错。它返回一个错误的指针（如指针错误）。

这是一些重现该问题的代码：

测试类.h

```
 #pragma once

    class SomeClass
    {
    public:
       SomeClass();
       virtual ~SomeClass();
    }; 
```

测试类.cpp

```
 #include "stdafx.h"
    #include "TestClass.h"
    #include <iostream>

    SomeClass::SomeClass()
    {
       std::cout << "TestClass[" << this << "] created." << std::endl;
    }

    SomeClass::~SomeClass()
    {
       std::cout << "TestClass[" << this << "] deleted." << std::endl;
    } 
```

TestRestrictedPtrMap.cpp（主要）

```
 #include "stdafx.h"

    #include "RestrictedMap.h"
    #include "TestClass.h"
    #include <boost/foreach.hpp>

    int _tmain(int argc, _TCHAR* argv[])
    {
       typedef RestrictedPointerMap<int, SomeClass> MapType;
       MapType theMap;
       theMap.add(1, new SomeClass());
       theMap.add(2, new SomeClass());

       BOOST_FOREACH(MapType::value_type mapEntry, theMap) {
          std::cout << mapEntry.first << " = " << mapEntry.second << std::endl;
       }

       SomeClass* oneClass = theMap.getValue(1);
       std::cout << oneClass << std::endl;
       SomeClass* twoClass = theMap.getValue(2);
       std::cout << twoClass << std::endl;

       std::cin.get();
        return 0;
    } 
```

这个的输出是：

```
 TestClass[0078A318] created.
    TestClass[0078A448] created.
    1 = 0078A318
    2 = 0078A448
    0018FBD4
    0018FBD4
    TestClass[0078A318] deleted.
    TestClass[0078A448] deleted. 
```

我不知道为什么会出错。据我所知，返回值变坏了。

提前感谢您的帮助，

汤姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:26:42.540

你有一个悬空的参考。

当您取消引用 a`boost::ptr_map<Key, T>::iterator`时，它会即时构造从*实际*底层迭代器（ a ）`boost::ptr_container_detail::ref_pair<Key, T *>`初始化的a 。这意味着从返回的(or )引用了本地临时的成员（的成员）：*`std::map<Key, void *>::iterator``T *&``const T *&``getData``second``iter->second`*

 *```
 const mapped_type& getData(const const_iterator& iter) const
   {
      return const_cast<const mapped_type&>(iter->second); // reference to a temporary
   }
                                            ^^^^^^ *iter is a temporary value 
```

这与 normal 不同`std::map`，后者`*iter`提供对映射二叉树中节点的值子对象的引用。

如果不显着更改您的界面，就没有简单的解决方案，因为`T *`内存中的任何地方都没有可以引用的实际对象。您可能会更好地更改您的签名，以通过值指针甚至直接引用`RestrictedPointerMap`返回映射值：`T`

```
T *getValue(const key_type& key);               // not T *&
const T *getValue(const key_type& key) const;   // not const T *const &
// or
T &getValue(const key_type& key);               // not T *&
const T &getValue(const key_type& key) const;   // not const T *const & 
```*

# linux - 在 Unix/Linux 中运行两个进程

> ID：13533046
> 
> 赞同：0
> 
> 时间：2012-11-23T16:48:30.417
> 
> 标签：linux, unix

当内核创建两个代码段相同的进程时，内核是否真的将代码复制到两个进程的虚拟地址空间？换句话说，如果我创建同一个程序的两个进程，在内存中，我们有两个程序副本还是只有一个副本？

显然，它可能取决于实现，但我在传统的 Unix 操作系统中询问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:07:06.907

> 内核是否真的将代码复制到两个进程的虚拟地址空间？

文本段将被映射（而不是复制）到每个进程的虚拟地址空间，但将引用相同的物理空间（因此内核在内存中只有一份文本副本）。

data 和 bss 段也将映射到每个进程的虚拟地址空间，但这些将在每个进程中创建。在进程启动时，来自可执行文件的数据和 bss 段的数据将被映射/复制到进程的虚拟内存中；如果它不是从头开始复制的，那么一旦进程开始写入数据，进程就会获得自己的私有副本。

显然，共享内存和 mmap 内存是在进程启动后处理的。共享内存总是在进程之间共享；这就是它存在的理由。mmap 会发生什么取决于使用的标志，但它也经常被共享。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T16:59:44.623

现代操作系统将使用[Copy-on-Write](https://en.wikipedia.org/wiki/Copy-on-write)来避免重复页面，直到它们实际更新。请注意，在许多系统（包括 Linux）上，这可能会导致过度使用，如果每个进程决定修改未复制的页面，操作系统实际上没有足够的 RAM 来处理所需的所有复制。

# javascript - 用于匹配标点符号的 JavaScript RegEx 不是任何 HTML 标记的一部分

> ID：13533054
> 
> 赞同：2
> 
> 时间：2012-11-23T16:48:53.307
> 
> 标签：javascript, html, regex

好的，我知道在 RegEx 中匹配和解析 HTML 存在很多争议，但我想知道是否可以提供一些帮助。[案例和观点。](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)

我需要匹配任何标点符号，例如`. , " '`，但我不想破坏任何 HTML，所以理想情况下它应该出现在 a`>`和 a之间`<`- 基本上我的查询与其说是解析 HTML，不如说是避免它。

我将尝试替换将每个实例包装在一个`<span></span>`- 但在 RegEx 方面绝对没有经验，我不确定我是否能够做到。

我已经计算出字符集`[\.\,\'\"\?\!]`，但我不确定如何匹配仅出现在某些字符之间的字符集。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:15:15.707

首先，这是一个 X-browser dom-parser 函数：

```
var parseXML = (function(w,undefined)
{
    'use strict';
    var parser,ie = false;
    switch (true)
    {
        case w.DOMParser !== undefined:
            parser = new w.DOMParser();
        break;
        case new w.ActiveXObject("Microsoft.XMLDOM") !== undefined:
            parser = new w.ActiveXObject("Microsoft.XMLDOM");
            parser.async = false;
            ie = true;
        break;
        default :
            throw new Error('No parser found');
    }
    return function(xmlString)
    {
        if (ie === true)
        {//return DOM
            parser.loadXML(xmlString);
            return parser;
        }
        return parser.parseFromString(xmlString,'text/xml');
    };
})(this);
//usage:    
var newDom = parseXML(yourString);
var allTags = newDom.getElementsByTagName('*');
for(var i=0;i<allTags.length;i++)
{
    if (allTags[i].tagName.toLowerCase() === 'span')
    {//if all you want to work with are the spans:
        if (allTags[i].hasChildNodes())
        {
            //this span has nodes inside, don't apply regex:
            continue;            
        }         
        allTags[i].innerHTML = allTags[i].innerHTML.replace(/[.,?!'"]+/g,'');
    }
} 
```

这应该可以帮助你。您仍然可以访问 DOM，因此每当您发现需要过滤/替换的字符串时，您可以使用`allTags[i]`并替换内容来引用节点。
请注意，不建议循环遍历*所有*元素，但我真的不想为您完成所有工作;-)。您必须检查您正在处理的节点类型：

```
if (allTags[i].tagName.toLowerCase() === 'span')
{//do certain things
}
if (allTags[i].tagName.toLowerCase() === 'html')
{//skip
    continue;
} 
```

还有那种东西......
请注意，此代码*未经*测试，但它是我对上一个问题的回答的简化版本。解析器位应该可以正常工作，实际上这是我为另一个问题设置[的小提琴，它还向您展示了您可能希望如何更改此代码以更好地满足您的需求](http://jsfiddle.net/d6cgf/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:11:31.207

**编辑**正如 Elias 指出的那样，本机 JScript 不支持前瞻。我会留下这个，以防其他人寻找类似的东西，请注意。

这是我要工作的正则表达式，它需要前瞻和后瞻，我对 Javascript 不够熟悉，无法知道是否支持这些。无论哪种方式，这里都是正则表达式：

```
(?<=>.*?)[,."'](?=.*<) 
```

分解：

```
1\. (?<=>.*?)  -->  The match(es) must have ">" followed by any characters
2\. [,."']     -->  Matches for the characters:  ,  .  "  '
3\. (?=.*<)    -->  The match(es) must have any characters then "<" before it 
```

这实质上意味着它将匹配您想要在一组`> <`.

话虽如此，我建议像评论中提到的那样，使用为此设计的工具解析 HTML，并使用 regex 搜索结果`[,."']`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-15T01:11:28.223

丹，重新提出这个问题，因为它有一个没有提到的简单解决方案。[（在对正则表达式赏金任务](https://stackoverflow.com/q/23589174)进行一些研究时发现了您的问题。）

Dom 解析器解决方案很棒。有了所有关于使用正则表达式解析 html 的免责声明，我想添加一个简单的方法来在 Javascript 中使用正则表达式来做你想做的事情。

正则表达式非常简单：

```
<[^>]*>|([.,"']) 
```

交替的左侧匹配完整的标签。我们将忽略这些匹配。右侧匹配并捕获第 1 组的标点符号，我们知道它们是正确的标点符号，因为它们与左侧的表达式不匹配。

在[此演示](http://regex101.com/r/wK2qJ5)中，查看右下窗格，您可以看到只有正确的标点符号被捕获到第 1 组。

您说您想将标点符号嵌入到`<span>`. 这个 Javascript 代码会做到这一点。我已将 替换为`<tags>`以`{tags}`确保示例显示在浏览器中。

```
<script>
var subject = 'true ,she said. {tag \" . ,}';
var regex = /{[^}]*}|([.,"'])/g;
replaced = subject.replace(regex, function(m, group1) {
    if (group1 == "" ) return m;
    else return "&lt;span&gt;" + group1 + "&lt;/span&gt;";
});
document.write(replaced);
</script> 
```

这是一个[现场演示](http://js.do/code/37965)

**参考**

1.  [除了情况 s1、s2、s3 之外，如何匹配模式](https://stackoverflow.com/q/23589174)
2.  [如何匹配模式，除非...](http://www.rexegg.com/regex-best-trick.html)

# youtube-api - 由于缺少 eurl 参数，将某些 YouTube 视频嵌入 UIWebView 时出现问题

> ID：13533064
> 
> 赞同：1
> 
> 时间：2012-11-23T16:49:21.730
> 
> 标签：youtube-api

我正在标准 iOS UIWebView 中查看 HTML 页面。在此页面中，我嵌入了标准的 YouTube，如下所示：

```
<iframe id="video-play" width="624" height="350" src="http://www.youtube.com/embed/hBLf_N-T0vI" allowfullscreen class="hide fade"></iframe> 
```

这在浏览器上的所有情况下都可以正常工作，并且在大多数情况下在 UIWebView 中。但对于某些视频，我收到（我认为具有误导性）消息：“上传者尚未在您的国家/地区提供此视频。”

问题出在 get_video_info 调用中，并且与从 UIWebView 似乎 eurl 参数设置为“未知”的事实有关

所以这个请求在 UIWebView 中起作用：

```
http://www.youtube.com/get_video_info?html5=1&video_id=hBLf_N-T0vI&eurl=unknown&ps=native&el=embedded&hl=en_GB 
```

这失败了，错误代码 150 和我上面提到的错误消息（它可以在浏览器中正常工作，所以使用下面的原始 HTTP 请求）

```
http://www.youtube.com/get_video_info?html5=1&video_id=DldaCQby3j4&eurl=unknown&ps=native&el=embedded&hl=en_GB 
```

如果我将 eurl=unkown 更改为 eurl=http://rubbish.com/ 那么它会再次起作用：

```
http://www.youtube.com/get_video_info?html5=1&video_id=DldaCQby3j4&eurl=http://rubbish.com&ps=native&el=embedded&hl=en_GB 
```

我试图查看失败的视频的属性，但无法弄清楚是什么导致了好视频和坏视频之间的差异。我查看了嵌入设置、隐私和跟踪设置以及我能想到的任何其他设置。

我的另一个选择是弄清楚如何将 eurl 参数添加到请求中。

帮助！乔恩

如果有人想要完整的 HTTP 请求/响应：

错误的请求

```
GET /get_video_info?html5=1&video_id=DldaCQby3j4&eurl=unknown&ps=native&el=embedded&hl=en_GB HTTP/1.1
Host: www.youtube.com 
```

不良反应

```
HTTP/1.1 200 OK
Date: Fri, 23 Nov 2012 15:42:47 GMT
Server: gwiseguy/2.0
X-Content-Type-Options: nosniff
Access-Control-Allow-Origin: *
Set-Cookie: use_hitbox=d5c5516c3379125f43aa0d495d100d6ddAEAAAAw; path=/; domain=.youtube.com
Set-Cookie: VISITOR_INFO1_LIVE=fH943IGDAFc; path=/; domain=.youtube.com; expires=Sun, 21-Jul-2013 15:42:47 GMT
Expires: Tue, 27 Apr 1971 19:44:06 EST
Cache-Control: no-cache
P3P: CP="This is not a P3P policy! See //support.google.com/accounts/bin/answer.py?answer=151657&hl=en-US for more info."
Content-Type: application/x-www-form-urlencoded
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Transfer-Encoding: chunked

status=fail&errorcode=150&reason=The+uploader+has+not+made+this+video+available+in+your+country.&storyboard_spec=http%3A%2F%2Fi1.ytimg.com%2Fsb%2FDldaCQby3j4%2Fstoryboard3_L%24L%2F%24N.jpg%7C48%2327%23100%2310%2310%230%23default%23w3GCNZfS0BvXcAQIB1BBnUJRlrY%7C80%2345%23112%2310%2310%232000%23M%24M%23VDmT14lMI4g0sdAxTbIujmEIkkI%7C160%2390%23112%235%235%232000%23M%24M%23c1uKcYcKallke_fsXgoUOkSHnwA&errordetail=0 
```

好请求

```
GET /get_video_info?html5=1&video_id=DldaCQby3j4&eurl=http%3A%2F%2Frubbish.com%2F&ps=native&el=embedded&hl=en_GB HTTP/1.1 
```

主持人：www.youtube.com

良好的反应

```
HTTP/1.1 200 OK
Date: Fri, 23 Nov 2012 15:42:34 GMT
Server: gwiseguy/2.0
X-Content-Type-Options: nosniff
Access-Control-Allow-Origin: *
Set-Cookie: use_hitbox=d5c5516c3379125f43aa0d495d100d6ddAEAAAAw; path=/; domain=.youtube.com
Set-Cookie: VISITOR_INFO1_LIVE=zG2n4ZwVAdY; path=/; domain=.youtube.com; expires=Sun, 21-Jul-2013 15:42:33 GMT
Expires: Tue, 27 Apr 1971 19:44:06 EST
Cache-Control: no-cache
P3P: CP="This is not a P3P policy! See //support.google.com/accounts/bin/answer.py?answer=151657&hl=en-US for more info."
Content-Type: application/x-www-form-urlencoded
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Transfer-Encoding: chunked

account_playback_token .... (chopped for brevity). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T17:43:07.467

可能与“已声明”的视频有关。YouTube 的一位联系人回复了我们：

> “[有效的]视频被声明了，而其他视频则没有，所以声明过程中的某些东西导致了这个问题。”

# javascript - 隐藏选择选项跨浏览器

> ID：13533066
> 
> 赞同：2
> 
> 时间：2012-11-23T16:49:27.870
> 
> 标签：javascript, jquery, drop-down-menu, cross-browser

难道没有办法吗？

我制作了在 IE 中不起作用的[jsFiddle](http://jsfiddle.net/tapas_23571113/h5wHD/)。

这段代码如下：

的HTML

```
<select id="testing">
    <option value="1">Option 1</option>
    <option value="2">Option 2</option>
    <option value="3">Option 3</option>
</select> 
```

jQuery

```
$(document).ready(function() {
    $('select#testing option').eq(1).attr({
        disabled: 'disabled'
    });
}); 
```

CSS

```
select option[disabled] {display: none;} 
```

任何指针都会有所帮助。

注意：我不能使用`.remove()`方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:02:13.060

要支持 IE7，您将不得不求助于一些技巧，请参阅这篇文章[Disable Select Options in Internet Explorer](http://harrybailey.com/2008/11/disabling-select-options-in-internet-explorer/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T16:54:11.890

尝试`select option[disabled=disabled]`或在您应用 CSS 规则 ( )`disabled`的`option`元素上设置一个类。`display: none;`

**编辑**

在 IE9 上对此进行测试后，我发现它不允许您隐藏选项元素，至少不能通过`display:none;`，设置`disabled="disabled"`确实禁用该元素，但不能隐藏它。

# java - 加载 jdbc:odbc 驱动程序时，Class 类中的 forName() 方法有什么作用？

> ID：13533071
> 
> 赞同：2
> 
> 时间：2012-11-23T16:49:46.957
> 
> 标签：java, database, jdbc, odbc, driver

我正在学习使我的 Java 应用程序能够与 MS Access 数据库进行通信。

我不确定一种方法，Class.forName() 方法。我传递的参数是“sun.jdbc.odbc.JdbcOdbcDriver”，它加载了jdbc:odbc 网桥来访问数据库。

Class.forName() 究竟做了什么，为什么需要它？

非常感谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T16:53:24.803

`Class.forName()`导致 ClassLoader 将类加载到内存中。JDBC 驱动程序类具有静态初始化程序，可将它们注册到 DriverManager 以供进一步使用。使用`Class.forName()`, 和 use后`DriverManager.getConnection("jdbc:*", database, username, password)`，`jdbc:`已经加载到内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T16:55:23.803

`Class.forName()`用于动态加载类。例如，您调用`Class.forName("z")`了 ，这将导致类 z 被初始化并返回相应的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T16:53:23.297

Class.forName() 使用反射来加载给定名称的类。它返回一个类对象。看到[这个](http://www.xyzws.com/Javafaq/what-does-classforname-method-do/17)。

在您的情况下，它允许您在运行时加载特定的驱动程序，而无需对驱动程序类型进行硬编码。您只需将驱动程序名称作为参数传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T16:53:38.460

它用于`reflection`实例化`sun.jdbc.odbc.JdbcOdbcDriver`类，使用字符串格式的类名。

这使您的代码**`Driver`类独立**，并允许您将驱动程序类名称作为字符串参数从外部传递（这是我们通过配置传递连接详细信息时的标准行为）。

# c++ - 如何在 Xcode 中导入 C++ 库？

> ID：13533076
> 
> 赞同：0
> 
> 时间：2012-11-23T16:49:55.543
> 
> 标签：c++, xcode, macos

我正在使用 Xcode 开发一个简单的应用程序。我需要一个名为 cURL 的库，用于管理简单的连接方法，但我真的不知道如何在 Xcode 中导入这个库。我正在用 C++ 编程，我知道这在 Mac 上不是一个好主意程序，但我没有其他选择。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:12:34.583

`libcurl`是 Mac OS X 上的标准库 -如您所料，头文件`/usr/include/curl`和库都在。`/usr/lib`

您可以将相关的标头和库显式添加到您的项目中（使查找内容更容易并避免设置构建标志），或者您可以*通过*在构建设置。

# underscore.js - 使用 Underscore.JS 校准数据

> ID：13533079
> 
> 赞同：-1
> 
> 时间：2012-11-23T16:50:11.253
> 
> 标签：underscore.js

另一个任务`underscore.js`- 我需要“校准”数据，以便在图表中显示它。

给定：可用空间：`160`和数据：`data: [10, 50, 80, 90]`我想得到`calibratedData: [0, 80, 140, 160]`.

这是算法：

1.  得到数据的峰值, `Min=10`, `Max = 90`.
2.  得到`Min`和`Max`,之间的差`80`。
3.  获得可用于变化单元的`Unit`空间为`1``160 / 80 = 2`
4.  使用上一步的比率校准数据中的每个项目： `d[i] = (d[i]-Min) * Unit`，得到`[0, 80, 140, 160]`.

想知道我是否可以使用`underscore.js`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T14:41:14.997

我不明白为什么人们对你的问题投了反对票，但找到答案很有趣。这里是：

```
function calibrate( data, availableSpace ) {
    var min = _.min(data);
    var max = _.max(data);
    var range = max - min;
    var spacePerUnit = availableSpace / range;
    return _.map( data, function (value) {
        return ( value - min ) * spacePerUnit;
    });
}

alert( calibrate( [10, 50, 80, 90], 160 ) ); 
```

您可以在[这个 JSFiddle](http://jsfiddle.net/fXwRd/)中尝试一下。

关键是使用`map()`Underscore中的函数和这个函数：

```
function (value) {
  return ( value - min ) * spacePerUnit;
} 
```

该函数可以访问父函数中的 min、max 和 spacePerUnit 值，这使得它非常高效（因为它不会在每次迭代中进行计算）。

# cron - 服务器集群：一项任务

> ID：13533082
> 
> 赞同：0
> 
> 时间：2012-11-23T16:50:23.463
> 
> 标签：cron, cluster-computing

## 的背景

我们的客户使用他们设定每日预算的服务。这是一项预付费服务，我们每天从用户的预算中分配特定金额。

表：

*   **预算**——我们每天可以花多少钱
*   **钱**- 客户实际余额
*   **money_allocated - 从今天可以花费的****钱**中扣除的金额（基于**预算**）

有一个 cron 作业每隔几分钟运行一次并检查：

*   如果用户在给定的一天有**money_allocated**
*   如果**money_allocated** >= **budgets**（用户可以在白天增加预算）

在第一种情况下，我们分配每日预算的全部金额，在后者中 - 预算与当天已分配金额之间的差额（在这种情况下，我们在同一天的**money_allocated中创建附加记录）。**

分配有两个阶段——在第一轮中，我们添加一行状态为“待处理”（已请求分配），另一个 cron 检查所有“待处理”分配，如果用户有足够的钱，则将钱从**money**转移到**money_allocated 。**这会将状态更改为“已完成”。

## 问题

我们有一个应用程序服务器集群（在 NLB 下），并且上面的 cron 作业在每个服务器上运行，这意味着可能会意外地多次分配资金（或者如果我们实施错误的“已分配”触发器，则根本不分配）。

我们的选择包括：

*   仅在一台服务器上运行 cron 作业 - 没有冗余、客户投诉和失败造成的金钱损失
*   **在money_allocated**上添加一个唯一索引，类似于 (client_id, date, amount) - 如果客户在一天内将预算翻倍或多次增加相同的金额，则不会为给定的一天分配更多的钱

有一个选项可以记录**预算**中的每个变动，并将所有分配链接到“当天的第一次分配”或“预算更改（id xxx）”（也将其添加到唯一索引）。然而，这看起来不够性感。

还有其他选择吗？任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:13:16.743

好的，所以我最终在集群的一个实例上运行它。如果您使用 Amazon AWS 并且处于类似情况，以下是其中一个选项。

在每台机器上，在您的 cron 作业代码的开头，执行以下操作：

*   调用`describe_load_balancers`（AWS API），解析响应以获取所有实例的列表/数组
*   Get `http://169.254.169.254/latest/meta-data/instance-id`- 这将返回发送请求的机器的实例 ID
*   如果收到的实例 ID 在所有实例的列表/数组中是 #1 - 继续，如果不是 - 退出

此外，请务必在短时间内自动替换此负载均衡器下的不健康实例，因为它会`describe_load_balancers`返回健康和不健康实例的列表。如果实例 #1 出现故障，您最终可能会暂时没有完成工作。

# ios - UIWebView loadHtmlString 在设备上不起作用

> ID：13533088
> 
> 赞同：0
> 
> 时间：2012-11-23T16:51:01.940
> 
> 标签：ios, xcode, google-analytics

我有一个我想使用 loadHtmlString 方法加载的 webview。问题是我希望能够使用我之前下载的图像更改 img src。我还在 html 中使用了 google analitics，所以我需要将 baseUrl 设置为实际的 url，这样它才能工作。问题来了。如果我放入 baseUrl，图像将不会加载。如果我不设置 baseUrl，它可以工作。我该如何解决这个问题，这样我就可以使用 google analitycs 并将图像本地存储在我的应用程序中？我宁愿不必在我的项目中实现 google analitics sdk。

奇怪的是，如果我在模拟器中运行它，而不是在我的 baseUrl 前面加上“http://”前缀，它就可以正常工作。但是，当我在设备上运行它时，我收到以下错误并且它不起作用：

```
Domain=WebKitErrorDomain Code=101 "The URL can’t be shown" 
```

谢谢

编辑

如果我这样做，它会起作用：

```
[appsWebView loadHTMLString:htmlString baseURL:nil]; 
```

但是，我必须提供一个 baseURL 才能让 Google Analitics 正常工作，我还有两种情况：

1.  这给出了上述错误：（它在模拟器中工作正常，但在设备上运行时出错）

    [appsWebView loadHTMLString:htmlString baseURL:[NSURL urlWithString:@"test.com"]];

2.  这个根本不显示任何东西：（既不加载html字符串也不加载url）

    [appsWebView loadHTMLString:htmlString baseURL:[NSURL urlWithString:@"http://test.com"]];

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:00:56.537

我错误地认为问题在于本地图像没有完全指定完整路径，但这似乎不是问题所在。但是，您似乎（有点令人惊讶）您不能指定一些基于 Web 的`baseURL`并且还引用 HTML 字符串中的本地图像，这是完全正确的。没有简单的解决方案突然出现在我面前，但至少，您似乎有几个（不是很好）选择：

**首先，您可以使用诸如**[Mike Gallagher 的 NSData+Base64 类别之类的](http://www.cocoawithlove.com/2009/06/base64-encoding-options-on-mac-and.html)base64 库对本地图像进行 base64 编码，例如：

```
NSData *imageData = [NSData dataWithContentsOfFile:imagePath];
NSString *imageDataBase64 = [imageData base64EncodedString];
NSString *imageHtml = [NSString stringWithFormat:@"<img src='data:image/png;base64,%@'>", imageDataBase64]; 
```

这会减慢初始渲染速度，但也许总比没有好。

**其次**，您始终可以尝试保留`baseURL`as `nil`，从 HTML 字符串中删除执行 Google Analytics 的 JavaScript，然后尝试通过`stringByEvaluatingJavaScriptFromString`. 这种方法可能有效也可能无效，具体取决于 Google Analytics JavaScript 的复杂性（例如，它可能有哪些进一步的基于 Web 的引用），但您也有可能以这种方式做某事。

我很抱歉假设问题是一个微不足道的`img`URL。显然，您已经确定了一个更根本的问题。

* * *

**原答案：**

在 HTML 字符串中创建图像 URL，使其成为本地文件系统中的完全限定文件 URL：

图像位于`Documents`：

```
NSString *documentsPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0];
NSString *imagePath = [documentsPath stringByAppendingPathComponent:imageName]; 
```

或在捆绑包中：

```
NSString *imagePath = [[NSBundle mainBundle] pathForResource:imageName 
                                                      ofType:nil]; 
```

但是，一旦你有完全合格的路径，你应该能够使用它：

```
NSURL *imageUrl = [NSURL fileURLWithPath:imagePath];
NSString *imageHtml = [NSString stringWithFormat:@"<img src='%@'>", imageUrl]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T17:47:39.577

我敢打赌这是一个外壳问题。考虑到设备是区分大小写的，而模拟器不是。检查 URL 并确保它包含正确的字符。

# javascript - 未捕获的类型错误：对象# 没有方法“attr”

> ID：13533089
> 
> 赞同：18
> 
> 时间：2012-11-23T16:51:02.677
> 
> 标签：javascript, jquery

我试图用类工具提示来获取我的 div。

然后做这样的事情：

```
var schemes = $(".tooltip");

for (var i in schemes) {
    var scheme = schemes[i];
    console.log(scheme.attr("cost"));
} 
```

但它会引发上述错误。我错过了什么？（我显然是 javascript + jquery 的新手）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-23T16:51:43.907

如果您使用`for-loop`迭代 jQuery 集合，您应该使用方法获取元素`eq()`，而不是使用方括号表示法（即`[]`）。类似的代码`$(".tooltip")[i]`将获取 DOM 元素，而*不是*jQuery 对象。

```
var schemes = $(".tooltip");
for (var i = 0; i < schemes.length; i++) {
    var scheme = schemes.eq(i);
    console.log(scheme.attr("cost"));
} 
```

但是，您可能总是使用`each()`迭代 jQuery 集：

```
$(".tooltip").each(function() {
    var scheme = $(this);
    console.log(scheme.attr("cost"));
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T16:54:58.297

```
var schemes = $(".tooltip");

schemes.each(function(index, elem) {
    console.log($(elem).attr('cost'));
}); 
```

作为旁注，据我所知，“成本”不是任何元素的有效属性，您可能应该使用数据属性。

# c# - MVP - 如何公开我的模型的特定属性

> ID：13533100
> 
> 赞同：0
> 
> 时间：2012-11-23T16:51:36.353
> 
> 标签：c#, winforms, mvp

我在 C# winforms 应用程序中使用 MVP 模式并遇到了以下设计问题。我`User`在我的域中有一个类和一个`UserCollectionDAO`从数据库中加载所有用户的其他一些信息的类。当我通过演示者向我的视图展示一组用户时，我不想显示他们的所有属性。例如，我的用户具有以下属性：

```
class User
{
   public User(int id)
   {
      Id = id;
   } 

   public int Id { get; private set; }

   public string Name { get; set; }

   public LocationId { get; set; }
} 
```

我想在我`Listview`的用户中显示的是名称和位置的名称，我可以从系统中的另一个数据结构中获得。同时我想在我的应用程序的其他区域使用 LocationId 和 Id。我已经阅读了可能需要使用的另一层，即 DTO 对象。你对此有什么看法，你能看到另一种实现我想要的方法吗？如何将信息从视图传递到 DTO 用户实例到域用户实例？

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:22:13.470

通常，您会将域类/模型转换为 ViewModel（特定于特定视图的模型，隐藏模型的特定属性）。

在[领域服务层](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)创建一个将模型转换为视图模型的方法，或者使用[AutoMapper](https://github.com/AutoMapper/AutoMapper/wiki/Getting-started)之类的库将其自动转换为您。您的域用户类上的某些属性*可能*需要公开（为什么不公开？）才能被 AutoMapper 自动复制。

进一步阅读：[MVVM 模式](http://en.wikipedia.org/wiki/Model_View_ViewModel)

# python - 如何使用 Superfeedr 订阅实时 XMPP RSS 提要

> ID：13533104
> 
> 赞同：3
> 
> 时间：2012-11-23T16:51:50.893
> 
> 标签：python, xml, rss, xmpp, superfeedr

我正在尝试使用 Superfeedr 订阅提要，并且我已经为 XMPP 启动并运行了一个 python 包装器，并且我正在`dummy.xml`成功接收。

但是，我不太明白如何添加更多来源？我尝试添加一些`superfeedr.com/track/`'s，但我没有从中获得新的提要（尽管我似乎确实得到了订阅确认）。

我想添加尽可能多的实时（非 POLL）提要，也许通过使用 PubSubHub 服务器。

我真的很感谢对此的一些帮助 - 我在哪里可以找到这样的提要？我可以通过添加订阅整个 superfeedr.com 实时订阅`/track/`吗？还是只会过滤我订阅的提要？另外，当我在我的亚马逊服务器上从我的`XMPP.py`客户端订阅时，我的订阅者 URL（回调）到底是什么？

我从这里去哪里？

如果需要，我会添加更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-27T23:37:38.790

Superfeedr 是一个 API，它可以帮助您从应该自己管理的提要中收集数据。因此，整个过程从您收集要订阅的提要列表开始。

[Track API](http://documentation.superfeedr.com/misc.html#track)不会帮助您查找提要，而是帮助您构建符合给定条件的虚拟*提要。*例如，如果您想在任何提要中提及“stackoerflow”，您可以使用 track。将其视为搜索结果的 RSS 提要，但是是实时的（前瞻性）。

最后，如果您使用[XMPP](http://documentation.superfeedr.com/subscribers.html#xmpppubsub)，则不需要回调 url，因为它们是[PubSubHubbub API](http://documentation.superfeedr.com/subscribers.html#webhooks)的一部分。

# php - 使用 PHP 从另一个字符串中提取字符串

> ID：13533109
> 
> 赞同：0
> 
> 时间：2012-11-23T16:52:05.200
> 
> 标签：php

我正在尝试从 XML 中提取值。我的 xml 文件包含一个产品“描述”字段，该字段由产品条形码、数据包和托盘组成。

我只想提取 Pck（它可以是 1-999 之间的任何数字）。

我的 xml 属性（描述）字段值：

```
 Description="5038135129483  &#xD;&#xAPck: 4   Plt: 120" 
```

这里

```
 Barcode=5038135129483   
 Number of Packets(Pck)=4
 Number of Palletes(Plt)=120

 $pieces = substr($WhatDescription,19,20); 
```

我已经尝试过 substr 函数从字符串中提取，但它并没有给我准确的结果，因为 barcode 的长度不同并且我的 XML 中有 html 字符。你能告诉我应该怎么做才能从上面的字符串中提取 Pck，这样我的提取就不会依赖于 html 字符和条形码的长度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:04:10.217

你可以试试：

```
<?php
   $text = "5038135129483  &#xD;&#xAPck: 4   Plt: 120";
   $newtext = strstr($text,'Pck:');
   echo $final = trim(substr($newtext,0,stripos($newtext,'Plt:')));
?> 
```

工作代码：[http ://codepad.org/3sbfIim8](http://codepad.org/3sbfIim8)

# javascript - 未定义的javascript函数？

> ID：13533110
> 
> 赞同：0
> 
> 时间：2012-11-23T16:52:16.090
> 
> 标签：javascript, google-maps

从事谷歌地图项目并坚持似乎是一个小问题。当我调用 displayMarkers 函数时，萤火虫返回：

> ReferenceError：未定义 displayMarkers [中断此错误]
> 
> 显示标记（1）；

```
<script type="text/javascript">
    function initialize() {
        var center = new google.maps.LatLng(25.7889689, -80.2264393);
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 10,
            center: center,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        //var data = [[25.924292, -80.124314], [26.140795, -80.3204049], [25.7662857, -80.194692]]     var data = {"crs": {"type": "link", "properties": {"href": "http://spatialreference.org/ref/epsg/4326/", "type": "proj4"}}, "type": "FeatureCollection", "features": [{"geometry": {"type": "Point", "coordinates": [25.924292, -80.124314]}, "type": "Feature", "properties": {"industry": [2], "description": "hosp", "title": "shaytac hosp2"}, "id": 35}, {"geometry": {"type": "Point", "coordinates": [26.140795, -80.3204049]}, "type": "Feature", "properties": {"industry": [1, 2], "description": "retail", "title": "shaytac retail"}, "id": 48}, {"geometry": {"type": "Point", "coordinates": [25.7662857, -80.194692]}, "type": "Feature", "properties": {"industry": [2], "description": "hosp2", "title": "shaytac hosp3"}, "id": 36}]}
        var markers = [];
        for (var i = 0; i < data.features.length; i++) {
            var latLng = new google.maps.LatLng(data.features[i].geometry.coordinates[0], data.features[i].geometry.coordinates[1]);
            var marker = new google.maps.Marker({
                position: latLng,
                title: console.log(data.features[i].properties.industry[0]),
                map: map
            });
            marker.category = data.features[i].properties.industry[0];
            marker.setVisible(true);
            markers.push(marker);
        }
        function displayMarkers(category) {
            var i;
            for (i = 0; i < markers.length; i++) {
                if (markers[i].category === category) {
                    markers[i].setVisible(true);
                } else {
                    markers[i].setVisible(false);
                }
            }
        }
    }
    google.maps.event.addDomListener(window, 'load', initialize);
</script>
<div id="map-container">
    <div id="map"></div>
</div>
<input type="button" value="Retail" onclick="displayMarkers(1);"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T16:55:43.280

函数`displayMarkers`必须在全局范围内才能被这样调用（从`onclick`属性中）。

这可能就是正在发生的事情。请正确格式化和缩进您的代码，这应该很容易发现（我认为它是在内部定义的`initialize`，而它应该在外部）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:01:52.733

`displayMarkers`在函数内部定义`initialize`。

`onclick="displayMarkers(1);"`在全局命名空间中搜索该函数，显然它不存在。这是一种使`displayMarkers`函数成为全局但仍然能够引用内部定义的变量的解决方法`initialize`。改变：

```
function initialize() {
    // ...
    function displayMarkers(category) {
        // ...
    }
} 
```

到：

```
function initialize() {
    // ...  
    window.displayMarkers = function (category) {
        // ...  
    }
} 
```

# bash - 对话框 - 发送

> ID：13533112
> 
> 赞同：-1
> 
> 时间：2012-11-23T16:52:27.167
> 
> 标签：bash

如何在对话中发送 apt-get install 我可以回答问题（是/否）？

就像是：

```
apt-get install mc | dialog --progressbox 0 0 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T09:01:44.780

如果我正确理解你的问题，`expect`可以帮助你。

> Expect 是一个根据脚本与其他交互式程序“对话”的程序。根据脚本，Expect 知道程序可以预期什么以及正确的响应应该是什么。解释语言提供分支和高级控制结构来指导对话。此外，用户可以在需要时直接进行控制和交互，然后将控制权返回给脚本。

[http://linux.die.net/man/1/expect](http://linux.die.net/man/1/expect)

# php - 带有 Ajax/jQuery 的 iFrame 功能

> ID：13533113
> 
> 赞同：0
> 
> 时间：2012-11-23T16:52:30.220
> 
> 标签：php, jquery, ajax, iframe

我需要从我下载到我的网站的预订 PHP 模块中包含一个小表格。它的文档说它必须包含在 iFrame 中。但是该位置受到限制，因此当打开日期选择器并显示滚动条时，iFrame 会溢出。

为了解决这个问题，我尝试使用 jQuery，这样 div 就会溢出。

```
<div id="siteloader">
            <script>
                    $(function(){
                    $('#siteloader').load('<?php echo base_url('booking/form_homepage.php')?>');
                    });
                </script>
</div> 
```

但是，它导致它仅加载 HTML。这对我来说不是必需的，因为我要加载的页面来自一个完整的模块，所以我需要完整加载它，基本上 iFrame 会做什么。

有没有办法用 Ajax/jQuery 实现这一点？

提前致谢

# mysql - MySQL - 根据条件连接 3 个表

> ID：13533114
> 
> 赞同：0
> 
> 时间：2012-11-23T16:52:35.667
> 
> 标签：mysql, join, foreign-keys

请帮助 MySQL 新手。我有 3 个表：表 users-username 是主键，表 song - idsong 是主键，第二列是标题，第三个表以“ref”列作为主键购买，“idsong”是歌曲表和“用户名”的外键" 是用户表中的外键。因此，我需要生成一个查询，该查询将提取特定用户购买了哪些歌曲，并且我需要显示标题。到目前为止，我有：

```
SELECT idsong FROM purchased  
   JOIN users ON users.username=purchased.username  
   WHERE users.username='admin'; 
```

这给了我用户的歌曲 ID，但我不确定如何添加标题以从第三个表中显示。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T16:58:33.657

```
SELECT s.idsong, s.title
  FROM purchased p 
 INNER JOIN users u ON u.username=p.username
 INNER JOIN song s ON p.idsong = s.idsong
 WHERE u.username='admin'; 
```

# php - Zend 无法在 Plesk 服务器上打开所需的“Zend/Loader.php”

> ID：13533116
> 
> 赞同：0
> 
> 时间：2012-11-23T16:52:43.423
> 
> 标签：php, zend-framework2, plesk

我在试图让 Zend 框架正常工作的 plesk 服务器上收到以下警告和错误：

```
PHP Warning: require_once(Zend/Loader.php) [function.require-once]: failed to open stream: No such file or directory in /var/www/vhosts/mydomain.com/httpdocs/test.php on line 5 
PHP Fatal error: require_once() [function.require-once]: Failed opening required 'Zend/Loader.php' (include_path='.:/usr/share/pear:/local/PEAR/:/usr/share/zend') in /var/www/vhosts/mydomain.com/httpdocs/test.php on line 5 
```

我`include_path`在 php.ini 文件 (/etc/php.ini) 中设置了使用添加 Zend 文件的目录 (/usr/share/zend)。然后，该目录在名为 Zend 的子目录中包含框架。

我尝试在`include_path`(/usr/share/zend/) 的末尾添加一个斜杠。

我使用时路径存在`get_include_path()`

我试过使用`set_include_path`.

/usr/share/zend 目录有 775 权限（也尝试使用 777）并且用户和组都设置为 root。

我希望该框架可用于服务器上的所有站点。

我也复制了 Gdata 文件，并且 Zend/Loader.php 在那里。

版本：

*   框架：2.0.4
*   Gdata：1.12.0

这是PHP：

```
require_once("Zend/Loader.php"); 
```

我也尝试过使用：

```
require_once("/usr/share/zend/Zend/Loader.php"); 
```

我是新手 plesk/unix 用户

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T19:19:50.090

要检查的事项是：

*   该文件存在于 PHP 正在寻找的位置。
*   该文件可由 Web 服务器/php_fpm 进程读取。
*   安全模式已关闭！

（将信息放在这里 - 以便可以将问题标记为已回答！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T21:43:21.717

Zend/Loader.php 用于 ZF1，而 ZF2 (2.0.4) 中不存在该文件

另外，您需要下载与 ZF2 兼容的 GData 更新版本

[https://github.com/zendframework/ZendGData](https://github.com/zendframework/ZendGData)

如果您将使用 Composer 来设置您的依赖项，那么您应该使用`require_once __DIR__ . '/path/to/vendor/autoload.php`

# php - 无法在管理页面中显示一个用户数据

> ID：13533117
> 
> 赞同：-1
> 
> 时间：2012-11-23T16:52:47.040
> 
> 标签：php, sql, database

这是一个管理页面，应该显示所选用户的所有数据我试图只显示一个用户的数据，但得到一个空页面：

```
<?php
    if (isset($_POST['user']))
     {
        $user = $_POST['user'];

        //if username has been selected
        if($user == "none") 
           {
              echo '<div class="error"><p>No user has been selected</p></div>';
              echo '<meta HTTP-EQUIV="REFRESH" content="1; url=adminPanel.php">';
            }
            else
            {

            //form query
        $query = "SELECT * FROM User WHERE user =  '$user'";

        //Execute query
        $query_result = mysql_query($query)
            or die(mysql_error());
        echo '<table>';
        while($user_data = mysql_fetch_array($query_result))
                {

                    echo '<tr>';
                    echo '<td>'.$user_data['user'].'</td>';
                    echo '<td>'.$user_data['email'].'</td>';
                    echo '<td>'.$user_data['added'].'</td>';
                    echo '<td>'.$user_data['admin'].'</td>';
                    echo '<td>'.$user_data['type'].'</td>';
                    echo '</tr>';

                }
        echo '</table>';        
            }
}
?> 
```

这里可能有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:37:38.090

你应该先试试： echo "ROW COUNT: ".mysql_num_rows($query); 或者你可以抛出一个 var_dump($user_data);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:49:38.503

你可能会尝试这样的事情。[正如其他人所说，使用PDO](http://php.net/manual/en/book.pdo.php)会好得多，但至少`mysql_real_escape_string()`比直接将数据输入到查询中更安全。

```
<?php
    if (empty($_POST['user']) || $_POST['user'] == 'none') {
        exit('No user was selected set.');
    }

    $user = (string) mysql_real_escape_string($_POST['user']);

    $sql = "
        SELECT user, email, added, admin, type
        FROM User
        WHERE user = '%s'";
    $query_string = sprintf($sql, $user);

    $result = mysql_query($query_string);

    if (empty($result)) {
        exit('Failed to retrieve user data.');
    }

    echo '
        <table>';
    while ($user = mysql_fetch_assoc($result))
    {
        echo '
            <tr>
                <td>', $user['user'], '</td>
                <td>', $user['email'], '</td>
                <td>', $user['added'], '</td>
                <td>', $user['admin'], '</td>
                <td>', $user['type'], '</td>
            </tr>';
    }
    echo '
        </table>'; 
```

# css - jqGrid 的自定义 css 设计示例

> ID：13533118
> 
> 赞同：0
> 
> 时间：2012-11-23T16:52:47.943
> 
> 标签：css, jquery-ui, user-interface, jqgrid

有没有人有一些漂亮的 jqGrid 自定义 css 设计示例，除了使用 jQuery UI 产生的那些？一些截图会很好。我在谷歌上搜索，但找不到任何视觉示例。

提前致谢。

# spring - Spring Tool Suite 缺少 Spring MVC 项目模板

> ID：13533123
> 
> 赞同：16
> 
> 时间：2012-11-23T16:53:14.793
> 
> 标签：spring, spring-mvc

在许多关于使用 Spring MVC 框架创建 Web 服务的示例/教程中都使用 Spring MVC 项目模板。我在我的项目模板列表中找不到它。我错过了一些安装的插件吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-02-24T13:29:56.920

对于版本：3.7.1

1）转到文件->新建

2）点击Spring Legacy Project

3) 向下滚动并选择 Spring MVC

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-23T16:58:38.813

模板应该可以通过仪表板上的链接获得，如下面的屏幕截图所示。不需要插件。

![STS 仪表板](../Images/e5a6caae47bdea7feb95c5cdae7270d1.png)

可用的模板应如下所示：

![在此处输入图像描述](../Images/a81d681f3a31f02cbfd2bc24b155ac79.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-01T08:26:30.073

在 New Spring Project 表单中单击“Configure Templates...” 然后在 Preference->Spring->Dashboard 中选中 Use Old Dashboad 它会出现

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-02T08:43:15.400

试试这个，它解决了我的问题。

1.  转到新项目-> Spring Legacy 项目。首次使用时，仅显示“简单项目”文件夹。
2.  选择配置模板..（蓝色链接）。
3.  在 Template Projects 窗口中，删除“spring-data-gemfire”和“spring-integration”，并选中“Show self-hosted templates ...”（在底部），然后按 Apply -> OK
4.  等待刷新过程，应该会显示“Spring MVC Project”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-19T21:59:54.370

*   转到文件->*新建*

*   选择*Spring Legacy 项目*

*   *在Templates*下查找**Spring MVC 项目**（列表中的最后一个，如果需要向下滚动）

 *如果您没有看到*Spring MVC Project*，请选择[Configure templates..](https://i.stack.imgur.com/hlXwK.png)链接

[![在此处输入图像描述](../Images/3af1ed9e40f0ec26014af478fae42fdf.png)](https://i.stack.imgur.com/hlXwK.png)

*   在*首选项*->*弹簧*->*仪表板下*

*   选中**Use Old Dashboard**并按*Apply* - *Ok*。

[![在此处输入图像描述](../Images/1e89a114ae010788d8af5e2522d71e73.png)](https://i.stack.imgur.com/u3bHE.png)

> 等待刷新过程....

*   您现在应该可以看到**Spring MVC 项目**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-11T18:30:11.427

当我开始在笔记本电脑上使用 sts 3.6.1 版本时，我遇到了同样的问题。同时，当我选择 spring legacy 项目文件夹时，没有显示 spring mvc 项目文件夹。但是我配置了我的防火墙代理设置，并且很快就轻松获得了该文件夹。因此，在使用 mvc 之前，首先检查 urs 防火墙和代理。

将代理从本机配置到手动到显示的 spring mvc 项目的步骤：- window--->preferences--->network connection-->active provider-->choose manual-->ok 然后去检查 spring legacy 文件夹 spring mvc会出现*

# filepicker.io - Filepicker.io - Picasa 大小限制

> ID：13533125
> 
> 赞同：4
> 
> 时间：2012-11-23T16:53:21.423
> 
> 标签：filepicker.io

我们注意到 Filepicker.io 和 Picasa 集成存在一些问题。似乎没有处理大图像（超过 ~ 2MB） - POST`www.filepicker.io/api/store/`返回`The specified bucket is not valid.`这些文件。较小的文件处理就好了。

不确定问题出在哪里。该响应可能表明我们的 S3 存储桶存在问题，但我们已经能够`Computer`毫无问题地处理大型上传。会不会是 Picasa Web API 的限制？任何信息都有帮助。谢谢。

# jquery - 基于 jQuery 的下拉菜单在向右对齐时不起作用

> ID：13533129
> 
> 赞同：1
> 
> 时间：2012-11-23T16:53:35.193
> 
> 标签：jquery, html, css

我有以下几乎可以完美运行的脚本：

**HTML：**

```
<div class="menu">
    <div class="navigation1">icon Home</div>
    <div class="dropdown">
        <div class="items">icon Default 1</div>
        <div class="items">icon Reports 1</div>
        <div class="items">icon Other 1</div>
    </div>
    <div class="navigation2">icon Home</div>
    <div class="dropdown">
        <div class="items">icon Default 2</div>
        <div class="items">icon Reports 2</div>
        <div class="items">icon Other 2</div>
    </div>
</div> 
```

​</p>

**CSS：**

```
.menu {
    position: relative;
    background-color:silver;
    font-family:Arial;
    font-size:12px;
    height:25px;
}

.navigation1 {
    float:left;
    padding:5px 10px 5px 10px;
    cursor:pointer;
}

.navigation2 {
    float:right;
    padding:5px 10px 5px 10px;
    cursor:pointer;
}

.navigation1::selection, .navigation2::selection { background:transparent; }
.navigation1::-moz-selection, .navigation2::-moz-selection { background:transparent; }

.navigation1:hover, .navigation2:hover {
    background-color:gray;
}

.navigation1.active, .navigation2.active {
    border:1px solid black;
    border-bottom-color:white;
    padding:4px 9px;
    background-color: white;
    position:relative;
    z-index:1;
}

.dropdown {
    display:none;
    border:1px solid black;
    border-bottom-width:2px;
    background-color:white;
    position:absolute;
    top:24px;
    padding:5px 10px;
    cursor:pointer;
}​ 
```

**jQuery：**

```
$(document).click(function(event) {
    $('.navigation1.active, .navigation2.active').click();
    $('.navigation1').removeClass("active");
});

$('.dropdown').each(function() {
    $(this).css('left', $(this).prev().position().left);
});

$('.navigation1, .navigation2').click(function(event) {
    $(this).siblings('.navigation1.active, .navigation2.active').click();
    $(this).toggleClass('active').next().toggle();
    event.stopPropagation();
});

$('.navigation1, .navigation2').disableSelection();​ 
```

**问题：**

唯一的问题是右侧的菜单，当它的下拉菜单下拉时，文本最终会换行，因为下拉菜单不够宽。如何根据其中的文本将下拉菜单设置为正确的宽度，但允许它突出在左侧。

所以基本上，对于左侧菜单，下拉菜单从右侧突出

对于右侧菜单，下拉菜单应从菜单左侧突出。

**jsFiddle：**

[http://jsfiddle.net/mnXdv/53/](http://jsfiddle.net/mnXdv/53/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:08:39.667

所以首先，请检查这个[http://jsfiddle.net/MTESY/](http://jsfiddle.net/MTESY/)

如果您看到预期的结果，实现它的方法是为您的第二个下拉列表`div`提供第二个类，例如`second`. 之后创建一个 css 类`.second {left: auto ! important; right: 0}`。那你应该很好。

# doctrine-orm - 教义2 - 关系

> ID：13533131
> 
> 赞同：0
> 
> 时间：2012-11-23T16:53:48.240
> 
> 标签：doctrine-orm, yaml

我正在开发一个应用程序，它正在寻找公共交通的最佳路线和时间表。我对 Doctrine1 有一些经验，但这是我第一次接触 Doctrine2。有一些新的字段来描述关系（mappedBy 和 inversedBy），还有一些新的映射方式。

我有以下代码：

```
$query = $this->em->createQuery("SELECT partial cls.{stop}, partial t.{arriveTime, departureTime} FROM \Entities\Timetable t 
JOIN t.ride r
JOIN t.carrierLineStop cls
WHERE t.departureTime>=:time AND 
r.idCarrierLine=:carrierLine AND 
(cls.idStop=:firstStop OR cls.idStop=:lastStop)");
$query->setParameters(array(
    'time' => $time,
    'carrierLine' => $path->getLine(),
    'firstStop' => $path->getFirstStop(),
    'lastStop' => $path->getLastStop()
)); 
```

当我尝试执行该脚本时出现错误：

```
[Semantical Error] line 0, col 24 near '}, partial t.{arriveTime,': Error: There is no mapped field named 'stop' on class Entities\CarrierLineStop. 
```

映射文件：

```
Entities\CarrierLineStop:
type: entity
table: carrier_line_stop
fields:
    idCarrierLineStop:
        id: true
        type: integer
        unsigned: false
        nullable: false
        column: id_carrier_line_stop
        generator:
            strategy: IDENTITY
    nextStop:
        type: integer
        unsigned: false
        nullable: true
        column: next_stop
manyToOne:
    idCarrierLine:
        targetEntity: Entities\CarrierLine
        cascade: {  }
        mappedBy: null
        inversedBy: null
        joinColumns:
            id_carrier_line:
                referencedColumnName: id_carrier_line
        orphanRemoval: false
    stop:
        column: id_stop
        targetEntity: Entities\Stop
        cascade: {  }
        mappedBy: null
        inversedBy: carrierLineStop
        joinColumns:
            id_stop:
                referencedColumnName: id_stop
        orphanRemoval: false
lifecycleCallbacks: {  } 
```

-

```
Entities\Stop:
type: entity
table: stop
fields:
    idStop:
        id: true
        type: integer
        unsigned: false
        nullable: false
        column: id_stop
        generator:
            strategy: IDENTITY
    name:
        type: string
        length: 45
        fixed: false
        nullable: true
    miejscowosc:
        type: string
        length: 45
        fixed: false
        nullable: true
    latitude:
        type: decimal
        nullable: true
    longitude:
        type: decimal
        nullable: true
oneToMany:
    carrierLineStop:
        targetEntity: Entities\CarrierLineStop
        cascade: {  }
        mappedBy: stop
        inversedBy: null
        joinColumns:
            id_stop:
                referencedColumnName: id_stop
        orphanRemoval: false
lifecycleCallbacks: {  } 
```

我不知道问题出在哪里...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T15:41:13.077

我认为关键字 partial 仅适用于实体字段（如 idCarrierLineStop 和 nextStop），stop 是复合字段。

如果您想像这样离开查询，您应该删除 ManyToOne 映射并添加带有 id_stop 的字段映射，或者在查询中添加带有 Stop 实体的 JOIN 并返回其 id 代替 cls.{stop}

# asp.net - “直接”连接到网站数据库或屏幕抓取

> ID：13533132
> 
> 赞同：1
> 
> 时间：2012-11-23T16:53:59.407
> 
> 标签：asp.net, web, screen-scraping

以下链接 (https://www.misim.gov.il/svinfonadlan2010/) 是一个表格，在填写和提交后，检索有关整个以色列的住房交易信息（它是希伯来语）。我需要以某种方式以编程方式获取数据（无需手动填写论坛）。

我有什么选择？？（请注意，论坛包含验证码）。

PS：我发现一个以色列网站就是这样做的（http://www.hamapa.co.il/）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:44:36.330

你有很多选择。查看 ASP.NET 中的[WebBrowser](http://msdn.microsoft.com/en-us/library/aa752041(v=vs.85).aspx)控件。

导航到页面，您可以通过迭代控件来自动填充页面的控件。

这方面的一个示例是： [使用 Webbrowser 控件在网页中操作/更改/表单填充数据](http://www.vbforums.com/showthread.php?416275-Manipulate-Change-Form-Fill-data-in-webpages-using-the-Webbrowser-control/page2)

然后您可以[自动单击提交按钮](https://stackoverflow.com/questions/1508091/how-do-i-click-an-asp-net-webforms-button-when-the-page-is-hosted-in-a-webbrows)

您必须克服的最大障碍是验证码，除了屏幕抓取之外，我对它的使用知之甚少。

# .net - 匹配正则表达式中的逗号分隔组（模式中没有冗余）

> ID：13533133
> 
> 赞同：2
> 
> 时间：2012-11-23T16:54:05.590
> 
> 标签：.net, regex

我有一个匹配表示 Excel 范围（加上单个单元格）的字符串的正则表达式

```
^[A-Z]+[1-9][0-9]*(:[A-Z]+[1-9][0-9]*)?(,[A-Z]+[1-9][0-9]*(:[A-Z]+[1-9][0-9]*)?)*$ 
```

例如，它匹配如下字符串：

```
C5:H6,J5:P6,R5:DM6,C15 
```

我在问是否有任何方法可以避免模式中的冗余：

`C6`被匹配`[A-Z]+[1-9][0-9]*`但也`H6`被相同的模式匹配。

同样`J6:P6`被匹配的相同模式匹配`C6:H6`。

如果要表达类似*“匹配此模式 1 次，或 * 次但仅在逗号分隔的情况下”之*类的内容。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:01:09.880

要删除源代码中的冗余，您可以将重复的组件存储到字符串变量中，并从字符串中构造正则表达式。

像这样的东西：

```
string cellname = "[A-Z]+[1-9][0-9]*";
string cellrange = cellname + "(:" + cellname + ")?";
Regex pattern = new Regex("^" + cellrange + "(," + cellrange + ")*$") 
```

如果您询问是否有用于分隔符的二进制正则表达式运算符，即您可以编写的东西

```
A op B 
```

意思是

```
A(BA)* 
```

那么恐怕这种事情是不存在的。 **附录**：但是，您可以接近

```
((^|B)A)+$ 
```

这转换为“一个或多个 As 以字符串开头或 B 为前缀”。在这里，您的 B 将是逗号，您的 As 将是范围。然后，您可以在范围内使用相同的技术来用冒号分隔单元格。但是，`(^|,)`您将使用`(xxx|:)`where代替`xxx`单元格的开头。我不确定那会是什么。你能用它吗？

**附录 2**

[http://ideone.com/L3RNER](http://ideone.com/L3RNEr)上的解决方案 ——基于我最后的评论。

```
using System;
using System.Text.RegularExpressions;

public class Test
{
    public static void Main()
    {
        Regex rx = new Regex("^([A-Z]+[1-9][0-9]*(:[A-Z]+[1-9][0-9]*)?($|,(?!$)))*$");
        Console.WriteLine(rx.IsMatch("C5:H6"));
        Console.WriteLine(rx.IsMatch("C5"));
        Console.WriteLine(rx.IsMatch("C5:H6,J5:P6,R5:DM6,C15"));
        Console.WriteLine(rx.IsMatch("C5:H6,J5:P6,R5:DM6,C15,"));
        Console.WriteLine(rx.IsMatch("C5:H6J5:P6,R5:DM6,C15"));
        Console.WriteLine(rx.IsMatch(",C5:H6:J5:P6,R5:DM6,C15"));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:18:12.550

对于任何一系列范围和单个单元格，请使用正则表达式模式

```
(?!,)(?:(?:^|,)[A-Z]+(?!0)[0-9]+(?::[A-Z]+(?!0)[0-9]+)?)+ 
```

或者，如果您只想匹配用逗号分隔的一系列相同范围（或单个单元格），那么

```
^([A-Z]+(?!0)[0-9]+(?::[A-Z]+(?!0)[0-9]+)?)(,\1)* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T20:28:20.380

您可以按如下方式更改正则表达式：

```
^([A-Z]+[1-9][0-9]*(:[A-Z]+[1-9][0-9]*)?(,(?!$)|$))*$ 
```

关键的变化是最后的这个子表达式：

```
(,(?!$)|$) 
```

它匹配一个可选的逗号字符，除非它在匹配的末尾，在这种情况下不能有更多的字符。这可以防止您匹配以逗号结尾的序列。

[这是ideone 上](http://ideone.com/VuKrGQ)的相应演示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:52:32.117

如果您想在一个表达式中测试整个字符串的有效范围，如果您不介意在测试字符串前加上逗号，则可以使用此正则表达式（例如：,C5:H6,J5:P6,R5:DM6, C15):

```
^(?:,[A-Z]+[1-9][0-9]*(?::[A-Z]+[1-9][0-9]*)?)*$ 
```

如果您无法更改测试字符串，则可以改用它：

```
^(?:(?:^|,)[A-Z]+[1-9][0-9]*(?::[A-Z]+[1-9][0-9]*)?)*$ 
```

# sql-server-2008 - SQL PIVOT 表不工作

> ID：13533136
> 
> 赞同：0
> 
> 时间：2012-11-23T16:54:25.020
> 
> 标签：sql-server-2008, pivot

我正在尝试按如下方式创建数据透视表

```
SELECT AttributeDataID, [0],[1],[10],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],[167],[168],[169],[170],[171],[172],[173],[174],[175],[176],[177],[178],[179],[180],[181],[182],[183],[184],[185],[186],[187],[188],[189],[190],[191],[192],[193],[194],[195],[196],[197],[198],[199],[2],[200],[202],[203],[204],[205],[206],[207],[208],[209],[211],[212],[213],[214],[215],[216],[217],[218],[219],[220],[221],[222],[223],[224],[225],[226],[227],[228],[229],[230],[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],[242],[243],[244],[245],[246],[247],[248],[250],[251],[252],[3],[4],[43],[44],[5],[6],[7],[8],[85],[86],[9]
FROM (SELECT t2.AttributeDataID, t1.AttributeName, t2.DataValue 
      FROM AttributeDefinitions As t1 JOIN AttributeDatum AS t2 ON t1.AttributeDefinitionId = t2.AttributeDefinitionRef) 
p PIVOT (max(t2.DataValue) FOR t1.AttributeName IN 
     ([0],[1],[10],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],[167],[168],[169],[170],[171],[172],[173],[174],[175],[176],[177],[178],[179],[180],[181],[182],[183],[184],[185],[186],[187],[188],[189],[190],[191],[192],[193],[194],[195],[196],[197],[198],[199],[2],[200],[202],[203],[204],[205],[206],[207],[208],[209],[211],[212],[213],[214],[215],[216],[217],[218],[219],[220],[221],[222],[223],[224],[225],[226],[227],[228],[229],[230],[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],[242],[243],[244],[245],[246],[247],[248],[250],[251],[252],[3],[4],[43],[44],[5],[6],[7],[8],[85],[86],[9]) 
      AS pvt ORDER BY AttributeDataID; 
```

但是正在返回以下消息。有人可以帮忙吗？

```
Msg 156, Level 15, State 1, Line 6
Incorrect syntax near the keyword 'AS'. 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:25:16.327

您不能在以下内容中使用内部查询中的别名`PIVOT`：

```
SELECT AttributeDataID, [0],[1],[10],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],[167],[168],[169],[170],[171],[172],[173],[174],[175],[176],[177],[178],[179],[180],[181],[182],[183],[184],[185],[186],[187],[188],[189],[190],[191],[192],[193],[194],[195],[196],[197],[198],[199],[2],[200],[202],[203],[204],[205],[206],[207],[208],[209],[211],[212],[213],[214],[215],[216],[217],[218],[219],[220],[221],[222],[223],[224],[225],[226],[227],[228],[229],[230],[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],[242],[243],[244],[245],[246],[247],[248],[250],[251],[252],[3],[4],[43],[44],[5],[6],[7],[8],[85],[86],[9]
FROM 
(
  SELECT t2.AttributeDataID, t1.AttributeName, t2.DataValue 
  FROM AttributeDefinitions As t1 
  JOIN AttributeDatum AS t2 
    ON t1.AttributeDefinitionId = t2.AttributeDefinitionRef
)p 
PIVOT 
(
  max(DataValue) -- < no inner query alias here
  FOR AttributeName IN  -- < no inner query alias here
     ([0],[1],[10],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],[167],[168],[169],[170],[171],[172],[173],[174],[175],[176],[177],[178],[179],[180],[181],[182],[183],[184],[185],[186],[187],[188],[189],[190],[191],[192],[193],[194],[195],[196],[197],[198],[199],[2],[200],[202],[203],[204],[205],[206],[207],[208],[209],[211],[212],[213],[214],[215],[216],[217],[218],[219],[220],[221],[222],[223],[224],[225],[226],[227],[228],[229],[230],[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],[242],[243],[244],[245],[246],[247],[248],[250],[251],[252],[3],[4],[43],[44],[5],[6],[7],[8],[85],[86],[9]) 
) AS pvt 
ORDER BY AttributeDataID; 
```

只是为了说清楚：您*可以*在引用的列前`PIVOT`加上表别名。只是在你的情况下它只能是`p`别名，即

```
…
max(p.DataValue)
FOR p.AttributeName IN
… 
```

因为被旋转的`PIVOT`列对于`p`subselect 的列而不是`t1`or的列是已知的`t2`。

# objective-c - 将 PDF 转换为 Keynote - iOS

> ID：13533137
> 
> 赞同：0
> 
> 时间：2012-11-23T16:54:34.637
> 
> 标签：objective-c, ios, keynote

是否可以将 PDF 中的每个页面转换为单独的图像，然后将这些图像添加到 Apple Keynote 文件中的单独幻灯片中，所有这些都使用 Objective-C 和 iOS？在那之后，如果可能的话 - 我需要再次在 iOS 上将该主题演讲文件导入到主题演讲中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:00:35.853

使用 core-graphics pdf api 进行一些基本操作应该可以为您`UIImage`提供每个页面的 s。对于 Keynote 部分，您可能需要做更多的挖掘工作。

# c# - 无法计算所有者绘制文本中的位置

> ID：13533140
> 
> 赞同：7
> 
> 时间：2012-11-23T16:54:42.047
> 
> 标签：c#, winforms, winapi, gdi+, gdi

我正在尝试使用 Visual Studio 2012 创建一个 Windows 窗体应用程序，该应用程序可以将插入符号放置在所有者绘制的字符串中的当前位置。但是，我一直无法找到准确计算该位置的方法。

[我以前在 C++ 中成功地做到了这一点](http://www.blackbeltcoder.com/Articles/controls/mfc-hex-editor-control)。我在 C# 中尝试了许多方法，但还不能准确定位插入符号。最初，我尝试使用 .NET 类来确定正确的位置，但后来我尝试直接访问 Windows API。在某些情况下，我接近了，但一段时间后我仍然无法准确地放置插入符号。

我创建了一个小型测试程序并在下面发布了关键部分。我还在[这里](http://www.softcircuits.com/Client/TestFont.zip)发布了整个项目。

使用的确切字体对我来说并不重要；但是，我的应用程序采用等距字体。任何帮助表示赞赏。

**Form1.cs** 这是我的主要表格。

```
public partial class Form1 : Form
{
    private string TestString;
    private int AveCharWidth;
    private int Position;

    public Form1()
    {
        InitializeComponent();
        TestString = "123456789012345678901234567890123456789012345678901234567890";
        AveCharWidth = GetFontWidth();
        Position = 0;
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        Font = new Font(FontFamily.GenericMonospace, 12, FontStyle.Regular, GraphicsUnit.Pixel);
    }

    protected override void OnGotFocus(EventArgs e)
    {
        Windows.CreateCaret(Handle, (IntPtr)0, 2, (int)Font.Height);
        Windows.ShowCaret(Handle);
        UpdateCaretPosition();
        base.OnGotFocus(e);
    }

    protected void UpdateCaretPosition()
    {
        Windows.SetCaretPos(Padding.Left + (Position * AveCharWidth), Padding.Top);
    }

    protected override void OnLostFocus(EventArgs e)
    {
        Windows.HideCaret(Handle);
        Windows.DestroyCaret();
        base.OnLostFocus(e);
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        e.Graphics.DrawString(TestString, Font, SystemBrushes.WindowText,
            new PointF(Padding.Left, Padding.Top));
    }

    protected override bool IsInputKey(Keys keyData)
    {
        switch (keyData)
        {
            case Keys.Right:
            case Keys.Left:
                return true;
        }
        return base.IsInputKey(keyData);
    }

    protected override void OnKeyDown(KeyEventArgs e)
    {
        switch (e.KeyCode)
        {
            case Keys.Left:
                Position = Math.Max(Position - 1, 0);
                UpdateCaretPosition();
                break;
            case Keys.Right:
                Position = Math.Min(Position + 1, TestString.Length);
                UpdateCaretPosition();
                break;
        }
        base.OnKeyDown(e);
    }

    protected int GetFontWidth()
    {
        int AverageCharWidth = 0;

        using (var graphics = this.CreateGraphics())
        {
            try
            {
                Windows.TEXTMETRIC tm;
                var hdc = graphics.GetHdc();
                IntPtr hFont = this.Font.ToHfont();
                IntPtr hOldFont = Windows.SelectObject(hdc, hFont);
                var a = Windows.GetTextMetrics(hdc, out tm);
                var b = Windows.SelectObject(hdc, hOldFont);
                var c = Windows.DeleteObject(hFont);
                AverageCharWidth = tm.tmAveCharWidth;
            }
            catch
            {
            }
            finally
            {
                graphics.ReleaseHdc();
            }
        }
        return AverageCharWidth;
    }
} 
```

**Windows.cs** 这是我的 Windows API 声明。

```
public static class Windows
{
    [Serializable, StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct TEXTMETRIC
    {
        public int tmHeight;
        public int tmAscent;
        public int tmDescent;
        public int tmInternalLeading;
        public int tmExternalLeading;
        public int tmAveCharWidth;
        public int tmMaxCharWidth;
        public int tmWeight;
        public int tmOverhang;
        public int tmDigitizedAspectX;
        public int tmDigitizedAspectY;
        public short tmFirstChar;
        public short tmLastChar;
        public short tmDefaultChar;
        public short tmBreakChar;
        public byte tmItalic;
        public byte tmUnderlined;
        public byte tmStruckOut;
        public byte tmPitchAndFamily;
        public byte tmCharSet;
    }

    [DllImport("user32.dll")]
    public static extern bool CreateCaret(IntPtr hWnd, IntPtr hBitmap, int nWidth, int nHeight);
    [DllImport("User32.dll")]
    public static extern bool SetCaretPos(int x, int y);
    [DllImport("User32.dll")]
    public static extern bool DestroyCaret();
    [DllImport("User32.dll")]
    public static extern bool ShowCaret(IntPtr hWnd);
    [DllImport("User32.dll")]
    public static extern bool HideCaret(IntPtr hWnd);
    [DllImport("gdi32.dll", CharSet = CharSet.Auto)]
    public static extern bool GetTextMetrics(IntPtr hdc, out TEXTMETRIC lptm);
    [DllImport("gdi32.dll")]
    public static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);
    [DllImport("GDI32.dll")]
    public static extern bool DeleteObject(IntPtr hObject);
} 
```

**编辑**

我发布的代码有一个问题，使它更加不准确。这是尝试了许多不同方法的结果，有些方法比这更准确。我正在寻找的是使它“完全准确”的修复程序，就像我[在 C++ 中的 MFC Hex Editor Control 中](http://www.blackbeltcoder.com/Articles/controls/mfc-hex-editor-control)一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:11:07.870

您可以使用`System.Windows.Forms.TextRenderer`to 来绘制字符串以及计算其指标。两种操作都存在各种方法重载

```
TextRenderer.DrawText(e.Graphics, "abc", font, point, Color.Black);
Size measure = TextRenderer.MeasureText(e.Graphics, "1234567890", font); 
```

`TextRenderer`我在它的准确性方面取得了很好的经验。

* * *

**更新**

我在我的一个应用程序中确定了这样的字体大小，它运行良好

```
const TextFormatFlags textFormatFlags =
    TextFormatFlags.NoPadding | TextFormatFlags.NoPrefix | 
    TextFormatFlags.PreserveGraphicsClipping;

fontSize = TextRenderer.MeasureText(this.g, "_", font, 
                                    new Size(short.MaxValue, short.MaxValue),
                                    textFormatFlags);
height = fontSize.Height;
width = fontSize.Width; 
```

确保对绘图和测量使用相同的格式标志。

[（这种确定原因字体大小的方法仅适用于等宽字体。）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T18:31:03.943

我试过你的`GetFontWidth()`，返回的字符宽度是**7**。
然后我尝试了`TextRenderer.MearureText`不同长度的文本，长度为 1 到 50 的文本的值分别从**14**到**7.14**不等，平均字符宽度为**7.62988874736612**。

这是我使用的代码：

```
var text = "";
var sizes = new System.Collections.Generic.List<double>();
for (int i = 1; i <= 50; i++)
{
    text += (i % 10).ToString();
    var ts = TextRenderer.MeasureText(text, this.Font);
    sizes.Add((ts.Width * 1.0) / text.Length);

}
sizes.Add(sizes.Average());
Clipboard.SetText(string.Join("\r\n",sizes)); 
```

对我的小“实验”的结果不满意，我决定看看文本是如何呈现到表单上的。下面是表格的屏幕截图（放大 8 倍）。

[![放大字体测量](../Images/e8c1b2d027482f63abffc721f068b54b.png "点击查看完整尺寸")](https://i.stack.imgur.com/BPb6F.png "点击查看完整尺寸")

经过仔细检查，我发现

1.  人物之间有一定的隔阂。这使得文本块 ( `1234567890`) 的长度为**74**像素长。
2.  即使左侧填充为 0，在正在绘制的文本前面仍有一些空间 (3px)。

### 这对你意味着什么？

*   如果您使用代码计算字体字符的宽度，则无法考虑两个字符之间的分隔空间。
*   使用`TextRenderer.DrawText`can 会给你不同的字符宽度，使它变得毫无用处。

### 你剩下的选择是什么？

*   我能从中看出的最好方法是对文本的位置进行硬编码。这样您就可以知道每个字符的位置，并且可以将光标准确地放置在任何所需的位置。
    不用说，这可能需要大量代码。
*   您的第二个选择是像我一样运行测试以查找文本块的长度，然后除以块的长度以找到平均字符宽度。
    这样做的问题是您的代码不太可能正确扩展。例如，改变字体的大小或用户的屏幕 DPI 会给程序带来很多麻烦。

### 我观察到的其他事情

*   在文本前面插入的空间等于插入符号的宽度（在我的例子中是*2px*）加上 1px（总共 3px）。
*   将每个字符的宽度硬编码为 7.4 效果很好。

# c++ - c ++通过参数将值传递给char数组

> ID：13533142
> 
> 赞同：1
> 
> 时间：2012-11-23T16:54:46.753
> 
> 标签：c++, arrays

```
class Link{       
   char name[];
   Link *next;
};

Link::Link(char pname[]){       
   next=NULL;
   name[]=pname;    
}; 
```

在类中`pname`创建对象时如何分配我传递的值（ ） ？`name[]``Link`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:05:23.820

通常，您将用于`std::string`存储字符串：

```
class Link{       
   std::string name;
   Link *next;
};

Link::Link(char const pname[]) : next(NULL), name(pname) {} 
```

如果您有充分的理由嵌入字符数组而不是让标准字符串类为您处理内存分配，那么您将需要类似的东西：

```
class Link{       
   char name[I_HOPE_THIS_IS_BIG_ENOUGH];
   Link *next;
};

Link::Link(char const pname[]) : next(NULL) {
    name[sizeof name - 1] = 0;
    std::strncpy(name, pname, sizeof name);
    if (name[sizeof name - 1] != 0) {
        throw std::runtime_error("Whoops! My buffer was too small.");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:05:54.647

首先，您不能将 a`char name[]`作为类的成员。类型必须完整，即必须明确指定严格的固定数组大小

```
class Link {       
   char name[100];
   Link *next;
}; 
```

其次，原始数组不能被分配或复制初始化。要将数据从一个通用数组复制到另一个，您可以使用库函数

```
Link::Link(const char pname[]) : next(NULL) {       
   std::copy(pname, pname + 100, name);
   // Assuming `pname` also points to an array of 100 chars
} 
```

或者，如果我们正在处理一个以零结尾的字符数组（又名 C 字符串）

```
Link::Link(const char pname[]) : next(NULL) {       
   assert(std::strlen(pname) < 100);
   std::strcpy(name, pname);
} 
```

第三，也是最重要的，在许多情况下，正确的解决方案将取决于阵列的性质。你`name`的情况是什么？您在问题中没有提供任何信息。是不是字符串？`std::string`如果它应该是一个字符串，那么使用class 而不是原始 char 数组可能会好得多。即使你需要一个数组（不是字符串），你最好还是使用`std::vector`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:05:00.883

我建议这个解决方案：

```
class Link {
Link(char* pname )  {
     name=pname;
}
char* name;
Link *next;
}; 
```

# asp.net - Membership.UpdateUser(user) 不会同时更新密码和其他选项

> ID：13533143
> 
> 赞同：0
> 
> 时间：2012-11-23T16:54:50.080
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

伙计们，我这里有一些逻辑问题。

如果我使用任何其他设置设置 IsApproved true/false，它的值会在数据库中更新。

尽管如此，当我设置新密码时，我正在更改的所有其他设置都不会在服务器中更新。

你可以帮帮我吗：

*控制器*

```
public ActionResult EditUser(EditModel model)
    {
        if (ModelState.IsValid)
        {

            try
            {
                MembershipUser user = Membership.GetUser(model.UserName);

                user.IsApproved = bool.Parse(Request.Form.GetValues("IsApproved")[0]);

                if (model.PasswordAccount != null)
                    user.ChangePassword(model.PasswordAccount, model.NewPassword);

                if (model.PasswordQuestion != null)
                    user.ChangePasswordQuestionAndAnswer(model.CurrentPass, model.PasswordQuestion, model.PasswordAnwser);   

                if (model.Email != null)
                {
                    bool emailExist = CheckEmail(model.Email);
                    if (emailExist == false)
                    {
                        user.Email = model.Email;
                    }
                }

                Membership.UpdateUser(user);

                return Content("Usuário Atualizado com Sucesso!");

            }
            catch (Exception e)
            {
                return Content("Usuário não atualizado - Erro: " + e);
            }

        }
        else
        {
            return Content("Model Inválido");
        }

    } 
```

我没有收到错误并通过调试检查我没有收到错误...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:14:13.257

我很确定这不是最好的方法，但它正在工作，直到我找到更好的解决方案，这是有效的：

```
try
            {
                MembershipUser user = Membership.GetUser(model.UserName);

                user.IsApproved = bool.Parse(Request.Form.GetValues("IsApproved")[0]);

                if (model.Email != null)
                {
                    bool emailExist = CheckEmail(model.Email);
                    if (emailExist == false)
                    {
                        user.Email = model.Email;
                    }
                }

                Membership.UpdateUser(user);

                user = Membership.GetUser(model.UserName);

                if (model.PasswordAccount != null)
                    user.ChangePassword(model.PasswordAccount, model.NewPassword);

                if (model.PasswordQuestion != null)
                    user.ChangePasswordQuestionAndAnswer(model.CurrentPass, model.PasswordQuestion, model.PasswordAnwser);

                Membership.UpdateUser(user);

                return Content("Usuário Atualizado com Sucesso!");

            } 
```

# c - (stuct sockadrr*)&servaddr 是什么意思？

> ID：13533145
> 
> 赞同：2
> 
> 时间：2012-11-23T16:55:00.760
> 
> 标签：c, sockets

我遇到过这段代码：

```
(stuct sockadrr*)&servaddr 
```

这意味着什么？您以某种方式将结构转换为`servaddr`?

我只是想弄清楚这段代码的语法和它在 C 中的含义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T16:56:21.923

> You cast the struct somehow to servaddr?

No, the other way round, you cast the address of `servaddr` to a pointer to `struct sockaddr`.

If `servaddr` has type `foo`, `&servaddr` is a `foo*`, a pointer to `foo`. If you call a function that expects a pointer to `struct sockaddr`, you need to cast it - if the types are compatible, so that passing a `foo*` as a `struct sockaddr*` works.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T16:57:57.100

Various socket functions are declared to take as a parameter a generic network address, you cast the address of a specific network address struct (e.g. `sockaddr_in`) in order to pass it as a parameter to the function.

# java - JPA 中谓词的表达式解析器

> ID：13533146
> 
> 赞同：4
> 
> 时间：2012-11-23T16:55:05.930
> 
> 标签：java, hibernate, parsing, jpa, boolean-expression

在基于命令行的应用程序中，我想为过滤数据库结果提供基本支持。为此，我需要解析用户输入。我想支持这些令牌：

*   布尔（逻辑）运算符，包括、`and`和括号`or``not`
*   变量、字符串、日期和数字
*   比较运算符：`=`, `!=`, `<`, `>`, `>=`,`<=`

所以输入字符串可能如下所示：

*(age > 3 or name != 'tom') and city='london' and ((birthday=01.01.2010 orbirthday >= 01.01.2013))*

基本的东西。

**问题**：我在哪里可以获得（标记器和）解析器？

*   是否已经有支持这些基础知识的库？
*   如果没有，我知道有一些工具可以为 Tokenizers 和 Parsers 生成 Java 类。你有什么建议？

然后我会将结果转换为 JPA`Predicate`的`CriteriaQuery`. 首先我想，我可以在命令行中提供 JPQL，让用户指定基于 SQL 的限制。但我不想让用户编写可能停止工作的条件，例如当数据库架构更改时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-10-29T12:41:06.090

您正在寻找一些分词器和解析器。

ANTLR 是一个词法分析器/解析器生成器，并且是一个巨大的语法存储库，其中还包含 SQL——甚至在[https://github.com/antlr/grammars-v4/tree/master/sql](https://github.com/antlr/grammars-v4/tree/master/sql)上包含一些常见数据库的方言。

因此，如果您仍然有这个问题，您可以免费生成解析器，只需关心将抽象语法树转换为 JPA 标准调用。

# grid - How to force delays on starting each thread while using Grid?

> ID：13533149
> 
> 赞同：0
> 
> 时间：2012-11-23T16:55:19.257
> 
> 标签：grid, pom.xml, timedelay

I try to run in paralel TestSuites using Grid. This is part of my pom.xml. How can I force 2sec delays between threads startings? Here are 4 threads max and only 3 Suites to run, so all 3 of them are started at the same time. After starting node with:

```
java -jar selenium-server-standalone-2.25.0.jar -role webdriver -hub
http://localhost:4444/grid/register -port 5556 -browser
browserName=chrome,version=23,platform=WINDOWS,maxInstances=4 
```

it causes 2 of 3 instances conflict in app due to some known reasons. It is required at least 2 sec diff in thread strating time. How can it be done?

```
<plugins>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.1</version>
        <configuration>
            <source>1.6</source>
            <target>1.6</target>
        </configuration>
    </plugin>
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.12</version>
        <configuration>
            <skipTests>true</skipTests>
        </configuration>
    </plugin>
    <plugin>              
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-failsafe-plugin</artifactId>
        <version>2.12.4</version>
        <executions>         
            <execution>
                <id>integration-test-chrome</id>
                <phase>integration-test</phase>
                <goals>
                    <goal>integration-test</goal>
                </goals>    
            </execution>          
        </executions>
        <configuration>
            <forkMode>perthread</forkMode>
            <threadCount>4</threadCount>
            <includes>
                <include>**/HomeSuiteWithoutFailedTests.java</include>
                <include>**/QuotaSuiteWithoutFailedTests.java</include>
                <include>**/SpywareSuiteWithoutFailedTests.java</include>
            </includes>
            <systemPropertyVariables>
                <browser>${browser}</browser>
            </systemPropertyVariables>
        </configuration>    
    </plugin>
</plugins> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:15:34.340

解决了在套件驱动程序初始化之前添加随机睡眠的问题。

# css - How can I get overlapping divs with relative positions?

> ID：13533153
> 
> 赞同：37
> 
> 时间：2012-11-23T16:55:26.713
> 
> 标签：css, html, layer, css-position

I want a few divs to be positioned in a line next to each other, but also allow them to overlap the previous div.

What I'm trying to get is a timeline with divs for events of certain length. The events can overlap each other.

My idea was to give each div the same top position, an increasing z-index and an increasing left position (according to the time of the event). Later I would pop individual divs out by mouse-over events to visualise the overlap.

What I do is to make it so each div gets placed under the next one. With fiddling of the top attribute I can get them to align horizontally, but I don't see the pattern.

```
 <div class="day">
         <div style="top: 35px; left: 200px; background-color: red; height: 50px; width:24px; z-index: 1; position: relative;"> </div>
         <div style="top: 35px; left: 220px; background-color: green; height: 50px; width:24px; z-index: 2; position: relative;"> </div>
         <div style="top: 35px; left: 225px; background-color: blue; height: 50px; width:48px; z-index: 3; position: relative;"> </div>
 </div> 
```

If I use absolute positions, the elements fly out of the surrounding div and are positioned absolutely at some place in the page.

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2014-04-04T09:07:54.843

这很简单。**使用绝对定位**制作一个内部 div，但用一个使用**相对定位的 div****包裹**：

 **```
<div id="container" style="position: relative;width:200px;height:100px;top:100px;background:yellow">
    <div id="innerdiv1" style="z-index: 1; position:absolute; width: 100px;height:20px;background:red;">a</div>
    <div id="innerdiv2" style="z-index: 2; position:absolute; width: 100px;height:20px;background:blue;left:10px;top:10px;"></div>
</div> 
```

您可以使用其他方法，例如负边距，但如果您想动态更改 HTML，不建议这样做。例如，如果你想移动内部 div(s) 的位置，只需设置容器的 top/left/right/bottom CSS 属性或使用 JavaScript（jQuery 或其他）修改属性。

它将使您的代码保持干净和可读。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-11-23T16:56:32.617

### Use Negative Margins!

```
<div class="day">
    <div style="top: 35px;left: 200px; background-color: red; height: 50px; width:24px; z-index: 1; position: relative; margin-top: -15px;"> </div>
    <div style="top: 35px;left: 220px; background-color: green; height: 50px; width:24px; z-index: 2; position: relative; margin-top: -15px;"> </div>
    <div style="top: 35px;left: 225px; background-color: blue; height: 50px; width:48px; z-index: 3; position: relative; margin-top: -15px;"> </div>
</div> 
```

### Fiddle: [http://jsfiddle.net/vZv5k/](http://jsfiddle.net/vZv5k/)

* * *

### Another Solution:

Give the `.day` class a `width`, `height`, and `position` it `relative`ly, keeping the inner `div`s `absolute`ly `position`ed.

Check out the below **CSS**:

```
.day {position: relative; width: 500px; height: 500px;} 
```

And the **HTML**:

```
<div class="day">
    <div style="top: 35px;left: 200px; background-color: red; height: 50px; width:24px; z-index: 1;"> </div>
    <div style="top: 35px;left: 220px; background-color: green; height: 50px; width:24px; z-index: 2;"> </div>
    <div style="top: 35px;left: 225px; background-color: blue; height: 50px; width:48px; z-index: 3;"> </div>
</div> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-23T17:09:42.070

我找到了解决方案。对于任何了解 CSS 的人来说，这可能是非常明显的。

我以为我不能使用绝对定位，因为我的元素会飞出周围的 div。

原来，我误解了绝对定位。它与固定不一样，但对我来说它看起来像那样。

[https://developer.mozilla.org/en-US/docs/CSS/position](https://developer.mozilla.org/en-US/docs/CSS/position)解释得很好。

绝对定位位置绝对到下一个周围的锚点。如果没有定义其他锚，则默认为整个页面。要使某物成为锚点，它需要定位：相对；

**快速解决方案**

添加*位置：相对；*到当天的课程并在内部 div 中使用绝对定位。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-01-20T15:03:36.563

使用该`top`属性，您还可以移动相对定位的对象。在我的代码示例中，红色框与绿色框重叠，因为它是`z-index`. 如果删除`z-index`，则绿色框位于顶部。

**HTML：**

```
<div class="wrapper">
  <div class="box one"></div>
  <div class="box two"></div>
</div> 
```

**CSS：**

```
.wrapper {
  width: 50px;
  height: 50px;
  overflow: hidden;
}

 .box {
  width: 100%;
  height: 100%;
  position: relative;
}

 .box.one {
  background-color: red; 
  z-index: 2;
  top: 0px;
}

 .box.two {
  background-color: green; 
  z-index: 1;
  top: -50px;
} 
```**

# java - how to view .class files in a rt.jar file in jdk1.6 software

> ID：13533154
> 
> 赞同：2
> 
> 时间：2012-11-23T16:55:35.653
> 
> 标签：java

I am looking for a `.class` file present in the `rt.jar` file, but I failed to do it.

I am ready with my Dj decompiler to view the source codes. Please tell me how to open that rt.jar file.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:11:08.147

由于 .jar 文件实际上只是带有另一个扩展名的 ZIP 文件，因此您可以使用 7-Zip 等存档管理器打开 rt.jar 文件，提取感兴趣的类文件并使用 Java 反编译器打开它。我建议[JD-GUI](http://java.decompiler.free.fr/?q=jdgui)。

# python - 获取 Python xml ElementTree 的字符串源

> ID：13533156
> 
> 赞同：10
> 
> 时间：2012-11-23T16:55:48.723
> 
> 标签：python, xml, elementtree

您如何`ElementTree`在 Python 中获取字符串的来源？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T16:58:06.160

```
import xml.etree.ElementTree as ET
tree = ET.parse(source)
root = tree.getroot()
ET.tostring(root) 
```

`source`请注意，和的内容之间可能存在格式差异`ET.tostring(doc)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-07T11:02:01.017

我知道不是，但我想知道为什么不是：

```
tree.tostring(root) 
```

而不是当前的方式：

```
xml.etree.ElementTree.tostring(root) 
```

# haskell - Cabal：由于“无法识别的选项”，提升的 base-0.1.1 不会安装

> ID：13533157
> 
> 赞同：0
> 
> 时间：2012-11-23T16:56:10.907
> 
> 标签：haskell, dependencies, cabal

我正在尝试`hdbc-sqlite`在 Windows 中安装 Cabal。[我从这篇不错的帖子](https://stackoverflow.com/questions/7382334/cabal-install-needs-c-library-windows)中找到了一些帮助，但是`lifted-base-0.1.1`由于无法识别的选项，Sqlite3 的 dll 和 def 文件的安装在一个名为的包上失败`--disable-benchmarks`。

如果可以手动安装，也许我可以通过修改安装程序的源代码并删除这个无法识别的选项，然后手动安装软件包来解决这个问题？还是有不那么繁琐的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:08:32.700

你试过了`cabal update`吗？

我会首先尝试一个更新的版本（[lift-base](http://hackage.haskell.org/package/lifted-base-0.2)），比如`0.1.2`or `0.2`。然后我会手动下载[tar](http://hackage.haskell.org/packages/archive/lifted-base/0.2/lifted-base-0.2.tar.gz)文件并使用它（更改`import`命令中的路径）。

还尝试升级您的 GHC / Haskell 平台，您显然描述了一个[已知问题](https://github.com/basvandijk/lifted-base/issues/8)。

# javascript - Positioning an element relative to another

> ID：13533159
> 
> 赞同：1
> 
> 时间：2012-11-23T16:56:20.423
> 
> 标签：javascript, jquery, html, jquery-plugins

I'm making a plugin that makes a dropdown on an element and use a pre-defined element as the dropdown menu outside the applied element.

The markup looks like this

```
<a href="javascript:void(0)" id="some-menu" data-dropdown="dropdown-element">Click</a>

<ul id="dropdown-element">
    <li><a href="#">First item</a></li>
    <li><a href="#">Second item</a></li>
</ul> 
```

And using `$("#some-menu").dropdown({ placement: 'top' });` will turn `#dropdown-element` to a dropdown. All good and dandy.

`placement` decides on how the dropdown is positioned according to the element *(top, bottom, right, left)* but this should be fairly easy to apply, when I have figured the default positioning out.

I tried using this code from Bootstrap's Tooltip plugin

```
pos = getPosition($element, inside);

actualWidth = $this[0].offsetWidth;
actualHeight = $this[0].offsetHeight;

switch (inside ? placement.split(' ')[1] : placement) {
    case 'bottom':
        tp = {top: pos.top + pos.height, left: pos.left + pos.width / 2 - actualWidth / 2};
    break;
    case 'top':
        tp = {top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2};
    break;
    case 'left':
        tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth};
    break;
    case 'right':
        tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width};
    break;
} 
```

But without luck.

This is what it looks like ![How the dropdown looks like in browser](../Images/7c396b40d505b9d9bbb34192742d695d.png)

And this is the wanted result ![How the dropdown should look like](../Images/093e80bad00f0a54b25068838503351b.png)

I want it horizontally centered to `#some-menu` and the dropdown to be applied to any element, inlines too and keep both the vertical and horizontal positioning.

**Edit:** I found out that the dropdown was created inside a element with `position: relative`, which is why its offset is wrong. My question is now what the best way to move the element into the body (or perhaps a better solution for this) and keep good performance without touching the DOM more than needed.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:15:42.837

这应该把菜单放在中间。

```
top = $('#some-menu').offset().top + 8; //Set the vertical position.

left = $('#some-menu').offset().left - $('#dropdown-element').outerWidth/2 + $('#some-menu').outerWidth/2; //Set the menu to the center of the button.

$('#dropdown-element').offset({top: top, left: left}); 
```

# c# - Is it possible to lock top and left hand navigation in OpenFileDialog box in C#?

> ID：13533168
> 
> 赞同：5
> 
> 时间：2012-11-23T16:57:17.607
> 
> 标签：c#, openfiledialog

![enter image description here](../Images/f80d9a7d8d9ac5a98e4b3abcb1c63b46.png)I am having difficulty in customizing OpenFileDialog box, I want to allow people to select files that are in the same directory from the currently open folders using the OpenFileDialog. I don't want the OpenFileDialog to be able to select stuff outside of the program's current directory

Due to some reason i am not able to post image, what i meant is to lock Top navigation and Side Navigation option in OpenFileDialog box

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T21:47:59.477

据我所知，您只能将元素添加到标准文件对话框（使用一些深奥的 api 调用），但无法删除元素。如果您真的需要此功能，最好的选择是使用您需要的特定业务规则实现您自己的自定义打开文件对话框。

以下是有关如何进行一些有限自定义的一些详细信息。

[http://msdn.microsoft.com/en-us/magazine/cc300434.aspx](http://msdn.microsoft.com/en-us/magazine/cc300434.aspx)

[http://www.codeproject.com/Articles/16276/Customizing-OpenFileDialog-in-NET](http://www.codeproject.com/Articles/16276/Customizing-OpenFileDialog-in-NET)

[自定义 OpenFileDialog](https://stackoverflow.com/questions/6093012/customizing-openfiledialog)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T21:57:04.667

自定义默认对话框可能是困难的方式。

为什么不只显示一个列表框，其中包含您希望用户能够选择的文件的名称？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T21:58:52.043

我不知道如何锁定对话框。但是，如果要求只是提供他们从中选择一个文件的列表。那么为什么不自己阅读文件列表并将它们显示在自定义对话框中以供选择呢？

如果您愿意，您可以花一些时间使对话框看起来像系统之一。

# php - Symfony2 and Marketplace Web Services

> ID：13533173
> 
> 赞同：0
> 
> 时间：2012-11-23T16:57:46.607
> 
> 标签：php, symfony

I created script which uses Amazon Marketplace Web Services and I want to put it inside a controller indexAction() function. However when I do this it says that

```
Class 'MarketplaceWebServiceOrders_Client' not found in path_to_my_bundle 
```

How can I load this class in correct way? Should I place

> amazon-mws-v20090101-php-2012-09-28.*V386158529*
> 
> amazon-mws-v20110101-php-2012-09-28.*V386158559*

folders under vendor folder and register it somehow?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T10:12:15.847

您的包含路径有问题，请在 php.ini 中设置 include_path。或者如果您显示您的代码，那么我们可以帮助您找出问题所在。

# http - DNS：如何将域重定向到不同域的子域？

> ID：13533176
> 
> 赞同：0
> 
> 时间：2012-11-23T16:57:59.017
> 
> 标签：http, redirect, dns, subdomain

我想`subdomain.example.com`用作`example2.com`. 那可能吗？

现在我有这个，但它不工作：

```
 --------------------------------------------------------
   hostname                | priority | value        | ttl
   --------------------------------------------------------
   subdomain.example.com   | A        | ip_address   | 3600
   subdomain               | CNAME    | example.com  | 3600
   -------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:00:05.700

是的。使其指向 DNS 中的相同 IP，并将主机名添加到 Web 服务器配置中。

# java - java library to run shell commands on multiple remote machines simultaneously

> ID：13533179
> 
> 赞同：0
> 
> 时间：2012-11-23T16:58:04.580
> 
> 标签：java, shell, remote-server

For example, I have instantiated 3 virtual machines in Amazon EC2-- I have also uploaded 3 different shell scripts to each of those machines... Now, I want to execute each of those 3 scripts... I know that each script will take some time to complete, so I want to start all 3 scripts together, and then wait for each of them to be complete...How do I do this? Is there a way to do this without using threads?

# android - Android HTML5 Video offline caching

> ID：13533184
> 
> 赞同：2
> 
> 时间：2012-11-23T16:58:29.180
> 
> 标签：android, html, html5-video

I've an android app already developed.

The android app is essentially a wrapper around a HTML5 web app.

We use HTML5 offline caching to provide the ability to play when disconnected from the internet.

Chrome/Firefox on the desktop will cache the video and images however Android devices appear to selectively ignore video in the cache manifest which prevents the video from being stored locally on the device.

It's understandable that Android would ignore caching video to keep the storage use to a minimum on mobile devices but we need a way around this.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-26T16:35:47.063

在我偶然发现一个答案后偶然发现了这个问题 - 所以我想我会帮忙！

我正在尝试为 Android/iOS 做类似的事情，据我所知，appcache 在移动设备上非常受限制（Android 取决于可用的磁盘空间和使用的浏览器，而在 iOS 上我没有运气50mb 以上）。

我建议使用诸如[PhoneGap](http://phonegap.com/)或[Chrome 应用程序](https://github.com/MobileChromeApps/mobile-chrome-apps)之类的框架——它们通过与设备的本机文件 API 通信来提供其他形式的本地存储。

# javascript - jQuery 自定义垂直下拉菜单

> ID：13533186
> 
> 赞同：0
> 
> 时间：2012-11-23T16:58:37.800
> 
> 标签：javascript, jquery, html, css, drop-down-menu

我的下拉菜单中有问题（这是我的小提琴：http: [//jsfiddle.net/iamthestig/Vhs2v/](http://jsfiddle.net/iamthestig/Vhs2v/)）。当您单击产品时，左侧会出现一个下拉菜单，但底部的其他导航元素也会向下滑动。有没有办法阻止这种情况发生？我已经阅读了几个小时的下拉菜单教程。这就是为什么我有这个代码。但我无法实现我想要发生的事情。希望你们能帮帮我。谢谢！

这是我的代码：

HTML

```
<body>
<nav>
     <ul class="nav">
         <li><a href="#">Home</a></li>
         <li class="products">
             <a href="#">Products</a>
                 <ul class="subnav-products clearfix">
                     <li><a href="#">Product One</a></li>
                     <li><a href="#">Product Two</a></li>
                     <li><a href="#">Product Three</a></li>
                     <li><a href="#">Product Four</a></li>
                     <li><a href="#">Product Five</a></li>
                     <li><a href="#">Product Six</a></li>
                 </ul>
         </li>
         <li><a href="#">Services</a></li>
         <li><a href="#">About Us</a></li>
         <li><a href="#">Contact Us</a></li>
    </ul>             
</nav> 
```

​</p>

CSS

```
 * {
    margin: 0;
    padding: 0;
}

body {
    width: 100%;
    height: 100%;
    background: darkgray;
}

.nav {
    width: 100px;
    position: absolute;
    top: 30px;
    right: 20px;
    list-style: none;
}

.nav li {
    margin: 0 0 10px 0;
    font-family: Helvetica;
    font-size: 11px;
    text-align: right;
    text-transform: uppercase;
    line-height: 1;
}

.nav li:nth-child(5) {
    margin: 0;
}

.nav li a {
    padding: 10px 10px 10px 0;
    color: white;
    text-decoration: none;
    background: dimgray;
    display: block;
}

.subnav-products {
    width: 300px;
    position: relative;
    top: -31px;
    left: -300px;
    display: none;
}
.subnav-products li {
    width: 150px;
    margin: 0;
    text-align: center;
    float: left;
}

.subnav-products li a {
    display:block;
}

.clearfix:before,
.clearfix:after {
    content: " "; /* 1 */
    display: table; /* 2 */
}

.clearfix:after {
    clear: both;
}​ 
```

JS/JQUERY

```
$(".products").on("click", function(){
    $(".subnav-products").slideToggle();
    $(this).toggleClass("active");
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:11:58.700

我给了`a`元素相对定位，然后给了`.subnav`元素绝对定位。在稍微弄乱了位置之后，这就是我想出的……

[http://jsfiddle.net/Vhs2v/2/](http://jsfiddle.net/Vhs2v/2/)

**CSS**

```
.nav li a {
    padding: 10px 10px 10px 0;
    color: white;
    text-decoration: none;
    background: dimgray;
    display: block;
    position: relative;
}
.subnav-products {
    width: 300px;
    position: absolute;
    top: 41px;
    left: -300px;
    display: none;
} 
```

# ruby - 如何在Ruby中删除数组的末尾

> ID：13533189
> 
> 赞同：8
> 
> 时间：2012-11-23T16:58:42.853
> 
> 标签：ruby, arrays, iterator

[Array#drop](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-drop)删除数组的前*n 个*元素。删除数组的最后*m*个元素的好方法是什么？或者，保留数组中间元素（大于*n*，小于*m*）的好方法是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-23T17:16:31.110

这正是[`Array#pop`](http://ruby-doc.org/core-1.9.3/Array.html#method-i-pop)为了：

```
x = [1,2,3]
x.pop(2) # => [2,3]
x # => [1] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-23T17:08:57.360

您还可以使用 Array#slice 方法，例如：

```
[1,2,3,4,5,6].slice(1..4) # => [2, 3, 4, 5] 
```

或者

```
a = [1,2,3,4,5,6]
a.take 3 # => [1, 2, 3]
a.first 3 # => [1, 2, 3]
a.first a.size - 1 # to get rid of the last one 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T17:11:11.430

`drop`与（删除前 n 个元素）最直接相反的是`take`，它保留前 n 个元素（还有`take_while`类似于`drop_while`）。

Slice 允许您通过指定范围或偏移量和长度来返回数组的子集。当传递一个范围作为参数或传递 2 个数字时，Array#[] 的行为相同

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T17:06:05.410

这将摆脱最后 n 个元素：

```
a = [1,2,3,4,5,6]
n = 4
p a[0, (a.size-n)]

#=> [1, 2]

n = 2
p a[0, (a.size-n)]
#=> [1, 2, 3, 4] 
```

关于“中间”元素：

```
min, max = 2, 5
p a.select {|v| (min..max).include? v }
#=> [2, 3, 4, 5] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-11T05:52:27.160

我希望返回值是没有删除元素的数组。我在这里找到了几个解决方案没问题：

```
count = 2
[1, 2, 3, 4, 5].slice 0..-(count + 1) # => [1, 2, 3]
[1, 2, 3, 4, 5].tap { |a| a.pop count } # => [1, 2, 3] 
```

但是如果数组的顺序不重要（在我的情况下我正在删除文件），我发现另一种解决方案更具可读性：

```
count = 2
[1, 2, 3, 4, 5].reverse.drop count # => [3, 2, 1] 
```

`.reverse`如果您需要保持秩序，您可以在那里添加另一个，但我认为我更喜欢`tap`那个时候的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-25T13:52:43.810

您可以以非破坏性方式实现相同`Array#pop`的效果，而无需知道数组的长度：

```
a = [1, 2, 3, 4, 5, 6]
b = a[0..-2]
# => [1, 2, 3, 4, 5]
n = 3 # if we want drop the last n elements
c = a[0..-(n+1)]
# => [1, 2, 3] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-14T08:06:01.317

Array#delete_at() 是删除数组最后一个元素的最简单方法，如下所示

```
arr = [1,2,3,4,5,6]
arr.delete_at(-1) # => [1,2,3,4,5] 
```

要删除数组的一个或多个段，请使用其他答案中的方法。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-11-23T17:12:27.757

还可以添加一些方法

```
class Array

  # Using slice
  def cut(n)
    slice(0..-n-1)
  end

  # Using pop
  def cut2(n)
    dup.tap{|x| x.pop(n)}
  end

  # Using take
  def cut3(n)
    length - n >=0 ? take(length - n) : []
  end

end

[1,2,3,4,5].cut(2)
 => [1, 2, 3] 
```

# iphone - 如何让这个图像选择器在 iPad 上工作？

> ID：13533200
> 
> 赞同：1
> 
> 时间：2012-11-23T16:59:28.300
> 
> 标签：iphone, objective-c, ios, xcode

我需要帮助才能让这段代码在 iPad 上运行，它在 iPhone 上运行良好，但无论什么原因都不是 iPad。我不知道该怎么做才能让这个图像选择器在 iPad 上运行。任何帮助将不胜感激。

```
 -(IBAction)getCameraPicture:(id)sender
    {
UIImagePickerController *picker = [[UIImagePickerController alloc] init];
picker.delegate = self;
picker.allowsImageEditing = YES;
picker.sourceType = (sender == takePictureButton) ?    UIImagePickerControllerSourceTypeCamera :
UIImagePickerControllerSourceTypeSavedPhotosAlbum;
[self presentModalViewController: picker animated:YES];
[picker release];
     }

   -(IBAction)selectExitingPicture
{
if([UIImagePickerController isSourceTypeAvailable:
   UIImagePickerControllerSourceTypePhotoLibrary])
{
    UIImagePickerController *picker= [[UIImagePickerController alloc]init];
    picker.delegate = self;
    picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    [self presentModalViewController:picker animated:YES];
    [picker release];
}

  }

 -(void)imagePickerController:(UIImagePickerController *)picker
 didFinishPickingImage : (UIImage *)image
 editingInfo:(NSDictionary *)editingInfo
   {
imageView.image = image;
[picker dismissModalViewControllerAnimated:YES];
   }

   -(void)imagePickerControllerDidCancel:(UIImagePickerController *) picker
 {
[picker dismissModalViewControllerAnimated:YES];
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:35:52.970

您可以在 iPhone中显示`UIImagePicker`为 a 。`modalView`但在 iPad 中，您需要使用 UIPopover 作为显示 imagePicker 的容器。

重新编写您的代码，如：

```
-(IBAction)selectExitingPicture
{
  if([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary])
  {
    UIImagePickerController *picker= [[UIImagePickerController alloc]init];
    picker.delegate = self;
    picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
    {
      self.popover = [[UIPopoverController alloc]
            initWithContentViewController:picker];
        popover.delegate = self;
        [self.popover presentPopoverFromRect:CGRectMake(0,0,170,250)
            permittedArrowDirections:UIPopoverArrowDirectionAny
            animated:YES];
    }
    else
    {
       [self presentModalViewController:picker animated:YES];
    }
   [picker release];
} 
```

在您`@interface`添加必要的协议和必要的实例

```
@interface yourController: UIViewController
<UIImagePickerControllerDelegate,
UINavigationControllerDelegate, UIPopoverControllerDelegate>
{
    UIPopoverController *popover;
}
@property (nonatomic, strong) UIPopoverController *popover;
@end 
```

**它适用于 iPad 和 iPhone。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:04:55.720

在 iPad 上，您需要在 UIPopoverController 中显示它，而不是模态显示它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-17T21:54:54.597

你可以试试这个：

更改自定义弹出框的 CGRectMake 和内容大小的 CGSizeMake。

```
 - (IBAction)imageFromAlbum:(id)sender
{
    imagePicker = [[UIImagePickerController alloc] init];
    imagePicker.delegate = self;
    imagePicker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;

    // es iPad
    if ([[UIDevice currentDevice]userInterfaceIdiom] == UIUserInterfaceIdiomPad) {

        //Averiguar si está en portrait o landscape
        UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];

        //PORTRAIT
        if(orientation == UIInterfaceOrientationPortrait || orientation == UIInterfaceOrientationPortraitUpsideDown)
        {

            [self cerrarTeclado];

            self.popover = [[UIPopoverController alloc] initWithContentViewController:imagePicker];
            self.popover.delegate = self;

            [self.popover presentPopoverFromRect:CGRectMake(600, 400, 311, 350) inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:NO];
            [self.popover setPopoverContentSize:CGSizeMake(330, 515)];

        }
        //LANDSCAPE
        if (orientation == UIInterfaceOrientationLandscapeRight || orientation == UIInterfaceOrientationLandscapeLeft)
        {

            self.popover = [[UIPopoverController alloc] initWithContentViewController:imagePicker];
            self.popover.delegate = self;

            [self.popover presentPopoverFromRect:CGRectMake(850, 400, 311, 350) inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:NO];
            [self.popover setPopoverContentSize:CGSizeMake(330, 515)];

        }

    } else {
       // no es iPad 
       [self presentViewController:imagePicker animated:YES completion:nil]; 
    }

} 
```

# querydsl - 如何使用动态 QueryDSL 简化语法，避免多个“if”

> ID：13533204
> 
> 赞同：5
> 
> 时间：2012-11-23T16:59:54.370
> 
> 标签：querydsl

我正在使用 FilfetDto 构建动态查询如果用户在 UI 中填写了某些字段，则包含一些值但不是全部。所以我必须测试每个属性以仅在填充（非空）字段上构建查询过滤：

```
 JPAQuery dslQuery = new JPAQuery(em);

    dslQuery.from(book);
    dslQuery.join(book.author, author);      

    String title = StringUtils.upperCase(StringUtils.trim(_filter.getTitle()));
    if (StringUtils.isNotBlank(title)) {
        dslQuery.where(book.title.upper().like(title));
    }
    String isbn = StringUtils.trim(_filter.getIsbn());
    if (StringUtils.isNotBlank(isbn)) {
        dslQuery.where(book.isbn.like(isbn));
    }
    if (_filter.getAuthorId() != null) {
        dslQuery.where(author.id.eq(_filter.getAuthorId()));
    } 
```

有没有办法用另一种更易读的语法来抽象“if”？

我想要类似的东西：

```
 JPAQuery dslQuery = new JPAQuery(em);

    dslQuery.from(book);
    dslQuery.join(book.author, author);

    dslQuery.where(book.title.upperIfNotBlank().like(title));
    dslQuery.where(book.isbn.likeIfNotNull(isbn));
    dslQuery.where(author.id.eqIfNotNull(_filter.getAuthorId())); 
```

如果可以打开“IfNotNull”，甚至是默认行为，那就太好了......
所以它最终会像这样：

```
 dslQuery.where(book.title.upper().like(title));
    dslQuery.where(book.isbn.like(isbn));
    dslQuery.where(author.id.eq(_filter.getAuthorId())); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T21:49:23.953

> 有没有办法用另一种更易读的语法来抽象“if”？

不，而且可能不会有。Querydsl 表达式的目的是尽可能接近底层持久性技术使用的形式。

如果您想在自己的项目中使用这种方法，请随意将其放入您自己的 AbstractJPAQuery 子类中。Querydsl 查询旨在针对此类情况进行定制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-13T01:32:04.223

我创建了一个 QueryDSLHelper 类，该类具有在添加表达式之前执行 null 检查的静态方法。像这样的东西：

```
public static void goe(BooleanBuilder builder, DateTimePath<Date> path, Date value) {
    if(date!=null) {
        builder.and(path.goe(value));
    }
}

public static void like(BooleanBuilder builder, StringPath path, String value) {
    if(value!=null) {
        builder.and(path.like(value));
    }
} 
```

现在我可以静态导入这些方法并在一行中调用它们：

```
 like(builder, book.isbn, isbn); 
```

这在实现 'filter' 或 'filterByExample' 查询时非常有用且非常干净/易读。

# d3.js - Dart js 与 D3 互操作

> ID：13533207
> 
> 赞同：12
> 
> 时间：2012-11-23T17:00:09.580
> 
> 标签：d3.js, dart

我正在尝试将 D3 与 dart 集成：到目前为止，我的代码如下：

```
import 'dart:html';
import 'package:js/js.dart' as js;

void main() {
   js.scoped(() {
     var dee3 = js.context.d3; 
     var dataset = js.array([ 5, 10, 15, 20, 25 ]);
     dee3.select("body").selectAll("p")
    .data(dataset)
    .enter()
    .append("p")
    .text(function(d) { return d; });

  }); 
```

每当我在 dartium 中运行它时，都会出现以下异常：异常：函数必须先转换为回调，然后才能序列化。如何将匿名函数（d）转换为回调？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-18T16:22:16.733

作为*package:js > 0.2.0* `Callback`并且`js.scoped`不再需要。

```
import 'dart:html';
import 'package:js/js.dart' as js;

void main() {
  var dee3 = js.context.d3; 
  var dataset = js.array([ 5, 10, 15, 20, 25 ]);
  dee3.select("body").selectAll("p")
    .data(dataset)
    .enter()
    .append("p")
    .text((d, i, context) => d);
} 
```

# vb.net - 如何在 VB NET 中重新加载图表

> ID：13533208
> 
> 赞同：2
> 
> 时间：2012-11-23T17:00:11.437
> 
> 标签：vb.net, charts

我有这段代码可以在 Windows 窗体程序中加载图表。它被放置在按钮单击事件处理程序中。当我单击按钮第一次显示图表时，确定。但在第二次单击时，它会给我错误“在 'SeriesCollection' 中找不到名为 'Series1' 的图表元素。” 请在代码中查看。我是 VB 新手，更不用说图表了，不知道如何解决这个问题，所以我可以随时单击按钮重新加载图表。非常感谢您的任何建议。

```
Dim pp As String = "J:\UCP\ApplicationsProgramming\MainDB.accdb"
    Dim strConn As String = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & pp & ";Persist Security Info=False;"
    Dim tblFields As String = "SELECT Type, COUNT([Zone]) as CountZone FROM Faults GROUP BY Type "
    Dim conn As New OleDbConnection(strConn)
    Dim oCmd As New OleDbCommand(tblFields, conn)
    Dim oData As New OleDbDataAdapter(tblFields, conn)
    Dim ds As New DataSet

        conn.Open()
        oData.Fill(ds, "Faults")
        conn.Close()

'''''''''''''''''''''''''''''
'~~> SET DATA SOURCE <~~'
'''''''''''''''''''''''''''''
        Chart1.DataSource = ds.Tables("Faults")

''''''''''''''''''''''''''''''''
'~~> WORKING WITH CHARTAREA <~~'
''''''''''''''''''''''''''''''''
Dim CArea As ChartArea = Chart1.ChartAreas(0)
        CArea.BackColor = Color.White         
        CArea.ShadowColor = Color.Red           
        CArea.Area3DStyle.Enable3D = True       

'~~> Formatting X Axis
        CArea.AxisX.MajorGrid.Enabled = False   
        CArea.AxisX.LabelStyle.Font = New System.Drawing.Font("Arial", _
        10.0F, System.Drawing.FontStyle.Italic) 

'~~> Formatting Y Axis
        CArea.AxisY.MajorGrid.Enabled = False   
        CArea.AxisY.LabelStyle.Format = "" 
        CArea.AxisY.Interval = 0.1             

''''''''''''''''''''''''''''
'~~> WORKING WITH TITLE <~~'
''''''''''''''''''''''''''''
'~~> Adding a Title
Dim T As Title = Chart1.Titles.Add("Fault Types")
'~~> Formatting the Title
        With T
            .ForeColor = Color.Black          
            .BackColor = Color.White    

'~~> Setting Font, Font Size and Bold/Italicizing
            .Font = New System.Drawing.Font("Arial", 11.0F, System.Drawing.FontStyle.Bold)
            .BorderColor = Color.Black          
            .BorderDashStyle = ChartDashStyle.NotSet  
        End With

'''''''''''''''''''''''''''''
'~~> WORKING WITH SERIES <~~'
'''''''''''''''''''''''''''''

////// NEXT LINE WILL GIVE FOLLoWING ERROR:
////// "A chart element with the name 'Series1' could not be found in the 'SeriesCollection'."  //////////

Dim Series1 As Series = Chart1.Series("Series1")    <<<<<<<<<<
'~~> Setting the series Name
        Series1.Name = "Fault Types"
'~~> Assigning values to X and Y Axis

        Chart1.Series(Series1.Name).XValueMember = "Type"
        Chart1.Series(Series1.Name).YValueMembers = "CountZone"
'~~> Setting Font, Font Size and Bold
        Chart1.Series(Series1.Name).Font = New System.Drawing.Font("Arial", 10.0F, System.Drawing.FontStyle.Bold)
'~~> Setting Value Type
        Chart1.Series(Series1.Name).YValueType = ChartValueType.Double
'~~> Setting the Chart Type for Display 
'Chart1.Series(Series1.Name).ChartType = SeriesChartType.Radar
        Chart1.Series(Series1.Name).ChartType = SeriesChartType.Pie
'~~> Display Data Labels
        Chart1.Series(Series1.Name).IsValueShownAsLabel = True
'~~> Setting label's Fore Color
        Chart1.Series(Series1.Name).LabelForeColor = Color.FloralWhite
'~~> Setting label's Format to %age
        Chart1.Series(Series1.Name).LabelFormat = "" '"0.0%"

'~~> Setting the location for the chart
        Chart1.Size = New System.Drawing.Size(865, 350) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T20:54:29.003

该行`Series1.Name = "Fault Types"`更改了系列的名称。

因此，单击后，下一次调用`Dim Series1 As Series = Chart1.Series("Series1")`将失败。

如果您只使用一个系列，您应该尝试`Dim Series1 As Series = Chart1.Series(0)`

# c++ - 逐行读取文件到变量并循环

> ID：13533210
> 
> 赞同：5
> 
> 时间：2012-11-23T17:00:32.997
> 
> 标签：c++, file-handling, file-io

我有一个phone.txt，例如：

```
09236235965
09236238566
09238434444
09202645965
09236284567
09236235965
..and so on.. 
```

如何在 C++ 中逐行处理此数据并将其添加到变量中。

```
string phonenum; 
```

我知道我必须打开文件，但是在这样做之后，如何访问文件的下一行？

```
ofstream myfile;
myfile.open ("phone.txt"); 
```

还有关于变量，该过程将被循环，它将使`phonenum`变量成为当前行，它从phone.txt处理。

就像读取第一行是`phonenum`第一行一样，处理所有内容并循环；现在`phonenum`是第二行，处理所有内容并循环直到文件的最后一行结束。

请帮忙。我对 C++ 真的很陌生。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T17:18:44.190

请阅读内联评论。他们将解释正在发生的事情，以帮助您了解其工作原理（希望如此）：

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstdlib>

int main(int argc, char *argv[])
{
    // open the file if present, in read mode.
    std::ifstream fs("phone.txt");
    if (fs.is_open())
    {
        // variable used to extract strings one by one.
        std::string phonenum;

        // extract a string from the input, skipping whitespace
        //  including newlines, tabs, form-feeds, etc. when this
        //  no longer works (eof or bad file, take your pick) the
        //  expression will return false
        while (fs >> phonenum)
        {
            // use your phonenum string here.
            std::cout << phonenum << '\n';
        }

        // close the file.
        fs.close();
    }

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T17:19:17.467

简单的。首先，请注意您需要的是`ifstream`，而不是`ofstream`。当您从文件中读取时，您将其用作输入 - 因此`i`in `ifstream`. 然后你想要循环，使用`std::getline`从文件中获取一行并处理它：

```
std::ifstream file("phone.txt");
std::string phonenum;
while (std::getline(file, phonenum)) {
  // Process phonenum here
  std::cout << phonenum << std::endl; // Print the phone number out, for example
} 
```

之所以`std::getline`是 while 循环条件，是因为它检查流的状态。如果`std::getline`无论如何都失败（例如在文件末尾），则循环将结束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T17:07:15.380

你可以这样做：

```
 #include <fstream>
 using namespace std;

 ifstream input("phone.txt");

for( string line; getline( input, line ); )
{
  //code
} 
```

# java - Java队列链表

> ID：13533211
> 
> 赞同：0
> 
> 时间：2012-11-23T17:00:33.407
> 
> 标签：java, c, linked-list, queue

我正在尝试将以下内容转换为java。我创建了一个学生类并使用`LinkedList<Student> studentList.` 如何在 java 中执行以下 4 件事来加入 StudentNode 和 Queue？

```
Student *studentPtr;
StudentNode *p;
1\. p.student = studentPtr;
2\. p.next = null;

Queue readyQueue;
3\. readyQueue.head
4\. readyQueue.tail

typedef struct{
   int age;

}Student;
struct my_struct
    {
      Student student;
      struct my_struct* next;
    }StudentNode;

struct my_list
{
  struct my_struct* head;
  struct my_struct* tail;
}Queue; 
```

谁能帮我将以下函数转换为java方法？

```
StudentNode *makeStudentNode(Student *stPtr)
{
    StudentNode *p = (StudentNode *)malloc(sizeof(StudentNode));

   p->student = stPtr;
   p->next = NULL;
   return p;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:04:15.563

[`java.util.LinkedList`](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedList.html)图书馆里已经有，你可以使用它。

```
List<student> studList = new LinkedList<student>(); 
Student st = new Student();
st.setName("...");
studList.add(st);
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:07:58.177

```
public class Student {
   int age;
} 
```

而是一个队列

```
List<Student> studentList; 
```

在代码中，您将通过以下方式初始化：

```
studentList = new ArrayList<Student>(); 
```

或者，如果您更愿意靠近队列：

```
studentList = new LinkedList<Student>(); 
```

添加学生：

```
studentList.add(new Student(23));
studentList.add(new Student(19)); 
```

并删除第一个元素

```
studenList.remove(0); 
```

如果 theList 被定义为 LinkedList：

```
LinkedList<Student> studentList; 
```

然后你可以用

```
studentList.remove(); 
```

您可以遍历所有学生：

```
for (Student student: studentList) {
   System.out.println(student.age);
} 
```

或使用迭代器：

```
 for (Iterator<Student> iterator = studentList.iterator(); iterator.hasNext();) {
     Student student = iterator.next();
     System.out.println(student.age);
 } 
```

# curl - 如何使用 wget/curl 在给定网页上下载所有指向 .zip 文件的链接？

> ID：13533217
> 
> 赞同：85
> 
> 时间：2012-11-23T17:00:46.960
> 
> 标签：curl, download, wget

一个页面包含指向一组 .zip 文件的链接，我想下​​载所有这些文件。我知道这可以通过 wget 和 curl 来完成。它是如何完成的？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-11-26T22:12:50.677

命令是：

```
wget -r -np -l 1 -A zip http://example.com/download/ 
```

选项含义：

```
-r,  --recursive          specify recursive download.
-np, --no-parent          don't ascend to the parent directory.
-l,  --level=NUMBER       maximum recursion depth (inf or 0 for infinite).
-A,  --accept=LIST        comma-separated list of accepted extensions. 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2013-09-10T02:09:13.747

上述解决方案对我不起作用。对我来说只有这个有效：

```
wget -r -l1 -H -t1 -nd -N -np -A.mp3 -erobots=off [url of website] 
```

选项含义：

```
-r            recursive
-l1           maximum recursion depth (1=use only this directory)
-H            span hosts (visit other hosts in the recursion)
-t1           Number of retries
-nd           Don't make new directories, put downloaded files in this one
-N            turn on timestamping
-A.mp3        download only mp3s
-erobots=off  execute "robots.off" as if it were a part of .wgetrc 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-01-11T20:34:49.027

对于其他具有一些并行魔法的场景，我使用：

```
curl [url] | grep -i [filending] | sed -n 's/.*href="\([^"]*\).*/\1/p' |  parallel -N5 wget - 
```

# r - 如何克服“.local(object, ...) 中的错误：测试向量与模型不匹配！”？

> ID：13533218
> 
> 赞同：4
> 
> 时间：2012-11-23T17:00:50.987
> 
> 标签：r, svm, kernlab

我从原始数据集中删除了 100 条记录，然后使用以下编码重建了 SVM 模型。

```
uk<-read.csv("Riskx.csv", header=TRUE, sep=",")
attach(uk)
library(e1071)
library(kernlab)
index<-1:nrow(uk)
testindex<-sample(index, trunc(length(index)/3))
testset<-uk[testindex,]
trainset<-uk[-testindex,]
model<-ksvm(Risk~, data = trainset, type = "nu-svc")
pred<-predict(model, testset)
table(pred, testset$Risk)
summary(testset$Risk) 
```

现在，我想引入我在训练/测试新模型时留出的那 100 条记录，并检查该模型在识别和分类这 100 条以前从未见过的记录方面的能力。所以我做了以下编码。

```
testset<-read.csv(“Validation.csv”, header=TRUE, sep=”,”)
Pred1<-predict(model4, testset) 
```

但是 R，给了我以下错误：

```
Error in .local(object, …) : test vector does not match model ! 
```

知道我怎么能克服这个错误吗？用于构建模型的测试集有 466 条记录。因此，我也尝试将验证测试复制到 466，但它仍然给出相同的错误。

# c# - IndexOutOfRangeException 未处理 - 索引超出了数组的范围

> ID：13533223
> 
> 赞同：0
> 
> 时间：2012-11-23T17:01:15.280
> 
> 标签：c#, windows, arrays, forms, listview

我有一个 for 循环，将数组中的项目添加到 listView。

（它会抓取网页上的项目，删除字符串中 ' 之后的任何内容，然后将其添加到 listView 中）

我得到的错误是：`IndexOutOfRangeException was unhandled- Index was outside the bounds of the array`

这是我正在使用的代码：

```
string[] aa = getBetweenAll(vid, "<yt:statistics favoriteCount='0' viewCount='", "'/><yt:rating numDislikes='");
for (int i = 0; i < listView1.Items.Count; i++)
{
    string input = aa[i];
    int index = input.IndexOf("'");
    if (index > 0)
        input = input.Substring(0, index);
    listView1.Items[i].SubItems.Add(input);
} 
```

错误发生在这一行：`string input = aa[i];`

我做错什么了吗？我该如何解决这个问题，让它停止发生？谢谢！

如果您想知道*getBetweenAll*方法的代码是：

```
private string[] getBetweenAll(string strSource, string strStart, string strEnd)
{
    List<string> Matches = new List<string>();

    for (int pos = strSource.IndexOf(strStart, 0),
        end = pos >= 0 ? strSource.IndexOf(strEnd, pos) : -1;
        pos >= 0 && end >= 0;
        pos = strSource.IndexOf(strStart, end),
        end = pos >= 0 ? strSource.IndexOf(strEnd, pos) : -1)
    {
        Matches.Add(strSource.Substring(pos + strStart.Length, end - (pos + strStart.Length)));
    }

    return Matches.ToArray();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:05:32.013

你循环'listView1'的元素

如果 listView1 的项目数超过字符串数组 'aa' 的元素数，您将收到此错误。

我要么将循环更改为

```
for( ..., i < aa.Length, ...) 
```

或者在你的 for 循环中放置一个 if 语句以确保你没有超过 aa 的元素。（虽然，我怀疑这是你想要做的）。

```
for (int i = 0; i < listView1.Items.Count; i++)
{
   if( i < aa.Length)
   {
      string input = aa[i];
      int index = input.IndexOf("'");
      if (index > 0)
         input = input.Substring(0, index);
      listView1.Items[i].SubItems.Add(input);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:04:04.230

好吧，这很简单，`ListView.Items.Count`然后你的更大`aa.Length`。您需要确保它们具有相同的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:05:20.263

您的 for 循环应更改为

```
for (int i = 0; i < aa.Length; i++) 
```

此外，当您执行以下行时，请确保索引匹配。

```
listView1.Items[i].SubItems.Add(input); 
```

由于您的上述错误，它似乎不匹配，您最好循环遍历列表视图以找到匹配的 ListView 项目，然后对其进行操作。

# javascript - 内容更改后的元素高度

> ID：13533227
> 
> 赞同：0
> 
> 时间：2012-11-23T17:01:26.903
> 
> 标签：javascript, jquery, textarea

我有一段代码可以更改 DIV 的内容以匹配 textarea 的内容，然后将 DIV 中的高度更改应用于 textarea 元素。

```
<textarea class="fieldEdit" data-fieldid="1_description"></textarea>
<div class="hiddenDiv" data-fieldid="1_description"></div>

<Script>
$('.fieldEdit').live('keyup', function(){growTextArea(this)});

function growTextArea(parameter) {
// works
     $('div').find("[data-fieldid='1_description']").text($(parameter).val());
     $("[data-fieldid='1_description']").text($(parameter).val());

// No Works
     height = $('div').find("[data-fieldid='1_description']").outerHeight();
     height = $("[data-fieldid='1_description']").outerHeight();
     alert(height);

// Works
     heightDiv = $('.hiddenDiv').outerHeight();
     alert(heightDiv);

     $(parameter).css('height', $('div').find("[data-fieldid='1_description']").outerHeight());
}
</script> 
```

DIV 内容正确更改，因此搜索功能正常工作，但搜索功能始终返回 DIV 的原始高度。该函数由 textarea 中的 onKeyUp 调用。如果将 .find 换成 .hiddenDiv，则高度变化会正确反映。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-15T09:37:52.170

您需要使用 jQuery 承诺功能。就像是：

```
$('#divId').html(someText).promise().done(function(){
        // check height now
    }); 
```

# java - 静态方法和继承的返回类型中的泛型

> ID：13533233
> 
> 赞同：6
> 
> 时间：2012-11-23T17:02:04.467
> 
> 标签：java, generics, inheritance, static-methods

静态方法的返回类型中的泛型似乎与继承相处得不好。请看下面的代码：

```
class ClassInfo<C>  {
  public ClassInfo(Class<C> clazz) {
    this(clazz,null);
  }  
  public ClassInfo(Class<C> clazz, ClassInfo<? super C> superClassInfo) {
  }
}

class A {
    public static ClassInfo<A> getClassInfo() {
        return new ClassInfo<A>(A.class);
    }
}

class B extends A {
    // Error: The return type is incompatible with A.getClassInfo()
    public static ClassInfo<B> getClassInfo() { 
        return new ClassInfo<B>(B.class, A.getClassInfo());
    }
} 
```

我试图通过更改 A.getClassInfo() 的返回类型来规避这个问题，现在错误在另一个位置弹出：

```
class ClassInfo<C>  {
  public ClassInfo(Class<C> clazz) {
    this(clazz,null);
  }  
  public ClassInfo(Class<C> clazz, ClassInfo<? super C> superClassInfo) {
  }
}

class A {
    public static ClassInfo<? extends A> getClassInfo() {
        return new ClassInfo<A>(A.class);
    }
}

class B extends A {
    public static ClassInfo<? extends B> getClassInfo() { 
        // Error: The constructor ClassInfo<B>(Class<B>, ClassInfo<capture#1-of ? extends A>) is undefined
        return new ClassInfo<B>(B.class, A.getClassInfo());
    }
} 
```

对静态方法进行严格检查的原因是什么？我该如何相处？更改方法名称似乎很尴尬。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:09:25.953

B 中的静态方法不会覆盖 A 中的静态方法，而是将其隐藏。[JLS 8.4.8.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.8.3)明确指出返回类型必须是可替换的，否则将无法编译：

> 如果具有返回类型 R1 的方法声明 d1 覆盖或隐藏具有返回类型 R2 的另一个方法 d2 的声明，则 d1 必须是 d2 的返回类型可替换（第 8.4.5 节），否则会发生编译时错误。

可替代性在 JLS #8.4.5 中定义：

> 当且仅当以下条件成立时，具有返回类型 R1 的方法声明 d1 可以返回类型替代具有返回类型 R2 的另一个方法 d2：
> 
> *   [...]
> *   如果 R1 是引用类型，则：
>     *   R1 是 R2 的子类型，或者 R1 可以通过未经检查的转换（第 5.1.9 节）转换为 R2 的子类型，或者
>     *   R1 = |R2|

在您的情况下： d1 是 B 中的方法， R1 是`ClassInfo<B>`， d2 是 A 和 R2 中的方法`ClassInfo<A>`。并且`ClassInfo<B>`不是`ClassInfo<A>`.

但是，`ClassInfo<? extends B>`可以转换为`ClassInfo<? extends A>`. 您可以在以下位置观察到这种行为：

```
void someMethod(){
    ClassInfo<B> b1 = (ClassInfo<B>) get1(); //does not compile
    ClassInfo<? extends B> b2 = (ClassInfo<? extends B>) get2(); //compiles
}

ClassInfo<A> get1() {
    return null;
}

ClassInfo<? extends A> get2() {
    return null;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T17:04:17.453

您不能覆盖静态方法。因此，当您声明相同的静态方法时，您正在创建一个新方法。

```
public static ClassInfo<B> getClassInfo() { 
    return new ClassInfo<B>(B.class, A.getClassInfo());
} 
```

但是，当您声明具有更改的返回类型的方法时，它**不是有效的方法 hidden**，**也不是 override**。所以，`getClassInfo()`方法`class A`和`getClassInfo()`方法`class B`，相互冲突。因为A类的方法在B类中也是可见的。

因此，换句话说，`class B`具有相同的方法，因为它继承自`class A`，但返回类型发生了变化。并且由于方法的返回类型不被视为方法签名的一部分。因此冲突。

因此，您需要具有完全相同的返回类型。在这种情况下，B 类将忽略继承的方法，并使用它自己的方法。

# mysql - 从两个表中获取一些数据

> ID：13533237
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:02:22.837
> 
> 标签：mysql

我有像 imdb 这样的网站，我们提供电影信息罪恶网站..我们的网站可以选择为每个用户评价所有电影。

我有两张桌子
1 。imdb（用于存储电影详细信息） id,name,actors,vote
2\. rating（用于存储用户评分详细信息） id,rating_id（与第一个表中的 id 相同）,rating_num,IP

现在正在做的是..当任何人对电影进行评分时，通过使用评分表（总评分/评分数）获取该电影评分的平均值并将该值插入第一个表的“投票”列中......我要求这个......这就是为什么这样做..

现在我的问题是..我想获取评分最高的电影..我的意思是在投票栏中哪部电影有最高评分想要列出，还有一个条件是该电影应该由 10 个用户评分（使用评分表）

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:47:45.090

我不太明白您的表格是如何组织的。是否存在 A）客户在评级表中给出的每个评级的新行或 B）每部电影是否只有 1 行更新？

我猜它是 A，rating_num 是客户给出的评级。

在这种情况下，一个简单的 MySql 解决方案可以使用 COUNT 和 AVG 等聚合函数。未经测试的例子。

编辑 - 要从 imdb 表中获取详细信息，您只需要加入它们。

```
SELECT id as 'ID', COUNT(1) as 'Number of ratings', AVG(r.rating_num) as 'Average rating', i.name, i.actors, i.vote
FROM ratings r
INNER JOIN imbd i ON ( r.id = i.id )
GROUP BY r.id
HAVING `Number of ratings` >= 10
ORDER BY `Average rating` desc
LIMIT 10 
```

# algorithm - 带有丢弃元素的排序队列

> ID：13533241
> 
> 赞同：2
> 
> 时间：2012-11-23T17:02:50.150
> 
> 标签：algorithm, data-structures

我有一个**工作列表**和等待这些工作**的工人队列。**所有的工作都是一样的，但工人是不同的，并根据他们执行工作的能力进行分类。也就是说，第一个人可以最好地完成这项工作，第二个人可以做得更差一点，依此类推。工作总是被分配给当时**空闲**的人中**技能最高**的人。当一个人被分配一份工作时，他会退出队列一段时间。但是当他完成后，他又回到了他的位置。因此，例如，在某个时刻，工作队列看起来像：

 **```
[x, x, .83, x, .7, .63, .55, .54, .48, ...] 
```

其中`x`'s 代表失踪工人，数字显示离开工人的技能水平。当有新工作时，它被分配给第 3 名工人，作为可用工人中技能最高的一名。所以下一刻队列看起来像：

```
[x, x, x, x, .7, .63, .55, .54, .48, ...] 
```

假设此时工人 #2 完成了他的工作并返回列表：

```
[x, .91, x, x, .7, .63, .55, .54, .48, ...] 
```

我希望这个过程现在完全清楚了。我的问题是使用什么**算法**和**数据结构**来实现**工人的快速搜索和删除**以及**插入回**他的位置。

目前我能看到的最好的方法是使用已摊销的**斐波那契堆**`O(log n)`来删除最小元素（分配作业并从队列中删除工作人员）`O(1)`并将他插入回来，这非常好。但是，是否有更好的算法/数据结构可能考虑到元素已经排序并且不时地从队列中删除的事实？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:30:34.337

使用常规[堆](http://en.wikipedia.org/wiki/Heap_%28data_structure%29)，它比斐波那契堆更容易实现，并且还支持插入和删除`O(lg n)`（删除与插入一样多，因此获得更便宜的插入并不值得）。与斐波那契堆相反，常规堆通常在标准库中实现，例如`priority_queue`在 C++ 中的 STL 中。

如果存在更快的数据结构，您可以使用它来执行比 更快的排序`Omega(n lg n)`，这在一般情况下是不可能的。如果技能级别的数字有一些特殊的属性（比如说，它们是限制范围内的整数），那么执行排序的速度可能比 快`Omega(n lg n)`，但我不知道在这种情况下是否存在更快的优先级队列。

（顺便说一下，“rambo coder”的评论是绝对正确的；您应该将堆的实际性能与未排序列表的性能进行比较）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T20:25:53.640

作为一个理论练习，您可以考虑对数据进行预处理，以将所有内容减少为小整数，从而在完整队列中占据位置。然后首先想到的是[http://en.wikipedia.org/wiki/Van_Emde_Boas_tree](http://en.wikipedia.org/wiki/Van_Emde_Boas_tree)，理论上它可以将 log n 减少到 log n。请注意，在本文的末尾，有一些关于不太实际的解决方案的想法。[http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.137.8757](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.137.8757)的文章（Integer Priority Queues with Decrease Key in constant time...）声称在理论上比斐波那契树更好对于小整数键的情况，并确实注意到与排序问题的链接 - 并参考了另一篇带有排序链接的论文 - 也是非常理论的。**

# objective-c - 如何修复滚动缓慢的表格视图

> ID：13533244
> 
> 赞同：0
> 
> 时间：2012-11-23T17:03:24.977
> 
> 标签：objective-c, ios, uitableview, tableview

我有一个缓慢滚动的表格视图。有谁知道为什么会这样？

每行都有一个图像，但即使在加载图像之后，它仍然会卡住并缓慢滚动。

谢谢你的帮助

这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *simpleTableIdentifier = @"SimpleTableCell";

    SimpleTableCell *cell = (SimpleTableCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];
    if (cell == nil)
    {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"SimpleTableCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];
    }
    // Get item from tableData
    NSDictionary *item = (NSDictionary *)[displayItems objectAtIndex:indexPath.row];

    // display the youdeal deal image
    photoString = [item objectForKey:@"image"];
    UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:photoString]]];

    cell.titleLabel.text = [item objectForKey:@"supercat"];
    cell.descriptionLabel.text = [item objectForKey:@"title"];

    NSString *convertedLeftCount = [NSString stringWithFormat:@"%@",[item objectForKey:@"left_count"]];

    cell.amountLabel.text = convertedLeftCount;

    cell.thumbnailImageView.image = image;
    cell.priceLabel.text = [item objectForKey:@"cat"];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:09:12.803

这是由于您使用的图像加载机制。

您正在从主线程中的 url 加载图像。这就是为什么 UI 被阻塞了一段时间也是`dataWithContentsOfURL:`同步调用的原因。所以UI会在获取到图片数据后做出响应。

苹果表示，像 webrequest、解析大数据等过程必须在其他线程上完成，而不是在主线程上完成。并且所有与 UI 相关的任务都必须在主线程上完成。

**解决方案：**

1.  在后台线程中请求图像，而不是在主线程中。
2.  获取图像后缓存它

**源代码和第三方库**

这里有一些链接可以帮助您了解使用异步方法加载图像的基本思想

1.  [懒表图像](http://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html)
2.  [HJCache](https://github.com/markofjohnson/HJCache)
3.  [SDWebImage](https://github.com/rs/SDWebImage)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:08:37.007

每次加载单元格时都会加载图像，因为 imageWithData: 不使用任何缓存。

编辑：我看到一条建议异步加载图像的评论。您已经为每个单元格提供了自定义类，因此应该很容易做到。如果这是一个答案，我会投票赞成

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-18T11:35:09.523

我想你是想说这个。

```
NSURL* url = [NSURL URLWithString:@"http://www.YourImageUrl.com"];
NSURLRequest* request = [NSURLRequest requestWithURL:url];

[NSURLConnection sendAsynchronousRequest:request
    queue:[NSOperationQueue mainQueue]
    completionHandler:^(NSURLResponse * response,
        NSData * data,
        NSError * error) {
if (!error){
        UIImage* image = [[UIImage alloc] initWithData:data];
    // Now workout with the image
}

}]; 
```

这将进行异步调用，并在加载表格视图后加载图像，即当图像加载完成时，图像将显示，但在需要加载表格视图时加载表格。

# jquery - 使用“所有选择器”和字段集进行序列化的重复数据

> ID：13533246
> 
> 赞同：0
> 
> 时间：2012-11-23T17:03:52.007
> 
> 标签：jquery

问这个只是为了理解。

请在线查看问题（使用 FireBug 控制台）- [http://jsfiddle.net/ihtus/3DuPW/](http://jsfiddle.net/ihtus/3DuPW/)

```
<div id='mydiv1'>
    this is with fieldset and $('#mydiv1 *').serialize()<br/>
    <fieldset><legend>aa</legend>
        <input type='text' name='myinp' value=''>
        <input id='save' type='button' value='serialize' onclick="console.log($('#mydiv1 *').serialize())">
    </fieldset>
    <br/>result: myinp=myval&myinp=myval
</div>
<br/><br/>

<div id='mydiv2'>
    this is without fieldset and $('#mydiv1 *').serialize()<br/>
    <input type='text' name='myinp' value=''>
    <input id='save' type='button' value='serialize' onclick="console.log($('#mydiv2 *').serialize())">
    <br/>result: myinp=myval
</div>
<br/><br/>

<div id='mydiv3'>
    this is with fieldset and $('#mydiv1 :input').serialize()<br/>
    <fieldset><legend>aa</legend>
        <input type='text' name='myinp' value=''>
        <input id='save' type='button' value='serialize' onclick="console.log($('#mydiv3 :input').serialize())">
    </fieldset>
    <br/>result: myinp=myval
</div> 
```

问题：为什么当有 $('#mydiv1 *').serialize() 和 fieldset => 结果重复“myinp=myval&myinp=myval”

有 $('#mydiv1 *').serialize() 和 NO 字段集时没有重复。

我知道我应该使用 $('#mydiv1 :input').serialize()，我会使用它......但我只是好奇为什么在这种情况下数据会重复。

谢谢。

# android - 分配 int 数组时的 OutOfMemory < 可用内存

> ID：13533247
> 
> 赞同：0
> 
> 时间：2012-11-23T17:03:58.700
> 
> 标签：android, memory, allocation

在我的 android 应用程序中，我分配了一个大的 int 数组。当我认为应该有足够的内存时，这有时会给我一个 OutOfMemory 错误。这是我得到的一个例子：

```
// always this value
ActivityManager.some_instance.getMemoryClass() = 128 Mb

// always this value
Runtime.getRuntime().maxMemory()/(1024*1024) = 128 Mb

// example value
Runtime.getRuntime().freeMemory()/(1024*1024) = 81 Mb

// example value, can also be bigger than freeMemory()
arrayLengthToAllocate*4/(1024*1024) = 47 Mb 
```

需要明确的是，对于最后一个值大于或小于 freeMemory() 的情况，我会收到 OutOfMemory 错误。

为什么我会收到错误消息？执行分配时堆大小没有增加吗？在尝试分配之前应用程序的内存使用量约为 8 Mb，因此这不是问题。

PS。除了使用该应用程序正在执行的操作的 int[] 之外的其他方法是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:16:31.647

一般来说，大多数设备对您可以使用的内存量都有上限。我知道最初将每个应用程序设置为 16MB。我认为这已经增加了，但它仍然是你应该考虑的事情。

您还必须记住，您的应用程序占用空间可能会波动，并且 Android 操作系统必须为其他竞争资源的应用程序提供内存。可能是 Android 将您的应用程序识别为资源消耗者并削减了它的资源。

在内存中存储 47MB 的整数并不能很好地利用应用程序的内存，没有更简单的方法吗？我不明白为什么你需要这么多整数才能如此容易获得。当然，将整数添加到 SQLite 数据库，根据需要读取它们，从而将大部分内存需求从 RAM 移到物理内存上会是更好的方法吗？

当您遇到 OutOfMemory 错误时，通常表明您有点过于贪婪，限制它们的最佳方法是缩减您正在做的事情，找到不同的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:16:40.300

您获得的内存量是*系统*内存大小。每个应用程序都有一个有限的子集，这取决于一些系统变量。一般来说，它大约为 16 - 32 MB，有时对于平板电脑来说更大一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T10:52:49.023

我发现问题是堆碎片。碎片整理有一些限制，以至于堆中没有足够的空闲*连续*字节来容纳单个大数组。我将数据重构为一个二维数组，解决了这个问题，因为每一行在堆中都有自己的位置。缺点是从数组中检索数据的速度稍慢。

# php - 个人资料图片将上传到文件夹但不会上传到屏幕

> ID：13533249
> 
> 赞同：0
> 
> 时间：2012-11-23T17:04:06.910
> 
> 标签：php, codeigniter

我正在创建一个个人资料页面，当我选择要上传的图像时，它将存储在上传文件夹中，但不会显示在屏幕上 - 为什么会这样。

图像的容器似乎出现了，但不是图像

但是如果我不选择要上传的图像，上传功能会正确返回错误

这是我的控制器，其中包含上传功能 - 我意识到该文件夹​​称为 puploads：

```
 class HomeProfile extends CI_Controller 
  {

 function HomeProfile()
 {
   parent::__construct();
   $this->load->model("profiles");
   $this->load->model("profileimages");
    $this->load->helper(array('form', 'url'));
 }

   function upload()
    {
    $config = array(

        'allowed_types' =>'gif|jpg|jpeg|png',
        'upload_path' =>'./web-project-jb/assets/puploads/',
         'max_size' => 10000,
         'max_width' => 1024,
        'max_height' => 768

);

$this->load->library('upload', $config);
$img = $this->session->userdata('img');
$username = $this->session->userdata('username');
$this->profileimages->putProfileImage($username, $this->input->post("profileimage"));
//fail show upload form
if (! $this->upload->do_upload())
{

    $error = array('error'=>$this->upload->display_errors());

    $username = $this->session->userdata('username');

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $this->load->view('shared/header');
    $this->load->view('homeprofile/homeprofiletitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->view('homeprofile/homeprofileview', $error, $viewData, array('error' => ' ' ));
    $this->load->view('shared/footer');

    //redirect('homeprofile/index');

}

else
{
    //successful upload so save to database

    $file_data = $this->upload->data();

    $data['img'] = base_url().'./web-project-jb/assets/puploads/'.$file_data['file_name'];
    // you may want to delete the image from the server after saving it to db
    // check to make sure $data['full_path'] is a valid path
    // get upload_sucess.php from link above
    //$image = chunk_split( base64_encode( file_get_contents( $data['file_name'] ) ) );

    $this->username = $this->session->userdata('username');

    $data['profileimages'] = $this->profileimages->getProfileImage($username);

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $username = $this->session->userdata('username');

    $this->load->view('shared/header');
    $this->load->view('homeprofile/homeprofiletitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->view('homeprofile/homeprofileview', $data, $viewData);
    $this->load->view('shared/footer');

    //redirect('homeprofile/index');
        }

   }

     function index()
     {

$username = $this->session->userdata('username');

$data['profileimages'] = $this->profileimages->getProfileImage($username);

$viewData['username'] = $username;
$viewData['profileText'] = $this->profiles->getProfileText($username);

$this->load->view('shared/header');
$this->load->view('homeprofile/homeprofiletitle', $viewData);
$this->load->view('shared/nav');
//$this->load->view('homeprofile/upload_form', $data);
$this->load->view('homeprofile/homeprofileview', $data, $viewData, array('error' => ' ' ) );
$this->load->view('shared/footer');
  }

  } 
```

这是我的个人资料图像模型：

```
function ProfileImages()
{
    parent::__construct();

}

function exists($username)
{
    $this->db->select('*')->from("profileimages")->where('user', $username);
    $query = $this->db->get();

    if ($query->num_rows() > 0)
    {

        return true;
        /*
         echo "user $user exists!";
        $row = $query->row();
        echo " and his profileimage is $row->profileimage";
        */
    }

    else

    {

        return false;
        //echo "no such user as $user!";
    }

}

function putProfileImage($username, $img)
{

    $record = array('user' => $username, 'profileimage' => $img);
    if ($this->exists($username))
    {
        $this->db->where('user', $username)->update('profileimages', /*'./uploads/.' */$record);

        //appends
    }
    else
    {
        $this->db->where('user', $username)->insert('profileimages', $record);

    }

}

function getProfileImage($username)
{
    $this->db->select('*')->from('profileimages')->where('user', $username);
    $query = $this->db->get();
    if ($query->num_rows() > 0){
        $row = $query->row();
        return $row->profileimage;
    }

    return Null;

}

} 
```

这是我的看法：

```
<h3><?="Profile Image"?></h3>
 <img src="./web-project-jb/assets/puploads/" width='300' height='300'/>
  <?=form_open_multipart('homeprofile/upload');?>
    <input type="file" name="userfile" value=""/>
    <?=form_submit('submit', 'upload')?>
    <?=form_close();?> 
    <?php if (isset($error)) echo $error;?>
   </div>
  </div> 
```

我试过用 img src 替换，但我只是得到一个错误，说数据无法识别

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:21:59.020

您的视图文件不表示任何输出动态图像的尝试，您已经`src`硬编码并且根本没有使用您的`$img`变量（您在控制器中设置的变量`$data['img']`）：

```
$data['img'] = base_url().'./web-project-jb/assets/puploads/'.$file_data['file_name']; 
```

在这里，您似乎也在混合服务器路径和 URL。假设您的上传文件夹的 URL 是：

> `http://example.com/web-project-jb/assets/puploads/`

...在您的控制器中使用它（上传成功后）：

```
$data['img'] = 'web-project-jb/assets/puploads/'.$file_data['file_name']; 
```

那么在你看来：

```
<img src="<?php echo base_url($img); ?>" width='300' height='300'/> 
```

# java - 生产者/消费者使用等待和通知

> ID：13533255
> 
> 赞同：-2
> 
> 时间：2012-11-23T17:04:21.433
> 
> 标签：java, multithreading, producer-consumer

我正在尝试协调生产者和消费者线程问题。生产者将 10 个对象放入队列中。那就是生产者的 run 方法只包括一个简单的循环来添加 10 个对象然后它就完成了。当队列已满（队列大小为 10）时，会在队列的 add 方法中调用 wait() ->。在消费者方面，消费者首先查看对象，然后开始删除它们。我遇到的问题是，在大约 50% 的情况下，当程序运行时，输出会在生产者将 10 个对象放入队列后终止。其他 50% 的时间程序运行良好 - 即消费者取下所有物品。我之前对这个问题的解决方案是在生产者的 run 方法中创建一个新的消费者线程。所以一旦生产者将十个对象放入队列中，创建了新的消费者线程，我使用 join() 来同步操作。但是我想让这个过程与等待和通知一起工作。有人可以告诉我我做错了什么吗？谢谢

```
 @Override
    public synchronized boolean add(Process element) {
    if(isFull())
    {
        waitForNotify();
    }

    else
    {          

       queue.add(element);

    }
    return true;
}

    private void invokeNotify() {
    try {
        notify();
    } catch (Exception e) {
        e.printStackTrace();
    }

}

    private void waitForNotify() {
    try {
        wait();
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

}

     @Override
     public synchronized boolean offer(Process element) throws IllegalStateException {
       queue.add(element);
       this.queue = newHeapSort.heapify(queue, queue.size());
       return true;

}

    @Override
    public synchronized Process peek() {
    if(queue.isEmpty())
    {
        waitForNotify();
    }
    return(queue.get(0));

}

    @Override
    public synchronized Process head() {    
    if(queue.isEmpty()) 
    {
        invokeNotify();
    }

        Process head = queue.get(0);
        queue.remove(0);

        return head;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:35:36.130

生产者从不通知消费者线程。所以如果消费者是第一个开始的，它会发现队列是空的，然后永远等待。

我会简单地使用一个 BlockingQueue，它会为你做到这一点。

如果你真的想使用`wait()`and `notify()`，你需要：

*   在您的呼叫周围使用循环`wait()`，如果唤醒条件不成立，则返回等待状态
*   决定生产者何时应该通知（通常是在将项目放入队列时）
*   决定消费者何时应该通知（通常，当它从队列中删除一个项目时）
*   决定消费者何时应该等待（通常，当队列为空时）
*   决定生产者何时应该等待（通常，当队列已满时）
*   停止忽略 InterruptedException。只是让他们传播。

我会使用`notifyAll()`，如果有多个生产者或消费者，这也将确保一切正常。

# html - 如何在没有 id 或 class 的情况下更改 CSS 样式

> ID：13533258
> 
> 赞同：0
> 
> 时间：2012-11-23T17:04:42.307
> 
> 标签：html, css, xhtml

我想更改此 2 链接的背景 `<a href="http://www.domain.com/index.html"> <a href="http://www.domain.com/index.php">` 但条件是我无法在此处添加任何类或 Div id。我也不能触摸这个 html 代码。只是我需要从外部添加一些 CSS。我的意思是在主要的 style.css 表中。有可能吗？我已经尝试过使用这段代码`a { background:url(../images/image.png);}`，但问题是它改变了整个链接的页面背景。但我想要 2 个链接的 2 个不同背景。是真的有可能。任何人都可以帮助我：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:09:17.563

您可以使用 CSS 属性选择器仅对带有与您提供的链接匹配的 href 的链接进行样式设置。例子：

```
a[href="http://www.domain.com/index.html"],
a[href="http://www.domain.com/index.php"]{
    background:url(../images/image.png);
} 
```

您还可以使用以下规则匹配所有带有以[http://www.domain.com](http://www.domain.com)**开头** 的 href 的链接

```
a[href^="http://www.domain.com"]{
    background:url(../images/image.png);
} 
```

请检查支持，因为旧版浏览器可能会忽略属性选择器。

[http://css-tricks.com/attribute-selectors/](http://css-tricks.com/attribute-selectors/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:09:21.990

您需要找到一种方法来**区分**这两个链接，从您发布的代码中，它们仅在它们指向的 url 上有所不同，因此您可以使用它：

```
/* anchors with href attribute ending in index.html */
a[href$='index.html'] { background:url(../images/image.png);}

/* anchors with href attribute ending in index.php */
a[href$='index.php'] { background:url(../images/image2.png);} 
```

# c# - 为什么 Visual Studio 2012 找不到我的测试？

> ID：13533259
> 
> 赞同：222
> 
> 时间：2012-11-23T17:04:43.270
> 
> 标签：c#, .net, visual-studio, unit-testing

我有一些使用内置的测试`Microsoft.VisualStudio.TestTools.UnitTesting`，但无法让它们运行。

我正在使用 Visual Studio 2012 Ultimate。

我有两个项目的解决方案；一个在类之前有测试， `using Microsoft.VisualStudio.TestTools.UnitTesting`在测试方法和参考之前（版本 10.0.0.0，运行时版本 v2.0.50727）。我已经尝试过 dot-net framework 3.5、4 和 4.5，其他版本给出了重新定位错误。`[TestClass]``[TestMethod]``Microsoft.VisualStudio.QualityTools.UnitTestFramework`

我试图构建解决方案和项目。测试资源管理器有消息“构建您的解决方案以发现所有可用的测试。单击“全部运行”以构建、发现和运行解决方案中的所有测试。

所以问题是：如何让 Visual Studio 找到测试？

* * *

也尝试过这样做：http: [//msdn.microsoft.com/en-US/library/ms379625%28v=VS.80%29.aspx](http://msdn.microsoft.com/en-US/library/ms379625%28v=VS.80%29.aspx)但没有成功：当被要求时，我陷入了入门部分右键单击并选择`create tests`。没有`create tests`。

* * *

我有这个测试（它编译，但没有出现在测试资源管理器中）：

```
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace tests {
    [TestClass]
    public class SimpleTest {
        [TestMethod]
        public void Test() {
            Assert.AreEqual("a","a", "same");
        }
    }
} 
```

* * *

我现在发现（请参阅下面已删除的答案）这是因为它位于共享驱动器上，但我还不知道如何解决它。（可能是关于安全设置的一些东西）。

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-04-20T05:10:13.920

我有相同的症状，但在不同的情况下。

我不得不在 Peter Lamberg 的解决方案中添加一个额外的步骤——清理您的解决方案/项目。

我的单元测试项目针对 x64。当我创建项目时，它最初是针对 x86 的。

切换到 x64 后，我所有的单元测试都消失了。

我必须进入测试菜单-> 测试设置-默认处理器架构-> x64。

他们仍然没有出现。

做了一个构建。

还是没有出现。

终于做了一个清洁

然后他们出现了。

我发现清洁解决方案和清洁对于在设置更改时获得解决方案来打球非常有用。有时我不得不走极端，删除`obj`和`bin`目录并进行重建。

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2013-01-23T20:59:21.383

请将关键字**public**添加到您的类定义中。您的测试类目前在其自己的程序集之外不可见。

```
namespace tests {
    [TestClass]
    public class SimpleTest {
        [TestMethod]
        public void Test() {
            Assert.AreEqual("a","a", "same");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2013-03-20T15:56:42.353

这有时有效。

检查测试菜单下的处理器架构是否与您用于构建解决方案的架构相匹配。

测试 -> 测试设置 -> 默认处理器架构 -> x86 / x64

如其他帖子中所述，请确保您打开了测试资源管理器窗口。测试 -> Windows -> 测试资源管理器

然后使用测试重建项目应该使测试出现在测试资源管理器中。

编辑：正如Ourjamie 在下面指出的那样，进行干净的构建也可能会有所帮助。除此之外，我还遇到了一件事情：

对于我在解决方案下创建的新测试项目，在配置管理器中未选中“构建”复选框。

转到构建 -> 配置管理器。确保您的测试项目为所有解决方案配置和解决方案平台选中了构建复选框。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-04-23T12:21:42.277

我有 Visual Studio 2012，但在测试资源管理器中看不到测试，

所以我安装了以下内容： [NUnit Test Adapter](http://visualstudiogallery.msdn.microsoft.com/6ab922d0-21c0-4f06-ab5f-4ecd1fe7175d)

这为我解决了这个问题！

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2014-01-29T11:37:29.327

根据我最近的经验，上述所有方法均无效。我的测试方法

```
public async void ListCaseReplace() { ... } 
```

没有出现，但编译正常。当我删除`async`关键字时，测试出现在测试资源管理器中。这是因为`async void`是一种“即发即弃”的方法。制作方法`async Task`，您将获得测试！

此外，没有将测试项目的配置设置为“构建”也会阻止测试显示。配置管理器 > 检查您的测试以构建。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-08-08T04:42:47.150

由于该项目位于共享驱动器上，如原始海报所示。VS.NET 在加载和运行测试程序集之前需要信任网络位置。[阅读这篇博文](http://gunnalag.com/2011/03/23/adding-network-paths-as-trusted-locations-in-vs-net/)。

要允许 VS.NET 加载网络共享的内容，需要将它们（共享）添加到受信任的位置。要将位置添加到完整信任列表运行（显然根据您的环境需要进行修改）：

```
 caspol -m -ag 1.2 -url file:///H:/* FullTrust 
```

要验证或列出现有的受信任位置，请运行：

```
 caspol -lg 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-08-02T23:01:52.037

我发现的一个问题是，如果解决方案在网络驱动器/网络位置/共享驱动器上运行，则在测试资源管理器中找不到测试（没有显示）

您可以通过添加环境变量来解决此问题。

COMPLUS_LoadFromRemoteSources 并将其值设置为 1

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-04-19T04:20:40.580

我收到了错误：`"Failed to initialize client proxy: could not connect to vstest.discoveryengine.exe."`

尝试以管理员身份运行 Visual Studio。这对我有用。

[还有另一个 Stack Overflow 帖子讨论了这个错误](https://stackoverflow.com/q/17664886/590790)，同样的解决方案也适用于他们。问题仍然是为什么这有效。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-06-19T08:43:06.207

我有同样的问题。在我的情况下，它是由**私有财产** `TestContext`引起的。

将其更改为以下有助于：

```
public TestContext TestContext
{
    get;
    set;
} 
```

在清理和构建解决方案后（如@Ourjamie 的回答中所述），受影响的测试类中的测试方法在测试资源管理器中可用。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-09-24T01:04:14.183

我在尝试在网络共享上打开解决方案时遇到了同样的问题。在这种情况下，测试资源管理器不会检测到任何单元测试。解决方案原来是：

控制面板 -> Internet 选项 -> “安全”选项卡 -> 单击“Intranet”，将保存网络共享的服务器 IP 地址或主机名添加到“站点”列表。

完成此操作后，我重新编译了解决方案，现在出现了测试。这应该与@BigT 的答案非常相似。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-03-18T10:16:51.177

用于解决一些常见测试问题的快速检查列表。确保：

1.  测试类和测试方法是`public`
2.  测试类有`[TestClass]`属性
3.  测试方法有`[TestMethod]`属性

如果这没有帮助，请尝试清理、重建解决方案并重新启动 Visual Studio。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-08-01T08:37:17.687

我有时也会出现同样的症状。

我所做的是：
1\. 关闭测试资源管理器窗口
2\. 清理解决方案
3\. 重建解决方案
4\. 从测试 -> Windows -> 测试资源管理器重新启动测试资源管理器窗口。

我在测试资源管理器窗口中进行了测试。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-11-23T17:31:50.193

从顶部的菜单栏...

测试 -> 运行 -> 所有测试

您还可以从测试资源管理器查看所有测试（测试 -> Windows -> 测试资源管理器）

进一步使用 VS 2012，如果您错过任何内容，请尝试使用右上角的快速启动栏（Ctrl + Q）“测试”进行搜索

希望这可以帮助。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-04-24T15:48:36.357

我发现解决此问题的最佳方法是创建一个 .proj msbuild 文件并将您遇到问题的单元测试项目添加到此文件中，并使用 mstest 的命令行版本执行测试。我在我的 app.config 中发现了一个小配置问题，该问题仅在从 mstest 运行测试时出现 - 否则测试项目构建得很好。此外，您还会发现此方法的任何间接参考问题。一旦你可以使用 mstest 从命令行运行单元测试，你就可以做一个干净的解决方案，重建解决方案，你的测试应该被正确地发现。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-03-26T15:49:06.817

就我而言，这是另一回事。我已经安装了一个软件包，然后将其卸载并重新安装了早期版本。`configuration/runtime/asssemblyBinding/dependencyIdentity`这在我的 app.config 中留下了残留的重定向。我不得不纠正它。我通过查看`Output`窗口并`Tests`在下拉菜单中选择“”来解决这个问题。错误消息在那里。这很痛苦......我希望它可以帮助别人。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-10-07T15:39:39.980

这更多的是帮助最终来到这里的人，而不是回答 OP 的问题：

尝试关闭并重新打开视觉工作室，对我有用。

希望这可以帮助某人。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-08-31T19:34:36.743

我知道这是一个较老的问题，但在 Visual Studio 2015 中，我遇到了新创建的测试类无法识别的问题。什么都试过了。最终的问题是该课程没有“包含在项目中”。我只是在重新启动 Visual Studio 并注意到我的测试类不存在时才发现这一点。在显示隐藏文件时，我看到它以及我编写的其他类都没有包括在内。希望有帮助

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-12-09T11:01:30.223

当我尝试在另一台 PC 中构建解决方案时，我多次遇到此问题。

我也在使用 NUnit 和 Specflow。默认情况下，我的测试项目以 X86 为目标，但我必须将其更改为 X64。步骤是 1\. 测试菜单 -> 测试设置 - 默认处理器架构 -> x64。2\. Clean Build 3\. Build 4\. 如果仍然没有出现测试。5\. 转到工具  扩展和更新，然后安装 NUnit 和 Specflow 库 6\. 清理构建 7\. 构建

然后通常测试会出现在测试编辑器中。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-09-17T15:15:02.270

我已将 VS 2012 更新为最新更新。即视觉工作室更新3。这解决了我的问题。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-12-26T17:10:44.367

对我来说，解决方案稍微简单一点。

我刚刚在我的机器上引入了一个现有的解决方案（从 gi​​tHub 克隆），我们不跟踪 Visual Studio 创建的自动生成的 .cs 文件。（对于每个功能文件，都有一个同名的 .cs 文件）

在没有关联 .cs 文件的情况下打开解决方案实际上允许我导航到绑定的方法，因此看起来好像 specflow 已正确连接，但我无法在测试资源管理器中查看测试名称。

对于这个问题，只需从项目中排除功能文件，然后重新包含它们，强制 VS 重新生成这些自动生成的代码隐藏文件。

之后，我能够在测试资源管理器中查看测试。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-01-18T22:33:52.790

在将我的解决方案从 Microsoft Visual Studio 2012 Express for Web 升级到 Microsoft Visual Studio 2013 时，我遇到了这个问题。

我在 2012 年创建了一个单元测试项目，在 2013 年打开后，单元测试项目不会在测试资源管理器中显示任何测试。每次我尝试运行或调试测试它都失败了，在输出窗口中说以下内容：

```
 Failed to initialize client proxy: 
    could not connect to vstest.discoveryengine.x86.exe 
```

我还注意到，在调试测试时，它正在启动 Visual Studio 2012 的实例。这让我了解到单元测试项目仍在引用 2012 的事实。查看测试项目参考，我意识到它针对的是错误的 Microsoft Visual此版本 Visual Studio 的 Studio 单元测试框架 DLL：

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\PublicAssemblies\Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll 
```

我将版本号从 11.0 更改为 12.0：

```
C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\PublicAssemblies\Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll 
```

我重建了所有，这解决了这个问题 - 所有测试都在测试资源管理器中找到，现在所有测试都找到并完美运行。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-01-22T10:12:35.047

检查您的测试项目是否**未**在项目属性 -> 签名中设置为**仅延迟签名。**如果是，请取消选择它并进行干净的重建。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-01-22T11:04:25.597

我在尝试在 VS2013 Ultimate 的网络共享上打开解决方案时遇到了同样的问题。

我通过打开解决了问题

控制面板 -> Internet 选项 -> “安全”选项卡 -> 单击“本地 Intranet”，单击站点并确保勾选“自动检测 Intranet 网络”。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-03-20T18:13:16.680

这些都是很好的答案，但我知道还有一个原因；我刚碰到它。在我的一项测试中，我收到一条 ReSharper 消息，表明我有一个未使用的私人课程。这是我将在即将到来的测试中使用的课程。这实际上导致我**所有**的测试都消失了。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2014-06-03T19:09:12.973

检查引用的程序集是否有任何可能将“复制本地”设置为“假”的程序集。

如果您的测试项目构建到它自己的文件夹（例如 bin/Debug）并且该项目依赖于另一个程序集，并且“引用”列表中的这些程序集之一被标记为 Copy Local = "False"，则由于缺少依赖项和构建后您的测试将不会加载。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2014-09-05T22:42:13.127

这里的解决方案都没有帮助我。一个解决方案不会发现测试，而引用相同项目的另一个解决方案工作正常。**我终于通过删除 solutionname.v12.suo 文件解决了这个问题。**

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-12-17T23:57:56.023

看起来 NUnit Framework 2.6.4 不适用于 NUnit 测试适配器。在网站中，它提到测试适配器仅适用于 NUnit Framework 2.6.3。

这是我的问题： 1.我在VS2012中通过Nuget分别下载了NUnit和NUnit Test Adapter。不知何故，NUnit 更新到 2.6.4 突然我没有看到我的测试用例列出来。

使固定：

1.  卸载 Nuget 和 Nuget 测试适配器

    一种。转到工具> Nuget > Nuget Pkg 管理器> 管理 Nuget Pkg 以获取解决方案

    湾。列出已安装的软件包

    C。点击管理

    d。取消选中您的项目

2.  安装 NUnit 测试适配器，包括 NUnit 2.6.3 框架

3.  清洁/重建解决方案

4.  打开测试 > 测试资源管理器 > 全部运行

我看到了所有的测试用例

希望这可以帮助

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2015-10-15T04:36:32.160

我有同样的问题，但有点不同。

我使用的是 Visual Studio 2012。出于某种原因，只有初始生成文件的测试正在运行。但是另一个文件中的测试没有运行。尝试了此处发布的不同解决方案，但没有奏效。

最后我发现我在测试类中有一个私有方法，这是类中的第一个方法。*我只是在测试方法之后*移动了私有方法；所以现在，具有`[TestMethod]`属性的方法是类中的**第一个**方法。奇怪，但现在可以了。

希望有一天这对某人有所帮助。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2015-12-11T22:39:39.810

测试不喜欢异步方法。例如：

```
 [TestMethod]
    public async void TestMethod1()
    {
        TestLib oLib = new TestLib();
        var bTest = await oLib.Authenticate();

    } 
```

这样做之后：

```
 [TestMethod]
    public void TestAuth()
    {
        TestMethod1();
    }

    public async void TestMethod1()
    {
        TestLib oLib = new TestLib();
        var bTest = await oLib.Authenticate();

    } 
```

它看到了测试。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2016-01-13T21:11:28.027

添加我的答案，因为这是 Google 上的最佳结果。

我正在使用 Visual Studio 2015 并且（不知不觉 - 我刚刚跑了`Install-Package NUnit`）将 NUnit3 包 NuGet 安装到我的测试项目中。我已经安装了 NUnit 测试适配器扩展，但我的测试仍然没有出现。

通过 Tools > Extensions and Updates 安装 NUnit3 测试适配器为我解决了这个问题。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-10-01T16:07:51.670

我尝试了以上所有方法，但我的 Visual Studio 2012 仍然没有显示测试。最后，我去了一个测试类，发现它有一个 RootNamespace.FolderName，我删除了 .FolderName 以将该类放在根命名空间中，然后所有测试都回来了！

直到前几天才明白为什么它可以在原始命名空间中正常工作。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-02-12T08:10:11.237

我复制粘贴了方法声明，其中包括一个输入字符串参数。忘记删除输入参数。

```
 public void ExtractValueFromLineTest(string input) {}//test not discovered because of the string input param 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2014-05-22T20:53:26.780

这个只是咬了我一口。我在我的项目中添加了一个测试，但无法让它显示在测试资源管理器中。我的旧测试都出现了。最后，我意识到我只是在查看一个特定的播放列表，并没有将新测试添加到播放列表中。如果您正在使用播放列表，请选择“所有测试”并查看 VS 是否找到您的测试并在测试资源管理器中显示它们。然后，您也可以将它们添加到所需的播放列表中。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2014-06-27T15:14:48.290

Visual Studio Professional 2012，此处更新 4。在与测试类相同的项目中具有互操作函数定义（DllImport/extern）会使测试资源管理器感到困惑。将 Interop 移到一个单独的项目中，解决了这个问题。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2014-08-04T11:17:29.453

我在 VS2013 Ultimate 中遇到了同样的问题。我的问题是我正在创建 Windows 服务并忘记卸载它。所以服务正在运行，VS 无法访问导致整个测试套件根本没有加载的 DLL 之一。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2014-10-06T13:49:44.590

这是根据用户错误/愚蠢添加到列表中的另一个....我尝试了这个问题的各种答案，然后意识到我的测试项目在配置管理器（构建菜单，配置管理器）中没有被选中，所以它不是建成 >.<

发布此消息是希望它可以节省像我刚才那样浪费一两个小时的人！

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2015-03-03T02:58:16.043

我在 Windows 7 SP1 x64 上的 Visual Studio 2013 Update 4 中使用针对“任何 CPU”平台配置的测试项目遇到了同样的问题。

问题是测试项目实际上被命名为“测试”，并且会在项目第二次（重新）构建时消失。

例如，在我将项目重命名为“MyProject.Tests”后，测试不再消失。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2015-03-16T23:02:01.533

我反复遇到的一个问题是没有在 Windows 8+ 上以管理员身份（明确）运行 Visual Studio。我尝试了列出的几个建议，但在我以管理员身份运行 VS 2013 之前，它们并没有显示单元测试（即使我的快捷方式设置为以这种方式打开 VS，要么打开解决方案文件，要么有时单击它没有的快捷方式'实际上并没有以管理员身份打开）。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2015-03-19T18:34:04.247

由于这些答案都没有解决我遇到的原因，因此对于这个问题，我也会在这里添加我的答案。

就我而言，这是一个复制粘贴代码问题。我们有一个`TestProjectA`特定类型的测试，我们想将其提取到它自己的测试项目中 - `TestProjectB`. 现在的问题是，虽然测试`TestProjectA`继续显示得很好，但新的测试`TestProjectB`没有显示在 VS 测试资源管理器中 - 除非您专门构建`TestProjectB`或手动右键单击那里的测试并运行它。

原因是在复制粘贴代码时，一些命名空间没有得到更新：

*   名称空间中有一个带有文件路径的`TestMethodA()`in`TestClassA``TestProjectA.ModuleA``\TestProjectA\TestClassA.cs`
*   以及带有文件路径的命名空间中的`TestMethodA()`in`TestClassB``TestProjectA.ModuleA``\TestProjectB\TestClassB.cs`

因此，Visual Studio 在输出窗口中打印出一条消息，表明这两个的 TestId 相同，并且由于两个项目之间的 TestId 冲突，因此继续显示`TestProjectA`而不是在测试资源管理器中。`TestProjectB`更正命名空间以`TestProjectB.ModuleB`解决`\TestProjectB\TestClassB.cs`问题。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2015-05-12T08:18:43.120

这个问题好像有这么多不同的解决方案不妨加上我自己的：

关闭 Visual Studio

将 C:\Users\username\AppData\Local\Microsoft\VisualStudio\12.0\ComponentModelCache 重命名为 ComponentModelCache.old

运行 Visual Studio，组件缓存将被重建。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2015-09-03T10:09:25.093

另一个可能阻止发现测试的问题，通常在“测试”输出窗口中显示一条消息，例如：

```
无法配置运行设置插件“VSTest 运行配置”的设置，因为它引发了以下异常：
'解析 EntityName 时发生错误。第 1 行，第 8 位。
请联系插件作者。

```

这可能是由于路径或文件名中包含需要转义才能解析为 xml 的字符引起的。特别是**&**字符，因为目录或文件名中不允许使用**<**和**> 。**这会导致测试发现失败并且无法识别测试，但我仍然可以通过单击边距使用 Resharper 手动运行测试。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2015-10-22T21:41:17.890

在谷歌搜索“visual studio 看不到测试”之后，它把我带到了这里，所以我想我会分享我的问题。我可以构建我的解决方案，并且测试存在，但我**看不到**它们！原来我们这是 IDE 的一个怪癖，导致了这个问题。有关解释和修复，请参见下图：

[![在此处输入图像描述](../Images/f82cf43306f3edda4c4910510cf8b6d5.png)](https://i.stack.imgur.com/W44xL.png)

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2015-12-22T06:17:42.633

您可以做的最简单的事情是，只需将这些文件从文件资源管理器拖放到测试项目。再次构建项目，一切顺利！

或者

在文本编辑器中打开`.csproj`测试项目的文件并手动包含要编译的文件名。在文件中搜索`Compile`标签并添加您要运行的文件。

```
<ItemGroup>
    <Compile Include="TestSettings.cs" />
    <Compile Include="TestLibrary.cs" />
    <Compile Include="UnitTest1.cs" />
</ItemGroup> 
```

为您的文件添加编译标签并保存。现在运行测试。您的带有单元测试的文件将被检测并运行。

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2015-12-22T23:13:43.300

问题是测试运行器被配置为不从远程驱动器运行测试。当我将项目复制到本地驱动器时，它运行良好，但我需要它在共享驱动器上（不记得为什么）。

我读到它可以配置为在共享驱动器上工作，但是当我发现我在 Debian 上切换到 MonoDevelop 的解决方案时，我从来没有这样做过。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2016-05-26T03:15:36.460

我阅读了所有现有的答案，发现我的（xUnit）测试没有被发现，因为我删除了“未使用”的引用，更具体地说，`xunit.execution.desktop`. 重新安装 xUnit 包解决了我的问题。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2016-12-09T07:54:03.553

Visual Studio 2015 (v.14 .....) - 这里有同样的问题

原因：不同版本的 NUnit 和 NUnit 测试适配器在我的情况下，我拥有 NUnit (3.5) 和 NUnit 测试适配器的最新版本，但测试适配器不是正确的。对于 NUnit 3 及更高版本，必须使用 NUnit3TestAdapter

解决方案：卸载“有故障”的 NUnint 测试适配器并安装 UNIt3TestAdapter v.3.5.0（现在最新的是 3.6.0 但没有使用它以保持与 NUnit 相同）

在弹出解决方案测试的重建后:)

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2017-04-26T18:23:49.900

就我而言，我有 3 个使用 Visual Studio 2017 创建的测试项目（但我认为没关系），其中只有两个是由测试资源管理器发现的。我意识到第三个项目有不同版本的`Microsoft.VisualStudio.QualityTools.UnitTestFramework`dll。我在 NuGet 管理器中更新了它并出现了测试。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2018-04-23T12:02:05.533

我们使用的是 xunit，解决方案对我有用，团队正在删除文件夹 %TEMP%\VisualStudioTestExplorerExtensions

阅读此线程。

[为什么 Visual Studio 2015/2017 Test Runner 没有发现我的 xUnit v2 测试](https://stackoverflow.com/questions/35103781/why-is-the-visual-studio-2015-2017-test-runner-not-discovering-my-xunit-v2-tests)

* * *

## 回答 #49

> 赞同：-1
> 
> 时间：2012-11-23T17:47:24.740

您可以右键单击测试方法并选择运行测试/运行单元测试选项。那应该会打开测试窗口。

# mysql - N:N 关系 Mysql

> ID：13533260
> 
> 赞同：1
> 
> 时间：2012-11-23T17:04:48.980
> 
> 标签：mysql

> **可能重复：**
> [多对多关系中的问题](https://stackoverflow.com/questions/4792883/problem-in-many-to-many-relationship)

我有一张电影表和一张类别表。我想为一部电影再注册一个类别。和几部电影的类别。也就是说，一个关系N：N。我如何在php和Mysql中做到这一点？

例如：类别 1 -> 电影 1 和电影 2

电影 2 -> 类别 1 和类别 2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:07:21.807

对于[多对多关系](http://en.wikipedia.org/wiki/Many-to-many_%28data_model%29)，您需要第三个表，称为[联结表。](http://en.wikipedia.org/wiki/Junction_table)

所以它看起来像这样

```
Movie
id | desc

Category
id | desc

MoviesCategories
id | movieID | categoryId 
```

您的选择将打开`MoviesCategories`，看起来像这样

```
SELECT * 
FROM
 MoviesCategories INNER JOIN Category ON MoviesCategories.CategoryId = Category.Id 
                  INNER JOIN movie ON MoviesCategories.MovieID = Movie.ID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:07:06.363

你需要一个表来处理这种关系。像这样：

```
MovieToCategory
    ID
    CategoryID
    MovieID 
```

或者，您可以创建一个复合主索引，仅允许每部电影进行一次类别组合：

```
MovieToCategory
    CategoryID
    MovieID 
```

# iphone - Alpha 混合在 iPhone/Pad 上看起来错误/不同

> ID：13533263
> 
> 赞同：1
> 
> 时间：2012-11-23T17:04:55.533
> 
> 标签：iphone, ios, xcode, ipad, opengl-es-2.0

我正在绘制一些 alpha 混合精灵。我使用 D3D 和 OpenGL 在 Win32 上渲染相同的资产，当顶点颜色为 0xFFFFFF 且背景颜色为 0xC0D0E0 时，正确的结果如下所示

![帽1](../Images/b23fc78c16fc63f1652de388c2ce5b38.png)

在 Win32/OpenGL 我启用混合如下：

```
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glEnable(GL_BLEND); 
```

在 Win32/D3D 上如下：

```
CD3D11_BLEND_DESC blendDesc(D3D11_DEFAULT);
D3D11_RENDER_TARGET_BLEND_DESC rtBlendDesc;
rtBlendDesc.BlendEnable = true;
rtBlendDesc.BlendOp = D3D11_BLEND_OP_ADD;
rtBlendDesc.BlendOpAlpha = D3D11_BLEND_OP_ADD;
rtBlendDesc.DestBlend = D3D11_BLEND_INV_SRC_ALPHA;
rtBlendDesc.DestBlendAlpha = D3D11_BLEND_ZERO;
rtBlendDesc.RenderTargetWriteMask = D3D11_COLOR_WRITE_ENABLE_ALL;
rtBlendDesc.SrcBlend = D3D11_BLEND_SRC_ALPHA;
rtBlendDesc.SrcBlendAlpha = D3D11_BLEND_ZERO;
blendDesc.RenderTarget[0] = rtBlendDesc;
gDevice->CreateBlendState(&blendDesc, &mBlendState); 
```

然后，在渲染时：

```
gContext->OMSetBlendState(mBlendState, NULL, 0xffffffff); 
```

在 Win32/OpenGL 上我使用固定函数管道，在 DX11 上我使用非常简单的垂直/像素着色器：

```
float4 SpritePixelShader(PS_INPUT input) : SV_Target
{
    return (txDiffuse.Sample(samLinear, input.Tex)) * input.Col;
}

PS_INPUT SpriteVertexShader(VS_INPUT input)
{
    PS_INPUT output = (PS_INPUT)0;
    output.Pos = mul(float4(input.Pos.x, input.Pos.y, 0.5, 1.0), projection);
    output.Tex = input.Tex;
    output.Col = input.Col;
    return output;
} 
```

一切都很好。OpenGL 和 D3D 给了我相同的结果。

在 iPhone 模拟器上的 OpenGL ES 2.0 上（不确定这是否是模拟器的东西，我还不能在设备上测试）：

我启用了类似的混合：

```
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glEnable(GL_BLEND); 
```

我的片段/顶点着色器类似：

```
// fragment shader
void main()
{
    gl_FragColor = color * texture2D(s_texture, texCoord);
}

// vertex shader
void main()
{
    color = vertexColor;
    texCoord = vertexTexCoord;
    gl_Position = matrix * vec4(vertexPosition, 0, 1);
} 
```

但我明白了：

![帽2](../Images/502ec829dbf23ac9d20d6a7b3d823193.png)

这似乎是使用调制而不是加法。我试过打电话：

```
glBlendEquation(GL_FUNC_ADD); 
```

但这似乎没有任何作用，也没有

```
glBlendEquationOES(GL_FUNC_ADD_OES); 
```

如果我使用：

```
glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA); 
```

然后它看起来正确，但顶点颜色的 alpha 分量被忽略（我需要使用它）。

有没有人有任何想法？

谢谢！查理。

# php - 在 php 中从 Mysql 获取当前用户 ID

> ID：13533271
> 
> 赞同：1
> 
> 时间：2012-11-23T17:05:25.283
> 
> 标签：php, mysql, login

我创建了一个用户数据库，用户拥有`username`等等`password`。每个人都有一个唯一的`auto_increment`ID。我需要这个; 例如，如果我登录到该网站，它应该是`$id= my_id`，如果你登录到该网站，它应该是`$id= your_id`。你能帮忙吗？谢谢。

我试过;

```
$result = mysql_query("select id from Users where username ='".$_SESSION['username']."'"); 
```

`$row = mysql_fetch_array($result);`

```
$id = $row['id']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:08:41.367

在您的登录代码中（当您定义 时`$_SESSION['username']`），您应该将用户 ID 与您需要的任何其他用户相关数据一起存储在会话中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:14:03.040

两个用户不应该有相同的用户名，即使他们有不同的 user_ids。

您需要一些有关创建注册/登录系统的背景帮助。这将是一个很好的资源，对您有很大帮助：[phpacademy.org 登录/注册教程](http://www.youtube.com/course?list=ECE134D877783367C7)

请记住对任何对您有帮助的帖子进行投票，并在您满意时为您的问题选择一个答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:25:03.183

在您的登录检查查询中添加 id 字段。如果登录成功，则在会话中设置该数据或返回登录功能。你得到 id 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:22:43.827

**还将用户 ID**存储到`$_SESSION`数组中，以便在每个请求中都可以访问您的用户 ID，使用您的查询将如下所示

```
 $result = mysql_query("select username from Users where id ='".$_SESSION['id']."'"); 
```

# wpf - 扩展的 WPF 工具包 DoubleUpDown

> ID：13533274
> 
> 赞同：0
> 
> 时间：2012-11-23T17:05:31.760
> 
> 标签：wpf, xaml

我添加了一个扩展的 WPF 工具包 DoubleUpDown 控件。行为是，如果您键入 5.35 就可以了。然后假设您键入 4.3errortext7 并按 Tab 将其恢复为 5.35（因为 4.3errortext7 不是有效数字）。

但是，在这种情况下，我希望它只是转到 4.37（并忽略无效字符。有没有一种优雅的方法来获得我所需的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:48:48.353

我能想到的最好的方法是使用 PreviewTextInput 事件并检查有效输入，不幸的是它仍然允许数字之间有空格，但会阻止输入所有其他文本。

```
private void doubleUpDown1_PreviewTextInput(object sender, TextCompositionEventArgs e)
{
    if (!(char.IsNumber(e.Text[0]) || e.Text== "." ))
    {
        e.Handled = true;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T17:11:36.623

也许有点晚了，但我昨天遇到了同样的问题，而且我也不想每次使用控件时都注册一个处理程序。我将 Mark Hall 的解决方案与`Attached Behavior`（受这篇文章的启发：http: [//www.codeproject.com/Articles/28959/Introduction-to-Attached-Behaviors-in-WPF](http://www.codeproject.com/Articles/28959/Introduction-to-Attached-Behaviors-in-WPF)）混合：

```
public static class DoubleUpDownBehavior
{
    public static readonly DependencyProperty RestrictInputProperty = 
         DependencyProperty.RegisterAttached("RestrictInput", typeof(bool),
             typeof(DoubleUpDownBehavior), 
         new UIPropertyMetadata(false, OnRestrictInputChanged));

    public static bool GetRestrictInput(DoubleUpDown ctrl)
    {
        return (bool)ctrl.GetValue(RestrictInputProperty);
    }

    public static void SetRestrictInput(DoubleUpDown ctrl, bool value)
    {
        ctrl.SetValue(RestrictInputProperty, value);
    }

    private static void OnRestrictInputChanged(DependencyObject depObj, DependencyPropertyChangedEventArgs e)
    {
        DoubleUpDown item = depObj as DoubleUpDown;
        if (item == null)
            return;

        if (e.NewValue is bool == false)
            return;

        if ((bool)e.NewValue)
            item.PreviewTextInput += OnPreviewTextInput;
        else
            item.PreviewTextInput -= OnPreviewTextInput;
    }

    private static void OnPreviewTextInput(object sender, TextCompositionEventArgs e)
    {
        if (!(char.IsNumber(e.Text[0]) || 
           e.Text == CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator))
        {
            e.Handled = true;
        }
    }
} 
```

然后你可以像这样简单地设置默认样式`DoubleUpDown`：

```
<Style TargetType="xctk:DoubleUpDown">
    <Setter Property="behaviors:DoubleUpDownBehavior.RestrictInput" Value="True" /> 
</Style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-08T15:30:44.807

就我而言，使用正则表达式要好得多。

```
 private void UpDownBox_OnPreviewTextInput(object sender, TextCompositionEventArgs e)
    {
        var upDownBox = (sender as DoubleUpDown);
        TextBox textBoxInTemplate = (TextBox)upDownBox.Template.FindName("PART_TextBox", upDownBox);
        Regex regex = new Regex("^[.][0-9]+$|^[0-9]*[.]{0,1}[0-9]*$");
        e.Handled = !regex.IsMatch(upDownBox.Text.Insert((textBoxInTemplate).SelectionStart, e.Text));
    } 
```

# hbase - HBase 无法启动

> ID：13533283
> 
> 赞同：0
> 
> 时间：2012-11-23T17:06:11.183
> 
> 标签：hbase

[我正在按照有点简单的http://hbase.apache.org/book/quickstart.html](http://hbase.apache.org/book/quickstart.html)安装 Hbase 0.94.2 ，但它还没有工作。运行我在日志文件中得到的启动脚本：

```
2012-11-23 18:26:37,827 INFO org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/127.0.0.1:2181, sessionid = 0x1
3b2e17842c0002, negotiated timeout = 40000
2012-11-23 18:26:37,866 INFO org.apache.hadoop.ipc.HBaseRPC: Server at localhost/127.0.0.1:39699 could not be reached after 1 tries, giving up.
2012-11-23 18:26:37,867 WARN org.apache.hadoop.hbase.master.AssignmentManager: Failed assignment of -ROOT-,,0.70236052 to localhost,39699,135368
7992912, trying to assign elsewhere instead; retry=0
org.apache.hadoop.hbase.client.RetriesExhaustedException: Failed setting up proxy interface org.apache.hadoop.hbase.ipc.HRegionInterface to loca
lhost/127.0.0.1:39699 after attempts=1
.
.
.
2012-11-23 18:26:37,869 WARN org.apache.hadoop.hbase.master.AssignmentManager: Unable to find a viable location to assign region -ROOT-,,0.70236
052
2012-11-23 18:29:53,157 ERROR org.apache.hadoop.hbase.master.HMasterCommandLine: Failed to start master 
```

这是一个 Ubuntu 12.04 LTS VirtualBox，1GB 内存，10GB 可用磁盘空间，带有 Oracle JRE 1.6.0_37。

我发现了一些关于 /etc/hosts 的解决方法，但不确定它们是否相关。我的 etc/hosts 仅包含：

```
127.0.0.1   localhost
127.0.1.1   'my-host-name'

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters 
```

任何帮助或推荐到专门的 HBase 论坛将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T11:45:08.730

好的，这很简单，在 /etc/hosts 中只更改了 127.0\. **1** .1 至 127.0。**0** .1，所以现在本地主机名被解析为后者，而不是前者。Hbase 快速回答的论坛是[http://apache-hbase.679495.n3.nabble.com/](http://apache-hbase.679495.n3.nabble.com/)，在这里得到了很好的回答。不知道为什么这个改变是必要的。

# php - 导出 CSV 打印 HTML

> ID：13533285
> 
> 赞同：0
> 
> 时间：2012-11-23T17:06:17.143
> 
> 标签：php, csv

我正在尝试使用 PHP 导出 CSV。但不是打印结果，而是`Resource id #26`在生成的 CSV 文件中打印。如果我从末尾删除退出，它将打印我的整个 HTML 页面内容。我的代码是...

```
 if (isset($_REQUEST['download']) && ($_REQUEST['download'] == "yes")) {
            header('Content-Type: text/csv; charset=utf-8');
            header('Content-Disposition: attachment; filename=link_point_report.csv');
            $output = fopen('php://memory', 'w+');
            fputcsv($output, array('Member Id', 'Customer Name', 'Customer Email'));

            $customerListAll = $oAdmFun->linkpoint_check_customer('', '');       
             $oAdmFun->pr($customerListAll, true);
//                if (count($customerListAll) > 0) {
//                        for ($c = 0; $c < count($customerListAll); $c++) {
//                                fputcsv($output, array('Sankalp', 'Sankalp', 'Sankalp'));
//                        }
//                }

            ob_clean();
            flush();
            exit($output);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:10:09.963

那是因为 $output 是一种资源，这是[fopen()](http://ca1.php.net/manual/en/function.fopen.php)返回的。您需要使用[fread()](http://ca1.php.net/manual/en/function.fread.php)来获取其内容。

编辑：现在我明白你在问什么。要输出 CSV 的内容，您需要从资源中获取文本输出：

```
rewind( $output );
$csv_output = stream_get_contents( $output );
fclose( $output );
die( $csv_output ); 
```

[设置content-length](https://stackoverflow.com/questions/2773396/whats-the-content-length-field-in-http-header)标头也是一个好主意，以便客户端知道会发生什么：

```
header('Content-Length: ' . strlen($csv_output) ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:06:14.773

打开一块可写内存：

```
$file = fopen('php://temp/maxmemory:'. (12*1024*1024), 'r+'); // 128mb 
```

写入它...然后使用以下命令获取内容：

```
rewind($file);
$output = stream_get_contents($file);
fclose($file); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-12T07:05:59.863

```
function CSV_HtmlTable($csvFileName)
{
// better to open new webpage 
echo "<html>\n<body>\n\t<table style=''>\n\n";
$f = fopen($csvFileName, "r");
$trcount = 0; //start the row count as 0
while (($line = fgetcsv($f)) !== false) {
        $trclass = ''; if ($trcount%2==0) { $trclass=' class="dark"'; } //default to nothing, but if it's even apply a class
        echo "\t\t<tr".$trclass.">\n"; //same as before, but now this also has the variable $class to setup a class if needed
        $tdcount = 0; //reset to 0 for each inner loop
        foreach ($line as $cell) {
                $tdclass = ''; if ($tdcount%2==0) { $tdclass=' class="dark"'; } //default to nothing, but if it's even apply a class
                echo "\t\t\t<td ".$tdclass."style='padding:.4em;'>" . htmlspecialchars($cell) . "</td>"; //same as before, but now this also has the variable $class to setup a class if needed
                $tdcount++; //go up one each loop
        }
        echo "\r</tr>\n";
        $trcount++; //go up one each loop
}
fclose($f);
echo "\n\t</table>\n</body>\n</html>";

} 
```

# image - 如何从外部位置在 facelet 中渲染图像？

> ID：13533287
> 
> 赞同：0
> 
> 时间：2012-11-23T17:06:27.470
> 
> 标签：image, jsf, location, external

为了在模板客户端中使用 h:graphicImage 渲染简单的图像，我已经尽我所能。我的图像不在战争中，而是在同一个磁盘上的另一个位置。

实际上我没有显示“alt”属性或警告找不到图像。我的图像被找到并且可能被渲染为具有我在 h:graphicImage 中指定的宽度和高度的空框架。这个空框架有背景颜色。

有谁知道如何从外部位置渲染图像，因为我没有找到这个例子？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-20T14:33:44.883

最简单的方法是使用 OmniFaces o:graphicImage。使用从文件系统接受文件路径并返回 java.io.InputStream 的方法制作一个 javax.faces.bean.ApplicationScoped bean。像那样：

爪哇：

```
@Named
@ApplicationScoped
public class FileReader {

public InputStream getImageByPath(String filename) throws FileNotFoundException{
        return new FileInputStream(new File(filename));
} 
```

}

JSF：

```
<html xmlns:o="http://omnifaces.org/ui">

<o:graphicImage value="#{fileReader.getImageByPath('/opt/images/admin/112/IMG_1292.JPG')}"/> 
```

# image - 使用 CSS3 反射图像的一部分

> ID：13533289
> 
> 赞同：4
> 
> 时间：2012-11-23T17:06:31.933
> 
> 标签：image, html, css, webkit

目前我有这张图片：

![在此处输入图像描述](../Images/0fe7ca2a2d8b0c6c49f06cce9034d00e.png)

我被要求做的是给它这个效果：

![在此处输入图像描述](../Images/a5d563050951f18b2a30bb76700d576b.png)

忘记背景颜色 - 注意下面图像的一部分的反射，仍然是相同的颜色，但具有不透明风格的效果。

我曾尝试在 CSS3 中使用不透明度和 webkit-reflection，但没有运气。

我现在已经删除了该代码，因为它不起作用，我只剩下原始图像：

```
.infrareporting_host_0 {
    background: url("../interface/infrareporting/hostLightGreen.png") no-repeat scroll 0 0 transparent;
} 
```

**请记住：**

*   我只想要确切显示的内容 - 图像的下部反射，而不是整个图像反射
*   如何仅淡化反射图像的不透明度？正常的我想保持不变但淡化反射
*   跨浏览器解决方案是最好的（atm 我只能在 chrome 中做到这一点）

**更新**

到目前为止，我的代码**仅在 chrome**中正确反映，但不透明度无法正常工作。我有这个：

```
-webkit-box-reflect: below -3px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(.7, transparent), to(white)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:15:07.923

您可以执行以下操作：

**html：**

```
<div class="image-block">
   <img src="http://i.stack.imgur.com/mbf9p.png" alt="" />
   <div class="reflection">
      <img src="http://i.stack.imgur.com/mbf9p.png" alt="" />
      <div class="overlay"></div>
   </div>
</div>​ 
```

**CSS：**

```
.image-block { width:78px; margin:0px 10px; float:left; } 
.reflection { position:relative; } 
.reflection img { 
    -webkit-transform: scaleY(-1); 
       -moz-transform: scaleY(-1); 
        -ms-transform: scaleY(-1); 
         -o-transform: scaleY(-1); 
            transform: scaleY(-1); 
    filter: flipv; opacity:0.20; 
    filter: alpha(opacity='20'); 
} 
.overlay { position:absolute; top:0px; left:0px; width:78px; height:120px; 
    background-image: -moz-linear-gradient( center bottom, rgb(255,255,255) 60%, rgba(255,255,255,0) 75%); 
    background-image:   -o-linear-gradient( rgba(255,255,255,0) 25%, rgb(255,255,255) 40%); 
    background-image:     -webkit-gradient( linear, left bottom, left top, color-stop(0.60, rgb(255,255,255)), color-stop(0.75, rgba(255,255,255,0))); 
filter: progid:DXImageTransform.Microsoft.Gradient( gradientType=0, startColor=0, EndColorStr=#ffffff); 
} 
```

​</p>

在此处查看现场演示：[演示](http://jsfiddle.net/m7RYP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:12:25.113

您可以为此使用 CSS 3：

```
.reflect  { 
  -webkit-box-reflect: below 0
  -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(0.5, transparent), to(white)); 
} 
```

或者像这样的替代方案： [http ://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/cross-browser-css-reflections-glows-and-blurs/](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/cross-browser-css-reflections-glows-and-blurs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:09:30.673

### 使用此代码：

```
.infrareporting_host_0::before,
.infrareporting_host_0::after
{
  content: "";
  position: absolute;
  top: 100%;
  z-index: -1;
  width: inherit;
  height: inherit;
  display: block;
}

.infrareporting_host_0::before
{
  background: inherit;
} 
```

有关详细信息，请参阅跨浏览[器 CSS3 反射](http://blog.gface.com/2012/02/22/crossbrowser-css3-reflections/)。

# html - 页面内html页面的技术/方法名称？

> ID：13533290
> 
> 赞同：0
> 
> 时间：2012-11-23T17:06:43.353
> 
> 标签：html, jsf

当您在容器 html 中有一个包含的 html 页面时，是否有一个特定的名称，其中包含的页面会在不影响容器的情况下替换其内容（à la ajax）？
FYO，我想做的是在容器中有一个站点导航菜单，并根据用户的操作替换包含页面的内容。我正在使用 JSF。

# php - 检查 PHP 会话 - ISSET($SESSION - 不工作

> ID：13533296
> 
> 赞同：6
> 
> 时间：2012-11-23T17:07:14.693
> 
> 标签：php, session, login

这是我的页面，它应该检查用户是否登录 [http://carbonyzed.co.uk/Websites/Jason/sites/2/test/login_success.php](http://carbonyzed.co.uk/Websites/Jason/sites/2/test/login_success.php)

但任何人都可以评估它，而不仅仅是那些登录的人

```
<?php
session_start();
if( isset($_SESSION["myusername"]) ){
header("location:main_login.html");
}
?> 
```

我努力了

**if( isset($_SESSION["myusername"]) ){**

和

**if( isset($_SESSION[$myusername]) ){**

**登录代码**也许没有创建会话？

```
<?php

ob_start();
$host="ClubEvents.db.9606426.hostedresource.com"; // Host name 
$username="ClubEventsRead"; // Mysql username 
$password="Pa55word!"; // Mysql password 
    $db_name="ClubEvents"; // Database name 
$tbl_name="members"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// Define $myusername and $mypassword 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
    $myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);
$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){

// Register $myusername, $mypassword and redirect to file "login_success.php"
session_register("myusername");
session_register("mypassword"); 
header("location:login_success.php");
}
else {
echo "Wrong Username or Password";
}
ob_end_flush();
?> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-23T17:10:35.653

将 NOT 运算符添加`!`到 if 语句。也不要忘记`exit()`在你的标题之后添加。标`location`头告诉浏览器重定向，但攻击者可以查看您的页面并简单地忽略`location`标头，从而绕过您的身份验证系统，因为您的 PHP 代码将继续执行。

```
if( !isset($_SESSION["myusername"]) ){
    header("location:main_login.html");
    exit();
} 
```

此外，您没有调用`session_start()`您发布的登录代码，因此无法访问会话。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-23T17:09:36.220

```
<?php

session_start();
if (!isset($_SESSION['myusername']))
{
    header('Location: main_login.html');
}

?> 
```

你需要否定检查。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-23T17:11:48.443

您还可以使用：

```
<?php

session_start();
if (empty($_SESSION['myusername'])) {
    header('Location: main_login.html');
}

?> 
```

# c# - 启动 Chrome 时尝试传递空格

> ID：13533301
> 
> 赞同：2
> 
> 时间：2012-11-23T17:07:43.037
> 
> 标签：c#, google-chrome, process.start

我正在尝试从 ac# Windows 窗体启动 Chrome 的外部实例。只要本地 html 文件的路径中没有空格，它就可以正常工作。如果 Chrome 在第一个空格处停止。例如：“file:///C:/Users/user/Documents/Visual” 我试图通过用“%20”替换字符串中的空格来解决这个问题，就像 Chrome 通常做的那样。现在我得到这个乱码地址：“file:///C:/Users/user/Documents/Visual%2520Studio%2520%2012/TEMP.html”

这是我的代码片段：

```
string chromeTempFilePath = tempFilePath.Replace(" ", "%20");

Process.Start(browserPaths[2], chromeTempFilePath);//launch Chrome 
```

`Process.Start`在路径中有空格的 Firefox 和 IE 9 上都可以正常工作。任何帮助将不胜感激，因为我或多或少被难住了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:16:54.120

删除该`string.Replace`方法并将您的更改`Process.Start`为如下所示：

```
Process.Start(browserPaths[2], string.Format("\"{0}\"", chromeTempFilePath)); 
```

您只需将其全部用双引号括起来。这对我来说适用于 Chrome，但我没有检查其他浏览器。

# php - 当我在循环中添加一个额外的字段时，while 循环不起作用

> ID：13533302
> 
> 赞同：2
> 
> 时间：2012-11-23T17:07:44.003
> 
> 标签：php, mysql, mysqli

我在下面有这段代码：

```
 while ( $qrystmt->fetch() ) { 
          // data array
          $dataArray[$dbCourseId]['CourseName'] = $dbCourseName; 
          $dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleName'] = $dbModuleName; 
           // session data
          $_SESSION['idcourse'] = $dbCourseNo;
          $_SESSION['namecourse'] = $dbCourseName;

    } 
```

现在，当我尝试在 while 循环中显示 2 个字段时，上面的代码可以正常工作。但是当我尝试在 while 循环中添加第三个字段时，它似乎不起作用，并且它给了我一个错误说明 undefined `ModuleName`。

是不是我布置的方式导致了下面的while循环中的错误：

```
while ( $qrystmt->fetch() ) { 
          // data array
          $dataArray[$dbCourseId]['CourseName'] = $dbCourseName; 
          $dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleNo'] = $dbModuleNo ['ModuleName'] = $dbModuleName; 
           // session data
          $_SESSION['idcourse'] = $dbCourseNo;
          $_SESSION['namecourse'] = $dbCourseName;

    } 
```

完整的代码在下面，它从数据库中选择一门课程，然后选择与所选课程对应的模块：

```
 $sql = "SELECT CourseId, CourseNo, CourseName FROM Course"; 

 $sqlstmt=$mysqli->prepare($sql);

 $sqlstmt->execute(); 

 $sqlstmt->bind_result($dbCourseId, $dbCourseNo, $dbCourseName);

 $courses = array(); // easier if you don't use generic names for data 

 $courseHTML = "";  
 $courseHTML .= '<select name="courses" id="coursesDrop">'.PHP_EOL; 
 $courseHTML .= '<option value="">Please Select</option>'.PHP_EOL;  

 while($sqlstmt->fetch()) 
 {   
     $courseid = $dbCourseId;
     $course = $dbCourseNo;
     $coursename = $dbCourseName; 
     $courseHTML .= "<option value='".$courseid."'>" . $course . " - " . $coursename . "</option>".PHP_EOL;  
  } 

  $courseHTML .= '</select>'; 

    ?>

        <?php
if (isset($_POST['submit'])) {

$submittedCourseId = $_POST['courses'];

    $query = "
                 SELECT cm.CourseId, cm.ModuleId, c.CourseNo, m.ModuleNo,
                 c.CourseName,
                 m.ModuleName
                 FROM Course c
                 INNER JOIN Course_Module cm ON c.CourseId = cm.CourseId
                 JOIN Module m ON cm.ModuleId = m.ModuleId
                 WHERE
                 (c.CourseId = ?)
                 ORDER BY c.CourseName, m.ModuleId
                ";

    $qrystmt=$mysqli->prepare($query);
    // You only need to call bind_param once
    $qrystmt->bind_param("s",$submittedCourseId);
    // get result and assign variables (prefix with db)

    $qrystmt->execute(); 

    $qrystmt->bind_result($dbCourseId,$dbModuleId,$dbCourseNo,$dbModuleNo, $dbCourseName,$dbModuleName);

     $qrystmt->store_result();

    $num = $qrystmt->num_rows();

    if($num ==0){
        echo "<p style='color: red'>Please Select a Course</p>";
    } else { 

        $dataArray = array();

 while ( $qrystmt->fetch() ) { 
          // data array
          $dataArray[$dbCourseId]['CourseName'] = $dbCourseName; 
          $dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleName'] = $dbModuleName; 
           // session data
          $_SESSION['idcourse'] = $dbCourseNo;
          $_SESSION['namecourse'] = $dbCourseName;

    }

     foreach ($dataArray as $foundCourse => $courseData) {

          $output = ""; 

          $output .= "<p><strong>Course:</strong> " . $foundCourse .  " - "  . $courseData['CourseName'] . "</p>";

       $moduleHTML = ""; 
       $moduleHTML .= '<select name="module" id="modulesDrop">'.PHP_EOL;
       $moduleHTML .= '<option value="">Please Select</option>'.PHP_EOL;      
            foreach ($courseData['Modules'] as $moduleId => $moduleData) {        

            $moduleHTML .= "<option value='$moduleId'>" . $moduleId . " - " . $moduleData['ModuleName'] ."</option>".PHP_EOL;        
  } 
            }
            $moduleHTML .= '</select>';

      echo $output;

      ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:27:23.760

你打电话时

```
$qrystmt->bind_result($dbCourseId,$dbModuleId,$dbCourseNo,$dbModuleNo, $dbCourseName,$dbModuleName); 
```

您正在为 $dbModuleNo 分配一行。所以它可能是一个值而不是一个数组。当您调用时，这会导致问题：

```
$dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleNo'] = $dbModuleNo ['ModuleName'] = $dbModuleName; 
```

$dbModuleNo（可能）没有为“ModuleName”定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:25:30.763

您是否尝试在循环之前使用数组值的回显来测试数组？也许您正在尝试为未明确定义的变量分配值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:28:00.863

看起来您从未将 $dbModuleNo 定义为数组。在循环之前添加 $dbModuleNo = array() 。

# linux - 在 debian wheezy 中安装 3.5 内核的头文件？

> ID：13533307
> 
> 赞同：0
> 
> 时间：2012-11-23T17:08:30.137
> 
> 标签：linux, linux-kernel, debian, nvidia

昨天，我在debian wheezy（测试）中编译了3.5内核，在thinkpad edge S430（i5）中。我是在[这个博客](http://verahill.blogspot.com.es/2012/07/compiling-kernel-35-on-debian-testing.html)之后使用所有默认选项完成的。看起来很成功，但是后来，我尝试使用`m-a auto-install nvidia-kernel`. 在安装正确的标头之前，安装无法继续。但是，我已经尝试手动安装 linux-headers-3.5.0-18 和 linux-headers-amd64 包，但模块助手无法看到它们，显示以下消息：

> 运气不好，找不到目标内核版本的内核头文件，并且您没有指定要使用的其他有效内核头文件。

还有其他安装驱动程序的方法，但我认为标题的问题更广泛。

尽管我已经使用 Debian 多年了，但我远不是专家，而且我不清楚在 Debian 测试中编译 3.5 内核时可能遇到的问题，因此非常感谢任何帮助和解释.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-09T00:52:26.333

第一次运行

```
sudo m-a prepare 
```

> ```
> Getting source for kernel version: 3.8.5-ck1
> Kernel headers available in /usr/src/linux-headers-3.8.5-ck1
> Creating symlink.. 
> ```

然后做

```
sudo m-a a-i nvidia 
```

它应该可以工作。

请注意，我是在 3.8.5-ck1 上执行此操作的，但我构建和安装该内核的方式与我编写您遵循的 3.5 构建的方式相似。

# powershell - 从powershell执行批处理文件（依次执行exe）

> ID：13533308
> 
> 赞同：3
> 
> 时间：2012-11-23T17:08:32.013
> 
> 标签：powershell, activemq

我正在尝试从 powershell 执行安装 activeMq 服务，为此我尝试使用以下命令调用批处理文件（该文件又调用 wrapper.exe）：

```
& "C:\apache-activemq-5.6.0\bin\win64\InstallService.bat" 
```

我正进入（状态`'"wrapper.exe"' is not recognized as an internal or external command,or batch file'`

但是当我`InstallService.bat`从命令提示符执行时，我能够运行该服务

任何帮助，将不胜感激

谢谢， 阿南德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:10:31.993

试试这个

```
& "cmd.exe /c C:\apache-activemq-5.6.0\bin\win64\InstallService.bat" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T19:50:04.113

听起来您正在使用相对路径在批处理脚本中调用“wrapper.exe”。如果是这种情况，请将其替换为可执行文件的完整路径。

# java - String.getBytes() 和 IOUtils.toByteArray() 的区别？

> ID：13533311
> 
> 赞同：12
> 
> 时间：2012-11-23T17:08:37.863
> 
> 标签：java, junit, bytearray, apache-commons

我正在测试 IOUtils。我在将 InputStream 转换为字节数组时遇到问题：

```
private static final String LOREM_IPSUM = "Lorem ipsum dolor sit amet, consectetur adipiscing elit.";

@Test
public void testInputStreamToByteArray() throws IOException {

    byte[] expecteds = LOREM_IPSUM.getBytes();
    byte[] actuals = org.apache.commons.io.IOUtils.toByteArray(new StringInputStream(LOREM_IPSUM));

    assertArrayEquals(expecteds, actuals);
} 
```

堆栈跟踪：

```
java.lang.AssertionError: array lengths differed, expected.length=56 actual.length=112
    at org.junit.Assert.fail(Assert.java:91)
    at org.junit.internal.ComparisonCriteria.assertArraysAreSameLength(ComparisonCriteria.java:72)
    at org.junit.internal.ComparisonCriteria.arrayEquals(ComparisonCriteria.java:36)
    at org.junit.Assert.internalArrayEquals(Assert.java:414)
    at org.junit.Assert.assertArrayEquals(Assert.java:200)
    at org.junit.Assert.assertArrayEquals(Assert.java:213)
    at [...].testInputStreamToByteArray(HttpsTest.java:20)[...] 
```

我不明白为什么不通过测试。怎么了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-23T17:16:30.667

**指定编码很重要。**

您没有为库提供任何编码来使用，因此将使用“默认”编码。我猜，由于您的一个字节数组的大小是另一个的两倍，因此使用的一种编码是 UTF-16，另一种是 UTF-8/ASCII。

试试这个：

```
public void testInputStreamToByteArray() throws IOException {

    byte[] expecteds = LOREM_IPSUM.getBytes("UTF-8");
    byte[] actuals = org.apache.commons.io.IOUtils.toByteArray(new StringReader(LOREM_IPSUM), "UTF-8");

    assertArrayEquals(expecteds, actuals);
} 
```

# ruby-on-rails-3 - Rails 视图存储在 db 中并正确呈现

> ID：13533327
> 
> 赞同：1
> 
> 时间：2012-11-23T17:09:37.540
> 
> 标签：ruby-on-rails-3, haml

我正在创建一个简单的 CMS，其中有一个 Page 模型，该模型具有一个存储要为页面呈现的 HAML 代码的内容字段。所以我知道如何存储 HAML 然后渲染它，但我也希望能够使用穿插在 HAML 中的 Rails 助手并正确渲染。

所以一个示例 HAML 文件：

```
%p
  Come on over to 3rd Ward! Take a tour with one of our associates this summer and get a
  %strong FREE $25 Class Gift Card and ONE FREE DAY of COWORKING.
%h2 How awesome is that?
=render("shared/schedule_tour") 
```

我可以渲染 HAML：

```
template = Haml::Engine.new(Page.find(params[:id]).content)
template.render 
```

但是我如何让它接受我的 Rails Helpers？

# windows-8 - 如何在 Windows 8 中以编程方式安装 Firefox XPI 插件？

> ID：13533330
> 
> 赞同：1
> 
> 时间：2012-11-23T17:09:48.760
> 
> 标签：windows-8, firefox-addon, installation, nsis

我创建了一个 NSIS 安装程序来安装 USB 指纹读取器软件和相关的 Firefox 插件。

我可以像这样安装我在 WinXP 和 win7 64 和 32 中分别创建的 Firefox XPI 插件：

```
WriteRegStr HKLM SOFTWARE\Wow6432Node\Mozilla\Firefox\Extensions "PSK_plugin@companyname.com" "$INSTDIR\psk.xpi"

WriteRegStr HKLM Software\Mozilla\Firefox\Extensions "PSK_plugin@companyname.com" "$INSTDIR\psk.xpi" 
```

但是，以上在 Windows 8 中不起作用。

这是我发现上述注册表项的 Mozilla 链接。它不包括 Windows 8：[https ://developer.mozilla.org/en-US/docs/Adding_Extensions_using_the_Windows_Registry](https://developer.mozilla.org/en-US/docs/Adding_Extensions_using_the_Windows_Registry)

# c - UDP 多播：我如何知道要发送到哪个组？

> ID：13533333
> 
> 赞同：0
> 
> 时间：2012-11-23T17:10:08.913
> 
> 标签：c, sockets, network-programming, udp, multicast

我有一个小程序需要在同一 LAN 上的两台计算机之间进行通信。我对网络比较陌生，但从我读过的内容来看，这听起来像是我想要 UDP 多播，以便两台计算机可以发现彼此，之后我可以建立 TCP 连接以进行实际数据通信。[我找到了这个](http://ntrg.cs.tcd.ie/undergrad/4ba2/multicast/antony/example.html)我可以遵循的 UDP 多播的小例子。但是，我想知道多播组（`HELLO_GROUP`在该示例中为`225.0.0.37`）。

我怎么知道我应该使用哪个组？这个程序将在各种网络上运行，所以我不能硬编码一个（据我所知）。我是否从路由器获取组，如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:22:30.467

您可以选择任何未被IANA[列为保留的多播地址（224.0.0.0 到 239.255.255.255）。](http://www.iana.org/assignments/multicast-addresses/multicast-addresses.xml)

可能（如果不太可能）另一个程序也将使用相同的地址。您可以通过使您的程序发出的公告消息适当地具体化来最大限度地减少这种造成任何混乱的可能性。例如

```
CORNSTALKS-DISCOVERY
HOST: {address:port}
[newline] 
```

这将通知您的收件人用于他们的 TCP 连接的地址，但应该发现它的第一行被任何其他收件人拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:16:58.740

你理解错了。

你说的是**广播**。广播 UDP 数据报被发送到子网中的**每台**计算机。（从技术上讲，您将数据报发送到地址 255.255.255.255。）

UDP 广播在特定子网内工作，但不跨越子网边界。也就是说，大多数路由器都配置为不路由广播数据报（减少垃圾邮件）。

OTOH 多播是完全不同的东西。多播的目的是**避免**使用 TCP（或任何其他单播）进行数据传输。当您需要“一次”向许多其他收件人发送内容时，这很好。这些机器初步同意特定的多播地址（例如您的示例中的 225.0.0.37），并“加入”该多播组。在特定的子网中，一切的工作方式都与广播非常相似，但是与广播相比，多播也可能跨越子网边界。这是因为当机器加入多播组时，会通知适当的路由器，并且它们能够适当地路由多播数据报。

**编辑：**

结论（澄清）。

1.  为了使用多播，必须选择多播地址。这就像为应用程序选择一个端口。
2.  多播的主要目的是将内容（传输数据）传递给多个接收者。在这种情况下，它比单播更有效。
3.  “网络发现”通常通过广播完成。理论上，多播也可以用于此目的，但这就像用大炮杀死苍蝇（因为路由器还应该跟踪多播会话的生命周期）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:38:30.200

我建议您不要直接使用多播。

而是使用[零配置网络](http://en.wikipedia.org/wiki/Zero_configuration_networking)。这在其 mDNS/ [DNS-SD](http://www.dns-sd.org/)化身中可以通过 Apple 在 OS X 和 Windows 上的[Bonjour](https://developer.apple.com/bonjour/)库以及在 unices 上的[Avahi](http://avahi.org/)获得（也可能在 OS X 和 Windows 上，不确定）。

使用 DNS-SD，您可以为您的服务定义一个名称，然后使用该库在给定主机上公布其可用性，或浏览可用的主机。这就是 Mac 发现打印机、文件共享等的方式——我相信这正是你的用例。这是一种简单但非常有效的技术。它是一个具有良好开源实现的开放标准，所以它不是苹果专有的可怕时期。

# vb.net - 无法在 VB.NET 列表框中获取多个选定项的文本，因为它的类型为“datarowview”

> ID：13533338
> 
> 赞同：1
> 
> 时间：2012-11-23T17:10:27.357
> 
> 标签：vb.net, data-binding, listbox, listboxitems

我有`listbox1`VB 2010，它绑定到数据源并显示数据集中的值。我使用设计器绑定它——即不是通过代码。我刚刚在 的属性中选择了数据源`listbox1`。

现在我想检索选定的值。当我将列表框保留为单选时，然后`ListBox1.SelectedValue.ToString`完成工作 - 它为我提供了所选项目的文本。

但我需要它来允许多项选择。这是我的代码：

```
 Dim items As ListBox.SelectedObjectCollection
    items = ListBox1.SelectedItems
    For Each i As String In items
        MsgBox(i)
    Next 
```

这是我得到的错误：

```
Conversion from type 'DataRowView' to type 'String' is not valid. 
```

我尝试了几种不同的方法来获取所选项目的值，但似乎没有任何直接的方法可以做到这一点。这是不可能的吗？是否有必要声明一个新数据集并以编程方式填充列表框或其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:34:09.427

```
For Each drv As DataRowView In ListBox1.SelectedItems
        MessageBox.Show(drv.Item(0).ToString)
    Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:24:37.583

在我的脑海中，我认为你可以这样做：

```
Dim items As ListBox.SelectedObjectCollection
items = ListBox1.SelectedItems
For Each i As ListViewItem In items
    MsgBox(i.Value.ToString())
Next 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-01-07T15:22:46.807

看看我的问题和答案。它允许您将数据库中的各个条目分解为列表框。

在表单中添加 2 个列表框和一个文本框，然后复制此代码，您必须替换自己的服务器和数据库等条目。

```
Imports System
Imports System.Windows.Forms
Imports System.Drawing
Imports System.Collections
Imports System.Data.SqlClient

Public Class Form1

Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    ' get the data
    Dim SQLConnectionString As String = "Data Source=HL605\RIVWARE;Database=RIVWARE;Integrated Security=true;"
    Dim mySQLConnection As New SqlConnection(SQLConnectionString)

    ' Populate the list box using an array as DataSource. 
    mySQLConnection.Open()
    Dim SQLDataTable As New System.Data.DataTable

    'Create new DataAdapter
    Dim mySQLDataAdapter = New SqlDataAdapter("SELECT * FROM [Rivware].[dbo].[RivetTypes]", mySQLConnection)
    mySQLDataAdapter.Fill(SQLDataTable)
    ListBox1.DataSource = SQLDataTable
    ListBox1.DisplayMember = "RivetType"

    ' remove validation data from list
    Dim Count As Integer
    Dim X As Integer
    'get the column of data to search for
    For Count = 0 To ListBox1.DataSource.Columns.Count - 1
        X = InStr(ListBox1.DataSource.Columns.Item(Count).ToString, "Name")
        If X <> 0 Then Exit For
    Next
    ' now search for any invalid rows, in that column. those containing "---"
    Dim TheTable As DataTable = CType(ListBox1.DataSource, DataTable)
    Dim theRow As DataRow() = TheTable.Select()
    Dim RowNumber As Integer
    For RowNumber = 0 To UBound(theRow) - 1
        If theRow(RowNumber).Item(Count).ToString <> "---" Then
            ' data is OK so transer it to the other listbox
            ListBox2.Items.Add(theRow(RowNumber).Item(Count - 1).ToString)
        End If
    Next

    ListBox2.ClearSelected()
End Sub 'NewNew

Private Sub ListBox2_SelectedIndexChanged(sender As Object, e As EventArgs) Handles ListBox2.SelectedIndexChanged
    TextBox1.Text = ListBox2.SelectedItem.ToString()
End Sub
End Class 'ListBoxSample3 
```

# jsf - 直接打印PDF报告，无需下载、打开和打印

> ID：13533339
> 
> 赞同：1
> 
> 时间：2012-11-23T17:10:29.403
> 
> 标签：jsf, jasper-reports

我开发了一个 JSF 应用程序，它使用 JasperReports 在客户端机器上的每次交易后提供一个 pdf 文件作为下载。我按照本[教程进行操作。](http://www.ramkitech.com/2011/11/jsf-jpa-jasperreports-ireport.html)有什么方法可以直接打印而不是下载它，因为最终用户必须打开它并给出打印命令。（客户说有很多交易，他们希望在独立的应用程序中以相同的方式打印收据，而不需要像打开打印对话框那样进行任何干预。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:28:50.137

您不能在不出现打印对话框的情况下强制浏览器进行打印。

但是，您可以设置 Content-Disposition 以便浏览器在浏览器中打开可以打印的 PDF。例如：

```
 /**
   * Sets the regular HTTP headers, regardless of whether this report is
   * embedded in the browser window, or causes a "Save As" dialog prompt to
   * download.
   */
  protected void setHeaders() {
    getServletResponse().setHeader( "Cache-Control", getCacheControl() );
  }

  /**
   * Sets the HTTP headers required to indicate to the browser that the
   * report is to be downloaded (rather than displayed in the current
   * window).
   */
  protected void setDownloadHeaders() {
    HttpServletResponse response = getServletResponse();
    response.setHeader( "Content-Description", getContentDescription() );
    response.setHeader( "Content-Disposition", "attachment, filename="
      + getFilename() );
    response.setHeader( "Content-Type", getContentType() );
    response.setHeader( "Content-Transfer-Encoding",
      getContentTransferEncoding() );
  } 
```

这将提示用户保存 PDF。如果更改 Content-Disposition，浏览器将显示 PDF 内联而不提示保存。这将跳过必须打开 PDF 的步骤。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-06-24T09:52:15.247

您可以使用以下方法：

```
JasperPrintManager.printPage(jasperPrint, 0, true);//for Direct print  
                         * True : It Shows "Printrer Dialog also"

JasperPrintManager.printPage(jasperPrint, 0, false);//for Direct print  
                         * fasle : It can't Show "Printrer Dialog", it will print the report directly 
```

# c# - C#中的无限循环

> ID：13533343
> 
> 赞同：0
> 
> 时间：2012-11-23T17:10:41.830
> 
> 标签：c#, infinite-loop

这个简单的程序输入一个整数并打印它们，但如果它看到 60 则停止打印

```
 string input = string.Empty;
        int intValue = 0;
        int[] numbers = new int[5];

        for (int i = 0; i < 4; i++)
        {
            input = Console.ReadLine();
            if (int.TryParse(input, out intValue))
                numbers[i] = intValue;
        }

        for (int i = 0; i < numbers.Length; i++)
        {
            while (numbers[i] != 60)
            {
                Console.WriteLine(intValue);
            }
        } 
```

程序在第四个输入之后继续无限循环输入：1 2 3 4 4 4 4 4 4 ........等等

我不知道原因.... ^_^

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:12:36.857

```
while (numbers[i] != 60)
{
    Console.WriteLine(intValue);
} 
```

应该：

```
if (numbers[i] != 60)
{
    Console.WriteLine(intValue);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T20:34:22.580

字符串输入 = string.Empty;

```
 int intValue = 0;
    int[] numbers = new int[5];

    for (int i = 0; i < 4; i++)
    {
        input = Console.ReadLine();
        if (int.TryParse(input, out intValue))
            numbers[i] = intValue;
    }

    for (int i = 0; i < numbers.Length; i++)
    {
        /*while (numbers[i] != 60)*/
        if (numbers[i] != 60)  // it should be if condition, while statement made it infinite
        {
            Console.WriteLine(intValue);
        }
    } 
```

# java - Java中的双缓冲

> ID：13533344
> 
> 赞同：2
> 
> 时间：2012-11-23T17:10:51.117
> 
> 标签：java, doublebuffered

我在互联网上找到了这个双缓冲代码，但没有解释。我对这段代码有点困惑。

*   为什么使用图像“i”？如果要使用一次，它有什么用？

*   当我们已经设置颜色时，为什么我们将更改颜色分配给前景色？

*   g.drawImage() 方法在做什么？

这是代码：

```
public void update(Graphics g)
{
    if(i==null)
    {
        i=createImage(getWidth(), getHeight());
        graph=i.getGraphics();
    }

    graph.setColor(getBackground());
    graph.fillRect(0, 0, getWidth(),getHeight());
    graph.setColor(getForeground());

    paint(graph);

    g.drawImage(i,0,0,this);
  } 
```

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T17:18:37.947

双缓冲的基本思想是在屏幕外创建图像，然后一次将其全部显示。

![双缓冲](../Images/0335d7ddb614fe5dae6fc232e9f7ea73.png)

*从[这里找到的java教程](http://docs.oracle.com/javase/tutorial/extra/fullscreen/doublebuf.html)*

您在那里的代码首先会在第一次通过时创建一个图像，作为您的“后台缓冲区”，我可能是一个字段，例如

```
 private Image i;
 private Graphics graph;

 if(i==null)
{
    i=createImage(getWidth(), getHeight());
    graph=i.getGraphics();
} 
```

然后用这个将背景颜色绘制到图像上

```
graph.setColor(getBackground());
graph.fillRect(0, 0, getWidth(),getHeight()); 
```

然后设置正面准备绘图。

```
graph.setColor(getForeground());
paint(graph); /draws 
```

最后将背面缓冲区绘制到主表面。

```
g.drawImage(i,0,0,this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:17:20.733

图形操作都是在从`Graphics`获得的`i`，这是内存中的位图上执行的。

完成后，位图将绘制到“真实”（屏幕）`Graphics`对象上`g`。所以用户永远不会看到半成品的绘图，从而消除了闪烁。

该字段`i`是第一次分配然后重用的，因此它不是只使用一次。

# deployment - 如何在目标机器上部署 SQL Server 2008 R2？

> ID：13533349
> 
> 赞同：0
> 
> 时间：2012-11-23T17:11:05.940
> 
> 标签：deployment, sql-server-2008-r2

我已经使用 SQL Server 2000 几年了。对于 SQL Server 2000 的部署，我在目标机器上使用了 MSDE（Microsoft Desktop Engine 2000）。

现在我已经切换到 SQL Server 2008 R2。我使用 SQL Server 2008 R2 作为我的数据库开发了一个应用程序。现在我对这个应用程序的部署感到困惑。

我搜索了 MSDE 2008 R2 但找不到它。谁能告诉我应该用什么代替MSDE 2000？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:56:29.333

从 2005 和更新版本开始，MSDE 的替代品是 SQL Server **Express**。

[在此处查看有关 SQL Server 2012 Express 的更多信息](http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx)。

您还可以[在此处下载 SQL Server 2008 R2 Express 版本](http://www.microsoft.com/en-us/download/details.aspx?id=23650)

# c# - 使用 .NET 使用安全证书的 cURL 请求

> ID：13533351
> 
> 赞同：2
> 
> 时间：2012-11-23T17:11:09.430
> 
> 标签：c#, curl, webrequest

我有一个需要安全证书的 cURL 命令。我正在尝试用 C# 中的 WebRequest 替换调用。

这是 curl 命令：

curl -d "uid=UUUUUU&password=PPPPPP&active=Y&type=I" [https://www.aidap.naimes.faa.gov/aidap/XmlNotamServlet](https://www.aidap.naimes.faa.gov/aidap/XmlNotamServlet) --key aidap_key.pem --cacertaidap_ca.pem --certaidap_client.pem：开始123 -k -O

我被困的地方是如何合并--key、--cacert 和--cert 参数。目前我正在设置 WebRequest.PreAuthenticate=true 并使用我的证书存储中的安全证书的名称和密码创建 NetworkCredential（我假设在 --key、--cacert 等中）。

当我运行下面的代码时，我收到了 403 禁止异常。

有任何想法吗？

这是我正在使用的代码：

```
 public void RetrieveNotams()
        {
            string myURL = "https://www.aidap.naimes.faa.gov/aidap/XmlNotamServlet";

            HttpWebRequest req;

            NetworkCredential myCred = new NetworkCredential("AAAAA", "BBBBB");

            req = (HttpWebRequest)WebRequest.Create(myURL);

            req.PreAuthenticate = true;

            req.Credentials = myCred;

            req.Method = "POST";

            req.ContentType = "application/x-www-form-urlencoded";
            string postData = "uid=UUUUUU&password=PPPPPP&active=Y&type=I";
            byte[] byteArray = Encoding.UTF8.GetBytes(postData);
            req.ContentLength = byteArray.Length;

            using (Stream dataStream = req.GetRequestStream())
            {
                dataStream.Write(byteArray, 0, byteArray.Length);
                dataStream.Close();
            }

            req.GetResponse();

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:52:51.107

我在

[http://www.codeproject.com/Articles/28395/Attaching-a-digital-certificate-public-key-to-an-H](http://www.codeproject.com/Articles/28395/Attaching-a-digital-certificate-public-key-to-an-H)

我从证书存储中获取证书，并将其添加到请求的证书集合中。并取出 PreAuthenticate 代码。

这是更新的代码：

```
public void RetrieveNotams()
{
    string myURL = "https://www.example.com/SecureSite";

    // Open the certificate store for the current user in readonly mode,
    // and find the certificate I need to user
    X509Store xstore = new X509Store(StoreLocation.CurrentUser);

    xstore.Open(OpenFlags.ReadOnly);

    X509Certificate cert=null; 

    foreach (X509Certificate c in xstore.Certificates)
        if(c.Subject.StartsWith("CN=aidapuser"))
            cert=c;          

    HttpWebRequest req;

    req = (HttpWebRequest)WebRequest.Create(myURL);

    // add the certificate to the request
    req.ClientCertificates.Add(cert);

    req.Method = "POST";

    req.ContentType = "application/x-www-form-urlencoded";
    string postData = "uid=UUUUUUU&password=PPPPPP&active=Y&type=I";
    byte[] byteArray = Encoding.UTF8.GetBytes(postData);
    req.ContentLength = byteArray.Length;

    // add the parameters to POST to the URL
    using (Stream dataStream = req.GetRequestStream())
    {
        dataStream.Write(byteArray, 0, byteArray.Length);
        dataStream.Close();
    }

    // grab the response and show the first 10 lines

    using (StreamReader sr = new StreamReader(req.GetResponse().GetResponseStream()))
    {

        for (int i = 0; i < 10; i++)
            Console.WriteLine(sr.ReadLine());
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-09T03:18:03.463

```
 var request_object = new stdClass();
        request_object.name = Encoding.UTF8.GetBytes("Shipping Sys");
        request_object.no = 999;
        request_object.staff = Encoding.UTF8.GetBytes("shimizu@ultimatrust.co.jp");

        string jsonBody3 = "{\"name\":\"Shipping Sys\",\"no\":999,\"staff\":\"shimizu@ultimatrust.co.jp\"}";
        string jsonBody4 = "name=ShippingSys&no=999&staff=shimizu@ultimatrust.co.jp";
        int lenghth = jsonBody4.Length;

        string URL = "https://stage.ai-shot.com/shibano/Shipping/get_token.php";
        System.Net.HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(URL);

        X509Store xstore = new X509Store(StoreLocation.CurrentUser);
        xstore.Open(OpenFlags.ReadOnly);
        X509Certificate cert2 = null;
        foreach (X509Certificate c in xstore.Certificates)
            if (c.Subject.StartsWith("CN=GlobalSign Root CA"))
                cert2 = c;
        // add the certificate to the request
        httpWebRequest.ClientCertificates.Add(cert2);

        byte[] arrayData = Encoding.UTF8.GetBytes(jsonBody4);
        ServicePointManager.SecurityProtocol = SecurityProtocolType.SystemDefault | SecurityProtocolType.Tls12;

        httpWebRequest.Method = "POST";
        httpWebRequest.ContentType = "application/json";
        httpWebRequest.ContentLength = arrayData.Length;

        CredentialCache credentialCache = new CredentialCache();

        NetworkCredential myCred = new NetworkCredential("shimizu@ultimatrust.co.jp", "fugafuga");

        httpWebRequest.Credentials = myCred;
        httpWebRequest.PreAuthenticate = true;

        using (System.IO.Stream stream = httpWebRequest.GetRequestStream())
        {
            stream.Write(arrayData, 0, arrayData.Length);
            stream.Close();
        }

        HttpWebResponse res = httpWebRequest.GetResponse() as HttpWebResponse; 
```

# mysql - 用于 sql INSERT...SELECT 的 mongodb 翻译

> ID：13533352
> 
> 赞同：9
> 
> 时间：2012-11-23T17:11:09.927
> 
> 标签：mysql, mongodb

如果像 {conditionB:1} 这样的条件并添加像 ts_imported 这样的时间戳 - 在不知道原始文档中包含的详细信息的情况下，如何简单地从 collectionABC 复制文档并将它们复制到 collectionB 中？

我找不到类似于 mysql 的 mongodb 的简单等价物`INSERT ... SELECT ...`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-23T19:20:23.353

您可以使用 mongoshell 中的 javascript 来实现类似的结果：

```
db.collectionABC.find({ conditionB: 1 }).
forEach( function(i) { 
  i.ts_imported = new Date();
  db.collectionB.insert(i);
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-01-28T21:58:32.607

我意识到这是一个老问题，但是......现在有更好的方法。MongoDB 现在有一个叫做聚合管道的东西（v 3.6 及更高版本，也许还有一些旧的——我还没有检查过）。聚合管道允许您执行更复杂的操作，例如执行连接、添加字段以及将文档保存到不同的集合中。对于 OP 的情况，管道如下所示：

```
var pipeline = [
    {$match: {conditionB: 1}},
    {$addFields: {ts_imported: ISODate()}},
    {$out: 'collectionB'}
]
// now run the pipeline
db.collectionABC.aggregate(pipeline) 
```

相关文档：

*   [聚合管道](https://docs.mongodb.com/manual/aggregation/)
*   [$出阶段](https://docs.mongodb.com/manual/reference/operator/aggregation/out/)
*   [一些重要的限制](https://docs.mongodb.com/manual/reference/limits/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:54:08.640

Mongodb 没有那种查询能力，您可以（在查询内部）根据第一个集合中的变量插入另一个集合。

您需要先将该文档拉出，然后对其进行操作。

从技术上讲，您可以为此使用 MR，但我觉得它不适用于您的场景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-01T10:12:46.473

似乎这在序列生成的上下文中有效 [http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/](http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/)

# ios - 为特定目标关联图像文件夹

> ID：13533363
> 
> 赞同：0
> 
> 时间：2012-11-23T17:12:07.890
> 
> 标签：ios, xcode

我创建了一个包含两个目标的项目（我有重复`Target1`）`Target2`。我在项目中有很多图像。我想将一些图像关联到一个目标，而将其他图像关联到第二个目标。我通过选择一张图片来做到这一点。

我的问题：我可以将喜欢的图像与目标相关联吗？如果是的话，我该怎么做？

谢谢你的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:49:22.083

是的，有可能：well 文件夹本身没有*目标成员资格*，但您可以轻松地将一个文件夹中的所有文件关联到一个目标，并将其他文件夹中的文件关联到另一个目标。当然，这些文件夹中的文件可以具有相同的名称。

您可以在磁盘上有两个单独的文件夹，比如 images_t1 和 images_t2。

将 images_t1 文件夹拖到项目树中，当要求“添加到目标”时，您只需选中 Target1 复选框。对于 images_t2 您只检查 Target2 复选框 - 就是这样。

我刚刚重新测试了它，导入文件的目标成员身份（在两个文件夹内）是正确的。

但请注意，如果您打算将此图像与 Interface Builder 一起使用，您可能会遇到 XCode 的小错误 - 混合图像。有一个解决方法，但它并不漂亮。检查[Xcode 4，Interface Builder，两个具有单独 .xib 的目标（具有相同名称的图像资源）](https://stackoverflow.com/questions/8878357/xcode-4-interface-builder-two-targets-with-seperate-xib-image-resources-with)。

此错误仅在 .XIB 编辑期间可见 - 编译应用程序后一切正常。

# wordpress - AddThis Wordpress 插件的错误

> ID：13533371
> 
> 赞同：0
> 
> 时间：2012-11-23T17:12:46.937
> 
> 标签：wordpress, addthis

我有两页：

1-http://www.aotopo.com.br/servicos/

2-http://www.aotopo.com.br/blog/

在两个页面中，我都插入了 addThis 插件。本地测试对两者都是完美的，但在线测试只有第一个有效。

在第二个 addThis 插件位于 post-content （就在“Leia Mais”按钮之前）。

```
(function help(){
    if(somebodyKnowWhy){
        pleaseHelpMe();
        console.log("Thank you!");
    }
})() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:07:50.050

如果有人在同一个问题上偶然发现，当我问同样的问题时，我找到了 Wordpress.org 成员 (srijith.v) 的答案：

@Erick：我找不到 addthis_widget.js 被导入页面。您是如何添加 AddThis 的？您是否使用了可用于 WordPress 的插件？

您需要在页面中包含[http://s7.addthis.com/js/300/addthis_widget.js](http://s7.addthis.com/js/300/addthis_widget.js)以呈现按钮。

我刚刚将此 js 添加到我的页脚作为脚本标签的来源，瞧。

# jquery - 循环遍历选定的行元素 JQuery

> ID：13533372
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:12:57.100
> 
> 标签：jquery

如何获取任何表中选定行的内容并使用 JQuery 在 post 数组中提交它们的值？

这是我的桌子：

```
 <?php if(isset($products)){ ?>
            <?php foreach( $products as $product){ ?>
                <tr id="<?php echo $product['order_product_id']; ?>">
                    <td class="center"><input checked="checked" type="checkbox" name="selected-p[]" value="<?php echo $product['order_product_id']; ?>" /></td>
                    <td class="left"><input type="text" name="order_id" value="<?php echo $product['order_id']; ?>"/></td>
                    <td class="left"><input type="text" name="product_id" value="<?php echo $product['product_id']; ?>"/></td>
                    <td class="left"><input type="text" name="name" value="<?php echo $product['name']; ?>"/></td>
                    <td class="left"><input type="text" name="price" value="<?php echo $product['price']; ?>"/></td>

                    <td class="left"><input type="text" name="cost" value="<?php echo $product['cost']; ?>"/></td>
                    <td class="left"><input type="text" name="product_cost" value="<?php echo $product['product_cost']; ?>"/></td>
                    <td class="left"><input type="text" name="logistics_cost" value="<?php echo $product['logistics_cost']; ?>"/></td>
                    <td class="left"><input type="text" name="inventory_cost" value="<?php echo $product['inventory_cost']; ?>"/></td>

                    <td class="left"><font  dir="ltr"><?php echo $product['date_added']; ?></font></td>
                </tr>
            <?php } ?>
        <?php } ?> 
```

问题作者呈现的 HTML：

```
<tr id="39118"><td class="center"><input type="checkbox" name="selected-p[]" value="39118"></td> <td class="left"><input type="text" name="order_id" value="10141"></td> <td class="left"><input type="text" name="product_id" value="881"></td> <td class="left"><input type="text" name="name" value="أساور الصداقة"></td> <td class="left"><input type="text" name="price" value="30.0000"></td> <td class="left"><input type="text" name="cost" value="9.0000"></td> <td class="left"><input type="text" name="product_cost" value="9.00"></td> </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:44:12.257

试试这个...

```
var data = [];

$("#table1 tr").filter(function() {
    return $("td:eq(0) input[type=checkbox]", this).attr("checked");
}).each(function() {
    data.push({
        order_id: $("input[name=order_id]", this).val(),
        product_id: $("input[name=product_id]", this).val(),
        name: $("input[name=name]", this).val(),
        price: $("input[name=price]", this).val(),
        cost: $("input[name=cost]", this).val(),
        product_cost: $("input[name=product_cost]", this).val(),
        logistics_cost: $("input[name=logistics_cost]", this).val(),
        inventory_cost: $("input[name=inventory_cost]", this).val()
    });
});

console.log(data);

if (data.length > 0) {
    $.ajax({
        url: "http://www.webpage.com",
        type: "POST",
        data: data,
        success: function(data) {
            console.log("Success!! " + data);
        }
    });
} 
```

它创建一个名为的数组`data`，并用代表被勾选的表格的每一行的对象填充它。（Console.log 会告诉你它得到了什么）。

然后它执行 ajax 调用，发布数据并显示返回的任何结果数据。

*（我做了 1 个假设，您需要更改以适应。我假设该表的 id 为`table1`- 请参阅第二行代码。）*

**[这是一个工作的jsfiddle](http://jsfiddle.net/qHmLb/1/)**

# php - 如何直接添加到 Join Table cakephp 中？

> ID：13533374
> 
> 赞同：2
> 
> 时间：2012-11-23T17:13:28.813
> 
> 标签：php, cakephp, jointable

当我尝试将一些条目添加到两个类的连接表中时，我遇到了 CakePHP 的问题。

这是我的联接表：

```
posts_comments

id
post_id
comment_id 
```

我的帖子模型：

```
<?php

  class Post extends AppModel {
    var $hasManyAndBelongsTo = array('Comment')
  }

?> 
```

我的评论模型：

```
<?php

  class Commentextends AppModel {

    var $hasAndBelongsToMany = array('Post');

  }

?> 
```

我的控制器：

```
ForumController:

function save() {
    if ($this->data) {
        $this->loadModel('PostComment');
        $this->layout = null;
        debug($this->data);
        $this->PostComment->save($this->data);
    }
    $this->redirect(array('action' => 'view', $this->data['PostComment']['PostId']));
} 
```

还有我的 view.ctp：

```
<?php 
echo $this->Form->create('PostComment', array('url' => 'save', 'id' => 'save')); ?>
echo $this->Form->hidden('PostComment.PostId', array('value' => $id));
echo $this->Form->input('PostComment.CommentId', array('label' => '', 'type' => 'select', 'multiple' => 'checkbox', 'options' => $CommentName, 'selected' => $CommentId));
echo $this->Form->submit('save', array('id' => 'submit'));
echo $this->Form->end();
?> 
```

当我点击 时`submit`，没有提交任何内容，并且发生了重定向，但我的数据中包含的数据`$this->data`没有保存在我的 BDD 中。

但我想要的是，当我提交表单时，我不希望 CakePHP 创建新帖子或新评论，我只想在两者之间建立新的关系。

我已经成功做到了，但我用

```
$this->myObject->query("INSERT INTO blablabla") 
```

问题是我有多个复选框，所以我真的不知道如何轻松检查一个框已被取消选中或选中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:17:06.463

如果您创建另一个具有两个 hasMany 关系而不是一个具有 HABTM 关系的模型，则可以以更简单的方式工作。

> 两个模型之间的 HasAndBelongsToMany 实际上是通过 hasMany 和 belongsTo 关联关联的三个模型的简写。

我发现这是保存和检索数据的最简单方法之一。

欲了解更多信息：[http ://book.cakephp.org/2.0/en/models/saving-your-data.html#what-to-do-when-habtm-becomes-complicated](http://book.cakephp.org/2.0/en/models/saving-your-data.html#what-to-do-when-habtm-becomes-complicated)

在新模型中，您可以执行以下操作：

```
public addRecord($userId, $postId)
    $this->data[$this->alias]['user_id'] = $userId;
    $this->data[$this->alias]['post_id'] = $postId;

    return $this->save($this->data[$this->alias]);
} 
```

# c# - 在 SQL CLR 中访问 COM

> ID：13533375
> 
> 赞同：5
> 
> 时间：2012-11-23T17:13:59.550
> 
> 标签：c#, sql-server-2008, com, user-defined-functions, sqlclr

希望你们都有美好的一天！

对于过去三天我一直在思考的事情，我需要你的建议。我有一个用非托管平台编写的 COM 组件。该组件有一个返回某种敏感数据的方法，我需要在获得该值后立即存储它。

我需要的是调用 UDF 来访问 COM 对象并获取值。到目前为止我已经尝试过了，我得到了这个例外：

> *消息 6522，级别 16，状态 2，第 1
> 行在执行用户定义的例程或聚合“GetRate”期间发生 .NET Framework 错误：System.Runtime.InteropServices.COMException：检索具有 CLSID {D039A99F- 的组件的 COM 类工厂5D45-42C7-A53C-507913D8C6D6} 由于以下错误而失败：80040154。System.Runtime.InteropServices.COMException
> ：
> 在 System.RuntimeTypeHandle.CreateInstance（RuntimeType 类型，Boolean publicOnly，Boolean noCheck，Boolean& canBeCached，RuntimeMethodHandle&ctor，Boolean& bNeedSecurityCheck）
> 在 System.RuntimeType.CreateInstanceSlow（布尔 publicOnly，布尔 fillCache）
> 在 System.RuntimeType.CreateInstanceImpl（布尔 publicOnly，布尔 skipVisibilityChecks，布尔 fillCache）
> 在 System.Activator.CreateInstance(Type type, Boolean nonPublic)
> at UserDefinedFunctions.GetRate(SqlString Source_Currency_Name, SqlString Destination_Currency_Name, SqlMoney Amount, SqlBoolean Mode)*

该函数似乎看不到已注册的 COM 组件（80040154）。clr 程序集注册为不受限制。我尝试使用“sa”或 Windows 集成模式调用 UDF。没有区别。

这是初始化 COM 组件**的代码，代码在 SQL 之外运行良好**：

```
Activator.CreateInstance(Type.GetTypeFromCLSID(new Guid("D039A99F-5D45-42C7-A53C-507913D8C6D6"), true)) 
```

反正有没有让这个工作人员？一种或另一种方式，我需要一个 UDF 调用这个 COM 对象，或者至少通过这个 UDF 使用 .NET 远程访问一些 Windows 服务。每一个建议都可以引导我完成这种方式，我们将不胜感激。

谢谢你们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T17:06:04.937

一般来说，我不建议使用 SQL CLR 对象作为 COM 和 SQL 之间的桥梁。从安全性开始，到非常繁琐的发布过程结束，有很多潜在的警告，需要物理访问生产 sql 框，这可能很容易获得，也可能不容易获得。

我还注意到您正在使用 Activator.CreateInstance 然后向它​​提供 clsid。在您的原始帖子中，您暗示它是一个 COM clsid。我不确定在 SQL CLR 中创建的 AppDomain 中工作的 Activator 是否真的可以找到 com clsid 的对象。

我会尝试的方式：

*   为您的 com 创建托管代理
*   确保已签名并放入 gac
*   尝试从 SQL CLR 访问该托管代理

但我严重怀疑它会起作用。任何远程解决方案 WCF/WebServices/Remoting 甚至 SQL Broker 似乎都是更好的选择。

简而言之，如果没有看到实际的 .net 和 sql codez，就很难说出更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T15:26:46.203

我猜你正在将 CLR 程序集导入 SQL Server？如果是这样，这可能是平台/架构问题。当您构建 DLL 时，您的目标平台是什么？

确保您正在针对正确的平台（即 x86、x64）构建 DLL。

我建议您在 Visual Studio 中的 Project Properties、Build/Platform's Target 中修改项目`"Any CPU"`平台`"X86"`。

然后使用`"DROP ASSEMBLY"`, 后跟`"CREATE ASSEMBLY"`, 重新导入正确构建的 dll。

您可能还需要确保已进行以下更改：

1.  在 HKey_Classes_Root/Wow6432Node/CLSID 下找到您的 COM 对象 GUID。
2.  找到后，添加一个新的 REG_SZ（字符串）值。名称应为 AppID，数据应与您刚刚搜索的 COM 对象 GUID 相同。
3.  在 HKey_Classes_Root/Wow6432Node/AppID 下添加一个新密钥。新键的名称应与 COM 对象 GUID 相同。
4.  在您刚刚添加的新键下，添加一个新的 REG_SZ（字符串）值，并将其命名为 DllSurrogate。将该值留空。
5.  在 HKey_Local_Machine/Software/Classes/AppID 下创建一个新密钥（如果它尚不存在）。
6.  同样，新键的名称应与 COM 对象的 GUID 相同。无需在此键下添加任何值。

另一种解决方案是使用 SQL clr 调用 WCF 服务。有关如何执行此操作，请参阅以下指南：

[http://www.codeproject.com/Articles/21149/Invoking-a-WCF-Service-from-a-CLR-Trigger](http://www.codeproject.com/Articles/21149/Invoking-a-WCF-Service-from-a-CLR-Trigger)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T10:34:15.483

如果您的 COM 应用程序的网络版本非常好，则在 sql select * from sys.dm_clr_properties 上运行此 cmd 仅当网络版本小于或等于时才有效！！！

# ruby - 如何使用 read、readpartial 和 read_nonblock 从 ruby 中的 TCPServer 套接字读取

> ID：13533382
> 
> 赞同：5
> 
> 时间：2012-11-23T17:14:58.223
> 
> 标签：ruby, unix, nonblocking, tcpserver, httpserver

我有一个关于从套接字读取以及如何在 Unicorn 或 Mongrel 等 Ruby 服务器上进行管理的两部分问题

1.  我了解到，从套接字读取与读取文件不同，并且没有发送明显的 EOF 消息，并且数据是无穷无尽的流。那么你怎么知道什么时候停止阅读呢？例如，在这种情况下，当我通过浏览器访问我的服务器时，我的 TCPServer`http://localhost:9799`会在没有更多数据要读取后挂起，并且也不会抛出 EOFError。

```
 require 'socket'

READ_CHUNK = 1024
socket = Socket.new(Socket::AF_INET, Socket::SOCK_STREAM)
addr = Socket.pack_sockaddr_in(9799, '127.0.0.1')
socket.bind(addr)
socket.listen(Socket::SOMAXCONN)
socket.setsockopt(:SOCKET, :REUSEADDR, true)

puts "Server is listening on port = 9799"
loop do 
    connection, addr_info = socket.accept
    data_buffer = ""

    loop do
        begin
            connection.read_nonblock(READ_CHUNK, data_buffer)
            puts "Buffer = #{data_buffer}"
        rescue Errno::EAGAIN => e
            IO.select([connection])         
            retry
        rescue EOFError
            break
        end
    end
    connection.write("HTTP/1.1 200 \r\n")
    connection.write("Content-Type: text/html\r\n")
    connection.write("Status 200 \r\n")
    connection.write("Connection: close \r\n")
    connection.write("Hello World \r\n")
    connection.close
end 

```

我想知道 Ruby 服务器使用的最佳实践/标准方法是什么。我看到 Unicorn 使用来自[kgio](http://bogomips.org/kgio.git/tree/ext/kgio/read_write.c)库的 read_nonblock 而 mongrel 使用 readpartial （我不确定这些，但通过代码，我觉得这是采用的方法。）即使检查 \r\n 服务器如何知道输入完成。可以解释应该如何做到这一点（我认为`gets`这不是方法 - 它带有`read`, `readpartial`, `read_nonblock`）。

2）。我真的很感激关于如何在独角兽或乘客等服务器中实现这一点的几行

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T19:05:16.773

它在这里的独角兽中完成 [https://github.com/defunkt/unicorn/blob/master/lib/unicorn/http_request.rb#L69-L71](https://github.com/defunkt/unicorn/blob/master/lib/unicorn/http_request.rb#L69-L71)

有`add_parse`方法（阅读上述方法的评论） [https://github.com/defunkt/unicorn/blob/master/ext/unicorn_http/unicorn_http.rl#L760-L778](https://github.com/defunkt/unicorn/blob/master/ext/unicorn_http/unicorn_http.rl#L760-L778)

也看看这里的一些解释[http://www.ruby-forum.com/topic/2267632#1014288](http://www.ruby-forum.com/topic/2267632#1014288)

这是您使用 http_parser.rb [https://gist.github.com/4136962的工作代码](https://gist.github.com/4136962)

`gem install http_parser.rb`

```
require 'socket'
require "http/parser"

READ_CHUNK = 1024 * 4
socket = Socket.new(Socket::AF_INET, Socket::SOCK_STREAM)
addr = Socket.pack_sockaddr_in(9799, '127.0.0.1')
socket.bind(addr)
socket.listen(Socket::SOMAXCONN)
socket.setsockopt(:SOCKET, :REUSEADDR, true)

puts "Server is listening on port = 9799"
loop do
    connection, addr_info = socket.accept

    parser = Http::Parser.new
    begin
      data = connection.readpartial(READ_CHUNK)
      puts "Buffer = #{data}"
      parser << data
    end until parser.headers

    connection.write("HTTP/1.1 200 \r\n")
    connection.write("Content-Type: text/html\r\n")
    connection.write("Status 200 \r\n")
    connection.write("Connection: close \r\n")
    connection.write("\r\n\r\n")
    connection.write("Hello World \r\n")
    connection.close
end 
```

# c# - 如何从性能计数器中检索特定的连接字符串

> ID：13533386
> 
> 赞同：0
> 
> 时间：2012-11-23T17:15:17.033
> 
> 标签：c#, .net, connection-string, connection-pooling, performancecounter

我的连接池有一些问题，我知道使用 PerformanceCounter 我可以获得一些关于它的信息，这里是文档

[http://msdn.microsoft.com/en-us/library/ms254503(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms254503(v=vs.100).aspx)

但是由于为我使用的每个不同的连接字符串创建了一个池，所以我不明白如何使用例如**NumberOfPooledConnections**返回一个通用的池连接数。

那么，我应该如何使用它呢？我可以检索性能计数器的特定连接字符串吗？

谢谢你，马可

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:19:54.530

性能计数器只是一个计数器 -`NumberOfPooledConnections`只是数字，它不是连接列表或数组。

# javascript - 更新面板和 JavaScript Hack 中的重复按钮

> ID：13533388
> 
> 赞同：1
> 
> 时间：2012-11-23T17:15:37.283
> 
> 标签：javascript, asp.net, user-controls, updatepanel

关于我的问题，

[更新面板中的 Page.Unload 事件](https://stackoverflow.com/questions/13531944/page-unload-event-inside-a-update-panel)

我能够使它工作，但我有两个按钮可以部分回发，然后在我的脚本中我可以做我想做的事，但我希望它只适用于一个按钮而不是其中两个，最好的是我想要的按钮使此请求适用于图像按钮，而其他按钮只是一个简单的按钮。顺便说一下，这是 ASP.NET 中的用户控件。

```
 <script type="text/javascript"> 
   // if you use jQuery, you can load them when dom is read.
   $(document).ready(function () {
       var prm = Sys.WebForms.PageRequestManager.getInstance();    
       prm.add_initializeRequest(InitializeRequest);
       prm.add_endRequest(EndRequest);

    });        

    function InitializeRequest(sender, args) {
    }

    function EndRequest(sender, args) {
       // after update occur on UpdatePanel run the code.
       UnloadMsgBox();
    }

    function UnloadMsgBox()
    {
        alert("Message");
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:22:20.857

假设您有两种方法，一种被称为`button1_Click`，另一种被称为`imageButton1_Click`。我们向页面添加一个 HiddenField，如下所示：

```
<asp:HiddenField runat="server" ID="hidIsTheButton" value="0" /> 
```

在我们的`button1_Click`方法中：

```
hidIsTheButton.Value = "0"; 
```

在我们的`imageButton1_Click`方法中：

```
hidIsTheButton.Value = "1"; 
```

在这里，`button1_Click`指的是您的标准按钮事件处理程序，并指的是您`imageButton1_Click`的`ImageButton`事件处理程序。

在您的`EndRequest`javascript 函数中：

```
function EndRequest(sender, args) {
   // after update occur on UpdatePanel run the code.
   var hidIsTheButton = document.getElementById('<%=hidIsTheButton.ClientID%>');
   if (hidIsTheButton.Value == "1") {
       UnloadMsgBox();
   }
} 
```

# xcode - 为 OS X 编写一个应用程序，允许用户使用上下文菜单项“打开方式”选择应用程序

> ID：13533391
> 
> 赞同：0
> 
> 时间：2012-11-23T17:16:09.333
> 
> 标签：xcode, macos, cocoa, file-association, open-with

我有一个使用 Xcode 的 Mac OS X 多媒体应用程序。

使用的语言是 Objective-C、C++ 和 C。

我想以某种方式将我的应用程序放在“打开方式”上下文菜单中，而无需用户做任何事情。我不想“接管”默认关联，除非用户在“首选项”中设置它或采取其他步骤。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:18:42.753

如果您为您希望支持的应用程序的文档类型添加一个条目，`Info.plist`它应该会显示在该菜单中。最简单的方法是选择您的目标并在`Info`选项卡中添加类型。

# php - 无法从数据库回显表

> ID：13533392
> 
> 赞同：0
> 
> 时间：2012-11-23T12:23:36.057
> 
> 标签：php, mysql, web, database, sql

我尝试使用 php 回显我的数据库（托管在 ipage.com 上），但出现此错误：内部服务器错误服务器遇到内部错误或配置错误，无法完成您的请求。请联系服务器管理员 cgiadmin@yourhostingaccount.com 并告知他们错误发生的时间，以及您所做的任何可能导致错误的事情。

服务器错误日志中可能提供有关此错误的更多信息。

怎么了？`$mysqli = new mysqli("site.ipagemysql.com", "user", "pass", "database");` 单独工作，所以这不是连接错误吗？还是我必须联系房东？

**我的代码**

```
<?php

    $mysqli = new mysqli("site.ipagemysql.com", "user", "pass", "database");

    /* check connection */ 
    if (mysqli_connect_errno()) {
        printf("Connect failed: %s\n", mysqli_connect_error());
        exit();
    }
    printf("Host information: %s\n", $mysqli->host_info);

    $result = mysqli_query($link, "SELECT DATABASE()")) 
    $row = mysqli_fetch_row($result);
    printf("Default database is %s.\n", $row[0]);
    mysqli_free_result($result);
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T12:44:47.340

您在第 12 行有一个 ) 太多，它缺少分号，并且您没有更改`$link`变量以与第`$mysqli`3 行的变量相对应。

```
$result = mysqli_query($mysqli, "SELECT DATABASE()"); 
```

此外，您将面向对象的风格与程序风格混合在一起。我建议您仅使用 OO 样式。所以代码是：

```
<?php
    $mysqli = new mysqli("site.ipagemysql.com", "user", "pass", "database");

     /* check connection */ 
    if (mysqli_connect_errno()) {
        printf("Connect failed: %s\n", mysqli_connect_error());
        exit();
    }
    printf("Host information: %s\n", $mysqli->host_info);

    $result = mysqli->query("SELECT DATABASE()")) 
    $row = $result->fetch_row();
    printf("Default database is %s.\n", $row[0]);
    $result->close();
    $mysqli->close();
?> 
```

# java - 使用添加的库从命令行编译处理

> ID：13533394
> 
> 赞同：-2
> 
> 时间：2012-11-23T17:16:15.647
> 
> 标签：java, processing

这些天我尝试使用命令行编译 p5。

我对命令行编译不太了解。

虽然我花了很长时间才做到这一点，但我成功了。

我使用 javac 命令如下：

```
javac -d $PATH_TO_BIN -classpath $PATH_TO_JAR: $file_name 
```

但我不能使用添加的库，例如 controlP5。

我想知道如何通过添加库的命令行进行编译。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:37:40.940

如果要从命令行运行，则需要像添加任何其他基于 java .jar 的库一样添加 controlP5 库/.jar 文件，方法是在调用 javac 时将其附加到类路径中。

# asp.net-mvc - 需要帮助来使用 LEFT JOIN 构建 EF 查询

> ID：13533395
> 
> 赞同：1
> 
> 时间：2012-11-23T17:16:25.957
> 
> 标签：asp.net-mvc, entity-framework

我找不到构建 EF (4.1) 查询的正确方法，该查询将返回与包含 LEFT JOIN 的 SQL 相同的结果：

```
SELECT
    s.id_service,
    s.description,
    x.id_service as isDisponible
FROM
    role.service_disponible s
LEFT JOIN
    role.service_disponible_x_ue x
ON s.id_service = x.id_service AND x.id_ue = 1 and flg_actif = '1' 
```

实际上，我只是想获取服务可分配的完整列表（ServiceDisponible），添加一个字段，告诉我服务是否可分配给特定实体（使用 id_ue 过滤），该信息来自多对多相关表（ServiceDisponibleXUe ）。

我的模型是：

![在此处输入图像描述](../Images/b1465ca820bc7ea34b3fb106cc1b1635.png)

理想情况下，我希望这个查询返回这个 viewModel 对象，它基本上是我的 serviceDisponible 域，还有一个字段指示服务的 disponibility。

```
public ServiceDisponibleViewModel(ServiceDisponible ServiceDisponible, bool isDisponible)
{
    this.serviceDisponible = serviceDisponible;
    this.isDisponible = isDisponible;
} 
```

到目前为止，我所拥有的是这个查询，但语法无效：

```
services = context.ServiceDisponible
                  .Select(a => new ServiceDisponibleViewModel
                  {
                    c => new ServiceDisponible
                          {
                            id_service = a.id_service,
                            description = a.description
                          },
                    isDisponible = a.ServiceDisponibleXUe
                                   .Any(b => b.flg_actif && b.id_ue == idUe)
                  }).ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:37:50.823

尝试这个：

```
ServiceDisponibleViewModel services = 
        from sd  in context.ServiceDisponible
        from sdx in context.ServiceDisponibleXUe
                           .Where(x => x.id_ue == 1 && flg_actif == '1' && x.id_service == sd.id_service)
                           .DefaultIfEmpty()
        select new ServiceDisponibleViewModel(
            new ServiceDisponible
            {
            id_service = sd.id_service,
            description = sd.description
            },
            sdx.id_service
        ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T21:28:49.203

以 SQL 为例，通常会让人跳到 linq 中的联接。但是使用导航属性会产生更简洁的语法：

```
from sd  in context.ServiceDisponible
from sdx in sd.ServiceDisponibleXUes.Where(x => x.id_ue == 1 
                                             && x.flg_actif == "1")
              .DefaultIfEmpty()
select new
{   sd.id_service,
    sd.description,
    isDisponible = sdx.id_service
}; 
```

（我忍不住使用了`ServiceDisponibleXUe`imo 更清楚的复数形式）。

# php - PHP 脚本和 HTML - 这适用于 Firefox 和 Chrome，但不适用于 IE

> ID：13533413
> 
> 赞同：3
> 
> 时间：2012-11-23T17:17:42.513
> 
> 标签：php, javascript, html

下面是我试图用于我的网站的内容，这个 php 页面在 Firefox 和 Chrome 中显示没有任何问题。

出于某种原因，它似乎没有在 IE 中运行（在 8 和 9 上测试）我真的不知道这里有什么问题。

我在 IE8 中遇到的错误是“不是有效的二维数组”，这似乎来自谷歌托管的 .js

我想知道为什么这只发生在 IE8 而不是 Chrome 或 Firefox 中？

```
<?php
  // Top snippet of code comes from:
  // www.ip2nation.com/ip2nation/Sample_Scripts/Output_Full_Country_Name
  // and adapted as necessary.

    $server   = 'sanitized'; // MySQL hostname
    $username = 'sanitized'; // MySQL username
    $password = 'sanitized'; // MySQL password
    $dbname   = 'sanitized'; // MySQL db name

    // 1 address per line, or feed with a DB if you're feeling clever.        
    $lines = file('blocklist.txt'); 

    $db = mysql_connect($server, $username, $password) or die(mysql_error());
          mysql_select_db($dbname) or die(mysql_error());

    $bans = array();
    foreach ($lines as $lnum => $line) 
    {
            $l=rtrim($line);
            $sql = 'SELECT 
                        c.country 
                    FROM 
                        ip2nationCountries c,
                        ip2nation i                                                                                                                                             
                    WHERE                                                                                                                                                       
                        i.ip < INET_ATON("'.$l.'")                                                                                                                              
                        AND                                                                                                                                                     
                     c.code = i.country                                                                                                                                         
                    ORDER BY                                                                                                                                                    
                    i.ip DESC                                                                                                                                                   
                    LIMIT 0,1';                                                                                                                                                 
            list($cc) = mysql_fetch_row(mysql_query($sql));                                                                                                                     

            if ($cc != "")                                                                                                                                                      
                    if(empty($bans["$cc"]))                                                                                                                                     
                    {                                                                                                                                                           
                            $bans["$cc"] = 1;                                                                                                                                   
                    }                                                                                                                                                           
                    else                                                                                                                                                       
                    {                                                                                                                                                           
                            $bans["$cc"]++;                                                                                                                                     
                    }                                                                                                                                                           

    }                                                                                                                                                                           

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy for Linux (vers 25 March 2009), see     www.w3.org">
<script type='text/javascript' src='https://www.google.com/jsapi'>
</script>
<script type='text/javascript'>

 google.load('visualization', '1', {'packages': ['geochart']});                                                                                                                 
 google.setOnLoadCallback(drawRegionsMap);                                                                                                                                      

  function drawRegionsMap() {
    var data = google.visualization.arrayToDataTable([
    ['Country','Blocks'],
  <?php
    foreach ($bans as $key => $value)
                print"['$key', $value],\n";
    ?>
    ]);

    var options = {
                    backgroundColor : '#baecfd',
                    colors : ['#FFFFFF', '#FF0000']
                    };

    var chart = new google.visualization.GeoChart(document.getElementById('chart_div'));
    chart.draw(data, options);
};
</script>
<title></title>

<style type="text/css">
 div.c1 {width: 900px; height: 500px;}
</style>
</head>
<body>
<div id="chart_div" class="c1"></div>
</body>
</html> 
```

在IE中编译时的代码是：

```
<html>                                                                                                                                                                              
  <head>                                                                                                                                                                            
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>                                                                                                     
    <script type='text/javascript'>                                                                                                                                                 
     google.load('visualization', '1', {'packages': ['geochart']});                                                                                                                 
     google.setOnLoadCallback(drawRegionsMap);                                                                                                                                      

  function drawRegionsMap() {
    var data = google.visualization.arrayToDataTable([
    ['Country','Blocks']
  ['Japan', 11]
['United States', 45]
['Argentina', 1]
['Brazil', 1]
['Bosnia and Herzegovina', 1]
['Germany', 4]
['France', 2]
['Russia', 5]
['China', 24]
['Thailand', 1]
['New Zealand (Aotearoa)', 1]
['Turkey', 1]
['Korea (South)', 6]
['Panama', 2]
['Taiwan', 6]
['Canada', 14]
['Luxembourg', 1]
['United Kingdom', 1]
['Philippines', 1]
['Singapore', 3]
['Switzerland', 2]
['Hong Kong', 2]
    ]);

    var options = {
                    backgroundColor : '#25383c',
                    colors : ['#FFFFFF', '#FF0000']
                    };

    var chart = new google.visualization.GeoChart(document.getElementById('chart_div'));
    chart.draw(data, options);
    };
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

在 Chrome 中编译时的代码是：

```
<html>                                                                                                                                                                              
  <head>                                                                                                                                                                            
<script type='text/javascript' src='https://www.google.com/jsapi'></script>                                                                                                     
<script type='text/javascript'>                                                                                                                                                 
 google.load('visualization', '1', {'packages': ['geochart']});                                                                                                                 
 google.setOnLoadCallback(drawRegionsMap);                                                                                                                                      

  function drawRegionsMap() {
    var data = google.visualization.arrayToDataTable([
    ['Country','Blocks'],
  ['Japan', 11],
['United States', 45],
['Argentina', 1],
['Brazil', 1],
['Bosnia and Herzegovina', 1],
['Germany', 4],
['France', 2],
['Russia', 5],
['China', 24],
['Thailand', 1],
['New Zealand (Aotearoa)', 1],
['Turkey', 1],
['Korea (South)', 6],
['Panama', 2],
['Taiwan', 6],
['Canada', 14],
['Luxembourg', 1],
['United Kingdom', 1],
['Philippines', 1],
['Singapore', 3],
['Switzerland', 2],
['Hong Kong', 2],
    ]);

    var options = {
                    backgroundColor : '#25383c',
                        colors : ['#FFFFFF', '#FF0000']
                        };

        var chart = new google.visualization.GeoChart(document.getElementById('chart_div'));
        chart.draw(data, options);
    };
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:23:14.030

```
var data = google.visualization.arrayToDataTable([
    ['Country','Blocks'],
  <?php
    foreach ($bans as $key => $value)
                print"['$key', $value],\n";
    ?>
    ]); 
```

将返回：

```
var data = google.visualization.arrayToDataTable([
    ['key1', value1],
    ['key2', value2],
]); 
```

第二个末尾的额外逗号将打破它。看到这个：

[http://www.openjs.com/articles/ie/array_comma_problem.php](http://www.openjs.com/articles/ie/array_comma_problem.php)

```
var sample = {
    'hello':'world',
    'foo':'bar', //This is 'the last comma'
}

alert("Hello World"); 
```

[http://jsfiddle.net/A5VMW/](http://jsfiddle.net/A5VMW/)

在大多数浏览器中，最后的 ',' 是可选的 - 它的存在不会对脚本产生任何影响。但是 IE 会决定做一些无法解释的事情——它只是忽略那段代码之后的所有内容。在 IE 浏览器中永远不会看到“Hello World”警报。

另请参阅：[https](https://stackoverflow.com/a/5139395/504299) ://stackoverflow.com/a/5139395/504299 ：

> 从历史上看，ES3 不允许在定义对象字面量时使用尾随逗号。这是 IE 做对的一件事，但大多数其他的 Bowser 供应商都往南走，并允许尾随逗号。所以从技术上讲，这是支持它的其他浏览器中的一个错误。

# c - 没有从 Pollard 的 rho 算法实现中获得正确的输出

> ID：13533414
> 
> 赞同：3
> 
> 时间：2012-11-23T17:17:57.173
> 
> 标签：c, algorithm, recursion, prime-factoring

我不知道在尝试使用 Pollard 的 rho 算法计算素数分解时我做错了什么。

```
#include<stdio.h>
#define f(x)  x*x-1

int pollard( int );
int gcd( int, int);

int main( void ) {
    int n;
    scanf( "%d",&n );
    pollard( n );
    return 0;  
}

int pollard( int n ) {
    int i=1,x,y,k=2,d;
    x = rand()%n;
    y = x;

    while(1) {
        i++;
        x = f( x ) % n;
        d = gcd( y-x, n);

        if(d!=1 && d!=n)
            printf( "%d\n", d);

        if(i == k) {
            y = x;
            k = 2 * k;
        }
    }
}   
int gcd( int a, int b ) {

    if( b == 0) 
        return a;
    else 
        return gcd( b, a % b);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T20:01:06.943

一个直接的问题是，[正如 Peter de Rivaz 怀疑](https://stackoverflow.com/questions/13533414/not-getting-proper-output-from-pollards-rho-algorithm-implementation#comment18532156_13533414)的那样

```
#define f(x)  x*x-1 
```

因此这条线

```
x = f(x)%n; 
```

变成

```
x = x*x-1%n; 
```

并且 的优先级`%`高于 的`-`，因此表达式被隐式括起来为

```
x = (x*x) - (1%n); 
```

这相当于`x = x*x - 1;`（我假设`n > 1`，无论如何它是`x = x*x - constant;`），如果你从一个 value 开始`x >= 2`，在你有机会找到一个因素之前你已经溢出了：

2 -> 2*2-1 = 3 -> 3*3 - 1 = 8 -> 8*8 - 1 = 63 -> 3968 -> 15745023 -> 如果 int 为 32 位则溢出

不过，这并不会立即使这`gcd(y-x,n)`是一个因素成为不可能。它只是使得在理论上，您可能已经找到一个因子的阶段，溢出破坏了数学上存在的公因子 - 比溢出引入的公因子更有可能。

有符号整数的溢出是未定义的行为，因此无法保证程序的行为方式，但通常它的行为是一致的，因此迭代`f`仍然会产生一个定义明确的序列，该算法原则上适用于该序列。

另一个问题是它`y-x`经常是负数，然后计算`gcd`也可能是负数 - 经常`-1`。在这种情况下，您打印`-1`.

然后，`f`从起始值迭代未检测到公共因子的情况并不少见，因为以两个素因子为模的循环（例如`n`两个不同素数的乘积）具有相等的长度并且在同时。您没有尝试发现此类情况；无论何时`gcd(|y-x|, n) == n`，该序列中的任何进一步工作都是毫无意义的，因此您应该`break`在何时退出循环`d == n`。

此外，您永远不会检查是否`n`是素数，在这种情况下，试图找到一个因素从一开始就是徒劳的。

此外，在修复后`f(x)`，`% n`适用于 的完整结果`f(x)`，您`x*x`仍然会溢出相对较小的问题`x`（使用标准带符号的 32 位`int`s，对于`x >= 46341`），因此较大的因式分解`n`可能由于溢出而失败。至少，您应该`unsigned long long`用于计算，以免`n < 2^32`. 然而，对如此小的数字进行因式分解通常通过试除法更有效地完成。Pollard 的 Rho 方法和其他先进的因式分解算法适用于较大的数字，其中试除法不再有效甚至不可行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T22:08:42.007

我只是 C++ 的新手，而且我是 Stack Overflow 的新手，所以我写的一些内容看起来很草率，但这应该会让你朝着正确的方向前进。此处发布的程序通常应该找到并返回您在提示时输入的数字的一个重要因素，否则如果找不到这样的因素，它会道歉。

我用几个半素数测试了它，它对我有用。对于 371156167103，它在我按下回车键后发现 607619 没有任何可检测到的延迟。我没有用比这更大的数字检查它。我使用了 unsigned long long 变量，但如果可能，您应该获取并使用提供更大整数类型的库。

编辑添加，对 X 的方法 f 的单一调用和对 Y 的 2 次这样的调用是有意的，并且符合算法的工作方式。我想将对 Y 的调用嵌套在另一个这样的调用中以使其保持在一条线上，但我决定这样做，这样更容易理解。

```
#include "stdafx.h"
#include <stdio.h>
#include <iostream>
typedef unsigned long long ULL;

ULL pollard(ULL numberToFactor);
ULL gcd(ULL differenceBetweenCongruentFunctions, ULL numberToFactor);
ULL f(ULL x, ULL numberToFactor);

int main(void)
{
    ULL factor;
    ULL n;
    std::cout<<"Enter the number for which you want a prime factor: ";
    std::cin>>n;
    factor = pollard(n);
    if (factor == 0) std::cout<<"No factor found.  Your number may be prime, but it is     not certain.\n\n";
    else std::cout<<"One factor is: "<<factor<<"\n\n";
}

ULL pollard(ULL n)
{
    ULL x = 2ULL;
    ULL y = 2ULL;
    ULL d = 1ULL;

    while(d==1||d==n)
    {
        x = f(x,n);
        y = f(y,n);
        y = f(y,n);
        if (y>x)
        {
            d = gcd(y-x, n);
        }
        else
        {
            d = gcd(x-y, n);
        }
    }

    return d;

}

ULL gcd(ULL a, ULL b)
{
    if (a==b||a==0)
        return 0;   // If x==y or if the absolute value of (x-y) == the number     to be factored, then we have failed to find
                    // a factor.  I think this is not proof of     primality, so the process could be repeated with a new function.
                    // For example, by replacing x*x+1 with x*x+2, and     so on.  If many such functions fail, primality is likely.

    ULL currentGCD = 1;
    while (currentGCD!=0) // This while loop is based on Euclid's algorithm
    {
        currentGCD = b % a;
        b=a;
        a=currentGCD;
    }

    return b;
}

ULL f(ULL x, ULL n)
{
    return (x * x + 1) % n;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T18:13:20.687

很抱歉长时间延迟回到这个问题。正如我在第一个答案中提到的那样，我是 C++ 的新手，这在我过度使用全局变量、过度使用 BigIntegers 和 BigUnsigned（其他类型可能更好）、缺乏错误检查以及其他编程习惯上很明显更熟练的人可能不会展示的展示。话虽如此，让我解释一下我做了什么，然后将发布代码。

我在第二个答案中这样做是因为第一个答案作为一个非常简单的演示很有用，一旦您了解了 Pollard 的 Rho 算法的作用，它是如何实现的。它的作用是首先取 2 个变量，称它们为 x 和 y，并为它们分配起始值 2。然后它通过一个函数运行 x，通常是 (x^2+1)%n，其中 n 是你的数字想考虑因素。它每个周期两次通过相同的函数运行 y。然后计算 x 和 y 的差值，最后找到这个差值和 n 的最大公约数。如果该数字为 1，则您再次通过该函数运行 x 和 y。

继续这个过程，直到 GCD 不为 1 或直到 x 和 y 再次相等。如果找到不为 1 的 GCD，则该 GCD 是 n 的非平凡因数。如果 x 和 y 相等，则 (x^2+1)%n 函数失败。在这种情况下，您应该使用另一个函数重试，可能是 (x^2+2)%n，等等。

这是一个例子。以 35 为例，我们知道其质因数是 5 和 7。我将介绍 Pollard Rho 并向您展示它是如何找到一个非平凡因数的。

循环#1：X 从 2 开始。然后使用函数 (x^2+1)%n, (2^2+1)%35，我们得到 x 的 5。Y 也是从 2 开始，经过一次函数运行后，它的值也是 5。但是 y 总是经过两次函数，所以第二次运行是 (5^2+1)%35，即 26。 x 和 y 的差是 21。21（差）和 35（n）的 GCD 是 7。我们已经找到了 35 的质因数！请注意，任何 2 个数字的 GCD，即使是非常大的指数，都可以通过使用欧几里得算法的公式非常快速地找到，这就是我将在此处发布的程序所做的。

关于 GCD 函数，我正在使用我为这个程序下载的一个库，一个允许我使用 BigIntegers 和 BigUnsigned 的库。该库还内置了 GCD 函数，我本可以使用它。但出于教学目的，我决定继续使用手写 GCD 功能。如果您想提高程序的执行时间，使用库的 GCD 函数可能是个好主意，因为有比 Euclid 更快的方法，并且可以编写库以使用其中一种更快的方法。

另一个旁注。.Net 4.5 库也支持使用 BigIntegers 和 BigUnsigned。我决定不在这个程序中使用它，因为我想用 C++ 编写整个东西，而不是 C++/CLI。您可以从 .Net 库中获得更好的性能，或者您可能不会。我不知道，但我想分享这也是一种选择。

我在这里有点跳跃，所以现在让我先大致解释一下程序的作用，最后我将解释如果你使用 Visual Studio 11（也称为 Visual Studio 2012），如何在你的计算机上设置它。

该程序分配 3 个数组来存储您给它处理的任何数字的因子。这些数组有 1000 个元素宽，这可能是多余的，但它确保任何具有 1000 个或更少质因数的数字都适合。

当您在提示符处输入数字时，它假定该数字是复合数字，并将其放入复合因子数组的第一个元素中。然后它会经历一些公认的效率低下的 while 循环，这些循环使用 Miller-Rabin 来检查数字是否是合数。请注意，此测试可以说一个数字是具有 100% 置信度的复合数，也可以说该数字是具有极高（但不是 100%）置信度的素数。置信度可通过程序中的变量 confidenceFactor 进行调整。该程序将对 2 和 confidenceFactor 之间的每个值进行一次检查，包括在内，因此总检查次数比 confidenceFactor 本身的值少。

我对 confidenceFactor 的设置是 101，它会进行 100 次检查。如果它说一个数字是素数，那么它真正复合的几率是 4^100 中的 1，或者与连续 200 次正确掷硬币的几率相同。简而言之，如果它说这个数字是素数，它可能是，但是可以增加confidenceFactor 数字，以牺牲速度来获得更大的信心。

这里可能是一个值得提及的好地方，虽然 Pollard 的 Rho 算法可以非常有效地分解较小数量的 long long 类型，但如果没有 BigInteger，Miller-Rabin 测试来查看一个数字是否是复合的或多或少是无用的和 BigUnsigned 类型。BigInteger 库几乎需要能够可靠地将大数分解为像这样的素数。

当 Miller Rabin 说因子是复合因子时，它是因子，因子存储在临时数组中，复合数组中的原始因子除以相同的因子。当数字被识别为可能的素数时，它们被移动到素数数组并输出到屏幕。这个过程一直持续到没有剩下的复合因子。这些因素往往是按升序排列的，但这是巧合。该程序不会按升序列出它们，而只会在找到它们时列出它们。

请注意，无论我给 c 的值是多少，我都找不到任何可以将数字 4 分解的函数 (x^2+c)%n。Pollard Rho 似乎很难使用所有完美的正方形，但 4 是我发现的唯一一个使用所描述格式的函数完全不受它影响的合数。因此，我在 pollard 方法中添加了一个 n 是否为 4 的检查，如果是，则立即返回 2。

所以要设置这个程序，这是你应该做的。转到[https://mattmccutchen.net/bigint/](https://mattmccutchen.net/bigint/)并下载 bigint-2010.04.30.zip。解压并将所有 .hh 文件和所有 C++ 源文件放在 ~\Program Files\Microsoft Visual Studio 11.0\VC\include 目录中，不包括 Sample 和 C++ Testsuite 源文件。然后在 Visual Studio 中，创建一个空项目。在解决方案资源管理器中，右键单击资源文件文件夹并选择添加...现有项目。在我刚才提到的目录中添加所有 C++ 源文件。然后也在解决方案资源管理器中，右键单击 Source Files 文件夹并添加一个新项目，选择 C++ 文件，为其命名，然后将以下源代码粘贴到其中，它应该适合您。

不要过分奉承，但是 Stack Overflow 上有些人比我更了解 C++，如果他们修改下面的代码以使其更好，那就太棒了。但即使没有，代码也是按原样运行的，它应该有助于说明以编程方式查找中型数字的素因子所涉及的原则。它不会威胁到一般数字域筛，但它可以在相当短的时间内分解具有 12 - 14 位素数的数字，即使在像我正在使用的旧 Core2 Duo 计算机上也是如此。

代码如下。祝你好运。

```
#include <string>
#include <stdio.h>
#include <iostream>
#include "BigIntegerLibrary.hh"

typedef BigInteger BI;
typedef BigUnsigned BU;

using std::string;
using std::cin;
using std::cout;

BU pollard(BU numberToFactor);
BU gcda(BU differenceBetweenCongruentFunctions, BU numberToFactor);
BU f(BU x, BU numberToFactor, int increment);
void initializeArrays();
BU getNumberToFactor ();
void factorComposites();
bool testForComposite (BU num);

BU primeFactors[1000];
BU compositeFactors[1000];
BU tempFactors [1000];
int primeIndex;
int compositeIndex;
int tempIndex;
int numberOfCompositeFactors;
bool allJTestsShowComposite;

int main ()
{
    while(1)
    {
        primeIndex=0;
        compositeIndex=0;
        tempIndex=0;
        initializeArrays();
        compositeFactors[0] = getNumberToFactor();
        cout<<"\n\n";
        if (compositeFactors[0] == 0) return 0;
        numberOfCompositeFactors = 1;
        factorComposites();
    }
}

void initializeArrays()
{
    for (int i = 0; i<1000;i++)
    {
        primeFactors[i] = 0;
        compositeFactors[i]=0;
        tempFactors[i]=0;
    }
}

BU getNumberToFactor ()
{
    std::string s;
    std::cout<<"Enter the number for which you want a prime factor, or 0 to quit: ";
    std::cin>>s;
    return stringToBigUnsigned(s);
}

void factorComposites()
{
    while (numberOfCompositeFactors!=0)
    {
        compositeIndex = 0;
        tempIndex = 0;

        // This while loop finds non-zero values in compositeFactors.
        // If they are composite, it factors them and puts one factor in tempFactors,
        // then divides the element in compositeFactors by the same amount.
        // If the element is prime, it moves it into tempFactors (zeros the element in compositeFactors)
        while (compositeIndex < 1000)
        {
            if(compositeFactors[compositeIndex] == 0)
            {
                compositeIndex++;
                continue;
            }
            if(testForComposite(compositeFactors[compositeIndex]) == false)
            {
                tempFactors[tempIndex] = compositeFactors[compositeIndex];
                compositeFactors[compositeIndex] = 0;
                tempIndex++;
                compositeIndex++;
            }
            else
            {
                tempFactors[tempIndex] = pollard (compositeFactors[compositeIndex]);
                compositeFactors[compositeIndex] /= tempFactors[tempIndex];
                tempIndex++;
                compositeIndex++;
            }
        }
        compositeIndex = 0;

        // This while loop moves all remaining non-zero values from compositeFactors into tempFactors
        // When it is done, compositeFactors should be all 0 value elements
        while (compositeIndex < 1000)
        {
            if (compositeFactors[compositeIndex] != 0)
            {
                tempFactors[tempIndex] = compositeFactors[compositeIndex];
                compositeFactors[compositeIndex] = 0;
                tempIndex++;
                compositeIndex++;
            }
            else compositeIndex++;
        }
        compositeIndex = 0;
        tempIndex = 0;

        // This while loop checks all non-zero elements in tempIndex.
        // Those that are prime are shown on screen and moved to primeFactors
        // Those that are composite are moved to compositeFactors
        // When this is done, all elements in tempFactors should be 0
        while (tempIndex<1000)
        {
            if(tempFactors[tempIndex] == 0)
            {
                tempIndex++;
                continue;
            }
            if(testForComposite(tempFactors[tempIndex]) == false)
            {
                primeFactors[primeIndex] = tempFactors[tempIndex];
                cout<<primeFactors[primeIndex]<<"\n";
                tempFactors[tempIndex]=0;
                primeIndex++;
                tempIndex++;
            }
            else
            {
                compositeFactors[compositeIndex] = tempFactors[tempIndex];
                tempFactors[tempIndex]=0;
                compositeIndex++;
                tempIndex++;
            }
        }
        compositeIndex=0;
        numberOfCompositeFactors=0;

        // This while loop just checks to be sure there are still one or more composite factors.
        // As long as there are, the outer while loop will repeat
        while(compositeIndex<1000)
        {
            if(compositeFactors[compositeIndex]!=0) numberOfCompositeFactors++;
            compositeIndex ++;
        }
    }
    return;
}

// The following method uses the Miller-Rabin primality test to prove with 100% confidence a given number is     composite,
// or to establish with a high level of confidence -- but not 100% -- that it is prime

bool testForComposite (BU num)
{
    BU confidenceFactor = 101;
    if (confidenceFactor >= num) confidenceFactor = num-1;
    BU a,d,s, nMinusOne;
    nMinusOne=num-1;
    d=nMinusOne;
    s=0;
    while(modexp(d,1,2)==0)
    {
        d /= 2;
        s++;
    }
    allJTestsShowComposite = true; // assume composite here until we can prove otherwise
    for (BI i = 2 ; i<=confidenceFactor;i++)
    {
        if (modexp(i,d,num) == 1) 
            continue;  // if this modulus is 1, then we cannot prove that num is composite with this     value of i, so continue
        if (modexp(i,d,num) == nMinusOne)
        {
            allJTestsShowComposite = false;
            continue;
        }
        BU exponent(1);     
        for (BU j(0); j.toInt()<=s.toInt()-1;j++)
        {
            exponent *= 2;
            if (modexp(i,exponent*d,num) == nMinusOne)
            {
                // if the modulus is not right for even a single j, then break and increment i.
                allJTestsShowComposite = false;
                continue;
            }
        }
        if (allJTestsShowComposite == true) return true; // proven composite with 100% certainty, no need     to continue testing
    }
    return false;
    /* not proven composite in any test, so assume prime with a possibility of error = 
    (1/4)^(number of different values of i tested).  This will be equal to the value of the
    confidenceFactor variable, and the "witnesses" to the primality of the number being tested will be all     integers from
    2 through the value of confidenceFactor.

    Note that this makes this primality test cryptographically less secure than it could be.  It is     theoretically possible,
    if difficult, for a malicious party to pass a known composite number for which all of the lowest n integers     fail to
    detect that it is composite.  A safer way is to generate random integers in the outer "for" loop and use     those in place of
    the variable i.  Better still if those random numbers are checked to ensure no duplicates are generated.
    */
}

BU pollard(BU n)
{
    if (n == 4) return 2;
    BU x = 2;
    BU y = 2;
    BU d = 1;
    int increment = 1;

    while(d==1||d==n||d==0)
    {
        x = f(x,n, increment);
        y = f(y,n, increment);
        y = f(y,n, increment);
        if (y>x)
        {
            d = gcda(y-x, n);
        }
        else
        {
            d = gcda(x-y, n);
        }
        if (d==0) 
        {
            x = 2;
            y = 2;
            d = 1;
            increment++; // This changes the pseudorandom function we use to increment x and y
        }
    }
    return d;
}

BU gcda(BU a, BU b)
{
    if (a==b||a==0)
        return 0;   // If x==y or if the absolute value of (x-y) == the number to be factored, then we     have failed to find
                    // a factor.  I think this is not proof of primality, so the process could     be repeated with a new function.
                    // For example, by replacing x*x+1 with x*x+2, and so on.  If many such     functions fail, primality is likely.

    BU currentGCD = 1;
    while (currentGCD!=0) // This while loop is based on Euclid's algorithm
    {
        currentGCD = b % a;
        b=a;
        a=currentGCD;
    }
    return b;
}

BU f(BU x, BU n, int increment)
{
    return (x * x + increment) % n;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:55:56.867

据我所知，Pollard Rho 通常使用`f(x)`as `(x*x+1)`（例如在这些[讲义中](http://www.mpi-inf.mpg.de/~csaha/lectures/lec18.pdf)）。

您的选择`x*x-1`似乎不如它经常陷入循环中那么好：

```
 x=0
 f(x)=-1
 f(f(x))=0 
```

# r - 无法在 Mac 上使用 ggsave 保存 ggplot2 图形

> ID：13533415
> 
> 赞同：1
> 
> 时间：2012-11-23T17:18:10.130
> 
> 标签：r, graphics, export, ggplot2, osx-mountain-lion

使用此代码成功创建图表后：

```
qplot(ethcat3, Percent, data=g_02_1b_pov, geom="bar", stat="identity") 
```

我想将图形保存为 png、pdf 或 jpeg 文件。我使用了以下代码：

```
ggsave(ﬁle="test.png") 
```

我没有输出图表，而是收到以下（错误）消息：

```
Saving 7.82 x 3.75 in image
Error in eval(expr, envir, enclos) : attempt to apply non-function 
```

并且没有文件被保存。（而不是 png，我还尝试了扩展 pdf 和 jpeg）。

我在一个论坛上发现我应该使用命令：dev_mode() 和 has_devel()

dev_mode 的输出是：

```
> dev_mode()
Dev mode: OFF 
```

和

```
> has_devel()
/Library/Frameworks/R.framework/Resources/bin/R --vanilla CMD SHLIB foo.c 

sh: make: command not found
Error: Command failed (1) 
```

但是，我不知道如何处理此反馈？

谁能帮我解决这个问题？我想我过去在 PC 上使用了相同的方法，并且没有问题。我想知道它是否连接到我在mac上的安装？

非常感谢！

加法：@DWin 要求`sessionInfo()`输出：

```
d> sessionInfo() 
R version 2.15.1 (2012-06-22)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C/en_US.UTF-8/C/C/C/C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] devtools_0.8    reshape2_1.2.1  plyr_1.7.1      ggplot2_0.9.2.1

loaded via a namespace (and not attached):
 [1] MASS_7.3-18        RColorBrewer_1.0-5 RCurl_1.95-3       colorspace_1.2-0  
 [5] dichromat_1.2-4    digest_0.5.2       evaluate_0.4.2     grid_2.15.1       
 [9] gtable_0.1.1       httr_0.2           labeling_0.1       memoise_0.1       
[13] munsell_0.4        parallel_2.15.1    proto_0.3-9.2      scales_0.2.2      
[17] stringr_0.6.1      tools_2.15.1       whisker_0.1 
```

# tfs - BizTalk 2010 - 找不到文件'Microsoft.BizTalk.TOM.resources

> ID：13533421
> 
> 赞同：0
> 
> 时间：2012-11-23T17:19:01.320
> 
> 标签：tfs, biztalk

我有一个 VS2010 TFS 构建服务器，配置了构建定义集以进行连续配置。

对于我的 BizTalk 2010 解决方案，我有 200 多个测试。这些测试在我的开发盒上运行正常，但在构建服务器上，对于处理平面文件的测试，我收到错误“无法找到 Microsoft.BizTalk.Tom.resources”。我的猜测是这是一个包含在**Microsoft.BizTalk.TOM.dll**程序集中的资源文件，尽管我使用了反射器并且看不到资源。

事实证明 Microsoft.BizTalk.TOM.dll 是一个 .Net 2 dll，它与 BizTalk 一起安装到以下文件夹中：

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\PublicAssemblies 
```

我已经检查了构建服务器并确认该程序集存在于上述文件夹中。

根据围绕同一问题的 3 篇不同的博客文章，我尝试了以下方法：

1.  包括对 dll 的引用并将 copylocal 设置为 true
2.  将程序集添加到 .Net 2 GAC
3.  从“测试设置”对话框/“部署”选项卡将程序集添加到“要部署的其他文件”列表中
4.  从“测试设置”对话框/“单元测试”选项卡将程序集添加到“运行测试时使用的文件夹”列表

测试失败后，我检查 \TestResults\Out 文件夹。我可以看到这里复制了 Microsoft.BizTalk.TOM.dll。

当我检查开发服务器上的等效文件夹时，我看不到构建服务器上不存在的任何文件。

有什么想法我可以尝试下一步吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T10:23:01.653

我在文件夹中找到了 Microsoft.BizTalk.Tom.dll 的副本：C:\Users\tfs_service\AppData\Local\assembly\dl3\randomname\

经过研究，原来这是存储“影子副本”程序集的位置： [什么是缓存 AppData\Local\assembly\dl3？](https://stackoverflow.com/questions/8309411/what-is-cache-appdata-local-assembly-dl3)

我想知道为什么要制作卷影副本以及如何防止它，我想在我的情况下应用程序域是 MsTest？

我删除了卷影副本并从 GAC 中卸载，因此我只剩下以下文件夹中的副本：

*   C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\PublicAssemblies
*   C:\Program Files (x86)\Common Files\Microsoft BizTalk

删除卷影副本并重新启动服务器后，测试现在可以成功运行。

# game-physics - 哪些折射光线是相关的？

> ID：13533435
> 
> 赞同：0
> 
> 时间：2012-11-23T17:20:19.900
> 
> 标签：game-physics, raytracing

假设我有一个球体。光线射到球体上，它折射并进入内部，然后再次击中球体，这次是从内部。我拿这个颜色吗？或者我应该忽略这种颜色并再次折射，退出球体并从环境中收集颜色？换句话说，我只考虑第二条折射光线的颜色，即离开球体的颜色？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T17:00:17.980

这取决于材料成分。射线穿过材料会熄灭多少？决定追踪多远的两种最常见的方法是将反弹和折射的数量限制为绝对数量，或者跟踪每一步的最大贡献量——如果它低于例如 0.5%在预期的显示范围内，很有可能可以安全地停止光线链。或者你只是碰到一个完全不透明的表面或空白空间。

# extjs - 将 Extjs Ajax 代理与 rails rest 服务器一起使用

> ID：13533437
> 
> 赞同：1
> 
> 时间：2012-11-23T17:21:15.577
> 
> 标签：extjs, extjs4

我正在尝试通过 GET 方法调用我的服务器操作 /users/menus，但它似乎只能与 REST 代理一起使用。

这是我的商店声明：

```
Ext.define('App.store.Menu', {
extend: 'Ext.data.Store',   
model: 'App.model.Menu',
proxy: {
    type: 'ajax',
    reader: {
        type: 'json'        
    },
    api: {
        read: 'users/menus'
    }
}
}); 
```

这是我加载商店的方式：

```
var store = Ext.create('App.store.Menu').load({
    id: 1,
    callback: function () {
        //do something...
    }
}); 
```

这是我的rails代码：

```
def menus
  @user = User.find(params[:id])  
  @menus = @user.menus
  respond_to do |format|
    format.html # menus.html.erb
    format.json { render json: @menus }
  end
end 
```

我在服务器上收到此错误：

```
ActiveRecord::RecordNotFound (Couldn't find User with id=menus):
  app/controllers/users_controller.rb:16:in `show' 
```

但如果我使用 REST 代理，我会收到正确的请求：

```
Ext.define('App.store.Menu', {
    extend: 'Ext.data.Store',   
    model: 'App.model.Menu',
    proxy: {
      type: 'rest',
      format: 'json',
      url: 'users/menus'
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T16:22:35.237

那是因为您的 url 架构是 REST 架构，然后您应该使用 REST 代理。这是两个代理发送 Id 值的方式：

**Ajax 代理**：yourdomain.com/users/menus?id=1

**休息代理**：yourdomain.com/users/menus/1

当您的应用程序了解休息模式时，没有理由使用 ajax 代理。但是，如果您想强制执行某些操作以便能够使用 ajax 请求，您可以按如下方式修改您的代理：

```
Ext.define('App.store.Menu', {
    extend: 'Ext.data.Store',   
    model: 'App.model.Menu',
    proxy: {
        type: 'ajax',
        url: 'users/menus',
        reader: {
            type: 'json'        
        },
        buildUrl: function(request) {
            debugger;
            var me = this,
                url = me.getUrl(request),
                operation = request.operation,
                id  = operation.id;

            if (id) {
                if (!url.match(/\/$/)) {
                    url += '/';
                }

                url += id;
            }  
            return url;            
        }
    }    
}); 
```

这与 rest 代理类似，但它是一个 ajax 代理。

祝你好运！

# python - Python Class function calls

> ID：13533438
> 
> 赞同：0
> 
> 时间：2012-11-23T17:21:29.260
> 
> 标签：python, class, function

I have the following code

```
class myclass(object):
    def __init__(self):
        self._fileA = os.path.join(dir, file)
        self._stuffA = 'NONE'

    def log(self, message):
        # Checks if the log file exists and if not creates a new one. 
        # Attempts to open the log file. If it cannot it raises an error
        try:
            log_file = open(self._fileA, 'ab')
        except IOError, e:
            print "!!! ERROR !!! - " + str(e)
            return 0

        now = datetime.datetime.now()
        # Sets up the date and the log file entry
        message = now.strftime("%Y-%m-%d %H:%M:%S") + ' - ' + str(message)
        # Writes the log entry then places a newline and closes the log file.
        log_file.write(logmsg)
        log_file.write('\n')
        log_file.close()

    def cleanup(self):
        logmsg = '----- ENDED SEARCH -----'
        self.log(logmsg) 
```

Now this is just a snippet I left out quite a bit. But when the log function is being called from within my class. It just writes the last message to the file vice the new one being sent to it from the cleanup function. Any ideas on how to fix this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:30:48.083

You write `logmsg` to the file, but never define it in your function:

```
 log_file.write(logmsg) 
```

You must have a `logmsg` global that is being used instead.

Your actual message variable is called `message`, write that instead:

```
 log_file.write(message) 
```

# ruby-on-rails - 这行代码“期望 { |b| 5.tap(&b) }.to yield_control” 在功能上实现了什么？

> ID：13533439
> 
> 赞同：1
> 
> 时间：2012-11-23T17:21:40.520
> 
> 标签：ruby-on-rails, ruby, rspec-rails

通过 rspec 文档，我在本页[http://rubydoc.info/gems/rspec-expectations/frames的 yield 部分找到了这些代码行](http://rubydoc.info/gems/rspec-expectations/frames)

任何人都可以逐步解释产生部分中的每一行代码的作用吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T18:48:09.413

**做什么`expect { |b| 5.tap(&b) }.to yield_control`？**

期望块中给出的代码调用`yield`语句。

块中给出的代码（即`{ |b| 5.tap(&b) }`）调用[ruby​​ 1.9 tap 方法](http://ruby-doc.org/core-1.9.3/Object.html#method-i-tap)，该方法在其实现中有一个`yield`语句。

因此，该声明有效地断言 ruby​​ 1.9 的 tap 方法有一个`yield`声明。:-)

为了更好地理解此语句，请尝试以下代码示例：

`order.rb`文件

```
class Order
end 
```

`order_spec.rb`文件

```
require 'rspec-expectations'
require './order'

describe Order do
  it "should yield regardless of yielded args" do
    expect { |b| 5.tap(&b);puts "The value of b is #{b.inspect}" }.to yield_control
  end
end 
```

执行规范的输出：

```
$ rspec yield_spec.rb

Order
The value of b is #<RSpec::Matchers::BuiltIn::YieldProbe:0x000001008745f0 @used=true, @num_yields=1, @yielded_args=[[5]]>
  should yield regardless of yielded args

Finished in 0.01028 seconds
1 example, 0 failures 
```

要理解 yield 部分的其他行，类似地`expect`在 spec 文件中包含如下语句：

```
 it "should yield with no args" do
    expect { |b| Order.yield_if_true(true, &b) }.to yield_with_no_args
  end 
      it "should yield with 5 args" do
    expect { |b| 5.tap(&b) }.to yield_with_args(5)
  end 

  it "should yield with integer args" do
    expect { |b| 5.tap(&b) }.to yield_with_args(Fixnum)
  end 

  it "should yield with string args" do        
    expect { |b| "a string".tap(&b) }.to yield_with_args(/str/)
  end 

  it "should yield 1,2,3 successively" do
    expect { |b| [1, 2, 3].each(&b) }.to yield_successive_args(1, 2, 3)
  end 

  it "should yield ([:a,1], [:b,2]) successively" do
    expect { |b| { :a => 1, :b => 2 }.each(&b) }.to yield_successive_args([:a, 1], [:b, 2]) 
  end 
```

注意：`yield_if_true`第二行中使用的方法似乎从最初定义的地方删除；我通过将其添加到 Order 类中使其工作，如下所示：

```
class Order
  def self.yield_if_true(flag)
    yield if flag
  end
end 
```

# nginx - 访问 nginx x-accel 请求标头

> ID：13533440
> 
> 赞同：2
> 
> 时间：2012-11-23T17:21:42.083
> 
> 标签：nginx

我正在尝试使用 X-Accel 将有关请求的信息传递给内部重定向的 uri。

```
 location / {
      root /web/external;
      include fastcgi.conf;
      fastcgi_param SCRIPT_FILENAME $document_root/check.php;
      fastcgi_pass unix:/services/.sock/fastcgi.sock;
   }       
   location /internal/ {
      internal;
      alias /web/internal;
      include fastcgi.conf;
      fastcgi_param SCRIPT_FILENAME $document_root/app.php;
      fastcgi_pass unix:/services/.sock/fastcgi.sock;
   } 
```

check.php 将 X-Accel-Redirect 标头返回到 /internal/$uri 并发送我想传递给内部请求的其他标头值。我尝试使用 $sent_header_* 访问标题，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T03:05:22.590

我发现了一个似乎更适合我的用例的第 3 方模块。虽然我希望它是我能找到“内置”的东西

ngx_http_auth_request_module

[http://mdounin.ru/hg/ngx_http_auth_request_module/file/tip/README](http://mdounin.ru/hg/ngx_http_auth_request_module/file/tip/README) http://mdounin.ru/hg/ngx_http_auth_request_module/file/tip/t/auth-request-set.t

配置将更改为：

```
location / {
    auth_request /check;
    auth_request_set $value $upstream_http_x_value;
    add_header X-Set-Value $value;
    root /web/internal;
    include fastcgi.conf;
    fastcgi_param SCRIPT_FILENAME $document_root/app.php;
    fastcgi_pass unix:/services/.sock/fastcgi.sock;
 }       
 location /check {
    internal;
    include fastcgi.conf;
    fastcgi_param SCRIPT_FILENAME $document_root/check.php;
    fastcgi_pass unix:/services/.sock/fastcgi.sock;
 } 
```

# java - 当我使用 Gdx.files.local(path) 时，Gdx 在哪里搜索？

> ID：13533441
> 
> 赞同：1
> 
> 时间：2012-11-23T17:21:42.460
> 
> 标签：java, android, file, local, assets

我正在使用 libgdx 进行游戏。我想读/写文本文件来更新高分，很简单。我已经在 "$ANDROID-PROJECT/assets/data" 中创建了三个文件，但是当我使用 Gdx.files.local("data/file.txt") 时 Gdx 似乎找不到它们，但是当我使用Gdx.files.internal("data/file.txt")。因为我还需要编写文件，所以我不得不使用 Gdx.files.local。

谁能告诉我当我使用 Gdx.files.local(path) 时 Gdx 在哪里搜索？我应该指定什么路径？

**代码：**

```
//for read
FileHandle file = Gdx.files.local("data/scoresCla.txt");

clasico = Float.parseFloat(file.readString());

//for write
FileHandle file = Gdx.files.local("data/scoresCla.txt");

file.writeString(String.valueOf(res), false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:38:37.853

如果有人有这个问题，我通过将 Gdx.files.local 更改为 Gdx.files.external 来解决。这样文件存储在 SD 卡中，它具有与本地文件相同的 R/W 文件功能，但在 SD 卡中。

# xsd - 如何防止 XSD 架构中的自引用外键值？

> ID：13533443
> 
> 赞同：1
> 
> 时间：2012-11-23T17:21:43.907
> 
> 标签：xsd, foreign-keys

我的 XML（简化）是这样的：

```
<Actions>
    <Action Id="1">
    </Action>
    <Action Id="2">
        <DoSomething>
            <ActionRef ActionId="1" /> <!-- valid -->
        </DoSomething>
    </Action>
</Actions> 
```

`ActionId`属性值引用元素的`Id`属性值。`Action`我已经在 XSD 中设置了外键约束，它可以正常工作。

我想防止外部字段中的自引用值，如下所示：

```
<Actions>
    <Action Id="1">
    </Action>
    <Action Id="2">
        <DoSomething>
            <ActionRef ActionId="2" /> <!-- invalid -->
        </DoSomething>
    </Action>
</Actions> 
```

当然，这可以很容易地在处理 XML 的应用程序中完成，如果我所要求的不可行，我会依靠它，但我更希望通过验证过程自动完成.

我尝试添加`[not(@ActionId = ../@Id)]`到外键选择器 XPath 查询中，但这在该上下文中无效（我也不确定它是否正确）。除此之外，我不知道还能尝试什么，而且看起来网上很多人甚至在他们的 XSD 中设置了外键关系，更不用说防止这种情况了（我没有找到关于这个确切主题的内容）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:50:04.813

这是不可能的——XSD 约束的选择器语法非常有限。其他替代方案可能包括 Schematron，假设您的运行时可以访问 XSLT 处理器，它应该是合理的集成。如果您决定添加与处理 XML 的应用程序代码分开的更多验证规则，那么您的努力可能会得到回报。

# excel - Excel宏搜索文本然后弹出框（如果找到）

> ID：13533444
> 
> 赞同：0
> 
> 时间：2012-11-23T17:21:58.400
> 
> 标签：excel, vba

我对 Excel 不是很有经验，但我想知道是否可以制作一个宏来执行以下操作：

我希望它在整个工作表（工作表名称为“发票”）中搜索“警报”一词。如果工作表上存在这个词，我希望出现一个弹出框。

如果可能，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:02:22.093

如果在工作表 Invoice 上找到“alert”，这将创建 msbox：

```
Sub TestFind()

    Dim found As Variant

    Set found = Sheets("Invoice").Cells.Find("alert", Sheets("Invoice").Cells(1, 1), xlValues, xlPart)

    If (Not found Is Nothing) Then

        'found
        MsgBox "Found " & found, vbOKOnly, "Found"
    Else

        'not found

    End If

End Sub 
```

# django - 有没有更好的方法来构造变量以传递给模板？

> ID：13533445
> 
> 赞同：0
> 
> 时间：2012-11-23T17:22:00.607
> 
> 标签：django, django-templates, django-views

给定一系列对象，我试图将它们拆分为一个漂亮的、排序的、易于显示的表格视图，该视图将用作通用（即无日期）日历。

```
def view_working_hours(request, user_id):
""" 
Shows the working hours for a certain user. 
This generates seven sorted lists which are then passed to the generic template

"""
wh0 = list(WorkingHours.objects.filter(user__id=user_id, DOW=0))
wh1 = list(WorkingHours.objects.filter(user__id=user_id, DOW=1))
wh2 = list(WorkingHours.objects.filter(user__id=user_id, DOW=2))
wh3 = list(WorkingHours.objects.filter(user__id=user_id, DOW=3))
wh4 = list(WorkingHours.objects.filter(user__id=user_id, DOW=4))
wh5 = list(WorkingHours.objects.filter(user__id=user_id, DOW=5))
wh6 = list(WorkingHours.objects.filter(user__id=user_id, DOW=6))
wh0.sort(key = lambda x: x.startHours)
wh1.sort(key = lambda x: x.startHours)
wh2.sort(key = lambda x: x.startHours)
wh3.sort(key = lambda x: x.startHours)
wh4.sort(key = lambda x: x.startHours)
wh5.sort(key = lambda x: x.startHours)
wh6.sort(key = lambda x: x.startHours)
return render_to_response('homesite/show_schedule.html', 
                          {'wh0': wh0, 'wh1': wh1, 'wh2': wh2, 'wh3': wh3, 'wh4': wh4, 'wh5': wh5, 'wh6': wh6,}, 
                          context_instance=RequestContext(request)) 
```

`foreach`然后在模板的表列中迭代变量。

这看起来真的很不雅。我的直觉正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T19:14:20.133

我认为您根本不想要七个列表。您应该一次简单地获取用户的所有对象，按 DOW 和开始时间排序：

```
WorkingHours.objects.filter(user_id=user_id).order_by('DOW', 'startHours') 
```

并将其传递给模板。在那里你可以简单地迭代，也许使用[`ifchanged`](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#ifchanged)or[`regroup`](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#regroup)过滤器在几天内输出它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:48:58.250

您可以考虑使用以下方法：

```
def view_working_hours(request, user_id):
    """ 
    Shows the working hours for a certain user. 
    This generates seven sorted lists which are then passed to the generic template

    """

    result = {}
    for i in xrange(7):
        result["wh"+str(i)] = sorted(
            list(WorkingHours.objects.filter(user__id=user_id, DOW=i)),
            key=lambda x:x.startHours)

    return render_to_response('homesite/show_schedule.html', result,
                              context_instance=RequestContext(request)) 
```

# jquery - jQuery：如果这个或那个 > each()

> ID：13533447
> 
> 赞同：1
> 
> 时间：2012-11-23T17:22:08.433
> 
> 标签：jquery

```
$("a.foo").each(function() {
    $(this).addClass('bar');
});

$("p > a").each(function() {
    $(this).addClass('bar');
});​ 
```

如果`$("a.foo")`或`if $("p > a")`- 我如何将这些加入到一个电话中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:23:22.590

您可以通过用逗号分隔来组合选择器。要仅添加一个类，您不需要每个类。

```
$("a.foo, p > a").addClass('bar'); 
```

如果您有许多要处理的语句，那么您需要使用每个语句。

```
$("a.foo, p > a").each(function() {
     //Your code here
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T17:24:11.040

`each`如果您只是要调用 jQuery 方法，则不需要`addClass`：

```
$("a.foo, p > a").addClass("bar"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T17:24:14.617

尝试这个

```
$("a.foo, p > a").each(function() {
    $(this).addClass('bar');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T17:24:17.967

使用逗号，就像在 CSS 中一样：

```
$("a.foo, p > a") 
```

# flash - Adobe Flash Player 安全错误

> ID：13533449
> 
> 赞同：1
> 
> 时间：2012-11-23T17:22:16.377
> 
> 标签：flash, adobe, settings

我在 adobe flash cs5 中制作了一个游戏，当我在 adobe flash 中预览它时，它运行良好，当我从文件夹中的 .swf 运行它时，我不断收到此错误！

![错误](../Images/bada2a1731f3fdeba0092f9c2cf04d69.png)

点击确定什么都不做，点击设置也没用，只是打开了另一个关于数据存储的窗口！那没用，我在那个窗口中尝试了所有方法。

# php - PHP/.HTACCESS | 手动设置 GET 变量以阻止虚 URL 干扰？

> ID：13533451
> 
> 赞同：0
> 
> 时间：2012-11-23T17:22:21.567
> 
> 标签：php, get, null

如果它为空，我想设置一个 $_GET 变量。但这似乎不起作用。

这是我到目前为止所拥有的。

```
if(!$_GET["profile"]) 
{
      $_GET["profile"] = null;  
} 
```

**编辑**

我尝试这样做的全部原因是因为我在 .htaccess 中设置了两个虚 URL，但我试图弄清楚如何跳过第二个虚 URL，所以我不需要去 something.com/home / <-- 注意第二个斜线，如果我不放第二个斜线，那么它会将我引导到我的 404 错误文档。基本上，我如何允许它，所以我不需要放第二个斜杠，导致 GET 变量为空？

这是我的.htaccess，

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d   
RewriteRule ^([^/]*)/([^/]*)$ /index.php?p=$1&profile=$2 [L]
ErrorDocument 404 /redir404.php 
```

就像我说的那样，为了让它工作，而不是将我发送到我的 ErrorDocument，我需要将我的 URL 设置为[http://ncms.us/home/](http://ncms.us/home/)才能工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:39:19.257

首先，这一行将生成一个“未定义索引”通知：

```
if ( ! $_GET["profile"]) 
```

最好使用`isset()`避免这些通知：

其次，您的脚本应该可以正常工作，但值为 的变量`NULL`实际上*不是*“设置”的，这可能会让您绊倒：

```
if ( ! isset($_GET["profile"]))
{
    $_GET["profile"] = null;  
}
var_dump(isset($_GET["profile"])); // will print FALSE 
```

> [http://php.net/manual/en/function.isset.php](http://php.net/manual/en/function.isset.php)
> isset — 确定变量是否已设置**且不为 NULL**

但是，您仍然可以在脚本`$_GET["profile"]`中有`NULL`值时使用它而不会生成通知。

最好只创建一个新变量而不是`$_GET`直接读取：

```
$profile = isset($_GET["profile"]) ? $_GET["profile"] : NULL; 
```

将值注入超全局变量有时会在其他脚本中产生奇怪的副作用，因为它们具有全局访问权限。最好避免它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:25:33.367

使用 !isset($_GET["profile"]) 查看是否未设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:33:45.257

[http://php.net/manual/en/function.empty.php](http://php.net/manual/en/function.empty.php)

`empty( )`— 判断一个变量是否为空

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T01:23:31.960

将您的 .htaccess 更改为：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d   
RewriteRule ^([^/]*)(/|)([^/]*)$ /index.php?p=$1&profile=$3 [L]
ErrorDocument 404 /redir404.php 
```

这将重写 url，如下所示：

```
example.com/home -> example.com/index.php?p=home&profile=
example.com/home/user -> example.com/index.php?p=home&profile=user 
```

（我无法在 .htaccess 文件中测试重写规则，但解析 url 的正则表达式应该是正确的）

# ruby-on-rails - 使用 Kaminari Pagination Gem 进行简单搜索

> ID：13533453
> 
> 赞同：4
> 
> 时间：2012-11-23T17:22:43.767
> 
> 标签：ruby-on-rails, search, kaminari

我正在尝试使用 Kaminari 将分页应用于我的 Rails 应用程序。我还结合了一个基于[Railscast Episode #37](http://railscasts.com/episodes/37-simple-search-form)的简单搜索表单。当我尝试应用 kaminari 页面和每个方法时，我收到错误“未定义的方法页面”。下面是我正在使用的代码。

post_controller.rb

```
def index
  @posts = Post.search(params[:search]).page(params[:page]).per(2)
end 
```

post.rb

```
def self.search(search)
  if search
    find(:all, conditions: ['title || body LIKE ?', "%#{search}%"], order: "created_at DESC")
  else
    find(:all)
  end
end 
```

index.html.erb

```
<%= paginate @posts %> 
```

当我删除分页时，搜索工作正常。当我删除搜索时，分页工作正常。我似乎无法同时使用它们并且无法正常运行代码。请告知我的代码中是否有我遗漏的东西导致它无法正常工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T17:40:43.880

在您的情况下，您从搜索方法返回数组对象，而不是 **ActiveRecord::Relation**对象。

```
 find(:all, conditions: ...) # find method will return an array object. 
```

在您的控制器中添加检查，

```
def index
  @posts = Post.search(params[:search])
  if @posts.class == Array
    @posts = Kaminari.paginate_array(@posts).page(params[:page]).per(10) 
  else
    @posts = @posts.page(params[:page]).per(10) # if @posts is AR::Relation object 
  end
end 
```

使用数组进行 Kaminari 分页[https://github.com/amatsuda/kaminari#paginating-a-generic-array-object](https://github.com/amatsuda/kaminari#paginating-a-generic-array-object)

对于 ActiveRecord::Relation 对象，请查看此[http://railscasts.com/episodes/239-activerecord-relation-walkthrough](http://railscasts.com/episodes/239-activerecord-relation-walkthrough)

# ios - UIImageView 上的动画问题

> ID：13533454
> 
> 赞同：0
> 
> 时间：2012-11-23T17:22:44.420
> 
> 标签：ios, animation, imageview

我有 7 个图像，我正试图淡入/淡出 1 个 ImageView。我已将所有图像存储在一个数组中，然后有一个循环来显示每个图像并淡入下一个，但是，当我运行程序时，只显示最后 2 个图像。关于为什么会这样的任何想法？以及如何解决？代码如下。

```
imageArray = [NSArray arrayWithObjects:
              [UIImage imageNamed:@"image 0.jpg"],
              [UIImage imageNamed:@"image 1.jpg"],
              [UIImage imageNamed:@"image 2.jpg"],
              [UIImage imageNamed:@"image 3.jpg"],
              [UIImage imageNamed:@"image 4.jpg"],
              [UIImage imageNamed:@"image 5.jpg"],
              [UIImage imageNamed:@"image 6.jpg"],
              nil];
            self.imageview.backgroundColor = [UIColor blackColor];
              self.imageview.clipsToBounds = YES;

int count = [imageArray count];
for (int i = 0; i <count-1 ; i++)
{
    UIImage *currentImage = [imageArray objectAtIndex: i];
    UIImage *nextImage = [imageArray objectAtIndex: i +1];
    self.imageview.image = [imageArray objectAtIndex: i];
    [self.view addSubview:self.imageview];
    CABasicAnimation *crossFade = [CABasicAnimation animationWithKeyPath:@"contents"];
    crossFade.duration = 5.0;
    crossFade.fromValue = (__bridge id)(currentImage.CGImage);
    crossFade.toValue = (__bridge id)(nextImage.CGImage);
    [self.imageview.layer addAnimation:crossFade forKey:@"animateContents"];
    self.imageview.image = nextImage;

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:34:32.873

需要注意的一些事项：

1）您在每个转换之间没有延迟的循环上同步执行所有操作，在下一个循环上为 if 设置动画是没有意义的，它将被下一个循环替换，依此类推，直到最后一个 2。另外，您正在添加您`imageView`每次都作为子视图，也没有必要。

2）您正在更改 .image 的属性`imageView`，然后更改图层的内容。还不如使用 UIView 并具有相同的效果。

我的建议是创建一种从一个图像交换到下一个图像的方法，并`NSTimer`每隔 x 秒调用一次该函数，直到您全部通过它们。

编辑：对于未来：

```
self.imageview.backgroundColor = [UIColor blackColor];
self.imageview.clipsToBounds = YES; 
```

完全没有必要:)

`.backgroundColor`被`UIImage`您正在显示的绘制。

这`.clipsToBounds`是默认行为`UIImageView`（它将图像缩小/扩展至它的大小，但从不向外绘制）

# kendo-ui - 带 4 位小数的 NumericTextBox

> ID：13533455
> 
> 赞同：1
> 
> 时间：2012-11-23T17:22:45.550
> 
> 标签：kendo-ui, kendonumerictextbox

我猜随着剑道论坛工作方式即将发生变化（仅限付费客户），在那里得到答案的机会很小，所以我会在这里尝试......

我已经设置了一个可编辑的网格，它对两个数字字段使用自定义验证器。验证器使用 ajax 查询获取有效参数（但我认为这并不重要）。

这一切正常，但我需要 NumericTextBoxes 支持 4 位小数，默认情况下它们不支持。

我为这些字段创建了自定义网格编辑器，这允许我输入 4 个小数位，但它破坏了自定义验证。

如何让 NumericTextBoxes 在编辑模式下支持 4 位小数并允许自定义验证规则？

提前致谢

这是我正在使用的带有验证器的字段定义：

```
end: { type: 'number', validation: {
    end: function(input){  
        if (input.attr('name')=='end' && $('input[name=lookup]').val()!=''){  
            $.ajax({  
                type: 'post',   
                url: '/ajax/lookupParams',   
                data: { lookup:$('input[name=lookup]').val(), csrf_token: token },  
                success: function(data) {  
                    start = data.start;  
                    end = data.end  
                },  
                   dataType: 'json',  
                   async: false  
                });  
            input.attr('data-end-msg', 'End must be between '+start+' and '+end);  
            return (input.val() >= start && input.val() <= end);  
         }  
         return true;  
     }  
} 
```

此位有效——ajax 用于根据查找字段的当前值检索有效的开始和结束值。如果我使用自定义编辑器支持 4 位小数，它就会停止工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T22:21:55.533

KendoUI NumericTextBoxes 支持 4 位小数和验证：

具有以下 HTML：

```
<input id="num" value="123.456789"
       data-format="n4"
       data-decimals="4"
       data-step="0.0001"
       data-role="numerictextbox"/> 
```

和以下初始化：

```
$("#num").kendoValidator({
    rules   :{
        custom:function (input) {
            var val = Math.floor(input.val() * 10000);
            return val % 2;
        }
    },
    messages:{
        custom:"Your number * 10000 needs to be odd"
    }
});
kendo.init($("#num")); 
```

这定义了一个`NumericTextBox`四位数字 - 在可视化和编辑模式下 - 以及一个`Validator`检查十进制数字的最后一位是否为奇数的自定义。

顺便说一句，欢迎来到 Stack Overflow 上的 KendoUI！

# android - 访问资源文件夹路由

> ID：13533462
> 
> 赞同：-2
> 
> 时间：2012-11-23T17:23:34.380
> 
> 标签：android, resources

我正在开发一个测试类，它必须检查是否有所有资源。这是我通过文件名（png）访问资源的强制性规范。

我知道有可能作为资源加载，但我无法加载资源。我正在开发一个测试应用程序。如何访问`file.png`名为 res/drawable 的文件？

```
new FileOutputStream("/res/drawable/xxx.png"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:46:13.377

建议阅读Android 文档中的[**资源概述**](http://developer.android.com/guide/topics/resources/overview.html)，但如果您的问题只是关于访问资源，请阅读[**访问资源**](http://developer.android.com/guide/topics/resources/accessing-resources.html)。这样您就可以做您想做的事了。

总而言之，有一些访问资源的方法取决于情况，例如当您知道资源的名称或知道它的 ID 时。而且还取决于您要访问资源的位置。

在你的情况下，我猜你想`drawable`在你的代码中访问 a ，如果它是真的，你可以这样做：

> R.drawable.xxx

例如，如果您的 .png 文件的名称是*myimage*并且您必须在*ImageView*中使用名称*im*设置它，请执行以下操作：

```
ImageView im = ...;
im.setImageResource(R.drawable.myimage); 
```

**编辑**：

如果您必须在资源中获取`InputStream`一个文件，您应该考虑`raw`在 res 目录中创建一个文件夹并将您的文件放入其中，然后从您的 Activity 或小部件中调用 getResources().openRawResource(resourceName)。例如：

```
InputStream ins = getResources().openRawResource(R.raw.test); 
```

例如，您在 raw 文件夹中的文件是`test.png`.

您可以在此处查看更多详细信息：

[在 Android 中使用文件作为原始资源](http://thedevelopersinfo.com/2009/11/27/using-files-as-raw-resources-in-android/)

[Android：从 Assets 和 Raw 文件夹加载文件](http://www.41post.com/3985/programming/android-loading-files-from-the-assets-and-raw-folders)

[堆栈溢出](https://stackoverflow.com/a/945879/1043882)

[堆栈溢出](https://stackoverflow.com/a/2856501/1043882)

[堆栈溢出](https://stackoverflow.com/a/4082182/1043882)

***最后，如果您想从资源创建输出文件，从中获取 InputStream 并将其内容写入 OutputStream，您可以[在此处](http://www.java2s.com/Code/Android/File/Createanoutputfilefromrawresources.htm)看到一个很好的示例。***

# delphi - 从其他应用程序加载 Log.txt 到备忘录 - Delphi7

> ID：13533466
> 
> 赞同：7
> 
> 时间：2012-11-23T17:23:46.530
> 
> 标签：delphi, memo

我正在尝试将来自其他应用程序（Proxifier）的会话日志记录到备忘录中。我试过使用命令：

```
procedure TForm1.TimerTimer(Sender: TObject);
begin
  Memo1.Lines.LoadFromFile('C:\PMASSH\Proxyfier\Profiles\Log.txt');
end; 
```

但在某些时候我得到一个错误

![在此处输入图像描述](../Images/4fd1de3a3daeb088b7baabeb142c200d.png)

你能帮我解决上面的问题吗？我真的很感激所有的答案。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T17:35:05.683

其他程序以不允许其他进程读取的共享模式打开文件。这通常发生在其他应用程序正在写入文件时。

您对此无能为力。这是完全正常的行为，是可以预料的。您可以尝试检测错误，等待一小段时间，然后重试。

由于您已经在计时器上运行它，因此重试将会发生。所以也许你只需要抑制这些异常：

```
procedure TForm1.TimerTimer(Sender: TObject); 
begin
  try
    Memo1.Lines.LoadFromFile(...);
  except
    on EFOpenError do
      ; //swallow this error
  end;
end; 
```

请注意，检测`EFOpenError`可能有点粗糙。也许还有其他导致该错误的故障模式。然而，作为第一遍，上面的代码是一个不错的开始。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-23T20:17:11.080

大卫的回答是正确的。我只是想澄清为什么会这样。

答案就在代码中：

```
procedure TStrings.LoadFromFile(const FileName: string);
var
  Stream: TStream;
begin
  Stream := TFileStream.Create(FileName, fmOpenRead or fmShareDenyWrite);
  try
    LoadFromStream(Stream);
  finally
    Stream.Free;
  end;
end; 
```

如您所见，访问该文件以进行共享，但不允许写入。您可以通过自己创建文件流来解决此问题：

```
Stream := TFileStream.Create(FileName, fmOpenRead or fmShareDenyNone); 
```

然后使用`Lines.LoadFromStream()`方法将内容加载到备忘录中

请注意，在其他应用程序以独占模式（即不共享）打开文件的情况下，问题可能仍然存在，因此仍然需要像 David 的回答那样进行适当的异常管理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T19:49:26.547

您可以使用 ReadFile WinAPI 试试运气。在共享读取打开模式下，您将能够在最后一次文件缓冲区刷新时偷偷地读取文件的内容。如果另一个应用程序（Proxifier）使用 CreateFile WinAPI 和 FILE_SHARE_READ 共享模式打开文件，那么只要您使用 ReadFile API，您就可以打开它进行阅读。如果仍然打开共享，Standart LoadFromFile 方法将在这里不起作用，并且您将收到相同的“锁定”错误。

但这里有一个问题..您必须处理缓冲区、大小和句柄...您必须为文件分配一个句柄以供读取，使用该句柄获取文件大小，设置一个具有该大小的数组，执行读取该数组并分配，将该数组（无论如何）添加到备忘录中。WinAPI的纯用法。一些简单任务的工作......

下面是一个如何使用 WinAPI 处理文件的基本示例：

该其他应用程序的文件打开过程的关键假设：

```
var
  Form1: TForm1;
  logfile: Textfile;
  h: THandle;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
begin    
  // AssignFile(logfile, 'c:\deneme.txt');
  // Rewrite(logfile);

  h := CreateFile('C:\deneme.txt', GENERIC_WRITE, FILE_SHARE_READ, nil,
    CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0);

  Timer1.enabled := true;
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
  Timer1.enabled := false;

  // CloseFile(logfile);
  CloseHandle(h);
end;

procedure TForm1.Timer1Timer(Sender: TObject);
var
  str: AnsiString;
  p: pointer;
  buf: array of ansichar;
  written: cardinal;
begin
  // Writeln(logfile, 'denemeStr');

  str := 'denemeStr' + #13#10;
  p := pansichar(str);

  SetLength(buf, length(str));
  move(p^, buf[0], length(str));

  WriteFile(h, buf[0], length(buf), written, nil);
  FlushFileBuffers(h);
end; 
```

如果它已被共享以供阅读，您可以通过以下方式阅读它：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  h: THandle;
  buf: array of ansichar;
  size, read: cardinal;
begin
  Memo1.Lines.Clear;
  // Memo1.Lines.LoadFromFile('c:\deneme.txt');

  h := CreateFile('C:\deneme.txt', GENERIC_READ, FILE_SHARE_READ, nil,
    OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);
  size := GetFileSize(h, nil);
  SetLength(buf, size);

  ReadFile(h, buf[0], size, read, nil);
  CloseHandle(h);
  Memo1.Lines.Add(pansichar(buf));
end; 
```

希望这会有所帮助...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-10-15T09:11:04.987

```
procedure TForm1.TimerTimer(Sender: TObject);
begin
  Memo1.Lines.LoadFromFile('C:\PMASSH\Proxyfier\Profiles\Log.txt');//// read file path error if file notfound
// if trying to record 
  Memo1.Lines.SaveToFile(Path...);
end; 
```

# android - 如何将画布中的视图保存到PNG文件？

> ID：13533471
> 
> 赞同：7
> 
> 时间：2012-11-23T17:24:08.163
> 
> 标签：android, png, android-canvas

我创建了可用于在其上绘制一些形状的画布。如何将其内容保存到用户 SD 卡上的 PNG 文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T17:32:36.270

查看此链接[此链接](http://codinglookseasy.blogspot.in/2012/10/save-image-in-sdcard.html) 在此链接中您可以找到方法

```
void saveImage() {

  try {
      String filename = Environment.getExternalStorageDirectory().toString();

      File f = new File(filename ,"myImage.png");
      f.createNewFile();
      System.out.println("file created " + f.toString());
      FileOutputStream out = new FileOutputStream(f);
      Bitmap bitmap = showImage(urlStr);
      bitmap.compress(Bitmap.CompressFormat.PNG, 90, out);
  } catch (Exception e) {
      e.printStackTrace();
  }      
 } 
```

它用于将您输入的图像保存到位图中。并检查[此链接](https://stackoverflow.com/questions/10882164/creating-bitmap-from-canvas-java) 以从画布获取位图

希望这可以帮助你。

快乐编码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:34:11.313

画布只是绘制位图的一种手段。

你应该已经用`new Canvas(myBitmap);`. 因此，当您在 Canvas 上绘图时，它会绘制到您的位图。

所以使用`myBitmap`执行以下操作（[此处](https://stackoverflow.com/questions/4573676/saving-as-a-png-image-in-android)的代码：

```
String fileName = Environment.getExternalStorageDirectory() + "/test.png";
OutputStream stream = new FileOutputStream(fileName);
/* Write bitmap to file using JPEG or PNG and 80% quality hint for JPEG. */
myBitmap.compress(CompressFormat.PNG, 80, stream);
stream.close(); 
```

# java - 如何从下载目录中删除文件？

> ID：13533477
> 
> 赞同：3
> 
> 时间：2012-11-23T17:24:41.813
> 
> 标签：java, android, file, download, delete-file

我尝试了很多方法，但无法删除文件。

```
File path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS);
File file = new File(path,"test.txt");

boolean deleted = file.delete(); 
```

这段代码也很糟糕！有人可以帮助我吗？

# java - 如何在目录/文件夹中查找子目录？

> ID：13533479
> 
> 赞同：22
> 
> 时间：2012-11-23T17:24:53.137
> 
> 标签：java, directory, java-io

我正在寻找一种方法来获取给定目录中的所有目录名称，但不是文件。

例如，假设我有一个名为 的文件夹`Parent`，其中有 3 个文件夹：`Child1` `Child2`和`Child3`.

我想获取文件夹的名称，但不关心内容，或 Child1、Child2 等内部子文件夹的名称。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-24T08:28:49.993

如果您使用的是 java 7，您可能想尝试使用提供的支持

```
package java.nio.file 
```

如果您的目录有很多条目，它将能够开始列出它们而无需先将它们全部读入内存。在 javadoc 中阅读更多内容：[http ://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#newDirectoryStream(java.nio.file.Path,%20java.lang.String )](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#newDirectoryStream(java.nio.file.Path,%20java.lang.String))

这也是适合您需求的示例：

```
public static void main(String[] args) {
    DirectoryStream.Filter<Path> filter = new DirectoryStream.Filter<Path>() {
        @Override
        public boolean accept(Path file) throws IOException {
            return (Files.isDirectory(file));
        }
    };

    Path dir = FileSystems.getDefault().getPath("c:/");
    try (DirectoryStream<Path> stream = Files.newDirectoryStream(dir, filter)) {
        for (Path path : stream) {
            // Iterate over the paths in the directory and print filenames
            System.out.println(path.getFileName());
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-23T17:30:23.410

您可以使用`String[] directories = file.list()`列出所有文件名，然后使用循环检查每个子文件并使用`file.isDirectory()`函数获取子目录。

例如：

```
File file = new File("C:\\Windows");
String[] names = file.list();

for(String name : names)
{
    if (new File("C:\\Windows\\" + name).isDirectory())
    {
        System.out.println(name);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-14T06:00:25.287

```
public static void displayDirectoryContents(File dir) {
    try {
        File[] files = dir.listFiles();
        for (File file : files) {
            if (file.isDirectory()) {
                System.out.println("Directory Name==>:" + file.getCanonicalPath());
                displayDirectoryContents(file);
            } else {
                System.out.println("file Not Acess===>" + file.getCanonicalPath());
            }
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

}

====内部类/方法提供文件= URL ======

```
 File currentDir = new File("/home/akshya/NetBeansProjects/");
    displayDirectoryContents(currentDir);
} 
```

# html - CSS 选择具有部分 id 的元素

> ID：13533484
> 
> 赞同：51
> 
> 时间：2012-11-23T17:25:03.653
> 
> 标签：html, css, css-selectors

我有一些用 PHP 生成的元素，我想知道是否可以选择一个 id 不完整的元素，例如：

```
<div class="1" id="as_1"> ... </div>
<div class="2" id="bs_1"> ... </div>

<div class="1" id="as_2"> ... </div>
<div class="2" id="bs_2"> ... </div> 
```

该类已习惯于它们的共同点，但现在我需要单独选择它们，但我不知道整个 id 名称。

我可以使用类似的东西：

```
#as_{ ... }
#bs_{ ... } 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-11-23T17:27:35.153

不使用 ID 选择器，因为它们需要完整的 ID 名称，而是使用[子字符串属性选择器](http://www.w3.org/TR/selectors/#attribute-substrings)：

```
div[id^="as_"]
div[id^="bs_"] 
```

但是既然你的元素`class`无论如何都有一个属性，为什么不给每组元素添加一个公共类并通过该类进行选择以使事情变得更简单呢？您应该能够使用 PHP 确定分组类，就像生成 ID 一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-28T08:16:44.717

不确定是否与这个问题完全匹配，但我们正在使用 CodeceptJs，为此我们有这两个等价的部分：

```
myLocator: {

// xpath: "//*[contains(@data-testid, 'drawer')]",
css: '[data-testid*="drawer"]',
}, 
```

因此，使用`data-testid*=`for css 而不是 contains for xpath 以匹配其 data-testid 名为`drawer-{something_dynamic_appended}`.

# java - 有没有办法在Java中获取字符串的字节大小？

> ID：13533485
> 
> 赞同：3
> 
> 时间：2012-11-23T17:25:11.903
> 
> 标签：java, android

我需要文件中每一行的字节大小，所以我可以获得文件读取的百分比。我已经用 获得了文件的大小`file.length()`，但是如何获得每行的大小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T17:29:01.030

您需要知道编码 - 否则这是一个毫无意义的问题。例如，“foo”在 UTF-16 中是 6 个字节，但在 ASCII 中是 3 个字节。假设您一次阅读一行（给定您的问题），您应该知道您正在使用哪种编码，因为您应该在开始阅读时指定它。

您可以调用`String.getBytes(charset)`以获取特定字符串的编码表示。

不要*只*调用`String.getBytes()`，因为这将使用平台默认编码。

请注意，所有这一切都在某种程度上是虚构的......您已经阅读了字节，将它们解码为文本，然后您将它们重新编码为字节......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-01T05:58:21.190

```
final String hello_str = "Hello World";

hello_str.getBytes().length is the "byte size", i.e. the number of bytes 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-23T21:55:07.237

您可能使用以下内容来读取文件

```
FileInputStream fis = new FileInputStream(path);
BufferedReader br = new BufferedReader(new InputStreamReader(fis, "UTF-8"));
String line;
while ((line = br.readLine()) != null) {
   /* process line */
   /* report percentage */
} 
```

您需要在开始时指定编码。如果你不这样做，你应该在 Android 上获得 UTF-8。这是默认设置，但可以更改。我会假设没有设备可以做到这一点。

重复其他答案已经说过的内容：字符数并不总是与字节数相同。特别是 UTF 编码很棘手。目前有 249,764 个分配的 Unicode 字符，可能超过一百万（[WP](http://en.wikipedia.org/wiki/Mapping_of_Unicode_characters)），而 UTF 使用 1 到 4 个字节来对所有字符进行编码。UTF-32 是最简单的情况，因为它总是使用 4 个字节。UTF-8 动态执行此操作并使用 1 到 4 个字节。简单的 ASCII 字符只使用 1 个字节。（来源：[UTF & BOM 常见问题解答](http://www.unicode.org/faq/utf_bom.html)）

要获取您可以使用的字节数，例如`line.getBytes("UTF-8").length()`. 一个很大的缺点是效率非常低，因为它每次都会创建 String 内部数组的副本，然后将其丢弃。[这是在Android](http://developer.android.com/training/articles/perf-tips.html#ObjectCreation)上解决的 #1 | [性能提示](http://developer.android.com/training/articles/perf-tips.html#ObjectCreation)

从文件中读取的实际字节数也不是 100% 准确的，原因如下：

*   例如，UTF-16 文本文件通常以特殊的 2 字节 BOM（字节顺序标记）开头，以表明它们是否必须解释小端或大端。当您仅查看`String`从阅读器获得的信息时，不会报告这 2 个（UTF-8：3，UTF-32：4）字节。所以你已经在这里少了一些字节。

*   将文件的每一行转换为 UTF-16`String`将包括每一行的那些 BOM 字节。因此`getBytes`每行会报告 2 个字节太多。

*   行结束字符不是结果行的一部分 - `String`。更糟糕的是，您有不同的方式来表示线路结束。`'\n'`通常只有 1 个字符的 Unix 样式或`'\r''\n'`两个字符的 Windows 样式。将`BufferedReader`简单地跳过那些。在这里，您的计算缺少非常可变的字节数。从 Unix/UTF-8 的 1 个字节到 Windows/UTF-32 的 8 个字节。

如果你有 Unix/UTF-16，最后两个原因会相互否定，但这可能不是典型的情况。错误的影响还取决于行长：如果每行有 4 个字节的错误，总共只有 10 个字节长，那么您的进度将非常错误（如果我的数学很好，您的进度将是 140%或在最后一行之后为 60%，具体取决于您的计算是假设每行 -4 字节还是 +4 字节）

这意味着到目前为止，无论您做什么，您都只能得到一个近似值。

如果您编写自己的特殊字节计数，则可能可以获得实际的字节计数`Reader`，但这将是很多工作。

另一种方法是使用自定义`InputStream`计算从底层流中实际读取的字节数。这并不难做到，而且它不关心编码。

最大的缺点是它不会随着您读取的行线性增加，因为`BufferedReader`它将填充它的内部缓冲区并从那里读取行，然后从文件中读取下一个块，依此类推。如果缓冲区足够大，那么您已经在第一行达到 100%。但我假设您的文件足够大，或者您不想了解进度。

例如，这将是这样的实现。它有效，但我不能保证它是完美的。`mark()`如果流使用and ，它将不起作用`reset()`。文件阅读不应该这样做。

```
static class CountingInputStream extends FilterInputStream {
    private long bytesRead;

    protected CountingInputStream(InputStream in) {
        super(in);
    }

    @Override
    public int read() throws IOException {
        int result = super.read();
        if (result != -1) bytesRead += 1;
        return result;
    }
    @Override
    public int read(byte[] b) throws IOException {
        int result = super.read(b);
        if (result != -1) bytesRead += result;
        return result;
    }
    @Override
    public int read(byte[] b, int off, int len) throws IOException {
        int result = super.read(b, off, len);
        if (result != -1) bytesRead += result;
        return result;
    }
    @Override
    public long skip(long n) throws IOException {
        long result = super.skip(n);
        if (result != -1) bytesRead += result;
        return result;
    }

    public long getBytesRead() {
        return bytesRead;
    }
} 
```

使用以下代码

```
File file = new File("mytestfile.txt");
int linesRead = 0;
long progress = 0;
long fileLength = file.length();
String line;

CountingInputStream cis = new CountingInputStream(new FileInputStream(file));
BufferedReader br = new BufferedReader(new InputStreamReader(cis, "UTF-8"), 8192);
while ((line = br.readLine()) != null) {
    long newProgress = cis.getBytesRead();
    if (progress != newProgress) {
        progress = newProgress;
        int percent = (int) ((progress * 100) / fileLength);
        System.out.println(String.format("At line: %4d, bytes: %6d = %3d%%", linesRead, progress, percent));
    }
    linesRead++;
}
System.out.println("Total lines: " + linesRead);
System.out.println("Total bytes: " + fileLength);
br.close(); 
```

我得到像

```
At line:    0, bytes:   8192 =   5%
At line:   82, bytes:  16384 =  10%
At line:  178, bytes:  24576 =  15%
....
At line: 1621, bytes: 155648 =  97%
At line: 1687, bytes: 159805 = 100%
Total lines: 1756
Total bytes: 159805 
```

或者在相同的文件 UTF-16 编码的情况下

```
At line:    0, bytes:  24576 =   7%
At line:   82, bytes:  40960 =  12%
At line:  178, bytes:  57344 =  17%
.....
At line: 1529, bytes: 303104 =  94%
At line: 1621, bytes: 319488 =  99%
At line: 1687, bytes: 319612 = 100%
Total lines: 1756
Total bytes: 319612 
```

而不是打印，您可以更新您的进度。

那么，最好的方法是什么？

*   如果您知道您有简单的 ASCII 文本，其编码仅使用 1 个字节来表示这些字符：只需使用`String#length()`（并且可能在行尾添加 +1 或 +2） `String#length()`快速且简单，只要您知道您的文件有你应该没有问题。
*   如果您有国际文本，而简单的方法不起作用：
    *   对于处理每行需要相当长时间的较小文件：`String#getBytes()`，处理 1 行的时间越长，临时数组及其垃圾收集的影响就越小。误差应在可接受的范围内。只要确保在最后进度 > 100% 或 < 100% 时不会崩溃。
    *   对于上述方法的较大文件。文件越大越好。以 0.001% 的步长更新进度只会减慢速度。减小读取器的缓冲区大小会提高准确性，但也会降低读取性能。
*   如果你有足够的时间：编写你自己的阅读器，告诉你确切的字节位置。也许是 和 的组合，`InputStreamReader`因为`BufferedReader`Reader 已经对字符进行了操作。[Android 的](https://android.googlesource.com/platform/libcore/+/refs/heads/master/luni/src/main/java/java/io/BufferedReader.java) [实施](https://android.googlesource.com/platform/libcore/+/refs/heads/master/luni/src/main/java/java/io/InputStreamReader.java)可能有助于作为起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T17:32:48.893

如果文件是 ASCII 文件，那么你可以使用 String.length(); 否则它会变得更复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T17:36:13.437

考虑您有一个名为的字符串变量`hello_str`

```
final String hello_str = "Hello World";

 //Check Character length
 hello_str.length() //output will be 11
 // Check encoded sizes
 final byte[] utf8Bytes = hello_str.getBytes("UTF-8");
 utf8Bytes.length  //output will be 11

 final byte[] utf16Bytes= hello_str.getBytes("UTF-16");
 utf16Bytes.length // output will be "24"

  final byte[] utf32Bytes = hello_str.getBytes("UTF-32");
  utf32Bytes.length // output will be "44" 
```

# php - recaptcha 总是返回 false

> ID：13533486
> 
> 赞同：4
> 
> 时间：2012-11-23T17:25:12.853
> 
> 标签：php, recaptcha

我的recaptcha 有问题。问题是它总是返回错误，这意味着它说验证码失败。即使输入了正确的单词。

一切都是最新的，使用最新的库并三次检查代码和公钥/私钥。

我相信问题就在这里....

```
require_once('recaptchalib.php');
          $privatekey = "************************************";
    $resp = recaptcha_check_answer ($privatekey,
                                    $_SERVER["REMOTE_ADDR"],
                                    $_POST["recaptcha_challenge_field"],
                                    $_POST["recaptcha_response_field"]);

if (!$resp->is_valid) {
                  $error_string .= '<center>The reCAPTCHA wasnt entered correctly. Go back and try it again.</center><br />';
        } 
```

我遵循了这个例子，所以我看不出出了什么问题。坚持了好几天！

[https://developers.google.com/recaptcha/docs/php](https://developers.google.com/recaptcha/docs/php)

客户代码：

```
require_once('recaptchalib.php');
    $publickey = "**********************"; // you got this from the signup page
    echo recaptcha_get_html($publickey); 
```

对 $resp 变量进行了 var 转储并得到了这个

```
object(ReCaptchaResponse)#2 (2) { ["is_valid"]=> bool(false) ["error"]=> string(21) "incorrect-captcha-sol" } 
```

还做了一个`var_dump`recaptcha响应字段并得到：

```
NULL 
```

var转储帖子...

```
array(7) { ["user"]=> string(0) "" ["pass1"]=> string(0) "" ["pass2"]=> string(0) "" ["email"]=> string(0) "" ["email2"]=> string(0) "" ["gender"]=> string(4) "Male" ["register"]=> string(8) "register" } 
```

var转储请求...

```
array(10) { ["user"]=> string(0) "" ["pass1"]=> string(0) "" ["pass2"]=> string(0) "" ["email"]=> string(0) "" ["email2"]=> string(0) "" ["gender"]=> string(4) "Male" ["register"]=> string(8) "register" ["PHPSESSID"]=> string(26) "4e79u2fdgrrufvb79einufcmq6" ["cprelogin"]=> string(2) "no" ["cpsession"]=> string(65) ":fX5Z1aWfbsgjGfgb3b3J7koo3Y58y5ntgM6k8GTdrQ4YAcqaywAKnD7PRiayfXv3" } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:06:10.727

Thanks for your support guys. I found the issue so decided to post if anyone comes across this problem in the future.

My form was inside my table, like

```
<table><form>...</form></table> 
```

Apparently the form should be first then table!

# oracle - 为什么 Oracle ADF 坚持我打开了相关对话框？

> ID：13533494
> 
> 赞同：0
> 
> 时间：2012-11-23T17:26:16.173
> 
> 标签：oracle, jdeveloper, oracle-adf

我正在使用 Oracle Weblogic/ADF 创建一个原型 Web 应用程序。我正在使用 JDeveloper 11.1.1.6.0。

我有一个带有一个实体对象和一个视图对象的基本应用程序。我的要求之一是，一旦数据发生变化，就必须对其进行数字签名。我正在使用基于 applet/servlet 的解决方案来完成这项工作。

一旦用户决定编辑表格中的条目，他们就会被带到一个显示两列表单布局的页面。此页面上有一个按钮，单击该按钮会弹出一个 ADF 对话窗口。在此页面上有一个名为“签名”的按钮。一旦用户单击“签名”按钮，就会执行一些与嵌入式小程序通信的 JavaScript。该嵌入式小程序又与 servlet 通信并返回表示签名的字符串。这个过程是基于任务流的。

我遇到的问题是，对于某些用户（IE 8、Win 7 Enterprise），一旦他们单击弹出窗口上的“签名”按钮，就会显示以下弹出窗口：

![在此处输入图像描述](../Images/69c6c4789593531b751b3aba6cb11ae8.png)

如果他们单击“确定”，页面会重新加载，当他们再次单击“签名”时，该过程会重复，从而导致循环。最初我认为警报来自 IE，但经过进一步研究，警报似乎来自 ADF。我不知道他们为什么会收到此消息，因为没有相关对话框。我尝试将文档的“未提交数据警告”设置为关闭，但我仍然得到相同的弹出窗口。此外，该消息仅针对在 Windows 7 之上运行 IE 8 的某些用户显示。

有没有人对如何让这个弹出窗口停止和/或为什么会发生有任何想法？任何帮助将不胜感激，因为我很难过。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T14:47:04.507

禁用 af:document 上的未提交数据警告属性

[http://docs.oracle.com/cd/E23943_01/apirefs.1111/e12419/tagdoc/af_document.html](http://docs.oracle.com/cd/E23943_01/apirefs.1111/e12419/tagdoc/af_document.html)

坦率

# spring - spring AOP 和代理目标类

> ID：13533502
> 
> 赞同：1
> 
> 时间：2012-11-23T17:27:05.713
> 
> 标签：spring, aop

我有一个接口的抽象类来向后兼容并减少冗余。

```
abstract class EventHandlerAdapter implements EventHandler;
class ImplClass extends EventHandlerAdapter;
class Impl2Class extends EventHandlerAdapter; 
```

对于仅从抽象类继承的任何 impl 类，我有事务的 AOP 设置。

```
<aop:config proxy-target-class="true">
    <aop:pointcut id="EventTXOperation" expression="execution(* EventHandlerAdapter.*(..))"/>
    <aop:advisor advice-ref="txAdvice" pointcut-ref="EventTXOperation"/>
</aop:config> 
```

当我尝试在 Impl2Class 中引用 ImplClass 时，即使我指定了 proxy-target-class="true"，似乎 spring 将始终使用原始接口 EventHandler 并且我无法转换为抽象类或具体 impl。这是带有代理目标类的spring AOP的正常行为吗？我看到我可以深入使用 Advisor 类来获取自动代理 bean 的目标类，但它似乎是侵入性的。那么我有什么更好的选择呢？

# ruby - Ruby：如何在 ERB 中以逗号分隔打印之前检查内容数组

> ID：13533503
> 
> 赞同：0
> 
> 时间：2012-11-23T17:27:15.147
> 
> 标签：ruby, erb, chef-infra

在 Chef 中，我有一个数组，我想打印出逗号分隔的数组，但我还想确保每个值都存在于另一个数组中。是否有一种简单的单行方式可以打印出数组并验证内容。过去我做过

当前仅打印行：

```
hostgroups <%= n.run_list.roles.to_a.join(",") %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T20:56:26.487

我会这样做：

```
hostgroups <%= (n.run_list.roles.to_a & another_a).join(",") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:12:04.110

使用`select`数组的方法怎么样？

我假设这`other_collection`是这里的“允许”字眼。

```
hostgroups <%= n.run_list.roles.to_a.select {|elem| other_collection.include? elem}.join(",") %> 
```

让我知道它是否有帮助！

**编辑** Ruby 中数组的文档链接：[http ://www.ruby-doc.org/core-1.9.3/Array.html](http://www.ruby-doc.org/core-1.9.3/Array.html)

# git - 如何删除 Git repo 中生成的文件？

> ID：13533504
> 
> 赞同：4
> 
> 时间：2012-11-23T17:27:17.737
> 
> 标签：git

我创建了一个 git repo 并在我的 android projekt 上做了一些工作，但现在我认识到我将文件添加到 repo 中，每次都会更改，因为它们是生成的。我怎样才能删除它们并确保不会再次添加它们。

我已经将它们添加到像这样锁定的 .gitignore

```
bin/classes/**
gen/**
bin/PDiXUploader.apk
bin/classes.dex
bin/resources.ap_
gen/de/srs/android/pdixuploader/R.java 
```

但是现在我不确定如何从 repo 中删除它，这样它就不会受到版本控制。

这是我的 git 状态日志

```
$ git status
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   bin/PDiXUploader.apk
#       modified:   bin/classes.dex
#       modified:   bin/resources.ap_
#       modified:   gen/de/srs/android/pdixuploader/R.java
#       modified:   res/layout/activity_instance_selection.xml
#       modified:   res/layout/activity_main.xml
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#       res/values/dimens.xml
no changes added to commit (use "git add" and/or "git commit -a") 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-23T17:50:57.250

由于您只想将其从存储库中删除，而不是从文件系统中删除，因此您需要使用：

```
git rm --cached <file> 
```

这将从索引中删除文件，因此它不会在下一次提交中，但会将文件留在磁盘上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T17:32:00.060

```
git rm <file> 
```

应该为您从存储库中删除文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-23T17:32:53.977

`git rm`如果您希望文件继续消失，这就是答案。

如果您希望生成的文件永远不会出现在 repo 中，您将需要查看 [`git filter-branch`](http://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html)，特别是第一个示例。

# javascript - 导航链接上的jQuery活动类没有改变

> ID：13533509
> 
> 赞同：1
> 
> 时间：2012-11-23T17:27:35.760
> 
> 标签：javascript, jquery, menu, scroll

我已经搜索了类似的问题，并且觉得我已经尝试了几乎所有方法都无济于事。

当用户滚动到我的单页网站的相应部分时，我希望将一个类“.active”附加到我的页面导航中的链接。当用户继续滚动时，该活动类将从链接中消失并添加到下一个链接中。

用于滚动的 jQuery 在代码中确实有效，但似乎没有别的。

这是我的网站：[http ://tenddigi.com/staging/](http://tendigi.com/staging/)

以下是（缩短的）代码部分：

HTML：

```
<ul id="nav">
    <li><a href="#about">ABOUT</a></li>
    <li><a href="#team">TEAM</a></li>
    <li><a href="#portfolio">PORTFOLIO</a></li>
    <li><a href="#process">PROCESS</a></li>
    <li><a href="#brands">BRANDS</a></li>
    <li><a href="#press">PRESS</a></li>
    <li><a href="#blog">BLOG</a></li>
    <li><a href="#meetup">MEETUP</a></li>
    <li><a href="#contact">CONTACT</a></li>
</ul>

<section>
    <a id="about">Header</a>
Some Text
</section>
<section>
    <a id="team">Header</a>
Some Text
</section>
<section>
    <a id="portfolio">Header</a>
Some Text
</section> 
```

jQuery：

```
// Cache selectors
var lastId,
topMenu = $("#nav"),
topMenuHeight = topMenu.outerHeight()+75,
// All list items
menuItems = topMenu.find("a"),
// Anchors corresponding to menu items
scrollItems = menuItems.map(function(){
  var item = $($(this).attr("href"));
  if (item.length) { return item; }
}),
noScrollAction = false;

// Bind click handler to menu items
// so we can get a fancy scroll animation
menuItems.click(function(e){
var href = $(this).attr("href"),
    offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+1;
noScrollAction = true;
$('html, body').stop().animate({ 
    scrollTop: offsetTop
},{
    duration: 300,
    complete: function() {
        menuItems
            .parent().removeClass("active")
            .end().filter("[href=" + href +"]").parent().addClass("active");
        setTimeout(function(){ noScrollAction = false; }, 10);
    }
});
e.preventDefault();
});

// Bind to scroll
$(window).scroll(function(){
if(!noScrollAction){
   // Get container scroll position
   var fromTop = $(this).scrollTop()+topMenuHeight;

   // Get id of current scroll item
   var cur = scrollItems.map(function(){
     if ($(this).offset().top < fromTop)
       return this;
   });
   // Get the id of the current element
   cur = cur[cur.length-1];
   var id = cur && cur.length ? cur[0].id : "";

   if (lastId !== id) {
       lastId = id;
       // Set/remove active class
       menuItems
         .parent().removeClass("active")
         .end().filter("[href=#"+id+"]").parent().addClass("active");
   }
   }    
});​ 
```

这是我关于stackoverflow的第一个问题，所以如果我没有正确执行此操作，我深表歉意！帮助将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:40:20.183

据我所知，这是有效的。活动链接被应用到`<li />`虽然。如果您在`<a />`更改时需要它：

```
.end().filter("[href=" + href +"]").parent().addClass("active"); 
```

到：

```
.end().filter("[href=" + href +"]").addClass("active"); 
```

希望有帮助！

**编辑**

哎呀！您还需要更改之前的线路。所以这是：

```
.parent().removeClass("active")
.end().filter("[href=" + href +"]").parent().addClass("active"); 
```

到：

```
.removeClass("active")
.filter("[href=" + href +"]").addClass("active"); 
```

* * *

您看起来还需要将阈值调整 5 或 6 个像素...

# telerik - 在 Telerik Radtreview 子树中深入搜索具有给定值的节点？

> ID：13533512
> 
> 赞同：1
> 
> 时间：2012-11-23T17:28:00.577
> 
> 标签：telerik, radtreeview

我有一个 RadTreeView C# 组件。树是嵌套的，所以一些节点有它们的子树，存储在上层节点的节点属性中。

现在我需要按值查找节点。节点隐藏在子树中的某处。如果我使用电话

```
 RadTreeNode rtn= PagesTreeView.Nodes.FindNodeByValue(i.ToString()); 
```

PagesTreeView 是我的树，然后它只搜索顶级节点。

我如何不仅使用当前树级别的节点，还可以深入到子树中按值查找节点？我需要自己编写这样的递归搜索还是有一个简单的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T17:44:27.680

## 递归搜索 RadComboBox

没有用于递归搜索的内置函数，但是您可以非常轻松地滚动自己的功能。这应该对你有用（未经测试）：

```
RadTreeNode FindNodeRecursive(RadTreeNodeCollection nodes, string value)
{
    foreach (RadTreeNode node in nodes)
    {
        if(node.Value == value)
            return node;

        if (node.Nodes.Count > 0)
        {
            FindNodeRecursive(node.Nodes, value);
        }

        return null;
    }
} 
```

然后这样称呼它：

```
var node = FindNodeRecursive(PagesTreeView.Nodes, i.ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:31:10.353

是的，您需要编写自己的递归函数来进行搜索。如果您使用的是控件的 ASP.NET AJAX 版本，则另一个选项是 GetAllNodes() 方法。它返回树层次结构中的所有节点（我猜它在底层使用递归）。获得整个列表后，您将在其中搜索您关心的节点。这种方法的最大缺点是，如果您有很多节点，搜索可能会很慢并且会消耗大量内存。进行自己的递归搜索是最好的方法。

有关更多信息，请参阅[本文](http://www.telerik.com/community/forums/aspnet-ajax/treeview/radtreeview-looping.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-30T06:28:01.090

老问题，但我在我的应用程序中遇到了同样的问题，如何搜索分层树节点。

我想分享一个对先前解决方案提案的更正。当递归调用 FindNodeRecursive() 时，递归调用的返回值永远不会被评估或分配给变量。因此，您总是会经历 foreach 循环并且返回值为 null。

更正和测试的功能代码（WPF C#）：

```
 RadTreeNode FindNodeRecursive(RadTreeNodeCollection nodes, string value)
    {
        RadTreeNode ret = null;
        foreach (RadTreeNode node in nodes)
        {
            if(node.Value == value)
                return node;

            if (node.Nodes.Count > 0)
            {
                ret = FindNodeRecursive(node.Nodes, value);
            }

            return ret;
        }
    } 
```

功能使用：

```
 var node = FindNodeRecursive(PagesTreeView.Nodes, i.ToString());
    if (node != null) // found 
    { 
        ;
    } 
```

# android - Nexux 10 模拟器/avd 未运行/启动

> ID：13533516
> 
> 赞同：8
> 
> 时间：2012-11-23T17:28:41.750
> 
> 标签：android, android-emulator

我正在尝试使用最新的[ADT](http://developer.android.com/guide/developing/tools/adt.html) (21) 和 SDK 工具为 Nexus 10 创建 Android 模拟器。我对 Nexus 10 AVD 有以下配置。

```
Screen Size - 10 inches
Resolution - 2560 X 1600
Screen Size - xlarge
Screen Density - Xhdpi
Screen ratio - long 
```

RAM - 512（无法设置 1024 模拟器崩溃）

但是一旦创建了 AVD，它就不会加载 Android；它只是显示一个黑屏。我的系统是 32 位[Intel Core i3](http://en.wikipedia.org/wiki/Intel_Core#Core_i3)和 4 GB RAM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T11:37:18.330

问题出在显示器、LCD（或您正在使用的任何其他显示设备）或显卡上。Nexus 10 拥有巨大的屏幕密度，如何在较低屏幕密度的屏幕上显示或复制它。根据提案进行编辑

*   克里希那巴德拉

要使其正常工作，您必须将屏幕分辨率与模拟器的缩小分辨率相匹配。在运行模拟器之前，会出现一个对话框窗口，其中要求用户设置模拟器屏幕尺寸和像素比（屏幕密度缩放到显示设备）。确保选择当前的屏幕分辨率。

# tridion - 从 Broker DB 获取动态组件时的字符编码问题 - Tridion、Oracle、JSP

> ID：13533520
> 
> 赞同：6
> 
> 时间：2012-11-23T17:29:01.977
> 
> 标签：tridion, tridion-2011, tridion-content-delivery

从代理数据库查看动态内容时，我遇到了字符编码问题。

我有一个 scriptlet，它调用代理 DB 以生成 XML 字符串，然后由 XSL 解析。

调试此问题时，我已经剥离了我的代码，脚本现在看起来像：

```
.....

strOutput= "<xml>";
ComponentPresentationFactory cpf = new ComponentPresentationFactory(PublicationID);

for (int i =0; i < itemURIs.length; i++)
{
ComponentPresentation cp = cpf.getComponentPresentation(itemURIs[i], strComponentTemplateURI);  
      if(cp != null){
        String content = "";
        content = cp.getContent();
        strOutput += content;
      }
}
strOutput+= "</xml>";

...... 
```

当我手动覆盖此代码并在代码中手动设置 xml 字符串内容时，数据将正确显示在屏幕上，即：

```
.....

strOutput= "<xml>";
ComponentPresentationFactory cpf = new ComponentPresentationFactory(PublicationID);

for (int i =0; i < itemURIs.length; i++)
{
ComponentPresentation cp = cpf.getComponentPresentation(itemURIs[i], strComponentTemplateURI);  
      if(cp != null){
        String content = "<xml><dynamicContent><subtitle><![CDATA[Außenbeleuchtung]]></subtitle></dynamicContent></xml>";
        strOutput += content;
      }
}
strOutput+= "</xml>";

...... 
```

组件使用输出格式设置为“XML 格式”的 CT 发布到内容代理 DB。

发布目标设置为目标语言：JSP 和默认代码页：Unicode UTF-8

当我使用此 CT 预览内容时，数据会正确显示：

```
<dynamicContent>
    <tcm_id>tcm:345-23288</tcm_id>
    <title><![CDATA[LED Road R250 - Maximum LED performance for street and highway illumination]]></title>
    <subtitle><![CDATA[Außenbeleuchtung ]]></summary>
</dynamicContent> 
```

通过模板生成器进行预览时也是如此。

Broker DB 是一个 Oracle DB（Oracle Database 11g Enterprise Edition Release 11.2.0.2.0），我检查了字符集

```
SQL> select * from v$nls_parameters where parameter like '%CHARACTERSET%'; 

PARAMETER VALUE 

NLS_CHARACTERSET UTF8 
NLS_NCHAR_CHARACTERSET UTF8 
```

有没有其他人遇到过这样的例子。看起来数据库存储、与数据库的连接或 cp.getContent(); 存在问题 方法。

任何帮助将不胜感激，如果您有任何其他问题，请告诉我。

问候，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:55:29.900

看看这篇讨论解决编码问题的方法的文章：http: [//elenaserghie.blogspot.ca/2012/01/7-clues-to-solve-character-encoding.html](http://elenaserghie.blogspot.ca/2012/01/7-clues-to-solve-character-encoding.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:52:32.953

字符编码问题可能相当复杂。在您的情况下，由于您已经进行了相当多的调查，我将开始检查 jsp 文件是否具有正确的页面编码集：

```
<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %> 
```

# php - 我可以毫无风险地将核心 cakephp 版本 2.1.1 迁移到 2.2.3 吗？

> ID：13533521
> 
> 赞同：0
> 
> 时间：2012-11-23T17:29:13.170
> 
> 标签：php, cakephp, frameworks, core

这就是所有的问题，我可以将核心 cakephp 版本 2.1.1 迁移到 2.2.3 没有任何风险吗？

有人已经做过了吗？

我看到了变更日志的痕迹，似乎没有太大的变化......

感谢您的回答，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:45:38.233

您必须按照本文中的步骤[http://book.cakephp.org/2.0/en/appendices/2-2-migration-guide.html](http://book.cakephp.org/2.0/en/appendices/2-2-migration-guide.html)

阿纳斯

# java - @Any：尚不支持

> ID：13533523
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:29:40.400
> 
> 标签：java, hibernate, jpa-2.0

我在一个已经长大的项目中工作，所以我无法更改任何使用的框架或库的任何版本。

实际上，我有一个特殊的情况，我设法用两个实体和 和来`@Inheritance`解决。现在，我有一个实体，其中引用了继承中的两个类，如下所示：`@DiscriminatorColumn``@DiscriminatorValue`

```
@Entity
//Other annotations
public class A implements IA {
    //Class body
}

@Entity
//Other annotations
public class B extends A implements IB { //Note: `IB` extends `IA`.
    //Class body
}

@Entity
//Other annotations
public class Container {
    private IA object1;
    private IA object2;
} 
```

这里的问题是我正在尝试使用 @Any 注释，因为`object1`and/or`object2`可以是`A`or类型`B`。我所做的是这样的：

```
@Any(metaColumn=@Column(name="objectOneType", length=3),fetch=FetchType.EAGER)
@AnyMetaDef(idType="long",metaType="string", metaValues={
        @MetaValue(targetEntity=A.class, value="A"),
        @MetaValue(targetEntity=B.class, value="B")
    }
)
@JoinColumn(name = "relatedObjectId")
private IA object1; 
```

[如此处](http://javalabor.blogspot.com/2012/03/jpa-2-metamodels-and-hibernates-any.html)所述，Hibernate 的`@Any`注释系列在 JPA 2 中没有对应物，并且由于我无法切换到 Hibernate 4.1，因此我被困在这里试图找出一种使其工作的方法或我应该如何修复它。

一种“不那么优雅”的方法是创建一个新实体并将字段从 A 复制到 B，擦除继承并修复特定情况。

也许，我在 JPA 中失去了一些我还不知道的特殊功能，所以我目前愿意接受并感谢任何可能为我指明正确方向的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:12:03.927

您不需要任何`@Any`注释。B 扩展了 A，所以 B`is`是 A。所以以下内容就足够了：

```
public class Container {
    @ManyToOne
    private A object1;

    @ManyToOne
    private A object2;
} 
```

（假设关联是多对一。它也可能是一对一）

Hibernate 将自己找出这两个对象的具体类型，并将使用 A 或 B 的实例初始化 object1 和 object2。

# c++ - 模板函数给出编译错误

> ID：13533525
> 
> 赞同：1
> 
> 时间：2012-11-23T17:30:01.850
> 
> 标签：c++, templates

> **可能重复：**
> [std::map::const_iterator 模板编译错误](https://stackoverflow.com/questions/3149859/stdmapconst-iterator-template-compilation-error)

这个想法是创建一个将容器类型作为模板参数的函数。由于与其他顺序容器相比，地图必须以不同的方式求和，我重载了地图的 Sum 函数，如下所示。

这是给我错误的功能：

```
template<typename T1, typename T2>
double Sum(const map<T1,T2>& input)
{
double finalSum=0;
map<T1,T2>::const_iterator iter_begin=input.begin();
map<T1,T2>::const_iterator iter_end=input.end();

for(iter_begin; iter_begin!=iter_end; ++iter_begin)
{
    finalSum=finalSum+(iter_begin)->second;
}
return finalSum;
} 
```

错误：

1>c:\documents and settings\keep\my documents\visual studio 2010\projects\level 7\exercise 2\exercise 2\sum.h(34)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

1>c:\documents and settings\keep\my documents\visual studio 2010\projects\level 7\exercise 2\exercise 2\sum.h(34): error C2143: 语法错误: ',' before '<'

这个函数是头文件的一部分。我的头文件也包含函数定义。

几件事： 1\. 我尝试使用 typename 但我可能错了。模板还不是我的强项。如果某处需要类型名，请随时指出。内联关键字会有帮助吗？

2.  **相同的代码在我的 Guide 机器上编译得很好。**我的是 VC++ 2010 Express SP1。我不知道他的 VC++ 版本是什么。

提前致谢。

**编辑：发布整个头文件。按照建议添加类型名**。但同样的错误。Sum 的第一个版本在没有 typename 的情况下编译良好。地图重载的第二个问题是问题。

```
#ifndef SUM_H
#define SUM_H

template<typename T>    
double Sum(const T& input)                                                  
{
double finalSum=0;
T::const_iterator iter_begin=input.begin();
T::const_iterator iter_end=input.end();

for(iter_begin; iter_begin!=iter_end; ++iter_begin)
{
    finalSum=finalSum+(*iter_begin);
}
return finalSum;
}

//Mysterion !!!!!
template<typename T1, typename T2>
double Sum(const map<T1,T2>& input)
{
double finalSum=0;
typename map<T1,T2>::const_iterator iter_begin=input.begin();
typename map<T1,T2>::const_iterator iter_end=input.end();

for(iter_begin; iter_begin!=iter_end; ++iter_begin)
{
    finalSum=finalSum+(iter_begin)->second;
}
return finalSum;
}   

#endif 
```

错误出现在：double Sum(const map& input)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:31:40.143

这是你需要`typename`s的地方：

```
typename map<T1,T2>::const_iterator iter_begin=input.begin();
typename map<T1,T2>::const_iterator iter_end=input.end(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:33:58.520

你已经猜到了——你需要`typename`. 粗略地说，规则是，如果你指的是一个类型 using`::`并且左边的东西`::`依赖于模板参数，你必须使用`typename`. 所以在你的情况下：

```
typename map<T1,T2>::const_iterator iter_begin=input.begin();
typename map<T1,T2>::const_iterator iter_end=input.end(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:08:32.297

你忘了`#include <map>`，你也应该用限定词来限定它的名字，`std`因为那是`map`生活的地方。

不要太担心`typename`（尽管添加它们会很好），因为 VC++ 是宽松的（并且不符合标准），所以它不是主要错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T17:35:51.780

你应该使用`typename`因为`const_iterator`是一个从属名称（搜索这个术语，你会发现很多解释）：

```
typename map<T1,T2>::const_iterator iter_begin=input.begin();
typename map<T1,T2>::const_iterator iter_end=input.end(); 
```

那看起来很难看。

在 C++11 中，`auto`让您的生活变得轻松：

```
auto iter_begin=input.cbegin(); //use cbegin, instead of begin
auto iter_end=input.cend();     //use cend, instead of end 
```

或基于范围的`for`循环：

```
for(auto item : input)
{ 
   finalSum = finalSum + item.second;
} 
```

# jquery - 无法动态加载 smoothdivscroll

> ID：13533531
> 
> 赞同：2
> 
> 时间：2012-11-23T17:30:41.263
> 
> 标签：jquery, smooth-scrolling

我正在尝试动态加载smoothdivscroll（所以我的网站上可以有很多画廊）。

静态 html 工作正常。一旦我尝试为动态加载的内容启用插件，它就不起作用。

这似乎是一个时间问题。我注意到如果初始化smoothdivscroll，即。

```
$("div#makeMeScrollable").smoothDivScroll({}); 
```

没有作为页面加载的一部分完成，那么它就不起作用。

看看我创建的这个例子：http: [//jsfiddle.net/2Hr4U/119/](http://jsfiddle.net/2Hr4U/119/)

当您将 load_delayed 变量设置为 true 时，会在页面加载完毕并且 smoothdivscroll 中断后调用初始化。

我做错了什么还是插件的限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T14:17:50.697

这似乎是插件的限制。我面临同样的问题。该插件使用 window.load()，除了在页面加载时不会调用它。

[在这里检查小提琴](http://jsfiddle.net/2Hr4U/1558/)

您需要手动调用

```
$("div#makeMeScrollable").smoothDivScroll("recalculateScrollableArea");

$("div#makeMeScrollable").smoothDivScroll("startAutoScrolling"); 
```

}

# c# - 将字符串拆分为多个部分

> ID：13533534
> 
> 赞同：-9
> 
> 时间：2012-11-23T17:30:51.477
> 
> 标签：c#

我想在 C# 中拆分一个字符串，例如：120530

所以它会是这样的： Day: 12 Time: 0530

但它将没有空格，就像它是 120530

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:34:59.347

我假设您知道它将始终是 6 位数字，前 2 位是日期，后 4 位是时间。

利用字符串对象的 Substring() 方法...

```
string allTogether = "120530";
string day = allTogether.Substring(0, 2);
string time = allTogether.Substring(2); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T17:34:35.213

```
var dayAndTime = "120530";
var day = dayAndTime.Substring(0, 2);
var time = dayAndTime.Substring(2, 4); 
```

# php - 解析 curl 响应数据

> ID：13533535
> 
> 赞同：0
> 
> 时间：2012-11-23T17:31:00.577
> 
> 标签：php, curl, preg-match

嘿伙计们，所以我将字段发布到 url，使用 print $result 返回的数据显示如下（来自浏览器中的查看源代码）

```
 <html>
        <body>TransID=0&REFNO=&Auth=&AVSCode=&CVV2ResponseMsg=&Notes=Your merchant information is not correct.&User1=&User2=&User3=&User4=
        </body>
    </html> 
```

上面还有 1 个空行现在我需要将这些身体对作为一个数组获取，以便我可以使用它们..我不擅长使用正则表达式或类似的东西来获取它们..请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:46:52.417

```
<?php

$html = "<html>
        <body>TransID=0&REFNO=&Auth=&AVSCode=&CVV2ResponseMsg=&Notes=Your merchant information is not correct.&User1=&User2=&User3=&User4=
        </body>
    </html>";

$dom = new DOMDocument();
@$dom->loadHTML( $html ); //Lots of invalid html going on so I am suppressing the warnings
$xpath = new DOMXPath( $dom );

$str = $xpath->query( '//body/text()')->item(0)->textContent;

parse_str( $str, $params );

print_r( $params );

/*

Array
(
    [TransID] => 0
    [REFNO] => 
    [Auth] => 
    [AVSCode] => 
    [CVV2ResponseMsg] => 
    [Notes] => Your merchant information is not correct.
    [User1] => 
    [User2] => 
    [User3] => 
    [User4] => 

)

*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:00:01.733

您可以通过标准 php 函数解决此问题

```
 $cContent =    "<html>
   <body>TransID=0&REFNO=&Auth=&AVSCode=&CVV2ResponseMsg=&Notes=Your merchant information is not correct.&User1=&User2=&User3=&User4=
    </body>
</html>";

 echo $cContent = trim(strip_tags($cContent));

 parse_str($cContent, $aParams);

 print_r($aParams); 
```

# clojure - 在 Clojure 中使用字符串插值宏 (<<)

> ID：13533536
> 
> 赞同：5
> 
> 时间：2012-11-23T17:31:01.513
> 
> 标签：clojure, interpolation, string-interpolation

刚刚开始使用clojure。我正在使用[leiningen](https://github.com/technomancy/leiningen)，但无法弄清楚为什么我的`<<`宏导入似乎不起作用

**项目.clj**

```
(defproject myapp "0.1"
  :description "Clojure learning sandbox"
  :main myapp.core
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [org.clojure/core.incubator "0.1.2" ]]) 
```

**核心.clj**

```
(ns clojure-shuffle
  (:require [clojure.core.incubator :refer [<<]]))

(defn -main [& args]
  (println (<< "The sum is: ~(reduce + (map read-string args))"))) 
```

当我做`lein run 3 7 2`我期望

```
The sum is: 12 
```

但是我得到了这个（后面是一个大的堆栈跟踪）：

```
 Exception in thread "main" java.lang.IllegalAccessError: << does not exist 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-23T17:39:35.753

也许您需要使用**[clojure.core.strint](https://github.com/clojure/core.incubator/blob/28110f5c87af399b3afca8f295030dda732439f6/src/main/clojure/clojure/core/strint.clj#L15-L18)**命名空间？

# entity-framework - LINQ to Entities 动态 DbSet

> ID：13533537
> 
> 赞同：1
> 
> 时间：2012-11-23T17:31:09.367
> 
> 标签：entity-framework, linq-to-entities

是否可以在运行时指定 LINQ to Entities 查询的 DbSet？

例如，如果我有许多不同的 DbSet，它们具有诸如“IsExpired”之类的共同属性，我可以将 DbSet 传递到查询中吗？

所以，

```
Dim query = From o In db.Products Where o.IsExpired = True 
```

看起来像，

```
Dim myDynamicName As String
myDynamicName = "Products"

Dim query = From o In db("myDynamicName") Where o.IsExpired = True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T21:05:07.077

使用流利的语法时，这不可能的原因变得更加清楚：

```
Dim query = db("myDynamicName").Where(Function(o) o.IsExpired) 
```

该函数是一个

```
Function Func(Of In T, Out bool) 
```

并且类型`T`是从`IQueryable Of T`它前面的那个推断出来的。（这是可能的，因为`Where`是扩展方法，所以 IQueryable 是它的第一个输入参数）。因此，编译器知道这`o.IsExpired`是一个有效的表达式。

这意味着`db("myDynamicName")`必须要么是专门键入的，但不是，或者您必须将类型提供给`Where`方法。但这正是您要规避的事情。

# jquery - jquery mobile：如何从 jquery mobile 中完全删除预加载器？

> ID：13533543
> 
> 赞同：2
> 
> 时间：2012-11-23T17:31:27.297
> 
> 标签：jquery, jquery-mobile, preloader

通过更改 jquery mobile 的 CSS，您可以在页面重新加载时删除预加载器图像，但页面重新加载时仍会出现一个灰色圆圈。

什么方法可以同时删除 jquery mobile 中的预加载指示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-25T18:28:01.177

接受的答案在 jQuery Mobile 1.4 中对我不起作用。我想完全禁用 Ajax 加载，所以我有

```
$.mobile.ajaxEnabled = false; 
```

已经在 jQuery 和 jQuery Mobile 文件的声明之间运行，但我仍然看到灰色圆圈。

我在我的css文件中想出了这个

```
.ui-loader {
  display:none !important;
} 
```

然后灰色圆圈消失了。但是，一位测试人员指出，我仍然在页面上收到一个 javascript 错误，它无法加载 ajax-loader.gif。我四处搜索并在 jquery.mobile-1.4.0.css 中找到了这个

```
/* Loader */
.ui-icon-loading {
    background: url(images/ajax-loader.gif);
    background-size: 2.875em 2.875em;
} 
```

所以，我也只是将它添加到我的 css 文件中

```
.ui-icon-loading {
    background:none !important;
} 
```

现在javascript错误也消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T22:56:08.147

最好的方法是完全禁用它。

尝试在`mobileinit`事件中使用它：

```
$.mobile.loadingMessage = false; 
```

这应该完全禁用它：

```
$.mobile.hidePageLoadingMsg() 
```

可以在[此处](http://jquerymobile.com/demos/1.1.0/docs/api/globalconfig.html)的 jQuery 移动文档中找到有关此内容的更多信息（带有一些示例） 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-22T16:52:18.040

有点晚了，但也许 SO 用户会发现这很有用，我遇到了同样的问题，发现你可以使用这个`show | hide`函数来*加载程序：*`$.mobile.loading()`

以显示：

```
$.mobile.loading( 'show', {
    text: 'Verificando Datos',
    textVisible: true,
    theme: 'z',
    html: ""
}); 
```

隐藏：

```
$.mobile.loading('hide'); 
```

# homebrew - RRDTool 'graph' 命令抛出 Glib 和 Pango 错误，在 Mac OS X 上与 Homebrew 一起安装

> ID：13533544
> 
> 赞同：4
> 
> 时间：2012-11-23T17:31:31.950
> 
> 标签：homebrew, glib, rrdtool, pango

问题是：

**如何让 RRDTool 在 Mac OS X 上生成图表？**

我在 Mac OS x 10.6.8 上`rrdtool`安装。`homebrew`

我能够创建数据库、更新一些数据并获取数据，但我无法为其生成图表。

看起来和 有`glib`问题`pango`。

这两个库都安装了`homebrew`.

我在用着：

*   RRDTool 1.4.7
*   油嘴滑舌 2.34.2
*   盘古 1.30.1

当我运行这个：

```
rrdtool create datafile.rrd DS:packets:ABSOLUTE:900:0:10000000 RRA:AVERAGE:0.5:1:9600 RRA:AVERAGE:0.5:4:9600 RRA:AVERAGE:0.5:24:6000
rrdtool update datafile.rrd N:12322
rrdtool graph graph.png DEF:pkt=datafile.rrd:packets:AVERAGE LINE1:pkt#ff0000:Packets 
```

我得到：

```
(process:34285): GLib-GObject-CRITICAL **: g_object_ref: assertion `G_IS_OBJECT (object)' failed
(process:34285): GLib-GObject-CRITICAL **: g_object_get_qdata: assertion `G_IS_OBJECT (object)' failed
(process:34285): GLib-GObject-CRITICAL **: g_object_set_qdata_full: assertion `G_IS_OBJECT (object)' failed
(process:34285): Pango-CRITICAL **: pango_fontset_foreach: assertion `PANGO_IS_FONTSET (fontset)' failed
(process:34285): Pango-CRITICAL **: pango_fontset_foreach: assertion `PANGO_IS_FONTSET (fontset)' failed
(process:34285): Pango-WARNING **: failed to choose a font, expect ugly output. engine-type='PangoRenderCoreText', script='latin'
(process:34285): GLib-GObject-CRITICAL **: g_object_ref: assertion `G_IS_OBJECT (object)' failed
(process:34285): Pango-WARNING **: couldn't load font "DejaVu Sans Mono,Bitstream Vera Sans Mono,monospace,Courier Not-Rotated 8", modified variant/weight/stretch as fallback, expect ugly output.
(process:34285): GLib-GObject-CRITICAL **: g_object_ref: assertion `G_IS_OBJECT (object)' failed
(process:34285): Pango-ERROR **: Could not load fallback font, bailing out.
./test.sh: line 9: 34285 Trace/BPT trap          rrdtool graph graph.png DEF:pkt=datafile.rrd:packets:AVERAGE LINE1:pkt#ff0000:Packets 
```

谢谢

# command-line - httrack 似乎没有使用 github url 传输数据

> ID：13533547
> 
> 赞同：3
> 
> 时间：2012-11-23T17:31:51.193
> 
> 标签：command-line, web, download, mirroring, mirror

我正在尝试获取以下 PR 以离线查看。
每个人都可以访问以下地址`https://github.com/twitter/bootstrap/issues/5982`（无需登录）但是当我运行以下代码时

```
httrack https://github.com/twitter/bootstrap/issues/5982 -O ~/Sites/github/ -v 
```

我收到以下消息：

```
mirroring https://github.com/twitter/bootstrap/issues/5982 with the wizard help..
18:28:22    Warning:    Cache: damaged cache, trying to repair
18:28:22    Warning:    Cache: 0 bytes successfully recovered in 0 entries
18:28:22    Warning:    Cache: error trying to open the cache
18:28:22    Info:   No data seems to have been transfered during this session! : restoring previous one!
Done.
Thanks for using HTTrack! 
```

# actionscript-3 - AS3 拖放到指定区域

> ID：13533550
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:32:03.180
> 
> 标签：actionscript-3

如何使用ActionScript3在指定区域拖放对象，以及如何使用hit fun。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:35:00.517

有几种方法可以做到这一点。最简单的就是使用`Sprite.startDrag()`方法。

来自[Adob​​e 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Sprite.html#startDrag%28%29)，这是一个示例：

```
import flash.display.Sprite;
import flash.events.MouseEvent;

var circle:Sprite = new Sprite();
circle.graphics.beginFill(0xFFCC00);
circle.graphics.drawCircle(0, 0, 40);

var target1:Sprite = new Sprite();
target1.graphics.beginFill(0xCCFF00);
target1.graphics.drawRect(0, 0, 100, 100);
target1.name = "target1";

var target2:Sprite = new Sprite();
target2.graphics.beginFill(0xCCFF00);
target2.graphics.drawRect(0, 200, 100, 100);
target2.name = "target2";

addChild(target1);
addChild(target2);
addChild(circle);

circle.addEventListener(MouseEvent.MOUSE_DOWN, mouseDown) 

function mouseDown(event:MouseEvent):void {
    circle.startDrag();
}
circle.addEventListener(MouseEvent.MOUSE_UP, mouseReleased);

function mouseReleased(event:MouseEvent):void {
    circle.stopDrag();
    trace(circle.dropTarget.name);
} 
```

根据您自己的需要修改它；您可以在释放鼠标时检查对象是否为指定区域。

# php - 使用 JQuery 自动完成强制选择

> ID：13533553
> 
> 赞同：2
> 
> 时间：2012-11-23T17:32:13.870
> 
> 标签：php, jquery, mysql, autocomplete

我知道以前有人问过这个问题，但我找不到任何最新或实用的答案（至少对于我的应用程序而言）。

我的 JQuery 自动完成框使用 mysql 数据库作为其源。我希望用户能够输入以获取建议，但随后被迫从下拉选项中进行选择，然后才能提交表单。

我的Javascript：

```
 <script type="text/javascript">
    $.widget( 'ui.autocomplete', $.ui.autocomplete, {
        _renderMenu: function( ul, items ) {
            var that = this;
            $.ui.autocomplete.currentItems = items;
            $.each( items, function( index, item ) {
                that._renderItemData( ul, item );
            });
        }        
    });
    $.ui.autocomplete.currentItems = [];

    $(function() {

        $("#college").autocomplete({
            source: "search.php",
            minLength: 5
        });
    });

    var inputs = {college: false};

    $('#college').change(function(){
        var id = this.id;
        inputs[id] = false;

        var length = $.ui.autocomplete.currentItems.length;
        for(var i=0; i<length; i++){
            if($(this).val() == $.ui.autocomplete.currentItems[i].value){
                inputs[id] = true;
            }
        }
    });

    $('#submit').click(function(){
        for(input in inputs){
            if(inputs.hasOwnProperty(input) && inputs[input] == false){
                alert('incorrect');
                return false;
            }
        }
        alert('correct');
        $('#college_select_form').submit();
    });
    </script> 
```

我的表格：

```
<form action="choose.php"  method="post" id="college_select_form" name="college_select_form">
                                        <input type="text" id="college"  name="college" class="entry_field" value="Type your school" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'Type your school':this.value;" /><input type="submit" id="submit" name="submit" class="submitButton" value="Go" title="Click to select school" />
                                    </form> 
```

搜索.php：

```
<?php

try {
  $conn = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass);
}
catch(PDOException $e) {
    echo $e->getMessage();
}

$return_arr = array();

if ($conn)
{
    $ac_term = "%".$_GET['term']."%";
    $query = "SELECT * FROM college_list where name like :term";
    $result = $conn->prepare($query);
    $result->bindValue(":term",$ac_term);
    $result->execute();

    /* Retrieve and store in array the results of the query.*/
    while ($row = $result->fetch(PDO::FETCH_ASSOC)) {
        array_push($return_arr, array('label' => $row['name'], 'value' => $row['name']));
    }

}
/* Free connection resources. */
//$conn = null; 
/* Toss back results as json encoded array. */
echo json_encode($return_arr);

?> 
```

那么这样做的最佳方法是什么？我能想到的唯一解决方案是使用 PHP 来验证文本框的值是否与数据库中的值匹配，但我不确定如何用我当前的代码实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:53:51.977

在我的项目中，我通过检查焦点来处理它，如果在自动完成字段中输入的文本实际上与我的下拉选项匹配。如果不是，我将简单地删除它。

```
change: function(event, ui) {  
        if (!ui.item) {  
            this.value = '';  
        }  
    } 
```

在这里查看我的完整示例-Jquery [auto comp example](http://fundapass.blogspot.in/2012/09/jquery-drop-down.html)

它有一个嵌入式小提琴，你也可以直接检查小提琴

[http://jsfiddle.net/9Agqm/3/light/](http://jsfiddle.net/9Agqm/3/light/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T00:30:19.013

在实例化自动完成对象之前，将此代码添加到 JavaScript：

```
$.widget( 'ui.autocomplete', $.ui.autocomplete, {
    _renderMenu: function( ul, items ) {
        var that = this;
        $.ui.autocomplete.currentItems = items;
        $.each( items, function( index, item ) {
            that._renderItemData( ul, item );
        });
    }        
});
$.ui.autocomplete.currentItems = []; 
```

这将使得每当菜单出现时，您都有一个用户可以选择的当前项目列表，存储在`$.ui.autocomplete.currentItems`. 然后，您可以在提交表单时使用它来检查。当然，您实现这部分的方式取决于您的表单的动态程度，但这里有一个示例，需要对输入字段列表进行硬编码并确保它们都有 id。

```
//create an object that contains every input's id with a starting value of false
var inputs = {college: false};

//for each input, you will have a function that updates your 'inputs' object
//as long as all inputs have id's and they all are using autocomplete,
//the first line could be written as: $('input').change(function(){ and the
//function would only need to be written once. It is easier to maintain 
//if you use seperate id's though like so:
$('#college').change(function(){
    var id = this.id;
    inputs[id] = false;

    var length = $.ui.autocomplete.currentItems.length;
    for(var i=0; i<length; i++){
        if($(this).val() == $.ui.autocomplete.currentItems[i].value){
            inputs[id] = true;
        }
    }
});

//when you submit, check that your inputs are all marked as true
$('#submit').click(function(){
    for(input in inputs){
        if(inputs.hasOwnProperty(input) && inputs[input] == false){
            return false; //one or more input does not have correct value
        }
    }
    //all inputs have a value generated from search.php
    $('#myform').submit();
}); 
```

* * *

**更新**

我们的两个示例（一个有效，一个无效）之间的唯一区别是您将其他事件绑定到您的输入元素，`onclick`并且`onblur`. 因此，通过将我们的侦听器从 更改`change`为 来`blur`解决问题。但是当按下回车键提交表单时，它会产生一个新问题。因此，如果我们为该特定事件添加一个侦听器，那么一切正常。这是代码现在的样子：

```
var validateInfo = function(elem){
    var id = elem.id;
    inputs[id] = false;

    var length = $.ui.autocomplete.currentItems.length;
    for(var i=0; i<length; i++){
        if($(elem).val() == $.ui.autocomplete.currentItems[i].value){
            inputs[id] = true;
        }
    }
}

$('#college').on('blur', function(){
    validateInfo(this);
}).on('keydown', function(e){
    if(e.which == 13){ //Enter key pressed
      validateInfo(this);
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T23:21:26.610

您应该始终在“choose.php”（服务器端）中检查它，因为用户可以禁用 JavaScript 并在表单的输入中发布他们想要的任何内容

```
$college = mysql_real_escape_string($_GET['college']);
if ($college != "" || $college != null || $college != -1)
{
    //DO STUFF
} 
```

注意：您应该始终使用“mysql_real_escape_string”来防止 SQL 注入！更多信息：[http ://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php](http://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php)

所以相应地在 search.php 中改变

```
$ac_term = "%".$_GET['term']."%"; 
```

到

```
$ac_term = "%". mysql_real_escape_string($_GET['term']) ."%"; 
```

您还可以在用户提交之前检查表单，以使其更加用户友好（用户不想等待几秒钟来刷新页面并显示错误！）

所以也许这样的事情会有所帮助：[为表单提交事件监听器](https://stackoverflow.com/questions/3841298/submit-event-listener-for-a-form)

```
function evtSubmit(e) {
  // code
  e.preventDefault();
 // CHECK IT HERE!
};

var myform = document.myForm;
myform.setAttribute('action', 'javascript:evtSubmit();'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T11:55:14.720

在表单中添加一个隐藏的输入元素：

`<input type="hidden" name="selectedvalue" id="selectedvalue" />`

将选择事件处理程序添加到您的自动完成中，将选定的值复制到隐藏的输入：

```
$("#college").autocomplete({
        source: "search.php",
        minLength: 5,
        select: function (event, ui) {
            $('#selectedvalue').val(ui.item.value);
        }
    }); 
```

然后忽略已发布数据中的自动完成表单输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T23:47:14.673

由于这是 javascript，您唯一关心的应该是是否从自动完成列表中选择了一个项目。这可以简单地通过在选择时将变量设置为 true 并在更改时设置为 false 来完成。这足以防止普通用户在不选择学校的情况下继续使用。为防止滥用，您需要在发布后检查价值服务器端。所有普通用户都将通过该检查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-29T11:14:53.617

如果我正确理解了这个问题，这是我以前遇到过的。这是一些几乎直接从另一个项目中提取的代码。我在这里使用了本地数据源，但是从中提取的项目使用远程数据，因此不会有区别：

```
var valueSelected = '';

$('#college').autocomplete({
    source: ['collegeA', 'collegeB', 'collegeC']
}).on('autocompletechange autocompleteselect', function (event, ui) {
    if (!ui.item) {
        valueSelected = '';
    } else {
        $('#submit').prop('disabled', false);
        valueSelected = ui.item.label;
    }
}).on('propertychange input keyup cut paste', function () {
    if ($(this).val() != valueSelected) {
        valueSelected = '';
    }
    $('#submit').prop('disabled', !valueSelected);
}); 
```

这将以编程方式启用和禁用提交按钮，具体取决于用户是否选择了值。

[在这里提琴](http://jsfiddle.net/Pf7Vu/1/)

# android - 如何在另一个活动中插入代码手风琴？

> ID：13533556
> 
> 赞同：0
> 
> 时间：2012-11-23T17:32:28.837
> 
> 标签：android, accordion, android-viewpager

我在我的应用程序中使用了viewpaer！我需要在其中一个屏幕上插入手风琴视图的位置！

我找到了我需要使用手风琴的代码，但不知道如何在我的 Activity.java 中输入代码！

对于我使用 viewpager 的模型来说很复杂。

我想知道如何在我的活动中输入手风琴代码。

这里是我的 DiferencialActivity.java 的代码：

```
package com.example.resina.e.marcon;

import android.app.Activity;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.LinearLayout;

import android.content.Context;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class DiferencialActivity extends Fragment {

    Button button1,button2;
    LinearLayout panel1,panel2;

    public static Fragment newInstance(Context context) {
        DiferencialActivity f = new DiferencialActivity();

        return f;

    }

    @Override
    public View onCreateView(LayoutInflater inflater, 
            ViewGroup container,Bundle savedInstanceState) {
        ViewGroup root = (ViewGroup) inflater.inflate(R.layout.diferencial_layout, null);

        return root;

    }

} 
```

这是您需要输入到我的 DiferencialActivity 中的代码，因此她可以解释为此活动定义的按钮的布局：

```
package com.example.resina.e.marcon;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.LinearLayout;

public class teste extends Activity
{
      Button button1,button2;
      LinearLayout panel1,panel2;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.diferencial_layout);

        button1 = (Button)findViewById(R.id.button1);
        button2 = (Button)findViewById(R.id.button2);

        button1.setOnClickListener(buttonClickListener);
        button2.setOnClickListener(buttonClickListener);

        panel1 = (LinearLayout)findViewById(R.id.panel1);
        panel2 = (LinearLayout)findViewById(R.id.panel2);

        /*We make both the panels, by default, invisible to user
        and make them appear on button click event in follwing manner*/

        panel1.setVisibility(View.GONE);
        panel2.setVisibility(View.GONE);

    }

    public OnClickListener buttonClickListener = new OnClickListener()
    {

            @Override
            public void onClick(View v)
            {
                  Button ClickedButton = (Button)v;

                  if(ClickedButton.getId()== button1.getId())
                  {
                            panel1.setVisibility(View.VISIBLE);
                          panel2.setVisibility(View.GONE);
                  }
                  else if(ClickedButton.getId()== button2.getId())
                  {
                        panel1.setVisibility(View.GONE);
                    panel2.setVisibility(View.VISIBLE);
                  }
            }
      };

} 
```

如何在我的 DiferencialActivity.java 中插入此代码？

# php - 替换 session_register("myusername"); 在 PHP V5.3.6 中

> ID：13533560
> 
> 赞同：1
> 
> 时间：2012-11-23T17:32:58.617
> 
> 标签：php, function, deprecated

我的代码中有以下内容

```
session_register("myusername");
session_register("mypassword"); 
```

内

```
 <?php

ob_start();
$host="ClubEvents.db.9606426.hostedresource.com"; // Host name 
$username="ClubEventsRead"; // Mysql username 
$password="Pa55word!"; // Mysql password 
    $db_name="ClubEvents"; // Database name 
$tbl_name="members"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// Define $myusername and $mypassword 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
    $myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);
$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){

// Register $myusername, $mypassword and redirect to file "login_success.php"
session_register("myusername");
session_register("mypassword"); 
header("location:login_success.php");
}
else {
echo "Wrong Username or Password";
}
ob_end_flush();
?> 
```

既然 php 函数已被弃用，那么要替换什么？

我一直在阅读[http://php.net/manual/en/function.session-register.php](http://php.net/manual/en/function.session-register.php)但有点困惑，整天都在与这个作斗争。

谢谢

亨利

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:36:34.727

只需将所需的值放在 $_SESSION 数组中，例如：

```
$_SESSION['myusername'] = "xxx"; 
```

我没有在你的代码上看到你 session_start 。不要忘记它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-21T22:58:27.193

我认为您想在会话中保存您的用户名和密码：

首先，在你的代码中使用“login”、“username”、“password”不再安全，一些恶意脚本试图在你的代码中找到这些词并四处游荡。

```
session_start();
$_SESSION['myuse'] = $myuse;
$_SESSION['mypas'] = $mypas; 
```

# asp.net-mvc - 如何在不属于数据库的模型中设置属性

> ID：13533563
> 
> 赞同：2
> 
> 时间：2012-11-23T17:33:11.533
> 
> 标签：asp.net-mvc, model-view-controller, asp.net-mvc-4

在我的模型内部，我有一个属性，称为`attributes`它的值是从`cutomized_attributes`我的数据库中获取的，该属性在数据库`attributes`中不存在它刚刚计算的值，而我正在尝试执行以下操作时遇到了这个错误：

> 错误：System.Data.Entity.Edm.EdmEntityType: : EntityType 'JToken' 没有定义键。定义此 EntityType 的键

模型：

```
public class Restaurant
{
    public int id{ get; set; }
    public string  name{ get; set; }
    public string cutomized_attributes { get; set; }
    private JObject _attributes { get; set; }
    public JObject attributes
    {
        get
        {
            if (this._attributes == null)
                return this._attributes = RestaurantAttributes.parseAttrString(this.cutomized_attributes);
            return this._attributes;
        }
        set
        {
            this._attributes = value;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:52:12.473

假设您首先使用代码...在 dbcontext 子类中

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
     modelBuilder.Entity<Restaurant>().Ignore(x => x.attributes);
} 
```

# google-apps-script - 如何使用 oauth 2.0 从 appscript 授权到 Google API？

> ID：13533565
> 
> 赞同：7
> 
> 时间：2012-11-23T17:33:32.543
> 
> 标签：google-apps-script, oauth-2.0

我正在使用 AppScript 并尝试获取 oAuth 2.0 访问令牌。

那里有任何示例如何使它在 AppScript 中工作？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-23T18:24:17.593

我正在开发一个更简洁的教程版本，但这里有一个简单的 Gist，它应该给你一些关于事情如何工作的示例代码 -

[https://gist.github.com/4079885](https://gist.github.com/4079885)

它仍然缺少注销、错误处理和 refresh_token 功能，但至少您应该能够登录并调用受 oAuth 2 保护的 Google API（在本例中是配置文件 API）。

你可以在这里看到它的作用——

[https://script.google.com/macros/s/AKfycby3gHf7vlIsfOOa9C27z9kVE79DybcuJHtEnNZqT5G8LumszQG3/exec](https://script.google.com/macros/s/AKfycby3gHf7vlIsfOOa9C27z9kVE79DybcuJHtEnNZqT5G8LumszQG3/exec)

关键是使用 oAuth 2 Web Server 流。查看`getAndStoreAccessToken`要点中的函数以获取关键细节。

我希望在接下来的几周内发布此内容，但同时希望这会有所帮助。

**更新 - 在 redirect_uri 上添加信息**

客户端密钥与授权代码返回到的特定重定向 URI 相关联。

您需要将其设置在 - [https://code.google.com/apis/console/](https://code.google.com/apis/console/)

![重定向 URI](../Images/0baf9dda3cc3f29a6149dc0d7f77fc28.png)

突出显示的 URI 需要与发布的 URI 匹配（以 /exec 结尾）。您可以从 Publish -> Deploy as web app 下的脚本编辑器中获取已发布的 URI。确保在进行更改时保存新版本并发布新版本（发布的 URI 保持不变）。

![发布的 URI](../Images/c26b4f68e9ff63a51c5808078380a55d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-09T03:33:14.823

我修改了上面的示例以使用新的状态令牌 API 和 CacheService 而不是现在已弃用的 UserProperties。使用状态令牌 API 似乎使事情更安全，因为回调 url 将在超时后停止接受状态令牌。

同样的警告也适用。您的重定向 URI 必须添加到开发人员控制台中的（脚本）项目中，同时您必须从控制台中提取 CLIENT_SECRET 和 CLIENT_ID 并将它们粘贴进去。如果您在域中工作，似乎没有对 ScriptApp.getService().getUrl() 将返回什么 URL 有任何保证，所以我基本上让它动态获取地址，然后等待（第二个）重定向失败，然后硬编码生成的 URI。

[https://gist.github.com/mclaughta/2f4af6f14d6aeadb7611](https://gist.github.com/mclaughta/2f4af6f14d6aeadb7611)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-09T22:29:55.623

请注意，您可以使用这个新 API 构建 OAuth2 流程，但它还不是一个完整的示例： [https://developers.google.com/apps-script/reference/script/script-app#newStateToken()](https://developers.google.com/apps-script/reference/script/script-app#newStateToken%28%29)

特别是，您不应自己将“状态”直接传递给 /usercallback URL，因为 OAuth2 服务提供者负责往返“状态”参数。（相反，您将“状态”传递给身份验证 URL，服务提供者会自动将其附加到回调 URL。）

# php - 如何使用 Nginx & Orchestra PHP Cloud 重写 URL

> ID：13533573
> 
> 赞同：1
> 
> 时间：2012-11-23T17:34:01.437
> 
> 标签：php, mod-rewrite, nginx, orchestra

我正在从 Apache 环境迁移到 Engine Yard 的 Orchestra PHP Cloud。我不知道如何适应我的应用程序的 URL 重写规则。他们为此提供的文档非常有限且基本，可以在此处查看：

[https://support.cloud.engineyard.com/entries/21066927-orchestra-php-cloud-service-overview](https://support.cloud.engineyard.com/entries/21066927-orchestra-php-cloud-service-overview)

这是我今天使用的 .htaccess。我很想就如何解决这个问题提供一些意见。

```
<IfModule mod_rewrite.c>
RewriteEngine On
#RewriteBase /
RewriteCond %{REQUEST_URI} ^(.*)//(.*)$
RewriteRule . %1/%2 [R=301,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ index.php?qa-rewrite=$0&%{QUERY_STRING} [L]
</IfModule> 
```

# windows-8 - 如何在 WinRT 中使用框架？

> ID：13533576
> 
> 赞同：0
> 
> 时间：2012-11-23T17:34:13.997
> 
> 标签：windows-8, microsoft-metro, winrt-xaml

在 WPF XAML 中，我可以使用这样的框架：

```
<Frame Source="Frame.xaml" /> 
```

在 WinRT/Windows 风格的应用程序中，我无法为框架设置源。如何在 WinRT 中使用框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:02:44.520

查看从空白应用程序模板中获得的样板导航代码。在[App.OnLaunched](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.application.onlaunched.aspx)的代码中创建了一个框架，而不是 Source 属性，您将使用[Navigate](http://msdn.microsoft.com/en-us/library/windows/apps/br242694.aspx)方法。

# powershell - 添加了未继承到子文件夹/文件的权限

> ID：13533577
> 
> 赞同：0
> 
> 时间：2012-11-23T17:34:15.447
> 
> 标签：powershell, permissions, directory, add

我试图从域中为 bob 用户添加修改权限，但它只授予权限，根本没有权限，甚至没有继承到路径的子文件夹`D:\test`，脚本如下：

```
$Right = [System.Security.AccessControl.FileSystemRights]"Modify"
$InheritanceFlag = [System.Security.AccessControl.InheritanceFlags]::None 
$PropagationFlag = [System.Security.AccessControl.PropagationFlags]::InheritOnly  
$objType =[System.Security.AccessControl.AccessControlType]::Allow
$objUser = New-Object System.Security.Principal.NTAccount("domain\bob") 

$objACE = New-Object System.Security.AccessControl.FileSystemAccessRule($objUser, $Right, $InheritanceFlag, $PropagationFlag, $objType) 

$objACL = Get-ACL "D:\Test"
$objACL.AddAccessRule($objACE)
Set-ACL "D:\Test" -aclobject $objACL 
```

我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T00:15:31.057

不确定您所说的“只有权限，根本没有权限”是什么意思，但以下行是阻止您的 ACL 被继承的原因：

```
$InheritanceFlag = [System.Security.AccessControl.InheritanceFlags]::None 
```

将该行更改为

```
$InheritanceFlag = ([System.Security.AccessControl.InheritanceFlags]::ContainerInherit, [System.Security.AccessControl.InheritanceFlags]::ObjectInherit) 
```

并且 ACL 应该由子对象继承。

# javascript - appbar的弹出框可以包含表单吗？

> ID：13533578
> 
> 赞同：0
> 
> 时间：2012-11-23T17:34:17.553
> 
> 标签：javascript, html, windows-8, winjs

我试图在应用程序栏中有一个登录按钮，一旦我点击它，就会出现一个登录（弹出）。我试过了：html：

```
<!-- APPBAR -->
<div id="appbar" data-win-control="WinJS.UI.AppBar" data-win-options="{layout:'custom',placement:'top'}">
    <button data-win-control="WinJS.UI.AppBarCommand" data-win-options="{id:'cmdLog', label:'Login/Logout', icon:'placeholder',section:'global',flyout:select('#loginFlyout')}" type="button"></button>
</div>
<!-- APPBAR FLYOUT -->
<div id="loginFlyout" data-win-control="WinJS.UI.Menu">
    <form id='register' method='post'
        accept-charset='UTF-8'>
        <fieldset>
            <legend>Login</legend>
            <label for='username'>UserName:</label>
            <input type='text' name='username' id='username' maxlength="50" />
            <label for='password'>Password:</label>
            <input type='password' name='password' id='password' maxlength="21" />
            <input type='button' name='Submit' onclick="logincheck()" value='Submit' />
        </fieldset>
    </form>
</div> 
```

我得到了这个： JavaScript 运行时错误：WinJS.UI._Overlay.MustContainCommands：无效的 HTML：AppBars/Menus 必须只包含 AppBarCommands/MenuCommands
我猜我不能`<form .../>`在其中。有解决方法吗？或任何建议，非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:48:11.383

我忘记了 WinJS.UI.Menu 的样子，但您是否考虑过使用 SettingsFlyout 或创建自己的 ModalDialog？

# html - 文字排列不正确？

> ID：13533582
> 
> 赞同：0
> 
> 时间：2012-11-23T17:34:37.070
> 
> 标签：html, css

我有一个我*认为*还可以的网站，但显然有些人对文本有疑问，因此在向雇主炫耀我的投资组合时，我可能会开枪打死自己。主要问题是我没有看到其他人看到的东西。或者，也许他们*看到*了我所看到的，但只是设计得不好。

首先，我希望您查看我的网站： http: [//mmking9999.com](http://mmking9999.com)

浏览了一下之后，请查看我的代码并告诉我哪里出错了。如果您有任何其他建议，请告诉我。这是主页的代码：

```
<html>
<head>
<link rel="stylesheet" 
type="text/css" href="http://mmking9999.com/css/style.css" />

</head>
<body>

<!--Site logo. Clicking on it will redirect to this page.-->
<div class="logo">
<a href="http://mmking9999.com/"><img src="http://mmking9999.com/Images/SiteLogo.png" /></a>
</div>

<!-- Menu window goes here. The text are images that link to other pages.-->

<div class="menu">
<img src="http://mmking9999.com/Images/MenuWindow.png" />
</div>

<div class="portfolio_url">
<a href="http://mmking9999.com/portfoliopage.html"><img src="http://mmking9999.com/Images/portfoliourl.png"  /></a>
</div>

<div class="blog_url">
<img src="http://mmking9999.com/Images/blogurl.png"  />
</div>

<div class="random_url">
<a href="http://mmking9999.com/randomstuff.html"><img src="http://mmking9999.com/Images/randomurl.png"  /></a>
</div>

<div class="email">
<a href="mailto:mmking9999@gmail.com" target="_blank"><img src="http://mmking9999.com/Images/emailicon.png"  /></a>
</div>

<div class="linkedin">
<a href="http://ca.linkedin.com/in/mikeadmurray" target="_blank"><img src="http://mmking9999.com/Images/linkedinicon.png"  /></a>
</div>

<div class="twitter">
<a href="http://twitter.com/MikeADMurray" target="_blank"><img src="http://mmking9999.com/Images/twittericon.png"  /></a>
</div>

<div class="window"><br><br><p>Welcome to my website!  My name is Mike Murray, a rookie game developer/designer. Here, you'll find stuff about what I do and what I hope to become in the future.  I am an avid gamer, and it was that passion that led me to want to create the video games that people like to play.  Having played video games for over 20 years, I figure I should be able to create something cool with the knowledge I have!</p></div>

</body>
</html> 
```

这是我正在使用的 CSS：

```
/*The code for the body sets the default settings for all pages */
body 
{
    background-image:url('http://mmking9999.com/Images/sitewallpaper.png');
}

/* Link colours. I use bright colours to contrast the black window. */
a:link {
COLOR: #86C6FE;
}
a:visited {
COLOR: #FF0000;
}
a:hover {
COLOR: #FFFF00;
}
a:active {
COLOR: #00FF00;
}

/* Main window. Used to display text and images */
img
{
    margin: 2px;
    height: auto;
    width: auto;
    float: left;
}

h1
{
    color:red;
    text-align:center;
    font-family:calibri;
}

p
{
    /* font */
    color:rgb(255,255,255);
    font-family:"Small Fonts", calibri, arial, "Times New Roman";
    font-size:18px;
    text-align:left; width:700px; margin-left:200px;
}

/* Main window. All info is displayed in here */
div.window
{
    background-image:url('http://mmking9999.com/Images/IframeWindow.png');
    background-repeat:no-repeat;
    position:relative;
    width:60%;
    height:70%;
    top:80px;
    left:500px;

    /*text*/
    /*color:rgb(255,255,255);
    font-family:"Small Fonts", calibri, arial, "Times New Roman";
    font-size:18px;*/

}

/* Menu */
div.menu
{
    position:relative;
    width:40%;
    height:10%;
}

/*Site logo */
div.logo
{
    position:relative;
    width:40%;
    height:5%;
    left:500px;
}

/*Images (so they aren't constrained by the attributes defined in div.window)*/
div.image
{
    position:absolute;
    left:20px;
}

/* In case I need another row of images */
div.image2
{
    position:relative;
    left:-150px;
    width:90%;
    height:90%;
}

/*Menu urls*/
div.portfolio_url
{
    position:relative;
    left:-175px;
    top:30px;
}

div.blog_url
{
    position:relative;
    left:-305px;
    top:90px;
}

div.random_url
{
    position:relative;
    left:-445px;
    top:150px;
}

div.email
{
    position:relative;
    top:250px;
    left:-600px;
}

div.linkedin
{
    position:relative;
    top:250px;
    left:-580px;
}

div.twitter
{
    position:relative;
    top:250px;
    left:-560px;
}

/*iframe
{

    position:relative;
    top:80px;
    left:280px;
    width:60%; height:70%;
}*/ 
```

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:40:08.577

[http://d.pr/i/OhIF](http://d.pr/i/OhIF)

尝试在您的 div 上使用 position:absolute 而不是 relative。

# windows - 同一个文件夹下的两个同名文件

> ID：13533583
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:34:38.397
> 
> 标签：windows, windows-7, windows-7-x64

我在同一个文件夹下有两个同名的文件。控制台和窗口资源管理器之间的文件名不同。

我用我的软件从其他地方复制了一个文件并将其重命名为**dxr.jpg**。该文件确实被复制到了**Downloads**文件夹，但它的名称仍然是**Penguins.jpg**。该文件的名称在 cmd 控制台中显示为**dxr.jpg** ，但在窗口资源管理器中显示为**Penguins.jpg 。**然后，我将其复制并粘贴到同一文件夹下，即**Downloads**。然后，将其重命名为**Penguins.jpg**。工作！两个同名文件。

使用此功能：

```
BOOL WINAPI CopyFile(
  _In_  LPCTSTR lpExistingFileName,
  _In_  LPCTSTR lpNewFileName,
  _In_  BOOL bFailIfExists
); 
```

注意：这两个文件的名称在窗口资源管理器中显示相同，但​​在 cmd 控制台中，它们是不同的。

我重新启动了我的电脑。情况没有改变。任何人都可以告诉我原因。我正在使用 Windows 7 专业版 64 位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:31:28.210

**MFC CopyFile() 有一个小问题，用于从Libraries\Pictures**等虚拟 shell 文件夹进行复制。.Net 功能可能会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:36:08.947

虚拟外壳文件夹与其他文件夹有些不同。

# javascript - Javascript setTimeout 参数从循环反转

> ID：13533584
> 
> 赞同：1
> 
> 时间：2012-11-23T17:34:38.803
> 
> 标签：javascript

这个循环在一个函数中，它从 10 开始倒计时，但是如果我提醒在函数中使用传递的参数`i`，`setV`它实际上会向上计数！

```
for (var i=10;i>0;i--){
setTimeout('setV('+i+',"Out")',100);
}

function setV(c,t){
alert(c);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:37:47.300

所有的 setV 都被编程为同时执行（瞬时循环执行后 100 毫秒），顺序不确定（参见[规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#timers)）。

你可能想要

```
for (var i=10;i>0;i--){
   setTimeout('setV('+i+',"Out")',100*(11-i));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:36:05.700

如果您使用以下方式描述行为：

```
setTimeout('setV('+i+',"Out")',i*100); 
```

它计数的原因是因为 1s 的回调集将早于 2s 的一组回调执行，而 2s 的回调将早于 3s 的一组回调执行......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:45:04.540

当所有的超时都设置为同时运行时，没有保证他们会以什么顺序运行。

这是编写该循环的更好方法：

```
 function initThis() {
    var idx = 0;
    function doOneIteration() {
      window.alert(idx);
      idx++;
      if (idx <= 10) {
        window.setTimeout(doOneIteration);
      }
    }
    doOneIteration(); // Start loop
  }  

  initThis();  // This makes it all happen 
```

# haskell - Haskell - 严格与非严格与 foldl

> ID：13533586
> 
> 赞同：14
> 
> 时间：2012-11-23T17:34:53.450
> 
> 标签：haskell, lazy-evaluation, fold, strict

我对严格与非严格的定义有疑问。Haskell wiki-book for Laziness (http://en.wikibooks.org/wiki/Haskell/Laziness) 在“黑盒严格性分析”部分下做出以下断言：

> [假设函数 f 接受单个参数。] 函数 f 是严格函数当且仅当 f undefined 导致打印错误并停止我们的程序。

wiki 与 对比`const`，`id`分别显示非严格和严格功能。

我的问题是，我的印象是 foldl 是以非严格的方式评估的，导致不希望的空间泄漏，而 foldl' 是严格的。

然而，上面的测试似乎断言 foldl 和 foldl' 都是严格的。如果它们的任何参数未定义，则这两个函数都会产生未定义：

```
> Data.List.foldl (+) undefined [1,2,3,4]
    Prelude.undefined
> Data.List.foldl' (+) 0 undefined
    Prelude.undefined
> Data.List.foldl' (+) undefined [1,2,3,4]
    Prelude.undefined
> Data.List.foldl (+) 0 undefined
    Prelude.undefined 
```

有人可以解释我缺少什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-23T18:38:04.490

一个更好的定义是：如果一个函数在这个参数未定义的情况下是未定义的，则称该函数在一个参数中是严格的。

让我们看一下 foldl 的以下定义：

```
 foldl f s [] = s
 foldl f s (x:xs) = foldl f (f s x) xs 
```

由此可以得出以下结论：

1.  它在 中并不严格`f`，因为`f`s 值在第一个方程中并不重要。
2.  两者都不严格`s`，因为列表可能是非空的，并且`f`在它的第一个参数中可能是非严格的（想想`flip const`）。
3.  然而，它在 list 参数中是严格的，因为无论是什么`f`和`s`是，这个参数都必须被评估为所谓的*弱头范式*。如果您可以告诉最外层的构造函数，则代数数据类型的值在 WHNF 中。换句话说， foldl 无法避免查看 list 参数是否为空列表。因此，它必须至少到目前为止评估列表值。但是，如果该值未定义，则这两个方程都不适用，因此该应用程序`foldl`本身是未定义的。

`foldl`此外，从累加器不严格这一事实`s`我们还可以了解为什么在许多情况下使用它是一个坏主意`foldl`：系统认为没有理由实际评估该术语`f s x`，因为它被传递给一个不严格的函数在相应的论点中。事实上，如果它确实评估它，那将违反非严格性原则。因此，根据列表的长度，在累加器中会累积一个巨大的 thunk：

```
((((s `f` x_1) `f` x_2) `f` x_3) ....) `f` x_n) 
```

现在，如果`f`它的左参数是严格的，例如`(+)`，任何评估 foldl 的结果的尝试都需要与列表长度成比例的堆栈空间。因为，评估`f ... x_n`, where`...`代表左侧必须首先评估左侧，依此类推，从上到下`f s x_1`。

因此我们有它

```
foldl (flip const) 0 [1..n] 
```

是`n`，而

```
foldl const 0 [1..n] 
```

将堆栈溢出足够大`n`。这是一个明确的指标，表明在某些情况下人类比机器更擅长计算，因为在第二个示例中，列表的长度和内容完全不相关，大多数人会立即*看到*结果必须为 0。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T18:06:54.663

您引用的 wiki 部分假设您正在处理一个带有单个参数的函数。情况`foldl`不同，首先是因为它需要多个参数，但更重要的是因为其中一个参数是函数。让我们看看几个例子，看看`foldl`它的论点什么时候是严格的。（请注意，以下内容也适用于`foldl'`。）

```
> foldl undefined 0 []
0
> foldl undefined 0 [1]
*** Exception: Prelude.undefined 
```

对于空列表，`foldl`不需要传递给它的组合函数。在这种情况下，第一个参数并不严格。

```
> foldl (+) undefined [1, 2, 3]
*** Exception: Prelude.undefined
> foldl (+) 0 undefined
*** Exception: Prelude.undefined 
```

当你`(+)`作为组合函数传入时，它的起始值和列表是严格的。这是另一个示例，具有不同的组合功能：

```
> foldl (flip (:)) undefined [1, 2, 3]
[3,2,1*** Exception: Prelude.undefined 
```

有趣的。起始值未定义，但似乎`foldl`在引发异常之前调用产生了一些结果。那这个呢：

```
> let (x:xs) = foldl (flip (:)) undefined [1, 2, 3]
> x
3 
```

那里没有例外。所以我们可以得到*部分*结果，而`foldl`不会碰到 dreadd `Prelude.undefined`。为什么？

好吧，唯一改变的是我们传递给的组合函数`foldl`。而`(+)`有类型（大致）`Int -> Int -> Int`，`flip (:)`有类型`[a] -> a -> [a]`。而`3 + ((2 + 1) + undefined)`不是[弱头范式](http://www.haskell.org/haskellwiki/Weak_head_normal_form)，必须减少，以便`undefined`评估 ，`(3:(2:(1:undefined)))` *是*弱头范式，不需要进一步评估，特别是不需要评估`undefined`.

# xcode - 在 Xcode 中将图标添加到应用程序

> ID：13533591
> 
> 赞同：3
> 
> 时间：2012-11-23T17:35:09.287
> 
> 标签：xcode

我知道我应该做什么：在应用程序的 plist 中添加一个“图标文件”键，然后单击显示三角形的左侧并在 png 上输入一些名称。问题是，我没有点击显示三角形。我在运行 10.6.8 的 MacBook 上使用 XCode 3.2.6。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:51:39.040

如果 Xcode 3.x 给您带来麻烦，您应该认真考虑升级到 4.5。

除此之外，您可以关闭 Xcode，然后在文本编辑器中打开 Info.plist。将以下内容放入其中：

```
<key>CFBundleIconFiles</key>
<array>
    <string>Icon-72@2x.png</string>
    <string>Icon@2x.png</string>
    <string>Icon-72.png</string>
</array>
<key>CFBundleIcons</key>
<dict>
    <key>CFBundlePrimaryIcon</key>
    <dict>
        <key>CFBundleIconFiles</key>
        <array>
            <string>Icon-72@2x.png</string>
            <string>Icon@2x.png</string>
            <string>Icon-72.png</string>
        </array>
    </dict>
</dict> 
```

现在，您的 plist 中应该有您的图标信息。打开 Xcode，看看你现在是否可以像以前一样编辑你的 plist。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T13:41:36.753

# haskell - QuickCheck 2 批处理

> ID：13533593
> 
> 赞同：10
> 
> 时间：2012-11-23T17:35:12.890
> 
> 标签：haskell, batch-processing, quickcheck

QuickCheck的模块在[版本 2](http://hackage.haskell.org/package/QuickCheck-2.1)`Batch`中被删除（[1.2.0.1 仍然有它](http://hackage.haskell.org/package/QuickCheck-1.2.0.1)）。正因为如此，我总是觉得 -将多个测试放在一起有点 hacky。我是否忽略了 QuickCheck 2 中的后续功能？是否有将独立测试组合在一起的规范方法？`mapM_`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T20:18:49.783

有“go big or go home”选项，可以通过`Test.QuickCheck.All`. 它需要 Template Haskell，并且所有属性都必须以`prop_`. 前任：

```
{-# LANGUAGE TemplateHaskell #-}

import Test.QuickCheck.All

prop_one, prop_two :: a -> Bool
prop_one = const True
prop_two = const True

runTests :: IO Bool
runTests = $quickCheckAll

main :: IO ()
main = runTests >>= \passed -> if passed then putStrLn "All tests passed."
                                         else putStrLn "Some tests failed." 
```

# c# - WCF N-Tier 应用程序中的异常处理和日志记录

> ID：13533595
> 
> 赞同：3
> 
> 时间：2012-11-23T17:35:25.340
> 
> 标签：c#, wcf, logging, exception-handling, n-tier-architecture

我们的应用程序的布局如下

WCF - 业务层类库 dll - 数据访问层类库 dll - SQL Server。

通常，类库不访问数据库以外的外部资源。

WCF 层为报表提供数据。

看到一些关于异常应该在上层处理的指导，我想这意味着我可以简单地让类库抛出异常，所以我不需要类库中的任何 try catch 语句！

我觉得不需要在库中捕获异常并记录特定信息，并计划在应用程序/客户端代码中捕获异常，在这种情况下是 WCF 层。 [WCF 异常处理策略](https://stackoverflow.com/questions/2379917/wcf-exception-handling-strategies)

在这个级别，我计划记录异常/堆栈跟踪并呈现一个用户友好的异常。

我觉得在 WCF 级别记录堆栈跟踪将为我提供足够的信息来确定问题的原因。

这是一个好的方法还是我错过了什么

我希望保持简单，避免不必要的尝试捕获并仅在一个位置处理异常/登录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:43:58.930

[Eric Lippert 写了一篇关于异常处理的好文章](http://blogs.msdn.com/b/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)。我建议你可以看看。

除非您绝对可以做某事，否则您可能会捕获任何异常，以便您可以尝试其他方法来避免它。如果您无法避免它，那么让我们希望该`finally`块最好。否则，恕我直言，最好让异常冒泡并在那里处理，因为你“不知道”什么会真正消耗你的服务，所以我认为你的服务应该让任何异常冒泡并让最终用户决定如何处理它，因为每个人都不会以同样的方式处理这些。

同样，从我现在找不到 URL 的 Eric Lippert 的博客中，最好编写如下代码：

```
if (someUncoverableCondition)
    throw new SomeSpecificException(); 
```

而不是试图捕获所有可能的异常。

最后，处理你能处理的和你知道如何处理的，并让其他异常发生。也许过一段时间你就会知道如何以一种有效的方式处理这些异常，这样你就可以重构你的代码了。同时，如果您觉得让他们通过可能会更好，那在您的情况下一定是正确的做法。

这是进一步阅读。

[异常处理的坏做法](http://www.hans-eric.com/2009/10/31/the-bad-practices-of-exception-handling/)（也许没有直接关系，但无论如何都很好知道）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T19:19:32.727

一种方法是实现一个自定义[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)，也许作为一个行为扩展元素，您可以以声明方式添加到您的配置中。

在执行该`ProvideFault`方法时，您可以：

*   记录异常

*   （可选）为客户端生成故障。

# php - mysql_query 使用 LIKE 时返回错误

> ID：13533596
> 
> 赞同：0
> 
> 时间：2012-11-23T17:35:28.833
> 
> 标签：php, mysql, syntax, where, sql-like

我正在尝试创建一个脚本，该脚本通过给定的术语和城市选择给定 MySQL 列中的所有用户。城市将特定于会员，但每个会员可以有 3 或 4 个不同的职位（调酒师、服务员、主持人等）。我尝试使用的代码如下，但是，它给了我一个错误。如果您需要更多信息，请与我们联系。谢谢！

```
Could not find staff: Unknown column 'Bartender' in 'where clause' 
```

```
<?php

    $perpage = 15;
    $city = $_GET['city'];
    $type = $_GET['type'];

    if(isset($_GET["page"]))
    {
        $page = intval($_GET["page"]);
    }
    else
    {
        $page = 1;
    }

    $calc = $perpage * $page;
    $start = $calc - $perpage;
    $result = mysql_query("SELECT * FROM staff WHERE titles LIKE $type AND city=$city LIMIT $start, $perpage");
    $rows = mysql_num_rows($result);
    if($rows)
    {
        $i = 0;
        while($post = mysql_fetch_array($result))
        {
?>
            <tr style="background-color: #cccccc;">
                <td style="font-weight: bold;font-family: arial;"><?php echo $post["staffnum"]; ?> >> <?php echo $post["titles"]; ?></td>
            </tr>
            <tr>
                <td style="font-family: arial;padding-left: 20px;"><?php echo $post["abt1"]; ?></td>
            </tr>
<?php
        }
    } else {
          die('Could not find staff: ' . mysql_error());
    }
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:37:39.453

为了随心所欲地使用`LIKE`，您需要将其括在引号中并使用适当的`%`字符。

```
$type = mysql_real_escape_string($_GET['type']);
// do the same with $city and any other user input

$result = mysql_query("SELECT * FROM staff WHERE titles LIKE '%" . $type . "%' AND city='" . $city . "' LIMIT $start, $perpage"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:07:01.000

尝试

```
$type = mysql_real_escape_string($_GET['type']);
$city = mysql_real_escape_string($_GET['city']);

$result = mysql_query("SELECT * FROM staff WHERE titles LIKE '%$type%' AND city='$city' LIMIT $start, $perpage"); 
```

# c++ - 动态定义函数返回类型

> ID：13533597
> 
> 赞同：3
> 
> 时间：2012-11-23T17:35:30.207
> 
> 标签：c++, function, return-type

我有一个`Message`类能够将其有效负载打包为二进制文件并将其解压缩。喜欢：

```
PayloadA p;
msg->Unpack(&p); 
```

在哪里`PayloadA`上课。

问题是我有一堆有效载荷，所以我需要巨人`if`或`switch`声明：

```
if (msg->PayloadType() == kPayloadTypeA)
{
    PayloadA p;
    msg->Unpack(&p); // void Unpack(IPayload *);

    // do something with payload ...
}
else if ... 
```

我想编写一个解包有效负载的辅助函数。但是这个函数的类型是什么？就像是：

```
PayloadType UnpackPayload(IMessage *msg) { ... } 
```

哪里`PayloadType`是`typedef`适当的有效载荷类。我知道这是不可能的，但我正在寻找这样的解决方案。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:03:31.087

根据类型创建有效负载的工厂方法如何，结合每个有效负载类型的有效负载构造函数，将消息作为参数？

无法避免开关（或一些类似的构造），但至少它很简单，并且构造代码与开关是分开的。

例子：

```
class PayloadA : public Payload
{
  public:
  PayloadA(const &Message m) {...} // unpacks from m
};

class PayloadB : public Payload
{
  public:
  PayloadB(const &Message m) {...} // as above
};

Payload * UnpackFromMessage(const Message &m)
{
  switch (m.PayloadType) :
  case TypeA : return new PayloadA(m);
  case TypeB : return new PayloadB(m);
  ... etc...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:49:20.670

我会再上一层来完全避免这个问题：

```
#include <map>
#include <functional>

...
std::map<int, std::function<void()> _actions;
...

// In some init section
_actions[kPayloadA] = [](IMessage* msg) {
    PayloadA p;
    msg->Unpack(&p);

    // do something with payload ...
};
// repeat for all payloads

...

// decoding function
DecodeMsg(IMessage* msg) {
    _actions[id](msg);
} 
```

要进一步减少代码大小，请尝试制作`Unpack`一个函数模板（只有在它不是虚拟的情况下才可以轻松实现，如果是，您可以尝试添加一层间接使其不是；）：

```
class Message {
   template <class Payload>
   Payload Unpack() { ... }
};

auto p = msg->Unpack<PayloadA>();

// do something with payload ... 
```

## 编辑

现在让我们看看如何避免编写长长的`_actions[kPayloadN]`. 这是非常重要的。

首先，您需要一个助手在静态初始化期间（即在 main 之前）运行代码：

```
template <class T>
class Registrable
{
    struct Registrar
    {
        Registrar()
        {
            T::Init();
        }
    };

    static Registrar R;

    template <Registrar& r>
    struct Force{ };
    static Force<R> F; // Required to force all compilers to instantiate R
                       // it won't be done without this
};

template <class T>
typename Registrable<T>::Registrar Registrable<T>::R; 
```

现在我们需要定义我们实际的注册逻辑：

```
typedef map<int, function<void()> PayloadActionsT;
inline PayloadActionsT& GetActions() // you may move this to a CPP
{
    static PayloadActionsT all;
    return all;
} 
```

然后我们考虑解析代码：

```
template <class Payload>
struct BasePayload : Registrable<BasePayload>
{
    static void Init()
    {
        GetActions()[Payload::Id] = [](IMessage* msg) {
             auto p = msg->Unpack<Payload>();
             p.Action();
        }
    }
}; 
```

然后我们一一定义所有的payload

```
struct PayloadA : BasePayload<PayloadA>
{
    static const int Id = /* something unique */;
    void Action()
    { /* what to do with this payload */ }
} 
```

最后我们解析传入的消息：

```
void DecodeMessage(IMessage* msg)
{
    static const auto& actions = GetActions();
    actions[msg->GetPayloadType]();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T19:48:18.900

一个重要的问题是有效载荷有何不同，以及它们有何相同之处。在某些情况下，您可以生成由有效负载确定类型的对象，然后通过所有有效负载类型通用的虚拟接口与它们交互的系统。

另一个选项假设您有一个有限且固定的有效负载类型列表，返回 a`boost::variant`相对容易。然后为了处理它，调用`apply_visitor`一个接受变体中每种类型的函子。

如果您只想以不同的方式处理一种类型的有效负载，那么“当且仅当类型与 T 匹配时调用并运行 lambda”函数并不难以这种方式编写。

所以你可以得到这样的语法：

```
struct State;
struct HandlePayload
{
  typedef void return_type;
  State* s;
  HandlePayload(State* s_):s(s_) {}
  void operator()( int const& payload ) const {
    // handle int here
  }
  void operator()( std::shared_ptr<bob> const& payload ) const {
    // handle bob ptrs here
  }
  template<typename T>
  void operator()( T const& payload ) const {
    // other types, maybe ignore them
  }
} 
```

这很可爱，但你会注意到它是非常间接的。但是，您还会注意到，您可以使用上面的通用类型 T 编写模板代码来处理有效负载，并在某些情况下使用诸如特征类之类的东西，或者在其他情况下使用显式特化。

如果您希望有效负载是一种特定类型，并且只想在这种情况下做一些特殊工作，那么在 a 上编写单一类型的处理程序`boost::variant`很容易。

```
template<typename T, typename Func>
struct Helper {
  typedef bool return_type;
  Func f;
  Helper(Func f_):f(f_) {}
  bool operator()(T const& t) {f(t); return true; }
  template<typename U>
  bool operator()(U const& u) { return false; }
};    
template<typename T, typename Variant, typename Func>
bool ApplyFunc( Variant const& v, Func f )
{
  return boost::apply_visitor( Helper<T, Func>(f), v );
} 
```

它将在变体 v 上调用 f 但仅在变体中的类型 T 上调用，如果类型匹配则返回 true 。

使用它，您可以执行以下操作：

```
boost::variant<int, double> v = 1.0;
boost::variant<int, double> v2 = int(1);
ApplyFunc<double>( v, [&](double d) { std::cout << "Double is " << d << "\n"; } );
ApplyFunc<double>( v2, [&](double d) { std::cout << "code is not run\n"; } );
ApplyFunc<int>( v2, [&](int i) { std::cout << "code is run\n"; } ); 
```

或一些这样的变体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T17:42:51.793

我看到工会解决了这个问题。联合的第一个成员是包含的数据包类型。

这里的例子：[什么是联合？](https://stackoverflow.com/questions/7209096/what-is-a-union)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T17:49:26.043

一个好的解决方案是一个通用的基类 + 从该类继承的所有有效负载：

```
class PayLoadBase {
  virtual char get_ch(int i) const=0;
  virtual int num_chs() const=0;
}; 
```

然后解包看起来像这样：

```
class Unpacker {
public:
   PayLoadBase &Unpack(IMessage *msg) {
      switch(msg->PayLoadType()) {
      case A: a = *msg; return a;
      case B: b = *msg; return b;
        ...
      }
   }
private:
   PayLoadA a;
   PayLoadB b;
   PayLoadC c;
}; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-23T17:41:36.660

您可以使函数返回一个`void *`. void 指针可以转换为任何其他类型。

# c# - 从 WPF 项目更改为 WinForms 上下文后的 System.ObjectDisposedException

> ID：13533599
> 
> 赞同：2
> 
> 时间：2012-11-23T17:35:42.260
> 
> 标签：c#, wpf, winforms, objectdisposedexception, windowsformsintegration

该应用程序从一个空的 C# 项目启动，输出类型设置为“Windows App”：

```
using System.Windows.Forms;

static class Program
{
    static System.Windows.Forms.NotifyIcon notifyIcon;
    static System.Drawing.Icon LockedIcon = Properties.Resources.icon_locked;

    [STAThread]
    Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        notifyIcon = new NotifyIcon()
        {
            Icon = LockedIcon,
            ContextMenu = ContextualMenu(),
            Visible = true
        };
        Application.Run()
    }
} 
```

我`WinForms`用作基础，因为`WPF`没有系统托盘图标控件。但是，所有其他窗口都是`WPF`. 我像这样运行它们：

```
static void ShowUI()
{
    MainUI wnd = new MainUI();  //MainUI is a System.Windows.Window (WPF)
    wnd.Show();
} 
```

我有一个参考`WindowsFormsIntegration`。窗口显示`WPF`正确，一切似乎都正常。但：

```
public MainUI()
{
    this.Loaded += (o,e) => this.Icon = Properties.Resources.myIcon.ToImageSource();
    InitializeComponent();
}

public static System.Windows.Media.ImageSource ToImageSource(this System.Drawing.Icon i)
{
    System.Windows.Media.ImageSource imgsrc;
    using (System.IO.MemoryStream iconStream = new System.IO.MemoryStream())
    {
        i.Save(iconStream);
        iconStream.Seek(0, System.IO.SeekOrigin.Begin);
        imgsrc = System.Windows.Media.Imaging.BitmapFrame.Create(iconStream);
    }
    return imgsrc;
} 
```

...抛出一个`System.ObjectDisposedException`. 扩展方法`ToImageSource()`在纯`WPF`项目时运行良好，但自从我切换到`WinForms`上下文后，它就停止工作并抛出异常。

我尝试通过将单线分成几个步骤进行调试：

```
System.Drawing.Icon icon = Properties.Resources.myIcon; //works
ImageSource imgsrc = icon.ToImageSource(); //works
wnd.Icon = imgsrc; //System.ObjectDisposedException 
```

不知道发生了什么。这是不运行实际的副作用`WPF` `Application.Run()`吗？

# extjs - JavaScript 命名空间

> ID：13533600
> 
> 赞同：0
> 
> 时间：2012-11-23T17:35:44.823
> 
> 标签：extjs, extjs4

我想在我的 JavaScript 代码中实现名称空间概念，我正在使用 ExtJS，但我不知道从哪里开始，有人可以帮助我吗？该站点示例非常简短。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:04:13.913

这是一个很好的示例[如何在 JavaScript 中声明命名空间？](https://stackoverflow.com/questions/881515/javascript-namespace-declaration)

这里也是[https://developer.mozilla.org/en-US/docs/XUL/School_tutorial/JavaScript_Object_Management](https://developer.mozilla.org/en-US/docs/XUL/School_tutorial/JavaScript_Object_Management)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T02:44:29.530

实际上，在 ExtJS4 中，App 名称就是您的名称空间。例如，如果您以这种方式定义您的应用程序：

```
Ext.application({
    name: 'MyApp',
    appFolder: 'app', 
    autoCreateViewport: true,
    controllers: [
        'MyController'
        ],
    launch: function() {
        console.log('hello');

        // This is fired as soon as the page is ready
    }
});​ 
```

那么您定义的所有组件都需要使用`MyApp`. 所以一个控制器变成`MyApp.controller.MyController`了一个视图`MyApp.view.InboxGrid`

# php - 如何在字符串中的所有换行符之前插入反斜杠？

> ID：13533606
> 
> 赞同：0
> 
> 时间：2012-11-23T17:36:02.283
> 
> 标签：php

我正在 PHP 中构建需要在 Javascript 函数中使用的多行字符串，所以我`echo`将字符串取出并出现在它们应该出现的位置，但我遇到的问题是 Javascript 多行字符串必须`\`在每行的结尾。

除了对反斜杠进行硬编码（我不能这样做，因为字符串也在 Javascript 函数之外使用），我如何在字符串中的每个换行符之前添加一个反斜杠？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:40:08.853

通过`json_encode`函数运行字符串以生成 JavaScript 字符串。不要尝试编写自己的例程来使字符串对 JS 安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:38:19.930

```
str_replace("\r\n","\\\r\n",$str) 
```

# c# - 页面加载时的 Response.Redirect 不起作用

> ID：13533613
> 
> 赞同：3
> 
> 时间：2012-11-23T17:37:12.503
> 
> 标签：c#, asp.net, response.redirect, pageload

我有两个页面，一个登录页面和一个page1。用户无法直接导航到 page1，因为它包含页面加载事件的以下代码。用户被重定向到登录页面。

```
if (Session["role"] == null)
{
    Response.Write("Redirect Not Working");
    Response.Redirect("loginpage.aspx");
} 
```

当用户在 pag1 上单击注销时，他/她在设置后被重定向到登录页面`Session["role"]=null`。现在在登录页面上，如果**用户单击浏览器后退按钮**，他/她可以导航到 page1。**只有在这种情况下** `Response.Redirect("loginpage.aspx");`，页面加载事件才不起作用。**为什么它不起作用？在这种情况下，我怎样才能让它工作，或者我怎样才能阻止用户访问 page1？**

上次我一直无助和关闭，问它一个不同的方式[代码来检测任何（所有）浏览器的浏览器后退按钮点击](https://stackoverflow.com/questions/13529025/code-to-detect-browser-back-button-click-for-anyall-browser)

**编辑**响应答案：针对注销按钮的代码是

```
protected void btnLogOut_Click(object sender, EventArgs e)
{
    Session["role"] = null;
    Session.Abandon();
    Response.Redirect("login.aspx");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:47:00.947

您在后面看到的页面可能只是一个缓存版本。

最简单的方法可能是回显元刷新，而不是使用响应重定向。您还需要确保会话清晰。

```
Session.Abandon();
Response.Write("<meta http-equiv='refresh' content='0';URL='loginpage.aspx'>");
Response.End(); 
```

如果用户回击，他们将再次点击该页面并被退回到您希望他们访问的 URL。没有什么能阻止他们不止一次地快速回击或从历史下拉列表中选择 Page1 并获取缓存版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:46:45.483

这绝对应该有效，检查你的 Session["role"]，我认为它永远不会为空

在注销时执行此操作

```
Session.Abandon(); 
```

'pageoad is not working' 在这种情况下，页面执行的原因不会影响页面周期，Load 事件*总是*在页面执行时触发。

所以，如果 Page_Load 有时不运行，那是因为页面被缓存并且没有在服务器上执行。该页面可以缓存在浏览器中、沿途某处的路由器中，或者使用服务器端页面缓存在服务器上。

如果您没有为页面启用服务器端页面缓存，它会缓存在浏览器或网络中。您可以使用缓存设置来尝试消除这种情况：

```
Response.Cache.SetCacheability(HttpCacheability.NoCache); 
```

这将防止页面在正常情况下被缓存。（还要检查您的浏览器是否处于离线模式，然后它将使用缓存中的任何内容，而不管它的可缓存性设置如何。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:40:06.050

你能试试这样的吗

```
if (Session["role"] == null)
{
    Response.Write("Redirect Not Working");
    Response.Redirect("~/loginpage.aspx");
} 
```

确保在注销时重置**Session["role"] = null**因为此值将在 Web 会话期间持续存在

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T17:40:45.567

在我看来，您需要删除 Session["role"] 值并将其设置回 null。当用户注销时，我认为您没有清除会话值，因此当他们浏览回您的页面加载时，仍然认为他们具有有效的登录会话。

测试是否是这种情况的一种简单方法是在 if 块中放置一个断点，然后检查 Session["role"] == null。如果你从来没有打过那个断点，你就知道这个角色不是空的，而且他们在技术上仍然是“登录”的。

# c - 使用 fread() 读取多条记录

> ID：13533618
> 
> 赞同：0
> 
> 时间：2012-11-23T17:37:54.047
> 
> 标签：c, file-handling

以下是我将数据插入文件的代码

注意：我有一个以此命名`record`的结构

```
fwrite(&record, sizeof(record),1,fptr); 
```

我在循环中使用上面的代码，输入多条记录。现在，我的数据读取程序是这样的：

```
do {
fread(&record, sizeof(record), 1, fptr);
printf("\nName: %s \nAddress: %s \nClass Level: %d \nTelepone: %ld",record.name, record.address, record.classlevel, record.telephone);
}while (feof(fptr)); 
```

但它只显示第一条记录。

我也尝试使用`fseek()`如下：

```
do {
fread(&record, sizeof(record), 1, fptr);
printf("\nName: %s \nAddress: %s \nClass Level: %d \nTelepone: %ld",record.name, record.address, record.classlevel, record.telephone);
fseek(fptr,sizeof(record)+1, SEEK_SET);
}while (feof(fptr)); 
```

仍然没有工作！我正在尝试在 C 上做一个小项目，而这个文件处理让我很紧张。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:39:30.363

改变这个：

```
while (feof(fptr)) 
```

对此：

```
while (!feof(fptr)) 
```

# android - sqlite 没有这样的表

> ID：13533619
> 
> 赞同：2
> 
> 时间：2012-11-23T17:38:05.660
> 
> 标签：android, database, sqlite, mobile

谁能帮忙。我见过很多人有同样的问题，并查看了所有建议，但仍然无法让它发挥作用。我试图卸载应用程序并重新安装，我试图更改版本号并重新开始。我已经调试了代码，它确实进入了 onCreate 函数，但是当我进行选择查询时，它说用户表不存在。任何帮助将不胜感激。多谢你们

数据库处理程序类

```
public class DatabaseHandler extends SQLiteOpenHelper 
{   
    // Variables
    protected static final int DATABASE_VERSION = 1;            
    protected static final String DATABASE_NAME = "MyUser.db";

    // Constructor
    public DatabaseHandler(Context context) 
    { 
        super(context, DATABASE_NAME, null, DATABASE_VERSION); 
    } 

    // Creating Tables 
    @Override
    public void onCreate(SQLiteDatabase db) 
    {           
        // Create the Users table
        // NOTE: I have the column variables saved above
        String CREATE_USERS_TABLE = "CREATE TABLE IF NOT EXISTS Users("
  + KEY_PRIMARY_ID + " " + INTEGER + " " + PRIMARY_KEY + " " + AUTO_INCREMENT + " " + NOT_NULL + "," + USERS_KEY_EMAIL + " " + NVARCHAR+"(1000)" + " " + UNIQUE + " " + NOT_NULL + "," + USERS_KEY_PIN + " " + NVARCHAR+"(10)" + " " + NOT_NULL + ")"; 
  db.execSQL(CREATE_USERS_TABLE);
    }

    // Upgrading database 
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) 
    { 
      db.execSQL("DROP TABLE IF EXISTS Users"); 
        onCreate(db); 
    } 
```

用户数据源类

```
public class UserDataSource 
{
    private SQLiteDatabase db;  
    private DatabaseHandler dbHandler;

    public UserDataSource(Context context) 
    {
        dbHandler = new DatabaseHandler(context);
    }

    public void OpenWriteable() throws SQLException 
    {
        db = dbHandler.getWritableDatabase();
    }

    public void Close() 
    {
        dbHandler.close();
    }

    // Validate the user login with the username and password provided
    public void ValidateLogin(String username, String pin) throws CustomException
    {   
         Cursor cursor = db.rawQuery(   "select * from Users where " + DatabaseHandler.USERS_KEY_EMAIL + " = '" + username + "'" + " and " + DatabaseHandler.USERS_KEY_PIN + " = '" + pin + "'" , null);

         ........
    } 
```

然后在活动课上，我打电话

```
UserDataSource uds = new UserDataSource (this);
uds.OpenWriteable();
uds.ValidateLogin("name", "pin"); 
```

任何帮助都会很棒，非常感谢格雷厄姆

以下是错误报告中的附加日志

```
11-23 17:47:46.414: I/SqliteDatabaseCpp(26717): sqlite returned: error code = 1, msg = no such table: Users, db=/data/data/prometric.myitemwriter/databases/MyUser.db
11-23 17:47:57.085: D/AndroidRuntime(26717): Shutting down VM
11-23 17:47:57.085: W/dalvikvm(26717): threadid=1: thread exiting with uncaught exception (group=0x40bec1f8)
11-23 17:47:57.171: D/dalvikvm(26717): GC_CONCURRENT freed 575K, 8% free 8649K/9351K, paused 2ms+6ms
11-23 17:47:57.179: E/AndroidRuntime(26717): FATAL EXCEPTION: main
11-23 17:47:57.179: E/AndroidRuntime(26717): java.lang.IllegalStateException: Could not execute method of the activity
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.view.View$1.onClick(View.java:3091)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.view.View.performClick(View.java:3558)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.view.View$PerformClick.run(View.java:14152)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.os.Handler.handleCallback(Handler.java:605)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.os.Handler.dispatchMessage(Handler.java:92)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.os.Looper.loop(Looper.java:137)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.app.ActivityThread.main(ActivityThread.java:4514)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at java.lang.reflect.Method.invokeNative(Native Method)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at java.lang.reflect.Method.invoke(Method.java:511)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at dalvik.system.NativeStart.main(Native Method)
11-23 17:47:57.179: E/AndroidRuntime(26717): Caused by: java.lang.reflect.InvocationTargetException
11-23 17:47:57.179: E/AndroidRuntime(26717):    at java.lang.reflect.Method.invokeNative(Native Method)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at java.lang.reflect.Method.invoke(Method.java:511)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.view.View$1.onClick(View.java:3086)
11-23 17:47:57.179: E/AndroidRuntime(26717):    ... 11 more
11-23 17:47:57.179: E/AndroidRuntime(26717): Caused by: android.database.sqlite.SQLiteException: no such table: Users: , while compiling: select * from Users where email = '' and pin = ''
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:68)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteProgram.compileSql(SQLiteProgram.java:143)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteProgram.compileAndbindAllArgs(SQLiteProgram.java:361)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:127)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:94)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:53)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:47)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1685)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at android.database.sqlite.SQLiteDatabase.rawQuery(SQLiteDatabase.java:1659)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at projectname.database.UserDataSource.ValidateLogin(UserDataSource.java:73)
11-23 17:47:57.179: E/AndroidRuntime(26717):    at projectname.LoginActivity.btn_login_Click(LoginActivity.java:47)
11-23 17:47:57.179: E/AndroidRuntime(26717):    ... 14 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:47:45.150

您没有显示所有变量，但我猜该`CREATE_USERS_TABLE`语句有问题。让我们组织和简化它：

```
"CREATE TABLE IF NOT EXISTS Users(" +
    KEY_PRIMARY_ID + " INTEGER PRIMARY KEY, " + 
    USERS_KEY_EMAIL + " NVARCHAR(1000) UNIQUE NOT NULL, " + 
    USERS_KEY_PIN + " NVARCHAR(10) NOT NULL)"; 
```

`DATABASE_VERSION`您需要通过更改为来告诉数据库需要更新 SQL 模式`2`。

* * *

`selectionArgs`此外，您应该通过在查询中使用参数来保护自己免受 SQL 注入攻击：

```
public void ValidateLogin(String username, String pin) throws CustomException
{   
     Cursor cursor = db.rawQuery(   "select * from Users where " + DatabaseHandler.USERS_KEY_EMAIL + " = ? and " + DatabaseHandler.USERS_KEY_PIN + " = ?", 
             new String[] {username, pin}); 
```

* * *

最后，您应该遵守 Java 命名约定，并以小写字母开头所有方法：`openWritable()`、`close(),`validateLogin()` 等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T15:56:21.737

谢谢您的帮助。这不起作用的原因是没有提交数据库插入。如果有人感兴趣，以下是我如何解决这个问题。

```
// Create the Users table
db.beginTransaction();
try {
    Log.d(DatabaseHandler.class.getName(), "Creating table " + TABLE_USERS);
    String CREATE_USERS_TABLE = "CREATE TABLE IF NOT EXISTS " + TABLE_USERS + "("
            + KEY_PRIMARY_ID + " " + INTEGER + " " + PRIMARY_KEY + ","
            + USERS_KEY_EMAIL + " " + NVARCHAR+"(1000)" + " " + UNIQUE + " " + NOT_NULL + ","
            + USERS_KEY_PIN + " " + NVARCHAR+"(10)" + " " + NOT_NULL + ");"; 
    db.execSQL(CREATE_USERS_TABLE);
    db.setTransactionSuccessful();
}
catch (SQLException e) {
    Log.e(DatabaseHandler.class.getName(), "Error Creating table " + TABLE_USERS + " ... " + e.getMessage());
    // Do whatever you want here
}
finally {
    db.endTransaction();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:19:05.307

将您的更改 `protected static final int DATABASE_VERSION = 1;` 为 `protected static final int DATABASE_VERSION = 2;` 它将解决异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T15:18:56.617

在`UserDataSource`课堂上，您试图在关闭数据库后选择数据。那是在编写`database_close()`方法之后。因此，在关闭数据库本身之后，您正在尝试选择数据。我认为这就是问题的原因。并考虑更新`database_version`甚至在`UserDataSource`课堂上。试试这两件事。希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-24T17:01:42.053

在这种方法中：

```
public void ValidateLogin(String username, String pin) throws CustomException
{   
     Cursor cursor = db.rawQuery("select * from Users where " +
     DatabaseHandler.USERS_KEY_EMAIL + " = '" + username + "'" + " and " +
     DatabaseHandler.USERS_KEY_PIN + " = '" + pin + "'" , null);
     ........
} 
```

将代码替换为

```
 Cursor cursor = db.rawQuery("select * from Users where"
 +DatabaseHandler.USERS_KEY_EMAIL+"='"+username+"'"+"and"+ 
 DatabaseHandler.USERS_KEY_PIN +"='"+pin+"'", null); 
```

我认为额外的空间很重要。请尝试一下。我希望它有效。如果您有解决方案，请告诉我。

# scala - scala Stream中的#::运算符是什么？

> ID：13533621
> 
> 赞同：6
> 
> 时间：2012-11-23T17:38:20.493
> 
> 标签：scala

> **可能重复：**
> [在 Scala 文档中搜索 #::](https://stackoverflow.com/questions/4553909/searching-the-scala-documentation-for)

我正在浏览[Stream的文档](http://www.scala-lang.org/api/current/scala/collection/immutable/Stream.html)

过滤器方法有这样的代码：

```
def naturalsFrom(i: Int): Stream[Int] = i #:: naturalsFrom(i + 1)
naturalsFrom(1)  10 } filter { _ % 5 == 0 } take 10 mkString(", ") 
```

#:: 运算符是什么？这是否映射到某处的函数调用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-23T19:19:37.100

正如 SHildebrandt 所说，#:: 是 Streams 的 cons 运算符。

换句话说，#:: 是流式传输， :: 是列表

```
val x = Stream(1,2,3,4)                   //> x  : scala.collection.immutable.Stream[Int] = Stream(1, ?)
10#::x                                    //> res0: scala.collection.immutable.Stream[Int] = Stream(10, ?)

val y = List(1,2,3,4)                     //> y  : List[Int] = List(1, 2, 3, 4)
10::y                                     //> res1: List[Int] = List(10, 1, 2, 3, 4) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-23T17:42:37.293

```
x #:: xs 
```

返回

```
Stream.cons(x, xs) 
```

它返回一个元素 x 的 Stream，后跟一个 Stream xs。

# java - 使用休眠和弹簧将字符串集合从持久对象加载到模型中

> ID：13533623
> 
> 赞同：1
> 
> 时间：2012-11-23T17:38:28.747
> 
> 标签：java, spring, hibernate, spring-mvc

当尝试放置从我通过休眠从数据库加载的对象中获取的字符串列表时，我遇到了这个异常。

```
org.hibernate.LazyInitializationException: could not initialize proxy - no Session 
```

我用来加载列表的方法是在事务中。但是当我尝试将列表放入模型中时，我得到了上述异常。我从中得到了休眠要求我在事务中也有这行代码。但是鉴于它不是数据库操作，为什么会这样呢？

```
@RequestMapping(value="{id}", method=RequestMethod.POST)
public String addComment(@PathVariable String id, Model model, String comment) {
    personService.addComment(Long.parseLong(id), comment);
    Person person = personService.getPersonById(Long.parseLong(id));
    model.addAttribute(person);
    List<String> comments = personService.getComments(id);
    model.addAttribute(comments);
    return "/Review";
} 
```

服务对象。

```
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

public class PersonServiceImpl implements PersonService {

private Workaround personDAO;

public PersonServiceImpl() {
}

@Transactional(propagation=Propagation.REQUIRED, readOnly=false)
public void savePerson(Person person) { 
    personDAO.savePerson(person);
}

@Transactional(propagation=Propagation.REQUIRED, readOnly=false)
public Person getPersonById(long id) {
    return personDAO.getPersonById(id);
}

@Autowired
public void setPersonDAO(Workaround personDAO) {
    this.personDAO = personDAO;
}

@Transactional(propagation=Propagation.REQUIRED, readOnly=false)
public List<Person> getAllPeople() {
    return personDAO.getAllPeople();
}

@Transactional(propagation=Propagation.REQUIRED, readOnly=false)
public void addComment(Long id, String comment) {
    Person person = getPersonById(id);
    person.addComment(comment);
    savePerson(person);
}

@Transactional(propagation=Propagation.REQUIRED, readOnly=false)
public List<String> getComments(String id) {
    return personDAO.getComments(Long.parseLong(id));
} 
```

}

道

```
import java.util.List;

import javax.persistence.ElementCollection;

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

@Repository
public class PersonDAO implements Workaround {
private SessionFactory sessionFactory;

@Autowired
public PersonDAO(SessionFactory sessionFactory) {
    this.sessionFactory = sessionFactory;   
}

private Session currentSession() {
    return sessionFactory.getCurrentSession();
}

public void addPerson(Person person) {
    currentSession().save(person);
}

public Person getPersonById(long id) {
    return (Person) currentSession().get(Person.class, id);
}

public void savePerson(Person person) {
    currentSession().save(person);
}

public List<Person> getAllPeople() {
    List<Person> people = currentSession().createQuery("from Person").list();
    return people;

}

public List<String> getComments(long id) {
    return getPersonById(id).getComments();
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:43:22.383

我对 Hibernate 比较陌生，但我会根据我对它的理解来猜测一下。

默认情况下`@OneToMany`，集合是延迟加载的。因此，当您加载 Person 对象时，将创建一个代理来代替您的实际`comments`列表。在您按原样调用该列表的吸气剂（即）之前，不会加载该列表`getComments()`，即使那样我也不认为会立即加载完整列表，更是如此（是的，多个数据库调用）如果您调用 .size()，您将遍历列表或整个列表。

但是，我认为这里的问题是您必须在加载父 ( `Person`) 对象的同一会话中加载列表。当您加载`Person`对象时，您有对当前会话的引用，然后一旦您调用该`getComments()`Person 对象，会话就会关闭。

我认为要将整个过程保持在一个会话中，您可以像在 DAO 类中那样手动打开和关闭会话。

```
public List<String> getComments(long id) {
    Session session = sessionFactory.openSession();

    List<String> comments = getPersonById(id).getComments();

    sessionFactory.getCurrentSession().flush();
    sessionFactory.getCurrentSession.close();

    return comments;
} 
```

将 FetchType 设置为 EAGER 可以解决问题，但根据我的阅读，通常不建议这样做，除非您总是需要使用 Person 对象加载评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:52:53.920

将获取类型更改为`FetchType.EAGER`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:56:32.873

我认为问题在于您正在使用

```
currentSession() 
```

尝试将其替换为

```
private Session currentSession() {
    return sessionFactory.openSession();
} 
```

因为异常表明没有任何打开的会话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T17:58:53.007

您应该查看`Person`类映射，也许该`Comments`字段与`LAZY`属性映射，因此它没有加载到 DAO 中。当您调用该`getComments`方法时，Hibernate 尝试从数据库加载属性，但当时没有会话，因此出现异常。要解决此问题，请将映射属性更改为`EAGER`.

# ios - 可变大小的 UITableViewCells

> ID：13533627
> 
> 赞同：0
> 
> 时间：2012-11-23T17:38:33.680
> 
> 标签：ios, uitableview

我有一个奇怪的问题。我已经为表格单元格设置了自定义高度的 UITableView 设置。当内容在单元格的背景中加载时，问题就出现了。我需要尽快加载单元格，但是每个单元格都有一个大图像，可能需要一些时间来加载（从网络或闪存），因此在首次加载单元格时在后台开始加载。这意味着单元格的高度最初是错误的，并且需要稍后以最小的故障进行更新。我遇到的问题是它并不总是想要更新表格或图像，并且可能会导致过度滚动。

它也非常慢。我需要做一些优化以使其速度降低一点（制作主图像的较小副本，并临时缓存单元格的高度）。

我已经尝试了各种各样的事情。我确保表被告知在主线程中更新，我尝试了一组 beginUpdates/endUpdates、reloadRows/reloadSections（表处于分组模式，每节一行）。图像完成加载后，我还没有让表格正确更新。

如果有人对如何使其尽可能顺利地工作有所了解，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:45:53.673

去的地方是你的`heightForRowAtIndex:`方法。它需要知道图像是否存在并相应地返回一个值。每次每行完成加载它的图像时，你应该像这样调用 reloadRows~ 方法：

```
NSArray *indexPaths = [NSArray arrayWithObject:[NSIndexPath indexPathForRow:x inSection:y]];
[self.tableView reloadRowsAtIndexPaths:indexPaths withRowAnimation:UITableViewRowAnimationFade]; 
```

我不完全确定这是否会导致您的 tableView 出现大量滚动，但这是一个选项。

另一种选择是分块更新。假设每 5-10 个加载的图像（取决于你有多少）使用相同的方法重新加载它们各自的行。

# json - Jackson JSON Marshall 忽略 getter

> ID：13533629
> 
> 赞同：55
> 
> 时间：2012-11-23T17:38:47.357
> 
> 标签：json, jackson

我使用 Jackson 将 POJO 转换为 JSON 以存储在数据库中。但是我有一个我想忽略的吸气剂。我看到了很多与@JsonIgnoreProperties 相关的信息，但我似乎无法取得任何进展。我基本上想要@Transient 的等价物。

基本用例（我想忽略 InternationalNumber）：

```
public class PhoneNumber {

private String country;
private String number;

public PhoneNumber() {}

public String getCountry() {
    return country;
}

public String getLocalNumber() {
    return localNumber;
}

public String getInternationalNumber() {
    String result = "Not Available";
    if (country != null && localNumber != null) {
    result = new PhoneNumberHandler().internationalFormat(
            localNumber, WorldCountries.countryToIso2Code(country));
    }
    return result;
}

} 
```

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-11-24T04:06:40.820

那将是[`@JsonIgnore`](https://fasterxml.github.io/jackson-annotations/javadoc/2.5/com/fasterxml/jackson/annotation/JsonIgnore.html)getter方法。

# sql - SQL 合并列

> ID：13533631
> 
> 赞同：2
> 
> 时间：2012-11-23T17:39:10.520
> 
> 标签：sql, sql-server

我有一个问题，我的 SQL 查询不会删除空值。

我尝试了无数种不同的技术，但我是新手。

我想要的结果是订单号，后跟状态在一行中出现的日期。

```
select mo.order_id OrderID,
case when osr.order_status_cd = 120 and osr.create_date is not null then    osr.create_date end as POCreated,
case when osr.order_status_cd = 220 and osr.create_date is not null then osr.create_date end as Ordered,
case when osr.order_status_cd = 300 and osr.create_date is not null then osr.create_date end as Shipped,
case when osr.order_status_cd = 400 and osr.create_date is not null then osr.create_date end as Received,
case when osr.order_status_cd = 500 and osr.create_date is not null then    osr.create_date end as Completed,
from order_status_record osr
inner join msorder mo on mo.order_id = osr.msorder_id 
```

而不是得到如下所示的结果：

```
OrderID POCreated   Ordered     Shipped      Received    Completed
497822  11/18/2012  NULL          NULL        NULL        NULL
497822  NULL       11/19/2012     NULL        NULL        NULL
497822  NULL        NULL       11/19/2012     NULL        NULL
497822  NULL        NULL          NULL     11/19/2012     NULL
497822  NULL        NULL          NULL        NULL     11/19/2012 
```

我要这个：

```
OrderID POCreated   Ordered     Shipped      Received    Completed
497822  11/18/2012  11/19/2012  11/19/2012   11/19/2012  11/19/2012 
```

我需要创建一个虚拟表吗？我需要一个 if 函数吗？为什么 Nulls 仍然存在？

任何帮助将非常感激。

谢谢，

安德鲁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:41:17.957

如果您向每个`CASE`语句添加聚合函数，然后`GROUP BY`记录将合并为一行：

```
select mo.order_id OrderID,
  max(case when osr.order_status_cd = 120 and osr.create_date is not null then osr.create_date end) as POCreated,
  max(case when osr.order_status_cd = 220 and osr.create_date is not null then osr.create_date end) as Ordered,
  max(case when osr.order_status_cd = 300 and osr.create_date is not null then osr.create_date end) as Shipped,
  max(case when osr.order_status_cd = 400 and osr.create_date is not null then osr.create_date end) as Received,
  max(case when osr.order_status_cd = 500 and osr.create_date is not null then osr.create_date end) as Completed,
from order_status_record osr
inner join msorder mo 
  on mo.order_id = osr.msorder_id
group by mo.order_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:41:57.063

用于`GROUP BY`将订单 ID 分组为一行，并`MAX`在 case 语句中获取正确的行：

```
select mo.order_id OrderID,
    MAX(case when osr.order_status_cd = 120 and osr.create_date is not null then    osr.create_date end) as POCreated,
    MAX(case when osr.order_status_cd = 220 and osr.create_date is not null then osr.create_date end) as Ordered,
    MAX(case when osr.order_status_cd = 300 and osr.create_date is not null then osr.create_date end) as Shipped,
    MAX(case when osr.order_status_cd = 400 and osr.create_date is not null then osr.create_date end) as Received,
    MAX(case when osr.order_status_cd = 500 and osr.create_date is not null then    osr.create_date end) as Completed,
from order_status_record osr
inner join msorder mo on mo.order_id = osr.msorder_id
GROUP BY order_id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T18:35:48.187

假设在表中，这是一个没有的解决`(msorder_id, order_status_cd)`方案：`UNIQUE``order_status_record``GROUP BY`

```
SELECT 
    mo.order_id         AS OrderID,
    osr120.create_date  AS POCreated,
    osr220.create_date  AS Ordered,
    osr300.create_date  AS Shipped,
    osr400.create_date  AS Received,
    osr500.create_date  AS Completed
FROM 
    msorder AS mo 
  LEFT JOIN 
    order_status_record AS osr120 
      ON  osr120.msorder_id = mo.order_id 
      AND osr120.order_status_cd = 120 
  LEFT JOIN 
    order_status_record AS osr220 
      ON  osr220.msorder_id = mo.order_id 
      AND osr220.order_status_cd = 220 
  LEFT JOIN 
    order_status_record AS osr300 
      ON  osr300.msorder_id = mo.order_id 
      AND osr300.order_status_cd = 300 
  LEFT JOIN 
    order_status_record AS osr400 
      ON  osr400.msorder_id = mo.order_id 
      AND osr400.order_status_cd = 400 
  LEFT JOIN 
    order_status_record AS osr500 
      ON  osr500.msorder_id = mo.order_id 
      AND osr500.order_status_cd = 500 ; 
```

# c# - HTML4.0 SSRS 报告在与 System.Net.Mail 一起发送时在 Outlook 中被压缩。它可以修复吗？

> ID：13533634
> 
> 赞同：3
> 
> 时间：2012-11-23T17:39:21.603
> 
> 标签：c#, html, outlook, ssrs-2008, system.net.mail

我正在使用 SSRS Web 服务生成 HTML4.0 格式的报告，然后尝试使用 System.Net.Mail 发送它们（我知道 SSRS 已内置报告计划，但我们需要处理所有计划的进程在一个中心位置）。所以，我正在生成 html 文件，然后尝试构建邮件消息，如下所示：

```
using (var sw = new StreamReader(htmlFile))
{
    mail_body = sw.ReadToEnd();
}

var mail = new MailMessage
                {
                    From = new MailAddress(mail_from),
                    Subject = mail_subject,
                    IsBodyHtml = true,
                    Body = mail_body
                }; 
```

唯一的问题是，当我这样做时，虽然 html 文件在浏览器中打开时看起来很好，但在 Outlook 中它最终会被水平挤压。

例如，这就是我的 html 文件在 IE 中的样子：

![在此处输入图像描述](../Images/2ef8bae5208af3c8043dfa201d4a1cbc.png)

但是当我使用上述方法发送电子邮件后，在 Outlook 中它最终看起来像这样：

![在此处输入图像描述](../Images/0a6ea6b57d0a1d7708116d4e2b4638dc.png)

似乎施加了某种线宽限制，但我不确定这发生在什么级别。

有没有人对可能导致这种情况的原因有任何见解？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T07:02:16.667

我们遇到了类似的问题，经过很多变通方法后，我们终于在 SSRS 配置中找到了一个可以解决问题的参数：**OutlookCompat**。启用此功能后，HTML4.0 电子邮件在 Outlook 中看起来不再被挤压。

有关详细信息，请参阅[MSDN 文档。](http://msdn.microsoft.com/en-us/library/ms155395%28v=sql.105%29.aspx)您可以在 SSRS 配置文件（适用于所有报告和调用者）中设置此值，也可以在调用 ASMX 时直接设置此值。

SSRS 配置示例：

```
<Extension Name="HTML4.0" Type="...">
    <Configuration>
       <DeviceInfo>
          <OutlookCompat>True</OutlookCompat>
       </DeviceInfo>
    </Configuration>
</Extension> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T10:11:18.447

我找到了一个原因加上解决方案/解决方法，我希望其他人可以利用它。

我将 MHT 文件中的 base64 编码 HTML 与直接生成的 HTML4.0 标记进行了比较，发现了一个独特的重复出现的差异。HTML4.0 报告中的每个表格单元格类的定义如下：

```
.a23c
{
    padding-left: 2pt;
    padding-top: 2pt;
    padding-right: 2pt;
    padding-bottom: 2pt;
    border: 1pt solid Black;
    background-color: #d3d3d3;
    vertical-align: top;
    text-align: center;
    direction: ltr;
    layout-flow: horizontal;
    writing-mode: lr-tb;
} 
```

但是，当我查看 MHT 文件中解码的 html 时，其中的类有两个额外的属性 - 宽度和最小宽度，例如

```
.a23c
{
    padding-left: 2pt;
    padding-top: 2pt;
    padding-right: 2pt;
    padding-bottom: 2pt;
    border: 1pt solid Black;
    background-color: #d3d3d3;
    vertical-align: top;
    text-align: center;
    direction: ltr;
    layout-flow: horizontal;
    writing-mode: lr-tb;
    min-width: 28.05mm;
    width: 28.05mm;
} 
```

似乎未设置这些属性会导致 Outlook 将表格单元格向下挤压（可能是因为其 HTML 解析器将 100% 宽度定义为大约 80 列限制？）。

因此，知道了这一点，解决方法似乎很清楚：读入生成的 MHT 文件，在其中解码 base64 编码的 HTML 并将其作为邮件正文发送。这实际上似乎有效，并且代码最少：

```
var decoded_text = new StringBuilder();
using (var reader = new StreamReader(mhtFile))
{
    while (!reader.EndOfStream)
    {
        var line = reader.ReadLine();
        if (line != "Content-Transfer-Encoding: base64") continue;

        reader.ReadLine(); //chew up the blank line
        while ((line = reader.ReadLine()) != String.Empty)
            if (line != null)
                decoded_text.Append(Encoding.UTF8.GetString(Convert.FromBase64String(line)));
        break;
    }
} 
```

我并不完全相信这段代码的健壮性，但目前它似乎工作得很好，所以我将接受这个作为答案。如果任何知识渊博的人最终阅读本文，将很高兴了解更好的解决方案！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-18T11:42:50.360

我遇到了同样的问题，但接受的答案不适用于 Outlook 2013。ExpandContent 属性帮助我解决了宽度问题。

这是我的设备信息配置：

```
 const string devInfo = @"<DeviceInfo>" +
                                "<HTMLFragment>True</HTMLFragment> " +
                                "<OutlookCompat>True</OutlookCompat>" +
                                "<Toolbar>False</Toolbar>" +
                                "<ExpandContent>True</ExpandContent>" +
                               "</DeviceInfo>"; 
```

之后，报告通过 SOAP API 呈现，并提供了 devInfo：

```
reportBytes = reportService.Render(renderFormat, devInfo, out extension, out encoding, out mimeType, out warnings, out streamIDs); 
```

希望这可以帮助。

斯文

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-10T09:44:08.017

首先打开以下文件：

```
C:\Program Files\Microsoft SQL Server\MSRS12.MSSQLSERVER\Reporting Services\ReportServer 
```

而不是尝试找到以下扩展名：

```
<Extension Name="HTML4.0" 
```

现在确保您的扩展元素具有以下子元素：

```
 <Configuration>
       <DeviceInfo>
          <OutlookCompat>True</OutlookCompat>
       </DeviceInfo>
    </Configuration> 
```

现在你的报告在前景中会更好。

# css - 如何从左到右放置 DIV 并仅从第一项中获取宽度？

> ID：13533639
> 
> 赞同：0
> 
> 时间：2012-11-23T17:39:53.473
> 
> 标签：css, html, menu

我想通过以下方式为菜单设置 DIV 样式：

![在此处输入图像描述](../Images/97a5ccf57d16c473277b3b797797e1c1.png)

其中红色是菜单栏，青色是下拉菜单，绿色是菜单的头部。菜单头可以比其他菜单项短，因此在布局菜单时只应考虑菜单头。

这有可能实现吗？

我的测试在这里：http: [//jsfiddle.net/suzancioc/W2W45/2/](http://jsfiddle.net/suzancioc/W2W45/2/)

```
<div class='menubar'>
<div class='menu'>
   <div class='menuhead'>menu 1</div>
   <div class='menubody'>
       long item name 1.1</br>
       long item name 1.2</br>
       long item name 1.3</br>          
   </div>
</div>
<div class='menu'>
   <div class='menuhead'>menu 2</div>
   <div class='menubody'>
       long item name 2.1</br>
       long item name 2.2</br>
       long item name 2.3</br>          
   </div>
</div>
</div> 
```

和 CSS

```
.menubar {
   /*some fancy css*/
   height:20px;
   background:red;
}
.menu {
   float:left;
   margin:1px;
   background: cyan;
}
.menuhead {
    background: green;
} 
```

如您所见，菜单宽度似乎是根据所有行长度计算的，而不仅仅是头部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:01:51.827

如果我正确理解您的意图，您需要通过添加`.menubody{position:absolute;}`规则来使用绝对定位。我已经分叉了你的 jsfiddle 并应用了它，悬停 `.menuhead`s 来查看`.menubody`s。网址在这里：http: [//jsfiddle.net/goktugkayaalp/3usYQ/](http://jsfiddle.net/goktugkayaalp/3usYQ/)

# mysql - 编写一个查询，显示所有累计罚款超过 1000 的汽车的累计罚款总额

> ID：13533647
> 
> 赞同：0
> 
> 时间：2012-11-23T17:40:45.550
> 
> 标签：mysql

我不知道如何用 SQL 编写查询。

这是我的桌子，

```
CREATE TABLE offences (
oOffenceID VARCHAR (30),
oDescription VARCHAR (200),
oMaximumFine INT (10),
CONSTRAINT o_pk
PRIMARY KEY (oOffenceID)
);

CREATE TABLE drivers (
dPersonID VARCHAR (30),
dLicenseNumber INT (20),
dLicenseRemoved ENUM('yes','no'),
dExpiryDate DATE,
CONSTRAINT d_pk
PRIMARY KEY (dLicenseNumber),
CONSTRAINT d_fk
FOREIGN KEY (dPersonId)
REFERENCES People (pPersonID)
);

CREATE TABLE people (
pPersonID VARCHAR (30),
pName VARCHAR (30),
pAddress VARCHAR (50),
pNIN VARCHAR (30),
CONSTRAINT p_pk
PRIMARY KEY (pPersonID)
);

CREATE TABLE vehicle (
vOwnerID VARCHAR (30),
vColour VARCHAR (30),
vModel VARCHAR (30),
vMake VARCHAR (30),
vVehicleID VARCHAR (30),
CONSTRAINT v_pk
PRIMARY KEY (vVehicleID),
CONSTRAINT v_fk
FOREIGN KEY (vOwnerID)
REFERENCES People (pPersonID)
);

CREATE TABLE fines (
fFineID INT (30) AUTO_INCREMENT,
fVehicleID VARCHAR (30),
fPersonID VARCHAR (30),
fTime DATE,
fAmount INT (10),
fOfficerStatement VARCHAR (500),
fOffenceID VARCHAR (30),
CONSTRAINT f_pk
PRIMARY KEY (fFineID),
CONSTRAINT f_fk
FOREIGN KEY (fVehicleID)
REFERENCES vehicle (vVehicleID),
CONSTRAINT f_fk1
FOREIGN KEY (fPersonID)
REFERENCES people (pPersonID),
CONSTRAINT f_fk2
FOREIGN KEY (fOffenceID)
REFERENCES offences (oOffenceID)
); 
```

我需要一个查询，显示汽车的 VehicleID、车主的姓名以及累计罚款超过 1000 的所有汽车的累计罚款总额。谁能看到怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:55:59.873

希望这将使您朝着正确的方向前进：

```
select fVehicleId,p.pName,sum(fi.totalFines) as totalFinesOver1000ForPerson
from 
(select fVehicleId,sum(fAmount) as totalFines
from fines f
group by fVehicleId
having sum(fAmount) > 1000) fi
inner join vehicle v on v.vVehicleID = fi.fVehicleId
inner join people p on v.vOwnerId = p.pPersonId
group by fVehicleId,p.pName; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:01:57.937

```
Select a.vVehicleID,
       b.pName,
       sum(d.fAmount) fine 
from vehicle a,people b,fines d,drivers e 
where a.vVehicleID=d.vVehicleID and d.fPersonID=e.dPersonID and d.fPersonID=a.vOwnerID and
      b.pPersonID = e.dPersonID 
group by a.vVehicleID,b.pNamem
having fine > 1000; 
```

这应该工作

# drupal-7 - 如何升级drupal 7 有机组版

> ID：13533649
> 
> 赞同：0
> 
> 时间：2012-11-23T17:40:56.890
> 
> 标签：drupal-7

我正在使用 drupal 7 并运行 Organic Groups 7.x-1.4，并希望将 Organic Groups 版本升级到 7.x-2.0。任何人都可以帮助。我已经采取了数据库备份

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:02:34.593

*   首先，备份您的数据库和当前的 og 模块文件夹；
*   将您的网站置于维护模式；
*   为避免并发症，请禁用其他有机组模块，如组注册、组 UI 等...；
*   安装og版本2所需的模块依赖——message、message_notify、entityreference、entityreference_prepopulate、migrate；
*   复制 og 2 文件夹的内容并粘贴到 og 安装的模块文件夹中，覆盖文件；
*   运行drupal更新；
*   按照更新说明进行操作，如果没有错误，请访问“内容/迁移”并执行它以完成该过程。
*   最后，检查您的内容是否正常 :)

# ruby-on-rails - 使用 URI.parse 验证 URL

> ID：13533650
> 
> 赞同：1
> 
> 时间：2012-11-23T17:41:08.493
> 
> 标签：ruby-on-rails, validation, url

我想使用 验证 Rails`URI.Parse`中的 URL，只要`URI.parse`不引发URL 就有效`URI::InvalidURIError`。这是一个好主意吗？哪些 URL 将通过此验证测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T18:30:48.487

是的，如果您打算在您的应用程序中使用这些 URL，这是一个好主意。

URI 将证明字符串可解析为以下部分：方案、用户信息、主机、端口、注册表、路径、不透明、查询、片段。

URI 处理这些方案：

*   FTP、HTTP、HTTPS、LDAP、LDAPS 或 MailTo
*   或 URI::Generic

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI/Parser.html#method-i-parse](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI/Parser.html#method-i-parse)

如果您有其他方案，您可以在解析后自行处理。

URI.parse 通过调用 URI.split 来工作，它使用两个正则表达式：

*   URI::ABS_URI 用于绝对 URI
*   URI::REL_URI 用于相对 URI

您可以查看这些以了解它们如何匹配。如果你愿意，你也可以改变它们。

# jquery - 带有 ResponsiveSlides.js 的 Anystretch.js 无法在 IE 中正确调整图像大小

> ID：13533652
> 
> 赞同：1
> 
> 时间：2012-11-23T17:41:16.910
> 
> 标签：jquery, internet-explorer, slideshow, fullscreen

使用[anystretch.js](http://goo.gl/qFCtH)在 div 中实现全屏图像以及[responsiveslides.js](http://goo.gl/nZ5h4)以将图像呈现为幻灯片。一切都像在 Firefox、Chrome 和 Safari 上宣传的那样工作。

示例： [http ://danausllc.com/test/](http://danausllc.com/test/)

但是，在 IE9 和更早版本上，当前进到下一张幻灯片时，IE 会将图像缩小到实际大小，而不是使图像保持全屏覆盖。

由于我缺乏js知识，我不确定如何解决。请帮忙！

我已经考虑过使用 backstretch.js，但我需要其他选项。我还研究了其他全屏幻灯片插件替代品，但其中大多数对我的目的来说都是矫枉过正的。

# javascript - Backbone 牵线木偶布局中的僵尸视图和事件……我有吗？

> ID：13533654
> 
> 赞同：0
> 
> 时间：2012-11-23T17:41:28.013
> 
> 标签：javascript, backbone.js, marionette

我想我的 Backbone Marionette 应用程序中的僵尸视图可能存在问题。

1.  如何检查未关闭的视图和内存泄漏？我正在使用适用于 Firefox 的Illuminations-for-developers.com 插件，当我在我的应用程序中移动时，我看到“小部件”照明选项卡中堆积了1000 多个视图——当我检查它们的HTML 时，大多数是不在 DOM 中。这些是僵尸视图吗？
2.  添加了我在下面使用的代码，以获取人们对我是否以正确的方式解决问题的意见。

我正在尝试构建一个类似于 Facebook 多朋友选择器对话框的 UI（见图）。

我有一个包含两个集合视图的布局，一个填充了用户列表，一个空的则添加了选定的用户。

我想在我的应用程序的多个区域中使用此布局。所以我构建了一个控制器对象来处理初始化它并加载集合的数据，然后我初始化它并在需要时将它显示在另一个区域中。

希望得到有关如何解决此问题的提示，谢谢。

代码：

MyApp.UserFilterController

```
MyApp.UserFilterController = (function(){
var UserFilterController = {};
var selectedUsersCol;
var userFilterColView;
var selectedUsersColView;
var usersCol;

UserFilterController.initialize = function ( callback, excludeUsers ) {
    // make a query...
    // exclude the users...
    var usersQ = new Parse.Query(Parse.User);
    // just users with email addresses
    usersQ.exists('email');
    usersQ.exists('name');
    usersQ.limit(1000);
    usersQ.ascending('name');
    usersQ.notContainedIn('objectId',excludeUsers);
    usersCol = usersQ.collection();
    // tell it where to render... append to the body give it an element?

    userFilterColView = new MyApp.UserFilterUserCollectionView({
        collection:usersCol
    });

    usersCol.fetch({
        success:function (col) {
            console.log("users collection fetched", col.length);
        },
        error:function () {
            console.log("error fetching users collection");
        }
    });

    $('#subpage-header').text("Users Selection");

    // empty collection to hold the selected users
    selectedUsersCol = new MyApp.Users();
    // view to show the selected users
    selectedUsersColView = new MyApp.SelectedUserCollectionView({
        collection:selectedUsersCol
    });
    _.extend(selectedUsersCol, newBackboneAddMethod());

    MyApp.userFilterLayout = new MyApp.UserFilterLayout();

    MyApp.slideUp.content.show(MyApp.userFilterLayout);

    MyApp.userFilterLayout.selectedusers.show(selectedUsersColView);
    MyApp.userFilterLayout.allusers.show(userFilterColView);

    //When user clicks on user in all users then its added to selected users
    userFilterColView.on("itemview:clicked", function(childView, model){
        console.log(model);
        selectedUsersCol.add(model);
    });

    userFilterColView.on("collection:rendered", function(childView, model){
        console.log('its rendered');
    });

    //When user clicks on selected user then it is removed from the collection
    selectedUsersColView.on("itemview:clicked", function(childView, model){
        console.log(model);
        console.log(model.id);
        selectedUsersCol.remove(model);
    });

    MyApp.App.vent.bind("slideUp:send",function(){
        console.log("send button has been clicked. attempting call back")
        callback(selectedUsersCol);
    });

    //unbinds the trigger above when view is being closed
    userFilterColView.on('collection:before:close', function (){
        MyApp.App.vent.unbind("slideUp:send");
        console.log('colView before:close')
    });
};

UserFilterController.removeUser = function ( user ) {
    //console.log("you asked to remove", usersArray.length, 'users');
    selectedUsersCol.remove(user);
    usersCol.remove(user);
};
UserFilterController.generateListview = function ( user ) {
    userFilterColView.$el.listview();
};
UserFilterController.resetSelected = function (user) {
    selectedUsersCol.reset();
};
UserFilterController.cleanup = function () {
    console.log("its closing");
    //selectedUsersColView.unbindAll();
    //        selectedUsersColView.close();
    userFilterColView.close();
   // userFilterLayout.unbindAll();
    //        MyApp.userFilterLayout.close();
    //        MyApp.slideUp.content.close();
   // MyApp.slideUp.close();
};

return UserFilterController;
}()); 
```

MyApp.EventDisplayLayout

```
MyApp.EventDisplayLayout = Backbone.Marionette.Layout.extend({
    template: '#event-display-layout',
    id: "EventDisplayLayout",

    events: {
        'click #invite':  'showUserFilter'        
    },

    // User clicked on 'invite' button
    showUserFilter: function () {        
        $.mobile.changePage($('#subpage'), {changeHash: false,transition: 'slideup'});
        MyApp.UserFilterController.generateListview();
    }
} 
```

MyApp.showEventDisplay

```
MyApp.showEventDisplay = function (event) {
var eventDisplayLayout = new MyApp.EventDisplayLayout({});
MyApp.App.mainRegion.show(eventDisplayLayout);    

var Invitees = event.get("invitees");
var excludeIds = [];
_.each(Invitees,function(invitee){
    excludeIds.push(invitee.id);
});
MyApp.UserFilterController.initialize(function (selectUsersCol){
    console.log("In call back: ",selectUsersCol);
},excludeIds);
}; 
```

MyApp.SlideUpPageLayout

```
// The generic layout used for modal panel sliding up from bottom of page.
MyApp.SlideUpPageLayout = Backbone.Marionette.Layout.extend({
    el: '#subpage',
    //template: '#homepage-temp',
    regions: {
        header: '.header',
        content: '.content'
    },
    events:{
        'click .send':'slideUpSend',
        'click .cancel':'slideUpCancel'
    },
    onShow: function () {
        console.log("SlideUpPage onShow");
        this.$el.trigger('create');
    },
    initialize: function () {
        // make user collection...

    },
    slideUpSend: function () {
        console.log("send button has been pressed");
        MyApp.App.vent.trigger('slideUp:send');
        $.mobile.changePage($('.type-home'),{transition: 'slideup',reverse:true});
    },
    slideUpCancel: function () {
   //     MyApp.App.vent.trigger('slideUp:cancel');
        $.mobile.changePage($('.type-home'),{transition: 'slideup',reverse:true});
    }
}); 
```

MyApp.UserFilterLayout

```
// The layout used for the user filter panel sliding up from bottom of page.
MyApp.UserFilterLayout = Backbone.Marionette.Layout.extend({
    template: '#userfilterlayout',
    //template: '#homepage-temp',
    regions: {
        selectedusers: '.selectedusers',
        allusers: '.allusers'
    },

    onShow: function () {
        console.log("userfilterlayout onShow");
        this.$el.trigger('create');
    }
}); 
```

![Facebook 多好友选择器 UI](../Images/dc81caf1473c3ad9b7bc86ee3202e9eb.png)

# c++ - 如何在 C/C++ 中收听 stderr 以发送到回调？

> ID：13533655
> 
> 赞同：6
> 
> 时间：2012-11-23T17:41:31.770
> 
> 标签：c++, cross-platform, stdout, stderr

如何被动收听 stderr 并将其作为字符串获取以发送到回调？我看过有关阅读 stderr 的帖子，但我想听它而不是积极阅读它。

背景：我有一个使用 3rd 方库 (libcurl) 的跨平台作品，它将详细信息输出到 stderr。这个跨平台部分将被超过 1 个非跨平台应用程序使用。

我想记录这些信息，我可以通过向 libcurl 提供 FILE* 来做到这一点。但我不想这样做，而是想看看我是否可以将 stderr 中的输出捕获（被动监听）**为 string**，并通过回调发送回调用主应用程序。这样做的好处是 1\. 主应用程序可以使用它想要的任何日志工具来保留单个日志。2\. 它将保持这件作品跨平台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T05:45:09.590

在单个进程中执行此操作有点棘手，但您可能可以做到。

*   1：使用 freopen() 你可以将你的标准错误重定向到一个命名文件。您可以同时打开该文件以在另一个句柄上读取。您可能还需要在 stderr 上调用 setvbuf() 以关闭输出到 stderr 的缓冲，以便您能够立即从第二个句柄读取它。由于它正在被写入文件，因此您可以在任何时候阅读它——在方便的时候。如果您想在文件更改时收到通知，则需要使用 unix 函数“选择”。（另见 fileno()）。

*   2：更棘手的是将 stderr 设置为管道的写入端。使用 dup3() 应该是可行的，尽管这不完全是跨平台的（对于非 unixy 操作系统）。它还需要第二个线程从管道中读取，以防止写入器在写入量很大时被阻塞。

像：

```
FILE *stream = freopen("stderr.out", "w", stderr); // Added missing pointer
setvbuf(stream, 0, _IONBF, 0); // No Buffering
FILE *input = fopen("stderr.out", "r");
fprintf(stderr, "Output to stderr dude\n");
//fflush(stderr); // You can explicitly flush instead of setting no buffering.
char buffer[1024];
while (fgets(buffer, 512, input))
{
    printf(">>>%s\n", buffer);
} 
```

# optimization - Sqlite 子选择比 distinct + order by 快得多

> ID：13533658
> 
> 赞同：10
> 
> 时间：2012-11-23T17:41:50.403
> 
> 标签：optimization, sqlite

我对以下两个产生相同输出的查询的完全不同的运行时间感到困惑。这些查询在 Sqlite 3.7.9 上运行，在一个大约有 450 万行的表上运行，每个产生约 50 行结果。

以下是查询：

```
% echo "SELECT DISTINCT acolumn FROM atable ORDER BY acolumn;" | time sqlite3 mydb
sqlite3 mydb  8.87s user 15.06s system 99% cpu 23.980 total

% echo "SELECT acolumn FROM (SELECT DISTINCT acolumn FROM atable) ORDER BY acolumn;" | time sqlite3 options
sqlite3 mydb  1.15s user 0.10s system 98% cpu 1.267 total 
```

两个查询的性能不应该更接近吗？我了解查询计划程序可能会以不同的顺序执行“排序”和“不同”操作，但如果是这样，是否需要这样做？或者它应该能够弄清楚如何最快地做到这一点？

**编辑**：这里要求的是每个查询的“EXPLAIN QUERY PLAN”命令的输出。

对于第一个（整体）查询：

```
0|0|0|SCAN TABLE atable (~1000000 rows)
0|0|0|USE TEMP B-TREE FOR DISTINCT 
```

对于第二个（子查询）查询：

```
1|0|0|SCAN TABLE atable (~1000000 rows)
1|0|0|USE TEMP B-TREE FOR DISTINCT
0|0|0|SCAN SUBQUERY 1 (~1000000 rows)
0|0|0|USE TEMP B-TREE FOR ORDER BY 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T21:01:15.627

您的第一个查询首先通过将*所有*记录插入到已排序的临时表中来对记录进行排序，然后`DISTINCT`通过遍历它们并仅返回与前一个不同的记录来实现。（这可以在`EXPLAIN`下面显示的输出中看到；`DISTINCT`实际上已转换为 a `GROUP BY`，其行为相同。）

理论上，您的第二个查询与第一个查询相同，但 SQLite 的查询优化器相当简单，无法证明这种转换是安全的（如[子查询展平文档](http://www.sqlite.org/optoverview.html#flattening)中所述）。因此，它是通过执行第一个操作来实现的`DISTINCT`，即仅将任何非重复项插入到临时表中，然后`ORDER BY`使用第二个临时表执行操作。这第二步完全是多余的，因为第一个临时表已经排序，但是无论如何这对您的数据来说更快，因为您有太多的重复项从未存储在任何一个临时表中。

理论上，您的第一个查询可能会更快，因为 SQLite 已经认识到`DISTINCT`and`ORDER BY`子句可以使用*相同*的排序临时表实现。然而，在实践中，SQLite 不够聪明地记住这`DISTINCT`意味着不需要将重复项存储在临时表中。[（如果你在邮件列表中](http://sqlite.org:8080/cgi-bin/mailman/listinfo/sqlite-users)很好地询问，这个特殊的优化可能会被添加到 SQLite中。）

* * *

```
$ sqlite3 mydb 
sqlite> .explain
sqlite> explain SELECT DISTINCT acolumn FROM atable ORDER BY acolumn;
addr  opcode         p1    p2    p3    p4             p5  comment      
----  -------------  ----  ----  ----  -------------  --  -------------
0     Trace          0     0     0                    00               
1     SorterOpen     1     2     0     keyinfo(1,BINARY)  00               
2     Integer        0     3     0                    00  clear abort flag
3     Integer        0     2     0                    00  indicate accumulator empty
4     Null           0     6     6                    00               
5     Gosub          5     37    0                    00               
6     Goto           0     40    0                    00               
7     OpenRead       0     2     0     1              00  atable       
8     Rewind         0     14    0                    00               
9     Column         0     0     8                    00  atable.acolumn
10    Sequence       1     9     0                    00               
11    MakeRecord     8     2     10                   00               
12    SorterInsert   1     10    0                    00               
13    Next           0     9     0                    01               
14    Close          0     0     0                    00               
15    OpenPseudo     2     10    2                    00               
16    SorterSort     1     39    0                    00  GROUP BY sort
17    SorterData     1     10    0                    00               
18    Column         2     0     7                    20               
19    Compare        6     7     1     keyinfo(1,BINARY)  00               
20    Jump           21    25    21                   00               
21    Move           7     6     0                    00               
22    Gosub          4     32    0                    00  output one row
23    IfPos          3     39    0                    00  check abort flag
24    Gosub          5     37    0                    00  reset accumulator
25    Column         2     0     1                    00               
26    Integer        1     2     0                    00  indicate data in accumulator
27    SorterNext     1     17    0                    00               
28    Gosub          4     32    0                    00  output final row
29    Goto           0     39    0                    00               
30    Integer        1     3     0                    00  set abort flag
31    Return         4     0     0                    00               
32    IfPos          2     34    0                    00  Groupby result generator entry point
33    Return         4     0     0                    00               
34    Copy           1     11    0                    00               
35    ResultRow      11    1     0                    00               
36    Return         4     0     0                    00  end groupby result generator
37    Null           0     1     0                    00               
38    Return         5     0     0                    00               
39    Halt           0     0     0                    00               
40    Transaction    0     0     0                    00               
41    VerifyCookie   0     2     0                    00               
42    TableLock      0     2     0     atable         00               
43    Goto           0     7     0                    00 
```

```
sqlite> explain SELECT acolumn FROM (SELECT DISTINCT acolumn FROM atable) ORDER BY acolumn;
addr  opcode         p1    p2    p3    p4             p5  comment      
----  -------------  ----  ----  ----  -------------  --  -------------
0     Trace          0     0     0                    00               
1     Goto           0     39    0                    00               
2     Goto           0     17    0                    00               
3     OpenPseudo     0     3     1                    01  coroutine for sqlite_subquery_DA7480_
4     Integer        0     2     0                    01               
5     OpenEphemeral  2     0     0     keyinfo(1,BINARY)  08               
6     OpenRead       1     2     0     1              00  atable       
7     Rewind         1     14    0                    00               
8     Column         1     0     3                    00  atable.acolumn
9     Found          2     13    3     1              00               
10    MakeRecord     3     1     4                    00               
11    IdxInsert      2     4     0                    00               
12    Yield          1     0     0                    00               
13    Next           1     8     0                    01               
14    Close          1     0     0                    00               
15    Integer        1     2     0                    00               
16    Yield          1     0     0                    00  end sqlite_subquery_DA7480_
17    SorterOpen     3     3     0     keyinfo(1,BINARY)  00               
18    Integer        2     1     0                    00               
19    Yield          1     0     0                    00  next row of co-routine sqlite_subquery_DA7480_
20    If             2     29    0                    00               
21    Column         0     0     5                    00  sqlite_subquery_DA7480_.acolumn
22    MakeRecord     5     1     6                    00               
23    Column         0     0     7                    00  sqlite_subquery_DA7480_.acolumn
24    Sequence       3     8     0                    00               
25    Move           6     9     0                    00               
26    MakeRecord     7     3     10                   00               
27    SorterInsert   3     10    0                    00               
28    Goto           0     19    0                    00               
29    OpenPseudo     4     6     1                    00               
30    OpenPseudo     5     11    3                    00               
31    SorterSort     3     37    0                    00               
32    SorterData     3     11    0                    00               
33    Column         5     2     6                    20               
34    Column         4     0     5                    20               
35    ResultRow      5     1     0                    00               
36    SorterNext     3     32    0                    00               
37    Close          4     0     0                    00               
38    Halt           0     0     0                    00               
39    Transaction    0     0     0                    00               
40    VerifyCookie   0     2     0                    00               
41    TableLock      0     2     0     atable         00               
42    Goto           0     2     0                    00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T10:43:28.513

在大多数 DBMS 中，SQL 语句被翻译成[关系代数](http://en.wikipedia.org/wiki/Relational_algebra)，然后在表达式树中结构化。然后 dbms 使用启发式方法来优化查询。主要启发式方法之一是“[尽早执行选择](http://de.slideshare.net/koolkampus/ch14)”（第 46 页）。我想 sqlite 查询计划器也会这样做，因此执行时间会有所不同。

由于子查询的结果要小得多（约 50 行而不是 450 万行），因此在表达式树的末尾进行排序要快得多。（普通）选择不是一个非常昂贵的过程，对大量结果运行操作确实是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T17:52:30.967

我相信这一定是因为当被子选择分开时，顺序操作和不同的操作必须更有效地实现——这实际上是一种更简单的方式来表达 alexdeloy 所说的方式。

这个实验是不完整的。请同时运行以下命令：

```
% echo "SELECT acolumn FROM (SELECT DISTINCT acolumn FROM atable ORDER BY acolumn) ;" | time sqlite3 mydb 
```

告诉我这是否比其他两个平均花费更长的时间，谢谢。

# php - 我的 usort 代码运行不正常

> ID：13533660
> 
> 赞同：1
> 
> 时间：2012-11-23T17:42:05.210
> 
> 标签：php

我对这个数组排序有问题：

```
Array
(
    [0] => stdClass Object
        (
            [id] => 120
            [registration_date] => 2012-10-19 16:57:46
            [username] => Jeff
        )
    [1] => stdClass Object
        (
            [id] => 121
            [registration_date] => 2012-12-23 16:57:46
            [username] => Peter
        )
    [2] => stdClass Object
        (
            [id] => 122
            [registration_date] => 2012-11-30 16:57:46
            [username] => Susan
        )

) 
```

它存储在变量中：

```
$unsorted_users 
```

我想通过**registration_date订购这个数组****DESC** ，所以它看起来像这样：

 **```
Array
    (
        [0] => stdClass Object
            (
                [id] => 121
                [registration_date] => 2012-12-23 16:57:46
                [username] => Peter

            )
        [1] => stdClass Object
            (
                [id] => 122
                [registration_date] => 2012-11-30 16:57:46
                [username] => Susan

            )
        [2] => stdClass Object
            (
                [id] => 120
                [registration_date] => 2012-10-19 16:57:46
                [username] => Jeff
            )

    ) 
```

它按registration_date排序，如：

```
2012-12-23 16:57:46
2012-11-30 16:57:46
2012-10-19 16:57:46 
```

而不是原来的样子：

```
2012-10-19 16:57:46
2012-12-23 16:57:46
2012-11-30 16:57:46 
```

我正在使用此代码，但效果不佳（ print_r($sorted_users); $sorted_users 的输出为“1”。我不知道为什么它是 1 而不是排序数组。）

```
$sorted_users = usort($unsorted_users, function($a, $b) {
   return $a['registration_date'] - $b['registration_date'];
}); 
```

任何建议为什么我的 $sorted_users 代码错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:48:31.700

你不能减去（那个）字符串。如果要比较两个字符串，请使用 strcmp() 函数，如下所示：

```
<?php

//  setup
$unsorted_users = array();

$t = new stdClass(); 
$t->id = 120; $t->username = 'jeff'; $t->registration_date = '2012-10-19 16:57:46'; 
$unsorted_users[] = $t;

$t = new stdClass(); 
$t->id = 121; $t->username = 'Peter'; $t->registration_date = '2012-12-23 16:57:46'; 
$unsorted_users[] = $t;

$t = new stdClass(); 
$t->id = 122; $t->username = 'Susan'; $t->registration_date = '2012-11-30 16:57:46'; 
$unsorted_users[] = $t;
// end setup

$sorted_users =    // this var is nor relevant as it shoud be allways true
usort($unsorted_users, function($a, $b) {
   return strcmp ($a->registration_date, $b->registration_date) ;
});

echo '<pre>';
print_r($unsorted_users)   // that is in fact ordered!

?> 
```

[在这里](http://phpfiddle.org/lite/code/rug-dxv)摆弄

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T17:47:17.127

`usort`正在通过引用处理数组，并返回成功布尔值 - 所以你`$sorted_users`包含该布尔值。现在应该对原始数组进行排序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-23T17:50:18.063

已经有一些有效的答案，但要添加到它们：

您的变量包含在对象中，而不是数组中；你有一个要排序的对象数组，所以你应该使用：

```
$a->registration_date
// etc. 
```

代替：

```
$a['registration_date'] 
```**

# bash - 今天的日期，减去 shell 脚本中的 X 天

> ID：13533661
> 
> 赞同：40
> 
> 时间：2012-11-23T17:42:07.387
> 
> 标签：bash, sh

我需要为今天的日期创建三个变量，分别代表年、月和日，减去 X 天。对于这个问题，我将随机选择天数：222。

因此，如果：

```
TodayYear=`date +%Y`
TodayMonth=`date +%m`
TodayDay=`date +%d` 
```

我想要的是在此之前的 222 天。

```
222days_before_TodayYear=???
222days_before_TodayMonth=???
222days_before_TodayDay=??? 
```

编辑：需要 222 个**工作日**而不是 222 个正常工作日。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-11-23T17:49:01.200

**对于 GNU `date`：**

```
date_222days_before_TodayYear=$(date --date="222 days ago" +"%Y")
date_222days_before_TodayMonth=$(date --date="222 days ago" +"%m")
date_222days_before_TodayDay=$(date --date="222 days ago" +"%d") 
```

* * *

**对于 BSD `date`:** :

如果您使用的是 OS X 或 FreeBSD，请改用以下内容，因为 BSD 日期与 GNU 日期不同：

```
date_222days_before_TodayYear=$(date -j -v-222d +"%Y")
date_222days_before_TodayMonth=$(date -j -v-222d +"%m")
date_222days_before_TodayDay=$(date -j -v-222d +"%d") 
```

来源：[BSD 日期手册页](http://www.unix.com/man-page/FreeBSD/1/date/)

**笔记：**

在`bash`和许多其他语言中，您不能以数字字符开头变量名，因此我`date_`为您添加了前缀。

* * *

**第二次更新：**新要求 -*使用 222 个工作日而不是 222 个常规日：*

（**假设：**不考虑法定假日，因为这远远超出了我在 shell 脚本中可以帮助您的范围：）

考虑 222 个工作日：

*   每周5个工作日，即`floor(222/5) == 44 weeks`
*   `44 weeks * 7 days per week == 308 days`
*   剩余天数：`222 % 5 == 2`
*   所以`222 working days == 310 regular days`

但是有一个问题！如果常规天数是`308`或 的某个倍数`7`，那么我们就可以了，因为从工作日开始的 7 天前的任何倍数仍然是工作日。所以我们需要考虑今天是星期一还是星期二：

*   如果今天是星期一，我们会得到星期六想要星期四的地方
*   如果今天是星期二，我们会在我们想要星期五的地方得到星期天

所以你看，如果今天是星期一或星期二，我们需要额外的 2 天偏移量；所以让我们在继续之前先找出答案：

```
#!/bin/bash

# Use 310 days as offset instead of 222
offset=310
# Find locale's abbreviated weekday name (e.g., Sun)
today=$(date -j +"%a")
# Check for Mon/Tue
if [[ "$today" == "Mon" ]] || [[ "$today" == "Tue" ]]; then
     offset=$((offset+2))
fi

date_222_working_days_before_TodayYear=$(date -j -v-${offset}d +"%Y")
date_222_working_days_before_TodayMonth=$(date -j -v-${offset}d +"%m")
date_222_working_days_before_TodayDay=$(date -j -v-${offset}d +"%d") 
```

那应该这样做=)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-23T17:45:27.630

```
date '+%Y' --date='222 days ago' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-02-06T09:57:22.940

您可以在 bash 中从以下内容中获取确切的过去日期

```
Number=222
current_date=$(date +%Y%m%d)
past_date=$(date -d "$current_date - $Number days" +%Y%m%d)
echo "$current_date\t$past_date" 
```

希望这可以帮助 ！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-23T17:49:12.867

```
epoch=$(( `date '+%s'` - ( 24 * 60 * 60 * 222 ) ))
year=`date -d "@$epoch" '+%Y'`
month=`date -d "@$epoch" '+%m'`
day=`date -d "@$epoch" '+%d'` 
```

应该做的伎俩。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-07T18:31:02.753

我会说更简单的解决方案是

```
222days_before_TodayYear = $(date -v -222d +%Y)
222days_before_TodayMonth = $(date -v -222d +%m)
222days_before_TodayDay = $(date -v -222d +%d) 
```

# mongodb - 如何更改生成表中的列顺序（grails 约束不适用于 mongodb 插件）

> ID：13533662
> 
> 赞同：5
> 
> 时间：2012-11-23T17:42:11.310
> 
> 标签：mongodb, grails, scaffolding

我正在使用带有 mongodb 插件的 Grails 2.1.1。我在更改生成列表中的列顺序时遇到问题。正如[grails 脚手架指南](http://grails.org/doc/latest/guide/scaffolding.html)所说，您只需要在约束块中正确排序属性。

我的域名：

```
class Section {

String idName
String visible
String required
String name
String bold

static embedded = ['question']

List<Question> questions
static hasMany = [questions : Question]

static constraints = {
    idName (blank: false)
    name (blank: false)
    visible (blank: false)
    required (blank: false)
    bold (blank: false)
}

@Override
public String toString() {
    name
}
} 
```

但列仍按字母顺序排列。我正在使用静态脚手架，因此在更改约束后我使用`grails generate-all *`命令并覆盖所有文件。

是的，我尝试清理和编译代码，清理和重新启动服务器（与 STS 集成）并清理浏览器缓存。mongo数据库是否有问题（已卸载hibernate插件）？

之后我还安装了 grails 模板。在 list.gsp 中有一行带有排序属性：

```
Collections.sort(props, comparator.constructors[0].newInstance([domainClass] as Object[])) 
```

知道如何更改它以获得我在约束中设置的工作顺序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T21:37:47.717

应该填写一个 jira 问题。如果查看 [https://github.com/grails/grails-core/blob/master/grails-crud/src/main/groovy/org/codehaus/groovy/grails/scaffolding/DefaultGrailsTemplateGenerator.groovy](https://github.com/grails/grails-core/blob/master/grails-crud/src/main/groovy/org/codehaus/groovy/grails/scaffolding/DefaultGrailsTemplateGenerator.groovy)

```
 void generateView(GrailsDomainClass domainClass, String viewName, Writer out) {
    def templateText = getTemplateText("${viewName}.gsp")

    if (templateText) {
        def t = engine.createTemplate(templateText)
        def multiPart = domainClass.properties.find {it.type == ([] as Byte[]).class || it.type == ([] as byte[]).class}

        boolean hasHibernate = pluginManager?.hasGrailsPlugin('hibernate')
        def packageName = domainClass.packageName ? "<%@ page import=\"${domainClass.fullName}\" %>" : ""
        def binding = [pluginManager: pluginManager,
                packageName: packageName,
                domainClass: domainClass,
                multiPart: multiPart,
                className: domainClass.shortName,
                propertyName:  getPropertyName(domainClass),
                renderEditor: renderEditor,
                comparator: hasHibernate ? DomainClassPropertyComparator : SimpleDomainClassPropertyComparator]

        t.make(binding).writeTo(out)
    }

} 
```

很明显，调用生成视图决定使用 SimpleDomainClassPropertyComparator。Grails 最初是为依赖休眠而构建的。在过去的几年里，世界一直在使用额外的持久性机制。如果看一下 DomainClassPropertyComparator，就不会依赖 hibernate。我觉得代码应该测试 domainObject “hasConstraints” 来决定使用哪个比较器，或者默认情况下简单地使用 DomainClassPropertyComparator。如果没有找到约束，它的行为是相同的。DefaultGrailsTemplateGenerator 不需要调用“hasHibernate”。

作为一种解决方法，您可以安装脚手架模板，编辑 _form.gsp 并将它使用的比较器更改为 DomainClassPropertyComparator 例如我的 _form.gsp

```
 <%=packageName%>
<% import grails.persistence.Event %>
<% import org.codehaus.groovy.grails.scaffolding.DomainClassPropertyComparator %>

<%  excludedProps = Event.allEvents.toList() << 'version' << 'dateCreated' << 'lastUpdated'
    persistentPropNames = domainClass.persistentProperties*.name
    boolean hasHibernate = pluginManager?.hasGrailsPlugin('hibernate')
    if (hasHibernate && org.codehaus.groovy.grails.orm.hibernate.cfg.GrailsDomainBinder.getMapping(domainClass)?.identity?.generator == 'assigned') {
        persistentPropNames << domainClass.identifier.name
    }

DomainClassPropertyComparator mattsComparator = new DomainClassPropertyComparator(domainClass)
comparator = mattsComparator

props = domainClass.properties.findAll { persistentPropNames.contains(it.name) && !excludedProps.contains(it.name) }
    Collections.sort(props, comparator)
    for (p in props) {
        if (p.embedded) {
            def embeddedPropNames = p.component.persistentProperties*.name
            def embeddedProps = p.component.properties.findAll { embeddedPropNames.contains(it.name) && !excludedProps.contains(it.name) }
            Collections.sort(embeddedProps, comparator)
            %><fieldset class="embedded"><legend><g:message code="${domainClass.propertyName}.${p.name}.label" default="${p.naturalName}" /></legend><%
                for (ep in p.component.properties) {
                    renderFieldForProperty(ep, p.component, "${p.name}.")
                }
            %></fieldset><%
        } else {
            renderFieldForProperty(p, domainClass)
        }
    }

private renderFieldForProperty(p, owningClass, prefix = "") {
    boolean hasHibernate = pluginManager?.hasGrailsPlugin('hibernate')
    boolean display = true
    boolean required = false
    if (hasHibernate) {
        cp = owningClass.constrainedProperties[p.name]
        display = (cp ? cp.display : true)
        required = (cp ? !(cp.propertyType in [boolean, Boolean]) && !cp.nullable && (cp.propertyType != String || !cp.blank) : false)
    }
    if (display) { %>
<div class="fieldcontain \${hasErrors(bean: ${propertyName}, field: '${prefix}${p.name}', 'error')} ${required ? 'required' : ''}">
    <label for="${prefix}${p.name}">
        <g:message code="${domainClass.propertyName}.${prefix}${p.name}.label" default="${p.naturalName}" />
        <% if (required) { %><span class="required-indicator">*</span><% } %>
    </label>
    ${renderEditor(p)}
</div>
<%  }   } %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-12T18:24:05.497

如果您在模板中注释下面的行并重新生成视图，则约束中的顺序将是脚手架中的顺序

```
//Collections.sort(props, comparator.constructors[0].newInstance([domainClass] as Object[])) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T12:31:33.027

如您所描述的，约束应该更新视图。尝试运行`grails generate-all --stacktrace`脚本可能在相应地更新视图之前终止。另一种策略是检查问题是否存在于以下陈述中，因此摆脱它们并检查视图是否相应更新可能会让您更接近解决问题。

```
static embedded = ['question']

List<Question> questions
static hasMany = [questions : Question] 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T12:06:27.617

经过一些测试，我确信只使用没有休眠插件的 mongodb 插件会导致禁用一些脚手架功能。例如，在生成视图期间省略了约束子句。要完成这项工作，您需要使用休眠。因此，如果您想拥有自动生成的代码并且仍然使用 mongodb，则有一个技巧：使用 hibernate 创建、生成和完成项目，然后在生产环境中卸载 hibernate 并安装 mongodb。

# grails - 在学习 Grails 之前我需要知道什么？

> ID：13533663
> 
> 赞同：0
> 
> 时间：2012-11-23T17:42:24.803
> 
> 标签：grails, groovy

我现在是一名学生，我喜欢grails。

我对java有一点经验，但没有那么多。

我知道一点Java堆栈技术

在使用 Grails 框架开发网站之前，我应该了解哪些技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:25:33.743

您是否尝试过阅读[grails 入门指南](http://grails.org/doc/latest/guide/gettingStarted.html)？这应该能让你继续前进，而且你可以在途中拿起任何你需要的额外东西......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:24:25.123

我建议你在 Grails 之前学习 Spring MVC 框架，因为 Grails 是基于这个框架的。因此，如果您遇到错误，您将不得不检查堆栈跟踪并了解发生了什么。

[您可以通过阅读Spring Web MVC 框架简介](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html)开始学习 Spring MVC 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:29:50.090

值得了解 Grails 在后台使用的技术：

*   [休眠](http://www.hibernate.org/)
*   [Spring](http://www.springsource.org/)（尤其是 MVC）
*   [时髦的](http://groovy.codehaus.org/)

熟悉 Grails 使用的设计模式也是值得的，特别是[model-view-controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)。

一些[关系数据库](http://en.wikipedia.org/wiki/Relational_database)的基础知识也会很有用。

# javascript - 如何将 na 对象属性重置为默认值？

> ID：13533666
> 
> 赞同：1
> 
> 时间：2012-11-23T17:42:32.320
> 
> 标签：javascript, jquery, object, methods, properties

我正在使用 jQuery，但我对 JavaScript 还是很陌生。我正在实现一个对象，如下所示：

```
MyObject = {
  properties     : [{}],
  resetProperties: function resetProperties() { this.properties = [{}] }
}; 
```

正如你在上面的代码中看到的，我可以`properties`通过运行来重置，`MyObject.resetProperties()`但是为了做到这一点，我声明了变量的*两倍。*`[{}]`我应该如何在不重复该代码的情况下完成同样的事情？

* * *

**更新**

我尝试执行以下操作：

```
MyObject = {
  properties       : this.propertiesDefault,
  resetProperties  : function resetProperties() { this.properties = [{}] },
  propertiesDefault: [{}]
}; 
```

但我得到“ `TypeError: invalid 'in' operand MyObject.properties`”，我不确定这是正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:32:11.537

在我看来，避免将默认/重置属性作为要修改的对象的单独对象是不可能的。

我建议使用默认值，并将其克隆到您的初始化和重置函数中。由于您使用 jQuery 标记了您的问题，我假设您很乐意使用它来克隆对象：

```
MyObject = {
    defaultProperties : [{}],
    properties : jQuery.extend(true, {}, this.defaultProperties),
    resetProperties: function() { 
        this.properties = jQuery.extend(true, {}, this.defaultProperties);
    }
}; 
```

有关克隆对象的更多信息，请参阅此 Stack Overflow 问题：

[在 JavaScript 中深度克隆对象的最有效方法是什么？](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-clone-a-javascript-object)

这是 jQuery.extend 的文档：

[http://docs.jquery.com/Utilities/jQuery.extend](http://docs.jquery.com/Utilities/jQuery.extend)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T21:13:22.270

取决于你想要什么。由于您是 javascript 新手，您可能不熟悉使用函数创建自定义对象，这是一般的 javascript "OOP" 方式。

```
function MyObjectClass() {
    this.properties = null;
    this.resetProperties();
}
MyObjectClass.prototype.resetProperties = function () { this.properties = [{}] };

var MyObject= new MyObjectClass(); 
```

但我们并不真正知道该功能`MyObject`需要实现。可能需要它是一个普通的旧 javascript 对象。或者也许不是，你已经完成了。

当然，您始终可以直接：

```
MyObject = {
          properties     : null,
          resetProperties: function () { this.properties = [{}];}
        };
MyObject.resetProperties(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:46:52.117

据我所知这是不可能的。您将不得不对属性重置进行硬编码。我尝试在对象外部设置变量缓存，但是当我重置属性时，不幸的是它保持了它的值。

```
 var obj = {
     p: [ {} ],
     r: function() { this.p = this.cache; }
 };

 obj.cache = obj.p; // attempt to set to original

 obj.p[0].m = 5; // modify

 obj.r(); // reset

 --------

 >>> obj.p[0].m; // 5 
```

我们可以假设该`cache`属性正在以与原样相同的方式进行修改`p`。因此，我们不能那样重置。

# maven - 使用 Maven (Netbeans) 从 Weblogic 部署

> ID：13533667
> 
> 赞同：0
> 
> 时间：2012-11-23T17:42:34.910
> 
> 标签：maven, netbeans, weblogic

任何人都知道如何使用 Maven 应用程序设置开始部署 weblogic？Maven weblogic 已经设法插入插件和依赖项，但与我遇到问题的方式相反。有小费吗？

`Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (default-deploy) on project jsf-scrumtoys:` `Failed to deploy artifacts: Could not transfer artifact com.sun.faces:jsf-scrumtoys:war:0.1 from/to nexus-site (http://central_nexus/server): Failed to transfer file: http://central_nexus/server/com/sun/faces/jsf-scrumtoys/0.1/jsf-scrumtoys-0.1.war.` `Return code is: 503, ReasonPhrase:Service Unavailable. -> [Help 1]`

`To see the full stack trace of the errors, re-run Maven with the -e switch. Re-run Maven using the -X switch to enable full debug logging.` `For more information about the errors and possible solutions, please read the following articles: [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException`

# django-models - satchmo 没有这样的表

> ID：13533668
> 
> 赞同：1
> 
> 时间：2012-11-23T17:42:36.097
> 
> 标签：django-models, django-admin, database-connection, satchmo, database-table

每当我转到管理员并单击我得到的任何 satchmo 链接时

DatabaseError at /admin/product/category/ 没有这样的表：product_category 请求方法：GET 请求 URL：url.com/admin/product/category/ Django 版本：1.3.1 异常类型：DatabaseError 异常值：
没有这样的表：product_category 异常位置：/usr/local/lib/python2.6/site-packages/Django-1.3.1-py2.6.egg/django/db/backends/sqlite3/base.py 在执行中，第 234 行 Python 可执行文件：/usr /bin/python Python 版本：2.6.5

category 可以用 admim 中的任何内容替换，例如产品、折扣等。所有相同的错误。这是使用 clonesatchmo.py 构建的全新 satchmo 包。

# c# - ASP.Net Web API 不会从 StreamContent 读取所有字节

> ID：13533672
> 
> 赞同：7
> 
> 时间：2012-11-23T17:42:48.267
> 
> 标签：c#, file-upload, asp.net-mvc-4, asp.net-web-api

我在我的网站上设置了一个 ASP.Net Web API，用于与 WPF 桌面应用程序进行通信。我在 API 上有一个操作设置，用于从客户端应用程序接收二进制文件。但是，在某些（看似随机的）情况下，当我从请求中获取所有字节时，并非所有字节都被读取。希望你能给我一个想法，告诉我如何以一种始终有效的方式做到这一点。这是代码：

**客户端：**

```
public static SubmitTurnResult SubmitTurn(int turnId, Stream fileStream)
{
    HttpClient client = CreateHttpClient();

    HttpContent content = new StreamContent(fileStream);
    content.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment");
    content.Headers.ContentDisposition.FileName = "new-turn.Civ5Save";
    content.Headers.ContentType = new MediaTypeHeaderValue("application/octet-stream");
    content.Headers.ContentLength = fileStream.Length;

    HttpResponseMessage response = client.PostAsync(
        string.Format("SubmitTurn?authKey={0}&turnId={1}",
                        LocalSettings.Instance.AuthenticationKey,
                        turnId
                        ),
        content
    ).Result;

    response.EnsureSuccessStatusCode();

    return response.Content.ReadAsAsync<SubmitTurnResult>().Result;
} 
```

*SubmitTurnResult*是一个枚举，它定义了服务器上的结果，*turnId*是这个文件附加到的实体的 ID，*fileStream*是一个读取磁盘字节的实际 FileStream。

**服务器端：**

```
[HttpGet, HttpPost]
public SubmitTurnResult SubmitTurn(string authKey, int turnId)
{

    try
    {
        bool worked = false;
        int gameId = 0;

        using (GmrEntities gmrDb = new GmrEntities())
        {
            var player = gmrDb.Users.FirstOrDefault(u => u.AuthKey == authKey);
            if (player != null)
            {
                var turn = player.Turns.FirstOrDefault(t => t.TurnID == turnId);
                if (turn != null)
                {
                    byte[] saveFileBytes = null;

                    using (MemoryStream tempStream = new MemoryStream())
                    {
                        var task = this.Request.Content.CopyToAsync(tempStream);
                        task.Wait();

                        saveFileBytes = tempStream.ToArray();
                        tempStream.Close();
                    }

                    if (saveFileBytes.Length != this.Request.Content.Headers.ContentLength.Value)
                    {
                        throw new Exception(string.Format("Byte array length ({0}) not equal to HTTP content-length header ({1}). This is not good!",
                                    saveFileBytes.Length, this.Request.Content.Headers.ContentLength.Value));
                    }

                    worked = GameManager.SubmitTurn(turn, saveFileBytes, gmrDb);

                    if (worked)
                    {
                        gameId = turn.Game.GameID;

                        gmrDb.SaveChanges();
                    }
                }
            }
        }

        return SubmitTurnResult.OK;
    }
    catch (Exception exc)
    {
        DebugLogger.WriteExceptionWithComments(exc, string.Format("Diplomacy: Sumbitting turn for turnId: {0}", turnId));

        return SubmitTurnResult.UnexpectedError;
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-08T19:44:42.083

正如我在之前的评论中所指出的，我们在使用 StreamContent 时遇到了同样的行为，但在流式传输来自 Windows Server 2003 Web API 服务的响应时。~~它不会在 2008 年重现。~~ 实际上，如果我使用少量 RAM (712 MB) 配置 VM，它也会在 Windows Server 2008 上重现，但如果使用 4 GB 的 RAM，它不会重现。此外，我们发现这仅适用于 FileStream。将 FileStream 转换为 MemoryStream 绕过了这个问题（当然以内存为代价）。我们发现，当响应流提前终止时，它总是在 4096 字节的边界上，并且达到了大约 3.5MB 的上限。

这是为我解决问题的解决方法，根据您的代码示例量身定制：

```
public static SubmitTurnResult SubmitTurn(int turnId, Stream fileStream)
{
    HttpClient client = CreateHttpClient();

    var memoryStream = new MemoryStream((int)fileStream.Length);
    fileStream.CopyTo(memoryStream);
    fileStream.Close();
    memoryStream.Seek(0, SeekOrigin.Begin);
    HttpContent content = new StreamContent(memoryStream); 
```

如果需要，您可以仅在 Stream 是 FileStream 时有条件地执行 MemoryStream 复制。

# database - MVC3 模型到数据库视图

> ID：13533674
> 
> 赞同：3
> 
> 时间：2012-11-23T17:42:59.523
> 
> 标签：database, asp.net-mvc-3, view

我想在 MVC3 上创建一个模型，但不是为表创建模型，而是为我的数据库中的视图创建一个模型。我知道对于表的模型，我需要在创建模型时指定主键，否则我会收到一些错误消息。由于视图没有主键/外键，我该如何为视图创建模型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T09:10:37.200

在任何与 EF 一起使用的 MVC 应用程序中，您可能有不同的模型来在 db 中创建表，或者为不创建任何表的视图创建概念模型。表的创建取决于您将在继承自的类中定义的模型类的哪些属性数据库上下文。请注意，此类及其关系类中存在的任何属性都将在 db 中创建表。因此，要创建仅在视图中使用的模型，您可以定义与其他表创建者模型没有任何关系的模型，并且在继承的 DbContext 类中没有定义。然后您可以将它们用作模型或类以在视图中显示数据。控制器及其相关视图应使用相同的模型，不会发生错误。

```
public class datacontext : DbContext
{
    public DbSet<Person> people { get; set;}
    public DbSet<Address> address { get; set;}
}
public class Person
{
    [Key]
    public int ID { get; set;}
    public String Name { get; set;}
}
public class Address
{
    [Key]
    public int ID { get; set;}
    public Country country { get; set;}
    public String Details { get; set;}
}
public class Country
{
    [Key]
    public int ID { get; set;}
    public String Name { get; set;}
}
public class Work_Field//without any key definition
{
    public String Title { get; set;}
    public String Description { get; set;}
} 
```

这里我们有这个表：Person、Address、Country（虽然它没有在 datacontext 类中定义）在这个例子中，你可以使用 Work_Field 作为视图模型，也许还有一些 DataAnnotations，比如 [Required]，... 来强制用户不要离开参数为空，等等。

# php - 使用 PHP 从字符串中提取不同格式的日期

> ID：13533675
> 
> 赞同：0
> 
> 时间：2012-11-23T17:43:16.697
> 
> 标签：php, preg-match, extract

我正在使用**cURL 和 WHOIS 查询**来检索不同网站的注册信息。

问题是 WHOIS 查询返回带有不同格式日期的字符串。

我想使用 preg_match**将创建日期和到期日期提取**到单独的数组中，例如：

```
$creation = array(year, month, day);
$expiration = array(year, month, day); 
```

不同的字符串输出有以下格式：

```
 expires: 2014-01-10 14:00:27
    created: 2012-01-10 15:00:28

    Creation Date: 25-Mar-2010  
    Expiration Date: 25-Mar-2013

    Record created:     14/04/2012
    Record expires:     14/04/2013

    Record created on.......: Mar 05, 2001  
    Record expires on.......: Mar 05, 2013

    Created on..............: 1997-09-15.
    Expires on..............: 2020-09-13.

    Expiration Date: 2015-12-26 19:18:07
    Creation Date:   2003-12-26 19:18:07 
```

关于如何使用 preg_match 提取日期的任何线索？

*注意*：我尝试过使用 PHP Whois API 类，但效果不佳，以及不同的 XML API，但数据不完整。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T09:42:06.913

我实际上制定了这个功能：

```
function creationdate($data)
{

if(preg_match('/Creation Date:/i',$data) == true){
    $csta = strpos($data, 'Creation Date:', 0)+14;
    $cstb = strpos($data, 'Creation Date:', 0)+27;
    $date = trim(substr($data, $csta, $cstb-$csta));
return strtotime($date);};

if(preg_match('/Record created:/i',$data) == true){
    $csta = strpos($data, 'Record created:', 0)+15;
    $cstb = strpos($data, 'Record expires:', $csta)-2;
    $date = substr($data, $csta, $cstb-$csta);
    $date = explode('/', $date);
    $date = $date[0] .'-'. $date[1] .'-'. $date[2];
return strtotime($date);};

if(preg_match('/Created on..............:(.*?)\./i',$data,$date) == true){
return strtotime($date[1]);};

if(preg_match('/Record created on.......:/i',$data) == true){
    $csta = strpos($data, 'Record created on.......:', 0)+26;
    $cstb = strpos($data, 'Record expires on.......:', $csta)-5;
    $date = substr($data, $csta, $cstb-$csta);
return strtotime($date);};

if(preg_match('/created:/i',$data) == true){
    $csta = strpos($data, 'created:', 0)+9;
    $cstb = strpos($data, 'created:', 0)+20;
    $date = trim(substr($data, $csta, $cstb-$csta));
return strtotime($date);};

return '-';

} 
```

# java - Java String.split("\\s+")

> ID：13533677
> 
> 赞同：0
> 
> 时间：2012-11-23T17:43:24.127
> 
> 标签：java, string, token

我正在尝试解析一些输出。输出如下：

`raidz1-0 ONLINE 0 0 0`

我的代码如下：

```
String line = "\traidz1-0  ONLINE       0     0     0";
String[] tokens = line.split("\\s+"); 
```

令牌最终成为`{"raidz1-0", "ONLINE", "0"}`

由于某种原因，最后 2 个零被丢弃。我想保留零，请告诉我如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:49:15.630

这段代码：

```
String line = "\traidz1-0  ONLINE       0     0     0";
String[] tokens = line.split("\\s+");
System.out.println(tokens.length);
System.out.println(Arrays.toString(tokens)); 
```

印刷：

```
 6
    [, raidz1-0, ONLINE, 0, 0, 0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:45:12.013

好吧，在我的情况下它工作正常，它应该工作： -

```
String line = "\traidz1-0  ONLINE       0     0     0";
String[] tokens = line.split("\\s+");

System.out.println(Arrays.toString(tokens)); 
```

**输出 ： -**

```
[, raidz1-0, ONLINE, 0, 0, 0] 
```

你确定，你没有得到最后两个零吗？

# android - Android Looper 和 Thread 似乎不起作用

> ID：13533679
> 
> 赞同：1
> 
> 时间：2012-11-23T17:43:26.613
> 
> 标签：android, multithreading, looper

嗨，我正在尝试在 Android 中使用带有处理程序和 Looper 的线程。

线程类：

```
public void run() {
    Looper.prepare();

    handler = new AndroidHandler(context);
    Looper.loop();

    while (!stopMe) {
                       someMethod();
               }
           ((Handler) handler).getLooper().quit();
 }

public void someMethod(){
  Log.i("New System", "Handling ");
    order ++;
    Message m=handler.obtainMessage();
    m.arg1=order;
    handler.sendMessage(m);
 } 
```

在一个单独的类中：

```
public class AndroidHandler extends Handler{
   public AndroidHandle(Context){
        super();
  }
   public void dispatchMessage(Message m) {
    super.dispatchMessage(m);

}
   @Override
public void handleMessage(Message msg) {

    Log.i("New System", "handling Message "+msg.arg1);
   }
 } 
```

它不起作用！没有发送消息，控制台中没有打印任何内容，我不知道如何解决它....这里有什么问题有什么想法吗？谢谢

ps：我不想使用ui线程我想在单独的线程中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:56:03.740

那是因为您`while`在与 looper 相同的线程中执行无限循环！所以这个线程一直很忙，无法接收消息......

您需要让 Looper 的线程独立运行。

假设您像这样设置您的弯针线程：

```
class LooperThread extends Thread {
  public Handler handler;

  public void run() {
      Looper.prepare();

      mHandler = new Handler() {
          public void handleMessage(Message msg) {
              Log.i("New System", "handling Message "+msg.arg1);
          }
      };

      Looper.loop();
  }
}

LooperThread looper = new LooperThread();
looper.start(); 
```

然后，您可以像以前一样从任何 OTHER 线程（UI 线程或任何其他线程）发送消息：

```
Handler handler = looper.handler;
Message m = handler.obtainMessage();
m.arg1 = order;
handler.sendMessage(m); 
```

但是不要从与弯针相同的线程中执行此操作，否则它没有任何意义。

# jquery - 悬停时防止按钮闪烁

> ID：13533680
> 
> 赞同：1
> 
> 时间：2012-11-23T17:43:29.990
> 
> 标签：jquery, html, css

当您将鼠标悬停在我的图像上时，将出现一个按钮。问题是当用户试图点击按钮时，它开始闪烁，用户现在离开了`<img>`标签。我无法放置 jQuery`hover()`选择器来检测用户何时将鼠标悬停在我的整个项目上，因为我在图像下有文本，并且我不希望当用户悬停在文本上时出现按钮。`<button>`当用户尝试单击它时，我将如何使它不闪烁。

[http://jsfiddle.net/DEQkk/](http://jsfiddle.net/DEQkk/)

```
​&lt;div class="item">
  <img src="http://www.placehold.it/250x100">
  <button>More Info</button>
  <p>Description</p>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

​button { position:absolute; top:20px; left:90px; display:none; }​

​$('.item img').hover( function() {
        $(this).parent().find('button').show();
    }, function() {
        $(this).parent().find('button').hide();
    }
);​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:47:55.270

它闪烁是因为当鼠标进入或悬停在按钮上时，它会离开图像。要修复它，请将事件处理程序移动到`<div>`：

```
$('.item div').hover( function() {
        $(this).find('button').show();
    }, function() {
        $(this).find('button').hide();
    }
);​ 
```

[工作演示。](http://jsfiddle.net/DEQkk/9/)

**编辑：**`<div>`在你的内部放置一个`.item`图像和包裹在其中的按钮，如下所示：

```
<div class="item">
   <div>
      <img src="http://www.placehold.it/250x100">
      <button>More Info</button>
   </div>
</div>​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:48:11.323

将悬停效果应用于图像和按钮：

```
$('.item img, .item button').hover( function() {
        $(this).parent().find('button').show();
    }, function() {
        $(this).parent().find('button').hide();
    }
); 
```

# pointers - Go 的指针何时取消引用自身

> ID：13533681
> 
> 赞同：34
> 
> 时间：2012-11-23T17:43:39.167
> 
> 标签：pointers, go

我最近才开始深入研究 Go，我有一个主要的困惑：我很难理解什么时候需要明确地取消引用指针。

例如，我知道`.`操作员将处理取消引用指针

```
ptr := new(SomeStruct)
ptr.Field = "foo" //Automatically dereferences 
```

在其他哪些情况下会这样做？例如，它似乎与数组。

```
ptr := new([5][5]int)
ptr[0][0] = 1 
```

我在规范中找不到这个，指针部分很短，甚至没有涉及取消引用。对取消引用 go 指针的规则进行任何澄清都会很棒！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-23T17:54:09.770

选择[器表达式](http://golang.org/ref/spec#Selectors)（例如`x.f`）这样做：

> 选择器会**自动取消引用指向**结构的指针。If`x`是指向结构的指针， `x.y`是 ; 的简写`(*x).y`。如果该字段`y`也是指向结构的指针，`x.y.z`则为 的简写`(*(*x).y).z`，依此类推。如果`x`包含类型的匿名字段`*A`，其中 `A`也是结构类型，`x.f`是 的快捷方式`(*x.A).f`。

[索引操作](http://golang.org/ref/spec#Indexes)的定义指定了一个数组指针可以被索引：

> 对于一个类型`A`或者`*A`where`A`是一个数组类型，或者对于一个类型`S`where`S`是一个切片类型

# bash - 我可以通过将变量连接在一起来引用现有的 bash 变量吗？

> ID：13533683
> 
> 赞同：1
> 
> 时间：2012-11-23T17:43:55.657
> 
> 标签：bash, variables

我已经定义了一个变量说：

`bob_pants="fancy"`

现在我想`$bobs_pants`通过使用另一个变量来引用的内容。

```
name="bob"
item="pants" 
```

我可以做类似的事情：

`echo "${name} has ${name}_${item} ${item}"`

我希望上面的输出是`"user bob has fancy pants"` 到目前为止，我只成功地得到了`"user bob has bob_pants pants"`

我想我需要某种方式`${name}_${item}`才能被视为，`${bob_pants}`但我尝试将变量组合为一个的所有方式都没有奏效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:52:26.717

在`bash`：

```
bob_pants="fancy"
name="bob"
item="pants"
var="${name}_${item}"
echo "${name} has ${!var} ${item}" 
```

该`${!var}`符号计算为由 命名的变量`$var`。但是，您不能这样做：

```
echo "${name} has ${!${name}_${item}} ${item}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:57:37.523

签出`eval`：

```
$ x=bob  
$ y=pants  
$ echo $x\_$y  
bob_pants  
$ eval echo \$$x\_$y  
fancy
$ 
```

# ios - 优化在 ios 设备上检查文件是否存在

> ID：13533686
> 
> 赞同：0
> 
> 时间：2012-11-23T17:44:05.017
> 
> 标签：ios, core-data

我正在为 iPad 编写杂志应用程序。在查看有问题的加载和绘图架时，我需要根据保存的状态添加“购买”、“下载”或“阅读”按钮问题。

但根据苹果文档，设备可以删除任何可下载的数据，所以我必须检查每个问题的循环中是否存在文件。这是非常昂贵的操作，并且应用程序加载时间很长。

任何想法如何优化它或如何避免它，保存功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:50:14.413

您应该尝试为每个问题异步检查它们，同时在每本杂志上显示一些加载图标或其他内容，就好像您的应用程序正在“思考”它是否有它一样。

如果您没有同时显示大量问题，您可以按需检查它们，这样您就不会检查文件系统上的数百个文件。

此外，设备可以删除可下载的数据，但这是不正常的。如果您将文件移动到文档文件夹中，则大多数情况下应该没问题。

另外，我不知道您如何检查文件是否存在，但只是为了确保使用

```
[[NSFileManager defaultManager] fileExistsAtPath:path]; 
```

# c - 如何获取文件中的元素数量？

> ID：13533687
> 
> 赞同：1
> 
> 时间：2012-11-23T17:44:08.070
> 
> 标签：c, command-line, args

现在，我有

```
int main(int argc, char *argv[]) {
    if (argc != 3) {
        printf("Invalid number of command line parameters, exiting...\n");
        exit(1);
    }

    int *numReadings;
    load_readings(argv[1], numReadings);

    return 0;
}

    int *load_readings(char fileName[], int *numReadings) {
        FILE *in = NULL;
        in = fopen(fileName, "r");

        if (in == NULL) {
            printf("Unable to open a file named \"%s\", exiting...\n", fileName);
            fclose(in);
            exit(4);
        }

        printf("%s\n", fileName);
        int size = atoi(fileName);
        printf("Size is %d\n", size);
        int *data = (int *) calloc(size, sizeof(int));

        int i;
        for (i = 0; i < size; i++)
            fscanf(in, "%d", (data + i));
        }
    } 
```

当我执行 size = atoi(fileName) 时，它返回 0。在包括这个站点在内的多个站点上，我看到人们执行“atoi(argv[1])”，但我的总是返回 0。我的 sample.txt 文件有一堆由空格分隔的 3 位数字组成。我的印象是，一旦我得到正确的尺寸，它下面的所有其他东西都会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:49:46.700

`atoi`不告诉`size`，它只是转换`string`成`integer`。
要知道`size`文件，您需要查找文件末尾，然后询问位置：

```
 fseek(fp, 0L, SEEK_END); // seek to end of file
    size = ftell(fp);    //get current file pointer
   fseek(f, 0, SEEK_SET); // seek back to beginning of file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:48:53.443

仅当可以转换为整数`atoi(string_value)`时才返回数字，例如的值为。但如果，值将是，因为不能转换为整数`string_value``int size = atoi("1");``size``1``int size = atoi("asd");``0``asd`

如果要获取文件的大小，可以使用`struct stat`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:57:05.293

`atoi()`将字符串转换为整数，似乎您想知道文件大小，或者具体来说，文件必须分配内存的数量，如果数据看起来完全像`123 123 123...`用空格分隔的 3 位数字，则使用`stat()`which 返回大小以字节为单位的文件，您可以除以 4：

```
struct stat st;
/* find the file size in bytes */
/* should check for errors */
fstat(fileName, &st);

/* divide the number of bytes by 4 to get the number of numbers */
int size = st.st_size / 4; 

/* just in case the last number doesn't have a space */
size += (st.st_size % 4) != 0; 

/* allocate memory  */
int *data = calloc(size, sizeof(int)); 
```

注意：我不太喜欢这个解决方案，你应该分配一个初始缓冲区，比如 100 个整数，如果你需要更多，你应该使用 `realloc()`

# javascript - 如何在 Cucumber javascript 测试中获取当前主机？

> ID：13533692
> 
> 赞同：1
> 
> 时间：2012-11-23T17:44:38.253
> 
> 标签：javascript, cucumber

我正在尝试编写一个 Javascript 测试，该测试需要在浏览器启动器打开浏览器之前知道测试服务器的主机。如何从我的 Cucumber 步骤中找到这些信息？

# excel - Excel图表属性

> ID：13533693
> 
> 赞同：2
> 
> 时间：2012-11-23T17:44:40.870
> 
> 标签：excel, charts, jasper-reports, ireport

我的报告中有几个图表。我需要将图表*作为图像*。

此属性可以通过 在*MS Excel 2010中选择**Format Picture-->Properties--> "Don't move or size with cell"*来实现。

 *我可以使用*iReport*实现此图像中的设计吗？ ![在此处输入图像描述](../Images/d4d29138b0c9609ed9fd8706c131d0c4.png).

目前的设计： ![在此处输入图像描述](../Images/9d8eff971938ed57db6b6d0d960331a3.png)*

# spring - Maven 依赖 spring-web 与 spring-webmvc

> ID：13533700
> 
> 赞同：113
> 
> 时间：2012-11-23T17:45:14.900
> 
> 标签：spring, maven, spring-mvc

以下依赖项之间有什么区别？

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-webmvc</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency> 
```

对比

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-web</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency> 
```

如果我`spring-webmvc`单独包含，则`spring-web`隐式添加。

我们什么时候应该`spring-web`单独使用？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-11-23T17:53:26.837

`spring-web`提供核心 HTTP 集成，包括一些方便的 Servlet 过滤器、Spring HTTP Invoker、与其他 Web 框架和 HTTP 技术（例如 Hessian、Burlap）集成的基础设施。

`spring-webmvc`是 Spring MVC 的一个实现。`spring-webmvc` [依赖于](http://repo1.maven.org/maven2/org/springframework/spring-webmvc/3.1.3.RELEASE/spring-webmvc-3.1.3.RELEASE.pom)，`spring-web`因此包括它会传递添加`spring-web`。您不必`spring-web`显式添加。

`spring-web`如果您不使用 Spring MVC 但希望利用 Spring 支持的其他与 Web 相关的技术，则应该仅依赖于此。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-05-07T08:38:13.060

来自官方文档：spring-web 模块提供了基本的面向 Web 的集成功能，例如多部分文件上传功能和使用 Servlet 侦听器和面向 Web 的应用程序上下文初始化 IoC 容器。它还包含一个 HTTP 客户端和 Spring 远程支持的 Web 相关部分。

spring-webmvc 模块（也称为 Web-Servlet 模块）包含 Spring 的模型-视图-控制器 (MVC) 和 Web 应用程序的 REST Web 服务实现。Spring 的 MVC 框架在域模型代码和 Web 表单之间提供了清晰的分离，并与 Spring 框架的所有其他功能集成。

spring-webmvc-portlet 模块（也称为 Web-Portlet 模块）提供了在 Portlet 环境中使用的 MVC 实现，并反映了基于 Servlet 的 spring-webmvc 模块的功能。

[https://docs.spring.io/spring/docs/4.3.22.RELEASE/spring-framework-reference/htmlsingle/#overview-web](https://docs.spring.io/spring/docs/4.3.22.RELEASE/spring-framework-reference/htmlsingle/#overview-web)

# android - 菜单按钮 2.3 和 4.0

> ID：13533702
> 
> 赞同：0
> 
> 时间：2012-11-23T17:45:21.540
> 
> 标签：android, menu, compatibility

应用程序必须在 2.3 和 4.0 上运行。在活动中有选项菜单。在 2.3 - 设备上的所有 ok 显示菜单按钮。在 4.0 上 - 没有菜单按钮，无法显示选项菜单。在清单中

```
android:minSdkVersion="8"
android:targetSdkVersion="15" /> 
```

活动

```
public boolean onCreateOptionsMenu(Menu menu) {
  getMenuInflater().inflate(R.menu.activity_auth, menu);
  return true;
} 
```

问：如何编写应用程序以在 2.3 和 4.0 上运行，并使用选项菜单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:49:46.760

> 如何编写在 2.3 和 4.0 上运行的应用程序并使用选项菜单？

除了您已经完成的操作之外，您还需要在 API 级别 11+ 上有一个操作栏，它将具有一个三点提示来显示溢出菜单（您的所有选项菜单项都将转到您尚未执行的操作酒吧本身）。给定现有的 android:targetSdkVersion="15"，默认情况下应该有一个操作栏。

但是，对于具有屏幕外菜单按钮的设备，您不会在操作栏中看到三点提示。相反，用户需要按下 MENU 按钮来显示您的菜单，就像他们在 Android 2.3 上所做的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:48:06.050

将旧菜单按钮降低`targetSdk`到 10（或更低）以重新出现。

我强烈建议你阅读这篇文章[说再见菜单按钮](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html)，以了解背后的所有逻辑......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T17:59:24.120

使应用程序与旧版本兼容是一个巨大的痛苦。我建议您使用一个库。杰克·沃顿 (Jake Wharton) 写的该死的好东西叫做**ActionBarSherlock**。[您可以在链接](http://actionbarsherlock.com/)中找到更多信息

到目前为止，我自己在两个应用程序中使用过。它允许您`ActionBar`在 2.2 等旧版本中使用（在 3.0 中引入）。它扩展了[android support-library 库](http://developer.android.com/sdk/compatibility-library.html)中提供了主题，如果将您的应用程序简单地设置为外观和感觉方面的 4.0。

# python - 在python中调用函数时的列表理解

> ID：13533705
> 
> 赞同：0
> 
> 时间：2012-11-23T17:45:25.557
> 
> 标签：python, list-comprehension

考虑 rhino python 中的以下文本，其中 arrPts 是点列表

```
start_point = rs.GetPoint()
arrPts0 = []
arrPts0 = rs.GetPoints()

arrPts=[]
for ind, pt in enumerate(arrPts0):
    arrPts.append( [pt,ind, 'angle','vector',0] ) 
```

然后我通过一个函数 (def) 运行 arrPts，该函数将“角度”替换为实际的角度字符串（例如“>45”），然后我想运行以下代码，该代码最终调用另一个名为“ add_Vectors'：

```
Vectors = []
newPts = []
for pt in arrPts:
    if '>45' or '<45' in pt[2]:
        newPts.append(pt)

Vectors.append(add_Vectors(newPts, start_point)) 
```

我如何用列表理解重写上述部分，以便它仅在满足条件时运行，而不是创建新列表（newPts）但始终在主列表（arrPts）上工作，如果有一个函数（def）在路上?

就像是：

```
Vectors.append(add_Vectors(newPts, start_point) ----> for '>45' in pt[2] 
```

谢谢

帕夫

1小时后......尝试了这个但似乎不起作用：

```
newPts = []
Vectors = add_Vectors([newPts for pt in arrPts if '<45' in pt[2]], start_point) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:46:22.527

而且我想我找到了仅 1 行的正确语法！

```
Vectors = add_Vectors([pt for pt in arrPts if '<45' in pt[2]], start_point) 
```

# python - pyqt 将枚举值转换为键

> ID：13533710
> 
> 赞同：2
> 
> 时间：2012-11-23T17:45:49.400
> 
> 标签：python, qt, pyqt, pyqt4

是否可以将 qt 枚举值转换为其键？

例如，我想从 QPrinter 类中获取“A4”，知道 QPrinter.A4 = 0

先感谢您

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:27:41.393

通常，您可以使用以下命令执行此操作`QMetaObject`：

```
m = QtGui.QFrame.staticMetaObject
m.enumerator(m.indexOfEnumerator('Shadow')).valueToKey(QtGui.QFrame.Sunken)
'Sunken' 
```

然而，它似乎`QPrinter`没有暴露一个元对象，所以你必须通过`QPrinter`在 Python 中 walk 的属性来做到这一点（幸运的是 PyQt 枚举是 的子类`int`，所以可以通过 来识别`isinstance`）：

```
page_sizes = dict((n, x) for x, n in vars(QtGui.QPrinter).items() if
                  isinstance(n, QtGui.QPrinter.PageSize))
page_sizes[QtGui.QPrinter.A4]
'A4' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T18:39:59.323

使用`vars`and`isinstance`构建枚举的双向映射：

```
>>> from PyQt4.QtGui import QPrinter
>>> pagesizes = {}
>>> for key, value in vars(QPrinter).iteritems():
...     if isinstance(value, QPrinter.PageSize):
...         pagesizes[key] = value
...         pagesizes[value] = key
... 
>>> pagesizes['A4']
0
>>> pagesizes[QPrinter.A4]
'A4'
>>> pagesizes[0]
'A4' 
```

**更新：**

似乎这`vars()`不适用于所有版本的 PyQt，但`dir()`可能会。因此，更强大的解决方案可能是：

```
>>> pagesizes = {}
>>> for key in dir(QPrinter):
...     value = getattr(QPrinter, key)
...     if isinstance(value, QPrinter.PageSize):
...         pagesizes[key] = value
...         pagesizes[value] = key
... 
```

（注意：仅使用*pyqt-4.10.3/qt-4.8.5*、*pyqt-4.10/qt-5.1.1*和*pyqt-5.1/qt-5.1.1 进行*测试）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-15T09:23:22.463

我根据ecatmur的回答实现了一个功能来做到这一点：

```
def qenum_key(base, value):
    """Convert a Qt Enum value to its key as a string.

    Args:
        base: The object the enum is in, e.g. QFrame.
        value: The value to get.

    Return:
        The key associated with the value as a string, or None.
    """
    klass = value.__class__
    try:
        idx = klass.staticMetaObject.indexOfEnumerator(klass.__name__)
    except AttributeError:
        idx = -1
    if idx != -1:
        return klass.staticMetaObject.enumerator(idx).valueToKey(value)
    else:
        for name, obj in vars(base).items():
            if isinstance(obj, klass) and obj == value:
                return name
        return None 
```

这首先尝试通过 QMetaObject 获取值，如果失败或不存在元对象，则使用纯 Python 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-07T19:13:46.173

此实现类似于[编译器的](https://stackoverflow.com/a/24228220)实现，但它自己找出基类（QPrinter、QFrame 等）。

```
import sys

def enum_key(enum_val, with_val=False):
    """
    Return name of Qt enum value.
    `enum_val` - enum value
    `with_val` (bool) - return value as part of name
    """
    enum_cls = enum_val.__class__
    parent = sys.modules.get(enum_cls.__module__)
    for i in enum_cls.__qualname__.split(".")[:-1]:
        parent = getattr(parent, i)
    m = getattr(parent, "staticMetaObject", None)
    if m:
        idx = m.indexOfEnumerator(enum_cls.__name__)
        name = m.enumerator(idx).valueToKey(enum_val)
    else:
        for n, val in vars(parent).items():
            if isinstance(val, enum_cls) and val == enum_val:
                name = n
                break
    return "%s (%d)" % (name, enum_val) if with_val else name

# from PyQt5 import QtPrintSupport
# print(enum_key(QtPrintSupport.QPrinter.A5, with_val=1))
# >> A5 (9) 
```

# signalr - 为 signalR alpha 实现 IJsonSerializer

> ID：13533712
> 
> 赞同：1
> 
> 时间：2012-11-23T17:45:57.973
> 
> 标签：signalr

只是将我的应用程序升级到 SignalR alpha。他们改变了 IJsonSerializer 接口

使用以前的界面，我有：

```
 public string Stringify(object obj)
    {
        var s = "";

            s = JsonConvert.SerializeObject(obj, _settings);

        return s;

    } 
```

它工作得很好。

现在我正在尝试：

```
public class CustomJsonNetSerializer : IJsonSerializer
{
    private readonly JsonSerializerSettings _settings;

    public CustomJsonNetSerializer(JsonSerializerSettings settings)
    {
        _settings = settings;
    }

    public object Parse(string json)
    {
        return JsonConvert.DeserializeObject(json);
    }

    public object Parse(string json, Type targetType)
    {
        return JsonConvert.DeserializeObject(json, targetType);
    }

    public T Parse<T>(string json)
    {
        return JsonConvert.DeserializeObject<T>(json);
    }
    public void Serialize(object value, System.IO.TextWriter writer)
    {
        var s = "";

            s = JsonConvert.SerializeObject(value, _settings);

        writer.Write(s);

    }
} 
```

但现在没有消息被发送回客户端。

在下面大卫的回答之后编辑 - 这就是我实现它的方式 - 现在与示例一起工作 下面的代码当然毫无意义，因为它完成了默认序列化程序所做的事情 - 但是为了简单起见，我删除了与锁定对象有关的添加

公共类 CustomJsonNetSerializer : IJsonSerializer {

```
 JsonNetSerializer mySerialiser;
    public CustomJsonNetSerializer(JsonSerializerSettings settings)
    {         
        mySerialiser = new JsonNetSerializer(settings);
    }

    public void Serialize(object value, System.IO.TextWriter writer)
    {
            mySerialiser.Serialize(value, writer);                   
    }

    public object Parse(string json, Type targetType)
    {
        return mySerializer.Parse(json, targetType);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:35:30.587

最简单的方法是使用内置的序列化器（JsonNetSerializer）。更改被序列化的属性的大小写也会破坏 SignalR。我们正在努力。

# parallel-processing - 如何在 Netezza 中执行矩阵运算？

> ID：13533714
> 
> 赞同：3
> 
> 时间：2012-11-23T17:46:03.877
> 
> 标签：parallel-processing, netezza

我是 netezza 并行编程的新手。有人可以说明如何执行，例如使用 netezza 并行进行矩阵加法吗？

C(m,n) = A(m,n) + B(m,n)

提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T17:23:51.017

有实现各种矩阵/线性代数运算的 Netezza 矩阵引擎。它需要安装在您的设备上。之后，您可以使用 SQL 调用所有 NZM 函数：

```
CALL NZM..INITIALIZE();
CALL NZM..CREATE_RANDOM_MATRIX('A', 10, 10);
CALL NZM..CREATE_RANDOM_MATRIX('B', 10, 10);
CALL NZM..ADD('A', 'B', 'C'); 
```

有一些函数可以将表格转换为矩阵，反之亦然：

```
CALL NZM..CREATE_MATRIX_FROM_TABLE('TABLE_A', 'A', 10, 10);    
CALL NZM..CREATE_TABLE_FROM_MATRIX('C', 'TABLE_C'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T09:23:54.503

如果您可以用 C++ 编写代码，则可以将其填充到 Netezza 的用户定义函数中。

参见[此处](http://guru-netezza.blogspot.no/2011/11/creating-netezza-user-defined-functions.html)，例如 C++ 中的 udf。

您的系统应附带适当的文档，以便更深入地参考 UDF 和用于实现的自定义代码。

# android - 从数组列表中删除元素后的java.util.ConcurrentModificationException android

> ID：13533715
> 
> 赞同：20
> 
> 时间：2012-11-23T17:46:09.220
> 
> 标签：android, exception, arraylist, java.util.concurrent

我的 android 应用程序中有以下代码：

```
/**
 * callback executed after fetching the data.
 */
public void OnPointsFetch(ArrayList<Shop> result) {

    toggleLoader(false);

    this.shops = result;

    if(activeFilter == Constants.POINTS_FILTER_AVAILABLE){
        for(Shop s : result){
            if(s.getClientPoints().getPointsAvailable() == 0){
                this.shops.remove(s);
            }
        }
    }
    else{
        for(Shop s : result){
            if(s.getClientPoints().getPointsSpent() == 0){
                this.shops.remove(s);
            }   
        }
    }

    ptsListAdapter.setCollection(this.shops);
    ptsListAdapter.setFilter(this.activeFilter);

} 
```

在异步任务的结果上调用此方法。在传递给列表适配器之前，我需要删除集合的一些元素。

```
 11-23 17:39:59.760: E/AndroidRuntime(19777): java.util.ConcurrentModificationException
11-23 17:39:59.760: E/AndroidRuntime(19777):    at java.util.ArrayList$ArrayListIterator.next(ArrayList.java:569) 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-23T17:48:06.483

在迭代列表时，您不能从列表中删除项目。您需要使用迭代器及其 remove 方法：

```
for(Iterator<Shop> it = result.iterator(); it.hasNext();) {
    Shop s = it.next();
    if(s.getClientPoints().getPointsSpent() == 0) {
        it.remove();
    }   
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T17:50:13.877

您通常会在以下情况下收到此错误

1.  在对集合进行迭代时直接修改集合

    甚至更糟的时候

2.  一个线程修改集合，而另一个线程对其进行迭代。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-20T11:30:27.953

Not sure if the accepted answer would work, as internally it would be trying to again modify the same list. A cleaner approach would be to maintain a 'deletion' list, and keep adding elements to that list within the loop. Once we are ready with the deletion list, they can be removed after the loop. This should work in all cases where we do not need the deleted element to be reprocessed. If yes, then the existing deletion list can be checked for presence of that element.

```
 List<String> list = new ArrayList<String>();
    List<String> listRemove = new ArrayList<String>();

    list.add("1");
    list.add("2");
    list.add("3");
    list.add("4");
    list.add("5");
    list.add("6");
    list.add("7");
    list.add("8");

    System.out.println("list : " + list);

    for (String i : list) {
        if (i.equals("2")) {
            listRemove.add(i);
        }
    }
    list.removeAll(listRemove);
    System.out.println("updated list: " + list); 
```

# ruby-on-rails - 修改设计确认？包括密码。空白？

> ID：13533716
> 
> 赞同：0
> 
> 时间：2012-11-23T17:46:25.117
> 
> 标签：ruby-on-rails, devise, devise-confirmable

我需要修改 Devise 如何确定用户帐户是否被确认。

我设置了两步注册，用户输入电子邮件，然后在单击电子邮件中的链接后设置密码。

这工作正常，但我有一个场景，登录用户可以创建一个用户并向他们发送一个链接以确认他们的帐户。这是通过自定义邮件手动发送的（这包括请求其帐户的用户的电子邮件地址以及确认令牌），这意味着如果他们的帐户是通过另一个用户创建的，则用户将收到 2 封电子邮件，标准设计确认指令和自定义邮件“邀请”。

在此之后我设置了skip_confirmation！在保存之前，这意味着只有我发送的电子邮件才能发送给用户，但是由于这设置了 confimed_at 字段，因此用户无法设置密码，因为它会生成一个错误，说明帐户已确认。

如何更改已确认？方法来检查密码不为空？

这是我的 2 步注册过程的覆盖确认控制器：

```
class ConfirmationsController < Devise::ConfirmationsController
  def show
    self.resource = resource_class.find_by_confirmation_token(params[:confirmation_token])
    super if resource.confirmed? 
  end

  def confirm
    self.resource = resource_class.find_by_confirmation_token(params[resource_name][:confirmation_token])
    if resource.update_attributes(params[resource_name].except(:confirmation_token)) && resource.password_match?
      self.resource = resource_class.confirm_by_token(params[resource_name][:confirmation_token])
      set_flash_message :notice, :confirmed
      sign_in_and_redirect(resource_name, resource)
    else
      render :action => "show"
    end
  end
end 
```

这是自定义邮件：

```
class MyMailer < Devise::Mailer   
  helper :application # gives access to all helpers defined within `application_helper`.

   def invite(sender, recipient)
        @sender = sender
        @recipient = recipient

        mail( :to => recipient.email,
              :subject => "Account created by #{sender.email}",
              :from => "noreply@noreply.com"
            )
  end

end 
```

登录用户创建新用户的控制器中的代码（显示适用的部分）

```
.
.
.
            newContact = User.create(:email => params[:contact_email])
            newContact.skip_confirmation!
            if newContact.save
                 MyMailer.invite(current_user, newContact).deliver
                 .
                 .
                 .
             end
.
.
. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:38:58.410

所以我破解了这个并设法让它工作，所以我想我会分享我是如何到达那里的。

所以要求是：

1) 用户从注册页面注册，发送的确认邮件是标准的confirmation_instructions 设计邮件。

2）用户是由另一个用户创建的，发送的电子邮件是一封自定义邮件，其中包含创建者的用户名给发件人。

我对上述内容进行了以下更改以使其正常工作：

向用户表添加列：invited:Integer

在用户模型中添加了以下内容：

```
protected
  def send_confirmation_instructions
    if !self.invited.nil?
      self.confirmation_token = nil if reconfirmation_required?
      @reconfirmation_required = false
      generate_confirmation_token! if self.confirmation_token.blank?
    else
      self.confirmation_token = nil if reconfirmation_required?
      @reconfirmation_required = false
      generate_confirmation_token! if self.confirmation_token.blank?
      self.devise_mailer.confirmation_instructions(self).deliver
    end
  end

  def send_on_create_confirmation_instructions
    self.devise_mailer.confirmation_instructions(self).deliver if self.invited.nil?
  end 
```

在由登录用户创建用户的控制器中更改为

```
.
.
.
            newContact = User.create(:email => params[:contact_email], :invited => 1)
            if newContact.save
                 MyMailer.invite(current_user, newContact).deliver
                 .
                 .
                 .
             end
.
.
. 
```

还在 ConfirmationsController 中添加了以下内容，以处理用户再次单击确认链接的可能性。

```
 def show
    self.resource = resource_class.find_by_confirmation_token(params[:confirmation_token])
    if self.resource.nil?
      redirect_to new_user_session_path, :notice => 'This link is no longer active, please sigin in or request new password'
    else
      super if resource.confirmed?
    end
  end 
```

我相信有更好的方法，但这可以满足我们的需要。如果有人想提出更好的方法，那么请务必成为我的客人。

# python - numpy 获取行和列索引的所有组合 2D 数组

> ID：13533719
> 
> 赞同：3
> 
> 时间：2012-11-23T17:46:32.457
> 
> 标签：python, numpy

我有一个 2D numpy 数组，如下所示：

```
import numpy as np
foo = np.array([[(i+1)*(j+1) for i in range(10)] for j in range(5)])

    #array([[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10],
    #       [ 2,  4,  6,  8, 10, 12, 14, 16, 18, 20],
    #       [ 3,  6,  9, 12, 15, 18, 21, 24, 27, 30],
    #       [ 4,  8, 12, 16, 20, 24, 28, 32, 36, 40],
    #       [ 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]]) 
```

我使用 np.nonzero 创建了一些过滤条件：

```
csum = np.sum(foo,axis=0)
#array([ 15,  30,  45,  60,  75,  90, 105, 120, 135, 150])
rsum = np.sum(foo,axis=1)
#array([ 55, 110, 165, 220, 275])
cfilter = np.nonzero(csum > 80)
#(array([5, 6, 7, 8, 9]),)
rfilter = np.nonzero(rsum < 165)
#(array([0, 1]),) 
```

现在是否有一些优雅的 numpy 切片方法来获取 foo[r,c] for r in rfilter 和 c in cfilter 的所有组合？即我想得到以下输出：

```
array([[ 6,  7,  8,  9, 10],
       [12, 14, 16, 18, 20]]) 
```

注意：我知道从数组中获取块很容易进行基本的切片选择，但在更高级的用例中，cfilter 和 rfilter 中的索引不一定彼此相邻。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:55:47.820

要索引叉积，请使用`np.ix_`：

```
foo[np.ix_(*(rfilter + cfilter))] 
```

您可以直接使用布尔索引（即不使用`np.nonzero`）：

```
foo[np.ix_(np.sum(foo, axis=1) < 165, np.sum(foo, axis=0) > 80)] 
```

请注意，`np.ix_`所做的只是适当地添加轴以提供可以一起广播的索引数组：

```
>>> np.ix_(*(rfilter + cfilter))
(array([[0],
       [1]]), array([[5, 6, 7, 8, 9]])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:28:24.650

另一种方法是使用索引两次：

```
In [167]: foo[rsum<165][:,csum>80]
Out[167]: 
array([[ 6,  7,  8,  9, 10],
       [12, 14, 16, 18, 20]]) 
```

它是可读的，而且相当快：

```
In [168]: %timeit foo[rsum<165][:,csum>80]
100000 loops, best of 3: 9.66 us per loop

In [170]: %timeit foo[np.ix_(rsum<165, csum>80)]
100000 loops, best of 3: 16.4 us per loop 
```

* * *

PS：更快的创建方式`foo`是

```
In [31]: np.multiply.outer(range(1,6),range(1,11))
Out[31]: 
array([[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10],
       [ 2,  4,  6,  8, 10, 12, 14, 16, 18, 20],
       [ 3,  6,  9, 12, 15, 18, 21, 24, 27, 30],
       [ 4,  8, 12, 16, 20, 24, 28, 32, 36, 40],
       [ 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]])

In [32]: %timeit np.multiply.outer(range(1,6),range(1,11))
100000 loops, best of 3: 14.2 us per loop

In [33]: %timeit np.array([[(i+1)*(j+1) for i in range(10)] for j in range(5)])
10000 loops, best of 3: 26.6 us per loop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:11:09.547

你实际上并不需要非零。像 (csum > 80) 这样的表达式会产生一个新矩阵。你想要的是 (csum > 80) && (rsum < 165)，但是 && 没有在矩阵上定义。但是， * 是并且它在布尔矩阵上也是如此。您遇到的唯一问题是您的 csum 和 rsum 数组的形状不正确。但是，如果您正确堆叠它们，它们可以被广播。

```
csum = np.hstack (sum (foo, axis=0))
rsum = np.vstack (sum (foo, axis=1))
print foo[(csum > 80) * (hsum < 165)] 
```

唯一的缺点是这会产生您在一维数组中要求的单元格的值。您需要对其进行 reshape() 以获得您要求的格式。

# compilation - 如何在编译环境中使用鸡蛋？

> ID：13533720
> 
> 赞同：4
> 
> 时间：2012-11-23T17:46:32.317
> 
> 标签：compilation, scheme, libraries, chicken-scheme

[这是对我之前的问题](https://stackoverflow.com/questions/13504853/does-chicken-scheme-support-complex-numbers-if-so-why-am-i-getting-this-error)的跟进。不幸的是，默认情况下，Chicken Scheme 似乎不支持复数，而是提供了一个`numbers`可以安装的鸡蛋。

我已经通过 安装了这个 egg，`chicken-install numbers`我可以在解释环境中加载它。我可以通过调用来做到这一点`use`；在 REPL 中手动，或者`.scm`通过`csi`.

例如，此脚本完美运行：

```
(use numbers)

(begin
  (display 3+3i)
  (newline)
) 
```

运行时：

```
csi -s main.scm 
```

但是当我用（即使没有任何附加标志）编译这个完全相同的片段`csc`时，我会得到与不加载它时相同的运行时错误（例如未绑定的变量。）似乎在编译环境中`use`没有切芥末。

另外两件需要注意的事情是，根据文档，我尝试了其他导入功能，例如`require-extension`,`require-library`等，但没有任何区别。另一个是，如果我将模块的名称更改为 以外的其他名称`numbers`，例如`numberss`，它无法编译，抱怨它无法加载扩展，因此显然它至少检测到该`numbers`库已安装。

谁能解释一下，最好是通过一个简短的工作示例如何在编译环境中使用鸡蛋？提前致谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T01:21:48.247

根据 Peter Bex 在[邮件列表中](http://lists.nongnu.org/archive/html/chicken-users/2012-11/msg00143.html)提供的有用信息，大多数鸡蛋都可以开箱即用，您只需要`use`它们即可。

但是，某些鸡蛋为基本阅读器提供了扩展，需要告知编译器。您可以使用`-X`标志来执行此操作。正如[文档](http://wiki.call-cc.org/eggref/4/numbers#compiled-code)所说，`numbers`是这些软件包之一。

使用以下代码编译您的代码段：

```
csc -X numbers-syntax main.scm 
```

完美地工作。

我希望这有帮助！:)

# c++ - 矩阵模板类 * 运算符必须产生错误

> ID：13533722
> 
> 赞同：0
> 
> 时间：2012-11-23T17:46:39.497
> 
> 标签：c++, templates

我有一个作业，我的老师告诉我们用模板创建一个矩阵类。一种规范是，如果您尝试将两个具有错误维度的矩阵相乘，例如 Matrix1[100][20] 和 Matrix2[20][101]，编译器需要生成错误而不是运行时。

我还没有开始这部分作业，因为我无法想象编译器将如何解决这个问题。

对不起，如果这是一个愚蠢的问题。

谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T17:50:55.373

矩阵的大小必须是类型系统的一部分，这意味着维度必须作为模板参数传递。即，`Matrx<100, 20>`是特定类型。

现在，当您重载时`operator*()`，您可以使用一对模板参数来仅接受参数列表中相同大小的矩阵，例如`(Matrix<N, M> a, Matrix<N, M> b)`.

# iphone - 在 UISearchBar 和 UISearchDisplayController 中为 UIDatePicker 交换键盘的优雅方式

> ID：13533724
> 
> 赞同：1
> 
> 时间：2012-11-23T17:46:49.887
> 
> 标签：iphone, ios, uisearchbar, uisearchdisplaycontroller

我知道这样[UISearchBar 和 InputView](https://stackoverflow.com/questions/5769999/uisearchbar-with-inputview)

但我想知道是否有一种“正确”的方式来做到这一点？比上面似乎是 hack 更好的方法，显然不能保证这将在 iOS SDK 的未来版本中起作用。

我有一个搜索栏，带有一个分段控件（范围），并且在其中一个范围上我想显示一个日期选择器而不是键盘。标准 UISearchBar 无法访问该`inputView`属性，那么还有其他方法吗？

非常感谢

汤姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:27:42.293

仅在 2 点中，首先跟踪选定的范围其次，无论何时选择您想要的范围，然后退出键盘并显示选择器。也许这段代码会对你有所帮助。

```
#pragma mark - UISearchBarDelegate
- (void)searchBar:(UISearchBar *)searchBar selectedScopeButtonIndexDidChange:(NSInteger)selectedScope{
    // Track the Scope Selection    
    selectedSearchType = selectedScope ;
}

- (BOOL)searchBarShouldBeginEditing:(UISearchBar *)searchBar {

   if(selectedSearchType=="Scope_which_will_expose_picker"){
     // Show Picker Here
    [searchBar resignFirstResponder];
   }
    return YES;
} 
```

# safari - Safari 边界半径问题

> ID：13533731
> 
> 赞同：1
> 
> 时间：2012-11-23T17:47:06.763
> 
> 标签：safari, css

我在 Safari 上遇到了一些奇怪的行为，边框半径影响各种元素的边框。

边界消失，出现奇怪的文物 ![](../Images/48d44201fa712a05f73964befa155595.png)

也得到了奇怪的双边框，但只是偶尔沿着 div。 ![](../Images/721f53519100df12327b4d8d6f3e79ff.png)这里发生了什么？

# iphone - AutoLayout：UIButton 拥抱底部的 UITabBarItem

> ID：13533736
> 
> 赞同：0
> 
> 时间：2012-11-23T17:47:44.273
> 
> 标签：iphone, objective-c, ios, constraints, autolayout

在左下角`UIViewController`的视图中，我有一个`UIButton`( `UIButtonTypeInfoDark`)。当应用程序在 4S 上运行时，看起来就像您所期望的那样。但是当我在 iPhone 5 上运行该应用程序时，它会停留在原来的位置，而不是“粘”`UITabBarItem`在底部。

这是自动布局可以为我处理的事情，还是我必须以编程方式重新定位按钮？注意：我的应用是纵向的，所以我不关心旋转。

提前致谢， CS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T03:02:32.140

有几件事。

1.  确保自动布局已打开（“文件检查器选项卡”上的 IB）
2.  确保您没有进行任何涉及边界、框架等的更改 - 现在这一切都由自动约束完成。
3.  确保远离 AutoResizingMask。这将与您的新设置竞争。

如果这些都做对了，你现在可以布局你的按钮，它会很好用。就是这样。

1.  将提到的按钮拖到左下角。
2.  当指南靠近工具栏上方的左侧角落时，您会看到指南弹出。
3.  现在通过选择按钮并进入“Size Inspector”选项卡来检查您的约束。
4.  现在选择按钮和按钮栏。
5.  通过选择位于垫子右下角的图形添加新的约束，然后选择看起来像大写“I”的中间图标放在它的一侧。
6.  选择“垂直间距”
7.  您将在约束中看到一个新的约束弹出。选择该新约束并选择“属性检查器”
8.  保持“关系”相等并选中“标准”复选框。这将使其保持在按钮栏上方的标准高度。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:52:32.687

您可以像这样使用您的 autoresizingMask：

```
button.autoresizingMask = UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleRightMargin; 
```

# sql - 可以在 Sonar 中分析 SQL 查询吗？

> ID：13533744
> 
> 赞同：4
> 
> 时间：2012-11-23T17:48:24.453
> 
> 标签：sql, sonarqube

我正在使用 Sonar 在一个非常大的项目中分析我们的 Java 代码。我们主要使用 Hibernate，但我们的代码中也有很多普通的 SQL 查询。是否可以通过 Sonar 分析这些 SQL 查询？我注意到至少有一个类似的插件，但我不确定它是否符合我的需求。我们的一些查询会让人头疼，所以如果 Sonar 可以通知 SQL 反模式会很方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:26:09.390

有一个商业[PL/SQL 插件](http://www.sonarsource.com/products/plugins/languages/plsql/)，但它旨在分析​​ Oracle 文件。

不知道任何分析 SQL 字符串的 Sonar 工具，嵌入在 Java 程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-10T14:43:08.413

商业 TSQL 选项是[http://www.techcognia.com/Home.aspx](http://www.techcognia.com/Home.aspx)

不知道 Microsoft SQL 的任何免费/开源版本。

# javascript - 使用ajax调用调用aspx页面时未调用Javascript函数

> ID：13533745
> 
> 赞同：0
> 
> 时间：2012-11-23T17:48:29.967
> 
> 标签：javascript, ajax, call

我正在使用 LoadControl 在 .aspx 页面中动态加载用户控件 .ascx 文件。在 .ascx 页面中，我正在进行 ajax 调用并调用 .aspx 页面。示例代码如下

```
$(document).ready(function () {

("#TestDiv").load("TestPage.aspx", function (response, status, xhr) {

    if (status == "error")
    {
         //some code
    }
    else
    {
         //some code
    }
} 
```

});

在 TestPage.aspx 中，我想在其页面加载时调用 1 个 javascript 代码。我在 TestPage.aspx 的 document.ready 函数中编写了 javscript alert 下面是示例代码

```
$(document).ready(function () {
    alert("Hi");
}); 
```

但是这个 javscript 警报没有被调用。请让我知道 TestPage.aspx 页面中的这个 javascript 代码有什么问题。

任何帮助将不胜感激。提前致谢。

问候， 拉胡尔·拉蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:52:06.977

您有语法错误，缺少 ); 您还缺少 $ before ("#TestDiv")

```
$(document).ready(function () {
$("#TestDiv").load("TestPage.aspx", function (response, status, xhr) {

    if (status == "error")
    {
         //some code
    }
    else
    {
         //some code
    }
});
}); 
```

# windows - WcsGetDefaultColorProfile 的代码示例

> ID：13533754
> 
> 赞同：6
> 
> 时间：2012-11-23T17:49:02.603
> 
> 标签：windows, winapi, color-profile, color-management

有没有人有一个工作代码示例显示调用 Windows 颜色系统函数**WcsGetDefaultColorProfile**以获取特定设备的默认颜色配置文件？当我为 pDeviceName 参数传递 null 时，它对我有用，但是当我尝试传递监视器的设备名称时，我总是返回错误代码 ERROR_FILE_NOT_FOUND。

我更喜欢 C# 示例，但我会尽我所能。我在任何地方都找不到较新的 WCS 配置文件管理功能的任何示例代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-03T02:11:58.910

我遇到了同样的问题，您感到沮丧的原因是 MSDN 文档对 WcsGetDefaultColorProfile 的 pDeviceName 参数不正确（或充其量是误导）。

MSDN 文档 ( [http://msdn.microsoft.com/en-us/library/dd372247(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/dd372247(v=vs.85).aspx) ) 表明 pDeviceName 指的是“设备名称”，对于显示设备，人们会假设为 Windows 显示设备名称，例如“\.\DISPLAY1”，在 EnumDisplayDevices 的 DISPLAY_DEVICE 结构的 DeviceName 参数中返回。

其实这里需要的是显示器的DeviceKey参数，具体来说就是在EnumDisplayDevices中使用EDD_GET_DEVICE_INTERFACE_NAME标志时得到的DeviceKey。

所以工作代码看起来像这样，假设 szDisplayDeviceName 已经设置为显示您关心的设备名称，例如“\.\DISPLAY1”：

```
WCHAR szPath[MAX_PATH];
DISPLAY_DEVICE dd;
dd.cb = sizeof(dd);
if (EnumDisplayDevices(szDisplayDeviceName, 0, &dd, EDD_GET_DEVICE_INTERFACE_NAME))
{
    if (WcsGetDefaultColorProfile(WCS_PROFILE_MANAGEMENT_SCOPE_CURRENT_USER, 
          dd.DeviceKey,
          CPT_ICC,
          CPST_PERCEPTUAL,
          1,  // dwProfileID -- doesn't seem to matter what value you use here
          MAX_PATH * sizeof(WCHAR),
          szPath))
    {
        PROFILE profile;
        profile.cbDataSize = (DWORD)(wcslen(szPath) + 1) * sizeof(WCHAR);
        profile.dwType = PROFILE_FILENAME;
        profile.pProfileData = (PVOID)szPath;

        HPROFILE hProfile = OpenColorProfile(&profile,
           PROFILE_READ, FILE_SHARE_READ, OPEN_EXISTING);

        // now do something with the profile
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-12T02:26:17.823

跟进上面 Matt M 的回答（谢谢！）：如果您想匹配其他应用程序的功能，请使用 EnumDisplayDevices 返回的第一个监视器，如上所述。

但请注意，这可能会在一个或多个监视器被禁用但仍连接的多监视器设置中返回不正确的（非活动/禁用）监视器。当然，微软没有在任何地方记录这一点，因此包括 Photoshop 等大玩家在内的许多应用程序在这方面都被破坏了:(

如果您想做正确的事情，您必须多次调用 EnumDisplayDevices 直到找到活动监视器（标志 DISPLAY_DEVICE_ACTIVE 和 DISPLAY_DEVICE_MULTI_DRIVER，以防多个监视器与显示器相关联）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-10T14:41:43.537

文档一点也不明显，但是从以前的答案中我拼凑了一个完整的解决方案（为了清楚起见，这里没有错误检查）。此外，这只会返回用户指定的默认值，如果他们从未设置过默认值，您将需要使用`GetStandardColorSpaceProfile`来获取“其他”默认值。

```
DISPLAY_DEVICE displayDevice = {};
displayDevice.cb = sizeof(DISPLAY_DEVICE);

// First, find the primary adaptor
std::stringw adaptorName;
DWORD deviceIndex = 0;
while (::EnumDisplayDevicesW(nullptr, deviceIndex++, &displayDevice, EDD_GET_DEVICE_INTERFACE_NAME))
{
    if (displayDevice.StateFlags & DISPLAY_DEVICE_ATTACHED_TO_DESKTOP &&
        displayDevice.StateFlags & DISPLAY_DEVICE_PRIMARY_DEVICE)
    {
        adaptorName = displayDevice.DeviceName;
        break;
    }
}

// Second, find the first active (and attached) monitor
std::string deviceName;
deviceIndex = 0;
while (::EnumDisplayDevicesW(adaptorName, deviceIndex++, &displayDevice, EDD_GET_DEVICE_INTERFACE_NAME))
{
    if (displayDevice.StateFlags & DISPLAY_DEVICE_ACTIVE &&
        displayDevice.StateFlags & DISPLAY_DEVICE_ATTACHED)
    {
        deviceName = displayDevice.DeviceKey;
        break;
    }
}

// Third, find out whether to use the global or user profile
BOOL usePerUserProfiles = FALSE;
WcsGetUsePerUserProfiles(deviceName, CLASS_MONITOR, &usePerUserProfiles);

// Finally, get the profile name
const WCS_PROFILE_MANAGEMENT_SCOPE scope = usePerUserProfiles ? WCS_PROFILE_MANAGEMENT_SCOPE_CURRENT_USER : WCS_PROFILE_MANAGEMENT_SCOPE_SYSTEM_WIDE;

DWORD profileNameLength = 0; // In bytes
WcsGetDefaultColorProfileSize(scope, deviceName, CPT_ICC, CPST_RGB_WORKING_SPACE, 0, &profileNameLength);

wchar_t *const profileName = new wchar_t[profileNameLength / sizeof(wchar_t)];
WcsGetDefaultColorProfile(scope, deviceName, CPT_ICC, CPST_RGB_WORKING_SPACE, 0, profileNameLength, profileName);
// Do something with your profile name
delete[] profileName; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-15T16:31:16.847

尝试将 Mark 的代码翻译成 C#：

```
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using System.Text;

namespace MonitorProfileNS {
    class MonitorProfile {
        [Flags()]
        enum DisplayDeviceStateFlags : UInt32 {
            // from: http://www.pinvoke.net/default.aspx/Enums/DisplayDeviceStateFlags.html
            // equvalent to defines from: wingdi.h (c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\wingdi.h)
            //#define DISPLAY_DEVICE_ATTACHED_TO_DESKTOP      0x00000001
            //#define DISPLAY_DEVICE_MULTI_DRIVER             0x00000002
            //#define DISPLAY_DEVICE_PRIMARY_DEVICE           0x00000004
            //#define DISPLAY_DEVICE_MIRRORING_DRIVER         0x00000008
            //#define DISPLAY_DEVICE_VGA_COMPATIBLE           0x00000010
            //#if (_WIN32_WINNT >= _WIN32_WINNT_WIN2K)
            //#define DISPLAY_DEVICE_REMOVABLE                0x00000020
            //#endif // (_WIN32_WINNT >= _WIN32_WINNT_WIN2K)
            //#if (_WIN32_WINNT >= _WIN32_WINNT_WIN8)
            //#define DISPLAY_DEVICE_ACC_DRIVER               0x00000040
            //#endif
            //#define DISPLAY_DEVICE_MODESPRUNED              0x08000000
            //#if (_WIN32_WINNT >= _WIN32_WINNT_WIN2K)
            //#define DISPLAY_DEVICE_REMOTE                   0x04000000
            //#define DISPLAY_DEVICE_DISCONNECT               0x02000000
            //#endif
            //#define DISPLAY_DEVICE_TS_COMPATIBLE            0x00200000
            //#if (_WIN32_WINNT >= _WIN32_WINNT_LONGHORN)
            //#define DISPLAY_DEVICE_UNSAFE_MODES_ON          0x00080000
            //#endif

            ///* Child device state */
            //#if (_WIN32_WINNT >= _WIN32_WINNT_WIN2K)
            //#define DISPLAY_DEVICE_ACTIVE              0x00000001
            //#define DISPLAY_DEVICE_ATTACHED            0x00000002
            //#endif // (_WIN32_WINNT >= _WIN32_WINNT_WIN2K)
            /// <summary>The device is part of the desktop.</summary>
            AttachedToDesktop = 0x1,
            MultiDriver = 0x2,
            /// <summary>The device is part of the desktop.</summary>
            PrimaryDevice = 0x4,
            /// <summary>Represents a pseudo device used to mirror application drawing for remoting or other purposes.</summary>
            MirroringDriver = 0x8,
            /// <summary>The device is VGA compatible.</summary>
            VGACompatible = 0x10,
            /// <summary>The device is removable; it cannot be the primary display.</summary>
            Removable = 0x20,
            /// <summary>The device has more display modes than its output devices support.</summary>
            ModesPruned = 0x8000000,
            Remote = 0x4000000,
            Disconnect = 0x2000000,

            /// <summary>Child device state: DISPLAY_DEVICE_ACTIVE</summary>
            Active = 0x1,
            /// <summary>Child device state: DISPLAY_DEVICE_ATTACHED</summary>
            Attached = 0x2
        }

        enum DeviceClassFlags : UInt32 {
            // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
            /// <summary>
            ///#define CLASS_MONITOR           'mntr' 
            /// </summary>
            CLASS_MONITOR = 0x6d6e7472,

            /// <summary>
            /// #define CLASS_PRINTER           'prtr'
            /// </summary>
            CLASS_PRINTER = 0x70727472,

            /// <summary>
            /// #define CLASS_SCANNER           'scnr'
            /// </summary>
            CLASS_SCANNER = 0x73636e72
        }

        enum WCS_PROFILE_MANAGEMENT_SCOPE : UInt32 {
            // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
            WCS_PROFILE_MANAGEMENT_SCOPE_SYSTEM_WIDE,
            WCS_PROFILE_MANAGEMENT_SCOPE_CURRENT_USER
        }

        enum COLORPROFILETYPE: UInt32 {
            // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
            CPT_ICC,
            CPT_DMP,
            CPT_CAMP,
            CPT_GMMP
        }

        enum COLORPROFILESUBTYPE: UInt32{
            // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
            // intent
            CPST_PERCEPTUAL = 0,
            CPST_RELATIVE_COLORIMETRIC = 1,
            CPST_SATURATION = 2,
            CPST_ABSOLUTE_COLORIMETRIC = 3,

            // working space
            CPST_NONE,
            CPST_RGB_WORKING_SPACE,
            CPST_CUSTOM_WORKING_SPACE,
        };

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
        private struct DISPLAY_DEVICE {
            // from: http://www.pinvoke.net/default.aspx/Structures/DISPLAY_DEVICE.html
            [MarshalAs(UnmanagedType.U4)]
            public int cb;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]
            public string DeviceName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]
            public string DeviceString;
            [MarshalAs(UnmanagedType.U4)]
            public DisplayDeviceStateFlags StateFlags;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]
            public string DeviceID;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)]
            public string DeviceKey;
        }

        const UInt32 EDD_GET_DEVICE_INTERFACE_NAME = 0x1;

        //BOOL EnumDisplayDevices(
        //  _In_ LPCTSTR         lpDevice,
        //  _In_ DWORD           iDevNum,
        //  _Out_ PDISPLAY_DEVICE lpDisplayDevice,
        //  _In_ DWORD           dwFlags
        //);
        [DllImport("user32.dll", CharSet = CharSet.Unicode)]
        private static extern UInt32 EnumDisplayDevices(string s, UInt32 iDevNum, ref DISPLAY_DEVICE displayDevice, UInt32 dwFlags);

        // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
        //BOOL WINAPI WcsGetUsePerUserProfiles(
        //  _In_ LPCWSTR pDeviceName,
        //  _In_ DWORD dwDeviceClass,
        //  _Out_ BOOL *pUsePerUserProfiles
        //);
        /// <summary>
        /// https://msdn.microsoft.com/en-us/library/windows/desktop/dd372253(v=vs.85).aspx
        /// </summary>
        /// <returns>0, if failed</returns>
        [DllImport("Mscms.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        private static extern UInt32 WcsGetUsePerUserProfiles(string deviceName, DeviceClassFlags deviceClass, out UInt32 usePerUserProfiles);

        // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
        //BOOL WINAPI WcsGetDefaultColorProfileSize(
        //  _In_ WCS_PROFILE_MANAGEMENT_SCOPE profileManagementScope,
        //  _In_opt_ PCWSTR pDeviceName,
        //  _In_ COLORPROFILETYPE cptColorProfileType,
        //  _In_ COLORPROFILESUBTYPE cpstColorProfileSubType,
        //  _In_ DWORD dwProfileID,
        //  _Out_ PDWORD pcbProfileName
        //);
        /// <summary>
        /// https://msdn.microsoft.com/en-us/library/windows/desktop/dd372249(v=vs.85).aspx
        /// </summary>
        /// <param name="cbProfileName">Size in bytes! String length is /2</param>
        /// <returns>0, if failed</returns>
        [DllImport("Mscms.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        private static extern UInt32 WcsGetDefaultColorProfileSize( WCS_PROFILE_MANAGEMENT_SCOPE scope,
            string deviceName,
            COLORPROFILETYPE colorProfileType,
            COLORPROFILESUBTYPE colorProfileSubType,
            UInt32 dwProfileID,
            out UInt32 cbProfileName
        );

        // from: c:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\um\Icm.h
        //BOOL WINAPI WcsGetDefaultColorProfile(
        //  _In_ WCS_PROFILE_MANAGEMENT_SCOPE profileManagementScope,
        //  _In_opt_ PCWSTR pDeviceName,
        //  _In_ COLORPROFILETYPE cptColorProfileType,
        //  _In_ COLORPROFILESUBTYPE cpstColorProfileSubType,
        //  _In_ DWORD dwProfileID,
        //  _In_ DWORD cbProfileName,
        //  _Out_ LPWSTR pProfileName
        //);
        /// <summary>
        /// https://msdn.microsoft.com/en-us/library/windows/desktop/dd372247(v=vs.85).aspx
        /// </summary>
        /// <returns>0, if failed</returns>
        [DllImport("Mscms.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        private static extern UInt32 WcsGetDefaultColorProfile(WCS_PROFILE_MANAGEMENT_SCOPE scope,
            string deviceName,
            COLORPROFILETYPE colorProfileType,
            COLORPROFILESUBTYPE colorProfileSubType,
            UInt32 dwProfileID,
            UInt32 cbProfileName,
            StringBuilder profileName
        );

        public static string GetMonitorProfile() {
            // c++ recommendation: http://stackoverflow.com/questions/13533754/code-example-for-wcsgetdefaultcolorprofile

            DISPLAY_DEVICE displayDevice = new DISPLAY_DEVICE();
            displayDevice.cb = Marshal.SizeOf(displayDevice);

            // First, find the primary adaptor
            string  adaptorName=null;
            UInt32 deviceIndex = 0;

            while (EnumDisplayDevices(null, deviceIndex++, ref displayDevice, EDD_GET_DEVICE_INTERFACE_NAME)!=0) {
                if ((displayDevice.StateFlags & DisplayDeviceStateFlags.AttachedToDesktop)!=0 &&  
                    (displayDevice.StateFlags & DisplayDeviceStateFlags.PrimaryDevice)!=0) {
                    adaptorName = displayDevice.DeviceName;
                    break;
                }
            }

            // Second, find the first active (and attached) monitor
            string deviceName=null;
            deviceIndex = 0;
            while (EnumDisplayDevices(adaptorName, deviceIndex++, ref displayDevice, EDD_GET_DEVICE_INTERFACE_NAME)!=0) {
                if ((displayDevice.StateFlags & DisplayDeviceStateFlags.Active) != 0 &&
                    (displayDevice.StateFlags & DisplayDeviceStateFlags.Attached) != 0) {
                    deviceName = displayDevice.DeviceKey;
                    break;
                }
            }

            // Third, find out whether to use the global or user profile
            UInt32 usePerUserProfiles = 0;
            UInt32 res = WcsGetUsePerUserProfiles(deviceName, DeviceClassFlags.CLASS_MONITOR, out usePerUserProfiles);
            if (res==0) {
                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());
            }

            // Finally, get the profile name
            WCS_PROFILE_MANAGEMENT_SCOPE scope = (usePerUserProfiles != 0) ?
                WCS_PROFILE_MANAGEMENT_SCOPE.WCS_PROFILE_MANAGEMENT_SCOPE_CURRENT_USER :
                WCS_PROFILE_MANAGEMENT_SCOPE.WCS_PROFILE_MANAGEMENT_SCOPE_SYSTEM_WIDE;

            UInt32 cbProfileName = 0;   // in bytes
            res = WcsGetDefaultColorProfileSize(scope, 
                deviceName,
                COLORPROFILETYPE.CPT_ICC, 
                COLORPROFILESUBTYPE.CPST_RGB_WORKING_SPACE, 
                0, 
                out cbProfileName);
            if (res == 0) {
                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());
            }

            int nLengthProfileName = (int)cbProfileName / 2;    // WcsGetDefaultColor... is using LPWSTR, i.e. 2 bytes/char
            StringBuilder profileName = new StringBuilder(nLengthProfileName);
            res = WcsGetDefaultColorProfile(scope, 
                deviceName, 
                COLORPROFILETYPE.CPT_ICC, 
                COLORPROFILESUBTYPE.CPST_RGB_WORKING_SPACE, 
                0, 
                cbProfileName, 
                profileName);
            if (res == 0) {
                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());
            }

            return profileName.ToString();
        }

        [DllImport("Mscms.dll", CharSet = CharSet.Unicode, SetLastError = true)]
        private static extern bool GetColorDirectory(IntPtr pMachineName, StringBuilder pBuffer, ref uint pdwSize);

        public static string GetColorDirectory() {
            // s. http://stackoverflow.com/questions/14792764/is-there-an-equivalent-to-winapi-getcolordirectory-in-net
            uint pdwSize = 260;  // MAX_PATH 
            StringBuilder sb = new StringBuilder((int)pdwSize);
            if (GetColorDirectory(IntPtr.Zero, sb, ref pdwSize)) {
                return sb.ToString();
            } else {
                throw new System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error());
            }
        }

    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T14:46:02.517

添加以下结构：

```
public const uint ProfileRead = 1;

public enum FileShare : uint
{
    Read = 1,
    Write = 2,
    Delete = 4
};

public enum CreateDisposition : uint
{
    CreateNew = 1,
    CreateAlways = 2,
    OpenExisting = 3,
    OpenAlways = 4,
    TruncateExisting = 5 
```

};

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
public class ProfileFilename
{
    public uint type;
    [MarshalAs(UnmanagedType.LPTStr)]
    public string profileData;
    public uint dataSize;

    public ProfileFilename(string filename)
    {
        type = ProfileFilenameType;
        profileData = filename;
        dataSize = (uint)filename.Length * 2 + 2;
    }
};

[DllImport("mscms.dll", SetLastError = true, EntryPoint = "GetStandardColorSpaceProfileW", CallingConvention = CallingConvention.Winapi)]
static extern bool GetStandardColorSpaceProfile(    uint machineName,
                                                    LogicalColorSpace profileID,
                                                    [MarshalAs(UnmanagedType.LPTStr), In, Out] StringBuilder profileName,
                                                    ref uint size);

[DllImport("mscms.dll", SetLastError = true, EntryPoint = "OpenColorProfileW", CallingConvention = CallingConvention.Winapi)]
    static extern IntPtr OpenColorProfile(  [MarshalAs(UnmanagedType.LPStruct)] ProfileFilename profile,
                                            uint desiredAccess,
                                            FileShare shareMode,
                                            CreateDisposition creationMode); 
```

打开默认配置文件的示例：

```
public openDefaultColorProfile()
{ 
    StringBuilder profileName = new StringBuilder(256);
    uint size = (uint)profileName.Capacity * 2;
    success = GetStandardColorSpaceProfile(0, LogicalColorSpace.WindowsColorSpace, profileName, ref size);

    ProfileFilename sRGBFilename = new ProfileFilename(profileName.ToString());
    IntPtr hSRGBProfile = OpenColorProfile(sRGBFilename, ProfileRead, FileShare.Read, CreateDisposition.OpenExisting);
} 
```

# java - 有符号字节和无符号字节之间的自动转换？

> ID：13533756
> 
> 赞同：1
> 
> 时间：2012-11-23T17:49:04.663
> 
> 标签：java, serial-port, myro

我正在使用[Scribbler 2 机器人](http://www.parallax.com/go/s2)和[Fluke 2](http://wiki.roboteducation.org/Hacking_the_Fluke)板，并通过[Java 中的 Myro](http://wiki.roboteducation.org/Myro_in_Java)与 Fluke 进行通信。Fluke 板是 Scribbler 和用 Java 编写的桌面客户端之间的蓝牙通信桥梁。它通过 RS232 串行端口与 Scribler 通信。

这可能是一个愚蠢的问题，上面的系统很复杂，如果我解释得不好，请多多包涵。

**我的问题的背景：** Java 使用有符号字节。Fluke（我认为）是用 C 语言编写的，因此使用无符号字节。Scribbler 上的固件是用[Spin](http://propeller.wikispaces.com/BYTE?responseToken=559be6ef99e7e18865a53b076690b07a)编写的，它也使用无符号字节。Scribbler 固件的一些命令字节码使用大于 127 的值，因此当它们从我的 Java 客户端发送时，它们会作为负数发送。机器人没有响应这些 > 127 个命令，我试图了解原因。

**我的问题的要点：**如果我从 Java 发送 162，它会显示为 -94（在我的控制台中用“打印”看到这个）。Spin 固件会将其视为 162，因为一个字节就是一个字节，还是会将其视为其他内容？

*我知道 Spin 代码正在对参数*进行一些位移，以移动命令，可能大于 255，但它没有针对特定命令进行。

```
pub Move | x_coord, y_coord
'        0    1     2      3      4      5 
'Format 162 type hXByte lXByte hYByte lYByte
'  type    := indata[1]
  x_coord := (indata[2]<<8 | indata[3])
  y_coord := (indata[4]<<8 | indata[5]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:32:37.620

字节是 8 位，仅此而已。它本身没有签名或未签名。不同的是算术运算——仅仅因为有不同的算术运算。所以Java只有带符号的整数运算，而C有。当一个字节通过 RS232 发送时，它没有任何操作。所以不用担心，你的字节不会被 Java 破坏。

# powershell - PowerShell 强制参数依赖于另一个参数

> ID：13533763
> 
> 赞同：23
> 
> 时间：2012-11-23T17:49:35.803
> 
> 标签：powershell, parameters, dependencies, registry, flags

我有一个更改注册表项值的 PowerShell 函数。代码：

```
param(
    [Parameter()] [switch]$CreateNewChild,
    [Parameter(Mandatory=$true)] [string]$PropertyType
) 
```

它有一个参数“CreateNewChild”，如果设置了该标志，该函数将创建 key 属性，即使它没有找到。参数“PropertyType”必须是强制性的，但前提是已设置“CreateNewChild”标志。

问题是，如何使一个参数成为强制性参数，但前提是已指定另一个参数？

好的，我一直在玩它。这确实有效：

```
param(
  [Parameter(ParameterSetName="one")]
  [switch]$DoNotCreateNewChild,

  [string]$KeyPath,

  [string]$Name,

  [string]$NewValue,

  [Parameter(ParameterSetName="two")]
  [switch]$CreateNewChild,

  [Parameter(ParameterSetName="two",Mandatory=$true)]
  [string]$PropertyType
) 
```

但是，这意味着 $KeyPath、$Name 和 $NewValue 不再是强制性的。将“一个”参数集设置为强制会破坏代码（*“参数集无法解析”*错误）。这些参数集令人困惑。我确定有办法，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-23T18:46:12.030

您可以通过定义参数集来对这些参数进行分组以完成此操作。

```
param (
    [Parameter(ParameterSetName='One')][switch]$CreateNewChild,
    [Parameter(ParameterSetName='One',Mandatory=$true)][string]$PropertyType
) 
```

参考：

[https://devblogs.microsoft.com/powershell/powershell-v2-parametersets](https://devblogs.microsoft.com/powershell/powershell-v2-parametersets)

[http://blogs.technet.com/b/heyscriptingguy/archive/2011/06/30/use-parameter-sets-to-simplify-powershell-commands.aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2011/06/30/use-parameter-sets-to-simplify-powershell-commands.aspx)

- - 更新 - -

这是一个模仿您正在寻找的功能的片段。除非调用 -Favorite 开关，否则不会处理“Extra”参数集。

```
[CmdletBinding(DefaultParametersetName='None')] 
param( 
    [Parameter(Position=0,Mandatory=$true)] [string]$Age, 
    [Parameter(Position=1,Mandatory=$true)] [string]$Sex, 
    [Parameter(Position=2,Mandatory=$true)] [string]$Location,
    [Parameter(ParameterSetName='Extra',Mandatory=$false)][switch]$Favorite,      
    [Parameter(ParameterSetName='Extra',Mandatory=$true)][string]$FavoriteCar
)

$ParamSetName = $PsCmdLet.ParameterSetName

Write-Output "Age: $age"
Write-Output "Sex: $sex"
Write-Output "Location: $Location"
Write-Output "Favorite: $Favorite"
Write-Output "Favorite Car: $FavoriteCar"
Write-Output "ParamSetName: $ParamSetName" 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-11-26T06:50:14.570

您还可以使用动态参数：

*[创建动态参数的新方法](http://www.developpez.net/forums/d1271564/general-developpement/programmation-systeme/windows/scripts-batch/astuce-traduire-directives-parametres-dynamiques/)*

# python - 使 optparse 将某些选项视为位置参数

> ID：13533768
> 
> 赞同：1
> 
> 时间：2012-11-23T17:49:56.847
> 
> 标签：python, optparse

我有一个接受表单参数的程序`filename:field[slice]`，它工作正常。但我也希望支持文件名`-`表示标准输入的通用表示法。可悲的是，`-:field[slice]`注册为 optparse 的选项（自然），因此不会显示为位置参数。所以我想知道是否有办法解决这个问题，例如告诉 optparse 以开头的选项`-:`毕竟应该被视为位置参数。解决方案应保留参数的顺序，因此`foo:bar -:cow baz:dog`不应成为`foo:bar baz:dog -:cow`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:56:59.893

在我看来，您最好的选择是预处理`sys.argv`插入一个您检查的特殊令牌，而不是`-`.

```
args = [ '<stdin>:'+x[2:] if x.startswith('-:') else x for x in sys.argv[1:] ]
opt_struct = parser.parse_args(args) 
```

在这种情况下，您将在程序中解析`<stdin>`为标准输入，而不是`-`.

`:`如果和 之后的东西是可选的，则转换会变得更加复杂，但无论如何这就是它的要点。

10 次中有 9 次，这些问题可能无法解决，解决起来`optparse`非常棘手/混乱，`argparse`而通过预处理解决起来也很简单`sys.argv`——但也许这只是我的经验......

# haskell - applicative functor 和 monad 的等价性

> ID：13533769
> 
> 赞同：3
> 
> 时间：2012-11-23T17:50:04.187
> 
> 标签：haskell, monads, functor, applicative

人们说 monad 是应用函子的扩展，但我不这么认为。让我们举一个应用函子的例子：`(<*>) :: f(a->b) -> f a -> f b`

```
[(+3)] <*> [2,3,4] 
```

现在，我也希望我可以做和 monad 一样的事情，这意味着我可以应用 2 个参数：一个上下文包含一个函数，另一个上下文来获取一个上下文。但对于 monad，我不能。我所需要的只是编写一个像这样丑陋的函数：

```
[2,3,4] >>= (\x->[x+3]) 
```

是的，当然，你可以说这`[(+3)]`等价于`[\x->(x+3)]`. 但至少，这个函数是在上下文中的。

最后，我在这里看不到等价或扩展。Monad 是一种不同的风格，在另一个故事中很有用。

对不起我的无知。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-23T17:56:31.140

如果`T`是 的一个实例`Monad`，那么您可以使它成为这样的一个实例`Applicative`：

```
instance Functor T where
    fmap = liftM

instance Applicative T where
    pure = return
    (<*>) = ap 
```

`liftM`定义为

```
liftM   :: (Monad m) => (a1 -> r) -> m a1 -> m r
liftM f m1              = do { x1 <- m1; return (f x1) } 
```

`ap`定义为

```
ap                :: (Monad m) => m (a -> b) -> m a -> m b
ap                =  liftM2 id

liftM2  :: (Monad m) => (a1 -> a2 -> r) -> m a1 -> m a2 -> m r
liftM2 f m1 m2          = do { x1 <- m1; x2 <- m2; return (f x1 x2) } 
```

因此，“单子是应用函子的扩展”，因为任何单子都可以成为应用函子。实际上，在标准库中广泛（不是普遍）认为 class`Monad`不是从 class 派生的错误`Applicative`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-23T18:57:28.477

```
import Control.Applicative 
```

我认为它澄清了`<*>`再次定义的关系，但使用了 Monad：

```
(>*>) :: Monad m => m (a -> b) -> m a -> m b
mf >*> ma = do
   f <- mf
   a <- ma
   return (f a) 
```

给出与以下相同的结果`<*>`：

```
*Main> [(+3)] >*> [2,3,4]
[5,6,7]
*Main> [(+3)] <*> [2,3,4]
[5,6,7] 
```

甚至

```
*Main> [(+3),(*10)] <*> [2,3,4]
[5,6,7,20,30,40]
*Main> [(+3),(*10)] >*> [2,3,4]
[5,6,7,20,30,40] 
```

现在，变量`f`和`a`定义中最后一行的存在是Monad 和 Applicative 之间`>*>`的**关键区别。**在 Applicative 中，你只能`return`在末尾做一些事情，而在 Monad 中，你可以用`f`and做任何你喜欢的事情`a`。

## 相似之处

在应用程序中，你可以做

```
getNonEmptyStringA :: IO String
getNonEmptyStringA = (:) <$> getChar <*> getLine 
```

我们可以将其转换为 Monad 函数

```
getNonEmptyStringM' = (:) `fmap` getChar >*> getLine 
```

或更典型地，

```
getNonEmptyStringM :: IO String
getNonEmptyStringM = do
    c <- getChar
    xs <- getLine
    return (c:xs) 
```

## 区别

在 Monad 你可以做

```
checkFirst :: IO (Maybe String)
checkFirst = do
    c <- getChar
    if c == 'n' then return Nothing
                else fmap Just getLine 
```

例如，

```
Main> checkFirst >>= print
qwerty
Just "werty"

Main> checkFirst >>= print
nNothing 
```

请注意，在我输入- 它`checkFirst`之后发生的事情发生了变化，它立即返回，而我没有机会输入或按 Enter 键，而如果我从它开始，它会继续运行。这种根据*值*的强度改变*所做工作*的能力是 Monad 和 Applicative 之间的主要区别，但是您可以通过运算符看到 Monad 完成了 Applicative 所做的一切。（它们都有，Applicative 调用它们，它们都有or因为它们都是 Functor。）`n``Nothing``getLine``q``getLine`**`>*>``return``pure``(<$>)``fmap`**

 **`checkFirst`您可以在 Applicative 中最接近写作的是

```
don'tCheckFirst :: IO (Maybe String)
don'tCheckFirst = check <$> getChar <*> getLine  where
   check c xs = if c == 'n' then Nothing
                else Just (c:xs) 
```

像这样工作：

```
Main> don'tCheckFirst >>= print
nI can keep typing because it has to do the getLine anyway
Nothing

Main> don'tCheckFirst >>= print
qwerty
Just "qwerty" 
```

[（注意：由于getChar 中的 Windows ghc 错误，](https://stackoverflow.com/questions/2983974/haskell-read-input-character-from-console-immediately-not-after-newline)您无法区分windows 中的 ghci`checkFirst`和in 。）`don'tCheckFirst`

## 概括

Monad 类似于 Applicative，但能够根据存在的值完全改变你正在做的事情。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-23T22:58:53.320

Haskell 中的 monad 是 Applicative plus `join`，即“扁平化” monad 的函数`join :: m (m a) -> m a`。

“应用程序”`<*>`具有类型`f (a -> b) -> f a -> f b`；如果您现在选择`b`在同一个 Functor 中的类型，即`b :: f c`类型签名专门用于`<*> :: f (a -> f c) -> f a -> f (f c)`. 当你没有一元结构时，你就完了；但是，使用 monadic`join`函数，您可以使结果变平，在与以前相同的 monad 中得到一些东西（而不是双堆叠的 monad）。**

# c# - Oauth 未授权读取请求

> ID：13533775
> 
> 赞同：0
> 
> 时间：2012-11-23T17:50:37.233
> 
> 标签：c#, .net, oauth, twitter, twitter-oauth

好的，这是代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Security.Cryptography;
using System.Net;
using System.IO;

namespace twitter_integration_v1
{
 class Program
 {
    static void Main(string[] args)
    {
        var oauth_token = "somekey";
        var oauth_token_secret = "somekey";
        var oauth_consumer_key = "somekey";
        var oauth_consumer_secret = "somekey";

        var oauth_version = "1.0";
        var oauth_signature_method = "HMAC-SHA1";
        var oauth_nonce = Convert.ToBase64String(
        new ASCIIEncoding().GetBytes(DateTime.Now.Ticks.ToString()));
        var timeSpan = DateTime.UtcNow - new DateTime(1970, 1, 1, 0, 0, 0, 0,
         DateTimeKind.Utc);
        var oauth_timestamp = Convert.ToInt64(timeSpan.TotalSeconds).ToString();
        var resource_url = "http://api.twitter.com/1/statuses/update.xml";
        //var resource_url = "http://api.twitter.com/1/statuses/home_timeline.xml";
        var status = "Another Status Update 3";

        var baseFormat = "oauth_consumer_key={0}&oauth_nonce={1}&oauth_signature_method={2}" +
            "&oauth_timestamp={3}&oauth_token={4}&oauth_version={5}&status={6}";

        var baseString = string.Format(baseFormat,
                                    oauth_consumer_key,
                                    oauth_nonce,
                                    oauth_signature_method,
                                    oauth_timestamp,
                                    oauth_token,
                                    oauth_version,
                                    Uri.EscapeDataString(status)
                                    );

        baseString = string.Concat("POST&", Uri.EscapeDataString(resource_url),
                     "&", Uri.EscapeDataString(baseString));

        var compositeKey = string.Concat(Uri.EscapeDataString(oauth_consumer_secret),
                    "&", Uri.EscapeDataString(oauth_token_secret));

        string oauth_signature;
        using (HMACSHA1 hasher = new HMACSHA1(ASCIIEncoding.ASCII.GetBytes(compositeKey)))
        {
            oauth_signature = Convert.ToBase64String(
                hasher.ComputeHash(ASCIIEncoding.ASCII.GetBytes(baseString)));
        }

        var headerFormat = "OAuth oauth_nonce=\"{0}\", oauth_signature_method=\"{1}\", " +
               "oauth_timestamp=\"{2}\", oauth_consumer_key=\"{3}\", " +
               "oauth_token=\"{4}\", oauth_signature=\"{5}\", " +
               "oauth_version=\"{6}\"";

        var authHeader = string.Format(headerFormat,
                                Uri.EscapeDataString(oauth_nonce),
                                Uri.EscapeDataString(oauth_signature_method),
                                Uri.EscapeDataString(oauth_timestamp),
                                Uri.EscapeDataString(oauth_consumer_key),
                                Uri.EscapeDataString(oauth_token),
                                Uri.EscapeDataString(oauth_signature),
                                Uri.EscapeDataString(oauth_version)
                        );

        // Requesting now

        var postBody = "status=" + Uri.EscapeDataString(status);

        ServicePointManager.Expect100Continue = false;

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(resource_url);
        request.Headers.Add("Authorization", authHeader);
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        using (Stream stream = request.GetRequestStream())
        {
            byte[] content = ASCIIEncoding.ASCII.GetBytes(postBody);
            stream.Write(content, 0, content.Length);
        }
        WebResponse response = request.GetResponse();

        Console.WriteLine("Now attempting to display homepage");

    }
 }
} 
```

好的，现在问题是上面的代码可以很好地通过 POST 编写状态更新。但是，每当我尝试使用它的变体时

```
Console.WriteLine("Attempting to read");

        //var postBody = "status=" + Uri.EscapeDataString(status);

        ServicePointManager.Expect100Continue = false;

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(resource_url);
        request.Headers.Add("Authorization", authHeader);
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        /*using (Stream stream = request.GetRequestStream())
        {
            byte[] content = ASCIIEncoding.ASCII.GetBytes(postBody);
            stream.Write(content, 0, content.Length);
        }*/

        WebResponse response = request.GetResponse(); 
```

接收状态更新它的代码只是崩溃`WebResponse response = request.GetResponse();`并发送未经授权的 401。怎么授权写不读。任何有关从哪里开始的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:09:17.397

你需要做这样的事情，你有

```
WebResponse response = request.GetResponse(); 
```

做这样的事情

```
var response = (HttpWebResponse)page.GetResponse(); 
```

# c# - ActionLinks 的 MVC 动态 routeValues

> ID：13533778
> 
> 赞同：5
> 
> 时间：2012-11-23T17:50:41.110
> 
> 标签：c#, asp.net-mvc-3, anonymous-types, routevalues

我需要使用 ActionLink 链接到我的 ViewModel A 的编辑屏幕。

A 有一个复合键，因此要链接到它，路由值必须有 3 个 pramaters，如下所示：

```
<%: Html.ActionLink("EDIT", "Action", "Controller", 
    new { area = "Admin", Id1= 1, Id2= 2, Id3= 3 })%> 
```

如您所见，路由值包含控制器 Action 将接受的 id。

我希望能够从辅助函数生成路由值，如下所示：

```
public static Object GetRouteValuesForA(A objectA)
    {
        return new
        {
            long Id1= objectA.Id1,
            long Id2= objectA.Id2,
            long Id3= objectA.Id3
        };
    } 
```

然后在 ActionLink 帮助器中使用它，但我不知道如何将该结果传递给 ActionHelper

```
objectA = new A(){Id1= objectA.Id1,Id2= objectA.Id2,Id3= objectA.Id3};
....
<%: Html.ActionLink("EDIT", "Action", "Controller", 
    new { area = "Admin", GetRouteValuesForA(objectA) })%> 
```

但这需要控制器操作来接受该匿名类型而不是 3 个属性的列表

我看到下面的链接合并了匿名类型，但是有没有其他方法可以做到这一点？ [合并匿名类型](https://stackoverflow.com/questions/6754967/merging-anonymous-types)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-23T19:04:21.627

这样的事情怎么样？

**模型：**

```
public class AViewModel
{

    public string Id1 { get; set; }
    public string Id2 { get; set; }
    public string Id3 { get; set; }

    public RouteValueDictionary GetRouteValues()
    {
        return new RouteValueDictionary( new { 
            Id1 = !String.IsNullOrEmpty(Id1) ? Id1 : String.Empty,
            Id2 = !String.IsNullOrEmpty(Id2) ? Id2 : String.Empty,
            Id3 = !String.IsNullOrEmpty(Id3) ? Id3 : String.Empty
        });
    }
} 
```

**看法：**

```
<%: Html.ActionLink("EDIT", "Action", "Controller", Model.GetRouteValues())%> 
```

您现在可以随心所欲地重复使用它们，并且只需要在一个地方进行更改。

# neo4j - 如何开发 Neo4j 数据库 Web UI

> ID：13533779
> 
> 赞同：0
> 
> 时间：2012-11-23T17:50:48.050
> 
> 标签：neo4j, graph-databases, spring-data-neo4j

我想使用[neo4j](http://neo4j.org/)数据库开发一个 Web 应用程序，我想在其中显示类似[http://blog.neo4j.org/2010/04/neo4j-rest-server-part1-get-it-going.html](http://blog.neo4j.org/2010/04/neo4j-rest-server-part1-get-it-going.html)的 UI ，

![在此处输入图像描述](../Images/c8ae7b35dede6fe43f14ee742e181c07.png)

任何人都知道如何进行。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T14:56:29.000

有很多选项，用于在 javascript 中进行可视化，例如参见 Max De Marzi 的博客：

[http://maxdemarzi.com](http://maxdemarzi.com)

我们的 Neo4j 控制台也是使用 d3.js 作为可视化和当前添加的 jquery 数据表构建的，请参阅[github 存储库](http://github.com/neo4j-contrib/rabbithole)和[test-version](http://console-test.neo4j.org)。它还可以针对嵌入式数据库和远程服务器运行（请参阅自述文件）。

# typo3 - 如何根据 FE 组对链接页面的访问来不同地设置菜单项的样式？

> ID：13533780
> 
> 赞同：0
> 
> 时间：2012-11-23T17:50:51.890
> 
> 标签：typo3, typoscript

我们的客户希望某些页面在菜单中具有不同的样式，具体取决于 FE 组访问。

这个想法是为某些仅对版主可见的菜单项提供一个小图标，以使版主清楚该页面仅对他们可用。

我确信我可以通过在 PHP 中实现逻辑来提出解决方案，但我更愿意在纯 TypoScript 中解决这个问题，以使站点的未来维护者更容易维护。

我喜欢[通过基于 UID 的 CSS 应用样式](https://stackoverflow.com/questions/11141213/typoscript-fielduid-replacement-not-working-different-css-class-per-menu-i)的想法，但从长远来看，这似乎是一个维护地狱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T11:59:34.430

您可以使用`USR`状态来应用不同的包装

```
10 = HMENU
10.1 = TMENU
10.1.wrap = <ul>|</ul>
10.NO = 1
10.NO.wrapItemAndSub = <li>|</li>
10.ACT < .NO
10.ACT.wrapItemAndSub = <li class="menu-active">|</li>
10.USR < .NO
10.USR.wrapItemAndSub = <li class="menu-user">|</li> 
```

用户和活动没有组合，因此我推荐另一种方法。

根据处理后页面的一些页面属性修改链接：

```
10.NO.wrapItemAndSub.override = <li class="menu-user">|</li>
10.NO.wrapItemAndSub.override {
  # the list of matching fe groups
  if.value = 1,3
  if.isInList.field = fe_group
} 
```

还要看看`TypoScript`条件的力量。[http://typo3.org/documentation/document-library/core-documentation/doc_core_tsref/4.7.0/view/1/5/#id553579](http://typo3.org/documentation/document-library/core-documentation/doc_core_tsref/4.7.0/view/1/5/#id553579)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:00:53.757

两步要做：

1.  仅为选定组设置`Usergroup Access Rights`这些页面（因此其他人看不到它们）
2.  如果需要，使用[TS 条件](http://typo3.org/documentation/document-library/core-documentation/doc_core_tsref/4.7.0/view/1/4/)修改 CSS/JS 或其他任何内容。

样本

```
[usergroup = 1,2]
lib.moderator_menu = HMENU
// ... etc
[end] 
```

向菜单项添加图标的最简单方法是使用 CSS：

```
<div id="main_menu">
  <a href="some-moderator-page.html" id="page_123" class="mod_link_icon">Moderators only</a>
</div> 
```

并在 css 文件中：

```
#main_menu a {
    display:block;
    padding: 5px;
}

.mod_link_icon{
    padding-left:25px;
    background: url("img/moderator_icon1_20x20.png") no-repeat left top;
} 
```

提示：您还可以使用 jQuery [.addClass()](http://api.jquery.com/addClass/)为所选用户组的元素 设置所需`mod_link_icon`的类。`#page_123`

```
<div id="main_menu">
  <a href="some-moderator-page.html" id="page_123">Moderators only</a>
</div>

<script type="text/javascript">
    // displays only when user's in 'moderator' group
    $('#page_123').addClass('mod_link_icon');
</script> 
```

# javascript - I18n 翻译 fnando

> ID：13533785
> 
> 赞同：1
> 
> 时间：2012-11-23T17:51:15.750
> 
> 标签：javascript, internationalization

我正在使用来自[https://github.com/fnando/i18n-js](https://github.com/fnando/i18n-js)的 I18n js 库。我在哪里可以找到所有文化的基本翻译（时间、日期、数字格式？）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:40:00.137

谢罗德：

我想这可以帮助你。翻译与 Ruby 兼容，但我认为您可以将其作为开始...

在这里： [https ://github.com/svenfuchs/rails-i18n/tree/master/rails/locale](https://github.com/svenfuchs/rails-i18n/tree/master/rails/locale)

# css - 悬停时如何将重叠边框放在前面？

> ID：13533786
> 
> 赞同：1
> 
> 时间：2012-11-23T17:51:15.550
> 
> 标签：css, border, overlap

我有几个 div 彼此水平排列，黑色边框为 1px。它们在左侧/右侧重叠。我不想添加边距，因为当元素彼此相邻时，这会导致边框为 2px。

当用户将鼠标悬停在边框上时，边框变为白色。问题是第二个元素（以及第一个元素之后的其他元素）的左边框隐藏在前一个元素的后面，并且左边框似乎没有改变颜色。如何使悬停的元素位于顶部？我尝试了 z-index 没有任何变化。

```
.upcoming a:before{
    display:block;
    content:'';
    position:absolute;
    width:184px;
    height:277px;
    border:1px solid #666;
}

.upcoming a:hover:before{
    border-color:#CCC;
} 
```

（我使用 :before 的原因与边框不同 - 重叠框阴影）

编辑：添加图片

在这张截图中，“秋天”海报被悬停，它也被放大了很多。请注意，左边框不是较浅的颜色（因为它与拳头边框重叠）。

![在此处输入图像描述](../Images/1773a2ab0aa4d6f354d07af1d866b611.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:58:46.387

尽管您已经尝试过，但我认为这`z-index`是最好的选择。它纯粹是为了能够管理每个元素的 z 位置而设计的。

例如，请参阅此 jsfiddle：

[http://jsfiddle.net/CjYa9/1/](http://jsfiddle.net/CjYa9/1/)

也许你在做一些不同的事情。

# android - android sqlite中的数据库未关闭错误

> ID：13533788
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:51:30.333
> 
> 标签：android, android-activity, android-sqlite

我的整个应用程序运行良好，但是当我看到 logcat 时，我可以看到这些错误消息，例如即使在我使用语句 MyDBinstance.close() 关闭数据库之后，数据库也没有关闭。为什么它们又来了？，它们对我的应用程序有害吗？

```
 11-23 23:09:03.593: E/SQLiteDatabase(30762): close() was never explicitly called on  database '/data/data/dlp.android.digichronicle/databases/widget.sqlite' 
 11-23 23:09:03.593: E/SQLiteDatabase(30762): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1943)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at  android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1007)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:986)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:962)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at dlp.android.digichronicle.DBHandandler.openDataBase(DBHandandler.java:117)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at dlp.android.digichronicle.inter.FetchingData(inter.java:95)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at dlp.android.digichronicle.inter.onCreate(inter.java:29)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.Activity.performCreate(Activity.java:4465)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.ActivityThread.access$600(ActivityThread.java:123)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.os.Handler.dispatchMessage(Handler.java:99)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at  android.os.Looper.loop(Looper.java:137)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at android.app.ActivityThread.main(ActivityThread.java:4424)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at  java.lang.reflect.Method.invokeNative(Native Method)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at java.lang.reflect.Method.invoke(Method.java:511)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
 11-23 23:09:03.593: E/SQLiteDatabase(30762):   at dalvik.system.NativeStart.main(Native Method)
 11-23 23:09:03.752: I/dalvikvm(30762): threadid=3: reacting to signal 3
 11-23 23:09:03.811: I/dalvikvm(30762): Wrote stack traces to '/data/anr/traces.txt'
 11-23 23:09:16.182: I/System.out(30762): got from accounts1.0exp1.0
 11-23 23:09:16.332: I/System.out(30762): Bundle[mParcelledData.dataSize=52] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:58:25.520

您可能希望这样做以确保始终关闭光标：

```
Cursor c = null;
try   {

   c  = somehowCreateACursor();

} finally {

    if(c != null) {
        c.close();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:28:01.643

实际上没有必要关闭数据库。即使会产生上述异常，但它永远不会以任何方式损害应用程序。

# php - 从两个表中选择 PHP

> ID：13533789
> 
> 赞同：0
> 
> 时间：2012-11-23T17:51:32.833
> 
> 标签：php, sql

这应该是一个非常简单的代码，但我想不通。基本上我想加入两个表。其中一张表包含用户的姓名，另一张表包含该用户提交的所有订单。我想要一个所有用户的列表，由提交最多订单的用户订购。这可以使用 JOIN 吗？

```
SELECT COUNT(table1.Orders)
        , table2.Name 
    FROM table1 
        LEFT JOIN table2 ON table1.IDName = table1.IDName 
ORDER BY COUNT(table1.Orders) 
```

这是我现在拥有的代码。感谢您查看此内容，我期待听到您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:56:05.893

您可能需要`GROUP BY`按降序使用和排序。你`JOIN`错了，我`table1.IDName`换成`table2.IDName`：

```
SELECT COUNT(table1.Orders) AS nb, table2.Name
FROM table1
LEFT JOIN table2 ON table1.IDName = table2.IDName
GROUP BY table.Name
ORDER BY nb DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T17:58:45.570

我的最佳猜测是您尝试将两个表连接到同一个表和字段上，如果我理解正确的话，这是没有意义的。如果只使用单个表中的字段，如何连接两个表的结果？为什么写：`table1.IDName = table1.IDName`？我相信你会写`table2.IDName = table1.IDName`的。

代替：

```
SELECT COUNT(table1.Orders)
        , table2.Name 
    FROM table1 
        LEFT JOIN table2 ON tabel1.IDName = table1.IDName 
    ORDER BY COUNT(table1.Orders) 
```

你应该写：

```
SELECT COUNT(table1.Orders)
        , table2.Name 
    FROM table1 
        LEFT JOIN table2 ON tabel2.IDName = table1.IDName 
    ORDER BY COUNT(table1.Orders) 
```

使用**Jocelyn**建议的 GROUP BY 子句也是验证的关键点。

# javascript - JavaScript 中的正则表达式 - 以开头和结尾

> ID：13533790
> 
> 赞同：1
> 
> 时间：2012-11-23T17:51:34.340
> 
> 标签：javascript, regex

例如，我想在 Javascript 中使用 RegEx 提取字符串

```
StudentName nameX = John; 
```

或者

```
StudentName nameX; 
```

我只想提取“nameX”，这是我迄今为止尝试过的。

```
var name = allName.match("StudentName(.*);|StudentName(.*)="); 
```

我得到的是： "nameX = John" ，但我没有只得到 "nameX" 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T17:53:53.870

试试这个非贪婪模式

```
var name = allName.match("StudentName\\s*(.*?)\\s*[=;]"); 
```

[JSFiddle 演示](http://jsfiddle.net/Gg9EJ/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T18:20:37.943

在里面使用正则表达式模式`match`

```
match(/StudentName\s+(\w+)/)[1] 
```

看**[这个演示](http://jsfiddle.net/Y7ZzA/)**。​​</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T17:57:19.467

如果您拆分空格，则索引 1 处的第二个匹配项应包含名称。

```
var name = allName.split(/[ ;]/g)[1]; 
```

# python - 整数分区算法 - 从 Java 转换为 Python

> ID：13533791
> 
> 赞同：0
> 
> 时间：2012-11-23T17:51:33.770
> 
> 标签：python, int

当我为了好玩而查看一堆算法时遇到了一个问题。我解决的算法（在 Java 中）要求我列出整数的所有分区。所以 4 的分区应该收到以下打印输出：

4 , 3+1, 2+2, 2+1+1, 1+1+1+1

这是我的 Java 代码：

```
 public static void partition(int n) {
        partition(n, n, "");
    }
    public static void partition(int n, int max, String prefix) {
        if (n == 0) {
            StdOut.println(prefix);
            return;
        }

        for (int i = Math.min(max, n); i >= 1; i--) {
            partition(n-i, i, prefix + " " + i);
        }
    } 
```

但是，当我尝试将我的 Java 代码转换为 Python 时，我收到“递归深度超出”错误。这里是：

```
def partition_rec(N):
    def part(N,maximum = N, prefix = ""):
        if(N==0):
            print(prefix)
            return
        for i in range(N-1):
           part(N-i,i,prefix + " " + str(i))
    return part(N) 
```

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T17:54:27.050

你已经改变了你的 for 循环。在 Java 中，它以相反的方向运行。在 python 等效项中，您正在运行它 form `0 to N - 2`。

将您的 for 循环更改为： -

```
for i in range(min(maximum, N), 0, -1): 
```

确切地说。因为，循环`n`是`1`.

`-1`是步长值，它反向运行范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:55:35.520

当我更改您的代码以匹配 Java 版本时，它适用于我：

```
def partition_rec(N):
    def part(N,maximum = N, prefix = ""):
        if(N==0):
            print(prefix)
            return
        for i in range(min(maximum, N), 0, -1): # changed this line
           part(N-i,i,prefix + " " + str(i))
    return part(N)

partition_rec(4) 
```

# c# - Stream Insight - 基于事件类型的过滤器

> ID：13533795
> 
> 赞同：0
> 
> 时间：2012-11-23T17:51:58.933
> 
> 标签：c#, streaminsight

所以我对 Stream Insight 相当陌生，这可能是一个相当基本的问题，但似乎不支持按事件类型过滤查询（见下文），那么应该如何完成呢？

为了充实我的问题，这是我的 CepStream ......

```
var stockStream = CepStream<MarketDataPoint>.Create(appName, typeof(MarketdataPointInputAdapterFactory), new MarketDataAdapterConfig(), EventShape.Point); 
```

..这是我的查询...

```
var patternResult = from w in stockStream.Where(x => x is FxSpot)
                                            .AlterEventDuration(e => TimeSpan.FromMinutes(1))
                                            .SnapshotWindow(SnapshotWindowOutputPolicy.Clip)
                                        select new MarketDataPointEvent() {Price = w.Max(e => e.Price)}; 
```

...运行时产生此异常： *Microsoft 复杂事件处理 LINQ 提供程序不支持以下表达式：（x 是 FxSpot）*

据我了解，我可以创建多个适配器而不是有效地执行过滤器，但这似乎不是它“应该”完成的方式。

任何建议将不胜感激！

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T00:59:59.397

我会尽量远离 is 运算符进行类型比较。这是一个使用 LINQPad 的示例，我强烈推荐使用它。在这种情况下，过滤器由库存完成。使用 CTI 自动插入

```
AdvanceTimeSettings.IncreasingStartTime 
```

> 样本

```
void Main()     
{

    var marketReadings = new []
                    {
                    new MarketDataPoint() { Stock = "MSFT", Value = 30.0, Timestamp = DateTime.Parse("11/19/2012 4:10:00 PM") },
                    new MarketDataPoint() { Stock = "MSFT", Value = 30.1, Timestamp = DateTime.Parse("11/19/2012 4:11:00 PM") },
                    new MarketDataPoint() { Stock = "GOOG", Value = 667.97, Timestamp = DateTime.Parse("11/19/2012 4:12:00 PM") },
                    new MarketDataPoint() { Stock = "GOOG", Value = 667.51, Timestamp = DateTime.Parse("11/19/2012 4:12:00 PM") },
                };

            var stockStream = marketReadings.ToPointStream(Application, e=> PointEvent.CreateInsert(e.Timestamp,e),AdvanceTimeSettings.IncreasingStartTime);  

            var patternResult = from w in stockStream.Where(x => x.Stock == "MSFT")
                                                    .AlterEventDuration(e => TimeSpan.FromMinutes(1))
                                                    .SnapshotWindow(SnapshotWindowOutputPolicy.Clip)
                                                select new  {Price = w.Max(e => e.Value)}   ;

            patternResult.Dump();   
        }

        public class MarketDataPoint
        {
            public string Stock { get; set; }
            public double Value { get; set; }
            public DateTime Timestamp { get;set;}

        }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T02:40:27.200

您定义的负载类型是 MarketDataPoint。这定义了事件的架构并根据[事件结构](http://msdn.microsoft.com/en-us/library/ee378905%28v=sql.111%29.aspx)：“StreamInsight 服务器中的事件是字段的有序列表，而不是 .NET 结构，它不会对其字段施加顺序。”

您尝试完成的一个潜在解决方法是在包含 FxSpot 的 MarketDataPoint 中包含所有需要的字段。然后向 MarketDataPoint 添加一个附加属性来定义它是什么类型的 MarketDataPoint。

# macos - 复制 Mac com.apple.ResourceFork 扩展属性导致“参数列表太长”

> ID：13533796
> 
> 赞同：4
> 
> 时间：2012-11-23T17:51:59.817
> 
> 标签：macos, shell, command-line, xattr, file-forks

我正在尝试使用 OSX“xattr”实用程序将扩展属性从一个文件复制到另一个文件。背景是我们正在构建一个备份工具，文件/结构必须保留所有属性、ACL 等……除了资源分叉等大属性外，一切正常。使用下面的方法，小属性可以正常工作。在 OS X 10.7.5 上尝试这个是我正在做的：

首先，我使用“ls -l@”识别文件的属性。结果如下：

```
-rwxrwxrwx@ 1 testuser  staff        0  3 Jan  2011 File
        com.apple.FinderInfo         32 
        com.apple.ResourceFork   237246 
```

现在我导出属性（com.apple.ResourceFork 是导致问题的原因之一）：

```
xattr -px com.apple.ResourceFork File > attribfile 
```

我现在想使用以下命令将此属性应用于另一台 Mac 上的文件副本：

```
xattr -wx com.apple.ResourceFork "`cat attribfile`" File 
```

这导致：

```
-bash: /usr/bin/xattr: Argument list too long 
```

我想我知道它为什么会发生……资源分叉数据太长了，不适合争论。我还没有确定它开始突破的阈值，但我怀疑它与 ARG_MAX 有关。xargs 在这里没有帮助，因为它不是几个较小的参数，而是一个非常大的参数。

这么多问题：

1.  有没有办法让 xattr 接受这个大值？以某种方式通过标准输入将其输入？手册页没有显示它，但我不是专家，也许有一些创造性的方法可以做到这一点
2.  谁能告诉我使用常用​​命令行工具应用大型扩展属性的正确方法？
3.  如果没有库存命令行工具，对 3rd 方工具有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T22:24:28.663

我不知道如何使用`xattr`，但是您可以使用一个旧的文件系统技巧。注意：这基本上已经过时了，但在 10.8.2 中仍然有效；我对 10.8.3 等不做任何承诺。如果属性文件是十六进制格式，请使用：

```
xxd -r -p attribfile >File/..namedfork/rsrc 
```

如果 attribfile 是原始文件，请使用`cat`而不是`xxd -r -p`. 如果属性不是资源分叉，...我不知道。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-22T02:56:41.250

接受的答案对我不起作用，所以我继续并找到了另一个解决方案，我在这里发布以防其他人需要它。

我的问题是将 vlc-2.1.4 复制到 /Applications 文件夹。它一直在说：

```
The Finder can’t complete the operation because some data in “VLC” can’t be read or written.
(Error code -36) 
```

如果我尝试`cp`在终端中使用 a ，我会收到此线程中指示的错误。

所以我所做的是在控制台中执行以下命令（总结我`tar`的 VLC 并将其解压缩到它的目的地，所以......它作为一个`cp`）：

```
cd /Volumes/vlc-2.1.4/
tar cf /Applications/vlc.tar  VLC.app
cd /Applications/
tar xf vlc.tar 
rm vlc.tar 
```

我希望这对其他有同样问题的人有用。

# inheritance - 引用子类实例变量

> ID：13533797
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:52:05.777
> 
> 标签：inheritance

```
public abstract class Vehicle {

       public void drive(){
          spinTheWheels(subclass.getNumWheels());
       }

       public void spinTheWheels(int wheelsTotal){
          ....
       }
}

public class Car extends Vehicle {
     private final int numWheels = 4;

    ...
} 
```

在上面的示例中，我想在车辆内引用来自 Car 的 numWheels。这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:12:55.317

这是不可能的。基类永远不知道子类里面有什么，主要是因为它不知道它是从哪里继承的。这是因为继承也应该起作用。子类应该添加或修改基类的行为，并且基类应该包含所需的基本行为和属性。

编辑：添加内容以澄清 OP 的评论。

如果您希望基类具有轮数的方法，则很可能需要知道成员属性或称为 NumberOfWheels 的变量的存在。在这种情况下，您需要在基类 Vehicle 中声明它。您将无法在派生类中声明此变量并在基类中使用它。

我可以看到你在这里有两个选择，

1.  在基类中，使您的 GetNumberOfWheels 方法抽象或虚拟，并强制派生类使用它。在这种情况下，您的派生类可能有也可能没有变量，但将被迫实现此方法。例如，您的派生类之一可能是 HoverCraft，它没有许多 wheel 变量。GetNumberOfWheels 方法可以根据您的实现需要返回 0 或引发异常。
2.  我更喜欢这个，因为这是一种更清洁的方式。您可以拥有一个接口，该接口具有车轮数属性和 GetNumberOfWheels 方法。强制您的子类实现这一点。然后，每个派生类都可以提供自己的属性和方法实现，您可以根据需要使用它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-23T17:56:48.507

那是不可能的，您只能使用“super”关键字从子类中引用超类的变量，反之亦然。超类永远不知道它的子类。

# http - MIME 和内容类型之间有区别吗？

> ID：13533801
> 
> 赞同：22
> 
> 时间：2012-11-23T17:52:31.397
> 
> 标签：http, smtp, mime, smime, rfc822

在 ie 上使用 f12 工具时，当我请求网页时，响应标头具有内容类型。这也可以称为MIME类型吗？还是有区别？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T16:04:47.727

**严格来说**MIME 和内容类型是两个不同的东西。MIME 是一组标准，旨在扩展电子邮件消息的功能，此后更广泛地应用于 Internet 内容和 HTTP。内容类型是在电子邮件消息和 HTTP 中都使用的标头。

**然而，实际上**，内容类型和 MIME 类型可以互换使用。

**回答您的问题**：在您的上下文中，没有区别。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T18:03:58.400

“Content-Type”是 HTTP 标头字段的名称。字段值的正确技术术语是“（Internet）媒体类型”（它曾经是“MIME 类型”，但由于 HTTP != MIME 不再正确）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-05T09:36:12.493

Content-Type 是 HTTP 消息头键，其值（通常）是 MIME 类型。可能重复[mediatype、contenttype 和 mimetype 有什么区别？](https://stackoverflow.com/questions/9258108/whats-the-difference-between-mediatype-contenttype-and-mimetype/9277778)

# ios - 如何从子队列中保存父 NSManangedObjectContext？

> ID：13533808
> 
> 赞同：1
> 
> 时间：2012-11-23T17:53:14.793
> 
> 标签：ios, core-data

我有以下设置：

```
NSManagedObjectContext *parent = [[NSManagedObjectContext alloc] 
                            initWithConcurrencyType:NSMainQueueConcurrencyType];
// other setup for parent

NSManagedObjectContext *child = [[NSManagedObjectContext alloc] 
                          initWithConcurrencyType:NSPrivateQueueConcurrencyType];
[child setParentContext:parent]; 
```

我想要的是在孩子保存时保存父母，所以目前我做这样的事情：

```
[child performBlock^{
      [child save:nil];
      [parent performBlock:^{
          [parent save:nil];
      }
}]; 
```

那是我的安全，并在上下文自己的队列中调用 save 。那有必要吗？我可以这样做：

```
[child performBlock^{
     [child save:nil];
     [parent save:nil];
}]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:44:15.350

不，您不能使用第二种变体。您将在`save`与子上下文关联的队列上执行父上下文的操作，而不是在主队列上。

这意味着该`save`操作将在（可能）与主线程不同的线程上执行，这是不允许的，因为托管对象上下文不是线程安全的。

另请参阅*OS X v10.7 和 iOS 5.0* 的核心数据发行说明中[对托管对象上下文的并发支持](http://developer.apple.com/library/mac/#releasenotes/DataManagement/RN-CoreData/_index.html#//apple_ref/doc/uid/TP40010637-CH1-DontLinkElementID_1)：

 *> 您可以结合使用基于队列的并发类型和两种新方法来使用上下文：`performBlock:`和 `performBlockAndWait:`. ... 一个例外是：如果您的代码在主线程上执行，您可以直接在主队列样式上下文中调用方法，而不是使用基于块的 API。
> 
> `performBlock:`并`performBlockAndWait:`确保在为上下文指定的队列上执行块操作。...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:24:06.013

您需要调用主上下文以保存在自己的队列中，我假设您将主队列用于父上下文，这样您就可以这样做；

```
[child performBlock^{
     [child save:nil];
     [parent performSelectorOnMainThread:@selectorr(save:) withObject:nil waitUntilDone:NO];
}]; 
```

此代码将确保您的父 managedObjectContxt 将始终保存在主线程中。而且我认为将主上下文始终放在主线程上是一个好主意，这样可以很容易地在不同线程之间进行同步。*

# html - 如何将样式类设置为另一个类取决于选择器？

> ID：13533811
> 
> 赞同：1
> 
> 时间：2012-11-23T17:53:37.883
> 
> 标签：html, css

所以我有 CSS 样式

```
.style-a {

}

.style-b {

} 
```

现在我想让我的元素在悬停或悬停时具有不同的样式。伪喜欢：

```
.my-class {
  .style-a here
}

.my-class:hover {
  .style-b here
} 
```

我无法更改`style-a`and`style-b`因为许多其他元素都依赖于这两个元素，并且更改它们会很麻烦。如何在不更改且不使用 JavaScript 的情况下实现此`style-a`功能`style-b`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:04:03.430

你为什么不创建这样的东西：

```
.my-class {
  /*common elements here*/
}
.style-a {
 /*style-a elements*/
}
.style-b {
     /*style-b elements*/
}
.my-class .style-a {

}

.my-class .style-b {

} 
```

我认为这样你就可以为你需要的类设置样式而无需更改它们，并且你将它们设置为子类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:55:05.077

这在 CSS 中是不可能的。

但是您可以使用[lesscss](http://lesscss.org/)并将lesscss 文件编译成CSS 文件。

它被称为[混合](http://lesscss.org/#-mixins)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:13:37.477

Sass 的 @extend 指令是您正在寻找的：

SCSS：

```
.style-a {
  // common styles
}

.style-b {
  // common styles
}

.my-class {
  @extend .style-a;
}

.my-class:hover {
  @extend .style-b;
} 
```

CSS：

```
.style-a, .my-class {
  // common styles
}

.style-b, .my-class:hover {
  // common styles
} 
```

没有 JS，没有其他解决方案，没有复制/粘贴，向标记添加额外的类，或者修改原始样式以添加额外的选择器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T17:59:22.367

如果`.style-a`和`.style-b`都是 的子级`.my-class`，则可以使用：

```
.my-class .style-a {
    // style here
}

.my-class:hover .style-b {
    // style here
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T17:59:50.920

用纯 CSS 做你所描述的事情是不可能的。我可以想到两个没有 Javascript 的选项：

1.  使用[SASS/SCSS](http://sass-lang.com/#extend)`@extend`的特性
2.  `style-a`从和复制并粘贴所有规则`style-b`

# google-apps-script - 如何居中元素谷歌应用脚 本 UiApp

> ID：13533812
> 
> 赞同：2
> 
> 时间：2012-11-23T17:53:38.790
> 
> 标签：google-apps-script

我正在创建一个带有图像的简单应用程序。我像这样创建应用程序：

```
function createApplication(){
  var app = UiApp.createApplication().setTitle("My Simple App");
  mainImage = app.createImage("URL TO IMAGE");
  app.add(mainImage);
  return(app);
} 
```

这会将图像放在屏幕的左上角。有人可以告诉我如何使图像居中吗？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-15T11:31:58.443

我刚刚找到了另一种不错的方法。

默认情况下，面板会缩小以完全适合其内容。这很好，因为所有小部件都彼此非常接近。所以我们在这里所做的，我们添加一个 fullPanel - 填充整个浏览器区域。然后添加我们应用程序的 mainPanel，并在其中放置我们需要的任何小部件。

```
+--fullPanel-----------------+
|                            |
|                            |
|       +-mainPanel--+       |
|       |            |       |
|       |            |       |
|       +------------+       |
|                            |
|                            |
+----------------------------+ 
```

结果？

*   mainPanel 中的所有小部件都彼此完美对齐
*   mainPanel 始终位于中心

有代码：

```
function createApplication(){
  var app = UiApp.createApplication().setTitle("My Simple App");

  /* Main application Panel */
  var mainPanel = myApp.createVerticalPanel();

  /* Add any widgets to this Panel */
  mainImage = app.createImage("URL TO IMAGE");
  mainPanel.add(mainImage);

  /* Create a panel that will fill all area of browser */
  var fullPanel = myApp.createVerticalPanel();
  fullPanel.setHeight('100%');
  fullPanel.setWidth('100%');
  fullPanel.setHorizontalAlignment(UiApp.HorizontalAlignment.CENTER);
  fullPanel.setVerticalAlignment(UiApp.VerticalAlignment.MIDDLE);
  fullPanel.add(mainPanel);

  app.add(fullPanel);
  return(app);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T22:43:23.817

您可以使用`setStyleAttribute()`并参考一些[CSS 文档](http://www.w3schools.com/css/css_positioning.asp)

例如尝试这样（我真的不是 CSS 专家，所以如果它不优雅，请不要怪我;-)

```
function testImage(){
  var app = UiApp.createApplication().setTitle("My Simple App").setHeight('700').setWidth('900');
  mainImage = app.createImage("https://dl.dropbox.com/u/211279/Time-change-clock_animated_TR80.gif")
  .setStyleAttribute('position','relative').setStyleAttribute('left','50%').setStyleAttribute('top','50%')
  app.add(mainImage);
  ss=SpreadsheetApp.getActive()
  ss.show(app)
} 
```

注意：*您还可以使用 PX(pixels) 而不是 % 来定位图像，并且正如您所注意到的，我在电子表格 UI 中对此进行了测试。*

* * *

**编辑：**这是一个使用像素和 Bryan 对 CSS 样式的建议的版本，更紧凑，语法接近原始 CSS 方法（再次感谢）：

```
var _imgCSS = {'position':'relative', 'left':'200PX', 'top':'200PX'}

function testImage(){
      var app = UiApp.createApplication().setTitle("My Simple App").setHeight('500').setWidth('500');
      var mainImage = app.createImage("https://dl.dropbox.com/u/211279/Time-change-clock_animated_TR80.gif")
      .setStyleAttributes(_imgCSS)
      app.add(mainImage);
      ss=SpreadsheetApp.getActive()
      ss.show(app)
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T14:57:13.693

您可以使用指向图像的 Google Drive 链接。确保图像在网络上是公开的，并获取文档 ID。如果共享链接如下：https://docs.google.com/file/d/[docID]/edit?usp=sharing

图片的直接链接是 https://googledrive.com/host/[docID]/

或者，如果文件夹是公共的，ID 为 folderID，您可以使用 https://googledrive.com/host/[folderID]/myimage.gif

# javascript - Javascript/jquery .click() 不触发函数

> ID：13533816
> 
> 赞同：2
> 
> 时间：2012-11-23T17:53:52.237
> 
> 标签：javascript, jquery, dynamic, click

我有一个表格，其中一些功能在点击每行中的链接时触发：

代码的相关部分是：

```
$('.my_table').inplacerowedit({
     url: myurl,
    }); 
```

在 inplacerowedit.js 文件中，我有：

```
(function($) {
    $.fn.inplacerowedit = function(options) {
        var ops = $.extend({}, $.fn.inplacerowedit.defaults, options);
        $(this).find(ops.editbuttonselector).on('click', function(e) {
    ... }

ops.editbuttonselector = 'a.edit' 
```

我的表格每行都有一个编辑链接，它通常工作正常。我的问题是新创建的行。

这是我创建行并将其添加到表中的方式：

```
 new_row = null

    getNewRow = function() {
        if (new_row == null){
            new_row = $("<tr>");
            columns = {'name':'','type':'','value':'','edit':'','delete':''}
            for (var column in columns)
                new_row.append( $("<td>").addClass(column).text(columns[column]));
            links = ['edit','delete']
            for (var i=0;i<links.length;i++){
                link = links[i]
                a = $("<a href='"+link+"' class='"+link+"'>").text(link);
                new_row.find("."+link).append(a)
            }
        }
        return new_row
    };

    $("#addRowAndEdit").click(function(e){
        e.preventDefault();
           var row = getNewRow();
           $(".my_table").append(row);
           new_record = $('.my_table tbody>tr:last');
           new_record.find('a.edit').click(); //this is the line that is not working.
           ....
    } 
```

更新：

如果我这样做`new_record.find('a.edit').on('click', alert('ok'));`了，警报功能会起作用，但不会调用另一个。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:58:14.307

使用[事件委托](http://api.jquery.com/on/#direct-and-delegated-events)，以便您新添加的行由附加到表的处理程序处理，而不是将其附加到每个单独的`a`元素，为此，请替换以下行`inplacerowedit.js`：

```
$(this).find(ops.editbuttonselector).on('click', function(e) { 
```

对于这个：

```
$(this).on('click', ops.editbuttonselector, function(e) { 
```

已编辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T20:38:30.400

我必须进行 2 处更改：一个由 nelson 建议（出于某种原因，我第一次尝试他的建议时，它破坏了现有链接），另一个是这样的：new_record.find('a.edit')[0 ]。点击（）

[我在https://stackoverflow.com/a/12110482/210481](https://stackoverflow.com/a/12110482/210481)找到了答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T19:01:43.090

如果您使用的是 1.6+ 的最新 jquery 版本，那么您应该尝试以下操作：

```
new_record.find('a.edit').live('click',function(){
    // All your desired stuff here
}); 
```

试试看这是否适合你。

`Just because you are dynamically creating the rows`，对于这种情况`.live()`事件处理程序很有用。

你可以在这里找到更多信息：http: [//api.jquery.com/live/](http://api.jquery.com/live/)

# windows - x:用于 Windows 8 项目的 Uid 生成器

> ID：13533820
> 
> 赞同：3
> 
> 时间：2012-11-23T17:54:02.957
> 
> 标签：windows, xaml, localization, windows-8, winrt-xaml

Microsoft 的多语言应用工具包是一个相当不错的 Windows 8 (WinRT) 本地化工具包。MAT 的问题是您需要在您希望在项目的所有 XAML 文件中本地化的任何控件中放置一个特殊的 x:Uid 属性。

有人知道一些允许将 x:Uid 自动添加到 XAML 元素的实用程序吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T23:05:43.180

看看[http://devtools.korzh.com/applocalizer](http://devtools.korzh.com/applocalizer)。它被宣布为免费。
该工具本身旨在用于 .NET 应用程序本地化。但它包含一个完成这项工作的向导。
您只需要添加您的 WinRT 项目（文件 -> 新建项目）并选择“文件 -> 生成 x:Uid's”菜单项。然后按照说明进行操作。

# eclipse - Spring项目的Glassfish 404错误

> ID：13533823
> 
> 赞同：1
> 
> 时间：2012-11-23T17:54:22.617
> 
> 标签：eclipse, spring, spring-mvc, glassfish, http-status-code-404

我有与**Eclipse Helios集成的****Glassfish3**服务器

 **我已经通过右键单击服务器使用添加和删除将我的示例 Spring 项目添加到服务器。

当我跑`http://localhost:8080/SpringHibernateJSFTest/insertJdbcContact.do`

我正进入（状态`description The requested resource () is not available.`

如何解决此错误？我究竟做错了什么？

非常感谢任何帮助。

我的`controller class`

```
 @Controller
public class JBTJdbcController {
    @Autowired
    com.service.SpringJdbcService mfssService;
    @RequestMapping(value = "/insertJdbcContact", method = RequestMethod.GET)
    public ModelAndView insertMemDtls() {
        ModelAndView mav = new ModelAndView("JdbcInsert");
        VngMem mfssbean = new VngMem();
        mav.addObject("insertUser", mfssbean);
        mav.addObject("status", "success");
        return mav;
    }
    @RequestMapping(value = "/insertJdbcContact", method = RequestMethod.POST)
    public ModelAndView insertContact(
            @ModelAttribute("insertUser") VngMem vngmem) {
        ModelAndView mav = new ModelAndView("JdbcInsert");
        try {
            mfssService.insertMfssMemDts(vngmem);
        } catch (Exception e) {
            e.printStackTrace();
        }
        mav.addObject("searchResultPost", vngmem);
        return mav;
    }
} 
```

这是**web.xml**

```
<display-name>SpringHibernateJSFTest</display-name>
    <display-name>SpringMVC</display-name>
    <welcome-file-list>
        <welcome-file>welcome.do</welcome-file>
    </welcome-file-list>
    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.do</url-pattern>
    </servlet-mapping>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:applicationContext.xml</param-value>
    </context-param>
</web-app> 
```

我的**applicationContext.xml**

```
<context:annotation-config />
<context:component-scan base-package="com.controller,com.beans" />
<mvc:annotation-driven />
  <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver"/>
        <property name="url" value="jdbc:oracle:thin:@server:1521:orcl"/>
        <property name="username" value="scott"/>
        <property name="password" value="tiger"/>

    </bean>
<bean id="SpringJdbcDao"  class="com.dao.SpringJdbcDaoImpl">
  <property name="dataSource" ref="dataSource"/>
</bean>
  <bean id="SpringJdbcService"  class="com.service.SpringJdbcServiceImpl">
  <property name="springJdbcDao" ref="SpringJdbcDao"/>
</bean>
</beans> 
```

我的**调度程序-servlet.xml**

```
 <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
                <property name="prefix" value="/WEB-INF/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>
</beans> 
```

我`JdbcInsert.jsp`有`/WebContent/WEB-INF`

更新 1

```
cannot Deploy SpringHibernateJSFTest
Deployment Error for module: SpringHibernateJSFTest: Exception while loading the app :
java.lang.Exception: java.lang.IllegalStateException: ContainerBase.addChild: start: 
org.apache.catalina.LifecycleException: 
org.springframework.beans.factory.BeanDefinitionStoreException: 
IOException parsing XML document from class path resource [applicationContext.xml];
 nested exception is java.io.FileNotFoundException: class path resource 
 [applicationContext.xml] cannot be opened because it does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:57:46.263

你应该搬家：

```
 <context:component-scan base-package="com.controller,com.beans" />
    <mvc:annotation-driven /> 
```

到`dispatcher-servlet.xml`.``

 ``In your `dispacher-servlet.xml` the id of your InternalResourceViewResolver bean should be `internalResourceViewResolver`, like bellow:` 

```
 <bean id="internalResourceViewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
            <property name="prefix" value="/WEB-INF/jsp/"/>
    <property name="suffix" value=".jsp"/>
</bean> 
```` 

`And your jsp files should be in /WEB-INF/jsp/`目录。

感谢和快乐的编码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T19:15:24.957

您`ViewResolver`使用`/WEB-INF/jsp/`前缀，而`JdbcInsert.jsp`位于 中时`/WEB-INF`，您应该将前缀更正为`"/WEB-INF/"`

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
                <property name="prefix" value="/WEB-INF/"/>
        <property name="suffix" value=".jsp"/>
    </bean> 
```

**更新**您已`<mvc:annotation-driven />`在根[应用程序上下文中声明，而不是在 Dispatcher Servlet 上下文](https://stackoverflow.com/questions/3652090/difference-between-applicationcontext-and-spring-servlet-xml-in-spring)中声明，这可能会导致一些问题，例如`viewResolver`从根应用程序上下文中实际上是不可见的。

您的 mvc 配置应该驻留在调度程序 servlet 上下文中。**

# c++ - C++ << 用 ostream 重载以获得正确的格式

> ID：13533829
> 
> 赞同：1
> 
> 时间：2012-11-23T17:54:52.907
> 
> 标签：c++, overloading, ostream

我已经开始编写自己的链接列表，它可以很好地打印数字，但我使用模板来确定用于对象的类型名。因此，除了打印对象外，我输入数据没有任何问题。这些类出现以下错误，但 Visual Studio 2010 没有给出行号。我要做的就是允许从链接列表中以正确的格式输出不同类型的对象。

```
error LNK2005: "class std::basic_ostream<char,struct std::char_traits<char> > &
__cdecl operator<<(class std::basic_ostream<char,struct std::char_traits<char> > &,
class Customer &)" (??6@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@std@@AAV01@AAVCustomer@@@Z)
already defined in Customer.obj 
```

桂班

```
//Templates
#include "LinkList.h"
#include "Node.h"

//Classes
#include "Gui.h"
#include "Customer.h"

//Libaries
#include <iostream>

//Namespaces
using namespace std;

int main(){
    Customer c1("TempFirst", "TempLast");
    LinkList<Customer> customerList;
    customerList.insert(c1);

    //Print Linklist
    customerList.print();
    system("pause");
    return 0;
} 
```

客户类

```
//Def
#pragma once

//Included Libaries
#include <string>
#include <iostream>
class Customer
{
private:
    std::string firstName;
    std::string lastName;
public:
    Customer();
    Customer(std::string sFirstName, std::string sLastName);
    ~Customer(void);

    //Get Methods
    std::string getFirstName();
    std::string getLastName();

    //Set Methods
    void setFirstName(std::string sFirstname);
    void setLastName(std::string sLastname);

    //Print
};

std::ostream& operator << (std::ostream& output, Customer& customer)
{
    output << "First Name: " << customer.getFirstName() << " "
        << "Last Name: " << customer.getLastName() << std::endl;
    return output;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T17:59:04.807

小心将函数定义放在头文件中。您需要内联定义，或者更好的是，将其放入`.cpp`文件中。只`Customer.h`放一个函数原型：

```
// Customer.h
std::ostream& operator << (std::ostream& output, Customer& customer); 
```

并将完整的定义放入`Customer.cpp`：

```
// Customer.cpp
std::ostream& operator << (std::ostream& output, Customer& customer)
{
    output << "First Name: " << customer.getFirstName() << " "
           << "Last Name: "  << customer.getLastName()  << std::endl;
    return output;
} 
```

或者，如果您真的想要头文件中的定义，请添加`inline`关键字。内联定义必须放在头文件中，并且就其性质而言，它们没有外部链接，也不会触发重复的定义错误。

```
inline std::ostream& operator << (std::ostream& output, Customer& customer)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:01:40.067

您没有得到行号，因为直到链接时间才检测到错误，并且链接器看不到任何源代码。问题是您已将函数定义放在标题中；仅当函数是函数模板或已声明时，这才是合法的 `inline`。通常的过程是只在头文件中放置一个声明，并将定义与类成员函数定义放在同一个源文件中。

# zend-framework - Zend 2 + Dojo 文档…

> ID：13533834
> 
> 赞同：1
> 
> 时间：2012-11-23T17:55:19.740
> 
> 标签：zend-framework, dojo

我开始使用 Zend 2 + Dojo。我找不到从这些开始的教程，我只找到有关 Zend 1.9 的博客，而且 Zend_Dojo 官方文档很差。这里有任何帮助或好的链接吗？:)

很多！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T05:09:28.857

在这种情况下，您的“问题”是，Dojo 框架包含在 Zend Framework 1.x 中，并带有一些 ViewHelpers、Form-Elements 等。

在 Zend Framework 2 中，不包括 Dojo。就像没有 Zend 框架一样使用 Dojo :-)

# ant - AIR Android 原生扩展，包括 ASdoc？

> ID：13533836
> 
> 赞同：0
> 
> 时间：2012-11-23T17:55:28.283
> 
> 标签：ant, air, air-native-extension, asdoc

我正在使用 AIR for Android 制作本机扩展，但在启动应用程序时出现以下错误：（编译 .ane 或应用程序时没有错误）

[项目名称]\com.adobe.flexide.multiplatform.android.platform\zbar.ane 不是有效的本机扩展文件。

但我仅在尝试在我的 Android 设备上运行该应用程序并且 .ane 中有 ASDoc 注释时收到此错误。带有 ASDoc 注释的项目在模拟器上运行时可以完美运行。当我使用 AIR 3.1 和 AIR 3.5 beta 进行编译时，错误仍然存​​在。

这是我的蚂蚁构建文件：

```
<project name="test" default="build-all" basedir=".">
<property name="FLEX_HOME" value="C:\Program Files (x86)\Adobe\Adobe Flash Builder 4.6\sdks\4.6.0+AIR35beta" />
<property name="BUILDDIR" value="./builddir" />
<property name="BASEDIR" value="." />

<taskdef name="compc" classname="flex.ant.CompcTask" classpath="${FLEX_HOME}/ant/lib/flexTasks.jar" />
<taskdef name="asdoc" classname="flex.ant.AsDocTask" classpath="${FLEX_HOME}/ant/lib/flexTasks.jar" />

<target name="compile-flex" description="Compile AndroidCameraANE.swc">
    <compc output="${BUILDDIR}/AndroidCameraANE.swc" locale="en_US"
           optimize="true" strict="true" as3="true" warnings="true"
           static-link-runtime-shared-libraries="true">
        <load-config filename="${FLEX_HOME}/frameworks/air-config.xml"/>
        <source-path path-element="${BASEDIR}/actionscript/src"/>
        <include-sources dir="${BASEDIR}/actionscript/src" includes="*"/>
    </compc>
</target>

<target name="copy-files" description="copy Java, Flex, extension.xml files to the build dir" >
    <copy todir="${BUILDDIR}/android/libs/armeabi">
        <fileset dir="${BASEDIR}/java/libs/armeabi" />
    </copy>

    <copy todir="${BUILDDIR}/android/libs/armeabi-v7a">
        <fileset dir="${BASEDIR}/java/libs/armeabi-v7a" />
    </copy>

    <copy todir="${BUILDDIR}/android/libs/x86">
        <fileset dir="${BASEDIR}/java/libs/x86" />
    </copy>

    <copy file="${BASEDIR}/java/bin/zbarane.jar" todir="${BUILDDIR}/android/"/>

    <copy file="${BASEDIR}/actionscript/extension.xml" todir="${BUILDDIR}/"/>
</target>

<target name="unzipAndroidANE" description="unzip library.swf from AndroidCameraANE.swc" >
    <unzip src="${BUILDDIR}/AndroidCameraANE.swc" dest="${BUILDDIR}/android">
        <patternset><include name="library.swf"/></patternset>
    </unzip>
    <unzip src="${BUILDDIR}/AndroidCameraANE.swc" dest="${BUILDDIR}/default">
        <patternset><include name="library.swf"/></patternset>
    </unzip>
</target>

<target name="build-ane" >
    <exec executable="${FLEX_HOME}/bin/adt.bat" failonerror="true" dir="${BUILDDIR}">
        <arg line="-package -target ane zbar.ane extension.xml -swc AndroidCameraANE.swc -platform Android-ARM -C android . -platform default -C default ."/>
     </exec>
</target>

<target name="doc" description="updates ane with asdoc. On Android it generates invalid ane file!">
    <asdoc output="${BUILDDIR}/tempDoc" lenient="true" failonerror="true" 
            keep-xml="true" skip-xsl="true" fork="true">
        <load-config filename="${FLEX_HOME}/frameworks/air-config.xml"/>
        <doc-sources path-element="${BASEDIR}/actionscript/src/com/blogspot/visualscripts/zbar/Zbar.as"/> 
    </asdoc>
    <zip destfile="${BUILDDIR}/zbar.ane" update="true">
        <zipfileset dir="${BUILDDIR}/tempDoc/tempdita" prefix="docs">
            <include name="*.*"/>
            <exclude name="ASDoc_Config.xml"/>
            <exclude name="overviews.xml"/>
        </zipfileset>
    </zip>
</target>
<!-- build order is important -->
<target name="build-all">
    <delete dir="${BUILDDIR}" />
    <antcall target="compile-flex" />
    <antcall target="copy-files" />
    <antcall target="unzipAndroidANE" />
    <antcall target="build-ane" />
    <antcall target="doc" />  <!--Makes invalid file on Android! -->
    <delete includeEmptyDirs="true">  
        <fileset dir="${BUILDDIR}">  
            <include name="*/**" />
            <exclude name="zbar.ane" /> 
        </fileset>  
    </delete>
</target>
</project> 
```

有没有人设法为 Android 构建了一个内置 ASdoc 的 .ANE？

# javascript - 由于重定向，Greasemonkey 脚本在提交表单后停止执行

> ID：13533838
> 
> 赞同：1
> 
> 时间：2012-11-23T17:55:32.417
> 
> 标签：javascript, forms, greasemonkey

我正在尝试编写一个油脂猴脚本，该脚本将在允许您查看成熟游戏内容之前自动执行 Steam 商店年龄检查。

我的问题是提交表单后，网站会自动重定向到新页面，而其余的greasemonkey脚本没有机会执行：

```
// ==UserScript==
// @name        agecheck
// @include     http://store.steampowered.com/agecheck/*
// @version     1.17
// @modified    11/23/2012
// @grant       GM_xmlhttpRequest
// ==/UserScript==

//Mini script for doing steam age checks automatically (used when scraping steam sites)
if (/agecheck/i.test (location.pathname) ) {
    var ageForm = document.querySelector ("#agegate_box form");
    ageForm.querySelector ("[name='ageDay']").value     = 18;
    ageForm.querySelector ("[name='ageMonth']").value   = 'August';
    ageForm.querySelector ("[name='ageYear']").value    = 1987;
    ageForm.submit();
    setTimeout( function(){ window.close(); }, 10000); //Never gets to run
} 
```

为了验证代码是否有效，如果我只是注释掉该`ageForm.submit();`语句，则选项卡会在 10 秒后根据需要关闭。

提交表单后如何关闭窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:42:03.817

您可以创建一个不可见的 iframe 并将表单的*目标*属性设置为指向该 iframe。因此页面位置不会改变。[这个](https://stackoverflow.com/questions/168455/how-do-you-post-to-an-iframe)问题就是一个例子。

如果你想要一个纯 JS 解决方案，你可以检查[这个](https://stackoverflow.com/questions/11534690/how-to-do-a-jquery-callback-after-form-submit)问题，因为它解释了如何向 submit() 方法添加回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:08:18.620

我已经使用以下代码解决了这个问题，该代码将表单提交的结果加载到隐藏的框架中，而不是允许表单更改当前窗口位置（这正在停止greasemonkey脚本）：

```
if (/agecheck/i.test (location.pathname) ) {
    var ageForm = document.querySelector ("#agegate_box form");
    ageForm.querySelector ("[name='ageDay']").value     = 18;
    ageForm.querySelector ("[name='ageMonth']").value   = 'August';
    ageForm.querySelector ("[name='ageYear']").value    = 1987;

    var newFrame = document.createElement('frame');
    newFrame.name = "PostResult"
    document.body.appendChild(newFrame);
    ageForm.target = newFrame.name;

    ageForm.submit();
    setTimeout( function(){ window.close(); }, 10000);
} 
```

感谢 G. Kayaalp 的提示。

# objective-c - 在 C/C++ 中使用 THIS->

> ID：13533842
> 
> 赞同：-6
> 
> 时间：2012-11-23T17:55:50.410
> 
> 标签：objective-c, c

我正在阅读有关 iphone 音频的教程，它使用 C/C++。我不熟悉 THIS-> 的使用。它似乎指的是指向全局变量的指针。这是教程 - [iPhone Core Audio 第 3 部分 - 音频回调](http://timbolstad.com/2010/03/17/core-audio-getting-started-pt3/)。

我试图理解的语句是语句的 THIS-> 部分：

```
// Pass in a reference to the phase value, you have to keep track of this
// so that the sin resumes right where the last call left off
float phase = THIS->sinPhase; 
```

该教程表明 THIS-> 用于获取访问 AudioController 变量的方法。sinPhase 似乎是全局变量。

请解释为什么创建“相位”引用而不是直接引用全局变量“sinPhase”。请记住，我是一个客观的 C 编程人员，试图理解这个 C/C++ 代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T18:08:17.803

在这个例子中，`THIS`不是对全局变量的引用；它在上面的函数中定义为 void 指针的强制转换`inRefCon`：

```
static OSStatus renderInput(void *inRefCon, AudioUnitRenderActionFlags *ioActionFlags, const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, UInt32 inNumberFrames, AudioBufferList *ioData)
{
    // Get a reference to the object that was passed with the callback
    // In this case, the AudioController passed itself so
    // that you can access its data.
    AudioController *THIS = (AudioController*)inRefCon; 
```

这是 C 中相当常见的模式。为了将回调传递给某些 API，以便它稍后可以调用您的代码，您需要同时传递一个函数指针和一个 void 指针。void 指针包含函数指针需要操作的任何数据。在您的回调中，您需要将其转换回指向实际类型的指针，以便您可以访问其中的数据。在这种情况下，示例的作者命名了强制转换指针`THIS`，可能是为了使它看起来更面向对象，尽管这只是 C 语言并且`THIS`没有特殊含义。

您问他们为什么将其分配给局部变量而不是`THIS->sinPhase`到处使用。没有理由不能`THIS->sinPhase`在任何地方使用；他们可能只是将其分配给局部变量`phase`以节省打字时间。优化器在局部变量上比在通过指针传入的变量上做得更好的可能性很小，因为它可以对局部变量做出更多假设（特别是，它可以假设没有其他人在同时）。因此，使用局部变量循环可能会运行得稍微快一些，但如果不进行测试我不能确定；最可能的原因只是为了节省打字并使代码更具可读性。

下面是一个简单的例子，说明这样的回调 API 是如何工作的；希望这能让我们更容易理解回调 API 的工作原理，而无需同时尝试理解 Core Audio 中发生的其他事情。假设我想编写一个函数，将回调应用于整数 10 次。我可能会写：

```
int do_ten_times(int input, int (*callback)(int)) {
    int value = input;
    for (int i = 0; i < 10; ++i) {
        value = callback(value);
    }
    return value;
} 
```

现在我可以用不同的函数来调用它，如下所示`add_one()`或`times_two()`：

```
int add_one(int x) {
    return x + 1;
}

int times_two(int x) {
    return x * 2;
}

result = do_ten_times(1, add_one);
result = do_ten_times(1, times_two); 
```

但是假设我希望能够添加或乘以不同的数字；我可以尝试为每个要相加或相乘的数字编写一个函数，但是如果代码中没有固定数字，而是基于输入，那么您就会遇到问题。您不能为每个可能的数字编写一个函数；您将需要传入一个值。所以让我们为回调添加一个值，并将`do_ten_times()`该值传入：

```
int do_ten_times(int input, int (*callback)(int, int), int data) {
    int value = input;
    for (int i = 0; i < 10; ++i) {
        value = callback(value, data);
    }
    return value;
}

int add(int x, int increment) {
    return x + increment;
}

int times(int x, int multiplier) {
    return x * multiplier;
}

result = do_ten_times(1, add, 3);
result = do_ten_times(1, times, 4); 
```

但是，如果有人想编写一个随整数以外的变量变化的函数怎么办？例如，如果您想编写一个根据输入是负数还是正数添加不同数字的函数怎么办？现在我们需要传入两个值。同样，我们可以扩展我们的接口以传入两个值；但是我们最终需要传入更多的值，不同类型的值等等。我们注意到它`do_ten_times`并不关心我们传入的值的类型；它只需要将它传递给回调，回调可以根据需要对其进行解释。我们可以使用 void 指针来实现这一点；然后回调将该 void 指针转换为适当的类型以获取值：

```
int do_ten_times(int input, int (*callback)(int, void *), void *data) {
    int value = input;
    for (int i = 0; i < 10; ++i) {
        value = callback(value, data);
    }
    return value;
}

int add(int x, void *data) {
    int increment = *(int *)data;
    return x + increment;
}

int times(int x, void *data) {
    int multiplier = *(int *)data;
    return x * multiplier;
}

struct pos_neg {
    int pos;
    int neg;
};
int add_pos_neg(int x, void *data) {
    struct pos_neg *increments = (struct pos_neg *)data;
    if (x >= 0)
        return x + increments->pos;
    else
        return x + increments->neg;
}

int i = 3;
result = do_ten_times(1, add, &i);
int m = 4;
result = do_ten_times(1, times, &m);
struct pos_neg pn = { 2, -2 };
result = do_ten_times(-1, add_pos_neg, &pn); 
```

当然，这些都是玩具示例。在 Core Audio 案例中，回调用于生成音频数据的缓冲区；每次音频系统需要生成更多数据以保持流畅播放时都会调用它。通过 传递的信息`void *inRefCon`用于跟踪您在当前缓冲区中到达正弦波的确切位置，因此下一个缓冲区可以从最后一个缓冲区停止的地方开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T18:07:39.423

如果它没有在范围内声明（即在该上下文中声明的局部变量），我看到两个选项：

*   要么它是一个定义，它实际上是指实例：`#define THIS this`。
*   正如你所建议的，要么是一个全局变量。

`THIS`在 C++ 中没有任何内在含义，所以它也可以。不管是哪一种，**都太可怕了**。

它被复制到不同变量中的原因，如果它是一个全局变量，而不是直接使用，可能是为了清楚起见，也可能是为了不意外地修改它。

# c++ - 使用预处理器指令进行测试单元的相关性

> ID：13533846
> 
> 赞同：0
> 
> 时间：2012-11-23T17:56:06.610
> 
> 标签：c++, debugging, preprocessor-directive

我正在使用 Boost 单元测试`BOOST_AUTO_TEST_CASE` 它需要删除`main()`函数来执行测试用例。问题是应该使用哪些指令在 Normal/UnitTest 模式之间切换？我有适用于 Windows 和 Unix 的跨平台应用程序。

我只有一个建议：使用类似`#ifndef TESTING`in`main.cpp`并使用手动更改`#define TESTING`线？

有没有更好的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:07:24.167

单元测试应该进入一个*单独*的翻译单元。如果您有`foo.hpp`并且`foo.cpp`对于您的库，您有类似`foo_test.cpp`单元测试的东西。然后，您的构建环境将知道构建和运行这些测试的新“测试”目标。

# javascript - 访问对象属性内的数组

> ID：13533847
> 
> 赞同：-1
> 
> 时间：2012-11-23T17:56:08.497
> 
> 标签：javascript

我有一个需要迭代的对象，它是这样构建的：

```
points[m] = {
   coordinate1: 34,
   coordinate2: 23,
   code: ["LEM"],
   location: '123 fake street'
} 
```

如果当前点(point[m]) 匹配另一个点，我想将 points[m].code 添加到它匹配的点，以构建一个唯一的对象数组，如下所示：

```
pointsUnique[l].code.push(point[m].code[0]); 
```

这很好用，除了当我尝试像这样迭代 (pointsUnique[l].code) 时：

```
 for(var n=0;n<pointsUnique[l].code.length;n++){
    var codeList = pointsUnique[l].code[n];
    console.log(codeList);
 } 
```

我只在代码数组中得到 1 结果，因为 (pointsUnique[l].code.length) 显然是 1。虽然当我在控制台中查看它时它有 15 个项目。

对于如何访问 (pointsUnique[l].code) 的所有值的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:00:48.020

你的逻辑对我来说看起来不错，所以可能发生了其他事情。你在复制/粘贴你的真实代码吗？首先，您在这里有一个错字：

`pointsUnique[l].code.push(point[m].code[0]);`

应该`points[m]`不是`point[m]`。

还有，这个神秘的`l`变量是什么？这也可能是一个问题，尽管无法从您发布的代码中得知。

# ssl - ASIHTTP 请求：如何处理 SSL 证书

> ID：13533848
> 
> 赞同：2
> 
> 时间：2012-11-23T17:56:13.493
> 
> 标签：ssl, asihttprequest, nsstream, cfnetwork, cfstream

我在我的项目中使用 ASIHTTP，我需要支持带或不带客户端证书的 SSL 连接。在我看来，在 SSL 握手期间可能有四种情况：

*   案例 A：服务器提供一个受信任的证书，但不要求客户端提供一个（例如[https://www.gmail.com](https://www.gmail.com)，...）

*   案例 B：服务器提供一个自签名证书，但不要求客户端提供一个（例如[https://www.cacert.org/images/cacert4.png](https://www.cacert.org/images/cacert4.png)）

*   案例 C：服务器提供一个受信任的证书并要求客户端提供一个

*   案例 D：服务器提供一个自签名证书并要求客户端提供一个

ASIHTTP 毫无问题地支持案例 A。

案例 C 也受支持，但我必须在开始请求之前提供 SecIdentityRef：

```
[request setClientCertificateIdentity:identity]; 
```

不支持其他情况（没有完全关闭 CFStream 级别的证书验证，我不想这样做）。

对我来说，我希望 ASIHTTP 的正常行为是向代表询问案例 B、C 和 D。对于案例 B 和 D，应要求代表信任或不信任服务器证书（就像在 Web 浏览器中完成的那样） . 对于案例 C 和 D，还应要求代表提供证书。

ASIHTTP 基于 CFStream 连接。有没有办法配置 CFStream 以便它从案例 B、C 和 D 返回不同的错误？然后，检测这些错误并使用正确的回调通知委托？

谢谢你的帮助。

# java - 如何在 android 中创建视频 url 的缩略图？

> ID：13533857
> 
> 赞同：11
> 
> 时间：2012-11-23T17:56:36.170
> 
> 标签：java, android, image

我有一个问题，我只能创建本地视频文件的缩略图，但不能创建远程 url，这是我的代码：

```
bmThumbnail = ThumbnailUtils.extractThumbnail(ThumbnailUtils.createVideoThumbnail("http://download.blender.org/peach/bigbuckbunny_movies/BigBuckBunny_320x180.mp4", MediaStore.Video.Thumbnails.MINI_KIND), 50, 50); 
```

我希望你能帮帮我，

问候基督徒

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T18:14:07.930

我想如果没有在本地实际下载视频，就没有简单的方法来构建缩略图。

因此，如果您的问题是“我可以在不下载完整视频的情况下获得缩略图吗？”，我会说......不。

否则，一旦您在本地下载了视频，那么我想您可以`ThumbnailUtils.createVideoThumbnail(...)`通过提供下载文件的路径来完美使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T10:59:04.197

我也有同样的问题 - 但我能从我的测试中说些什么：

1.  该问题仅出现在 android >2.3
2.  在 android 2.0 -> 2.3 你可以只使用

`Bitmap thumbnail = ThumbnailUtils.createVideoThumbnail( videoUrl, MediaStore.Video.Thumbnails.MINI_KIND);`

我希望有人解释 android 4 上的变化。它不起作用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T15:00:09.857

使用以下代码从远程视频生成缩略图没有问题：

`final Bitmap thumbnail = ThumbnailUtils.createVideoThumbnail( videoUrl, MediaStore.Video.Thumbnails.MINI_KIND );`

您不必`extractThumbnail()`围绕它进行调用

# .net - 在多个开发团队之间共享 .net 程序集

> ID：13533860
> 
> 赞同：1
> 
> 时间：2012-11-23T17:56:42.700
> 
> 标签：.net

我正在寻找在多个开发团队（不在同一个办公室/存储库中）之间共享 .net 程序集（都处于持续开发阶段）的最合适的解决方案。

第一个团队已经开发并打包了许多有用的通用功能，称为`core.dll`他们在许多应用程序和库中引用（作为 VS 项目）的程序集。该程序集又引用了非常标准的程序集，例如（`system.dll`等）加上`log4net.dll`（作为其存储库中的第三方）：

*   核心.dll
    *   系统.dll
    *   ...
    *   Log4Net.dll

在我这边，我开发了一个更高级别的程序集`Library.dll`，我真的很想将开发的东西合并到其中`Core.dll`而不是维护重复的代码：

*   库.dll
    *   系统.dll
    *   ...
    *   Log4Net.dll <-- 我也在使用 Log4Net！
    *   *Core.dll* <--- 我想用它替换我的自制代码

最后，第一个团队反过来对我的代码感兴趣以开发他们自己的应用程序：

*   应用程序.exe
    *   系统.dll
    *   ...
    *   Log4Net.dll
    *   *核心.dll*
    *   *库.dll*

在两个开发团队之间保持松散耦合看起来很糟糕：

*   首先，我可能不会使用与 in 相同的版本（`Log4Net.dll`至少我们可以同意使用相同的版本或不针对特定版本，因为这个第三方非常稳定）`Library.dll``Core.dll`

*   其次，当我重新整合我`Library.dll`时，`Application.dll`我可能一直在使用不同的版本，`Core.dll`因为他们将不断地让它进化。

目前我正在考虑保持我们团队之间的松散耦合是让他们为我提供隐藏的“log4net”参考，如下所示：

```
// Create a single assembly hiding for Log4Net
ILMerge /out:DCore.dll Core.dll Log4Net.dll /internalize 
```

我自己也这样做：

```
// Create a single assembly hiding for Log4Net and Core
ILMerge /out:DLibrary.dll Library.dll DCore.dll Log4Net.dll /internalize 
```

我不知道这个解决方案是否合适，任何其他保留我们两个团队相互联系的解决方案都受到热烈欢迎。

NB1：我不认为将库部署到 GAC 是一个好的解决方案，因为两者`Core.dll`都`Library.dll`处于持续开发阶段，并且缓存会随着太多无用的并行发布而增长。

NB2：我已阅读此[线程](https://stackoverflow.com/q/1422899/684399)，但我对 NuGet 以及它是否适合此处了解不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:05:38.877

就我个人而言，我认为 NuGet 将在管理包、它的依赖项和版本控制方面帮助你很多。NuGet 与所有主要 CI 服务器和 Visual Studio 完美集成。可以在 NuGet 文档中找到更多信息：

[http://docs.nuget.org/docs/Creating-Packages/Hosting-Your-Own-NuGet-Feeds](http://docs.nuget.org/docs/Creating-Packages/Hosting-Your-Own-NuGet-Feeds)

您可以在以下博客文章中阅读有关 NuGet 如何处理程序集版本控制的更多信息： [http ://blog.davidebbo.com/2011/01/nuget-versioning-part-1-taking-on-dll.html](http://blog.davidebbo.com/2011/01/nuget-versioning-part-1-taking-on-dll.html)

# css - Div 高度百分比，父高度的一半

> ID：13533869
> 
> 赞同：0
> 
> 时间：2012-11-23T17:58:05.687
> 
> 标签：css

我有两个并排显示的 div，左侧 div 是`20%`宽度，右侧是`80%`宽度。

现在左 div 包含水平调整大小的图像，因此它的高度是未知的并且不断变化。

现在，当这个 div 调整父级高度的大小增加或减少时，当发生这种情况时，我需要我的右 div 来调整大小，我该怎么做？

[**jsFiddle**](http://jsfiddle.net/UJYyw/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:07:34.963

您可以尝试属性`table-cell`上的 CSS3 值：http: [//jsfiddle.net/UJYyw/5/](http://jsfiddle.net/UJYyw/5/)`display`

和

```
<div class="container">
    <div class="one"></div>
    <div class="two"></div>
</div> 
```

你只需要`table-cell`在`div.one`和`div.two`

```
.one, .two{
    display:table-cell;
} 
```

兼容的浏览器会以它们在标签上`td`的方式调整元素的高度。`th`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:11:30.697

您可以使用 jQuery 来执行此操作。

```
$('.container').css({'height':$('.one').height()});​ 
```

[在这里看到一个 jsFiddle](http://jsfiddle.net/UJYyw/6/)

当您更改`.one`css 中的值时，它会更新 的大小，因此也会`.container`更新`.two`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:19:11.750

这是只使用浮点数和几个包装器的跨浏览器解决方案[http://jsfiddle.net/RSPbD/](http://jsfiddle.net/RSPbD/)

**HTML**

```
<div class="container">
    <div class="wrap1">
        <div class="wrap2">
            <div class="one">text in div one</div>
            <div class="two">text in div two</div>
            <div class="clear"></div>
        </div>
    </div>
</div>​ 
```

**CSS：**

```
.container{
    border:1px solid;
    width:70%;
    margin:50px;
    padding:10px;
}

.wrap1 {
    width: 25%;
    background: red;
    position: relative;
    left: 7%;
}

.wrap2 {
    width: 200%;
    position: relative;
    left: 100%;
    margin:0 -200% 0 0;
    background: blue;
}

.one{
    float: left;
    width: 50%;
    margin-right: -100%;
    position: relative;
    left: -50%;
}

.two {
}

.clear {
    clear: both;
    font-size: 0;
    overflow: hidden;
} 
```

# ruby-on-rails - 我应该使用哪个版本的 ruby 和 rails 启动我的应用程序？

> ID：13533870
> 
> 赞同：1
> 
> 时间：2012-11-23T17:58:07.303
> 
> 标签：ruby-on-rails, ruby

我想开始开发一个新的应用程序，但我对使用哪个版本的 ruby​​ 和 rails 感到困惑。请任何人推荐具有良好文档并与大多数 gem 兼容的 ruby​​ 和 rails 稳定版本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T18:06:50.193

请参考 [Rails 指南](http://guides.rubyonrails.org/getting_started.html)

它是最好的起点。

[从http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)开始

还有这个[教程](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

你会知道如何前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T18:03:10.790

要么弄清楚你将在哪里托管你的应用程序以及它们提供的内容，*要么*使用最新的 Ruby/Rails 版本进行构建，然后寻找支持这些版本的主机。

# scala - 构造函数参数的约束

> ID：13533877
> 
> 赞同：1
> 
> 时间：2012-11-23T17:58:52.387
> 
> 标签：scala, parameters, constraints

对不起，但我是 Scala 的新手。我有一个抽象类和一个从抽象类继承并实现其字段的具体类。

```
abstract class Element {
  var name: String
  var description: String
}

class ConcreteElement (var name: String, var description: String)extends Element 
```

这是正确的吗？是的？我有许多从抽象类 Element 继承的类。现在我想检查变量名称，我只想根据某些约束实例化名称。我把这个控件放在哪里？显然在抽象类Element中。

在 Scala 中，变量声明 var x:T 等价于声明一个 getter 函数 x 和一个 setter 函数 x_=，定义如下：

```
def x: T
def x_= (y: T): Unit 
```

所以我决定以这种方式声明变量，并将我的约束放在 getter 方法名称中。

```
abstract class Element {    
def name: String
def name_= (y: String): Unit = {CONSTRAINT}

var description: String
} 
```

类 ConcreteElement（变量名称：字符串，变量描述：字符串）扩展元素

这个推理正确吗？ConcreteElement 居然实现了 Element 的字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:29:14.613

`def name_=`只有当它没有被子类覆盖时，你的作品才有效。所以我想你需要`final`防止它被覆盖。

```
abstract class Element {
  protected var _name: String
  final def name: String = _name
  final def name_= (value: String) {
    if (isBadValue(value)) throw new IllegalArgumentException
    _name = value
  }
  var description: String
}
class ConcreteElement (protected var _name: String, var description: String) extends Element 
```

# java - Java 泛型在 Eclipse 中编译，但在 javac 中不编译

> ID：13533880
> 
> 赞同：15
> 
> 时间：2012-11-23T17:59:09.167
> 
> 标签：java, eclipse, generics, compiler-construction, javac

我不得不发现我的项目中有 Java 代码，它在 Eclipse 中编译和运行良好，但在 javac 中引发编译错误。

一个独立的片段：

```
import java.util.HashSet;
import java.util.Set;

public class Main {

    public static void main(String[] args) {
    Set<Integer> setOfInts = new HashSet<Integer>();
    Set<Object> setOfObjects = covariantSet(setOfInts);
    }

    public static <S, T extends S> Set<S> covariantSet(Set<T> set) {
    return new HashSet<S>(set);
    }

} 
```

javac 中的编译返回：

```
Main.java:10: incompatible types
found   : java.util.Set<java.lang.Integer>
required: java.util.Set<java.lang.Object>
    Set<Object> setOfObjects = covariantSet(setOfInts);
                                           ^ 
```

此错误现在阻止在 Maven 中构建项目。由于 Eclipse 编译器被构建为更宽容，我现在不得不假设上面的代码片段的定义和使用静态方法是无效的 Java？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-23T18:19:59.860

Sun 的 1.6 JDK 似乎无法推断出正确的类型。以下似乎适用于我的机器：

```
Set<Object> setOfObjects = Main.<Object, Integer>covariantSet(setOfInts); 
```

请注意，您必须调用[以类名为前缀的静态方法](https://stackoverflow.com/q/590405/315306)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-23T18:06:39.067

你说的对。这个问题确实存在。Eclipse 不使用`javac`. 它使用自己的编译器。

实际上 javac 是“正确的”。泛型是擦除。类型`S`不包含在您的字节码中，因此 jvm 在运行时没有关于返回类型的足够信息。为了解决这个问题，改变方法原型如下：

`public static <S, T extends S> Set<S> covariantSet(Set<T> set, Class<S> returnType)`

现在返回类型在运行时传递给方法，编译器不应该抱怨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:03:21.543

在您的 Maven 构建脚本中，您已经设置了编译器版本。

在 Ant 中它看起来像这样：

```
<property name="source.version" value="1.5" /> 
```

搜索 1.3 或 1.4，或编译以在 maven 脚本中找到该值

值为 1.5 时，编译器将接受泛型（请参阅您的错误消息）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-18T14:35:28.173

我知道这是个老问题，但我想提一下，函数可以写成：

```
import java.util.HashSet;
import java.util.Set;

public class Main {

public static void main(String[] args) {
        Set<Integer> setOfInts = new HashSet<Integer>();
        Set<Object> setOfObjects = covariantSet(setOfInts);
    }

    public static <S> Set<S> covariantSet(Set<? extends S> set) {
        return new HashSet<S>(set);
    }

} 
```

它有点干净，您可以完全按照您的意图使用该功能（使用隐式通用类型）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-23T18:13:04.937

将下一个插件添加到您的 pom.xml：

```
<plugin>
     <artifactId>maven-compiler-plugin</artifactId>
     <version>2.3.2</version>
     <configuration>
          <source>1.6</source>
          <target>1.6</target>
     </configuration>
</plugin> 
```

# jquery-plugins - 优化数据输入的控件

> ID：13533882
> 
> 赞同：0
> 
> 时间：2012-11-23T17:59:19.143
> 
> 标签：jquery-plugins, input, html.dropdownlistfor

我正在寻找一个解决方案

*   显示多列独立数据
*   不需要单击（或聚焦）来显示列表
*   有一个简单的界面
*   支持可见和隐藏值（如 HTML 的`<select>`）
*   具有颜色突出显示以显示匹配项
*   自动删除不在任何选项中的字符条目

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:59:19.143

我找不到满足这些要求的控件，所以我创建了一个。这是正在使用的控件的图像。

![例子](../Images/61cbefe249a6280f50c72b696547f31f.png)

创建这个控件的代码是：

```
$('input#scrolltest').menuoptions({                                         
    "Data": { 1:"January",2:"February",3:"March",4:"April",5:"May", 6:"June",7:"July",
              8:"August",9:"September",10:"October",11:"November",12:"December" },
    "onSelect": function(mo, data) {                                        
         console.log(mo, data.newVal, data.type );                          
    },                                                                      
    "InitialValue": { 'val': 'December'},                                   
    "Height": 200,                                                          
    "Sort": []                                                              
}); 
```

此控件记录[在此处](http://www.menuoptions.org/)

上面的例子是这个[演示页面的一部分](http://www.menuoptions.org/examples/QuickStartSelect.html)

# php - PHP Ajax - 没有数据传输到函数

> ID：13533896
> 
> 赞同：0
> 
> 时间：2012-11-23T18:00:20.933
> 
> 标签：php, javascript, ajax

从 index.html 使用表单我收到 null 到 function.php。

index.html - 带有输入的表单。

manager.php - 从表单中获取值并将其发送到 function.php 中的适当函数。

function.js - 获取数据的 ajax。

我的功能停止

```
 while($row = $result->fetchRow())
{

    $title = $row[0];
    echo '<tr><td>' . $title .'</td>';
} 
```

因为找到零行并且什么也不显示。

sql select - 数据库的工作结构 - [https://www.dropbox.com/s/6cnnxb933yl11og/1.png](https://www.dropbox.com/s/6cnnxb933yl11og/1.png)

索引.HTML

```
<script src="functions.js"> </script>
<style>
table, table td { border: 1px solid #666; }
</style>
</head>

<body>
    <form name="films" action="manager.php" method="POST">
        <select name="type">
            <option>Genre</option>
            <option>Actor</option>
            <option>Date</option>
        </select>

        <input type="text" name="search">
        <input type="text" name="additional">
        <input type="submit" value="Submite" onclick="getGoodsBy()">
        <input type="reset">
    </form>

<div id="result"></div> 
```

管理器.php

```
 <?php
    require_once 'functions.php';

    $type = $_POST['type'];
    $search = $_POST['search'];
    $additional = $_POST['additional'];

    if ($type == 'Genre')
    getGoodsByGenre($search);
    if ($type == 'Actor')
    getGoodsByActor($search);
    if ($type == 'Date')
    getGoodsByDate($search, $additional);
    ?> 
```

函数.php

```
 <?php
    require_once 'DB.php';
    require_once 'manager.php';

    $user = 'root';
    $pass = '';
    $host = 'localhost';
    $db_name = 'lab2';
    $dsn = "mysql://$user:$pass@$host/$db_name";

    function getGoodsByGenre($genre)
    {
global $user;
global $pass;
global $host;
global $db_name;
global $dsn;
$db = DB::connect($dsn, true);

if (DB::isError($db)) {
    die ($db->getMessage());

}

$sql = "SELECT a.name as name 
    FROM film as a
    INNER JOIN film_genre as b ON b.FID_Film=a.ID_FILM
    WHERE b.FID_Genre='".$_POST['genre']."'";

$result = $db->query($sql);
echo '<table>';

while($row = $result->fetchRow())
{

    $title = $row[0];
    echo '<tr><td>' . $title .'</td>';
}
echo '</table>';

$db->disconnect();

}

    function getGoodsByActor($actor)
    {
global $user;
global $pass;
global $host;
global $db_name;
global $dsn;

$db = DB::connect($dsn, true);

if (DB::isError($db)) {
    die ($db->getMessage());
}
$sql = "SELECT a.name as name 
    FROM film as a
    INNER JOIN film_actor as b ON b.FID_FILM=a.ID_FILM
    WHERE b.FID_Actor =".$_POST['actor']."";

$result = $db->query($sql);

echo '<table>';
while($row = $result->fetchRow())
{
    $name = $row[0];

    echo '<tr><td>' . $name .'<td>' ;
}
echo '</table>';
$db->disconnect();
    }

    function getGoodsDate($startDate, $endDate)
    {
global $user;
global $pass;
global $host;
global $db_name;
global $dsn;

$db = DB::connect($dsn, true);

if (DB::isError($db)) {
    die ($db->getMessage());
}

$sql = "SELECT a.name as name 
    FROM film as a
    WHERE a.date >= ".$_POST['startDate']." and a.date                         <=".$_POST['endDate']."";

$result = $db->query($sql);

echo '<table>';
while($row = $result->fetchRow())
{
    $date = $row[0];

    echo '<tr><td>' . $date . '<td>';
}
echo '</table>';
$db->disconnect();
    }
    ?> 
```

函数.js

```
 function createHttpRequest()
    {
var httpRequest;

if (window.XMLHttpRequest) 
{
    httpRequest = new XMLHttpRequest();
    if (httpRequest.overrideMimeType)
        httpRequest.overrideMimeType('text/xml');
} 
else if (window.ActiveXObject)
{
    try {
        httpRequest = new ActiveXObject("Msxml2.XMLHTTP");
    } 
    catch (e) {
        try {
            httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
        } 
        catch (e) {}
    }
}

if (!httpRequest) 
{
    alert('Cannot create XMLHTTP instance');
    return null;
}
    return httpRequest;
    }

    function showResult(httpRequest)
    {
try 
{
    if (httpRequest.readyState == 4) 
    {
        if (httpRequest.status == 200)
        {
            var result = document.getElementById('result');
            result.innerHTML = httpRequest.responseText;
        }
        else 
        {
            alert('There was a problem with the request.');
        }
    }
}
catch( e ) 
{
    alert('Caught exception: ' + e.description);
}
    }

    function getGoodsBy()
    {
var type = document.forms['films'].type.value;
var search = document.forms['films'].search.value;
var additional = document.forms['films'].additional.value;
var params = encodeURI('type=' + type + '&search=' + search + '&additional=' + additional);

var httpRequest = createHttpRequest();
httpRequest.open('POST', 'manager.php', true);

httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");    
httpRequest.onreadystatechange = function() { showResult(httpRequest); };
httpRequest.send(params);
    } 
```

PS：我不能使用 jquery 或其他东西。只是带有 javascript ajax 的 PHP - 没有插件、模组或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:11:26.640

1.问题是您`$_POST['genre']`在查询中使用，但它应该使用`$genre`您传递的参数值。

2.`$genre = $_POST['search'];`从`getGoodsByGenre`功能中移除

3.你在其他功能上也有同样的问题

# php - 需要使用 php 发送异步 url 请求并知道所需的时间

> ID：13533897
> 
> 赞同：0
> 
> 时间：2012-11-23T18:00:24.447
> 
> 标签：php, curl, asynchronous

我在云中有一个数据库，我需要知道服务器在什么时间和请求的数量会崩溃，所以我想到了使用 php 发送异步请求，然后找到为每个请求提供服务所需的时间。我对如何进行有点困惑，我不确定 cURL 是否在这里有用。只是如何进行的布局将有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:02:32.583

```
ab -n 1000 -c 10 http://yourserver.com/ 
```

-n 请求数 -c 并发

还有其他工具可以对服务器进行基准测试

ab 是 apache 工具的一部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:04:21.950

使用[siege](http://www.joedog.org/siege-home/)或[Apache 基准测试](http://httpd.apache.org/docs/2.2/programs/ab.html)工具通过调用单个或多个 url 对您的服务器进行负载测试，您可以增加并发性、对服务器的请求量。siege 将为您提供请求和并发性的详细报告以及您的服务器性能如何，您甚至可以从多个其他服务器调用您的单个服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T10:36:37.050

这意味着服务器负载很重，即所有线程都忙于为请求提供服务。解决方案：要么增加 server.xml 文件中连接器的 maxThread 属性计数，要么增加 acceptCount 属性值。

acceptcount ：当所有可能的请求处理线程都在使用时，传入连接请求的最大队列长度。队列已满时收到的任何请求都将被拒绝。

# css - Susy列和断点乱序列表？

> ID：13533898
> 
> 赞同：0
> 
> 时间：2012-11-23T18:00:32.917
> 
> 标签：css, sass, media-queries

我正在使用 Susy 及其断点来执行一些媒体查询布局，但我遇到了一个奇怪的问题，即`<li>`所有内容的顺序不同，这很奇怪。

在此处检查案例（**警告 NSFW**）：[http](http://cl.ly/L6Xf) ://cl.ly/L6Xf和此处[http://cl.ly/L6cd](http://cl.ly/L6cd)

```
// Grid
.page
  +container
  +susy-grid-background

// Profiles
#profiles
  ul
    margin-top: 2.5em
    li
      height: 160px
      +span-columns(5)
      &:nth-child(2n)
        +omega         
      margin-bottom: 2.2em
      border: 5px solid $white
      overflow: hidden
      img
        width: auto
        height: 100% 
      span
        background: $white
        padding: 5px 10px
        position: absolute

+at-breakpoint(30em 12)
  #profiles ul li
    +span-columns(4, 12)
    &:nth-child(3n)
      +omega 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T22:25:35.787

在您的新断点处，您需要先从 2n 中删除 omega，然后再将其添加到 3n。否则，您在 2n 和 3n 上都设置了 omega `li`。

```
+at-breakpoint(30em 12)
  #profiles ul li
    +remove-nth-omega(2n)
    +span-columns(4, 12)
    +nth-omega(3n) 
```

# android - Cordova GCM 插件错误

> ID：13533900
> 
> 赞同：0
> 
> 时间：2012-11-23T18:00:42.007
> 
> 标签：android, push-notification, cordova, phonegap-plugins

我使用在这里找到的c​​ordova插件：[https](https://github.com/marknutter/GCM-Cordova) ://github.com/marknutter/GCM-Cordova将推送通知包含到我的phonegab android应用程序中。该插件适用于提供的 android 项目，但是当我尝试将包导入我的项目时出现错误。

我按照自述文件中的所有说明进行操作，但在以下位置出现错误：

```
public GCMIntentService() {
super("GCMIntentService"); 
```

}

它说构造函数 GCMBaseIntentService(String) 未定义。

我是原生 android 的菜鸟，因此我使用 phonegab (lol)。那么有人知道为什么会这样吗？

我在日食顺便说一句

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T18:14:06.510

您是否按照[此处](http://developer.android.com/guide/google/gcm/gs.html#android-app)定义的第一步进行操作。

> 第 1 步：将 gcm.jar 文件复制到您的应用程序类路径中
> 
> 要编写您的 Android 应用程序，首先将 gcm.jar 文件从 SDK 的 gcm-client/dist 目录复制到您的应用程序类路径。

还有[这个](http://developer.android.com/guide/google/gcm/gs.html#libs)安装 gcm 库的步骤：

> 安装帮助程序库
> 
> 要执行以下部分中描述的步骤，您必须首先安装帮助程序库（参考：客户端和服务器）。在 SDK 管理器中，安装 Extras > Google Cloud Messaging for Android Library。这会在 YOUR_SDK_ROOT/extras/google/ 下创建一个 gcm 目录，其中包含以下子目录：gcm-client、gcm-server、samples/gcm-demo-client、samples/gcm-demo-server 和 samples/gcm-demo-appengine。
> 
> 注意：如果您在 SDK 管理器中没有看到 Extras > Google Cloud Messaging for Android Library，请确保您运行的是版本 20 或更高版本。请务必在更新后重新启动 SDK Manager。

编辑1：

如果您正在运行这个 na 模拟器，那么您需要遵循 GCM-Cordova [lib readme.md中给出的以下说明](https://github.com/marknutter/GCM-Cordova)

> **笔记和陷阱**
> 
> 如果您使用模拟器运行此演示，您将不会收到来自 GCM 的通知。您需要在实际设备上运行它以接收消息或在您的模拟器上安装适当的库（您可以在标题为“安装帮助程序库和设置模拟器”的部分下按照本指南进行操作）
> 
> 如果一切正常并且您没有收到来自 Google 的注册 ID 响应，请尝试卸载并重新安装您的应用程序。这对那里的一些开发人员有用。

# android - 从嵌套类引用 TextView 对象

> ID：13533901
> 
> 赞同：1
> 
> 时间：2012-11-23T18:00:45.037
> 
> 标签：android

我是 Android 编程的新手，可能我还不太了解 Java，所以我的程序遇到了这个问题。每次我按下菜单上的按钮时，我都会得到**java.lang.NullPointerException**。**单击菜单上的item2**时，是否有任何方法可以引用此 TextView 对象并更改其文本？

```
public class MainActivity extends Activity {

TextView tv;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    MainActivity.this.tv = (TextView) findViewById(R.id.tekst1);
    setContentView(R.layout.activity_main);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.mymenu, menu);
    return super.onCreateOptionsMenu(menu);
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if (item.getItemId() == R.id.item2) {
        MainActivity.this.tv.setText("aaa");
    }
    return super.onOptionsItemSelected(item);
}
} 
```

编辑：mymenu xml：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/item1"
    android:icon="@android:drawable/ic_menu_week"
    android:title="Option 1"/>
<item
    android:id="@+id/item2"
    android:icon="@android:drawable/ic_menu_month"
    android:title="Option 2"/>

</menu> 
```

activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/tekst1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world"
    tools:context=".MainActivity" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:09:02.513

您需要在检索元素之前加载布局。

只需更换

```
MainActivity.this.tv = (TextView) findViewById(R.id.tekst1);
setContentView(R.layout.activity_main); 
```

经过

```
setContentView(R.layout.activity_main);
MainActivity.this.tv = (TextView) findViewById(R.id.tekst1); 
```

findViewById 方法尝试在视图的层次结构中找到一个元素（从一个 ID）。这就是为什么您需要先加载这个层次结构（从 XML 文件）！否则，您将在空的视图层次结构中搜索

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:10:16.587

您必须将`onCreate`方法更改为：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    MainActivity.this.tv = (TextView) findViewById(R.id.tekst1);
} 
```

`setContentView`在为您的 Activty 做完之后，您必须参考您的观点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:31:07.857

通过使用 setContentView(int layoutResId) 方法，android 平台正在创建您的布局 xml 文件中包含的所有视图对象，并提供给 setContentView(int layoutResId) 方法。这意味着在调用 setContentView(int layoutResId) 方法之前，findViewById(int resId) 方法将为布局中的任何视图引用返回 null，从而导致一些潜在的 NullpointerExceptions。为了避免这些错误，将 setContentView(int layoutResId) 方法调用放在 onCreate() 方法的最顶部是一个好习惯。

看看这个：[http ://www.jayway.com/2009/03/26/layout-resources-in-android/](http://www.jayway.com/2009/03/26/layout-resources-in-android/)

# vb.net - 如何在 VB.NET 中打开位于 MDI 父级中的子窗体？

> ID：13533909
> 
> 赞同：2
> 
> 时间：2012-11-23T18:01:26.050
> 
> 标签：vb.net, vb.net-2010, mdichild

我们如何在父 MDI 窗口中排列子窗体？我可以从父级的菜单中调用和显示子窗体，但是子级会在父级之外弹出-我希望它实际上在父级内部。我检查了 C# 和 VB.Net 解决方案，但它们都说得差不多，即尝试访问 LayoutMDI，例如这里：

[http://msdn.microsoft.com/en-us/library/x9fhk181.aspx](http://msdn.microsoft.com/en-us/library/x9fhk181.aspx)

问题是，我在哪里可以访问它？当我在我的 MDI 父代码中时，`Me.LayoutMdi`无法识别。我将`Me.LayoutMDI`代码放在应用程序的哪个部分？

## 编辑

`Me.LayoutMDI`毕竟代码在父级中工作。我已经尝试了一段时间，但不知道我哪里出错了。

但是，孩子继续从父母身上弹出。这是如何发生的图像。后面较宽的窗体是父窗体，带有gridview 和两个按钮的窗体是弹出的新子窗体。我希望它在父级中弹出“停靠”。

![在此处输入图像描述](../Images/b885640df126abad1b28437412392541.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:57:03.247

如果您的表单在 MDI 父级“外部”，那么您很可能没有设置 MdiParent 属性：

```
Dim f As New Form
f.MdiParent = Me
f.Show() 
```

在这个例子中，我是一个具有`IsMdiContainer = True`以便它可以承载子表单的表单。

要重新安排子表单布局，您只需从 MdiContainer 表单中调用该方法：

```
Me.LayoutMdi(MdiLayout.Cascade) 
```

MdiLayout 枚举还具有平铺和排列图标值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T11:11:05.573

不要从 MDIForm 设置 MDI 子属性

在Chileform Load 事件中给出以下代码

```
 Dim l As Single = (MDIForm1.ClientSize.Width - Me.Width) / 2
    Dim t As Single = ((MDIForm1.ClientSize.Height - Me.Height) / 2) - 30
    Me.SetBounds(l, t, Me.Width, Me.Height)
    Me.MdiParent = MDIForm1 
```

结尾

试试这个代码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-24T20:58:07.153

您需要将`MdiParent`新表单的属性设置为 MDI 父表单的名称，如下所示：

```
dim form as new yourform
form.show()
form.MdiParent = nameParent 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T19:09:03.963

尝试在 mdi 父级上添加一个按钮并添加此代码以将您的 mdi 子级设置在 mdi 父级中。将 yourchildformname 更改为您的 MDI Child 的表单名称，看看这是否有效。

```
 Dim NewMDIChild As New yourchildformname()
    'Set the Parent Form of the Child window.
    NewMDIChild.MdiParent = Me
    'Display the new form.
    NewMDIChild.Show() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T11:02:08.450

```
 Private Sub FileMenu_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) handles FileMenu.Click

    Form1.MdiParent = Me
    Form1.Dock = DockStyle.Fill
    Form1.Show()
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T15:33:51.300

尝试将子窗体的 StartPosition 属性设置为 Center Parent。您可以从表单属性中进行选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-20T01:10:59.857

试试下面的代码，然后......

1 - 更改 MENU 的名称，因为在我的示例中 menuitem 被称为“Form7ToolStripMenuItem_Click”

2 - 确保将其粘贴到 MDIFORM 中，而不仅仅是基本 FORM

然后让我知道 CHILD 表单是否仍显示在父表单之外

```
Private Sub Form7ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Form7ToolStripMenuItem.Click

    Dim NewForm As System.Windows.Forms.Form
    NewForm = New System.Windows.Forms.Form
    'USE THE NEXT LINE - to add an existing CUSTOM form you already have
    'NewForm = Form7                         
    NewForm.Width = 400
    NewForm.Height = 250
    NewForm.MdiParent = Me
    NewForm.Text = "CAPTION"
    NewForm.Show()
    DockChildForm(NewForm, "left")          'dock left
    'DockChildForm(NewForm, "right")         'dock right
    'DockChildForm(NewForm, "top")           'dock top
    'DockChildForm(NewForm, "bottom")        'doc bottom
    'DockChildForm(NewForm, "full")          'fill the client area (maximise the child INSIDE the parent)
    'DockChildForm(NewForm, "Anything-Else") 'center the form

End Sub

Private Sub DockChildForm(ByRef Form2Dock As Form, ByVal Position As String)

    Dim XYpoint As Point
    Select Case Position
        Case "left"
            Form2Dock.Dock = DockStyle.Left
        Case "top"
            Form2Dock.Dock = DockStyle.Top
        Case "right"
            Form2Dock.Dock = DockStyle.Right
        Case "bottom"
            Form2Dock.Dock = DockStyle.Bottom
        Case "full"
            Form2Dock.Dock = DockStyle.Fill
        Case Else
            XYpoint = New Point
            XYpoint.X = ((Me.ClientSize.Width - Form2Dock.Width) / 2)
            XYpoint.Y = ((Me.ClientSize.Height - Form2Dock.Height) / 2)
            Form2Dock.Location = XYpoint
    End Select
End Sub 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-30T18:59:37.937

请参阅此页面以获取解决方案！ [https://msdn.microsoft.com/en-us/library/7aw8zc76(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/7aw8zc76(v=vs.110).aspx)

我能够`Child`在父级内部实现表单。

在下面的示例中`Form2`应更改为您的子窗体的名称。 `NewMDIChild.MdiParent=me`是主窗体，因为打开（显示）子窗体的控件是父窗体或`Me`.

`NewMDIChild.Show()`是您的子表单，因为您将子表单与`Dim NewMDIChild As New Form2()`

```
Protected Sub MDIChildNew_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MenuItem2.Click
   Dim NewMDIChild As New Form2()
   'Set the Parent Form of the Child window.
   NewMDIChild.MdiParent = Me
   'Display the new form.
   NewMDIChild.Show()
End Sub 
```

简单而且有效。

# android - 旋转对象，但始终在其自己的前轴上平移对象

> ID：13533913
> 
> 赞同：0
> 
> 时间：2012-11-23T18:01:39.927
> 
> 标签：android, opengl-es, rotation, transformation

我想为 Android 编写一个赛车游戏。我的问题是，如果我旋转汽车并想要平移位置，它不会平移到汽车的新方向，而是始终在世界的 X 轴上。

这是我的错误代码..谢谢

```
gl.glTranslatef(car.position.x, car.position.y, car.position.z);

gl.glRotatef(car.currentAngle, 0, 1, 0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T19:32:32.823

Opengl 使用矩阵来创建图像。

在矩阵中，乘法没有关联属性。因此，当您旋转一个对象然后平移它时，如果您没有先平移它，那么该对象将最终处于不同的位置。

转换和平移对象的解决方案是动画和平移。这样您就可以在任何地方进行翻译，而不必担心对象旋转的关联属性。

要查看非关联乘法对对象的影响，请尝试以下操作：旋转和平移对象约 8 次，分别旋转和平移 8 次。你会注意到你的对象会消失。与“在改变位置时旋转一圈”相反。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T10:41:54.340

好的，我有解决方案。我所要做的就是将我的汽车翻译成新的方向矢量，该矢量会被我的汽车的新角度改变:)

```
if (accel < 0)
    position.add((float) Math.sin(current * Math.PI/180)/5, 0, (float) Math.cos(currentangle * Math.PI/180)/5);
if (accel > 0)
    position.sub((float) Math.sin(current * Math.PI/180)/5, 0, (float) Math.cos(currentangle * Math.PI/180)/5); 
```

并在渲染类

```
gl.glTranslatef(car.position.x, car.position.y, car.position.z);
gl.glRotatef(car.currentAngle, 0, 1, 0); 
```

# java - GWT 应用程序 UI 不会显示

> ID：13533914
> 
> 赞同：0
> 
> 时间：2012-11-23T18:01:50.697
> 
> 标签：java, gwt, uibinder

我已经实现了一个简单的 GWT 应用程序，它使用 1 个 Place 和 1 个 Activity（我已经实现了一个 Presenter，它扩展了一个`AbstractActivity`并包含一个`Composite`“视图”子类）。视图中的第一个也是唯一的 UI 对象是一个[GWT-Bootstrap NavBar](http://gwtbootstrap.github.com/gwt-bootstrap/apidocs/index.html)，我希望它出现在我的“主页”的最顶部。

我正在从 Eclipse 内部本地运行应用程序，并且没有收到任何编译器或运行时错误。当我转到**开发模式**控制台指向的 URL 时，我在浏览器中稍作停顿（我假设这是浏览器“下载”JavaScript），然后我看到一个空白屏幕（而不是我的导航栏） . 窗口标题是正确的（我在模块的 HTML 页面中设置了这个），当我查看源代码时，我看到了相同的 HTML 源代码，所以我知道应用程序的 JavaScript 正在正确地进入浏览器。它只是不渲染导航栏。

我`System.out.println()`在整个`onModuleLoad()`、我的 default `ActivityManager`、`ActivityMapper`、`PlaceHistoryMapper`、presenter 和 view`Composite`中都添加了语句，所有这些`sysout`语句都打印在开发控制台中；告诉我我已将所有内容正确连接在一起，并且在运行时`PlaceHistoryHandler#handleCurrentHistory`（从内部`onModuleLoad`）调用该方法时，我应该看到我的 NavBar。

我能想到的唯一可能是：

1.  我配置`gwt-bootstrap`错误；或者
2.  我没有正确使用 UiBinder
3.  我如何使用活动和地点，或者我如何将用户界面附加到`RootLayoutPanel`内部，还有其他问题`onModuleLoad()`。

至于`gwt-bootstrap`：

*   我将 JAR 放在项目的类路径中（我知道这一点，因为当我在小部件/视图`UiField`中包含新类型时`NavBar`，我没有收到任何编译器错误）
*   我添加`<inherits name="com.github.gwtbootstrap.Bootstrap"/>`到我的 GWT 模块 XML

所以如果我还有什么需要配置的，请告诉我！

至于 UiBinder 的东西，这是我的小部件/视图：

```
public class WebRootDisplay extends BaseDisplay {

    private static WebRootDisplayUiBinder uiBinder = GWT
        .create(WebRootDisplayUiBinder.class);

    interface WebRootDisplayUiBinder extends UiBinder<Widget, WebRootDisplay> {
    }

    @UiField
    Navbar navBar;

    public WebRootDisplay(EventBus eventBus) {
        super(eventBus);

        System.out.println("I get this printing to the console at runtime.");

        initWidget(uiBinder.createAndBindUi(this));

        System.out.println("...and this too!");
    }
}

<!DOCTYPE ui:UiBinder SYSTEM "http://dl.google.com/gwt/DTD/xhtml.ent">
<ui:UiBinder xmlns:ui="urn:ui:com.google.gwt.uibinder"
    xmlns:g="urn:import:com.google.gwt.user.client.ui"
    xmlns:b="urn:import:com.github.gwtbootstrap.client.ui">
    <g:HTMLPanel>
        <b:Navbar ui:field="navBar">
            <b:Nav>
                <b:NavLink href="http://www.google.com">
                    Home
                </b:NavLink>
            </b:Nav>
        </b:Navbar>
    </g:HTMLPanel>
</ui:UiBinder> 
```

我注意到的一件事是我在 UiBinder XML 中有我的`NavBar`内部。`HTMLPanel`我这样做是因为我使用 Google-Eclipse 插件为我生成了一个新的 UiBinder（它自动生成了`Composite`（然后我将其修改为 extend `BaseDisplay`，它本身 extends `Composite`）以及 UiBinder 片段。我想 GWT 希望我把所有这里面的 UI 字段`HTMLPanel`...（？）

如果我在这里遗漏任何东西，请告诉我。我没有实例化该`NavBar`字段，因为我*相信*这`createAndBindUi`对我有用。

如果我的`gwt-bootstrap`配置和我对 UiBinder 的使用看起来都是正确的，那么显然还有其他问题，我将不得不发布更多代码。我只是想在前两项被排除之前先推迟一下。提前致谢！

### 更新

这里是`onModuleLoad`：

```
public void onModuleLoad() {
    // Some homegrown DI stuff. I have verified that the injector works properly.
    ApplicationScope appScope = new ApplicationScope();

    setInjector(new ApplicationInjector(appScope,
        InjectorProvider.newMasterProvider()));

    // Add the sole composite child to the RootLayoutPanel.
    // I have verified that injectWebRootDisplay returns a fully configured
    // WebRootDisplay instance.
    RootLayoutPanel.get().add(injector.injectWebRootDisplay());

    historyHandler.register(placeController, eventBus, defaultPlace);
    historyHandler.handleCurrentHistory();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T14:59:04.917

你能粘贴`onModuleLoad()`你的代码的一部分吗？

如果您没有收到任何`Exception`错误消息，我认为您应该检查是否将视图正确添加到 中`RootPanel`，或者当您运行应用程序时，您应该检查 中`view`是否存在并且只是不可见或类似的东西`div`。`HTML`

乍一看，这`UiBinder`部分看起来不错。

**编辑：** 这`onModuleLoad()`对我来说并没有说太多，但你可以尝试一下。我总是通过以下方式使用 RootLayoutPanel.get() 方法：

```
RootLayoutPanel.get("someDivId").add(injector.injectWebRootDisplay()); 
```

所以我总是在占位符中添加一个`div`or ，所以当你得到 RootPanel 时，你可以参考那个 div。我不相信这是必要的，但我第一次看到这个，它工作正常。如果您有任何疑问或问题，请告诉我。:)`table``HTML``id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T20:39:58.553

In my experience with GWT Activities and Places, a common culprit of a blank white page is failing to register the Place's Tokenizer with the PlaceHistoryMapper as so:

```
/**
 * PlaceHistoryMapper interface is used to attach all places which the
 * PlaceHistoryHandler should be aware of. This is done via the @WithTokenizers
 * annotation or by extending PlaceHistoryMapperWithFactory and creating a
 * separate TokenizerFactory.
 */
@WithTokenizers({
    MyPlace.Tokenizer.class,
    SomeOtherPlace.Tokenizer.class})
public interface AppPlaceHistoryMapper extends PlaceHistoryMapper {} 
```

See [https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces#PlaceHistoryMapper](https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces#PlaceHistoryMapper)

Another cause for a white page (particularly when using RootLayoutPanel.get() with a single place is failing to map the place correctly in the ActivityMapper:

```
/**
 * AppActivityMapper associates each Place with its corresponding
 * {@link Activity}
 * 
 * @param clientFactory
 *            Factory to be passed to activities
 */
public class AppActivityMapper implements ActivityMapper {
    private ClientFactory clientFactory;

    public AppActivityMapper(ClientFactory clientFactory) {
        super();
        this.clientFactory = clientFactory;
    }

    @Override
    public Activity getActivity(Place place) {
        if (place instanceof MyPlace)
            return new MyActivity((MyPlace) place, clientFactory);
        else if (place instanceof SomeOtherPlace)
            return new SomeOtherActivity((SomeOtherPlace) place, clientFactory);

        return null; // If your return null with single place bound to RootLayoutPanel
        // you may get a blank white page
    }
} 
```

See [https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces#ActivityMapper](https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces#ActivityMapper)

Without a more complete code sample it is impossible to determine exactly what is happening, but the two causes outlined above are common oversights which may help anyone who comes across this thread.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T22:37:07.593

好吧，我尝试了一个与您的代码完全一样的本地示例，我认为问题不在于 UI 活页夹。到目前为止您提供的代码是正确的，因此很可能错误在其他地方。

最大的嫌疑人是`BaseDisplay`班级。据我所知，这个类不是来自 GWT 或 gwt-bootstrap。您可以通过更改`WebRootDisplay`类来快速检查它，因此它扩展了经典的 GWT`Composite`类而不是`BaseDisplay`（并暂时禁用所有 mvp 内容）。如果它有效，您就有证据证明问题是由“BaseDisplay”引起的

由于我没有完整的代码，我只能假设它`WebRootDisplay`也用于显示视图，并且最有可能的错误是当视图被添加到该类时，以前添加的小部件（在你的情况下它是一个 NavBar您在 ) 的构造函数中添加的`WebRootDisplay`内容被删除。问题很可能出在方法`setWidget`和`initWidget`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-25T15:41:18.413

代替 System.println 使用 GWT.log 消息。然后打开 Javascript 控制台（Firebug 或 Chrome），看看你的代码在哪里结束。GWT.log 将在浏览器控制台中打印出来，因此您可以看到编译后的 JS 代码做了什么。

此外，如果您使用 Pretty 模式进行编译，您将在浏览器中看到生成的 Javascript 代码，并且能够单步执行并查看调用（或不调用）的内容。

# c++ - 输入 getline 结束

> ID：13533922
> 
> 赞同：5
> 
> 时间：2012-11-23T18:02:16.720
> 
> 标签：c++, input, getline

> **可能重复：**
> [为什么 getchar() 不能在 Windows 控制台中将返回识别为 EOF？](https://stackoverflow.com/questions/1793616/why-doesnt-getchar-recognise-return-as-eof-in-windows-console)

我有一个简单的问题......假设我想从标准输入中读取行，只要有东西，但我不知道它将是多少行。例如，我正在做功课，输入是

```
a
ababa
bb
cc
ba
bb
ca
cb 
```

我不知道具体会有多少行，所以我尝试了

```
string *line = new string[100];
    int counter = 0;
   while(getline(cin,line[counter]))
   {
    counter++;
   } 
```

但它不起作用......感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:14:55.503

如果您希望输入以空行结束，那么您必须对其进行测试。例如。

```
string *line = new string[100];
int counter = 0;
while (getline(cin, line[counter]) && line[counter].size() > 0)
{
    counter++;
} 
```

恭喜您`getline()`正确使用 BTW。与您得到的某些答案不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:06:41.937

您可以通过以下方式获取行数：

```
 string *line = new string[SIZE];
   int lines = 0;

    while(lines < SIZE && getline(cin, line[lines]) && line[lines].size() > 0) 
   {
        cout << input_line << endl;
        lines++;
   } 
```

不要忘记检查是否添加的**行数不超过**字符串行可以处理的大小，否则会出现分段错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T18:10:47.273

我能想到的最简单的线路计数器是这样的：

```
#include <string>
#include <iostream>

unsigned int count = 0;

for (std::string line; std::getline(std::cin, line); )
{
    ++count;
}

std::cout << "We read " << count << " lines.\n"; 
```

测试：

```
echo -e "Hello\nWorld\n" | ./prog 
```

如果您想打折空行，请`if (!line.empty()) { ++count; }`改为说。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T19:25:26.630

这应该有效：

```
int cont = 0;
string s;
while(cin >> s) { //while(getline(cin,s)) if needed
  if(s.empty()) break;
  ++cont;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T18:04:14.693

您也可以为此使用文件结束标记。它的用法是这样的。

```
std::ifstream read ("file.txt") ;

while(!read.eof())
{
  //do all the work
} 
```

如果已到达文件末尾，则此函数返回 true。所以它会一直持续到你遇到它。

**编辑：**

正如评论中提到的那样，该方法`eof`可能很危险并且无法提供所需的结果。因此，无法保证它会在每种情况下运行。您可以在这里查看何时可能发生这种情况。

[从文本文件中读取直到 EOF 重复最后一行](https://stackoverflow.com/questions/21647/reading-from-text-file-until-eof-repeats-last-line)

# java - GridBagLayout 位置应该在别的地方？

> ID：13533923
> 
> 赞同：2
> 
> 时间：2012-11-23T18:02:18.970
> 
> 标签：java, swing, layout-manager, gridbaglayout

我有以下代码

```
GridBagConstraints c = new GridBagConstraints();
    c.gridx=0;
    c.gridy=0;
    c.gridwidth=1;
    c.gridheight=1;
    c.fill = GridBagConstraints.BOTH;
    c.insets= new Insets(2,2,2,2);
    this.add(pdfUrl,c);
    c.gridx=1;
    c.weightx=0.1;
    c.gridwidth=4;
    this.add(pdfUrlin,c);
    c.gridx=0;
    c.gridwidth=1;
    c.gridy=1;
    c.weightx=0.0;
    this.add(pdfType); 
```

这段代码产生这个 ![代码产生这个](../Images/e64426b8783e0e2722628d4031968156.png)

我不明白为什么 PDF 类型不在下面的行中。有谁可以帮我离开这里吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T18:03:40.197

添加 pdfType 时，您没有使用 GridBagConstraints。不应该

```
this.add(pdfType); 
```

反而

```
add(pdfType, c); // also no need for "this" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T18:03:47.077

小错误，我认为您打算这样做：`this.add(pdfType, c);`而不是`this.add(pdfType);`=）

# logging - openam - 记录写入授权失败

> ID：13533924
> 
> 赞同：1
> 
> 时间：2012-11-23T18:02:21.200
> 
> 标签：logging, openam

我正在尝试写入日志。根据以下内容：

```
java.util.logging.Logger logger = com.sun.identity.log.Logger.getLogger("name"); 
```

然后我做：

```
public void info(SSOToken token, String message) {
    if (this.logger != null) {
        java.util.logging.LogRecord value = null;
        if (token == null) {
            value = new LogRecord(Level.INFO, message);
        }
        else {
            value = new LogRecord(Level.INFO, message, token);
        }

        logger.log(value);
    }
} 
```

但我得到一个例外：

```
com.sun.identity.log.AMLogException: MagentoIdRepo:Log write authorization failure
    at com.sun.identity.log.Logger.validateLogBy(Logger.java:291)
    at com.sun.identity.log.Logger.log(Logger.java:363)
    at com.sun.identity.log.Logger.log(Logger.java:340)
    at com.sun.identity.log.Logger.log(Logger.java:270) 
```

知道如何找出需要对哪些用户进行身份验证才能登录以及如何对他们进行身份验证吗？因为我认为这就是我需要做的来解决上述问题。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T09:26:16.383

如果您只想进行一些调试日志记录，您可以使用 'com.sun.identity.shared.debug.Debug' ...

```
private static Debug debug; 
debug = Debug.getInstance("someName");
if (debug.messageEnabled()) {
  debug.message(....);
}

if (debug.warningEnabled()) {
  debug.warning(...);
} 
```

ETC

如果您确实需要以特殊权限开始的记录器，则必须将其分配给与“SSOToken”相关的身份

# android - 无法为调试器绑定到本地 86XX

> ID：13533930
> 
> 赞同：4
> 
> 时间：2012-11-23T18:03:00.693
> 
> 标签：android, eclipse, adb

出于某种原因，每次尝试调试我的应用程序时，eclipse DDMS 总是给出错误“无法绑定到本地 86XX 以进行调试器”。由于某种原因，今天才开始。

我查看了许多帖子并尝试了他们的建议，例如： 1\. 将 127.0.0.1 localhost 添加到主机文件并移动 ::1 2\. 停止并重新启动 adb 3\. 在 Window -> Preferences -> Android -> DDMS ：将基本本地调试器端口设置为“8601”选中“使用 ADBHOST”框并将值设置为“127.0.0.1”

我还重新启动了计算机，更新了 Android 平台工具和 eclipse 插件，下载了最新的 adt-bundle 并启动了与之捆绑的 eclipse。

我已经运行 netstat -anob 并且只有 javaw 和 adb 使用端口 8600+。

有谁知道我现在可以尝试什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-05-06T15:14:01.180

如果您使用的是 Linux，我建议您也运行以下命令：

定影器 -k 8600/tcp

使用此命令，您将终止在 8600 TCP 端口（Android 用于调试的那个）上运行的任何进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T11:33:24.887

我有同样的问题，没有一个给定的解决方案有效。然后我卸载了所有 JRE 7 并安装了最新的 JRE 6 ( [http://www.oracle.com/technetwork/java/javase/downloads/jre6downloads-1902815.html](http://www.oracle.com/technetwork/java/javase/downloads/jre6downloads-1902815.html) )。它立即解决了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T16:50:37.663

我也有同样的问题。我真的尝试了一切，所有的提示都来自网络。我试过了：

*   不同版本的 JRE 和 JDE
*   不同的端口
*   不同的手机
*   修改主机文件
*   更改偏好 ddms
*   完全禁用防火墙
*   禁用所有 IPV6 功能
*   我每次都重新启动adb
*   我使用 Windows 8

在许多人的尝试下，它工作了两次。在退出调试会话并开始另一个没有任何更改的情况下，同样的事情又开始了......

但是：我使用 eclipse 和 android sdk 将整个环境路径复制到另一个 windows 8 机器，它可以正常工作！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-21T14:53:14.687

如果您使用的是 Windows，请使用以下两个命令终止在端口 8600 上运行的任何进程：

```
netstat -a -n -o | findstr :8600 
```

它应该给出类似的东西

> TCP 127.0.0.1:8600 0.0.0.0:0 监听 7508

然后运行

```
taskkill /F /PID 7508 :: replace 7508 with the displayed PID 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-25T16:14:53.273

出现此错误的原因之一可能是现有的 DDMS 会话打开，该会话正在使用该端口。这就是发生在我身上的事情。收到此错误时，我打开了设备管理器。关闭设备管理器后，我做了一个干净的构建，然后它工作了！猜猜 DDMS 和调试器正在尝试使用导致问题的相同端口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-07T10:25:19.567

我这样解决了这个问题：

1.  打开 powershell（在 XP 之后的所有窗口中可用）。它是一个命令提示符。发出命令
    `> netstat -nao`
2.  它将列出计算机上所有活动的 TCP 和 UDP 端口。查找本地地址包含 的条目`some IP address : 8600`。这是您希望关闭的 TCP 端口。
3.  请注意此条目的 PID。在powershell中，给出另一个命令
    `> Stop-Process -Id PID`
4.  这里的PID是我们注意到的那个。现在从 eclipse 启动调试，它应该绑定`8600`端口没有进一步的问题。

# php - Magento getParam v $_GET

> ID：13533936
> 
> 赞同：25
> 
> 时间：2012-11-23T18:03:27.700
> 
> 标签：php, magento

任何人都可以解释功能上和好/坏实践方面的差异，为什么其中一个应该优于另一个：

```
$getParam = Mage::app()->getRequest()->getParam('getparam'); 
```

v

```
$getParam = $_GET['getparam']; 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-11-23T18:10:28.637

两者之间存在显着差异。`$_GET`只是一个数组，例如`$_POST`. 但是，调用`Mage::app()->getRequest()->getParam('param_name')`将使您可以访问 GET 和 POST *（此处不包括 DELETE 和 PUT）* - 请参见下面的代码：

```
lib/Zend/Controller/Request/Http.php

public function getParam($key, $default = null)
{
    $keyName = (null !== ($alias = $this->getAlias($key))) ? $alias : $key;

    $paramSources = $this->getParamSources();
    if (isset($this->_params[$keyName])) {
        return $this->_params[$keyName];
    } elseif (in_array('_GET', $paramSources) && (isset($_GET[$keyName]))) {
        return $_GET[$keyName];
    } elseif (in_array('_POST', $paramSources) && (isset($_POST[$keyName]))) {
        return $_POST[$keyName];
    }

    return $default;
} 
```

此外，如果系统用 设置了其他参数`Mage::app()->getRequest()->setParam()`，则可以通过该`getParam()`函数访问它。在 Magento 中，您希望始终使用`getParam()`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-23T18:06:26.917

```
Mage::app()->getRequest()->getParam('getparam'); 
```

如果使用 GET、POST（不确定 DELETE、PUT ...）请求发送，将返回“getparam”。不适用于 Magento，但如果有通过路由发送的参数。我希望它们也可以通过该功能访问。

`$_GET`仅包含通过 GET 发送的参数

`$_POST`仅包含通过 POST 发送的参数

# c++ - 字段类型不完整，从多个文件编译

> ID：13533949
> 
> 赞同：0
> 
> 时间：2012-11-23T18:04:40.017
> 
> 标签：c++, incomplete-type

我正在尝试为基于代理的僵尸启示录模拟编译几个文件（太棒了，对吧！？）无论如何，我收到一个错误，我认为这与包含头文件的顺序有关，但我我不知道如何弄清楚出了什么问题以及如何解决它。确切的错误是：“在 main.cpp 包含的文件中，‘位置’字段的类型不完整。” 然后类似地，“在构造函数 Creature::Creature() 'Location' 中未声明”。

这是我的文件：

定义.h

```
#ifndef definitions_h
#define definitions_h
class Creature;
class Item;
class Coords;

class Grid
{

public:
      Creature*** cboard;
      Item*** iboard;

      Grid(int WIDTH, int HEIGHT);
      void FillGrid(int H, int Z); //initializes grid object with humans and zombies  
      void Refresh(); //calls Creature::Die(),Move(),Attack(),Breed() on every square
      void UpdateBuffer(char** buffer);
      bool isEmpty(int startx, int starty, int dir);

};

class Random
{
    public:
        int* rptr;
        void Print();
        Random(int MIN, int MAX, int LEN);
        ~Random();
    private:
        bool alreadyused(int checkthis, int len, int* rptr);
        bool isClean();
        int len;
};

class Creature
{

public:
      bool alive;
      Coords Location;
      char displayletter;

      Creature() {Location.x=0; Location.y=0;} //ERROR HERE
      Creature(int i, int j) {Location.xvalue(i); Location.yvalue(j);} 

      virtual void Attack();
      virtual void Breed();
      virtual void Move(Creature*** cboard);
      virtual void Die();

      virtual void MoveTo(Creature*** cboard, int dir); 
      virtual int DecideSquare(Creature*** cboard); 
};

class Human : public Creature 
{
public:      
      bool armed; //if armed, chances of winning fight increased for next fight 
      bool vaccinated; //if vaccinated, no chance of getting infected

      int bitecount; //if a human is bitten, bite count is set to a random number
      int breedcount; //if a human goes x steps without combat, will breed if next to a human
      int starvecount; //if a human does not eat in x steps, will die 

      void Attack(Creature*** cboard);
      void Breed(Creature*** cboard); //will breed after x steps and next to human
      void Move(Creature*** cboard); //moves and checks itemboard for food
      void Die(); //depends on bitecount, starvecount, and bool alive

      void MoveTo(Creature*** cboard, int dir);
      int DecideSquare(Creature*** cboard) {Creature::DecideSquare(Creature*** cboard);}

};

class Zombie : public Creature
{
   public:
      Zombie(int i, int j) {Creature::Creature()};
      void Attack(Creature*** cboard); //will attack any adjacent human
      void Breed() {} //does nothing
      void Move(Creature*** cboard) {Creature::Move(Creature*** cboard;}
      void Die(); //can only die from being attacked, never starves

};

class Item
{

};

class Coords
{
  public:   
      int x;
      int y;
      int MaxX;
      int MaxY;

      Coords() {x=0; y=0; MaxX=0; MaxY=0;}
      Coords(int X, int Y, int WIDTH, int HEIGHT) {x=X; y=Y; MaxX=WIDTH; MaxY=HEIGHT; }

      void MoveRight();
      void MoveLeft();
      void MoveUp();
      void MoveDown();
      void MoveUpRight();
      void MoveUpLeft();
      void MoveDownRight();
      void MoveDownLeft();
      void MoveDir(int dir);
      void setx(int X) {x=X;}
      void sety(int Y) {y=Y;}
};

#endif 
```

主文件

```
#include <cstdlib>
#include <iostream>
#include "definitions.h"

using namespace std;

int main(int argc, char *argv[])
{
    system("PAUSE");
    return EXIT_SUCCESS;
} 
```

定义.cpp

```
#include <cstdlib>
#include "definitions.h"

Grid::Grid(int WIDTH, int HEIGHT)
{
     //builds 2d array of creature pointers
     cboard = new Creature**[WIDTH];
     for(int i=0; i<WIDTH; i++)
     {
             cboard[i] = new Creature*[HEIGHT];
     }

     //builds 2d array of item pointers
     iboard = new Item**[WIDTH];
     for (int i=0; i<WIDTH; i++)
     {
              iboard[i] = new Item*[HEIGHT];
     }
}

void Grid::FillGrid()
{
     /* For each creature pointer in grid, randomly selects whether to initalize
     as zombie, human, or empty square. This methodology can be changed to initialize
     different creature types with different probabilities */

     int random;

     for (int i=0; i<WIDTH; i++)
     {
         for (int j=0; j<HEIGHT; j++)
         {
             Random X(1,100,1); //create a single random integer from [1,100] at X.rptr
             random=X->rptr;
             if (random < 20)
                cboard[i][j] = new Human(i,j);
             else if (random < 40) 
                  cboard[i][j] = new Zombie(i,j); 
             else 
                  cboard[i][j] = NULL;
         }
     } //at this point every creature pointer should be pointing to either
     //a zombie, human, or NULL with varying probabilities 

}

void Grid::UpdateBuffer(char** buffer)
{
     for (int i=0; i<WIDTH; i++)
     {
         for (int j=0; j<HEIGHT; j++)
         {
             if (cboard[i][j])
                buffer[i][j]=cboard[i][j]->displayletter;
             else
                 buffer[i][j]=' ';
         }
     }

}

bool Grid::isEmpty(int startx, int starty, int dir)
{
     Coords StartLocation(startx,starty,WIDTH,HEIGHT);
     switch(dir)
     {
                case 1:
                     StartLocation.MoveUp();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 2:
                     StartLocation.MoveUpRight();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 3:
                     StartLocation.MoveRight();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 4:
                     StartLocation.MoveDownRight();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 5:
                     StartLocation.MoveDown();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 6:
                     StartLocation.MoveDownLeft();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 7:
                     StartLocation.MoveLeft();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0;
                case 8:
                     StartLocation.MoveUpLeft();
                      if (cboard[StartLocation.x][StartLocation.y])
                        return 0; 
     }
     return 1;
}

void Coords::MoveRight() {(x==MaxX)? (x=0):(x++);}
void Coords::MoveLeft() {(x==0)? (x=MaxX):(x--);}
void Coords::MoveUp() {(y==0)? (y=MaxY):(y--);}
void Coords::MoveDown() {(y==MaxY)? (y=0):(y++);} 
void Coords::MoveUpRight() {MoveUp(); MoveRight();}
void Coords::MoveUpLeft() {MoveUp(); MoveLeft();}
void Coords::MoveDownRight() {MoveDown(); MoveRight();}
void Coords::MoveDownLeft() {MoveDown(); MoveLeft();}
void Coords::MoveDir(int dir)
{
     switch(dir)
     {
                case 1:
                     MoveUp();
                     break;
                case 2:
                     MoveUpRight();
                     break;
                case 3:
                     MoveRight();
                     break;
                case 4:
                     MoveDownRight();
                     break;
                case 5:
                     MoveDown();
                     break;
                case 6:
                     MoveDownLeft();
                     break;
                case 7:
                     MoveLeft();
                     break;
                case 8:
                     MoveUpLeft();
                     break;
                case 0:
                     break;
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:12:13.343

您的`class Coords`in前向声明`definitions.h`不足以声明 type 的变量`Coords`。

前向声明引入了类型，但不完整。您可以使用指向不完整类型的指针声明变量，但不能声明具有不完整类型的变量。因此，您必须将 的定义移到 的定义`class Coords`之前`class Creature`。

如果你发现自己有循环声明依赖，你必须引入一个指针或引用声明器来解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:07:24.853

声明变量时，必须知道其类型。在您的情况下，这意味着`Coords`必须在声明中使用它的定义`Coords Location;`。

从编译器的角度来看：它需要知道将占用多少空间`Location`，为此它需要知道`Coords`. 当然，它是从上到下解析的。

# python - 如何在 Python 中遍历对函数的每次调用

> ID：13533953
> 
> 赞同：1
> 
> 时间：2012-11-23T18:05:02.070
> 
> 标签：python, python-2.7

每次在 Python 2.7.3 中对某个函数进行一定数量的调用时，我都需要增加一个变量。

例如，`feetTraveled = 0`。`for`每 12 次调用`travelOneInch()`, `feetTraveled += 1`.

使用 for 循环是最佳选择还是我应该使用不同的东西？如果最好使用上面的 for 循环，应该放置什么而不是“每 12 次调用”？

另一个例子：我有四个仆人。他们每个人都在时钟滴答声中完成一项任务，时间计数器最初是`time = 0`. 所以`for every four calls to servantDo()`，`time += 1`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T18:14:49.313

在这种情况下，我想我会使用实例方法：

```
class Foo(object):
    def __init__(self):
        self.inches = 0
        self.feet = 0

    def travel_one_inch(self):
        self.inches += 1
        if self.inches > 11:
            self.inches = 0
            self.feet += 1

    def __str__(self):
        return "{feet} feet and {inches} inches".format(feet=self.feet,inches=self.inches)

a = Foo()
for _ in range(123):
    a.travel_one_inch()
print(a) 
```

绝大多数情况下，如果您希望一个函数在调用之间记住某种状态，那么您根本不是在寻找一个函数——您是在寻找一个具有实例方法的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T18:19:42.343

可能最好的实现是使用一个对象来存储状态并使用函数来修改它：

```
class Position(object):
    def __init__(self):
        self.pos = 0
    def advance(self,inches=1):
        self.pos += inches
    def pos_as_foot(self):
        return self.pos // 12 
```

如果您觉得这种方法有点无聊（即使它是最正确的方法），您可以尝试一种更深奥的方法：您可以使用函数的内部值，即将它视为对象

```
def foo():
    foo.value+=1
    if foo.value and not foo.value%12:
        foo.result+=1
foo.value=0
foo.result=0

for i in range(15): 
    foo()
print foo.value
#15
print foo.result
#1 
```

这不是最简单的解决方案，如果您需要多个计数器就会有问题，但知道这很有趣。它的优点是从类定义（即在后台使用）中删除了一些杂乱的代码（至少在简单的情况下），并在您将使用该函数的任何地方保持状态可访问，而不会篡改全局变量（我确实如此）不喜欢）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T18:20:33.763

如果你想在全局命名空间中工作：

```
inches = 0
feet   = 0

def travelOneInch(sure):
    inches += 1

    if (inches % 12) == 0:
        feet += 1
    #... 
```

并且使用`inches % 12 == 0`比`inches > 12`你希望你的函数识别第二只脚和更远的脚更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:24:42.770

mgilson（上图）知道发生了什么。如果我是你，我会做以下事情，让事情变得更容易：

```
class Foo(object):
    def __init__(self):
        self.__inches = 0

    def travel_one_inch(self):
        self.__inches += 1

    def feetTraveled(self):
        return self.__inches // 12 
```

但是，就最优性而言，如果您只这样做一次，那么您可以使用临时变量：

```
feetTraveled = 0
inchesTraveled = 0
for i in xrange(72):
    # as in mgilson's answer
    inchesTraveled += 1
    if inchesTraveled > 11:
        inchesTraveled = 0
        feetTraveled += 1 
```

# windows-8 - Windows 应用商店认证：MainDerp 命名空间中的类型位于与命名空间不匹配的文件 C:\...\MainDerp.winmd 中

> ID：13533954
> 
> 赞同：1
> 
> 时间：2012-11-23T18:05:03.143
> 
> 标签：windows-8, visual-studio-2012, windows-runtime, windows-store-apps, windows-store

我正在尝试在 Windows 应用商店中发布应用程序，但我不断从 Windows 应用程序认证工具包 (WACK..) 中收到此错误，从而阻止我发布我的应用程序。我得到的错误是这样的：

`The types in the MainDerp namespace are located in file C:\...\MainDerp.winmd that does not match the namespace.`

所以我猜这意味着VS-2012生成的元数据与项目中找到的命名空间不匹配

我尝试重建和删除 suo 并重建，都无济于事。如果我尝试在设计模式下编辑我的 XAML 文件，我确实会遇到错误，但除此之外，一切都编译得很好。

我的项目在 C++/CX/XAML 中。

我不知道如何解决这个问题；在此先感谢您的帮助。

# css - 在 LESS CSS 中使用通用选择器作为 mixin

> ID：13533957
> 
> 赞同：10
> 
> 时间：2012-11-23T18:05:39.117
> 
> 标签：css, twitter-bootstrap, css-selectors, less

我知道混合和参数混合。我们正在寻找一种将 CSS / LESS 中的任何通用选择器变成 mixin 的方法。

例如在[Twitter](https://github.com/rcorp/bootstrap/blob/master/less/navbar.less#L233) [BootStrap](https://github.com/rcorp/bootstrap)中，我们有

```
.navbar .nav > li {
  float: left;
} 
```

如果我必须在课堂上使用它说 .mynavbar 我希望能够做到这一点

```
INPUT->
.mynavbar {
  .navbar .nav >li;
} 
```

* * *

```
OUTPUT->
.mynavbar {
  float:left;
} 
```

现在我知道当前版本的 LESS 无法做到这一点，因为编译器会标记解析器错误。我希望有人帮助我稍微更改一下 less.js 的源代码，以便它可行。

我已经设法获得[mixin parser 的源代码](https://github.com/cloudhead/less.js/blob/master/lib/less/parser.js#L825)。我尝试在那里更改 RegExp，但它会干扰解析器的其他部分。我知道我们只需要进行一些更改，因为我们不仅要接受`.mixin`而且`#mixin`我们必须接受任何 mixin，例如标签/属性选择器，例如`input[type=text]`.

目前开发使用 Bootstrap 的 UI 框架需要它。不幸的是，bootstrap 中的许多地方都充斥着直接标签选择器，而不是 id 和类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-28T15:23:51.130

这是可能的，因为包含该功能的 LESS[版本 1.4.0 (2013-06-05) 。](https://github.com/less/less.js/blob/master/CHANGELOG.md#140-beta-1--2)`extend`基于原始示例

```
.navbar .nav > li {
  float: left;
}

.mynavbar:extend(.navbar .nav > li) {} 
```

编译为

```
.navbar .nav > li,
.mynavbar {
  float: left;
} 
```

[此处](https://github.com/less/less.js/issues/1048)的文档以及[此处](http://lesscss.org/features/#extend-feature)用于原始问题的讨论和示例

**编辑：**添加代码示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T08:13:01.247

首先，我强烈反对这样做。相反，请尝试使用 CSS 的强大功能并构建您的 HTML，以便应用引导规则。无论如何，既然你要求它，这里就是解决方案。

问题不在于选择器或子规则的复杂性，而是标签名称选择器部分（即`li`）。所以，我们必须解决的是 mixin 解析器只匹配类和 id。我想我们不想篡改[first class 或 id test](https://github.com/cloudhead/less.js/blob/master/lib/less/parser.js#L821)，~~因为这可能需要将 mixin 与正常的 CSS 规则区分开来（尽管测试在该检查被注释掉的情况下运行良好）。~~（实际上，有一个解析器首选项在起作用，在 mixin 之后唯一尝试的是注释和指令，因此我们也可以安全地删除该检查）。`[#.]`但是，我们可以通过在匹配的正则表达式后面添加一个问号来轻松地在 mixin 选择器的后面部分允许标签名称。所以

```
while (e = $(/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)) { 
```

– 即[第 825 行](https://github.com/cloudhead/less.js/blob/master/lib/less/parser.js#L825)– 变为

```
while (e = $(/^[#.]?(?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)) { 
```

之后，测试用例仍然可以正常运行，但是会发生细微的损坏，所以要小心。

**编辑：**同样的问题有一个[GitHub](https://github.com/cloudhead/less.js/issues/1011)问题。显然，较少的人宁愿希望 mixin 功能更加狭窄和类似功能，而不是允许更灵活的……嗯……混合规则。关于 CSS 输出，这可能是合理的。

# objective-c - NSURLConnection 无法识别

> ID：13533973
> 
> 赞同：0
> 
> 时间：2012-11-23T18:07:05.337
> 
> 标签：objective-c, nsurlconnection

当我尝试识别`NSURLConnection`. 根本`imgConnection`不承认，`xmlConnection`而是。

```
- (void) connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {

    if (connection == xmlConnection) {
        [dataFinale appendData:data];
        NSLog(@"XML");
    }
    else if (connection == imgConnection){
        [imgData appendData:data];
        NSLog(@"IMG");
    }

}

NSURLRequest *requestImg = [NSURLRequest requestWithURL:urlImg cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:60];

imgConnection = [NSURLConnection connectionWithRequest:requestImg delegate:self]; 
```

# javascript - appendChild() 复选框：记住带有浏览器后退按钮的选择

> ID：13533974
> 
> 赞同：6
> 
> 时间：2012-11-23T18:07:07.970
> 
> 标签：javascript, back-button, appendchild

提前感谢任何试图帮助我的人。

我有一个表单，我正在向 via 添加复选框`appendChild()`- 作为用户选择的选项 - 基于一堆标准。

当用户选中这些框中的任何一个，然后单击“继续”按钮以将选择发布到另一个页面 - 然后单击**后退按钮**- 用户选中的复选框 - 现在已被浏览器**遗忘**（不再检查）。

如果我使用 php 编写复选框或仅使用**静态**复选框 - 当用户选中这些框中的任何一个然后单击“继续”按钮将选择发布到另一个页面时 - 然后单击后退按钮 - 选定的复选框会被**记住**（仍然检查）

我的问题是：

**当我使用appendChild()**创建复选框时，为什么浏览器会**忘记用户所做的选择**

 **但是同一个浏览器会**记住**用户在使用**静态**复选框时所做的选择

**appendChild()**不允许同一个浏览器记住选中的选择是怎么回事？

```
[div id="mydiv"] here is where the checkboxes are going[div]

[script type="text/javascript"]

var newInput = document.createElement("INPUT");
newInput.id = "mycheckboxid";
newInput.name = "mycheckboxname";
newInput.type = "checkbox";

document.getElementById('mydiv').appendChild(newInput);

[/script] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T20:59:42.013

浏览器可能会“忘记”对 DOM 的动态更改，因为不同的浏览器使用不同的策略来缓存网页。当您点击后退按钮时，其想法是浏览器可以显示其缓存副本，而不是从原始 Web 服务器重新请求页面。

它可以通过（至少）两种方式实现这一点：

1.  浏览器在离开页面时缓存页面的 DOM 本身。重新访问（向前或向后）时，动态变化将持续存在。
2.  浏览器在加载时仅缓存页面的原始 HTML（在任何动态更改之前）。这具有丢失那些动态更改的效果——进一步修改 DOM 并记录`appendChild()`或`innerHTML`不记录。

请注意，一些浏览器会额外保留修改后的表单数据，而其他浏览器则不会。如果您的目标是在所有浏览器中实现 99% 以上的兼容性，那么您还有一些工作要做。

要解决这个问题，您需要以某种方式保持状态。你有几个选择：

1.  将有关页面修改的数据保存到[localstorage](https://developer.mozilla.org/en/DOM/Storage)。使用在第一次加载页面时随机生成然后保留在页面中的密钥，以便状态更改仅适用于*该*页面实例。在页面加载时，如果此键已存在，请读出更改数据并重新应用更改。较旧的浏览器不支持本地存储。

2.  用 cookie 做前面的事情。我不推荐这个，因为它的缺点是会增加 cookie。*在每个*请求（包括 ajax 请求）中都会发送和接收 Cookie ，因此您将在每个请求上传输数据。旧浏览器可以正常工作。

3.  放弃您的动态更改模型，并通过发布到服务器来进行更改。然后，当从浏览器的缓存中拉出页面时，该页面将包含修改后的 html。你可能不想要这个，但为了完整起见，我想我会指出它。

4.  通过幕后的 ajax 将有关页面修改的数据保存到服务器。这与实际往返每个更改（如前一项）不同。您仍然动态地进行更改，但您将“通知”文件发布到服务器。然后，在每次页面加载时，向服务器请求任何调整数据。这类似于第一个建议，但您使用远程服务器作为存储。这会在每个页面加载时产生额外的净流量，但流量可能会很小，因为它就是*这样*页。它还会产生通常不会发送的额外网络流量（通知数据）。然而，一个聪明的系统架构可以使用这些信息以一种非常方便的方式在计算机和一段时间内保存用户未提交的表单数据（假设您的用户在 200 个问题的调查中完成了 199 个，然后他的权力消失了退出——有了这个计划，他有机会在他离开的地方无痛地继续！）。

5.  使您的继续按钮打开一个新的浏览器窗口，保持原始页面不变。

6.  让您的继续按钮在不离开页面的情况下发布数据，并保持其完整。你可以做一个简单的灯箱式叠加。

7.  如果灯箱样式的覆盖不起作用，但您确实必须显示一个新页面并且不希望它出现在新窗口中，那么重新设计您的网站以类似于 gmail：页面仅通过 javascript 更改，并且仅通过在 URL 末尾使用 #hash 标签来控制行为。这可能很困难，但有一些图书馆可以完成它。（对于某些浏览器，必须诉诸轮询以查看主题标签是否已更改。）基本思想是，当您单击指向同一页面但上面有标签的链接时，例如`<a href="#about">About</a>`浏览器将启动页面加载事件，并将新的上下文推送到历史前进/后退堆栈中，但*实际上不会加载新页面*. 然后解析更新的 URL 以获取哈希码（映射到某种命令）并执行它。通过为每个链接仔细选择适当的哈希码，您可以通过 Javascript 动态隐藏和显示适当的页面，它看起来就像这个人正在浏览一个真实的网站。你这样做的原因是，因为页面永远不会加载，你不仅可以在 Javascript 中维护状态，还可以维护 DOM 状态——你只需隐藏用户修改过的页面，当返回事件发生意味着再次访问该页面，您显示它，这正是用户离开它的方式。优点：如果您的网站需要 Javascript 来运行，那么您不会冒险使用更多的 Javascript 来完成它。坏处：完全改变您网站的架构需要大量的工作，并且很难在旧浏览器上工作。要开始使用此功能，请参阅[唯一的 URL](http://ajaxpatterns.org/Unique_URLs)。你可以试试[jQuery hashchange 插件](https://github.com/cowboy/jquery-hashchange)。如果您的网站分布广泛，您将需要确保解决[搜索引擎优化和网络可用性问题](http://www.chazzuka.com/seo-friendly-and-accessible-ajax-jquery-90/)。您可能希望[在检测后退按钮哈希更改时查看此 SO 页面](https://stackoverflow.com/questions/172957/detecting-back-button-hash-change-in-url)。

8.  使用与前一点相同的策略，但不要使用主题标签，而是使用新的 HTML5`history.pushState()`和`history.replaceState()`方法——请参阅[Mozilla 浏览器历史记录](https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Manipulating_the_browser_history#Adding_and_modifying_history_entries)。

如果您的目标不是在使用的 99% 的浏览器之间实现 99% 的兼容性，那么请告诉我们您的目标是什么，因为可能有一条捷径。

**更新：添加了一个选项 #8**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-14T14:52:44.023

脚本页面不会停留在状态管理上。它包括状态管理。

这意味着脚本状态更改，例如脚本页面转换（内部导航的页面）、内容窗格、弹出菜单、样式更改，当然还有表单输入和选择，都是脚本编写者的责任。

所以，回答为什么..这是因为您没有管理您编写的页面状态。

如果您希望您的页面按预期工作，您可以管理您自己编写脚本的页面状态更改，使用管理页面的 js lib，或者在您的情况下使用表单、状态或使用 http(s) 客户端/服务器状态管理并在服务器上加载会话状态，或者在您的情况下只是表单状态。**

# javascript - Soundcloud html5 小部件在 IE 中不可见

> ID：13533976
> 
> 赞同：3
> 
> 时间：2012-11-23T18:07:18.510
> 
> 标签：javascript, jquery, internet-explorer, slider, soundcloud

我尝试使用 slidejs 在 javascript 滑块中使用多个 soundcloud html5 小部件（iframe [）](http://www.slidesjs.com/)。

除了 IE，所有浏览器都可以毫无问题地滑动小部件。在 IE9 中，仅显示第一张幻灯片中的小部件，其他小部件以某种方式隐藏。您可以找到[滑块的示例](http://spaghuzz.biz/soundcloudslider)。

我发现重新加载页面后，您可以快速单击“下一步”并显示所有小部件。

在控制台中我得到两个错误：

```
"HTML1115: X-UA-Compatible META tag ('IE=edge,chrome=1') ignored because document mode is already finalized." 
```

和

```
"?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F56094476&show_artwork=false
SCRIPT5009: 'Object' is undefined 
widget-ab572693.js, line 1 character 6728" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T16:53:55.883

[IE9 中](http://msdn.microsoft.com/en-us/library/gg622929%28v=VS.85%29.aspx?ppud=4)有一个错误/安全功能（**链接已过期，请参阅更新**），它会阻止从 DOM 分离的 iframe 访问 JavaScript 运行时环境。因此，在小部件的 JavaScript 评估期间，基本的东西`Object`（甚至`String`构造函数）都不可用。

Slidejs 插件正在分离幻灯片 div 的内容（您可以看到 jQuery`wrapAll`调用，它有效地删除和重新附加幻灯片的内容）。我尝试仅在 slidejs 完成初始化后才加载 iframe，但即使只是将 iframe 容器`display`CSS 属性设置为`none`也会阻止 iframe 在 IE9 中可见。这是 IE9 如何处理 iframe 的另一个问题。

您可以做的另一件事是仅在幻灯片显示后初始化小部件 iframe，但不幸的是，slidejs 没有为该事件提供回调 API。

所以，我的建议是尝试另一个插件，它可以为您提供相同的功能，但可以让您在显示的幻灯片上创建 iframe，或者通过隐藏幻灯片`position:absolute;left:-9999px`或类似的东西而不是使用`display:none`.

我希望这有帮助！

**升级版**。MSDN“移动”（或删除）了该链接的内容。那篇文章的 Wayback 机器链接在[这里](http://web.archive.org/web/20120731184626/http://msdn.microsoft.com/en-us/library/gg622929%28v=VS.85%29.aspx?ppud=4)。

# google-app-engine - 如何为 Google 应用引擎开发设置 Eclipse-Pydev

> ID：13533981
> 
> 赞同：3
> 
> 时间：2012-11-23T18:07:31.657
> 
> 标签：google-app-engine, pydev, eclipse-juno

我正在尝试在 Eclipse Juno 上使用 PyDev 创建一个 GoogleAppEngine 项目。我对 Python 和 AppEngine 非常陌生。所以 PyDev 会问我文件`Google App Engine Directory`在哪里`appcfg.py`。我已经安装了 GAE，它在 IDLE 中运行良好（我使用的是 Mac）。

有人设置成功了吗？基本上，我不知道目录在哪里。我当然假设这是唯一的问题。

我已经尝试使用, , .`appcfg.py`从终端查找。但到目前为止还没有成功。`find . -name appcfg.py``mdfind -name appcfg.py``whereis appcfg.py`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T21:58:16.610

试试这个：

> 输入以下内容：
> 
> /Applications/GoogleAppEngineLauncher.app/Contents/Resources/ GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/

有关更多详细信息，请参阅[此](https://groups.google.com/forum/?fromgroups=#!topic/google-appengine-python/xZQusVOJAJw)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-07T15:42:40.700

只是为了非常快速地为 Mavericks 更新它，我尝试了这个，但 Eclipse 不会将“GoogleAppEngine-default.bundle”视为目录。这有点奇怪，但我在 Open 对话框中使用了“Quick Look”（“Ctl-Click, Quick Look”，不只是按空格键）打开 Eclipse 包，然后再次打开 .bundle 目录。您必须实际单击“快速查看”；双击似乎不起作用。出于某种原因，它随后将捆绑目录视为一个目录并允许我打开它。之后，我只是导航到@payala 提到的目录，它找到了它需要的所有文件。

# java - GroupLayout 一次只能与一个容器一起使用

> ID：13533982
> 
> 赞同：14
> 
> 时间：2012-11-23T18:07:33.103
> 
> 标签：java, swing, exception, layout-manager, grouplayout

不知道为什么会出现这个错误。我使用 GroupLayout 是因为我希望它为我做间距，并且将来会在框架中添加更多面板。下面是堆栈跟踪。

```
Exception in thread "main" java.lang.IllegalArgumentException: GroupLayout can only be used with one Container at a time
    at javax.swing.GroupLayout.checkParent(Unknown Source)
    at javax.swing.GroupLayout.invalidateLayout(Unknown Source)
    at java.awt.Container.invalidate(Unknown Source)
    at java.awt.Component.addNotify(Unknown Source)
    at java.awt.Container.addNotify(Unknown Source)
    at javax.swing.JComponent.addNotify(Unknown Source)
    at java.awt.Container.addNotify(Unknown Source)
    at javax.swing.JComponent.addNotify(Unknown Source)
    at java.awt.Container.addNotify(Unknown Source)
    at javax.swing.JComponent.addNotify(Unknown Source)
    at javax.swing.JRootPane.addNotify(Unknown Source)
    at java.awt.Container.addNotify(Unknown Source)
    at java.awt.Window.addNotify(Unknown Source)
    at java.awt.Frame.addNotify(Unknown Source)
    at java.awt.Window.pack(Unknown Source)
    at client.AlternateGUI.drawGui(AlternateGUI.java:54)
    at client.AlternateGUI.main(AlternateGUI.java:24) 
```

这是代码：

```
package client;

import java.awt.Component;*

public class AlternateGUI {
    private JList people;
    private DefaultListModel dlm;
    private JLabel l1, l2, l3;
    private JFrame alternateGUIFrame;
    private final static ImageIcon unavailableIcon = new ImageIcon("offline.png");

    public static void main(String[] args)
    {
        AlternateGUI ls = new AlternateGUI();
        ls.drawGui();
    }

    public AlternateGUI(){
        dlm = new DefaultListModel();
        people = new JList(dlm);

        alternateGUIFrame = new JFrame();

        JScrollPane peopleScroller = new JScrollPane(people, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
        people.setCellRenderer(new CellRenderer());

        GroupLayout alternateGUILayout = new GroupLayout(alternateGUIFrame);
        alternateGUIFrame.setLayout(alternateGUILayout);

        alternateGUILayout.setAutoCreateGaps(true);
        alternateGUILayout.setAutoCreateContainerGaps(true);
        alternateGUILayout.setHorizontalGroup(alternateGUILayout.createSequentialGroup()
                .addComponent(peopleScroller));
        alternateGUILayout.setVerticalGroup(alternateGUILayout.createSequentialGroup()
                .addComponent(peopleScroller));
        }

    public void drawGui() {
        l1 = new JLabel("Hi", unavailableIcon , JLabel.LEFT);
        l2 = new JLabel("Hello", unavailableIcon , JLabel.LEFT);
        l3 = new JLabel("Bye", unavailableIcon , JLabel.LEFT);
        dlm.addElement(l1);
        dlm.addElement(l2);
        dlm.addElement(l3);

        alternateGUIFrame.pack();
        alternateGUIFrame.setVisible(true);
    }

    class CellRenderer implements ListCellRenderer
    {
        public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus)
        {
            Component com = (Component)value;
            return com;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-23T18:17:53.827

您的问题是您在不知不觉中将布局添加到 JFrame 及其 contentPane 中。解决方案是确保仅将其添加到 JFrame 的 contentPane 中：

```
 GroupLayout alternateGUILayout = new GroupLayout(alternateGUIFrame.getContentPane());
  alternateGUIFrame.getContentPane().setLayout(alternateGUILayout); 
```

最重要的是上面的第一行。

另一种选择是使用 JPanel，然后将 JPanel 添加到 JFrame 的 contentPane 的默认 BorderLayout.CENTER 位置。

# python - 为什么在 ajax 调用时从 django 侦听器发送电子邮件会导致管道损坏？

> ID：13533984
> 
> 赞同：1
> 
> 时间：2012-11-23T18:07:34.383
> 
> 标签：python, ajax, django, email, satchmo

我有一个发送电子邮件的 django 监听器。在正常情况下它工作得很好，但是当它被 AJAX 触发时，我在控制台上看到了这个错误：

```
[Errno 32] Broken pipe 
```

我正在使用***python manage.py runserver***对其进行测试，因此控制台上出现错误。

我的怀疑是，因为它只发生在 AJAX ***POST***发生时，它必须与在电子邮件有时间完全发送之前关闭 AJAX 套接字有关，并且当它最终发送时，无处响应去。这听起来可行吗？错误是`/usr/lib/python2.6/socket.py`在类`_fileobject : flush()`方法中报告的。

这是侦听器设置的片段：

```
signals.satchmo_order_status_changed.connect(capture_new_order_listener)

def capture_new_order_listener(sender, oldstatus="", newstatus="", order=None, **kwargs):
    email_notify(order, template = 'shop/email/foo.xt', template_html = 'shop/email/foo.html') 
```

然后我有这个：

```
def email_notify(order, template='', template_html=''):
    ...
    send_store_mail(subject, c, template, [order.contact.email],
                template_html=template_html, format_subject=True,
                sender=order_confirmation_sender) 
```

AJAX python 处理程序如下所示：

```
def ajax_update(request, **kwargs):
    order.add_status('New') # Triggers sending an email 
```

AJAX jquery 看起来像这样：

```
<script src="/static/js/jquery-1.4.2.js" type="text/javascript"></script>
<script>
$(document).ready(function(){
    $("#submit").mousedown(function(){
        $.post("{% url ajax_update %}",
        {
            some_var:$("#some_var").val(),
        },
        function(data,status){
            alert("Data: " + data + "\nStatus: " + status);
        });
    });

});
</script> 
```

我该如何摆脱这个错误？还是我应该忽略它？我不确定它将如何影响 Apache/WSGI 服务器。看来我无法在 send_store_mail() 捕获异常

***编辑1：***

以下是异常的全文：

```
----------------------------------------
Exception happened during processing of request from ('127.0.0.1', 36564)
Traceback (most recent call last):
  File "/usr/lib/python2.6/SocketServer.py", line 283, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python2.6/SocketServer.py", line 309, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python2.6/SocketServer.py", line 322, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/pymodules/python2.6/django/core/servers/basehttp.py", line 562, in __init__
    BaseHTTPRequestHandler.__init__(self, *args, **kwargs)
  File "/usr/lib/python2.6/SocketServer.py", line 618, in __init__
    self.finish()
  File "/usr/lib/python2.6/SocketServer.py", line 661, in finish
    self.wfile.flush()
  File "/usr/lib/python2.6/socket.py", line 304, in flush
    self._sock.sendall(buffer(data, write_offset, buffer_size))
error: [Errno 32] Broken pipe
---------------------------------------- 
```

非常感谢！

# c# - 使用数组将数字转换为单词

> ID：13533989
> 
> 赞同：0
> 
> 时间：2012-11-23T18:08:13.160
> 
> 标签：c#, arrays

我正在尝试为英语单词程序制作一个简单的数字，我决定使用数组。但是，每当我输入一个大于 99 的数字时，我会在第三个 if 子句中得到一个错误。我需要更改什么来解决这个问题？这是我的代码；

```
 class Program
    {
        static void Main(string[] args)
        {
         string[] uptonineteen = {"Zero","One","Two","Three","Four",
        "Five","Six","Seven","Eight","Nine","Ten",
        "Eleven","Twelve","Thirteen","Fourteen","Fifteen",
        "Sixteen","Seventeen","Eighteen","Nineteen"};
        string[] ten = {"","","Twenty","Thirty","Forty","Fifty",
        "Sixty","Seventy","Eighty","Ninety",};
        Console.WriteLine(" ---------------");
        int i = int.Parse(Console.ReadLine());
            if (i < 20)
            {
                Console.WriteLine(uptonineteen[i]);
            }
            if (i < 100)
            {
                Console.WriteLine(ten[i / 10] + ((i % 10 > 0) ? "" + uptonineteen[i%10] : ""));
            }
            if (i <= 999)
            {
                object lenthree = ten[i / 100] + "hundred"+" " + ((i % 100 > 0) ? "and" +" "+  uptonineteen[i % 1000] : "");
                Console.WriteLine(lenthree);
            } 
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T19:12:20.650

我已经看过太多次了...这个处理，例如写支票，您可能需要花费数百万，数千甚至包括美分...

```
public class NumToWords
{
    public NumToWords()
    {}

    string[] OneToNineteen = 
        { "zero",   
          "one",    "two",    "three",    "four",     "five",    "six",     "seven",     "eight",    "nine",   "ten",   
          "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen" };

    // empty string for zero-place-holder for tens grouping
    string[] Tens = { "", "ten", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety" };

    // leave blank for "hundreds" because you would NOT do 123 as One hundred twenty-three hundred.
    string[] Block3Section = { "", "thousand", "million", "billion" };

    public string ToEnglish(int num)
    {
        int Block3Seq = 0;
        int curSegment;
        int tmp;
        string FinalWords = "";
        string curWord = "";

        while (num > 0)
        {
            curSegment = num % 1000;    // get only 3 digits worth (right) of the number
            num = (num - curSegment) / 1000;  // subtract this portion from the value

            if (curSegment > 0)
            {
                // always add the closing word as we HAVE something to build out
                curWord = "";

                // how many "hundreds" of the current segment
                tmp = (int)curSegment / 100;
                if (tmp > 0)
                    curWord += " " + OneToNineteen[tmp] + " hundred";

                // what is remainder of this 100 based segment
                tmp = curSegment % 100;

                if (tmp < 20)
                    curWord += " " + OneToNineteen[tmp];
                else
                {
                    curWord += " " + Tens[(int)tmp / 10]
                                + '-' + OneToNineteen[tmp % 10];
                }

                // always add the closing word as we HAVE something to build out
                curWord += " " + Block3Section[Block3Seq];

                // add the section above to the overall words
                FinalWords = curWord + FinalWords;
            }

            // to allow the next closing word for segment such as thousand, million, billion, etc
            Block3Seq++;
        }

        return FinalWords;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:14:18.223

尝试这个...

```
class Program
{
    static void Main(string[] args)
    {
        string[] uptonineteen = {"Zero","One","Two","Three","Four",
        "Five","Six","Seven","Eight","Nine","Ten",
        "Eleven","Twelve","Thirteen","Fourteen","Fifteen",
        "Sixteen","Seventeen","Eighteen","Nineteen"};
        string[] ten = {"", "","Twenty","Thirty","Forty","Fifty",
        "Sixty","Seventy","Eighty","Ninety",};
        Console.WriteLine(" ---------------");
        int i = int.Parse(Console.ReadLine());
        if (i < 20)
        {
            Console.WriteLine(uptonineteen[i]);
        }
        else if (i < 100)
        {
            Console.WriteLine(((((i % 100) / 10) > 1) ? ten[((i % 100) / 10)] + ((i % 10) > 0 ? " " + uptonineteen[(i % 10)] : "") : " and " + uptonineteen[i % 100]));
        }
        else if (i <= 999)
        {
            object lenthree = uptonineteen[(i % 1000) / 100] + " hundred " + ((((i % 100) / 10) > 1) ? ten[((i % 100) / 10)] + ((i % 10) > 0 ? " " + uptonineteen[(i % 10)] : "") : " and " + uptonineteen[i % 100]);
            Console.WriteLine(lenthree);
        } 
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-17T13:34:47.097

```
string[] ones = { "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", 
                            "eleven", "twelve", "thirtheen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen","nineteen", "twenty" };
string[] tens = { "Ten", "Twenty", "Thirthy", "Fourty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"};

        Console.WriteLine("Enter a number");
        int i = int.Parse(Console.ReadLine());
        if (i < 20)
        {
            Console.WriteLine(ones[i]);
        }
        if (i > 30  & i < 100)
        {
            Console.WriteLine(tens[((i%100)/10)-1]+ " " + ones[(i % 10)]);
        }
        if (i > 100 & i < 1000)
        {
            if (((i % 100) % 10) == 0)
            {
                Console.WriteLine(ones[(i / 100)] + " hundred " + tens[((i % 100) / 10) - 1]);
            }
            else
            {
                Console.WriteLine(ones[(i / 100)] + " hundred " + tens[((i % 100) / 10) - 1] + " and " + ones[((i % 100) % 10)]);
            }
        }
        Console.ReadLine(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T18:13:28.083

```
string lenthree = ten[i / 100] + "hundred" + " " + 
    ((i % 100 > 0) ? "and" + " " + uptonineteen[i % 100] : ""); 
```

最后的 1000 应该是 100。但是由于您`uptonineteen`的未满，您仍然无法正确输入完整的数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T19:02:22.980

处理完一个案例后`number > x`，您应该继续处理其余的`number = number % x`或`number %= x`相同的。此外，您应该真正区分获取英文文本和在控制台上进行测试。`Console.WriteLines`并且`Console.ReadKeys`不应该出现在逻辑上。`StringBuilder`使用以下通用结构使用 a 构建英文字符串：

```
public static string ToEnglish(int number)
{
    var sb = new StringBuilder();
    if (number >= 100) {
        ...
        number %= 100;
    }
    if (sb.Length > 0 && number != 0) {
        sb.Append("and ");
    }
    if (number >= 20) {
        ...
        number %= 10;
    }
    if (sb.Length == 0 || number != 0) {
        ...
    }
    return sb.ToString();
} 
```

注意：我没有发布完整的解决方案，因为我承担了它的功课。

* * *

控制台测试看起来像这样

```
while (true) {
    Console.Write("Please enter a number or `q` to quit: ");
    string s = Console.ReadLine();
    if (s == "q") {
        break;
    }
    int i = int.Parse(s);
    Console.WriteLine(ToEnglish(i));
} 
```

# php - 调整 usort 函数以对 2 个字段之一进行排序

> ID：13533994
> 
> 赞同：0
> 
> 时间：2012-11-23T18:08:59.300
> 
> 标签：php

我有两种类型的数组字段，我想根据这些字段进行排序：

第一个是**registration_date**，第二个是**preregistration_date**

这是 print_r 数组输出（存储在变量**$unsorted_users**中）：

```
Array
(
    [0] => stdClass Object
        (
            [id] => 120
            [registration_date] => 2012-10-19 16:57:46
            [username] => Jeff
        )
    [1] => stdClass Object
        (
            [id] => 121
            [preregistration_date] => 2012-12-23 16:57:46

        )
    [2] => stdClass Object
        (
            [id] => 122
            [registration_date] => 2012-11-30 16:57:46
            [username] => Susan
        )

) 
```

我想通过**registration_date**和**preregistration_date订购这个数组****DESC** ，所以它看起来像这样：

 ****数组（[0] => stdClass 对象（[id] => 121 [preregistration_date] => 2012-12-23 16:57:46

```
 )
    [1] => stdClass Object
        (
            [id] => 122
            [registration_date] => 2012-11-30 16:57:46
            [username] => Susan

        )
    [2] => stdClass Object
        (
            [id] => 120
            [registration_date] => 2012-10-19 16:57:46
            [username] => Jeff

        )

) 
```

我的排序功能是：

```
$sorted_users = usort($unsorted_users, function($a, $b) {
   return strcmp ($a->registration_date, $b->registration_date) ;
}); 
```

但是，它只是按**registration_date**排序，如果没有registration_date，例如：

```
 [1] => stdClass Object
            (
                [id] => 121
                [preregistration_date] => 2012-12-23 16:57:46

            ) 
```

我得到一个错误。

如何调整我的功能，使其是 registration_date 或 preregistation_date 排序？

顺便提一句。registration_date 和 preregistration_date 的格式始终相同，并且两者不能在一个对象中。所以，这不需要验证。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:14:55.363

像这样？

```
$sorted_users = usort($unsorted_users, function($a, $b) {
   $registrationDateA = empty($a->registration_date) ? 
      $a->preregistration_date : $a->registration_date;
   $registrationDateB = empty($b->registration_date) ? 
      $b->preregistration_date : $b->registration_date;
   return strcmp ($registrationDateA, registrationDateB) ;
}); 
```****