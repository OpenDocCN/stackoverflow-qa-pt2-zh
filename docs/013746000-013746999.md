# StackOverflow 问答 13746000-13746999

# javascript - 刷新我的 jQuery 数据表的具体示例？

> ID：13746000
> 
> 赞同：1
> 
> 时间：2012-12-06T14:43:31.643
> 
> 标签：javascript, jquery, datatables

我有以下[jQuery 数据表](http://datatables.net/)：

```
$("#my-datatable").dataTable( {
    "bProcessing" : true,
    "bPaginate": false,
    "bLengthChange": false,
    "bFilter": true,
    "bSort": false,
    "bInfo": false,
    "bAutoWidth": false,
    "sAjaxSource" : "/myServer/getAllWidgets",
    "sAjaxDataProp" : "",
    "bDestroy" : true,
    "fnServerData" : function(sSource, aoData, fnCallback) {
        aoData.push({
            "name" : "widgetName",
            "value" : wName
        });

        request = $.ajax({
            "dataType" : "json",
            "type" : "GET",
            "url" : sSource,
            "data" : aoData,
            "success" : fnCallback
        });
    },

    "aoColumns" : [
        {
            "mDataProp" : "widgetType"
        },
        {
            "mDataProp" : "widgetValue"
        },
        {
            "mDataProp" : "widgetFactor"
        }
    ]
}); 
```

这成功地访问了我的 Web 服务器，并在我的 UI 上`/myServer/getAllWidgets`填充了一个 3 列数据表（列标题为：*Type*、*Value*和*Factor ）。*到现在为止还挺好。

问题是，`widgets`支持此 dataTable 的 MySQL 表经常更改，我想在我的 UI 中添加一个按钮，这样当用户单击该按钮时，dataTable 会刷新，这意味着`/myServer/getAllWidgets`再次运行并显示正确的记录/值用户。

在过去的一天里，我试图让它工作，但我尝试的一切都失败了。就个人而言，我不在乎我*如何*获得这个“刷新”功能，也不在乎解决方案是否根本不涉及`fnReloadAjax`（这是我一直在努力的工作）。我只需要一些有用的东西：

```
<div id="refresh-button-div">
    <input type="button" id="refreshButton" onclick="refreshData"/>
</div>

// In JS
$("#refreshButton").click(function() {
    // ???
}); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T14:48:21.700

您可以使用该`fnDraw`函数重绘表格。试试这个：

```
var $dataTable = $("#my-datatable").dataTable({ /* setup */ });

$("#refreshButton").click(function() {
    $dataTable.fnDraw();
}); 
```

阅读文档中[的](http://datatables.net/api)`fnDraw`条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:36:36.760

我使用`fnReloadAjax();`ajax 源重新加载表数据

```
$("#refreshButton").click(function() {
    oTable.fnReloadAjax();
}); 
```

只是改变

```
$("#my-datatable").dataTable( {... 
```

进入

```
oTable = $("#my-datatable").dataTable( {...//make oTable a global var in your js 
```

您可以从此处获取此数据表插件源[fnReloadAjax](http://datatables.net/plug-ins/api)，将其放入某个 js 文件中并将其包含在您的页面中...

# java - Hibernate 进行两次插入并导致违反唯一键约束

> ID：13746002
> 
> 赞同：2
> 
> 时间：2012-12-06T14:43:38.003
> 
> 标签：java, sql, hibernate, jboss

您好我得到这个“javax.persistence.PersistenceException：org.hibernate.exception.ConstraintViolationException：错误：重复键值违反唯一约束”

我有两张桌子A和B，

A 有 id，b_id，B 有 id，A_id 的。A - oneToMany ， B - manyToOne 关系。

在 A 上，

```
@OneToOne(cascade = { CascadeType.ALL })
@JoinColumn(name = "LATEST_VERSION_ID") @Valid
@EntityProperty(type = "GuidKey", relation = "B.id") 
```

在 B 上，

```
@ManyToOne(cascade = {CascadeType.ALL})
@JoinColumn(name = "A_ID") @Valid
@EntityProperty(type = "Key", relation = "A.id") 
```

当我创建 Page AI 时能够这样做，但是当我尝试更新时，我在表“B”上遇到了唯一约束违规。

它说记录已经存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T01:44:08.720

`mappedBy`您必须使用该属性建立双向关系。

看：

*   [一对一的双向休眠映射](https://stackoverflow.com/questions/7777333/one-to-one-bidirectional-hibernate-mapping)

*   [http://www.mkyong.com/hibernate/hibernate-one-to-one-relationship-example-annotation](http://www.mkyong.com/hibernate/hibernate-one-to-one-relationship-example-annotation)

*   [http://www.codereye.com/2009/04/hibernate-bi-directional-one-to-one.html](http://www.codereye.com/2009/04/hibernate-bi-directional-one-to-one.html)

此外，这不需要@EntityProperty。外键应该一对一地在一个表中。

# asp.net - asp.net 无法将类型 DataRowView 转换为 DbDataRecord

> ID：13746005
> 
> 赞同：0
> 
> 时间：2012-12-06T14:43:46.150
> 
> 标签：asp.net

使用 c# 在 asp.net 上工作。我有一个数据集函数。

该函数分配给数据网格数据源：

```
DataGrid2.DataSource = datasetfunction(parameter); 
```

但是当达到数据绑定时：

```
DataGrid2.DataBind(); 
```

它抛出错误：“无法将类型 System.Data.DataRowView 转换为 System.Data.Common.DbDataRecord”

需要注意的一点：相同的函数是 sqldatareader 类型，但我需要更改为数据集类型。所以在函数中，我将 sqldatareader 转换为数据表，然后将数据表转换为数据集。那么现在我得到这个错误。

我该如何解决这个问题？

谢谢

# sql - 计算公式中的sql问题

> ID：13746009
> 
> 赞同：0
> 
> 时间：2012-12-06T14:43:56.767
> 
> 标签：sql, sql-server, database, sql-server-2008, tsql

当我试图在视图中计算结果小于 1 的公式时遇到问题。例如，我有下一个公式：`Arenda*TotalArea/10000 as TotalArenda` 如果我有 Arenda=10 和 TotalArea=10，我会得到 TotalArenda=0,00，而通常应该0.01 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T14:46:32.673

使 Arenda = 10.0 和 TotalArea = 10.0 而不是 10 和 10。这将迫使 SQL 不使用整数数学，您将获得所需的准确性。

事实上，我能得到 0.0 的唯一方法是如果 Arenda 为 10（整数），而 TotalArea 或 10000 中至少有一个包含小数和尾随 0，并且只有当我通过使用括号进行分组来覆盖操作顺序时如

```
select 10.0* (10/10000) as blah 
```

如果都是整数，你得到 0。如果所有都包含小数，你得到 0.01。如果我删除括号，如果其中任何一个是非整数类型，我会得到 0.01。

如果精度非常重要，我建议您转换为小数而不是浮点数：

```
select CONVERT(decimal(10,2), Arenda) * CONVERT(decimal(10,2), TotalArea) / 10000.0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T14:51:29.203

您正在使用列，因此更改类型可能不可行。SQL Server 对整数进行整数除法（其他数据库的行为不同）。尝试其中之一：

```
cast(Arenda as float)*cast(TotalArea as float)/10000 
```

或者：

```
Arenda*TotalArea/10000.0 
```

# mysql - 从表中选择最新的不同电子邮件地址

> ID：13746010
> 
> 赞同：0
> 
> 时间：2012-12-06T14:44:01.023
> 
> 标签：mysql

非常快的一个：

我以前做过，但现在脑子有点空白。

```
SELECT max(id) as id, username, email 
FROM user_info 
WHERE username!='' 
GROUP by id,email 
```

不幸的是，这不起作用。它将选择最大 id，但不会选择该行中的相应数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:46:19.880

~~如果每个电子邮件地址有多个 id，则只能使用`max(id)`电子邮件并按电子邮件分组。~~

 ~~```
SELECT max(id) as id, username, email 
FROM user_info 
WHERE username <> '' 
GROUP by email, username 
```~~  ~~您可以使用将返回子查询中的最大 id 的子查询，然后使用它在表上自我加入以返回最新的 id、用户名和电子邮件：

```
SELECT u.id, u.username, u.email 
FROM user_info u
INNER JOIN
(
  select max(id) maxid, email
  from user_info
  where username <> '' 
  group by email
) u2
  on u.id = u2.maxid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/100a2/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:19:31.010

```
Select DISTINCT(email), MAX(id)
FROM user_info
GROUP by email
ORDER BY id DESC 
```~~

# java - 通过部署描述符禁用拦截器

> ID：13746011
> 
> 赞同：1
> 
> 时间：2012-12-06T14:44:05.413
> 
> 标签：java, jakarta-ee, interceptor

场景：@PerformanceMeasureInterceptor 在整个代码中的各种方法和类。这就像名字所暗示的那样......

当然，这在生产中不应该是活跃的。那么如何禁用“注释拦截器”进行部署呢？

到目前为止，这些是我的想法： - 在编译生产之前通过预处理从所有 java 文件中删除 - 仅通过部署描述符（无注释）使用并在部署前更改它

两个人都有点不舒服……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:58:29.610

您应该尝试编写一个 CDI 扩展，让您仅在满足某些条件（环境）时才在编译时添加拦截器。

# html - 如何定义多个 CSS 背景属性？

> ID：13746030
> 
> 赞同：1
> 
> 时间：2012-12-06T14:45:11.907
> 
> 标签：html, css

有没有可能让这些背景一起工作？

```
background: url("../images/search.png") no-repeat scroll 9px 4px transparent;
background:-webkit-gradient( linear, left top, left bottom, color-stop(0, #fdca14), color-stop(1, #ff8d02) );
background:-moz-linear-gradient( center top, #fdca14 0%, #ff8d02 100% ); 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T14:46:44.340

[CSS3](http://css-tricks.com/stacking-order-of-multiple-backgrounds/)允许它。这是在同一背景中使用多个背景图像的示例：

```
.exampleClass {
    background-image: url(images/example1.png), url(images/example2.png);
    background-repeat: repeat-x, repeat;
} 
```

[所有主流浏览器都](http://caniuse.com/multibackgrounds)支持它（遗憾的是，IE8 和之前的浏览器除外）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T14:52:10.133

如果您需要能够在较旧的 IE 浏览器中执行此操作，您可能还想查看[CSS3 Pie 。](http://css3pie.com/documentation/supported-css3-features/#pie-background)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T14:48:35.343

**CSS**

```
.class{
    background: url("../images/search.png") no-repeat scroll 9px 4px transparent,-webkit-gradient( linear, left top, left bottom, color-stop(0, #fdca14), color-stop(1, #ff8d02) ),-moz-linear-gradient( center top, #fdca14 0%, #ff8d02 100% );
} 
```

# gcc - 如何修复警告：初始化器周围缺少大括号？

> ID：13746033
> 
> 赞同：55
> 
> 时间：2012-12-06T14:45:27.843
> 
> 标签：gcc, vala

警告是由 vala 生成的 c 代码产生的。

> 警告：初始化器周围缺少大括号

代码有效，但警告很烦人。警告引用的 vala 代码是

```
struct Position {uint x; uint y;}
private static Position positions[8]; 
```

生成的 C 代码是

```
static Position det_positions[8] = {0}; 
```

我尝试了六种不同的方式初始化位置，但似乎无法获得满足警告的语法。这是[GCC 错误 53119](https://stackoverflow.com/a/11552408/398460)还是有办法修复它？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-12-07T06:50:06.883

是的，这似乎与[GCC 错误 53119](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=53119)有关。如果您将 C 声明更改为`{{0}}`. 您的选择是：

1.  忽略警告。
2.  在生成后操作 C 代码，`{{0}}`而不是`{0}`在该行上使用`sed`等。
3.  在 Vala 中声明数组`extern`，并在别处编写 C 定义。（#2 的永久版本。）
4.  做类似的事情`struct foo { int bar; Position positions[8]; } static foo position_holder`，然后`{0}`将进行初始化`position_holder.bar`，这很好，警告消失了。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-02-19T07:17:58.457

当设置了 -Wall 编译器标志的多维数组被视为线性数组（尽管它仍然正确并且代码运行完美）时，也会出现此警告。

例如

```
char array[5][10][2] = {\
"0","0","0","0","0","0","0","0","0","0",\
"1","1","1","1","1","1","1","1","1","1",\
"2","2","2","2","2","2","2","2","2","2",\
"3","3","3","3","3","3","3","3","3","3",\
"4","4","4","4","4","4","4","4","4","4" }; 
```

这将生成警告。

执行以下更改以删除警告，如下所示

```
char array[5][10][2] = {\
{"0","0","0","0","0","0","0","0","0","0" },\
{"1","1","1","1","1","1","1","1","1","1"},\
{"2","2","2","2","2","2","2","2","2","2"},\
{"3","3","3","3","3","3","3","3","3","3"},\
{"4","4","4","4","4","4","4","4","4","4"} }; 
```

如果我错了，请纠正我。

# java - 在Java中子类化一个动态加载的类

> ID：13746034
> 
> 赞同：2
> 
> 时间：2012-12-06T14:45:27.990
> 
> 标签：java, reflection

假设我通过`Class`使用`Class.forName("Foo")`. `Foo`在这种情况下是抽象的，所以我不能调用`newInstance()`它。（如何）可以声明一个具体的子类`Foo`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:48:35.810

你声明它不是抽象的，例如

```
class Bar extends Foo {
    // implement methods are required.
} 
```

简而言之，仅仅因为您动态加载了类并不意味着规则会改变；）

> Foo 在编译时不可用

如果您在编译时没有 Foo 可用，您仍然需要有一个此类的子类来具体创建它。为此，您有两个选择。

*   找到一个具体的类并创建它。您可以使用[Reflections](http://code.google.com/p/reflections/)库找到这样的类。
*   生成代码并使用 Compiler API 或 BeanShell 对其进行编译。
*   使用 ObjectWeb 的 ASM 为子类生成字节码。

我怀疑第一个选项是您需要的，因为除非为您提供子类，否则您仍然需要为抽象方法生成代码。

# android - Android 4.2 - 设置 minDate 并在 minDate 之前选择日期时，DatePicker 崩溃

> ID：13746035
> 
> 赞同：1
> 
> 时间：2012-12-06T14:45:36.690
> 
> 标签：android, datepicker

在 4.2 JB 中，我使用 DatePicker 的应用程序崩溃。仅当设置了 minDate (setMinDate) 时才会发生这种情况。当我滚动到 minDate 之前的日期时，应用程序崩溃。

崩溃发生在我的三星 Galaxy Nexus 和带有 Android 4.2 的模拟器上。使用带有 Android 4.1 的模拟器不会出现此错误。

我针对 4.2 (API 17) 构建应用程序。

还有其他人有这个问题还是只有我一个？

我已经创建了一个错误报告。你可以在那里看到崩溃日志。 [谷歌错误报告](https://code.google.com/p/android/issues/detail?id=41025)

更新：似乎他们在 4.2.1 中修复了这个错误

# javascript - dijit/MenuItem 已禁用但未自动变灰

> ID：13746037
> 
> 赞同：2
> 
> 时间：2012-12-06T14:45:42.327
> 
> 标签：javascript, dijit.form

我在 JS Canvas 对象的弹出菜单中使用了 dijit/MenuItem。当用户右键单击画布时，我想显示菜单并根据用户选择的位置禁用一些项目。因此，我在 Canvas 的 onmousedonw 事件中编码以禁用该项目。

一切正常，除了当我右键单击并且 menuitem 从启用更改为禁用时，菜单中的项目仍显示为正常状态，直到我将鼠标移到它上面，然后它显示为灰色为禁用。有没有办法在更改禁用状态后以某种方式“刷新”菜单项，以便在菜单显示时立即显示为灰色？

菜单的 HTML

```
<ul dojoType="dijit/Menu" id="menu" style="display: none;border-radius:3px;">
<div dojoType="dijit/MenuItem" id="Popup_Cut"><span>Cut</span></div></ul> 
```

用于禁用的 JS

```
function handleMouseDown(event) {

 if(...)
     dijit.byId("Popup_Cut").disabled = true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:17:37.263

而不是使用属性`disabled`，而是使用`set`方法：

```
dijit.byId('Popup_Cut').set("disabled",true); 
```

有同样的问题，这对我有用。

更多信息`set`： [http ://dojotoolkit.org/reference-guide/1.8/dijit/info.html#set-and-get](http://dojotoolkit.org/reference-guide/1.8/dijit/info.html#set-and-get)

# php - 在 tinymce 编辑器中浏览图像的问题

> ID：13746042
> 
> 赞同：2
> 
> 时间：2012-12-06T14:46:02.263
> 
> 标签：php, image, upload, tinymce

我正在尝试在 tinymce 编辑器中实现照片上传选项。为此，我上传了最新版本的 ajaxfilemanager。我只是把文件夹放在tinymce的插件文件夹下。并在插件文件夹下再创建一个名为“uploaded”的文件夹。还要修改`tinyMCE.init`like的代码

```
tinyMCE.init({
// General options
  mode : "textareas",
  elements : "ajaxfilemanager",
  theme : "advanced",
  plugins : "pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave,paste,fullscreen,noneditable,contextmenu",
    theme_advanced_buttons1_add_before : "newdocument,separator",
    theme_advanced_buttons1_add : "fontselect,fontsizeselect",
    theme_advanced_buttons2_add : "separator,forecolor,backcolor,liststyle",
    theme_advanced_buttons2_add_before: "cut,copy,paste,pastetext,pasteword,separator,",
    theme_advanced_buttons3_add_before : "tablecontrols,separator",
    theme_advanced_buttons3_add : "flash,advhr,separator,fullscreen",
    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    extended_valid_elements : "hr[class|width|size|noshade]",
    file_browser_callback : "ajaxfilemanager",
    paste_use_dialog : false,
    theme_advanced_resizing : true,
    theme_advanced_resize_horizontal : true,
    apply_source_formatting : true,
    force_br_newlines : true,
    force_p_newlines : false,
    relative_urls : true,

    // Example content CSS (should be your site CSS)
    // using false to ensure that the default browser settings are used for best Accessibility
    // ACCESSIBILITY SETTINGS
    content_css : false,
    // Use browser preferred colors for dialogs.
    browser_preferred_colors : true,
    detect_highcontrast : true,

    // Drop lists for link/image/media/template dialogs
    template_external_list_url : "lists/template_list.js",
    external_link_list_url : "lists/link_list.js",
    external_image_list_url : "lists/image_list.js",
    media_external_list_url : "lists/media_list.js",

    // Style formats
    style_formats : [
     {title : 'Bold text', inline : 'b'},
     {title : 'Red text', inline : 'span', styles : {color : '#ff0000'}},
     title : 'Red header', block : 'h1', styles : {color : '#ff0000'}},
     {title : 'Example 1', inline : 'span', classes : 'example1'},
     {title : 'Example 2', inline : 'span', classes : 'example2'},
     {title : 'Table styles'},
     {title : 'Table row 1', selector : 'tr', classes : 'tablerow1'}
    ],

    // Replace values for the template plugin
    template_replace_values : {
     username : "Some User",
     staffid : "991234"
    }
    });
function ajaxfilemanager(field_name, url, type, win) {
    var ajaxfilemanagerurl = "../tinymce/jscripts/tiny_mce/plugins/ajaxfilemanager/ajaxfilemanager.php?editor=tinymce";
    switch (type) {
        case "image":
            break;
        case "media":
            break;
        case "flash":
            break;
        case "file":
            break;
        default:
            return false;
    }
    var fileBrowserWindow = new Array();
    fileBrowserWindow["file"] = ajaxfilemanagerurl;
    fileBrowserWindow["title"] = "Ajax File Manager";
    fileBrowserWindow["width"] = "782";
    fileBrowserWindow["height"] = "440";
    fileBrowserWindow["close_previous"] = "no";
    tinyMCE.openWindow(fileBrowserWindow, {
      window : win,
      input : field_name,
      resizable : "yes",
      inline : "yes",
      editor_id : tinyMCE.getWindowArg("editor_id")
    });

    return false;
} 
```

我还修改了文件`ajaxfilemanager/inc`夹下的 config.base.php 文件。

```
define('CONFIG_SYS_DEFAULT_PATH', 'http://localhost/object/all/tinymce/jscripts/tiny_mce/plugins/uploaded/'); //accept relative path only
define('CONFIG_SYS_ROOT_PATH', 'http://localhost/object/all/tinymce/jscripts/tiny_mce/plugins/uploaded/');  //accept relative path only 
```

但我无法打开浏览窗口。你能指导我解决这个问题吗？

我解决了一些 js 错误。现在我弹出了图像，可以上传一些图像。但是，每当我尝试获取图像 URL 时，它都会显示`undefined`在图像 URL fext 字段中。现在请帮助我如何进行。

# javascript - 每 24 小时更换一次号码

> ID：13746051
> 
> 赞同：1
> 
> 时间：2012-12-06T14:46:25.870
> 
> 标签：javascript, jquery, css, xhtml

我想提供一个大约 40 个正数的列表，然后让我的主页显示第一个数字。然后在午夜，该号码将更改为列表中的下一个号码。在列表末尾时，轮换重新开始。例如，一个用户今天多次访问我的页面并看到列表中的第一个数字。然后说凌晨 1:00，他们回到页面并查看列表中的下一个数字，并且会一直这样做到明天晚上的午夜……等等等等这可能吗？

我已经尝试了几种不同的 javascript，它们确实会根据我的列表更改数字，但是当用户转到页面时，它会重新启动列表。

我对此很陌生，我不知道你可能需要我的代码的哪一部分，因为我一直在尝试做它应该做的事情......只是不是我想要的。

我说得有道理吗？

不幸的是，我将无法在此网页上使用 php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:53:30.737

定义一个开始日期（最好是过去），计算今天的日期，将两者相减，然后使用模数将其压缩到您要显示的数字范围内：

```
var minDate = 15681, // days since 1-1-1970
nowDate = Math.ceil(new Date().getTime() / 1000 / 86400),
numbers = [1, 5, 1234, 6543, 1236456];

// get the number for today
console.log(numbers[(nowDate - minDate) % numbers.length]); 
```

如果开始日期无关紧要，您可以将表达式简化为：

```
 numbers[Math.ceil(new Date().getTime() / 86400000) % numbers.length]; 
```

顺便说一句，对于每个人来说，这不会在午夜改变，因为`.getTime()`给了 GMT 时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T14:54:49.863

您可以使用`new Date().getTime()`以毫秒为单位获取当前时间。如果将其转换为天数并向下取整，则可以找到自纪元以来的天数。取模并使用它来获取数字数组的索引。由于您始终使用当前时间（根据用户），因此您不需要存储任何 cookie 或服务器端计数器。

```
var nums = [1,1,2,3,5,8,13]; // and so on
    d = new Date(), // today
    days = d.getTime() / (1000*60*60*24), 
    idx = Math.floor(days) % nums.length;
alert(nums[idx]); // should change once a day 
```

# angularjs - AngularJS：每次启动ajax调用时都需要触发事件

> ID：13746052
> 
> 赞同：16
> 
> 时间：2012-12-06T14:46:25.840
> 
> 标签：angularjs

每次启动 ajax 调用时，我都试图在 $rootScope 上触发一个事件。

```
var App = angular.module('MyApp');

App.config(function ($httpProvider) {
    //add a transformRequest to preprocess request
    $httpProvider.defaults.transformRequest.push(function () {
        //resolving $rootScope manually since it's not possible to resolve instances in config blocks
        var $rootScope = angular.injector(['ng']).get('$rootScope');
        $rootScope.$broadcast('httpCallStarted');

       var $log = angular.injector(['ng']).get('$log');
       $log.log('httpCallStarted');
    });
}); 
```

事件“httpCallStarted”没有被触发。我怀疑在配置块中使用 $rootScope 或任何其他实例服务是不正确的。如果是这样，我如何在每次启动 http 调用时获取事件，而不必在每次调用时传递配置对象？

提前致谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-06T15:56:44.903

您总是可以将 $http 包装在服务中。由于服务只设置一次，您可以让服务工厂为您设置事件。老实说，这对我来说有点骇人听闻，但这是一个很好的解决方法，因为 Angular 还没有一个全局的方法来做到这一点，除非在 1.0.3 中添加了一些我不知道的东西。

[这是它的工作原理](http://plnkr.co/edit/UjlzmT)

这是代码：

```
app.factory('httpPreConfig', ['$http', '$rootScope', function($http, $rootScope) {
    $http.defaults.transformRequest.push(function (data) {
        $rootScope.$broadcast('httpCallStarted');
        return data;
    });
    $http.defaults.transformResponse.push(function(data){ 
        $rootScope.$broadcast('httpCallStopped');
        return data;
    })
    return $http;
}]);

app.controller('MainCtrl', function($scope, httpPreConfig) {
  $scope.status = [];

  $scope.$on('httpCallStarted', function(e) {
    $scope.status.push('started');
  });
  $scope.$on('httpCallStopped', function(e) {
    $scope.status.push('stopped');
  });

  $scope.sendGet = function (){ 
    httpPreConfig.get('test.json');    
  };
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-07T16:35:58.057

我已验证此代码将按您的预期工作。正如我上面提到的，您并没有检索您认为自己是并且需要检索用于您的应用程序的注入器。

```
discussionApp.config(function($httpProvider) {
  $httpProvider.defaults.transformRequest.push(function(data) {
    var $injector, $log, $rootScope;
    $injector = angular.element('#someid').injector();

    $rootScope = $injector.get('$rootScope');
    $rootScope.$broadcast('httpCallStarted');

    $log = $injector.get('$log');
    $log.log('httpCallStarted');
    return data;
  });
}); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-01-31T03:01:26.697

卡加泰是对的。更好地使用`$http`拦截器：

```
app.config(function ($httpProvider, $provide) {
    $provide.factory('httpInterceptor', function ($q, $rootScope) {
        return {
            'request': function (config) {
                // intercept and change config: e.g. change the URL
                // config.url += '?nocache=' + (new Date()).getTime();
                // broadcasting 'httpRequest' event
                $rootScope.$broadcast('httpRequest', config);
                return config || $q.when(config);
            },
            'response': function (response) {
                // we can intercept and change response here...
                // broadcasting 'httpResponse' event
                $rootScope.$broadcast('httpResponse', response);
                return response || $q.when(response);
            },
            'requestError': function (rejection) {
                // broadcasting 'httpRequestError' event
                $rootScope.$broadcast('httpRequestError', rejection);
                return $q.reject(rejection);
            },
            'responseError': function (rejection) {
                // broadcasting 'httpResponseError' event
                $rootScope.$broadcast('httpResponseError', rejection);
                return $q.reject(rejection);
            }
        };
    });
    $httpProvider.interceptors.push('httpInterceptor');
}); 
```

我认为`interceptors`适用于 1.1.x 之后的版本。在`responseInterceptors`那个版本之前有。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-29T23:03:36.440

最好的方法是使用 http 拦截器。检查[此](http://docs.angularjs.org/api/ng.%24http)链接

# html-lists - CSS 列表样式：低 alpha 问题

> ID：13746054
> 
> 赞同：0
> 
> 时间：2012-12-06T14:46:28.847
> 
> 标签：html-lists

标准低阿尔法产生：abc

我需要这样的东西：a）b）c）

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:25:56.260

像[这样的东西？](http://jsfiddle.net/pPwbp/)

添加了一个括号`::before`，然后使用边距将其强制到正确的位置

# sql-server - 为什么我的光标记录了 1 个额外的计数？

> ID：13746058
> 
> 赞同：0
> 
> 时间：2012-12-06T14:46:40.973
> 
> 标签：sql-server, cursor

我创建了一个带有光标的函数来计算另一个表中的所有主菜。当我这样做`PRINT dbo.cursorEnroll ();` 时，当我的表中只有 10 个主菜时，我得到 11 作为输出。@@FETCH = 0 应该意味着 fetch 成功，因此应该只设置 studentsEnrolled 10 次。我很困惑这个额外的计数来自哪里。

免责声明：我知道这不是计算表中条目数的最佳方法。但是，我只是在学习和练习游标的使用。

```
CREATE FUNCTION dbo.cursorEnroll ()
    RETURNS INT AS
    BEGIN
        DECLARE @studentsEnrolled INT
        SET @studentsEnrolled = 0
        DECLARE myCursor CURSOR FOR
            SELECT enrollementID
                FROM courseEnrollment
        OPEN myCursor;

        FETCH NEXT FROM myCursor INTO @studentsEnrolled

        WHILE @@FETCH_STATUS = 0
            BEGIN
                SET @studentsEnrolled = @studentsEnrolled+1
                    FETCH NEXT FROM myCursor INTO @studentsEnrolled
            END;
        CLOSE myCursor
        RETURN @studentsEnrolled

    END; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T14:56:50.007

因为您获取然后添加 1。对于最后一行，您`enrollementID`会得到 11 作为结果。`@studentsEnrolled``enrollementID = 10`

# android - 我能够从 Java Mail Api 访问电子邮件

> ID：13746065
> 
> 赞同：0
> 
> 时间：2012-12-06T14:46:59.297
> 
> 标签：android, email, get, jakarta-mail

我可以`JavaMail API`从此代码访问（收件箱）电子邮件

```
 public Folder getMails() throws MessagingException {
    store = imapSession.getStore("imaps");
    store.connect(mailServer, account.username, account.password);
    inbox = store.getFolder("Inbox");
    inbox.open(Folder.READ_WRITE);
    Message[] result = inbox.getMessages();

    return inbox;
} 
```

我现在可以在 ListView 中显示主题我的问题是**1.How to Show Email Content Body in android**。& **2** .我想访问雅虎邮件和微软电子邮件等。我也可以通过 JavaMail API 访问这些电子邮件。我也看到了这封[K-9 邮件](https://github.com/k9mail/k-9/tree/master/src/com/fsck/k9)，但我无法导入它。

任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T20:14:25.870

1 您可以使用[WebView](http://developer.android.com/reference/android/webkit/WebView.html)来显示消息内容，因为它会自动`HTML`为您呈现并提供缩放功能。

2 您可以从任何邮件服务器访问邮件，您只需要正确的属性。
例如，在 live 和 hotmail 的情况下，主机`pop3.live.com`和协议将`pop3s`是 MS 服务器不支持 IMAP。

另请注意：Yahoo 的免费版本不允许第三方服务访问消息。只有使用雅虎的高级服务 Yahoo! 才能访问来自雅虎的消息。加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T22:52:12.083

1.  JavaMail 允许您访问消息内容，包括纯文本和 html 内容。如何显示内容是一个与 JavaMail 无关的 GUI 问题。
2.  JavaMail 仅支持 Internet 标准协议，例如 POP3 和 IMAP。如果配置为支持这些协议，您应该能够访问 Yahoo 和 Microsoft 服务器。
3.  不要忘记阅读[JavaMail 常见问题解答](http://www.oracle.com/technetwork/java/javamail/faq/index.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T17:19:16.653

尝试使用以下代码获取邮件内容

```
private static String getMailContent(Multipart multipart) throws IOException, MessagingException{
    StringBuffer content = new StringBuffer();
    for (int x = 0; x < multipart.getCount(); x++) {
        BodyPart bodyPart = multipart.getBodyPart(x);
        String disposition = bodyPart.getDisposition();
        if (disposition != null && (disposition.equals(BodyPart.ATTACHMENT))) {
                // ................................
        } else {
            content.append(bodyPart.getContent());
        }
    }
    return content.toString();
} 
```

# c - 通过 C 中的函数操作动态数组

> ID：13746067
> 
> 赞同：2
> 
> 时间：2012-12-06T14:47:06.490
> 
> 标签：c, arrays

我正在学习如何在 C 中使用动态数组。我想做的是创建一个动态数组`data`，并使用函数将“1”放入第一个条目`test()`。

```
void test(void)
{

data[0] = 1;

}

int main(void)
{

int *data = malloc(4 * sizeof *data);

test();

return 0;
} 
```

这在 Visual Studio 2010 中编译，但程序在运行时崩溃。而不是 using `test()`， using`data[0] = 1`作品。

我（新手）的猜测是我需要将指针传递`data`给 function `test()`。我该怎么写这个？

**试图**

```
void test(int *data)
{

data[0] = 1;

} 
```

然后，在`main`使用中`test(data)`而不是仅仅`test()`.

**编辑**

尝试有效。但是，这是一种“正确”的做法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:20:27.327

当您在 C 中使用局部变量（动态或静态、数组或非数组）时，您需要将其传递给将要使用它的函数。这就是您的初始代码有什么问题，`test()`对`data`.

当您声明一个数组（动态或静态）时，您可以以相同的方式将其传递给函数。下面的代码毫无意义，但它说明了使用动态数组与静态数组并没有什么不同。

```
void assign_function(int arr[], int len_of_arr, int *arr2, int len_of_arr2);
void print_function(int *arr, int len_of_arr, int arr2[], int len_of_arr2);

int main()
{
    int data[2] = {0}; // static array of 2 ints
    int *data2 = malloc(3 * sizeof(int)); // dynamic array of 3 ints

    assign_function(data, 2, data2, 3);
    print_function(data2, 3, data, 2);

    free(data2); // One difference is you have to free the memory when you're done

    return 0;
} 
```

所以我们可以传递数组，无论是动态的还是静态的，通过`array[]`或作为指针，但我们也需要传递一个`int`，这样我们才能知道数组有多大。

```
void assign_function(int arr[], int len_of_arr, int *arr2, int len_of_arr2)
{
    int count;
    for(count = 0; count < len_of_arr; count++) //This is the static array
        arr[count] = count;

    for(count = 0; count < len_of_arr2; count++) //This is the dynamic array
        arr2[count] = count;
} 
```

然后只是为了好玩，我反转了传入的数组`arr`和`arr2`这里，以及它们是如何访问的：

```
void print_function(int *arr, int len_of_arr, int arr2[], int len_of_arr2)
{
    int count;
    for(count = 0; count < len_of_arr; count++)   //This is the dynamic array now
        printf("arr[%d] = %d\n", count, *(arr+count));

    for(count = 0; count < len_of_arr2; count++)  //And this is the static array
        printf("arr2[%d] = %d\n", count, *(arr2+count));
} 
```

指向，通过`[]`或作为指针传递，以及通过`[]`或引用指针访问取决于您，两者都很好，都可以工作。我尽量避免使用指针，因为它们往往难以阅读并且在编写时更容易出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T14:51:23.700

您可以通过两种方式动态传递数组：

*   使用简单的指针，然后使用指针算法来操作

```
void test (int * data, int i)
{
    *(data + i) = 1; //This sets data[i] = 1
} 
```

*   或者这样：

```
void test(int data[], int i)
{
    data[i] = 1; //This is the more familiar notation
} 
```

* * *

这些方法中的任何一种都是解决此问题的“正确”方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T14:49:55.857

测试中的变量“数据”是本地范围的。它与主要的“数据”不同。您应该通过 test() 的参数传递一个指向“数据”的指针。

# progress-4gl - 我正在使用 Progress 4gl 并尝试动态更改列标签，这可能吗

> ID：13746071
> 
> 赞同：0
> 
> 时间：2012-12-06T14:47:12.420
> 
> 标签：progress-4gl, openedge

我尝试了以下代码：

```
def temp-table tt-dg1
    field dtoday as date column-label "dg "
    .

buffer tt-dg1:BUFFER-FIELD("dtoday"):
column-LABEL = buffer tt-dg1:BUFFER-FIELD("dtoday"):column-LABEL + "77".

display buffer tt-dg1:BUFFER-FIELD("dtoday"):column-LABEL.

create tt-dg1.
dtoday = today.

display tt-dg1 with frame f2. 
```

期望字段`dtoday`现在有一个列标签，`dg 77`但它仍然是`dg`，我需要它来将周数添加到我正在创建的电子表格的标准列标签中。

感激地收到任何帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:28:18.537

这感觉像是一个错误。在临时表上覆​​盖它时似乎不起作用。

如果您在显示之前在框架中定义您的字段，那么您可以在那里覆盖它。

```
form tt-dg1.dtoday with frame f2.
tt-dg1.dtoday:label = "MyLabel".
display tt-dg1.dtoday with frame f2. 
```

这可能会或没有帮助取决于您在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-06T15:21:58.140

是否可以动态创建临时表？如果是这样，您可以在那里动态设置它

```
DEFINE VARIABLE ttDynTable AS HANDLE NO-UNDO.
DEFINE VARIABLE vInt       AS INTEGER NO-UNDO INIT 77.

CREATE TEMP-TABLE ttDyntable.
ttDynTable:ADD-NEW-FIELD('dtoday', 'DATE', 0, "99/99/9999",?,"","dg " + STRING(vInt)).
ttDynTable:TEMP-TABLE-PREPARE("tt-dg1").

ttTTHandle = ttDyntable:DEFAULT-BUFFER-HANDLE.
ttTTHandle:BUFFER-CREATE.
ttTTHandle::dtoday = TODAY.

DISPLAY ttTTHandle:buffer-field('dtoday'):column-label ttTTHandle::dtoday. 
```

如果不是，您可以从缓冲区中提取列标签

```
DEFINE TEMP-TABLE tt-dg1 FIELD dtoday AS DATE   COLUMN-LABEL "dg ". 
DEFINE VARIABLE   vTTHandle           AS HANDLE NO-UNDO.
CREATE tt-dg1.
dtoday = TODAY.

vTTHandle = BUFFER tt-dg1:HANDLE.
vTTHandle:BUFFER-FIELD("dtoday"):column-LABEL = vTTHandle:BUFFER-FIELD("dtoday"):column-LABEL + "77".

DISPLAY vTTHandle:BUFFER-FIELD('dtoday'):COLUMN-LABEL. 
```

# sensors - Windows Phone 8 获取设备方向

> ID：13746073
> 
> 赞同：0
> 
> 时间：2012-12-06T14:47:18.867
> 
> 标签：sensors, windows-phone-8, device-orientation

对于 Windows Phone 应用程序，我需要设备方向（例如 0、90、180 和 270 度），但布局固定为纵向。目前我正在使用 atan2(-accleeration_x,acceleration_y) 从加速度传感器读数计算方向。是否有内置方法来获取设备方向而不是手动使用加速度传感器？

问候，

**编辑：**有人在这里几乎同时问了一个类似的问题：[Windows Phone 8 中的设备方向](https://stackoverflow.com/questions/13740443/device-orientation-in-windows-phone-8)

# c# - Select() 方法如何返回匿名类型？

> ID：13746074
> 
> 赞同：0
> 
> 时间：2012-12-06T14:47:31.957
> 
> 标签：c#, linq, nhibernate, entity-framework-4, anonymous-types

我知道匿名类型不能从方法中返回。我也明白有一些解决方法可以做到这一点。我的问题是，Linq 提供者使用什么方法？例如，（提示对 Linq 提供程序如何工作的模糊理解），`Select()`扩展方法应用于 an `IQueryable`，其表达式树由 Linq 提供程序解析，转换为 SQL，然后将查询结果解析，加载到类型中。 ... 回来。

`Select()`那么，Entity Framework 或 NHibernate 使用什么技术来返回类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T14:51:46.817

它使用泛型。通过类型推断，编译器知道匿名类型的确切类型。
请注意，编译器会自动为匿名类型生成一个类。在那之后，它就像任何其他类型一样只是一个类型。

```
public IEnumerable<TResult> Select<TSource, TResult>(this IEnumerable<TSource> items,
                                                     Func<TSource, TResult> converter)
{
    foreach(var item in items)
        yield return converter(item);
} 
```

* * *

您可以从您的方法返回一个匿名类型。问题是，你不能做强类型，因为匿名类型的类型名称你不知道 - 但它是编译器，这就是泛型与匿名类型一起工作的原因。

您正在谈论的解决方法也是使用泛型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T14:51:24.567

我相信它使用泛型，因此尽管返回类型看起来是“匿名的”，但由于您使用它的数据类型而为人所知。

简单的事实是，程序（一旦编译）根据传入（或操作）的类型知道要返回的确切类型

您可以[在此处阅读更多关于泛型的信息](http://msdn.microsoft.com/en-us/library/ms379564%28v=vs.80%29.aspx)，它们在编码时非常有用——只要您知道何时适当地使用它们

# java - Spring 与否 Spring：我们应该在具有静态方法的类上创建 @Component 吗？

> ID：13746080
> 
> 赞同：5
> 
> 时间：2012-12-06T14:47:43.463
> 
> 标签：java, spring

我有一个包“Utils”，里面有很多类。其中一些只是一些具有静态方法的类，而另一些只是一些单例，我在构造函数中传递一些参数（使用 @Value 以通过注释替换基本的 XML 配置）。

我在 ApplicationContext 中有一个配置，以便扫描包。

所以，我的问题是：对于具有静态方法的类，我们应该使用 @Component 注释来转换它们以便拥有一个单例（仍然使用静态方法）还是应该让它们处于这种状态而不由 Spring 管理它们？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T14:57:04.297

如果它有任何类型的状态要维护，或者有任何协作者，那么就创建一个 Spring 组件。如果您需要的功能是无状态的并且不依赖于它调用的任何其他方法的状态，则将其设为静态。

例如，在我的应用程序中，我有一个静态 util 方法，可以将整数限制在最小值和最大值之间，但 Spring bean 会返回当前日期......

```
@Service
public class DateServiceImpl implements DateService {
    @Override
    public Date getCurrentDate() {
        return Calendar.getInstance().getTime();
    }
} 
```

为什么？因为现在我可以对使用当前日期的代码进行单元测试。

# hibernate - 从多个表中获取列时本机 Sql 中的休眠问题？

> ID：13746082
> 
> 赞同：0
> 
> 时间：2012-12-06T14:48:00.027
> 
> 标签：hibernate, jakarta-ee, hql

假设有两个表。表 A 和表 B。

表 A 有 {id, name, desc} 表 B 有 {id, name, place}

我正在尝试显示 a.id 等于 b.id 的名称、id 列。

Hibernate 没有正确显示记录。

有人可以帮我解决问题吗？

谢谢， 凯瑟尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:07:30.757

您可以像这样编写这种类型的查询：

```
 Query qry = session.createQuery("select a.name, a.id from A a, B b where a.id = b.id");
 List l = qry.list();
 Iterator it = l.iterator();
 while(it.hasNext())
 {
     Object o[] = (Object o[])it.next();
     System.out.println("name = "+o[0]+" id = "+o[0]);

 } 
```

在这种情况下，hibernate 在内部将每一行的多个列值存储到一个对象数组中，并将这些对象数组存储到 List 集合中。在迭代集合时，我们需要将结果类型转换为对象数组。

干杯和快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:07:43.850

你可能只需要给你的表起别名。

```
select a.name, a.id from A a join B b on a.id = b.id 
```

# iphone - UIScrollView中的UIImageView捏缩放

> ID：13746085
> 
> 赞同：2
> 
> 时间：2012-12-06T14:48:04.310
> 
> 标签：iphone, objective-c, uiscrollview, uiimageview, zooming

我对使用 UIScrollView 的捏缩放功能感到满意。但问题是滚动视图中图像的宽高比。

目前，我有这个，下图：

![在此处输入图像描述](../Images/ab46fc213c908d1e0821cdddf981caca.png)

但我希望图像适合屏幕，如下图所示：

![在此处输入图像描述](../Images/79ab464ce46e6faba7089391012f4909.png)

风景也有同样的行为。我怎样才能做到这一点？

下面是代码：

```
- (void)viewDidLoad
{
    UIImage *image = [UIImage imageWithData:appDelegate.selectedOriginalImage];
    imgView.image = image;
    CGSize imageSize = image.size;
    CGRect rect = CGRectMake(0, 0, imageSize.width, imageSize.height);
    imgView.frame = rect;
    scrollView.contentSize = CGSizeMake(imgView.frame.size.width, imgView.frame.size.height);
    scrollView.maximumZoomScale = 4.0;
    scrollView.minimumZoomScale = 1.0;
    scrollView.delegate = self;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    UIImage *image = [UIImage imageWithData:appDelegate.selectedOriginalImage];
    CGSize imageSize = image.size;
    CGRect rect = CGRectMake(0, 0, imageSize.width, imageSize.height);
    imgView.frame = rect;

    [scrollView setContentOffset:CGPointMake(0, 0)]; 

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:04:25.060

您将 UIImageView 设置为图像的原始大小，而不是包含它的 UIScrollView 的大小。

```
- (void)viewDidLoad
{
    UIImage *image = [UIImage imageWithData:appDelegate.selectedOriginalImage];
    imgView.image = image;

    imgView.frame = scrollView.bounds;
    [imgView setContentMode:UIViewContentModeScaleAspectFit];
    scrollView.contentSize = CGSizeMake(imgView.frame.size.width, imgView.frame.size.height);
    scrollView.maximumZoomScale = 4.0;
    scrollView.minimumZoomScale = 1.0;
    scrollView.delegate = self;
} 
```

记得在 viewToZoom 委托方法上返回 imgView

# android - 添加 android:targetSdkVersion="10" 最显着的效果是什么？为什么它会控制 Android 3.1 平板电脑上“菜单”按钮的存在？

> ID：13746088
> 
> 赞同：0
> 
> 时间：2012-12-06T14:48:13.007
> 
> 标签：android

很久以前我的应用程序出现了某种问题，建议的解决方案是添加`android:targetSdkVersion="10"`到清单中。它成功了，所以这条线留下了。现在我想删除它或针对最新的 Android API 之一，但我不记得我通过针对 API 级别 10 修复的问题是什么，所以如果我破坏它我不会知道。有什么建议么？

我正在使用 Android 3.1 SDK（API 级别 12），并且`android:minSdkVersion`一直是 12。

**更新。**发现一个效果`targetSdkVersion="10"`：如果它设置为任何 > 10 或根本没有设置，我的应用程序在 Android 3.1 平板电脑上没有“菜单”按钮（或者它被称为）。我绝对确定前一段时间不是这种情况，这不是我正在寻找的答案。不过，我确实需要那个按钮。应该有`android:targetSdkVersion`这种效果（再一次，这不像 9 个月前那样）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:46:33.980

> android:minSdkVersion 一直是 12。

设置`android:targetSdkVersion`为低于`android:minSdkVersion`非常奇怪的值。

> 发现 targetSdkVersion="10" 的一种效果：如果它设置为 > 10 或根本没有设置，我的应用程序在 Android 3.1 平板电脑上没有“菜单”按钮（或者它被称为）。

正确的。它还控制您的默认主题（`Theme.Holo`以及全息小部件集的变体）。

> 我绝对确定前一段时间不是这种情况

自 2010 年 2 月 Android 3.0 出现以来，这种行为已持续近两年。然而，[随着 Android 4.0 的发布，情况变得更加复杂](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html)。

> 我确实需要那个按钮

添加操作栏或不使用选项菜单。当[您提高`android:targetSdkVersion`](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html).

> android:targetSdkVersion 应该有这个效果吗

是的。

# wpf - 在 AvalonDock 2.0 的 LayoutDocument 底部创建选项卡？

> ID：13746093
> 
> 赞同：0
> 
> 时间：2012-12-06T14:48:25.763
> 
> 标签：wpf, xaml, avalondock

如何在 AvalonDock 2.0 中的 LayoutDocument 底部创建选项卡（在 XAML 中），例如 Visual Studio 中的代码和设计选项卡？（当然不使用 TabControl）

我想最终在顶部有一个选项卡，每个文档一个，但是在每个文档中，能够有多个“视图”，每个选项卡在窗口底部。

因此，您可能将“page.htm”作为一个文档，显示在顶部的选项卡上。然后将“来源”和“设计”作为打开/激活文档底部的两个选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T11:29:59.863

您应该覆盖 LayoutDocumentPaneControl 的默认样式，为此我建议您查看提供的主题之一。示例代码（未测试）：

```
<!--MyCustomDocumentPaneControlStyle-->
<Style x:Key="MyCustomDocumentPaneControlStyle" TargetType="{x:Type avalonDockControls:LayoutDocumentPaneControl}">
    <Setter Property="TabStripPlacement" Value="Bottom"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type avalonDockControls:LayoutDocumentPaneControl}">
                <Grid ClipToBounds="true" SnapsToDevicePixels="true" KeyboardNavigation.TabNavigation="Local">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <!--Following border is required to catch mouse events-->
                    <Border Background="Transparent" Grid.RowSpan="2"/>
                    <Grid Panel.ZIndex="1" Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <avalonDockControls:DocumentPaneTabPanel x:Name="HeaderPanel" Grid.Column="0" IsItemsHost="true" Margin="2,2,2,0" Grid.Row="0" KeyboardNavigation.TabIndex="1"/>
                        <avalonDockControls:DropDownButton
                            x:Name="MenuDropDownButton"
                            Style="{StaticResource {x:Static ToolBar.ToggleButtonStyleKey}}"
                            Focusable="False"
                            Grid.Column="1">
                            <avalonDockControls:DropDownButton.DropDownContextMenu>
                                <avalonDockControls:ContextMenuEx
                                    ItemsSource="{Binding Model.ChildrenSorted, RelativeSource={RelativeSource TemplatedParent}}">
                                    <avalonDockControls:ContextMenuEx.ItemContainerStyle>
                                        <Style TargetType="{x:Type avalonDockControls:MenuItemEx}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                            <Setter Property="HeaderTemplate" Value="{Binding Path=Root.Manager.DocumentPaneMenuItemHeaderTemplate}"/>
                                            <Setter Property="HeaderTemplateSelector" Value="{Binding Path=Root.Manager.DocumentPaneMenuItemHeaderTemplateSelector}"/>
                                            <Setter Property="IconTemplate" Value="{Binding Path=Root.Manager.IconContentTemplate}"/>
                                            <Setter Property="IconTemplateSelector" Value="{Binding Path=Root.Manager.IconContentTemplateSelector}"/>
                                            <Setter Property="Command" Value="{Binding Path=., Converter={StaticResource ActivateCommandLayoutItemFromLayoutModelConverter}}"/>
                                        </Style>
                                    </avalonDockControls:ContextMenuEx.ItemContainerStyle>
                                </avalonDockControls:ContextMenuEx>
                            </avalonDockControls:DropDownButton.DropDownContextMenu>
                            <Image Source="/AvalonDock;component/Images/PinDocMenu.png"/>
                        </avalonDockControls:DropDownButton>                            
                    </Grid>
                    <Border x:Name="ContentPanel" 
                            VerticalAlignment="Stretch" 
                            HorizontalAlignment="Stretch"  
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}" 
                            Grid.Column="0" 
                            KeyboardNavigation.DirectionalNavigation="Contained" 
                            Grid.Row="0"
                            KeyboardNavigation.TabIndex="2" 
                            KeyboardNavigation.TabNavigation="Cycle">
                        <ContentPresenter x:Name="PART_SelectedContentHost" 
                                          ContentSource="SelectedContent" 
                                          Margin="{TemplateBinding Padding}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                    </Trigger>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Model.ChildrenCount}" Value="0">
                        <Setter Property="Visibility" Value="Collapsed" TargetName="MenuDropDownButton" />
                    </DataTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="ItemContainerStyle">
        <Setter.Value>
            <Style TargetType="{x:Type TabItem}">
                <Setter Property="Visibility" Value="{Binding IsVisible, Converter={StaticResource BoolToVisibilityConverter}}"/>
                <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
                <Setter Property="ToolTip" Value="{Binding ToolTip}"/>
            </Style>
        </Setter.Value>
    </Setter>
    <Setter Property="ItemTemplate">
        <Setter.Value>
            <DataTemplate>
                <avalonDockControls:LayoutDocumentTabItem Model="{Binding}"/>
            </DataTemplate>
        </Setter.Value>
    </Setter>

    <Setter Property="ContentTemplate">
        <Setter.Value>
            <DataTemplate>
                <avalonDockControls:LayoutDocumentControl Model="{Binding}"/>
            </DataTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

当您拥有新样式时，只需使用 DockingManager 的 DocumentPaneControlStyle 属性插入它：

```
<ad:DockingManager DocumentPaneControlStyle="{StaticResource MyCustomDocumentPaneControlStyle}">
...
</ad:DockingManager> 
```

阿多

# paypal - PayPal 手动重定向到订单确认页面

> ID：13746095
> 
> 赞同：0
> 
> 时间：2012-12-06T14:48:28.230
> 
> 标签：paypal

我知道如何启用/禁用 PayPal 的自动退货功能。我想做的是禁用自动退货，但仍为用户提供一个按钮/链接以手动返回到我网站上的订单确认页面？这可能吗？此外，PDT 需要启用自动返回，所以我假设 PDT 将不再工作。这是真的？

谢谢，

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:12:40.493

如果您禁用自动退货，用户仍然会看到一个小链接，上面写着“退货给商家”，但它会显示您的公司名称和商家一词。

我没有专门对其进行测试，但根据文档，如果没有启用自动返回，PDT 将不会将数据发送到返回 URL，这是正确的。

# android - 动态通知

> ID：13746096
> 
> 赞同：0
> 
> 时间：2012-12-06T14:48:31.387
> 
> 标签：android, notifications

我想通过调用 R.string.app_name 来放置通知的动态标题，但我无法将其转换为 CharSequence。R.string 返回一个与通知不兼容的整数 id。这是尝试

```
CharSequence tickerText = R.string.app_name; //Error

Notification notification = new Notification(R.drawable.ico, tickerText,System.currentTimeMillis()); 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:02:01.800

```
CharSequence tickerText = getApplicationContext().getString(R.string.app_name); 
```

# ruby-on-rails - 创建新的 Rails 迁移错误

> ID：13746097
> 
> 赞同：0
> 
> 时间：2012-12-06T14:48:31.580
> 
> 标签：ruby-on-rails, migration

我一直在使用 Michael Hartl 的教程，我正在尝试创建一个名为“Recipe”的新模型，以允许用户发布食谱。该模型本质上与微博模型相同，因为用户应该能够发布许多食谱，并且所有食谱都应该链接到一个用户。因此，我使用了与 micropost 相同的命令和迁移：

```
class CreateMicroposts < ActiveRecord::Migration
  def change
    create_table :microposts do |t|
      t.string :content
      t.integer :user_id

      t.timestamps
    end

    add_index :microposts, [:user_id, :created_at]
  end
end 
```

使用命令创建：rails generate model Micropost content:string user_id:integer

我遇到的问题是两个表中的主键都是 user_id。这会起作用吗，或者当我尝试输入食谱时，它会尝试从微帖子表中提取吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:03:42.160

> 当我尝试输入食谱时，它会尝试从微博表中提取吗？

**不会。**`Recipe`默认情况下，应用程序中的模型将与`recipes`数据库中的表交互。同样，默认情况下，`Micropost`模型将与数据库中的表交互。`microposts`

只要您使用`Recipe`模型，实例`Recipe`就不会从`microposts`表中拉出。

*听起来您可能对表的主键的用途以及数据库表的工作方式存在根本性的误解；但现在这超出了这个问题的范围。*

* * *

顺便说一句，您可能应该这样做

```
rails generate model MicroPost content:string user_id:integer 
```

*（注意)`P`中的大写字母`MicroPost`*。这是该类的更好名称，它将`micro_posts`在您的数据库中创建一个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:04:14.827

主键不是两个表中的任何一个中的 user_id。每个模型都会生成一个带有隐式数字自增 id 列的表，该列用作 PK。

add_index 所做的是在 user_id 列上添加索引。索引不是 PK。

无论如何，您应该将您的食谱迁移中的 add_index 语句更改为：

```
add_index :recipes, [:user_id, :created_at] 
```

# html - 将 onclick 添加到图像标签

> ID：13746104
> 
> 赞同：1
> 
> 时间：2012-12-06T14:48:52.670
> 
> 标签：html, click, graphical-logo

此行显示我的徽标：

```
<li><img class="logo" src="selector/logo.png" alt="" /></li> 
```

如何向该图像添加可点击的链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T14:51:02.380

在这里试试这个：

```
<li>
   <a href="target.html">
      <img class="logo" src="selector/logo.png" alt="" />
   </a>
</li> 
```

您还希望正确地删除图像周围的边框。要解决此问题，请使用此 CSS：

```
.logo {
    border: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T14:51:51.460

您只是在问如何使图像成为自身的超链接？像这样？：

```
<li>
  <a href="selector/logo.png">
    <img class="logo" src="selector/logo.png" alt="" />
  </a>
</li> 
```

# keyboard - 如何在 Dart 游戏中重复听按键？

> ID：13746105
> 
> 赞同：10
> 
> 时间：2012-12-06T14:48:59.403
> 
> 标签：keyboard, dart, keypress

我知道您可以使用 Dart 收听按键按下和按下事件，例如：

```
var el = query('#el');
el.on.keyDown.add((e) {}); 
```

但这里的问题是它只触发**一次**。我要重复。

所以，我尝试`keyPress`了，但在重复之前它有一点延迟。我正在开发一款游戏，我希望它可以立即重复触发。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-06T15:03:52.380

首先，不要监听`keyPress`事件，因为“初始延迟”取决于操作系统配置！事实上，`keyPress`事件甚至可能不会重复触发。

你需要做的是监听`keyDown`和`keyUp`事件。你可以为此做一个助手。

```
class Keyboard {
  HashMap<int, int> _keys = new HashMap<int, int>();

  Keyboard() {
    window.onKeyDown.listen((KeyboardEvent e) {
      // If the key is not set yet, set it with a timestamp.
      if (!_keys.containsKey(e.keyCode))
        _keys[e.keyCode] = e.timeStamp;
    });

    window.onKeyUp.listen((KeyboardEvent e) {
      _keys.remove(e.keyCode);
    });
  }

  /**
   * Check if the given key code is pressed. You should use the [KeyCode] class.
   */
  isPressed(int keyCode) => _keys.containsKey(keyCode);
} 
```

然后根据你在游戏中所做的事情，你可能有某种“游戏循环”，在你的`update()`方法中，每隔一段时间就会被调用一次：

```
class Game {
  Keyboard keyboard;

  Game() {
    keyboard = new Keyboard();

    window.requestAnimationFrame(update);
  }

  update(e) {
    if (keyboard.isPressed(KeyCode.A))
      print('A is pressed!');

    window.requestAnimationFrame(update);
  }
} 
```

现在你的游戏循环重复检查`A`按键。

# git - 在 JetBrains intellij for git 中显示未跟踪的文件

> ID：13746106
> 
> 赞同：19
> 
> 时间：2012-12-06T14:48:58.753
> 
> 标签：git, intellij-idea

我正在使用 JetBrains IntelliJ。提交之前是否有可能在 git 的摘要中显示未跟踪的文件（VCS -> Git -> 提交文件...）。

在我当前的配置中，未跟踪的文件总是被排除在外。因此，我必须在命令行上执行“git status”（或在文件树中查看绿色文件条目）以了解新的/未跟踪的文件。

我感谢每一个提示。

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-06T15:27:10.627

您可以使用`Version Control`( `Alt`+ `9`) 工具窗口；然后转到`Local Changes`选项卡并展开`Unversioned Files`组以查找所有未跟踪的文件。

# php - jQuery ajax 和字符编码

> ID：13746111
> 
> 赞同：0
> 
> 时间：2012-12-06T14:49:13.150
> 
> 标签：php, ajax, encoding

我正在使用此代码从 php 页面获取一些 html 内容：

```
$.ajax({
   url:server+'/getMessage/40',
   cache: false,
   success: function(res) {
       var text = res.responseText;
       $('#result').html(res);
    }
}); 
```

文本从数据库中检索。

php 文件如下所示：

```
$app->get('/app/get/getMessage/:Id',function ($Id='') use ($app) {
$msgElements = 'Title,Body';
$msgFe = $conn->query("SELECT $msgElements FROM messages WHERE Id='".$Id."'");
    $fields = explode(',',$msgElements);
    while($msgData = $conn->extract($msgFe)){
        foreach($fields as $field) {
            $arr->$field = $msgData->$field;
        }
    }
    $ele=' <div class="modal-header">
                <h1>'.$arr->Title.'</hi>
            </div>
            <div class="modal-body">
                '.$arr->Body.'
            </div>
            <div class="modal-footer">
            </div>
            ';
    echo $ele;
}); 
```

如果我将浏览器放置在 php 页面的位置，并使用正确的`GET`说明，我会毫无问题地得到文本。但是，如果我使用上述 ajax 函数检索文本，它会显示`?`...

从我的测试（以及这里的其他线程）我假设问题依赖于ajax函数的某个地方......有什么帮助吗？

PS 我注意到，如果我尝试`json_encode()`在包含未正确可视化的字符的文本上使用，结果是`null`. 我希望我有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:02:26.650

您必须`utf8_encode()`从数据库中获取值，因为结果值不是您所说的 utf8 编码。

# xpath - 如何在 Web 驱动程序中使用 XPATH 获取单击元素的值

> ID：13746121
> 
> 赞同：0
> 
> 时间：2012-12-06T14:49:34.780
> 
> 标签：xpath

以下是从萤火虫获得的字段属性

```
<td class="list-padding radar_text radar_left"> <a class="radar_button" href="/IPradar/update.htm?ticketID=3749" target="_blank">3749</a> </td> 
```

下面是相同的 XPath

```
/html/body/center/div/table/tbody/tr[3]/td/table/tbody/tr[10]/td[2]/a 
```

在我的代码中，我给出了以下内容以获得值'3749'

```
driver.findElement(By.xpath("/html/body/center/div/table/tbody/tr[3]/td/table/tbody/tr[10]/td[2]/a")).getText(); 
```

值 3749 不是常数，它会动态变化

我想获取代替 <'3749'> 的任何值

我正在使用硒网络驱动程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:04:46.673

其实我无法理解这个问题，但我想你想得到ticketID为3749的文本，因为你可以使用下面的代码来获取所需的文本

```
driver.findElement(By.xpath("//td[contains(@class,'list-padding radar_text')]/a[contains(@href,'ticketID=3749')]")).getText() 
```

或者

```
driver.findElement(By.xpath("//td[contains(@class,'list-padding radar_text')]/a[contains(@href,'ticketID')]")).getText() 
```

谢谢

# android - Android - Facebook SDK 3 - 如何在没有 LoginButton 的情况下以编程方式登录

> ID：13746124
> 
> 赞同：39
> 
> 时间：2012-12-06T14:49:42.560
> 
> 标签：android, button, login, facebook-android-sdk

我正在编写一个与 Facebook SDK 集成的应用程序，以分享一些（字符串）内容作为墙贴。现在，我让 HelloFacebookSample 工作了。但是它使用他们的 LoginButton 来登录用户。

我不想要那个。我要做的就是单击操作栏中的共享按钮并将其共享到 Facebook。因此我想以编程方式登录，我试图模拟 LoginButton 的作用，但到目前为止没有成功。我明白了

> 12-06 15:34:33.180：E/AndroidRuntime(19493)：java.lang.UnsupportedOperationException：会话：尝试重新授权具有待处理请求的会话。

公共类 MainActivity 扩展 FacebookActivity {

```
@SuppressWarnings("serial")
private static final List<String> PERMISSIONS = new ArrayList<String>() {
    {
        add("publish_actions");
    }
};
private final int REAUTHORIZE_ACTIVITY = 3;
private Button postStatusUpdateButton;
private PendingAction pendingAction = PendingAction.NONE;

private enum PendingAction {
    NONE, POST_PHOTO, POST_STATUS_UPDATE
}

/**
 * Called when the activity is first created.
 */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    postStatusUpdateButton = (Button) findViewById(R.id.postStatusUpdateButton);
    postStatusUpdateButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            Log.d("MainActivity", "onClick");
            onClickPostStatusUpdate();
        }

    });

}

@Override
protected void onSessionStateChange(SessionState state, Exception exception) {
    super.onSessionStateChange(state, exception);
}

private interface GraphObjectWithId extends GraphObject {
    String getId();
}

private void showPublishResult(String message, GraphObject result, FacebookRequestError error) {
    String title = null;
    String alertMessage = null;
    if (error == null) {
        title = getString(R.string.success);
        String id = result.cast(GraphObjectWithId.class).getId();
        alertMessage = getString(R.string.successfully_posted_post, message, id);
    } else {
        title = getString(R.string.error);
        alertMessage = error.getErrorMessage();
    }

    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle(title).setMessage(alertMessage).setPositiveButton(getString(R.string.ok), null);
    builder.show();
}

private void onClickPostStatusUpdate() {
    Log.d("MainActivity", "onClickPostStatusUpdate");
    performPublish(PendingAction.POST_STATUS_UPDATE);
}

private boolean hasPublishPermission() {
    Session session = Session.getActiveSession();
    return session != null && session.getPermissions().contains("publish_actions");
}

private void performPublish(PendingAction action) {
    Log.d("MainActivity", "peformPublish");

    Session session = Session.getActiveSession();

    if (session == null) {
        session = new Session.Builder(this).setApplicationId("xxx").build();
        Session.setActiveSession(session);
    }

    if (!session.isOpened()) {
        Session.OpenRequest openRequest = new Session.OpenRequest(this);
        openRequest.setPermissions(PERMISSIONS);
        openRequest.setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK);
        session.openForPublish(openRequest);
    }

    if (session != null) {
        // postStatusUpdate();
        pendingAction = action;
        if (hasPublishPermission()) {
            // We can do the action right away.
            handlePendingAction();
            // postStatusUpdate();
        } else {
            // We need to reauthorize, then complete the action when we get
            // called back.
            Session.ReauthorizeRequest reauthRequest = new Session.ReauthorizeRequest(this, PERMISSIONS)
                    .setRequestCode(REAUTHORIZE_ACTIVITY).setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK);
            session.reauthorizeForPublish(reauthRequest);
        }
    }
}

@SuppressWarnings("incomplete-switch")
private void handlePendingAction() {
    PendingAction previouslyPendingAction = pendingAction;
    // These actions may re-set pendingAction if they are still pending, but
    // we assume they
    // will succeed.
    pendingAction = PendingAction.NONE;

    switch (previouslyPendingAction) {
    case POST_STATUS_UPDATE:
        postStatusUpdate();
        break;
    }
}

private void postStatusUpdate() {
    // if (user != null && hasPublishPermission()) {
    if (hasPublishPermission()) {
        // final String message = getString(R.string.status_update,
        // user.getFirstName(), (new Date().toString()));
        final String message = "kks uz nemam nervy";
        Request request = Request.newStatusUpdateRequest(Session.getActiveSession(), message,
                new Request.Callback() {
                    @Override
                    public void onCompleted(Response response) {
                        showPublishResult(message, response.getGraphObject(), response.getError());
                    }
                });
        Request.executeBatchAsync(request);
    } else {
        pendingAction = PendingAction.POST_STATUS_UPDATE;
    }
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    Log.d("MainActivity", "onActivityResult");
    Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);
} 
```

}

好吧，这仍然是我试图以正确方式弯曲的 HelloFacebookSample 项目。我唯一玩过的是 performPublish 方法，用于创建会话。

希望有更简单的方法！PS：**我正在使用 Facebook SDK 3**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-06T18:13:11.950

你发布的是你的整个活动吗？

您还需要覆盖 onActivityResult，并将值传递给 Session.getActiveSession().onActivityResult(...)。否则，Session 将不知道用户已授权您的应用，这就是您看到错误的原因（Session 认为仍有待处理的身份验证请求，这就是您无法重新授权发布的原因）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-08-09T11:26:32.147

因为我和这里的许多人有同样的感觉，他们赞成@Beppi 对@Ming Li 的评论，而且由于我在我的应用程序中使用 Facebook SDK，我决定创建基于最新 Facebook SDK 3.0.b 的更简化的 API 级别。

开源库：**android-simple-facebook**
[https://github.com/sromku/android-simple-facebook](https://github.com/sromku/android-simple-facebook)

对于你的问题：**`How to login programatically?`**

1.  设置登录/注销监听器

    ```
    // set login / logout listener
    OnLoginOutListener onLoginOutListener = new SimpleFacebook.OnLoginOutListener()
    {

        @Override
        public void onFail()
        {
            Log.w(TAG, "Failed to login");
        }

        @Override
        public void onException(Throwable throwable)
        {
            Log.e(TAG, "Bad thing happened", throwable);
        }

        @Override
        public void onThinking()
        {
            // show progress bar or something to the user while login is happening
            Log.i(TAG, "In progress");
        }

        @Override
        public void onLogout()
        {
            // change the state of the button or do whatever you want
            Log.i(TAG, "Logged out");
        }

        @Override
        public void onLogin()
        {
            // change the state of the button or do whatever you want
            Log.i(TAG, "Logged in");
        }
    };

    // set the listener
    mSimpleFacebook.setLogInOutListener(onLoginOutListener); 
    ```

2.  单击任何视图，只需调用`login(Activity)`方法

    ```
    mSimpleFacebook.login(MainActivity.this); 
    ```

3.  注销调用`logout()`方法。像这样：

    ```
    mSimpleFacebook.logout(); 
    ```

如何在登录前设置**权限，请看**[**这里**](https://github.com/sromku/android-simple-facebook#usage)非常友好的解释。

希望它对某人有帮助:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-31T16:01:20.407

很棒的代码，谢谢。

请注意，对于 v3 SDK 版本，重新授权代码必须替换为：

```
Session.NewPermissionsRequest reauthRequest = new Session.NewPermissionsRequest(FacebookActivity.this, PERMISSIONS)
                                .setRequestCode(REAUTHORIZE_ACTIVITY)
                                .setLoginBehavior(SessionLoginBehavior.SSO_WITH_FALLBACK);
                        session.requestNewPublishPermissions(reauthRequest); 
```

# dictionary - grep：如何在匹配的行之后显示下一行，直到空行[不可能！]

> ID：13746129
> 
> 赞同：0
> 
> 时间：2012-12-06T14:49:57.303
> 
> 标签：dictionary, full-text-search, grep

我有一个字典（不是 python 字典），包含许多这样的文本文件：

```
##Berlin                
-capital of Germany         
-3.5 million inhabitants

##Earth           
-planet 
```

我怎样才能用事实显示字典的一个条目？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:29:56.590

你不能。grep 无法显示可变数量的上下文。您可以使用 -A 在匹配后显示设定的行数，例如在匹配`-A3`后显示三行，但不能是可变的行数。

您可以编写一个快速的 Perl 程序以“段落模式”从文件中读取，然后打印与正则表达式匹配的块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:00:46.870

正如 andy lester 指出的那样，你不能让 grep 在 grep 中显示可变数量的上下文，但是一个简短的 awk 语句可能会满足你的期望。

如果您的示例文件名为`file.dict`：

```
awk -v term="earth" 'BEGIN{IGNORECASE=1}{if($0 ~ "##"term){loop=1} if($0 ~ /^$/){loop=0} if(loop == 1){print $0}}' *.dict 
```

返回：

```
##Earth
-planet 
```

只需将变量更改为`term`您要查找的条目。

假设两件事：

1.  字典文件具有相同的扩展名（例如.dict）
2.  字典文件都在同一个目录中（命令被调用的地方）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T22:17:51.993

如果你的 grep 支持 perl 正则表达式，你可以这样做：

```
grep -iPzo '(?s)##Berlin.*?\n(\n|$)' 
```

有关此模式的更多信息，请参阅[此答案](https://stackoverflow.com/a/7167115/1331399)。

你也可以像这样使用 GNU sed 来做到这一点：

```
query=berlin
sed -n "/$query/I"'{ :a; $p; N; /\n$/!ba; p; }' 
```

也就是说，当发现不区分大小写时`$query`，打印直到找到空行（`/\n$/`）或文件结尾（`$p`）。

两种情况下的输出（空格的细微差别）：

```
##Berlin
-capital of Germany
-3.5 million inhabitants 
```

# vb.net - 使用 VB.net 将 .CSV 文件转换为 .XLS

> ID：13746130
> 
> 赞同：0
> 
> 时间：2012-12-06T14:49:58.987
> 
> 标签：vb.net, csv, excel-2007, xls

我正在尝试使用 vb.net 将 .csv 转换为 .xls，但我无法找到有效的方法。我知道如何将 .xls 转换为 .csv 是否与此类似？这是我到目前为止的代码，这是我收到的错误：

“外部表不是预期的格式。”

```
Public Sub ConvertCSV(ByVal lvFileName As String, ByVal lvFileNameNoExt As String)

Dim DA As New OleDb.OleDbDataAdapter

Dim DS As New DataSet

Dim objStreamWriter As StreamWriter

Dim objconn As New System.Data.OleDb.OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\GD Test\Test.csv;Extended Properties=Excel 8.0;")

    ObjConn.Open()

    Dim objcmd As New System.Data.OleDb.OleDbCommand("Select * from [AutoBatchPrintBypass.RPT$]", objconn)

    objcmd.CommandType = CommandType.Text

    objStreamWriter = New StreamWriter(gvDipDir & gvClientCode & ".XLS")

    objconn.Close()

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:44:46.100

读取 CSV 文件时，您告诉 Jet Engine 它是一个带有这部分连接字符串的 excel 文件`Extended Properties=Excel 8.0`。尝试将连接字符串的那部分更改为 this `Extended Properties='text;HDR=Yes;FMT=Delimited(,)'`。我是从[这个页面](http://www.codeproject.com/Articles/27802/Using-OleDb-to-Import-Text-Files-tab-CSV-custom)得到的。

至于写文件，你可以做几件事，这里有一个类似的 SO question，

[从 C# 创建 Excel（.XLS 和 .XLSX）文件](https://stackoverflow.com/questions/151005/create-excel-xls-and-xlsx-file-from-c-sharp)

# asp.net - Response.TransmitFile 与直接链接

> ID：13746132
> 
> 赞同：0
> 
> 时间：2012-12-06T14:50:03.427
> 
> 标签：asp.net, cloud, azure-storage

我正在使用 Azure 云存储解决方案，因此，每个文件都有自己的 URL。我需要允许用户从我们的 ASP .Net 网站下载 PDF 等文件。目前，我们正在使用 Response.TransmitFile 将文件发送到客户端的浏览器，但这需要我们从云存储中获取数据，然后将其发送到客户端（这似乎是一种低效的方法）。

我想知道我们是否不能直接链接到文件，如果可以，这与 Response.TrnasmitFile 方法有何不同？也就是说，如果没有 TransmitFile 方法，我们就无法设置 Content-type 标头等……这有什么影响？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T18:58:48.000

通常我远离使用 Response.TransmitFile 因为它确实需要您获取文件然后将其流式传输到客户端。

我唯一一次使用它是为了保护文件，并且只将它们提供给有权访问它们的用户，而不是直接链接到文件。

如果您提供的文件是公开的，那么我建议您只链接到它们。如果您只需要设置 Content-Type 标头，那么只需确保将 .pdf 扩展名映射到正确的 MIME 类型（应用程序/pdf）。

# java - 当我的应用程序在我的手机上崩溃时，我没有强制关闭并且手机必须重新启动

> ID：13746134
> 
> 赞同：3
> 
> 时间：2012-12-06T14:50:06.430
> 
> 标签：java, android, adt

我有 2 个 Galaxy S3，一个是工作的，一个是我自己的，我个人的一个是植根的（允许钛备份来做这件事）。

在开发我的应用程序时，如果我正在使用我的工作电话并且它在电话上崩溃并显示 XXX 已崩溃，请单击确定以强制关闭。

但是，在我的手机上它并没有这样做，它只是崩溃，我必须重新启动手机。

有谁知道这个问题的解决方案？有时真是令人气愤。

汤姆

```
12-06 14:55:05.643: E/AndroidRuntime(8025): FATAL EXCEPTION: main
12-06 14:55:05.643: E/AndroidRuntime(8025): java.lang.RuntimeException: Unable to resume activity {com.directenquiries.assessment.tool/com.directenquiries.assessment.tool.AddAssessment}: java.lang.NullPointerException
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2616)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2644)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2130)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread.access$600(ActivityThread.java:140)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.os.Looper.loop(Looper.java:137)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread.main(ActivityThread.java:4898)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at java.lang.reflect.Method.invokeNative(Native Method)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at java.lang.reflect.Method.invoke(Method.java:511)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at dalvik.system.NativeStart.main(Native Method)
12-06 14:55:05.643: E/AndroidRuntime(8025): Caused by: java.lang.NullPointerException
12-06 14:55:05.643: E/AndroidRuntime(8025):     at com.directenquiries.assessment.tool.AddAssessment.checkPhoto(AddAssessment.java:185)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at com.directenquiries.assessment.tool.AddAssessment.onResume(AddAssessment.java:358)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1188)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.Activity.performResume(Activity.java:5258)
12-06 14:55:05.643: E/AndroidRuntime(8025):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2606)
12-06 14:55:05.643: E/AndroidRuntime(8025):     ... 12 more 
```

**编辑：**我可以解决应用程序的问题，我更想知道如何让我的个人手机在每次应用程序崩溃时都不需要重新启动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T19:04:26.777

似乎显而易见的答案是手机的操作系统以不同的方式处理应用程序崩溃。root 手机的主要原因之一是让应用程序在操作系统上拥有更多自由。在现有的 android 操作系统中，每个应用程序都有自己的小沙盒可以玩，如果它炸毁了沙盒，系统就会把它踢出去，再扔一层泥土，然后为另一个应用程序打开那个位置。

我对非库存的android世界没有很多经验，但我猜是你的root操作系统在癫痫发作时不会夺走应用程序的沙桶，因为它有权做任何事情它想要，或者操作系统实用程序可能有问题，用于停止在您的根操作系统中崩溃的应用程序。

你有没有因为另一个应用程序在你有根手机上不属于你的应用程序而导致致命的崩溃，你可以在你的安卓手机上强制关闭它？您的应用程序是否使用任何仅根权限或功能？

# meteor - 是否可以将模板分组到流星中的名称空间中？

> ID：13746135
> 
> 赞同：5
> 
> 时间：2012-12-06T14:50:13.460
> 
> 标签：meteor

有没有将模板分组到命名空间的解决方案？

在测试一些示例代码时，我遇到了这个问题，如何处理大量模板中的名称冲突。例如，假设我有一个包含三个部分的应用程序：

*   用户（模板：登录、注销、重置密码和设置）
*   论坛（模板：new_post、list_posts、view_post、搜索）
*   产品（模板：订单、查看、详细信息、搜索）

在产品和论坛中有两个不同的搜索模板，我会遇到麻烦。这可以通过将它们命名为 forum_search 和 products_search 来解决，但使用命名空间的方式会感觉更自然。

而不是访问：

```
template.forum_search
template.products_search 
```

做这样的事情：

```
template.forum.search
template.products.search 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T00:44:10.727

目前无法直接执行此操作，但它在 1.0 版的 Meteor 路线图上：[https ://trello.com/card/template-and-helper-namespacing/508721606e02bb9d570016ae/17](https://trello.com/card/template-and-helper-namespacing/508721606e02bb9d570016ae/17)

# c - C 演员的真正作用是什么？

> ID：13746136
> 
> 赞同：10
> 
> 时间：2012-12-06T14:50:15.913
> 
> 标签：c, types, casting

我编写了越来越多的 C 应用程序，现在我想知道关于强制转换的一些事情。在 C++ 中，动态转换是一项非常昂贵的操作（例如向下转换），但我什至不知道静态转换。

在 C 中，我不得不写这样的东西：

```
assert ( p ); /* p is void* */
int v = *(int*)p; 
```

它是“C 动态转换”吗？`static_cast<int*>(p)`它与C++的完全一样吗？它要多少钱？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T14:53:46.010

C 中的强制转换仅在编译时才有意义，因为它告诉编译器您希望如何操作一段数据。它不会改变数据的实际值。例如，`(int*)p`告诉编译器将`p`整数视为内存地址。然而，这在运行时没有任何成本，处理器只是按照给它的方式处理原始数字。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-06T14:52:02.733

指针的 AC 转换更像是 C++ `reinterpret_cast`。它指示编译器将变量视为不同类型，并且在运行时不花费任何成本。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-06T14:59:59.897

AC cast 更像所有 C++ 风格的强制转换*，除了* `dynamic_cast`组合。因此，当您将 int 转换为另一个整数类型时，它是`static_cast`. 当您将指针转换为其他指针类型或整数类型或反之亦然时，它是`reinterpret_cast`. 如果你扔掉一个`const`，它就是`const_cast`。

C 没有类似的东西，`dynamic_cast`因为它具有对象类型的概念，并且也不会像 C++ 那样对它们有用（没有虚函数......）。关于解释对象位的类型只有在与 C 中引用对象的表达式结合时才变得重要。对象本身没有类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T14:54:30.177

指针是指针 - 转换指针是一个 noop。

之前是内存地址，之后是内存地址。

它本质上是一个声明“让我们*假设*这是一个指向类型 x 的指针，以便将来进行类型检查”。

因此，您可以`reinterpret_cast`根据 C++ 将其称为 a，因为它不会像eg或 a那样执行额外的*编译时*类型检查。`dynamic_cast``static_cast`

我不认为 C 具有`dynamic_cast`（“在此处插入运行时类型检查”）或`static_cast`（“在此处执行额外的编译时类型检查”）的等价物。

请注意，对于*非指针*，事情的行为会略有不同。

```
int b = 1;
double a = (double) b; 
```

与其说是强制转换，不如说是显式类型*转换*。

# .net - 水晶报表字段变化重复图表（每个部门一个图表）

> ID：13746137
> 
> 赞同：0
> 
> 时间：2012-12-06T14:50:20.277
> 
> 标签：.net, sql, vb.net, crystal-reports

我有一个使用以下数据的图表报告：

```
Month N#    Month    Empl       Total       Department
9           Nov.     X          555.18      AA
9           Nov.     X          11995.58    AA
9           Nov.     Y          374.56      BB
9           Nov.     Y          619.39      BB
9           Nov.     Z          411.88      CC
9           Nov.     Z          172.52      CC 
```

据我所知，Charts 位于 Documents Header 中，它显示了一个使用所有信息的图表，而不关心它是哪个部门。

图表就像这张图片 ( [https://dl.dropbox.com/u/3389104/chart.png](https://dl.dropbox.com/u/3389104/chart.png) )，其中 BC、CA、NY、WA 是员工。2000、2001、2002 是月份（11 月），Y 轴是 Sum(Total)。

这对一个部门来说完美无缺，但是当我选择“所有部门”时，只打印第一个部门。

我尝试制作子报表，主报表包含 AA、BB 和 CC，子报表是图表，但我得到空白页。

有什么建议吗？

VB .net 3.5 水晶报表 2010 SQL Server 2008 R2。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:48:45.190

能截个图表专家的截图吗？听起来您只需要将部门添加到“更改时”列表中。

# sql - 具有空值的记录的 SQL 显示状态

> ID：13746140
> 
> 赞同：1
> 
> 时间：2012-12-06T14:50:30.417
> 
> 标签：sql, ms-access, null

我正在尝试创建一个查询，列出表 1 中的记录以及基于表 2 中的一个或多个字段中具有空值的相应记录的状态。我遇到的问题是如何包含表 1 中在表 2 中没有相应记录的记录。

在我的示例中，我想在 tblStudent 中列出所有学生的姓名以及在***tblStudentSchedule***中指示他们的日程安排状态的***字段***。如果tblStudentSchedule 中的***课程***或***教师***字段为 Null 或在 tblStudentSchedule 中找不到相应记录，***那么******我***想显示**"Incomplete"**。否则，我想显示**"Complete"**。

**期望的结果**

```
Name  | Schedule Status
-----------------------
Bob   | Incomplete     
Sally | Incomplete
Jane  | Incomplete
Matt  | Incomplete
Jim   | Complete 
```

我在**Access**工作。我会发布我的查询尝试，但我认为他们只会混淆这个问题。这可能是非常基本的，但我有一个精神障碍，试图将我的大脑包裹在这个问题上。

**tbl学生**

```
studentID | studentName
-----------------------
1         | Bob
2         | Sally
3         | Jane
4         | Matt
5         | Jim 
```

**tblStudentSchedule**

```
studentID | period | course | teacher
-------------------------------------
1         | 1      | math   | Jones
1         | 2      | <null> | Watson
2         | 1      | reading| <null>
4         | 1      | <null> | Crick
5         | 1      | math   | Jones 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T14:56:21.970

```
select  s.studentName as Name
,       iif(sum(iif(ss.course is null or ss.teacher is null, 1, 0)) = 0,
            'Complete', 'Incomplete')
        as [Schedule Status]
from    tblStudent s
left join    
        tblStudentSchedule ss
on      ss.studentID = s.studentID
group by
        s.studentName 
```

A在未找到匹配项时`left join`返回单行。`null`因此，`ss.course is null`当学生不在日程表中时，也会触发检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T14:57:39.860

如果在 tblStudentSchedule 中没有找到对应的记录，您可以使用左连接或右连接从该表中获取作为空列的行。参见下文：

[http://office.microsoft.com/en-us/access-help/left-join-right-join-operations-HP001032251.aspx](http://office.microsoft.com/en-us/access-help/left-join-right-join-operations-HP001032251.aspx)

然后转换空列使用 isnull 函数 [http://www.techonthenet.com/access/functions/advanced/isnull.php](http://www.techonthenet.com/access/functions/advanced/isnull.php)

或者使用 case 语句来检查 null [http://www.techonthenet.com/access/functions/advanced/case.php](http://www.techonthenet.com/access/functions/advanced/case.php)

# android - ListPreference：如何在没有弹出窗口的情况下显示？

> ID：13746150
> 
> 赞同：4
> 
> 时间：2012-12-06T14:50:55.510
> 
> 标签：android

在我的应用程序的首选项中，有一些声音是使用 ListPreference 管理的。例如：

```
<ListPreference android:title="@string/pref_clear_buttons"
                android:summary="@string/pref_clear_buttons_summary"
                android:key="clear_buttons" android:defaultValue="right"
                android:entries="@array/buttons_entries" android:entryValues="@array/buttons_values"
                /> 
```

使用 entryValues 取“隐藏”、“左”、“右”的值。

当我运行首选项活动时，ListPreference 会占用一行，当我单击它时会打开一个弹出窗口，我可以在其中选择三个首选项，就好像它是一种子菜单一样。

![在此处输入图像描述](../Images/38cd27bfce0d1eac267bef0733b6bdac.png)

我希望所有三个单选按钮都显示缩进，直接在“清除按钮”行下方，而不要求用户额外单击以打开弹出窗口。

有什么简单的想法吗？谢谢你。

# javascript - 如何使用 JavaScript 从表中的行索引中获取行 ID

> ID：13746153
> 
> 赞同：9
> 
> 时间：2012-12-06T14:51:02.810
> 
> 标签：javascript, html

假设这是我的表：

```
<table>
    <tr id="a">
       <TD>a</TD>
    </tr>
    <tr id="b">
       <TD>b</TD>
    </tr>
</table> 
```

如何使用表中的行索引获取行 ID？

上面只是一个例子，其中 id 是静态的，但在我的情况下，我的 id 是动态的，所以我不能使用 `document.getElementById()`.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-06T14:58:52.033

假设您的页面上只有一个表格：

```
document.getElementsByTagName("tr")[index].id; 
```

**不过，最好**是给你`table`的 a `id`，然后像这样得到你的行：

```
<table id="tableId">
    <tr id="a">
        <td>a</td>
    </tr>
    <tr id="b">
        <td>b</td>
    </tr>
</table> 
```

```
var table = document.getElementById("tableId");
var row = table.rows[index];
console.log(row.id); 
```

这样，如果您的页面中有多个表格，您可以确定不会受到任何干扰。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T14:57:55.837

> *“那么，我如何使用表中的行索引获取行 ID”*

您将选择`table`, 并使用该`.rows`属性按索引获取行。

```
var table = document.getElementsByTagName("table")[0]; // first table

var secondRow = table.rows[1]; // second row 
```

* * *

然后，您只需以典型方式获取 ID。

```
console.log(secondRow.id); // "b" 
```

***演示：http:*** [//jsfiddle.net/MERPk/](http://jsfiddle.net/MErPk/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T15:04:24.563

**答案已编辑** 使用 CSS3，您可以使用第**n 个子**选择器。这里的示例显示 rowIndex = 2

```
 alert(document.querySelector("table tr:nth-child(2)").id); 
```

在 jQuery 中，您可以使用

```
 alert($("table tr:nth-child(2)").attr('id')); 
```

在 CSS 中可以使用相同的语法**nth-child()**

```
<style>
    tr:nth-child(2) {
        color: red;
    }
</style> 
```

# c# - 具有恒定数量内部元素的 LINQ.SelectMany 的替代品

> ID：13746156
> 
> 赞同：4
> 
> 时间：2012-12-06T14:51:17.943
> 
> 标签：c#, linq

我正在尝试确定是否有更好的方法来执行以下查询：

我有一个`List`对象`Pair`。

A`Pair`定义为

```
public class Pair
{
    public int IDA;
    public int IDB;
    public double Stability;
} 
```

我想提取包含在`List<Pair>`.

我目前正在使用

```
var pIndices = pairs.SelectMany(p => new List<int>() { p.IDA, p.IDB }).Distinct().ToList(); 
```

`new List<int>`哪个行得通，但对我来说创建一个只是让它变平似乎不直观`SelectMany`。

这是我觉得至少可以说不雅的另一种选择：

```
var pIndices = pairs.Select(p => p.IDA).ToList();
pIndices.AddRange(pairs.Select((p => p.IDB).ToList());
pIndices = pIndices.Distinct().ToList(); 
```

有没有更好的办法？如果没有，你更喜欢哪一个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T14:54:34.170

在单独选择 A 和 B 后，您可以使用`Union()`它们来获取它们。

```
var pIndices = pairs.Select(p => p.IDA).Union(pairs.Select(p => p.IDB)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T14:55:13.607

您可以将内部表达式缩短为`p => new [] { p.IDA, p.IDB }`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T14:59:45.287

这是一个没有新系列的：

```
var pIndices = pairs.Select(p => p.IDA)
                .Concat(pairs.Select(p => p.IDB))
                .Distinct(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T15:02:26.167

如果您不想为 each 创建一个 2 元素数组/列表`Pair`，并且不想重复您的`pairs`列表两次，您*可以*手动完成：

```
HashSet<int> distinctIDs = new HashSet<int>();
foreach (var pair in pairs)
{
    distinctIDs.Add(pair.IDA);
    distinctIDs.Add(pair.IDB);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-06T14:56:34.197

像这样缩短它：

```
var pIndices = pairs.SelectMany(p => new[] { p.IDA, p.IDB }).Distinct().ToList(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-06T15:07:02.067

使用`Enumerable.Repeat`有点不正统，但无论如何：

```
var pIndices = pairs
    .SelectMany(
        p => Enumerable.Repeat(p.IDA, 1).Concat(Enumerable.Repeat(p.IDB, 1))
    ).Distinct()
    .ToList(); 
```

最后，如果你不介意一个小助手类，你可以这样做：

```
public static class EnumerableHelper {
    // usage: EnumerableHelper.AsEnumerable(obj1, obj2);
    public static IEnumerable<T> AsEnumerable<T>(params T[] items) {
        return items; 
    }
} 
```

现在你可以这样做：

```
var pIndices = pairs
    .SelectMany(p => EnumerableHelper.AsEnumerable(p.IDA, p.IDB))
    .Distinct()
    .ToList(); 
```

# javascript - 首次加载网站后，网站 javascript 无法在 IE 上运行

> ID：13746159
> 
> 赞同：2
> 
> 时间：2012-12-06T14:51:23.373
> 
> 标签：javascript, jquery, internet-explorer

当我清除缓存并打开一个新的 IE 会话，然后导航到我正在开发的网站时，javascirpt/jQuery 没有运行。站点结构显示良好，在 F12 控制台中没有任何错误，但是在没有我的任何 javascript 插件的情况下呈现所有内容，破坏了很多元素。在 Chrome/Safari/Firefox/Mobile 浏览器中一切正常。我在 LOG 中输出的任何内容都没有被渲染，所以我假设所有的 JS 都没有运行。当我刷新页面时，一切正常。之后，它不会中断，直到我清除缓存、关闭 IE 并开始一个新会话，就像第一次使用的用户一样。

什么可能导致 javascript 第一次无法运行？我很难调试或发现类似的问题。

我正在使用的 javascript 库：

*   jquery-1.8.2 分钟
*   滚动到.js
*   揭示.js
*   幻灯片.js
*   qtip.js

编辑：这是我正在使用的 JS 代码的[链接](https://www.dropbox.com/s/7olaz7a9811r03a/jquery.vi.js)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-06T15:02:31.380

`console.log()`除非控制台窗口打开，否则IE 不会运行。所以现在，您的代码将在 IE 上停止。即使您打开了控制台窗口，我也遇到了无法正常工作的问题。尝试将其注释掉。

# ruby-on-rails - Youtube_it gem：按发布日期查询加过滤器

> ID：13746166
> 
> 赞同：0
> 
> 时间：2012-12-06T14:51:57.553
> 
> 标签：ruby-on-rails, ruby, youtube, rubygems

我正在使用 Youtube_it gem 通过[YouTube API](https://github.com/kylejginavan/youtube_it)进行搜索。

我正在尝试拨打电话，该电话将视频形式返回到日期或日期范围，也与查询匹配。例如，查询今天发布的关于猫的视频应该如下所示：

```
client.videos_by(:fields => {:published => (Date.today), :query => "cat"}) 
```

不应该吗？

到目前为止，我已经尝试了一些不同的替代方案，但都没有成功。今天的视频将被返回，但查询参数无效。这种类型的日期过滤查询是否可以通过 gem 进行？如果可以，应该采用什么格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:16:22.083

根据 rdocs， :query 应该在字段散列之外。尝试：

```
client.videos_by(:query => "cat", :fields => {:published => (Date.today)}) 
```

# linux - 无法访问 JBOSS

> ID：13746169
> 
> 赞同：1
> 
> 时间：2012-12-06T14:52:03.327
> 
> 标签：linux, jboss, ejb, fedora

我正在使用 Fedora 17 并通过 yum 安装了 JBOSS。我在standalone.xml中配置了public和management的绑定地址为0.0.0.0

但是我仍然无法通过 :8080 访问，我的浏览器显示他无法连接到该地址。

任何想法那里出了什么问题？

问候诺克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:30:06.303

我认为绑定到 0.0.0.0 会将其绑定到机器上的所有 IP 地址。我知道我过去这样做时，要访问 JBoss，我必须在 url 中使用 pc 名称。例如，如果我的 PC 的名称为 PC12345，我会使用`http://PC12345:8080/`并且您应该获得初始的 JBoss 窗口。

通常我们将我们的绑定到本地主机，然后我们使用它`http://localhost:8080/`来连接。有时我绑定到电脑号码，然后我可以像上面一样再次使用电脑。`http://PC12345:8080`.

# python - python中的递归游戏问题

> ID：13746171
> 
> 赞同：2
> 
> 时间：2012-12-06T14:52:12.800
> 
> 标签：python, recursion, logic, minesweeper

我正在用 python 创建一个扫雷器版本，并遇到了一个小问题。在这段代码中：

```
if winGame(mines):
        printWorld(gameMap)
        print 'You Win!'
        answer = raw_input('Would you like to play again?')
        if answer == 'y':
            minesweeper()
        else:
            print 'Thanks for playing!'
            break 
```

它再次调用扫雷函数，重新开始游戏。此代码与游戏代码的其余部分一起位于 while True: 循环中。唯一的问题是，如果重新开始游戏，然后赢了并说你不想再玩，它不会打破循环。我认为这与我使用递归再次调用该函数的事实有关。目前唯一可行的方法是使用 sys.exit()，但如果有意义的话，我希望有一个更合法的解决方案。

这是整个代码：

```
#Minesweeper Game

#difficulty levels
#make it look better text based

from random import *
import sys

gameMap = '''
#123456789#
1?????????1
2?????????2
3?????????3
4?????????4
#123456789#'''

row = 0
col = 0
coord = []
response = ''
numMines = 5
mines = []
answer = ''

#This runs the game
def minesweeper():

    global gameMap
    global row
    global col
    global coord
    global mines
    global response
    global answer

    #resets the gameboard after replaying.
    gameMap = '''
#123456789#
1?????????1
2?????????2
3?????????3
4?????????4
#123456789#'''

    #generates the mines
    generateMines()

    #converts the world into a list of lists. exception is for when playing again since
    #it would try to convert it to a list of lists again
    try:
        initWorld()
    except Exception, e:
        pass

    #main loop of the game.
    while True:                      

        #checks to see if you won the game
        if winGame(mines):
            printWorld(gameMap)
            print 'You Win!'
            answer = raw_input('Would you like to play again?')
            if answer == 'y':
                minesweeper()
            else:
                print 'Thanks for playing!'
                break

        #joins the list together so it can be printed
        printWorld(gameMap)
        print mines

        #gets user input and converts it to an int, then adds coords to a list
        getCoord()        

        #asks user what they want to do
        clearOrFlag()

        if response.lower() == 'c':
            if isMine(mines):
                answer = raw_input('Would you like to play again?')
                if answer == 'y':
                    minesweeper()
                else:
                    print 'Thanks for playing!'
                    break
            else:
                clearSpace(mines)
                print '\n'
        elif response.lower() == 'f':
            flagSpace()
            print '\n'

#randomly generates the mines and checks for duplicates
def generateMines():
    global numMines
    global mines
    i = 0
    mines = []

    while i < numMines:
        mines.append([randint(1,4),randint(1,9)])
        i += 1

    if checkDuplicateMines(mines):
        generateMines()

#gets coordinates from the user
def getCoord():

    global row
    global col
    global coord
    global gameMap

    row = 0
    col = 0
    coord = []

    try:
        row = raw_input('Enter an Row: ')
        row = int(row)
        col = raw_input('Enter a Column: ')
        col = int(col)
    except ValueError:
        print 'Invalid Coordinates \n'
        getCoord()

    coord.append(row)
    coord.append(col)

def isMine(mines):

    global coord
    global gameMap

    for x in mines:
            if coord == x:
                showSolution(mines, gameMap)
                return True

#asks user if they want to clear or flag a space
def clearOrFlag():

    global response

    response = raw_input("Clear (c), Flag/Unflag (f)")

#clears a space. if it's a mine, the player loses. If not it will write the
#number of surrounding mines to the space. Might break this up later.
def clearSpace(mines):

    #checks to see if selected square is a ? (playable). 
    global gameMap
    global row
    global col
    global coord

    if gameMap[row][col] == '?' or gameMap[row][col] == 'F':                       
        gameMap[row][col] = str(countMines(mines))

#flags a space, or unflags it if already flagged.
def flagSpace():

    global gameMap
    global row
    global col

    try:
        if gameMap[row][col] == '?' :
            gameMap[row][col] = 'F'
        elif gameMap[row][col] == 'F':
            gameMap[row][col] = '?'
    except Exception, OutOfBounds:
        print 'Invalid Coordinates \n'

#Prints the world
def printWorld(gameMap):

    #just prints spaces to keep things tidy
    print '\n' * 100 

    for row in gameMap:
        print ' '.join(row)
        print '\n'

    print '\n'

#initializes the world so it can be printed
def initWorld():

    global gameMap

    # convert the gamemap into a list of lists
    gameMap = gameMap.split('\n')
    del gameMap[0]

    for index in range(0, len(gameMap)):
        gameMap[index] = list(gameMap[index])

#prints the gameBoard with all of the mines visible
def showSolution(mines, gameMap):

    for x in mines:
        gameMap[x[0]][x[1]] = 'M' 

    printWorld(gameMap)
    print 'You Lose'

#counts the number of surrounding mines in a space
def countMines(mines):
    global row
    global col
    count = 0

    #theres probably a much better way to do this    
    for x in mines:
        if [row+1,col] == x:
            count += 1
        if [row-1,col] == x:
            count += 1
        if [row,col+1] == x:
            count += 1
        if [row,col-1] == x:
            count += 1
        if [row+1,col+1] == x:
            count += 1
        if [row+1,col-1] == x:
            count += 1
        if [row-1,col+1] == x:
            count += 1
        if [row-1,col-1] == x:
            count += 1

    return count

#counts the number of flags on the board
def countFlags(mines):

    global gameMap
    numFlags = 0

    for i in range (0, len(gameMap)):
        for j in range (1, len(gameMap[0])-1):
            if gameMap[i][j]=='F':
                numFlags += 1

    if numFlags == len(mines):
        return True
    else:
        return False

#counts the number of mines flagged
def minesFlagged(mines):

    global gameMap
    count = 0

    for x in mines:
        if gameMap[x[0]][x[1]] == 'F':
            count += 1

    if count == numMines:
        return True
    else:
        return False

#checks to see if there were duplicate mines generated
def checkDuplicateMines(mines):

    mines.sort()

    for x in range(0, len(mines)-1):
        if mines[x] == mines[x+1]:
            return True
        x += 1

    return False

#checks to see if player won the game
def winGame(mines):

    if countFlags(mines):
        if minesFlagged(mines):
            return True
    else:
        return False

minesweeper() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:24:12.490

如果要使用递归，请返回函数调用，不要只调用它。

```
if winGame(mines):
        printWorld(gameMap)
        print 'You Win!'
        answer = raw_input('Would you like to play again?')
        if answer == 'y':
            return minesweeper()
        else:
            print 'Thanks for playing!'
            return 
```

这样，当您的递归函数之一结束时，它会返回`None`到前一个函数，然后再返回`None`到前一个函数，依此类推，直到最后一个调用`return`结束整个递归循环。

它可能不是这个问题的最佳解决方案（看看 MathieuW 的答案，基本上是一样的）但它适用于任何情况，并且主要用于递归函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:55:45.557

如果您不回复“y”，它确实会中断循环。

但是如果你玩了N场比赛，它只会打破第N场比赛的循环，你会回到第（N-1）个函数调用的循环中。

对于实际的解决方案，我同意您已经实施的 AshRj 评论。

这是另一个仍在使用您以前的设计（但不太正确）的解决方案，只是移动了中断。

```
if winGame(mines):
        printWorld(gameMap)
        print 'You Win!'
        answer = raw_input('Would you like to play again?')
        if answer == 'y':
            minesweeper()
        else:
            print 'Thanks for playing!'
        break 
```

# exchange-server - 在 android 4.0 上填写额外的交换帐户字段意图

> ID：13746173
> 
> 赞同：1
> 
> 时间：2012-12-06T14:52:21.033
> 
> 标签：exchange-server, account, android-4.0-ice-cream-sandwich

有谁知道如何在调用时使用额外的意图预填充字段

```
 Intent intent = new Intent("android.settings.ADD_ACCOUNT_SETTINGS"); 
```

设置一个 Exchange 帐户？

```
intent.putExtra("EMAIL", "plop");
intent.putExtra("USER", "stars"); 
```

不起作用。

帮我 ！！

注意：

```
login : d@d.d 
pwd : debug 
```

允许您激活调试信息。

# java - Java SE 上的 SOAP 消息

> ID：13746176
> 
> 赞同：2
> 
> 时间：2012-12-06T14:52:41.423
> 
> 标签：java, soap, jax-ws

在 Java SE 7 上使用 JAX-WS。

Soap Handlers 的指南似乎假定了一个 Java EE 服务器。这对于 SOAP 处理程序是必不可少的，还是它们也可以在 Java SE 中工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T19:48:45.217

您可以在 Java SE 中实现 Web 服务。

您只需要启动一个端点并发布它。

[这](http://weblogs.java.net/blog/vivekp/archive/2006/12/webservices_in.html)是一个简单的例子。

Java EE 和 servlet 容器为您处理发布部分。除此之外，它们几乎是相同的东西并且处理方式相同。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-06T15:23:54.817

Web 服务可以部署在 Servlet 容器（如 Tomcat）或任何 Java EE 应用服务器（如 JBoss AS、WebLogic 等）上。

所以 Java SE 不足以部署你的 web 服务。

# windows - 批处理文件：如何使控制台窗口保持打开状态

> ID：13746177
> 
> 赞同：110
> 
> 时间：2012-12-06T14:52:41.317
> 
> 标签：windows, batch-file

我有两个批处理文件，其中一个执行另一个，即

1.  “我的批处理文件”> 2.“其他一些批处理文件”

我创建了第一个批处理文件的快捷方式并编辑了它的属性以按以下方式调用它。

```
cmd.exe /k "<SomePath>\<My Batch File>.bat" & pause 
```

**我想要做什么** 我希望在批处理文件执行结束后打开控制台窗口。现在它刚刚关闭，试图绕过 cmd 标志，没有结果。

平台：Windows7

* * *

**更新 1**

修改了结构，像这样的简单例子也不起作用，只有一个批处理文件，即没有2。“其他批处理文件”唯一的批处理文件包含这样的smth

```
start /B /LOW /WAIT make package
cmd /K 
```

* * *

**更新 2**

从资源管理器调用的相同快捷方式不会关闭控制台窗口。 **但是当从任务栏上的固定项目调用快捷方式时，控制台窗口会关闭**

任何想法如何保持控制台窗口打开？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-12-06T14:56:00.720

如果这确实是批处理文件所做的所有事情，请删除`cmd /K`并添加`PAUSE`.

```
start /B /LOW /WAIT make package
PAUSE 
```

然后，只需将您的快捷方式指向`"My Batch File.bat"`...无需使用`CMD /K`.

# 更新

啊，一些新信息……您正在尝试从任务栏上的固定快捷方式执行此操作。

我发现了这个，[将批处理文件添加到 Windows 7 任务栏，如 Vista/XP 快速启动](http://social.technet.microsoft.com/Forums/en-US/w7itproui/thread/a44e74a1-20cd-4924-8f2b-3e6b688f1ad7)，相关部分如下。

> 1.  首先，通过点击开始按钮将快捷方式`CMD.EXE`固定到任务栏，然后在搜索框中输入“cmd”，右键单击结果并选择“固定到任务栏”。
> 2.  右键单击任务栏上的快捷方式。
> 3.  您将看到一个列表，其中包括“*命令提示符*”和“*从任务栏中取消固定此程序*”。
> 4.  右键单击图标`CMD.EXE`并选择`Properties`。
> 5.  在目标框中，转到末尾`"%SystemRoot%\system32\cmd.exe"`并键入`" /C "`批处理文件的路径和名称。

出于您的目的，您可以：

1.  使用`/C`并将 a`PAUSE`放在批处理文件的末尾。

    **或者**

2.  更改命令行以使用`/K`并`PAUSE`从批处理文件中删除。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-06T22:04:12.493

在这儿：

```
cmd.exe /k "<SomePath>\<My Batch File>.bat" & pause 
```

看看你在做什么：

1.  (cmd /K) 启动**一个新的**cmd 实例。
2.  (& pause) 暂停**当前的**cmd 实例。

如何解决？好吧，使用正确的语法，包含新 CMD 实例的参数：

```
cmd.exe /k ""<SomePath>\<My Batch File>.bat" & pause" 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-08-12T18:37:38.850

我刚刚写了最后一行，因为它在 .bat 和 .cmd 上都可以正常工作**。**它还将显示消息“按任意键继续”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-06T15:02:00.490

在要保持打开的批处理文件的最后一行中，放置一个

`pause >nul`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-29T15:48:06.880

要使控制台窗口保持打开状态，您只需添加到批处理文件中的最后一个命令行：

```
' & pause' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-31T06:15:08.280

您可以在批处理文件的最后一行输入一个[`pause`命令：](https://technet.microsoft.com/en-us/library/bb490965.aspx)

```
@echo off
echo Hey, I'm just doing some work for you.
pause 
```

会给你这样的输出：

> 嘿，我只是在为你做一些工作。
> 
> 按任意键继续 ...

**注意：**使用@echo 可以防止在打印输出之前输出命令。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-21T22:57:31.507

```
rem Just use "pause" at the end of the batch file.
...
......
.......
pause 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-05-11T21:35:36.563

放在最后它将重新打开您的控制台

```
start cmd 
```

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2015-05-03T11:52:23.270

我只需按回车键并输入暂停，它就可以正常工作

# cakephp - CakePHP Auth->loginRedirect 不起作用

> ID：13746178
> 
> 赞同：1
> 
> 时间：2012-12-06T14:52:45.527
> 
> 标签：cakephp

我正在使用 cakePHP 2.2。

在我的应用控制器之前的过滤器中，我有以下内容：

```
 // Admin
    if($this->Auth->user('group_id') == '12') {
            $this->Auth->allow('admin_index'); 
            $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login', 'admin' => false);
            $this->Auth->loginRedirect = array('controller' => 'pages', 'action' => 'index', 'admin' => TRUE);
            $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login', 'admin' => false);

            $this->set("group", "admin");

    // Staff
    } elseif($this->Auth->user('group_id') == '13') {
            $this->Auth->allow('admin_index'); 
            $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login', 'admin' => false);
            $this->Auth->loginRedirect = array('controller' => 'pages', 'action' => 'index', 'admin' => TRUE);
            $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login', 'admin' => false);

            $this->set("group", "staff");

    // Users
    } else {

            $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login', 'admin' => false);
            $this->Auth->loginRedirect = array('controller' => 'pages', 'action' => 'index', 'admin' => false);
            $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login', 'admin' => false);

            $this->set("group", "user");
        } 
```

第一个和第二个 if 工作正常并将用户重定向到登录时的相应页面，但是第三个重定向根本不起作用，它只是让您留在登录页面上，但它确实显示来自登录功能的 flash_success 消息？ ??

谁能指出我正确的方向？

提前致谢

*****添加了蒂姆要求的信息*******

 **过滤和登录功能之前的用户控制器：

```
public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('logout');
    $this->Auth->allow('login');
    $this->Auth->allow('forgetpwd');
    $this->Auth->allow('reset');
    $this->Auth->allow('initDB');
    $this->Auth->allow('register');
    //$this->Auth->allow('admin_importOldUsers');
    //$this->Auth->allow('*');
}

public function login() {
    if ($this->request->is('post')) {

        $userStatusCheck = $this->User->find('first',array('conditions'=>array('User.username'=>$this->request->data['User']['username'])));

        // If user is not deleted
        if ($userStatusCheck['User']['live'] == 1) {

            // Users status.
            /* 1 = Disabled, 2 = Enabled, 3 = Waiting for Auth, 4 = refer to Darren */
            $us = $userStatusCheck['User']['user_status_id'];

            // If account is disabled
            if ($us == 1) {
                $this->Session->setFlash('Your account has been disabled, please conntact our support team.', 'flash_failure');
            } 

            // If account is waiting for authorisation
            else if ($us == 3) {
                $this->Session->setFlash('Your account is waiting to be authorised', 'flash_failure');
            }

            // If accoutn is referred to Darren
            else if ($us == 4) {
                $this->Session->setFlash('Your account is waiting to be authorised', 'flash_failure');
            } 

            // Account is enabled, proceed to login
            else if ($us == 2) {

                if ($this->Auth->login()) {
                    if ($this->Session->read('Auth.User')) {
                        $this->Session->setFlash('You are logged in!', 'flash_success');
                        //$this->redirect($this->Auth->redirect());

                        if($this->Auth->user('group_id') == '12' OR $this->Auth->user('group_id') == '13'){
                            $this->redirect('/admin/');
                        } else {
                            $this->redirect($this->Auth->redirect());
                        }
                    }            
                }
                else {
                    $this->Session->setFlash('Your username or password was incorrect.', 'flash_failure');
                }
            }

        } else {

            $this->Session->setFlash('Your account has been disabled, please conntact our support team.', 'flash_failure');

        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T12:38:01.763

虽然我还没有让 AppController beforefilter auth 重定向代码为用户组工作，但我已经设法使用以下代码在 usersController 的 login() 函数中捏造它：

```
if($this->Auth->user('group_id') == '12' OR $this->Auth->user('group_id') == '13'){
$this->redirect('/admin/');
} else {    
    $this->redirect(array('controller' => 'pages', 'action' => 'index', 'admin' => false)); #this does not work...
    //$this->redirect($this->Auth->redirect()); # Does not work
} 
```

但是让其他工作的关键是这条线

```
$this->Auth->allow(array('controller' => 'pages', 'action' => 'index', 'admin' => false)); 
```

到 AppController beforeFeature 制作它：

```
if($this->Auth->user('group_id') == '14') {
        $this->Auth->allow(array('controller' => 'pages', 'action' => 'index', 'admin' => false));
        $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login', 'admin' => false);
        $this->Auth->loginRedirect = array('controller' => 'pages', 'action' => 'index', 'admin' => false);
        $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login', 'admin' => false);

        $this->set("group", "user");
    } 
```

这感觉像是一个完全的骗局，但是在花了几天时间阅读 SO 和其他各种网站以及 cake docs 之后，我看不出有其他方法可以根据用户组在登录时将 auth 组件重定向到不同的页面。

如果有人找到更好的方法来做到这一点，我很想知道！**

# ajax - 为什么使用 wsHttpBinding 时 InstanceContextMode.PerSession 的行为类似于 PerCall？

> ID：13746180
> 
> 赞同：8
> 
> 时间：2012-12-06T14:52:53.373
> 
> 标签：ajax, wcf, soap, wshttpbinding, wcf-sessions

我有 AJAX 客户端使用 SOAP 1.2 使用的 WCF 服务

**网络配置：**

```
<endpoint address="" binding="wsHttpBinding" 
contract="WcfService1.IService1" bindingConfiguration="wsHttpBin">

<wsHttpBinding>
  <binding name="wsHttpBin">
    <security mode="None"/>          
  </binding>
</wsHttpBinding> 
```

根据我的[阅读](http://www.codeproject.com/Articles/311908/Calling-WCF-service-exposed-with-different-binding)，我必须使用，`<security mode="None"/>`因为通过“wsHttpBinding”绑定公开的服务实现了 WS-* 系列 Web 服务规范的 WS-Security。由于绑定使用安全性，因此请求将被拒绝，因为 AJAX 不支持安全上下文。

我的 WCF 服务行为定义为`InstanceContextMode.PerSession`：

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, 
                 InstanceContextMode = InstanceContextMode.PerSession)] 
```

但是当我使用它时，服务表现为 PerCall 并且每次调用都会启动一个新的 WCF 实例，而不是使用当前实例。

为什么使用 wsHttpBinding 时 InstanceContextMode.PerSession 的行为类似于 PerCall？

我能做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T16:29:35.413

通过 HTTP 使用的会话仅在使用安全会话或可靠会话时受 WCF 支持。如果你不能使用，那么你必须自己实现一个会话机制。如果您同时控制客户端和服务器端，那将很容易做到。就是这样：

创建一个包含您需要存储的所有会话数据的类（我们称之为它`SessionData`），以及`DateTime`最后一次使用会话的时间。然后添加到您的服务类（或任何其他类） a `static` `ConcurrentDictionary<string, SessionData>`.

当客户端调用您的服务时，要求它传递一个标识会话的唯一字符串（它可以在客户端随机生成）。每当客户端调用您的服务时，在字典中查找会话字符串并检索会话数据（并根据需要更新其内容）。如果它不存在，请在字典中创建一个新条目。此外，每次访问`SessionData`对象时，将“上次使用”更新`DateTime`为当前时间。后台任务应定期清除一段时间未使用的旧会话。

就是这样——你已经自己实现了会话。您现在可以使用`InstanceContextMode.Single`WCF，而不必担心每个会话会正确创建服务类的实例。

**编辑**：如果您使用 .NET 4.5 编写 WCF 服务并且您的 Web 应用程序仅针对现代浏览器，则可以`NetHttpBinding`在服务器端使用 WebSocket，在客户端使用 WebSocket。`NetHttpBinding`支持会话（指定时`SessionMode.Required`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T16:52:27.987

此[链接](http://msdn.microsoft.com/en-us/library/ms731193%28v=vs.100%29.aspx)为您提供了您需要了解的几乎所有信息（当然一般而言）。

但要准确。Msdn 谈到 WCF 会话：

> 它们由调用应用程序显式启动和终止

我必须说，我不知道任何 JS 代码/框架可以让您显式存储打开的 WCF 通信通道以保持您的“会话”处于活动状态。（您还没有提供您的客户端代码，所以我必须做出一些假设）。WCF 会话不是“基于 cookie”的。它不像 ASP.NET Web 应用程序那样在浏览器中“开箱即用”。

设置`InstanceContextMode.PerSession`使您的 WCF 服务“会话就绪”，但不足以“强制”会话。

# javascript - 有人可以解释如何在 TideSDK 1.3.1 Beta 中使用 UpdateManager 吗？

> ID：13746181
> 
> 赞同：0
> 
> 时间：2012-12-06T14:52:53.683
> 
> 标签：javascript, html, tidesdk

我想知道网上是否有人愿意与我讨论 TideSDK 1.3.1 中的部署和应用程序更新？

背景是我想构建一个包装在桌面客户端中的 HTML5 应用程序，用于在 Windows 和 Mac 上部署。生成的应用程序需要有一个简单的安装程序和一个通过 Internet 接收更新的机制，或者在 Internet 不可用时使用更新安装程序。

TideSDK 1.3.1 目前是否支持这些功能？如果是这样，是否有任何关于更新过程的文档？我查看了 API 文档并找到了对 UpdateManager 的引用，但找不到使用示例。

富有的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:35:46.660

TideSDK-1.3.1-beta 当前包含当前正在重构的更新的旧代码。因此，目前正在经历过渡。您很快就会看到我们关于我们的进展的博客。SDK 的这一部分至关重要，我们了解它对应用程序部署的重要性。

我们目前正在努力提供更好、更灵活的安装程序，一旦我们将所有这些放在一起并经过测试，就会立即向我们的用户和社区展示这些安装程序。重构和核心改进正在模块化构建和更新代码，为我们构建核心提供了更强大的基础。应用程序更新和构建服务将使用此新代码。我们将发布有关此重要功能的公告。我们正在做的事情将使每个人的一切都变得简单和完整。

# variables - 更改脚本中的 URL 并再次运行脚本

> ID：13746185
> 
> 赞同：1
> 
> 时间：2012-12-06T14:52:57.007
> 
> 标签：variables, autohotkey

我们正在使用这个脚本；

```
run "**C:\Program Files (x86)\Internet Explorer\iexplore.exe" http://SOMEURL.shtml**
Sleep, 10000
Send, %ROUTERUN%{tab}
Sleep, 1000
Send, %ROUTERPW%
Sleep, 1000
Send, {Tab}{Tab}{Space}
Sleep, 10000
Send, #Up
Send, {F5}
Sleep, 20000
Click, 1041, 575
Send, %CODE%
Sleep, 1000
Click, 1613, 983
Sleep, 1000
If WinExist Message from webpage
    WinActivate
Sleep, 1000
Click, 392, 153
Sleep, 1000
If WinExist Message from webpage
    WinActivate
Click, 219, 153
Sleep, 8000
Send, !{F4}
Sleep, 1000
FormatTime, TimeString,, LongDate
FormatTime, TimeString2,, Time
FileAppend, %VES1% %TimeString% %TimeString2% D:\Test.txt 
```

我们想要完成的是，当脚本完成后，再次运行脚本，但这次在第一行使用另一个 URL。那次是 38 次。当然我可以复制/粘贴脚本 38 次并手动更改行，但也许有一种方法可以通过变量或循环或类似的东西来解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:26:51.297

您可以使用[数组](http://l.autohotkey.net/docs/Objects.htm#Usage_Simple_Arrays)和循环来完成此操作。此示例使用[AHK_L](http://l.autohotkey.net/)

```
arr := []
arr[1] := "www.google.com"
arr[2] := "yahoo.com"
arr[3] := "www.amazon.com" 

Loop % arr.MaxIndex()
{
    site := arr[A_Index]
    Run, "C:\Program Files (x86)\Internet Explorer\iexplore.exe" %site%
    ;;; Other code here ;;;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T13:57:20.333

除了 Elliot 的回答之外，当您使用 Google Chrome 时，您可以通过以下代码通过监视鼠标状态（指针或沙漏）来“检测”页面是否已准备好下载：

```
while (A_Cursor = "AppStarting") ; While hourglass do sleep else continue
    Sleep, 500 ; Wait 500 ms then run while again...
Your next lines of code.... 
```

这样您就不必在代码中放置长时间的睡眠计时器，只是为了确保页面已下载......

此外，如果您想存储每个站点的登录名和密码，您可以使用“多维”数组

```
Arr[1,1] := "www.google.com"
Arr[1,2] := "abc@google.com"
Arr[1,3] := "s3cr3tp@ssw0rd"
Arr[2,1] := "yahoo.com"
Arr[2,2] := "abc@yahoo.com"
Arr[2,3] := "s3cr3tp@ssw0rd" 
```

等等

# json - 如何在 ios6 App 中运行 youtube

> ID：13746187
> 
> 赞同：1
> 
> 时间：2012-12-06T14:53:02.083
> 
> 标签：json, video, youtube, ios6, mpmovieplayercontroller

单击 tableView 中的单元格后，我无法直接运行视频。我使用 youtube API，didSelectRowAtIndexPath 来启动视频。而且我有不同的可能性来制作带有 JSON 结果的视频：

```
 "player": {
 "default": "https://www.youtube.com/watch?v=EHQCvSbHW-k&feature=youtube_gdata_player",
 "mobile": "https://m.youtube.com/details?v=EHQCvSbHW-k"
},
"content": {
 "5": "https://www.youtube.com/v/EHQCvSbHW-k?version=3&f=user_uploads&app=youtube_gdata",
 "1": "rtsp://v3.cache1.c.youtube.com/CigLENy73wIaHwnpW8cmvQJ0EBMYDSANFEgGUgx1c2VyX3VwbG9hZHMM/0/0/0/video.3gp",
 "6": "rtsp://v5.cache4.c.youtube.com/CigLENy73wIaHwnpW8cmvQJ0EBMYESARFEgGUgx1c2VyX3VwbG9hZHMM/0/0/0/video.3gp"
}, 
```

我尝试使用直接链接（移动和默认），但它不适用于 MPMoviePlayerController。我尝试使用 UIApplication，但视频被重定向到 Safari。我尝试使用上面的两个 .gp3 链接和这个 tuto（它适用于他们的 .mov 视频）：[http](http://www.techotopia.com/index.php/Video_Playback_from_within_an_iOS_6_iPhone_Application) ://www.techotopia.com/index.php/Video_Playback_from_within_an_iOS_6_iPhone_Application 。但它不想使用 .gp3 ...

我的代码是：

```
NSURL *url = [NSURL URLWithString:@"rtsp://v3.cache1.c.youtube.com/CigLENy73wIaHwnpW8cmvQJ0EBMYDSANFEgGUgx1c2VyX3VwbG9hZHMM/0/0/0/video.3gp"];

moviePlayer =  [[MPMoviePlayerController alloc]initWithContentURL:url];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayBackDidFinish:)name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer];
moviePlayer.controlStyle = MPMovieControlStyleDefault;
moviePlayer.shouldAutoplay = YES;
[self.view addSubview:moviePlayer.view];
[moviePlayer setFullscreen:YES animated:YES]; 
```

所以我的问题是：

*   我可以使用 .gp3 链接直接播放 youtube 视频吗？
*   或者，使用原始链接更好？
*   我可以在 ios App 中运行 rtsp 吗？怎么办？非常感谢

（我的 json [https://gdata.youtube.com/feeds/api/users/ZapSpi0nDOTcom/uploads?v=2&alt=jsonc&max-results=50&prettyprint=true](https://gdata.youtube.com/feeds/api/users/ZapSpi0nDOTcom/uploads?v=2&alt=jsonc&max-results=50&prettyprint=true)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T21:22:15.297

如果不求助于第 3 方播放器（顺便说一句效果很好），您将无法在 iPhone 上播放 rtsp，因此您唯一的选择是使用 youtube api 并播放 HLS，这将是 https 链接。youtube api 带有示例。我认为您需要使用 webview 或某种包装器。

我知道一个可能还有其他

[https://github.com/larcus94/LBYouTubeView](https://github.com/larcus94/LBYouTubeView)

# python - 提取 = 和 ; 之间的整数

> ID：13746189
> 
> 赞同：2
> 
> 时间：2012-12-06T14:53:04.610
> 
> 标签：python, regex, file-io, readline

给定以下字符串；

```
....00.3276021,,,constString1=31;garbage=00:00:00.0090000;constString2=16;garbage2=00.00... 
```

如何提取 和 的值`constString1`，`constString2`以便将它们分配给变量。例如：

```
string1_cummulativeTotal += [the magic returning the int]
string2_cummulativeTotal += [the magic returning the int] 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T14:57:07.930

```
In [1]: import re

In [2]: s = '....00.3276021,,,constString1=31;garbage=00:00:00.0090000;constString2=16;garbage2=00.00...'

In [3]: re.search('constString1=(\d+);', s).group(1)
Out[3]: '31'

In [4]: re.search('constString2=(\d+);', s).group(1)
Out[4]: '16' 
```

这些仍然是字符串，不要忘记将它们转换为整数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-06T15:07:40.527

你可以在没有正则表达式的情况下做到这一点。

```
def get_sub(s, start, end):
    s1 = s[s.find(start) + len(start):]
    return s1[:s1.find(end)]

get_sub(s, "constString1=", ";")
>>> '31'

get_sub(s, "constString2=", ";")
>>> '16' 
```

如果您想将其转换为另一种类型，您可以执行以下操作：

```
def get_sub(s, start, end, cast_to):
    s1 = s[s.find(start) + len(start):]
    return cast_to(s1[:s1.find(end)])

get_sub(s,"constString1=",";", int)
>>> 31

get_sub(s,"constString2=",";", float)
>>> 16.0 
```

**编辑**

这种方法实际上比正则表达式更快：

```
t1 = timeit.Timer(stmt="""get_sub(s,"constString1=",";", int)""", setup="""s = "....00.3276021,,,constString1=31;garbage=00:00:00.0090000;constString2=16;garbage2=00.00..."
def get_sub(s, start, end, cast_to):
    s1 = s[s.find(start) + len(start):]
    return cast_to(s1[:s1.find(end)])""")

t2 = timeit.Timer(stmt="""int(re.search("constString1=(\d+);",s).group(1))""", setup="""import re
s = "....00.3276021,,,constString1=31;garbage=00:00:00.0090000;constString2=16;garbage2=00.00..."
""")

>>> t1.timeit()
2.829952681655172

>>> t2.timeit()
3.7208872074169506 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T15:16:55.810

除了其他答案中提到的正则表达式方法之外，如果单独的项目由分号分隔，您可以使用如下代码，使用`split(';')`and ：`split('=')`

```
s='....00.3276021,,,;constString1=31;garbage=00:00:00.0090000;constString2=16;garbage2=00.00...'
string1_subtotal = string2_subtotal = 0
for ss in s.split(';'):
    a = ss.split('=')
    if a[0]=='constString1': string1_subtotal += int(a[1])
    if a[0]=='constString2': string2_subtotal += int(a[1]) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-06T15:07:13.767

为什么不一口气做完呢？

```
>>> import re
>>> s = "....00.3276021,,,constString1=31;garbage=00:00:00.0090000;constString2=16;garbage2=00.00..."
>>> ms = re.match(r'.*constString1=(\d+);.*constString2=(\d+);', s)
>>> ms.groups() #just to show you. you wont need to do this on your code...
('31', '16') 
>>> string1_cummulativeTotal += ms.group(1)
>>> string2_cummulativeTotal += ms.group(2) 
```

注意：这只有在`contString`'s 的顺序正确时才有效 (1,2....)

# actionscript-3 - Actionscript 中的多个网络摄像头

> ID：13746191
> 
> 赞同：1
> 
> 时间：2012-12-06T14:53:07.663
> 
> 标签：actionscript-3, flash, actionscript-2, webcam

我的公司希望在明年的圣诞晚会上播放好莱坞广场，而不是建造一个完整的 3x3 设备供人们坐下，我建议我只创建一个 Flash 演示文稿，向安全坐在地上的 9 个人播放 9 个网络摄像头。

任何人都可以指导我学习如何在 AS2 或 AS3 中连接它的教程，最好是 AS2，因为我不像我想要的那样精通 AS3。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:42:51.773

*好吧，在 AS3 中，理论上*它应该是这样工作的，但是由于我只连接了一个摄像头，所以我无法自己进行测试。此外，互联网周围的人似乎对此有一些问题。请记住，使用这么多摄像头可能会使您的应用程序陷入停顿。

```
var totalRows:int = 3;
var totalCols:int = 3;

var videoWidth:int = this.stage.stageWidth / totalCols;
var videoHeight:int = this.stage.stageHeight / totalRows;

for (var i:int = 0; i < Math.min(Camera.names.length, totalRows * totalCols); i++) {
    var currRow:int = Math.floor(i / totalCols);
    var currCol:int = i % totalCols;
    var video:Video = new Video(videoWidth, videoHeight);
    var cam:Camera = Camera.getCamera(i.toString());
    if (cam) {
        cam.setMode(videoWidth, videoHeight, 30);
        video.attachCamera(cam);
        video.x = currCol * videoWidth;
        video.y = currRow * videoHeight;
        this.addChild(video);
    }
} 
```

此答案假设您要将所有相机连接到一台计算机。解决此问题的另一种方法是将每个摄像头连接到单独的计算机，并将摄像头流馈送到第十台计算机进行显示。

# list - 是否可以将不同的数据类型放在同一个 List<> 中

> ID：13746194
> 
> 赞同：0
> 
> 时间：2012-12-06T14:53:24.120
> 
> 标签：list

是否可以在 C# 中将不同的数据类型放在同一个 List<> 中？

myList.Add("乔");

myList.Add(25);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:00:04.397

假设您使用的是 Java，是的。Java 中的一切都是对象，而数组采用对象。不过，祝他们好运。

# excel - 填充数组曾经有效，不再有效（下标超出范围）

> ID：13746196
> 
> 赞同：0
> 
> 时间：2012-12-06T14:53:31.380
> 
> 标签：excel, vba

我曾经用于添加/删除行组（要求）的代码。我需要修改代码，以便如果该组的第一行满足某些标准（即，该要求不是我们想要考虑的），（1）我们不会计算它并且（2）我们会隐藏该组（当前和后续 2 行）。这一切都很好。

问题是，既然我合并了这些更改，我在代码的另一部分中遇到了错误，而且我终其一生都无法弄清楚原因。我已经经历了这一切并且非常沮丧。我正在寻求帮助，并希望有人能看到我的错误（！）

我们计算分组内的开始和结束行号，并将这些计算存储在称为“开始”和“结束”的数组中。我使用 ReDim 语句来初始化我的数组，因为我认为这可能是问题的一部分，但不是。

任何关于为什么我的“下标超出范围”的见解将不胜感激。我已经跟踪了逻辑，调查了这个错误，并阅读了 VBA 数组的语法/用法。我不知道还能做什么。提前致谢。以下是相关行：

```
Sub Button1_Click()
    Cells.Select
    Selection.ClearOutline
    If Cells.EntireRow.Hidden Then Cells.EntireRow.Hidden = False
    Dim Start() As Integer
    Dim Finish() As Integer
    Dim p As Integer, q As Integer
    ReDim Start(0, 50)
    ReDim Finish(0, 50) 
```

以下内容嵌入在遍历电子表格中所有行的逻辑中：

```
i = 1

    For Row = 4 To Cells(1, 6).Value - 1
        If Begin Then
            If Cells(Row, 3).Interior.ColorIndex = 44 Then
                Start(i) = Row + 1
                j = Cells(Row, 2).Value
                Begin = False
            End If
        Else
            If Cells(Row, 2).Value = j + 1 Or Cells(Row, 2).Interior.ColorIndex = 37 Then
                Finish(i) = Row - 1
                Begin = True
                i = i + 1
                Row = Row - 1
            End If
        End If
    Next 
```

我更改的块如下（我添加的代码是我尝试隐藏行的最后一个块）。它先于前一个。我想知道我的更改如何影响上述（？！）

```
 If Cells(Row, 5).Value = "Requirement" Then
        Range(Cells(Row, 4), Cells(Row, 4)).Interior.ColorIndex = 40
        Rows(Row).Font.Bold = True
        Rows(Row).Font.Italic = False
        Rows(Row).Font.ColorIndex = 1 'Black
        If Cells(Row - 3, 4).Value = "" Then 'this is requirement #1
            Cells(Row, 4).Value = 1
            Else
            Cells(Row, 4).Value = Cells(Row - 3, 4).Value + 1
        End If

        p = Row
        q = p + 2
        Rows(p & ":" & q).Select
        If Cells(p, 19).Value = "4" Then
           Selection.EntireRow.Hidden = True
        Else
           Selection.EntireRow.Hidden = False
        End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:01:58.003

`Redim Start(0,50)`使数组维度，`0 to 0, 0 to 50`即二维数组。

这意味着当您调用数组时，您需要为两个维度 IE:`Start(0,i)`或`Finish(0,i)`. 调用`Start(i)`会导致你提到的错误。

摆脱错误的最简单方法是将 Redim 行更改为

```
ReDim Start(50)
ReDim Finish(50) 
```

这就是我假设你首先要做的事情。

注意：根据您使用的格式，您最初可能打算这样`Start(0 to 50)`做`Finish(0 to 50)`。标注中的逗号表示另一个维度，而不是下限和上限之间的分隔。

# sql-server-2008 - win server 2008 r2：更新 xml 节点

> ID：13746197
> 
> 赞同：1
> 
> 时间：2012-12-06T14:53:32.967
> 
> 标签：sql-server-2008

我试图按照这个论坛中找到的示例进行操作，但每次尝试都失败了我有一个包含 3 个列的表：`id (int), xml_badm (xml) and idsito (int)` 我必须根据指定值更新记录中的一个节点，`idsite` 这里是要更新的 xml 数据的子集：

```
<ROOT>
  <NEP>
    <VALUE>3.9</VALUE>
    <NEP_UNC>0.5</NEP_UNC>
    <NEP_YEAR_START>2009</NEP_YEAR_START>
    <POLICY>
      <VALUE>Public</VALUE>
      <YEAR>2009</YEAR>
    </POLICY>
    <NEP_YEAR_END>2009</NEP_YEAR_END>
    <NEP_METHOD>"Sampling"</NEP_METHOD>
  </NEP>
  <NEP>
    <VALUE>9.263</VALUE>
    <NEP_COMMENT>"Boh?"</NEP_COMMENT>
    <NEP_UNC>0.02</NEP_UNC>
    <NEP_YEAR_START>2010</NEP_YEAR_START>
    <POLICY>
      <VALUE>Private</VALUE>
      <YEAR>2010</YEAR>
    </POLICY>
    <NEP_YEAR_END>2010</NEP_YEAR_END>
    <NEP_METHOD>"Sampling"</NEP_METHOD>
  </NEP>
  <Rs>
    <VALUE>0.63</VALUE>
    <Rs_SIGMA>0</Rs_SIGMA>
    <Rs_UNC>0.23</Rs_UNC>
    <Rs_TS>23</Rs_TS>
    <Rs_SWC>19.12</Rs_SWC>
    <Rs_DATE_START>2010</Rs_DATE_START>
    <POLICY>
      <VALUE>Private</VALUE>
      <YEAR>2010</YEAR>
    </POLICY>
    <Rs_DATE_END>2010</Rs_DATE_END>
  </Rs>
</ROOT> 
```

我想在 2010 年将 POLICY->VALUE 设置为 Public，我尝试执行以下查询：

```
UPDATE  tcdc.dbo.BADM_Xml 
SET  xml_badm.modify('replace value of (/ROOT/NEP/POLICY/VALUE/text())[1] with   "Public"')
WHERE  xml_badm.value('(/ROOT/NEP/POLICY/YEAR)[1]','varchar(50)') = '2010' and idsito=438 
```

正如我所说，没有发生任何变化：错误在哪里？提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T08:39:41.740

对，我解决了这个问题：这是一个正确的查询也有参数

```
DECLARE @var varchar(50)
DECLARE @oldy int

set @oldy=2010
set @var='NEP'

UPDATE [table] 
SET xml_badm.modify('replace value of (/ROOT/*[local-name()=sql:variable("@var")]/POLICY[YEAR=sql:variable("@oldy")]/VALUE/text())[1] with "Private"') 
where idsito=438 
```

希望这可以帮助关于迭戈

# php - 如何从原始查询中检索结果集作为数组而不是 Laravel 3 中的对象

> ID：13746199
> 
> 赞同：31
> 
> 时间：2012-12-06T14:53:36.977
> 
> 标签：php, laravel, laravel-3

默认情况下，Laravel 的原始查询方法以 stdClass 对象数组的形式返回结果：

```
Array
(
    [0] => stdClass Object
        (
            [id] => 1
            [username] => admin
            [password] => admin123
            [email] => admin@admin.com
            [created_at] => 2012-12-06 18:57:19
            [updated_at] => 2012-12-06 00:00:00
        )

    [1] => stdClass Object
        (
            [id] => 2
            [username] => userna
            [password] => user
            [email] => user@gmail.com
            [created_at] => 2012-12-06 00:00:00
            [updated_at] => 2012-12-05 00:00:00
        )
) 
```

问题是如何让 Laravel 返回一个数组数组：

```
 Array
    (
        [0] => Array
            (
                [id] => 1
                [username] => admin
                [password] => admin123
                [email] => admin@admin.com
                [created_at] => 2012-12-06 18:57:19
                [updated_at] => 2012-12-06 00:00:00
            )

        [1] => Array
            (
                [id] => 2
                [username] => userna
                [password] => user
                [email] => user@gmail.com
                [created_at] => 2012-12-06 00:00:00
                [updated_at] => 2012-12-05 00:00:00
            )
    ) 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-06T16:01:32.417

您也可以通过更改将所有结果始终作为数组

应用程序/配置/数据库.php

```
'fetch' => PDO::FETCH_CLASS, 
```

在第 31 行到

```
'fetch' => PDO::FETCH_ASSOC, 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-12-06T15:10:09.447

# Laravel 3 的原始答案

Eloquent 有方法`to_array()`

来自文档：

> to_array 方法将自动获取模型上的所有属性，以及任何加载的关系。

```
$user = User::find($id);

return Response::json($user->to_array()); 
```

或者

```
return Response::eloquent($user); 
```

如果您使用的是 fluent，您可以按照 Sinan 的建议进行操作并更改全局配置以返回关联数组而不是对象。

或者，您可以将对象与 JSON 相互转换以将其转换为数组，尽管在大多数情况下全局选项会更可取。您可以在通常更喜欢对象但在某些极端情况下需要数组的项目中使用以下内容。这种方法在 Eloquent 上效果不好，在这种情况下使用上面的方法。

```
$users = DB::table('users')->where('name', '=', 'david')->get();

return array_map(function($val)
{
    return json_decode(json_encode($val), true)
}, $users); 
```

另一种选择是临时更改运行时配置

```
Config::set('database.fetch', PDO::FETCH_ASSOC); 
```

# 对于 Laravel ~4

从 Laravel 4 开始，所有方法名称都符合 PSR-2 标准。

```
$user = User::findOrFail($id);

return Response::json($user->toArray());

// In Laravel 5 onward the functions are preferred to facades.
return response()->json($user->toArray()); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-12-06T15:01:40.323

我不知道 laravel 是否具有将结果作为数组返回的内置函数，但如果没有，您可以使用以下代码段：

`$data`您返回的对象数组在哪里

```
$data = json_decode(json_encode((array) $data), true); 
```

# php - 如何为 MySQL 查询制作进度条

> ID：13746200
> 
> 赞同：0
> 
> 时间：2012-12-06T14:53:44.933
> 
> 标签：php, mysql

我需要发送大约 500 封电子邮件`mail()`。它需要500个循环。

我怎样才能呼应进度的百分比？

```
$percentage=55; //which changes every time it enters loop.

<div id="percentage" style="width:<?php echo $percentage;?>%></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T14:59:45.170

```
($nb_send * 100) / $total 
```

*   **$nb_send**：迭代值
*   **$total**：您的 500 封电子邮件

对于您的栏，请使用标签[进度](http://html5demo.braincracking.org/demo/progress.php) 或 HTML => [http://jsfiddle.net/zYewc/2/](http://jsfiddle.net/zYewc/2/)

# asp.net - Web 表单中的用户控制

> ID：13746203
> 
> 赞同：0
> 
> 时间：2012-12-06T14:53:52.360
> 
> 标签：asp.net, user-controls, master-pages, title

我有一个母版页和多个 Web 表单。我需要给每个表格一个不同的标题。我正在考虑为此目的使用**用户控件**，尽管我不确定它是否是一个优雅且有用的解决方案。

1）如果这确实是一个好主意，那么如何在每个表单中调用和使用该用户控件。

2）如果它没有用，也许有人可以提出更合适的解决方案。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:13:01.823

Check [this article out](http://www.asp.net/web-forms/tutorials/master-pages/interacting-with-the-master-page-from-the-content-page-cs). You can have a control in the master page that each content page can establish its own title. You'd have to programmably set it for each page.

# android - android布局：edittext左右移动

> ID：13746205
> 
> 赞同：0
> 
> 时间：2012-12-06T14:53:57.333
> 
> 标签：android, layout, android-edittext

我正在开发一个计算器，在“屏幕”上，左侧显示符号 + - * /，右侧显示数字。符号的大小不能太小，但是当用户按下符号并且符号显示例如+时，右边的数字会向右移动一点以适应符号。

右图有符号时一直向右移动，无符号时返回原位。此外，符号无法正确显示。这令人沮丧。

然而，我想保持符号和数字保持在 1 行内，这样它看起来真的像计算器。这怎么可能处理？布局代码如下。提前致谢！！！！

![在此处输入图像描述](../Images/d2ed4917b9ef7b44b01b431d7953089e.png)

```
<TableRow
    android:id="@+id/tableRow3"
    android:layout_weight="0.1"
    android:background="@android:color/white"  
    android:paddingLeft="0dp"
    android:paddingRight="0dp" >

    <EditText
        android:id="@+id/symEditText"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_gravity="left"
        android:layout_span="1"
        android:background="@android:color/transparent"
        android:clickable="false"
        android:focusable="false"
        android:focusableInTouchMode="false"
        android:gravity="right|center_vertical"
        android:inputType="numberDecimal"
        android:longClickable="false"
        android:maxLength="3"
        android:paddingRight="0dp"
        android:text=""
        android:textColor="#003366"
        android:textSize="14dp"
        android:textStyle="bold" >

    </EditText>

    <EditText
        android:id="@+id/ansEditText"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_gravity="right"
        android:layout_span="9"
        android:background="@android:color/transparent"
        android:clickable="false"
        android:ems="4"
        android:focusable="false"
        android:focusableInTouchMode="false"
        android:gravity="right|center_vertical"
        android:inputType="numberDecimal"
        android:longClickable="false"
        android:maxLength="23"
        android:paddingRight="20dp"
        android:textColor="#003366"
        android:textSize="@dimen/display_text_size"
        android:textStyle="bold" >

        <requestFocus />
    </EditText>         

</TableRow> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:01:03.347

你应该只`TableRow`在`TableLayout`. 我认为你可以只使用水平的`LinearLayout`。如果您想始终保持空间来显示符号，请为该视图提供固定宽度而不是使用`wrap_content`，否则当内容更改时它会增大/缩小。（确保以 dp 单位指定宽度）

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/symbol"
        android:layout_width="20dp" <!-- fixed size -->
        android:layout_height="wrap_content"
        <!-- more attributes -->
    </TextView>

    <TextView
        android:id="@+id/answer"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" <!-- fill remaining space -->
        android:gravity="right"
        <!-- more attributes -->
    </TextView>        
</LinearLayout> 
```

# c++ - 如何从数据集中读取特定的字符列

> ID：13746207
> 
> 赞同：2
> 
> 时间：2012-12-06T14:54:05.633
> 
> 标签：c++, dataset, char

我正在处理一个文本文件中的属性数据集，它看起来像这样：

```
e,x,y,w,t,a,f,c,b,k,e,c,s,s,w,w,p,w,o,p,n,s,g
e,f,y,y,t,l,f,c,b,w,e,r,s,y,w,w,p,w,o,p,n,y,p
e,b,s,w,t,a,f,c,b,w,e,c,s,s,w,w,p,w,o,p,n,s,g
e,b,s,w,t,a,f,c,b,w,e,c,s,s,w,w,p,w,o,p,k,s,m
e,x,y,n,t,l,f,c,b,w,e,r,s,y,w,w,p,w,o,p,k,y,g
e,b,s,w,t,a,f,c,b,k,e,c,s,s,w,w,p,w,o,p,k,s,g
e,x,f,g,f,n,f,c,n,g,e,e,s,s,w,w,p,w,o,p,n,y,u
e,b,s,y,t,l,f,c,b,k,e,c,s,s,w,w,p,w,o,p,n,s,g 
```

现在，我试图弄清楚如何轻松地从给定列中读取字符。例如，如果我想从第 3 列读取，输出将是“yyssysfs”。我不知道该怎么做。有谁知道我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:02:32.537

这是使用 iostreams 的暗内部的解决方案：

```
struct dataset_ctype : std::ctype<char>
{
  mask table[table_size];
public:
  dataset_ctype(size_t refs = 0) : std::ctype<char>(table, false, refs) {
    std::fill(table, table+table_size, (mask)alpha);
    table[','] = (mask)space;
  }
};

int main()
{
  std::string inp = 
    "e,x,y,w,t,a,f,c,b,k,e,c,s,s,w,w,p,w,o,p,n,s,g\n"
    "e,f,y,y,t,l,f,c,b,w,e,r,s,y,w,w,p,w,o,p,n,y,p\n"
    "e,b,s,w,t,a,f,c,b,w,e,c,s,s,w,w,p,w,o,p,n,s,g\n"
    "e,b,s,w,t,a,f,c,b,w,e,c,s,s,w,w,p,w,o,p,k,s,m\n"
    "e,x,y,n,t,l,f,c,b,w,e,r,s,y,w,w,p,w,o,p,k,y,g\n"
    "e,b,s,w,t,a,f,c,b,k,e,c,s,s,w,w,p,w,o,p,k,s,g\n"
    "e,x,f,g,f,n,f,c,n,g,e,e,s,s,w,w,p,w,o,p,n,y,u\n"
    "e,b,s,y,t,l,f,c,b,k,e,c,s,s,w,w,p,w,o,p,n,s,g\n";

  std::istringstream is(inp);
  is.imbue(std::locale(is.getloc(), new dataset_ctype));

  const int column = 2;
  while (is) {
    std::istream_iterator<std::string> ii(is);
    std::advance(ii, column);
    std::cout << *ii << '\n';
    is.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:29:15.607

确切地说，您对列的定义是什么。根据通常的定义，第三列中的字符列表将是 `"xfbbxbxb"`（并且第二列中的字符列表将是`",,,,,,,,"`）。您似乎想要的是第三个*字段*中的字符列表。

对于列中的字符列表，解决方案很简单。只需逐行读取`std::getline`（

对于字段中的字符列表，您必须将每一行分解为字段，可能将结果放入 `std::vector<std::string>`中，然后索引到该向量中。

如果这是一个措辞不佳的作业问题，并且您可以保证 1) 每个字段只有一个字符，并且 2) 字段由单个逗号分隔，没有额外的空格，那么您可以将字段映射到列（`2 * fieldId - 1` 给出柱子）。完成此操作后，您可以将解决方案用于列中的字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T14:57:36.353

阅读每一行，一次一个，可能去掉逗号，然后放入`std::vector`. 要获取第三列，只需遍历向量中的所有字符串，从字符串中获取第三个（如果删除逗号）字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:02:36.250

用于`std::ifstream`打开文件，然后有一个条件为的`while`循环`std::getline(file,line)`，其中. 您可以从列号 中计算出字符在行中的哪个位置，就像是（如果第一列是）。要从行中获取该字符，只需使用. 根本不需要解析该行。然后将你从每一行得到的字符推入一个.`line``std::string``i``2 * i``i == 0``std::string::operator[]``std::vector<char>`

# zsh - 在 shell 中启动交互式命令时 Enter 不起作用

> ID：13746216
> 
> 赞同：5
> 
> 时间：2012-12-06T14:54:29.503
> 
> 标签：zsh, line-breaks

在 term enter 的某些操作停止使用 shell 中的交互式命令后 - 我仍然能够启动命令，但如果命令需要额外的输入，则在 '^M' 处插入换行符。

例子：

```
$ git add -p .
diff --git a/app/models/coupon.rb b/app/models/coupon.rb
index 39df1f3..736ea62 100644
--- a/app/models/coupon.rb
+++ b/app/models/coupon.rb
@@ -3,6 +3,7 @@ class Coupon < ActiveRecord::Base
   COUPON_PRECREATE_EXPIRATION_BUFFER = 5.days
   COUPON_PRECREATE_COUNT = 15

+  include CommonNamedScopes

   belongs_to :coupon_list
   #belongs_to :couponable, :polymorphic => true
Stage this hunk [y,n,q,a,d,/,e,?]? y^M 
```

（例如，使用时可以解决同样的问题`cat`）所以它与`git`.

有人可以建议为什么会这样吗？

iTerm2 Build 1.0.0.20120724

zsh 5.0.0 (x86_64-apple-darwin11.4.2)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T15:20:40.120

这通常是因为一个程序改变了终端的状态，但没有把它改回来。

尝试运行该`reset`命令，看看是否可以解决问题。

由于您使用的是 zsh，因此您还可以使用`ttyctl -f`zsh 在运行命令后自动重置终端设置。但是在首先重置终端之前不要使用它，否则 zsh 会将设置冻结在损坏的状态。

# silverlight - datagrid 列按钮命令 (MVVM)

> ID：13746219
> 
> 赞同：2
> 
> 时间：2012-12-06T14:54:35.450
> 
> 标签：silverlight, mvvm, datagrid

我有以下

```
<ResourceDictionary 

xmlns:vm="clr-namespace:SilverlightApplication1.ViewModels.Controls"> 

<DataTemplate DataType="vm:CVItemVM" x:Key="viewmodel"> 
```

…………

```
 <sdk:DataGrid Grid.Row="1" AutoGenerateColumns="False" Width="820" MaxColumnWidth="395" ItemsSource="{Binding Path=Publications}" Visibility="{Binding Path=Publications.Count, Converter={StaticResource ConverterVisibility2_1}}">
                        <sdk:DataGrid.ColumnHeaderStyle>
                            <Style TargetType="sdk:DataGridColumnHeader">
                                <Setter Property="FontWeight" Value="Bold" />                                     
                            </Style>
                        </sdk:DataGrid.ColumnHeaderStyle>
                        <sdk:DataGrid.Columns>
                            <sdk:DataGridTextColumn Header="Title" Binding="{Binding Path=Title}"  CanUserResize="False" IsReadOnly="True" />
                            <sdk:DataGridTextColumn Header="Author" Binding="{Binding Path=Author}" CanUserResize="False" IsReadOnly="True"  />
                            <sdk:DataGridTemplateColumn Header="">                                    
                                <sdk:DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="{Binding Path=Id}" Command="{Binding Path=DeleteCommand, Mode=TwoWay}" />                                            
                                    </DataTemplate>
                                </sdk:DataGridTemplateColumn.CellTemplate>
                            </sdk:DataGridTemplateColumn>                                
                        </sdk:DataGrid.Columns>
                    </sdk:DataGrid> 
```

我面临的问题是

```
<Button Content="{Binding Path=Id}" Command="{Binding Path=DeleteCommand, Mode=TwoWay}" /> 
```

不触发绑定的命令。

```
ItemsSource="{Binding Path=Publications}" 
```

指以下（在视图模型中）

```
public ObservableCollection<PublicationVM> Publications 
```

相同的视图模型暴露

```
public ICommand DeleteCommand { get; set; } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T22:29:43.613

```
<Button Content="{Binding Path=Id}" Command="{Binding Path=DeleteCommand, Mode=TwoWay}" /> 
```

此代码试图`DeleteCommand`从 PublicationVM 对象访问属性。如果在那里定义了这样的属性，它应该可以工作（如果属性不是`null`ofc。）。如果`DeleteCommand`在同一个 VM 中定义

```
public ObservableCollection<PublicationVM> Publications 
```

那么你应该使用`RelativeSource`你的虚拟机，例如：

```
<Button Content="{Binding Path=Id}" Command="{Binding DataContext.DeleteCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" /> 
```

where `UserControl`- 你的控件类型 where `DataContext`= YourViewModel

# google-app-engine - 列出空父母的孩子？

> ID：13746244
> 
> 赞同：2
> 
> 时间：2012-12-06T14:55:53.500
> 
> 标签：google-app-engine, objectify

使用 Objectify 可以查询对象的子对象。一个对象也可以有一个 null 父级。

```
Parent parent;
List<Children> children = ofy().query(Children.class).ancestor(parent).list(); 
```

我想知道的是，如果我可以查询一个 null Parent？所以我想知道所有有一个空父母的孩子。如果我在上面传递 null 我会得到一个异常。

此外，使用 null propValue 通过属性创建查询不会返回任何内容。

```
 Query<T> q = ofy().query(clazz);
  q.filter(propName, propValue);
  return q.list(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:55:33.603

如果将 null 传递给祖先（）会从 GAE 代码中引发异常（我相信确实如此），那么是的，这是 appengine 的限制。

请注意， Query 对象是不可变的，因此在您的第二个示例中， filter() 调用无效。您必须重新分配 q 变量：

```
q = q.filter(... 
```

为了回答如何获取所有具有 null 父级的实体，您可以在键上使用不等式过滤器：

```
Key<Parent> firstParent = Key.create(Parent.class, 1L);  // first possible parent value
List<Children> children = ofy().query(Children.class).filterKey("<", firstParent).list(); 
```

# android - 需要同步 onLocationChanged

> ID：13746250
> 
> 赞同：1
> 
> 时间：2012-12-06T14:56:02.563
> 
> 标签：android, google-maps, android-service, android-location

我正在创建一个应用程序，它通过网络广播用户的位置，为此我创建了一项服务，我正在使用该服务并从中`LocationListener`获取更新 `onLocationChanged`

我设置`requestLocationUpdates`如下

```
locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER,
                                                15000,
                                                0, 
                                                geoHandler); 
```

每当我收到更新时，`onLocationChanged`我都会通过网络广播该位置。

现在问题是`onLocationChanged`太频繁地触发，即使它没有超过时间限制*（这是完全不可预测的）* ，这反过来又触发了我的自定义函数，该函数过于频繁地广播位置信息。

所以我不知道如何以适当的及时方式**同步**此过程，例如每 15 秒后，该位置将通过网络广播，而不是过于频繁地启动它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:36:46.430

`locationManager.requestLocationUpdates (String provider, long minTime, float minDistance, LocationListener listener)`

`minTime` 是位置更新之间的最小时间间隔，以毫秒为单位

`minDistance` 是位置更新之间的最小距离，以米为单位

您将 minTime 设置为 15 秒，但由于您的 minDistance 为 0 米，因此触发过于频繁。由于 GPS 值的微小变化会触发位置更新，因此无需等待 15 秒即可通过。提供一些米（例如 1 或 3）将增加更新之间的间隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:08:55.600

`onLocationChanged`被调用的频率如何？

这是一种奇怪的行为，因为当您将 minTime!=0 参数添加到：

`locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, minTime, minDistance, geoHandler)`

那么只有在 minTime 之后才会通知侦听器。

经过更深入的研究，我发现 minTime 是相对的。它取决于许多因素，因此您的 onLocationChanged 不会在 minTime 之后精确调用。Google 建议将此参数用于电源和电池效率。所以你应该使用更大的值，比如 1000*60*5（5 分钟。）

如果你真的需要每 15 秒广播一次你的位置，你应该记住 GPS 精确定位不能立即触发，至少需要 5-10 秒（最好的情况）。因此，您必须将设计更改为以下内容：

*   `locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, geoHandler)`
*   `onLocationChanged`只需检查您上次发送/处理您的位置的时间，如果经过的时间> = 15秒，则广播它；

希望它可以帮助你。

# mysql - MySQL DATETIME 格式的“正式”名称是什么？

> ID：13746251
> 
> 赞同：5
> 
> 时间：2012-12-06T14:56:07.333
> 
> 标签：mysql, datetime-format, iso8601, rfc2822

有人知道`YYYY-MM-DD HH:MM:SS`MySQL DATETIME 使用的日期格式的正式名称吗？有吗？它看起来*接近*ISO 8601，但如果您尝试互换使用这两者，它的差异足以在大多数应用程序中中断。

有时我发现自己需要在对话中引用这种特定格式，但将其称为“DATETIME 格式”总是会让那些没有对数据库做太多工作的人产生空白。我习惯于具有正式名称和极其正式定义的日期格式。（RFC 2822，有人吗？）那么，存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:36:16.277

MySQL 的[日期和时间文字](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html)在参考手册中进行了描述。AFAICS，既没有提到 ISO，也没有提到任何其他名称。

[Wikipedia，ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)显示了 ISO 组合日期和时间格式，即“2012-12-04T20:03”（“YYYY-MM-DDTHH:MM”），与提到的 MySQL 日期时间格式不同。

所以，虽然它看起来大致像一个 ISO 日期时间，但我只称它为 MySQL 或 SQL 格式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-06-16T06:43:20.000

## 2021

*Olaf Dietsche*的回答是正确的，但过时（2012 年）并且截至 2021 年略有不准确。根据[Wikipedia ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)：

> 从 ISO 8601-1:2019 开始，基本格式为 T[hh][mm][ss]，扩展格式为 T[hh]:[mm]:[ss]。 早期版本在两种格式中都**省略了 T （代表时间）。**

也来自同一个链接：

> **ISO 8601-1:2019 允许在扩展格式中省略 T**，如“13:47:30”，但仅在不存在日期表达式歧义风险时才允许在基本格式中省略 T。

* * *

MySQL 在他们的文档中提到了“ISO”（没有数字），在[一个链接](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html)中他们确实提到了`ISO format refers to ISO 9075, not ISO 8601.`.

[ISO 9075](https://en.wikipedia.org/wiki/ISO/IEC_9075)基本上是 MySQL 标准。

顺便说一句，ISO 8601 和 RFC 3339 几乎是一回事（从开发人员的角度来看）。如果您有兴趣，[请阅读](https://stackoverflow.com/a/522281/134824)。

* * *

#### 底线：

MySQL 日期时间格式与 ISO-8601 / RFC-3339 的相同格式*匹配*，尽管 MySQL 有*自己的*标准[ISO 9075](https://en.wikipedia.org/wiki/ISO/IEC_9075)。因此，对于 MySQL 日期时间格式，我们可以将其称为以下**任何**一种：

*   **ISO 8601**又名**RFC 3339**
*   **MySQL 格式**又名**ISO 9075**。

# php - Codeigniter 表单提交到多个地方

> ID：13746254
> 
> 赞同：3
> 
> 时间：2012-12-06T14:56:12.670
> 
> 标签：php, html, codeigniter, constantcontact

我知道 html 表单不可能有两个操作，但也许有更好的方法来完成我需要的操作。我有一个简单的表格，它收集用户的电子邮件地址并为他们注册一个恒定联系电子邮件列表。此外，电子邮件被提交给另一个控制器，该控制器显示一条感谢消息，其中包含表单中的 $email 变量。我可以分别完成这两件事，但不能让它们彼此同步工作，因为表单信息被发送到thankyou() 和Constant Contact 站点。我确信有一种方法可以让我通过thankyou() 控制器将此数据发送给Constant Contact，我只是不知道该怎么做。

另外，我不能对此使用 ajax，因为我需要在提交时显示不同的页面以跟踪查看感谢页面的次数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:06:12.663

使用[flashdata](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)，并将电子邮件地址存储在 flashdata 变量中。

```
$this->session->set_flashdata('email', $email); 
```

请记住，如果在下一个请求中不使用 flashdata，您将需要“保留”它，否则它将消失。

```
$this->session->keep_flashdata('email'); 
```

然后，将`$email`视图的变量设置为`$this->session->flashdata('email');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:24:41.970

它应该是这样的： - 鉴于：

```
<form action="mycontroller/save">
</form> 
```

在我的控制器中：

```
public function save(){
  // Do whatever you have to do
  $this->session->set_flashdata('email',$this->input->post('useremail'));
  redirect('url to thankyou() controller');

} 
```

在谢谢控制器：

```
public function save(){
  // Do whatever you have to do
  $email = $this->session->flashdata('email');
  $this->load->view('yourview',$email);

} 
```

# java - 如何使用休眠存储日期值

> ID：13746257
> 
> 赞同：0
> 
> 时间：2012-12-06T14:56:18.737
> 
> 标签：java, hibernate

```
 @Temporal(javax.persistence.TemporalType.DATE)
  private Date docDate;
  public Date getDocDate() {
    return docDate;
}
public void setDocDate(Date docDate) {
    this.docDate = docDate;
} 
```

但错误显示如下

```
Error setting expression 'docDate' with value '[Ljava.lang.String;@843f72'
ognl.MethodFailedException: Method "setDocDate" failed for object net.top.app.entity.document.Document@291a66 [java.lang.NoSuchMethodException: net.top.app.entity.document.Document_$$_javassist_4.setDocDate([Ljava.lang.String;)]
    at ognl.OgnlRuntime.callAppropriateMethod(OgnlRuntime.java:1285)
    at ognl.OgnlRuntime.setMethodValue(OgnlRuntime.java:1474) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:14:13.013

As per the Error , `setDocDate()` is having Date field as input type.

You are setting the `docDate` in UI it self, try to convert the field to Date and set it to `docDate`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T14:58:35.007

您的代码正在尝试将 String 传递给`setDocDate()`. 更改它以传递日期。

# mysql - 如何在mysql查询中使用正则表达式

> ID：13746261
> 
> 赞同：3
> 
> 时间：2012-12-06T09:30:34.773
> 
> 标签：mysql, regex

我在数据库中有以下条目：

```
id       summary
1       numbers of word 200 in the doc 0x123
2       [main] numbers of word 150 in the doc 0x678
3       numbers of word 678 in the doc 0x4536 
4       this file has empty
5       not completed
6       numbers of word 86542 in the doc 0x6356 
```

我想从数据库“页面”和表名“详细信息”中检索关于汇总值的 id。我想要所有四个具有汇总值的 id (1,2,3,6)`"numbers of word <any_number> in the doc <any_number>` 并使用空格进行管理...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T10:05:58.510

如果您可以接受`%`也匹配非数字的权衡，那么使用`LIKE`SQL 运算符是微不足道的，它也是跨平台的。

```
select * from details where lower(summary) LIKE 'numbers of word % in the doc %' 
```

如果您只想匹配数字和空格，我认为您确实需要正则表达式，幸好 MySQL 直接支持。[MySQL 5.1 手册，第 12.5.2 节：正则表达式](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)。像这样的东西：

```
select * from details
where lower(summary) REGEXP '^numbers of word [0-9 ]+ in the doc [0-9x ]+$' 
```

如果您不需要或不希望不区分大小写，则可以取消对`LOWER()`. 我包含`x`在第二个正则表达式中，因为您的数字以`0x`（十六进制？）为前缀。

请记住，索引可能无法使用，`LIKE`或者`REGEXP`这意味着查询将产生相对非常大的 I/O 成本。

# linux - 什么Linux类相当于CStdioFile

> ID：13746264
> 
> 赞同：0
> 
> 时间：2012-12-06T14:56:32.077
> 
> 标签：linux, windows, file, porting

哪个 Linux 类相当于 Windows MFC 类 CStdioFile？

我正在将一些类移植到 linux。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:11:09.340

没有这样的 Linux 类等价物。Linux 上不存在 MFC。（我以为它已经在 Windows 上消失了。）

在 Linux 上尽可能接近 MFC 类的最佳选择是使用 wxWidgets。例如，它有一个`wxFFile`用于缓冲 I/O 的类。

否则，使用 C++ 类`std::iostream`。界面确实与`CFile`虽然不同。

# forms - MS Access 表单上是否有任何类型的拖放功能？

> ID：13746269
> 
> 赞同：2
> 
> 时间：2012-12-06T14:56:41.860
> 
> 标签：forms, ms-access, drag-and-drop, igrid

我们的一位客户需要能够在放置在 MS Access 表单上的[iGrid ActiveX 网格控件内拖放树的节点。](http://www.10Tec.com/)所有基于类拖放和 OLE 拖放的技术都可以在“大”经典 Visual Basic (VB6) 中与我们的 iGrid 很好地配合使用，但似乎它们都不适用于 MS Access 表单。

MS Access 有什么解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:53:46.537

感谢您将该链接放在您的帖子中，我用它来阅读 iGrid。我对此有点感兴趣，甚至可以尝试演示。但是，如果您想要一个专门使用 iGrid 的解决方案，我认为您必须直接与他们联系（显然甚至没有 iGrid 标签，这通常意味着很少有关于它的问题）。

既然您正在谈论将字段拖放到表单上，那么 Access 的本机数据透视表怎么样？您可以将一个放在表单中，让用户决定将哪些字段用于行、列等。

# salesforce - Salesforce 中 Blob 对象的 toPdf 方法的字符集问题

> ID：13746270
> 
> 赞同：0
> 
> 时间：2012-12-06T14:56:42.547
> 
> 标签：salesforce, apex-code

我需要在 pdf 文档中打印出土耳其字符，如“ş”、“ç”、“ü”等。我正在使用以下代码。

```
global class InvoicePDFGenerator {

    public static final String FORM_HTML_START = '<HTML><BODY>';
    public static final String FORM_HTML_END = '</BODY></HTML>';

    webservice static void generateInvoicePDF(String invoiceId){
        OppoInvoice__c invoice= [SELECT Id,Account_Name__c FROM OppoInvoice__c WHERE Id=:invoiceId];
        String pdfContent = '';
        try {
            pdfContent = '<html><head><meta http-equiv=content-type content=text/html;charset=iso-8859-9></meta></head><body>';

            pdfContent = pdfContent + '<P>' + invoice.Account_Name__c+ '</P>';
            pdfContent = pdfContent + FORM_HTML_END;
        }catch(Exception e){
            pdfContent = '' + FORM_HTML_START;
            pdfContent = pdfContent + '<P>THERE WAS AN ERROR GENERATING PDF: ' + e.getMessage() + '</P>';
            pdfContent = pdfContent + FORM_HTML_END;
        }

        Attachment attachmentPDF = new Attachment();
        attachmentPDF.parentId = invoice.Id;
        attachmentPDF.Name = 'Invoice.pdf';
        attachmentPDF.body = Blob.toPDF(pdfContent); //This creates the PDF content
        insert attachmentPDF;

    }
} 
```

`attachmentPDF.body = Blob.toPDF(pdfContent)`我认为是从线引起的问题。你对这个问题有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T08:02:47.550

我将带有土耳其字符的字符串常量推送到 pdfContent 中。对于输入值“öçşğüıÖÇŞĞÜİ”，输出为“öçüÖÇÜ”。

这是无需查询的代码。

```
global class AccountPDFGenerator
{

    webservice static void generateInvoicePDF(String accountId)
    {
//     Account account = [SELECT Id,Name FROM Account WHERE Id=:accountId];

        String accId = accountId;

        String pdfContent = '';
        try
        {
            pdfContent = '<html><head><meta http-equiv="content-type" content="text/html; charset=iso-8859-9"></meta></head><body>';           
            pdfContent = pdfContent + '<p style="color:red">' + 'öçşğüıÖÇŞĞÜİ' + '</p>';
            pdfContent = pdfContent + '</body></html>';
        }catch(Exception e)
        {
            pdfContent = pdfContent + '<P>THERE WAS AN ERROR GENERATING PDF: ' + e.getMessage() + '</P>';
        }
        pdfContent = 'öçşğüıÖÇŞĞÜİ'; 

        Attachment attachmentPDF = new Attachment();
        attachmentPDF.parentId = accId;
        attachmentPDF.Name = 'Invoice.pdf';
//     attachmentPDF.body= Blob.valueOf(pdfContent);
        attachmentPDF.body = Blob.toPDF(pdfContent); //This creates the PDF content
        insert attachmentPDF;

    } 

} 
```

这是为自定义按钮创建的javascript代码，其中设置>自定义>帐户>按钮和链接

```
{!REQUIRESCRIPT("/soap/ajax/15.0/connection.js")}
{!REQUIRESCRIPT("/soap/ajax/15.0/apex.js")}
sforce.apex.execute("AccountPDFGenerator","generateInvoicePDF", {id:"{!Account.Id}"});
window.alert("Account Id is sent." ); 
```

这是html文件内容

```
<html><head><meta http-equiv=content-type content=text/html;charset=iso-8859-9></meta></head><body><p>öçşğüıÖÇŞĞÜİ</p></body></html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:55:39.330

这可能是`Blob.toPDF`您应该向 Salesforce 报告的方法的限制。

我能想出的最接近的解决方案是`escapeHtml4()`在每个字符串上使用该方法，但这仅涵盖字符实体的子集。它将您的示例字符串转换`'abcşidça'`为`'abcşid&ccedil;a'`.

如果`meta`标签影响输出，您可以尝试使用 just 启动 HTML，`<html><body>`看看是否有帮助。

# jquery - 在 jquery 中读取响应

> ID：13746276
> 
> 赞同：1
> 
> 时间：2012-12-06T14:57:02.967
> 
> 标签：jquery

我正在使用最简单的 Jquery 代码来检查是否向服务器发出请求以检查某些表列并相应地返回 true 或 false ....

```
 $.ajax({
        type: "POST",
        url: "check_ajax_availablity.php",
        data: "user_name=" + user_name,

        success: function (server_response) {
            alert(server_response);                                
        }
    }); 
```

我的 PHP 脚本是...

```
<?php
    include 'admin_functions.php';
    if (isset($_REQUEST)) {
        $user_name = $_REQUEST['user_name'];
        $condition = " `UserName` = '" . $user_name . "'";
        $result = $oAdmFun->chk_records('login_admin', $condition);
        if ($result == TRUE) {
            return "N";
        } else {
            return "Y";
        }
    }
?> 
```

问题是它的警报空白值......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:04:32.987

代替`return "N"`and `return "Y"`，尝试使用`echo "N"`and `echo "Y"`。

# javascript - 我应该如何处理许多 AJAX 调用？

> ID：13746280
> 
> 赞同：2
> 
> 时间：2012-12-06T14:57:09.487
> 
> 标签：javascript, jquery, ajax, http, client-side

我正在尝试编写一个可以与我的服务器一起使用的插件。每个页面加载都会调用我的服务器的 AJAX 调用以获取数据，服务器应该返回一个简单的字符串。

现在我试图了解这种程序的最佳方法是什么。

我应该在每次需要数据时创建一个 AJAX 调用，还是有什么方法可以创建一个开放连接（尽管网页发生了变化）以节省服务器电源？

我应该以某种方式听一些端口或类似的东西吗？

我还有其他选择吗？或者我应该怎么做才能以最有效的方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:54:50.867

您可以使用 HTML5 **websockets** (http://www.html5rocks.com/en/tutorials/websockets/basics/) 如果您使用这种方法，那么您将需要重新考虑您的网络服务器编程方式，因为 websockets 没有t 遵循 AJAX 做的请求-响应范式。相反，他们使用连接来传输数据，因此您需要在服务器上打开一个端口并收听它，实现方式取决于您使用的语言或框架。这快速且响应迅速，但仅适用于大多数现代浏览器。

其他方法是使用**长轮询**（http://techoctave.com/c7/posts/60-simple-long-polling-example-with-javascript-and-jquery）。这被一些聊天客户端使用。它向服务器发送 AJAX 请求，服务器接收它并保持等待，直到数据可用，然后发送响应。然后客户端发出另一个请求，等待并重复。

可能您几乎从不想向客户端发送简单的字符串。使用 XML 或 JSON 对响应进行编码几乎总是更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:04:10.577

只需创建一个简单的 AJAX 调用并将其放在每个页面上，或者将其保存为自己的文件并将服务器包含在每个页面的标题中。就那么简单！

```
$(document).load(function(){    

    $.ajax({
        type: "POST",
        url: "/where_your_string_is.php",
        success: function(msg){

            $("#stringHolder").html(msg);

            }

    }); 

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-22T07:46:41.587

Websockets API 允许双向通信，但我刚刚发现如果您只需要提取数据，可以使用另一个称为[HTML SSE的选项。](http://www.html5rocks.com/en/tutorials/eventsource/basics/)因此，如果您偶然发现了这个问题，也请考虑这个选项。

# c# - 从 sql 数据库创建站点地图 xml 并使用 c# 将其存储在服务器上的站点文件夹中

> ID：13746281
> 
> 赞同：2
> 
> 时间：2012-12-06T14:57:16.357
> 
> 标签：c#, sql, sql-server, xml

我需要从我的数据库中为 google 创建一个站点地图 xml，并使用 C# 将其存储在服务器上。这就是我到目前为止所得到的一切..（帮助我如何检索这个 xml 文件并使用 c# 以文件名 xxxx.xml 存储在服务器上）

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create PROCEDURE [dbo].[SitemapXML]
(@url NVARCHAR(500) = '', )
AS
BEGIN
    WITH XMLNAMESPACES 
    (
        DEFAULT 'http://www.sitemaps.org/schemas/sitemap/0.9'
    )
    SELECT  
        @url + '/default.aspx?page=' + CAST(a.id AS NVARCHAR(10)) AS 'location',
        CONVERT(NVARCHAR(30), a.page_date, 110) AS 'lastmodified',      
    FROM    
        tbl_mytable a WITH (NOLOCK)
    FOR XML PATH('url'), ROOT('urlroot')
END 
```

但这是将其 url 读取到 xml 中的很少页面，并在 id 为 10 的中间中断。并且没有正确关闭 xml 标记。请帮忙。

谢谢

这是输出：

```
<urlroot xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
<url><location>xxx.com/default.aspx?page=1</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=2</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=3</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=4</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=5</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=6</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=7</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=8</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=9</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=10</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=11</location><lastmod>01-01-2012</lastmod></url>
<url><location>xxx.com/default.aspx?page=12</location><lastmod>01-01-2012</lastmod> 
```

它在第 12 页中断，但我在数据库表中有很多页面。

# android - 在 Actionbar 中使用“SearchView”和 ActionbarSherlock

> ID：13746283
> 
> 赞同：2
> 
> 时间：2012-12-06T14:57:19.127
> 
> 标签：android, search, actionbarsherlock

我正在尝试在[ActionbarSherlock ver 4.2](http://actionbarsherlock.com/)中“搜索” 。ActionbarSherlock 在最新版本中向后移植了 SerchView。

`onCreateOptionsMenu`我有以下代码`SherlockListFragment`

```
 @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        // Place an action bar item for searching.
        SearchView searchView = new SearchView(getSherlockActivity().getSupportActionBar().getThemedContext());
        searchView.setQueryHint("Search Friends");
        searchView.setIconified(true);

        menu.add(Menu.NONE, Menu.FIRST, Menu.FIRST, "Refresh")
                .setIcon(R.drawable.ic_action_refresh)
                .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
        menu.add(Menu.NONE, Menu.FIRST + 1, Menu.FIRST + 1, "Search")
                .setIcon(R.drawable.abs__ic_search)
                .setActionView(searchView)
                .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);

    } 
```

和下面的代码

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case Menu.FIRST:
            Toast.makeText(getActivity(),"FIRST", Toast.LENGTH_SHORT).show();
            break;
         case Menu.FIRST + 1:
             Toast.makeText(getActivity(),"FIRST+1", Toast.LENGTH_SHORT).show();
            break;
    }
    return super.onOptionsItemSelected(item);
} 
```

当我单击 ABS 中的“刷新”按钮时，我得到了 Toast，但当我单击“搜索”时没有响应，它会展开并转换为 EditText，但不会触发 Toast。

**我的问题**

如何将Actionbar中的“搜索”与ABS集成？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T15:32:45.967

有用。

对于 SearchView 的实现，我们需要像这样实现回调接口

```
searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {

            /**
             * Called when the user submits the query. This could be due to a key press on the
             * keyboard or due to pressing a submit button.
             * The listener can override the standard behavior by returning true
             * to indicate that it has handled the submit request. Otherwise return false to
             * let the SearchView handle the submission by launching any associated intent.
             *
             * @param newText the query text that is to be submitted
             * @return true if the query has been handled by the listener, false to let the
             *         SearchView perform the default action.
             */
            @Override
            public boolean onQueryTextSubmit(String newText) {

                return true;
            }

            /**
             * Called when the query text is changed by the user.
             *
             * @param newText the new content of the query text field.
             * @return false if the SearchView should perform the default action of showing any
             *         suggestions if available, true if the action was handled by the listener.
             */
            @Override
            public boolean onQueryTextChange(String newText) {

                ThizLog.d(TAG, "Inside onQueryTextChange");
                // called when the action bar search text has changed.  Update
                // the search filter, and restart the loader to do a new query
                // with this filter.
                String newFilter = !TextUtils.isEmpty(newText) ? newText : null;
                // Don't do anything if the filter hasn't actually changed.
                // Prevents restarting the loader when restoring state.
                if (mCurFilter == null && newFilter == null) {
                    return true;
                }
                if (mCurFilter != null && mCurFilter.equals(newFilter)) {
                    return true;
                }
                mCurFilter = newFilter;
                getLoaderManager().restartLoader(0, null, this);
                return true;
            }
        }); 
```

在这种特殊情况下，我们需要将用户输入的文本传递给 CursorLoader 并让它重新加载具有适当结果的光标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-02T00:09:26.837

此问题已在ActionBarSherlock[版本 4.3.0中得到修复。](https://github.com/JakeWharton/ActionBarSherlock/blob/master/CHANGELOG.md#version-430-2013-04-15)

# php - 将多个相邻的矩形合并为一个多边形

> ID：13746284
> 
> 赞同：19
> 
> 时间：2012-12-06T14:57:19.853
> 
> 标签：php, geometry, polygons, rectangles

**背景**：我正在一个小型购物中心的网站上工作，该网站有多个矩形“单元”可供出租。当一个“商店”来时，它可以租一个或多个“单元”，我想生成一个由商店组成的地图（没有未租的单元）

**问题**：

我有一个由点对定义的矩形列表（*单位*）`[[lefttop_x;lefttop_y];[rightbottom_x;rightbottom_y]]`——我想将它们合并为多边形，这样我就可以正确地设置它们的样式（然后我将通过 Canvas/SVG/VML/Raphael.js 进行渲染）。

*   单位总是矩形
*   单位有不同的大小
*   单元总是相邻的（它们之间没有空间）

由于这个（最好是 PHP，但我可以处理伪代码）操作，我想要一个多边形点数组。

![矩形合并——视觉提示](../Images/40f6b702e17d3e8a9b225de400caeffc.png)

谢谢你。

PS：我一直在研究这个，我发现了多个“接近我想要的”的问题+答案，但是我要么太累了，要么我已经与数学脱节太久了:)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-13T01:00:45.057

O'Rourke 研究了一个与这个问题相关的问题（以及与计算几何相关的许多其他问题），因此，产生了一种非常漂亮的方法来有效地解决它。他的方法在“[正交连接点的唯一性”一文中进行了描述，并且在](http://cs.smith.edu/~orourke/Papers/OrthoConnect.pdf)[http://www.cs.mcgill.ca/~cs644/Godfried/2005/Fall/sdroui9/p0_introduction.html](http://www.cs.mcgill.ca/~cs644/Godfried/2005/Fall/sdroui9/p0_introduction.html)上也有清楚的说明. 请注意，它表示多边形不应共享顶点以应用此方法，但这在我们在这里讨论的问题中经常发生。因此，我们需要做的就是消除共享的顶点。请注意，这仍然会产生一个多边形，并且它是作为结果想要的多边形。还要注意矩形列表不能包含重复项（我会假设是这种情况，否则对其进行预处理以使列表唯一）。

我已经使用 Python 对其进行了编码，如果对其含义有任何疑问，请随时提问。这是实现的概述。我们从根据 OP 符号描述的矩形列表开始。然后我们得到每个矩形的四个顶点，沿途丢弃共享的顶点。这可以通过使用`set`. 现在我们简单地应用上面提到的算法。请注意，我使用两个哈希表`edges_h`（用于水平边缘）和`edges_v`（用于垂直边缘）来存储多边形边缘。这些哈希表有效地作为无向图工作。因此，在获得所有边之后，可以轻松快速地获得多边形的有序顶点。`edges_h`例如，从哈希表中选择任何（键，值） 。现在，下一个有序顶点是由`edges_v[value] = next_value`, 下一个`edges_h[next_value]`，依此类推。重复这个过程，直到我们碰到第一个选择的顶点，就完成了。

快速查看上述算法是：

1.  按最低 x、最低 y 排序点
2.  遍历每一列并在该列中的顶点 2i 和 2i + 1 之间创建边
3.  按最低 y、最低 x 对点进行排序
4.  遍历每一行并在该行中的顶点 2i 和 2i + 1 之间创建边。

```
# These rectangles resemble the OP's illustration.
rect = ([[0,  10], [10, 0]],
        [[10, 13], [19, 0]],
        [[19, 10], [23, 0]])

points = set()
for (x1, y1), (x2, y2) in rect:
    for pt in ((x1, y1), (x2, y1), (x2, y2), (x1, y2)):
        if pt in points: # Shared vertice, remove it.
            points.remove(pt)
        else:
            points.add(pt)
points = list(points)

def y_then_x(a, b):
    if a[1] < b[1] or (a[1] == b[1] and a[0] < b[0]):
        return -1
    elif a == b:
        return 0
    else:
        return 1

sort_x = sorted(points)
sort_y = sorted(points, cmp=y_then_x)

edges_h = {}
edges_v = {}

i = 0
while i < len(points):
    curr_y = sort_y[i][1]
    while i < len(points) and sort_y[i][1] == curr_y: //6chars comments, remove it
        edges_h[sort_y[i]] = sort_y[i + 1]
        edges_h[sort_y[i + 1]] = sort_y[i]
        i += 2
i = 0
while i < len(points):
    curr_x = sort_x[i][0]
    while i < len(points) and sort_x[i][0] == curr_x:
        edges_v[sort_x[i]] = sort_x[i + 1]
        edges_v[sort_x[i + 1]] = sort_x[i]
        i += 2

# Get all the polygons.
p = []
while edges_h:
    # We can start with any point.
    polygon = [(edges_h.popitem()[0], 0)]
    while True:
        curr, e = polygon[-1]
        if e == 0:
            next_vertex = edges_v.pop(curr)
            polygon.append((next_vertex, 1))
        else:
            next_vertex = edges_h.pop(curr)
            polygon.append((next_vertex, 0))
        if polygon[-1] == polygon[0]:
            # Closed polygon
            polygon.pop()
            break
    # Remove implementation-markers from the polygon.
    poly = [point for point, _ in polygon]
    for vertex in poly:
        if vertex in edges_h: edges_h.pop(vertex)
        if vertex in edges_v: edges_v.pop(vertex)

    p.append(poly)

for poly in p:
    print poly 
```

结果是多边形的有序顶点列表：

```
[(0, 0), (0, 10), (10, 10), (10, 13), (19, 13), (19, 10), (23, 10), (23, 0)] 
```

我们还可以尝试更复杂的布局：

```
rect = ([[1, 2], [3, 1]], [[1, 4], [2, 2]], [[1, 6], [2, 4]], [[2, 6], [3, 5]],
        [[3, 8], [4, 4]], [[2, 8], [3, 7]], [[3, 10], [5, 8]], [[3, 4], [9, 3]],
        [[4, 5], [7, 4]], [[6, 8], [7, 5]], [[6, 9], [8, 8]], [[8, 9], [10, 6]],
        [[9, 6], [10, 3]]) 
```

它表示为以下一组矩形：

![在此处输入图像描述](../Images/18e3e2cae801fdc8808eaee55215989c.png)

并且该方法产生以下列表：

```
[(6, 9), (6, 5), (4, 5), (4, 8), (5, 8), (5, 10), (3, 10), (3, 8),
 (2, 8), (2, 7), (3, 7), (3, 6), (1, 6), (1, 1), (3, 1), (3, 2),
 (2, 2), (2, 5), (3, 5), (3, 3), (10, 3), (10, 9)]

[(9, 4), (9, 6), (8, 6), (8, 8), (7, 8), (7, 4)] 
```

如果绘制，则分别以蓝色和红色表示多边形，如下所示：

![在此处输入图像描述](../Images/d64dca06fd9a4eb9a1abc013dd6e0ccb.png)

作为简单的基准测试：

*   1000 个矩形：~ 0.04 秒
*   10000 个矩形：~ 0.62 秒
*   100000 个矩形：~ 8.68 秒

这些时间只是在一台繁忙的过时机器上运行 10 次的平均值。矩形是随机生成的。

编辑：

如果需要[，在 PHP 中实现。](http://pastebin.com/NTvK6r03)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-10T21:59:06.273

这是我的解决方案：

### RectUnion.php

```
<?php 

class RectUnion {
    private $x, $y;
    private $sides;
    private $points;

    function __construct() {
        $this->x = array();
        $this->y = array();
        $this->sides = array();
        $this->points = array();
    }

    function addRect($r) {
        extract($r);
        $this->x[] = $x1;
        $this->x[] = $x2;
        $this->y[] = $y1;
        $this->y[] = $y2;
        if ($x1 > $x2) { $tmp = $x1; $x1 = $x2; $x2 = $tmp; }
        if ($y1 > $y2) { $tmp = $y1; $y1 = $y2; $y2 = $tmp; }
        $this->sides[] = array($x1, $y1, $x2, $y1);
        $this->sides[] = array($x2, $y1, $x2, $y2);
        $this->sides[] = array($x1, $y2, $x2, $y2);
        $this->sides[] = array($x1, $y1, $x1, $y2);
    }

    function splitSides() {
       $result = array();
       $this->x = array_unique($this->x);
       $this->y = array_unique($this->y);
       sort($this->x);
       sort($this->y);
       foreach ($this->sides as $i => $s) {
           if ($s[0] - $s[2]) {     // Horizontal
               foreach ($this->x as $xx) {
                   if (($xx > $s[0]) && ($xx < $s[2])) {
                       $result[] = array($s[0], $s[1], $xx, $s[3]);
                       $s[0] = $xx;
                   }
               }
           } else {                 // Vertical
               foreach ($this->y as $yy) {
                   if (($yy > $s[1]) && ($yy < $s[3])) {
                       $result[] = array($s[0], $s[1], $s[2], $yy);
                       $s[1] = $yy;
                   }
               }
           }
           $result[] = $s;
       }
       return($result);
    }

    function removeDuplicates($sides) {
        $x = array();
        foreach ($sides as $i => $s) {
            @$x[$s[0].','.$s[1].','.$s[2].','.$s[3]]++;
        }
        foreach ($x as $s => $n) {
            if ($n > 1) {
              unset($x[$s]);
            } else {
              $this->points[] = explode(",", $s);
            }
        }
        return($x);
    }

    function drawPoints($points, $outfile = null) {
        $xs = $this->x[count($this->x) - 1] + $this->x[0];
        $ys = $this->y[count($this->y) - 1] + $this->y[0];
        $img = imagecreate($xs, $ys);
        if ($img !== FALSE) {
            $wht = imagecolorallocate($img, 255, 255, 255);
            $blk = imagecolorallocate($img, 0, 0, 0);
            $red = imagecolorallocate($img, 255, 0, 0);
            imagerectangle($img, 0, 0, $xs - 1, $ys - 1, $red);
            $oldp = $points[0];
            for ($i = 1; $i < count($points); $i++) {
                $p = $points[$i];
                imageline($img, $oldp['x'], $oldp['y'], $p['x'], $p['y'], $blk);
                $oldp = $p;
            }
            imageline($img, $oldp['x'], $oldp['y'], $points[0]['x'], $points[0]['y'], $blk);
            if ($outfile == null) header("content-type: image/png");
            imagepng($img, $outfile);
            imagedestroy($img);
        }
    }

    function drawSides($sides, $outfile = null) {
        $xs = $this->x[count($this->x) - 1] + $this->x[0];
        $ys = $this->y[count($this->y) - 1] + $this->y[0];
        $img = imagecreate($xs, $ys);
        if ($img !== FALSE) {
            $wht = imagecolorallocate($img, 255, 255, 255);
            $blk = imagecolorallocate($img, 0, 0, 0);
            $red = imagecolorallocate($img, 255, 0, 0);
            imagerectangle($img, 0, 0, $xs - 1, $ys - 1, $red);
            foreach ($sides as $s => $n) {
                if (is_array($n)) {
                    $r = $n;
                } else {
                    $r = explode(",", $s);
                }
                imageline($img, $r['x1'], $r['y1'], $r['x2'], $r['y2'], $blk);
            }
            if ($outfile == null) header("content-type: image/png");
            imagepng($img, $outfile);
            imagedestroy($img);
        }
    }

    function getSides($sides = FALSE) {
        if ($sides === FALSE) {
            foreach ($this->sides as $r) {
                $result[] = array('x1' => $r[0], 'y1' => $r[1], 'x2' => $r[2], 'y2' => $r[3]);
            }
        } else {
            $result = array();
            foreach ($sides as $s => $n) {
                $r = explode(",", $s);
                $result[] = array('x1' => $r[0], 'y1' => $r[1], 'x2' => $r[2], 'y2' => $r[3]);
            }
        }
        return($result);
    }

    private function _nextPoint(&$points, $lastpt) {
        @extract($lastpt);
        foreach ($points as $i => $p) {
            if (($p[0] == $x) && ($p[1] == $y)) {
                unset($points[$i]);
                return(array('x' => $p[2], 'y' => $p[3]));
            } else if (($p[2] == $x) && ($p[3] == $y)) {
                unset($points[$i]);
                return(array('x' => $p[0], 'y' => $p[1]));
            }
        }
        return false;
    }

    function getPoints($points = FALSE) {
        if ($points === FALSE) $points = $this->points;
        $result = array(
            array('x' => $points[0][0], 'y' => $points[0][1])
        );
        $lastpt = array('x' => $points[0][2], 'y' => $points[0][3]);
        unset($points[0]);
        do {
            $result[] = $lastpt;
        } while ($lastpt = $this->_nextPoint($points, $lastpt));
        return($result);
    }
}

?> 
```

### 合并.php

```
<?php

require_once("RectUnion.php");

function generateRect($prev, $step) {
    $rect = array(
        'x1' => $prev['x2'],
        'x2' => $prev['x2'] + rand($step, $step * 10),
        'y1' => rand($prev['y1'] + 2, $prev['y2'] - 2),
        'y2' => rand($step * 2, $step * 10)
    );
    return($rect);
}

$x0 = 50;       // Pixels
$y0 = 50;       // Pixels
$step = 20;     // Pixels
$nrect = 10;    // Number of rectangles
$rects = array(
    array("x1" => 50, "y1" => 50, "x2" => 100, "y2" => 100)
);
for ($i = 1; $i < $nrect - 1; $i++) {
    $rects[$i] = generateRect($rects[$i - 1], $step);
}

$start_tm = microtime(true);

$ru = new RectUnion();
foreach ($rects as $r) {
    $ru->addRect($r);
}
$union = $ru->removeDuplicates($ru->splitSides());

$stop_tm = microtime(true);

$ru->drawSides($ru->getSides(), "before.png");

if (FALSE) {    // Lines
    $sides = $ru->getSides($union);
    $ru->drawSides($sides, "after.png");
} else {        // Points
    $points = $ru->getPoints();
    $ru->drawPoints($points, "after.png");
}

?>
<!DOCTYPE html>
<html>
    <body>
        <fieldset>
            <legend>Before Union</legend>
            <img src='before.png'>
        </fieldset>
        <fieldset>
            <legend>After Union</legend>
            <img src='after.png'>
        </fieldset>
        <h4>Elapsed Time: <?= round($stop_tm - $start_tm, 4) ?> seconds</h4>
        <?php if (isset($sides)): ?>
        <h4>Sides:</h4>
        <pre><?= print_r($sides, true) ?></pre>
        <?php elseif (isset($points)): ?>
        <h4>Points:</h4>
        <pre><?= print_r($points, true) ?></pre>
        <?php endif ?>
    </body>
</html> 
```

**它是如何工作的？**

该脚本识别并删除所有“重叠”段。例如：
![例子](../Images/99cd452ea9315df16841116784ef4d1f.png)

首先，每个矩形的边在与相邻矩形的边的交点处被分割。
例如，考虑 B 矩形的 B2-B3 边：“splitSides”方法将其拆分为 B2-D1、D1-D4 和 D4-B3 段。
然后“removeDuplicates”方法删除所有重叠（重复）段。
例如，D1-D4 段是重复的，因为它出现在 B 矩形和 D 矩形中。
最后，“getSides”方法返回剩余线段的列表，而“getPoints”方法返回多边形点的列表。
“draw”方法仅用于结果的图形表示，需要[GD 扩展](http://php.net/manual/en/book.image.php)才能工作：
![结果](../Images/e5df66dcecf2afdfa8324c2f7fdefa0d.png)

**关于性能**

以下是一些执行时间：

*   10 个矩形：0,003 秒
*   100 个矩形：0,220 秒
*   1000 个矩形：4,407 秒
*   2000 个矩形：13,448 秒

[通过使用XDebug](http://xdebug.org/)分析执行，我得到了以下结果：

![缓存研磨](../Images/afe0d00c008e3b659aa6cc3f02ed0bc5.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-02-18T03:25:32.833

如果有其他人这样做，我还根据 JavaScript 中 mmgp 的答案实现了这个算法。如果其他人试图在 JS 中执行此操作，那么您最好使用我的，而不是自己从其他示例中找出移植的小问题。

我在这里将它作为一个更大项目的一部分开源 - [https://github.com/Crabcyborg/crabcyborg/blob/e282aff3a033fba76bba1a7c924f04e6df7b3dc4/shapeup/svg-helper.js#L199](https://github.com/Crabcyborg/crabcyborg/blob/e282aff3a033fba76bba1a7c924f04e6df7b3dc4/shapeup/svg-helper.js#L199)

因为它是 JavaScript，我可以现场演示。它用于[https://crabcyb.org/experiment/shapeup-svg/上的“每种颜色的多边形”示例](https://crabcyb.org/experiment/shapeup-svg/)

```
const pointsToPolygons = (points, size) => {
    let edges_v = {}, edges_h = {};
    const setEdges = (edges, cmp, e) => {
        points.sort(cmp);
        let edge_index = 0;
        const length = points.length;
        while(edge_index < length) {
            const curr = points[edge_index][e];
            do {
                edges[points[edge_index]] = points[edge_index+1];
                edges[points[edge_index+1]] = points[edge_index];
                edge_index += 2
            } while(edge_index < length && points[edge_index][e] == curr);
        }
    };
    setEdges(edges_v, xThenY, 0);
    setEdges(edges_h, yThenX, 1);

    let polygon = [], keys;
    while((keys = Object.keys(edges_h)).length) {
        const [ key ] = keys;
        delete edges_h[key];

        const first_vertex = new V2(key);
        let previous = [first_vertex.toArray(), 0];
        let vertices = [first_vertex];

        while(1) {
            const [edge_index, edge] = previous;
            const edges = [edges_v, edges_h][edge];
            const next_vertex = new V2(edges[edge_index]);
            const next = [next_vertex.toArray(), 1-edge];
            delete edges[edge_index];

            if(first_vertex.compare(next_vertex)) {
                break;
            }

            vertices.push(next_vertex);
            previous = next;
        }

        let scaled_vertices = [];
        for(let vertex of vertices) {
            scaled_vertices.push(vertex.scale(size).toArray());

            const edge_index = vertex.toArray();
            delete edges_v[edge_index];
            delete edges_h[edge_index];
        }

        polygon.push(scaled_vertices);
    }

    return polygon;
};

function V2(x,y) {
    if(Array.isArray(x)) {
        y = x[1];
        x = x[0];
    } else {
        switch(typeof x) {
            case 'object': 
                y = x.y;
                x = x.x;
            break;

            case 'string':
                const split = x.split(',');
                x = parseInt(split[0]);
                y = parseInt(split[1]);
            break;
        }
    }

    this.x = x;
    this.y = y;
}

V2.prototype = {
    scale: function(scale) {
        return new V2(this.x * scale, this.y * scale);
    },
    compare: function(v) {
        return this.x == v.x && this.y == v.y;
    },
    toArray: function() {
        return [this.x, this.y];
    }
};

const xThenY = (a,b) => a[0]<b[0] || (a[0]==b[0] && a[1]<b[1]) ? -1 : 1;
const yThenX = (a,b) => a[1]<b[1] || (a[1]==b[1] && a[0]<b[0]) ? -1 : 1; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-10T19:24:45.740

我不会用数学来解决这个问题，而只会分析。

考虑下图：

![在此处输入图像描述](../Images/81ffaf6eef9885d2e427dbac5a986649.png)

在这里，我们一次有 2 个示例，以确保我们将涵盖所有案例。

*   在第一张图片中，我们有一个特殊情况：第 3、4、5、11、12、13 号矩形创建了一个空白区域，在您的情况下这可能是一个烟雾空间。

*   在第二张图片中，我们在 16、17、18、19 号矩形之间有一个角......这将在稍后具有它的重要性。

我如何解决问题使用以下内容：

*   一个角点是一个被写入 2 到 8 次的点：至少 2 次，因为如果我们想象一个矩形 ABCD，角 B 将与 AB 和 BC 共享（因此像素已被放置 2 次）。在矩形 16、17、18、19 的情况下，可以写 8 次，其中一个点与 4 个矩形共享，因此有 8 个边。

*   边是一组可以写 1 或 2 次（不考虑角）的点：如果边单独，不靠近另一边，则写 1 次，如果靠近另一边，则写 2 次。不靠近另一边的一侧靠近外侧：它应该成为最终多边形的一部分。

所以这是逻辑：

*   我们创建一个与整个图像大小相同的虚拟空间，填充零（0）。
*   我们写所有的矩形，但不是写像素，而是增加虚拟像素的值

    ```
     21111111112                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                    2111111111622222222261111111112         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
                    1         2         2         1         
          21111111116222222222611111111141111111112         
          1         2         1                             
          1         2         1                             
          1         2         1                             
          1         2         1                             
          1         2         1                             
          1         2         1                             
          1         2         1                             
          1         2         1                             
          1         2         1                             
          (...) 
    ```

（抱歉，我的缩进似乎与 SO 的格式化工具有问题）

*   我们删除所有值大于 2 的虚拟点，除了我们设置为 1 的角点

在这一点上，我们只有多边形和点（在其他几个矩形的中间有一个角）。

```
 11111111111                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                              1         1                   
                    11111111111         11111111111         
                    1                             1         
                    1                             1         
                    1                             1         
                    1                             1         
                    1                             1         
                    1                             1         
                    1                             1         
                    1                             1         
                    1                             1         
          11111111111         111111111111111111111         
          1                   1                             
          1                   1                             
          1                   1                             
          1                   1                             
          1                   1                             
          1                   1                             
          1                   1                             
          1                   1                             
          1                   1                             
11111111111         1         11111111111                   
1                                       1                   
1                                       1                   
1                                       1                   
1                                       1                   
1                                       1                   
1                                       1                   
1                                       1                   
1                                       1                   
1                                       1                   
11111111111111111111111111111111111111111 
```

*   现在我们需要寻找一个或多个多边形（在 11 12 13 14 3 4 5 矩形的情况下，我们可能有多个多边形）。这意味着，在我们的虚拟图像中搜索一个点。

*   如果该点是单独的（见上文），它的顶部、左侧、底部或右侧都没有点，这是其他几个矩形中间的一个角（我们之前保存了我们的角）。这很棘手，但如果所有矩形都大于 4 像素，则可以使用。

*   当我们找到一个点时，我们存储它，尝试迭代一个方向（上/左/右/下）并继续删除指向该方向的点，直到没有更多点：这是多边形的一个角。我们继续这种方式，直到无法移动到任何方向：这意味着我们在多边形的末端。

*   现在，您得到一个二维数组：第一个维度是多边形列表（在第一个示例中），第二个维度是描述多边形的点列表。对于每个多边形，您只需迭代这些点并将当前点连接到下一个点即可获得多边形。

现在结果如何？

![在此处输入图像描述](../Images/3c6b7bdc194a4be500b3349dcf14e423.png)

执行 ：

```
class PolygonMaker
{

    private $image;
    private $width;
    private $height;
    private $vImage;

    public function __construct($width, $height)
    {
        // create a GD image to display results and debug
        $this->width = $width;
        $this->height = $height;
        $this->image = imagecreatetruecolor($width, $height);
        $white = imagecolorallocate($this->image, 0xFF, 0xFF, 0xFF);
        imagefill($this->image, 0, 0, $white);
        imagesetthickness($this->image, 3);
    }

    public function __destruct()
    {
        imagedestroy($this->image);
    }

    public function display()
    {
        // Display gd image as png
        header("Content-type: image/png");
        imagepng($this->image);
    }

    public function drawRectangles(array $rectangles, $r, $g, $b)
    {
        // Draw rectangles as they are inside the gd image
        foreach ($rectangles as $rectangle)
        {
            list($tx, $ty) = $rectangle[0];
            list($bx, $by) = $rectangle[1];
            $color = imagecolorallocate($this->image, $r, $g, $b);
            imagerectangle($this->image, $tx, $ty, $bx, $by, $color);
        }
    }

    public function findPolygonsPoints(array $rectangles)
    {
        // Create a virtual image where rectangles will be "drawn"
        $this->_createVirtualImage($rectangles);

        $polygons = array ();

        // Searches for all polygons inside the virtual image
        while (!is_null($beginPoint = $this->_findPolygon()))
        {
            $polygon = array ();

            // Push the first point
            $polygon[] = $this->_cleanAndReturnPolygonPoint($beginPoint);
            $point = $beginPoint;

            // Try to go up, down, left, right until there is no more point
            while ($point = $this->_getNextPolygonPoint($point))
            {
                // Push the found point
                $polygon[] = $this->_cleanAndReturnPolygonPoint($point);
            }

            // Push the first point at the end to close polygon
            $polygon[] = $beginPoint;

            // Add the polygon to the list, in case of several polygons in the image
            $polygons[] = $polygon;
        }

        $this->vImage = null;
        return $polygons;
    }

    private function _createVirtualImage(array $rectangles)
    {
        // Create a 0-filled grid where will be stored rectangles
        $this->vImage = array_fill(0, $this->height, array_fill(0, $this->width, 0));

        // Draw each rectangle to that grid (each pixel increments the corresponding value of the grid of 1)
        foreach ($rectangles as $rectangle)
        {
            list($x1, $y1, $x2, $y2) = array ($rectangle[0][0], $rectangle[0][1], $rectangle[1][0], $rectangle[1][1]);
            $this->_drawVirtualLine($x1, $y1, $x1, $y2); // top-left, bottom-left
            $this->_drawVirtualLine($x2, $y1, $x2, $y2); // top-right, bottom-right
            $this->_drawVirtualLine($x1, $y1, $x2, $y1); // top-left, top-right
            $this->_drawVirtualLine($x1, $y2, $x2, $y2); // bottom-left, bottom-right
        }

        // Remove all pixels that are scored > 1 (that's our logic!)
        for ($y = 0; ($y < $this->height); $y++)
        {
            for ($x = 0; ($x < $this->width); $x++)
            {
                $value = &$this->vImage[$y][$x];
                $value = $value > 1 ? 0 : $value;
            }
        }
    }

    private function _drawVirtualLine($x1, $y1, $x2, $y2)
    {
        // Draw a vertial line in the virtual image
        if ($x1 == $x2)
        {
            if ($y1 > $y2)
            {
                list($x1, $y1, $x2, $y2) = array ($x2, $y2, $x1, $y1);
            }
            for ($y = $y1; ($y <= $y2); $y++)
            {
                $this->vImage[$y][$x1]++;
            }
        }

        // Draw an horizontal line in the virtual image
        if ($y1 == $y2)
        {
            if ($x1 > $x2)
            {
                list($x1, $y1, $x2, $y2) = array ($x2, $y2, $x1, $y1);
            }
            for ($x = $x1; ($x <= $x2); $x++)
            {
                $this->vImage[$y1][$x]++;
            }
        }

        // Force corners to be 1 (because one corner is at least used 2 times but we don't want to remove them)
        $this->vImage[$y1][$x1] = 1;
        $this->vImage[$y1][$x2] = 1;
        $this->vImage[$y2][$x1] = 1;
        $this->vImage[$y2][$x2] = 1;
    }

    private function _findPolygon()
    {
        // We're looking for the first point in the virtual image
        foreach ($this->vImage as $y => $row)
        {
            foreach ($row as $x => $value)
            {
                if ($value == 1)
                {
                    // Removes alone points ( every corner have been set to 1, but some corners are alone (eg: middle  of 4 rectangles)
                    if ((!$this->_hasPixelAtBottom($x, $y)) && (!$this->_hasPixelAtTop($x, $y))
                       && (!$this->_hasPixelAtRight($x, $y)) && (!$this->_hasPixelAtLeft($x, $y)))
                    {
                        $this->vImage[$y][$x] = 0;
                        continue;
                    }
                    return array ($x, $y);
                }
            }
        }
        return null;
    }

    private function _hasPixelAtBottom($x, $y)
    {
        // The closest bottom point is a point positionned at (x, y + 1)
        return $this->_hasPixelAt($x, $y + 1);
    }

    private function _hasPixelAtTop($x, $y)
    {
        // The closest top point is a point positionned at (x, y - 1)
        return $this->_hasPixelAt($x, $y - 1);
    }

    private function _hasPixelAtLeft($x, $y)
    {
        // The closest left point is a point positionned at (x - 1, y)
        return $this->_hasPixelAt($x - 1, $y);
    }

    private function _hasPixelAtRight($x, $y)
    {
        // The closest right point is a point positionned at (x + 1, y)
        return $this->_hasPixelAt($x + 1, $y);
    }

    private function _hasPixelAt($x, $y)
    {
        // Check if the pixel (x, y) exists
        return ((isset($this->vImage[$y])) && (isset($this->vImage[$y][$x])) && ($this->vImage[$y][$x] > 0));
    }

    private function _cleanAndReturnPolygonPoint(array $point)
    {
        // Remove a point from the virtual image
        list($x, $y) = $point;
        $this->vImage[$y][$x] = 0;
        return $point;
    }

    private function _getNextPolygonPoint(array $point)
    {
        list($x, $y) = $point;

        // Initialize modifiers, to move to the right, bottom, left or top.
        $directions = array(
                array(1, 0), // right
                array(0, 1), // bottom
                array(-1, 0), // left
                array(0, -1), // top
        );

        // Try to get to one direction, if we can go ahead, there is a following corner
        $return = null;
        foreach ($directions as $direction)
        {
            list($xModifier, $yModifier) = $direction;
            if (($return = $this->_iterateDirection($x, $y, $xModifier, $yModifier)) !== null)
            {
                return $return;
            }
        }

        // the point is alone : we are at the end of the polygon
        return $return;
    }

    private function _iterateDirection($x, $y, $xModifier, $yModifier)
    {
        // This method follows points in a direction until the last point
        $return = null;
        while ($this->_hasPixelAt($x + $xModifier, $y + $yModifier))
        {
            $x = $x + $xModifier;
            $y = $y + $yModifier;

            // Important : we remove the point so we'll not get back when moving
            $return = $this->_cleanAndReturnPolygonPoint(array ($x, $y));
        }

        // The last point is a corner of the polygon because if it has no following point, we change direction
        return $return;
    }

    /**
     * This method draws a polygon with the given points. That's to check if
     * our calculations are valid.
     *
     * @param array $points An array of points that define the polygon
     */
    public function drawPolygon(array $points, $r, $g, $b)
    {
        $count = count($points);
        for ($i = 0; ($i < $count); $i++)
        {
            // Draws a line between the current and the next point until the last point is reached
            if (array_key_exists($i + 1, $points))
            {
                list($x1, $y1) = $points[$i];
                list($x2, $y2) = $points[$i + 1];
                $black = imagecolorallocate($this->image, $r, $g, $b);
                imageline($this->image, $x1, $y1, $x2, $y2, $black);
            }
        }
    }

} 
```

用法示例：

```
$rectanglesA = array (
        array ( // 1
                array (50, 50), // tx, ty
                array (75, 75), // bx, by
        ),
        array ( // 2
                array (75, 50), // tx, ty
                array (125, 75), // bx, by
        ),
        array ( // 3
                array (125, 50), // tx, ty
                array (175, 75), // bx, by
        ),
        array ( // 4
                array (175, 50), // tx, ty
                array (225, 75), // bx, by
        ),
        array ( // 5
                array (225, 50), // tx, ty
                array (275, 75), // bx, by
        ),
        array ( // 6
                array (275, 50), // tx, ty
                array (325, 75), // bx, by
        ),
        array ( // 7
                array (325, 50), // tx, ty
                array (375, 75), // bx, by
        ),
        array ( // 8
                array (375, 50), // tx, ty
                array (425, 75), // bx, by
        ),
        array ( // 9
                array (320, 42), // tx, ty
                array (330, 50), // bx, by
        ),
        array ( // 10
                array (425, 60), // tx, ty
                array (430, 65), // bx, by
        ),
        array ( // 11
                array (100, 75), // tx, ty
                array (150, 250), // bx, by
        ),
        array ( // 12
                array (150, 125), // tx, ty
                array (250, 150), // bx, by
        ),
        array ( // 13
                array (225, 75), // tx, ty
                array (250, 125), // bx, by
        ),
        array ( // 14
                array (150, 92), // tx, ty
                array (180, 107), // bx, by
        ),
);

$rectanglesB = array (
        array ( // 15
                array (200, 300), // tx, ty
                array (250, 350), // bx, by
        ),
        array ( // 16
                array (250, 250), // tx, ty
                array (300, 300), // bx, by
        ),
        array ( // 17
                array (250, 300), // tx, ty
                array (300, 350), // bx, by
        ),
        array ( // 18
                array (300, 250), // tx, ty
                array (350, 300), // bx, by
        ),
        array ( // 19
                array (300, 300), // tx, ty
                array (350, 350), // bx, by
        ),
        array ( // 20
                array (300, 200), // tx, ty
                array (350, 250), // bx, by
        ),
        array ( // 21
                array (350, 300), // tx, ty
                array (400, 350), // bx, by
        ),
        array ( // 22
                array (350, 200), // tx, ty
                array (400, 250), // bx, by
        ),
        array ( // 23
                array (350, 150), // tx, ty
                array (400, 200), // bx, by
        ),
        array ( // 24
                array (400, 200), // tx, ty
                array (450, 250), // bx, by
        ),
);

$polygonMaker = new PolygonMaker(500, 400);

// Just to get started and see what's happens
//$polygonMaker->drawRectangles($rectanglesA, 0xFF, 0x00, 0x00);
//$polygonMaker->drawRectangles($rectanglesB, 0xFF, 0x00, 0x00);

$polygonsA = $polygonMaker->findPolygonsPoints($rectanglesA);
foreach ($polygonsA as $polygon)
{
    $polygonMaker->drawPolygon($polygon, 0x00, 0x00, 0x00);
}

$polygonsB = $polygonMaker->findPolygonsPoints($rectanglesB);
foreach ($polygonsB as $polygon)
{
    $polygonMaker->drawPolygon($polygon, 0x00, 0x00, 0x00);
}

// Display image to see if everything is correct
$polygonMaker->display(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-08T09:34:28.017

只是一些想法：

1.  遍历所有角落以找到仅与一个单元发生事件的一个，因此是您工会的一个角落。
2.  从那里选择一个方向进行迭代，例如总是逆时针。
3.  检查该方向的边是否与另一个单元的角相交，或者沿着该边的下一个角是否与另一个单元的边相交。这些中的任何一个都将形成联盟的下一个角落。否则这条边的端点就是下一个角。
4.  以这种方式继续，从一个单元移动到下一个单元，直到到达起点。

# sql-server - 我需要截断和替换经常查询的表中的数据

> ID：13746285
> 
> 赞同：0
> 
> 时间：2012-12-06T14:57:25.913
> 
> 标签：sql-server, jobs

# 主要问题：

我想截断并刷新 SQL Server 中的表，但想等到当前访问该表的任何查询完成。这是 SQL Server 中的一个简单设置，还是我需要创建一些逻辑来完成它？

## 详细说明：

我有一个位于大约 300 个终端上的 VB 应用程序。应用程序每 2 分钟调用一次 SqlServer(2008 R2) 存储过程 ([spGetScreenData]) 以获取最新的销售数据。
[spGetScreenData] 创建一系列临时表并返回大约 200 行和 100 列的选择查询。执行大约需要 8 秒。

我的目标是创建一个每两分钟执行一次的新存储过程 ([spRefreshScreenData])，它将刷新表 ([SCREEN_DATA]) 中的数据。然后我将更改 [spGetScreenData] 以简单地查询 [SCREEN_DATA]。

刷新 [SCREEN_DATA] 的作业在执行时首先将状态表中的标志设置为“RUNNING”。一旦完成，它就会将该状态设置为“已完成”。

[spGetScreenData] 在查询之前检查标志的状态并等待（一段时间）直到它准备好。就像是...

```
DECLARE @Condition AS BIT=0
,       @Count AS INT=0
,       @CycleCount AS INT=10 --10 cycles (20 Seconds)

WHILE @Condition = 0 AND @Count < @CycleCount
BEGIN
    SET @Count = @Count + 1

    IF EXISTS(  SELECT  Status 
                FROM    tbl_Process_Status
                WHERE   Process = 'POS_Table_Refresh' 
                AND     Status='Running')
            WAITFOR DELAY '000:00:02' --Wait 2 seconds
        ELSE
            SET @Condition=1
END

SELECT *
FROM SCREEN_DATA
WHERE (Store=@Store OR @Store IS NULL) 
```

我的担忧与 [spRefreshScreenData] 有关。当 [spRefeshScreenData] 开始截断时，可能有几十个对当前正在运行的数据的请求。

SqlServer 会在截断之前简单地等到请求完成吗？有没有我必须设置的设置才能不弄乱这些查询？

还是我必须建立一些机制来等到所有请求都完成后再开始截断？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:05:07.870

> 刷新 [SCREEN_DATA] 的作业在执行时首先将状态表中的标志设置为“RUNNING”。一旦完成，它就会将该状态设置为“已完成”。
> 
> [spGetScreenData] 在查询之前检查标志的状态并等待（一段时间）直到它准备好

不。使用应用程序锁。读者（`spGetScreenData`）是共享模式下的应用程序锁，作者（刷新作业）请求它 X 模式。见[`sp_getapplock`](http://msdn.microsoft.com/en-us/library/ms189823.aspx)。

但即使这样也没有必要。您可以在线构建新数据，同时查询继续，使用*暂存*表（与应用程序查询的表不同的表）不会影响它们。重建完成后，只需使用快速 SWITCH 操作（参见[使用分区切换有效地传输数据](http://msdn.microsoft.com/en-us/library/ms191160(v=sql.105).aspx)）或使用良好的 'ole[`sp_rename`](http://msdn.microsoft.com/en-us/library/ms188351.aspx)技巧，将原始表与暂存表交换。

# cordova - onDeviceReady 在托管页面上

> ID：13746292
> 
> 赞同：1
> 
> 时间：2012-12-06T14:57:48.970
> 
> 标签：cordova

我对 iOS 的 PhoneGap/Cordova 上的 onDeviceReady 事件有一些疑问。

我在具有多个页面的应用程序中使用它，它适用于我的 index.html 和指向同一 JS 文件的其他页面链接。但是我的应用程序中链接了另一个页面。此页面及其脚本托管在我的服务器上，其中 onDeviceReady 没有成功，我无法在这部分添加功能。

我想知道我是否需要在每个页面上添加此事件，以及它是否在托管页面上运行，或者可能由于其他原因不起作用。

在我的托管页面上，我使用以下代码：

JS

```
$(document).ready(function(){

document.addEventListener("deviceready",onDeviceReady,false); // Cordova is ready to be used!

function onDeviceReady() {
       DO SOMETHING !
}
}); 
```

HTML

```
<script type="text/javascript" src="/js/cordova-2.1.0.js"></script>
<script type="text/javascript" src="/js/libs/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="/js/libs/jquery-ui.js"></script>
<script defer src="/js/script.js"></script> 
```

我使用 Cordova 2.1 并在 iPad 模拟器上进行测试 我已经在 externalHosts 中添加了我的外部站点

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:17:49.040

如果您在 onDeviceReady() 之后（或之内）调用外部页面，您只需确保您拥有本地 PhoneGap/Cordova 参考（在远程位置），并且您可以使用 PhoneGap 功能。

例如：

```
function onDeviceReady()
{

    window.location.href = "http://<myRemoteServer>/myRemoteDefault.htm";
} 
```

myRemoteDefault.htm 将有

```
<script type="text/javascript" src="./cordova-2.1.0.js"></script>

<script>
        alert(device.platform);
</script> 
```

# directx - 为 Directx 11.1 转换 Directx 9 着色器（Windows 应用商店应用程序）

> ID：13746293
> 
> 赞同：2
> 
> 时间：2012-12-06T14:57:51.970
> 
> 标签：directx, windows-store-apps, hlsl, directx-11, directx-9

我正在尝试学习使用 hlsl 为 DirectX Windows Store App 编写 DirectX 着色器。

Visual Studio 2012 有一个很好的工具来帮助设计着色器，但由于我是着色器的新手，我无法解释导出的 hlsl 源代码并可能对其进行更改以微调着色器。

我实际上想要的是能够重用为 DirectX 9 编写的一些着色器（主要用于 XNA）。此外，net 有非常有用的教程来教授 DirectX 9 的着色器。我正在比较 DirectX 9 和 11 的着色器，但看不到如何将现有的 DirectX 9 着色器转换为我可能在 DirectX 11 中使用的着色器。

我想我缺少一些基本概念来深入了解这方面的细节。请让我知道两个平台中着色器之间的区别。

对文档或好的教程的引用将不胜感激。

我看到的最大区别是 DirectX 11 着色器具有如下所示的主要功能，尽管旧着色器没有。

```
P2F main(V2P pixel) 
```

相反，他们有如下内容：

```
technique10 FireTechnique
{
    pass pass0
    {
        SetBlendState(AlphaBlendingOn, float4(0.0f, 0.0f, 0.0f, 0.0f), 0xFFFFFFFF);
        SetVertexShader(CompileShader(vs_4_0, FireVertexShader()));
        SetPixelShader(CompileShader(ps_4_0, FirePixelShader()));
        SetGeometryShader(NULL);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T22:48:26.850

试试[http://msdn.microsoft.com/en-us/library/windows/desktop/ff476190(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476190(v=vs.85).aspx)

但实际上，也许您应该首先了解 DX9 着色器（FXComposer？我不确定您是如何采购这些 DX9 着色器的）——感觉有点像您想从一种您不知道的语言翻译进入另一个你不知道不学习第一个。

# java - Java Line 绘制在某些点消失了

> ID：13746298
> 
> 赞同：1
> 
> 时间：2012-12-06T14:58:08.383
> 
> 标签：java, image, line, draw, japplet

我正在开发一个小程序，用户可以在其中放置一些标记并使用鼠标在图像上画线。

我放置线条和标记的空间是 JPanel。我将标记创建为 JComponents，线条是简单的 Line2D。

标记是透明的正方形，圆圈中填满了颜色。

我在 JPanel 上放了一些鼠标监听器来缩放和拖动图像。标记上也有鼠标监听器，对于路径，我将新的鼠标监听器添加到 JPanel。当我必须画一条线时，我删除了标记的听众。

我在创建标记方面没有问题。行只能从标记或另一行开始。当我尝试画一条线时，我单击一个标记并拖动鼠标。我可以在标记的透明部分看到线条，如果我经过另一个标记附近，我可以看到线条也出现在这些标记中……但在两个标记之间的空间中什么也没有。

我不知道是哪个问题，我重写了JPanel的**paintComponent**方法，我使用了它的Graphics2D。

如果您需要什么，请自由询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T08:11:24.237

好的，多亏了一次偶然的测试，我找到了解决方案。

在 JPanel 的**paintComponent**中，绘制线条后，我缺少这两个命令：

```
this.revalidate();
this.repaint(); 
```

现在一切正常。

# fluent-nhibernate - 在 Castle Windsor IOC 容器中访问当前 NHibernate 会话

> ID：13746301
> 
> 赞同：1
> 
> 时间：2012-12-06T14:58:28.163
> 
> 标签：fluent-nhibernate, inversion-of-control, castle-windsor, quartz.net, sharp-architecture

我正在尝试使用 IOC 从正在运行的 Quartz.net 作业中访问我当前的休眠会话，并且每次它返回为 null 时都说明以下内容：

> “NHibernateSession.Current”引发了“SharpArch.Domain.PreconditionException”NHibernate.ISession SharpArch.Domain.PreconditionException} 类型的异常。尚未配置 ISessionStorage

这是我当前的代码设置。我一生都无法弄清楚如何设置我的 IOC，以便正确设置我的 IScheduledMessageQueries 查询中的 NHibernate ISession。Quartz 触发器工作正常，我只是无法访问 ISession 以从 Job 中调用我的查询。任何帮助和/或建议？

Global.cs 代码：

```
protected virtual void InitializeServiceLocator()
{
    _container = new WindsorContainer(new XmlInterpreter()).Install(new WebWindsorInstaller());
    StartQuartzScheduler();            
    ComponentRegistrar.AddComponentsTo(_container);
    ServiceLocator.SetLocatorProvider(() => new WindsorServiceLocator(_container));

    DependencyResolver.SetResolver(new WindsorDependencyResolver(_container));
    var activator = new WebApiControllerFactory(_container);
    GlobalConfiguration.Configuration.Services.Replace(typeof(IHttpControllerActivator), activator);
}

private static void StartQuartzScheduler()
{
    ISchedulerFactory schedulerFactory = new StdSchedulerFactory();
    IJobFactory jobFactory = new WindsorJobFactory(_container);
    var scheduler = schedulerFactory.GetScheduler();
    scheduler.JobFactory = jobFactory;
    scheduler.Start();
    var sendScheduledMessageJob = new JobDetailImpl("sendScheduledMessageJob", typeof(SendScheduledMessageJob));
    var trigger = new CalendarIntervalTriggerImpl
    {
        StartTimeUtc = DateTime.UtcNow.Subtract(new TimeSpan(1)),
        Name = "Daily Trigger",
        RepeatIntervalUnit = IntervalUnit.Second,
        RepeatInterval = 1
    };
    scheduler.ScheduleJob(sendScheduledMessageJob, trigger);
}

public class SendScheduledMessageJob : IJob
{
    private readonly IScheduledMessageQueries _scheduledMessageQueries;
    public SendScheduledMessageJob(IScheduledMessageQueries scheduledMessageQueries)
    {
        _scheduledMessageQueries = scheduledMessageQueries;
    }

    public void Execute(IJobExecutionContext context)
    {

        var unsentScheduledMessages =
            _scheduledMessageQueries.GetAllUnsentScheduledMessages(DateTime.Now);
    }
} 
```

# objective-c - 减少 UITableViewController 中提供的数据集的正确方法

> ID：13746303
> 
> 赞同：0
> 
> 时间：2012-12-06T14:58:29.667
> 
> 标签：objective-c, ios, cocoa-touch

我提供了对包含数据项的 NSArray 的引用。在充当表格视图数据源的自定义视图控制器中，我解释每个项目并将其呈现为一个单元格。到目前为止，一切都很好。

现在我的同事要求实现一个过滤器，该过滤器将基于项目属性之一的值。此属性具有枚举值（其中 4 个）。所以当我应用过滤器时，我应该只看到与特定值匹配的项目。我的问题是我应该如何处理这些数据的过滤。

1）我是否应该将_data私有变量设置为指向原始数据源，然后覆盖“数据”属性getter以考虑过滤？

2) 我应该在我的控制器内生成一个单独的过滤数据数组吗？3）其他一些方法？

注意> coredata+fetched resultscontr。是不可能的。项目的数量永远不会超过 150-200。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:24:47.493

在我工作的应用程序中，我们有一个包含所有项目的数组和一个副本，它是数据源引用的那个。应用过滤器时，它会替换副本，但基于原始数组。所以我猜#2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:26:14.540

我会选择第二个选择。拥有filteredDatasource 更方便。这样，您不仅可以知道应该显示的单元格，还可以知道它们有多少等。此外，如果将来您想对它们进行排序并使用部分，您将更加灵活。

例如，当您`– tableView:numberOfRowsInSection:`使用过滤后的数据源实现在内部多次调用的方法时，您不必多次遍历数组的对象以查看其中哪些应该通过过滤器。你只要回来`[filteredDatasource count]`。这样更有效率。

# mysql - 每周多列计数

> ID：13746304
> 
> 赞同：1
> 
> 时间：2012-12-06T14:58:31.080
> 
> 标签：mysql, sql

我有以下两个表：

帖子

*   post_id
*   帖子标题
*   post_timestamp

评论

*   comment_id
*   post_post_id
*   评论内容
*   评论时间戳

我想创建一个显示每周发帖数和评论数的报告。像这样的东西：

```
Week    StartDate      Posts     Comments
1       1/1/2012       100        305
2       1/8/2012       115        412 
```

我有这个查询，但它只从 Posts 表中提取。

```
select makedate( left(yearweek(p.post_timestamp),1),week(p.post_timestamp, 2 ) * 7 ) as Week, COUNT(p.post_id) as Posts  
FROM cl_posts p
GROUP BY Week
ORDER BY WEEK(p.post_timestamp) 
```

我如何也添加评论计数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:06:18.363

我认为你需要这样的东西：

```
select
  week(post_timestamp) as Week,
  adddate(date(post_timestamp), INTERVAL 1-DAYOFWEEK(post_timestamp) DAY) as StartDate,
  count(distinct post_id),
  count(comment_id)
from
  posts left join comments
  on comments.posts_post_id = posts.post_id
group by Week, StartDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:08:12.803

这是一种方法，使用`join`：

```
select coalesce(p.week, c.week) as week, p.Posts, c.Comments
from (select makedate( left(yearweek(p.post_timestamp),1),week(p.post_timestamp, 2 ) * 7 ) as Week,   
             COUNT(*) as Posts  
      FROM cl_posts p
      GROUP BY Week
     ) p full outer join
     (select makedate( left(yearweek(c.comment_timestamp),1),week(c.comment_timestamp, 2 ) * 7 ) as Week,   
             COUNT(*) as Comments
      FROM cl_comments c
      GROUP BY Week
     ) c
     on p.week = c.week
order by 1 
```

我使用 a`full outer join`而不是另一种连接类型的原因是即使其中一个或其他计数为 0 也能保持数周。我没有将表连接在一起的原因可能是因为您希望在评论日期之前获得报告，而不是与评论关联的帖子的发布日期。

# bash - “if”shell 命令是如何工作的？

> ID：13746307
> 
> 赞同：1
> 
> 时间：2012-12-06T14:58:33.977
> 
> 标签：bash, shell, if-statement, background, terminal

我知道如何使用`if`shell 命令。但它实际上是如何工作的？我在网上找到的所有内容都只解释了它的使用方式。

它是 shell 的内置功能，还是我自己也可以编写的常规命令？

```
if echo "test"; then mkdir one; else mkdir two; fi 
```

这会调用一个`if`带有`echo "test"`参数的命令吗？它是否“记住”了结果，以便下次执行`then`or`else`命令时，它们可以决定是否实际运行？

还是shell解析这样的东西并直接执行`echo "test"`？如果是这样，为什么我们需要终止`;`or `\n`？不能只扫描到`then`关键字吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:03:00.360

> 这会调用一个`if`带有`echo "test"`参数的命令吗？它是否“记住”了结果，以便下次执行`then`or`else`命令时，它们可以决定是否实际运行？

`if`, `then`, and`else`是 shell 关键字，并且是特殊情况。

> 还是shell解析这样的东西并直接执行echo“test”？如果是这样，为什么我们需要终止；或\n？不能只扫描到 then 关键字吗？

它需要命令终止符，以便它知道命令的参数已经终止。否则，`then`将作为参数传递给命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:35:20.940

看起来它只使用`then`部分之前的最后一个表达式的结果：

```
if true;        then echo y; else echo n; fi    # y
if false;       then echo y; else echo n; fi    # n
if true; false; then echo y; else echo n; fi    # n
if false; true; then echo y; else echo n; fi    # y 
```

如果结果（即`$?`）为零，则`then`执行该部分，否则执行该`else`部分。诸如`test ...`, `[ ... ]`,`[[ ... ]]`等结构`(( ... ))`对表达式求值并返回真或假，这就是它们可以在`if`语句中使用的原因。

Bash 的`man`页面说 if 语句的语法是`if list; then list; [ elif list; then list; ] ... [ else list; ] fi`，并且“列表是一个或多个管道的序列，由运算符`;`, `&`,`&&`或中的一个分隔，并且可选地由,或`||`中的一个终止。”`;``&``<newline>`

由于它是一个内置的 shell，它可能不需要“记住”任何东西。`my_if`原则上，您可以通过保存执行其参数的结果来编写自己的条件构造，仅当`my_then`它是时才执行其参数`true`，并且`my_else`仅当它是`false`。然而，这很容易被滥用或错误地使用，而 bash 的`if`语句需要非常特定的语法。

但即使那样，你也不能让它完全像`if`. 上面的例子会变成：

```
#my_if true; false; ...  # this wouldn't work since my_if ends at the first ;

my_if 'true; false;'; my_then echo y; my_else echo n; # and perhaps my_fi 
```

`my_if`最后，除非您使用一些复杂的存储状态数组或其他东西，否则您将无法（轻松）嵌套您的 s 。

总之，您可能能够复制`if`自己的一些，但可能不是全部，至少不是以比常规更有意义的方式使用`if`。

# filter - 带有刷新按钮的 Kendo UI 网格过滤器

> ID：13746309
> 
> 赞同：3
> 
> 时间：2012-12-06T14:58:36.880
> 
> 标签：filter, kendo-ui

我有一个 Kendo UI 网格和一个刷新按钮。我想防止在过滤器更改时重新绑定网格。我想将过滤器收集到一个集合中。如果用户单击刷新按钮，则应重新绑定网格并应用过滤器。这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:25:27.457

不，这不可能开箱即用。单击网格过滤器菜单的“过滤器”按钮将立即进行过滤。

# azure - 可以将延续标记用于稍微不同的查询吗？

> ID：13746313
> 
> 赞同：1
> 
> 时间：2012-12-06T14:58:48.017
> 
> 标签：azure, azure-table-storage

我正在使用 azure 表存储，我想知道是否可以将延续令牌（在 REST API 对查询的响应中提供）与稍微不同的查询一起使用。

例子：

获取整个表的 $top=1 （返回分区和行继续标记）。在下一个查询中，我想得到更多，所以我设置了 $top=10。我可以提供初始延续令牌以跳过第一个结果吗？

# java - 找出 HTML 代码是否代表可见的文本/图像

> ID：13746319
> 
> 赞同：0
> 
> 时间：2012-12-06T14:59:05.107
> 
> 标签：java, html, regex

我有一个包含一些 HTML 代码的字符串。我想知道 HTML 代码是代表可见文本还是图像。我使用 Java 使用以下正则表达式解决了这个问题（我知道你不能使用 RegExps 解析 HTML，但我认为我所掌握的 RegExps 就足够了）。

```
public static String regex_html_tags_1 = "<\\s*br\\s*[/]?>";
public static String regex_html_tags_2 = "<\\s*([a-zA-Z0-9]+)\\s*([^=/>]+\\s*=\\s*[^/>]+\\s*)*\\s*/>"; 
public static String regex_html_tags_3 = "<\\s*([a-zA-Z0-9]+)\\s*([^=>]+\\s*=\\s*[^>]+\\s*)*\\s*>\\s*</\\s*\\1\\s*>"; 

public static String[] HTMLWhiteSpaces = {"&nbsp;", "&#160;"}; 
```

使用这些 RegExps 的代码适用于字符串，如

```
<h2></h2> 
```

或类似的。但是一个字符串

```
<img src="someImage.png"></img> 
```

也被认为是空的。

有没有人比使用 RegExps 来确定某些 HTML 代码在被浏览器解释时是否真的代表人类可读文本更好的主意？或者你认为我的方法最终会成功吗？

提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:12:33.367

尝试使用[JSoup](http://jsoup.org/)。它让您可以使用 css 选择器（jquery 样式）解析 HTML 文档。

选择所有非空元素的一个非常简单的示例是：

```
Document doc = Jsoup.connect("http://my.awesome.site.com").get();
Elements nonEmpties = doc.select(":not(:empty)"); 
```

*成熟的*解决方案当然需要做一些额外的工作，比如

*   迭代元素列表，
*   检查 CSS 样式（`display`或`visibility`或大小或覆盖元素）
*   检查`src`图像的属性
*   ETC

但这绝对值得。您将学习一个新框架，发现在 HTML / CSS 中“隐藏”内容的可能性，并且 - 最重要的是 - 停止使用正则表达式进行 HTML 解析 ;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T12:14:36.200

我想出了以下代码，它在我不必考虑不可见元素的设置中运行良好。

```
// HTML white spaces that might occur in between tags; this list probably needs to be extended
public static String[] HTML_WHITE_SPACES = {"&nbsp;", "&#160;"};

/**
 * check if the given HTML text contains visible text or images
 * 
 * @param htmlText String the text that is checked for visibility
 * @return boolean    (1) true if the htmlText contains some visible elements 
 *                 or (2) false in case (1) does not hold
 */
public static boolean containsVisibleElements(String htmlText) {

    // do not analyze the HTML text if it is blank already
    if (StringUtil.isBlank(htmlText)) {
        return false;
    }

    // the string from which all whitespaces are removed
    String htmlTextRemovedWhiteSpaces = htmlText; 

    // first, remove white spaces from the string
    for (String whiteSpace: HTML_WHITE_SPACES) {
        htmlTextRemovedWhiteSpaces = htmlTextRemovedWhiteSpaces.replaceAll(whiteSpace, "");
    }

    // the HTML text is blank 
    if (StringUtil.isBlank(htmlTextRemovedWhiteSpaces)) {
        return false;
    }

    // parse the HTML text from which the white space have been removed
    Document doc = Jsoup.parse(htmlTextRemovedWhiteSpaces);

    // find real text within the body (and its children)
    String text = doc.body().text(); 

    // there exists visible text
    if (!StringUtil.isBlank(text.trim())) {
        return true;
    }

    // now we know that there does not exist visible text and that the string 
    // htmlTextRemovedWhiteSpaces is not blank

    // look for images as they are visible and not a text ;-)
    Elements images = doc.select("img");

    // there do not exist any image elements
    if (images.isEmpty()) {
        return false;
    }       

    // none of the above checks succeeded, so there must exist some visible elements such as text or images
    return true;
} 
```

# c# - 如何获取单链表中元素的索引？

> ID：13746321
> 
> 赞同：0
> 
> 时间：2012-12-06T14:59:09.343
> 
> 标签：c#, indexing, stack, singly-linked-list

我有两节课：

方法的 SLList（私有 SLElement _root）

SLElement 用于为列表创建新元素。（公共 int _value；公共 SLElement _next）

我已经完成了添加方法：

```
public void Add(int value)
{
  SLElement addNewElement = new SLElement();
  addNewElement._value = value;
  SLElement rootCopy = _root;
  _root = addNewElement;
  addNewElement._next = rootCopy;
  Console.WriteLine(addNewElement._value);
} 
```

所以现在我想要一个删除功能。我已经让它工作了，它删除了一个具有特定值的元素，但我想要它，以便它删除一个具有特定索引的元素。如何找出列表中元素的索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:02:33.920

你需要从头开始遍历你的列表，一路计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T15:11:15.223

除非您有充分的理由要创建自己的，否则我相信您应该选择[LinkedList](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)

```
var list = new LinkedList<SLElement>();

list.AddAfter(list.AddFirst(new SLElement()), new SLElement());

list.Remove(list.Select((i, j) => new { i, j })
    .Where(j => j.j == 0)//remove the first node
    .Select(i => i.i)
    .FirstOrDefault()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:05:16.767

循环抛出索引时间并找到元素

```
public SLElement Remove(int index)
{
    SLElement prev = _root;
    if(prev == null) return null; //or throw exception
    SLElement curr = _root.next;
    for(int i = 1; i < index; i++)
    {
      if(curr == null) return null; //or throw exception
      prev = curr;
      curr = curr.next;
    }
    prev.next = curr.next; //set the previous's node point to current's next node
    curr.next = null;
    return curr;
} 
```

# javascript - 如何获取加载文件的内容（带有脚本或链接）

> ID：13746322
> 
> 赞同：0
> 
> 时间：2012-12-06T14:59:12.647
> 
> 标签：javascript, jquery, templates

我想知道，我如何获取已加载脚本、样式表的内容……再见访问元素上设置的 id。

例子：

```
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Demo</title>
    <script src="../jquery-1.8.3.min.js"></script>
    <script id="test" src="test.txt" type="text/isis-template"></script>
    <!-- File contains "Hello world" -->
    <script>
        $(function () {
            $('#test').GET_CONTENT_OF_LOADED_FILE
        });
    </script>
</head>
<body>
</body>
</html> 
```

背景：我想加载 HTML 模板（例如，mustach、knout），但不想将它们写入页面，我宁愿将它们放在单独的文件中。现在我看到我可以使用脚本或链接标签加载任何文件，所以我正在测试我是否可以像这样加载它们......任何评论为什么这可能是一个坏主意或如何做得更好，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:00:43.280

尝试使用[load()](http://api.jquery.com/load/)

```
$(function () {
      $('#test').load('yourfolder/test.html', function(resp){
           alert(resp); 
      });
}); 
```

如果您已经在某些 html 元素中加载了内容

```
contents = $('#test').html(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:11:35.440

~~如果您使用调试工具并查看网络活动，您会看到它没有加载外部文件（*因为它不是`text/javascript`，并且浏览器不知道如何处理它*）~~
（*我的错误测试，正在测试本地文件*）

所以你只有一个标签，属性中有一个`id`和一个外部资源。`src`将其视为元数据。

您将不得不手动加载资源

像这样的东西

```
// load external template resources
$('script[type="text/isis-template"]').each(function(){
    $(this).load(this.src);
}); 
```

*对于实际使用，您需要确保在尝试使用模板之前已加载模板。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-20T04:39:37.667

所以当文档准备好时你想要**text/isis-template文件的内容吗？**你很幸运，因为这个文件不属于[CORS](https://www.w3.org/TR/cors/ "CORS")，但我的（我一直在寻找并今天来到这里的答案）可以。

好吧，只做ajax！

```
<!doctype html>
<html>
 <head>
   <meta charset="utf-8">
   <title>Demo</title>
   <script src="../jquery-1.8.3.min.js"></script>

   <!-- File contains "Hello world" -->
   <script>
     $(function () {
        $.ajax({ url: "test.html"})
         .done(function(cont) {
             var GET_CONTENT_OF_LOADED_FILE=cont;
         });
     });
   </script>
  </head>
  <body></body>
 </html> 
```

# json - 使用 Dojo Datagrid 从 JSON 中检索数据

> ID：13746324
> 
> 赞同：0
> 
> 时间：2012-12-06T14:59:20.713
> 
> 标签：json, dojo

我需要检索 JSON 数据并使用 dojo 数据网格进行显示。我的 JSON 是这样的

```
var data = {
   "key":[{
         "key1": "info1"},
    {
         "key2": "info2"},
    {
         "key3": "info3"}
]}; 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T06:29:08.557

这有点难以回答，因为很难说出你已经尝试过什么。因此我假设你已经得到了`DataGrid`渲染（使用商店，就像 Daniel Hu 建议的那样），现在你想“过滤”这个特定的入口。

为此，您可能必须修复您`store`之前设置的方式：

```
 var yourData = {
        "key": [{
            "key1": "info1"},
        {
            "key2": "info2"},
        {
            "key3": "info3"}
                     ]
    };

    var yourStore = new dojo.data.ItemFileReadStore({
        data: {
            identifier: 'key1',
            items: yourData.key
        }
    }); 
```

您现在可以过滤将在`DataGrid`使用`query`-property 中显示的行，`DataGrid`如下所示：

```
 var grid = new dojox.grid.Datagrid({
        store: yourStore,
        [some other properties, (especially the structure)],
        query: {key1: 'info1'} // this is where you set you filter...
    }, yourDomNode).startup(); 
```

请注意，对于给定的示例数据，这将导致一个网格`row`仅包含一个`cell`显示“info1”的网格。商店的 items-property 需要一个包含对象的数组。这些对象中的每一个都应该代表一行，所以我猜你这个概念错了。我的意思是：`key1`通常应该是一个对象。因此，查看 Daniel Hu 推荐的链接可能确实“有用”。

正如我在评论中已经提到的那样：如果这不能回答您的问题，那么如果您发布一些代码显示您已经尝试过的内容并说明不受欢迎的行为（如果它已经以某种方式“表现”），它可能会很有用...）。还要准确说明您期望的结果和实际结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:52:49.293

道场`DataGrid`需要商店。这应该可以帮助您：

[http://dojotoolkit.org/documentation/tutorials/1.7/store_driven_grid/](http://dojotoolkit.org/documentation/tutorials/1.7/store_driven_grid/)

# bash - 我的主要功能被声明为

> ID：13746329
> 
> 赞同：-4
> 
> 时间：2012-12-06T14:59:46.397
> 
> 标签：bash, shell, awk

是我每次编译文件时遇到的错误，错误将我引用到第 7 行，这是我声明 main() 函数的地方。

我的主要功能被声明为

int main(int argc, char *argv[]) 有人知道这是什么原因吗？

任何帮助是极大的赞赏。

第 1-6 行是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:07:06.970

如果我理解正确，您正在尝试使其只有一个 shell 脚本，而不是一个 shell 脚本和一个 awk 脚本，对吗？

您可以在调用时将 awk 程序放在命令行上`awk`。只需将其放在单引号中。

```
awk 'BEGIN {FS = ","} {if....}' -v pcode="\"""$postcode""\"" < "$areacode".csv 
```

那么您就没有单独的 .awk 文件了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:06:46.740

无需制作单行 awk 脚本即可将其嵌入到 shell 脚本中。当您使用单引号时，它会自动处理多行。

```
for ARG in "$@"
do
    postcode=`echo "$ARG" | sed -e 's/\(.*\)/\U\1/'`
    areacode=`echo "$postcode" | sed -e 's/.*\(^[A-Z][A-Z]*\).*/\1/' | sed -e 's/\(.*\)/\L\1/'`
    awk  -v pcode="\"""$postcode""\"" '
        BEGIN {FS = ","}
        {if (pcode == $1){ print $1", " $3", " $4 }}
    ' < "$areacode".csv 
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:07:21.010

也许是这样的？

```
for ARG in "$@"
do
    postcode=`echo "$ARG" | sed -e 's/\(.*\)/\U\1/'`
    areacode=`echo "$postcode" | sed -e 's/.*\(^[A-Z][A-Z]*\).*/\1/' | sed -e 's/\(.*\)/\L\1/'`
    awk -F, -vOFS=, -v pcode="$postcode" \
      '$1 == pcode {print $1, $3, $4}' < "$areacode".csv
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:27:03.527

未经测试，因为您没有提供任何示例输入和预期输出，但看起来这是您想要做的：

```
awk -v args="$@" '
BEGIN {
   FS = ","
   OFS = ", "
   n = split(args,argA)
   for (i=1; i<=n; i++) {
      arg = argA[i]
      match(arg,/[[:alpha:]]+/)
      areacode = substr(arg,RSTART,RLENGTH)
      ARGV[++ARGC] = tolower(areacode) ".csv"
      postcodes[ARGC] = "\"" toupper(arg) "\""
   }
}
FNR == 1 { pcode = postcodes[++argInd] }
$1 == pcode { print $1, $3, $4 }
' 
```

如果您使用 GNU awk，那么您可以使用 ARGIND 而不是 ++argInd。

同样，如果没有一些示例输入，很难说，但如果您在输入中重复相同的区号和/或邮政编码，则上述内容可以更有效。特别是每个地区代码文件可以只搜索一次以查找它们可能包含的所有邮政编码。

# ios - UIButtonTypeInfoDark Touch Area

> ID：13746331
> 
> 赞同：2
> 
> 时间：2012-12-06T14:59:48.483
> 
> 标签：ios, objective-c, uibutton

我在视图中添加了`UIButton`一个类型为`UIButtonTypeInfoDark`的，它的触摸区域很大。我知道 Apple 推荐 44px，但在这种情况下，它要大一些。我为视图设置了一个浅灰色背景，以查看 44px 的结束区域在哪里，并且我可以在浅灰色视图区域之外触摸并仍然接收到`infoTapped:`事件。

谁能澄清为什么？谢谢！

```
_infoButton = [UIButton buttonWithType:UIButtonTypeInfoDark];
[_infoButton setShowsTouchWhenHighlighted:NO];
[_infoButton setFrame:CGRectMake(frame.size.width-44, 0, 44, 25)];
[_infoButton setBackgroundColor:[UIColor lightGrayColor]];
[_infoButton addTarget:self action:@selector(infoTapped:) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-23T13:49:53.093

有一个更简单的版本来检查用户是否触摸了信息按钮边界的内部或外部。只需检查 touchInside 的状态。

```
if ([control isKindOfClass:[UIButton class]]) {
    UIButton *btn = (UIButton*)control;

    if (btn.buttonType == UIButtonTypeInfoDark && btn.touchInside == YES) {
        // User pressed button inside bounds...
    } else if (btn.buttonType == UIButtonTypeInfoDark && btn.touchInside == NO) {
        // User pressed button outside bounds...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T14:27:20.883

要解决这个问题很可能需要子类化。您可以[`pointInside:withEvent:`](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instm/UIView/pointInside%3awithEvent%3a)在`UIButton`子类中覆盖并返回`NO`，除非严格在按钮的范围内：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    return CGRectContainsPoint(self.bounds, point);
} 
```

Apple 控件有时会返回`YES`到超出其范围的查询，以使控件更易于用手指触摸。

# php - 使用 filter_var() 验证日期？

> ID：13746332
> 
> 赞同：10
> 
> 时间：2012-12-06T14:59:56.823
> 
> 标签：php, filtering

我显然没有正确使用[filter_var()](http://php.net/manual/en/function.filter-var.php)。我需要检查用户是否输入了有效日期，格式为“dd/mm/yyyy”。

这只是返回我作为日期传递的任何内容，而我希望它返回日期或 0/null/FALSE，以防输入字符串看起来不像日期：

```
$myregex = "/\d{2}\/\d{2}\/\d{4}/";
print filter_var("bad 01/02/2012 bad",FILTER_VALIDATE_REGEXP,array("options"=>array("regexp"=> $myregex))); 
```

如果其他人使用此功能检查日期，我做错了什么？我应该使用另一个函数来验证表单字段吗？

谢谢你。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-06T15:05:03.520

使用正则表达式来验证日期是一个坏主意..想象一下`99/99/9999`很容易被视为有效日期..你应该[检查日期](http://php.net/manual/en/function.checkdate.php)

```
bool checkdate ( int $month , int $day , int $year ) 
```

简单用法

```
$date = "01/02/0000";
$date = date_parse($date); // or date_parse_from_format("d/m/Y", $date);
if (checkdate($date['month'], $date['day'], $date['year'])) {
    // Valid Date
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-06T15:02:48.127

```
$myregex = '~^\d{2}/\d{2}/\d{4}$~'; 
```

正则表达式匹配，因为您只需要在字符串中的*任何位置使用该模式。*你想要的*只是*那个模式，没有别的。所以添加`^`和`$`。

请注意，这并不意味着该值是*有效的 date*。`99/99/9999`将通过该测试。我会使用：

```
if (!DateTime::createFromFormat('d/m/Y', $string)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-23T13:35:39.847

在 PHP 中验证日期的一种简单方便的方法是[strtotime](http://php.net/manual/en/function.strtotime.php)函数。您可以只用一行来验证日期：

```
strtotime("bad 01/02/2012 bad"); //false
strtotime("01/02/2012"); //1325455200 unix timestamp 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-19T17:18:44.203

为什么使用繁重的正则表达式，而有一个原生的[DateTime](http://php.net/datetime) PHP 类？

```
$value = 'badbadbad';

try {
    $datetime = new \DateTime($value);

    $value = $datetime->format('Y-m-d');
} catch(\Exception $e) {
    // Invalid date
} 
```

如果插入了有效的日期时间字符串，则始终返回您期望的格式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-05-14T09:42:12.113

@baba 发布了更好的解决方案，但发布的代码在某些情况下无法正常工作。

例如，如果您尝试验证此日期“2019-12-313”；

```
$date = date_parse("2019-12-313"); 
```

该函数返回这个数组：

```
Array
(
    [year] => 2019
    [month] => 12
    [day] => 31
    [hour] => 
    [minute] => 
    [second] => 
    [fraction] => 
    [warning_count] => 0
    [warnings] => Array
        (
        )

    [error_count] => 1
    [errors] => Array
        (
            [10] => Unexpected character
        )

    [is_localtime] => 
) 
```

所以，如果你执行命令：

```
checkdate($date['month'], $date['day'], $date['year']); 
```

checkdate 将返回一个真值，因为它的值`$date['day']`是 31 而不是 313。

为避免这种情况，您可能必须对`$date['error_count']`

@baba 示例已更新

```
$date = "2019-12-313";
$date = date_parse($date); // or date_parse_from_format("d/m/Y", $date);
if ($date['error_count'] == 0 && checkdate($date['month'], $date['day'], $date['year'])) {
    // Valid Date
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-13T07:39:24.027

您可以使用此功能检查日期：

```
function is_date_valid($date, $format = "Y-m-d"){
    $parsed_date = date_parse_from_format($format, $date);
    if(!$parsed_date['error_count'] && !$parsed_date['warning_count']){
        return true;
    }

    return false;
} 
```

如何使用它：

```
$is_valid = is_date_valid("2021-8-1"); // it will return boolean. 
```

注意：您可以通过在第二个参数中传递格式来更改日期的格式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-06T15:04:23.407

尝试为您的正则表达式设置开始和结束，如下所示：

```
$myregex = "/^\d{2}\/\d{2}\/\d{4}$/"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-06T22:32:52.863

```
 $myregex = "~^(19|20)\d\d[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])$~";

print filter_var("bad 01/02/2012 bad",FILTER_VALIDATE_REGEXP,array("options"=>array("regexp"=> $myregex))); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-07-12T20:24:21.470

您收到了很多答案，表明 RegEx 将允许 99/99/9999 的答案。这可以通过向 RegEx 添加更多内容来解决。如果您知道您永远不会有 1900-2099 年之外的日期......您可以使用这样的 RegEx：

```
/^(0[1-9]|[12][0-9]|3[01])[/](0[1-9]|1[012])[/](19|20)\d\d$/ 
```

这将验证此格式的日期：dd/mm/YYYY

之间：01/01/1900 - 31/12/2099

如果您需要更多年，只需在接近尾声时添加它们。|21|22|23|24|25（将延长至 2599 年。）

# android - 如何将我的应用程序设置为全屏模式？

> ID：13746336
> 
> 赞同：0
> 
> 时间：2012-12-06T15:00:11.153
> 
> 标签：android, android-layout, android-ui

我想将我的应用程序设置为全屏模式，但仍希望能够从顶部拖动折叠的菜单（您在收到通知时拖动的菜单，您可以从中激活蓝牙、WI-FI、GPS )..

我试图设置：

```
android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" 
```

对于每个活动，但有了这个 - 我无法拖动并显示顶部菜单。

我使用的设备是 Galaxy S2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T07:36:38.060

Try this code in your activity class. Paste this before ***setContentView(R.layout.main)*** method

```
 requestWindowFeature(Window.FEATURE_NO_TITLE);   
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.main); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:03:14.467

将其更改为：

```
android:theme="@android:style/Theme.Black.NoTitleBar" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T06:01:47.433

关注此[了解更多详情](http://glorious-arvind.blogspot.in/2012/11/full-screen-in-android.html)

在这篇文章中，您可以从 XML 和 JAVA 代码设置应用程序全屏。

# delphi - TvalueListeditor 的变化

> ID：13746338
> 
> 赞同：1
> 
> 时间：2012-12-06T15:00:16.423
> 
> 标签：delphi

我想知道读取 TValueListeditor 中所做更改的最佳方法是什么。我正在使用的 stringList 具有以下结构：

```
 aParam1=100

   aParam2=222

   aparam3=....
   ....
   ... 
```

使用一行代码，我可以将此字符串列表分配给 TValueListEditor

```
ValueListEditor.strings.assign(myDataStringlist); 
```

并编辑此字符串列表。现在如何将我的更改保存回 Stringlist ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:04:23.767

打电话 `myDataStringlist.Assign(ValueListEditor1.strings);`

两者都是 TStrings

TStringList = 类（TStrings）

TValueListEditor

属性字符串：TStrings 读取 GetStrings 写入 SetStrings；

# gwt - GWT：如何模拟 F11 按键事件？

> ID：13746340
> 
> 赞同：2
> 
> 时间：2012-12-06T15:00:16.520
> 
> 标签：gwt, gwt2, gwt-2.4, gwt-2.5

我想知道，即使在没有 JSNI的**GWT**中，我们也能触发任何按键吗？例如，假设我的应用程序标题中有一个图像或一个按钮。单击它后，我想在模拟**F11**按键的浏览器上**全屏显示。****再次单击相同的图像或按钮，我想退出模拟ESC**按键的全屏模式。

 ****我通过“[如何通过 JavaScript 使用 F11 键事件使浏览器全屏](https://stackoverflow.com/questions/7495373/how-to-make-browser-full-screen-using-f11-key-event-through-javascript)”了解到我们可以通过 java 脚本来做到这一点，因此必须可以通过 JSNI 代码片段来做到这一点。是否有任何其他不使用 JSNI 代码的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:56:08.890

您将需要使用`Document.get().createKeyEvent`或类似的[api](http://google-web-toolkit.googlecode.com/svn/javadoc/2.5/com/google/gwt/dom/client/Document.html)。

```
NativeEvent event = Document.get().createKeyEvent(args.....);

DomEvent.fireNativeEvent(event, this); 
```

在使用前检查哪些 api 已被弃用。****

# python - 在不更改的情况下保存 django ORM 模型有多贵？

> ID：13746342
> 
> 赞同：4
> 
> 时间：2012-12-06T15:00:25.410
> 
> 标签：python, django

有时我们必须做一个 Model instance.save() 不管某些字段是否改变，只是为了安全和快速开发。

1.  django ORM 有多贵？
2.  总是发送信号？
3.  执行任何 SQL 查询？

我用 django 调试工具栏测试了 10 .save() 在模型中的任何内容发生变化的不同点，并且日志没有注册 sql 查询。

其他方式来测试它或一些文章？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T20:30:03.453

我不完全确定您的应用程序如何处理这个问题。

但我进行了一个小测试：

```
a = Blog.objects.get(pk=1)

for b in range(1, 100):
    a.save() 
```

这给了我一个结果：

**87.04 毫秒（201 个查询）**

还要注意保存将执行两个查询：

```
SELECT ••• FROM `fun_blog` WHERE `fun_blog`.`id` = 1 LIMIT 1

UPDATE `fun_blog` SET `title` = 'This is my testtitle', `body` = 'This is a testbody' WHERE `fun_blog`.`id` = 1 
```

# visual-studio-2012 - 将 SQL Server CE 数据库 (.sdf) 从 3.5 更新到 4.0

> ID：13746343
> 
> 赞同：1
> 
> 时间：2012-12-06T15:00:26.130
> 
> 标签：visual-studio-2012, linq-to-sql, sql-server-ce

我需要将 SQL Server Compact 数据库从 3.5 升级到 4.0 版本。我正在使用 linq-to-sql

我尝试了一些在stackoverflow上找到的东西，但没有帮助：

1.  我尝试`Add 4.0 connection`了对话框（没有错误消息，已创建 bak 文件）

2.  我尝试在代码中升级：（没有错误消息）

    ```
    System.Data.SqlServerCe.SqlCeEngine engine= new System.Data.SqlServerCe.SqlCeEngine("Data source = ...");
    engine.Upgrade(); 
    ```

3.  我检查了数据库损坏（系统返回没有损坏问题）

    ```
    System.Data.SqlServerCe.SqlCeEngine engine= new System.Data.SqlServerCe.SqlCeEngine("Data source = ...");
    engine.Verify(); 
    ```

    在这些操作之后，我想重新创建 dbml 文件 - 我收到错误消息

    > *不兼容的数据库版本 (..) 数据库版本 4000000，请求的版本 3505053 (..)*

4.  在调试模式下，我检查了`db.Connection.ServerVersion`= 返回 3.5.8080.0

5.  在数据库连接属性版本是 4.0.8876.1

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:18:48.953

将数据库升级到 4.0 后，您将无法再创建 dbml 文件，因为负责此操作的工具仅适用于 3.5 数据库文件。一种可能的解决方法是拥有两个版本的数据库，一个 3.5 用于生成 dbml，另一个用于使用。请记住使用 SqlCeConnection 对象初始化 DataContext 对象，否则 4.0 将无法使用 LINQ to SQL - 或者您可以尝试我的 SQL Server Compact Toolbox，它允许您直接从 4.0 数据库文件生成 DataContext（仍然必须使用 SqlCeConnection 初始化目的）

# php - Zend 如何在同一操作中验证 3 个单独的表单？

> ID：13746344
> 
> 赞同：2
> 
> 时间：2012-12-06T15:00:26.923
> 
> 标签：php, javascript, jquery, html, zend-framework

因此，我在同一页面上有 3 个表单和相同的控制器操作，当我单击其中一个提交按钮时，它会验证所有表单而不是我单击的那个。

我怎样才能将它与验证分开？

这是我的代码：

```
public function signUpAction()
{
    $firstName = $this->getRequest()->getParam('firstName');
    $lastName = $this->getRequest()->getParam('lastName');
    $email = $this->getRequest()->getParam('email');
    $emailAdrress = $this->getRequest()->getParam('Email_Address');
    $password = $this->getRequest()->getParam('password');

    $signupForm = new Application_Form_UserSignUp();
    $loginForm = new Application_Form_UserLogin();
    $retreivePasswordForm = new Application_Form_UserRetreivePassword();

    if ($this->getRequest()->isPost('signupForm'))
    {
        /*********** Sign Up Form ***********/
        if ($signupForm->isValid($this->getRequest()->getParams()))
        {
            $user = $this->_helper->model('Users')->createRow($signupForm->getValues());   
            if ($user->save())
            {
                Zend_Session::rememberMe(186400 * 14);
                Zend_Auth::getInstance()->getStorage()->write($user);
                $user->sendSignUpEmail();
                $this->getHelper('redirector')->gotoRoute(array(), 'invite');
                return;
            }
            else 
            {
            }
        }
        else
        {
            // something
        }
    }
    if ($this->getRequest()->isPost('loginForm'))
    {
        /************ Login Form ************/
        if ($loginForm->isValid($this->getRequest()->getParams()))
        {
            $user = $this->_helper->model('Users')->createRow($loginForm->getValues()); 
            $user = $this->_helper->model('Users')->fetchRowByFields(array('email' => $email, 'hash' => $password));

            if($user) 
            {
                Zend_Session::rememberMe(86400 * 14);
                Zend_Auth::getInstance()->getStorage()->write($user);
                $this->getHelper('redirector')->gotoRoute(array(), 'invite');
                return;
            } 
            else {
                // Error message
                $this->view->errorMsg = "<b>password</b> - invalid, please try again! *";
            }               
        }
        else
        {
            // something
        }
    }
    if ($this->getRequest()->isPost('retreivePasswordForm'))
    {
        /****** Retreive Password Form ******/
        if ($retreivePasswordForm->isValid($this->getRequest()->getParams()))
        {
            $user = $this->_helper->model('Users')->createRow($retreivePasswordForm->getValues()); 
            $user = $this->_helper->model('Users')->fetchRowByFields(array('email' => $emailAdrress));
            if($user)
            {
                Zend_Auth::getInstance()->getStorage()->write($user);
                $user->sendRetreiveEmail();

                $_SESSION['email'] = $emailAdrress;

                $redirector = $this->_helper->getHelper('redirector');
                $redirector->setCode(301)->setUseAbsoluteUri();
                $newPath = 'http://refer.lavasoft.com/#retreive_sent';
                $redirector->gotoUrl($newPath);

                //$this->view->assign('sendEmail', $emailAddress);
            }
            else
            {
            }
        }
        else
        {
            // something
        }

    }

    $this->view->retreivePasswordForm = $retreivePasswordForm;
    $this->view->loginForm = $loginForm;
    $this->view->signupForm = $signupForm;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:08:02.137

这不是它在 ZF 中的工作方式。除非您在代码中覆盖 isPost()，否则您不能将表单名称传递给 isPost()。

您可以做的是定义所有字段，例如：

```
loginForm[name]
loginForm[password] 
```

和

```
signupForm[name] 
```

等然后检查`isset($_POST['loginFom'])`

这应该可以正常工作。

或者使用一个名为 formName 的隐藏字段并在您的代码中检查它的值是什么。

您还可以对每个表单使用不同的操作，并最终重定向到 signUpAction ，这将产生相同的结果而没有麻烦。

# logstash - 为 logstash 转换日期 MMM dd HH:mm:ss

> ID：13746347
> 
> 赞同：3
> 
> 时间：2012-12-06T15:00:39.093
> 
> 标签：logstash

我有一个自定义格式的日志文件，日期字段如下所示：

```
Dec  4 23:59:21
Nov 21 23:59:21 
```

在我的 logstash 配置中，我有这个过滤器：

```
date {
    type => "custom"
    # tell it the format
    custom_timestamp => ["MMM  d HH:mm:ss", "MMM dd HH:mm:ss"]
    # locale didn't help
    locale => "en"
}
mutate{
    type => "custom"
    # replace the timestamp
    replace => ["@timestamp", "%{custom_timestamp}"]
} 
```

据说它用日志中的自定义时间戳替换了logstash时间戳（我目前正在从旧日志中回填它以进行测试）。

如果我打开调试标志并输出到标准输出，它会显示`@timestamp`已被替换，`custom_timestamp`但我收到一条错误消息，告诉我它无法导入：

```
:exception=>java.lang.IllegalArgumentException: Invalid format: "Dec  4 23:59:21" 
```

我该怎么做才能转换日期格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:27:30.717

Turns out that the sample I was working from is wrong. You do not need the mutate replacement, the config is this now:

```
date {
    type => "custom"
    # tell it the format
    custom_timestamp => ["MMM  d HH:mm:ss", "MMM dd HH:mm:ss"]
    # date format is english, computer might not be
    locale => "en"
}
mutate{
    type => "custom"
    #other mutations go here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T13:16:41.553

这篇文章有两个误解：

1.  生成 java 异常是因为您的格式中没有 YEAR，因此它无法安全地解析日期。
2.  如果您希望其他应用程序将您的旧导入日志视为连贯的时间线，则需要运行 mutate。否则，当您导入所有旧日志时，您只会看到几分钟的事件集中（在导入期间）。

除此之外，很好的问题/答案，它帮助我回到了我的特定问题上；）

# android - ScrollView 中的 MapFragment

> ID：13746351
> 
> 赞同：54
> 
> 时间：2012-12-06T15:00:53.290
> 
> 标签：android, google-maps, android-mapview, google-play-services

我[`MapFragment`](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/MapFragment)在 a 中有一个新的 s `ScrollView`。实际上它是一个`SupportMapFragment`，但无论如何。它有效，但有两个问题：

1.  滚动时，它会留下一个黑色面具。黑色完全覆盖了地图所在的区域，除了 +/- 缩放按钮所在的洞。请参阅下面的屏幕截图。这是在 Android 4.0 上。

2.  `requestDisallowInterceptTouchEvent()`当用户与地图交互以防止拦截触摸时，视图不会使用`ScrollView`，因此如果您尝试在地图中垂直平移，它只会滚动包含`ScrollView`. 我理论上可以派生一个视图类`MapView`并添加该功能，但是我怎样才能`MapFragment`使用我的自定义`MapView`而不是标准的呢？

![滚动问题的部分截图](../Images/b8d2df4b6798c2944c843ceec91aa64b.png)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-12-18T19:03:11.413

在 mapview 片段上应用透明图像似乎可以解决问题。这不是最漂亮的，但它似乎工作。这是一个显示此内容的 XML 片段：

```
<RelativeLayout
        android:id="@+id/relativeLayout1"
        android:layout_width="match_parent"
        android:layout_height="300dp" >

        <fragment
            android:id="@+id/map"
            android:name="com.google.android.gms.maps.MapFragment"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"/>

        <ImageView
            android:id="@+id/imageView123"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:src="@drawable/temp_transparent" />         
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-06-26T09:11:21.443

对我来说，添加一个透明的 ImageView 并没有帮助完全去除黑色面具。滚动时地图的顶部和底部仍然显示黑色蒙版。

所以它的解决方案，我在[这个答案](https://stackoverflow.com/questions/14419521/moving-mapfragment-surfaceview-causes-black-background-flickering/16554780#16554780)中发现了一个小的变化。我补充说，

```
android:layout_marginTop="-100dp"
android:layout_marginBottom="-100dp" 
```

到我的地图片段，因为它是垂直滚动视图。所以我的布局现在看起来是这样的：

```
<RelativeLayout
    android:id="@+id/map_layout"
    android:layout_width="match_parent"
    android:layout_height="300dp">

    <fragment
        android:id="@+id/mapview"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginTop="-100dp"
        android:layout_marginBottom="-100dp"
        android:name="com.google.android.gms.maps.MapFragment"/>

    <ImageView
        android:id="@+id/transparent_image"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:src="@color/transparent" />

</RelativeLayout> 
```

`requestDisallowInterceptTouchEvent(true)`为了解决我为主 ScrollView设置的问题的第二部分。当用户触摸透明图像并移动时，我禁用了透明图像上的触摸，`MotionEvent.ACTION_DOWN`以便`MotionEvent.ACTION_MOVE`地图片段可以接受触摸事件。

```
ScrollView mainScrollView = (ScrollView) findViewById(R.id.main_scrollview);
ImageView transparentImageView = (ImageView) findViewById(R.id.transparent_image);

transparentImageView.setOnTouchListener(new View.OnTouchListener() {

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        int action = event.getAction();
        switch (action) {
           case MotionEvent.ACTION_DOWN:
                // Disallow ScrollView to intercept touch events.
                mainScrollView.requestDisallowInterceptTouchEvent(true);
                // Disable touch on transparent view
                return false;

           case MotionEvent.ACTION_UP:
                // Allow ScrollView to intercept touch events.
                mainScrollView.requestDisallowInterceptTouchEvent(false);
                return true;

           case MotionEvent.ACTION_MOVE:
                mainScrollView.requestDisallowInterceptTouchEvent(true);
                return false;

           default: 
                return true;
        }   
    }
}); 
```

这对我有用。希望对你有帮助。。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-19T15:39:59.590

这可能与导致这个问题的问题同处[一身](https://stackoverflow.com/questions/13837697/viewpager-with-google-maps-api-v2-mysterious-black-view)。解决方案是使用透明框架，它比透明图像轻一点。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-04-29T10:45:21.413

经过大量研发后完成：

**fragment_one.xml 应如下所示：**

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/scrollViewParent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="400dip" >

            <com.google.android.gms.maps.MapView
                android:id="@+id/mapView"
                android:layout_width="match_parent"
                android:layout_height="match_parent" />

            <View
                android:id="@+id/customView"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:background="@android:color/transparent" />
        </RelativeLayout>

        <!-- Your other elements are here -->

    </LinearLayout>

</ScrollView> 
```

**您的 FragmentOne.java Java 类如下所示：**

```
private GoogleMap mMap;
private MapView mapView;
private UiSettings mUiSettings;
private View customView 
```

***onCreateView***

```
mapView = (MapView) rootView.findViewById(R.id.mapView);
mapView.onCreate(savedInstanceState);

if (mapView != null) {
   mMap = mapView.getMap();
   mMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
   mUiSettings = mMap.getUiSettings();
   mMap.setMyLocationEnabled(true);
   mUiSettings.setCompassEnabled(true); 
   mUiSettings.setMyLocationButtonEnabled(false);
}

scrollViewParent = (ScrollView)rootView.findViewById(R.id.scrollViewParent);
customView = (View)rootView.findViewById(R.id.customView);

customView.setOnTouchListener(new View.OnTouchListener() {

            @Override
            public boolean onTouch(View v, MotionEvent event) {
                int action = event.getAction();
                switch (action) {
                    case MotionEvent.ACTION_DOWN:
                        // Disallow ScrollView to intercept touch events.
                        scrollViewParent.requestDisallowInterceptTouchEvent(true);
                        // Disable touch on transparent view
                        return false;

                    case MotionEvent.ACTION_UP:
                        // Allow ScrollView to intercept touch events.
                        scrollViewParent.requestDisallowInterceptTouchEvent(false);
                        return true;

                    case MotionEvent.ACTION_MOVE:
                        scrollViewParent.requestDisallowInterceptTouchEvent(true);
                        return false;

                    default:
                        return true;
                }
            }
        }); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-08T14:34:46.650

我使用了这个结构，我克服了这个问题。

我为地图片段使用了容器视图。

```
<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <LinearLayout
        android:orientation="vertical"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

        <TextView
            android:text="Another elements in scroll view1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <com.erolsoftware.views.MyMapFragmentContainer
            android:orientation="vertical"
            android:layout_width="match_parent"
            android:layout_height="250dp">

            <fragment
                xmlns:android="http://schemas.android.com/apk/res/android"
                xmlns:tools="http://schemas.android.com/tools"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:id="@+id/eventMap"
                tools:context="com.erolsoftware.eventapp.EventDetails"
                android:name="com.google.android.gms.maps.SupportMapFragment"/>

        </com.erolsoftware.views.MyMapFragmentContainer>

        <TextView
            android:text="Another elements in scroll view2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

    </LinearLayout>

</ScrollView> 
```

容器类：

```
public class MyMapFragmentContainer extends LinearLayout {

    @Override
    public boolean onInterceptTouchEvent(MotionEvent ev)
    {
        if (ev.getActionMasked() == MotionEvent.ACTION_DOWN)
        {
            ViewParent p = getParent();
            if (p != null)
                p.requestDisallowInterceptTouchEvent(true);
        }

        return false;
    }

    public MyMapFragmentContainer(Context context) {
        super(context);
    }

    public MyMapFragmentContainer(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public MyMapFragmentContainer(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-12-11T11:23:29.413

无需纠结于 customScrollViews 和透明布局文件。只需使用较轻版本的谷歌地图，您的问题就会得到解决。

```
 map:liteMode="true" 
```

在布局文件的地图片段内添加上述属性。问题将得到解决。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-21T11:24:56.630

对于问题的第二部分 - 您可以从 SupportMapFragment 派生一个片段类，并在您的布局中使用它。然后，您可以覆盖[Fragment#onCreateView](http://developer.android.com/reference/android/app/Fragment.html#onCreateView(android.view.LayoutInflater,%20android.view.ViewGroup,%20android.os.Bundle))，并在那里实例化您的自定义 MapView。

如果这不起作用，您始终可以创建自己的片段 - 然后您只需要自己处理调用所有生命周期方法（onCreate、onResume 等）。[这个答案](https://stackoverflow.com/a/13824917/214837)有更多细节。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-15T14:28:53.137

```
<ScrollView
            android:layout_width="match_parent"
    ::
    ::
    ::
      <FrameLayout
            android:id="@+id/map_add_business_one_rl"
            android:layout_width="match_parent"
            android:layout_height="100dp"
         >
                        <fragment

                            android:id="@+id/map"
                            android:name="com.google.android.gms.maps.SupportMapFragment"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:layout_marginTop="-100dp"
                            android:layout_marginBottom="-100dp"

                            />

        </FrameLayout>

    ::
    ::
    ::
     </ScrollView> 
```

# groovy - 运行 Groovy 应用程序

> ID：13746358
> 
> 赞同：0
> 
> 时间：2012-12-06T15:01:15.810
> 
> 标签：groovy, compilation

我刚刚为 Eclipse 安装了 Groovy/Grail Suit 以执行 Groovy 代码。因此，我创建了 Java 项目（这是我得到的唯一选择）并编写了 main 方法：

```
public static void main(String[] args){

def y = 9

} 
```

顺便说一句，eclipse 不允许将 Java 项目转换为 Groovy 项目。

但是该行`def y = 9`会产生语法错误。我不太确定问题是什么。我需要在 Eclipse 上启用 Groovy 吗？安装插件后，IDE 将重新启动。此致

# php - Joomla - PHP 更改模型中的 mySQL 语句

> ID：13746364
> 
> 赞同：0
> 
> 时间：2012-12-06T15:01:23.530
> 
> 标签：php, mysql, joomla

我对这段代码有语法问题：

```
$query = "SELECT *
        FROM ".$db->nameQuote('#__mls')."
        WHERE 1=1"
            . if ($zip != null)
                { AND ".$db->nameQuote('MSTZIP')." = ".$db->quote($zip)."}
            . if ($city != null)
                { AND ".$db->nameQuote('MSTCITY')." = '".$db->quote($city)."'}
            . if ($bdrms != null)
                { AND ".$db->nameQuote('MSTBDRMS')." >= ".$db->quote($bdrms)."}
            . if ($bths != null)
                { AND ".$db->nameQuote('MSTBATHS')." >= ".$db->quote($bths)."}
            . if ($lprice != null)
                { AND ".$db->nameQuote('MSTLISTPRC')." BETWEEN ".$db->quote($lprice)." AND ".$db->quote($hprice)."} 
        ";"
    ; 
```

第一个字符串`"`开始查询语句，第二`"`层分配表，当`WHERE`语句时，它变得棘手。所有的`if`陈述都在惹我生气。我觉得这就是 a`"`被放错地方或丢失的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:04:39.560

在`AND`您错过每个人之前`"`，您需要以不同的方式构建您的查询（请仔细检查每个`'`我确定我错过了一些地方）

```
 $query = "SELECT *
    FROM ".$db->nameQuote('#__mls')."
     WHERE 1=1";
         if ($zip != null)
             { $query .= " AND ".$db->nameQuote('MSTZIP')." = '".$db->quote($zip)."'";}
         if ($city != null)
              {$query .= " AND ".$db->nameQuote('MSTCITY')." = '".$db->quote($city)."'";}

          if ($bdrms != null)
             {$query .= " AND ".$db->nameQuote('MSTBDRMS')." >= '".$db->quote($bdrms)."'";}
        if ($bths != null)
            {$query .= " AND ".$db->nameQuote('MSTBATHS')." >= '".$db->quote($bths)."'";}
         if ($lprice != null)
             {$query .= " AND ".$db->nameQuote('MSTLISTPRC')." BETWEEN '".$db->quote($lprice)." AND ".$db->quote($hprice).";} 

; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:05:25.857

彻底破碎，难以置信。尝试更多类似的东西：

```
$query = "SELECT * FROM " . $db->nameQuote('#__mls') . " WHERE 1=1";
$clauses = array();
if ($zip != null) {
   $clauses[] = $db->nameQuote('MSTZIP') . " = " . $db->quote($zip);
}
if (etc...) {
   ... 
}
$query .= implode(' AND ', $clauses);
echo $query; 
```

# html - iOS 6 Mobile Safari 用选择元素慢速渲染大表

> ID：13746366
> 
> 赞同：1
> 
> 时间：2012-12-06T15:01:26.683
> 
> 标签：html, performance, ipad, ios6, mobile-safari

我们正在构建一个 Web 应用程序，该应用程序有一个页面，用户可以在其中看到一个可编辑项目的大表。该表在每一行上都有控件以向上/向下移动该行以及删除该行的选项。每行也有两个选择元素。

在极端情况下，该表可能包含大约 200 行，当我们有很多行时，我们会遇到严重的性能问题。页面上下滚动非常慢，我们在屏幕上看到“checker-boxing”，删除一行也需要大约 30 秒，有时甚至更长时间！上下移动需要相似的时间，并且页面通常不可用。

我们一直在努力缩小问题的确切范围，并且我们很确定这与表中的选择元素有关——如果我们从行中删除这些元素；滚动是完美的，上下移动约 1 秒，删除一行约 7 秒。

如果我们从 200 行表的底部删除一行，它几乎是即时的。

问题似乎与页面上的 CSS 有关，当我们运行分析器时，重新计算样式大约需要 3 秒。

该页面在其他浏览器中运行良好，任何帮助/知识都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T16:27:31.707

我们的 iOS 6 Web App 中有几个表，其中一些包含数百行只读文本，但有些还包含 SELECT 元素。

将表格布局设置为固定对性能产生了巨大影响。一些较大的表格在默认的动态表格宽度计算中存在严重的渲染问题，到目前为止我们还没有解决这个问题。当一行包含复选框时尤其如此。

例如，有些表格没有呈现最后一行，或者表格在靠近底部的任何地方被切断，等等。

我们为纵向模式使用了一个特殊的样式表，它改变了 TABLE 和 TD 元素的宽度，并且还完全删除了一些列。

这真的很好，到目前为止没有造成任何副作用或问题。

对于滚动，我们在表格周围使用一个特殊的 DIV 元素，该元素具有定义的高度并使用“-webkit-overflow-scrolling: touch”。即使是具有大约 850 个条目的最大表格也可以滚动，而不会损失任何性能或闪烁。

你什么时候渲染表格？在页面渲染/准备/加载事件期间？您是使用“innerHTML”赋值还是在逻辑中创建 DOM 树？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-06T15:06:30.847

设置`table-layout:fixed;`为表格上的样式属性（在您的样式表中）可能会使其响应更快。浏览器必须做更少的计算，缺点是你必须自己指定列宽。

# ruby-on-rails - 确定具有特定风格的图像是否存在 - 回形针导轨

> ID：13746368
> 
> 赞同：12
> 
> 时间：2012-12-06T15:01:28.093
> 
> 标签：ruby-on-rails, image, upload, paperclip

有没有办法确定给定图像样式的存在？

例如要确定图像是否存在，我们可以这样做：

```
 <% if @user.avatar.exists? %>
      <%= image_tag @user.avatar.url(:large), :id => "cropbox" %> 
```

但是我们如何确定图像是否以特定的风格存在，例如`thumb`？上述条件仅确定图像在其`original`风格中的存在。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-10-23T09:59:04.270

该`.exists?`函数可选地采用 style_name：

```
<% if @user.avatar.exists?(:large) %> 
```

应该管用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-06T15:24:56.260

尝试这样的事情

```
<% if @user.avatar(params[:large]) %><%= image_tag @user.avatar.url(:large), :id => "cropbox" %><% end %> 
```

# android - 在android中更改特定号码/用户的响铃模式

> ID：13746369
> 
> 赞同：2
> 
> 时间：2012-12-06T15:01:35.903
> 
> 标签：android, broadcastreceiver, android-audiomanager

我想更改特定号码的响铃模式。例如我保存了一个号码

```
String Number = "12345567" 
```

现在在来电时，它会检查

```
if(incoming_cal-_no == Number)
{
   ring_mode = silent
} 
```

我想做这样的事情？？？我怎样才能做到这一点？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:23:10.017

创建用于收听来电的广播接收器

当您收到任何来电时，解析呼叫信息并获取电话号码

像这样的东西

公共类电话扩展广播接收器{

```
private Context mContext;
private Intent mIntent;

@Override
public void onReceive(Context context, Intent intent) {
    mContext = context;
    mIntent = intent;
    TelephonyManager tm = (TelephonyManager)              
             context.getSystemService(Context.TELEPHONY_SERVICE);
    int events = PhoneStateListener.LISTEN_CALL_STATE;
    tm.listen(phoneStateListener, events);
}

private final PhoneStateListener phoneStateListener = 
                                            new PhoneStateListener() {
    @Override
    public void onCallStateChanged(int state, String incomingNumber) {
        String callState = "UNKNOWN";
        switch (state) {
        case TelephonyManager.CALL_STATE_IDLE:

            break;
        case TelephonyManager.CALL_STATE_RINGING:
                            // DO YOUR WORK HERE

                 put logic to silent the phone.

            break;
        case TelephonyManager.CALL_STATE_OFFHOOK:
                      if(incomingNumber.length() >0){

                              // incoming call
                             // DO YOUR WORK HERE when call is received

                        }
                       else{
                                  // outgoing call
                          }
            break;
        }

        super.onCallStateChanged(state, incomingNumber);
    }
}; 
```

}

# ios - 使用 GL_LINE_STRIP 绘制三角形轮廓时的奇怪顺序

> ID：13746373
> 
> 赞同：0
> 
> 时间：2012-12-06T15:01:45.897
> 
> 标签：ios, opengl-es, terrain

我正在使用 OpenGL 为 iOS 平台开发一个应用程序。

目前，在绘制由多个子平面组成的平面（地形）时，我遇到了一个奇怪的问题，其中每个子平面由 2 个三角形组成，形成一个矩形。我通过调用 glDrawElements 将这个地形绘制为线框，并提供参数 GL_Line_Strip 和预先计算的索引。问题是三角形以错误的顺序绘制或垂直镜像。它们没有按照我指定索引的顺序绘制，这令人困惑。

这是生成顶点的简化代码：

```
int pos = 0;
for(NSInteger y = - gridSegmentsY / 2; y < gridSegmentsY / 2; y ++) {
    for(NSInteger x = - gridSegmentsX / 2; x < gridSegmentsX / 2; x ++) {
        vertices[pos++] = x * 5;
        vertices[pos++] = y * 5;
        vertices[pos++] = 0;
    }
} 
```

这就是我生成索引的方式，包括退化的索引（用作 IBO）。

```
 pos = 0;
for(int y = 0; y < gridSegmentsY - 1; y ++) {
    if (y > 0) {
        // Degenerate begin: repeat first vertex
        indices[pos++] = (unsigned short)(y * gridSegmentsY);
    }
    for(int x = 0; x < gridSegmentsX; x++) {
        // One part of the strip
        indices[pos++] = (unsigned short)((y * gridSegmentsY) + x);
        indices[pos++] = (unsigned short)(((y + 1) * gridSegmentsY) + x);
    }
    if (y < gridSegmentsY - 2) {
        // Degenerate end: repeat last vertex
        indices[pos++] = (unsigned short)(((y + 1) * gridSegmentsY) + (gridSegmentsX - 1));
    }
} 
```

所以在这部分...

```
 indices[pos++] = (unsigned short)((y * gridSegmentsY) + x);
        indices[pos++] = (unsigned short)(((y + 1) * gridSegmentsY) + x); 
```

...我将索引数组中的*第一个索引设置为**指向*当前的 (x,y)，并将下一个索引设置为 (x,y+1)。我正在为当前条带中的所有 x 执行此操作，然后我正在处理退化三角形并为下一个条带 (y+1) 重复此过程。

此方法取自[http://www.learnopengles.com/android-lesson-eight-an-introduction-to-index-buffer-objects-ibos/](http://www.learnopengles.com/android-lesson-eight-an-introduction-to-index-buffer-objects-ibos/)

所以我希望生成的网格会像这样绘制：

```
 a----b----c
         |   /|   /|
         |  / |  / |
         | /  | /  |
         |/   |/   |
         d----e----f
         |   /|   /|
         |  / |  / |
         | /  | /  |
         |/   |/   |
         g----h----i 
```

通过使用以下方法绘制它：

```
glDrawElements(GL_LINE_STRIP, indexCount, GL_UNSIGNED_SHORT, 0); 
```

...因为我希望 GL_Line_Strip 首先从 (a->d) 绘制一条线，然后从 (d->b) 绘制一条线，然后从 (b, e)... 等等（在索引计算中指定）

但实际绘制的是：

```
 *----*----*
         |\   |\   |
         | \  | \  |
         |  \ |  \ |
         |   \|   \|
         *----*----*
         |\   |\   |
         | \  | \  |
         |  \ |  \ |
         |   \|   \|
         *----*----* 
```

所以三角形以错误的顺序绘制，我需要知道为什么？;)。有人知道吗？问题在于使用 GL_Line_Strip 还是我的代码中存在错误？

我的眼睛在 (0.0f, 0.0f, 20.0f) 并看着 (0,0,0)。*网格从左到右*沿 x 轴和 y 轴绘制，z = 0，因此不应翻转网格或任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:27:18.983

您是否记得考虑到 opengl 的 0,0 是左下角而不是左上角（如 Core Graphics）？*坐标系原点和惯用手很*重要 - 并且可以导致您看到的镜像。

# html - 关于提交 HTML 表单

> ID：13746377
> 
> 赞同：0
> 
> 时间：2012-12-06T15:01:59.080
> 
> 标签：html

有一个 HTML 表单，它有一些文本输入字段和 2 个按钮，说是和否。不是先访问 URL 然后填写表单，而是如何填写我需要填写的那些文本字段并执行操作单个 URL 中的任一按钮？

例如，以这种形式为例：有 2 个字段 text1 和 text2。

[http://www.mysite.com?text1=value1&text2=value2](http://www.mysite.com?text1=value1&text2=value2)

在上面的例子中（希望是对的）如何添加按钮操作也是我的问题。感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:04:56.433

通常是/否选项用一对单选按钮表示。根据单选按钮的名称，这些值将与表单提交一起自动发回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:07:46.413

使用提交输入而不是按钮。

```
<form>
<input type="submit" name="submitbutton" value="Yes" />
<input type="submit" name="submitbutton" value="No" />
</form> 
```

然后，您可以使用 PHP、JSP、ASP 或任何您的服务器端语言获取用户按下的按钮来发送表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:08:25.217

除非您可以控制显示表单的文件，否则这是不可能的。如果您确实可以控制该文件，我可以向您展示如何使用 JavaScript。不过，使用服务器端语言填写表单会更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:25:36.283

可以通过javascript完成：

将 input type=hidden 放入表单中，然后用按钮填充值并在此之后立即提交。

```
<form name="name_of_form" action="" method="GET">
<input type="hidden" name="button_value" value=""  id="hidden_value" />
<button type="button" onclick="javascript:submit_form('yes');">Yes</button>
<button type="button" onclick="javascript:submit_form('no');">No</button>
</form> 
```

并在顶部某处添加这个 JS 函数

```
function submit_form(yesno)
{
    document.getElementById('hidden_value').value=yesno;
    document.name_of_form.submit();
} 
```

注意：虽然它应该可以工作，但我不能确定，因为我对 JS 很烂。

# c++ - 无法在 Eclipse Juno 8.1.1 CDT C++ 项目中添加静态库

> ID：13746380
> 
> 赞同：0
> 
> 时间：2012-12-06T15:02:04.243
> 
> 标签：c++, eclipse, linker, static-libraries, eclipse-cdt

我一直在尝试查找如何将静态库链接到我的 Eclipse CDT 项目的指南，但我找不到。我已经尝试过使用 Visual Studio 2010 编译器和 MiNGW。

我使用 Windows 和 Eclipse Juno 8.1.1 ，在 Project Settings -> C/C++ Build -> Settings 我有这样的东西：

![在此处输入图像描述](../Images/dfd985238bce83623c13b3ee5d480ff0.png)

图书馆经理：

![在此处输入图像描述](../Images/f81a42c395485a165b2aaff3933da624.png)

路径和符号：

![在此处输入图像描述](../Images/cda2207a108f7baa2acaeb90ff6298a2.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:28:00.730

您必须在库 (-l) 中添加不带 lib 和 .a 的库名称，并在库搜索路径 (-L) 中添加路径。

然而，这个问题也在[这个](https://stackoverflow.com/questions/4952403/link-static-lib-in-eclipse-cdt)堆栈中得到了解决。

同样在这个[站点](http://webcourse.cs.technion.ac.il/234122/Spring2012/en/faq_Working%20with%20Eclipse%20CDT.html)中，您可以找到很多有用的信息以及有关如何包含链接库的说明。

**编辑**

如文档中所述：

> 问：如何将静态库文件添加到项目中？（文件如 libmtm.a）
> 
> A. 首先，您需要将该文件复制到您的 Eclipse 项目中。您可以通过简单地将其拖到 Eclipse 的“项目资源管理器”树中的项目文件夹中来做到这一点。链接库（静态库的使用与目标文件类似）：
> 
> 1.  打开项目，属性。
> 2.  在该对话框中选择“C++ 构建，设置”。
> 3.  在“工具设置”选项卡下选择“链接器”或“MinGW C 链接器”或等效项，然后选择“库”。
> 4.  在“库”下，按“添加...”按钮（绿色十字）并写下不带“lib”前缀和“.a”后缀的库名称。例如，为了链接库文件 libmtm.a 写入“mtm”。
> 5.  在“库搜索路径”下按“添加...”按钮，选择工作区并选择项目。

# c++ - C++/内联汇编中的运行时修补

> ID：13746384
> 
> 赞同：3
> 
> 时间：2012-12-06T15:02:16.800
> 
> 标签：c++, inline-assembly

我正在尝试修补函数`cat()`以返回 true，但由于某种原因，当我什至不调用该函数时程序崩溃。问题是我的修补方法吗？我想我写的是正确的地址（函数的地址是 004012e4）。我在 Windows XP 32 位系统上使用代码块 (gcc)。

```
#include <iostream>
#include <windows.h>
#include <stdlib.h>
#include <stdio.h>
using namespace std;

int cat()
{
    cout<<"false"<<endl;
    return false;
}

int main()
{
    DWORD beef;
    int (*css)();
    css=cat;
    cout<<css<<endl;
    system("PAUSE");
    VirtualProtect(&css,49,PAGE_EXECUTE_READWRITE,&beef);
    asm("mov $0x40130f,%eax");//move address of the mov $0x0,eax instruction to eax
    asm("movl $0x1,(%eax)");//write at address changing B800 to B801 or return true

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:22:46.807

为什么要硬编码函数地址？你有它的代码，你正在打印出来。如果您打印它然后更改代码以包含您打印的内容，则您可能会移动该功能。为什么不只是动态生成汇编语句？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:37:39.747

我对此不是 100%，但我很确定代码段*没有*映射到数据选择器。x86 CPU 中的默认数据选择器段被调用`ds`，但代码位于选择器寄存器上`cs`。出于安全原因（也可能是虚拟内存空间原因），我相信代码通常不会映射到同一空间。

不熟悉 GCC asm，但这样的事情可能会奏效：

```
asm("mov $0x40130f,%eax");
asm("push %%fs");
asm("mov %%cs,%%fs");   // Not sure you can address memory using cs:eax directly...
asm("movl $0x1,%%fs:(%eax)");
asm("pop %%fs"); 
```

自从我编写汇编程序以来已经有很长时间了，但是您可能会看到我在说什么。

# extjs - 将 roweditor 切换为始终对所有行处于活动状态

> ID：13746386
> 
> 赞同：1
> 
> 时间：2012-12-06T15:02:23.453
> 
> 标签：extjs, extjs4

有没有办法为所有可见行激活行编辑器（或单元编辑器）？我研究了 API，但什么也没找到。我还尝试将激活点击设置为 0，但没有任何成功。我需要一直显示一个复选框、一个组合框和一个微调框。

那能做到吗？或者有没有其他插件可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:20:26.707

据我所知，现在有办法做到这一点，并将**clicksToEdit**设置为低于 1 或大于 2 的任何值都是无效的。

如果您想要存档类似的内容，您可能需要通过扩展 roweditor 来编写自己的插件。

# image - 在 AS3 中使坠落的物体以随机角度出现

> ID：13746389
> 
> 赞同：0
> 
> 时间：2012-12-06T15:02:28.613
> 
> 标签：image, actionscript-3, object, random, angle

我正在制作一个导弹防御类型的游戏，并试图让导弹以随机的角度落下。我还需要子弹图像以我拍摄的角度转动。我对 AS3 中的角度非常陌生，所以我需要一些帮助。

代码：

```
 import spark.components.Image;

        public var missiles:Array;
        public var bullets:Array;
        public var playerLife:Number;

        public var targetX:Number;
        public var targetY:Number;

        public function init():void {
            startGame();
        }

        public function onEnterFrame(e:Event):void { 

            if(Math.random() <.05 ){

                //make a new missle
                var newMissile:Image = new Image();

                //draw to is
                newMissile.source = "assets/missileDown.jpg";

                //position it
                newMissile.x = Math.random() * stage.stageWidth;

                //animate it
                newMissile.addEventListener(Event.ENTER_FRAME, onMissileEnterFrame);

                //add it to missle array
                missiles.push(newMissile);

                //add it to the screen
                gameGroup.addElement(newMissile);
            }
        }

        public function startGame():void {

            //makes new arrays
            //gets rid of old arrays
            missiles = new Array();
            bullets = new Array();

            //set player life
            playerLife = 5;

            //show player life
            playerHealth.text = String(playerLife);

            //add animation and mouse interation
            this.addEventListener(Event.ENTER_FRAME, onEnterFrame);
            stage.addEventListener(MouseEvent.CLICK, fireWeapon);

            //set game over alpha
            gameEnd.alpha = 0;
            reset.alpha = 0; 

            //set game start alpha
            playerHealth.alpha = 1;
            healthLabel.alpha = 1;
        }

        //updates the missle
        public function onMissileEnterFrame(e:Event):void {

            //reference to target
            var targetMissile:Image = Image(e.currentTarget);

            //move missle down
            targetMissile.y += 10;

            //if missle has gone too far, remove it and player loses life
            if(targetMissile.y > stage.stageHeight) {
                playerLife --;
                removeMissile(targetMissile);

                //show player life
                playerHealth.text = String(playerLife);
            }

            //if player is dead, game over
            if(playerLife <= 0) {
                gameOver();
            }

        }

        //update bullet
        public function onBulletEnterFrame(e:Event):void {

            //get reference to bullet
            var thisBullet:Bullet = Bullet(e.currentTarget);

            //animate towards point..

            //calculate difference between current position and desired position
            var diffX:Number =  thisBullet.targX - thisBullet.x;
            var diffY:Number =  thisBullet.targY - thisBullet.y;

            //move 10% of difference closer
            thisBullet.x += diffX * .1;
            thisBullet.y += diffY * .1;

            //chekc for overlap between bullet and missles
            for(var i:Number = 0; i < missiles.length; i++) {

                //if they do overlap, remove missle
                if( thisBullet.hitTestObject(missiles[i]) ) {
                    removeMissile(missiles[i]);
                    removeBullet(thisBullet);
                    break;
                }
            }

            //if we're 'close enough' to the target position, remove bullet
            if(Math.abs(diffX) <  10 && Math.abs(diffY) < 10) {
                removeBullet(thisBullet);
            }
        }

        //gets rid of a missle
        public function removeMissile(targetMissile:Image):void {

            //removes the missle from the missiles array
            for(var i:Number = missiles.length - 1; i >= 0; i--) {
                if(missiles[i] == targetMissile) {
                    missiles.splice(i,1);
                    break;
                }
            }

            //don't animate anymore
            targetMissile.removeEventListener(Event.ENTER_FRAME, onMissileEnterFrame);

            //remove from stage
            gameGroup.removeElement(targetMissile);
        }

        //removes bullet from stage
        public function removeBullet(targetBullet:Bullet):void {

            //stop animation
            targetBullet.removeEventListener(Event.ENTER_FRAME, onBulletEnterFrame);

            //remove from stage
            gameGroup.removeElement(targetBullet);
        }

        //shoot a bullet at the mouse position
        public function fireWeapon(e:MouseEvent):void {

            //make a new bullet
            var newBullet:Bullet = new Bullet();
            newBullet.addEventListener(Event.ENTER_FRAME, onBulletEnterFrame);

            //position near the earth in the center
            var halfStage:Number = stage.stageWidth / 2;
            newBullet.x = halfStage;
            newBullet.y = 500;

            //set target 
            newBullet.targX = stage.mouseX;
            newBullet.targY = stage.mouseY;

            //add it to the stage
            gameGroup.addElement(newBullet);

        }

        //you lose
        public function gameOver():void {

            //remove missles
            for(var i:Number = 0; i < missiles.length; i++) {
                removeMissile(missiles[i]);
            }

            //stop interaction
            stage.removeEventListener(MouseEvent.CLICK, fireWeapon);

            //stop animation
            this.removeEventListener(Event.ENTER_FRAME, onEnterFrame);

            //set game start alpha
            playerHealth.alpha = 0;
            healthLabel.alpha = 0;

            //set game end alpha
            gameEnd.alpha = 1;
            reset.alpha = 1; 
        }

    ]]>
</fx:Script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:58:41.160

onEnterFrame

```
...
//position it
newMissile.x = Math.random() * stage.stageWidth;
//rotate it
newMissile.rotation = - (Math.random() * 60 - 30); 
```

onMissileEnterFrame

```
...
//move missle down
//targetMissile.y += 10;
targetMissile.x -= 10 * Math.sin(targetMissile.rotation * Math.PI/180);
targetMissile.y += 10 * Math.cos(targetMissile.rotation * Math.PI/180); 
```

火器

```
...
//set target 
newBullet.targX = stage.mouseX;
newBullet.targY = stage.mouseY;
newBullet.rotation = - Math.atan((newBullet.x - newBullet.targX) / (newBullet.y - newBullet.targY)) * 180/Math.PI; 
```

# javascript - 使用多个 .each 函数获取字符串到数组

> ID：13746393
> 
> 赞同：0
> 
> 时间：2012-12-06T15:02:31.893
> 
> 标签：javascript, jquery, arrays

我有两个元素，里面会有字符串。（我使用 .each` 函数）

问题是第二个数组（在得到字符串之后`.each`）是替换第一个数组。

对不起，如果您不明白，但请尝试往下看...

```
$('div').each(function () {
    var data = [];
    $('li', this).each(function () {
        data.push($(this).text());
    });
    var data_length = data.length;
    $(this).children("code").html(data + "");
    $("code").click(function () {
        data.move(data_length - 1, 0);
        $(this).html(data + "");
    });
});

Array.prototype.move = function (old_index, new_index) {
    if (new_index >= this.length) {
        var k = new_index - this.length;
        while ((k--) + 1) {
            this.push(undefined);
        }
    }
    this.splice(new_index, 0, this.splice(old_index, 1)[0]);
    return this; // for testing purposes
}; 
```

演示：http: [//jsfiddle.net/kdpN7/](http://jsfiddle.net/kdpN7/)

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:08:49.563

出于同样的原因，您`$(this).children('code')`还应该将单击事件与范围绑定。

问题是，您正在迭代 2 个 div（您的`each`），这意味着您要绑定`$('code')`两次。第一次`code`绑定点击，它与第一个数据数组（1）绑定，然后第二次与（2）绑定。因此，它首先为 1 执行您的点击代码，然后立即为 2 运行它，从而覆盖。更改为`$(this).find("code")`（或`children`），它按预期工作。

[http://jsfiddle.net/kdpN7/1/](http://jsfiddle.net/kdpN7/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:09:46.237

在这条线上：

```
$("code").click(function () { ... 
```

这是告诉`code`用该信息更新所有内容。您需要更改它，使其特定于每个 div：

```
$(this).find("code").click(function () { ... 
```

更新小提琴：http: [//jsfiddle.net/kdpN7/2/](http://jsfiddle.net/kdpN7/2/)

# reporting-services - VS 2010中的RDLC，如何在表格行中显示动态数据

> ID：13746396
> 
> 赞同：2
> 
> 时间：2012-12-06T15:02:35.997
> 
> 标签：reporting-services, reporting, rdlc, dynamic-rdlc-generation

我准备好了报告和数据。该报告就像我需要从 DDLB 中选择一个中心名称（例如：Raleigh(0003)）。我会提交的。现在我将得到罗利中心的报告。在这里，我需要查看报告顶部的文本，例如“罗利的天气报告 (0003)”作为标题。每当我选择不同的中心时，它应该会自动在报告顶部显示该特定中心。我尝试添加表格，从数据集中给出列 (CENTER_ID)，在表达式中，我给出了 --> ="Weather details:"& Fields!CENTER_ID.Value &" - " & Fields!CENTER_NAME.Value . 这是问题所在，它要么逐行显示所有中心，要么显示特定中心名称，而与选择无关。请帮助我，因为它非常重要。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T05:38:22.290

当您从下拉列表中选择一个中心时 - 它正在填充一个参数，您必须使用该参数来过滤查询或过滤表。根据完整查询返回的行数，最好选择其中一个，例如，如果有 1000 行，您应该过滤查询，而不是 tablix。如果行数不多，则可以过滤 tablix。

如果参数被称为 @center 那么你可以在你的标题中使用这个公式：

```
="Weather details: "& Parameters!center.value 
```

这假设您的参数是“文本”类型。如果它是数字或日期，那么您可能必须首先使用 CStr() 将其转换为字符串。

```
="Weather details: "& CStr(Parameters!center.value) 
```

它向您显示“与选择无关的特定中心名称”的原因是因为您告诉它将数据集列（多行）放入单个单元格中。这将迫使它始终在第一行中显示值，或者如果您将其放在 tablix 的详细信息行中，它将输出每个值。

如果您过滤查询而不是 tablix，您可以可靠地使用它：

```
 ="Weather details:"& First(Fields!CENTER_ID.Value,"datasetname") &" - " & First(Fields!CENTER_NAME.Value,"datasetname") 
```

因为 first() 函数将从数据集的第一行返回单个值。

# c# - 获取显示桌面切换的状态

> ID：13746397
> 
> 赞同：1
> 
> 时间：2012-12-06T15:02:38.463
> 
> 标签：c#, taskbar

如何获取 Show-Desktop 切换的状态？

目标：

> 切换显示桌面并显示桌面时显示任务栏 切换显示桌面并恢复窗口时隐藏任务栏

问题：

> 我可以切换显示桌面，也可以显示或隐藏任务栏，但我找不到确定“显示桌面”切换状态的方法。

我正在使用 .net 2.0 在 VS 2010 中使用 C#（如果它必须有更高版本的 .net 可以，但我怀疑答案在 win32 中的某个地方，带有 pinvoke。只是找不到它）

此应用程序适用于触摸屏，几乎不可能访问自动隐藏的任务栏。通常任务栏是隐藏的，但用户希望在单击显示桌面时访问它。（即请不要在 Windows 上发表非建设性评论，不希望您在未经用户许可的情况下更改自动隐藏状态）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T13:29:49.950

技术上满足我的项目要求但不符合他们意图的半解决方案：

在显示桌面切换时显示开始菜单。当然，当您单击其他任何地方时，开始菜单会消失，但是...它已显示。

有几个关于如何做到这一点的教程。[只是谷歌](http://hanssens.com/2012/show-and-hide-taskbar-and-start-menu-in-c/)

# ios - iOS 6.0 地图偶尔崩溃

> ID：13746402
> 
> 赞同：3
> 
> 时间：2012-12-06T15:03:04.627
> 
> 标签：ios, ios6, apple-maps

我的应用程序在 iOS 5.0 上运行良好，但是当我在 iOS 6.0 上运行相同的应用程序时，它偶尔会崩溃，我注意到的两个实例是：

1.  有时从 MapViewController 回来时，或者
2.  当我退出应用程序时，禁用应用程序的定位服务并再次打开应用程序。

但这并不总是发生。以下是控制台上显示的内容，尝试搜索解决方案，即使发现不少 iOS 6.0 崩溃帖子，也无法纠正崩溃。

```
Dec  6 20:06:51 iPhone kernel[0] <Debug>: launchd[896] Container: /private/var/mobile/Applications/F8E3963A-2678-4698-B5B9-2F2BB42D82B3 (sandbox)
Dec  6 20:06:58 iPhone locationd[41] <Notice>: Location icon should now be in state 'Active'
Dec  6 20:07:08 iPhone locationd[41] <Notice>: Location icon should now be in state 'Inactive'
Dec  6 20:07:16 iPhone locationd[41] <Notice>: Location icon should now be in state 'Active'
Dec  6 20:07:26 iPhone locationd[41] <Notice>: Location icon should now be in state 'Inactive'
Dec  6 20:08:36 iPhone locationd[41] <Notice>: Location icon should now be in state 'Active'
Dec  6 20:08:39 iPhone MyApp[896] <Warning>: MESH TOO LARGE!!! VKRoadTile: Too many road points for tile 1465.949.11 (512)
Dec  6 20:08:46 iPhone locationd[41] <Notice>: Location icon should now be in state 'Inactive'
Dec  6 20:09:37 iPhone locationd[41] <Notice>: Location icon should now be in state 'Active'
Dec  6 20:09:47 iPhone locationd[41] <Notice>: Location icon should now be in state 'Inactive'
Dec  6 20:10:07 iPhone backboardd[52] <Warning>: CoreAnimation: updates deferred for too long
Dec  6 20:10:16 iPhone awdd[905] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary
Dec  6 20:10:16 iPhone awdd[905] <Error>: CoreLocation: CLClient is deprecated. Will be obsolete soon.
Dec  6 20:10:20 iPhone ReportCrash[906] <Notice>: Formulating crash report for process MyApp[896]
Dec  6 20:10:20 iPhone com.apple.launchd[1] (UIKitApplication:com.cert.mobile.MyApp[0xce94][896]) <Warning>: (UIKitApplication:com.cert.Mobile.MyApp[0xce94]) Job appears to have crashed: Segmentation fault: 11
Dec  6 20:10:20 iPhone backboardd[52] <Warning>: Application 'UIKitApplication:com.Cert.mobile.MyApp[0xce94]' exited abnormally with signal 11: Segmentation fault: 11
Dec  6 20:10:20 iPhone ReportCrash[906] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary
Dec  6 20:10:20 iPhone ReportCrash[906] <Notice>: Saved crashreport to /var/mobile/Library/Logs/CrashReporter/MyApp_2012-12-06-201019_iPhone.plist using uid: 0 gid: 0, synthetic_euid: 501 egid: 0 
```

**这似乎在崩溃之前再次出现**：libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary

为什么在 iOS 6.0 上会发生这种情况，我应该如何解决？当出现以下消息时会发生什么：“Could not lookup ReleaseType from system version dictionary”？

# ruby-on-rails - 循环遍历相关模型并比较 id

> ID：13746403
> 
> 赞同：0
> 
> 时间：2012-12-06T15:03:05.450
> 
> 标签：ruby-on-rails, for-loop

关系是一个用户有很多治疗，一个治疗属于用户，一对多。

现在我想打印出所有有这种特殊待遇的用户

在我的治疗`show`视图中，我有这个双循环

```
<% User.all do |user| %> 

  <%= user.treatments.each do |t| %> 

    <% if (t.id).to_i == (@treatment.id).to_i %> 
      <%= link_to user.name, user_path(user) %><br />
    <% end %>

  <% end %>
<% end %> 
```

如果我更改`<% User.all do |user| %>`为`<%= User.all do |user| %>`它会打印出我的用户表中的所有内容

你们能发现为什么我没有得到任何用户吗？

我在内部循环的开头放了一条消息，它也没有显示，猜是问题在那里，但我没有看到它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:05:03.687

`.all`返回一个数组。数组不接受块。最有可能的是，您想做`.each`但忘记写了。试试这个：

```
<% User.all.each do |user| %> 
```

但更好的方法是不要像这样迭代所有用户，而是直接从数据库中获取正确的列表。

# excel - 使用 VBA 在 Excel 中打开 CSV 会导致数据出现在两列而不是一列中

> ID：13746404
> 
> 赞同：3
> 
> 时间：2012-12-06T15:03:12.027
> 
> 标签：excel, vba, csv

我在 Excel 2007/2010 中创建了 VBA 代码以从 CSV 文件导入数据。不幸的是，当我以编程方式打开文件时，对于某些数据行，数据被分成两列（A 和 B）。

当我手动打开 CSV 文件时，一切正常！

通常 CSV 数据如下所示（示例标题行）：

> TBWAKT；"TBWAKO"；"TBSAIS"；"TBSKU9"；"TBSMOD"；"TBLETT"；"TBKBNR"；"TBBEZ2"；"TBFAR2
> "；"TBSUGC"；"TBSOGC"；"TBEINK"；"TBKBGR"； “TBKBGF”；“TBVKPE”；“TBVKPR”；“TBEKPE
> ”；“TBAUAN”；“TBFAAN”；“TBREAN”；“TBSTAN”；“TBRUAN”；“TBKPAG”；“TBERDT”；“TBDATV”；“TBDATB "

导致问题的数据在文本中包含逗号。这是一个例子：

> JEAN 5 POCHES 可扩展+1,60M

这是代码：

```
Private Sub OpenCSV(x As Integer, wkbDashboard As String, wkbCsvImport As String, wksDestination As Worksheet)
' Opens CSV and copies data to current workbook
Dim wkbCsvImportName As String
Dim r As Range

Workbooks(wkbDashboard).Activate

' Open and read CSV
Workbooks.Open Filename:=wkbCsvImport, Format:=xlDelimited, Delimiter:=";"
wkbCsvImportName = ActiveWorkbook.Name 
```

问题截图。打开文件后，红色的东西在B列。
![在此处输入图像描述](../Images/b16ec1bb346c3243b2a18271a46f8d69.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-24T13:07:39.647

`Local:=True`在`Workbooks.Open`
希望这可能会有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:58:03.690

我仍然怀疑这是因为扩展名是 CSV。如果将文件重命名为 .txt 会发生什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:22:26.507

我认为当您手动执行此操作时，Excel 会将分隔符读取为“；” 而不仅仅是;。

尝试这个：

```
Workbooks.Open Filename:=wkbCsvImport, Format:=xlDelimited, Delimiter:=""";""" 
```

编辑：

我可以让它工作的唯一方法是将文件扩展名从 csv 更改为 txt，然后运行以下代码：

```
Workbooks.OpenText Filename:=wkbCsvImport, _
                    DataType:=xlDelimited, semicolon:=True 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-06T15:22:17.283

为了使用不是逗号的分隔符导入数据，您应该将`Format`属性设置为 6 以便能够定义您的，如此[处](http://msdn.microsoft.com/en-us/library/office/ff194819.aspx)`delimiter`所述。如果您直接设置为4 ，它也应该工作`Format`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-12T15:15:29.067

我知道两种可能的解决方法：

1）将扩展名从更改`.csv`为例如`.xxx`并像这样打开它：

```
Workbooks.OpenText fileName:="file.xxx", _
Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:=1, _
ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, _
Comma:=False, Space:=False, Other:=False, OtherChar:="", _
TrailingMinusNumbers:=True, Local:=True 
```

如果您使用`.csv`or `.xls`，则 excel 会通过操作系统的默认值覆盖设置。

2) 在 Windows 10 中，将您的区域设置从 更改`English - United States`为`English - United Kingdom`。奇怪的是它有帮助，高级日期/时间中的分隔符设置无关紧要。在 Windows 7 中，我认为分隔符设置有效。

# python - 如何在 unix 中运行 python 函数？

> ID：13746406
> 
> 赞同：0
> 
> 时间：2012-12-06T15:03:13.813
> 
> 标签：python, unix

> **可能重复：**
> [<if __name__==“__main__”:> 做什么？](https://stackoverflow.com/questions/419163/what-does-if-name-main-do)

每当我尝试在 unix 中运行我的 python 脚本时，什么都不会发生。我会按顺序输入一些东西

```
 $ python script.py 
```

而所有将被退回的是

```
 $ 
```

现在我知道这在我的代码中不是问题，因为它在空闲时运行良好，所以我认为我需要在我的代码中添加其他内容才能从命令行运行它。在关于 python 的谷歌教程中，我被介绍到样板代码，它被附加到函数的末尾

```
def main():
  print ...
  etc etc
if __name__ == '__main__':
  main() 
```

如果我编写一个名为 main 的函数并像这样运行它，它就可以正常工作。但是，当我将我的函数命名为其他名称时，它不会起作用。例如

```
def merge():
  print ..
  etc etc
if __name__ == '__merge__':
  merge() 
```

该函数根本不会在命令行上产生任何输出即使我只是从单词 main 的末尾删除了 n，但每次它出现在上面的 main 函数中时，它也不会起作用。如何让 python 函数在命令行上运行？python 到底是怎么回事？只让名为 main 的函数运行？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:05:50.417

从命令行运行 python 脚本时，__name__ 始终为 '__main__'。

尝试类似：

```
def merge():
  print ..
  etc etc
if __name__ == '__main__':
  merge() 
```

在 Python 解释器中，您必须执行以下操作：

```
>>> import script
>>> script.merge() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T15:06:46.127

```
__name__ == "__main__" 
```

不应该改变，如果你从同一个文件中运行代码，你有你的功能

```
if __name__ == "__main__":
    merge() 
```

如果您只是在另一个文件中导入该模块，请不要为此烦恼

[这个链接](http://ibiblio.org/g2swap/byteofpython/read/module-name.html)向你解释了更多

# android - 单击后如何将进度对话框显示为按钮的背景？

> ID：13746407
> 
> 赞同：0
> 
> 时间：2012-12-06T15:03:16.963
> 
> 标签：android, progressdialog

我的应用程序中有一个按钮。单击按钮后，我想显示一个替换按钮的进度对话框。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:13:41.217

```
<FrameLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">

    <Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <ProgressBar
        android:id="@+id/progressbar"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="gone" />
</FrameLayout> 
```

On button click:

```
findViewById(R.id.button).setVisibility(View.GONE)
findViewById(R.id.progressbar).setVisibility(View.VISIBLE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:16:50.857

您可以通过布局xml在同一位置创建按钮和进度条，并将进度条的可见性设置为`GONE`。

现在在`onClick()`按钮的方法中，设置

```
button.setVisibility(View.GONE)
progressbar.setVisibility(View.VISIBLE) 
```

# r - 如果我是唯一的用户，请避免 ROAuth 握手中的 PIN 步骤？

> ID：13746410
> 
> 赞同：4
> 
> 时间：2012-12-06T15:03:28.633
> 
> 标签：r, twitter, oauth, twitter-oauth, roauth

**问题**：有没有办法避免在进行 OAuth 握手时手动输入 PIN？

**上下文**：在进行 ROAuth 握手时，我被要求输入通过以下链接获得的 PIN：

```
rm(list=ls())
library("twitteR")
library("ROAuth")

Credentials <- OAuthFactory$new(
  consumerKey = "...",
  consumerSecret = "...",
  oauthKey = "...",
  oauthSecret = "...",
  requestURL = "https://api.twitter.com/oauth/request_token",
  authURL = "https://api.twitter.com/oauth/authorize",
  accessURL = "https://api.twitter.com/oauth/access_token")

Credentials$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl")) 
```

哪个输出：

> Credentials$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl")) 要启用连接，请将您的网络浏览器指向： [https ://api.twitter.com/oauth /authorize?oauth_token=](https://api.twitter.com/oauth/authorize?oauth_token=) ... 完成后，记录给您的 PIN 并在此处提供：

我输入了一个 PIN。

我想避免这一步，因为每次我在新的 R 会话中运行脚本时，我都必须手动打开浏览器来检索 PIN。我是唯一使用这个脚本的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T15:26:52.097

执行握手后，您可以将对象保存到文件中...

```
save(Credentials, file="credentials.RData") 
```

稍后您可以使用 load() 将文件拉入并使用您原来的 Credentials 对象。

# asp.net-mvc - 对 IIS 上长时间运行的进程的担忧

> ID：13746411
> 
> 赞同：5
> 
> 时间：2012-12-06T15:03:36.840
> 
> 标签：asp.net-mvc, iis, asp.net-mvc-4, iis-7.5

**关注点：**

我已经阅读了描述 IIS 可以随时回收应用程序池的帖子/博客。这是否意味着（就 IIS 回收应用程序池而言）我调用长时间运行的同步或异步进程并不重要，因为 IIS 可以回收应用程序池并终止长时间运行的进程？如果是这种情况，确保不会发生这种情况的常见途径是什么？

**例子**

```
public Task<ActionResult> LongRunningProcessAsync(SubmitFileModel aModel)

    {
        return Task.Run( () => LongRunningProcess( aModel) );
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:35:32.587

[HostingEnvironment](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.aspx)有一个静态方法[RegisterObject](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.registerobject.aspx)，它允许您将对象放置在应用程序的已注册对象列表中。

[根据菲尔·哈克...](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)

> 当 ASP.NET 拆除 AppDomain 时，它会首先尝试对所有已注册的对象调用 Stop 方法……当 ASP.NET 调用此方法时，您的代码需要阻止此方法返回，直到您的工作完成。

或者，您可以创建一个不由 IIS 托管的服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-10T17:07:52.793

> 如果是这种情况，确保不会发生这种情况的常见途径是什么？

您的应用程序域将在回收过程中卸载，无论是否使用该`RegisterObject`方法。它只会给你的后台工作一些时间来完成（默认为 30 秒）。如果您有超过这个“一段时间”的长时间运行的作业，它将被中止，并且没有人会关心重新启动时自动重试。

如果你想在你的 ASP.NET 应用程序中运行长时间运行的作业，想保持简单，忘记 ASP.NET/IIS 问题，看看[HangFire——](http://hangfire.io)它使用持久存储（SQL Server 或 Redis）并且对回收过程。

# android - 单击按钮时防止 DialogFragment 关闭

> ID：13746412
> 
> 赞同：45
> 
> 时间：2012-12-06T15:03:37.710
> 
> 标签：android, dialog, onclick, android-dialogfragment

我有一个带有自定义视图的 DialogFragment，其中包含两个文本字段，用户将在其中输入用户名和密码。单击肯定按钮时，我想验证用户在关闭对话框之前是否确实输入了某些内容。

```
public class AuthenticationDialog extends DialogFragment {

    public Dialog onCreateDialog(Bundle savedInstanceState) {
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        LayoutInflater inflater = getActivity().getLayoutInflater();
        builder.setView(inflater.inflate(R.layout.authentication_dialog, null))
            .setPositiveButton(getResources().getString(R.string.login), new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    // TODO
                }
            })
            .setNegativeButton(getResources().getString(R.string.reset), new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    // TODO
                }
            });

        return builder.create();
    }
} 
```

那么如何防止对话框消失呢？有什么我应该重写的方法吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-03-25T15:53:50.257

覆盖 OnStart() 中的默认按钮处理程序来执行此操作。

```
@Override
public Dialog onCreateDialog(Bundle savedInstanceState)
{
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
    builder.setMessage("Test for preventing dialog close");
    builder.setPositiveButton("Test", 
        new DialogInterface.OnClickListener()
        {
            @Override
            public void onClick(DialogInterface dialog, int which)
            {
                //Do nothing here because we override this button later to change the close behaviour. 
                //However, we still need this because on older versions of Android unless we 
                //pass a handler the button doesn't get instantiated
            }
        });
    return builder.create();
}

@Override
public void onStart()
{
    super.onStart();    //super.onStart() is where dialog.show() is actually called on the underlying dialog, so we have to do it after this point
    AlertDialog d = (AlertDialog)getDialog();
    if(d != null)
    {
        Button positiveButton = (Button) d.getButton(Dialog.BUTTON_POSITIVE);
        positiveButton.setOnClickListener(new View.OnClickListener()
                {
                    @Override
                    public void onClick(View v)
                    {
                        Boolean wantToCloseDialog = false;
                        //Do stuff, possibly set wantToCloseDialog to true then...
                        if(wantToCloseDialog)
                            dismiss();
                        //else dialog stays open. Make sure you have an obvious way to close the dialog especially if you set cancellable to false.
                    }
                });
    }
} 
```

在此处查看我的答案[https://stackoverflow.com/a/15619098/579234](https://stackoverflow.com/a/15619098/579234)以获取有关其他对话框类型的更多解释和示例。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-01-13T10:37:01.840

这是 Karakuri 和 Sogger 答案的“甜蜜点”解决方案。Karakuri 在正确的轨道上，但是如果已经显示，您只能以这种方式获取按钮（否则为 null，如评论中所述）。这就是 Sogger 的答案有效的原因，但是我更喜欢以相同的方法进行设置，`onCreateDialog`即`onStart`. 解决方案是将按钮的获取包装到`OnShowListener`对话框中。

```
public Dialog onCreateDialog(Bundle savedInstanceState) {
  AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
  // your dialog setup, just leave the OnClick-listeners empty here and use the ones below

  final AlertDialog dialog = builder.create();
  dialog.setOnShowListener(new DialogInterface.OnShowListener() {
    @Override
    public void onShow(final DialogInterface dialog) {
      Button positiveButton = ((AlertDialog) dialog).getButton(DialogInterface.BUTTON_POSITIVE);
      positiveButton.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(final View v) {
          // TODO - call 'dismiss()' only if you need it
        }
      });
      Button negativeButton = ((AlertDialog) dialog).getButton(DialogInterface.BUTTON_NEGATIVE);
      // same for negative (and/or neutral) button if required
    }
  });

  return dialog;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-06T19:47:17.383

感谢 Luksprog，我找到了解决方案。

**AuthenticationDialog.java**：

```
public class AuthenticationDialog extends DialogFragment implements OnClickListener {

    public interface AuthenticationDialogListener {
        void onAuthenticationLoginClicked(String username, String password);
        void onAuthenticationResetClicked(String username);
    }

    private AuthenticationDialogListener mListener;

    private EditText mUsername;
    private EditText mPassword;
    private Button mReset;
    private Button mLogin;

    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.authentication_dialog, container);
        this.getDialog().setTitle(R.string.login_title);

        mUsername = (EditText) view.findViewById(R.id.username_field);
        mPassword = (EditText) view.findViewById(R.id.password_field);
        mReset = (Button) view.findViewById(R.id.reset_button);
        mLogin = (Button) view.findViewById(R.id.login_button);

        mReset.setOnClickListener(this);
        mLogin.setOnClickListener(this);

        return view;
    }

    public void onAttach(Activity activity) {
        super.onAttach(activity);
        // Verify that the host activity implements the callback interface
        try {
            // Instantiate the NoticeDialogListener so we can send events to the host
            mListener = (AuthenticationDialogListener) activity;
        } catch (ClassCastException e) {
            // The activity doesn't implement the interface, throw exception
            throw new ClassCastException(activity.toString()
                    + " must implement AuthenticationDialogListener");
        }
    }

    public void onClick(View v) {
        if (v.equals(mLogin)) {
            if (mUsername.getText().toString().length() < 1 || !mUsername.getText().toString().contains("@")) {
                Toast.makeText(getActivity(), R.string.invalid_email, Toast.LENGTH_SHORT).show();
                return;
            } else if (mPassword.getText().toString().length() < 1) {
                Toast.makeText(getActivity(), R.string.invalid_password, Toast.LENGTH_SHORT).show();
                return;
            } else {
                mListener.onAuthenticationLoginClicked(mUsername.getText().toString(), mPassword.getText().toString());
                this.dismiss();
            }
        } else if (v.equals(mReset)) {
            mListener.onAuthenticationResetClicked(mUsername.getText().toString());
        }
    }
} 
```

**authentication_dialog.xml**：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical" >
    <EditText
        android:id="@+id/username_field"
        android:inputType="textEmailAddress"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:layout_marginLeft="4dp"
        android:layout_marginRight="4dp"
        android:layout_marginBottom="4dp"
        android:hint="@string/username"
        />
    <EditText
        android:id="@+id/password_field"
        android:inputType="textPassword"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="4dp"
        android:layout_marginLeft="4dp"
        android:layout_marginRight="4dp"
        android:layout_marginBottom="12dp"
        android:fontFamily="sans-serif"
        android:hint="@string/password"
        />
    <View
        android:layout_width="fill_parent"
        android:layout_height="1dip"
        android:background="?android:attr/dividerVertical" 
        />
    <LinearLayout 
        style="?android:attr/buttonBarStyle"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:paddingTop="0dp"
        android:measureWithLargestChild="true" >
        <Button 
            android:id="@+id/reset_button"
            style="?android:attr/buttonBarButtonStyle"
            android:layout_height="wrap_content"
            android:layout_width="0dp"
            android:layout_weight="1.0"
            android:text="@string/reset"
            />
        <Button 
            android:id="@+id/login_button"
            style="?android:attr/buttonBarButtonStyle"
            android:layout_height="wrap_content"
            android:layout_width="0dp"
            android:layout_weight="1.0"
            android:text="@string/login"
            />
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-06T15:54:32.077

您可以再次弹出对话框。或者，您可以禁用肯定按钮，直到在两个字段中都有输入。如果您在`onCreateVew()`. 如果您改用`AlertDialog.Builder`该类，则可以像这样获得按钮的句柄：

```
AlertDialog.Builder builder = new AlertDialog.Builder(context);
/* ... */
Dialog dialog = builder.create();
Button positiveButton = ((AlertDialog) dialog).getButton(DialogInterface.BUTTON_POSITIVE);
/* now you can affect the button */ 
```

# javascript - 根据 URL 查询字符串有条件地打开弹出视频

> ID：13746416
> 
> 赞同：0
> 
> 时间：2012-12-06T15:03:41.080
> 
> 标签：javascript, jquery, url, parameters

我有一个页面（somepage.aspx），上面有一个弹出视频。使用js点击链接时视频打开`$('.showVideo').live('click', function() {`

我有另一个页面（otherpage.aspx），并想链接到`/somepage.aspx`某种自动打开视频弹出窗口的 URL 参数。类似于 /`somepage.aspx?video=1 ...`基于视频将打开的 url 参数的东西。我如何将它添加到我现有的 js 中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:11:32.537

使用此功能，您可以检测`?video=1`url 中是否存在：

```
function getURLParameter(name) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
} 
```

来源：[获取转义的 URL 参数](https://stackoverflow.com/questions/1403888/get-url-parameter-with-jquery) 归功于[https://stackoverflow.com/users/726427/pauloppenheim](https://stackoverflow.com/users/726427/pauloppenheim)

然后你可以做类似的事情：

```
if(getURLParameter('video')==1){
  $(".showVideo").trigger('click');
} 
```

编辑：

```
$(document).ready(function(){               

    function getURLParameter(name) {
        return decodeURI(
            (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
        );
    }
    if(getURLParameter('video')==1){
      $(".showVideo").trigger('click');
    }
}); 
```

将参数名称（视频）用引号括起来`getURLParameter('video')`。

另一个编辑

将您的单击事件处理程序包装在一个函数中，基本上删除所有形式：

```
$('.showVideo').live('click', function() {
    //build overlay
    (...)
    return false;
}); 
```

将其剪切并粘贴到函数中。然后只需从内部调用该函数：

```
$('.showVideo').live('click', function() {
    my_function();
}); 
```

然后把之前的代码改成：

```
if(getURLParameter('video')==1){
     my_function()
} 
```

# ruby-on-rails-3 - 使用带有弹性搜索和轮胎的 SQL

> ID：13746417
> 
> 赞同：1
> 
> 时间：2012-12-06T15:03:44.423
> 
> 标签：ruby-on-rails-3, elasticsearch, tire

使用我当前的设置，我需要添加一些自定义 SQL 语句，以使用 Tire Gem 限定一些数据。

我正在使用带有 Ruby 1.9.3 的 Rails 3.2

在我的列表控制器中，我有以下内容：

```
@listings = Listing.search() 
```

对于我的 Listing.rb，我使用了带有许多过滤器的搜索方法，例如：

```
def self.search(params={})
    tire.search(load: true, page: params[:page], per_page: 50) do |search|
      search.query  { string params[:query], :default_operator => "AND" } if params[:query].present?
      search.filter :range, posted_at: {lte: DateTime.now}
      search.filter :term, "property.rooms_available"   => params[:property_rooms_available]  if params[:property_rooms_available].present?
      search.filter :term, "property.user_state"        => params[:property_user_state]       if params[:property_user_state].present?

   ...
end 
```

我需要做的是将此 SQL 语句添加到搜索方法中，以便它的范围是经度和纬度。“坐标”通过 URL 中的参数以形式传入

```
http://localhost:3000/listings?coords=51.0000,-01.0000 52.0000,-02.0000 
```

（-01.0000 和 52.0000 之间有一个空格。）

目前我有：

```
 sql = "SELECT title, properties.id, properties.lng,properties.lat from listings WHERE ST_Within(ST_GeometryFromText('POINT(' || lat || ' ' || lng || ')'),ST_GeometryFromText('POLYGON((#{coords}))'));" 
```

我考虑过尝试通过这样的方式在控制器内限定它？

```
def self.polyed(coords)
    joins(:property).
    where("ST_Within(ST_GeometryFromText('POINT(' || properties.lat || ' ' || properties.lng || ')'),ST_GeometryFromText('POLYGON((#{coords}))'))").
    select("title, properties.id, properties.lng,properties.lat")
end 
```

和这个...

# Listings_controller.rb

```
def index
  @listings = Listing.polyed(poly_coordinates).search()
end 
```

它需要以 HTML 和 json 格式将结果作为@listings 返回

```
http://localhost:3000/listings.json? 
```

我已经在使用 RABL 来自动生成 json。

这可能吗？

提前谢谢了。

瑞安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T20:58:07.597

一种可能性是在选项中传递选项`joins`,`where`等`:load`。

但是如果你想在 Rails 代码中过滤返回的结果，一个更好的方法似乎是只加载带有 Tire 的记录 ID（使用`fields`选项来限制返回的字段），然后在你的 SQL 查询中使用它们。

# c++ - 无法使用 PGO 并出现错误 LNK1270

> ID：13746420
> 
> 赞同：2
> 
> 时间：2012-12-06T15:04:11.860
> 
> 标签：c++, visual-studio, visual-c++, visual-studio-2005, pgo

我正在尝试将 Profile Guided Optimization (PGO) 与 VS8 一起使用。在对有问题的 DLL 进行检测后，我将其复制到安装了我们的应用程序并运行训练场景的机器上。然后，我将**pgc**培训文件复制回我的开发箱并收到以下错误：

> 1>StdAfx.obj : 致命错误 LNK1270: 无效文件；时间戳与 /LTCG:PGINSTRUMENT 链接的文件不匹配

此错误的[MSDN](http://msdn.microsoft.com/en-us/library/9bwby8h5.aspx)条目说：

> 无效文件; 时间戳与使用 /LTCG:PGINSTRUMENT 链接的文件不匹配指定 /LTCG:PGINSTRUMENT 时传递给链接器的相同文件也必须在指定 /LTCG:PGOPTIMIZE 时传递。
> 
> /LTCG:PGOPTIMIZE 要求输入与 /LTCG:PGINSTRUMENT 阶段相同。
> 
> 要解决此警告，请运行 /LTCG:PGINSTRUMENT，重做所有测试运行，然后运行 ​​/LTCG:PGOPTIMIZE，或者使用 /LTCG:PGUPDATE 而不是 /LTCG:PGOPTIMIZE 创建优化的映像。

重新运行测试并不能解决问题（尽管它有时会出现在其他文件中，而不是 stdafx.obj）。

Using`/LTCG:PGUPDATE` *确实*有效，但是我想了解是什么导致了错误，或者失败了，使用`PGUPDATE`而不是有任何缺点（我在[MSDN PGO 页面](http://msdn.microsoft.com/en-us/library/e7k32f4k.aspx)`PGOPTIMIZE`中找不到任何相关内容）。

# c# - TPL FromAsync 与 TaskScheduler 和 TaskFactory

> ID：13746421
> 
> 赞同：5
> 
> 时间：2012-12-06T15:04:12.580
> 
> 标签：c#, .net, parallel-processing, task-parallel-library

我正在尝试结合 using 创建一个任务管道/有序调度程序`TaskFactory.FromAsync`。

我希望能够触发 Web 服务请求（`FromAsync`用于使用 I/O 完成端口）但保持它们的顺序并且在任何时候只有一个执行。

目前我不使用`FromAsync`，所以我可以做`TaskFactory.StartNew(()=>api.DoSyncWebServiceCall())`并依靠`OrderedTaskScheduler`使用的`TaskFactory`来确保只有一个请求是未完成的。

我假设使用该`FromAsync`方法时这种行为会保持不变，但事实并非如此：

```
TaskFactory<Stuff> taskFactory = new TaskFactory<Stuff>(new OrderedTaskScheduler());
var t1 = taskFactory.FromAsync((a, s) => api.beginGetStuff(a, s), a => api.endGetStuff(a));
var t2 = taskFactory.FromAsync((a, s) => api.beginGetStuff(a, s), a => api.endGetStuff(a));
var t3 = taskFactory.FromAsync((a, s) => api.beginGetStuff(a, s), a => api.endGetStuff(a)); 
```

所有这些`beginGetStuff`方法都在调用中被`FromAsync`调用（因此虽然它们是按顺序分派的，但`n`同时发生了 api 调用）。

有一个重载`FromAsync`需要一个TaskScheduler：

```
public Task FromAsync(
    IAsyncResult asyncResult,
    Action<IAsyncResult> endMethod,
    TaskCreationOptions creationOptions,
    TaskScheduler scheduler
) 
```

但文档说：

> 用于调度执行 end 方法的任务的 TaskScheduler。

正如您所看到的，它需要已经构建的`IAsyncResult`，而不是`Func<IAsyncResult>`.

这需要自定义`FromAsync`方法还是我错过了什么？谁能建议从哪里开始这个实现？

干杯，

编辑：

我想从调用者那里抽象出这种行为，因此，根据`TaskFactory`（使用专门的`TaskScheduler`）的行为，我需要立即返回 Task - 这个 Task 不仅会封装`FromAsync`Task，还会在等待时封装该任务的队列轮到执行了。

一种可能的解决方案：

```
class TaskExecutionQueue
{
    private readonly OrderedTaskScheduler _orderedTaskScheduler;
    private readonly TaskFactory _taskFactory;
    public TaskExecutionQueue(OrderedTaskScheduler orderedTaskScheduler)
    {
        _orderedTaskScheduler = orderedTaskScheduler;
        _taskFactory = new TaskFactory(orderedTaskScheduler);

    }

    public Task<TResult> QueueTask<TResult>(Func<Task<TResult>> taskGenerator)
    {
        return _taskFactory.StartNew(taskGenerator).Unwrap();
    }
} 
```

`FromAsync`但是，这会在调用发生时使用线程。理想情况下，我不必这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T18:11:02.867

最简单的方法是使用[TPL Dataflow](https://nuget.org/packages/Microsoft.Tpl.Dataflow)。

您可以定义一个接收异步委托流并一次执行一个的“块”（等到每个委托完成后再开始下一个委托）：

```
var block = new ActionBlock<Func<Task>>(func => func()); 
```

然后，触发 Web 服务请求：

```
block.Post(() => Task.Factory.FromAsync(...)); 
```

或（我更喜欢）：

```
block.Post(() => client.GetStuffAsync(a, b, c)); 
```

`ActionBlock`如果您只想执行任务，这种方法很好。如果要产生输出流，请查看`TransformBlock`：

```
var block = new TransformBlock<Func<Task<Stuff>>, Stuff>(func => func()); 
```

你以同样的方式触发你的请求，你可以通过调用`Receive`或得到结果`ReceiveAsync`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:22:57.383

您无法安排 IO 任务，因为它们没有与之关联的线程。Windows 内核提供无线程 IO 操作。启动这些 IO 不涉及托管代码，并且`TaskScheduler`类不会发挥作用。

所以你必须延迟启动 IO，直到你确定你真的想要网络被击中。您可以使用`SemaphoreSlim.WaitAsync`限制当前运行的任务数量。在启动单个 IO 之前等待该方法的结果并等待它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:05:47.707

我已经决定在这里定制一个解决方案......锁很乱而且不受欢迎，但目前，这可以完成我想要的工作。

```
public interface ITaskExecutionQueue
{
    Task<TResult> QueueTask<TResult>(Func<Task<TResult>> taskGenerator);
    Task<TResult> QueueTask<TResult>(Task<Task<TResult>> taskGenerator);
    int OutstandingTaskCount { get; }
    event EventHandler OutstandingTaskCountChanged;
}

/// This class ensures that only a single Task is executed at any one time.  They are executed sequentially in order being queued.
/// The advantages of this class over OrderedTaskScheduler is that you can use any type of Task such as FromAsync (I/O Completion ports) 
/// which are not able to be scheduled using a traditional TaskScheduler.
/// Ensure that the `outer` tasks you queue are unstarted.  E.g. <![CDATA[
/// _taskExeQueue.QueueTask(new Task<Task<TResult>>(() => StartMyRealTask()));
/// ]]>
class OrderedTaskExecutionQueue : ITaskExecutionQueue
{
    private readonly Queue<Task> _queuedTasks = new Queue<Task>();
    private Task _currentTask;
    private readonly object _lockSync = new object();

    /// <summary>
    /// Queues a task for execution
    /// </summary>
    /// <typeparam name="TResult"></typeparam>
    /// <param name="taskGenerator">An unstarted Task that creates your started real-work task</param>
    /// <returns></returns>
    public Task<TResult> QueueTask<TResult>(Func<Task<TResult>> taskGenerator)
    {
        return QueueTask(new Task<Task<TResult>>(taskGenerator));
    }

    public Task<TResult> QueueTask<TResult>(Task<Task<TResult>> taskGenerator)
    {
        Task<TResult> unwrapped = taskGenerator.Unwrap();
        unwrapped.ContinueWith(_ =>
                               {
                                   EndTask();
                                   StartNextTaskIfQueued();
                               }, TaskContinuationOptions.ExecuteSynchronously);

        lock (_lockSync)
        {
            _queuedTasks.Enqueue(taskGenerator);

            if (_currentTask == null)
            {
                StartNextTaskIfQueued();
            }
        }

        TaskCompletionSource<TResult> tcs = new TaskCompletionSource<TResult>();
        tcs.TrySetFromTaskIncomplete(unwrapped);

        OutstandingTaskCountChanged.Raise(this);

        return tcs.Task;
    }

    private void EndTask()
    {
        lock (_lockSync)
        {
            _currentTask = null;
            _queuedTasks.Dequeue();
        }

        OutstandingTaskCountChanged.Raise(this);
    }

    private void StartNextTaskIfQueued()
    {
        lock (_lockSync)
        {
            if (_queuedTasks.Count > 0)
            {
                _currentTask = _queuedTasks.Peek();

                _currentTask.RunSynchronously();
            }
        }
    }

    /// <summary>
    /// Includes the currently executing task.
    /// </summary>
    public int OutstandingTaskCount
    {
        get
        {
            lock (_lockSync)
            {
                return _queuedTasks.Count;
            }
        }
    }

    public event EventHandler OutstandingTaskCountChanged;
} 
```

接受一个未启动的`Task<Task<TResult>>`- 这允许队列决定何时执行它并开始`FromAsync`调用（这是内部任务）。用法：

```
Task<Task<TResult>> queueTask = new Task<Task<TResult>>(() => Task.Factory.FromAsync(beginAction, endAction));
Task<TResult> asyncCallTask = _taskExecutionQueue.QueueTask(queueTask); 
```

# perl - Perl 输入文件字符串匹配

> ID：13746423
> 
> 赞同：3
> 
> 时间：2012-12-06T15:04:16.620
> 
> 标签：perl

我对 Perl 很陌生，正在尝试编写一个脚本来搜索文件并检查/匹配来自其他输入文件的多个字符串。这是我现在所拥有的：

```
#! /css/dvltools/localperl/bin/perl

open CUMRT603, "CUMRT603";

my $meter, $my_cur_line;
while ( <CUMRT603> )
{
        $my_cur_line = $_;
        chomp $my_cur_line;

        open METER_LIST, "mlist";
        while ( <METER_LIST> )
        {
                $meter = $_;
                if ( $my_cur_line =~ /"$meter"/ )
                {
                        print "Found $meter on $my_cur_line";
                }
        }

        close METER_LIST;
} 
```

基本上，我正在 CUMRT603 中搜索列表 (mlist) 中的任何字符串。我无法让它显示任何字符串匹配项（应该至少有一个）。任何关于语法、结构等的建议都值得关注。这基本上是我的第一个 perl 脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:15:43.087

您需要告诉我们“无法正常工作”是什么意思。当你运行它时会发生什么？你得到什么结果？你期待什么结果？

一个大问题是您没有检查`open`. 如果文件无法打开，则其他任何操作都无法正常工作。你不会得到任何结果`<CURMT603>`，你会立即退出外`while`循环。的打开也是如此`METER_LIST`。

另外，你需要把

```
use warnings;
use strict; 
```

在您的程序顶部，以帮助您捕获拼写错误。否则，Perl 会让事情滑倒，因为它假设你知道得更好，但这里不是这样。

第三，使用三参数形式`open`并使用词法文件句柄。

第四，可以直接读入变量。您不必分配 from `$_`。

所以这里是你所拥有的快速重写。

```
use warnings;
use strict;

open( my $cur_file, '<', 'CURMT603' ) or die "Unable to open CURMT603: $!";

while ( my $cur_line = <$cur_file> ) {
    chomp $cur_line;
    open( my $meter_file, '<', 'mlist' ) or die "Can't open meter file: $!";
    while ( my $meter = <$meter_file> ) {
        if ( $my_cur_line =~ /"$meter"/ ) {
            print "Found $meter on $my_cur_line\n";
        }
    }
    close $meter_file;
}
close $cur_file; 
```

所以，尝试一下，现在使用新的文件处理和错误检查，看看效果如何。我敢打赌，在打开的文件上添加错误检查会发现你的问题。

最后一点：您不需要`mlist`每次通过文件一遍又一遍地重新读取同一个`CURMT603`文件，但这是另一次的优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T15:24:38.133

`chomp`您的输入缺少 a `$meter`，因此大概它永远无法匹配 chomped`$my_cur_line`变量。

此外，您的正则表达式中的那些双引号将按字面意思解释，因此如果`$meter`是`foo`，它将尝试匹配`"foo"`，我不确定这是您想要的。

此外，您可能希望防止在匹配的文本中使用元字符，这可以使用 quotemeta 或`\Q ... \E`.

因此，简而言之，您的代码可能应该是：

```
chomp $meter;
if ( $my_cur_line =~ /\Q$meter\E/ ) 
```

你也真的应该使用

```
use strict;
use warnings; 
```

较短的学习曲线对节省的调试时间起到了重要作用。

# css - 带边距的页面 CSS 宽度

> ID：13746426
> 
> 赞同：0
> 
> 时间：2012-12-06T15:04:23.890
> 
> 标签：css

> **可能重复：**
> [左右边距为 100%](https://stackoverflow.com/questions/7394484/margin-left-and-right-on-with-100)

我有一个文本框，我想填充页面的宽度，但我需要它有一个相当大的左边距，以呈现缩进的外观。所以如果我有这样的风格：

```
.notesText {
        margin-left: 20px;
        width: 100%;
    } 
```

我最终将页面向右扩展了 20px 以容纳我的文本框，而不是仅填充页面现有宽度的文本框。由于页面宽度因设备而异，如何将其格式化为具有 20 像素的左边距，然后填充页面的剩余空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:13:23.143

尝试`margin-left: 5%; width: 95%;`

这将为您提供可变的边距，这可能是也可能不是您想要的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:10:27.843

由于没有`box-sizing: margin-box`，我认为您需要做的是在 的外包装上设置边距`textarea`：

```
<label class="message">
    Message<br>
    <textarea ...></textarea>
</label>

label.message {
    display: block;
    padding: 0 20px;
}

    label.message textarea {
        box-sizing: border-box;
        width: 100%;
    } 
```

# android - 删除死的内容提供者：联系人

> ID：13746429
> 
> 赞同：2
> 
> 时间：2012-12-06T15:04:26.363
> 
> 标签：android, android-contentprovider, android-contacts

我正在尝试从我的设备电话簿中获取所有详细信息（电子邮件列表、电话号码列表、图像、姓名等）的联系人。我的设备上有 600 个联系人。

我正在尝试通过异步任务获取联系人，但在获取所有数据之前，应用程序在没有任何警告或任何错误的情况下关闭。

我在我的 logcat 中收到“正在删除死的内容提供者：联系人”消息。

如何解决此类问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T20:30:44.920

嘿，我得到了解决您的问题的方法，我遇到了同样的问题。突然，我发现我没有检查用于获取所有联系人的位图照片附加的方法。我忘记在该方法中关闭光标，因此它分配给应用程序的堆的占用内存对象。当此堆没有任何额外的内存可分配给您的应用程序时，您的活动线程将被终止。您在 logcat 中找不到任何内容，因为您正在寻找特定于您的应用程序的错误，而您可以在电话级别日志上看到 memObj 错误和 Process Runtime Exception（logcat 的所有消息选项）

# c++ - linux fork - execl，执行的进程变成僵尸

> ID：13746430
> 
> 赞同：5
> 
> 时间：2012-12-06T15:04:26.433
> 
> 标签：c++, linux, fork, zombie-process

我正在尝试从子进程运行闪烁命令行。例如像这样：

```
int hangup() {
write_on_display("line3", "            ");
write_on_display("hide_icon", "DIALTONE");
write_on_display("hide_icon", "BACKLIGHT");

int pid = fork();
if (pid == 0) {
    int res = execl("/usr/bin/twinkle", " ", "--immediate", "--cmd",
            "answerbye", (char *) NULL);
    _exit(0);
} else {
    perror("hangup");
    return 0;
}
return 1;
} 
```

但闪烁变成僵尸：

```
10020 pts/1    Z+     0:00 [twinkle] <defunct>
10040 pts/1    Z+     0:00 [twinkle] <defunct>
10053 pts/1    Z+     0:00 [twinkle] <defunct>
10064 pts/1    Z+     0:00 [twinkle] <defunct>
10097 pts/1    Z+     0:00 [twinkle] <defunct>
10108 pts/1    Z+     0:00 [twinkle] <defunct>
10130 pts/1    Z+     0:00 [twinkle] <defunct> 
```

我试图设置信号（SIGCHLD，SIG_IGN）；但没有成功。实际上我认为子进程在闪烁完成之前就死了。

从命令行运行闪烁，如：

```
twinkle --immediate --call 100 
```

不会使僵尸 - 闪烁正确关闭。我在那里缺少什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:08:46.623

父进程需要[`waitpid()`](http://linux.die.net/man/2/wait)使用子进程 ID 调用。从链接的参考页面：

> 所有这些系统调用都用于等待调用进程的子进程的状态变化，并获取有关其状态已更改的子进程的信息。状态变化被认为是：孩子终止；孩子被信号拦住；或者孩子被一个信号恢复了。**在终止子的情况下，执行等待允许系统释放与子关联的资源；如果未执行等待，则终止的子进程将保持“僵尸”状态**（参见下面的注释）。

例如：

```
pid_t pid = fork();
if (0 == pid)
{
    /* Child process. */
}
else
{
    /* Parent process, wait for child to complete. */
    int status;
    waitpid(pid, &status, 0);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T10:30:42.593

是的，但我需要父母和孩子异步工作。

其实我发现了我的错误。所以，如果有人有类似的问题，使用这样的信号处理函数：

```
void catch_child(int sig_num)
{
    /* when we get here, we know there's a zombie child waiting */
    int child_status;

    wait(&child_status);

} 
```

和信号（SIGCHLD，catch_child）

在 main() 函数中，一切正常。

PP Here： [是一个很好的解释。](http://www.academictutorials.com/ipc/ipc-process-creation.asp)

# android - 广播接收器 - 如果在 onResume/onPause 上注册/取消注册，您会错过一些广播吗？

> ID：13746433
> 
> 赞同：2
> 
> 时间：2012-12-06T15:04:34.813
> 
> 标签：android, broadcastreceiver

如果您在每个活动的 onPause 和 onResume 方法上注册和取消注册广播接收器，当您在活动之间切换时是否有机会错过一些广播？这两种方法之间有一段时间，如果在那个时候触发了广播，应用程序会跳过它吗？

谢谢你的信息，丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-11T00:10:04.987

会有一个短暂的时刻，他们不会被抓住。我建议通过在 Handler 类中使用 postDelayed 来延迟取消注册一秒钟，但这样它可能会同时在两者上被捕获。除非您有方案，否则我无法提出解决方案。例如，在我的应用程序中，处理这种情况并不是必须的，因为每个活动都有自己对广播的使用，因此我不关心这种情况。

# .htaccess - 使用 htaccess 将子域请求重定向到主域

> ID：13746435
> 
> 赞同：1
> 
> 时间：2012-12-06T15:04:37.837
> 
> 标签：.htaccess, rewrite

这是我所做的并且效果很好：

```
#redirect subdomains to controller
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.com$ [NC]
RewriteRule ^([a-zA-Z0-9-_]*)$ blog.php?blog_uid=%1 [L,QSA] 
```

现在我想重定向

```
 http://example.domain.com/post-123.html 
```

至

```
blog.php?blog_id=example&post_id=123 
```

但这不起作用：

```
RewriteCond %{HTTP_HOST} ^(.*)\.domain\.com$ [NC]
RewriteRule ^([a-zA-Z0-9-_]*)/post-([0-9]+)\.html$ blog.php?blog_uid=%1&post_id=%2 [L,QSA] 
```

怎么做？实际上如何将此类子域请求重定向到重写条件（它不是真实页面）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:13:07.920

Try this one.

```
RewriteEngine On
RewriteRule ^post-([^/]*)\.html$ /blog.php?blog_id=example&post_id=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:47:43.237

请改用此规则：

```
RewriteCond %{HTTP_HOST} ^([^.]+)\.domain\.com$ [NC]
RewriteRule ^post-([0-9]+)\.html$ /blog.php?blog_id=%1&post_id=$1 [NC,L,QSA] 
```

# dbus - DBUS - 是否有可能有 2 个会话总线实例或类似的东西？

> ID：13746436
> 
> 赞同：2
> 
> 时间：2012-12-06T15:04:38.213
> 
> 标签：dbus

基于 DBus 的实现，我面临一些奇怪的要求。我想知道这是否可能有 2 个实例`DBUS_SESSION_BUS`或类似的实例。

好吧，我寻找这个典型要求的原因是我的进程（总线上的节点）是重复的（即有 1 个以上的实例）并且它们都注册了相同的信号。例如，Node-A 和 Node-B 都发出`SIGNAL-1`，而 Node-X 和 Node-Y 都想接收`SIGNAL-1`（它们已`SIGNAL-1`通过`dbus_add_match()`调用注册）。

就目前而言，当`SIGNAL-1`发出 dbus 守护程序时，dbus 守护程序会将其传递给 Node-X 和 Node-Y。

我的要求是 Node-A 的`SIGNAL-`1 应该由 Node-X 接收，而 Node-B 的`SIGNAL-1`应该由 Node-B 接收

我尝试/分析的内容：
1\. `dbus_connection_open_private()`- 没有太多帮助，不确定使用部分，因为可用的文档有限。
2\. `dbus_bus_get_private()`- 在这种情况下不相关。
3\. 考虑replication the daemon - 太复杂，不容易实现。4\. 使用S 代替S 的
可能性（有相应的更改） - 再次太复杂并且不确定依赖关系。`DBUS_XYX_BU``DBUS_SESSION_BU`

我想知道您对此的看法，任何帮助/指示/提醒将不胜感激。

谢谢，马诺伊

# android - 应用程序的子类曾经被破坏过吗？

> ID：13746437
> 
> 赞同：1
> 
> 时间：2012-12-06T15:04:39.117
> 
> 标签：android, android-service, android-lifecycle

**我的问题**

我有一个服务，我可以在其中监控位置变化。在后台保持运行至关重要，因此它是前台服务。

我的问题是当它在后台并且东西被破坏时，我该如何保存这些数据。

**我的问题**

这让我想到了我的潜在解决方案。

我有一个`Application`在清单文件中声明的子类。

是否可以安全地看到存储在其中的任何对象`Singleton`在我的一生中都可以访问`Service`，从而为我提供保存位置的方法？

**提前致谢**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:19:16.410

对您的问题的简短回答是肯定的，`Application`基本上只要您的进程执行此操作就可以存在，因此您存储在那里的任何内容都尽可能稳定，直到 Android 可能需要从后台回收您的应用程序以获取更多内存对于前台应用程序。但是，与简单地将状态数据保存在其内部相比，并没有增加太多好处`Service`。Android 没有一种机制可以选择性地销毁应用程序中的组件以回收内存**。**如果它需要额外的内存来保持前台进程的正常运行，它只会按优先级顺序（基于最近使用和它们的前台/后台优先级状态）杀死其他应用程序的**整个进程。**

通过`Service`在您的进程中运行，您的应用程序已经将其优先级提升为比系统中处于后台的其他应用程序更重要，从而降低了您的进程被杀死的可能性。通过将您的`Service`运行设置为前台，您只是稍微进一步提高了此优先级，而且 Google 不建议您长期这样做。当系统承受足够的内存压力以致应用程序开始被杀死时，最终您的进程将遭受同样的命运。

如果您确实需要您的任何数据在您的流程生命周期之外存在，您需要将其保存为任何 Android 的本地存储格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:19:38.610

我会说不。即使你有一个带有你正在设置的静态变量的静态类，你也不能保证操作系统不会在它选择的任何时候任意终止你的进程。也许你所说的 99% 的时间可能有效，但在我看来这不是一个可靠的解决方案。

您应该按照建议将任何重要数据存储在数据库或 android 首选项中，这对您的应用程序/数据来说更合乎逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:18:54.863

该`Application`对象是 Android 生命周期中寿命最长的对象。所以是的，它的寿命至少和你的`Service`. 不过，我不确定它如何帮助您保存任何东西。一旦 Android 终止了您的进程——它会在某个时候，无论是否有前台服务——你仍然需要在`Service`下次创建时重新加载或重新创建数据。

# c - 我怎样才能把它分解成函数？

> ID：13746441
> 
> 赞同：-1
> 
> 时间：2012-12-06T15:04:54.030
> 
> 标签：c, function

该程序现在可以在不使用任何功能的情况下运行，但我想实现它们以使其更加模块化。

我的问题是我不知道如何使用函数，如何调用函数，如何实现它。现在我真的很困惑如何理解它们。

```
#include <stdio.h>
#include <conio.h>
#define BERBER 27.95
#define PILE 15.95

void main () {
    int budget,lenh,wah,ftl,ftw;
    float convert,area,costl,costw;

    printf("WELCOME TO OUR SHOP!");
    printf("\nWE SALE CARPETS");
    printf("\nLength in <feet and inches>:\n");
    scanf_s("%d %d",&lenh,&ftl);fflush(stdin);
    printf("\nWidth in <feet and inches>:\n");
    scanf_s("%d %d",&wah,&ftw);fflush(stdin);

    costl=lenh(ftl/12.0);
    costw=wah(ftw/12.0);
    area=costl*costw;
    printf("\nTotal cost of the length : %.2f",costl);
    printf("\nTotal cost of the width : %.2f",costw);

    printf("\nYour budget:");scanf("%d",&budget);

    if (budget<BERBER) {
        convert=area*PILE;
        printf("\nYOu can only afford PILE");
    } else if (budget>PILE) {
        convert=area*BERBER;
        printf("\nYou can afford BERBER");
    } else {
        printf("\nThe choose is in you if you choose BERBER or PILE");
    }
    getch();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:29:23.447

在不为您编写解决方案的情况下，我将提供应该将您推向正确方向的伪代码（然后由您来实施）：

```
float GetArea(){
  float area;

  // - output the greeting
  // - prompt user for inputs (width/length
  // - total area

  return area;
}

float GetBudget(){
  float budget;

  // - prompt user for budget

  return budget;
}

void CheckBudget(float area, float budget) {
  // -check your area vs budget
  // - output appropriate response
}

void main(){ // Starting Point
  float area, budget;

  // - call GetArea() and store it
  // - call GetBudget() and store it
  // - call CheckBudget() referencing both of these values

  // done

} 
```

这是拆散和重构的一种方法。请放心，还有很多其他方法。想想最初的任务和什么被认为是“工作单元”。您可能想要重用/重新执行的任何内容都是函数的一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:36:39.857

使用函数的一个要点是将您的代码模块化为可重用的小块。如果您的代码没有“可重用”部分，则可能不需要制作函数。例如：

```
int main()
{
    printf("The color is blue\n");
    printf("I like blue\n");

    printf("The color is red\n");
    printf("I like red\n");

    printf("The color is green\n");
    printf("I like green\n");
    return 0;
} 
```

在这里我一遍又一遍地做同样的事情，只改变一个部分，我们可以把它变成一个函数：

```
void printit(const char * color)
{
    printf("The color is %s\n", color);
    printf("I like %s\n", color);
}

int main()
{
    printit("blue");
    printit("red");
    printit("green");
    return;
} 
```

`main()`现在我只是通过使用一个函数来处理常见任务来清理我的。每次都不同的部分（颜色）我变成了一个变量并将其传递给函数以允许对打印的内容进行一些自定义。这当然是一个非常简化的例子。

* * *

回顾一下，您的代码实际上并没有任何“可重用”部分......但您可能想使用函数来简单地保持它的清洁度，您的程序包含三个部分：

1.  来自用户的输入
2.  做数学
3.  输出给用户

因此，如果您愿意，您可以执行三个功能。（对于这样一个简单的程序来说有点矫枉过正，但对于教育目的来说没关系）。

```
void welcome_and_input(int * lenh, int * wah, int *ftl, int *ftw)
    printf("WELCOME TO OUR SHOP!");
    printf("\nWE SALE CARPETS");
    printf("\nLength in <feet and inches>:\n");
    scanf_s("%d %d\\n",lenh,ftl);
    printf("\nWidth in <feet and inches>:\n");
    scanf_s("%d %d\\n",wah,ftw);
}

void main () {
    int budget,lenh,wah,ftl,ftw;
    float convert,area,costl,costw;

    welcome_and_input(&lenh, &wah, &ftl, &ftw); 
```

看看您是否能理解该代码，它会接收您的欢迎消息和输入请求并将其分离为一个函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:36:43.843

Holly，在发送问题之前：在谷歌中使用“c + function + tutorials”之类的搜索教程，你会发现很多网站可以回答你的大部分问题。然后，如果您有特定问题，您可以在此处发布您的问题以及详细信息。

因为我很好......这是一个简单的函数示例（它使用函数 area_calculation 进行面积计算）：

```
#include <stdio.h>
#include <conio.h>
#define BERBER 27.95
#define PILE 15.95

//Prototype 
float area_calculation (float costl, float costw);

void main () {
    int budget,lenh,wah,ftl,ftw;
    float convert,area,costl,costw;

    printf("WELCOME TO OUR SHOP!");
    printf("\nWE SALE CARPETS");
    printf("\nLength in <feet and inches>:\n");
    scanf_s("%d %d",&lenh,&ftl);fflush(stdin);
    printf("\nWidth in <feet and inches>:\n");
    scanf_s("%d %d",&wah,&ftw);fflush(stdin);

    costl=lenh(ftl/12.0);
    costw=wah(ftw/12.0);
    //Call to the function area_calculation 
    area=area_calculation (costl,costw);
    printf("\nTotal cost of the length : %.2f",costl);
    printf("\nTotal cost of the width : %.2f",costw);

    printf("\nYour budget:");scanf("%d",&budget);

    if (budget<BERBER) {
        convert=area*PILE;
        printf("\nYOu can only afford PILE");
    } else if (budget>PILE) {
        convert=area*BERBER;
        printf("\nYou can afford BERBER");
    } else {
        printf("\nThe choose is in you if you choose BERBER or PILE");
    }
    getch();
}

//definition of the function area_calculation
float area_calculation (float costl, float costw)
{
    return (costl * costw);
} 
```

# go - 将 JSON 响应表示为结构

> ID：13746450
> 
> 赞同：2
> 
> 时间：2012-12-06T15:05:06.170
> 
> 标签：go

我正在调用 Google Translate API，并希望将响应表示为结构。JSON 响应是：

```
{
 "data": {
  "translations": [
   {
    "translatedText": "Mi nombre es John, nació en Nairobi y tengo 31 años de edad",
    "detectedSourceLanguage": "en"
   }
  ]
 }
} 
```

我试图想出一个结构：

```
type Translations struct{
  TranslatedText string
  SourceLanguage string
}

type Translation struct{
  Data string
  Value *[]Translations
} 
```

或者：

```
type Translations struct{
  TranslatedText string
  SourceLanguage string
}

type Translation struct{
  Data string
  Value Translations
} 
```

哪种方法是正确的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:17:21.620

这是一个将两个结构定义合并为一个的工作示例。

[http://play.golang.org/p/nI0Qet6R78](http://play.golang.org/p/nI0Qet6R78)

```
package main

import (
    "fmt"
    "encoding/json"
    )

type Translation struct{
    Data struct {
        Translations []struct {
            TranslatedText string
            DetectedSourceLanguage string
        }
    }
}

func main() {

    source := []byte(`
    {
     "data": {
      "translations": [
       {
        "translatedText": "Mi nombre es John, nació en Nairobi y tengo 31 años de edad",
        "detectedSourceLanguage": "en"
       }
      ]
     }
    }
    `)

    var j Translation
    err := json.Unmarshal(source, &j)
    if err != nil {
        panic(err)
    }
    for _,t := range j.Data.Translations {
        fmt.Printf("----\n")
        fmt.Printf("translatedText: %s\n", t.TranslatedText)
        fmt.Printf("detectedSourceLanguage: %s\n", t.DetectedSourceLanguage)
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:13:57.427

您可以将数据分成三个部分。`translation`包含在`translations`数组中的单个。您的主要结构是`data`.

我发现最容易从最内部的结构开始并定义它，然后按我的方式工作到外部结构。

这些的表示可以这样定义：

```
type translation struct {
    TranslatedText string
    SourceLanguage string `json:"detectedSourceLanguage"`
}

type translations struct {
    Translations []translation
}

type data struct {
    Data translations
} 
```

如果数据结构不是太复杂，你可以像这样把它们放在一起：

```
type data struct {
    Data struct {
        Translations []struct {
            TranslatedText string
            SourceLanguage string `json:"detectedSourceLanguage"`
        }
    }
} 
```

在一个完整的工作[示例](http://play.golang.org/p/O6BGlAs7jb)中：

```
package main

import (
    "encoding/json"
    "fmt"
)

var json_s string = `{
  "data": {
    "translations": [
      {
        "translatedText": "Mi nombre es John, nació en Nairobi y tengo 31 años de edad",
        "detectedSourceLanguage": "en"
      }
    ]
  }
}`

type data struct {
    Data struct {
        Translations []struct {
            TranslatedText string
            SourceLanguage string `json:"detectedSourceLanguage"`
        }
    }
}

func main() {
    var translation data
    err := json.Unmarshal([]byte(json_s), &translation)
    if err != nil {
        panic(err)
    }

    fmt.Printf("%+v", translation)
} 
```

# php - 尽管使用了正确的编码，但奇怪的字符

> ID：13746454
> 
> 赞同：0
> 
> 时间：2012-12-06T15:05:21.070
> 
> 标签：php, html, encoding, utf-8

我在一个具有不同语言界面的网站上工作，到目前为止我使用的是英语和德语。

加载德语文本时，它会显示奇怪的字符，如下面的屏幕截图

![在此处输入图像描述](../Images/f17e2ec068289a56994a39264fd84896.png)

虽然我用

```
header('Content-type: text/html; charset=utf-8'); 
```

以及在 html 标头中

```
<META http-equiv="content-type" content="text/html; charset=utf-8"> 
```

我还能做些什么来解决它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:08:02.723

页面内容也需要采用 UTF-8 格式。您的内容可能是使用 MS Word 制作的，它使用 Windows 1251 编码。您需要将文档重新保存为 UTF-8。

UTF-8 不会为您转换格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:07:54.723

如果这些字符串保存在文件中，则文件也必须以 UTF-8 编码。如果您从数据库中获取它们，则必须将它们存储为 UTF-8，并且您必须将连接字符集设置为 utf-8。

您还可以检查您的文本是否为 UTF-8，如果不是，请使用 utf8_encode 进行转换。

# java - 使用扩展点：找不到可配置的元素

> ID：13746458
> 
> 赞同：0
> 
> 时间：2012-12-06T15:05:29.553
> 
> 标签：java, eclipse, eclipse-rcp, rich-client-platform

我为一个插件（A）创建了一个扩展点。另一个插件（B）被设置为第一个插件的 ep 的扩展。

当试图在一个 eclipse 中使用扩展点时，eclipse 告诉我，它无法找到这个扩展点的可配置元素。找到扩展点本身。

我怀疑插件 B 根本没有启动。我怎样才能检查这个？

这是调用扩展点的代码：

```
IExtensionRegistry extensionRegistry = Platform.getExtensionRegistry();
        IExtensionPoint[] extensionPoints = extensionRegistry.getExtensionPoints("A.extensionpoints");
        //Prints both defined EP's
        for (IExtensionPoint iExtensionPoint : extensionPoints) {
            System.err.println(iExtensionPoint.getUniqueIdentifier());
            System.err.println(iExtensionPoint.getExtensions().length); 
        }
        IExtensionPoint extensionPoint = extensionRegistry.getExtensionPoint("A.extensionpoints.HavingProblemsWith");
        System.err.println(extensionPoint.getLabel());//Prints the Label
        System.err.println(extensionPoint.getConfigurationElements().length);// => 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:12:57.637

Fire up eclipse with the `-console` option. Then you have tools to view the status of the plugins and to start them, if you want so. It may give you some ideas on *why* the plugin hasn't been started.

# jquery - jQuery Live 正则表达式检查

> ID：13746459
> 
> 赞同：2
> 
> 时间：2012-12-06T15:05:37.580
> 
> 标签：jquery, regex

因此，我有一个默认值为“www.mysite.com/users/”的输入框，在此值之后，用户应该能够为自己定义一个短 URL，例如：“mike”。

现在，我只想允许 az 和 AZ 用于短 URL，我想实时检查用户输入并防止他们使用其他字符作为 &%!"£...，这是我的代码：

```
<input type="text" id="short_url" value="www.mysite.com/users/" />
<script>
    ('#short_url').on('keypress', function(){
                var short_url = $(this).val();
                if(short_url.substr(0, 21) != 'www.mysite.com/users/'){
                    $(this).val('www.mysite.com/users/');
                }else{
                    // Only allow a-z
                        short_url = short_url.substr(21);
                        var RegEx = /^[a-z0-9]$/;
                        if(!RegEx.test(short_url)) {
                            if(short_url != '')
                            return false;
                        }
                }
            });
</script> 
```

我在上面的代码中尝试的是不让用户清除我的site.com，所以他必须在默认值之后添加他的短网址，并且只允许输入正则表达式，但它不起作用。我应该如何实现这个？

另一件事是，我也想在短网址中允许点，但只有一个点！

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:29:32.793

既然你的基本 URL 永远不会改变......为什么不在你的输入字段之前制作那个静态文本。它将大大简化您的代码。

```
<span>www.mysite.com/users/</span>
<input id="short_url" type="text" />​ 
```

然后用一点 jQuery 来处理验证

```
(function(){

    var shortUrlRegexp = /^[a-zA-Z]*(\.{1}[a-zA-Z]*)?$/;

    $("#short_url").on("keyup", function(){

        var text = $(this).val();

        var isMatch = shortUrlRegexp.test(text);

        $(this).toggleClass("invalid", !isMatch);

    });

}());​ 
```

这是一个[现场演示](http://jsfiddle.net/jwcarroll/PP7HP/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:17:35.560

这将允许字母数字 + 一`.`。必须以字母数字字符开头和结尾

```
^[a-z0-9]+\.?[a-z0-9]+$ 
```

# mysql - 如何从存储过程中创建函数或视图

> ID：13746462
> 
> 赞同：0
> 
> 时间：2012-12-06T15:05:50.083
> 
> 标签：mysql, function, stored-procedures, views

在存储过程中，我知道您可以创建表或数据库或模式，但是否可以创建函数或视图：这是我尝试过的：

```
create PROCEDURE schemaName.asd()
begin
DECLARE stmt VARCHAR(255);

SET stmt := concat('CREATE FUNCTION schemaName.asdsfasdf() RETURNS int BEGIN return 1; end;');

PREPARE stmt FROM @stmt;

EXECUTE stmt;
end; 
```

当我做

```
call schemaName.asd()$$ 
```

我得到一个错误代码1064

是否可以在这里创建功能或视图？如果是的话怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:34:11.530

尝试这样的事情：

```
 declare @SqlStmt varchar(500)

    select @SqlStmt='CREATE FUNCTION schemaName.asdsfasdf() 
                     RETURNS int BEGIN return 1; end';
    exec(@SqlStmt) 
```

# php - 如何跟踪用户数据

> ID：13746466
> 
> 赞同：0
> 
> 时间：2012-12-06T15:06:01.457
> 
> 标签：php, oop, session

OOP、SESSIONS 和用户帐户中跟踪用户信息以在整个网站中使用的最佳方式是什么。（例如 Stack Overflow、Facebook、Google、YouTube 等）

我在想，一旦用户登录，您就可以将所有信息分配给会话数组。例如：

> $_SESSION['user_id']，$_SESSION['roles']。

然后在 OOP 中你可以这样做：

> $foo->getUserId()、$foo->getAge($user_id) 等。

我想我的问题是处理信息以用于基于用户的网页上的动态内容的最佳方法是什么？（例如用户资料、年龄、加入日期等）。我应该只存储 user_id 的 SESSION 变量，然后使用 user_id 来获取我想要的信息吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:10:30.743

使用 OOP 主体的主要优点之一是一切都成为对象，具有自己的属性。

假设您已经处理了登录过程，您最好以某种方式使用他们的 session_id() 作为标识符，查找他们的用户 ID，然后从 User 类返回一个新对象。这是一个示例：

```
class User
{
    public $forename;
    public $surname;
    public $google;
    ...

    function __construct($id)
    {
        // Get the record from the DB and assign thevalues as follows:
        $this->forename = $dbobject->forename;
        $this->surname = $dbobject->surname;
        $this->google = $dbobject->google;
    }
} 
```

然后您需要创建 User 对象，您可以将其分配为当前登录的用户：

```
$logged_in = new User($id); 
```

此后，可以使用 访问每个属性`$logged_in->forename`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:14:11.443

You would want to minimize the data you would store in $_SESSION[].

I'm not sure if you can do classes or structs in PHP, but you probably want to create an object of User that has the properties username, user id, roles (array), at minimum. You may add other information that you know will be displayed on every page. This way, you would only have one item in the $_SESSION[] for the user.

As long as the user is logged in, you always have $_SESSION['User'], and you would probably want to use the user info to determine which data to display (blog entries, posted videos, etc), and which sections of the page to show/hide depending on that user's roles.

# php - Google Analytics：一页跟踪多个查询

> ID：13746468
> 
> 赞同：0
> 
> 时间：2012-12-06T15:06:05.763
> 
> 标签：php, javascript, html, input, google-analytics

我有一个简单的 PHP/HTML 网站，其中包含 3 个步骤的用户输入要求。伪流过程如下所示：

`(Page 1) Step 1: Enter x_input`

`(Page 2) Step 2: Enter y_input`

`(Page 3) Step 3: Enter z_input`

每个步骤的进度将由 Google Analytics 跟踪。目前，为了正确跟踪用户是否正在完成每个步骤，每个步骤都是它自己的单独页面。

理想情况下，为了简单起见，我想将这些信息压缩到 1 页。有没有办法仍然跟踪每个完成的“步骤”并将其视为它自己的 GA 页面？如何区分它的方法无关紧要（PHP、javascript 等）。任何想法/意见表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:35:03.313

我相信这可以通过使用 google analitycs 中的目标来实现

在您网站的分析左侧有一个名为“转化”的部分，您可以打开它然后访问“目标”。

我自己没有这样做，但是您可以添加目标 URL，因此您可以将此流程压缩到一个页面并通过查询字符串传递参数以识别您正在进行的流程的哪个步骤，并将这些 url 添加到 google 中的目标分析。

# android - 使用 ZXING 库生成二维码

> ID：13746471
> 
> 赞同：-1
> 
> 时间：2012-12-06T15:06:12.553
> 
> 标签：android, eclipse, barcode, qr-code, zxing

我是 android eclipse 的新手，我想知道如何配置或使用从 zxing 团队的开源 zxing 库生成 QR 码。如果有任何替代方案，请告诉我。

那么任何人都可以建议我应该如何进行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:24:42.360

从工作代码复制：

```
 String theDataToDisplay = "Hello World!";

    Intent intent = new Intent("com.google.zxing.client.android.ENCODE");
        intent.putExtra("ENCODE_TYPE", "TEXT_TYPE" );
        intent.putExtra("ENCODE_DATA", theDataToDisplay );
        intent.putExtra("ENCODE_FORMAT", "QR_CODE");
        intent.putExtra("ENCODE_SHOW_CONTENTS", false );
        startActivity(intent); 
```

这需要在设备上安装 BarCodeScanner。确保您尝试/捕获此代码，以防包裹丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:47:31.053

项目提供的`IntentIntegrator`类封装了上述`Intent`基于 - 的解决方案。这样就更容易了。

请参阅[http://code.google.com/p/zxing/wiki/ScanningViaIntent](http://code.google.com/p/zxing/wiki/ScanningViaIntent)

尽管示例涉及扫描/解码，但该类本身具有类似工作的编码方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:15:11.627

看看这个类：[Intents.java](http://code.google.com/p/zxing/source/browse/trunk/android/src/com/google/zxing/client/android/Intents.java)

那是处理 ZXing 意图的类。

您需要创建一个意图`ACTION = "com.google.zxing.client.android.ENCODE"`

然后向它添加代表您要编码的数据的附加信息，以及您想要的 QR 的格式/类型。

如果可以使用互联网，您还有另一个选择是使用[Google Image Charts API](https://developers.google.com/chart/image/)生成它们，供您下载并在您自己的活动中显示。*注意：API 已弃用，但可能在 2015 年之前可用*

# c# - 使用 ModelBinder 属性与 ModelBinders.Add()

> ID：13746472
> 
> 赞同：25
> 
> 时间：2012-12-06T15:06:15.497
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

有人可以告诉我在 global.asax 中使用`[ModelBinder()]`属性与注册模型绑定器的优缺点`ModelBinders.Add()`吗？

我能想到的一个优点是它更明确，而在全局中注册`ModelBinders`对于检查操作方法的人来说并不那么明显。

我能想到的一个权衡是它不可重用，因为您必须将此属性添加到需要使用此模型绑定器的所有操作方法中，而在全局中注册`ModelBinders`将使其可用于接收该模型的所有操作方法。

这是唯一的区别吗？

换句话说，说明这是正确的：

*   如果您只在一种操作方法中使用模型（可能是两种，get + post），那么使用`[ModelBinder()]`.
*   如果您在多个操作方法中使用模型，则将其注册到全局`ModelBinders`.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-06T17:27:08.613

这些技术的结果将是相同的，因此主要取决于团队感觉更舒服的问题。所以你可以想出一个像你所说的那样的约定。

就个人而言，我更喜欢不必为使用该模型的每个操作方法设置属性。所以我会选择以下选项之一：

*   在模型类上设置属性，如：

    ```
    [ModelBinder(typeof(MyModelBinder))]
    public class MyModel
    {
        ...
    } 
    ```

*   全局注册活页夹

    ```
    ModelBinders.Binders.Add(typeof(MyModel), new MyModelBinder()) 
    ```

我更喜欢其中一个的另一个原因是，如果您必须手动触发模型绑定过程，您可能还希望使用自定义模型绑定器：

```
public ActionResult SomeActionMethod()
{
     MyModel model = ...

     //manually invoke the model binding process considering only query string data
     //The custom model binder will be used only if it was globally registered
     //in the binders dictionary or set in an attribute of the model class
     TryUpdateModel(model, new QueryStringValueProvider())

     ...
} 
```

`IModelBinderProvider`您还可以选择通过实现接口并在 global.asax 中注册来实现自己的逻辑来选择模型绑定器，如

```
ModelBinderProviders.BinderProviders.Add(new CustomModelBinderProvider()) 
```

在方法参数中使用属性的一种方法可以是为该特定方法覆盖原本会使用的模型绑定器。因此，您可以为您的类全局注册一个模型绑定器，并使用该属性在一个特定的操作方法中覆盖它。

最后，有很多选择模型活页夹的选项。在 asp MVC 3 中，这将通过以下方式解决（假设您使用的是默认的 ControllerActionInvoker）

1.  动作参数的属性。[请参阅ControllerActionInvoker 类](https://github.com/ASP-NET-MVC/ASP.NET-Mvc-3/blob/master/mvc3/src/SystemWebMvc/Mvc/ControllerActionInvoker.cs)的 GetParameterValue 方法

2.  从 IModelBinderProvider 返回的 Binder。请参阅[ModelBinderDictionary 类中的 GetBinder 方法](https://github.com/ASP-NET-MVC/ASP.NET-Mvc-3/blob/master/mvc3/src/SystemWebMvc/Mvc/ModelBinderDictionary.cs)

3.  在 ModelBinders.Binders 字典中全局注册的 Binder。

4.  `[ModelBinder()]`在模型类型的属性中定义的 Binder 。

5.  DefaultModelBinder。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-09T15:46:27.817

在我看来，使用属性而不是添加到 Global.asax 中的模型绑定器集合的优势在于，您可以告诉方法（或类）使用哪个特定绑定器，而不是将绑定器与特定类型相关联。然后您可以基于上下文而不是类型创建模型。

# php - 使用数组的带参数的PHP调用函数

> ID：13746479
> 
> 赞同：4
> 
> 时间：2012-12-06T15:06:32.240
> 
> 标签：php

```
function myFunc($x, $y) {
    echo "x : {$x}";
    echo "y : {$y}";
}
$params = array("y" => 1, "x" => 2); 
```

是否可以`myFunc`像使用`call_user_func_array`函数一样调用但数组的键会自动在函数中设置正确的参数？是否有任何功能可以执行此操作，或者是否可以创建此功能？例如 ：

```
call_func('myFunc', $params); 
```

结果是这样的

```
x : 2
y : 1 
```

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:11:01.977

可能有一种更简单的方法可以做到这一点，但反射也应该起作用：

```
function call_func_keys($functionName, $args) {
    $f = new ReflectionFunction($functionName);
    $inOrder = array();

    foreach($f->getParameters() as $param) {
        if(array_key_exists($param->name, $args)) {
            $inOrder[] = $args[$param->name];
        } else {
            $inOrder[] = $param->getDefaultValue(); # Will throw a reflection exception if not optional
        }
    }

    call_user_func_array($functionName, $inOrder);
} 
```

[这是一个演示。](http://codepad.viper-7.com/GAZid2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:09:22.340

**更新！**

通常你应该使用[`call_user_func_array`](http://php.net/call_user_func_array)函数。

它应该这样使用：

```
function myFunc($x, $y) {
   echo "x : {$x}";
   echo "y : {$y}";
}
$params = array("y" => 1, "x" => 2);

call_user_func_array('myFunc', $params); 
```

但在你的情况下，你肯定会使用[`Reflection`](http://php.net/manual/en/book.reflection.php). @minitech 的答案很棒。

# asp-classic - VBScript 计算表单中的特定元素

> ID：13746480
> 
> 赞同：0
> 
> 时间：2012-12-06T15:06:41.537
> 
> 标签：asp-classic, vbscript

我有一个表格，它被用作收集答案的测验，并且是动态生成的，因此问题的数量是可变的。我希望能够计算 for 中的单选按钮组的数量，以便我可以 a）确定检查的位置和 b）能够收集它们，以便我可以将选定的答案保存在数据库中。这是我应该尝试在 jQuery 中做的事情并以某种方式将其传递给 VBScript 还是可以在 VBScript 中以编程方式完成？作为参考，这是为示例表单生成的 HTML：

```
<form id="vms_quiz" method="post">
<h2>Sustainable Infrastructure Quiz 1</h2>
<p>Phasellus ultrices nulla quis nibh. Quisque a lectus. Donec consectetuer ligula vulputate sem tristique cursus. Nam nulla quam, gravida non, commodo a, sodales sit amet, nisi.</p>
<!-- START QUESTION GROUP: Question #1 -->
<h2>Question #1</h2>
<p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
<label>
  <input type="radio" name="Q_1" value="0" id="Q1C_1" akey="0" checked="false">
  Who</label>
<label>
  <input type="radio" name="Q_1" value="0" id="Q1C_2" akey="0" checked="false">
  What</label>
<label>
  <input type="radio" name="Q_1" value="1" id="Q1C_3" akey="1" checked="false">
  Where</label>
<label>
  <input type="radio" name="Q_1" value="0" id="Q1C_4" akey="0" checked="false">
  When</label>
<label>
  <input type="radio" name="Q_1" value="0" id="Q1C_5" akey="0" checked="false">
  Why</label>
<!-- START QUESTION GROUP: Question #2 -->
<h2>Question #2</h2>
<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</p>
<label>
  <input type="radio" name="Q_2" value="0" id="Q2C_6" akey="0" checked="false">
  Who</label>
<label>
  <input type="radio" name="Q_2" value="0" id="Q2C_7" akey="0" checked="false">
  What</label>
<label>
  <input type="radio" name="Q_2" value="1" id="Q2C_8" akey="1" checked="false">
  Where</label>
<label>
  <input type="radio" name="Q_2" value="0" id="Q2C_9" akey="0" checked="false">
  When</label>
<label>
  <input type="radio" name="Q_2" value="0" id="Q2C_10" akey="0" checked="false">
  Why</label>
<!-- START QUESTION GROUP: Question #3 -->
<h2>Question #3</h2>
<p>Quisque sit amet est et sapien ullamcorper pharetra. Vestibulum erat wisi, condimentum sed.</p>
<label>
  <input type="radio" name="Q_3" value="0" id="Q3C_11" akey="0" checked="false">
  Who</label>
<label>
  <input type="radio" name="Q_3" value="0" id="Q3C_12" akey="0" checked="false">
  What</label>
<label>
  <input type="radio" name="Q_3" value="1" id="Q3C_13" akey="1" checked="false">
  Where</label>
<label>
  <input type="radio" name="Q_3" value="0" id="Q3C_14" akey="0" checked="false">
  When</label>
<label>
  <input type="radio" name="Q_3" value="0" id="Q3C_15" akey="0" checked="false">
  Why</label>
<input name="vms_quizID" type="hidden" value="1">
<input name="vms_videoID" type="hidden" value="1">
<div class="frm_div">
  <input id="btn_quiz_check_answers" name="btn_quiz_check_answers" type="submit" value="Check Answers">
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:14:23.107

客户端 VBScript 仅在 Internet Explorer 上可用。您必须使用 JavaScript（jQuery*就是*JavaScript）。

# javascript - CDN 关闭时加载 jQuery 的备份副本

> ID：13746489
> 
> 赞同：7
> 
> 时间：2012-12-06T15:07:02.833
> 
> 标签：javascript, jquery, cdn

我在用于初始化所有应用程序的脚本中有这段代码，它从谷歌 CDN 加载 jQuery 以及我们所有应用程序都需要的其他一些东西。然后，当我们加载特定的程序功能时，我们会检查以确保 jquery 已加载，以防 CDN 关闭。我遇到的问题是它仍在加载第二个。`alert("Test");`如果我在该行之后添加一个简单的，`headTag.appendChild(jqTag);`它可以完美地工作，但如果我删除警报，它会使用第二个。是什么赋予了？

它们是这样加载的：

```
<script type="text/javascript" src="i-initializer.js"></script>
<script type="text/javascript" src="i-program.js"></script> 
```

初始化脚本：

```
if(typeof jQuery=='undefined'){
    var headTag = document.getElementsByTagName("head")[0];
    var jqTag = document.createElement('script');
    jqTag.type = 'text/javascript';
    jqTag.src = 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js';
    headTag.appendChild(jqTag);
} 
```

然后在另一个脚本中，我们有以下内容：

```
if(typeof jQuery=='undefined'){
    var header = document.getElementsByTagName("head")[0];
    var qtag = document.createElement('script');
    qtag.type = 'text/javascript';
    qtag.src = 'http://feedback.oursite.com/scripts/jquery-1.8.3.min.js';
    qtag.onload = checkjQueryUI;
    header.appendChild(qtag);
}
else
{
    jQCode();
}
jQCode() {
...
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-06T15:09:03.507

这是[HTML5 Boilerplate](http://html5boilerplate.com/)使用的技术。首先它加载 Google CDN 脚本，然后立即检查全局`jQuery`对象是否存在——如果不存在，CDN 失败，而是加载本地副本。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.3.min.js"><\/script>')</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T15:10:26.767

您的后备代码异步加载 jQuery。
这意味着您的脚本的其余部分在 jQuery 加载之前运行。

添加`alert()`调用会强制其余代码等待（直到您单击确定）；到那时，jQuery 将已加载。

相反，您可以发出一个新`<script>`标签，`document.write()`用于同步加载它。

或者，您可以将其余代码包装在回调中，并在 jQuery 加载后调用回调。
如果你这样做，你应该使用一个脚本加载器库，它将为你处理所有这些。

# web-services - asmx 页面为空白，但 WebService 正在运行

> ID：13746500
> 
> 赞同：0
> 
> 时间：2012-12-06T15:07:41.180
> 
> 标签：web-services, asmx

我有一个 asmx WebService 可以完美运行，但是当我在浏览器中浏览它时会返回一个空白页面。

当我浏览到该`search.asmx`文件时，我没有使用允许您调用服务的测试表单获得服务的通常 html 格式描述。我得到的只是一个完全空白的页面。（查看源代码不返回任何内容）。

这发生在 localhost (casini) 和服务器 (IIS 7.5) 上。

有没有办法可以打开它？

## 我的 web.config 看起来像这样：

```
 ...
  <system.web>
    <httpRuntime requestValidationMode="2.0" enableKernelOutputCache="false"/>
    <webServices>
      <protocols>
        <add name="HttpGet"/>
        <add name="HttpPost"/>
      </protocols>
    </webServices>
    ... 
```

## 我的服务看起来像这样：

```
...
[WebService(Namespace = "http://mydomain.edu/something")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]

[System.Web.Script.Services.ScriptService]
public class SearchService : System.Web.Services.WebService {

    public SearchService() {

    }

    [WebMethod(EnableSession = true)]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public SearchResponse Search(SearchFilter filter)
    {
... 
```

# 更新：

当我导航到 wsdl 时`search.asmx?wsdl`，出现错误：

> System.InvalidOperationException：无法反映方法搜索。---> System.InvalidOperationException：出现反映“SearchResult”的错误。---> System.InvalidOperationException：反映类型“SearchResponse”时出现错误。---> System.InvalidOperationException：反映属性“属性”时出现错误。---> System.InvalidOperationException：反映类型“USpaceDataAttributes”时出现错误。---> System.NotSupportedException: 无法序列化 System.Collections.Generic.Dictionary 类型的成员 USpaceDataAttributes.attributes`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[SimpleTypeData , Entities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]，因为它实现了 IDictionary。

我很确定这就是为什么我得到一个空白页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T15:15:01.560

尝试

```
<add name="Documentation"/> 
```

# ruby - Ruby检查mongodb中是否存在记录

> ID：13746501
> 
> 赞同：2
> 
> 时间：2012-12-06T15:07:42.133
> 
> 标签：ruby, mongodb

如果数据库中存在记录，只需使用 ruby​​ 驱动程序进行简单检查。

喜欢

```
Main = db.collection(main)
Record = main.find("record" => name)
If record?
 Puts record exist
Else
 Dont exist
End 
```

这不起作用有人能告诉我怎么做吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-04T18:00:36.333

下面将把真假记录是否存在

```
puts main.record.where(record: name).exists? 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-06T15:33:43.010

这可以像您一样使用收集方法“find”来完成，但选择器必须是散列。

```
 col = db.collection(main)
  record = col.find({:property => value}) 
```

Find 还接受可选的选项散列。看看文档。[http://api.mongodb.org/ruby/current/Mongo/Collection.html#find-instance_method](http://api.mongodb.org/ruby/current/Mongo/Collection.html#find-instance_method)

# c# - 将二进制数据作为参数发送到 Web 服务中的方法？

> ID：13746505
> 
> 赞同：1
> 
> 时间：2012-12-06T15:07:54.640
> 
> 标签：c#, post, visual-c++-6, wininet, windows-2003-webserver

在服务器端（C#.NET，Windows 2003）我有一个带有方法的 Web 服务，在客户端（Visual C++ v6，WinINet，POST）我想调用该方法并将二进制数据作为参数传递给它。当我发送二进制数据时，错误上升，当我发送 ASCII 数据时，它称为成功。如何发送二进制数据作为方法的参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T01:34:38.307

要将二进制数据发送到 Web 方法，您可以对其进行 base64 编码，然后在 Web 服务中对其进行解码。如果您的变量是一个称为数据的字节数组，那么您将执行以下操作。

在 C++ 中，您需要创建一个 base64 头文件和 cpp 文件。以下示例来自[http://www.adp-gmbh.ch/cpp/common/base64.html](http://www.adp-gmbh.ch/cpp/common/base64.html)

**base64.h**

```
#include <string>

std::string base64_encode(unsigned char const* , unsigned int len);
std::string base64_decode(std::string const& s); 
```

**base64.cpp**

```
#include "base64.h"
#include <iostream>

static const std::string base64_chars = 
             "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
             "abcdefghijklmnopqrstuvwxyz"
             "0123456789+/";

static inline bool is_base64(unsigned char c) {
  return (isalnum(c) || (c == '+') || (c == '/'));
}

std::string base64_encode(unsigned char const* bytes_to_encode, unsigned int in_len) {
  std::string ret;
  int i = 0;
  int j = 0;
  unsigned char char_array_3[3];
  unsigned char char_array_4[4];

  while (in_len--) {
    char_array_3[i++] = *(bytes_to_encode++);
    if (i == 3) {
      char_array_4[0] = (char_array_3[0] & 0xfc) >> 2;
      char_array_4[1] = ((char_array_3[0] & 0x03) << 4) + ((char_array_3[1] & 0xf0) >> 4);
      char_array_4[2] = ((char_array_3[1] & 0x0f) << 2) + ((char_array_3[2] & 0xc0) >> 6);
      char_array_4[3] = char_array_3[2] & 0x3f;

      for(i = 0; (i <4) ; i++)
        ret += base64_chars[char_array_4[i]];
      i = 0;
    }
  }

  if (i)
  {
    for(j = i; j < 3; j++)
      char_array_3[j] = '\0';

    char_array_4[0] = (char_array_3[0] & 0xfc) >> 2;
    char_array_4[1] = ((char_array_3[0] & 0x03) << 4) + ((char_array_3[1] & 0xf0) >> 4);
    char_array_4[2] = ((char_array_3[1] & 0x0f) << 2) + ((char_array_3[2] & 0xc0) >> 6);
    char_array_4[3] = char_array_3[2] & 0x3f;

    for (j = 0; (j < i + 1); j++)
      ret += base64_chars[char_array_4[j]];

    while((i++ < 3))
      ret += '=';

  }

  return ret;

}

std::string base64_decode(std::string const& encoded_string) {
  int in_len = encoded_string.size();
  int i = 0;
  int j = 0;
  int in_ = 0;
  unsigned char char_array_4[4], char_array_3[3];
  std::string ret;

  while (in_len-- && ( encoded_string[in_] != '=') && is_base64(encoded_string[in_])) {
    char_array_4[i++] = encoded_string[in_]; in_++;
    if (i ==4) {
      for (i = 0; i <4; i++)
        char_array_4[i] = base64_chars.find(char_array_4[i]);

      char_array_3[0] = (char_array_4[0] << 2) + ((char_array_4[1] & 0x30) >> 4);
      char_array_3[1] = ((char_array_4[1] & 0xf) << 4) + ((char_array_4[2] & 0x3c) >> 2);
      char_array_3[2] = ((char_array_4[2] & 0x3) << 6) + char_array_4[3];

      for (i = 0; (i < 3); i++)
        ret += char_array_3[i];
      i = 0;
    }
  }

  if (i) {
    for (j = i; j <4; j++)
      char_array_4[j] = 0;

    for (j = 0; j <4; j++)
      char_array_4[j] = base64_chars.find(char_array_4[j]);

    char_array_3[0] = (char_array_4[0] << 2) + ((char_array_4[1] & 0x30) >> 4);
    char_array_3[1] = ((char_array_4[1] & 0xf) << 4) + ((char_array_4[2] & 0x3c) >> 2);
    char_array_3[2] = ((char_array_4[2] & 0x3) << 6) + char_array_4[3];

    for (j = 0; (j < i - 1); j++) ret += char_array_3[j];
  }

  return ret;
} 
```

完成 base64 实现后，您可以创建要传递的字符串。

```
std::string encoded = base64_encode(data, sizeof(data)); 
```

但是您必须注意，您的数据会通过将其编码为 Base64 来扩展，因此您的上传时间会更长，因为数据会更大。它将大约大 37%（参见[http://en.wikipedia.org/wiki/Base64](http://en.wikipedia.org/wiki/Base64)的 MIME 部分）

要解码另一端的数据，您只需执行以下操作。

```
byte[] data = System.Convert.FromBase64String(yourParameterName); 
```

# java - 如何通过 web.xml 仅为某些 servlet 启用安全性

> ID：13746508
> 
> 赞同：-1
> 
> 时间：2012-12-06T15:07:56.860
> 
> 标签：java, jakarta-ee, servlets, web.xml

**设想：**

应该为某些 servlet 启用安全性（仅通过凭据访问），但对其他 servlet 则不启用。全部通过 web.xml。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:07:56.860

**这是如何完成的：**

首先是安全角色+登录配置：

```
<security-role>
  <description>
    Main user for admin GUI
  </description>
  <role-name>admin</role-name>
</security-role>

<login-config>
  <auth-method>BASIC</auth-method>
  <realm-name>my login</realm-name>
</login-config> 
```

应该公开访问的这个 servlet：

```
<servlet>
  <description>Landing Page for Admin GUI</description>
  <display-name>StartServlet</display-name>
  <servlet-name>StartServlet</servlet-name>
  <servlet-class>StartServlet</servlet-class>
</servlet>

<servlet-mapping>
  <servlet-name>StartServlet</servlet-name>
  <url-pattern>/index.html</url-pattern>
</servlet-mapping> 
```

所有页面的限制（只能通过管理员用户访问）：

```
<security-constraint>
  <web-resource-collection>
    <web-resource-name>Private</web-resource-name>
    <description>Matches all pages</description>
    <url-pattern>/*</url-pattern>
  </web-resource-collection>
  <auth-constraint>
     <role-name>admin</role-name>
  </auth-constraint>
</security-constraint> 
```

公开的只有那些：

```
<security-constraint>
  <web-resource-collection>
    <web-resource-name>Public</web-resource-name>
    <description>Makes the landing page explicitly public (overrides Private above since more specific!)</description>
    <url-pattern>/index.html</url-pattern>
  </web-resource-collection>
  <!-- No auth-constraint = everybody has access! -->
</security-constraint> 
```

# android - Android：MySQL数据传递失败

> ID：13746513
> 
> 赞同：0
> 
> 时间：2012-12-06T15:08:04.863
> 
> 标签：android, mysql

我正在尝试从 mysql DB 获取一些数据并将其打印在文本视图中。我正在处理一个查询，该查询使用 _POST 通过我的应用程序传递的数据来识别行。

那是.java：

```
 @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_calendario);

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);

    app_preferences = PreferenceManager.getDefaultSharedPreferences(this);

    LoginClass ID_P =  ((LoginClass)getApplicationContext());
    id_user = ID_P.getID();
    Log.d("id_w?",id_user);

    text = (TextView) findViewById(R.id.text_pren);
    fill_text();

}

private void fill_text(){

    try{
        httpclient = new DefaultHttpClient();
        httppost = new HttpPost("******MY URI*******");
        response = httpclient.execute(httppost);
        prenotazione = new ArrayList<NameValuePair>(1);
        prenotazione.add(new BasicNameValuePair("id_user",id_user));
        httppost.setEntity(new UrlEncodedFormEntity(prenotazione));
        Log.d("gladdi",prenotazione.toString());
        HttpEntity entity = response.getEntity();
        inputStream = entity.getContent();

        } 
        catch (Exception e){
            Toast.makeText(CalendarioActivity.this, "error"+e.toString(), Toast.LENGTH_LONG).show();
        }
            if(inputStream != null){
            Log.d("glad2",id_user);
            try{
                BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream,"iso-8859-1"),8);
                StringBuilder sb = new StringBuilder();
                String line = null;
                while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                }
                inputStream.close();
                result = sb.toString();

                Log.d("sort",result);
            }catch(Exception e){
                Log.e("TEST", "Errore nel convertire il risultato "+e.toString());
                }
        try{
            JSONArray jArray = new JSONArray(result);
            prenotazioni = "";
            for(int i=0;i<jArray.length();i++){
                JSONObject json_pren = jArray.getJSONObject(i);
                result_string = "Prenotazione in data "+json_pren.getString("data")+", "+json_pren.getString("dettagli")+"\n\n";
                prenotazioni = prenotazioni + result_string;
                }
            }catch(JSONException e){
                Log.e("log_tag", "Error parsing data "+e.toString());
                    }   
        }else{
            //do nothing
        }

            text.setText(prenotazioni);
}//end fill_text() 
```

……

如果我在浏览器上使用它的查询它可以工作（替换_POST - > _GET），但不是当我启动应用程序时......就像字符串“id_user”没有传递......我希望我很清楚。你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:32:12.320

我确信这只是一个疏忽，但它有助于在获得结果之前发送参数。

改变这个：

```
 response = httpclient.execute(httppost);
    prenotazione = new ArrayList<NameValuePair>(1);
    prenotazione.add(new BasicNameValuePair("id_user",id_user));
    httppost.setEntity(new UrlEncodedFormEntity(prenotazione)); 
```

对此：

```
 prenotazione = new ArrayList<NameValuePair>(1);
    prenotazione.add(new BasicNameValuePair("id_user",id_user));
    httppost.setEntity(new UrlEncodedFormEntity(prenotazione));
    response = httpclient.execute(httppost); 
```

# javascript - 许多类的jQuery选择器不起作用

> ID：13746515
> 
> 赞同：0
> 
> 时间：2012-12-06T15:08:06.580
> 
> 标签：javascript, jquery

```
<a class="control selected" id="control1" rel="1" href="#"></a>
<a class="control" id="control2" rel="2" href="#"></a>
<a class="control" id="control3" rel="3" href="#"></a> 
```

我有一个 jQuery Slider，在这样的标签中有缩略图：

为了使其动态化，我尝试选择每个

```
$('#control1.control').css("background-color", "red");
$('#control1.control.selected').css("background-color", "green"); 
```

第一个选择器有效，但不是第二个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:12:30.527

这应该工作，

```
$('#control1.control.selected').css("background-color", "green"); 
```

这是对其他[问题](https://stackoverflow.com/questions/1041344/jquery-multiple-class-selector)的解释，但是是的，在查询中使用单个 id：

```
$('#control1') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:47:46.093

两个选择器都有效。看我用红色突出显示第一个，用绿色突出显示第二个：

```
<a class="control" id="control1" rel="1" href="#">1</a>
<a class="control selected" id="control2" rel="2" href="#">2</a>
<a class="control" id="control3" rel="3" href="#">3</a>
<script>
$('#control1.control').css("background-color", "red");
$('#control2.control.selected').css("background-color", "green");
</script> 
```

# c++ - 运算符 new[] 不接收额外字节

> ID：13746517
> 
> 赞同：7
> 
> 时间：2012-12-06T15:08:10.490
> 
> 标签：c++, operator-overloading, new-operator, destructor

我有这样的代码

```
#include <cstdlib>

class Foo
{
    int m_data;

public :    
    Foo() : m_data(0) { }

    /*~Foo()
    {
    }*/

    static void* operator new[](const size_t size)
    {
        return malloc(size);
    }

    static void operator delete[](void* data)
    {
        free(data); 
    }
};

int main()
{
    Foo* objects = new Foo[5];

    delete [] objects;
} 
```

在这种情况下，我收到`size`in operator new 重载的值作为我想要的 20 个字节（`sizeof(int) * 5`）。但是如果我取消注释析构函数，我会得到`size`24 个字节。是的，我现在这些额外的字节用于存储分配内存的大小，等于`sizeof(size_t)`. 我不明白为什么只有当我明确地实现析构函数时才能得到它们。如果我不这样做，编译器应该做同样的事情还是我错过了什么？

我已经在 MSVS 2010 和 2012 上尝试过。为 Win32 编译。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:13:29.477

"Extra bytes" requested by `new[]` from `operator new[]` are not used to "store the size of allocated memory", as you seem to believe. They are used to store the *number of elements* in the array, so that the `delete[]` will know how many destructors to call. In your example destructors are trivial. There's no need to call them. So, there's no need to allocate these extra bytes and store the element count.

The "size of allocated memory" (i.e. the size of the block *in bytes*) is a completely different story. It is stored and retrieved independently by a lower-level allocator - the `malloc/free` in your example.

In other words, in general case a memory block allocated by `new[]` has two sets of extra bytes in front of the actual data: the block size in bytes (introduced by `malloc`) and the element count (introduced by `new[]`). The second one is optional, as your example demonstrates. The first one is typically always present, as it is unconditionally allocated by `malloc`. I.e. your `malloc` call will physically allocate more than `20` bytes even if you request only `20`. These extra bytes will be used by `malloc` to store the block size in bytes.

The latter happens in your example as well. You simply don't see it since it happens inside `malloc`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-06T15:11:47.703

如果编译器不需要调用析构函数，它就不需要记住要调用多少个析构函数。如果您有一个需要破坏的数据成员，例如 ，您将不会观察到这种行为`std::string`，因为编译器总是需要破坏它。

# c - C 中带有 const 签名的错误调用

> ID：13746526
> 
> 赞同：6
> 
> 时间：2012-12-06T15:08:47.580
> 
> 标签：c, warnings, constants

> **可能重复：**
> [为什么将（指向非 const 的指针的指针）转换为（指向 const 的指针的指针）是不合法的](https://stackoverflow.com/questions/2220916/why-isnt-it-legal-to-convert-pointer-to-pointer-to-non-const-to-a-pointer-to)

为什么我会在以下调用 foo 时收到警告 (gcc 42.2)？

```
void foo(const char **str)
{
  (*str)++;  
}

(...)
char **str;
foo(str);
(...) 
```

我理解为什么我们不能用 a 调用除 a 之外的函数`char **`，`const char **`但相反的情况对我来说似乎没问题，那么为什么会出现以下警告？

```
warning: passing argument 1 of 'foo' from incompatible pointer type 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T15:15:32.923

这是错误的。这里没有与编译器争论的真正空间，因为它受到规范的支持。这是一个示例，它准确地解释了错误的原因：

```
void func(const char **p)
{
    *p = "abc";
}

void func2(void)
{
    char *a;
    func(&a);
    *a = 'x';
} 
```

如果编译器没有吐出错误，您的程序可能会崩溃，因为您将覆盖字符串文字（通常在内存中标记为只读）。

所以你不能隐式`char **`转换为，`const char **`因为它允许你`const`从任何值中删除限定符——基本上，它允许你`const`在没有显式转换的情况下随意忽略。

编译器给出警告而不是错误的主要原因是因为许多旧代码没有使用`const`今天编写的代码所使用的限定符。

# jquery - 尝试将 json 对象发送到控制器时，json 文本中的字符串无效

> ID：13746528
> 
> 赞同：1
> 
> 时间：2012-12-06T15:08:50.183
> 
> 标签：jquery, ajax, ruby-on-rails-3, json

我正在尝试将 json 对象从 javascript 发送到 rails 控制器，但我不断收到此错误

```
 MultiJson::DecodeError (lexical error: invalid string in json text.
                                   tag=hello
                 (right here) ------^ 
```

我正在使用 yajl、rails 3.1、jquery 1.6。

***在 gemfile* gem 'yajl-ruby'中**设置Yajl****

 ***配置/应用程序.rb*

```
 require 'yajl/json_gem' 
```

**我的代码**

*ajax函数*

```
 var myobj={"tag":"hello"};
    $.ajax({
    url: 'ips/create',
    type: 'post',
    contentType: 'application/json; charset=UTF-8',
    accept: 'application/json',
    dataType: 'json',
    data:$.param(myobj),

    success: function(res) {
        if (res.ImportResponse !== void 0) {
            console.log('Success: ' + res);
        } else if (res.Fault !== void 0) {
            console.log('Fault: ' + res);
        }
    },
    error: function() {
        console.error('error!!!!');
    }
   });

*In controller*

     parser = Yajl::Parser.new
     hash = parser.parse(request.body.read) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:29:30.443

您应该使用该请求发送 json 数据，而不是参数字符串。

```
...
data: JSON.stringify(myobj),
... 
```**

# html - 用于在每个列表项之前显示带有复选框的缩进有序列表的 CSS

> ID：13746540
> 
> 赞同：3
> 
> 时间：2012-12-06T15:09:18.533
> 
> 标签：html, css, html-lists

我不确定这是否可能，但我正在尝试在每个列表项前面设置一个带有复选框的有序列表，如下所示：

1.  我希望在项目编号左侧有一个复选框，并换行到句子中的第一个单词，而不是项目编号。
2.  与项目编号 1 相同，需要在项目编号左侧有一个复选框并换行到句子中的第一个单词。

[我已经使用这个问题](https://stackoverflow.com/q/10428720/27457)弄清楚了缩进的东西，但无法让复选框显示在与`<li>`. 有没有办法做到这一点？

这是[我一直在弄乱的 jsFiddle](http://jsfiddle.net/syltech/9v97V/)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T15:14:50.050

[http://jsfiddle.net/9v97V/2/](http://jsfiddle.net/9v97V/2/)

你可以做这样的事情。您将输入放在列表项中，然后将其绝对定位，使其出现在列表项之前。

最相关的 CSS：

```
li input
{
    position: absolute;
    margin-left: -40px;
    margin-top: 5px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:19:11.283

我根据你的制作了一个新的 jsFiddle：http: [//jsfiddle.net/3VESY/1/](http://jsfiddle.net/3VESY/1/)

基本上我已经将文本放在一个跨度（也可以是一个 div）中，并在输入上放置一个浮点数。span 有一个 padding-left 来创建缩进。希望那是你需要的？

```
ol {
    list-style-type:decimal;
    margin-left:20px;
}

ol li span {
    display:block;
    padding-left:30px;
}
input
{
    float:left;
} 
```

编辑更新的小提琴：http: [//jsfiddle.net/3VESY/1/](http://jsfiddle.net/3VESY/1/)添加数字

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-06T17:34:53.093

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            form{
                border: 2px solid #f1f1f1;
                text-align: left;
                }

            ol{
                margin-left:40%; 
                font-weight:bold;   
            }
        </style>
    </head>

    <body>

        <div class="container">
            <form action="/action.php">
                <ol type="A" style="color: red" >
                    <li><p >CSE</p></li>
                    <ol type="i" style="margin-left:-13%; color: blue">
                        <li>
                            <input type="checkbox" id="cb1" name="op1">
                            <label for="cb1"> Artificial Intelligence</label>
                        </li><br>
                        <li>
                            <input type="checkbox" id="cb2" name="op2">
                            <label for="cb2">Machine Learning</label>
                        </li>   
                    </ol><br>
                    <li><p>ECE</p></li>
                    <ol type="A" style="margin-left:-13%; color: blue">
                        <li>
                            <input type="checkbox" id="cb3" name="op3">
                            <label for="cb3">Embedded Systems</label>
                        </li><br>
                        <li>
                            <input type="checkbox" id="cb4" name="op4">
                            <label for="cb4">IOT</label>
                        </li><br>
                    </ol>
                </ol>       
            </form>
        </div>

    </body>
</html> 
```

# crc - CRC8 、 CRC16 和 CRC32 有什么不同？

> ID：13746541
> 
> 赞同：5
> 
> 时间：2012-12-06T15:09:17.563
> 
> 标签：crc

我想知道区别以及如何为不同的 crc 选择多项式生成器？

在一些 C 代码中，他们有查找表来计算 crc，其中一些是通过异或真值表来完成的。但在这两种情况下，它都是 1byte 数据数组。它令人困惑。有人也可以解释一下吗？

谢谢。！

# c# - 使用 lambda 通过 System.Reflection 提取成员信息

> ID：13746545
> 
> 赞同：0
> 
> 时间：2012-12-06T15:09:28.097
> 
> 标签：c#, database, .net-4.0, linq-to-objects, system.reflection

我正在尝试使用系统`Reflection`来启用类`member`（类型`int`）的提取

```
var CurrTblID = typeof(currProjData).GetMembers(
                                  BindingFlags.Public |BindingFlags.Static
                                 ).Select(t => t.Name)...what expresssion should I put here? 
```

这将公开一个`enumerator`带有接口的`iEnumerable`, 并将其分配给 `CurrTblID`

所以我可以使用`foreach`循环，找到哪个“表ID”`Tid`是当前的

*   **如何在没有 foreach 的情况下获取特定字段名称并找出其值？**

问题的来源在`currProjData`类中，如下所示。

如果需要答案的一些背景：

在这段代码中，我使用了一个结构，该结构可以设置`Sql server`数据库表的详细信息以供以后使用。

我在 sql server 中找不到答案，所以我制作了一个结构来保存自定义`index`- 作为`ID`我将在我的应用程序中使用的每个表的数字。

```
 public class DBMetaDetails
            {
                public struct DbTable
                {
                    public DbTable(string tableName, int tableId): this()
                    {
                        this.TableName = tableName;
                        this.TableID = tableId;
                    }

                    public string TableName { get;  set; }
                    public int TableID { get;  set; }
                }
            } 
```

`TableID`是我通过该结构使用的自定义数字“id”，所以这就是我可以`SQL table`通过自定义“索引”而不是其数据库名称来引用的方式。

```
public static class currProjData 
{
    static DBMetaDetails.DbTable CustomersMeta = new DBMetaDetails.DbTable();
    static DBMetaDetails.DbTable TimesMeta = new DBMetaDetails.DbTable();

    public static void SetTablesMetaDetails()
    {

        TimesMeta.TableID = HTtIDs.TblTimes;
        TimesMeta.TableName = HTDB_Tables.TblTimes;

        CustomersMeta.TableID = HTtIDs.TblCustomers;
        CustomersMeta.TableName = HTDB_Tables.TblTimeCPAReport;

    }

    public static readonly int CustomersTid = CustomersMeta.TableID;
    public static readonly string CustomersTblName = CustomersMeta.TableName;

    public static readonly int TimesTid = TimesMeta.TableID;
    public static readonly string TimesTblName = TimesMeta.TableName;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T19:28:19.053

> How Can i get to a specific field name and find out its value without the foreach?

Create a generic extension Method which will handle any object and then internally do a FirstOrDefault:

```
public static int ExtractIntProperty<T>( this T targetItem, string propertyName )
{

   int result = 0;

   var prop = targetItem.GetType()
                        .GetProperties()
                        .FirstOrDefault( prp => prp.Name == propertyName );

   if (prop != null)
   {
      var val = prop.GetValue( targetItem, null );

      if (val != null)
         result = (int) val;
   }

   return result;

} 
```

Then get the value as such (casting to show that it handles unknown objects)

```
object detail = (object) new DBMetaDetails.DbTable() { TableName = "Jabberwocky", TableID = 12 };

Console.WriteLine ( detail.ExtractIntProperty("TableID") ); // 12 
```

# java - 在tomcat服务器中加载Jar

> ID：13746546
> 
> 赞同：0
> 
> 时间：2012-12-06T15:09:37.407
> 
> 标签：java, tomcat, jar

在 WEB-INF/lib foo.jar 中备份到 foo_backup.jar 会影响项目吗？

我的确切问题是...

如果我做上述事情，它会加载两个jar吗？foo.jar 和 foo_backup.jar？

并且因为两个 jar 里面都包含相同的类。当我使用某个类时会考虑哪个（考虑 com.test.TestClass）？是 foo.jar 还是 foo_backup.jar？

有人可以请教吗？我可以删除那个 foo_backup.jar 但我想知道如果出现这种情况会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:19:59.937

而不是`foo_backup.jar`创建一个名称为 的备份`foo.jar.backup`。

尽管如此，如果您使用备份，`foo_backup.jar`那么我认为`foo.jar`将首先加载它，因为它首先出现在列表中，但仍然怀疑，它可能会导致问题（假设备份是旧版本），因为两个 jars 以及其中的类都将可用在类路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:20:25.240

我认为类加载器只会选择第一个并仅加载它，但这将取决于类加载器的实现，这通常不是您可以控制的。这可能会导致各种讨厌的错误。我建议使用@fvu 的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:39:06.683

使用 name(-data).bak 调用备份绝对是一个好习惯 括号中的数据是可选的，因为它在您将拥有多个备份的情况下很有用，因此您可以跟踪最近的那些。

# php - 如果匹配字符串，则删除标签但保留标签之间的内容

> ID：13746548
> 
> 赞同：3
> 
> 时间：2012-12-06T15:09:41.443
> 
> 标签：php, match, remove-if

我有文件php：

```
<?php
$content = "
<script>
include string show_ads_1 and other string 1
</script>

<script>
include string show_ads_2 and other string 2
</script>

<script>
include string show_ads_x and other string x
</script>

<script>
not include 'show  _  ads  _  x' --> keeping this
</script>

<script type=\"text/javascript\">
include string 'show_ads_x' but keeping this because <script type='text/javascript'> not <script>
</script>
";

//Only remove tag <script></script> if includes "show_ads" string
$content = preg_replace('/(<script>)(show_ads.*?)(<\/script>)/s', '$2', $content);
echo $content;
?> 
```

如果`<script>...</script>`包含字符串“show_ads_”之间的内容，它将删除`<script>`并`</script>`保留所有内容。

但上面的脚本不起作用。什么都没有删除。我想在运行它并查看源代码时看起来像：

```
include string show_ads_1 and other string 1

include string show_ads_2 and other string 2

include string show_ads_x and other string x

<script>
not include 'show  _   ads  _  x' --> keeping this
</script>

<script type="text/javascript">
include string 'show_ads_x' but keeping this because <script type='text/javascript'> not <script>
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:49:18.290

代替：

```
$content = preg_replace('/(<script>)(show_ads.*?)(<\/script>)/s', '$2', $content); 
```

和：

```
$content = preg_replace('/(<script>)([^<]*show_ads_[^<]*)(<\/script>)/s', '$2', $content); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:45:22.210

使用[DOMDocument](http://php.net/domdocument)执行该操作，如下所示：

```
<?php

$dom = new DOMDocument();
$content = "
    <script>
    include string show_ads_1 and other string 1
    </script>

    <script>
    include string show_ads_2 and other string 2
    </script>
    ....
    <script>
    include string show_ads_x and other string x
    </script>

    <script>
    include string bla bla bla
    </script>

    <script>
    not include 'show  _   ads  _  x' --> keeping this
    </script>

    <script type='text/javascript'>
    must keeping script
    </script>

    <script type='text/javascript'>
    include string 'show_ads_x' but keeping this because <script type='text/javascript'> not <script>
    </script>    
";

$dom->loadHTML($content);
$scripts = $dom->getElementsByTagName('script');

foreach ($scripts as $script) {
    if (!$script->hasAttributes()) {
        if (strstr($script->nodeValue, "show_ads_")) {
            echo $script->nodeValue . "<br>";
        }
    } else {
        echo "<script type='text/javascript'>$script->nodeValue</script>" . "<br>";
    }
}

?> 
```

# c# - 使用本地网络中的套接字将文件从 C# 服务器发送到 AS3 AIR 客户端 - 带有示例

> ID：13746553
> 
> 赞同：1
> 
> 时间：2012-12-06T15:09:50.947
> 
> 标签：c#, actionscript-3, apache-flex, sockets, air

我想将文件从 C# 服务器发送到 AS3 Flash 客户端。我用于发送文件的 C# 服务器代码是这样的：

```
IPEndPoint ipEnd = new IPEndPoint(IPAddress.Any, 5656);
Socket sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.IP);
sock.Bind(ipEnd);
sock.Listen(100);
//clientSock is the socket object of client, so we can use it now to transfer data to client
Socket clientSock = sock.Accept();

// This part gets the file and send the data in bytearray
byte[] fileData = File.ReadAllBytes("send/mypicture.jpg");
clientSock.Send(fileData); 
```

现在我需要一个 as3 客户端。我发现了这个： http: [//flasharp.blogspot.pt/2010/03/socket-serverclient-chat.html](http://flasharp.blogspot.pt/2010/03/socket-serverclient-chat.html)我构造了这样的东西：

```
public function Main():void {
    ...
    socket.addEventListener(ProgressEvent.SOCKET_DATA, onResponse);
    ...
}

function onResponse(e:ProgressEvent):void {
    var file:File;
    var fs:FileStream;
    var fileData:ByteArray = new ByteArray();

    // Check if socket has data
    if(socket.bytesAvailable > 0) {
        while(socket.bytesAvailable) {
            // read the socket data into the fileData
            socket.readBytes(fileData,0,0);
        }
    }
    file = File.documentsDirectory.resolvePath("teste.jpg");
    fs = new FileStream();
    fs.open(file, FileMode.WRITE);
    // Writing the file
    fs.writeBytes(fileData);
    fs.close();
} 
```

我已经成功地发送和接收了一个文件，但它最多只能保存 50kbs，任何更大的文件，你只需要拥有那个大小的文件。

关于如何传输任何大小的文件的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T11:00:41.200

我设法解决了这个问题并用示例更新了这篇文章。

**更新和解决**：我想使用本地网络中的套接字将文件从 C# 服务器发送到 AS3 客户端。我在寻找如何做到这一点时遇到了一些麻烦，但我设法做到了。

**服务器 (C#):**
1 - 我创建了一个`TcpListener`侦听具有该网络中任何 IP 到指定端口号的新客户端；
2 - 当一个新客户端连接时，我创建一个`Thread`来处理它；
3 -`Thread`我发送我想要的数据。在这种情况下，数据分为两部分，第一部分是`bytearray`包含我要发送的文件大小的 4，第二部分是`bytearray`文件本身的大小；
4 - 发送数据后，我关闭该客户端连接；

**客户端 (AS3):**
1 - 首先我将我的转换`bytearrays`为`LITTLE_ENDIAN`AIR，因为默认情况下是 AIR，`BIG_ENDIAN`而我从服务器获取的数据是`LITTLE_ENDIAN`；
2 - 将事件添加到套接字连接并连接到服务器；
3 - 在`onResponse`我收到套接字包的功能上`bytearray`;
4 - 将其保存`bytearray`到文件中；

客户端的最后一部分是最棘手的部分，因为我花了一些时间才弄清楚 AIR 是`BIG_ENDIAN`默认的，以及如何读取包。所以基本上，我所做的是，在进来的第一个包中，我将前 4 个字节读取为 a `bytearray`，然后将其转换为 a `int`，这给出了我的总文件大小。我用它来知道什么时候没有更多的包要接收，从而完成连接并保存文件。第一个包的其余部分和后续包被添加到一个`bytearray`这将存储该文件数据本身。这里的解决方法是在第一次收到包裹时开始写，然后在最后一个停止的地方添加后续的包裹，即第一次我从 0 写到 65321，第二个我必须写从 65321 到 XXXX，以此类推。

该文件正在保存到 MyDocuments 文件夹。

我不确定这是否是最好的方法，因为我对套接字连接相当陌生，但是这对我有用，并且我用高达 165MB 的文件进行了测试并且它可以工作。它支持多个客户端连接并且非常基本，但这是一个起点，而不是终点。

我希望这可以帮助其他人，因为它帮助了我，因为我没有在网上找到类似的东西（关于文件传输而不是 C# -> AS3 连接）。

如果有人想输入一些信息或需要澄清某些事情，请随时询问。

最后但同样重要的是，可以在此处下载示例：http: [//sdrv.ms/W5mSs9](http://sdrv.ms/W5mSs9)（C# Express 2010 中的服务器和带有 Flex SDK 4.6.0 的 Flash Builder 4.6 中的客户端）

如果上面链接中的示例在这里消失了，那就是

动作脚本 3 源代码：

```
package
{
    import flash.display.Sprite;
    import flash.display.StageAlign;
    import flash.display.StageScaleMode;
    import flash.events.Event;
    import flash.events.IOErrorEvent;
    import flash.events.ProgressEvent;
    import flash.events.SecurityErrorEvent;
    import flash.filesystem.File;
    import flash.filesystem.FileMode;
    import flash.filesystem.FileStream;
    import flash.net.Socket;
    import flash.system.Security;
    import flash.utils.ByteArray;
    import flash.utils.Endian;
    import flash.text.TextField;

    public class FileTransferLocal extends Sprite
    {
        private var socket:Socket = new Socket();
        private var file:File;
        private var fs:FileStream = new FileStream();
        private var fileData:ByteArray = new ByteArray();
        private var fileSize:ByteArray = new ByteArray();

        private var fileDataPosition:int = new int();
        private var fileDataFlag:int = new int();
        private var fileSizeFlag:int = new int();
        private var fileSizeCounter:int = new int();

        private var fileDataPreviousPosition:int = new int();

        private var myText:TextField = new TextField();

        public function FileTransferLocal()
        {           
            try {Security.allowDomain("*");}catch (e) { };

            // Convert bytearray to Little Endian
            fileSize.endian = Endian.LITTLE_ENDIAN;
            fileData.endian = Endian.LITTLE_ENDIAN;
            socket.endian = Endian.LITTLE_ENDIAN;

            fileSizeFlag = 0;
            fileDataFlag = 0;

            myText.width = 150;
            myText.height = 150;
            myText.x = 200;
            myText.y = 200;

            socket.addEventListener(Event.CONNECT, onConnect);
            socket.addEventListener(Event.CLOSE, onClose);
            socket.addEventListener(IOErrorEvent.IO_ERROR, onError);
            socket.addEventListener(ProgressEvent.SOCKET_DATA, onResponse);
            socket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, onSecError);

            // Put the IP and port of the server
            socket.connect("10.1.1.211", 5656);
        }

        private function onConnect(e:Event):void {
            trace("onConnect\n");
        }

        private function onClose(e:Event):void {
            trace("onClose");
            socket.close();
        }

        private function onError(e:IOErrorEvent):void {
            trace("IO Error: "+e);
        }

        private function onSecError(e:SecurityErrorEvent):void {
            trace("Security Error: "+e);
        }

        private function onResponse(e:ProgressEvent):void {         

            if(!fileSizeFlag) {
                socket.readBytes(fileSize, 0, 4);
                fileSize.position = 0;
                fileSizeFlag = 1;
                fileSizeCounter = fileSize.readInt();
                trace("fileSizeCounter -> " + fileSizeCounter);
            }

            trace("---- New package ----> " + socket.bytesAvailable);

            if(fileSizeCounter > 0) {
                fileSizeCounter -= socket.bytesAvailable;

                if(fileDataPosition != 0) {
                    fileDataPreviousPosition += fileDataPosition;
                }

                if(fileData.length == 0) {
                    fileDataPreviousPosition = socket.bytesAvailable;
                    socket.readBytes(fileData, 0, socket.bytesAvailable);
                } else {
                    fileDataPosition = socket.bytesAvailable;
                    socket.readBytes(fileData, fileDataPreviousPosition, socket.bytesAvailable);
                }
            }

            // Saves the file
            if(fileSizeCounter == 0) {
                trace("File total size" + fileData.length);
                file = File.documentsDirectory.resolvePath("test.mp3");
                fs.open(file, FileMode.WRITE);
                fs.writeBytes(fileData);
                fs.close();

                myText.text = "File successefully\nreceived!";
                addChild(myText);

            }
            // Is still receiving packages
            else {
                myText.text = "Receiving file...";
                addChild(myText);
            }

        }
    }
} 
```

在 C# 中创建一个新的 Windows 应用程序
添加一个
ListBox 调用它 statusList
标签调用它端口
标签调用它状态

上面示例中的 C# 源代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;
using System.Threading;
using System.Net;
using System.IO;
using System.Reflection;

namespace ServerThread
{
    public partial class ServerThread : Form
    {
        private TcpListener tcpListener;
        private Thread listenThread;

        public ServerThread()
        {
            InitializeComponent();

            // Port number
            int portNumber = 5656;
            port.Text = portNumber.ToString();

            // Create a TcpListener to cover all existent IP addresses with that port
            this.tcpListener = new TcpListener(IPAddress.Any, portNumber);
            // Create a Thread to listen to clients
            this.listenThread = new Thread(new ThreadStart(ListenForClients));
            this.listenThread.Start();

        }

        private void ListenForClients()
        {
            this.tcpListener.Start();

            while (true)
            {
                // Blocks until a client has conected to the server
                TcpClient client = this.tcpListener.AcceptTcpClient();

                // Create a Thread to handle the conected client communication
                Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientComm));
                clientThread.Start(client);
            }
        }

        private void HandleClientComm(object client)
        {
            // Receive data
            TcpClient tcpClient = (TcpClient)client;
            NetworkStream clientStream = tcpClient.GetStream();

            while (true)
            {
                try
                {
                    // Sending data
                    string filePath = "send/mysong.mp3"; // Your File Path;
                    byte[] fileData = File.ReadAllBytes(filePath); // The size of your file
                    byte[] fileSize = BitConverter.GetBytes(fileData.Length); // The size of yout file converted to a 4 byte array
                    byte[] clientData = new byte[fileSize.Length + fileData.Length]; // The total byte size of the data to be sent

                    fileSize.CopyTo(clientData, 0); // Copy to the file size byte array to the sending array (clientData) beginning the in the 0 index
                    fileData.CopyTo(clientData, 4); // Copy to the file data byte array to the sending array (clientData) beginning the in the 4 index

                    // Send the data to the client
                    clientStream.Write(clientData, 0, clientData.Length);
                    clientStream.Flush();

                    // Debug for the ListBox
                    if (statusList.InvokeRequired)
                    {
                        statusList.Invoke(new MethodInvoker(delegate {
                            statusList.Items.Add("Client IP: " + tcpClient.Client.RemoteEndPoint.ToString());
                            statusList.Items.Add("Client Data size: " + clientData.Length);
                        }));
                    }

                }
                catch
                {
                    // 
                    break;
                }

                if (statusList.InvokeRequired)
                {
                    statusList.Invoke(new MethodInvoker(delegate
                    {
                        statusList.Items.Add("File successefully sent!");
                    }));
                }

                // Close the client
                tcpClient.Close();
            }

        }
    }
} 
```

# git - git: 'send-email' 不是 git 命令。见'git --help'

> ID：13746554
> 
> 赞同：69
> 
> 时间：2012-12-06T15:09:53.757
> 
> 标签：git

我正在尝试使用 发送补丁，`git send-email`但出现以下错误：

```
git: 'send-email' is not a git command. See 'git --help'. 
```

如何制作`git send-email`作品？

相关链接：

[http://www.kernel.org/pub/software/scm/git/docs/git-send-email.html](http://www.kernel.org/pub/software/scm/git/docs/git-send-email.html)

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-12-06T15:22:27.313

您需要安装该`git-email`软件包才能使其正常工作。

上`Ubuntu`，通常`apt-get install git-email`工作正常。我也可以确认`Fedora`（`yum install git-email`）。

[cebewee](https://stackoverflow.com/users/647987/cebewee)在评论中提到了理由：

> Linux 发行版通常喜欢拆分包以避免仅由可选功能（如发送电子邮件）所需的依赖项。

请注意，您必须在开始之前对其进行[配置](http://blog.bisect.de/2012/01/how-to-send-patches-via-git-send-email.html)。

# hadoop - 访问hadoop分布式缓存中的文件

> ID：13746561
> 
> 赞同：8
> 
> 时间：2012-12-06T15:10:09.560
> 
> 标签：hadoop

我想使用分布式缓存来允许我的映射器访问数据。主要是，我正在使用命令

```
DistributedCache.addCacheFile(new URI("/user/peter/cacheFile/testCache1"), conf); 
```

其中 /user/peter/cacheFile/testCache1 是 hdfs 中存在的文件

然后，我的设置函数如下所示：

```
public void setup(Context context) throws IOException, InterruptedException{
    Configuration conf = context.getConfiguration();
    Path[] localFiles = DistributedCache.getLocalCacheFiles(conf);
    //etc
} 
```

但是，此 localFiles 数组始终为空。

我最初在单主机集群上运行以进行测试，但我读到这将阻止分布式缓存工作。我尝试使用伪分布式，但这也不起作用

我正在使用 hadoop 1.0.3

谢谢彼得

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-09T02:27:46.527

这里的问题是我正在执行以下操作：

```
Configuration conf = new Configuration();
Job job = new Job(conf, "wordcount");
DistributedCache.addCacheFile(new URI("/user/peter/cacheFile/testCache1"), conf); 
```

由于 Job 构造函数会生成 conf 实例的内部副本，因此之后添加缓存文件不会影响任何事情。相反，我应该这样做：

```
Configuration conf = new Configuration();
DistributedCache.addCacheFile(new URI("/user/peter/cacheFile/testCache1"), conf);
Job job = new Job(conf, "wordcount"); 
```

现在它可以工作了。感谢 Harsh on hadoop 用户列表的帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-11T09:53:51.780

```
Configuration conf = new Configuration();  
Job job = new Job(conf, "wordcount");
DistributedCache.addCacheFile(new URI("/userpetercacheFiletestCache1"),job.getConfiguration()); 
```

你也可以这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-06T09:03:48.817

一旦作业被分配给一个配置对象，即`Configuration conf = new Configuration();`

```
Job job = new Job(conf, "wordcount"); 
```

然后如果处理 conf 的属性，如下所示，例如

```
conf.set("demiliter","|"); 
```

或者

```
DistributedCache.addCacheFile(new URI("/user/peter/cacheFile/testCache1"), conf); 
```

此类更改不会反映在伪集群或集群中，无论它如何与本地环境一起工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-10T00:12:28.340

这个版本的代码（与上述结构略有不同）一直对我有用。

```
//in main(String [] args)
Job job = new Job(conf,"Word Count"); 
...
DistributedCache.addCacheFile(new URI(/user/peter/cacheFile/testCache1), job.getConfiguration()); 
```

我没有在 Mapper 代码中看到完整的 setup() 函数

```
public void setup(Context context) throws IOException, InterruptedException {

    Configuration conf = context.getConfiguration();
    FileSystem fs = FileSystem.getLocal(conf);

    Path[] dataFile = DistributedCache.getLocalCacheFiles(conf);

    // [0] because we added just one file.
    BufferedReader cacheReader = new BufferedReader(new InputStreamReader(fs.open(dataFile[0])));
    // now one can use BufferedReader's readLine() to read data

} 
```

# c# - P/Invoke 是否为目标 DLL 提供更少的内存？

> ID：13746562
> 
> 赞同：2
> 
> 时间：2012-12-06T15:10:13.490
> 
> 标签：c#, memory, pinvoke, dllimport

我的问题是我有一个无法修改的 32 位 DLL。在正常操作下，DLL 有时可能需要大约 1.5 gigs 左右的内存。

当我使用 C++/非托管代码测试程序时，DLL 只会在大约 2 gigs 时耗尽内存。这是预期的，因为这是 32 位进程可用的最大大小。因此，DLL 在正常操作下运行良好。

从本身占用大约 250 MB 的 C# 应用程序 IP/调用 DLL 时，当整个进程达到大约 1.4 gigs 时，DLL 会出错。我的问题是 P/Invoke 是否为 32 位进程提供了更少的内存供使用？有什么办法可以给它更多吗？

编辑：P/Invoked 函数实际上是从我的主要组件引用的 C# 程序集中调用的。不确定这是否以任何方式相关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:13:26.870

The difference is probably because your managed program has greater needs than the unmanaged program. And so there are fewer resources left for your DLL. Programs can run out of memory even when there appears to be memory left. This happens when the address space is fragmented and the virtual memory allocator cannot find a large enough contiguous block of memory to meet an allocation request.

There's not much you can do about that I suspect. I doubt you'll have much luck trying to make your managed process consume fewer resources. If you run on a 64 bit system and your process is large address aware then your process can access have 4GB of memory.

Marking your .net executable as `LARGEADDRESSAWARE` might well help. For details please refer to another SO question: [How to make a .NET application "large address aware"?](https://stackoverflow.com/questions/1346480/how-to-make-a-net-application-large-address-aware) In summary you need to run the `EDITBIN` tool to mark your executable:

```
EDITBIN /LARGEADDRESSAWARE YourExeName.exe 
```

Be aware though that on a 32 bit OS you are pretty much stuck with the 2GB limit. Yes you can boot your system with the /3GB switch but this is generally not to be advised.

The other obvious option would be to house the DLL in an out of process COM server. By putting it in a different process you could keep the .net runtime out of the process and leave as much space as possible for the hungry DLL.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:24:05.683

这可能会发生，因为您的 c++ 应用程序设置了 LARGEADDRESSAWARE 选项而 c# 应用程序没有

在 c++ 应用程序中，它在这里定义-> 链接器-> 系统-> 启用大地址 = "Yes/LARGEADDRESSAWARE"

尝试添加以下构建后事件

```
call "$(DevEnvDir)..\..\vc\vcvarsall.bat" x86
"$(DevEnvDir)..\..\vc\bin\EditBin.exe" "$(TargetPath)"  /LARGEADDRESSAWARE 
```

# javascript - 使用 jquery 获取元素位置

> ID：13746563
> 
> 赞同：3
> 
> 时间：2012-12-06T15:10:17.683
> 
> 标签：javascript, jquery

我想使用 JQuery 查找元素位置。不是使用 .position 的 X 和 Y 位置。

举个例子

```
<ul>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
</ul> 
```

和 js

```
//return the li pos
$('li').click(function(){...}) 
```

例如，如果我单击第三个 li 函数返回 li pos 女巫是 2

我尝试了一些东西，但它不起作用

```
$('li').click(function(){
    for(var i = 0; i < $('li').length; i++){
        if($('li:eq('+i+')') == $(this)){
            alert(i);
            return true;
        }
    }
    alert('fail');
    return false;
}) 
```

我总是失败

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-06T15:12:02.290

使用[**index()**](http://api.jquery.com/index/)获取位置。它给了你`zero-based index`，所以你会得到`0`第一个元素。

**[现场演示](http://jsfiddle.net/rajaadil/R76Zc/)**

```
$('li').click(function(){    
    alert($(this).index())
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T15:13:50.353

You can simply use `.index()` to find the position of li

```
$('li').click(function(){
    alert($(this).index());
})​ 
```

Demo: [http://jsfiddle.net/muthkum/2mR5U/](http://jsfiddle.net/muthkum/2mR5U/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:15:02.857

您可以使用该`prev()`方法返回前一个元素。

```
$('li').click(function() {
    var previous = $(this).prev();

    console.log(previous.index());
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:16:00.683

试试看（[http://jsfiddle.net/DfXwq/](http://jsfiddle.net/DfXwq/)）：

```
$('li').click(function(e){
    var target = e.target,
        parent = target.parentNode
        number = $(parent).children().index(target );

    console.log(number);
});​ 
```

# c# - 如何将 Web api 用作 Web 服务？

> ID：13746570
> 
> 赞同：8
> 
> 时间：2012-12-06T15:10:30.027
> 
> 标签：c#, asp.net, web-services, c#-4.0, asp.net-web-api

我已经创建了一个测试 ASP.Net Web Api，现在我想知道如何在我的 Windows 窗体应用程序中将它用作 Web 服务？

当前 url 是`http://localhost:59682`，当我添加`http://localhost:59682`或`http://localhost:59682/api/`或`http://localhost:59682/api/products/`作为 Web 服务引用时，我收到此错误：`There was an error downloading 'http://localhost:59682/api/products/$metadata'. The request failed with HTTP status 400: Bad Request. Metadata contains a reference that cannot be resolved: 'http://localhost:59682/api/products/'. The remote server returned an unexpected response: (405) Method Not Allowed. The remote server returned an error: (405) Method Not Allowed. If the service is defined in the current solution, try building the solution and adding the service reference again.`

这是我的 web.config：

```
<?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <configSections>
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
  </configSections>
  <connectionStrings>
    <add name="DefaultConnection" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-WebApiLearning-20121206172000;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-WebApiLearning-20121206172000.mdf" />
  </connectionStrings>
  <appSettings>
    <add key="webpages:Version" value="2.0.0.0" />
    <add key="webpages:Enabled" value="false" />
    <add key="PreserveLoginUrl" value="true" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5" />
    <authentication mode="None" />
    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
      </namespaces>
    </pages>
    <profile defaultProvider="DefaultProfileProvider">
      <providers>
        <add name="DefaultProfileProvider" type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" applicationName="/" />
      </providers>
    </profile>
    <membership defaultProvider="DefaultMembershipProvider">
      <providers>
        <add name="DefaultMembershipProvider" type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
      </providers>
    </membership>
    <roleManager defaultProvider="DefaultRoleProvider">
      <providers>
        <add name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" applicationName="/" />
      </providers>
    </roleManager>
    <!--
            If you are deploying to a cloud environment that has multiple web server instances,
            you should change session state mode from "InProc" to "Custom". In addition,
            change the connection string named "DefaultConnection" to connect to an instance
            of SQL Server (including SQL Azure and SQL  Compact) instead of to SQL Server Express.
      -->
    <sessionState mode="InProc" customProvider="DefaultSessionProvider">
      <providers>
        <add name="DefaultSessionProvider" type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" />
      </providers>
    </sessionState>
  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework>
</configuration> 
```

这是我的`ProductsController`

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Web.Http;
using WebApiLearning.Models;

namespace WebApiLearning.Controllers
{
    public class ProductsController : ApiController
    {

        Product[] products = new Product[] 
        { 
            new Product { Id = 1, Name = "Tomato Soup", Category = "Groceries", Price = 1.39M }, 
            new Product { Id = 2, Name = "Yo-yo", Category = "Toys", Price = 3.75M }, 
            new Product { Id = 3, Name = "Hammer", Category = "Hardware", Price = 16.99M } 
        };

        public IEnumerable<Product> GetAllProducts()
        {
            return products;
        }

        public Product GetProductById(int id)
        {
            var product = products.FirstOrDefault((p) => p.Id == id);
            if (product == null)
            {
                var resp = new HttpResponseMessage(HttpStatusCode.NotFound);
                throw new HttpResponseException(resp);
            }
            return product;
        }

        public IEnumerable<Product> GetProductsByCategory(string category)
        {
            return products.Where(
                (p) => string.Equals(p.Category, category,
                    StringComparison.OrdinalIgnoreCase));
        }
    }
} 
```

这是`Product`模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace WebApiLearning.Models
{
    public class Product
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Category { get; set; }
        public decimal Price { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-06T15:19:14.807

您不能向 Web Api 添加服务引用，因为它只是一个允许您通过 HTTP 公开功能的框架（基本上您在控制器上调用方法）。

我建议您安装**Web API 客户端库**

看看下面的链接

[http://www.asp.net/web-api/overview/web-api-clients/calling-a-web-api-from-a-net-client](http://www.asp.net/web-api/overview/web-api-clients/calling-a-web-api-from-a-net-client)

# web-services - Web 服务的单元测试（服务参考） - xml 反序列化

> ID：13746571
> 
> 赞同：0
> 
> 时间：2012-12-06T15:10:33.673
> 
> 标签：web-services, unit-testing, c#-4.0, deserialization, rhino-mocks

**总之**

我需要一种将 XML 字符串反序列化为通常由 3rd 方 Web 服务返回的对象的方法。

使用 C#。

**详细地**

我有使用第 3 方服务引用（Web 服务）的代码 - 所以通常的东西：我们传入一个 Request 对象，它返回一个 Response 对象。

关于单元测试 - 我对服务参考的内部工作不感兴趣，因为这是第 3 方服务。我只对两件事感兴趣：

1.  我的代码是否生成正确的请求对象？
2.  当服务参考返回它的响应时，我是否正确处理了这个响应？

依次取每个：

**我的代码是否生成正确的请求对象？**

这是我能做到的。如果有人对此感兴趣，我所做的就是用 RhinoMocks Mock 对象替换我的服务引用。在我的单元测试中，我在 Mock 上调用该方法，然后检查传入的参数，将实际的 Request 对象与预期的 Request 对象进行比较。

**当服务参考返回它的响应时，我是否正确处理了这个响应？**

我在这里要做的是为我的服务引用创建一个 RhinoMocks 存根，这样当它被调用时，这个存根返回一个填充了我的测试数据的响应对象。

我面临的问题是这个特定的 3rd 方服务返回的响应对象非常复杂。如果我试图通过手动对所有属性值进行硬编码来创建一个，那么这可能会占用我一整天的时间。

但是，我可以很容易地从该服务捕获 XML 序列化响应。然后我可以轻松地编辑它的值并将这个 XML 存储在我的一个单元测试中。

我所追求的是一种简单的方法，然后将这个“测试”XML“反序列化”为响应对象，并使用它来对来自我的存根的响应进行编程。

任何帮助将非常感激。

谢谢

格里夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:08:23.330

事实证明这很简单：

```
public static object Deserialize(string xml, Type toType)
{
    using(Stream stream = new MemoryStream())
    {
        byte[] data = System.Text.Encoding.UTF8.GetBytes(xml);
        stream.Write(data, 0, data.Length);
        stream.Position = 0;
        var s = new XmlSerializer(toType, "http://^your url^");
        return s.Deserialize(stream);
    }
} 
```

请注意，如果您在 SOAP 请求中使用 XML，请先剥离 SOAP 信封。

格里夫

# jquery-ui - jQuery：如何仅对一个标签禁用/制作异常？

> ID：13746572
> 
> 赞同：3
> 
> 时间：2012-12-06T15:10:36.453
> 
> 标签：jquery-ui

我正在使用 .tooltip 对整个页面中的每一个进行简单描述。它适用于所有内容，但页面的标题名称（不仅仅是图标和菜单）显示在屏幕的左下方。如何仅对以单词“step”开头的标题标签进行例外处理？谢谢。

```
$.widget( "ui.tooltip", {
version: "1.9.2",
options: {
    content: function() {
        return $( this ).attr( "title" );
    },
    hide: true,
    // Disabled elements have inconsistent behavior across browsers (#8661)
    items: "[title]:not([disabled])",
    position: {
        my: "left top+15",
        at: "left bottom",
        collision: "flipfit flip"
    },
    show: true,
    tooltipClass: null,
    track: false,

    // callbacks
    close: null,
    open: null
}, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T09:33:44.273

`items`只需为您的定义使用普通的 jquery 选择器：

```
items: '[title^="step"]:not([disabled])', 
```

应该做的伎俩，更多选择器的乐趣，请参阅[jquery选择器文档](http://api.jquery.com/category/selectors/?rdfrom=http://docs.jquery.com/mw/index.php?title=Selectors&redirect=no)

@edit：我刚刚重新阅读了您的问题，要排除标题开头带有“step”一词的项目，请使用以下命令：

```
items: '[title]:not([disabled]):not([title^="step"])', 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T14:31:18.880

```
<style type="text/css">
/* hide the html title tag from on-screen display */
    #ui-tooltip-0 {
        display: none !important;
        visibility: hidden !important;
    }
</style> 
```

# jquery - 带有点击事件的 on() 什么都不做

> ID：13746577
> 
> 赞同：4
> 
> 时间：2012-12-06T15:10:57.017
> 
> 标签：jquery

我在动态创建的 div 内有一个 id 为“close”的 div，id 为“box”。以下代码旨在每当用户单击关闭时执行某些操作。

```
$('#box').on('click','#close',function(){
    alert(1); // Test to see if the click works
}); 
```

我正在使用 Big Cartel CMS，如果我在“实时预览模式”中单击关闭，它似乎工作正常，但每当我实际发布该站点并正常查看它时，它绝对什么都不做 - 没有错误 - nada。

标记和 CSS，以防万一：

```
<div id="box"> <!-- Dynamically loaded -->
    <div id="close"></div>
    <h2 id="name"></h2>
    <div id="description">
        <p>blah...</p>
    </div>
</div>

#close{
    background: url(image-path);
    float: right;
    position: relative;
    top: 0;
    margin: 0 0 0 12px;
    width: 25px;
    height: 25px;
    cursor: pointer;
    z-index: 100;
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:13:26.107

问题是因为`#box`也是动态的。您需要主选择器是加载页面时可用的元素。

主要候选人将是您正在加载的元素`#box`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T15:13:44.983

您需要挂钩到现有元素，而不是动态创建的元素：

```
$(document).on('click','#box #close',function(){
    alert(1); // Test to see if the click works
}); 
```

编辑：不挂钩文档的更好解决方案 :) 避免了 dom 遍历。

```
$("#boxesparentid").on('click','#close',function(){
    alert(1); // Test to see if the click works
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T15:17:17.557

当您使用事件委托（例如使用`.on`您的方式）时，您将事件绑定到*更高*的元素，`DOM`然后检查每个冒泡的事件以查看它是否与选择器匹配。要意识到的重要部分是，您需要确保您绑定到的元素当前存在于 DOM 中（不需要冒泡的元素）。

在您的情况下，由于*box*也是动态的，因此您的事件没有绑定到任何东西，您可以改为绑定到存在的文档或当前位于`DOM`

例如

```
$(document).on('click','#close',function(){
    alert(1); // Test to see if the click works
}); 
```

# php - 如何在 for 循环之外获取值？

> ID：13746578
> 
> 赞同：1
> 
> 时间：2012-12-06T15:10:57.687
> 
> 标签：php

我正在发送酒店列表请求。我的网址是：

```
&numberOfRooms=2&room-0-adult-total=1&room-0-child-total=1&room-1-adult-total=1&room-1-child-total=0&room-0-child-0-age=2&button=搜索
```

我需要这个方法的结果：

```
&room1=2,3,5（2 名成人，2 名 3 和 5 岁儿童）
&room2=2,10（2 名成人，1 名 10 岁儿童）

```

我怎样才能得到这个输出？

这是我的代码：

```
for ($i=0;$i<$arraoy[numberOfRooms];$i++)
{
    echo"room_adut$i=";
    echo $adult[] = $arraoy['room-'.$i.'-adult-total'];
    $child =$arraoy['room-'.$i.'-child-total'];
    echo",";

    for($j=0;$j<$child =$arraoy['room-'.$i.'-child-total'];$j++)
    {
        echo $age[]= $arraoy['room-'.$i.'-child-'.$j.'-age'];
        echo",";
    }

    echo"<br>";
} 
```

我可以打印内部for循环，结果是正确的。但是我怎样才能得到for循环之外的值呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:15:38.057

如果我理解正确，您希望`$age`变量在循环外可访问。如果是这样，只需在循环之前定义它。通常在循环外定义变量以包含循环完成后的值。

```
$age = array();
for() {
  ...
}
// Handle $age values 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:18:46.233

尝试使用以下代码

```
$arrvar="";
for($i=0;$i<$arraoy[numberOfRooms];$i++){
  $arrvar.="room_adut$i=";

  $arrvar.= $arraoy['room-'.$i.'-adult-total'];
  $child =$arraoy['room-'.$i.'-child-total'];
  $arrvar.=",";
  for($j=0;$j<$child =$arraoy['room-'.$i.'-child-total'];$j++)
  {
    $arrvar.= $arraoy['room-'.$i.'-child-'.$j.'-age'];
    $arrvar.=",";
  }
  $arrvar.="<br>";
} 

echo $arrvar; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:24:20.300

您可以使用数组来收集所有数据，然后在每个循环结束时用逗号分隔它们：

```
for ($i = 0; $i < $arraoy['numberOfRooms']; $i++) {
    $prefix = "room-$i";

    $values = array($arraoy["$prefix-adult-total"]);

    for($j = 0; $j < $arraoy["$prefix-child-total"]; $j++) {
        $values[] = $arraoy["$prefix-child-$j-age"];
    }
    echo 'room' . ($i + 1) . '=' . join(',', $values), '<br>';
} 
```

# spss - 从命令行在远程服务器上运行生产 SPSS 作业

> ID：13746581
> 
> 赞同：1
> 
> 时间：2012-12-06T15:11:11.557
> 
> 标签：spss

我们有一个基于 Windows 的 SPSS 服务器，比如 10.20.30.40。我们想从另一台服务器 10.20.30.50 启动 SPSS Production 作业。

我们可以使用批处理文件开始工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-01T19:03:42.073

1.在生产中创建一个SPJ文件。2.制作一个bat文件来运行spj

“C:\Program Files\IBM\SPSS\Statistics\21\stats.exe”-生产“K:\Meinzer\Production\SPJ\DashBoardInsert.spj”

1.  在 Windows 中创建“计划任务”。

真正的问题是从工作中获得输出。为此，我使用 python。

我使用这样的语法

```
begin program.
AlertDays=4
Files=['k:\meinzer/Production\dashboarddatasets/aod_network_report.sps',
'k:\meinzer/Production\push/aod_network_reportpush.sps',
'k:\meinzer/Production\pushproduction/aod_network_reportpushP.sps']
end program.
insert file='k:/meinzer/production/ps/errorTestPickles.sps'. 
```

触发这个

```
*still needs error info passed.

set mprint=off /printback=on.

begin program.

#test files to observe - uncomment out 8 or 9
#Files=['k:\meinzer/Production\dashboarddatasets/test.sps']
#Files=['k:\meinzer/Production\dashboarddatasets/testfail.sps']
#Files=['k:\meinzer/Production\dashboarddatasets/clinfo.sps']
#Files=['k:\meinzer/Production\dashboarddatasets/CSOC_Consecutive_High_Level_Svcs.sps']

import shutil
import spss
import re, os, pickle
from datetime import datetime

def main(Files):
    """The parser and processor for Syntax Error Reporting """
    try:
        for FilePath in Files:
                Start = datetime.now().replace( microsecond=0)
                DBname, init_Syntax = init_Vars(FilePath)
                cmds = init_cmds(init_Syntax)
                cmd=''
                cmd2=''
                cmd3=''
                try:
                    for cmd in cmds:
                     cmd=cmd.replace('\r\n','\n ')
                     cmd=cmd.replace('\t',' ')
                     print cmd
                     spss.Submit(cmd)  
                     cmd3=cmd2
                     cmd2=cmd    
#                    cmd, cmd2, cmd3=run_cmds(cmd,cmd2,cmd3,cmds) 
                    Finish = datetime.now().replace( microsecond=0)                    
                    spss_Output(DBname)       
                    SavedNewname=check_saved_new_name(DBname)
                    if SavedNewname==1:
                        send_result(DBname,'Failure',Start,Finish,0,cmd,cmd2,cmd3)
                        break
                    if SavedNewname==0:
                        send_result(DBname,'Success',Start,Finish,1,AlertDays)
                except Exception,e:   
                    Finish = datetime.now().replace( microsecond=0)
                    errorLevel, errorMsg = get_spss_error(e)
                    send_result(DBname,"Failure in code",Start,Finish,0,AlertDays,cmd,cmd2,cmd3,errorLevel, errorMsg )
                    spss_Output(DBname)
                    break

    except IOError:
        print "can't open file or difficulty initializing comands from spss"
        send_result('Can not open File %s' % DBname,Start,Finish)
        spss_Output(DBname)

def init_Vars(FilePath):
    FilePath=FilePath.encode('string-escape')
    #FilePath= map(os.path.normpath, FilePath)
    FilePath=FilePath.replace('\\','/')
    FilePath=FilePath.replace('/x07','/a')
    FilePath=FilePath.replace('//','/')
    FilePath=FilePath.replace('/x08','/b')
    FilePath=FilePath.replace('/x0b','/v')
    FilePath=FilePath.replace('/x0c','/v')
    print 'this is the file path..................... '+FilePath
    DBname = os.path.split(os.path.normpath(FilePath))[-1]
    #if '\\' in FilePath:
    #    DBname=FilePath.rpartition('\\')[-1]
    #if '/' in FilePath:
    #    DBname=FilePath.rpartition('/')[-1]
    init_Syntax=FilePath
    OutputClose="output close name=%s." % DBname
    OutputNew="output new name=%s." %  DBname
    spss.Submit(OutputClose)
    spss.Submit(OutputNew)
    return (DBname, init_Syntax)

def init_cmds(init_Syntax):
    with open(init_Syntax,'rb') as f:
        BOM_UTF8 = "\xef\xbb\xbf" 
        code = f.read().lstrip(BOM_UTF8) 
        #r = re.compile('(?<=\.)\s*?^\s*',re.M)
        r = re.compile('(?<=\.)\s*?^\s*|\s*\Z|\A\s*',re.M)
        cmds = r.split(code) 
        #cmds = re.split("(?<=\\.)%s[ \t]*"   %    os.linesep, code, flags=re.M) 
        #cmds = re.split(r'(?<=\.)[ \t]*%s' % os.linesep, code, flags=re.M)
        cmds = [cmdx.lstrip() for cmdx in cmds if not cmdx.startswith("*")] 
        return cmds

def run_cmds(cmd,cmd2,cmd3,cmds):
    for cmd in cmds:
        cmd=cmd.replace('\r\n','\n ')
        cmd=cmd.replace('\t',' ')
        print cmd
        spss.Submit(cmd)  
        cmd3=cmd2
        cmd2=cmd       
    return (cmd, cmd2, cmd3)

def send_result(DBname,result,Start,Finish,status,AlertDays,cmd='',cmd2='',cmd3='',errorLevel='', errorMsg=''):
    """ """
    print result + ' was sent for '+DBname
    FinishText = Finish.strftime("%m-%d-%y %H:%M")
    StartText = Start.strftime("%m-%d-%y %H:%M")
    Runtimex = str(Finish-Start)[0:7]
    error_result="""%s %s
    Start             Finish           Runtime Hrs:Min:Sec
    %s    %s   %s """ % (DBname,result,StartText,FinishText,Runtimex)

    error_result_email="""%s <br>
  %s <br> Runtime %s <br>\n""" % (result,DBname,Runtimex)

    with open("k:/meinzer/production/output/Error Log.txt", "r+") as myfile:
        old=myfile.read()
        myfile.seek(0)
        if status==1:
           myfile.write(error_result+"\n\n"+ old)
        if status==0:
           myfile.write(error_result+'\n'+'This was the problem\n'+errorLevel+" "+ errorMsg+'\n'+cmd3+'\n'+cmd2+'\n'+cmd+"\n\n"+ old)
#    with open("k:/meinzer/production/output/email Log.txt", "r+") as emailtext:
#                 olde=emailtext.read()
#                 emailtext.seek(0)
#                 emailtext.write(error_result_email+ olde)
    with open("k:/meinzer/production/output/ErrorCSV.txt", "r+") as ErrorCSV:
                      oldcsv=ErrorCSV.read()
                      ErrorCSV.seek(0)
                      ErrorCSV.write(DBname+','+str(status)+','+FinishText+",0"+','+str(AlertDays)+"\n"+ oldcsv)

def check_saved_new_name(DBname):
    """ check saved new name"""
    with open("k:/meinzer/production/output/text/"+DBname+".txt", "r") as searchfile:
        if 'Warning # 5334' in open("k:/meinzer/production/output/text/"+DBname+".txt", "r").read():
           SavedNewname=True
        else:
           SavedNewname=False   
    return SavedNewname

def get_spss_error(e):
    print 'Error', e
    errorLevel=str(spss.GetLastErrorLevel())
    errorMsg=spss.GetLastErrorMessage()
    return (errorLevel, errorMsg)

def spss_Output(DBname):
    """ """
    outputtext="output export /text documentfile='k:/meinzer/production/output/text/%s.txt'." %  DBname
    outputspv="output save outfile='k:/meinzer/production/output/%s.spv'." % DBname
    spss.Submit(outputspv)  
    spss.Submit(outputtext)

main(Files)

end program. 
```

# c# - HtmlAgilityPackSanitizerProvider 无法加载类型

> ID：13746582
> 
> 赞同：0
> 
> 时间：2012-12-06T15:11:12.287
> 
> 标签：c#, asp.net, html-sanitizing

我的问题是，我正在尝试使用 HTML 扩展编辑器。我安装了ajaxcontroltoolkit。到目前为止一切顺利，控制工具包工作正常，但我需要清理。所以我下载了htmlagilitypack并像这样使用它：（还在控件上添加了EnableSanitization =“true”）

在 webconfig 中添加：

```
<sectionGroup name="system.web">
<section name="sanitizer" requirePermission="false" type="AjaxControlToolkit.Sanitizer.ProviderSanitizerSection, AjaxControlToolkit" />
</sectionGroup> 
```

和 ：

```
<sanitizer defaultProvider="HtmlAgilityPackSanitizerProvider">
  <providers>
    <add name="HtmlAgilityPackSanitizerProvider" type="AjaxControlToolkit.Sanitizer.HtmlAgilityPackSanitizerProvider"></add>
  </providers>
</sanitizer> 
```

但是当我使用 ajaxcontrol 加载我的页面时，它显示以下错误：

无法加载类型“AjaxControlToolkit.Sanitizer.HtmlAgilityPackSanitizerProvider”

我引用了所有 dll（AjaxControlToolkit、HtmlAgilityPack、SanitizersProviders）。[我第一次](https://stackoverflow.com/questions/11376700/how-to-set-image-upload-location-in-htmleditorextender-and-enabling-sanitization)和[第二次](https://stackoverflow.com/questions/12022493/could-not-load-type-ajaxcontroltoolkit-sanitizer-antixsssanitizerprovider)阅读了这篇文章，但没有帮助我。我能做些什么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:37:07.670

我解决了这个问题。似乎这是 dll 版本的问题，我拥有的 sanitizersProviders 与 HtmlAgilityPack 1.4.6 不兼容，但与 1.4.0 不兼容，我不得不猜测，因为除了我提到的错误之外没有其他错误出现。

# html - 与 div 元素不同，具有 contenteditable 的 Span 元素不会自然失去焦点

> ID：13746587
> 
> 赞同：0
> 
> 时间：2012-12-06T15:11:31.400
> 
> 标签：html, css, contenteditable

> JsFiddle：http: [//jsfiddle.net/sharat87/qWCQT/](http://jsfiddle.net/sharat87/qWCQT/)

正如您在上面的 jsfiddle 中可以（或不能）看到的那样，当您单击带有 的`div`元素下方时`contenteditable`，它会失去焦点，这是理所当然的。但是当你对一个带有 的`span`元素做同样的事情时`contenteditable`，它*不会*失去焦点。此外，`div`具有样式的元素的行为与此场景中的元素`display: inline-block`完全相同。`span`

在我的应用程序布局中，我需要将`contenteditable`元素显示为`inline-block`. 但是当单击下面给出的空白区域时，它应该失去焦点，这是明确提供的，用于失去焦点和特定于上下文的目的。我不希望`contenteditable`元素保持焦点。

有什么办法解决这个问题，除了通过javascript处理点击和`blur`-ing元素吗？`contenteditable`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:28:05.467

我刚刚添加`style/display property`了 JavaScript，具体取决于`Browser`它并且它有效

```
window.onload=function(){
    var ua=navigator.userAgent;
    var spans=document.getElementsByTagName('span');
    for(i=0;i<spans.length;i++)
    {
        if(spans[i].className=='content')
        {
            if(ua.indexOf('MSIE')!=-1) spans[i].style.display='inline-block'; 
            else spans[i].style.display='inline-table'; 
        }
    }
}; 
```

在 Chrome、FF、IE8 和 Opera 中测试。这里有一个[例子](http://jsfiddle.net/qWCQT/2/)。

# javascript - 标题 DIV 在 Safari 中调整大小时消失，但在 Firefox 和 Safari Mobile 中有效

> ID：13746591
> 
> 赞同：4
> 
> 时间：2012-12-06T15:11:55.340
> 
> 标签：javascript, css, html

所以我的标题遇到了这个问题。我的网站是自适应的，当它达到平板电脑大小时，导航变成一个下拉框。当我在 Firefox 中调整窗口大小时，它会很好地降级，但在 Safari 中，当它到达开关时，整个标题就会消失。我一直在努力工作，发现当我移除滑块或将滑块显示设置为“无”时，它可以工作。当滑块在那里时，我无法判断标题 div 是在滑块后面还是一起消失了。

天哪，这里发生了什么？

这是网站。 [http://www.benstephan.com/html](http://www.benstephan.com/html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T12:53:07.580

您的网站在 firefox、chrome 和 safari 中也可以正常工作（使用 5.17 版测试）。可能您需要更新 safari 然后进行测试。顺便说一句很酷的网站。

# android - 尝试签署应用程序时出现致命的 lint 错误

> ID：13746593
> 
> 赞同：0
> 
> 时间：2012-12-06T15:11:58.247
> 
> 标签：android, fatal-error, lint

当我尝试签署我的应用程序以便创建密钥库以获取 Google Maps API 密钥时，我收到此错误。

```
"so and so" is not translated in bg, ca, cs, de, es, fi, fr, id, it, iw, ja, ko, lt, lv, nl, no, pl, pt, pt-rBR, ru, 
 sv, vi, yr, zh-rCN, zh-rTW 
```

有什么解决办法吗？

# php - 正则表达式搜索 2 个字符串之间的可选通配符

> ID：13746594
> 
> 赞同：3
> 
> 时间：2012-12-06T15:11:59.870
> 
> 标签：php, regex

我见过类似的问题，但我不能完全让它们适用于我的场景。

我正在尝试使用正则表达式在 2 个字符串之间查找可选通配符。以下是正则表达式正确找到的字符串示例：`not happy`

如果字符串是： `not very happy`

代码必须仍然匹配这两种情况。

我的代码是：

`/\b(?<=not(*?).)happy\b/`

（`happy`并且`very`将是变量）

任何为我指明正确方向的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:29:10.773

可能需要进行一些调整，但这将匹配“不”和“快乐”之间的两个词：

```
/not(?:\s+\w+){0,2}\s+happy/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:40:32.973

这个 ...

```
/not +([^ ]* +)?happy/ 
```

并随意更换**？**使用**{0,2}**（例如）匹配*not*和*happy*之间最多 2 个单词。

# python - 酸洗时保留 numpy 视图

> ID：13746601
> 
> 赞同：9
> 
> 时间：2012-12-06T15:12:30.960
> 
> 标签：python, numpy, view, pickle

默认情况下，酸洗一个 numpy 视图数组会丢失视图关系，即使数组基础也被酸洗了。我的情况是我有一些复杂的容器对象被腌制。在某些情况下，一些包含的数据是其他一些数据的视图。保存每个视图的独立数组不仅是空间的损失，而且重新加载的数据也失去了视图关系。

一个简单的例子是（但在我的情况下，容器比字典更复杂）：

```
import numpy as np
import cPickle

tmp = np.zeros(2)
d1 = dict(a=tmp,b=tmp[:])    # d1 to be saved: b is a view on a

pickled = cPickle.dumps(d1)
d2 = cPickle.loads(pickled)  # d2 reloaded copy of d1 container

print 'd1 before:', d1
d1['b'][:] = 1
print 'd1 after: ', d1

print 'd2 before:', d2
d2['b'][:] = 1
print 'd2 after: ', d2 
```

这将打印：

```
d1 before: {'a': array([ 0.,  0.]), 'b': array([ 0.,  0.])}
d1 after:  {'a': array([ 1.,  1.]), 'b': array([ 1.,  1.])}
d2 before: {'a': array([ 0.,  0.]), 'b': array([ 0.,  0.])}
d2 after:  {'a': array([ 0.,  0.]), 'b': array([ 1.,  1.])} # not a view anymore 
```

我的问题：

(1) 有办法保存吗？（2）（甚至更好）有没有办法只有在基础被腌制的情况下才能做到这一点

对于 (1) 我认为可能有一些方法可以通过更改视图数组的`__setstate__`,`__reduce_ex_`等...。但我现在对这些没有信心。对于（2）我不知道。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-10-25T19:04:21.797

这不是在 NumPy 中完成的，因为腌制基本数组并不总是有意义的，并且腌制不会公开检查另一个对象是否也作为其 API 的一部分被腌制的能力。

但是这种检查可以在 NumPy 数组的自定义容器中完成。例如：

```
import numpy as np
import pickle

def byte_offset(array, source):
    return array.__array_interface__['data'][0] - np.byte_bounds(source)[0]

class SharedPickleList(object):
    def __init__(self, arrays):
        self.arrays = list(arrays)

    def __getstate__(self):
        unique_ids = {id(array) for array in self.arrays}
        source_arrays = {}
        view_tuples = {}
        for array in self.arrays:
            if array.base is None or id(array.base) not in unique_ids:
                # only use views if the base is also being pickled
                source_arrays[id(array)] = array
            else:
                view_tuples[id(array)] = (array.shape,
                                          array.dtype,
                                          id(array.base),
                                          byte_offset(array, array.base),
                                          array.strides)
        order = [id(array) for array in self.arrays]
        return (source_arrays, view_tuples, order)

    def __setstate__(self, state):
        source_arrays, view_tuples, order = state
        view_arrays = {}
        for k, view_state in view_tuples.items():
            (shape, dtype, source_id, offset, strides) = view_state
            buffer = source_arrays[source_id].data
            array = np.ndarray(shape, dtype, buffer, offset, strides)
            view_arrays[k] = array
        self.arrays = [source_arrays[i]
                       if i in source_arrays
                       else view_arrays[i]
                       for i in order]

# unit tests
def check_roundtrip(arrays):
    unpickled_arrays = pickle.loads(pickle.dumps(
        SharedPickleList(arrays))).arrays
    assert all(a.shape == b.shape and (a == b).all()
               for a, b in zip(arrays, unpickled_arrays))

indexers = [0, None, slice(None), slice(2), slice(None, -1),
            slice(None, None, -1), slice(None, 6, 2)]

source0 = np.random.randint(100, size=10)
arrays0 = [np.asarray(source0[k1]) for k1 in indexers]
check_roundtrip([source0] + arrays0)

source1 = np.random.randint(100, size=(8, 10))
arrays1 = [np.asarray(source1[k1, k2]) for k1 in indexers for k2 in indexers]
check_roundtrip([source1] + arrays1) 
```

这可以显着节省空间：

```
source = np.random.rand(1000)
arrays = [source] + [source[n:] for n in range(99)]
print(len(pickle.dumps(arrays, protocol=-1)))
# 766372
print(len(pickle.dumps(SharedPickleList(arrays), protocol=-1)))
# 11833 
```

# ios - 单击滚动视图中的按钮，而不是单击“Autoscroll”示例代码中的屏幕，

> ID：13746604
> 
> 赞同：1
> 
> 时间：2012-12-06T15:12:41.963
> 
> 标签：ios, button, scrollview

在Apple示例代码中：“Autoscroll” - “ScrollViewSuite”示例代码的第二个示例代码，当点击屏幕时，通过以下代码从底部弹出一个拇指视图（slide-up）：

# 杂注标记 TapDetectingImageViewDelegate 方法

```
- (void)tapDetectingImageView:(TapDetectingImageView *)view gotSingleTapAtPoint:(CGPoint)tapPoint {
    // 单击显示或隐藏缩略图抽屉。
    [自我切换拇指视图];
}

`enter code here` 

现在，我向 UIView 添加了一个垂直滚动视图（其中包含按钮），当单击滚动视图中的一个按钮时，会从底部弹出一个拇指视图（滑动）。

如何做到这一点？

谢谢！

```

# git - Git拉和推不起作用

> ID：13746606
> 
> 赞同：3
> 
> 时间：2012-12-06T15:12:43.850
> 
> 标签：git

我从个人 git 服务器克隆了一个空存储库。初始推（`push -u origin master`）后，我遇到了一些错误，但我推了进去。

尝试使用`git push`显示以下内容：

> 没有共同的参考文献，也没有指定；什么也不做。也许您应该指定一个分支，例如“master”。致命：远程端意外挂断错误：未能将一些引用推送到“链接顶部存储库”

然后我尝试了`git push origin master`：

```
Counting objects: 3, done.
Writing objects: 100% (3/3), 218 bytes, done.
Total 3 (delta 0), reused 0 (delta 0)
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require 'git reset --hard' to match
remote: error: the work tree to HEAD.
remote: error: 
remote: error: You can set 'receive.denyCurrentBranch' configuration variable to
remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error: 
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'. 
```

使用时出现问题`git pull`：

> 您的配置指定与远程的 ref 'master' 合并，但没有获取这样的 ref。

我试图检查 .git/config 但它似乎是正确的。

```
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true
        ignorecase = true
[remote "origin"]
        fetch = +refs/heads/*:refs/remotes/origin/*
        url = junior@54blue.com:/repository/regulator
[branch "master"]
        remote = origin
        merge = refs/heads/master
[branc "master"]
        remote = origin 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:47:29.147

假设您对您的个人 git 服务器具有写入权限，您所做的是将更改推送到[非裸存储库](http://www.bitflop.com/document/111)，以及当前作为工作目录签出的分支。

当前常见的良好实践总是推送到裸存储库。要创建它，您可以执行以下操作：

```
git init --bare SomeRepo.git 
```

如果您坚持推送到非裸存储库，不建议这样做，请确保您要推送到的分支不是当前签出的分支或当前工作目录。只需打开命令行工具，例如 Linux 中的终端或 Windows 中的 git bash，移动到您的存储库目录（其中包含 .git 文件夹的目录），执行以下命令：

```
git branch -v 
```

它将显示该存储库的所有可用分支，并且当前签出的分支标有“*”，例如：

```
* master        b0bb0b1 some commit message
  development   babbab2 some other commit message
  experimental  bebbeb3 some commit message in experiment 
```

上面的示例显示 master 是当前签出的分支，因此您无法推送到它。但是您可以推送到其他分支，例如开发或实验。如果您必须推送到 master，您可以使用以下命令将当前目录更改为其他分支：

```
git checkout the_branch_name 
```

在此之后，当前签出的是上面命令中指定的分支，现在可以推送到 master。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:21:12.927

从文件末尾删除它。

```
[branc "master"]
        remote = origin 
```

此外 - 您的开发人员所在的中央 Git 存储库`push`应该是一个裸存储库。您的错误日志显示您的错误日志不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-14T11:18:51.770

我遇到了类似的问题，并在 Unix stack-exchange 中找到了答案： [https ://unix.stackexchange.com/a/166713](https://unix.stackexchange.com/a/166713)

> 就我而言，我的本地分支和远程分支的大小写不同。
> 
> 为了解决这个问题，我删除了本地分支，然后使用and`$ git branch -d branch-name`再次签出远程分支。`$ git fetch``$ git checkout Branch-name`

所以删除本地分支并再次签出远程分支修复它。

# .net - 在 .NET 中的 Web 和辅助角色之间链接实体框架数据库

> ID：13746608
> 
> 赞同：0
> 
> 时间：2012-12-06T15:12:55.793
> 
> 标签：.net, visual-studio, azure, azure-worker-roles, webrole

我有一个同时具有 Web 和 Worker 角色的项目。在 Web 角色中使用实体框架读取和写入数据库工作正常。但是，我在尝试从 Worker 角色访问同一数据库中的数据时遇到问题。似乎没有正确引用数据库，因为当我进行查询时，我知道存在的条目不会被返回。调试时，我的断点显示数据库有 0 个条目，我知道情况并非如此，因为 Web 角色可以毫无问题地访问相同的数据。

我认为问题可能是我缺少的设置或参考，但我还没有弄清楚。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:33:43.483

事实证明，App.config 缺少 Web.config 中存在的整个配置部分。由于 App.config 的部分完全丢失，我不知道该属性也将包含在 App.config 中。

# ajax - JSF/Primefaces AJAX 请求真的是异步的吗？

> ID：13746618
> 
> 赞同：10
> 
> 时间：2012-12-06T15:13:11.487
> 
> 标签：ajax, jsf, primefaces

我是 JSF 的新手，所以我不知道我所面临的行为是否正常。

我有这个代码：

```
<p:selectBooleanCheckbox id="locationChoice1" value="#{login.locationChoice1}">
    <p:ajax listener="#{login.chooseLocationType1}" update="locationChoice1 locationChoice2 positionChoice" />
    <p:ajax listener="#{login.retrieveGalaxies}" update="test"  />
</p:selectBooleanCheckbox> 
```

我的`login.retrieveGalaxies`函数调用`sleep(8000)`函数来模拟延迟。我希望我的组件`locationChoice1`，`locationChoice2`并`positionChoice`在 1 或 2 秒内更新，我的`test`组件将在 8 秒内更新，但都是在 8 秒内更新。

这是正确的行为吗？

我尝试使用`async`参数，但它没有改变结果。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-06T15:36:05.900

它们实际上是异步的（JS 上下文没有被阻塞；也就是说，您可以同时运行其他任意 JS 代码而不会被阻塞）。您看到的行为是因为他们在排队。所以*看起来好像*它们不是异步的。

这种排队行为在[JSF 2 规范](http://jcp.org/aboutJava/communityprocess/final/jsr314/index.html)的第 13.3.2 章中指定：

> ## 13.3.2 Ajax 请求队列
> 
> 所有 Ajax 请求在发送到服务器之前都必须放入客户端请求队列，以确保 Ajax 请求按照发送顺序进行处理。在队列中等待时间最长的请求是下一个要发送的请求。发送请求后，Ajax 请求回调函数必须将请求从队列中移除（也称为出队）。如果请求成功完成，则必须将其从队列中移除。如果出现错误，必须通知客户端，但仍必须从队列中删除请求，以便可以发送下一个请求。必须发送下一个请求（队列中最早的请求）。有关 Ajax 请求队列的更多详细信息，请参阅`jsf.ajax.request` JavaScript 文档。

这样做是为了确保 JSF 视图状态的完整性和线程安全（因此也固有地查看范围 bean）。

# android - How to load and store values of the preferences screen into SQLite DB?

> ID：13746621
> 
> 赞同：0
> 
> 时间：2012-12-06T15:13:14.150
> 
> 标签：android, android-layout, android-sqlite

just added a Preference-Screen into my app. I want to load and store the given values into my sqlite db. I do not know how to solve that, because I dont know how to access the fields in the oncreate of my method, they have no android:id field but an android:key

Here is my layout

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
    android:title="Preferences">

  <PreferenceCategory
     android:title="@string/program_options">

     <CheckBoxPreference         
       android:key="pref_opt1"
       android:title="@string/autoLogin"
       android:summary="@string/autoLoginDescription"
       android:defaultValue="true"
       />

  </PreferenceCategory>

  <PreferenceCategory
     android:title="@string/program_informations">

    <ListPreference
        android:key="pref_type"
        android:title="Type"
        android:summary="Select item from array"
        android:entries="@array/types"
        android:entryValues="@array/types_values"
        android:defaultValue="1"
        />

    <EditTextPreference
        android:key="pref_text"
        android:title="Input text"
        android:summary="Tap to enter some text"
        android:dialogTitle="Enter text"
    />

  </PreferenceCategory>

  <Preference
    android:title="Visit us"
    android:summary="SRS-Management GmbH">

    <intent
      android:action="android.intent.action.VIEW"
      android:data="http://paperdynamix.de/" />

  </Preference>

</PreferenceScreen> 
```

and my Activity where i want to access the fields

```
package de.srs.android.pdixuploader.activies;

import de.srs.android.pdixuploader.R;
import android.os.Bundle;
import android.preference.PreferenceActivity;
import android.widget.CheckBox;

public class Prefs extends PreferenceActivity {

    private CheckBox autoLogin;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        //here I want to read and prefill the values of the fields 

        addPreferencesFromResource(R.layout.preferences);
    }                   
} 
```

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:38:57.380

首先，不需要“预填充”这些值，因为 Android 会自行处理所有需要的值（第一次使用默认值）。

为了获取值，只需使用以下代码：

```
SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(this);
// For example
Boolean pref_opt1 = sp.getBoolean("pref_opt1", true)
// generally
// sp.get[TYPE]("KEY", STANDARD-VALUE); 
```

# sitecore - In Sitecore how can I get the date and time that an item entered a workflow state?

> ID：13746624
> 
> 赞同：3
> 
> 时间：2012-12-06T15:13:20.340
> 
> 标签：sitecore, sitecore6

Given a particular item and a particular workflow state, how can I get the date and time that it entered that workflow state in code?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:28:07.233

You should take a look at `GetHistory` method of `Sitecore.Workflows.HistoryStore` class. It's an abstract class, and its only implementation in clean Sitecore is `Sitecore.Data.SqlServer.SqlServerHistoryStore`.

The `GetHistory` method accepts the item, and returns a list of `WorkflowEvent` elements. Each element contains old state, new state, user who did the action, the user's comment and **the date**. Obviously, that's the date when the state was changed.

Sorry, don't have a sample for you right now, but I hope this hint is helpful.

# c# - AttachedCommandBehaviour MouseEventargs 作为 commandParameter

> ID：13746630
> 
> 赞同：2
> 
> 时间：2012-12-06T15:13:38.723
> 
> 标签：c#, wpf, mvvm

我看到了这个[问题](https://stackoverflow.com/questions/7364780/new-wpf-window-only-shows-underneath-originating-window)，我也有同样的问题，但我在视图模型中有命令。我可以通过吗？`MouseEventargs`如何通过`CommandParameter`？

```
acb:CommandBehavior.Event="MouseDoubleClick" acb:CommandBehavior.Command="{Binding Command}"
acb:CommandBehavior.CommandParameter="{???}" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T21:22:29.993

您需要为此使用 Blend 并使用交互触发器执行类似的操作。在触发 Execute 委托时的命令参数中，将出现 Mouse EventArgs。

```
 <Button>
<i:Interaction.Triggers>
    <i:EventTrigger EventName="MouseDoubleClick" >
         <cmd:EventToCommand Command="{Binding MouseDoubleClickCommand}"
             PassEventArgsToCommand="True" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

如果你不能使用交互 dll 试试这个..

```
public static class MouseDoubleClickBehavior
{
    /// <summary>
    /// Hooks up a weak event against the source Selectors MouseDoubleClick
    /// if the Selector has asked for the HandleDoubleClick to be handled
    ///�
    /// If the source Selector has expressed an interest in not having its
    /// MouseDoubleClick handled the internal reference
    /// </summary>
    private static void OnHandleDoubleClickCommandChanged(DependencyObject d,
        DependencyPropertyChangedEventArgs e)
    {
        FrameworkElement ele = d as FrameworkElement;
        if (ele != null)
        {
            ele.MouseLeftButtonDown -= OnMouseDoubleClick;
            if (e.NewValue != null)
            {
                ele.MouseLeftButtonDown += OnMouseDoubleClick;
            }
        }
    }

    /// <summary>
    /// TheCommandToRun : The actual ICommand to run
    /// </summary>
    public static readonly DependencyProperty DoubleClickCommandProperty =
        DependencyProperty.RegisterAttached("DoubleClickCommand",
            typeof(ICommand),
            typeof(MouseDoubleClickBehavior),
            new FrameworkPropertyMetadata((ICommand)null,
                new PropertyChangedCallback(OnHandleDoubleClickCommandChanged)));

    /// <summary>
    /// Gets the TheCommandToRun property. �
    /// </summary>
    public static ICommand GetDoubleClickCommand(DependencyObject d)
    {
        return (ICommand)d.GetValue(DoubleClickCommandProperty);
    }

    /// <summary>
    /// Sets the TheCommandToRun property. �
    /// </summary>
    public static void SetDoubleClickCommand(DependencyObject d, ICommand value)
    {
        d.SetValue(DoubleClickCommandProperty, value);
    }

    #region Handle the event

    /// <summary>
    /// Invoke the command we tagged.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private static void OnMouseDoubleClick(object sender, MouseButtonEventArgs e)
    {
        //check for double clicks.
        if (e.ClickCount != 2)
            return;
        FrameworkElement ele = sender as FrameworkElement;

        DependencyObject originalSender = e.OriginalSource as DependencyObject;
        if (ele == null || originalSender == null)
            return;

        ICommand command = (ICommand)(sender as DependencyObject).GetValue(DoubleClickCommandProperty);

        if (command != null)
        {
            if (command.CanExecute(null))
                command.Execute(null);
        }
    }
    #endregion
} 
```

并使用此绑定 - MouseDoubleClickBehavior.DoubleClickCommand="{Binding SomeCommand}"

# css - Does google chrome 23 or firefox 17 supports CSS3-Layout?

> ID：13746631
> 
> 赞同：0
> 
> 时间：2012-12-06T15:13:40.213
> 
> 标签：css, layout

Does google chrome 23 or firefox 17 supports CSS3-Layout? [http://www.w3.org/TR/css3-layout/](http://www.w3.org/TR/css3-layout/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:18:28.603

据我所知，目前还没有任何浏览器支持它。

您可以使用 caniuse.com 了解哪些浏览器支持哪些内容。

[http://caniuse.com/#search=layout](http://caniuse.com/#search=layout)

然而，Flexbox 在 Chrome 和 Opera 中受支持，但在 Firefox 中仅部分支持。
[http://www.w3.org/TR/css3-flexbox/](http://www.w3.org/TR/css3-flexbox/)

# kendo-ui - Kendo UI 全球化/语言包

> ID：13746637
> 
> 赞同：25
> 
> 时间：2012-12-06T15:13:48.353
> 
> 标签：kendo-ui

Kendo UI 不附带本地化包。您只能选择一个只设置数字和日期格式的文化文件，而不是小部件中显示的实际文本（例如：寻呼机文本 - 每页项目、下一页等，过滤器菜单（等于等），网格部分（在此处拖动一列......）等）

要本地化一个小部件，必须在每个小部件的单独选项中传递一组消息，以覆盖 Kendo UI 默认使用的消息。像这样的东西：

```
 filterable: {
        messages: {
            info: "Título:", // sets the text on top of the filter menu
            filter: "Filtrar", // sets the text for the "Filter" button
            clear: "Limpar", // sets the text for the "Clear" button

            // when filtering boolean numbers
            isTrue: "é verdadeiro", // sets the text for "isTrue" radio button
            isFalse: "é falso", // sets the text for "isFalse" radio button

            //changes the text of the "And" and "Or" of the filter menu
            and: "E",
            or: "Ou"
        },
        operators: {
            //filter menu for "string" type columns
            string: {
                eq: "Igual a",
                neq: "Diferente de",
                startswith: "Começa com",
                contains: "Contém",
                endswith: "Termina em"
            },
            //filter menu for "number" type columns
            number: {
                eq: "Igual a",
                neq: "Diferente de",
                gte: "Maior que ou igual a",
                gt: "Mair que",
                lte: "Menor que ou igual a",
                lt: "Menor que"
            },
            //filter menu for "date" type columns
            date: {
                eq: "Igual a",
                neq: "Diferente de",
                gte: "Maior que ou igual a",
                gt: "Mair que",
                lte: "Menor que ou igual a",
                lt: "Menor que"
            }
        }
    },
  groupable: {
    messages: {
      empty: "Arraste colunas aqui para agrupar pelas mesmas"
    }
  } 
```

当然，您可以在单个 JavaScript 变量中共享此选项，但是您将面临一个意想不到的问题：如果您将所有小部件的所有选项的消息收集在单个选项变量中，它将为所有网格打开所有这些选项。如果您想要一个没有分组的网格，则必须有一个单独的本地化选项变量而没有分组，否则，即使您不想要，该组也会显示，因为这`groupable: { messages: { .... } }`将使 Kendo 将其识别为已启用。

似乎没有任何方法可以通过仅包含一个额外的 JavaScript 来覆盖这些消息来本地化控件，这可以在[Kendo UI 论坛上](http://www.kendoui.com/forums/framework/globalization/complete-solution-for-language-localization-of-all-text-strings-in-an-app.aspx#2117178)看到。

有没有其他方法可以做到这一点？

（请注意，我将回答我自己的问题，而且我没有患有躁郁症！这只是让社区参与剑道全球项目的一种方式！）

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-06T15:13:48.353

github 上的 kendo-global 项目可以轻松地本地化所有 Kendo UI 小部件上的所有可本地化文本，只需包含所需的语言文件，如下所示：

```
<script src="http://cdn.kendostatic.com/2012.3.1114/js/kendo.all.min.js"></script>
<script src="/js/lang/kendo.pt-BR.js"></script> 
```

它通过覆盖小部件原型上的默认选项来工作，因此它的工作方式就像这些小部件是以预期语言本地创建的一样。

由于它不会改变任何东西，也不会覆盖任何方法，因此如果您需要在单个小部件上使用特定消息（而不是“10 条“您可能想在网格的寻呼机中显示“10 个产品”...）

该项目目前只有几个语言包。翻译非常容易，每位译员都将获得满分。所以贡献者真的，真的很受欢迎。

该项目的页面可以在这里找到：[https ://github.com/loudenvier/kendo-global](https://github.com/loudenvier/kendo-global)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-26T00:49:57.903

我正在使用 Telerik Controls Q1 2013 SP1。看起来您不能再覆盖许多 Kendo 网格标签或工具提示的消息。以下是我无法使用 kendo-global 语言文件覆盖的几条消息/工具提示的列表：

*   每页项目
*   第一的
*   以前的
*   下一个
*   最后的

我对原始问题没有很好的答案。值得一提的是，出于我的目的，解决方案是使用 Fluent API

```
@(Html.Kendo().Grid<Whatever>()
    .Name("Grid")
    .Pageable(e => e           
        .Messages(p => p.ItemsPerPage("")
            .First("לדף הראשון")
            .Previous("לדף הקודם")
            .Next("לדף הבא")
            .Last("לדף האחרון")
            .Refresh("ריענון")
            .Display("מציג {0}-{1} מתוך {2} רשומות")
            .Page("דף")
            .Of("מתוך {0}")))
 ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-09T13:50:57.537

如果需要更动态的选项，我认为获取当前本地化并初始化小部件将是一个不错的选择。

```
 @{
    var culture = System.Threading.Thread.CurrentThread.CurrentCulture.ToString();
}

@section HeadContent {
    <script src="@Url.Content("~/Scripts/cultures/kendo.culture." + culture + ".min.js")"></script>
} 
```

这是有关的更多文档

[https://demos.telerik.com/aspnet-mvc/grid/globalization?culture=ru-RU&_ga=2.268933617.1296110429.1575874528-1040251397.1575554475](https://demos.telerik.com/aspnet-mvc/grid/globalization?culture=ru-RU&_ga=2.268933617.1296110429.1575874528-1040251397.1575554475)

# jconsole - JConsole can't find process

> ID：13746640
> 
> 赞同：21
> 
> 时间：2012-12-06T15:13:54.583
> 
> 标签：jconsole

I tried to run JConsole to analyze the memory used by a running process, but JConsole doesn't show me processes even though I am absolutely sure that one is running (in addition to that it should show JConsole in the process list as well but it doesn't).

Does anyone have an idea why it doesn't show any processes?

Cheers

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-10-18T18:44:33.833

在窗口提示符下，运行 echo %TMP%，它将为您提供默认的临时目录。转到该目录并找到名为 hsperfdata_ *user*的目录，其中*user*是您的登录名。这是存储进程 ID 的目录。您创建的任何新进程（例如 java 应用程序）都会有一个以进程 ID 命名的新文件。Jconsole 将从该目录中获取进程 ID。如果您无法在此目录中创建文件，则意味着您需要更改权限才能允许写入。完成后，启动一个新的 java 应用程序以查看新的进程 id 文件是否在目录中。确认后，启动 jconsole

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-21T15:58:26.577

我也有同样的问题。但是如果我明确指定 PID，如 中`jconsole 1234`，jconsole 能够分析进程。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-01-04T16:21:14.263

如果您在 Windows 上运行 jconsole - 只需：

1.  找到**jconsole.exe**
2.  右键单击它
3.  选择**以管理员身份运行**。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-04T13:13:47.823

就我而言，删除`hsperfdata_USERNAME`目录（在`%TMP%`目录中）并关闭所有 JVM 有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-08T22:52:07.313

当受监控的 JVM 和监控工具（JConsole/JMC/Java Mission Control，甚至可能是 VisualVM）的 %TMP% 值不同时，就会发生这种情况。这可能是 Cygwin 的标准场景（至少在我的情况下：Cygwin+Babun）最简单的解决方案是将 TMP 环境变量的值设置为 Windows 使用的默认值，至少在 shell 启动 JVM 的范围内。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-25T07:29:27.033

您必须使用与您要分析的进程相同的用户启动 jconsole。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-11T02:10:28.457

刚碰到这个问题

如果您有机会使用多个 jdk（例如 SDKMAN），请确保`jconsole`使用与应用程序相同的 jdk 运行

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-17T18:36:59.100

8 年后......我遇到了同样的问题。我只能看到某些进程，但无法看到和监视在 Linux 的 docker 容器中运行的任何 java 进程。

受RoyalBigMack[的 Windows 解决方案的启发：](https://stackoverflow.com/a/48099377/4739826)

*   `su`解决方案1.以超级用户（命令）运行终端并运行`jconsole`
*   解决方案 2\. 将解决方案 1 作为一个命令运行，`sudo jconsole`

只有第一个解决方案对我有用，一旦 jconsole UI 弹出 - 现在所有隐藏的进程都是可见的。

# file - How do I import a .dat file as a matrix in Mathematica?

> ID：13746642
> 
> 赞同：2
> 
> 时间：2012-12-06T15:14:05.413
> 
> 标签：file, matrix, wolfram-mathematica

I have a .dat file consisting of a string of numbers 1 to 9 that looks like this:

1

2

3

4

5

6

7

8

9

How do I import the data into mathematica so that it has the form {{1,2,3},{4,5,6},{7,8,9}} and I can generate my 3x3 matrix?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:39:34.157

我建议：

```
 data=Partition[Import["<Name of data file>", "Table"],3]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T12:34:00.510

```
ReadList["file.dat", {Number, Number, Number}] 
```

> ```
> {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}} 
> ```

也可以写成：

```
ReadList["file.dat", Number ~Table~ {3}] 
```

# android - Adding a permanent search title in autocomplete textview android

> ID：13746645
> 
> 赞同：1
> 
> 时间：2012-12-06T15:14:10.480
> 
> 标签：android, default, custom-component, autocompletetextview

I want to add a permanent search result in autocomplete text view in android. For ex:If i enter 'x' in the autocomplete and if it shows the list of hotels...xyz1,xyz2.etc...Then the last result must be "NOT IN LIST" value. If the user cant find their hotel then they can select NOT IN LIST option..

Even if the user types in the text that the predictive search could not give then 'NOT IN LIST' should be the only suggestion that autocomplete should give. I am new to Android.I am doing a small app.Plz help..If i have to use custom autocomplete text view then what method should i override? If so ,tell me with a method code that i have to override

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:59:31.897

这是`AutoCompleteAdapter`我在我的一个应用程序中使用的。我希望这能解决你的问题

将适配器从下方设置为您的`AutoCompleteTextView`控件：

```
 ArrayAdapter<String> adapter = new AutoCompleteAdapter(this,
            R.layout.dropdown_item);

    autoComplete.setAdapter(adapter); 
```

样品适配器：

```
private class AutoCompleteAdapter extends ArrayAdapter<String>
        implements Filterable {
    private ArrayList<String> mData;

    public AutoCompleteAdapter(Context context, int textViewResourceId) {
        super(context, textViewResourceId);
        mData = new ArrayList<String>();
    }

    @Override
    public int getCount() {
        try {
            return mData.size();
        } catch (NullPointerException e) {
            return 0;
        }
    }

    @Override
    public String getItem(int index) {
        return mData.get(index);
    }

    @Override
    public Filter getFilter() {
        Filter myFilter = new Filter() {
            @Override
            protected FilterResults performFiltering(CharSequence constraint) {
                FilterResults filterResults = new FilterResults();
                if (constraint != null) {
                    //This shows a progress to the user in my app. you don't need to use this
                    handle.sendEmptyMessage(MSG_SHOW_PROGRESS);
                    try {
                        //Fill mData with your data
                        mData = XmlParser.searchLocations(constraint
                                .toString());
                    } catch (Exception e) {
                        handle.sendEmptyMessage(MSG_HIDE_PROGRESS);
                    }
                    mData.add("NOT IN LIST");
                    filterResults.values = mData;
                    filterResults.count = mData.size();
                }
                return filterResults;
            }

            @Override
            protected void publishResults(CharSequence contraint,
                    FilterResults results) {
                if (results != null && results.count > 0) {
                    notifyDataSetChanged();
                    handle.sendEmptyMessage(MSG_HIDE_PROGRESS);
                } else {
                    notifyDataSetInvalidated();
                    handle.sendEmptyMessage(MSG_HIDE_PROGRESS);
                }
            }
        };
        return myFilter;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T14:13:30.227

```
if (constraint != null) {

    try {
        for(int i=0;i<temp.size();i++)
        {
        if(temp.get(i).toString().startsWith(constraint.toString().toUpperCase()))
        {

        mData.add(temp.get(i).toString());  

        }
        }

        mData.add("SEARCH NOT THERE");

    } catch (Exception e) {

    }

         filterResults.values = mData;
         filterResults.count = mData.size();

}
return filterResults; 
```

我已经完成了过滤...仍然显示所有结果而不是我在其中输入的任何内容...:(

# php - 自定义 WordPress 编辑器

> ID：13746648
> 
> 赞同：0
> 
> 时间：2012-12-06T15:14:15.670
> 
> 标签：php, wordpress

对不起，如果我的术语令人困惑，但我不确定这到底是什么。

在 Wordpress 中编辑帖子或页面类型时，在编辑器的右侧有“发布”、“属性”、“特色图片”等部分。我想知道是否有一种方法可以将自己的部分添加到右侧像另一个？它是自定义帖子类型还是更复杂的东西？

我试图保持在使用钩子的可能性范围内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:08:27.843

那些是“元盒”

[http://codex.wordpress.org/Function_Reference/add_meta_box](http://codex.wordpress.org/Function_Reference/add_meta_box)

```
function my_custom_meta_boxes()
{
  add_meta_box(
    'custom1', // id
    'Custom Metabox', // title
    'display_custom_meta_box', // callback for display
    'post', // post type
    'normal', // position
    'high' // priority
  );
}
add_action('add_meta_boxes', 'my_custom_meta_boxes');

function display_custom_meta_box()
{
  echo 'Your meta box here';
} 
```

有一些插件可用于快速创建元框，例如

[http://wordpress.org/extend/plugins/meta-box/](http://wordpress.org/extend/plugins/meta-box/)

[http://wordpress.org/extend/plugins/types/](http://wordpress.org/extend/plugins/types/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:19:59.763

[http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

在这里阅读它^ 用谷歌搜索并不难！:)

# azure - 如何在 Windows azure 云服务器上转发端口

> ID：13746649
> 
> 赞同：6
> 
> 时间：2012-12-06T15:14:20.547
> 
> 标签：azure

嗨，我刚刚尝试了 windows azure 云服务器。

下载并运行 apache 它可以在本地主机上运行，​​但无法从互联网访问

我应该为使 *.cloudapp.net 像 Web 服务器一样工作而做任何特殊的移植吗

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-19T01:03:08.270

您只需要配置一个端点即可。

在您的天蓝色面板 -> 虚拟机 -> your_machine_name -> 端点中。您应该看到如下内容：

![端点配置](../Images/7d7466c03aa84857c160236e6f7f8a61.png)

公共端口 -> 80（如果你想为 your_machine_name.cloudapp.net 服务）

Private port -> (你的服务器监听端口)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T16:09:31.450

你到底尝试了什么？Azure 虚拟机？Azure 辅助角色？我猜是使用 Linux 的 Azure 虚拟机，因为您在谈论 Apache。您需要[在端口 80 上添加一个 TCP 端点](https://www.windowsazure.com/en-us/manage/windows/how-to-guides/setup-endpoints/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-14T20:15:39.530

这种情况最近发生了变化。单击“所有资源”，然后单击您的网络安全组： [屏幕截图 1](http://i.stack.imgur.com/pyK9v.png)

然后单击“入站安全规则”。点击“添加”。点击“添加”。然后填写详细信息。对于“目标端口范围”，您应该放置 Apache 正在侦听的任何端口，可能是 80。示例：[屏幕截图 2](http://i.stack.imgur.com/B7tSy.png)

单击“确定”，您就可以开始了！

# git - 从 git 中删除带有破折号的文件

> ID：13746660
> 
> 赞同：1
> 
> 时间：2012-12-06T15:14:53.390
> 
> 标签：git, git-merge

在 git 合并冲突期间，我创建了一个名为“e --abort”的文件

我尝试删除文件：

> $ rm ./e --abort

得到这个：

> rm: 无法识别的选项 `--abort'

也试过：

> $ git rm -- e --abort

并得到：

> 致命：pathspec 'e' 不匹配任何文件

因为破折号不是一开始这对我不起作用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:16:56.950

尝试转义文件名中的空格：`rm ./e\ --abort`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T15:18:35.210

单引号文件名：

```
rm 'e --abort' 
```

此外，如果您的外壳在您完成选项卡时自动转义，您通常可以这样做

```
rm e<tab> => rm e\ --abort 
```

# c++ - Linux (API) 中的性能数据收集

> ID：13746661
> 
> 赞同：-1
> 
> 时间：2012-12-06T15:14:53.763
> 
> 标签：c++, linux, performance, perl, performance-testing

我需要一些具有全面 API 集的库，可以帮助收集当前机器的性能数据。如果这个库是用 C++ 或 Perl 编写的，可能会非常有用。尝试使用谷歌搜索，因为我不知道正确的术语，所以我发现了很多大型且已经建立的项目，我无法将它们嵌入到我的代码中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:26:21.407

您正在寻找的是所谓的[PAPI](http://icl.cs.utk.edu/papi/index.html)性能应用程序编程接口。如果您希望验证您的理论 FLOP 计数，它可以让您收集所有可用性能计数器的数据，例如 FLOP（浮点运算）。它还提供了一个 API 来计算 MFLOPS，甚至为您的应用程序找到缓存命中率。除了[Intel VTune](http://software.intel.com/en-us/intel-vtune-amplifier-xe)之外，我还广泛使用了该库来支持平台。

[这](http://icl.cs.utk.edu/projects/papi/wiki/PAPIC%3aPAPI.3#PAPI_Native_Events)是“本机”PAPI 事件的列表，但您会发现其他所有事件都是 CPU 本机计数器。

# mysql - 创建程序让他们完成外键的工作

> ID：13746662
> 
> 赞同：2
> 
> 时间：2012-12-06T15:14:56.673
> 
> 标签：mysql, foreign-keys, partitioning

我有三个表，它们通过 MySQL 数据库 5.5 版中的外键链接。

我正在考虑对这三个表进行分区，因为它们的大小约为 50 GB。

我正在考虑对这些表进行分区，但 MySQl 中的分区不支持外键

我们可以创建一个程序来检查插入、更新和删除期间的外键依赖关系吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T09:01:58.810

不是程序，但您绝对可以使用触发器进行检查。

# c# - 将内部联接更新语句添加到 SQL 数据源

> ID：13746664
> 
> 赞同：0
> 
> 时间：2012-12-06T15:15:00.347
> 
> 标签：c#, asp.net, sql-server

我有一个连接到连接到 sqlserver 的 sqldatasource 的 Gridview，我已经添加了这样的`Select`语句，它就像我想要的那样工作。

```
SELECT S.[ID], S.[Survey_Name], S.[Start_Date], S.[End_Date], C.[Category_Name], S.[Username], S.[Picture],S.[Audience] FROM [Survey] S
Inner Join
Category C On S.Category_ID = C.ID 
```

我现在需要添加一条`Update`语句，以便在用户尝试编辑 gridview 时更新上面的字段，我试过这个：

```
UPDATE 
         Survey S
INNER JOIN
         Category C
                  On S.Category_ID = C.ID
 SET
 S.Survey_Name=@Survey_Name,
S.Start_Date=@Start_Date,
S.End_Date = @End_Date, 
C.Category_Name =@Category_Name,
S.Username = @Username,
S.Audience=@Audience 

Where
 ID=@ID 
```

但它只是不起作用，并不断给我错误，如无效语法“S”或无效语法“内部”......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:17:34.847

您的更新声明不正确：

```
UPDATE Survey
 SET
 Survey.Survey_Name=@Survey_Name,
 Survey.Start_Date=@Start_Date,
 Survey.End_Date = @End_Date, 
 C.Category_Name = @Category_Name,
 Survey.Username = @Username,
 Survey.Audience=@Audience 
FROM Survey S
INNER JOIN Category C 
 On S.Category_ID = C.ID
Where
 S.ID=@ID 
```

**编辑**

```
UPDATE Survey
 SET
 Survey_Name=@Survey_Name,
 Start_Date=@Start_Date,
 End_Date = @End_Date, 
 Category_ID =C.ID,
 Username = @Username,
 Audience=@Audience 
FROM Survey S
INNER JOIN Category C 
 On C.Category_Name = @Category_Name
WHERE
 S.ID=@ID 
```

# zend-framework2 - Zend 框架 2 错误：无法渲染模板

> ID：13746666
> 
> 赞同：0
> 
> 时间：2012-12-06T15:15:03.437
> 
> 标签：zend-framework2

我正在编写[本教程](http://framework.zend.com/manual/2.0/en/index.html)。我已按照所有步骤创建目录结构、控制器、module.php 和 module.config.php，但是当我打开时`http://zf2-tutorial/album`出现以下错误：

```
 Fatal error: Uncaught exception 'Zend\View\Exception\RuntimeException' with message 'Zend\View\Renderer\PhpRenderer::render: Unable to render template "album/album/index"; resolver could not resolve to a file' in /var/www/zf2-tutorial/vendor/zendframework/zendframework/library/Zend/View/Renderer/PhpRenderer.php:461 
```

我在 view/album/album 目录中创建了一个名为`index.phtml`内部模块目录的文件。

`module.config.php`：

```
return array(
    'controllers' => array(
        'invokables' => array(
            'Album\Controller\Album' => 'Album\Controller\AlbumController',       
        ),
        'view_manager' => array(
            'template_map' => array(
            'layout/layout'           => __DIR__ . '/../view/layout/layout.phtml',
            'album/album/index' => __DIR__ . '/../view/album/album/index.phtml',
            'error/404'               => __DIR__ . '/../view/error/404.phtml',
            'error/index'             => __DIR__ . '/../view/error/index.phtml',
                ),
            'template_path_stack' => array(
                'album' => __DIR__ . '/../view',
            )
        )
    ),

    'router' => array(
        'routes' => array(
            'album' => array(
                'type'    => 'segment',
                'options' => array(
                    'route'    => '/album[/:action][/:id]',
                    'constraints' => array(
                        'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'id'     => '[0-9]+',
                    ),
                    'defaults' => array(
                        'controller' => 'Album\Controller\Album',
                        'action'     => 'index',
                    ),
                ),
            ),
        ),
    ),

); 
```

怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T16:40:23.823

PhpRenderer 对象正在抱怨，因为它找不到视图 phtml 文件。

文件是否`module/Album/view/album/album/index.phtml`存在？如果不是，那么这可能是原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-20T06:21:57.450

检查您是否在**module.config.php**文件中为**view_manager提供了正确的参数或嵌套**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-17T14:22:18.263

我遇到了同样的问题。我已经更改了文件 module.config.php 的以下行，存在于文档中，

```
'view_manager' => array(
  'template_path_stack' => array(
  'album' => __DIR__ . '/../view',
  ),
), 
```

至

```
'view_manager' => array(
  'template_path_stack' => array(
  'album' => __DIR__ . '/../src/view',
  ),
), 
```

只需在视图文件夹前面添加 src 文件夹名称。

像这样，您需要在所有视图路径之前添加“src”文件夹名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-27T09:05:09.560

你应该返回一个类似的`view`对象`IndexController`

```
$view = new ViewModel(array('albums' => $this->getAlbumTable()->fetchAll(),));
$view->setTemplate("album/album/index/index.phtml");
return $view; 
```

而不是直接返回

```
return array('albums' => $this->getAlbumTable()->fetchAll(),); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-05T09:10:00.590

Album\config\module.config.php 中不再有“家”路线，所以

有必要将 ..\module\Album\view\layout\layout.phtml 中的 'H/home' 替换为 'A/album'

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-20T06:34:07.737

确保在**module.config.php**的**view_manager内的****template_map**数组中使用正斜杠而不是反斜杠

 ***** * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-12T11:34:26.150

除此之外，您需要在 module.config.php 中的 routes 数组中添加 2 件事，并将其放在代码下方

```
'home' => array(
                'type' => 'Zend\Mvc\Router\Http\Literal',
                'options' => array(
                    'route'    => '/',
                    'defaults' => array(
                        'controller' => 'Album\Controller\Album',
                        'action'     => 'index',
                    ),
                ),
        ), 
```

和翻译器数组以及语言文件夹

```
'translator' => array(
    'locale' => 'en_US',
    'translation_file_patterns' => array(
        array(
            'type'     => 'gettext',
            'base_dir' => __DIR__ . '/../language',
            'pattern'  => '%s.mo',
        ),
    ),
), 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-16T13:14:29.157

你的 view_manager 放错地方了。它应该在“控制器”和“路由器”级别，而不是在“控制器”内。查看 Application 模块中的 module.config.php 并查看差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-04T12:12:16.120

我已经用相册模块检查了你的代码。一切都很好。您可能对 htaccess 文件有疑问。请检查。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-26T12:33:29.887

就我而言，问题在于视图文件名。我将其命名`index.php`为`index.phtml`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-26T08:02:21.173

有同样的问题，我没有创建空视图文件模块/Album/view/album/album/index.phtml module/Album/view/album/album/add.phtml module/Album/view/album/album/edit .phtml 模块/专辑/视图/专辑/专辑/delete.phtml

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-08-18T19:56:48.553

检查您的 application.config.php 模块名称是否是“专辑”而不是“专辑”更改

```
'template_path_stack' => array(
    'album' => __DIR__ . '/../view', => //to 'Album' => __DIR__ . '/../view',
), 
```******

# tomcat - Spnego 跨域配置

> ID：13746669
> 
> 赞同：0
> 
> 时间：2012-12-06T15:15:14.403
> 
> 标签：tomcat, kerberos, spnego

我已经成功地在单个 Active Directory 域上配置了具有集成 ( [Spnego/Kerberos](http://spnego.sourceforge.net/index.html)`DOMAINA` ) 身份验证的 Tomcat ，.

但是，我的公司决定一分为`DOMAINA`二：

*   `DOMAINA`与用户
*   `DOMAINB`使用提供它们的服务和服务器

域是受信任的。现在我必须配置 Tomcat（和 Spnego），它现在正在运行`DOMAINB`以验证所有`DOMAINA`用户。

一些问题：

*   preauth 用户应该是 a `DOMAINA`or`DOMAINB`用户？
*   我是否需要一个新的本地`DOMAINB`preauth 用户，或者我可以将用户名参数配置为`DOMAINA\OLDPREAUTHUSER`？
*   SPN应该如何调整？有`DOMAINA\OLDPREAUTHUSER`或有我现在定义`DOMAINB\NEWPREAUTHUSER`（省略冗余`DOMAINB\`前缀）？
*   我也改变了`krb5.conf`：

    [libdefaults]

    ```
    default_tkt_enctypes = rc4-hmac
    default_tgs_enctypes = rc4-hmac
    permitted_enctypes   = rc4-hmac
    default_realm = DOMAINA 
    ```

    [领域]

    ```
    DOMAINA = {
        kdc = KDCA
        default_domain = DOMAINA 
    ```

    }

    ```
    DOMAINB = {
        kdc = KDCB
        default_domain = DOMAINB 
    ```

    }

    [domain_realm]

    ```
    .DOMAINB = DOMAINB
    .DOMAINA = DOMAINA 
    ```

这是对的吗？默认域应该是什么？

抱歉，编辑器不会很好地格式化代码......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:18:38.857

默认领域是您的机器所在的位置。即，机器帐户始终绑定到一个且仅一个域。请注意，这`DOMAIN\USER`是 Windows 2000 之前的样式，已弃用。仅限 NTLM 中的用户。如果您处理 Kerberos，则仅处理 UPN 和 SPN。

# android - 服务内部的意图

> ID：13746670
> 
> 赞同：0
> 
> 时间：2012-12-06T15:15:15.137
> 
> 标签：android, android-intent, service

我有一个服务类，在一个服务类中我有计时器任务类。

我可以将一个 Intent 从我的服务类传递给服务中的其他类吗原因 - 我需要使用警报管理器来从服务中触发计时器任务类，我希望我的服务始终在运行

```
public class TestService extends Service 
{

// I need to pass an intent to trigger alarm from TestService to timeTaskUpdate

 private class timeTaskUpdate extends TimerTask{ }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:07:23.713

您不能将 Intent 发送到不是 Android 类的类。TimerTask 是 Java 类，而不是 Android 类。

但是为什么要通过 Intent 呢？timeTaskUpdate 在 TestService 的范围内。您应该能够在 timeTaskUpdate 中使用全局变量。Intent 用于在 Android 组件之间进行通信，根据定义，这些组件*不在*同一范围内。

话虽如此，你应该小心。虽然我不熟悉 TimerTask，但它可能在单独的线程上运行。如果是这样，您应该确保您处理并发。

# javascript - 如何让 ExtJs 应用程序看起来像 Feed 示例？

> ID：13746671
> 
> 赞同：0
> 
> 时间：2012-12-06T15:15:15.797
> 
> 标签：javascript, extjs, extjs4

在我的 ExtJS 应用程序中，我有 3 个组件，一个 `Ext.tree.Panel`和`Ext.grid.Panel`一个`Ext.Img`。我希望它们具有与此处的 Feed Viewer 示例相同的布局：

[http://dev.sencha.com/deploy/ext-4.0.0/examples/feed-viewer/feed-viewer.html](http://dev.sencha.com/deploy/ext-4.0.0/examples/feed-viewer/feed-viewer.html)

我一直在尝试查看代码，但我仍然无法让我的组件看起来像那样（左侧的一个组件，右侧的两个在另一个之上）。谁能解释我如何使用“边框”布局来做到这一点？（这就是他们正在使用的东西）。

编辑：尝试创建嵌套边框布局。`Ext.tree.Panel`左边的the和`Ext.tab.Panel`右边的a`Ext.grid.Panel`以及它的`Ext.Img`里面和里面。这会导致整个选项卡面板显示为空白。下面的代码：

```
 grid_file = Ext.create('Ext.grid.Panel', {
            title: 'File List',
            region: 'north',
            height:200,
            width:700, 
            store: store_file,
            dockedItems: [upload_toolbar],
            columns: [..]});

var imagePanel = Ext.create('Ext.Img', {
            src: 'DefaultImage',
            region: 'south',
            width: 700,
            height: 200
        });
 var tab_Panel = Ext.create('Ext.tab.Panel' , {
            width: 700,
            region: 'center',
            items: [grid_file, imagePanel]})

        win = Ext.create('Ext.window.Window', {
            title: 'ExtJS Simple File Browser',
            width: 900,
            height: 400,
            layout: 'border',
            bodyStyle: 'padding: 5px;',
            items: [tree_dir,button_panel]
        });

        win.show(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:43:37.950

这实际上是一个嵌套的边框布局：

你有主要的布局，它是边界：

*   西部：饲料
*   中心：Feed 信息面板

提要信息面板也有边框布局：

*   中心：网格。
*   南：选定的提要。

feedviewer 的代码有些复杂。您可能会发现[这](http://cdn.sencha.com/ext-4.1.1a-gpl/examples/layout-browser/layout-browser.html)更有帮助。

如果您仍然无法解决，请提交您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T19:48:09.623

在 Chrome 中打开开发者控制台。并检查来源。它们没有被压缩和可读。:) 在 FeedViewer 类中创建的视口。所以这是你的切入点。

# django - Mongoengine DictField() 未显示在 _fields

> ID：13746672
> 
> 赞同：1
> 
> 时间：2012-12-06T15:15:29.797
> 
> 标签：django, mongodb, mongoengine

我的模型中有以下 django 类：

```
class mongoMedia(Document)
        ....
        category         = StringField()
        hough_distance   = DictField() 
```

用一些数据填充集合后，我需要更新“hough_distance”字段。
我试过类似的东西：

```
media_object = mongoMedia.objects.get(sql_id=100)
media_object.update(set__category='catX') #it works
media_object.update(set__hough_distance={'k1': v1, 'k2': v2}) #does not work 
```

第二次更新显然不起作用，因为我的“media_object”的“_fields”中没有列出“hough_distance”。错误是：

```
InvalidQueryError: Cannot resolve field "hough_distance" 
```

我也试过：

```
mongoMedia._get_collection().update({'id': media_obj.id }, {'$set': {'hough_distance.%s' % (hough_distance.distance): object_compare} } ) 
```

这不会在集合中保存任何内容。

虽然这在 mongodb shell 中有效：

```
db.mongo_media.update( { '_id': media_object._id }, { $set: { 'hough_distance': { 'k1': v1} } } ) 
```

如何以有效的 Django 语法“翻译”上述内容，以及为什么 DictField() 未在对象“_fields”属性中列出？

非常感谢！

编辑：

让我换一种说法：如何在 Django 中更新 MongoDB 字典？

# xpath - 使用 Capybara 获取选定的单选按钮文本

> ID：13746678
> 
> 赞同：0
> 
> 时间：2012-12-06T15:15:42.177
> 
> 标签：xpath, radio-button, css-selectors, capybara

我有如下单选按钮

```
<input id="Overriden" type="radio" value="false" name="Overriden" title="Current Setting" disabled="">Inherit
<input id="Overriden" type="radio" value="true" name="Overriden" checked="checked" title="Current Setting">Override 
```

如何获取文本 Overide 或 Inherit

我努力了

```
find("#Overriden[checked='checked']").text
find("#Overriden[checked='checked']").label
find("#Overriden[checked='checked']").innerHTML
find("#Overriden[checked='checked']").value ( which gives me true or false which I am not after) 
```

也欢迎 XPATH 解决方案。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T10:00:26.940

这样做

> find("#Overriden", :checked => 'checked').value

我在我的应用程序中这样使用它

> find("input[name=payment]", :checked => true).value

因为我的单选按钮组名称是“付款”，所以我设置了属性“已检查”= true/false

因此，如果您到目前为止还没有得到任何解决方案，那么我的回答肯定对您有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-21T13:36:20.980

这对我有用：

```
find("[name='my_field_name'][checked]").value 
```

根据您的表单，您的字段名称可能包含尖括号，这很好：

```
find("[name='payment[payment_type]'][checked]").value 
```

只需查看`<input name="my_field_name">`您的页面源并使用该名称即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T10:14:30.510

感谢您的回答。我设法用黑客攻击它。我无法更改 HTML，因为这是一个简短的项目，并且该应用程序来自另一个团队。

```
 settings=[] 
 pos=0
 i=0 
 all("div.inheritence").each do |elem|
   within(elem) do 
    all("#Overriden").each do |input_tag|
     i+=1 
     within(input_tag) do 
       if input_tag[:checked] 
           pos=i 
       end 
     end
    end 
   end 
   set=elem.text 
   settings =set.scan(/\w+/) 
  end 
settings[pos] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T15:09:03.217

我事先承认我对 capybara 了解不多，但我知道 html。并且您尝试获取的文本位于元素之外（`input`元素没有与其直接关联的文本）。这驻留在元素之外往往很难获得。既然如此，我建议将后面的文本放在 a`label`或`span`标签中。所以是这样的：

**更改 HTML**

```
<input id="Overriden" type="radio" value="true" name="Overriden" checked="checked" title="Current Setting"><label>Override</label> 
```

**然后像这样选择**

（这里显示了我缺乏 capybara 的功能：我不知道它是否`+`在其`find`字符串中采用 css 相邻兄弟选择器，但是您可以选择与您的`input`in capybara 相邻的兄弟（下一个元素）。）

```
find("#Overriden[checked='checked'] + label").text 
```

# php - 正则表达式和贪婪 - 如何使用 PHP 编写该表达式？

> ID：13746682
> 
> 赞同：0
> 
> 时间：2012-12-06T15:16:11.173
> 
> 标签：php, regex

我有这个字符串：

```
http://localhost/whatever/index.php/something/cms-abc.html?___SID=U 
```

我想从该字符串中获取**cms-abc 。**我试过：

```
/cms-.+/ 
```

但这也会给我 cms-abc 背后的东西。我该如何解决这个问题？

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:19:01.990

不需要正则表达式：

```
$url = 'http://localhost/whatever/index.php/something/cms-abc.html?___SID=U';
$parts = parse_url($url);
echo basename($parts['path']); 
```

甚至只是

```
echo basename(parse_url($url, PHP_URL_PATH)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:20:06.490

你是什​​么意思“在cms-abc后面”？您的正则表达式应与此匹配：

```
/cms-abc.html?__SID=U 
```

你的意思是你不想要问号后面的东西吗？然后将 替换为`.`“除问号以外的任何字符”，即`[^?]`.

最后，如果您要在 PHP 中拆分 URL，请查看该`parse_url()`函数。它存在，它是您不必编写的代码，它无需测试即可工作，与您编写的代码不同。

见[http://php.net/manual/en/function.parse-url.php](http://php.net/manual/en/function.parse-url.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:21:01.130

“我想从那个字符串中得到**cms-abc 。”** 因此，从/包括“cms”到（但不包括）点的所有内容：

```
/cms[^\.]*/ 
```

# python - 与另一个类在同一个文件中定义的 Python 类 - 如何访问文件中稍后定义的类？

> ID：13746683
> 
> 赞同：3
> 
> 时间：2012-12-06T15:16:15.990
> 
> 标签：python, django, django-models

我对 Python 很陌生，我认为这个问题应该很容易回答。

我的问题简化是这样的......

我在文件类 A 和类 B 中有 2 个类。首先在文件中定义 A 类，然后定义 B 类。

```
class A
    ...

class B
    ... 
```

我如何使用 A 类访问 B 类？

```
class A
    something = B

class B
    somethingElse = A 
```

这是我要修复的实际代码

```
class FirstResource(_ModelResource):
    class Meta(_Meta):
        queryset = First.objects.all()
        resource_name = 'first'
        allowed_methods = ['get','put']

        filtering = {
            'a': ALL_WITH_RELATIONS,
            'b': ALL_WITH_RELATIONS,
            'c': ALL_WITH_RELATIONS,
        }

        ordering = ['apt']

    # this is the line that would fix everything
    second = fields.ForeignKey(SecondResource, 'second', null=True, blank=True, default=None, full=True) 

    ...

 class SecondResource(_ModelResource):
    class Meta(_Meta):
        queryset = Second.objects.all()
        resource_name = 'second'
        execute_methods = ['get', 'post']
        filtering = {
            'name': ['exact'],
            'leader': ['exact'],
        }   

    super = fields.ForeignKey(FirstResource, 'super', null=True, blank=True, default=None, full=True)
    leader = fields.ForeignKey(FirstResource, 'leader', null=True, blank=True, default=None, full=True)

    ... 
```

由于没有在 Python 中预先声明，我真的不知道如何解决这个问题。models.py 中的 First 有一个 ForeignKey 为 Second，Second 有 2 个外键为 First。

将 A 移到 B 下面并不能解决问题，因为 B 也需要 A。我没有编写代码，我只是想修复它 - 当我对资源执行“获取”时，我需要返回“第二个”外键在两个班级。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:32:22.513

要访问`B`，您必须首先定义`B`。

如果要在*定义*`B`时访问，则需要将其移到文件上方。 *`A``A`*

 *如果你想在调用 中的方法时访问`B`，*你* `A`不需要做任何事情：当你调用 的方法时`A`，解释器已经执行了所有的定义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-08T17:17:12.510

所以答案是使用 qoutes

```
B = fields.ForeignKey('api.resources.B', 'B') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T15:51:36.697

当 python 找到一个类声明时，它会创建一个新作用域并**执行**此代码块中类内的代码。这意味着在执行类声明时会实例化所有类变量。

现在，如果您有两个类，例如：

```
class A:
    something = B

class B:
   pass 
```

Python 将在创建类`something = B` *之前*`B`执行，因此它会生成一个`NameError`.

您可以通过非常简单的方式避免这种情况：

```
class A:
    something = None

class B:
    pass

A.something = B 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:29:09.220

```
class A:
    def __init__(self):
        print "In A"

class B:
    def __init__(self):
        a = A()
        print "In B"
b = B() 
```

我想你想要这样的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-09T10:47:54.943

我想到的一种解决方法是将类分成多个文件，这样您就可以拥有一个 python 包“模型”，其中包含 A.py 和 B.py。然后你避免了订购问题*

# iphone - 带 safari 的 iphone 中的黑色背景

> ID：13746685
> 
> 赞同：0
> 
> 时间：2012-12-06T15:16:22.973
> 
> 标签：iphone, html, css, safari

如果我在 iphone 上使用 safari浏览[此页面，则会出现部分黑屏，这里是错误的屏幕截图：](http://www.lazzarotto.it/)

[屏幕](http://i.stack.imgur.com/3xHiQ.png)

任何想法？可能是因为背景图像的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:28:18.613

Maybe your background image it's not loading on the IPhone. I've tested with my IPad and everything is fine.

Try improving your `body` css

```
body {
    font: 14px/16px georgia, times, times new roman, arial;
    background-image: url(http://www.lazzarotto.it/templates/lazzarotto/image/background.jpg);
    background-repeat: repeat-x;
    background-color: #fff;
    padding: 0px;
    margin: 0px;
    color: #554e3c; 
} 
```

to

```
body {
    font: 14px/16px georgia, times, times new roman, arial;
    background: url(http://www.lazzarotto.it/templates/lazzarotto/image/background.jpg) #fff repeat-x;
    padding: 0px;
    margin: 0px;
    color: #554e3c; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T11:05:35.760

您也可以选择[CSS3 Gradient](http://www.colorzilla.com/gradient-editor/)来实现渐变背景效果

# java - PhoneGap 错误：jar：无效选项 -- 'e'

> ID：13746687
> 
> 赞同：2
> 
> 时间：2012-12-06T15:16:28.000
> 
> 标签：java, android, cordova, ubuntu, jar

当我尝试创建一个 android phonegap 应用程序时，我收到以下错误： $ phonegap/lib/android/bin/create myapp invalid option -- 'e' 尝试 `jar --help' 获取更多信息

我正在使用 Ubuntu 12.04

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:18:34.210

Jar 抛出此错误是因为我使用了错误的 jar（sun sdk 之一）

我通过简单地运行解决了这个问题：

```
 $ sudo update-alternatives --config jar 
```

并选择 oracles jar：

```
Selection    Path                                Priority   Status
------------------------------------------------------------
  0            /usr/bin/fastjar                     100       auto mode
  1            /usr/bin/fastjar                     100       manual mode
* 2            /usr/lib/jvm/java-7-oracle/bin/jar   2         manual mode 
```

# wpf - 以编程方式 DataGridColumnHeader ContextMenu

> ID：13746689
> 
> 赞同：7
> 
> 时间：2012-12-06T15:16:48.547
> 
> 标签：wpf, datagrid, contextmenu

我在 View.cs 中有这段代码

```
var contextMenu = this.dataGridFacade.GiveContextMenuForDataGrid(this.DataGridAllJobs);

this.DataGridAllJobs.ContextMenu = contextMenu; 
```

但我只想为标题添加这个上下文菜单。是否可以？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-10T12:17:59.040

您只需检索[DataGrid](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.datagridcolumnheaderspresenter%28v=vs.95%29.aspx)的 DataGridColumnHeadersPresenter 并设置其 ContextMenu。

```
var contextMenu = this.dataGridFacade.GiveContextMenuForDataGrid(this.DataGridAllJobs);
var columnHeadersPresenter = this.DataGridAllJobs.SafeFindDescendant<DataGridColumnHeadersPresenter>(ip => ip.Name == "PART_ColumnHeadersPresenter");
if (columnHeadersPresenter != null)
{
    columnHeadersPresenter.ContextMenu = contextMenu;
} 
```

这是 SafeFindDescendant 扩展方法：

```
public static class Visual_ExtensionMethods
{
    /// <summary>
    /// Retrieves the first Descendant of the currren Visual in the VisualTree matching the given predicate
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="this">The current Visual.</param>
    /// <param name="predicate">An optional predicate that the descendant have to satisfy.</param>
    /// <returns></returns>
    public static T SafeFindDescendant<T>(this Visual @this, Predicate<T> predicate = null) where T : Visual
    {
        T result = null;
        if (@this == null)
        {
            return null;
        }

        // iterate on VisualTree children thanks to VisualTreeHelper
        int childrenCount = VisualTreeHelper.GetChildrenCount(@this);
        for (int i = 0; i < childrenCount; i++)
        {
            var currentChild = VisualTreeHelper.GetChild(@this, i);

            var typedChild = currentChild as T;
            if (typedChild == null)
            {
                // recursive search
                result = ((Visual)currentChild).SafeFindDescendant<T>(predicate);
                if (result != null)
                {
                    break;
                }
            }
            else
            {
                if (predicate == null || predicate(typedChild))
                {
                    result = typedChild;
                    break;
                }
            }
        }

        return result;
    }
} 
```

# sql-server-2008 - 从大型数据库中删除唯一行

> ID：13746692
> 
> 赞同：0
> 
> 时间：2012-12-06T15:16:53.710
> 
> 标签：sql-server-2008, tsql

我在 SQL 2008 中有一个数据库，其中有超过 200 万行（它是从 CSV 创建的）。我正在尝试删除具有唯一数据的行。每当我运行它时，它都会说大约有 12000 - 13000 行受到影响。如何删除我想要在 1 个步骤中删除的所有行，而不是每次都执行它？我知道每次 b/c 我经常对其进行计数时它都会删除行。它将永远以我正在前进的速度带走我。可以修改此代码以执行我需要的操作吗？

```
WITH numbered AS (
SELECT ROW_NUMBER() OVER(PARTITION BY name, size, lastwritetime 
ORDER BY name, size, lastwritetime) 
AS _dupe_num FROM AllFiles 
WHERE name = name
AND   size = size
AND   lastwritetime = lastwritetime
)
DELETE FROM numbered WHERE _dupe_num = 1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:40:37.243

重新阅读问题并了解发布者想要保留重复项后，这是一个声明，用于保留所有具有重复项的记录（假设一个名为 id 的 PK 字段）：

```
DELETE af FROM AllFiles af
WHERE NOT EXISTS (
    SELECT 1
    FROM AllFiles af2
    WHERE af2.name = af.name
    AND af2.size = af.size
    AND af2.lastwritetime = af.lastwritetime
    AND af2.id <> af.id) 
```

**编辑：**如果您只想保留每条重复记录的单个副本并删除所有没有重复的记录，请使用以下语句：

```
DELETE af FROM AllFiles af
WHERE NOT EXISTS (
    SELECT 1
    FROM AllFiles af2
    WHERE af2.name = af.name
    AND af2.size = af.size
    AND af2.lastwritetime = af.lastwritetime
    AND af2.id <> af.id)
OR EXISTS (
    SELECT 1
    FROM AllFiles af3
    WHERE af3.name = af.name
    AND af3.size = af.size
    AND af3.lastwritetime = af.lastwritetime
    AND af3.id > af.id) 
```

# asp.net-mvc-3 - MVC3 - 4 使用局部视图的多种形式

> ID：13746697
> 
> 赞同：2
> 
> 时间：2012-12-06T15:17:05.170
> 
> 标签：asp.net-mvc-3, forms, asp.net-mvc-4, partial-views, renderaction

所以，我正在创建一个管理页面，我想在上面放置多个表单。所以，我尝试使用 Partial View 和 RenderAction。

我的管理员索引视图：

```
@model Rad.ViewModels.AdminViewModel
@{
ViewBag.Title = "Admin";
}

<h2>Admin</h2>

<div>
@{ Html.RenderAction("AddProduct"); }
</div> 
```

我的部分观点：

```
@model Rad.ViewModels.AdminAddProductViewModel

@using (Html.BeginForm("AddProduct", "Admin"))
{
<h1>@Html.LabelFor(model => model.Name)</h1>
@Html.TextBoxFor(model => model.Name)
@Html.ValidationMessageFor(model => model.Name)
<input type="submit" value="Add"/>
} 
```

我的管理员控制器：

```
public class AdminController : Controller
{
    //
    // GET: /Admin/
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult AddProduct()
    {
        return PartialView();
    }

    [HttpPost]
    public ActionResult AddProduct(AdminAddProductViewModel data)
    {
        if (ModelState.IsValid)
        {

        }
        return View("Index");
    }
} 
```

问题在于 AddProduct 的 HttpPost 版本。如果我将其保留为 return View("Index")，它将进入无限循环。但是，如果我返回 PartialView(data)，它会正确显示错误，但它周围没有索引视图。所以，它只显示部分视图。有没有办法在一个页面上有多个表单并将服务器端验证返回到页面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T17:06:19.047

好的，我能够解决这个问题：

管理员主索引页面：

```
@model Rad.ViewModels.AdminViewModel
@{
ViewBag.Title = "Admin";
}

<h2>Admin</h2>

<div>
@Html.Partial("AddProduct", Model.AddProduct)
</div> 
```

添加产品局部视图：

```
@model Rad.ViewModels.AdminAddProductViewModel

@using (Html.BeginForm("AddProduct", "Admin"))
{
<h1>@Html.LabelFor(model => model.Name)</h1>
@Html.TextBoxFor(model => model.Name)
@Html.ValidationMessageFor(model => model.Name)
<input type="submit" value="Add"/>
} 
```

简单的 AdminAddProductViewModel：

```
public class AdminAddProductViewModel
{
    [DisplayName("Add Product:")]
    [Required]
    [StringLength(50)]
    [RegularExpression(@"^[a-zA-Z0-9\s]+$")]
    public string Name { get; set; }
} 
```

包含 AdminViewModel：

```
public class AdminViewModel
{
    public AdminAddProductViewModel AddProduct { get; set; }

    public AdminViewModel()
    {
        AddProduct = new AdminAddProductViewModel();
    }
} 
```

管理员控制器：

```
public ActionResult Index()
    {
        AdminViewModel data = new AdminViewModel();
        return View(data);
    }

    [HttpGet]
    public ActionResult Index(AdminViewModel data)
    {
        return View(data);
    }

    [HttpPost]
    public ActionResult AddProduct(AdminAddProductViewModel data)
    {
        AdminViewModel admin = new AdminViewModel();
        admin.AddProduct = data;
        if (ModelState.IsValid)
        {

        }
        return View("Index", admin);
    } 
```

现在，我知道我在谈论多个表单，并且在这里只显示一个表单，但是如果您想向其中添加另一个表单，只需创建另一个局部视图、另一个子视图模型，然后将该子视图模型添加到 AdminViewModel。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:45:35.357

你试过 ajax.beginform() 吗？命名局部视图周围的 div 并将 UpdateTargetId 设置为该名称。

然后查询将替换旧的 div。

不要忘记参考 ajax 的 java 脚本库！

# templates - c++模板实例化

> ID：13746701
> 
> 赞同：0
> 
> 时间：2012-12-06T15:17:21.043
> 
> 标签：templates, cmake, template-meta-programming

假设我在主 cpp 文件中有一组指令，允许实例化我的二进制文件，这些二进制文件使用 typedef 和预处理器指令实现具有给定类型的模板算法，以便在编译前选择类型：

```
 #ifdef MS1
     typedef  MSVariableInterface1 InterfacorType;
  #else
       #ifdef MS2
           typedef  MSVariableInterface2 InterfacorType;
       #endif
  #endif

int main()
 {...        //use InterfacorType as the type for template 
```

我希望我的 cmakelists 使用不同的模板实例自动编译代码，知道预处理器变量的不同可能值。你知道我该怎么做吗？

此外，我猜这不是解决问题的正确方法，您是否有另一个建议来“展开”（可选多）模板代码的不同实例，给定可以采用每个模板的类型集。这样的解决方案将允许我创建一个二进制文件来处理所有情况（带有允许选择感兴趣的实例的参数），而不是为每个实例创建一个二进制文件。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T06:08:39.990

您可以使用[add_definitions](http://www.cmake.org/cmake/help/cmake2.6docs.html#command%3aadd_definitions)启用它们：

```
add_definitions(-DMS1) 
```

# lan - 使用 DD-WRT 在 LAN 上创建主机名（在 Asus RT-N 16 上）

> ID：13746702
> 
> 赞同：3
> 
> 时间：2012-12-06T15:17:23.633
> 
> 标签：lan, hostname, dd-wrt

我已经看过这个[问题了](https://stackoverflow.com/questions/12548867/create-hostname-for-a-computer-on-the-network)。但这并没有帮助我。

我的目标是通过`http://myrouter`或`ftp://data`等解决我家局域网中的目标，而不像`http://my_computer.my_domain.local`有人在我链接的问题中指出的那样。

我可以通过编辑主机文件来解决这个问题，但我希望它能够在我网络中的每个客户端上工作。而且由于不止一个，我认为这不是一个好方法。

**编辑**

我按照howtogeek上的教程进行操作，它可以工作。但前提是我在我的 Win7 机器上手动编辑*此连接的 DNS 后缀字段（从德语免费翻译）。*如果我不这样做，`ping win7`就不能在我的 Win7 电脑上工作（但它可以在其他电脑、网络上的手机上工作）。

我必须明确添加 dns-suffix 以使其工作如下：`ping win7.home.lan` 但是在编辑命名字段后，我的计算机突然“认识自己”。有没有更好的办法？或者手动编辑该字段是否正常，因为无论如何您都在那里，因为设置了静态 IP？

# html - 在文本框中显示非英文字符

> ID：13746703
> 
> 赞同：0
> 
> 时间：2012-12-06T15:17:29.190
> 
> 标签：html, asp.net-mvc, character-encoding

我想在文本框中显示一些非英文字符。

我正在尝试

```
$("#txtSearch").val('<%:Html.Raw(ViewBag.my_search)%>') 
```

它应该显示“2100 - København Ø”，但它显示的是“2100 - KÃ¸benhavn Ã~”。

我的控制器从 cookie 中读取此值并将其分配到 ViewBag 中。在控制器中我有

```
ViewBag.my_search = cookie.Value 
// here it is assigning the right danish word but when it displays inside the input  box, it just displays wrong. 
```

知道如何解决这个问题吗？

**编辑：**

好吧，它在我的本地电脑上运行良好，但是当我将它托管到某个远程托管服务提供商时，它的性能并不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:53:51.387

`<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />`这不是设置页面编码的好方法，因为它被真正的 http 标头覆盖。因此，如果远程托管服务提供商正在发送内容类型标头，它将被忽略。

您的数据是正确的 utf-8，这很好。您需要做的就是设置内容类型 http 标头，以便浏览器将其读取为 utf-8 而不是 windows-1252。

您可以设置您的个人页面以发送标题：

```
<%@ Page RequestEncoding="utf-8" ResponseEncoding="utf-8" %> 
```

或者您可以在 Web.config 中全局设置它：

```
<configuration>
  <system.web>
    <globalization requestEncoding="utf-8" responseEncoding="utf-8" />
  </system.web>
</configuration> 
```

# php - 在 MySQL 中保存 $_SESSION['MM_adUser']

> ID：13746706
> 
> 赞同：0
> 
> 时间：2012-12-06T15:17:34.710
> 
> 标签：php

不久前，我在 Dreamweaver 中建立了一个站点，并将其修改为“版本 2”，我设法让用户登录以使用 Active Directory 进行身份验证，并为他们的完整 AD 名称添加了 $_SESSION['MM_adUser']。

这似乎可以正常添加：

```
<?php $_SESSION['MM_adUser']; ?> 
```

到页面，在浏览器中显示用户的全名.. 即：John Smith

但是，我现在想将它插入 MySQL，所以我添加到页面底部（与其他一些其他变量）：

```
<input name="SavedBy" type="hidden" value=<?php $_SESSION['MM_adUser']; ?> /> 
```

但它只插入用户的名字！删除 type="hidden" 确实在页面上仅将其显示为他们的名字。

问题是，为什么要改变？为什么它失去了姓氏？我猜它与空白有关，因为在尝试各种修复时出现错误，但是，唉，我无法修复它:(

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:18:57.050

也许在你的价值周围加上引号会有所帮助？

```
<input name="SavedBy" type="hidden" value="<?= $_SESSION['MM_adUser']; ?>" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T15:20:03.750

注意`echo`

```
value="<?php echo $_SESSION['MM_adUser']; ?>" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:25:00.613

尽管所有的遮阳篷都是正确的。你提到你想把它存储在 mysql 中？那么就不需要先把它放在隐藏的输入字段中。您可以`$_SESSION['MM_adUser']`在 mysql 查询中使用。我猜你现在正在使用`$_POST['SavedBy']`？

将“SavedBy”放在隐藏的输入字段中绝不是一个好主意。我可以随意更改所以即使“John Smith”已登录，我仍然可以发送“Hugo Delsing”

# mysql - 使用复合键连接表两次

> ID：13746707
> 
> 赞同：0
> 
> 时间：2012-12-06T15:17:39.193
> 
> 标签：mysql, sql, database, join, trac

给定`ticket`具有主键`id`的表`ticket_custom`和具有复合键的表，`ticket,name`我如何加入`id = ticket and name=X and id = ticket and name=Y`.

该表`ticket_custom`允许*扩展*工单表，它具有字段`ticket,name,value`。

我可以做一个单一的加入：

```
SELECT id, summary, owner, ticket_custom.value
FROM ticket
INNER JOIN ticket_custom
ON id=ticket_custom.ticket AND ticket_custom.name='X' 
```

我需要类似的东西：

```
SELECT id, summary, owner, ticket_custom.value, ticket_custom.value
FROM ticket
INNER JOIN ticket_custom
ON id=ticket_custom.ticket AND ticket_custom.name='X' AND ticket_custom.name='Y' 
```

其中第一个`ticket_custom.value`是 for 的值，`id,x`第二个是 for的值`id,y`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:21:37.133

如果我理解正确，这就是您要查找的内容：

```
SELECT id, summary, owner, c1.value, c2.value
FROM ticket t
INNER JOIN ticket_custom c1  ON t.id = c1.ticket AND c1.name = 'X'
INNER JOIN ticket_custom c2  ON t.id = c2.ticket AND c2.name = 'Y' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:20:58.650

我这应该可以解决问题：

```
SELECT id, summary, owner, ticket_custom.value, ticket_custom.value
FROM ticket
INNER JOIN ticket_custom
ON ticket.id=ticket_custom.ticket
WHERE (ticket_custom.name='X' OR ticket_custom.name='Y') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:23:28.920

**也许**

```
SELECT id, summary, owner, ticket_custom.value, ticket_custom.value
FROM ticket
INNER JOIN ticket_custom
ON id=ticket_custom.ticket AND ticket_custom.name='X' 
    OR id=ticket_custom.ticket AND ticket_custom.name='Y' 
```

# bash - Shell：将带有前面零的数字打印到变量？

> ID：13746708
> 
> 赞同：1
> 
> 时间：2012-12-06T15:17:40.950
> 
> 标签：bash, printf, number-formatting

我想使用以下 C 格式在 bash 脚本中打印数字：%05d。所以我有两个变量

```
$num1
$num2 
```

例如，当我设置时，`num1=12`我希望有`echo $num2`equals to `00012`。怎么做 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:19:00.460

```
num1=12
printf -v num2 '%05d' "$num1" 
```

请注意，这仅设置 num2 一次。如果希望 num2 始终反映 num1 的当前值，则需要将其定义为函数：

```
num2() { printf '%05d' "$num1"; } 
```

...然后这样称呼它：

```
num2 
```

# javascript - jquery悬停不显示链接

> ID：13746711
> 
> 赞同：0
> 
> 时间：2012-12-06T15:18:09.343
> 
> 标签：javascript, jquery

不明白为什么当我将鼠标悬停在图像上时我的链接不会显示。我确信这是我目前无法看到的非常简单的事情。如果有人指出我所缺少的以及可能有的任何其他提示，我将不胜感激。

```
$("#profile_pic").hover(
        function () {
            $(this).show($('<a id="duh" href="upload.php">Change the picture</a>'));
        }
); 
```

我试图在悬停时显示的链接如下

```
<div>
    <img id= "profile_pic" src="<?php echo $picture;?>" width="164" height="164" />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:19:35.767

问题可能是`<img>`元素不能有内容，但您正试图将该标记附加到它。

您可以做的是将其附加到父级。

```
$("#profile_pic").hover(
        function () {
            $(this).closest('div').append($('<a id="duh" href="upload.php">Change the picture</a>'));
        }); 
```

现在，无论您如何执行此操作，请注意，`.hover()`每次鼠标移入或移出元素时，API 都会调用您的函数。每次调用都会附加*另一个*HTML 块。你真的想这样做吗？

相反，我建议您*始终*在页面上拥有该`<a>`标签，并让您的`.hover()`处理程序显示/隐藏它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:19:51.197

您不能将任何内容附加到 img，但您可以在 img 旁边插入链接。

```
$("#profile_pic").hover(
   function () {
    var link = $("#duh");
    link = link.length ? link : $('<a id="duh" href="upload.php">Change the picture</a>');
    $(this).after(link);
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:26:59.063

```
$("#profile_pic").hover(function () {
    $('<a id="duh" href="upload.php">Change the picture</a>').insertAfter(this);
}); 
```

I used the insertAfter as I do not have knowlege of your other structure, and appending to the parent/wrapper might not put it in close proximity to the image whereas this should. You could also use the `$(this).parent()` selector to append if needed.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:20:28.887

你不能把 id 移到包装 div 上吗？或者给包装器它自己的类或ID？

```
<div id="profile_pic">
    <img src="<?php echo $picture;?>" width="164" height="164" />
</div>​ 
```

.

```
$("#profile_pic").hover(
    function () {
    $(this).append($('<a id="duh" href="upload.php">Change the picture</a>'));
 });​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-06T15:21:55.227

```
$("#profile_pic").hover(
            function () {
                $(this).after($('<a id="duh" href="upload.php">Change the picture</a>'));
}); 
```

# sql - 合并以显示最新的非空值

> ID：13746714
> 
> 赞同：2
> 
> 时间：2012-12-06T15:18:32.493
> 
> 标签：sql, oracle, oracle11gr2

我有以下架构，并为此问题添加了代表性示例数据：

[SQL小提琴](http://sqlfiddle.com/#!4/d8bcc/1)

**Oracle 11g R2 模式设置**：

```
create table foo(id integer, att1 varchar(9), att2 varchar(9), from_at date);
insert into foo(id, att1, att2, from_at) values(1, 'J', null, sysdate-5);
insert into foo(id, att1, att2, from_at) values(1, null, 'L', sysdate-4);
insert into foo(id, att1, att2, from_at) values(1, 'B', null, sysdate-3); 
insert into foo(id, att1, att2, from_at) values(1, 'C', null, sysdate-2); 
insert into foo(id, att1, att2, from_at) values(1, null, 'H', sysdate-1); 
insert into foo(id, att1, att2, from_at) values(1, 'A', 'H', sysdate);
insert into foo(id, att1, att2, from_at) values(2, null, 'H', sysdate-1); 
insert into foo(id, att1, att2, from_at) values(2, 'A', null, sysdate);

| ID |   ATT1 |   ATT2 |                         FROM_AT |
----------------------------------------------------------
|  1 |      J | (null) | December, 01 2012 15:13:42+0000 |
|  1 | (null) |      L | December, 02 2012 15:13:42+0000 |
|  1 |      B | (null) | December, 03 2012 15:13:42+0000 |
|  1 |      C | (null) | December, 04 2012 15:13:42+0000 |
|  1 | (null) |      H | December, 05 2012 15:13:42+0000 |
|  1 |      A |      H | December, 06 2012 15:13:42+0000 |
|  2 | (null) |      H | December, 05 2012 15:13:42+0000 |
|  2 |      A | (null) | December, 06 2012 15:13:42+0000 | 
```

我希望能够显示每一行，但用`att1`和替换为 that`att2`的*最新*值`id`。`null`属性表示与上次插入行时没有变化的值，非属性`null`表示新值。输出应如下所示：

```
| ID |   ATT1 |   ATT2 |
------------------------
|  1 |      J | (null) |
|  1 |      J |      L |
|  1 |      B |      L |
|  1 |      C |      L |
|  1 |      C |      H |
|  1 |      A |      H |
|  2 | (null) |      H |
|  2 |      A |      H | 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:18:32.493

你可以用`lag`and做到这一点`ignore nulls`：

**查询**：

```
select id, 
       nvl(att1,lag(att1 ignore nulls) over (partition by id order by from_at))
         as att1,
       nvl(att2,lag(att2 ignore nulls) over (partition by id order by from_at)) 
         as att2
from foo 
```

**结果**：

```
| ID |   ATT1 |   ATT2 |
------------------------
|  1 |      J | (null) |
|  1 |      J |      L |
|  1 |      B |      L |
|  1 |      C |      L |
|  1 |      C |      H |
|  1 |      A |      H |
|  2 | (null) |      H |
|  2 |      A |      H | 
```

# python - 使用 re 在文档过程中捕获关键字之间的文本

> ID：13746721
> 
> 赞同：3
> 
> 时间：2012-12-06T15:18:45.297
> 
> 标签：python, regex, string, search

我正在尝试在文档中的关键词和关键词本身之间捕获文本。

例如，假设我在一个字符串中有多个“egg”实例。我想捕捉“蛋”和“蛋”之间的每一个作品。

我努力了：

```
import re
text = "egg hashbrowns egg bacon egg fried milk egg"
re.findall(r"(/egg) (.*) (/egg)", text) 
```

我也试过`re.match`和`re.search`。

我通常得到的是`("egg"), ("hashbrowns egg bacon egg fried milk"), ("egg")`

我需要得到的是`(egg, hashbrown, egg), (egg, bacon egg), (egg, fried, milk, egg)`.

对于此事，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:34:27.800

您需要使用非贪婪匹配。是的`*?`非贪心形式`*`，匹配最小的可能序列。此外，`/egg`完全匹配，但我假设你只是想要`egg`，所以你的实际正则表达式变成`(egg) (.*?) (egg)`. 但是，由于正则表达式会在匹配字符串时使用它，因此您需要使用前瞻和后瞻断言来匹配中间文本。在这种情况下，`(?<=egg) (.*?) (?=egg)`查找前后带有“egg”的文本，但只返回中间的内容，即`['hashbrowns', 'bacon', 'fried milk']`. 尝试匹配“egg”也将复杂得多，并且可能涉及两次解析字符串，所以如果这实际上是你想要的，那么它唯一值得去研究它。

所有这些都记录在[python 文档](http://docs.python.org/2/library/re.html)中，因此请在此处查找更多信息。

# oracle - 找不到类型或命名空间名称“Oracle”（您是否缺少 using 指令或程序集引用？）

> ID：13746729
> 
> 赞同：1
> 
> 时间：2012-12-06T15:19:04.350
> 
> 标签：oracle, .net-4.0, odac, .net-client-profile, target-framework

我已经使用 Visual Studio 2010 创建了一个新的控制台应用程序项目（我尝试使用 VS 2012 并且问题是一样的）。使用方法是：

```
using System;
using System.Data.Common;
using Oracle.DataAccess.Client; 
```

在 Main 方法中，我编写了以下代码：

```
 var oracleInstance = OracleClientFactory.Instance;
        using (DbConnection conn = oracleInstance.CreateConnection())
        {
            conn.ConnectionString =
                "Data Source=XXX;Persist Security Info=True;User ID=XXX;Password=XXX;";
            conn.Open();

            var command = conn.CreateCommand();
            command.CommandText = "SELECT * FROM TABLE1 where rownum = 1";

            DbDataReader reader = command.ExecuteReader();

            while (reader.Read())
            {
                for (int i = 0; i < reader.FieldCount; i++)
                {
                    Console.WriteLine("Column number {0}: {1}", i, reader[i]);
                }
            }
} 
```

目标框架是 .NET 4.0 。我引用了 Oracle.DataAccess.dll 4.112.3.0 (.NET 4)。

问题是：**如果我以 .NET 4.0 为目标，则编译不起作用，并**显示找不到*类型或命名空间名称“Oracle”（您是否缺少 using 指令或程序集引用？）* **如果我以 .NET 为目标4.0 客户端配置文件，它工作正常。** 事实是**我需要针对 .NET 4.0 框架，而不是 .NET 4.0 客户端配置文件**！

这个问题有解决方案吗？

# solr - 使用多条件查询和 localparams 查询 Solr (Solr.net)

> ID：13746734
> 
> 赞同：2
> 
> 时间：2012-12-06T15:19:16.590
> 
> 标签：solr, filtering, tagging, solrnet

我正在尝试这样做：

```
http://solr:8080/solr/select/?q=name_make:[make]+name_model:[model]&rows=10000&wt=json&fq={!tag=dt}name_model:[model]&facet=on&facet.field={!ex=dt}name_model&facet.sort=count&facet.field.mincount=1 
```

使用 solr.net - 我有这个：

```
var multipleQuery = new SolrMultipleCriteriaQuery(queryList, "AND");
var Facets = new FacetParameters();

Facets.Queries.Add(new SolrFacetFieldQuery(new LocalParams{{"ex", "dt"}} +"name_model") { MinCount = 1, Sort = true});

 List<ISolrQuery> filter = new List<ISolrQuery>();
 filter.Add(new LocalParams { { "tag", "dt" }, { "mincount", "1" } } + Query.Field("name_model").Is(NameModel));

var result = solr.Query(multipleQuery, new QueryOptions
                                                  {
                                                      FilterQueries = filter,
                                                      Rows = rows,
                                                      Facet = facets, 
                                                      Start = index
                                                  }); 
```

我期待类似的东西

*   制作 1 [ ] 101
*   制作 2 [ ] 144
*   制作 3 [x] 232
*   使 2 [ ] 32

但只能得到

*   制作 3 [x] 232

从我的踪迹我看到

*   Solr q (name_make:[make] AND name_model:[model] AND price:[0 TO 250000] AND year_registration:[0 TO 10000000]) 0,023619 0,000006
*   Solr fq {!tag=dt mincount=1}name_model:A3

我错过了一块，还是走错了路？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T16:15:10.027

在您的原始查询（在顶部）中，您有`q=name_make:[make]+name_model:[model]`并且在下方有`name_make:[make] **AND** name_model:[model]` ，因此这可能是您的默认运算符的问题。您可以使用 SolrNet 使用“+”运算符而不是 && 来保留它。

..`new SolrQuery("name_make:[make]") + new SolrQuery("name_model:[model]")`

..会回报你：`name_make:[make] name_model:[model]`

然而 ..

`new SolrQuery("name_make:[make]") && new SolrQuery("name_model:[model]")`

..会回报你：`name_make:[make] AND name_model:[model]`

不知道是不是这样，但为了以防万一，可以尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-11T14:15:59.487

```
Please try to pass the string arraty that contains multiple field names and search text in the below method. I will return the solrnet query for search with multiple filed name with OR condition.

public ISolrQuery BuildQuery(string[] SearchFields, string SearchText)
    {

        AbstractSolrQuery firstQuery = new SolrQueryByField(parameters.SearchFields[0], SearchText) { Quoted = false };
        for (var i = 1; i < SearchFields.Length; i++)
        {
            firstQuery = firstQuery || new SolrQueryByField(SearchFields[i], SearchText) { Quoted = false };
        }

        return firstQuery;
    } 
```

# asp.net-mvc-4 - 使用 MVC 和 Razor 在 EPiServer 7 中构建顶部菜单

> ID：13746735
> 
> 赞同：2
> 
> 时间：2012-12-06T15:19:18.797
> 
> 标签：asp.net-mvc-4, episerver, episerver-7

我试图弄清楚如何在 EPiServer 7 中实现菜单。唯一可用的文档显示了如何使用我不使用的 webforms 来做到这一点

任何建议如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:18:45.840

在有人打败我之前写了一个解决方案:)

```
@using EPiServer
@using EPiServer.Core
@using EPiServer.Filters
@using EPiServer.Web.Mvc.Html

<ul id="mainMenu">
        @{ 
            PageData startPage = ContentReference.StartPage.GetPage();
            PageDataCollection allChilds = DataFactory.Instance.GetChildren(((PageData)startPage).PageLink);
            IEnumerable<PageData> filteredChilds = FilterForVisitor.Filter(allChilds).Where(p => p.IsVisibleOnSite() && p.VisibleInMenu);
        }

        @foreach (PageData item in filteredChilds)
        {
            <li>
                <a href="/@item.URLSegment.ToString()">
                    @item.Name
                </a>
            </li>
        }
</ul> 
```

其中 GetPage 是一个扩展方法

```
public static PageData GetPage(this PageReference pageLink)
{
    return DataFactory.Instance.GetPage(pageLink);
} 
```

# java - 手动编辑 Jar 以更改包名称

> ID：13746737
> 
> 赞同：31
> 
> 时间：2012-12-06T15:19:29.750
> 
> 标签：java, maven

我有一个来自外部来源的 jar 文件。jar 中的所有类都在 com.xyz 包中。

我想将所有类移动到 com.xyzold 包中。

这是否像解压缩 jar、将 xzy 文件夹重命名为 xyzold 并重新压缩它一样简单，还是我还需要修改每个类文件？

* * *

这是我的解决方案，使用[Jar Jar Links](https://github.com/shevek/jarjar)

```
java -jar jarjar-1.4.jar process rules.txt google-collections-1.0.jar google-collections-old-1.0.jar 
```

这是我的 rules.txt 文件的内容：

```
rule com.google.** com.googleold.@1 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-06T15:25:00.223

您可以使用[Jar Jar Links](http://code.google.com/p/jarjar/)来实现这一点。此外，您不需要要修改的类的源代码，因为程序是在字节码级别进行的（即它直接修改 .class 文件。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:24:44.683

你应该看看[Jar Jar Links](http://code.google.com/p/jarjar/)。（我对这个名字不承担任何责任:)。）

它的主要用例是将外部 jar 嵌入到您自己的 jar 中，为此，它可以重命名现有包。它改变了必要的字节码。你也许可以调整它来做你想做的事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:25:56.663

您可以在 Maven 构建中使用[Maven shade 插件来执行此操作。](http://maven.apache.org/plugins/maven-shade-plugin/examples/class-relocation.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-06T15:29:55.670

您可能可以使用[ProGuard obfuscator](http://proguard.sourceforge.net/)来做到这一点。它当然可以在包中移动代码并在字节码级别运行。它的主要目的是混淆，因此当然应该首先考虑其他选项之一。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-12-06T15:21:33.080

不，您需要修改 jar 文件中的所有类。您需要有源代码才能更改包。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-12-06T15:21:45.197

您还需要修改所有 Java 源文件。不仅是包名，还有导入，以及任何可能的内联声明。真的不值得。

# jquery - 单击按钮获取下一个和上一个输入

> ID：13746753
> 
> 赞同：3
> 
> 时间：2012-12-06T15:20:19.023
> 
> 标签：jquery, html

我需要通过单击 `a`元素样式作为按钮来获取上一个和下一个输入的值...示例代码：

```
<ul>
    <li>
        <input type="text">
    </li>
</ul>
<ul>
    <li class="li-inline">
        <a class="btn" href="#">
            <i class=""></i>
        </a>
    </li>
</ul>
<ul>
    <li>
        <input type="text">
    </li>
</ul> 
```

我尝试使用`next()`和`prev()`jquery 方法，但没有达到预期的结果。

```
$("a").click(function() {
  $(this).next(":input");
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:22:00.010

`ul`首先，您必须使用到达父级，然后使用或分别[`closest()`](http://api.jquery.com/closest/)转到下一个或上一个，并使用在后代中查找输入`ul`[`next()`](http://api.jquery.com/next/)[`prev()`](http://api.jquery.com/prev/)[`find()`](http://api.jquery.com/find/)

**[现场演示](http://jsfiddle.net/rajaadil/mzEKQ/)**

```
$("a").click(function() {
     $(this).closest('ul').prev('ul').find(":input");
     $(this).closest('ul').next('ul').find(":input");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:22:38.870

试试这个：

```
$("a").click(function() {
    var $a = $(this);
    var prevInputValue = $a.closest('ul').prev().find('input').val();
    var nextInputValue = $a.closest('ul').next().find('input').val();
}); 
```

在您的原始代码中，`next()`不起作用，因为`input`元素不是`a`. 您需要遍历 DOM 以找到`ul`包含它们的相关内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:24:01.987

试试下面的代码

```
$("a").click(function() {

var previous =   $($(this).closest('ul').prev('ul').find.(":input").get(0)).val();

var next=   $($(this).closest('ul').next('ul').find.(":input").get(0)).val();
}); 
```

谢谢

# sql - 数据库读取数据在事务期间如何变化？

> ID：13746755
> 
> 赞同：3
> 
> 时间：2012-12-06T15:20:22.617
> 
> 标签：sql, database, transactions

让我们假设以下场景：

```
[Start TX]
SELECT userName FROM users WHERE userId = 1; -- returns x
UPDATE users SET userName = 'y' where userId = 1;
SELECT userName FROM users WHERE userId = 1; -- returns y
[End TX] 
```

数据库如何知道第二次返回 y？事务状态如何集成到查询处理中？

另一种情况：

```
[Start TX]
SELECT userName FROM users, accounts WHERE useres.userId = accounts.userId AND accounts.balance < 0; -- returns x
UPDATE accounts SET balance = 100 where userId = 1;
SELECT userName FROM users, accounts WHERE useres.userId = accounts.userId AND accounts.balance < 0; -- returns nothing
[End TX] 
```

同样的问题 - 数据库如何在事务信息上运行连接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:12:12.280

让我们将数据库表视为[B-Tree](http://en.wikipedia.org/wiki/B-tree)。让我谈谈它的数据结构 - 对于您的主题，我们应该知道 B-tree 是页面组织的。假设您有 9 行（从 标记`A..I`）和页面大小 = 3 的 B 树。以某种方式，我们在磁盘上有 3 页

```
Page1: A,B,C,
Page2: D,E,F
Page3: G,H,I 
```

假设您已经更改了 row 中的某些内容`E`。您的数据库**连接**将为 page2 分配内存并完全加载它 ( `D..F`)。您进行了更改，`E`但未提交事务。现在您尝试选择（在同一**连接**中）。由于内存已经包含加载的页面，您的 SELECT 将看到已修改的数据。但是，如果**另一个连接**将尝试加载`E`它必须加载到内存中的可变`D..F`页面 2。提交 page2 被持久化后，所有其他**连接**都可以看到更改。

当然在现实世界中这个过程要复杂得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:00:56.660

我建议阅读以下文章：

[SQL Server 2005 基于行版本的事务隔离](http://msdn.microsoft.com/en-us/library/ms345124%28v=sql.90%29.aspx)

虽然这篇文章专门针对 Sql Server 2005，但它对各种类型的并发控制进行了很​​好的总结：

> 控制并发有两种主要模型：悲观并发和乐观并发。
> 
> 在基于悲观并发控制的系统中，锁用于防止用户以影响其他用户的方式修改数据。应用锁后，其他用户无法执行与锁冲突的操作，直到所有者释放它。这种级别的控制用于数据竞争激烈的环境中，并且在发生并发冲突时使用锁保护数据的成本低于回滚事务的成本。
> 
> 相反，在基于乐观并发控制的系统中，用户在读取数据时不会锁定数据。执行更新时，系统会检查其他用户是否在读取数据后对其进行了更改。如果另一个用户更新了数据，则会引发错误。通常，收到错误的用户会回滚事务，然后重新提交事务。这被称为乐观并发，因为它主要用于数据争用较少的环境，并且偶尔回滚事务的成本超过读取数据时锁定数据的成本。
> 
> 使用行版本控制的读取提交隔离介于悲观和乐观并发之间。在此隔离级别下，读取操作不会针对实时数据获取锁。但是，对于更新操作，此隔离级别的过程与默认已提交读隔离级别的过程相同：要更新的行的选择是通过使用阻塞扫描完成的，其中将数据行上的更新锁作为数据获取值被读取。
> 
> 另一方面，快照隔离是真正乐观的，因为要修改的数据实际上并没有提前锁定，而是在选择修改时锁定了数据。当数据行满足更新条件时，快照事务会验证该数据在快照事务启动后未被其他事务修改。如果数据没有被另一个事务修改，快照事务会锁定数据，更新数据，释放锁，然后继续。如果数据已被另一个事务修改，则会发生更新冲突，快照事务会回滚。

就像建议的评论一样，使用的并发控制类型不仅因所使用的数据库平台而异，而且在平台内也因所使用的设置而异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:32:14.433

对于任何事务隔离级别，您都可以访问来自同一事务的脏数据。

# c# - 如何在没有 Visual Studio 的情况下附加到 64 位进程？

> ID：13746762
> 
> 赞同：1
> 
> 时间：2012-12-06T15:20:29.630
> 
> 标签：c#, .net, debugging

如何在没有 Visual Studio 的情况下将调试器附加到正在运行的 64 位 .net 进程？

我努力了：

*   [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Default.aspx)但它不允许附加到 64 位进程
*   [Visual Studio Express](http://www.microsoft.com/visualstudio/eng/products/visual-studio-2010-express)但它没有“附加到进程...”选项

可以与 64 位 .net 应用程序一起使用的 JIT 调试器也很好。

我需要这样做的原因是我有一个应用程序编译 C# 脚本，由应用程序的用户编写并运行它们。我希望应用程序的用户能够调试脚本，但我不希望每个应用程序用户都需要 Visual Studio 许可证，所以我正在寻找一个免费的解决方案来解决这个问题。

编辑：

*   我也不想给用户我所有的源代码，而只是二进制文件。
*   脚本是 C# 代码，在我的应用程序的运行时编译

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:23:21.730

尝试带有**[SOS](http://msdn.microsoft.com/en-us/library/bb190764.aspx)**扩展的 WinDbg。SOS 是旧版 WinDbg 调试器的托管调试扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:31:06.777

Visual Studio Express 2008/2010 的这种解决方法对您有帮助吗[？](http://www.ninjatrader.com/support/forum/showthread.php?t=15671)

# jquery - 使用 JSON 数据使用 Highcharts 重绘饼图

> ID：13746764
> 
> 赞同：0
> 
> 时间：2012-12-06T15:20:37.773
> 
> 标签：jquery, ajax, json, highcharts

我现在完全卡在这里几个小时，我找不到错误:(

我需要根据从数据库中获取的数据绘制饼图。图表需要每隔几秒钟用新数据重新绘制一次，所以我通过 AJAX 获取数据（作为 JSON）。到目前为止没有问题。

但现在我需要让 Highcharts 来实际绘制新数据。似乎不可能 :( 它只保留初始数据 - 即使警报显示新数据已正确解析并输入到图表的“数据”属性中。

谁能给点建议？

```
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <script>
var chart;

var options = {
    chart:
    {
        renderTo: 'container',
        defaultSeriesType: 'column',
        events:
        {
            load: requestData,
            redraw: function(){alert("graph has just been redrawn");}
        }
    },
    series: [
    {
        type: 'pie',
        name: 'x',
        data: [['All', 1],['more', 2]]
    }]
};

function requestData()
{
    $.ajax(
    {
        url: "http://1.2.3.4/getMeSomeJSON.php",
        type: "GET",
        success: function(response)
        {
            var json = jQuery.parseJSON(response);
            var protocols = response.services.protocols;

            chart.series[0].data = [];
            for(var i=0; i<protocols.length; i++)
            {
                var tmp = protocols[i].prot;
                chart.series[0].data.push({tmp: protocols[i].byte_len});
            }
            //alert(chart.series[0].data); // everything seems to be OK here...

            // neither one works :(
            //chart.redraw();
            //chart = new Highcharts.Chart(options);

            // call it again after one second
            setTimeout(requestData, 1000);
        },
        cache: false
    });
}
    </script>
</head>
<body>

<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto; border: 1px solid black;"></div>
<script>
$(document).ready(function()
{
    chart = new Highcharts.Chart(options);
});
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:17:31.537

要动态更新，您必须使用`setData`，如下所示。

```
var json = jQuery.parseJSON(response),
    protocols = json.services.protocols,
    data = [];

for(var i=0; i<protocols.length; i++) {
    var tmp = protocols[i].prot;
    data.push({tmp: protocols[i].byte_len});
}

chart.serie[0].setData(data); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/SzuPB/4/)

[在这里](https://stackoverflow.com/questions/10131774/highcharts-updating-a-pie-chart-with-setdata)你可以看到一个相关的问题。

参考

*   [http://api.highcharts.com/highstock#object-Series](http://api.highcharts.com/highstock#object-Series)

# file - Lucene.Net 索引文件夹中的所有文件

> ID：13746766
> 
> 赞同：1
> 
> 时间：2012-12-06T15:20:39.777
> 
> 标签：file, indexing, directory, lucene.net

有没有办法索引特定文件夹中的所有文件？引用一个文件夹，并以某种方式将文件夹中的所有文档添加到索引中，而无需遍历文件夹中的所有文件。在 DtSearch 中，有一个“IndexFilesInFolder(foldername)”方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T09:39:26.140

Lucene.Net 源代码中有一个[演示目录](https://github.com/apache/lucene.net/tree/trunk/src/demo)，其中包括如何索引文件夹中的所有文件以及搜索索引的示例。它适用于基本的文本文档，您需要处理其他文档类型来提取它们的内容。

# c# - wcf 服务中的抽象对象集合定义

> ID：13746768
> 
> 赞同：0
> 
> 时间：2012-12-06T15:20:53.380
> 
> 标签：c#, wcf, soapui, datacontract

我的 DataContract 中有一组对象定义为

```
Collection<BaseAbstractObject> 
```

**我想用一些ClassA**类型的继承对象来填充。

我正在使用 Soap UI 为我的服务方法创建这样的请求，但我会收到错误***“无法创建抽象类”***

我还用**[KnownType(ClassA)]**属性装饰了基类。我的 xml 请求如下所示：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/" xmlns:wcf="http://schemas.datacontract.org/2004/07/WcfService1" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
   <soapenv:Header/>
   <soapenv:Body>
      <tem:GetDataUsingDataContract>
         <tem:composite>
            <wcf:ClassesCollection>
               <wcf:BaseClass i:type="ClassA" >
                  <wcf:Id>1</wcf:Id>                      
                  <wcf:Name>ClassA</wcf:Name>
               </wcf:BaseClass>
            </wcf:ClassesCollection>
         </tem:composite>
      </tem:GetDataUsingDataContract>
   </soapenv:Body>
</soapenv:Envelope> 
```

这就是我的 DataContracts 的样子：

```
[DataContract]
public class MyDataContract
{
    public MyDataContract()
    {
        ClassesCollection = new Collection<BaseClass>();
    }

    [DataMember]
    public Collection<BaseClass> ClassesCollection { get; private set; }
}

[DataContract]
[KnownType(typeof(ClassA))]
public abstract class BaseClass
{
    [DataMember]
    public int Id { get; set; }
}

[DataContract]
public class ClassA : BaseClass
{
    [DataMember]
    public int Name { get; set; }
} 
```

那么我的请求应该是什么样的呢？还是需要我向 DataContract 添加一些其他属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T08:01:20.473

首先确保您的集合具有公共设置器，否则 WCF 将无法反序列化它：

```
[DataMember]
public Collection<BaseClass> ClassesCollection { get; set; } 
```

然后是示例请求的样子：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <GetDataUsingDataContract xmlns="http://tempuri.org/">
      <composite xmlns:a="http://schemas.datacontract.org/2004/07/WcfService1" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <a:ClassesCollection>
          <a:BaseClass i:type="a:ClassA">
            <a:Id>1</a:Id>
            <a:Name>5</a:Name>
          </a:BaseClass>
        </a:ClassesCollection>
      </composite>
    </GetDataUsingDataContract>
  </s:Body>
</s:Envelope> 
```

# javascript - 重定向到没有访问权限的文件。IE

> ID：13746774
> 
> 赞同：0
> 
> 时间：2012-12-06T15:21:02.360
> 
> 标签：javascript, internet-explorer, http

当我们的用户访问我们的 Intranet 页面之一时，我需要重定向到我的网络中的文件。某些用户将无权访问某些文件。发生这种情况时，IE 会打开他们有权访问的父文件夹。有没有办法让 IE 显示错误消息而不是打开父文件夹？

我`window.location.href`用来执行重定向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:24:08.610

不，没有。这是文件系统问题，不是浏览器问题。

# c# - 无法使用 TagBuilder 组合标签

> ID：13746776
> 
> 赞同：3
> 
> 时间：2012-12-06T15:21:09.463
> 
> 标签：c#, asp.net-mvc-4, html-helper

我正在尝试构建一个组合标签：

第一个标签：`<span class="requiredInidicator">* </span>` 第二个标签：（`<label>SomeText</label>`为简洁起见，属性被剪掉了）

我想将这些组合起来返回一个 MVCHtmlString 但下面的代码完全忽略了跨度。有人可以指出我做错了什么

这是我的代码：

```
// Create the Label
var tagBuilder = new TagBuilder("label");
tagBuilder.Attributes.Add("id", "required" + id);
//I get the id earlier fyi - not pertinent fyi for this question )

// Create the Span
var required = new TagBuilder("span");
required.AddCssClass("requiredInidicator"); 
required.SetInnerText("* ");

//Now combine the span's content with the label tag
tagBuilder.InnerHtml += required.ToString(TagRenderMode.Normal);
tagBuilder.SetInnerText(labelText);
var tag = MvcHtmlString.Create(tagBuilder.ToString(TagRenderMode.Normal));
return tag; 
```

创建标签时，将完全忽略*跨度。*当我在调试期间检查标签时，它并不关心我通过附加的要求`.InnerHtml+=`

有什么明显的我做错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:35:55.520

试试这样：

```
var label = new TagBuilder("label");
label.Attributes.Add("id", "required" + id);
//I get the id earlier fyi - not pertinent fyi for this question )

// Create the Span
var span = new TagBuilder("span");
span.AddCssClass("requiredInidicator");
span.SetInnerText("* ");

//Now combine the span's content with the label tag
label.InnerHtml = span.ToString(TagRenderMode.Normal) + htmlHelper.Encode(labelText);
return MvcHtmlString.Create(label.ToString(TagRenderMode.Normal)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T15:32:44.457

您不应该打电话`SetInnertext`（尤其是在刚刚分配之后`Innerhtml`）。您想使用其中一个。

如果您要追加，请继续使用`InnerHtml += labeltext`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T15:31:34.913

你总是可以这样做：

```
string output = "";
output += tabBuilder.ToString(TagRenderMode.Normal);
output += required.ToString(TagRenderMode.Normal);

return MvcHtmlString.Create(output); 
```

问题可能是 TagBuilder 假定一个根级别的 HTML 标记，但我不确定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T15:32:57.483

这个怎么样：

```
tagBuilder.SetInnerText(labelText + required.ToString(TagRenderMode.Normal)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-06T15:33:56.790

尝试在跨度上使用 InneHtml 属性

```
// Create the Span
var required = new TagBuilder("span");
required.InnerHtml ("SOME TEXT"); 
```

# r - R - 为什么 grep 不返回多个索引？

> ID：13746781
> 
> 赞同：2
> 
> 时间：2012-12-06T15:21:24.373
> 
> 标签：r

对于此代码：

```
> grep("abc","abcabcabc", value=FALSE)
[1] 1 
```

我认为它会给我字符串中出现“abc”的所有索引。难道我做错了什么？我应该使用其他方法来查找字符串中所有出现的模式吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-06T15:27:51.933

改用`gregexpr()`：

```
gregexpr("abc","abcabcabc")
[[1]]
[1] 1 4 7
attr(,"match.length")
[1] 3 3 3
attr(,"useBytes")
[1] TRUE 
```

这告诉您在位置 1、4 和 7 有匹配项。每个匹配项的长度为 3 个字符。

* * *

如果您只想打印匹配的位置，而不需要其他属性，请使用以下技巧：

```
x <- gregexpr("abc","abcabcabc")
lapply(x, c)
[[1]]
[1] 1 4 7 
```

这利用了`c()`从所有参数中去除属性的事实。因此，您使用`lapply`遍历列表，将每个元素传递给`c()`并返回没有其属性的相同元素。

* * *

好的，我刚刚被代理雷普利。

不要使用`lapply(x, c)`. 改为这样做：

```
lapply(x, as.vector)
[[1]]
[1] 1 4 7 
```

原因见`fortune(185)`

```
library(fortunes)
fortune(185)

I don't like to see the use of c() for its side effects. In this case Marc's
as.vector seems to me to be self-explanatory, and that is a virtue in programming
that is too often undervalued.
   -- Brian D. Ripley (on how to convert a matrix into a vector)
      R-help (March 2007) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T15:28:03.930

`grep`仅返回找到匹配项的索引值。

```
x <- c('a', 'b', 'aa', 'abc', 'bc')

grep('a', x)
# [1] 1 3 4 
```

您也可以使用`value = TRUE`返回`grep`匹配项而不是索引。

根据您的用例，您希望使用`gsub`或`gregexpr`。所有这些功能的帮助都包含在同一页面上，`?grep`.

# database - 从数据框/向量中删除相同数字的相同序列

> ID：13746783
> 
> 赞同：0
> 
> 时间：2012-12-06T15:21:29.057
> 
> 标签：database, r

我有一个数据集，其中包含“年”、“公司代码”和“def - 公司是否违约”列。我遇到的问题是“def”列包含默认的“1”序列。那些“1”代表公司运营的所有年份。因此，例如该公司从 1990 年开始运营，并在 2000 年倒闭。该列包含 10 倍“1”，即使该公司在去年（即 2000 年）违约。所以我应该为这个特定的“公司”设置列代码”只有 2000 年的“1”默认条目，而不是 1990-2000 年的默认条目。如何从“def”列中删除“1”的序列（我现在将其作为data.frame）并留下“1”的最后一个条目

我从创建垃圾箱开始：

```
split(data.frame[dataFrame$def == 1, ], dataFrame[dataFrame$def == 1, 'coKey]) 
```

其中“coKey”是“公司代码”。

我无法通过留下最后一次观察来清理数据，而且我也没有成功地将箱反转到原始数据框中，因为这样做的过程太过时了。

非常感谢您的帮助，非常感谢。

这是样本数据。

```
dataFrame <- structure(list(fyear = 1981:1986, 
   gvkey = c(1004L, 1004L, 1004L, 1004L, 1004L, 1004L), 
   def = structure(c(1L, 1L, 1L, 1L, 1L, 1L ), 
   .Label = c("0", "1"), class = "factor")), 
   .Names = c("fyear", "coKey", "def"), 
   row.names = c(NA, 6L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:03:00.140

听起来您正在尝试将一串`111`'s' 转换为单个`1`. 如果是这种情况，则应执行以下操作。

逐步分解：

```
# Likely they're factors.  Convert to strings.  # Dont convert to numeric if your data may have a series of approx 20+ 1's 
dataFrame$def <- as.character(dataFrame$def)

# Find which ones have any 1's at all
indxOf1s <- grep("1", dataFrame$def)

# Convert those to a single 1
  x <- gsub("1", "0", dataFrame$def[indxOf1s])    
  dataFrame$def[indxOf1s] <-  paste0(substr(x, 1, nchar(x)-1), rep(1, length(x)) )

dataFrame

        BEFORE      &          AFTER

    Comp    def             Comp    def
  1    A   1111           1    A   0001
  2    B   1111           2    B   0001
  3    C      0           3    C      0
  4    D 111111           4    D 000001
  5    E      1           5    E      1
  6    F 111111           6    F 000001
  7    G 111111           7    G 000001
  8    H  11111           8    H  00001 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:35:34.350

看起来您确实需要先拆分数据，如果 def 列中有 1，则将不是最大年份的所有内容更改为 0，然后将其重新组合在一起。

```
l <- split(dataFrame, data.Frame$coKey)
l <- lapply(l, function(x){ 
               if (1 %in% x$def) x$def[x$fyear != max(x$fyear)] <- 0
               x})
data.Frame <- do.call(rbind, l) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:36:26.790

阅读您的评论后，我相信这就是您想要的，但我不确定。

```
#Example data
df <- data.frame(fyear=rep(1981:1990,2),
                 gvkey=rep(c(1004,1005),each=10),
                 DEF=c(rep(0,2),rep(1,3),rep(0,5),rep(1,7),rep(0,3)))

library(plyr)

#function to apply by company
myfun <- function(x) {
  #check if last value is a 1
  if (last(x)==1) {
   res <- x*0
   res[length(res)] <- 1
  } else {
    #seach for difference between values == -1
    res <- as.numeric(c(diff(x),0)==-1)
  }
  res  
}

#split-apply-combine
ddply(df,~gvkey,transform,DEF2 = myfun(DEF)) 
```

结果：

```
 fyear gvkey DEF DEF2
1   1981  1004   0    0
2   1982  1004   0    0
3   1983  1004   1    0
4   1984  1004   1    0
5   1985  1004   1    1
6   1986  1004   0    0
7   1987  1004   0    0
8   1988  1004   0    0
9   1989  1004   0    0
10  1990  1004   0    0
11  1981  1005   1    0
12  1982  1005   1    0
13  1983  1005   1    0
14  1984  1005   1    0
15  1985  1005   1    0
16  1986  1005   1    0
17  1987  1005   1    1
18  1988  1005   0    0
19  1989  1005   0    0
20  1990  1005   0    0 
```

# matlab - 二次规划的问题

> ID：13746785
> 
> 赞同：2
> 
> 时间：2012-12-06T15:21:33.987
> 
> 标签：matlab, quadratic

我正在尝试进行二次规划。我有一个亲和力矩阵`A`，我必须最大化某些功能`x'*A*x`。这基本上与特征匹配有关，即匹配点到标签

这基本上与在加权图中的主导集和二次函数的局部最大化器之间建立联系有关

```
maximize(f({x} = x^{T}A{x}) 
```

受制于

```
x \epsilon\Delta, \Delta:\sum_{j}x_j=1 
```

为了解决这个问题，我找到了 Pavan 和 Pelillo IEEE PAMI 2007 给出的一种称为复制器方程的方法

一旦给出初始化`x(1)`，离散复制器方程可用于获得局部解 x ^*

```
x_i(t+1) = x_i(t+1) \frac{(Ax(t))_i}{x(t)^TAx(t)} 
```

当我使用复制方程时，我得到了正确的结果。但是，当我尝试使用 matlab 的 quadprog 函数来解决它时

```
X = quadprog(-A,[],[],[],Aeq,Beq,s); 
```

我没有得到正确的价值观。假设我想用 7 个标签匹配 7 个点，我定义我的亲和力矩阵，然后使用上面的。然而，使用复制器方程我得到了正确的结果。但是只使用 quadprog 并不能得到正确的结果。有什么建议么？

难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:34:32.543

`quadprog()`文档显示：

```
x = quadprog(H,f,A,b,Aeq,beq,lb,ub,x0) 
```

`A`如果没有不等式约束，可以是，但它没有说 about ，`b`所以我假设你应该设置为向量。此外，如果您标记为是您的初始化，那么它不在正确的位置。`[]``f``f``zeros``s`

你写的那一行：

```
X = quadprog(-A,[],[],[],Aeq,Beq,s); 
```

应该：

```
X = quadprog(-A,f,[],[],Aeq,Beq,[],[],s); 
```

其中`f`是一个零向量。

顺便说一句，如果这是凸的，则不需要初始化点，如果它不是凸的，我不确定是否可以保证找到与复制器方法相同的局部解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:24:09.977

如果 A 是半正定的，那么最大化问题是一个凹问题而不是凸问题。如果 A 是半负定的，则 -A 是半正定的。您可以在 matlab 中优化 x^T(-A)x。

即：

```
min x^TAx 
```

是凸的，

和

```
max x^TAx  =  min x^T(-A)x 
```

是凹的。

如果

```
A>0 (Positive semidefinite) 
```

而 quadprog 需要凸

由于 matlab quadprog 失败，我猜你的 A 是半正定的。您可以执行 eig(A) 来检查所有特征值是否为正，因此您需要一些凹优化解决方案。

# url - Symfony 2 - 编码用作 URL 的字符串

> ID：13746788
> 
> 赞同：1
> 
> 时间：2012-12-06T15:21:36.667
> 
> 标签：url, symfony, encoding

Dose Symfony 2 有一个类似 Wordpress[`sanitize_title_with_dashes`](http://codex.wordpress.org/Function_Reference/sanitize_title_with_dashes)或 Codeigniter 的方法[`url_title`](http://ellislab.com/codeigniter/user-guide/helpers/url_helper.html)，可以将字符串转换`____I am Bob`为`i-am-bob`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:06:43.207

您可以将 DoctrineExtension Sluggable 与 StofDoctrineExtensionsBundle 一起使用。

在此处查找文档并[在](https://github.com/l3pp4rd/DoctrineExtensions/blob/master/doc/sluggable.md#basic-usage-examples)[此处](http://symfony.com/doc/current/cookbook/doctrine/common_extensions.html)查找示例。

# python - 如何加快 Django 过滤语句

> ID：13746790
> 
> 赞同：0
> 
> 时间：2012-12-06T15:21:45.230
> 
> 标签：python, django, filter

我有一些 django 代码如下。我只是过滤不同的对象并尝试获取 fitler 结果的总数。然后将这些数字传递给 html 页面。在 html 页面中，我只显示这些总数。就这样。

但是，当用户访问此页面时，速度确实很慢。我看不到任何可以加快程序速度的代码改进。有没有人对加速代码有任何建议，或者我所能做的就是升级服务器？

我正在考虑在数据库中创建这些表的视图或索引。但是我对如何在 django 中做到这一点没有理想。我也可以直接在数据库中进行操作，但是如何从 django 访问数据库中的视图？

```
try:       
    p_r = P.objects.get(p_id=rec_id, f__f_id=f_id, d__n=d)
    s = S.objects.get(r=p_r)
except S.DoesNotExist:
    s = None
except S.MultipleObjectsReturned:
    s = S.objects.filter(r=p_r)

try:
    b = B.objects.filter(r=p_r)
except B.DoesNotExist:
    b = None

bu = {}
if b != None and len(b) > 0:
    bu['count'] = len(b)

try:
    a = A.objects.filter(r=p_r)
except A.DoesNotExist:
    a = None

 an = {}
if a != None and len(a) > 0:
    an['count'] = len(a)

try:
    ar = AR.objects.filter(r=p_r)
except AR.DoesNotExist:
    ar = None

ad = {}
if ar != None and len(ar) > 0:
    ad['count'] = len(ar)

try:
    c = C.objects.filter(r=p_r)
except C.DoesNotExist:
    c = None

co ={}
if c != None and len(c) > 0:
    co['count'] = len(c)

try:
    p_e = []
    ev = E.objects.all()
    for e in ev:
      if e.r_o.p_id == rec_id and e.r_o.record.f.f_id == f_id:
      patient_events.append(e)
except E.DoesNotExist:
    ev = None

ph = {}
if p_e and len(p_e) > 0:
    ph['count'] = len(p_e)
Log().add(request, "View", "I", 'pr', p_r.id)
response_dict.update ({'record': p_r,
                     'summary': s,
                     'bu': bu,
                     'an': an,
                     'ad': ad,
                     'co': co,
                     'ph': ph,
                     'p_id': rec_id,
                     'f_id': f_id,
                     'd': d_id,
                     })
return render_to_response('records/detail.html',response_dict, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:42:56.180

这是我从您的代码中注意到的：

1.  根据我的评论，使用该方法时不需要使用`try`块，`filter`因为它会返回一个空`QuerySet`并且不会引发`DoesNotExist`异常。您可以像这样替换块：

    ```
    try:
        b = B.objects.filter(r=p_r)
    except B.DoesNotExist:
        b = None 
    ```

    只需：

    ```
    b = B.objects.filter(r=p_r) 
    ```

2.  如果你想计算 a 的对象`QuerySet`，`count()`方法就是你想要的。因此，您可以在代码中像这样替换块：

    ```
    try:
        b = B.objects.filter(r=p_r)
    except B.DoesNotExist:
        b = None

    bu = {}
    if b != None and len(b) > 0:
        bu['count'] = len(b) 
    ```

    只需：

    ```
    b = B.objects.filter(r=p_r).count() # Will return 0 or more 
    ```

3.  看起来像 models `A`, `AR`, `B`,`C`和`S`你的模型有关系`P`，所以你最好只使用模板中的相关集。事实上，也许您应该使用它[`select_related`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-related)来避免额外的数据库命中

4.  也许您可以获取`P`对象并在模板中使用其相关对象来显示计数。在您看来：

    ```
    p_r = P.objects.select_related().get(p_id=rec_id, f__f_id=f_id, d__n=d) 
    ```

    在您的模板中：

    ```
    <p>A quantity: {{ record.A_set.all.count }}</p>
    <p>B quantity: {{ record.B_set.all.count }}</p>
    <p>C quantity: {{ record.C_set.all.count }}</p>
    .... 
    ```

5.  在这部分代码中：

    ```
    try:
        p_e = []
        ev = E.objects.all()
        for e in ev:
          if e.r_o.p_id == rec_id and e.r_o.record.f.f_id == f_id:
          patient_events.append(e)
    except E.DoesNotExist:
        ev = None 
    ```

    您不需要 for 循环，您只能`filter`为此使用方法（对不起，如果我做错了，但您明白了）：

    ```
    p_e = E.objects.filter(r_o__p__id=rec_id, r_o__record__f__f__id=f_id) 
    ```

考虑到这一切，这可能看起来像您的代码的第二个版本：

```
p_r = P.objects.select_related().get(p_id=rec_id, f__f_id=f_id, d__n=d)
ph = E.objects.filter(r_o__p__id=rec_id, r_o__record__f__f__id=f_id).count()

Log().add(request, "View", "I", 'pr', p_r.id)
response_dict.update ({'record': p_r,
                     'ph': ph,
                     'p_id': rec_id,
                     'f_id': f_id,
                     'd': d_id,
                     })
return render_to_response('records/detail.html',response_dict, context_instance=RequestContext(request)) 
```

# android - 无法让 Facebook Android SDK 3.0 工作 - 配置错误

> ID：13746791
> 
> 赞同：0
> 
> 时间：2012-12-06T15:21:45.660
> 
> 标签：android, facebook-android-sdk

我正在使用 Facebook SDK for Android 将 Facebook 登录集成到我的应用程序中。
我已经安装了 SDK 3.0 beta 2。并按照以下说明进行操作：

[https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)

它似乎运行良好，但是当我测试**示例应用程序**时，或者如果我尝试**自己的应用程序**，在登录屏幕中会显示：

```
"xxx is misconfigured for Facebook login. Press Okay to go back to the application without connecting it to Facebook" 
```

现在我在stackoverflow上经历了很多线程，我不是唯一遇到这个问题的人，但我无法让它工作。大多数人都在报告密钥哈希的问题。但是我查看了我的密钥的存储位置，我使用了 keytool 命令来获取我的密钥。并将其放在开发人员部分和我的应用程序 keyhash 字段中。我还使用了此处给出的另一种解决方案将密钥输出到 Logcat：

[适用于 Android 的 Facebook SDK - 示例应用无法运行](https://stackoverflow.com/questions/4424492/facebook-sdk-for-android-example-app-wont-work)

这给了我另一个钥匙更长的时间，我把两个钥匙都放在网上，但它仍然不起作用。

我还在 Util.java 中激活了“ENABLE_LOG”，但它从不输出任何东西。

我在 Eclipse 中没有收到任何有用的错误。
有人可以帮我找出问题所在吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T05:38:02.833

这是我的做法。

1.  下载 openssl-0.9.8e_X64 （openssl-0.9.8k_X64 不会给你正确的哈希）
2.  提取文件。
3.  打开命令提示符。
4.  并输入`"Location of keytool.exe" exportcert -alias youralias -keystore "location of your app keystore" | "location of your openssl.exe" sha1 -binary | "location of your openssl.exe" base64`

    例如`"C:\Program Files (x86)\Java\jdk1.7.0_07\bin\keytool" -exportcert -alias atif -keystore "H:\Android\All Aliases\Get Inspired\Get Inspired" | "C:\O pesnSSL\bin\openssl" sha1 -binary | "C:\OpesnSSL\bin\openssl" base64`

5.  复制哈希并将其粘贴到您的 Facebook 应用页面。

6.  享受应用程序。

# jquery - Zurb Foundation Accordion 嵌套在 Accordion 内部

> ID：13746793
> 
> 赞同：7
> 
> 时间：2012-12-06T15:21:49.353
> 
> 标签：jquery, html, css, responsive-design, zurb-foundation

我正在将[Zurb Foundation](http://foundation.zurb.com)用于响应式网站。我想使用以下 HTML 结构将手风琴嵌套在手风琴内：

```
<ul class="accordion">
    <li class="active">
        <div class="title">First Accordion Panel Title</div>
        <div class="content">First Accordion Panel Content</div>
    </li>
    <li>
        <div class="title">Second Accordion Panel Title</div>
        <div class="content">Second Accordion Panel Content</div>
    </li>
    <li>
        <div class="title">Parent Accordion Panel Title</div>
        <div class="content">

            <ul class="accordion">
                <li class="active">
                    <div class="title">Child Accordion Panel Title</div>
                    <div class="content">Child Accordion Panel Content</div>
                </li>
                ...
            </ul>

        </div>
    </li>
</ul> 
```

看起来使用此设置，当父手风琴面板打开时，随后的子手风琴面板打开（或至少某些标志设置为打开，因为箭头像打开的父面板一样指向下方）并且子手风琴功能中断。我可能会在 Foundation 父手风琴内添加一个 jQuery UI 手风琴，但它不会像父手风琴那样响应，因此可能会首先破坏使用 Foundation 的目的。

有没有人成功做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T13:16:39.977

您只需停止对手风琴项的单击事件传播，然后，如果您单击子手风琴项，则子单击事件不会关闭父项。

修改很简单，需要**在 click handler 中添加 param 事件**，使用 **event.stopPropagation();** 在带有当前单击元素的激活码的 else 语句中。

修改后的代码，请看代码注释：

```
;(function ($, window, undefined){   'use strict';

  $.fn.foundationAccordion = function (options) {
    var $accordion = $('.accordion');

    if ($accordion.hasClass('hover') && !Modernizr.touch) {
      $('.accordion li', this).on({
        mouseenter : function () {
          var p = $(this).parent(),
            flyout = $(this).children('.content').first();
          $('.content', p).not(flyout).hide().parent('li').removeClass('active'); 
          flyout.show(0, function () {
            flyout.parent('li').addClass('active');
          });
        }
      });
    } else { 
      //be sure to add the param event in the click function handler
      $('.accordion li', this).on('click.fndtn', function (event) {
        var li = $(this),
            p = $(this).parent(),
            flyout = $(this).children('.content').first();

        if (li.hasClass('active')) { 
          p.find('li').removeClass('active').end().find('.content').hide();
        } else {
          //stop event propagation          
      event.stopPropagation();
          $('.content', p).not(flyout).hide().parent('li').removeClass('active'); 
          flyout.show(0, function () {
            flyout.parent('li').addClass('active');
          });
        }
      });
    }

  };

})( jQuery, this ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T17:19:30.890

我遇到了这个问题。手风琴可以工作，但箭头指示器和样式就好像每个儿童手风琴都打开了一样。这是一个 CSS“错误”，您可以通过在 Foundation.css 的第 715 和 716 行添加一个额外的子选择器来修复它：

```
ul.accordion > li.active > .title { background: white; padding-top: 13px; }
ul.accordion > li.active > .title:after { content: ""; display: block; width: 0; height: 0; border: solid 6px; border-color: #9d9d9d transparent transparent transparent; } 
```

新的子选择器位于**li.active**和**.title**之间。

# google-analytics - Google Analytics - 按国家/地区跟踪

> ID：13746794
> 
> 赞同：0
> 
> 时间：2012-12-06T15:21:51.623
> 
> 标签：google-analytics

我在一个国际网站上工作。为了支持多个国家和语言，页面 URL 如下所示：

> www.example.com/fr-en/Page

其中“fr”是国家代码，“en”是页面语言。

是否可以为每个国家/地区添加特定的谷歌跟踪代码？

我需要这样才能为每个国家/地区的经销商提供 Google Analytics 访问权限，他们将只能查看其国家/地区的流量统计信息。当然，我还需要一个 Google Analytics 帐户来管理所有网站流量（适用于所有国家/地区）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:10:51.203

您可以在 Google Analytics 配置文件上使用过滤器来仅包含特定目录的流量。在所有页面上使用一个属性 ID，并拥有一个没有过滤器的配置文件来显示所有流量。然后在每个国家/地区拥有一个配置文件，并在 URL 中为国家/地区代码提供自定义过滤器 - 对于您的示例，正​​则表达式将类似于`^/fr`.

Google Analytics 允许您在个人资料级别分配访问权限，因此每个经销商只能查看自己的数据。

注意：过滤器不能追溯工作——它们只会过滤应用到配置文件后传入的新数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:32:39.173

是的，这是可能的。

我认为有几种方法可以做到这一点。一种方法是将不同的跟踪 ID 代码添加到不同国家/地区的页面。

这是谷歌分析跟踪代码的代码：

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxxxxxxxx']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

UA-xxxxxxxxxx 是跟踪 ID，您可以应用多个。

每个国家或语言下的页面都包含具有不同跟踪 ID 的代码副本。

并且所有页面还包含另一个代码副本，即“全局”跟踪 ID。

# ios - UIView 覆盖 drawRect 导致视图不遵守 maskToBounds

> ID：13746795
> 
> 赞同：7
> 
> 时间：2012-12-06T15:21:53.573
> 
> 标签：ios, uiview, ios6, drawrect

我试图`drawRect:`在我的自定义视图中覆盖 UIView 的方法。但是，我的视图的边界半径定义为：

```
 sub = [[[NSBundle mainBundle] loadNibNamed:@"ProfileView" owner:self options:nil] objectAtIndex:0];
    [self addSubview:sub];
    [sub setUserInteractionEnabled:YES];
    [self setUserInteractionEnabled:YES];
    CALayer *layer = sub.layer;
    layer.masksToBounds = YES;
    layer.borderWidth = 5.0;
    layer.borderColor = [UIColor whiteColor].CGColor;
    layer.cornerRadius = 30.0; 
```

这完美地工作并在我的视图周围放置一个带有边界半径的漂亮边框（不要介意后面的对角线/直线白线，它们与此视图无关）：

![正确一个](../Images/7f5b3c50adc49cae384b62d16d4b6e91.png)

但是，当我尝试`drawRect:`在我的视图中覆盖该方法时，我可以看到黑色背景没有遮盖边界。我什么都不做**（**目前），这是我的代码：

```
-(void)drawRect:(CGRect)rect{
    [super drawRect:rect];
} 
```

结果如下：

![不正确的](../Images/93c68238f58b14d1cce5deb349722a75.png)

除了draw方法，我什么都没改变。如何在保持视图服从角半径遮罩的同时覆盖 draw 方法？这是iOS中的错误还是我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T00:56:45.883

我不知道完整的答案，但我知道 UIView 的实现会`drawLayer:inContext:`根据您是否实现而有所不同`drawRect:`。也许掩蔽/剪切到边界是它做不同的事情之一。

您可以尝试通过多种方式解决您的问题：

*   让你的背景透明：

    ```
     layer.backgroundColor = [UIColor clearColor].CGColor; 
    ```

*   将自己夹在自定义中`drawRect:`：

    ```
    - (void)drawRect:(CGRect)rect {
        [[UIBezierPath bezierPathWithRoundedRect:rect cornerRadius:30.0] addClip];
        [image drawInRect:rect];  // or whatever
    } 
    ```

*   明确地切出角落：

    ```
    CGContextBeginPath(c);
    CGContextAddArc(c, r, r, r, M_PI, 3*M_PI_2, 0);
    CGContextAddLineToPoint(c, 0, 0);
    CGContextClosePath(c);
    CGContextClip(c);
    [[UIColor grayColor] setFill];
    UIRectFill(rect); 
    ```

我从 WWDC 2010 的这个精彩演示文稿中窃取了最后两条建议：[iPhone OS 上的高级性能优化（](http://adcdownload.apple.com//wwdc_2010/wwdc_2010_video_assets__pdfs/135__advanced_performance_optimization_on_iphone_os_part_1.pdf)[此索引页面上](https://developer.apple.com/videos/wwdc/2010/)列出的视频——烦人的是，没有直接链接）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-18T14:51:37.137

这是一个老问题，但我最近阅读了一篇有用的博客文章，标题为[Abusing UIView](http://jimkubicek.com/blog/2012/10/11/using-uiview/)。在其中，作者建议`drawRect`不要在有其他方法的情况下覆盖做一些事情，比如添加边框。他说，

> 覆盖`drawRect:`会导致性能下降。我没有分析它，所以我不知道在正常情况下它是否是一个显着的性能（可能不是），但在大多数情况下，重写的人`drawRect:`可以通过在视图的图层属性上设置属性来更轻松地完成他们想要的事情. 如果您需要在视图周围绘制轮廓，请执行以下操作：
> 
> ```
> #import <QuartzCore/QuartzCore.h>
> 
> - (id)initWithFrame:(CGRect)frame {
>   self = [super initWithFrame:frame];
>   if (self) {
>       self.layer.borderWidth = 2.f;
>       self.layer.borderColor = [UIColor redColor].CGColor;
>   }
>   return self; 
> ```

我意识到这可能无法解决黑色背景透出的问题。这只是需要考虑的其他事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-22T09:51:04.977

环境

```
opaque = false // NO for ObjC 
```

在视图上解决了问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-09T14:32:27.413

可能你不应该打电话给

```
[super drawRect:rect] 
```

在你的drawRect里面。[苹果表示](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/index.html)：

> 如果你直接继承 UIView，你的这个方法的实现不需要调用 super。但是，如果您要对不同的视图类进行子类化，则应在实现中的某个时刻调用 super。

似乎调用 super 方法会导致奇怪的行为。

# xslt - XSLT 命名空间和解析硬编码前缀

> ID：13746804
> 
> 赞同：1
> 
> 时间：2012-12-06T15:22:06.513
> 
> 标签：xslt, namespaces, xslt-1.0

对于 Google Merchant Center 集成，我需要提供 XML，其中*一些*元素具有命名空间前缀，例如：

```
 <g:availability>in stock</g:availability>, 
```

而其他不需要命名空间，例如：

```
 <title>My Product</title> 
```

但是，我无法想出一个允许我的 XSLT：

1) 指定相应的命名空间 (xmlns:g="http://base.google.com/ns/1.0") AND 2) 前缀属性

，没有在某处添加“g”命名空间。

* * *

我相信 exclude-result-prefixes="g" 不适用于我的用例。要重新迭代，我需要在一些 XML 元素前面加上“g”。如果我不需要这样做，例如

```
<availability>in stock<availability> 
```

，然后 exclude-result-prefixes 工作正常。但是，当我将前缀添加到我的元素时，命名空间会在 XSLT 运行时添加。我在下面有一个这种情况的例子。

谢谢。

* * *

XSLT：

```
<xsl:template match="/">

    <xsl:element name="type">
        <xsl:for-each select="categories/product">
            <xsl:element name="product">
                <g:availability>
                    <xsl:text>preorder</xsl:text>
                </g:availability>
            </xsl:element>
        </xsl:for-each>
    </xsl:element>
</xsl:template> 
```

* * *

XML:

```
<?xml version="1.0" encoding="UTF-8"?>
<categories>
<product>
<id>1</id> 
<preorder>true</preorder>
<releaseDate>true</releaseDate>
<quantity>1</quantity>
</product>
<product>
<id>2</id> 
<preorder>false</preorder>
<quantity>0</quantity>
</product>
<product>
<id>3</id> 
<preorder></preorder>
<quantity>10</quantity>
</product> 
```

输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<type>
<product>
<g:availability xmlns:g="http://base.google.com/ns/1.0">preorder</g:availability>
</product>
<product>
<g:availability xmlns:g="http://base.google.com/ns/1.0">preorder</g:availability>
</product>
<product>
<g:availability xmlns:g="http://base.google.com/ns/1.0">preorder</g:availability>
</product>
</type> 
```

（不完整）Google Merchant，预期的 XML 示例

```
<?xml version="1.0"?>
<rss xmlns:g="http://base.google.com/ns/1.0" version="2.0">
<channel>
<title>Example - Online Store</title>
<item>
<title>LG Flatron M2262D 22" Full HD LCD TV</title>
<g:id>TV_123456</g:id>
<g:condition>used</g:condition>
</item>     
</channel>
</rss> 
```

* * *

使用 XSLT 版本 1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:32:07.617

您需要在*某处*声明命名空间，因为没有它，XML 的命名空间格式不正确，但是您可以`<g:availability>`通过在样式表中声明命名空间并使用文字根元素，使其在根元素上只出现一次，而不是在每个元素上重复出现模板而不是`<xsl:element>`. 例如，要生成类似于您在问题中提供的 Google 示例的内容，您可以说：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"
                xmlns:g="http://base.google.com/ns/1.0">

    <xsl:template match="/">
        <rss version="2.0">
            <channel>
                <title>Example - Online Store</title>
                <xsl:for-each select="categories/product">
                    <item>
                        <g:id><xsl:value-of select="id"/></g:id>
                        <g:availability>preorder</g:availability>
                    </item>
                </xsl:for-each>
             </channel>
        </rss>
    </xsl:template>
</xsl:stylesheet> 
```

这应该产生

```
<rss version="2.0" xmlns:g="http://base.google.com/ns/1.0">
  <channel>
    <title>Example - Online Store</title>
    <item>
      <g:id>1</g:id>
      <g:availability>preorder</g:availability>
    </item>
    <item>
      <g:id>2</g:id>
      <g:availability>preorder</g:availability>
    </item>
    <item>
      <g:id>3</g:id>
      <g:availability>preorder</g:availability>
    </item>
  </channel>
</rss> 
```

这样做的原因是因为字面量结果元素将在样式表中其位置范围内的名称空间绑定传递到结果树中。

# objective-c - 推送通知和故事板

> ID：13746805
> 
> 赞同：0
> 
> 时间：2012-12-06T15:22:09.010
> 
> 标签：objective-c, ios, xcode

我有一个推送通知进入应用程序委托，我想跳转到情节提要中的视图。我试过推动视图控制器。我试过推动 segue，我试过添加视图没有任何效果，我要么一无所获，要么呆在原地，要么我得到一个空白屏幕。

故事板位于导航控制器中。

# c++ - 释放中间变量

> ID：13746806
> 
> 赞同：1
> 
> 时间：2012-12-06T15:22:10.860
> 
> 标签：c++, memory, free

我正在检查源代码并看到这个`for`循环：

```
for (int i=0; i < result1.length(); i++) {
    unsigned char *buff = ascii_to_utf8((unsigned char)result1.at(i));
    result.append((char*)buff);
    free (buff);
} 
```

已改为：

```
for (int i=0; i < result1.length(); i++)
    result.append((char*)ascii_to_utf8((unsigned char)result1.at(i))); 
```

我能看到的唯一区别是在第二个代码中没有中间变量。

我的问题是，我看不到的两个代码片段之间有区别吗？`free`seconde 代码中没有任何内容吗？

------------ 编辑 ------------ 这是 ascii_to_utf8 的源代码：

```
unsigned char* InvoiceXML::ascii_to_utf8(unsigned char c)
{
    unsigned char *out;

    if(c < 128)
    {
        out = (unsigned char *)calloc(2, sizeof(char));
        out[0] = c;
        out[1] = '\0';
    }
    else
    {
        out = (unsigned char *)calloc(3, sizeof(char));
        out[0] = (c >> 6) | 0xC0;
        out[1] = (c & 0x3F) | 0x80;
        out[2] = '\0';
    }

    return out; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:26:52.387

这取决于 ascii_to_utf8 做什么；它几乎肯定会分配内存，在这种情况下，您确实需要那里的“免费”。所以第二个片段会泄漏内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:44:38.867

如果`ascii_to_utf8`更改为不分配内存（例如，通过对结果使用静态 char 数组），则调用者不应删除返回的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T15:44:38.993

如果`ascii_to_utf8`确实分配了内存，那么：

第一个片段：如果您的`result`对象**没有**在`append`函数中复制，那显然是错误的——您将存储指向已释放值的指针。

第二个片段：如果您的`result`对象确实在函数**中复制**`append`，那是错误的；如果**不是**，那么您需要在`free()`某处获取该数据，但此代码段是正确的。

此外，如果``ascii_to_utf8`确实通过 分配内存`new`，则应`delete`改为使用。

否则（`ascii_to_utf8`不分配内存）：

第一个片段是错误的 - 您不应`free`静态分配内存。

第二个片段是正确的。

# iphone - 我正在尝试使用以下代码自定义 UITabbar 没有任何运气

> ID：13746814
> 
> 赞同：0
> 
> 时间：2012-12-06T15:22:31.753
> 
> 标签：iphone, objective-c, ios, uitabbarcontroller, uitabbar

我正在尝试使用以下代码自定义 UITabbar 没有任何运气：

这是在我的 viewDidLoad 方法中

```
 UIImage *tabBackground = [[UIImage imageNamed:@"tabbar.png"]
                              resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
    // Set background for all UITabBars
    [[UITabBar appearance] setBackgroundImage:tabBackground];
    // Set background for only this UITabBar
    [[self.tabBarController tabBar] setBackgroundImage:tabBackground]; 
```

知道我在这里可能会出错吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T07:45:37.140

我们可以改变 UITabBar 控制器的背景颜色。请参考下面给出的代码。希望这对您有所帮助。

```
 tabBar1.backgroundColor = [UIColor clearColor];
   CGRect frame = CGRectMake(0, 0, 480, 49);
   UIView *view = [[UIView alloc] initWithFrame:frame];
   UIImage *image = [UIImage imageNamed:@"Image.png"];
   UIColor *color = [[UIColor alloc] initWithPatternImage:image];
   view.backgroundColor = color;
   [color release];
   [[self tabBar] insertSubview:view atIndex:0];
   [view release]; 
```

# javascript - 我在 python 中创建了一个列表，但是如何在 javascript 中遍历这个列表？

> ID：13746821
> 
> 赞同：1
> 
> 时间：2012-12-06T15:23:00.133
> 
> 标签：javascript, jquery, python, django, json

我在 python 中创建了一个列表，然后将其转换为 json。但我无法在 javascript 中迭代并显示正确的项目。

有什么建议吗？

Python：

```
def friends2(request):
    fb_feed = [#data in here]
    b = json.dumps(fb_feed)
    print b
    return HttpResponse(b) 
```

当我`print b`：

```
[
    [1236870349, "Your friend", "Bhangra indian Jingle Bells balle balle Merry Christmas", "2lPdXV1KO4s", "Your friend watched \"Bhangra indian Jingle Bells balle balle Merry Christmas\""], 
    [2303218, "Your friend", "Look at this Instagram (Nickelback Parody)", "ttp://www.c", "Your friend watched \"Look at this Instagram (Nickelback Parody)\""]

] 
```

javascript

```
 <script>
$(document).ready(function (){

            event.preventDefault();
            $.ajax({
                 type:"GET",
                 url:"/friends2/",
                 data: {},

                 success: function(b){
                    b = jQuery.parseJSON(b);
                                            console.log(b) //returns null
                    for (var i = 0; i < b.length; i++) { 
                            var friend = "";
                            friend = b[i][3]
                            friend += "\n";
                            $('.social').append(friend);
                        }                

                    }
            });
});
</script> 
```

html

```
<div class = 'social'></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:27:56.850

添加`dataType:json`到`$.ajax`脚本

```
 $.ajax({
         type:"GET",
         url:"/friends2/",  #the url /friends2/ points to friends2 in python
         data: {},
         dataType: json, //ADD THIS
         ...
         ... 
```

如果你不想添加，`dataType`那么你可以`jQuery.parseJSON(b)`用来解析你的 json 字符串，

```
success: function(b) {
    var data = jQuery.parseJSON(b); //parse JSON string here
    ...
    ...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:38:33.823

我认为你的代码有错误。json应该是正确的。b[3] 未定义，因为数组的长度为 2。您的意思是 b[i][3] 吗？

据我所知，其他一切都应该有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T01:59:11.977

如果您的视图返回 JSON，您应该相应地设置内容类型（MIME 类型）：

```
return HttpResponse(b, content_type='application/json') 
```

jQuery`$.ajax`足够聪明，可以`dataType: json`在正确设置 MIME 类型时自动应用：

> 数据类型
> 
> 默认值：智能猜测（xml、json、脚本或 html）
> 
> 您期望从服务器返回的数据类型。如果没有指定，jQuery 将尝试根据响应的 MIME 类型推断它

# java - 开源 Java 词形还原器

> ID：13746824
> 
> 赞同：1
> 
> 时间：2012-12-06T15:23:09.930
> 
> 标签：java, lemmatization

我想问一下你是否知道任何开源的 java 实现的词法分析器。或者，如果不是开源的，至少可以使用任何 java 实现的词形还原器，而无需支付许可证费用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:29:51.627

你试过门吗？它是用Java编写的。其中大部分是纯 Java，有些部分只是其他东西的 Java 包装器。它可能有一个用于您想要词形化的语言或文本类型的插件。

[http://gate.ac.uk/gate/doc/plugins.html](http://gate.ac.uk/gate/doc/plugins.html)

它应该被认为是研究质量，但它的特色很强。几年前，我在我的 NLP 课程中将它用于问答系统。

（也是我的母校谢菲尔德大学制作的！：D）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:39:37.303

斯坦福 NLP 包执行词形还原。它是根据 GNU 通用公共许可证获得许可的。

有关更多具体信息，请参阅[斯坦福 NLP 网站](http://nlp.stanford.edu/software/corenlp.shtml)。

# javascript - 如何在 JavaScript 中复制此正则表达式而无需后视？

> ID：13746825
> 
> 赞同：2
> 
> 时间：2012-12-06T15:23:10.110
> 
> 标签：javascript, regex, lookbehind

这是我在 C# 中的正则表达式：

```
(?<!\([\w\s]+)\bSWORD\b 
```

我现在在 JavaScript 中需要这个。我是正则表达式的新手，所以我不知道如果没有后视我将如何做到这一点。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:28:09.010

Since you don't have a lookahead as well, there is a neat trick. Reverse the input string and apply the reversed regular expression:

```
\bDROWS\b(?![\w\s]+\() 
```

If you want the position of the match in the actual input string, then you can find it as:

```
lengthOfInputString - (foundMatchPosition + lengthOfMatch) 
```

# java - 如何使用实体管理器将每个事务刷新到数据库

> ID：13746827
> 
> 赞同：0
> 
> 时间：2012-12-06T15:23:15.590
> 
> 标签：java, hibernate, jpa, seam, jta

我使用 smooks 从 .csv 文件中获取记录，文件大小约为单个文件中 30MB 的数据，在这个文件中，大约有 3 万条记录被提取到列表中。

我做了下一个列表使用 subList 划分为子部分 分区大小最多为 2000 。

我想在单个事务中刷新 2000 条记录。但在我的代码中不允许这样。

我正在使用 seam 2.1.2，jap with hibernate，EntityManager，JTA Transactions。

```
components.xml

  <core:init debug="false" jndi-pattern="@jndiPattern@" />
    <core:manager concurrent-request-timeout="2000"
        conversation-id-parameter="cid" conversation-timeout="120000"
        parent-conversation-id-parameter="pid" />
    <web:hot-deploy-filter url-pattern="/*.mobee" />
    <persistence:entity-manager-factory
        installed="@seamBootstrapsPu@" name="entityManagerFactory"
        persistence-unit-name="mobeeadmin" />
    <persistence:managed-persistence-context 
        auto-create="true" entity-manager-factory="@seamEmfRef@" name="entityManager"
        persistence-unit-jndi-name="@puJndiName@" />
 <async:quartz-dispatcher />
    <security:identity authenticate-method="#{authenticator.authenticate}" />
  <web:rewrite-filter view-mapping="*.mobee" />
    <web:multipart-filter create-temp-files="true" max-request-size="28672000"     url-pattern="*.seam"/>
    <event type="org.jboss.seam.security.notLoggedIn">
        <action execute="#{redirect.captureCurrentView}" />
    </event>
<event type="org.jboss.seam.security.loginSuccessful">
        <action execute="#{redirect.returnToCapturedView}" />
    </event>
    <mail:mail-session host="localhost" port="25" /> 
```

Java 代码：

```
 private  List<DoTempCustomers> doTempCustomers;

   int partitionSize = 2000;

   for (int i = 0; i < doTempCustomers.size(); i += partitionSize) {
      String message= tempCustomerMigration(doTempCustomers.subList(i,
               i + Math.min(partitionSize, doTempCustomers.size() - i)));
   }

 @Begin(join=true)
    public String tempCustomerMigration(List<DoTempCustomers>  list){
         PersistenceProvider.instance().setFlushModeManual(getEntityManager());
         TempCustomers temp = null;
      for(DoTempCustomers tempCustomers:list){
        try {
        temp=new TempCustomers();
            BeanUtils.copyProperties(temp, tempCustomers);
            getEntityManager.persist();
            getEntityManager.flush();
         } 
```

我尝试了很多次这个问题从来没有解决如何在每个事务中将记录刷新到数据库，然后再将服务器响应发送到 GUI

否则我得到异常的一些处理时间是

```
2012-12-06 17:09:56,380 WARN  [com.arjuna.ats.arjuna.logging.arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.BasicAction_58] - Abort of action id -53eff40e:f2db:50c0a356:7d invoked while multiple threads active within it.
2012-12-06 17:09:56,380 WARN  [com.arjuna.ats.arjuna.logging.arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.CheckedAction_2] - CheckedAction::check - atomic action -53eff40e:f2db:50c0a356:7d aborting with 1 threads active!
2012-12-06 17:09:56,522 DEBUG [org.jboss.util.NestedThrowable] org.jboss.util.NestedThrowable.parentTraceEnabled=true
2012-12-06 17:09:56,522 DEBUG [org.jboss.util.NestedThrowable] org.jboss.util.NestedThrowable.nestedTraceEnabled=false
2012-12-06 17:09:56,522 DEBUG [org.jboss.util.NestedThrowable] org.jboss.util.NestedThrowable.detectDuplicateNesting=true
2012-12-06 17:09:56,524 INFO  [STDOUT] [Mobee]- WARN 2012-12-06 17:09:56,524 [] JDBCExceptionReporter - SQL Error: 0, SQLState: null
2012-12-06 17:09:56,525 INFO  [STDOUT] [Mobee]-ERROR 2012-12-06 17:09:56,524 [] JDBCExceptionReporter - Transaction is not active: tx=TransactionImple < ac, BasicAction: -53eff40e:f2db:50c0a356:7d status: ActionStatus.ABORTING >; - nested throwable: (javax.resource.ResourceException: Transaction is not active: tx=TransactionImple < ac, BasicAction: -53eff40e:f2db:50c0a356:7d status: ActionStatus.ABORTING >)
2012-12-06 17:09:56,545 INFO  [STDOUT] [Mobee]-ERROR 2012-12-06 17:09:56,527 [] AbstractFlushingEventListener - Could not synchronize database state with session
org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:103) 
```

对于这个例外，我在 google 中找到了 sol 以增加 jboss--service.xml 中的 TransactionTimeout 对我来说，即使增加超时参数也没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T01:10:52.347

您可以创建一个新的 Seam 组件，它是一个 EJB 会话 Bean，并使用[UserTransaction](http://docs.oracle.com/javaee/5/api/javax/transaction/UserTransaction.html "JEE5 用户事务")批量执行更新/插入。UserTransaction 还允许您指定事务超时。您可以将此新组件注入您在上面使用的组件中。 [这是一个示例 - 请参阅第 5 篇文章。](http://community.jboss.org/message/684117#684117 "Seam EJB UserTransaction 示例"). 否则，如果您不想使用 EJB，我认为您的方法将要求您使用嵌套的 Seam 对话，因为您似乎正在使用限定为单个对话的[Seam 托管持久性上下文。](http://docs.jboss.org/seam/2.2.2.Final/reference/en-US/html/persistence.html#persistence.seam-managed-persistence-contexts "接缝管理的持久性上下文")

# excel - 如何编写脚本以特定时间间隔将 Excel 文件保存到另一个文件？

> ID：13746828
> 
> 赞同：0
> 
> 时间：2012-12-06T15:23:14.727
> 
> 标签：excel, vba

我有一个创建 Excel 文档备份副本的宏。
如何使宏在每次保存文档时自动运行？

这是代码：

```
Sub BUandSave()  
  'Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)  
  'Saves the current file to a backup folder and the default folder  
  'Note that any backup is overwritten  
 Application.DisplayAlerts = False  
 ActiveWorkbook.SaveCopyAs Filename:="G:\1 Processing\Christine\" & _  
 ActiveWorkbook.Name  
 ActiveWorkbook.save  
 Application.DisplayAlerts = True  
End Sub 
```

我从网上获得了这段代码，并且对 VBA 的技能为零，请帮忙！

编辑：好的，谢谢您的回答和洞察力。现在我还有另一个问题。如何使备份副本以不同的名称保存。我想让它像 DO NOT DELETE 或 DO NOT EDIT 这样的东西，这样编辑文件的人就不会偶然尝试编辑错误的文件。如何将其添加到代码中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:41:19.483

答案在您发布的代码中：

```
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)  
'Saves the current file to a backup folder and the default folder  
'Note that any backup is overwritten  

 Application.DisplayAlerts = False  
 ActiveWorkbook.SaveCopyAs Filename:="G:\1 Processing\Christine\" & ActiveWorkbook.Name  
 ActiveWorkbook.Save
 Application.DisplayAlerts = True  
End Sub 
```

将上述代码放入您的`ThisWorkbook`模块中（Alt + F11 将带您进入 VBA 编辑器）。 `Workbook_BeforeSave`是一个工作簿事件。每当触发事件时（在这种情况下，在保存工作簿之前），都会执行其中的代码。Excel 中的事件非常酷，并且是代码吊索的强大工具 :-) 您在问题中发布的代码现在不再需要。

# node.js - 如何获取 node.js 中 require(id) 抛出的 SyntaxError 的行号？

> ID：13746831
> 
> 赞同：1
> 
> 时间：2012-12-06T15:23:22.190
> 
> 标签：node.js, try-catch, require

[![控制台输出](../Images/61ed6854e496a2a1a262f55498088091.png)](https://i.stack.imgur.com/a1JbG.png)
[（来源：[nocookie.net](https://images1.wikia.nocookie.net/ummi/images/a/a1/Untitled.png)）]

我正在尝试访问我在 nodejs 程序中以红色突出显示的文本。我目前在 require 调用周围有一个 try/catch 块，但我在 catch 中转储的堆栈跟踪不包含我试图访问的信息（即发生错误的“testdebug.js”中的行号）。

以红色突出显示的行显然是由节点内部的某些东西打印的。如何将该字符串存储在我的程序中？代码如下。

```
var syntaxError = true;
try {
    debugModule = require('./testdebug.js')
    syntaxError = false;
}
catch(e) {
    console.log(e.stack);
    //there was a syntax error.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:29:01.537

这家伙知道怎么回事。他的模块使用 esprima 检查代码中的解析器错误，并提供一个有用的对象来剖析它们。

[https://github.com/substack/node-syntax-error](https://github.com/substack/node-syntax-error)

# git - 是否可以从 Google Drive 管理 GIT 非裸仓库？

> ID：13746833
> 
> 赞同：6
> 
> 时间：2012-12-06T15:23:34.927
> 
> 标签：git, github, google-apps-script, google-drive-api

我是一名 Javascript 开发人员，我正在开发一个带有 Google Drive 集成的在线 JS 编辑器，在侧栏中显示您的 Drive 文件。由于许多 JS 开发人员使用 Github 作为存储库，我希望允许从侧边栏提交、拉取和推送。

问题是这些文件存储在 Google Drive 上，所以我必须在 Drive 文件夹中执行“git commit”、“git pull”等。有人知道这是否可能吗？

我用谷歌搜索了很多，但我发现的一切都是关于使用 Drive 作为 git 裸存储库的存储。我想将 Github 保留为中央存储库，我只想在我的 Drive 帐户中有一个克隆。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T20:07:50.683

现在我明白了这个问题......

我认为您需要一个与 Google Drive API 对话的文件系统驱动程序。这将让 Git 与 Google Drive API 对话，就像它与所有其他文件系统对话一样，而无需加载所有 Google Drive 文件、代码等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T04:09:09.913

You might want to check out [GDriveFS](https://github.com/dsoprea/GDriveFS/), a FUSE wrapper for Google Drive in Python.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T18:53:28.963

Google Drive 文件夹只是一个在多台机器上复制的文件夹（使用 Google Drive 'magic' 基础架构代码），因此只要您的 PC 和网络能够跟上这些更改，克隆 repo 就应该没有问题谷歌云端硬盘目录。

话虽如此，当我的 Git 历史记录深入时，我已经让 Google Drive 需要几分钟时间来同步，同时将 repo 的普通备份副本复制到 Google Drive（20k LOC，有很多提交）。

# android - Android Keyguard 窗口不显示 IllegalArgumentException

> ID：13746836
> 
> 赞同：2
> 
> 时间：2012-12-06T15:23:40.120
> 
> 标签：android

Android Keyguard 已创建，一切似乎都正常工作但随机（几乎不可能重现），设备认为它已锁定但 Keyguard 窗口未显示。我在日志中看到的唯一异常是下面的 IllegalArgumentException。有谁知道为什么会发生这种情况，从哪里开始投资这个失败的根本原因或如何补救？

```
00717 11-14 14:33:47.851   479   540 WRN WindowManager: Failed looking up window
00717 11-14 14:33:47.851   479   540 WRN WindowManager: java.lang.IllegalArgumentException: Requested window android.view.ViewRootImpl$W@413f34b0 is in session Session{413f2350 uid 1000}, not Session{416fb2f0 uid 1000}
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at com.android.server.wm.WindowManagerService.windowForClientLocked(WindowManagerService.java:7444)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at com.android.server.wm.WindowManagerService.windowForClientLocked(WindowManagerService.java:7426)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at com.android.server.wm.WindowManagerService.relayoutWindow(WindowManagerService.java:2646)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at com.android.server.wm.Session.relayout(Session.java:173)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at android.view.ViewRootImpl.relayoutWindow(ViewRootImpl.java:3679)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1278)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2535)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at android.os.Handler.dispatchMessage(Handler.java:99)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at android.os.Looper.loop(Looper.java:137)
00717 11-14 14:33:47.851   479   540 WRN WindowManager:     at com.android.server.wm.WindowManagerService$PolicyThread.run(WindowManagerService.java:825) 
```

# objective-c - 我应该使用什么设计模式来构建跨 OSX 和 iOS 库？

> ID：13746837
> 
> 赞同：1
> 
> 时间：2012-12-06T15:23:47.377
> 
> 标签：objective-c, ios, macos, design-patterns, abaddressbook

我正在尝试构建一个库，该库具有处理 iOS 和 OSX 通讯簿框架（iOS 上的联系人列表和 OSX 上的联系人）的便捷方法，并包括以下方法：

*   `(BOOL)addressBookContainsRecordWithID:(NSString *)recordID`（`NSInteger`在 OSX 的情况下）
*   `(id)newOrExistingGroupWithName:(NSString *)groupName`
*   `(id)addressBookRecordWithID:(NSString *)recordID`

等等

而且我希望能够在 OSX 和 iOS 上调用这些方法，但让该方法执行每个设备各自的逻辑路径。例如，在 OSX 上它会使用一个使用的方法，`ABPerson`而`ABGroup`在 iOS 上它会使用一个使用`ABRecordRef`.

我目前的计划是使用预处理器指令 ( `#if device-is-osx callOSXMethod #else callIOSMethod`) 来确定我使用的是 iOS 还是 OSX 并使用正确的方法。

有没有更好的方法可以解决这个问题？我觉得这里可以使用一些设计模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T15:31:51.140

这取决于您的两个不同实现之间将有多少共享代码。如果除了对 AddressBook 框架的一些特定方法调用之外几乎所有代码都是共享的，那么预处理器指令`#if TARGET_OS_IPHONE`就是要走的路。

另一方面，如果您发现`#if`块中的代码变得很长，将 Mac 和 iOS 实现拆分为共享相同接口的单独文件通常更有意义。因此，您将拥有：

*   MyAddressBook.h - 两者共享
*   MyAddressBook_Mac.h - MyAddressBook 的 Mac 实现
*   MyAddressBook_iOS.h - MyAddressBook 的 iOS 实现

通过在每个实现文件中使用类扩展，您的实现甚至可以具有不同的实例变量，这使得这变得更容易。第二种模式以必须维护两个地方的任何通用代码为代价提高了可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:25:59.893

预处理器指令是要走的路。您甚至可以使用预定义的：

```
#if TARGET_OS_IPHONE
    // iOS code here
#else
    // OS X code here
#endif 
```

# git - 'git cherry' 是否考虑头部和上游的提交次数？

> ID：13746846
> 
> 赞同：3
> 
> 时间：2012-12-06T15:24:08.460
> 
> 标签：git

考虑以下场景：

```
$ git branch –a 
* dev
  master

$ git branch --contains 53fdfaf89fca499c36c71d29f25eb1a13b32d4d6
 dev

$ git branch --contains f7dfb3689edcaf5f819fa5e691ce13abf858bca8
   dev
   master

$ git cherry master dev
+ 53fdfaf89fca499c36c71d29f25eb1a13b32d4d6
+ a4e66dbde954f73185d61bfb78b40ac5e61fe56c
+ 6fcffbd9b57e8a74726ea2cd3713f14baaaa06f5
+ 5031ad3cdf2e81c880e9cbf049abed6f1edde3bc
+ dcca33c373df6953ff164e8d70531abd71841278 
```

但转折点是，提交`f7dfb3689edcaf5f819fa5e691ce13abf858bca8`实际上是从 中挑选出来的`53fdfaf89fca499c36c71d29f25eb1a13b32d4d6`，并且两者完全相同（请原谅我，因为出于某种原因，我们必须有 2 个完全相同的提交，但提交 id 不同）除了提交消息和提交 id，还有两次提交之间没有区别。

现在根据`git cherry`文档， *将提交与从 git patch-id 程序获得的补丁 ID 进行比较。*

所以我实际上继续执行`git patch-id`下面的程序

```
$ git show 53fdfaf89fca499c36c71d29f25eb1a13b32d4d6 | git patch-id
bd6c061bd6c380d53832510cbaf68bebb4fb182d 53fdfaf89fca499c36c71d29f25eb1a13b32d4d6

$ git show f7dfb3689edcaf5f819fa5e691ce13abf858bca8 | git patch-id
bd6c061bd6c380d53832510cbaf68bebb4fb182d f7dfb3689edcaf5f819fa5e691ce13abf858bca8 
```

上面的结果表明，`git patch-id`实际上确实承认这两个提交是相同的，但`git cherry`命令仍然无法做到这一点。

我能看到发生这种情况的唯一原因是如果`git cherry`考虑到除`git patch-id`.

它是否考虑了头部提交的数量（即我的开发分支）？因为我们在 dev 分支上有 2 个版本的提交，而在 master 上只有 1 个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T11:14:41.323

从上面的输出中，您也将精心挑选的修订版合并到 dev 中（通过在某些时候合并 master）。Git 正在遍历修订集，它现在找到一个完全匹配并将其从要检查的修订集中删除，并且不会为其生成补丁 ID。好消息是，`git merge`仍然承认 dev 上的原始更改已经在 master 中，并且不会尝试重新应用该更改。

我认为在大多数涉及樱桃采摘的工作流程中，您永远不会将包含樱桃采摘的分支合并回您的分支。您通常会做更多类似的事情：将修复提交给 master，然后将cherry-pick 提交给一个稳定的分支。或者，在您的情况下，将错误修复提交给 master，然后将 master 合并到 dev 中。

`git cherry` [你可以在这里](https://github.com/git/git/blob/889d35899ba64640e47798681ecb34a4be043bad/builtin/log.c#L1466)看到后面的代码。[请注意此处](https://github.com/git/git/blob/889d35899ba64640e47798681ecb34a4be043bad/builtin/log.c#L699)的补丁 ID 生成。特别要注意第[719 行的注释](https://github.com/git/git/blob/889d35899ba64640e47798681ecb34a4be043bad/builtin/log.c#L719)。它将要求对 master 进行修订，而不是在 dev 中，因为 master 已合并到 dev 中，这将是没有的。因此不会生成补丁 ID。结果，看起来您最初的非樱桃采摘修订版尚未被掌握。

你可以争辩说这种行为是一个错误。但我认为，修复它可能会对性能产生重大影响。

# java - 使用 Spring OXM 的多个编组器/解组器

> ID：13746847
> 
> 赞同：0
> 
> 时间：2012-12-06T15:24:15.510
> 
> 标签：java, spring, jaxb, marshalling, spring-oxm

我有一个旧式 Web 服务项目，它接收两个不同的 XML 模式，但具有相同的属性名称（包括根元素）。我正在使用 Spring、OXM 和 JAXB2 进行编组/解组。

我已经用[另一个问题解决了上一个问题](https://stackoverflow.com/questions/13397834/how-do-unmarshalling-to-different-objects-depending-on-the-xml-received "如何根据收到的 XML 解组到不同的对象？")，因此我使用 SAX 解析器来确定要使用哪个解组器。解析 XML 时，我检查一个值，然后我可以使用解组器或其他解组器。

当我尝试使用 Spring OXM 定义 marshallers/unmarhsallers 时，我的问题就出现了。如果我用两个包设置类路径，它会失败，因为 unmarshaller 找到两个具有相同 XMLRootElement 的类。如果我设置要绑定的类列表，它也会失败，因为解组器总是解组到类列表中的最后一项（相同的 XMLRootElement，解组器不知道要解组哪个类）。

但如果我使用 JaxbContext，它可以正常工作：

```
JAXBContext jc = JAXBContext.newInstance(MyClass1.class);
myClass1Object = (MyClass1) jc.createUnmarshaller().unmarshal(new StreamSource(new StringReader(xml))); 
```

和

```
JAXBContext jc = JAXBContext.newInstance(MyClass2.class);
myClass2Object = (MyClass2) jc.createUnmarshaller().unmarshal(new StreamSource(new StringReader(xml))); 
```

如何将其转换为更多 Spring (OXM) 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T11:02:09.360

首先，我尝试在应用程序上下文文件中声明 JAXBContext 实例，但最后我尝试更改一个 XML 模式的名称空间。现在我使用 Spring OXM 来编组/解组我的两个 XML 模式，没有任何问题。

# c - malloc 结构中的结构数组

> ID：13746852
> 
> 赞同：2
> 
> 时间：2012-12-06T15:24:43.357
> 
> 标签：c, arrays, struct, malloc, dynamic-arrays

我有一个名为 course 的结构，每个课程都有多个节点（另一个结构“节点”）。

它具有的节点数各不相同，但我从一个文件中获得了该数字，我从中读取此信息，因此该数字位于一个变量中。

所以我需要一个 malloc 在结构内。但我很困惑。我知道你可以在结构中包含数组，但我不知道将创建 malloc 数组的代码放在哪里，因为我的结构在我的头文件中。这是我目前的代码。我意识到它看起来不对，我只是不知道如何修复它以及在哪里初始化 malloc 数组。

```
struct course {
    char identifier[2];
    int num_nodes;
    struct node *nodes;
    nodes = (struct nodes*)malloc(num_nodes*sizeof(struct node));
};

struct node {
    int number;
    char type[2];
}; 
```

我希望能够做类似的事情：

```
struct node a_node;
struct course a_course;

a_course.nodes[0] = a_node; 
```

ETC...

我用的C不多，这是我**第**一次尝试在C中使用动态数组。我的经验都来自Java，当然Java并没有真正像C一样使用指针，所以这就是全部对我来说有点困惑。

所以一些帮助将不胜感激，非常感谢:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T15:28:23.137

最简单的方法是创建一个初始化结构的函数：

```
void init_course(struct course* c, const char* id, int num_nodes)
{
    strncpy(c->identifier, id, sizeof(c->identifier));
    c->num_nodes = num_nodes;
    c->nodes = calloc(num_nodes, sizeof(struct node));
} 
```

为了对称，您还可以定义一个析构函数

```
void destroy_course(struct course* c)
{
    free(c->nodes);
} 
```

这些会有类似的用法

```
struct course c;
init_course(&c, "AA", 5);
/* do stuff with c */
destroy_course(&c); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T16:07:51.223

malloc（或 calloc - 我更喜欢用于结构）的目的是在运行时动态分配内存。所以，你的结构应该是这样的，因为它是一个对象定义：

```
struct course {
    char identifier[2];
    int num_nodes;
    struct node *nodes;
}; 
```

在您的程序中使用 course 结构的其他地方，您将需要为您创建的任何课程对象和 (ii) 该课程中的任何节点对象分配内存。

例如

```
main()
{
   // lets say 1 course
   struct course *my_course;
   my_course = calloc(1, sizeof(struct course));

   // lets say 3 nodes in that course
   struct node *my_nodes;
   my_nodes = calloc(3, sizeof(struct node));

   my_course.num_nodes = 3;
   my_course.nodes = my_nodes;

   //...
   // clean up
   free(my_nodes);
   free(my_course);
} 
```

现在，你很好。确保在退出之前释放内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T19:41:46.220

也可以通过这种方式直接在结构中分配结构：

首先声明你的结构：

```
struct course {
    char identifier[2];
    int num_nodes;
    struct node *nodes;
}; 
```

然后在你的程序中

```
main(){ 
    int i;
    struct course *c;
    c = malloc(sizeof(struct course));
    c->num_nodes = 3;
    c->nodes = malloc(sizeof(struct node)*c->num_nodes);

    for(i=0; i<c->num_nodes; i++) 
        c->nodes[i] = malloc(sizeof(struct node));

    //and free them this way
    for(i=0; i<c->num_nodes; i++) 
        free(c->nodes[i]);
    free(c->nodes);
    free(c);

} 
```

或者按照你喜欢的方式去做

# asp.net-mvc - MVC 4 密码恢复

> ID：13746856
> 
> 赞同：1
> 
> 时间：2012-12-06T15:24:46.790
> 
> 标签：asp.net-mvc, controller, asp.net-mvc-4, asp.net-membership, asp.net-mail

首先，我对 MVC 很陌生，我正在尝试为 MVC 4 实现密码恢复功能。我正在使用此处发布的此技术来实现此功能：[在哪里可以找到 C# 示例代码以在 ASP .NET MVC2 中实现密码恢复](https://stackoverflow.com/questions/7793108/where-to-find-c-sharp-sample-code-to-implement-password-recovery-in-asp-net-mvc/13733194#13733194)

我了解它的工作方式，但是缺少我现在尝试实现的辅助类。我说的是类：**NotificationsHelper.SendPasswordRetrieval(model.Email, this.ControllerContext);**

控制器上的**RetrievePassword**动作控制器有一个参数**PasswordRetrievalModel model**。我猜这是一个连接到 db 并在主题中实现一些属性的类模型是一个名为**Email**的字符串属性。这个对吗？

比**NotificationsHelper.SendPasswordRetrieval(model.Email, this.ControllerContext);** 静态类使用 2 个参数实现此静态方法**SendPasswordRetrievla**：**model.Email**是来自 PasswordRetrievalModel 模型类的字符串属性，因此这将是我们将向其发送电子邮件的用户电子邮件。比第二个参数是**this.ControllerContext**。这个参数的意义何在？将包含哪些值发送到**SendPasswordRetrieval**方法？

比我实现的类是这样的：

```
public static class NotificationsHelper
{
    public static bool SendPasswordRetrieval(string emailAddress, ControllerContext ctx)
    {
        try
        {
            StringBuilder emailMessage = new StringBuilder();

            emailMessage.Append("<br />");
            emailMessage.Append("Hello,");
            emailMessage.Append("You have requested a password recovery.");
            emailMessage.Append("<br />");
            emailMessage.Append("Please click the link below to change your password: <br />");
            emailMessage.Append("<br />");
            emailMessage.Append(string.Format("http://www.example.com/Account/Validate?email={0}&token={1}", emailAddress, "**345982374532453435345**"));
            emailMessage.Append("<br />");

            MailMessage email = new MailMessage();
            email.From = new MailAddress("noreplay@example.com");
            email.To.Add(new MailAddress(emailAddress));
            email.Subject = "domain.com Password Recovery";
            email.Body = emailMessage.ToString();
            email.IsBodyHtml = true;

            SmtpClient smtpServer = new SmtpClient();
            smtpServer.Host = "smtp.gmail.com";
            smtpServer.Port = 587;
            smtpServer.Credentials = new NetworkCredential("username", "password");
            smtpServer.EnableSsl = true;
            smtpServer.Send(email);
            return true;
        }            
        catch (Exception e)
        {
            Trace.WriteLine(String.Format("Failure to send email to {0}.", emailAddress));
            return false;
        }
    }
} 
```

在上面的代码中，我列出了格式化 url 的行，如何使用提供的代码 @agarcian 将令牌带到那里？令牌是否来自第二个参数**ControllerContext**？如果是，我如何从那里得到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T21:37:37.897

`usertable`为它添加新列`pwdresetTocket`，当用户请求重置密码时，`Guid.NewGuid()`在该用户的 pwdresetTocket 字段中插入，在回调 URL 中附加相同的内容

如果您不想将列添加到现有表，您可以创建一个新表并将其映射到用户表。

然后你的方法看起来像这样。

```
public static bool SendPasswordRetrieval(string emailAddress, ControllerContext ctx)
    {
        try
        {
            StringBuilder emailMessage = new StringBuilder();
          string token = Guid.NewGuid();
        // call to a method that will update the table with token
        updateUsertablewithResetTocket(tocken);

            emailMessage.Append("<br />");
            emailMessage.Append("Hello,");
            emailMessage.Append("You have requested a password recovery.");
            emailMessage.Append("<br />");
            emailMessage.Append("Please click the link below to change your password: <br />");
            emailMessage.Append("<br />");
            emailMessage.Append(string.Format("http://www.example.com/Account/Validate?email={0}&token={1}", emailAddress, token));
            emailMessage.Append("<br />");

            MailMessage email = new MailMessage();
            email.From = new MailAddress("noreplay@example.com");
            email.To.Add(new MailAddress(emailAddress));
            email.Subject = "domain.com Password Recovery";
            email.Body = emailMessage.ToString();
            email.IsBodyHtml = true;

            SmtpClient smtpServer = new SmtpClient();
            smtpServer.Host = "smtp.gmail.com";
            smtpServer.Port = 587;
            smtpServer.Credentials = new NetworkCredential("username", "password");
            smtpServer.EnableSsl = true;
            smtpServer.Send(email);
            return true;
        }            
        catch (Exception e)
        {
            Trace.WriteLine(String.Format("Failure to send email to {0}.", emailAddress));
            return false;
        }
    } 
```

用户重置密码后，清空重置令牌字段

# java - 特定查询的 SQLite 'Database Locked' 奇怪错误

> ID：13746861
> 
> 赞同：0
> 
> 时间：2012-12-06T15:25:11.970
> 
> 标签：java, database, sqlite, jdbc, database-locking

我正在使用 Java 开发一个项目，我必须在我的 SQLite 数据库中进行修改。我连接到它并且工作得很好，除了这个奇怪的错误。

```
s.executeUpdate("INSERT INTO STUDENTS VALUES('S0',11)");
...
//many statements... including queries
...
String c2="INSERT INTO STUDENTS VALUES ('S1', 2)";
s.executeUpdate(c2);
s.executeUpdate("DROP TABLE STUDENTS"); 
```

语句完美运行`s.executeUpdate("INSERT INTO STUDENTS VALUES('S0',11)");`并将 `s.executeUpdate(c2);`行插入数据库。但是当谈到下面的语句时，我得到了奇怪的数据库锁定错误。当我将查询更改为另一个时，它也工作得很好。到达结束语句时出现错误。更准确地说，上面编写的所有查询，即这里代码的第一条语句都工作得很好。

请帮助我找到错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:15:49.527

我猜“s”变量是一个语句。执行后尝试关闭资源：

```
PreparedStatement updateStatement = connection.prepareStatement("INSERT INTO STUDENTS VALUES ('S1', 2)");
        try {
            updateStatement.executeUpdate();
        } catch (SQLException e) {
            e.printStackTrace();
        } finally {
            updateStatement.close();
        } 
```

在每次调用数据库后执行此操作。

# c++ - 在 C++ 中使用 strtok

> ID：13746863
> 
> 赞同：0
> 
> 时间：2012-12-06T15:25:14.803
> 
> 标签：c++, string, io, token

我正在尝试读取一个具有输入（时间和价格）的文件：`12:23:31 67 12:31:23 78 [...]`我创建了一个`struct`包含小时、分钟和秒值的文件。我曾经`strtok`标记各个值并用于`atof`存储它们。但是，当我尝试标记时间时出现错误：无法转换`std::string' to 'char*' for argument 1 to 'char*'`

```
struct time
{
    int hours;
    int minutes;
    int seconds;
    double price;
};

int main()
{
    string file, input;
    time* time_array;
    char* tok;

    cout << "Enter a file name to read input: ";
    cin >> file;

    ifstream file_name(file.c_str());

    file_name >> input;
    file_name >> input;

    //while(!file_name.eof())
    for(int i = 0; i < 4; i++)
    {
        time_array = new time;
        file_name >> input;
        tok = strtok(input, ":"); //ERROR HERE
        while(tok != NULL)
        {
            *time_array.hours = atof(tok[0]);
            *time_array.minutes = atof(tok[1]);
            *time_array.seconds = atof(tok[2]);
        }
        file_name >> input;
        *time_array.prine = atof(input);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:39:16.700

我根本不会`strtok`用于这项工作¹。如果要使用类 C 工具，则使用 fscanf 读取数据：

```
// note there here `file_name` needs to be a FILE * instead of an ifstream.
fscanf(file_name, "%f:%f:%f %f", &hours, &minutes, &seconds, &price); 
```

大多数编写 C++ 的人更喜欢类型安全的东西。一种可能性是使用基本相同的格式字符串来使用[Boost.format](http://www.boost.org/doc/libs/1_52_0/libs/format/)读取数据。

另一种可能性是使用流提取器：

```
char ignore1, ignore2;
file >> hours >> ignore1 >> minutes >> ignore2 >> seconds >> price; 
```

至于这是做什么/如何工作的：每个提取器从输入流中读取一个项目。每个提取器`float`读取一个数字。每个提取器`char`读取一个字符。在这种情况下，我们希望看到：`99:99:99 99`，其中`9`表示“一个数字”。因此，我们读取一个数字、一个冒号、一个数字、一个冒号、一个数字和另一个数字（提取器会自动跳过空格）。这两个冒号被读入`char`变量，可以被忽略，或者您可以检查它们是否真的是冒号，以验证输入数据的格式是否正确。

这是该技术的完整可编译演示：

```
#include <iostream>

int main() {
    float hours, minutes, seconds, price;
    char ignore1, ignore2;

    std::cin >> hours >> ignore1 >> minutes >> ignore2 >> seconds >> price;

    std::cout << "H:" << hours 
              << " M:" << minutes 
              << " S:" << seconds 
              << " P:" << price << "\n";
    return 0;
} 
```

当然还有更多的可能性，但至少这些是一些合理的可能性。

* * *

1.  老实说，我不确定我会使用*什么*工作`strtok`，但有些工作我可能至少有点想，或者希望`strtok`没有那么糟糕的设计，所以我可以使用它。但是，在这种情况下，我什至没有太多理由使用类似的东西`strtok`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:29:31.093

`strtok`不以 a`string`作为其论点 - 它以`char*`. 与标头中的所有函数一样，`cstring`它是一个适用于 C 字符串（而不是 C++ 字符串）的 C 函数，通常不应在 C++ 中使用。

请改用字符串类的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:08:44.990

简短的回答是您不能直接使用`std::string`with `strtok`，因为`strtok`需要它可以修改的字符串。即使您使用`c_str()`从 a 获取 C 风格的字符串`std::string`，它仍然是只读的。

如果您真的想使用`strtok`，则需要将字符串复制到可修改的缓冲区中，例如：

`char* str = strdup(input.c_str())`;

如果这样做，请确保`free(str)`在函数末尾调用，否则会导致内存泄漏！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T15:28:27.600

Your simple case can easily be built using the `string::find` method. However, take a look at [Boost.Tokenizer](http://www.boost.org/doc/libs/1_36_0/libs/tokenizer/index.html).

`strtok` will not work with std::string.c_str() because it returns `const char*`. `strtok` does not take a `string` as an argument, but rather a `char*`.

# linux - Slurm：获取帐户限制

> ID：13746865
> 
> 赞同：4
> 
> 时间：2012-12-06T15:25:18.227
> 
> 标签：linux, hpc, slurm

我们的集群使用 SLURM 来管理我们的作业队列。Slurm 正在监控每个帐户使用了多少核心小时数，并将降低从已使用超过分配的核心小时数的帐户提交的作业的优先级。

slurm 中是否有一个命令可以显示我的帐户的这些限制？我想知道在降低优先级之前我可以使用的核心小时数。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-12-11T11:22:06.687

我在 SLURM 授权文件中找到了这个数字。我的位于 /usr/share/slurm/calc-cluster/grantfile

每行是一个 slurm 帐户，核心小时数限制是左起第二个字段，由 分隔：

# django - 美味的，非规则端点

> ID：13746866
> 
> 赞同：1
> 
> 时间：2012-12-06T15:25:21.797
> 
> 标签：django, tastypie

我试图弄清楚为我的 api 创建非 orm 端点是否有意义。我已经看过文档的“将 Tastypie 与非 ORM 数据源一起使用”部分，但我更多地考虑处理表单等。例如：将数据传递到将处理和发送电子邮件的端点。我不会将任何东西保存到数据库中，我只想验证表单并发送它。我是在文档中遗漏了什么，还是我只是在叫错树？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:07:56.937

我认为您可以只在您的函数中定义一个函数`views.py`并处理请求，而无需真正使用tastepie：

这是一个将新用户注册到 Django webapp 的示例；您可能可以通过处理请求中的表单数据来重新利用它来发送电子邮件。

```
# In views.py:
...
from django.http import HttpResponse
from django.contrib.auth.models import User, Group
from django.contrib.auth import authenticate
from django.http import Http404
from django.utils import timezone
from models import *
from api import *
from django.utils import simplejson
...

# REST endpoint for user registration
# Enforces server-side mediation (input validation)
# On failure, raises Http404
# On success, redirects to registration success page
def register_user(request):
    if request.method != 'POST':
        raise Http404('Only POSTs are allowed')

    # acquire params
    username = request.POST['username']
    password = request.POST['password']
    repeatpw = request.POST['repeatpw']
    first_name = request.POST['first_name']
    last_name = request.POST['last_name']

    # Server-side mediation to check for invalid input
    if username == '' or username is None:
        raise Http404('Server-side mediation: Invalid Username')

    if len(username) > 30:
        raise Http404('Server-side mediation: username must be 30 characters or fewer')

    if len(first_name) > 30:
        raise Http404('Server-side mediation: first name must be 30 characters or fewer')

    if len(last_name) > 30:
        raise Http404('Server-side mediation: last name msut be 30 characters or fewer')

    if len(password) < 4:
        raise Http404('Server-side mediation: Password too short')

    if password != repeatpw:
        raise Http404('Server-side mediation: Password Mismatch')

    # This try-except block checks existence of username conflict
    try:
        test_user_exists = User.objects.get(username__exact=username)
        if test_user_exists != None:
            raise Http404('Server-side mediation: Username exists')
    except User.DoesNotExist:
        pass

    # Input passes all tests, proceed with user creation
    user = User.objects.create_user(username, 'default@nomail.com', password)
    group = Group.objects.get(name='Standard')
    user.first_name = first_name
    user.last_name = last_name
    user.groups.add(group)
    user.is_staff = False    
    user.save()

    # Build confirmation JSON
    confirmation = {
            'action': 'register_user',
            'username': username,
            'success': 'yes',
    }

    json_return = simplejson.dumps(confirmation)

    # return JSON of the success confirmation
    return HttpResponse(json_return, mimetype='application/json') 
```

# mysql - Node.js 在 MySQL 查询中崩溃

> ID：13746868
> 
> 赞同：0
> 
> 时间：2012-12-06T15:25:32.807
> 
> 标签：mysql, node.js, express

我需要帮助解决我遇到的这个问题。如果用户名或密码不在数据库中，我有登录脚本会崩溃节点，这里是代码：

```
/* Login */
exports.login = function(req, res){
    var post = req.body;
    var mysql = require('mysql');
    var db = mysql.createConnection({
      host      : 'localhost',
      user      : 'root',
      password  : 'root',
      database  : 'node01',
    });
    var selectStmt = 'SELECT * FROM users WHERE name = "' + post.user +'"';
    db.connect();

    db.query(selectStmt, function(err, rows, fields) {
      if(err) throw err;
      else if(rows[0].name == post.user && rows[0].password == post.password){
        req.session.auth_id = rows[0].id;
        req.session.user = rows[0].name;
        res.redirect('/adminindex');
      }
      else res.redirect('/admin');
    });

    db.end();
}; 
```

和我得到的错误

> *TypeError：无法*
> 在 Query.Sequence.end
> (../node- project01/node_modules/mysql/lib/protocol/sequences/Sequence.js:66:24)
> 在 Query._handleFinalResultPacket (../node-project01/node_modules/mysql/lib/protocol/sequences/Query.js:138:8)
> 在 Query.EofPacket (../node-project01/node_modules/mysql/lib/protocol/sequences/Query.js:122:8)
> 在 Protocol._parsePacket (../node-project01/node_modules/mysql/lib/protocol/ Protocol.js:165:24)
> 在 Parser.write (../node-project01/node_modules/mysql/lib/protocol/Parser.js:60:12)
> 在 Protocol.write (../node-project01/node_modules/ mysql/lib/protocol/Protocol.js:32:16)
> 在 Socket.ondata (stream.js:38:26)
> 在 Socket.EventEmitter.emit (events.js:96:17)
> 在 TCP.onread (net.js:396:14)

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T20:17:57.423

好吧，考虑到你的问题是从 12 月开始的，我想你已经解决了这个问题。但是，您的问题可能是因为您的查询没有结果，然后 'rows[0]' 未定义。在使用 'rows' 变量之前，您始终应该测试是否有任何结果，例如：

```
if (rows.length > 0) {
  // your code here
} 
```

问候，

# cocoa - 带有 IBOutlets 和 IBActions 的 NSView 子类

> ID：13746870
> 
> 赞同：1
> 
> 时间：2012-12-06T15:25:37.570
> 
> 标签：cocoa, interface-builder, nsview

我有一个用于显示自定义对象的 NSView 子类。绘图逻辑都在子类的方法中。没有与此视图关联的视图控制器。

我在 Interface Builder 中的这个视图旁边添加了几个控件，用于控制对象的显示。

将这些控件连接到视图上的`IBOutlet`s 和`IBAction`s 是否可以？我知道这是可能的，但这是糟糕的设计吗？我应该使用 NSViewController 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:28:47.560

不，这完全没问题，这就是事物应该如何连接在一起的方式。没有必要使用 an `NSViewController`，因为它仅有助于管理从`.nib`文件创建视图，并且它仍然只能管理一个视图。

# android - 在android中选择listview的所有复选框

> ID：13746871
> 
> 赞同：1
> 
> 时间：2012-12-06T15:25:37.860
> 
> 标签：android, android-arrayadapter, checkbox

我有用于 listview 的自定义 arrayadapter，其中有 5 个视图，包括复选框，在这里我想实现选择 listview 的所有复选框并取消选择所有复选框，我尝试使用 ,`getchildat()`中的方法，`oncreate()`但`onresume()`也`onpostcreate`没有让我走运。如果您能告诉我解决方案，我将不胜感激。

```
@Override
      public void onPostCreate(Bundle savedInstanceState){
          super.onPostCreate(savedInstanceState);

      Button selectall=(Button) findViewById(R.id.allselect);

      selectall.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            int count = listview.getCount();

            System.out.println("the count is "+count);
            for (int i = 0; i < listview.getLastVisiblePosition() - listview.getFirstVisiblePosition(); i++)  {

                RelativeLayout itemLayout = (RelativeLayout)listview.getChildAt(i);
                CheckBox cb = (CheckBox)itemLayout.findViewById(R.id.chkbx);
                cb.setChecked(true);

            }

        }
    });
  } 
```

阵列适配器类

```
@SuppressWarnings("unchecked")
    public MultipleLeadSyncAdapter(Context context, String[] values,String[] values1,List<Model> qrcode ,String[] values3,String[] values4,String[] values5) {
        super(context, R.layout.multipleselectlist, values1);
        this.context = context;
        this.values = values;
        this.values1 = values1;
        this.list=qrcode;
        this.values3=values3;
        this.values4=values4;
        this.eventid=values5;
    }

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE); 

    ViewHolder holder =null;
    if (convertView == null) {

            convertView = inflater.inflate(R.layout.multipleselectlist, parent, false);

            holder = new ViewHolder();
            holder.textView1 = (TextView) convertView.findViewById(R.id.multileadfirst_name);

            holder.textView3 = (TextView) convertView
                    .findViewById(R.id.multileadcompany_name);

            holder.rate=(RatingBar) convertView.findViewById(R.id.multileadlistrating);

            holder.chkbox = (CheckBox) convertView.findViewById(R.id.chkbx);

            holder.chkbox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

                @Override
                public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                    int getPosition = (Integer) buttonView.getTag();  
                    list.get(getPosition).setSelected(buttonView.isChecked()); 
                }
            });

            convertView.setTag(holder);
            convertView.setTag(R.id.chkbx,holder.chkbox);
            convertView.setTag(R.id.multileadfirst_name,holder.textView1);
            convertView.setTag(R.id.multileadcompany_name,holder.textView3);
            convertView.setTag(R.id.multileadlistrating,holder.rate);

    }else {
        holder = (ViewHolder) convertView.getTag();
    }

     holder = (ViewHolder) convertView.getTag();

    holder.textView1.setText(values[position]);

    if(values3[position].equals(" ")||values3[position].equals("null")||values3[position].equals("")){

    }else{

        String[] temp=values3[position].split(" ");

    }

    holder.textView3.setText(values1[position]);

    holder.rate.setRating(Float.valueOf(values4[position]).floatValue());

    String s = values[position];
    String ss = values1[position];

    System.out.println(s + ss );

    holder.chkbox.setTag(position);

    //holder.textView3.setText(list.get(position).getName());
    holder.chkbox.setChecked(list.get(position).isSelected());
    String igurl=values[position];
    System.out.println("the imagurl is "+igurl);

    return convertView;

}

class ViewHolder {

    String qrcode,Boothid;
    TextView textView1, textView2, textView3,textView4,textView5;
    RatingBar rate;
    ImageView imageView;
    CheckBox chkbox;

    public String getQrcode() {
        return qrcode;
    }

    public void setQrcode(String qrcode) {
        this.qrcode = qrcode;
    }

    public String getBoothID() {
        return Boothid;
    }

    public void setBoothID(String Boothid) {
        this.Boothid = Boothid;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-06T15:43:06.517

A`ListView`只是数据的表示。数据`ListView`由 a 提供`Adapter`。话虽这么说，我可以解释你做错了什么：

在您的内部，`OnClickListener`您正在（取消）检查 a本身。这意味着数据没有被更改，并且表示该数据的 不显示想要的行为。`View``ListView``ListView`

一个简单的解决方案是向您的`Model`-object 添加一个布尔值，以指示检查状态：

```
Model {
   boolean isChecked = false;

   public void setChecked(boolean checked){
        isChecked = checked;
   }

   public boolean isChecked(){
        return isChecked;
   }
} 
```

每当您单击“全选”按钮时，您将简单地切换此布尔值并通知`Adapter`他的数据已使用方法更改`notifyDataSetChanged`。这将轮到他更新`ListView`自身。在伪代码中：

```
 onClick(..) {
     foreach (model inside my adapter){
         model.setChecked(true);
     }
     listview.getAdapter().notifyDataSetChanged()
 } 
```

最后但并非最不重要的一点是，在`getView()`您内部的 -method 中，`Adapter`您可以查看是否`Model`检查了 a 并采取相应措施。

```
getView(...){

   if (listOfModel.get(position).isChecked){
       // do stuff, probably check a CheckBox
   } else {
       // uncheck...
   } 
```

祝你好运！

# python - 如何使用 Python Chameleon 指定 html5 文档类型？

> ID：13746872
> 
> 赞同：3
> 
> 时间：2012-12-06T15:25:41.157
> 
> 标签：python, chameleon, template-metal

我对此进行了彻底的 RTFMed 和 Google 搜索，但我似乎找不到答案。我是变色龙的新手，所以也许它很明显以至于找不到它，但是当我把

`<!DOCTYPE html>`

在我的主模板中，呈现的页面已将其剥离，从而导致可怕的怪癖模式。

有没有我错过的技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T19:28:47.667

弄清楚了。您需要将整个主模板包装在一个金属标签中，如下所示：`<metal:macro metal:define-macro="layout"> <!DOCTYPE html> ... </html></metal:macro>`

# asp.net - 使用 fitBounds 时获取谷歌地图缩放级别

> ID：13746874
> 
> 赞同：0
> 
> 时间：2012-12-06T15:25:49.060
> 
> 标签：asp.net, google-maps

我想获得谷歌地图当前的缩放级别，它给了我未定义的错误，我想是因为我没有在我的地图创建选项中使用显式缩放级别，而是使用 map.fitBounds，当我如何获得谷歌地图缩放级别时正在使用 map.fitBounds？

这是我的代码摘要：

```
var mapOptions = { mapTypeId: google.maps.MapTypeId.ROADMAP };

map =  new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

map.fitBounds(bounds);
map.panToBounds(bounds); 
```

现在，当我想使用 map.getZoom() 时，我得到了未定义，似乎 getZoom 只返回显式设置的缩放级别

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:38:58.423

Google Maps API v3 是基于事件的。当新的缩放级别可供查询时，将触发 zoom_changed 事件。

要获得新的缩放，请执行以下操作：

```
google.maps.event.addListener(map, "zoom_changed", function() {
  alert("the zoom level is now "+map.getZoom());
}); 
```

请注意，每次更改缩放时都会触发。

# linux - linux编写系统调用和libc

> ID：13746879
> 
> 赞同：0
> 
> 时间：2012-12-06T15:26:08.263
> 
> 标签：linux, system-calls, libc

在 linux 中，'write' 是一个小的系统调用 wapper 函数。

在 GDB 中。如果我搜索符号“写入”（信息地址写入），GDB 会告诉我一个在 libc 范围内的地址。但是，当我检查 libc 的导出函数列表时，没有“写”符号。

这里发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:12:38.163

> 当我检查 libc 的导出函数列表时，没有“写”符号。

我们来看一下：

```
[max@xxx:~/tmp] $ nm --dynamic --defined-only /lib64/libc-2.15.so | grep write
0000003c7a4f1990 T eventfd_write
0000003c7a46c540 W fwrite
0000003c7a475570 T fwrite_unlocked
0000003c7a476d50 T _IO_do_write
0000003c7a475fa0 T _IO_file_write
0000003c7a46c540 T _IO_fwrite
0000003c7a471d10 T _IO_wdo_write
0000003c7a4e3060 T __libc_pwrite
0000003c7a4f2310 T process_vm_writev
0000003c7a4e3060 W pwrite
0000003c7a4e3060 W pwrite64
0000003c7a4e3060 W __pwrite64
0000003c7a4ea520 T pwritev
0000003c7a4ea520 T pwritev64
0000003c7a4e4940 W write
0000003c7a4e4940 W __write
0000003c7a4ea3d0 W writev 
```

# java - 使 JTree 叶显示为空目录而不是文件

> ID：13746880
> 
> 赞同：3
> 
> 时间：2012-12-06T15:26:10.473
> 
> 标签：java, swing, jtree

我正在学习围绕 Java JTree 的方法，但我有一个我无法弄清楚的小问题。使用我在 Oracle 网站上找到的教程，我模仿了他们演示的树结构。问题是，我希望文件夹“网站”是一个空文件夹，但 JTree 将它显示为好像它是一个文件。我如何告诉 JTree “网站”实际上是一个空文件夹？

**更新**

我已经开始研究一个简单的“联系人管理器”。我想要做的基本上是使名称看起来像文件夹（因为我想为每个文件夹添加信息），但不添加任何内容。即有些可能没有任何信息，但我仍然希望它们看起来像文件夹。

![在此处输入图像描述](../Images/ff335a9107642a030b02db05561a4a8f.png)

浏览器类的代码：

```
import java.awt.Component;
import java.io.File;
import java.util.Iterator;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTree;
import javax.swing.tree.DefaultMutableTreeNode;

public class Browser extends JFrame implements javax.swing.tree.TreeModel {

    private JTree tree;
    ManagerOfContacts mngrOfContacts;

    public Browser() {

        //Generates the ManagerOfContacts and associated Contacts
        Driver driver = new Driver();
        mngrOfContacts = driver.getManagerOfContacts();
        //---------------------------\\

        DefaultMutableTreeNode contacts = new DefaultMutableTreeNode("Contacts");
        createNodes(contacts);
        tree = new JTree(contacts);

        JScrollPane treeView = new JScrollPane(tree);

        add(treeView);

        setSize(400,400);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setVisible(true);
    }

    public void createNodes(DefaultMutableTreeNode top){
        DefaultMutableTreeNode contactName;

        Iterator<Contact> contactItr = mngrOfContacts.getIterator();
        while(contactItr.hasNext()){
            contactName = new DefaultMutableTreeNode(contactItr.next());
            top.add(contactName);
        }
    }

    public static void main(String[] args) {
        Browser browsr = new Browser();
    }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T15:32:21.270

配置treeModel查询其节点的askAllowsChildren属性，判断是否应视为文件夹（即使没有子节点）

```
DefaultMutableTreeNode root = new DefaultMutableTreeNode("I'm the root");
// node allowsChildren - that's the default 
root.add(new DefaultMutableTreeNode("folder always"));
// node doesn't accept children
root.add(new DefaultMutableTreeNode("folder never", false));
// model configured to query the node's allowsChildren property
DefaultTreeModel model = new DefaultTreeModel(root, true); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-07T09:39:57.617

这就是您创建自己的方式的`TreeCellRenderer`方式，它告诉您`JTree`您想要的任何内容。由于您使用的是带有`DefaultMutableTreeNode`节点的默认树模型，因此您必须提取其用户对象并根据该对象决定要绘制的内容。请注意，默认渲染器只是一个扩展的`JLabel`，这就是为什么您可以在其中使用`setIcon(...)`,`setText(...)`等。

您的叶节点使用文件图标绘制的原因可能是默认渲染器根据`DefaultMutableTreeNode.getAllowsChildren()`类似于我使用的方式选择图标`Contact.isSomeProperty()`。

```
import java.awt.Component;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTree;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeCellRenderer;

public class Browser extends JFrame {

    private JTree tree;
    //ManagerOfContacts mngrOfContacts;

    public Browser() {

        //Generates the ManagerOfContacts and associated Contacts
        //Driver driver = new Driver();
        //mngrOfContacts = driver.getManagerOfContacts();
        //---------------------------\\

        DefaultMutableTreeNode contacts = new DefaultMutableTreeNode("Contacts");
        createNodes(contacts);
        tree = new JTree(contacts);

        // use your own renderer (!)
        tree.setCellRenderer(new MyTreeCellRenderer());

        JScrollPane treeView = new JScrollPane(tree);

        add(treeView);

        setSize(400,400);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setVisible(true);
    }

    public final void createNodes(DefaultMutableTreeNode top){
        DefaultMutableTreeNode contactName;

        // dummies
        List<Contact> contacts = new ArrayList<Contact>();
        contacts.add(new Contact("Me", true));
        contacts.add(new Contact("You"));

        Iterator<Contact> contactItr = contacts.iterator();
        while(contactItr.hasNext()){
            contactName = new DefaultMutableTreeNode(contactItr.next());
            top.add(contactName);
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                Browser browsr = new Browser();
            }
        });

    }

    // dummy
    private static class Contact {

        private boolean someProperty;
        private String name;

        public Contact(String name) {
            this(name, false);
        }

        public Contact(String name, boolean property) {
            this.someProperty = property;
            this.name = name;
        }

        public boolean isSomeProperty() {
            return someProperty;
        }

        public String getName() {
            return name;
        }

        @Override
        public String toString() {
            return name;
        }
    }

    // this is what you want
    private static class MyTreeCellRenderer extends DefaultTreeCellRenderer {

        @Override
        public Component getTreeCellRendererComponent(JTree tree, Object value, boolean sel, boolean expanded, boolean leaf, int row, boolean hasFocus) {
            super.getTreeCellRendererComponent(tree, value, sel, expanded, leaf, row, hasFocus);

            // decide what icons you want by examining the node
            if (value instanceof DefaultMutableTreeNode) {
                DefaultMutableTreeNode node = (DefaultMutableTreeNode) value;
                if (node.getUserObject() instanceof String) {
                    // your root node, since you just put a String as a user obj                    
                    setIcon(UIManager.getIcon("FileView.computerIcon"));
                } else if (node.getUserObject() instanceof Contact) {
                    // decide based on some property of your Contact obj
                    Contact contact = (Contact)  node.getUserObject();
                    if (contact.isSomeProperty()) {
                        setIcon(UIManager.getIcon("FileView.hardDriveIcon"));
                    } else {
                        setIcon(UIManager.getIcon("FileChooser.homeFolderIcon"));
                    }
                }
            }

            return this;
        }

    }
} 
```

这应该让你开始。[您应该在JTree 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)中阅读更多相关信息。

# c# - HTML 页面抓取

> ID：13746882
> 
> 赞同：3
> 
> 时间：2012-12-06T15:26:13.813
> 
> 标签：c#, html, ajax, screen-scraping

抓取具有 AJAX/动态加载数据的网页的最佳方法是什么？

例如：抓取一个加载时显示 20 张图像的网页，但当用户向下滚动页面时，它会加载更多图像（有点像 Facebook）。在这种情况下，您如何抓取所有图像，而不仅仅是前 20 个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:29:48.173

使用诸如[Fiddler](http://www.fiddler2.com/fiddler2/)或[WireShark](http://www.wireshark.org/)之类的工具来检查加载更多项目时完成的 Web 请求。

然后在您的代码中复制请求。

* * *

**更新（感谢[pguardiario ofr](https://stackoverflow.com/users/966023/pguardiario)他的评论）：**

请注意，Wireshark 是一个低级别的网络捕获工具，它提供了大量有关流量的详细信息（正在交换的数据包、DNS 查找等），并且在您只想查看HTTP 请求。

因此，您最好在浏览器中使用 Fiddler 或类似工具（例如：Chrome 的网络检查面板）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T15:51:35.693

这是连主要搜索引擎都没有掌握的东西。它被称为“[事件驱动爬取](http://www.net-security.org/dl/articles/Crawling_Ajax_driven_Web_2.0.pdf)”。

谷歌甚至有一个指南来[帮助他们更好地抓取你的 ajax 网站](https://developers.google.com/webmasters/ajax-crawling/)

最好的办法是阅读一些[开源爬虫](http://en.wikipedia.org/wiki/Web_crawler#Open-source_crawlers)，看看他们做了什么。但是你爬到 80% 的机会充其量是微乎其微的，除非你有一个特定的目标。

[在crawljax](http://crawljax.com/documentation/publications/)上也有一些有趣的读物

基本上，您应该尝试查找脚本并检查它们是否进行任何 ajax 调用，然后确定它们采用哪种参数并使用递增/递减的参数值进行重复调用。这仅在参数具有逻辑模式（例如数字、单个字母等）时才有效。它还取决于您是针对已知站点还是只是将其发送到野外。如果您知道您的目标，您可以检查它的 DOM 并自定义您的代码以获得更高的准确性，如 wolf 所述。

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T21:20:25.017

[Crawljax](http://crawljax.com)是开源的，可以动态地抓取基于 Ajax 的内容。

# linux - Linux 上缓存和缓冲内存的区别

> ID：13746883
> 
> 赞同：0
> 
> 时间：2012-12-06T15:26:15.623
> 
> 标签：linux, memory

> **可能重复：**
> [Linux内存：缓冲区与缓存](https://stackoverflow.com/questions/6345020/linux-memory-buffer-vs-cache)

当使用 ps/free 之类的命令监视 Linux 机器上的内存时，我们可以看到一个称为缓冲内存的统计数据和另一个称为缓存内存的统计数据。我已经搜索了互联网，但找不到一致的答案来解决他们的差异。感谢是否有人可以给我任何提示。

BTW：我正在调试程序的内存使用模式，所以理解这些概念对我的开发很有用。

提前谢谢， 林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:03:43.680

缓冲区是 I/O 缓冲区，而缓存是页面缓存。

# xml - eXist DB & XQuery：带有属性的 xml-root 导致没有结果

> ID：13746884
> 
> 赞同：3
> 
> 时间：2012-12-06T15:26:15.853
> 
> 标签：xml, xquery, exist-db

我对 eXist DB 和 XQuery 都是全新的。我已经安装了 eXist，它工作正常。现在我尝试在作为 eXist Admin 客户端一部分的 eXist 查询对话框中使用 XQuery 查询一些 xml 文件。xml 文件如下所示（从 Oxford Text Archive 下载）：

```
<TEI xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
    <fileDesc>
    <titleStmt>
    <title>THE Taming of the Shrew.</title>
    <author>Shakespeare, William, 1564-1616</author>
    </titleStmt>
    <publicationStmt>
    <distributor>
...
</TEI> 
```

我的基本 XQuery 如下所示：

```
doc('/db/myCollection/taming.xml')//teiHeader 
```

这不会带来任何结果（“找到 0 个项目”）。为什么？我摆弄了一下，发现如果我从 TEI 元素中删除属性“xmlns”，那么查询就可以完美运行。如何更改我的查询以便不必删除该属性？是什么导致了这个属性的问题？

感谢任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T18:59:14.343

您在该 XML 实例中有一个默认命名空间。尝试：

```
doc('/db/myCollection/taming.xml')//*:teiHeader 
```

# android - 从 Android 应用程序控制 VLC 上的流式传输

> ID：13746887
> 
> 赞同：3
> 
> 时间：2012-12-06T15:26:23.360
> 
> 标签：android, streaming, video-streaming, vlc

我正在使用 VLC 在我的服务器（Windows）上进行流式传输。我想在我的 android 应用程序中集成一个用于远程管理流式传输（例如停止/启动流式传输）的控件。类似于应用程序完成的事情：VLC Remote [http://maketecheasier.com/remote-control-vlc-with-android-phone/2010/08/06](http://maketecheasier.com/remote-control-vlc-with-android-phone/2010/08/06)

如何在我的应用程序中实现 VLC 遥控器之类的功能？

# .net - Sharepoint 2010 克隆整个 Web 应用程序

> ID：13746888
> 
> 赞同：0
> 
> 时间：2012-12-06T15:26:27.180
> 
> 标签：.net, sharepoint, sharepoint-2010, clone, sitecollection

我刚刚接手了一个只在单一实时环境中工作的 Sharepoint 开发人员。

我想设置一个开发环境（以及随后的 UAT 环境），因此我需要一个实时版本的精确（或尽可能接近精确）克隆，包括所有网站集、内容和（理想情况下）权限.

我在 Google 上搜索过，发现您可以使用命令行管理程序备份和恢复单个网站集，但单独执行每个集合将非常耗时。

谁能建议一种可靠的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:09:58.817

为什么不直接编写脚本呢？这是我使用的一个小脚本：

```
[System.Console]::Clear()

write-host "remoting to live environment"

$siteCollectionUrl = "http://live.mysite.com";

if ($args.count -gt 0) {
   $siteCollectionUrl = $args[0]
   write-host "going to pullback content from $siteCollectionUrl"
}

$pwd = Get-Content c:\install\backups\crd-sharepoint.txt | ConvertTo-SecureString

$crd=new-object -typename System.Management.Automation.PSCredential -ArgumentList "dev\svc-sp-setup-dvt", $pwd

$s = New-PSSession -computername "liveServer" -Authentication CredSSP -Credential $crd

Invoke-Command -Session $s -Scriptblock {
param($siteCollectionUrl)
write-host "Connected, activating SharePoint snap-in..."
Add-PSSnapin Microsoft.SharePoint.Powershell -ErrorAction "SilentlyContinue"

write-host "Backing up $siteCollectionUrl remotely..."
backup-spsite -identity "$siteCollectionUrl" -path "c:\install\backups\scheduled_backup.bak" -force
} -args $siteCollectionUrl
#end session
Remove-PSSession $s

$path = "c:\install\backups\"
write-host "Copy backup locally..."
#copy
copy-item "\\liveServer\c$\install\backups\scheduled_backup.bak" $path -Force

write-host "restore...this may take a while if not already running in SharePoint PowerShell.  your patience is appreciated"
#restore
Add-PSSnapin Microsoft.SharePoint.PowerShell -ErrorAction "SilentlyContinue"

restore-spsite -identity "$siteCollectionUrl" -path c:\install\backups\scheduled_backup.bak -force -confirm:$false

$username = [Environment]::UserName

write-host "have a great day, $username" 
```

这确实需要启用 PowerShell 远程处理。如果您有一个站点列表，您可以简单地使用您想要复制的站点集合的 URL 重复调用此脚本，例如

```
$scriptPath = Join-Path (get-location) "backup_and_restore.ps1";
& $scriptPath "http://admin.accounting.mycompany.com"
& $scriptPath "http://admin.sales.mycompany.com"
& $scriptPath "http://admin.marketing.mycompany.com"
& $scriptPath "http://admin.engineering.mycompany.com" 
```

或者，您可以在脚本中为每个网站集创建一个备份，然后以实物形式恢复它们。这将大大提高效率，因为您不必重新启动 SharePoint 管理单元，但我将由您来决定哪种方式最适合您的情况。

# ajax - 选择不处理来自 AJAX 调用的元素

> ID：13746889
> 
> 赞同：1
> 
> 时间：2012-12-06T15:26:28.657
> 
> 标签：ajax, jquery-chosen

我有一个表单，它使用 AJAX 调用根据选择框中的选择填充 div 元素。

填充的 div 的内容是我希望选择应用的多选框。不幸的是，'chzn-select' 似乎没有触发，这无疑是因为它被动态拉入。

我已经添加了这个：

```
 <script type="text/javascript">
    $(".chzn-select").chosen();
    </script> 
```

到由 AJAX 拉入的代码的底部，但它仍然没有触发。关于如何根据需要进行这项工作的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T15:49:17.737

自己解决了。将发布以供将来参考。我将 Chosen 调用放在调用 AJAX 的原始页面上的自己的函数中：

```
 <script type="text/javascript">
    function doChosen() {
        $(".chzn-select").chosen();
        $(".chzn-select-deselect").chosen({allow_single_deselect:true});
    }
    </script> 
```

在 AJAX 脚本本身中，我在 responseText 部分之后添加了对该函数的调用：

```
 document.getElementById(div).innerHTML=oXmlHttp.responseText
    doChosen(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:34:21.327

尝试使用 change() 方法，而不是使用 selected()。它适用于更改事件。尝试：

```
$(".chzn-select").change(function () {
          var str = "";
          $("select option:selected").each(function () {
                // do your coding here
              });

        })
        .trigger('change'); 
```

# oracle11g - Oracle - 数据库状态保存然后恢复

> ID：13746890
> 
> 赞同：0
> 
> 时间：2012-12-06T15:26:36.403
> 
> 标签：oracle11g, snapshot

我目前正在将一些代码从 big-endian 移植到与 Oracle 数据库交互的 little-endian 系统 (Linux x86_64)。

我试图确保数据不会因为字节序差异、类型更改（64 位拱门中的长为 8 个字节）等而混乱。不幸的是，我只有一个数据库。

所以当我想比较旧代码和新代码的输出时，我不能，因为它们连接到同一个数据库！

我不是 Oracle 人，所以我正在寻找一些可以按顺序排列的解决方案：

1.  要求 Oracle 记住某个时间点的数据库状态（数百万条记录）。
2.  运行大端代码。
3.  对于每个表中的每一列，收集平均、最大值、最小值、标准差等统计数据。
4.  要求 Oracle 恢复到已保存状态。
5.  运行小端代码。
6.  对于每个表中的每一列，收集平均、最大值、最小值、标准差等统计数据。

然后比较 3 和 6 的数据。

当然，这不如逐行比较好，但考虑到数据量，这似乎是一个可以接受的解决方案。

在没有太多资源利用的情况下，这在 Oracle 中是否可行（例如添加新磁盘，因为那是很多繁文缛节并且需要太多时间）。

谢谢！

# jbpm - Saving a new jbpm process in guvnor causes it to be lost

> ID：13746892
> 
> 赞同：0
> 
> 时间：2012-12-06T15:26:47.180
> 
> 标签：jbpm, drools-guvnor

Using jbpm designer 2.4 in Guvnor 5.5.0\. I create a new JBPM 2.0 diagram, edit it, and then when I try to save it, it says "Saving" then "Refreshing Package Data", then something else, and then my diagram disappears. I bet it's some kind of config issue. Does anyone know what I could be doing wrong? I am hosting the two in Jboss AS7 with all the defaults, except guvnor is running under

```
> http://localhost:8080/guvnor 
```

instead of

```
> http://localhost:8080/drools-guvnor 
```

Thanks! Yuri

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:20:09.707

您是否使用来自 guvnor 的新 URL 更新了设计器配置文件，如此处所述？ [http://docs.jboss.org/jbpm/v5.4/userguide/ch.designer.html#d0e4389](http://docs.jboss.org/jbpm/v5.4/userguide/ch.designer.html#d0e4389)

克里斯

# javascript - Newly appended objects don't respond to jQuery events from page load

> ID：13746894
> 
> 赞同：0
> 
> 时间：2012-12-06T15:26:48.690
> 
> 标签：javascript, jquery

I am using Backbone here, but I've also experienced this issue with non-Backbone sites as well.

Essentially, my issue is that I define in one javascript file, base.js, a number of 'global' jquery functions. Then, I load new elements and append them to the page using Backbone, AJAX, or whichever asynchronous call you like. This works great, except the new objects don't seem to be linked to the jQuery events I declared on pageload. (Sorry for the layman language here - often I am a newbie at proper wording)

For example, let's say I declare in a js file loaded on pageload:

```
 $('.element').hover(function(){alert('hi world')}); 
```

But then I append a new element after pageload, then this hover won't work.

Can anyone explain:

1.  Why this is?
2.  Whether I can force a new appended element to work with/listen to current events already declared?

I suspect (2) may not be possible (that I have to rewrite the events after appending), but am interested to know if there is some sort of solution.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T15:30:34.587

> 这是为什么？

因为当事件绑定代码被执行时，DOM中已经不存在的元素不会受到影响（它们怎么可能呢？它们还不存在！）“正常”的事件绑定方法（例如`.click()`or `.change()`）将附加一个将事件处理函数复制到匹配集中的每个元素。

> 我可以强制一个新的附加元素使用/收听已经声明的当前事件吗？

您确实可以通过将事件处理程序*委托给 DOM 树的更高层。*由于大多数 DOM 事件从它们起源的元素开始在树中冒泡，因此效果很好。使用 jQuery，您可以使用[`.on()`](http://api.jquery.com/on/)(jQuery 1.7+ - 用于旧版本[`.delegate()`](http://api.jquery.com/delegate/)) 方法来执行此操作：

```
$("#someCommonAncestor").on("someEvent", ".element", function () {
    // Do stuff
}); 
```

在代码运行时，您调用的元素`.on()`必须存在于 DOM 中。当事件冒泡足够远以达到任何`#someCommonAncestor`可能时，jQuery 将检查目标元素是否与您传递给的选择器匹配`.on()`。如果是，它将执行事件处理程序。如果没有，该事件将继续冒泡到文档的根目录，并且不会触发任何处理程序。

# mysql - Automating A MySql 5.0 query on Windows

> ID：13746903
> 
> 赞同：1
> 
> 时间：2012-12-06T15:27:10.607
> 
> 标签：mysql, automation, windows-server-2008

Good morning! I am currently searching for a way to automate the running of a MySQL 5.0 Query. I discovered that 5.0 does not contain Event_Scheduler which I wish it did.

My questions is besides event scheduler how can I automatically run a query (i plan to have the query output a CSV file) every 12 hours or so?

I have seen several examples of Unix, Linux based processes, but have yet to see an example for Windows (Server 2008).

# android - How can i use the Check Boxes with ListView and Insert the values in Sqlite Database in android

> ID：13746905
> 
> 赞同：1
> 
> 时间：2012-12-06T15:27:10.063
> 
> 标签：android, listview, checkbox, android-cursoradapter

I'm developing an android app which shows phone contact as ListView(used Cursoradapter).Now I Want to add checkbox to the listView ,My problem is How to Insert checkbox data into database, based on if it is checked or not?

In my database class, I have a function which use to add names and numbers to my database,

```
 createntry(String number,String name) // in my database class 
```

Should I invoke this function in my CursorAdapter class ?

Recently, I found out that I should use getView function,but unfortunately I have no idea about getView, My question are

1-I should use this function in My CursorAdapter or else?

2- how to implement this function?

My CursorAdapterClass

```
 public class ContactCursorAdapterCT extends CursorAdapter {

         public ContactCursorAdapterCT(Context context, Cursor c) {
    super(context, c);
    }   
}

@Override
public void bindView(View view, Context context, Cursor cursor) {
      TextView name = (TextView)view.findViewById(R.id.contactlistTV1);      
          name.setText(cursor.getString
          (cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME)));
          TextView phone = (TextView)view.findViewById(R.id.contactlistTV2);                
           phone.setText(cursor.getString          
          (cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER)));
}

@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) { 
    LayoutInflater inflater = LayoutInflater.from(context);
    View v = inflater.inflate(R.layout.lvct, parent, false);
            bindView(v, context, cursor);
    return v;

}

public View getView(final int pos, View inView, ViewGroup parent) { //getView 

    } 
```

My activity class

```
 public class Contacts extends Activity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.contacts);

    Cursor cursor = getContentResolver().query
            (ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null, null,null, null);
        startManagingCursor(cursor);
           ContactCursorAdapterCT adapter= new ContactCursorAdapterCT
           (Contacts.this, cursor);
       ListView contactLV = (ListView) findViewById(R.id.listviewblcontactsDB);
           contactLV.setAdapter(adapter); 
```

My database Class

```
 public long creatEntry(String inputnumber , String name) { // for add data   

    // TODO Auto-generated method stub
    ContentValues cv= new ContentValues();
    cv.put(KEY_NUMBER, inputnumber);
    cv.put(N_NAME, name);
    Log.v(inputnumber, "adding to Database");
    return ourdatabase.insert(DATABASE_TABLE, null, cv);
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T12:04:35.917

首先，不，你不需要`getView`. `bindView`结合 with`newView`完全可以替代它，有些人可能会说更好。此外，您不需要在新视图中调用 bindview。这是对应该存在的内容的重组。

```
 @Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) { 
        View v = inflater.inflate(R.layout.lvct, parent, false);
        return v;
    } 
```

这完全是您的电话，但不，我不认为您应该将您的`createEntry`方法放入适配器中，至少在其方法中。问题是适配器中的方法会为您的列表视图的每一行调用，因此您可能会冗余地发生很多事情，而且我个人认为以增量方式插入数据库是浪费的。相反，我认为您*别无选择*，只能一次完成所有操作，因为如果有人取消选中复选框怎么办？你删除你的条目？不仅浪费，而且跟踪光标位置也太麻烦，或者`_id`每次添加某些内容时都需要重新查询。您应该做的是维护需要添加到数据库中的内容的列表，并在完成后将其批量插入。

首先，您需要创建一个对象来保存您要插入的数据。对象是最干净的方式，因为您需要保存多条信息。这里非常简单，将所需的值插入构造函数，然后使用 getter 方法检索。

```
public class ContactObject {

    private String name;
    private String phone;

    public ContactObject(String name, String phone) {
        super();
        this.name = name;
        this.phone = phone;
    }

    public String getName() {
        return name;
    }

    public String getPhone() {
        return phone;
    }
} 
```

现在，您需要一个对象来在检查这些对象时保存它们。我知道这很奇怪，但是如果它们被识别出来并且可以被迭代并且通常被批处理在一起以供参考，那就更方便了。我认为这类任务需要`HashMap`. 在构造函数中进行。

```
contactMap = new HashMap<Integer, ContactObject>(c.getCount()); 
```

现在是布吉的时候了。为复选框制作方法以从`HashMap`.

```
cbInsert.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    if (cbInsert.isChecked()) {
                        contactMap.put(cursor.getPosition(), new ContactObject(str_name, str_phone));
                    } else {
                        contactMap.remove(cursor.getPosition());
                    }
                }
            }); 
```

我们将光标位置用作对象的 id`HashMap`. 当我们的复选框未选中并且我们想要删除放入的对象时，我们可以引用我们使用的那个标识符。更谨慎的人可能想在移除之前检查该位置是否有东西，这由您自行决定。现在我们差不多完成了。我们如何将我们的 HashMap 转换为数据库中的条目？您必须访问一个数据库对象，循环然后逐个获取您的对象。现在的问题是在哪里。您可以在适配器中正确执行此操作，但我通常在我的活动中执行此类操作，因为在我的情况下，我通常已经为其他任务的活动创建了一个数据库，并且我不喜欢制作比我更多的对象推到。所以，我们可以做的是在我们的适配器中为我们的 HashMap 完成一个 getter 方法：

```
 public HashMap<Integer, ContactObject> getContactMap() {
        return contactMap;
    } 
```

现在我想当你的应用程序离开时你会做这样的事情，所以就这样吧。

```
@Override
protected void onDestroy() {
    super.onDestroy();
    HashMap<Integer, ContactObject> contactMap = adapter.getContactMap();
    DatabaseHelper db = new DatabaseHelper(this);
    // iterate through hashmap
    for (Map.Entry<Integer, ContactObject> entry : contactMap.entrySet()) {
        Integer key = entry.getKey();
        ContactObject value = entry.getValue();

        db.creatEntry(key, value.getPhone(), value.getName());
    }
    db.close();
} 
```

现在事情看起来有点奇怪，我对你的进入方法做了什么？

```
public long creatEntry(Integer id, String inputnumber, String name) { // for add data
        long lng;
        String strId = id.toString();
        String[] selectionArgs = {strId};
        Cursor cursor = ourdatabase.query(DATABASE_TABLE, null, "other_id = ?", selectionArgs, null, null, null);
        if (cursor.moveToFirst()) {
            // it exists, i'd assume that you might not want anything else done here
            lng = -1;
        } else {
            // it doesn't exist
            ContentValues cv= new ContentValues();
            cv.put(KEY_NUMBER, inputnumber);
            cv.put(N_NAME, name);
            cv.put(KEY_OTHERID, strId);
            Log.v(inputnumber, "adding to Database");  
            lng = ourdatabase.insert(DATABASE_TABLE, null, cv);
        }
//      cursor.close();
        return lng;
    } 
```

如您所见，我对其进行了修改，以便它也可以使用 id。我认为您遇到的一个问题是您的数据库中有重复。我认为您可以通过为可以修改的 id 设置*另一个*字段来管理它。这个 id 是指从`HashMap`. 我认为每次您进行插入时，您首先检查之前的 id 是否存在，然后决定您想要做什么。这不是一个完美的解决方案，但我只是想提醒您该问题是可能的，并给出管理它的可能提示。一般来说，如果您只想插入几行，插入方法应该没问题，但如果您有很多东西要插入，您可能想研究**批量事务**以提高性能。

还有一件事，不能期望您的列表视图中的复选框的状态会像您通常期望的那样持续存在。您必须明确规定复选框在每个位置的状态。如果您`HashMap`的某些内容填充了相应的键，我将其对应。这是完整的适配器方法，希望它更清楚：

```
public class ContactCursorAdapterCT extends CursorAdapter {

        private LayoutInflater inflater;
        private HashMap<Integer, ContactObject> contactMap;

        public ContactCursorAdapterCT(Context context, Cursor c) {
            super(context, c);
            inflater = LayoutInflater.from(context);
            contactMap = new HashMap<Integer, ContactObject>(c.getCount());
            // i used c.getCount() as a capacity limit for this.
            // if you opened made this multiple times, it might get over inflated and 
            // slow things down.
        }   

        @Override
        public void bindView(View view, Context context, final Cursor cursor) {
            TextView name = (TextView)view.findViewById(R.id.contactlistTV1);
            TextView phone = (TextView)view.findViewById(R.id.contactlistTV2);
            final CheckBox cbInsert = (CheckBox) view.findViewById(R.id.contactlistCB1);

            String str_name = cursor.getString
                    (cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
            String str_phone = cursor.getString          
                    (cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));

            name.setText(str_name);
            phone.setText(str_phone);

            boolean isFilled = contactMap.containsKey(cursor.getPosition());
            cbInsert.setChecked(isFilled);

            // insert, remove objects to hashmap
            cbInsert.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    if (cbInsert.isChecked()) {
                        contactMap.put(cursor.getPosition(), new ContactObject(str_name, str_phone));
                    } else {
                        contactMap.remove(cursor.getPosition());
                    }
                }
            });         

        }

        @Override
        public View newView(Context context, Cursor cursor, ViewGroup parent) { 
            View v = inflater.inflate(R.layout.lvct, parent, false);
            return v;
        }

        public HashMap<Integer, ContactObject> getContactMap() {
            return contactMap;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:50:30.103

最好在您的记录中添加一个标志，以指示它们是否已被检查。这意味着一个条目将有一个名称、一个数字和一个标志（选中/未选中）。

在您`Adapter`自己中，您可以检查此标志的值并采取相应的行动。

（一个相关的答案是关于[这里](https://stackoverflow.com/a/13747201/1479570)`ListView`给出的复选框）

# javascript - 在 jQuery 验证自定义规则中自定义消息

> ID：13746906
> 
> 赞同：0
> 
> 时间：2012-12-06T15:27:15.600
> 
> 标签：javascript, jquery, forms, jquery-validate, validation

我有一个名为的自定义 jQuery 验证规则`fiftyCents()`，其中有两个规则：

1.  如果该项目是免费的，人们可以以 0.00 美元的价格“购买”它，或者他们可以支付超过 0.50 美元。
2.  如果该项目**不是**免费的，那么他们必须至少支付指定的费用（存储在隐藏的`cachedValue`输入字段中）。

所以这是我的两个验证错误消息。我在添加这些时遇到的问题`fiftyCents()`是，我只能弄清楚如何将其评估为真/假，如果为假，则显示一条消息，例如`"Amount must be $0.00 OR greater than $0.50."`.

[JSfiddle](http://jsfiddle.net/trpeters1/Yshwq/10/) （下面的代码）的解决方案似乎是制作一个`message`可以成为`fiftyCents()`函数一部分的对象。但是，我不知道如何`return`评估`true/false`. 想法？

JS：

```
$('button').click(function(){
  $('form').validate().form();
});
$.validator.addMethod("fiftyCents", function(value) {

  var cachedValue=$('.purchaseModalAmtPaidCached').val();
  var value = $('.purchaseModalAmtPaid').val();
  var message="Amount must be $0.00 OR greater than $0.50.";
  if(cachedValue>0) message='Amount must be at least'+cachedValue+'.';
  return cachedValue<=value && (value==0 || (0.51<=value && value<=10000));
}, message);   

$.validator.classRuleSettings.purchaseModalAmtPaid = { fiftyCents: true }; 
```

HTML：

```
 <form>
  <input  class="purchaseModalPassword required" minlength="8" type="password"name="password" value="dddddddv" title="Please enter a valid password"  />
  <input type="text"  title="Amount must be $0.00 OR greater than $0.50" 
  class="required purchaseModalAmtPaid" name="amt_paid" value="" />
  <input type="hidden" class='purchaseModalAmtPaidCached required' name="AmtPaidCached" value="0.00" /> 
  <button type='button'>Buy</button>
 </form>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T20:08:04.510

好的，我回答了我自己的问题。我最终做的是将这两个规则拆分为它们自己的自定义方法。在调用任一自定义方法之前，我使用了一个`if/else`来确定应该遵循两者中的哪一个。

这是[JSFiddle](http://jsfiddle.net/trpeters1/Yshwq/26/)和下面的代码：

JS：

```
$('button').click(function(){
$('form').validate().form(); 
```

});

```
var params=$('.purchaseModalAmtPaidCached').val();                   
if(params>0){      
  $.validator.addMethod("AmountOrGreater", function(value, element, params) {
  console.log('amountOrGreater'+params[0]); 
  return params[0]<=value && (value==0 || (0.51<=value && value<=10000));
  }, $.validator.format("Amount must be at least {0}."));
  $.validator.classRuleSettings.purchaseModalAmtPaid = { AmountOrGreater: params };                       
} 
else{ 
  $.validator.addMethod("fiftyCents", function(value, element, params) {
  console.log('fiftyCents'+params[0]);
  return params[0]<=value && (value==0 || (0.51<=value && value<=10000));
  }, "Amount must be $0.00 OR greater than $0.50.");  
  $.validator.classRuleSettings.purchaseModalAmtPaid = { fiftyCents: params };  
} //else 
```

HTML：

```
 <form>
  <input  class="purchaseModalPassword required" minlength="8" type="password" name="password" value="dddddddv" title="Please enter a valid password"  />
  <input type="text"   
class="required purchaseModalAmtPaid" name="amt_paid" value=""  /> 
  <input type="hidden" class='purchaseModalAmtPaidCached required' name="AmtPaidCached" value="0.00" /> 
  <button type='button'>Buy</button>
</form>​ 
```

**注意：** HTML 与 jQuery validate 合作的一个关键是，如果您为输入提供一个`title=''`属性，那么将始终使用该标题，从而覆盖您自定义规则中的消息。这在我的情况下是相关的 b/c 有两个自定义规则/消息，我无法在呈现 HTML 之前确定用户会看到哪一个。

# android - Android : modifying Bluetooth configuration from code

> ID：13746910
> 
> 赞同：1
> 
> 时间：2012-12-06T15:27:22.667
> 
> 标签：android, android-intent, configuration, bluetooth, visibility

I would like to know if there's a way to modify Android configuration with my app (with appropriate right in manifest).

My problem is to put Bluetooth visibility to "always" (in Params -> BlueTooth -> Visibility delay -> Always). The code "Intent.putExtra(BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION, 0);" is locked by the default configuration in Android. If the user choose "2 min" in Android, the previous code will unlock visibility for only 2 minutes...

Any clue?

# html - Is there a way for a to take up full height and all available horizontal space without absolute positioning?

> ID：13746911
> 
> 赞同：0
> 
> 时间：2012-12-06T15:27:23.840
> 
> 标签：html, css

I'm building a page with three basic elements: a header, a sidebar, and a `<div>` that will contain a Google map. The header has a fixed size and full width; below that, the sidebar is on the left and has a fixed width, while the map is on the right and should expand to fill all available width. It looks something like this:

```
+----------------------------------------------+
|                  header                      |
+-------------+--------------------------------+
|             |                                |
|             |                                |
|             |                                |
|   sidebar   |              map               |
|             |                                |
|             |                                |
|             |                                |
+-------------+--------------------------------+ 
```

So far, my layout could be accomplished using [this method](https://stackoverflow.com/questions/1032914/how-to-make-a-div-to-fill-a-remaining-horizontal-space-a-very-simple-but-annoyi). The problem is that I want both the map and the sidebar to take up all available *vertical* space too. I managed to get this working by absolutely positioning the map and the sidebar, but then I couldn't set a background-gradient on the page because the `<body>` was only as tall as the header--the sidebar and map were not part of the document flow.

Is it possible to achieve this combination of fixed-size and flexible objects while leaving the `<body>` with a reasonable height?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:39:52.407

请务必使用：

```
body, html {height:100%} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:40:05.230

当然！

查看小提琴：http: [//jsfiddle.net/FTD86/](http://jsfiddle.net/FTD86/)

这种方法结合了固定大小的标题和侧边栏的绝对定位项目以及容器中的填充来解释这些固定大小的项目。注意边框，它让您知道它们的大小合适:)

HTML：

```
<div class="main">
    <header></header>
    <div class="content">
        <div class="sidebar">

        </div>
        <div class="map">     
        </div>
    </div>
</div> 
```

​ CSS：

```
body, html{
    width:100%;
    height:100%;    
}

.main{
    width:100%;
    height:100%;
    box-sizing:border-box;
    padding-top:100px;
}

.main header{
    box-sizing:border-box;
    border:5px solid #ffff00;
    background:#333333;
    width:100%;
    height:100px;
    position:absolute;
    top:0;
    left:0;
}

.main .content{
    position:relative;
    background:#eeeeee;
    width:100%;
    height:100%;
    box-sizing:border-box;
    padding-left:150px;
}

.main .content .sidebar{
    box-sizing:border-box;
    border:5px solid #ff00ff;
    background:#336699;
    position:absolute;
    top:0;
    left:0;
    width:150px;
    height:100%;
}

.main .content .map{
    box-sizing:border-box;
    border:5px solid #ffffff;
    background:#ff0000;
    width:100%;
    height:100%;    
}
​ 
```

​</p>

# python - Django testing and middleware

> ID：13746916
> 
> 赞同：8
> 
> 时间：2012-12-06T15:27:50.277
> 
> 标签：python, django, django-testing, django-middleware

I am having problems using the Django test Client() for testing middleware. It seems to emulate the sessions middleware specifically. However, since it is based on the RequestFactory, it does not seem to run any middleware.

Is there any way to get the test Client to apply middleware for both, the request and the response? I understand that there are often other ways of specifically testing middleware. However, in certain cases, I would like to test a request with the full middleware stack. Any way of doing this?

I was thinking of extending the Client and modifying its request() class and running the request through the middleware stack at the beginning of the function, and the response through the middleware stack at the bottom of the function. Do you think such a thing would work? If not, can you point me at some resources which would explain why?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-01-02T15:43:14.633

您可能需要`override_settings`.

请参阅[https://docs.djangoproject.com/en/dev/topics/testing/tools/#django.test.override_settings](https://docs.djangoproject.com/en/dev/topics/testing/tools/#django.test.override_settings)。

```
@override_settings(MIDDLEWARE_CLASSES=(
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    ...
))
class ViewTest(TestCase):

    def setUp(self):
        pass 
```

# javascript - ASP & Javascript: Relative Path Issue

> ID：13746925
> 
> 赞同：0
> 
> 时间：2012-12-06T15:28:10.900
> 
> 标签：javascript, asp.net, relative-path, jplayer

I'm at wits end with this. I'm doing a contract with a client that uses ASP and am pretty unfamiliar with it. I'm using something called jPlayer for the video functionality. jPlayer will use HTML5 video if it can, and if not it falls back to a Flash plugin. When you setup the player object, you point it to the directory where the Flash player resides.

My problem, after many hours of running around in circles, is that I can't seem to get this path to work when the page is saved as ".aspx" and has the ASPnet features. When I save it as ".html" it works flawlessly. Has anyone ever ran into this issue before? Here's the code that initiates jPlayer:

```
$(this).siblings('.jPlayer').jPlayer({
    swfPath: "scripts/jQuery.jPlayer.2.2.0/",
    solution: 'flash, html',
    supplied: 'm4v',
    cssSelectorAncestor: "#j_controls_"+cur_ctrl,
    ready: function () {
        $(this).jPlayer("setMedia", {
            m4v: file 
        });                 
        $(this).jPlayer("play");
    },
    wmode: "opaque"
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:34:31.777

将 aspx 文件视为对服务器的指令，而不是对客户端的指令。没有直接的 1:1 映射到最终将发送给客户端的内容。例如，将在 处访问的内容`/some/path/with/subdirectories/test.aspx`可能与在 处访问的内容*完全相同*`/root/test.aspx`。

当客户端收到下载指令时`script/jPlayer.js`，构造的 HTTP 请求将完全不同，具体取决于加载 aspx 的两个地址中的哪一个。

最可靠的方法是从应用程序根目录访问您的文件，即`/`在路径中使用前导。

如果您无法仅通过查看路径来弄清楚为什么您的脚本没有被加载，请使用您的浏览器检查工具来查看它真正尝试加载资源的路径，以及您在哪里获得 404。

很可能你的 jPlayer 文件加载得很好，但是 jPlayer 脚本又使用相对路径来加载另一个资源，这就是你得到 404 的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:33:07.983

你所有的标记都是纯html吗？或者你正在使用任何 asp 控件？如果你使用这样的控件，你应该警惕这种标记指定的 id 在渲染之前在服务器端被改变。另请注意，您的页面可能包含一个母版页，其中包含各种其他标记和 js。很难告诉你这个小信息有什么问题。

# java - 了解工作文件上传解决方案

> ID：13746928
> 
> 赞同：1
> 
> 时间：2012-12-06T15:28:23.637
> 
> 标签：java, jsp, servlets, file-upload

我已经编写了下面的方法，该方法由我的 doPost 方法调用来解析`multipart/form-data`请求中给出的。这一切都很好，我只是不明白发生了什么。如果有人能在我的尝试中分解这三行，我将不胜感激。我已经阅读了[Apache Commons File Upload 文档](http://commons.apache.org/fileupload/using.html)，但这对我来说没有意义，我讨厌编写我不完全理解的代码。特别是，我想知道创建工厂和上传对象时实际发生了什么。

```
public static List<FileItem> parseFormRequest(HttpServletRequest request)
{
    List<FileItem> items = null;

    try 
    {
        DiskFileItemFactory factory = new DiskFileItemFactory();
        ServletFileUpload upload = new ServletFileUpload(factory);
        items = upload.parseRequest(request);
    } 
    catch (FileUploadException error) 
    {
        System.out.println("UploadFileServlet - Error With File Parsing - " + error.getMessage());
    }

    return items;
} 
```

**奖金帮助！**

我也收到了一个警告`upload.parseRequest(request)`，说`Type safety: The expression of type List needs unchecked conversion to conform to List<FileItem>`。如果有人也能解释这一点，那真的会帮助我完成我所做的事情。谢谢

![在此处输入图像描述](../Images/2759d744b61f863f58583eca1498c1c1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:51:52.190

工厂只是一个帮手，我稍后会解释。主要工作由`ServletFileUpload`.

`ServletFileUpload`将扫描所有上传的文件（使用解析 MIME 内容并知道如何处理边界标记、内容长度等的迭代器）。

对于每个上传的文件，parse 方法要求`FileItemFactory`为上传的文件创建一个本地表示，然后将内容从内存（例如，从内存中保存的 HTTP POST 请求）复制到磁盘上的实际文件。

简化，过程如下：

*   获取下一个上传的文件
*   向工厂索要本地文件（“FileItem”）
*   将内存中的内容（来自 HttpServletRequest）复制到本地文件（如果是 DiskFileItemFactory，则为 java.io.File）
*   循环直到到达 HTTP 请求的末尾

有关详细信息，请参阅以下类的来源

*   org.apache.commons.fileupload.FileUploadBase.parseRequest(RequestContext)
*   org.apache.commons.fileupload.FileUploadBase.FileItemIteratorImpl.FileItemStreamImpl

这种设计允许切换到另一个文件存储设施，例如：您可以将 DiskFileItemFactory 替换为您自己的 DatabaseFileItemFactory，因此上传的文件将存储在数据库中，而不是服务器上的本地文件中。代码更改只会影响一行，其余的 commons-fileupload 可以按原样使用（例如解析 HTTP 请求，迭代上传的文件等）

对于第二个问题：commons-fileupload 似乎与 Java 1.4 兼容，因此返回类型`parseRequest()` 实际上是无类型`java.util.List`的 - 它缺少列表仅包含 FileItem 对象的声明（例如`java.util.List<FileItem>`）。由于您将变量声明`items`为 type `List<FileItem>`，Java 编译器会警告您这种不匹配。

在这种情况下，您做得正确，您可以通过添加以下内容来忽略警告：

```
@SuppressWarnings( "unchecked" )
public static List<FileItem> parseFormRequest(HttpServletRequest request)
{
   ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:34:11.240

您需要花一些时间在[文档](http://commons.apache.org/fileupload/apidocs/org/apache/commons/fileupload/disk/DiskFileItemFactory.html)中。

据我所知，该`ServletFileUpload`实例使用您提供的工厂来实际创建请求中的文件实例。您使用了将文件写入磁盘的工厂；不过还有其他选择（例如内存）。通过指定工厂，您可以指定所创建文件的类型。

你打电话时

`upload.parseRequest(request)`

该`ServletFileUpload`实例通过请求数据并实际使用工厂创建它找到的文件，并将它们以列表的形式返回给您。

如果您查看`parseRequest` [文档](http://commons.apache.org/fileupload/apidocs/index.html?org/apache/commons/fileupload/disk/DiskFileItemFactory.html)，您会注意到该方法仅返回一个`List`. 在您的代码中，您将该返回的列表分配给`List<FileItem>`. 这需要强制转换，这就是您收到编译器警告的原因。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-12T06:48:09.920

我需要用于调用此函数的 java 代码...我需要用于向 HttpServletRequest 添加参数的 Servlet 代码

# ruby-on-rails - Stubbing a Presenter model doesn't work

> ID：13746930
> 
> 赞同：0
> 
> 时间：2012-12-06T15:28:28.643
> 
> 标签：ruby-on-rails, rspec, draper

I have a presenter:

```
class MyPresenter < Decorator    
  . . .

  def items
    . . .
  end

  # a method being tested which uses the above method
  def saved_items
    items.reject { |m| m.new_record? }
  end
end 
```

and its test:

```
describe MyPresenter do
  . . .

  describe "#saved_items" do
    subject { MyPresenter.new(container) }

    it "doesn't include unsaved items" do
      # I want to stub items method:
      subject.should_receive(:items).and_return([])
      subject.saved_items.should == []
    end
  end
end 
```

For some reason, this test fails with the following error:

```
 1) MyPresenter#saved_items doesn't include unsaved items
     Failure/Error: subject.saved_items.should == []
       Double received unexpected message :items with (no args)
     # ./app/presenters/my_presenter.rb:35:in `items'
     # ./app/presenters/my_presenter.rb:42:in `saved_items'
     # ./spec/presenters/my_presenter_spec.rb:78:in `block (3 levels) in <top (required)>' 
```

Why does it fail? Why it calls the `items` method although I have stubbed it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:18:25.483

你为什么不只是不使用`subject`块：

```
 it "doesn't include unsaved items" do
   my_presenter = MyPresenter.new(container)
   my_presenter.should_receive(:items).and_return([])
   my_presenter.saved_items.should == []
 end 
```

如果您在测试中发现重复，您可以在一个`before`块中提取对象实例化。很多时候我发现`subject`它非常有用，但有时不使用它会导致更简单的测试！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:22:51.577

实际上我有同样的问题并以这种方式修复它：

代替：

```
subject.should_receive 
```

我放：

```
MyPresenter.any_instance.should_receive 
```

# java - 向 JComboBox 和 JTextField 添加标签

> ID：13746933
> 
> 赞同：0
> 
> 时间：2012-12-06T15:28:53.853
> 
> 标签：java, swing, jtextfield, jcombobox

嗨，我在向组合框和文本字段添加标签时遇到问题。它编译得很好，但只显示框但没有标签。

```
import javax.swing. *;
import java.awt.event. *;   
import java.awt.FlowLayout;        

public class AreaFrame2  
{  

   public static void main(String[]args)  
   { 

      //Create array containing shapes  
      String[] shapes ={"(no shape selected)","Circle","Equilateral Triangle","Square"};  

      //Use combobox to create drop down menu
      JComboBox comboBox=new JComboBox(shapes);
      JPanel panel1 = new JPanel(); 
      JLabel label1 = new JLabel("Select shape:");
      panel1.add(label1);
      comboBox.add(panel1);
      JButton button = new JButton("GO");
      JTextField text = new JTextField(20);

      //Create a JFrame that will be use to put JComboBox into it 
      JFrame frame=new JFrame("Area Calculator Window");  
      frame.setLayout(new FlowLayout()); //set layout
      frame.add(comboBox);//add combobox to JFrame
      text.setLocation(100,100);
      frame.add(text);
      frame.add(button);

      //set default close operation for JFrame 
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

      //set JFrame ssize 
      frame.setSize(250,250);  

      //make JFrame visible. So we can see it 
      frame.setVisible(true);  

   }  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:41:34.363

我认为以下代码或多或少会产生您所期望的。

```
 public static void main(String[]args)
{
    //Create array containing shapes
    String[] shapes ={"(no shape selected)","Circle","Equilateral Triangle","Square"};

    //Use combobox to create drop down menu
    JComboBox comboBox=new JComboBox(shapes);
    JPanel panel1 = new JPanel(new FlowLayout());
    JLabel label1 = new JLabel("Select shape:");
    panel1.add(label1);
    panel1.add(comboBox);

    JButton button = new JButton("GO");
    JTextField text = new JTextField(20);
    //Create a JFrame that will be use to put JComboBox into it
    JFrame frame=new JFrame("Area Calculator Window");
    frame.setLayout(new FlowLayout()); //set layout
    frame.add(panel1);
    frame.add(text);
    frame.add(button);
    //set default close operation for JFrame
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    //set JFrame ssize
    frame.setSize(250,250);

    //make JFrame visible. So we can see it
    frame.setVisible(true);
} 
```

# c# - WCF 和实体框架，隐藏列/实体属性

> ID：13746934
> 
> 赞同：3
> 
> 时间：2012-12-06T15:28:59.313
> 
> 标签：c#, entity-framework, wcf-data-services

无论如何，我可以从实体类/对象中隐藏实体的属性吗？在这种情况下，我不想公开用户电子邮件地址..但我仍然希望能够向服务发布新用户..

**编辑**

只是为了澄清我在追求什么..

我有一个 WCF 数据服务，它“绑定”到我的实体框架实体......其中一个实体是一个“用户实体”，它有一个名为“电子邮件”的属性。所以我想做的是能够设置我想为“使用”服务的客户端公开/显示的用户实体的哪些属性。我希望这让它更清楚:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:20:43.267

实体是 DAL 的一部分，不能被 WCF 服务公开。您需要使用要为客户端显示的属性创建 UserViewModel。

# c# - 更改部分节点颜色

> ID：13746936
> 
> 赞同：3
> 
> 时间：2012-12-06T15:29:06.653
> 
> 标签：c#, winforms, colors, treeview

我有一个`TreeView`并且我需要每个节点来支持多色文本。

我真的不知道如何用语言表达，所以寻找答案有点困难。

![在此处输入图像描述](../Images/02022a2a55c0be7e34378603aed4faaf.png)

上面的图片代表了我想要的，但唯一的区别是我不想要矩形，我希望里面的文本是橙色的。所以一部分是`Node.Text`默认颜色，其余部分是橙色。我不知道这是否会改变任何东西，但每个节点都会有两个单词，第一个是默认颜色，第二个是橙色。所以我不需要把一个词分成两种颜色。

知道我应该从哪里开始寻找吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:35:10.423

您需要所有者绘制文本。查看[TreeView.DrawNode 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.drawnode%28v=vs.90%29.aspx)，特别是使用[TreeViewDrawMode 枚举的 OwnerDrawText 值](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeviewdrawmode%28v=vs.90%29.aspx)。

从链接：

> 使用此事件可使用所有者绘图自定义 TreeView 控件中节点的外观。
> 
> 仅当 DrawMode 属性设置为 OwnerDrawAll 或 OwnerDrawText 的 TreeViewDrawMode 值时才会引发此事件。下表说明当 DrawMode 属性设置为这些值时如何自定义 TreeNode。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:35:25.493

查看[TreeView.DrawNode 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.drawnode.aspx)。文档中有一个示例。

# java - 如何使用 Wix 创建 Java 应用程序的快捷方式

> ID：13746938
> 
> 赞同：2
> 
> 时间：2012-12-06T15:29:09.270
> 
> 标签：java, xml, wix

如何创建在 Wix 中启动带有参数的 java 应用程序的快捷方式？这是我当前的架构，它可以编译但不会将快捷方式放在桌面上。

```
<DirectoryRef Id="DesktopFolder">
    <Component Id="Shortcut" Guid="GUID-HERE">
            <Shortcut
                        Id="desktopFoobarApp" 
                        Name="Foobar 1.0"
                        Directory='DesktopFolder'
                        WorkingDirectory='INSTALLDIR'
                        Target="java"
                        Arguments="-jar [INSTALLDIR]FoobarApp.jar -v -f [INSTALLDIR]conf.cfg"
                        Icon="icon.ico" />
        <RegistryValue Root="HKCU" Key="Software\Microsoft\FoobarApp" Name="installed" Type="integer" Value="0" KeyPath="yes"/>                                                     
    </Component>
</DirectoryRef> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:27:32.537

我发现您需要将整个路径添加到目标。以下代码有效：

```
<DirectoryRef Id="DesktopFolder">
    <Component Id="Shortcut" Guid="GUID-HERE">
            <Shortcut
                        Id="desktopFoobarApp" 
                        Name="Foobar 1.0"
                        Directory='DesktopFolder'
                        WorkingDirectory='INSTALLDIR'
                        Target="[System64Folder]javaw.exe"
                        Arguments='-jar "[INSTALLDIR]FoobarApp.jar" -v -f "[INSTALLDIR]conf.cfg"'
                        Icon="icon.ico" />
        <RegistryValue Root="HKCU" Key="Software\Microsoft\FoobarApp" Name="installed" Type="integer" Value="0" KeyPath="yes"/>                                                     
    </Component>
</DirectoryRef> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:39:21.013

我认为您需要在`<Shortcut>`标签之间放置`<File>`标签

尝试这个：

```
</File Id="id" Name="file name" Source="file source path">
    <Shortcut Id="desktopFoobarApp"  Name="Foobar 1.0" Directory='DesktopFolder'
              WorkingDirectory='INSTALLDIR' Target="java"
              Arguments="-jar [INSTALLDIR]FoobarApp.jar -v -f [INSTALLDIR]conf.cfg"
              Icon="icon.ico" />
</File> 
```

# android - android - 从工作线程调用ui线程

> ID：13746940
> 
> 赞同：22
> 
> 时间：2012-12-06T15:29:13.330
> 
> 标签：android, android-activity, toast, ui-thread

嗨，我想`Toast`在我的应用程序中随时随地从任何线程中提供给我。所以为了做到这一点，我扩展了`Activity`课程：

```
import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.widget.Toast;

public class MyActivity extends Activity{
    private Handler mHandler;

    @Override   
    public void onCreate(Bundle savedInstanceState) {       
        mHandler = new Handler();
        super.onCreate(savedInstanceState);
    }

    private class ToastRunnable implements Runnable {
        String mText;

        public ToastRunnable(String text) {
            mText = text;
        }

        public void run(){
           Toast.makeText(getApplicationContext(), mText, Toast.LENGTH_SHORT).show();
        }
    }

    public void doToast(String msg) {
        mHandler.post(new ToastRunnable(msg));
    }
} 
```

这样我的应用程序中的**所有** `Activity`课程现在都很简单

```
public class AppMain extends MyActivity {
   //blah
} 
```

我期望能够做的（在工作线程中）是这样的：

```
try{
   MyActivity me = (MyActivity) Looper.getMainLooper().getThread();
   me.doToast("Hello World");
}
catch (Exception ex){
   Log.e("oh dear", ex.getMessage());
} 
```

只要它`Activity`是一个“ `MyActivity`”它应该工作 - 但问题是--->`Looper.getMainLooper().getThread();`没有返回`MyActivity`给我，它让我哭了 - 我做错了什么？

**： 编辑 ：**

一些背景来解释“为什么”我坚持这种类型的实施。

我需要能够向用户确认“HTTP POST”事件已经成功。现在。如果用户在 UI 表单上单击“确定”，那么它当时可能或可能没有互联网。如果它有互联网 - 一切都很好 - 它通过 HTTP POST 发布表单**一切都很好**.. 但如果有大多数人**没有互联网**（99.999% 的 Android 应用程序在这方面蹩脚/可怜/哀嚎，并且基本上没有为用户提供任何**计划“b”**，假设互联网始终存在 - 当它不存在时）

我的应用程序不会“跛脚（正如我所说的那样）” - 它确实有一个**计划“b”**，而是它“排队”发布事件并每 x 分钟重试一次......现在这是后台的一个静默线程......我在整个应用程序中进行大量用户交互我不知道用户将“在哪里”，但最终当队列/重试/队列/重试的 HTTP POST 返回“！成功！”时，我想将`Toast`其作为消息发送给用户（例如：“您的表单已发送”）

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-12-06T15:31:51.307

有什么问题`runOnUiThread`？

[http://developer.android.com/reference/android/app/Activity.html#runOnUiThread(java.lang.Runnable](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread(java.lang.Runnable) )

```
activity.runOnUiThread(new Runnable() {
    public void run() {
        Toast.makeText(activity, "Hello, world!", Toast.LENGTH_SHORT).show();
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-06T15:38:49.497

使用下面的代码。创建包含您的活动实例的活动对象..

```
activity.runOnUiThread(new Runnable() {
  public void run() {
    Toast.makeText(activity.getApplicationContext(),"Toast text",Toast.LENGTH_SHORT).show();
  }
); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-15T04:13:19.823

这将允许您显示消息而无需依赖上下文来启动 toast，仅在显示消息本身时引用。

runOnUiThread 无法从 OpenGL View 线程工作，这就是解决方案。希望能帮助到你。

```
private Handler handler = new Handler();
handler.post(new Runnable() {
    public void run() {
        Toast.makeText(activity, "Hello, world!", Toast.LENGTH_SHORT).show();
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T15:42:21.633

您不能只将结果转换为基类`getThread()`的实例。返回与 无关的a`MyActivity``getThread()``Thread``Activity`

没有很好的——阅读：干净——做你想做的事的方式。在某些时候，您的“工作线程”抽象必须引用可以`Toast`为您创建的东西。保存一些包含对您的子类的引用的静态变量`Activity`只是为了能够`Toast`创建快捷方式是内存泄漏和痛苦的秘诀。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-25T05:08:05.213

为什么不发送一个由广播接收器捕获的意图，然后广播接收器可以在通知托盘中创建一个通知。这不是祝酒，而是通知用户他的帖子已成功的一种方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-23T07:10:38.017

如果你有上下文，你可以像这样从非活动类调用 ui 线程。

```
((Activity)context).runOnUiThread(new Runnable() {
    public void run() {
        // things need to work on ui thread
    }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-06T15:44:09.583

如果它在你自己的活动中，你为什么不能打电话`doToast()`？

# php - 什么是同时在不同页面上同时播放 php 中音频播放列表的最佳方式

> ID：13746941
> 
> 赞同：0
> 
> 时间：2012-12-06T15:29:13.560
> 
> 标签：php, jquery, mysql, html, flash

我正在做一个项目，其中我需要在服务器上创建 txt 文件时发布公告，并且我需要通过音频公告通知所有用户，音频应该在当前的任何客户端浏览器上立即播放在页面上。公告的播放需要同步到最大的准确性。

公告由多个音频文件（播放列表）组成。

在所有活动客户端上播放公告后，txt 文件将被删除。并且服务器将等待/寻找另一个 txt 文件。

例如：client1 - 服务器时间：19:22:01，收到通知并播放音频 Client2 - 服务器时间：19:22:01，收到通知并播放音频

有什么建议吗？关于如何在所有客户上一次完成公告，有什么技巧吗？mysql 数据库或 Flash、Applet、HTML5 音频、JQuery 等。

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T12:16:59.700

我用简单的 PHP、Ajax 和 MySQL 编写了一个长轮询技术：

PHP代码如下：

```
timeout = 600;
while (timeout > 0) {
    $res = db_query("QUERY");
    $return_value = create_value_from_result($res);

    // see if the result changed
    $db_hash = md5($return_value);

    if ($_SESSION['hash'] == $db_hash) {
        // the result didn't change -- sleep and poll again
        // usleep take microseconds, 100000 is 100 millisecond
        // this is the default database polling interval
        usleep(100000);
        $timeout--;
    } else {
        // the result changed -- reply the result and set the session hash
        $timeout = 0;
        $_SESSION['hash'] = $db_hash;
    }
}
return json_encode($return_value); 
```

并且 Javascript 是简单的 Ajax（dojo 就是这种情况）：

```
function longpoll() {
    dojo.xhrPost({
        url: 'longpolling.php',
        load: function (data, ioArgs) {
            data = dojo.fromJson(data);

            do_magic(data);

            // use settimeout to avoid stack overflows
            // we could also use a while(1) loop,
            // but it might give browser errors such as 'script is
            // running too long' (not confirmed)
            setTimeout(longpoll, 0);
        }
    });
} 
```

您需要 60 秒超时以确保浏览器在 Ajax 调用上不会超时。

这样，只要 QUERY 的结果发生变化（插入记录，对记录进行更新），PHP 调用就会返回并且 Ajax 会得到它的结果。

# java - 没有空格的字符串中的 k-mers

> ID：13746946
> 
> 赞同：1
> 
> 时间：2012-12-06T15:29:24.820
> 
> 标签：java

我想知道Java中将没有空格的长字符串划分为k-mers的最佳方法是什么。基本上，我正在考虑使用不同大小的 k-mer 进行测试，并计算原始字符串中给定 k-mer 重复的数量和确切位置。

我的问题是相对于做的方法，滑动窗口？哈希图？在您看来，完成这项任务的最佳方式是什么？

这里还有重叠 k-mer 的概念，我不知道如何处理，如果有人能指出正确的方法，那就太好了。

在此先感谢达尔

# xml - 如何使用 XML starlet 的“查看”选项？

> ID：13746948
> 
> 赞同：1
> 
> 时间：2012-12-06T15:29:27.600
> 
> 标签：xml, xpath, xmlstarlet

我正在尝试从 XML 中选择值`XPath`。我想知道*为什么*有效而*无效*`xmlstarlet sel -t -m //data -v "." /tmp/test.xml` *。*`xmlstarlet sel -t -m //data /tmp/test.xml`

 *我知道该选项`-v`意味着*view*。但是`xmlstarlet sel -t -m //data -v /tmp/test.xml`卡住了。

所以，我的问题是如何正确使用选项*视图*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T23:44:08.610

实际上，`-v`表示*value-of*和`-m`表示*for-each*。这些引用[XSLT](http://www.w3.org/TR/xslt)定义^*，因为 sel 子命令只是生成一个 XSLT 文档并在输入上运行它。

```
xmlstarlet sel -t -m //data /tmp/test.xml 
```

这是一个没有主体的循环，所以没有输出。

```
xmlstarlet sel -t -m //data -v /tmp/test.xml 
```

这里`/tmp/test.xml`被解释为 XPath 表达式，`-v`因此这意味着：对于每个数据节点，输出根节点`test.xml`下命名的节点的值`tmp`。并且它期望输入 XML 来自标准输入，因此它似乎被卡住了。

通过使用该选项，您始终可以将任何`sel`命令行的含义理解为 XSLT 。`-C`

* * *

* 在最新版本的 xmlstarlet (1.3+)`-v`中，将输出由换行符分隔的节点列表中的每个节点的 value-of，而不是 XSLT 定义中 value-of 仅输出第一个节点的字符串值。*

# c# - Get-WMIObject 无法在提升的 powershell 中枚举 Win32_LogicalDiskToPartiion

> ID：13746954
> 
> 赞同：1
> 
> 时间：2012-12-06T15:29:39.673
> 
> 标签：c#, powershell, wmi, system.management

我有一个非常简单的 Powershell 查询：

```
Get-WmiObject -query 'ASSOCIATORS OF {Win32_LogicalDisk.DeviceID="C:"} WHERE AssocClass = Win32_LogicalDiskToPartition' 
```

在 Windows 7（64 位）机器上，在 Powershell 中运行它会正确枚举单个管理对象。但是，如果我在提升的 Powershell 中运行相同的查询，我会暂停很长时间，然后没有结果。

我在尝试在代码中执行 WMI 查询时发现了一个类似的问题（这是我实际上想要做的）——当我的程序在没有提升的情况下运行时，代码可以工作，当它在提升的情况下运行时没有返回结果。这是显示此问题的代码的最简单版本：

```
static void Main(string[] args)
{
    var query = "ASSOCIATORS OF {Win32_LogicalDisk.DeviceID=\"C:\"} WHERE AssocClass = Win32_LogicalDiskToPartition";
    var searcher = new ManagementObjectSearcher(query);
    foreach (var o in searcher.Get())
    {
        Console.WriteLine(o);
    }
    Console.WriteLine("DONE");
    Console.ReadLine();
} 
```

为什么会这样？更重要的是，无论如何，我可以确保在提升运行时此查询将正确执行 - 因为最终程序由于其他原因需要运行提升。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T12:49:32.467

我想我找到了罪魁祸首——我有一个使用 TrueCrypt 安装的加密驱动器。当我卸载该驱动器时，枚举正常工作，当我再次安装它时，问题再次出现。

我最好的猜测是，WMI 遇到了问题，因为加密的驱动器没有分区——尽管为什么它在不运行提升时工作完全是另一回事。

# python - 将嵌套的数据列表转换为多维 Numpy 数组

> ID：13746955
> 
> 赞同：6
> 
> 时间：2012-12-06T15:29:41.327
> 
> 标签：python, list, numpy, slice

在下面的代码中，我在嵌套列表中构建数据。在 for 循环之后，我希望将它尽可能整齐地转换为多维 Numpy 数组。但是，当我对其进行数组转换时，它似乎只是将外部列表转换为数组。更糟糕的是，当我继续向下时，我会以 dataPoints 作为形状`(100L,)`......所以一个列表数组，其中每个列表都是我的数据（显然我想要一个`(100,3)`）。我也尝试过愚弄，`numpy.asanyarray()`但我似乎无法解决。如果可能的话，我真的很想从一开始就从我的 3d 列表中获得一个 3d 数组。如果没有，我怎样才能将列表数组转换为二维数组，而无需迭代并全部转换？

编辑：如果它使处理更容易，我也愿意从一开始就更好地构建数据。但是，它是通过串行端口传输的，并且事先不知道其大小。

```
import numpy as np
import time

data = []
for _i in range(100):   #build some list of lists
    d = [np.random.rand(), np.random.rand(), np.random.rand()]
    data.append([d,time.clock()])

dataArray = np.array(data)  #now I have an array of lists of a list(of data) and a time
dataPoints = dataArray[:,0] #this is the data in an array of lists 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T15:55:05.177

dataPoints 不是二维列表。首先将其转换为二维列表，然后它将起作用：

```
d=np.array(dataPoints.tolist()) 
```

现在 d 是 (100,3) 如您所愿。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-06T15:50:20.317

如果你想要一个二维数组：

```
from itertools import chain
dataArray = np.array(list(chain(*data)),shape=(100,3)) 
```

我没有编写出代码，因此您可能必须更改列/行顺序才能使形状匹配。

# php - 无需重新加载页面的 AJAX 登录

> ID：13746957
> 
> 赞同：2
> 
> 时间：2012-12-06T15:29:49.457
> 
> 标签：php, jquery, ajax, login, reloading

我正在登录我的 iCloud 帐户，我想知道他们如何在不重新加载页面的情况下登录我。据我所知，jQuery 无法执行任何 PHP 脚本，也无法在页面加载后创建会话。我相信它可能正在使用一些cookie或其他东西，但我仍然不明白他们如何让php在登录后不重新加载页面的情况下获取这些cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:47:13.593

使用将其作为 json 数据发送回

```
echo json_encode(your array of data here) 
```

并将数据类型设置`$.ajax`为`"json"`，然后您可以将该数据作为成功回调中的第一个参数访问

```
success: function(data) { 
     console.log(data);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:34:33.417

**它由浏览器照顾**。

浏览器会自动将所有特定于您的应用程序的 cookie 发送到服务器，然后服务器决定它们的有效性。此信息在 http 请求的标头中传递。因此，如果 cookie 有效，服务器将恢复您的会话信息，从而使您登录。

# php - 如何使用 php preg_replace 更改 url 的最后一段？

> ID：13746961
> 
> 赞同：1
> 
> 时间：2012-12-06T15:30:00.063
> 
> 标签：php, regex, preg-replace

我有这样的网址：

```
/img/products/loop/blabla/81.jpg
/img/products/loop/blabla/asasd/811234.jpg
/img/productsasdasd.jpg 
```

我想像这样替换这个网址：

```
/img/products/loop/blabla/null.jpg
/img/products/loop/blabla/asasd/null.jpg
/img/null.jpg 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:37:34.213

```
 $string="/img/products/loop/blabla/81.jpg";
   echo preg_replace("/[A-Za-z0-9]+[.]/","null.",$string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:44:50.417

这是一种方法，尽管您可能还想看看[`parse_url`](http://php.net/manual/en/function.parse-url.php)

```
<?php

$urls = array(
  '/img/products/loop/blabla/81.jpg',
  '/img/products/loop/blabla/asasd/811234.jpg',
  '/img/productsasdasd.jpg'
);

foreach ($urls as $url) {
  var_dump(preg_replace('#/\w+(\.\w+)$#', '/null$1', $url));
} 
```

# ios - iOS：从 htmlpage 强制打开“Safari 窗口”

> ID：13746962
> 
> 赞同：0
> 
> 时间：2012-12-06T15:30:17.453
> 
> 标签：ios, html, safari

我想知道我们网页上的链接如何打开“safari”（完整的新窗口）。我们必须在我们的 Html5 jquery 移动页面中实现什么命令，iOS 用户单击此链接，然后 Safari 浏览器将打开 en rdirect.ro 网页？

iOS 热点登录窗口打开我们的访客登录页面，从这里我们想打开 safari 浏览器并重定向到网页。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:49:31.987

看看 JSBridgeWebView 库

[http://code.google.com/p/jsbridge-to-cocoa/](http://code.google.com/p/jsbridge-to-cocoa/)

通过这个库，您可以将消息发送到 iOS 应用程序，然后基于此消息应用程序将打开 Safari。

# svg - 如何将带有图像链接的 SVG 转换为 PNG/JPEG？

> ID：13746965
> 
> 赞同：4
> 
> 时间：2012-12-06T15:30:27.723
> 
> 标签：svg, imagemagick, png, fabricjs

我`fabric.js`用来在画布元素上添加和操作图像。我想将最终结果导出到图像文件（JPEG/PNG），并尝试了几种方法，但运气不佳。

第一个是使用 HTML5`canvas.toDataURL`回调 - 不起作用（显然这不能用跨域图像完成）。

然后我尝试将画布导出到 SVG 并使用`convert`实用程序：

```
$ convert file.svg file.png 
```

SVG 看起来有点像这样：

```
<svg>
    ...
    <image xlink:href="http://example.com/images/image.png"
    style="stroke: none; stroke-width: 1; stroke-dasharray: ; fill: rgb(0,0,0); opacity: 1;"
    transform="translate(-160 -247.5)" width="320" height="495">
    </image>
    ...
</svg> 
```

这也不起作用，大概是因为图像链接。然后我尝试下载链接的图像并将其存储在本地，将`http://...image.png`链接替换为`/path/to/image.png`. 没运气。

有没有办法做到这一点？谢谢。

* * *

## 更新

我已经通过使用fabric的节点模块（`npm install fabric`）并简单地使用fabric的画布的JSON表示（`canvas.toJSON()`在fabric中）来生成图像（也使用canvas模块- `npm install canvas`）来解决这个问题。

这是一个关于如何执行此操作的简单示例：

```
// import the fabric module
var fabric = require('fabric').fabric,
    fs = require('fs');

// read the fabric json data as string
// (from file, db, etc)
var jsonString = readJSON(filepath);

// create canvas with specified dimensions
// (change to match your needs)
canvas = fabric.createCanvasForNode(100, 100);

// create output file to hold the png image
output = fs.createWriteStream("/tmp/image.png")

// load the json to the canvas and
// pipe the output to the png file
canvas.loadFromJSON(jsonString, function() {
  var stream = canvas.createPNGStream();
  stream.pipe(output)
}); 
```

# java - javabean vs servlet

> ID：13746966
> 
> 赞同：25
> 
> 时间：2012-12-06T15:30:29.957
> 
> 标签：java, servlets, javabeans, reusability

我正在寻找 javabean 和 servlet 之间的区别。我发现

```
Servlet corresponds a Controller
JavaBean corresponds a Model 
```

和

> java bean是一个可重用的组件，而servlet是扩展服务器功能的java程序

现在，可重用在 javabean 中意味着什么。我们不能重用 servlet 吗？

如果有人能用几个例子来解释这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-08T18:00:50.967

Servlet 和 JavaBean 是完全不同的概念。servlet API 提供服务于 Internet 请求，通常来自客户端浏览器，但不限于此。JavaBeans 是一种用于封装功能的**组件架构。**一个典型的用途是 servlet 使用 bean 来处理数据库查询，但是 bean 架构在很多地方都使用。

会话是用于存储与特定用户相关的对象的 servlet 机制，这些对象可能是也可能不是 bean。用于创建用户界面的 Bean（使用您**聪明的 IDE**）有更严格的要求。servlet 和 JSP 中使用的 Bean 通常更简单。

更直接地说，JavaBeans 之于 Java 就像 ActiveX 控件之于 Microsoft。Javabeans 可以在服务器端、客户端、applet 等中运行。

因此，除了 Java 之外，两者没有任何共同之处。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-06T21:11:16.477

JavaBeans 和 Servlet 都是 1999/2000 年发布的 Java EE（Java 企业版）软件包的概念部分。

servlet 是 Java Web 应用程序中的 Java 类（用作控制器）。它的作用是管理 HTTP 请求并生成一个 HTTP 响应。例如，Servlet 使用 JavaBeans 从数据库中获取其信息。

JavaBean 是一个简单的 java 类，用于表示应用程序的模型。要被称为 JavaBean，该类必须为其所有属性具有公共 getter 和 setter，必须具有无参数构造函数，并且必须是可序列化的。

有趣的是，这个简单的 JavaBean 概念在 2000 年初迁移到了 Enterprise Java Bean (EJB)。但是经验证明，在 Java EE 环境中管理 EJB 相当复杂。因此，Enterprise JavaBeans 大部分被 IOC 容器（如 2003 年的 Spring）所普及的“Pojos”（普通旧 Java 对象）所取代。IOC 将 Javabean 撤回到其以前的概念。IOC 将整个 EJB-J2EE 模板模式、服务定位器、业务委托模式替换为简单的依赖注入 (DI)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-06T15:39:15.637

它们是两种完全不同的东西。

servlet 用于处理 Web 应用程序中的请求，所以是的，它类似于控制器。

Java bean 是遵循一组规则的任何 java 类，请参阅：[什么是“Java Bean”？](https://stackoverflow.com/questions/1973073/what-is-a-java-bean)

我想你正在阅读的任何内容都在告诉你每个人如何适应 MVC 模式

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T08:59:57.207

*   Servlet 的生命周期由 Web 容器管理，如果是 Java Bean，您将初始化或启动您的 Java Bean。

*   有两种类型的 Servlet，Generic Servlet 支持不同类型的协议请求，而 HTTPServlet 支持 HTTP 协议。

*   在大多数像struts/Spring这样的框架中，他们使用servlet作为控制器来接受请求调用，并且依赖于配置，它将调用转移到不同的Action Class/Action Controller

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-04T13:21:24.973

Java bean 是用于与数据库交互的数据访问对象。Java bean 是 POJO（Plain Old Java Object）。servlet 与 JSP 一起使用，就像 JSP 的接口一样。java bean 和 Servlet 都是 MVC 的一部分。

# iphone - 如何创建全局属性（setter 和 getter）？

> ID：13746967
> 
> 赞同：-1
> 
> 时间：2012-12-06T15:30:29.850
> 
> 标签：iphone, objective-c, ios, ios5, ios6

例如，我需要创建一个对象`NSString`并让其他类获取/设置它的值。

谢谢。求助 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:34:46.523

最简单的方法是将值作为属性附加到某个类的单例实例。您的应用程序中已经存在的一个单例实例是应用程序委托。因此，只需`NSString`向您的应用程序委托添加一个属性，您就可以从应用程序中的任何类访问它（只要您是`#import`您的应用程序委托）。

在您的应用程序委托中：

```
@property(nonatomic, strong) NSString* someString; 
```

在您的其他课程中：

```
[self doSomethingWithAString:((YourAppDelegateClass*)[[UIApplication sharedApplication] delegate]).someString]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:33:14.440

创建一个单例/共享类。

```
@implementation SINGLETON

static SINGLETON *instance = nil;

+(SINGLETON*)sharedInstance{
    @synchronized(self) {   
        if (instance == nil) {
            instance = [[SINGLETON alloc] init];
        }
        return instance;
    }
 } 
```

编辑：

这将派上用场... [Objective-C 单例问题。对象在一个类中被识别，但在另一个类中不被识别](https://stackoverflow.com/questions/6631940/objective-c-singleton-problem-object-recognized-in-one-class-but-not-another)

# c# - 管理一次性类依赖注入

> ID：13746972
> 
> 赞同：6
> 
> 时间：2012-12-06T15:30:45.747
> 
> 标签：c#, dependency-injection, ninject, lifecycle

我想知道如何使用 DI 管理对象。假设我有一堂课

```
class Foo : IFoo, IDisposable
{
    // ...
} 
```

然后这个类被注入到另一个类中

```
class Bar
{
    public Bar(IFoo foo)
    {
        this.Foo = foo
    }

    IFoo Foo { get; set; }
 } 
```

然后我在某个范围内绑定它（我的示例使用 MVC 和 Ninject）

```
this.Bind<IFoo>().To<Foo>().InRequestScope(); 
```

我想知道，既然依赖注入框架处理 的生命周期`Foo`，我应该在 中实现 IDispoable`Bar`吗？我的想法是 DI 正在管理 的生命周期`Foo`，所以不要碰它，以防另一个类正在使用`Foo`. `Bar`另外，由于一次性对象是作为构造函数参数传入的，`Bar`不会**包装**一次性对象，所以它不知道调用者`Bar`想要使用`Foo`的对象是如何`Bar`被垃圾回收的。这是正确的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T09:04:13.063

是的，你的假设是正确的。Ninject 将为您处理该对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-10T14:54:17.453

这是管理生命周期的一般问题。基本规则是创建对象的人拥有该实例的所有权。所有者应处置/销毁该实例。所有权可以传递给其他人，这使得“其他人”负责销毁该实例。

在您的情况下，Foo 实例不是由 Bar 创建的，因此 bar 不负责处理该实例。由于 Ninject 为您创建了该实例，因此它负责对其进行清理。

所有权可以传递，但这必须是明确的。显式所有权传递的一个很好的例子是工厂设计模式：

```
IFoo CreateNewFoo(); 
```

尽管此方法创建了新`IFoo`实例，但很明显他将所有权传回给调用者。

传递所有权的坏方法的一个很好的例子是 .NET 的`StreamReader`类。它在其构造函数中接受一个一次性对象，但它拥有所有权。尽管文档声明该类处理给定对象，但这种行为让许多开发人员感到眼花缭乱，因为它违反了所有权的一般规则。微软最终在 .NET 4.5 中通过添加允许抑制给定流的处置的 ctor 重载来解决此问题。

# python - 如何在 Python 中添加变量时装饰函数

> ID：13746973
> 
> 赞同：0
> 
> 时间：2012-12-06T15:30:44.583
> 
> 标签：python, decorator

我正在尝试在 Python 中构建一个装饰器，在其中我在装饰阶段添加一个变量。我知道如何编写一个装饰器，我只需在另一个函数的结果上运行一个函数，但是我在添加一个附加变量的语法上遇到了问题。本质上，我想采用这个点积功能：

```
def dot(x,y):
    temp1=[]
    for i in range(len(x)):
        temp1.append(float(x[i])*y[i])
    tempdot=sum(temp1)
    return tempdot 
```

并从结果中减去值“b”，所有这些都在一个更大的函数中，给定参数 x,y,b

在这种情况下，我是否试图滥用装饰功能？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:51:20.173

```
import functools

def subtracter(b):
    def wrapped(func):
        @functools.wraps(func)
        def decorated_func(*args, **kwargs):
            return func(*args, **kwargs) - b
        return decorated_func
    return wrapped 
```

然后将其用作

```
@subtracter(b=5)
def dot(x,y):
    temp1=[]
    for i in range(len(x)):
        temp1.append(float(x[i])*y[i])
    tempdot=sum(temp1)
    return tempdot 
```

顺便说一句，您的 dot 函数可以用生成器表达式缩短，如下所示：

```
def dot(x, y):
    return sum(float(x)*y for x, y in zip(x, y)) 
```

# sql-server - TSQL - 从下一个相邻行填充记录

> ID：13746975
> 
> 赞同：1
> 
> 时间：2012-12-06T15:31:02.633
> 
> 标签：sql-server, tsql, sql-server-2008-r2

电流输出

```
Activity            FromTime                ToTime
-------------------------------------------------------------------
STOPPED INSIDE POI  2012-11-14 01:08:46.000 2012-11-14 01:19:46.000
MOVING INSIDE POI   2012-11-14 01:20:46.000 2012-11-14 01:21:46.000
MOVING OUTSIDE POI  2012-11-14 01:22:46.000 2012-11-14 01:22:46.000
STOPPED OUTSIDE POI 2012-11-14 01:23:46.000 2012-11-14 01:23:46.000
MOVING OUTSIDE POI  2012-11-14 01:24:46.000 2012-11-14 01:25:46.000 
```

预期产出

```
Activity            FromTime                ToTime
-------------------------------------------------------------------
STOPPED INSIDE POI  2012-11-14 01:08:46.000 2012-11-14 01:20:46.000
MOVING INSIDE POI   2012-11-14 01:20:46.000 2012-11-14 01:22:46.000
MOVING OUTSIDE POI  2012-11-14 01:22:46.000 2012-11-14 01:23:46.000
STOPPED OUTSIDE POI 2012-11-14 01:23:46.000 2012-11-14 01:24:46.000
MOVING OUTSIDE POI  2012-11-14 01:24:46.000 2012-11-14 01:25:46.000 
```

有什么简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T15:46:44.457

```
;with a as
(
select Activity, FromTime, ToTime, 
row_number() over (order by FromTime) rn from <yourtable>
)
select a.Activity, a.FromTime, coalesce(b.FromTime, a.ToTime) ToTime
from a left join a b on a.rn = b.rn - 1
order by a.rn 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:42:50.777

这应该适合你：

```
UPDATE table1
SET ToTime = join_table.newToTime
FROM (
  SELECT t2.FromTime target, MIN(t1.FromTime) newToTime 
  FROM table1 t1 
  JOIN table1 t2 ON t1.FromTime > t2.FromTime
  GROUP BY t2.FromTime) join_table
WHERE FromTime = join_table.target 
```

基本上，您正在寻找`FromTime`大于当前行的最小值 - 并将其用作`ToTime`. 请注意，不会更新最后一行，因为不会`FromTime`找到匹配的更大的行。

# java - 使用 OSM 的 GWT 导致异常

> ID：13746983
> 
> 赞同：2
> 
> 时间：2012-12-06T15:31:24.310
> 
> 标签：java, gwt, openlayers, openstreetmap

我在使用 openlayers 和 openstreetmaps 来让一个简单的示例项目工作时遇到 gwt 问题。

当我运行项目时，它总是抛出异常：

```
java.lang.reflect.InvocationTargetException 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) 
at java.lang.reflect.Method.invoke(Unknown Source) 
at com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:406) 
at com.google.gwt.dev.shell.OophmSessionHandler.loadModule(OophmSessionHandler.java:200) 
at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:5  26) 
at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:364)
at java.lang.Thread.run(Unknown Source) Caused by:   com.google.gwt.core.client.JavaScriptException: (TypeError)   @org.gwtopenmaps.openlayers.client.layer.OSMImpl::Osmarender(Ljava/lang/String;)([string:   'Osmarender']): $wnd.OpenLayers.Layer.OSM.Osmarender is not a constructor 
at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:24  9) 
at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136) 
at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:571) 
at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:279) 
at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91) 
at org.gwtopenmaps.openlayers.client.layer.OSMImpl.Osmarender(OSMImpl.java) 
at org.gwtopenmaps.openlayers.client.layer.OSM.Osmarender(OSM.java:38) 
at de.iisys.sara2.sara2lightWebclient.client.View.initMap(View.java:33)
at de.iisys.sara2.sara2lightWebclient.client.View.onModuleLoad(View.java:26) ... 9 more 
```

我的示例代码：

```
public class View implements EntryPoint {

public View() {

}

public void onModuleLoad() {
    initMap();
}

private void initMap() {
    MapOptions defaultMapOptions = new MapOptions();
    MapWidget mapWidget = new MapWidget("684px", "330px", defaultMapOptions);

    OSM osm_1 = OSM.Osmarender("Osmarender");
    OSM osm_2 = OSM.Mapnik("Mapnik");
    OSM osm_3 = OSM.CycleMap("CycleMap"); 
    OSM osm_4 = OSM.Maplint("Maplint"); 

    osm_1.setIsBaseLayer(true);
    osm_2.setIsBaseLayer(true);
    osm_3.setIsBaseLayer(true);
    osm_4.setIsBaseLayer(true);

    Map map = mapWidget.getMap();
    map.addLayer(osm_1);
    map.addLayer(osm_2);
    map.addLayer(osm_3);
    map.addLayer(osm_4);
    map.addControl(new LayerSwitcher());
    map.addControl(new MousePosition());

    LonLat lonLat = new LonLat(6.95, 50.94);          
    lonLat.transform("EPSG:4326", "EPSG:900913"); 

    map.setCenter(lonLat, 12);                      

    RootPanel.get().add(mapWidget);
} 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T21:31:22.143

经过一些研究，我可以告诉你，不再支持 osmarender 和 maplint：[http ://wiki.openstreetmap.org/wiki/Tiles@home](http://wiki.openstreetmap.org/wiki/Tiles@home)

如果你从你的函数（osm_1 和 osm_4）中删除那些层，一切都会完美运行。

# php - 在加载其他网站之前调整外部图像的大小？

> ID：13746988
> 
> 赞同：5
> 
> 时间：2012-12-06T15:31:42.703
> 
> 标签：php, javascript, jquery, ajax

我正在从事一个项目，该项目涉及从各种网站获取图像并显示原始图像的缩略图或调整大小的版本。
由于我将一次获取许多图像，这需要更多时间，因为将加载原始图像文件。
**我需要的是一个图像 url，我需要该图像文件的调整大小版本吗？所以我不需要下载大的原始图像文件...**
例如：
原始图像：500X800 一些 500kb
我需要的是：100X150 一些 100kb 图像文件..

可以使用 Jquery 吗？还是 PHP？他们有像 Jquery 中的 imagecopyresampled(PHP) 或任何插件这样的功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:34:12.427

好吧，需要一次下载大文件才能创建缩略图。

您可以通过 JQuery 向您的服务器询问缩略图，服务器下载文件，创建缩略图并在调整大小完成后将缩略图的 URL 发送回客户端。这样，客户端将在准备就绪时逐渐收到缩略图。

**编辑**试验了一下，发现只要一个`img`请求图片，即使你动态删除它的`src`属性，下载也会继续。

所以我决定编写一个示例代码（没有太多验证，它只适用于 jpeg，但添加其他类型会很容易）。解决方案分为3部分：

**HTML**

`div`首先，我使用了一个带有一些特定属性的空来让`jQuery`加载什么。我需要向 Nuria Oliver 道歉，她有我能在网上找到的第一张“大图”。所以，这是一个示例`div`：

```
<div class="thumbnail" data-source="http://www.nuriaoliver.com/pics/nuria1.jpg" data-thumbnail-width="100" data-thumbnail-height= "200"/></div> 
```

我使用`thumbnail`as`class`可以轻松找到我想要的 div。其他`data`参数允许我使用 和`source`配置`width`缩略图`height`。

**JavaScript / jQuery**

现在，我们需要找到所有这些`div`s 请求`thumbnail`s... 使用 jQuery 很容易。我们提取所有`data`设置并将它们推送到一个数组中。然后我们提供一个`PHP`带有查询的页面并等待响应。这样做时，我正在填充`div`一些显示“进度”的 HTML

```
<script type="text/javascript">
    $(".thumbnail").each(function() {
        var img = $(this);
        var thumbnailWidth = img.data("thumbnail-width");
        var thumbnailHeight = img.data("thumbnail-height");
        var thumbnailSource = img.data("source");

        var innerDiv = "<div style='width:" + thumbnailWidth + "px; height:" + thumbnailHeight + "px'>Loading Thumbnail<br><img src='loading.gif'></div>"; 
        img.html(innerDiv); // replace with placeholder

        var thumbnailParams = {};
        thumbnailParams['src'] = thumbnailSource;
        thumbnailParams['width'] = thumbnailWidth;
        thumbnailParams['height'] = thumbnailHeight;

        $.ajax({
            url: "imageloader.php",
            data: thumbnailParams,
            success: function(data) {
                img.html("<img src='" + data + "'>");
            },
        });
    })
</script> 
```

**PHP**

另外`PHP`，我快速测试一下图片是否已经被缓存（我只是使用文件名，这应该更复杂但只是给你一个例子）否则我下载图片，调整大小，将其存储在`thumbnail`文件夹中并将路径返回到`jQuery`：

```
<?php

$url = $_GET["src"];
$width = $_GET["width"];
$height = $_GET["height"];

$filename = "thumbnail/" . basename($url);
if(is_file($filename)) // File is already cached
{
    echo $filename;
    exit;
}

// for now only assume JPG, but checking the extention should be easy to support other types
file_put_contents($filename, file_get_contents($url)); // download large picture
list($originalWidth, $originalHeight) = getimagesize($filename);
$original = imagecreatefromjpeg($filename); // load original file
$thumbnail = imagecreatetruecolor($width, $height); // create thumbnail
imagecopyresized($thumbnail, $original, 0, 0, 0, 0, $width, $height, $originalWidth, $originalHeight); // copy the thumbnail
imagedestroy($original);
imagejpeg($thumbnail, $filename); // overwrite existing file
imagedestroy($thumbnail);
echo $filename; 
```

**浏览器**

那么，它具体是做什么的呢？在浏览器中，当我打开页面时，我首先看到：

![加载](../Images/3fed2f8c0e4d90d44ae331bf8ad848b2.png)

一旦服务器处理完图像，它就会自动更新为：

![加载](../Images/536af4e360e374c008fe5c060196c1f5.png)

`100x200`这是我们原始图片的缩略图版本。

我希望这涵盖了您需要的一切！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T05:24:21.890

[**PHP Thumb**](http://phpthumb.sourceforge.net/)是一个很好的插件，它对我有用且易于操作。
最好的部分是输出文件有**很多选项可供选择**，例如其**质量**、**肖像图像**的**最大宽度、横向图像**的最大宽度等。
我们可以设置权限，例如**阻止服务器请求**、**阻止域缩略图**.. ETC

注意：这实际上是由某人发布的，作为这个问题的答案..但它被删除了。所以我重新发布它，因为它很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T15:34:36.800

为此，您需要进行一些您无法使用 js 进行的实际图像处理，因此需要一些服务器端语言。PHP 是一个选项

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T22:10:34.547

如果您对混淆图像源不感兴趣，您可能会非常依赖像[http://images.weserv.nl/](http://images.weserv.nl/)这样的外部工具，它获取[原始图像](http://www.google.nl/logos/logo.gif)并允许您以[不同的大小请求它](http://images.weserv.nl/?url=www.google.nl/logos/logo.gif&h=45)。

如果您最终*不*依赖全局 CDN，至少要整理出适当的缓存。您要做的最后一件事是为后续相同的请求一遍又一遍地调整相同图像的大小 - 图像较小尺寸的任何好处都可能会被处理时间所抵消。

# node.js - 节点 JS 变量范围

> ID：13746989
> 
> 赞同：2
> 
> 时间：2012-12-06T15:31:48.597
> 
> 标签：node.js, variables, scope

我有下一段代码

```
function Server() {

    function eventHandler(data) {
        console.log('DATA ' + this.server.socket.remoteAddress + ': ' + data);
        socket.write('You said "' + data + '"');
    }

    function connectionHandler(socket) {
        console.log('server connected');
        console.log('CONNECTED: ' + socket.remoteAddress +':'+ socket.remotePort);
        socket.on('data', eventHandler);
    }

    this.server = net.createServer(connectionHandler);

    this.port = undefined;

    this.startServer = function(port) { //Maybe change backlog for security reasons
        this.port = port;
        this.server.listen(port, function() { //'listening' listener add handle object here
            console.log('server bound');});
    }
} 
```

每次建立连接时，我都会得到

```
server bound
server connected
CONNECTED: 132.65.16.64:55028

/a/fr-05/vol/netforce/stud/yotamoo/ex4/myHTTP.js:7
        console.log('DATA ' + this.server.socket.remoteAddress + ': ' + data);
                                          ^
TypeError: Cannot read property 'remoteAddress' of undefined
    at Socket.eventHandler (/a/fr-05/vol/netforce/stud/yotamoo/ex4/myHTTP.js:7:43)
    at Socket.emit (events.js:67:17)
    at TCP.onread (net.js:329:14) 
```

这`evenHandler()`当然是有关系的。我不明白如何在 Node JS 中创建对象及其范围。例如，在哪里创建`socket`和`data`创建？他们的范围是什么？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:56:55.247

这意味着当前的调用函数。

在您的情况下，这指的是 eventHandler 和 eventHandler 仅将数据作为可访问值。

如果你尝试访问套接字，你会像你一样得到一个异常。因为套接字不在那个函数范围内。

套接字和数据都来自异步回调，这是 node.js 的主要模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:34:52.303

您已经获得了希望事件处理函数使用[`bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)的值，如下所示：`this`

```
function Server() {

    function eventHandler(data) {
        console.log('DATA ' + this.server.socket.remoteAddress + ': ' + data);
        socket.write('You said "' + data + '"');
    }

    function connectionHandler(socket) {
        console.log('server connected');
        console.log('CONNECTED: ' + socket.remoteAddress +':'+ socket.remotePort);
        socket.on('data', eventHandler.bind(this));
    }

    this.server = net.createServer(connectionHandler.bind(this));

    this.port = undefined;

    this.startServer = function(port) {
        this.port = port;
        this.server.listen(port, function() {
            console.log('server bound');});
    };
} 
```

# python - 将 Matplotlib 滑块与同一轴上的多个绘图一起使用

> ID：13746994
> 
> 赞同：0
> 
> 时间：2012-12-06T15:32:10.233
> 
> 标签：python, matplotlib

我在 Matplotlib 的相同轴上绘制了多条线图。我正在尝试使用 Slider 小部件来调整线条，但由于某种原因，只显示了第一条线图，当我移动滑块时没有任何更新：

```
import matplotlib.pyplot as p
from matplotlib.widgets import Slider, Button, RadioButtons

Kd=0.0 
Ks=0.0
mass=0.02 

width=900
yPosition = []
yVelocity = []
yTarget = []
yForce = []
lpos= []
lvel = []
ltarget = []
lforce = []

def runSimulation(positionGain=1.5, velocityGain=60.0):
    global Kd, Ks, mass, yPosition, yVelocity, yTarget, yForce, width

    velocity = 0.0
    acceleration = 0.0
    reference = 100.0
    target = 0.0
    position = 0.0
    force = 0.0
    T=0.0005

    yPosition = []
    yVelocity = []
    yTarget = []
    yForce = []

    for i in range(0,width*10):
        acceleration = (force - Kd*velocity - Ks*position)/mass

        # Equations of motion for constant acceleration
        position = position + (velocity*T) + (0.5*acceleration*T*T)
        velocity = velocity + acceleration*T 

        e1 = target - position # Output of 1st control system
        e2 = positionGain * e1 - velocity # Output of 2nd control system
        force = velocityGain * e2

        if i % 10 == 0: #Plot 1 point for every 10 iterations of simulation
            if i>=30:
                target = reference
            else:
                target = 0
            yPosition.append(position)
            yVelocity.append(velocity*0.1)
            yTarget.append(target)
            yForce.append(force*0.001)

def plotGraph():
    global yPosition, yVelocity, yTarget, yForce, lpos, lvel, ltarget, lforce
    x = range(0,width)
    ax = p.subplot(111)
    lpos, = ax.plot(x,yPosition,'r')
    lvel, = ax.plot(x,yVelocity,'g')
    ltarget, = ax.plot(x,yTarget,'k')
    lforce, = ax.plot(x,yForce,'b')

ax = p.subplot(111)
p.subplots_adjust(left=0.25, bottom=0.25)
runSimulation()
plotGraph()

p.axis([0, 1, -10, 10])

axcolor = 'lightgoldenrodyellow'
axpos = p.axes([0.25, 0.1, 0.65, 0.03], axisbg=axcolor)
axvel  = p.axes([0.25, 0.15, 0.65, 0.03], axisbg=axcolor)

spos = Slider(axpos, 'Position Gain', 1.0, 20.0, valinit=1.5)
svel = Slider(axvel, 'Velocity Gain', 5.0, 500.0, valinit=60.0)

def update(val):
    global yPosition,yVelocity,yTarget,yForce
    runSimulation(round(spos.val,2),round(svel.val,2))
    lpos.set_ydata(yPosition)
    lvel.set_ydata(yVelocity)
    ltarget.set_ydata(yTarget)
    lforce.set_ydata(yForce)
    p.draw()

spos.on_changed(update)
svel.on_changed(update)
p.show() 
```

如果您删除之间的线`plotGraph()`，`p.show()`您可以看到原始图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T13:57:16.623

老实说，您在轴定位和更新功能方面有些混乱。我冒昧地再次写了绘图部分并将评论放在那里：

```
# run your simulation like usual
runSimulation()

#create a ordered grid of axes, not one in top of the others
axcolor = 'lightgoldenrodyellow'
fig = p.figure()
axdata = p.subplot2grid((7,4),(0,0),colspan=4,rowspan=4)
axpos = p.subplot2grid((7,4),(-2,0),colspan=4, axisbg=axcolor)
axvel = p.subplot2grid((7,4),(-1,0),colspan=4, axisbg=axcolor)

# create your plots in the global space.
# you are going to reference these lines, so you need to make them visible
# to the update functione, instead of creating them inside a function 
# (and thus losing them at the end of the function)
x = range(width)
lpos, = axdata.plot(x,yPosition,'r')
lvel, = axdata.plot(x,yVelocity,'g')
ltarget, = axdata.plot(x,yTarget,'k')
lforce, = axdata.plot(x,yForce,'b')

# same as usual
spos = Slider(axpos, 'Position Gain', 1.0, 20.0, valinit=1.5)
svel = Slider(axvel, 'Velocity Gain', 5.0, 500.0, valinit=60.0)

def update(val):
    # you don't need to declare the variables global, as if you don't
    # assign a value to them python will recognize them as global
    # without problem
    runSimulation(round(spos.val,2),round(svel.val,2))
    lpos.set_ydata(yPosition)
    lvel.set_ydata(yVelocity)
    ltarget.set_ydata(yTarget)
    lforce.set_ydata(yForce)
    # you need to update only the canvas of the figure
    fig.canvas.draw()

spos.on_changed(update)
svel.on_changed(update)
p.show() 
```

顺便说一句，如果你想模拟阻尼振荡，我强烈建议你看一下 scipy 的积分模块，它包含 odeint 函数以比你正在做的更好的方式积分微分方程（这被称为欧拉积分，而且真的很容易出错）

# ipad - 仅适用于 iPad 的 CSS 媒体查询，而不是具有类似 iPad 分辨率的桌面

> ID：13746998
> 
> 赞同：1
> 
> 时间：2012-12-06T15:32:19.300
> 
> 标签：ipad, css, media-queries

> **可能重复：**
> [仅针对 iPad 和 iPad 的 CSS 媒体查询？](https://stackoverflow.com/questions/8271493/css-media-query-to-target-ipad-and-ipad-only)

我试图仅针对 css iPad 和 iPad，我发现的所有解决方案都与此类似：

```
<link type="text/css" rel="stylesheet" media="only screen and (min-device-width: 768px) and (max-device-width: 1024px)" href="css/ipadStyleRV.css" /> 
```

但这针对 iPad 和分辨率为 1024 x 768 的屏幕。我只想针对 iPad 而不是桌面屏幕。

有没有办法只用媒体查询来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T15:46:06.973

您还可以检查浏览器是否支持使用 javascript 的触摸事件并基于此应用 css。