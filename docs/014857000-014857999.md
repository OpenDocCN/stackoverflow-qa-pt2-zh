# StackOverflow 问答 14857000-14857999

# c# - 从 DataGridview 保存值，每次打开后显示它们

> ID：14857002
> 
> 赞同：0
> 
> 时间：2013-02-13T15:29:15.297
> 
> 标签：c#, datagridview, datatable, save

我有一个关于保存 Datatable 或 DataGridView 值的问题。我制作了一个 windows 窗体并将数据表绑定到 datagridview。现在我希望每次打开 Windows 窗体时都可以看到这个 datagridview 中的值。因为有时用户会向 DGV 添加一些行，当我再次打开它时，这些行不再存在。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:09:41.470

我认为你可以通过这种方式做到这一点。当用户向 DataGridView 添加一行时，您可以将该行添加到 DGV 只是为了向用户显示它。但是当程序关闭时，您可以将这些行添加到 DGV 的源中，从中读取所有数据。

# iis - 使用 iisapp.vbs 启动 MyAppPool

> ID：14857004
> 
> 赞同：2
> 
> 时间：2013-02-13T15:29:22.877
> 
> 标签：iis, batch-file, iis-6, application-pool

我有一个批处理文件，它使用以下脚本来回收`MyAppPool`.

```
cscript.exe %windir%\system32\iisapp.vbs /a MyAppPool /r 
```

但是，当`MyAppPool`停止时，我无法回收它。我想要的是检查天气`MyAppPool`是否停止，如果停止，则启动它，回收它然后再次停止。

好吧，我在这个 IIS 方面是一个完全的新手，并且从未在其中工作过。我正在使用 Window Server 2003 和 IIS6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T20:50:02.533

您可以编写自己的 .vbs 脚本来查找 AppPool 的 .State，并在它停止时启动它。就像是：

//编辑：

```
Option Explicit

If WScript.Arguments.Count <> 1 Then
    Wscript.Echo "No AppPoolName provided. Iterate through all AppPools"
    iterate_and_start_all_apps()
Else
    Dim AppPoolName
    AppPoolName = Wscript.Arguments(0)
    '
    ' Choose what to do here and uncomment that Sub
    '
    ' start_given_app(AppPoolName)
    ' start_one_app_if_stopped(AppPoolName)
    ' start_recycle_stop_app(AppPoolName)
End If

' This Sub is runs if no argument is passed to the script
Sub iterate_and_start_all_apps()
        Dim objAppPools, objAppPool
        Set objAppPools = GetObject("IIS://Localhost/W3SVC/AppPools")
        For Each objAppPool in objAppPools
          Set objAppPool = GetObject("IIS://Localhost/W3SVC/AppPools/" & objAppPool.Name )
            If objAppPool.AppPoolState <> 2 Then
              Wscript.Echo objAppPool.Name & " is not running."
                  WScript.Echo objAppPool.Name & ", AppPoolState: " & objAppPool.AppPoolState & _
                        ", Win32Error: " & objAppPool.Win32Error & " ("& hex(objAppPool.Win32Error)&")"
                  Wscript.Echo State2Desc(objAppPool.AppPoolState)
                  objAppPool.Start
                  If Err.Number = 0 Then
                    Wscript.Echo objAppPool.Name & " started."
                  End If
                End If
        Next
        Set objAppPool = Nothing
        Set objAppPools = Nothing
End Sub

'
' start an application pool if the .State is stopped
'
Sub start_one_app_if_stopped(applicationpool)
        Dim iisObjectPath : iisObjectPath = ("IIS://Localhost/W3SVC/AppPools/" & applicationpool)
        Dim iisObject : Set iisObject = GetObject(iisObjectPath)
                If iisObject.AppPoolState <> 2 Then
                  iisObject.Start
                  If (Err.Number <> 0) Then
                    WScript.Echo "Error starting: " & ObjectPath
                    WScript.Quit (Err.Number)
                  Else
                    WScript.Echo applicationpool & " started."
                  End If
                End If
        Set iisObject = nothing
        Set iisObjectPath = nothing
End Sub

'
' if an application pool is stopped, start + recycle + stop it
'
Sub start_recycle_stop_app(applicationpool)
        Dim iisObjectPath : iisObjectPath = ("IIS://Localhost/W3SVC/AppPools/" & applicationpool)
        Dim iisObject : Set iisObject = GetObject(iisObjectPath)
                If iisObject.AppPoolState <> 2 Then
                  iisObject.Start
                  If (Err.Number <> 0) Then
                    WScript.Echo "Error starting: " & ObjectPath
                    WScript.Quit (Err.Number)
                  Else
                    WScript.Echo applicationpool & " started."
                 End If

                  iisObject.recycle
                  ' we need to sleep for some time because recyle takes some time
                  wscript.sleep(3000)

                  iisObject.Stop
                End If
        Set iisObject = nothing
        Set iisObjectPath = nothing
End Sub

'
' just issue a start command to start an application pool
'
Sub start_given_app(applicationpool)
        Dim iisObjectPath : iisObjectPath = ("IIS://Localhost/W3SVC/AppPools/" & applicationpool)
        Dim iisObject : Set iisObject = GetObject(iisObjectPath)
                IIsObject.Start
                If (Err.Number <> 0) Then
                        WScript.Echo "Error starting: " & ObjectPath
                        WScript.Quit (Err.Number)
                Else
                        WScript.Echo applicationpool & " started."
                End If
        Set iisObject = nothing
        Set iisObjectPath = nothing
End Sub

'
' support function
'
Function State2Desc(nState)
    Select Case nState
    Case 1
        State2Desc = "Starting"
    Case 2
        State2Desc = "Started"
    Case 3
        State2Desc = "Stopping"
    Case 4
        State2Desc = "Stopped"
    Case Else
        State2Desc = "Unknown state"
    End Select
End Function 
```

（部分摘自[http://www.saotn.org/iis-60-start-gestopte-application-pools/](http://www.saotn.org/iis-60-start-gestopte-application-pools/)，这是一个启动所有应用程序池的脚本）。

另存为“startapp.vbs”并运行：

```
cscript.exe /nologo startapp.vbs name_of_appPool 
```

如果您在没有参数的情况下启动它，那么脚本将遍历元数据库中的所有应用程序池，如果它们没有运行，则启动它们。

我认为您将需要“start_one_app_if_stopped”Sub，因此取消注释该行（第 13 行）并使用命令行参数运行 .vbs 脚本：

```
cscript.exe /nologo startapp.vbs name_of_appPool 
```

高温高压

# c# - Ninject 在 MVC3 中生成 TypeLoadException

> ID：14857005
> 
> 赞同：2
> 
> 时间：2013-02-13T15:29:22.737
> 
> 标签：c#, asp.net-mvc-3, ninject

我正在尝试使用 Ninject 和 MVC 执行以下测试方法：

```
 [TestMethod]
    public void CreateEntityTest()
    {
        using (IKernel kernel = new StandardKernel())
        {
            kernel.Bind<IAccountControllerHelper>().To<AccountControllerHelper>();

            var a = kernel.Get<IAccountControllerHelper>();
            var p = a.GetPerson("jude-test-user-20130120");
            Assert.AreEqual(3, p.FriendlyId);
        }
    } 
```

它会产生以下错误：

> 测试方法 YellowLlama.Web.Tests.AccountControllerHelperTests.CreateEntityTest 抛出异常：System.TypeLoadException：类型违反继承安全规则：'Ninject.Web.Mvc.Filter.FilterContextParameter'。派生类型必须要么与基类型的安全可访问性相匹配，要么难以访问。在 System.Reflection.RuntimeAssembly.GetExportedTypes(RuntimeAssembly 程序集，ObjectHandleOnStack retTypes) 在 System.Reflection.RuntimeAssembly.GetExportedTypes() 在 Ninject.Infrastructure.Language.ExtensionsForAssembly.HasNinjectModules(Assembly 程序集) 在 c:\Projects\Ninject\ninject\src \Ninject\Infrastructure\Language\ExtensionsForAssembly.cs：C:\Projects\Ninject\ninject\src\Ninject\Modules\CompiledModuleLoaderPlugin.cs 中 Ninject.Modules.CompiledModuleLoaderPlugin.b__0(Assembly asm) 的第 25 行：

我已经在网上搜索并尝试了一些我发现无济于事的建议。

# ios - 使用 performBlock 进行计数请求时核心数据崩溃

> ID：14857006
> 
> 赞同：2
> 
> 时间：2013-02-13T15:29:27.537
> 
> 标签：ios, objective-c, core-data, objective-c-blocks

使用 performBlock 在同一个私有队列 NSManagedObjectContext 上同时调用 countForFetchRequest 两次时，我的 iOS 应用程序崩溃。

我像这样设置我的 childContext

```
_childContext = [[NSManagedObjectContext alloc]initWithConcurrencyType:NSPrivateQueueConcurrencyType];
[_childContext setParentContext:self.managedObjectContext]; 
```

这是我调用 countForFetchRequest 的 performBlock

```
[self.childContext performBlock:^{
    NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"History"];

    fetchRequest.predicate = [NSPredicate predicateWithFormat:@"url == %@", url];

    NSError *error = nil;

    NSUInteger num = [self.childContext countForFetchRequest:fetchRequest error:&error];

    if(error != nil){
        NSLog(@"Error getting count for history url %@ %@", url, error);
        return;
    }

    if(num > 0){ // Already have this in the history, don't re-add it
        return;
    }

    History *history = (History *)[NSEntityDescription insertNewObjectForEntityForName:@"History" inManagedObjectContext:self.childContext];

    history.url = url;
    history.title = title;

    if(![self.childContext save:&error]){
        NSLog(@"Error occurred saving history item %@ %@ %@", title, url, error);
    }
}]; 
```

这是崩溃日志：

```
Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x3a427350 __pthread_kill + 8
1   libsystem_c.dylib               0x3a39e11e pthread_kill + 54
2   libsystem_c.dylib               0x3a3da96e abort + 90
3   libc++abi.dylib                 0x39978d4a abort_message + 70
4   libc++abi.dylib                 0x39975ff4 default_terminate() + 20
5   libobjc.A.dylib                 0x39f29a74 _objc_terminate() + 144
6   libc++abi.dylib                 0x39976078 safe_handler_caller(void (*)()) + 76
7   libc++abi.dylib                 0x39976110 std::terminate() + 16
8   libc++abi.dylib                 0x39977594 __cxa_rethrow + 84
9   libobjc.A.dylib                 0x39f299cc objc_exception_rethrow + 8
10  CoreData                        0x31e868e0 -[NSManagedObjectContext(_NSInternalAdditions) _countWithNoChangesForRequest:error:] + 764
11  CoreData                        0x31e833fe -[NSManagedObjectContext countForFetchRequest:error:] + 1062
12  CoreData                        0x31e92470 __82-[NSManagedObjectContext(_NestedContextSupport) executeRequest:withContext:error:]_block_invoke_0 + 460
13  libdispatch.dylib               0x3a345d26 _dispatch_barrier_sync_f_slow_invoke + 82
14  libdispatch.dylib               0x3a3404b4 _dispatch_client_callout + 20
15  libdispatch.dylib               0x3a3451b8 _dispatch_main_queue_callback_4CF$VARIANT$mp + 220
16  CoreFoundation                  0x3205cf36 __CFRunLoopRun + 1286
17  CoreFoundation                  0x31fcfeb8 CFRunLoopRunSpecific + 352
18  CoreFoundation                  0x31fcfd44 CFRunLoopRunInMode + 100
19  GraphicsServices                0x35b992e6 GSEventRunModal + 70
20  UIKit                           0x33ee52fc UIApplicationMain + 1116
21  Accountable2You Mobile          0x000e5d28 0xe4000 + 7464
22  Accountable2You Mobile          0x000e5cc4 0xe4000 + 7364

Thread 1 name:  Dispatch queue: NSManagedObjectContext Queue
Thread 1:
0   libsystem_kernel.dylib          0x3a416f04 semaphore_wait_trap + 8
1   libdispatch.dylib               0x3a3462fc _dispatch_thread_semaphore_wait$VARIANT$mp + 8
2   libdispatch.dylib               0x3a34487c _dispatch_barrier_sync_f_slow + 96
3   CoreData                        0x31e82df2 _perform + 166
4   CoreData                        0x31e921c6 -[NSManagedObjectContext(_NestedContextSupport) executeRequest:withContext:error:] + 238
5   CoreData                        0x31e86770 -[NSManagedObjectContext(_NSInternalAdditions) _countWithNoChangesForRequest:error:] + 396
6   CoreData                        0x31e833fe -[NSManagedObjectContext countForFetchRequest:error:] + 1062
7   Accountable2You Mobile          0x000ee7be 0xe4000 + 42942
8   CoreData                        0x31e86072 developerSubmittedBlockToNSManagedObjectContextPerform_privateasync + 66
9   libdispatch.dylib               0x3a344eca _dispatch_queue_drain$VARIANT$mp + 138
10  libdispatch.dylib               0x3a344dbc _dispatch_queue_invoke$VARIANT$mp + 36
11  libdispatch.dylib               0x3a34591a _dispatch_root_queue_drain + 182
12  libdispatch.dylib               0x3a345abc _dispatch_worker_thread2 + 80
13  libsystem_c.dylib               0x3a375a0e _pthread_wqthread + 358
14  libsystem_c.dylib               0x3a3758a0 start_wqthread + 4 
```

我是否正确使用了 performBlock？

**编辑：更多细节**

performBlock 在 webViewDidFinishLoad:webView 委托方法中被调用。我有多个 UIWebViews，当它们完成加载时，它们调用委托方法，该方法又调用 performBlock 以查看它是否需要将 url 添加到核心数据数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:43:26.120

您可以将导致崩溃的方法封装在：

```
@synchronized(self) {
    [object yourMethod];
} 
```

这将确保即使在多线程时，内部的代码也将一次只运行一次......其他线程将只需要等待。坦率地说，这只有在崩溃的原因是并发时才有效。

# json - 如何在 Json 中序列化 val 元素

> ID：14857009
> 
> 赞同：3
> 
> 时间：2013-02-13T15:29:35.810
> 
> 标签：json, scala, scala-2.10

序列化以下案例类时，不包括 val 元素。为什么会这样，我可以把它包括在内吗？

```
case class Asset(id: Option[Int], description: Option[String]= None) {
  val url = "images/" + id.toString+".png"
} 
```

**更新：添加了 Json 库，以及 url“属性”的规范/预期用途。**

我正在使用 Play 2.1/Scala 2.10 附带的 Json 库。

实际上 url 属性是一个函数，它将根据配置查找转换算法，例如图像可以在本地可用，也可以从外部主机可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:47:25.937

尽管您确实指定了您正在使用的 json 序列化库，但几乎可以保证只需执行以下操作即可：

```
case class Asset(id: Option[Int], description: Option[String]= None, url = "images/" + id.toString+".png") 
```

鉴于它`url`无论如何都有一个默认值，将其转换为参数不会对您的代码产生负面影响（您仍然可以`Asset(None)`像以前一样通过示例进行操作）。唯一的缺点是现在客户端代码可能会创建一个`Asset`具有不同值的实例`url`，这可能不是您想要的。

如果是这种情况，您可能需要为您的`Asset`类创建自定义 json 格式，但在不知道您使用哪个序列化库的情况下，我在这方面无能为力。

* * *

**更新**：

糟糕，我完全错过了默认值`url`取决于另一个参数 ( `id`) 的事实（感谢@Kristian Domagala 的注意）。因此，我上面的代码段无法编译。一个简单的解决方案是`url`按照@Kristian Domagala 的建议放入第二个参数列表：

```
case class Asset(id:Option[Int],description:Option[String]=None)(val url:String = "images/" + id.toString+".png") 
```

但这可能并不理想，因为这改变了`Asset`(`url`在比较实例时不再考虑的相等语义)，并且还改变了构造语法：当显式指定`url`值时，您需要执行类似的操作`Asset(Some(123))("gfx/myImage.png")`而不是示例`Asset(Some(123), url="gfx/myImage.png")`. 如果你能忍受这些缺点，这肯定是最简单的解决方案。

否则，还有另一种解决方法：我们可以重新定义`Asset.apply`自己（手动）：

```
case class AssetImpl( val id: Option[Int], val description: Option[String], val url: Option[String]) {
  override def productPrefix = "Asset"
}
type Asset = AssetImpl
object Asset {
  def apply( id: Option[Int], description: Option[String] = None, url: Option[String] = None ) = {
    new Asset( id, description, url.orElse( id.map( "images/" + _ + ".png") ) )
  }
} 
```

正如你所看到的，我已经变成`url`了`Option`一个默认值`None`（避免以前的编译错误，因为它不再依赖`id`），因为，并且我用默认值`def apply...`实例化了（这是我实际获得值的地方的) 的。`Asset``url``id``id.map( "images/" + _ + ".png")`

其余的基本上只是能够重新定义的噪音`Asset.apply`：事实证明，实际上您无法重新定义案例类的工厂（您只能添加单独的重载）。所以我将类重命名为`AssetImpl`，添加了一个类型别名以便没有人注意到 ( ;-) )，并创建了我自己的对象`Asset`，我在其中定义了`apply`方法（它不再与自动生成的`apply`方法冲突，因为这个在不同的`AssetImpl`对象。我也可以简单地变成`Asset`一个标准类（非案例类），但随后我将不得不重新定义`equals`并且`hashCode`我觉得更烦人，因为在向类添加/删除字段时必须维护它。

# python - 如何在python中散列字符串以匹配1个字符？

> ID：14857011
> 
> 赞同：0
> 
> 时间：2013-02-13T15:29:38.480
> 
> 标签：python, string, search, hash

我已经阅读了有关 LSH 散列的信息，并且想知道在 1 个字符内匹配字符串的最佳实现是什么？

```
test = {'dog':1, 'cat': 2, 'eagle': 3} 

test['dog']
>> 1 
```

如果我查找 test['dogs'] 或 test['dogg']，我也想返回 1。我意识到如果我要查找“log”或“cog”它也会返回 1，但我可以编写一个方法来排除这些结果。

另外，如何进一步使用此方法使一般字符串返回 X 个字符内的匹配项？

```
string1 = "brown dogs"
string2 = "brown doggie" 
```

假设我的字典中只存储了 string1，那么查找 string2 将返回 string1。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:57:34.337

好吧，您可以通过它们共有的开头长度来定义 2 个字符串之间的相似性（例如， 3 代表`doga`和`dogs`）。这很简单，但可以满足您的需求。

有了这个假设，您可以定义：

```
>>> test = {'dog':1, 'cat': 2, 'eagle': 3}
>>> def same_start(s1, s2):
    ret = 0
    for i in range(min(len(s1), len(s2))):
        if s1[i] != s2[i]:
            break
        ret += 1
    return ret

>>> def closest_match(s):
    return max(((k, v, same_start(k, s)) for k, v in test.iteritems()), key=lambda x: x[2])[1]

>>> closest_match('dogs')  # matches dog
1
>>> closest_match('cogs')  # matches cat
2
>>> closest_match('eaogs') # matches eagle
3
>>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:26:31.550

由于您的关系不是 1:1，也许您可​​以使用 redefined 定义自己的 dict 类型，`__getitem__`这可以返回可能项目的列表。这就是我的意思：

```
class MyDict(dict):
  def __getitem__(self, key):
    l = []
    for k, v in self.items():
      if key.startswith(k): # or some other comparation method
        l.append(v)
    return l 
```

这只是一个想法，可能其他 dict 方法也应该重新定义，以避免可能的错误或无限循环。此外，如果您只想返回一个项目而不是列表， [@Emmanuel 的答案在这里可能非常有用，这样您就不必重新定义所有内容。](https://stackoverflow.com/a/14857578/296974)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:35:01.500

也许您可以尝试使用 Soundex 函数作为您的字典键？

# ruby-on-rails - cloudcontrol.com tcp 端口正在使用和 procfile 多个命令和推送挂钩

> ID：14857017
> 
> 赞同：1
> 
> 时间：2013-02-13T15:29:59.663
> 
> 标签：ruby-on-rails, ruby, port, cloudcontrol, procfile

我正在尝试让 redmine 在 cloudcontrol.com 上运行。我有四个问题：

1.  我需要做更多的事情来启动一个网络服务器，例如我每次部署时都需要运行 rake 任务。我可以把它们放在一个衬里吗？我在我的 Procfile 中得到以下测试：

网页：触摸 foobar；回声“巴巴兹”；bundle exec rails s -p $PORT -e production

但我既没有看到文件 foobar，也没有在日志文件中看到 barbarz :(

1.  当我登录到服务器并想要启动应用程序时，它告诉我 tcp $PORT 已在使用中：

u24293@depvk7jw2mk-24293:~/www$ fuser $PORT/tcp # netstat 和 lsof 不可用 24293/tcp: 10 13 u24293@depvk7jw2mk-24293:~/www$ ps axu | grep 13 u24293 13 0.0 0.0 52036 3268 ？SN 15:22 0:00 sshd: u24293@pts/0

通过sshd？？？为什么会这样？

1.  我需要在推送期间更改此默认行为： -----> Rails 插件注入 Injecting rails_log_stdout Injecting rails3_serve_static_assets

或者在它之后运行一些东西，因为easyredmine不喜欢供应商/插件中的插件（或者我快速修改easyredmine的代码）。我将如何做到这一点（不更改代码，像 capistrano 那样运行一个后钩子）？

1.  我们在专用服务器上有自己的 gitlab，对于捆绑包，我需要提取这些宝石。如何在第一次部署之前获取运行应用程序的用户的公钥，以便将其添加到 gitlab？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:51:52.160

1.  web 命令仅在 web 容器中执行。使用`run bash`将您连接到应用程序的特殊 ssh 容器。请参阅[https://www.cloudcontrol.com/dev-center/Platform%20Documentation#secure-shell-ssh](https://www.cloudcontrol.com/dev-center/Platform%20Documentation#secure-shell-ssh)

    通常，您不能将多个命令放在一个 Procfile 行中。将它们包装在`sh -c '<cmd1>; <cmd2>'`调用中或显式使用 shell 脚本。请记住，此脚本将在每个正在启动的容器中执行。这包括您部署应用程序的容器数量以及在操作期间由平台触发的任何重新部署（在节点故障、插件更改等情况下）。

2.  在 ssh 容器中，$PORT 由您连接到的 ssh 服务器使用。

3.  如果是运行时 redmine 的问题，您可以删除上述启动脚本中的插件。如果当前在 gem 安装过程中出现问题，则您无法规避此行为。

4.  目前不支持需要特殊 ssh 密钥的依赖项。如果您的服务器支持基于 https 的基本身份验证，则可以使用`https://<username>:<password>@hostname`语法

# android - 通过通知提示用户 - 需要反馈给用户吗？

> ID：14857019
> 
> 赞同：3
> 
> 时间：2013-02-13T15:30:00.257
> 
> 标签：android, notifications

我的问题与android通知有关。

在我的应用程序中，每天会多次提示用户通过通知输入数据（然后将其传输到服务器应用程序）。因此，一旦用户单击通知，就会启动一个活动，用户在其中输入一些数据。点击报告按钮后，数据上传（并清除通知）。我是否必须告诉用户他的数据条目已存档或上传或其他（例如通过 Toast 或对话框）？

在对应用通知做出反应后，是否有与提供用户反馈相关的最佳实践？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:24:58.657

如果您查看[Android Design Patterns Guide](http://developer.android.com/design/patterns/confirming-acknowledging.html)，如果您不确定是否需要提供反馈，它们有一个很好的流程图供您使用。根据您的描述，我猜它在第 4 块上命中“否”（如果您想要撤消选项，可能会在第 3 块上），因此您应该提供轻量级的反馈。就像你建议的那样，祝酒或对话非常适合。

# gwt - GWT eclipse 插件安装要求进行身份验证

> ID：14857020
> 
> 赞同：0
> 
> 时间：2013-02-13T15:30:00.943
> 
> 标签：gwt

我在 WindowsXP 机器上使用 Eclipse Juno。当我尝试从 Google 插件站点 [http://dl.google.com/eclipse/plugin/4.2](http://dl.google.com/eclipse/plugin/4.2)安装新软件时，它提示我输入用户名和密码错误显示 = [http://dl.google的身份验证失败.com/eclipse/plugin/4.2](http://dl.google.com/eclipse/plugin/4.2)。

我已经尝试过我的 gmail 帐户登录，但这不起作用。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:35:43.920

您是否启用了 2 因素身份验证？如果是这样，您将需要使用特定于应用程序的密码。

# smtp - Joomla PHP 邮件与 SMTP

> ID：14857021
> 
> 赞同：2
> 
> 时间：2013-02-13T15:30:05.077
> 
> 标签：smtp, joomla2.5, php

我被要求将我们当前所有的 Joomla 站点从使用 PHP 邮件更改为 SMTP。

背景：我们最近在我们的一个站点上受到了一个易受攻击的组件的影响。我们有一个专用服务器，运行 CPanel。黑客攻击涉及将文件上传到一个帐户，该帐户具有文件管理器（可以访问 /home，即所有其他帐户）。从那里上传了另一个开始发送电子邮件的文件 - 不足以轻松捕获，但最终足以将我们的主服务器 IP 列入黑名单。由于主 IP 被列入黑名单，我们的许多其他网站（我们也为其托管电子邮件）也被列入黑名单。

我的论点（非常感谢您对此的评论/想法！）

1.  更改为 SMTP 不会解决此实例
    *   它将解决任何易受攻击的组件的问题，其中可以通过请求欺骗发送电子邮件（即 option=com_users?task=email&...，或类似的东西）
2.  因为黑客可以访问帐户中的文件，所以他们也可以访问 configuration.php 文件，该文件以纯文本形式保存 SMTP 密码。访问这意味着他们也可以访问 SMTP 服务器。
3.  我们将使用的 SMTP 是 localhost，这并不能解决我们的 IP 被列入黑名单的问题。
    *   我的第一个想法是在单独的 IP（或服务器）上配置/设置 SMTP，但如果网站被黑客入侵，它仍然可以被列入黑名单。
    *   第二个想法是为每个站点提供一个唯一的 IP，这样没有一个站点可以将其余站点列入黑名单。

所以我有点失落。在我们处理将邮件功能设置为 SMTP 的任务之前，测试每个站点（大约有 70 个，要测试不同的组件）我想更好地了解什么是最好的路线，如果有的话。

如果网站遭到入侵，Joomla 中的任一设置似乎都不安全，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:19:57.563

1.  找到您的服务器被列入黑名单的位置，并申请移除。注意：如果任何网站需要付款才能下架，请忽略它们。[例如：SORBS] 没有人关心敲诈勒索者，相信我。在过去的几年里，我是几个繁忙的邮件服务器的管理员。
2.  如果您`mail()`在所有站点上完全从基于 PHP 的切换，则禁用服务器上的邮件代理。`mail()`只需提交到服务器上运行的 MTA [通常是 Sendmail 或 Postfix]，如果您的服务器再次受到攻击，他们仍然可以发送垃圾邮件。
3.  是的，您的 SMTP 凭据将存储在某个配置文件中，但大多数情况下，入侵者甚至不会费心去寻找它们。他们只需放入一个基本的 PHP 脚本即可调用`mail()`，仅此而已。
4.  如果邮件服务对您来说很重要，您应该始终监控：
    1.  [您的出站服务器的声誉。](http://multirbl.valli.org/)
    2.  您的域的滥用邮件。它要么发送至 abuse@yourdomain.com，要么发送至拥有 IP 地址块的任何人的滥用@联系人。

# android - 退出 onPreviewFrame 并通知用户

> ID：14857026
> 
> 赞同：1
> 
> 时间：2013-02-13T15:30:21.243
> 
> 标签：android

我正在`onPreviewFrame(byte[] data, Camera camera)`Android上工作。在 onPreviewFrame 中我做了一些图像处理。在 onPreviewFrame 内的某个点，我想停止预览（我通过 if 语句知道这一点）并播放声音 - 也许是电话铃声。我认为您无法在预览中播放声音。

如何退出 onPreviewFrame 以及在哪里添加播放声音的代码？

是在 Surface Destroyed 上吗？

这是我的代码：

```
public class MyCameraPreview extends Activity {    
private Preview mPreview;
     public TextView results;

    @Override
            protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Hide the window title.
        requestWindowFeature(Window.FEATURE_NO_TITLE);

        // Create our Preview view and set it as the content of our activity.
        mPreview = new Preview(this);
        setContentView(mPreview);

   }
}

class Preview extends SurfaceView implements SurfaceHolder.Callback, PreviewCallback {   

    SurfaceHolder mHolder;   
    Camera mCamera;   
    public TextView results;
    public TextView txt;
    private Parameters parameters;   
    //this variable stores the camera preview size    
    private Size previewSize;   
    //this array stores the pixels as hexadecimal pairs    
    private int[] pixels;   
    public int[] argb8888;

    Preview(Context context) {   
        super(context);   
        // Install a SurfaceHolder.Callback so we get notified when the   
        // underlying surface is created and destroyed.   
        mHolder = getHolder();   
        mHolder.addCallback(this);   
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);   
   }   

    public void surfaceCreated(SurfaceHolder holder) {   
        // The Surface has been created, acquire the camera and tell it where   
        // to draw.   
        mCamera = Camera.open();   
        try {   
           mCamera.setPreviewDisplay(holder);   

           //sets the camera callback to be the one defined in this class   
           mCamera.setPreviewCallback(this);

           parameters = mCamera.getParameters();   
           parameters.setZoom(parameters.getMaxZoom());
           mCamera.setParameters(parameters);
           parameters = mCamera.getParameters();
           previewSize = parameters.getPreviewSize();   
           pixels = new int[previewSize.width * previewSize.height]; 

        } catch (IOException exception) {   
            mCamera.release();   
            mCamera = null;   
            // TODO: add more exception handling logic here   
        }   
    }   

    public void surfaceDestroyed(SurfaceHolder holder) {   
        // Surface will be destroyed when we return, so stop the preview.   
        // Because the CameraDevice object is not a shared resource, it's very   
        // important to release it when the activity is paused.   

        mCamera.stopPreview();   
        mCamera.release();   
        mCamera = null;

    }   

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {   
        // Now that the size is known, set up the camera parameters and begin   
        // the preview.   
        parameters.setPreviewSize(w, h);   
        //set the camera's settings   
        mCamera.setParameters(parameters);   
        mCamera.startPreview();

    }   

    @Override  
    public void onPreviewFrame(byte[] data, Camera camera) {   

Do some image processing.

If condition == true {

Exit the preview and then play the ringtone and exit the application.

}   

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:56:03.747

在预览中，您可以添加侦听器的定义并使用它来不在预览中添加声音。

像这样的东西：

```
public static interface OnPreviewListener {
    void onImageMakeSound();
}

public void setListener(OnPreviewListener listener) {
        this.listener = listener;
} 
```

然后在您的 onPreviewFrame 方法中：

```
@Override
public void onPreviewFrame(byte[] data, Camera camera) {
    if (countFrame  > 5) { 
        imageBytes = data;
        countFrame = 0;
        if (listener != null)
            listener.onImageMakeSound();
    }
    countFrame++;
    camera.addCallbackBuffer(data);
    return;
} 
```

在您的活动中，必须实现**OnPreviewListener**：

```
 @Override
    public void onImageMakeSound() {
        alarmSoundOn();

    } 
```

# csh - 异常使用 csh 尾部

> ID：14857030
> 
> 赞同：0
> 
> 时间：2013-02-13T15:30:33.190
> 
> 标签：csh, tail

请你帮帮我，我正在尝试从文件末尾删除一些数据，比如 file.oot。

我想使用 tail 命令，返回除最后 n 行之外的所有内容。我想将此限制为作为 csh 脚本的一部分的单行命令。有没有办法用 tail 命令做到这一点，如果没有，还有其他选择吗？

返回相反的命令：

```
tail -10 file.oot > new_file.oot 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:42:32.180

看来我是从错误的方向（字面意思）接近这个，应该使用 head. 使用以下代码可以实现我的目标。

```
head -n -10 file.oot > new_file.oot 
```

# wordpress - 类别页面上的 Woocommerce 菜单

> ID：14857033
> 
> 赞同：0
> 
> 时间：2013-02-13T15:30:38.887
> 
> 标签：wordpress, menu, woocommerce

我正在为 Woocommerce 网上商店创建一个独特的设计，但遇到了问题。我希望最终用户能够添加类别并在这些创建的页面上添加自定义菜单。你们中的任何人都有一个绝妙的主意如何做到这一点？我想我会将页面的 wp_title() 放在一个变量中，并将菜单的代码放在我的类别页面模板上，并使用该变量，但这似乎不是解决方案。有什么绝妙的想法吗？

额外信息：我自己的解决方案永远无法工作的原因是因为您无法在 functions.php 中使用变量名注册菜单..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:16:19.150

最简单的方法是创建导航所需的页面，然后将 WooCommerce 短代码添加到页面。

[product_category category="example" per_page="12" columns="4" orderby="date" order="desc"]

# java - 测试类（JAVA）

> ID：14857034
> 
> 赞同：-2
> 
> 时间：2013-02-13T15:30:38.777
> 
> 标签：java, unit-testing

我目前正在学习Java。我刚刚学习了单元测试的基础知识等等。单元测试的主要目的是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:42:51.103

确保您编写的代码符合您的预期

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T15:47:19.710

单元测试的主要目的是确保代码单元按预期工作。例如，如果您有一个应该始终返回 1 的方法，您可以使用它进行测试。

```
interface One {
  int alwaysOne();
}

class OneTest {
   One one = new OneImpl(); //You can implement OneImpl as an exercise
   @Test
   public void testAlwaysOne() {
     assertEquals("Should ALWAYS return 1", 1, one.alwaysOne());
   }
 } 
```

现在你运行你的测试，你得到了绿灯。`alwaysOne()`当您的项目进一步移动并围绕代码进行时，您可以根据以特定方式运行的假设进行工作。如果有一天另一位开发人员决定更改 OneImpl，他将运行测试并失败，因此知道他破坏了某些东西。

我建议你阅读一些关于 junit 的教程（[Lars Vogel 的](http://www.vogella.com/articles/JUnit/article.html#junit_intro)还不错）

# html - 带有子菜单 twitterbootstrap 的 btn 组

> ID：14857035
> 
> 赞同：3
> 
> 时间：2013-02-13T15:30:41.393
> 
> 标签：html, css, button, twitter-bootstrap

我想知道如何建立一个带有子菜单的 btn 组。

```
<div class="btn-group">
  <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
    Action
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu">
    <!-- dropdown menu links -->
  </ul>
</div> 
```

我喜欢把它放在 btn 组中：

```
<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
  ...
  <li class="dropdown-submenu">
    <a tabindex="-1" href="#">More options</a>
    <ul class="dropdown-menu">
      ...
    </ul>
  </li>
</ul> 
```

这就是我想要的：（但使用 twiiter-bootstrap） ![这就是我要的](../Images/4b9351bf6235a2517db28037419b19ac.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:59:16.587

说明：基本上这个btn可以去任何地方，我只是把它放在一个按钮组中，以表明这个按钮没有什么特别之处。

因此，首先，您想将 data-toggle= 下拉菜单添加到您的按钮。然后，您需要将标准下拉菜单添加到按钮。我想这里的关键是知道没有什么可以阻止您将第二个下拉菜单添加到子菜单中。

因此，请先将子菜单添加到您想要的任何 < li > 中，然后在其中添加另一个下拉菜单。所以本质上我们有 Button -> 下拉菜单 -> 下拉子菜单 -> 下拉菜单 -> 子元素。我认为有点令人困惑但很直截了当

```
<div class="btn-toolbar">
<div class="btn-group">

    <div class="btn-group">
      <!--start of dropdown button -->
      <button class="btn dropdown-toggle" data-toggle="dropdown">Dropdown Button <span class="caret"></span></button>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
         <li class="dropdown-submenu">
           <a tabindex="-1" href="#">More options</a>
           <ul class="dropdown-menu">
                <li><a tabindex="-1" href="#">Regular link</a></li>
                <li><a tabindex="-1" href="#">Regular link</a></li>
                <li><a tabindex="-1" href="#">Regular link</a></li>
           </ul>
         </li>
     </ul>
    </div>
    <!--end of dropdown button -->
    <button class="btn">Middle</button>
    <button class="btn">Right</button>
</div>
</div> 
```

# 编辑：

在玩了这个之后，我意识到你确实需要

```
<div class="btn-group"> 
```

包装按钮，即使它只是独立的。我创建了这个更新的小提琴来演示它。
[http://jsfiddle.net/jamiematthews/yWrRA/1/](http://jsfiddle.net/jamiematthews/yWrRA/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:58:29.983

进行了一些实验，但这是你如何去做的：

[http://jsfiddle.net/ewQTE/2/](http://jsfiddle.net/ewQTE/2/)

```
<div class="btn-toolbar">
<div class="btn-group">

    <div class="btn-group">
      <button class="btn dropdown-toggle" data-toggle="dropdown">Left <span class="caret"></span></button>
      <ul class="dropdown-menu">
          <li><a href="#">Dropwn Link #1</a></li>
          <li><a href="#">Dropwn Link #2</a></li>
      </ul>
    </div>

    <button class="btn">Middle</button>
    <button class="btn">Right</button>
</div>
</div> 
```

# php - PHP SQLSRV排序与准备语句的参数

> ID：14857039
> 
> 赞同：2
> 
> 时间：2013-02-13T15:30:44.737
> 
> 标签：php, sql, sorting, prepared-statement

只要我不使用 $sort 作为传入参数，我就无法弄清楚为什么排序会起作用。下面的示例将用于排序：

```
$sort = "quantity desc";

$sql = " with items as (
SELECT i.[item_id]
,i.[name]
,i.[value]
,i.[quantity]
,i.[available]
,isnull(r.awarded, 0) as awarded
, ROW_NUMBER() OVER(
  ORDER BY $sort
) rowNumber 
FROM [Intranet].[dbo].[Goodwell_Item] i
LEFT JOIN (
SELECT r.item_id
, COUNT(1) awarded 
from [Intranet].[dbo].[Goodwell_Reward] r
group by r.item_id
) as r
ON i.item_id = r.item_id
)
SELECT * 
FROM items 
WHERE rowNumber BETWEEN (?) and (?)
and ( (?) = '' OR (available = (?)))
";

$params = array( $pagify['startFrom'], $end, $available, $available );

$stmt = sqlsrv_query( $conn, $sql, $params ); 
```

但是，如果我将使用 ORDER BY 的行更改为：

```
ORDER BY (?) 
```

并将其添加到我的 $params 中，如下所示：

```
$params = array($sort, $pagify['startFrom'], $end, $available, $available ); 
```

然后由于某种原因排序被忽略。

请告诉我如何让排序以不允许 SQL 注入的方式工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-04T21:19:54.037

我现在正在处理这个确切的问题，在网上找不到任何帮助。

我努力了：

```
 $query = "SELECT * FROM {$this->view} WHERE SeriesID = ? ORDER BY ? ";
 $result = $conn->getData($query, array($seriesID,$sortBy)); 
```

和

```
$query = "SELECT * FROM {$this->view} WHERE SeriesID = ? ORDER BY ? ?";
$result = $conn->getData($query, array($seriesID,$sortBy,$sortOrder)); 
```

在这两种情况下，我都没有错误，也没有结果。

我认为安全解决这个问题的唯一方法是在查询之前使用 switch 语句来手动验证可接受的值。但是，除非您只处理一个表，否则您无法知道 SortBy 列的可能值是什么。

但是，如果您只是假设此时的值已经被清除，您可以使用非参数化版本，如下所示：

```
 $query = "SELECT * FROM {$this->view} WHERE SeriesID = ? ORDER BY " . $sortBy . " " . $sortOrder;
 $result = $conn->getData($query, array($seriesID)); 
```

我打算做的是确保在将 sortBy 和 sortOrder 传递给包含此代码的方法之前对其进行验证。通过这样做，我调用代码的每个地方都负责在发送数据之前验证数据。调用代码将知道它正在调用的表（或本例中的视图）的有效可能值。（在这种情况下，我是两段代码的作者，所以我知道它是安全的。）

所以，简而言之，只要确保代码中此时的值已经被清理和安全，并将该责任推到调用此代码的代码的上一级。

# c# - 字节[] 到 ushort[]

> ID：14857044
> 
> 赞同：10
> 
> 时间：2013-02-13T15:30:54.407
> 
> 标签：c#, bytebuffer, data-conversion, ushort

这是我的问题。请耐心等待我做一点解释：

我正在将 tiff 图像读入缓冲区；我的 tiff 的每个像素都由一个 ushort（16 位数据，非负数）表示。

我的图像大小为 64*64 = 4096。当我的 tiff 加载到缓冲区时，缓冲区长度因此为 8192（是 4096 的两倍）。我猜这是因为在我的缓冲区中，计算机使用 2 个字节来存储单个像素值。

我想获取任何特定像素的值，在这种情况下，我应该将每 2 个字节组合成 1 个 ushort 吗？

例如：00000000 11111111 -> 0000000011111111？

这是我的代码：

```
public static void LoadTIFF(string fileName, int pxlIdx, ref int pxlValue)
        {
            using (Tiff image = Tiff.Open(fileName, "r"))
            {
                if (image == null)
                    return;

                FieldValue[] value = image.GetField(TiffTag.IMAGEWIDTH);
                int width = value[0].ToInt();

                byte[] buffer = new byte[image.StripSize()];
                for (int strip = 0; strip < image.NumberOfStrips(); strip++)
                    image.ReadEncodedStrip(strip, buffer, 0, -1);

                // do conversion here:
                //ushort bufferHex = BitConverter.ToUInt16(buffer, 0);            

                image.Close();

            }
        } 
```

如何读取 byte[] 缓冲区以确保我可以获得 16 位 ushort 像素值？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T15:34:42.793

由于每个像素都表示为 16 位，从编程的角度来看，将 表示为长度的一半可能*更方便*，但这不是必需的。`byte[]``ushort[]`

最佳解决方案取决于您希望如何使用缓冲区。

你可以很容易地定义一个辅助方法

```
ushort GetImageDataAtLocation(int x, int y) 
{ 
    offset = y * HEIGHT + x;
    return BitConverter.ToUInt16(buffer, offset);
} 
```

它使用输入坐标来确定原始偏移量`byte[]`并返回`ushort`由适当字节组成的 a。

如果 TIFF 存储数据大端且您的系统是小端，则您必须在转换之前反转字节顺序。一种方法是：

```
ushort GetImageDataAtLocation(int x, int y) 
{ 
    offset = y * HEIGHT + x;
    // Switch endianness e.g. TIFF is big-endian, host system is little-endian
    ushort result = ((ushort)buffer[0]) << 8 + buffer[1];
    return result;
} 
```

如果您的代码可能曾经在具有不同字节序的平台上运行（英特尔和 AMD 都是小字节序），您可以使用在运行时确定字节序

[BitConverter.IsLittleEndian](http://msdn.microsoft.com/en-us/library/system.bitconverter.islittleendian.aspx)

有关 BitConverter 的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/system.bitconverter.touint16.aspx](http://msdn.microsoft.com/en-us/library/system.bitconverter.touint16.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:37:15.913

您需要循环执行：`BitConverter.ToUInt16()`占用 2 个字节，将它们转换为一个 ushort。

警告：正如 Eric 指出的那样，它存在字节顺序问题（它总是假定它正在执行的平台的字节顺序）。仅当您确定源字节流是在具有相同字节顺序的机器上生成时才使用 Bitconverter（对于 TIFF 图像，您可能无法假设它）。

您可以使用一些 LINQ... 例如这里有一个不错[的](https://stackoverflow.com/a/3524511/863564)`Chuncks`功能。您可以将其用作：

```
rawBytes.Chunks(2).Select(b => BitConverter.ToUInt16(b)).toArray() 
```

# prolog - SWI-Prolog 中的方程求解器

> ID：14857045
> 
> 赞同：2
> 
> 时间：2013-02-13T15:30:55.793
> 
> 标签：prolog, clpq

我想写一个程序`SWI-Prolog`来解决方程。我知道`GNU Prolog`，这让我很紧张......这里有什么问题？

```
equation(X1,X2) :-
  {
    2*X1 + 3*X2 =:= 6,
    {X1 is 0; X1 is 1},
    {X2 is 0; X2 is 1}
  }. 
```

`X1`并且`X2`总是等于`0`or `1`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T18:20:29.843

我有一个文件

```
:- [library(clpq)].
eq(X1, X2) :- {2 * X1 + 3 * X2 =:= 6}. 
```

然后我编译并运行，我得到：

```
?- eq(A,B).
{B=2-2 rdiv 3*A}. 
```

这是你期待的结果？

*编辑*

```
?- eq(A,B),A=1.
A = 1,
B = 4 rdiv 3.

?- eq(A,B),B=1.
A = 3 rdiv 2,
B = 1. 
```

[文档](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.8%27,swi%28%27/doc/Manual/clpqr.html%27%29%29)的第 A.8.3 节说统一可以保持“外部”约束规范。然后你可以自由地尝试额外的边界。但是，如果您强制要求 A 和 B 都绑定，则应选择适当的值。AFAIK 您最初发布的值不能满足等式。

# domain-driven-design - DDD 中的计划任务

> ID：14857053
> 
> 赞同：2
> 
> 时间：2013-02-13T15:31:13.543
> 
> 标签：domain-driven-design, scheduled-tasks

我有一个名为**Order**的实体，以及一个聚合根**OrderManager**，它根据来自应用层的请求更新订单状态和一些其他信息（AppLayer 调用 OrderManager，OrderManager 管理包括订单在内的内部状态）。

每个订单都有到期时间，所以我想安排一个操作来处​​理到期。我不知道该放在哪里。我想到了两种方法：

1.  在域模型中定义一个接口 IScheduler。所以 OrderManager 使用这个接口来进行任务调度。
2.  不要定义接口，而是在应用程序级别安排过期处理。这意味着应用层调用了一些方法，比如 OrderManager.HandleExpiration

我个人更喜欢第一种方法，但也许有人有其他想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T18:24:27.990

首先，**Order**实体应该是**Order**聚合的聚合根。它应该封装状态改变行为，这样就不需要管理器类。然后，应用程序服务将直接委托给**Order**实体。

至于处理订单到期，必须考虑一些事情。这些都需要坚持吗？换句话说，是否会有订单被持久化到数据库中并且没有加载到应用程序中，需要处理哪些过期？如果是这样，那么您需要实现一个超出应用程序边界的工作流。一种方法是使用一个持续运行的后台服务来轮询数据库以获取在当前时间到期的订单。然后它向处理订单到期事件的handled 发送一个命令。此处理程序将委托回您的域，最终委托给**Order上的****HandleExpiration**方法**实体。订单到期只是一个事件，像任何其他域事件一样处理，后台服务只是使该事件成为可能的基础设施的一部分。这似乎最适合您的方法#2。**

# html - 从逗号分隔的文本文件填充下拉菜单

> ID：14857054
> 
> 赞同：1
> 
> 时间：2013-02-13T15:31:14.203
> 
> 标签：html, jquery

我正在尝试`HTML`从位于服务器上的文本文件中填充选择列表。该文件设置如下：

```
ttt1111,John Doe
xxx2222,Jane Doe
etc.... 
```

第一列是 the `<option value="">`，第二列是显示的文本。我读入文件，然后按每一行将其拆分为一个数组。我在尝试找出使用这两个值创建正确附加行的代码时遇到了麻烦。

我对此非常陌生，因此任何帮助都将受到赞赏，即使只是指向示例的链接。到目前为止，这是我的代码，但它只是将整行分配给值和文本输出。

```
function PopulateSupervisorList() {
    var Suplist=[];
    var SupervisorFile="text.txt";
    var DDL = $("#iSupervisor");
    var SuperID=[];
    $.get(SupervisorFile,function(data) {
        Suplist = data.responseText.split("\n");
        for (var i=0; i < Suplist.length; i++) {
            DDL.append("<option value='" + SuperID[i] + "'>" + Suplist[i] + "</option>")
        }   
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:41:08.137

您必须将每一行拆分为列

试试这个

```
function PopulateSupervisorList() {
    var SupervisorFile="text.txt";
    var DDL = $("#iSupervisor");
    $.get(SupervisorFile,function(data) {
        var suplist = data.responseText.split("\n"),
            cols;

        for (var i=0, len=suplist.length; i<len; i++) {
            cols = suplist[i].split(','); //split the line in columns
                                          //so  cols[0] -> ttt1111
                                          //and cols[1] -> John Doe
                                          //and so on for the rest lines
            DDL.append("<option value='" + cols[0] + "'>" + cols[1] + "</option>");
        }   
    });
} 
```

# java - OpenGL中的颜色不透明度

> ID：14857059
> 
> 赞同：0
> 
> 时间：2013-02-13T15:31:57.103
> 
> 标签：java, opengl-es, colors

我想知道如何在 OpenGL 中的对象上打印部分颜色。我的意思是，我希望能够编辑该颜色的不透明度级别，但我不知道该怎么做。我唯一知道的是如何设置整个纹理的不透明度：

```
gl.glColor4f(red, green, blue, **opacity**); 
```

但是有了这个功能，我将纹理变成透明的，我只想编辑我给它的颜色级别。

有小费吗？我在 Android 上使用 OpenGL-ES。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:46:09.947

我可以考虑这样做的一种方法，但是在将纹理传递给 OpenGL 之前需要在 CPU 中进行一些预渲染，那就是拥有 32 位纹理，然后在您构建的例程中，当您引入颜色参数时如果您想设置它的不透明度，您只需运行一个循环来检查该特定颜色，并将其 alpha 分量设置为您想要的任何值。

```
// Algorithm Only
void setOpacityOfColor(char r, char g, char b, char opacToSet, RGBAType image[][]){

    for(int x = 0; x < image.width; x++){
        for(int y = 0; y < image.height; y++){
            if(image[x][y].r == r && image[x][y].g == g && image[x][y].b == b{
                image.alpha = opacToSet;
            }
        }
    }

} 
```

如果我真正理解您的问题，我认为这是正确的。

这样做的好处是，如果您以后想将其设置回不透明，它会保留原始颜色。如果你真的想完全改变颜色，你也可以这样做，它看起来更像如下：

```
// Algorithm Only
void setOpacityOfColor(char r, char g, char b, char newR, char newG, char newB, RGBAType image[][]){

    for(int x = 0; x < image.width; x++){
        for(int y = 0; y < image.height; y++){
            if(image[x][y].r == r && image[x][y].g == g && image[x][y].b == b{
                image.r = newR;
                image.g = newG;
                image.b = newB;
            }
        }
    }

} 
```

# android - Android 应用的初始配置

> ID：14857070
> 
> 赞同：2
> 
> 时间：2013-02-13T15:32:38.373
> 
> 标签：android, google-play

是否可以通过 Google Play 链接（可能作为`Intent`）在第一个应用程序运行时将一些数据传递给应用程序。

我设想的场景是这样的：

1.  我在市场上为特殊客户（促销等）分享了我的应用程序的特殊 URL
2.  他们下载应用程序，安装应用程序。
3.  在第一次运行时，我可以以某种方式提取我放在 url 上的数据
4.  魔术发生

**当前解决方案**

我目前对这个问题的解决方案是向市场发送一个通用链接，并有第二个 url，他们点击我的应用程序有一个`intent-filter`. 我真的很想只有一个网址供人们点击。

**想法**

我考虑过的另一种方法是让链接转到我的服务器，保存一些有关 HTTP 请求的唯一信息，然后尝试在第一个应用程序运行时将该信息与 Web 请求相关联，但这似乎很容易出错（IP 是在 NAT 后面的 Wi-Fi 上不是唯一的，用户代理不匹配......）。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:48:34.550

搜索`com.android.vending.INSTALL_REFERRER`意图。例如，[这个来源说：](http://gyurigrell.com/2012/2/21/tracking-install-sources-android-apps)

> 从 Android 1.6 开始，只要将某些参数添加到市场 url，Android 市场就会发出一个名为 com.android.vending.INSTALL_REFERRER 的广播 Intent。请注意，Web 版本的 Market 也会在安装时将这些参数传递给您的设备。

我不知道这是多么最新或得到很好的支持，但这听起来像你想要的。

# list - 构建应用程序后，sencha touch list 不起作用

> ID：14857075
> 
> 赞同：1
> 
> 时间：2013-02-13T15:32:59.937
> 
> 标签：list, extjs, build, sencha-touch, touch

我确定我遗漏了一些东西，但我不明白为什么在调试模式下完美运行的列表不会在生产中显示。

一些细节：
- 列表在 Ext.navigation.View 内
- 列表必须显示来自另一个列表的 itemtap 事件过滤
的存储 - 存储从远程 json 读取
- 构建用于 web 应用

这是我用来更新列表的代码：

```
listUpdate: function() {
    console.log("sections_list update " + this.section);
    section = this.section;

    this.setStore(Ext.getStore('sections_remote'));

    this.getStore().setFilters([function(item) {
        return item.get('section')==section
    }]);

    this.getStore().load({
        callback: function(records, operation, success) {
            console.log("sections_list loaded "+records.length);
            this.refresh();
        },
        scope: this
    });
} 
```

加载后，records.length 始终是总长度，而不是过滤记录的数量，但在调试版本中，列表仅显示过滤记录，而在生产中不显示任何内容。

有任何想法吗？

在此先感谢，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T13:08:03.057

我刚刚输入了所有的分号，现在它可以工作了。谢谢

# java - 如何在 TextField Java 中限制字符和数值

> ID：14857076
> 
> 赞同：2
> 
> 时间：2013-02-13T15:33:01.623
> 
> 标签：java, swing, validation, jtextfield

我有两个关于字符和数值限制的问题。我正在听焦点丢失事件并验证名称（字符）和联系人（数字）文本字段。

**1.**如何限制数字数据少于 3 位，不允许超过 13 位。

以下是我的数字联系人 TextField 的编码：

```
private void txt_contactFocusLost(java.awt.event.FocusEvent evt) {
    if (txt_contact.getText().equals("")) {
    } else {
        String contact = txt_contact.getText();
        Pattern pt6 = Pattern
                .compile("^[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]+$");
        Matcher mh6 = pt6.matcher(contact);
        boolean matchFound6 = mh6.matches();
        if (!(matchFound6)) {
            JOptionPane.showMessageDialog(null,
                    "* Enter the Numaric Values only *");
            txt_contact.setText("");
            txt_contact.requestFocus();
        }
    }
} 
```

**2.**如何限制字符数据少于 3 个字符，不允许超过 30 个字符。

```
private void txt_nameFocusLost(java.awt.event.FocusEvent evt) {
    if (txt_name.getText().equals("")) {
        error2.setText("Enter Full Name");
        txt_name.setText("");
    } else {
        String name = txt_name.getText();
        Pattern pt1 = Pattern.compile("^[a-zA-Z]+([\\s][a-zA-Z]+)*$");
        Matcher mh1 = pt1.matcher(name);
        boolean matchFound1 = mh1.matches();
        if (!(matchFound1)) {
            JOptionPane.showMessageDialog(null,
                    "* Enter the Character Values only *");
            txt_name.setText("");
            txt_name.requestFocus();
        } else {
            error2.setText("");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:46:25.330

你可以做一些更简单的事情：

```
NumberFormat numF = NumberFormat.getNumberInstance(); 
numF.setMaximumIntegerDigits(13);
numF.setMinimumIntegerDigits(3);
JFormattedTextField THE_FIELD = new JFormattedTextField(numF); 
```

（*字符*的相同想法）

现在，只允许使用具有指定长度**范围的****数字**。

 **阅读有关它的更多信息：[NumberFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/NumberFormat.html)和[JFormattedTextField](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JFormattedTextField.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:44:32.443

在模式中，您可以使用语句`{n,m} n- to m- times`

为此，您可以像这样构建您的模式

用于您的字符比较

```
Pattern pt6=Pattern.compile("[a-zA-Z]{3,30}"); // it says, it should be 3-30 non Digits 
```

对于数字

```
Pattern pt6=Pattern.compile("\\d{3,13}"); // it says, it should be 3-13 Digits 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:42:36.297

对于字符串

```
public boolean validateString(String data){
        char [] chars = data.toCharArray();
        if(chars.length < 3 || chars.length >13)
            return false;
        return true;
} 
```

对于号码

```
public boolean validateNumber(int number){
        String data = number+"";
        return validateString(data);    
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-19T05:06:07.670

我正在使用这个。非常简单和容易使用您需要的方法，或者两者都调用，然后在您需要的地方调用您的 JTextField 作为参数完成...

```
public static void setNumericOnly(JTextField jTextField){
    jTextField.addKeyListener(new KeyAdapter() {
         public void keyTyped(KeyEvent e) {
           char c = e.getKeyChar();
           if ((!Character.isDigit(c) ||
              (c == KeyEvent.VK_BACK_SPACE) ||
              (c == KeyEvent.VK_DELETE))) {
                e.consume();
              }
         }
    });
}

public static void setCharacterOnly(JTextField jTextField){
    jTextField.addKeyListener(new KeyAdapter() {
         public void keyTyped(KeyEvent e) {
           char c = e.getKeyChar();
           if ((Character.isDigit(c) ||
              (c == KeyEvent.VK_BACK_SPACE) ||
              (c == KeyEvent.VK_DELETE))) {
                e.consume();
              }
         }
    });
} 
```**

# mobile - OData 实体设计：查询的附加字段

> ID：14857077
> 
> 赞同：2
> 
> 时间：2013-02-13T15:33:07.080
> 
> 标签：mobile, odata, ado.net-entity-data-model

我们目前正在设计将由移动应用程序使用的符合 OData 的实体数据模型。团队分为两个；提供 OData 服务的后端开发人员和使用这些服务的前端开发人员。

前端和后端开发人员之间的分歧之一是关于我们主要实体的设计。从**前端的角度来看**，它应该是这样的：

```
Order:
Order ID
Order Type
Assigned To
Customer ID
Price
Currency
etc... 
```

将使用以下 URL 查询 Order 对象：

```
http://SERVICE_ROOT_URL/Orders?$filter=Order_Type eq 'Inquiry' or Order_Type eq 'Quotation'
http://SERVICE_ROOT_URL/Orders?$filter=Order_Type eq 'Inquiry' and Assigned_To eq 'James7' 
```

**后端开发人员**愿意为 Order 实体添加一个新字段，并使用该字段来了解用户正在查询的内容。让我们将这个新字段命名为`Request Code`。使用请求代码字段，查询将如下所示：

```
http://SERVICE_ROOT_URL/Orders?$filter=Request_Code eq '0022' // The orders requiring approval and the current user can approve them
http://SERVICE_ROOT_URL/Orders?$filter=Request_Code eq '0027' // The orders with the open status 
```

基本上，`Request Code`它不是实体的实际部分，而是人造的。它只是增加了一些智能，以便后端的查询变得更容易。这样，后端将仅支持具有此请求代码的那些查询。也计划在更新场景中使用，在更新实体时`Request Code`，前端预计会通过。这样，后端将通过查看请求代码来知道要更新哪些字段。`Request Code``Order`

我在前端，我认为不`Request Code`应该包含在模型中。它使设计加密并消除了 OData 服务的简单性。除了让后端的事情变得更容易之外，我也没有看到任何附加价值。

这是 OData 服务设计中的常见做法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T18:05:29.637

对我来说，这个额外的属性是不合适的。它在 OData 之上增加了一层额外的语义；这需要额外的理解和额外的编码来处理。它只会增加[*意外的复杂性*](http://en.wikipedia.org/wiki/Accidental_complexity)，它会将后端*实现细节*泄漏到其公共 API。

OData 查询接口应该足以描述大多数情况。当这还不够时，您可以创建[服务操作](http://www.odata.org/documentation/operations#InvokingServiceOperations)来描述额外的业务语义。

因此，例如，这个：

```
/Orders?$filter=Request_Code eq '0022' // The orders requiring approval and the current user can approve them
/Orders?$filter=Request_Code eq '0027' // The orders with the open status 
```

可以变成这样：

```
/GetOrdersRequiringApprovalFromUser
/GetOpenOrders 
```

此外，对于更新逻辑，OData 已经支持[更新单个属性](http://www.odata.org/documentation/operations#Updatingindividualproperties)。

因此，总而言之，不要在 OData 之上发明另一个协议。使用它提供的东西。

# groovy - Gradle - 我可以使用约定属性管理任务依赖关系吗？

> ID：14857078
> 
> 赞同：0
> 
> 时间：2013-02-13T15:33:06.397
> 
> 标签：groovy, gradle

我正在使用 Gradle 作为我的项目的构建系统。如果给定属性设置为“true”，我想要的是使任务 A 依赖于任务 B。这是可行的，如果答案是肯定的，我该怎么做？

目前，我正在使用约定映射，但这似乎不起作用。我的代码如下所示：

```
MyTask.conventionMapping.propertyName = { MyPluginConvention.propertyName }

if (MyTask.propertyName.equals("true")) {
    MyTask.dependsOn ...
} 
```

在此先感谢，马林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T10:58:48.753

您必须使用它们的*实例*，而不是使用任务/约定类。此外，您必须推迟决定是否添加任务依赖项。例如：

```
def myTask = project.tasks.create("myTask", MyTask)
def otherTask = ...
def myConvention = new MyConvention()    
...
myTask.conventionMapping.propertyName = { myConvention.propertyName }
// defer decision whether to depend on 'otherTask'
myTask.dependsOn { myTask.propertyName == "true" ? otherTask : [] } 
```

如果范围内没有任务变量，您还可以通过`project.myTask`或引用现有任务`project.tasks["myTask"]`。

PS：约定对象已在很大程度上被[扩展对象](http://gradle.org/docs/current/userguide/userguide_single.html#N1561E)所取代。

# php - file_exists() 期望参数 1 是有效路径，给定字符串

> ID：14857080
> 
> 赞同：11
> 
> 时间：2013-02-13T15:33:16.997
> 
> 标签：php

我正在设计一个 Web 应用程序，可以根据最终用户来自的零售地点进行定制。例如，如果用户来自一家名为 Farmer's Market 的商店，则该用户可能会获得特定于该特定商店的定制内容或额外链接。file_exists() 用于确定是否需要导入页面的任何自定义部分。

到目前为止，我们一直在使用一种相对不安全的方法，其中项目 ID# 和商店只是作为 GET 参数传入，系统知道将它们应用于页面中的每个链接。但是，我们正在切换到可逆哈希方法，其中存储和项目编号被加密（看起来像“gd651hd8h41dg0h81”），页面简单地对它们进行解码并分配存储和 ID 变量。

然而，从那以后，我们一直遇到一个错误，谷歌搜索广泛没有找到我的答案。有几个类似的代码块，但它们看起来都像这样：

```
$buttons_first = "../stores/" . $store . "/buttons_first.php";

if(file_exists($buttons_first))
{
    include($buttons_first);
} 
```

（/stores/ 目录实际上位于工作目录之上，因此是 ../）

非常坦率的。但是，尽管在传入常规 ID 和存储时工作正常，但使用加密的 ID 会为每个类似的语句引发此错误：

> 警告：file_exists() 期望参数 1 是有效路径，第 11 行 [url 已删除] 中给出的字符串

我已经让脚本返回了完整的 URL，并且它似乎正确地分配了 $store。我在 1&1 主机上运行 PHP 5.4.11（因为我知道他们的服务器工作方式有一些异常），如果这有帮助的话。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-04-09T09:09:57.633

我之前遇到过同样的错误，但我不知道我的这个解决方案是否适用于您的问题，您需要删除“\0”尝试替换它：

```
$cleaned = strval(str_replace("\0", "", $buttons_first)); 
```

它适用于我的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-22T02:28:09.707

运行 var_dump(strpos($buttons_first,"\0"))，出于安全原因，当路径具有空字节时，可能会出现此警告。如果这不起作用，请检查字符串的长度并确保它是您所期望的，以防万一还有其他不可见的字节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T15:37:08.217

路径可能有问题，因为它取决于您从哪里运行脚本。使用绝对路径更安全。要获取当前脚本正在执行的目录的路径，您可以使用`dirname(__FILE__)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T15:36:01.157

`/`之前添加`stores/`，你最好使用绝对路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-17T13:43:30.700

我知道这篇文章是在 2013 年创建的，但没有看到通用的解决方案。

`multiple`在添加到`file submit form` 例如您在 php 上使用这样的文件之后会发生此错误：`$_FILES['file']['tmp_name']` 但是在向`multiple`表单添加选项之后。你输入的名字变成了`file => file[]`

所以即使你只发布一个文件， `$_FILES['file']['tmp_name']`也应该改为`$_FILES['file']['tmp_name'][0]`

# iphone - OCUnit 测试用例问题

> ID：14857085
> 
> 赞同：1
> 
> 时间：2013-02-13T15:33:27.317
> 
> 标签：iphone, ipad

我正在工作 OCUnit 测试用例

```
- (NSDictionary*)Event:(EventBase*)event
{
    [self doesNotRecognizeSelector:_cmd];
    return nil;
} 
```

我找到了这种方法来编写测试用例

在我的测试用例类中，我为上述方法传递了事件值有效、无效和零

```
-(void)testEventNil{

NSDictionary *t_Dict;
EventClass *t_EventClass = [[EventClass alloc]init];
t_Dict = [t_EventClass Event:nil];
STAssertNil (t_Dict, @"Return nil");
} 

-(void)testEventNil{

NSDictionary *t_Dict;
NSMutableDictionary *invalid;
[invalid setObject:@"1324" forKey @"Number"];
EventClass *t_EventClass = [[EventClass alloc]init];
t_Dict = [t_EventClass Event:];
STAssertNil (t_Dict, @"Return nil");
} 

-(void)testEventvalid{

NSDictionary *t_Dict;
NSMutableDictionary *invalid;
[invalid setObject:@"WorkNameEvent" forKey @"EventNameKey"];
EventClass *t_EventClass = [[EventClass alloc]init];
t_Dict = [t_EventClass Event:];
STAssertNotNil (t_Dict, @"Return nil");
} 
```

它给了我错误无法识别的选择器发送到实例

任何人都可以建议我解决这个问题吗

@All 提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T18:27:02.977

您的代码有多个错误。我无法理解它。

您正在尝试测试一种旨在引发错误的方法。也许它打算被覆盖？现在唯一可能的测试是

```
EventClass *event = [EventClass new];
STAssertThrows([t_EventClass Event:nil],@"Should throw an error."); 
```

当您编写时：`t_Dict = [t_EventClass Event:];`您没有将任何参数传递给该`Event:`方法。

这也不起作用：

```
NSMutableDictionary *invalid;
[invalid setObject:@"WorkNameEvent" forKey @"EventNameKey"]; 
```

因为你没有初始化字典。那是，

```
NSMutableDictionary *invalid = [NSMutableDictionary new]; 
```

Objective-C 中的约定是使用驼峰式命名方法和变量，在本例中为`event:`,`Event:`和。`dic``t_Dic`

# 3d - Three.js：地面反射。这个怎么运作？

> ID：14857091
> 
> 赞同：7
> 
> 时间：2013-02-13T15:33:46.473
> 
> 标签：3d, three.js, render

我想要这样的东西。

[![](../Images/06e5f377d7e49dfdd6e08535161674dc.png)](https://i.stack.imgur.com/QvxhM.jpg)
[（来源：[pagenstecher.de](http://static.pagenstecher.de/uploads/7/7c/7c3/7c34/abt-sportsline-audi-rs-faked2.jpg)）]

我用cubeCamera尝试过，但它似乎只适用于立方体、球体等，但在一个平面上作为地面，上面有一个角色，反射看起来很破碎。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-27T07:13:12.767

1）将地板设置为半透明。`material.opacity = 0.5;`

2) 在地板正下方放置一面镜子。

*镜像示例*：[http ://threejs.org/examples/webgl_mirror.html](http://threejs.org/examples/webgl_mirror.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T19:01:18.660

一种伪造反射的简单方法是在半透明平面下复制对象。一个例子是[http://mrdoob.github.com/three.js/examples/webgl_geometry_text.html](http://mrdoob.github.com/three.js/examples/webgl_geometry_text.html)

# asp.net-mvc-3 - MVC3 中的选择列表

> ID：14857096
> 
> 赞同：0
> 
> 时间：2013-02-13T15:34:03.277
> 
> 标签：asp.net-mvc-3

我有一个 MVC3 页面，它必须在下拉列表中包含 Sex(male,female) 和 Role(admin,Operator)，在 RegisterViewModel 中我已经这样做了：

```
 public List<SelectListItem> SelectedItemForSex { get; set; }
    public List<SelectListItem> SelectedItemForRole { get; set; }
    public string SearchText { get; set; }
    public string SelectedValue { get; set; }
    //public string SelectedValueForRole { get; set; }

public static RegisterViewModel Get()
{
    var model = new RegisterViewModel { SelectedItemForSex = new List<SelectListItem>() };
    model.SelectedItemForSex.Add(new SelectListItem() { Text = "Male", Value = "1" });
    model.SelectedItemForSex.Add(new SelectListItem() { Text = "Femle", Value = "2" });

    model.SelectedItemForRole.Add(new SelectListItem() {Text = "Administrator", Value = "1"});
    model.SelectedItemForRole.Add(new SelectListItem() {Text = "Operator", Value = "2"});

    return model;
} 
```

在注册操作中，我有这个代码：

```
 public ActionResult Create()
        {
            var model = RegisterViewModel.Get();
            return View(model);
        } 
```

还有剃须刀：

```
 <div>
            @Html.LabelFor(register => register.Sex)
            @Html.DropDownListFor(register => register.SelectedValue, new SelectList(Model.SelectedItemForSex, "Value", "Text"))
        </div>
        <div>
            @Html.LabelFor(register => register.Role)
            @Html.DropDownListFor(register => register.SelectedValue, new SelectList(Model.SelectedItemForRole, "Value", "Text"))
        </div>
        <div> 
```

我知道我没有为管理员和操作员初始化 selectedListItem，我想通过 Get() 方法发送所有这 4 个值，我该怎么做？

# php - 加载完成后剪切图像

> ID：14857100
> 
> 赞同：2
> 
> 时间：2013-02-13T15:34:22.590
> 
> 标签：php, javascript, ajax, image, css

我用谷歌搜索了很多，但没有找到足够的答案。

我需要`900 X 5200 px`在我的一个页面中放置一张图片 ( )。由于图像很敏感，我需要防止用户复制图像。我有一个想法可以做到这一点：

我将图像分成几块。然后图像网格将被加载到一些 div 中。所以用户将无法保存图像。或者他/她将只保存整个图像的 1 平方厘米部分。

但是，如果电网的某些小部分无法加载，则此计划将不起作用。所以，我想做另一件事。我想加载完整的图像，然后将图像切割成部分。然后在 div 中完全显示这些部分。

这需要javascript。但我很困惑如何开始，需要你的帮助。

现在你知道了，如果你有更好的想法，请分享。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:40:26.253

诀窍很简单。创建一个 div，背景是您要显示的图像。在其上放置一个带有透明图像的 div。当用户去保存图像时，他们得到一个空白。对您的服务器进行编程，使其不返回对图像的“直接”请求（因此一些聪明的家伙不能只查看 css 并检索图像的 URL）。

当然，图像仍将在他们的缓存中，但切片图像也会如此，因此不会使有决心的人更难检索图片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:56:09.633

**TL;DR**不要过度设计解决方案，打印屏幕会绕过您所做的任何事情。

您将无法阻止人们复制此图像。干净利落。不管你付出多大的努力，一个简单的`PRT SCRN`粘贴到 Paint 中就足够了。

您最好的选择是不要过度设计它，只需在页面上放置水印和版权声明。其他选项可以包括在图像顶部放置一个透明`<div>`的，这样它就不能被右键单击和保存，但它仍然不会阻止图像存储在用户的缓存中。或者阻止他们使用开发人员工具或 Firebug 来查找源图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T19:46:04.653

你可以这样做： [http ://www.pixastic.com/lib/docs/actions/crop/](http://www.pixastic.com/lib/docs/actions/crop/)

然而，您需要围绕该库开发您的逻辑。

我做了例子，你可以在这个链接上看到它：http: [//simplestudio.rs/yard/crop_img/](http://simplestudio.rs/yard/crop_img/)

基本上，您可以通过 php 获取图像的 URL，并使用我的代码或类似于它的代码将图像裁剪成碎片并将它们显示在画布上。

这种方式图像无法通过浏览器或检查元素或其他方式访问。用户可以单独保存片段，但您可以将我的片段代码配置为 5px，我将其设置为 20x20px。

***通过右键单击图像上的任意位置并执行“将图像另存为..”选项来测试保存图像片段。**

此外，您还需要考虑如何将 src 隐藏到 php 提供的图像中，如果您需要帮助，我可以帮助您。

# python - re.match().groups() 是如何工作的？

> ID：14857102
> 
> 赞同：1
> 
> 时间：2013-02-13T15:34:26.257
> 
> 标签：python, regex

我正在尝试使用 re.match().groups() 从字符串中删除选择的信息：

```
s = "javascript:Add2ShopCart(document.OrderItemAddForm,%20'85575',%20'Mortein%20Mouse%20Trap%201%20pack',%20'',%20'$4.87');" 
```

我想要的结果是：

```
("Mortein%20Mouse%20Trap%201%20pack", "4.87") 
```

所以我一直在尝试：

```
re.match(r"(SEPARATOR)(SEPARATOR)", s).groups() #i.e.:
re.match(r"(\',%20\')(\$)", s).groups() 
```

我曾尝试查看[re 文档](http://docs.python.org/2/library/re.html)，但由于我的正则表达式技能太差，它对我没有多大帮助。

更多样本输入：

```
javascript:Add2ShopCart(document.OrderItemAddForm,%20'85575',%20'Mortein%20Mouse%20Trap%201%20pack',%20'',%20'$4.87');

javascript:Add2ShopCart(document.OrderItemAddForm_0,%20'85575',%20'Mortein%20Mouse%20Trap%201%20pack',%20'',%20'$4.87');

javascript:Add2ShopCart(document.OrderItemAddForm,%20'8234551',%20'Mortein%20Naturgard%20Fly%20Spray%20Eucalyptus%20320g',%20'',%20'$7.58');

javascript:Add2ShopCart(document.OrderItemAddForm,%20'4204369',%20'Mortein%20Naturgard%20Insect%20Killer%20Automatic%20Outdoor%20Refill%20152g',%20'',%20'$15.18');

javascript:Add2ShopCart(document.OrderItemAddForm_0,%20'4204369',%20'Mortein%20Naturgard%20Insect%20Killer%20Automatic%20Outdoor%20Refill%20152g',%20'',%20'$15.18');

javascript:Add2ShopCart(document.OrderItemAddForm,%20'4220523',%20'Mortein%20Naturgard%20Outdoor%20Automatic%20Prime%201%20pack',%20'',%20'$32.54'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:49:51.317

```
re.findall(r"""
   '          #apostrophe before the string Mortein
   (          #start capture
   Mortein.*? #the string Moretein plus everything until...
   )          #end capture
   '          #...another apostrophe
   .*         #zero or more characters
   \$         #the literal dollar sign
   (          #start capture
   .*?        #zero or more characters until...
   )          #end capture
   '          #an apostrophe""", s, re.X) 
```

这将返回一个数组，其中`Mortein`和`$`金额作为一个元组。您还可以使用：

```
re.search(r"'(Mortein.*?)'.*\$(.*?)'", s) 
```

这将返回一个匹配项。 `.group(1)`是`Moretein`和`.group(2)`是`$`。 `.group(0)`是匹配的整个字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:48:32.143

您可以使用

```
javascript:Add2ShopCart.*?,.*?,%20'(.*?)'.*?\$(\d+(?:\.\d+)?) 
```

组 1,2 捕获您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:46:03.037

不是一个正则表达式，希望它有所帮助：

```
In [16]: s="""s = javascript:Add2ShopCart(document.OrderItemAddForm,%20'85575',%20'Mortein%20Mouse%20Trap%201%20pack',%20'',%20'$4.87');"""

In [17]: arr=s.split("',%20'")

In [18]: arr[1]
Out[18]: 'Mortein%20Mouse%20Trap%201%20pack'

In [19]: re.findall("(?<=\$)[^']*",arr[3])
Out[19]: ['4.87'] 
```

# iphone - 带参数的 Http Post 请求

> ID：14857103
> 
> 赞同：3
> 
> 时间：2013-02-13T15:34:30.130
> 
> 标签：iphone, ios, json, http-post, httprequest

我有一个简单的 asp.net Web 服务，它返回 json 格式的数据。我想发送带有参数的http post请求以获取json数据。**如何发送请求并获取数据？**

**发帖请求：**

```
POST /JsonWS.asmx/FirmaGetir HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: length

firID=string 
```

**回答：**

```
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: length    
<?xml version="1.0" encoding="utf-8"?>
<string xmlns="http://tempuri.org/">string</string> 
```

**我正在尝试一些代码，但它们没有用。**

```
NSString *firmadi =@"";
NSMutableData *response;

-(IBAction)buttonClick:(id)sender
{
    NSString *firid = [NSString stringWithFormat:@"800"];

    response = [[NSMutableData data] retain];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://192.168.1.23/testService/JsonWS.asmx?op=FirmaGetir"]];

    NSString *params = [[NSString alloc] initWithFormat:@"firID=%@",firid];
    [request setHTTPMethod:@"POST"];
    [request setHTTPBody:[params dataUsingEncoding:NSUTF8StringEncoding]];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [[NSURLConnection alloc] initWithRequest:request delegate:self];
NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];

    if(theConnection)
    {
        response = [[NSMutableData data] retain];

    }
    else 
    {
        NSLog(@"theConnection is null");
    }

}

-(void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse*)responsed
{
    [response setLength:0];
     NSURLResponse * httpResponse;

    httpResponse = (NSURLResponse *) responsed;

}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData*)data
{
    [response appendData:data];
    //NSLog(@"webdata: %@", data);

}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError*)error
{
    NSLog(@"error with the connection");
    [connection release];
    [response release];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{

    response = [[NSMutableData data] retain];

 NSString *responseString = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];
    NSLog(@"%@",responseString);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:00:26.047

你在这里做什么：

```
[[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

此行返回一个 NSURLConnection 但您没有存储它。这对你无济于事。

在读取数据之前，您正在清除数据：

```
-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    response = [[NSMutableData data] retain]; // This line is clearing your data get rid of it
    NSString *responseString = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];
    NSLog(@"%@",responseString);

} 
```

**编辑**

```
-(IBAction)buttonClick:(id)sender {

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://192.168.1.23/testService/JsonWS.asmx?op=FirmaGetir"]
                                                           cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData
                                                       timeoutInterval:15];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:[@"firID=800" dataUsingEncoding:NSUTF8StringEncoding]];
    self.connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    [self.connection start];

}

#pragma NSURLConnection Delegates

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {

    if (!self.receivedData){
        self.receivedData = [NSMutableData data];
    }
    [self.receivedData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {

     NSString *responseString = [[NSString alloc] initWithData:self.receivedData encoding:NSUTF8StringEncoding];
     NSLog(@"%@",responseString);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-03T03:02:50.700

我今天早上遇到了这个问题，我现在才弄清楚。我想您问题的关键是**如何使用带有参数的 POST 方法**。实际上，这很简单。

(1) 首先，您应该确保您的文件已准备好发送。这里我们说它是一个名为*stringReady*的 NSString 。我们在我们的postRequest方法中使用它作为参数（这里不是我们要讲的HTTP POST参数，别担心）。

```
// Send JSON to server
- (void) postRequest:(NSString *)stringReady{
// Create a new NSMutableURLRequest
NSMutableURLRequest *req = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.xxxxxx.io/addcpd.php"]];
[req setHTTPMethod:@"POST"]; 
```

**(2) 现在，我们说服务器要获取的参数称为“数据”，这就是如何将参数插入 HTTP 正文的方式。**

```
// Add the [data] parameter
NSString *bodyWithPara = [NSString stringWithFormat:@"data=%@",stringReady]; 
```

看，这是您在使用 POST 方法时添加参数的方式。您只需将参数放在要发送的文件之前。如果你知道你的参数是什么，那么你最好查看这个网站：

[https://www.hurl.it/](https://www.hurl.it/)

这将帮助您测试您是否正确发送文件，并将在网站底部显示响应。

(3) 第三步，我们将我们的 NSString 打包成 NSData 并发送给服务器。

```
// Convert the String to NSData
NSData *postData = [bodyWithPara dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
// Set the content length and http body
NSString *postLength = [NSString stringWithFormat:@"%lu",(unsigned long)[postData length]];
[req addValue:postLength forHTTPHeaderField:@"Content-Length"];
[req setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[req setHTTPBody:postData];
// Create an NSURLSession
NSURLSession *session = [NSURLSession sharedSession];
NSURLSessionDataTask *task = [session dataTaskWithRequest:req
                                        completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
                                            // Do something with response data here - convert to JSON, check if error exists, etc....
                                            if (!data) {
                                                NSLog(@"No data returned from the sever, error occured: %@", error);
                                                return;
                                            }

                                            NSLog(@"got the NSData fine. here it is...\n%@\n", data);
                                            NSLog(@"next step, deserialising");

                                            NSError *deserr;
                                            NSDictionary *responseDict = [NSJSONSerialization
                                                                          JSONObjectWithData:data
                                                                          options:kNilOptions
                                                                          error:&deserr];
                                            NSLog(@"so, here's the responseDict\n\n\n%@\n\n\n", responseDict);
                                        }];

[task resume];} 
```

希望这可以帮助被困在这里的人。

# java - 出错时触发 VideoView onCompletion 事件

> ID：14857104
> 
> 赞同：2
> 
> 时间：2013-02-13T15:34:31.093
> 
> 标签：java, android, listener, android-mediaplayer, android-video-player

我正在创建一个在`VideoView`.

我想捕捉“抱歉，无法播放此视频”错误，然后继续观看下一个视频。视频切换在`onCompletionListener`.

我已经`onErrorListener`从[这里](https://stackoverflow.com/a/8298717/1331671)获得了 an 的代码，但我找不到如何触发“视频完成”事件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:15:44.260

您可以在 onErrorListener 中执行与在 onCompletion 中的 onCompletionListener 中相同的操作，您将视频设置为下一个（不知何故，我不知道您的实现），然后在出错时使用相同的代码（最有可能重构为另一个函数）。例如：

```
onError(....)
    if(error = watever error you need)
    functionNextVideo() 
```

注意上面是伪代码。

但除此之外，除非视频按预期完成，否则不会触发 onCompletionListener。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-08T11:21:51.337

在公共接口 OnErrorListener 的源代码中可以找到：

```
@return True if the method handled the error, false if it didn't.
         * Returning false, or not having an OnErrorListener at all, will
         * cause the OnCompletionListener to be called.
         */
        boolean onError(MediaPlayer mp, int what, int extra); 
```

所以 onCompletionListener 将被调用，如果你返回 false 或者你不处理回调。

# javascript - 如何测试 VLC ActiveX 的事件

> ID：14857105
> 
> 赞同：0
> 
> 时间：2013-02-13T15:34:32.823
> 
> 标签：javascript, html, dom-events, activex, vlc

我需要实现 VLC ActiveX 的所有 JavaScript 事件。

问题是所有事件都在触发，我不确定代码有什么问题。

视频结束时，我至少需要看到一些警报消息。

在这里>>> `registerVLCEvent('MediaPlayerEndReached', handleEvents);`

但是没有喜悦。

**代码：**

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title></title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">

        function getVLC(name) {
            if (window.document[name]) {
                return window.document[name];
            }
            if (navigator.appName.indexOf("Microsoft Internet") == -1) {
                if (document.embeds && document.embeds[name])
                    return document.embeds[name];
            }
            else // if (navigator.appName.indexOf("Microsoft Internet")!=-1)
            {
                return document.getElementById(name);
                //return getRawObject(name);
            }
        }

        function registerVLCEvent(event, handler) {
            var vlc = getVLC("vlc2");

            if (vlc) {
                if (vlc.attachEvent) {
                    // Microsoft
                    vlc.attachEvent(event, handler);
                }
                else if (vlc.addEventListener) {
                    // Mozilla: DOM level 2
                    vlc.addEventListener(event, handler, false);
                }
                else {
                    // DOM level 0
                    vlc["on" + event] = handler;
                }
            }
        }

        // stop listening to event
        function unregisterVLCEvent(event, handler) {
            var vlc = getVLC("vlc2");
            if (vlc) {
                if (vlc.detachEvent) {
                    // Microsoft
                    vlc.detachEvent(event, handler);
                }
                else if (vlc.removeEventListener) {
                    // Mozilla: DOM level 2
                    vlc.removeEventListener(event, handler, false);
                }
                else {
                    // DOM level 0
                    vlc["on" + event] = null;
                }
            }
        }

        // event callback function for testing
        function handleEvents(event) {
            if (!event)
                event = window.event; // IE
            if (event.target) {
                // Netscape based browser
                targ = event.target;
            } else if (event.srcElement) {
                // ActiveX
                targ = event.srcElement;
            } else {
                // No event object, just the value
                alert("Event value" + event);
                return;
            }

            if (targ.nodeType == 3) // defeat Safari bug
                targ = targ.parentNode;
            alert("Event " + event.type + " has fired from " + targ);
        }

        // handle mouse grab event from video filter
        function handleMouseGrab(event, X, Y) {
            if (!event)
                event = window.event; // IE
            alert("new position (" + X + "," + Y + ")");
        }

        $(document).ready(function () {
            // Register a bunch of callbacks.
            registerVLCEvent('MediaPlayerNothingSpecial', handleEvents);
            registerVLCEvent('MediaPlayerOpening', handleEvents);
            registerVLCEvent('MediaPlayerBuffering', handleEvents);
            registerVLCEvent('MediaPlayerPlaying', handleEvents);
            registerVLCEvent('MediaPlayerPaused', handleEvents);
            registerVLCEvent('MediaPlayerForward', handleEvents);
            registerVLCEvent('MediaPlayerBackward', handleEvents);
            registerVLCEvent('MediaPlayerEncounteredError', handleEvents);
            registerVLCEvent('MediaPlayerEndReached', handleEvents);
            registerVLCEvent('MediaPlayerTimeChanged', handleEvents);
            registerVLCEvent('MediaPlayerPositionChanged', handleEvents);
            registerVLCEvent('MediaPlayerSeekableChanged', handleEvents);
            registerVLCEvent('MediaPlayerPausableChanged', handleEvents);

        });

    </script>
</head>
<body>
    <object width="720" height="408" id='vlc2' events="True" codebase="http://downloads.videolan.org/pub/videolan/vlc/latest/win32/axvlc.cab"
        classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921">
        <embed type="application/x-vlc-plugin" pluginspage="http://www.videolan.org" version="VideoLAN.VLCPlugin.2"
            width="720" height="408" id="vlc1" />
        <param name="src" value="http://content.bitsontherun.com/videos/bkaovAYt-52qL9xLP.mp4" />
        <param name="ShowDisplay" value="True" />
        <param name="AutoPlay" value="False" />
    </object>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:07:56.303

嗯......所以事件根本不起作用......

所以我认为最好的想法是在 C# 端（调用）或 HTML 端实现一些方法来获取[vlc.input.state](http://wiki.videolan.org/Documentation%3aWebPlugin)值。

这是一个 HTML 示例：

```
$(document).ready(function () {
            start_timer = setInterval(function () {
              var vlc = getVLC("vlc2");
               var s = vlc.input.state;
               // alert(s);
            },
        1000);
        }); 
```

# delphi - 如何在 EExternal 异常期间获取 EXCEPTION_POINTERS？

> ID：14857106
> 
> 赞同：9
> 
> 时间：2013-02-13T15:34:36.850
> 
> 标签：delphi, exception-handling, delphi-5, minidump, dbghelp

我如何获得`EXCEPTION_POINTERS`，即两者：

*   `PEXCEPTION_RECORD`和
*   `PCONTEXT`

`EExternal`异常期间的数据？

# 背景

当 Windows 抛出异常时，它会传递一个`PEXCEPTION_POINTERS`; 指向异常信息的指针：

```
typedef struct _EXCEPTION_POINTERS {
   PEXCEPTION_RECORD ExceptionRecord;
   PCONTEXT          ContextRecord;
} EXCEPTION_POINTERS, *PEXCEPTION_POINTERS; 
```

当**Delphi**向我抛出`EExternal`异常时，它只包含一半的信息，`PEXCEPTION_RECORD`唯一的：

```
EExternal = class(Exception)
public
  ExceptionRecord: PExceptionRecord;
end; 
```

在`EExternal`异常期间，我如何同时获得两者？

# 示例用法

我正在尝试使用[`MiniDumpWriteDump`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680360(v=vs.85).aspx)Delphi 的函数编写一个 Minidump。

该函数有几个可选参数：

```
function MiniDumpWriteDump(
    hProcess: THandle; //A handle to the process for which the information is to be generated.
    ProcessID: DWORD; //The identifier of the process for which the information is to be generated.
    hFile: THandle; //A handle to the file in which the information is to be written.
    DumpType: MINIDUMP_TYPE; //The type of information to be generated.
    {in, optional}ExceptionParam: PMinidumpExceptionInformation; //A pointer to a MINIDUMP_EXCEPTION_INFORMATION structure describing the client exception that caused the minidump to be generated.
    {in, optional}UserStreamParam: PMinidumpUserStreamInformation;
    {in, optional}CallbackParam: PMinidumpCallbackInformation): Boolean; 
```

在基本层面上，我可以省略三个可选参数：

```
MiniDumpWriteDump(
    GetCurrentProcess(), 
    GetCurrentProcessId(),
    hFileHandle,
    nil,  //PMinidumpExceptionInformation
    nil,
    nil); 
```

它成功了。缺点是小型转储缺少异常信息。该信息（可选）使用第四个**miniExceptionInfo**参数传递：

```
TMinidumpExceptionInformation = record
    ThreadId: DWORD;
    ExceptionPointers: PExceptionPointers;
    ClientPointers: BOOL;
end;
PMinidumpExceptionInformation = ^TMinidumpExceptionInformation; 
```

这很好，除非我需要一种方法来在[`EXCEPTION_POINTERS`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679331.aspx)发生异常时获取 Windows 提供的信息。

该`TExceptionPointers`结构包含两个成员：

```
EXCEPTION_POINTERS = record
   ExceptionRecord : PExceptionRecord;
   ContextRecord : PContext;
end; 
```

我知道 Delphi 的`EExternal`异常是所有*“Windows”*异常的基础，它包含所需的**`PExceptionRecord`**：

```
EExternal = class(Exception)
public
  ExceptionRecord: PExceptionRecord;
end; 
```

但它不包含关联的**`ContextRecord`**.

# 还`PEXCEPTION_RECORD`不够好吗？

如果我尝试传递`EXCEPTION_POINTERS`to `MiniDumpWriteDump`，留下`ContextRecord`零：

```
procedure TDataModule1.ApplicationEvents1Exception(Sender: TObject; E: Exception);
var
   ei: TExceptionPointers;
begin
   if (E is EExternal) then
   begin
      ei.ExceptionRecord := EExternal(E).ExceptionRecord;
      ei.ContextRecord := nil;
      GenerateDump(@ei);
   end;

   ...
end;

function GenerateDump(exceptionInfo: PExceptionPointers): Boolean;
var
   miniEI: TMinidumpExceptionInformation;
begin
   ...

   miniEI.ThreadID := GetCurrentThreadID();
   miniEI.ExceptionPointers := exceptionInfo;
   miniEI.ClientPointers := True;

   MiniDumpWriteDump(
       GetCurrentProcess(), 
       GetCurrentProcessId(),
       hFileHandle,
       @miniEI,  //PMinidumpExceptionInformation
       nil,
       nil);
end; 
```

然后函数失败并出现错误`0x8007021B`

> 仅完成了 ReadProcessMemory 或 WriteProcessMemory 请求的一部分

# 怎么样`SetUnhandledExceptionFilter`？

> *你为什么不直接使用`SetUnhandledExceptionFilter`并获得你需要的指针呢？*

```
SetUnhandledExceptionFilter(@DebugHelpExceptionFilter);

function DebugHelpExceptionFilter(const ExceptionInfo: TExceptionPointers): Longint; stdcall;
begin
   GenerateDump(@ExceptionInfo);
   Result := 1;  //1 = EXCEPTION_EXECUTE_HANDLER
end; 
```

问题在于***未过滤***的异常处理程序仅在异常未过滤时才会启动。因为这是 Delphi，而且因为我处理了异常：

```
procedure DataModule1.ApplicationEvents1Exception(Sender: TObject; E: Exception);
var
    ei: TExceptionPointers;
begin
    if (E is EExternal) then
    begin
       //If it's EXCEPTION_IN_PAGE_ERROR then we have to terminate *now*
       if EExternal(E).ExceptionRecord.ExceptionCode = EXCEPTION_IN_PAGE_ERROR then
       begin
           ExitProcess(1);
           Exit;
       end;

       //Write minidump
       ...
    end;

    {$IFDEF SaveExceptionsToDatabase}
    SaveExceptionToDatabase(Sender, E);
    {$ENDIF}

    {$IFDEF ShowExceptionForm}
    ShowExceptionForm(Sender, E);
    {$ENDIF}
end; 
```

该应用程序*不会*，我也不希望它因 WER 故障而终止。

我如何`EXCEPTION_POINTERS`在一个期间获得`EExternal`？

**注意**：您可以忽略从**背景**开始的所有内容。它是不必要的填充物，旨在让我看起来更聪明。

先发制人的尖刻 Heffernan 评论：*你应该停止使用 Delphi 5。*

# 奖金阅读

*   [MSDN：崩溃转储分析（Windows）](http://msdn.microsoft.com/en-us/library/windows/desktop/ee416349%28v=vs.85%29.aspx) （如何调用的详细示例`MiniDumpWriteDump`）
*   [CodeProject：使用 Minidump 和 Visual Studio .NET 对应用程序进行事后调试](http://www.codeproject.com/Articles/1934/Post-Mortem-Debugging-Your-Application-with-Minidu) （一般性讨论概念、优点以及如何生成和使用 minidump）
*   [Stackoverflow：当我的进程崩溃时如何为它创建小型转储？](https://stackoverflow.com/questions/1547211/how-to-create-minidump-for-my-process-when-it-crashes) （初步介绍迷你转储世界）
*   [Stackoverflow：可以防止单个应用程序的 Microsoft 错误报告吗？](https://stackoverflow.com/questions/3416413/can-one-prevent-microsoft-error-reporting-for-a-single-app) （在 Delphi 中设置未过滤的处理程序）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T21:39:36.863

由于 Delphi RTL 不直接公开上下文指针，而仅提取异常指针并在 System 内部执行此操作，因此该解决方案将在某种程度上特定于您正在使用的 Delphi 版本。

自从我安装 Delphi 5 以来已经有一段时间了，但我确实有 Delphi 2007，而且我相信 Delphi 5 和 Delphi 2007 之间的概念在很大程度上保持不变。

考虑到这一点，下面是一个如何在 Delphi 2007 上完成的示例：

```
program Sample;

{$APPTYPE CONSOLE}

uses
  Windows,
  SysUtils;

var
  SaveGetExceptionObject : function(P: PExceptionRecord):Exception;

// we show just the content of the general purpose registers in this example
procedure DumpContext(Context: PContext);
begin
  writeln('eip:', IntToHex(Context.Eip, 8));
  writeln('eax:', IntToHex(Context.Eax, 8));
  writeln('ebx:', IntToHex(Context.Ebx, 8));
  writeln('ecx:', IntToHex(Context.Ecx, 8));
  writeln('edx:', IntToHex(Context.Edx, 8));
  writeln('esi:', IntToHex(Context.Esi, 8));
  writeln('edi:', IntToHex(Context.Edi, 8));
  writeln('ebp:', IntToHex(Context.Ebp, 8));
  writeln('esp:', IntToHex(Context.Esp, 8));
end;

// Below, we redirect the ExceptObjProc ptr to point to here
// When control reaches here we locate the context ptr on
// stack, call the dump procedure, and then call the original ptr
function HookGetExceptionObject(P: PExceptionRecord):Exception;
var
  Context: PContext;
begin
  asm
    // This +44 value is likely to differ on a Delphi 5 setup, but probably
    // not by a lot. To figure out what value you should use, set a
    // break-point here, then look in the stack in the CPU window for the
    // P argument value on stack, and the Context pointer should be 8 bytes
    // (2 entries) above that on stack.
    // Note also that the 44 is sensitive to compiler switches, calling
    // conventions, and so on.
    mov eax, [esp+44]
    mov Context, eax
  end;
  DumpContext(Context);
  Result := SaveGetExceptionObject(P);
end;

var
  dvd, dvs, res: double; // used to force a div-by-zero error
begin
  dvd := 1; dvs := 0;
  SaveGetExceptionObject := ExceptObjProc;
  ExceptObjProc := @HookGetExceptionObject;
  try
    asm
      // this is just for register context verification
      // - don't do this in production
      mov esi, $BADF00D5;
    end;
    // cause a crash
    res := dvd / dvs;
    writeln(res);
  except
    on E:Exception do begin
      Writeln(E.Classname, ': ', E.Message);
      Readln;
    end;
  end;
end. 
```

# javascript - 通过 CSS 属性选择 jQuery

> ID：14857115
> 
> 赞同：2
> 
> 时间：2013-02-13T15:35:06.100
> 
> 标签：javascript, jquery

我正在尝试通过 CSS 选择图像，该图像通过 CMS 自动应用于该图像，然后添加一个类。这是我的脚本：

```
$(document).ready(function() {
    if ($('.pageBody p img').css('float') === 'right') {
        $('.pageBody p img').addClass('float-right');
    }
}); 
```

该脚本适用于已`float: right`应用的图像。有另一个图像已`float: left`应用。问题是，如果我在脚本中将“右”切换到“左”，它就不会起作用。例如，如果我将图像设置为`float: left`并使用此脚本，则它不起作用：

```
$(document).ready(function() {
    if ($('.pageBody p img').css('float') === 'left') {
        $('.pageBody p img').addClass('float-left');
    }
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T15:38:02.783

只有当您感兴趣的图像是文档中的第一个图像时，您当前的代码才有效。无论图像在 DOM 中的位置如何，您都可以使用[filter()来定位该图像：](http://api.jquery.com/filter/)

```
$(document).ready(function() {
    $(".pageBody p img").filter(function() {
        return $(this).css("float") == "left";
    }).addClass("float-left");
}); 
```

或者，您可以使用[addClass()](http://api.jquery.com/addClass/)的形式，它接受一个函数来添加`float-left`或`float-right`类到所有图像，具体取决于它们的`float`样式值：

```
$(document).ready(function() {
    $(".pageBody p img").addClass(function() {
        var direction = $(this).css("float");
        if (direction == "left" || direction == "right") {
            return "float-" + direction;
        } else {
            return "";
        }
    });
}); 
```

# javascript - 有没有办法像 alert() 函数那样在 JavaScript 中强制同步行为？

> ID：14857118
> 
> 赞同：3
> 
> 时间：2013-02-13T15:35:17.253
> 
> 标签：javascript, jquery, asynchronous

在 Javascript 中使用警报或确认时，浏览器会被迫进入同步过程，在此过程中一切（甚至是加载另一个页面）都会停止，直到用户关闭对话框。

我想知道是否有任何其他方法可以使用 JS 或 jQuery 强制浏览器停止/暂停。

我查看了类似的问题，例如：

[如何强制javascript函数同步/顺序执行？](https://stackoverflow.com/questions/13543553/how-to-force-javascript-function-execute-synchronously-sequentially)

[如何使 jQuery ui 对话框像警报或确认框一样停止浏览器处理？](https://stackoverflow.com/questions/7804462/how-to-make-jquery-ui-dialog-box-halt-browser-processing-like-an-alert-or-confir)

[在javascript中获得同步行为？](https://stackoverflow.com/questions/8565638/getting-synchronous-behavior-in-javascript)

...但似乎没有一个答案能直接解决这个问题。如果没有办法做到这一点，我将完全接受它作为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:41:43.497

不，目前没有跨浏览器的方式来强制异步函数同步执行。

但是，您可以使用延续以同步方式编写异步代码。

阅读以下答案了解更多详情：[https ://stackoverflow.com/a/14809354/783743](https://stackoverflow.com/a/14809354/783743)

# mysql - MySql - 错误 1064 - 找不到语法错误

> ID：14857121
> 
> 赞同：1
> 
> 时间：2013-02-13T15:35:40.727
> 
> 标签：mysql

这是 mysqldump 的输出。我没有更改任何内容，但在第 1 行附近出现错误 1064，我假设这是第一个未注释的行。谁能发现我的语法错误？

```
-- MySQL dump 10.13  Distrib 5.5.30, for Linux (x86_64)
--
-- Host: localhost    Database: dbname_email
-- ------------------------------------------------------
-- Server version   5.5.30-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8; */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `Newsletter_Emails`
--

DROP TABLE IF EXISTS `Newsletter_Emails`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `Newsletter_Emails` (`Email` varchar(100) DEFAULT NULL) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */; 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:50:52.753

问题在这里：

```
/*!40101 SET NAMES utf8; */; 
```

显然，这是由`;`条件注释中的分隔符引起的。这按预期工作：

```
/*!40101 SET NAMES utf8 */; 
```

# actionscript-3 - 将按钮名称传递给函数中的变量

> ID：14857124
> 
> 赞同：0
> 
> 时间：2013-02-13T15:35:40.690
> 
> 标签：actionscript-3, flash, variables

我想将按钮名称传递给变量的一部分。但没有成功。请帮助我。谢谢。

```
[Embed(source="desenler/k1r1.jpg", mimeType="image/jpeg")]
      public var Imgk1r1:Class;
[Embed(source="desenler/k1r2.jpg", mimeType="image/jpeg")]
      public var Imgk1r2:Class; 

k1r1.addEventListener(MouseEvent.CLICK, onbi);
k1r2.addEventListener(MouseEvent.CLICK, onbi);

    private function onbi(e:MouseEvent):void {

        bdWindow=new  Imgk1r1().bitmapData; 
```

*而不是那个，我想传递按钮名称*

```
bdWindow=new Img+button name+().bitmapData; 
```

*我试过了*

```
 bdWindow=new  ["Img"+e.currentTarget.name+"().bitmapData"]; 
```

但它说“在非构造函数上尝试实例化”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:00:07.140

你很亲密。由于 Imgk1r1 是`this`（无论您的情况是什么）的变量，您应该能够使用括号符号访问它，如下所示：

```
private function onbi(e:MouseEvent):void 
{
    bdWindow = Bitmap(new this["Img"+DisplayObject(e.currentTarget).name]()).bitmapData;
} 
```

# c++ - 将数据保留在 RAM 中，同时允许其他进程在 linux C++ 中访问它

> ID：14857135
> 
> 赞同：2
> 
> 时间：2013-02-13T15:36:09.787
> 
> 标签：c++, linux, memory, memory-management, process

目前我正在linux中调试一个看起来像这样的程序：

```
int main(){
    loadHugeFile();
    processTheDataOfTheFile();
    return 0;
} 
```

问题是`loadHugeFile`函数需要加载一个非常大的千兆字节文件，大约需要 5 分钟，而`processTheDataOfTheFile`需要不到 10 秒的时间来计算所需的数据并返回一些值。将来，文件的大小可能会进一步增加，加载时间会更长。该文件是一个反向索引，因此需要整个文件。

是否可以让一个进程将此文件加载到 RAM 中，保留它并让任何其他进程访问加载文件的这一部分？这是为了跳过那几分钟的加载。我记得 Windows 有这个功能，可以让你访问/修改另一个进程的内存，但是我在 linux 中有哪些可用的选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:58:21.207

您可以使用[mmap](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)功能。

> 在计算中，mmap(2) 是一个符合 POSIX 的 Unix 系统调用，它将文件或设备映射到内存中。它是一种内存映射文件 I/O 的方法。

你有**2个优势**。`Extreme speed`在加载文件时，内容将位于可以在许多其他进程之间共享的内存区域中（只需`mmap`与 flag 一起使用`MAP_SHARED`）。

您可以使用这个简短而肮脏的代码来测试 mmap 的速度。只需编译它并执行它，将您要加载的文件作为参数传递。

```
#include <stdio.h>
#include <stdint.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/mman.h>

int main(int argc, char *argv[])
{
    struct stat sb;

    int fd = open(argv[1], O_RDONLY);

    // get the size in bytes of the file
    fstat (fd, &sb);

    // map the file in a memory area
    char *p = mmap (0, sb.st_size, PROT_READ, MAP_SHARED, fd, 0);

    // print 3 char of the file to demostrate it is loaded ;)
    printf("first 3 chars of the file: %c %c %c\n", p[0], p[1], p[2]);

    close(fd);

    // detach
    munmap(p, sb.st_size);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T15:58:18.293

有不止一种方法可以做到这一点，但直接的方法是[映射](http://linux.die.net/man/3/mmap)文件并在其他进程中使用[共享内存，以便他们可以访问文件。](http://linux.die.net/man/3/shm_open)

您还可以围绕文件本身实现高级套接字读/写 API，并允许用户通过 API 访问它。 **但是**，您可能需要考虑将文件加载到 SQL 数据库或其他东西中，以便您可以**尽可能**使用实际的数据库后端，因为它们是为这种类型的东西设计的。

如果您需要检测文件的更改，您可以使用[inotify/dnotify](https://stackoverflow.com/questions/7566569/how-to-continuosly-monitor-the-directory-using-dnotify-inotify-command)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T16:05:52.467

跳出框框思考，为什么不直接使用数据库？数据库针对搜索大文件进行了优化，并且由于缓存，它们会将部分文件保留在内存中以获得更好的性能。多个进程可以同时访问该文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T16:00:21.533

我猜如果你的文件是多个千兆字节，加载需要很长时间，因为它会溢出 RAM 并导致 RAM 中的数据被推送到硬盘驱动器的交换部分。

实现一次读取文件并将其保存在 ram 中的目标的一种方法是将文件复制到`/dev/shm/`目录中。中的文件`/dev/shm/`实际上存储在 RAM 中，可供多个进程使用。但是，如果您的文件量很大或超过系统上的 RAM 量，这仍然会遇到与交换到硬盘驱动器相同的问题，因此我不推荐它。

我建议使用带有[mmap](http://en.wikipedia.org/wiki/Mmap)的内存映射文件。这为您提供了几个优势：

*   该文件的外观和寻址方式就像 RAM 中的数据数组一样。
*   只有当前正在读取的部分文件被加载到 RAM 中。
*   操作系统负责从内存中提取数据并将其推回磁盘，因此一旦设置好就很容易使用。

另一种选择是更新您的处理功能以在流模式下运行，这可能会也可能不会。

# javascript - 换行符的 .replace() 不适用于 contenteditable 项目

> ID：14857136
> 
> 赞同：0
> 
> 时间：2013-02-13T15:36:15.910
> 
> 标签：javascript, replace

我有这个简单的代码：

```
 <div style="margin-left:10px;">
    <p>
     <a class="btn" href="#" onclick="myFunction()"><i class="icon-link"></i></a>
    </p>
  </div>

  <div style="margin-left:10px;">

    <div id="example-one" >
      <p id="textEditor" contenteditable="true"></p>
    </div> 

  </div>

 <script type="text/javascript">

function myFunction()
{

  // removes <div> from #textEdtor's content
  $("#textEditor>div").replaceWith(function() { return $(this).contents(); }); 

  var str=document.getElementById("textEditor").innerHTML; 

  var n=str.replace(/\n|\r/g, '<br>')

  document.getElementById("textEditor").innerHTML=n;

  alert(n);
}

</script> 
```

问题是`var n=str.replace(/\n|\r/g, '<br>')`当用户按下回车键时不起作用。虽然如果我使用它效果很好`.replace(/\[b\]/g,'<b>').replace(/\[\/b\]/g,'</b>')`

`<br>`只有当您按两次回车时，它才会添加一个。

有没有办法解决这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:46:51.800

问题在于删除子`<div>`元素。用下面的代码替换你的代码，一切都应该正常：

```
function myFunction() {
    $("#textEditor > div").before("<br />").contents().unwrap();
} 
```

**演示：http:** [//jsfiddle.net/Hm7DY/](http://jsfiddle.net/Hm7DY/)

# facebook - 如何验证用户喜欢页面的时间？

> ID：14857142
> 
> 赞同：0
> 
> 时间：2013-02-13T15:36:29.750
> 
> 标签：facebook, datetime, facebook-like, timestamp

我正在寻找了解 FB 用户喜欢特定页面多长时间的可能性。

我从事广告工作，如果他们喜欢该页面，我们希望每周为 FB 用户提供一些项目（例如，价值每周都会增加）。例如，如果有人与页面不同，他将从第一项重新开始。

你有没有想过如何做到这一点？

非常感谢你 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:54:23.953

不幸的是你不能。Facebook 不再允许为您的页面粉丝获取 ID 列表。

看到这个错误：[https](https://developers.facebook.com/bugs/147185208750426) ://developers.facebook.com/bugs/147185208750426和 Facebook 回应：“抱歉，没有办法获得喜欢页面的人的完整列表。这是设计使然。”

# image - 避免在coldfusion中刷新页面时插入数据

> ID：14857143
> 
> 赞同：2
> 
> 时间：2013-02-13T15:36:31.887
> 
> 标签：image, coldfusion

我是Coldfusion的新手。当我刷新页面数据插入两次时，请在coldfusion中刷新页面时避免数据插入

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:06:01.333

运行 INSERT 语句后，你会想像`<cflocation>`Travis 说的那样使用

```
<cflocation url="yoururl" addtoken="false"> 
```

您需要添加`addtoken="false"`到您的`cflocation`，因为这将阻止通过 url 传递客户端变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:02:13.773

让您的显示页面提交到流程页面。完成处理后，重定向回您的显示页面。这样，插入/更新/删除只能通过按下显示页面上的插入/更新/删除按钮来启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T17:33:29.260

页面刷新是获得重复记录的几种可能方式之一。我认为防止这种情况的最有效方法是在数据库中。以仅添加不存在的记录的方式编写插入查询。

有几种方法可以做到这一点。我个人最喜欢的是这个：

```
 INSERT INTO myTable ( field1, field2, etc )
    SELECT DISTINCT value1, value2, etc
    FROM   someSmallTable
    WHERE  NOT EXISTS
           (
              subquery to check for existing records
           ) 
```

这是一个通用的建议。一些细节可能会根据所使用的数据库软件而改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T11:43:11.950

在会话中维护一个标志，指示是否将数据插入数据库表。执行以下步骤：

1.  在插入之前，检查会话值是否`"Y"`为
2.  如果会话值为`"Y"`，则插入数据并将会话值更改为`"N"`
3.  如果会话值为`"N"`，则不向表中插入数据。

如果页面在插入后刷新，它会检查会话值并找到`"N"`. 所以数据不会被插入。

# python - uWSGI + python urllib2 非常慢

> ID：14857145
> 
> 赞同：1
> 
> 时间：2013-02-13T15:36:38.597
> 
> 标签：python, nginx, flask, urllib2, uwsgi

我有一个大问题 :) 故事是这样的：我在一台服务器上运行了 2 个 Web 应用程序。每个都由 uwsgi 通过主管（也有 nginx）启动。一个项目（app2）通过 urllib2 向其他项目（app1）发出 HTTP 请求。当我开始围攻（围攻 -d1 -r10 -c200 [http://app1.mydomain.com/test](http://app1.mydomain.com/test)）时，另一个项目（app2）开始没有响应，并且该 app2 的所有 uwsgi 工作人员都变得很忙。同时，app1 从浏览器响应，就像它没有被“围攻”一样。并且所有工人都变得忙碌起来。当我用 urllib2 删除该行并开始测试时，所有项目都感觉良好。应用程序的 Uwsgi 配置：

```
[uwsgi]
socket = /var/run/core/app1.sock
max-requests = 5000
listen = 2048
master = true
processes = 30
harakiri = 15
harakiri-verbose = 1
buffer-size = 65536
stats = /tmp/app1_stats.sock 
```

它们是完全一样的。请注意，我没有“围攻”发出 HTTP 请求的应用程序。如果这一切都是用 Flask 做的。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:03:12.730

我解决了一个问题。如果有人感兴趣：只需使用 urllib3 并创建 HTTPConnectionPool()。

# c# - 从 C++ 访问 C# 类实例 (Windows Phone 8 Direct3D)

> ID：14857147
> 
> 赞同：2
> 
> 时间：2013-02-13T15:36:40.590
> 
> 标签：c#, c++, directx, windows-phone-8, direct3d

有什么方法可以从本机端（C++）访问已在 Windows Phone 8 Direct3D Xaml/C++ 应用程序的 XAML/C# 部分中实例化的对象（！）？

我们尝试添加引用，但不幸的是没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:48:51.250

是的，首先您需要在 C++/CX 端定义一个 Windows 运行时接口。

然后，您可以引用此接口并从实现此接口的类中实例化一个 C# 对象。

最后，您可以将此类实例传递给您的 C++ 层（Windows 运行时组件类）。

然后，您可以从 C++ 调用该 WinRT 接口的方法，并且您的代码将在 C#/.NET 中运行。

# scala - 使用不同的参数多次运行 sbt 插件

> ID：14857148
> 
> 赞同：1
> 
> 时间：2013-02-13T15:36:44.780
> 
> 标签：scala, sbt

我有一个使用插件的 sbt 项目。该插件执行以下代码（例如，真正的插件更复杂）：

```
val pluginTask = TaskKey[Unit]("pluginTask")
val pluginKey = SettingKey[Int]("pluingKey")
pluginTask <<= pluginKey map {i => println(i)} // real plugin does some IO operations 
```

所以我可以`pluginKey`在我的 build.sbt 中设置，然后执行`sbt pluginTask`. 因为插件很复杂，我不想更改内部代码。现在我想根据数字列表制作插件，因此每个列表条目执行一次。该列表可以通过 build.sbt 设置，因为它在运行时不会改变。这是否可能不使用 shell 并多次执行 sbt ？

# java - 在同一个函数的 synchronized() 块中初始化后，Java 集合是否可以在 synchronized() 之外安全使用？

> ID：14857149
> 
> 赞同：2
> 
> 时间：2013-02-13T15:36:44.883
> 
> 标签：java, concurrency, thread-safety

以下代码是否被认为是线程安全的，即：写入列表是否保证*发生在*读取列表之前？我一直试图了解这在 Java 内存模型中是否被认为是安全的，但目前还不清楚。

通过基本的流程分析，看起来可以保证所有可能的线程在到达下面`synchronized`的循环之前都必须通过初始化程序块`for`，但是对该列表的迭代是否是确定性的和线程安全的？我不确定在使用下面的列表*之前*是否保证初始化。

假设这是类中唯一的方法。我知道在同步块内移动迭代可以保证线程安全，但我更想知道这个构造是否安全。

此外，假设列表永远不会逃脱类。

Java 内存模型在此处的 JLS 中进行了解释：http: [//docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4)

```
private List<Foo> list;
private final Object monitor = new Object();

public void bar() {
    synchronized (monitor) {
        if (list == null) {
            list = new ArrayList<>();
            list.add(...); // expensive operation
            list.add(...); // expensive operation
            list.add(...); // expensive operation
        }
    }

    for (Foo foo : list) {
        // do something with foo
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T15:40:37.297

**当且仅当**这是您在结构上修改列表的唯一位置时，它才是线程安全的。

如果您在其他地方修改列表（例如使用`clear()`），*即使该其他地方也使用`synchronized`了，那么**在您迭代*列表时可以轻松修改列表。

如果您*不*打算在其他任何地方修改列表，那么使用[`Collections.unmodifiableList()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableList%28java.util.List%29)来确保（并记录）这一事实可能是一个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T17:13:24.340

[JLS #17.4.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)保证：

> 监视器上的解锁发生在该监视器上的每个后续锁定之前。

它还保证同步块不能并发执行，不能用for循环重新排序。

因此，第一个到达并获得监视器的线程（我们称之为 T0）将初始化列表。当 T0 退出同步块时，线程内语义保证 for 循环将在 T0 中按预期执行。

随后到达的所有线程将等待监视器可用，获取它，并且由于上面的保证，将看到由 T0 初始化的列表（即不为空且已填充）。并且由于线程内语义，for 循环将按预期执行。

**结论**：如果您的列表没有在其他地方写入并且所有读取都在获取监视器后完成，那么您的代码是安全的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T15:39:57.020

如果您不再从该同步方法中修改您的列表，那么您公开的代码是安全的。现在，如果其他方法（不是 bar()）使用相同的列表，那么您的代码是不安全的。此外，您应该声明`final List list`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T15:41:04.680

`synchronized(list)`仅适用于其中包含的代码块。如果在您使用 for each 循环遍历列表时另一个线程修改了列表，您将遇到问题。

# data-structures - 从中序和水平序遍历构造二叉树

> ID：14857151
> 
> 赞同：5
> 
> 时间：2013-02-13T15:36:50.657
> 
> 标签：data-structures, binary-tree, inorder

首先，我想说这不是家庭作业。我正在准备面试并遇到这个问题。我想我们可以传递[中序](http://en.wikipedia.org/wiki/Tree_traversal)和[水平序](http://en.wikipedia.org/wiki/Tree_traversal)遍历的定义。:-)。

例如：

```
 50
   /      \
 10        60
/  \       /  \
5   20    55    70
        /     /  \
      51     65    80 
```

> 上述树的中序和层序遍历为：
> 
> 5、10、20、50、51、55、60、65、70、80
> 
> 50, 10, 60, 5, 20, 55, 70, 51, 65, 80

我的想法：

> (1) 遍历层序数组，找出出现在有序数组中的第一个元素。我们将此元素称为当前根。
> 
> (2) 在有序数组中找到当前根的索引。有序数组由索引分隔。有序数组的左边是当前根的左子树，有序数组的右边是当前根的右子树。
> 
> (3) 将有序数组更新为其左侧，然后转到步骤 1。
> 
> (4) 将有序数组更新为其右侧，然后转到步骤 2。

以上面的树为例。

> ```
> (1) 5 is the first element appears in the in-order array. 
> 
> (2) [50 ...60] is the left sub-tree of 5 and [20 ... 80] is the right sub-tree of 5\. 
> 
> (3) update the in-order array as [50 ... 60]
> 
>     (1) 10 is the first element appears in [50 10 60].
> 
>     (2) [50] is the left sub-tree of 10 and [60] is the right sub-tree of 10.
> 
>     (3) update ... 
> ```

谁能帮我验证我的解决方案？如果再给一个，真的很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-06T16:59:40.210

我认为你在正确的轨道上。下面是我使用您的数据制定的工作代码。

```
/*
//construct a bst using inorder & levelorder traversals.
//inorder    - 5, 10, 20, 50, 51, 55, 60, 65, 70, 80
//levelorder - 50, 10, 60, 5, 20, 55, 70, 51, 65, 80
         50
      /      \
    10        60
   /  \       /  \
  5   20    55    70
            /     /  \
          51     65    80
 */
struct node *construct_bst3(int inorder[], int levelorder[], int in_start, int in_end)
{
    static int levelindex = 0;
    struct node *nnode = create_node(levelorder[levelindex++]);

    if (in_start == in_end)
        return nnode;

    //else find the index of this node in inorder array. left of it is left subtree, right of this index is right.
    int in_index = search_arr(inorder, in_start, in_end, nnode->data);

    //using in_index from inorder array, constructing left & right subtrees.
    nnode->left  = construct_bst3(inorder, levelorder, in_start, in_index-1);
    nnode->right = construct_bst3(inorder, levelorder, in_index+1, in_end);

    return nnode;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-25T00:56:21.250

```
 node *construct (in, s, e, level) 
    {
      while (level order has element)
      {
          make the root by taking the first element from level order
          find the index of root->Val in in order.

          segregate the elements of left subtree and right subtree (make sure while 
          segregating from level order the order of element should be same)  call them
          leftLevel[] and rightLevel[]

          construct tree by recursively calling
          root->left  = construct(inorder,s, index-1, leftLevel);
          root->right = construct(inorder, index+1, e, rightlevel);
          return root;
      }
 } 
```

元素的分离将需要使用哈希表的 O(n)，因此平衡树中的整体复杂度将为 O(nlogn)，但当树不平衡时，它将变为 O(n^2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T00:20:37.163

其实思路很简单，只要确定遍历顺序是否正确即可。比如你想做中序遍历，你可以简单的这么想：从左到右，从下到上。

1.  遍历到左下（5），然后遍历到同一个节点的右（20）。

2.  从底部 (10) 遍历到顶部 (50)。

3.  在左边做同样的事情。

对于杠杆顺序，您可以从上到下，从左到右，一步一步地遍历。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-15T16:03:33.187

```
 static tree MakeTreeFromInorderAndLevelOrder(int[] inorder,int[] lorder,int s,int n,int cnt1) {
    if(s>n || s>=inorder.length || n>=inorder.length || cnt1>=inorder.length) {
        return null;
    }
    int mIndex = Search(lorder[cnt1],inorder,s,n);
    tree t = new tree(lorder[cnt1]);

    cnt1 = 2*cnt1 + 1;
    t.left = MakeTreeFromInorderAndLevelOrder(inorder,lorder,s,mIndex-1,cnt1);
    //Boundary case
    if(cnt1<inorder.length && t.left==null) {
        t.right =   MakeTreeFromInorderAndLevelOrder(inorder,lorder,mIndex+1,n,cnt1);
    }
    else {
    cnt1 -=1;
    cnt1 /=2;
    cnt1 = 2*cnt1 + 2;
    t.right = MakeTreeFromInorderAndLevelOrder(inorder,lorder,mIndex+1,n,cnt1);
    //Boundary case
    if(t.right ==null && cnt1<inorder.length) {
        t.left = MakeTreeFromInorderAndLevelOrder(inorder,lorder,s,mIndex-1,cnt1);
    }
    }
    return t;
} 
```

# android - 计算变形视频的显示宽高比

> ID：14857156
> 
> 赞同：2
> 
> 时间：2013-02-13T15:37:06.650
> 
> 标签：android, google-tv

Google TV/Android 3.2 API 似乎无法正确报告视频内容的显示尺寸。

```
int surfaceViewHeight = surfaceView.getHeight();
int surfaceViewWidth = surfaceView.getWidth();

float videoWidth = mediaPlayer.getVideoWidth();
float videoHeight = mediaPlayer.getVideoHeight();

float ratioWidth = surfaceViewWidth / videoWidth;
float ratioHeight = surfaceViewHeight / videoHeight;
float aspectRatio = videoWidth / videoHeight; 
```

问题似乎是 mediaPayer.getVideoWidth() 和 getVideoHeight 调用。因为它们总是返回视频内容的物理存储大小，而不是那些支持它的容器的实际显示大小。我检查了一下，没有可用的 API 可以获取显示大小。您可以通过使用像 Plex Media Server 这样正确返回纵横比的外部源来接近，但除非返回显示大小，否则 ratioWidth 和 ratioHeight 计算总是会出错。

这似乎真的影响了 LG 谷歌电视，因为我从我的应用程序的这些用户那里收到了大部分错误报告。有没有办法获取容器中记录的实际显示大小（如果存在）？

更新：这是 Handbrake 中关于 Anamorphic 内容的一般基础。

[https://trac.handbrake.fr/wiki/AnamorphicGuide](https://trac.handbrake.fr/wiki/AnamorphicGuide)

基本上，如果只返回视频的物理尺寸并用于计算纵横比，那么显示的视频将总是看起来被挤压或拉伸。当它可能不应该时，它也可能总是有黑条。编解码器应该返回一个显示宽度和高度，以通知视频播放器应该如何显示内容，以便在电视上看起来正确。

MKV 容器格式可以在 EBML 中报告正确的信息。看起来 Android api 只报告像素宽度和像素高度。请参阅以下 java 源代码（这可能是 MKV 的解决方法）。

[http://matroska.svn.sourceforge.net/viewvc/matroska/trunk/JEBML/src/org/ebml/matroska/MatroskaFileTrack.java?revision=874&view=markup](http://matroska.svn.sourceforge.net/viewvc/matroska/trunk/JEBML/src/org/ebml/matroska/MatroskaFileTrack.java?revision=874&view=markup)

# methods - 当方法不返回任何内容时如何获取空值？

> ID：14857158
> 
> 赞同：0
> 
> 时间：2013-02-13T15:37:08.323
> 
> 标签：methods, null, return-value

我有 2 类第一类和第二类。Second 类中有一个方法

```
public void update(String reading,String writing) { 
    ArrayList1.add(reading);
    System.out.println("reading: "+reading);

    ArrayList2.add(writing);
    System.out.println("writing: "+writing);
} 
```

这个`update()`方法是从类 First 调用的，如下所示：

```
object_ofClassSecond.update(reading,writing); 
```

并`classFirst`从第三个类（我们称之为第三类）获取这些读写参数，如下所示：

```
String reading=request.getParameter("reading");
String writing=request.getParameter("writing"); 
```

还有一些其他的事情，但我不想详细说明。所以问题是每当有读取或写入时，我都会从 classThird 获取它们，然后通过该方法将它们传递给`classFirst`to 。然而，有时这种方法不会返回任何东西，我需要在这种情况下将空值分配给我的读写变量。我想在方法不返回任何内容时查看-2 中的空值。`classSecond``update()``getParameter()``ArrayList1``classSecond``getParameter()`

你能帮我做这件事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:41:55.457

> 然而，有时这个 getParameter() 方法不返回任何东西

这不可能。如果该方法的返回类型声明为`String`then 任何时候调用它，都会发生以下三种情况之一：

*   该方法返回一个引用，该引用可能为空，也可能不为空
*   该方法抛出异常
*   该方法根本不返回（例如它有一个无限循环）

假设您的方法*正在*返回，它*必须*返回一个值。它根本不可能返回任何东西。你应该看看在你认为它“不会返回任何东西”的情况下到底发生了什么，然后找出你想要发生的事情*。*

*   如果该方法永远执行，您需要弄清楚如何摆脱它
*   如果方法抛出异常，您需要弄清楚如何处理异常
*   如果方法正常返回，那么它必须返回某种引用；如果您实际上是在任何时候尝试使用空引用，它返回对空字符串的引用，那是非常易于管理的。

# mysql - MySQL SELECT 语句的两行之间的区别

> ID：14857159
> 
> 赞同：13
> 
> 时间：2013-02-13T15:37:09.740
> 
> 标签：mysql, select, inner-join

我正在尝试区分 mysql 数据库中的两行。
我有这张表，其中包含 ID、公里、日期、car_id、car_driver 等...
由于我并不总是以正确的顺序在表中输入信息，我最终可能会得到如下信息：

```
ID | Kilometers | date | car_id | car_driver | ...
 1 | 100        | 2012-05-04 | 1 | 1  
 2 | 200        | 2012-05-08 | 1 | 1
 3 | 1000       | 2012-05-25 | 1 | 1 
 4 | 600        | 2012-05-16 | 1 | 1 
```

使用 select 语句，我可以正确地对表格进行排序：

```
SELECT * FROM mytable ORDER BY car_driver ASC, car_id ASC, date ASC 
```

我会得到这个：

```
ID | Kilometers | date  | car_id | car_driver | ...  
 1 | 100        | 2012-05-04 | 1 | 1  
 2 | 200        | 2012-05-08 | 1 | 1
 4 | 600        | 2012-05-16 | 1 | 1  
 3 | 1000       | 2012-05-25 | 1 | 1 
```

现在我想查看基本上我有这些额外信息的视图：自上次日期以来的公里数，我想获得这样的信息：

```
ID | Kilometers | date       | car_id | car_driver | number_km_since_last_date   
 1 | 100        | 2012-05-04 | 1 | 1 | 0  
 2 | 200        | 2012-05-08 | 1 | 1 | 100  
 4 | 600        | 2012-05-16 | 1 | 1 | 400  
 3 | 1000       | 2012-05-25 | 1 | 1 | 400 
```

我想过做一个 INNER JOIN 来执行我想要的，但我觉得我不能在我的 ID 上做连接，因为它们没有正确排序。
有没有办法实现我想要的？

我应该创建一个带有某种 row_number 的视图，然后我可以在我的 INNER JOIN 中使用它吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-13T15:48:23.920

```
SELECT
    mt1.ID,
    mt1.Kilometers,
    mt1.date,
    mt1.Kilometers - IFNULL(mt2.Kilometers, 0) AS number_km_since_last_date   
FROM
    myTable mt1
    LEFT JOIN myTable mt2
        ON mt2.Date = (
            SELECT MAX(Date)
            FROM myTable mt3
            WHERE mt3.Date < mt1.Date
        )
ORDER BY mt1.date 
```

## [**Sql 小提琴**](http://sqlfiddle.com/#!2/500db/2)

或者，`lag()`通过 MySql hackiness 模拟一个函数......

```
SET @kilo=0;

SELECT
    mt1.ID,
    mt1.Kilometers - @kilo AS number_km_since_last_date,
    @kilo := mt1.Kilometers Kilometers,
    mt1.date
FROM myTable mt1
ORDER BY mt1.date 
```

## [Sql 小提琴](http://sqlfiddle.com/#!2/500db/4)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T15:50:10.160

在 Postgres、Oracle 和 SQL-Server 2012 中，这很简单，使用以下`LAG()`函数：

```
SELECT
    id, kilometers, date,
    kilometers 
    - COALESCE( LAG(kilometers) OVER (ORDER BY date ASC, car_driver ASC, id ASC)
              , kilometers) 
        AS number_km_since_last_date
FROM
    mytable ; 
```

在 MySQL 中，我们必须做一些讨厌的构造。一个内联子查询（性能可能不是很好）：

```
SELECT
    id, kilometers, date,
    kilometers - COALESCE(
            ( SELECT p.kilometers
              FROM mytable AS p
              WHERE ( p.date = m.date AND p.car_driver = m.car_driver
                                                     AND p.id < m.id
                   OR p.date = m.date AND p.car_driver < m.car_driver
                   OR p.date < m.date
                    )
              ORDER BY p.date DESC, p.car_driver DESC
                  LIMIT 1
            ), kilometers) 
        AS number_km_since_last_date
FROM
    mytable AS m ; 
```

或自连接（已由@Michael Fredrickson 提供）或使用 MySQL 变量（也已提供）。

* * *

如果您希望计数器从 0 重新开始 every `car_id`，这将`PARTITION BY`在许多其他 DBMS 中完成：

```
SELECT
    id, kilometers, date,
    kilometers 
    - COALESCE( LAG(kilometers) OVER (PARTITION BY car_id 
                                      ORDER BY date ASC, car_driver ASC, id ASC)
              , kilometers) 
        AS number_km_since_last_date
FROM
    mytable ; 
```

它可以像这样在 MySQL 中完成：

```
SELECT
    id, kilometers, date,
    kilometers - COALESCE(
            ( SELECT p.kilometers
              FROM mytable AS p
              WHERE p.car_id = m.car_id
                AND ( p.date = m.date AND p.car_driver = m.car_driver
                                                     AND p.id < m.id
                   OR p.date = m.date AND p.car_driver < m.car_driver 
                   OR p.date < m.date
                    )
              ORDER BY p.date DESC, p.car_driver DESC
                  LIMIT 1
            ), kilometers) 
        AS number_km_since_last_date
FROM
    mytable AS m ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:01:48.720

对于未排序的数据，我只能想到内联子查询（在大表上不是一个好主意）：

```
select t1.*,
t1.Kilometers - (select top 1 kilometers from mytable t2 where t2.date < t1.date order by t2.date desc) as number_km_since_last_date
from mytable t1 
```

如果您对数据进行排序，则可以使用左连接

```
select t1.*
t1.Kilometers - t2.Kilometers as number_km_since_last_date
from mytable t1
left join mytable t2
  on t1.id = t2.id + 1 
```

你可能会说我更像是一个 TSQL 人，所以你可能需要调整 MySQL 的语法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-23T00:41:28.170

这是在此用例中使用 CURSOR 的示例

```
CREATE TABLE TEMP1
(
    MyDate DATETIME,
    MyQty INT
)

INSERT INTO TEMP1 VALUES ('01/08/17', 100)
INSERT INTO TEMP1 VALUES ('01/09/17', 120)
INSERT INTO TEMP1 VALUES ('01/10/17', 180)

DECLARE @LastDate DATETIME = NULL
DECLARE @LastQty INT = NULL
DECLARE @MyDate DATETIME = NULL
DECLARE @MyQty INT = NULL

DECLARE mycursor CURSOR FOR
SELECT MyDate, MyQty FROM TEMP1 ORDER BY MyDate
OPEN mycursor
FETCH NEXT FROM mycursor INTO @MyDate, @MyQty

WHILE @@FETCH_STATUS = 0  
BEGIN  

    SELECT @MyDate, @MyQty - @LastQty

    SET @LastDate = @MyDate
    SET @LastQty = @MyQty

FETCH NEXT FROM mycursor INTO @MyDate, @MyQty
END

CLOSE mycursor
DEALLOCATE mycursor 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-03T07:52:55.917

使用 MySQL 8，您可以使用 CTE 和 ROW_NUMBER 窗口函数来进行更具可读性的查询

```
WITH cte_name AS (
    SELECT
    ROW_NUMBER() OVER (ORDER BY update_time) as row_num,
    id,
    other_data,
    update_time
    FROM table_name WHERE condition = 'some_condition'
)
SELECT t2.id, t2.other_data, TIMEDIFF(t2.update_time, t1.update_time) AS time_taken
FROM
cte_name t1
JOIN cte_name t2 ON t1.row_num = t2.row_num-1
ORDER BY time_taken; 
```

在此示例中，我尝试获取日期时间值之间的差异。

*   这个想法是使用 ROW_NUMBER 窗口函数在按 update_time 排序后为每一行分配一个增量编号。
*   CTE 允许我们编写子查询，而不必重复编写相同的代码。
*   我们自己加入 CTE。连接条件基本上是 - 第二个子查询的每个 nᵗʰ 项与第一个子查询的 n-1ᵗʰ 项连接（这也意味着第一行将从结果集中消失。如果需要，可以使用 UNION 添加第一行开始）。

有一些很好的教程： [CTE（通用表表达式）](https://www.mysqltutorial.org/mysql-cte/)，[ROW_NUMBER](https://www.mysqltutorial.org/mysql-window-functions/mysql-row_number-function/)甚至[窗口函数](https://www.mysqltutorial.org/mysql-window-functions/)

# security - 在移动 Web 应用程序中混合安全和不安全的内容

> ID：14857164
> 
> 赞同：3
> 
> 时间：2013-02-13T15:37:25.457
> 
> 标签：security, ssl

我有一个使用 SSL 服务的移动网站。我们需要播放一些遗憾的是不能使用 ssl 播放的音频文件 如果我通过 http 为它们提供服务，它们播放得很好 问题是，如果我这样做，我是否会削弱 ssl 提供的安全性？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T18:50:07.193

如果您有资源，最好的方法是让您的服务器通过 SSL 接收用户的请求，然后动态创建一个常规的 HTTP URL，客户端可以从该 URL 重定向以接收内容。除了通过此链接提供的音频之外，绝对不提供任何其他服务，并且不要交换任何 cookie/令牌/密钥等。此外，如果您使用令牌来跟踪会话，请务必在 cookie 上设置安全标志，以便用户的浏览器不会'除非通过 SSL/HTTPS 连接，否则不传输令牌的内容，否则令牌将在重定向后通过 HTTP 以明文形式发送。实现这一点的技术因平台而异，否则我将提供更具体的说明来实现这一点。但是，它很常见，因此应该很容易找到。

这也可能有助于提高性能，因为通过避免 SSL 加密，您将在服务器端节省大量处理。只要音频不敏感，这就是要走的路。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T04:48:17.850

我*认为*只要它不能注入脚本就可以了。不过，攻击者仍然可以替换视频，可能是为了利用视频解码器中的漏洞或更普通的网络钓鱼。这也意味着您不保护视频的机密性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T00:01:24.390

先问一个问题。您是否尝试在默认浏览器中播放这些音频，或者您有播放它的应用程序？（我的猜测是您是使用浏览器，因为您无法更改客户端）。

如果您提供更多关于您的问题的背景知识，这将很有用。通过这种方式，人们可能会想出各种有趣的解决方法。

此外，您还想检查浏览器将如何处理它。例如，某些浏览器会抱怨此类事情（不安全的内容）。对于某些用户来说，这可能是一个关闭。

我认为 ssl 会在这种情况下幸存下来（你不会削弱它）:) 但是，这些音频将是清晰的，并且对所有类型的攻击都是开放的（ssl 可以防止这种攻击）。所以，最关键的问题是你是否在乎。

如果你播放一些简单的音频效果，你可能不会核心。如果您播放一些专有的有声读物，这对您来说可能非常重要。

**更新 1**

还有一个想法（抱歉，我无法提供经过全面测试的解决方案，因为我在这里超出了我的深度）。

您是否考虑使用脚本（通过安全通道）下载此音频，将其存储在本地存储中（我相信 HTML 5 允许）或将其存储在内存中并从该本地存储中读取。

这样你就可以解决你的问题。

# backbone.js - 加载主布局之前的视图加载

> ID：14857166
> 
> 赞同：1
> 
> 时间：2013-02-13T15:37:27.520
> 
> 标签：backbone.js, requirejs

这是来自[Backbone 样板的后续问题：“this.model is undefined”](https://stackoverflow.com/questions/14819560/backbone-boilerplate-this-model-is-undefined)。我能够解决一些结构，但遇到了一个新问题。我正在使用骨干样板，它使用 layoutManager 适配器来设置视图。主视图以及随后的第一个视图似乎正在正确加载所有资产，尽管后续视图似乎在主视图加载之前触发。这是我的路由器文件：

```
define([
    // Application.
    "app",

    //Modules
    "modules/homepage"
],
    function (app, Homepage) {
        "use strict";

        // Defining the application router, you can attach sub routers here.
        var Router = Backbone.Router.extend({
            initialize: function(){
                var collections = {
                    homepage: new Homepage.Collection()
                };

                _.extend(this, collections);

                app.useLayout("main-frame").setViews({
                    ".homepage": new Homepage.Views.Index(collections)
                }).render();
            },

            routes:{
                "":"index"
            },

            index: function () {
                this.reset();
            },

            // Shortcut for building a url.
            go: function() {
                return this.navigate(_.toArray(arguments).join("/"), true);
            },

            reset: function() {
                // Reset collections to initial state.
                if (this.homepage) {
                    this.homepage.reset();
                }

                // Reset active model.
                app.active = false;
            }

        });

        return Router;
    }
); 
```

这是我的模块：

```
define([
    "app",
    ["localStorage"]
],
function(app){
    "use strict";

    var Homepage = app.module();

    Homepage.Model = Backbone.Model.extend({

        defaults: function(){
            return {
                homepage: {}
            };
        }
    });

    Homepage.Collection = Backbone.Collection.extend({
        //localStorage: new Backbone.LocalStorage("Homepage.Collection"),

        refreshFromServer: function() {
            return Backbone.ajaxSync('read', this).done( function(data){
                console.log(data);
                //save the data somehow?
            });
        },

        /*model: Homepage.Model,*/

        cache: true,

        url: '/app/json/test.json',

        initialize: function(options){
            if (options) {
                this.homepage = options.homepage;
            }else{
                //this.refreshFromServer();
            }
        }
    });

    Homepage.Views.Index = Backbone.View.extend({
        template: "homepage",
        el: '#mainContent',

        serialize: function() {
            return {
                collection: this.options.homepage
            };
        },

        initialize: function(){
            this.listenTo(this.options.homepage,{
                "reset": this.render,
                "fetch": function(){
                    $(this.el).html("Loading...");
                }
            });

        }
    });

    return Homepage;
}); 
```

如您所见，“main-frame”模板是加载到页面中的主模板。我希望稍后加载主页模板，该模板将填充到 ID“#mainContent”中。但在这种情况下，“#mainContent”还不存在，因此主页模板不会加载到任何地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:52:01.793

这看起来不对：

```
define([ // <- first bracket
    "app",
    ["localStorage"] // <- second bracket
],
function(app){
... 
```

是它在你的代码中的样子，还是一些复制粘贴的侥幸？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:41:54.883

经过一番努力，我决定放弃骨干模板，现在使用 Backbone/RequireJS/localStorage 适配器进行以下设置：

**应用程序.js：**

```
define([
    'jquery',
    'underscore',
    'backbone',
    'router' // Request router.js
], function($, _, Backbone, Router){
    var initialize = function(){
        Router.initialize();
    };

    return {
        initialize: initialize
    };
}); 
```

**主.js**：

```
require.config({
    paths: {
        jquery: 'libs/jquery',
        underscore: 'libs/underscore',
        backbone: 'libs/backbone',
        'backbone.localStorage': 'libs/backbone.localStorage',
        templates: 'templates'
    },
    shim: {
        underscore: {
            exports: '_'
        },
        backbone: {
            deps: ['underscore','jquery'],
            exports: 'Backbone'
        },
        'backbone.localStorage': {
            deps: ['backbone'],
            exports: 'Backbone'
        }
    }
});

require([
    'app'

], function(App){
    App.initialize();
}); 
```

**路由器.js**：

```
define([
    'jquery',
    'underscore',
    'backbone',

    //Modules
    "modules/homepage"
],
    function ($, _, Backbone, Homepage) {
        "use strict";

        // Defining the application router, you can attach sub routers here.
        var Router = Backbone.Router.extend({
            routes:{
                "":"index"
            }
        });

        var initialize = function(){

            var app_router = new Router;

            app_router.on('route:index', function(){
                // Call render on the module we loaded in via the dependency array
                var collection = new Homepage.Collection();
                var homepage;
                collection.fetch({
                    success: function(){
                        if(collection.length === 0){
                            console.log('refreshing from server...');
                            collection.refreshFromServer({
                                success: function(data){
                                    collection.add(data);
                                    collection.invoke('save');
                                    homepage = new Homepage.Views.Index({
                                        collection: collection
                                    }).render();
                                }
                            })
                        }else{
                            console.log('already loaded in localStorage...');
                            homepage = new Homepage.Views.Index({
                                collection: collection
                            }).render();
                        }
                    }
                });

            });

            Backbone.history.start();
        };
        return {
            initialize: initialize
        };
    }
); 
```

**主页.js：**

```
define([
    "jquery",
    "underscore",
    "backbone",
    "backbone.localStorage",
    "text!templates/homepage.html"
],
function($, _, Backbone, localStorage, homepageTemplate){
    "use strict";

    var Homepage = { Views: {} };

    Homepage.Model = Backbone.Model.extend({

        defaults: function(){
            return {
                homepageData: {}
            };
        }
    });

    Homepage.Collection = Backbone.Collection.extend({
        localStorage: new Backbone.LocalStorage("RGPData"),

        refreshFromServer: function(options) {
            return Backbone.ajaxSync('read', this, options);
        },

        url: 'json/test.json',

        model: Homepage.Model
    });

    Homepage.Views.Index = Backbone.View.extend({
        template:"homepage",
        el: '#mainContent',

        initialize: function(){
            this.listenTo(this.collection, 'change', this.render);
            this.listenTo(this.collection, 'destroy', this.remove);
        },

        render: function(){
            console.log('rendering...');
            $(this.el).html( homepageTemplate, this.collection);
            return this;
        }
    });

    return Homepage;
}); 
```

这样做的方式是，我让应用程序使用 localStorage 适配器，同时如果 localStorage 为空，我的集合中有一个“refreshFromServer”可以从 JSON 文件中读取。集合在路由器中获取，然后插入到视图中。

我花了相当长的时间来发现一切是如何运作的，所以希望这个答案能帮助其他人比我更好地站稳脚跟。

几个注意事项，我使用 text.js 来引入模板。

另一个注意事项，我尝试包括backbone.localStorage并返回为'Backbone'（如[http://kilon.org/blog/2012/08/build-backbone-apps-using-requirejs/](http://kilon.org/blog/2012/08/build-backbone-apps-using-requirejs/)中所述），但出于某种原因那没有用，我的 homepage.js 文件一直说“Backbone.Model 未定义”。因此，我最终将两者都包含在定义中。

# c# - 将控制台输出设置为特定行

> ID：14857167
> 
> 赞同：0
> 
> 时间：2013-02-13T15:37:30.523
> 
> 标签：c#, .net, console

我有一个正在开发的控制台应用程序，它使用 Console.WriteLine（在单独的线程上）输出与事件相关的实时信息。该应用程序还允许用户通过 Console.ReadLine() 输入命令。当输出在用户输入命令的同时发生时，输出与输入混合在一起。因此，我正在寻找一种方法来保留控制台窗口的底行以供输入，同时将输出设置为显示在倒数第二行（并从那里向上滚动），从而避免混合。

任何有关如何使其工作的建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:39:36.877

您可以使用 Console.SetCursorPosition 然后使用 Console.Write

[http://msdn.microsoft.com/en-us/library/system.console.setcursorposition.aspx](http://msdn.microsoft.com/en-us/library/system.console.setcursorposition.aspx)

但是您不能使用 Console.ReadLine，请尝试使用[Console.ReadKey(false)](http://msdn.microsoft.com/en-us/library/system.console.readkey.aspx)，然后在最后一行写入输入的键。实际上，您必须使用 ReadKey 和 Write 来模拟 Console.ReadLine。

# vb.net - 无法在电子邮件上发送多个附件，只能发送一个文件附件

> ID：14857168
> 
> 赞同：0
> 
> 时间：2013-02-13T15:37:34.087
> 
> 标签：vb.net, winforms, visual-studio-2010, .net-4.0, email-attachments

我有一个工作的 vb.net，它会向收件人发送一封带有附件的电子邮件，其中还包含来自字段的数据。但我有两个问题：

1.  即使我选择了多个文件，我也无法将多个文件附加到电子邮件中。
2.  我希望能够查看我附加的内容，以便在必要时删除附件，然后再提交表单上的详细信息。

非常感谢您的帮助，谢谢。

我有一个附件按钮，您可以浏览它：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim openDLG As New OpenFileDialog

    openDLG.AddExtension = True
    openDLG.ReadOnlyChecked = True
    openDLG.Multiselect = True
    openDLG.Title = "Select the file(s) you want added to the message..."
    openDLG.Filter = "All Files (*.*)|*.*"

    If openDLG.ShowDialog = Windows.Forms.DialogResult.OK Then

        For Each item As String In openDLG.FileNames

            'Create a new System.NET.Mail.Attachment class instance for each file.
            attachToMsg = New System.Net.Mail.Attachment(item)

        Next

        MsgBox("I have finished adding all of the selected files! You can do more if you want!")

    End If 
```

然后我有一个提交按钮，它从表单发送所有信息，包括附件：

```
 Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
    Using message As New MailMessage()

        message.From = (New MailAddress(TextBox3.Text.ToString()))
        message.[To].Add(New MailAddress("benjamin.boothe@experian.com"))
        message.Subject = "New commission query"

        message.Attachments.Add(attachToMsg)

        Dim MsgBody As String
        MsgBody = TextBox1.Text.ToString() & vbCr & _
                  TextBox2.Text.ToString() & vbCr & _
                  TextBox3.Text.ToString() & vbCr & _
                  ComboBox1.Text.ToString() & vbCr & _
                  ComboBox2.Text.ToString() & vbCr & _
                  ComboBox3.Text.ToString() & vbCr & _
                  ComboBox4.Text.ToString() & vbCr
        message.Body = MsgBody
        Dim client As New SmtpClient()
        client.Host = "mailhost"
        client.Send(message)

    End Using

    MessageBox.Show("Your request has been submitted!", "Congratulations!")
    'close form
    Me.Close()
End Sub 
```

结束类

果酱

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:37:09.100

您定义了一次附件对象并将每个文件分配给相同的附件对象。您应该将附件定义为`List(Of Attachement)`.

所以而不是

`Private attachToMsg As System.Net.Mail.Attachment`

做这个：

`Private attachmentList As List(Of System.Net.Mail.Attachment)`

然后当用户用户选择文件时：

```
attachmentList = New List(Of System.Net.Mail.Attachment)
If openDLG.ShowDialog = Windows.Forms.DialogResult.OK Then
    For Each item As String In openDLG.FileNames
        'Create a new System.NET.Mail.Attachment class instance for each file.
        attachmentList.add(New System.Net.Mail.Attachment(item))
    Next
    MsgBox("I have finished adding all of the selected files! You can do more if you want!")
End If 
```

现在在您的发送代码中添加每个附件：

```
If Not attachmentList Is Nothing Then
    For Each attachment As System.Net.Mail.Attachment In attachmentList 
        message.Attachments.Add(attachment)
    Next
End If 
```

# android - 另一个相对布局居中问题

> ID：14857171
> 
> 赞同：2
> 
> 时间：2013-02-13T15:37:53.777
> 
> 标签：android, layout, center, android-relativelayout, centering

我在相对布局末尾将确定按钮居中时遇到问题，我检查了很多类似的问题，但找不到我的错误。无论我尝试什么，确定按钮仍然偏离中心。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/frag_choix_surface"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_marginBottom="10dp"
android:layout_marginLeft="10dp"
android:layout_marginRight="10dp"
android:gravity="center"
android:orientation="vertical" >

<TextView
    android:id="@+id/textViewNbPieces"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginTop="10dp"
    android:text=""
    android:textStyle="bold" />

<LinearLayout
    android:id="@+id/pieces"
    android:layout_marginTop="20dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textViewSurface"
    android:gravity="center"
     >

    <TextView
        android:id="@+id/textViewChmin"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_marginLeft="30dp"
        android:layout_marginRight="10dp"
        android:gravity="center"
        android:text="min :" />

    <kankan.wheel.widget.WheelView android:id="@+id/nb_piece_min"
        android:layout_height="wrap_content"
        android:layout_width="50dp"/>

    <TextView
        android:id="@+id/textViewChmax"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_gravity="center"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:gravity="center"
        android:text="max :" >

    </TextView>

    <kankan.wheel.widget.WheelView android:id="@+id/nb_piece_max"
        android:layout_height="wrap_content"
        android:layout_width="50dp"
        android:layout_marginRight="40dp"/>

</LinearLayout>

<Button
    android:id="@+id/buttonOkNbPieces"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/pieces"
    android:layout_marginTop="20dp"
    android:text="OK" />

</RelativeLayout> 
```

抱歉，我无法提供屏幕截图，我是该网站的新手，没有任何代表！有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T15:42:47.033

在`RelativeLayout`你必须使用`android:layout_centerHorizontal`,`android:layout_centerVertical`或`android:layout_centerInParent`属性。

将 xml 的按钮部分更改为：

```
<Button
    android:id="@+id/buttonOkNbPieces"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/pieces"
    android:layout_marginTop="20dp"
    android:layout_centerHorizontal="true"
    android:text="OK" /> 
```

并从父级中移除属性`android:gravity`，这些属性会影响内部项目的中心位置。所以应该这样定义：`android:layout_marginLeft``android:layout_marginRight``RelativeLayout``RelativeLayout`

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/frag_choix_surface"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp" > 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:52:43.510

```
Hope i answered your question.

    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/frag_choix_surface"
android:layout_width="fill_parent"
android:layout_height="match_parent"
android:layout_marginBottom="10dp"
android:layout_marginLeft="10dp"
android:layout_marginRight="10dp"
android:orientation="vertical" >

<TextView
    android:id="@+id/textViewNbPieces"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginTop="10dp"
    android:text=""
    android:textStyle="bold" />

<LinearLayout
    android:id="@+id/pieces"
    android:layout_marginTop="20dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textViewSurface"
    android:gravity="center"
     >

    <TextView
        android:id="@+id/textViewChmin"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_marginLeft="30dp"
        android:layout_marginRight="10dp"
        android:gravity="center"
        android:text="min :" />

    <kankan.wheel.widget.WheelView android:id="@+id/nb_piece_min"
        android:layout_height="wrap_content"
        android:layout_width="50dp"/>

    <TextView
        android:id="@+id/textViewChmax"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_gravity="center"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:gravity="center"
        android:text="max :" >

    </TextView>

    <kankan.wheel.widget.WheelView android:id="@+id/nb_piece_max"
        android:layout_height="wrap_content"
        android:layout_width="50dp"
        android:layout_marginRight="40dp"/>

</LinearLayout>

<Button
android:layout_marginLeft="111dp"
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/pieces"
    android:layout_marginTop="14dp"
    android:text="Button" />

</RelativeLayout> 
```

# c# - C# Excel 下拉事件

> ID：14857173
> 
> 赞同：3
> 
> 时间：2013-02-13T15:37:58.530
> 
> 标签：c#, excel, vba, dropdownbox

我有一个 Excel 电子表格，它位于用 C# 编写的自动化测试应用程序中。测试应用程序使用最终统计数据填充工作表，然后使用电子表格生成指标。该过程的一部分是将下拉列表放入电子表格的 L 列，并将其关联的 VBA 更改事件从应用程序写入工作表中。

这是将下拉列表写入电子表格 Excel.DropDown xlDropDown 的代码；

```
//set range for insert cell
 range = wrkSheet.get_Range("L" + (x + 9).ToString() + ":L" + (x + 9).ToString());

//insert the dropdown into the cell
xlDropDown = xlDropDowns.Add((double)range.Left, (double)range.Top, (double)range.Width, (double)range.Height, true);

//set the nbame of the new dropdown
xlDropDown.Name = "expFail" + (x + 1).ToString();

//assign dropdown name to cmbName 
cmbName = xlDropDown.Name;

 //call function to write change macro for this box 
 cmbWriteMacro(cmbName, xlApp, xlBook, wrkSheet); 
```

cmbWrite 函数：

```
 StringBuilder sb;
    VBA.VBComponent xlModule;
    VBA.VBProject prj;
    string modName;
    int modExists;

    prj = wrkBook.VBProject;
    modExists = 0;

    sb = new StringBuilder();

    //build string with module code 
    sb.Append("Sub " + cmbName + "_Change()" + "\n");
    sb.Append("\t" + "Call lstBox_Update(" + cmbName + ")" + "\n");
    sb.Append("End Sub");

    foreach (VBA.VBComponent comp in prj.VBComponents)
    {
        modName = comp.Name;

        if (modName == "Module2")
        {
            modExists = 1;
            break;
        }
    }

     //check to see if module already exists
     if (modExists != 1)
     {
        //set an object for the new module to create
        xlModule = wrkBook.VBProject.VBComponents.Add(VBA.vbext_ComponentType.vbext_ct_StdModule);
     }
     else
     {
        xlModule = wrkBook.VBProject.VBComponents.Item("Module2");
     }

     //add the cmbbox macro to the spreadsheet
     xlModule.CodeModule.AddFromString(sb.ToString()); 
```

这会将以下 VBA 事件写入电子表格，以便在记录失败时在工作表中执行操作。

```
Sub expFail1_Change(ByVal Target As Range)
    Call lstBox_Update("expFail1")
End Sub 
```

所有下拉菜单都会根据选择的内容调用相同的函数 (lstBox_Update)。

一切正常。下拉菜单显示在它们应该出现的位置，并且宏正在正确地写入电子表格中。问题似乎是在更改选择时触发相关的更改事件。解决方案可能很简单，但我已经看了一遍，似乎找不到答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:05:31.807

I just did a small example based on your code. After some googling around and testing some source code pieces it comes down to a *single line of code*:

```
xlDropDown.Name = "expFail" + (x + 1).ToString(); // your code
xlDropDown.OnAction = xlDropDown.Name + "_Change"; // new code: IMPORTANT 
```

Found this code within an [Microsoft KB article](http://support.microsoft.com/kb/303872/en) **How To Create an Excel Macro by Using Automation from Visual C# .NET**.

It seems that you need this line of code to **set some kind of delegate** pointing to your custom vba code.

In case you need my complete source let me know and I will mail it to you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:10:31.843

您必须将更改事件写入创建组合框的工作表（而不是 VBA 模块“module2”。组合框是工作表（对象）的一部分，所有事件处理程序都必须在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:20:37.637

根据[这篇文章](http://www.c-sharpcorner.com/uploadfile/vasanthks/excel-dropdownlist-change-event-using-vba/)，您需要将代码写入`Worksheet_Change`事件，而不是`ComboBox_Change`事件：

```
Sub Worksheet_Change(ByVal Target As Range)
    Call lstBoxUpdate("expFail1")
End Sub 
```

# java - 从 AutoPopulatingList 中删除项目

> ID：14857175
> 
> 赞同：0
> 
> 时间：2013-02-13T15:38:06.223
> 
> 标签：java, spring, spring-mvc

我已经成功实现了一个 AutoPopulatingList。我有一个增加 id 的 javascript，在后台 Spring 正在创建我的漂亮列表。

顺便说一句，我在删除项目时遇到了一些问题。我正在使用向导控制器，我试图“返回”并删除几个项目。然后，继续前进……惊喜！物品还在！

那么，我怎样才能强制 Spring 每次都创建一个新的 AutoPopulatingList 呢？或者我错过了什么？

这是我在工厂的清单：

```
private AutoPopulatingList<Event> events = new AutoPopulatingList<Event>(new EventElementFactory());

public class EventElementFactory implements ElementFactory { 
    @Override
    public Event createElement(int index) throws ElementInstantiationException {            
        Event e = new Event(); 
        e.setModContr(""); 
        e.setDesc("");          
        return e; 
    } 
} 
```

我在控制器中有这个 initBinder（不知道为什么，但没有它就无法工作）：

```
binder.setAutoGrowNestedPaths(false); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:18:48.000

最后我以这种方式解决了：

在我的jsp中，我添加了一个隐藏字段

```
<input name="_clearEventList" type="hidden" value="true" /> 
```

在我的控制器中

```
protected void initBinder(HttpServletRequest request, ServletRequestDataBinder binder) throws Exception {
    if(Boolean.valueOf(request.getParameter("_clearEventList"))) {
        ((MyForm)binder.getTarget()).getEvents().clear();
    }
    binder.setAutoGrowNestedPaths(false);
} 
```

所以这将在该页面前进（或后退）时清除我的列表，并强制 Spring 重新填充它。:)

# android - 有谁知道让 AT&T 的无线代理在 45 秒后不超时的方法吗？

> ID：14857178
> 
> 赞同：2
> 
> 时间：2013-02-13T15:38:13.100
> 
> 标签：android, ios, network-programming, cellular-network

我们已经验证，AT&T 的蜂窝网络（3G 或 LTE）上的长请求会在 45 秒后超时。这不会发生在 Verizon 或 Sprint 上。iOS 或 Android 手机或连接方式无关紧要。通过 WIFI 或有线网络连接到相同的 Web 服务器没有问题。您在长请求中看到的是来自 AT&T 代理的 504 错误。有谁知道是否有一个请求标头可以告诉 AT&T 代理给我们更多时间？或者有人问 AT&T？当然，我们可以实现复杂的轮询解决方案，但问题 - 被调用的系统可能需要 2 分钟才能返回任何内容 - 不在我们的控制之下。

不要指望这里有任何解决方案，但你永远不知道:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T13:08:00.250

我遇到了与 504 网关超时以及与慢速连接相关的其他问题的相同问题。

我有一个将图像和数据发送到 Web 服务器的应用程序。这些图像是 2-3MB 的高分辨率图像。我经常需要检查网关超时、损坏的 PIPE 错误、ECONNRESET 超时。在查看了 AT&T 的代理后，我发现了一个解决方法，至少在 Nexus 4 上，它涉及完全删除代理。

在 Nexus 4 上，该设置位于“设置”>“移动网络设置”>“接入点名称”>“接入点”（我的是 ATT WAP）>“代理”下。我删除了 wireless.cingular.com 并将其留空。

请注意，还有一个 MMS 代理。我认为应该不理会这个人以便接收彩信。我听说有些手机两者没有分离。在这种情况下，您可能必须创建另一个接入点来复制原始信息中的所有信息，包括代理，然后在两种模式之间进行交换。

# mysql - MySQL 需要在 group by 内返回结果集中的特定记录

> ID：14857195
> 
> 赞同：2
> 
> 时间：2013-02-13T15:39:14.397
> 
> 标签：mysql, select, join, group-by

我需要构建一个 MySQL 查询，在其中我可以根据一个或多个列值将结果分组在一起，然后返回该组中匹配某些条件的**完整**记录。

以下表为代表我的数据：

```
| ID | NAME | Editor | Modified date | Type |
|  1 | doc1 | Smith  | 2012-01-01    | A    |
|  2 | doc2 | Smith  | 2012-03-03    | A    |
|  3 | doc1 | Jones  | 2012-10-10    | A    |
|  4 | doc1 | Scott  | 2011-01-01    | A    |
|  5 | doc2 | Boyd   | 2013-01-01    | A    |
|  6 | doc3 | Smith  | 2010-01-01    | B    |
|  7 | doc4 | Smith  | 2010-03-03    | B    |
|  8 | doc3 | Jones  | 2010-10-10    | B    |
|  9 | doc3 | Scott  | 2009-01-01    | B    |
| 10 | doc4 | Boyd   | 2011-01-01    | B    | 
```

我想返回与任何文档相关的最近修改的记录，即。

```
| ID | NAME | Editor | Modified date | Type |
|  3 | doc1 | Jones  | 2012-10-10    | A    |
|  5 | doc2 | Boyd   | 2013-01-01    | A    |
|  8 | doc3 | Jones  | 2010-10-10    | B    |
| 10 | doc4 | Boyd   | 2011-01-01    | B    | 
```

或最近修改的与 A 类有关的记录

```
| ID | NAME | Editor | Modified date | Type |
|  3 | doc1 | Jones  | 2012-10-10    | A    |
|  5 | doc2 | Boyd   | 2013-01-01    | A    | 
```

我已经尝试过 GROUP BY 和 HAVING，据我所知，他们不会返回整个记录。

附录：可能是我需要将“最近”限定符更改为“在给定日期之前”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:46:11.197

如果要返回最近修改的行，则可以使用：

```
select *
from yourtable t1
where `Modified date` = (select max(`Modified date`)
                         from yourtable t2
                         where t1.NAME = t2.NAME
                         group by `NAME`); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e90ab/6)

如果您想只返回带有 的那些`type='A'`，那么以下方法将起作用：

```
select *
from yourtable t1
where `Modified date` = (select max(`Modified date`)
                         from yourtable t2
                         where t1.NAME = t2.NAME
                         group by `NAME`)
  and type = 'A'; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e90ab/8)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:46:40.167

使用子查询：

```
SELECT tbl.* FROM tbl
INNER JOIN (
    SELECT max(Modifed_date) as newestRecordDate, Editor
    FROM tbl
    GROUP BY Editor
) as Newest
on tbl.Modifed_Date = Newest.NewestRecordDate 
```

按类型：

```
SELECT * FROM tbl
INNER JOIN (
    SELECT max(Modifed_date) as newestRecordDate, Editor
    FROM tbl
    GROUP BY Editor
) as Newest
ON tbl.Modifed_Date = Newest.NewestRecordDate
WHERE Type = 'A' 
```

请注意，Modified Date 的可能问题不包括时间，并且每天有多个编辑 - 确保此记录也包括时间组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:48:51.730

试试这个：

**对于第一个问题：**

```
SELECT a.ID, a.name, a.Editor, a.ModifiedDate, a.Type 
FROM tableName a 
INNER JOIN (SELECT b.name, MAX(b.ModifiedDate) ModifiedDate 
            FROM tableName b GROUP BY b.name
           ) b ON a.name = b.name AND a.ModifiedDate = b.ModifiedDate 
```

**输出**

```
| ID | NAME | EDITOR |                   MODIFIEDDATE | TYPE |
--------------------------------------------------------------
|  3 | doc1 |  Jones | October, 10 2012 00:00:00+0000 |    A |
|  5 | doc2 |   Boyd | January, 01 2013 00:00:00+0000 |    A |
|  8 | doc3 |  Jones | October, 10 2010 00:00:00+0000 |    B |
| 10 | doc4 |   Boyd | January, 01 2011 00:00:00+0000 |    B | 
```

**并过滤`Type='A'`：**

```
SELECT a.ID, a.name, a.Editor, a.ModifiedDate, a.Type 
FROM tableName a 
INNER JOIN (SELECT b.name, MAX(b.ModifiedDate) ModifiedDate 
            FROM tableName b GROUP BY b.name
           ) b ON a.name = b.name AND a.ModifiedDate = b.ModifiedDate 
WHERE a.Type = 'A' 
```

**输出**

```
| ID | NAME | EDITOR |                   MODIFIEDDATE | TYPE |
--------------------------------------------------------------
|  3 | doc1 |  Jones | October, 10 2012 00:00:00+0000 |    A |
|  5 | doc2 |   Boyd | January, 01 2013 00:00:00+0000 |    A | 
```

检查这个[**SQL FIDDLE 演示**](http://sqlfiddle.com/#!2/61290/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:01:13.920

```
select * from your_table group by NAME order by Modified_Date DESC;
select * from your_table where Type = 'A' group by NAME order by Modified_Date DESC; 
```

# c - 带有信号量的 N 个线程的屏障

> ID：14857201
> 
> 赞同：0
> 
> 时间：2013-02-13T15:39:41.590
> 
> 标签：c

我编写了以下简短的应用程序来解决障碍问题。此应用程序应保证运行相同线程方法的三个相同线程都将在公共代码部分“相遇”。我运行它，它似乎没问题。我的问题是：

1) 正确吗？

2) 是否有一种首选且有效的方法来为 N 个线程实现它？

这是代码：

```
static sem_t t_1_sem;

static sem_t t_2_sem;

static sem_t t_3_sem;

struct my_thread_info {
    int num;
};

void *thread(void *vargp)

{

        struct my_thread_info *info = (struct my_thread_info*)vargp;
        static int counter=0;
        counter++;

        if (info->num == 1) {
                printf("info->num=%d\n", info->num);
                if (counter<3)
                    sem_wait(&t_1_sem);   // down
                else {
                    sem_post(&t_2_sem);   // up
                    sem_post(&t_3_sem);   // up                 
                }

        } else 
            if (info->num == 2) {
                printf("info->num=%d\n", info->num);
             if (counter<3)             
                    sem_wait(&t_2_sem);             
                else {
                    printf("info->num=%d\n", info->num);
                    sem_post(&t_1_sem);
                    sem_post(&t_3_sem);    //up             
            }
            } 
            else  
            if (info->num == 3) {
                printf("info->num=%d\n", info->num);
             if (counter<3)             
                    sem_wait(&t_3_sem);             
                else {
                    sem_post(&t_1_sem);
                    sem_post(&t_2_sem);    //up             
            }
        }
        printf("meeting occured!\n");

}

int main()
{
    pthread_t tid0, tid1, tid2;

    struct my_thread_info info1, info2, info3;
    info1.num = 1;

    sem_init(&t_1_sem, 0, 0);
    sem_init(&t_2_sem, 0, 0);
    sem_init(&t_3_sem, 0, 0);

    pthread_create(&tid0, NULL, thread, &info1);
    info2.num = 2;

    pthread_create(&tid1, NULL, thread, &info2);

    info3.num = 3;
    pthread_create(&tid2, NULL, thread, &info3);

    pthread_join(tid0, NULL);
    pthread_join(tid1, NULL);
    pthread_join(tid2, NULL);   
    pause();
    return 0;

} 
```

问候凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:00:16.557

1.不，这是不正确的。像这样递增`counter++;`会导致竞争条件，并且不会正确递增计数器。你想用一个关键部分包围它。

2.

```
static pthread_mutex_t cs_mutex = PTHREAD_MUTEX_INITIALIZER;
static sem_t t_sem;

void *thread(void *vargp)
{
    static int counter=0;
    pthread_mutex_lock( &cs_mutex );
    counter++;
    pthread_mutex_unlock( &cs_mutex );

    if( counter == NO_THREADS )
        sem_post( &t_sem );

    sem_wait( &t_sem );
    sem_post( &t_sem );
}
int main( int argc, char *argv[] ){

    pthread_t tids[NO_THREADS];
    sem_init( &t_sem, 0, 0 );

    for( i=0; i<NO_THREADS; i++ ){
        pthread_create(&tids[i], NULL, thread, NULL);
    }

    for( i=0; i<NO_THREADS; i++ ){
        pthread_join(&tids[i], NULL);
    }
    pause();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:45:01.117

首先，你的`counter`变量是无人看管的——你在做的时候可能有竞争条件`counter++`。使用互斥锁；

至于做 N 个线程 - 使用线程/信号量数组是 IMO 可以接受的，我有使用该设计的代码并且效果很好。

# google-chrome-extension - 如何为标题创建匹配模式

> ID：14857202
> 
> 赞同：2
> 
> 时间：2013-02-13T15:39:53.467
> 
> 标签：google-chrome-extension

我正在尝试使用[chrome.tabs.query](http://developer.chrome.com/extensions/tabs.html#query)作为标题。但是，如果我查看文档，似乎[匹配模式](http://developer.chrome.com/extensions/match_patterns.html)仅适用于 URL？我尝试的每种模式都不起作用

这是代码：

```
chrome.tabs.query({'title':searchText}, function(tabArray){
    tabbr.update(tabArray);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T22:04:48.843

匹配模式应该是通配符字符串：

```
chrome.tabs.query({'title': '*string*'}, function(tabArray){
  tabbr.update(tabArray);
}); 
```

# database - Bigquery：字段中的值数组

> ID：14857207
> 
> 赞同：2
> 
> 时间：2013-02-13T15:40:23.107
> 
> 标签：database, google-bigquery

我被要求用 javascript 开发一个客户端应用程序来查询存储在 BigQuery 上的一些表，所以目前我正在掌握查询语法。

我的架构除其他外具有以下字段：

```
download_speed: FLOAT
real_address: STRING
timestamp: INTEGER
upload_speed: FLOAT
[...] 
```

我想找到不同日期聚合的平均上传和下载速度，并跟踪不同的 IP，所以我写了这个查询：

```
SELECT LEFT( FORMAT_UTC_USEC(UTC_USEC_TO_DAY(timestamp*1000000)),10) as date_day,
AVG (download_speed)avg_download,
AVG (upload_speed)avg_upload,
real_address
FROM [xxxxxxxxxxxx:xxxxxxx.xxxx]
GROUP BY date_day, real_address
ORDER BY date_day ASC 
```

这没关系，但结果是平的，我需要每天汇总平均速度，以便我可以在时间轴上绘制它们。一种可能性是处理查询客户端返回的 json，但是对于大量的数据集和许多具有不同地址的不同用户（正如我们应该拥有的那样），这种方法对我来说听起来像是自杀。

所以我问自己是否有一种方法可以在一个字段中保存一个包含给定日期的所有地址的数组。我想返回这个元组结构：

```
+---------------+-------------------+--------------------+--------------------+
|    date_day   |   avg_download    |   avg_upload       |   real_addr_list   |
+---------------+-------------------+--------------------+--------------------+
|               |                   |                    |   79.20.xx.xx,     |
|   2013-01-13  |   510574.63       |    29599.92        |   151.46.xxx.xx,   |
|               |                   |                    |   151.70.xx.xx     |
+---------------+-------------------+--------------------+--------------------+ 
```

这是可能的，还是我被迫在 BigQuery 之外处理结果？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:44:39.443

好的，我发现 BigQuery 支持 GROUP_CONCAT('str') 函数，用法如下：

> 将多个字符串连接成一个以逗号分隔的字符串，就像字符串的 SUM() 一样。将此与分组语句和 str 的字段名称一起使用，以将组中所有字符串值的列表连接成单个字符串

如果有人感兴趣，查询是：

```
SELECT LEFT( FORMAT_UTC_USEC(UTC_USEC_TO_DAY(timestamp*1000000)),10) as date_day,
AVG (download_speed)avg_download,
AVG (upload_speed)avg_upload,
GROUP_CONCAT(real_address)as real_address_list
FROM [xxxxxxx:xxxxx.xxxxx]
GROUP BY date_day
ORDER BY date_day ASC 
```

希望这对其他人也有用。

# ms-access - vba 中的 Avaya CMS 数据提取仅在单步执行时有效

> ID：14857212
> 
> 赞同：0
> 
> 时间：2013-02-13T15:40:32.383
> 
> 标签：ms-access, vba, avaya

当我运行代码以从 CMS 报告中检索数据时，如果我单步执行代码，则代码可以工作，但如果我正常运行，它（最终）会失败，并且 MS Access 停止响应。

```
' Sets parameters for report
cmsReport.SetProperty reportPrompt(1, 1), reportPrompt(1, 2)
cmsReport.SetProperty reportPrompt(2, 1), reportPrompt(2, 2)
cmsReport.SetProperty reportPrompt(3, 1), reportPrompt(3, 2)
' Runs report and extracts results
EmptyClipboard
b = cmsReport.ExportData("", 44, 0, True, True, True)
Do While ClipboardEmpty
    ' for some reason, avaya doesn't always copy to clipboard, so keep repeating it until it gives up the data!
    b = cmsReport.ExportData("", 44, 0, True, True, True)
Loop 
```

用于检查剪贴板的子程序，并在我尝试将数据放入剪贴板之前将其清空：

```
Private Declare Function apiOpenClipboard Lib "user32" Alias "OpenClipboard" (ByVal hWnd As Long) As Long
Private Declare Function apiEmptyClipboard Lib "user32" Alias "EmptyClipboard" () As Long
Private Declare Function apiCloseClipboard Lib "user32" Alias "CloseClipboard" () As Long
Private Declare Function CountClipboardFormats Lib "user32" () As Long

Sub EmptyClipboard()
If apiOpenClipboard(0&) <> 0 Then
    Call apiEmptyClipboard
    Call apiCloseClipboard
End If
End Sub

Function ClipboardEmpty() As Boolean
ClipboardEmpty = (CountClipboardFormats() = 0)
End Function 
```

我对对象使用后期绑定，并且安装了 Avaya CMS 16.2。
我尝试设置超时，但没有成功（任一行或两者都无法解决问题）

```
cmsConnection.lTimeOutSecs = 60
cmsConnection.bTimeOutEnable = False 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:09:55.670

In my organization we have had mostly frustration hacking the undocumented VBA API to avaya CMS supervisor application. I would suggest instead using a direct ODBC connection to the Avaya server. Avaya provides plenty of documentation about how to ODBC connect to its servers. If you need help finding the avaya documentation specific to your installation please reply with the version you are working with.

# c# - 按查询分组名称

> ID：14857213
> 
> 赞同：0
> 
> 时间：2013-02-13T15:40:33.990
> 
> 标签：c#, sql, linq

我想按组对所有用户名进行分组。我试过了 ：

```
var query = from u in db.Users
            group p by u.UserGroup 
            select u.FullName; 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:44:58.760

这将返回匿名对象序列，包含 UserGroup 和该组中的所有名称：

```
var query = from u in db.Users
            group u by u.UserGroup into g
            select new {
               UserGroup = g.Key,
               Names = g.Select(x => x.FullName)
            }; 
```

# ios - 如何缓存 AVPlayerItem（视频）以便在 UITableview 中重用

> ID：14857215
> 
> 赞同：7
> 
> 时间：2013-02-13T15:40:37.453
> 
> 标签：ios, uitableview, caching, video, avplayer

我在 UITableView 中显示了许多视频。视频远程存储在服务器上。我可以使用以下一些代码将视频加载到 tableview 中。

```
 NSString *urlString = [NSString stringWithFormat:[row objectForKey:@"video_uri"]];
 NSURL* url = [NSURL URLWithString:urlString];
 AVPlayerItem *pItem = [AVPlayerItem playerItemWithURL:url];
 AVPlayer *player = [AVPlayer playerWithPlayerItem:pItem]; 
```

每次 tableview 将单元​​格出列然后再次重新排队时，视频都会再次从 url 加载。我想知道是否有办法下载和缓存或保存视频，以便可以从手机播放而无需再次连接。我试图绘制苹果提供的[LazyTableImages](http://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html)示例中使用的技术，但我有点卡住了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-05T02:05:49.260

在尝试缓存 AVPlayerItems 失败后，我得出的结论是，如果缓存 AVPlayerItem 的底层 AVAsset 可以重用，而 AVPlayerItem 本身不打算重用，效果会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T19:22:30.563

有一种方法可以做到这一点，但它可能会对旧设备造成负担，随后导致您的应用程序被 MediaServerD 抛弃。

创建后，将每个玩家保存到 NSMutableArray 中。数组中的每个索引都应该对应 UITableView 的 indexPath.row。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-12T19:59:34.987

昨天刚和朋友一起解决这个问题。我们使用的代码基本上使用了 NSURLSession 内置的缓存系统来保存视频数据。这里是：

```
 NSURLSession *session = [[KHURLSessionManager sharedInstance] session];
    NSURLRequest *req = [[NSURLRequest alloc] initWithURL:**YOUR_URL**];
    [[session dataTaskWithRequest:req completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) {

        // generate a temporary file URL

        NSString *filename = [[NSUUID UUID] UUIDString];

        NSURL *temporaryDirectoryURL = [NSURL fileURLWithPath:NSTemporaryDirectory() isDirectory:YES];
        NSURL *fileURL = [[temporaryDirectoryURL URLByAppendingPathComponent:filename] URLByAppendingPathExtension:@"mp4"];

        // save the NSData to that URL
        NSError *fileError;
        [data writeToURL:fileURL options:0 error:&fileError];

        // give player the video with that file URL
        AVPlayerItem *playerItem = [AVPlayerItem playerItemWithURL:fileURL];
        AVPlayer *player = [AVPlayer playerWithPlayerItem:playerItem];
        _avMovieViewController.player = player;
        [_avMovieViewController.player play];

    }] resume]; 
```

其次，您需要为 NSURLSession 设置缓存配置。我的 KHURLSessionManager 使用以下代码处理此问题：

```
 NSURLSessionConfiguration *config = [NSURLSessionConfiguration defaultSessionConfiguration];
    config.requestCachePolicy = NSURLRequestReturnCacheDataElseLoad;
    _session = [NSURLSession sessionWithConfiguration:config delegate:self delegateQueue:[NSOperationQueue mainQueue]]; 
```

最后，您应该确保您的缓存足够大以容纳文件，我将以下内容放在我的 AppDelegate 中。

```
 [NSURLCache sharedURLCache].diskCapacity = 1000 * 1024 * 1024; // 1000 MB 
```

希望这可以帮助。

# dotnetnuke - 是否可以在 DNN 5 站点上编写 SSO Web 服务？

> ID：14857217
> 
> 赞同：0
> 
> 时间：2013-02-13T15:40:40.683
> 
> 标签：dotnetnuke, single-sign-on

客户有 2 个较旧的 DNN 5 站点，他们希望建立一个新的 DNN 站点。由于他们不久前开发的单点登录功能，他们希望继续使用 DNN 5。我们推荐 DNN 7 的原因很明显。

我们想构建一个可以从 DNN7 站点调用的 Web 服务，该服务将使他们登录到其他 DNN 5 站点。像这样的东西可以与 DNN 5 集成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T11:11:20.233

我不想做广告，但我工作的公司 Interzoic 有一款像你描述的那样的产品，所以是的，这是可能的。这是产品页面的链接：http: [//www.interzoic.com/single-sign-on](http://www.interzoic.com/single-sign-on)

# iphone - runloop空闲时运行代码

> ID：14857218
> 
> 赞同：2
> 
> 时间：2013-02-13T15:40:46.673
> 
> 标签：iphone, ios, ipad, cocoa-touch, uikit

我正在寻找类似的行为

```
[[NSNotificationQueue defaultQueue] enqueueNotification:not postingStyle:NSPostWhenIdle coalesceMask:NSNotificationCoalescingOnName|NSNotificationCoalescingOnSender forModes:nil]; 
```

但不使用通知，以某种方式将选择器或块排入队列而不是通知。

至于我的动机（只是看看这是否是一种合法的做法）。我在一个视图中添加了多个子视图，显然没有办法知道有多少，所以每次我添加一个子视图时，我都必须通过调用`layoutIfNeeded`以特定方式布局子视图来执行一些计算。现在，我在想，如果我只能在 runloop 空闲时调用该方法（以某种方式推迟调用并合并它），那么在它执行布局计算时所有子视图都已经添加了。希望这是有道理的。

```
-(void)layoutSubviews
{
[super layoutSubviews];

UIView* prevView = nil;
for (NSUInteger i=0; i<[self.subviews count]; i++) {
    UIView* view = self.subviews[i];
    CGFloat spacing = prevView!=nil?self.spacing:0;
    view.topLeft = CGPointOffset(prevView.bottomLeft, spacing, 0);
    prevView = view;
}

[self fitSubviews];
} 
```

添加了我的`layoutSubview`方法中的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T19:39:17.577

对于一般问题，最简单的解决方案是：

```
- (void)setNeedsCustomTask
{
    // cancel any previously scheduled call to perform the task
    [NSObject
         cancelPreviousPerformRequestsWithTarget:self
         selector:@selector(doCustomTask)
         object:nil];

    // schedule a new call; because you've specified any delay
    // at all this will be scheduled to occur in the future rather than
    // right now and because you've specified a 0.0 delay it'll be
    // as soon as possible in the future
    [self performSelector:@selector(doCustomTask) withObject:nil afterDelay:0.0];
}

- (void)doCustomTask
{
    NSLog(@"I am a custom task");
} 
```

之所以有效，是因为`performSelector:withObject:afterDelay:`将来会在 runloop 上安排调用。您还可以指定`inModes:`例如是否要避免跟踪模式。

在取消和重新安排而不是在手边保留一个标志时，显然存在一些技术上的低效率，但它很整洁，因为您不需要明确地编组状态。所以我认为首先这样做会有一个很好的过早优化论据。

# java - 设置位置不起作用

> ID：14857219
> 
> 赞同：-1
> 
> 时间：2013-02-13T15:40:48.630
> 
> 标签：java, swing, jframe

我有一个简单的 jframe，其中包含 jbutton 和 jtextfield 和 jlabe。但是，当我想为每个人设置位置时，不要移动！

```
public class myFrame extends JFrame{

JButton okButton;
JPanel mypanel;
public myFrame(){
okButton=new JButton("OK");
mypanel=new JPanel();
okButton.setLocation(100, 200);
mypanel.add(okButton);
this.add(mypanel);
setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
setSize(500, 400);
setVisible(true);

}

public static void main(String[] args){
new myFrame();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:47:13.447

试试这个：

```
public myFrame(){
okButton=new JButton("OK");
mypanel=new JPanel();
mypanel.setLayout(null);
okButton.setBounds(100, 200, 60, 30);
mypanel.add(okButton);
this.add(mypanel);
setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
setSize(500, 400);
setVisible(true);
} 
```

# asp.net - 数据绑定用户控件内的gridview

> ID：14857221
> 
> 赞同：0
> 
> 时间：2013-02-13T15:40:50.597
> 
> 标签：asp.net, .net, vb.net, gridview

我在这样的用户控件中有一个超级简单的 gridview 设置：

```
 <asp:GridView ID="gvTestUC" runat="server" AutoGenerateColumns="false">
        <Columns>
            <asp:BoundField DataField="FirstName" HeaderText="First Name" HeaderStyle-HorizontalAlign="Left" ItemStyle-HorizontalAlign="Left" />
            <asp:BoundField DataField="LastName" HeaderText="Last Name" />
            <asp:BoundField DataField="EmailAddress" HeaderText="Email Address" HeaderStyle-HorizontalAlign="Left" ItemStyle-HorizontalAlign="Left" />
        </Columns>
</asp:GridView> 
```

我正在像这样注册用户控件：

```
<%@ Register src="Controls/test1.ascx" tagname="test1" tagprefix="test1uc" %>
<test1uc:test1 ID="test1a" runat="server" /> 
```

我的问题是，我不知道如何在使用用户控件的 .aspx 页面中对其进行数据绑定。

我试着做：

```
test1a.gvTestUC 
```

但它找不到gridview。

我试图从 .aspx 页面对 gridview 进行数据绑定的原因是，所有需要此用户控件的页面都需要将不同的数据绑定到其中的 gridview。

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:45:20.693

您只需要提供一个可以从您的页面调用的公共方法。

在你的`UserControl`：

```
Public Sub BindData(gridSource As ComponentModel.IListSource)
    BindGridView(dataSource)
End Sub

Private Sub BindGridView(gridSource As ComponentModel.IListSource)
    gvTestUC.DataSource = gridSource 
    gvTestUC.DataBind()
End Sub 
```

在`Page`您想要对其进行数据绑定时：

```
test1a.BindData(GetGridDataSource()) 
```

旁注：永远不要让`UserControl`数据从`Page_Load`. 这可能会导致令人讨厌的副作用，从页面中删除控件，该页面是控制器，并且会在需要时防止延迟加载控件（在 TabIndexChanging 上使用`TabContainer`控件）。

# python - Bash 在执行命令之前擦除输出文件

> ID：14857222
> 
> 赞同：1
> 
> 时间：2013-02-13T15:40:57.300
> 
> 标签：python, bash, file-io

我有一个从 csv 文件读取并打印到标准输出的 python 脚本。默认输出必须是标准输出，而不是直接输出到文件。当我在 bash 中执行此脚本时，如下所示：

```
program.py > file.csv 
```

其中输出 file.csv 与 python 脚本正在读取的相同，它会失败。原因是 bash 在执行 python 程序之前显然会删除 file.csv。如何在 bash 中执行此操作，以便在 python 程序完成执行后删除文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:42:59.247

你可以做一些丑陋的事情，比如

```
program.py > tmp.csv && mv tmp.csv file.csv 
```

# ruby - Ruby 代码混淆

> ID：14857223
> 
> 赞同：8
> 
> 时间：2013-02-13T15:40:59.140
> 
> 标签：ruby

我必须混淆 ruby​​ 代码以隐藏敏感源。我需要朝着正确的方向前进以实现我想要的，所以：

1.  Python 的 pyc 有 Ruby 替代品吗？我在许多 gem 中看到了 version.rbc 文件。它是如何生成的？这个过程是否适用于其他（复杂的，不仅仅是简单的 VERSION 声明）类型的 Ruby 文件？

2.  RubyEncoder 完成了这项工作（是吗？在这里帮帮我），但它需要购买许可证。这就是为什么我会认为这是我最后的手段。

3.  任何其他建议

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T16:23:58.337

用 C 编写本机扩展，将敏感代码*以及*足够的程序关键逻辑放入其中，以使扩展对程序的执行至关重要。

这并不意味着某人不可能绕过或反向工程您的敏感代码，但它确实使事情变得更加困难。此外，与使 Ruby 代码难以逆向工程相比，[有更好的技术可以使编译后的代码更难逆向工程。](https://stackoverflow.com/questions/6481668/protecting-executable-from-reverse-engineering)

# php - 表格未显示随机值

> ID：14857225
> 
> 赞同：0
> 
> 时间：2013-02-13T15:41:02.437
> 
> 标签：php, arrays

好的，首先这是我的代码：

```
<table border="1" style="text-align:center;" width="400px;" height="400px;">

 <?php

    $table = range(1, 9);
    shuffle($table);

    for($i=0; $i<9; $i++){

        echo '<tr id="r'.$i.'">';

        for ($j=0; $j<9 ; $j++) { 
            echo '  <td id="r'.$i.'d'.$j.'">'.$table[$j].'</td>';
        }

        echo '</tr>';
    }

?>

</table> 
```

我要做的就是制作一个 9x9 的正方形，每行和每列都有 1-9 的唯一值。但是当我运行我的代码时，它只显示列而不是行的随机数。我想要从 1 到 9 的整个块中的随机数。

请帮我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:43:13.620

试试这个：在内部循环之前打乱 $table

```
<table border="1" style="text-align:center;" width="400px;" height="400px;">
 <?php
    $table = range(1, 9);
    for($i=0; $i<9; $i++){
        echo '<tr id="r'.$i.'">';
        shuffle($table);
        for ($j=0; $j<9 ; $j++) { 
            echo '  <td id="r'.$i.'d'.$j.'">'.$table[$j].'</td>';
        }
        echo '</tr>';
    }

?>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:29:12.920

如果您需要行和列中的唯一值，请查看[此链接](http://www.mattlefevre.com/viewExample.php?tut=PHP&proj=Sudoku%20Generator)。

您可以使用该代码或重新使用生成功能，如下所示：

```
<table border="1" style="text-align:center;" width="400px;" height="400px;"> 
```

```
$grid = generate();
foreach ($grid as $i => $row){
    echo '<tr id="r'.$i.'">';
    foreach ($row as $j => $cell){
        echo '  <td id="r'.$i.'d'.$j.'">'. $cell .'</td>';
    }
    echo '</tr>';
}

function generate() {
    $vGrid = $hGrid = array();
    $numbers = range(1,9);      
    for($x = 0; $x < 9; $x++) {
        for($y = 0; $y < 9; $y++) {
            $hGrid[$x] = !isset($hGrid[$x]) ? array() : $hGrid[$x];
            $vGrid[$y] = !isset($vGrid[$y]) ? array() : $vGrid[$y];
            $options = array_diff($numbers,$hGrid[$x],$vGrid[$y]);
            $key = array_rand($options);
            if(!isset($options[$key])) {
                return generate();
            }
            $val = $options[$key];
            $hGrid[$x][$y] = $vGrid[$y][$x] = $val;
        }
    }
    return $hGrid;
} 
```

?>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:44:53.253

你的数组`$table`实际上并没有在循环内改变，这就是问题所在。您需要`shuffle($table)`在第一个循环 ( `for($i=0; $i<9; $i++)`) 中运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T15:44:16.393

`shuffle`在第一个`for`循环内调用。你只是洗牌一次，所以你只是一遍又一遍地重复同一行：

```
 <?php

    $table = range(1, 9);

    for($i=0; $i<9; $i++){
        shuffle($table);
        echo '<tr id="r'.$i.'">';

        for ($j=0; $j<9 ; $j++) { 
            echo '  <td id="r'.$i.'d'.$j.'">'.$table[$j].'</td>';
        }

        echo '</tr>';
    }

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T15:51:26.583

我不知道这是否是你需要的

看看这段代码..

```
 <table border="1" style="text-align:center;" width="400px;" height="400px;">

 <?php

    $table = range(1, 9);
    shuffle($table);

    for($i=0; $i<9; $i++){

        echo '<tr id="r'.$i.'">';
         shuffle($table);

        for ($j=0; $j<9 ; $j++) { 
            echo '  <td id="r'.$i.'d'.$j.'">'.$table[$j].'</td>';
        }

        echo '</tr>';
    }

?>

</table> 
```

# css - 带有左浮动附加 div 的响应式布局

> ID：14857226
> 
> 赞同：0
> 
> 时间：2013-02-13T15:41:03.290
> 
> 标签：css, css-float, responsive-design, centering

我必须使用以下简单标记构建响应式布局：

```
<div class="wrapper">
  <div class="div1"></div>
  <div class="div2"></div>
  <div class="div3"></div>
</div> 
```

div2 和 div3 应该居中， div1 应该是一个左浮动的附加 div（用于传记数据或其他东西）。

预期：

```
 ______  __________
    |      ||          |
    | div1 ||   div2   |
    |______||          |
            |__________|
            |          |
centered->  |   div3   |  <-centered
            |          |
            |__________| 
```

我的假浮动状态：

```
 ______      __________
|      |    |          |
| div1 |    |   div2   |
|______|    |          |
            |__________|
            |          |
centered->  |   div3   |  <-centered
            |          |
            |__________| 
```

这是我的问题： http: [//jsfiddle.net/5fQFE/2/](http://jsfiddle.net/5fQFE/2/) 有没有 CSS 唯一的解决方案？

**编辑：这应该可以多次：**

```
 ______  __________
    |      ||          |
    | div1 ||   div2   |
    |______||          |
            |__________|
            |          |
            |   div3   |
            |          |
     ______ |__________|
    |      ||          |
    | div4 ||   div5   |
    |______||          |
            |__________|
            |          |
            |   div6   |
            |          |
            |__________| 
```

但使用以下简单标记：

```
<div class="wrapper">
  <div class="div1">more markup here!?</div>
  <div class="div2"></div>
  <div class="div3"></div>
  <div class="div4">more markup here!?</div>
  <div class="div5"></div>
  <div class="div6"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:47:52.010

这是一个带有纯 CSS 解决方案的 jsFiddle：http: [//jsfiddle.net/persianturtle/5fQFE/3/](http://jsfiddle.net/persianturtle/5fQFE/3/)

您所要做的就是为包装器添加一个宽度并将其居中放置在页面上：

```
.wrapper {
    padding: 20px;
    width:550px;
    margin:0 auto;
} 
```

div1 和其他两个 div 之间的宽度由包装器的宽度控制。Div1 浮动到包装器的左侧。由于 div1 是浮动的，它不会影响 div 2 和 3 的居中。如果为布局增加 div 的宽度，请务必同时增加 wrapper 的宽度。

更新：

由于您想要更多内容和侧边栏，因此添加更多 div，但给它们相同的类。看看这个 jsFiddle：

[http://jsfiddle.net/persianturtle/5fQFE/6/](http://jsfiddle.net/persianturtle/5fQFE/6/)

```
.div1, .div4 {
    background: #ddd;
    float: left;
    width: 100px;
}

.div2, .div5 {
    background: #ccc;
}

.div3, .div6 {
    background: #bbb;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:46:19.653

jsfiddle：http: [//jsfiddle.net/5fQFE/4/](http://jsfiddle.net/5fQFE/4/)

**CSS**

```
#wrapper {
    position: relative;
}

#div1 {
   position: absolute;
   top: 0;
   left: -210px;
   width: 200px;
} 
```

# hibernate - OneToMany 单向与多端复合 pk

> ID：14857234
> 
> 赞同：1
> 
> 时间：2013-02-13T15:41:13.477
> 
> 标签：hibernate, jpa-2.0, hibernate-mapping

我有以下简单的例子：

```
@Entity
public class Profile {
 @Id
 private long id;

 @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY) 
 @JoinColumn(name="profileId", nullable = false)
 private List<Preference> preferences;
}

@Entity
@IdClass(PreferenceId.class)
public class Preference1 {
  @Id
  private long id;
  @Id
  @Column(insertable = false, updatable = false, nullable = false)
  private long profileId;   
} 
```

每当我尝试持久化配置文件时，都会有两个插入语句：

> 插入配置文件（id）值（？）——完美
> 
> 插入 Preference(profileId, id) 值 (?, ?) -- 也很完美

接着

```
16:21:12,257 TRACE BasicBinder:83 - binding parameter [1] as [BIGINT] - 1
16:21:12,257 TRACE BasicBinder:83 - binding parameter [2] as [BIGINT] - 10
16:21:12,257 TRACE BasicBinder:83 - binding parameter [3] as [BIGINT] - 0
16:21:12,257 ERROR SqlExceptionHelper:144 - Invalid column index 
```

为什么有三个参数而不是两个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T11:46:07.090

```
public class PreferenceId implements Serializable {
    private long id;
    private long profileId;
    public PreferenceId(){}

    public long getId(){return id;}
    public void setId(long id){this.id = id;}
    public long getProfileId() {return profileId;}
    public void setProfileId(long profileId) {this.profileId = profileId;}
    //hashCode, equals
} 
```

# c# - 将一些信息保存到应用程序资源中并从任何地方读取

> ID：14857235
> 
> 赞同：1
> 
> 时间：2013-02-13T15:41:17.467
> 
> 标签：c#, resources

我想知道，是否可以在输出（exe）应用程序文件的字段中保存某些内容？例如，如果我想保存应用程序首次启动的日期（但不在数据库中），然后在几天后检查首次启动的值？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:43:26.953

有很多选项，但请查看[Using Settings in C#](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)（这里还有一[组较新的文章。](http://msdn.microsoft.com/en-us/library/bb397750%28v=vs.100%29.aspx)）

这是一种保存简单数据的好方法，例如您的第一个应用程序开始日期/时间的示例，不需要数据库或其他一些“更重”的持久性方案。

从链接的文章：

> .NET Framework ... 允许您创建和访问在应用程序执行会话之间持久存在的值。这些值称为设置。设置可以代表用户偏好或应用程序需要使用的有价值的信息。例如，您可以创建一系列设置来存储用户对应用程序配色方案的偏好。或者，您可以存储指定应用程序使用的数据库的连接字符串。设置允许您在代码之外保留对应用程序至关重要的信息，并创建存储个人用户偏好的配置文件。

# ibm-mobilefirst - 应用程序中心在 iPhone 4S iOS 6.1 上以纯灰色屏幕启动

> ID：14857239
> 
> 赞同：0
> 
> 时间：2013-02-13T15:41:29.527
> 
> 标签：ibm-mobilefirst

<---- 剪断 ----->

我似乎在 iOS 6.x 上遇到了 Application Center 客户端的问题。

这很奇怪，因为我能够将 Application Center 下载连接到设备，但是当我启动它时，我得到一个纯灰色屏幕。

我看到以下内容：

```
2013-02-06 08:42:56.445 IBMAppCenter241:3d0b Web resources integrity test is disabled.
2013-02-06 08:42:56.474 IBMAppCenter241:907 Multi-tasking -> Device: YES, App: YES
2013-02-06 08:42:57.931 IBMAppCenter241:907 LOG ondeviceready event dispatched
2013-02-06 08:42:57.934 IBMAppCenter241:907 {
                                                appVersionPref = "1.0";
                                                freeSpace = 6947221504;
                                                wlSkinLoaderChecksum = "(null)";
                                                wlSkinName = default;
                                            }
2013-02-06 08:42:57.953 IBMAppCenter241:907 LOG Application did not define an i18n messages object, skipping translation.
2013-02-06 08:42:57.954 IBMAppCenter241:907 LOG wlclient init started
2013-02-06 08:42:57.956 IBMAppCenter241:907 LOG Read cookies: null
2013-02-06 08:42:57.957 IBMAppCenter241:907 LOG CookieMgr read cookies: {}
2013-02-06 08:42:58.223 IBMAppCenter241:907 LOG before: app init onSuccess
2013-02-06 08:42:58.225 IBMAppCenter241:907 LOG after: app init onSuccess
2013-02-06 08:42:58.226 IBMAppCenter241:907 LOG wlclient init success 
```

只是想知道是否有人对这个问题有任何想法。

工作灯 5.0.5

<---- 快照 ----->

请注意：此问题已发布在[IBM developerworks 论坛](https://www.ibm.com/developerworks/forums/thread.jspa?messageID=14938616&#14938616)中，但仍未得到答复。我遇到了同样的问题。

Thx4帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:54:58.257

您的手机语言是否设置为英语？如果没有，那么尝试这样做。如果移动客户端正常工作，则意味着您面临我们在 5.0.5.1 中修复的已知问题（请参阅[IBM Worklight V5.0.5.1 和 IBM Mobile Foundation V5.0.5.1](http://www-01.ibm.com/support/docview.wss?uid=swg24034221)）。

希望这可以帮助。

# c# - 使用 Expression.Block 编译的委托不断抛出 NullReferenceException

> ID：14857241
> 
> 赞同：0
> 
> 时间：2013-02-13T15:41:44.303
> 
> 标签：c#, .net, .net-4.0, lambda, expression

我正在尝试构建一个将多个属性分配给给定对象的表达式，但是在调用编译的委托之后，它不断`NullReferenceException`从 lambda 的主体中抛出一个：

```
var a = Expression.Parameter(typeof(A), "a");
var b = Expression.Parameter(typeof(B), "b");
var c = Expression.Parameter(typeof(C), "c");

LabelTarget returnTarget = Expression.Label(typeof(A));
GotoExpression returnExpression =
    Expression.Return(returnTarget, a, typeof(A));
LabelExpression returnLabel = Expression.Label(
    returnTarget, Expression.Constant(null, typeof(A)));

var expression = Expression.Lambda<Func<A, B, C, A>>(
    Expression.Block(
        typeof(A),
        new[] { a, b, c },
        Expression.Assign(
            Expression.Property(a, typeof(A).GetProperty("B")),
            b),
        Expression.Assign(
            Expression.Property(a, typeof(A).GetProperty("C")),
            c),
        returnExpression,
        returnLabel
    ), 
    a, b, c);

Func<A, B, C, A> func = expression.Compile();

// Calling func throws a NullReferenceException
A result = func(new A(), new B(), new C()); 
```

我假设我`Expression.Block`写错了，但我到底在做什么错呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T17:13:52.130

你应该换行

```
new[] { a, b, c }, 
```

和

```
new ParameterExpression[] {}, 
```

的第二个参数`Expression.Block`应该定义块范围的变量 - 但您已经在`Expression.Lambda`.

# android - 用 canvas.draw() 绘制一个自定义类

> ID：14857242
> 
> 赞同：0
> 
> 时间：2013-02-13T15:41:48.063
> 
> 标签：android, class, canvas, ondraw

我使用 Canvas 在我的应用程序中绘制我所谓的“标签”。这个“标签”有一个圆形、一个图标和文本。我目前正在调用方法 canvas.draw() ，我只是将参数用于绘制它。由于我的应用程序需要处理很多这样的标签，我需要创建一个类来处理标签的图标和文本，而不是调用方法 canvas.draw(Text, Bitmap, paint...)。有没有办法我可以做到这一点？我将发布一些代码：

```
public void onDraw(Canvas canvas){
canvas.draw(Bitmap myBitmap);
canvas.draw(String myText); 
```

等等。我需要做的是使用一个类作为参数来用画布绘制。

```
canvas.draw(MyCustomClass labelBathroom); 
```

假设 MyCustomClass 具有所需的所有属性和方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:45:03.490

您可以将其包装在 a`View`或 a`Drawable`中。

# c++ - 在范围内创建指针时，当指针超出范围时，指向的变量会发生什么？

> ID：14857246
> 
> 赞同：7
> 
> 时间：2013-02-13T15:41:56.897
> 
> 标签：c++, pointers, memory, scope

标题说明了一切。

[我发现了一个基本相同的老问题](https://stackoverflow.com/questions/4570210/c-pointer-scope)，但我需要进一步澄清。

在这个问题中，接受的答案说：

> ```
> char* text = "Hello, world"; 
> ```
> 
> 这里在堆栈上创建了一个自动变量（指针）并设置为指向常量内存中的一个值，这意味着：
> 
> *   "" 中的字符串文字存在于整个程序执行过程中。
> *   您不负责“分配”或“释放”它
> *   你可能不会改变它。如果要更改它，则必须分配一些“非常量内存”并将其复制到那里。

这是说指针被删除，而不是指针指向的数据吗？如果我要在函数中创建 1,000,000 个指向字符的指针，当它们超出范围时，我的所有内存都会被释放吗？或者只是制作指针所需的内存，而将实际字符本身留在后面来占用我所有的内存？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T15:49:29.113

字符数组将在程序的整个执行过程中一直存在，因为它们具有静态存储持续时间。这并不意味着您需要删除它们——它们*应该*在您的整个程序期间都存在。事实上，调用`delete`它会给你未定义的行为。您只能`delete`分配与`new`.

指针本身具有自动存储持续时间，并在超出范围时被销毁。值得注意的是，指针必须是 a`const char*`因为字符串文字为您提供了一个`const char`. 考虑：

```
void func()
{
  const char* str = "Hello";
} 
```

包含的字符数组在`Hello\0`您的程序期间存在。指针`str`仅在该函数的持续时间内存在。什么都不需要在`deleted`这里。

如果你仔细想想，这很有意义。您在源代码中编写的所有这些字符串都必须存在于您的可执行文件中的某个位置。编译器通常将这些字符串写入可执行文件的*数据段*。当你运行你的程序时，可执行文件和包含你的字符串的数据段一起被加载到内存中。

如果您的程序中有两个字符串文字具有相同或重叠的文本，则编译器没有理由不能将其优化为仅存储其中一个。考虑：

```
void func()
{
  const char* str1 = "Hello";
  const char* str2 = "Hello";
  const char* str3 = "lo";
} 
```

编译器只需`Hello\0`在此处将字符写入可执行文件一次。前两个指针将指向 the `H`，第三个将指向第二个`l`。您的编译器可以进行这样的优化。当然，在这个例子中，编译器可以通过将字符串全部去掉来进行更进一步的优化——它们不会以任何有助于程序可观察行为的方式使用。

所以是的，如果你有一百万个不同的字符串文字在某种程度上有助于程序的可观察行为，那么它们当然必须作为可执行文件的一部分存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T15:43:21.737

我会说“没什么”（回答标题），如果它足以让 SO 认为它是一个答案。

至于你的百万个字符指针，而指针会被弹出（尽管你必须有相当多的堆栈来保存百万个指针）它们指向的数据会困扰你的记忆。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T16:26:26.237

不幸的是，您的示例不足以解决全貌。

首先，一些简单的即席词汇和解释：*内存单元*是（用 C++ 输入的）具有给定大小的内存区域，它包含一个*值*。几个内存单元可能包含相同的值，没关系。

您应该考虑3 种类型的*内存单元：*

*   `"Hello, World!"`：这个内存单元具有静态存储持续时间，它存在于整个程序的持续时间
*   `void foo(int a);`和`void foo() { int a = 5; }`：记忆单元`a`，在这两种情况下，都有自动存储时间，一旦功能返回，它会自动*消失*`foo`
*   `void foo() { int* a = new 5; }`：在“某处”创建一个匿名存储单元来存储值`5`，并`a`创建一个具有自动存储持续时间的存储单元来存储匿名的地址

* * *

> 那么，当*指针*超出范围（*消失*）时会发生什么？

嗯，就是这样。指针消失。最具体地说，它指向的*存储单元没有发生任何特殊情况。*

```
void foo(int a) {
    int* pointer = &a;
} // pointer disappears, `a` still exists briefly

void foo() {
    int* pointer = 0;
    {
        int a;
        pointer = &a;
    } // a disappears, pointer's value does not change...
} // pointer disappears 
```

事实上，在 C 和 C++ 中：

*   您可以保留不再存在的对象的地址 =>*悬空引用*
*   您可能会丢失现有对象的所有地址=>*内存泄漏*

* * *

> 那么当`text`in`char const* text = "Hello, world";`超出范围时会发生什么？

没有什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T15:52:44.723

指针本身占用“自动存储”（通常是堆栈）上的空间。一旦函数返回[或范围完成，但从技术上讲，几乎所有编译器都会“等待”直到函数返回，然后释放空间]。

如果你在循环中调用同一个函数 100 万次，那么在任何给定时间都只会有一个指针。如果您有 100 万个函数 [和大量内存]，那么当前调用的每个函数都会有一个指针。例如

```
char *foo()
{
    char *text1 = "Hello";
    return text1;
}

void bar()
{
    char *text2 = "World!";
    printf("%s %s!\n", foo(), text2);
}

void baz()
{
    char *text3 = "Meh";
    bar();
}

int main()
{
    char *text4 = "Main";

    baz();
} 
```

当我们进入 main 时，`text4`它会在堆栈上创建 - 它被初始化为字符串“Main”，该字符串保存在其他一些内存位中。然后当我们调用时`baz()`，`text3`被创建并初始化为“Meh”，它调用`bar()`创建`text2`并指向文本“World”，调用`foo`创建并初始化`text1`为`Hello`。作为`foo`返回，内部的地址`text1`作为返回值给出，指针本身消失。当`printf()`完成时，`bar`返回，指针消失。

只要程序正在运行，字符串 "Main"、"Meh"、"Hello" 和 "World" 仍然保持不变。

# iphone - 更新应用程序时，identifierForVendor 可以更改吗？

> ID：14857247
> 
> 赞同：19
> 
> 时间：2013-02-13T15:41:58.577
> 
> 标签：iphone, ios6

除非供应商的所有应用程序都从设备中删除，否则 identifierForVendor 不应更改。如果我有一个更新的应用程序会发生什么。identifierForVendor 可以改变吗？提出这个问题的另一种方式是：应用程序升级是否与卸载和安装相同（至少在某种意义上）？

我问的原因是，如果我从 App Store 安装应用程序的当前版本，然后通过 XCode“存档”一个新版本并通过 iTunes 安装它，identifierForVendor 会发生变化。我不知道这是否是一种特殊情况，或者这是否也是“正常”应用程序更新/升级的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-26T10:51:40.297

简短回答 - 在所描述的情况下，identifierForVendor 会有所不同。

但是对于从 AppStore 下载的用户来说，也是一样的。如果版本是 6.1 及更高版本。6.0.x 存在已知问题。

我已经通过 Apple 支持验证了这一点，并向 AppStore 提交了我自己的应用程序更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-14T15:58:48.580

如文档中所述，从应用商店更新应用时不应更改。

如果您要更新安装了 iTunes 的应用程序，然后使用 Xcode 或基于临时配置或任何配置的 ipa 更新它，您将获得不同的值。您需要使其保持一致，即 Adhoc 到 adhoc，开发到开发，应用商店到应用商店。

再次从应用商店更新不应该改变。然而。请注意这一点。在 2015 年 5 月至 7 月之间发生了一个**影响 identifierForVendor 计算的错误**。如果您在任何加密方案中都依赖此值，则您可能无法解密它。苹果声称已经纠正了这个问题，现在推出另一个更新应该会恢复到关键时期之前的原始值。

在任何情况下，当 identifierForValue 在更新期间发生变化时，您都应该优雅地处理。

# linear-programming - 将 lingo 模型转换为 lp 格式

> ID：14857250
> 
> 赞同：1
> 
> 时间：2013-02-13T15:42:08.467
> 
> 标签：linear-programming, lpsolve

我使用 LINGO 编写了一个程序，但试用版有 30 个非线性变量和 30 个整数变量的限制，超出了我的限制。在我决定购买下一个版本之前，我想我会看看我的程序在自由软件上的表现如何。我下载了 LPSolve IDE 5.5 并尝试手动转换它，但我遇到了诸如无法使用括号影响操作顺序以及无法划分等问题。有没有更简单的方法来转换语言程序？我尝试将其导出到 MPS 文件，但这给了我错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T19:36:34.693

这可能不是您想听到的，但通常您最好尝试从头开始以 MPS 格式创建整个 LP/IP。实际上，您最终可能会节省从 Lingo 转换的时间。

如果你确实想转换，我建议你先将一个小得多的问题加载到 LINGO 上，看看你是否能够先转换它。然后逐渐增加你的 LP 的大小，看看你在哪里得到错误。本文档包含[将现有问题转换为 MPS 格式的说明](http://docs.exdat.com/docs/index-44224.html?page=9#2014902)。

除了 LPSolve，您可能还想尝试其他开源/免费求解器。一些常见的包括[GLPK](http://www.gnu.org/software/glpk/)、[SCIP](http://scip.zib.de/scip.shtml)、[Google-OR Tools](http://code.google.com/p/or-tools/)。如果您知道 R，那么`optim`还有[其他几个选项](http://cran.r-project.org/web/views/Optimization.html)可用。最后，我发现 Excel 的 Solver 也相当不错。

希望这可以帮助您继续前进。

# c# - 重建 WPF 项目时出现未知错误

> ID：14857251
> 
> 赞同：1
> 
> 时间：2013-02-13T15:42:15.210
> 
> 标签：c#, wpf, visual-studio-2010

我通过在新解决方案中创建具有相同名称的项目、将该项目文件复制到损坏的项目文件并在解决方案中重新包含项目文件来重建项目文件。

我现在收到错误错误

> 6 以下方法或属性之间的调用不明确：'UserConsole.MainWindowView.InitializeComponent()' 和 'UserConsole.MainWindowView.InitializeComponent()' C:\Code\PollPublicDataStock\PollPublicDataStock\UserConsole\MainWindowView.xaml.cs 29 13

呃，这些是相同的方法......歧义在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T19:09:50.407

我不小心在项目中包含了自动生成的代码和 obj 文件夹。

# apache-flex - 如何使用 maven 和 jboss 部署项目？

> ID：14857253
> 
> 赞同：0
> 
> 时间：2013-02-13T15:42:18.997
> 
> 标签：apache-flex, maven, jboss

我是 maven 和 Jboss 的新手（实际上，也从未使用过其他服务器）

我有一个带有 maven 和 jboss 服务器的 flex/blazDS/Java 项目。我该如何部署它？

PS：当我进行开发时，我使用 maven 来构建项目（使用 mvn clean install package ...）。

然后，转到我的 Eclipse，右键单击主应用程序，让它在我的服务器上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-07T05:04:56.227

该命令不是上面评论中给出的 jboss 硬部署。在 jboss 中使用 maven 部署的正确命令是 **jboss:hard-deploy**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:08:14.063

您可以使用[Maven JBoss Plugin](http://mojo.codehaus.org/jboss-maven-plugin/)。正确配置后，您可以使用它来启动和停止服务器以及通过 JMX（对于远程实例）和硬拷贝（对于本地实例）进行部署。正如指南所述，首先您将插件添加到您的 pom 中：

```
 <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>jboss-maven-plugin</artifactId>
        <version>1.5.0</version>
        <configuration>
          <jbossHome>/usr/jboss-4.2.3.GA</jbossHome>
          <serverName>all</serverName>
          <fileName>target/my-project.war</fileName>
        </configuration>
      </plugin> 
```

确保适当地自定义配置部分中的字段。然后您可以使用（远程）部署到您的 JBoss 服务器

```
mvn jboss deploy 
```

或（本地）

```
mvn jboss hard-deploy 
```

# javascript - 在 jQuery ("aaSorting": []) 中为特定 ID 或整个项目设置 NO DEFAULT SORTING

> ID：14857260
> 
> 赞同：1
> 
> 时间：2013-02-13T15:42:36.877
> 
> 标签：javascript, jquery, sorting, jquery-datatables, default

我在将 table 的默认排序设置为 NONE 时遇到问题`ID="activity"`。

```
<table class="table table-striped table-condensed bootstrap-datatable datatable"
       id="activity">...
</table> 
```

我把这个脚本放在页面底部，它什么也没做......

```
<script>
  $(document).ready( function() {
        $('#activity').dataTable( {
            "bRetrieve": true,
            "aaSorting": [],
            "bDestroy": true
        } );
  } );
</script> 
```

如何解决这个问题呢？我根本不想要默认排序，但我想保留手动排序功能。可以为整个项目禁用它，而不仅仅是我的`activity`表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-16T09:21:28.563

对于 DataTables > 1.9，使用以下[`order`](https://datatables.net/reference/option/order)设置：

```
$('#activity').dataTable({
  "order": []
}); 
```

```
$('#activity').dataTable({
  "order": []
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//cdn.datatables.net/1.10.6/js/jquery.dataTables.min.js"></script>
<link href="//cdn.datatables.net/1.10.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<table id="activity" class="display" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th>Name</th>
      <th>Position</th>
      <th>Office</th>
      <th>Age</th>
      <th>Start date</th>
      <th>Salary</th>
    </tr>
  </thead>

  <tfoot>
    <tr>
      <th>Name</th>
      <th>Position</th>
      <th>Office</th>
      <th>Age</th>
      <th>Start date</th>
      <th>Salary</th>
    </tr>
  </tfoot>

  <tbody>
    <tr>
      <td>Zenaida Frank</td>
      <td>Software Engineer</td>
      <td>New York</td>
      <td>63</td>
      <td>2010/01/04</td>
      <td>$125,250</td>
    </tr>
    <tr>
      <td>Zorita Serrano</td>
      <td>Software Engineer</td>
      <td>San Francisco</td>
      <td>56</td>
      <td>2012/06/01</td>
      <td>$115,000</td>
    </tr>
    <tr>
      <td>Jennifer Acosta</td>
      <td>Junior Javascript Developer</td>
      <td>Edinburgh</td>
      <td>43</td>
      <td>2013/02/01</td>
      <td>$75,650</td>
    </tr>
    <tr>
      <td>Cara Stevens</td>
      <td>Sales Assistant</td>
      <td>New York</td>
      <td>46</td>
      <td>2011/12/06</td>
      <td>$145,600</td>
    </tr>
    <tr>
      <td>Hermione Butler</td>
      <td>Regional Director</td>
      <td>London</td>
      <td>47</td>
      <td>2011/03/21</td>
      <td>$356,250</td>
    </tr>
    <tr>
      <td>Lael Greer</td>
      <td>Systems Administrator</td>
      <td>London</td>
      <td>21</td>
      <td>2009/02/27</td>
      <td>$103,500</td>
    </tr>
    <tr>
      <td>Jonas Alexander</td>
      <td>Developer</td>
      <td>San Francisco</td>
      <td>30</td>
      <td>2010/07/14</td>
      <td>$86,500</td>
    </tr>
    <tr>
      <td>Shad Decker</td>
      <td>Regional Director</td>
      <td>Edinburgh</td>
      <td>51</td>
      <td>2008/11/13</td>
      <td>$183,000</td>
    </tr>
    <tr>
      <td>Michael Bruce</td>
      <td>Javascript Developer</td>
      <td>Singapore</td>
      <td>29</td>
      <td>2011/06/27</td>
      <td>$183,000</td>
    </tr>
    <tr>
      <td>Donna Snider</td>
      <td>Customer Support</td>
      <td>New York</td>
      <td>27</td>
      <td>2011/01/25</td>
      <td>$112,000</td>
    </tr>
  </tbody>
</table>
```

# python - 使用 Python，有没有办法自动检测图像中的像素框？

> ID：14857262
> 
> 赞同：4
> 
> 时间：2013-02-13T15:42:41.360
> 
> 标签：python, image, python-imaging-library, detection

我目前无法在我正在处理的盒子上访问 openCV - 这可以让我在公园里散步，让我免于拉扯我的头发 - 但下面是我拥有的图像，我已经达到了阈值以及我的目标想要做的是找到一种方法来获取围绕像素分组的框的 4 列表元组。

原始阈值图像![原始阈值图像](../Images/333b6a676d03904cb4de6e160d740dd3.png)

目前我使用这个代码：

```
box = image.getbbox()
draw = ImageDraw.Draw(area) # Create a draw object
draw.rectangle(area.getbbox(), outline="red") 
```

结果图像![结果图像](../Images/10f661627f9d03f2af6e4a464e193d5f.png)

但我真正想做的是在顶部白色区域或中心灰色区域周围画一个框。我想避免裁剪，因为我想把它写成一个自动化函数，而且我永远不知道阈值在哪里。这是我想在烟花中实现的示例情况图像：

新的梦想结果![新的梦想结果](../Images/4dc2739960afeafca3db58b32201cd82.png) 希望这很清楚！这两天没睡！任何指示或指导都非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T18:58:46.507

任务所需的基本工具/价值是：

*   一种连通分量标注方法；
*   确定是否丢弃或保留连接组件的阈值；
*   用于计算连接组件之间距离的度量标准和用于确定是否加入它们的阈值（仅当您确实想要这样做时才需要这样做，目前还不清楚）。

第一个在 上不可用`PIL`，但`scipy`提供。如果您也不想使用，请考虑[https://stackoverflow.com/a/14350691/1832154](https://stackoverflow.com/a/14350691/1832154)`scipy`上的答案。我在那个答案中使用了代码，将其调整为使用图像而不是普通列表，并假设那里存在的函数放置在一个名为. 第三步，我以一种时尚的方式使用了简单的棋盘距离。`PIL``wu_ccl``O(n^2)`

然后，丢弃小于 200 像素的组件，考虑到小于 100 像素的组件应该在同一个边界框中，并将边界框填充 10 像素，这就是我们得到的：

![在此处输入图像描述](../Images/e79eddd652f5e774c58c6b246059814f.png)

您可以简单地将组件阈值更改为更高的值，以便仅保留最大的值。此外，您可以按相反的顺序执行此图像之前提到的两个步骤：首先加入关闭组件，然后丢弃（但这在下面的代码中没有完成）。

虽然这些是相对简单的任务，但代码并不是那么短，因为我们不依赖任何库来完成这些任务。下面是一个实现上图的示例代码，连接组件的合并特别大，我估计匆忙写出来的代码比需要的要大得多。

```
import sys
from collections import defaultdict
from PIL import Image, ImageDraw

from wu_ccl import scan, flatten_label

def borders(img):
    result = img.copy()
    res = result.load()
    im = img.load()
    width, height = img.size

    for x in xrange(1, width - 1):
        for y in xrange(1, height - 1):
            if not im[x, y]: continue
            if im[x, y-1] and im[x, y+1] and im[x-1, y] and im[x+1, y]:
                res[x, y] = 0
    return result

def do_wu_ccl(img):
    label, p = scan(img)
    ncc = flatten_label(p)
    # Relabel.
    l = label.load()
    for x in xrange(width):
        for y in xrange(height):
            if l[x, y]:
                l[x, y] = p[l[x, y]]
    return label, ncc

def calc_dist(a, b):
    dist = float('inf')
    for p1 in a:
        for p2 in b:
            p1p2_chessboard = max(abs(p1[0] - p2[0]), abs(p1[1] - p2[1]))
            if p1p2_chessboard < dist:
                dist = p1p2_chessboard
    return dist

img = Image.open(sys.argv[1]).convert('RGB')
width, height = img.size
# Pad image.
img_padded = Image.new('L', (width + 2, height + 2), 0)
width, height = img_padded.size
# "discard" jpeg artifacts.
img_padded.paste(img.convert('L').point(lambda x: 255 if x > 30 else 0), (1, 1))

# Label the connected components.
label, ncc = do_wu_ccl(img_padded)

# Count number of pixels in each component and discard those too small.
minsize = 200
cc_size = defaultdict(int)
l = label.load()
for x in xrange(width):
    for y in xrange(height):
        cc_size[l[x, y]] += 1
cc_filtered = dict((k, v) for k, v in cc_size.items() if k > 0 and v > minsize)

# Consider only the borders of the remaining components.
result = Image.new('L', img.size)
res = result.load()
im = img_padded.load()
l = label.load()
for x in xrange(1, width - 1):
    for y in xrange(1, height - 1):
        if im[x, y] and l[x, y] in cc_filtered:
            res[x-1, y-1] = l[x, y]
result = borders(result)
width, height = result.size
result.save(sys.argv[2])
# Collect the border points for each of the remainig components.
res = result.load()
cc_points = defaultdict(list)
for x in xrange(width):
    for y in xrange(height):
        if res[x, y]:
            cc_points[res[x, y]].append((x, y))
cc_points_l = list(cc_points.items())

# Perform a dummy O(n^2) method to determine whether two components are close.
grouped_cc = defaultdict(set)
dist_threshold = 100 # pixels
for i in xrange(len(cc_points_l)):
    ki = cc_points_l[i][0]
    grouped_cc[ki].add(ki)
    for j in xrange(i + 1, len(cc_points_l)):
        vi = cc_points_l[i][1]
        vj = cc_points_l[j][1]
        kj = cc_points_l[j][0]
        dist = calc_dist(vi, vj)
        if dist < dist_threshold:
            grouped_cc[ki].add(kj)
            grouped_cc[kj].add(ki)
# Flatten groups.
flat_groups = defaultdict(set)
used = set()
for group, v in grouped_cc.items():
    work = set(v)
    if group in used:
        continue
    while work:
        gi = work.pop()
        if gi in flat_groups[group] or gi in used:
            continue
        used.add(gi)
        flat_groups[group].add(gi)
        new = grouped_cc[gi]
        if not flat_groups[group].issuperset(new):
            work.update(new)

# Draw a bounding box around each group.
draw = ImageDraw.Draw(img)
bpad = 10
for cc in flat_groups.values():
    data = []
    for vi in cc:
        data.extend(cc_points[vi])
    xsort = sorted(data)
    ysort = sorted(data, key=lambda x: x[1])
    # Padded bounding box.
    bbox = (xsort[0][0] - bpad, ysort[0][1] - bpad,
            xsort[-1][0] + bpad, ysort[-1][1] + bpad)
    draw.rectangle(bbox, outline=(0, 255, 0))
img.save(sys.argv[2]) 
```

同样，`wu_ccl.scan`需要调整函数（取自上述答案），为此考虑创建一个带有模式的图像，`'I'`而不是使用嵌套的 Python 列表。我还做了一些细微的更改，`flatten_label`因此它返回了连接组件的数量（但它实际上并未在呈现的最终代码中使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T02:53:53.533

如果它仍然有一些帮助，有`scipy.ndimage.measurements.label`，它可以在图像中查找 blob，并且可以用来查找边界框。

# regex - VS 正则表达式搜索：查找 Try..Finally 没有 Catch

> ID：14857267
> 
> 赞同：1
> 
> 时间：2013-02-13T15:42:47.577
> 
> 标签：regex, vb.net, visual-studio

我想在 Visual Studio 中使用正则表达式搜索来查找没有 Catch 的 Try/Finally 块的所有实例。

阅读[帮助文件](http://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.80%29.aspx)后，我开始使用它返回匹配的**Try**而不匹配**End Try**。

```
~(End )Try\n 
```

然后，我想在有 finally 的地方进行 **匹配**：

```
~(End )Try\n*Finally\n 
```

这实际上是行不通的。

我认为完整的工作正则表达式看起来像这样：

```
~(End )(Sub|Function)*~(End )Try\n*~(Catch*\n)*Finally\n*End (Sub|Function) 
```

这是试图说，在 Sub Or Function 中，返回具有**Try/Finally**但没有**Catch**的匹配项。

我是否在完成这项搜索？

# objective-c - 从块访问时实例变量为零

> ID：14857275
> 
> 赞同：1
> 
> 时间：2013-02-13T15:43:02.453
> 
> 标签：objective-c, cocoa-touch, objective-c-blocks, null, eventkit

我正在使用 EventKit API 来获取用户的提醒。fetch API 是异步完成的，当 fetch 完成时，您可以使用一个完成块。但是，在我获取用户的提醒后，我将它分配给 self.eventKitReminderEvents 实例变量（我已经调试并看到它不是零）。然后在我调用一个块之后，但从这个块内部 self.eventKitReminderEvents 是**nil**。我真的不明白为什么会这样。也许有人可以看看我的代码并给我一个线索。

我正在使用这样的 API：

```
- (void)futureReminders {

    dispatch_semaphore_t sema = dispatch_semaphore_create(0);

    [self fetchReminderEventsInBackgroundFromDate:[NSDate date] withCompletionBlock:^{

        // When I enter here self.eventKitReminderEvents is nil
        // Which is weird because it should be set already if you look in
        // fetchReminderEventsInBackgroundFromDate below...

        [self processEventKitRemindersWithCompletion:^(NSArray *reminderEvents) {

            // Save a copy in memory
            self.futureReminderEvents = reminderEvents;

            // Send a signal that indicates that this asynchronous task is completed ...
            dispatch_semaphore_signal(sema);
         }];
    }];

    // Wait for dispatch signal
    dispatch_semaphore_wait(sema, DISPATCH_TIME_FOREVER);

}

- (void)fetchReminderEventsInBackgroundFromDate:(NSDate *)startDate withCompletionBlock:(void(^)(void))block {

    DLogName()

    //NSDate *startDate = [NSDate date];
    NSDate *endDate = [NSDate distantFuture]; // This will get me events 4 years from now

    // Create the predicate
    NSPredicate *predicate = [self.eventStore predicateForIncompleteRemindersWithDueDateStarting:startDate ending:endDate calendars:nil];

    [self.eventStore fetchRemindersMatchingPredicate:predicate completion:^(NSArray *reminders) {

        self.eventKitReminderEvents = reminders;
        block();
    }];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:50:39.647

您需要创建一个 selfInBlock 母猪以确保您不会像这样在块内丢失对 self 的引用

```
__block YourSelfClassName *selfInBlock = self; 
```

并在块内使用 selfInBlock 而不是 self 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T11:51:47.023

感谢我收到的所有答案/评论。我只是注意到我实际上是在设置另一个具有相似名称的实例变量，所以这就是为什么它是 nil。

自我注意：复制和粘贴代码时要非常小心:)

# powershell - Powershell 远程身份验证和应用程序安装

> ID：14857277
> 
> 赞同：0
> 
> 时间：2013-02-13T15:43:04.033
> 
> 标签：powershell, powershell-2.0, powershell-remoting

我想在多台远程机器上安装应用程序。

`invoke-command -computer 10.13.14.10 -scriptblock {\\publicshare\software.msi /quiet}`

我正在以我的用户权限登录的本地计算机上运行此命令，似乎我必须以更高权限的用户（域管理员）身份执行此命令。我怎么做？

错误 -`[10.13.14.10] Connecting to remote server failed with the following error message : The WinRM client cannot process the request. Default authentication may be used with an IP address under the following conditions: the transport is HTTPS or the destination is in the TrustedHosts list, and explicit creden tials are provided. Use winrm.cmd to configure TrustedHosts. Note that computers in the TrustedHosts list might not be authenticated. For more informatio n on how to set TrustedHosts run the following command: winrm help config. For more information, see the about_Remote_Troubleshooting Help topic. + CategoryInfo : OpenError: (:) [], PSRemotingTransportException + FullyQualifiedErrorId : PSSessionStateBroken`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T07:18:30.063

看起来就像错误所说的那样，您的用户需要被信任（存在于 10.13.14.10 的 TrustedHost 列表中）才能进行委派。请参阅以下链接以获取更多信息。

*   [如何配置帐户，以便在 Windows Server 2003 Enterprise Edition 环境中信任它们进行委派？](http://www.windowsitpro.com/article/tips/jsi-tip-7359-how-do-i-configure-accounts-so-that-they-are-trusted-for-delegation-in-a-windows-server-2003-enterprise-edition-environment-)
*   [Kerberos 身份验证和故障排除委派问题](http://support.microsoft.com/kb/907272)

您甚至可以查看`winrm help config`命令以对此有更多了解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:34:13.427

要与其他用户一起执行此命令，只需使用凭据开关。所以运行你的命令如下：

```
invoke-command -computer 10.13.14.10 -scriptblock {\\publicshare\software.msi /quiet} -Credential $(Get-Credential) 
```

这将为您提供用户/密码提示，您可以输入有权访问的用户的详细信息。

WinRM本身也可能有问题，你确定你已经在远程机器上正确配置了吗？运行`winrm quickconfig`以确保它已被配置。

# image - 想用字符串连接图形图像

> ID：14857279
> 
> 赞同：-2
> 
> 时间：2013-02-13T15:43:17.640
> 
> 标签：image, concatenation

我正面临一个用字符串连接图像的问题。reqmnt 是当出现错误时，屏幕上的每条错误消息都应该以错误图标为前缀。目前在 xhtml（使用 jsf）中，它只显示一个错误图标：

我尝试使用下面的代码来实现它，但是在错误消息之前获得了 null 前缀：

类加载器 classLoader = Thread.currentThread().getContextClassLoader();

message.append("
"+classLoader.getResource("/images/english/error12.gif")+ issue.getMessage()+"");

等待您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T11:48:33.973

我得到了解决方案，以防万一其他人在寻找它，请在下面找到详细信息：

将您的 html 标记作为字符串，然后与您想要的任何字符串连接：

```
"<img src='/GroupeSetUpUiWar/javax.faces.resource/english/error12.gif.faces?ln=images' style='margin-right:5px;float:top;' />"; 
```

# version-control - 如何跟踪图标字体的更改？

> ID：14857281
> 
> 赞同：3
> 
> 时间：2013-02-13T15:43:21.760
> 
> 标签：version-control, font-face, icon-fonts

图标字体是一个很大的改进，但由于它们不是文本文件，因此无法使用 SCM 跟踪更改。当然，您可以跟踪整个文件，但是如果两个开发人员更改了文件，最后一个合并的人将很难尝试解决问题。她将需要重新创建字体文件。

您如何跟踪多个开发人员团队中的字体文件更改？

**更新：** 每当有人需要更改文件时，我们都会尝试发送电子邮件。虽然这可能有效，但它并不能解决根本问题：使用基于文本的工具管理二进制文件很麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:19:00.260

如果您需要对 Icon 字体等二进制元素进行版本化（而不仅仅是它们的 ccs3 文本文件），那么您描述的场景很可能会发生。

这意味着，如果您没有使用带有[锁模型](http://en.wikipedia.org/wiki/Comparison_of_revision_control_software)的 VCS ，那么您需要进行通信，以便一位开发人员*不会*更改与另一位开发人员已修改的文件相同的文件。

另一种方法是将二进制文件存储在[Artifact repo](http://www.sonatype.com/people/2009/04/what-is-a-repository/)（如[Nexus](http://www.sonatype.org/nexus/)）中，但是根本没有合并的概念。

# ios-ui-automation - iOS 仪器自动化“setValue”不起作用

> ID：14857282
> 
> 赞同：6
> 
> 时间：2013-02-13T15:43:25.237
> 
> 标签：ios-ui-automation, ui-testing, ios6.1

我只想用 UI 自动化测试我的 iOS UI，但是在向 UITextFields 输入文本时遇到了困难。文档说方法“setValue（...）”应该可以解决问题，但事实并非如此。

我总是收到这个错误：

```
Script threw an uncaught JavaScript error: Unexpected error in -[UIATextField_0x9952690 setValue:], /SourceCache/UIAutomation_Sim/UIAutomation-271/Framework/UIAElement.m line 1142, kAXErrorSuccess on line 15 of login.js, #0 setValue() 
```

代码如下所示：

```
var textfields = UIATarget.localTarget().frontMostApp().mainWindow().textFields();
username = textfields["username"];
username.setValue("test"); 
```

用户名字段不为空或未定义。

我的第二个解决方案是这个 JS 项目： [https](https://github.com/alexvollmer/tuneup_js#readme) ://github.com/alexvollmer/tuneup_js#readme 它有一个用于文本字段的“typeString”方法，但在输入数字和大写字母时有点错误并且失败。

我正在使用 iOS6.1、仪器版本 4.6 (46000)、Xcode 版本 4.6 (4H127)。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T07:45:06.083

检查以下是否适合您，

目标.延迟（1）；UIATarget.localTarget().frontMostApp().mainWindow().textFields()["username"].tap(); 目标.延迟（1）；UIATarget.localTarget().frontMostApp().mainWindow().textFields()["username"].setValue("test");

如果对您不起作用，请检查正确的层次结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-29T00:10:45.993

我来到这里努力理解 UI 自动化脚本是如何工作的，因为那里的文档和示例代码确实缺乏（或者从一个非常具体的角度编写并不能解释所有情况）。

以下是关于我学到的主题的两件事：

1.  首先，您*必须*在元素上启用辅助功能。我在试验中禁用了它，并且在我重新启用它之前，事情的表现非常奇怪（得到一个与你类似的“意外错误”）。因此，请确保您已打开辅助功能。但请注意，*有些*东西在禁用它的情况下仍然有效。例如，您仍然可以通过其名称 (accessibilityIdentifier) 查找元素，但您将无法点击它或调用`setValue()`.

[![在此处输入图像描述](../Images/33651c07d531e8f5f2d09eaa989a8036.png)](https://i.stack.imgur.com/BDyot.png)

2.  您必须深入了解您的应用程序层次结构。我的假设是，给一个元素 an`accessibilityIdentifier`将允许我简单地查找具有该标识符的元素，如 HTML 的`getElementById`. 但它根本*不是*这样的。即使使用accessibilityIdentifier，您也必须逐级挖掘层次结构。幸运的是，您可以使用`UIAElement.logElementTree()`来获取有关要使用的正确层次结构的一些线索。

到目前为止，我对这个框架完全没有印象，但我的进步是如此缓慢。

# continuous-integration - 自动跟踪不同环境版本的方法？

> ID：14857287
> 
> 赞同：1
> 
> 时间：2013-02-13T15:43:32.350
> 
> 标签：continuous-integration, teamcity, jira, confluence, environments

在我的项目中，我们使用 JIRA + Confluence + Teamcity。

我们有不同的环境（开发、系统测试、测试版、集成、实时）。我们使 CI 和我们的构建从一个环境到另一个环境取得进展。

如果我想查看我只需要访问的版本

```
http://dev.xxxxx.blah:9000/version.xml
http://systest.xxxxx.blah:9000/version.xml 
```

该xml包含

```
<buildInfo>
 <buildNumber>46</buildNumber>
</buildInfo> 
```

现在我们在手动更新的白板上跟踪不同的版本……不太可靠。我正在考虑做一个简单的网络应用程序，它可以为不同的环境获取 xml，并在表格或类似的表格中显示结果。

但我想知道......**是否已经有任何 JIRA 或 Confluence 或 Teamcity 插件可以做到这一点？**.

如果没有，**是否有任何应用程序可以轻松做到这一点？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:21:11.373

TeamCity 可以使用您的自定义版本号（带有版本字符串或其他内容）而不是其自己的序列生成的版本号。在我的团队中，我们正在设置自己的版本号，基于源代码控制变更集编号作为内部版本号，我们可以在 TeamCity 中看到当前部署的工件的版本，在最后一次运行“部署到 XYZ”阶段旁边 -有关示例，请参见[JetBrains 自己的 TeamCity 实例](http://teamcity.jetbrains.com/)（例如，请参见“TeamCity C# runner 插件”）。

您需要做的就是在构建/部署过程输出中包含此 TeamCity 命令：

```
##teamcity[buildNumber '<buildnum>'] 
```

请参阅[文档](http://confluence.jetbrains.com/display/TCD65/Build+Script+Interaction+with+TeamCity#BuildScriptInteractionwithTeamCity-ReportingBuildNumber)。

# javascript - 在 selenium ide 中调用 js 文件函数

> ID：14857290
> 
> 赞同：0
> 
> 时间：2013-02-13T15:43:47.420
> 
> 标签：javascript, selenium

公司刚刚开始在 Firefox 中使用 Selenium IDE 1.10。在某些网页中，有一个用户名和密码以及允许进入的输入按钮。我找到了一个允许使用这个 .js 文件生成随机文本的代码。如何从这个 .JS 文件调用这个函数来填充这个文本框并输入一个虚构的密码。这只是 Web 测试中的一个非常初步的阶段，以查看某些功能是否有效。建议？如何从 IDE 本身调用此函数，而无需经过密集的 Java 脚本培训。公司目前不想仅使用 1.10 IDE 本身和一些简单的 JavaScript 来填充字段（如果可能）。

```
 // Generate random text for a variable
// Possible options:
//   length      number indicating how long to make the string (defaults to 8)
//
//   type        string indicating what type of string to create alpha, numeric
//               or alphanumeric (defaults to alphanumeric)
//
//   length|type pipe delimited option list

Selenium.prototype.doRandomString = function( options, varName ) {

    var length = 8;
    var type   = 'alphanumeric';

    var o = options.split( '|' );

    for ( var i = 0 ; i < 2 ; i ++ ) {
        if ( o[i] && o[i].match( /^\d+$/ ) )
            length = o[i];

        if ( o[i] && o[i].match( /^(?:alpha)?(?:numeric)?$/ ) )
            type = o[i];
    }

    switch( type ) {
        case 'alpha'        : storedVars[ varName ] = randomAlpha( length ); break;
        case 'numeric'      : storedVars[ varName ] = randomNumeric( length ); break;
        case 'alphanumeric' : storedVars[ varName ] = randomAlphaNumeric( length ); break;
        default             : storedVars[ varName ] = randomAlphaNumeric( length );
    };
};

function randomNumeric ( length ) {
    return generateRandomString( length, '0123456789'.split( '' ) );
}

function randomAlpha ( length ) {
    var alpha = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'.split( '' );
    return generateRandomString( length, alpha );
}

function randomAlphaNumeric ( length ) {
    var alphanumeric = '01234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'.split( '' );
    return generateRandomString( length, alphanumeric );
}

function generateRandomString( length, chars ) {
    var string = '';
    for ( var i = 0 ; i < length ; i++ )
        string += chars[ Math.floor( Math.random() * chars.length ) ];
    return string;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T03:15:49.470

打开一个记事本并将您的javascript代码放入其中并在执行此操作后保存记事本有userextension.js文件

打开 selenium IDE > 选项 > 常规选项卡。浏览 selenium 核心扩展中保存的 userextension.js 文件，然后关闭 selenium 并重新启动。然后是行动

命令：随机字符串

目标：6

值：文本

命令：类型

Target::id= 文本框的id

值：${文本}

这里 6 是要生成的字符串的长度

text 是存储生成的字符串的变量

id= 文本框的id是生成的字符串要放置的地方

谢谢你。

# automation - ToolStrip 按钮点击问题的自动化

> ID：14857292
> 
> 赞同：0
> 
> 时间：2013-02-13T15:43:48.470
> 
> 标签：automation, spy++, toolstripbutton

我正在尝试使用 vb.net 自动化 Windows 窗体应用程序。我没有想要自动化的程序的源代码。

使用 Spy++，到目前为止，我一直在使用按钮的句柄，并且一直在单击按钮而没有问题。但是，我偶然发现了工具条按钮的问题，我一直在努力解决它。这些按钮是隐藏的或不可见的（从我读过的内容来看），它们没有出现在 spy++ 中，所以它们似乎没有句柄；因此，我不能使用按钮的句柄来单击它，因为它不存在。

为了解决这个问题，我不得不将鼠标光标移动到特定的屏幕位置，重新定位窗口并启动鼠标单击事件。这种方法不是最好的，因为在自动化代码运行时无法使用鼠标。任何人都可以提出替代方案吗？我已经在互联网和这个网站上搜寻了三天的解决方案，但没有成功。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T16:52:31.457

我自己解决了这个问题！！！我很高兴……哈哈。我没有尝试自动热键，但我找到的解决方案是一个很好的解决方案，或者至少我认为它是。这里提供了一个很好的解释...... [http://msdn.microsoft.com/en-us/magazine/cc163288.aspx](http://msdn.microsoft.com/en-us/magazine/cc163288.aspx)

无论如何，解决方案是 vb.net 有一个“UI 自动化”库/参考，您可以将其添加到您的项目中。我在网上看到它提到过几次，但不知道如何导入它（对不起，我是 vb.net/coding newby）。无论如何，您将“UI 自动化”引用添加到您的项目，然后将其导入。然后，您可以使用该库来查找屏幕上的所有控件。这包括工具条中的所有按钮。

我在下面添加了一个代码示例来演示我是如何解决它的。我敢肯定它在某种程度上很复杂，可能会做得更好，但它确实有效。让我知道您对代码/解决方案的看法。

为了运行代码，您需要知道按钮的索引和工具条的索引。如果您进入调试模式，您可以手动增加索引并检查 controlName 直到出现正确的按钮。在下面的示例中，我必须找到父元素（窗口），然后是子元素（工具条），然后是子元素（工具条下的所有按钮）。

```
Imports system.windows.automation
Imports system.eventargs

'RoutedEvenArgs has to exist as a class so I declare it here...

Public class RoutedEventArgs Inherits EventArgs

end class

'my form code is all under one class - I'll probably break it up better
' but at the moment this is how it is

Public Class form1

Private Sub Button1_Click_1(ByVal sender As System.Object, _
                            ByVal e As System.EventArgs) Handles Button1.Click

'click the button of hte automation front end and 
' call the findtreeviewdescendants procedure

    FindTreeViewDescendants()

End Sub

Private Sub FindTreeViewDescendants()

'define the desktop as the rootelement as everywindow is a child of this element

Dim aedesktop As AutomationElement = AutomationElement.RootElement

'create an automationelementcollection variable to store the buttons

Dim aebuttons As AutomationElementCollection

'find the screen using the screen title 

aeform = aedesktop.FindFirst(TreeScope.Children, New PropertyCondition _
(AutomationElement.NameProperty, "Single Stock View"))

'find all the child controls (this brings back all controls including the toolstrip)

aebuttons = aeform.FindAll(TreeScope.Children, New PropertyCondition _(AutomationElement.IsControlElementProperty, True))

'create an automationelement to store the button and get information out of it

Dim a As AutomationElement

'each button, in the collection, has an index (incidentally the index number corresponds with the order in  which the window loads each of the elements into the window), in this case the toolstrip is index 1 as it's in the header of the screen

a = aebuttons.Item(1)

'get the child elements of the toolstrip element (something interesting is that in this case there were 19 elements but when you use findwindowex you only get back 4)

aebuttons = a.FindAll(TreeScope.Children, New PropertyCondition(AutomationElement.IsControlElementProperty, True))

'again use the index of the button to pull back the element information

a = aebuttons.Item(11)

'create a stringbuilder to store information about the element

Dim elementInfoCompile = New StringBuilder()

'identify the controlname, which in my case is the tooltip tag of the button (thus solving the problem of how I can find a button with an image instead of text in it)

Dim controlName As String
If (a.Current.Name = "") Then
controlName = "Unnamed control"
Else
controlName = a.Current.Name
End If

'identify the autoidname - which in all cases seemed to be null - I've no idea why but this didn't matter anyway

Dim autoIdName As String

If (a.Current.AutomationId = "") Then
autoIdName = "No AutomationID"
Else
autoIdName = a.Current.AutomationId
End If

'invoke a click of the button

InvokeControl(a)

End Sub 'FindTreeViewDescendants

'the rest is self-explanatory....

Private Sub InvokeControl(ByVal targetControl As AutomationElement)
Dim invokePattern As InvokePattern = Nothing

Try
invokePattern = _
DirectCast(targetControl.GetCurrentPattern(invokePattern.Pattern),  _
InvokePattern)
Catch e As ElementNotEnabledException
' Object is not enabled. 
Return
Catch e As InvalidOperationException
' Object doesn't support the InvokePattern control pattern 
Return
End Try

invokePattern.Invoke()

End Sub 'InvokeControl

End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:58:45.357

一般来说，最好安排你的代码，这样你的工具条按钮（或者你*曾经*在界面上使用过的任何按钮）和后端的业务逻辑之间是分开的。如果可能的话，通过编写一个将由按钮单击处理程序调用的函数来创建一个“代码接缝”，即使它很简单

（在 VB 中）

```
Private Sub btnSomeButton_Click(ByVal sender As System.Object, _
                                ByVal e As System.EventArgs) _
                                Handles btnSomeButton.Click
     BusinessLogicClass.DoSomeButtonWork()
End Sub 
```

这样，您可以轻松地在其他函数中调用该函数，在自动化脚本中使用它们，为它们编写单元测试和模拟，并在一个地方而不是多个地方进行重构。这称为“解耦”。这是一个真正卓越的解决方案，特别是如果您计划以“批处理模式”使用该过程。

# wpf - 如何从子视图模型更新父 ViewModel 属性

> ID：14857293
> 
> 赞同：0
> 
> 时间：2013-02-13T15:43:51.640
> 
> 标签：wpf, viewmodel, parent-child, communication

我有一个视图窗口，该窗口具有选项卡控件，每个选项卡内都有不同的用户控件。窗口有自己的视图模型，每个用户控件也是如此。现在如何从任何子用户控件视图模型更新主窗口视图模型的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:28:22.333

嗨，如果您从父视图模型实例化子视图模型，那么您可以通过从子视图模型触发事件并在父视图模型上侦听该事件并更新父视图模型的所需属性来实现。但是，如果您从视图（即您的 userControl）实例化您的 ViewModel，那么您需要在 UserControl 中创建 DependencyProperty 并将其绑定到父视图模型和子 ViewModel 属性，但它确实有一个问题，您只能将一个属性绑定到 xaml 中的目标属性和必须从 DependencyProperty 的 ValueChanged 更新子 ViewModel 属性。我希望这会给你一个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T18:14:35.840

我的`AddUser`用户控件孩子：

```
public event EventHandler<RoutedEventArgs> SaveUser;

// Wherever I want that event to be launched I write this:
private void buttonSaveUser_Click(object sender, RoutedEventArgs e)
{
    EventHandler<RoutedEventArgs> handler = SaveUser;
    handler(this, userEventArgs);
} 
```

在您的`MainWindow.xaml`，一旦您创建了您的`UserControl`孩子，请订阅该事件：

```
addUser = new F7AddUser();
addUser.SaveUser += AddUser; 
```

然后创建你的新`AddUser`方法（这个必须在你的`MainWindow.xaml`）。请注意，因为这个来自`event`，所以参数必须与启动它的事件相同：

```
private void AddUser(object o, RoutedEventArgs e)
{
    // Stuff here
} 
```

# prestashop - Prestashop 1.5.3 基于属性库的分层块过滤器

> ID：14857295
> 
> 赞同：0
> 
> 时间：2013-02-13T15:44:01.050
> 
> 标签：prestashop

我在 prestashop 的基础上开了一家新店。但我面临一个问题。

我们卖鞋子之类的。它们都有尺寸，因此总“库存”基于尺寸。例如：1 x 36 1 x 37 等。

因此，例如，我有 10 种鞋款，每款 5 种尺码，如果某些尺码已售罄，分层块仍将产品视为有货。

我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-14T01:54:49.597

在产品的数量选项卡上检查您的产品数量。如果您有多个组合，则需要手动检查它的更新。

# internet-explorer - 网站在除 IE7 之外的所有浏览器和版本中看起来都不错

> ID：14857297
> 
> 赞同：0
> 
> 时间：2013-02-13T15:44:01.920
> 
> 标签：internet-explorer, cross-browser, internet-explorer-7

我有 energyshop.se，它在 Chrome、IE8-9、Firefox 中看起来不错，但在 IE7 中却没有，因为我的一位朋友注意到了。菜单和页脚不再是水平的，而是垂直的。

我该如何解决这个问题？

这是我在页眉和页脚菜单中的顶部菜单的 CSS：

```
#main_menu {
font-family:Calibri;
font-size:24px;
background-color:#1ca46e;
height:45px;
-webkit-border-radius: 10px;
-moz-border-radius: 10px;
border-radius: 10px;
width:850px;
margin-left:22px;
margin-bottom: -35px;
margin-top: -30px;
top:100px;
}

#main_menu a {
    color:#ffffff;
    height: 10px;
    display: block;
    float: left;
    width: 105px;
    text-align: center;
    margin-top: 8px;
    margin-right: 10px;
    margin-bottom: 0;
    margin-left: 2px;
    background-color:#1ca46e;
    border-top-width: 1px;
    border-right-width: 3px;
    border-bottom-width: 1px;
    border-left-width: 1px;
    border-top-style: none;
    border-right-style: solid;
    border-bottom-style: none;
    border-left-style: none;
    border-right-color: white;
    padding-top: 2px;
    padding-right: 12px;
    padding-bottom: 2px;
    padding-left: 5px;
    font-family: Calibri;
    vertical-align: middle;
    height:28px;
}

#main_menu a:hover {
    color:#555;
}

#main_menu li.current-menu-item a {
    text-decoration:underline;
    font-weight:bold;
    text-shadow: 2px 2px #403F40;
    }

#footer_menu {
    position:relative;
    text-align:center;
    height:75px;
    font-family:Calibri;
    margin-top:25px;
    margin-left:50px;
    color:#9221a6;
    font-size:22px;
    font-weight: bolder;
}
#footer_menu a {
    margin:5px; 
    margin-top:5px;
    margin-bottom:5px;
    color: #9221a6;
    float:left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:57:17.390

尝试添加“显示：内联；” 到你的页脚..它应该对你有帮助。告诉我，如果不是，我会尝试找出其他东西；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:55:34.613

似乎您正在使用`list-style-type:none;`IE7（但不是 8）中的 css 属性，仅删除`<li>`元素上的项目符号...

尝试添加css属性`display:inline;`来解决它...

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-13T15:57:13.120

根据您网站上的文档`<!DOCTYPE html>` 类型，我假设您正在使用一些`html5`仅有的功能。这可能是无法正确渲染
的原因。 解决此问题的一种方法是使用 `IE7`

[http://www.modernizr.com/](http://www.modernizr.com/)

祝你好运

# javascript - 如何显示网页的样式表

> ID：14857298
> 
> 赞同：0
> 
> 时间：2013-02-13T15:44:03.107
> 
> 标签：javascript, html, css, stylesheet

有没有办法显示网页的完整 CSS 样式表，除了获取每个元素的每个样式，如下所示：

```
document.write("width:"+document.getElementById("to").style.width+";"); 
```

CSS 可以在外部文件中，也可以在内部`<style>`标签中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:55:30.390

您可以使用[document.styleSheets](https://developer.mozilla.org/en-US/docs/DOM/document.styleSheets)

就像在 document.styleSheets[0].cssRules[0].cssText

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:57:44.123

最好使用可以“获取”CSS 文件并打印它们的服务器端语言。

过去，我使用 Railo 和一个名为 jSoup 的 Java 库非常容易做到这一点。这不是一个非常流行的设置，但是 jSoup 可以与 Java 一起使用（当然），所以如果你在你的 web 应用程序中使用它，那将是一件轻而易举的事。

我像这样在 Railo 中获取我的页面：

```
<cfhttp method="get" url="http://example.com" resolveurl="true" result="local.objGet" timeout="10" charset="utf-8">
<cfhttpparam type="header" name="Accept-Encoding" value="*" />   
<cfhttpparam type="header" name="TE" value="deflate;q=0" />        
</cfhttp> 
```

上面的代码发出一个 HTTP 请求来获取 HTML 页面。

然后我使用 jSoup 遍历 fetch CSS 文件链接的 DOM：

```
<cfset local.jsoup = createObject("java", "org.jsoup.Jsoup") />
<cfset local.getDocument = local.jsoup.parse(local.objGet.filecontent) />
<cfset local.getCss = reMatch('\bhttps?:[^)''"]+\.(?:css)', local.getDocument) /> 
```

这会从文档中获取以“.CS​​S”结尾的链接数组。然后我可以在数组的循环中使用 HTTP 请求再次对这些进行“获取”。然后我可以将它打印到屏幕上，并根据需要对其进行任何处理。

我知道我的回答是针对特定语言的，但基本原则就在那里。

在 PHP 中，我认为您可以使用 cURL 进行 HTTP 调用，但同样，如果您使用 Java、ColdFusion、Railo 或 BlueDragon，您应该可以使用 jSoup。

希望这可以帮助。

**Railo 应用服务器：** [http ://www.getrailo.org/](http://www.getrailo.org/)

**jSoup HTML 解析器：http:** [//jsoup.org/](http://jsoup.org/)

# java - 为什么 JOptionPane 中的 JScrollPane 不显示其所有内容？

> ID：14857299
> 
> 赞同：6
> 
> 时间：2013-02-13T15:44:05.473
> 
> 标签：java, swing, jscrollpane, joptionpane

我正在尝试将组件添加到 JPanel，然后将此面板放入 JScrollPane，然后将 JScrollPane 放入 JOptionPane。

问题：只添加了 19 行组件。有一个用于确定组件行数的 for 循环，如果将条件计数器更改为 19 或更少，则将显示所有组件。

这是问题的SSCCE

```
import java.awt.Dimension;
import javax.swing.GroupLayout;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.SwingConstants;

public class DynamicGroupLayout extends JPanel
{

    JButton addRecordButton;
    JTextField[] FieldsArray;
    JLabel[] LabelsArray;
    GroupLayout layout;
    JScrollPane scrollPane;

    public DynamicGroupLayout()
    {
        addRecordButton = new JButton("add record");
        layout = new GroupLayout(this);
        this.setLayout(layout);
        layout.setAutoCreateGaps(true);
        layout.setAutoCreateContainerGaps(true);

        scrollPane = new JScrollPane(this);
        scrollPane.getVerticalScrollBar().setUnitIncrement(16);
        scrollPane.setPreferredSize(this.getPreferredSize());

        setTextFields();
        showDialog();
    }

    @Override
    public Dimension getPreferredSize()
    {
        return new Dimension(400, 500);
    }

    private void setTextFields()
    {
        int num = 30;  //If 19 or less, all components shown.
        String[] labelsNames =
        {
            "1", "2", "3", "4", "5", "6", "7", "8", "9", "10",
            "11", "12", "13", "14", "15", "16", "17", "18", "19", "20",
            "21", "22", "23", "24", "25", "26", "27", "28", "29", "30"
        };
        FieldsArray = new JTextField[num];
        LabelsArray = new JLabel[num];

        GroupLayout.ParallelGroup parallelGroupHoriz = layout.createParallelGroup();
        layout.setHorizontalGroup(layout.createSequentialGroup().addGroup(parallelGroupHoriz));
        for (int i = 0; i < num; i++)
        {
            System.out.println(i);
            LabelsArray[i] = new JLabel(labelsNames[i]);
            FieldsArray[i] = new JTextField(10);
            FieldsArray[i].setMaximumSize(new Dimension(200, 3));
            LabelsArray[i].setLabelFor(FieldsArray[i]);
            parallelGroupHoriz.addGroup(layout.createSequentialGroup()
                    .addComponent(LabelsArray[i])
                    .addComponent(FieldsArray[i]));
        }
        parallelGroupHoriz.addComponent(addRecordButton, GroupLayout.Alignment.CENTER);

        GroupLayout.SequentialGroup sequentialGroupVert = layout.createSequentialGroup();

        layout.setVerticalGroup(sequentialGroupVert);
        for (int i = 0; i < num; i++)
        {
            sequentialGroupVert.addGroup(layout.createParallelGroup().
                    addComponent(LabelsArray[i])
                    .addComponent(FieldsArray[i]));
        }
        sequentialGroupVert.addComponent(addRecordButton);

        for (int i = 0; i < num; i++)
        {
            layout.linkSize(SwingConstants.HORIZONTAL, LabelsArray[i], LabelsArray[0]);
        }
    }

    private void showDialog()
    {
        JOptionPane.showOptionDialog(null, scrollPane, "Update data",
                JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null,
                null, null);
    }

    public static void main(String[] args)
    {
        DynamicGroupLayout d = new DynamicGroupLayout();
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T16:32:04.367

如本相关[示例](https://stackoverflow.com/a/14011536/230513)所示，您可以覆盖视口的首选大小。

![在此处输入图像描述](../Images/6b208ad84786b258a1847363a8753664.png)

```
import java.awt.Dimension;
import java.awt.EventQueue;
import javax.swing.GroupLayout;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.SwingConstants;

/**
 * @see https://stackoverflow.com/a/14858272/230513
 * @see https://stackoverflow.com/a/8504753/230513
 * @see https://stackoverflow.com/a/14011536/230513
 */
public class DynamicGroupLayout {

    private static final int NUM = 30;
    private JTextField[] fields = new JTextField[NUM];
    private JLabel[] labels = new JLabel[NUM];

    private JPanel create() {
        JPanel panel = new JPanel();
        GroupLayout layout = new GroupLayout(panel);
        panel.setLayout(layout);
        layout.setAutoCreateGaps(true);
        layout.setAutoCreateContainerGaps(true);
        GroupLayout.ParallelGroup parallel = layout.createParallelGroup();
        layout.setHorizontalGroup(layout.createSequentialGroup().addGroup(parallel));
        GroupLayout.SequentialGroup sequential = layout.createSequentialGroup();
        layout.setVerticalGroup(sequential);
        for (int i = 0; i < NUM; i++) {
            labels[i] = new JLabel(String.valueOf(i + 1), JLabel.RIGHT);
            fields[i] = new JTextField(String.valueOf("String " + (i + 1)));
            labels[i].setLabelFor(fields[i]);
            parallel.addGroup(layout.createSequentialGroup().
                addComponent(labels[i]).addComponent(fields[i]));
            sequential.addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE).
                addComponent(labels[i]).addComponent(fields[i]));
            layout.linkSize(SwingConstants.HORIZONTAL, labels[i], labels[0]);
        }
        return panel;
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                final JPanel panel = new DynamicGroupLayout().create();
                JScrollPane jsp = new JScrollPane(panel) {
                    @Override
                    public Dimension getPreferredSize() {
                        return new Dimension(320, 240);
                    }
                };
                JOptionPane.showMessageDialog(null,
                    jsp, "Data", JOptionPane.PLAIN_MESSAGE);
            }
        });
    }
} 
```

# c# - MVC：需要用多个项目构建我的应用程序

> ID：14857301
> 
> 赞同：3
> 
> 时间：2013-02-13T15:44:17.080
> 
> 标签：c#, visual-studio-2010, build

我有一个包含许多项目的应用程序。我有时发现我必须删除 dll 并重新编译每个项目，然后才能进行全面的干净编译。我还发现，当我进行构建时，我必须记住检查存储在 bin 文件夹中的每个项目的 dll，编译每个项目，检入 dll，然后运行构建以获得干净的编译。这很麻烦。我只想为我所做的任何更改以及发布时重建一次。那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:02:43.293

如果没有更多详细信息，很难确切地知道您需要什么来解决您的特定问题，但这些提示应该会有很大帮助。

> 当我进行构建时，我必须记住检查存储在 bin 文件夹中的每个项目的 dll

首先，不要将您的 bin 文件夹内容存储在源代码管理中。相反，仅当您需要与他人共享构建时才发布构建，并将其放在源代码控制系统中的不同位置。这是一个可以以这种方式工作的文件夹结构的示例。

-MyProduct --main ----src ----bin << not check in ----etc... -Distribution --MyProject ----release number ------明确发布的dll

> 在进行整体干净编译之前，我必须删除 dll 并重新编译每个项目。

有时会发生这种情况。在 Visual Studio 中使用重建解决方案命令。

如果您使用文件引用而不是项目引用，则可能导致这种情况更频繁地发生的一个问题。使用项目参考。有关详细信息，请参阅此问题：

[项目参考与文件参考？](https://stackoverflow.com/questions/973814/project-reference-vs-file-reference)

如果由于某种原因不能使用项目引用，您可以手动更改解决方案的构建顺序，并设置项目之间的依赖关系以便更好地更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:10:47.757

我们在我工作的公司遇到了这个问题，我们仍在努力解决它。

我提出的第一个建议是在您的解决方案中不要有对公共库的项目引用。您说您的项目的 bin 文件夹中有一些内部 dll。你需要问自己：

*   这些 dll 是否特定于此解决方案
*   或者，它们是您将再次使用的常用库吗

如果是前者，那么我建议您将该 dll 源作为解决方案中的一个项目。在 Visual Studio 中正确设置构建顺序，重建解决方案将确保一切都得到一个干净的构建。

但是，如果是后者并且您将在其他解决方案中重用这些 dll，那么它们应该在自己的解决方案中。理想情况下使用构建服务器，例如 Cruise Control 或类似的东西。这将允许您对公共库进行更改，并且如果您正确设置它，它将自动使用新版本号重新编译它。然后，一旦你的公共库通过了它的测试并且你很乐意发布它，就将它放入你正在处理的项目中的“bin”或“Dependencies”文件夹中。引用该 dll 而不是上一个示例中的项目。当您构建项目时，它将在编译时使用 bin/Dependencies 文件夹中的 dll。

这样做的好处是，如果您在一个解决方案中使用公共库并将其发布给客户端或作为项目，然后更改公共库并发布新的客户端解决方案/产品，您将确切知道公共库的哪个版本正在使用。然后你可以去你的源代码控制并提取确切的代码。

我们正在使用一些产品，并通过我们实施的每个客户解决方案有效地发展它们。经过十几个项目后，我们不知道每个客户端运行的是什么版本的代码。自从我们迁移到与 Mercurial for SSC 关联的 Cruise Control 之后，我们现在清楚地知道我们所有的产品和客户端解决方案都使用什么版本的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T18:27:20.507

> 我有时发现我必须删除 dll 并重新编译每个项目，然后才能进行全面的干净编译。

右键单击解决方案 > 清洁解决方案。然后重新构建。这通常会清除奇怪的构建错误。

> 我还发现，当我进行构建时，我必须记住检查存储在 bin 文件夹中的每个项目的 dll，编译每个项目，检入 dll，然后运行构建以获得干净的编译。

这很可能是真正的问题。不要将外部 dll 直接添加到 bin 中。相反，将任何 3rd 方 dll 添加到解决方案根目录的文件夹中，或者实际上，添加到您可以访问的任何其他位置，但我发现根目录是一个好地方：

```
 - Solution Folder
   - ExtLib (place all your 3rd party assemblies here; use sub-folders if needed)
   - Project A
   - Project B
   - MySolution.sln 
```

然后根据需要从您的 ExtLib 添加对每个项目的引用：添加引用 > 浏览：根据需要添加 dll。

添加 dll 后，确保将它们标记为“复制本地”：参考 > 右键单击​​程序集：复制本地 = True。

如果您需要引用的程序集在相关项目中，则只需添加项目引用即可；无需复制本地，因为 VS 会为您处理。

使用上述内容，您可以将第 3 方程序集保存在您的 ExtLib 文件夹中，并在需要时添加到源代码管理中。然后，每当有人从源代码管理中拉下项目时，他们都会选择 ExtLib 文件夹和任何更新的程序集。无论何时构建，程序集都会从 ExtLib 中引用并复制到 bin。

正如其他人所提到的，永远不要将您的 bin 文件夹添加到源代码管理：YMMV。

# android - 将 onclicklistener 设置为片段

> ID：14857315
> 
> 赞同：0
> 
> 时间：2013-02-13T15:45:05.067
> 
> 标签：android

我有活动。在活动中，我有片段（“MyFragment”）。在片段中，我有 listView。

然后在我接下来的代码中：

```
view.findViewById(R.id.my_fragment).setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(final View v) {
        //SomeAction
    }
}); 
```

但是这个 onClick 不起作用。我认为是因为 ListView 覆盖了整个片段。

然后我接下来设置为列表视图：

```
android:clickable="false"
android:focusable="false"
android:focusableInTouchMode="false" 
```

但它不起作用。如何制作片段以捕获所有点击事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:10:56.883

如果您的片段中只有一个 ListView，最好使用[ListFragment](http://developer.android.com/reference/android/app/ListFragment.html)。OnitemClickListener 更好地集成。您只需要覆盖 OnListItem 侦听器

这里有很好的教程：http: [//developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

这是一个例子：

```
public class ListMenu extends android.support.v4.app.ListFragment {

private String[] strList = { "test1", "test2", "test3", "test4" };
OnMenuSelectedListener mCallback;

public interface OnMenuSelectedListener  {
    public void onMenuSelected(int position);
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    this.setListAdapter(new ArrayAdapter<String>(getActivity(),
            android.R.layout.simple_list_item_activated_1, strList));

}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

}

@Override
public void onAttach(Activity activity) {
    super.onAttach(activity);

    // This makes sure that the container activity has implemented
    // the callback interface. If not, it throws an exception.
    try {
        mCallback = (OnMenuSelectedListener) activity;
    } catch (ClassCastException e) {
        throw new ClassCastException(activity.toString()
                + " must implement OnHeadlineSelectedListener");
    }
}

@Override
public void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);

    mCallback.onMenuSelected(position);
    getListView().setItemChecked(position, true);
}

} 
```

# turing-machines - 所有无限的语言都是不可判定的吗？

> ID：14857316
> 
> 赞同：0
> 
> 时间：2013-02-13T15:45:06.093
> 
> 标签：turing-machines, computation-theory, language-theory

我想知道所有无限语言都无法确定吗？

他们一定是对的，因为试图决定一种无限语言的 TM 只会永远循环，这使它成为一个recgonizer，而不是一个决定者。

多谢你们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T15:49:26.663

不，有许多无限的语言是可判定的。一个简单的例子是语言`{n € N | a^n}`，即只包含字母“a”的单词的语言。这种语言可以通过正则表达式匹配`a*`。所以它是一种常规语言，因此是可判定的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:47:55.620

正如 sepp2k 指出的那样，`a*`它是一种常规语言，因此是可判定的。

所有有限语言都是正则的。一些无限的语言是有规律的。只有无限的语言是不可判定的。

要不可判定，语言中必须存在导致 TM 失败的单独字符串。实际上，这样的字符串肯定有无限多（否则，表现不佳的字符串可以由特殊情况逻辑处理）。

因此，对于不可判定性来说，语言是无限的是必要的，但不是充分的。

# puppet - 远程安装 Chocolatey 并远程获取包

> ID：14857317
> 
> 赞同：0
> 
> 时间：2013-02-13T15:45:07.890
> 
> 标签：puppet, chocolatey

我正在尝试使用 Jenkins 将巧克力安装到我想提供一些巧克力包的 Windows 机器上。

安装日志对我来说似乎相当不错。

```
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Downloading http://chocolatey.org/api/v2/package/chocolatey/ to C:\Users\_BUILD~1\AppData\Local\Temp\chocolatey\chocInstall\chocolatey.zip [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Extracting C:\Users\_BUILD~1\AppData\Local\Temp\chocolatey\chocInstall\chocolatey.zip to ... [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Installing chocolatey on this machine [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating ChocolateyInstall as a User Environment variable and setting it to 'C:\Chocolatey' [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: We are setting up the Chocolatey repository for NuGet packages that should be at the machine level. Think executables/application packages, not library packages. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: That is what Chocolatey NuGet goodness is for. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: The repository is set up at 'C:\Chocolatey'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: The packages themselves go to 'C:\Chocolatey\lib' (i.e. C:\Chocolatey\lib\yourPackageName). [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: A batch file for the command line goes to 'C:\Chocolatey\bin' and points to an executable in 'C:\Chocolatey\lib\yourPackageName'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns:  [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating Chocolatey NuGet folders if they do not already exist. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns:  [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: d----         2/13/2013  10:20 AM            bin                                [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: d----         2/13/2013  10:20 AM            lib                                [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: d----         2/13/2013  10:20 AM            chocolateyinstall                  [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Copying the contents of 'C:\Users\buildaccount\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall' to 'C:\Chocolatey'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\chocolatey.bat' so you can call 'chocolatey' from anywhere. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cinst.bat' so you can call 'chocolatey install' from a shortcut of 'cinst'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cinstm.bat' so you can call 'chocolatey installmissing' from a shortcut of 'cinstm'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cup.bat' so you can call 'chocolatey update' from a shortcut of 'cup'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\clist.bat' so you can call 'chocolatey list' from a shortcut of 'clist'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cver.bat' so you can call 'chocolatey version' from a shortcut of 'cver'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cwebpi.bat' so you can call 'chocolatey webpi' from a shortcut of 'cwebpi'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cwindowsfeatures.bat' so you can call 'chocolatey windowsfeatures' from a shortcut of 'cwindowsfeatures'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\ccygwin.bat' so you can call 'chocolatey cygwin' from a shortcut of 'ccygwin'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cpython.bat' so you can call 'chocolatey python' from a shortcut of 'cpython'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cgem.bat' so you can call 'chocolatey gem' from a shortcut of 'cgem'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cpack.bat' so you can call 'chocolatey pack' from a shortcut of 'cpack'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cpush.bat' so you can call 'chocolatey push' from a shortcut of 'cpush'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Creating 'C:\Chocolatey\bin\cuninst.bat' so you can call 'chocolatey uninstall' from a shortcut of 'cuninst'. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns:  [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: PATH environment variable does not have 'C:\Chocolatey\bin' in it. Adding. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing ccygwin.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cgem.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing chocolatey.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cinst.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cinstm.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing clist.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cpack.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cpush.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cpython.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cuninst.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cup.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cver.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cwebpi.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Processing cwindowsfeatures.bat to make it portable [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Chocolatey is now ready. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: You can call chocolatey from anywhere, command line or powershell by typing chocolatey. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Run chocolatey /? for a list of functions. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: You may need to shut down and restart powershell and/or consoles first prior to using chocolatey. [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: If you are upgrading chocolatey from an older version (prior to 0.9.8.15) and don't use a custom chocolatey path, please find and delete the C:\NuGet folder after verifying that C:\Chocolatey has the same contents (minus chocolateyinstall of course). [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns: Ensuring chocolatey commands are on the path [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns:  [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns:  [0m
[10:20:21][Step 4/4]  [0;36mnotice: /Stage[main]/Chocolatey/Exec[ChocolateyInstall]/returns:  [0m 
```

但是，当我尝试使用 puppet 客户端远程安装一个简单的包时，它会抱怨 .NET Framework 4.0 错误。

```
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns: Chocolatey (v0.9.8.20) is installing  and dependencies. By installing you accept the license for  and each dependency you are installing. [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns: Execution of NuGet not detected. Please make sure you have .NET Framework 4.0 i [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns: nstalled and are passing arguments to the install command. [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns: At C:\Chocolatey\chocolateyinstall\functions\Run-NuGet.ps1:52 char:10 [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns: +     Throw <<<<  $noExecution [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns:     + CategoryInfo          : OperationStopped: (Execution of Nu...nstall comm  [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns:    and.:String) [], RuntimeException [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns:     + FullyQualifiedErrorId : Execution of NuGet not detected. Please make sur  [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns:    e you have .NET Framework 4.0 installed and are passing arguments to the i   [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns:   nstall command. [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns:   [0m
[10:20:24][Step 4/4]  [0;36mnotice: /Stage[main]/Hg/Exec[hg]/returns: executed successfully [0m 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T18:21:47.040

您的机器上是否安装了 .NET 4.0？

# c# - 你能根据传递的参数构造不同的派生类吗？

> ID：14857319
> 
> 赞同：2
> 
> 时间：2013-02-13T15:45:10.990
> 
> 标签：c#, inheritance, polymorphism

我想知道这样的事情是否可能......

```
class Thing
{
        public Thing(int i)
        {
        }
}

class DerivedThing : Thing
{
        public DerivedThing(int i)
        {
        }
}

_thing = new Thing(0)

_derivedthing  = new Thing(1) 
```

如果你通过 0 你会得到一个东西，如果你通过 1 你会得到一个 DerivedThing 这并不完整，只是一个插图。但基本上我想知道是否/如何根据传递的参数的值返回不同的派生类到基类构造函数？还是您只需要另一段代码来决定调用哪个构造函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T15:47:12.800

回答你的问题：不，这是不可能的。但...

你实际上是在寻找一种`Factory`模式。您可以轻松地在工厂方法中添加区分 if/case 并且仍然拥有相对干净的代码。

[工厂模式说明](http://en.wikipedia.org/wiki/Factory_method_pattern)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T15:46:45.310

这是不可能的。

相反，您可以创建一个`static Thing Create(int i)`方法来决定调用哪个构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T15:47:53.533

不，你为什么要这样做？

你也可以输入

```
var thing = new Thing();

var derivedThing = new DerivedThing(); 
```

你可以像，

```
public static class ThingFactory
{
    public interface IThing {}

    public enum ThingType
    {
        Thing,
        DerivedThing
    }

    public static IThing CreateThing(ThingType type)
    {
        switch(type)
        {
            case ThingType.DerivedThing:
                return new DerivedThing();

            default:
                return new Thing();
        }
    }

    private class Thing : IThing {}

    private class DerivedThing : Thing {}
} 
```

允许，

```
var thing = ThingFactory.CreateThing(ThingType.Thing);

var derivedThing = ThingFactory.CreateThing(ThingType.DerivedThing); 
```

# javascript - 如何在 jquery 中检测触摸屏并隐藏 div

> ID：14857320
> 
> 赞同：1
> 
> 时间：2013-02-13T15:45:12.523
> 
> 标签：javascript, jquery, html, css, detection

我将如何使用此代码：

```
function is_touch_device() {
  return !!('ontouchstart' in window) // works on most browsers 
      || !!('onmsgesturechange' in window); // works on ie10
}; 
```

检测触摸屏并隐藏一组具有相同类的 div。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T15:49:41.157

您只需调用该函数并使用基本逻辑即可。

```
if (is_touch_device()) {
  $('.yourclass').hide();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T15:50:20.220

它将像这样实现：

```
window.onload=function(){
  if (is_touch_device()){
    var divs=document.getElementsByClassName( 'yourclassname');
    for (var i=0; i<divs.length; i++)
      divs[i].style.display='none'; 
  }
}

function is_touch_device() {
  return !!('ontouchstart' in window) // works on most browsers 
      || !!('onmsgesturechange' in window); // works on ie10
}; 
```

# css - IE8 中的 CSS 空白属性

> ID：14857321
> 
> 赞同：4
> 
> 时间：2013-02-13T15:45:14.780
> 
> 标签：css, internet-explorer-8, whitespace, word-wrap

我有以下 HTML 标记（简化）

```
<div class="controlDiv" style="white-space: nowrap">
  <div class="pre"></div><input style="width: 100%"><div class="post"></div>
  <div class="validationMsg" style="white-space: normal">some message</div>
</div> 
```

内部 Div (validationMsg) 动态显示，在 FF 中，文本消息被正确包装，它不比上面的输入字段长。

但在 IE8 中空白属性被忽略，文本不会自动换行。我在 IE 开发人员工具中做了一些实验，当正确应用换行时，我已经关闭了空白属性（但输入字段前和后符号的格式失败，我们需要禁用换行）

代码看起来有点乱，但使用的框架非常严格，所以我只能在 controlDiv 中添加一个新的 div 或段落。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:21:09.753

这可能不是最好的解决方案，但 IE 的行为是将**父级的 nowrap 应用于 validationMsg 的布局**，因此无法自行设置“空白：正常”。我的解决方案是为validationMsg 提供一个包装器，其样式为“宽度：100%（或您想要应用于validationMsg div 的任何大小）；空白：正常”，因此布局对于IE 和其他浏览器来说都很好。

这是我发布的一个示例：http: [//jsbin.com/edeqam/1](http://jsbin.com/edeqam/1)

它在所有浏览器上看起来都是一致的。

# mysql - mysql中更快的更新查询

> ID：14857329
> 
> 赞同：0
> 
> 时间：2013-02-13T15:45:56.190
> 
> 标签：mysql, optimization, query-optimization

任何机构都可以建议哪个执行速度更快（考虑处理超过 200 万行的大数据）

```
UPDATE first_table ft, second_table st SET ft.Dataset=3
WHERE st.Dataset =0
AND (ft.Dataset =1 || ft.Dataset=2)
AND (ft.ID IS NULL )
AND st.First_Name = ft.First_Name
AND st.Last_Name = ft.Last_Name
AND st.Zip = ft.Zip 
```

或者

将以下内容放入两个不同的更新查询中

```
(ft.Dataset =1 || ft.Dataset=2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:54:09.700

应该没有任何区别，但你最好测试它而不是简单地猜测。

从逻辑上讲，它是相同的，但是如果它以某种方式尝试分别从两个查询中预加载所有行，那么它可能会慢很多（假设您没有内存中的行）。

# c# - useLegacyV2RuntimeActivationPolicy 是否适用于类库项目？

> ID：14857332
> 
> 赞同：1
> 
> 时间：2013-02-13T15:46:00.603
> 
> 标签：c#, sqlite, mixed-mode, fileloadexception

我的项目设置如下所示：

我的应用程序 (4.0) --> 我的类库 (4.0) --> 第三方库 (2.0.50727)

我的应用程序的 app.config 如下所示：

```
<?xml version="1.0"?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

然而，当尝试启动应用程序时，我收到了可怕的 FileLoadException：

```
Mixed mode assembly is built against version 'v2.0.50727' of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information. 
```

相应的第三方库是“System.Data.SQLite”v1.0.60.0。是否也需要为我的类库启用“useLegacyV2RuntimeActivationPolicy”属性？我该怎么做？

提前感谢您的帮助和问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T11:08:45.833

现在想通了。我没有复制生成的 .exe.config 文件和我的 .exe -.- ...完全是我的错，对此感到抱歉。

# c - 在不使用 sizeof 的情况下计算结构的大小（以字节为单位）

> ID：14857333
> 
> 赞同：2
> 
> 时间：2013-02-13T15:46:02.127
> 
> 标签：c, sizeof

我正在寻找一种方法来计算特定结构的大小而不使用`sizeof()`C中的函数。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-13T15:52:45.917

`sizeof`不是函数。它在编译时进行评估，因此不会影响程序的执行时间。使用它是正确的。

此外，停止过早优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T15:53:03.167

来自 Mats 评论：您不应该这样做，因为`sizeof()`在编译时进行评估（VLA 除外）。

# sql - 如何使用列名与 SQL 中的参数进行比较？

> ID：14857338
> 
> 赞同：1
> 
> 时间：2013-02-13T15:46:19.267
> 
> 标签：sql, sql-server-2008

我在这里试图实现的是传递一个星期几参数，该参数保存当前日期（星期三等）的值，并将其与列名进行比较以确定在 where 子句中使用哪一列.

所以在周日到周六做专栏。在 where 子句中，我想将这些列名与我传入的参数进行比较，并仅拉回匹配的值。

说下面的表称为 DayTable

```
Sunday  Monday  Tuesday Wednesday Thursday Friday Saturday
   1       1        1       1       1       1       0
   1       1        1       1       1       1       1

SELECT *
FROM   DayTable
WHERE  ColumnName = @DayOfWeek 
```

如果可能的话，这就是我想要实现的目标。我在看，`ColumnProperty`但我认为这不是我需要的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T16:00:09.643

由于您的数据未规范化，您可以使用该[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)函数将数据放入行中，以便于查询：

```
select col, value
from DayTable
unpivot
(
  value
  for col in ([Sunday], [Monday], [Tuesday], [Wednesday], 
              [Thursday], [Friday], [Saturday])
) unpiv
where col = @DayOfWeek 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/ed7d61/1)。

解决您的问题的最佳方法是将您的表格重新设计为以下内容：

```
create table DayTable
(
   DayName varchar(20),
   Value int
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T15:57:02.070

```
SELECT 
    CASE @DayOfWeek
        WHEN 'Sunday' THEN Sunday
        WHEN 'Monday' THEN Monday
        WHEN 'Tuesday' THEN Tuesday
        WHEN 'Wednesday' THEN Wednesday
        WHEN 'Thursday' THEN Thursday
        WHEN 'Friday' THEN Friday
        WHEN 'Saturday' THEN Saturday
    END AS TodaysValue
FROM
    DayTable; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T15:55:56.020

您**可以**动态构造必要的 SQL 并使用 sp_executesql 执行它。

请注意，以下内容应该没有空格，`@ sql`但我愚蠢的工作代理不会发布。

```
DECLARE @sql NVARCHAR(1000)
SET @sql = N'SELECT * FROM DayTable WHERE ' + @DayOfWeek + ' = ' + @value
sp_executesql @sql 
```

但是，我认为您发布的 SQL 也不正确。我认为您只想选择适当的*列*

```
DECLARE @sql NVARCHAR(1000)
SET @sql = N'SELECT ' + @DayOfWeek + ' FROM DayTable'
sp_executesql @sql 
```

但是，我建议您的数据库设计并不理想 - 像这样旋转该表会简单得多

```
Day     Value1     Value2
Monday     1          1
Tuesday    1          1
Wednesday  1          1
Thursday   1          1
Friday     1          1
Saturday   1          0
Sunday     1          1 
```

然后你可以简单地做

```
SELECT Value1, Value2
FROM   DayTable
WHERE  Day = 'Thursday' 
```

# python - 使用 mechanize 检索 robots.txt 时出现 HTTP 403 错误

> ID：14857342
> 
> 赞同：5
> 
> 时间：2013-02-13T15:46:28.727
> 
> 标签：python, mechanize, robots.txt, http-status-code-403

此 shell 命令成功

```
$ curl -A "Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0 (compatible;)" http://fifa-infinity.com/robots.txt 
```

并打印 robots.txt。省略 user-agent 选项会导致服务器出现 403 错误。检查 robots.txt 文件显示[http://www.fifa-infinity.com/board](http://www.fifa-infinity.com/board)下的内容允许抓取。但是，以下失败（python 代码）：

```
import logging
import mechanize
from mechanize import Browser

ua = 'Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0 (compatible;)'
br = Browser()
br.addheaders = [('User-Agent', ua)]
br.set_debug_http(True)
br.set_debug_responses(True)
logging.getLogger('mechanize').setLevel(logging.DEBUG)
br.open('http://www.fifa-infinity.com/robots.txt') 
```

我的控制台上的输出是：

```
No handlers could be found for logger "mechanize.cookies"
send: 'GET /robots.txt HTTP/1.1\r\nAccept-Encoding: identity\r\nHost: www.fifa-infinity.com\r\nConnection: close\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0 (compatible;)\r\n\r\n'
reply: 'HTTP/1.1 403 Bad Behavior\r\n'
header: Date: Wed, 13 Feb 2013 15:37:16 GMT
header: Server: Apache
header: X-Powered-By: PHP/5.2.17
header: Vary: User-Agent,Accept-Encoding
header: Connection: close
header: Transfer-Encoding: chunked
header: Content-Type: text/html
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/moshev/Projects/forumscrawler/lib/python2.7/site-packages/mechanize/_mechanize.py", line 203, in open
    return self._mech_open(url, data, timeout=timeout)
  File "/home/moshev/Projects/forumscrawler/lib/python2.7/site-packages/mechanize/_mechanize.py", line 255, in _mech_open
    raise response
mechanize._response.httperror_seek_wrapper: HTTP Error 403: Bad Behavior 
```

奇怪的是，在不设置用户代理的情况下使用 curl 会导致“403：禁止”而不是“403：不良行为”。

我是不是做错了什么，或者这是 mechanize/urllib2 中的错误？我看不出简单地获取 robots.txt 会是“不良行为”吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T16:51:48.143

经实验验证，您需要添加一个[Accept](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)标头来指定可接受的内容类型（任何类型都可以，只要“Accept”标头存在）。例如，更改后将起作用：

```
br.addheaders = [('User-Agent', ua)] 
```

至：

```
br.addheaders = [('User-Agent', ua), ('Accept', '*/*')] 
```

# ruby-on-rails - 自我参照关系 ActiveRecord

> ID：14857344
> 
> 赞同：0
> 
> 时间：2013-02-13T15:46:34.270
> 
> 标签：ruby-on-rails, rails-activerecord

为了在活动记录中建立自引用关系，我遵循了 rails-cast #163 [http://railscasts.com/episodes/163-self-referential-association](http://railscasts.com/episodes/163-self-referential-association)中显示的自引用模型，但我不喜欢这样模型，因为我必须写friendship**和**inverse_friendships，我不能只做类似的事情：

在我的人.rb

```
class Person 
  has_many :friendships
  has_many :friendships, :foreign_key => "friend_id"
  has_many :friends, :through => :friendships
  has_many :friends, :through => :friendships, :source => :person
end 
```

在我的友谊中.rb

```
class Friendship
  belongs_to :person
  belongs_to :friend, :class_name => "Person"
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:50:30.927

不，您不能有类似命名的关联，这些名称在模型中必须是唯一的。否则，ActiveRecord 将如何知道您的代码中包含的`friendships`意思`@user.friendships`？

# javascript - 在 jQuery 可调整大小的对象中查看事件值

> ID：14857346
> 
> 赞同：1
> 
> 时间：2013-02-13T15:46:38.143
> 
> 标签：javascript, jquery, object, jquery-ui, jquery-events

我使用可调整大小的 jQuery UI 插件有以下代码：

```
$this.on("resize", function(event,ui){
    console.log(event.pageX);
    console.log(event);
} 
```

我得到的输出是：

> 未定义的
> [对象对象]

如何查看事件的 X 和 Y 坐标，一般来说，我们如何在 Javascript 中查看对象的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:52:48.507

您是否在 Firefox 中使用 Firebug 来调试它？如果是这样，您可以设置断点并在对象到达断点时检查它。

# functional-programming - lisp中的析取分布属性

> ID：14857355
> 
> 赞同：1
> 
> 时间：2013-02-13T15:47:08.477
> 
> 标签：functional-programming, lisp

基本上我需要在下面将这个属性表示为 lisp 中的一个函数

(p and q) or (r and t) = (p or r) and (p or t) and (q or r) and (q or t)

函数distribute-or (fbf) 将类型的公式作为参数

`(or (and a b) c )` 并将其转化为`(and (or a c) (or b c))`

但是，问题是你不知道 or-formula 可以有多少个参数，哪些是字母，哪些是字母的连词。它可以是以下任何示例

`(or a b)`保持原样

`(or a b c (and d e f)`应该变成`(and (or a b c d) (or a b c e) (or a b c f)` `(or (and a b) (and d e))`哪个交`(and (or a d) (or a e) (or b d) (or b e))`

只有当“或”有 2 个参数时，我才能设计一个函数，但如果它有更多参数，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T17:58:45.473

所以，你已经有了一个`f`可以转换`((a b) (c d))`成的函数`((a c) (a d) (b c) (b d))`（我省略了`and`s 和`or`s）。

您需要一个可以转换`((a b) (c d) (e f))`为`((a c e) (a c f) (a d e) (a d f) (b c e) (b c f) (b d e) (b d f))`.

这似乎是[`reduce`](http://www.lispworks.com/documentation/HyperSpec/Body/f_reduce.htm):的一个明显案例`(reduce #'f mylist)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:05:13.497

由于你没有编写你的版本`distribute-or`，我建议使用这个变体，它需要任何长度的 fbf，但不能深入工作。

```
(defun dekart-product (sets)
  (if (null sets)
      (list '())
      (let ((prod (dekart-product (cdr sets))))
        (mapcan #'(lambda (lst) 
                    (mapcar #'(lambda (el) (cons el lst))
                            (car sets)))
                prod))))

(defun collect-ands (l)
  (mapcar #'(lambda (el)
              (if (and (consp el)
                       (eq 'and (car el)))
                  (cdr el)
                  (list el)))
          l))

(defun distribute-or (fbf)
  (if (and (consp fbf)
           (eq 'or (car fbf)))
      (cons 'and (mapcar #'(lambda (lst) (cons 'or lst))
                         (dekart-product
                                (collect-ands (cdr fbf)))))
      fbf)) 
```

结果是：

```
(distribute-or '(or a b c (and d e f)))
;=> (AND (OR A B C D) (OR A B C E) (OR A B C F)) 
```

它以一种简单的方式工作：

*   将所有参数和表达式收集到集合中： `(or (and a b c) (and e f) g)`-->`((a b c) (e f) (g))`
*   然后制作所有收集到的集合的 dekart-product（换句话说，[笛卡尔积）](http://en.wikipedia.org/wiki/Cartesian_product)
*   并形成输出表达式，只需添加`'or`and `'and`，其中需要

# r - 堆叠数组切片（>2 维的 rbind）

> ID：14857358
> 
> 赞同：3
> 
> 时间：2013-02-13T15:47:15.223
> 
> 标签：r

我有一系列 lapply 调用，给我留下了一个数组列表。第一个维度的数量不同，其中两个维度相同。我想将每个“行”（第一个维度）放在彼此之上，就像`rbind`对二维数组（矩阵）所做的那样。

数据如下所示：

```
la <- list( array( dim=c(1,6,7) ), array( dim=c(2,6,7) ), array( dim=c(3,6,7) ) ) 
```

我不能使用`do.call(rbind, la)`，因为它只是将其展平为矩阵。

我可以写这样的东西：

```
rbind.array <- function(..., deparse.level=1) {
   allargs <- list(...)
   n <- length(allargs)
   dims <- sapply(la,dim)
   sel.dim <- which(!apply( dims, 1, function(x) length(unique(x))==1 ))
   stopifnot(length(sel.dim)==1)
   target.length <- apply( dims, 1, sum)[sel.dim]
   target.dims <- dims[,1]
   target.dims[sel.dim] <- target.length
   res <- array( dim=target.dims )
   for( i in seq(n) ) {
      # stack array slices one by one
   }
} 
```

但是这样的功能肯定已经存在了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:53:19.983

我认为`abind`从**abind**这样做...？

```
library(abind)
abind(la[[1]],la[[2]],la[[3]],along = 1) 
```

除了`Curry`解决方案之外，这似乎也有效：

```
do.call("abind",list(la,along = 1)) 
```

# javascript - 如何叠加多个矩形

> ID：14857365
> 
> 赞同：0
> 
> 时间：2013-02-13T15:47:30.057
> 
> 标签：javascript, google-maps-api-3, maps

我有几个经纬度坐标，它指定一个区域周围的框，例如：

```
LATITUDE 26.664503840000002 29.145674380000003,LONGITUDE -96.27139215 -90.40762858 
```

我正在查看绘制[Rectangle](https://developers.google.com/maps/documentation/javascript/overlays#Rectangles)的 Google Maps 叠加层。

如果我想为不同的纬度/经度覆盖多个矩形，我应该创建新的绑定对象并将其分配给覆盖对象吗？

```
function initialize() {
  var 
  lat   = 29.145674380000003, // Should I calcuate the center or
                              // can I use of the min/max co-ordinates
  lng   = -90.40762858;
  zoom  = 4;
  // Basic
  var MapOptions = {
      zoom: zoom,
      center: new google.maps.LatLng( lat, lng ),
      disableDefaultUI: true,
      mapTypeId: google.maps.MapTypeId.TERRAIN
    }
  var map = new google.maps.Map(document.getElementById("map_canvas"),MapOptions);
  var bounds = new google.maps.LatLngBounds(
      new google.maps.LatLng( 26.664503840000002, -96.27139215 ),
      new google.maps.LatLng( 29.145674380000003, -90.40762858 )
    );
  var overlay = new google.maps.Rectangle({
      map: map,
      bounds: bounds,
      strokeColor: "red",
      strokeWeight: 1,
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T16:24:02.083

以下是如何动态添加矩形的示例：

```
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Google Maps JavaScript API v3 Example: Rectangle Simple</title>
    <link href="/maps/documentation/javascript/examples/default.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script>
      function initialize() {
        var map = new google.maps.Map(document.getElementById('map_canvas'), {
          zoom: 11,
          center: new google.maps.LatLng(33.678176, -116.242568),
          mapTypeId: google.maps.MapTypeId.TERRAIN
        });

    var myBounds = new Array();
    myBounds[0] = new google.maps.LatLngBounds(
            new google.maps.LatLng(33.671068, -116.25128),
            new google.maps.LatLng(33.685282, -116.233942));

    myBounds[1] = new google.maps.LatLngBounds(
            new google.maps.LatLng(33.671068, -116.25128),
            new google.maps.LatLng(33.687282, -116.238942));
    myBounds[2] = new google.maps.LatLngBounds(
            new google.maps.LatLng(33.671068, -116.25128),
            new google.maps.LatLng(33.688282, -116.238942));

    addRects(myBounds, map);
      }
    function addRects(bounds, map){
    for (var i=0; i<bounds.length; ++i) {
      var overlay = new google.maps.Rectangle({
          map: map,
          bounds: bounds[i],
          strokeColor: "red",
          strokeWeight: 1,
        });
    }
    }

      google.maps.event.addDomListener(window, 'load', initialize);

    </script>

<style>
#map_canvas {
    width: 600px;
    height: 400px;
}
</style>
  </head>

  <body>
    <div id="map_canvas"></div>
  </body>

</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:57:28.047

如果您查看[链接样本](https://google-developers.appspot.com/maps/documentation/javascript/examples/rectangle-simple)的来源，它实际上提供了一个界限。

```
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Google Maps JavaScript API v3 Example: Rectangle Simple</title>
    <link href="/maps/documentation/javascript/examples/default.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script>
      function initialize() {
        var map = new google.maps.Map(document.getElementById('map_canvas'), {
          zoom: 11,
          center: new google.maps.LatLng(33.678176, -116.242568),
          mapTypeId: google.maps.MapTypeId.TERRAIN
        });

        var rectangle = new google.maps.Rectangle({
          strokeColor: '#FF0000',
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: '#FF0000',
          fillOpacity: 0.35,
          map: map,
          bounds: new google.maps.LatLngBounds(
            new google.maps.LatLng(33.671068, -116.25128),
            new google.maps.LatLng(33.685282, -116.233942))
        });
      }

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div id="map_canvas"></div>
  </body>
</html> 
```

[使用您的坐标的工作示例](http://www.geocodezip.com/v3_GoogleEx_rectangle-simpleA.html)

# fortran - 在 Fortran 中使用多级分配的锯齿状数组是否有任何问题？

> ID：14857366
> 
> 赞同：5
> 
> 时间：2013-02-13T15:47:31.310
> 
> 标签：fortran, allocation, jagged-arrays

在我的 Fortran 代码中，我想使用具有多级分配的锯齿状数组。我的意思的示例代码是

```
module nonsquare_matrix_mod
implicit none

   type :: nonsquare_matrix 
      integer :: d
      real*8, dimension(:), allocatable :: vector
   end type nonsquare_matrix

   type(nonsquare_matrix),dimension(:),allocatable :: mymatrix

end module nonsquare_matrix_mod

program nonsquare_matrix_test
   use nonsquare_matrix_mod
   implicit none

integer, parameter :: max_size=50
integer :: i

allocate(mymatrix(max_size))
do i=1,max_size
    allocate(mymatrix(i) % vector(i))
end do

print *, "allocated"

end program 
```

我想实现这种编程策略以节省内存。我知道这个例子中节省的内存不是太大，但是对于我的实际项目，我正在使用更大的数据结构。我想知道这种编程实践是否存在任何危险，例如数据没有连续存储或者更容易出现内存泄漏。或者这是一种节省内存而没有很多缺点的有用方法？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T19:27:52.440

由于您仅使用可分配数组，因此不会有任何内存泄漏，因为使用指针时可能会出现这种情况。锯齿状数组是否是您问题的合理解决方案在很大程度上取决于您的数据结构。需要注意的几点：

*   实际上，您的数组不会是连续的。当您访问后续行时，这有几个含义，例如更糟糕的缓存行为。

*   您必须通过`allocate`单独分配每一行。如果它经常发生（例如在循环内），那可能是一个问题，因为分配是一个相当“缓慢”的操作。

*   如果数组中的行的大小确实非常不同（并且您没有太多行），则可以节省大量内存。

如果行的长度是在创建时设置的并且之后没有更改（并且您可以很好地猜测整个数组中最多有多少元素），您可以分配一个大的缓冲区数组，您将在行中，以及一个索引数组，其中包含该行的第一个元素在缓冲区数组中的位置：

```
 program nonsquare_matrix_test
  implicit none

  integer, parameter :: dp = kind(1.0d0)
  integer, parameter :: maxlines = 50
  integer, parameter :: maxelements = 5000
  real(dp), allocatable :: buffer(:)
  integer, allocatable :: rowindex(:)
  integer :: ii

  allocate(buffer(maxelements))
  allocate(rowindex(maxlines + 1))
  rowindex(1) = 1
  do ii = 1, maxlines
    rowindex(ii + 1)  = rowindex(ii) + ii
  end do
  ! ...  
  ! Omitting the part which fills up the array
  ! ...
  ! Accessing a given line (e.g. line 5)
  print *, "Content of line 5:"
  print *, buffer(rowindex(5):rowindex(6)-1)

end program nonsquare_matrix_test 
```

# grails - vaadin 为所采取的每个操作发送一个发布请求

> ID：14857367
> 
> 赞同：1
> 
> 时间：2013-02-13T15:47:34.693
> 
> 标签：grails, vaadin, grails-plugin

我正在评估 Grails 的 Vaadin 插件，其中一个问题是性能。

我开发了一个简单的应用程序，它有一个树集，每次我点击一个表单填写的项目时，这些字段都是手动编辑的，当我按下保存按钮时，更改会保持不变。尽管我对实现此类应用程序的速度印象深刻，但我担心未来实际应用程序的性能。特别是我可以看到，对于我采取的每一个动作（点击一个项目，折叠树等）都会发送一个帖子：

[http://myhost.org/fooWithVaadin/UIDL/?v-uiId=0](http://myhost.org/fooWithVaadin/UIDL/?v-uiId=0)

有没有办法避免这种情况？我尝试将 setImmediate(false) 应用于每个组件，但没有看到任何变化。[Snappy](https://vaadin.com/directory#addon/snappy)是正确的方法吗？

理想情况下，我想要实现的是在客户端站点上运行一个完整的模型，并在绝对必要时（例如，检索加载应用程序时不可用的信息）或“保存”时与服务器进行通信按钮被按下。这是现实的吗？

感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T16:21:32.183

这是 Vaadin 的负面影响，你无法完全控制事情。我们也放弃了 Vaadin，转而使用纯 GWT。[http://www.outsourced.sk/1872/building-scalable-cloud-app-using-gwt-jboss-mongodb-on-openshift-part-2-vaadin/](http://www.outsourced.sk/1872/building-scalable-cloud-app-using-gwt-jboss-mongodb-on-openshift-part-2-vaadin/)

# jquery - 用 jQuery 切换 CSS 高度？

> ID：14857368
> 
> 赞同：0
> 
> 时间：2013-02-13T15:47:36.593
> 
> 标签：jquery, css

我正在尝试使用 jQuery 在单击 div 时切换它的高度。这是我正在尝试的：

```
$("#otherBox").click(function() {
    if($(this).css("height") == "200") {
        $(this).css("height", "300")
    }
    else {
        $(this).css("height", "200")
    }
}) 
```

我正在尝试这样做，如果高度为 200，则设置为 300，反之亦然。为什么这不起作用？

另外，如果有办法让它在高度之间平滑移动（如`slideToggle`），那会很方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:51:34.070

使用 parseInt，因为你得到“200px”而不是 200，你需要用 jQuery 包装它

```
if(parseInt($(this).css('height')) ==200) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:54:41.977

试试这个：

```
$("#otherBox").click(function() {
    if($(this).height() == 200)
        $(this).height(300);
    else
        $(this).height(200);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T15:56:01.300

我看到很多这样的问题。我的答案总是`$.toggle()`jQuery 中容易被忽视的函数。

```
$("#otherBox").toggle(
    function() {
        $(this).css({height: 300});
    },
    function() {
        $(this).css({height: 200});
    },
); 
```

此代码运行单击时指定的函数，在两个函数之间交替运行。

（该函数在文档中很容易被忽略，因为它是更标准使用的很少使用的重载`$.toggle()`。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T15:48:53.120

```
$(this).css({"height":"300px"}); 
```

[看演示](http://jsfiddle.net/Dineshkani/TFjAY/)

# c# - 显示查询结果

> ID：14857369
> 
> 赞同：0
> 
> 时间：2013-02-13T15:47:44.553
> 
> 标签：c#, winforms, datagridview

我正在尝试以`datagridview`Windows 形式显示数据。

我有以下代码从数据库中获取数据。

```
 public DataSet GetUser(string custName)
    {
        string connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\Amrit\\Desktop\\Database.accdb ;Persist Security Info=False;";
        DataSet dataSet = new DataSet();
        OleDbConnection oleConn = new OleDbConnection(connString);

        try
        {
            oleConn.Open();
            string sql = "SELECT * FROM [Customer] WHERE [Customer's Ebayname]=" + custName;
            OleDbDataAdapter dataAdapter = new OleDbDataAdapter(sql, oleConn);
            dataAdapter.Fill(dataSet, "Customer");
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.ToString());
        }
        finally
        {
            oleConn.Close();
        }
        if (dataSet.Tables.Count <= 0)
            return null;
        else
            return dataSet;
    } 
```

上面我在 windows 窗体中传递`custName`了的值。`textBox`这将显示包含该名称的所有行。

在这里，我如何尝试显示数据。

```
 private void button1_Click(object sender, EventArgs e)
    {
        DataSet ds = GetUser(textBox1.Text);
        dataGridView1.DataSource = ds;
    } 
```

有人可以指出我错在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:55:03.113

首先，您需要检查您的数据集是否包含您命令的任何结果。然后不要以这种方式使用字符串连接来构建命令，而是始终参数化查询。这将允许避免[Sql 注入](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)和字符串、日期和数字小数的解析问题。

您是否尝试过当您的 custName 变量包含单引号时会发生什么？

```
....
using(OleDbConnection oleConn = new OleDbConnection(connString))
{
    try
    {
        oleConn.Open();
        string sql = "SELECT * FROM [Customer] WHERE [Customer's Ebayname]=@cust";
        OleDbCommand cmd = new OleDbCommand(sql, oleConn);
        cmd.Parameters.AddWithValue("@cust", custName);
        OleDbDataAdapter dataAdapter = new OleDbDataAdapter(cmd);
        dataAdapter.Fill(dataSet, "Customer");
    }
}
.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:52:16.023

绑定你`DataGirdView`的`DataTable`返回。

```
private void button1_Click(object sender, EventArgs e)
{
    DataSet ds = GetUser(textBox1.Text);
    if (ds == null)
    {
         return;
    }
    dataGridView1.DataSource = ds.Tables["Customer"];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:58:40.553

如何将函数返回为`DataTable`？

```
public DataTable GetUser(string custName)
{
   //..codes
   return dataSet.Tables["Customer"];
} 
```

我怀疑这是你的问题

```
string sql = "SELECT * FROM [Customer] WHERE [Customer's Ebayname]=" + custName; 
```

注意那个`custName`是`DataType`和`Text`你的`Where clause`东西不对所以它应该像

```
string sql = "SELECT * FROM [Customer] WHERE Ebayname = '" + custName + "'"; 
```

***PS**：别忘了听从史蒂夫先生的建议*

# c# - 返回类型为 HttpResponseMessage 时，Web Api Get() 路由不起作用

> ID：14857370
> 
> 赞同：2
> 
> 时间：2013-02-13T15:47:44.857
> 
> 标签：c#, asp.net-mvc, asp.net-web-api, asp.net-mvc-routing

这让我有点头疼。最终，我试图返回一个图像，但我一直在尝试并将其简化为使用字符串。

我想要什么：转到网址：

```
http://xxx/api/helloworld/1 
```

回应：“你好，世界！”

以下 web api 声明适用于提供的 url；

```
public string Get([FromUri]int id) { return "Hello World"; }
public Task<string> Get([FromUri]int id) { return "Hello World"; } 
```

什么不起作用；

```
public HttpResponseMessage Get([FromUri]int id) 
{ 
    return Request.CreateResponse<string>(HttpStatusCode.OK, "Hello World");
}

public HttpResponseMessage Get([FromUri]int id)
{
    HttpResponseMessage response = new HttpResponseMessage();

    string text = "Hello World";
    MemoryStream test = new MemoryStream();
    test.Write(ConversionUtilities.ToBytes(text) /*custom string->byte[] method, UTF-8 encoding*/, 0, text.Length);

    response.Content = new StreamContent(test);
    response.Content.Headers.ContentType = new MediaTypeHeaderValue("text/plain");
    response.StatusCode = HttpStatusCode.OK;

    return response;
} 
```

当我有一个返回类型为 HttpResponseMessage 的 Get() 时会发生什么是返回以下错误；

```
No HTTP resource was found that matches the request URI "http://xxx/api/helloworld/1" 
```

此错误仅针对此特定返回类型出现。现在，我在 WebApiConfig.cs 文件中的路由如下（适用于“字符串”返回类型）；

```
// Controller with ID
// To handle routes like "/api/VTRouting/1"
config.Routes.MapHttpRoute(
    name: "ControllerAndId",
    routeTemplate: "api/{controller}/{id}",
    defaults: null,
    constraints: new { id = @"^\d+$" } // Only integers 
);

// Controllers with Actions
// To handle routes like "/api/VTRouting/route"
config.Routes.MapHttpRoute(
    name: "ControllerAndAction",
    routeTemplate: "api/{controller}/{action}"
);

// Controller Only
// To handle routes like "/api/VTRouting"
config.Routes.MapHttpRoute(
    name: "ControllerOnly",
    routeTemplate: "api/{controller}"
); 
```

有什么想法吗？我对返回类型行为感到困惑：-S

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T10:08:46.487

找到原因了！我根据有效的模板创建了一个空白的 api 控制器。提示一些复制/粘贴以缩小原因。这是微妙的，我发布的代码有效，因为我更改了公开发布的变量名——这最终是问题的原因。去搞清楚。

要复制，请照常创建模板。这将创建一个方法；

```
public string Get(int id) 
```

将其更改为；

```
public string Get(int personID) 
```

并尝试运行。您将收到上述错误。似乎 Get/Post/etc 参数的声明必须与路由中指定的相匹配。如果您像我一样将参数更改为“personID”，您可以通过将参数重命名回默认的“id”或使用更新名称修改路由来修复；

```
config.Routes.MapHttpRoute(
    name: "ControllerAndId",
    routeTemplate: "api/{controller}/{personID}",
    defaults: null,
    constraints: new { personID = @"^\d+$" } // Only integers 
); 
```

请注意 routeTemplate 和约束参数中的“{personID}”。此字段的名称必须与您的参数名称匹配。在查找如何下载文件或只是一般地查看 web api 时，它实际上从未在文档中说明这一点。在深入了解路由/mvc 的详细信息时可能会这样做，但我不得不说这很容易让一个不熟悉的 n00b 绊倒。请注意，我更有经验的同事也没有发现这一点:-)。我希望这可以帮助其他有同样痛苦的人！

# performance - 如何将多个重复的参数传递给 CUDA 内核

> ID：14857371
> 
> 赞同：-1
> 
> 时间：2013-02-13T15:47:46.660
> 
> 标签：performance, cuda, gpu, gpgpu

我正在寻找一种优雅的方式来在 CUDA 内核中传递多个重复的参数，

众所周知，每个内核参数都位于每个 CUDA 线程的堆栈上，因此，内核传递给每个线程的参数之间可能存在重复，即位于每个堆栈上的内存。

为了尽量减少传递的重复参数的数量，我正在寻找一种优雅的方式。

为了解释我的担忧：假设我的代码如下所示：

```
 kernelFunction<<<gridSize,blockSize>>>(UINT imageWidth, UINT imageWidth, UINT imageStride, UINT numberOfElements,x,y,ect...) 
```

UINT imageWidth、UINT imageWidth、UINT imageStride、UINT numberOfElements 参数位于每个线程 stock ，

我正在寻找一种技巧来发送更少的参数并从其他来源访问数据。

我正在考虑使用常量内存，但由于常量内存位于 global 上，所以我放弃了它。不用说内存位置应该很快。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T15:53:52.150

内核参数通过常量内存（或 sm_1x 中的共享内存）传入，因此没有您建议的复制。

参见[编程指南](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#functions)：

> __global__ 函数参数传递给设备：
> 
> *   通过共享内存，在计算能力为 1.x 的设备上限制为 256 字节，
> *   通过恒定内存，在计算能力 2.x 及更高版本的设备上限制为 4 KB。

当然，如果您随后修改代码中的一个变量，那么您正在修改本地副本（根据 C 标准），因此每个线程都将拥有自己的副本，或者在寄存器中，或者如果需要，在堆栈中。

# javascript - 页面加载后如何使用javascript检查和修改两个DIV的高度？

> ID：14857374
> 
> 赞同：0
> 
> 时间：2013-02-13T15:47:50.020
> 
> 标签：javascript

我有以下 HTML：

```
<div>
    <div id="a" class="grid_6" style="background-color: #ff00ff">
        <div class="block-border">
            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.
        </div>
    </div>
    <div id="b" class="grid_6" style="background-color: #ffff00">
        <div class="block-border">
            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.
        </div>
    </div>
</div> 
```

和 CSS：

```
.grid_6 {
    width: 200px;
    display:inline;
    float: left;
    margin-left: 0.99%;
    margin-right: 0.99%;
} 
```

页面加载到以下位置后如何使用 javascript：

*   获取 id 为“a”和“b”的 DIV 的高度
*   将较小的高度设置为较大的高度

这是一个[示例小提琴](http://jsfiddle.net/2QUaC/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:54:02.713

以下是如何在没有任何 jQuery 的纯 javascript 中做到这一点

```
<script type="text/javascript">
    window.document.onload = function(e){
        var aheight = document.getElementById("a").offsetHeight;
        var bheight = document.getElementById("b").offsetHeight;
        if(aheight > bheight) {
            document.getElementById("b").offsetHeight = aheight;
        }else {
            document.getElementById("a").offsetHeight = bheight;
         }
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:56:51.677

使用 jQuery，您可以将此代码放在脚本标签中：

```
$(function() {
    var divAHeight = $("#a").height();
    var divBHeight = $("#b").height();

    if (divAHeight > divBHeight)
        $("#b").height(divAHeight);
    else
        $("#a").height(divBHeight);
}); 
```

`$(function() { ... }`用于在页面加载后延迟内容的执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:57:21.467

```
<script type=text/javascript>
  window.document.onload = function () {
    var divA = document.getElementById('a');
    var divB = document.getElementById('b');

    if (divA.offsetHeight > divB.offsetHeight) {
      divA.offsetHeight = divB.offsetHeight;
    } else {
      divB.offsetHeight = divA.offsetHeight;
    }
  }
</script> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-13T15:53:27.860

我不知道如何用纯 javascript 来做，但这是一个如何用 jQuery 做的例子。

```
var heighta = $('#a').height();
var heightb= $('#b').height();
if(heighta>heightb)
{
   $('#b').height(heighta);
}
else
{   
    $('#a').height(heightb);
} 
```

# c++ - C++ 中的 Extern (VS2012) 找到多个定义的符号

> ID：14857380
> 
> 赞同：0
> 
> 时间：2013-02-13T15:47:54.993
> 
> 标签：c++

我的代码在这里：

Header.h 文件：

```
#ifndef HEADER_H_
#define HEADER_H_

extern int k;

#endif /* HEADER_H_ */ 
```

Source1.h 文件：

```
#include <iostream>
#include "Header.h"
using namespace std;

#ifndef SOURCE1_H_
#define SOURCE1_H_

int k = 10;

void punch(){
    cout << k << endl;
}

#endif /*SOURCE1_H_*/ 
```

源.cpp 文件：

```
#include "Source1.h"
using namespace std;

int main()
{
punch();
cin.get();
return 0;
}; 
```

我正在 Windows 7 中的 Visual Studio 2012 express edition 上编译。错误代码是：

```
1>c:\users\freeman\documents\visual studio 2012\Projects\exploringexterns\Debug\exploringexterns.exe : fatal error LNK1169: one or more multiply defined symbols found 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:49:49.130

您需要将定义移动到一个且只有一个源文件。

```
int k = 10; 
```

通过在头文件中定义变量，您违反了一个定义规则，因为在包含头文件的每个翻译单元中都定义了变量的副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:57:50.693

我完全按照您的方式构建了这段代码，没有任何错误……还有更多吗？

如果您有另一个包含“Source1.h”的源文件，您可能会遇到以下行的问题：

`int k = 10;`在 Source1.h

因为那时 k 将被多重定义。我会将其`int k=10`移至 Source.cpp

# android - 使用 javamail 连接到 SMTP 时出错

> ID：14857383
> 
> 赞同：3
> 
> 时间：2013-02-13T15:47:58.050
> 
> 标签：android, jakarta-mail

这是我用来发送电子邮件的代码

```
import java.util.Date;
import java.util.Properties;
import javax.activation.CommandMap;
import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.activation.MailcapCommandMap;
import javax.mail.Authenticator;
import javax.mail.BodyPart;
import javax.mail.Multipart;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

public class Mail extends Authenticator {
    private String _user;
    private String _pass;

    private String[] _to;
    private String _from;

    private String _port;
    private String _sport;

    private String _host;

    private String _subject;
    private String _body;

    private boolean _auth;

    private boolean _debuggable;

    private Multipart _multipart;

    public String[] get_to() {
        return _to;
    }

    public void set_to(String[] _to) {
        this._to = _to;
    }

    public String get_from() {
        return _from;
    }

    public void set_from(String _from) {
        this._from = _from;
    }

    public String get_subject() {
        return _subject;
    }

    public void set_subject(String _subject) {
        this._subject = _subject;
    }

    public Mail() {                 
        _host = "mail.messagingengine.com";    
    _port = "587";  
        _sport = "587"; 
        _user = ""; // username
        _pass = ""; // password
        _from = ""; // email sent from
        _subject = ""; // email subject
        _body = ""; // email body

        _debuggable = false; // debug mode on or off - default off
        _auth = true; // smtp authentication - default on

        _multipart = new MimeMultipart();

        // There is something wrong with MailCap, javamail can not find a
        // handler for the multipart/mixed part, so this bit needs to be added.
        MailcapCommandMap mc = (MailcapCommandMap) CommandMap.getDefaultCommandMap();
        mc.addMailcap("text/html;; x-java-content-handler=com.sun.mail.handlers.text_html");
        mc.addMailcap("text/xml;; x-java-content-handler=com.sun.mail.handlers.text_xml");
        mc.addMailcap("text/plain;; x-java-content-handler=com.sun.mail.handlers.text_plain");
        mc.addMailcap("multipart/*;; x-java-content-handler=com.sun.mail.handlers.multipart_mixed");
        mc.addMailcap("message/rfc822;; x-java-content-handler=com.sun.mail.handlers.message_rfc822");
        CommandMap.setDefaultCommandMap(mc);
    }

    public Mail(String user, String pass) {
        this();

        _user = user;
        _pass = pass;
    }

    public boolean send() throws Exception {
        Properties props = _setProperties();

        if (!_user.equals("") && !_pass.equals("") && _to.length > 0 && !_from.equals("") && !_subject.equals("")
                && !_body.equals("")) {
            Session session = Session.getInstance(props, this);

            MimeMessage msg = new MimeMessage(session);

            msg.setFrom(new InternetAddress(_from));

            InternetAddress[] addressTo = new InternetAddress[_to.length];
            for (int i = 0; i < _to.length; i++) {
                addressTo[i] = new InternetAddress(_to[i]);
            }
            msg.setRecipients(MimeMessage.RecipientType.TO, addressTo);

            msg.setSubject(_subject);
            msg.setSentDate(new Date());

            // setup message body
            BodyPart messageBodyPart = new MimeBodyPart();
            messageBodyPart.setText(_body);
            _multipart.addBodyPart(messageBodyPart);

            // Put parts in message
            msg.setContent(_multipart);

            Transport.send(msg);

            return true;
        } else {
            return false;
        }
    }

    public void addAttachment(String filename) throws Exception {
        BodyPart messageBodyPart = new MimeBodyPart();
        DataSource source = new FileDataSource(filename);
        messageBodyPart.setDataHandler(new DataHandler(source));
        messageBodyPart.setFileName(filename);

        _multipart.addBodyPart(messageBodyPart);
    }

    @Override
    public PasswordAuthentication getPasswordAuthentication() {
        return new PasswordAuthentication(_user, _pass);
    }

    private Properties _setProperties() {
        Properties props = new Properties();

        props.put("mail.messagingengine.com", _host);
        // mail.messagingengine.com

        if (_debuggable) {
            props.put("mail.debug", "true");
        }

        if (_auth) {
            props.put("mail.smtp.auth", "true");
        }

        props.put("mail.smtp.port", _port);

        props.put("mail.smtp.socketFactory.port", _sport);
        props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
        props.put("mail.smtp.socketFactory.fallback", "false");

        return props;
    }

    // the getters and setters
    public String getBody() {
        return _body;
    }

    public void setBody(String _body) {
        this._body = _body;
    }

    // more of the getters and setters …..
} 
```

此错误出现在命令 transport.send(msg) 之后；

```
javax.mail.MessagingException: Could not connect to SMTP host: mail.messagingengine.com, port: 587;
  nested exception is:
    javax.net.ssl.SSLHandshakeException: javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x1f81518: Failure in SSL library, usually a protocol error
error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol (external/openssl/ssl/s23_clnt.c:683 0x4025bc93:0x00000000) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:19:38.417

您可能需要 SSL 专家来找出问题所在，但 JavaMail [SSLNOTES](http://www.oracle.com/technetwork/java/javamail/javamail146sslnotes-1904573.html)文件有指向调试 SSL 问题的提示的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T15:09:11.377

以下代码对我有用

```
public class Mail extends javax.mail.Authenticator { 
  private String _user; 
  private String _pass; 

  private String[] _to; 
  public String[] get_to() {
    return _to;
}

public void set_to(String[] _to) {
    this._to = _to;
}

public String get_from() {
    return _from;
}

public void set_from(String _from) {
    this._from = _from;
}

public String get_subject() {
    return _subject;
}

public void set_subject(String _subject) {
    this._subject = _subject;
}

private String _from; 

  private String _port; 
  private String _sport; 

  private String _host; 

  private String _subject; 
  private String _body; 

  private boolean _auth; 

  private boolean _debuggable; 

  private Multipart _multipart; 

  public Mail() { 
    _host = "mail.messagingengine.com"; // default smtp server 
    _port = "465"; // default smtp port 
    _sport = "465"; // default socketfactory port 

    _user = ""; // username 
    _pass = ""; // password 
    _from = ""; // email sent from 
    _subject = ""; // email subject 
    _body = ""; // email body 

    _debuggable = false; // debug mode on or off - default off 
    _auth = true; // smtp authentication - default on 

    _multipart = new MimeMultipart(); 

    // There is something wrong with MailCap, javamail can not find a handler for the multipart/mixed part, so this bit needs to be added. 
    MailcapCommandMap mc = (MailcapCommandMap) CommandMap.getDefaultCommandMap(); 
    mc.addMailcap("text/html;; x-java-content-handler=com.sun.mail.handlers.text_html"); 
    mc.addMailcap("text/xml;; x-java-content-handler=com.sun.mail.handlers.text_xml"); 
    mc.addMailcap("text/plain;; x-java-content-handler=com.sun.mail.handlers.text_plain"); 
    mc.addMailcap("multipart/*;; x-java-content-handler=com.sun.mail.handlers.multipart_mixed"); 
    mc.addMailcap("message/rfc822;; x-java-content-handler=com.sun.mail.handlers.message_rfc822"); 
    CommandMap.setDefaultCommandMap(mc); 
  } 

  public Mail(String user, String pass) { 
    this(); 

    _user = user; 
    _pass = pass; 
  } 

  public boolean send() throws Exception { 
    Properties props = _setProperties(); 

    if(!_user.equals("") && !_pass.equals("") && _to.length > 0 && !_from.equals("") && !_subject.equals("") && !_body.equals("")) { 
      Session session = Session.getInstance(props, this); 

      MimeMessage msg = new MimeMessage(session); 

      msg.setFrom(new InternetAddress(_from)); 

      InternetAddress[] addressTo = new InternetAddress[_to.length]; 
      for (int i = 0; i < _to.length; i++) { 
        addressTo[i] = new InternetAddress(_to[i]); 
      } 
        msg.setRecipients(MimeMessage.RecipientType.TO, addressTo); 

      msg.setSubject(_subject); 
      msg.setSentDate(new Date()); 

      // setup message body 
      BodyPart messageBodyPart = new MimeBodyPart(); 
      messageBodyPart.setText(_body); 
      _multipart.addBodyPart(messageBodyPart); 

      // Put parts in message 
      msg.setContent(_multipart); 

      // send email 
      Transport.send(msg); 

      return true; 
    } else { 
      return false; 
    } 
  } 

  public void addAttachment(String filename) throws Exception { 
    BodyPart messageBodyPart = new MimeBodyPart(); 
    DataSource source = new FileDataSource(filename); 
    messageBodyPart.setDataHandler(new DataHandler(source)); 
    messageBodyPart.setFileName(filename); 

    _multipart.addBodyPart(messageBodyPart); 
  } 

  @Override 
  public PasswordAuthentication getPasswordAuthentication() { 
    return new PasswordAuthentication(_user, _pass); 
  } 

  private Properties _setProperties() { 
    Properties props = new Properties(); 

    props.put("mail.smtp.host", _host); 

    if(_debuggable) { 
      props.put("mail.debug", "true"); 
    } 

    if(_auth) { 
      props.put("mail.smtp.auth", "true"); 
    } 

    props.put("mail.smtp.port", _port); 
    props.put("mail.smtp.socketFactory.port", _sport); 
    props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory"); 
    props.put("mail.smtp.socketFactory.fallback", "false"); 

    return props; 
  } 

  // the getters and setters 
  public String getBody() { 
    return _body; 
  } 

  public void setBody(String _body) { 
    this._body = _body; 
  } 

  // more of the getters and setters ….. 
} 
```

我认为错误在于

```
_port = "465"; // default smtp port 
 _sport = "465"; // default socketfactory port 
```

这条线

```
 props.put("mail.messagingengine.com", _host); 
```

看到[这个](https://www.fastmail.fm/help/remote_email_access_server_names_and_ports.html)

# java - java.lang.ClassCastException - 将 WAR 部署到 GlassFish 3.1.2。- 无效的 JNDI 查找，可能吗？

> ID：14857386
> 
> 赞同：1
> 
> 时间：2013-02-13T15:48:14.437
> 
> 标签：java, eclipse, jakarta-ee, ejb-3.0, jndi

我正在尝试通过 *NIX 上的 Eclipse EE 将 WAR 文件的标准部署过程破译到 Oracle GlassFish 3.1.2。我正在获取`java.lang.ClassCastException`JNDI 查找字符串（据我所知）。有什么建议么？

JNDI 查找字符串：`Object objref = ctx.lookup("java:comp/env/");`

SE 上的一些帖子提倡使用：`ctx.lookup("java:comp/env/ejb/<mapped name>")` So: Object objref = ctx.lookup("java:comp/env/Exchange");`

*   “ejb”是什么意思？它是一个内部的、Java 特定的标识符，还是一个用户区目录？

导航到`http://localhost:8080/Exchange/`抛出错误：

```
java.lang.ClassCastException: com.sun.enterprise.naming.impl.JavaURLContext cannot be cast to org.omg.CORBA.Object 
```

**堆栈跟踪**

```
[#|2013-02-13T10:26:01.507-0500|WARNING|oracle-glassfish3.1.2|javax.enterprise.system.container.web.com.sun.enterprise.web|_ThreadID=73;_ThreadName=Thread-2;|StandardWrapperValve[jsp]: PWC1406: Servlet.service() for servlet jsp threw exception
java.lang.ClassCastException: com.sun.enterprise.naming.impl.JavaURLContext cannot be cast to org.omg.CORBA.Object
    at com.sun.corba.ee.impl.javax.rmi.PortableRemoteObject.narrow(PortableRemoteObject.java:245)
    at javax.rmi.PortableRemoteObject.narrow(PortableRemoteObject.java:153)
    at org.apache.jsp.ExchangeClient_jsp._jspService(ExchangeClient_jsp.java:87)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:111)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:411)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:473)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:377)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
|#] 
```

ejb-jar.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar>
  <enterprise-beans>
    <session>
      <ejb-name>Exchange</ejb-name>
      <home>ejb.ExchangeHome</home>
      <remote>ejb.ExchangeObject</remote>
      <ejb-class>ejb.ExchangeBean</ejb-class>
      <session-type>Stateless</session-type>
      <transaction-type>Container</transaction-type>
    </session>
  </enterprise-beans>
  <assembly-descriptor>
    <container-transaction>
      <method>
        <ejb-name>Exchange</ejb-name>
        <method-name>*</method-name>
      </method>
      <trans-attribute>Required</trans-attribute>
    </container-transaction>
  </assembly-descriptor>
</ejb-jar> 
```

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
  <display-name>Exchange</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>ExchangeClient.jsp</welcome-file>
  </welcome-file-list>  
</web-app> 
```

**ExchangeClient.jsp**

```
<%@page import="ejb.*" %>
<%@page import="javax.naming.InitialContext"%>
<%@page import="javax.naming.Context"%>
<%@page import="javax.rmi.PortableRemoteObject" %>

<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Currency Converter</title>
        <link rel="stylesheet" href="master.css" />
    </head>
    <body>
        <h1>WAR</h1>

        <section id="user_input">
            <form action="ExchangeClient.jsp" method="POST">
                <label>Amount</label>   <input type="text" name="initial_amount" size="16" placeholder="0.00" pattern="^([.0-9])" required/><BR>
                <label>From</label> <input type="text" name="base_trigram" size="16" placeholder="CAD" pattern="^([A-Z])" required/>
                <label>To</label>   <input type="text" name="destination_trigram" size="16" placeholder="USD" pattern="^([A-Z])" required/>

                <button id="submit" type="submit">Submit</button>   
                <button id="reset" type="reset">Clear</button>   
            </form>
        </section>

        <section id="result">
            <%!ExchangeObject exchange; %>
            <%
            String amount = request.getParameter("initial_amount");
            String from = request.getParameter("base_trigram");
            String to = request.getParameter("destination_trigram");

            Context ctx = new InitialContext(); 
            Object objref = ctx.lookup("java:comp/env/");
            ExchangeHome home = (ExchangeHome)PortableRemoteObject.narrow(objref, ExchangeHome.class);

            ExchangeObject exchange = home.create();
            out.println(exchange.convert(amount, from, to));
            out.println(exchange.getExchangeRate());
            out.println(exchange.getExchangeRateTimestamp());
            %>
        </section>
    </body>
</html>

foo@Machine ~/workspace $ tree Exchange
Exchange
├── build
│   └── classes
│       └── ejb
│           ├── ExchangeBean.class
│           ├── ExchangeHome.class
│           └── ExchangeObject.class
├── src
│   └── ejb
│       ├── ExchangeBean.java
│       ├── ExchangeHome.java
│       └── ExchangeObject.java
└── WebContent
    ├── ExchangeClient.jsp
    ├── META-INF
    │   └── MANIFEST.MF
    └── WEB-INF
        ├── lib
        │   └── ejb-jar.xml
        └── web.xml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T12:39:37.870

嗨，在您的 EJB 服务器中，您拥有我们所说的 JNDI 服务器。

JNDI 服务器是一个目录。这意味着当您部署 EJB 时，部署者会在 JNDI 树中创建一个条目来引用您的新 EJB（例如 ejb/MyEjb）。

因此，要使用您的 MyEJB，您需要使用其名称“ejb/MyEjb”查找实现：

```
ctx.lookup("java:comp/env/ejb/ejb/MyEjb") 
```

尝试使用

```
ctx.lookup("java:comp/env/ejb/Exchange"); 
```

如果它不起作用，请尝试浏览您的服务器 jndi 树并替换为 Exchange 的正确路径

有关详细信息，请参阅[http://docs.oracle.com/javase/tutorial/jndi/concepts/index.html](http://docs.oracle.com/javase/tutorial/jndi/concepts/index.html)

问候，

# javascript - JavaScript 参数的继承

> ID：14857389
> 
> 赞同：0
> 
> 时间：2013-02-13T15:48:21.147
> 
> 标签：javascript

我正在尝试在 JavaScript 中做一些继承

ETC

```
var operation = 
{
   A: 1,
   B: 2,
   C: 3
};

var operationImplA = 
{
   D: 4
};

var operationImplB = 
{
   D: function (event) {
         //do something
      }
}; 
```

类似于上面的东西，但不确定如何在 JavaScript 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:50:36.150

您可以简单地使用`Object.create`：

```
var operation = 
{
   A: 1,
   B: 2,
   C: 3
};

var operationImplA = Object.create(operation, {
    D: {
       value: 4
    }
});

var operationImplB = Object.create(operationImplA, {
    D: {
        value: 5
    }
}); 
```

`Object.create`将使用原型创建新对象，它的第一个参数和第二个参数中定义的属性。

这是 JavaScript 中基于原型的自然继承。

**编辑**

如果要添加方法，请将其添加为属性，即：

```
var operationImplA = Object.create(operation, {
    M: {
        value: function (a) {
            console.log(a);
        }
    }
});
operationImplA.M('Some text...'); //'Some text...' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T15:51:08.917

我个人非常喜欢 John Resigs [Simple JavaScript Inheritance](http://ejohn.org/blog/simple-javascript-inheritance/)。我将它用于我所有的 JS 项目。你应该试试看。

# r - 使用 daply 进行频率计数时，R 中的“dims [product 0] 与对象的长度不匹配”错误

> ID：14857393
> 
> 赞同：3
> 
> 时间：2013-02-13T15:48:33.587
> 
> 标签：r, dataframe, plyr, frequency

我有一个如下所示的 data.frames 列表：

```
df=data.frame(
data_id=rep(LETTERS[1:10],each=1),
data_value=c(1,2,2,3,3,2,3,1,1,3))
df2=data.frame(
data_id=rep(LETTERS[1:10],each=1),
data_value=c(2,1,3,1,1,1,2,1,2,1))
df3=data.frame(
data_id=rep(LETTERS[1:10],each=1),
data_value=c(2,2,3,3,1,2,2,1,2,3))
df.list <- list(df, df2, df3) 
```

单个 data.frame 如下所示：

```
 data_id    data_value
1        A          1
2        B          2
3        C          2
4        D          3
5        E          3
6        F          2
7        G          3
8        H          1
9        I          1
10       J          3 
```

我想计算每个唯一值在 data_value 中出现的频率。我可以做这个：

```
for(i in 1:length(df.list)){
    daply(df.list[[i]], .(df.list[[i]]$data_value), nrow) -> freq
} 
```

这给了我频率计数（在这种情况下只是最后一个，对于 df3）：

```
1 2 3 
2 5 3 
```

我的实际数据集要大得多，所以我不能在这里发布。但是，它具有完全相同的结构。问题是，当我尝试获取实际数据集的频率计数时，我收到以下错误消息：

```
Error in dim(out_array) <- out_dim : dims [product 0] do not match the length of object [1] 
```

谁能告诉我我需要从哪里开始解决这个问题？我不明白 'dim()' 的来源和作用。非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T16:18:50.070

实际上，您可以做得比这更好，将 for 循环替换为 a `laply`，这意味着输入是一个列表，输出是一个矩阵/数组。

```
o <- laply(df.list, function(x) {
    table(x$data_value)
})
> o
#      1 2 3
# [1,] 3 3 4
# [2,] 6 3 1
# [3,] 2 5 3 
```

为了检查你的错误原因，当你尝试这个时会发生什么？

```
o <- llply(df.list, function(x) {
    table(x$data_value)
}) 
```

**编辑：**为了使错误更容易理解，让我们创建这个data.frame：

```
d1 <- data.frame(a=1:4)
d2 <- data.frame(a=1:5)
d3 <- data.frame(a=1:6)
d4 <- data.frame(a=1:7)

dl <- list(d1,d2,d3,d4) 
```

现在运行`laply`：

```
laply(dl, function(x) table(x$a))
# Error: Results must have the same dimensions. 
```

为什么？要看到这一点，让我们打印它：

```
> laply(dl, function(x) print(table(x$a)))

# 1 2 3 4 
# 1 1 1 1 
# 
# 1 2 3 4 5 
# 1 1 1 1 1 
# 
# 1 2 3 4 5 6 
# 1 1 1 1 1 1 
# 
# 1 2 3 4 5 6 7 
# 1 1 1 1 1 1 1 

# Error: Results must have the same dimensions. 
```

你看到问题了吗？每行中的元素数量不同。您不能有一个矩阵（除非您将具有较小元素的那些附加到等于行）。

相反，使用列表，以便它们成为列表的元素，以后可以使用`[[number]]`语法访问。

```
llply(dl, function(x) table(x$a))

# [[1]]
# 
# 1 2 3 4 
# 1 1 1 1 
# 
# [[2]]
# 
# 1 2 3 4 5 
# 1 1 1 1 1 
# 
# [[3]]
# 
# 1 2 3 4 5 6 
# 1 1 1 1 1 1 
# 
# [[4]]
# 
# 1 2 3 4 5 6 7 
# 1 1 1 1 1 1 1 
```

希望这可以解决问题。

# google-app-engine - 谷歌应用引擎上的xmpp可以将消息推送到javascript客户端吗

> ID：14857396
> 
> 赞同：0
> 
> 时间：2013-02-13T15:48:38.253
> 
> 标签：google-app-engine, xmpp, channel-api

我正在谷歌应用引擎上创建一个网站，我想让用户像 gmail 一样互相聊天。我读过有两个选项 - xmpp 和频道 api。

现在我想知道，gae上的xmpp服务器能否与javascript客户端对话并将消息推送到浏览器的javascript，就像频道api一样。我在这里看到gae上的xmpp可以与xmpp客户端对话，但我没有找到关于与javascript对话的信息clients.I 更喜欢使用 xmpp，因为它提供了更多功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:11:19.490

如果您想使用 XMPP 与 Javascript 客户端对话，您可以使用[Strophe.js](http://strophe.im/strophejs/) - 但是您需要某种 XMPP 帐户才能让客户端登录。

# php - PHP 创建 Outlook/thunderbird/macbook 脚本来管理电子邮件帐户

> ID：14857398
> 
> 赞同：0
> 
> 时间：2013-02-13T15:48:45.413
> 
> 标签：php, macos, email, outlook, thunderbird

我没有要显示的代码。我正在尝试使用 PHP 创建 Outlook、thunderbird 和 macbook 邮件帐户。我并不是要实际创建邮件帐户，而是传递客户将用来管理电子邮件帐户的信息。我在网上找不到任何资源。本质上，用户将输入所需的信息，然后 PHP 脚本将创建一个文件，Outlook、thunderbird 或 macbook 将创建一个新的电子邮件帐户来管理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:50:47.110

大多数邮件客户端使用组合首选项文件来存储他们所有的邮件帐户信息和其他用户首选项，例如邮件规则、检查新邮件的时间间隔等。

您要实现的目标（自动向这些客户端添加额外的邮件帐户）确实很难做到。您需要了解每个客户端的首选项文件的格式，添加所需的数据，并确保您不会干扰现有数据。一个**错误的位**可能会**破坏**整个首选项文件。

这些文件可能因版本而异，并且可能被加密（因为它们可能包含邮件帐户密码。）有关其格式的信息甚至可能是专有信息，根本不可用。

如果可以通过下载和打开一个简单文件，Gmail 或 Yahoo! 等服务就可以做到这一点。Mail 已经为您创建了此类文件并提供下载。

# java - Eclipse生成getter和setter不封装

> ID：14857401
> 
> 赞同：5
> 
> 时间：2013-02-13T15:48:55.850
> 
> 标签：java, eclipse, encapsulation, setter, getter

当我在 Eclipse 中快速修复一个字段时，我可以为该字段生成一个 getter 和 setter。这也使该字段成为私有字段，并且随后将所有源文件中对该字段的所有访问转换为使用 getter 和 setter。这是单个字段的情况。

但是，如果我执行 contextmenu > Source > Generate Getters and Setters...（当您想要影响所有字段时使用的选项），它不会进行前面提到的更改，并且对源代码中字段的所有访问都保持原样。

我忽略了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T15:54:14.910

快速修复不会进入此菜单。可以从中访问快速修复呼叫的菜单`Context Menu -> Refactor -> Encapsulate Field`

# sql - 多个值的 SQL 插入语句

> ID：14857403
> 
> 赞同：1
> 
> 时间：2013-02-13T15:49:04.127
> 
> 标签：sql, insert, multiple-columns

我有点困惑我们是否可以为几个相同的值插入多行/多个值。为了让它不那么复杂，我的表格应该如下所示。现在我在excel中有数据。

![在此处输入图像描述](../Images/61f9ec7815905edd298adde4163b46bc.png)

我想通过保持其他行值相同来插入 SET_VALUE。我能想到的唯一其他选择是多次插入:(

```
INSERT INTO TABLE_NAME
  VALUES ( null, 100, 'miscellaneous', 'book', CURRENT_TIMESTAMP ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:01:11.300

您可以使用[OPENROWSET](http://msdn.microsoft.com/en-us/library/ms190312.aspx)命令。[更多示例来展示 OPENROWSET 命令的一些灵活性](http://www.mssqltips.com/sqlservertip/1540/insert-update-or-delete-data-in-sql-server-from-excel/)

让我们假设一个 ID IDENTITY

```
INSERT TABLE_NAME(SET_ID, SET_NAME, SET_VALUE, LOGIN_TIME)
SELECT 100, 'miscellaneous', SET_VALUE, CURRENT_TIMESTAMP 
FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
                'Excel 8.0;Database = C:\OPENROWSET_Examples.xls;', 
                'SELECT SET_VALUE FROM [INSERT_Example$]') 
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:51:34.043

查看插入`SELECT`：

```
INSERT INTO TABLE_NAMES (col1, col2, changingCol, col4)
SELECT
    ConstantValue1,
    ConstantValue2,
    MyChangingValue,
    ConstantValue4
FROM
   ... 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-13T15:54:50.183

试试这个[链接](https://stackoverflow.com/questions/1604091/update-a-table-using-join-in-sql-server/1604212#1604212)

> 引用

```
UPDATE a
  SET a.CalculatedColumn = b.[Calculated Column]
  FROM Table1 AS a
  INNER JOIN Table2 AS b
  ON a.CommonField = b.[Common Field]
  WHERE a.BatchNo = '110'; 
```

# ruby - Ruby：尝试运行 set 命令

> ID：14857407
> 
> 赞同：2
> 
> 时间：2013-02-13T15:49:19.920
> 
> 标签：ruby, bash, shell

我正在使用 Chef 和 ruby​​，我正在尝试运行 set 命令。

```
setVarList = %x(set) 
```

如果我只是键入 set 它可以正常工作，但是如果我运行此脚本，则会收到以下错误：

```
/var/chef/cache/cookbooks/motd/recipes/default.rb:22: command not found:   set 
```

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:43:21.103

正如[Anew](https://stackoverflow.com/users/955526/anew)已经提到的：**set**是 bash 内置命令，但 ruby​​ %x() shell 是**sh**。

```
%x(echo $0) 
```

[正如CodeGnome](https://stackoverflow.com/users/1301972/codegnome)在评论中提出的那样，解决方法是显式运行 bash 。

```
%x(/bin/bash -c set) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:41:21.393

看起来你没有产卵`bash`壳。

`set`是一个 bash 内置：

> 4.3.1 内置集合
> 
> 这个内置函数非常复杂，值得拥有自己的部分。set 允许您更改 shell 选项的值并设置位置参数，或显示 shell 变量的名称和值。

```
set
set [--abefhkmnptuvxBCEHPT] [-o option-name] [argument …]
set [+abefhkmnptuvxBCEHPT] [+o option-name] [argument …] 
```

> 如果没有提供任何选项或参数，set 会显示所有 shell 变量和函数的名称和值，按照当前语言环境排序，格式可以重新用作设置或重置当前设置变量的输入。只读变量不能被重置。在 POSIX 模式下，仅列出 shell 变量。

[http://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html](http://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html)

尝试运行`ps -p $$`以查看生成了哪个 shell。

```
anew@Wintermute:~$ ps -p $$
  PID TTY           TIME CMD
10018 ttys001    0:00.11 -bash
anew@Wintermute:~$ 
```

# java - 我希望我的程序在通话和面对面时执行 android 的操作。

> ID：14857414
> 
> 赞同：0
> 
> 时间：2013-02-13T15:49:33.813
> 
> 标签：java, android

我知道这类似于这个问题 [android: close off screen when close to face](https://stackoverflow.com/questions/3018716/android-turn-off-screen-when-close-to-face) 和许多其他问题。但我找不到任何可行的解决方案。

所以我有一个播放音频的程序。我听接近传感器：

```
@Override
public void onSensorChanged(SensorEvent event) {
    if(event.values[0] == 0.0){
        //phone close to face
        playAudio();
    }else{
        //phone away
        stopAudio();
    } 
```

我已使用此代码在靠近脸部时禁用屏幕：

```
WindowManager.LayoutParams params = getWindow().getAttributes();
params.screenBrightness = 0;
getWindow().setAttributes(params); 
```

但我不知道如何找回它:) 我试过：

```
WindowManager.LayoutParams params = getWindow().getAttributes();
params.screenBrightness = 1f; //tried all (1, 100, -1, 0)
getWindow().setAttributes(params); 
```

还有一些建议：

```
PowerManager pm = (PowerManager) getApplicationContext().getSystemService(Context.POWER_SERVICE);
WakeLock wakeLock = pm.newWakeLock((PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP), "TAG");
wakeLock.acquire(); 
```

但没有任何效果。当我将手机从脸部移开时，音频停止。所以活动不会暂停。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:50:16.787

将先前的屏幕亮度值保存在变量中，然后使用 setAttributes 恢复它

例如：

```
// Before changing brightness to 0
WindowManager.LayoutParams params = getWindow().getAttributes();
float oldScreenBrightness = params.screenBrightness; // Save the brightness param
//... Your code

// When u want to restore the brightness
WindowManager.LayoutParams params = getWindow().getAttributes();
params.screenBrightness = oldScreenBrightness;
getWindow().setAttributes(params); 
```

# python - PYTHON - 套接字管理

> ID：14857415
> 
> 赞同：0
> 
> 时间：2013-02-13T15:49:35.540
> 
> 标签：python, sockets, echo, ping, reply

我正在尝试在 python 中实现多 ping 代码，但问题是在下面的代码中，我定义的两个套接字似乎都从 SAME DESTINATION 接收了 SAME PACKET！为什么会这样？哦

- - - - - - - - - - 更新 - - - - - - - - - -

我注意到接收到的数据包始终是“最快”的数据包[即具有较小 RTT 的数据包]！例如：

```
dests_list = ['173.194.41.70','213.92.16.101'] -> DEST: 173.194.41.70
dests_list = ['213.92.16.101','173.194.41.70'] -> DEST: 173.194.41.70
dests_list = ['213.92.16.191','95.141.47.7'] -> DEST: 213.92.16.191 
```

和：

```
RTT_213.92.16.191=20ms  RTT_173.194.41.70=8ms  RTT_95.141.47.7=28ms 
```

- - - - - - - - - - 更新 - - - - - - - - - -

代码 --> [在帖子的末尾有一个可下载的版本以避免格式问题]

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

from exceptions import Exception
import random
import select
import socket
import struct
import sys
import time

ICMP_ECHO_REQUEST = 8  # Seems to be the same on Solaris.
PACKET_SIZE = 32
IS_WIN = False
my_socket_list = []
dests_list = ['173.194.41.70','213.92.16.101']
N_DESTS = 2
seq_num = 1

#----------------------------------------------------------------------------------------#
#----> CHECKSUM: calculate checksum
#----------------------------------------------------------------------------------------#

def checksum(source_string):
    """
    I'm not too confident that this is right but testing seems
    to suggest that it gives the same answers as in_cksum in ping.c
    """

    sum = 0
    countTo = len(source_string) / 2 * 2
    count = 0
    while count < countTo:
        thisVal = ord(source_string[count + 1]) * 256 + ord(source_string[count])
        sum = sum + thisVal
        sum = sum & 0xffffffff  # Necessary?
        count = count + 2

    if countTo < len(source_string):
        sum = sum + ord(source_string[len(source_string) - 1])
        sum = sum & 0xffffffff  # Necessary?

    sum = (sum >> 16) + (sum & 65535)
    sum = sum + (sum >> 16)
    answer = ~sum
    answer = answer & 65535

    # Swap bytes. Bugger me if I know why.

    answer = answer >> 8 | answer << 8 & 0xff00

    return answer

#----------------------------------------------------------------------------------------#
#----> RECEIVE PINGS: polling on all open sockets
#----------------------------------------------------------------------------------------#

def receive_pings():
    """
    Receive the ping from the socket.
    """

    whatReady = select.select(my_socket_list, [], [], 1000)

        if whatReady[0] != []:
        print whatReady[0]
        for skt in whatReady[0]:

            # time evaluation 
            if IS_WIN:
                timeReceived = time.clock()
            else:
                timeReceived = time.time()

            # get datas
            (recPacket, addr) = skt.recvfrom(PACKET_SIZE + 64)
            icmpHeader = recPacket[20:28]
            (type, code, checksum, packetID, sequence) = struct.unpack('bbHHh', icmpHeader)
            print addr
            if type == 0:
            bytesInDouble = struct.calcsize('d')
            timeSent = struct.unpack('d', recPacket[28:28 + bytesInDouble])[0]
            print "DEST: %s - RTT: %s"%(addr[0],str(timeReceived-timeSent))
           elif type == 3:
            codes = {
                        0: 'Net Unreachable',
                    1: 'Host Unreachable',
                    2: 'Protocol Unreachable',
                3: 'Port Unreachable',
                }
            raise Exception(codes[code])
            break

#----------------------------------------------------------------------------------------#
#----> SEND PING
#----------------------------------------------------------------------------------------#

def send_one_ping(my_socket, dest_addr, ID):

    # Header is type (8bit), code (8bit), checksum (16bit), id (16bit), sequence (16bit)

    my_checksum = 0

    # Make a dummy heder with a 0 checksum.

    header = struct.pack('bbHHh', ICMP_ECHO_REQUEST, 0, my_checksum, ID, 1)
    bytesInDouble = struct.calcsize('d')
    data = (PACKET_SIZE - len(header) - bytesInDouble) * 'x'

    if IS_WIN:
        start = time.clock()
    else:
        start = time.time()

    data = struct.pack('d', start) + data

    # Calculate the checksum on the data and the dummy header.

    my_checksum = checksum(header + data)

    # Now that we have the right checksum, we put that in. It's just easier
    # to make up a new header than to stuff it into the dummy.

    header = struct.pack('bbHHh', ICMP_ECHO_REQUEST, 0, socket.htons(my_checksum), ID, 1)
    packet = header + data
    print my_socket 
    while packet:
        sent = my_socket.sendto(packet, (dest_addr, 1))  # Don't know about the 1
        packet = packet[sent:]      
        print "PING SENT TO %s"%dest_addr 

#----------------------------------------------------------------------------------------#
#----> DO ONE: socket creation and ping sending
#----------------------------------------------------------------------------------------#

def send_pings():

    i = 1
    for skt in my_socket_list:
        print i
        send_one_ping(skt, dests_list[i-1], i)
        i+=1

    seq_num=+1

#----------------------------------------------------------------------------------------#
#----> SCHEDULE PING: open socket towards a specific destination
#----------------------------------------------------------------------------------------#

def sockets_opening(Ndests):
    try:

        if sys.platform[0:-2] == 'win':
                IS_WIN = True
        else:
                IS_WIN = False

        for i in range(0,Ndests):
            icmp = socket.getprotobyname('icmp')
            my_socket_list.append(socket.socket(socket.AF_INET, socket.SOCK_RAW,icmp))
            print "O2: %s"%my_socket_list[i]

    except socket.error, (errno, msg):
        if errno == 1:      # operation not permitted
            msg = msg + ' - Note that ICMP messages can only be sent from processes running as root.'
                raise socket.error(msg)
            raise   # raise the original error

def sockets_closing():
    try:
        for skt in my_socket_list:
            print "C2: %s"%skt      
            skt.close()
    except socket.error, (errno, msg):
        print "ERR:%d -> %s"%(errno,msg)        
        raise

#----------------------------------------------------------------------------------------#
#----> MAIN
#----------------------------------------------------------------------------------------#

if __name__ == '__main__':
    print
    sockets_opening(N_DESTS)
    send_pings()
    #time.sleep(3)
    receive_pings()
    sockets_closing() 
```

输出-->

```
CREATED-SOCKETS:[<socket._socketobject object at 0xb7267df4>, <socket._socketobject object at 0xb7267e2c>]

PING SENT TO 173.194.41.70
PING SENT TO 213.92.16.101

READY-SOCKETS:[<socket._socketobject object at 0xb7267df4>, <socket._socketobject object at 0xb7267e2c>]
DEST: 173.194.41.70 - RTT: 0.00797414779663
DEST: 173.194.41.70 - RTT: 0.00811314582825

C2: <socket._socketobject object at 0xb7267df4>
C2: <socket._socketobject object at 0xb7267e2c> 
```

代码链接：[PingSKT.py](https://www.dropbox.com/s/90wjfd3saz4xurj/PingSKT.py)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:09:02.880

这就是原始套接字的工作方式。

从[TCP/IP 原始套接字（Windows）](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740548%28v=vs.85%29.aspx?ppud=4)（强调我的）：

> 接收到的数据报被复制到**所有** `SOCK_RAW`满足以下条件的套接字中：
> 
> *   *创建套接字时在协议*参数中指定的协议号 应与接收到的数据报的 IP 头中的协议号相匹配。
>     
>     
> *   如果为套接字定义了本地 IP 地址，它应该对应于接收到的数据报的 IP 头中指定的目标地址。应用程序可以通过调用该`bind`函数来指定本地 IP 地址。如果没有为套接字指定本地 IP 地址，则将数据报复制到套接字中，而不管接收到的数据报的 IP 标头中的目标 IP 地址。
>     
>     
> *   如果为套接字定义了一个外部地址，它应该对应于接收到的数据报的 IP 头中指定的源地址。应用程序可以通过调用`connect` or`WSAConnect`函数来指定外部 IP 地址。如果没有为套接字指定外部 IP 地址，则将数据报复制到套接字中，而不管接收到的数据报的 IP 标头中的源 IP 地址如何。
>     
>     
> 
> 重要的是要了解某些类型的套接字`SOCK_RAW`可能会收到许多意外的数据报。例如，一个 PING 程序可以创建一个类型的套接字`SOCK_RAW`来发送 ICMP 回显请求和接收响应。当应用程序期待 ICMP 回显响应时，所有其他 ICMP 消息（例如 ICMP HOST_UNREACHABLE）也可能会传递到此应用程序。**此外，如果`SOCK_RAW`计算机上同时打开多个套接字，则可能会将相同的数据报传送到所有打开的套接字。应用程序必须有一种机制来识别感兴趣的数据报并忽略所有其他数据报。对于 PING 程序，这种机制可能包括检查接收到的 IP 标头中 ICMP 标头中的唯一标识符（例如，应用程序的进程 ID）。**

该页面似乎暗示调用`connect`套接字将导致它仅从连接的地址接收数据报，但是调用`connect`原始套接字对我来说（在 OS X 上）使用`[Errno 56] Socket is already connected`.

所以看起来你必须手动整理回复。

# iphone - iOS 编译器错误：找不到 IOKit/IOKitLib.h

> ID：14857416
> 
> 赞同：0
> 
> 时间：2013-02-13T15:49:37.777
> 
> 标签：iphone, ios, frameworks, build

我只是尝试为 iPhone 编译我的 xcode 项目（使用 Phonegap）。

编译失败，但出现以下消息：

```
In file included from 
    /Users
    /mobile
    /Documents
    /dev
    /mobile
    /ios
    /TOMO
    /xcode
    /TOMO
    /MyProject.de-Prefix.pch:25 
    (#import <UIKit/UIKit.h>):
In file included from 
    /Applications
    /Xcode.app
    /Contents
    /Developer
    /Platforms
    /iPhoneOS.platform
    /Developer
    /SDKs
    /iPhoneOS6.1.sdk
    /System
    /Library
    /Frameworks
    /UIKit.framework
    /Headers
    /UIKit.h:10 
    (#import <UIKit/UIAccessibility.h>):
In file included from 
    /Applications
    /Xcode.app
    /Contents
    /Developer
    /Platforms
    /iPhoneOS.platform
    /Developer
    /SDKs
    /iPhoneOS6.1.sdk
    /System
    /Library
    /Frameworks
    /UIKit.framework
    /Headers
    /UIAccessibility.h:8 
    (#import <CoreGraphics/CoreGraphics.h>):
In file included from 
    /System
    /Library
    /Frameworks
    /ApplicationServices.framework
    /Versions
    /A
    /Frameworks
    /CoreGraphics.framework
    /Headers
    /CoreGraphics.h:41 
    (#include <CoreGraphics/CGDisplayConfiguration.h>):

/System
/Library
/Frameworks 
/ApplicationServices.framework
/Versions
/A
/Frameworks
/CoreGraphics.framework
/Headers
/CGDisplayConfiguration.h:8:10: fatal error: 'IOKit/IOKitLib.h' file not found
#include <IOKit/IOKitLib.h>
         ^
1 error generated. 
```

因此，显然 UIKit.framework 和 CoreGraphics.framework 都需要 IOKit，所以我将 IOKit.framework 作为链接二进制文件添加到：

```
Project->Build Phases->Link Binary with Libraries 
```

它肯定存在（我在项目导航器中看不到 IOKit.framework）。

所以，我清理并构建并得到同样的错误。

是什么赋予了？

# facebook - 我的 unity3d 应用程序需要“crossdomain.xml”

> ID：14857421
> 
> 赞同：1
> 
> 时间：2013-02-13T15:49:57.527
> 
> 标签：facebook, unity3d, crossdomain.xml

我将我的 unity3d 应用程序放在 Facebook 上，但登录不起作用，因为我需要`crossdomain.xml`根据[此文档](http://docs.unity3d.com/Documentation/Manual/SecuritySandbox.html)在主机的根目录中。我把它放到我的网站上，它对我有用，但在 Facebook 上不行。我认为需要将其放入`app.facebook.com`.

这是我的`crossdomain.xml`：

```
<?xml version="1.0"?>
<cross-domain-policy>
  <allow-access-from domain="*"/>
</cross-domain-policy> 
```

你能帮我吗？

# php - 类属性声明

> ID：14857422
> 
> 赞同：1
> 
> 时间：2013-02-13T15:50:08.680
> 
> 标签：php, class, object

我有一段时间没有使用 PHP，但我尝试过这样的事情：

```
<?php

class Something {
    public $x = 2 * 3;   // (line 4)
} 
```

此代码触发以下错误：

> [2013 年 2 月 13 日星期三 17:43:56] [错误] [客户端 127.0.0.1] PHP 解析错误：语法错误，意外的 '*'，期待 ',' 或 ';' 在 /var/www/problem.php 第 4 行

PHP[文档](http://www.php.net/manual/en/language.oop5.properties.php)说

> 这个初始化必须是一个常数值——也就是说，它必须能够在编译时被评估，并且不能依赖于运行时信息才能被评估。

因此，根据文档，我的代码应该可以工作。我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T15:52:15.173

声明类的成员时，您可以为它们分配值，但不能执行数学或函数调用等复杂操作。

```
<?php

class Something {
    public $x = 2 * 3;   // (line 4)
} 
```

可：

```
<?php

class Something {
    public $x = 6;   // (line 4)
} 
```

因此，在您的情况下，您将希望在构造函数中初始化该值。

```
<?php

class Something {
    public $x; 

    public function __construct() 
    {
        $this->x = 2 * 3;
    }  
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T15:53:17.563

如果您真的仔细阅读了示例中链接到的文档，它清楚地表明这是不允许的：

```
class SimpleClass
{
    // invalid property declarations:
    // (some examples here)
    public $var3 = 1+2;
} 
```

这意味着乘法也不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T15:52:24.713

> 因此，根据文档，我的代码应该可以工作。

# 不

文档明确指出：“它必须能够在编译时进行评估，并且不能依赖于运行时信息”

`2 * 3`是运行时评估。

`public $x = 6;`应该管用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T15:53:30.917

`2 * 3`不允许运行时评估。

正如[DOCS](http://php.net/manual/en/language.oop5.properties.php)所说

> 这个声明可能包括一个初始化，但这个初始化必须是一个常量值——也就是说，它必须能够在编译时被评估，并且**不能**依赖于运行时信息才能被评估。

# c# - VS 2010 类型中不存在“Click”属性...？

> ID：14857428
> 
> 赞同：0
> 
> 时间：2013-02-13T15:50:18.563
> 
> 标签：c#, visual-studio, silverlight, events, click

你可能已经猜到了，我是个菜鸟。我注意到，在尝试使用 VS express 为 windows phone 制作 windows phone 应用程序时，如果我遇到以下问题，我很快就会遇到问题：

*   在 xaml 中添加文本块
*   在文本块的标记中添加 Click="thing"
*   `private void thing(object sender, MouseButtonEventArgs e) { return; }` 在后面的代码中声明

VS 不让我编译，因为 xml 命名空间“ [http://schemas.microsoft.com/winfx/2006/xaml/presentation](http://schemas.microsoft.com/winfx/2006/xaml/presentation) ”中的“TextBlock”类型中不存在“Click”属性

我知道这个论坛通常不适合这些基本的东西，但我真的不明白我怎么能通过添加这两个东西来搞砸它。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:53:52.060

没错，Silverlight 中的 TextBlock 没有点击... [http://msdn.microsoft.com/en-us/library/system.windows.controls.textblock(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.textblock(v=vs.95).aspx)

GotFocus 可能是您正在寻找的事件......或者您可能想要完全不同的元素类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T06:13:45.260

备用在这里，使用“mouseLeftButtonDown”事件，该事件将与单击事件相同，也可用于几乎所有基本控件

# cakephp - 错误：在数据源默认值中找不到模型 Post 的表帖子

> ID：14857429
> 
> 赞同：2
> 
> 时间：2013-02-13T15:50:19.193
> 
> 标签：cakephp, cakephp-2.3

我正在尝试编辑我的用户信息，我所做的唯一更改是在下面的控制器函数中将 id 从 userID 更改为 id，因为我已经在数据库、模型和视图中更改了它。

```
Public function useredit() {
            $this->User->id = $this->Session->read('Auth.User.id');
            $this->request->data = $this->Session->read('Auth.User.id');
            if ($this->request->is('post')) {
                if ($this->User->save($this->request->data)) {
                    $this->Session->setFlash(__('The User has been saved', true));
                    $this->redirect(array('action' => 'index'));
                } else {
                    $this->Session->setFlash(__('The User could not be saved. Please, try again.', true));
                }
            } else {
                $this->request->data = $this->User->read(null);
                isset($this->request->data['User']['password']);
            }
        } 
```

但现在它告诉我`Error: Table posts for model Post was not found in datasource default.` 这是我的模型：

```
<?php

App::uses('AppModel', 'Model');
App::uses('AuthComponent', 'Controller/Component');

class User extends AppModel {

    public $belongsTo = array('Group');
    public $actsAs = array('Acl' => array('type' => 'requester'));

    public function parentNode() {
        if (!$this->id && empty($this->data)) {
            return null;
        }
        if (isset($this->data['User']['group_id'])) {
            $groupId = $this->data['User']['group_id'];
        } else {
            $groupId = $this->field('group_id');
        }
        if (!$groupId) {
            return null;
        } else {
            return array('Group' => array('id' => $groupId));
        }
    }

    public $validate = array(
        'id' => array(
            'numeric' => array(
                'rule' => array('numeric'),
            ),
        ),
        'username' => array(
            'notempty' => array(
                'rule' => array('notempty'), 
                ),
        ),
        'password' => array(
            'notempty' => array(
                'rule' => array('notempty'),
            ),
        ),
        'name' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'Your name is required'
            )
        ),
        'surname' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'Your surname is required'
            )
        ),
        'address1' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'Please enter your first line of address'
            )
        ),
        'address2' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'please enter your second line of address'
            )
        ),
        'town' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'Please enter your town'
            )
        ),
        'postCode' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'please enter your postcode'
            )
        ),
        'dob' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'please enter your date of birth'
            )
        ),
        'emailAddress' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'please enter your email address'
            )
        ),
        'phoneNumber' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'please enter your phone number'
            )
        ),
        'mobileNumber' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'please enter your mobile number'
            )
        ),
        'group_id' => array(
            'numeric' => array(
                'rule' => array('numeric'),
            ),
        ),
    );

    public $hasMany = array(
        'Post' => array(
            'className' => 'Post',
            'foreignKey' => 'user_id',
            'dependent' => false,
            'conditions' => '',
            'fields' => '',
            'order' => '',
            'limit' => '',
            'offset' => '',
            'exclusive' => '',
            'finderQuery' => '',
            'counterQuery' => ''
        )
    );

    public function bindNode($user) {
        return array('model' => 'Group', 'foreign_key' => $user['User']['group_id']);
    }

    public function beforeSave($options = array()) {
         if (isset($this->data[$this->alias]['password'])) {
            $this->data[$this->alias]['password'] = AuthComponent::password($this->data[$this->alias]['password']);
        }
    }

} 
```

我有遵循教程的帖子表，但我确实计划删除它们，因为它们与我的网站无关，但这与我收到此错误消息的事实有关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:44:19.833

这是因为您声明了 User 和 Post 之间的关系

```
public $hasMany = array(
    'Post'
); 
```

如果您不需要这种关系，您也许可以`$hasMany`在您的 User 模型 ( ) 中删除这种关系。`user.php`

# r - 如何将矢量的简单代码应用于多个栅格？

> ID：14857431
> 
> 赞同：0
> 
> 时间：2013-02-13T15:50:20.880
> 
> 标签：r, binary, raster, moving-average

我有 12 个二进制（光栅）文件。我想计算 12 个文件中每个像素的 12 个值的移动平均值。

对于一个简单的向量，我们可以使用以下方法获得移动平均值：

```
 x <- c(1,2,3,NA,NA,4,6,5,6,4,2,5)
        movingmean <- rollapply(x, 3, FUN = mean, na.rm = T,fill=NA) 
```

现在我想做同样的事情，但使用栅格，我尝试过：

```
files   <- list.files("C:final-2010", "*.envi", full.names = TRUE)
results <- list()
for (.files in files) {
    # read in the 12 files as a vector of numbers 
    # that we take the average of
    x <- do.call(rbind,(lapply(.files, readBin  , double() , 
                     size = 4 ,n =1440 * 720 , signed = T)))
    # take the moving average across the 12 values 
    # from the 12 files for each pixel
    results[[length(results) + 1L]] <- rollapply(x, 3, FUN = mean,na.rm = T)
} 
```

但是得到了这个错误：

```
 Error in seq.default(start.at, NROW(data), by = by) : 
                             wrong sign in 'by' argument 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:41:10.393

也许这样的事情会起作用

```
results <- overlay(stack(files), fun=function(x) 
                   movingFun(x, fun=mean, n=3, na.rm=TRUE)) 
```

# java - 如何使用 ASM 重命名一个类并保持在同一个类加载器中？

> ID：14857432
> 
> 赞同：2
> 
> 时间：2013-02-13T15:50:22.753
> 
> 标签：java, java-bytecode-asm

我正在尝试使用[ASM 4.0](http://asm.ow2.org/)重命名一个类：

```
ClassReader reader = new ClassReader(
    loader.getResourceAsStream("test/MyClass.class")
);
ClassWriter writer = new ClassWriter(reader, 0);
ClassVisitor visitor = new RemappingClassAdapter(visitor, new Remapper() { /* skipped */ });
reader.accept(visitor, 0);
return new ClassLoader() {
    public Class<?> load(final String name, final byte[] bytes) {
        return this.defineClass(name, bytes, 0, bytes.length);
    }
}.load("test/MyClass", writer.toByteArray()); 
```

我故意跳过了重命名部分。新类应该是原始类的精确副本。是的，但它不能再像旧的一样使用了：

```
java.lang.ClassCastException: test.MyClass cannot be cast to test.MyClass 
```

如何留在同一个类加载器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T10:03:33.330

在 JVM 中，每个类都由它的完全限定名称和加载该类的类加载器来标识。这解释了您的 ClassCastException。

重命名类后，您应该能够在任何类加载器中加载重命名的类。使用反射来获取“ClassLoader.defineClass()”方法并使用它在 getClass().getClassLoader() 上调用它；

```
Method m=ClassLoader.class.getDeclaredMethod("defineClass",
 String.class,byte[].class,int.class,int.class) 
m.setAccessible(true);
m.invoke(getClass().getClassLoader(), ... ) 
```

# android - 当数据库以可读方式打开时，SqlOpenHelper#onUpgrade(...) 失败

> ID：14857437
> 
> 赞同：0
> 
> 时间：2013-02-13T15:50:34.763
> 
> 标签：android, android-contentprovider, sqliteopenhelper

我正在编写一个`ContentProvider`使用 an`SqlOpenHelper`来获取其数据库的。我刚刚对数据库进行了一些重大更改，因此我将数据库的版本提高了一个。

这发生过：

```
02-13 15:36:15.668: E/AndroidRuntime(15917): FATAL EXCEPTION: AsyncTask #3
02-13 15:36:15.668: E/AndroidRuntime(15917): java.lang.RuntimeException: An error occured while executing doInBackground()
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.os.AsyncTask$3.done(AsyncTask.java:278)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.lang.Thread.run(Thread.java:864)
02-13 15:36:15.668: E/AndroidRuntime(15917): Caused by: android.database.sqlite.SQLiteException: Can't upgrade read-only database from version 2 to 3: /data/data/com.company.anothercompany.anotherothercompany/databases/twocompanies
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:262)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at com.somo.vertu.provider.FerrariVertuContentProvider.query(FerrariVertuContentProvider.java:94)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.ContentProvider$Transport.query(ContentProvider.java:189)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.ContentResolver.query(ContentResolver.java:315)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.CursorLoader.loadInBackground(CursorLoader.java:56)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.CursorLoader.loadInBackground(CursorLoader.java:42)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.AsyncTaskLoader.onLoadInBackground(AsyncTaskLoader.java:255)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.AsyncTaskLoader$LoadTask.doInBackground(AsyncTaskLoader.java:66)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.content.AsyncTaskLoader$LoadTask.doInBackground(AsyncTaskLoader.java:55)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at android.os.AsyncTask$2.call(AsyncTask.java:264)
02-13 15:36:15.668: E/AndroidRuntime(15917):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
02-13 15:36:15.668: E/AndroidRuntime(15917):     ... 4 more 
```

我`getReadableDatabase()`从`query(...)`函数调用是因为我在阅读，而不是在写作。在这种情况下`onUpgrade()`，意味着什么都不会返回，但我正在处理。如何在不调用`getWritableDatabase(...)`方法的情况下触发可写数据库的升级`ContentProvider#onCreate()`？或者这是最好的做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:57:08.170

**改写**

我看到了三个选项：

1.  最简单的方法是简单地调用`getWritableDatabase()`.
2.  您还可以存储最后一个数据库版本（可能在 SharedPreference 文件中）。然后检查数据库是否需要在里面升级`getReadableDatabase()`，如果需要偷偷调用`getWritableDatabase()`。
3.  这是最复杂的方法。它需要创建您自己的 SQLiteOpenHelper 版本，在升级发生时打开一个可写版本......

# facebook-graph-api - 如何按国家/地区获取页面粉丝分布？

> ID：14857442
> 
> 赞同：6
> 
> 时间：2013-02-13T15:50:41.907
> 
> 标签：facebook-graph-api, facebook-like, facebook-fql, facebook-page

我正在尝试按国家/地区获取我不拥有的给定页面的喜欢数量（公共数据）。就是这样： http: [//www.socialbakers.com/facebook-pages/40796308305-coca-cola](http://www.socialbakers.com/facebook-pages/40796308305-coca-cola)

但我无法使用 Graph API（FQL 与否）获取此信息。我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-06T15:09:55.987

`read_insights`与`PAGE_ID/insights/page_fans_country/lifetime`端点一起使用

页面的国家级见解在 API 中是公开的。

```
{
  "data": [
    {
      "id": "40796308305/insights/page_fans_country/lifetime", 
      "name": "page_fans_country", 
      "period": "lifetime", 
      "values": [
        {
          "value": {
            "BR": 17169677, 
            "US": 13454934, 
            "MX": 5644191, 
            "AR": 3578155, 
            "FR": 3384137, 
            "IN": 2904517, 
            "GB": 2662948, 
            "TH": 2590348, 
            "IT": 2397743, 
            "CO": 1894922, 
            "ID": 1815370, 
            "EG": 1785809, 
            "PH": 1610465, 
            "TR": 1605864, 
            "PK": 1526578, 
            "CL": 1486394, 
            "VN": 1377232, 
            "DE": 1297679, 
            "PL": 1186274, 
            "VE": 1084718, 
            "CA": 987125, 
            "RO": 921001, 
            "PE": 813268, 
            "EC": 810028, 
            "ES": 789604, 
            "AU": 760158, 
            "MA": 571517, 
            "RS": 472829, 
            "PT": 466989, 
            "NG": 452234, 
            "TN": 442278, 
            "BE": 430922, 
            "MY": 411240, 
            "ZA": 400423, 
            "SE": 352346, 
            "GR": 332333, 
            "HU": 331825, 
            "KE": 327691, 
            "NL": 325613, 
            "GT": 323790, 
            "CR": 303266, 
            "PR": 287217, 
            "DZ": 282063, 
            "DO": 278955, 
            "BD": 271926
          }, 
          "end_time": "2014-12-02T08:00:00+0000"
        }, 
```

# search - Netsuite 公式字段

> ID：14857443
> 
> 赞同：0
> 
> 时间：2013-02-13T15:50:49.093
> 
> 标签：search, field, formula, netsuite

目前，我想在 Netsuite 中创建公式字段来评估行项目的结果。例如：在采购订单中，正文字段中所有行项目数量的总和。

我不太确定如何做到这一点。你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T19:46:53.983

我认为您应该创建一个 userevent 脚本，该脚本将在自定义字段中维护此计数。然后可以在任何地方访问此字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T20:53:00.523

您可以创建交易主体字段“custbody_sum_quantity”

```
function updateTotal(type)
{
  if(type == 'create' || type == 'edit')
   {
      var id= nlapiGetRecordId();
      var type = nlapiGetRecordType();
      var record = nlapiLoadRecord(type,id);
      var count = record.getLineItemCount('item');
      var total = 0;
      if(count  > 0)
      {
       for(var i = 1; i<=count;i++)
        {
           var quantity= record.getLineItemValue('item', 'quantity', i);
           total += quantity;
         }
      }
      record.setFieldValue('custbody_sum_quantity',total );
      var recid = nlapiSubmitRecord(record,true,true);
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T18:31:04.043

试试这个解决方案：

1.  在采购订单中创建自定义正文字段。内部 ID 示例：“custbody_sample_field_po”。
2.  在采购订单中部署的 After Submit 中创建用户事件脚本。

这是脚本：

```
var recordId = nlapiGetRecordId();
var obj = nlapiLoadRecord('purchaseorder', recordId);

//Get all line item quantity and sum it
var sum = parseInt(0);
var count = obj.getLineItemCount('item');
for(var i = 1; i <= count; i++)
{
    var temp = parseInt(obj.getLineItemValue('item', 'quantity', i));
    sum += temp;
}

//Save the total to the custom field
obj.setFieldValue('custbody_sample_field_po', sum);
nlapiSubmitRecord(obj, true); 
```

# ios - 如何更改加载图标的颜色

> ID：14857447
> 
> 赞同：0
> 
> 时间：2013-02-13T15:51:06.393
> 
> 标签：ios, xcode, refresh

我想更改拉动刷新后出现的加载图标的颜色这是我的指示器视图样式的代码，我认为这与做我想做的事情有关，但我没有编写代码，它来自：[https://github。 com/Sephiroth87/ODRefreshControl](https://github.com/Sephiroth87/ODRefreshControl)

```
-(void)setActivityIndicatorViewStyle:  (UIActivityIndicatorViewStyle)activityIndicatorViewStyle
{
if ([_activity isKindOfClass:[UIActivityIndicatorView class]]) {
    [(UIActivityIndicatorView *)_activity setActivityIndicatorViewStyle:activityIndicatorViewStyle];
}
}

- (UIActivityIndicatorViewStyle)activityIndicatorViewStyle
{
if ([_activity isKindOfClass:[UIActivityIndicatorView class]]) {
    return [(UIActivityIndicatorView *)_activity activityIndicatorViewStyle];
}
return 0;
}

- (void)setActivityIndicatorViewColor:(UIColor *)activityIndicatorViewColor
{
if ([_activity isKindOfClass:[UIActivityIndicatorView class]] && [_activity respondsToSelector:@selector(setColor:)]) {
    [(UIActivityIndicatorView *)_activity setColor:activityIndicatorViewColor];
}
}

- (UIColor *)activityIndicatorViewColor
{
if ([_activity isKindOfClass:[UIActivityIndicatorView class]] && [_activity respondsToSelector:@selector(color)]) {
    return [(UIActivityIndicatorView *)_activity color];
}
return nil;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:09:56.790

在文件 ODRefreshControl.m 中，更改以下行

```
- (id)initInScrollView:(UIScrollView *)scrollView activityIndicatorView:(UIView *)activity 
```

从

```
_activity = activity ? activity : [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray]; 
```

到

```
_activity = activity ? activity : [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite]; 
```

# mongodb - EclipseLink MongoDB @ManyToOne classCastException 非常简单的例子

> ID：14857451
> 
> 赞同：2
> 
> 时间：2013-02-13T15:51:12.793
> 
> 标签：mongodb, jpa, eclipselink

我试图让 EclipseLink (2.4.1) over MongoDB 在有关系时按预期工作。但 ...

我必须实体：

```
@Entity
@NoSql(dataType="account", dataFormat=DataFormatType.MAPPED) // dataType -> collectionName, MAPPED -> because object are transformed into a MAP in MongoDB
@Table(uniqueConstraints = @UniqueConstraint(columnNames = "email"))
public class Account extends JPAMongoBaseEntity {
    @Id
    @Field(name="_id")
    @GeneratedValue
    private String id;

    @Override
    public String getId() { return id;};
    public void setId(String id) { this.id = id;};

    // Must be unique (id fonc)
    @NotNull
    @Size(min = 1, max = 256)
    @Email
    private String email;
... 
```

和 ：

```
@Entity
@NoSql(dataType="invoice", dataFormat=DataFormatType.MAPPED) // dataType -> collectionName, MAPPED -> because object are transformed into a MAP in MongoDB
@Table(uniqueConstraints = @UniqueConstraint(columnNames = "label"))
public class Invoice extends JPAMongoBaseEntity {
    @Id
    @Field(name="_id")
    @GeneratedValue
    private String id;

... // Relations
    @ManyToOne
    private Account account; 
```

我尝试获取所有具有 account.id = 参数的 Invoice。我提出这个要求：

```
TypedQuery<Invoice> q = em.createQuery("Select i from Invoice i join i.account a where a.id=:accountId", Invoice.class);
q.setParameter("accountId", accountId);
List<Invoice> res = q.getResultList(); 
```

结果总是一样的：

```
Internal Exception: java.lang.ClassCastException: org.eclipse.persistence.eis.mappings.EISOneToOneMapping cannot be cast to org.eclipse.persistence.mappings.OneToOneMapping
Query: ReadAllQuery(referenceClass=Invoice jpql="Select i from Invoice i join i.account a where a.id=:accountId") 
```

我尝试了很多事情（@JoinField、@OneToOne、...），但我总是遇到那个异常。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:33:09.903

根据 [http://wiki.eclipse.org/EclipseLink/Examples/JPA/NoSQL#Step_6_:_Querying](http://wiki.eclipse.org/EclipseLink/Examples/JPA/NoSQL#Step_6_:_Querying) 连接不受支持。

您可以尝试使用只读基本映射映射外键并直接在查询中访问它。或为 fk 字段添加查询键，如此处所述 [http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Query_Keys](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Query_Keys)

最好的问候，克里斯

# sax - 避免随机添加 xmlns 属性

> ID：14857452
> 
> 赞同：0
> 
> 时间：2013-02-13T15:51:25.697
> 
> 标签：sax, xml-namespaces

我有两个 Java 项目的副本。

运行此方法后：

```
private void editArtifactWSDL() {
    try {
        File outputfile = new File(
        "C:\\WorkSpace\\CMU\\WebContent\\WEB-INF\\bpelfiles\\process\\Artifacts.wsdl");

        File skeletonFile = new File(
        "C:\\WorkSpace\\CMU\\WebContent\\WEB-INF\\bpelfiles\\SkeletonArtifacts.wsdl");

        DocumentBuilderFactory docFactory = DocumentBuilderFactory
        .newInstance();
        DocumentBuilder docBuilder = docFactory.newDocumentBuilder();

        Document doc = docBuilder.parse(skeletonFile);

        Element definitionsElement = doc.getDocumentElement();

        // xmlns attributes
        editDefinitionsElementToArtifact(doc, definitionsElement);

        // partnerLinkType elements
        appendPartnerLinkTypeElementsToArtifact(doc, definitionsElement);

        // import elements
        appendImportElementsToArtifact(doc, definitionsElement);

        // write the content into xml file
        TransformerFactory transformerFactory = TransformerFactory
        .newInstance();
        Transformer transformer = transformerFactory.newTransformer();
        DOMSource source = new DOMSource(doc);
        StreamResult result = new StreamResult(outputfile);

        transformer.setOutputProperty(OutputKeys.INDENT, "yes");
        transformer.setOutputProperty(
        "{http://xml.apache.org/xslt}indent-amount", "2");
        transformer.transform(source, result);

        System.out.println("Artifact.wsdl saved!");

        } catch (ParserConfigurationException pce) {
        pce.printStackTrace();
        } catch (TransformerException tfe) {
        tfe.printStackTrace();
        } catch (SAXException sxe) {
        sxe.printStackTrace();
        } catch (IOException ioe) {
        ioe.printStackTrace();
    }
} 
```

在其中一个项目中，我得到了“干净” `Artifacts.wsdl`。在另一个项目中，我 `xmlns=""`添加了一些元素。

SkeletonArtifacts.wsdl 完全相同（在[http://www.diffnow.com/](http://www.diffnow.com/)上进行比较）

那么这种随机行为的原因是什么，我是否摆脱了 xmlns 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:28:20.183

我通过使用以下代码`DocumentBuilder`制作 NameSpaceAware 来制作我的 NameSpaceAware ：`DocumentFactory`

```
docFactory.setNamespaceAware(true); 
```

`xmlns=""`属性现在消失了。

我仍然不明白为什么这会随机发生。另一个项目没有添加，`xmlns=""`即使它`DocumentBuilder`不是 NameSpaceAware。

对此的任何解释仍然是受欢迎的。

编辑：

设置 NameSpaceAware 后，我意识到在 parsig 之后添加的元素仍然具有`xmlns=""`.

我认为`Transfomer`JRE7 和 SAXON jar 中的类存在冲突，以将 ODE 集成到项目中。

# java - 第一次迭代后java循环不打印输入流数据

> ID：14857461
> 
> 赞同：0
> 
> 时间：2013-02-13T15:51:50.903
> 
> 标签：java, loops, inputstream

我有一个 java 程序，它连接到在线资源，读取数据，然后解析特定的信息（它是查看某个页面的活动 reddit 帐户的数量）。

我想自动化这个过程以在给定的时间间隔重复它（我将时间间隔设置为 5 秒只是为了看看它是否有效）。然后程序将这个数字打印到一个文件中，每次都在不同的行上。我知道主循环正在迭代，因为我的`output.txt`文件有几行，但它只在第一次迭代时找到并打印数字。

```
package redditreader3;

import java.io.*;
import java.net.Socket;
import java.util.Scanner;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RedditReader3 {
public static void main(String[] args) throws IOException, InterruptedException
{
int i = 1;
String host = args[0]; // www.reddit.com

String resource = args[1]; // /r/toronto/about.json     

final int HTTP_PORT = 80;
String command = "GET " + resource + " HTTP/1.1\n" + "Host:"  + host
   + "\n\n";

    /* This command requests reddit for the source code of the resource in args[1] at its host, args[0] to be printed through HTTP. */

Socket socket = new Socket(host, HTTP_PORT);

    InputStream instream = socket.getInputStream();

        Scanner in = new Scanner(instream);

    OutputStream outstream = socket.getOutputStream();

        PrintWriter out = new PrintWriter(outstream);

File file = new File("output.txt");

    FileOutputStream F_outstream = new FileOutputStream(file);

        PrintStream F_printstream = new PrintStream(F_outstream);

 /* Now that the connection has been established and all of the objects
    are connected to each other, the command may be sent and the data 
    transfer may begin. */

String ActiveAccountsData = ("\"accounts_active\": (\\d+)");

String ActiveAccountsDataFOUND;

Pattern ActiveAccountsPattern = Pattern.compile(ActiveAccountsData);

Matcher ActiveAccountsMatcher; 

String input;

while(i <= 4)
{

    out.print(command);
    out.flush();

    while(in.hasNextLine())
    {
        input = in.nextLine();
        ActiveAccountsMatcher = ActiveAccountsPattern.matcher(input);

        if(ActiveAccountsMatcher.find())
        {
            ActiveAccountsDataFOUND = ActiveAccountsMatcher.group(1);
            F_printstream.println(ActiveAccountsDataFOUND); 
            break;
        }
    }
    i++;
    F_printstream.println();
    Thread.sleep(5000);
}
}
} 
```

我在想也许该`in.hasNextLine()`值被卡在某个地方并且需要更新，但是我找不到将其返回到网站输入开头的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:12:46.693

您应该每 5 秒发出一个新的 HTTP GET 请求以获取更新的数据。即在循环内移动您的 InputStream/Scanner 代码。

此外，您可能希望使用[HttpClient](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/HttpClient.html)而不是操作原始套接字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:19:33.957

从当前位置删除以下行并

```
Socket socket = new Socket(host, HTTP_PORT);

InputStream instream = socket.getInputStream();

    Scanner in = new Scanner(instream);

OutputStream outstream = socket.getOutputStream();

    PrintWriter out = new PrintWriter(outstream); 
```

将代码更改为下面，但不要忘记关闭资源（输入流和输出流）：

```
while(i <= 4)
{
  Socket socket = new Socket(host, HTTP_PORT);

InputStream instream = socket.getInputStream();

    Scanner in = new Scanner(instream);

OutputStream outstream = socket.getOutputStream();

    PrintWriter out = new PrintWriter(outstream); 

out.print(command);
out.flush();

while(in.hasNextLine())
{
    input = in.nextLine();
    ActiveAccountsMatcher = ActiveAccountsPattern.matcher(input);

    if(ActiveAccountsMatcher.find())
    {
        ActiveAccountsDataFOUND = ActiveAccountsMatcher.group(1);
        F_printstream.println(ActiveAccountsDataFOUND); 
        break;
    }
}
i++;
F_printstream.println();
//close resources
Thread.sleep(5000); 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:09:38.023

您需要围绕*整个*方法放置循环。对于每次迭代，您都需要重新建立连接并解析流。

请注意，您最好使用 HttpURLConnection 而不是使用直接套接字调用（这样您就不必自己处理 http 标头等）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-13T16:06:35.047

您的扫描仪正在按预期运行。它正在通过流并打印内容。你想要做的是倒带流。您可以在 Inputstream 上使用 reset 来执行此操作（有关详细信息，请参阅 javadoc）。您可能需要创建一个新的扫描仪

# makefile - GNU 使解析变量

> ID：14857463
> 
> 赞同：0
> 
> 时间：2013-02-13T15:51:59.477
> 
> 标签：makefile, gnu-make

我想解析makefile中的变量，这个变量有下一个语法：

```
VARIABLE=folder1=file1,folder2=file2,...,folderN=fileN 
```

在这里我想用它做什么：

```
ifdef VARIABLE
#
# here I want to assign FOLDER to "folder1, folder2... folderN" in the loop
# and then compare it with current folder
#  
ifeq ($(FOLDER),$(CURRENT_FOLDER))
#
# if true assign FILE1=file1 
#
export MYFILE := FILE1
endif
else
export MYFILE = default_name
endif 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:15:38.463

如果您将分隔符更改为`,`其他分隔符，`:`例如

```
VARIABLE=folder1=file1:folder2=file2:...:folderN=fileN 
```

你可以拆分列表

```
L=$(subst :, ,$(VARIABLE)) 
```

提取文件夹（如果有）

```
E=$(filter $(CURRENT_FOLDER)=%, $L) 
```

并将最后一部分分配`=`给`MYFILE`

```
ifneq ($E,)
export MYFILE := $(patsubst $(CURRENT_FOLDER)=%,%,$E)
else
export MYFILE = default_name
endif 
```

# c# - 在存储过程中使用游标时，将受影响的行的值返回给 ExecuteNonQuery

> ID：14857464
> 
> 赞同：0
> 
> 时间：2013-02-13T15:52:07.987
> 
> 标签：c#, sql-server-2008

我在一个存储过程中使用了游标，它从 xml 获取数据以根据业务规则插入、删除或更新记录。

使用 执行时，即使行受到影响`ExecuteNonQuery()`，它也会返回。`-1`

请让我知道这件事。

谢谢大王

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T15:59:38.240

你`SET NOCOUNT ON`的存储过程中有吗？

尝试`SET NOCOUNT OFF`

请参阅此 T-SQL[文章](http://msdn.microsoft.com/en-us/library/ms189837%28v=sql.105%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:08:28.197

从*[`MSDN`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery%28v=vs.110%29.aspx)*;

> 对于 UPDATE、INSERT 和 DELETE 语句，返回值是受命令影响的行数。当正在插入或更新的表上存在触发器时，返回值包括受插入或更新操作影响的行数以及受一个或多个触发器影响的行数。**对于所有其他类型的语句，返回值为 -1。如果发生回滚，则返回值也是 -1。**

IMO 您的问题符合这些选项之一。

当然，我只是根据*返回值*来说。为了从人们那里获得更多帮助，您应该向人们提供更多信息。

# javascript - 如何验证http表单数据

> ID：14857470
> 
> 赞同：2
> 
> 时间：2013-02-13T15:52:38.083
> 
> 标签：javascript, asp.net, html, asp.net-mvc, webserver

假设我的网页`test.html`正在向同一域的网页发送表单数据`callback.html`，我如何验证表单数据是否`test.html`不是由其他人发送的？将其`test.html`视为`callback.html`.

```
<form action="callback.html" methos="post">
<input type="hidden" id="abc" value="User is not authenticated"/>
</form> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T15:54:32.023

确保 POST 来自受信任来源的唯一安全方法是确保交易涉及一些只有您的站点知道的信息。有不同的方法可以做到这一点，但一种简单的方法是将会话 cookie 的值用作表单字段值。然后，您的服务器将拒绝缺少该参数的 POST 事务。

如果您的交易不安全（https），那么无论如何都没有多大意义。

*编辑*——我会提到，如果您的 POST 事务是使用 XHR 启动的，那么另一种方法是在请求中添加一个特殊的“X-Something”标头。

# php - 跳过数据表插件中的默认列排序选项

> ID：14857479
> 
> 赞同：0
> 
> 时间：2013-02-13T15:52:53.243
> 
> 标签：php, datatables

我有一个从 mysql 数据库中获取的记录列表。我必须显示这些记录以及**保存 csv**按钮、**搜索选项**、**分页**和**页面中的显示记录数 (10,25,50,100)**。为此，我试图通过数据表插件来做。但我不想要列排序选项，因为排序功能是根据其他标准从数据库中操作的。现在可以通过 datatables 插件来实现这个场景吗？我已尝试通过以下代码跳过列排序选项。

```
"aoColumns": [
{ "bSortable": false },
{ "bSortable": false },
{ "bSortable": false },
{ "bSortable": false },
{ "bSortable": false },
{ "bSortable": false },
{ "bSortable": false },
{ "bSortable": false }
] 
```

但是在这里，我的应用程序是根据第一列按字母顺序排序的。是否还有任何选项可以隐藏默认排序选项？

请帮我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:01:54.533

关闭排序就可以了。

```
$(document).ready( function () {
     $('#example').dataTable( {
       "bSort": false
     } );
   } ); 
```

www.datatables.net/usage/features

# javascript - uInt8Array 响应 - 文件下载 - Javascript

> ID：14857483
> 
> 赞同：1
> 
> 时间：2013-02-13T15:53:11.650
> 
> 标签：javascript, xmlhttprequest, bytearray

我有一个向我发送文件流的 api 调用。我得到流并将其作为 uInt8Array 输出。

我使用这个 html5 示例：

[http://www.html5rocks.com/en/tutorials/file/xhr2/](http://www.html5rocks.com/en/tutorials/file/xhr2/)

我知道文件名和类型是什么，如何将此数组数据放入“文件”并提供给用户下载？

```
xhr = new XMLHttpRequest()
xhr.open "GET", "#{window.API_URL}/transfer/123/2134/#{program_id}", true
xhr.responseType = "arraybuffer"
xhr.onloadstart = (e) ->
    # downloading file notify on footer
xhr.onprogress = (e) ->
    # show progress and size of file.
    console.log "#{Math.round(e.loaded/e.total)*100}% completed"
xhr.onload = (e) ->
    uInt8Array = new Uint8Array(@response)

xhr.send() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-04T07:37:35.847

试试这种方法（适用于 IE10+、FF、Chrome）：

```
var blob = new Blob([uInt8Array], {type: contentType }); 
```

并参考[答案](https://stackoverflow.com/a/23797348/896281)

# c++ - 如何计算多张图片的平均值

> ID：14857485
> 
> 赞同：4
> 
> 时间：2013-02-13T15:53:14.197
> 
> 标签：c++, opencv, image-processing

我正在尝试使用opencv获取多张图片的平均值，这是我的代码：

```
#include <opencv2\core\core.hpp>
#include <opencv2\highgui\highgui.hpp>
#include <opencv2\opencv.hpp>
using namespace std;
using namespace cv;

int main(){
    cv::Mat frame,frame32f;
    char filename[40];
    cv::Mat mean;
    const int count =10;
    const int width  = 1920;
    const int height = 1080;
    cv::Mat resultframe = cv::Mat::zeros(height,width,CV_32FC3);
    for(int i = 1 ; i<= count; i++){
        sprintf(filename,"d:\\BMdvideos\\images\\image%d.tiff",i);
        frame = imread(filename,CV_LOAD_IMAGE_COLOR);
        frame.convertTo(frame32f,CV_32FC3);
        resultframe +=frame32f;
        cout << " i = " << i<<endl;
        frame.release();
    }
    resultframe *= (1.0/count);

    imshow("",resultframe);
    waitKey(0);
    return 0;
} 
```

我在 imshow 中总是得到一个白框，不知道为什么我会得到这个。在此先感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T15:56:01.030

您的问题可能是标准 RGB 图像使用无符号字符值，因此范围为 [0,255]。我相信浮动图像预计在 [0,1] 范围内，所以尝试这样做：

`resultframe *= (1.0/count/255)`

# vbscript - 通过 VBS 脚本在 PowerPoint 2013 中打开演示文稿

> ID：14857493
> 
> 赞同：1
> 
> 时间：2013-02-13T15:53:46.150
> 
> 标签：vbscript, powerpoint

此 VBS 可与 PowerPoint 2010、2003 配合使用

```
Set pptApp = CreateObject("Powerpoint.Application")
pptApp.Visible = True
pptApp.WindowState = 2
Set ppt = pptApp.Presentations.Open("c:\temp\test.pptx") 
```

但是 PowerPoint 2013 的最后一行有问题

```
Unspecified error 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-13T15:57:32.693

如果缺少某些特权，则会发生此错误。在此文件的属性-> 安全性中检查它。

另请注意，Microsoft 已开始使用 Visual Studio for Applications 而不是 VBA，因此不再推荐使用 VBA。

# java - 使用 Ant 在远程服务器上执行 java 主类

> ID：14857496
> 
> 赞同：1
> 
> 时间：2013-02-13T15:53:54.840
> 
> 标签：java, ant

我需要将一些 .class 文件复制到远程服务器并使用 ANT 脚本执行主类文件。我可以使用 SCP ant 目标复制文件，但我被困在执行哪个任务以在远程服务器上运行主类。主类也接受几个参数来执行。任何人都可以提供有关如何实现相同目标的任何指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:18:09.217

你试过[SSHEXEC](http://ant.apache.org/manual/Tasks/sshexec.html)吗？

```
<sshexec host="somehost"
username="dude"
password="yo"
command="java YourClass args"/> 
```

远程服务器上需要安装 JRE。

# php - 如何在 PHP 中取消设置 $_SESSION 数组中未选中的复选框值

> ID：14857499
> 
> 赞同：0
> 
> 时间：2013-02-13T15:54:03.037
> 
> 标签：php, session, pagination

我正在使用 PHP 进行分页，并且有下一页和上一页提交按钮，因此如果用户在第 1 页检查 2 个值，我将其存储在会话变量中，当他返回时，我使用`in_array`并回显该值。但是如果用户取消选中，我如何取消设置数组中的值？如果用户未选中该复选框，则无法取消设置会话数组中的值。

我想我的解释很清楚，但如果有些人需要代码而不是这里

```
if(!empty($_POST['rec_num'])) {
        if(empty($_SESSION['checks_selected_for_records'])) {
               //If session array is empty than directly add all record numbers in
               //this session
           $_SESSION['checks_selected_for_records'] = $_POST['rec_num'];
       }
        //If a new value is seen and is not in array than add it            
       foreach ($_POST['rec_num'] as $check_rec_num) {
        if(!in_array($check_rec_num, $_SESSION['checks_selected_for_records'])) {
           array_push($_SESSION['checks_selected_for_records'], $check_rec_num);
       }
   }
} 

//Handle Redirects For Pagination
if (isset($_POST['next_page']) || isset($_POST['last_page']) || isset($_POST['first_page']) || isset($_POST['previous_page'])) {
        if(isset($_POST['next_page_link'])) {
            redirect_to($_POST['next_page_link']);
        } elseif (isset($_POST['last_page'])) {
            redirect_to($_POST['last_page_link']);
        } elseif (isset($_POST['first_page'])) {
            redirect_to($_POST['first_page_link']);
        } elseif (isset($_POST['previous_page'])) {
            redirect_to($_POST['previous_page_link']);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:59:53.520

使用 array_search 从数组中删除一个值

```
if(($key = array_search($del_val,  $_SESSION['checks_selected_for_records'])) !== false) {
   unset($_SESSION['checks_selected_for_records'][$key]);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:01:08.077

就像是：

```
<form action="" method="POST">
  <input type="checkbox" name="mycheckbox">
</form>

<?php
  $_SESSION['mycheckbox'] = isset($_POST['mycheckbox']);
// OR
  if( ! isset($_POST['mycheckbox']) ) {
    unset($_SESSION['mycheckbox']);
  } else {
    $_SESSION['mycheckbox'] = $_POST['mycheckbox'];
  } 
```

# forms - 当用户离开页面而不在 Omnitrue 中提交表单时，如何将归档编号设置为道具？

> ID：14857508
> 
> 赞同：1
> 
> 时间：2013-02-13T15:54:30.173
> 
> 标签：forms, adobe-analytics

我是 Omniture 实施的新手。我现在有一个任务，我有点迷失了。

在表单页面中，我需要能够为表单中的每个字段设置一个唯一编号，并且当用户关闭页面而不填写所有字段时。我需要知道最后一个有信息的文件的数量，并将这个值填充到一个道具中。有可能吗？如果是这样，任何人都可以为我解释一下吗？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:14:29.367

“归档”是什么意思？你谈论表单域？如果我了解您的需求，您希望遵循表单的提交率并保存每个字段的相关值吗？

因此，您需要创建和 eVar 来填充表单名称。

要遵循转换率：

此 eVar 需要出现在表单页面和提交确认页面上。2 个事件：一个用于表单页面，另一个用于提交确认页面。

捕捉填写表格的价值：

每个字段 1 个道具，填充在提交确认页面上。

根据技术背景和流量，您将应用特定的 JavaScript 解决方案。

希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-07T16:07:40.527

向您的 Adob​​e Analytics 实施顾问咨询有关插件表单分析的信息。它应该做你想做的事。

它会自动拦截任何退出页面的访问者 qith 没有单击提交按钮的表单，并将发送到 adobe 与他交互的最后一个输入。

克劳迪奥。

# python - 禁用 PyYAML 值转换

> ID：14857512
> 
> 赞同：15
> 
> 时间：2013-02-13T15:54:37.110
> 
> 标签：python, python-2.7, yaml, pyyaml

我刚刚开始使用**PyYAML**转换一些数据。

我只是使用这个`yaml.load`函数，它对我来说已经足够好了，直到我注意到它试图将所有值转换为 uni-coded string、int、dates 等等。

这在我的应用程序中可能是致命的，有没有办法避免这种转换？我想以字符串的形式接收所有内容。我查看了构造函数，找不到禁用此转换的方法。

更新：我得到的`yaml.load`是一个`OrderedDict`，一切看起来都很好。唯一的问题是有些值是字符串，有些是整数。我想将所有值都作为字符串。我不希望 pyyaml 为我转换值。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-13T21:32:51.970

好吧，您可以使用`Loader=yaml.BaseLoader`将所有内容保留为字符串：

```
>>> x = [[1,2,3], {1:2}]
>>> s = yaml.dump(x)
>>> s
'- [1, 2, 3]\n- {1: 2}\n'
>>> yaml.load(s)
[[1, 2, 3], {1: 2}]
>>> yaml.load(s, Loader=yaml.BaseLoader)
[[u'1', u'2', u'3'], {u'1': u'2'}] 
```

# jquery - 动态背景图片 jquery

> ID：14857520
> 
> 赞同：2
> 
> 时间：2013-02-13T15:55:03.083
> 
> 标签：jquery, html, css

我想`<h2>`用 jQuery 动态更改所有背景位置，然后将`<h2>`大小更改为 100%。我的代码如下：

CSS：

```
h2 { display: inline-block;} 
```

jQuery：

```
$("h2").css("background-position", "0px 0px").animate({
    'background-position-x': $(this).width(),
    'background-position-y': "3px",
    'width': "100%"
}); 
```

但是`$(this)`不起作用，因为这不是一个功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:59:46.307

```
$("h2").css("background-position","0px 0px").each( function() {
  var h2 = $(this);
  h2.animate({
    'background-position-x': h2.width(),
    'background-position-y': "3px",
    'width': "100%"
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:59:47.843

您需要使用显式循环：

```
$("h2").each(function () {
    $(this).css("background-position", "0px 0px");
    $(this).animate({
        'background-position-x': $(this).width() + "px",
        'background-position-y': "3px",
        'width': "100%"
    });
}); 
```

# android - 检测彩信已被删除

> ID：14857527
> 
> 赞同：0
> 
> 时间：2013-02-13T15:55:16.460
> 
> 标签：android, mms, contentobserver

有没有办法检测到 MMS 消息已从本机消息传递客户端中删除？现在我有一个观察者注册`Mms.CONTENT_URI`但`onChange`没有被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T10:11:50.000

注册并从收到的意图`BroadcastReceiver`中获取已删除的消息：`Mms.Intents.CONTENT_CHANGED_ACTION``Uri`

```
Uri u = (Uri)intent.getExtras().get(Mms.Intents.DELETED_CONTENTS); 
```

# vpython - 将 VPyhon 的图像导出为 JPEG 格式

> ID：14857531
> 
> 赞同：0
> 
> 时间：2013-02-13T15:55:27.173
> 
> 标签：vpython

我正在使用 VPython 创建一些静态（非动画）3D 几何图形，例如圆柱阵列或圆环。我想将它们保存为 .jpeg 格式或 .png 格式，以便我可以放入我的 PPT 中进行演示。是否有可能做到这一点？或者我应该转向 Mayavi 等其他工具吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T01:10:34.507

我认为最简单的方法可能是将其显示在屏幕上，然后截屏。在Mac上，那是`command + shift + 4`，不确定Windows。

# ios - iOS使用数组名称作为plist中的标签文本

> ID：14857535
> 
> 赞同：0
> 
> 时间：2013-02-13T15:55:38.590
> 
> 标签：ios, uitableview, plist

我目前有一个看起来像这样的 plist 文件：

```
<plist version="1.0">
<dict>
    <key>Hello</key>
    <array/>
    <key>Hi</key>
    <array/>
</dict>
</plist> 
```

用户可以添加更多的键。我需要能够将这些键用作 TableView 中的标签。TableView 已准备就绪并已设置。我只需要能够抓取每个数组并将其用作标签。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:02:16.997

从 plist 加载 NSDictionary，然后获取所有`[dictionary allKeys]`在您的情况下返回字符串数组的键。请注意，该字典不保存键的顺序。因此，如果您想每次都显示同一张表，则必须将键分别保存在数组中或对其进行排序。

# jquery - 创建动态表单，但如何进行查询？

> ID：14857537
> 
> 赞同：1
> 
> 时间：2013-02-13T15:55:46.960
> 
> 标签：jquery, sql, coldfusion

我创建了一个动态表单，允许您修改所需的输入字段数量。这是因为他们可能有 15 个乐队成员并且需要 15 个字段，或者一个乐队可能有 2 个。我唯一的问题是提交表单时，每个输入都被命名为“memberName1”、“membername2”等。完成使用 jQuery。我将如何在运行查询时/之前运行检查以查看这些字段是否已填充以及它们是否要将它们的值输入到数据库中？谢谢。

**编辑1：**

我在想类似下面的代码。但是我需要运行一个循环来计算名称为 的所有当前字段`memberName`，后跟一个数字。与其在第一个空旷的地方停下来，不如把它们都跑一遍。如果值为空白，则什么也不做。如果它有一个值，则将其插入我的表中。

```
<cfquery datasource="exampledatasource" name="insertbandmembers">
  Insert Into members(members_name)
  Values (memberName#i#)
</cfquery> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:43:46.977

我会做这样的事情：

```
<cfloop list="#form.fieldnames#" index="ThisElement">
    <cfif left(ThisElement, 10) is "memberName">
       <cfset ThisValue = form[ThisElement]>

       <cfif len(ThisValue)>
           <cfquery name="AddRecord">
              Insert Into members(members_name)
              Values 
              ( <cfqueryparam cfsqltype="cf_sql_varchar" value="#ThisValue#"> )
           </cfquery>
       </cfif>  <!--- len(thisvalue) --->

    </cfif>  <!--- left(ThisElement, 10) is "memberName" --->
</cfloop> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T18:46:06.733

*（这开始是一个评论，但它太长了..）*

有不同的方法来处理它。我的偏好是[评论中提到的特拉维斯](https://stackoverflow.com/questions/14857537/creating-a-dynamic-form-but-how-to-do-the-query/14858413#comment20828854_14858413)。基本上让 jquery 将成员总数存储在隐藏的表单字段中。然后使用该值循环访问成员字段、验证值并根据需要插入。

您可以轻松地修改[Dan](https://stackoverflow.com/a/14859684/104223)或[jamckinn](https://stackoverflow.com/a/14858413/104223)的示例来执行此操作。注意到他们`<cfqueryparam>`用来帮助​​防范 sql 注入了吗？此外，由于这些是相关的插入，您希望将整个内容包装在一个`<cftransaction>`. 这确保了插入物被视为一个单元。他们要么都成功，要么都失败——一起。

```
 <cfparam name="form.totalFields" default="0" >

    <cfloop from="1" to="#val(form.totalFields)#" index="x">
        <!--- extract current name --->
        <cfset memberName = trim(FORM["memberName"& x])>

        <!--- insert NON-empty values --->
        <cfif len(memberName)>
            <cfquery datasource="exampledatasource" name="insertbandmembers">
                INSERT INTO members ( members_name )
                VALUES 
                ( 
                   <cfqueryparam value="#memberName#" cfsqltype="cf_sql_varchar"> 
                )
            </cfquery>
        </cfif>
   </cfloop> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T16:39:06.800

使用静态数字循环，但一旦未传递序列中的数字就会中断。您还可以计算 jQuery 中的数字字段并将其与表单提交一起传递

```
<cfquery datasource="exampledatasource" name="insertbandmembers">
  INSERT Into members(members_name)
  VALUES
  <cfloop index="i" from="1" to="15">
    <cfif structKeyExists(form, 'memberName#i#') AND len(form['memberName#i#'])>
      <cfif i neq 1>, </cfif>
      ( <cfqueryparam cfsqltype="cf_sql_varchar" value="#form['memberName#i#']#"> )
    <cfelse>
      <cfbreak> 
    </cfif> 
  </cfloop>
</cfquery> 
```

# ssis - 为什么脚本任务代码不为 ReadWriteVariables 分配任何值？

> ID：14857540
> 
> 赞同：1
> 
> 时间：2013-02-13T15:55:50.140
> 
> 标签：ssis

我正在尝试为*`User::PrevMonth`*数据类型*`String`*的变量赋值，*`Script Task`*但没有设置任何值。该变量尚未在*`Variables`*属性窗格中设置为任何值。

![变量](../Images/c44424fd3d8b8e9ca28b909428b7548c.png)

我的脚本任务已在我的*Control Flow*中设置。在*Script Task*的属性中，我将两个变量设置为*`ReadWriteVariables`*. 另一个变量似乎工作正常，它们被声明为*`Int32`*

![脚本任务编辑器](../Images/7b9f09d862ab3d886412955f4531c491.png)

### 这是我的脚本任务代码：

```
/*
   Microsoft SQL Server Integration Services Script Task
   Write scripts using Microsoft Visual C# 2008.
   The ScriptMain is the entry point class of the script.
*/

using System;
using System.Data;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;

namespace ST_7206cd3a4d734228b8d6860bdb6a59c9.csproj
{
    [System.AddIn.AddIn("ScriptMain", Version = "1.0", Publisher = "", Description = "")]
    public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
    {
        #region VSTA generated code
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion
        public void Main()
        {
            //This will get the year as an int (e.g. 2013)
            DateTime dLastYear = DateTime.Today.AddYears(-1);
            int iLastYear = dLastYear.Year;

            //This will get the month as an str (e.g. 04)
            DateTime dLastMonth = DateTime.Today.AddMonths(-1);
            string sLastMonth = dLastMonth.ToString("MM");

            //Assign variables back to SSIS package
            Dts.Variables["User::PrevMonth"].Value = sLastMonth;
            Dts.Variables["User::Year"].Value = iLastYear;

            //Return package success
            Dts.TaskResult = (int)ScriptResults.Success;
        }
    }
} 
```

String 数据类型的变量在成功执行包后不会改变它的值。这真的让我很烦恼，我觉得我已经检查了所有内容。

谁能发现我错过了什么？我猜这真的很愚蠢/很明显。

### 更新：

我已经*`Message Box`*在内部使用`Script Task`来查看变量值，它们正在显示正确的输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:22:45.527

### 如何在 BIDS 中查看在多个包作用域下声明的变量

这是对您的评论的回应和***`not`***对您的问题的回答。

```
How do I check for two copies of variables being defined? 
I did delete the variable and re-add. I've screenshotted my variable window. 
```

这是一个在*`BIDS 2008 R2`*. 该包有一个*`Script Task`*. 我在不同的范围内声明了两个变量，但名称相同**`PrevMonth`**

*   *第一个*变量在包作用域下声明**`SO_14857540`**
*   *第二个*变量在任务范围下声明**`Script Task`**

选择包时，变量窗格将仅显示在包范围内声明的包变量。

![包变量](../Images/4fa0914d050fc30e7ac2665e5ff4d7fb.png)

要查看在不同范围内声明的所有变量，请单击属性窗格上的*第四个*图标。*`Variables`*它应该有工具提示文本**`Show All Variables`**。

![所有变量](../Images/5f9819e139f1796b9d09d607255dbe29.png)

但是，这*可能*是变量值“不”发生变化的原因。PrevMonth 范围为 SO_14857540，因此对整个包可见。范围为“脚本任务”的 PrevMonth。当脚本任务执行时，本地范围的变量将是可见的。您的脚本任务将更改本地范围变量的值，然后*该*变量超出范围，只保留包范围变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T16:34:51.730

简单地建立在我对变量窗口与本地人的评论之上

> 您如何确定没有设置这些值？似乎是一个愚蠢的问题，我知道，但变量窗口中变量的值在执行期间不会改变。那是设计时的事情。实际值可从 Debug、Windows、Locals 菜单的 Locals 窗口获得。在那里展开变量，然后您可以检查运行时值

给定一个像这样简单的包

![简单的控制流，脚本任务到脚本任务](../Images/4441113dcd239962e206a00e0e1e7583.png)

这是一个示例，显示了我的包中的*实际*值与“变量”窗口中*仍然报告的值。*从技术上讲，我在这两个变量上设置了一个 Watch，因为实际的 Locals 窗口中有很多“噪音”，其中包含所有系统变量。

![观察与变量窗口](../Images/89ac50cbfe8b4a010e1826081b524dfc.png)

局部变量窗口的示例

![当地人窗口](../Images/104e73c2e75773dcf0350cb07f32fb6e.png)

因此，我看到并且我认为 Siva（现在的 user756519）同意您的脚本正在运行并在运行时正确地将值分配给变量，因此您的包中可能还有其他问题。可能是您没有使用您认为的那些变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-11T17:10:08.690

今天遇到这样的问题，我发现如果变量有一个表达式（在我的例子中，它是脚本任务在某些情况下更改的默认值），表达式总是会覆盖您写入变量的任何内容：删除表达式和脚本任务正确设置值。

# ruby-on-rails - Ruby on Rails - Sunspot Solr 搜索配置

> ID：14857544
> 
> 赞同：1
> 
> 时间：2013-02-13T15:55:53.817
> 
> 标签：ruby-on-rails, ruby, configuration, solr, sunspot

我在我的 Ruby on Rails 项目中配置了 Sunspot/Solr，它运行良好。因此，它的响应时间很棒，它可以快速找到记录。

但是我有两个问题/问题无法解决，也找不到任何信息或解释。

a) 我想知道如何更改引擎行为，例如当我搜索“windows”时，我可以找到包含该词的所有记录。但是，如果我搜索“窗口”，则不会返回任何记录。有没有办法改变任何参数来改变这种行为？

b）我想知道如果我实现了一些文件上传脚本或实用程序，我将能够索引这些相关文件，我的意思是，如果我上传附加到记录的 PDF（使用 ActiveRecord）。Solr/Sunspot 是否能够索引并找到它。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T10:33:23.370

我可以从 Solr 角度提供答案，检查您是否可以将其映射到 Sunspot api 中：-

1.  对于窗口和窗口搜索，您需要在您的字段上启用[词干提取。](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#Stemming)词干会减少单词的词根，并允许您始终将结果与词根匹配。检查如何向 Sunspot 中定义的字段添加过滤器，或者您可以在配置了词干过滤器的 schema.xml 中定义文本字段。

2.  Solr[提取处理](http://wiki.apache.org/solr/ExtractingRequestHandler)程序提供了使用丰富文档和解析内容的能力。Solr 使用 apache Tika 底层，可以解析大部分富文档格式。只需在 Sunspot 中检查匹配的 api。我知道 Solrj 为此提供了一个简单的 api。

# c# - stack oftype<> 选项如何工作

> ID：14857552
> 
> 赞同：-6
> 
> 时间：2013-02-13T15:56:10.407
> 
> 标签：c#, asp.net

谁能告诉我如何使用`stack.ofType<>`？我已经尝试了很多次，但无法做到这一点。

```
private void button2_Click(object sender, EventArgs e)
{
    Stack st = new Stack();
    st.Push("joginder");
    st.Push("singh");
    st.Push("banger");
    st.Push("Kaithal");
    st.OfType<>  //how to work this option
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T15:59:55.307

使用泛型`Stack<T>`类型而不是`Stack`，这样您将获得特定类型的堆栈，并且您不必转换从中读取的值：

```
Stack<string> st = new Stack<string>();
st.Push("joginder");
st.Push("singh");
st.Push("banger");
st.Push("Kaithal"); 
```

现在，当您从堆栈中弹出某些内容或遍历这些项目时，它已经是一个字符串，您不必强制转换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:04:54.470

您提供这样的类型

```
st.OfType<string>() 
```

这将返回一个 IEnumerable 供您进行迭代，而不会从堆栈中弹出任何项目。

鉴于此代码：

```
 Stack st = new Stack();
        st.Push("joginder");
        st.Push("singh");
        st.Push("banger");
        st.Push("Kaithal");
        st.Push(1);
        st.Push(1.0);

        foreach (var name in st.OfType<string>())
        {
            Console.WriteLine(name);
        } 
```

你会得到这个输出：

```
 joginder
 singh
 banger
 Kaithal 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:05:59.243

这里有一个很好的例子：http: [//msdn.microsoft.com/en-us/library/bb360913.aspx](http://msdn.microsoft.com/en-us/library/bb360913.aspx)，但是，基本上你可以使用 OfType 来创建该特定类型的项目的 IEnumerable，例如如果您的代码为：

```
 Stack st = new Stack();
        st.Push("joginder");
        st.Push(1.4);
        st.Push("singh");
        st.Push("banger");
        st.Push(2.8); 
        st.Push("Kaithal");

        IEnumerable<String> strings = st.OfType<String>();  //how to work this option
        IEnumerable<double> doubles = st.OfType<double>(); 
```

将创建“列表”，一个包含堆栈中的所有字符串，一个包含所有双打。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:06:24.983

使用`generics`和`Stack<T>`：

```
private void button2_Click(object sender, EventArgs e)
    {
        Stack<string> st = new Stack<string>();
        st.Push("joginder");
        st.Push("singh");
        st.Push("banger");
        st.Push("Kaithal");
 } 
```

你也可以这样做：

```
public class Client {
    public string Name { get; set; }
}

private void button2_Click(object sender, EventArgs e)
{
        Stack<Client> st = new Stack<Client>();
        st.Push(new Client { "joginder" });
        st.Push(new Client { "singh" });
        st.Push(new Client { "banger" });

} 
```

请注意，类 Client 是为了演示如何`T`替换您分配的类型。

# objective-c - 从多个注释中获取距离

> ID：14857554
> 
> 赞同：1
> 
> 时间：2013-02-13T15:56:14.260
> 
> 标签：objective-c, cocoa-touch, ios6, core-location, mapkit

我一直在尝试几天，并在网上搜索试图解决我的问题，但我找不到任何相关信息。

我正在尝试使用 CustomCell 计算从 userLocation 到 UITableView 中我的注释的距离。

我能够在 NSLOG 中获得计算出的距离，但在我的 tableView 中，我的所有单元格都获得了 0.0 公里。

谁能看到我在这里做错了什么？

```
 - (void)viewDidLoad
{
    [super viewDidLoad];

    self.mapView.delegate = self;
    [self startLocationServices];

    NSString *path = [[NSBundle mainBundle] pathForResource:@"points" ofType:@"plist"];
    NSArray *anns = [NSArray arrayWithContentsOfFile:path];

    for(NSMutableDictionary *note in anns) {
        double doubleLatitude = [[note objectForKey:@"sculptureLatitudeKey"] doubleValue];
        double doubleLongitude = [[note objectForKey:@"sculptureLongitudeKey"] doubleValue];
        Annotation* myAnnotation = [[Annotation alloc] init];
        CLLocationCoordinate2D theCoordinate;
        theCoordinate.latitude = doubleLatitude;
        theCoordinate.longitude = doubleLongitude;
        myAnnotation.coordinate = theCoordinate;
        myAnnotation.title = [note objectForKey:@"sculptureNameKey"];
        myAnnotation.subtitle = [note objectForKey:@"sculptureAddressKey"];
        myAnnotation.sculptureIdKey = [note objectForKey:@"sculptureIdKey"];
        [self.mapView addAnnotation:myAnnotation];
    }
}

- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation
{
    MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(userLocation.coordinate, 5000, 5000);
    [self.mapView setRegion:[self.mapView regionThatFits:region] animated:YES];
}

- (void)startLocationServices
{
    if (self.locationManager == nil)
    {
        self.locationManager = [CLLocationManager new];
    }
    [self.locationManager setDelegate:self];
    [self.locationManager setDesiredAccuracy:kCLLocationAccuracyBest];
    [self.locationManager setDistanceFilter:kCLDistanceFilterNone];

    [self.locationManager startUpdatingLocation];
}

- (void)stopLocationServices
{
    [self.locationManager stopUpdatingLocation];
    [self.locationManager setDelegate:nil];
}

- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation
{    
    for (Annotation *annotation in self.mapView.annotations)
    {
        CLLocationCoordinate2D coord = [annotation coordinate];
        CLLocation *annLocation = [[CLLocation alloc] initWithLatitude:coord.latitude longitude:coord.longitude];

        CLLocationDistance calculatedDistance = [annLocation distanceFromLocation:newLocation];
        NSLog(@"Nice distance:%.1f m\n", calculatedDistance);
    }
} 
```

我的 NSLOG 显示了这一点，而我的 .plist 中只有 3 个注释

```
2013-02-13 16:46:14.736 TalkingSculpture[91833:c07] Nice distance:762.1 m
2013-02-13 16:46:14.736 TalkingSculpture[91833:c07] Nice distance:98.8 m
2013-02-13 16:46:14.736 TalkingSculpture[91833:c07] Nice distance:2704.3 m
2013-02-13 16:46:14.737 TalkingSculpture[91833:c07] Nice distance:0.0 m 
```

我的 customCell.h

```
#import <UIKit/UIKit.h>

@interface customCell : UITableViewCell

@property (weak, nonatomic) IBOutlet UILabel *customTitle;
@property (weak, nonatomic) IBOutlet UILabel *customSubTitle;
@property (weak, nonatomic) IBOutlet UILabel *distanceLabel;

@end 
```

和 customCell.m

```
#import "customCell.h"

@implementation customCell

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

@end 
```

在表格视图中，我填充了 cellForRowAtIndexPath

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{    
    static NSString *CellIdentifier = @"Cell";
    customCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    if (!cell)
    {
        cell = [[customCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }
    cell.customTitle.text = [[self.locationsArray objectAtIndex:indexPath.row] valueForKey:@"sculptureNameKey"];
    cell.customSubTitle.text = [[self.locationsArray objectAtIndex:indexPath.row] valueForKey:@"sculptureAddressKey"];
    cell.distanceLabel.text = [NSString stringWithFormat:@"%.1f km\n", _calulatedDistance];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:42:22.277

不知道你是否还需要这个问题的答案。但是每次显示表格视图时，您都需要填充一个数组（或替代）来保存所有当前距离。然后在 cellForRowAtIndexPath 中将标签设置为与该数组的适当距离。您在此代码中所做的是将它设置为 ivar，当您调用它时，它是 nil 或 0。

# java - 如何手动创建 SiftingAppender

> ID：14857558
> 
> 赞同：2
> 
> 时间：2013-02-13T15:56:33.097
> 
> 标签：java, logback

我想手动管理 logback 配置——特别是我想在必要时创建一个具有 FileAppender 的新 SiftingAppender。

我尝试创建所有对象以复制我之前使用过的相同 XML 配置。不幸的是，我不明白如何将 fileappender 附加到 siftappender。

这是我正在使用的代码：

```
LoggerContext loggerContext = (LoggerContext) LoggerFactory.getILoggerFactory();

PatternLayoutEncoder encoder = new PatternLayoutEncoder();
encoder.setContext(loggerContext);
encoder.setPattern("&lt;%d(yyyy-MM-dd HH:mm:ss)&gt; | %.-1level | %msg %n");
encoder.start();

FileAppender<ILoggingEvent> fAppender = new FileAppender<ILoggingEvent>();
fAppender.setContext(loggerContext);
fAppender.setName(application + "_" + user);
fAppender.setFile(logUser);
fAppender.setAppend(true);
fAppender.setEncoder(encoder);
fAppender.start();

MDCBasedDiscriminator discriminator = new MDCBasedDiscriminator();
discriminator.setKey("userid");
discriminator.setDefaultValue("unknown");
discriminator.start();

LevelFilter lFilter = new LevelFilter();
lFilter.setLevel(Level.INFO);
lFilter.start();

// **HOW TO ATTACH fAppender on sAppender ????**
SiftingAppender sAppender = new SiftingAppender();
sAppender.setContext(loggerContext);
sAppender.setName(application + "_" + user + "_SIFTING");
sAppender.addFilter(lFilter);
sAppender.setDiscriminator(discriminator);
sAppender.start();

Logger logger = loggerContext.getLogger("test.mypackage");
logger.setAdditive(false);
logger.setLevel(Level.ALL);
logger.addAppender(sAppender); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-25T11:02:05.490

您必须创建一个 appenderFactory 并将这个工厂添加到 siftingAppender ：

```
 SiftingAppender siftAppender = new SiftingAppender();

    AppenderFactory<ILoggingEvent> appenderFactory = new AppenderFactory<ILoggingEvent>() {

        @Override
        public Appender<ILoggingEvent> buildAppender(Context context, String discriminatingValue) throws JoranException {
            /* Create your file appender here, with what ever options you need */

            PatternLayoutEncoder ple = new PatternLayoutEncoder();
            ple.setPattern("%date %level [%thread] %logger{10} [%file:%line] %msg%n");
            ple.setContext(context);
            ple.start();
            FileAppender<ILoggingEvent> fileAppender = new FileAppender<ILoggingEvent>();
            fileAppender.setFile(file);
            fileAppender.setEncoder(ple);
            fileAppender.setContext(context);
            fileAppender.start();

            return fileAppender;
        }
    };

    /* set your factory to the sifting appender */
    siftAppender.setAppenderFactory(appenderFactory );
    siftAppender.setContext(context);
    siftAppender.setName("TMP");
    siftAppender.start();

    logger.addAppender(siftAppender);
    logger.setAdditive(true); 
```

# properties - WiX：将属性传递给自定义操作，已经查看过 SO，*仍然*不起作用:(

> ID：14857559
> 
> 赞同：0
> 
> 时间：2013-02-13T15:56:38.957
> 
> 标签：properties, wix, custom-action

我究竟做错了什么？？

请，如果您的回答是我应该使用内置服务在 WiX 中安装东西，请不要打扰回答。它对我来说不是很好*，我*不想将 XSLT 转换应用于我的 HEATed .wxs 文件。

根据我的日志，它正在执行两个自定义操作，但 InstallAndStartServices 告诉我“INSTALLFOLDER”不在 session.CustomActionData 字典中。

```
<Binary Id="ServiceInstaller" SourceFile="DeploymentItems\ServiceInstaller.CA.dll" />

<CustomAction Id="SetInstallFolderForCA" Property="InstallAndStartServices" Value="INSTALLFOLDER=[INSTALLFOLDER]" Execute="immediate" Return="check" />
<CustomAction Id="InstallAndStartServices" BinaryKey="ServiceInstaller" DllEntry="InstallAndStartServices" Execute="immediate" Return="check" />

<InstallExecuteSequence>
  <Custom Action="SetInstallFolderForCA" After="InstallFiles">NOT Installed</Custom>
  <Custom Action="InstallAndStartServices" After="SetInstallFolderForCA"/>
</InstallExecuteSequence> 
```

MSI (s) (78:DC) [15:31:47:745]：属性更改：添加 InstallAndStartServices 属性。其值为“INSTALLFOLDER=C:\Program Files\My Product\”。

MSI (s) (78:DC) [15:31:47:745]：执行操作：InstallAndStartServices

MSI (s) (78:DC) [15:31:47:745]: 注意: 1: 2205 2: 3: ActionText

动作开始时间 15:31:47：InstallAndStartServices。

开始安装服务

自定义操作引发的异常：System.Reflection.TargetInvocationException：调用目标已引发异常。---> System.Collections.Generic.KeyNotFoundException：给定的键不在字典中。

在 System.Collections.Generic.Dictionary`2.get_Item（TKey 键）

在 Microsoft.Deployment.WindowsInstaller.CustomActionData.get_Item（字符串键）

```
string installFolder = session.CustomActionData["INSTALLFOLDER"]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:44:18.550

看：

[部署工具基础 (DTF) 托管的自定义操作](http://blog.iswix.com/2008/05/deployment-tools-foundation-dtf-managed.html)

> 注意：为简洁起见，这篇博文将假设读者已经对 Windows Installer 体系结构和理念有深入的了解。我不会尝试完全涵盖 MSI 的声明性和事务性设计目标或不同自定义操作类型的优缺点的肮脏细节。如果您没有这方面的知识，我强烈建议您在为 Windows 安装程序包编写自定义操作之前获得它。

[Windows Installer 中自定义操作的安装阶段和脚本内执行选项](http://www.installsite.org/pages/en/isnews/200108/index.htm)

> 摘要：在 InstallShield Professional - Windows Installer Edition 中创建自定义操作时，您有几个脚本内执行选项可供选择：
> 
> •立即执行
> 
> •延期执行
> 
> •回滚执行
> 
> •提交执行
> 
> •系统中的延迟执行
> 
> 语境
> 
> 本文解释了这些选项的含义以及它们如何影响您的自定义操作在安装运行时执行的哪个阶段。它还可以帮助您将自定义操作插入用户界面中的正确位置或执行顺序，以避免出现“无法写入脚本记录。事务未启动”等错误消息。

# ruby-on-rails-3 - Rails 3：如何从索引页面创建相关记录

> ID：14857560
> 
> 赞同：1
> 
> 时间：2013-02-13T15:56:44.297
> 
> 标签：ruby-on-rails-3

我是 Rails 的新手。随意编辑问题标题。其中一些对您来说可能是显而易见的。（我希望！）

我有一个*拍卖*有很多*很多*（待售物品）。
我已经设置了拍卖，我可以添加/编辑/删除就好了。

我希望能够从 /auctions/1/lots/ 之类的 URL 的一页中查看/添加/删除很多，所以我设置了我的路线，如下所示：

```
resources :auctions, :except => :edit do
  resources :lots
end 
```

我的模型如下所示：

```
class Auction < ActiveRecord::Base
  ...
  has_many :lots
end

class Lot < ActiveRecord::Base
  belongs_to :auction
  ...
end 
```

我的lots_controller.rb 看起来像这样：

```
def index
  @auction = Auction.find(params[:auction_id])
  @lots = @auction.lots
end 
```

我的很多/index.html.erb 文件：

```
<ul>
<% @lots.each do |lot| %>
  <li><%= lot.description %></li>
<% end %>
</ul> 
```

这使得很多很好。
问题是当我尝试放置一个创建新批次的表格时。我不确定我需要把什么放在哪里。

```
<%= form_for(@auction.lots.build) do |f| %>
  <%= f.input :description %>
<% end %> 
```

在查看页面时添加它会给我以下错误：
`undefined method `lots_path' for #<#<Class:0x007fb77ea26308>:0x007fb77d43fd00>`

我的印象`@auction.lots.build`是放在那里是正确的论点。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:00:37.023

`form_for`正在尝试从新的 Lot 实体推断操作路径（并且失败）。您可以直接指定`:url`：

```
<%= form_for(@auction.lots.build, url: auction_lots_path(@auction)) do |f| %> 
```

或者，传递一个数组以向 form_for 指示此资源是嵌套的：

```
<%= form_for([@auction, @auction.lots.build]) do |f| %> 
```

# google-maps - 通过 google places api 搜索最近的地理对象

> ID：14857562
> 
> 赞同：0
> 
> 时间：2013-02-13T15:56:52.180
> 
> 标签：google-maps, google-places-api

我需要编写一个小程序来搜索某个地理点附近的某些类别的对象（例如机场）。但是地方 API 的半径长度限制为 50 000 米。因此，使用更长的半径似乎没有任何意义。

但是我看到，当我简单地在浏览器中打开谷歌地图并在搜索输入中输入“机场”时，我会得到谷歌在我的浏览器窗口限定的地图区域中找到的所有机场。如果我想要更多机场，我会简单地缩小并接收更大区域的结果。所以谷歌似乎有一些用于这种搜索的工具。

所以问题是 - 我如何使用谷歌地图 API 进行这种搜索，尤其是半径超过 50 000 米的搜索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T18:29:50.787

如果您找到合适的解决方案，请告诉我。但我能想到的解决方法是加载所有机场/类别对象和 setCenter 地理点，并设置足够好的放大，可以从你拥有的地理点聚焦机场/对象附近的一两个。

# javascript - 将对象作为函数参数传递

> ID：14857565
> 
> 赞同：0
> 
> 时间：2013-02-13T15:57:07.500
> 
> 标签：javascript

**基础**

*   一个`toplevelOBJ`对象在整个应用程序中用作`this.toplevelOBJ`，我可以在其中访问它的属性，例如`this.toplevelOBJ.mapArea.coordX`.
*   其中`ClassB`有一个函数调用`blink`，它等待来自外部源的信号。
*   在`ClassC`我需要捕获这个信号，所以我设置了一个函数，`capture`以`ClassC`检索由发送的信号`ClassB`

**问题**

当通过`capture()`函数发送到时`ClassC`， `"this"`in`this.toplevelOBJ`不再指的是`toplevelOBJ`，而是`ClassC`。

因此，我通过函数`this.toplevelOBJ`作为参数发送，但在接收时，我不确定是否正在调用来自的函数：，而我可以访问它的属性：`toplevel``capture()``toplevelOBJ``toplevel.update()``toplevel.mapArea.coordX`

**问题**

通过 an`Object`作为参数发送时，是否`Object`完全相同？因为当我检查 时`Object`，我在 下找到了`update()`函数`toplevel.__proto__.__proto__`，而我立即找到了它的属性：`toplevel.mapArea`

* * *

**代码**

```
// Class in which I am sending the object
var ClassB = exports.ClassB = ClassA.extend({
    blink: function(key, value) {
       ClassC.prototype.capture(key, value, this.toplevelOBJ);
    }
}); 
```

* * *

```
// Class in which I am receiving the object
var ClassC = exports.ClassC = ClassA.extend({
    capture: function(key, value, toplevel) {
        /* Run Function of toplevel */
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:13:51.893

是的，当您将对象作为参数传递时，它完全一样。

它甚至不是对象的精确副本，它实际上*是同一个*对象。参数只是对对象的引用，因此永远不会复制对象。

* * *

属性和方法既可以是对象本身的成员，也可以是原型链中的成员。在您的情况下，`mapArea`属性是对象本身的成员，而`update`方法是原型的成员或作为对象原型的`toplevelOBJ`对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:04:03.957

在类中处理这一点的最常见方法是`this`在实例化时存储正确的。最常见的方法是这样的：

```
function SomeClass
{
 var that = this;
 that.myVariable = 5;

 that.someFunction = function()
 {
    return that.myVariable;
 }
} 
```

您还有包装器/代理方法，例如`bind`下划线库中的函数所解释的，可以“强制”`this`变量。见[http://underscorejs.org/#bind](http://underscorejs.org/#bind)

我更喜欢这两种方法而不是调用者*强制*`this`变量。

# c - 为什么 scanf 没有指向正确的数字？

> ID：14857567
> 
> 赞同：0
> 
> 时间：2013-02-13T15:57:09.420
> 
> 标签：c, scanf

我试图让 scanf 以数字的形式接收用户的输入，然后使用我要求的两个数字来执行一些简单的数学运算，我遇到的问题是，无论我输入什么数字，他们总是只是吐出 1 任何帮助将不胜感激

# 包括

```
 int main(int argc, char const *argv[])
{
float in1,in2,value;
char c;

printf("Enter the operation of your choice:\n");
printf("A. add           S. subtract\n");
printf("M. multiply      D. divide\n");
printf("Q. quit\n");
c=getchar();

while( c !='Q' && c!='q')
{
    printf("please enter your first number:");
    scanf("%g", &in1);
    printf("%g\n",in1 );

    printf("please enter your second number:");
    scanf("%g", &in2);
    printf("%g\n",in2 );

    if(c == 'S' || c =='s')
        if(in2 == 0)
        {
            printf("you have selected subtration however\n");
            printf("the value you entered was 0\n");
            printf("please enter a value greater than 0\n");
            scanf("%lg",&in2);
        }

    if(c == 'a' || c == 'A')
    {
        value = in1+in2;
        printf("%lg + %lg = %lg\n",in1,in2,value );
    }

    if(c == 's' || c == 'S')
    {
        value = in1-in2;
        printf("%lg - %lg = %lg\n",in1,in2,value );
    }   

    if(c == 'm' || c == 'M')
    {
        value = in1*in2;
        printf("%lg * %lg = %lg\n",in1,in2,value );
    }   

    if(c == 'd' || c == 'D')
    {
        value = in1/in2;
        printf("%lg / %lg = %lg\n",in1,in2,value );
    }   
    if (c !='Q' && c !='q')
    {
        printf("Enter the operation of your choice:\n");
        printf("A. add           S. subtract\n");
        printf("M. multiply      D. divide\n");
        printf("Q. quit\n");    
    }
    c=getchar();
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:02:33.900

您能否将您的变量定义为`double`而不是`float`？另外，我觉得您`getchar()`在 while 循环结束时还需要一个。当您第一次输入第二个数字时，回车键被视为`c = getchar()`; 要再次阅读该选项，您必须包含另一个`c = getchar()`.

# wcf - 从 WCF-workflow-service 代码活动调用 wcf 服务

> ID：14857574
> 
> 赞同：0
> 
> 时间：2013-02-13T15:57:25.870
> 
> 标签：wcf, workflow, workflowservice

我有一个 WCF 工作流服务 (xamlx)，其中代码活动由流程图调用。

我添加了对需要调用的 WCF 服务的服务引用。但是这个 WCF 服务的客户端在我需要使用它的代码活动中是不可见的。

相反，客户端出现在工具箱中，因此我只能在工作流中使用它。

但是我希望能够在这样的代码中使用它：

```
ServiceClient proxy = new ServiceClient();
proxy.MyMethod(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T16:05:34.347

现在做同样的事情，这也让我陷入困境。在 WCF 工作流服务项目中，使用添加服务引用指定要调用的服务的地址。

当您重建 WCF 工作流服务项目时，您应该看到为服务方法创建的活动。

将活动放在设计器上并配置参数。

以下是一些相关链接：

[http://blogs.msdn.com/b/endpoint/archive/2010/12/08/how-to-consume-a-wcf-service-from-a-wf4-workflow.aspx](http://blogs.msdn.com/b/endpoint/archive/2010/12/08/how-to-consume-a-wcf-service-from-a-wf4-workflow.aspx)

[http://www.cloudcasts.net/ViewWebcast.aspx?webcastid=2521458133038050447](http://www.cloudcasts.net/ViewWebcast.aspx?webcastid=2521458133038050447)

# java - String.split(String regex) 意外行为？

> ID：14857576
> 
> 赞同：1
> 
> 时间：2013-02-13T15:57:32.797
> 
> 标签：java, string

`String.split(String delim);`行为很奇怪，它返回在每个字符处拆分字符串并返回一个输出，就像`String.toCharArray();`[它让我发疯]

以下是如何重现我的问题：

```
System.out.println(Arrays.toString("CENTURY:a,b,c|HALF_CENTURY:c,d,e".split("|"))); 
```

输出：[, C, E, N, T, U, R, Y, :, a, ,, b, ,, c, |, H, A, L, F, _, C, E, N, T, U, R, Y, :, c, ,, d, ,, e]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T15:58:02.707

`String.split(regex)`接受**正则表达式**。在 regex world `|`is a中`meta character(special character)`，将其转义`\\`以将其视为`normal character`.

```
Arrays.toString("CENTURY:a,b,c|HALF_CENTURY:c,d,e".split("\\|")); 
```

或嵌入其中`character class`，`[|]`

```
Arrays.toString("CENTURY:a,b,c|HALF_CENTURY:c,d,e".split("[|]")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:58:43.503

```
"CENTURY:a,b,c|HALF_CENTURY:c,d,e".split("|"); 
```

这不起作用，因为 split 的参数实际上是一个正则表达式，其中 | 有特殊的意义。

原因是 split() 的参数被编译成正则表达式；并且需要引用正则表达式中的特殊字符

反斜杠一般也是字符串的转义字符，需要加倍

试试这个：

```
"CENTURY:a,b,c|HALF_CENTURY:c,d,e".split("\\|"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T15:58:43.167

尝试

```
split("\\|") 
```

你需要逃避`|`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:03:37.733

您正在寻找`Pattern.quote(String)`. 有关详细信息，请参见[此处](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/regex/Pattern.html#quote%28java.lang.String%29)。

# excel - 根据该行的某个单元格中的值单击某行时是否可以突出显示列？

> ID：14857579
> 
> 赞同：1
> 
> 时间：2013-02-13T15:57:36.807
> 
> 标签：excel, vba

这是我的情况：

当我根据同一行的某个单元格中的值单击一行中的任何单元格时，我想突出显示各个列。

例子：

我点击第 2 行 --> C2 说“蓝色” --> B、D、E、F 列自动以黄色突出显示

这可能吗？（最好不要在每次点击不同的行时重新运行宏）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:52:21.093

实际上，非常简单的 VBA。祝你好运。

```
Option Explicit

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

Dim lngRow As Long, intCol

lngRow = Target.Row

If Cells(lngRow, 3) = "Blue" Then intCol = 6 Else: intCol = 0

Columns(2).Interior.ColorIndex = intCol
Columns(4).Interior.ColorIndex = intCol
Columns(5).Interior.ColorIndex = intCol
Columns(6).Interior.ColorIndex = intCol

End Sub 
```

# hibernate - Hibernate 中是否有一些“删除时”操作由例如孤儿删除或其等价物触发？

> ID：14857586
> 
> 赞同：0
> 
> 时间：2013-02-13T15:57:54.437
> 
> 标签：hibernate, file, storage, orphan

我的模型`SomeFileModel`包含对存储在磁盘上的文件的引用。我想将该文件与一个实体一起保存并同时删除它们。虽然前者并不难，但问题来自后者：`SomeFileModel`与另一个模型多对一关系，`FilesCollectionModel`并用`orphanRemoval = true`.

虽然负责`SomeFileModel`删除该文件的服务，但当我们下令销毁实体时，其他服务（正如预期的那样）不会这样做。当然，我可以让所有模型都有一些`prepareDeleteion()`方法，可以通过级联调用，但我认为这不是最好的方法。

我的问题是：是否有一些注释或其他约定可以标记方法，以便在实体删除时调用？它甚至可能吗？或者我应该使用其他一些解决方案，例如“孤立文件收集器”，它会删除数据库中没有引用的文件，或者那个丑陋的级联方法调用？什么方法是最好的？

如果有帮助，我会使用 Hibernate 4 和 Spring Framework 3.1.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:44:10.617

是的，简短的回答是 [拦截器和事件](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#events)

根据休眠文档：

**拦截器**：

```
 The Interceptor interface provides callbacks from the session to the app, 
 allowing the application to inspect and/or manipulate properties of a
 persistent object before it is saved, updated, deleted or loaded. 
```

**活动：**

```
The event system can be used in addition, or as a replacement, for interceptors.
All the methods of the Session interface correlate to an event.
You have a LoadEvent, a FlushEvent, etc. 
```

# windows - Eclipse外windows下运行SWT APP

> ID：14857592
> 
> 赞同：1
> 
> 时间：2013-02-13T15:58:07.573
> 
> 标签：windows, swt, launching-application

我正在尝试构建一个包来在 Eclipse 之外运行我的 SWT 应用程序。

在 linux 下，我已经成功地在 bash 下运行。但是当我尝试在 windows 下运行时，出现以下错误：

C:\nanoffline>java -cp "SebraeNaNOffline_lib_win_x86/*" -jar SebraeNaNOffline.jar 线程“main”java.lang.UnsatisfiedLinkError 中的异常：无法在 org.eclipse.swt 的 32 位 JVM 上加载 64 位 SW T 库。 internal.Library.loadLibrary(Library.java:214) at org.eclipse.swt.internal.Library.loadLibrary(Library.java:194) at org.eclipse.swt.internal.C.(C.java:21) at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:63) at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:54) at org.eclipse.swt.widgets.Display.(Display .java:132) 在 br.com.infosolo.sebrae.nanoffline.IniciarOffline.(IniciarOffline.java:31)

我已经尝试指定参数-Djava.library.path，把SWT的DLLs放到windows、windows/system、windows/system32...

我正在使用以下 SWT JAR（随 eclipse 32 位 Windows 发行版一起提供：org.eclipse.swt.win32.win32.x86_3.100.1.v4234e.jar

类路径下的完整jar列表：

> antlr-2.7.7.jar com.ibm.icu_4.4.2.v20110823.jar commons-beanutils-1.8.3.jar commons-collections-3.2.1.jar commons-digester-1.8.jar commons-lang-2.5.jar commons-logging-1.1.1.jar dom4j-1.6.1.jar hibernate-commons-annotations-4.0.1.Final.jar hibernate-core-4.1.9.Final.jar hibernate-entitymanager-4.1.9.Final。 jar hibernate-jpa-2.0-api-1.0.1.Final.jar iText-2.1.7.jar jasperreports-4.8.0.jar jasperreports-fonts-4.8.0_0.jar javassist-3.17.1-GA.jar jboss- logging-3.1.0.GA.jar jboss-transaction-api_1.1_spec-1.0.0.Final.jar org.eclipse.core.commands_3.6.0.I20110111-0800.jar org.eclipse.core.databinding.beans_1.2.100 .I20100824-0800.jar org.eclipse.core.databinding.observable_1.4.0.I20110222-0800.jar org.eclipse.core.databinding.property_1.4.0.I20110222-0800.jar org.eclipse.core.databinding_1.4.0。 I20110111-0800.jar org.eclipse。core.runtime_3.7.0.v20110110.jar org.eclipse.equinox.common_3.6.0.v20110523.jar org.eclipse.equinox.registry_3.5.101.R37x_v20110810-1611.jar org.eclipse.jface.databinding_1.5.0.I20100907-0800 .jar org.eclipse.jface.text_3.7.2.v20111213-1208.jar org.eclipse.jface_3.7.0.v20110928-1505.jar org.eclipse.nebula.widgets.formattedtext_1.0.0.201301250959.jar org.eclipse.osgi_3 .7.2.v20120110-1415.jar org.eclipse.swt.win32.win32.x86_3.100.1.v4234e.jar org.eclipse.swt_3.100.1.v4234e.jar org.eclipse.text_3.5.101.v20110928-1504.jar org .eclipse.ui.forms_3.5.101.v20111011-1919.jar org.eclipse.ui.workbench_3.7.1.v20120104-1859.jar sqlite-jdbc-3.7.15-SNAPSHOT.jar swt-awt-win32-4234.dll swt -gdip-win32-4234.dll 77.824 swt-webkit-win32-4234.dll swt-wgl-win32-4234.dll swt-win32-4234.dll swt-xulrunner-win32-4234.dll 焊接核心。jar 焊接-se.jar

* * *

我试图提取 swt dll（在 swt jar 中），但我得到了同样的错误（指定 -Djava.library.path 参数）。

我的 Windows 是 Windows XP 32 位，JVM 是 1.7.0_13 32 位。

当我尝试在带有 x64 swt 库的 windows 64 位（windows8）下运行时，会发生以下情况： C:\nanoffline>java -cp "SebraeNaNOffline_lib_win/*" -jar SebraeNaNOffline.jar 线程“main”中的异常 java.lang.UnsatisfiedLinkError：无法加载 SWT 库。原因：java.library.path 中没有 swt-gtk-3740 java.library.path 中没有 swt-gtk 无法加载库：C:\Users\Infosolo.swt\lib\win32\x86_64\swt-gtk-3740 .dll 无法加载库：C:\Users\Infosolo.swt\lib\win32\x86_64\swt-gtk.dll

```
 at org.eclipse.swt.internal.Library.loadLibrary(Library.java:285)
    at org.eclipse.swt.internal.Library.loadLibrary(Library.java:194)
    at org.eclipse.swt.internal.C.<clinit>(C.java:21)
    at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:63)
    at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:54)
    at org.eclipse.swt.widgets.Display.<clinit>(Display.java:132)
    at br.com.infosolo.sebrae.nanoffline.IniciarOffline.<clinit>(IniciarOffl 
```

ine.java:31)

* * *

在 Eclipse 下运行 swt 应用程序（从 eclipse 启动），一切正常。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T17:36:46.573

我的问题是 META-INF\MANIFEST.MF 存档。

清单引用了 linux gtk SWT jar。

现在我已将所有 SWT LIB 更改为通用名称 swt.jar。当我更改平台时，我只需要用相同的名称替换 jar，而无需更改清单文件。

# vb.net - 将小数绑定到具有除 0 以外的最小值的 NumericUpDown

> ID：14857594
> 
> 赞同：2
> 
> 时间：2013-02-13T15:58:20.797
> 
> 标签：vb.net, winforms, data-binding

我将小数（来自 NHibernate 实体）绑定到 NumericUpDown。

```
_numUpDown.DataBindings.Add(
    New Binding(
        "Value", 
        _BindingSource, 
        "TheDecimal", 
        False, 
        DataSourceUpdateMode.OnPropertyChanged
    )
) 
```

这工作正常。但是，当我将 NumericUpDown 的最小值从 0 更改为 0.01 时，我收到错误消息。

来自设计师；

```
Me._numUpDown.Minimum = New Decimal(New Integer() {1, 0, 0, 131072}) 
```

错误;

```
1) System.InvalidOperationException 
---------------------------------------
Message: DataBinding cannot find a row in the list that is suitable for all bindings.
Target: Void FindGoodRow()
Source: System.Windows.Forms 
```

当最小值不为 0 时，我该怎么做才能使其绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T16:24:09.400

基于[https://stackoverflow.com/a/10908342/429091](https://stackoverflow.com/a/10908342/429091)，尝试将`formattingEnabled`参数（您设置为的第四个参数`False`）更改为`True`. 这似乎导致 .net winforms 忽略默认十进制值`0m`和您的`NumericUpDown.Minimum`.

通过此更改，看起来应该`NumericUpDown`忽略任何不兼容的数据，并且`Value`在您曾经获取 this 的所有情况下都保持其属性不变`InvalidOperationException`。我不知道为什么会这样。也许文档[`Binding.FormattingEnabled`](http://msdn.microsoft.com/en-us/library/system.windows.forms.binding.formattingenabled%28v=vs.110%29.aspx)在此摘录中对其进行了解释：

> 将此属性设置为 true 还会启用错误处理行为并引发[BindingComplete](http://msdn.microsoft.com/en-us/library/system.windows.forms.binding.bindingcomplete(v=vs.110).aspx)事件。此事件的处理程序可以根据绑定过程中的成功、错误或异常，通过检查[BindingCompleteEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingcompleteeventargs(v=vs.110).aspx)参数的[BindingCompleteState](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingcompleteeventargs.bindingcompletestate(v=vs.110).aspx)属性来采取适当的操作。

这可能意味着，如果您*想*在这种情况下在启用格式化时使绑定失败，您必须实现该事件。我不确定这会有多大用处。也许您想通知用户当前显示的值`NumericUpDown`不反映任何数据绑定项目（因为列表中的选定项目的值低于`Minimum`或者因为列表中当前没有项目，因为它尚未填充或没有任何项目）。

# c++ - 我应该在我的 C++ 标准随机分布上调用 reset() 来清除隐藏状态吗？

> ID：14857597
> 
> 赞同：11
> 
> 时间：2013-02-13T15:58:26.503
> 
> 标签：c++, random, c++11, standard-library

我想用简单的函数包装来自 C++11 标准库的随机数分布，这些函数将分布的参数和生成器实例作为参数。例如：

```
double normal(double mean, double sd, std::mt19937_64& generator)
{
    static std::normal_distribution<double> dist;
    return dist(generator, std::normal_distribution<double>::param_type(mean, sd));
} 
```

我想避免分发对象中的任何隐藏状态，以便每次调用此包装函数仅取决于给定的参数。（潜在地，对该函数的每次调用都可能采用不同的生成器实例。）理想情况下，我会创建分发实例`static const`来确保这一点；但是，分布`operator()`不是 const 函数，所以这是不可能的。

我的问题是：为了确保分发中没有隐藏状态，`reset()`每次调用分发是否 1）有必要且 2）是否足够？例如：

```
double normal(double mean, double sd, std::mt19937_64& generator)
{
    static std::normal_distribution<double> dist;
    dist.reset();
    return dist(generator, std::normal_distribution<double>::param_type(mean, sd));
} 
```

（总的来说，我对`reset()`随机分布函数的目的感到困惑......我理解为什么有时需要重置/重新设置生成器，但为什么需要重置分布对象？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T16:20:17.567

> 为了确保分布中没有隐藏状态，1) 是否有必要

是的。

> 和 2) 每次都足以在分配上调用 reset() 吗？

是的。

You probably don't want to do this though. At least not on every single call. The `std::normal_distribution` is the poster-child for allowing distributions to maintain state. For example a popular implementation will use the [Box-Muller transformation](http://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform) to compute two random numbers at once, but hand you back only one of them, saving the other for the next time you call. Calling `reset()` prior to the next call would cause the distribution to throw away this already valid result, and cut the efficiency of the algorithm in half.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:21:05.110

Some distributions have internal state. If you interfere with how the distribution works by constantly resetting it you won't get properly distributed results. This is just like calling `srand()` before every call to `rand()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T09:41:08.270

Calling `reset()` on a distribution object `d` has the following effect:

> Subsequent uses of d do not depend on values produced by any engine prior to invoking reset.

(an engine is in short a generator that can be seeded).

In other words, it clears any "cached" random data that the distribution object has stored and that depends on output that it has previously drawn from an engine.

So, if you want to do that then you should call `reset()`. The main reason I can think of that you would want to do that is when you are seeding your engine with a known value with the intention of producing repeatable pseudo-random results. If you want the results from your distribution object to *also* be repeatable based on that seed, then you need to reset the distribution object (or create a new one).

Another reason I can think of is that you are defensively reseeding the generator object because you fear that some attacker may gain partial knowledge of its internal state (as for example [Fortuna](https://en.wikipedia.org/wiki/Fortuna_%28PRNG%29) does). To over-simplify, you can imagine that the quality/security of the generator's data diminishes over time, and that reseeding restores it. Since a distribution object can cache arbitrary amounts of data from the generator, there will be an arbitrary delay between increasing the quality/security of the output of the generator, and increasing the quality/security of the output of the distribution object. Calling `reset` on the distribution object avoids this delay. But I won't swear to this latter use being correct, because it gets into the realms where I prefer not to make my own judgement about what is secure, if I can possibly rely on peer-reviewed work by an expert :-)

With regard to your code in particular -- if you don't want the output to depend on previous use of the same `dist` object with different generator objects, then calling `reset()` would be the way to do that. But I think it's unlikely that calling `reset` on a distribution object and then using it with new parameters will be any cheaper than constructing a new distribution object with those parameters. So using a `static` local object seems to me to make your function non-thread-safe for no benefit: you could create a new distribution object each time and the code would likely be no worse. There are reasons for the design in the standard, and you're expected to use a distribution object repeatedly with the same generator. The function you've written, cutting the distribution object out of the interface, discards the benefits of that part of the design in the standard.

# ios - 使用 MKPolyline 在 MKMapView 中绘制多组线

> ID：14857599
> 
> 赞同：4
> 
> 时间：2013-02-13T15:58:30.687
> 
> 标签：ios, objective-c, mkmapview, mapkit, polyline

我正在使用此代码绘制一组线：

```
CLLocationCoordinate2D points[[routes count]];
for(int i = 0; i < self.routes.count; i++)
{
    CLLocation* location = [self.routes objectAtIndex:i];
    points[i] = CLLocationCoordinate2DMake(location.coordinate.latitude, location.coordinate
                                             .longitude);
}
self.routeLine = [MKPolyline polylineWithCoordinates: points count: [routes count]];
[self.mapView setVisibleMapRect: [self.routeLine boundingMapRect] animated: YES];
[self.mapView addOverlay:self.routeLine]; 
```

它适用于来自的一组行`NSArray *routes`，但现在我需要不止一组行，例如`NSMutableArray *routes = { NSArray with routes , NSArray with other group like first example , another array }`可能是这样的：

```
int sumaCount = [a1 count] + [a2 count] + [a3 count];
CLLocationCoordinate2D puntitos[sumaCount];
int c = 0;
for (NSArray *array in rutas)
{
    for (CLLocation *cada in array)
    {
        puntitos[c] = CLLocationCoordinate2DMake(cada.coordinate.latitude, cada.coordinate.longitude);
        c++;
    }
    self.routeLine = [MKPolyline polylineWithCoordinates: puntitos count: sumaCount];
    [self.mapView addOverlay: self.routeLine];
} 
```

但我得到了这个例外：

```
 *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '***
 -[NSRegularExpression enumerateMatchesInString:options:range:usingBlock:]: nil argument' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T17:29:05.403

有两个问题：您提供的代码中的错误和异常。

**代码错误**

`sumaCount`在完成结构的构建之前，您正在为所有点添加叠加层`puntitos`（例如，第一次`addOverlay`调用，您只添加了`[a1 count]`点）。您还假设`a1`,`a2`和`a3`是 中的所有项目`rutas`。如果您希望它们连接，您应该：

*   摆脱`addOverlay`循环；和
*   不要使用`a1`, `a2`, and `a3`，而是通过迭代`rutas`来获得`sumaCount`

因此，如果您真的想将三组线路连接在一起，您可以：

```
int sumaCount = 0;
for (NSArray *array in rutas)
    sumaCount += [array count];
CLLocationCoordinate2D puntitos[sumaCount];

int c = 0;
for (NSArray *array in rutas)
{
    for (CLLocation *cada in array)
    {
        puntitos[c] = CLLocationCoordinate2DMake(cada.coordinate.latitude, cada.coordinate.longitude);
        c++;
    }
}

self.routeLine = [MKPolyline polylineWithCoordinates: puntitos count: sumaCount];
[self.mapView addOverlay: self.routeLine]; 
```

如果您正在处理三组单独的行，您应该：

```
for (NSArray *array in rutas)
{
    int sumaCount = [array count];
    CLLocationCoordinate2D puntitos[sumaCount];

    int c = 0;
    for (CLLocation *cada in array)
    {
        puntitos[c] = CLLocationCoordinate2DMake(cada.coordinate.latitude, cada.coordinate.longitude);
        c++;
    }
    MKPolyline routeLine = [MKPolyline polylineWithCoordinates: puntitos count: c];
    [self.mapView addOverlay: routeLine];
} 
```

请注意，在后一个示例中，我使用的不是您的`MKPolyline`属性，而是本地变量。如果您需要保留这些`MKPolyline`对象的数组，请继续执行此操作，但出于上述代码的目的，您不需要它。坦率地说，在第一个例子中，我可能也倾向于给你一个局部`MKPolyline`变量。为什么要把它放在类属性中？！？

**例外**

以上修复了您列出的代码中的错误，但您的异常指向另一个问题。它可能是您的代码（因为您第一次尝试创建`MKPolyline`正在使用的`sumaCount`点，但只设置了其中的几个）。但是问题也可能在其他地方重置，因为异常不是您对代码错误的期望。您是否在代码的其他地方进行任何正则表达式匹配？如果您确信问题出在代码本身，您可以

```
NSLog(@"rutas=%@", rutas); 
```

就个人而言，如果正则表达式问题是由此引起的，我会感到惊讶，但您原始问题中的代码肯定会导致一些意想不到的问题。我会修复代码，看看你的异常是否仍然发生。如果是这样，请添加此`rutas`日志语句，但更好的是，`NSRegularExpression`在您的项目中搜索并查看您可能在哪里使用它。您还可以[打开异常断点](http://developer.apple.com/library/ios/#recipes/xcode_help-breakpoint_navigator/articles/adding_an_exception_breakpoint.html)（只需为所有异常打开它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T17:23:58.043

如果该错误确实来自显示的代码，则您可能正在使用某个变量的已释放实例。

如果要一次添加多个叠加层，则应停止使用`routeLine`and`routeLineView`属性，因为它一次只能保存一个引用。

在本地声明并创建一个`MKPolyline`和`MKPolylineView`变量。

第二部分代码的主要问题是它调用`addOverlay`每个`array`in`rutas`但`puntitos`数组并`sumaCount`不断累积来自*所有*对象的值`array`（例如，叠加层 1 只是第一个`array`，叠加层 2 是 first 和 second 的组合`array`，等等）。

如果您想为每个`array`in单独叠加`rutas`，`puntitos`并且`sumaCount`应该为*每个* `array`声明和初始化（即放在第一个 for 循环中）。下面是一个例子：

```
for (NSArray *array in rutas)
{
    int sumaCount = [array count];
    CLLocationCoordinate2D puntitos[sumaCount];
    int c = 0;

    for (CLLocation *cada in array)
    {
        puntitos[c] = CLLocationCoordinate2DMake(cada.coordinate.latitude, cada.coordinate.longitude);
        c++;
    }

    MKPolyline *arrayLine = [MKPolyline polylineWithCoordinates: puntitos count: sumaCount];
    [self.mapView addOverlay: arrayLine];
} 
```

相反，如果您想要一个组合所有`array`对象的叠加层，请将`MKPolyline`创建和`addOverlay` *放在*主 for 循环之后（并保留主 for 循环的声明和初始化`puntitos`以及`sumaCount` *之前*）。例如：

```
int sumaCount = 0;
CLLocationCoordinate2D puntitos[sumaCount];
int c = 0;
for (NSArray *array in rutas)
{
    sumaCount = sumaCount + [array count];

    for (CLLocation *cada in array)
    {
        puntitos[c] = CLLocationCoordinate2DMake(cada.coordinate.latitude, cada.coordinate.longitude);
        c++;
    }
}

MKPolyline *rutasLine = [MKPolyline polylineWithCoordinates: puntitos count: sumaCount];
[self.mapView addOverlay: rutasLine]; 
```

在`viewForAnnotation`中，请记住将代码更改为*不*使用`routeLine`and `routeLineView`（您应该摆脱这些以避免混淆）。例如：

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id < MKOverlay >)overlay
{
    MKPolylineView *pv = [[[MKPolylineView alloc] initWithPolyline:overlay] autorelease];
      //remove autorelease if not using ARC

    pv.strokeColor = [UIColor redColor];
    pv.lineWidth = 5;

    return pv;
} 
```

# jakarta-ee - weblogic 10.3 上的单例

> ID：14857603
> 
> 赞同：2
> 
> 时间：2013-02-13T15:58:40.833
> 
> 标签：jakarta-ee, singleton, jms, weblogic

我们正在尝试找到一个在 weblogic 上创建单例的好解决方案。

现在我们有一个既部署在集群环境中又部署在单个服务器中的耳朵。耳朵内是一个持有某种状态的单身人士。在 2 台服务器上复制该状态会导致不正确的行为。目前，只能通过部署为 max 1 的 MDB 访问该单例。该 MDB 正在侦听一个主题。该主题未分发，这导致我们仅在一台服务器上拥有它，但会导致我们不喜欢的部署警告。

我们考虑了几个解决方案：

*   Weblogic 的 SingletonService。工作正常，但它只在集群上工作，导致应用程序的单个服务器版本和开发人员沙箱出现问题。
*   为单例和周围代码创建一个单独的耳朵，并将其部署在单独的托管服务器上。这预计会按要求工作，但需要大量工作才能将我们的单例与周围的代码分离，并要求我们向远程访问公开大量功能。
*   使单例无状态删除单例要求。应该工作，但同样需要大量工作

还有其他方法可以解决问题吗？也许是一些 JMS 技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T07:36:32.080

帕维尔，我看到你自己已经想出了很多好主意。看起来您需要一个单例交叉集群来进行计数。您需要的单例不必是内存中的单例。您可以将计数移动到数据库表中。数据库表可以充当单例。每当计数增加时，您都会调用 jdbc 来更新表中的计数字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:07:46.517

创建共享库会起作用吗？共享库可以有一个单例。

[http://docs.oracle.com/cd/E11035_01/wls100/programming/libraries.html#wp1071514](http://docs.oracle.com/cd/E11035_01/wls100/programming/libraries.html#wp1071514) [https://blogs.oracle.com/jamesbayer/entry/weblogic_server_shared_librari_1](https://blogs.oracle.com/jamesbayer/entry/weblogic_server_shared_librari_1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:08:21.877

我不知道我是否非常了解您的问题，也许最简单的解决方案是使主题分布式并使用它将单例状态传播到所有集群节点。

您可以使用主题来传播单例状态，我的意思是，只有一个单例状态，在需要隐式重新加载的更改或行为上，向主题发送消息，每个 MDB 订阅主题都会收到消息（这里分布式是诀窍）（例如，一个用于集群节点的 MDB）并在每个节点中按照您的需要行事。

希望这会有所帮助，但我不知道我是否理解您的问题。

# perl - 从 /dev/urandom 播种 Math::Random::ISAAC：如何读取/传递 128 位？

> ID：14857609
> 
> 赞同：0
> 
> 时间：2013-02-13T15:58:58.847
> 
> 标签：perl, file, unix, random, binary

在 Perl 中有很多方法可以创建安全的随机数。大多数这些方法都涉及一个或多个 Perl 模块。许多这些 Perl 模块需要更多的 Perl 模块作为依赖项。

由于我想保持轻量级并减少所需的依赖项，因此我决定使用`Math::Random::ISAAC`，并自己从`/dev/urandom`.

那么，在不使用其他模块的情况下，在 Perl 中读取 128 位（我想这是一个很好的数量）数据`/dev/urandom`，然后将其传递给的推荐方法是`ISAAC`什么？

我不知道正确的阅读和格式化方式是什么，这是[我将把种子传递给的子副本：](http://cpansearch.perl.org/src/JAWNSY/Math-Random-ISAAC-1.004/lib/Math/Random/ISAAC/PP.pm)

```
sub new {
  my ($class, @seed) = @_;

  my $seedsize = scalar(@seed);

  my @mm;
  $#mm = $#seed = 255; # predeclare arrays with 256 slots

  # Zero-fill our seed data
  for ($seedsize .. 255) {
    $seed[$_] = 0;
  }

  my $self = {
    randrsl   => \@seed,
    randcnt   => 0,
    randmem   => \@mm,

    randa     => 0,
    randb     => 0,
    randc     => 0,
  };

  bless($self, $class);

  $self->_randinit();

  return $self;
} 
```

我不是数组、标量、字节字符串等方面的专家；所以我真的不知道如何正确格式化`urandom`数据`@seed`。我确实认为 128 位有很多随机性，但我不知道如何确保所有的熵都变成`ISAAC`，并防止它在此过程中被截断为 64 或 32 位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:19:08.997

从使用种子的 ISAAC 代码来看，它似乎需要 32 位值。所以：

```
use autodie;
open(my $fh,'<','/dev/urandom');
my $buffer;
read($fh, $buffer, 16) == 16 or die "not enough read";
my @seed = unpack 'L4', $buffer;
my $isaac = Math::Random::ISAAC->new(@seed); 
```

# ios - MagicalRecord iCloud 问题

> ID：14857611
> 
> 赞同：5
> 
> 时间：2013-02-13T15:59:07.850
> 
> 标签：ios, core-data, icloud, magicalrecord

我正在尝试将 MagicalRecord 与 iCloud 一起使用，每次我打电话

```
 [MagicalRecord setupCoreDataStackWithiCloudContainer:nil localStoreNamed:@"MyApp.sqlite"]; 
```

我第一次在下面得到这些日志……以前有人见过吗？我已经清理了项目并删除了应用程序，但我每次都得到它。

我可以在“设置”>“iCloud”中看到我的应用程序，但在 developer.icloud.com 文档文件夹中没有任何内容

```
 2013-02-13 09:25:56.247 MyApp[6902:5d17] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/current.nosync/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    Confused by: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    2013-02-13 09:25:56.248 MyApp[6902:5807] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    Confused by: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    2013-02-13 09:25:56.253 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/.stage.nosync/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    Confused by: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    2013-02-13 09:25:56.259 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=/staging.nosync
    Confused by: staging.nosync
    2013-02-13 09:25:56.261 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/current.nosync/iCloudStore
    Confused by: iCloudStore
    2013-02-13 09:25:56.263 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.cdmetadata/metadata.nosync/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/metadata.store-wal
    Confused by: metadata.store-wal
    2013-02-13 09:25:56.274 MyApp[6902:170b] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/Data.nosync/.baseline/current.nosync/iCloudStore/YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY=/baseline.model
    Confused by: baseline.model
    2013-02-13 09:25:56.279 MyApp[6902:1413] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.cdmetadata/metadata.nosync/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/metadata.store-shm
    Confused by: metadata.store-shm
    2013-02-13 09:25:56.286 MyApp[6902:170b] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/mobile.DDDDDD-DDDD-DDDD-DDDD-DDDDDDDDD/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    Confused by: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    2013-02-13 09:25:56.291 MyApp[6902:170b] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=/baseline.zip
    Confused by: baseline.zip
    2013-02-13 09:25:56.292 MyApp[6902:1413] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/SyncData/com.walshitech.sbrspeeds/ClientDevices/ZZZZZZZZ-ZZZZ-ZZZZ-ZZZZ-ZZZZZZZZZZZZ-ZZZZ-ZZZZZZZZZ
    Confused by: ZZZZZZZZ-ZZZZ-ZZZZ-ZZZZ-ZZZZZZZZZZZZ-ZZZZ-ZZZZZZZZZ
    2013-02-13 09:25:56.297 MyApp[6902:1413] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/current.nosync/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=/baseline.meta
    Confused by: baseline.meta
    2013-02-13 09:25:56.298 MyApp[6902:170b] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=/staging.nosync/iCloudStore.sqlite
    Confused by: iCloudStore.sqlite
    2013-02-13 09:25:56.306 MyApp[6902:5d17] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/Data.nosync/.baseline/current.nosync/iCloudStore/YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY=/baseline.meta
    Confused by: baseline.meta
    2013-02-13 09:25:56.310 MyApp[6902:5d17] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/Data.nosync/.baseline/iCloudStore/YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY=/baseline.zip
    Confused by: baseline.zip
    2013-02-13 09:25:56.315 MyApp[6902:170b] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.cdmetadata/metadata.nosync/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/metadata.store
    Confused by: metadata.store
    2013-02-13 09:25:56.315 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.cdmetadata/metadata.nosync/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY
    Confused by: mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY
    2013-02-13 09:25:56.324 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/SyncData/com.walshitech.sbrspeeds/Information/DeletedDocuments
    Confused by: DeletedDocuments
    2013-02-13 09:25:56.324 MyApp[6902:5d17] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/current.nosync/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=/baseline.model
    Confused by: baseline.model
    2013-02-13 09:25:56.324 MyApp[6902:170b] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/SyncData/com.walshitech.sbrspeeds/Information/DeletedClients
    Confused by: DeletedClients
    2013-02-13 09:25:56.325 MyApp[6902:1413] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/SyncData/com.walshitech.sbrspeeds/ClientDevices/YYYYYYY-YYYY-YYYY-YYYY-YYYYYYYY-YYYY-YYYYYYYYYYY5
    Confused by: YYYYYYY-YYYY-YYYY-YYYY-YYYYYYYY-YYYY-YYYYYYYYYYY5
    2013-02-13 09:25:56.328 MyApp[6902:5807] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/.stage.nosync/iCloudStore
    Confused by: iCloudStore
    2013-02-13 09:25:56.330 MyApp[6902:1507] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/current.nosync/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=/baseline.gcmodel
    Confused by: baseline.gcmodel
    2013-02-13 09:25:56.330 MyApp[6902:5207] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.baseline/iCloudStore/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    Confused by: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=
    2013-02-13 09:25:56.346 MyApp[6902:5d17] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.cdmetadata/metadata.nosync/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/iCloudStore
    Confused by: iCloudStore
    2013-02-13 09:25:56.348 MyApp[6902:5207] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/iCloudData/.cdmetadata/metadata.nosync/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY/iCloudStore/CCCCCC-CCCC-CCCC-CCCC-CCCCCCCCC.cid
    Confused by: CCCCCC-CCCC-CCCC-CCCC-CCCCCCCCC.cid
    2013-02-13 09:25:56.349 MyApp[6902:5d17] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/Data.nosync/.baseline/iCloudStore/YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY=/mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY
    Confused by: mobile.YYYYYYY-YYYY-YYYY-YYYYYYYY
    2013-02-13 09:25:56.358 MyApp[6902:5207] +[PFUbiquityLocation createUbiquityLocationForPath:withUbiquityRootPath:](821): CoreData: Ubiquity:  Unable to continue parse components of URL: /var/mobile/Library/Mobile Documents/XXXXXXXXXXX~com~my~app/Data.nosync/.baseline/current.nosync/iCloudStore/YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY=/baseline.gcmodel
    Confused by: baseline.gcmodel 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-23T15:54:11.653

我知道这是一个老问题，但对于刚刚遇到这个问题的人来说，我想我找到了解决方案。对我来说，这是模拟器的问题。显然，模拟器创建了一些设备无法正确访问的奇怪文件。

尝试按以下顺序执行以下操作，看看它是否消失：

1.  从 iOS 模拟器和设备中删除您的应用程序并安装它。
2.  在您的 iPhone / iPad（**不是**模拟器）上，转到设置 > iCloud > 存储和备份 > 管理存储 > Your_app_name > 编辑（右上角）> 全部删除。
3.  **尝试在您的设备**上再次安装该应用程序。

希望奇怪的错误将不再存在。再次在模拟器上运行应用程序可能会再次创建它们，您将不得不重复该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:10:20.357

好吧，我可以告诉你它们是什么，但不是一个有保证的解决方案。

这些文件就是我所说的，由您或您的应用程序在 ubiquity 目录中创建的“幽灵文件”。

要显示这是正在发生的事情，请转到 Mac 上用户库中的“移动文档”文件夹，转到“/var/mobile/Library/Mobile Documents/XXXXXXXXXXXX~com~my~app/iCloudData”文件，然后只需手动通过“命令 N”创建一个新文件。

然后从那时起，您将收到一个额外的“错误”，其中“无标题文件夹”作为它无法“解析”的文件......

不过，从您的设备中删除所有内容似乎会将这些文件留在实际的 iCloud 数据服务器上（我认为）。创建“幽灵文件”

如果这是开发者帐户，您可以通过以下方式查看甚至删除它们：

[https://developer.icloud.com/](https://developer.icloud.com/) 并使用您的开发者 ID 登录。

如果这是一个测试帐户，那么我似乎无法找到删除这些文件的方法..

你可以通过简单地在你的代码中创建新目录来解决它，所以代替“iCloudData”这个词组成一个新的“iCloudData2”或其他东西，

现在您可以让 iCloud 再次工作，但是，您将继续在控制台中看到这些警告/错误...

如果有人弄清楚如何从测试用户帐户中删除它们“换句话说就是没有开发人员 ID”，请告诉我......

过去您可以访问上述网站并输入您的测试用户 ID，但在 Apple 的无限智慧中，他们在几个月前将其更改为现在只是开发人员 ID。

# python - 从 Python 中的 URL 读取 XML 并以 XML 格式写入 Sql Server 数据库

> ID：14857613
> 
> 赞同：0
> 
> 时间：2013-02-13T15:59:08.827
> 
> 标签：python, sql, xml, sql-server-2008, xml-parsing

我正在尝试从 Web 地址读取 XML 文件并将该文件作为 XML 数据类型写入 Sql Server DB。我不想对 XML 进行任何解析，只需将其像字符串一样写入数据库即可。我将使用它每隔几个小时拍摄一次快照，然后使用 Sql 将信息作为 XML 数据类型处理。

我目前收到以下提到的错误：

```
'IOError: [Errno socket error] [Errno 11001] getaddrinfo failed' 
```

我不确定我是否正确读取了 xml 文件（作为一条信息） - 有什么建议吗？

```
import pyodbc
import urllib
xmlpath = "http://www.w3schools.com/xml/cd_catalog.xml"
xmlurl= urllib.urlopen(xmlpath)
xml_as_string = xmlurl.read()

cnxn = pyodbc.connect(
    'Trusted_Connection=yes; 
    DRIVER={SQL Server};
    SERVER=servername; 
    DATABASE=database_name; 
    UID=user; 
    PWD=pass'
) 
cursor = cnxn.cursor()
cursor.execute("insert into table values ('Text', 1, '"+ xml_as_string +"')") 
cnxn.commit() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T08:11:10.513

这`[Errno 11001] getaddrinfo failed`表明您面临一些 DNS 问题。

尝试 ping 通“服务器名”。一个快速的解决方法可能是从域名切换到“服务器名”变量中的 IP 地址。

另外，尝试谷歌搜索：[Errno 11001 getaddrinfo](https://www.google.com/#q=Errno+11001+getaddrinfo)。

# c# - 将 JSON 数据传递给控制器 方法而无需声明对象

> ID：14857614
> 
> 赞同：4
> 
> 时间：2013-02-13T15:59:31.070
> 
> 标签：c#, jquery, asp.net, asp.net-mvc, asp.net-mvc-3

我正在使用 ASP.NET MVC 和 jQuery 通过 AJAX 调用保存一些数据。我目前使用 jQuery ajax() 函数像这样传递一些 JSON 数据

```
$.ajax({
    dataType: 'json',
    type: 'POST',
    url: '@Url.Action("UpdateName", "Edit")',
    data: {
        id: 16,
        name: 'Johnny C. Bad'
    }
}); 
```

使用这个控制器方法和助手类。

```
public void UpdateName(Poco poco)
{
    var person = PersonController.GetPerson(poco.Id);   
    person.Name = poco.Name;
    PersonController.UpdatePerson(person);
}

public class Poco
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

接受 JSON 数据的另一种方法是简单地使用像这样的多个参数

```
public void UpdateName(int id, string name)
{
    var person = PersonController.GetPerson(id);    
    person.Name = name;
    PersonController.UpdatePerson(person);
} 
```

这种方法适用于较少数量的参数，但我的真实世界代码通常有大约 5 - 10 个参数。使用对象而不是必须声明和使用所有这些参数非常方便。

我想知道是否有另一种方法可以将 JSON 数据作为单个对象接受，而不必为我想使用这种方法的每个控制器方法声明一个类。例如，像这样：

```
public void UpdateName(dynamic someData)
{
    var person = PersonController.GetPerson(someData.Id);   
    person.Name = someData.Name;
    PersonController.UpdatePerson(person);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:21:05.017

你可以接受一个 FormCollection，它看起来像：

```
public void UpdateName(FormCollection collection)
{
    var person = PersonController.GetPerson(int.Parse(collection["id"]));
    person.Name = collection["name"];
    person.Age = collection["age"];

    PersonController.UpdatePerson(person);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:26:23.627

我不太确定您为什么要实现这一目标，但是您可以使用动态来实现它（我没有尝试过）：

```
public void UpdateName(string parameters)
{
    var dynamicObject = Json.Decode(parameters);
} 
```

Json.Decode 在 System.Web.Healpers 命名空间中

您可以通过 javascript 传递它们，如下所示：

```
var dataObject = JSON.stringify({ id: '1', name: 'John' });
$.ajax({
    dataType: 'json',
    type: 'POST',
    url: '@Url.Action("UpdateName", "Edit")',
    data: dataObject 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T17:09:03.590

可能的解决方案

创建特定的模型绑定器，例如

```
 public class DynamicModelBinder : DefaultModelBinder
    {
        public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
        {
            if (controllerContext.HttpContext.Request.Form.AllKeys.Any(x => x == "dynamic"))
            {
                dynamic model = new ExpandoObject();
                IDictionary underlyingmodel = model;

                foreach (var key in controllerContext.HttpContext.Request.Form.AllKeys)
                    underlyingmodel.Add(key, (bindingContext.ValueProvider.GetValue(key).RawValue as string[]).First());

                return model;
            }

            return base.BindModel(controllerContext, bindingContext);
        }
    } 
```

此活页夹将检查名称为“动态”的特定输入，然后创建动态对象

```
 public ActionResult Index()
    {
       return View();
    }

    [HttpPost]
    public ActionResult Index(dynamic input)
    {
       ViewBag.Result = input.phrase;
       return View();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:11:51.513

我想这里的问题是确切地知道您希望在控制器中在实体之间共享哪些常见功能。如果所有这些功能都可以在某个共享属性后面统一（从上面的示例中，可能是 Id 和 Name 字段？）那么您可以来回传递 IEntity 的实例，或者包含这两个属性的某个基类。

# javascript - n 级深度复选框树行为

> ID：14857620
> 
> 赞同：1
> 
> 时间：2013-02-13T15:59:39.837
> 
> 标签：javascript, knockout.js

我有一个使用敲除实现的 n 级复选框树，其中父级 chechbox 的选择应选择其子级（但不是相反），一旦提交数据，所选元素的 id 应转换为 JSON 发送到服务器。

我无法弄清楚如何单向复选框关系，也无法弄清楚如何以以下方式过滤我的最终 json：

1.  如果选择了一个父级（因为这意味着它的所有子级也被选中），则不在 json 中发送其子级 ID

2.  当只选择一个或几个孩子时如何不发送父母 ID。

列表项的模型是：

```
marketingListsItem = function (data, parent) {
        var self = this;
        self.Name = ko.observable(data.Name);
        self.Selected = ko.observable(data.Selected);
        self.Parent = ko.observable(parent);
        self.Children = ko.observableArray([]);
        self.Id = ko.observable(data.Id);         
        self.DateAdded = ko.observable(new Date(data.DateAdded));
        self.DateModified = ko.observable(data.DateModified);
        if (data.Children) {
            ko.utils.arrayForEach(data.Children, function (child) {
                self.Children.push(new marketingListsItem(child, this));
            }.bind(this));
        };
    } 
```

这是视图模型部分：

```
marketingListsViewModel = {
        marketingLists: mapping.fromJS([]),
        originatorConnectionName: ko.observable(''),
        selectedMarketingListIds: ko.observableArray([])
    },
    init = function (connectionId, connectionName) {
        marketingListsViewModel.originatorConnectionName(connectionName);
        marketingListsViewModel.getFieldMapping = function () {
            require(['mods/fieldmapping'], function (fieldmapping) {
                fieldmapping.init(connectionId, connectionName);
            });
        };
        // Here I only managed to filter the parent level selections
        marketingListsViewModel.selectedLists = ko.computed(function () {
            return ko.utils.arrayFilter(marketingListsViewModel.marketingLists(), function (item) {
                return item.Selected() == true;
            });
        });
        marketingListsViewModel.saveMarketingListChanges = function () {
            // Which I can filter my JSON to include them but the children are missing
            var latestMarketingListChanges = ko.toJSON(marketingListsViewModel.selectedLists, ["Id"]);
            console.log(latestMarketingListChanges);
            amplify.request("updateExistingMarketingLists", { cid: connectionId, ResponseEntity: { "id": connectionId, "selectedMarketListIds": latestMarketingListChanges } },
                function (data) {
                    console.log(data);
                });
        }
        amplify.request("getExistingMarketingLists", { cid: connectionId }, function (data) {
            showMarketingLists();
            mapping.fromJS(data.ResponseEntity, dataMappingOptions, marketingListsViewModel.marketingLists);
            ko.applyBindings(marketingListsViewModel, $('#marketingLists')[0]);
        });
    }; 
```

最后是视图：

```
<div id="marketingListsContainer">
        <ul data-bind="template: {name: 'itemTmpl' , foreach: marketingLists}"></ul>
        <script id="itemTmpl" type="text/html">
            <li>
                <label><input type="checkbox" data-bind="checked: Selected" /><span data-bind='text: Name'></span></label>                    
            <ul data-bind="template: { name: 'itemTmpl', foreach: Children }" class="childList"></ul>
        </script>
    </div>
    <a class="s_button modalClose right" href="#"><span data-bind="click: saveMarketingListChanges">Save and close</span></a><br> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T14:07:15.230

感谢你的回答。问题是，如果现在使用您的解决方案，如果服务器中的数据已经检查了父级，那么它的子级检查值不会发生变化。

我在模型中添加了以下内容来解决这个问题：

```
self.sync = ko.computed(function () {
       return self.Selected.valueHasMutated();
}); 
```

**对于那些稍后会发现这篇文章并可能想看看最终结果的人：**

```
 define('mods/marketinglists', ["knockout", "libs/knockout.mapping", "libs/knockout.validation", "datacontext", "mods/campaigner", "text!templates/marketinglists.html", "text!styles/marketinglists.css"],
function (ko, mapping, validation, datacontext, campaigner, html, css) {
    'use strict';
    var
        marketingListsItem = function (data, parent) {
            var self = this;
            self.Name = ko.observable(data.Name);
            self.Selected = ko.observable(data.Selected);
            self.Parent = ko.observable(parent);
            self.Children = ko.observableArray([]);
            self.Id = ko.observable(data.Id);
            self.DateAdded = ko.observable(new Date(data.DateAdded));
            self.DateModified = ko.observable(data.DateModified);
            // If node contains children define each one as a marketingListItem in itself
            // and bind it to the the model
            if (data.Children) {
                ko.utils.arrayForEach(data.Children, function (child) {
                    self.Children.push(new marketingListsItem(child, this));
                }.bind(this));
            };
            // Watch for value changes in parent and check children 
            // if the parent was checked
            self.Selected.subscribe(function (newValue) {
                if (newValue === true) {
                    for (var i = 0; i < self.Children().length; i++) {
                        self.Children()[i].Selected(true);
                    }
                }
                else {
                    if (self.Parent() != null) { self.Parent().Selected(false); }
                }
            });
            // Make sure subscribers have been notified when needed
            self.sync = ko.computed(function () {
                return self.Selected.valueHasMutated();
            });
        },
        dataMappingOptions = {
            key: function (data) {
                return data.Id;
            },
            create: function (options) {
                return new marketingListsItem(options.data, null);
            }
        },
        showMarketingLists = function () {
            campaigner.addStylesToHead(css);
            campaigner.addModalWindow(html, {
                windowSource: "inline",
                width: 700,
                height: '340'
            });
        },
        marketingListsViewModel = {},
        init = function (connectionId, connectionName) {
            // Define marketingLists as an observable array from JS object
            marketingListsViewModel.marketingLists = mapping.fromJS([]);
            marketingListsViewModel.originatorConnectionName = ko.observable('');
            // Set the name for the marketing list
            marketingListsViewModel.originatorConnectionName(connectionName);
            marketingListsViewModel.getFieldMapping = function () {
                require(['mods/fieldmapping'], function (fieldmapping) {
                    fieldmapping.init(connectionId, connectionName);
                });
            };
            marketingListsViewModel.selectedLists = ko.computed(function () {
                var selectedItems = [];
                ko.utils.arrayFilter(
                    marketingListsViewModel.marketingLists(),
                    function (item) {
                        // If a parent a selected its being collected
                        if (item.Selected() == true) selectedItems.push(item);
                        else {
                            // If a child is slected it is collected
                            ko.utils.arrayForEach(item.Children(), function (child) {
                                if (child.Selected()) selectedItems.push(child);
                                else {
                                    ko.utils.arrayForEach(child.Children(),
                                        // Finally if children's child is selected its collected
                                        function (childChildren) {
                                            if (childChildren.Selected())
                                                selectedItems.push(childChildren);
                                        });
                                }
                            })
                        }
                    });
                return selectedItems;
            });
            marketingListsViewModel.saveMarketingListChanges = function () {
                // Pick only the selected elements and parse only the Id
                var latestMarketingListChanges = ko.toJSON
                    (marketingListsViewModel.selectedLists,
                        ["Id"]);
                console.log(latestMarketingListChanges);
                // Send the latest marketing lists changes Ids to the server
                amplify.request("updateExistingMarketingLists",
                    {
                        cid: connectionId,
                        ResponseEntity:
                        {
                            "id": connectionId,
                            "selectedMarketListIds": latestMarketingListChanges
                        }
                    },
                    function (data) {
                        console.log(data);
                    });
            }
            amplify.request("getExistingMarketingLists", { cid: connectionId },
                function (data) {
                    showMarketingLists();
                    mapping.fromJS(
                        data.ResponseEntity,
                        dataMappingOptions,
                        marketingListsViewModel.marketingLists);

                    ko.applyBindings(marketingListsViewModel, $('#marketingLists')[0]);
                });
        };
    return {
        init: init,
        marketingListsViewModel: marketingListsViewModel,
        html: html,
        css: css
    }
}); 
```

**有了这个观点：**

```
<div id="marketingListsContainer">
            <ul data-bind="template: {name: 'itemTmpl' , foreach: marketingLists}"></ul>
            <script id="itemTmpl" type="text/html">
                <li>
                    <!-- ko if: $data.Parent -->
                    (my parent is: <span data-bind="text: $data.Parent().Name"></span>) 
                    <!-- /ko -->
                    <label><input type="checkbox" data-bind="checked: Selected" /><span data-bind='text: Name'></span></label>                    
                <ul data-bind="template: { name: 'itemTmpl', foreach: Children }" class="childList"></ul>
            </script>
        </div>
        <a class="s_button modalClose right" href="#"><span data-bind="click: saveMarketingListChanges">Save and close</span></a><br> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:42:12.523

您可以将订阅事件添加到选定的绑定并执行类似的操作，当您检查父级时，会将所有子级标记为选中。

```
self.Selected.subscribe( function ( newValue ) {
    if ( newValue === true ) { 
        for ( i=0; i<self.Children().length; i++) {
            self.Children()[i].Selected(true);
        }
    }
    else {
         if ( self.Parent() != null ) { 
             self.Parent().Selected(false);
         }
    }
} ) ; 
```

然后在您的保存方法上，您必须对列表执行一些自定义遍历逻辑

```
marketingListsViewModel.saveMarketingListChanges = function (
    var allSelected = ko.toJS( marketingListsViewModel.selectedLists );
    var ids = [];

    for ( i = 0; i < allSelected.length; i++ ) {
        ids.concat ( marketingListsViewModel.getIds( allSelected[i] ) );
    }

    var latestMarketingListChanges = ko.toJSON(ids);
    ...
);

marketingListsViewModel.getIds = function( item ) { 
     var ids = []

     if ( item.Selected === true ) { 
         ids.add( item.Id );
     }
     else if ( item.Children.length > 0 ) {
         for ( i = 0; i < item.Children.length; i++ ) {
             ids.concat( marketingListsViewModel.getIds( item.Children[i] )  )
         }
     }

     return ids;
} 
```

现在请记住，我没有费心在这里编写工作 javascript，但你明白了。您可能需要编写一个数组连接函数或扩展 jQuery 或类似的东西。

希望能帮助到你

# c# - 无法加载文件或程序集 Microsoft.ReportViewer.WebForms 或其依赖项之一

> ID：14857621
> 
> 赞同：9
> 
> 时间：2013-02-13T15:59:40.977
> 
> 标签：c#, visual-studio-2012, reportviewer

当我转到我的网站时，我收到此错误...

```
Error   101 Could not load file or assembly 'Microsoft.ReportViewer.WebForms, Version=9.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies. The system cannot find the file specified. C:\mlui\csharp\WebAdmin_solution\WebAdmin\web.config    209 
```

这是这行代码：

```
<add assembly="Microsoft.ReportViewer.WebForms, Version=9.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" /> 
```

我正在使用 Visual Studio 2012，是否需要下载一些内容并将其添加到 VS 2012 文件夹中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T16:06:09.670

如果您实际使用的是 Reporting Services，请尝试在您将网站部署到的服务器上安装 Reporting Services 可再发行组件，或者在您的 Web 应用程序中包含所需的程序集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-13T11:32:17.053

看看你的文件夹安装，什么版本有文件夹ReportViewer。并把 Version=X.0.0.0 其中 X 表示您的安装版本。

就我而言，我有

![安装文件夹](../Images/19208f8a57127f2901d2a57596c5b171.png)

但只有在 10.0 内我有 ReportViewer

![报表查看器文件夹](../Images/7c523b7300d19c9990daaf2cdfb25c8a.png)

而我的 web.xml 是这样的

```
<assemblies>
                <add assembly="Microsoft.ReportViewer.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
                <add assembly="Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
                <add assembly="Microsoft.ReportViewer.WinForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
      </assemblies>
    <buildProviders>
                <add extension=".rdlc" type="Microsoft.Reporting.RdlBuildProvider, Microsoft.ReportViewer.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
            </buildProviders> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T16:02:42.090

尝试通过添加对您的项目的引用并在添加程序集文件后再次构建它，以使用 10.0 版的最新程序集对其进行更新，如下所示

```
Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-02-28T10:51:23.840

右键单击项目并打开并转到管理 NuGet 包

在浏览下点击搜索**Microsoft.Reporting.WebForms**

选择 Microsoft.ReportView.Webforms

[![在此处输入图像描述](../Images/46b372648a7bc4066de2960bb4023309.png)](https://i.stack.imgur.com/gBKFa.png)

并点击安装。

*   所以它会照顾各自的依赖等等，

# google-app-engine - GoogleAppEngine 是否提供 API 来监控 Java 的资源使用情况？

> ID：14857622
> 
> 赞同：0
> 
> 时间：2013-02-13T15:59:43.690
> 
> 标签：google-app-engine

GoogleAppEngine 是否提供 API 来监控 Java 的 CPU 和内存使用情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:22:56.063

检查在线控制面板。这一切都在那里。

转到“实例”以查看每个正在运行的实例的统计信息。

但是一个API（现在我重新阅读了你的问题），我不这么认为。

然而，Appstats 可能会给你一些你想要的东西。

[https://developers.google.com/appengine/docs/java/tools/appstats](https://developers.google.com/appengine/docs/java/tools/appstats)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:28:50.990

不，它没有。

您也许可以使用日志 API 来提取日志、解析它们，并找出各种实例的 CPU 使用率。

但是，您无法通过 API 获取内存使用情况。

# c# - 使用自定义查询来选择其 ID 存在于 ID 列表中的项目

> ID：14857628
> 
> 赞同：6
> 
> 时间：2013-02-13T15:59:53.513
> 
> 标签：c#, mysql, dapper, ormlite-servicestack

在 dapper 中，您可以执行以下操作：

```
var items = connection.Query<Items>("SELECT * FROM `@database`.`table`  WHERE `id` IN @idList;", new {database = DatabaseName, idList = someList.Select(n => n.id)}); 
```

尝试在 ormlite 中做同样的事情：

```
var items = connection.Query<Items>("SELECT * FROM {0}`.`table`  WHERE `id` IN {1};", DatabaseName, someList.Select(n => n.id)}); 
```

返回错误。Dapper 这样创建查询：

```
SELECT * FROM `someDB`.`table` WHERE `id` IN (1,2,3,4); 
```

ormlite 在哪里生成：

```
SELECT * FROM `someDB`.`table` WHERE `id` IN [1,2,3,4]; 
```

方括号在 MySQL 中无效。可以在 ormlite 中做到这一点吗？

当我尝试使用匿名类列出参数时，如在 dapper 示例中，它找不到第二个参数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T21:26:19.533

要执行**SQL IN**语句，OrmLite 需要能够在需要时转义所有值（即，如果它们是字符串值）。因此，如果在 OrmLite 中使用原始 SQL，您可以执行以下操作：

```
var ids = someList.Select(n => n.id).ToArray();

var items = db.Select<Items>(
    "SELECT * FROM `{0}`.`table`  WHERE `id` IN ({1})", 
    DatabaseName, new SqlInValues(ids)); 
```

尽管大多数时候您不需要在 OrmLite 中使用 Raw SQL，但如果您使用类型化 API，它会更加简洁和可移植。例如：

```
var items = db.Select<Items>(q => Sql.In(q.Id, ids)); 
```

`[Alias]`如果您的表与 POCO 的名称不同，您也可以使用，并且还可以指定`[Schema]`with：

```
[Schema("DatabaseName")]
[Alias("table")]
public class Items 
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

在查询数据库时，它将改为使用指定的模式和表名。

# ruby-on-rails-3 - Rails jbuilder删除标题

> ID：14857630
> 
> 赞同：6
> 
> 时间：2013-02-13T15:59:59.693
> 
> 标签：ruby-on-rails-3, jbuilder

我正在将 jbuilder 添加到 Rails 应用程序中——很棒的工具！

我得到了我想要的记录列表，但它有我不想要的额外输出。

这是 jbuilder 代码：

```
json.locations @locations do |location|
 json.id location.id
 json.name location.name
end 
```

输出是：

```
{
  - locations: [
    {
      id: 1,
      name: "Name 1"
    },
    {
      id: 2,
      name: "Name 2"
    }, 
```

我需要的是：

```
[
    {
      id: 1,
      name: "Name 1"
    },
    {
      id: 2,
      name: "Name 2"
    }, 
```

如何删除 { - 位置：

？？？

谢谢！！

更新：

我希望 jbuilder 有一行代码可以排除根。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-13T19:37:30.107

你能检查一下你是否有以下配置吗？

```
ActiveRecord::Base.include_root_in_json = false 
```

这应该够了吧

## 更新

试试这个：

```
json.array!(@locations) do |location|
 json.id location.id
 json.name location.name
end 
```

# xmpp - 存在于多个资源上

> ID：14857643
> 
> 赞同：1
> 
> 时间：2013-02-13T16:00:49.387
> 
> 标签：xmpp, smack

我正在尝试更新三个客户端的存在，其中两个是 Adium 和 Pidgin，一个是我的自定义构建应用程序。当我从我的应用程序发送状态时，它的工作设置可用且状态为“在房间内”：

```
 ConnectionConfiguration connConfig =
            new ConnectionConfiguration(host, Integer.parseInt(port), service);
   connection = new XMPPConnection(connConfig);
   presence = new Presence(Presence.Type.available,"In Room",1,Presence.Mode.available);

        connection.sendPacket(presence); 
```

但是，当我从其他 IM 更新状态时，比如说 Adium，当我从我的 APP 更新状态时，它无法更新状态和状态，否则 Adium 和 Pidgin 可以相互配合。我意识到由于我的应用程序出了点问题。我实现了存在数据包侦听器：如果我从 Pidgin 或 Adium 更改存在，这个侦听器正在侦听它应该侦听

```
connection.addPacketListener(new PacketListener(){

        @Override
        public void processPacket(Packet presencePkt) {

            Presence pres= ((Presence) presencePkt);
            presence.setPriority(1);// presence is global variable 

        switch(pres.getMode()){
            case available: presence.setMode(pres.getMode());
                            //connection.sendPacket(pres);
            break;
            case dnd: presence.setMode(pres.getMode());
                     //connection.sendPacket(pres);
            break;

            default :
                break;

        }

    }

}, new PacketTypeFilter(Presence.class)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T17:01:19.880

我刚刚阅读了您对 Flow 的评论，这个答案很晚，但其他人可能需要同样的答案；

答案仍然是`RosterListener`按照 Flow 的建议使用（基于我使用 Smack 的经验）。

使用 RosterListener 您将收到您自己的用户以及其他用户的状态更改（来往和来自都将是您自己的用户名）。这意味着名册会为您跟踪，因此您可以使用该`Roster#getPresences(username)`方法从不同来源获取您的存在的有序列表，您可以通过使用获取用户名以动态提供`Roster#getUser()`

[此处](http://www.igniterealtime.org/builds/smack/docs/latest/documentation/roster.html)的文档涵盖了该主题并基本上解释了不同的模式具有不同的优先级，因此（例如）如果*任何*客户端让您“可用”，那么 using `Roster#getPresence(username)`(singular) 将返回可用。

如果您愿意，名册还允许您设置/更改这些优先级/排序。希望这对某人有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T18:06:55.287

98% 的习惯`PresencePacketListener`是错误的做法。相反，您想添加自己的[`RosterListener`](http://www.igniterealtime.org/builds/smack/docs/3.2.2/javadoc/org/jivesoftware/smack/RosterListener.html)with[`Roster.addRosterListener()`](http://www.igniterealtime.org/builds/smack/docs/3.2.2/javadoc/org/jivesoftware/smack/Roster.html#addRosterListener%28org.jivesoftware.smack.RosterListener%29)以对名册中实体的存在变化做出反应。

确保两个 jabber 实体至少具有订阅模式*from*或*两者*，以便服务器将在线状态节转发给您的客户端。

如果您想获取您帐户的其他资源/完整 JID 的存在。尝试[`Roster.getPresences(StringUtils.parseBareAddress(connection.getUser()))`](http://www.igniterealtime.org/builds/smack/docs/3.2.2/javadoc/org/jivesoftware/smack/Roster.html#getPresences%28java.lang.String%29)

# objective-c - 键值编码崩溃 - Objective-C

> ID：14857645
> 
> 赞同：0
> 
> 时间：2013-02-13T16:01:00.650
> 
> 标签：objective-c, key-value, key-value-coding

我正在尝试创建一个 Objective-C 类。当我使用该`-setValue:`方法时，程序在该行崩溃。这是代码： HugeNumber.h ：

```
#import <Foundation/Foundation.h>

@interface HugeNumber : NSObject{

NSString *value;
NSMutableArray *charSetArray;
}

-(void)setValueInString:(NSString *)string;
-(NSString *)valueInString;
-(int)valueInInt;
-(NSString *)decimalValueInString;
-(void)setDecimalValueInString;
@end 
```

巨大的数字.m：

```
#import "HugeNumber.h"
const NSString* charSet = @"0123456789abcdefghijklmnepqrstuvwxyz";
@implementation HugeNumber

- (id)init{
self = [super init];
if (self){
    for (int i = 0; i < [charSet length]; i++){
        NSString* str = [NSString stringWithFormat:@"%hu",[charSet characterAtIndex:i]];
        [charSetArray addObject:str];
    }
}
return self;
}

-(void)setValue:(NSString *)string{
value = string;
}

@end 
```

主.m：

```
#import <Foundation/Foundation.h>
#import "HugeNumber.h"

int main(int argc, const char * argv[])
{

@autoreleasepool {

    HugeNumber *number = [[HugeNumber alloc] init];
    NSString *string = @"11";
    [number setValueInString:string];
    NSLog(@"%i",[number valueInInt]);

}
return 0;
} 
```

我得到的错误日志是：

```
2013-02-13 17:56:43.303 Huge Numb Test[7442:303] -[HugeNumber setValueInString:]: unrecognized selector sent to instance 0x10010a620
2013-02-13 17:56:43.306 Huge Numb Test[7442:303] *** Terminating app due to uncaught exception  'NSInvalidArgumentException', reason: '-[HugeNumber setValueInString:]: unrecognized selector  sent to instance 0x10010a620'
*** First throw call stack:
(
0   CoreFoundation                      0x00007fff8a15b0a6 __exceptionPreprocess + 198
1   libobjc.A.dylib                     0x00007fff90c5e3f0 objc_exception_throw + 43
2   CoreFoundation                      0x00007fff8a1f16ea -[NSObject(NSObject)  doesNotRecognizeSelector:] + 186
3   CoreFoundation                      0x00007fff8a1495ce ___forwarding___ + 414
4   CoreFoundation                      0x00007fff8a1493b8 _CF_forwarding_prep_0 + 232
5   Huge Numb Test                      0x00000001000018a1 main + 129
6   libdyld.dylib                       0x00007fff8cfa17e1 start + 0
7   ???                                 0x0000000000000001 0x0 + 1
)
libc++abi.dylib: terminate called throwing an exception 
```

为什么程序会崩溃？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:02:40.470

您错过`setValueInString:`了 .m 文件中的方法定义。

# facebook - Facebook iOS 浏览器无法下载 Passbook 文件

> ID：14857646
> 
> 赞同：0
> 
> 时间：2013-02-13T16:01:02.437
> 
> 标签：facebook, ios6, mobile-safari, mime-types, passbook

Safari for iOS6 支持 mime 类型：application.com/vnd.apple.pkpass 这意味着您可以从 URL 下载和打开 Passbook .pkpass 文件。

Facebook 的浏览器似乎不支持这种 mime 类型，因此您无法从 Facebook 中下载 Passbook 文件。相反，您需要“在 Safari 中打开”。这是一个问题，因为企业分发存折促销（例如优惠券、会员、礼品卡或活动门票）的链接的好方法是通过 Facebook 营销活动。

如何在 Facebook 找到合适的联系人以请求 Facebook iOS 应用程序浏览器支持 .pkpass MIME 类型？

谢谢，如果你能帮忙，安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T19:02:03.830

这应该从 5.4 版本的 Facebook for iOS 应用程序开始工作。

# cakephp-2.0 - Cakephp 年份格式

> ID：14857647
> 
> 赞同：0
> 
> 时间：2013-02-13T16:01:03.317
> 
> 标签：cakephp-2.0, form-helpers

我在 Cakephp 2.x 中使用表单助手

```
<?php echo $this->Form->year('Album.year', 1950, date('Y'), array('type' => 'select', 'label' => false, 'div' => false, 'class' => "textbox", 'empty' => 'Select Year')); ?> 
```

此代码输出

```
<select id="AlbumYearYear" class="textbox" name="data[Album][year][year]">
    <option value="">Select Year</option>
</select> 
```

这样 。而其他字段输出为`name="data[Model][source_id]"`. 像这样

我将如何删除上述元素中的第二个 [year]，因为它会导致另存`$this-request->data`为`year is array element`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:17:17.677

而不是做

$this->Form->year('Album.year'

做

$this->Form->year('相册'

# java - Java IO user.dir Eclipse

> ID：14857648
> 
> 赞同：0
> 
> 时间：2013-02-13T16:01:05.110
> 
> 标签：java, eclipse, io

这是我的代码：

```
 System.out.println(System.getProperty("user.dir"));
    ///*
 Scanner in = new Scanner(new FileInputStream("src/practice_code/a.txt")); 
```

我需要从 a.txt 文件中读取值，但它拒绝读取，除非我编写这样的路径 src/practice_code/a.txt 。是否可以在 Eclipse 中更改 IO 的默认目录，所以当我指定文件时，我只需要编写 a.txt

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:45:34.903

您可以在程序的启动配置中配置不同的工作目录。选择*Run > Debug Configurations...*，选择您的启动配置，然后切换到*Arguments*选项卡。您将在选项卡底部找到工作目录的条目。

# content-management-system - clickContentEvent 的 BehaviorTracking 标记不起作用

> ID：14857652
> 
> 赞同：0
> 
> 时间：2013-02-13T16:01:11.110
> 
> 标签：content-management-system, weblogic, portal, websphere-portal, weblogic12c

我正面临 clickContentEvent BehaviorTracking 标记触发并将条目插入 bt_event 表的艰难时期。但是 displayContentEvent 工作正常，没有任何问题。

我在门户管理中正确设置了事件服务和行为跟踪服务。

com.bea.p13n.tracking.listeners.BehaviorTrackingListener 和 ClickContentEvent 已配置。

这是我试图检索内容的 JSP，当我单击链接时，它不会插入 clickContentEvent。

```
<pz:contentSelector rule="testcontent" id="nodes" sortBy="cm_nodeName desc"/>
 <utility:notNull item="<%=nodes%>">
 <utility:forEachInArray array="<%=nodes%>" id="node" type="com.bea.content.Node">

<BehaviorTracking:clickContentEvent documentId="<%=node.getName() %>" id="eventInfo"/>
<% String url = request.getContextPath() + "/ShowBinary"+node.getPath()+"?"+ eventInfo; %>
<a href="<%= url %>" ><%=node.getName() %> </a>
</utility:forEachInArray>
</utility:notNull> 
```

我在 web.xml 中有以下 Servlet 映射 -

```
<filter>
    <filter-name>ClickThroughEventFilter</filter-name>
    <filter-class>com.bea.p13n.tracking.clickthrough.ClickThroughEventFilter</filter-class>
    </filter>

    <filter-mapping>
    <filter-name>ClickThroughEventFilter</filter-name>
    <url-pattern>/ShowBinary/*</url-pattern>
    </filter-mapping> 
```

当 displayContentEvent 工作时我很困惑，为什么不是这个 clickContentEvent？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:14:48.403

我重新启动了服务器，现在它可以工作了。

# javascript - 在 Node.js 请求的响应正文之间获取未定义？

> ID：14857654
> 
> 赞同：1
> 
> 时间：2013-02-13T16:01:24.843
> 
> 标签：javascript, node.js, http, httprequest

开始学习 Node.js，用 Node.js 发送`POST`请求：

```
var http = require('http')
  , https = require('https')
  , _ = require('underscore')
  , querystring = require('querystring');    

// Client constructor ...

Client.prototype.request = function (options) {
    _.extend(options, {
        hostname: Client.API_ENDPOINT,
        path: Client.API_PATH,
        headers: {
            'user-agent': this.agent
        }
    });

    var req = (this.secure ? https : http).request(options);
    if(options.data) req.write(querystring.stringify(options.data));

    req.end();

    req.on('response', function (res) {
        res.on('data', function (chunk) {
            res.body += chunk;
        });

        res.on('end', function () {
            console.log(res.body);
        });
    });
} 
```

身体表现：`undefined<xml version="1.0" encoding="UTF-8">`。

那`undefined`是从哪里来的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-13T16:03:02.567

`res.body`您必须在添加之前进行初始化：

```
// some other code
req.on('response', function (res) {
    res.body = "";
    res.on('data', function (chunk) {
        res.body += chunk;
    });

    res.on('end', function () {
        console.log(res.body);
    });
}); 
```

否则，您将添加到`undefined`which 转换`undefined`为 string `"undefined"`。

# c# - C# using：不同方法中的构造函数

> ID：14857657
> 
> 赞同：6
> 
> 时间：2013-02-13T16:01:36.493
> 
> 标签：c#, using

`using`我可以在使用括号内直接找到 C# 实例化的所有在线示例：

```
using (var cnx = new SqlConnection()) { } 
```

我认为以下内容应该相同，但我似乎仍然锁定了资源：

```
SqlConnection GetConnection() { return new SqlConnection(); }
void foo()
{
    using (var cnx = GetConnection()) { }
} 
```

当我逐步执行我的程序并到达 using 的右括号之后的行时，我希望能够使用 SQL Server Management Studio 以任何我想要的方式更改数据库，但我不能。当我关闭我的应用程序时，错误就会消失。

这不与 SQL 隔离；我也经历过以这种方式打开文件流的情况。那就是：越过`using`块，但操作系统不允许外部应用程序更改文件。

我是否违反了`using`合同的某些部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T16:04:55.540

使用返回适当资源的方法绝对没问题。特别是，这很常见：

```
using (var writer = File.CreateText(path))
{
} 
```

（以及 中的类似方法`File`）。

基本上，这与调用方法或调用构造函数无关——肯定有其他问题。如果您可以创建一个简短但*完整*的程序来演示问题（最好使用文件而不是数据库），那么我们很可能能够帮助您找出问题*所在*，而不仅仅是问题所在:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T16:13:49.863

如果您启用了连接池，“Dispose”不一定会物理关闭连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:09:11.350

我一直在使用这种代码：

```
SqlConnection GetConnection() 
{ 
    return new SqlConnection(); 
}

void foo()
{
    using (var cnx = GetConnection()) 
    { 
        cnx.Open();
    }
} 
```

如果您真的想确定，请`cnx.Close();`在右括号之前调用。但是，在我的情况下，这从来没有必要，因为调用`Dispose`自动关闭连接。

# java - (Java) 从文本文件加载到 Arraylist

> ID：14857660
> 
> 赞同：0
> 
> 时间：2013-02-13T16:01:50.890
> 
> 标签：java, class, file-io

对于这个程序，我需要将一本书的数据列表（书名、作者、价格）从文本文件读取到单独的类（书）中的数组列表中。老实说，我只是在 Java 中使用类作为对象只是我无法理解的事情之一，而且我对 ArrayLists 没有太多经验。

```
public void loadBook(String fn) throws IOException{     
    ArrayList<Book> books = new ArrayList<Book>();
    Scanner infile = new Scanner(new InputStreamReader (new FileInputStream(fn)));
    int num = infile.nextInt();
    infile.nextLine();
    for (int i=0; i<num; i++) {
        String name = infile.nextLine();
        String author = infile.nextLine();
        Double price = infile.nextDouble();
        Book c = new Book (name, author, price);
        books.add(c);
    }
    infile.close();
    } 
```

这是目前在 Book 类中的代码。

```
public class Book extends Model {

public Book(String name, String author, Double price) {
    String Name = name;
    String Author = author;
    Double Price = price;
} 
```

文件“fn”包含以下内容：

3
姓名
作者
10.00

但是 loadBook 在读取文件时仍然会引发错误：@

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:08:41.277

使用此输入：

```
3
name
author
10.00 
```

这段代码

```
int num = infile.nextInt();
infile.nextLine();
for (int i=0; i<num; i++) {
    String name = infile.nextLine();
    String author = infile.nextLine();
    Double price = infile.nextDouble();
    Book c = new Book (name, author, price);
    books.add(c);
 } 
```

将设置`num`为 3，因此执行 for 循环 3 次。在每次迭代中，该方法`nextLine()`被调用两次和`nextDouble()`一次。但是文件中只有 3 行，所以你调用的`nextLine()`太频繁了。尝试将您的输入更改为

```
1      <-- number of listed books, not lines.
name
author
10.00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:09:35.077

尝试确保您的文本文件在 Eclipse 的包中，扩展名为 .txt

```
//see what your default path is
System.out.println(System.getProperty("user.dir"));

//then use this code as continuation to the default path...for example if your path leads to your working directory
Scanner in = new Scanner(new FileInputStream("src/package_name/filename.txt")); 
```

# javascript - 删除 JavaScript 中除数字和空格之外的所有内容

> ID：14857661
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:02:10.420
> 
> 标签：javascript, regex

我有一个当前匹配任何非数字字符的正则表达式：

```
var.replace(/[^0-9a-zA-Z ]/,''); 
```

我现在需要保留空格和数字，但我很难修改它。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T16:14:44.147

这是一个正则表达式，它将匹配所有不是数字或空格的东西..

```
[^0-9\s] 
```

解释嘿正则表达式引擎：

1-匹配每一件事。

2- `^`--> 那不是

3- `0-9`--> 一个数字

4- `\s`--> 和一个空格

# php - 如果表单提交时带有空字段，则将预定义值更新到 mysql 数据库中

> ID：14857662
> 
> 赞同：0
> 
> 时间：2013-02-13T16:02:10.950
> 
> 标签：php, mysql, forms

语法

```
$default_message = "No food name entered";
    if(isset($_POST['food_name']) && !empty($_POST['food_name'])){  
       echo $_POST['$dafult_message'];
    } 
```

应该检查数据库中的字段`food_name`是否为空或为空，并在以下表单使用空字段更新时尝试将预定义的值`No food name entered`插入数据库，但不幸的是它不会更新预定义的值。我看不出有什么不合逻辑的地方。任何想法？

* * *

```
if ((isset($_POST["MM_update"])) && ($_POST["MM_update"] == "formX")) { 

    $default_message = "No food name entered";
    if(isset($_POST['food_name']) && !empty($_POST['food_name'])){  
       echo $_POST['$dafult_message'];
    }

$updateSQL = sprintf("UPDATE foodtable SET food_name=%s WHERE food_id=%s",    
                       GetSQLValueString($_POST['food_name'], "text"),
                       GetSQLValueString($_POST['food_id'], "int"));

  mysql_select_db($database_XYZ, $XYZ);
  $Result1 = mysql_query($updateSQL, $XYZ) or die(mysql_error());

  $updateGoTo = "choicefood.php";
  if (isset($_SERVER['QUERY_STRING'])) {
    $updateGoTo .= (strpos($updateGoTo, '?')) ? "&" : "?";
    $updateGoTo .= $_SERVER['QUERY_STRING'];
      }
  header(sprintf("Location: %s", $updateGoTo));
    exit ();
} 
```

* * *

```
<form action="<?php echo $editFormAction; ?>" method="post" name="formX" id="formX">
<table align="center">
  <tr valign="baseline">
    <td align="right" nowrap="nowrap">Update Food Name:</td>
    <td><input type="text" name="food_name" value="" size="32" /></td>
  </tr>
   <tr valign="baseline">
    <td nowrap="nowrap" align="right">
     <input type="hidden" name="MM_update" value="formX" />
      <input type="hidden" name="food_id" value="<?php echo $query['food_id']; ?>" />
     </td>
                    <td>
                    <input type="submit" value="Update Food Name" />
                    </td>
                  </tr>
                </table>
              </form> 
```

* * *

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:08:24.717

像这样试试

```
 $default_message = "No food name entered";

    if ( @$_POST['food_name'] == '' ) {

        $_POST['food_name'] = $default_message;

    }

    echo '<p>', $_POST['food_name'], '</p>; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:13:31.830

您的代码应该可以按预期工作，但是您`"$default_message"`在这行代码中拼错了：

```
echo $_POST['$dafult_message']; 
```

# ajaxcontroltoolkit - 防止“ENTER”从自动完成列表中选择一个项目以关闭模式弹出对话框

> ID：14857666
> 
> 赞同：0
> 
> 时间：2013-02-13T16:02:17.877
> 
> 标签：ajaxcontroltoolkit, asp.net-4.0, autocompleteextender

我有一个设置，其中有一个 ASP.NET 4.0 用户控件，其中包含两个文本框`OK`和一个`Cancel`按钮。

第一个文本框附加了一个 Ajax Control Toolkit Autocomplete Extender，用于在用户开始输入内容时显示匹配的瑞士邮政编码列表。奇迹般有效。

我还将`DefaultButton`用户控件的最外层`<asp:Panel>`设置为保存（确定）按钮。

现在我遇到了这样一种情况：用户开始输入一些东西，为他的案例获取一个“自动完成”的选项列表，然后从该自动完成列表中选择一个项目。当用户现在按下`Enter`做出选择时，发生的情况是数据很好地填充到文本框中 - 但用户控件也关闭（它作为模式弹出窗口打开），因为它`Enter`也触发了`DefaultButton`“点击”及其处理程序被执行。

有什么方法可以“吞下”或阻止`Enter`击键冒泡到面板上？

这是我的标记和代码：

```
<script type="text/javascript">
   function IAmSelected(source, eventArgs) {
       var textval = eventArgs.get_text().split(' - ');

       $('#<%= tbxZipCode.ContainedTextBoxClientID %>').val(textval[0]);
       $('#<%= tbxCity.ContainedTextBoxClientID %>').val(textval[1]);

       // here, I tried "return false;"  - didn't work either....
       source.preventDefault(); 
   }

<asp:Panel runat="server" ID="PanelZipCodes" DefaultButton="btnSave">

    <asp:TextBox runat="server" ID="tbxZipCode" />
    <asp:AutoCompleteExtender runat="server" ID="AutoCompletePlz" TargetControlID="tbxZipCode" BehaviorID="ZipCodeBehavior" 
                              Enabled="True" MinimumPrefixLength="1" CompletionInterval="50" CompletionSetCount="15"
                              FirstRowSelected="True" ServiceMethod="GetMatchingPlz" OnClientItemSelected="IAmSelected" />

    <asp:TextBox runat="server" ID="tbxCity" />

    <asp:Button runat="server" ID="btnSave" OnClick="btnSaveClick" />    
    <asp:Button runat="server" ID="btnCancel" OnClick="btnCancelClick" />
</asp:Panel> 
```

有任何想法吗？我相信我必须在`IAmSelected`脚本片段中做一些事情——但究竟是什么？我尝试使用`return false;`- 没有用；然后我尝试`source.preventDefault();`了-也不起作用-`Enter`仍然“冒泡”到面板并使其“单击”`btnSave`按钮并关闭模式弹出窗口...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:36:01.823

不确定这是否会有所帮助，让我们试试吧。下载 AjaxControlToolkit 源并尝试更改此文件：[AutoCompleteBehavior.pre.js](http://ajaxcontroltoolkit.codeplex.com/SourceControl/changeset/view/a2a6dc6854e0#Client/MicrosoftAjax.Extended/AutoComplete/AutoCompleteBehavior.pre.js)

添加到`_onKeyDown`方法单行代码

```
 else if (k === Sys.UI.Key.enter) {
        if (this._selectIndex !== -1) {
            this._setText(this._completionListElement.childNodes[this._selectIndex]);
            ev.stopPropagation(); // added line
            ev.preventDefault();
        } else {
            // close the popup
            this.hidePopup();
        }
    } 
```

# events - 事件存储、域和敏捷，如何处理

> ID：14857669
> 
> 赞同：0
> 
> 时间：2013-02-13T16:02:25.860
> 
> 标签：events, design-patterns, domain-driven-design, agile, scrum

在我的工作中，我们为我们的软件平台使用了域驱动的 CQRS 架构，并带有一个事件存储系统，以便我们可以在新版本中发生域更改的情况下重新加载域中的事件。到目前为止没有什么特别的。

我们的一项工作协议是我们不惜一切代价尝试避免更改事件，因为这会破坏生产环境中事件存储中的旧版本事件。如果我们真的想改变一个事件，我们必须为旧版本编写转换器，因为这会变得乏味、混乱，有时甚至是不可能的，我们尽量避免这种情况。

但是，我们也进行敏捷软件开发，这对我来说（除其他外）意味着“不要在你的代码中提前计划太多，只编写你将在不久的将来实际使用的代码”。在大多数情况下，这对我来说是有意义的。

但这成为上述事件的问题。当我创建新事件时，我必须向其中添加几乎所有相关数据，以便任何处理事件的系统都拥有它需要的所有数据。但是，从敏捷的角度来看，我更愿意只将数据添加到当时我实际需要的事件中。

所以我的问题是；处理这种困境的最佳方法是什么？我能想到的唯一“解决方案”要么放弃 no-editing-events-rule 并接受我们将不得不编写事件转换器，或者尝试为每个事件添加尽可能多的相关数据如果将来数据仍然不足，则创建新事件。

另一种可能是我们的思维方式存在缺陷。你们认为这种方法中最薄弱的环节是什么？有没有更好的方法来处理这个？

我希望这个问题有意义，我期待其他观点:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-20T05:49:09.087

> 域对象不可能猜测任何订阅者的需求。域对象的职责只是生成说明发生了什么的事件。@MikeSW 在这个[答案中](https://stackoverflow.com/questions/19803364/should-i-use-domain-objects-as-fields-in-domain-events-whe-using-event-sourcing)

这是我的策略：

**a) 在查询组件的帮助下发布带有基本字段的事件。**

例如，我们正在开发一个酒店评论应用程序。每条评论只有在管理员批准后才能被其他客户查看。

```
public class CommentApprovedEvent {
    private String commentId;
} 
```

并且事件处理程序更新评论查询数据的状态。到目前为止一切顺利。有时稍后，一些进一步的要求会随之而来，例如当评论被批准时，最新批准的评论内容应该被视为酒店的“推荐”评论。

我们确实在评论中有hotelId 和内容。但这一次，我们选择不将它们添加到事件中。相反，我们使用查询在事件处理程序中检索它：

公共类 HotelEventHandler {

```
 public void on(CommentApprovedEvent event) {
        CommentDetailDto comment = commentDetailQueryService.
            findBy(event.getCommentId());
        comment.getHotelId();
        comment.getContent();
        //update hotel's query data
    }
} 
```

有时，甚至不可能将所有相关数据添加到事件中。例如，有时后来，一个新的要求来了：当评论被批准时，评论者应该被奖励一些积分。但我们在评论中没有评论者的完整资料。所以我们再次选择查询。

**b) 将大事件拆分成较小的事件。** 在这种情况下，我们可以添加新事件而不是新属性。考虑 DDD 示例中的交付案例，交付是货物域中的一个重要值对象，它显示了给定货物的许多方面：

```
/**
 * The actual transportation of the cargo, as opposed to
 * the customer requirement (RouteSpecification) and the plan (Itinerary). 
 *
 */
public class Delivery {//value object

  private TransportStatus transportStatus;
  private Location lastKnownLocation;
  private Voyage currentVoyage;
  private boolean misdirected;
  private Date eta;
  private HandlingActivity nextExpectedActivity;
  private boolean isUnloadedAtDestination;
  private RoutingStatus routingStatus;
  private Date calculatedAt;
  private HandlingEvent lastEvent;
  .....rich behavior omitted
} 
```

交付指示货物的当前状态，一旦登记了新的货物装卸事件或更改路线规范，就会重新计算：

```
//non-cqrs style of cargo
public void specifyNewRoute(final RouteSpecification routeSpecification) {
     this.routeSpecification = routeSpecification;
     // Handling consistency within the Cargo aggregate synchronously
     this.delivery = delivery.updateOnRouting(this.routeSpecification, this.itinerary);
} 
```

我想到一开始我需要一个 CargoDeliveryUpdatedEvent，比如：

```
//cqrs style of cargo
public void deriveDeliveryProgress(final HandlingHistory handlingHistory) {
     apply(new CargoDeliveryUpdatedEvent(
         this.trackingId, delivery.derivedFrom(routeSpecification(), 
         itinerary(), handlingHistory);
}

class CargoDeliveryUpdatedEvent {
    private String trackingId;
    private .....   //same fields in Delivery?
    private .....   //add more when requirements evolves?
} 
```

但最后我发现我可以使用更小的事件来更好地揭示意图，比如：

```
//cqrs style of cargo
public void deriveDeliveryProgress(final HandlingHistory handlingHistory) {
     final Delivery delivery = Delivery.derivedFrom(
         routeSpecification(), itinerary(), handlingHistory);
     apply(new CargoRoutingStatusRecalculatedEvent(this.trackingId, 
         delivery.routingStatus());
     apply(new CargoTransportStatusRecalculatedEvent(this.trackingId, 
         delivery.routingStatus());
     ....sends events telling other aspects of the cargo
}

class CargoRoutingStatusRecalculatedEvent{
    private String trackingId;
    private String routingStatus;
}

class CargoTransportStatusRecalculatedEvent{
    private String trackingId;
    private String transportStatus;
} 
```

希望这些有所帮助。干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:08:19.567

您将事件存储多长时间？您的问题只是在系统升级期间的“混合模式”操作的短期内，还是您有某种需要支持多个历史版本事件的长期存储模型？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T21:45:31.730

“改变”必须被接受，而不是被阻止。您的系统应该有一个内置的解决方案来接受更改作为正常软件生命周期的一部分。与此相反，您可能会比实施接受它作为“功能”的解决方案“花费”更多。

如果我对他的理解正确的话，我会朝着与 Addy 相同的方向前进。您需要对事件模型进行版本控制。您应该建立一种版本控制事件/软件系统，该系统将允许任何新软件版本与旧事件模型向后兼容。我不认为这是一个无法克服的问题，但你可能不得不回到你的建筑图纸。

# javascript - 可编辑旋转文本的问题定位

> ID：14857679
> 
> 赞同：3
> 
> 时间：2013-02-13T16:02:50.913
> 
> 标签：javascript, html, css

我正在尝试制作一个表格，其中某些文本单元格是垂直的（旋转的），但在**获得一致的定位时遇到了很大的问题**。我有基本的大纲工作。在 IE 中有点偏离（大惊喜），但我想我可以用某种 browser-conditional 来解决这个问题。然而，真正的问题是，当第一次选择时，顺便说一句可编辑的文本会移动一点。这有点难以解释，所以你可以自己看看：http: [//gdurl.com/eM_F](http://gdurl.com/eM_F)

在 Chrome 中，它总是在第一次在字段之间切换以聚焦它们时发生，而不是单击。*有时*在单击它们后输入它们。

在 IE 中，它总是在字段第一次获得焦点时发生。

我想以某种方式使用 css 解决这个问题，但如果需要，我可以使用 javascript/jquery。我确实尝试`focus()`在页面加载时调用它们，以便它们的位置保持一致，但它不起作用。还尝试将 contenteditable-attribute 设置为 false，并设置 tabindex 以希望在获得焦点时将 contenteditable 设置为 true 会修复它，但即使 contenteditable 为 false，它在选项卡上的行为仍然像那样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:31:13.140

Thanks for all the replies. Apparently the problem was the "overflow:hidden". Either removing it or setting it to the same element as the rotation did the trick. But I'm still working on getting this to work consistently cross-browser. I'm coming back with a more thorough answer.

# ios - json数据自定义http请求

> ID：14857681
> 
> 赞同：1
> 
> 时间：2013-02-13T16:02:53.650
> 
> 标签：ios, objective-c, json

到目前为止，我一直在使用objective-c 中的json（使用SBJson 类）从restAPI 接收数据。我现在正在尝试发送帖子数据，但我没有这方面的经验。原始主体如下所示：

```
 //http://www.myapi.com/api/user=123
  "Username": "foo",
  "Title": null,
  "FirstName": "Nick",
  "MiddleInitial": null,
  "LastName": "Foos",
  "Suffix": null,
  "Gender": "M",
  "Survey": {
         "Height": "4'.1\"",
         "Weight": 100,
               } 
```

这种数据的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:45:52.550

您需要一个包含上述每个键条目的字典，然后将字典转换为 JSON 字符串。请注意，Survey 键本身就是一个字典。像这样的东西。

```
NSMutableDictionary *dictJson= [NSMutableDictionary dictionary];
[dictJson setObject:@"foo" forKey:@"Username"];
...
[dictJson setObject:dictSurvey forKey:@"Survey"];

//convert the dictinary to a JSON string
NSError *error = nil;
SBJsonWriter *jsonWriter = [[SBJsonWriter alloc] init];
NSString *result = [jsonWriter stringWithObject:dictJson error:&error];
[jsonWriter release]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:49:00.547

假设您有一个字符串中的帖子数据，称为`myJSONString`. （从 Objective-C 集合到 json 也很简单。看起来@Joel 回答了这个问题）。

```
// build the request
NSURL *url = [NSURL urlWithString:@"http://www.mywebservice.com/user"];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
request.HTTPMethod = @"POST";

// build the request body
NSData *postData = [myJSONString dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
[request setHTTPBody:postData];
[request setValue:[NSString stringWithFormat:@"%d", [postData length]] forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];

// run the request
[NSURLConnection sendAsynchronousRequest:request
                                   queue:[NSOperationQueue mainQueue]
                       completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                           if (!error) {
                               // yay
                           } else {
                               // log the error
                           }
                       }]; 
```

# sql - SQL - 过去 6 个月 (12,18,24,30) 除以 6 个月查询

> ID：14857682
> 
> 赞同：0
> 
> 时间：2013-02-13T16:02:55.727
> 
> 标签：sql, sql-server-2008-r2

好的，我正在为报告编写一个存储过程，我需要每个人的最后销售日期都在 6 的除数中，例如 - 当报告运行时，它将使用今天的日期作为日期，并且任何人的最后销售日期都是准确的从今天开始的 6 个月或 12 个月或 18 个月应在存储过程中返回。

我最初的想法是使用 where 子句；

```
WHERE LastSaleDate = DATEADD(m, -6, @Date)
   OR LastSaleDate = DATEADD(m, -12, @Date)... 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:42:47.520

您可以以 6 个月为增量加入日期列表。如果没有完整的 DDL，我将无法创建完整的查询，但您应该能够使用以下内容：

```
SELECT  *
FROM    T
        INNER JOIN
        (   SELECT  [Date] = DATEADD(MONTH, - Number, @Date)
            FROM    Master..spt_values
            WHERE   Type = 'P'
            AND     Number % 6 = 0
        ) D
            ON D.Date = T.LastSalesDate 
```

# c# - 仅显示 LinqDataSource 的某些项

> ID：14857684
> 
> 赞同：-2
> 
> 时间：2013-02-13T16:02:58.683
> 
> 标签：c#, asp.net, gridview

我在 aspx 代码中有一个与 LinqDataSource 绑定的 gridview。我只需要显示存储在数据库中的一些项目。我怎样才能从 c# 做到这一点？

在 aspx 中：

```
<asp:GridView 
        ID="GridViewItems" runat="server" AutoGenerateColumns="False" DataSourceID="LinqDataSourceItems" /> 
```

在c#中？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T17:36:45.530

既然我们在黑暗中刺伤，那么 LinqDataSource 中的 WhereParameter 怎么样？

```
<asp:LinqDataSource runat="server" ID="LinqDataSourceItems" ContextTypeName="CamillasDataContext" TableName="TableFoo" OrderBy="CreatedDateDescending" Where="ThingId == @ThingId">
     <WhereParameters>
           <asp:QueryStringParameter QueryStringField="id" Name="ThingId" Type="Int32" />
     </WhereParameters>
 </asp:LinqDataSource> 
```

除了 QueryString 参数之外，您还有以下参数：Route、Session、Cookie、Form、Profile 等等。

# jquery - jquery 使用选项卡开关递归过滤

> ID：14857686
> 
> 赞同：0
> 
> 时间：2013-02-13T16:03:05.570
> 
> 标签：jquery, search, filter

我对 JQuery 不是很好，但这次我已经走得很远了..

我试图让下面的内容在输入时显示搜索结果，如果您输入“rob”并单击“B”，它就会这样做。字母选择器工作正常：

[http://tm.eth3r.co.uk/test3.html](http://tm.eth3r.co.uk/test3.html)

我在这里弹出了所有代码，这可能更容易查看：http: [//jsfiddle.net/ro6er/gQ6Nc/](http://jsfiddle.net/ro6er/gQ6Nc/) （忽略所有css，直接来自wordpress）

这是jQuery：

```
$(function() {
    //a-z switcher
    $(document).ready(function() {
        $('.navigation-tabs a').click(function(){
            switch_tabs($(this));
            return false;
        });
        switch_tabs($('.default-tab'));  
    });
    function switch_tabs(obj)
    {   

            $('.tab-content').hide();

        $('.navigation-tabs a').removeClass("selected");
        var id = obj.attr("data-custom-attr");
        $('#'+id).show();
        obj.addClass("selected");
    }
    //a-z switcher
        if ($("#searchInput").keyup)
        {

 //Declare the custom selector 'containsIgnoreCase'.
      $.expr[':'].containsIgnoreCase = function(n,i,m){
          return jQuery(n).text().toUpperCase().indexOf(m[3].toUpperCase())>=0;
      };

      $("#searchInput").keyup(function(){
 //hide all the rows
          $(".tab-content").find("table").hide();

 //split the current value of searchInput
          var data = this.value.split(" ");
 //create a jquery object of the rows
          var jo = $(".tab-content").find("table");
 //Recursively filter the jquery object to get results. 
          $.each(data, function(i, v){
               jo = jo.filter("*:containsIgnoreCase('"+v+"')");
          });
 //show the rows that match.
          jo.show();
 //Removes the placeholder text 
      }).focus(function(){
          this.value="";
          $(this).css({"color":"black"});
          $(this).unbind('focus');
      }).css({"color":"#C0C0C0"});
        }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T14:15:52.430

我想通了，我需要针对不同的div。我已经更新了我的 jsfiddle：http: [//jsfiddle.net/ro6er/gQ6Nc/](http://jsfiddle.net/ro6er/gQ6Nc/)

用户测试并通过搜索框或 A 和 B 以查看结果。

```
 $(document).ready(function() {
  //a-z switcher

  $(document).ready(function() {
    $('.navigation-tabs a').click(function(){
      switch_tabs($(this));
      return false;
    });
    switch_tabs($('.default-tab'));  
  });
  function switch_tabs(obj)
  { 

      $('.tab-content').hide();

    $('.navigation-tabs a').removeClass("selected");
      var id = obj.attr("data-custom-attr");
    $('#'+id).show();
    obj.addClass("selected");
  }
  //a-z switcher

  if ($("#searchInput").keyup)
    {
 //Declare the custom selector 'containsIgnoreCase'.
      $.expr[':'].containsIgnoreCase = function(n,i,m){
          return jQuery(n).text().toUpperCase().indexOf(m[3].toUpperCase())>=0;
      };

      $("#searchInput").keyup(function(){
 //hide all the rows
          $("#searchblock").find(".tab-content").hide();

 //split the current value of searchInput
          var data = this.value.split(" ");
 //create a jquery object of the rows
          var jo = $("#searchblock").find(".tab-content");
 //Recursively filter the jquery object to get results. 
          $.each(data, function(i, v){
               jo = jo.filter("*:containsIgnoreCase('"+v+"')");
          });
 //show the rows that match.
          jo.show();
 //Removes the placeholder text 
      }).focus(function(){
          this.value="";
          $(this).css({"color":"black"});
          $(this).unbind('focus');
      }).css({"color":"#C0C0C0"});
    }
  }); 
```

我是王牌

罗杰

# syntax - Coffeescript 相当于 python 'pass' 语句

> ID：14857688
> 
> 赞同：20
> 
> 时间：2013-02-13T16:03:15.820
> 
> 标签：syntax, coffeescript

在 Python 中，可以使用“pass”语句什么都不做：

```
if true:
    pass 
```

咖啡脚本中有类似的说法吗？我正在尝试执行 switch 语句，如果满足某些条件，则什么也不做。

```
switch variable:
  when 5 then pass
  else do variable 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-14T14:38:24.250

我是一个快乐的用户

```
switch x
  when 1
   null
  when 2
   y = 3
  else
   y = 4 
```

因为`null`已经在语言中，并且确实在语义上传输了“无”的含义。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-02-13T16:41:44.757

与 Python 不同，空块（通常）在 CoffeeScript 中有效。所以你可以简单地使用：

```
switch variable:
  when 5 then
  else
    variable 
```

请注意，没有`then`它将无法编译，我觉得这有点奇怪。不过，这很普遍：

```
if x
else if y
  something()
else
  somethingElse() 
```

是完全有效的 CoffeeScript。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-13T16:37:27.847

因为在 CoffeeScript 中每个表达式都有一个值`pass`，所以如果存在关键字，它就等同于 value `undefined`。所以，你可以定义

```
pass = undefined 
```

然后`pass`像在 Python 中一样使用：

```
switch variable
   when 5
     pass
   else
     do variable 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-13T16:07:27.660

我总是为此使用分号：

```
switch variable
  when 5 then ;
  else do variable 
```

这是因为在 javascript 中，分号是一个有效的语句，它也恰好什么也不做。

**更新**：我只是想到了另一种有趣的方法。您可以定义`pass`为全局变量并将其设置为`undefined`：

```
window.pass = undefined

switch variable
  when 5 then pass
  else do variable 
```

您唯一需要注意的是`pass`用作局部变量或重新定义全局`pass`变量。那会破坏你的代码。

如果你使用谷歌的闭包编译器，你可以注释这个变量，使它成为一个常量：

```
`/** @const */ var pass;` 
```

但是它必须在每个文件的开头。不过，您可以编写自己的预处理器来自动执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-23T12:56:32.663

这在咖啡脚本中对我来说很有意义：

```
switch variable
    when "a" then doSomething()
    when "b" then break 
```

这编译为以下js：

```
switch (variable) {
    case "a":
        doSomething();
        break;
    case "b":
        break;
} 
```

注意：你不应该像@flow 所建议的那样使用 null，因为它会插入一个像这样的不必要的语句

```
null; 
```

# forms - 获取和存储用户IP地址javascript

> ID：14857689
> 
> 赞同：1
> 
> 时间：2013-02-13T16:03:18.590
> 
> 标签：forms, ip

我是 javascript 和一般编程的新手。我有一个谷歌网站，我想记录从该网站提交表单的用户的 ip。我看到，谷歌搜索可以使用外部服务来获取 IP 地址，但我试图弄清楚如何在我的站点中设置一个脚本（我想是一个 javascript）来完成任务。

特别是，我需要的是以下内容：

1）站点内的脚本必须获取IP地址。我在您的论坛中找到了以下代码，应该可以完成这项工作。

```
<script type="application/javascript">
  function getip(json){
    alert(json); // alerts the ip address
  }

</script>

<script type="application/javascript" 
       src="http://www.anotherdomain.com/file.php? callback=getip"> 
</script> 
```

如何从 javascript 函数中调用它？

2）在获得IP地址后，我想用它填写表格的文本区域，并在提交时将其发送到谷歌电子表格。如何获取 ip 输出并使用 javascript 代码将其发送到文本框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-03T15:39:00.613

```
 var ip ; 
   $.ajax({
    url: '//freegeoip.net/json/',
    type: 'POST',
    dataType: 'jsonp',
    success: function(location) {
        ip = location.ip;
        $("textarea").val(ip);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-12T06:29:58.187

您绝对正确，您只能通过使用外部资源来获取用户 IP 地址。让我们使用[ipify.org 来做吧！](https://www.ipify.org/)

因此，请在此处查看文档。在那里你会发现你需要两件事。

1.  在您的 HTML 正文加载后设置`<script>`如下；

`<script type="application/javascript" src="https://api.ipify.org?format=jsonp&callback=getIP" defer></script>`

请注意，该`<script>`标签将联系 ipify.com 并返回用户 IP 地址，然后将其作为 JSONP 传递给我们称为 getIP() 的 JavaScript 函数。

2.  设置下面的函数，这是我写的设置 a 的值的函数`<textarea>`a `<div>`;

```
 function getIP(json){
            document.getElementById("ipaddress").value = json.ip;
         }
```

这是`<div>`：

```
<div style="display: none;">
    <label>Ip address is:</label>
    <textarea id="ipaddress"></textarea>
</div>
```

请注意，我将 设置`<style>`为；`display: none;`和`id="ipaddress"`对于`<textarea>`。这会将其设置`<div>`为不显示给您的用户，并且可以更轻松地将我们的 IP 地址传递给我们的服务器/数据库。像这样：

```
function submit(){
        let someValue = document.getElementById('someValue').value;
        let someotherValue = document.getElementById('someotherValue').value;
        let ip = document.getElementById('ipaddress').value;
       var formData = {
         someValue,someotherValue,ip 
       }
       google.script.run.serverSideFunction(formData)
       }
```

# javascript - 在单个 div 中加载不同的 php 页面

> ID：14857691
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:03:23.687
> 
> 标签：javascript, html

如何在单个 div 块上加载我的 php 页面？我的 index.php 上的示例我有

```
<a>when i click this link it loads the home.php page on the div</a>
<a>when i click this link it loads the location.php page on the div</a>
<div id="content">
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:05:19.323

使用 jQuery，您可以使用**.load**和**.html**函数将各个页面加载到内容 div

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:05:24.560

您可以使用 jQuery[`load()`](http://api.jquery.com/load/)方法：

```
$('#content').load('home.php'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:08:31.273

您可以使用 iframe 作为“页面内容 div”

```
<iframe src="http://www.stackoverflow.com"></iframe> 
```

# jquery - FireFox 如何设置 Origin Request Header？

> ID：14857693
> 
> 赞同：1
> 
> 时间：2013-02-13T16:03:34.403
> 
> 标签：jquery, firefox, http-headers, http-post

你能解释一下在 CORS HTTP Post 完成后 FireFox 如何设置 Origin 标头吗？（这个问题的原因是要了解为什么 FireFox 在我的 HTTP Post 请求中将 Origin 标头设置为 NULL，而 IE 至少能够设置 Referer）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T14:58:50.190

Origin 标头设置为规范要求的方式：您获取页面的来源并将其序列化。

请注意，如果您的页面位于`file://`URI 中，它将序列化为空源。因此，根据您的测试方式，您可能会遇到这种情况。

# c++ - C++ boost::shared_ptr 的深拷贝

> ID：14857694
> 
> 赞同：2
> 
> 时间：2013-02-13T16:03:35.653
> 
> 标签：c++, boost, deep-copy

我正在尝试为 C++ boost::shared_ptr 做深拷贝。

```
struct A{
   boost::shared_ptr<const Data> dataPtr;

   A(const A& aSource) {
      dataPtr.reset(new const Data);
      *dataPtr  = *(aSource.dataPtr);
}; 
```

但是，我得到了错误：错误：'const struct A.'的'new'中未初始化的常量。

如果我不想放弃 const，如何处理？

任何帮助将不胜感激。

谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T16:10:12.500

那是因为您试图通过`const`对它的引用来修改（特别是分配）一个值（因为这是取消引用 a`shared_ptr`给`const`您的东西）。假设`Data`有一个复制构造函数，你应该这样重写你的程序：

```
struct A
{
    boost::shared_ptr<const Data> dataPtr;

    A(A const& aSource)
    {
        dataPtr.reset(new Data(*(aSource.dataPtr)));
    }
}; 
```

# ios - CGContextSetShadowWithColor 未在设备上显示

> ID：14857695
> 
> 赞同：1
> 
> 时间：2013-02-13T16:03:38.007
> 
> 标签：ios, core-graphics

我有一个自定义 UIView，它是一个带有圆角、阴影和小边框的矩形。

```
- (void) drawRect:(CGRect)rect {
    //// General Declarations
    CGContextRef context = UIGraphicsGetCurrentContext();

    //// Shadow Declarations
    CGColorRef shadow = [UIColor colorWithRed:0.0/255.0 green:0.0/255.0 blue:0.0/255.0 alpha:0.3].CGColor;
    CGSize shadowOffset = CGSizeMake(0, 1);
    CGFloat shadowBlurRadius = 2;

    //// Abstracted Graphic Attributes
    CGRect roundedRectangleFrame = CGRectMake(2, 0, rect.size.width - 4, rect.size.height - 2);

    //// Rounded Rectangle Drawing
    UIBezierPath* roundedRectanglePath = [UIBezierPath bezierPathWithRoundedRect: roundedRectangleFrame cornerRadius: 2];
    CGContextSaveGState(context);
    CGContextSetShadowWithColor(context, shadowOffset, shadowBlurRadius, shadow);
    [[UIColor whiteColor] setFill];
    [roundedRectanglePath fill];
    CGContextRestoreGState(context);

    [[UIColor colorWithRed:200.0/255.0 green:200.0/255.0 blue:200.0/255.0 alpha:0.3] setStroke];
    roundedRectanglePath.lineWidth = 0.5;
    [roundedRectanglePath stroke];
} 
```

我的问题是，在模拟器中，一切都完美呈现，但是当我在设备上运行代码（我使用 iPod touch 4 Generation）时，它只呈现圆角矩形和边框，但没有阴影。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:09:31.903

您已经找到了解决方案，但我将解释您的原始代码为何不起作用以及您的解决方案为何起作用。

您正在使用 ARC，这意味着编译器会自动为您管理 Objective-C 对象的生命周期。但是编译器不知道也不管理 Core Foundation 对象的生命周期。您的原始代码是这样说的：

```
CGColorRef shadow = [UIColor colorWithRed:0.0/255.0 green:0.0/255.0 blue:0.0/255.0 alpha:0.3].CGColor; 
```

当您调用 时`+[UIColor colorWithRed:green:blue:]`，它会返回对`UIColor`对象的引用。您立即将`CGColor`消息发送到`UIColor`对象，得到一个`CGColorRef`.

由于您在方法的后面不使用该对象，因此编译器认为在该语句结束时立即`UIColor`释放该对象是安全的。`UIColor`释放`UIColor`那里释放它。当它被释放时，`UIColor`对象释放`CGColor`对象。由于您没有声明该`CGColor`对象的所有权，因此该版本会取消分配该`CGColor`对象。当您到达该`CGContextSetShadowWithColor`语句时，包含该`CGColor`对象的内存处于未知状态。

您的解决方案通过将`+[UIColor colorWithRed:green:blue:]`消息嵌入到使用该`CGColor`对象的语句中来解决问题。因此，当语句结束并`UIColor`释放和解除分配时，您已经将其交给`CGColor`了图形上下文，它保留了它，防止它被解除分配。

这也是我解决问题的方法。但还有其他方法。`CGColor`另一种方法是明确声明对象的所有权：

```
CGColorRef shadow = CGColorRetain([UIColor colorWithRed:0.0/255.0
    green:0.0/255.0 blue:0.0/255.0 alpha:0.3].CGColor);

...

CGContextSetShadowWithColor(context, shadowOffset, shadowBlurRadius, shadow);
CGColorRelease(shadow); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T19:36:38.290

我无法真正解释为什么，而是使用 UIColor 表达式本身“解决”了问题，而不是使用 CGColorRef。现在，它在模拟器和设备上的所有分辨率下都能完美呈现。

现在工作的代码如下所示：

```
- (void) drawRect:(CGRect)rect {
//// General Declarations
CGContextRef context = UIGraphicsGetCurrentContext();

//// Shadow Declarations
CGSize shadowOffset = CGSizeMake(0, 1);
CGFloat shadowBlurRadius = 2;

//// Abstracted Graphic Attributes
CGRect roundedRectangleFrame = CGRectMake(2, 0, rect.size.width - 4, rect.size.height - 2);

//// Rounded Rectangle Drawing
UIBezierPath* roundedRectanglePath = [UIBezierPath bezierPathWithRoundedRect: roundedRectangleFrame cornerRadius: 2];
CGContextSaveGState(context);
CGContextSetShadowWithColor(context, shadowOffset, shadowBlurRadius, [UIColor colorWithRed:0.0/255.0 green:0.0/255.0 blue:0.0/255.0 alpha:0.3].CGColor);
[[UIColor whiteColor] setFill];
[roundedRectanglePath fill];
CGContextRestoreGState(context);

[[UIColor colorWithRed:200.0/255.0 green:200.0/255.0 blue:200.0/255.0 alpha:0.3] setStroke];
roundedRectanglePath.lineWidth = 0.5;
[roundedRectanglePath stroke]; 
```

}

# php - li 不显示内联

> ID：14857700
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:03:53.533
> 
> 标签：php, html, css, block, inline

我正在显示来自数据库的电影列表——它们应该是内联显示的，但它们是垂直显示的。我曾尝试对 li 和 inline 使用 inline-block，但没有任何效果。任何帮助表示赞赏。谢谢！

```
.movienav {
    height: 500px;
    width:75%; 
    float:left;
    margin-top:25px; 
    clear:left;
    padding-bottom: 45px;
}

.movienav li {
    width: 340px;
    height: 450px;
    float: left;
    margin-right: 10px;
    position: relative;
    display:inline;
    list-style:none;

}

.movienav li div {
    backface-visibility:hidden;
    width: 340px;
    height: 450px;
    overflow: hidden;
    background: #161616;
    position: absolute;
    top: 0;
    left: 0;
    display:inline;

}

.movienav li div.back {
    backface-visibility:hidden;
    left: -999em;
    padding-bottom: 15px;  
    background-color:#161616; /*max-height:450px; overflow:auto;*/
    margin-top: 0;
    display:inline;

}

<div class="movienav">
<ul>
<li><div class="front"><img src="<?php echo $imglink; ?>" width="340" height="450" class="dvdcover" /></div>
<div class="back">

<p><?php echo $description; ?></p>
</div>
</li>
</ul>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:06:11.773

`<div>`s 和inside`<p>`是`<li>`块元素。你应该把`display:inline`那些`<div>`s 和`<p>`.

此外，`$description`变量中作为块级元素的任何 HTML 都会导致相同的行为。

**编辑：**您的网站上有更大的问题导致问题。

`<div id="movienav"></div>`你一遍又一遍地重复你的代码，每一个都有一个`<ul>`和一个`<li>`项目。首先，您不能拥有多个具有相同唯一 ID 的容器。其次，那些`<div>`s 是块元素，因此它们不显示内联。

你需要设置你的结构看起来更像这样：

```
<div id="movienav">
  <ul>
     <li></li>
     <li></li>
     <li></li>
     <li></li>
  </ul>
</div> 
```

不是你拥有它的方式，那么你的风格应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:12:40.907

如果你想在一行中显示它们，你可以使用`float`属性。

```
li { 
    float: left;
    margin-right: 10px;
} 
```

这会将它们显示在一行中，但不会显示为内联元素（它们仍将是块元素）。

# java - ExceptionInInitializerError - 使用 getResourceAsStream 读取 jar 包中的文件

> ID：14857701
> 
> 赞同：0
> 
> 时间：2013-02-13T16:03:59.413
> 
> 标签：java, jar, java-io

我正在尝试读取将在 jar 包中的文件 (blip3.out)。我正在使用 getResourceAsStream 获取 url，然后尝试从中读取。我已经多次尝试，使用其他帖子的解决方案，但我仍然收到**ExceptionInInitializerError**。有人可以解释我做错了什么或问题可能是什么。

此外，据我了解，如果我能让 get 资源流正常工作，那么它应该将 blip3.out 文件包含到 jar 包中。这个对吗？

**代码：**

```
public Set<String> readWindowTitleSet() {
    try {
        InputStream is = this.getClass().getResourceAsStream("blip3.out");
        ObjectInputStream ois = new ObjectInputStream(is);
        anotherList = (HashSet<String>) ois.readObject();
        ois.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return anotherList;

} 
```

**错误：**

```
Exception in thread "main" java.lang.ExceptionInInitializerError
at view.MainGui.<init>(MainGui.java:29)
at view.MainGui.main(MainGui.java:38)
Caused by: java.lang.NullPointerException
at java.io.ObjectInputStream$PeekInputStream.read(Unknown Source)
at java.io.ObjectInputStream$PeekInputStream.readFully(Unknown Source)
at java.io.ObjectInputStream$BlockDataInputStream.readShort(Unknown Source)
at java.io.ObjectInputStream.readStreamHeader(Unknown Source)
at java.io.ObjectInputStream.<init>(Unknown Source)
at model.WindowTitleDataStore.readWindowTitleSet(WindowTitleDataStore.java:47)
at model.WindowTitleDataStore.<init>(WindowTitleDataStore.java:18)
at controller.InterruptionDecision.<clinit>(InterruptionDecision.java:23)
... 2 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:13:16.643

错误的原因很简单：您实际上是`null`作为输入流传递的（查看`PeekInputStream#read`显示的来源，没有其他原因）。添加一个空检查并将文件移动到正确的位置，因为应用程序在运行时找不到它。

*（猜测不知道：将其放在源目录中的“view”文件夹中）*

# c - 具体的模乘算法

> ID：14857702
> 
> 赞同：4
> 
> 时间：2013-02-13T16:04:03.187
> 
> 标签：c, algorithm, math, modular-arithmetic

我有 3 个大的 64 位数字：A、B 和 C。我想计算：

```
(A x B) mod C 
```

考虑到我的寄存器是 64 位，即写入`a * b`实际上产生 (A x B) mod 2⁶⁴。

最好的方法是什么？我正在用 C 编码，但在这种情况下，我认为该语言不相关。

* * *

在对指向此解决方案的评论表示赞成后：

```
(a * b) % c == ((a % c) * (b % c)) % c 
```

让我具体一点：这不是一个解决方案，因为 ((a % c) * (b % c)) 可能仍然大于 2⁶⁴，并且寄存器仍然会溢出并给我错误的答案。我会：

> (((A mod C) x (B mod C)) mod 2⁶⁴) mod C

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T16:44:01.580

正如我在评论中指出的那样，Karatsuba 的算法可能会有所帮助。但是仍然存在一个问题，需要单独的解决方案。

认为

A = (A1 << 32) + A2

B = (B1 << 32) + B2。

当我们将这些相乘时，我们得到：

A * B = ((A1 * B1) << 64) + ((A1 * B2 + A2 * B1) << 32) + A2 * B2。

所以我们有 3 个要求和的数字，其中一个肯定大于 2^64，另一个可能更大。

但是可以解决！

我们可以将其拆分为更小的移位并在每次移位时进行模运算，而不是移位 64 位。结果将是相同的。

如果 C 本身大于 2^63，这仍然是一个问题，但我认为即使在这种情况下也可以解决。

# css - 鼠标悬停时下拉菜单的第三层消失

> ID：14857706
> 
> 赞同：0
> 
> 时间：2013-02-13T16:04:11.897
> 
> 标签：css, drop-down-menu, hover, mouseover

这是我正在处理的网站：[http](http://argumentinamerica.com) : //argumentinamerica.com 这是我正在处理的菜单的文件：http: [//jsfiddle.net/Qtfrq/](http://jsfiddle.net/Qtfrq/)

HTML：

```
<div id="menu">
<ul id="menu">
<li><a href="#"><span></span>Home</a></li>
<li class='has-sub'><a href="#"><span></span>Units</a>
    <ul>
        <li class='has-sub'><a href="#">Unit 1</a></li>
            <ul class="thirdtier">
                <li><a href="#">Read About It</a></li>
                <li><a href="#">Write About It</a></li>
                <li><a href="#">Hear About It</a></li>
                <li><a href="#">Speak About It</a></li>
                <li><a href="#">Read About It</a></li>
                <li><a href="#">Write About It</a></li>
            </ul>
        <li class='has-sub'><a href="#">Unit 2</a></li>
        <li class='has-sub'><a href="#">Unit 3</a></li>
        <li class='has-sub'><a href="#">Unit 4</a></li>
        <li class='has-sub'><a href="#">Unit 5</a></li>
    </ul>
<li><a href="#"><span></span>Teacher Center</a></li>
<li><a href="#"><span></span>About</a></li>
<li><a href="#"><span></span>Give 1</a></li>
</ul>
</div> 
```

CSS：

```
#menu {
    margin: 0; padding: 2px 0px 2px 0px;
    list-style-type: none;
    height: 2.4em;
}
#menu ul, #menu li, #menu span, #menu a {
    margin: 0;
    padding: 0;
    position: relative;
}
#menu li {
    float: left;
    width: 20%;
}
#menu a {
    display: block;
    margin: 1px;
    height: 2.4em;
    font-size: 10px;
    line-height: 2.4em;
    text-decoration: none;
    text-transform: uppercase;
    text-align: center;
    background: #ffcc66;
    color: #996600;
}
#menu span {
    position: absolute; top: 8px; left: 8px;
    width: 8px; height: 8px;
    background: #ff9933;
}
#menu a:hover {
    background: #cc3300;
    color: #ffcc66;
}
#menu ul{
    list-style-type: none;
}
#menu .has-sub {
    z-index: 1;
}
#menu .has-sub:hover > ul {
    display: list-item;
}
#menu .has-sub ul {
    display: none;
    position: absolute;
    left:0;
}
#menu .has-sub ul li {
    *margin-bottom: -1px;
    position: relative;
    width: 100%;
    height: 2.6em;
    line-height: 2.4em;
}
#menu .has-sub ul li a {
    background: #ff9944;
    font-size: .65em;
    color: ffcc66;
}
#menu .has-sub ul li a:hover,
 #menu .has-sub ul li:hover > a {
    background: #ff6633;
    color: 993300;
}
#menu .has-sub {
     z-index: 1;
}
#menu .has-sub:hover > ul {
    display: list-item;
}
#menu .has-sub .has-sub:hover + ul {
    display: list-item;
}
.thirdtier li {
    left: 100%;
} 
```

经过多次反复试验，当我将鼠标悬停在第二层上时，我想出了如何让第三层出现，但是当我尝试在第三层列表中选择某些东西时，它消失了。我知道我应该将悬停样式应用于 a 元素，以便当您将鼠标悬停在其子元素上时它保持“悬停”状态，我以为我这样做了，但它不起作用。我很想在这个问题上得到一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:14:11.057

一个常见的错误是没有将嵌套的 UL 放在其父 LI 中（顺便说一下，这会导致 HTML 无效）。因为这些 UL 不是具有悬停状态的 LI 的一部分，所以它们不保持可见性。

在这种情况下，您的第二级有效，因为您根本没有关闭 LI 标记。因此，浏览器通过查看下一个兄弟 LI 来猜测它应该关闭的位置。

你可能需要重新设计你的 CSS，但它应该是这样的：

```
<ul id="menu">
    <li><a href="#"><span></span>Home</a></li>
    <li class='has-sub'><a href="#"><span></span>Units</a>
        <ul>
            <li class='has-sub'><a href="#">Unit 1</a>
                <ul class="thirdtier">
                    <li><a href="#">Read About It</a></li>
                    <li><a href="#">Write About It</a></li>
                    <li><a href="#">Hear About It</a></li>
                    <li><a href="#">Speak About It</a></li>
                    <li><a href="#">Read About It</a></li>
                    <li><a href="#">Write About It</a></li>
                </ul>
            </li>
            <li class='has-sub'><a href="#">Unit 2</a></li>
            <li class='has-sub'><a href="#">Unit 3</a></li>
            <li class='has-sub'><a href="#">Unit 4</a></li>
            <li class='has-sub'><a href="#">Unit 5</a></li>
        </ul>
    </li>
    <li><a href="#"><span></span>Teacher Center</a></li>
    <li><a href="#"><span></span>About</a></li>
    <li><a href="#"><span></span>Give 1</a></li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:38:02.990

试试这个：http: [//jsfiddle.net/Qtfrq/2/](http://jsfiddle.net/Qtfrq/2/)

基本上对您的 HTML 和 CSS 进行了一些小改动。

```
<div id="menu">
<ul id="menu">
    <li><a href="#"><span></span>Home</a></li>
    <li class='has-sub'><a href="#"><span></span>Units</a>
        <ul>
            <li class='has-sub'><a href="#">Unit 1</a>
                <ul class="thirdtier">
                    <li><a href="#">Read About It</a></li>
                    <li><a href="#">Write About It</a></li>
                    <li><a href="#">Hear About It</a></li>
                    <li><a href="#">Speak About It</a></li>
                    <li><a href="#">Read About It</a></li>
                    <li><a href="#">Write About It</a></li>
                </ul>
            </li>
            <li class='has-sub'><a href="#">Unit 2</a></li>
            <li class='has-sub'><a href="#">Unit 3</a></li>
            <li class='has-sub'><a href="#">Unit 4</a></li>
            <li class='has-sub'><a href="#">Unit 5</a></li>
        </ul>
    </li>
    <li><a href="#"><span></span>Teacher Center</a></li>
    <li><a href="#"><span></span>About</a></li>
    <li><a href="#"><span></span>Give 1</a></li>
</ul>
</div>

#menu {
margin: 0; padding: 2px 0px 2px 0px;
list-style-type: none;
height: 2.4em;
}
#menu ul, #menu li, #menu span, #menu a {
    margin: 0;
    padding: 0;
    position: relative;
}
#menu li {
float: left;
width: 20%;
}
#menu a {
display: block;
margin: 1px;
height: 2.4em;
font-size: 10px;
line-height: 2.4em;
text-decoration: none;
text-transform: uppercase;
text-align: center;
background: #ffcc66;
color: #996600;
}
#menu span {
position: absolute; top: 8px; left: 8px;
width: 8px; height: 8px;
background: #ff9933;
}
#menu a:hover {
background: #cc3300;
color: #ffcc66;
}

#menu ul{
list-style-type: none;
}
#menu .has-sub {
    z-index: 1;
}
#menu .has-sub:hover > ul {
    display: list-item;
}
#menu .has-sub ul {
    display: none;
    position: absolute;
    left:0;
}
#menu .has-sub ul li {
    *margin-bottom: -1px;
    position: relative;
    width: 100%;
    height: 2.6em;
    line-height: 2.4em;
}

#menu .has-sub ul li a {
    background: #ff9944;
    font-size: .65em;
    color: ffcc66;
}

#menu .has-sub ul li a:hover,
#menu .has-sub ul li:hover > a {
    background: #ff6633;
    color: 993300;
}
#menu .has-sub {
    z-index: 1;
}
#menu .has-sub:hover > ul {
    display: list-item;
}

#menu .has-sub > .has-sub:hover + ul {
    display: list-item;
}

.thirdtier {
    top: 0;

}

.thirdtier li {
  left: 100%;
} 
```

# php - 按子标题对 PHP 进行排序

> ID：14857708
> 
> 赞同：0
> 
> 时间：2013-02-13T16:04:13.020
> 
> 标签：php, sql, sorting, loops, foreach

我正在尝试按该表中的子标题对我的 SQL 表进行排序。我试图得到的输出是这样的：

```
ItemHeader1
-item1
-item2
-item3
ItemHeader2
-item4
-item5
ect. 
```

但我得到的是：

```
ItemHeader1
-item1
-item1
-item1
ect. 
```

这是我的 PHP 代码：

```
$index_content_enquirers = mysql_query("SELECT * FROM index_content_enquirers WHERE lang_attribute = '$lang_identify' ORDER BY item_sectionname_english ASC, item_english_title ASC") or die(mysql_error());
$get_index_content_enquirers = mysql_fetch_assoc($index_content_enquirers);
$contentinfo = array();

foreach($get_index_content_enquirers as $row) {
    $contentinfo[$get_index_content_enquirers['item_sectionname_english']][] = $get_index_content_enquirers['item_english_title'];
}

foreach($contentinfo as $contenttitle => $item_titles) {
    echo $contenttitle;
    foreach($item_titles as $item_title) {
        echo "<br />". $item_title;
    }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:09:15.950

首先 - 不要使用 mysql 函数，因为它们已被弃用。使用 mysqli 或 PDO。

在这个循环中：

```
foreach($get_index_content_enquirers as $row) {
    $contentinfo[$get_index_content_enquirers['item_sectionname_english']][] = 
         $get_index_content_enquirers['item_english_title'];
} 
```

您应该使用`$row`而不是`$get_index_content_enquirers`. 这会成功的:)

```
foreach($get_index_content_enquirers as $row) {
    $contentinfo[$row['item_sectionname_english']][] = 
         $row['item_english_title'];
} 
```

# asp.net - 从 ASP.NET 中的文本框中发布自定义 JSON

> ID：14857710
> 
> 赞同：1
> 
> 时间：2013-02-13T16:04:18.177
> 
> 标签：asp.net, json

我在 ASP.NET 中有一个简单的 Web 表单。将自定义 JSON 输入到表单中，然后发布到服务器。相反，当页面加载时，与父数据对象（json 附加到）相关联的任何内容都存在于文本框中。

虽然初始 JSON 集显示正常，但将表单发回会导致验证错误并且请求失败。我现在的要求是能够输入自定义 json 数据。数据可能很复杂（对象树）。在表单上保留安全性和验证但允许自定义 json 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T17:40:17.813

您可以尝试在客户端使用 JavaSCribe 对数据进行编码，然后再将其发布到服务器，然后在服务器上对其进行解码。可能只有几个字符导致了这种情况。

其他选项是禁用 asp.net 内置验证并以某种方式自己验证数据。

在这两种情况下，我认为您应该进行某种额外的验证，以确保您不会捕获 SQL 注入。

# python - 更新预先存在的列表以避免 O(n^2)

> ID：14857711
> 
> 赞同：1
> 
> 时间：2013-02-13T16:04:28.677
> 
> 标签：python, performance, list

我想创建一个新函数，`neighbor_trial(atomlist,trialatom)`它将运行`O(n)`而不是`neighbor(atomlist)`（`O(n^2)`时间）。我可以通过仅更新上一次运行的结果来实现这一点`neighbor(atomlist)`。`trialatom`是一个被移动的原子，所有其他原子`atomlist`都没有被移动。

背景：

`atomlist`是 Atom 类的实例列表。Atom 对象具有`atom1.is_neighbor(atom2)`检查是否`atom2`是 的最近邻居的函数`atom1`。如果是，`atom2`则添加到`atom1.nrst`列表中。一个原子最多只能有 12 个唯一的最近邻居，并且不能包含它自己。

问题：

`neighbor`正确更新每个人`atom`的`nrst`列表，但速度很慢（必须重新运行多次）。但是，`neighbor_trial`不能正确更新。必须检查每个`atom`' 的`nrst`邻居以查看`trialatom`现在是否是邻居，并重新创建列表被擦除`nrst`的`atom`' 的列表。`nrst`

```
def neighbor(atomlist): 
    cdef int i, j
    for atom in atomlist:  
        atom.nrst=[]   #Unnecessarily deletes every atom's nrst! 
    for i in range(len(atomlist)):
        for j in range(i+1,len(atomlist)):
            if atomlist[i].is_neighbour(atomlist[j]):
                atomlist[i].nrst.append(atomlist[j])
                atomlist[j].nrst.append(atomlist[i])

def neighbor_trial(atomlist,trialatom):
    cdef int i, j
    redoo_list=[]
    for atom in trialatom.nrst:
        atom.nrst=[]            #Only trialatom and its neighbours' nrst list are wiped!
        redoo_list.append(atom)
    trialatom.nrst = []
    redoo_list.append(trialatom)
    for i in range(len(atomlist)):
        for j in range(len(redoo_list)):
            if atomlist[i] != redoo_list[j]:
                if atomlist[i].is_neighbour(redoo_list[j]):
                    redoo_list[j].nrst.append(atomlist[i]) 
```

# c++ - vs2010 c++ 通过调试查看指针内容

> ID：14857713
> 
> 赞同：5
> 
> 时间：2013-02-13T16:04:33.347
> 
> 标签：c++, visual-studio-2010

我正在使用二维数组在 Vs2010 c++ 中工作。我从一维指针开始并使用操作 [] 如下：

```
class CMatrix
{
    void clear();
public:
    int nRows;
    int nCols;
    short * MyMat;

    CMatrix();
    CMatrix(int r,int c);
    ~CMatrix(void);

    void SetMatrix(int r,int c);
    short * operator[] (const int row)
    {
        return MyMat + (row*nCols);
    }
}; 
```

我不介意更改为 2D 指针。

但是我的问题是调试。因为我使用的是指针，所以我看不到数组内容。

还有其他选择吗？

我不喜欢使用矢量。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-13T16:17:53.257

一种方法是使用`Memory`查看器。调试时（在断点处停止时），转到菜单**Debug** > **Windows** > **Memory** > **Memory 1**以获取内存查看器。然后键入内存地址（复制粘贴指针中的值），以便您可以查看程序内存区域周围的内存。

当您右键单击内存查看器时，您可以选择查看数据的方式（如 ANSI、4 个整数、2 字节整数、浮点数、bla bla ...）

您也可以在调试时使用该`Watch`窗口。只需将您的指针用作数组（例如，如果您的指针是`char * t`，语法`t[0]`将给出指针指向的数据`t`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-13T16:24:59.743

在 QuickWatch 窗口中，您可以键入指针变量的名称，后跟逗号以及要查看的数组索引的数量，例如`MyMat, 10`。

# github - Github：在当前仓库中搜索代码

> ID：14857717
> 
> 赞同：5
> 
> 时间：2013-02-13T16:04:40.690
> 
> 标签：github

我知道可以通过在搜索框中输入代码来搜索 repo 中的代码：

```
my-keyword repo:user_name/repository_name 
```

但是由于我每天都在使用很多项目，并且喜欢深入源代码以了解这个或那个是如何工作的，所以`repo: user_name/repository_name`每次我想搜索某些东西时都必须输入 part 很快就会变得很烦人。

有没有办法在**当前**查看的 repo 源代码中快速搜索代码？

如果我目前在`frankenstein/monster`repo 中，我希望能够搜索该`create_life`方法而无需`repo: frankenstein/monster`在搜索框中输入，因为我已经在这个 repo 中。

（就好像您在文本编辑器中处理文件一样，按 Ctrl+F 并需要输入当前文件的文件名）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T16:25:37.917

2013 年 5 月更新：请参阅“**[所有存储库上的存储库搜索](https://github.com/blog/1492-repository-search-on-all-repositories)**”

> 今天，我们允许您搜索自己的公共存储库和您有权访问的任何私有存储库。
> 
> 当您在存储库页面上时，**您会看到默认情况下正在搜索该存储库的指示**：

![在此处输入图像描述](../Images/f3278bf9f14c48d246c1f4f281e2b455.png)

* * *

原始答案（2013 年 2 月）

我没有找到任何“ ”或其他约定可以为“代码”搜索`repo:current`指定*默认存储库。*

我通常在单独的窗口中进行搜索，选择“代码”并且“ `repo:username/reponame`”已经填写。
我只添加我需要的关键字并单击输入。

我多次重复该过程，只更改关键字，但如果感兴趣的结果，我会在另一个选项卡中打开它，以保留搜索页面及其字段。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T16:40:41.147

似乎在私有存储库中出现了第二个标有“搜索源代码...”的搜索栏。在这种情况下，只需点击`Tab`两次即可将您带到那里并让您在里面搜索。

这似乎没有出现在我抽样的公共存储库中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T21:30:28.277

好吧，我刚刚编写了一个非常简单的脚本，它自动将当前 repo 添加到搜索框（与 TemperMonkey 一起使用，并且应该与 GreaseMonkey 一起使用）：

```
// ==UserScript==
// @name       Github Current Repo Search
// @namespace  http://www.byscripts.info/
// @version    0.1
// @description  Add automatically the current repo in the search box
// @match      https://github.com/*
// @exclude    https://github.com/search*
// @copyright  2012+, ByScripts
// ==/UserScript==

var repo = window.location.pathname.substring(1).split('/').slice(0, 2).join('/');
if(repo.length) {
  document.getElementById('command-bar').value = "repo:" + repo;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-14T12:10:31.053

github 提供了一个[全新的搜索](https://github.com/search)。

对于高级需求，例如搜索特定的 repo 或用户等，请使用[高级搜索](https://github.com/search/advanced)。

[![在此处输入图像描述](../Images/2c21d97a8c8d7beb59f40143a59524f4.png)](https://i.stack.imgur.com/roida.png)

[![在此处输入图像描述](../Images/4a51ee20f67cffd3bacc30e93fe786b0.png)](https://i.stack.imgur.com/PX9TL.png)

# python - Django - 使用自定义用户模型创建用户会导致内部错误

> ID：14857719
> 
> 赞同：1
> 
> 时间：2013-02-13T16:04:45.887
> 
> 标签：python, django, django-models, django-users, django-managers

好的，我知道这是一个愚蠢的问题，但我被阻止了，我不知道该怎么做。

我在 google 和 stackoverflow 上搜索过，但没有找到任何答案：我试过这个：

*   [在 django 中向用户添加自定义字段](https://stackoverflow.com/questions/2886987/adding-custom-fields-to-users-in-django)
*   [Django - 在用户创建时创建用户配置文件](https://stackoverflow.com/questions/11488974/django-create-user-profile-on-user-creation)
*   [https://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users](https://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)

我的模型如下：

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)

    quota = models.IntegerField(null = True)

def create_user_profile(sender, instance, created, **kwargs):
    if created:
        UserProfile.objects.create(user=instance)

post_save.connect(create_user_profile, sender=User) 
```

我对用户注册的看法如下：

```
def register(request):
    if request.method == 'POST': # If the form has been submitted...
        form = RegistrationForm(request.POST) # A form bound to the POST data
        if form.is_valid(): # All validation rules pass
            # Process the data in form.cleaned_data
            cd = form.cleaned_data

            #Then we create the user
            user = User.objects.create_user(cd['username'],cd["email"],cd["password1"])

            user.get_profil().quota = 20

            user.save()

            return HttpResponseRedirect('')

    else:
        form = RegistrationForm() # An unbound form

    return render(request, 'registration_form.html', {'form': form,}) 
```

启动 InternalError 的行是：

```
user = User.objects.create_user(cd['username'],cd["email"],cd["password1"]) 
```

错误是：

```
InternalError at /register/

current transaction is aborted, commands ignored until end of transaction block 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:23:14.187

```
user = User.objects.create_user(username=form.cleaned_data['username'],
                                password=form.cleaned_data['password'], 
                                email=form.cleaned_data['email'])
user.is_active = True
user.save() 
```

# jquery - jquery password123 掩码插件 elem 未定义

> ID：14857720
> 
> 赞同：1
> 
> 时间：2013-02-13T16:04:45.460
> 
> 标签：jquery, jquery-plugins

我从 password123 插件中收到此错误，但不确定可能是什么原因，因为它在以前的项目中运行良好。也许是更新版本的 jquery。

当页面中有输入密码字段时它工作正常，虽然显示以下错误然后没有。我怎样才能解决这个问题？

> 错误：TypeError：elem 未定义源文件： [http](http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.js) ://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.js 行：1719 `var noData = elem.nodeName && jQuery.noData[ elem.nodeName.toLowerCase()`

堵塞：

```
// A method for determining if a DOM node can handle the data expando
    acceptData: function( elem ) {
        var noData = elem.nodeName && jQuery.noData[ elem.nodeName.toLowerCase() ];

        // nodes accept data unless otherwise specified; rejection can be conditional
        return !noData || noData !== true && elem.getAttribute("classid") === noData;
    } 
```

文档准备好：

```
$('input:password').password123({
    character: "&#9679;"
}); 
```

完整插件：

```
/**
*   @preserve jQuery password123: iPhone Style Passwords Plugin - v1.5 - 2/1/2011
*   http://timmywillison.com/samples/password123/
*   Copyright (c) 2011 timmy willison
*   Dual licensed under the MIT and GPL licences.
*   http://timmywillison.com/licence/
*/

// *Version: 1.5, Last updated: 2/1/2011*
//
// Demo         - http://timmywillison.com/samples/password123/
// Testing      - http://timmywillison.com/samples/password123/qunit/test/
// GitHub       - http://github.com/timmywil/password123
// Source       - http://github.com/timmywil/password123/raw/master/jquery.password123.js (13.8kb)
// (Minified)   - http://github.com/timmywil/password123/raw/master/jquery.password123.min.js (5.2kb)
//
// License
//
// Copyright (c) 2011 timmy willison,
// Dual licensed under the MIT and GPL licenses.
// http://timmywillison.com/licence/
//
// Support and Testing
//
// Versions of jQuery and browsers this was tested on.
//
// jQuery Versions - 1.3.2-1.5
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.7, Safari 3-5,
//                   Chrome 4-6, Opera 9.6-10.5.
//
// Release History
//
// 1.5   - (2/1/2011) Added widget-style option method, only instantiate when not calling a method
// 1.4   - (2/1/2011) Restructured plugin, added destroy method, added tests
// 1.3   - (11/23/2010) Added Google Closure Compiler comments, common password field attribute
//              support when replacing fields, and no longer sends placeholder value when submitting the form.
// 1.2   - (9/28/2010) Placeholders changed to only work with HTML5 placeholder attribute,
//              'value' attribute now reserved for actual values
// 1.1   - (7/5/2010) Add Placeholder functionality
// 1.0   - (7/4/2010) Initial release
//
// See README for usage and placeholder explanation

;(function ($, window, document, undefined) {

    // Extend jQuery
    $.fn.password123 = function ( options ) {
        var instance = $.data( this[0], "password123" ),
            args = Array.prototype.slice.call( arguments, 1 );

        // Catch method calls
        if ( !!instance && typeof options === "string" && options.charAt( 0 ) !== "_" && instance[ options ] ) {
            args.unshift( this );
            return instance[ options ].apply( instance, args );
        }

        return this.map(function( i, elem ) {
            // Returns the new password fields for chaining
            // Old password fields are removed
            return new password123._init( elem, options );
        });
    };

    var clear_timeout = window.clearTimeout,
        counter = 0,
    password123 = {

        _init: function( elem, options ) {

            // Catch fields that aren't password fields
            if ( !elem.type === "password" ) {
                return elem;
            }

            var self = this;

            // Continue regularly
            self.options = $.extend({

                // You can use any html character code or
                // plain text character
                character: "&#8226;",

                // This is the delay(ms) for when the last
                // character will change
                delay: 2000,

                // Use any prefix you like for the new
                // field ids, but they will always be zero-indexed
                prefix: "iField",

                // Enable the override of the placeholder attribute
                placeholder: true,

                // With this classname, you can set placeholder
                // specific styles in your own css
                placeholderClass: 'input_placeholder',

                // When true, this will mask the placeholder or initial value
                maskInitial: false
            }, options);

            // HTML encode the character
            self.encodedChar = $('<div>'+ self.options.character +'</div>').text();

            // Replace the fields with what we need
            // and store in var fields
            self.$field = self._replaceField( elem )

                // Bind textchange to the fields with
                // the letterChange function
                .bind('textchange', function() {
                    self._letterChange.call( self );
                });

            // Add placeholder stuff
            if ( self.options.placeholder ) {
                self._bindPlaceholder();
            }

            // Mask the placeholder or initial value if needed
            if ( self.options.maskInitial ) {
                self.$field.keyup();
            }

            // Return the new password field
            return self.$field[0];
        },

        /**
         * Replaces the password field with a hidden field
         * and adds the new visible text field.
         * @param {object} $field One field to replace
         * @return {object} The new text field.
         * @private
         */
        _replaceField: function( field ) {
            var self     = this,
                $field   = $(field),
                place    = $field.attr('placeholder') || undefined,
                field_id = self.options.prefix + counter++,
                value    = $field.val() || ( self.options.placeholder ? place || '' : '' ),
                classes  = self.options.placeholder && place !== undefined && (value === place || value === '') ?
                                field.className + ' ' + self.options.placeholderClass :
                                field.className,
                attrs = { 'class': classes, 'id': field_id, 'value': value, 'placeholder': self.options.placeholder ? undefined : place },
                standards = [ 'size', 'tabindex', 'readonly', 'disabled', 'maxlength' ];

            // Combine attrs with standard attrs
            for ( var i = 0; i < standards.length; i++ ) {
                var attr = $field.attr( standards[i] );
                attrs[ standards[i] ] = attr && attr > -1 ? attr : undefined;
            }

            // The hidden field that will get sent with the form
            self.$hidden = $('<input type="hidden"/>')
                .attr({
                    'name': $field.attr('name'),
                    'id': field.id,
                    'class': field.className,
                    'disabled': $field.attr('disabled')
                })
                .replaceAll( $field )
                .val( value !== place ? value : '' );

            self.$oldField = $field;

            // The main field
            return $('<input type="text"/>')
                .attr( attrs )
                .insertAfter( self.$hidden )
                .data({
                    'value': $field.val() || '', // If value was set, fill it in correctly
                    'placeholder': place, // Attach placeholder for comparison to value
                    'newVal': value, // This to avoid sending the placeholder value when submitting the form
                    'password123': self // Attach the instance of this plugin
                });
        },

        /**
         * Calls for the necessary adjustments when
         * a field is changed
         * @private
         */
        _letterChange: function( elem ) {
            var fv = this.$field.val();

            if ( fv.length > this.$field.data('value').length ) {

                // Apply fieldChange as normal
                this.$field.data( 'value', this._fieldChange() );

            } else if ( fv.length < this.$field.data('value').length ) {

                // Clear the timeout for the last character
                clear_timeout( this.last );

                var old = this.$hidden.val(),
                    newVal;

                if ( fv.length < old.length - 1 ) {
                    newVal = old.substr( 0, fv.length );
                } else {
                    var cp = this._getCursorPosition();

                    // Create the new value with the correct
                    // character deleted
                    newVal = old.length > cp + 1 && cp > -1
                        ? old.slice(0, cp).concat(old.slice(cp + 1))
                        : old.slice(0, cp);
                }

                // Update data and the hidden input
                this.$field.data({ 'value': fv, 'newVal': newVal });
                if ( newVal !== this.$field.data('placeholder') ) {
                    this.$hidden.val( newVal );
                }
            }

            return this;
        },

        /**
         * Updates the field with the dots as the user types,
         * and sets the timeout for the last char.
         * @return {string} The new value to set to field.data
         * @private
         */
        _fieldChange: function() {
            var self = this;

            // Clear the timeout for the last character
            clear_timeout( self.last );
            var fv = self.$field.val(), len = fv.length,
                old = self.$hidden.val(),
                cp = self._getCursorPosition(),
                newVal;

            // Update the hidden value with the correct value
            // depending on cursor position
            newVal = old.length > cp + 1 && cp > -1
                ? old.substr(0, cp-1) + fv.charAt(cp-1) + old.substr(cp-1)
                : old + fv.charAt(len - 1);
            self.$field.data('newVal', newVal);
            if ( newVal !== self.$field.data('placeholder') ) {
                self.$hidden.val( newVal );
            }

            if ( len > 1 ) {

                // Loop through and change all characters
                for ( var i = 0; i < len - 1; i++ ) {
                    fv = fv.replace( fv.charAt(i), self.encodedChar );
                }

                // Update the field
                self.$field.val( fv );
            }
            if ( len > 0 ) {

                // Set the timeout for the last character
                self.last = setTimeout(function () {
                    cp = self._getCursorPosition();
                    fv = self.$field.val();
                    fv = fv.replace( fv.charAt(len - 1), self.encodedChar );
                    self.$field.val( fv ).data('value', fv);

                    // Reset cursor position to what it was if not at end
                    if ( cp != len ) {
                        self._setCursorPosition( cp );
                    }
                }, self.options.delay);
            }

            // Reset cursor position to what it was if not at end
            if ( cp != len ) {
                self._setCursorPosition( cp );
            }
            return fv;
        },

        /**
         * Placeholder functionality
         * @private
         */
        _bindPlaceholder: function() {
            var self = this,
                place = self.$field.data('placeholder');

            if ( place !== undefined ) {
                self.$field.bind({
                    "focus.password123": function() {
                        // Compare the hidden value with the placeholder value
                        if ( self.$field.data('newVal') === place ) {
                            self.$field.val('').removeClass( self.options.placeholderClass ).data( 'newVal', '' );
                            self.$hidden.val('');
                        }
                    },
                    "blur.password123": function() {
                        // If it's empty, put the placeholder in as the value
                        if ( place !== undefined && self.$field.val() === '' ) {
                            self.$field.val( place ).addClass( self.options.placeholderClass ).data( 'newVal', place );

                            // Mask the placeholder if needed
                            if ( self.options.maskInitial ) {
                                self.$field.keyup();
                            }
                        }
                    }
                });
            } else {
                self.$field.keyup();
            }
            return self;
        },

        /**
         * Remove placeholder functionality
         * @private
         */
        _changePlaceholder: function( isPlace ) {
            if ( isPlace && !this.options.placeholder ) {
                return this._bindPlaceholder();
            } else if ( !isPlace && this.options.placeholder ) {
                this.$field.focus().unbind('.password123').blur();
            }
            return this;
        },

        /**
         * Change the id prefix on this field
         * @private
         */
        _changePrefix: function( value ) {
            var cur = this.$field.attr("id"),
                prev = this.options.prefix;
            this.$field.attr( 'id', cur.replace( prev, value ) );
            return this;
        },

        /**
         * Gets the current cursor position in a textfield
         * to determine where to delete/update a character.
         * @return {Number} The index for the position of the cursor.
         * @private
         */
        _getCursorPosition: function() {
            var elem = this.$field[0];
            if ( elem != null ) {
                // IE
                if ( document.selection ) {
                    elem.focus();
                    var sel = document.selection.createRange();
                    sel.moveStart( 'character', -elem.value.length );
                    return sel.text.length;
                }
                // Others
                else if ( elem.selectionStart !== undefined ) {
                    return elem.selectionStart;
                }
            }
            return -1;
        },

        /**
         * Sets the cursor position to a previous state
         * if the field was updated somewhere in the middle.
         * @param {Element} field The raw field.
         * @param {Number} pos The position to set to.
         * @private
         */
        _setCursorPosition: function( pos ) {
            var elem = this.$field[0];
            if ( elem != null ) {
                // IE
                if ( elem.createTextRange ) {
                    var range = elem.createTextRange();
                    range.move('character', pos);
                    range.select();
                }
                // Others
                else if ( elem.setSelectionRange ) {
                    elem.focus();
                    elem.setSelectionRange( pos, pos );
                }
                else {
                    elem.focus();
                }
            }
        },

        /**
         * Internally sets options
         * @return password123 instance
         * @private
         */
        _setOptions: function( options ) {
            var self = this;
            $.each( options, function( key, value ) {
                switch ( key ) {
                    case "placeholder":
                        self._changePlaceholder( value === "false" ? false : value );
                        break;
                    case "prefix":
                        self._changePrefix( value );
                }
                self.options[ key ] = value;
            });
            return this;
        },

        /**
         * Destroys everything password123 has done and
         * sets the original password field back in place
         * @return The original password field
         */
        destroy: function( elem ) {
            var val = this.$hidden.remove().val();
            return this.$oldField.val( val ).replaceAll( elem );
        },

        /**
         * Get/set option on an existing password123 instance
         * @return The password123 field
         */
        option: function( elems, key, value ) {
            if ( !key ) {
                return $.extend( {}, this.options ); // Avoids returning direct reference
            }
            var options = key;

            if ( typeof key === "string" ) {
                if ( value === undefined ) {
                    return this.options[ key ];
                }
                options = {};
                options[ key ] = value;
            }

            this._setOptions( options );

            return elems;
        }
    };
    password123._init.prototype = password123;

    // Textchange event with a little extra
    $.event.special.textchange = {
        setup: function( data, namespaces ) {
            $(this).bind('keyup.textchange', $.event.special.textchange.handler);
            $(this).bind('cut.textchange paste.textchange input.textchange', $.event.special.textchange.delayedHandler);
        },
        teardown: function( namespaces ) {
            $(this).unbind('.textchange');
        },
        handler: function( event ) {
            $.event.special.textchange.triggerIfChanged( $(this) );
        },
        delayedHandler: function( event ) {
            var $element = $(this);

            setTimeout(function() {
                $.event.special.textchange.triggerIfChanged( $element );
            }, 25);
        },
        triggerIfChanged: function( $element ) {
            var v = $element.val();

            if ( $element.val() !== $element.data('lastValue') ) {

                // Check if something larger than one letter was pasted into the field
                var p123 = $.data( $element[0], "password123" );
                if ( v.length > 1 && v.indexOf( p123.encodedChar ) === -1 ) {

                    // If so, we need to save it before it disappears,
                    // but continue with triggering the field change
                    // by taking the last letter off
                    v = v.substr(0, v.length-1);
                    $element.data('value', v);
                    p123.$hidden.val( v );
                }
                $element.trigger( 'textchange', $element.data('lastValue') );
                $element.data('lastValue', $element.val());
            }
        }
    };

})(jQuery, this, this.document); 
```

jsfiddle：http: [//jsfiddle.net/pzeYZ/](http://jsfiddle.net/pzeYZ/)

# php - 加载页面后如何重新填充变量

> ID：14857722
> 
> 赞同：1
> 
> 时间：2013-02-13T16:04:51.127
> 
> 标签：php, javascript, ajax, cakephp, cakephp-1.3

这个函数，ajax ......每件事都运行良好。
当我想重新加载 $users 时，它返回相同的 $users
在加载 ajax 后有什么方法可以用新数据重新加载 $users 吗？

控制器

```
function list_of_users_by_skills($project_ids){

         $project_id = json_decode($project_ids);
            /* Generate Users by Skills 
            * By Isaac
            */ 
           $this->loadModel('Training');                              

           //Get list of users by skills
           $users_return = $this->Training->find('all', array('conditions' => array('Training.Project_id' => $project_id)));

            //some code here to return the $users :)

           asort($users); 
           $this->set('users', $users);                            
    } 
```

看法

```
var page = 'http://localhost/index.php/shifts/list_of_users_by_skills/[176,196]/'; 
               console.log(page);

                $.ajax({                          
                      url: page,                          
                      success: function(data) {
                          <?php  echo "var user_array = [" . json_encode($users) . "];\n"; ?>
                            console.log(user_array);    
                           console.log(<?php echo json_encode($users); ?>);
                      }                      
                }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:11:44.183

您已经在 javascript 中硬编码了 users 变量：

```
<?php  echo "var user_array = [" . json_encode($users) . "];\n"; ?> 
```

这只会在初始页面请求中填写一次。

您需要确保使用 ajax 调用的脚本返回实际的用户列表并使用它：

就像是：

```
$.ajax({                          
       url: page,
       dataType: "json",                    
       success: function(data) {
            var user_array = data;
            console.log(user_array);
       }                      
}); 
```

你的`page`脚本最后应该做这样的事情：

```
 echo json_encode($users); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:08:36.333

您在成功回调上推送相同的 user_array ...

您应该在函数之前声明 var 并覆盖函数中的 var{

```
var page = 'http://localhost/index.php/shifts/list_of_users_by_skills/[176,196]/';
var users =  [<?php echo json_encode($users);  // or make in an array so json_encode is sufficient ?>];
$.ajax({                          
    url: page,                          
    success: function(data) {
        users = data.users;
    }                      
}); 
```

你是网关的地方（事物的 PHP 方面）将返回一个数组（或对象），其键为 'users' => array(user1, user2 etc etc);

# c# - XML序列化和反序列化嵌套元素c#

> ID：14857724
> 
> 赞同：1
> 
> 时间：2013-02-13T16:04:51.710
> 
> 标签：c#, xml

请考虑以下xml。我想反序列化。但是，它不会反序列化规则元素。一些快速提示表示赞赏。

```
<ImportDefinition>
    <Import>
    <Customer>
        <Name>Customer1</Name>
        <Path>\\192.168.1.1\40014\</Path>
        <Rules>
           <Rule Type="OrgNr-VATNr">INDEX_6|BDPOS_7</Rule>  
           <Rule Type="DueDate">INDEX_11|BDPOS_7|25</Rule>
        </Rules>
    </Customer>
  </Import>
</ImportDefinition> 
```

* * *

```
 [XmlRoot("ImportDefinition")]
    public class ImportDefinition
    {
        public ImportDefinition() { }

        [XmlArray("Import"), XmlArrayItem("Customer", typeof(Customer))]
        public List<Customer> Customers
        {
            get { return (_customers); }
            set { _customers = value; }
        }
    }

[XmlType(TypeName = "Customer"), Serializable]
    public class Customer
    {
        public Customer() { }

        [XmlElement("Name")]
        public string Name { get; set; }

        [XmlElement("Path")]
        public string Path { get; set; }

        private List<Rule> _rules = new List<Rule>();
        [XmlArray("Rules")]
        public List<Rule> Rules
        {
            get { return (_rules); }
            set { _rules = value; }
   }
}

[XmlType(TypeName = "Rule"), Serializable]
public class Rule
{
    public Rule() { }

    [XmlAttribute("Type")]
    public string Type { get; set; }

    [XmlElement("Rule")]
    public string Rule { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:08:04.403

在我的项目中，我有类似的情况，与您的代码的唯一区别是我设置了 XmlArrayItem 属性：

```
 [XmlArrayItem("Rules")]
    public List<Rule> Rules
    {
        get { return (_rules); }
        set { _rules = value; }
    } 
```

# objective-c - 如何旋转 UIImage

> ID：14857728
> 
> 赞同：18
> 
> 时间：2013-02-13T16:04:56.623
> 
> 标签：objective-c, ipad, ios6, uiimageview, uiimage

我正在为 iPad 开发 iOS 应用程序。有没有办法将 UIImage 旋转 90º，然后将其添加到 UIImageView？我已经尝试了很多不同的代码，但没有一个有效......

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-13T16:10:32.170

您可以通过以下方式自行旋转`UIImageView`：

```
UIImageView *iv = [[UIImageView alloc] initWithImage:image];
iv.transform = CGAffineTransformMakeRotation(M_PI_2); 
```

或者，如果您真的想更改图像，则可以使用[此答案](https://stackoverflow.com/questions/1315251/how-to-rotate-a-uiimage-90-degrees)中的代码，它可以工作。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-11-15T15:11:52.023

要旋转像素，您可以使用以下内容。这将创建一个带有旋转元数据的中间 UIImage，并将其渲染到一个宽度/高度尺寸转置的图像上下文中。生成的图像具有旋转的像素（即底层 CGImage）

```
- (UIImage*)rotateUIImage:(UIImage*)sourceImage clockwise:(BOOL)clockwise
{
    CGSize size = sourceImage.size;
    UIGraphicsBeginImageContext(CGSizeMake(size.height, size.width));
    [[UIImage imageWithCGImage:[sourceImage CGImage] scale:1.0 orientation:clockwise ? UIImageOrientationRight : UIImageOrientationLeft] drawInRect:CGRectMake(0,0,size.height ,size.width)];
    UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
} 
```

还有其他可能的值可以传递给方向参数以实现 180 度旋转和翻转等。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-23T14:55:00.820

这会将图像旋转任何给定的度数。

请注意，这也适用于 2x 和 3x 视网膜

```
- (UIImage *)imageRotatedByDegrees:(CGFloat)degrees {
    CGFloat radians = DegreesToRadians(degrees);

    UIView *rotatedViewBox = [[UIView alloc] initWithFrame:CGRectMake(0,0, self.size.width, self.size.height)];
    CGAffineTransform t = CGAffineTransformMakeRotation(radians);
    rotatedViewBox.transform = t;
    CGSize rotatedSize = rotatedViewBox.frame.size;

    UIGraphicsBeginImageContextWithOptions(rotatedSize, NO, [[UIScreen mainScreen] scale]);
    CGContextRef bitmap = UIGraphicsGetCurrentContext();

    CGContextTranslateCTM(bitmap, rotatedSize.width / 2, rotatedSize.height / 2);

    CGContextRotateCTM(bitmap, radians);

    CGContextScaleCTM(bitmap, 1.0, -1.0);
    CGContextDrawImage(bitmap, CGRectMake(-self.size.width / 2, -self.size.height / 2 , self.size.width, self.size.height), self.CGImage );

    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-13T18:01:06.263

还有`imageWithCIImage:scale:orientation`如果你想旋转`UIImage`不是`UIImageView`

具有以下方向之一：

```
typedef enum {
   UIImageOrientationUp,
   UIImageOrientationDown,   // 180 deg rotation
   UIImageOrientationLeft,   // 90 deg CW
   UIImageOrientationRight,   // 90 deg CCW
   UIImageOrientationUpMirrored,    // vertical flip
   UIImageOrientationDownMirrored,  // horizontal flip
   UIImageOrientationLeftMirrored,  // 90 deg CW then perform horizontal flip
   UIImageOrientationRightMirrored, // 90 deg CCW then perform vertical flip
} UIImageOrientation; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-07-23T17:33:28.173

这是@RyanG 的Objective C 代码的快速版本，作为UIImage 的扩展：

```
extension UIImage {

    func rotate(byDegrees degree: Double) -> UIImage {
        let radians = CGFloat(degree*M_PI)/180.0 as CGFloat
        let rotatedViewBox = UIView(frame: CGRect(x: 0, y: 0, width: self.size.width, height: self.size.height))
        let t = CGAffineTransform(rotationAngle: radians)
        rotatedViewBox.transform = t
        let rotatedSize = rotatedViewBox.frame.size
        let scale = UIScreen.main.scale
        UIGraphicsBeginImageContextWithOptions(rotatedSize, false, scale)
        let bitmap = UIGraphicsGetCurrentContext()
        CGContextTranslateCTM(bitmap, rotatedSize.width / 2, rotatedSize.height / 2);

        bitmap!.rotate(by: radians);

        bitmap!.scaleBy(x: 1.0, y: -1.0);
        CGContextDrawImage(bitmap, CGRectMake(-self.size.width / 2, -self.size.height / 2 , self.size.width, self.size.height), self.CGImage );

        let newImage = UIGraphicsGetImageFromCurrentImageContext()

        return newImage
    }

} 
```

用法是`image.rotate(degree)`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-11-12T00:54:13.210

使用 Swift，您可以通过以下方式旋转图像：

```
var image: UIImage = UIImage(named: "headerBack.png")
var imageRotated: UIImage = UIImage(CGImage: image.CGImage, scale:1, orientation: UIImageOrientation.UpMirrored) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-07-29T07:41:09.477

```
UIImage *img = [UIImage imageWithName@"aaa.png"];
UIImage *image = [UIImage imageWithCGImage:img.CGImage scale:1.0 orientation:UIImageOrientationRight]; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-13T16:14:34.630

另一种方法是使用 Core Graphics 再次渲染 UIImage。

获得上下文后，使用`CGContextRotateCTM`.

[有关此 Apple Doc 的](http://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGContext/Reference/reference.html)更多信息

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-11T19:10:22.867

谢谢杰森克罗克这解决了我的问题。仅进行一次较小的校正，两个位置的高度和宽度互换，并且不会发生变形，即

```
UIGraphicsBeginImageContext(CGSizeMake(size.width, size.height));
[[UIImage imageWithCGImage:[sourceImage CGImage] scale:1.0 orientation:clockwise ? UIImageOrientationRight : UIImageOrientationLeft]  drawInRect:CGRectMake(0,0,size.width,size.height)]; 
```

CGContextRotateCTM 无法解决我的问题，我不知道为什么。我的问题是我正在将我的图像传输到服务器并且它总是以 90 度显示。您可以通过将图像复制到您在 Mac 上运行的 MS Office 程序来轻松测试您的图像是否可以在非苹果世界中工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-25T12:54:34.367

当我想改变图像的方向（顺时针旋转 90 度）时，这就是我所做的。

```
//Checking for the orientation ie, image taken from camera is in portrait or not.
if(yourImage.imageOrientation==3)
{
    //Image is in portrait mode.
    yourImage=[self imageToRotate:yourImage RotatedByDegrees:90.0];
}

- (UIImage *)image:(UIImage *)imageToRotate RotatedByDegrees:(CGFloat)degrees
{
    CGFloat radians = degrees * (M_PI / 180.0);

    UIView *rotatedViewBox = [[UIView alloc] initWithFrame:CGRectMake(0,0, image.size.height, image.size.width)];
    CGAffineTransform t = CGAffineTransformMakeRotation(radians);
    rotatedViewBox.transform = t;
    CGSize rotatedSize = rotatedViewBox.frame.size;

    UIGraphicsBeginImageContextWithOptions(rotatedSize, NO, [[UIScreen mainScreen] scale]);
    CGContextRef bitmap = UIGraphicsGetCurrentContext();

    CGContextTranslateCTM(bitmap, rotatedSize.height / 2, rotatedSize.width / 2);

    CGContextRotateCTM(bitmap, radians);

    CGContextScaleCTM(bitmap, 1.0, -1.0);
    CGContextDrawImage(bitmap, CGRectMake(-image.size.width / 2, -image.size.height / 2 , image.size.height, image.size.width), image.CGImage );
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
} 
```

旋转后的图像大小可能 >= 15MB（根据我的经验）。所以你应该压缩它并使用它。否则，您可能会遇到导致内存压力的崩溃。我用于压缩的代码如下所示。

```
NSData *imageData = UIImageJPEGRepresentation(yourImage, 1);
//1 - it represents the quality of the image.
NSLog(@"Size of Image(bytes):%d",[imageData length]);
//Here I used a loop because my requirement was, the image size should be <= 4MB.
//So put an iteration for more than 1 time upto when the image size is gets <= 4MB.
for(int loop=0;loop<100;loop++)
{
    if([imageData length]>=4194304)  //4194304 = 4MB in bytes.
    {
        imageData=UIImageJPEGRepresentation(yourImage, 0.3);
        yourImage=[[UIImage alloc]initWithData:imageData];
    }
    else
    {
        NSLog(@"%d time(s) compressed.",loop);
        break;
    }
} 
```

现在您`yourImage`可以在任何地方使用.. **快乐编码...**

# assembly - MIPS 中的简单加法

> ID：14857729
> 
> 赞同：3
> 
> 时间：2013-02-13T16:04:59.323
> 
> 标签：assembly, mips

我目前正在上 MIPS 汇编课程，我们使用的书已绝版，所以我依靠互联网寻求帮助，以便我理解。这个程序接受三个整数。其中两个是 add/sub/mult/div，第三个是操作符。这是代码。

```
 .text
    .globl __start
__start:

    # Prompt for first int and accept first int
    la $a0,firstint
    li $v0,4
    syscall

    li $v0,5
    move $s0, $v0
    syscall

    # Prompt for second int and accept second int
    la $a0,firstint
    li $v0,4
    syscall

    li $v0,5
    move $s1, $v0
    syscall

    # Prompt for operation
    la $a0,operation
    li $v0,4
    syscall

    li $v0,5
    move $s2, $v0
    syscall

    beq $s2,0,__add0

    li $v0,10
    syscall

__add0:
    la $a0,added
    li $v0,4
    syscall

    add $a0, $s0, $s1
    li $a0,1
    syscall

    .data
firstint:   .asciiz "Enter the first integer: "
secondint:  .asciiz "Enter the second integer: "
operation:  .asciiz "Enter operation (add=0, subtract=1, multiply=2, divide=3): "
added:      .asciiz "The added number is: " 
```

我的理解是，如果 $s2 中的值等于 0，beq 将跳转到 add0 .. 但它似乎没有发生。输入操作类型后停止输出。示例输出：

```
Enter the first integer: 10
Enter the first integer: 5
Enter operation (add=0, subtract=1, multiply=2, divide=3): 0

-- program is finished running -- 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:28:46.837

您必须在移动之前进行系统调用：

```
li $v0,5
syscall
move $s2, $v0 
```

# ruby-on-rails - 迁移如何影响 schema.rb 文件？

> ID：14857730
> 
> 赞同：0
> 
> 时间：2013-02-13T16:05:01.167
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我有点困惑**迁移**如何影响**schema.rb**文件？

例如，如果我编写迁移以重命名表列并运行该迁移甚至执行迁移`schema:load rake task`，那么当我打开我的`schema.rb`文件时，它是否应该**自动**更改为具有该新列名？还是我也应该在那里手动更改它？

**还有**我创建原始表的**create_table*.rb文件。**它们自动`t.timestamp field`在其中定义了一个在模式中创建这两个`created_at`和`updated_at`字段的定义，因此，如果我想删除它们，只需更改 create_table*.rb 文件并从中取出就足够了`t.timestamp`吗？并运行迁移？还是我也应该手动更改 shcema.rb 文件？

因此，如果有人可以解释一下如何一起工作，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:15:19.030

运行迁移时，架构文件会自动更改。您永远不必手动编辑它。

有关更多信息，请参阅[此 Rails 指南](http://guides.rubyonrails.org/migrations.html#schema-dumping-and-you)。

# scala - 如何确保隐式变量从特征传递到方法？

> ID：14857733
> 
> 赞同：0
> 
> 时间：2013-02-13T16:05:23.890
> 
> 标签：scala, playframework, playframework-2.0

我有一个特点写如下：

```
trait NewTrait { 
  def NewTrait(f: Request[AnyContent] => Result):  Action[AnyContent] = {
    Action { request =>
      implicit val newTrait = new model.helper.newTrait
      f(request) 
    }
  }
} 
```

还有一个使用该特征的控制器，并尝试将隐式 val newTrait 传递给视图：

```
object Test extends Controller with NewTrait {

  def foo(num: Int) = NewTrait { request =>
    val view = (views.html.example.partials.viewWrap)       
    Ok(views.html.example.examplePage(views.html.shelfPages.partials.sidebar())
} 
```

在 foo 中，newTrait 不在范围内，但是将其纳入范围的最佳实践是什么？对于收到的每个请求，它必须是唯一的。如果我从 foo 中重新声明隐式 val，它会起作用，但我必须每次在控制器中重复该声明，如果我可以将其隐藏在 trait 中，代码看起来会更清晰。有什么方法可以将特征中的隐含值传递给控制器​​？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:38:15.770

你可以有：

```
trait NewTrait {
    def gotRequest(req:Request) = {
        implicit val newTrait = new model.helper.newTrait
        // don't have to pass the newTrait parameter here 
        // explicitly, it is used implicitly
        Whatever.f(request)
    }
} 
```

和：

```
object Whatever {
    def f(req:Request)(implicit val newTrait:NewTrait) = {
        //newTrait is in scope here.

        //...the rest of your code
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T18:49:03.143

使所述 val 成为字段变量：

```
trait NewTrait { 
  implicit val newTrait = new model.helper.newTrait
  ...
} 
```

现在它将在方法`foo`范围内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T19:47:01.880

尽管我发现名称有点混乱（可能是示例代码），但您可以这样做：

```
trait NewTrait {
  def NewTrait(f: Request[AnyContent] => model.helper.newTrait => Result): Action[AnyContent] = {
    Action { request =>
      val newTrait = new model.helper.newTrait
      f(request)(newTrait)
    }
  }
} 
```

在使用它的代码中：

```
object Test extends Controller with NewTrait {
  def foo(num: Int) = NewTrait { request => implicit newTrait =>
    Ok
  }
} 
```

# windows - 如何通过windbg中的句柄获取文件路径？

> ID：14857736
> 
> 赞同：5
> 
> 时间：2013-02-13T16:05:27.367
> 
> 标签：windows, windbg, handle

如何在内核模式下使用 windbg/kd 从句柄获取文件路径？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T16:16:21.310

用于`!handle <handle_num> 7 <proc_id>`显示该句柄的详细信息，其中`<handle_num>`是句柄值和`<proc_id>`进程 ID 值（均基于十六进制），请参阅此[msdn](http://msdn.microsoft.com/en-us/library/windows/hardware/ff563187%28v=vs.85%29.aspx)链接以获取更多信息。

您可以从用户模式会话中获取您的进程 ID，这是最简单的方法，只需在用户模式下附加并输入管道命令`|`，它将输出如下：

> . 0 id: 1680 附加名称: D:\test\MyApp.exe

proc id也是如此`1680`，然后列出使用的句柄`!handle`，然后在内核模式下输入：

```
!handle <handle_num> 7 1680 
```

将显示你想要的，这里有一个有用的博客[条目](http://www.bytetalk.net/2009/03/windbg-tips-and-tricks.html)。

# sql - SQL Server - 没有聚合的行到列

> ID：14857737
> 
> 赞同：2
> 
> 时间：2013-02-13T16:05:26.550
> 
> 标签：sql, sql-server, tsql, pivot

我的数据如下所示：

```
address      | id  
12AnyStreet  | 1234  
12AnyStreet  | 1235  
12AnyStreet  | 1236  
12AnyStreet  | 1237 
```

我的目标是让它看起来像这样：

```
Address  id1   id2   id3   id4   
123Any   1234  1235  1246  1237 
```

基于一些谷歌搜索，我能够生成以下 CTE：

```
with cust_cte (Address, id, RID) as (
    SELECT Address, id, 
           ROW_NUMBER() OVER (PARTITION BY (Address) ORDER BY Address) AS RID 
    FROM tab) 
```

下一步是进行旋转，以便对于每个 RID，我将关联的 id 放在列中。但是，我似乎无法找到我发现的示例。我不会发布甚至可能并不真正适用的示例的其余部分，而是将其留给观众。其他不一定使用 CTE 的新方法也是值得赞赏的。这将处理大量数据，因此效率很重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T16:13:30.727

[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)您可以使用SQL Server 中的函数转换此数据。为了`PIVOT`数据，您需要使用`row_number()`.

如果您有已知数量的值，则可以对查询进行硬编码：

```
select *
from
(
  select address, id,
    'id_'+cast(row_number() over(partition by address 
                                order by id) as varchar(20)) rn
  from yourtable
) src
pivot
(
  max(id)
  for rn in ([id_1], [id_2], [id_3], [id_4])
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/a4a3d9/1)

但如果值未知，则需要使用动态 SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' 
                      + QUOTENAME(rn) 
                    from
                    (
                      select 'id_'+cast(row_number() over(partition by address 
                                order by id) as varchar(20)) rn
                      from yourtable
                    ) src
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT address,' + @cols + ' from 
             (
                select address, id,
                  ''id_''+cast(row_number() over(partition by address 
                                              order by id) as varchar(20)) rn
                from yourtable
            ) x
            pivot 
            (
                max(id)
                for rn in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/a4a3d9/3)

两个查询的结果是：

```
|     ADDRESS | ID_1 | ID_2 | ID_3 | ID_4 |
-------------------------------------------
| 12AnyStreet | 1234 | 1235 | 1236 | 1237 | 
```

# json - 只有一个 json 的 Angular JS 详细视图

> ID：14857739
> 
> 赞同：0
> 
> 时间：2013-02-13T16:05:41.813
> 
> 标签：json, angularjs

我在 Angular 中介绍了它的教程“Phonecat”。针对本教程，我想构建一个简单的应用程序，其中包含只有一个 json 的列表和详细视图，包含所有信息。

列表视图（显示 json 的完整内容）工作正常，但我很难为详细视图设置我的 Angular 服务。我正在使用 XHR 方法：

控制器.js：

```
function PlaygroundDetailCtrl($scope, Playground) {
  $scope.playgrounds = Playground.query();
} 
```

服务.js

```
angular.module('playgroundcatServices', ['ngResource']).
    factory('Playground', function($resource){
  return $resource('playgrounds/playgrounds.json', {}, {
    query: {method:'GET', isArray:true}
  });
}); 
```

游乐场.json

```
 [ 
   { 
     "id:" 1,
     "properties": "true"
     "lat": "51.347789"
     "lon": "12.232234"
   },
   {
     "id:" 2,
     "properties": "false"
     "lat": "51.347789"
     "lon": "12.766667"
   }
] 
```

我希望 Angular 只显示一个条目 (id:1) 及其属性。最聪明的方法是什么：再次显示然后过滤？

我难住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:23:28.590

在您的视图上使用 Angular[过滤器](http://docs.angularjs.org/api/ng.filter%3afilter)（无需过滤服务上的数据）：

```
<div ng-repeat="entry in playgrounds | filter:{id: 1}">
    <p>properties: {{entry.properties}}</p>
    <p>lat: {{entry.lat}}</p>
    <p>lon: {{entry.lon}}</p>
</div> 
```

**jsfiddle**：http: [//jsfiddle.net/bmleite/Ad6u9/](http://jsfiddle.net/bmleite/Ad6u9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T22:09:30.920

结果非常好：

控制器：

```
function PlaygroundDetailCtrl($scope, $routeParams, $http) {
    $http.get('playgrounds/playgrounds.json').success(function(data){
        angular.forEach(data, function(item) {
          if (item.id == $routeParams.playgroundId) 
            $scope.playground = item;
        });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T09:20:47.750

我现在有完全相同的场景我想（我猜你正在开发'移动'（就像我一样并且想要最小化数据传输） - 我正在使用一个'主 json 文件'，并且然后在我的详细视图中，只需在 ID 值上过滤该 json 文件（以便不必重新加载 json）。

这完全未经测试，但您的原始问题中的代码应修改如下：

```
angular.module('playgroundcatServices', ['ngResource'])
.factory('Playground', function($resource){
    return $resource('playgrounds/playgrounds.json', {}, {
        query: {method:'GET', isArray:true}
    });
});

function PlaygroundDetailCtrl($scope, Playground) {
  Playground.query(
    // params (none in this case)
    {},
    // Success
    function (data) {
        $scope.playgrounds = data.filter(function (o) {
            return o.id == $routeParams.playgroundId; // assuming you've set this up in your routes definition
        })[0];
    },
    // Error
    function (data) {
        //error handling goes here
    }
  );
} 
```

您可能还想`$scope.isDataLoaded = true;`在“成功”处理程序中添加类似的内容，并对其进行监视，以检查数据何时完成加载（例如，在指令中）。

我对里面的内容不是很满意`[0]`，但它认为解决方案比`forEach`我自己的循环更好。

# asp.net-mvc - 更改模型后如何验证模型状态

> ID：14857748
> 
> 赞同：0
> 
> 时间：2013-02-13T16:06:01.710
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model, modelstate

我正在尝试使用`ModelState.IsValid`which 目前总是返回 false，因为模型中的一个字段在对象中为空。

我想要做的是在这个方法中删除这个对象，然后尝试`ModelState.IsValid`改变模型？

```
loyaltyOffers = model.Offers.Where(m => m.Reward == "").ToList();
foreach (Offer offer in Offers)
{
   model.Offers.Remove(offer);
}       
if (ModelState.IsValid)
{ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:10:52.110

完成更改模型后，请使用以下命令：

```
if (TryValidateModel(model))
    // Valid!!! 
```

[MSDN](http://msdn.microsoft.com/en-us/library/ff356143%28v=vs.108%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:41:12.130

或者，您可以从 ModelState 中删除错误：

```
ModelState.Remove("key"); 
```

其中“key”是无效模型中错误的关键。

# lynx - 通过 sudo 运行 lynx

> ID：14857749
> 
> 赞同：0
> 
> 时间：2013-02-13T16:06:07.550
> 
> 标签：lynx

我试图在`Lynx`下运行`apache user via sudo`，但似乎 lynx 试图访问我的主目录：

```
 $ sudo -u apache lynx
    /home/ssmirnov/: No such directory 
```

我对我的主目录有这样的权限：`drwx------`

你能告诉我如何在另一个用户下运行 Lynx 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:38:29.737

您可以尝试使用 sudo 的`-H`选项。它设置`$HOME`为您尝试运行的用户的主目录。也许 lynx 正在那里寻找文件，我不知道。（我的机器上似乎没有问题......但是。）

`-i`也可以工作；它基本上设置了环境，就好像用户已经登录一样，包括 cd'ing 到他们的主目录。请注意，这意味着启动为该用户指定的 shell、运行登录脚本等等。如果不允许用户登录，这可能会失败。

如果你*想*从你的主目录运行它，例如下载一些东西到那个位置，当然你必须以`apache`某种方式授予访问权限。这可以通过说类似`setfacl -m u:apache:rwx $HOME`. 在紧要关头，您可以暂时放入`apache`您的组并授予您的主目录的组`rwx`权限......但除非这是您的家用机器，否则我不会这样做。

# javascript - 上下文drawImage / canvas toDataURL在opera mobile上显着滞后

> ID：14857752
> 
> 赞同：1
> 
> 时间：2013-02-13T16:06:12.503
> 
> 标签：javascript, canvas, html5-canvas, opera

我有一些在**Android**平板电脑上运行的 Javascript，运行**Opera Mobile 12**。平板电脑固定在办公室的墙上，因此在办公室工作的每个人都将其用作计时系统（即，他们用它来打卡/下班）。此 javascript 在引发特定事件时拍摄用户照片，然后将此照片转换为数据 URL，以便将其发送到服务器。*不过，`video``canvas``display:none;`*这一切都在后台运行 -*和**元素都设置为*.

这是处理网络摄像头交互的代码：

```
var Webcam = function() {
  var video = document.getElementById('video');
  var stream_webcam = function(stream) {
    video.addEventListener('loadedmetadata', function(){
      video.play();
    }, false);
    video.src = window.URL.createObjectURL(stream);
  }

  // start recording
  if (navigator.getUserMedia)
    navigator.getUserMedia({video: true}, stream_webcam);
  else
    _error("No navigator.getUserMedia support detected!");

  var w = {};

  w.snap = function(callback) {
    var canvas = document.getElementById('canvas');
    canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
    // delay is incurred in writing to canvas on opera mobile
    setTimeout(function() {
      callback(canvas.toDataURL());
    }, 1);
  };

  return w;
} 
```

`w.snap(callback)`当用户按下某个按钮时被调用。问题是调用和实际绘制到画布上的图像之间存在*显着滞后。***这是发生的问题**：`drawImage`

 ***   用户 1 使用平板电脑，按下按钮，将他们的照片“拍照”并发送到服务器。服务器接收到空白、透明的图像。（这与[html5 canvas toDataURL 返回空白图像不同](https://stackoverflow.com/questions/6919181/html5-canvas-todataurl-returns-blank-image)- 第一张图像发送到服务器的数据要少得多，因为它是空白的）
*   几分钟后，用户 2 使用平板电脑并按下按钮，并“拍摄”了他们的照片。服务器接收到用户 1 的照片。
*   之后，用户 3 做同样的事情，服务器获取用户 2 的照片。

所以我猜测调用`toDataURL()`是返回旧数据，因为`drawImage()`没有。（我在某处读到它是异步的，但我无法确认，也找不到任何方式将事件附加到它完成绘制时。）

我试过了：

*   将超时更改`snap()`为各种值。我试过的最高是2000，但同样的问题发生了。（如果有人建议更高的数字，我很乐意尝试，但我不想更高，因为如果我太高，用户 3 有可能在我处理用户 2 之前拍摄他们的照片照片，这意味着我可能会完全失去它！）
*   让画布在页面首次加载时绘制一些东西，但这并没有解决它 - 当用户 1 被拍照时，服务器接收到页面加载时拍摄的任何照片，而不是用户 1 的照片。
*   `getElementById`在调用之前使用 , 再次“获取”画布元素`toDataURL`。

还有一些注意事项：

*   这在我的 Chrome 和 Opera 计算机（macbook air）上运行良好。
*   我无法使用调试器可靠地复制它（使用 Opera Dragonfly 链接到平板电脑）。
*   AFAIK Opera Mobile 是唯一支持`getUserMedia`并因此可以拍照的 Android 浏览器。
*   如果我`display:none;`从`video`and中删除`canvas`，它可以正常工作（在平板电脑上）。**仅当视频和画布已`display:none;`设置时才会出现此问题。**

因为该页面是一个不需要滚动或缩放的单页应用程序，一个可能的解决方法是将视频和画布移动到页面折叠下方，然后使用 javascript 禁用滚动（即，当用户滚动时滚动到顶部）。

但如果可能的话，我宁愿一个适当的修复而不是解决方法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T10:45:19.647

我没有一个很好的解决方案，但我建议不要通过将其设置为不可见来通过 dom 处理不可见的画布。

代替

```
 var canvas = document.getElementById('canvas'); 
```

尝试

```
var canvas = document.createElement('canvas');
 canvas.width = video.width;
 canvas.height = video.height;
 canvas.getContext('2d').drawImage(video, 0, 0) 
```

这样它就与 DOM 分开了。

还有为什么不使用

```
canvas.toDataURL("image/jpg")? 
```

编辑：另外，如果您正在设计它，您是否尝试过其他浏览器？是什么限制了您使用 Opera 而不是其他可用的浏览器或使用 phonegap？

EDIT2：考虑一下，Canvas 还有两个其他选项可以将您想要查看的照片放在两个位置。那两个是：

```
var imgData = canvas.getContext('2d').getImageData(0,0,canvas.width,canvas.height); 
```

-或者-

```
canvas.getContext('2d').putImageData(imgData,0,0); 
```

这两个忽略了您对上下文所做的任何缩放，但我发现它们更直接并且通常更快。它们是 toDataURL 和 drawImage 的可靠替代品，但您放置和从中获取的图像数据被编码为以下形式的数组：

[r1, b1, g1, a1, r2, b2, g2, a2....]

你可以在这里找到他们的文档：

[http://www.w3schools.com/tags/canvas_putimagedata.asp](http://www.w3schools.com/tags/canvas_putimagedata.asp) [http://www.w3schools.com/tags/canvas_getimagedata.asp](http://www.w3schools.com/tags/canvas_getimagedata.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-09T15:08:52.997

某些版本的Android有问题`toDataUrl();`也许这是解决方案？

[http://code.google.com/p/todataurl-png-js/wiki/FirstSteps](http://code.google.com/p/todataurl-png-js/wiki/FirstSteps)

脚本：[http ://todataurl-png-js.googlecode.com/svn/trunk/todataurl.js](http://todataurl-png-js.googlecode.com/svn/trunk/todataurl.js)

将此粘贴到您的`head`：

```
<script src="todataurl.js"></script> 
```**

# java - java vm初始化错误

> ID：14857753
> 
> 赞同：0
> 
> 时间：2013-02-13T16:06:14.597
> 
> 标签：java

我最近为 Windows 64 位安装了 jdk-7u11。它最初运行良好，我使用 javac 和 java 成功编译并执行了我的 java 程序。但是很晚了，一旦我使用 javac 编译了一个文件，它就会顺利进行，当我继续使用 java 执行文件时，它会给出以下错误：

初始化虚拟机时出错

java/lang/NoClassDefFoundError: java/lang/Object

我应该怎么办？我是jdk的新手用户，我也尝试在卸载后重新安装系统，但没有成功。解决办法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:12:33.150

这可能是由于 PATH 和 JAVA_HOME 配置错误。java 二进制文件和 JAVA_HOME 应该指向相同的 java 版本。否则可能会发生不好的事情

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T16:25:16.733

有时加载 JDBC 驱动程序的尝试执行动态类加载尝试（即基于反射）

# actionscript-3 - TypeError：错误 #1009：无法访问空引用的属性或方法

> ID：14857756
> 
> 赞同：0
> 
> 时间：2013-02-13T16:06:20.523
> 
> 标签：actionscript-3, oop, class, methods, typeerror

我正在创建一个平台游戏。但是，我在平台上创建碰撞边界以使玩家在平台上跳跃而不掉落后遇到错误。

我创建了一个矩形框并将其导出为`platForm`

这是错误的输出：错误一遍又一遍地重复自己......

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
    at Boy/BoyMove() 
```

主类：

```
package 
{
import flash.display.*;
import flash.text.*;
import flash.events.*;
import flash.utils.Timer;
import flash.text.*;

public class experimentingMain extends MovieClip 
{
    var count:Number = 0;
    var myTimer:Timer = new Timer(10,count);

    var classBoy:Boy;

    //var activateGravity:gravity = new gravity();

    var leftKey, rightKey, spaceKey, stopAnimation:Boolean;

    public function experimentingMain() 
    {
        myTimer.addEventListener(TimerEvent.TIMER, scoreUp);
        myTimer.start();

        classBoy = new Boy();
        addChild(classBoy);

        stage.addEventListener(KeyboardEvent.KEY_DOWN, pressTheDamnKey);
        stage.addEventListener(KeyboardEvent.KEY_UP, liftTheDamnKey);
    }

    public function pressTheDamnKey(event:KeyboardEvent):void
    {
        if (event.keyCode == 37)
        {
            leftKey = true;
            stopAnimation = false;
        }

        if (event.keyCode == 39)
        {
            rightKey = true;
            stopAnimation = false;
        }

        if (event.keyCode == 32)
        {
            spaceKey = true;
            stopAnimation = true;
        }
    }

    public function liftTheDamnKey(event:KeyboardEvent):void
    {
        if (event.keyCode == 37)
        {
            leftKey = false;
            stopAnimation = true;
        }

        if (event.keyCode == 39)
        {
            rightKey = false;
            stopAnimation = true;
        }

        if (event.keyCode == 32)
        {
            spaceKey = false;
            stopAnimation = true;
        }
    }

    public function scoreUp(event:TimerEvent):void 
    {
        scoreSystem.text = String("Score : "+myTimer.currentCount);
    }

}
   } 
```

男生班：

```
package 
{
import flash.display.*;
import flash.events.*;

public class Boy extends MovieClip
{
    var leftKeyDown:Boolean = false;
    var upKeyDown:Boolean = false;
    var rightKeyDown:Boolean = false;
    var downKeyDown:Boolean = false;
    //the main character's speed
    var mainSpeed:Number = 15;
    //whether or not the main guy is jumping
    //var mainJumping:Boolean = false;
    var mainJumping:Boolean = false;
    //how quickly should the jump start off
    var jumpSpeedLimit:int = 40;
    //the current speed of the jump;
    var jumpSpeed:Number = 0;
    var gravity:Number = 10;

    var theGround:ground = new ground();

    //var theCharacter:MovieClip;

    public var currentX,currentY:int;

    public function Boy()
    {
        this.x = 600;
        this.y = 540;

        addEventListener(Event.ENTER_FRAME, BoyMove);
    }

    public function BoyMove(event:Event):void
    {
        currentX = this.x;
        currentY = this.y;

        if (MovieClip(parent).leftKey)
        {
            currentX -=  mainSpeed;
            MovieClip(this).scaleX = 1;
        }

        if (MovieClip(parent).rightKey)
        {
            currentX +=  mainSpeed;
            MovieClip(this).scaleX = -1;
        }

        if (MovieClip(parent).spaceKey || mainJumping)
        {
            mainJump();
        }

        this.x = currentX;
        this.y = currentY;
    }

    public function mainJump():void
    {
        currentY = this.y;

        if (! mainJumping)
        {

            mainJumping = true;
            jumpSpeed = jumpSpeedLimit * -1;
            currentY +=  jumpSpeed;
        }
        else
        {
            if (jumpSpeed < 0)
            {
                jumpSpeed *=  1 - jumpSpeedLimit / 250;
                if (jumpSpeed > -jumpSpeedLimit/12)
                {
                    jumpSpeed *=  -2;
                }
            }
        }
        if (jumpSpeed > 0 && jumpSpeed <= jumpSpeedLimit)
        {
            jumpSpeed *=  1 + jumpSpeedLimit / 120;
        }
        currentY +=  jumpSpeed;

        if (MovieClip(this).y > 500)
        {
            mainJumping = false;
            MovieClip(this).y = 500;
        }

        this.y = currentY;
    }
}
    } 
```

Platformer 类：这是我要为矩形设置边界的类（platForm）

```
package 
{
import flash.events.*;
import flash.display.MovieClip;

public class platForm extends MovieClip
{
    var level:Array = new Array();
    var classBoys:Boy = new Boy();
    var speedx:int = MovieClip(classBoys).currentX;

    public function platForm() 
    {

        for (var i = 0; i < numChildren; i++)
        {
            if (getChildAt(i) is platForm) 
            {
                level.push(getChildAt(i).getRect(this));
            }
        }

        for (i = 0; i < level.length; i++) 
        {
            if (MovieClip(classBoys).getRect(this).intersects(level[i]))
            {
                if (speedx > 0) 
                {
                    MovieClip(classBoys).x = level[i].left - MovieClip(classBoys).width/2;
                }
                if (speedx < 0) 
                {
                    MovieClip(classBoys).x = level[i].right - MovieClip(classBoys).width/2;
                }
            }
        }
    }
}
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:15:40.360

如果无法运行您的代码，很难确切地看到正在发生的事情，但错误是说您的 BoyMove() 方法中的某些内容正在尝试引用 null 的某个属性（或方法）。查看 BoyMove() 方法后，我可以看到没有太多可能导致此问题的方法。另外两名候选人将是

```
MovieClip(parent) 
```

或者

```
MovieClip(this) 
```

您正在尝试访问这两个 MovieClip 的属性。其中之一不得按您的预期初始化。我建议您通过使用 MovieClip(parent) 注释掉这些行来对该方法进行一些基本调试，看看是否仍然出现错误。然后用 MovieClip(this) 的行尝试相同的操作。这应该足以隔离问题。

# java - 将输入拆分为向量

> ID：14857760
> 
> 赞同：0
> 
> 时间：2013-02-13T16:06:47.223
> 
> 标签：java, vector, io

我必须将此输入从文件拆分为向量并添加到向量中。

文件输入

```
 1,375,seller
   1,375,sellers
   1,375,send
   1,375,sister
   1,375,south
   1,375,specific
   1,375,spoiler
   1,375,stamp
   1,375,state
   1,375,stop
   1,375,talked
   1,375,tenant
   1,375,today
   1,375,told

    FileInputStream fstream = new FileInputStream("e://inputfile.txt");
        // Use DataInputStream to read binary NOT text.
        BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
        String strLine;

        while ((strLine = br.readLine()) != null)  
        {
            Vector dataPoints = new Vector();
            dataPoints.add(br);

             dataPoints.add(new DataPoint());
        }

   ------ public DataPoint(double x, double y, String name) this is the method 
```

如何将字符串拆分为 double 和 string 并为向量提供输入？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:14:30.683

使用[String#split(String)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#split%28java.lang.String%29)：

```
Vector<DataPoint> dataPoints = new Vector<DataPoint>();        
while ((strLine = br.readLine()) != null) {
    String[] array = strLine.split(",");
    dataPoints.add(new DataPoint(Double.parseDouble(array[0]), Double.parseDouble(array[1]), array[2]));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:13:32.157

只需拆分`Bufferedreader`使用`String.split()`using`,`作为**分隔符**返回的字符串。并且还考虑使用 an`ArrayList`而不是`Vector`，除非您关心**线程安全**并且还使您的集合具有通用性。

```
 Vector<DataPoint> dataPoints = new Vector<DataPoint>();   
 while ((strLine = br.readLine()) != null)  
        {
            String[] arr = strLine.split(",");
            DataPoint point = new DataPoint(Double.valueOf(arr[0]), Double.valueOf(arr[1]), arr[2]);
            dataPoints.add(point);
        } 
```

# c - C：编写可以自动矢量化、嵌套循环、GCC 的代码

> ID：14857762
> 
> 赞同：4
> 
> 时间：2013-02-13T16:07:04.623
> 
> 标签：c, gcc, vectorization

我正在尝试编写一些可以矢量化的 C 代码。这是我正在尝试的循环：

```
for(jj=0;jj<params.nx;jj++)
    for(kk=0;kk<NSPEEDS;kk++)
        local_density_vec[jj] += tmp_cells_chunk[jj].speeds[kk]; 
```

`-ftree-vectorizer-verbose=5`当使用标志[http://pastebin.com/RfCc04aS](http://pastebin.com/RfCc04aS)运行时，GCC 会给我以下消息。

我怎样才能重写它以便它可以自动矢量化。`NSPEEDS`是 5。

编辑：

我一直在努力，我似乎​​无法用`.speeds[kk]`. 有没有办法对其进行重组以使其可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:15:11.923

```
for (jj = 0; jj < nx; jj++) {
        partial = 0.0f;
        fp = c[jj].speeds;
        for (kk = 0; kk < M; kk++)
                partial += fp[kk];
        out[jj] = partial;
}
(...)
Calculated minimum iters for profitability: 12

36:   Profitability threshold = 11

Vectorizing loop at autovect.c:36

36: Profitability threshold is 11 loop iterations.
36: LOOP VECTORIZED. 
```

要点：

1）在您的转储中，循环被认为是“复杂的访问模式”（请参阅​​日志的最后一行）。如前所述，这与编译器无法验证别名有关。对于“简单”的访问模式，请参阅： http: [//gcc.gnu.org/projects/tree-ssa/vectorization.html#vectorizab](http://gcc.gnu.org/projects/tree-ssa/vectorization.html#vectorizab)

2) 我的示例循环需要 12 次迭代才能使矢量化有用。由于 NSPEEDS == 5，如果将您的向量化，编译器会浪费时间。

3) 在添加 -funsafe-math-optimizations 后，我只能对循环进行矢量化。我认为这是必需的，因为结果向量运算的舍入或关联行为不同。参见，例如： [http ://en.wikipedia.org/wiki/Floating_point#Accuracy_problems](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)

4）如果您反转循环，您可能会再次遇到“复杂”访问模式的问题。如前所述，您可能需要反转阵列组织。检查有关跨步访问的 gcc 矢量化文档以检查您是否可以匹配其中一种模式。

为了完整起见，这里是完整的例子： http: [//pastebin.com/CWhyqUny](http://pastebin.com/CWhyqUny)

# logging - Global.java 的日志去哪儿了？

> ID：14857764
> 
> 赞同：0
> 
> 时间：2013-02-13T16:07:08.040
> 
> 标签：logging, playframework-2.0, onstart

我正在测试游戏框架的最后一个稳定版本。我创建了 `Global.java`类并覆盖了 `onStart`我放置的 方法`Logger.info("test...");`

而且我在任何地方都看不到这个日志（没有服务器控制台，没有 application.log 文件）。

如何为全局配置记录器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T08:53:16.603

解决了。在 conf 文件夹中添加 logger.xml 文件和下一个内容后

```
<configuration>

<conversionRule conversionWord="coloredLevel" converterClass="play.api.Logger$ColoredLevel" />

<appender name="FILE" class="ch.qos.logback.core.FileAppender">
    <file>${application.home}/logs/application.log</file>
    <encoder>
        <pattern>%date - [%level] - from %logger in %thread %n%message%n%xException%n</pattern>
    </encoder>
</appender>

<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
        <pattern>%coloredLevel %logger{15} - %message%n%xException{5}</pattern>
    </encoder>
</appender>

<logger name="play" level="INFO" />
<logger name="application" level="INFO" />

<root level="DEBUG">
    <appender-ref ref="STDOUT" />
    <appender-ref ref="FILE" />
</root>
</configuration> 
```

我在服务器控制台中看到了日志。

# entity-framework - 使用 ASP.NET Web API 和实体框架的 API 版本控制

> ID：14857765
> 
> 赞同：7
> 
> 时间：2013-02-13T16:07:08.447
> 
> 标签：entity-framework, rest, asp.net-web-api, versioning

我正在使用 ASP.NET Web API、Code-First Entity Framework 5 和 SQL Server 2012 开发 REST API，我需要能够对 API 进行版本控制。我已经阅读了一些关于在 URI 或自定义 HTTP 标头中指示 API 版本以及使用自定义 IHttpControllerSelector 根据指示版本选择不同 ApiController 的博客文章和文章。这一切都说得通。

我正在努力弄清楚的是如何管理 Web API 层之外的版本控制的影响，特别是在实体框架中。如何在不破坏旧版本 API 的情况下改进我的 DbContext？我也可以对 DbContext 进行版本控制吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:35:43.843

我最终做的是将存储库模式与 Pablo 的答案结合起来。它的要点是我的 EF 模型是版本化的，我使用 EF Code-First Migrations 将数据库迁移到模型的新版本，我`DbContext`总是使用最新版本的模型，我开发了许多具体的存储库每个都实现`IRepository<TItem>`下面的接口。

```
public interface IRepository<TItem> : IQueryable<TItem>, ICollection<TItem>, IDisposable
    where TItem : class
{
    void Update(TItem item);
    void SaveChanges();
} 
```

一种实现`IRepository<TItem>`是`DbRepository<TItem>`包装用于与数据库对话的实体框架代码。

```
public class DbRepository<TItem> : IRepository<TItem> 
    where TItem : class
{
    private MyDbContext _db;

    public DbRepository()
    {
        _db = new MyDbContext();
    }

    // Implementation of IRepository<TItem> methods
} 
```

另一个实现`IRepository<TItem>`是`TypeConversionRepository<TExternal,TInternal>`一个抽象类，它有助于从一种模型类型转换为另一种模型类型。

```
public abstract class TypeConversionRepository<TExternal, TInternal> : IRepository<TExternal>
    where TExternal : class
    where TInternal : class
{
    protected IRepository<TInternal> InternalRepository { get; set; }

    protected abstract TInternal ConvertInbound(TExternal externalItem);

    protected abstract TExternal ConvertOutbound(TInternal internalItem);

    // Implementation of IRepository<TItem> methods
} 
```

返回模型或接受模型作为参数的方法使用`ConvertInbound()`和`ConvertOutbound()`转换类型的模型，`TExternal`反之亦然`TInternal`。因此，给定以下 2 个版本`MyModel`，我们可以编写 2 个版本的 MyModelRepository；版本 2 可以直接与数据库对话，而版本 1 需要从版本 2 转换回版本 1。

```
namespace Models.v1
{
    public class MyModel
    {
        public int Id { get; set; }
        public string MyProperty { get; set; }
    }

    public class MyModelRepository : TypeConversionRepository<Models.v1.MyModel,Models.v2.MyModel>
    {
        MyModelRepository()
        {
            this.InternalRepository = new Models.v2.MyModelRepository();
        }

        protected override TInternal ConvertInbound(TExternal externalItem)
        {
            return new Models.v2.MyModel
            {
                Id = externalItem.Id,
                MyNewProperty = externalItem.MyProperty
            };
        }

        protected override TExternal ConvertOutbound(TInternal internalItem)
        {
            return new Models.v1.MyModel
            {
                Id = internalItem.Id,
                MyProperty = internalItem.MyNewProperty
            };
        }
    }
}

namespace Models.v2
{
    public class MyModel
    {
        public int Id { get; set; }
        public string MyNewProperty { get; set; }
    }

    public class MyModelRepository : DbRepository<MyModel>
    {

    }
} 
```

现在 v1 ApiController 可以使用 v1 MyModelRepository，v2 ApiController 可以使用 v2 MyModelRepository，但最终所有请求都使用已迁移到 v2 的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T13:58:16.900

我认为分别发展 Web API 和下划线 DB 模型（或 EF 模型）是一个很好的做法。这意味着 Web API 的 DTO 模型，它映射到 Web API 中的 EF 模型。该间接层将使您有机会进行可能仅影响 Web API 或 EF 模型的更改。此外，Web API 中的新版本可能不会直接影响现有的 EF 模型。例如，使用一组完全不同的表的新版本的 Web API。

问候，巴勃罗。

# c# - C#/SQL 错误：解析查询时出错。[令牌行号=1，令牌行偏移量=26，错误令牌=用户]

> ID：14857766
> 
> 赞同：2
> 
> 时间：2013-02-13T16:07:09.680
> 
> 标签：c#, sql, razor

我无法解决这个错误。服务器错误指出这一行：

```
<select name="selectUserName">
        @foreach(var row in db.Query(selectQueryString)) {
          <option>@row.username</option>
        }
      </select> 
```

其中`selectQueryString`定义为：

```
var selectQueryString = "SELECT ID, username FROM user"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:12:02.933

`USER`是*[`reserved keyword`](http://msdn.microsoft.com/en-us/library/aa238507%28v=sql.80%29.aspx)*SQL Server 中的一个。

您应该将它与方括号一起使用`[]`

喜欢;

```
var selectQueryString = "SELECT ID, username FROM [USER]"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:08:41.190

用户是 SQL Server 中的[保留字](http://msdn.microsoft.com/en-us/library/aa238507%28v=sql.80%29.aspx)。尝试：

```
FROM [User] 
```

# php - Cakephp2.3 的 Croogo Cms 插件

> ID：14857779
> 
> 赞同：0
> 
> 时间：2013-02-13T16:08:04.593
> 
> 标签：php, cakephp, cakephp-2.1, croogo

我是 **Cakephp2.3**的新手 ，在搜索时我发现了内置于 CakEPHP 2+ 中的 croogo CMS。

我非常喜欢croogo。但我只需要 2 个 Croogo 插件到我的应用程序中

**ACL 和翻译**。

我们可以在我的蛋糕应用程序中使用这些插件吗？如果是的话怎么办？你能告诉我吗？我google了很多，但我没有成功。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T19:41:46.330

ACL 和 Translation 与其说是 Croogo 插件，不如说是所有 CakePHP 发行版附带的核心库。

你可以在文档中找到所有关于它们的实现：

1.  [ACL 组件](http://book.cakephp.org/2.0/en/core-libraries/components/access-control-lists.html)
2.  [翻译行为](http://book.cakephp.org/2.0/en/core-libraries/behaviors/translate.html)

# c# - 在 .NET 应用程序中创建右键单击对话框

> ID：14857780
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:08:05.210
> 
> 标签：c#, dialog, right-click

我想在我的 .NET 应用程序中创建一个函数，类似于 Microsoft Word 中的“添加到字典”选项。我基本上想在文本框中突出显示一个单词，右键单击它，然后选择“添加到自定义词典”。这可能吗？我不知道如何在右键单击时显示自定义菜单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:32:21.810

如果我理解正确，您可能可以使用上下文菜单并将其绑定到您的控件。

```
ContextMenu myContextMenu = new ContextMenu();
// Set various options for the context menu

myControl.ContextMenu = myContextMenu; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T19:49:50.367

所以答案很简单。我没有意识到 Visual Studio 工具箱中有一个 ContextMenu 项。所以我只是做了以下事情：

```
1) Drag the contextMenu onto the WinForm
2) Assign the contextMenu to the textBox in question
3) Add items to the contextMenu.
4) Assign shortcut keys to each item in the contextMenu. 
```

我仍在试图弄清楚如何触发 contextMenu 中的各个项目。

# python - 如何确保属性具有特定值？

> ID：14857783
> 
> 赞同：0
> 
> 时间：2013-02-13T16:08:10.737
> 
> 标签：python, sqlalchemy, constraints

假设我有一个`Car`有 a`Manufacturer`和 a的类`Color`。A`Manifacturer`定义了汽车可以涂上哪种颜色。Car、Color 和 Manufacturer 都是我在 SQLAlchemy 中使用 declarative_base 建模的表。颜色是一个具有一些属性的复杂类。

我想将汽车的颜色限制为制造商指定的颜色。我可以使用约束或类似的东西限制汽车在 SQLAlchemy 中获得的颜色，还是我必须在纯 Python 中检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:41:18.103

我相信[sqlalchemy.types.Enum](http://docs.sqlalchemy.org/en/rel_0_8/core/types.html#sqlalchemy.types.Enum)应该处理处理定义的字符串列表所需的内容。

> Enum 类型提供了一组可能的字符串值，列被约束。默认情况下，如果可用，则使用后端的本机 ENUM 类型，否则使用 VARCHAR + CHECK 约束。

但是从对象约束级别来看，我想您可以使用带有 Check 约束的 ForeignKey 来处理它，但似乎检查约束只是将它直接传递给数据库，因此它会根据您正在运行的 dbms 而有所不同. [这个问题深入到](https://stackoverflow.com/questions/1036217/is-it-possible-to-add-a-logic-constraint-to-a-foreign-key)应该能够与[SQLAlchemy 的 Constraints](http://docs.sqlalchemy.org/en/latest/core/schema.html#check-constraint)配对的 SQL 中。

一种更简洁、更便携的方法可能是将其构建到您的构造函数中，或者仅具有一个可以在触发查询之前验证数据的函数

```
## Using the Car constructor for validation

def __init__(self,color,manufacturer,price=1000):
    if color in manufacturer.allowed_colors:
        self.color = color
        self.manufacturer
    else:
        raise LookupError() # or something more relevant.
    self.price = price

## Or just a generic function that can be called:

def validate_car(color,manufacturer):
    if color in manufacturer.allowed_colors:
        return true
    return false

if validate_car(color,manufacturer):
    car = Car(color,manufacturer)
    session.add(car) 
```

如果是我，这个验证将在我的应用程序的外围进行。假设是一个 Web 应用程序，这意味着它将在表单级别进行验证——只有相关的汽车颜色会显示给用户，然后服务器将验证所选颜色以确保没有用户挤入不良数据。所以我会有一个函数，`validate_car(color,manufacturer)`但是如果表单被检出，它会在表单被处理时被调用，然后我会创建并添加 Car 对象。

在 dbms 本身中有约束对于级联删除会很有趣，例如，如果福特决定停止销售蓝色汽车，那么你可以删除蓝色，所有蓝色福特汽车都会再次神奇地消失，不过，我想如果你要去约束路线，几乎是手动 SQL 来连接它（尽管如果不是，我很乐意学习！）。

# javascript - 仅在服务器上保存更改的对象：Restful service + angularjs

> ID：14857784
> 
> 赞同：3
> 
> 时间：2013-02-13T16:08:12.517
> 
> 标签：javascript, angularjs

我在我的页面上显示一个帖子列表，其中包含用户可以打开或关闭的喜欢按钮。为了限制我的服务器的流量，我想：

*   **在**同一请求中同时发送**所有**类似状态发生变化的帖子的更新
***   **仅**发送已修改帖子的更新***   每 N 秒更新一次类似状态，并且仅在页面退出时更新。不是每次用户切换一个喜欢的按钮。****

 ****这可能与 angularjs 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T18:55:35.657

我写了一个可以在这里看到的例子：

[http://plnkr.co/edit/imMGTJ75mKJZT7ispD9E?p=preview](http://plnkr.co/edit/imMGTJ75mKJZT7ispD9E?p=preview)

我花了一些时间来评论它，并提供在页面运行时显示在页面本身上的有用信息。如果消息移动得太快，如果您希望它运行得更慢，请更改延迟。

从您的问题来看，当用户对特定帖子进行任何更改时，您似乎想要保存。您建议每 x 秒检查一次更改，但这并不理想（尽管使用 a 实现起来很简单`setInterval`）。您还提到在页面退出时保存更改，但无法保证页面退出时会发生某些事情（例如用户断电）。

为避免上述情况，我会在用户单击“喜欢”按钮时触发 ajax 调用，但在第一次单击后对其进行节流并在节流计时器运行时存储更改，并在计时器结束后立即推送所有更改。

简而言之，这是我的 plunker 代码的作用：

1.  用户“喜欢”或“不喜欢”帖子，它将使用帖子上的新信息向服务器发出 Ajax 调用。此时，任何新的“喜欢”/“不喜欢”都会被放入需要更新的帖子“队列”中。

2.  当第一个 Ajax 调用成功时，节流计时器启动。在我提供的示例中，它是 5 秒。对帖子的任何更改（“喜欢”、“不喜欢”）都将被扔到同一个“队列”中。

3.  5 秒后，它会检查“队列”。如果为空，则不执行任何操作。如果其中有项目（例如已更改的帖子），那么它将进行第二次 ajax 调用并更新服务器上的帖子。

我的示例不会准确反映您正在处理的内容，但重要的是概念。您可以修改代码，使其不会在这么长时间内节流，或者仅在一定时间内 x 次 ajax 调用后节流，等等。****

# jquery - 带有数据库图像的 aspx 幻灯片

> ID：14857792
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:08:26.040
> 
> 标签：jquery, asp.net, image, slideshow

我想在 jquery 中创建幻灯片。

但我的文件位于数据库中。

我可以从图像列表中创建 jquery 幻灯片吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:18:06.637

[http://www.c-sharpcorner.com/UploadFile/sapnabeniwal/a-glimpse-to-image-slideshow-using-jquery/](http://www.c-sharpcorner.com/UploadFile/sapnabeniwal/a-glimpse-to-image-slideshow-using-jquery/)

使用 jQuery 在 ASP.NET 中滑动图像。我们经常在网站内部看到这样的情况，在角落里，图片一张一张地滑动；它可能是广告图像或您想要展示的商业或外观图像。通过使用这种类型的功能，我们可以给我们的网站一个很棒的效果，这将对网站的用户产生很大的影响。您经常看到这些基本上是在 Flash 上构建的，但是通过在 ASP.NET 中使用 jQuery，我们可以构建这种类型的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:18:05.937

我认为您的数据库中只有路径，并且图像仅位于文件夹中，借助 datalist 或 repeater，您可以轻松创建 jquery 滑块，您只需将 datalist 或 repeater 放在图像的位置例子。

# html - Img 宽度不延伸到表格标签的宽度

> ID：14857797
> 
> 赞同：0
> 
> 时间：2013-02-13T16:08:35.820
> 
> 标签：html

我正在编写 HTML 时事通讯，由于某种原因，尽管像素宽度相同，但我的 img 宽度并未扩展 td 标签的整个宽度。我的图像显示为 180，但 td 标签的宽度为 186。下面提供的是我的代码。

```
<table width="600" bgcolor="#ffffff" height="30" cellpadding="0" cellspacing="0">
    <tr >
        <td width="10"></td>
        <td width="180" height="30" bgcolor="#000000"><p style="text-align:center; color:#ffffff">ALONSOS</p></td>
        <td width="10"></td>
        <td width="180" bgcolor="#000000"><p style="text-align:center; color:#ffffff">ZEN WEST</p></td>
        <td width="10"></td>
        <td width="180" bgcolor="#000000"><p style="text-align:center; color:#ffffff">LUCKIE'S TAVERN</p></td>
        <td width="10"></td>

    <tr>
        <td width="10"></td>
        <td width="180" height="30" bgcolor="#ffffff"><img src="zenwest.png" width="180"/></td>
        <td width="10"></td>
        <td width="180" height="30" bgcolor="#000000"><img src="zenwest.png" width="180"/></td>
        <td width="10"></td>
        <td width="180" bgcolor="#000000"><img src="magerks.png" width="180" /></td>
        <td width="10"></td>
    </tr>
    <tr>
        <td width="10"></td>
        <td width="180" ><p><b>Saturday, Feb. 9th</b></p>
            <p>$3 Bud Light</p>
            <p>$4 Soco & Lime</p>
            <p>$3 Bud Light</p>
        </td>
        <td width="10"></td>
        <td width="176"><p><b>Saturday, Feb. 9th</b></p>
            <p>$3 Bud Light</p>
            <p>$4 Soco & Lime</p>
            <p>$3 Bud Light</p>
        </td>
        <td width="10"></td>
        <td width="180"><p><b>Saturday, Feb. 9th</b></p>
            <p>$3 Bud Light</p>
            <p>$4 Soco & Lime</p>
            <p>$3 Bud Light</p>
        </td>
        <td width="10"></td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:10:37.723

标记中的所有 td 标签都具有 '180' 宽度。尝试将首选 td 标签的宽度设置为“186”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:14:28.180

如果您删除桌子上的宽度，间距会按照您想要的方式结束。

```
<table bgcolor="#ffffff" height="30" cellpadding="0" cellspacing="0"> 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/WaVZv/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:17:27.610

`table-cell`宽度类似于`display: inline`它不一定尊重提供的宽度，在这种情况下它取决于表格。表格单元格的宽度将增加以适应整个`600px`-wide 表格的宽度，从而导致您看到的看似奇怪的行为。您可以增加 in-between `<td>`s 以使总宽度加起来为 600，或者您可以删除表格宽度并使其成为任何内容（类似于`580px`）。

# spring - Spring Security：AuthenticationFailureCredentialsExpiredEvent 未触发

> ID：14857799
> 
> 赞同：1
> 
> 时间：2013-02-13T16:08:38.587
> 
> 标签：spring, spring-security

我正在使用 spring.security.version = 3.1.0.RELEASE。我遇到的问题是由于某种原因 AuthenticationFailureCredentialsExpiredEvent 没有被触发。

在调试代码时，我发现 AbstractUserDetailsAuthenticationProvider 确实在控制台中显示“用户帐户凭据已过期”。但我仍然对为什么没有触发相关事件感到困惑。

这是我的代码：

```
class JpaUserDetails implements UserDetails {
...
...
   @Override
   public boolean isCredentialsNonExpired() {
       if (some logic) {
           return true;
       }
       else {
           return false;
       }
   }
} 
```

我确实看到 AbstractUserDetailsAuthenticationProvider 在控制台中显示“用户帐户凭据已过期”，来自以下弹簧代码行：

```
public abstract class AbstractUserDetailsAuthenticationProvider implements AuthenticationProvider, InitilizeBean, MessageSourceAware {
...
...
    private class DefaultPostAuthenticationChecks implements UserDetailsChecker {
        public void check(UserDetails user) {
            if(!user.isCredentialsNonExpired()) {
                logger.debug("User account credentials have expired");
                throw new CredentialsExpiredException(message.getMessage(
                          "AbstractUserDetailsAuthenticationProvider.credentialsExpired",
                          "User credentials have expired"), user);
            }
        }
    }
} 
```

问题是，当用户凭据过期时，我希望 Spring 生成事件 AuthenticationFailureCredentialsExpiredEvent，我正在通过以下方式处理该事件：

```
class SecurityEventDispatcher implements ApplicationListener<ApplicationEvent> {
    final List<SecurityEventListener> listeners = new ArrayList<SecurityEventListener>();

    public void registerListener(SecurityEventListener listener) {
        this.listener.add(listener);
    }

    public void onApplicationEvent(ApplicationEvent event) {
        for (SecurityEventListener listener : this.listeners) {
            if(listener.canHandle(event)) {
                listener.handle(event);
            }
        }
    }
} 
```

这就是我处理登录失败事件的方式：

```
public class LoginFailedEvent extends SecurityEventListener {

    @Override
    public boolean canHandle(Object event) {
        if(event instanceof AbstractAuthenticationFailureEvent) {
            return true;
        }
        else {
            return false;
        }
    }

    @Override
    public void handle(Object event) {
        if (event instanceof AuthenticationFailureBadCredentialsEvent) {
            // do something
        }

        if (event instanceof AuthenticationFailureCredentialsExpiredEvent) {
            // do something
        }
    }
} 
```

我之前提到的问题是 AuthenticationFailureCredentialsExpiredEvent 永远不会被触发。我已经测试了 AuthenticationFailureBadCredentialsEvent 工作正常。

这是我因凭据错误而得到的结果：（工作正常）

> org.springframework.security.authentication.event.AuthenticationFailureBadCredentialsEvent

这是我在密码过期的情况下得到的：

> ServletRequestHandledEvent: url=[/app/loginFailure] with failureCause = null

有谁知道可能出了什么问题？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:52:05.427

这是这个问题的答案，因为没有太多关于这个问题的文献。

> 您可能需要将 ProviderManager 的 ('s) eventPublisher 设置为 NullEventPublisher 以外的其他内容。没有一种简单的方法可以通过标签做到这一点，因此您需要使用标准 bean 配置创建 AuthenticationProvider 并将其注入到 ProviderManager 的标准 Spring Bean 中。
> 
> Rob Winch - 弹簧安全主管

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T21:05:42.217

如果有人遇到这个问题，只需将 spring security 升级到 3.1.2 或+，问题就解决了。

# javascript - 如何在同一页面上多次使用诸如 windows.onload 或 a.click 之类的事件侦听器？

> ID：14857805
> 
> 赞同：2
> 
> 时间：2013-02-13T16:08:50.270
> 
> 标签：javascript, event-listener, onload

我有一些外部 js 脚本，我提供给我的用户以嵌入到他们的网站上。它们单独工作正常，但如果您尝试在同一页面中附加两个，其中一个会崩溃（控制台上没有错误）。我认为问题必须与多次调用 windows.onload 有关。

下面是两个嵌入代码的样子：

## 代码 1

```
 <script type="text/javascript" src="http://example.com/widget.js"></script>
  <p><span class="punctis-social-widget"></span></p> 
```

## 代码 2

```
 <script type="text/javascript" src="http://example.com/poll.js"></script>
  <p><span class="punctis-poll-button"></span></p> 
```

poll.js 和 widget.js 只是两个简单的函数：

**poll.js**

```
window.onload = function() {
   alert('IM POLL.js');
} 
```

**小部件.js**

```
window.onload = function() {
   alert('IM WIDGET.js');
} 
```

如果您在同一页面中插入代码 1 和代码 2，则不会加载此脚本之一。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-08-17T07:40:46.190

使用**[EventTarget.addEventListener()](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener)**

您不能在同一页面上有两个 window.onload。第二个将覆盖第一个。要解决您的问题，请改用多个`addEventListener`。它将添加功能而不是替换相同的功能。

换这个就行了`window.onload=function(){}`

这样`window.addEventListener("load", function(evt) { /* do something */ })`

解释：

```
let el = document.getElementById('a'); // window in your case

el.addEventListener('click', function(evt) { /* do task 1 */ });
el.addEventListener('click', function(evt) { /* do task 2 */ });

//similarily for window
window.addEventListener("load", function(evt) { /* do task 1 */})
window.addEventListener("load", function(evt) { /* do task 2 */}) 
```

# python - 嵌入在 python 脚本中的 SQL 查询 - 错误

> ID：14857809
> 
> 赞同：0
> 
> 时间：2013-02-13T16:08:57.773
> 
> 标签：python, mysql, csv, python-2.7, mysql-python

我想要一个脚本，它遍历文件夹中的 csv 文件并将它们转储到 MySQL 数据库中。我能够将一个 csv 文件转储到其中。但是在将文件名传递给 SQL 脚本时遇到了麻烦。

这是我使用的代码

```
file_path="C:\csv-files"
files=os.listdir(file_path)
files.sort()
for n in files:

    cursor.execute(" LOAD DATA LOCAL INFILE '%s' INTO TABLE new_table FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '"' Lines terminated by '\n' IGNORE 1 LINES ",(n)) 
```

我收到以下错误

```
raise errorclass, errorvalue
ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'file1.csv'' INTO TABLE new_table FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY' at line 1") 
```

如果我直接使用文件名而不是传递它，它可以正常工作。

如果您可以在抛出的错误中看到，则 SQL 脚本中似乎存在错误。

这将是整个代码

```
import csv
import MySQLdb
import sys
import os
connection = MySQLdb.connect(host='localhost',
    user='root',
    passwd='password',
    db='some_db')

cursor = connection.cursor()

file_path="C:\csv-files"
files=os.listdir(file_path)
files.sort()
for n in files:
    print n

    cursor.execute(" LOAD DATA LOCAL INFILE %s INTO TABLE new_table FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '"' Lines terminated by '\n' IGNORE 1 LINES " %n)

connection.commit()
cursor.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:37:44.007

首先，将查询中的 '%s' 替换为 %s。MySQLdb 自动处理任何引用。

这是带有一些更正和更改的代码：

```
import MySQLdb
import os

CSV_DIR = "C:\csv-files"

connection = MySQLdb.connect(host='localhost',
                             user='root',
                             passwd='password',
                             db='some_db',
                             local_infile=1)

cursor = connection.cursor()

try:
    for filename in sorted(os.listdir(CSV_DIR)):
        cursor.execute("""LOAD DATA LOCAL INFILE %s
                          INTO TABLE new_table
                          FIELDS
                          TERMINATED BY ','
                          OPTIONALLY ENCLOSED BY '"'
                          ESCAPED BY '"'
                          LINES TERMINATED BY '\n'
                          IGNORE 1 LINES""",
                      (os.path.join(CSV_DIR, filename),))

    connection.commit()
finally:
    cursor.close() 
```

注意：我在 MySQLdb.connect 中将 local_infile 参数设置为 1 并在元组中传递文件名以执行。

为我工作。

# c# - Sharepoint Web 服务 GetListItems 视图名称

> ID：14857811
> 
> 赞同：2
> 
> 时间：2013-02-13T16:09:03.510
> 
> 标签：c#, sharepoint

我需要弄清楚我需要查询的视图名称（不是以编程方式）。我知道列表名称是“MyList”，但我还需要知道视图名称，以便可以将其作为第二个参数传递。我发现的唯一一件事是人们传递视图名称的 GUID，我如何获得视图的“友好”名称？

```
SharepointWebService.GetListItems("MyList", "MyView", 
    xmlNodeQuery, xmlNodeViewFields, "1000", null, null); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:23:15.297

您必须执行附加查询才能找到该视图的 GUID。

您可以使用 views.asmx 中的[GetViewCollection](http://msdn.microsoft.com/en-us/library/views.views.getviewcollection%28v=office.12%29.aspx)方法来获取特定列表的所有视图。返回结果具有`DisplayName`，这是您需要的纯文本名称，以及`Name`，它是 GUID。您可以在这些结果中找到所需列表的 GUID，以便在后续调用`GetListItems`.

# c# - 实体框架 SaveChanges() 不更新数据库

> ID：14857813
> 
> 赞同：11
> 
> 时间：2013-02-13T16:09:12.610
> 
> 标签：c#, entity-framework

```
var paymentAttempt = _auctionContext.PaymentAttempts.Where(o => o.Id == paymentAttemptId).SingleOrDefault();
if (paymentAttempt != null)
{
    paymentAttempt.PaymentAttemptStatusId = (int)PaymentAttemptStatus.Defunct;
    paymentAttempt.PaymentAttemptStatus = _auctionContext.PaymentAttemptStatuses.Where(pas => pas.Id == paymentAttempt.PaymentAttemptStatusId).First();

    var relevantWinningBidsTotalPrices = _auctionContext.GetWinningBidsTotalPricesForPaymentAttempt(paymentAttemptId).ToArray();

    foreach (var winningBid in relevantWinningBidsTotalPrices)
    {
        winningBid.Locked = false;
        _auctionContext.UpdateObject(winningBid);
    }
    _auctionContext.SaveChanges();
} 
```

在上面的代码之后

```
_auctionContext.SaveChanges(); 
```

被称为`winningBid`按预期更新但`paymentAttempt`不是。为什么是这样？这真的很令人沮丧。也没有错误。如果出现 EF 没有跟踪对象或类似的问题，我预计会发生故障，但没有发生此类错误。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-13T16:20:23.473

那是因为你需要将`paymentAttempt`对象传递给你的上下文，让它知道它是一个需要更新的对象。

例如，假设这`_auctionContext`是一个实例`DbContext`：

```
// any changes related to the paymentAttempt object 

_auctionContext.Entry(paymentAttempt).State = EntityState.Modified;

foreach (var winningBid in relevantWinningBidsTotalPrices)
{
   winningBid.Locked = false;
   _auctionContext.UpdateObject(winningBid);
}

_auctionContext.SaveChanges(); 
```

另一种选择是`Attach`方法：

```
_auctionContext.Attach(paymentAttempt);
_auctionContext.ObjectStateManager.ChangeObjectState(paymentAttempt, System.Data.EntityState.Modified); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-09T05:51:18.337

如果您没有`Entry`尝试添加：

```
using System.Data.Entity.Infrastructure;

using System.Data.Entity; 
```

那么你可以简单地使用：

```
_auctionContext.Entry(paymentAttempt).State = EntityState.Modified;
_auctionContext.SaveChanges(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-16T13:59:03.587

我陷入了这个问题，但遇到了不同的问题。我发现，如果您在尚未修改的对象上调用 SaveChanges()，EF 将不会更新任何内容。这是有道理的，但我需要更新数据库，以便其他用户可以看到 SaveChanges() 已执行，无论是否有任何字段已更改。要在不更改任何字段的情况下强制更新：

```
 Dim entry As DbEntityEntry = entities.Entry(myentity)
    entry.State = Entity.EntityState.Modified 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-23T16:18:55.670

我知道这已经晚了，但还有另一种解释值得一提。即使您的字段名称包含 ID 并且可能设置为自动增量，请务必确认您在表中将其声明为主键。

# c++ - Ubuntu 12.10 - 编译 C++ 程序时找不到 -ltcl

> ID：14857815
> 
> 赞同：2
> 
> 时间：2013-02-13T16:09:21.543
> 
> 标签：c++, ubuntu, compilation, makefile

我正在做一个 C++ 项目，我需要使用 libtcl。我正在运行 Ubuntu 12.10 32bits，当我尝试编译我的文件时出现问题：

```
g++ -o executable executable.o -L/usr/share/tcltk -lncurses -ltcl
/usr/bin/ld: cannot find -ltcl 
```

找到了 libncurses 但没有找到 libtcl ...您有什么想法吗？

我已经看到 /usr/lib 中存在 libtcl8.4.so.0 libtcl8.5.so.0

我正在使用的 makefile 如下所示：

```
CC = g++
CFLAGS = -g
LDFLAGS =
EXEC = executable
LIB = -L/usr/share/tcltk -lncurses -ltcl

all: executable

executable: executable.o
    $(CC) $(LDFLAGS) -o $(EXEC) executable.o $(LIB)

executable.o: executable.cpp
    $(CC) $(CFLAGS) -c executable.cpp

clean:
    rm -f executable executable.o 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-24T16:24:52.133

（在评论中回答。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

@soon 写道：

> 只需像这样创建指向您的库的符号链接`#ln -s /usr/lib/libtcl8.5.so.0 /usr/lib/libtcl.so`

# php - 几个小时后 PHP 运行脚本

> ID：14857816
> 
> 赞同：2
> 
> 时间：2013-02-13T16:09:22.323
> 
> 标签：php, asynchronous

我有一个 PHP 网站，用户可以安排要发送的消息。我可以使用类似于此的命令发送消息：

```
php sendMsg.php 249 
```

其中 number 是消息的 ID

许多人建议使用 cron 作业，但由于我不想在间隔 cron 中运行它，所以没有选择（只有一次 - 例如 3 小时后）。我的想法如下：

```
$seconds = $hours*60*60;
exec('sleep '.$seconds.'; php sendMsg.php 249'); 
```

但这不会起作用，因为它会阻止 php 进一步执行。实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:22:15.640

您说您不想使用 cron 作业，因为您只希望消息发送一次，但这是对为此类任务编写 cron 作业的方式的误解

考虑这样一种情况，您有许多用户创建许多要在不同给定时间点发送的消息。

您不想让 PHP 程序一直在您的服务器上运行，以处理这些消息中的每一条；这会浪费服务器资源，即使它们都只是在`sleep()`这段时间内运行。

相反，人们会使用 cron 作业每分钟运行一次短暂的 PHP 程序（或任何适合您的时间间隔）。

您的消息创建程序不会被编写为实际发送消息；相反，它将连同需要发送的时间一起插入到数据库中。

同时，cronjob PHP 程序会每分钟扫描一次这个数据库，看看是否有任何消息要发送但尚未发送。然后它将发送这些消息并在数据库上将它们标记为“已发送”。

这是编写这种东西的标准方式，所以人们向你推荐它并不奇怪。

这样做意味着您的系统上运行的程序永远不会超过必要的时间。两个 PHP 程序都快速完成它们的工作并退出，这意味着没有人一直在等待它们。

它也使它更加健壮。想象一下，如果您的服务器必须重新启动。如果你有一堆 PHP 程序运行几个小时等待它们发送消息的时刻，它们都会丢失。另一方面，如果他们已将消息保存到数据库，则 cron 作业会在服务器重新启动后找到它们并正确发送它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:11:29.567

将时间表放入数据库中。每分钟左右运行一次cronjob，检查数据库是否应该在这一分钟内发送消息，然后发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:12:40.157

您是否有不想使用 cron 作业的原因？这将是发送消息的最简单和最有效的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:12:51.220

我认为 cronjob 仍然是正确的方法

1.  创建一个存储要发送消息的表，其中包含发送时间的时间戳和 isSend 的标志
2.  创建一个 cronjob - 每 1 分钟启动一次 php 脚本，它发送时间戳 < 当前时间且 isSend = false 的消息

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-13T16:29:02.890

忽略 cron 的建议，如果您只想等待一段时间然后使用`at`调度程序：

```
$hours = 2;
$command = sprintf('echo "php sendMsg.php 249" | at now + %d hours', $hours);
exec($command); 
```

# eclipse - 声纳局部分析排除模式

> ID：14857818
> 
> 赞同：0
> 
> 时间：2013-02-13T16:09:28.100
> 
> 标签：eclipse, code-analysis, sonarqube

我有一个已配置的 Sonar 服务器和许多客户端通过 Eclipse Sonar 2.4 插件使用它。我使用服务器的“排除文件管理器”菜单（在配置下）配置了排除的资源。服务器确实跳过了相关资源，但是在运行本地分析时，这些模式似乎不起作用。例如，我不想检查插件激活器；在服务器上它们不是，但本地分析会检查它们。

是否有任何解决方案可以将排除模式与（来自）服务器“同步”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T17:30:55.783

此功能在 Sonar Eclipse 3.0 中可用。

[您可以在此处](http://docs.codehaus.org/display/SONAR/SonarQube+in+Eclipse)查看先决条件

# php - 带有ajax请求的CORS标头

> ID：14857823
> 
> 赞同：1
> 
> 时间：2013-02-13T16:09:35.917
> 
> 标签：php, ajax, apache, cors

我从 5 天开始尝试正确配置 CORS 以解决错误：

所以我尝试添加：

```
header('Access-Control-Allow-Origin: *'); 
```

在我的网络服务上（在同一台服务器上，但域名不同），我收到了这个错误：

```
Request header field Authorization is not allowed by Access-Control-Allow-Headers 
```

然后我尝试添加：

```
<IfModule mod_headers.c>
   Header set Access-Control-Allow-Origin "*"
 </IfModule> 
```

到我创建的 .htaccess 文件。但还是不行。

任何想法 ？提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:19:07.793

正如错误消息所暗示的那样，您必须在响应中包含一个 Access-Control-Allow-Headers 标头以及正确的可接受标头名称。听起来您不知道如何正确处理 CORS 请求。请阅读[MDN 上的这个文档](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)，它解释了如何处理 CORS 请求。这将回答你所有的问题。

# list - 带有委托构造函数的构造函数初始化列表执行顺序

> ID：14857825
> 
> 赞同：5
> 
> 时间：2013-02-13T16:09:38.537
> 
> 标签：list, constructor, initialization

我有一个棘手的 C++ 问题：当您有一个带有委托构造函数的构造函数初始化列表时，列表执行顺序是什么？

这里存在两个相互冲突的标准规则：
1.) 构造函数初始化列表不是按列表顺序执行，而是按项目的声明顺序执行。
2.) 构造函数初始化列表中的委托构造函数总是在“母构造函数”执行之前被调用。

哪条规则更胜一筹？（因为构造函数也是类项）为什么这很重要：假设委托的构造函数重新初始化已经由“母构造函数”初始化的项，反之亦然。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:14:52.473

§12.6.2/6 说

> 如果一个*mem-initializer-id*指定了构造函数的类，它应该是唯一的*mem-initializer* ... 一旦目标构造函数返回，委托构造函数的主体就被执行。

所以没有冲突，因为在委托构造函数之前你不能初始化任何东西。委托构造函数只需调用该构造函数，运行目标构造函数的初始化程序列表，运行目标构造函数，然后运行主体构造函数。

# php - 其他变量中的 Python 变量

> ID：14857827
> 
> 赞同：0
> 
> 时间：2013-02-13T16:09:41.233
> 
> 标签：php, python, mysql, variables

我是 python 的新手，想要做一个 MySQL 选择。

我想从 MySQL 中选择并向查询中添加一个变量，如下所示：

```
date = now.strftime("%Y-%m-%d)
sql = "SELECT * FROM table WHERE date='%s'" % date 
```

（这个offcourse，不起作用）我习惯了Php所以这对我来说是一种新的，你可以看到:)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:14:06.490

```
import time
now = time.localtime()
date = time.strftime("%Y-%m-%d")
sql = "SELECT * FROM table WHERE date='%s'" % date 
```

我认为这个片段可以满足您的要求吗？

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:26:00.320

也许这可以满足您的需求...

```
date = now.strftime("%Y-%m-%d)
sql = "SELECT * FROM table WHERE date= '%s' "
sql = sql % (date)
cursor.execute(sql)
results = cursor.fetchall() 
```

# iis - 限制指向同一文件夹路径的 IIS 虚拟目录

> ID：14857831
> 
> 赞同：2
> 
> 时间：2013-02-13T16:10:05.557
> 
> 标签：iis

我有一个用于几个不同目的的 asp.net 项目。我们的地址通过不同的路径（**use1.company.com**和**use2.company.com**）访问相同的虚拟目录。我不想破坏项目，因为它们使用的类似功能在两个地方似乎是多余的。尽管如此，**use1.company.com** /default.aspx和**use2.company.com/default.aspx**都是相同的。我想让它无法访问**use2.company.aspx/default.aspx**。有没有办法从**应用程序池/虚拟目录设置**中做到这一点，还是我只希望外部用户不要输入**/default.aspx**？

我知道我可以将默认文档设置为**likesurvey.aspx**（第二个 url 的用途），但这并不妨碍一些精明的用户输入**default.aspx**来查看它的作用。这里的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T07:12:17.550

由于它们指向同一个 .aspx 文件，您是否可以不在文件开头包含 if 语句来获取 URL，如果它包含 use2 则返回？

# android - 如何从 HttpResponse 获取文件大小

> ID：14857833
> 
> 赞同：1
> 
> 时间：2013-02-13T16:10:23.073
> 
> 标签：android, http, post, progressdialog

从服务器下载文件时我需要显示进度条，但我不知道如何获取文件大小。我使用这样的 POST 方法

```
 HttpPost httppost = new HttpPost(url);
        Inputstream toDown = null;
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("p1", p1));
        nameValuePairs.add(new BasicNameValuePair("p2", p2));
        nameValuePairs.add(new BasicNameValuePair("p3", p3));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        //Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

        if(response.getStatusLine().getStatusCode()!=200){
            toDown = null;
        }

        else{
            toDown = response.getEntity().getContent();
        } 
```

但我不知道如何处理这些信息来获取文件大小

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-08-26T14:03:30.307

并非所有服务器都支持 HEAD 标头。以下 powershell 代码在不下载文件本身的情况下获取文件大小：

```
$param1 = 0
$param2 = 0
$param3 = "https://URI"

# Add the necessary .NET assembly
Add-Type -AssemblyName System.Net.Http

# Create the HttpClient object
$client = New-Object -TypeName System.Net.Http.Httpclient
$client.DefaultRequestHeaders.Range = New-Object -TypeName System.Net.Http.Headers.RangeHeaderValue($param1, $param2)

$HttpMethod = New-Object -TypeName System.Net.Http.HttpMethod("get")
$HttpRequestMessage = New-Object -TypeName System.Net.Http.HttpRequestMessage($HttpMethod, $param3) 
$HttpResponseMessage = $client.SendAsync($HttpRequestMessage)
$HttpResponseMessage.wait();

$size = $HttpResponseMessage.result.content.headers.contentrange.length
echo $size 
```

在 Powershell 5.1.17134.1、Win 10 上测试

# r - 如何以向量化的方式将函数应用于数据的子集

> ID：14857838
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:10:37.837
> 
> 标签：r

**问题：**

如何以矢量化的方式将函数应用于数据的子集。

**例子：**

对于下面的数据框：

```
x=c(1,2,1,2,1,2)
y=c(3,4,5,4,3,2)
df=data.frame(x,y) 
```

我想对每个 x 值的所有 y 值应用一个函数（即 min()），并将其收集在一个向量中。

基本上，我想要一个矢量化版本：

```
nb = max(x);
V = rep(0.0, nb)
for(i in 1:nb){
    v = df [ x == i,  ]$y;
    V[i] <- min(v);
}

# basically here:
# V[1] = min( df$y for x=1)
# V[2] = min( df$y for x=2) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:14:05.250

该功能`tapply`专为此类问题而设计：

```
with(df,tapply(y,x,FUN=min))
#1 2 
#3 2 
```

如果要将结果添加到数据框中，可以使用以下功能`ave`：

```
df$group.min <- with(df,ave(y,x,FUN=min))
#   x y group.min
# 1 1 3         3
# 2 2 4         2
# 3 1 5         3
# 4 2 4         2
# 5 1 3         3
# 6 2 2         2 
```

# java - 客户端服务器android上的数据库

> ID：14857843
> 
> 赞同：1
> 
> 时间：2013-02-13T16:10:40.830
> 
> 标签：java, android, performance, client-server

我正在 Android 中开发一个简单的客户端服务器应用程序，尽管我有疑问。我会将应用程序中的数据保存在服务器上，应用程序需要访问它们。我想知道管理数据的最佳方法是什么；使用两个数据库，一个在服务器中，另一个在智能手机中（需要同步），或者只有一个在服务器上（所有请求都必须转到服务器）？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:21:08.467

好吧，坦率地说，这*取决于*您正在处理的数据类型。

如果您的数据是完全动态的并且在很短的时间间隔内变化，那么您应该始终查询服务器。

另一方面，如果您的数据是相对静态的并且在较长时间内保持不变，那么将数据缓存在本地数据库中而不是从服务器一次又一次地查询它是明智的。

您必须记住的另一件事是数据的大小。如果数据确实非常大，并且您将其存储在本地数据库中，那么您需要在一定时间间隔后清除旧数据，以确保您的应用程序不会占用您的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:21:38.423

这取决于您的需求。在应用程序中管理非常大的数据库不是合适的方式（因为应用程序会在一段时间后变得非常大）。您应该将所有数据存储在服务器上，并在应用程序中使用 SQLite 仅用于缓存，但不要缓存所有内容，只缓存不经常更改的数据。

# java - 创建重载构造函数时，是否需要默认构造函数？

> ID：14857848
> 
> 赞同：0
> 
> 时间：2013-02-13T16:10:56.580
> 
> 标签：java

现在刚刚了解它们，并且对 java 非常陌生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T16:12:39.130

不。如果定义了任何构造函数，则没有默认构造函数（我假设您的意思是无参数构造函数），除非您明确定义它。如果没有定义构造函数，则默认构造函数是隐含的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:14:15.890

如果你为你的对象提供了一个构造函数，那么它将被使用。如果您不调用它，java 将不会调用无参数构造函数，因此您必须自己提供它。

我认为[这里](http://docs.oracle.com/javase/tutorial/java/javaOO/objectcreation.html)的官方 java 文档提供了一些易于理解的示例。

# html - django：虽然 html 改变了，但一次又一次地显示相同的视图

> ID：14857853
> 
> 赞同：0
> 
> 时间：2013-02-13T16:11:20.937
> 
> 标签：html, django, templates

我有一个简单的 index.html 文件，其代码如下：

```
<html>
<head>
<link href='http://fonts.googleapis.com/css?family=Fruktur' rel='stylesheet' type='text/css'>
<style type="text/css">
.container {
    background-color: #022e3a;
    font-family: Verdana, Geneva, sans-serif;
    font-size: 16px;
    font-style: normal;
    color: #ffffff;
}
#header {
    font-family: 'Fruktur', cursive;
    font-size: 36px;
    color: #ffffff;
    background-color: #065e76;
}
</style>
<head>
<body class="container">
<div id="header">
<p>DaamJani.com</p>
</div>
<div>
<form method="GET">
    Ask for price(e.g.Onion)
<input type="text" name="search">
    <input type="submit" value="Submit" />
</form>
</div>
<br/>
<div>No. of elements : {{ prices|length }}</div>
<div>
<table border='1'>
        <tr>
            <td>Item</td><td>Price</td><td>Per Amount</td><td>Where</td>
        </tr>
        {% for price in prices %}

            <tr>
                <td>{{price.name}}</td><td>{{price.price}}</td><td>{{price.quantity}}</td><td>{{price.source}}</td>
            </tr>
        {% endfor %}

</table>
</div>

</body>
</html> 
```

虽然我最近添加了这一行：`<div>No. of elements : {{ prices|length }}</div>`一旦我运行服务器，应用程序似乎并没有改变。我尝试清除缓存并重新加载它。我尝试删除包含表格的整个 div，但它显示的视图与以前相同。这有什么问题？

# python - 如何将我的数据写入 json 文件？

> ID：14857856
> 
> 赞同：2
> 
> 时间：2013-02-13T16:11:29.037
> 
> 标签：python, django, unit-testing, testcase

如何将我的数据写入 json 文件？这是我的尝试：

```
from django.test import TestCase
from django_dynamic_fixture import G
import content.factories
from django.core import serializers
from content.models import UserProfile, Delivery
from django.contrib.auth.models import User

class DeliveryTest(TestCase):
    def test_sample_data(self):
        for i in range(0,10):
            user = content.factories.UserFactory.create()
            print user
            for j in range(0, 50):
                delivery = content.factories.DeliveryFactory.create(user=user)
                print delivery

                with open("file.json", "w") as out:
                    data = serializers.serialize("json", User.objects.all() ) 

                with open("file.json", "w") as out:
                    data2 = serializers.serialize("json", Delivery.objects.all() ) 
```

输出（打印）：[http ://dpaste.com/hold/923339/](http://dpaste.com/hold/923339/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T16:14:48.197

您实际上并没有编写数据，只是转换为 JSON。调用`.write()`打开的文件：

```
with open("file.json", "w") as out:
    data = serializers.serialize("json", User.objects.all())
    out.write(data)
    data2 = serializers.serialize("json", Delivery.objects.all() )
    out.write(data) 
```

只开放`file.json` *一次*；每次打开它以使用该`'w'`模式写入时，它都会首先被擦除。

或者，[获取对序列化程序的引用](https://docs.djangoproject.com/en/stable/topics/serialization/#django.core.serializers.get_serializer)并告诉它直接写入打开的文件：

```
with open("file.json", "w") as out:
    json_serializer = serializers.get_serializer('json')()
    json_serializer.serialize(User.objects.all(), stream=out)
    json_serializer.serialize(Delivery.objects.all(), stream=out) 
```

哪个更有效率。

# c - 使用 GCC 编译 C 程序时出现 GMP 库错误：“ld: symbol(s) not found for architecture x86_64”

> ID：14857859
> 
> 赞同：2
> 
> 时间：2013-02-13T16:11:36.040
> 
> 标签：c, macos, gcc, gmp

我正在尝试编译一个使用 GMP 库中的许多函数的 C 程序 (gfp2.c)。我使用正常的配置、制作和安装顺序下载并安装了 GMP 库。我还在安装前运行了 make check 并且没有错误。

我正在使用 GMP 5.1.1、GCC 4.2.1 和 MAC OS 10.8.2。

我首先键入`gcc gfp2.c -lgmp`链接库，然后尝试`gcc gfp2.c`在终端上获取以下输出：

```
1407-wn-172-21-30-223:pqcrypto11_scripts dfish$ gcc gfp2.c -lgmp 

v1407-wn-172-21-30-223:pqcrypto11_scripts dfish$ gcc gfp2.c

Undefined symbols for architecture x86_64:

  "___gmp_printf", referenced from:
      _print_GF in ccrft0vq.o

  "___gmp_randinit_default", referenced from:
      _setup_GF in ccrft0vq.o

  "___gmp_sprintf", referenced from:
      _get_GF in ccrft0vq.o

  "___gmpz_add", referenced from:
      _add_GF in ccrft0vq.o
      _mul_GF in ccrft0vq.o
      _sqr_GF in ccrft0vq.o

  "___gmpz_add_ui", referenced from:
      _add_GF_ui in ccrft0vq.o

  "___gmpz_addmul", referenced from:
      _inv_GF in ccrft0vq.o

  "___gmpz_clear", referenced from:
      _clear_GF in ccrft0vq.o
      _setup_GF in ccrft0vq.o
      _free_GF in ccrft0vq.o

  "___gmpz_cmp", referenced from:
      _cmp_GF in ccrft0vq.o

  "___gmpz_cmp_ui", referenced from:
      _is_one_GF in ccrft0vq.o

  "___gmpz_fdiv_ui", referenced from:
      _setup_GF in ccrft0vq.o

  "___gmpz_init", referenced from:
      _init_GF in ccrft0vq.o
      _setup_GF in ccrft0vq.o

  "___gmpz_init_set_str", referenced from:
      _setup_GF in ccrft0vq.o

  "___gmpz_init_set_ui", referenced from:
      _setup_GF in ccrft0vq.o

  "___gmpz_invert", referenced from:
      _inv_GF in ccrft0vq.o
      _a24 in ccrft0vq.o

  "___gmpz_mod", referenced from:
      _add_GF in ccrft0vq.o
      _add_GF_ui in ccrft0vq.o
      _sub_GF in ccrft0vq.o
      _sub_GF_ui in ccrft0vq.o
      _scalar_GF in ccrft0vq.o
      _scalar_GF_si in ccrft0vq.o
      _mul_GF in ccrft0vq.o
      ...

  "___gmpz_mul", referenced from:
      _scalar_GF in ccrft0vq.o
      _mul_GF in ccrft0vq.o
      _sqr_GF in ccrft0vq.o
      _inv_GF in ccrft0vq.o

  "___gmpz_mul_2exp", referenced from:
      _setup_GF in ccrft0vq.o

  "___gmpz_mul_si", referenced from:
      _scalar_GF_si in ccrft0vq.o

  "___gmpz_neg", referenced from:
      _inv_GF in ccrft0vq.o

  "___gmpz_pow_ui", referenced from:
      _setup_GF in ccrft0vq.o

  "___gmpz_set", referenced from:
      _copy_GF in ccrft0vq.o
      _add_GF_ui in ccrft0vq.o
      _sub_GF_ui in ccrft0vq.o
      _neg_GF in ccrft0vq.o

  "___gmpz_set_str", referenced from:
      _set_GF in ccrft0vq.o

  "___gmpz_set_ui", referenced from:
      _shamir in ccrft0vq.o
      _a24 in ccrft0vq.o

  "___gmpz_sizeinbase", referenced from:
      _mont_3ladder in ccrft0vq.o
      _shamir in ccrft0vq.o

  "___gmpz_sub", referenced from:
      _sub_GF in ccrft0vq.o
      _neg_GF in ccrft0vq.o
      _mul_GF in ccrft0vq.o
      _sqr_GF in ccrft0vq.o

  "___gmpz_sub_ui", referenced from:
      _setup_GF in ccrft0vq.o
      _sub_GF_ui in ccrft0vq.o

  "___gmpz_tstbit", referenced from:
      _mont_3ladder in ccrft0vq.o
      _shamir in ccrft0vq.o

  "___gmpz_urandomm", referenced from:
      _random_GF in ccrft0vq.o

ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

我对 C 编程和使用库等很陌生，真的不知道我在做什么，所以任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:16:56.870

您需要在 GMP 库中链接：

```
gcc gfp2.c -lgmp 
```

（目前尚不清楚为什么你最初让它工作，然后在没有库的情况下重新运行）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:20:24.690

Your first attempt has already done the compilation and the linking. You don't need to do the second step. If you check your directory you'll find a file called a.out that is the executable you need.

# javascript - Javascript 和 举止怪异

> ID：14857860
> 
> 赞同：0
> 
> 时间：2013-02-13T16:11:39.067
> 
> 标签：javascript, jsf-2, google-maps-api-3, primefaces

我有一个 js 函数`codeAddress()`，它处理来自 and 的数据并`address`更新其值。和 的数据被传递给后备 bean，但 setter 方法似乎被调用了一个延迟的请求。末尾的 显示正确的新数据。 什么时候一切正常，支持 bean setter 方法被调用，它们应该没有任何延迟。 我不知道这里可能出了什么问题。`fullAddress``validField`
`fullAddress``validField``<p:ajax>`
`alert()``codeAddress`
`address``onchange="test()"`

我的jsf代码：

```
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
<h:head>
        <script src="https://maps.googleapis.com/maps/api/js?v=3&amp;sensor=false"></script>
</h:head>

<h:body>
    <h:outputScript name="jsf.js" library="javax.faces" target="head"/>
    <h:outputScript library="js" name="bugMaps.js" />
    <body onload="initialize()" />
    <h:form id="addressForm">
        <p:inputText id="address" onchange="codeAddress()">
            <p:ajax process="fullAddress validField"/>
        </p:inputText>
        <p:message id="addressValidate" for=":addressForm:validField"/>
        <p:commandButton value="submit" />
        <p:inputText id="fullAddress" value="#{addressBean.fullAddress}" />
        <p:inputText id="validField" value="#{addressBean.valid}" />
    </h:form>

</h:body>
</html> 
```

我的 JS：

```
var geocoder;
var map;
var valid = false;
var fullAddress = "none";

function initialize() {
    geocoder = new google.maps.Geocoder();
}

function test(){
    fullAddress = Math.random();
    document.getElementById('addressForm:fullAddress').value = fullAddress;
}

function codeAddress() {
    var address = (document.getElementById('addressForm:address').value + ", Germany");
    geocoder.geocode({'address' : address},function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var latLong = results[0].geometry.location;
            var latitude = results[0].geometry.location.lat();
            var longitude = results[0].geometry.location.lng();
            var country, postal_code, locality, street_number, route;
            for (i = 0; i < results[0].address_components.length; ++i) {
                var component = results[0].address_components[i];
                if (!locality && component.types.indexOf("locality") > -1)
                    locality = component.long_name;
                else if (!postal_code && component.types.indexOf("postal_code") > -1)
                    postal_code = component.long_name;
                else if (!country && component.types.indexOf("country") > -1)
                    country = component.long_name;
                else if (!street_number && component.types.indexOf("street_number") > -1)
                    street_number = component.long_name;
                else if (!route && component.types.indexOf("route") > -1)
                    route = component.long_name;
            }
            if (typeof latLong != "undefined"
                && typeof latitude != "undefined"
                && typeof longitude != "undefined"
                && typeof route != "undefined"
                && typeof street_number != "undefined"
                && typeof postal_code != "undefined"
                && typeof locality != "undefined"
                && typeof country != "undefined"){
                valid = true;
                fullAddress = results[0].formatted_address;
            }
            else{
                valid=false;
                fullAddress="none";
            };
        }
        else{

            valid=false;
            fullAddress="none";
        }
        document.getElementById('addressForm:fullAddress').value = fullAddress;
        document.getElementById('addressForm:validField').value = valid;
        alert(fullAddress + valid);
    });
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:42:33.393

这不是一个重复的问题。
第一个错误是`<p:ajax>`用于提交将由 JS 更改的数据，因为在脚本仍在运行时已经准备好 ajax 请求。第二个错误是使用 non-cross-browser-compatible `jsf.ajax.request`。现在我只是删除了`<p:ajax>`jQuery 并使用了一个解决方案。这个函数只是从地理编码器回调函数中调用的：

```
function jsfSubmit(){
    document.getElementById('addressForm:fullAddress').value = fullAddress;
    document.getElementById('addressForm:validField').value = valid;
    $.ajax({type:'POST', data:$('#addressForm').serialize(), success: function(response) {
        if(valid){
            var destPage = 'nextPage.xhtml';
            window.location = destPage;
        }
    }});
}; 
```

# list - 悬停在下拉菜单上

> ID：14857865
> 
> 赞同：0
> 
> 时间：2013-02-13T16:11:51.637
> 
> 标签：list, drop-down-menu, hover, nav

[http://www.funky7inc.com/product/detroit-police](http://www.funky7inc.com/product/detroit-police)

如果您将鼠标悬停在下拉菜单位于“底特律服装”的区域上，则列表会弹出，而不是仅在您将鼠标悬停在导航上时出现。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:24:54.750

当然，你只改变它的不透明度`<ul class="sub-menu">`......所以它实际上总是在那里，只有 100% 透明......但你仍然可以将鼠标悬停在它上面，这会将不透明度改回完全可见。

我不知道你是如何改变这个的（CSS：Javascript的悬停或其他东西，我试过看，但你已经缩小了CSS）但你可以通过不改变不透明度而是改变显示来解决这个问题：显示：无所以它实际上已经消失了，或者使用 javascript $(".sub-menu").hide() 或 .FadeIn()/fadeOut() 或类似的东西......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:25:20.947

这是因为您正在更改下拉列表的不透明度。**Opacity:0**仍然注册鼠标悬停事件。

而是使用**可见性**属性或**display:none**

当您使用可见性或 display:none 隐藏下拉列表时，下拉列表不会注册鼠标悬停，因此该列表不会显示，直到时间悬停在导航栏上。

希望这可以帮助。

# c# - PeerFinder.Start()

> ID：14857866
> 
> 赞同：0
> 
> 时间：2013-02-13T16:11:51.923
> 
> 标签：c#, networking, bluetooth, windows-phone-8

`PeerFinder.Start()`当我尝试通过蓝牙连接到应用程序到应用程序场景时，我正在研究 WP8 上的工作原理。任何人都知道我记录和解码设备发出的蓝牙流量的任何方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:58:03.043

没有内置方法可以在 WP8 设备上记录蓝牙流​​量。我知道这是 Android 上的一个选项，但 WP8 不支持它。我不明白为什么您需要为电话到电话的通信进行蓝牙分析。如果您尝试进行电话到设备的通信，则需要设备预期的数据包的通信协议规范。

# ios - 如何知道 iOS 设备是否在后台进程中休眠

> ID：14857867
> 
> 赞同：2
> 
> 时间：2013-02-13T16:11:52.513
> 
> 标签：ios, background, state, sleep

我有一个在后台运行的应用程序，我需要知道设备是否正在休眠以启动一个 sincronisation 过程，但我没有找到有关此的信息。

有谁知道它是否可行以及如何实现？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:16:25.737

您无法知道设备是否处于睡眠状态，因为您无法控制操作系统。

否则，您可以使用 App Delegate 方法：

```
- (void)applicationWillResignActive:(UIApplication *)application
{
    //your code goes here
} 
```

如果您想等到您的应用程序进入后台

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:21:31.003

我相信你不能使用公共 API 来做到这一点。您唯一可以检查您的应用程序是处于活动状态还是在后台（使用 AppDelegate 回调）。正如 Luke 在评论中指出的那样，检查设备是否“入睡”并不是 iOS 的最佳设计实践。

有一些私有 API 可以做你想做的事，你可以看看以下问题：

[有没有办法检查 iOS 设备是否被锁定/解锁？](https://stackoverflow.com/questions/14229955/is-there-a-way-to-check-if-the-ios-device-is-locked-unlocked)

[从 iOS 服务检测屏幕开/关](https://stackoverflow.com/questions/14191980/detect-screen-on-off-from-ios-service)

但是，您应该知道，在这种情况下，您的应用程序不会被 AppStore 接受。

# vms - 在 dcl 脚本中隐藏错误消息

> ID：14857868
> 
> 赞同：2
> 
> 时间：2013-02-13T16:11:56.303
> 
> 标签：vms, dcl

我有一个正在运行的测试脚本会产生一些错误，如下所示，我预计这些错误。无论如何我可以阻止它们显示在屏幕上吗？我用

```
$ write sys$output 
```

显示是否存在预期错误。

我试着用

```
$ DEFINE SYS$ERROR ERROR.LOG 
```

但这随后将我的整个错误输出日志更改为此，如果这是处理它的正确方法，我可以在脚本末尾以某种方式取消设置吗？

[错误示例]

```
%DCL-E-OPENIN, error opening TEST$DISK:[AAA]NOTTHERE.TXT; as input
-RMS-E-FNF, file not found
%DCL-E-OPENIN, error opening TEST$DISK:[AAA]NOTTHERE.TXT; as input
-RMS-E-FNF, file not found
%DCL-W-UNDFIL, file has not been opened by DCL - check logical name 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:07:40.440

DEFINE/USER 创建一个在下一个图像退出时消失的逻辑名称。因此，如果您在命令之前使用它只是为了保护该命令，那么很好。否则我更喜欢 SET MESSAGE 来控制输出。

当然，你还想在命令成功或预期错误后获取 $STATUS 并验证它，报告任何意外错误。

更好的是......如果您预计会发生某些错误情况，那么为什么不测试它们呢？例如：

```
$ file = F$SEARCH("TEST$DISK:[AAA]NOTTHERE.TXT")
$ IF file.NES."" THEN TYPE 'file' 
```

干杯，海因

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:51:50.653

抑制脚本内的错误消息。试试这个命令

```
 $ DEFINE/USER SYS$ERROR NL: 
```

`NL:`是一个空设备，因此您不会在终端上看到任何错误消息。

祝你好运

# android - 从 Android 画布上的相交线中剪切区域

> ID：14857869
> 
> 赞同：0
> 
> 时间：2013-02-13T16:12:00.970
> 
> 标签：android, android-layout

我有一个 Android 画布，我在上面画了一系列线条来代表一个六边形游戏板。六边形由几条相交的内部线细分。

我试图弄清楚如何从主六边形的中心“切出”一个较小的六边形，类似于这张图片：[http ://www.dcc.fc.up.pt/~pbv/stuff/hstzaar/ hstzaar.png](http://www.dcc.fc.up.pt/~pbv/stuff/hstzaar/hstzaar.png)。

是否可以将多边形定位在相交线上并采用形状的“差异”，以便将下面的线修改为在多边形边缘处结束？

简单地在板中心顶部放置一个不透明的多边形可能就足够了，但我很好奇是否可以实际修改底层线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T04:25:59.540

由于只有 3 条内部线穿过六边形的中心，因此实际上将它们中的每条线分成两段而不是稍后尝试将它们剪掉更容易。

我仍然很想知道我最初的问题是否可行，但我现在解决了这个问题。

# jquery - Jquery Countdown 行为异常

> ID：14857874
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:12:18.820
> 
> 标签：jquery, timer, countdown

请帮我。我试图弄清楚为什么这个倒计时不起作用......

我正在使用这个网站上的这个 Jquery 脚本 [http://keith-wood.name/countdown.html](http://keith-wood.name/countdown.html)

我正在使用其回调选项卡中的第三个示例

我的代码：

```
<html>
    <head>
    <title>jQuery Countdown</title>
    <link rel="nofollow" type="text/css" href="https://justpaste.it/redirect/1ytp/http://keith-wood.name/css/jquery.countdown.css">

    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" src="http://keith-wood.name/js/jquery.countdown.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {

        $('#expireMessage').countdown({
            var shortly

            until: shortly,
            expiryText: '<div class="over">It\'s all over</div>'});

             $('#expireMessageStart').click(function() {
             alert("hi");  
             shortly = new Date();
             shortly.setSeconds(shortly.getSeconds() + 5.5);
             $('#expireMessage').countdown('option', {until: shortly});
          });
        });
    </script>
    </head>
    <body>
        <div id="expireMessage"></div>
        <span id="expireMessage" class="countdown"></span>&nbsp;
        <button type="button" id="expireMessageStart">Start</button>
    </body>
</html> 
```

谁能帮我运行这个倒计时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:35:25.470

您指向 JQuery 的链接是错误的。使用[http://code.jquery.com/jquery-latest.js](http://code.jquery.com/jquery-latest.js)它为您提供最新版本...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:37:52.800

除了如上所述修复您的 jQuery 路径外，在调用倒计时函数之前不久声明可能会解决您的问题

> $(document).ready(function() { var 很快; ... }

# c - 如何在 C 预处理器中使用复杂的控制流、算术或函数原语？

> ID：14857875
> 
> 赞同：2
> 
> 时间：2013-02-13T16:12:20.873
> 
> 标签：c, c-preprocessor

我希望能够使用更成熟的语言编写预处理器宏。理想情况下，这样的语言将包括以下功能：

*   布尔和自然算术和比较
*   基于比较的分支
*   列表表示
*   递归
*   变量绑定
*   作为一等值和高阶函数的函数
*   部分函数应用和柯里化
*   功能原语，例如`map`和`fold`
*   常见代码生成任务的有用函数/结构

这可以在 C 预处理器中实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:12:20.873

令人难以置信的是，答案是肯定的！[Order](http://rosettacode.org/wiki/Order)仅头文件库提供了一组在 C 预处理器中实现函数式语言的宏。它包括所有指定的功能等等。只要您的 C 预处理器几乎完全符合 C99，您就可以使用它。GNU CPP（在 GCC 和 G++ 中使用）是兼容的，Boost Wave 预处理器也是如此。Order 自 2004 年以来一直存在。虽然它不再维护，但它的功能非常齐全，如果没有完整记录的话。

下面是一个使用 Order 的简单示例：

```
#define AVERAGE(...) ((ORDER_PP( \
    8seq_for_each_with_delimiter( \
    8put, \
    8emit(8quote(+)), \
    8tuple_to_seq(8quote((__VA_ARGS__)))))) / \
    ORDER_PP(8to_lit(8tuple_size(8quote((__VA_ARGS__)))))) 
```

宏`AVERAGE`扩展为一个表达式，表示所提供参数的平均值。`AVERAGE(a, b, c)`（例如）扩展为`((a + b + c) / 3)`. 这是一个非常简单的示例，它没有使用 Order 的所有功能。

另一个简单的例子，展示了预编译算术的使用（使用任意精度的自然数表示），作为第一类值的函数（参见使用`8plus`）和变量绑定，是一个用于在预处理器中计算（整数算术）平均值的宏：

```
#define AVERAGE_LITERAL(...) ORDER_PP(\
    8let((8A, 8quote((__VA_ARGS__))), \
    8to_lit(8quotient( \
    8seq_fold(8plus, 0, 8tuple_to_seq(8A)), \
    8tuple_size(8A))))) 
```

`AVERAGE_LITERAL(5, 6, 8, 9)`扩展到`7`.

我只谈到了其中的一些功能。随附的文档和教程中提供了更多实用示例，包括展示 Order 如何帮助消除几乎所有繁琐的代码重复的示例。

Order 非常强大，对 C++ 程序员来说还是很重要的——模板和内联只能解决一些问题。订单解决了大多数其他问题。我能找到的唯一固有限制是无法以替换或连接以外的任何方式操作字符串文字或操作标记，因为这是由 C 预处理器强加的。

# c# - 具有不同客户端的 XSD 命名空间

> ID：14857878
> 
> 赞同：1
> 
> 时间：2013-02-13T16:12:37.367
> 
> 标签：c#, asp.net, xsd

我使用 C# 在 ASP.NET 中开发了一个 Web 服务。它的一种 Web 方法返回使用 xsd 命令从 xsd 模式文件创建的复杂类型。

许多客户端设备可以毫无问题地使用此 Web 服务。视窗手机，PC。所有都是.Net 应用程序。

现在一个 VB6 客户端需要使用 SOAP Toolkit 3.0 来使用这个 Web 服务，他遇到的问题可能是由于序列化的 xml 数据中的不同命名空间。

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:xsd="http://www.w3.org/2001/XMLSchema"
   xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <GetProductionDataMachineryResponse xmlns="http://myFactory.it/">
         <GetProductionDataMachineryResult xmlns="http://tempuri.org/XMLSchemaData.xsd">
            <ResultRequest>Ok or No Data Found </ResultRequest>
            ..... 
         </GetProductionDataMachineryResult>
      </GetProductionDataMachineryResponse>
   </soap:Body>
</soap:Envelope> 
```

如果我删除 .cs 文件中的以下注释

```
[System.Xml.Serialization.XmlTypeAttribute(Namespace="http://tempuri.org/XMLSchemaData.xsd")]
[System.Xml.Serialization.XmlRootAttribute(Namespace="http://tempuri.org/XMLSchemaData.xsd", IsNullable=false)] 
```

VB6 客户端工作正常。但其他客户端需要更新网络参考。还有 80 多个其他客户，因此这不是一个有吸引力的选择。

有没有办法让它在不破坏旧客户的情况下与新客户一起工作？

# ruby-on-rails - 在表单（验证）错误时在不同的控制器中呈现视图，同时携带验证消息

> ID：14857886
> 
> 赞同：1
> 
> 时间：2013-02-13T16:12:47.067
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的第一个 Rails 应用程序有以下问题

首先，我使用 Scaffolding 生成一个 Patient 实体。但是，我希望`Patient`添加表单在我的主页中可见，它由控制器`PagesController`及其操作控制`Home`。`Patient`我只是在我的主页中以添加的形式呈现了部分视图。

在我提交表单后，如果添加成功，它将正常工作。但是，如果验证失败，它会将我带到患者/新用户（而不是我的主页），显示表单错误。发生这种情况是因为 PatientController 中的这段代码

```
if @patient.save
    format.html { redirect_to @patient, notice: 'Patient was successfully created.' }
    format.json { render json: @patient, status: :created, location: @patient }
  else
    format.html { render action "new" }
    format.json { render json: @patient.errors, status: :unprocessable_entity } 
```

而不是这个，我希望在出现错误的情况下，它应该让我回到显示错误的主页（提交表单的地方）。我尝试执行以下操作：

```
format.html { render :controller => "pages", :action => "home" } 
```

但我收到了这个错误

```
Missing template patients/home, application/home with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}. Searched in: * "/Users/xhorxhi91/Sites/dentarails/app/views" 
```

我也试过这个：

```
format.html { render 'pages/home' } 
```

这仅调用视图，而不是方法`Home`，因此不会重新创建在该方法中创建的任何对象。也不会携带错误。我知道我可以从我的方法中重新创建对象，但我知道这是不好的做法。

另外我知道我不能使用redirect_to 方法，因为不会携带错误消息。

有什么建议么？我是 Ruby 新手，所以我也不确定我的架构是否正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T19:59:37.887

如果您的 routes.rb 显示

`match 'pages/home' => "pages#home", as: "pages_home"`

那么你可以写

`format.html { render pages_home_path }`

# asp.net - 两个如何检测到相同的用户从不同的网络进行身份验证？

> ID：14857891
> 
> 赞同：0
> 
> 时间：2013-02-13T16:13:15.370
> 
> 标签：asp.net

我正在使用 ASP.NET 表单身份验证，是否可以检测到两个相同的登录名登录？

我希望这可以防止同一帐户上的两个用户修改相同内容的情况。所以我想通知用户另一个具有相同登录名的用户已经在系统中。

如果这有帮助，我还使用 .net 的 MemberShip 模型进行身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:37:50.963

看看[这个资源](http://www.eggheadcafe.com/articles/20030418.asp)。这种方法使用缓存来查看用户是否在另一台机器上发出了登录请求。我也看到数据库也被使用过。主要目标是检查用户是否完成了登录过程，如果有，则阻止第二次登录尝试。

# c# - 网格内的树视图和比例大小

> ID：14857898
> 
> 赞同：1
> 
> 时间：2013-02-13T16:13:43.130
> 
> 标签：c#, wpf

我在一个使用网格的 WPF 应用程序中工作，网格内部有几个 TreeView：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <TextBlock Text="Header"/>
    <TreeView x:Name="Tree1"" Grid.Row="2"/>
    <TextBlock Text="SecondHeader" Grid.Row="2"/>
    <TreeView x:Name="Tree2" Grid.Row="3"/>
</Grid> 
```

使用此设置，标题的大小将与 Grid 的大小成比例。

当我有一棵较小的树时会出现问题，并且两棵树之间有一个空白区域，如果第一棵树是空的，它也会占据网格的一半。

如果我将代码更改为：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <TextBlock Text="Header"/>
    <TreeView x:Name="Tree1"" Grid.Row="2"/>
    <TextBlock Text="SecondHeader" Grid.Row="2"/>
    <TreeView x:Name="Tree2" Grid.Row="3"/>
</Grid> 
```

我得到了与我想要的非常相似的结果，但是在这种情况下，树的滚动条不会出现，因为树会占据它们需要的所有区域，并且会溢出我的网格。

如果我将第二个解决方案包含在滚动查看器中，我将获得整个网格的通用滚动：

```
<ScrollViewer><Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <TextBlock Text="Header"/>
    <TreeView x:Name="Tree1"" Grid.Row="2"/>
    <TextBlock Text="SecondHeader" Grid.Row="2"/>
    <TreeView x:Name="Tree2" Grid.Row="3"/>
</Grid></ScrollViewer> 
```

该解决方案的问题是：如果第一棵树足够长，除非向下滚动，否则用户将看不到第二棵树，并且要求两棵树始终可见。

恢复我需要具有以下功能的设置：

*   在网格内显示两个树视图
*   这些树视图必须有自己的滚动
*   如果其中一个树视图没有元素，则不应该是间隙。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:52:12.893

也许这是您需要的 1 和 2 功能的解决方案：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="auto" MinHeight="131"/>
        <RowDefinition Height="auto" MinHeight="171"/>
    </Grid.RowDefinitions>
    <TreeView x:Name="Tree1" Grid.Row="0"  HorizontalAlignment="Left" Height="100">
        <TreeViewItem Header="Header">
            <TreeViewItem Header="item 1"></TreeViewItem>
            <TreeViewItem Header="item 2"></TreeViewItem>
            <TreeViewItem Header="item 3"></TreeViewItem>
            <TreeViewItem Header="item 4"></TreeViewItem>
            <TreeViewItem Header="item 5"></TreeViewItem>
            <TreeViewItem Header="item 6"></TreeViewItem>
            <TreeViewItem Header="item 7"></TreeViewItem>
            <TreeViewItem Header="item 8"></TreeViewItem>
            <TreeViewItem Header="item 9"></TreeViewItem>
            <TreeViewItem Header="item 10"></TreeViewItem>
            <TreeViewItem Header="item 11"></TreeViewItem>
            <TreeViewItem Header="item 12"></TreeViewItem>
        </TreeViewItem>
    </TreeView>
        <TreeView x:Name="Tree2"  Grid.Row="1" Margin="0,20,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="100">
        <TreeViewItem Header="SecondHeader">
            <TreeViewItem Header="item 1"></TreeViewItem>
            <TreeViewItem Header="item 2"></TreeViewItem>
            <TreeViewItem Header="item 3"></TreeViewItem>
            <TreeViewItem Header="item 4"></TreeViewItem>
            <TreeViewItem Header="item 5"></TreeViewItem>
            <TreeViewItem Header="item 6"></TreeViewItem>
            <TreeViewItem Header="item 7"></TreeViewItem>
            <TreeViewItem Header="item 8"></TreeViewItem>
            <TreeViewItem Header="item 9"></TreeViewItem>
            <TreeViewItem Header="item 10"></TreeViewItem>
            <TreeViewItem Header="item 11"></TreeViewItem>
            <TreeViewItem Header="item 12"></TreeViewItem>
        </TreeViewItem>
    </TreeView>
</Grid> 
```

TreeView 控制器有一个 Scrollable 属性，但要启用此属性，TreeView 或其容器需要有一个高度。

这样，您可以在同一个 Grid 中看到两个 TreeView，并且每个控制器都有自己的 ScrollBar。

# javascript - Javascript 访问父属性

> ID：14857901
> 
> 赞同：1
> 
> 时间：2013-02-13T16:13:45.073
> 
> 标签：javascript

如何获得家长选项？

我想访问全局 myObject 选项

```
var myObject = {    
  method: function(){
    this.options = {};
  },      
  property: {    
    propertyMethod: function(){
       alert(this.options);
    }     
  }    
}    
myObject.method();
myObject.property.propertyMethod(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T16:18:37.067

如果您的意思是，您想从内部访问`myObject`' 的`options`属性`property.propertyMethod`，那么除了利用变量`propertyMethod`闭包这一事实之外，没有办法做到这一点，例如：`myObject`

```
var myObject = {    
  method: function(){
    this.options = {};
  },      
  property: {    
    propertyMethod: function(){
       alert(myObject.options); // <=== Change is here
    }     
  }    
}    
myObject.method();
myObject.property.propertyMethod(); 
```

...这通常不是一个好主意。:-) 相反，您可能希望以不同的方式设计您的对象。例如：

```
var myObject = (function() {
  var obj = {
    method: function(){
      obj.options = {};
    },      
    property: {    
      propertyMethod: function(){
         alert(obj.options);
      }     
    }    
  };
  return obj;
})();
myObject.method();
myObject.property.propertyMethod(); 
```

这样，您将使用函数调用的执行上下文。但是，如果您要这样做，则可以将其带到下一步：

```
function makeObject() {
  var obj = {
    method: function(){
      obj.options = {};
    },      
    property: {    
      propertyMethod: function(){
         alert(obj.options);
      }     
    }    
  };
  return obj;
}
var myObject = makeObject();
myObject.method();
myObject.property.propertyMethod(); 
```

...所以你可以制作不止一个。甚至可以创建一个真正的构造函数：

```
function MyObject() {
  var obj = this;

  obj.method = function(){
    obj.options = {};
  };      

  obj.property = {    
    propertyMethod: function(){
       alert(obj.options);
    }     
  };
}
var myObject = new MyObject();
myObject.method();
myObject.property.propertyMethod(); 
```

...尽管由于您没有利用原型，因此没有太多理由将其设为构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:19:15.813

您可以使用`call`绑定`this`到`myObject`

`myObject.property.propertyMethod.call(myObject);`

# join - CopyFile Vbscript

> ID：14857904
> 
> 赞同：0
> 
> 时间：2013-02-13T16:13:53.350
> 
> 标签：join, vbscript, archive, file-copying

我需要加入任何文件（2GB）而不阅读它们的内容。我曾尝试使用 CopyFile 方法，但它不起作用。

我的代码是：

```
Public Function UnificarCRIs(ByVal path, ByVal FICRIEC, ByVal sessio, ByVal CIBAA)
Dim objFile, objCurrentFolder, filesys, origenFitxers
Dim FileName, WshShell

On error resume next

Set filesys = CreateObject("Scripting.FileSystemObject")
Set WshShell = WScript.CreateObject("WScript.Shell")
Set objCurrentFolder = filesys.getFolder(path)
origenFitxers = " "

For Each objFile In objCurrentFolder.Files
    FileName = objFile
    If (right(FileName, 4) = ".cri") Then
        origenFitxers = FileName
        'Wscript.Echo FileName
        If filesys.FileExists(path & FICRIEC & sessio) Then
            'Wscript.Echo "If"
            Wscript.Echo path & FICRIEC & sessio & "+" & FileName
            filesys.CopyFile path & FICRIEC & sessio & "+" & FileName, path & FICRIEC & sessio 
             'WshShell.Run ("copy " & path & FICRIEC & sessio & "+" & FileName & " " & path & FICRIEC & sessio & "_tmp")
            'filesys.DeleteFile path & FICRIEC & sessio
            'filesys.MoveFile path & FICRIEC & sessio & "_tmp", path & FICRIEC & sessio
        Else
            Wscript.Echo "Else"
            WshShell.Run ("copy " & FileName & " " & path & FICRIEC & sessio)
            'filesys.CopyFile FileName,path & FICRIEC & sessio
        End If  
    End If 
Next

End Function 
```

有什么方法可以使用 Vbscript 连接两个文件吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:22:14.453

要加入两个文件，“某人”必须读取（和写入）两个文件的内容。这个“某人”可能是`copy [/B] f1 + f2 f3`。因此，请使用您的循环来构建正确的文件规范和`WshShell.Run/.Exec`suitabe 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:28:38.353

取决于您可以访问哪些 COM 对象以及代码在何处运行。

1) 如果您有权访问 Shell，则使用 DOS 提示符的复制命令。此示例显示了 Dir 命令的执行，但它是相同的技术。

```
Dim oShell    
Set oShell = WScript.CreateObject ("WScript.Shell")

' Note the True value means wait to complete...
' And the 0 value means do not display any window...

oShell.run "cmd /K CD C:\ & Dir", 0, True  

Set oShell = Nothing 
```

也许还可以看看这里[http://ss64.com/vb/shellexecute.html](http://ss64.com/vb/shellexecute.html)。不知道这个方法有没有帮助。

2）如果你没有shell，那么如果你可以制作COM对象，那么用C++或Delphi或VB6等制作一个。然后使用该COM对象执行DOS命令进行合并。

3）否则，您将不得不从文件中读取数据。如果是文本文件，那么这很容易，因为在 Vbs 中有简单的命令可以做到这一点。如果是二进制数据，则需要更多的工作来获取二进制数据并使用“LenB”和“AscB”样式函数来访问 Unicode 的原始字节。但你真的不想那样做。任何 ASP 的上传处理脚本都应该向您展示使用字符串中的原始字节的技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-27T03:28:06.900

您可以将 VBScript 与 Windows Copy 命令结合使用来连接文件。[您可以使用 Copy here https://support.microsoft.com/en-us/kb/71161](https://support.microsoft.com/en-us/kb/71161)查看有关附加二进制文件的文档

这是该技术的示例：

```
JoinFiles "c:\test\", "c:\test\mergedfile.cri"

Function JoinFiles (inPath, outPath)
    Dim objShell, objFSO

    Set objFSO = CreateObject("Scripting.FileSystemObject")
    Set objShell = WScript.CreateObject("WScript.Shell")

    Dim strFilenames, objFile, intFilecount, intExitCode

    strFilenames = ""
    intFilecount = 0
    intExitCode = 0

    ' If the input folder exists, proceed to listing the files
    If objFSO.FolderExists (inPath) Then
        ' List the files in the folder and join the files which has cri extension
        For Each objFile In objFSO.GetFolder(inPath).Files
            If LCase (objFSO.GetExtensionName (objFile.Path)) = "cri" Then
                intFilecount = intFilecount+1
                strFilenames = strFilenames & """" & objFile.Path & """ + "
            End If
        Next

        ' If there're more than one file, proceed to join the file
        If (intFilecount > 1) Then
            ' join the files. Remove the last 3 characters from strFilenames (" + ").
            intExitCode = objShell.Run ("%COMSPEC% /C COPY /B " & Left (strFilenames, Len (strFilenames)-3) _
            & " """ & outPath & """ /Y", 0, True)
        Else
            ' Not enough file to join
        End If
    Else
        ' Can't find folder, exit.
    End If      
End Function 
```

# java - 我的 Java 函数的存储值在 JavaScript 变量中返回字符串

> ID：14857905
> 
> 赞同：-4
> 
> 时间：2013-02-13T16:14:03.690
> 
> 标签：java, javascript, html, css

我正在用 JSP 开发一个 Web 应用程序。我用 JSP、CSS 和 HTML 制作了这个页面。有六个按钮。每个按钮都会调用一个 JavaScript 方法，因此第一个按钮是对该方法的调用 `par()`。

```
 <html>
<head>
<title>Welcome   d To Student University</title>
<link rel="stylesheet" type="text/css" href="../css/stlogin.css">
<link rel="stylesheet" type="text/css" href="../css/background.css">
<link rel="stylesheet" type="text/css" href="../css/back.css">
<script src="StInfo.jsp">
</script>

</head>
<body>
<div class=main>
    <div class=blank></div>
    <div class=welcome><h1 class=welcome><center>Welcome Student</center></h1>
    <div class=logout><a href='logout.jsp?value=st'>Logout</a></div></div>
</div>
<br>
<div class=menu>
    <div class=leftgap>.
    </div>
    <div class=option>
    <center>
    <button type="button" onclick=par() class="Bt_menu">Check Parsnal Info</button>
    </center>
    </div>
    <div class=option>
    <center>
    <button type="button" onclick=faculty() class="Bt_menu">All Faculty Details</button>
    </center>
    </div>
    <div class=option>
    <center>
    <button type="button" onclick=exam() class="Bt_menu">Next Exams Details</button>
    </center>
    </div>
    <div class=option>
    <center>
    <button type="button" onclick=atten() class="Bt_menu">Attendance Details</button>
    </center>
    </div>
    <div class=option>
    <center>
    <button type="button" onclick=Result() class="Bt_menu">Exam Result Details</button>
    </center>
    </div>
    <div class=option>
    <center>
    <button type="button" onclick=Notices() class="Bt_menu">College Notices / Details</button>
    </center>
    </div>
</div>
<p id=Table></p>
</body>
</html> 
```

在此页面中，我将此脚本标记用作：-

```
<script src="StInfo.jsp">
</script> 
```

现在我向你展示我的 StInfo.jsp 文件，那里有 java 脚本方法。

```
<%@page import="data.*;" %>
<%
ServletConfig con=getServletConfig();
ServletContext ctx=con.getServletContext();
DataRet d;
%>
function par()
{
try
{
// i sat ctx.setAttribute("id") is 1 already in my last page . so the output will be 1 of it .
<%DataRet.setAtt(""+ctx.getAttribute("id"),"stlogin");%>
var id=<%=ctx.getAttribute("id")%>                // if i did that than the value 1 store in id .
var id=<%=DataRet.get(2)%>                        // but when i did that nething happen and code didn't work .
}catch(err)
{
txt="There was an error on this page.\n\n";
txt+="Error description: " + err.message + "\n\n";
txt+="Click OK to continue.\n\n";
alert(txt);
}
//alert("id");
document.getElementById("Table").innerHTML="<center><table border='10'><th>College Id</th> <th>Name</th><th>Father Name</th><th>Department</th><th>Year</th><th>Semester</th><th>Ph. No.</th><th>Address</th>\
<tr>\
<td>"+id+"</td>\
<td>"+id+"</td>\
<td>"+id+"</td>\
<td>"+id+"</td>\
<td>"+id+"</td>\
<td>"+id+"</td>\
<td>"+id+"</td>\
<td>"+id+"</td>\
</tr></table><center>";

} 
```

这是我的 DataRet 文件 ---

```
 package data;
import java.sql.*;
import connection.connection;
public class DataRet
{
static Connection c;
static ResultSet re;
static Statement s;
static String id;
static
{
    try
    {
        c=connection.getConnect();
        System.out.println(c);
        s = c.createStatement();
        System.out.println("Statement Object Created = "+s);
    }catch(Exception e){System.out.println(e);}
}
public static void setAtt(String table)
{
    try{
    re=s.executeQuery("select * from "+table);
    }catch(Exception e){}
}
public static void setAtt(String att,String table)
{
    System.out.println("Table Sated");
    id=att;
    int i=0;
    try
    {
        re=s.executeQuery("select * from "+table);

        while(re.next() && re.getString(3).equals(att))
        {
            i++;
            break;
        }
    System.out.println("curser on "+i);
    }catch(Exception e){System.out.println(e);}
    }
    public static void change()
    {
        try{
            re.next();
        }catch(Exception e){}
    }
    public static String get(int val)
    {
        System.out.println("value geted of "+val);
        try{
            String o=re.getString(val);
            //o=string.valueOf(o);
            System.out.println(o);
            return o;
        }catch(Exception e){ System.out.println("Problum in Geting Value"+e);}
        System.out.println("return null");
        return null;
    }
} 
```

现在的问题是，当我在 stInfo.jsp 中调用方法 * *<%=ctx.getAttribute("id")%> **时，此方法会在非常 coloum 中打印 1 。当我调用 <%=DataRet.get(2)%> 方法时，文件不起作用....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:40:46.780

从 JSP scriptlet 存储数据应该非常简单，就像您拥有它一样。

```
var id=<%=ctx.getAttribute("id")%> 
```

虽然我建议你小心返回数据，但如果它不是一个数字，那么你必须把它放在引号之间，以确保 JS 不会中断。例如：

如果`<%=DataRet.get(2)%>`返回一个字符串`"TEST"`，那么生成的 JS 将如下所示：

```
var id=TEST 
```

这只会简单地中断，因为没有名为 TEST 的变量。您需要将其括在双引号或单引号中，例如：

```
var id="<%=DataRet.get(2)%>"; 
```

此外，您必须记住每行末尾的分号，并转义任何可能破坏 JS 代码的字符。请记住，在 JSP 编译之后，JS 代码还没有执行，所以就像您手动编写的 JS 代码一样。

如果此代码不起作用，请首先检查`<%=DataRet.get(2)%>`返回的内容，以及是否有任何 JS 错误。

希望能帮助到你。

# php - WordPress：提交后的 PHP 表单重定向

> ID：14857906
> 
> 赞同：0
> 
> 时间：2013-02-13T16:14:03.710
> 
> 标签：php, wordpress, web

我无法获得在我的 WordPress 网站上创建的自定义表单，以便在提交后重定向到“谢谢”页面。表单操作调用一个 php 函数，该函数首先通过电子邮件发送表单内容。邮件顺利通过。

我的表单标签设置为：

```
<form id="adoptApp" action="<?php formMailer(); ?>" method="post"> 
```

我的 formMailer 函数包含：

```
if ( empty($_POST["applicantName"]) ) {
    return;
}

$to = "foo@bar.org";

if ( empty( $_POST["preferredPup"] ) ) {
    $subject = "Addoption Application";
} else {
    $subject = "Addoption Application for " . $_POST["preferredPup"];
}

$headers = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= "From: Foo <foo@bar.org>" . "\r\n";
$headers .= "Cc: " . $_POST["applicantEmail"] . "\r\n";

$application = adoptionApplicationEmail();

mail( $to, $subject, $application, $headers ); 
```

在 php 邮件功能之后，我尝试使用以下方法进行页面重定向。所有这些都导致表单只是重新加载，空白。

```
// Method #1
$redirectURL = "http://www.bar.org/thanks/";
echo '<META HTTP-EQUIV=Refresh CONTENT="0; URL=' . $redirectURL . '">';

// Method #2
wp_safe_redirect('http://www.bar.org/thanks/');

// Method #3
header("Location: http://www.bar.org/thanks/"); 
```

最后是感谢页面的代码（如果有帮助的话）。

```
<?php /* Template Name: FormSubmitted_ThankYou */ ?>
<?php get_header(); ?>
<?php $myScripts = $_SERVER['DOCUMENT_ROOT'] . 'path/to/scripts.php' ;
    include $myScripts;
?>

<p style="padding: 5px">
<b>Thank you!</b><br />You application has been submitted.  We will review it as soon as possible.<br />
In the meantime if you have any questions you may email us at <a href="mailto:foo@bar.org">foo@bar.org</a>
</p>

<?php get_footer(); ?> 
```

我的意图是使用一些 $_POST 数据进一步自定义感谢页面，但是我最终陷入了这个重定向问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:21:41.537

一种简单的方法如下。

将您的电子邮件代码添加到感谢页面，如下所示：

```
<?php /* Template Name: FormSubmitted_ThankYou */

if ( empty($_POST["applicantName"]) ) {
    exit();
}

$to = "foo@bar.org";

if ( empty( $_POST["preferredPup"] ) ) {
    $subject = "Addoption Application";
} else {
    $subject = "Addoption Application for " . $_POST["preferredPup"];
}

$headers = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= "From: Foo <foo@bar.org>" . "\r\n";
$headers .= "Cc: " . $_POST["applicantEmail"] . "\r\n";

$application = adoptionApplicationEmail();

mail( $to, $subject, $application, $headers );

get_header();

$myScripts = $_SERVER['DOCUMENT_ROOT'] . 'path/to/scripts.php' ;
include $myScripts;
?>

<p style="padding: 5px">
<b>Thank you!</b><br />You application has been submitted.  We will review it as soon as possible.<br />
In the meantime if you have any questions you may email us at <a href="mailto:foo@bar.org">foo@bar.org</a>
</p>

<?php get_footer(); ?> 
```

And change your form tag to this:

```
<form id="adoptApp" action="http://www.bar.org/thanks/" method="post"> 
```

# css - 在引导程序中将标签与单选按钮对齐

> ID：14857909
> 
> 赞同：61
> 
> 时间：2013-02-13T16:14:10.093
> 
> 标签：css, twitter-bootstrap

我有一个带有一些内联单选按钮和标签的 Bootstrap 表单。我想将标签与按钮保持在同一行，但我似乎无法做到这一点。这是我的方法：

```
<form>
    <div class="control-group">
        <label class="control-label">Some label</label>
        <div class="controls">
            <label class="radio inline">
                <input type="radio" value="1"/>
                First
            </label>
            <label class="radio inline">
                <input type="radio" value="2"/>
                Second
            </label>
        </div>
    </div>
</form> 
```

小提琴：http: [//jsfiddle.net/GaDbZ/2/](http://jsfiddle.net/GaDbZ/2/)

我也试过这个：

```
<form>
    <div class="form-inline">
        <label class="control-label">Some label</label>
        <label class="radio">
            <input type="radio" value="1"/>
            First
        </label>
        <label class="radio">
            <input type="radio" value="2"/>
            Second
         </label>
    </div>
</form> 
```

但一切都融为一体。小提琴：http: [//jsfiddle.net/GaDbZ/3/](http://jsfiddle.net/GaDbZ/3/)

如何获得第一个的水平间距和第二个的垂直间距？

另外，我应该注意，在现实生活中，表格中还有很多其他的东西，所以我不想使用`form-horizontal`它，因为它会产生与我在其中的其他东西不匹配的时髦边距。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-05-01T22:37:35.493

如果在 user1938475 提供的解决方案中将“radio inline”类添加到控制标签，它应该与其他标签正确对齐。或者，如果您像第二个示例一样仅使用“收音机”，则只需包含“收音机”类。

```
<label class="radio control-label">Some label</label> 
```

或“无线电内联”

```
<label class="radio-inline control-label">Some label</label> 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-09-16T04:16:44.677

从**Bootstrap 3**开始，您必须在标签上使用[checkbox-inline 和 radio-inline类。](http://getbootstrap.com/css/#forms-controls)

这负责垂直对齐。

```
<label class="checkbox-inline">
    <input type="checkbox" id="inlineCheckbox1" value="option1"> 1
</label>
<label class="radio-inline">
    <input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1"> 1
</label> 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-02-18T05:00:07.140

这可能对你有用，请试试这个。

```
<form>
  <div class="form-inline">
    <div class="controls-row">
      <label class="control-label">Some label</label>
      <label class="radio inline">
        <input type="radio" value="1" />First
      </label>
      <label class="radio inline">
        <input type="radio" value="2" />Second
      </label>
    </div>
  </div>
</form> 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-07-31T13:37:58.170

这一切都很好地排列，*包括*字段标签。排列字段标签是棘手的部分。

[![在此处输入图像描述](../Images/1f4626dee0ed2a7e7befaba2d046d47b.png)](https://i.stack.imgur.com/fjLcD.png)

## HTML 代码：

```
<div class="form-group">
    <label class="control-label col-md-5">Create a</label>
    <div class="col-md-7">
        <label class="radio-inline control-label">
            <input checked="checked" id="TaskLog_TaskTypeId" name="TaskLog.TaskTypeId" type="radio" value="2"> Task
        </label>
        <label class="radio-inline control-label">
            <input id="TaskLog_TaskTypeId" name="TaskLog.TaskTypeId" type="radio" value="1"> Note
        </label>
    </div>
</div> 
```

## CSHTML / Razor 代码：

```
<div class="form-group">
    @Html.Label("Create a", htmlAttributes: new { @class = "control-label col-md-5" })
    <div class="col-md-7">
        <label class="radio-inline control-label">
            @Html.RadioButtonFor(model => model.TaskTypeId, Model.TaskTaskTypeId) Task
        </label>
        <label class="radio-inline control-label">
            @Html.RadioButtonFor(model => model.TaskTypeId, Model.NoteTaskTypeId) Note
        </label>
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-27T10:46:28.093

在**Bootstrap 4**中，您可以使用[form-check-inline](https://getbootstrap.com/docs/4.0/components/forms/#checkboxes-and-radios)类。

```
<div class="form-check form-check-inline">
  <input class="form-check-input" type="radio" name="queryFieldName" id="option1" value="1">
  <label class="form-check-label" for="option1">First</label>
</div>
<div class="form-check form-check-inline">
  <input class="form-check-input" type="radio" name="queryFieldName" id="option2" value="2">
  <label class="form-check-label" for="option2">Second</label>
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-16T14:48:13.783

对我来说主要的见解是： - 确保标签内容出现*在*input-radio 字段之后 - 我调整了我的 css 以使一切更接近

```
.radio-inline+.radio-inline {
    margin-left: 5px;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-13T02:13:24.857

最好只`margin-top: 2px`在输入元素上应用。

Bootstrap 添加了一个`margin-top: 4px`输入元素，导致单选按钮比内容向下移动。

# ruby-on-rails - Ruby on Rails 和 cmd 中的 Sqlite3

> ID：14857912
> 
> 赞同：0
> 
> 时间：2013-02-13T16:14:17.103
> 
> 标签：ruby-on-rails, database, sqlite, sqlite3-ruby

> 我有一个带有名称建筑物的表，我想删除它，因为我忘记了一个列。在 cmd 中，我转到文件夹并键入“sqlite3”，然后键入“.tables”，没有任何显示。为什么？我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:19:14.550

删除数据库表的正确方法是为其编写迁移。

> 迁移是一种以结构化和有组织的方式更改数据库的便捷方式。您可以手动编辑 SQL 片段，但随后您将负责告诉其他开发人员他们需要去运行它们。您还必须跟踪下次部署时需要对生产机器运行哪些更改。
> 
> Active Record 跟踪哪些迁移已经运行，所以你所要做的就是更新你的源并运行 rake db:migrate。Active Record 将确定应该运行哪些迁移。它还将更新您的 db/schema.rb 文件以匹配您的数据库的结构。

资料来源： http: [//guides.rubyonrails.org/migrations.html](http://guides.rubyonrails.org/migrations.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:21:48.667

您应该避免直接操作数据库，而是使用迁移。如果您忘记添加列，那么您应该创建一个新的迁移，`add_column`用于将该列添加到表中。

或者，如果先前的迁移是创建缺少列的表的迁移，并且您尚未分发此迁移，您可以这样做`rake db:rollback`，编辑迁移并`rake db:migrate`再次运行。

运行 sqlite 命令时缺少表很可能是因为您忘记指定要加载的 sqlite 文件：`sqlite3 <db_name>`

# html - 如果语句在它真正应该起作用时不起作用

> ID：14857913
> 
> 赞同：1
> 
> 时间：2013-02-13T16:14:18.570
> 
> 标签：html, if-statement

好的，这是迄今为止我遇到的最奇怪的事情之一。我的一个 woocommerce 文件中有以下代码：

```
<?php $titlevar = wp_title('', 0); ?>
                <?php echo $titlevar; ?>

                <?php if($titlevar == "Men") { ?>

                <div id="sidemenu" style="float:left;width: 180px;float:left;height:100px">

                <?php wp_nav_menu( array('menu' => 'sidemenumen' )); ?>

                </div>

                <?php } ?> 
```

如您所见，如果我的 $titlevar 变量等于“Men”，它应该显示一个带有菜单的 div。我已经在顶部回显了变量，它实际上输出了 'Men' （当然没有引号），它怎么可能没有显示我的 div？

# c# - DbContext 和 ObjectContext 有什么区别

> ID：14857915
> 
> 赞同：20
> 
> 时间：2013-02-13T16:14:27.080
> 
> 标签：c#, asp.net, entity-framework

来自`MSDN`：

> 表示工作单元和存储库模式的组合，使您能够查询数据库并将更改组合在一起，然后将这些更改作为一个单元写回存储。`DbContext`在概念上类似于`ObjectContext`。

我虽然`DbContext`只处理与数据库的连接以及对数据库工作的线程数。

现在我明白它包含跟踪机制了吗？我以为这是在`ObjectContext`.

那么（用简单的英语）它们之间的区别是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-13T16:21:27.873

DbContext 是 ObjectContext 类的轻量级版本，它几乎位于 ObjectContext 之上（甚至有一种方法可以从 DbContext 中获取 ObjectContext）。它也更容易使用，IMO，并使 CRUD 操作变得轻而易举。

要获得更好的信息，谁能比[Julie Lerman](http://thedatafarm.com/data-access/accessing-objectcontext-features-from-ef-4-1-dbcontext/)更好地了解有关差异的更多信息，正如 EF 4.1 中所引入的那样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-19T17:52:48.720

DbContext 是一个较小的 API，它公开了 ObjectContext 最常用的功能。在某些情况下，这些功能会在 DbContext API 中得到反映。在其他情况下，实体框架团队通过为我们提供 Find 之类的方法或 DbSet.Local 之类的属性来简化更复杂的编码。但是你可能仍然需要访问一个隐藏在下面的大型 API。例如，您可能希望直接使用 MetadataWorkspace 来针对类编写通用代码，因为该 API 可以比反射更有效地读取模型。此外，MetadataWorkspace 能够提供比您通过反射发现的更多元数据信息，例如，对于 Key 属性。或者您可能想要利用通过 Entity SQL 公开的特定于数据库的函数，您无法从 LINQ to Entities 访问它。或者您可能已经有一个使用 ObjectContext 编写的应用程序，并且您希望在未来的更新中利用 DbContext 而无需替换所有 ObjectContext 代码。（来自 Programming DbContext 的参考）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-21T03:24:59.593

## 对象上下文：

1.支持编译查询 2.支持实体自追踪 3.适用于实体框架4.0及以下版本 4.不是线程安全的。5.最好是DB优先和模型优先的方法。

## 数据库上下文：

1.不支持编译查询 2.不支持实体自追踪 3.实体框架4.1及以上版本可用 4.静态和共享成员（公共）线程安全。5.最好是DB优先和模型优先方法和代码优先方法。

# c# - 如何提前 ServiceStack 中的会话超时

> ID：14857921
> 
> 赞同：10
> 
> 时间：2013-02-13T16:14:44.230
> 
> 标签：c#, servicestack

ServiceStack 中的身份验证、存储库和缓存提供程序提供了一种将登录会话添加到 Web 应用程序的简单方法，几乎​​不需要额外的代码。我发现可以配置身份验证提供程序的会话超时，例如：

```
new CredentialsAuthProvider { SessionExpiry = TimeSpan.FromMinutes(10) } 
```

这提供了从登录点开始的过期时间。如果我们正在开发一个必须在短时间内注销用户的安全系统，那么我们会将其从默认的 2 周更改为类似于上面的示例。但这有一个问题，即用户在登录后 10 分钟就会被踢出，无论他们是否仍在与应用程序交互。

有没有一种简单的方法来告诉会话提供者在调用服务时延长到期时间？

理想情况下，它将允许我们为特定的服务/请求扩展会话（以便会话仅在用户主动与应用程序交互时才扩展，因此可以忽略轮询服务）。

**更新**

根据 myz 给出的答案，我们现在有一个简单的解决方案，通过[扩展 ResponseFilterAttribute](http://teadriven.me.uk/2013/02/14/sliding-sessions-in-service-stack)来提供我们所需的控制级别。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T17:47:49.440

[ServiceStack](http://www.servicestack.net/)还不支持自动“滑动会话过期”。您基本上需要在每个成功的请求上重置会话缓存条目。即你可以有一个响应过滤器（因为它们只针对经过身份验证的请求执行），它重新保存会话，这将在到期时间之前延长它的生命周期：

```
var userSession = httpReq.GetSession();
httpReq.SaveSession(userSession, slidingExpiryTimeSpan); 
```

如果您知道您正在使用什么缓存提供程序，例如 Redis，您可以手动更新到期超时而无需重新读取条目，例如：

```
var sessionKey = SessionFeature.GetSessionKey(httpReq.GetSessionId());
redis.ExpireEntryIn(sessionKey, slidingExpiry); //"urn:iauthsession:{sessionId}" 
```

# google-chrome - Chrome 中的悬停状态和过渡 - 一个元素上的多个动画不适用

> ID：14857923
> 
> 赞同：1
> 
> 时间：2013-02-13T16:14:47.023
> 
> 标签：google-chrome, css, webkit, hover, css-transitions

当我在悬停时在 Chrome(24.0.1312.57) 中应用过渡时，它不会在鼠标移出时更新背景颜色。看到这个小提琴： http: [//jsfiddle.net/WKVJ9/](http://jsfiddle.net/WKVJ9/) 这是代码：

```
.transition{
     -webkit-transition: all 500ms ease-in-out;
}
.wrapper{
    width:200px;
    height:200px;
    display:block;
    background-color:cyan;
    position:relative;

}
.hoverme{
    border-radius:90px;
    display: block;
    width:50px;
    height:50px;
    top:50px;
    right:-90px;
    position:absolute;
    -webkit-transform: rotate(-45deg);

}
.wrapper:hover .hoverme{
     -webkit-transform: rotate(0deg);
    right:0;
}
.hoverme:hover{
    background-color:red;
} 
```

和html：

```
<div class="wrapper">
    <div class="hoverme transition">
       Hover me
    </div>
</div> 
```

如果悬停 .wrapper 和 .hoverme 然后快速将鼠标移离此框，则 .hoverme 元素只会为旋转和位置设置动画。

在我正在处理的网站上，它甚至不会刷新悬停状态，因此当动画完成并且背景保持不变时：hover background-color ...由于某种原因我无法在这里重现

是否可以使背景动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:46:56.397

这是因为 position:absolute in .hoverme

尝试将其更改为 position:relative add margin-left:150px; （或需要）纠正 .hoverme 的位置......像这样：

```
.hoverme{
    border-radius:90px;
    display: block;
    width:50px;
    height:50px;
    top:50px;
    right:-90px;
    position:relative;
    margin-left:150px;
    -webkit-transform: rotate(-45deg);

} 
```

在这里检查它：http: [//jsfiddle.net/WKVJ9/1/](http://jsfiddle.net/WKVJ9/1/)

# sql - 触发以替换插入后的字符

> ID：14857925
> 
> 赞同：0
> 
> 时间：2013-02-13T16:14:48.640
> 
> 标签：sql, plsql, triggers, oracle11g

是否可以为某个用户创建一个触发器，该触发器在将数据加载到任何表后立即替换一个字符？

例如，当用户将数据加载到表中时，我需要将 PERS_ID 列中的所有 '1' 替换为 '9'。

我是 PLSQL 的新手，所以我什至不知道从哪里开始。

我不确定我是否可以明确我的目标，所以请随时要求澄清。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:20:48.603

从技术上讲，你当然可以......（为简单起见，我假设这`pers_id`是一个字符串而不是一个数字 - 如果它是一个数字，你当然可以将它转换为字符串，运行`replace`并将其转换回来到触发器中的数字）

```
SQL> create table foo( pers_id varchar2(10) );

Table created.

SQL> create trigger replace_data
  2    before insert on foo
  3    for each row
  4  begin
  5    :new.pers_id := replace( :new.pers_id, '1', '9' );
  6  end;
  7  /

Trigger created.

SQL> insert into foo values( '123abc456' );

1 row created.

SQL> select * from foo;

PERS_ID
----------
923abc456 
```

然而，实际上，这个要求似乎异常奇怪。让触发器默默地更改正在插入的数据通常是一个坏主意，因为它往往会使调试异常困难。当他们插入到表中的数据与他们在查询表时看到的数据不匹配时，未来的开发人员很可能会感到相当惊讶，并且他们不太可能立即发现触发器更改了数据。如果您可以描述您正在尝试解决的业务问题，我们可能会提出更合适的技术解决方案。

# c++ - 可变参数函数上的 foreach 等价物

> ID：14857926
> 
> 赞同：3
> 
> 时间：2013-02-13T16:14:49.200
> 
> 标签：c++, c++11, variadic-functions

做了一些搜索，找不到这个问题的答案，如果重新发布，请道歉。我想在一堆不同的对象上调用具有相同参数的相同函数。我目前是这样实现的：

```
void callWithArg(const char* msg) { }

template <typename HEAD, typename.... TAIL>
void callWithArg(HEAD&& head, TAIL&&... tail, const char* msg) {
    head.foo(msg);
    callWithArg(tail..., msg);
} 
```

显然，这本身并不是一段特别乏味的代码，我只是想知道是否有比这种递归调用更简单或更干净的方法来迭代该参数包？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T23:42:50.987

这是我所知道的最简洁的表达方式：

```
template<typename ...T>
void callWithArg(const char *msg, T &&...t) {
  int dummy[] = { 0, (t.foo(msg), 0)... };
} 
```

包扩展扩展为一个类型的表达式列表，`int`用于初始化数组`dummy`（我们将其丢弃）。调用`foo`是有序的，因为在 C++11 中，列表初始化的元素是从左到右排序的。

如果添加 a `#include <initializer_list>`，您可以稍微简化为：

```
auto dummy = { 0, (t.foo(msg), 0)... }; 
```

您可能还想抑制各种编译器对此代码产生的“未使用变量”警告，使用

```
(void) dummy; 
```

如果函数没有给出除 以外的参数，则包含初始`0,`值以避免错误`msg`。我还重新排序了您的函数参数以将包放在最后，以便可以推断包中的类型。

# sql - TSQL 从两张表创建动态报告，一张表保存标题，另一张保存数据

> ID：14857929
> 
> 赞同：2
> 
> 时间：2013-02-13T16:14:56.130
> 
> 标签：sql, sql-server, tsql, pivot

想象一个场景，我想根据作为标题的列从`[FormValues]`数据中获取动态报告。`[Title]``[ReportItems]`

我真的很困惑如何做到这一点并尝试了很多方法，但它们都不能正常工作。

我应该能够给一个过程一个 [ReportID] 并得到结果。

`[FormID]`并且`[FieldID]`是两个表之间的关系键。

任何帮助将不胜感激。

```
CREATE TABLE #ReportItems(
    ReportItemID [uniqueidentifier] NOT NULL primary key,
    ReportID [uniqueidentifier] NOT NULL,
    FormID [uniqueidentifier] NOT NULL,
    FieldID [uniqueidentifier] NOT NULL,
    Title nvarchar(100) NOT NULL
) 
GO

insert into #ReportItems
select '5674d274-b146-4251-be0d-a15000e7cefa', '597d37c0-563b-42f0-99be-a15000dc7a65', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7a', 'First Name'
insert into #ReportItems
select '5674d274-b146-4252-be0d-a15000e7cefa', '597d37c0-563b-42f0-99be-a15000dc7a65', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7b', 'Last Name'
insert into #ReportItems
select '5674d274-b146-4253-be0d-a15000e7cefa', '597d37c0-563b-42f0-99be-a15000dc7a65', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7c', 'Age'
GO

CREATE TABLE #FormValues(
    ValueID uniqueidentifier NOT NULL primary key,
    FormID uniqueidentifier NULL,
    FieldID uniqueidentifier NOT NULL,
    UserName nvarchar(100) NOT NULL,
    Value nvarchar(max) null
)
GO

insert into #FormValues
select 'af6dc400-3972-49ff-9711-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7a', 'user 1', 'Mike'
insert into #FormValues
select 'af6dc400-3972-49ff-9721-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7b', 'user 1', 'Oscar'
insert into #FormValues
select 'af6dc400-3972-49ff-9731-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7c', 'user 1', '20'

insert into #FormValues
select 'af6dc400-3972-49ff-9741-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7a', 'user 2', 'Merry'
insert into #FormValues
select 'af6dc400-3972-49ff-9761-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7c', 'user 2', '23'

insert into #FormValues
select 'af6dc400-3972-49ff-9771-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7a', 'user 3', 'Alen'
insert into #FormValues
select 'af6dc400-3972-49ff-9781-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7b', 'user 3', 'Escott'
insert into #FormValues
select 'af6dc400-3972-49ff-9791-a1520002359e', '01304636-fabe-4a3e-9487-a14b012f9a61', 'ba6b9b1a-92ef-4905-830a-a15000d05f7c', 'user 3', '28'
GO

Select * from #ReportItems
Select * from #FormValues
GO 
```

我想要这样的报告作为结果：

```
User Name   |   First Name  |   Last Name   |   Age
User 1      |   Mike        |   Oscar       |   20
User 2      |   Merry       |               |   23
User 3      |   Alen        |   Escott      |   28
User n      |   ...         |   ...         |   ...

drop table #ReportItems
drop table #FormValues 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:24:52.223

要获得您想要的结果，您需要使用该[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)功能。

如果您的所有值 ( `title`) 都是提前知道的，那么您可以硬编码一个静态查询：

```
select *
from
(
    select r.Title, f.UserName, f.Value
    from ReportItems r
    left join FormValues f
        on r.FormID = f.FormID
        and r.FieldID = f.FieldID
) src
pivot
(
    max(value)
    for title in ([First Name], [Last Name], Age)
) piv; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/514f2/4)。

但听起来您将有未知数量的`titles`要变成列的内容。如果是这种情况，那么您将需要使用动态 sql：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(Title) 
                    from ReportItems
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT UserName,' + @cols + ' from 
             (
                select r.Title, f.UserName, f.Value
                from ReportItems r
                left join FormValues f
                    on r.FormID = f.FormID
                    and r.FieldID = f.FieldID
            ) x
            pivot 
            (
                max(value)
                for Title in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/514f2/3)

两者的结果都是：

```
| USERNAME | FIRST NAME | LAST NAME | AGE |
-------------------------------------------
|   user 1 |       Mike |     Oscar |  20 |
|   user 2 |      Merry |    (null) |  23 |
|   user 3 |       Alen |    Escott |  28 | 
```

如果您有特定`SortOrder`的需要并将其存储在表中，那么当您获取列列表时，您将使用以下内容，它将以正确的顺序返回列：

```
select @cols = STUFF((SELECT ',' + QUOTENAME(Title) 
                    from ReportItems
                    group by Title, sortorder
                    order by sortorder
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'') 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/b4626/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:27:13.080

```
DECLARE @SQL NVARCHAR(MAX)

SET @SQL='SELECT F.UserName'
SELECT @SQL = @SQL+', MAX(CASE WHEN FieldID='''+CONVERT(VARCHAR(50), FieldID)+''' THEN F.Value END) AS ['+Title+']
'
FROM #ReportItems
SET @SQL = @SQL+' FROM #FormValues F GROUP BY F.UserName ORDER BY 1'
--select @sql
EXEC sp_ExecuteSQL @SQL 
```

稍后编辑：基于报告 ID 的报告过程和排序列

```
CREATE PROCEDURE spReport
@ReportID uniqueidentifier,
@SortColumns NVARCHAR(MAX) --shoud be a comma separated list of ReportItems.Title
AS 
BEGIN
    DECLARE @SQL NVARCHAR(MAX)
    SET @SQL='SELECT F.UserName'
    SELECT @SQL = @SQL+', MAX(CASE WHEN F.FieldID='''+CONVERT(VARCHAR(50), FieldID)+''' THEN F.Value END) AS ['+Title+']
    '
    FROM ReportItems
    WHERE ReportID=@ReportID --create the dynamic sql only for the items in your report 

    SET @SQL = @SQL+' FROM FormValues F 
    JOIN ReportItems R ON F.FormID=R.FormID
    WHERE R.ReportID = @ReportID
    GROUP BY F.UserName '
    IF @SortColumns<>''
        SET @SQL = @SQL + 'ORDER BY '+@SortColumns -- beware of SQL injection. 
    select @sql
    EXEC sp_ExecuteSQL @SQL, N'@ReportID uniqueidentifier', @ReportID=@ReportID
END 
```

但是，我再怎么强调也不为过，您必须特别注意 @SortColumns 参数，因为您正在向 SQL 注入开放。

# php - PHP 打印条件与另一个打印

> ID：14857932
> 
> 赞同：1
> 
> 时间：2013-02-13T16:15:15.073
> 
> 标签：php, navigation, conditional

我是 PHP 新手，如果这不是实现此目标的最佳方式，请原谅我。我正在创建一个子导航页面，我希望检测父变量，然后为该父呈现正确的子导航。然后在其中检测用户所在的子页面并将 .active 类打印到子导航。

```
<?php print (($primaryNav == 'training') ? '
        <li class="'print (($secondaryNav == 'classes') ? 'active' : '')'">
            <a href="/dev/training.php#classes">Classes</a>
        </li>
        <li class="'print (($secondaryNav == 'calendar') ? 'active' : '')'">
            <a href="/dev/calendar/">Calendar</a>
        </li>
        <li class="'print (($secondaryNav == 'instructors') ? 'active' : '')'">
            <a href="/dev/training.php#instructors">Instructors</a>
        </li>
' : ''); ?> 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:23:48.067

为了能够阅读代码，我会做这样的事情：

```
<?php

if ($primaryNav == 'training') {

  $classes = ($secondaryNav == 'classes') ? 'active' : '';
  $calendar = ($secondaryNav == 'calendar') ? 'active' : '';
  $instructors = ($secondaryNav == 'instructors') ? 'active' : '';

?>
<li class="<?php echo $classes; ?>">
    <a href="/dev/training.php#classes">Classes</a>
</li>
<li class="<?php echo $calendar; ?>">
    <a href="/dev/calendar/">Calendar</a>
</li>
<li class="<?php echo $instructors; ?>">
    <a href="/dev/training.php#instructors">Instructors</a>
</li>
<?php
}
?> 
```

# sql - 选择 ID 列表的最新条目

> ID：14857934
> 
> 赞同：1
> 
> 时间：2013-02-13T16:15:18.720
> 
> 标签：sql, hibernate, postgresql, jpa

我有一个下表：

```
create table MyData
(
  id bigserial primary key,
  registered timestamp not null,
  deviceID int not null,

  someData int,

  -- a bunch of other stuff
); 
```

我也有一个`deviceID`s 列表。此列表中的每个`deviceId`条目都有一堆`MyData`具有不同`registered`时间戳的条目。

我需要的是从具有最新使用 JPA 查询的条目中获取`someData`每个条目。`deviceId``timestamp`

当然，我可以编写一个查询来获取单个所需的数据`deviceId`，例如

```
SELECT d.someData from MyData d WHERE d.deviceID =:dev_id ORDER BY registered DESC 
```

添加，为所有s`.setMaxResults(1)`循环它。`deviceID`如何将其放入单个查询中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T09:34:23.680

这将为您`deviceid`提供具有最新“注册”值的所有 s的行

```
select id, 
       deviceid,
       somedata,
       registered
from (
   select id,
          deviceid,
          somedata,
          registered,
          max(registered) over (partition by deviceid) as max_registered
   from myData
) t
where registered = max_registered
order by deviceid; 
```

如果同一个 deviceId 有多个“最大值”值，`registered`则每个设备都会得到不止一行。如果你不想这样，你可以使用：

```
select id, 
       deviceid,
       somedata,
       registered
from (
   select id,
          deviceid,
          somedata,
          registered,
          row_number() over (partition by deviceid order by registered desc) as rn
   from myData
) t
where rn = 1
order by deviceid; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T06:30:35.040

您可以尝试以下查询，该查询将为每个具有最大注册时间戳的设备获取数据。

```
SELECT d.deviceID, 
       min(d.someData) 
FROM MyData d 
WHERE d.registered IN (Select MAX(m.registered) 
                       from MyData m 
                       where m.deviceID = d.deviceID) 
group by d.deviceID; 
```

更改查询以相应地在 select、group-by 中包含/排除字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:25:31.207

在您的查询中，添加到 select 语句`MAX(registered)`。因此，它将选择最新注册的时间戳

例子：

```
SELECT d.someData, MAX(registered) from MyData d WHERE d.deviceID =:dev_id 
```

# asp.net-mvc-3 - 从自定义验证属性中访问 ErrorMessage

> ID：14857936
> 
> 赞同：0
> 
> 时间：2013-02-13T16:15:21.543
> 
> 标签：asp.net-mvc-3, unobtrusive-validation, validationattribute

我希望能够读取`ErrorMessage`传递给自定义验证属性的字符串，以便可以`string.Format()`对其进行一些操作。但是我好像找不到？

例如，我有一个自定义属性：

```
[IsDateBeforeFixedDate(4, 0, 0, ErrorMessage = "*The departure date should be between 4 days and 11 months")] 
```

标为：

```
 public sealed class IsDateBeforeFixedDateAttribute : ValidationAttribute, IClientValidatable
  {

    public IsDateBeforeFixedDateAttribute(int days, int months, int years) : base(days, months, years)
    {
      //I want to read the ErrorMessage string here! (i.e. "*The departure date should be between 4 days and 11 months")
    }
  } 
```

`ErrorMessageString`不包含它或`ErrorMessage`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:29:49.033

似乎如果我在`IsValid`方法中访问它，它包含正确的字符串，但它不在构造函数中

# actionscript-3 - FLEX - 分配过滤器后未更新位图图像

> ID：14857938
> 
> 赞同：1
> 
> 时间：2013-02-13T16:15:33.137
> 
> 标签：actionscript-3, apache-flex, mobile, air

我有一个 flex 移动项目和一个组件（作为类），其中包含一个 BitmapImage、一个按钮和一个图形标志。

当布尔值为 false 时，按钮被禁用，图像通过 ColorMatrixFilter (bitmapImage.filters = [myCMFilter]) 变灰并且符号出现，否则按钮被启用，图像没有过滤器 (bitmapImage.filters = [])。

问题是图像没有切换到灰色 -> 但出现标志并且按钮被禁用。

如果在一帧后调用过滤器的设置（callLater -> 设置过滤器的函数）一切正常。

我已将代码提取到示例项目中，并且一切正常...无需 callLater

任何人都知道在我的情况下会发生什么？？？

基督教

代码：

```
package de.xxx.yyy.app.view.componentsV2.widgets 
{
    import de.assets.header.HeaderBGDarkGray;
    import de.assets.miscellaneous.StarGrey;
    import de.assets.miscellaneous.StarYellow;
    import de.assets.miscellaneous.UnderConstruction;
    import de.assets.ImageAssets;
    import de.xxx.yyy.app.view.componentsV2.buttons.BasicButton;
    import de.xxx.yyy.app.view.pools.UserInterfaceComponentsPool;

    import flash.debugger.enterDebugger;
    import flash.display.DisplayObject;

    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.filters.ColorMatrixFilter;

    import mx.core.IVisualElement;

    import mx.core.UIComponent;

    import spark.components.Button;
    import spark.components.Group;
    import spark.core.SpriteVisualElement;
    import spark.primitives.BitmapImage;

    public class StadiumWidget extends Group{

        private static var STADION_LEVELS:int = 7;

        private static var SIDE_SPACING:int = 7;
        private static var BUTTON_WIDTH:int = 150;
        private static var BUTTON_HEIGHT:int = 33;

        ////////////////////////////////////////////////////////////////////////////
        // USER INTERFACE COMPONENTS
        ////////////////////////////////////////////////////////////////////////////

        private var underConstructionImage:UnderConstruction;
        private var currentImage:BitmapImage;

        private var footerBackground:HeaderBGDarkGray;
        private var developButton:BasicButton;
        private var manageButton:BasicButton;

        private var displayedlevel:int;

        ////////////////////////////////////////////////////////////////////////////
        // FIELDS
        ////////////////////////////////////////////////////////////////////////////

        private var createdStars:Array = [];

        ////////////////////////////////////////////////////////////////////////////
        //
        ////////////////////////////////////////////////////////////////////////////

        private var _grayscaleFilter:ColorMatrixFilter;

        public function get grayscaleFilter():ColorMatrixFilter
        {
            if(!_grayscaleFilter)
            {
                var matrix:Array = [0.3, 0.59, 0.11, 0, 0,
                    0.3, 0.59, 0.11, 0, 0,
                    0.3, 0.59, 0.11, 0, 0,
                    0, 0, 0, 1, 0];

                _grayscaleFilter = new ColorMatrixFilter(matrix);
            }
            return _grayscaleFilter;
        }

        public function set grayscaleFilter(value:ColorMatrixFilter):void
        {
            _grayscaleFilter = value;
        }

        ////////////////////////////////////////////////////////////////////////////
        // GETTER AND SETTER WITH DIRTY FLAG
        ////////////////////////////////////////////////////////////////////////////

        private var levelChanged:Boolean;
        private var _level:int;

        public function set level(value:int):void
        {
            _level = value;
            levelChanged = true;
            invalidateProperties();
            invalidateDisplayList()
        }

        public function get level():int
        {
            return _level;
        }

        //

        private var isUnderConstructionChanged:Boolean;
        private var _isUnderConstruction:Boolean;

        public function set isUnderConstruction(value:Boolean):void
        {
            _isUnderConstruction = value;
            isUnderConstructionChanged = true;
            invalidateProperties();
            invalidateDisplayList()
        }

        public function get isUnderConstruction():Boolean
        {
            return _isUnderConstruction;
        }

        ////////////////////////////////////////////////////////////////////////////
        // CONSTRUCTOR
        ////////////////////////////////////////////////////////////////////////////

        public function Stadium()
        {
            super();
        }

        ////////////////////////////////////////////////////////////////////////////
        // LIFECYCLE STANDARD METHODS
        ////////////////////////////////////////////////////////////////////////////

        var testSprite:UIComponent;

        override protected function createChildren():void
        {
            super.createChildren();

            currentImage = new BitmapImage();
            currentImage.smooth = true;
            currentImage.percentWidth = 100;
            currentImage.scaleMode = "letterbox";
            addElement(currentImage);

            // FOOTER

            footerBackground = new HeaderBGDarkGray();
            addElement(footerBackground);

            developButton = new BasicButton();
            developButton.width = BUTTON_WIDTH;
            developButton.height = 38;
            developButton.x = SIDE_SPACING;
            developButton.label = resourceManager.getString("FlexApp", "stadium.developButtonLabel");
            developButton.addEventListener(MouseEvent.CLICK, handleDevelopButtonClicked);
            addElement(developButton);

            manageButton = new BasicButton();
            manageButton.width = BUTTON_WIDTH;
            manageButton.height = 38;
            manageButton.label = resourceManager.getString("FlexApp", "stadium.manageButtonLabel");
            manageButton.addEventListener(MouseEvent.CLICK, handleManageButtonClicked);
            addElement(manageButton);

        }

        override protected function commitProperties():void
        {
            super.commitProperties();

            if(currentImage && levelChanged)
            {
                setcurrentImage();
                setStars();
                levelChanged = false;
            }

            if(isUnderConstructionChanged)
            {
                setUnderConstruction();
                isUnderConstructionChanged = false;
            }
        }

        override protected function measure():void
        {
            super.measure();
        }

        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
        {
            super.updateDisplayList(unscaledWidth, unscaledHeight);

            var FOOTER_HEIGHT:int = footerBackground.getPreferredBoundsHeight();
            var STAR_X_STEP:int = 25;

            footerBackground.y = unscaledHeight - FOOTER_HEIGHT;
            footerBackground.width = unscaledWidth;

            manageButton.x = unscaledWidth - (BUTTON_WIDTH + SIDE_SPACING);
            manageButton.y = developButton.y = footerBackground.y + ((FOOTER_HEIGHT - BUTTON_HEIGHT) / 2);

            if(currentImage.height > unscaledHeight - footerBackground.height)
            {
                currentImage.height = unscaledHeight - footerBackground.height;
            }

            if(underConstructionImage)
            {
                underConstructionImage.x = (unscaledWidth - underConstructionImage.width) / 2;
            }

            var starStartX:int = unscaledWidth / 2 - (STADION_LEVELS * STAR_X_STEP) / 2;
            var starY:int = createdStars.length > 0 ? unscaledHeight - FOOTER_HEIGHT + (FOOTER_HEIGHT - createdStars[0].height) / 2 : 0;

            for(var i:int = 0; i < createdStars.length; i++)
            {
                createdStars[i].y = starY;
                createdStars[i].x = starStartX + i * STAR_X_STEP;
            }
        }

        ////////////////////////////////////////////////////////////////////////////
        // HELPER METHODS
        ////////////////////////////////////////////////////////////////////////////

        private function setStars():void
        {

            var pool:UserInterfaceComponentsPool = UserInterfaceComponentsPool.getInstance();
            var star:IVisualElement;

            while(createdStars.length > 0)
            {
                star = createdStars.pop() as IVisualElement;
                if(containsElement(star))
                {
                    removeElement(star);
                }
                pool.disposeUserInterfaceComponent(star);
            }

            // POOL THE STARS!!!

            for(var i:int = 1; i <= STADION_LEVELS; i++)
            {
                if(i <= level)
                {
                    star = pool.getYellowStar();
                }
                else
                {
                    star = pool.getGreyStar();
                }
                addElement(star)
                createdStars.push(star);
            }
        }

        private function setcurrentImage():void
        {
            if(level != displayedlevel)
            {
                currentImage.source = currentImages["LEVEL_" + level + "_NAME"];
                displayedlevel = level;
            }
            setUnderConstruction();
        }

        private function setUnderConstruction():void
        {

            developButton.enabled = isUnderConstruction == false;

            if(isUnderConstruction)
            {
                if(!underConstructionImage)
                {
                    underConstructionImage = new UnderConstruction();
                    underConstructionImage.y = 30;
                    underConstructionImage.width = 330;
                    underConstructionImage.height = 330;
                    addElement(underConstructionImage);
                }
                callLater(setFilters, [true]);
            }
            else
            {
                callLater(setFilters, [false]);
                if(underConstructionImage && containsElement(underConstructionImage))
                {
                    removeElement(underConstructionImage);
                }
                underConstructionImage = null;
            }
        }

        private function setFilters(value:Boolean):void
        {
            if(value && (!currentImage.filters || currentImage.filters.length == 0))
            {
                currentImage.filters = [grayscaleFilter];
            }
            else if(!value && currentImage.filters && currentImage.filters.length > 0)
            {
                currentImage.filters = [];
            }
        }

        ////////////////////////////////////////////////////////////////////////////
        // EVENT HANDLER
        ////////////////////////////////////////////////////////////////////////////

        private function handleDevelopButtonClicked(event:MouseEvent):void
        {
            dispatchEvent(new Event("openlevelPopup", true));
        }

        private function handleManageButtonClicked(event:MouseEvent):void
        {
            dispatchEvent(new Event("openManagePopup", true));
        }

        ////////////////////////////////////////////////////////////////////////////
        // DISPOSE
        ////////////////////////////////////////////////////////////////////////////

        public function dispose():void
        {
            developButton.removeEventListener(MouseEvent.CLICK, handleDevelopButtonClicked);
            manageButton.removeEventListener(MouseEvent.CLICK, handleManageButtonClicked);
        }

    }

} 
```

# jquery - 如何在范围外使用 jquery 选定对象？

> ID：14857944
> 
> 赞同：0
> 
> 时间：2013-02-13T16:15:56.347
> 
> 标签：jquery

```
/* get every click event on input tags and send it to foo */
$('input').click( function() {
   foo($(this));
});

function foo(obj) {
/* do something with obj.. */
} 
```

使用上面的代码，我将一个输入对象`foo`作为参数传递给函数`obj`。我应该如何使用`obj`？我是否需要重新运行选择器，比如`$(obj)`使用所有 jquery 特定的方法？

还有一些问题：答案说我不需要`obj`再次用 $() 包装。如果我重新包装会发生`obj`什么`$(obj)`？（假设函数`foo`可以同时获取 jquery 选择的对象和非 jquery 选择的对象）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:17:11.037

您正在传递 jQuery 对象，因此无需`$()`再次包装。

您是否尝试在函数内部运行 jQuery`foo`函数？

```
$('input').click( function() {
   foo($(this));
});

function foo(obj) {
   console.log(obj.val()); //should print the value in the console.
} 
```

> 还有一些问题：答案说我不需要再次用 $() 包装 obj 。如果我用 $(obj) 重新包装 obj 会发生什么？（假设函数 foo 可以同时接受 jquery 选择的对象和非 jquery 选择的对象）

您可以简单`obj[0]`地获取原始`this`对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:17:14.613

不。如果它是一个 jQuery 对象，那么您可以使用 jQuery 方法而无需再次使用 $ 引用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T16:19:44.300

不，您已经传递了一个 jQuery 对象，因此无需重新包装。但是由于 jQuery 事件处理程序`this`在回调中分配元素，所以你可以像这样写得更干净：

```
$('input').click(foo);

function foo() {
    /* do something with this.. */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:19:46.000

不，您可以从其引用中再次使用该对象，无需重新选择。

# php - PHP 中的正则表达式捕获组

> ID：14857946
> 
> 赞同：1
> 
> 时间：2013-02-13T16:16:13.910
> 
> 标签：php, regex, capture-group

我在这里有点超出我的深度，但我试图让用户编写链接，这与 StackOverflow 格式化链接的方式完全不同。

理想情况下，当用户输入`[text to link here][23]`文本区域时，他们最终会得到`<a href="path/to/img/id/23">text to link here</a>`该信息从数据库写入页面的时间。

我失败的部分是如何从匹配的模式中提取`text to link`和提取`23`

这是[我正在使用的模式](http://regexpal.com/?flags=g&regex=%5C%5B%5Ba-zA-Z0-9%5C-%20%5D%2b%5C%5D%5C%5B%5B0-9%5D%2b%5C%5D&input=Cras%20enim%20mi,%20vulputate%20in%20mollis%20non,%20accumsan%20et%20enim.%20Nulla%20%5Bthe%20link%20goes%20here%5D%5B2%5D%20scelerisque%20gravida%20erat,%20eleifend%20dapibus%20eros%20pulvinar%20at.%20Sed%20a%20magna%20id%20lectus%20tristique%20ultricies.%20Vivamus%20commodo%20lobortis%20dolor,%20ac%20commodo%20velit%20bibendum%20a.%20Sed%20quis%20nibh%20id%20libero%20gravida%20convallis%20a%20sit%20amet%20eros.%20Praesent%20non%20mattis%20eros.%20Mauris%20odio%20sem,%20sodales%20vitae%20adipiscing%20ac,%20volutpat%20sed%20risus.%20Maecenas%20ultricies%20feugiat%20velit,%20eget%20sollicitudin%20eros%20feugiat%20ut.%20Nam%20blandit%20ipsum%20ac%20libero%20aliquet%20sed%20molestie%20neque%20dictum.%20Nullam%20nec%20nunc%20nunc.)，但是`preg_replace`使用它只会让我替换整个字符串，而不是对其进行操作。我可能在使用 preg_replace 时弄错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:20:19.497

您可以使用 进行操作`preg_replace_callback`，但即使这样也是不必要的：

```
preg_replace('/\[(.+?)\]\[(\d+)?\]/', '<a href="path/to/img/id/\2">\1</a>', $st); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:20:51.397

这似乎是您正在寻找的技巧： ([[a-zA-Z0-9- ]+])([[0-9]+]) 括号 ( 和 ) 用于分组...

# ios - 使用 NSOutputStream 发送推送通知返回 -9844

> ID：14857951
> 
> 赞同：0
> 
> 时间：2013-02-13T16:16:29.873
> 
> 标签：ios, macos, push-notification

我正在尝试使用 NSStreams 编写发送推送通知的 OS X 应用程序。一切似乎都很好，但是当我将数据发送到 gateway.sandbox.push.apple.com 时，我得到了错误 -9844。来自 SecureTransport.h

```
errSSLConnectionRefused     = -9844,    /* peer dropped connection before responding */ 
```

这就是我创建和打开输出流的方式：

```
CFStreamCreatePairWithSocketToHost(NULL, (__bridge CFStringRef)@"gateway.sandbox.push.apple.com", 2195, &readStream, &writeStream);
self.outputPushStream = (__bridge_transfer NSOutputStream *)writeStream;
[self.outputPushStream setProperty:NSStreamSocketSecurityLevelNegotiatedSSL                                forKey:NSStreamSocketSecurityLevelKey];
self.outputPushStream.delegate = self;
[self.outputPushStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];
[self.outputPushStream open]; 
```

在 NSStream 委托中接收到 NSStreamEventOpenCompleted 事件后，我发送数据：

```
const uint8_t *data = pushData.bytes;
[self.outputPushStream write:data maxLength:pushData.length]; 
```

我猜这可能是证书的一些问题。我在钥匙串中有用于推送通知的开发证书和密钥。我对 SSL 或 NSStream 没有任何经验，所以我真的不知道下一步该往哪里看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:26:14.623

我不确定钥匙串中的证书是否足以`CFStreamCreatePairWithSocketToHost`建立 ssl 连接。我发现[这段](https://github.com/Ishaangandhi/PushController/blob/master/PushController/PushControllerAppDelegate.m)代码与您想做的几乎相同，但它通过代码传递证书（请参阅`configureStreams`和`certificateArray`方法）。

# javascript - Processing.js 提高绘图性能

> ID：14857952
> 
> 赞同：0
> 
> 时间：2013-02-13T16:16:34.073
> 
> 标签：javascript, performance, canvas, processing.js

我用来`processing.js`在`canvas`.

如果我在画布上绘制超过 100-200 个不断移动的圆圈，则 FPS 会显着下降。如果我删除绘图，FPS 会回到 60，因此其他任务不会影响 FPS。

```
fill(mR,mG,mB);
ellipse(mX,mY,mRadius,mRadius); 
```

例如，我知道对于复杂的形状，您可以将它们绘制到内存中的另一个画布上以缓存它们，然后简单地将该画布绘制到主画布上。

有什么办法可以提高这种绘图性能吗？

一些可能有帮助的链接：http:
[//www.html5rocks.com/en/tutorials/canvas/performance/](http://www.html5rocks.com/en/tutorials/canvas/performance/)
[http://ramkulkarni.com/blog/improving-animation-performance-in-html5-canvas-part-ii/](http://ramkulkarni.com/blog/improving-animation-performance-in-html5-canvas-part-ii/)

但是我不能在我的上下文中使用这些，或者将它们与 Processing.js 集成。

编辑：实际上它看起来可以在 fps 开始下降之前处理 ~1000 个形状。在 i5 处理器和 GTX660 gpu 上启用 GPU 渲染的 Google Chrome 上进行了测试。

[http://jsfiddle.net/Lfmfz/2/](http://jsfiddle.net/Lfmfz/2/)

我想这已经很不错了，但是有什么办法可以挤出一些额外的 FPS 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-10T20:07:16.957

1.  **确保您使用 for 循环或类似的东西来渲染这些形状。**如果你不这样做，自然会慢一些。
2.  **如果您可以在不调用 fill every ellipse 的情况下逃脱，那将改善运行时间。**如果可以的话，试着把所有的红色形状放在一起，把所有的蓝色形状放在一起，等等。
3.  **摆脱不必要的计算。**例如，如果您将`ellipse()`s 通过`random()`计算或`new Random(1)`and`nextGaussian()`一起定位（最后一个*非常*慢），则创建局部变量或`Math.random()`单独使用（据我所知，这似乎更快）。
4.  **您*可以*使用抗锯齿 imageData，但并非所有设备都支持。**我使用它，但我不确定 HTML 上的运行时，所有那些 for 循环可能会变得相当……混乱。

**TL;DR**
不要使用太多的计算，不要做任何多余的事情，*特别是*不要一遍又一遍地一遍又一遍地调用椭圆，一遍又一遍，一遍又一遍……没有迭代。

# numbers - 图灵机 - 生成数字序列

> ID：14857966
> 
> 赞同：1
> 
> 时间：2013-02-13T16:17:34.890
> 
> 标签：numbers, sequence, turing-machines

[http://morphett.info/turing/turing.html](http://morphett.info/turing/turing.html)

我将如何创建一个循环数字序列，例如：

01011011101111011111...

所以基本上添加一个零，然后添加 1，然后添加一个零，然后在之前的数量上添加 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:35:27.330

写`01`在磁带上。向右移动一格。如果您正在查看零，请向左扫描，直到您看到零。向右移动一格。如果您正在查看 1，请将其替换为 2，然后向右移动直到看到 0；然后继续向右移动，直到你又一个零。将此零替换为一。然后，向后移动，直到看到两个。用一个替换两个。向右移动一个；如果您正在查看一个，请重复替换为两个并再次返回的过程。最终，您将耗尽之前的 1，因此当您向右移动 1 时，您看到的是 0。在这种情况下，向右移动到下一个零，并将其替换为一。循环整个过程（减去“写入`01`部分”）以获得更长的字符串。

这背后的直觉很简单。如果您向右移动并看到一个零，则向左移动两个零，复制您找到的零之后的最后一个零和倒数第二个零之间的所有 1，然后再添加一个。这两个用于跟踪您在复制的字符串中的位置。基本思想是合理的，但是您应该尝试为此写出状态和转换以使其严谨。

例子：

```
>
^
>0
 ^
>01
  ^
>010
   ^
>010
 ^
>010
  ^
>020
   ^
>0200
    ^
>0201
   ^
>0201
  ^
>0101
   ^
>0101
    ^
>01010
     ^
>010110
      ^ 
```

# netbeans - 在 Netbeans 中升级 eclipselink 2.4

> ID：14857967
> 
> 赞同：4
> 
> 时间：2013-02-13T16:17:36.263
> 
> 标签：netbeans, eclipselink

嗨，我将 Eclipse 链接升级到 2.4。但我得到了这个输出。我担心这条消息：“（Eclipse Persistence Services - 2.3.0.v20110604-r9504）”

这是否意味着我再次使用 2.3 库？

```
In-place deployment at /Users/danielrojas/Dropbox/ToursysFunctional/build/web
Initializing...
deploy?DEFAULT=/Users/danielrojas/Dropbox/ToursysFunctional/build/web&name=Toursys&     contextroot=/Toursys&force=true failed on GlassFish Server 3.x 
Error occurred during deployment: Exception while preparing the app : Exception    [EclipseLink-28018] (Eclipse Persistence Services - 2.3.0.v20110604-r9504):    org.eclipse.persistence.exceptions.EntityManagerSetupException
Exception Description: Predeployment of PersistenceUnit [WebApplication1PU] failed.
Internal Exception: Exception [EclipseLink-7220] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.ValidationException
Exception Description: The @JoinColumns on the annotated element [field userRoles] from the entity class [class jpa.Users] is incomplete. When the source entity class uses a composite primary key, a @JoinColumn must be specified for each join column using the @JoinColumns. Both the name and the referencedColumnName elements must be specified in each such @JoinColumn.. Please see server.log for more details.
/Users/danielrojas/Dropbox/ToursysFunctional/nbproject/build-impl.xml:1035: The module has not been deployed.
See the server log for details.
BUILD FAILED (total time: 2 seconds) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-28T01:01:29.563

是的，这意味着您使用的是旧版本。您可能错过了一个罐子或忘记删除旧罐子。

以下是如何在 Glassfish 中更新 EclipseLink 的简短分步说明：

1.  [从http://www.eclipse.org/eclipselink/downloads/](http://www.eclipse.org/eclipselink/downloads/)下载 EclipseLink OSGI Bundle 。当前版本是 2.5.1，您要下载的文件是`EclipseLink 2.5.1 OSGi Bundles Zip (19 MB)`
2.  转到 `$GLASSFISH_HOME/glassfish/modules`并删除以下文件：

    *   org.eclipse.persistence.antlr.jar
    *   org.eclipse.persistence.jpa.jar
    *   org.eclipse.persistence.asm.jar
    *   org.eclipse.persistence.jpa.modelgen.jar
    *   org.eclipse.persistence.core.jar
    *   org.eclipse.persistence.oracle.jar
    *   javax.persistence.jar
3.  `org.eclipse.persistence`打开下载的 ZIP 文件并提取以但不包含开头的所有内容`source`（这些是源，您可能不需要它们）并将文件提取`javax.persistence_2xxx.jar`到文件夹`$GLASSFISH_HOME/glassfish/modules`

4.  重新启动 Glassfish，您就完成了。

# iphone - 在类似拨号器的视图中星号太小

> ID：14857968
> 
> 赞同：4
> 
> 时间：2013-02-13T16:17:35.703
> 
> 标签：iphone, ios, ios6

我正在尝试创建一个类似拨号器的应用程序：

![我的拨号器](../Images/e30b8f795f1ae5769e4f2e0b0abcfa96.png)

我正在使用`[UIFont systemFontOfSize:33]`. 问题是星号符号与数字和“#”相比太小了。

我在所有 61 种可用的 iOS6 字体中打印了 123*#，并且星号比所有字体中的其他字符都小。

有人知道如何解决这个问题吗？

我尝试过的一件事是仅更改 * 按钮的字体大小。这行得通，但是当我点击这个按钮时，它在上面的输入中显得很小 [off course] ...

希望我的问题很清楚。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T16:33:57.890

使用不同的字符进行显示。在 Xcode 中，单击编辑菜单并选择特殊字符。当字符查看器出现时，在搜索字段中输入“星号”。尝试许多其他相关符号之一。

根据您执行此操作的方式，您可能需要在内部将使用的符号替换为适当的星号，以在`tel`URL 中使用结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:18:48.343

您可以使用属性字符串并将字体大小更改为足够大的所有星号

# javascript - 如果我点击它之外的任何地方，我想让我的 div 隐藏，我该如何在 jQuery 中做到这一点？这个 SO 解决方案让我感到困惑

> ID：14857971
> 
> 赞同：-1
> 
> 时间：2013-02-13T16:17:49.177
> 
> 标签：javascript, jquery, html, css

[当用户在 DIV 外部单击时，使用 jQuery 隐藏 DIV](https://stackoverflow.com/questions/1403615/use-jquery-to-hide-a-div-when-the-user-clicks-outside-of-it)

我很想使用它，因为它似乎有很好的评论，但我不确定它到底是做什么的。有人可以解释一下吗？我知道`.has()`返回具有给定子元素的元素，但是该函数如何使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T16:46:39.440

这是另一个问题[的答案中的代码：](https://stackoverflow.com/a/7385673/552438)

```
$(document).mouseup(function (e)
{
    var container = $("YOUR CONTAINER SELECTOR");

    if (container.has(e.target).length === 0)
    {
        container.hide();
    }
}); 
```

您需要知道的第一件事是浏览器中的事件是如何工作的。在大多数情况下，它们从最初触发事件的元素一直“冒泡”，通过其祖先元素，一直到文档本身。这个过程称为事件传播。

所以，如果你有这个 HTML：

```
<body>
    <div>
        <a href="#">Click me!</a>
    </div>
</body> 
```

然后点击`<a>`元素，事件会被那个`<a>`元素触发，但是冒泡到`<div>`，然后到`<body>`，再到`<document>`。

如果将事件处理程序绑定到`document`，那么单击锚点仍将触发该事件处理程序函数，因为事件会冒泡并最终由文档处理。这就是上面代码的基本原理。

现在，让我们看看实际的事件处理函数。您只有一个参数 ，`e`即事件本身。该对象有一个属性，`target`即最初触发事件的元素。

回到我们简单的 HTML 示例，如果您单击`<a>`元素，则该元素`e.target`将成为该锚点，即使在文档级别处理事件也是如此。这与`this`jQuery 事件处理函数内部不同，后者将是处理事件的元素（在本例中为`document`）。

第一行非常简单——它只是选择了你想忽略其中的点击的元素。

该`if`语句有点棘手，但它本质上是在说“如果最初触发此事件的元素不是我们容器的后代，则隐藏我们的容器”。

该`container.has(e.target)`部分正在检查“是在我们的容器内触发事件的元素吗？”。如果答案是“是”，那么该`length`属性将大于`0`（准确地说，这是`1`因为我们从一个包含单个元素的 jQuery 对象开始）。

如果答案是“否”，则`length`属性将等于`0`。由于这是我们真正想要检查的内容，因此我们将`length`属性与`0`我们的`if`条件进行比较。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T16:31:30.713

看看这段代码：

```
if ($(".myClass").length === 0){
  //Do stuff
} 
```

这将检查返回的 jQuery 对象是否包含任何元素。`.length`将返回元素的数量。因此，如果对象为空，检查长度是否等于 0 将为我们提供一个布尔值。

同样，您可以执行以下操作来做相反的事情

```
if ($(".myClass").length > 0){
  //Do stuff
} 
```

此外，由于大于 0 的数字将评估为`true`，而 0 将评估为，`false`因此您可以将其简化为：

```
if ($(".myClass").length){
  //Contains elements
}else{
  //No elements
} 
```

# c# - 使用 JSON 和 JQuery 将数组发布到 C# Web Api 后端

> ID：14857977
> 
> 赞同：2
> 
> 时间：2013-02-13T16:18:06.180
> 
> 标签：c#, ajax, json, asp.net-web-api

我有以下 JQuery：

```
var dataToSend = {
    list: [{ Code: 'ABC', BusinessDate: '31-Jan-2012' }, { Code: 'DEF', BusinessDate: '31-Jan-2012' }]    
};

$.ajax({
    type: 'POST',
    traditional: true,
    url: '/api/dashboard/post/',
    dataType: 'json',
    data: JSON.stringify( dataToSend), 
    success: function (result) {
        alert('done');
    },
    error: function (result) {
        alert(result);
    }
}); 
```

以及服务器上的以下方法：

```
 [System.Web.Http.HttpPost]
        public void Post(List<MyObject> list)
        {

        } 
```

MyObjects 定义：

```
public class MyObject
{

    /// <summary>
    /// 
    /// </summary>
    public string Code { get; set; }

    /// <summary>
    /// 
    /// </summary>
    public string BusinessDate { get; set; }

} 
```

该方法被命中，但在集合中没有显示任何结果。如果我将参数更改为：

```
 [System.Web.Http.HttpPost]
        public void Post(MyObject list)
        {
           // return new JsonResult();
        } 
```

并且只通过集合中的第一项，我在 web api 方法中接收到带有数据的对象没有问题，只有在尝试传递数组时我似乎有问题。

Fiddler 将其显示为 JSON：

> {"list":[{"Code":"ABC","BusinessDate":"31-Jan-2012"},{"Code":"DEF","BusinessDate":"31-Jan-2012"}] }

有人可以解释一下我做错了什么，所以我无法接收数组吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:29:39.533

您的 JSON 发送的内容本质上是这样的：一个具有名为 list 的属性的对象，然后其中包含一个对象列表。您有一个不必要的重定向。尝试`list:`从您发送的数据中删除 并直接将列表作为参数发送。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T16:32:07.407

添加你的标题。`content-type :application/json`

这应该有效。

# javascript - Chrome 和 Jquery 的奇怪行为

> ID：14857982
> 
> 赞同：0
> 
> 时间：2013-02-13T16:18:25.260
> 
> 标签：javascript, jquery, google-chrome, cross-browser

我必须创建一个显示 2 个表格的简单 jsp 页面。已经有一个生成表格的jsp页面，所以我只需要用不同的参数调用页面并将结果加载到不同的div中。

我尝试的第一件事是调用 2 个 JQuery 负载：

```
$(function() {
    $("#res_05").load("tableGenerator.jsp", 
        {
            "RESOURCE_NAME": "<%= resName1 %>",
        },
        function(responseText, textStatus, XMLHttpRequest) {
            var firstTable = $("#res_05 table table").first();

            $("#res_05").html(firstTable);
            $("<h1> Resource <%= resName1 %> </h1>").insertBefore("#res_05 table");
    });

    $("#res_15").load("tableGenerator.jsp", 
            {
                "RESOURCE_NAME":"<%= resName2 %>",
            },
            function(responseText, textStatus, XMLHttpRequest) {
                var secondTable = $("#res_15 table table").first();

                $("#res_15").html(secondTable);
                $("<h1> Resource <%= resName2 %> </h1>").insertBefore("#res_15 table");
    });
}); 
```

这个简单的页面可以在 Firefox 甚至 Internet Eplorer 8 中运行，但在 Chrome 中它的行为方式很奇怪：它只显示第一个表。

在第一次尝试之后，我在增加更多复杂性之前将负载集中在一个函数中。所以脚本变成了这样：

```
$(function() {
    loadTable("res_05", "<%= resName1 %>");

    loadTable("res_15", "<%= resName2 %>");
});

function loadTable(divName, resName) {
        $("#" + divName).load("tableGenerator.jsp",
            {
                "RESOURCE_NAME": resName,
            },
            function(responseText, textStatus, XMLHttpRequest) {
                var firstTable = $("#" + divName + " table table").first();

                $("#" + divName).html(firstTable);
                $("<h1> Resource " + resName + "</h1>").insertBefore("#" + divName + " table");
        });
} 
```

在此更改之后，该页面适用于所有浏览器，即使使用 Chrome。

看起来这可能是由 Chrome 的错误 javascript 解释引起的，但使用 JQuery 这应该是一种罕见的情况。毕竟它甚至可以在 IE 8 上运行，我没想到 Chrome 会出现这样的行为。

我不是 JQuery 方面的专家，所以如果不是浏览器问题，我想了解在这种情况下会发生什么。

# .net - 如何为 >= Vista 自定义 FileOpen 对话框？

> ID：14857984
> 
> 赞同：13
> 
> 时间：2013-02-13T16:18:30.847
> 
> 标签：.net, wpf, winforms, windows-7, openfiledialog

我正在寻找`OpenFileDialog`使用自定义 WinForms 和 WPF 控件自定义 Vista 类。我知道您可以将[类似 XP 的 OpenFileDialog](http://www.codeproject.com/Articles/19566/Extend-OpenFileDialog-and-SaveFileDialog-the-easy)模板化，但这看起来很丑陋并且不能满足我的要求。我知道您可以`OpenFileDialog`使用[Ookii](https://github.com/ookii-dialogs)对话框或[Microsoft 的 API Code Pack](http://archive.msdn.microsoft.com/WindowsAPICodePack)自定义。这种方法的问题是它们不允许自定义控件，只允许有限的控件子集（`Label`、`TextBox`等）。

我得到的最接近的是下图。使用 API 代码包的组合，对 Shell 进行一些更改，为间距添加空标签的黑客工作，以及一堆丑陋的 COM 直接在 OpenFileDialog 上绘制控件，我能够接近。

这种方法的问题是我必须在 WndProc 中禁用重新调整大小，因为其中的控件部分`CommonOpenFileDialog`具有流/换行布局，并且您无法在重新调整大小时动态添加/删除控件，否则如果出现灾难性故障OpenFileDialog 已经显示。

除了我尝试过的或任何第三方产品，是否有任何建议可以作为标准的类似 Vista 的 OpenFileDialog 但允许插入自定义控件？

[![](../Images/62e144cd0861ee4044e2e83af3e8f606.png)

我还尝试使用 API 代码包中的 ExplorerBrowser（如下图所示）滚动我自己，但尽管梳理了 COM API，但似乎没有一种方法可以在 ExplorerBrowser 中定义过滤器。

[![](../Images/02ea2b225147fbc98b68d5cfd4342f89.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-10-08T14:58:05.027

使用 WPF 和 XAML 可以轻松地从头开始编写这类事情。如有必要，可以使用您想要的简单子组件的控件。

如果您尝试修改现有的文件对话框，您将受到限制，并且可能会在以后碰壁。

# ruby-on-rails-3 - 如何在葡萄 api 应用程序中拆分内容？

> ID：14857987
> 
> 赞同：14
> 
> 时间：2013-02-13T16:18:37.497
> 
> 标签：ruby-on-rails-3, api, grape-api

在我看到的每个示例中，人们只实现了一个巨大的 api.rb 文件。前任：

*   [intridea/葡萄](https://github.com/intridea/grape)
*   [bloudraak/grape-sample-blog-api](https://github.com/bloudraak/grape-sample-blog-api/blob/master/app/api/blog/api.rb)
*   [djones/grape-goliath-example](https://github.com/djones/grape-goliath-example/blob/master/app/apis/posts.rb)

虽然这种方法可以正常工作，但它很快就会变得拥挤且难以维护，所以我想在我的应用程序上拆分内容。

例如，我想从我的资源中拆分我的实体，然后在不同的文件之间拆分我的资源。举些例子：

```
app
 - api
   api.rb
   - entities
     - weblog.rb
     - post.rb
     - comment.rb
   - resources
     - weblog.rb
     - post.rb
     - comment.rb 
```

现在，**api.rb**将类似于：

```
require 'grape'
module Blog
  class API < Grape::API
    prefix "api"
  end
end 
```

**app/api/entities/post.rb**将类似于：

```
module Blog
  module Entities
    class Post < Grape::Entity
      root 'posts', 'posts'
      expose :id
      expose :content
    end
  end
end 
```

**app/api/resources/post.rb**将类似于：

```
module Blog
  class API < Grape::API
    resource :posts do
      get do
        present Post.all, with: Blog::Entities::Post
      end

      desc "returns the payment method corresponding to a certain id"
      params do
        requires :id, :type => Integer, :desc => "Post id."
      end
      get ':id' do
        present Post.find(params[:id]), with: Blog::Entities::Post
      end
    end
  end
end 
```

当我们这样做时，我们会遇到以下消息：

> 预期 /blog-app/api/resources/post.rb 来定义 Post

* * *

**解决方案（感谢 dB。和我的同事）**

您必须将结构更改为：

```
app
 - api
   api.rb
   - resources
     - post_api.rb 
```

然后，在**post_api.rb**

```
module Blog
  class Resources::PostAPI < Grape::API
    resource :posts do
      get do
        present Post.all
      end
    end
  end
end 
```

最后，**api.rb**变为：

```
require 'grape'
module Blog
  class API < Grape::API
    prefix 'api'
    version 'v1', :using => :path
    format :json

    mount Blog::Resources::PostAPI => '/'
  end
end 
```

现在`/api/v1/posts`应该工作:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T17:35:26.310

post.rb 中的类应该是 Post，而不是 API。然后你可以在类 API 中挂载 Post API。

```
class API < Grape::API
  mount Blog::Post => '/'
end 
```

为避免混淆，我也会将 Post 放在 Resources 命名空间中，或者将其重命名为 PostAPI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-23T16:34:52.650

我发现它不适用于路径前缀：

```
mount Blog::Post => '/blog' 
```

如果您想为路径添加前缀，则不起作用。

采用

```
namespace :blog do
   mount Blog::Post
end 
```

希望能帮助到你！

# java - NumberFormat.getCurrencyInstance(); 失败

> ID：14857994
> 
> 赞同：3
> 
> 时间：2013-02-13T16:19:07.560
> 
> 标签：java, number-formatting

我正在尝试使用 NumberFormat.getCurrencyInstance(); 将我的货币字符串解析为 bigdecimal；

```
The following scenario
$1,000.01 Pass
1000.01 Pass
1,000.01 Fail -> This needs to be parsed to 1000.01 in order to pass.
abc Fail -> correct behavior. 
```

我的方法

```
 public BigDecimal parseClient(Field field, String clientValue, String message) throws ValidationException {
        if (clientValue == null) {
            return null;
        }

        NumberFormat nf = NumberFormat.getCurrencyInstance();
        try {
            return new BigDecimal(nf.parse(clientValue).toString());
        } catch (ParseException ex) {
            throw new ValidationException(message);
        }
    } 
```

有人知道一个很好的解决方案来让它正常工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:31:33.183

这是相当蛮力的，但为什么不检查字符串开头是否存在货币字符，如果不存在，则在前面添加它？

```
if ( !clientValue.startsWith( "$" ) )
{
   clientValue = "$" + clientValue;
} 
```

如果不需要蛮力方法，则下一个方法是记录客户端可以进入该方法的每种格式。然后，创建处理这些传入输入格式所需的尽可能多的 DecimcalFormat 实例，并允许对它们进行解析。

另一种方法是将传入的 clientValue 标准化为单一格式。这可以通过字符串操作和正则表达式来完成。但是，您仍然需要了解传入的 clientvalue 可以进入方法的所有不同方式。所以需求在这里非常重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:39:27.030

尝试使用此构造函数：

```
public static NumberFormat getCurrencyInstance(Locale inLocale) 
```