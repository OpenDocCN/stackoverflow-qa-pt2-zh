# StackOverflow 问答 14242000-14242999

# c# - Office 插件 - 以编程方式导入 *.exportedUI 设置文件

> ID：14242005
> 
> 赞同：6
> 
> 时间：2013-01-09T16:40:57.393
> 
> 标签：c#, excel, vsto, ms-office

`*.exportedUI`是否可以在插件启动时导入现有文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-02T23:07:53.923

我认为没有任何导入功能。

[http://social.msdn.microsoft.com/Forums/vstudio/en-US/b2830e72-9f78-4d4d-8f39-af14bfb991c8/office-addin-programmatically-import-exportedui-settings-file](http://social.msdn.microsoft.com/Forums/vstudio/en-US/b2830e72-9f78-4d4d-8f39-af14bfb991c8/office-addin-programmatically-import-exportedui-settings-file)

# c - C 编译器和循环优化

> ID：14242008
> 
> 赞同：8
> 
> 时间：2013-01-09T16:41:02.407
> 
> 标签：c, optimization

对于编译器如何实际优化以及不同级别之间的区别（例如 gcc 的 -O2 与 -O3 ），我没有很多经验。因此，我不确定以下两个语句对于任意编译器是否等效：

```
for(i=0;i<10;++i){
variable1*variable2*gridpoint[i];
} 
```

和

```
variable3=variable1*variable2;
for(i=0;i<10;++i){
variable3*gridpoint[i];
} 
```

从处理时间的角度来看，只计算一次 variable1 和 variable2 的乘积是有意义的，因为它们在循环中不会改变。然而，这需要额外的内存，而且我不确定优化器对这种开销的影响有多大。如果你有一个来自纸/书的方程并且想要将它翻译成计算机可读的东西，第一个表达式是最容易阅读的，但第二个可能是最快的 - 特别是对于循环内有很多不变变量的更复杂的方程（我有一些非常讨厌的非线性微分方程，我希望在代码中可读）。如果我将变量声明为常量，这会发生任何变化吗？我希望我的问题对任意编译器有意义，因为我同时使用 gcc、Intel 和 Portland 编译器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:47:23.400

对于任意编译器来说，很难充分回答这个问题。这段代码能做什么不仅取决于编译器，还取决于目标架构。我将尝试解释具有良好功能的生产编译器可以对这段代码做什么。

> 从处理时间的角度来看，只计算一次 variable1 和 variable2 的乘积是有意义的，因为它们在循环中不会改变。

你说的对。正如猫先生所指出的，这称为[公共子表达式消除](http://en.wikipedia.org/wiki/Common_subexpression_elimination)。因此，编译器可能会生成只计算一次表达式的代码（或者如果两个操作数的值一次都是常量，则甚至在编译时计算它）。

如果一个体面的编译器可以确定函数没有副作用，它也可以对函数执行子表达式消除。例如，如果函数体可用，GCC 可以分析函数，但也有`pure`和`const`属性可用于专门标记应接受此优化的函数（请参阅[函数属性](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)）。

鉴于没有副作用并且编译器能够确定它（在您的示例中，没有任何障碍），因此其中两个片段在这方面是等效的（我已经使用 clang 进行了检查 :-)）。

> 然而，这需要额外的内存，我不确定优化器在多大程度上考虑了这种开销。

事实上，这不需要任何额外的内存。乘法在[处理器寄存器](http://en.wikipedia.org/wiki/Processor_register)中完成，结果也存储在寄存器中。这是一个消除大量代码并使用单个寄存器来存储结果的问题，这总是很棒（而且在[寄存器分配](http://en.wikipedia.org/wiki/Register_allocation)方面肯定会让生活更轻松，尤其是在循环中）。因此，如果可以完成此优化，那么它将无需额外费用即可完成。

> 第一个表达式是最容易阅读的。

GCC 和 Clang 都将执行此优化。不过，我不确定其他编译器，所以你必须自己检查。但是很难想象任何没有进行子表达式消除的好的编译器。

> 如果我将变量声明为常量，这会发生任何变化吗？

它可能。这称为常量表达式——仅包含常量的表达式。可以在编译期间而不是在运行时评估常量表达式。因此，例如，如果您使用多个 A、B 和 C，其中 A 和 B 都是常量，编译器将`A*B`只针对该预先计算的值预先计算多个 C 表达式。如果编译器可以在编译时确定它的值并确保它没有被更改，那么编译器也可以使用非常量值来执行此操作。例如：

```
$ cat test.c
inline int foo(int a, int b)
{
    return a * b;
}

int main() {
    int a;
    int b;
    a = 1;
    b = 2;
    return foo(a, b);
}
$ clang -Wall -pedantic -O4 -o test ./test.c
$ otool -tv ./test
./test:
(__TEXT,__text) section
_main:
0000000100000f70    movl    $0x00000002,%eax
0000000100000f75    ret 
```

在上述代码片段的情况下，还可以进行其他优化。以下是其中一些想到的：

第一个最明显的是循环展开。由于迭代次数在运行时是已知的，编译器可能会决定[展开循环](http://en.wikipedia.org/wiki/Loop_unwinding)。是否应用此优化取决于架构（即，某些 CPU 可以“锁定循环”并比其展开版本更快地执行代码，这也通过使用更少的空间使代码对缓存更友好，避免额外的 µOP 融合阶段， ETC）。

第二个可以将速度提高 50 倍的优化是使用[SIMD](http://en.wikipedia.org/wiki/SIMD)指令（SSE、AVX 等）。例如，GCC 非常擅长（如果不是更好的话，英特尔也必须如此）。我已经验证了以下功能：

```
uint8_t dumb_checksum(const uint8_t *p, size_t size)
{
    uint8_t s = 0;
    size_t i;
    for (i = 0; i < size; ++i)
        s = (uint8_t)(s + p[i]);
    return s;
} 
```

... 被转换为一个循环，其中每个步骤一次对 16 个值求和（即在 中[`_mm_add_epi8`](http://msdn.microsoft.com/en-us/library/yc7tcyzs%28v=vs.80%29.aspx)），并带有额外的代码处理对齐和奇数 (<16) 迭代计数。然而，在我上次检查时，Clang 完全失败了。因此，即使不知道迭代次数，GCC 也可能会以这种方式减少您的循环。

如果可以的话，我想建议你不要优化你的代码，除非你发现它是一个瓶颈。否则，您可能会浪费大量时间进行错误和过早的优化。

我希望这回答了你的问题。祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:18:06.743

是的，您可以指望编译器在执行子表达式消除方面做得很好，即使是通过循环。这可能会导致内存使用量略有增加，但是任何体面的编译器都会考虑所有这些，而且执行子表达式消除几乎总是一种胜利（因为我们正在谈论的内存是寄存器和一级缓存）。

这里有一些快速测试也可以向自己“证明”它。结果表明，您基本上不应该尝试在手动消除子表达式时智取编译器，只需自然编写代码并让编译器做它擅长的事情（例如弄清楚哪些表达式应该真正消除，哪些不应该给出目标架构和周边代码。）

稍后，如果您对代码的性能不满意，您应该对代码进行分析，看看哪些语句和表达式占用的时间最多，然后尝试弄清楚您是否可以重新组织代码以帮助编译器出来，但我会说绝大多数时候它不会像这样简单，它会做一些事情来减少缓存停顿（即更好地组织你的数据），消除冗余的程序间计算，以及类似的东西那。

（FTR 在以下代码中使用随机数只是确保编译器不会过于热衷于变量消除和循环展开）

编1：

```
#include <stdlib.h>
#include <time.h>

int main () {
    srandom(time(NULL));
    int i, ret = 0, a = random(), b = random(), values[10];
    int loop_end = random() % 5 + 1000000000;
    for (i=0; i < 10; ++i) { values[i] = random(); }

    for (i = 0; i < loop_end; ++i) {
        ret += a * b * values[i % 10];
    }

    return ret;
} 
```

编2：

```
#include <stdlib.h>
#include <time.h>

int main () {
    srandom(time(NULL));
    int i, ret = 0, a = random(), b = random(), values[10];
    int loop_end = random() % 5 + 1000000000;
    for (i=0; i < 10; ++i) { values[i] = random(); }

    int c = a * b;
    for (i = 0; i < loop_end; ++i) {
        ret += c * values[i % 10];
    }

    return ret;
} 
```

结果如下：

```
> gcc -O2 prog1.c -o prog1; time ./prog1  
./prog1  1.62s user 0.00s system 99% cpu 1.630 total

> gcc -O2 prog2.c -o prog2; time ./prog2
./prog2  1.63s user 0.00s system 99% cpu 1.636 total 
```

（这里是测墙时间，所以不要注意0.01秒的差异，运行几次它们都在1.62-1.63秒的范围内，所以它们的速度是一样的）

有趣的是，在没有优化的情况下编译时 prog1 更快：

```
> gcc -O0 prog1.c -o prog1; time ./prog1  
./prog1  2.83s user 0.00s system 99% cpu 2.846 total

> gcc -O0 prog2.c -o prog2; time ./prog2 
./prog2  2.93s user 0.00s system 99% cpu 2.946 total 
```

也很有趣，编译`-O1`提供了最好的性能..

```
gcc -O1 prog1.c -o prog1; time ./prog1 
./prog1  1.57s user 0.00s system 99% cpu 1.579 total

gcc -O1 prog2.c -o prog2; time ./prog2
./prog2  1.56s user 0.00s system 99% cpu 1.563 total 
```

* * *

GCC 和 Intel 是很棒的编译器，并且非常聪明地处理这样的事情。我对 Portland 编译器没有任何经验，但这些都是编译器要做的非常基本的事情，所以如果它不能很好地处理这种情况，我会感到非常惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:43:09.727

如果我是编译器，我会认识到这两个循环都**没有**左操作数，也**没有任何**副作用（除了设置`i`为`10`），所以我会完全优化循环。

我并不是说这真的发生了。看起来它可能发生在您提供的代码中。

# java - GAE 会话在离线或在线时的行为不同

> ID：14242020
> 
> 赞同：0
> 
> 时间：2013-01-09T16:41:31.393
> 
> 标签：java, google-app-engine, session, servlets

我有这个代码：

```
private String delete(HttpServletRequest req, HttpServletResponse res, Seller seller) throws Exception {

    //check data
    if(req.getParameter("equipmentId") == null) {

    throw new Exception("equipmentId undefined");

}

//build
Equipment equipment = new Equipment(Integer.parseInt(req.getParameter("equipmentId")));

//delete
dbEquipment.delete(equipment);

//remove in array list
for(int i = 0; i < seller.getListEquipment().size(); i++) {

    if(seller.getListEquipment().get(i).getId() == equipment.getId()) {

        seller.getListEquipment().remove(i);

    }

}

//response
return "ok"; 
```

}

传递的卖家属性来自 HTTPSession : **((Seller) req.getSession().getAttribute("user"))**

此代码离线更新我的对象卖家很好，但在线更新不显示，它仍然是旧对象/ArrayList。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:36:47.990

Try saving object back into session after you update it's contents.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T16:56:59.277

在你的 appengine-web.xml 添加这一行：

```
<sessions-enabled>true</sessions-enabled> 
```

我不确定，但这对我来说是一个反复的错误。:P

此外，您需要确保要持久保存到会话的所有对象都实现了 java.io.Serializable 接口。对象需要可序列化的原因是 App Engine 将会话数据存储在数据存储区和内存缓存中。您放入会话中的值引用的任何对象都必须是可序列化的，因此整个对象图都是可用的。我发现有趣的是它必须以基于事务的方式提交会话数据，因为我还在会话中存储了一个字符串，并且它也没有持久化。如果对象不可序列化，则应用程序在本地开发机器中不会失败，但在部署到云时会失败。

来源：[http ://afewguyscoding.com/2011/02/httpsession-google-app-engine/](http://afewguyscoding.com/2011/02/httpsession-google-app-engine/)

# command-line - 使用 concordance=TRUE 从命令行切换

> ID：14242021
> 
> 赞同：11
> 
> 时间：2013-01-09T16:41:31.730
> 
> 标签：command-line, sweave

我有使用 LaTeX Beamer 模板的文档，并在实际文档的开头传递此代码

```
\usepackage{Sweave}
\begin{document}
\SweaveOpts{concordance=TRUE} 
```

该文档使用带有 R-2.15.2 的 RStudio (0.97.248) 编译得很好。完成合成后，为了确保可重复性，我喜欢从 cmd 文件生成整个分析（并使用 ghostscript 压缩 PDF）。相关部分是

```
R CMD Sweave MyDoc
pdflatex MyDoc
bibtex MyDoc
pdflatex MyDoc
pdflatex MyDoc 
```

这失败并显示错误消息

```
 ! LaTeX Error: File `MyDoc-concordance.tex' not found. 
```

这表明 Sweave 没有从命令行生成索引。找不到命令行开关，我的谷歌搜索没有帮助......我将不胜感激任何指针......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-01T20:10:57.107

通常，在命令行上解析最初在 RStudio 中创建的 .Rnw 文件时，您会遇到此问题。RStudio Sweave 模板`\SweaveOpts{concordance=TRUE}`在 .Rnw 文件中具有默认选项。

这似乎是 Sweave 没有[引起太多关注](https://tex.stackexchange.com/questions/51621/adjust-line-numbers-in-error-messages)的问题。有时我在命令行上工作时会遇到这种情况，我发现的唯一解决方法是设置：

```
\SweaveOpts{concordance=FALSE} 
```

在文件本身中，删除所有临时乳胶，然后`R CMD Sweave`再次运行以创建一个新的 .tex 文件。生成的文件将与`pdflatex`或一起使用`xelatex`。

显然，无法将索引文件的请求传递给 Sweave（我尝试过`R CMD Sweave MyDoc.Rnw --options=concordance=TRUE`，正如我在评论中提到的那样）。

# git - git-svn 多个 git 存储库到同一个 svn 存储库

> ID：14242025
> 
> 赞同：0
> 
> 时间：2013-01-09T16:41:38.600
> 
> 标签：git, svn, git-svn

我有两个独立的 git 存储库 - git1 和 git2。由于导师的建议，我需要将它们复制到大学的 svn 存储库，以便所有 git repo 贡献者可以同时更新大学 SVN 存储库和 git 存储库。

git-svn 看起来是一个很好的解决方案。[我按照将现有 git 存储库推送到 SVN](https://stackoverflow.com/questions/661018/pushing-an-existing-git-repository-to-svn)中的最佳答案中的说明进行操作，并且能够链接一个 git 存储库。是否可以将两个 git 存储库链接为同一个 svn 存储库中的两个文件夹？

文件夹结构可能如下所示：

*   SVN-repo
    *   project1 #使用 git-svn 链接 git1
        *   树干
        *   分支机构
        *   标签
    *   project2 #links git2 使用 git-svn
        *   树干
        *   分支机构
        *   标签

有人可以指出如何实现这一目标吗？指出一些实际的说明可能会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T18:27:24.290

万一有人面临同样的问题，我在这里指出我的解决方案。

我能够通过在具有标准结构（主干、分支和标签）的 SVN 存储库中创建两个项目，然后使用 git-svn 将每个 git 存储库链接到一个 SVN 项目来实现这一点。确切的指令集可以从我的博客文章中看到：http: [//lookupnotes.blogspot.com/2013/01/git-to-svn.html](http://lookupnotes.blogspot.com/2013/01/git-to-svn.html)

# python - 在类中使用 super()

> ID：14242033
> 
> 赞同：3
> 
> 时间：2013-01-09T16:42:04.560
> 
> 标签：python, oop

我正在尝试以这种方式将 super() 用于简单的类层次结构：

```
class Employee(object):
    def __init__(self, name):
        self.name = name

class FullTime(Employee):
    def __init__(self, name, satOff, freeDays=[], alDays=[], programDays=[]):
        global satsOffDict
        global dayDict
        super(Employee, self).__init__(name) 
```

但是，我收到此错误：

```
TypeError: object.__init__() takes no parameters 
```

我读过您需要创建父对象类型对象（新样式类）才能使 super 工作。如果我将 Employee(object) 类更改为 Employee() 类，我会收到以下错误：

```
TypeError: must be type, not classobj 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T16:43:24.017

您使用*当前*类`super()`：

```
super(FullTime, self).__init__(name) 
```

`super()`查找相对于第一个参数的请求方法；相反，您开始搜索`Employee`，寻找父类；`object.__init__()`是在这种情况下匹配的下一个父方法。

需要使用当前类，因为 Python 需要按[Method Resolution Order](http://www.python.org/download/releases/2.3/mro/)搜索基类；该排序取决于您当前的类是如何从它的基类派生的（特别是如果存在多重继承或基类最终被多次引用）。

在 Python 3.x 上，您可以`super()`不带任何参数使用，[编译器将为您的方法添加额外的提示，](http://docs.python.org/3/reference/datamodel.html#creating-the-class-object)以便它可以确定要从哪个正确的类开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T16:43:45.747

当您`super`在 Python 中使用时，您应该指定*派生*类型（即，您在其中编写调用的类）作为第一个参数。

```
super(FullTime, self).__init__(name) 
```

# r - R 在调用 Plot 函数列表时出现语法错误

> ID：14242034
> 
> 赞同：0
> 
> 时间：2013-01-09T16:42:10.137
> 
> 标签：r, list, plot, syntax-error

我有一个列表，我想将内容放在情节代码中，但我遇到了这个错误：

```
Error: object 'pl29' not found 
```

此外，相应的代码是：

```
Pl29 <- list(HMn25_29,HMn28_29)
par(mfrow=c(2,2))
for ( i in pl29) {
  plot(i, type = "o", pch = 22, lty = 2, col = "Black", xlab = "Hour  2007/09/29" , ylab = "Ambient Tempreture")
} 
```

样本数据是：

```
(HMn25_29)
                    h   avg_val
1 2007-09-29 00:00:00 -1.876667
2 2007-09-29 01:00:00 -1.693667
3 2007-09-29 02:00:00 -1.766667
4 2007-09-29 03:00:00 -1.928667
5 2007-09-29 04:00:00 -2.132581
6 2007-09-29 05:00:00 -1.752258

      (HMn28_29)
                    h   avg_val
1 2007-09-29 00:00:00 -1.922500
2 2007-09-29 01:00:00 -1.667667
3 2007-09-29 02:00:00 -1.582000
4 2007-09-29 03:00:00 -1.571667
5 2007-09-29 04:00:00 -1.829000
6 2007-09-29 05:00:00 -1.615333 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:43:01.050

R 区分大小写，`Pl29`第二次忘记大写：

```
Pl29 <- list(HMn25_29,HMn28_29)  # capitalized: Pl29
par(mfrow=c(2,2))
for ( i in pl29)  # not capitalized: pl29 
```

# java - Log4j 突然停止记录

> ID：14242035
> 
> 赞同：14
> 
> 时间：2013-01-09T16:42:13.187
> 
> 标签：java, log4j, websphere

我正在构建一个部署到在 Linux 上运行的 WebSphere Portal Server 的 Portlet 应用程序。每个 Portlet WAR 都使用 Log4j 进行日志记录，配置如下，每个 WAR 都有两个日志文件：

```
log4j.logger.im.the.package=DEBUG, InfoAppender, DebugAppender

log4j.appender.InfoAppender=org.apache.log4j.RollingFileAppender
log4j.appender.InfoAppender.Threshold=INFO
log4j.appender.InfoAppender.File=/tmp/infoWARName.log
log4j.appender.InfoAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.InfoAppender.layout.ConversionPattern=%d %p [%c] - %m%n

log4j.appender.DebugAppender=org.apache.log4j.RollingFileAppender
log4j.appender.DebugAppender.Threshold=DEBUG
log4j.appender.DebugAppender.File=/tmp/debugWARName.log
log4j.appender.DebugAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.DebugAppender.layout.ConversionPattern=%d %p [%c] - %m%n 
```

部署后，一切都像魅力一样工作，日志文件开始填充。几个小时后，同时，记录停止并且`info.log`根本`debug.log`没有更新。我们需要在服务器中重新部署 Portlet WAR 以重新开始记录。

有任何想法吗？

**更新：**

我开始怀疑这与我的 Logging JARS 有关。目前，这是我`WEB-INF/lib`文件夹中的 JAR：

```
com.springsource.org.apache.commons.logging-1.1.1.jar
com.springsource.org.apache.log4j-1.2.15.jar
com.springsource.slf4j.api-1.5.6.jar
slf4j-log4j12-1.5.6.jar 
```

**第二次更新：**

在从赏金到结束的几个小时内，这就是 Log4j 在每个 Portlet 应用程序中的配置方式。这是`web.xml`：

```
<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>classpath:miAppLog4j.properties</param-value>
</context-param>
<listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
</listener> 
```

`miAppLog4j.properties`文件位于 WAR 和 Portal 外部的文件夹中。[我们通过WebSphere Portal 中的共享库](http://www-10.lotus.com/ldd/portalwiki.nsf/dx/06062009015816pmwebp3y.htm)使其在 Portlet Classpath 中可用。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-26T05:50:24.867

您已经提供了一些基本信息，所以我只能概述一些候选原因和可能性：

**1.文件锁/句柄/IO流问题**

*   由日志滚动触发？

    你的情况是否定的。对于任何给定的 WAR，您的两个单独的日志文件（信息和调试）同时停止。每个文件都以默认的最大大小 (10MB) 滚动。两个日志不太可能总是同时滚动。日志滚动不能触发错误。通过配置进行额外确认`log4j.appender.InfoAppender.MaxFileSize=200MB`

*   由用户操作 Linux 文件触发？

    你的情况是否定的。操作文件的用户/系统管理员可能会创建锁或过时的文件句柄。Linux 应该永远不会遇到用户*拖尾*文件的问题（但 windows 有）。Linux 可能会遇到用户压缩或编辑文件的问题。但是您的问题似乎非常可重复，除非您有自动脚本操作日志文件，否则这不太可能。

*   由 Websphere 或 Spring 中的“竞争性”配置设置触发，服务器/框架重复使用相同的日志文件？

    在你的情况下似乎不太可能。似乎您还没有设置 Websphere 公共日志记录配置。Commons 日志记录自动包含在 websphere 服务器父 ClassLoader 中，并且可以通过以下配置配置为“包装”到 Log4J：

    文件*commons-logging.properties*

    ```
    # Set application classloader mode as PARENT_LAST when deploying in WAS as .ear
    priority=1
    org.apache.commons.logging.LogFactory=org.apache.commons.logging.impl.LogFactoryImpl 
    ```

*   由硬件问题/磁盘故障触发？

    **？？？** 这样的问题会非常可重复，这似乎很奇怪。

**2\. java线程有问题？**

*   线程死亡或死锁
*   “其他”代码中的大量线程处理/争用，因此不会运行带有日志记录的代码

    根据您的描述，我假设应用程序仍在运行，并且性能和功能正常，但未写入日志。你确定吗？如果是这样，那么这不是 webapp 线程的线程问题。

    此外，我可以确认这不是 Log4J 逻辑中的线程问题，因为它创建/使用自己的线程的唯一时间是使用 AsynchAppender/ExternallyRolledFileAppender/SocketAppender/TelnetAppender 之一或使用 PropertyConfigurator.configureAndWatch 或 DOMConfigurator.configureAndWatch 时方法被调用。

    即**负**。

**3\. ClassLoaders中Log4J类的变化，使用不同的配置？**

*   父类加载器与 Webapp 类加载器冲突

    例如，您的 webapps 最初从 WEBINF 目录中自己配置的类开始，一切都很好，但一段时间后，不同的应用程序（或门户服务器管理工​​具之一）导致冲突类被加载到父 ClassLoader 和您的应用程序“拾取”了这个新的非法版本的课程并失败了。

    很可能是一个问题——Google 上的数千名用户一直在为 Websphere 类加载器而苦苦挣扎。

建议的行动：

*   确保您的所有网络应用程序都使用 PARENT_LAST 类加载 - 转到管理控制台并确保它们在所有网络应用程序配置中都设置了 PARENT_LAST

*   确保您收到写入控制台的 Log4J 内部错误消息 例如，通过在应用程序运行时以管理员身份强制删除错误日志来故意测试，创建一个陈旧的句柄。如果控制台中没有出现“Log4J:”错误消息，那么这是一个严重的问题。
    下次出现问题时，捕获任何此类控制台消息并报告它们。此外，您可以在 JVM/websphere 启动时设置“-D log4j.debug”，以准确了解 Log4J 在问题之前/期间所做的事情 - 消息将发送到控制台。

*   您真的需要将所有包和类的日志记录级别设置为调试吗？最好设置为 INFO 或 WARN 并且仅在调试特定问题时选择性地设置？

这是很多文字............ B^）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T09:50:11.087

5 年多来，Log4j 几乎没有修复任何错误：它实际上是一个死项目。如果可以接受，考虑用直接实现 SLF4j的 Logback**替换它。**

Logback 和 SLF4J 是由编写 Log4J (Ceki) 的同一个人编写的，拥有更加自由的许可证并且拥有良好的社区。它在所有可能的方面都是 Log4J 1 的继承者（除了它的名字）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T14:35:58.790

我认为问题在于您有多个 WAR 写入同一个日志文件。根据我们的经验，log4j 不能可靠地做到这一点，尤其是使用滚动附加程序。当一个人去滚动它时，其他人会感到困惑并且无法进一步记录。或者继续登录到旧文件。

我怀疑您将不得不将每个 WAR 日志记录到不同的文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:14:44.083

我会尝试将日志文件位置移动到临时文件系统以外的地方。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-03-01T16:35:54.670

我不确定为什么 log4j 在您的应用程序中停止。但是您可以（应该）升级到 log4j 2.0。切换应该不会很费力。您需要将 log4j.properties 文件重写为 XML 文件，因为新版本不再支持属性文件。

在 Java Magazin 中的一篇文章指出，log4j 2.0 在多线程环境中表现得更加健壮，因此它有可能解决您的问题。如果没有，您仍然可以享受新版本的好处。

它带来了一些不错的功能和增强功能（从[log4j](http://logging.apache.org/log4j/2.x/)站点复制）：

**API 分离**

Log4j 的 API 与实现分开，使应用程序开发人员清楚地知道他们可以使用哪些类和方法，同时确保向前兼容性。这允许 Log4j 团队以安全且兼容的方式改进实现。

**提高性能**

Log4j 2 在关键领域的执行速度比 Log4j 1.x 快，并且在大多数情况下与 Logback 类似。有关详细信息，请参阅性能。支持多个 API 虽然 Log4j 2 API 将提供最佳性能，但 Log4j 2 提供对 SLF4J 和 Commons Logging API 的支持。

**自动重新加载配置**

与 Logback 一样，Log4j 2 可以在修改时自动重新加载其配置。与 Logback 不同，它会在重新配置时这样做而不会丢失日志事件。

**高级过滤**

与 Logback 一样，Log4j 2 支持基于上下文数据、标记、正则表达式和 Log 事件中的其他组件进行过滤。可以指定过滤以在传递给 Logger 之前或在它们通过 Appender 时应用于所有事件。此外，过滤器也可以与 Loggers 关联。与 Logback 不同，您可以在任何这些情况下使用通用的 Filter 类。

**插件架构**

Log4j 使用插件模式来配置组件。因此，您无需编写代码来创建和配置 Appender、Layout、Pattern Converter 等。Log4j 自动识别插件并在配置引用它们时使用它们。

**物业支持**

您可以在配置中引用属性，Log4j 将直接替换它们，或者 Log4j 将它们传递给将动态解析它们的底层组件。属性来自配置文件中定义的值、系统属性、环境变量、ThreadContext Map 和事件中存在的数据。用户可以通过添加自己的查找插件来进一步自定义属性提供者。

# java - 要求始终以小数点右侧 2 位和左侧 7 位的格式输出

> ID：14242036
> 
> 赞同：0
> 
> 时间：2013-01-09T16:42:17.380
> 
> 标签：java, android, decimal

我想要输出纬度和经度的双值字符串，小数点前为 1,2 或 3 位，小数点后为 7 位。如何在 java 中使用 DecimalFormat() 来执行此操作？

```
 12.456789   should give 12.4567890
    12.45678912 should give 12.4567891 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:45:52.643

尝试

```
String s = new DecimalFormat("00.0000000").format(12.456789); 
```

此版本具有固定的整数长度，或

```
 String s = new DecimalFormat("0.0000000").format(12.456789); 
```

具有浮动长度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T16:48:03.847

`String formatted = new DecimalFormat("##.######").format(input)`;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T16:54:14.407

> 我只想要小数点后的 7 位数字

这将始终为您提供 7 个十进制位置，并根据需要四舍五入。

```
String s = String.format("%.7f", lat); 
```

同时做这两件事

```
String s = String.format("lat %.7f, long %.7f", lat, long); 
```

# javascript - 通过鼠标事件检测移动设备

> ID：14242038
> 
> 赞同：2
> 
> 时间：2013-01-09T16:42:25.597
> 
> 标签：javascript, mobile

我正在寻找检测设备是移动设备（手机或平板电脑）还是台式机。我想过使用`mousemove`or`mouseenter`事件，以便在触发此事件时，可以将全局布尔标志设置`IsDesktop`为 true。

这是一个好主意还是鼠标事件也可以在移动设备上触发？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:44:57.017

您必须意识到这里有两种不同的情况：

1.  显示尺寸：大/小
2.  鼠标和/或触摸

在第二种情况下，您不需要做太多其他事情，只需实现两组事件。在第一种情况下，您可能想要加载替代模板；对于小屏幕（触摸）设备来说更直观的一种。这是你应该检查的东西。

由于移动设备上的像素要密集得多，因此实际上没有办法检测屏幕尺寸。查看 User-Agent 字符串是一个好的开始。

如果您不担心屏幕大小并且不需要单独的模板，那么您不需要做任何特别的事情。只需实现两组事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-09T11:45:12.550

鼠标事件中有[`sourceCapabilities`](https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/sourceCapabilities)字段，可用于检查浏览器是否启用触摸。

但仅存在于基于 Chromium 的浏览器中，处于试验阶段，因此不推荐用于生产。

# javascript - jQuerySplitter 控件/kendoSplitter 未调整大小

> ID：14242041
> 
> 赞同：2
> 
> 时间：2013-01-09T16:42:34.103
> 
> 标签：javascript, jquery, html, css, kendo-ui

如果调整底部窗格的大小，视图将缩小，并且无法恢复到原始大小。此外，即使我将大小设置为 100%，视图也不会占据整个屏幕。我尝试在中间和底部窗格垂直部分设置静态大小，如下所示：

```
$("#vertical").kendoSplitter({
    orientation: "vertical",
    panes      : [
        {
            collapsible: false,//toolbar should be a set height and unable to be collapsed
            resizable  : false,
            size       : "50px"
        },
        {
            collapsible: false //main section, not collapsible, but resizable
        },
        {
            collapsible: true, size: "200px"
        }
    ]
}); 
```

但无论何时完成，窗格上都会出现一个滚动条，其余部分隐藏在空白处。

jsFiddle：[在这里](http://jsfiddle.net/6rjKe/)

jQuery Splitter/kendoSplitter 示例：[这里](http://demos.kendoui.com/web/splitter/index.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:30:35.437

尝试使用以下 css 定义`mainView`：

```
#mainView {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
} 
```

这使得主容器在窗口调整大小时占据屏幕的 100%。

[在这个](http://jsfiddle.net/OnaBai/6rjKe/1/)修改后的 JSFiddle中查看它。

# delphi - TankAuth 会话过期功能使我的 Delphi 桌面应用程序无效

> ID：14242046
> 
> 赞同：0
> 
> 时间：2013-01-09T16:42:49.023
> 
> 标签：delphi, authentication, codeigniter-2, indy, tankauth

我有一个桌面应用程序（使用**Delphi XE2**开发）登录并与**PHP 5** Web 应用程序交互（我使用**CodeIgniter 2.1**和**[TankAuth](https://github.com/ilkon/Tank-Auth)** - 都是最新版本）

TankAuth似乎**具有会话过期**功能（**每 5 分钟**启动一次）以防止会话劫持。这是一个很好的安全措施，但是...

这也**使 Delphi 应用程序登录无效**。更具体地说，我需要更新 cookie（**我使用 Indy 10.4861**），这意味着**我必须每 5 分钟重新登录一次**

我的 Delphi XE2 应用程序使用多线程。我使用全局 cookie（以避免登录每个线程！），所以我必须解决每 5 分钟锁定一次以重新登录。

我的分析器清楚地表明我需要对此做点什么！

我的代码如下所示：

```
TheResponse   := TStringStream.Create;
try
   IdHttp.Get(TheURL, TheResponse);

   if (TheResponse <> nil) And (Pos('login', TheResponse.DataString) <> 0) then
   begin
        OmniLock.Acquire;
        try
           LoginToServer(ServerLogin, UserPassword);
        finally
               OmniLock.Release;
        end;    // try/finally

        // Reload local copie of the cookies manager
        OmniLock.Acquire;
        try
           TheCookieManager.AddCookies(GlobalCookieManager);
        finally
               OmniLock.Release;
        end;    // try/finally
except
      // ...
end;    // try/except 
```

**我的问题是：**有没有办法让会话过期，但以某种方式捕获更改的会话过期并更新 cookie 管理器**而**无需重新登录？

* * *

**编辑**

每当有新的 cookie 时，全局 cookie 管理器就会更新：

```
idHTTP.OnNewCookie := SyncNewCookie;

// ------------------------------------------------------------------------------ //
procedure TMainForm.SyncNewCookie(ASender : TObject; ACookie : TIdCookie; var VAccept : Boolean);
begin
     VAccept := True;

     OmniLock.Acquire;
     try
        GlobalCookieManager.CookieCollection.AddServerCookie(ACookie.ServerCookie, TIdHTTP(TIdCookieManager(ASender).Owner).URL);
     finally
            OmniLock.Release;
     end;    // try/finally
end; 
```

# c# - 为什么签名的 ClickOnce 应用程序不显示受信任的发布者？

> ID：14242050
> 
> 赞同：0
> 
> 时间：2013-01-09T16:42:56.927
> 
> 标签：c#, visual-studio, deployment, clickonce, digital-certificate

这个问题附有一些图片，让你们了解我们在做什么。

1 代码使用 Verisign Class 3 代码签名。 ![在此处输入图像描述](../Images/f53d505a212a8f0a8ac85df733addf53.png)

2 它通过 Visual Studio 发布到我们的 Web 服务器。 ![已发布的应用程序](../Images/efcf26c827011e7660cb8b4e4c12aecf.png)

3 当我单击下载时，它会显示警告消息。 ![没有受信任的发布者](../Images/70f9524c3c6332df0e1e8ac1d568e4f6.png)

4 它不显示受信任的发布者。 ![额外的信息](../Images/53466646abdc51041ee444a0eda6fbc3.png)

我认为唯一可能是问题是其中一个项目引用了...

微软.Office.Core

Microsoft.Office.Interop.Word

Microsoft.Vbe.Interop

奇怪的是，当安装项目时，这些 dll 不包含在项目中，所以我猜它是从 GAC 获取的。

我确实创建了一个简单的项目，并签署了它，它工作得很好。但是这个应用程序非常大，删除 Office 引用会使程序完全无法构建。

任何建议或想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:15:32.737

受信任的发布者似乎在项目的发布 -> 选项下查看支持 URL。我正在使用如下所示的长网址使其崩溃。

[http://www.yourwebsite.com/documents/ABC-&&YTff5643LO](http://www.yourwebsite.com/documents/ABC-&&YTff5643LO) $$ccRUim/UserGuides/ABCDEFG/ABCDEFG.pdf

长度、特殊字符或它是文件的事实可能会导致问题。

您可以使用常规的 url 链接，它会起作用。

# tsql - SSIS 分布式事务错误“无法获取连接

> ID：14242053
> 
> 赞同：2
> 
> 时间：2013-01-09T16:43:01.730
> 
> 标签：tsql, transactions, ssis

我正在使用 SSIS 内置事务。场景如下

同一服务器上有两个数据库，我需要合并它们（插入/更新）我正在使用 SQL 合并子句来这样做。主表很少，每个表都有几个子表。合并语句首先在主表上运行，然后我有子表的 ExecuteSQL 任务。子表 ExecuteSQL 并行运行。

执行此操作时，我在并行运行的 ExecuteSQL 任务之一上获取连接失败并且任务失败。无法弄清楚是什么原因。

RetainSameConnection 设置为 false，如果我将其设置为 True，则会出现“事务上下文正在被另一个会话使用”错误。

据我了解，我不需要 RetainSameConnection = True 因为它仅在基于本地 TSQL 的事务中需要。DTC 已启用且正在工作。

并非我的包中的所有任务都失败了，这表明它通过在并行任务上以某种方式失败而成功地获得了连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:00:13.823

“无法获取连接”消息几乎总是由于您有一个任务在正确设置连接之前验证连接。

在大多数 SSIS 项目中，您的连接都绑定到本地数据库以用于开发目的。然后，您可以使用表达式、变量、脚本任务或类似的东西在运行时设置真正的连接。

当一个包开始执行时，每个将“DelayValidation”属性设置为“False”（默认值！）的组件都会在执行任何任务之前尝试连接到数据源，这意味着它将尝试连接到在更新其属性之前在开发环境中设置的数据库...

# iis - SQL Server Reporting Services 定期无响应，直到 IIS 重置或应用程序池回收

> ID：14242063
> 
> 赞同：0
> 
> 时间：2013-01-09T16:43:44.527
> 
> 标签：iis, reporting-services, timeout

恐怕我在这里束手无策，所以希望有人至少能指出我正确的想法。

我目前在 Windows Server 2003 SP2 机器上使用 IIS 6.0 运行 Reporting Services 2005 SP4。

我面临的问题是，提交报告的网站（localhost/reports 以及使用机器名称进行非内部访问的等效网站）经常完全没有响应。页面卡在加载中，永远无法完成。我

我最近找到了该问题的伪解决方案。如果我回收与报告服务 IIS 页面关联的应用程序池，该网站会再次响应 - 但只是很短的时间，之后它再次变得无响应。重新启动 IIS 也可以解决该问题，但同样只能在短时间内解决。

我检查了 Windows 应用程序日志、与报告服务网页关联的 IIS 日志以及报告服务日志 - 它们都没有为我提供任何关于为什么会发生这种情况的额外信息。

有谁之前经历过这个吗？我完全不知道下一步该往哪里看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T19:40:42.663

看起来我可能已经解决了这个*问题*。

基本上，只是删除了除默认应用程序池之外的所有 IIS 网站和所有 IIS 应用程序池。然后，进入 Reporting Services 配置管理器，并将所有配置重置为默认值。重新启动网站，你瞧，问题似乎并没有出现。

不知道为什么会这样，但是...

# magento - 如何在 Magento 中使用 sql 查询更新产品名称？

> ID：14242066
> 
> 赞同：0
> 
> 时间：2013-01-09T16:43:48.683
> 
> 标签：magento, magento-1.6

现在，我想将所有产品名称中的“示例”替换为“测试”。我该怎么做呢？

我不知道产品名称在数据库中存储在哪里？sql命令应该怎么写？

我知道 sql 命令将是

```
 update table_name set product_name = replace(value,"example","test") 
```

如何在 Magento 中更改它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:14:42.967

通常，使用 sql 直接更新您的 magento 数据库是个坏主意。我建议您创建一个控制器，您可以在其中轻松运行这个小脚本：

```
public function databaseAction() {
    // load all products where 'name' LIKE '%example%'
    $products = Mage::getModel('catalog/product')->getCollection()
                ->addAttributeToSelect('name')
                ->addFieldToFilter(array(
                        array('attribute' => 'name', 'like' => '%example%')
                ));

    // loop through products, update the product name and save the product
    foreach ($products as $product) {
        $product->setName(str_replace('example', 'test', $product->getName()));
        $product->save();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T00:59:21.067

以下代码将更新所有产品，它将名称中的任何“example”实例更改为“test”，并使用“saveAttribute”方法，这使得更新时间可以忽略不计。这个脚本可能会在很短的时间内运行 10k 个问题，在一个不错的服务器上不到 1 分钟。

该文件将放在 Magento 安装的子目录中。调用 $product->save() 会在后台发生一些额外的事情（例如触发事件......但对于您的目的可能不是必需的）。save() 是一个更完整的方法，但需要更长的时间。

```
<?php
ini_set('error_reporting', E_ALL);
ini_set('display_errors', TRUE);
ini_set('log_errors', TRUE);
set_time_limit(0);

//Include the Mage package
require_once '../app/Mage.php';

//Set Developer mode to true, allows for more verbose errors
Mage::setIsDeveloperMode(true);

//Set php to display errors
ini_set('display_errors', 1);

//Initialize the app.
//Mage::app();
Mage::app()->setCurrentStore(Mage_Core_Model_App::ADMIN_STORE_ID);

//Start timer
function microtime_float()
{
    list($usec, $sec) = explode(" ", microtime());

    return ((float) $usec + (float) $sec);
}

$time_start = microtime_float();
///////END HEADER//////

$products = Mage::getModel('catalog/product')->getCollection()->addAttributeToFilter('name',array('like'=>'%example%'));

foreach ($products as $product) {
    $newName = str_replace('example','test',$product->getName());
    $product->setName($newName);
    //can replace the next line with:  $product->save()
    $product->getResource()->saveAttribute($product,'name');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-22T17:48:19.073

Magento 的数据库的直接更新是棘手但可行的。EAV的事情需要处理。

产品 entity_id 和 sku 存储在此表中

```
catalog_product_entity 
```

产品属性名称存储在这些表之一中，您的系统中可能还有其他表。

```
catalog_product_entity_datetime
catalog_product_entity_decimal
catalog_product_entity_gallery
catalog_product_entity_int
catalog_product_entity_media_gallery
catalog_product_entity_text
catalog_product_entity_url_key
catalog_product_entity_varchar 
```

属性值存储在

```
eav_attribute 
```

因此，您需要将这三个表连接在一起。这是一个实体关系图，它显示了它的工作原理和示例 SQL。

[![在此处输入图像描述](../Images/a31574461db0a9448d496f32788b2159.png)](https://i.stack.imgur.com/Y3RBN.png)

诀窍是知道要使用哪个 entity_X 表，以及用于特定属性的 attribute_id。attribute_ids 因系统而异。此查询将帮助您查看您的查询。此示例仅查看 _entity_varchar 表。您的属性可能在 _entity_int 或 _entity_text 等中。此示例显示单个产品的值，在这种情况下，sku='0203MR-0'

**显示产品属性 ID**

```
select
   p.entity_id,
   p.entity_type_id,
   p.attribute_set_id,
   p.type_id,
   p.sku,
   a.attribute_id,
   a.frontend_label as attribute,
   av.value
from
   catalog_product_entity p
   left join catalog_product_entity_varchar av on
      p.entity_id = av.entity_id
   left join eav_attribute a on
      av.attribute_id = a.attribute_id
where
   p.sku = '0203MR-0'
; 
```

一旦您知道相关属性的 attribute_id，您就可以列出或更新这些属性。在这种情况下，我们对产品名称感兴趣，在我的系统中，attribute_id 是 71。

**列出产品名称**

```
select
   p.entity_id,
   p.entity_type_id,
   p.attribute_set_id,
   p.type_id,
   p.sku,
   a.attribute_id,
   a.frontend_label as attribute,
   av.value
from
   catalog_product_entity p
   join catalog_product_entity_text av on
      p.entity_id = av.entity_id
   join eav_attribute a on
      av.attribute_id = a.attribute_id
where
   a.attribute_id = 71
; 
```

**更新产品名称**

```
update
   catalog_product_entity p
   join catalog_product_entity_text av on
      p.entity_id = av.entity_id
   join eav_attribute a on
      av.attribute_id = a.attribute_id
set
   av.value = replace(av.value,
      'example',
      'test')
where
   a.attribute_id = 71
; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T20:11:18.497

正如 Vicky 所说，不要使用直接的 SQL 来执行此操作。Magento 将所有内容抽象得足够好，以至于没有必要。

根据更新产品名称的目的，您可能不一定需要模块/控制器来执行此操作。如果您只执行此操作一次（或偶尔执行此操作），只需转到后端产品管理网格，设置过滤器以便显示您要更新的产品，单击左上角的“全选”按钮（下方分页控件），然后从右上角的“操作”选择输入中选择“更新属性”。然后，您可以一次更新所有这些产品的名称。

# windows - git VCS中来自Windows用户的文件？

> ID：14242069
> 
> 赞同：0
> 
> 时间：2013-01-09T16:43:49.850
> 
> 标签：windows, macos, git

我今天在这里感觉很慢，但我正在尝试合并一些来自不使用 git 的第三方开发人员的代码。他从他在印度的 windows 机器上手动向我发送文件，在那里他用 Dreamweaver 编辑了这些文件（目前他将行尾类型设置为“CR”）。当我在我的 MacOSX 机器上获取文件时，它们有 windows 行尾（vim 中的 ^M）所以我用这个 perl 命令去除它们，`perl -pe 's/\r\n|\n|\r/\n/g' orders.dev.php > orders.php`它去除了 windows 行尾，并且在我拥有的文件编辑器中工作得很好。问题是当我尝试将该文件添加到 git 时，整个文件显示为已更改。如果线路终止是对我有意义的窗口，但我正在剥离它。做了一些谷歌搜索后，我发现了这篇 github 帖子[https://help.github.com/articles/dealing-with-line-endings](https://help.github.com/articles/dealing-with-line-endings)看起来我可以使用 git 来强制一个特定的行结束，或者在 Mac 的情况下告诉它使用文件没有的任何东西，这对我来说似乎没有任何区别。底线我无法弄清楚如何显示实际开发人员所做的更改。它始终显示整个文件已更改。我错过了什么？

PS 对不起，篇幅太长，但我想表明我不只是在那里提出问题。我已经调查过了。只是由于某种原因，我还没有偶然发现我错过的东西（除了第二杯咖啡）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:03:09.470

使用`git diff -w`，您将忽略空格差异（空格/制表符，行尾）。这应该可以帮助您查看差异。

对于 git，要强制将行尾更改为 LF（提交时），命令是`git config --global core.autocrlf true`.

# c++ - 使用过滤器打开文件对话框

> ID：14242070
> 
> 赞同：0
> 
> 时间：2013-01-09T16:43:53.037
> 
> 标签：c++, windows, mfc

我正在使用 C++ 和 MFC。我需要修改打开文件对话框，因此只有包含 *.txt 文件的文件**夹**必须可见。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:58:26.707

我没有任何使用 MFC 编程的经验，但这些都是我的疑问。

没有理由这样做，特别是如果您要过滤所有可能级别的文件夹。想象一下用户打开`C:`并且您的程序开始扫描整个磁盘。如果这个磁盘是通过网络连接的，那就更糟了。

这就是为什么我怀疑 MFC 中有这样的能力的原因，所以你必须编写这样一个对话框，并且只有当你决定只使用一些固定级别的嵌套来过滤文件夹时才有可能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T15:12:41.747

适当地使用[`GetOpenFileName`](http://msdn.microsoft.com/en-us/library/ms646927%28v=vs.85%29.aspx)和设置 OPENFILENAME 结构实例的过滤器成员。

```
char szFile[MAX_PATH];

OPENFILENAME ofn = {0};
ofn.lStructSize = sizeof(ofn);
ofn.hwndOwner = m_hWnd;
ofn.lpstrFile = szFile;
ofn.lpstrFile[0] = '\0';
ofn.nMaxFile = sizeof(szFile);
ofn.lpstrFilter = "Text\0*.TXT\0";
ofn.nFilterIndex = 0;
ofn.lpstrFileTitle = NULL;
ofn.nMaxFileTitle = 0;
ofn.lpstrInitialDir = NULL;
ofn.Flags = OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;

if (GetOpenFileName(&ofn)) ... 
```

# maven - Jenkins / Hudson 中的 Maven 和自由风格的软件项目有什么区别？

> ID：14242071
> 
> 赞同：7
> 
> 时间：2013-01-09T16:43:56.573
> 
> 标签：maven, jenkins, hudson

Jenkins / Hudson 中的 Maven 和自由风格的软件项目有什么区别？

我注意到，当 JUnit 测试失败导致 Maven 项目成功构建时，与自由式构建失败时存在差异。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-09T21:28:46.780

maven 项目是一个项目，它将更详细地分析 pom.xml 文件并生成一个面向被调用目标的项目。maven 项目足够聪明，可以合并构建目标，如 javadoc 或测试目标，并自动为这些目标设置报告。它几乎不需要配置。有关Maven 项目的更多信息，请参阅：[https ://wiki.jenkins.io/display/JENKINS/Building+a+maven2+project。](https://wiki.jenkins.io/display/JENKINS/Building+a+maven2+project)

Free-Style 项目是一个可以包含几乎任何类型的构建的项目。虽然 maven 项目只能构建 maven 项目，但 Free-Style 项目是项目的更“通用”形式。您可以执行 shell/dos 脚本、调用 ant 等等。大多数插件都是为使用自由样式项目而编写的。maven 模块的局限性在于它不能调用 shell 脚本或其他任何东西，只能调用 maven 目标。有关Free-Style 项目的更多信息，请参阅：[https ://wiki.jenkins.io/display/JENKINS/Building+a+software+project。](https://wiki.jenkins.io/display/JENKINS/Building+a+software+project)

# sql - 具有默认值的外键在主表中不存在

> ID：14242073
> 
> 赞同：0
> 
> 时间：2013-01-09T16:44:00.120
> 
> 标签：sql, sql-server-2008, tsql

这是我的情况。我有一个表，其中列的值可以是 NULL、0 或另一个表中的值。另一个表的任何行都没有 0 值。

我最好的选择是什么？

1）不要添加FK。

2）向外表添加一条0记录。

3) 别的东西。

我无法将 0 值更改为空值。0 代表有效值。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:53:38.383

我个人会查看架构 - 此列是外键还是不是外键 - 听起来好像您正在尝试将该列用于 2 个不同的事物（“0 表示有效值”）。如果您无法更改架构以添加真正的 FK 列，那么将解决方案 1 作为次佳（IMO）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T16:48:39.333

如果 0 是有效值，我会亲自添加 0 作为“外表”的记录。

或者 3) 使用 CHECK CONSTRAINT 而不是 FOREIGN KEY。

但答案不能是 1) 或 2) 或 3) 作为“最佳实践通用答案”：这取决于您的需求（当与您的表相关的某些内容在外部表中被删除时必须发生什么是其中之一要考虑的最重要的事情）。

检查约束的弱点：

[http://msdn.microsoft.com/en-us/library/ms188258(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms188258(v=sql.105).aspx)

> 在 DELETE 语句期间不验证 CHECK 约束。因此，对具有某些类型的检查约束的表执行 DELETE 语句可能会产生意想不到的结果。例如，考虑在表 CheckTbl 上执行的以下语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T16:55:43.953

带有 an 的检查约束`EXISTS(SELECT 1 FROM OtherTable WHERE fkv=v) OR v=0`将是一个选项。但是，出于性能原因，始终首选真正的外键。（SQL Server 可以并且将在查询优化期间使用声明的外键关系，这通常会导致查询速度更快。）

此外，正如 Raphaël Althaus 所提到的，仅当您在子表中插入或更新记录时才会检查检查约束。即使有现有的子记录，删除父记录也不会产生任何后果。（为此，您可以添加一个触发器）

总而言之，添加“0”记录并声明真正的外键是您最好的选择。

# sql-server - 慢查询 ColdFusion，SQL Server，依赖于空白

> ID：14242079
> 
> 赞同：6
> 
> 时间：2013-01-09T16:44:14.303
> 
> 标签：sql-server, performance, coldfusion

我们有一个问题，我们从 ColdFusion 9 调用 SQL Server 2005。我无法发布原始查询，但这不是问题的焦点，我已经发布了导致问题的相关组合。

我们有一个查询，它是以下示例查询的更复杂版本，其中`something`列是主键。value 参数没有改变。由于某些我们无法理解的奇怪原因，此查询需要将近 20 秒才能运行....

```
<cfquery result="q" datasource="dsn">
  SELECT something
  FROM somewhere
  WHERE something = <cfqueryparam cfsqltype="cf_sql_integer" value="#value#"/> 
</cfquery> 
```

**请注意**，如果您突出显示上面源代码的最后一行，cfqueryparam 标记后有一个空格。

以下查询完全不同，我相信您可以自己看到，运行需要 15 毫秒。

```
<cfquery result="q" datasource="dsn">
  SELECT something
  FROM somewhere
  WHERE something = <cfqueryparam cfsqltype="cf_sql_integer" value="#value#"/>
</cfquery> 
```

cfqueryparam 后面没有空格。但是，在末尾添加两个空格也会产生 15 毫秒。如果我们最后回到一个空格，我们会在大约 20 秒内再次得到结果。

我们检查了 Java 和 SQL Server 之间的数据库驱动程序日志，似乎没有什么异常。这里会发生什么？

* * *

## 编辑

我们在 SQL Server 上运行了分析，它表明对于具有单个空格的查询，它使用的缓存执行计划与具有零个或多个空格的缓存执行计划不同。SQL Server 缓存查询的执行计划。它还使用完整的文字查询作为标识符。因此，当我们发送其他查询时，正在使用不同的执行计划。

## 更远

其中一个执行计划看起来像是在其中一个子选择上查找不正确的索引，目前尚不清楚 SQL Server 为何决定采用此替代执行计划，或者为什么其中一个索引看起来是错误的。

## 跟进

对于任何对可能导致错误执行计划的原因感兴趣的人，此处发布了后续问题：[SQL Server 2005 cached an execution plan that could never work](https://stackoverflow.com/questions/14277433/sql-server-2005-cached-an-execution-plan-that-could-never-work)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:11:32.457

这可能是前几天在[Railo 论坛](https://groups.google.com/d/msg/railo/SnfAOQDOxSc/NifM6NUtd74J)上出现的问题的症状（奇怪的巧合）。

首次运行慢速查询版本时使用的参数值的性质有可能导致创建执行计划，该执行计划对该特定值“方便”，但对于更典型的后续值，该计划小于理想的。相反，当第一次运行第二个查询时，作为参数传递的值更典型地反映了查询的调用方式，因此执行计划更适合大多数其他值。

我个人还没有看到这种情况发生，但我已经阅读了足够多的时间。听起来确实像你所看到的。

如果可能，清楚地通过 SQL Server 缓存对其进行测试，然后使用导致编译“错误”计划的值重新运行查询，您应该会看到类似的行为。

这不是一个解决方案，但它会证明它可能是原因，并允许您解决不同值的计划差异的潜在原因。

这个实验显然是基于知道第一次调用查询时参数值是什么，这就是......如果你知道它们，那对你来说是幸运*的*。

# mysql - 需要 MySQL 查询以根据最常出现的行检索第二个值

> ID：14242080
> 
> 赞同：1
> 
> 时间：2013-01-09T16:44:14.840
> 
> 标签：mysql, sum

以下查询检测到出现次数最多的`diallednumber`：

```
SELECT COUNT( * ) AS  `Rows` , diallednumber
FROM logData
GROUP BY diallednumber
ORDER BY  `Rows` DESC 
LIMIT 20 
```

我有另一列显示成本`diallednumber`。

我无法编写查询以`diallednumber`根据发生的次数提供最昂贵的查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:55:03.230

### 每个号码的通话次数

```
SELECT COUNT(*) AS calls, dialledNumber
  FROM logData
 GROUP BY dialledNumber 
```

### 最多呼叫一个号码

```
SELECT MAX(calls) AS maxCalls
  FROM (SELECT COUNT(*) AS calls, dialledNumber
          FROM logData
         GROUP BY dialledNumber
       ) AS c 
```

### 呼叫次数最多的号码的呼叫费用总和

```
SELECT SUM(l.cost), l.dialledNumber
  FROM logData AS l
  JOIN (SELECT COUNT(*) AS calls, dialledNumber
          FROM logData
         GROUP BY dialledNumber
       ) AS c
    ON l.dialledNumber = c.dialledNumber
  JOIN (SELECT MAX(calls) AS maxCalls
          FROM (SELECT COUNT(*) AS calls, dialledNumber
                  FROM logData
                 GROUP BY dialledNumber
               )
       ) AS m
    ON m.maxCalls = c.calls 
```

如果有两个号码的最大通话次数相同，则会显示两个号码。如果你想变得花哨，你可以用最大的成本总和来喝水。

`m`子查询可以在没有连接的情况下用作“简单”数字：

```
SELECT SUM(l.cost), l.dialledNumber
  FROM logData AS l
  JOIN (SELECT COUNT(*) AS calls, dialledNumber
          FROM logData
         GROUP BY dialledNumber
       ) AS c
    ON l.dialledNumber = c.dialledNumber
   AND c.calls = (SELECT MAX(calls) AS maxCalls
                    FROM (SELECT COUNT(*) AS calls, dialledNumber
                            FROM logData
                           GROUP BY dialledNumber
                         )
                 ) AS m 
```

一个好的优化器会对两者使用相同的查询计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:01:09.683

最大的成本：

```
SELECT diallednumber
     , COUNT(diallednumber)
     , SUM(cost) 
  FROM logdata 
 GROUP 
    BY diallednumber 
 ORDER 
    BY SUM(cost) DESC LIMIT 1; 
```

# r - 将标签放置到ggplot图

> ID：14242081
> 
> 赞同：0
> 
> 时间：2013-01-09T16:44:17.143
> 
> 标签：r, ggplot2

```
dput(pp)
structure(list(Team = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 
2L, 3L, 3L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 
1L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 2L, 3L, 
3L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 2L, 2L, 3L, 3L, 1L, 1L, 2L, 2L, 3L, 3L), .Label = c("A", 
"B", "C"), class = "factor"), Date = structure(c(1L, 1L, 2L, 
2L, 3L, 3L, 4L, 4L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 
7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 9L, 9L, 9L, 9L, 9L, 9L, 10L, 
10L, 10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 
12L, 12L, 12L, 12L, 13L, 13L, 13L, 13L, 13L, 13L, 14L, 14L, 14L, 
14L, 14L, 14L, 15L, 15L, 16L, 16L, 17L, 17L, 18L, 18L, 19L, 19L, 
20L, 20L, 21L, 21L, 22L, 22L, 23L, 23L, 24L, 24L, 25L, 25L, 26L, 
26L, 27L, 27L, 28L, 28L, 28L, 28L, 28L, 28L, 29L, 29L, 29L, 29L
), .Label = c("2012-02-23", "2012-02-24", "2012-02-27", "2012-02-28", 
"2012-02-29", "2012-03-01", "2012-03-02", "2012-03-05", "2012-03-06", 
"2012-03-07", "2012-03-08", "2012-03-09", "2012-03-12", "2012-03-13", 
"2012-03-14", "2012-03-15", "2012-03-16", "2012-03-19", "2012-03-20", 
"2012-03-21", "2012-03-22", "2012-03-23", "2012-03-26", "2012-03-27", 
"2012-03-28", "2012-03-29", "2012-03-30", "2012-04-02", "2012-04-03", 
"2012-04-04", "2012-04-05", "2012-04-06", "2012-04-09", "2012-04-10", 
"2012-04-11", "2012-04-12", "2012-04-13", "2012-04-16", "2012-04-17", 
"2012-04-18", "2012-04-19", "2012-04-20", "2012-04-23", "2012-04-24", 
"2012-04-25", "2012-04-26", "2012-04-27", "2012-04-30", "2012-05-01", 
"2012-05-02", "2012-05-03", "2012-05-04", "2012-05-07", "2012-05-08", 
"2012-05-09", "2012-05-10", "2012-05-11", "2012-05-14", "2012-05-15", 
"2012-05-16", "2012-05-17", "2012-05-18", "2012-05-21", "2012-05-22", 
"2012-05-23", "2012-05-24", "2012-05-25", "2012-05-28", "2012-05-29", 
"2012-05-30", "2012-05-31", "2012-06-01", "2012-06-04", "2012-06-05", 
"2012-06-06", "2012-06-07", "2012-06-08", "2012-06-11", "2012-06-12", 
"2012-06-13", "2012-06-14", "2012-06-15", "2012-06-18", "2012-06-19", 
"2012-06-20", "2012-06-21", "2012-06-22", "2012-06-25", "2012-06-26", 
"2012-06-27", "2012-06-28", "2012-06-29", "2012-07-02", "2012-07-03", 
"2012-07-04", "2012-07-05", "2012-07-06", "2012-07-09", "2012-07-10", 
"2012-07-11", "2012-07-12", "2012-07-13", "2012-07-16", "2012-07-17", 
"2012-07-18", "2012-07-19", "2012-07-20", "2012-07-23", "2012-07-24", 
"2012-07-25", "2012-07-26", "2012-07-27", "2012-07-30", "2012-07-31", 
"2012-08-01", "2012-08-02", "2012-08-03", "2012-08-06", "2012-08-07", 
"2012-08-08", "2012-08-09", "2012-08-10", "2012-08-13", "2012-08-14", 
"2012-08-15", "2012-08-16", "2012-08-17", "2012-08-20", "2012-08-21", 
"2012-08-22", "2012-08-23", "2012-08-24", "2012-08-27", "2012-08-28", 
"2012-08-29", "2012-08-30", "2012-08-31", "2012-09-03", "2012-09-04", 
"2012-09-05", "2012-09-06", "2012-09-07", "2012-09-10", "2012-09-11", 
"2012-09-12", "2012-09-13", "2012-09-14", "2012-09-17", "2012-09-18", 
"2012-09-19", "2012-09-20", "2012-09-21", "2012-09-24", "2012-09-25", 
"2012-09-26", "2012-09-27", "2012-09-28", "2012-10-01", "2012-10-02", 
"2012-10-03", "2012-10-04", "2012-10-05", "2012-10-08", "2012-10-09", 
"2012-10-10", "2012-10-11", "2012-10-12", "2012-10-15", "2012-10-16", 
"2012-10-17", "2012-10-18", "2012-10-19", "2012-10-22", "2012-10-23", 
"2012-10-24", "2012-10-25", "2012-10-26", "2012-10-29", "2012-10-30", 
"2012-10-31", "2012-11-01", "2012-11-02", "2012-11-05", "2012-11-06", 
"2012-11-07", "2012-11-08", "2012-11-09", "2012-11-12", "2012-11-13", 
"2012-11-14", "2012-11-15", "2012-11-16", "2012-11-19", "2012-11-20", 
"2012-11-21", "2012-11-22", "2012-11-23", "2012-11-26", "2012-11-27", 
"2012-11-28", "2012-11-29", "2012-11-30", "2012-12-03", "2012-12-04", 
"2012-12-05", "2012-12-06", "2012-12-07", "2012-12-10", "2012-12-11", 
"2012-12-12", "2012-12-13", "2012-12-14", "2012-12-17", "2012-12-18", 
"2012-12-19", "2012-12-20", "2012-12-21", "2012-12-24", "2012-12-25", 
"2012-12-26", "2012-12-27", "2012-12-28", "2012-12-31", "2013-01-01", 
"2013-01-02", "2013-01-03", "2013-01-04", "2013-01-07", "2013-01-08"
), class = "factor"), Seconds = c(-51388L, -51388L, -41357L, 
-41357L, -53787L, -53787L, -52401L, -52401L, -53850L, -53850L, 
-52555L, -52555L, -20996L, -20996L, -51169L, -51169L, -36027L, 
-36027L, 1260L, 1260L, -34407L, -34407L, -54489L, -54489L, -28192L, 
-28192L, -53124L, -53124L, -45377L, -45377L, -17748L, -17748L, 
-45122L, -45122L, -52681L, -52681L, -29807L, -29807L, -51305L, 
-51305L, -54618L, -54618L, 4487L, 4487L, -53112L, -53112L, -28269L, 
-28269L, -3408L, -3408L, -26260L, -26260L, -51686L, -51686L, 
-26149L, -26149L, -51637L, -51637L, -52347L, -52347L, -20492L, 
-20492L, -50541L, -50541L, -43557L, -43557L, -50862L, -50862L, 
-17465L, -17465L, -51538L, -51538L, -50680L, -50680L, -38414L, 
-38414L, -51690L, -51690L, -40387L, -40387L, -46609L, -46609L, 
-51753L, -51753L, -51318L, -51318L, -51072L, -51072L, -44116L, 
-44116L, -53716L, -53716L, -4488L, -4488L, -52479L, -52479L, 
-51851L, -51851L, -24389L, -24389L)), .Names = c("Team", "Date", 
"Seconds"), row.names = c(NA, 100L), class = "data.frame") 
```

我喜欢为每个团队使用 facet_wrap 创建一个 ggplot。在 0 上画红线，并在图表外贴上标签，低于 0 表示：准时，高于 0：如图所示迟到。

这是我到目前为止所拥有的：

```
ggplot(pp, aes(Date, Seconds, group=Team, colour=Team)) + geom_point() + facet_wrap( ~ Team) + geom_hline(yintercept=0, colour="red") 
```

![在此处输入图像描述](../Images/a448fe68e58e41cd8987e904266d856c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:31:12.090

一种解决方案是使用`grid.text()`package中的函数`gridExtra`。

`plot.margin=`首先，使用函数中的参数在绘图右侧留出额外的空间`theme()`。

```
library(ggplot2)
library(gridExtra)
p<-ggplot(pp, aes(Date, Seconds, group=Team, colour=Team)) + geom_point() + 
  facet_wrap( ~ Team) + geom_hline(yintercept=0, colour="red") +
    theme(plot.margin = unit(c(1,3,1,1), "cm"),
        legend.position="none") 
```

然后绘制它并添加带有`grid.text()`x 和 y 坐标函数并为文本设置参数的文本。

```
p
grid.text("Late",x = unit(0.9, "npc"), y = unit(0.85, "npc"), just = c("left", "bottom"), 
          gp = gpar(fontface = "bold", fontsize = 14))
grid.text("On Time",x = unit(0.9, "npc"), y = unit(0.75, "npc"), just = c("left", "bottom"), 
          gp = gpar(fontface = "bold", fontsize = 14)) 
```

![在此处输入图像描述](../Images/b849a67cceedb883c6f428724b4ec35b.png)

# c# - Spring.net / DI 和嵌入资源中的加载信息

> ID：14242086
> 
> 赞同：1
> 
> 时间：2013-01-09T16:44:26.423
> 
> 标签：c#, dependency-injection, spring.net

我有一个由 Windows 服务加载的 DLL。该服务使用 spring.net 并且 DLL 包含一个嵌入式资源 xml 文件，该文件定义了我的所有对象。DLL 嵌入文件使用 DI，我现在要求我们在启动时注入本地配置的信息。我的选择是将对象引用移动到服务 app.config 文件，但我想知道是否有一种方法可以定义一个 $value$ ，然后可以在嵌入式引用中引用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:38:30.827

[http://www.springframework.net/doc-latest/reference/html/objects.html](http://www.springframework.net/doc-latest/reference/html/objects.html)

问题细化：如果您要引用程序集 - 只需将此行放入应用程序配置中：

```
 <spring>
  <context type="Spring.Context.Support.XmlApplicationContext, Spring.Core">
    <resource uri="assembly://MyAssembly/MyDataAccess/data-access.xml"/>
  </context>
</spring> 
```

如果您在运行时加载程序集，则必须像这样指定它：

```
IApplicationContext context = new XmlApplicationContext(
             "assembly://MyAssembly/MyDataAccess/data-access.xml"); 
```

# linux-kernel - spin_lock 期间的抢占

> ID：14242088
> 
> 赞同：2
> 
> 时间：2013-01-09T16:44:42.377
> 
> 标签：linux-kernel, kernel

linux 内核 spin_lock 实现通过调用 preempt_disable() 来禁用抢占。在我的内核配置中未设置 CONFIG_PREEMPT。由于在 spin_lock 中断处理程序期间未禁用中断，因此可以调用 schedule()。任何人都可以指出调度程序没有调度另一个进程的代码，因为它已经获得了一个自旋锁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T02:13:26.783

*不允许*中断处理程序调用`schedule()`.

# marklogic - 在 Marklogic 中启用 CPF

> ID：14242092
> 
> 赞同：2
> 
> 时间：2013-01-09T16:44:53.117
> 
> 标签：marklogic

我想了解启用 CPF - 内容处理框架对 Marklogic 4.2.9 服务器的影响。我们有一个 3TB 大小的生产数据库，我们正在研究需要执行多项操作的各种内容丰富和内容删除任务。我曾在以前的项目中创建 CFP 管道，但在我当前的项目中，数据库当前已禁用 CPF。我想了解的是，当/如果我们在此数据库上启用 CPF，将对 1\. Marklogic 内存使用 2\. 磁盘空间 3\. 整体性能 4\. IO 等产生什么影响 我们试图创建的管道将影响数据库中存在的所有/任何文档。

谢谢您的帮助！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T20:51:08.363

我认为@mblakele 很好地涵盖了对内存和磁盘的影响。但我想就 CPF 的工作原理补充几句。这可能有助于了解 CPF 通常如何影响性能。

CPF 依赖于 MarkLogic 的触发机制。任何文档插入、更新和删除都会通过初始状态转换激活 CPF 处理。每个动作都会导致额外的状态转换。每个状态转换都涉及到提交后触发器的执行，调用一些 CPF 内部代码来执行实际操作模块的 xdmp:invoke。因此，如果您有一个插入 100 个文档的事务，这会导致 100 个提交后任务在任务服务器队列中排队等待启动。而且我担心 xdmp:invokes 会导致另外 100 个任务排队。如果文档平均遍历三个状态，则该数字至少乘以三。

换句话说，CPF 对任务服务器队列的影响很大。实际影响性能的程度可能取决于您已经使用任务服务器的程度。任务服务器上的任何非 CPF 任务都将被 CPF 任务延迟。另一方面，如果您目前并没有真正使用任务服务器，您可能不会注意到这一点。应用服务器请求在单独处理的应用服务器队列上运行。

另一件事是 CPF 单独处理文档。这对于缓慢而有弹性的后台处理是理想的。但如果您需要速度，最好为批量文档创建事务。

！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T20:04:59.477

如果您已经`maintain-last-modified`启用，对内存和磁盘空间的影响将是最小的。如果`maintain-last-modified`禁用，CPF 将在文档被触摸时创建新的属性片段。由此您可以期望使用额外的内存和磁盘空间，每个文档可能需要大约 100-B 的内存和 1-kB 的磁盘空间。额外的碎片也可能对 I/O 和整体性能产生影响，但预测其程度需要对应用程序及其查询有更深入的了解。

# c# - 是否有我可以 GAC 的 ValueInjecter 签名版本？

> ID：14242095
> 
> 赞同：0
> 
> 时间：2013-01-09T16:45:03.457
> 
> 标签：c#, .net, gac, valueinjecter

是否有我可以 GAC 的 ValueInjecter 签名版本？我需要一个强命名的版本，以便它可以被 GAC'ed。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T10:08:32.430

来自 nuget 的一个和从 codeplex 下载的一个都已签名

# mysql - Mysql CASE 语句多列

> ID：14242097
> 
> 赞同：6
> 
> 时间：2013-01-09T16:45:16.670
> 
> 标签：mysql, case, multiple-columns

我有兴趣制作一个从两个不同列中提取值的案例语句，其中一个列涉及计算。我不确定如何进行这项工作，但我会向您展示我到目前为止所拥有的。（我有一列显示项目类型，例如特殊订单项目、停产项目和正常库存的项目。第二列显示手头数量 - 销售订单数量以确定该项目是否有库存。）这里是我的查询

```
SELECT ItemID, ItemType, (QuantityOnHand - QuantityonSalesOrders) AS Instock
CASE
WHEN ItemType = 'SP / OR' THEN 'Special Order' 
WHEN Instock < '1' THEN 'Out of Stock' 
WHEN Instock > '0' THEN 'In Stock' 
AS "Stock" FROM peachtree; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T16:47:33.643

对于这种类型的请求，您将不得不重用计算或使用子查询。这是因为您提供`Instock`值的别名在选择列表中不可使用：

```
SELECT ItemID, 
    ItemType, 
    Instock,
    CASE
        WHEN ItemType = 'SP / OR' THEN 'Special Order' 
        WHEN Instock < '1' THEN 'Out of Stock' 
        WHEN Instock > '0' THEN 'In Stock' 
    END AS "Stock" 
FROM
(
    select ItemID, ItemType, (QuantityOnHand - QuantityonSalesOrders) AS Instock
    from peachtree
) p; 
```

或者：

```
SELECT ItemID, 
    ItemType, 
    (QuantityOnHand - QuantityonSalesOrders) as Instock,
    CASE
        WHEN ItemType = 'SP / OR' THEN 'Special Order' 
        WHEN (QuantityOnHand - QuantityonSalesOrders) < '1' THEN 'Out of Stock' 
        WHEN (QuantityOnHand - QuantityonSalesOrders) > '0' THEN 'In Stock' 
    END AS "Stock" 
FROM peachtree 
```

# php - 特定和广泛的 MySQL 搜索

> ID：14242099
> 
> 赞同：1
> 
> 时间：2013-01-09T16:45:27.110
> 
> 标签：php, mysql

我有一个网页，用户可以使用 5 个不同的输入字段搜索 mysql 数据库，每个输入字段都匹配 mysql 表的一列。到目前为止，他们可以搜索数据库，但所有字段都必须与表中的内容完全匹配，一大堆 LIKE 和 AND 语句，才能返回任何结果。我想要做的是，如果他们只知道前两个字段，而不是数据库返回包含给定信息的所有实例。此外，如果用户填写的字段多于前两个字段，则查询将考虑这一点，并返回与给定信息匹配的所有结果。我查看了加权搜索，我认为这会让我接近我需要的结果，但在我看来，加权搜索总是会返回结果，只是更准确的搜索会在顶部，如果没有找到结果，我正在做的事情不应该返回任何结果。如果你们可以帮助我编写代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:55:05.173

使用 PHP 部分构建查询，如果存在值，则添加所需的部分。所以是这样的：

```
$sql = "SELECT * FROM table WHERE 1";
$sql = .= (if(isset($_POST['field1']) && $_POST['field1'])?' AND field1='{$_POST['field1']}':'';
//etc 
```

显然，这是一个基本示例，不应按原样使用。您必须确保在查询中使用用户提供的输入之前对其进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:17:26.180

您必须先找出哪些参数不为空：

```
foreach $_POST as $param {
$params[] = $param;
} 
```

那么你必须为 WHERE attr 做一个长表达式：

```
$query = "";
foreach $params as $param_name=>$param {
$query .= " && ".$param_name."=".$param;
}
// output: " && age=15 && gender=female && eyes=brown" 
```

最后在开始时制作一个没有“&&”的SELECT：

```
$query = "SELECT * FROM table WHERE".substr($query,3); 
```

# ios - 键入uitext字段时如何执行事件

> ID：14242100
> 
> 赞同：0
> 
> 时间：2013-01-09T16:45:28.277
> 
> 标签：ios, objective-c, uitextfield, uitextview

在 UITextField 中发生打字时如何执行操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:47:06.653

首先将您的 UITextField 的委托设置为您的班级。

如果您想在用户键入任何内容后立即调用事件，请实现此方法，

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{
     NSLog(@"call your method");
    [self goMethodCall];
    return YES;
} 
```

如果你想要除此之外的东西，你的代表就更少了。

自动调用的委托很少......

```
– textFieldShouldBeginEditing:
– textFieldDidBeginEditing:
– textFieldShouldEndEditing:
– textFieldDidEndEditing:
– textField:shouldChangeCharactersInRange:replacementString:
– textFieldShouldClear:
– textFieldShouldReturn: 
```

在任何方法中调用您的操作。

找到适合你的..[在这里](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T16:47:34.047

当文本字段的文本发生更改时，有多种通知方式：

1.  实现`UITextField`委托方法`textField:shouldChangeCharactersInRange:replacementString:`
2.  注册`UITextFieldTextDidChangeNotification`通知。
3.  `UIControlEventEditingChanged`为文本字段上的控制事件添加操作/目标。

# asp-classic - ado 命令对象语法错误

> ID：14242106
> 
> 赞同：0
> 
> 时间：2013-01-09T16:45:42.307
> 
> 标签：asp-classic, parameters, command, adodb

我正在尝试将一些现有代码从构造的 sql 字符串更改为存储过程。这是错误。

Microsoft OLE DB Provider for Visual FoxPro 错误 '80040e14'

语法错误。

我检查了连接详细信息，它们很好，我检查了参数值，它们很好。

枚举：adVarChar 值 = 200；adInteger 值 = 3; adParamInput 值 = 1；adBolean value = 11 ' 完整列表[http://www.w3schools.com/ado/met_comm_createparameter.asp](http://www.w3schools.com/ado/met_comm_createparameter.asp)

```
 Dim adoCMD 
 Dim adoRS 
 Dim strSQL 
 Dim lRecordsAffected 

strSQL =  "insert into job account,reference,priority,colldate,deldate,onby,timestart,timeend,delname,deladd1,deladd2,deladd3,deltown,delcounty,delpostcode,goods,wgt,qty,plt,vol,haz,adr,adrpack,taillift,rigid,ringforbook,notes,phoneno,userid,confirmed,processed,adrname,adrchem,timestartc,timeendc,confno,jobno,fplt,hplt,qplt,coll1,coll2,coll3,coll4,coll5,collp,colname,printed,cheps,countryd,countryc,uniqueid,co2,carbon,am,pm,instructs,quote,validdel,validcol values(?,?,?,?,?,?,?,?,?,?  ,?,?,?,?,?,?,?,?,?,?  ,?,?,?,?,?,?,?,?,?,?  ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,?  ,?,?,?,?,?,?,?,?,?,?)"

Set adoCMD = Server.CreateObject("ADODB.Command")
With adoCMD
.ActiveConnection = conn
.CommandType = 1
.CommandText = strSQL
.parameters.Append .CreateParameter("account", 200, 1, 16 , cCustcode)         '200 adVarChar'
.parameters.Append .CreateParameter("reference", 200, 1, 40 , cReference)
.parameters.Append .CreateParameter("priority", 200, 1, 3 , cPriority)
.parameters.Append .CreateParameter("colldate", 200 ,1 , 8 , cCollDate)
.parameters.Append .CreateParameter("deldate", 200, 1, 8 , cDelDate)
.parameters.Append .CreateParameter("onby", 3, 1, 4 , nOnby)
.parameters.Append .CreateParameter("timestart", 200, 1, 4 , cTimestart)
.parameters.Append .CreateParameter("timeend", 200, 1, 4 , cTimeend)
.parameters.Append .CreateParameter("delname", 200, 1, 40 , cDelname)
.parameters.Append .CreateParameter("deladd1", 200, 1, 40 , cAdd1)
.parameters.Append .CreateParameter("deladd2", 200, 1, 40 , cAdd2)
.parameters.Append .CreateParameter("deladd3", 200, 1, 40 , cAdd3)
.parameters.Append .CreateParameter("deltown", 200, 1, 40 , cAdd4)
.parameters.Append .CreateParameter("delcounty", 200, 1, 40 , cAdd5)
.parameters.Append .CreateParameter("delpostcode", 200, 1, 10 , cPostcode)
.parameters.Append .CreateParameter("goods", 200, 1, 40 , cGoods)
.parameters.Append .CreateParameter("wgt", 200, 1, 4 , nWgt)
.parameters.Append .CreateParameter("qty", 200, 1, 4 , nQty)
.parameters.Append .CreateParameter("plt", 200, 1, 4 , nPlt)
.parameters.Append .CreateParameter("vol", 200, 1, 4 , nVol)
.parameters.Append .CreateParameter("haz", 200, 1, 4 , nHaz)
.parameters.Append .CreateParameter("adr", 200, 1, 10 , cadr)
.parameters.Append .CreateParameter("adrpack", 200, 1, 10 , cAdrpack)
.parameters.Append .CreateParameter("taillift", 200, 1, 4 , nTl)
.parameters.Append .CreateParameter("rigid", 200, 1, 4 , nRi)
.parameters.Append .CreateParameter("ringforbook", 200, 1, 4 , nBook)
.parameters.Append .CreateParameter("notes", 200, 1, 250 , cNotes)
.parameters.Append .CreateParameter("phoneno", 200, 1, 30 , cPhoneNo)
.parameters.Append .CreateParameter("userid", 200, 1, 4 , session("userid"))
.parameters.Append .CreateParameter("confirmed", 200, 1, 4 ,0)
.parameters.Append .CreateParameter("processed", 200, 1, 4 ,0)
.parameters.Append .CreateParameter("adrname", 200, 1, 30 ,cAdrname)
.parameters.Append .CreateParameter("adrchem", 200, 1, 10 ,cAdrchem)
.parameters.Append .CreateParameter("timestartc", 200, 1, 4 ,ctimestartcol)
.parameters.Append .CreateParameter("timeendc", 200, 1, 4 ,ctimeendcol)
.parameters.Append .CreateParameter("confno", 200, 1, 4 ,0)
.parameters.Append .CreateParameter("jobno", 200, 1, 4 ,0)
.parameters.Append .CreateParameter("fplt", 200, 1, 4 , nfPlt)
.parameters.Append .CreateParameter("hplt", 200, 1, 4 , nhPlt)
.parameters.Append .CreateParameter("qplt", 200, 1, 4 , nqPlt)
.parameters.Append .CreateParameter("coll1", 200, 1, 30 ,cColl1)
.parameters.Append .CreateParameter("coll2", 200, 1, 30 ,cColl2)
.parameters.Append .CreateParameter("coll3", 200, 1, 30 ,cColl3)
.parameters.Append .CreateParameter("coll4", 200, 1, 30 ,cColl4)
.parameters.Append .CreateParameter("coll5", 200, 1, 30 ,cColl5)
.parameters.Append .CreateParameter("collp", 200, 1, 30 ,cCollp)
.parameters.Append .CreateParameter("colname", 200, 1, 30 ,cColname)
.parameters.Append .CreateParameter("printed", 11, 1, 1 ,false)
.parameters.Append .CreateParameter("cheps", 200, 1, 4 ,nCheps)
.parameters.Append .CreateParameter("countryd", 200, 1, 30 ,ccountryd)
.parameters.Append .CreateParameter("countryc", 200, 1, 30 ,ccountryc)
.parameters.Append .CreateParameter("uniqueid", 200, 1, 30 ,cUniqueId)
.parameters.Append .CreateParameter("co2", 200, 1, 10 , request.form("cC02"))
.parameters.Append .CreateParameter("carbon", 200, 1, 10 , request.form("cCarbon"))
.parameters.Append .CreateParameter("am", 200, 1, 4 ,nAM)
.parameters.Append .CreateParameter("pm", 200, 1, 4 ,nPM)
.parameters.Append .CreateParameter("instructs", 200, 1, 50 ,cSpecialInstruct)
.parameters.Append .CreateParameter("quote", 200, 1, 59 , trim(cQuoteId))
.parameters.Append .CreateParameter("validdel", 11, 1, 1 , lValidDel)
.parameters.Append .CreateParameter("validcol", 11, 1, 1 , lValidCol)
.Execute   ------> this line errors

end with 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T09:58:23.833

您缺少字段列表的括号，因此出现语法错误。

你需要做什么：

```
strSQL =  "insert into job (account, ...,validcol) values (?, ..., ?)" 
```

# javascript - 我可以在后台静默加载 javascript 或图像文件吗？

> ID：14242109
> 
> 赞同：2
> 
> 时间：2013-01-09T16:45:44.997
> 
> 标签：javascript

我的应用程序有一个非常简单的主页，用作登录网关。用户必须先到这个页面。该页面没有 jQuery，一个非常小的 javascript 文件和一个小的 CSS 文件。它加载很快。

当用户专注于屏幕并开始输入登录详细信息或阅读标题和其他信息时，我想通过预加载一些图像、CSS 或 javascript 来充分利用这段时间，以便在用户登录时做好准备进入下一个屏幕。

有没有一种方法可以让我默默地做到这一点（希望用户在加载资源时不会在屏幕底部看到）。我只想加载几个文件，以尽量减少打开下一个屏幕所需的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:49:39.297

这可以通过将图像路径放在您的 CSS 类中来完成。所以加载 CSS 类也会加载图片。同样，您也可以使用 javascript 预加载图像。

以下是我项目的示例片段；这里的图像正在使用 jquery 加载。你也可以在纯 javascript 中做同样的事情。

```
 loadImages : function(){
    this.picBaseUrl = BASE_URL + this.id + '/';  //base path for all images
    $('#p1').attr('src', this.picBaseUrl + '1.jpg');
    $('#p2').attr('src', this.picBaseUrl + '2.jpg');
    $('#p3').attr('src', this.picBaseUrl + '3.jpg');
    $('#p4').attr('src', this.picBaseUrl + '4.jpg');
    $('#p5').attr('src', this.picBaseUrl + '5.jpg');
} 
```

所以在这里我已经加载了 5 张图片。只要确保在要加载这些图像时调用此方法即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T16:53:32.110

在<头>中：

```
<script src='' id="s1" type="text/javascript"></script> 
```

在页面末尾：

```
<script type="text/javascript">
var s1 = document.getElementById("s1");
s1.src= "myJavaScript.js";
</script>
</body> 
```

您可以在 myJavaScript.js 中加载所有资源，它们将在您的页面完全加载后加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:05:06.650

可以通过以下方式加载图像：

```
var img = new Image();
img.onload = function() {
     //image loaded
};
img.src = "image.png"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T16:56:27.477

如果没有 JQuery，我认为将 onload 事件用于 body 标记。所以像（未经测试）：

```
<script>
function preLoad() {

document.getElementById("img1").src = "/images/image1toPreload.png";
document.getElementById("img2").src = "/images/image2toPreload.png";
document.getElementById("img3").src = "/images/image3toPreload.png";
}
</script>

...

<body onload="preLoad()">

your content here
...

<img style="display:none" id="img1"/>
<img style="display:none" id="img2"/>
<img style="display:none" id="img3"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T17:09:11.683

在您的页面上创建 n 个 div，每个缓存图像 1 个，然后为它们定义 css。

```
#Div1 {
background: url(path/cachedImage1.png) no-repeat;
display: none;
}
#Div2 {
background: url(path/cachedImage2.png) no-repeat;
display: none;
}
#Div3 {
background: url(path/cachedImage3.png) no-repeat;
display: none;
} 
```

# java - 在 Java 运行时从 zip 文件中读取 ESRI shapefile - DataStoreFinder.getDataStore(connectParameters) 返回 null

> ID：14242111
> 
> 赞同：9
> 
> 时间：2013-01-09T16:45:46.250
> 
> 标签：java, null, unzip, geotools

我们正在构建一个用于上传包含 ESRI-shapefile 的 zip 文件的服务。该服务应该能够读取 shapefile 并对其内容进行处理。因此，我构建了一个将 zip 文件解压缩到临时文件夹（System.getProperty("java.io.tmpdir") 的子文件夹）的类。

另一个类从 Unzip 类调用 unzip 方法，然后尝试使用 Geotools 读取解压后的 shapefile。它使用 Geotools DataStoreFinder.getDataStore(Map params) 方法从解压缩的 shapefile 创建数据存储。这里出现了问题：getDataStore 方法返回 null。我测试了网址，它看起来没问题。派生 URL 的文件存在，是一个文件，可以由应用程序读取（使用 shapefile.exists()、shapefile.isFile()、shapefile.canRead() 进行测试）。那么，有什么问题呢？为什么我会返回 null？

这是（相关的）代码：

```
import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;
import org.geotools.data.DataStore;
import org.geotools.data.DataStoreFinder;
import org.geotools.data.FeatureSource;
import org.geotools.feature.FeatureCollection;
import org.geotools.feature.FeatureIterator;
import org.opengis.feature.simple.SimpleFeature;
import org.opengis.feature.simple.SimpleFeatureType;

import com.geodan.equus.entity.dataset.BasicFeature;
import com.geodan.equus.exception.EquusException;
import com.geodan.equus.processor.EquusProcessor;
import com.geodan.util.io.UnzipUtils;
import com.vividsolutions.jts.geom.Geometry;

public class ShapefileProcessor implements EquusProcessor
{

    private static final File TEMP_UNZIP_DIR = new File(
        System.getProperty("java.io.tmpdir") + File.separator
                + "atlas_temp_unzip_dir");

    public static Set<BasicFeature> importFeatures(final File zipFile)
        throws EquusException
    {
        // Check if the input file has the zipfile extension 
        if (!zipFile.getName().endsWith(".zip"))
        {
            throw new EquusException(
                    "The file is not a zipfile. It cannot be processed.");
        }

        // Unzip the file
        try
        {
            UnzipUtils.unzip(zipFile, TEMP_UNZIP_DIR);
        }
        catch (IOException error)
        {
            throw new EquusException("The zipfile cannot be unzipped.", error);
        }

        // Validate whether the unzipped folder contains a shapefile and return it
        File shapefile = new File("");
        try
        {
            shapefile = findShapefile(TEMP_UNZIP_DIR);
        }
        catch (IOException error)
        {
            throw new EquusException(
                    "The zipfile does not contain a shapefile. Cannot process its contents.",
                error);
        }

        // Collect the features from the shapefile and put them into an iterator 
        FeatureIterator<SimpleFeature> featureIterator;
        try
        {
            featureIterator = readShapefile(shapefile);
        }
        catch (EquusException e)
        {
            throw new EquusException(e.getMessage(), e);
        }

        // Create a Set filled with the features in the FeatureIterator
        Set<BasicFeature> features = createFeatureSet(featureIterator);

        return features;

    }

    private static File findShapefile(File unzipPath) throws IOException
    {
        File shapefile = new File("");
        // Find first .shp file in the unzip folder
        File[] unzippedFiles = unzipPath.listFiles();
        for (int i = 0; i < unzippedFiles.length; i++)
        {
            if (unzippedFiles[i].getName().endsWith(".shp"))
            {
                shapefile = new File(unzipPath + File.separator
                        + unzippedFiles[i].getName());
                break;
            }
        }
        if (shapefile.toString() == "")
        {
            throw new IOException("No shapefile present in '" + unzipPath
                + "'.");
        }
        return shapefile;
    }

    private static FeatureIterator<SimpleFeature> readShapefile(File shapefile)
        throws EquusException
    {
        // Collects the features from a shapefile and puts them into an iterator
        FeatureCollection<SimpleFeatureType, SimpleFeature> featureCollection;
        try
        {
            Map<String, URL> connectParameters = new HashMap<String, URL>();
            connectParameters.put("url", shapefile.toURI().toURL());
            DataStore dataStore = DataStoreFinder.getDataStore(connectParameters);
            String typeName = dataStore.getTypeNames()[0];
            FeatureSource<SimpleFeatureType, SimpleFeature> featureSource = dataStore.getFeatureSource(typeName);
                featureCollection = featureSource.getFeatures();
        }
        catch (Exception e)
        {
            throw new EquusException(
                    "Features cannot be retrieved from the shapefile.", e);
        }
        return featureCollection.features();
    }

    private static Set<BasicFeature> createFeatureSet(
            FeatureIterator<SimpleFeature> featureIterator)
    {
        SimpleFeature simpleFeature = null;
        Set<BasicFeature> features = new HashSet<BasicFeature>();
        while (featureIterator.hasNext())
        {
            simpleFeature = featureIterator.next();
            BasicFeature feature = new BasicFeature();
            feature.setGeometry((Geometry) simpleFeature.getDefaultGeometry());
            features.add(feature);
        }
        return features;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-31T15:57:55.863

只需使用这样的构造函数`ShapefileDataStore`：

```
// URL url = file.toURI().toURL();
DataStore shapefileStore = new ShapefileDataStore(url) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-15T11:19:40.010

尽管您的代码看起来是正确的，但我发现我们代码库中关键行的实现略有不同：

```
Map<String, Object> map = new HashMap<>();
map.put(ShapefileDataStoreFactory.URLP.key, url);
map.put(ShapefileDataStoreFactory.CREATE_SPATIAL_INDEX.key, Boolean.TRUE);
DataStore shapefileStore = DataStoreFinder.getDataStore(map); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-15T16:29:48.497

您的代码是正确的，但您的类路径缺少 ShapeFileDataStore。通过添加例如：`gt2-shapefile-2.3.2.jar`

或者直接使用

```
DataStore shapefileStore = new ShapefileDataStore(url) 
```

这具有您将立即看到的优点，即您的代码由于缺少 shapefile 库而无法编译。

和

```
Iterator availableStores =  DataStoreFinder.getAvailableDataStores(); 
```

您可以输出所有可用数据存储的列表。如果为空或没有列出 ShapefileDataStoreFactory，您将知道原因是类路径。

# .net - 如何从 C# 文件中删除字符的所有实例？

> ID：14242112
> 
> 赞同：2
> 
> 时间：2013-01-09T16:45:47.610
> 
> 标签：.net, xmltextreader

我正在处理来自第三方的 XML 文件。这些文件中偶尔会包含无效字符，这会导致`XMLTextReader.Read()`引发异常。

我目前正在使用以下功能处理此问题：

```
XmlTextReader GetCharSafeXMLTextReader(string fileName)
{
    try
    {
        MemoryStream ms = new MemoryStream();
        StreamReader sr = new StreamReader(fileName);
        StreamWriter sw = new StreamWriter(ms);
        string temp;
        while ((temp = sr.ReadLine()) != null)
            sw.WriteLine(temp.Replace(((char)4).ToString(), "").Replace(((char)0x14).ToString(), ""));

        sw.Flush();
        sr.Close();
        ms.Seek(0, SeekOrigin.Begin);
        return new XmlTextReader(ms);
    }
    catch (Exception exp)
    {
        throw new Exception("Error parsing file: " + fileName + " " + exp.Message, exp.InnerException);
    }
} 
```

我的直觉是应该有更好/更快的方法来做到这一点。（是的，让第三方修复他们的 XML 会很棒，但目前还没有发生。）

编辑：这是基于 cfeduke 的回答的最终解决方案：

```
 public class SanitizedStreamReader : StreamReader
    {
        public SanitizedStreamReader(string filename) : base(filename) { }
        /* other ctors as needed */
        // this is the only one that XmlTextReader appears to use but
        // it is unclear from the documentation which methods call each other
        // so best bet is to override all of the Read* methods and Peek
        public override string ReadLine()
        {
            return Sanitize(base.ReadLine());
        }

        public override int Read()
        {
            int temp = base.Read();
            while (temp == 0x4 || temp == 0x14)
                temp = base.Read();
            return temp;
        }

        public override int Peek()
        {
            int temp = base.Peek();
            while (temp == 0x4 || temp == 0x14)
            {
                temp = base.Read();
                temp = base.Peek();
            }
            return temp;
        }

        public override int Read(char[] buffer, int index, int count)
        {
            int temp = base.Read(buffer, index, count);
            for (int x = index; x < buffer.Length; x++)
            {
                if (buffer[x] == 0x4 || buffer[x] == 0x14)
                {
                    for (int a = x; a < buffer.Length - 1; a++)
                        buffer[a] = buffer[a + 1];
                    temp--; //decrement the number of characters read
                }  
            }
            return temp;
        }

        private static string Sanitize(string unclean)
        {
            if (unclean == null)
                return null;
            if (String.IsNullOrEmpty(unclean))
                return "";
            return unclean.Replace(((char)4).ToString(), "").Replace(((char)0x14).ToString(), "");
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:10:09.423

清理数据很重要。有时边缘情况——“XML”中的无效字符——确实会发生。你的解决方案是正确的。如果您想要一个适合 .NET 框架的解决方案来进行流式处理，请重组您的代码以适合其自己的流：

```
public class SanitizedStreamReader : StreamReader {
  public SanitizedStreamReader(string filename) : base(filename) { }
  /* other ctors as needed */

  // it is unclear from the documentation which methods call each other
  // so best bet is to override all of the Read* methods and Peak
  public override string ReadLine() {
    return Sanitize(base.ReadLine());
  }

  // TODO override Read*, Peak with a similar logic as this.ReadLine()
  // remember Read(Char[], Int32, Int32) to modify the return value by
  // the number of removed characters

  private static string Sanitize(string unclean) {
    if (String.IsNullOrEmpty(unclean)
      return "";
    return unclean.Replace(((char)4).ToString(), "").Replace(((char)0x14);
  }
} 
```

有了这个新`SanitizedStreamReader`功能，您将能够根据需要将其链接到处理流中，而不是依赖一种神奇的方法来清理事物并为您提供 XmlTextReader：

```
return new XmlTextReader(new SanitizedStreamReader("filename.xml")); 
```

诚然，这可能比必要的工作量更大，但您将从这种方法中获得灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:12:22.077

除了 XML 问题，如果文件不够大，无法保证按顺序处理，我会将代码简化为以下几行：

```
var xml = File.ReadAllText(pathName);
var fixedXml = xml.Replace(((char)4).ToString(), "").Replace(((char)0x14).ToString(), "");
File.WriteAllText(pathName, fixedXml); 
```

# java - Java 库为 Postgres COPY 编写二进制格式？

> ID：14242117
> 
> 赞同：7
> 
> 时间：2013-01-09T16:45:59.913
> 
> 标签：java, postgresql

有没有人遇到过 Java 库（或只是一些代码）来编写`binary`Postgres 的[COPY 命令](http://www.postgresql.org/docs/9.2/interactive/sql-copy.html#AEN66736)使用的格式？

它看起来很简单，但如果有人已经找到了正确的元组数据格式，我也可以从那里开始。

实际上，即使只是对所有数据类型的格式的描述也会有所帮助。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-02-11T14:39:31.703

您可以尝试[PgBulkInsert](https://github.com/bytefish/PgBulkInsert)，它实现了 PostgreSQL 的二进制复制协议：

*   [https://github.com/bytefish/PgBulkInsert](https://github.com/bytefish/PgBulkInsert)

它也可以从 Maven 中央存储库中获得。

免责声明：我是项目作者。

# PostgreSQL 二进制复制协议

我不想简单地宣传我的项目，还要写下协议。

首先，我编写了一个类`PgBinaryWriter`，它包装了一个`DataOutputStream`并具有编写二进制协议标题的方法，一个开始新行的方法（二进制复制协议要求您为要插入的每一行写入列数) 和一个`write`方法，它接受一个`IValueHandler<TTargetType>`用于编写给定 Java 类型的方法。

`PgBinaryWriter`实现 a `AutoClosable`，因为有必要在刷新和关闭流之前将 a 写入流`-1`。

`IValueHandler<TTargetType>`接受一个`DataOutputStream`和一个值。它负责使用 PostgreSQL 二进制协议格式写入给定值。

## PgBinaryWriter

```
// Copyright (c) Philipp Wagner. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for full license information.

package de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.pgsql;

import de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.exceptions.BinaryWriteFailedException;
import de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.pgsql.handlers.IValueHandler;

import java.io.BufferedOutputStream;
import java.io.DataOutputStream;
import java.io.OutputStream;

public class PgBinaryWriter implements AutoCloseable {

    /** The ByteBuffer to write the output. */
    private transient DataOutputStream buffer;

    public PgBinaryWriter() {
    }

    public void open(final OutputStream out) {
        buffer = new DataOutputStream(new BufferedOutputStream(out));

        writeHeader();
    }

    private void writeHeader() {
        try {

            // 11 bytes required header
            buffer.writeBytes("PGCOPY\n\377\r\n\0");
            // 32 bit integer indicating no OID
            buffer.writeInt(0);
            // 32 bit header extension area length
            buffer.writeInt(0);

        } catch(Exception e) {
            throw new BinaryWriteFailedException(e);
        }
    }

    public void startRow(int numColumns) {
        try {
            buffer.writeShort(numColumns);
        } catch(Exception e) {
            throw new BinaryWriteFailedException(e);
        }
    }

    public <TTargetType> void write(final IValueHandler<TTargetType> handler, final TTargetType value) {
        handler.handle(buffer, value);
    }

    @Override
    public void close() {
        try {
            buffer.writeShort(-1);

            buffer.flush();
            buffer.close();
        } catch(Exception e) {
            throw new BinaryWriteFailedException(e);
        }
    }
} 
```

## 值处理程序

An`IValueHandler`是一个简单的接口，它有一个`handle`方法来获取`DataOutputStream`和一个值。

```
// Copyright (c) Philipp Wagner. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for full license information.

package de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.pgsql.handlers;

import java.io.DataOutputStream;
import java.lang.reflect.Type;

public interface IValueHandler<TTargetType> extends ValueHandler {

    void handle(DataOutputStream buffer, final TTargetType value);

    Type getTargetType();

} 
```

了解协议很重要，`-1`当值为空时您必须编写 a 。为此，我编写了一个抽象基类来处理这种情况。

```
// Copyright (c) Philipp Wagner. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for full license information.

package de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.pgsql.handlers;

import de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.exceptions.BinaryWriteFailedException;

import java.io.DataOutputStream;

public abstract class BaseValueHandler<T> implements IValueHandler<T> {

    @Override
    public void handle(DataOutputStream buffer, final T value) {
        try {
            if (value == null) {
                buffer.writeInt(-1);
                return;
            }
            internalHandle(buffer, value);
        } catch (Exception e) {
            throw new BinaryWriteFailedException(e);
        }
    }

    protected abstract void internalHandle(DataOutputStream buffer, final T value) throws Exception;
} 
```

然后可以实现各种 Java 类型的处理程序。这是`long`. 您可以在 GitHub 存储库 ( [handlers](https://github.com/PgBulkInsert/PgBulkInsert/tree/master/PgBulkInsert/pgbulkinsert-core/src/main/java/de/bytefish/pgbulkinsert/pgsql/handlers) ) 中找到其他实现。

```
// Copyright (c) Philipp Wagner. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for full license information.

package de.bytefish.pgbulkinsert.de.bytefish.pgbulkinsert.pgsql.handlers;

import java.io.DataOutputStream;
import java.lang.reflect.Type;

public class LongValueHandler extends BaseValueHandler<Long> {

    @Override
    protected void internalHandle(DataOutputStream buffer, final Long value) throws Exception {
        buffer.writeInt(8);
        buffer.writeLong(value);
    }

    @Override
    public Type getTargetType() {
        return Long.class;
    }
} 
```

## 使用 PgBinaryWriter

现在终于要连接零件了。请注意，我已经抽象了更多部分。可能需要在代码中查找更多实现细节。

```
public abstract class PgBulkInsert<TEntity> {

    // ... 

    public void saveAll(PGConnection connection, Stream<TEntity> entities) throws SQLException {

        CopyManager cpManager = connection.getCopyAPI();
        CopyIn copyIn = cpManager.copyIn(getCopyCommand());

        int columnCount = columns.size();

        try (PgBinaryWriter bw = new PgBinaryWriter()) {

            // Wrap the CopyOutputStream in our own Writer:
            bw.open(new PGCopyOutputStream(copyIn));

            // Insert all entities:                
            entities.forEach(entity -> {

                // Start a New Row:
                bw.startRow(columnCount);

                // Insert the Column Data:
                columns.forEach(column -> {
                    try {
                        column.getWrite().invoke(bw, entity);
                    } catch (Exception e) {
                        throw new SaveEntityFailedException(e);
                    }
                });
            });
        }
    }

    private String getCopyCommand()
    {
        String commaSeparatedColumns = columns.stream()
                .map(x -> x.columnName)
                .collect(Collectors.joining(", "));

        return String.format("COPY %1$s(%2$s) FROM STDIN BINARY",
                table.GetFullQualifiedTableName(),
                commaSeparatedColumns);
    }
} 
```

# PgBulkInsert

PgBulkInsert 支持以下 PostgreSQL 数据类型。

*   [数值类型](http://www.postgresql.org/docs/current/static/datatype-numeric.html)
    *   小字
    *   整数
    *   大整数
    *   真实的
    *   双精度
*   [日期/时间类型](http://www.postgresql.org/docs/current/static/datatype-datetime.html)
    *   时间戳
    *   日期
*   [字符类型](http://www.postgresql.org/docs/current/static/datatype-character.html)
    *   文本
*   [布尔类型](http://www.postgresql.org/docs/current/static/datatype-boolean.html)
    *   布尔值
*   [二进制数据类型](http://www.postgresql.org/docs/current/static/datatype-binary.html)
    *   拜茶
*   [网络地址类型](http://www.postgresql.org/docs/current/static/datatype-net-types.html)
    *   inet (IPv4, IPv6)
*   [UUID 类型](http://www.postgresql.org/docs/current/static/datatype-uuid.html)
    *   uuid

## 基本用法

想象一下，应该将大量人员批量插入 PostgreSQL 数据库。每个`Person`人都有名字、姓氏和生日。

### 数据库表

PostgreSQL 数据库中的表可能如下所示：

```
CREATE TABLE sample.unit_test
(
    first_name text,
    last_name text,
    birth_date date
); 
```

### 领域模型

应用程序中的域模型可能如下所示：

```
private class Person {

    private String firstName;

    private String lastName;

    private LocalDate birthDate;

    public Person() {}

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public LocalDate getBirthDate() {
        return birthDate;
    }

    public void setBirthDate(LocalDate birthDate) {
        this.birthDate = birthDate;
    }

} 
```

### 批量插入器

然后你必须实现`PgBulkInsert<Person>`，它定义了表和域模型之间的映射。

```
public class PersonBulkInserter extends PgBulkInsert<Person>
{
    public PersonBulkInserter() {
        super("sample", "unit_test");

        MapString("first_name", Person::getFirstName);
        MapString("last_name", Person::getLastName);
        MapDate("birth_date", Person::getBirthDate);
    }
} 
```

### 使用批量插入器

最后我们可以编写一个单元测试来将`100000`Persons 插入数据库。您可以在 GitHub 上找到整个单元测试：[IntegrationTest.java](https://github.com/bytefish/PgBulkInsert/blob/master/PgBulkInsert/src/test/de/bytefish/pgbulkinsert/de/bytefish/pgbulkinsert/IntegrationTest.java)。

```
@Test
public void bulkInsertPersonDataTest() throws SQLException {
    // Create a large list of Persons:
    List<Person> persons = getPersonList(100000);

    // Create the BulkInserter:
    PersonBulkInserter personBulkInserter = new PersonBulkInserter();

    // Now save all entities of a given stream:
    personBulkInserter.saveAll(PostgreSqlUtils.getPGConnection(connection), persons.stream());

    // And assert all have been written to the database:
    Assert.assertEquals(100000, getRowCount());
}

private List<Person> getPersonList(int numPersons) {
    List<Person> persons = new ArrayList<>();

    for (int pos = 0; pos < numPersons; pos++) {
        Person p = new Person();

        p.setFirstName("Philipp");
        p.setLastName("Wagner");
        p.setBirthDate(LocalDate.of(1986, 5, 12));

        persons.add(p);
    }

    return persons;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T20:23:32.487

您是否考虑过只使用[`CopyManager`](http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/copy/CopyManager.html)JDBC 驱动程序中的 JDBC 驱动程序？否则，您可能可以从[`QueryExecutorImpl`](https://github.com/pgjdbc/pgjdbc/blob/master/org/postgresql/core/v3/QueryExecutorImpl.java).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-14T05:13:02.627

这个怎么样？我自己没有尝试过 - [https://github.com/uwescience/myria/blob/master/src/edu/washington/escience/myria/PostgresBinaryTupleWriter.java](https://github.com/uwescience/myria/blob/master/src/edu/washington/escience/myria/PostgresBinaryTupleWriter.java)

# linux - linux批量查找文件

> ID：14242120
> 
> 赞同：-1
> 
> 时间：2013-01-09T16:46:14.093
> 
> 标签：linux, shell

我有一个问题：我远程登录到一个linux系统。我有一堆文件名，我需要验证它们是否存在于某个目录 (/u02/csv) 和 /u02/csv 下的子目录下。我很快就觉得用 find 命令一一搜索这些文件已经筋疲力尽了。作为 linux 的新成员。有什么方法可以让 linux 从文本文件中读取文件名并搜索这些文件并将结果（例如，如果存在，只需列出路径，否则，就说不）到另一个文件？

顺便说一句，这个文件名列表在我的远程 PC 中，你能否建议我如何将它放入 linux 中？

提前非常感谢！

山姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T16:49:45.567

就像是

```
for line in $(cat files.txt)
do
   find /u02 -type f -name $line >> results.txt
done 
```

在哪里`files.txt`列出您的文件名，每行一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:01:54.077

另一种解决方案：

```
find /u02 -type f -name $(cat files.txt | xargs | sed 's/\W/ -o -name /g') >> results.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:16:59.903

一个干净、高效的解决方案，适用于名称中包含空格的文件：

```
while IFS= read -r file; do
   printf '%s ' "$file"
   if [[ -e "/u02/csv/$file" ]]; then
      printf 'exists.\n'
   else
      printf 'does not exist.\n'
   fi
done < files.txt > results.txt 
```

# javascript - 确定网页的宽度（以英寸为单位）

> ID：14242125
> 
> 赞同：7
> 
> 时间：2013-01-09T16:46:25.063
> 
> 标签：javascript, width, document, dynamic-resizing, inches

我有一个 CSS 样式表，它使用媒体查询来根据页面宽度的多少英寸来更改页面的显示方式（例如，如果它小于 4 英寸或在手持设备上显示，它假设更移动 -友好的 LAF）。

我遇到的问题是它的内容。在主页上，有一个停靠式界面，可以根据窗口的当前高度和宽度动态改变高度，从而使文本和项目永远不会离开屏幕。但是，**我决定这个大小的 JS 不知道样式表何时更改**为手持设备或小屏幕，所以行为在这种模式下不可预测地继续。**我如何使用 JavaScript 检测页面何时小于或等于 4 英寸，以便我可以禁用当时改革后的停靠栏的自动调整大小？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T16:54:48.490

这是一个不平凡的问题。

这是一个网站的链接，该网站的功能 ( `getUnits`) 以您选择的测量单位（包括英寸）获取当前计算的样式[https://web.archive.org/web/20120427144951/http://upshots.org :80/javascript/javascript-get-current-style-as-any-unit](https://web.archive.org/web/20120427144951/http://upshots.org:80/javascript/javascript-get-current-style-as-any-unit)

使用此功能，您可以检查`if (getUnits(document.body, "width").inch < 4)`. 出于好奇，此功能的工作方式是在所需的测量空间中创建一个临时元素并读取与像素的比率。通过这种方式，您可以让浏览器根据自己对设备 PPI 的了解做出响应。所以这是一种针对`window.devicePixelRatio`. 但是，出于这些目的，这并不重要，因为它们会将相同的谎言应用于您的英寸单位 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-31T03:14:40.053

我不在真正的浏览器上测试它，但它应该可以工作：

1.  `<div id="screen" style="display:none">`在您的 HTML 中设置隐藏。

2.  在 CSS 中，使用媒体查询，例如：

    ```
     @media screen
      { div#screen{color: blue;} }

      @media screen and (min-width: 13in)
      { div#screen{color: red;} } 
    ```

然后你可以在 JS 中读取`div#screen`颜色来选择动作。

此外，您应该将 windows resize 事件纳入 JS 考虑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T16:53:15.007

您所能做的就是回读已知元素的当前样式。通过查看诸如外包装 DIV 的宽度之类的内容，您可以确定媒体查询中正在使用哪个样式表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T16:58:28.737

我认为您从错误的角度看待问题。你不应该考虑英寸。你需要知道的是：给定设备和浏览器，我的页面应该有多少像素？

答案在于保持一组已知的设备及其各自的像素高度。

例如，iPhone 5 比 iPhone 4 高，这会影响您想要的效果。

# c# - 为 Listview 中的特定列添加数据

> ID：14242126
> 
> 赞同：1
> 
> 时间：2013-01-09T16:46:29.863
> 
> 标签：c#, winforms, listview

我正在尝试为我的练习创建一个迷你总指挥官。此时，我想像`C:\D:\E:\`标准总指挥官一样将数据添加到列中。目前有 3 列。*名称*、*类型*、*修改日期*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:58:25.293

当您将项目添加到列表视图时，子项目将映射到列（按索引）。因此，如果您在 中有三列`ListView`，那么您应该提供`ListViewItem`三个子项：

```
string path = @"D:\";
var items = from file in new DirectoryInfo(path).EnumerateFiles()
            select new ListViewItem(new string[] {
                    Path.GetFileNameWithoutExtension(file.Name), // Name
                    Path.GetExtension(file.Name).Replace(".", ""), // Type
                    file.CreationTime.ToString()  // Date Modified               
                });

listView.Items.AddRange(items.ToArray()); 
```

不要忘记将 ListView 视图模式设置为`View.Details`- 否则您将看不到列。

# c# - 异步模式 - 在从方法返回某个值之前等待事件

> ID：14242129
> 
> 赞同：4
> 
> 时间：2013-01-09T16:46:40.773
> 
> 标签：c#, asynchronous, async-await

[免责声明 - 此代码被简化（很多）以易于阅读，我知道它不符合正常代码标准]

我的问题可以在下面的代码中看到。基本上我有一个解析对象的调用者。我必须等到子组件完成（由事件发出信号），然后从基于子组件上的某个值的值返回一个值。

问题是：在这种情况下，首选模式是什么（当然，最欢迎实际的解决方案）。

我已经围绕 TaskCompletionSource 等尝试了不同的东西，但恐怕我的理解远远落后于找到（最好）优雅的解决方案。希望你能帮忙。

```
public class AsyncEventTest
{
    // This is performed one a single (UI) thread. The exception to this is
    // a.B that might - at the calling time - get a asycronious update from the backend.
    // The update is syncronized into the calling context so Task.Wait etc. will effectivly
    // deadlock the flow.
    public static string CallMe(A a)
    {
        if (a.B.State != State.Ready)
        {
            // wait for a.B.State == State.Ready ... but how ...
            // await MagicMethod() ???;
        }

        // only execute this code after a.b.State == State.Ready
        return a.B.Text;
    }
}

public class A
{
    public B B { get; set; }
}

public class B
{
    public State State { get; private set; }
    public event Action StateChanged;
    public string Text { get; }
}

public enum State { Ready, Working, } 
```

编辑-我尝试过的示例我想知道这样的方法是否可以接受（或者它是否有效）？

```
public class AsyncEventTest2
{
    public static string CallMe(A a)
    {
        return CallMe1(a).Result;
    }

    public async static Task<string> CallMe1(A a)
    {
        await CallMe2(a);
        return a.B.Text;
    }

    public static Task CallMe2(A a)
    {
        TaskCompletionSource<string> tcs = new TaskCompletionSource<string>();
        if (a.B.State != State.Ready)
        {
            a.B.StateChanged += () =>
                {
                    if (a.B.State == State.Ready)
                        tcs.SetResult(a.B.Text);
                };
        }
        else
        {
            tcs.SetResult(a.B.Text);
        }

        return tcs.Task;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:10:23.220

您可以注册该`StateChanged`活动并使用`TaskCompletionSource`.

```
public static Task WaitForReady(this B b)
{
    TaskCompletionSource<object> tcs = new TaskCompletionSource<object>();
    Action handler = null;
    handler = () =>
    {
        if (b.State == State.Ready)
        {
            b.StateChanged -= handler;
            tcs.SetResult(null);
        }
    };

    b.StateChanged += handler;
    return tcs.Task;
} 
```

请注意，如果在处理程序注册之前可以引发事件，则可能会发生竞争。

# android - android上的设备特定屏幕捕获

> ID：14242131
> 
> 赞同：1
> 
> 时间：2013-01-09T16:46:46.483
> 
> 标签：android, screen, capture

我们需要找到一种在不使用任何外部软件的情况下捕获 Android 屏幕的方法，该方法可以在非 root 手机上运行。

我的研究表明，没有办法做到这一点。无论如何，您应该具有 root 权限，以便能够捕获设备的屏幕。

然而，进一步的研究表明，有一种方法可以让有限数量的设备做到这一点，而无需拥有 root 权限。作为证明，我可以在 Android 市场上推出以下应用程序：Screenshot UX。

它声称，该应用程序不需要root权限即可在以下设备上捕获屏幕：

*   银河系列 (S,S2,...)
*   HTC 手机（感觉，...）
*   摩托罗拉（Atrix，...）。
*   LG 擎天柱系列 (G2X, ...)

有人说，Tegra 设备也支持这一点。

任何人都可以指出一些文档，至少在特定设备上，这样我们至少可以支持 HTC 手机，例如。

编辑：现在我们正在尝试使用“/system/bin/screencap”，但在模拟器上没有成功。是否可以在某些设备上截屏仅意味着它们允许使用“/system/bin/screencap”或直接从/dev/graphics/fb0 读取？

或者他们提供了一些用于截屏的 API？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-11T13:55:43.093

屏幕截图是 android 上一个古老且被广泛讨论的话题。在过去几年中，开发了几个主要选项：

1.  在有根设备上运行 screencap，但您已经知道这一点。

2.  运行 screencap 并使用系统证书对您的应用程序进行签名：

有一个权限 READ_FRAME_BUFFER 但只有当您的应用程序被签名为系统应用程序时才能获得它。

3.  使用各种 ADB 技巧，但其中大多数使用屏幕截图，AFAIK 要求您将设备连接到 PC。

[但自从 Android 5 以来，情况发生了变化。](https://developer.android.com/about/versions/android-5.0.html)

> Android 5.0 允许您使用新的 android.media.projection API 为您的应用添加屏幕捕获和屏幕共享功能。此功能很有用，例如，如果您想在视频会议应用程序中启用屏幕共享。
> 
> 新的 createVirtualDisplay() 方法允许您的应用程序将主屏幕（默认显示）的内容捕获到 Surface 对象中，然后您的应用程序可以通过网络发送该对象。该 API 仅允许捕获非安全屏幕内容，而不是系统音频。要开始截屏，您的应用必须首先通过使用通过 createScreenCaptureIntent() 方法获得的 Intent 启动截屏对话框来请求用户的许可。

你提到的设备已经很老了，我怀疑他们是否得到了 android 5 的官方更新，这给你留下了第二个选择。

# c# - C# 远程 MySQL - 拒绝用户访问

> ID：14242134
> 
> 赞同：0
> 
> 时间：2013-01-09T16:46:49.103
> 
> 标签：c#, mysql

我似乎无法`MySQL`使用 C# 连接到我的远程数据库。当我使用`MySQL Workbench`时，我能够成功连接。但是当我通过连接字符串与 C# 连接时，我得到：

*用户 'username'@'myipaddress' 拒绝访问数据库 'drawingnumbers'*

我的连接字符串：

```
 connectionString = "server=" + server + ";user=" + uid + ";database=" + database + ";port=" + port + ";password=" + password + ";"; 
```

我试过的：

1.  在 cpanel 上的远程 MySQL 连接中添加了我的本地和外部 IP
2.  授予我的用户名使用我在网上找到的一些 SQL 命令远程连接的权限，访问被拒绝（这是一个共享服务器）
3.  使用具有完全相同参数的 MySQL 工作台成功连接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:00:43.453

您是否在 CPanel 中使用用户名后缀，因为在大多数情况下人们会错过...例如，如果您的 CPanel 用户名是 abc，那么它应该是 abc_TheUsernameForMySQL

如果没有，请尝试您的 CPanel 用户名和密码，您也可以使用错误中的 IP 地址来确认您添加了正确的远程 IP 地址以访问 mysql 服务器

# powershell - 如何使用 PowerShell 下载受保护的文件？

> ID：14242139
> 
> 赞同：5
> 
> 时间：2013-01-09T16:46:54.957
> 
> 标签：powershell, teamcity, ntlm, powershell-3.0, teamcity-7.0

我正在尝试使用 PowerShell 3.0 从我的 TeamCity 构建服务器下载文件。我已将 TeamCity 配置为使用 NTLM 身份验证，但我无法直接下载文件并重定向到登录。

我正在尝试使用以下 PowerShell 代码下载文件。

```
$artifacts = "http://teamcity/repository/download/bt1/.lastSuccessful/%7Bbuild.number%7D.zip"
Invoke-WebRequest -Uri $artifacts -UseDefaultCredentials 
```

我对请求的响应是重定向到登录页面。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T16:46:54.957

这是**最终解决方案**的代码。

* * *

```
$artifacts = "http://teamcity/repository/download/bt1/.lastSuccessful/%7Bbuild.number%7D.zip"
$login = "http://teamcity/ntlmLogin.html"
$dest = "Artifacts.zip"

$TeamCitySession = New-Object Microsoft.PowerShell.Commands.WebRequestSession
Invoke-WebRequest -Uri $login -WebSession $TeamCitySession -UseDefaultCredentials -UseBasicParsing
Invoke-WebRequest -Uri $artifacts -WebSession $TeamCitySession -UseBasicParsing -OutFile $dest 
```

* * *

为了弄清楚发生了什么，我需要使用 Fiddler 来跟踪成功请求的样子，并跟踪 PowerShell 中发生的事情。为了做到这一点，我必须让我的 PowerShell 请求使用它。以下是我在 PowerShell 中打开 Fiddler 跟踪的方法。

```
Invoke-WebRequest -Uri $artifacts -UseDefaultCredentials -Proxy http://localhost:8888/ 
```

通过将*-Proxy*参数添加到命令中，它告诉他命令使用 Fiddler 作为代理服务器。

从这里我看到 TeamCity 将我重定向到登录页面。由于我打开了 NTLM 身份验证，因此您可以浏览一个特殊页面以登录。所以我想从这里做的是访问这个登录页面，然后使用我得到的 cookie 下载文件，因为 TeamCity 使用 cookie 来跟踪身份验证状态。

事实证明，*Invoke-WebRequest* cmdlet 还允许您使用 Web 会话连接它们。有两种方法可以使用*-WebSession*或*-SessionVariable*参数来完成此操作。经过反复试验，事实证明，如果您使用*-SessionVariable*参数，它将在每次请求后覆盖会话变量，因此它实际上并不共享状态。显然这不是我正在寻找的行为。相反，我必须使用*-WebSession*参数，然后我可以将登录和文件下载链接在一起。一旦我这样做了，一切就开始工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T15:37:11.533

使用 -SessionVariable 的原因是静音（更改）状态是 -SessionVariable 旨在将特定 Invoke-WebReqeust websession 的结果作为变量输出，以供以后使用。

如果我们查看该特定参数的 Get-Help：

```
PS C:\windows\system32> get-help Invoke-WebRequest -Parameter SessionVariable

-SessionVariable <String>
    Creates a web request session and saves it in the value of the specified variable. Enter a variable name without the dollar sign ($) symbol.

When you specify a session variable, Invoke-WebRequest creates a web request session object and assigns it to a variable with the specified name in your
Windows PowerShell session. You can use the variable in your session as soon as the command completes.

Unlike a remote session, the web request session is not a persistent connection. It is an object that contains information about the connection and the
request, including cookies, credentials, the maximum redirection value, and the user agent string. You can use it to share state and data among web
requests.

To use the web request session in subsequent web requests, specify the session variable in the value of the WebSession parameter. Windows PowerShell uses
the data in the web request session object when establishing the new connection. To override a value in the web request session, use a cmdlet parameter,
such as UserAgent or Credential. Parameter values take precedence over values in the web request session.

You cannot use the SessionVariable and WebSession parameters in the same command.

Required?                    false
Position?                    named
Default value
Accept pipeline input?       false
Accept wildcard characters?  false 
```

这可以看作是变量名称有点混乱的情况。感谢您在此处发布完成的代码！

# java - JVM 是否具有仅执行文件白名单的功能？

> ID：14242142
> 
> 赞同：7
> 
> 时间：2013-01-09T16:47:01.720
> 
> 标签：java, security, jvm

出于安全考虑，我需要找到一种方法来限制 JVM 将运行哪些文件。我有大约 5 个可以运行的 jars，没有其他东西可以在 JVM 上运行。这是由于某些特定于域的限制，必须将特定权限分配给 JVM，但这些权限不应该对任何想要编写和执行 java 文件的人可用。

我觉得可能有某种功能可以在 JVM 中仅运行受信任/签名的代码，但我无法找到任何相关信息。

如果有人有任何想法，那就太好了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T16:57:09.027

如果您不需要能够从其他 JAR 读取代码，您可以使用[SecurityManager](http://docs.oracle.com/javase/tutorial/essential/environment/security.html)来防止读取任何其他 JAR，或从目录加载类。您还需要限制共享库的反射和加载，以防止手动加载类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T21:50:56.963

我认为这不是那么简单...如果您不完全控制用户站，您将无法使用 SM 保护 java。例如，[原始类](http://www.securingjava.com/chapter-two/chapter-two-7.html)加载器加载不受 SM 检查和许多其他验证的类......所以用户可以在 bootclasspath 中添加一个将拥有所有权限的库......（例如：java 中的 classes 文件夹或 lib 文件夹安装，如果他拥有 jvm，他甚至可以覆盖 java.* 包）

你可以做的是：

*   混淆你的代码
*   对您的 java 应用程序使用隐藏的 api（不是 'java -jar myapp.jar "/path/to/file/to/encrypt"'）

而且您仍然不是 100% 安全...所有代码都可以进行逆向工程并提取算法和密钥，您所能做的就是让它变得足够困难，使其不再具有吸引力。

**编辑**

我认为你可能有一个很大的设计问题。也就是说，如果文件加密是用户驱动的，那么用户知道加密密钥，所有安全性都保留在该密钥中，而不是您的代码中。任何人都可以尝试解密它，但只有拥有有效密钥的人才能解密。如果是这种情况，那么您的代码不需要任何特殊处理。

还有另一种可能是您在您的 java 应用程序中嵌入了密钥......并且这个密钥在您的所有安装中都是静态的，那么这个密钥不再是秘密的，它不是加密而是混淆。

# python - Python：使用多处理模块提高我的功能的速度。一些困惑

> ID：14242147
> 
> 赞同：1
> 
> 时间：2013-01-09T16:47:10.980
> 
> 标签：python, performance, optimization, multiprocessing

这是第二篇文章，是我[之前问题](https://stackoverflow.com/questions/14202285/python-using-multiprocessing-module-as-possible-solution-to-increase-the-speed)的一部分。

我在 Python 2.7（在 Window OS 64 位上）中编写了一个函数，以便从参考多边形（Ref）和一个或多个 ESRI shapefile 格式的分段（Seg）多边形计算相交区域的平均值。代码非常慢，因为我有超过 2000 个参考多边形，并且对于每个 Ref_polygon，该函数每次都针对所有 Seg 多边形（超过 7000 个）运行。很抱歉，该函数是原型。

遵循大卫罗宾逊的建议

```
from multiprocessing import Pool
p = Pool()  # run multiple processes
for l in p.imap_unordered(process_reference_object, range(ref_layer.GetFeatureCount())):
    file_out.write(l) 
```

和[TimothyAWiseman](http://timothyawiseman.wordpress.com/2012/12/21/a-really-simple-multiprocessing-python-example/)，我希望以优化方式使用多处理以提高我的功能的速度。

我有以下问题：

1.  定位 p = Pool().... 的最佳位置在哪里？在第二个函数内部（例如：segmentation_accuracy）还是在最后？

我曾尝试在此处插入（在 segmentation_accuracy 末尾）

```
p = Pool()
for l in p.imap_unordered(object_accuracy, range(ref_layer.GetFeatureCount())):
    file_out.write(l)
file_out.close() 
```

但我的电脑结冰了

2.  我可以改进（我认为可以）我的代码吗？如何改进？

* * *

```
from shapely.geometry import Polygon
import math
import numpy as np
import osgeo.gdal
import ogr
import numpy
import os
from multiprocessing import Pool

def shapefile_NameFilter(inFile):
    if inFile.endswith(".shp"):
        return inFile
    else:
        raise ValueError('"%s" is not an ESRI shapefile' % inFile)

def object_accuracy(ref,seg, index,threshold=10.0,noData=-9999):
    """
    segmetation accuracy metrics
    """
    ref_layer = ref
    seg_layer = seg

    # convert in a shapely polygon
    ref_feature = ref_layer.GetFeature(index)
    # get FID (=Feature ID)
    FID = str(ref_feature.GetFID())
    ref_geometry = ref_feature.GetGeometryRef()
    #  exterior boundaries
    pts = ref_geometry.GetGeometryRef(0)
    points = []
    for p in xrange(pts.GetPointCount()):
        points.append((pts.GetX(p), pts.GetY(p)))
    # convert in a shapely polygon
    ref_polygon_exterior = Polygon(points)
    nHole = ref_geometry.GetGeometryCount()
    if nHole != 1:
    for h in range(1, nHole):
        #  interior boundaries or "holes" of the feature
        pts = ref_geometry.GetGeometryRef(h)
        points = []
        for p in range(pts.GetPointCount()):
            points.append((pts.GetX(p), pts.GetY(p)))
        ref_polygon_interior = Polygon(points)
        ref_polygon_exterior = ref_polygon_exterior.difference(ref_polygon_interior)
    # Net Reference Polygon
    ref_polygon = ref_polygon_exterior
    # get the area
    ref_Area = ref_polygon.area
    # get centroid of the reference object-i
    geom, xy = ref_polygon.centroid.wkt.split(None, 1)
    xy = xy.strip('()').split()
    xcr, ycr = (float(i) for i in xy)
    # create empty lists
    nObject = 0
    Area_seg, Area_intersect = ([] for _ in range(2))
    RAor, RAos = ([] for _ in range(2))
    OverSeg, UnderSeg, OverMerg, UnderMerg = ([] for _ in range(4))
    qr, SimSize, SegError, Dsr = ([] for _ in range(4))
    # For each segmented objects-j
    for segment in xrange(seg_layer.GetFeatureCount()):
       seg_feature = seg_layer.GetFeature(segment)
       seg_geometry = seg_feature.GetGeometryRef()
       pts = seg_geometry.GetGeometryRef(0)
       points = []
       for p in xrange(pts.GetPointCount()):
           points.append((pts.GetX(p), pts.GetY(p)))
       seg_polygon_exterior = Polygon(points)
       nHole = seg_geometry.GetGeometryCount()
       if nHole != 1:
       for h in range(1, nHole):
            #  interior boundaries or "holes" of the feature
            pts = seg_geometry.GetGeometryRef(h)
            points = []
            for p in range(pts.GetPointCount()):
                points.append((pts.GetX(p), pts.GetY(p)))
            seg_polygon_interior = Polygon(points)
            seg_polygon_exterior = seg_polygon_exterior.difference(seg_polygon_interior)
       # Net Segemted Polygon
       seg_polygon = seg_polygon_exterior
       seg_Area = seg_polygon.area
       # get centroid of the segemented object-j
       geom, xy = seg_polygon.centroid.wkt.split(None, 1)
       xy = xy.strip('()').split()
       xcs, ycs = (float(i) for i in xy)
       # intersection (overlap) of reference object with the segmented object
       intersect_polygon = ref_polygon.intersection(seg_polygon)
       # area of intersection (= 0, No intersection)
       intersect_Area = intersect_polygon.area
       # Refinement in order to eliminate spurious effects
       if intersect_Area > (ref_Area*(float(threshold)/100)):
          # Union
          union_polygon = ref_polygon.union(seg_polygon)
          # area of union
          union_Area = union_polygon.area
          # Number of segmented objects
          nObject += 1
          # segmented object area
          Area_seg.append(seg_Area)
          # intersected (=overlapped) region area
          Area_intersect.append(intersect_Area)
          # Area-Based Measures
          # Relative Area of a reference object (RAor)
          RAor.append(intersect_Area/ref_Area)
          # Relative Area of a segmented object (RAos)
          RAos.append(intersect_Area/seg_Area)
          # OverSegmentation (OverSeg)
          OverSeg.append(1-(intersect_Area/ref_Area))
          # UnderSegmentation (UnderSeg)
          UnderSeg.append(1-(intersect_Area/seg_Area))
          # OverMerging (OverMerg)
          OverMerg.append((ref_Area - intersect_Area)/ref_Area)
          # UnderMerging (UnderMerg)
          UnderMerg.append((seg_Area -intersect_Area)/ref_Area)
          # Quality rate (qr)
          qr.append(1-(intersect_Area/(union_Area)))
          # SimSize
          SimSize.append(min(ref_Area,seg_Area)/max(ref_Area,seg_Area))
          # Mean Absolute Segmentation Error (SegError)
          SegError.append(abs(ref_Area - seg_Area)/(ref_Area + seg_Area))
          # Location-based Measures
          # Position discrepancy of segmented object to a reference object
          # Euclidean distance in the xy plane
          Eucdist_sr = math.sqrt(math.pow((xcs-xcr),2)+math.pow((ycs-ycr),2))
          Dsr.append(Eucdist_sr)
       # No segmented objects of intrest
       if nObject == 0:
            AREAs_average, SDs, seg_AreaMax = (noData for _ in range(3))
            AREAo_average, SDo, intersect_AreaMax = (noData for _ in range(3))
            ORrs,RAor_average,RAos_average = (noData for _ in range(3))
            OverSeg_average,UnderSeg_average  = (noData for _ in range(2))
            OverMerg_average,UnderMerg_average = (noData for _ in range(2))
            qr_average,SimSize_average,SegError_average, AFI = (noData for _ in range(4))
            Dsr_avarage,RPsr_average,dmax,D = (noData for _ in range(4))
       else:
            ORrs = (1.0/nObject)*100
            AREAs_average = numpy.average(Area_seg)
            SDs = numpy.std(Area_seg)
            seg_AreaMax = numpy.max(Area_seg)
            AREAo_average = numpy.average(Area_intersect)
            SDo = numpy.std(Area_intersect)
            intersect_AreaMax = numpy.max(Area_intersect)
            # Avarage for all segmented objects
            RAor_average = numpy.average(RAor)*100
            RAos_average = numpy.average(RAos)*100
            OverSeg_average = numpy.average(OverSeg)
            UnderSeg_average = numpy.average(UnderSeg)
            OverMerg_average = numpy.average(OverMerg)
            UnderMerg_average = numpy.average(UnderMerg)
            qr_average = numpy.average(qr)
            SimSize_average = numpy.average(SimSize)
            SegError_average = numpy.average(SegError)
            # Area Fit Index
            AFI = (ref_Area-seg_AreaMax)/ref_Area
            Dsr_avarage = numpy.average(Dsr)
            # Maximum Distance
            dmax = numpy.max(Dsr)
            # Avarage Realative Position (RPsr)
            RPsr_average = numpy.average(numpy.array(Dsr)/numpy.max(Dsr))
            # D index
            D = math.sqrt((math.pow(OverSeg_average,2)+math.pow(UnderSeg_average,2))/2)
       return(" ".join(["%s" %i for i in [FID, ref_Area, nObject, ORrs,\
            AREAs_average, SDs, seg_AreaMax, AREAo_average, SDo, intersect_AreaMax,\
            RAor_average, RAos_average, OverSeg_average, UnderSeg_average,\
            OverMerg_average, UnderMerg_average,qr_average, SimSize_average,\
            SegError_average, AFI, Dsr_avarage, RPsr_average, dmax, D]])+ "\n")

def segmentation_accuracy(reference,segmented,outFile,threshold=10.0,noData=-9999):
    """
    Segmentation accuracy

    """
    # check if reference and segmented are ESRI shapefile format
    reference = shapefile_NameFilter(reference)
    segmented = shapefile_NameFilter(segmented)
    # open shapefile
    ref = osgeo.ogr.Open(reference)
    if ref is None:
        raise SystemExit('Unable to open %s' % reference)
    seg = osgeo.ogr.Open(segmented)
    if seg is None:
        raise SystemExit('Unable to open %s' % segmented)
    ref_layer = ref.GetLayer()
    seg_layer = seg.GetLayer()
    # create outfile
    if not os.path.split(outFile)[0]:
        file_path, file_name_ext = os.path.split(os.path.abspath(reference))
        outFile_filename = os.path.splitext(os.path.basename(outFile))[0]
        file_out = open(os.path.abspath("{0}\\{1}.txt".format(file_path, outFile_filename)), "w")
    else:
        file_path_name, file_ext = os.path.splitext(outFile)
        file_out = open(os.path.abspath("{0}.txt".format(file_path_name)), "w")
    # Header
    file_out.write(" ".join(["%s" %i for i in ["ReferenceFID","AREAr",\
    "nObject","ORrs","AREAs","SDs","AREAsMAX","AREAo","SDo","AREAoMAX",\
    "RAor","RAos","OverSeg","UnderSeg","OverMerg","UnderMerg","qr","SimSize",\
    "SegError","AFI","Dsr","RPro","dmax","D"]])+ "\n")
    for index in xrange(ref_layer.GetFeatureCount()):
        file_out.write(object_accuracy(index))
    file_out.close() 
```

# java - 使用 Android 检测游戏手柄输入

> ID：14242149
> 
> 赞同：0
> 
> 时间：2013-01-09T16:47:15.123
> 
> 标签：java, android

我正在尝试为实验室开发计数器应用程序，我将这个 5 按钮“魔杖”通过 USB 插入我的计算机，计算机将其识别为 UHID 游戏手柄设备。我检测到普通键盘没有问题，但似乎无法检测到 GamePad 按钮事件。

有任何想法吗？

# sql - UPDATE 查询、LIMIT 和 RETURNING 顺序

> ID：14242150
> 
> 赞同：0
> 
> 时间：2013-01-09T16:47:21.223
> 
> 标签：sql, postgresql, syntax, updates

我正在开发一个 LIVE 数据库，由于目前的情况，无法在不将其上线的情况下测试查询...糟糕我知道...

基本上它是一个简单的更新，但我只希望它更新最新匹配的行：

```
UPDATE person SET name = 'bob' WHERE cousin = 'jane' ORDER BY id DESC
LIMIT 1 RETURNING id 
```

基本上很多“人”都可以把jane当作表弟，我只想把最近的人的名字设置为bob。我只是不确定 LIMIT 和 RETURNING 子句。它们的顺序是否正确？或者你甚至可以一起使用 LIMIT 和 RETURNING 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:55:42.680

```
UPDATE person
SET name = 'bob'
WHERE id = (
    select max(id)
    from person
    where cousin = 'jane'
    )
RETURNING id; 
```

您可以通过首先启动事务来测试它：

```
begin;

UPDATE person
SET name = 'bob'
WHERE id = (
    select max(id)
    from person
    where cousin = 'jane'
    )
RETURNING id; 
```

现在选择结果：

```
select *
from person
where id = id_returned_in_the_above_query; 
```

如果正确，则提交：

```
commit; 
```

其他回滚：

```
rollback; 
```

# c# - Win8 应用程序使用 C# 作为逻辑和 html5/javascript 作为 UI

> ID：14242157
> 
> 赞同：1
> 
> 时间：2013-01-09T16:47:35.170
> 
> 标签：c#, xaml, user-interface, microsoft-metro

那么我可以在 Win8 应用程序中使用 C# 作为逻辑和 html5/javascript 作为 UI 吗？我的应用会通过市场吗？或者我必须只使用 c#/xaml 或 html5/jsavascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:50:22.403

应该不是问题。随心所欲地混合搭配......应用程序的内容是重要的。

# sas - SAS - 为哈希表分配最大内存

> ID：14242160
> 
> 赞同：2
> 
> 时间：2013-01-09T16:47:39.290
> 
> 标签：sas

我有一个表我正试图加载到一个哈希对象中，我收到了这条消息：

```
ERROR: Hash object added 1703920 items when memory failure occurred.
FATAL: Insufficient memory to execute DATA step program. Aborted during the EXECUTION phase.
ERROR: The SAS System stopped processing this step because of insufficient memory. 
```

**我的计算机有足够的备用 RAM 来加载表，**看起来好像我的 SAS 配置限制了 SAS 将分配给此任务的 RAM 量。

为了强制 SAS 使用最大数量的 RAM，我需要哪些设置？

在 Windows XP 机器上运行的独立 SAS 9.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:03:04.013

MEMSIZE 决定了您的最大内存大小，尽管还有一些其他有用的选项可供使用（SORTSIZE 应始终随 MEMSIZE 更改为 MEMSIZE 的 1/3 左右）。

请注意，如果您运行多个会话，MEMSIZE 可能会有风险 - 如果您有 4GB RAM 并将 MEMSIZE 设置为 2GB，并打开三个 SAS 会话，如果您尝试在所有三个会话中使用全部 2GB，则可能会导致系统崩溃或导致意外结果会话[即，如果您超过了您的内存+页面文件总数]，即使您没有超过您的页面文件，您也可能会强制 Windows 将页面文件用于不应该使用的任务。我通常会尝试在 MEMSIZE 物理 RAM 数量周围保持 2GB+ 空闲（所以我有 16GB 并使用 12GB 作为我的最大 MEMSIZE，并且任何时候都有两个版本 - 一个 12GB 的 BIGMEM 配置和一个我使用的普通 2GB 配置我的大部分工作都不会从巨大的 MEMSIZE 中受益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T15:21:42.950

确定有多少内存可供 SAS 使用

```
data _null_;
    mem = getoption('xmrlmem');
    put mem=;
run 
```

它给出了适合散列对象的记录数量，参见Secosky 和 ​​Bloom 的[从散列对象开始。](http://support.sas.com/rnd/base/datastep/dot/hash-getting-started.pdf)

如果您的哈希表太宽，这就是您内存不足的原因，请尝试将其分成几个较窄的表，以便它们适合内存，并执行多次哈希连接。它仍然可能比常规连接更快。您也可以尝试更改**hashexp:**散列连接定义中**DECLARE**语句的属性。

[NESUG 2007](http://www.nesug.org/proceedings/nesug07/bb/bb16.pdf)有一篇关于不同连接技术的好文章

如果不查看数据、代码或至少大致了解您的资源和数据是什么，则很难提供帮助或建议解决方法。

# sql - 问题 date_format 日期更改，添加分钟

> ID：14242162
> 
> 赞同：0
> 
> 时间：2013-01-09T16:47:49.963
> 
> 标签：sql, formatdatetime

我有个问题。我做这样的查询：

```
"SELECT nome, DATE_FORMAT(data,'%H:%m') as ora_inizio" 
```

如果我在数据库中有一个检测：2013-08-01 16:00:00 当我显示日期时，日期是：2013:08_01 16:02:00 怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:54:04.617

我假设您使用 MySQL %m 是 Month ，其中 1 是一月。您需要使用 %i 几分钟。

```
SELECT nome, DATE_FORMAT(data,'%H:%i') as ora_inizio 
```

将显示 06:00。要显示完整的日期和时间，请使用：

```
SELECT nome, DATE_FORMAT(data,'%Y-%m-%d %H:%i:%s') as ora_inizio 
```

# c# - 使用文本输入c#从数据库中搜索信息

> ID：14242164
> 
> 赞同：1
> 
> 时间：2013-01-09T16:47:59.437
> 
> 标签：c#, sql

我正在尝试通过使用 sql 搜索客户“forename”、“surname”和“customerid”以显示在组合框中。

```
 string strSql = "SELECT customerID&\" \" & forename &\" \" & surname AS FullName, surname FROM customer WHERE [customerID]='" + txtCustomerID.Text +"'"; 
```

尽管使用此代码，我得到一个“数据不匹配异常”，我假设这是因为我正在使用字符串并搜索 int？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:50:52.543

只是改变这个：你不需要使用''因为它是一个int

string strSql = @"SELECT customerID +'\' + forename + '\' + surname AS FullName, surname FROM customer WHERE [customerID]=" + txtCustomerID.Text;

但正如其他人告诉你的那样，使用字符串连接来构建 SQL 查询并不是一个好习惯，如果它带有你从用户那里获得的参数或数据，则更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T21:24:31.670

正如大家所说；不要从文本字段构造查询，使用参数化查询：

```
SqlCommand sqlQuery = new SqlCommand("SELECT customerID, forename + ' ' + surname AS FullName FROM customer WHERE customerID = @customerID", sqlConnection);
sqlQuery.Parameters.AddWithValue("@customerID", Int32.Parse(txtCustomerID.Text)); 
```

您可能还想对`txtCustomerID.Text`.

# r - 使用分类响应变量在 R 中调用“glm”

> ID：14242170
> 
> 赞同：1
> 
> 时间：2013-01-09T16:48:28.113
> 
> 标签：r, glm

> **可能重复：**
> [为什么我会收到“算法不收敛”和“用 glm 拟合概率为 0 或 1”的警告？](https://stackoverflow.com/questions/8596160/why-am-i-getting-algorithm-did-not-converge-and-fitted-prob-numerically-0-or)

我正在尝试使用以下数据与响应变量`y1`作为分类来拟合 glm。该代码给了我以下警告消息：

```
glm.fit: fitted probabilities numerically 0 or 1 occurred 
```

有时，它确实给了我错误

```
glm.fit: algorithm did not converge 
```

从数据可以看出，预测变量和响应变量之间存在明显的关系。

1.  是因为数据点数量较少而导致“未收敛”错误吗？

2.  `glm`正在将响应变量转换为因子，如下所示。这是正常的吗？

3.  有一个`x1`和`x2`值，我怎么知道响应？

    ```
     x1 = c(runif(10,50,100) , runif(10,101,150) )
      x2 = c(runif(10,1,50) , runif(10,51,100) )
      y1 = c(rep('n',10), rep('y',10)) 
      tmpData = data.frame(x1,x2,y1)
      tmpData
      str(tmpData)
      model <- glm(formula = 'y1~x1+x2', family=binomial(), na.action=na.omit, data=tmpData)
      summary(model) 

     >str(tmpData)
    'data.frame':   20 obs. of  3 variables:
     $ x1: num  97.9 90.3 62.1 76 63.5 ...
     $ x2: num  18.6 49.4 21.2 47.7 24.8 ...
     $ y1: Factor w/ 2 levels "n","y": 1 1 1 1 1 1 1 1 1 1 ... 
    ```

# java - 未绑定通配符和原始类型之间的区别

> ID：14242174
> 
> 赞同：33
> 
> 时间：2013-01-09T16:48:46.673
> 
> 标签：java, generics, unbounded-wildcard

我正在阅读有关泛型的信息，但我不明白对未绑定通配符的需求以及它与原始类型的区别。我读[了这个问题](https://stackoverflow.com/questions/7671072/what-is-the-use-and-point-of-unbound-wildcards-generics-in-java)，但仍然没有弄清楚。在 [未绑定通配符的 Java 教程页面中，](http://docs.oracle.com/javase/tutorial/java/generics/unboundedWildcards.html)我得到以下两点，但我不明白第一点：

> *   如果您正在编写一个可以使用`Object`类中提供的功能来实现的方法。
> *   当代码使用泛型类中不依赖于类型参数的方法时。例如，`List.size()`或`List.clear()`。事实上，`Class<?>`之所以经常使用，是因为其中的大多数方法`Class<T>`都不依赖于`T`.

有人可以用外行语言解释未绑定通配符和原始类型之间的区别。

与有何`List<?>`不同？`List<Object>`

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-09T16:50:25.163

> 有何`List<?>`不同`List<Object>`

主要区别在于第一行编译但第二行不编译：

```
List<?> list = new ArrayList<String> ();
List<Object> list = new ArrayList<String> (); 
```

但是，因为你不知道泛型类型`List<?>`是什么，所以你不能使用它的参数化方法：

```
List<?> list = new ArrayList<String> ();
list.add("aString"); //does not compile - we don't know it is a List<String>
list.clear(); //this is fine, does not depend on the generic parameter type 
```

至于与原始类型（无泛型）的区别，下面的代码编译并运行良好：

```
List list = new ArrayList<String> ();
list.add("aString");
list.add(10); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T17:27:29.603

有何`List<?>`不同？`List<Object>`

```
 List<Object> l1 = new ArrayList();
    List<?> l2 = new ArrayList();
    l1.add("Object");
    //l2.add("Object");   incorrect
    l2.add(null); 
```

您只能将空值添加到`List<?>`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-10T20:54:47.883

就个人而言，我发现[Java 通配符教程中的这个附加链接](http://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html)很有帮助。

`List<?>`我看到和之间的主要区别`List`之一是前者只能用于从它的元素中读取（除非你真的想添加`null`），后者允许（未经检查）向它添加任意类型的对象，可能是意外的一面 -效果。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-06-12T09:44:11.443

> 有人可以用外行语言解释未绑定通配符和原始类型之间的区别。

未绑定的通配符类型可以保持***集合的类型不变***，而原始类型不能。正如 Joshua Bloch 在他的*Effective Java*中所说，

> 您可以将任何元素放入具有原始类型的集合中，这很容易破坏集合的类型不变量（如第 112 页上的 unsafeAdd 方法所示）；您不能将任何元素（除了 null）放入 Collection<?>。

因此，只要您将参数化类型列表分配给未绑定通配符类型列表，***集合的类型不变性***将保持不变。

```
List<String> list1 = new ArrayList();
list1.add("foo");
list1.add("bar");
List<?> list2 = list1; 
```

如果您分配一个原始类型列表，其元素属于不同类型，则未绑定的通配符类型将不会保持***集合的类型 invariant***，因为该列表最初是变体类型。

```
List list1 = new ArrayList();
list1.add(1);
list1.add("foo");
List<?> list2 = list1; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-28T21:39:11.457

List 在方法签名中非常有用，可以调用从不需要类型参数的方法，例如，从列表中读取或旋转它。

```
void someMethod(List<?> list) {
  list.clear();  // I will never add anything to the list in here
} 
```

您将永远不会添加任何内容或以其他方式修改列表所包含的类型，因为您不能将任何内容添加到列表中，除了具有此签名的方法中的 null 之外，因此您永远不会破坏类型安全。另一方面，原始列表可以做任何事情，众所周知，这会导致类型安全违规。

```
void someMethod2(List list) {
 list.add(new WeaselFurBrush());  
}
List list1 = new ArrayList<String>();
someMethod2(list1);// oops 
```

# android - 尝试创建对象数组

> ID：14242179
> 
> 赞同：4
> 
> 时间：2013-01-09T16:49:00.130
> 
> 标签：android, arrays

我有一个对象要放入数组列表中：

```
class PlayerScores {

String playerName;
int played=0;
int win=0;
int draw=0;
int loss=0;
int points=0;

void playerNameSet(String name){
    playerName=name;
}
void played(){
    played=played+1;
}
void win(){
    win=win+1;
    points();
}
void draw(){
    draw=draw+1;
    points();
}
void loss(){
    loss=loss+1;
}

void points(){
    points = (win*3)+draw;
}

} 
```

基本上，当用户选择了有多少玩家时，我想初始化这些对象的数组，但我遇到了错误。这是初始化数组然后为玩家分配名称的代码。

该数组已在我的代码开头定义并且是公开的，因此我可以在不同的活动中使用它：“PlayerScores [] playerObjects;”

```
public PlayerScores[] makePlayerObjects() {
        playersObjects = new PlayerScores[players];
        for(int i = 0; i < players + 1; i++)
        {
            playersObjects[i].playerNameSet(name variable);
        }

    return playersObjects;
} 
```

该错误似乎发生在设置名称的行上，但与名称变量无关。

任何帮助将不胜感激，谢谢，奥利

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T16:55:31.157

您实际上还没有在数组中设置对象。您首先需要构造一个`PlayerScores`对象，然后才能访问它。

```
public PlayerScores[] makePlayerObjects() {
        playersObjects = new PlayerScores[players];
        for(int i = 0; i < playersObjects.length; i++)
        {
            playersObjects[i] = new PlayerScores(); //make the object so we can access it
            playersObjects[i].playerNameSet(name variable);
        }

    return playersObjects;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T16:53:52.473

您也可以使用列表。

```
 List<PlayerScores > myList = new ArrayList<PlayerScores>();
 for(int i = 0; i < players.size(); i++){
        myList.add(new PlayerScores().playerNameSet(thename));
 } 
```

还要注意`.size()`假设玩家是不同的数组的用法。如果是，`int`则忘记该`.size()`部分

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T16:50:09.180

```
for(int i = 0; i < players + 1; i++) 
```

它会导致`ArrayIndexOutOfBoundException`，因为数组的索引从`0`到`size -1`

# visual-studio - 如何在 Visual Studio 2012 中重命名解决方案、解决方案文件夹、项目文件夹、包/过滤器文件夹和 vcxproj 文件

> ID：14242180
> 
> 赞同：16
> 
> 时间：2013-01-09T16:49:00.667
> 
> 标签：visual-studio, visual-studio-2012

我在我的游戏项目中遇到上述任何问题。网上已经有很多答案，我查看了所有答案，但它们对我不起作用或有不同的情况。这是我的情况：

![这是我的解决方案](../Images/b06f8fa48273056920788597e7e67ba1.png)

这就是我的解决方案的样子。我将项目名称从Visual Studio 更改为 ，这很有效**`X-Power`**。**`Neo_Elements`**但它不会影响实际的物理文件夹。

.vcxproj 文件的物理文件路径和名称是`...\Neo_Elements\WorldScrollingGame\WorldScrollingGame.vcxproj`.

.sln 文件的物理文件路径和名称是 `...\Neo_Elements\X-Power.sln`

我想做的事：

1.  将解决方案重命名为**`Neo_Elements`**（因此`.sln`文件将相应更改）

2.  将文件路径更改为`...\Neo_Elements\Neo_Elements\...`

3.  将 .vcxproj 文件重命名为`Neo_Elements.vcxproj`

所以更改后 .sln 文件路径和名称应该是 `...\Neo_Elements\Neo_Elements.sln`

.vcxproj 文件路径和名称应该是`...\Neo_Elements\Neo_Elements\Neo_Elements.vcxproj`

解决方案和项目名称都是**`Neo_Elements`**

我做了什么：

1.  在解决方案名称上按 F2 重命名 Visual Studio 中的解决方案。

发生了什么：

该项目不再构建并创建一堆编译错误，如下所示：

```
fatal error C1083: Cannot open include file: 'stdafx.h': No such file or directory
fatal error C1083: Cannot open include file: 'resource.h': No such file or directory 
```

我什至没有更改物理文件夹，也不知道为什么找不到文件，而且丢失文件的位置对我来说似乎完全随机。（不仅是那些下面的`\WorldScrollingGame`，还有一些更深层次的。还有很多文件受到影响，但只有少数文件找不到）。当我尝试将解决方案名称改回时**`X-Power`**，结果证明我不能。它说“无法重命名解决方案，因为具有指定名称的解决方案文件已经存在”，尽管事实上已经不存在`X-Power.sln`了。尽管如此，我已经完全被困在这里，不得不从备份中恢复整个解决方案（或在 Windows 资源管理器中手动更改 .sln 文件的名称）。第一次尝试失败。

然后我开始尝试第二个，方法是在 VS 之外更改项目文件夹。

我做了什么：

我点击了[这个链接](https://stackoverflow.com/questions/211241/how-do-i-rename-a-project-folder-from-within-visual-studio)：关闭VS，在VS之外重命名项目主管，在文本编辑器中编辑.sln更改`"X-Power", "WorldScrollingGame\WorldScrollingGame.vcxproj"`为`"X-Power", "Neo_Elements\WorldScrollingGame.vcxproj"`（奇怪的是**`X-Power`**应该是**`Neo_Elements`**因为我在VS中编辑了项目名称，但不知何故它没有反映这里的变化，除非这个不是项目名称的反映，根据该链接，绝不应该是这种情况。但由于之前发生的事情，我现在不想弄乱解决方案名称）。

发生了什么：

事实证明，我仍然收到一堆编译错误，类似于我第一次尝试时遇到的错误，不知道如何解决这些错误。

所以我没有费心尝试第三个，因为我什至不知道如何

请帮忙！这几个实在是过不去。

编辑：我知道开始一个新文件并迁移所有文件可能会更好，但我之前无法在任何情况下进行重命名——即使是单个解决方案重命名或单个项目目录重命名。所以我想借此机会弄清楚这实际上是如何工作的，因为它似乎对很多人都有效

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2021-01-26T15:45:07.413

您收到消息的原因

*“无法重命名解决方案，因为具有指定名称的解决方案文件已存在”*

可能是因为根文件夹中有一个同名的“.sln”文件，或者项目文件夹中仍然存在与该旧解决方案相关的文件。

在解决方案根文件夹中找到“.vs”文件夹。查找与您尝试将解决方案命名为相同名称的文件夹。删除那个文件夹。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-05-24T20:10:39.763

这是我过去所做的。首先尝试在 VS 中重命名解决方案并不好。假设您要更改项目名称和解决方案名称。

1.  关闭VS。
2.  在继续之前制作项目的备份副本。
3.  在 Windows 资源管理器中，导航到您的解决方案根目录。这是您将找到您的 ProjectFile、包和 .sln 文件的地方。
4.  让我们通过打开项目文件文件夹并重命名 .csproj 文件来更改项目名称。
5.  接下来右键单击您的 .sln 文件并在记事本中选择编辑。寻找这样的一行： Project("{FAE04EC0-301F-11D3-BF4B-xxxxxxxxx}") = "MyProject", "MyProject\MyProject.csproj", "{C1AD3829-E4BA-4BF1-85EB-672A85A4D35D}" 更改在步骤 4 中将 .csproj 名称更改为新名称。您可能还希望使文件夹名称正确。
6.  保存并关闭记事本。
7.  最后右键单击 .sln 文件并选择重命名。选择你的名字并关闭。
8.  现在打开 VS，选择 File>Open> Project Solution 并导航到您刚刚更改的 .sln 文件。
9.  希望那成功了。如果不是，请仔细检查您的更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-04T00:57:00.403

我可以给你一个我认为可行的建议。在解决方案资源管理器中的 Visual Studio 2012 中，通过打开所有节点并查看它的位置来找到文件 .vcxproj。然后从那里重命名文件。对您的所有其他文件执行相同操作。完成所有这些之后，您的最后一项任务应该是从 VS2012 内部更改解决方案名称。希望这会有所帮助。任何意见或回应将不胜感激。

# android - 如何实现客户端-服务器模型？

> ID：14242182
> 
> 赞同：0
> 
> 时间：2013-01-09T16:49:05.380
> 
> 标签：android, ruby, amazon-web-services, jruby

客户端是在 JRuby 上编写的 android 应用程序。服务器是 AwS 的 Ruby on Rails 应用程序。客户端应该下载数据、显示数据、管理数据、存储数据。客户端不是一个并且通过 Internet 连接。服务器通过网页下载数据，显示客户端状态，通过网页管理客户端。

如何在 ruby​​ 和 jruby 上组织客户端和服务器之间的通信？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:52:19.247

由于您的 Server-App 是 Rail，它应该支持 RESTful 接口就好了（如果您正确实施它）。

在您的客户端中，您可以使用 ActiveResource 轻松地与该服务器交互。

**编辑：**

甚至还有一个关于它的 railscast [http://railscasts.com/episodes/94-activeresource-basics](http://railscasts.com/episodes/94-activeresource-basics) 把你的 JRuby-Client 想象成一个小的 Rails-App，这样就可以了；）

# c++ - 文件结束和while循环

> ID：14242184
> 
> 赞同：0
> 
> 时间：2013-01-09T16:49:18.657
> 
> 标签：c++, file, while-loop, eof

我有一个 c++ 代码片段，它应该从文件中读取一些信息，并且找不到文件或信息，从屏幕读取它。这是代码：

```
char c;
bool found=false;
int N;
double step;
ifstream in;
in.open(name.c_str());
if(in) {
    while(!found && in >> c) {
        while(c!='=') in >> c;
        in >> N;
        if(N==wp.N) {
            found=true;
            while(c!=':') in >> c;
            in >> step;
        }
        c='a';
    }
}
if(!found) {
    cout << "max=";
    cin >> step;
} 
```

以上是根据文件中数据的结构构造的，当信息在文件中（即*N=wp.N*在某个点）或文件不存在（即*if(in)*为不对）。

但是当文件存在但不包含信息时就会出现问题，即*N==wp.N*永远不会正确。然后程序冻结（大概在文件的末尾，所以*发现*永远不会是真的）。我期望在*while循环中包含**in >> c*可以解决此问题，但我也尝试过使用*in.eof()*。

 **有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:54:53.283

您可能会在您的任何 in >> 之后找到 eof()。

所以我假设你正在循环 while(c!=':') 或 while(c!='=')

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T16:57:33.300

问题出在您的第二个循环中，如果您到达文件末尾而不读取`'='`. 你也需要 `in >> c`那里的条件。**

# url - 好友 nicename 和个人资料 URL 问题

> ID：14242190
> 
> 赞同：0
> 
> 时间：2013-01-09T16:49:35.707
> 
> 标签：url, profile, buddypress

我想知道是否有人可以帮助解决我在 Buddypress 中的问题。

当用户名中有特殊字符的用户编辑他们的个人资料时，他们的个人资料“-2”会附加到他们的“user_nicename”后面，这意味着经过几次编辑后，他们的个人资料网址可能看起来像这样

*http://www.domain.com/members/nicename-2-2-2-2-2/*

我已经为数据库中受影响的用户重置了“user_nicename”字段并删除了额外的“-2s”，但它又重新开始了。我也尝试过添加

`define( ‘BP_ENABLE_USERNAME_COMPATIBILITY_MODE’, true );`

并将其更改为

`define( ‘BP_ENABLE_USERNAME_COMPATIBILITY_MODE’, false );`

在 bp-custom.php 中，这没有什么区别。我刚刚安装了 Buddypress，一些用户的用户名中预先存在特殊字符。我确实在 buddypress 支持 (ticket/2642) 上找到了有类似问题的人，但是它已经过时并且对我没有帮助。

出于某种原因，Buddypress 支持不起作用，不会让我发帖，否则我也会在那里问。任何帮助或指导将不胜感激。

谢谢

WordPress 版本 3.5 / BuddyPress 版本 1.6.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:26:01.013

配置文件字段名称与 slug/登录名不同。以前的用户是通过连接插件添加的吗？

您可能希望添加此插件以允许用户更改他们的登录名。[http://buddydev.com/plugins/bp-username-changer](http://buddydev.com/plugins/bp-username-changer)

# facebook - FBPlacePickerViewController 没有返回选择的正确位置

> ID：14242191
> 
> 赞同：0
> 
> 时间：2013-01-09T16:49:36.503
> 
> 标签：facebook, ios6, location, mkmapview, viewcontroller

我在一个项目中使用 FBPlacePickerViewController，无论我在选择器上做出什么选择，它总是返回相同的坐标。我正在使用 _placePicker.selection.location.latitude 和 _placePicker.selection.location.longitude 并且它总是返回 userLocation（所做的选择无关紧要）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:24:10.937

找到了一个使用谷歌地图提供解决方法的链接......从这个意义上说，Facebook Places SDK 似乎存在一个错误......

无论如何，这是这个“修复”的链接

[http://mithin.in/2009/06/22/using-iphone-sdk-mapkit-framework-a-tutorial](http://mithin.in/2009/06/22/using-iphone-sdk-mapkit-framework-a-tutorial)

# drupal - 不一致的 xdebug 行为

> ID：14242206
> 
> 赞同：1
> 
> 时间：2013-01-09T16:50:23.813
> 
> 标签：drupal, netbeans, mamp, xdebug, virtualhost

我正在使用 NetBeans 在 OSX 10.8.2 上运行 MAMP。我安装了 xdebug 用于在本地调试 Drupal 站点。我有很多，所以我设置了虚拟主机。

我遇到了一个奇怪的不一致。在 mysite.loc 上，我将断点放入 index.php，启动调试器，它工作正常。断点捕获，我可以运行、跨入、跨过等。

在同一个站点上，我将断点放入 template.php（在我的活动主题中）。我在函数中添加了一些调试文本，以确保正在调用包含断点的函数。我的调试文本出现了，但断点永远不会被捕获。运行和步骤按钮保持灰色。

当我结束调试会话时，我没有收到任何错误。

怎么了？

# android - 数据库是否存在[如何调用类]

> ID：14242207
> 
> 赞同：2
> 
> 时间：2013-01-09T16:50:23.593
> 
> 标签：android, android-sqlite

我发现了[这个](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)SQLiteOpenHelper 类的优秀示例，它的文档非常好，我想我可以将它用于我的应用程序；问题是我仍在努力确定我的应用程序创建的数据库是否已经存在

我的应用程序有一个主要活动 Java 类 [想象中的命名] ' `ActivityMain`' 目前调用 void`dbTest();`

```
public void DBTest() {

        SQLiteDatabase myDB = null;

        /* Create a Database. */
        try {
            myDB = this.openOrCreateDatabase(DATABASE_NAME, MODE_PRIVATE, null);

            /* Create a Table in the Database. */
            myDB.execSQL("CREATE TABLE IF NOT EXISTS "
                    + DATABASE_TABLE
                    + " (" + KEY_ID + " integer primary key autoincrement, "
                    + KEY_SCRIPT_NAME + " text, " + KEY_SCRIPT_BODY + " text, "
                    + KEY_SU_NEEDED + " short);");

            /* Insert data to a Table*/
            myDB.execSQL("INSERT INTO "
                    + DATABASE_TABLE
                    + " (" + KEY_SCRIPT_NAME
                    + ", " + KEY_SCRIPT_BODY
                    + ", " + KEY_SU_NEEDED + ")"
                    + " VALUES ('CPU information', 'cat /proc/cpuinfo', 1);");

            /*retrieve data from database */
            Cursor c = myDB.rawQuery("SELECT * FROM " + DATABASE_TABLE, null);

            int scriptName = c.getColumnIndex("name");

            // Check if our result was valid.
            c.moveToFirst();
            // cursor left as it came from the database because it starts at the row before the first row
            ArrayList<String> sData = new ArrayList<String>();
            if (c != null) {
                do {
                    String Name = c.getString(scriptName);
                    sData.add(Name);
                } while (c.moveToNext());
            }

            ListView lv = (ListView) findViewById(R.id.mainListView);
            lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_multiple_choice, sData));
            lv.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);

        } catch (Exception e) {
            Log.e("Error", "Error", e);
        } finally {
            if (myDB != null)
                myDB.close();
        } 
```

在那里它创建数据库并插入一行然后将其显示在 ListView 中，目前这只会在每次启动应用程序时插入同一行，所以我想检查数据库是否已经存在。

我希望数据库以一些初始值开始，这就是我插入数据的原因，然后用户可以根据需要删除它

因此，在我的“ `ActivityMain`”类中，我想从链接的示例中使用的“”类中调用该`createDataBase();`方法，`DatabaseHelper`但不能

是不是像：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_main);

                try {
            createDataBase();
            catch(SQLiteException e){
                // database doesn't exist yet.
                return false;
            } 
```

我在 ' ' 类中有一个布尔函数`ActivityMain`可以正常工作，但我不确定这是不是正确的方法，实际上应该通过辅助类来完成所有这些

```
private boolean checkDatabase() {
    SQLiteDatabase checkDB = null;
    try {
        checkDB = SQLiteDatabase.openDatabase(DB_FULL_PATH, null,
                SQLiteDatabase.OPEN_READONLY);
        checkDB.close();
    } catch (SQLiteException e) {
        // database doesn't exist yet.
        return false;
    }
    return checkDB != null ? true : false;
} 
```

有人可以给我一些指示吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:58:01.013

教程很好，但不像[官方 API 文档](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)。始终阅读官方文档。教程，为了简单起见，总是省略一些东西（有时是重要的东西）。

如您所见，如果 DB 不存在，`getReadableDatabse()`和/或`getWritableDatabase()`将自动调用。`onCreate()`

这是我如何做到这一点的示例（未经测试，但应该向您展示如何做到这一点）：

```
public class YourDBManager extends SQLiteOpenHelper {

    private SQLiteDatabase db = null;

    public YourDBManager(final Context context, final String dbName, final int dbVersion) {
        super(context, dbName, null, dbVersion);
        db = getWritableDatabase();
    }

    /** Initializes your DB */
    private void initializeDB(final SQLiteDatabase db) throws SQLException {
        // Do whatever you want to do to initialize your DB here
    }

    /** 
     * This method is NOT called directly by you but called by SQLiteOpenHelper, 
     * but by getReadableDatabase()/getWritableDatabase() in case it doesn't exist.
     * Here you do whatever you want to do to initialize the DB the first time it is created.
     */
    @Override
    public void onCreate(final SQLiteDatabase db) throws SQLException {
        Log.i(TAG, "=====DATABASE DOES NOT EXIST: CREATING IT======");
        initializeDB(db);
    }
}

public class YourActivity extends Activity {

    private YourDBManager dbMan = null;

    /** Do NOT call from UIThread! */
    private void initializeDBManager() {
        dbMan = new YourDBManager(this, "mydatabase", 1);
    }
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T19:07:03.097

您可以通过使用找出数据库文件是否存在

```
File dbFile = context.getDatabasePath(DATABASE_NAME);
if(dbFile.exists()){
// do something
} 
```

这不会告诉您数据库是否有效或其他任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T21:01:11.600

我认为你已经以正确的方式做事了。还有一些关于该主题的其他问题（例如[查询 Android 数据库是否存在！](https://stackoverflow.com/questions/3386667/query-if-android-database-exists)和 [Android - SQLite 数据库是否存在？](https://stackoverflow.com/questions/6420182/android-does-sqlite-database-exist)）建议打开数据库，然后捕获异常以显示数据库不存在。

# android - MapFragment 在旋转后变得没有响应

> ID：14242209
> 
> 赞同：3
> 
> 时间：2013-01-09T16:50:26.853
> 
> 标签：android, android-fragments, android-maps-v2

我的问题很简单，我将 4 FrameLayout 添加到我的 XML 并在这些容器中通过代码添加 4 MapFragment。

像这样 ：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:map="http://schemas.android.com/apk/res-auto"
  android:id="@+id/map_container"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:orientation="vertical">
  <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="0.5"
    android:orientation="horizontal">
    <FrameLayout
      android:id="@+id/map1_container"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:layout_weight="0.5""/>
    <FrameLayout
      android:id="@+id/map2_container"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:layout_weight="0.5"/>
  </LinearLayout>
  <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="0.5"
    android:orientation="horizontal">
    <fragment
      android:id="@+id/map3_container"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:layout_weight="0.5"/>
    <fragment
      android:id="@+id/map4_container"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:layout_weight="0.5""/>
  </LinearLayout> 
```

在我的活动中

```
public class MultiGoogleMapActivity extends FragmentActivity {

    private GoogleMap mMap;
    private GoogleMap mMapUp;
    private GoogleMap mMapMiddle;
    private GoogleMap mMapLow;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_multi_google_map);

mMap1Fragment = SupportMapFragment.newInstance();
    FragmentTransaction fragmentTransaction = getSupportFragmentManager()
                        .beginTransaction();
                fragmentTransaction.add(R.id.map1_container, mMap1Fragment, MAP_FRAGMENT_TAG);
                fragmentTransaction.commit();
mMap2Fragment = SupportMapFragment.newInstance(new GoogleMapOptions().zoomControlsEnabled(false).zoomGesturesEnabled(false).compassEnabled(false).rotateGesturesEnabled(false).scrollGesturesEnabled(false));
    FragmentTransaction fragmentTransaction = getSupportFragmentManager()
                        .beginTransaction();
                fragmentTransaction.add(R.id.map2_container, mMap2Fragment, MAP_FRAGMENT_TAG);
                fragmentTransaction.commit();
mMap3Fragment = SupportMapFragment.newInstance(new GoogleMapOptions().zoomControlsEnabled(false).zoomGesturesEnabled(false).compassEnabled(false).rotateGesturesEnabled(false).scrollGesturesEnabled(false));
    FragmentTransaction fragmentTransaction = getSupportFragmentManager()
                        .beginTransaction();
                fragmentTransaction.add(R.id.map3_container, mMap3Fragment, MAP_FRAGMENT_TAG);
                fragmentTransaction.commit();
mMap4Fragment = SupportMapFragment.newInstance(new GoogleMapOptions().zoomControlsEnabled(false).zoomGesturesEnabled(false).compassEnabled(false).rotateGesturesEnabled(false).scrollGesturesEnabled(false));
    FragmentTransaction fragmentTransaction = getSupportFragmentManager()
                        .beginTransaction();
                fragmentTransaction.add(R.id.map4_container, mMap4Fragment, MAP_FRAGMENT_TAG);
                fragmentTransaction.commit();

        setUpMapIfNeeded();
    }

    @Override
    protected void onResume() {
        super.onResume();
        setUpMapIfNeeded();
    }

    private void setUpMapIfNeeded() {
        // Do a null check to confirm that we have not already instantiated the
        // map.
        if (mMap == null) {
            mMap = mMap1Fragment.getMap();
        }
        if (mMapUp == null) {
            mMapUp = mMap2Fragment.getMap();
            mMapUp.setOnMapClickListener(new OnMapClickListener() {

                public void onMapClick(LatLng arg0) {
                    CameraPosition cp = mMapUp.getCameraPosition();
                    mMapUp.moveCamera(CameraUpdateFactory.newCameraPosition(mMap.getCameraPosition()));
                    mMap.moveCamera(CameraUpdateFactory.newCameraPosition(cp));
                }
            });

        }
        if (mMapMiddle == null) {
            mMapMiddle = mMap3Fragment.getMap();
            mMapMiddle.setOnMapClickListener(new OnMapClickListener() {

                public void onMapClick(LatLng arg0) {
                    CameraPosition cp = mMapMiddle.getCameraPosition();
                    mMapMiddle.moveCamera(CameraUpdateFactory
                            .newCameraPosition(mMap.getCameraPosition()));
                    mMap.moveCamera(CameraUpdateFactory
                            .newCameraPosition(cp));
                }
            });
        }
        if (mMapLow == null) {
            mMapLow = mMap4Fragment.getMap();
            mMapLow.setOnMapClickListener(new OnMapClickListener() {

                public void onMapClick(LatLng arg0) {
                    CameraPosition cp = mMapLow.getCameraPosition();
                    mMapLow.moveCamera(CameraUpdateFactory
                            .newCameraPosition(mMap.getCameraPosition()));
                    mMap.moveCamera(CameraUpdateFactory
                            .newCameraPosition(cp));
                }
            });
        }
        initializeMapsPositions();
    }

    private void initializeMapsPositions() {
        if (mMap != null) {
            mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(new LatLng(
                    47.224217, -1.631409), 16));
        }
        if (mMapUp != null) {
            mMapUp.setOnCameraChangeListener(new OnCameraChangeListener() {

                public void onCameraChange(CameraPosition arg0) {
                    mMapUp.animateCamera(CameraUpdateFactory.newLatLngBounds(
                            new LatLngBounds(new LatLng(-21.417276,55.039925),
                                        new LatLng(-20.815174,56.008095)),
                            10));
                    mMapUp.setOnCameraChangeListener(null);
                }
            });

        }
        if (mMapMiddle != null) {
            mMapMiddle.setOnCameraChangeListener(new OnCameraChangeListener() {

                public void onCameraChange(CameraPosition arg0) {
                    mMapMiddle.animateCamera(CameraUpdateFactory.newLatLngBounds(
                            new LatLngBounds(new LatLng(14.337573,-61.441246), 
                                            new LatLng(14.947439,-60.603539)), 
                            10));
                    mMapMiddle.setOnCameraChangeListener(null);
                }
            });
        }
        if (mMapLow != null) {
            mMapLow.setOnCameraChangeListener(new OnCameraChangeListener() {

                public void onCameraChange(CameraPosition arg0) {
                    mMapLow.animateCamera(CameraUpdateFactory.newLatLngBounds(
                            new LatLngBounds(new LatLng(17.596903,-78.448288), 
                                            new LatLng(18.643643,-76.207077)), 
                            10));
                    mMapLow.setOnCameraChangeListener(null);
                }
            });

        }

    }

} 
```

问题是：当我旋转设备时，MapFragments 不再响应触摸事件......

有没有人遇到同样的问题并解决了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T05:26:46.140

我遇到了同样的问题，经过多次故障排除后发现容器中有多个地图片段。

所以，我通过使用解决了这个问题

```
FragmentTransaction.replace 
```

代替

```
.add 
```

# recursion - 使用递归创建 XML 层次结构

> ID：14242210
> 
> 赞同：0
> 
> 时间：2013-01-09T16:50:36.480
> 
> 标签：recursion, linq-to-xml, xelement

我正在尝试在 LINQtoXML 中创建如下所示的分层树结构。

```
 <Item>
   <Item>
      <Item>
      </Item>
   </Item>
 </Item> 
```

子级别的数量是动态的。它可以是任何数字。

```
public static XElement BuildTree(int numberOfLevel)
{
    XElement parent=new XElement("Item");
    AddChild(parent,numberOfLevel);
    return parent;
}
public static XElement AddChild(XElement elm, int numberofLevel)
{
    while (numberofLevel > 1)
    {
        numberofLevel--;
        elm.Element("Item").Add(AddChild(elm, numberofLevel));
    }
    return elm;
} 
```

但是在运行时，我在该行中得到一个空引用错误`elm.Element("Item")`

谁能帮我 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T16:08:39.250

```
public static XElement BuildTree(int numberOfLevel)
{
    XElement parent = new XElement("Item");
    AddChild(parent,numberOfLevel);
    return parent;
}

public static void AddChild(XElement elm, int numberofLevel)
{
    if(numberofLevel > 1)
    {
        XElement newElm = new XElement("Item");
        elm.Add(newElm);
        AddChild(newElm, numberOfLevel - 1);
    }
} 
```

但也不能不使用递归：

```
public static XElement BuildTree(int numberOfLevel)
{
    XElement parent = new XElement("Item");
    XElement current = parent;
    while(numberOfLevel > 1)
    {
         XElement newElement = new XElement("Item");
         current.Add(newElement);
         current = newElement;
         numberOfLevel--;
    }
    return parent;
} 
```

# php - 如何使用 jquery 通过 php 上传文件？

> ID：14242213
> 
> 赞同：1
> 
> 时间：2013-01-09T16:50:39.550
> 
> 标签：php, jquery, file-upload

我展示了一个对话框，其中包含一个上传文件的表单。

单击确定时，应上传所选文件。

我如何用 jquery 和 PHP 做到这一点？

代码：

```
 if(act=='exchangePic')
{               
    $("#dialog").attr('title','Change picture ').dialog({buttons:{'ok':{class:'btn',text:'Ok',click:function(){
    $('#imgHolder_'+picture_id).css({'background-color':''});
    $(this).dialog('close');    

    }}}, show:'fade',hide:'explode',width:'380px',modal:true,closeText:' X  '}).html("<form><input type='file' id='newUpload' name='newUpload' class='upfile'/></form>");

}//end of act=='exchangePic' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:01:25.763

为什么要自己写所有东西？[Plupload](http://www.plupload.com/)是一个可靠的[开源上传](https://github.com/moxiecode/plupload)器，具有许多强大的功能。

这是[jquery示例](http://www.plupload.com/example_queuewidget.php)

![插件功能](../Images/c4ffeef9a599db7d4df0c1ea91fdce53.png)

# postgresql - PostgreSQL 中的动态表名

> ID：14242215
> 
> 赞同：0
> 
> 时间：2013-01-09T16:50:46.593
> 
> 标签：postgresql, postgresql-9.2

我的情况是多个表包含基于国家/地区的类似信息。更改数据库模式不是一种选择，我对使用存储过程不感兴趣。我宁愿在一个返回多行的单个查询中获取所有内容，而不是为每个国家/地区执行一个查询。

首先，我有一个定义表，其中列出了我们有表的所有国家：

```
countries
+============+========+
| country_id | prefix |
+============+========+
| 1          | us     |
+------------+--------+
| 2          | ca     |
+------------+--------+ 
```

其次，我有一个关系表：

```
relationships
+========+============+==============+
| rel_id | country_id | upc          |
+========+============+==============+
| 1      | 1          | 111111111111 |
+--------+------------+--------------+
| 2      | 2          | 111111111111 |
+--------+------------+--------------+
| 3      | 1          | 222222222222 |
+--------+------------+--------------+
| 4      | 2          | 222222222222 |
+--------+------------+--------------+
| 5      | 2          | 333333333333 |
+--------+------------+--------------+
| 6      | 1          | 444444444444 |
+--------+------------+--------------+ 
```

然后，我有两个名为“us_products”和“ca_products”的表。如果国家表中存在条目，则存在名称为 [countries.prefix]_products 的表。所有 *_products 表都彼此相同。相同的列和相同的数据类型。

```
us_products
+============+==============+=======+
| product_id | upc          | title |
+============+==============+=======+
| 1          | 111111111111 | Shoe! |
+------------+--------------+=======+
| 2          | 222222222222 | Tie   |
+------------+--------------+=======+
| 3          | 444444444444 | Sock  |
+------------+--------------+=======+

ca_products
+============+==============+=======+
| product_id | upc          | title |
+============+==============+=======+
| 1          | 111111111111 | Shoe. |
+------------+--------------+=======+
| 2          | 222222222222 | Tie   |
+------------+--------------+=======+
| 3          | 333333333333 | Shirt |
+------------+--------------+=======+ 
```

目标是让查询格式化类似于以下内容（显然这不起作用，否则我不会问这个问题......）：

```
SELECT
  countries.prefix,
  products.title
FROM
  relationships
INNER JOIN
  [countries.prefix]_products AS products
  ON
  relationships.upc = products.upc
WHERE
  relationships.upc = '111111111111' 
```

应该返回：

```
+========+=======+
| prefix | title |
+========+=======+
| us     | Shoe! |
+--------+-------+
| ca     | Shoe. |
+--------+-------+ 
```

谢谢您的帮助！如果这样做的唯一方法是通过存储过程，那么我想我没有任何其他选择，在这种情况下，您是否介意将一个示例过程和查询放在一起，它将在上述表结构上执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T16:57:56.493

如果您不想创建视图，可以使用公用表表达式作为“临时”视图：

```
with normalized_products as (
   select 1 as country_id, 
          product_id, 
          upc,
          title 
   from us_products
   union all
   select 2 as country_id, 
          product_id, 
          upc,
          title 
   from ca_products
) 
SELECT countries.prefix,
       products.title
FROM relationships as rel
  JOIN normalized_products as prod
    ON rel.upc = prod.upc
   and rel.country_id = prod.country_id
where rel.upc = '111111111111' 
```

但同样：修复你的数据模型。这会越来越伤害你

# c# - 来自 DataSet 的 ObjectContext

> ID：14242217
> 
> 赞同：0
> 
> 时间：2013-01-09T16:50:49.070
> 
> 标签：c#, entity-framework, dataset, func, objectcontext

我正在尝试编译一个`linq`查询。

```
Func<ImportNewPermits_Enviance, String, EnumerableRowCollection<ImportNewPermits_Enviance._History_for_Permit__POI__Data_Row>> s_compiled =
    CompiledQuery.Compile<ImportNewPermits_Enviance, String, EnumerableRowCollection<ImportNewPermits_Enviance._History_for_Permit__POI__Data_Row>>(
        (ctx, poiName) => from r in ctx._History_for_Permit__POI__Data_
                          where r.POI_Name == poiName
                          select r); 
```

现在我正面临错误`There is no implicit reference conversion from ImportNewPermits_Enviance to System.Data.Objects.ObjectContext`

`ImportsNewPermits_Enviance`是输入的名称`DataSet`。

如何`ObjectContext`从类型化的`DataSet`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T22:01:52.590

我不明白你为什么需要编译查询。如果您对类型化的 DataSet 使用 Linq 查询，那是 Linq To Objects 查询的一种类型，这意味着它全部在内存中执行，应该非常快。但是，如果您真的想编译 Linq to Objects 查询，您可以在查询的 IEnumerable 上调用 AsQueryable()，然后存储生成的查询以供以后评估。我相信这会导致 Linq to Objects 提供程序编译查询，即：

```
var compiledQuery = from r in _History_for_Permit__POI__Data_.AsQueryable()
                          where r.POI_Name == poiName
                          select r 
```

# c++ - int 到 bool 转换

> ID：14242218
> 
> 赞同：0
> 
> 时间：2013-01-09T16:50:50.183
> 
> 标签：c++, casting, boolean, int, warnings

在 VS 10 中，我收到警告：

```
warning C4800: 'int' : forcing value to bool 'true' or 'false' (performance warning) 
```

试图编译

```
int x ;
static_cast<bool>(x); 
```

如何编写不会导致此警告的代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T16:52:18.550

这个怎么样：

```
x != 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:03:15.863

```
int x ;
bool b1 = !!x;  // common idiom; get used to it.  "Newcomers" just need to learn the idiom.
bool b2 = x!=0; // another way, less idiomatic 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:01:23.830

这是一个愚蠢的警告，可以忽略/禁用。据我所知，没有性能问题。

# javascript - Bootstrap 模态体最大高度 100%

> ID：14242227
> 
> 赞同：14
> 
> 时间：2013-01-09T16:51:19.537
> 
> 标签：javascript, css, html, twitter-bootstrap

我有一个自定义大小（80% 高度宽度）的引导模态主体，它可以滚动（主体内容会在某些尺寸的屏幕上溢出）

有2个问题：

1.  我不能将最大高度设置为 100%，因为这将是整个文档的 100%，而不是容器的最大高度，这是滚动正常工作所需要的。
2.  如果最末端的模态体内部有一个固定高度的div，如果屏幕不够大，它会溢出模态体之外。

我将如何解决这个问题？我目前正在尝试负边距，但我不太熟悉它。

JavaScript 解决方案是可以接受的（jQuery 和backbone.js 一样可用）

谢谢

编辑：提供截图

![在此处输入图像描述](../Images/5cd5c147485fc56d974f818864f57886.png)

编辑2：更多截图

![在此处输入图像描述](../Images/60c34dca75ae3c6be65f70a17b8b09e1.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-13T18:25:59.230

我屈服并写了咖啡脚本来解决这个问题。如果有人感兴趣，这里是咖啡脚本：

```
fit_modal_body = (modal) ->
  header = $(".modal-header", modal)
  body = $(".modal-body", modal)

  modalheight = parseInt(modal.css("height"))
  headerheight = parseInt(header.css("height")) + parseInt(header.css("padding-top")) + parseInt(header.css("padding-bottom"))
  bodypaddings = parseInt(body.css("padding-top")) + parseInt(body.css("padding-bottom"))

  height = modalheight - headerheight - bodypaddings - 5 # fudge factor

  body.css("max-height", "#{height}px")

# Here you need to bind your event with the appropriate modal, as an example:
$(window).resize(() -> fit_modal_body($(".modal"))) 
```

或上面生成的等效 javascript。

```
var fit_modal_body;

fit_modal_body = function(modal) {
  var body, bodypaddings, header, headerheight, height, modalheight;
  header = $(".modal-header", modal);
  body = $(".modal-body", modal);
  modalheight = parseInt(modal.css("height"));
  headerheight = parseInt(header.css("height")) + parseInt(header.css("padding-top")) + parseInt(header.css("padding-bottom"));
  bodypaddings = parseInt(body.css("padding-top")) + parseInt(body.css("padding-bottom"));
  height = modalheight - headerheight - bodypaddings - 5;
  return body.css("max-height", "" + height + "px");
};

$(window).resize(function() {
  return fit_modal_body($(".modal"));
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-27T11:28:12.893

我在长表格上遇到了同样的问题。Javascript 对我来说不是一个选项，所以我最终得到了一个完整的 HTML-CSS 解决方案。

主要目标是仅使用百分比对其进行编码，以便有一种简单的方法来构建媒体查询。

我已经使用 Firefox 22.0、Google Chrome 28.0.1500.71、Safari 6.0.5 和 IE8 对其进行了测试。[这是演示](http://codepen.io/lluisaznar/full/dHomE)。

**模态 HTML 结构：**

关键是让结构 div 从填充/边距/边框中清除。所有这些样式都应该应用于其中的项目。

```
<div id="dialog" class="modal hide dialog1" aria-hidden="false">
    <div class="modal-header">
    </div>
    <div class="modal-body">
        <div>
        </div>
    </div>
</div> 
```

**款式：**

应用于这些结构 div 的样式决定了其大小。

```
.modal.dialog1 { /* customized styles. this way you can have N dialogs, each one with its own size styles */
    width: 60%;
    height: 50%;
    left: 20%; /* ( window's width [100%] - dialog's width [60%] ) / 2 */
}

/* media query for mobile devices */
@media ( max-width: 480px ) {
    .modal.dialog1 {
        height: 90%;
        left: 5%; /* ( window's width [100%] - dialog's width [90%] ) / 2 */
        top: 5%;
        width: 90%;
    }
}

/* split the modal in two divs (header and body) with defined heights */
.modal .modal-header {
    height: 10%;
}

.modal .modal-body {
    height: 90%;
}

/* The div inside modal-body is the key; there's where we put the content (which may need the vertical scrollbar) */
.modal .modal-body div {
    height: 100%;
    overflow-y: auto;
    width: 100%;
} 
```

有关更详细的代码，请参阅[演示](http://codepen.io/lluisaznar/full/dHomE)，您将在其中看到整个样式类以及需要禁用/覆盖的引导样式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-19T16:08:12.923

试试这个`Bootstrap Modal v2.1`

> [https://github.com/jschr/bootstrap-modal](https://github.com/jschr/bootstrap-modal)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-14T19:50:34.523

您只需要在其显示上设置模态弹出窗口的高度，获取屏幕/窗口的高度并将其设置为模态的高度。（您可以将它乘以 0.8 以获得 80% 的屏幕高度，这非常适合）。

```
$('#YourModalId').on('show.bs.modal', function () {
    $('.modal .modal-body').css('overflow-y', 'auto'); 
    var _height = $(window).height()*0.8;
    $('.modal .modal-body').css('max-height', _height);
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-11T16:33:26.233

作为 pwnna 的回答的后续行动，这段代码对我来说效果更好，因为它使用可变高度，这取决于内容大小和最大高度，并且它也在加载时运行，而不仅仅是调整大小。

```
//adjust modal body sizes
var fit_modal_body;

fit_modal_body = function(modal) {
  var body, bodypaddings, header, headerheight, height, modalheight;
  header = $(".modal-header", modal);
  footer = $(".modal-footer", modal);
  body = $(".modal-body", modal);
  modalheight = parseInt(modal.css("height"));
  headerheight = parseInt(header.css("height")) + parseInt(header.css("padding-top")) + parseInt(header.css("padding-bottom"));
  footerheight = parseInt(footer.css("height")) + parseInt(footer.css("padding-top")) + parseInt(footer.css("padding-bottom"));
  bodypaddings = parseInt(body.css("padding-top")) + parseInt(body.css("padding-bottom"));
  height = $(window).height() - headerheight - footerheight - bodypaddings - 150;
  return body.css({"max-height": "" + height + "px", 'height':'auto'});
};

fit_modal_body($(".modal"));
$(window).resize(function() {
  return fit_modal_body($(".modal"));
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-21T19:06:46.637

这是一个完全可用的 Sass 解决方案，但它**需要 flexbox**。

```
 // don't clamp modal height when screen is shorter than 400px
  // .modal-body is short in that case, and the default behavior
  // (entire modal will scroll) is easier to use
  @media(min-height:400px)
    .modal
      // use top/bottom margin here instead of .modal-dialog
      // so that .modal-dialog can use height: 100%
      margin: 30px
      // without overflow: visible the shadow will be clipped
      // at the bottom
      overflow: visible

      > .modal-dialog
        margin: 0 auto
        // height must be explicitly set for .modal-content to
        // use percentage max-height
        height: 100%

        > .modal-content
          display: flex
          flex-direction: column
          max-height: 100%

          > .modal-header,
          > .modal-footer,
            // don't allow header/footer to grow or shrink
            flex: 0 0 auto

          > .modal-body
            // allow body to shrink but not grow
            flex: 0 1 auto
            // make body scrollable instead of entire modal
            overflow-y: auto 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-09T16:55:24.557

您应该尝试将其绝对定位在位置设置为相对的元素中。然后你可以在那里使用类似的东西

```
{
    bottom:0;
    top:0;
    left:0;
    right:0; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-09T17:02:06.417

使`html`和`body`元素填充窗口：

```
html, body { height: 100%; } 
```

现在您可以`max-height: 100%`在 body 内的元素上使用，它将是 100% 的窗口，因为`body`元素现在是窗口的大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-21T09:53:00.320

Pwnna 的回答有很好的概念，bud 对我不起作用。这是适合我的解决方案：

```
fit_modal_body = function (modal, padding) {
    var windowHeight = $(window).height();
    var modalHeight = modal.height();

    var dif = windowHeight - (modalHeight + 2*padding);
    var modalBody = $(".modal-body:first", modal);
    modalBody.css("max-height", modalBody.height() + dif);
};

resizeLastWindow = function () {
    fit_modal_body($(".modal-dialog:last"), 15);
};

$(window).resize(resizeLastWindow); 
```

这取决于css：

```
.modal-body {
    overflow-y: auto; 
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-16T14:36:06.877

这段代码

```
//adjust modal body sizes
var fit_modal_body;

fit_modal_body = function(modal) {
  var body, bodypaddings, header, headerheight, height, modalheight;
  header = $(".modal-header", modal);
  footer = $(".modal-footer", modal);
  body = $(".modal-body", modal);
  modalheight = parseInt(modal.css("height"));
  headerheight = parseInt(header.css("height")) + parseInt(header.css("padding-top")) + parseInt(header.css("padding-bottom"));
  footerheight = parseInt(footer.css("height")) + parseInt(footer.css("padding-top")) + parseInt(footer.css("padding-bottom"));
  bodypaddings = parseInt(body.css("padding-top")) + parseInt(body.css("padding-bottom"));
  height = $(window).height() - headerheight - footerheight - bodypaddings - 150;
  return body.css({"max-height": "" + height + "px", 'height':'auto'});
};

fit_modal_body($(".modal"));
$(window).resize(function() {
  return fit_modal_body($(".modal"));
}); 
```

由 [tsdexter 编写](https://stackoverflow.com/users/786094/tsdexter)，它对我有用！

# python - 向 Django 应用程序添加简单搜索

> ID：14242229
> 
> 赞同：0
> 
> 时间：2013-01-09T16:51:23.257
> 
> 标签：python, django, forms, postgresql, search

所以我按照[本](http://julienphalip.com/post/2825034077/adding-search-to-a-django-site-in-a-snap)教程来搜索我的一些模型。但是，对于所提供的内容缺乏文档，作为 Django 的新手，我很困惑为了完成这项工作而缺少什么。

所以这就是我所拥有的：

# 编辑

修改了搜索模板以包含一个用于获取查询的输入字段。

myproject.templates.search.html：

```
<form action="" method="get">
<label for="id_q">Search:</label>
<input id="id_q" name="q" type="text">
<input type="submit" value="Submit">

{% if found_entries %}
    <p>You searched for "{{ query_string }}".</p>
    <ul>
        {% for i in found_entries %}
            {{ i.uid }} {{ i.title }} {{ value|linebreaks }}
        {% endfor %}
    </ul>
{% endif %}

{% if query_string and not found_entries %}
    <p>No results found.</p>
{% else %}
    <p>Type a search query into the box above, and press "Submit" to search.</p>
{% endif %}

</form> 
```

myapp.models.py：

```
from django.db import models

class Book(models.Model):
    uid = models.IntegerField(primary_key=True)
    title = models.CharField(max_length=30)
    class Meta:
        db_table = u'books' 
```

myapp.search.py​​：

```
import re

from django.db.models import Q

def normalize_query(query_string,
                findterms=re.compile(r'"([^"]+)"|(\S+)').findall,
                normspace=re.compile(r'\s{2,}').sub):
''' Splits the query string in invidual keywords, getting rid of unecessary spaces
    and grouping quoted words together.
    Example:

    >>> normalize_query('  some random  words "with   quotes  " and   spaces')
    ['some', 'random', 'words', 'with quotes', 'and', 'spaces']

'''
return [normspace(' ', (t[0] or t[1]).strip()) for t in findterms(query_string)] 

def get_query(query_string, search_fields):
''' Returns a query, that is a combination of Q objects. That combination
    aims to search keywords within a model by testing the given search fields.

'''
query = None # Query to search for every search term        
terms = normalize_query(query_string)
for term in terms:
    or_query = None # Query to search for a given term in each field
    for field_name in search_fields:
        q = Q(**{"%s__icontains" % field_name: term})
        if or_query is None:
            or_query = q
        else:
            or_query = or_query | q
    if query is None:
        query = or_query
    else:
        query = query & or_query
return query 
```

myapp.views.py：

```
from myapp.models import Book
from django.shortcuts import render_to_response
from django.template import RequestContext

def search(request):
    query_string = ''
    found_entries = None
    search_fields=('uid')

    if ('q' in request.GET) and request.GET['q'].strip():

        query_string = request.GET['q']

        entry_query = get_query(query_string, search_fields)

        found_entries = Book.objects.filter(entry_query)

        return render_to_response('search.html',
                         { 'query_string': query_string, 'found_entries': found_entries },
                         context_instance=RequestContext(request)) 
```

myproject.templates.search.html：

```
{% if found_entries %}
    <p>You searched for "{{ query_string }}".</p>
    <ul>
    {% for i in found_entries %}
        <li><a href="{{ q.get_absolute_url }}">{{ found_entries }}</a></li>
    {% endfor %}
    </ul>
{% endif %}
{% if query_string and not found_entries %}
    <p>No results found.</p>
{% else %}
    <p>Type a search query into the box above, and press "Submit" to search.</p>
{% endif %} 
```

我的项目.urls.py

```
from django.conf.urls import patterns, include, url

urlpatterns = patterns('',
url(r'^predictor/$', 'myapp.views.search'),
) 
```

如果我去，这就是它的样子：`http://localhost:8000/myapp/`

图片：http: [//i.imgur.com/QFaWZ.png](http://i.imgur.com/QFaWZ.png)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:01:09.333

您的模板中没有表单：您从未在页面上放置搜索框，那么为什么要显示呢？

查看[有关使用表单的 django 文档](https://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs)。

* * *

这将需要大量的工作，但您没有使用任何 Django 的内置机制来创建表单。这样做将使您的代码更清晰（并且会更容易！）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:12:21.013

如果您查看您的代码（我鼓励您这样做），您正在查看的视图是 myapp.views.search 对吗？查看您的搜索功能，您应该能够看到它在 request.GET 中查找 'q' 键，这相当于从查询字符串中获取 'q' 元素，所以它就是从中获取搜索的地方。

因此，要进行搜索，您将转到`http://localhost:8000/myapp/?q=searchterm`“searchterm”指您要搜索的术语的位置。

就像 thomas 所说的那样，尽管您可能还想创建一个表单来使用此功能。

# c - 将 memcpy 与 mmap 一起使用的问题

> ID：14242231
> 
> 赞同：8
> 
> 时间：2013-01-09T16:51:27.357
> 
> 标签：c, linux

尝试使用这些函数复制文件，一切正常，直到程序遇到 memcpy 函数，该函数给出总线错误并终止进程。

```
void copy_mmap(char* in, char* out){

int input_fd, output_fd;

input_fd = open (in, O_RDONLY);
if (input_fd == -1) {
        printf("Error opening input file.\n");
        exit(2);
}

output_fd = open(out, O_RDWR | O_CREAT, S_IWUSR | S_IRUSR);
if(output_fd == -1){
    printf("Error opening output file.\n");
    exit(3);
}

struct stat st;
fstat(input_fd, &st);

char* target;
target=mmap(0, st.st_size+1, PROT_READ, MAP_SHARED, input_fd, 0);
if (target==(void*) -1){
    printf("Error mapping target with errno: %d.\n", errno);
    exit(6);
}

char* destination;
destination=mmap(0, st.st_size+1, PROT_READ | PROT_WRITE, MAP_SHARED, output_fd, 0);
if (destination==(void*) -1){
    printf("Error mapping destination with errno: %d.\n", errno);
    exit(5);
}

memcpy(destination, target, st.st_size);
munmap(destination, st.st_size);

} 
```

未能找出问题所在，因为“总线错误”不是描述性错误消息，并且互联网上没有太多关于此问题的材料。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-09T17:02:23.060

当您将目标文件创建为新文件时，其大小为 0 字节。`memcpy`崩溃，因为它试图将数据写入文件末尾之外。

您可以通过将目标文件的大小预先调整为源文件的大小（使用`ftruncate()`）来完成`mmap()`这项工作。

此外，您应该`st.st_size`作为第二个参数传递给`mmap`，而不是`st.st_size+1`。`st.st_size+1`尝试映射大于文件大小的范围，这是无效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-17T09:27:43.467

您也可以 lseek 到 off_t fileposition= lseek(output_fd, st.st_size-1, SEEK_SET) 并将一个空字符写入 output_fd。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T16:58:11.393

也许尝试使用 memmove？您不是从同一个内存/文件/设备位置读取和写入吗？Memcpy 在这种情况下会失败。

# c# - ASP.NET MVC API 接收请求但未正确路由

> ID：14242232
> 
> 赞同：0
> 
> 时间：2013-01-09T16:51:36.537
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, http

我有一个 ASP.NET MVC API 端点。当我使用内容类型 JSON 测试发布到它时，它运行良好并且端点被命中。但是，当我使用 content-type multipart/form-data 时，它不起作用。我知道服务器正在接收请求，因为 global.asax 中的 Application_EndRequest 上的断点被命中。而且我还知道，无论服务器在何处解析请求，它都会正确执行，因为我对 Request.Form 对象的观察表明正文中的键值对正在正确反序列化。那么为什么服务器能够捕获传入的请求并且不能正确地将其路由到我的端点呢？我已经盯着这个看了一段时间，但是尽管请求被服务器接收并解析，端点的实际控制器函数上的断点从未被命中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:13:37.807

使用 Phil Haack 的路由调试器：[http](http://haacked.com/archive/2011/04/13/routedebugger-2.aspx) ://haacked.com/archive/2011/04/13/routedebugger-2.aspx 或 nugut 包：[http ://nuget.org/packages/routedebugger](http://nuget.org/packages/routedebugger)

这将告诉您哪些路由（如果有）与 url 匹配。

# wordpress - wordpress 图片链接

> ID：14242234
> 
> 赞同：1
> 
> 时间：2013-01-09T16:51:44.543
> 
> 标签：wordpress, hyperlink, image

我正在写一个用 wordpress 制作的小博客。我是 CMS 世界的新手。

当我单击索引中的每个图像时，我遇到了一个问题。不同的是，当我点击标题链接时，如果我点击一张图片，它会打开一个没有标签、类别和文本的页面。

有什么解决问题的建议吗？

先感谢您。

wordpress 博客链接： http: [//www.studiover.net/annacosmesi](http://www.studiover.net/annacosmesi)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T07:17:27.847

[你的意思是这样吗？](http://codegrad.hub.ph/removing-the-link-of-image-in-wordpress-attachment-page/)

请注意，此修复将在 Wordpress 更新后消失。您可能想要收藏/收藏该 URL。

# jquery - 使用 RedirectToaction MVC3 将参数值传递给操作

> ID：14242235
> 
> 赞同：0
> 
> 时间：2013-01-09T16:51:49.483
> 
> 标签：jquery, asp.net-mvc-3

这是我在控制器中的操作方法

```
public ActionResult RedirectToDemoView(string message)
{
    var model = new Error();
    model.Message = message;
    return this.View("Error", model);
} 
```

如何使用 jquery 从我的视图 (.cshtml) 页面将参数传递给此操作？这是我的代码

```
redirectToAction('@Url.Action("RedirectToDemoView", "Audit" )',
    new { message:$(request.responseText).find('h2').eq(0).text() }); 
```

它正在将`null`值传递给`RedirectToDemoView`方法。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:12:49.363

以下应该有效：

```
var message = $(request.responseText).find('h2').eq(0).text();
var url = '@Url.Action("RedirectToDemoView", "Audit")?message=' + encodeURIComponent(message);
redirectToAction(url); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:09:37.050

试试这个：

```
redirectToAction('@Url.Content("~/Audit/RedirectToDemoView?message=")' 
                   + $(request.responseText).find('h2').eq(0).text()); 
```

希望这会有所帮助！

# java - 让 Gson 在错误的类型上抛出异常

> ID：14242236
> 
> 赞同：22
> 
> 时间：2013-01-09T16:51:50.130
> 
> 标签：java, json, gson, type-safety

我在我的项目中使用 Gson 将 JSON 字符串反序列化为 Java 对象。如果我提出一个请求，我期望来自服务器的明确响应。服务器将返回我期望的明确定义的响应，或者它将返回一个（也已定义的）错误对象。

为了清楚起见：假设我有一个像这样的简单对象：

```
class Dummy{
   private String foo;
   private int bar;
} 
```

和这样的错误对象：

```
class ErrorHolder{
   private RequestError error;
}

class RequestError{
    private String publicMsg;
    private String msg;
} 
```

如果我得到像这样的服务器响应

`{"foo":"Hello World", "bar":3 }`

一切都按预期工作。

但如果反应是这样的

`{"error":{"publicMsg":"Something bad happened", msg:"you forgot requesting some parameter"}}`

我会得到一个`Dummy`对象在哪里`foo`是`null`和`bar`是0！Gson 文档（fromJson）明确指出：

> 抛出 JsonSyntaxException - 如果 json 不是 classOfT 类型对象的有效表示

所以如果我尝试像这样解析第二个响应，我希望得到一个 JsonSyntaxException：

```
Dummy dummy = Gson.fromJson(secondResponse, Dummy.class); 
```

因为 Json 不代表一个 Dummy 对象，而是一个 ErrorHolder 对象。

所以我的问题是：有没有办法让 Gson 以某种方式检测到错误的类型，并向我抛出异常？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T20:25:05.030

不幸的是，那里的文档有点误导。

只有当你的类有一个字段的类型与 JSON 中的不匹配时，它才会抛出异常，即使这样，它也会做一些疯狂的事情来尝试修复它（例如将`int`JSON 中的 a转换为`String`你的类中的a ）。如果您的 POJO 中有类似字段的内容，并且在 JSON 中`Date`遇到了一个字段，它会抛出它。`int`JSON 中存在但 POJO 中不存在的字段将被静默忽略，JSON 中缺少但存在于 POJO 中的字段设置为`null`.

目前，GSON 没有为任何类型的“严格”反序列化提供机制，在这种反序列化中，您可能会`@Required`在 POJO 中为字段添加注释。

在你的情况下......我只是扩展我的 POJO 以包含一个内部错误对象......就像：

```
class Dummy {
   private String foo;
   private int bar;
   private Error error;

   private class Error {
        String publicMsg;
        String msg;
   }

   public boolean isError() {
       return error != null;
   }

   // setters and getters for your data, the error msg, etc.
} 
```

您的另一个选择是编写一个自定义反序列化程序，如果 JSON 是错误，则抛出异常，例如：

```
class MyDeserializer implements JsonDeserializer<Dummy>
{
    @Override
    public Dummy deserialize(JsonElement json, Type typeOfT, 
                              JsonDeserializationContext context)
                    throws JsonParseException
    {
        JsonObject jsonObject = (JsonObject) json;

        if (jsonObject.get("error") != null)
        {
            throw new JsonParseException("Error!");
        }

        return new Gson().fromJson(json, Dummy.class);
    }
} 
```

**编辑添加：**最近有人对此表示赞同并重新阅读它，我想“嗯，你知道，你可以自己做这个，它可能会很方便”。

这是一个可重复使用的反序列化器和注释，它将完全符合 OP 的要求。限制是，如果 POJO 需要按原样自定义反序列化器，则您必须更进一步，要么在构造函数中传入一个`Gson`对象以反序列化为对象本身，要么将注解检出到单独的方法中并使用它在你的反序列化器中。您还可以通过创建自己的异常并将其传递给来改进异常处理，`JsonParseException`以便可以`getCause()`在调用者中检测到它。

综上所述，在绝大多数情况下，这将起作用：

```
public class App
{

    public static void main(String[] args)
    {
        Gson gson =
            new GsonBuilder()
            .registerTypeAdapter(TestAnnotationBean.class, new AnnotatedDeserializer<TestAnnotationBean>())
            .create();

        String json = "{\"foo\":\"This is foo\",\"bar\":\"this is bar\"}";
        TestAnnotationBean tab = gson.fromJson(json, TestAnnotationBean.class);
        System.out.println(tab.foo);
        System.out.println(tab.bar);

        json = "{\"foo\":\"This is foo\"}";
        tab = gson.fromJson(json, TestAnnotationBean.class);
        System.out.println(tab.foo);
        System.out.println(tab.bar);

        json = "{\"bar\":\"This is bar\"}";
        tab = gson.fromJson(json, TestAnnotationBean.class);
        System.out.println(tab.foo);
        System.out.println(tab.bar);
    }
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
@interface JsonRequired
{
}

class TestAnnotationBean
{
    @JsonRequired public String foo;
    public String bar;
}

class AnnotatedDeserializer<T> implements JsonDeserializer<T>
{

    public T deserialize(JsonElement je, Type type, JsonDeserializationContext jdc) throws JsonParseException
    {
        T pojo = new Gson().fromJson(je, type);

        Field[] fields = pojo.getClass().getDeclaredFields();
        for (Field f : fields)
        {
            if (f.getAnnotation(JsonRequired.class) != null)
            {
                try
                {
                    f.setAccessible(true);
                    if (f.get(pojo) == null)
                    {
                        throw new JsonParseException("Missing field in JSON: " + f.getName());
                    }
                }
                catch (IllegalArgumentException ex)
                {
                    Logger.getLogger(AnnotatedDeserializer.class.getName()).log(Level.SEVERE, null, ex);
                }
                catch (IllegalAccessException ex)
                {
                    Logger.getLogger(AnnotatedDeserializer.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }
        return pojo;

    }
} 
```

输出：

```
这是富
这是酒吧
这是富
空值
线程“主”com.google.gson.JsonParseException 中的异常：JSON 中缺少字段：foo

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-13T04:02:04.323

我创建了 Brian 解决方案的更新版本，它处理嵌套对象并进行了一些其他小的更改。该代码还包括一个更简单的构建器，用于创建*Gson*对象，这些对象知道具有用*JsonRequired*注释的字段的类。

```
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import java.lang.reflect.Field;
import java.lang.reflect.Type;
import java.util.List;
import com.google.common.base.Function;
import com.google.common.base.Joiner;
import com.google.common.collect.FluentIterable;
import com.google.common.collect.Lists;
import com.google.common.primitives.Primitives;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonDeserializationContext;
import com.google.gson.JsonDeserializer;
import com.google.gson.JsonElement;
import com.google.gson.JsonParseException;

public class AnnotatedDeserializer<T> implements JsonDeserializer<T> {

private final Gson gson = new Gson();

public T deserialize(JsonElement je, Type type, JsonDeserializationContext jdc) throws JsonParseException {

    T target = gson.fromJson(je, type);
    checkRequired(target);
    return target;
}

private List<Field> findMissingFields(Object target, List<Field> invalidFields) {

    for (Field field : target.getClass().getDeclaredFields()) {
        if (field.getAnnotation(JsonRequired.class) != null) {

            Object fieldValue = ReflectionUtil.getFieldValue(target, field);

            if (fieldValue == null) {
                invalidFields.add(field);
                continue;
            }

            if (!isPrimitive(fieldValue)) {
                findMissingFields(fieldValue, invalidFields);
            }
        }
    }
    return invalidFields;
}

private void checkRequired(Object target) {

    List<Field> invalidFields = Lists.newArrayList();
    findMissingFields(target, invalidFields);

    if (!invalidFields.isEmpty()) {
        throw new JsonParseException("Missing JSON required fields: {"
                + FluentIterable.from(invalidFields).transform(toMessage).join(Joiner.on(", ")) + "}");
    }
}

static Function<Field, String> toMessage = new Function<Field, String>() {
    @Override
    public String apply(Field field) {
        return field.getDeclaringClass().getName() + "/" + field.getName();
    }
};

private boolean isPrimitive(Object target) {

    for (Class<?> primitiveClass : Primitives.allPrimitiveTypes()) {
        if (primitiveClass.equals(target.getClass())) {
            return true;
        }
    }
    return false;
}

public static class RequiredFieldAwareGsonBuilder {

    private GsonBuilder gsonBuilder;

    private RequiredFieldAwareGsonBuilder(GsonBuilder gsonBuilder) {
        this.gsonBuilder = gsonBuilder;
    }

    public static RequiredFieldAwareGsonBuilder builder() {
        return new RequiredFieldAwareGsonBuilder(new GsonBuilder());
    }

    public <T> RequiredFieldAwareGsonBuilder withRequiredFieldAwareType(Class<T> classOfT) {
        gsonBuilder.registerTypeAdapter(classOfT, new AnnotatedDeserializer<T>());
        return this;
    }

    public Gson build() {
        return gsonBuilder.create();
    }
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
public static @interface JsonRequired {
}
} 
```

和反射实用程序

```
import java.lang.reflect.Field;

public final class ReflectionUtil {

private ReflectionUtil() {
}

public static Object getFieldValue(Object target, Field field) {
    try {
        boolean originalFlag = changeAccessibleFlag(field);
        Object fieldValue = field.get(target);
        restoreAccessibleFlag(field, originalFlag);
        return fieldValue;
    } catch (IllegalAccessException e) {
        throw new RuntimeException("Failed to access field " + field.getDeclaringClass().getName() + "/"
                + field.getName(), e);
    }
}

private static void restoreAccessibleFlag(Field field, boolean flag) {
    field.setAccessible(flag);
}

private static boolean changeAccessibleFlag(Field field) {
    boolean flag = field.isAccessible();
    field.setAccessible(true);
    return flag;
}
} 
```

如果你使用 Guice，你可以在你的模块中添加这样的东西来注入 Gson 对象

```
@Provides
@Singleton
static Gson provideGson() {
    return RequiredFieldAwareGsonBuilder.builder().withRequiredFieldAwareType(MyType1.class)
            .withRequiredFieldAwareType(MyType2.class).build();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-23T23:57:55.280

我不是所选解决方案的粉丝。它有效，但这不是使用 Gson 的方式。Gson 将特定的 JSON 模式映射到对象，反之亦然。理想情况下，您使用的 JSON 格式正确（因此，如果您可以控制 JSON 格式，请考虑更改它），但如果没有，您应该设计解析对象来处理您希望收到的所有情况。

有时您确实需要编写 custom `JsonDeserializer`，但这不是其中之一。发送消息*或*错误是一种非常标准的做法，通过正确的数据结构，GSON 可以直接处理这样一个简单的用例。

### 如果您可以控制 JSON 模式

考虑这样的事情：

```
{
  "message": {
    "foo": "Hello World",
    "bar": 3
  },
  "error": null;
}

{
  "message": null,
  "error": {
    "publicMsg": "Something bad happened",
    "msg": "you forgot requesting some parameter"
  }
} 
```

请注意，您现在可以定义一个干净的包装类，尽可能*提供* `Dummy`对象：

```
public class JsonResponse {
  private Dummy message;
  private RequestError error;

  public boolean hasError() { return error != null; }
  public Dummy getDummy() {
    Preconditions.checkState(!hasError());
    return message;
  }
  public RequestError getError() {
    Preconditions.checkState(hasError());
    return error;
  }
} 
```

### 如果您必须处理现有的 JSON 模式

如果你不能重构模式，你必须重构解析类，它看起来像这样：

```
public class JsonResponse {
  private String foo;
  private int bar;

  private RequestError error;

  public boolean hasError() { return error != null; }
  public Dummy getDummy() {
    Preconditions.checkState(!hasError());
    return new Dummy(foo, bar);
  }
  public RequestError getError() {
    Preconditions.checkState(hasError());
    return error;
  }
} 
```

这比修复架构不太理想，但无论哪种方式，您都可以获得相同的通用 API - 调用`hasError()`以查看请求是否成功，然后调用`getDummy()`或`getError()`根据需要调用。调用其他方法（例如`getDummy()`，当您收到错误时）将快速失败。

# javascript - 在拉斐尔矢量图形中移动三角形的位置

> ID：14242237
> 
> 赞同：2
> 
> 时间：2013-01-09T16:51:51.700
> 
> 标签：javascript, svg, raphael, vector-graphics

我正在使用 Raphael.js 创建一个“播放”按钮图标。但是，三角形的位置太靠近圆的边缘。在鼠标悬停时，我正在增加笔划宽度 - 问题是三角形实际上位于圆圈之外，这根本不是我想要的。HTML 只是一个带有 id 的 div：

```
<html>
 <head>
 </head>
 <body>
  <div id="playB"></div>
 </body>
</html> 
```

javascript相当长，所以[这里是jsfiddle](http://jsfiddle.net/jmpdK/)

在这种情况下，“移动”SVG 路径的最简单方法是什么？即 - 从右侧开始，从顶部开始。我尝试了各种方法，但除了更改图标的大小 - 将路径的每个数字乘以 x 之外，我根本无法操作图标。在这种情况下，移动图标的特定元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:11:34.743

您需要拆分路径以调整三角形的位置。通过挑选第二个“M”在路径中的位置，我能够通过肉眼做到这一点：

```
var playB = Raphael('playB', 200, 200);
var circle =          playB.path("M64,5.864C31.892,5.864,5.864,31.892,5.864,64c0,32.108,26.028,58.136,58.136,58.136c32.108,0,58.136-26.028,58.136-58.136C122.136,31.892,96.108,5.864,64,5.864z");
var triangle =  playB.path("M26.736,102.728L97.264,62L26.736,21.272V102.728z"); 
```

然后你可以将三角形移过来：

```
triangle.attr("transform", "T15,0"); 
```

要保持属性和动画完整，请将两者都添加到 Raphael 集中：

```
var playBP = playB.set();
playBP.push(circle, triangle);
playBP.attr({
  'stroke-width': 5,
  'stroke': "#000",
  'fill': "#fff",
  'opacity': 1
}); 
```

然后你只需要一个小改动：将鼠标悬停命令中的“this”更改为“playBP”。这似乎是多余的，但“this”指的是鼠标悬停的单个元素，而不是集合。

```
var speed = 5;

playBP.mouseover(function(){
  playBP.animate({
    'stroke-width': 10,
    'stroke': "#fff",
    'fill': "#000",
    'opacity': .9
  }, 1000, 'elastic');

});
playBP.mouseout(function(){
  playBP.stop().animate({
    'stroke-width': 5,
    'stroke': "#000",
    'fill': "#fff",
    'opacity': 1    
  }, speed*4, 'elastic');

}); 
```

[jsFiddle 更新了](http://jsfiddle.net/jmpdK/1/)

如果您只想修复路径，可以使用 Raphael.mapPath() 函数来获取三角形的调整后 x/y，如下所示：

```
console.log(Raphael.mapPath(triangle.attr("path"), triangle.matrix)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T17:27:04.040

我采取了简单的方法并改变了您在inkscape中的路径。这很容易做到。如果你有兴趣，这就是我所做的。

*   在inkscape中创建一个路径并选择它。
*   Ctrl-shift-x 启动 xml 编辑器。应该选择您的路径。
*   单击“d”属性。
*   在下面的框中，将值替换为小提琴中的值。
*   点击设置。
*   该路径将被修改为类似于您在小提琴中的路径。

然后我只是选择了三角形节点并将它们移过来。返回 xml 编辑器，选择“d”值，然后将其放入您的小提琴中。

```
var playBP =          playB.path("M 64,5.864 C 31.892,5.864 5.864,31.892 5.864,
64 5.864,96.108 31.892,122.136 64,122.136 96.108,122.136 122.136,96.108 122.136,
64 122.136,31.892 96.108,5.864 64,5.864 z M 38.640816,102.728 109.16882,
62 38.640816,21.272 z"); 
```

[瞧。](http://jsfiddle.net/amadanNM/FxHhd/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-09T17:42:56.757

`el.transform('t{x},{y}')`例如，使用`el.transform('t1,1')`将任何元素向右和向下平移 1 个像素。您可以根据需要为 x 和 y 替换不同的值，包括负值。

# com - MSI 不修复某些注册表项

> ID：14242241
> 
> 赞同：1
> 
> 时间：2013-01-09T16:52:04.997
> 
> 标签：com, installation, registry, windows-installer

当我从命令行运行命令“msiexec /fm”时，我注意到某些 HKLM 注册表项没有被修复。当我在 C++ 中执行以下操作时也会发生同样的事情：“MsiReinstallProduct(ProductCode, REINSTALLMODE_REPAIR | REINSTALLMODE_MACHINEDATA);”

情况是这样的。我有一个必须注册的 COM DLL。此 DLL 的 CLSID 信息位于 MSI 注册表中。在安装过程中，MSI 会将信息放入注册表中。如果我手动删除 CLSID 键并进行修复“msiexec /fm”，则注册表键会正确恢复。同样，如果我手动更改注册表中指向 DLL 的路径，则 MSI 会将字符串修复为其原始值。

有一个工作流程不会修复密钥。如果我在机器上放置一个新版本的 DLL 来替换安装时附带的那个，那么 MSI 将不再修复 CLSID 密钥。就好像 MSI 决定不应修复此密钥，因为 DLL 不相同。即使 DLL 已更改，我也需要一种强制 MSI 修复来修复注册表项的方法。

命令“msiexec /fdm”实际上会修复注册表项，但它也会将文件更新回原始文件。就我而言，我有一个新文件，因为它安装在服务包中。我希望保留新文件，并且只修复注册表项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T07:21:42.027

我的猜测是 DLL 文件是保存注册表项的组件中的关键成员。默认情况下，除非缺少关键成员，否则不会重新安装组件。您应该指定更多标志以确保触发组件重新安装。例如 /fpem

[http://technet.microsoft.com/en-us/library/cc759262(v=ws.10).aspx#BKMK_Repair](http://technet.microsoft.com/en-us/library/cc759262(v=ws.10).aspx#BKMK_Repair)

# django - 工作人员热关闭后未确认芹菜任务

> ID：14242244
> 
> 赞同：2
> 
> 时间：2013-01-09T16:52:06.027
> 
> 标签：django, celery, djcelery

我是 djcelery 开发的新手。我想通过 Web 界面上的按钮关闭工作人员。因此，当在 tasks.py 中单击按钮时，我将调用以下任务：

```
result = broadcast('shutdown', destination=[worker.hostname]) 
```

我注意到如果工作人员作为一个活动任务，它不会立即关闭，它会在任务执行完成后关闭。但是，任务状态始终为“已启动”。如果我重新启动worker，任务将再次被拾取并执行。反正我可以更新任务状态，因为它已经被执行了吗？我确实将 CELERY_ACKS_LATE 设置为 True。

更新：我使用的 celery 版本是 3.0.9（Chiastic Slide），我使用 Rabbitmq 作为代理。

# ios - iOS 6 - 当手势被识别并且 UIActivityIndi cator 不显示时，我的应用程序滞后。我需要做什么？

> ID：14242245
> 
> 赞同：0
> 
> 时间：2013-01-09T16:52:11.900
> 
> 标签：ios, uiwebview, uigesturerecognizer, uiactivityindicatorview

我添加了一个手势识别器（两指点击），它检测用户何时按下 UIWebView 中的图像并调出 UIActivityViewController 来保存图像和其他内容。我的问题是，当我按下图像时会出现延迟（取决于图像大小可能有多大），而我想要实现的是，当用户双击图像时，我想显示一个活动指示器，直到图像已准备好保存等...我可以补充一点，我认为问题出在 'imageToBeSaved = [UIImage imageWithData:[NSData dataWithContentsOfURL:url]];' 在我取出该代码后，就没有更多的滞后了。这是我的代码：

```
// adding gesture recognizer to "website" (which is a "UIWebView")
UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(doubleTap:)];
doubleTap.numberOfTouchesRequired = 2;
[website addGestureRecognizer:doubleTap];

// actions on gesture detect and call actionsOnImage for options
-(void) doubleTap :(UITapGestureRecognizer*) sender {
[loadingImageActivityIndicator startAnimating];
int scrollPositionY = [[self.website stringByEvaluatingJavaScriptFromString:@"window.pageYOffset"] intValue];
int scrollPositionX = [[self.website stringByEvaluatingJavaScriptFromString:@"window.pageXOffset"] intValue];

int displayWidth = [[self.website stringByEvaluatingJavaScriptFromString:@"window.outerWidth"] intValue];
CGFloat scale = website.frame.size.width / displayWidth;

CGPoint pt = [sender locationInView:self.website];
pt.x *= scale;
pt.y *= scale;
pt.x += scrollPositionX;
pt.y += scrollPositionY;

NSString *js = [NSString stringWithFormat:@"document.elementFromPoint(%f, %f).tagName", pt.x, pt.y];
NSString *tagName = [self.website stringByEvaluatingJavaScriptFromString:js];

if ([tagName compare:@"IMG" options:NSCaseInsensitiveSearch]==NSOrderedSame) {
    NSLog(@"tagName was IMG");
    NSString *imgURL = [NSString stringWithFormat:@"document.elementFromPoint(%f, %f).src", pt.x, pt.y];
    NSString *urlToSave = [self.website stringByEvaluatingJavaScriptFromString:imgURL];
    NSURL *url = [NSURL URLWithString:urlToSave];
    imageToBeSaved = [UIImage imageWithData:[NSData dataWithContentsOfURL:url]];
    [website addSubview:loadingImageActivityIndicator];

    [self actionsOnImage];  // self made function with sharing capabilities (see below)
}

}

- (void) actionsOnImage {
[loadingImageActivityIndicator stopAnimating];

NSArray* dataToShare = [[NSArray alloc] initWithObjects:imageToBeSaved, nil];
UIActivityViewController* activityViewController =
[[UIActivityViewController alloc] initWithActivityItems:dataToShare
                                  applicationActivities:nil];
[self presentViewController:activityViewController animated:YES completion:^{}];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:08:01.487

异步执行图像加载。重新排列您的代码行，如下所示

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),^{
     imageToBeSaved = [UIImage imageWithData:[NSData dataWithContentsOfURL:url]];
     [self actionsOnImage];
});

[website addSubview:loadingImageActivityIndicator]; 
```

# asp.net-mvc-3 - chrome 和 firefox 中 ajax.beginform 的完整回发

> ID：14242247
> 
> 赞同：0
> 
> 时间：2013-01-09T16:52:17.430
> 
> 标签：asp.net-mvc-3, asp.net-ajax

类似于[MVC 3 - Ajax.BeginForm 做了一个完整的回发](https://stackoverflow.com/questions/5061063/mvc-3-ajax-beginform-does-a-full-post-back)，但我已经验证了对 jquery.unobtrusive-ajax.min.js 的引用确实存在于我的页面中。另外，它在 IE 9 中运行良好，但在 Firefox 和 Chrome 中，我只获得作为完整网页的部分视图，而不是用该部分视图的内容替换 div。

我对 MVC3 还是很陌生，所以我确信这很简单。

概要：

在我的页面中，有几个不同的 .cshtml 文件在用户单击链接时变得可见。在 EquipmentData.cshtml 文件中，我有一个下拉列表，它在更改时会向控制器执行 ajax 回发，以将编辑器模板加载到 div 中。

在该编辑器模板 (StorageTankData.cshtml) 中，有一个数据列表和一个用于单个项目 (StorageTank.cshtml) 的编辑模板的占位符。StorageTank.cshtml 被初始化以插入一个新的（id 为零）；当用户单击数据列表中的一项时，我们再次调用控制器以获取该特定项的 StorageTank.cshtml 部分视图并将该 html 替换为编辑 div。

所有这些都很好。在 StorageTank.cshtml 模板中，我有一个 Ajax.Begin 表单，它发布到不同的控制器操作以保存储罐数据，然后调用相同的控制器方法来获取 StorageTankData.cshtml 部分视图。我们的想法是我们将刷新项目列表并将编辑表单重置为插入模式并将其替换到 div 中。

这在 IE 中运行良好，但在 Chrome 和 Firefox 中，我得到的只是页面上的部分视图，而不是整个页面，替换发生了。我*认为*这是因为我的保存回发与生成整个页面的控制器方法不同，但我不确定该怎么做。

我在 IE 中看到的是 URL 停留在“/Edit”（控制整个页面的操作）上，并且替换效果很好。在 Chrome 和 FF 中，网址改为我的“/SaveStorageTank”操作。所以，我认为这解释了为什么那些浏览器在完成后只显示部分视图。我不明白的是为什么他们不继续进行替换。

在重新显示之前，我在 Firebug 或 Chrome 中都看不到错误。（当然，他们被 $(document).ready... 东西绊倒了，因为该部分视图没有加载 jquery 文件）。但是，也许我只是不知道在哪里/如何查找这些错误。

好吧，对不起，长篇大论。这里有一些细节。

**EquipmentEdit.cshtml**

```
@model kpa.mko.bll.viewmodels.clientData.ClientDataFormViewModel

    <table id="equipment">
        <tr class="form-row">
            <td class="form-left">Forklift On Site?</td>
            <td class="form-right">
                @Html.EditorFor(x => x.ForkliftOnSite)
                @Html.ValidationMessageFor(x => x.ForkliftOnSite)
            </td>
        </tr>
        <tr class="form-row">
            <td class="form-left">Equipment</td>
            <td class="form-right">
                @Html.HiddenFor(m => m.AccountId)
                Equipment Type: <select id="ddlEquipmentType">
                    <option value="">--select one--</option>
                    @foreach (var lookupValue in Model.EquipmentTypes.OrderBy(lv => lv.ShortName))
                    {
                        <option value="@lookupValue.LookupValueId">@lookupValue.ShortName</option>
                    }
                </select>
                <div id="divEquipmentEdit" style="display: none;">
                </div>
            </td>
        </tr>
    </table>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#ddlEquipmentType").change(
                function () {
                    var selection = $("#ddlEquipmentType option:selected").text();

                    if (selection == "Storage Tanks") {
                        //Try to get the partial view of the editor template                }
                        $.ajax({
                            url: '@Url.Action("LoadStorageTankDataEditor")',
                            type: "POST",
                            contentType: "application/json; charset=utf-8",
                            data: JSON.stringify({ accountId: $('#AccountId').val() }),
                            dataType: "html",
                            success: function (view) {
                                $('#divEquipmentEdit').show();
                                $('#divEquipmentEdit').html(view);
                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                alert('error = ' + thrownError);
                                alert('xhr resp text = ' + xhr.responseText);
                            }
                        });
                    } else {
                        $('#divEquipmentEdit').hide();
                    }
                }
            );
        });
    </script> 
```

**StorageTankData.cshtml**

```
@model kpa.mko.bll.viewmodels.clientData.StorageTankData

@using kpa.mko.dal.Entities;

Existing Tanks:
<br /><br />
@Html.HiddenFor(m => m.AccountId)
@if (Model.StorageTanks.Count == 0)
{
    <div>No tanks for this account.</div>
}
else
{
    foreach (StorageTank st in Model.StorageTanks)
    {
        @st.ListDescription <a href="javascript:getEditor(@st.StorageTankID);">Edit</a><br />
    }
}

<br /><br />
<div id="divTankEditor">
</div>

<script type="text/javascript">
    $(document).ready(function () {
        getEditor(0);
    });

    function getEditor(storageTankId) {

        //Substitute in the StorageTank editor to the div above.
        $.ajax({
            url: '@Url.Action("LoadStorageTankEditor")',
            type: "POST",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({ storageTankId: storageTankId, accountId: $('#AccountId').val() }),
            dataType: "html",
            success: function (view) {
                $('#divTankEditor').html(view);
                if (storageTankId == 0) {
                    $('#btnTankDelete').hide();
                } else {
                    $('#btnTankDelete').show();
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert('error = ' + thrownError);
                alert('xhr resp text = ' + xhr.responseText);
            }
        });
    }
</script> 
```

**StorageTank.cshtml**

```
@model kpa.mko.bll.viewmodels.clientData.StorageTankForEdit

@using kpa.mko.dal.Entities;
@using kpa.mko.bll.factories;

@using (Ajax.BeginForm("SaveStorageTank", "ClientData", new AjaxOptions { InsertionMode = InsertionMode.Replace, UpdateTargetId = "divEquipmentEdit" }))
{
    @Html.HiddenFor(st => st.TankForEdit.StorageTankID)
    <div>Tank Placement:@Html.DropDownListFor(m => m.PlacementSelected, Model.Placements)</div>
    <div>Department: @Html.DropDownListFor(m => m.DepartmentSelected, Model.Departments)</div>
    <div>Volume (gal): @Html.EditorFor(m => m.TankForEdit.VolumeInGallons)</div>
    <div>Content of Tank: @Html.DropDownListFor(m => m.StorageTankContentsSelected, Model.StorageTankContents)</div>
    <div>Secondary Containment? @Html.EditorFor(m => m.TankForEdit.HasSecondaryContainment)</div>
    <div>If so, what type: @Html.EditorFor(m => m.TankForEdit.SecondaryContainmentType)</div>
    <div>Tank Has Overfill Alarm? @Html.EditorFor(m => m.TankForEdit.HasOverfillAlarm)</div>
    <div>If so, what type: @Html.EditorFor(m => m.TankForEdit.OverfillAlarmType)</div>
    <input type="submit" value="Save Tank Data" name="submitButton" /> <input type="submit" value="Delete Tank" id="btnTankDelete" name="submitButton" /> <input type="button" value="Reset" onclick="getEditor(0); return false;" />
} 
```

**控制器保存方法**

```
public PartialViewResult SaveStorageTank(string submitButton, string accountId)
{
int acctId = int.Parse(accountId);
StorageTankForEdit stfe = new StorageTankForEdit(acctId);
if (TryUpdateModel(stfe))
{
    if (!string.IsNullOrEmpty(submitButton) && submitButton.Equals("Delete Tank"))
    {
        //Delete the tank already.
        StorageTankFactory.Delete(stfe.TankForEdit);
    }
    else
    {
        stfe.TankForEdit.DepartmentFk = int.Parse(stfe.DepartmentSelected);
        stfe.TankForEdit.Placement = (StorageTankPlacement)Enum.Parse(typeof(StorageTankPlacement), stfe.PlacementSelected);
        stfe.TankForEdit.StorageTankContentFk = int.Parse(stfe.StorageTankContentsSelected);
        //@^*#$^ NHibernate doesn't bother to get the content class upon re-display, so we don't see the content type.
        //I think it's caching this tank, so let's try populating the content here and see if it shows up.
        stfe.TankForEdit.StorageTankContent = StorageTankContentFactory.GetById(stfe.TankForEdit.StorageTankContentFk);
        StorageTankFactory.Save(stfe.TankForEdit);
    }
}

//We decided to reset to the insert state.
return LoadStorageTankDataEditor(acctId); 
```

**获取 StorageTankData 局部视图的控制器方法**

```
 public PartialViewResult LoadStorageTankDataEditor(int accountId)
    {
        StorageTankData std = new StorageTankData(accountId);

        std.StorageTanks = StorageTankFactory.GetByAccount(accountId);

        return PartialView("EditorTemplates/StorageTankData", std);
    } 
```

**获取 StorageTank 局部视图的控制器方法**

```
 public PartialViewResult LoadStorageTankEditor(int storageTankId, int accountId)
    {
        StorageTankForEdit st = new StorageTankForEdit(accountId);
        if (storageTankId > 0)
        {
            st.TankForEdit = StorageTankFactory.GetById(storageTankId);
        }
        return PartialView("EditorTemplates/StorageTank", st);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:45:25.837

我们无法弄清楚为什么由 StorageTank.cshtml 中的 Ajax.BeginForm 完成的表单发布未能替换部分视图。

我们所做的是将其切换为 Html.BeginForm，并使用旧的 jquery ajax 调用将表单发布到我们的控制器。在调用成功后，我们手动进行了替换。

函数保存（）{

```
//Substitute in the StorageTank editor to the div above.
$.ajax({
    url: '@Url.Action("SaveStorageTank")',
    type: "POST",
    data: $('#stform').serialize(),
    success: function (view) {
        $('#divEquipmentEdit').html(view);
    },
    error: function (xhr, ajaxOptions, thrownError) {
        alert('error = ' + thrownError);
        alert('xhr resp text = ' + xhr.responseText);
    }
}); 
```

}

所以，我们并没有*真正*弄清楚根本问题或为什么 Ajax.BeginForm 帖子不会替换 Chrome 和 Firefox 中的局部视图，而是让它与这种方法一起工作。

# c# - 以编程方式，此应用程序如何检测程序已准备好输入

> ID：14242249
> 
> 赞同：3
> 
> 时间：2013-01-09T16:52:17.490
> 
> 标签：c#, .net, windows

我需要构建一个小型 C# 应用程序来测量可定义应用程序的启动时间。我找到了这个免费工具：

[http://www.passmark.com/products/apptimer.htm](http://www.passmark.com/products/apptimer.htm)

这正是我需要的，但我被要求创建一个更特定于公司的内部版本，因​​为我们需要数据库日志记录和其他一些东西。

我了解如何复制除“输入空闲”之外的所有功能。我试图搜索这个词，但我没有找到任何有用的参考资料。谁能指出我检查应用程序“输入空闲”状态的正确方向？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T16:58:29.123

你可以打电话

```
WaitForInputIdle( ProcessInfo.hProcess, INFINITE ); 
```

> 等待直到指定进程完成其初始输入的处理并等待用户输入而没有等待输入，或者直到超时间隔已过。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms687022(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687022(v=vs.85).aspx)

[http://www.codeproject.com/Articles/137/Sending-a-message-to-the-Main-Frame-Window-of-Anot](http://www.codeproject.com/Articles/137/Sending-a-message-to-the-Main-Frame-Window-of-Anot)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-09T16:58:33.873

它指的是 Windows WaitForInputIdle API，当应用程序进入空闲消息循环状态时，它会回调您：

[http://blogs.msdn.com/b/oldnewthing/archive/2010/03/25/9984720.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2010/03/25/9984720.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-09T17:00:23.483

System.Diagnostics 有一个名为 Process.WaitForInputIdle() 的方法，它将检查进程是否空闲。

注意：**这仅适用于具有某种接口的程序（和消息循环）。**

[WaitForInoutIdle() 的 MSDN](http://msdn.microsoft.com/en-us/library/8d7363e2.aspx)

[检查上一个问题](https://stackoverflow.com/questions/4722198/checking-if-windows-application-is-running)以获得一个很好的示例来帮助您入门 - 您需要做的就是添加 idle 方法，并连接目标进程：

[还要检查这个](https://stackoverflow.com/questions/3785698/how-can-i-tell-if-a-process-has-a-graphical-interface)以获得一些关于如何实际检查目标应用程序是否有接口的好建议。不过，您可能不需要它，因为您可能正在使用已知的应用程序。

# jquery - RequireJS 坚持加载 jquery.js 而不是指定的 jquery-version.min.js

> ID：14242251
> 
> 赞同：0
> 
> 时间：2013-01-09T16:52:22.937
> 
> 标签：jquery, asp.net-mvc, requirejs

我正在像这样配置RequireJS：

```
require.config({
    paths: {
        jquery: 'jquery-1.8.3.min',
        knockout: 'knockout-2.2.0',
        komapping: 'knockout.mapping-latest',
        token: 'jquery.tokeninput'
    },
    shim: {
        jQuery: {
            exports: 'jQuery'
        }
    }
}); 
```

当我查看 Fiddler 的实际请求时，我发现它正在寻找 jquery.js 并且没有正常工作。如果我将文件 jquery.js 添加到我的项目中，它就可以工作。

为什么它不使用我指定的特定于版本的库？我想要特定版本的原因是因为我使用 NuGet 来管理我的包（显然是 Visual Studio .Net，这是一个 ASP.Net MVC 应用程序），并且我想避免每次 JQuery 时都需要记住复制文件更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:56:54.063

首先，jQuery 与 AMD 兼容。你不需要垫片来使用它。

接下来，`jQuery !== jquery`您应该确保您的命名是一致的，以便加载正确的路径配置。

此外，请确保`require.config`在进行任何其他调用之前运行它，因为这可能导致不需要使用您在上面配置的路径。

# git - 错误：未跟踪的工作树文件“.gitignore”将被合并覆盖

> ID：14242254
> 
> 赞同：0
> 
> 时间：2013-01-09T16:52:32.470
> 
> 标签：git, git-remote, git-untracked

我该怎么做才能解决这个“已经是最新的”错误：

我创建了一个新的本地仓库并尝试拉取远程主分支。它偶然发现了我的新 .g​​itignore 并出错了。我删除了 .gitignore （将被 repo 替换），但现在我不能拉那个分支。

```
User@BRD-09-DEC10 /c/path/to/local (master)
$ git pull stage master
user@website.com password:
remote: Counting objects: 1211, done.
remote: Compressing objects: 100% (1191/1191), done.
remote: Total 1211 (delta 81), reused 0 (delta 0)
Receiving objects: 100% (1211/1211), 83.05 MiB | 491 KiB/s, done.
Resolving deltas: 100% (81/81), done.
From ssh://website.com/path/to/repo
 * branch            master     -> FETCH_HEAD
error: Untracked working tree file '.gitignore' would be overwritten by merge.

User@BRD-09-DEC10 /c/path/to/local (master)
$ ls -al
total 5
drwxr-xr-x    4 User Administ        0 Jan  9 11:35 .
drwxr-xr-x   17 User Administ     4096 Jan  9 11:32 ..
drwxr-xr-x    7 User Administ     4096 Jan  9 11:38 .git
-rw-r--r--    1 User Administ       19 Jan  9 11:35 .gitignore
drwxr-xr-x    3 User Administ        0 Jan  9 11:35 nbproject

User@BRD-09-DEC10 /c/path/to/local (master)
$ rm .gitignore

User@BRD-09-DEC10 /c/path/to/local (master)
$ git merge stage/master
fatal: 'stage/master' does not point to a commit

User@BRD-09-DEC10 /c/path/to/local (master)
$ git pull stage master
user@website.com's password:
From ssh://website.com/path/to/repo
 * branch            master     -> FETCH_HEAD
Already up-to-date. 
```

我希望我能得到这个，因为远程分支已经存储在本地（第一次 git 花了一些时间），但如果是这样的话，那么我想我不知道如何合并那个分支。

这会定期发生 - 知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:57:19.160

拉动似乎是成功的。检查与

```
git status 
```

如果是这种情况

```
git checkout -- .gitignore 
```

应该带回文件（来自远程存储库的版本

# xquery - collection() 中的参数在 xquery 中不起作用

> ID：14242255
> 
> 赞同：0
> 
> 时间：2013-01-09T16:52:32.977
> 
> 标签：xquery

谁能告诉我为什么第一个 xquery 返回所需的结果，但第二个什么都不返回？在我看来，它们是相同的。

查询 1)

```
for $current-record-eids in collection( "EBOOK-AUTO" )
return $current-record-eids 
```

查询 2)

```
let $collection as xs:string  := "EBOOK-AUTO"
for $current-record-eids in collection( "{$collection}" )  
return $current-record-eids 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:57:07.890

您不需要在函数调用中使用[属性值模板。](http://www.w3.org/TR/xslt#attribute-value-templates)只需像普通参数一样传递值：

```
let $collection as xs:string  := "EBOOK-AUTO"
for $current-record-eids in collection($collection)  
return $current-record-eids 
```

# php - Symfony2 表单和集合 - 一个 Order、OrderItem 实现

> ID：14242259
> 
> 赞同：5
> 
> 时间：2013-01-09T16:52:56.160
> 
> 标签：php, symfony

所以我今天花了大约 5 到 6 个小时与 Symfony2 表格作斗争，现在我想从社区的其他成员那里得到一些建议。我已经尝试了超过 3 种不同的方法来实现我所追求的目标，但没有成功。我通读了文档，搜索了所有内容，询问了其他人，但我只比刚开始时好一点。

## 我的用例

我正在建立一个系统，您可以在其中订购门票。但核心问题是如何设计系统的订单部分。

*   **票**有名称，以及可用的开始和结束日期（还有其他内容，但让示例保持简单。
*   一个**订单**可能选择了多个工单，每个工单都有一个数量。
*   一个订单有一个**客户**。 *这部分很好，效果很好*！

在阅读并尝试了不同的东西之后，我收集到代表订单的票和数量，我需要另一个实体**OrderTicket**对应于来自[https://github.com/beberlei/AcmePizzaBundle](https://github.com/beberlei/AcmePizzaBundle)的 OrderItem并且比萨是我的票。

*   **OrderTicket**有一个 Ticket 和一个数量。

在创建订单的订单页面上，我想要以下内容：

*   客户**详细信息表格**- 姓名、电子邮件、地址。 *这部分工作正常*。
*   **门票**的表格。我希望在文本框甚至字符串中显示票证名称；**不在选择框中**（这就是现在正在发生的事情）。我希望在票名旁边指定**数量。**如果没有设置数量，则表示该票未被选中。
*   **应该根据今天的日期在可用的地方过滤票证**-这可以通过在具有查询构建器闭包的表单类型上使用自定义存储库方法在其他地方（在创建票证的后端管理员中）实现。

## 我的后端

Order/OrderTicket/Ticket 设计主要基于[https://github.com/beberlei/AcmePizzaBundle](https://github.com/beberlei/AcmePizzaBundle)

### 票

```
/**
 * @ORM\Entity(repositoryClass="Foo\BackendBundle\Entity\TicketsRepository")
 * @ORM\HasLifecycleCallbacks
 * @ORM\Table(name="tickets")
 */
class Tickets
{
    // id fields and others

    /**
     * @Assert\NotBlank
     * @ORM\Column(type="string", nullable=true)
     */
    protected $name;

    /**
     * @ORM\Column(type="date", name="available_from", nullable=true)
     */    
    protected $availableFrom;

    /**
     * @ORM\Column(type="date", name="available_to", nullable=true)
     */    
    protected $availableTo;
} 
```

### 订单票

```
/**
 * @ORM\Table()
 * @ORM\Entity
 */
class OrderTicket
{
    // id field

    /**
     * @ORM\Column(name="quantity", type="integer")
     */
    private $quantity;

    /**
     * @ORM\ManyToOne(targetEntity="Tickets")
     */
    protected $ticket;

    /**
     * @ORM\ManyToOne(targetEntity="Orders", inversedBy="tickets")
     */
    protected $order;

    // getters and setters for quantity, ticket and order
} 
```

### 命令

```
/**
 * @ORM\Entity
 * @ORM\HasLifecycleCallbacks
 * @ORM\Table(name="orders")
 */
class Orders
{   
    // id field and other stuff

    /**
     * @ORM\OneToMany(targetEntity="OrderTicket", mappedBy="order", cascade={"persist"})
     **/
    protected $tickets;

    /**
     * @ORM\ManyToOne(targetEntity="Customer", cascade={"persist"})
     */
    protected $customer;

    public function __construct()
    {
        $this->tickets = new \Doctrine\Common\Collections\ArrayCollection();
    }

    // getters, setters, add for Tickets and Customer
} 
```

### 顾客

```
/**
 * @ORM\Table()
 * @ORM\Entity
 */
class Customer
{
    // id, name, email, address fields

} 
```

这会创建一个这样的模式（表命名差异来自自动生成）：

```
CREATE TABLE `tickets` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `available_from` date DEFAULT NULL,
  `available_to` date DEFAULT NULL,
  PRIMARY KEY (`id`)
);
CREATE TABLE `Customer` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `email` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `address` longtext COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`)
);
CREATE TABLE `OrderTicket` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `ticket_id` int(11) DEFAULT NULL,
  `order_id` int(11) DEFAULT NULL,
  `quantity` int(11) NOT NULL,
  PRIMARY KEY (`id`)
);
CREATE TABLE `orders` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `customer_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
); 
```

### 形式

```
class CustomerType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('email')
            ->add('name')
            ->add('address')
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Foo\BackendBundle\Entity\Customer'
        ));
    }

    public function getName()
    {
        return 'foo_backendbundle_customertype';
    }
}

class OrderTicketType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('quantity', 'integer')
            ->add('ticket')
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Foo\BackendBundle\Entity\OrderTicket'
        ));
    }

    public function getName()
    {
        return 'foo_backendbundle_ordertickettype';
    }
}

class OrdersType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('customer', new CustomerType())
            ->add('tickets', 'collection', array(
                'type' => new OrderTicketType(),
                'allow_add'    => true,
                'allow_delete' => true,
                'prototype'    => true,
            ))
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Foo\BackendBundle\Entity\Orders',
        ));
    }

    public function getName()
    {
        return 'foo_backendbundle_orderstype';
    }
} 
```

### 表格

```
<form action="{{ path('index') }}" method="post" {{ form_enctype(form) }}>
    <h3>Tickets</h3>

    {{ form_errors(form) }}

    <table>
        <thead>
            <tr>
                <td>Ticket</td>
                <td>Quantity</td>
        </thead>
        <tbody>
            {% for ticketrow in form.tickets %}
            <tr>
                <td>{{ form_widget(ticketrow.ticket) }}</td>
                <td>{{ form_widget(ticketrow.quantity) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3>Customer</h3>

    {% for customer in form.customer %}
        {{ form_row(customer) }}
    {% endfor %}
</form> 
```

### 最后是控制器

```
class DefaultController extends Controller
{
    /**
     * @Route("/", name="index")
     * @Template()
     */
    public function indexAction(Request $request)
    {
        $em = $this->getDoctrine()->getManager();
        // IMPORTANT - the Tickets are prefiltered for active Tickets, these have to be injected into the Order atm. In other places I use this method on the query builder
        $tickets = $em->getRepository('FooBackendBundle:Tickets')->findActive();

        // check no tickets

        $order = new Orders();

        // To prepopulate the order with the available tickets, we have to do it like this, due to it being a collection,
        // rather than using the forms query_builder like everywhere else
        foreach($tickets as $ticket) {
            $ot = new OrderTicket();
            $ot->setTicket($ticket);
            $ot->setQuantity(0);
            $ot->setOrder($order);
            $order->addTicket($ot);
        }

        $form = $this->createForm(new OrdersType(), $order);

        if ($request->isMethod('POST')) {

            $form->bind($request);

            // IMPORTANT here I have to remove the previously added Tickets where the quantity is 0 - as they're not wanted in the Order.  Is there a better way to do this?
            // if the quantity of Ticket is 0, do not add to order
            // note we use the validation callback in Order to check total quantity of OrderTickets is > 0
            $order->removeTicketsWithNoQuantity();

            if ($form->isValid()) {

                $em->persist($order);
                $em->flush();

                return $this->redirect($this->generateUrl('order_show', array('id' => $order->getId())));
            }
        }

        return array('form' => $form->createView());
    }
} 
```

## 概括

这可以正常工作，并且可以正确保存订单，但*我不确定这是做我想做的事情的正确方法*，而且它**不会按我想要的方式显示**。

您可以在下面的图片中看到它的外观以及订单是如何通过的。值得注意的是，在每个工单下拉菜单中是剩余工单但未激活。

订单页面：

![订单1](../Images/e2b8e160b9f6b24211d46b4d56917a68.png)

保存后的订单摘要页面：

![订单2](../Images/c8bf7207fe89f623bc230f17727ab86a.png)

显示的 3 个工单是已过滤的工单，我只希望表单上有这些工单。 **我只想查看门票名称，而不是可编辑的下拉菜单**。

核心问题是它们显示为可编辑的下拉菜单。我可能只想要一个门票名称的文本字符串，或者甚至可能是未来的门票价格。我不确定如何实现这一目标。我知道必须以某种方式呈现票证字段和关系，以便可以将其绑定在控制器中。所以基本上我希望能够使用 Ticket 实体，它的字段与数量文本框位于同一行。

因此，让我们跳出 Symfony2 表单的废话并正确看待这一点——在正常的世界中，显然我只是检索门票，然后对于每张门票，我会打印门票名称，我想要的任何其他内容，a hidden Ticket id，然后是 Ticket 数量的输入。稍微回到 SF2 - 我想在循环 OrderTicket 集合时我需要可用的 Ticket 实体。

请帮我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T19:01:06.863

基于您上面的代码的最简单的解决方案是为您的 Ticket 实体创建一个自定义类型，该类型仅将当前票证显示为标签，并为其创建一个数据转换器。

```
namespace WineVision\BackendBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Doctrine\Common\Persistence\ObjectManager;
use Symfony\Component\Form\FormBuilderInterface;

use WineVision\BackendBundle\Form\Transformer\TicketToIdTransformer;

class TicketLabelType extends AbstractType
{
    private $om;

    public function __construct(ObjectManager $om)
    {
        $this->om = $om;
    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $transformer = new TicketToIdTransformer($this->om);
        $builder->addViewTransformer($transformer);
    }    

    public function getParent()
    {
        return 'hidden';
    }

    public function getName()
    {
        return 'ticket_label_type';
    }    
} 
```

然后在 Resources/Form/fields.html.twig 中创建一个小部件

```
{% block ticket_label_type_widget %}
    {% spaceless %}
    <input type="hidden" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %} />
    <span class="ticketName">{{ form.vars.data.ticketNameMethod }}</span>
    {% endspaceless %}
{% endblock %} 
```

TicketToIdTransformer：

```
namespace WineVision\BackendBundle\Form\Transformer;

use Symfony\Component\Form\DataTransformerInterface;
use Symfony\Component\Form\Exception\UnexpectedTypeException;

use Doctrine\Common\Persistence\ObjectManager;

class TicketToIdTransformer implements DataTransformerInterface
{
    private $om;

    public function __construct(ObjectManager $om)
    {
        $this->om = $om;
    }

    public function transform($ticket)
    {
        if (null === $ticket) {
            return "";
        }

        if (!$ticket instanceof \WineVision\BackendBundle\Entity\Ticket) {
            throw new UnexpectedTypeException($ticket, '\WineVision\BackendBundle\Entity\Ticket');
        }

        return $ticket->getId();
    }

    public function reverseTransform($id)
    {

        if ('' === $id || null === $id) {
            return null;
        }

        return $this->om
                    ->getRepository('WineVisionBackendBundle:Ticket')
                    ->findOneBy(array('id' => $id));

    }
} 
```

然后为您的 TicketType 创建服务，并将教义.orm.entity_manager 作为参数传递，并在您的 OrderTicketType 中使用

```
$builder->add('ticket', 'ticket_label_type'); 
```

这应该可以解决您上面给出的代码的问题。为了进一步扩展解决方案，您不应使用每种工单类型预先填充每个订单，而是创建一个自定义集合类型，使用表单事件来使用所有工单字段填充集合。

希望这可以帮助！如果这里有任何语法错误，我深表歉意。我从我的一个应用程序中复制了代码，并根据您的需要对其进行了修改。

# jquery - HTML画布jQuery移动问题

> ID：14242260
> 
> 赞同：1
> 
> 时间：2013-01-09T16:52:58.990
> 
> 标签：jquery, html, mobile, canvas, touchstart

我正在尝试使用“touchstart”移动事件和 HTML5 画布使用 jquery mobile 绘制一些东西！

我使用这个 html 代码：

```
<canvas id="canvasTouch">Canvas is not supported</canvas> 
```

和JS代码：

```
canvas = document.getElementById('canvasTouch');        
context = canvas.getContext('2d');

$(document).bind("touchstart",function(event) {    
    context.beginPath();
    context.arc(event.originalEvent.targetTouches[0].pageX,event.originalEvent.targetTouches[0].pageY, 10, 0, Math.PI*2); 
    context.fill();
    context.closePath();
} 
```

但是我的圆圈看起来像省略号并且非常模糊！

我用经典的 html 页面尝试了这段代码，它在我的设备上运行良好......

你有什么主意吗 ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T16:57:01.003

您是否将上下文的宽度和高度设置为正确的值（通常是画布元素的尺寸）？

元素和上下文之间的大小不同会破坏您可能期望的 1:1 像素映射，从而导致失真和模糊。如果您正在使用属性或脚本更改元素大小，这尤其重要（我不记得了，我不记得它何时自动更改上下文大小）。

# facebook - Facebook：如何使用自定义“动词”发布/发布到墙上？

> ID：14242272
> 
> 赞同：1
> 
> 时间：2013-01-09T16:53:27.987
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

**首先，让我们看看我想做什么。**

这是我想要的截图。-->![](../Images/34420013e9f2439111d441e960e279f0.png)

根据屏幕截图，我想制作这种自定义墙贴，显示自定义动词，如“签到”、“观看”、“收听”等。

此外，我想自定义内容和消息的样式，例如“30 个人在 myApp 上观看了 xxx”。

另一件事是在底部制作除了 Like 链接之外的应用程序图标。

* * *

**说说我现在的技能吧。**

目前，我已经自学了 Graph API 和 Open Graph。我可以创建一个应用程序发布到墙上，并能够使用 opengraph 发布操作。

但！Graph API 和 OpenGraph（我用过）从来没有像截图那样产生过这种帖子。我已经尝试过 OpenGraph，但它只是继续在活动源上发布操作，*而不是在墙上*。

**我的问题是……** 图形 API 或 OpenGraph 可以制作这种墙贴吗？

如果是，我应该如何修改 API 的请求？

如果没有，我必须学习哪个 API 才能制作这种墙贴？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-13T01:11:32.013

仅对于查看此问题的其他人，您需要将显式共享设置为 true

```
"fb:explicitly_shared=true" 
```

[在此处](https://developers.facebook.com/docs/opengraph/guides/explicit-sharing/)查看文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:59:16.380

这都是关于[Open Graph](https://developers.facebook.com/docs/concepts/opengraph/)的。你所说的*动词*实际上是[动作](https://developers.facebook.com/docs/concepts/opengraph/actions/)。您要发布的帖子类型是已**发布的操作**。

这是一个[如何开始使用 Open Graph](http://vimeo.com/29464909)视频。您也可以按照[本教程](https://developers.facebook.com/docs/technical-guides/opengraph/opengraph-tutorial/)进行操作。这里是[如何发布一个动作](https://developers.facebook.com/docs/technical-guides/opengraph/publish-action/)。

最后但并非最不重要的一点是，您会在这里找到[大量](https://developers.facebook.com/docs/technical-guides/opengraph/)使用 Open Graph 做好事的技术指南。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:16:48.917

Facebook 允许您向帖子添加一个自定义操作。这是一个例子：

```
$attachment = array
 (
 'access_token'=>$facebook->getAccessToken(),
 'message' => 'I\'ve been testing my IQ!',
 'name' => 'IC-YOUR-IQ',
 'caption' => 'This is my result:',
 'link' => 'http://apps.facebook.com/icyouriq/',
 'actions' => array('name'=>'Sweet FA','link'=>'http://www.facebookanswers.co.uk'),
 'description' => $cmsg,
 'picture' => 'http://www.facebookanswers.co.uk/img/misc/iq.jpg'
 ); 
```

关键字段是“操作”字段。这需要一个由两个元素组成的数组；“名称”和“链接”。

您可能很想尝试向该数组添加更多元素，但这不起作用。您只能有一个自定义操作。

我在这里写了博客，如果您想了解更多信息：http: [//facebookanswers.co.uk/?p=270](http://facebookanswers.co.uk/?p=270)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:15:42.483

这是我用来发布到墙上的代码

```
if (isset($_GET['publish'])){
        try {
            //$publishStream = $facebook->api("/$user/feed", 'post', array(
            $publishStream = $facebook->api("/me/feed", 'post', array(
                'message' => "I love thinkdiff.net for facebook app development tutorials. :)", 
                'link'    => 'http://ithinkdiff.net',
                'picture' => 'http://thinkdiff.net/ithinkdiff.png',
                'name'    => 'iOS Apps & Games',
                'caption' => 'This is my result:',
                'actions' => array('name'=>'Sweet FA','link'=>'http://www.facebookanswers.co.uk'),
                'description'=> 'Checkout iOS apps and games from iThinkdiff.net. I found some of them are just awesome!'
                )
            );
            //as $_GET['publish'] is set so remove it by redirecting user to the base url 
        } catch (FacebookApiException $e) {
            d($e);
        }
        //$redirectUrl     = $fbconfig['baseurl'] . '/index.php?success=1';
        $redirectUrl     = $fbconfig['baseurl'] . '?success=1';
        header("Location: $redirectUrl");
    } 
```

# css - 将背景容器调整为页面高度而不是屏幕高度。

> ID：14242273
> 
> 赞同：3
> 
> 时间：2013-01-09T16:53:31.177
> 
> 标签：css, background, containers

我的问题是我的背景容器只显示到屏幕底部。在那之后的部分我看不到它。我几乎尝试了一切，但似乎没有什么对我有用。我希望它根据页面大小进行调整。

```
<body>
<div id="profilebg">

<!-- Other divs -->

</div>
</body> 
```

我的 CSS 是

```
html, body {
    height:100%;
}

#profilebg
{
    position: absolute;
    margin-left:10%;
    margin-right:10%;
    width:80%;
    background-color:#ffffff;
    height: 100%;
    top: 0;
    bottom: 0;
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:07:30.370

如果您不指定高度，则默认为“自动”，由内容的高度决定。

如果您在内容中浮动某些内容，请务必添加一个具有 ccs 样式的元素，`clear:both`以便父级可以正确确定它的高度。

同样，如果元素的任何子元素使用绝对定位，它将无法自动确定其高度，因为绝对定位的子元素不再与父元素在同一范围内。

一个示例工作方式是：

```
html, body {
  height:100%;
}

#profilebg
{
    margin: 0 10%;
    background-color:#ffffff;
} 
```

**编辑：**更简洁的 CSS 样式 - 宽度与边距是多余的

**编辑2：**添加关于绝对定位的行

**编辑 3：**在以下评论中实现请求的 Div 结构：

```
<div id="page-container">
    <div id="header-container">
        <!-- Put your header here -->
    </div>
    <div id="body-container">
        <div id="profilebg">
            <!-- Profile BG Container -->
        </div>
        <!-- Any other body content here -->
    </div>
    <div id="footer-container">
        <!-- Footer content here -->
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T16:57:28.707

以下似乎适用于您想要实现的目标。我已删除`bottom:0;`并更改`height`为`min-height`.

```
html, body {   
    height:100%; 
}

#profilebg {
    position: absolute;
    margin-left:10%;
    margin-right:10%;
    width:80%;   
    min-height:100%;
    background-color:#ffffff;
    top: 0;
    display: block;   
} 
```

**编辑**这是一个[小提琴](http://jsfiddle.net/eXaYS/)

**编辑 2**这是一个相对定位的[小提琴。](http://jsfiddle.net/eXaYS/2/)

# python - 是否可以更改 wx.ListBox 中项目的背景颜色？

> ID：14242275
> 
> 赞同：3
> 
> 时间：2013-01-09T16:53:33.847
> 
> 标签：python, wxpython

我想在我的列表框中交替使用背景颜色，以便更容易阅读。像这样的东西：

![在此处输入图像描述](../Images/1a03c0a9d2064c53a58e3e9f92d1daa8.png)

但是，我不知道该怎么做。从文档中，我看到 wx.listbox 有一个名为 的方法`SetItemBackgroundColor(self, item, colour)`，但我不确定（a）item 参数是否是某种索引或 wx.ID，或者（b）该方法是否实际适用到`listbox`（也许是为了继承树中更高的东西？）

我尝试将索引以及颜色传递给该方法，但它没有做任何事情。所以我不确定它是否不起作用，因为我传入了错误类型的标识符，或者它是否不起作用，因为该方法不适用于对象。

如果它*是*我应该为`item`参数传递的 wx.ID，如何获取列表框实例的此类信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:03:30.110

无法使用 设置背景颜色`ListBox`。 `ListCtrl`虽然可以做到这一点。

一般来说，`ListBox`适用于小型简单列表（因此快速而简单），并`ListCtrl`提供更大的灵活性（但也涉及更多）。

有关如何制作条纹背景的示例，请参阅下的演示`CoreWindows\ListCtrl_virtual`。

**更新**[wx 文档](http://docs.wxwidgets.org/2.8.9/wx_wxlistbox.html)（没有 SetItemBackgroundColor 方法）和[wxpython 文档](http://wxpython.org/docs/api/wx.ListBox-class.html)（有）之间的区别：
似乎当可以使用本机 API 时，以及当它支持 wx 库之外的某些功能时，访问有时会将其添加到包装器中。也就是说，SetItemBackgroundColor 的使用取决于平台，基于本机 API。请参阅[此线程](http://wxpython-users.1045709.n5.nabble.com/checklistbox-SetItemBackgroundColour-doesn-t-work-under-linux-ubuntu-td4141429.html)进行一些讨论（特别是 Robin Dunn 的条目）。当它在本机平台上不可用时，[该命令被忽略](http://wxpython-users.1045709.n5.nabble.com/SetItemBackgroundColour-td2360079.html)。

# android - 在 Android 中使用 SQLite 数据库条目填充 GridView

> ID：14242277
> 
> 赞同：0
> 
> 时间：2013-01-09T16:53:35.747
> 
> 标签：android, android-sqlite, android-gridview, android-cursor

我想用我的 SQLite 数据库中的条目填充我的 Gridview，但它不起作用。

在我的主要活动中，我为 gridview 设置了一个适配器：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.room_layout);

    gridview = (GridView) findViewById(R.id.gridview);
    gridview.setAdapter(new RoomImageAdapter(this));
    Button addRoom = (Button) findViewById(R.id.addRoom);
    //OnClickListener for room button
    addRoom.setOnClickListener(new Button.OnClickListener() {            
        public void onClick(View view) {  
          addDeviceOrRoom();
        }  
    });
} 
```

RoomImageAdapter 类如下所示：

```
 public class RoomImageAdapter extends BaseAdapter {
        private Context mContext;
        private static SQLiteDatabaseAdapter dbHelper;
        private static int i=0;

        public RoomImageAdapter(Context c) {
            mContext= c;
        }

        @Override
        public int getCount() {
            // defines how many items in the gridview are shown
            return 7;
        }

        @Override
        public Object getItem(int position) {
            return null;
        }

        @Override
        public long getItemId(int position) {
            return 0;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View v;
            readDatabase();
            if(convertView==null){
                LayoutInflater li = LayoutInflater.from(mContext);
                v = li.inflate(R.layout.imageandtextforgrid, null);
                TextView tv = (TextView)v.findViewById(R.id.icon_text);
                tv.setText("Raum: "+position);
                ImageView iv = (ImageView)v.findViewById(R.id.icon_image);
                iv.setImageResource(R.drawable.livingroom);
            }
            else
            {
            v = convertView;
            }
            return v;
        }

        public void readDatabase(){ 
            Log.d("DB", "Start DB read");
            String name;
            dbHelper = new SQLiteDatabaseAdapter(mContext);
            dbHelper.open();

            Cursor cursor = dbHelper.getRoomName();
            cursor.moveToFirst();
            if(! cursor.isAfterLast()) {
                do {
                    name= cursor.getString(1);
                    Log.d("DB", "RoomName is: "+name);
                } while (cursor.moveToNext());
           }
           cursor.close();
           dbHelper.close();
           Log.d("DB", "Stop DB read");
        }
    } 
```

我的 SQLite 数据库中的代码是：

```
/**
  * GetRoomName
  */
 public Cursor getRoomName() {

      Cursor mCursor = mDb.query(SQLITE_TABLE, new String[] {KEY_ROWID,
        null, null, null, null, null, null}, 
        null, null, null, null, KEY_ROOMNAME);

      if (mCursor != null) {
       mCursor.moveToFirst();
      }
      return mCursor;
     } 
```

但是`name= cursor.getString(1);`RoomImageAdapter 内的行永远不会执行，并且光标似乎为空。任何人的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:47:40.197

因为您还没有在适配器中添加任何项目。

另外，请不要在 getView() 中调用 readDatabase()，它会导致加载非常慢。在 readDatabase() 中，您可以将项目添加到您的适配器中，然后通知适配器。

# jquery - 为什么在我的脑海中添加脚本标签会弄乱工作代码？

> ID：14242280
> 
> 赞同：0
> 
> 时间：2013-01-09T16:53:39.120
> 
> 标签：jquery, jquery-mobile, google-api

以下代码工作正常：

```
$('#transPage, #categorizePage, #IDKPage').live('pageinit', function() {
$('.theListItem .red').click(function() {
    var $changeColor = $(this).closest('div[data-theme="a"]').css("background-color", "#ff3333");
    });

$('.theListItem .green').click(function() {
    var $changeColor = $(this).closest('div[data-theme="a"]').css("background-color", "#008021");
    });

}); 
```

这也很好用：

```
$('#transPage, #categorizePage, #IDKPage').live('pageinit', function() {
    $('.trans .theListItem .red').click(function() {
        var $toRemove = $(this).closest('div[data-theme="a"]')

        $toRemove.animate({
            height: 0
        }, 500, function() {
            // This is the callback.
            $toRemove.remove();
        });

        return false;
    });
}); 
```

直到我取消注释：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script> 
```

然后它不再起作用。问题是我需要这些脚本才能让其他东西工作。有什么想法可能是错的吗？谢谢。

为了进一步说明我的问题，以下是我现在发布在页面底部的整个工作头：

```
<script src="js/jQuery/jquery-1.8.2.min.js"></script>

<!--script src="http://code.jquery.com/mobile/1.2.0-rc.2/jquery.mobile-1.2.0-rc.2.min.js"></script>-->
<script src="jquery.mobile-1.2.0-rc.2/jquery.mobile-1.2.0-rc.2.min.js"></script>
<!--<script src="jquery.mobile-1.2.0-rc.2/jquery.mobile-1.2.0-rc.2.min.css"></script>-->

<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>   
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>  -->

<script type="text/javascript" src="cubiq-iscroll-bad88fb/src/iscroll.js"></script>    

<script src="swipe/dist/jquery.swipeButton-1.2.1.js"></script>

<script src="js/scrollbar.js"></script>
<script src="js/script.js"></script>

<link rel="stylesheet" href="css/jQueryMobileStructure.css" />
<link rel="stylesheet" href="css/style.css" /> 
<link rel="stylesheet" href="css/nikostyle.css" /> 

<link href='http://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:56:38.267

如果这些脚本在您将这些东西添加到您的脑海之前已经开始工作，我认为这意味着您已经在之前的某个地方或其他地方引用了 jQuery 脚本。如果我们看到更多代码可能会有所帮助，但我认为情况就是这样。

# winapi - windows系统字体规格有哪些

> ID：14242281
> 
> 赞同：2
> 
> 时间：2013-01-09T16:53:47.477
> 
> 标签：winapi, fonts

我目前正在尝试根据当前字体重新调整应用程序的字体大小，为此，我将使用`WM_GETFONT`字体的宽度和高度来获取字体并使用等式重新调整其大小对于输入，问题是它的返回值是系统字体，我不知道该字体的规格。

谁能告诉我如何获取系统字体的规格？操作系统之间的系统字体是否不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:04:01.580

您可以使用以下代码检索[`LOGFONT`结构：](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145037.aspx "LOGFONT 结构")`HFONT`

```
LOGFONT lf = { 0 };
::GetObject( hFont, sizeof( lf ), &lf ); 
```

有了它，您就拥有了所需的所有信息，并且可以只更改您想要的部分。要获得`HFONT`回报，您将使用[`CreateFontIndirect`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183500.aspx "CreateFontIndirect 函数")：

```
HFONT hFontCustom = ::CreateFontIndirect( &lf ); 
```

除了使用之外`WM_GETFONT`，您还可以考虑使用[`SystemParametersInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724947.aspx "SystemParametersInfo 函数")来检索已经具有可以复制、修改和使用的[`NONCLIENTMETRICS`结构](http://msdn.microsoft.com/en-us/library/windows/desktop/ff729175.aspx "NONCLIENTMETRICS 结构")的结构，如上图所示。`LOGFONT`[`CreateFontIndirect`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183500.aspx "CreateFontIndirect 函数")

至于您的第二个问题，字体设置是每个用户的设置，因此即使在同一个安装中，两个不同的用户登录，它也可能不同。

# php - 在打字稿的 xslt 查询中使用参数/标记

> ID：14242283
> 
> 赞同：0
> 
> 时间：2013-01-09T16:53:50.960
> 
> 标签：php, xslt, typo3, typoscript

首先，我从来不需要对 Typo3 做任何事情。所以打字稿对我来说是一个**真正的**惊喜。

我已经完成了这个脚本，我所要做的就是让它变得更加可变，所以**@id=**部分应该用来自 URL 的参数填充。

```
plugin.xml_xpath_detail < plugin.xml_xpath
plugin.xml_xpath_detail.conf.renderObj > 

plugin.xml_xpath_detail.conf {
  xpath.path   = /interface/items/item[@id=123456]
  xpath.limit  = 1

  renderObj >
  renderObj = COA
  renderObj.wrap = <div style="padding:20px">|</div>
  renderObj {

     20 = TEXT
     20.data = ###COMP_ID###
     20.wrap = <p style="padding:10px; background-color:lime;">|</p>
     20.required = 1
     20.stripHtml = 0
  }
} 
```

我知道如何获取参数，所以如果我需要这种方式，我也可以在标记中使用 id

```
COMP_ID.cObject = TEXT
COMP_ID.cObject.value = GP:job 
```

我可以随时输出参数，就像标记一样。但我不知道如何修改 xpath.path 来识别标记/参数。我尝试了所有我能想到的

```
 xpath.path   = /interface/items/item[@id=GP:job]
  xpath.path   = /interface/items/item[@id={GP:job}]
  xpath.path   = /interface/items/item[@id={GP::job}]
  xpath.path   = /interface/items/item[@id=###COMP_ID###]
  xpath.path   = /interface/items/item[@id='###COMP_ID###']
  xpath.path   = /interface/items/item[@id={###COMP_ID###}]
  ... 
```

我得到的只是一个未替换的已定义占位符的视图。

也许这里的任何人都可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T06:43:03.880

我从来没有使用过 xml_xpath，但是阅读了[http://typo3.org/extension-manuals/xml_xpath/1.3.8/view/1/4/](http://typo3.org/extension-manuals/xml_xpath/1.3.8/view/1/4/)上的文档，这个例子应该可以工作，因为它统计*xpath*可以是*String/typoscript*类型：

```
plugin.xml_xpath_detail.conf {
  xpath.path = TEXT
  xpath.path.data = GP:job
  xpath.path.data.intval = 1
  xpath.path.wrap = /interface/items/item[@id=|]
  xpath.limit  = 1
} 
```

**编辑：**添加了 pgame 指出的 intval 。这真的是必须的！

# android - Android布局权重没有任何作用

> ID：14242284
> 
> 赞同：0
> 
> 时间：2013-01-09T16:53:51.607
> 
> 标签：android, android-layout, android-layout-weight

我有一个带有 2 个按钮的 LinearLayout 水平分割它。

我希望这些按钮位于屏幕底部，所以我添加到布局中 `android:layout_weight="bottom"`并且没有任何变化！

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:background="@drawable/background"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:weightSum="2" >

        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Start" />

        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Stop" />
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:55:30.313

您需要将`layout_width`按钮的 设置为`0dp`。

此外，没有宽度属性：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/background"
android:orientation="vertical" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:weightSum="2"
android:layout_alignParentBottom="true" >

    <Button
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Start" />

    <Button
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Stop" />
</LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:09:59.833

layout_weight 用于在考虑 layout_width 或 layout_height*后划分剩余空间。*

当你说

```
<Button
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="0.5"
    android:text="Start"
    android:width="0dp" /> 
```

表示将`android:layout_width="fill_parent"`按钮的大小设置为与其父级一样宽。对水平线性布局中的两个按钮这样做会导致只有一个可见按钮；第二个实际上位于第一个的右侧，但在屏幕外。

如果您将两个按钮设置为`layout_width`to `0dp`，则两个按钮将具有相同的宽度。

如果在两个按钮上都设置为`layout_width`to ，则两个按钮都将从它们的“首选”宽度开始，然后根据它们与父布局中所有视图的总和的`wrap_content`比率为它们分配额外的空间。`layout_width``layout_width`

如果您想要底部的按钮，您可以将布局更改为相对布局（并`alignParentBottom`按照其他答案中所述使用），或者嵌套在垂直线性布局中（水平布局将具有`layout_height='wrap_content'`and `layout_width='fill_parent'`）。

因为你提到了嵌套，你可以使用类似的东西

```
<LinearLayout
    andrdoid:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    ...
    >
        <LinearLayout
            anddoid:orientation="horizontal"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            ...
            >
                <Button
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    ... />
                <Button
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    ... />
        </LinearLayout>
</LinearLayout> 
```

（或使用`wrap_content`按钮`layout_width`以文本宽度启动它们）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:07:03.200

将按钮上的 layout_width 参数更改为

```
android:layout_width="0dp" 
```

您也可以使用 layout_alignParentBottom

```
android:layout_alignParentBottom="true" 
```

您可以创建布局文件，如下所示

```
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="wrap_content">

  <!-- Other Components of your layout file -->
  <LinearLayout
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:layout_gravity="bottom"
  android:layout_alignParentBottom="true"
  android:orientation="horizontal"
  android:weightSum="2">
    <Button
      android:layout_width="0dp"
      android:layout_height="wrap_content"
      android:layout_weight="1"
      android:text="Start"/>

    <Button
      android:layout_width="0dp"
      android:layout_height="wrap_content"
      android:layout_weight="1"
      android:text="Stop"/>
  </LinearLayout>
</RelativeLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:16:11.057

你的标题说 layout_weight 不适合你，但问题正文暗示它工作得很好。该`layout_weight`属性应该使您的按钮占据每个按钮的一半宽度。

屏幕底部的定位是一个不同的问题。根据您最近编辑的 xml，添加`android:gravity="bottom"`到 parent`LinearLayout`或`android:layout_gravity="bottom"`child `LinearLayout`。

# wordpress - 从新的 Wordpress 媒体管理器的附件详细信息中删除字段

> ID：14242289
> 
> 赞同：5
> 
> 时间：2013-01-09T16:54:10.097
> 
> 标签：wordpress

新的媒体管理器看起来很棒，非常好，但是，与以前的版本一样，它在附件详细信息中有一些我想避免的字段，我曾经使用此代码：

```
add_filter('attachment_fields_to_edit', 'remove_media_upload_fields', 10000, 2);
function remove_media_upload_fields( $form_fields, $post ) {

    unset( $form_fields['image_alt'] );
    unset( $form_fields['post_content'] );
    unset( $form_fields['post_excerpt'] );
    unset( $form_fields['url'] );
    unset( $form_fields['image_url'] );
    unset( $form_fields['align'] );
    unset( $form_fields['image-size'] );

    return $form_fields;
} 
```

但似乎它在新版本中不起作用。

如何在新媒体管理器中删除这些字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:25:49.727

我也遇到了这个问题。有一些解决方法，但我发现以下方法效果最好......当您从编辑器页面（元框链接）单击“添加特色图片”时，“插入帖子”的选项以及您提到的所有选项媒体管理器中缺少。这对我来说是完美的，因为我想删除用户将图像插入帖子的选项。如果这是您所追求的，请将此代码放入主题的 functions.php 文件中...

```
/**
* Add if you want to remove image edit option from Media Manager.
*/
add_action( 'admin_footer-post-new.php', 'wpse_76214_script' );
add_action( 'admin_footer-post.php', 'wpse_76214_script' );
function wpse_76214_script() {
?>
<script type="text/javascript">
jQuery(document).ready( function($) {
    $( 'li.attachment' ).live( 'click', function( event ) {
        $( '.media-sidebar a.edit-attachment' ).remove(); // remove edit image link
    });
} );
</script>
<?php
}

/**
* Removes "Add Media" Button from the editor.
*/
function z_remove_media_controls() {
remove_action( 'media_buttons', 'media_buttons' );
}
add_action('admin_head','z_remove_media_controls');

/**
* Takes over the "Featured Image" meta box and allows you to change its options.
*/
add_action('do_meta_boxes', 'change_image_box');
function change_image_box()
{
remove_meta_box( 'postimagediv', 'post', 'side' );
remove_meta_box( 'postimagediv', 'page', 'side' );
// if you have other post types, remove the meta box from them as well
// remove_meta_box( 'postimagediv', 'your-post-type', 'side' );
add_meta_box('postimagediv', __('Add Images'), 'post_thumbnail_meta_box', 'post', 'side' );
add_meta_box('postimagediv', __('Add Images'), 'post_thumbnail_meta_box', 'page', 'side' );
}

/**
* Renames Feature Image Link that appears inside meta box.
*/
add_action('admin_head-post-new.php',change_thumbnail_html);
add_action('admin_head-post.php',change_thumbnail_html);
function change_thumbnail_html( $content ) {
  add_filter('admin_post_thumbnail_html',do_thumb);
}
function do_thumb($content){
 return str_replace(__('Set featured image'), __('Add Images and Set Featured'),$content);
} 
```

用户现在只能通过单击元框中的链接来添加图像，该链接现在被命名为“添加图像”。此外，元框内的链接已更改以避免混淆。希望这可以帮助！

# excel - Excel VBA：如何检查计算列？

> ID：14242292
> 
> 赞同：4
> 
> 时间：2013-01-09T16:54:13.517
> 
> 标签：excel, calculated-columns, listobject, vba

如果 Excel 中表的特定列（ListObject）是计算列（如[http://office.microsoft.com/en-us/excel-help/use-calculated-columns-在-an-excel-table-HA010342380.aspx 中](http://office.microsoft.com/en-us/excel-help/use-calculated-columns-in-an-excel-table-HA010342380.aspx)）？

请注意，计算列不仅会为每一行设置相同的 R1C1 公式，而且还会在添加新行时自动扩展（如果您删除整个数据主体范围然后重新创建一些新行，它甚至会重新填充）。因此，检查具有一致公式的列与检查计算公式不同。

甚至可以计算一列，但是用其他公式或值覆盖其中一行，并保持自动扩展功能。

所以我非常确信这必须是列的某些属性，我只是不确定我可以在哪里通过 VBA 访问它。如果它没有通过 VBA 对象模型公开，是否有一些解决方法来获取此信息？

提前致谢， 卡洛斯

编辑：我对 Excel Office Open XML 文件进行了一些挖掘，结果发现我正在寻找的是xl\tables\table*.xml 文件定义中的`<calculatedColumnFormula>`元素。`<tableColumn>`有什么方法可以通过 VBA 实现吗？

EDIT2：这是一个[示例文件](http://dl.dropbox.com/u/68744475/calculated%20column%20examples.xlsx)，其中包含我可以提出的测试用例。VBA 应该表示第 1、2 和 3 列是计算列，而第 4 和 5 列不是。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:43:28.017

以前没有看过这个，但它似乎是 ListObject 的列范围的一个属性，如下所示：

```
Dim wks As Worksheet
Set wks = ActiveSheet
Dim li As ListObject
Set li = wks.ListObjects(1)
Dim col As ListColumn
Set col = li.ListColumns(2)    ' assuming column 2 of the table has a calculated formula
Dim r As Range
Set r = col.DataBodyRange
Let b = Not IsNull(r.FormulaArray)
if b then
    Let b = Len(r.FormulaArray) > 0 ' case where r.FormulaArray = "", suspect it's not a calculated column
End If
MsgBox b 
```

如果 IsNull(r.FormulaArray) 则它没有计算列，否则它有。

hth

* * *

好的，玩了一下，我看到使用上面获得的范围对象与任何给定单元格的范围对象不同，所以如果你有一个给定的单元格，我认为你需要获取相应的 ListColumn 的范围通过 .DataBodyRange。

（例如，如果您插入`Set r = r.Cells(1,1)`上述内容，则`IsNull(r.FormulaArray)`测试不再适用于测试计算列，而只是说明该范围是否有公式，但可以计算或不计算。）

此外，虽然 r.FormulaArray 在计算列时似乎是一个字符串，但如果不是（计算列），则 .FormulaArray 产生 null，这不是有效的字符串值（使其难以在要捕获您必须使用变体而不是布尔值的值）；我发现 IsNull(r.FormulaArray) 似乎工作正常。

* * *

如果我在已计算的列的右侧添加一列，则 r.FormulaArray = "" 为该新添加的列。如果您将一个值放入其中一个单元格，则公式数组会立即恢复为更预期的 NULL。所以，我添加了一个测试，我认为这是误报。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T18:02:42.113

这为您的示例提供了适当的答案。

不幸的是，它有一些潜在的致命缺点，这取决于一个人的情况。一方面，它会导致重新计算，因此通过`=RAND()`样本中的公式生成的随机数会发生变化。

第二个缺点是它修改工作表以获得答案（它删除了它所做的修改，但它仍然被修改）。我可以想到一些仅部分有用的解决方法：（a）根据需要很少执行此操作并缓存所有列的结果，以及（b）将表复制到新工作簿并运行例程（并删除新工作簿） . 虽然后者可以避免修改缺陷，但它仍然会触发对原始工作簿的重新计算（否则有其自身的缺陷）。除此之外，将表格复制到新工作簿会丢失表格/列表对象，除非您复制整个范围（不仅仅是标题）；那么它似乎也将第 4 列（非计算一致的公式）提升为计算的列。可悲的是，复制整张纸时也会发生这种促销活动。

好吧，FWIW：

```
Sub TestTable()
    Dim ans As String
    Let ans = ""

    Dim li As ListObject
    Set li = ActiveSheet.ListObjects(1)

    Dim rowCountBefore As Long
    Let rowCountBefore = li.ListRows.Count

    Dim lr As ListRow
    Set lr = Nothing

    On Error Resume Next
    Set lr = li.ListRows.Add(AlwaysInsert:=True)
    On Error GoTo 0

    Dim rowCountAfter As Long
    Let rowCountAfter = li.ListRows.Count

    If Not (lr Is Nothing) And rowCountAfter = rowCountBefore + 1 Then
        Dim c As Long
        For c = 1 To li.DataBodyRange.Columns.Count
            Dim b As Boolean
            Let b = lr.Range.Cells(1, c).HasFormula
            ans = ans & "col " & c & ": " & b & ";  "
        Next
        li.ListRows(rowCountAfter).Delete
    End If

    MsgBox ans
End Sub 
```

# java - 如果 h:form 具有 enctype="multipart/form-data"，则 h:commandButton 不会触发操作

> ID：14242293
> 
> 赞同：2
> 
> 时间：2013-01-09T16:54:21.160
> 
> 标签：java, jsf, file-upload, jsf-1.2, apache-commons-fileupload

**JSF：** 1.2

**服务器：** WebLogic

我正在尝试实现多个文件上传。因为我需要支持 IE7，所以我不能使用 HTML5 输入文件。所以我计划添加一个按钮，点击它会在页面中添加一个输入文件。

我首先开始使用 ADF Faces。但这没有用。那是在以意想不到的方式表现。

我也尝试过 Tomahawk 的文件上传组件，但问题在于该组件在从后端添加新文件上传后，之前创建的文件上传字段为空；不是`UploadedFile`实例。但这不符合我的要求。因为我需要显示文件上传器中的所有路径，直到单击最终的提交表单按钮。

然后我求助于 apache commons fileupload。

我已经用纯 JSP 和 apaches 文件上传试过这个，效果很好。

但是我想用带有 apaches fileupload 的 JSF 来实现它，当我尝试这样做时，它开始引起问题。

jspx页面如下：

```
<?xml version='1.0' encoding='utf-8'?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.1"
          xmlns:f="http://java.sun.com/jsf/core"
          xmlns:h="http://java.sun.com/jsf/html">
  <jsp:output omit-xml-declaration="true" doctype-root-element="HTML"
              doctype-system="http://www.w3.org/TR/html4/loose.dtd"
              doctype-public="-//W3C//DTD HTML 4.01 Transitional//EN"/>
  <jsp:directive.page contentType="text/html;charset=utf-8"/>
  <f:view>
    <html>
      <head>
        <meta http-equiv="Content-Type"
              content="text/html; charset=utf-8"/>
        <title>home</title>
      </head>
      <body>
        <h:form enctype="multipart/form-data">
            <input type="file" name="file"/>
            <h:commandButton value="Upload" action="#{uploadBean.upload}" />
        </h:form>
      </body>
    </html>
  </f:view>
</jsp:root> 
```

我创建了一个过滤器，因为我无法从`action`事件中获得正确的多部分请求。

web.xml 是：

```
<?xml version = '1.0' encoding = 'windows-1252'?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         version="2.5" xmlns="http://java.sun.com/xml/ns/javaee">
  <context-param>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>server</param-value>
  </context-param>
  <filter>
    <filter-name>UploadFilter</filter-name>
    <filter-class>com.edfx.massupload.filter.UploadFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>UploadFilter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
  </filter-mapping>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
  </servlet-mapping>
  <welcome-file-list>
    <welcome-file>/home.jspx</welcome-file>
  </welcome-file-list>
</web-app> 
```

上传过滤器：

```
import java.io.IOException;

import java.util.ArrayList;
import java.util.List;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.FileUploadException;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;

public class UploadFilter implements Filter {
    private FilterConfig _filterConfig = null;

    public void init(FilterConfig filterConfig) throws ServletException {
        _filterConfig = filterConfig;
    }

    public void destroy() {
        _filterConfig = null;
    }

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        System.out.println("Filter");
        if (!(request instanceof HttpServletRequest)) {
            chain.doFilter(request, response);
            return;
        }

        HttpServletRequest httpRequest = (HttpServletRequest)request;

        boolean isMultipartContent = ServletFileUpload.isMultipartContent(httpRequest);

        if (!isMultipartContent) {
            chain.doFilter(request, response);
            return;
        }

        long maxFileSize = (1024 * 1024 * 1024);
        DiskFileItemFactory factory = new DiskFileItemFactory();
        ServletFileUpload upload = new ServletFileUpload(factory);
        upload.setHeaderEncoding("UTF-8");
        upload.setSizeMax(maxFileSize);
        upload.setFileSizeMax(maxFileSize);

        try {
            List<FileItem> items = upload.parseRequest(httpRequest);
            System.out.println(items.size());
            List<FileItem> files = new ArrayList<FileItem>();            
            for (FileItem item : items) {
                if (!item.isFormField()) {
                    files.add(item);
                }
            }

            httpRequest.setAttribute("files", files);
        } catch (FileUploadException ex) {
            ex.printStackTrace();
        }        

        chain.doFilter(request, response);
    }
} 
```

最后是托管bean：

```
import javax.faces.context.FacesContext;

import javax.servlet.http.HttpServletRequest;

public class UploadBean {
    public UploadBean() {
        super();
    }

    public String upload() {
        System.out.println("====JYM");
        HttpServletRequest httpRequest = (HttpServletRequest)FacesContext.getCurrentInstance().getExternalContext().getRequest();
        System.out.println(httpRequest.getAttribute("files"));
        return "";
    }
} 
```

我的目标是通过 JavaScript 或 jQuery 动态添加输入文件字段，这在 JSP 中运行良好，我想在 JSF 中得到它。

如果我`enctype="multipart/form-data"`从 中删除，`h:form`则操作方法正在执行，否则不会。

任何建议都会对我很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:04:20.067

这里，

```
for (FileItem item : items) {
    if (!item.isFormField()) {
        files.add(item);
    }
} 
```

您忽略了所有表单字段，例如按钮本身。当继续这样的请求时，JSF 将不知道按钮已被调用，因此根本不会排队任何操作。

您需要添加一个`else`来收集 a 中的所有表单字段，并使用在所有调用中委托给该映射的 a`Map<String, String[]>`包装请求，最后使用包装的请求继续过滤器链。这样，JSF 将发现按钮被调用，然后排队等待正确的操作。`HttpServletRequestWrapper``getParameterXxx()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T21:56:36.110

正如@BalusC 指示的那样：

```
import java.io.IOException;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Enumeration;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;

public class UploadFilter implements Filter {
    private FilterConfig filterConfig = null;

    public void init(FilterConfig filterConfig) throws ServletException {
        this.filterConfig = filterConfig;
    }

    public void destroy() {
        this.filterConfig = null;
    }

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        if (!(request instanceof HttpServletRequest)) {
            chain.doFilter(request, response);
            return;
        }

        HttpServletRequest httpRequest = (HttpServletRequest)request;

        boolean isMultipartContent = ServletFileUpload.isMultipartContent(httpRequest);

        if (!isMultipartContent) {
            chain.doFilter(request, response);
            return;
        }        

        try {
            DiskFileItemFactory factory = new DiskFileItemFactory();
            ServletFileUpload upload = new ServletFileUpload(factory);
            upload.setHeaderEncoding("UTF-8");
            upload.setSizeMax(-1);

            List<FileItem> items = upload.parseRequest(httpRequest);
            final Map<String, String[]> parameterMap = new HashMap<String, String[]>();

            for (FileItem item : items) {
                if (item.isFormField()) {
                    processFormField(item, parameterMap);
                } else {
                    processFileField(item, httpRequest);
                }
            }

            chain.doFilter(new HttpServletRequestWrapper(httpRequest) {

                    public Map<String, String[]> getParameterMap() {
                        return parameterMap;
                    }

                    public String[] getParameterValues(String name) {
                        return (String[])parameterMap.get(name);
                    }

                    public String getParameter(String name) {
                        String[] params = getParameterValues(name);
                        if (params == null) {
                            return null;
                        }
                        return params[0];
                    }

                    public Enumeration<String> getParameterNames() {
                        return Collections.enumeration(parameterMap.keySet());
                    }
                }, response);
        } catch (Exception ex) {
            ServletException servletException = new ServletException();
            servletException.initCause(ex);
            throw servletException;
        }
    }

    private void processFormField(FileItem formField, Map<String, String[]> parameterMap) {
        String name = formField.getFieldName();
        String value = formField.getString();
        String[] values = parameterMap.get(name);

        if (values == null) {
            parameterMap.put(name, new String[] { value });
        } else {
            int length = values.length;
            String[] newValues = new String[length + 1];
            System.arraycopy(values, 0, newValues, 0, length);
            newValues[length] = value;
            parameterMap.put(name, newValues);
        }
    }

    private void processFileField(FileItem fileField, HttpServletRequest request) {
        if (request.getAttribute(fileField.getFieldName()) == null) {
            List<FileItem> fileFields = new ArrayList<FileItem>(0);
            fileFields.add(fileField);
            request.setAttribute(fileField.getFieldName(), fileFields);
        } else {
            List<FileItem> fileFields = (List<FileItem>)request.getAttribute(fileField.getFieldName());
            fileFields.add(fileField);
        }
    }
} 
```

因为我将有多个输入文件组件；所以我习惯于`List`将所有文件字段存储在方法中`processFileField`，然后将其设置为`request`.

# python - 在 python 中构建依赖关系图

> ID：14242295
> 
> 赞同：23
> 
> 时间：2013-01-09T16:54:24.930
> 
> 标签：python, graph, dependencies

我想知道python是否有一些内置库（或网络上的任何库..）这将为我创建一个依赖关系图？我有一个像这样格式化的文件

```
A::Requires         = ""
B::Requires     = A
C::Requires     = B
H::Requires     = A

AA::Requires         = ""
BB::Requires         = AA
C::Requires     = B

CC::Requires    = BB 
```

理想情况下，我想要像这样的树：

```
A
 +-B
   +-C
 +-H

AA
 +-BB
   +-CC 
```

所以基本上是一个库，我将在其中提供一个元组 (A,B) 或 (A,H)，它会为我构建树吗？如果这样的库不存在，那么完成类似事情的更简单方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-09T18:47:12.077

假设您从上面的输入作为字符串给出`raw`：

```
import networkx as nx
import re

regex = re.compile(r'^([A-Z]+)::Requires\s+=\s([A-Z"]+)$')

G = nx.DiGraph()
roots = set()
for l in raw.splitlines():
    if len(l):
        target, prereq = regex.match(l).groups()
        if prereq == '""':
            roots.add(target)
        else:
            G.add_edge(prereq, target) 
```

现在打印树：

```
for s in roots:
    print s
    spacer = {s: 0}
    for prereq, target in nx.dfs_edges(G, s):
        spacer[target] = spacer[prereq] + 2
        print '{spacer}+-{t}'.format(
                                     spacer=' ' * spacer[prereq],
                                     t=target)
    print '' 
```

这打印：

```
A
+-H
+-B
  +-C

AA
+-BB
  +-CC 
```

这要求**所有**根都被呈现出来`root::Requires = ""`，以便它们被识别出来。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-09T17:06:08.337

尝试以下几种之一：

*   [图形工具](https://graph-tool.skewed.de/)
*   [网络x](https://networkx.org/)
*   [图形](http://igraph.sourceforge.net/)

**graph-tool**很难安装（它需要大量内存进行编译，我认为它大约有 5GB 的 RAM 和大约 12 小时的编译时间）。

**networkx**相当不错。

**igraph**从他们的页面引用：*igraph 是一个免费软件包，用于创建和操作无向图和有向图。它包括经典图论问题的实现，如最小生成树和网络流，还实现了一些最近的网络分析方法的算法，如社区结构搜索。*

我一直在使用它们。这真的取决于你到底需要什么。如果您需要它们来处理依赖项等简单的事情，那么您将使用哪个并不重要，但是，如果您需要更短更轻的东西，我建议您避免使用 graph-tool。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-03-08T13:42:22.650

[Graphviz](http://www.webgraphviz.com/)非常适合以自动化方式构建依赖项文档。

也有一个有用的 Python 库，称为[pygraphviz](https://pypi.python.org/pypi/pygraphviz)

我用它来建立一个依赖关系图，然后以文本形式和自动导出为 PDF 的视觉效果输出。

# silverlight - 画布 Silverlight，C# 中的图像/笔触序列

> ID：14242296
> 
> 赞同：1
> 
> 时间：2013-01-09T16:54:25.447
> 
> 标签：silverlight, canvas, sequence, brush

我想在我的 Silverlight 应用程序的画布中显示一系列图像。但是，silverlight 会获取我所有的命令和图像并显示最后一个图像。我相信这是因为 Silverlight 的失去焦点功能，但我无法解决这个问题。我曾尝试使用 Thread.Sleep() 和 DispatcherTimer() 但它们似乎不起作用（我的实现，如下所示，它可能是错误的）。

```
for(int i =0; i < number; i++) 
```

`{ Canvas.SetTop(value1); Canvas.SetLeft(value2); Thread.Sleep(7000); }`

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:36:08.407

我实施的解决方案是使用两个线程。一个 BackgroundWorker 持有图像，然后将图像发送到显示它的 Dispatcher 或主线程。每次调用调度程序线程后，后台工作人员都会进入睡眠状态。

# java - 我的 OnLocationChanged 有问题吗？

> ID：14242298
> 
> 赞同：0
> 
> 时间：2013-01-09T16:54:30.343
> 
> 标签：java, android, gps, location

我的位置记录器服务类没有为我提供有关我的位置的更新信息。我的 OnLocationChanged 有什么问题吗？

```
public class LocationLoggerService extends Service implements LocationListener {

    Location location; // location
    String towers;

    // Declaring a Location Manager
    public LocationManager locationManager;

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        ourLocation();
        Criteria crit = new Criteria();
        towers = locationManager.getBestProvider(crit, false);
        location = locationManager.getLastKnownLocation(towers);

        // Just af test here:
        String hej1 = Double.toString(location.getLatitude());
        String hej2 = Double.toString(location.getLongitude());
        Toast.makeText(this, "Fra Oncreate: /nLat: " + hej1 + "Long: " + hej2,
                Toast.LENGTH_LONG).show();

    }

    public void ourLocation()

    {
        // Find my current location
        locationManager = (LocationManager) this
                .getSystemService(Context.LOCATION_SERVICE);
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,
                2000, 0, this);
    } 
```

onLocationChanged 方法没有为我提供新信息。我尝试了一些测试（吐司），但它好像没有读取这种方法。

```
@Override
public void onLocationChanged(Location loc) {
    if (loc != null) {
        // Testing the position
        String hej3 = Double.toString(loc.getLatitude());
        String hej4 = Double.toString(loc.getLongitude());
        Toast.makeText(this, "loc: " + "Lat: " + hej3 + "Long: " + hej4,
                Toast.LENGTH_LONG).show();
    }
}

    @Override
    public void onProviderEnabled(String s) {
    }

    @Override
    public void onProviderDisabled(String s) {
    }

    @Override
    public void onStatusChanged(String s, int i, Bundle b) {
    }

    @Override
    public void onDestroy() {

        // TODO Auto-generated method stub

        super.onDestroy();

        Toast.makeText(this, "MyAlarmService.onDestroy()", Toast.LENGTH_LONG)
                .show();

    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        // this service will run until we stop it

        return START_STICKY;
    }

} 
```

我的清单

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_GPS" />

<service
        android:name="LocationLoggerService"
        android:enabled="true"
        android:exported="false"
        android:label="LocationLoggerService" />
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:26:18.820

尝试更改以下代码并重试，直接从 onLocationChanged 回调方法获取位置对象...我希望您正在测试此功能。location ojbect 将包含最新的纬度和经度。

```
@Override
public void onLocationChanged(Location location) {

    // Testing onLocationChanged:
    String hej1 = Double.toString(location.getLatitude());
    String hej2 = Double.toString(location.getLongitude());
    Toast.makeText(this, "Location: "+"Lat: " + hej1 + "Long: " + hej2,
            Toast.LENGTH_LONG).show();

    String hej3 = Double.toString(loc.getLatitude());
    String hej4 = Double.toString(loc.getLongitude());
    Toast.makeText(this, "loc: " +"Lat: " + hej3 + "Long: " + hej4,
            Toast.LENGTH_LONG).show();

} 
```

# c# - GetManifestResourceStream - 它如何帮助缓存？

> ID：14242300
> 
> 赞同：2
> 
> 时间：2013-01-09T16:54:38.083
> 
> 标签：c#, wpf, drag-and-drop

我在我的 wpf 应用程序中搜索嵌入自定义拖放光标。我最终得到了[一篇](http://blogs.msdn.com/b/jaimer/archive/2007/07/12/drag-drop-in-wpf-explained-end-to-end.aspx)我不知道代码中建议的 ONE LINE 的文章（它在评论中突出显示）：

```
 private void textBlock2_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        TextBlock btn = (TextBlock)sender;

        GiveFeedbackEventHandler handler = new GiveFeedbackEventHandler(DragSource_GiveFeedback);
        btn.GiveFeedback += handler;

        DataObject dataObj = new DataObject(btn.Text);
        DragDrop.DoDragDrop(btn, dataObj, DragDropEffects.Move);
        btn.GiveFeedback -= handler;

    }

    void DragSource_GiveFeedback(object sender, GiveFeedbackEventArgs e)
    {
        try
        {
            if (_allOpsCursor == null)
            {

                ////////////////////////////////////////THE UNKOWN ONE LINE STARTS HERE
                using (Stream cursorStream = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceStream("SimplestDragDrop.DDIcon.cur")) // AND ENDS HERE
                {
                    _allOpsCursor = new Cursor(cursorStream);
                }
            }
            Mouse.SetCursor(_allOpsCursor);

            e.UseDefaultCursors = false;
            e.Handled = true;
        }
        finally { }
    } 
```

我检查了[GetManifestResourceStream](http://msdn.microsoft.com/en-us/library/xc4235zt.aspx)，但我仍然不知道如何处理主要资源是什么以及从哪里开始让这个缓存想法（在主要文章中提到）起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:15:29.227

您的程序集作为在 CLR 下执行的 AppDomain 的一部分加载到内存中。因此，如果资源作为编译过程的一部分嵌入到程序集中，则使用流来读取内存中的字节数组比必须去磁盘打开文件、读取其内容、关闭文件要快.

替代方法是在源代码中存储一个表示资源的字节数组，尽管您或多或少地使用`GetManifestResourceStream`.

# cocos2d-iphone - cocos2d 是否有 UISegmented 控件替代方案？

> ID：14242301
> 
> 赞同：0
> 
> 时间：2013-01-09T16:54:40.897
> 
> 标签：cocos2d-iphone, uisegmentedcontrol, kobold2d

cocos2d 是否有 UISegmented 控件。我知道我可以在 cocos2d 中使用 UISegmented 控件，但我只能将它附加到 glview 并且我需要能够将它附加到特定图层。

# unit-testing - 如何在茉莉花测试中模拟角度 $resource

> ID：14242302
> 
> 赞同：12
> 
> 时间：2013-01-09T16:54:42.753
> 
> 标签：unit-testing, angularjs, jasmine

我正在尝试测试一个使用 Angular 的 $resource 的控制器。

```
function PermissionsCtrl($scope, $resource, $cookies) {
  var Object = $resource('/v1/objects/:id');
  loadObjects();

  function loadObjects() {
    $scope.myAppObjects = new Array();

    var data = AppObject.get({find: '{"app_id": '+wtm.app_id+'}'},
      function(){
        if (data.results) {
          for(var i = 0; i< data.results.length; i++) {
            if(!data.results[i].is_deleted) {
              (function(i){
                $scope.objects(data.results[i]);
              }(i));
            }
          }
        }
      },
      function(error){console.log(error);});
  } 
```

这是测试代码。

```
var apiServer = "...";
var app_id = 999
var mock_object_data = {...};

describe('apps permissionsCtrl', function(){
  var scope, ctrl, $httpBackend;

  // Create a matcher for comparing data 
  beforeEach( function() {
    this.addMatchers({
      toEqualData: function(expected) {
        return angular.equals(this.actual, expected);
      }
    });
  });

  // Create the controller with injected data/services
  beforeEach(inject(function(_$httpBackend_, $rootScope, $controller, $resource) {
    $httpBackend = _$httpBackend_;
    // cookie data to inject
    var cookies = new Array();
    cookies['id'] = '...'; // just needs to be declared

    $httpBackend.expectGET(apiServer+'/v1/app_objects?    find=%7B%22app_id%22:'+app_id+'+%7D&access_token=' + cookies['id'])
      .respond( mock_object_data );

    var $injector = angular.injector(['ng', 'ngResource']);
    var $resource = $injector.get('$resource');

    scope = $rootScope.$new();
    ctrl = $controller(PermissionsCtrl, {$scope: scope, $cookies: cookies, $resource: $resource});
  }));

  it('should put object data into $scope', function() {
    $httpBackend.flush();
    expect(scope.objects).toEqualData( mock_object_data ); 
```

}); });

当我运行这个时，我得到

```
Error: Unknown provider: $resourceProvider <- $resource 
```

在我尝试创建控制器的那一行。我不明白如何将它注入我的控制器，无论我尝试什么，我都会得到同样的错误。我尝试过的几件事是

*   声明一个空的模拟对象并将其传递给类似于我的 cookies 变量。我认为这可能是一个糟糕的解决方案，因为我实际上想使用该服务。
*   模仿范围模拟并将其传递给我的注入函数并将 $resource.$new() 传递给我的控制器。
*   什么都不做，并希望 httpBackend 能够覆盖它，因为无论如何最终都会调用它。Vojta Jína 说这听起来可行，但没有骰子。
*   温和的绰号。令人满意但不是很有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T01:37:05.917

经过更多的阅读和更多的实验，似乎正确的方法是从控制器中抽象出 $resource 的使用。就我而言，我编写了一个依赖于 $resource 的服务，然后将该服务注入到我的控制器中。同时，我与控制器分开测试该服务。更好地练习四周。

我的服务声明：

```
angular.module('apiModule', ['localResource', 'ngCookies'])
.factory('apiService', function($resource, $cookies) { 
```

在我的单元测试中，我在 beforeEach 设置函数中通过它

```
beforeEach(module('apiModule')); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-09T17:54:13.920

尝试`$resource`使用以下代码实例化：

```
var $injector = angular.injector(['ng', 'ngResource']);
var $resource = $injector.get('$resource'); 
```

其他服务类似，除非它们仍在其他模块中。然后将该模块添加到数组中。

[更多信息](http://docs.angularjs.org/api/angular.injector)

# android - 背景图像崩溃android

> ID：14242303
> 
> 赞同：2
> 
> 时间：2013-01-09T16:54:44.057
> 
> 标签：android, android-layout, background, background-image

当我像在这段代码中那样放置背景线时，我的应用程序崩溃了。当我删除这条线时，我的应用程序工作正常，当我使用另一张照片时它也可以工作。有什么问题？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="@drawable/table2" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

主屏幕的背景也可以正常工作。但在第二页，它是problamatic。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:16:18.290

谢谢大家。我将尺寸从 2500x1900 更改为 1280x920，现在可以使用了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-23T16:39:15.363

**如果您仅使用可绘制文件夹来存储所有图像。然后在drawable-xhdpi**文件夹或更高文件夹中更改高分辨率图像的存储文件夹。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-28T09:47:56.567

确保图像路径是否在可绘制文件夹中。将其放在项目目录的 Mipmap 文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-26T21:29:30.747

我认为您应该检查图像的大小，任何超过 300kb 的内容都可能会导致您的应用程序不断崩溃。您始终可以使用图像压缩软件来减小图像的大小。

# ruby-on-rails - Rails has_many：通过保存额外的字段

> ID：14242308
> 
> 赞同：5
> 
> 时间：2013-01-09T16:55:01.300
> 
> 标签：ruby-on-rails, ruby

我正在尝试找到一种优雅的方式来保存 Appointment 模型上的一个名为 description 的附加字段（如下）。我的模型设置如下：

```
class Physician < ActiveRecord::Base
  has_many :appointments
  has_many :patients, through: :appointments
end

class Appointment < ActiveRecord::Base
  belongs_to :physician
  belongs_to :patient
end

class Patients < ActiveRecord::Base
  has_many :appointments
  has_many :physicians, through: :appointments
  attr_accessible :name
end 
```

在我看来，我设置了复选框来保存连接表的数据，但我想滑入一个额外的“描述”字段以与连接一起保存。以下是我的看法：

```
<div class="field">
  <fieldset>
  <legend>Patients</legend>
  <% @patients.each_slice(2) do |slice| %>
    <div class='row'>
      <% slice.each do |patient| %>
        <div class='span3'>
          <%= label_tag "physician_patient_ids_#{patient.id}" do %>
            <%= check_box_tag 'physician[patient_ids][]', patient.id,
                              @physician.patients.include?(patient),
                              { id: "physician_patient_ids_#{patient.id}" } %>
            <%= patient.name %>
          <% end %>
          <!-- need to add in description here somehow -->
        </div>
      <% end %>
    </div>
  <% end %>
  </fieldset>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:50:26.127

您可以使用`accepts_nested_attributes_for`来更新关联属性。

在模型中：

```
accepts_nested_attributes_for :appointments, :allow_destroy => true 
```

在视图中：

```
<%= f.fields_for :appointments do |apt| %>
  <%= apt.object.patient.name %>
  <%= apt.text_field :description %>
<% end %> 
```

参考[http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)

# java - Java Spring @Scheduled 任务执行两次

> ID：14242310
> 
> 赞同：37
> 
> 时间：2013-01-09T16:55:03.150
> 
> 标签：java, spring, schedule

我在这里有一个简单的测试方法，它设置为每 5 秒运行一次，并且确实如此，但是查看 System.out 你会发现它似乎在做一些奇怪的事情。

```
@Scheduled(cron="*/5 * * * * ?")
public void testScheduledMethod() {
     System.out.println(new Date()+" > Running testScheduledMethod...");
} 
```

输出：

```
Wed Jan 09 16:49:15 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:15 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:20 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:20 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:25 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:25 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:30 GMT 2013 > Running testScheduledMethod...
Wed Jan 09 16:49:30 GMT 2013 > Running testScheduledMethod... 
```

为什么每次都运行两次*（出现） ？*

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-09T17:24:14.433

如果您查看文档，则有一条注释明确指出了这种现象。

该注释[位于此链接的第 25.5.1 节](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html#scheduling-annotation-support-scheduled)下，内容如下：

> 确保您没有在运行时初始化同一 @Scheduled 注释类的多个实例，除非您确实想为每个此类实例安排回调。与此相关，请确保不要在使用 @Scheduled 注释并在容器中注册为常规 Spring bean 的 bean 类上使用 @Configurable：否则，您将获得双重初始化，一次通过容器，一次通过 @Configurable 方面，每个@Scheduled 方法被调用两次的结果。

我知道这只是目前的建议，但我认为我们没有足够的信息来进一步诊断问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-22T08:50:09.393

我知道答案！！

不要初始化你的 Scheduled 两次

掠夺您的网络日志：

`WebApplicationContext`一次和一次 servlet

所以在你`servlet.xml`不这样做

```
import resource="classpath:applicationContext.xml" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-12T08:10:09.377

这是因为上下文侦听器而发生的

只需删除

<听众>

<监听类>org.springframework.web.context.ContextLoaderListener</监听类>

</听者>

从 web.xml 它应该可以工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-09-24T09:31:38.637

我将我的类声明为“服务”，并使用@Scheduled 注释将其声明为调度程序。调度程序正常调用它，但正如我们将类声明为服务一样。它启动了两次。

我删除了服务注释。并在我维护的上下文 XML 中将该类声明为 bean。（在 web.xml 中声明的自定义上下文 XML）。这为我解决了这个问题。希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-15T09:11:56.733

我遇到了类似的问题。可能是因为以下原因。

1.  春季版本中的错误 [https://jira.spring.io/browse/SPR-10830](https://jira.spring.io/browse/SPR-10830)

2.  上下文被加载两次。

3.  log4j.xml 两次写入日志。它发生在我的情况下，不确定你的情况。如果您尝试过其他选项，也请尝试此选项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-23T23:17:12.523

我遇到了同样的问题，我最终发现问题是由于`root context`在`servlet context`.

因此，要解决此问题，您需要将 bean 的创建分离到适当的上下文中。

[这个答案](https://stackoverflow.com/a/19850897/1646783)很好地解释了如何做到这一点，并且解决了我的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-05-07T21:36:09.337

我有一个类似的问题，我解决了我的问题：

```
package com.sample.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.scheduling.annotation.EnableScheduling;

@Configuration
@EnableScheduling
public class JobExecutorConfig {
} 
```

作为spring boot的配置。我将其添加为作业类：

```
package com.sample.jobs;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

@Component
public class Job {

  private final Logger log = LoggerFactory.getLogger(this.getClass());

  @Autowired
  MyOtherClass moc;

  @Scheduled(fixedRate = 60000) // every 60 seconds
  public void doJob() {
    log.debug("Job running !!!");
    try {
     moc.doSomething()
    } catch (Exception e) {
      log.error(e.getMessage());
    }
    finally {

      log.debug("job Done !!!");
    }

  }

  // examples of other CRON expressions
  // * "0 0 * * * *" = the top of every hour of every day.
  // * "*/10 * * * * *" = every ten seconds.
  // * "0 0 8-10 * * *" = 8, 9 and 10 o'clock of every day.
  // * "0 0/30 8-10 * * *" = 8:00, 8:30, 9:00, 9:30 and 10 o'clock every day.
  // * "0 0 9-17 * * MON-FRI" = on the hour nine-to-five weekdays
  // * "0 0 0 25 12 ?" = every Christmas Day at midnight
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-16T08:49:40.080

我正在使用 spring 4.0.3，我遇到了这个问题。我通过重命名我的豆子来解决它。

至：

```
<task:annotation-driven executor="taskExecutor"
    scheduler="taskScheduler" />
<task:executor id="taskExecutor" pool-size="25" />
<task:scheduler id="taskScheduler" pool-size="25" /> 
```

我注意到一些 INFO 日志记录说没有找到名为 taskScheduler 的 bean，因此创建了一个新实例。所以我认为taskScheduler有两个实例。

让我知道这是否也适合你:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-03T19:10:03.407

好吧，在我的情况下，作业的 bean 有 @Component 注释，我在 applicationContext.xml 中有这个：

`<task:annotation-driven/> <bean id="getxxx" class="com.kitar.xxxx.jobs.RomeExample"></bean>`

所以解决方案是删除bean定义（第二行），因为：

`<task:annotation-driven/>`：允许在任何 Spring 管理的对象上检测 @Async 和 @Scheduled 注释，因此无需定义作业的 bean，否则它将被调用两次。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-30T06:58:34.720

根据[这篇](https://www.vodori.com/blog/scheduled-jobs-in-spring-3/)文章和[Spring Jira](https://jira.spring.io/browse/SPR-10830)，这是 Spring Framework Scheduler 组件中的一个错误。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-14T03:44:26.830

如果您的应用程序是 WEB，您可能想要检查您是否在两个不同的上下文中扫描相同包的组件，例如 applicationContext.xml 和 some-servlet.xml。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-31T18:58:47.353

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
         /WEB-INF/spring/root-context.xml
         /WEB-INF/spring/security/spring-security.xml
         /WEB-INF/spring/mongo/mongo-config.xml
         /WEB-INF/spring/appServlet/spring-context.xml
    </param-value>
</context-param>
<servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/appServlet/spring-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet> 
```

那是我的 web.xml 。因此，您可以看到“/WEB-INF/spring/appServlet/spring-context.xml”被加载了两次（一次在 context-param 中，一次在 servlet -> init-param 中）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-06-01T12:43:06.450

我遇到了同样的情况并通过以下方式解决：

1) 调度服务

```
@Service
public class SchedulerService {

    @Autowired
    @Qualifier("WorkerClass")
    private Worker worker;

    @Scheduled(cron="0/5 * * * * ?", zone="Asia/Colombo")//zone is a sample
    public void doSchedule() {
        worker.work();
    }

} 
```

2) 工人阶级

```
@Component("WorkerClass")
public class WorkerClass implements Worker {

    @Override
    public void work() {
        doSomething();
    }

    protected void doSomething() {
        system.out.pringln("What must I do?");
    }

} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-04-25T19:16:35.937

我确实遇到了同样的问题，查看我的代码并尝试了这里的所有内容后，我确实发现我在 2 个不同的类中有两次 SpringApplicationBuilder

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-10-16T21:58:18.503

我有同样的问题，我尝试了所有建议的方法，但对我没有任何效果。最后，我能够通过删除“SpringBootServletInitializer”的扩展名和 WebApplication 类的“configure”方法来找到解决方案，这样我就停止了重复我的计划任务。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-09-30T09:42:17.117

我有同样的问题。我正在使用基于注释的配置，如下所示：

```
@Configuration
@EnableScheduling
public class SchedulerConfig {

    @Scheduled(fixedDelay = 60 * 1000)
    public void scheduledJob() { 
        // this method gets called twice... 
    }   
} 
```

我还在扩展 AbstractAnnotationConfigDispatcherServletInitializer 来初始化它。

```
public class SpringWebApplicationInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {

@Override
protected Class<?>[] getRootConfigClasses() {
    return new Class<?>[] { MainConfig.class, SchedulerConfig.class };
}

@Override
protected Class<?>[] getServletConfigClasses() {
    return new Class<?>[] {SpringWebConfig.class};
}

@Override
protected String[] getServletMappings() {
    return new String[] { "/" };
}

@Override
protected Filter[] getServletFilters() {
    final CharacterEncodingFilter encodingFilter = new CharacterEncodingFilter();
    encodingFilter.setEncoding(CHARACTER_ENCODING);
    encodingFilter.setForceEncoding(true);
    return new Filter[] { encodingFilter };
} 
```

}

删除`SchedulerConfig.class`from`getRootConfigClasses()`方法对我有用。

```
@Override
protected Class<?>[] getRootConfigClasses() {
    return new Class<?>[] { MainConfig.class };
} 
```

我希望这有帮助。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-29T14:57:19.987

你好，

这可能是由于以下两个原因中的任何一个：

1.  App Context 被加载两次，或者
2.  您有多个应用程序实例正在运行（用于扩展目的）。

对于 1)，您可以遵循上述任何答案。我将谈论（2）。

对于 (2)，通常，在云环境中，您将有多个实例（如 2、3、4....）在云中运行。因此，您的调度程序将由每个应用程序实例触发。我在云环境中也遇到过这个问题。我们在 Cloud Foundry 上运行我们的应用程序，并且我们已经扩展到了 2 个应用程序实例。我们的调度程序开始触发两次（从每个应用程序实例，即 app_instance_0 和 app_instance_1）。

为了克服，我们可以执行以下任何一项操作：

方法一：使用 System.getenv("CF_INSTANCE_INDEX");
// 此 var 默认情况下由 Cloud Foundry 作为 env 变量提供给应用程序。它为我们提供了触发方法调用的应用程序实例索引。因此，当 app_instance_0 运行时，我们可以使用简单的条件来触发 schduler：

```
 @Scheduled(cron = * * * * * *)
 public void scheduledTask() {
 String appInstanceIndex = System.getenv("CF_INSTANCE_INDEX"); 
 if (appInstanceIndex.equals("0")) {
 .... //your scheduling logic here
 .... //your scheduling logic here
 }
 else {
 //dont do anything as its call from other app instances...
 } 
 } 
```

这里的一个主要优点是我们不进行任何数据库调用。当然，如果您不使用 CF，它将无法正常工作。但请检查您的 PaaS 是否提供任何此类变量。

方法二：这是一种通用方法。为调度程序实现一个新表。添加唯一约束列。在您的 shceduler 方法中，生成今天的日期并将其添加到 Db 中。（此日期保存在具有唯一约束的列的表中）。现在，这个调度程序第一次总是会正常运行。当其他应用程序实例尝试再次创建今天的日期并保存到数据库时，会导致异常，因为数据库具有唯一约束并且无法再次添加日期。因此，对于其他应用程序实例，调度程序逻辑将失败并导致异常。

```
 @Scheduled(cron = * * * * * *)
 public void scheduledTask() {
 String date = LocalDate.now().toString();
 try{
 insertDateInDb();
 // your scheduler logic here
 }
 catch(Exception e){
 // Dont do anything...
 }                    
 } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-07-05T01:27:32.460

我有同样的问题。花了几个小时试图解决。

解决方案是应用程序在 Tomcat 上部署了两次。

尝试清理 Tomcat 时出现错误。

检查 server.xml Tomcat 文件，我注意到它被部署了两次。还有一个未关闭的“主机”标签。不确定其中哪一个修复了它，但让它再次正常工作感到宽慰。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-11T14:55:57.020

就我而言，此问题仅发生在 PRODUCTION 环境中。

它没有在本地暂存环境中复制。

**后来我们意识到在生产中我们有多个服务器在运行。**

**因此，每个服务器都运行自己的 cron，这实际上导致了多个 cron 事件同时发生。**

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-10-07T13:55:23.707

我的 springboot-application 遇到了同样的问题，调度程序运行了两次。

正如之前的评论中多次提到的，原因是 bean 被多次初始化。

我的解决方案是：

*   删除 @Component 注解（在包含 @Scheduled 方法的类上）
*   手动将包含 @Scheduled 方法的类添加到 ApplicationContext

在代码中 - 这是我所做的更改：

```
// @Component <------ Removed
public class FileTransferScheduler {

    private final Logger logger = LoggerFactory.getLogger(FileTransferScheduler.class);

    @Autowired
    private ExtractorService extractorService;

    @Scheduled(cron = "* /1 * * * *")
    public void scheduleFileTransfer() {

        logger.info("Triggered cronjob to transfer new uploads to dms...");
        extractorService.extractTmcUploads();
    }

} 
```

...然后在 springboot-application 的 main 方法中进行了这种更改：

```
@EnableScheduling
@SpringBootApplication
public class InsidersExtractorApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        // The Scheduler Class needs to be added manually, because it dont have to be defined as Bean
        return application.sources(InsidersExtractorApplication.class, FileTransferScheduler.class);
    }

    public static void main(String[] args) {
        SpringApplication.run(InsidersExtractorApplication.class, args);
    }

} 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-03-02T17:03:36.777

对我来说，经过几次不成功的尝试和配置，解决方法很简单：

编辑 conf/server.xml 文件：

```
<Host appBase="webapps" deployOnStartup="false" autoDeploy="false" name="localhost" unpackWARs="true"> 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2016-10-20T14:19:52.017

我今天遇到了同样的问题。

在我的项目中，我将调度程序与我的 Spring Boot 应用程序一起使用，而在我的 ScheduledTaks 类中，我使用了 @Component 注释。但我犯了一个错误，因为@Component 代表我的类的一个 bean，而在我的 Application 类中，我用代码为这个类创建了另一个 bean：

```
public class Application extends SpringBootServletInitializer {

  @Override
  protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
      return application.sources(Application.class);
  }

  public static void main(String[] args) throws Exception {
      SpringApplication.run(Application.class, args);
  }

  @Bean
  public ScheduledTasks getScheduledTasks() {
    return new ScheduledTasks();
  }
} 
```

我只是删除了这个注释，调度程序就可以正常工作了。

按照我的代码 ScheduledTasks 类的示例：

```
public class ScheduledTasks {
  private static final SimpleDateFormat dateFormat = new SimpleDateFormat("HH:mm:ss");

  @Scheduled(cron = "00 14 11  * * *")
  public void reportCurrentTime() {
    log.info("The date is: {} " + dateFormat.format(new Date()) );
  }
} 
```

结果：

```
2016-10-20 11:13:41.298  INFO 6832 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 8080 (http)
2016-10-20 11:13:41.302  INFO 6832 --- [           main] br.com.Application                       : Started Application in 9.257 seconds (JVM running for 9.676)
2016-10-20 11:14:00.002  INFO 6832 --- [pool-2-thread-1] br.com.scheduler.ScheduledTasks          : The date is: {} 11:14:00 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2018-11-27T13:33:57.890

有同样的问题。

就我而言，我将@Scheduled 函数从@Service 移动到带有@Component 注释的新单独类中，它解决了我的问题

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2018-09-04T11:47:40.523

在 application.properties 中，添加以下属性，告诉 Spring Boot 应用程序不要在应用程序启动时启动批处理作业。

```
spring.batch.job.enabled=false 
```

# facebook - 通过 Graph API 拉取 Facebook 页面/放置“主题”

> ID：14242313
> 
> 赞同：2
> 
> 时间：2013-01-09T16:55:07.680
> 
> 标签：facebook, facebook-graph-api, facebook-page

2012 年 9 月，Facebook 引入了“地点主题”，如下所述：

[http://starien.com/facebook-pages/place-topics-on-facebook-pages/](http://starien.com/facebook-pages/place-topics-on-facebook-pages/)

“主题”充当页面和地点的标签或子类别。这些与更通用的“类别”标签（例如“本地企业”）不同，增加了一层特殊性（例如“酒类商店”）。主题位于“标签”图标旁边的个人资料图像下。

我将使用这个页面/地点，以“酒类商店”为主题：http: [//www.facebook.com/RoyalLiquor](http://www.facebook.com/RoyalLiquor)

我正在寻找一种从 Facebook 页面中提取这些主题的方法。此位置的 Graph API 为我提供了“购物/零售”类别和一些其他信息，但找不到“酒类商店”主题。

单击“酒类商店”主题将带您进入一个看起来像特殊主题的页面。所以看起来“liquor store”的主题 ID 为 199833073363963。有趣的是，当尝试通过 Graph API 提取有关该主题的数据时，您会收到错误消息：

```
{
  "error": {
    "message": "(#3) App must be on whitelist", 
    "type": "OAuthException", 
    "code": 3
  }
} 
```

即使在 Facebook Graph API Explorer 应用程序的上下文中也会出现此错误。

有什么方法可以提取这个主题数据吗？或者这仅仅是 Facebook 尚未为其引入 API 的新功能？

谢谢你的帮助！谷歌似乎没有太多关于这个话题的信息。

# html - 网站菜单悬停css IE8问题

> ID：14242317
> 
> 赞同：0
> 
> 时间：2013-01-09T16:55:17.777
> 
> 标签：html, css, internet-explorer-8

我在这里有一个网站 [http://www.deltacars.co.uk/testsite/](http://www.deltacars.co.uk/testsite/)

菜单和悬停在包括 IE8 在内的所有浏览器中都可以正常工作，但是当我转到另一个使用相同 html 和 css 的页面时，菜单显示不正确

[http://www.deltacars.co.uk/testsite/north-wales-private-hire/privatehire.html](http://www.deltacars.co.uk/testsite/north-wales-private-hire/privatehire.html)

请注意，这仅使用 IE 8。

任何人都知道为什么它在一页上运行良好而不是另一页

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:21:23.103

损坏的页面在标题中缺少一些条件 IE 注释。您需要做的就是右键单击并查看页面源以比较输出。

```
 <!--[if lt IE 9]>
    <script src="shiv/dist/html5shiv.js"></script>
    <![endif]-->
    <!--[if lt IE 9]>
    <script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
    <![endif]--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:35:19.867

[使用http://validator.w3.org](http://validator.w3.org)对您的网站进行彻底验证- 我的猜测是您的 241 错误之一导致它无法在 IE8 中正确呈现。

尽管标记不正确，“现代”浏览器足够智能，可以正确呈现元素，因此您在其他任何浏览器上都看不到问题。

# android - java.lang.OutOfMemory 具有大的高分辨率图像

> ID：14242318
> 
> 赞同：1
> 
> 时间：2013-01-09T16:55:21.550
> 
> 标签：android, memory, bitmap, imageview, allocation

我正在开发一个 Android 应用程序，它在其几个活动中使用多个大图像。每个图像大约为 1280x800，我为每个 Activity 加载大约 2-4 个这些图像。我意识到这些图像在分配给设备上每个单独应用程序的内存方面非常大，但是我怎样才能以原始分辨率显示它们而不会遇到 java.lang.OutOfMemory 错误？我需要这些图像在屏幕上以全尺寸显示（当屏幕小于图像时，xml 会自动进行缩放）。我看到了几种解决方案，涉及将图像缩小为缩略图并将其存储到内存中，但这不会导致图像失去其原始大小/分辨率吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:04:51.860

您可以对此做一些事情。

首先想到的是 1280x800（可能）是您的整个屏幕，因此您一次只需要显示一个。当你这样做时，不要记住其他人。

一个 1280x800 的图像，每像素 4 字节只有 4MB，而平板电脑现在似乎都提供了 48MB 的堆。如果需要，您应该能够在内存中保存一些。如果您的内存不足，则可能会泄漏。如果您在 DDMS 中观看，您的内存使用量是否会随着您更改活动而继续增长？

泄漏的常见来源是位图本身。完成后一定要打电话[`Bitmap#recycle`](http://developer.android.com/reference/android/graphics/Bitmap.html#recycle())。

如果真的归结为它，并且您无法适应提供的堆空间，您也可以尝试`android:largeHeap="true"`在清单中添加应用程序标签。这将要求系统为您提供更多堆空间 - 在某些设备上高达 256MB。不过，这应该是最后的手段，因为它会因设备而异，并且在某些设备上会被完全忽略（想到最初的 Kindle Fire）。

你可以看到你有多少总堆空间`Runtime.getRuntime().maxMemory();`。有关更详细的说明，请参阅[此答案。](https://stackoverflow.com/questions/2630158/detect-application-heap-size-in-android/9428660#9428660)查看您正在使用多少会比较棘手，但是如果您想解决那个野兽，[这里有一个描述。](https://stackoverflow.com/questions/2298208/how-to-discover-memory-usage-of-my-application-in-android?lq=1)

最后，可能有比在 xml 中指定图像更好的方法来加载图像。请务必阅读此[开发人员指南页面](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)。即使您必须将它们保留在 xml 中，我也看到通过将图像资产拆分到`drawable-hdpi`、`drawable-mdpi`等目录而不是仅仅将它们转储到`drawable`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:16:14.020

[本文](http://dev.eclipse.org/blogs/memoryanalyzer/2008/05/27/automated-heap-dump-analysis-finding-memory-leaks-with-one-click/)很好地描述了如何创建堆转储并使用 Eclipse MAT 对其进行分析。这将帮助您快速找到最可能的内存泄漏嫌疑人。

我再次向您指出我从另一个 SO Question 中找到的[这个很棒的链接](http://developer.android.com/training/displaying-bitmaps/index.html)，该链接有关于如何正确解决问题的教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T20:21:33.607

在使用 BitmapFactory 或相关方法加载图像之前，需要对图像进行缩放。

```
public static int calculateInSampleSize(
            BitmapFactory.Options options, int reqWidth, int reqHeight) {
    // Raw height and width of image
    final int height = options.outHeight;
    final int width = options.outWidth;
    int inSampleSize = 1;

    if (height > reqHeight || width > reqWidth) {
        if (width > height) {
            inSampleSize = Math.round((float)height / (float)reqHeight);
        } else {
            inSampleSize = Math.round((float)width / (float)reqWidth);
        }
    }
    return inSampleSize;
}

public static Bitmap decodeSampledBitmapFromResource(Resources res, int resId,
        int reqWidth, int reqHeight) {

    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeResource(res, resId, options);

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeResource(res, resId, options);
} 
```

whole thing is explained in Android developer site, [Loading Large Bitmaps Efficiently](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

# c++ - 清理时 cppunit 中的分段错误

> ID：14242323
> 
> 赞同：0
> 
> 时间：2013-01-09T16:55:36.657
> 
> 标签：c++, cppunit

在清理阶段从 main 返回时，CPPUNIT 在执行我的程序后崩溃。TestWrapping 的 dtor 调用 TestSuite 的 dtor，然后调用 deleteContents 触发测试用例清理。

奇怪的是 TestSuite 的 dtor 被调用了两次？这是在成功执行 6 个测试用例之后。关于如何避免这种情况的任何想法？

```
 Program terminated with signal 11, Segmentation fault.
#0  0x0000000000000045 in ?? ()
(gdb) bt
#0  0x0000000000000045 in ?? ()
#1  0x0000000000000001 in ?? ()
#2  0x0000000001004f2d in CppUnit::TestSuite::~TestSuite (this=0x7fe7bc005820, __in_chrg=<optimized out>) at TestSuite.cpp:18
#3  0x0000000001004ebd in CppUnit::TestSuite::deleteContents (this=0x7fe7bc001040) at TestSuite.cpp:28
#4  0x000000000100500d in CppUnit::TestSuite::~TestSuite (this=0x7fe7bc005820, __in_chrg=<optimized out>) at TestSuite.cpp:18
#5  0x0000000001004c50 in CppUnit::TestRunner::WrappingSuite::~WrappingSuite (this=0x7fe7bc005820, __in_chrg=<optimized out>) at ../../include/cppunit/TestRunner.h:101
#6  0x000000000040b72a in main (argc=0, argv=0x7fff8198bf08) at /project/EAB3_EMC/BRF/lmcgupe/brf/build/../software/brfc_test/BrfcTestMain.cc:447

Code exercising this:
(from main)
    CppUnit::TextUi::TestRunner runner;
    CPPUNIT_NS::TestResult controller;
    CPPUNIT_NS::TestResultCollector result;
    controller.addListener( &result );

    // Show a message as each test starts
    //
    CppUnit::BriefTestProgressListener listener;
    runner.eventManager().addListener(&listener);
    controller.addListener( &listener );

    // Specify XML output and inform the runner of this format
    //
    std::ofstream xmlout("test_result.xml");
    CppUnit::XmlOutputter* outputter = new CppUnit::XmlOutputter(
            &result, xmlout);
    runner.setOutputter(outputter);

    CppUnit::TextOutputter consoleOutputter(&result , std::cout);

    runner.addTest(CreateAlarmBackupSuite::suite());
    runner.run( controller );

from class CreateAlarmBackupSuite: public CppUnit::TestFixture

    static CppUnit::Test *suite()
    {

        // Create the Test Suite
        //
        CppUnit::TestSuite *suite = new CppUnit::TestSuite("CreateAlarmBackupSuite");

        // Add the test cases

        //Crt_Syst_07
        suite->addTest(new CppUnit::TestCaller<CreateAlarmBackupSuite>(
                       "07_Crt_ScheduledBackup_ScheduledSingleEvent_SystemDataBackup_Non_Successful_Create_Persistent_ManualDelNotClear",
                &CreateAlarmBackupSuite::Crt_ScheduledBackup_ScheduledSingleEvent_SystemDataBackup_Non_Successful_Create_Persistent_ManualDelNotClear));

        //Crt_Syst_09
        suite->addTest(new CppUnit::TestCaller<CreateAlarmBackupSuite>(
                "09_Crt_ScheduledBackup_ScheduledSingleEvent_SystemDataBackup_Non_Successful_Create_Transient_NoRetry",
                &CreateAlarmBackupSuite::Crt_ScheduledBackup_ScheduledSingleEvent_SystemDataBackup_Non_Successful_Create_Transient_NoRetry));

return suite;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:11:07.687

我希望您的代码没有显式调用这些对象的析构函数，而是调用`delete`指向它们的指针，或者它们超出范围并且编译器会自动调用它们的析构函数。假设您没有明确调用析构函数.....

看起来您的 TestSuite 对象要么执行 a ，要么`delete this`包含指向自身的指针（或在 deleteContents() 中以某种方式获得指向自身的指针），然后调用`delete`该指针。你还没有发布你的`TestSuite`类的源代码（特别是它的`deleteContents()`方法），但这是我的猜测，没有看到代码。

# python - VPython 时间测量。计算经过的秒数

> ID：14242326
> 
> 赞同：2
> 
> 时间：2013-01-09T16:55:58.437
> 
> 标签：python, time, measurement, vpython

我应该如何测量无限循环中通过的秒数？我正在使用 Vpython，在我的循环中我改变了一些元素的位置等。问题是我必须每 X 秒改变一次灯光（球体）的颜色，这一切都发生在无限循环中。

```
while True:
    #some stuff
    'here i have to count those seconds'
    #some other stuff 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:00:01.273

您可以通过调用来确定经过的时间[`time.time()`](http://docs.python.org/2/library/time.html#time.time)，并获取差值。

> 我必须每 X 秒更改一次灯光（球体）的颜色

假设您上次更改颜色的时间`T`。在循环内继续调用，当超过`time.time()`时再次改变颜色。`time.time() - T``X`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:01:51.303

您可能应该使用[`timeit.default_timer()`](http://docs.python.org/2/library/timeit.html#timeit.default_timer)它来确定现在是什么时间并计算差异。

例如：

```
from timeit import default_timer
clock_start = default_timer()
#... do something here
clock_end = default_timer()
print "This took %s seconds" %( clock_end - clock_start ) 
```

# c - 如果我使用超过 25 个元素的数组，则 msp430g2211（启动板）在启动时停止

> ID：14242327
> 
> 赞同：2
> 
> 时间：2013-01-09T16:56:02.443
> 
> 标签：c, msp430

我在 Linux 环境（Ubuntu，msp430-gcc 4.6.3）中使用 TI Launchpad (msp430g2211)。

我有一个奇怪的问题：当我尝试分配超过固定数量的内存时，微控制器会在启动时停止。

更准确地说：我在 main() 中有一个包含 25 个元素的数组，创建如下：

```
color img0[25] = {

            off, cyan, cyan, cyan, off,
            cyan, red, violet, orange, cyan,
            cyan, red, violet, orange, cyan,
            off, cyan, cyan, cyan, off,
            off, off, off, off, off,

        }; 
```

（为了完整性：

```
typedef struct color {
    uint8_t r;
    uint8_t g;
    uint8_t b;
    } color;

static color red = {25, 0, 0}; ... 
```

)

一切正常，但如果我尝试使用 30 个（或任何大于 25 个）元素而不是 25 个元素，那么 uC 似乎已经死了。（编译和编程过程中没有错误）

在 TI Wiki 中，我发现了这个，这似乎符合我的经历：

> C 启动代码期间 WDT 触发
> 
> 如果应用程序是用 C 语言编写的，另一个最常见的问题是启动期间的看门狗超时。默认情况下，所有 MSP430 上的看门狗定时器在启动后都设置为活动状态。因此，如果不需要，则必须在应用程序代码开始时关闭 WDT。**如果应用程序代码使用** 需要在启动期间初始化的大变量，这可能导致看门狗定时器在启动期间已经触发并且代码将永远不会运行。
> 
> 此问题的解决方案是使用编译器的低级 C 初始化函数，该函数甚至在 C 变量初始化之前就被调用。在 CCS 编译器中，它被称为“int _system_pre_init(void)”，而在 IAR 中，该函数被称为 int __low_level_init(void)。返回值用于确定是否执行 C/C++ 全局数据初始化（返回值 0 绕过 C/C++ 自动初始化）。有关此问题的更多详细信息，请参阅 MSP430 软件编码技术应用报告，第 3.6 章“使用低级初始化函数”。

所以我尝试添加以下函数（为了在分配内存之前停止 WDT）：

```
__attribute__((naked, section(".init5"))) void __low_level_init()
{
     WDTCTL = WDTPW + WDTHOLD; //Stop WDT
} 
```

但问题仍然存在......

我做过的其他测试： - 更改了编译器的版本 - 将数组拆分为 15 个元素中的两个或多个 - 在主函数或“.init3”、“.init1”、“.init7”中停止 WDT

任何想法 ？谢谢你。

编辑：按照建议，我分析了 GCC 输出 ASM 代码（用“##”注释为无效版本）：

```
 .file   "main.c"
    .arch msp430g2211
    .cpu 430
    .mpy none

    .text
.Ltext0:
    .comm dir,2,2
    .comm colors,2,2
    .section    .init9,"ax",@progbits
    .p2align 1,0
.global main
    .type   main,@function
/***********************
 * Function `main' 
 ***********************/
main:
.LFB0:
    .file 1 "main.c"
    .loc 1 61 0
    mov r1, r4
.LCFI0:
    add #2, r4
.LCFI1:
    add #llo(-100), r1             ## add   #llo(-150), r1
.LCFI2:
    .loc 1 63 0
    mov #23168, &__WDTCTL
    .loc 1 66 0
    mov.b   &__CALBC1_1MHZ, r15
    mov.b   r15, &__BCSCTL1
    .loc 1 67 0
    mov.b   &__CALDCO_1MHZ, r15
    mov.b   r15, &__DCOCTL
    .loc 1 68 0
    mov.b   &__P1DIR, r15
    bis.b   #127, r15
    mov.b   r15, &__P1DIR
    .loc 1 90 0
    mov r4, r15
    add #llo(-102), r15            ## add   #llo(-152), r15
    mov #100, r14                  ## mov   #150, r14
    mov r14, r13
    mov #0, r14
    call    #memset
    mov.b   #llo(-64), -102(r4)        ## mov.b #llo(-64), -152(r4)
    mov.b   #llo(-64), -101(r4)        ## mov.b #llo(-64), -151(r4)
    ... 
```

diff 命令还说：

```
106c106
<   add #llo(-102), r15
---
>   add #llo(-152), r15
187c187
<   cmp #20, r15
---
>   cmp #30, r15
193c193
<   add #llo(-100), r15
---
>   add #llo(-150), r15
541c541
<   .sleb128 -102
---
>   .sleb128 -152
548c548
<   .byte   0x63
---
>   .byte   0x95 
```

我不是 ASM 专家，但 WDT 说明似乎在正确的位置。我不明白问题出在哪里...谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:02:57.190

听起来像是一个编译器错误，在这种情况下，如果您查看 GCC 生成的 asm，可能很明显出了什么问题。

在你发布它之后我查看了 asm，我突然想到你只有 128 字节的 SRAM 可以使用。我不熟悉这个 uC 的汇编程序，但在我看来它已经被超越了。不是单独分配颜色数组，而是结合堆栈？

# asp.net-mvc - ASP.net mvc 中的解析器错误

> ID：14242328
> 
> 赞同：0
> 
> 时间：2013-01-09T16:56:04.730
> 
> 标签：asp.net-mvc

我正在关注本网站的[教程](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-3)。一切都很顺利，直到我添加了 css 和 image 文件夹。添加这两件事并运行我的项目后，我收到以下错误：

![错误图像](../Images/82b326b2bbc0f2b62cfe2ec6a3117635.png). 我有两个控制器类和一个视图类。如果你们愿意，我可以分享给你们。但是，如果您还单击我提供的链接，您也可以在那里看到代码。感谢您的时间和帮助。

这是我的 global.asax 文件：

```
 using System;
    using System.Collections.Generic;
    using System.Data.Entity;
    using System.Data.Entity.Infrastructure;
    using System.Linq;
    using System.Web;
    using System.Web.Mvc;
    using System.Web.Routing;

    namespace MvcMovieStore
    {
        // Note: For instructions on enabling IIS6 or IIS7 classic mode, 
        // visit http://go.microsoft.com/?LinkId=9394801

        public class MvcApplication : System.Web.HttpApplication
        {
            public static void RegisterGlobalFilters(GlobalFilterCollection filters)
            {
                filters.Add(new HandleErrorAttribute());
            }

            public static void RegisterRoutes(RouteCollection routes)
            {
                routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

                routes.MapRoute(
                    "Default", // Route name
                    "{controller}/{action}/{id}", // URL with parameters
                    new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
                );

            }

            protected void Application_Start()
            {
                AreaRegistration.RegisterAllAreas();

                // Use LocalDB for Entity Framework by default
                Database.DefaultConnectionFactory = new SqlConnectionFactory(@"Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True");

                RegisterGlobalFilters(GlobalFilters.Filters);
                RegisterRoutes(RouteTable.Routes);
            }
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:03:55.183

检查代码隐藏文件 global.asax.cs，命名空间应该是 MvcMovieStore，类名应该是 MvcApplication，我猜类名不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:22:08.093

这是wiered，但我什么也没做，我只是再次运行它并且它起作用了。惊人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-04T08:03:52.967

我发现更改项目的命名空间，而不在整个解决方案中对其进行重构是我的问题。检查您的项目属性并查看您的命名空间是什么，确保所有内容都排列整齐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-23T23:32:34.757

我没有特别的原因得到同样的错误。只需关闭并重新打开 Visual Studio 即可解决我的问题。

# sql - 使用 between 语句作为组

> ID：14242330
> 
> 赞同：3
> 
> 时间：2013-01-09T16:56:09.970
> 
> 标签：sql, ibm-midrange

我很难找到描述我的问题的词，所以谷歌没有找到任何结果。很抱歉（可能）是一个非常简单的问题。

基本上我想要两行，这两行都是由语句之间的个人创建的。我试过像在 Select 中一样使用“AS”语句，但这只会给我一个语法错误。

这是我的代码：

```
Select      WEEK_ID,
            SUM (CUR_CHARGE_UNITS) as "Pro Units"
From        DW******.SLS****
Where       (WEEK_ID Between '201201' And '201252') --Use 'as' statement here?
            Or (WEEK_ID Between '201101' And '201152')
Group By    WEEK_ID 
```

基本上我想弄清楚如何制作

`WEEK_ID Between '201201' And '201252'`

折叠成一行标题为“2012”。就像我说的，我所尝试的只是

`(WEEK_ID Between '201201' And '201252) As "2012"`

有什么想法吗？有没有人想指点我的教程？不知道一个大概是基本问题的答案有什么侮辱吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:00:08.307

尝试取前 4 个字符并按其分组：

```
Select      LEFT(WEEK_ID,4) AS Year,
            SUM (CUR_CHARGE_UNITS) as "Pro Units"
From        DW******.SLS****
Where       (WEEK_ID Between '201201' And '201252') --Use 'as' statement here?
            Or (WEEK_ID Between '201101' And '201152')
Group By    LEFT(WEEK_ID,4) 
```

好处是 LEFT 是 ANSI 所以应该在所有 rdbms 中工作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:00:16.430

听起来你需要一个案例陈述

[http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=%2Fcom.ibm.db2.doc.sqlref%2Fpsmcse.htm](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=%2Fcom.ibm.db2.doc.sqlref%2Fpsmcse.htm)

```
select
    case when week_id between '201201' and '201252'
              then '2012'
          when week_id between '201101' and '201152'
              then '2011'
     end as 'year'
        SUM (CUR_CHARGE_UNITS) as "Pro Units"
From        DW******.SLS****
Where       (WEEK_ID Between '201201' And '201252')
        Or (WEEK_ID Between '201101' And '201152')
Group By 
     case when week_id between '201201' and '201252'
              then '2012'
          when week_id between '201101' and '201152'
              then '2011'
     end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:03:05.590

就“任何想法”而言，我建议您简单地研究 GROUP BY 子句和 SQL 聚合的概念。

如果您想聚合一年中的所有周，那么您*不想*选择或按 WEEK_ID 分组（您希望按**year**分组）。

# asp.net - 创建自定义响应处理程序

> ID：14242332
> 
> 赞同：0
> 
> 时间：2013-01-09T16:56:21.783
> 
> 标签：asp.net, iis-7, httpresponse, httpmodule

是否可以创建任何类型的处理程序来处理来自 ASP.NET 页面的输出响应？

我的场景：我有一个用 IIS 7 中托管的 ASP.NET/C# 编写的第三方应用程序（未提供源代码），我想创建一个“处理程序”，以便我可以获得输出 HTML 响应并修改其 HTML 代码.

据我所知，可插入的 HTTPModules 和 HTTPHandlers 只能处理请求消息，不能处理输出。这是正确的吗？

还有其他方法可以达到相同的结果吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:04:05.133

您可以使用 HttpModule 并注册可以更改输出的过滤器！只需在 web.config 中注册该模块，瞧！
MSDN 上提供了 HttpModule 的示例：http: [//msdn.microsoft.com/en-us/library/bb398986](http://msdn.microsoft.com/en-us/library/bb398986(v=vs.100).aspx) (v=vs.100).aspx ，此处解释了过滤器：http: [//aspnetresources.com/articles /HttpFilters](http://aspnetresources.com/articles/HttpFilters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:04:33.960

你能不能只`HttpWebRequest`用于这种情况并在你的应用程序中调用页面？

看看[这篇](http://msdn.microsoft.com/en-gb/library/system.net.httpwebrequest.aspx)文章

# twitter-bootstrap - 引导工具提示 - 不工作 - 智慧结束

> ID：14242336
> 
> 赞同：0
> 
> 时间：2013-01-09T16:56:29.053
> 
> 标签：twitter-bootstrap, tooltip

我无法终生确定以下为什么不起作用。任何帮助，将不胜感激。我已经为此找到了 StackOverflow 区域并尝试了一些解决方案，但我只是看不到使工具提示正常工作。谢谢。

```
<!DOCTYPE html>
<html>
    <head>
        <title>Test Page</title>

        <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet">
    </head>

    <body>
        <div class="container">
            <div class="well">
                <p></p>
                <p></p>
                <p>This is a test <a href="#" rel="tooltip" title"Some title" class="submit-tooltip">hover here</a>.</p>
        </div></div>

        <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
        <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
        <script type="text/javascript">
            $('.submit-tooltip').tooltip();
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T16:59:45.400

什么不工作？

首先，您没有关闭标题标签 => title="something"

其次，您是否尝试在头部加载脚本标签？有很多错误，但请检查小提琴。

```
 <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript">
        $('.submit-tooltip').tooltip();
    </script> 
```

编辑：http: [//jsfiddle.net/BBYYz/](http://jsfiddle.net/BBYYz/)

# sql-server - 如何将查询结果从 2 列重新格式化到 5 列。Col1 'time' 最多出现 4 次 & Col2 'names' 需要与正确时间相邻列出

> ID：14242337
> 
> 赞同：2
> 
> 时间：2013-01-09T16:56:32.490
> 
> 标签：sql-server, tsql, pivot-table

我有一个返回 2 列的查询，其中 1 列是“时间”，它不是唯一的，最多可能出现 4 次。第二列是“名称”列表。如果需要，我可以轻松添加该数据独有的第三个字段，称为 RegId。

我想修改查询结果，将时间列减少到一个实例（GROUP BY），但我想以类似于下面的表格格式水平显示所有名称。

```
'Start Time'  'Player 1'   'Player 2'   'Player 3'  'Player 4' 
```

到目前为止，我没有成功尝试使用 PIVOT 命令，但可能只是错过了那个技巧。我应该使用直接的命令吗？

我最接近它的方法如下：

```
DECLARE @Registered TABLE
(CompetitionName VARCHAR(50),
CompetitionDate  Date,
StartTime TIME,
PlayersName  Varchar(60)
)
INSERT INTO @Registered
SELECT MAX(c.CompetitionName) AS 'Competition Name', MAX(c.[Date]) AS 'Competition Date', 
CONVERT(VARCHAR, r.PlayersStartTime, 108) AS 'Start Time', 
CASE WHEN m.MemberId IS NOT NULL THEN (m.Surname + ', ' + m.FirstName) ELSE (nm.Surname + ', '+ nm.Firstname) END AS PlayersName
FROM dbo.Competitions c
LEFT JOIN [dbo].[Registration] r ON c.[CompetitionId] = r.[CompetitionId]
LEFT JOIN dbo.Members m ON r.MemberId = m.MemberId
LEFT JOIN dbo.NonMembers nm ON r.NonMemberId = nm.NonMemberId
WHERE Date = '2013-01-04' AND c.CompetitionId = 10
GROUP BY r.PlayersStartTime, m.MemberId, m.FirstName, m.Surname, nm.FirstName, nm.Surname
----
SELECT [@Registered].StartTime, [@Registered].PlayersName AS 'Player 1', [@Registered].PlayersName AS 'Player 2',
[@Registered].PlayersName AS 'Player 3',[@Registered].PlayersName AS 'Player 4'
FROM @Registered 
```

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:10:25.887

这是获取逗号分隔列表的技巧——我敢打赌这就是你想要的：

它看起来像这样：

```
StartTime    PlayerList
5:00         Sam, David, Joe
6:00         Lisa, Bart, Victor 
```

为此，请使用这样的查询（XML“技巧”）

```
SELECT DISTINCT Main.StartTime, 
 STUFF((SELECT ', ' + PlayersName
  FROM [@Registered] Inner
  WHERE Inner.StartTime = Main.StartTime 
  FOR XML PATH ('')),1,2,'') AS PlayerList
FROM [@Registered] Main 
```

注意，我没有测试，所以它可能有错字（但我对此表示怀疑）

# linux - Linux内核：为特定的UDP端口流量注册一个处理程序？

> ID：14242338
> 
> 赞同：0
> 
> 时间：2013-01-09T16:56:37.920
> 
> 标签：linux, sockets, event-handling, linux-kernel, udp

我正在编写一个隧道内核模块，我想为它注册我自己的处理程序以用于特定的 UDP 端口。最好的方法是什么？这个想法是注册该处理程序，以便当该端口上的流量到达时，linux堆栈将调用我的处理程序。

[编辑1]

通过套接字 API 的一种方法是绑定到这样的套接字

```
sin.sin_family = AF_INET;
sin.sin_addr.s_addr = htonl(INADDR_ANY);
sin.sin_port = htons(my_port);

err = kernel_bind(rcv_socket, (struct sockaddr *)&sin,
        sizeof(struct sockaddr_in));

udp_sk(rcv_socket->sk)->encap_rcv = my_handler; 
```

问题是这个套接字与`INADDR_ANY`机器上的任何主机 IP 相关联。我想对数据包中的任何 IP 执行此操作吗？怎样才能做到这一点？

我认为在这种情况下不能使用套接字，因为任何 IP 都意味着在堆栈中数据包通过`ip_forward`路径而不是`ip_local_delivery`. 不会为这样的数据包创建套接字。在这种情况下如何实现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:40:04.363

**TO DOWN VOTER：请评论为什么您对这个久经考验的答案投了反对票？**

以下示例很有帮助。您可以根据需要通过添加过滤器来修改示例。

对于 UDP，以下示例中需要存在以下更改

`sock_raw = socket(AF_INET , SOCK_RAW , IPPROTO_UDP);`

[http://www.binarytides.com/packet-sniffer-code-in-c-using-linux-sockets-bsd/](http://www.binarytides.com/packet-sniffer-code-in-c-using-linux-sockets-bsd/) [http://www.binarytides.com/packet-sniffer-code-in-c-using- linux-sockets-bsd-part-2/](http://www.binarytides.com/packet-sniffer-code-in-c-using-linux-sockets-bsd-part-2/) [相关性]

我列出代码仅供参考

```
#include<netinet/in.h>
#include<errno.h>
#include<netdb.h>
#include<stdio.h> //For standard things
#include<stdlib.h>    //malloc
#include<string.h>    //strlen

#include<netinet/ip_icmp.h>   //Provides declarations for icmp header
#include<netinet/udp.h>   //Provides declarations for udp header
#include<netinet/tcp.h>   //Provides declarations for tcp header
#include<netinet/ip.h>    //Provides declarations for ip header
#include<netinet/if_ether.h>  //For ETH_P_ALL
#include<net/ethernet.h>  //For ether_header
#include<sys/socket.h>
#include<arpa/inet.h>
#include<sys/ioctl.h>
#include<sys/time.h>
#include<sys/types.h>
#include<unistd.h>

void ProcessPacket(unsigned char* , int);
void print_ip_header(unsigned char* , int);
void print_tcp_packet(unsigned char * , int );
void print_udp_packet(unsigned char * , int );
void print_icmp_packet(unsigned char* , int );
void PrintData (unsigned char* , int);

FILE *logfile;
struct sockaddr_in source,dest;
int tcp=0,udp=0,icmp=0,others=0,igmp=0,total=0,i,j; 

int main()
{
    int saddr_size , data_size;
    struct sockaddr saddr;

    unsigned char *buffer = (unsigned char *) malloc(65536); //Its Big!

    logfile=fopen("log.txt","w");
    if(logfile==NULL) 
    {
        printf("Unable to create log.txt file.");
    }
    printf("Starting...\n");

    int sock_raw = socket( AF_PACKET , SOCK_RAW , htons(ETH_P_ALL)) ;
    //setsockopt(sock_raw , SOL_SOCKET , SO_BINDTODEVICE , "eth0" , strlen("eth0")+ 1 );

    if(sock_raw < 0)
    {
        //Print the error with proper message
        perror("Socket Error");
        return 1;
    }
    while(1)
    {
        saddr_size = sizeof saddr;
        //Receive a packet
        data_size = recvfrom(sock_raw , buffer , 65536 , 0 , &saddr , (socklen_t*)&saddr_size);
        if(data_size <0 )
        {
            printf("Recvfrom error , failed to get packets\n");
            return 1;
        }
        //Now process the packet
        ProcessPacket(buffer , data_size);
    }
    close(sock_raw);
    printf("Finished");
    return 0;
}

void ProcessPacket(unsigned char* buffer, int size)
{
    //Get the IP Header part of this packet , excluding the ethernet header
    struct iphdr *iph = (struct iphdr*)(buffer + sizeof(struct ethhdr));
    ++total;
    switch (iph->protocol) //Check the Protocol and do accordingly...
    {
        case 1:  //ICMP Protocol
            ++icmp;
            print_icmp_packet( buffer , size);
            break;

        case 2:  //IGMP Protocol
            ++igmp;
            break;

        case 6:  //TCP Protocol
            ++tcp;
            print_tcp_packet(buffer , size);
            break;

        case 17: //UDP Protocol
            ++udp;
            print_udp_packet(buffer , size);
            break;

        default: //Some Other Protocol like ARP etc.
            ++others;
            break;
    }
    printf("TCP : %d   UDP : %d   ICMP : %d   IGMP : %d   Others : %d   Total : %d\r", tcp , udp , icmp , igmp , others , total);
}

void print_ethernet_header(unsigned char* Buffer, int Size)
{
    struct ethhdr *eth = (struct ethhdr *)Buffer;

    fprintf(logfile , "\n");
    fprintf(logfile , "Ethernet Header\n");
    fprintf(logfile , "   |-Destination Address : %.2X-%.2X-%.2X-%.2X-%.2X-%.2X \n", eth->h_dest[0] , eth->h_dest[1] , eth->h_dest[2] , eth->h_dest[3] , eth->h_dest[4] , eth->h_dest[5] );
    fprintf(logfile , "   |-Source Address      : %.2X-%.2X-%.2X-%.2X-%.2X-%.2X \n", eth->h_source[0] , eth->h_source[1] , eth->h_source[2] , eth->h_source[3] , eth->h_source[4] , eth->h_source[5] );
    fprintf(logfile , "   |-Protocol            : %u \n",(unsigned short)eth->h_proto);
}

void print_ip_header(unsigned char* Buffer, int Size)
{
    print_ethernet_header(Buffer , Size);

    unsigned short iphdrlen;

    struct iphdr *iph = (struct iphdr *)(Buffer  + sizeof(struct ethhdr) );
    iphdrlen =iph->ihl*4;

    memset(&source, 0, sizeof(source));
    source.sin_addr.s_addr = iph->saddr;

    memset(&dest, 0, sizeof(dest));
    dest.sin_addr.s_addr = iph->daddr;

    fprintf(logfile , "\n");
    fprintf(logfile , "IP Header\n");
    fprintf(logfile , "   |-IP Version        : %d\n",(unsigned int)iph->version);
    fprintf(logfile , "   |-IP Header Length  : %d DWORDS or %d Bytes\n",(unsigned int)iph->ihl,((unsigned int)(iph->ihl))*4);
    fprintf(logfile , "   |-Type Of Service   : %d\n",(unsigned int)iph->tos);
    fprintf(logfile , "   |-IP Total Length   : %d  Bytes(Size of Packet)\n",ntohs(iph->tot_len));
    fprintf(logfile , "   |-Identification    : %d\n",ntohs(iph->id));
    //fprintf(logfile , "   |-Reserved ZERO Field   : %d\n",(unsigned int)iphdr->ip_reserved_zero);
    //fprintf(logfile , "   |-Dont Fragment Field   : %d\n",(unsigned int)iphdr->ip_dont_fragment);
    //fprintf(logfile , "   |-More Fragment Field   : %d\n",(unsigned int)iphdr->ip_more_fragment);
    fprintf(logfile , "   |-TTL      : %d\n",(unsigned int)iph->ttl);
    fprintf(logfile , "   |-Protocol : %d\n",(unsigned int)iph->protocol);
    fprintf(logfile , "   |-Checksum : %d\n",ntohs(iph->check));
    fprintf(logfile , "   |-Source IP        : %s\n",inet_ntoa(source.sin_addr));
    fprintf(logfile , "   |-Destination IP   : %s\n",inet_ntoa(dest.sin_addr));
}

void print_tcp_packet(unsigned char* Buffer, int Size)
{
    unsigned short iphdrlen;

    struct iphdr *iph = (struct iphdr *)( Buffer  + sizeof(struct ethhdr) );
    iphdrlen = iph->ihl*4;

    struct tcphdr *tcph=(struct tcphdr*)(Buffer + iphdrlen + sizeof(struct ethhdr));

    int header_size =  sizeof(struct ethhdr) + iphdrlen + tcph->doff*4;

    fprintf(logfile , "\n\n***********************TCP Packet*************************\n");  

    print_ip_header(Buffer,Size);

    fprintf(logfile , "\n");
    fprintf(logfile , "TCP Header\n");
    fprintf(logfile , "   |-Source Port      : %u\n",ntohs(tcph->source));
    fprintf(logfile , "   |-Destination Port : %u\n",ntohs(tcph->dest));
    fprintf(logfile , "   |-Sequence Number    : %u\n",ntohl(tcph->seq));
    fprintf(logfile , "   |-Acknowledge Number : %u\n",ntohl(tcph->ack_seq));
    fprintf(logfile , "   |-Header Length      : %d DWORDS or %d BYTES\n" ,(unsigned int)tcph->doff,(unsigned int)tcph->doff*4);
    //fprintf(logfile , "   |-CWR Flag : %d\n",(unsigned int)tcph->cwr);
    //fprintf(logfile , "   |-ECN Flag : %d\n",(unsigned int)tcph->ece);
    fprintf(logfile , "   |-Urgent Flag          : %d\n",(unsigned int)tcph->urg);
    fprintf(logfile , "   |-Acknowledgement Flag : %d\n",(unsigned int)tcph->ack);
    fprintf(logfile , "   |-Push Flag            : %d\n",(unsigned int)tcph->psh);
    fprintf(logfile , "   |-Reset Flag           : %d\n",(unsigned int)tcph->rst);
    fprintf(logfile , "   |-Synchronise Flag     : %d\n",(unsigned int)tcph->syn);
    fprintf(logfile , "   |-Finish Flag          : %d\n",(unsigned int)tcph->fin);
    fprintf(logfile , "   |-Window         : %d\n",ntohs(tcph->window));
    fprintf(logfile , "   |-Checksum       : %d\n",ntohs(tcph->check));
    fprintf(logfile , "   |-Urgent Pointer : %d\n",tcph->urg_ptr);
    fprintf(logfile , "\n");
    fprintf(logfile , "                        DATA Dump                         ");
    fprintf(logfile , "\n");

    fprintf(logfile , "IP Header\n");
    PrintData(Buffer,iphdrlen);

    fprintf(logfile , "TCP Header\n");
    PrintData(Buffer+iphdrlen,tcph->doff*4);

    fprintf(logfile , "Data Payload\n");    
    PrintData(Buffer + header_size , Size - header_size );

    fprintf(logfile , "\n###########################################################");
}

void print_udp_packet(unsigned char *Buffer , int Size)
{

    unsigned short iphdrlen;

    struct iphdr *iph = (struct iphdr *)(Buffer +  sizeof(struct ethhdr));
    iphdrlen = iph->ihl*4;

    struct udphdr *udph = (struct udphdr*)(Buffer + iphdrlen  + sizeof(struct ethhdr));

    int header_size =  sizeof(struct ethhdr) + iphdrlen + sizeof udph;

    fprintf(logfile , "\n\n***********************UDP Packet*************************\n");

    print_ip_header(Buffer,Size);           

    fprintf(logfile , "\nUDP Header\n");
    fprintf(logfile , "   |-Source Port      : %d\n" , ntohs(udph->source));
    fprintf(logfile , "   |-Destination Port : %d\n" , ntohs(udph->dest));
    fprintf(logfile , "   |-UDP Length       : %d\n" , ntohs(udph->len));
    fprintf(logfile , "   |-UDP Checksum     : %d\n" , ntohs(udph->check));

    fprintf(logfile , "\n");
    fprintf(logfile , "IP Header\n");
    PrintData(Buffer , iphdrlen);

    fprintf(logfile , "UDP Header\n");
    PrintData(Buffer+iphdrlen , sizeof udph);

    fprintf(logfile , "Data Payload\n");    

    //Move the pointer ahead and reduce the size of string
    PrintData(Buffer + header_size , Size - header_size);

    fprintf(logfile , "\n###########################################################");
}

void print_icmp_packet(unsigned char* Buffer , int Size)
{
    unsigned short iphdrlen;

    struct iphdr *iph = (struct iphdr *)(Buffer  + sizeof(struct ethhdr));
    iphdrlen = iph->ihl * 4;

    struct icmphdr *icmph = (struct icmphdr *)(Buffer + iphdrlen  + sizeof(struct ethhdr));

    int header_size =  sizeof(struct ethhdr) + iphdrlen + sizeof icmph;

    fprintf(logfile , "\n\n***********************ICMP Packet*************************\n"); 

    print_ip_header(Buffer , Size);

    fprintf(logfile , "\n");

    fprintf(logfile , "ICMP Header\n");
    fprintf(logfile , "   |-Type : %d",(unsigned int)(icmph->type));

    if((unsigned int)(icmph->type) == 11)
    {
        fprintf(logfile , "  (TTL Expired)\n");
    }
    else if((unsigned int)(icmph->type) == ICMP_ECHOREPLY)
    {
        fprintf(logfile , "  (ICMP Echo Reply)\n");
    }

    fprintf(logfile , "   |-Code : %d\n",(unsigned int)(icmph->code));
    fprintf(logfile , "   |-Checksum : %d\n",ntohs(icmph->checksum));
    //fprintf(logfile , "   |-ID       : %d\n",ntohs(icmph->id));
    //fprintf(logfile , "   |-Sequence : %d\n",ntohs(icmph->sequence));
    fprintf(logfile , "\n");

    fprintf(logfile , "IP Header\n");
    PrintData(Buffer,iphdrlen);

    fprintf(logfile , "UDP Header\n");
    PrintData(Buffer + iphdrlen , sizeof icmph);

    fprintf(logfile , "Data Payload\n");    

    //Move the pointer ahead and reduce the size of string
    PrintData(Buffer + header_size , (Size - header_size) );

    fprintf(logfile , "\n###########################################################");
}

void PrintData (unsigned char* data , int Size)
{
    int i , j;
    for(i=0 ; i < Size ; i++)
    {
        if( i!=0 && i%16==0)   //if one line of hex printing is complete...
        {
            fprintf(logfile , "         ");
            for(j=i-16 ; j<i ; j++)
            {
                if(data[j]>=32 && data[j]<=128)
                    fprintf(logfile , "%c",(unsigned char)data[j]); //if its a number or alphabet

                else fprintf(logfile , "."); //otherwise print a dot
            }
            fprintf(logfile , "\n");
        } 

        if(i%16==0) fprintf(logfile , "   ");
            fprintf(logfile , " %02X",(unsigned int)data[i]);

        if( i==Size-1)  //print the last spaces
        {
            for(j=0;j<15-i%16;j++) 
            {
              fprintf(logfile , "   "); //extra spaces
            }

            fprintf(logfile , "         ");

            for(j=i-i%16 ; j<=i ; j++)
            {
                if(data[j]>=32 && data[j]<=128) 
                {
                  fprintf(logfile , "%c",(unsigned char)data[j]);
                }
                else
                {
                  fprintf(logfile , ".");
                }
            }

            fprintf(logfile ,  "\n" );
        }
    }
} 
```

在 Linux 上运行带有前缀“sudo”的代码。:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-11T09:36:14.037

我不知道相关的内核级功能，但我建议绑定到监听第 2 层帧的 RAW SOCKET，并进一步过滤 ip 数据包。

像这样：

`fd = socket(PF_PACKET, SOCK_RAW, htons(ETH_P_IP));`

然后由您来分析框架并仅提取您需要的 udp 数据包。

在第 2 层工作应该可以让您交付 100% 的 ip 数据包通过您的主机。

# java - java clickable-through non transparent 透明可点击jframe中的组件

> ID：14242342
> 
> 赞同：2
> 
> 时间：2013-01-09T16:56:50.940
> 
> 标签：java, linux, swing, transparent, always-on-top

操作系统 = Ubuntu；JDK = 1.7.0_10

一般的：

我想要的是通常作为桌面小部件可用的东西（例如，为 compiz 或 gromit 注释），有没有办法在 Java 中做到这一点？

我想创建一个全屏、透明、可点击且始终位于顶部的 jframe 或窗口。在 jframe 内，我想添加/删除要定位在屏幕特定点上的组件（文本、图像、矩形......）。这些组件应该是不透明的，并且始终位于顶部。如果可能，他们应该允许点击。

示例：我的桌面上打开了几个应用程序。我想自动在窗口周围绘制一个框，该框在焦点上绘制一个矩形，矩形的区域应该是透明且可点击的，以便允许我使用我的应用程序。

问题：

我可以创建一个保持在顶部但不可点击的透明框架，但我将添加到框架的组件在任何情况下都是透明的。

```
JFrame frame = new JFrame("MyFrame");
frame.setPreferredSize(Toolkit.getDefaultToolkit().getScreenSize());
frame.setLocation(0,0);
frame.setExtendedState(Frame.MAXIMIZED_BOTH); 
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
frame.setUndecorated(true);
frame.setAlwaysOnTop(true);
frame.setAlwaysOnTop(true);
//frame.getRootPane().putClientProperty("apple.awt.draggableWindowBackground", false);     //apple
frame.getContentPane().setLayout(new BorderLayout());
System.setProperty("sun.java2d.noddraw", "true");
AWTUtilities.setWindowOpaque(frame, false);
AWTUtilities.setWindowOpacity(frame, 0.0f);
JLabel label = new JLabel("Hello NOT transparent label");
label.setOpaque(true);
label.setBackground(new Color(255, 0, 0));
frame.getContentPane().add(label);
frame.pack();
frame.setVisible(true); 
```

我可以通过使用从 URL 加载的透明图像设置 IconImage 来使框架透明且可点击。如果图像是从 URL 加载的，但如果我从本地文件加载图像则不行（为什么？！？）。同样在这种情况下，当我将组件添加到框架时不会显示。

```
try {
frame.setIconImage(Toolkit.getDefaultToolkit().getImage(new URL("http://i.imgur.com/xtZK0.png")));
} catch (MalformedURLException e) {e.printStackTrace();} 
```

我尝试添加 JFXPanel 但没有成功，我尝试将组件添加到 GlassPane 但没有成功..

经过一周的密集测试和搜索，我希望有人能给我一个解决方案或正确的提示。

谢谢。

# .htaccess - .htaccess RewriteCond 特异性

> ID：14242343
> 
> 赞同：0
> 
> 时间：2013-01-09T16:56:53.287
> 
> 标签：.htaccess

我正在使用 htaccess 从网址中删除我的 index.php 文件。我有一个 RewriteCond 设置来忽略某些文件和文件夹。我的问题是，我需要忽略一个名为“test”的目录，但是当前编写的条件也忽略了以字母 test 开头的任何内容，因此我的“testimonials”目录也被忽略了。有没有办法让我的 RewriteCond 更具体，所以它会忽略“测试”而不是“推荐”？

这是我现有的代码：

```
# Removes index.php
RewriteCond $1 !^(admin|assets|test|index\.php|info\.php|robots\.txt) [NC]
RewriteRule ^(.*)$ index.php?/$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:01:43.400

RewriteCond $1 !^(admin|assets|\/test\/|index.php|info.php|robots.txt) [NC]

# java - Java，Serialization，能不能在一个类中序列化一个类

> ID：14242356
> 
> 赞同：2
> 
> 时间：2013-01-09T16:57:24.890
> 
> 标签：java

> **可能重复：**
> [为什么可序列化的内部类不可序列化？](https://stackoverflow.com/questions/7144912/why-is-a-serializable-inner-class-not-serializable)

我有一个没有实现的类`Serializable`。在该类内部，我有一个数据类，它保存整个程序的数据，该程序实现`Serializable`并具有版本 ID。

我的问题是，当我尝试在主类中序列化数据对象时，我从主类而不是数据类中收到对象写入错误。主类没有实现`Serializable`。

你能在一个不可序列化的类中序列化一个类吗？

例子：

```
class main
{
   class data implements Serializable
   {  // data and functions }

   public void main(args)
   { data d = new data();
     // ofcourse I have the proper inits and checks for the output stream and such
     writeObject(data);  // Throws Class not Serializable error.}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:03:28.720

`data`不是`static`它隐式地引用了它`main`的不可序列化的外部类。

尝试制作课程`static`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:07:43.720

如果你反编译你的 main.class 你会在真实的代码中看到

```
public class main {

    class data implements Serializable {
        final main this$0;

        data() {
            this$0 = main.this;
        }
    }
} 
```

`data`包含对其外部类的引用`main`。这个所谓的合成字段是由 javac 添加的。当 ObjectOutputStream 尝试序列化数据时，它偶然发现对不可序列化类的引用并中断。因此，要可序列化，您也应该`main`实现 Serializable，或者创建`data`静态类，然后引用`main`将去

# php - 服务器上的 PDF 到 HTML 转换？

> ID：14242357
> 
> 赞同：2
> 
> 时间：2013-01-09T16:57:26.727
> 
> 标签：php, html, pdf, pdf-generation

是否有可能仅使用 PHP 读取服务器上的 PDF 文件并向用户发送类似 HTML 的结果？

我是网络开发的新手。如果可能的话，只需要一个关于“如何做”的快速而简短的指南。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:42:36.723

试试 DocRaptor ，把 PDF 发给他们，他们会给你 HTML，他们很可靠，我经常使用他们的服务。

[http://doraptor.com/try_it_out](http://docraptor.com/try_it_out)

或者如果你想自己做，这个开源软件应该在你的服务器上运行

[http://pdftohtml.sourceforge.net/](http://pdftohtml.sourceforge.net/)

（或任何你认为合适的东西）

# css - 针对特定分辨率 CSS 媒体查询

> ID：14242368
> 
> 赞同：5
> 
> 时间：2013-01-09T16:57:58.923
> 
> 标签：css, media-queries, screen-resolution

我有一个疯狂的网络应用程序正在运行，具有各种动态宽度和高度以及垂直居中的东西。除了 1366x768 和 1280x800 之外，它几乎在所有分辨率下看起来都很棒。我知道如何使用一些 CSS 规则覆盖来修复它。我只想定位这些特定的分辨率（这意味着我不想定位 1280x1024 的最小宽度：1280 和最大宽度：1280）。请不要告诉我最佳实践和东西，我需要一个快速而肮脏的答案。

我怎样才能做到这一点？令人惊讶的是，谷歌并没有给我任何好的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:03:18.690

你可以使用：

```
@media screen and (min-width: 1280px) and (max-width: 1280px)
              and (min-height: 800px) and (max-height: 800px) {
    /* Crazy CSS overrides here */
}
/* Second variant left as an exercise for the reader */ 
```

但是，如果您现在花时间进行重构，从长远来看，您可能会做得更好 - 以后似乎永远不会到达这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-20T07:19:21.177

尝试这个：

```
@media screen and (max-width: 1280px) and (max-height: 800px)
{
/*write CSS here*/
} 
```

# ruby-on-rails - 使用隐藏字段和萤火虫保护导轨？

> ID：14242374
> 
> 赞同：0
> 
> 时间：2013-01-09T16:58:24.873
> 
> 标签：ruby-on-rails, ruby

我正在开发一个 Web 应用程序，令我困扰的是用户可以使用 firebug 来操作代码。

```
<%= form_for([@journal, @news]) do |f| %>
  <div class="field">
    <%= f.label :title %>
    <%= f.text_field :title %>
  </div>

  <%= f.hidden_field :journal %>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

**路线.rb**

```
resources :journal do 
  resources: news
end 
```

网址看起来像 mysite.com/journal/1/news/3。由于日记 ID 在 url 中，我如何防止用户将日记 ID 值 1 更改为 2 或 3。

```
<input id="news_journal_id" type="hidden" value="1" name="news[journal_id]"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:00:36.417

您无法阻止用户向您发送修改后的输入。您可以（并且应该）检查服务器上的输入，而不是盲目地接受它。

如果用户不能读/写这个日志，将他重定向到相应的页面，等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:01:07.267

你不能。永远不要相信来自任何地方的输入。实现任何类型的服务器端验证/角色模型/访问限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:19:07.190

您应该使用 current_user 关联来获取任何记录，以确保您的应用程序安全。

例如：

```
journal = currect_user.journals.find(params[:news][:journal_id])
journal.news.create(params[:news].except(:journal_id)) 
```

# android - 根据堆栈或内联选项卡更改 TabText 外观

> ID：14242381
> 
> 赞同：1
> 
> 时间：2013-01-09T16:58:34.460
> 
> 标签：android, xml, android-actionbar, actionbarsherlock

我正在尝试更改操作栏选项卡中文本的样式。当它们堆叠（在操作栏下方）时，我希望文本为黑色，当它们在操作栏内时，我希望文本为白色。我已经基于此成功自定义了背景，但如果可能的话，我不知道该怎么做。

# java - ServletContextListener 严重：配置类 marktest.Config 的应用程序侦听器时出错

> ID：14242382
> 
> 赞同：9
> 
> 时间：2013-01-09T16:58:35.207
> 
> 标签：java, web-services, tomcat, jersey, tomcat7

我的 Java servlet 似乎在抱怨它找不到包中包含的文件（marktest）。我使用 Eclipse (Indigo) 开发和 Tomcat7。

这是错误：

```
SEVERE: Error configuring application listener of class marktest.Config
java.lang.ClassNotFoundException: marktest.Config
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:415)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:397)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:118)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4660)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5226)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5221)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679) 
```

这是 Config.java，其中包含实现 ServletContextListener 的类，它说它在错误中找不到：

```
package marktest;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

public class Config implements ServletContextListener 
{

    private ExecutorService executor;

    @Override
    public void contextInitialized(ServletContextEvent event) 
    {
        System.out.println("########################## ServletContextListener started ###############################");

    }

    @Override
    public void contextDestroyed(ServletContextEvent event) {
    }

} 
```

这是 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>de.vogella.jersey.first</display-name>
  <servlet>
    <servlet-name>Jersey REST Service</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>

    <init-param>
      <param-name>com.sun.jersey.config.property.packages</param-name>
      <param-value>marktest</param-value>
    </init-param>

    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Jersey REST Service</servlet-name>
    <url-pattern>/rest/*</url-pattern>
  </servlet-mapping>

    <listener>
        <listener-class>marktest.Config</listener-class>
    </listener>

</web-app> 
```

即使经过大量谷歌搜索，我也很困惑。在此先感谢您的帮助。

标记

- - 编辑 - -

以下是完整的控制台日志

```
10-Jan-2013 15:45:18 org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:nlpServer' did not find a matching property.
10-Jan-2013 15:45:18 org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
10-Jan-2013 15:45:18 org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 661 ms
10-Jan-2013 15:45:18 org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
10-Jan-2013 15:45:18 org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.21
########################## ServletContextListener started ###############################
10-Jan-2013 15:45:19 org.apache.catalina.util.SessionIdGenerator createSecureRandom
INFO: Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [1,052] milliseconds.
10-Jan-2013 15:45:19 com.sun.jersey.api.core.PackagesResourceConfig init
INFO: Scanning for root resource and provider classes in the packages:
  marktest
10-Jan-2013 15:45:19 com.sun.jersey.api.core.ScanningResourceConfig logClasses
INFO: Root resource classes found:
  class marktest.hello
10-Jan-2013 15:45:19 com.sun.jersey.api.core.ScanningResourceConfig init
INFO: No provider classes found.
10-Jan-2013 15:45:19 com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.16 11/28/2012 02:09 PM'
10-Jan-2013 15:45:20 org.apache.catalina.core.StandardContext listenerStart
SEVERE: Error configuring application listener of class marktest.Config
java.lang.ClassNotFoundException: marktest.Config
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:415)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:397)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:118)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4660)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5226)
    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5221)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)
10-Jan-2013 15:45:20 org.apache.catalina.core.StandardContext listenerStart
SEVERE: Skipped installing application listeners due to previous error(s)
10-Jan-2013 15:45:20 org.apache.catalina.core.StandardContext startInternal
SEVERE: Error listenerStart
10-Jan-2013 15:45:20 org.apache.catalina.core.StandardContext startInternal
SEVERE: Context [] startup failed due to previous errors
10-Jan-2013 15:45:20 org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
10-Jan-2013 15:45:20 org.apache.catalina.startup.Catalina start
INFO: Server startup in 2538 ms
10-Jan-2013 15:45:24 org.apache.catalina.core.StandardServer await
INFO: A valid shutdown command was received via the shutdown port. Stopping the Server instance.
10-Jan-2013 15:45:24 org.apache.coyote.AbstractProtocol pause
INFO: Pausing ProtocolHandler ["http-bio-8080"]
10-Jan-2013 15:45:25 org.apache.catalina.core.StandardService stopInternal
INFO: Stopping service Catalina
10-Jan-2013 15:45:25 org.apache.catalina.util.LifecycleBase stop
INFO: The stop() method was called on component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]] after stop() had already been called. The second call will be ignored.
10-Jan-2013 15:45:25 org.apache.coyote.AbstractProtocol stop
INFO: Stopping ProtocolHandler ["http-bio-8080"]
10-Jan-2013 15:45:25 org.apache.coyote.AbstractProtocol destroy
INFO: Destroying ProtocolHandler ["http-bio-8080"] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-24T19:24:27.443

在我看来，好像您的类没有通过 WTP 正确部署到 Tomcat（再次清理/发布）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-25T15:12:10.400

即使我`ClassNotFoundException`之前在给定快照中突出显示的在 tomcat 服务器 web.xml 中配置的侦听器类条目时也得到了相同的结果 - [Eclipse 项目配置快照](https://i.stack.imgur.com/ItVGd.png)

收到此错误后，我已将同一条目从 tomcat config **Web.xml**替换 为 **{Project_Path}/WebContent/WEB-INF/web.xml。**

发布错误在tomcat服务器启动时解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:58:49.757

这个问题可以关闭，结果发现eclipse有问题并且没有发布我的更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-18T21:43:16.110

导致删除库源或在构建路径中移动一个。确保在构建路径 > 库中没有任何遗漏的库。

清理项目并再次运行tomcat。这会有所帮助。

# java - 简单的 Java OAuth 示例

> ID：14242383
> 
> 赞同：1
> 
> 时间：2013-01-09T16:58:40.510
> 
> 标签：java, rest, ssl, oauth

我正在尝试将 Stripe（支付处理器）与 Tomcat/JSP 应用程序集成。除了最初的 OAuth2 连接外，他们大部分都有一个库。

不是 Java/Net 程序员，我很难理解用 Java 实现 REST api。

他们的文档没有很好地涵盖 Java，但是 cURL 示例“应该”很容易使用。

基本上我需要模拟这个：

```
curl -X POST https://connect.stripe.com/oauth/token \
-H "Authorization: Bearer sk_test_123123123123" \
-d code=AUTHORIZATION_CODE \
-d grant_type=authorization_code 
```

然后我需要解析 JSON 响应。

谁能给我提供一个代码片段来帮助我解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:28:34.003

我会使用[Java OAuth 库](http://oauth.googlecode.com/svn/code/java/core/)来处理代码的 OAuth 部分。

# jquery - 将 var 设置为属性值

> ID：14242385
> 
> 赞同：1
> 
> 时间：2013-01-09T16:58:48.233
> 
> 标签：jquery, html

我有一个 jQuery 脚本，它为每个 div 提供自己的 data-page-index 属性作为数字，我有变量可以提取特定的 data-page-index 值并将它们转换为整数以进行某些计算，但我需要重新应用这个使用其 var 名称的数字，例如，

```
var foo =  parseInt(active.attr('data-page-index')),
    next = (foo+1)
    nextfoo = $('[data-page-index="'' +next+ '"]') 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:01:33.477

是的，有可能。您的问题是一个小的语法错误。你在那里有一个额外的单引号。

```
nextfoo = $('[data-page-index="'' +next+ '"]')
/* -----------------------------^---------- */ 
```

由于语法突出显示存在问题，因此可以在 Stack Overflow 上看到此处。您的 IDE 也应该具有相同的效果。

正确的代码应该是这样的（我真的不喜欢在一行上定义多个变量，所以我把它们分开了——

```
var foo =  parseInt(active.attr('data-page-index'));
var next = foo+1;
var nextfoo = $('[data-page-index="' + next + '"]'); 
```

~~我可能是错的......但我认为这`next`是一个保留的关键字。这可能会给您带来一些不可预知的问题...我建议您也更改该变量的名称...~~ [不相关](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:02:48.237

绝对地 ：

```
var foo =  parseInt(active.attr('data-page-index')),
next = (foo+1) // <---parse this one too
nextfoo = $('[data-page-index="'' +next+ '"]')
   //---------------------------^--------------you have extra (') here 
```

它应该是 ：

```
var foo =  parseInt(active.attr('data-page-index')),
next = parseInt(foo+1);
nextfoo = $('[data-page-index="' +next+ '"]'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:01:10.647

试试这个：

```
var foo =  parseInt(active.data('page-index')),
next = (foo + 1)
nextfoo = $('[data-page-index="' + next + '"]') 
```

`''`您在属性选择器中有一个错误的 double 。

# php - 致命错误..在非对象上调用成员函数..

> ID：14242388
> 
> 赞同：3
> 
> 时间：2013-01-09T16:59:03.437
> 
> 标签：php

我有一个`GCM`包含 send_notification 函数的类。在另一个类中`Demand.php`，我正在尝试使用 send_notification 函数。所以我有一个构造函数，`Demand.php`它指向我的`GCM`类，如下所示：

```
 $gcm = new GCM(); 
```

该`$gcm`变量在该类内部的函数中使用，如下所示：

```
$result = $gcm->send_notification($registatoin_ids, $message); 
```

这就是我得到错误的地方：

```
<br />n<b>Fatal error</b>:  Call to a member function send_notification() on a non-object in.. 
```

我搜索了这个问题，发现问题`$gcm`是空的，这就是它什么都不叫的原因。所以当我把

```
$gcm = new GCM(); 
```

在我的函数内部它工作正常。但是没有其他方法可以做到这一点吗？我的意思是不应该仅仅通过将创建`$gcm`放在构造函数中`Demand.php`吗？

以下是我所指的部分：

```
function __construct() {
    require_once 'GCM.php';
    require_once 'DB_Connect.php';
    require_once 'DB_Functions.php';
    // connecting to database
    $this->db = new DB_Connect();
    $this->db->connect();
    $gcm = new GCM();
    $df = new DB_Functions();

}

// destructor
function __destruct() {

}

public function getDistance($uuid, $name, $distance, $latstart, $lonstart, $latend, $lonend, $gcm_regId) {
    $user_new = array ("$uuid", "$name", "$distance","$latstart", "$lonstart", "$latend", "$lonend","$gcm_regId");  
    $query = sprintf("SELECT uid, distance,latstart, lonstart, latend, lonend, gcm_regid, name FROM user_demand WHERE latstart='%s' AND lonstart='%s'",
    mysql_real_escape_string($latstart),
    mysql_real_escape_string($lonstart));
    $user = mysql_query($query);

    $no_of_rows = mysql_num_rows($user);

    while($user_old = mysql_fetch_assoc($user))
    {
        $djson = $this->findDistance($latend,$lonend,$user_old["latend"],$user_old["lonend"] );

        if ($user_old["distance"]+$distance>=$djson) {
            $match = mysql_query("INSERT INTO matched_users(gcm_a, gcm_b, name_a, name_b) VALUES(".$user_old['gcm_regid'].",".$user_new['gcm_regId'].",".$user_old['name'].",".$user_new['name'].")");
            $registatoin_ids = array($gcm_regId);
            $message = array("var" => $name);
            $result = $gcm->send_notification($registatoin_ids, $message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T17:03:59.677

如果您放入`$gcm = new GCM();`Demand 类的构造函数，则该变量`$gcm`将仅在构造函数方法中可用。

如果您希望能够在`$gcm`整个 Demand 类中访问该变量，则需要将其设置为该类的属性，如下所示：

```
class Demand()
{
    /**
     * Declare the variable as a property of the class here
     */
    public $gcm;

    ...
    function __construct()
    {
        ...
        $this->gcm = new GCM();
        ...
    }

    function myFunction()
    {
        ...
        // You can access the GCM class now in any other method in Demand class like so:
        $result = $this->gcm->send_notification($registatoin_ids, $message);
        ...
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:03:05.650

gcm 将仅在构造函数的范围内可用，除非您将其初始化为实例变量。

```
class Demand
{
    private $_gcm; 
    function __construct() 
    {
        $this->_gcm = new GCM(); 
    }

    function youWantToUseGcmIn()
    {
        $this->_gcm->send_notification(.....); // access it like this 
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:05:40.353

您在对象构造函数中创建 $gcm，然后从同一类中的其他方法使用它？那么你没有正确存储它。你所要做的：

```
class X {
    function constructor() {
        $this->gcm = new GCM();
    }

    function other_method() {
        $this->gcm->send_notification(...);
    }
} 
```

如果你有

```
function constructor() {
    $gcm = new GCM();  <-- this is just a temporary local variable.
} 
```

您所做的只是在构造函数中创建一个局部变量，该变量将在构造函数返回后立即销毁。将新对象保存在 $this->gcm 中会将其保存在包含对象中，并使其可用于其他方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:06:20.680

这意味着`$gcm`不是一个对象，在某些情况下它可能是 NULL 或 false（没有找到），因为它不可访问。超出范围

# ios - 带有包含 X 行的页面的 UITableView

> ID：14242390
> 
> 赞同：0
> 
> 时间：2013-01-09T16:59:18.687
> 
> 标签：ios, uitableview, uiscrollview

我正在尝试实现一个可以逐页水平滚动的**UITableView**，每页包含 10 行（每行具有相同的高度）

我知道**UITableView**扩展了**UIScrollView**但**pagingEnaled** + **contentSize**似乎没有解决问题，所以我被卡住了

基本上我有一个100 行的**UITableView**，我想要 10 页可以水平滚动，我该如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:14:28.897

有2个解决方案：

要么您使用 iOS6 中新添加的[UICollectionView](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionView_class/Reference/Reference.html)（但您需要设置为您的应用程序 iOS6 的最低目标）

或者您在 UIScrollView 中添加 3 个 UITableView，并在新页面显示到 UIScrollView 时移动第一个或最后一个 UITableView。

这里有一个现成的实现：[https ://github.com/arconsis/ARTableViewPager](https://github.com/arconsis/ARTableViewPager)

# iphone - 如何在 IOS 中嵌入 Twitter 提要和/或主题标签

> ID：14242391
> 
> 赞同：2
> 
> 时间：2013-01-09T16:59:22.853
> 
> 标签：iphone, ios, twitter, hashtag, mgtwitterengine

我基本上只需要一个表格视图，它显示来自 tableviewcontroller 中 @username 或 #hashtag 的最近推文。不需要发布推文或类似的东西。

目前我使用`MGTwitterEngine`它很复杂，只获取与用户名相关的推文而不是 hastags。

我找到了这个[教程](http://www.forcegrind.com/2011/07/26/ios-how-to-embed-a-twitter-feed-andor-hashtag-in-your-app/)，但是大部分代码没有解释，也没有源代码。

也找到[这个](http://www.codeproject.com/Articles/312325/Making-a-simple-Twitter-app-using-iOS-5-Xcode-4-2?msg=4444279#xx4444279xx)，但似乎`http://search.twitter.com/search?q=%23`+ #hashtag 返回`nil`数据

还看到这个[问题](https://stackoverflow.com/questions/4860699/twitter-integration-in-iphone-to-read-public-tweets-hashtags-without-using-logi)为 ARC 编辑了代码并使用`http://search.twitter.com/search.json?q=%23epicwinning+OR+%40charliesheen`链接来获取数据

```
#import <Foundation/Foundation.h>

@protocol latestTweetsDelegate
- (void)returnedArray:(NSArray*)tArray;
@end

@interface latestTweets : NSObject
{
    NSMutableData *responseData;
    NSMutableArray *resultsArray;
    id<latestTweetsDelegate> delegate;
}

@property (nonatomic, strong) NSMutableArray *resultsArray;
@property (strong,nonatomic) id<latestTweetsDelegate> delegate;

- (id)initWithTwitterURL:(NSString *)twitterURL;

@end
#import "latestTweets.h"
#import "SBJson.h"

@implementation latestTweets
@synthesize resultsArray, delegate;

- (id)initWithTwitterURL:(NSString *)twitterURL
{
    self = [super init];
    if (self) {
        responseData = [NSMutableData data];
        NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:twitterURL]];
        [[NSURLConnection alloc] initWithRequest:request delegate:self];
    }
    return self;
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {

}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [responseData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {

    NSLog(@"Connection failed: %@", [error description]);
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {

    NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];

    NSArray *newData = [responseString JSONValue];

    [self.delegate returnedArray:newData];
}

@end 
```

我打电话

```
latestTweets *lt = [[latestTweets alloc] initWithTwitterURL:@"http://search.twitter.com/search.json?q=%23epicwinning+OR+%40charliesheen"];
lt.delegate = self; 
```

返回结果数组：`-[TwitterFeed returnedArray:]: unrecognized selector sent to instance`

是否有任何简单的教程或代码示例可以同时获取用户名和主题标签推文？

或者

有没有办法用 获取主题标签`MGTwitterEngine`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-06T14:51:41.257

看看[STTwitter](https://github.com/nst/STTwitter)。

```
STTwitterAPI *twitter =
    [STTwitterAPI twitterAPIApplicationOnlyWithConsumerKey:@""
                                                   consumerSecret:@""];

[twitter verifyCredentialsWithSuccessBlock:^(NSString *bearerToken) {

    [twitter getSearchTweetsWithQuery:@"Snowden"
                         successBlock:^(NSDictionary *searchMetadata, NSArray *statuses) {
        // use the statuses here
    } errorBlock:^(NSError *error) {
        // ...
    }];

} errorBlock:^(NSError *error) {
    // ...
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:22:06.880

您可能需要在有效的示例源代码下方实现自己的方法

试试这个 git

[https://bitbucket.org/wave_1102/hdc2010-iphone/src](https://bitbucket.org/wave_1102/hdc2010-iphone/src)

在您的终端`hg clone https://bitbucket.org/wave_1102/hdc2010-iphone`中输入并获取 git。

`HDC2010ViewController`替换为`win`您的主题标签

```
// search twitter for the HDC10 hashtag and add the tweets to our array
    [ tweetArray addObjectsFromArray:[ tweetFactory recentTweetsForHashTag:@"win" ] ]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-26T21:53:24.497

您可以使用 Twitter Kit 在您的应用程序中显示完整的时间线 ( [https://docs.fabric.io/ios/twitter/show-timelines.html](https://docs.fabric.io/ios/twitter/show-timelines.html) )。

```
class SearchTimelineViewController: TWTRTimelineViewController {

  convenience init() {
    let client = TWTRAPIClient()
    let dataSource = TWTRSearchTimelineDataSource(searchQuery: "#objc", APIClient: client)
     self.init(dataSource: dataSource)

     // Show Tweet actions
     self.showTweetActions = true
  }

} 
```

[![](../Images/f6bd25a77486496a6d3541f5e73fbd6b.png)](https://web.archive.org/web/20160617151945/https://docs.fabric.io/ios/_images/search_timeline_demo.gif)

# asp.net - 从 Windows 服务调用 web 服务

> ID：14242396
> 
> 赞同：0
> 
> 时间：2013-01-09T16:59:38.803
> 
> 标签：asp.net

我有一个引用 asp.net webservice 的 Windows 服务项目。当我通过 VS 在我的机器上本地运行此服务时，它工作正常，当我调用 web 方法时，我得到了我想要的结果。

今天我将它部署到了一个测试服务器，当我调用 web 方法时它失败了，因为它试图连接到本地主机 web 服务，而不是服务器上的那个。我得到的错误是“无法连接到远程服务器-> System.Net.Sockets.SocketException：无法建立连接，因为目标机器主动拒绝它：127.0.0.1”

我的服务有一个 app.config 文件，并且网络服务设置正确指向网络服务 url。我知道 url 是正确的，因为当我将它放入 IE 时，它会解析为 web 服务。Web服务的属性也是正确的。

任何有关该服务如何获取 localhost 的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:05:18.867

可能是 Windows 安全问题。您是否将流程/网络方法称为提升？另外，Windows 防火墙服务是否正在运行？如果是这样，IP/端口/应用程序是否有例外？RPC 正在运行吗？检查凭据和上面列出的那些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:26:39.907

我建议您使用标准 WCF 配置存储您的代理地址。这是一个例子。

```
 <system.serviceModel>
        <bindings>
            <wsHttpBinding>
                <binding name="WSHttpBinding_IService1" />
            </wsHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://yourServerIP:51717/Service1.svc" binding="wsHttpBinding"
                bindingConfiguration="WSHttpBinding_IService1" contract="ServiceReference1.IService1"
                name="WSHttpBinding_IService1">
            </endpoint>
        </client>
    </system.serviceModel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T18:32:34.973

今天在工作中使用以下代码行解决了这个问题。

```
webservice ws = new webservice()   
ws.Url = (new xxxx.Properties.Settings()).WS;
ws.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials; 
```

感谢您的所有帮助，干杯 APW

# javascript - Chrome 和 Firefox 中的 Javascript 提升

> ID：14242399
> 
> 赞同：11
> 
> 时间：2013-01-09T16:59:45.753
> 
> 标签：javascript, google-chrome, firefox, hoisting

在 Chrome 和 Firefox 中运行它会给出不同的答案：

```
(function() {

        if(true) {
            function f() { alert("yes"); };
        } else {
            function f() { alert("no"); };
        }
        f();

    })(); 
```

在 Chrome 中，结果为“否” 在 Firefox 中，结果为“是”

为什么有区别？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-09T17:06:45.497

在条件语句中声明函数是非标准的，所以**不要这样做**。这是一个已知问题。您可以使用函数表达式而不是声明：

```
var f;
if(true) {
    f = function() { alert("yes"); };
} else {
    f = function() { alert("no"); };
}
f(); 
```

关于函数表达式的[著名 Kangax 文章](http://kangax.github.com/nfe/)提供了一些额外的细节：

> *FunctionDeclarations*只允许出现在*Program*或*FunctionBody*中。从语法上讲，它们**不能出现在*Block*** `({ ... })`中——例如 of `if`, `while`or`for`语句。这是因为*Blocks*只能包含*Statements*，而不是*SourceElements*，它是*FunctionDeclaration*。

同一篇文章还说：

> 值得一提的是，根据规范，允许实现引入**语法扩展**（参见第 16 节），但仍然完全符合。这正是如今许多客户所发生的事情。其中一些将块中的函数声明解释为任何其他函数声明——只需将它们提升到封闭范围的顶部；其他——引入不同的语义并遵循稍微复杂的规则。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T17:08:55.537

从 V8（Chrome JavaScript 引擎）[错误跟踪器](http://code.google.com/p/v8/issues/detail?id=437)：

> 不是错误。Firefox 是唯一能满足您期望的浏览器。
> 
> Safari 和 IE 在这方面的行为与 Chrome/V8 的相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-01T12:03:46.627

这是由于 Firefox 缺少 ECMAScript 5 中所设想的函数提升而发生的。

Chrome 在运行函数体之前正确地为 f() 分配了一个值，因此 f() 的第一个版本被第二个版本覆盖。

SpiderMonkey（Firefox 的 JavaScript 引擎）运行代码时没有预先为 f() 赋值，因此它使用在其途中遇到的唯一值：`function f() { alert("yes"); };`

**什么是功能提升？**
JavaScript 的函数作用域意味着在函数中声明的所有变量在整个函数体中都是可见的。奇怪的是，这意味着变量在声明之前甚至是可见的。JavaScript 的这个特性被非正式地称为提升：JavaScript 代码的行为就像函数中的所有变量声明（但不是任何关联的赋值）都被“提升”到函数的顶部。

资料来源：
[http](http://statichtml.com/2011/spidermonkey-function-hoisting.html)
://statichtml.com/2011/spidermonkey-function-hoisting.html 2011 - o'reilly - javascript - 权威指南第 6 版

# javascript - jquery .css 函数不稳定行为的问题

> ID：14242400
> 
> 赞同：1
> 
> 时间：2013-01-09T16:59:59.020
> 
> 标签：javascript, jquery, css

我的`jquery .css`功能有问题。我正在使用它来获取高度设置为自动的元素的实际高度。我正在使用的代码是：

```
$(this).css({ height: $(this).css("height"), width: $(this).css("width") }); 
```

问题是，该`.css`函数有时有时会返回`"0px"`实际`"auto"`高度（这是所需的行为）。谁能告诉我我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:03:55.637

`$(this).css("height")`为您提供定义的（或默认）值，同时`$(this).height()`为您提供*实际*的“测量”高度。

来自[http://api.jquery.com/height/](http://api.jquery.com/height/)：

> 获取匹配元素集中第一个元素的当前计算高度或设置每个匹配元素的高度。

并来自[http://api.jquery.com/css/](http://api.jquery.com/css/)：

> 获取匹配元素集中第一个元素的样式属性值，或为每个匹配元素设置一个或多个 CSS 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:04:11.907

`$(this).css("height")`将返回 CSS`height`属性的设置值。

要获取元素的物理高度，请调用`$(this).height()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:03:00.213

看不到您的代码段的目的，但使用 jquery，使用至少是跨浏览器的代码：

```
$(this).css({ height: $(this).height(), width: $(this).width() }); 
```

# node.js - Node.js process.hrtime() 基准测试错误

> ID：14242405
> 
> 赞同：2
> 
> 时间：2013-01-09T17:00:16.217
> 
> 标签：node.js

前几天我刚刚发现 Node.js 有一个高分辨率的计时器函数，叫做

[进程.hrtime](http://nodejs.org/api/process.html#process_process_hrtime)

这个计时器据说具有纳秒级分辨率，这太棒了，因为现在我可以比 Date 模块更准确地计时。

无论如何，我正在使用这个新计时器来尝试制作一个 Timer 对象，该对象可以为传递给它的不同任务计时。不幸的是，我得到了一些奇怪的负面结果，这让我质疑这个所谓的“高分辨率”计时器的准确性和可靠性。

让我向您展示我的代码：

hrTimer.js

```
//IMPORTS
var async = require('async');

HrTimer = {

    time: function(task) {
        var t1 = t2 = '';

        async.series([
            function(callback){
                t1 = process.hrtime();
                callback();
            },
            task,
            function(callback){
                t2 = process.hrtime();
                callback();
            }
        ]);

        var t1 = t1[0].toString() + '.' + t1[1].toString();
        var t2 = t2[0].toString() + '.' + t2[1].toString();

        var dif = parseFloat(t2)-parseFloat(t1);

        if(dif < 0){

            debugger;
            console.log(t1);
            console.log(t2);
        }

        return dif;
    }
};

module.exports = HrTimer; 
```

所以有时它会进入 dif < 0 的代码块。如果异步模块正常工作并且计时器正常工作，这不应该发生。有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T17:20:08.777

您正在处理的值不是浮点数！您不能只是附加值来获得浮点值。例如，如果时间是 1 秒和 1 纳秒，则浮点值将是`1.000000001`，而不是`1.1`。此外，`hrtime`可以带一个参数来查找两个值之间的差异。

您需要像这样处理值：

```
var t2 = process.hrtime(t1); 
```

如您所知，这将返回数组中的值。我建议只使用数组值。

也就是说，你所拥有的也不会异步工作，所以要么放弃`async.series`调用，就这样做：

```
var t1 = process.hrtime();
task();
return process.hrtime(t1); 
```

或异步实现它：

```
time: function(task, doneCb) {
    var t1 = process.hrtime();
    task(function(){
      doneCb(process.hrtime(t1));
    });
} 
```

# javascript - 查找用户在 iframe 中单击的元素

> ID：14242407
> 
> 赞同：0
> 
> 时间：2013-01-09T17:00:18.163
> 
> 标签：javascript, iframe, editor, wysiwyg

我正在使用一个 HTML 编辑器`iframe`，我希望用户能够在添加后调整图像大小。因此，当用户单击内部的图像时，`iframe`就会运行一个侦听器。但它给我的只是body标签而不是点击的元素。我已经尝试了很多方法，但似乎都没有奏效。

我在这个领域的代码是：

//网站展示的是iframe

//iframeBody是iframe内body的id

```
siteDisplay.document.getElementById('iframeBody').addEventListener("click", testForClicks, false); 

function testForClicks(){

 console.log(siteDisplay.document.activeElement);

 console.log(this);

 //both give me bodytag

} 
```

我需要点击元素或突出显示元素

任何帮助都会很棒，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:03:52.250

如果您需要*突出显示*的（或*活动*的）元素，您可以使用`Selection`/ [`Range`](https://developer.mozilla.org/en-US/docs/DOM/range)（链接）API

```
var selection = window.getSelection();
var range = selection.getRangeAt(0);
var firstNode = range.startContainer;
// etc. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T21:44:37.387

iframe 就像在您的窗口内打开的单独窗口。所以，

```
iframe = document.getElementById('YourIframeId');
iframe.contentDocument.getElementById('innerIframeElementId').addEventListen...... 
```

这将起作用。此外，如果您想访问 iframe 窗口，请执行以下操作：

```
iframe.contentWindow. 
```

希望这可以帮助。

# r - 使用 plyr 计算边距

> ID：14242409
> 
> 赞同：1
> 
> 时间：2013-01-09T17:00:31.890
> 
> 标签：r, plyr

我有一个类似于以下结构的数据框：

```
Trial Index    Condition1    Condition2    Measures
1              A             Y             ...
2              A             Y             ...        
3              B             Y             ...
4              B             Y             ...
5              A             Z             ...
6              A             Z             ...        
7              B             Z             ...
8              B             Z             ... 
```

我想针对 Condition1 和 Condition2 的每个组合以及*边距*计算一些汇总度量。我可以使用对 ddply 的多次调用来执行此操作，但我想知道是否有一些简单的方法可以从中获取单个数据结构，例如：

```
Condition1    Condition2    Mean    Median    ....
A             Y             ...     ...       ....
A             Z             ...     ...       ....
A             -             ...     ...       ....             
B             Y             ...     ...       ....
B             Z             ...     ...       ....
B             -             ...     ...       ....
-             Y             ...     ...       ....
-             Z             ...     ...       .... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T20:18:23.500

多年来，有关 R 难以“报告”的投诉一直存在。确实没有用于在表格中插入小计（或子均值）和总计的内置函数。SQL 驱动程序的接口可以提供一些补救措施，但我不会这么简单，因为你没有使用数据库概念来提出你的问题，我猜这对你不利。这是一种使用总和作为先前答案的结果的全基 R 方法：

[R：计算列总和和行总和作为数据帧的聚合](https://stackoverflow.com/questions/5982546/r-calculating-column-sums-row-sums-as-an-aggregation-from-a-dataframe/5982943#5982943)

如果您构建一个带有边缘的数组，然后用`ftable`. 看这里：

[R中的分组和排序](https://stackoverflow.com/questions/10956300/grouping-and-sorting-in-r/10956655#10956655a)

有`tables`邓肯默多克的包裹。这可能是我能得出的最接近答案的答案。但我认为对于特定问题“是否有一些简单的方法”来获得具有所要求的复杂性的 R 对象的答案是......不......至少我知道这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T20:42:45.683

@DWin 是对的，`tables`包在这里可能是正确的线索。在不考虑格式化的情况下，这是一个示例：

```
library(tables)
d1 <- data.frame(id = 1:10, c1 = sample(c("a","b"), 10, replace = TRUE), 
        c2 = sample(c("c", "d"), 10, replace = TRUE), measures = rnorm(1:10))
t1 <- tabular((c1 + c2 + c1*c2 +1) ~ (measures)*(mean + median), data = d1)

             measures        
             mean     median 
      c1 a   -0.33306 -0.1801
         b   -0.54121 -0.6381
      c2 c   -0.04862  0.1647
         d   -0.69615 -0.8129
 c1 a c2 c   -0.26195 -0.2619
         d   -0.38047 -0.1801
    b    c    0.16472  0.1647
         d   -1.01182 -1.1863
         All -0.43713 -0.4678 
```

不过进入语法需要一段时间；从好的方面来说，它提供了将表格导出到 LaTeX 的功能。如果您不想要/不需要该`tabular`对象中的所有标签，您可以通过`as.matrix(t1, format = as.numeric)`.

**注意：** `c1`并且`c2`在公式的左侧必须`factor`为此工作

# html - 无论屏幕分辨率如何，修复 div 位置

> ID：14242414
> 
> 赞同：0
> 
> 时间：2013-01-09T17:00:47.853
> 
> 标签：html, css

这是我的页眉，它有一个选择菜单，并且必须很好地定位在背景图像的顶部，当屏幕分辨率发生变化时，如何将其固定到位？

看一看

![在此处输入图像描述](../Images/9729c98cf97294354ee1e97b230cd253.png)

这里有更大的分辨率

![在此处输入图像描述](../Images/45b9926d4e7a5806bc399456ebe88e4b.png)

html 如下所示：

```
 <div class="header">
            <table border="0" cellpadding="0" cellspacing="0" width="100%">
                <tbody>
                    <tr>
                        <td style="padding: 16px 10px 0 52px ;text-align: right; width: 230px; background: url('images/searchbar_dropdown.png') no-repeat scroll 72px 15px transparent;">
                       <select id="dept" name="dept" type="text" style="background-color: white; border: 2px solid rgb(182, 109, 49); width: 150px; height: 35px; opacity: 0;"><option></option>                                    
</select></div></td>
                        <td rowspan="2" style="width: 2px;">&nbsp;</td>

                    </tr>

            </table>
         </div> 
```

和标题CSS

```
 .header {
background: url("../../images/background.png") repeat;
position: fixed;
color: white;
min-height: 65px;
padding: 5px 5px;
margin: 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:11:33.263

选择正在为您流出，因为`fixed position`

您将需要一个包装盒，其中包含 a`position relative`和盒子`position absolute`

**例子：**

```
<div id="boxWrapper">
    <select class="selectbox">
        <option value="">option 1</option>
        <option value="">option 2</option>
        <option value="">option 3</option>
    </select>
</div>

#boxWrapper {
    position: relative:
}

.selectbox {
    position: absolute;
    top: 0px; 
    left: 0px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:18:43.070

我相信这很可能是您的`width: 100%`on the`table`和 your `text-align: right`on your的组合`td`。我怀疑你`td`的行为不是你想要的，也没有保持它`width: 230px`，而是随着屏幕宽度和`table`. 随着元素也随之移动`text-align: right`。`select`最简单的解决方法是将它定位`select`为`text-align: left`，除非您希望它是正确的并且要遵循背景（在这种情况下，您需要更正背景的附加方式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:10:18.580

试试这个代码

```
<div class="header">
            <table width="100%" cellspacing="0" cellpadding="0" border="0">
                <tbody>
                    <tr>
                        <td style="padding: 16px 10px 0px 52px; text-align: right; width: 230px; background: none repeat scroll 0% 0% whitesmoke; position: relative;">
                       <select style="border: 2px solid rgb(182, 109, 49); height: 35px; background: none repeat scroll 0% 0% yellow; opacity: 1; position: absolute; width: 150px; left: 0px;" type="text" name="dept" id="dept"><option></option>                                    
</select></td>
                        <td style="width: 2px;" rowspan="2">&nbsp;</td>

                    </tr>

            </tbody></table>
         </div> 
```

# html - 如何在具有流体比例的父 div 中水平堆叠三个 div 并单独定位每个子 div？

> ID：14242415
> 
> 赞同：2
> 
> 时间：2013-01-09T17:00:51.583
> 
> 标签：html, css, responsive-design, fluid-layout

我正在寻找三个 div 并将它们水平堆叠（彼此相邻）在包含 div 中。这个包含的 div 具有可变宽度，因此当浏览器按比例缩小时（这是针对响应式设计），三个子 div 会按比例缩放。此外，三个子 div 必须单独定位，以便最左边的 div 在左侧，中间的 div 居中，最右边的 div 一直到包含 div 的右侧。

我试图通过将容器 div 设置为 display: table 并将三个子 div 设置为 display: table-cell 来实现这一点——这很好用，除了我无法将三个子 div 定位在我上面描述的。我在父 div 上尝试了边框间距；但是，这不符合我的目标。

**这是我的小提琴代码：http: [//jsfiddle.net/mkerny45/97mt7/7/](http://jsfiddle.net/mkerny45/97mt7/7/)**

**所需结果的屏幕截图：http: [//d.pr/i/KUfd](http://d.pr/i/KUfd)** （在这里您将看到三个子 div：left、middle、right 在包含 div 中。左右 div 一直到左侧/右侧分别和中心 div 位于包含 div 的中心。边距也在照片中描绘。我希望整个包含 div 和子 div 按比例缩小，并让子 div 始终保持在适当的位置。）

**代码**

```
<div class="articles">
  <article>
    <img src="http://placehold.it/380x214/000000&text=Left" />
  </article>

  <article>
    <img src="http://placehold.it/380x214/3D6AA2&text=Middle" />
  </article>

  <article>
    <img src="http://placehold.it/380x214/98BD56&text=Right" />
  </article>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:06:47.327

您可以使用 text-align:justify 来实现这一点，以使 div 的间距均匀，使它们与边缘齐平。然后添加一个宽度为 100% 的 span 类来强制包装器的宽度。

**演示->** [http://jsfiddle.net/spUKQ/2/](http://jsfiddle.net/spUKQ/2/)

**HTML**

```
<div id="container">
    <div class="box1"></div>
    <div class="box2"></div>
    <div class="box3"></div>
    <span class="stretch"></span>
</div> 
```

**CSS**

```
#container {
    border: 2px dashed #444;
    height: 125px;

    text-align: justify;
    -ms-text-justify: distribute-all-lines;
    text-justify: distribute-all-lines;

    /* just for demo */
    min-width: 612px;
}

.box1, .box2, .box3 {
    width: 150px;
    height: 125px;
    vertical-align: top;
    display: inline-block;
    *display: inline;
    zoom: 1
}
.stretch {
    width: 100%;
    display: inline-block;
    font-size: 0;
    line-height: 0
}

/* just for demo */
.box1, .box3 {
    background: #ccc
}
.box2 {
    background: #0ff
} 
```

# debugging - 解析输入 URL 时出错，没有数据被抓取。（没有意义！）

> ID：14242417
> 
> 赞同：2
> 
> 时间：2013-01-09T17:00:56.157
> 
> 标签：debugging, parsing, facebook-opengraph

我拥有的网站绝对不能在 Facebook 的调试器上运行。我经常收到错误解析输入 URL，没有数据被抓取（就是这样）。这是一个 WordPress 3.5 安装，运行 Yoast 的 SEO 插件并启用了 OG 数据。

我从同一主机 (Dreamhost) 运行许多 WordPress 3.5 站点，并使用在 Debugger 上完美运行的 SAME 插件。如果您检查页面上的源代码不起作用，您可以看到正确的 og: data.

所有无索引均已取消选中，维护模式已关闭。我无法想象导致它失败的 wordpress 主题（我将主题切换为仔细检查）。

[http://www.pompeya.com](http://www.pompeya.com)

[我什至使用http://www.pompeya.com?fbrefresh=CAN_BE_ANYTHING](http://www.pompeya.com?fbrefresh=CAN_BE_ANYTHING)尝试了 fbrefresh

当我去 facebook 时，它正在提取文本 og 数据，而不是我包含的 200x200px PNG 图片。同样，我正在使用与我所有其他正在运行的 wordpress 网站相同的策略。

需要帮助为什么 Debugger 甚至看不到该站点！

# python - 在路径中包含 Python 库？

> ID：14242418
> 
> 赞同：1
> 
> 时间：2013-01-09T17:01:01.087
> 
> 标签：python

有没有办法在某个路径导入 Python 库？例如，

```
import os, sys, etc
import "/path/to/lib.py" 
```

我想包含一个带有 python 文件的库，除了让他们安装库之外，这是我能想到的最好的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:03:13.797

你可以这样做：

```
sys.path.append('/path/to')
import lib 
```

* * *

但是，说实话，你不应该。
安装库非常容易，尤其是使用[virtualenv](http://www.virtualenv.org/en/latest/)和[pip](http://www.pip-installer.org/en/latest/)等工具。

# eclipse - 导致最新 M2E 完全无法使用的基本错误？

> ID：14242423
> 
> 赞同：2
> 
> 时间：2013-01-09T17:01:09.427
> 
> 标签：eclipse, maven, m2eclipse, m2e

**Eclipse：** Juno (3.8.0) **M2E 版本：** 1.2.0.20120903-1050

当我尝试右键单击 Maven 项目并选择`Maven > Update Project...`然后单击`OK`时，我收到以下显示停止错误：

> '更新 Maven 项目时遇到问题。在“更新 Maven 项目”期间发生内部错误。

这个是直接从盒子里拿出来的——所以它必须从**根本上被打破？**此错误呈现以下异常：

```
java.lang.NoClassDefFoundError: Lorg/codehaus/plexus/archiver/jar/JarArchiver;
    at java.lang.Class.getDeclaredFields0(Native Method)
    at java.lang.Class.privateGetDeclaredFields(Unknown Source)
    at java.lang.Class.getDeclaredFields(Unknown Source)
    at com.google.inject.spi.InjectionPoint.getInjectionPoints(InjectionPoint.java:651)
    at com.google.inject.spi.InjectionPoint.forInstanceMethodsAndFields(InjectionPoint.java:358)
    at com.google.inject.internal.ConstructorBindingImpl.getInternalDependencies(ConstructorBindingImpl.java:155)
    at com.google.inject.internal.InjectorImpl.getInternalDependencies(InjectorImpl.java:585)
    at com.google.inject.internal.InjectorImpl.cleanup(InjectorImpl.java:542)
    at com.google.inject.internal.InjectorImpl.initializeJitBinding(InjectorImpl.java:528)
    at com.google.inject.internal.InjectorImpl.createJustInTimeBinding(InjectorImpl.java:833)
    at com.google.inject.internal.InjectorImpl.createJustInTimeBindingRecursive(InjectorImpl.java:758)
    at com.google.inject.internal.InjectorImpl.getJustInTimeBinding(InjectorImpl.java:255)
    at com.google.inject.internal.InjectorImpl.getBindingOrThrow(InjectorImpl.java:204)
    at com.google.inject.internal.InjectorImpl.getProviderOrThrow(InjectorImpl.java:954)
    at com.google.inject.internal.InjectorImpl.getProvider(InjectorImpl.java:987)
    at com.google.inject.internal.InjectorImpl.getProvider(InjectorImpl.java:950)
    at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1000)
    at org.sonatype.guice.bean.reflect.AbstractDeferredClass.get(AbstractDeferredClass.java:45)
    at com.google.inject.internal.ProviderInternalFactory.provision(ProviderInternalFactory.java:84)
    at com.google.inject.internal.InternalFactoryToInitializableAdapter.provision(InternalFactoryToInitializableAdapter.java:52)
    at com.google.inject.internal.ProviderInternalFactory$1.call(ProviderInternalFactory.java:70)
    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:100)
    at org.sonatype.guice.plexus.lifecycles.PlexusLifecycleManager.onProvision(PlexusLifecycleManager.java:138)
    at com.google.inject.internal.ProvisionListenerStackCallback$Provision.provision(ProvisionListenerStackCallback.java:108)
    at com.google.inject.internal.ProvisionListenerStackCallback.provision(ProvisionListenerStackCallback.java:55)
    at com.google.inject.internal.ProviderInternalFactory.circularGet(ProviderInternalFactory.java:68)
    at com.google.inject.internal.InternalFactoryToInitializableAdapter.get(InternalFactoryToInitializableAdapter.java:45)
    at com.google.inject.internal.InjectorImpl$3$1.call(InjectorImpl.java:965)
    at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1011)
    at com.google.inject.internal.InjectorImpl$3.get(InjectorImpl.java:961)
    at com.google.inject.Scopes$1$1.get(Scopes.java:59)
    at org.sonatype.guice.bean.locators.LazyBeanEntry.getValue(LazyBeanEntry.java:83)
    at org.sonatype.guice.plexus.locators.LazyPlexusBean.getValue(LazyPlexusBean.java:49)
    at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:253)
    at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:245)
    at org.apache.maven.plugin.internal.DefaultMavenPluginManager.getConfiguredMojo(DefaultMavenPluginManager.java:455)
    at org.eclipse.m2e.core.internal.embedder.MavenImpl.getConfiguredMojo(MavenImpl.java:344)
    at org.sonatype.m2e.mavenarchiver.internal.AbstractMavenArchiverConfigurator.reflectManifestGeneration(AbstractMavenArchiverConfigurator.java:406)
    at org.sonatype.m2e.mavenarchiver.internal.AbstractMavenArchiverConfigurator.generateManifest(AbstractMavenArchiverConfigurator.java:364)
    at org.sonatype.m2e.mavenarchiver.internal.AbstractMavenArchiverConfigurator.mavenProjectChanged(AbstractMavenArchiverConfigurator.java:183)
    at org.sonatype.m2e.mavenarchiver.internal.AbstractMavenArchiverConfigurator.mavenProjectChanged(AbstractMavenArchiverConfigurator.java:170)
    at org.eclipse.m2e.core.internal.project.ProjectConfigurationManager.mavenProjectChanged(ProjectConfigurationManager.java:888)
    at org.eclipse.m2e.core.internal.project.registry.ProjectRegistryManager.notifyProjectChangeListeners(ProjectRegistryManager.java:729)
    at org.eclipse.m2e.core.internal.project.registry.ProjectRegistryManager.applyMutableProjectRegistry(ProjectRegistryManager.java:852)
    at org.eclipse.m2e.core.internal.project.registry.ProjectRegistryManager.refresh(ProjectRegistryManager.java:281)
    at org.eclipse.m2e.core.internal.project.registry.MavenProjectManager.refresh(MavenProjectManager.java:58)
    at org.eclipse.m2e.core.internal.builder.MavenBuilder.build(MavenBuilder.java:87)
    at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:728)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:239)
    at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:292)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:295)
    at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:351)
    at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:374)
    at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143)
    at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:241)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)
Caused by: java.lang.ClassNotFoundException: org.codehaus.plexus.archiver.jar.JarArchiver
    at org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy.loadClass(SelfFirstStrategy.java:50)
    at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:244)
    at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:230)
    at java.lang.ClassLoader.loadClassInternal(Unknown Source)
    ... 59 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T02:46:02.263

我遇到了同样的错误。

当我第一次使用 m2e 创建 maven 项目时，maven 安装配置到我的本地 apache-maven-3.0.3 文件夹。

最近我将 ide 切换到 spring 工具套件，其中捆绑了 apache-maven-3.0.4。所以我改用 3.0.4，然后出现错误“java.lang.NoClassDefFoundError: Lorg/codehaus/plexus/archiver/jar/JarArchiver;” 出现。现在我将配置恢复到以前版本的 maven，错误消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T09:06:51.723

我正在使用 m2e 1.2.0 没有问题，所以它一定是您 PC 上的本地问题。尝试：

1.  尝试重新启动 Eclipse
2.  一位同事昨天在一台 Linux 机器上遇到了类似的问题。令我惊讶的是，重新启动修复了它。
3.  确保其中的 JAR 文件`~/.m2/repository/org/codehaus/plexus/plexus-archiver/`没有损坏。

执行最后一步时，请确保查看正确的存储库。可以以不同方式配置两个 Maven（Eclipse 和命令行上的一个）。检查 Eclipse 中的“Maven”首选项以获取设置文件的路径。

# calendar - 并使用按钮隐藏在 kal 日历 gridview 中

> ID：14242425
> 
> 赞同：1
> 
> 时间：2013-01-09T17:01:14.847
> 
> 标签：calendar, hide, kal

我有一个应用程序，我只想显示 Kal 日历库，或者当您按下按钮显示日历并且再次按下它以隐藏时，tapku 样式库。我不直接使用那个库，也不承认你通过 JSON 数据是正确的。

# php - 饼图不显示

> ID：14242427
> 
> 赞同：0
> 
> 时间：2013-01-09T17:01:22.023
> 
> 标签：php, mysql, graph, charts, pie-chart

我正在尝试创建一个饼图，其中显示了我的“书”表中的前 10 本书（我正在做一个图书馆系统）。

我计算出前10名中的每本书被借款人循环借出多少次，并且还计算出每本书的百分比和度数以形成饼图，但我似乎找不到方法实际形成饼图本身。

我也不知道如何将百分比变成一个数组，以便在第二个循环中，它将显示每本书的弧线。

到目前为止，这是我的代码：

```
<?php
    //execute the SQL query and return records
    $result = mysql_query("SELECT book_id, COUNT(*) FROM loan GROUP BY book_id ASC ORDER BY         count(*) DESC LIMIT 10");
    $book_count = mysql_num_rows($result);

    $step = 1;

    while($row = mysql_fetch_array($result))
    {
    $total = $total + $row['COUNT(*)'];
    $i[$step] = $row['COUNT(*)'];
    $step++;
    }

    $pie = imagecreate(500,500);
    $white = imagecolorallocate($pie,255,255,255);
    imagefill($pie,0,0,$white);

    $font = imageloadfont('calibri.gdf');
    $black = imagecolorallocate($pie,0,0,0);  //This is for the labeling also

    $angle = 0;

    for($index = 1; $index <= 10; $index++)
    {
        $percentage = (($i[$index]/$total)*100);
        #$degrees = (($percentage/100)*360);
    }

    for ($index2=0, $count=count($percentage); $index2<$count; $index2++)
    {
        #$percentage = (($i[$index]/$total)*100);
        $degrees = (($percentage[$index]/100)*360);
        $color = imagecolorallocate($pie,mt_rand(20,255),mt_rand(20,255),mt_rand(20,255));

        imagefilledarc($pie,100,100,125,125,$angle,($angle+$degrees),$color,IMG_ARC_PIE);
        imagefilledrectangle($pie,250,(50+(25*($index2+1))),275,(75+(25*($index2+1))),$color);
        imagestring($pie,$font,276,(55+(25*($index2+1))),$percentage[$index2]."  %",$black);

        $angle+=$degrees;
    }

    header("Content-type: image/png");
    imagepng($pie);
    imagedestroy($pie);

    #echo "<br>";
    #echo 'The sum is: ' . $total;

?> 
```

# ruby - 监听 gem 并监控文件系统的变化

> ID：14242429
> 
> 赞同：2
> 
> 时间：2013-01-09T17:01:26.420
> 
> 标签：ruby, filesystems

我刚刚遇到了监听文件系统事件（或轮询）的[监听](https://github.com/guard/listen)gem，它可以在文件更改或添加时执行您的 ruby​​ 代码。

它看起来非常好，但是如果我需要捕获目录中文件的*任何*更改/添加，有没有办法让我捕获自上次运行脚本以来更改的任何文件？

IE。有什么办法可以`Listen`坚持不懈地工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T13:03:26.220

如果目录更改事件顺序很重要，那么在脚本停止工作后您可能无法获得该顺序，因为它丢失并且无法从文件系统中检索。

否则，我会利用 git repo 在上次提交后收集更改，在脚本停止工作之前进行提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-01T20:14:53.757

尝试使用以下命令在控制台上解决问题

```
echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p 
```

# c# - 如何使用密码控制禁用 Caps Lock 警告？

> ID：14242439
> 
> 赞同：7
> 
> 时间：2013-01-09T17:02:00.440
> 
> 标签：c#, .net, windows

当我打开 Caps Lock 并重点关注密码控制时，我会得到这个。我想添加我自己的警告。我怎样才能禁用这个？我不介意 P/Invoke 或任何本机代码，但它必须在 C# 中。

![在此处输入图像描述](../Images/57330470a6d0c3e613c42376c80e2ac5.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:11:59.300

在您的表单中，像这样覆盖 WndProc，这将拦截 EM_SHOWBALOONTIP 消息并阻止控件接收它：

```
protected override void WndProc(ref Message m)
{
  if (m.Msg != 0x1503) //EM_SHOWBALOONTIP
     base.WndProc(ref m);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-25T15:42:35.553

以下代码适用于我，在`KeyDown`a 事件中`TextBox`：

```
 private void txtPassword_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyData == Keys.CapsLock)
        {
            e.SuppressKeyPress = true;
        }
    } 
```

# c# - DateTime.Parse 不使用当前 CultureInfo(Silverlight) 中的模式？

> ID：14242441
> 
> 赞同：0
> 
> 时间：2013-01-09T17:02:06.107
> 
> 标签：c#, datetime, silverlight-4.0, localization, cultureinfo

我有以下问题。我在其中设置`CurrentCulture`并`CurrentUICulture`使用以下模式：

`ShortDatePattern`是`dd-MM-yyyy`

LongTimePattern 是`HH.mm.ss`.

当我将日期转换为字符串时，我得到`15-01-2008 00.00.00`. 但是当我调用`DateTime.Parse("15-01-2008 00.00.00")`它时会抛出一个`FormatException`. 如果我设置`ShortDatePattern`为 `dd-MM-yyyy HH.mm.ss`异常仍然抛出。有没有办法通过相应`DateTime.Parse`的设置来强制使用时间模式`CurrentCulture`。

我知道使用 Parse 重载或`ParseExact`可能会有所帮助，但重点是使用格式化而不需要`refactoring`大量已经编写和使用`DateTime.Parse`的`ToString`代码

**附加信息：** A 也尝试过投入-`-`没有用。是基于.`.``'``CurrentCulture``Swedish`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:07:12.903

如果您想使用`String.Format()`Method 格式化 DateTIme，您可以在下面执行类似的操作。[String.Format 日期时间 C#](http://www.csharp-examples.net/string-format-datetime/)

```
 var dt = "15-01-2008 00.00.00";
 var dateFrmt = String.Format("{0:dd/MM/yyyy HH:mm:ss}", dt); 
```

`Output = "15-01-2008 00.00.00"`

如果您想将 HH:mm:ss 从 DateTime 变量中去除短日期，您可以执行以下操作，这是一个示例将产生 ShortDate

```
 DateTime dt = DateTime.Now;
 var dateFrmt = String.Format("{0:M/d/yyyy}", dt); 
```

`Output = "1/9/2013"`

[DateTime.ParseExact 方法，如果你选择走那条路](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)

# java - 与孩子共享基本类型列表

> ID：14242444
> 
> 赞同：5
> 
> 时间：2013-01-09T17:02:12.797
> 
> 标签：java, oop

我有一个基类`ShapeManager`，其中包含我想要的形状列表 `enumerate()`。然后有一个专门`ColoredShapeManager`化想要处理专门`ColoredShape`的 s 而不是`Shape`s：

```
+----------------+      +-------------------------------------+
| Shape          |      | ShapeManager                        |
|----------------|      |-------------------------------------|
| + id: int      |      | # shapes: List<Shape>               |
|                |      |                                     |
|                |      | + ShapeManager() {                  |
|                |      |     shapes.add(new Shape());        |
|                |      |   }                                 |
|                |      |                                     |
|                |      | + abstract void enumerate() {       |
|                |      |     for (Shape s: shapes) {         |
|                |      |        // use s                     |
|                |      |     }                               |
|                |      |   }                                 |
+----------------+      +-------------------------------------+
         ^                              ^
         |                              |
         +                              +
+----------------+      +-------------------------------------+
| ColoredShape   |      | ColoredShapeManager                 |
|----------------|      |-------------------------------------|
| + color: int   |      | + ColoredShapeManager() {           |
|                |      |     shapes.add(new ColoredShape()); |
|                |      |   }                                 |
|                |      |                                     |
|                |      | + abstract void enumerate() {       |
|                |      |     for (Shape s: shapes) {         |
|                |      |       // use (ColoredShaped) s      |
|                |      |       // will fail for Shapes       |
|                |      |     }                               |
|                |      |   }                                 |
+----------------+      +-------------------------------------+ 
```

我不确定 ShapeManager 是否应该`shapes: List<Shape>`与其孩子共享这似乎有缺陷，因为`ColoredShapeManager.enumerate()`想要处理`ColoredShape`s。因此它会转换元素，但某些元素（由基类添加的元素）是类型`Shape`的并且转换会失败。

那是：

*   两种形状都在列表中`shapes`。
*   `enumerate()`在子管理器中应该可以访问`ColoredShape`.

我是否应该拆分列表并在两个经理中的每一个中创建私人列表？然后在孩子中枚举只会迭代“它的”类型的形状并`enumerate()`在开始/结束时调用父母的形状。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T09:49:13.650

您可以将形状类型添加为管理器类的“类型参数”。所以基本上，`ColoredShapeManager`可以扩展`ShapeManager<ColoredShape>`，这`T`将是您内部`List`数据结构的类型。另外，如果您`ColoredShapeManager`对 没有做任何具体的事情`ColoredShapes`，我会争辩说它甚至不需要一个新课程。但话又说回来，这取决于您构建应用程序/设计的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T11:23:14.210

访客模式在这里适合您吗？

形状

```
public void doSomething(ShapeManager) {
    ...
} 
```

形状管理器

```
abstract void enumerate() {
   for (Shape shape: shapes) {
       shape.doSomething(this);
   }
} 
```

然后你就不需要知道类型，每个形状导数都可以有自己的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T10:11:17.403

为什么不分离*行为* 并*生成*容器？

容器：

```
public class ShapeManager<T extends Shape> {
    private List<T> shapeList;

    public void processShapes(ShapeProcessor processor){
        for (T shape : shapeList){
            processor.process(shape);
        }
    }
} 
```

和行为（你也可以有一个工厂类来提供不同的实现）：

```
public class ShapeProcessor {

    public void process(Shape shape) {

    }

    public void process(ColoredShape shape){

    }
} 
```

或者，进入完整的[访客模式](http://en.wikipedia.org/wiki/Visitor_pattern)：

```
public abstract class Shape {
    public void accept(ShapeProcessor processor){
        processor.process(this);
    }
}

public interface ShapeProcessor {
    public void process(Shape shape);
    public void process(ColoredShape shape);
}

public class ShapeManager {
    private List<Shape> shapeList;

    public void processShapes(ShapeProcessor processor){
        for (Shape shape : shapeList){
            shape.accept(processor);
        }
    }
} 
```

这允许枚举多种形状并应用不同种类的处理方法，这也来自不同种类的 ShapeProcessor。经理不关心他们中的任何一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-18T10:01:54.983

我认为您可以在`ShapeManager`. 如果您不介意，我会借用您的类图：

```
+----------------+      +---------------------------------------+        +------------------------------+
| Shape          |      | AbstractShapeManager<S extends Shape> |        | ShapeManager<Shape>          |
|----------------|      |---------------------------------------|        |------------------------------|
| + id: int      |      | # shapes: List<S>                     |        | + Shape() {                  |
|                |      |                                       |        |     shapes.add(new Shape()); |
|                |      | + abstract void enumerate() {         | < —— + |   }                          |
|                |      |     for (S s: shapes) {               |        |                              |
|                |      |        /* use s */                    |        | + void enumerate() {         |
|                |      |     }                                 |        |     for (Shape s: shapes) {  |
|                |      |   }                                   |        |       // use Shape           |
+----------------+      +---------------------------------------+        |     }                        |
         ^                              ^                                |   }                          |
         |                              |                                +------------------------------+
         +                              +
+----------------+      +-------------------------------------+
| ColoredShape   |      | ColoredShapeManager<ColoredShape>   |
|----------------|      |-------------------------------------|
| + color: int   |      | + ColoredShapeManager() {           |
|                |      |     shapes.add(new ColoredShape()); |
|                |      |   }                                 |
|                |      |                                     |
|                |      | + void enumerate() {                |
|                |      |     for (ColoredShape s: shapes) {  |
|                |      |       // use ColoredShape           |
|                |      |     }                               |
|                |      |   }                                 |
+----------------+      +-------------------------------------+ 
```

这样，缺点是您不能将任何形状添加到列表中，因为存在类型限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-09T17:27:12.913

我认为问题在于您正在两个地方构造一个属性 - 列表形状：部分在父类中，部分在子类中。这显然不是一个好的设计。你需要改变它。虽然我不能确切地说出如何，但我认为一种解决方案是您将列表作为参数提供给构造函数（至少对于父构造函数），而不是在每个构造函数中创建它们。这样，当您使用 ColoredShapeManager 等子类时，您可以构造 ColoredShape 列表，并将其从子构造函数中传递给父构造函数。这样，在您的所有子方法中，您将只处理 ColoredShape。同时，如果您使用父级，则只有 Shapes（通过构造函数传递）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-18T01:05:03.847

您的设计可以工作，但您必须在运行时检查形状 s 是否确实是一个形状，或者它是否是使用`instanceOf(class)`指令的 ColoredShape。如果您开始添加许多不同类型的形状，这样做会变得混乱。正确的做法是定义每个形状将实现的接口，这样每个形状都可以以相同的方式使用。

为什么不使用[复合模式？](http://en.wikipedia.org/wiki/Composite_pattern)

`public interface IShape { public int enumerate(); }`

* * *

```
public class Shape implements IShape {

int id;

public int enumerate() {
    return id;
}

} 
```

* * *

```
public class ShapeColor extends shape {

    int color;

    public int enumerate() {

        return //whatever you need;
    }

} 
```

* * *

```
import java.util.List;

public class ShapeManager implements IShape {

    List<IShape> shapes;

    public int enumerate() {
        for(IShape s : shapes){
            //do stuff
        }
        return 0;
    }

} 
```

* * *

通过这样做，您可以将要添加到 ColoredShapeManager 中的行为直接放入 ColoredShape 中（这似乎更合乎逻辑）

# php - PHP仅更改传出命令的文件夹权限

> ID：14242447
> 
> 赞同：1
> 
> 时间：2013-01-09T17:02:22.983
> 
> 标签：php, .htaccess, file-permissions, folder-permissions

我正在制作一个文件共享网站，我允许页面的视觉和功能部分工作。当我想允许上传像 php 页面这样的服务器端脚本时，这会遇到问题。这个 php（等）页面可以轻松地反向链接和删除我显然不想要的文件。我已经多次更改权限进行测试，但这也阻止了我的 php 文件上传和重命名文件到这些文件夹。我确实想允许这些文件类型，但我不确定我能做什么。

我在想我可以通过 .htaccess 做到这一点，但我不知道怎么做。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:45:28.843

我不确定，但听起来你想允许任意文件上传（包括 .PHP 脚本），但要防止它们中的任何一个在服务器端执行。

我建议创建一个*不可*通过网络访问的文件存储目录（例如，将其放在您的 www-root 之外或使用 .htaccess 文件来限制直接访问）。然后让您的 PHP 脚本上传到该目录。创建一个下载脚本并通过该脚本对这些文件进行下载访问，这样就无法远程调用例如 PHP 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:08:31.610

我认为这与权限无关，而是 php 执行。您可以使用 .htaccess 文件关闭目录上的 php 引擎，如下所示：

```
<IfModule mod_php5.c>
    php_flag engine off
</IfModule> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T14:54:39.593

如果我从阅读评论中理解正确：

您希望用户能够上传任何文件。包括代码。包括.php、.asp 等。您希望用户能够执行此代码，但要将代码限制在“沙盒”环境中。

在我看来，您应该将文件写入特定位置，该位置具有自己的文档 root/vhost (http://exec.domain.tld)。

在该虚拟主机上，您可以设置安全性，即：

```
AllowOverride None # disable rewriting and such
php value disable_functions dl,exec,passthru,system,shell_exec,popen # disable functions 
```

最重要的是（！重要）为 vhosts 文档根目录设置 basedir 限制

```
<Directory /srv/www/exec.domain.tld/docroot>
  php_admin_value open_basedir /srv/www/exec.domain.tld/docroot 
</Directory> 
```

我还没有实际设置这个环境，但我觉得这是你最好的起点。而且我确实认为它会起作用，如果您修复我可能犯的错字/参数名称错误:)

# string - 转换字符串中的字符

> ID：14242448
> 
> 赞同：3
> 
> 时间：2013-01-09T17:02:28.677
> 
> 标签：string, perl

我有一个像这样的字符串：

```
Why RUNAS Windows \xee\x80\x80\x45xplorer\xee\x80\x81 Doesn\xe2\x80\x99t 
Work After Installing IE7 St\xc3\xa5le 
```

我通过读取 XML 文件得到。这是一个 UTF-8 字符串。现在我想打印其等效的 unicode 字符，以便得到：

```
Why RUNAS Windows Explorer Doesn’t Work After Installing IE7 Ståle 
```

我尝试了一个小程序：

```
use strict;
use utf8;
use Encode;

my $str = "Why RUNAS Windows \xee\x80\x80\x45xplorer\xee\x80\x81 Doesn\xe2\x80\x99t Work After Installing IE7 St\xc3\xa5le";
print $str; 
```

它奏效了！！

问题是当我试图从文件中读取字符串时，它没有转换。所以以下不会产生 unicode 输出：

```
use strict;
use utf8;
use Encode;
my $str = <DATA>;
$str = decode("utf8", $str);
open OUT, ">", "o.txt" or die;
binmode(OUT,":utf8");
print OUT $str;
__DATA__
Why RUNAS Windows \xee\x80\x80\x45xplorer\xee\x80\x81 Doesn\xe2\x80\x99t Work After Installing IE7 St\xc3\xa5le 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:13:44.767

您的两个示例之间的区别在于，第一个示例中的反斜杠在编译时被插入为字节，而在第二个示例中，它们是文字文本。在第二个示例中，您正在读取一系列字符“\”、“x”、“e”、“e”，但第一个示例将其转换为内存中的单个 unicode 字符。

如果 XML 文件包含 unicode 字符，Perl 可以很好地读取它们；他们不需要像显示的那样逃脱。

如果您必须将这些 un​​icode 字符保留为字符序列，请考虑使用 CPAN 中的库来解码它们。乍一看，[Encode::Escape](http://search.cpan.org/perldoc?Encode%3a%3aEscape)似乎可以满足您的需求：

```
#!/usr/bin/perl
use strict;
use warnings;
use Encode::Escape;

while (<DATA>) {
    chomp;
    print decode 'unicode-escape', $_; # convert byte references to (utf-8) bytes
}

__DATA__
Why RUNAS Windows \xee\x80\x80\x45xplorer\xee\x80\x81 Doesn\xe2\x80\x99t
Work After Installing IE7 St\xc3\xa5le 
```

可能还有其他人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T17:20:22.983

这很明显：

```
print "abc\n";   # Prints <abc>

<DATA>;          # Doesn't print <abc>
__DATA__
print "abc\n"; 
```

所以这应该不足为奇：

```
"\x61";          # Evaluates to string <a>

<DATA>;          # Doesn't evaluate to string <a>
__DATA__
"\x61" 
```

您混淆了字符串文字（Perl 运算符）和字符串（字符序列）。`readline`不会将您的数据文件作为 Perl 代码执行。（即使是这样，你也错过了引号。）如果你想转换你读到的字符串，你将不得不告诉 Perl 来转换它们。

```
s/ \\x(..) | \\([^a-zA-Z]) | \\(.) /
   defined($1) ? chr(hex($1)) :
   defined($2) ? $2 :
   do { warn "Unknown escape \\$3\n"; "\\$3" }
/sexg; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:13:39.957

使用带评估的替换将每个代码更改为相应的字节。不需要`use utf8`也不`use Encode`需要：

```
#!/usr/bin/perl
use warnings;
use strict;

my $str = <DATA>;
$str =~ s/\\x(..)/chr hex $1/eg;
open my $OUT, '>', 'o.txt' or die $!; # No binmode utf8 - byte semantics needed!
print $OUT $str;

__DATA__
Why RUNAS Windows \xee\x80\x80\x45xplorer\xee\x80\x81 Doesn\xe2\x80\x99t Work After Installing IE7 St\xc3\xa5le 
```

# sql - 针对复杂需求的 Oracle SQL 查询

> ID：14242449
> 
> 赞同：1
> 
> 时间：2013-01-09T17:02:32.643
> 
> 标签：sql, oracle

我有以下oracle数据库表USERS

![在此处输入图像描述](../Images/dab191af12e19910bfc1b3260b726d1f.png)

我必须显示每个状态的用户状态开始日期和时间以及结束日期和时间。

从上面的例子中，我需要显示 STEVE BALE is LOGGED_OUT from 01/08/2013 12:00:00 AM to 01/08/2013 5:04:24.736437 AM

并且从 01/08/2013 5:04:24.736437 AM 到 01/08/2013 6:04:24.736437 AM 不可用，

并且从 01/08/2013 6:04:24.736437 AM 到 01/08/2013 7:31:08.591801 AM...

同样对于给定日期的最后记录新状态，用户 STEVE BALE 从 01/08/2013 11:30:50.724405 AM 到 01/08/2013 11:59:59 PM 为 LOGGED_OUT。

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:04:41.980

这其实很简单，因为 oracle 有这个`lead()`功能。就像是：

```
select t.*,
       lead(status_change_date) over (partition by user_name order by status_change_date) as end_status_time
from t 
```

对于字符串，您可以执行以下操作：

```
select (t.user_name||' is '||t.new_status||' from '||
        to_char(status_change_date, 'mm/dd/yyyy hh:mi')+' to '||
        to_char(lead(status_change_date) over (partition by user_name order by status_change_date),
                'mm/dd/yyyy hh:mi')
       ) as thestring
from t 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:32:54.447

如果我理解正确，这里有一些例子。在“到”部分使用您的日期/时间列：

```
Select 'STEVE BALE is LOGGED_OUT from: '||to_char(trunc(Sysdate), 'mm/dd/yyyy hh:mi:ss AM')||' to '||to_char((trunc(sysdate)+5/24)+04/1440, 'mm/dd/yyyy hh:mi:ss AM') "in_out"
From dual;

SQL> STEVE BALE is LOGGED_OUT from: 01/09/2013 12:00:00 AM to 01/09/2013 05:04:00 AM 
```

要从上一行/下一行获取值，请按照 Gordon 的建议使用 Lag/Lead。

# java - java android处理程序调用

> ID：14242451
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:02:36.950
> 
> 标签：java, android

我是android编程的新手。我看到了很多方法来进行事件处理，但是当我尝试通过调用处理程序类来完成它时，它会在处理类名时出错：

```
package com.example.test;

import android.app.Activity;
import android.content.DialogInterface.OnClickListener;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //attach an instance of HandleClick to the Button
        findViewById(R.id.button1).setOnClickListener(new HandleClick());
    }    

    private class HandleClick implements OnClickListener{
        public void onClick(View arg0) {
            Button btn = (Button)arg0;  //cast view to a button
            // get a reference to the TextView
            TextView tv = (TextView) findViewById(R.id.textview1);
            // update the TextView text
            tv.setText("You pressed " + btn.getText());
        }
    }
} 
```

`"HandleClick"`错误来了，它说类应该是抽象类型？

我不明白为什么会出现此错误，任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:06:39.270

那是错误的 OnClickListener 类。你有

```
 import android.content.DialogInterface.OnClickListener; 
```

你需要：

```
 import android.view.View.OnClickListener; 
```

为了将来参考，您得到的错误是“类型必须实现继承的抽象方法......”。这是因为您需要实现 DialogInterface 的 onClick，这应该会导致您注意到它是错误的导入（因为您有`onClick(View)`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:07:07.563

让它变得简单并使用它，

```
b1 = (Button) findViewById(R.id.button1);
TextView tv = (TextView) findViewById(R.id.textview1);
b1.setOnClickListener(new OnClickListener()
{
    public void onClick(View v)
    {
        Toast msg = Toast.makeText(getBaseContext(),
        "You have clicked Button 1", Toast.LENGTH_LONG);
        msg.show();
        tv.setText("You pressed " + btn.getText());
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:08:54.493

你导入了错误的 OnClickListener，你应该从 android.view.View 导入那个

# javascript - 将 Jquery 数据表与 AngularJs 一起使用

> ID：14242455
> 
> 赞同：43
> 
> 时间：2013-01-09T17:02:43.930
> 
> 标签：javascript, jquery, angularjs, jquery-datatables

我正在尝试在我的 angularjs 项目中使用[jquery 数据表插件。](http://www.datatables.net)但我的问题是它是否支持angularjs 的**延迟加载**值？我想要因为我有很多行。如何在 angularjs中使用数据表[管道。](http://www.datatables.net/release-datatables/examples/server_side/pipeline.html)

[这里](https://stackoverflow.com/questions/11109754/pagination-using-jquery-datatable)有一个分页解决方案。如何将解决方案与 angularjs 一起使用？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-19T02:06:12.610

看看这个：AngularJS+JQuery(datatable)

完整代码：http: [//jsfiddle.net/zdam/7kLFU/](http://jsfiddle.net/zdam/7kLFU/)

JQuery 数据表的文档：[http ://www.datatables.net/](http://www.datatables.net/)

```
var dialogApp = angular.module('tableExample', []);

    dialogApp.directive('myTable', function() {
        return function(scope, element, attrs) {

            // apply DataTable options, use defaults if none specified by user
            var options = {};
            if (attrs.myTable.length > 0) {
                options = scope.$eval(attrs.myTable);
            } else {
                options = {
                    "bStateSave": true,
                    "iCookieDuration": 2419200, /* 1 month */
                    "bJQueryUI": true,
                    "bPaginate": false,
                    "bLengthChange": false,
                    "bFilter": false,
                    "bInfo": false,
                    "bDestroy": true
                };
            }

            // Tell the dataTables plugin what columns to use
            // We can either derive them from the dom, or use setup from the controller           
            var explicitColumns = [];
            element.find('th').each(function(index, elem) {
                explicitColumns.push($(elem).text());
            });
            if (explicitColumns.length > 0) {
                options["aoColumns"] = explicitColumns;
            } else if (attrs.aoColumns) {
                options["aoColumns"] = scope.$eval(attrs.aoColumns);
            }

            // aoColumnDefs is dataTables way of providing fine control over column config
            if (attrs.aoColumnDefs) {
                options["aoColumnDefs"] = scope.$eval(attrs.aoColumnDefs);
            }

            if (attrs.fnRowCallback) {
                options["fnRowCallback"] = scope.$eval(attrs.fnRowCallback);
            }

            // apply the plugin
            var dataTable = element.dataTable(options);

            // watch for any changes to our data, rebuild the DataTable
            scope.$watch(attrs.aaData, function(value) {
                var val = value || null;
                if (val) {
                    dataTable.fnClearTable();
                    dataTable.fnAddData(scope.$eval(attrs.aaData));
                }
            });
        };
    });

function Ctrl($scope) {

    $scope.message = '';            

        $scope.myCallback = function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {            
            $('td:eq(2)', nRow).bind('click', function() {
                $scope.$apply(function() {
                    $scope.someClickHandler(aData);
                });
            });
            return nRow;
        };

        $scope.someClickHandler = function(info) {
            $scope.message = 'clicked: '+ info.price;
        };

        $scope.columnDefs = [ 
            { "mDataProp": "category", "aTargets":[0]},
            { "mDataProp": "name", "aTargets":[1] },
            { "mDataProp": "price", "aTargets":[2] }
        ]; 

        $scope.overrideOptions = {
            "bStateSave": true,
            "iCookieDuration": 2419200, /* 1 month */
            "bJQueryUI": true,
            "bPaginate": true,
            "bLengthChange": false,
            "bFilter": true,
            "bInfo": true,
            "bDestroy": true
        };

        $scope.sampleProductCategories = [

              {
                "name": "1948 Porsche 356-A Roadster",
                "price": 53.9,
                  "category": "Classic Cars",
                  "action":"x"
              },
              {
                "name": "1948 Porsche Type 356 Roadster",
                "price": 62.16,
            "category": "Classic Cars",
                  "action":"x"
              },
              {
                "name": "1949 Jaguar XK 120",
                "price": 47.25,
            "category": "Classic Cars",
                  "action":"x"
              }
              ,
              {
                "name": "1936 Harley Davidson El Knucklehead",
                "price": 24.23,
            "category": "Motorcycles",
                  "action":"x"
              },
              {
                "name": "1957 Vespa GS150",
                "price": 32.95,
            "category": "Motorcycles",
                  "action":"x"
              },
              {
                "name": "1960 BSA Gold Star DBD34",
                "price": 37.32,
            "category": "Motorcycles",
                  "action":"x"
              }
           ,
              {
                "name": "1900s Vintage Bi-Plane",
                "price": 34.25,
            "category": "Planes",
                  "action":"x"
              },
              {
                "name": "1900s Vintage Tri-Plane",
                "price": 36.23,
            "category": "Planes",
                  "action":"x"
              },
              {
                "name": "1928 British Royal Navy Airplane",
                "price": 66.74,
            "category": "Planes",
                  "action":"x"
              },
              {
                "name": "1980s Black Hawk Helicopter",
                "price": 77.27,
            "category": "Planes",
                  "action":"x"
              },
              {
                "name": "ATA: B757-300",
                "price": 59.33,
            "category": "Planes",
                  "action":"x"
              }

        ];            

} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-08-02T15:03:17.957

在对 Angular 使用 jQueryDataTables 进行了数小时的试验后，我发现我需要的东西可以通过一个名为 ng-table 的原生 Angular 指令获得。它提供排序、分页和 ajax 重新加载（一种延迟加载，只需稍加调整）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-06-11T09:21:33.887

添加一个新的答案只是作为未来研究人员的参考，因为没有人提到，但我认为它是有效的。

另一个不错的选择是**ng-grid** [http://angular-ui.github.io/ng-grid/](http://angular-ui.github.io/ng-grid/)。

还有一个测试版（[http://ui-grid.info/](http://ui-grid.info/)）已经有了一些改进：

*   原生 AngularJS 实现，没有 jQuery
*   在大型数据集上表现良好；甚至超过 10,000 行
*   插件架构允许您仅使用您需要的功能

**更新：**

UI GRID 似乎不再是测试版了。

> 在 3.0 版本中，存储库已从“ng-grid”重命名为“ui-grid”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-05-04T05:15:26.897

对于 AngularJs，您必须使用“angular-datatables.min.js”文件进行数据表设置。您将从[http://l-lin.github.io/angular-datatables/#/welcome](http://l-lin.github.io/angular-datatables/#/welcome)获得此信息。

之后，您可以编写如下代码，

```
<script>
  var app = angular.module('AngularWayApp', ['datatables']);
</script>

<div ng-app="AngularWayApp" ng-controller="AngularWayCtrl">
  <table id="example" datatable="ng" class="table">
    <thead>
      <tr>
        <th><b>UserID</b></th>
        <th><b>Firstname</b></th>
        <th><b>Lastname</b></th>
        <th><b>Email</b></th>
        <th><b>Actions</b></th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="user in users" ng-click="testingClick(user)">
        <td>{{user.UserId}}</td>
        <td>{{user.FirstName}}</td>
        <td>{{user.Lastname}}</td>
        <td>{{user.Email}}</td>
        <td>
           <span ng-click="editUser(user)" style="color:blue;cursor: pointer; font-weight:500; font-size:15px" class="btnAdd" data-toggle="modal" data-target="#myModal">Edit</span> &nbsp;&nbsp; | &nbsp;&nbsp;
          <span ng-click="deleteUser(user)" style="color:red; cursor: pointer; font-weight:500; font-size:15px" class="btnRed">Delete</span>
         </td>
       </tr>
     </tbody>
   </table>
 </div> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-07-26T17:08:49.563

我知道使用其他开发人员创建的拖放角度模块很诱人-但实际上，除非您正在做一些非标准的事情，例如通过调用`$http`服务机会从 ng-repeated 数据集中动态添加/删除行，否则您真的不需要一个基于指令的解决方案，所以如果你这样做，你可能只是创建了你实际上不需要的额外观察者。

这个实现提供了什么：

*   分页总是正确的
*   过滤总是正确的（即使您添加了自定义过滤器，但当然它们只需要在同一个闭包中）

实施很容易。只需使用视图控制器中准备好的 Angular 版本的 jQuery dom：

**在您的控制器内部：**

```
'use strict';

var yourApp = angular.module('yourApp.yourController.controller', []);

yourApp.controller('yourController', ['$scope', '$http', '$q', '$timeout', function ($scope, $http, $q, $timeout) {

    $scope.users = [
        {
            email: 'email@address.com',
            name: {
                first: 'User',
                last: 'Last Name'
            },
            phone: '(416) 555-5555',
            permissions: 'Admin'
        },
        {
            email: 'example@email.com',
            name: {
                first: 'First',
                last: 'Last'
            },
            phone: '(514) 222-1111',
            permissions: 'User'
        }
    ];

    angular.element(document).ready( function () {
         dTable = $('#user_table')
         dTable.DataTable();
     });

}]); 
```

**现在在您的 html 视图中可以执行以下操作：**

```
<div class="table table-data clear-both" data-ng-show="viewState === possibleStates[0]">
        <table id="user_table" class="users list dtable">
            <thead>
                <tr>
                    <th>E-mail</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Phone</th>
                    <th>Permissions</th>
                    <th class="blank-cell"></th>
                </tr>
            </thead>
            <tbody>
                <tr data-ng-repeat="user in users track by $index">
                    <td>{{ user.email }}</td>
                    <td>{{ user.name.first }}</td>
                    <td>{{ user.name.last }}</td>
                    <td>{{ user.phone }}</td>
                    <td>{{ user.permissions }}</td>
                    <td class="users controls blank-cell">
                        <a class="btn pointer" data-ng-click="showEditUser( $index )">Edit</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-01T12:11:13.310

访问此链接以供参考：[http ://codepen.io/kalaiselvan/pen/RRBzda](http://codepen.io/kalaiselvan/pen/RRBzda)

```
<script>  
var app=angular.module('formvalid', ['ui.bootstrap','ui.utils']);
app.controller('validationCtrl',function($scope){
  $scope.data=[
        [
            "Tiger Nixon",
            "System Architect",
            "Edinburgh",
            "5421",
            "2011\/04\/25",
            "$320,800"
        ],
        [
            "Garrett Winters",
            "Accountant",
            "Tokyo",
            "8422",
            "2011\/07\/25",
            "$170,750"
        ],
        [
            "Ashton Cox",
            "Junior Technical Author",
            "San Francisco",
            "1562",
            "2009\/01\/12",
            "$86,000"
        ],
        [
            "Cedric Kelly",
            "Senior Javascript Developer",
            "Edinburgh",
            "6224",
            "2012\/03\/29",
            "$433,060"
        ],
        [
            "Airi Satou",
            "Accountant",
            "Tokyo",
            "5407",
            "2008\/11\/28",
            "$162,700"
        ],
        [
            "Brielle Williamson",
            "Integration Specialist",
            "New York",
            "4804",
            "2012\/12\/02",
            "$372,000"
        ],
        [
            "Herrod Chandler",
            "Sales Assistant",
            "San Francisco",
            "9608",
            "2012\/08\/06",
            "$137,500"
        ],
        [
            "Rhona Davidson",
            "Integration Specialist",
            "Tokyo",
            "6200",
            "2010\/10\/14",
            "$327,900"
        ],
        [
            "Colleen Hurst",
            "Javascript Developer",
            "San Francisco",
            "2360",
            "2009\/09\/15",
            "$205,500"
        ],
        [
            "Sonya Frost",
            "Software Engineer",
            "Edinburgh",
            "1667",
            "2008\/12\/13",
            "$103,600"
        ],
        [
            "Jena Gaines",
            "Office Manager",
            "London",
            "3814",
            "2008\/12\/19",
            "$90,560"
        ],
        [
            "Quinn Flynn",
            "Support Lead",
            "Edinburgh",
            "9497",
            "2013\/03\/03",
            "$342,000"
        ],
        [
            "Charde Marshall",
            "Regional Director",
            "San Francisco",
            "6741",
            "2008\/10\/16",
            "$470,600"
        ],
        [
            "Haley Kennedy",
            "Senior Marketing Designer",
            "London",
            "3597",
            "2012\/12\/18",
            "$313,500"
        ],
        [
            "Tatyana Fitzpatrick",
            "Regional Director",
            "London",
            "1965",
            "2010\/03\/17",
            "$385,750"
        ],
        [
            "Michael Silva",
            "Marketing Designer",
            "London",
            "1581",
            "2012\/11\/27",
            "$198,500"
        ],
        [
            "Paul Byrd",
            "Chief Financial Officer (CFO)",
            "New York",
            "3059",
            "2010\/06\/09",
            "$725,000"
        ],
        [
            "Gloria Little",
            "Systems Administrator",
            "New York",
            "1721",
            "2009\/04\/10",
            "$237,500"
        ],
        [
            "Bradley Greer",
            "Software Engineer",
            "London",
            "2558",
            "2012\/10\/13",
            "$132,000"
        ],
        [
            "Dai Rios",
            "Personnel Lead",
            "Edinburgh",
            "2290",
            "2012\/09\/26",
            "$217,500"
        ],
        [
            "Jenette Caldwell",
            "Development Lead",
            "New York",
            "1937",
            "2011\/09\/03",
            "$345,000"
        ],
        [
            "Yuri Berry",
            "Chief Marketing Officer (CMO)",
            "New York",
            "6154",
            "2009\/06\/25",
            "$675,000"
        ],
        [
            "Caesar Vance",
            "Pre-Sales Support",
            "New York",
            "8330",
            "2011\/12\/12",
            "$106,450"
        ],
        [
            "Doris Wilder",
            "Sales Assistant",
            "Sidney",
            "3023",
            "2010\/09\/20",
            "$85,600"
        ],
        [
            "Angelica Ramos",
            "Chief Executive Officer (CEO)",
            "London",
            "5797",
            "2009\/10\/09",
            "$1,200,000"
        ],
        [
            "Gavin Joyce",
            "Developer",
            "Edinburgh",
            "8822",
            "2010\/12\/22",
            "$92,575"
        ],
        [
            "Jennifer Chang",
            "Regional Director",
            "Singapore",
            "9239",
            "2010\/11\/14",
            "$357,650"
        ],
        [
            "Brenden Wagner",
            "Software Engineer",
            "San Francisco",
            "1314",
            "2011\/06\/07",
            "$206,850"
        ],
        [
            "Fiona Green",
            "Chief Operating Officer (COO)",
            "San Francisco",
            "2947",
            "2010\/03\/11",
            "$850,000"
        ],
        [
            "Shou Itou",
            "Regional Marketing",
            "Tokyo",
            "8899",
            "2011\/08\/14",
            "$163,000"
        ],
        [
            "Michelle House",
            "Integration Specialist",
            "Sidney",
            "2769",
            "2011\/06\/02",
            "$95,400"
        ],
        [
            "Suki Burks",
            "Developer",
            "London",
            "6832",
            "2009\/10\/22",
            "$114,500"
        ],
        [
            "Prescott Bartlett",
            "Technical Author",
            "London",
            "3606",
            "2011\/05\/07",
            "$145,000"
        ],
        [
            "Gavin Cortez",
            "Team Leader",
            "San Francisco",
            "2860",
            "2008\/10\/26",
            "$235,500"
        ],
        [
            "Martena Mccray",
            "Post-Sales support",
            "Edinburgh",
            "8240",
            "2011\/03\/09",
            "$324,050"
        ],
        [
            "Unity Butler",
            "Marketing Designer",
            "San Francisco",
            "5384",
            "2009\/12\/09",
            "$85,675"
        ],
        [
            "Howard Hatfield",
            "Office Manager",
            "San Francisco",
            "7031",
            "2008\/12\/16",
            "$164,500"
        ],
        [
            "Hope Fuentes",
            "Secretary",
            "San Francisco",
            "6318",
            "2010\/02\/12",
            "$109,850"
        ],
        [
            "Vivian Harrell",
            "Financial Controller",
            "San Francisco",
            "9422",
            "2009\/02\/14",
            "$452,500"
        ],
        [
            "Timothy Mooney",
            "Office Manager",
            "London",
            "7580",
            "2008\/12\/11",
            "$136,200"
        ],
        [
            "Jackson Bradshaw",
            "Director",
            "New York",
            "1042",
            "2008\/09\/26",
            "$645,750"
        ],
        [
            "Olivia Liang",
            "Support Engineer",
            "Singapore",
            "2120",
            "2011\/02\/03",
            "$234,500"
        ],
        [
            "Bruno Nash",
            "Software Engineer",
            "London",
            "6222",
            "2011\/05\/03",
            "$163,500"
        ],
        [
            "Sakura Yamamoto",
            "Support Engineer",
            "Tokyo",
            "9383",
            "2009\/08\/19",
            "$139,575"
        ],
        [
            "Thor Walton",
            "Developer",
            "New York",
            "8327",
            "2013\/08\/11",
            "$98,540"
        ],
        [
            "Finn Camacho",
            "Support Engineer",
            "San Francisco",
            "2927",
            "2009\/07\/07",
            "$87,500"
        ],
        [
            "Serge Baldwin",
            "Data Coordinator",
            "Singapore",
            "8352",
            "2012\/04\/09",
            "$138,575"
        ],
        [
            "Zenaida Frank",
            "Software Engineer",
            "New York",
            "7439",
            "2010\/01\/04",
            "$125,250"
        ],
        [
            "Zorita Serrano",
            "Software Engineer",
            "San Francisco",
            "4389",
            "2012\/06\/01",
            "$115,000"
        ],
        [
            "Jennifer Acosta",
            "Junior Javascript Developer",
            "Edinburgh",
            "3431",
            "2013\/02\/01",
            "$75,650"
        ],
        [
            "Cara Stevens",
            "Sales Assistant",
            "New York",
            "3990",
            "2011\/12\/06",
            "$145,600"
        ],
        [
            "Hermione Butler",
            "Regional Director",
            "London",
            "1016",
            "2011\/03\/21",
            "$356,250"
        ],
        [
            "Lael Greer",
            "Systems Administrator",
            "London",
            "6733",
            "2009\/02\/27",
            "$103,500"
        ],
        [
            "Jonas Alexander",
            "Developer",
            "San Francisco",
            "8196",
            "2010\/07\/14",
            "$86,500"
        ],
        [
            "Shad Decker",
            "Regional Director",
            "Edinburgh",
            "6373",
            "2008\/11\/13",
            "$183,000"
        ],
        [
            "Michael Bruce",
            "Javascript Developer",
            "Singapore",
            "5384",
            "2011\/06\/27",
            "$183,000"
        ],
        [
            "Donna Snider",
            "Customer Support",
            "New York",
            "4226",
            "2011\/01\/25",
            "$112,000"
        ]
    ]

$scope.dataTableOpt = {
  //if any ajax call 
  };
});
</script>
<div class="container" ng-app="formvalid">
      <div class="panel" data-ng-controller="validationCtrl">
      <div class="panel-heading border">    
        <h2>Data table using jquery datatable in Angularjs </h2>
      </div>
      <div class="panel-body">
          <table class="table table-bordered bordered table-striped table-condensed datatable" ui-jq="dataTable" ui-options="dataTableOpt">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Position</th>
              <th>Office</th>
              <th>Age</th>
              <th>Start Date</th>
            </tr>
          </thead>
            <tbody>
              <tr ng-repeat="n in data">
                <td>{{$index+1}}</td>
                <td>{{n[0]}}</td>
                <td>{{n[1]}}</td>
                <td>{{n[2]}}</td>
                <td>{{n[3]}}</td>
                <td>{{n[4] | date:'dd/MM/yyyy'}}</td>
              </tr>
            </tbody>
        </table>
      </div>
    </div>
    </div> 
```

# performance - WordPress 网站上的高延迟 4-6 秒

> ID：14242456
> 
> 赞同：2
> 
> 时间：2013-01-09T17:02:45.163
> 
> 标签：performance, wordpress, optimization, latency, load-time

我有一些网站的加载时间很慢。都是 WordPress 3.5。所有都通过 BlueHost 托管。所有都是由我开发的（作为现有 WP 主题的子主题构建）。

使用 Safari 开发人员工具，我发现它们在发生任何事情之前平均有 4-6 秒（不是毫秒）的延迟，这似乎异常高。我试图解决延迟问题，我知道我不是唯一一个在这里问这个问题的人......但我无法弄清楚主要罪魁祸首是我的托管服务提供商（Bluehost）还是我的开发。

以下是我的几个有问题的网站：

[http://www.HubbardProductions.com](http://www.HubbardProductions.com)

[http://www.xla.com](http://www.xla.com)

谁能指出我正确的方向？我能做些什么来减少延迟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:02:06.613

克里斯，同样的问题。还有 Bluehost + Wordpress 3.5。

几分钟前，我的网站甚至出现故障，我什至无法访问 cPanel。我收到以下错误：

> **Auth failed69.89.31.120:2083 暂时关闭。**

我联系了技术人员，他们告诉我再试一次，删除cookies，还给我发了这个url：

[https://my.bluehost.com/cgi/help/481](https://my.bluehost.com/cgi/help/481)

在我的情况下，这没什么帮助，但也许它可以帮助你。

我问他们最近服务器是否有任何问题，他们说没有，没有问题。

所以，为了回答你的问题，我会：

1.  等几天，以防它是暂时的（我希望）。
2.  如果没有，我会用简单的 html 页面运行一些测试，然后是 php，然后是 php + 简单的 SQL 等，以找出瓶颈，以及它是服务器问题还是 wordpress 问题。
3.  如果我发现这是服务器问题，我会抱怨。
4.  如果一切都失败了，我会把我的网站移到其他主机上。再见 Bluehost。:(

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:06:24.237

你可以从这里看到。您的网站最近正在响应。[http://i.imgur.com/VIVoq.png](http://i.imgur.com/VIVoq.png)

[http://tools.pingdom.com/fpt/#!/jyKI0Kv01/http://hubbardproductions.com/](http://tools.pingdom.com/fpt/#!/jyKI0Kv01/http://hubbardproductions.com/)

# php - 将嵌套行与动态 ORDER BY 和 LIMIT / 分页保持在一起

> ID：14242457
> 
> 赞同：1
> 
> 时间：2013-01-09T17:02:45.647
> 
> 标签：php, mysql, sql, postgresql, parent

考虑需要像这样显示数据的情况：

```
Parent 1 info
    Child 1A info
    Child 1B info
    ...
Parent 2 info
    Child 2A info
    Child 2B info
    ... 
```

请注意，孩子只深入一层，因此无需进入数据库级别的“嵌套集”。比如我现在的项目中，数据需要这样显示：

```
First name  | Last name | City  | ...
---------------------------------
John        | Doe       | Denver

    Sales:
    ---------------------
    Date    | Total | ...
    -----------------
    Jan 1   | $100
    Jan 15  | $200
    Feb 1   | $100

Suzie       | Springer  | New York

    Sales:
    ---------------------
    Date    | Total | ...
    -----------------
    ... 
```

我的问题是关于获取此页面数据所需的 SQL，同时仍通过使用 LIMIT 子句（或等效子句）进行分页。

在这种情况下，应首先列出最近销售的帐户，但当然每个帐户都需要将其所有销售记录在其下，直到一年前。

让我先问一个更简单的情况：假设排序顺序无关紧要。然后我可以简单地按帐户 ID 排序（简化示例）：

```
SELECT sh.account_id, a.first_name, a.last_name,
    sh.sale_id, sh.total, sh.payment_time
FROM sales_header sh
JOIN account a on sh.account_id = a.account_id
WHERE a.account_type = 'parent'
ORDER BY sh.account_id 
```

但是，当引入分页时，如何确保将特定帐户的所有销售额保存在一起？很难知道 LIMIT 应该有多大。

现在让我们添加所需的真正排序顺序：

```
SELECT sh.account_id, a.first_name, a.last_name,
    sh.sale_id, sh.total, sh.payment_time
FROM sales_header sh
JOIN account a on sh.account_id = a.account_id
WHERE a.account_type = 'parent'
ORDER BY sh.payment_time 
```

检索所有行时，没有问题——我可以简单地运行查询，然后在我的应用程序代码（本例中为 PHP）中按 account_id 对结果进行索引。

但是，如果我添加一个 LIMIT，那么我可能无法获得每个帐户的所有销售额，尤其是对于既有旧销售额又有近期销售额的账户。

我已经想出了一个解决方案，但它相当复杂，特别是因为我正在处理动态查询参数而不是我在这里展示的简化版本。我的解决方案是运行两个单独的查询。

首先，获取我需要的所有帐户 ID：

```
SELECT DISTINCT sh.account_id
FROM sales_header sh
JOIN account a on sh.account_id = a.account_id
WHERE a.account_type = 'parent'
ORDER BY sh.payment_time
LIMIT 10 
```

然后，将 ID 放入名为 $account_ids 的 PHP 数组中，然后构建返回显示页面所需的实际结果的查询：

```
$sql = 'SELECT sh.account_id, a.first_name, a.last_name,
    sh.sale_id, sh.total, sh.payment_time
FROM sales_header sh
JOIN account a on sh.account_id = a.account_id
WHERE sh.account_id IN ('. implode(',', $account_ids). ')
ORDER BY sh.payment_time'; 
```

当然，这也可以通过将第一个查询的 SQL 放在 implode() 函数所在的位置，在单个查询中完成，例如：

```
WHERE sh.account_id IN (SELECT DISTINCT sh.account_id ... LIMIT 10) 
```

但这引起了对子查询和数据库可移植性限制的担忧——我正在使用一个框架，该框架允许您使用可移植到不同数据库的 limit() 方法设置限制，但我不确定如果它会如何反应例如，我尝试在 SQL Server 这样的子查询中使用限制。

所以，我真正的问题是：这是解决问题的最佳方法，还是有替代（更简单）的解决方案？你在类似的情况下做了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:25:29.110

```
SELECT
    sh.account_id, a.first_name, a.last_name,
    sh.sale_id, sh.total, sh.payment_time
FROM
    sales_header sh
    inner JOIN
    account a on sh.account_id = a.account_id
    inner join (
        SELECT sh.account_id, max(sh.payment_time) payment_time
        FROM
            sales_header sh
            inner JOIN
            account a on sh.account_id = a.account_id
        WHERE a.account_type = 'parent'
        group by sh.account_id
        order by 2 desc
        limit 10
    ) acs on acs.account_id = a.account_id
ORDER BY acs.payment_time desc, acs.account_id, sh.payment_time desc 
```

我试图使它与 db 无关，但该`limit`子句必须`select top 10`在 Sql Server 中翻译。

# android - 如何从 ListFragment 访问资源字符串

> ID：14242458
> 
> 赞同：1
> 
> 时间：2013-01-09T17:02:46.353
> 
> 标签：android

我是 Android 开发的新手，所以也许我错过了一些非常简单的东西，但我似乎无法访问由 ADT 中的模板创建的`res/values/strings.xml`字符串资源`ListFragment`。`MasterDetailFlow`

看起来加载了不同的资源文件，因为当我键入时`R.string.`，自动完成会提示一大堆我没有创建的字符串。（例如取消、剪切、粘贴、emptyPhoneNumber）

这些字符串资源来自哪里，如何访问我自己的字符串资源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:05:05.217

删除对 android.R 的错误导入并添加您自己项目的 R。

# html - 创建一个选择可下载文件的表单

> ID：14242466
> 
> 赞同：1
> 
> 时间：2013-01-09T17:03:08.950
> 
> 标签：html, forms

我想创建一个具有一个下拉列表的表单 - 这些下拉列表引用一个文件，然后客户可以在选择时下载该文件。

我不确定执行此操作的最佳方法，并且在搜索了几个小时后没有找到任何帮助

这是我到目前为止所拥有的：

```
<form action="">
    <select>
        <option value="/downloads/file1.pdf">File 1</option>
        <option value="/downloads/file2.pdf">File 2</option>
        <option value="/downloads/file3.pdf">File 3</option>
        <option value="/downloads/file4.pdf">File 4</option>
        <option value="/downloads/file5.pdf">File 5</option>
    </select>
    <input value="Download" class="grey-btn" />
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:11:18.700

你可以使用这样的代码：

```
<form onsubmit="this.action = document.getElementById('filename').value">
    <select id="filename">
        <option value="/downloads/file1.pdf">File 1</option>
        <option value="/downloads/file2.pdf">File 2</option>
        <option value="/downloads/file3.pdf">File 3</option>
        <option value="/downloads/file4.pdf">File 4</option>
        <option value="/downloads/file5.pdf">File 5</option>
    </select>
    <input type="submit" value="Download" class="grey-btn" />
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:08:55.677

您需要在您的选择上加上一个名称，以便轻松地使用 JavaScript 连接到它。

```
<select name="files"> 
```

然后你需要在你的按钮上的一个事件来调用一个函数：

```
<input value="Download" onclick="download()" class="grey-btn" /> 
```

JS函数：

```
function download() {
    //get the filename from the selected item
    var sel = document.forms[0].files[document.forms[0].files.selectedIndex].value;
    //redirect to this file
    document.location = sel;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:21:54.257

试试这样：

**使用 jQuery：**

```
<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="content-type" content="text/html" />
    <title>Download</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
<select id="dwl">
<option value="/downloads/file.pdf">File 1</option>
<option value="/downloads/file2.pdf">File 2</option>
<option value="/downloads/file3.pdf">File 3</option>
<option value="/downloads/file4.pdf">File 4</option>
<option value="/downloads/file5.pdf">File 5</option>
</select>
<input type="button" onclick="window.location.href=$('#dwl').val()" value="Download" class="grey-btn" />
</body>
</html> 
```

**或者，只是纯 JavaScript：**

```
<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="content-type" content="text/html" />
    <title>Download</title>
<body>
<select id="dwl">
<option value="/downloads/file.pdf">File 1</option>
<option value="/downloads/file2.pdf">File 2</option>
<option value="/downloads/file3.pdf">File 3</option>
<option value="/downloads/file4.pdf">File 4</option>
<option value="/downloads/file5.pdf">File 5</option>
</select>
<input type="button" onclick="window.location.href=document.getElementById('dwl').value" value="Download" class="grey-btn" />
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:44:00.017

如果我理解正确，这应该可以满足您的要求：

首先将您的 HTML 更新为：

```
<form method="POST" action="dl-file.php">
    <select id="filename" name="filename">
        <option value="file1.pdf">File 1</option>
        <option value="file2.pdf">File 2</option>
        <option value="file3.pdf">File 3</option>
        <option value="file4.pdf">File 4</option>
        <option value="file5.pdf">File 5</option>
    </select>

    <input type="submit" value="Download" class="grey-btn" />
 </form> 
```

然后在 HTML 文件所在的同一目录中创建一个新文件，并将其命名为**dl-file.php**并将其放入其中：

```
<?php
    // Put any files you don't want the user to download here
    $exclude_files = array('.htaccess', '.DS_STORE', '.htpasswd');

    // full path to the download directory
    $download_directory = 'C:\xampp\htdocs\test\filedlselect/downloads/';

    $file_to_download = filter_input(INPUT_POST, 'filename', FILTER_SANITIZE_STRING);

    $full_path = $download_directory . $file_to_download;

    if (!in_array($file_to_download, $exclude_files) && 
        file_exists( $full_path ) && is_readable( $full_path )) {
        header('Pragma: public');
        header('Expires: 0');
        header('Cache-control: must-revalidate, post-check=0, pre-check=0');
        header('Last-modified: ' . gmdate('D, d M Y H:i:s', filemtime($full_path)) . 'GMT');
        header('Cache-control: private', false);
        header('Content-type: application/force-download');
        header('Content-disposition: attachment; filename="' . basename($full_path) . '"');
        header('Content-Transfer-Encoding: binary');
        header('Content-Length: ' . filesize($full_path));
        header('Connection: close');
        readfile($full_path);
        exit;
    } else {
        die('invalid file');
    }
?> 
```

第三，编辑`$download_directory`以包含该文件夹在硬盘驱动器上的确切`/downloads/`位置。或者，您可以将文件添加到`$exclude_files`阵列中。

# mysql - 来自不同列的 SQL 总和

> ID：14242468
> 
> 赞同：0
> 
> 时间：2013-01-09T17:03:11.020
> 
> 标签：mysql

我有两个出价列*bidsprice1*和*bidsprice2*的出价表。并且所有用户都有*bidsprice1 金额*，有些用户也有*bidsprice2 金额*。

我想计算`sum(bidsprice2)`基于`bidsprice2`，如果某些用户有 null `bidsprice2`，那么基于它的`bidsprice1`.

如何编写这个求和查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:05:39.147

用于[`COALESCE()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)返回第一个非 NULL 参数。那可以直接包裹在聚合里面`SUM()`。这样做的好处是可以在需要时添加额外的列。

```
SELECT
  /* SUM() based on bidsprice2 if non-null, bidsprice1, or finally 0 if both NULL */
  SUM(COALESCE(bidsprice2, bidsprice1, 0)) AS your_sum
FROM yourtable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:06:35.953

```
SUM(CASE WHEN bidsprice2 IS NULL THEN bidsprice1 ELSE bidsprice2 END) 
```

在 MySQL 中

# jquery - UI 选项卡设置标题

> ID：14242472
> 
> 赞同：0
> 
> 时间：2013-01-09T17:03:23.480
> 
> 标签：jquery, html, css, tabs, jquery-ui-tabs

我正在尝试在选项卡中设置标题，但标题显示在背景后面。如果在这个类中#tabss .ui-tabs-nav 我设置背景：透明；然后显示我的标题，否则显示在背景后面。

代码CSS：

```
#tabss {
padding: 0px;
background: none;
border-width: 0px;
position: relative;
width:100%;
height:100%;
zoom:1;
}

#tabss .ui-tabs-nav {
background: url("img/top-bg-column.gif") repeat;
border:0px;
//background: transparent;
text-align: right;
zoom:2;
height:30px;
border-radius: 4px 4px 0px 0px;
}
#tabss .ui-tabs-nav li { display: inline-block; float: none; border-color:#dfdfdf; position: relative; top: 1px; margin: 1px 0 0 0;  white-space: nowrap; }
#tabss .ui-tabs-nav li a { color:#222; background: url("img/top-bg-column-hover.gif"); font-weight:normal; padding:2px 10px 4px 10px; }
#tabss .ui-tabs-nav li a:hover { color:#666; background:#f7f7f7; }
#tabss .ui-tabs-nav li.ui-tabs-selected a { background:#f7f7f7; color:#666;  }
#tabss .ui-tabs-nav li.ui-tabs-selected { top:3px; }
#tabss .ui-tab-title { position: absolute; left: 0px; top: 0px; font-size:18px; color:red; zoom:3; }
#tabss .ui-tabs-panel {
background-color:#f7f7f7;
border-color:#dfdfdf;
border-width: 0px 1px 1px 1px;
-moz-border-radius: 0px 0px 4px 4px;
-webkit-border-radius: 0px 0px 4px 4px;
border-radius: 0px 0px 4px 4px;
padding: 10px;
 } 
```

代码html：

```
<div id="tabss" class="tabs">
  <p class="ui-tab-title">My Title</p>
   <ul>
    <li><a href="#tabs-1">Tab 1</a></li>-->
    <li><a href="#tabs-2">Tab 2</a></li>
  </ul>
  <div id="tabs-1">
   // data
  </div>
 <div id="tabs-2">
   // data
  </div>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:35:13.510

将您的 HTML 更改为以下内容。已删除`<p class="ui-tab-title">My Title</p>`

```
<div id="tabss" class="tabs">
   <ul>
    <li><a href="#tabs-1">Tab 1</a></li>-->
    <li><a href="#tabs-2">Tab 2</a></li>
  </ul>
  <div id="tabs-1">
   // data
  </div>
 <div id="tabs-2">
   // data
  </div>
 </div> 
```

然后在创建 UI 选项卡后添加以下代码。

```
$('#tabss').prepend('<p class="ui-tab-title">My Title</p>'); 
```

** 如果这不是您想要的，请更新更多详细信息

# ios - Objective-C：不匹配的方法和语法

> ID：14242479
> 
> 赞同：0
> 
> 时间：2013-01-09T17:03:34.120
> 
> 标签：ios, objective-c, nsarray, nsdictionary

我正在尝试创建一个分段表。我有两个已解析的 NSMutableArrays feedsTopics 和 feedsSchools，它们驻留在我的 mainAppDelegate 中。

在我的 tableViewController 中，我创建了一个 appDelegate 代表我的应用程序的委托：

```
appDelegate = (mainAppDelegate *)[[UIApplication sharedApplication] delegate]; 
```

我正在尝试将主题和学校声明为这样的数组（这是一个错误，内容为“选择器'appDelegate'没有已知的类方法”，只是说这就是我所要做的）：

```
NSArray *topics = [[NSArray appDelegate] feedsTopics]; 
```

我想像这样将它作为字典对象添加到 NSMutableArray listOfItems 中（这有一个错误，说它“需要一个标识符”）：

```
NSDictionary *topicsDict = [NSDictionary dictionaryWithObject:appDelegate.feedsTopics forKey:[@"News by Topic"]; 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:14:47.517

第一个错误是由调用一个`appDelegate`方法引起的`NSArray`- this 不存在。第二个错误是由放错位置引起的`[`。

您的代码应如下所示：

```
NSArray *topics = [appDelegate feedsTopics]; 
```

和

```
NSDictionary *topicsDict = [NSDictionary dictionaryWithObject:topics forKey:@"News by Topic"]; 
```

顺便说一句：您的错误根本与 tableViews 无关。我建议编辑这个问题的标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T19:19:30.907

该错误是由以下行引起的：

```
NSArray *topics = [[NSArray appDelegate] feedsTopics]; 
```

NSArray 没有方法“appDelegate”。

# c# - 带有枚举数组的 C# 反射

> ID：14242480
> 
> 赞同：2
> 
> 时间：2013-01-09T17:03:38.383
> 
> 标签：c#, .net, reflection, enums

我有一个自定义枚举类：

```
public enum Capabilities{
 PowerSave= 1,
 PnP =2,
 Shared=3, } 
```

我的课

```
public class Device
{
       ....
  public Capabilities[] DeviceCapabilities
  {
     get { // logic goes here}
  } 
```

有没有办法在运行时使用反射来获取该字段的值？我尝试了以下但得到空引用异常

```
PropertyInfo[] prs = srcObj.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);
 foreach (PropertyInfo property in prs)
 {
     if (property.PropertyType.IsArray)
     {
         Array a = (Array)property.GetValue(srcObj, null);
     }    
 } 
```

编辑：感谢您的回答，我真正需要的是一种无需指定枚举类型即可动态获取值的方法。就像是：

```
string enumType = "enumtype"
var property = typeof(Device).GetProperty(enumType); 
```

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:09:10.220

以下应该做你想要的。

```
var property = typeof(Device).GetProperty("DeviceCapabilities");

var deviceCapabilities = (Capabilities[])property.GetValue(device); 
```

请注意，该方法`Object PropertyInfo.GetValue(Object)`是 .NET 4.5 中的新方法。在以前的版本中，您必须为索引添加一个附加参数。

```
var deviceCapabilities = (Capabilities[])property.GetValue(device, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:08:18.893

这应该有效：

```
 var source = new Device();

    var property = source.GetType().GetProperty("DeviceCapabilities");
    var caps = (Array)property.GetValue(source, null);

    foreach (var cap in caps)
        Console.WriteLine(cap); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:13:42.817

如果要枚举 Enum 的所有可能值并以数组形式返回，请尝试以下辅助函数：

```
public class EnumHelper {
    public static IEnumerable<T> GetValues<T>()
    {
        return Enum.GetValues(typeof(T)).Cast<T>();
    }
} 
```

然后你可以简单地调用：

```
Capabilities[] array = EnumHelper.GetValues<Capabilities>(); 
```

如果那不是您所追求的，那么我不确定您的意思。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T20:37:18.580

你可以试试这个

```
foreach (PropertyInfo property in prs)
{
    string[] enumValues = Enum.GetNames(property.PropertyType);
} 
```

希望能帮助到你。

# java - FuseESB 的奇怪输出

> ID：14242483
> 
> 赞同：0
> 
> 时间：2013-01-09T17:03:47.880
> 
> 标签：java, apache-camel, apache-servicemix, fuseesb

我正在解析请求。我在 Java 中开发了用于解析传入请求的路由。

我正在使用带有 FuseESB 7.0.1.0.84 的 Camel 2.9。

我曾经`simple(“{body}”).getText()`按照骆驼手册获取传入的请求

所以我使用以下代码检查传入的请求：

```
if (xmlStringToParse == null || xmlStringToParse.equals("") || xmlStringToParse.equals("${body}")) {

            parsedXMLPath = "<error>Incoming request is as folows:"
                    + "\nValue of xmlStringToParse: " + xmlStringToParse
                    + "\n xmlStringToParse is empty: " + (xmlStringToParse.equals(""))
                   + "\n xmlStringToParse equals ${body}: " + (xmlStringToParse.equals("${body}"))
                    + "\nAgain checking incoming request:\n" + xmlStringToParse
                    + "</error>";
        } 
```

在哪里`xmlStringToParse = simple(“${body}”).getText()`

观察到的奇怪结果：

从soap request 到""的值`xmlStringToParse`仅在一行中改变。此外，“<code>xmlStringToParse equals ${body}”打印为“<code>xmlStringToParse equals”而不打印`${body}`。`${body}`不打印在日志中。

您可以找到以下日志输出：

```
 <error>
    Value of xmlStringToParse: <somesoapRequest>
    xmlStringToParse is empty: false
   xmlStringToParse equals : true
  Again checking incoming request:
 </error> 
```

谁能告诉我如何解决这个问题以及这种奇怪行为的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T08:55:14.687

> 我使用 simple(“{body}”).getText() 根据 Camel Manual 获取传入请求

你在哪里看到的？你有链接吗？

您应该以另一种方式获取消息正文，而不是您所做的，例如

```
String body = exchange.getIn().getBody(String.class); 
```

或者如果你使用bean参数绑定，你可以绑定消息体，只需声明参数为String类型

```
public void foo(String body) {
   ...
} 
```

在 Camel 文档中查看更多详细信息，例如：[http ://camel.apache.org/bean-binding.html](http://camel.apache.org/bean-binding.html)

# python - Python：为什么我会收到 UnicodeDecodeError？

> ID：14242486
> 
> 赞同：1
> 
> 时间：2013-01-09T17:03:51.360
> 
> 标签：python, file-io, python-unicode

我有以下代码使用 RE 搜索文件，如果找到任何匹配项，它会将文件移动到不同的目录中。

```
import os
import gzip
import re
import shutil

def regEx1():
    os.chdir("C:/Users/David/myfiles")
    files = os.listdir(".")
    os.mkdir("C:/Users/David/NewFiles")
    regex_txt = input("Please enter the string your are looking for:")
    for x in (files):
        inputFile = open((x), "r")
        content = inputFile.read()
        inputFile.close()
        regex = re.compile(regex_txt, re.IGNORECASE)
        if re.search(regex, content)is not None:
            shutil.copy(x, "C:/Users/David/NewFiles") 
```

当我运行它时，我收到以下错误消息：

```
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
  File "C:\Python33\Lib\encodings\cp1252.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
UnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in position 367: character maps to <undefined> 
```

请有人解释为什么会出现此消息

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T17:06:38.137

在 python 3 中，当您以文本模式 ( ) 打开文件进行读取时，`r`它会将包含的文本解码为 un​​icode。

由于您没有指定用于读取文件的编码，[`locale.getpreferredencoding`](http://docs.python.org/3/library/locale.html#locale.getpreferredencoding)因此正在使用平台默认值 (from )，在这种情况下会失败。

您需要指定*可以*解码文件内容的编码，或者改为以二进制模式打开文件（并`b''`为正则表达式使用字节模式）。

有关更多信息，请参阅[Python Unicode HOWTO](http://docs.python.org/3/howto/unicode.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:45:49.163

我对 python 3x 不太熟悉，但下面可能会起作用。

```
inputFile = open((x, encoding="utf8"), "r") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-09T03:01:12.320

这里有一个类似的问题： [Python: Traceback codecs.charmap_decode(input,self.errors,decoding_table)[0]](https://stackoverflow.com/questions/12213178/python-traceback-codecs-charmap-decodeinput-self-errors-decoding-table0)

但您可能想尝试：

```
 open((x), "r", encoding='UTF8') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-15T09:58:27.957

非常感谢您提供此解决方案。它对我的另一个主题有帮助，我用过：

```
exec (open ("DIP6.py").read ()) 
```

我收到了这个错误，因为我在 DIP6.py 的评论中有这个符号：

```
 #       ● en première colonne 
```

它适用于：

```
exec (open ("DIP6.py", encoding="utf8").read ()) 
```

它还解决了以下问题：

```
print("été") for example 
```

在 DIP6.py

我有 ：

```
Ã©tÃ© 
```

在控制台中。

谢谢 ：-） 。

# r - wget 选项将输出直接输出到 R

> ID：14242490
> 
> 赞同：3
> 
> 时间：2013-01-09T17:03:56.547
> 
> 标签：r, wget

我有一个 wget_string 和命令如下：

```
wget_string <- paste("wget --user=" , u_name , " --password=", p_word,     " ", my_urls,' -qO ', file_name,   sep="")
 system(wget_string)
 readLines(file_name) 
```

哪个有效，但是我必须使用 readLines() 将文件读入 R。我想运行该命令，以便该文件直接在 R 中可用，而无需保存到硬盘然后从中加载。

我希望通过将文件直接从网络加载到 R 来节省资源。由于安全服务器，不能从一开始就使用 readlines。有哪些选择？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-09T17:12:56.637

函数具有的`intern=TRUE`参数。`system`从它执行的命令中捕获输出。使用力和正确的选项`wget`打印到标准输出：

```
> wget_string="wget -qO- http://www.google.com"
> s = system(wget_string,intern=TRUE) 
```

如果您返回的数据是 CSV 文件，`textConnection`您可以使用，将其提供给`read.csv`您。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T17:10:54.683

如果您使用`-O -`选项`wget`将输出设置为`standar output`（直接在屏幕上书写）。通过这种方式，您可以直接从 wget 命令的输出中读取。

例如

```
 wget -O - http: //www.address.com 
```

将下载网页并直接打印到`standard output`. 所以你可以直接读取`system(wget_string)`.

从`wget`手册页：

> -O file --output-document=file 文件不会被写入相应的文件，但所有文件将被连接在一起并写入文件。 **如果 - 用作文件，文档将打印到标准输出**，禁用链接转换。（使用 ./- 打印到一个字面上命名为 - 的文件。）

# c++ - 在一行上定义多个变量，这是否为构建过程提供任何优化？

> ID：14242491
> 
> 赞同：3
> 
> 时间：2013-01-09T17:03:56.993
> 
> 标签：c++

在一行上定义多个变量是否为构建过程提供了某种形式的优化，或者它只是一种编码风格的选择？

例如会这样：

```
void foo()
{
    int a, b, c, d;

    ..... // do something with a,b,c and d
} 
```

对此提供任何优化：

```
void bar()
{
    int a;
    int b;
    int c;
    int d;

    ..... // do something with a,b,c and d
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:05:16.037

没有值得这样称呼的优化。

唯一的好处是加载到内存和解析的字符稍微少一些。我怀疑你甚至可以衡量差异。

酌情使用与团队其他成员或您的个人偏好一致的编程风格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:09:57.773

可能，是的。较小的输入文件对于编译器来说读取速度更快。但这在很大程度上取决于编译器的实现。如果您有兴趣以独立于编译器的方式减少构建时间，可以进行许多其他优化。**John Lakos 的Large-Scale C++ Software Design**是一本非常值得阅读的书。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:05:41.733

这只是编码风格的一种选择。就个人而言，我讨厌在一行上定义多个变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:07:15.547

例如，就毫秒而言，您几乎看不到任何差异。但是，是的，存在差异，一行变量的编译速度比其他变量快。

# php - 这个针对垃圾邮件的简单概念有效吗？（需要优化？）

> ID：14242501
> 
> 赞同：1
> 
> 时间：2013-01-09T17:04:40.500
> 
> 标签：php, javascript, jquery, bots, spam

**介绍**

我们在早期的项目中处理了一些垃圾邮件问题，并通过以下简单概念防止任何垃圾邮件机器人。我现在想将其实施到一个更大的项目中。在我这样做之前，我希望对其进行优化，使其在同一页面上以多种形式工作，但我还没有得到诀窍，或者我不确定如果它没用，是否值得将它重建为更复杂的版本。

*澄清一下：我不想处理 CAPTCHA 或类似的事情。只需做一个本地解决方案。*

**概念**

如果用户关注`input`表单的任何字段，则将发送 AJAX 查询，其中将生成随机哈希标签并将其存储到`$_SESSION`变量中。这个散列也将被写入一个名为`spamKey`（例如）的隐藏输入字段。

用户提交表单后，我检查`$_SESSION["spamKey"]`变量是否等于`$_POST["spamKey"]`变量，因此我决定是否处理查询。

**编码**

*简单的模式*

```
<form action="index.php" method="post" id="formOne">

    <label for='input_eins'>Name</label>
        <input type='text' id='input_eins' name='name' />
    <label for='input_user'>E-Mail</label>
        <input type='text' id='input_user' name='user' />
    <label for='ta_text'>Comment</label>
        <textarea name='text'></textarea>
    <label for='input_spamKey'>spamKey</label>
        <input type='text' id='input_spamKey' name='spamKey' />
    <input type='submit' value='Senden'>
</form> 
```

*script.js（使用 jQuery）*

```
var spamKey = false;
$("#formOne > input").focus(function() {
         if(spamKey == false) {
        dataString = "action=getSpamKey";
        $.ajax({
            url: 'asyncresponse.php',
            data: dataString,
            type: "POST",
            success: function(data) {
                $("#input_spamKey").val(data);
                if(data != "") {
                    spamKey = true;
                }
              }
        });
    }
}); 
```

*asyncresponse.php（信息：POST-Variables 已清理）*

```
if($_POST["action"] == "getSpamKey") {
    $spamKey = md5(time().microtime());
    $_SESSION["spamKey"] = $spamKey;
    echo $spamKey;
} 
```

*PHP中的检查例程*

```
($_SESSION["spamKey"] == $_POST["spamKey"] && !empty($_SESSION["spamKey"])) 
```

**好的 - 我的问题是什么？**

您建议我采取哪些步骤来保护多种表格？并且可能是一个基本问题 - 这是处理垃圾邮件问题的有效解决方案吗？

提前感谢您的帮助。

您可以在这里找到一个简单的演示：http: [//godesign.ch/labor/antispam/index.php](http://godesign.ch/labor/antispam/index.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:10:39.753

验证码曾经是防止垃圾邮件的有效方法。它现在被破坏了，因为它被广泛实施，创造了破坏它的经济动机（谷歌“验证码被破坏”）。

我已经看到这种方法在项目中很有效。你冒着有人在某个时候会被激励打破它的风险。正确实施，我相信它在这个时间点提供了合理的防止垃圾邮件的保护。

# c++ - 字符串文字中的反斜杠字符

> ID：14242504
> 
> 赞同：1
> 
> 时间：2013-01-09T17:04:47.820
> 
> 标签：c++, c

为什么是以下程序的输出：

```
str                 str 
```

而不是这个：

```
str str 
```

这是程序：

```
#include <iostream>

int main()
{
   std::cout << "str \
                str \n";
} 
```

我尝试了 gcc 4.7.2 和 MSVC-11.0。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T17:05:56.593

因为`\`在换行符之前表示行继续。^* 所以你的两条线实际上是拼接在一起的，包括所有的空格。

你可以试试这个：

```
std::cout << "str "
                "str \n"; 
```

因为相邻的字符串文字是连接的。

* * *

[* 来自 C99，第 5.1.1.2 节：

> 每个反斜杠字符 ( `\`) 的实例后面紧跟一个换行符都被删除，拼接物理源代码行以形成逻辑源代码行。] 

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T17:06:15.010

反斜杠被预处理器替换，规则如下：每个`\`后跟换行符的序列都被删除。

> **C11 (n1570), § 5.1.1.2 翻译阶段**
> 每个反斜杠字符 ( `\`) 的实例都被删除，紧跟一个换行符，将物理源代码行拼接成逻辑源代码行。

一个常见的解决方案是使用相邻的字符串字面量连接。

```
std::cout << "str"
             "str\n"; 
```

> **C11 (n1570), § 5.1.1.2 翻译阶段**
> 相邻的字符串文字标记被连接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-09T17:07:01.130

换行符前的反斜杠表示字符串在下一行继续。下一行的前面有许多空白字符。

尝试：

```
std::cout << "str " 
                "str \n"; 
```

# c# - 带有 WCF Web 服务的 C# 传统服务器

> ID：14242505
> 
> 赞同：6
> 
> 时间：2013-01-09T17:04:48.507
> 
> 标签：c#, wcf

我正在创建一个客户端应用程序，用于从 Yahoo! 下载和显示市场数据！对于大学项目，但这也会向手机发送通知（到目前为止使用谷歌云消息传递）。到目前为止，它是一个 WPF 客户端，而“服务器”是一个类库 - 到目前为止工作。我想知道的是，您能否将此服务器与 WCF 服务混合使用 - 我计划用于注册设备以及接受和解析命令的 WCF 服务。

所以我会调用`.Start()`我的服务器对象，它会一直在后台运行，而 WCF REST 服务会在它旁边运行 - 或者我最好在服务器上运行一个可以接受输入的线程......对不起，如果这很令人困惑，但只是想知道它是否可以，或者之前已经做过或任何建议。:)

只是为了更好地解释

客户端前端和“服务器”在同一台机器上运行——我称它为服务器，因为它不仅更新前端，而且同时发送 GCM 通知。我想知道是否可以添加 WCF 服务，以便更简单地处理将设备添加到数据库（“服务器”从数据库中读取设备 reg id 列表，向这些设备发送通知），方法是允许 android 应用程序通过以下方式获取详细信息REST或类似的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:22:44.050

我将探索将类库包装在 Windows 服务中（这本质上是一个连续运行的进程，并且可以停止/启动/暂停）并将您的 WCF 服务作为客户端通信的 Web 服务。

WCF 客户端服务如何与 Windows 服务通信取决于您 - 是否将数据存储在共享数据库中、将其保存在内存中以及在两者之间使用另一个 WCF 层进行通信等。共享数据库将是最直接的，特别是如果您还想保留数据以供其他应用程序/服务使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:19:03.390

如果您的服务器上有一个通知服务并且有多个 WPF 客户端应用程序连接到它，那么 WCF 服务将会很有用。如果您只有一个应用程序在同一台服务器上运行，那么不确定它是否值得开销。

通常的模式是在 IIS 中托管 WCF 服务，这样它总是在收到第一个请求时启动。WCF 非常灵活，因此您可以托管在 Windows 服务、控制台应用程序等中。

# eclipse - 我应该选择哪种类型的 Eclipse 4 定制 - 应用程序或插件？

> ID：14242513
> 
> 赞同：1
> 
> 时间：2013-01-09T17:05:14.963
> 
> 标签：eclipse, plugins, customization

我想创建一个 Eclipse 4 定制，但我对 Eclipse 开发的这方面不熟悉。

因此，我想问问社区他们会根据以下对 SDK 风格的自定义组件/项目的要求推荐什么：

*   使用自己的向导显示为新项目类型
*   该向导可能会使用一些内置的 java 源/路径对话框，但也会提供一些自己的自定义对话框
*   根据用户选择，向导将从一些模板生成启动代码
*   创建项目后，它将类似于 Java 项目。事实上，如果他们愿意，我想让某人能够将选择的 java 代码编译到不同的 jar 中——所有这些都在这个项目中
*   最后，当在项目资源管理器中的这些新项目类型中，我需要能够执行自定义命令（具有 UI 支持） - 例如“准备自定义扩展”，它将创建 JAR（如果适用）并复制所有相关源/文件夹放入准备位置，然后将其压缩

谢谢，如果我需要澄清任何事情，请告诉我！鲍勃

# javascript - 如何让 jsFiddle 在 Chrome 中工作？

> ID：14242517
> 
> 赞同：6
> 
> 时间：2013-01-09T17:05:28.003
> 
> 标签：javascript, jquery

我不知道为什么，但是 jsFiddle 在 Chrome 中不起作用。直到几天前它都可以正常工作，但是现在，当我打开控制台时，我收到此错误：

```
Uncaught TypeError: Cannot call method 'get' of null 
```

是否存在错误以及我需要做些什么才能使其工作？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-09T17:05:57.523

只需清空缓存，它就会再次工作。

他们构建了一个新版本，带来了许多改进，但他们忘记了处理缓存。

# java - 以编程方式覆盖 log4j 配置：FileAppender 的文件位置

> ID：14242521
> 
> 赞同：10
> 
> 时间：2013-01-09T17:05:37.320
> 
> 标签：java, properties, log4j, overriding

`log4j.properties`是否可以在不创建新附加程序的情况下覆盖已配置的附加程序的“文件”属性？如果是这样 - 如何？

情况是这样的：我有两个 appender，A1 是 ConsoleAppender，A2 是 FileAppender。A2 的“文件”指向一个通用的 error.log：

`log4j.appender.A2.File=error.csv`

此附加程序仅记录错误级别的事件或更糟糕的事件

`log4j.appender.A2.Threshold=error`.

现在我希望将这些错误写入不同的文件，具体取决于哪个类导致了错误，因为有几个类正在创建实例。能够快速查看哪个类创建了错误将有很大帮助，因为它比浏览 error.log 寻找类标签更有帮助。

所以我的想法是覆盖“文件”属性，例如在这些新创建的类的构造函数中，以便它们在不同的文件中记录错误。

提前非常感谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-09T17:16:31.827

要在运行时更改 log4j 属性，请访问此链接

[http://alperkaratepe.wordpress.com/2010/01/16/how-to-change-log4j-properties-at-runtime/](http://alperkaratepe.wordpress.com/2010/01/16/how-to-change-log4j-properties-at-runtime/)

```
 private void updateLog4jConfiguration(String logFile) { 
    Properties props = new Properties(); 
    try { 
        InputStream configStream = getClass().getResourceAsStream( "/log4j.properties"); 
        props.load(configStream); 
        configStream.close(); 
    } catch (IOException e) { 
        System.out.println("Error: Cannot laod configuration file "); 
    } 
    props.setProperty("log4j.appender.FILE.file", logFile); 
    PropertyConfigurator.configure(props); 
 } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-12-31T08:53:44.423

老问题（在谷歌中有很好的索引）。除了 OP 的要求外，还添加了其他方法`log4j.properties`

* * *

# `log4j.properties`在运行时加载的修改

```
private void updateLog4jConfiguration(String logFile) { 
    Properties props = new Properties(); 
    try { 
        InputStream configStream = getClass().getResourceAsStream( "/log4j.properties"); 
        props.load(configStream); 
        configStream.close(); 
    } catch (IOException e) { 
        System.out.println("Errornot laod configuration file "); 
    } 
    props.setProperty("log4j.appender.FILE.file", logFile); 
    LogManager.resetConfiguration(); 
    PropertyConfigurator.configure(props); 
} 
```

*   完整的例子在**[这篇文章中](http://alperkaratepe.wordpress.com/2010/01/16/how-to-change-log4j-properties-at-runtime/)**

* * *

# `log4j.properties`在运行时设置

### 可以手动完成

```
Properties properties = new Properties();
properties.setProperty("log4j.logger.org.hibernate", "ERROR");
// ...

LogManager.resetConfiguration();
PropertyConfigurator.configure(properties); 
```

### 或者通过加载不同的属性文件

```
Properties properties = new Properties();
properties.load(new FileInputStream("/etc/myapp/properties/custom-log4j.properties"));
LogManager.resetConfiguration();
PropertyConfigurator.configure(properties); 
```

* * *

# 虚拟机选项

您可以告诉 log4j 使用`log4j.configuration`VM 选项加载不同的文件

```
java -Dlog4j.configuration=file:///etc/myapp/properties/custom-log4j.properties 
```

*   如果选择此选项，则必须在执行行中提供

# c - 将输入文件拆分为单独的数字，然后将它们用作程序的输入

> ID：14242530
> 
> 赞同：0
> 
> 时间：2013-01-09T17:06:07.867
> 
> 标签：c, file, input, strtok, split

我正在使用代码块并且碰壁了，我想从 .txt 文件中获取两个数字并将它们分配给不同的常量。

说在输入的.txt文件中有10,20我想让a=10和b=20，然后继续用这些数字做进一步的计算。

过去，我使用 'strtok' 从文件中拆分出一个字符串，其中 (" ,:") 是分隔字符串。

```
FILE *fp; char s[1000];
fp=fopen("chris.txt","r"); // opens the file

if (!fp) return 1;
while (fgets(s,1000,fp)!=NULL); //makes the stuff inside the file defined as string s

char*pch;printf("Splitting string \"%s\" into tokens:\n",s);
pch = strtok (s,",");
while (pch !=NULL)
{
printf ("%s\n",pch);
pch= strtok(NULL," ,0.");
} 
```

我想我可以遵循类似的方式，但以某种方式将不同的数字分配给不同的常数。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:17:59.277

```
int a, b;

if (sscanf(s, "%d,%d", &a, &b) != 2) {
    // Error, the format was not "<int>,<int>" 
} 
```

您甚至可以使用`scanf`直接从文件中读取

```
if (fscanf(fp, "%d,%d", &a, &b) != 2) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:05:02.500

使用 wxWidgets 框架，我通常使用[wxTextInputStream](http://docs.wxwidgets.org/2.8/wx_wxtextinputstream.html)来执行这些任务。按照链接查看示例。

如果[wxWidgets](http://www.wxwidgets.org/)不是你的东西，它可能会给你一些想法。

# angularjs - 如何通过评估角度表达式来修改innerHTML

> ID：14242531
> 
> 赞同：18
> 
> 时间：2013-01-09T17:06:11.823
> 
> 标签：angularjs

我正在尝试做这样的事情

```
<div id="{{item.id}}" ng-repeat="item in itemList">
    {{item.innerHTML}}
</div> 
```

item.innerHTML 包含需要去那里的 html，但由于它是 dom 的一部分，因此将其替换为字符串。有没有办法让它替换innerHTML？

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-09T17:37:25.303

您需要使用 ngBindHtml ：

[http://plnkr.co/edit/n1rLzgEZQoa2tJf0qnVZ?p=preview](http://plnkr.co/edit/n1rLzgEZQoa2tJf0qnVZ?p=preview)

在控制器中：

```
$scope.content = "<b>this is bold content</b>"; 
```

html：

```
<div ng-bind-html="content"></div> 
```

您将需要以下模块：

[http://code.angularjs.org/1.0.3/angular-sanitize.js](http://code.angularjs.org/1.0.3/angular-sanitize.js)

请务必将 ngSanitize 声明为模块依赖项，例如：

```
var app = angular.module('angularjs-starter', ["ngSanitize"]); 
```

# node.js - 如何使用 Express 安装 SASS？

> ID：14242536
> 
> 赞同：28
> 
> 时间：2013-01-09T17:06:27.337
> 
> 标签：node.js, express, sass

我正在使用 Express 和 socket.io 创建一个 node.js 应用程序。我想使用 SASS，我看到有一个 npm 包，我不明白如何在 SASS npm 和应用程序之间链接并使其解析 SASS？

更新：我使用 SASS 中间件[https://github.com/andrew/node-sass](https://github.com/andrew/node-sass)安装它并以下列方式包含它：

```
 sass = require('node-sass');

app.configure(function(){
  app.set('port', process.env.PORT || 3000);

  /* other stuff */

  sass.middleware({
    src: __dirname + '/public/stylesheets/sass',
    dest: __dirname + '/public/stylesheets',
    debug: true
  });
}); 
```

但它仍然不起作用

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T17:08:55.197

您需要使用 sass 中间件，例如[这个](https://github.com/andrew/node-sass).

引用文档：

```
var server = connect.createServer(
   sass.middleware({
       src: __dirname
       , dest: __dirname + '/public'
       , debug: true
    }),
   connect.static(__dirname + '/public')
); 
```

如果使用 express，只需添加：

```
 app.use(
     sass.middleware({
         src: __dirname + '/sass', //where the sass files are 
         dest: __dirname + '/public', //where css should go
         debug: true // obvious
     })
 ); 
```

接您的`app.configure()`电话。

当然，在生产系统上，将 sass 预编译为 css 是一个更好的主意。

**更新**

在上面的示例中，中间件将`sass`在`__dirname + '/sass/css'`. 此外，默认情况下，它会查找带有`.scss`扩展名的文件。似乎没有更改扩展名的选项。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-09-03T10:10:21.523

如果您使用的是 express-generator 然后尝试

```
express --view=ejs --css=sass 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-09T12:00:07.463

这是一个基于各种来源的解决方案，包括上面的线程/评论：

**节点：**

```
var connect = require('connect');
var sass = require('node-sass');

var srcPath = __dirname + '/sass';
var destPath = __dirname + '/public/styles';

var server = connect.createServer(
    sass.middleware({
        src: srcPath,
        dest: destPath,
        debug: true,
        outputStyle: 'expanded',
        prefix: '/styles'
    }),
    connect.static(__dirname + '/public')
); 
```

**html:**

```
<!DOCTYPE html>
    <html>
    <head>
         <link rel="stylesheet" type="text/css" href="styles/main.css">
etc 
```

**文件系统：**

rootDirectory / server.js（这是节点应用程序）

rootDirectory/public/styles/（这里是编译好的scss文件会出现的地方）

根目录/sass/main.scss

这对我有用，我已经在以下位置分叉了这个例子：

[节点 sass 示例](https://github.com/andrew/node-sass-example)

这里：

[使用前缀的节点 sass 示例](https://github.com/swervo/node-sass-example)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-02-24T17:14:54.157

看起来 Express 的实现发生了一些变化。我不得不这样做：

```
npm install node-sass-middleware --save 
```

然后

```
var sass = require('node-sass-middleware');

 app.use(
     sass({
         src: __dirname + '/sass',    // Input SASS files
         dest: __dirname + '/public', // Output CSS
         debug: true                
     })
 ); 
```

# linux - /etc/passwd 的语法有什么意义

> ID：14242538
> 
> 赞同：0
> 
> 时间：2013-01-09T17:06:32.880
> 
> 标签：linux, unix, architecture, operating-system, fedora

我一直在扫描我的笔记本电脑（F17）上的一些操作系统文件，在阅读 /etc/passwd 文件时，我注意到每一行对于不同的对象/命令都有相同的语法，看起来像这样：

```
[key1]:x:[number]:[number]:[key2]:[directory]:[filepath] 
```

这是完整的文件：（不了解操作系统，该文件中单个给定行的每个元素的用途是什么？）

```
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
usbmuxd:x:113:113:usbmuxd user:/:/sbin/nologin
avahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologin
smolt:x:999:998:Smolt:/usr/share/smolt:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
abrt:x:173:173::/etc/abrt:/sbin/nologin
avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin
rtkit:x:172:172:RealtimeKit:/proc:/sbin/nologin
openvpn:x:998:996:OpenVPN:/etc/openvpn:/sbin/nologin
saslauth:x:997:995:"Saslauthd user":/run/saslauthd:/sbin/nologin
colord:x:996:994:User for colord:/var/lib/colord:/sbin/nologin
nm-openconnect:x:995:993:NetworkManager user for OpenConnect:/:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
chrony:x:994:992::/var/lib/chrony:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
pulse:x:993:991:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin
gdm:x:42:42::/var/lib/gdm:/sbin/nologin
kendal:x:1000:1000:Kendal Harland:/home/kendal:/bin/bash
tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
jetty:x:110:110::/usr/share/jetty:/sbin/nologin 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:13:09.393

真的，检查`man 5 passwd`，但基本上这是存储在那里的信息。

`username:passwd:UID:GID:realname:homedir:shell`

```
username - what username to login with
passwd - x indicates that /etc/shadow is used
UID - User ID
GID - Group ID
realname - Real name of user
homedir - Home directory i.e. /home/username
shell - what login shell the user uses 
```

# php - !解析错误：语法错误，意外的“公共”（T_PUBLIC）

> ID：14242543
> 
> 赞同：0
> 
> 时间：2013-01-09T17:06:41.907
> 
> 标签：php, wordpress

我正在本地转移一个 wordpress 网站，以便我可以安全地开发，我对这一切都很陌生，并且遇到了这个错误，所以如果你能用简单的术语解释如何修复，那将非常有帮助：

```
!Parse error: syntax error, unexpected 'public' (T_PUBLIC) in 
C:\wamp\www\KentVenuesTest\wp-content\mu-plugins\wpengine-common\plugin.php
on line 408

Call Stack

#  Time    Memory   Function
1.0.0007 - 247624 - {Main}()<p>
2.0.0014 - 251160 - require ('C:\wamp\www\KentVenuesTest\wp-blog-header.php')<p>
3.0.0022 - 268032 - require_once('C\wamp\www\KentVenuesTest\wp-load.php')<p>
4 0.0029 - 279728 - require_once('C\wamp\www\KentVenuesTest\wp-config.php')<p>
5 0.0041 - 370928 - require_once('C\wamp\www\KentVenuesTest\wp-settings.php')<p>
6 0.2186 - 13379696 - 4 -0.0029 - 279728 - include_once('C\wamp\www\KentVenuesTest\mu-plugins\mu-plugin.php<p>

Location

1 ..\index.php:0<p>
2 ..\index.php:17<p>
3 ..\wp-blog-header.php:12<p>
4 ..\wp-load.php:29<p>
5 ..\wp-config.php:90<p>
6 ..\wp-settings.php:159<p> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T17:11:34.993

问题可能出在 php 配置差异上。例如，我曾经遇到过类似的问题，你的情况让我想起了这一点。这是由与`<?php`允许使用的短语法相关的 php 配置引起的`<?`。在测试环境`<?`中对生产不起作用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:09:17.000

第 408 行有一个错误，缺少分号或导致下一行阻塞的东西，或者您可能使用的是不支持类的超旧版本的 php，尽管我希望它会更早地出现。可能是您试图在 PHP 4 上运行 PHP 5 脚本吗？

`public`关键字只能在 php 中的类上下文中使用，也许这会给你一个线索。可能是你在其他地方错误地使用了它。

确保所有牙套都已闭合`{}`

'localhost' 应该适用于数据库，但其他包含路径应​​该是正确的。

您可能正在使用`<?`而不是`<?php`. 尝试切换到`<?php`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:14:52.373

PHP 抱怨代码中有语法错误。

由于看起来您只是在使用第三方代码，我猜想代码中实际上没有语法错误，但更有可能是您尝试在与其不兼容的 PHP 版本上运行它。

与您的本地计算机（即它不工作的地方）相比，您的远程服务器上的 PHP 版本（即它在哪里工作（？））？

我猜你可能有一个旧版本的 PHP 无法正常工作。尝试升级它；最好的办法是确保开发站点和实时站点都运行相同的 PHP 版本，但只要它们都足够最新，它们完全一样并不重要运行代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:10:32.410

`408`文件中的行上或行前存在语法错误`C:\wamp\www\KentVenuesTest\wp-content\mu-plugins\wpengine-common\plugin.php`

当解析器在线到达令牌“public”时，`408`它确信某处一定有错误，因为它不希望看到令牌“public”。

# c# - 文件夹之间的差异

> ID：14242548
> 
> 赞同：0
> 
> 时间：2013-01-09T17:06:49.273
> 
> 标签：c#, git, github-for-windows

我需要在我的 .NET 应用程序中添加一个功能，允许用户了解他们对配置文件所做的更改。每个配置都存档在文件夹中。例如。

*   配置V001
*   配置V002
*   ...
*   配置V100

我想我可以使用**git diff**如下：

```
git diff ConfigV001 ConfigV001 
```

获得差异，但我怎样才能格式化输出以获得这样的东西？[（从gi​​thub-for-windows](http://windows.github.com)截取的截图）

![在此处输入图像描述](../Images/0219a8f1fe114dc12abf2ff07e14f220.png)

我将拥有 2 个版本（添加、更新、删除的文件）之间的更改列表以及每个文件的更改

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:26:20.067

看看[Diff.NET](http://www.menees.com/index.html)；包括实用程序的源代码和显示与您正在寻找的类似行为的屏幕截图。

# api - bind() 错误：无法分配请求的地址

> ID：14242549
> 
> 赞同：1
> 
> 时间：2013-01-09T17:06:50.707
> 
> 标签：api, bind

bind () 错误：无法分配请求的地址。

new_socket=socket(AF_INET, SOCK_DGRAM, 0);

```
localIP = "128.1.1.64";

memset(&socket_data, 0, sizeof(socket_data));

// Fill the socket structure
socket_data.sin_family      = AF_INET;
socket_data.sin_addr.s_addr = inet_addr(localIP);
socket_data.sin_port        = htons(PortNumber); 
```

bind(new_socket, (struct sockaddr*) &socket_data, sizeof(socket_data))

有谁知道为什么 bind() 失败了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:11:12.930

你有一个已经绑定到该地址/端口组合的套接字是我的猜测

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T09:02:39.797

我猜 128.1.1.64 是一个任意 IP，在您的任何网络接口中都不存在。如果要欺骗源IP，可能需要使用RAW_SOCKET。

# ruby - Ruby on Rails 3.2.11 Savon v2.0.2 破坏了我的应用程序

> ID：14242558
> 
> 赞同：0
> 
> 时间：2013-01-09T17:07:12.803
> 
> 标签：ruby, xml, ruby-on-rails-3, xmlhttprequest, savon

我从 1.1.0 升级到 Savon v2.0.2，它破坏了我的应用程序。我对代码进行了必要的调整，以说明错误回调（Savon::SOAP::Fault 到 Savon::SOAPFault、Savon::HTTP::Error 到 Savon::HTTPError 等）的变化，并使用 #调用与#request 方法。我无法跟踪错误，因为现在我的**堆栈级别太深了**错误。我已经将我的 ulimit -s 增加到了 40000 并且没有任何帮助。我不相信它是我的代码中的循环，因为在 v2 之前，代码可以完美地工作。在 Savon 网站上的任何地方或作为 Google 搜索的结果提供的示例都与我必须（并且已经）对提供 API 的设备进行的 XML 调用相近。这是我的客户端配置、XML 结构、生成器和必须进行的 XML 请求的内容。我还将在升级之前包含我的工作版本中的代码。任何方向将不胜感激。为了安全起见，我隐藏了 IP、域等。请让我知道您需要更多信息。

再次感谢你！

时间

**两个版本的共同点：**

```
@api = api.capitalize
service_api_host = '10.10.10.1'
url = "https://#{service_api_host}:8443/#{api}/#{api}?wsdl"
@uname = 'username'
@pwd   = 'password'
@xml1   = "xmlns:soapenv"
@xml2   = "xmlns:ws"
@xmlns1 = "http://schemas.xmlsoap.org/soap/envelope/"
@xmlns2 = "http://ws.#{@api.downcase}.myappliances_domain.com" 
```

**典型的 XML 请求：**

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.reportingservices.myappliances_domain.com">
  <soapenv:Header xmlns:svsec="http://services.myappliances_domain.com">
    <svsec:username>username</svsec:username>
    <svsec:password>password</svsec:password>
  </soapenv:Header>
  <soapenv:Body>
    <ws:RunTimeSeriesReportRequest>
      <ReportDefinition>MyReportDefinition</ReportDefinition>
      <CsvAttachmentFormat>
        <Compression>None</Compression>
        <Encoding>UTF-8</Encoding>
        <Headers>true</Headers>
      </CsvAttachmentFormat>
      <TimeSeriesReportQuery>
        <QueryFields>
          <QueryField>PeriodStart</QueryField>
          <QueryField>PeriodEnd</QueryField>
          <QueryField>Subscriber.Name</QueryField>
          <QueryField>TotalReceivedBytes</QueryField>
          <QueryField>TotalTransmittedBytes</QueryField>
          <QueryField>TotalBytes</QueryField>
        </QueryFields>
        <QueryFilters>
          <QueryFilter>
            <QueryField>Subscriber.Name</QueryField>
            <Criteria>Equal</Criteria>
            <Value>078DF7</Value>
          </QueryFilter>
        </QueryFilters>
        <MaxRows>0</MaxRows>
        <QueryLocalDataHomeOnly>false</QueryLocalDataHomeOnly>
        <TimeSeries>
          <Start>2012-12-19T06:00:00-07:00</Start>
          <End>2012-12-20T00:00:00-07:00</End>
          <TimeZone>America/Phoenix</TimeZone>
          <Interval>
            <Unit>Hours</Unit>
            <Value>18</Value>
          </Interval>
        </TimeSeries>
      </TimeSeriesReportQuery>
    </ws:RunTimeSeriesReportRequest>
  </soapenv:Body>
</soapenv:Envelope> 
```

**为了完整性：（创建独特请求的众多构建器之一）**

```
xml = Builder::XmlMarkup.new( :indent=>2 )
xml.soapenv:Envelope, :"#{@xml1}"=>"#{@xmlns1}", :"#{@xml2}"=>"#{@xmlns2}" do
  xml.tag!( 'soapenv:Header', :'xmlns:svsec' => 'http://services.myappliances_domain.com' ) do
    xml.tag!( 'svsec:username', @uname )
    xml.tag!( 'svsec:password', @pwd )
  end
  xml.tag!( 'soapenv:Body' ) do
    xml.tag!( "ws:#{request}" ) do
      xml.ReportDefinition('MyReportDefinition')
      xml.CsvAttachmentFormat do
        xml.Compression('None')
        xml.Encoding('UTF-8')
        xml.Headers('true')
      end
      xml.TimeSeriesReportQuery do
        xml.QueryFields do
          xml.QueryField('PeriodStart')
          xml.QueryField('PeriodEnd')
          xml.QueryField('Subscriber.Name')
          xml.QueryField('TotalReceivedBytes')
          xml.QueryField('TotalTransmittedBytes')
          xml.QueryField('TotalBytes')
        end
        xml.QueryFilters do
          xml.QueryFilter do
            xml.QueryField('Subscriber.Name')
            xml.Criteria('Equal')
            xml.Value(sub)
          end
        end
        xml.MaxRows(0)
        xml.QueryLocalDataHomeOnly('false')
        xml.TimeSeries do
          xml.Start("#{start_date}")
          xml.End("#{end_date}")
          xml.TimeZone('America/Phoenix')
          xml.Interval do
            xml.Unit('Hours')
            xml.Value('18')
          end
        end
      end
    end
  end
end 
```

**升级前：**

客户端定义

```
 @client = Savon::Client.new do |wsdl, http|
    wsdl.document = url
    http.auth.ssl.verify_mode = :none
    http.read_timeout = 120
  end 
```

请求通话

```
 @response = @client.request "#{params[:reqMethod]}" do
    soap.xml = "#{params[:xml]}"      
  end 
```

**升级后：**

客户端定义

```
@client = Savon.client(wsdl: url,
                       encoding: "UTF-8",
                       soap_version: 2,
                       ssl_verify_mode: :none,
                       open_timeout: 5,
                       read_timeout: 120) 
```

请求通话

```
response = @client.call(:"#{params[:reqMethod]}", xml: params[:xml]) 
```

# **更新**

这是返回 Builder 结果的典型方法。它是一个字符串，而不是一个对象。

从 rails 控制台：

```
ruby-1.9.3-p0 :020 >     @uname = 'username'
 => "username" 
ruby-1.9.3-p0 :021 >     @pwd   = 'password'
 => "password" 
ruby-1.9.3-p0 :022 > api = 'SubscriberServices'
 => "SubscriberServices" 
ruby-1.9.3-p0 :023 >     @api = api.capitalize
 => "Subscriberservices" 
ruby-1.9.3-p0 :024 >     @xml1   = "xmlns:soapenv"
 => "xmlns:soapenv" 
ruby-1.9.3-p0 :025 >     @xml2   = "xmlns:ws"
 => "xmlns:ws" 
ruby-1.9.3-p0 :026 >     @xmlns1 = "http://schemas.xmlsoap.org/soap/envelope/"
 => "http://schemas.xmlsoap.org/soap/envelope/" 
ruby-1.9.3-p0 :027 >     @xmlns2 = "http://ws.#{@api.downcase}.myappliance_domain.com"
 => "http://ws.subscriberservices.myappliance_domain.com" 
ruby-1.9.3-p0 :028 >   def getSubAttributes(subscriber)
ruby-1.9.3-p0 :029?>       request = 'LookupSubscriberRequest'
ruby-1.9.3-p0 :030?>       
ruby-1.9.3-p0 :031 >         xml = Builder::XmlMarkup.new( :indent=>2 )
ruby-1.9.3-p0 :032?>       xml.soapenv:Envelope, :"#{@xml1}"=>"#{@xmlns1}", :"#{@xml2}"=>"#{@xmlns2}" do
ruby-1.9.3-p0 :033 >             xml.tag!( 'soapenv:Header', :'xmlns:svsec' => 'http://services.myappliance_domain.com' ) do
ruby-1.9.3-p0 :034 >                 xml.tag!( 'svsec:username', @uname )
ruby-1.9.3-p0 :035?>               xml.tag!( 'svsec:password', @pwd )
ruby-1.9.3-p0 :036?>             end
ruby-1.9.3-p0 :037?>           xml.tag!( 'soapenv:Body' ) do     
ruby-1.9.3-p0 :038 >                 xml.tag!( "ws:#{request}" ) do
ruby-1.9.3-p0 :039 >                     xml.SubscriberKey() do
ruby-1.9.3-p0 :040 >                         xml.SubscriberRealmKey() do
ruby-1.9.3-p0 :041 >                             xml.Name('DEFAULT')
ruby-1.9.3-p0 :042?>                         end
ruby-1.9.3-p0 :043?>                       xml.Name(subscriber)
ruby-1.9.3-p0 :044?>                     end
ruby-1.9.3-p0 :045?>                   xml.ResponseGroups() do
ruby-1.9.3-p0 :046 >                         xml.ResponseGroup('Subscriber.Attributes')
ruby-1.9.3-p0 :047?>                       xml.ResponseGroup('Subscriber.CurrentIpAssignments')
ruby-1.9.3-p0 :048?>                     end
ruby-1.9.3-p0 :049?>                 end
ruby-1.9.3-p0 :050?>             end
ruby-1.9.3-p0 :051?>         end
ruby-1.9.3-p0 :052?>   end
 => nil 
ruby-1.9.3-p0 :053 > x = getSubAttributes('3C754A70BDE3')
 => "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ws=\"http://ws.subscriberservices.myappliance_domain.com\">\n  <soapenv:Header xmlns:svsec=\"http://services.myappliance_domain.com\">\n    <svsec:username>username</svsec:username>\n    <svsec:password>password</svsec:password>\n  </soapenv:Header>\n  <soapenv:Body>\n    <ws:LookupSubscriberRequest>\n      <SubscriberKey>\n        <SubscriberRealmKey>\n          <Name>DEFAULT</Name>\n        </SubscriberRealmKey>\n        <Name>3C754A70BDE3</Name>\n      </SubscriberKey>\n      <ResponseGroups>\n        <ResponseGroup>Subscriber.Attributes</ResponseGroup>\n        <ResponseGroup>Subscriber.CurrentIpAssignments</ResponseGroup>\n      </ResponseGroups>\n    </ws:LookupSubscriberRequest>\n  </soapenv:Body>\n</soapenv:Envelope>\n" 
ruby-1.9.3-p0 :054 > x.class
 => String 
ruby-1.9.3-p0 :055 > x.target!
NoMethodError: undefined method `target!' for #<String:0x0000000497a348>
    from (irb):55
    from /usr/local/rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.9/lib/rails/commands/console.rb:47:in `start'
    from /usr/local/rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.9/lib/rails/commands/console.rb:8:in `start'
    from /usr/local/rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.9/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'
ruby-1.9.3-p0 :056 > 
```

# **更新 2**

如果我没有明确返回 xml Builder 对象，我会得到一个字符串。

```
api = 'SubscriberServices'
@api = api.capitalize
@uname = 'username'
@pwd   = 'password'

@xml1   = "xmlns:soapenv"
@xml2   = "xmlns:ws"
@xmlns1 = "http://schemas.xmlsoap.org/soap/envelope/"
@xmlns2 = "http://ws.#{@api.downcase}.myappliance_domain.com"

def getSubAttributes(subscriber)
  request = 'LookupSubscriberRequest'

  xml = Builder::XmlMarkup.new( :indent=>2 )
  xml.soapenv:Envelope, :"#{@xml1}"=>"#{@xmlns1}", :"#{@xml2}"=>"#{@xmlns2}" do
    xml.tag!( 'soapenv:Header', :'xmlns:svsec' => 'http://services.myappliance_domain.com' ) do
      xml.tag!( 'svsec:username', @uname )
      xml.tag!( 'svsec:password', @pwd )
    end
    xml.tag!( 'soapenv:Body' ) do     
      xml.tag!( "ws:#{request}" ) do
        xml.SubscriberKey() do
          xml.SubscriberRealmKey() do
            xml.Name('DEFAULT')
          end
          xml.Name(subscriber)
        end
        xml.ResponseGroups() do
          xml.ResponseGroup('Subscriber.Attributes')
          xml.ResponseGroup('Subscriber.CurrentIpAssignments')
        end
      end
    end
  end
  return xml
end 
```

测试...

```
ruby-1.9.3-p0 :294 >   api = 'SubscriberServices'
 => "SubscriberServices" 
ruby-1.9.3-p0 :295 > @api = api.capitalize
 => "Subscriberservices" 
ruby-1.9.3-p0 :296 > @uname = 'username'
 => "username" 
ruby-1.9.3-p0 :297 > @pwd   = 'password'
 => "password" 
ruby-1.9.3-p0 :298 > 
ruby-1.9.3-p0 :299 >   @xml1   = "xmlns:soapenv"
 => "xmlns:soapenv" 
ruby-1.9.3-p0 :300 > @xml2   = "xmlns:ws"
 => "xmlns:ws" 
ruby-1.9.3-p0 :301 > @xmlns1 = "http://schemas.xmlsoap.org/soap/envelope/"
 => "http://schemas.xmlsoap.org/soap/envelope/" 
ruby-1.9.3-p0 :302 > @xmlns2 = "http://ws.#{@api.downcase}.myappliance_domain.com"
 => "http://ws.subscriberservices.myappliance_domain.com" 
ruby-1.9.3-p0 :303 > 
ruby-1.9.3-p0 :304 >   def getSubAttributes(subscriber)
ruby-1.9.3-p0 :305?>     request = 'LookupSubscriberRequest'
ruby-1.9.3-p0 :306?>     
ruby-1.9.3-p0 :307 >       xml = Builder::XmlMarkup.new( :indent=>2 )
ruby-1.9.3-p0 :308?>     xml.soapenv:Envelope, :"#{@xml1}"=>"#{@xmlns1}", :"#{@xml2}"=>"#{@xmlns2}" do
ruby-1.9.3-p0 :309 >           xml.tag!( 'soapenv:Header', :'xmlns:svsec' => 'http://services.myappliance_domain.com' ) do
ruby-1.9.3-p0 :310 >               xml.tag!( 'svsec:username', @uname )
ruby-1.9.3-p0 :311?>             xml.tag!( 'svsec:password', @pwd )
ruby-1.9.3-p0 :312?>           end
ruby-1.9.3-p0 :313?>         xml.tag!( 'soapenv:Body' ) do     
ruby-1.9.3-p0 :314 >               xml.tag!( "ws:#{request}" ) do
ruby-1.9.3-p0 :315 >                   xml.SubscriberKey() do
ruby-1.9.3-p0 :316 >                       xml.SubscriberRealmKey() do
ruby-1.9.3-p0 :317 >                           xml.Name('DEFAULT')
ruby-1.9.3-p0 :318?>                       end
ruby-1.9.3-p0 :319?>                     xml.Name(subscriber)
ruby-1.9.3-p0 :320?>                   end
ruby-1.9.3-p0 :321?>                 xml.ResponseGroups() do
ruby-1.9.3-p0 :322 >                       xml.ResponseGroup('Subscriber.Attributes')
ruby-1.9.3-p0 :323?>                     xml.ResponseGroup('Subscriber.CurrentIpAssignments')
ruby-1.9.3-p0 :324?>                   end
ruby-1.9.3-p0 :325?>               end
ruby-1.9.3-p0 :326?>           end
ruby-1.9.3-p0 :327?>       end
ruby-1.9.3-p0 :328?>   
Display all 540 possibilities? (y or n)
ruby-1.9.3-p0 :328?>    xml
ruby-1.9.3-p0 :329?>   end
 => nil 
ruby-1.9.3-p0 :330 > x = getSubAttributes('3C754A70BDE3')
 => <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.subscriberservices.myappliance_domain.com">
  <soapenv:Header xmlns:svsec="http://services.myappliance_domain.com">
    <svsec:username>username</svsec:username>
    <svsec:password>password</svsec:password>
  </soapenv:Header>
  <soapenv:Body>
    <ws:LookupSubscriberRequest>
      <SubscriberKey>
        <SubscriberRealmKey>
          <Name>DEFAULT</Name>
        </SubscriberRealmKey>
        <Name>3C754A70BDE3</Name>
      </SubscriberKey>
      <ResponseGroups>
        <ResponseGroup>Subscriber.Attributes</ResponseGroup>
        <ResponseGroup>Subscriber.CurrentIpAssignments</ResponseGroup>
      </ResponseGroups>
    </ws:LookupSubscriberRequest>
  </soapenv:Body>
</soapenv:Envelope>
<inspect/>

ruby-1.9.3-p0 :331 > x.class
 => "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ws=\"http://ws.subscriberservices.myappliance_domain.com\">\n  <soapenv:Header xmlns:svsec=\"http://services.myappliance_domain.com\">\n    <svsec:username>username</svsec:username>\n    <svsec:password>password</svsec:password>\n  </soapenv:Header>\n  <soapenv:Body>\n    <ws:LookupSubscriberRequest>\n      <SubscriberKey>\n        <SubscriberRealmKey>\n          <Name>DEFAULT</Name>\n        </SubscriberRealmKey>\n        <Name>3C754A70BDE3</Name>\n      </SubscriberKey>\n      <ResponseGroups>\n        <ResponseGroup>Subscriber.Attributes</ResponseGroup>\n        <ResponseGroup>Subscriber.CurrentIpAssignments</ResponseGroup>\n      </ResponseGroups>\n    </ws:LookupSubscriberRequest>\n  </soapenv:Body>\n</soapenv:Envelope>\n<inspect/>\n<class/>\n" 
ruby-1.9.3-p0 :332 > s = x.to_xml
 => "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ws=\"http://ws.subscriberservices.myappliance_domain.com\">\n  <soapenv:Header xmlns:svsec=\"http://services.myappliance_domain.com\">\n    <svsec:username>username</svsec:username>\n    <svsec:password>password</svsec:password>\n  </soapenv:Header>\n  <soapenv:Body>\n    <ws:LookupSubscriberRequest>\n      <SubscriberKey>\n        <SubscriberRealmKey>\n          <Name>DEFAULT</Name>\n        </SubscriberRealmKey>\n        <Name>3C754A70BDE3</Name>\n      </SubscriberKey>\n      <ResponseGroups>\n        <ResponseGroup>Subscriber.Attributes</ResponseGroup>\n        <ResponseGroup>Subscriber.CurrentIpAssignments</ResponseGroup>\n      </ResponseGroups>\n    </ws:LookupSubscriberRequest>\n  </soapenv:Body>\n</soapenv:Envelope>\n<inspect/>\n<class/>\n<to_xml/>\n" 
ruby-1.9.3-p0 :333 > s.class
 => String 
ruby-1.9.3-p0 :334 > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T02:11:59.573

我不太清楚`xml`对象（来自`Builder::XmlMarkup.new`）和之间的关系`params[:xml]`，但我遇到了堆栈级别太深的问题，并通过使用`message: xml.target!`.

# ruby - gem 的开发依赖项是否应该重述所需的运行时依赖项？

> ID：14242562
> 
> 赞同：2
> 
> 时间：2013-01-09T17:07:37.907
> 
> 标签：ruby, rubygems, dependency-management

我找不到任何关于此的文档。我的直觉是，[`add_development_dependency`](http://ruby-doc.org/stdlib-1.9.2/libdoc/rubygems/rdoc/Gem/Specification.html#method-i-add_development_dependency)gemspec 文件应该只列出开发和测试所需的其他依赖项，并且可以依赖于指定的依赖项`add_runtime_dependency`来安装。

我惊讶地发现该[`gem test`](http://github.com/rubygems/rubygems-test/blob/master/README.txt)命令仅安装开发依赖项，如果在测试期间需要任何运行时依赖项，则会失败。

它只是`gem test`怪癖还是应该开发依赖项总是重述所需的运行时依赖项，如下所示：

```
Gem::Specification.new do |s|
  # ...
  s.add_runtime_dependency 'rack'
  s.add_runtime_dependency 'net-http-persistent'
  s.add_development_dependency 'rack-test'
  s.add_development_dependency 'webmock'
  s.add_development_dependency 'rack'
  s.add_development_dependency 'net-http-persistent'
end 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:21:05.050

我认为`gem test`假设您在实际尝试测试之前已经安装了要测试的 gem。

```
gem install whatever
gem test whatever 
```

所有的[测试](https://github.com/rubygems/rubygems-test/blob/master/test/test_execute.rb)都表明是这种情况——他们`install_stub_gem`首先调用，它会安装一个假的 gem 来运行`gem test`命令。

我从未见过 gem 将其所有运行时依赖项复制为开发依赖项，并且[文档](http://docs.rubygems.org/read/chapter/20#development_dependencies)的语言表明这样做没有意义：

> ### 开发依赖
> 
> **仅**用于开发目的的宝石。*（强调我的）*

因此，也是运行时依赖项的 Gem 不属于此类别。

# windows - Mercurial 混乱斯堪的纳维亚字符 OSX

> ID：14242563
> 
> 赞同：0
> 
> 时间：2013-01-09T17:07:40.103
> 
> 标签：windows, macos, character-encoding, mercurial

我和我的朋友在 Bitbucket 上为我们的项目建立了 Mercurial 存储库。当我使用 OSX 时，他在 Windows 上工作。我将 Mercurial 安装到 OSX 并克隆了存储库，只是发现文件中的所有斯堪的纳维亚字符 (äö) 都被错误地解释了。此外，包含这些字符的文件夹没有被正确克隆。

现在，我想它与字符编码有关，这使它在 Windows 上以某种方式工作，但在 OSX 上却不行。我使用 Sourcetree 作为 Mercurial 的 GUI，并试图找到任何没有结果的字符编码设置。我应该怎么做才能解决这个问题？我以前在 Windows 上使用过 GUI Mercurial，从来没有遇到过这样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:22:15.663

你有通常的“不同编码”问题。

OSX 使用 UTF8 (FIXME)，Windows 用于西欧 8 位字符（很可能）- ISO-8859-1

在 OSX 中的任何 CLI 操作之前，您必须 chcp 到相同的复制页，因为它在 Win 端

# php - 如何替换 die() 语句？

> ID：14242564
> 
> 赞同：0
> 
> 时间：2013-01-09T17:07:39.603
> 
> 标签：php, die

```
if(!empty($_POST))
{
if(empty($_POST['username'])) {die("Please enter a username.");}
.... 
```

结果是空白页 - 带有上述警报。
我想将表单保留在页面上。就像是：

```
if(empty($_POST['username']))?> <div id="info"><?php{echo "Please enter a username"};?></div> 
```

因此，只需编写一个信息，然后从此时停止代码执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:08:37.957

要**停止执行**，但您可以使用：

```
die( ' <div id="info">Please enter a username</div> '); 
```

要允许加载页面的其余部分，您可以使用：

```
$errors = array();
if(empty($_POST['username'])) { 
    $errors[] = 'Please enter your username'; 
} 
```

然后稍后在您的html中添加

```
foreach($errors as $error){
    echo "<div class='error'>$error</div>;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:10:55.840

设置一些标志并返回/重定向到同一页面。在同一页面（带有表单的脚本）上，检查标志集并显示消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:16:53.830

与其在单个验证错误上“停止执行”，不如获取所有错误并将它们显示给用户：

```
<?php
if (!empty($_POST))
{
    // validate form
    $errors = array();

    if (empty($_POST['username']))
    {
        $errors['username'] = 'Please enter a username.';
    }

    if (empty($_POST['address']))
    {
        $errors['address'] = 'Please enter an address.';
    }

    if (empty($errors))
    {
        // save to database then redirect
    }
}

?>
<form>
    Username:<br />
    <input type="text" name="username" value="" /><br />
<?php if (!empty($errors['username'])): ?>
    <div class="error">
        <?php echo $errors['username'] ?>
    </div>
<?php endif ?>

    Address:<br />
    <input type="text" name="address" value="" /><br />
<?php if (!empty($errors['address'])): ?>
    <div class="error">
        <?php echo $errors['address'] ?>
    </div>
<?php endif ?>
</form> 
```

# email - 如何在magento中为时事通讯订阅创建管理员通知邮件

> ID：14242568
> 
> 赞同：1
> 
> 时间：2013-01-09T17:07:48.587
> 
> 标签：email, notifications, admin, subscription, newsletter

我正在尝试为 magento 1.7 创建一个模块，该模块将在新用户订阅时事通讯时向管理员发送通知邮件。到目前为止，我已成功发送邮件。但是，我的代码没有将 getEmail 和 getId 值显示在发送给管理员的邮件中。如果有人能说明我哪里出错了，那就太好了。这是代码：

**app/code/local/Notify/Biju/etc/config.xml**

```
 <?xml version="1.0" encoding="utf-8"?>
<config>
    <modules>
        <Notify_Biju>
            <version>0.1.0</version>
        </Notify_Biju>
    </modules>
    <global>
        <models>
            <Notify_Biju>
                <class>Notify_Biju_Model</class>
            </Notify_Biju>
        </models>
        <template>
            <email>
                <newsletter_alert_template translate="label" module="n">
                    <label>Newsletter Alert to Admin</label>
                    <file>newsletter_subscription_notify.html</file>
                    <type>html</type>
                </newsletter_alert_template>
            </email>
        </template>
    </global>
    <frontend>
        <events>
            <newsletter_subscriber_save_after>
                <observers>
                    <Notify_Biju_Model_Observer>
                        <type>singleton</type>
                        <class>Notify_Biju_Model_Observer</class>
                        <method>newsletteralert</method>
                    </Notify_Biju_Model_Observer>
                </observers>
            </newsletter_subscriber_save_after>
        </events>
    </frontend>
</config> 
```

**app/code/local/Notify/Biju/Model/Observer.php**

```
<?php

class Notify_Biju_Model_Observer {

    const XML_PATH_EMAIL_TEMPLATE = 'newsletter_alert_template';

    public function newsletteralert($observer){

            $eventname=$observer->getEvent()->getName();
            $subscriber=$observer->getEvent()->getSubscriber();
            $email=$subscriber->getEmail();
            $id=$subscriber->getId();

            $emailtemplate=Mage::getModel('core/email_template')->loadDefault(self::XML_PATH_EMAIL_TEMPLATE);
            $sender=array();
            $sender['name']="admin";
            $sender['email']="biju@talkingpebbles.com";
            try{
            $emailtemplate->sendTransactional(
                    self::XML_PATH_EMAIL_TEMPLATE,
                    $sender,
                    'biju@talkingpebbles.com, allen@compkraft.com', // email id of website/store admin
                    'admin',
                    array('subscirber'=>$subscriber)
                    );

            }
            catch(Mage_Core_Exception $e){
                // echo $e->getMessage();
                Mage::log($e->getMessage(),null,'newsletter.log');

            }

        }

} 
```

**应用程序/etc/modules/Notify_Biju.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <Notify_Biju>
            <active>true</active>
            <codePool>local</codePool>
        </Notify_Biju>
    </modules>
</config> 
```

**app/locale/en_US/template/email/newsletter_subscription_notify.html**

```
 <!--@subject  Newsletter Subscription Alert @-->

<body style="background:#F6F6F6; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; margin:0; padding:0;">
<div style="background:#F6F6F6; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; margin:0; padding:0;">

<table cellspacing="0" cellpadding="0" border="0" width="100%">

<tr>
    <td valign="top" style="padding:20px 0 20px 0">
    <!-- (header starts here) -->
    <table bgcolor="#FFFFFF" cellspacing="0" cellpadding="10" border="0" width="650" style="border:1px solid #E0E0E0;">
    <tr>
            <td valign="top">
                <h3 style="font-size:22px; font-weight:normal; line-height:22px; margin:0 0 11px 0;"></h3>
              </td>
              </tr>
    <tr>
      <td valign="top"><h3 style="font-size:22px; font-weight:normal; line-height:22px; margin:0 0 11px 0;">Dear Admin </h3>
        <p> Congratulations! A new subscriber has registered for Newsletter. Please login to the admin back-end to manage subscriptions.</p>
        <p>Subscriber Email: {{var subscriber.getEmail()}}</p>
        <p>Subscriber ID: {{var subscriber.getId()}}</p>
        <br>

    </tr>
              </table>
      </td>
              </tr>
              </table>
              </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-17T07:51:43.720

要在观察者中获取订阅者电子邮件值和 ID，

```
$subscriber=$observer->getEvent()->getSubscriber() ;
       $email=$subscriber->getSubscriberEmail();
       $id=$subscriber->getSubscriberId();

$emailtemplate->sendTransactional(
                    XML_PATH_EMAIL_TEMPLATE,
                     Mage::getStoreConfig(XML_PATH_CONFIRM_EMAIL_IDENTITY),
                    'sample@xyz.in', // email id of website/store admin
                    'admin',
                    array(
                    'subscriber_email'  => $email,
                    'subscriber_id' => $id
            ) 
```

然后在邮件中 - 添加这样的变量而不是你的行

```
<p>Subscriber Email: {{var subscriber_email}}</p>
        <p>Subscriber ID: {{var subscriber_id}}</p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T02:59:19.777

你有一个错字：

搜索`array('subscirber'=>$subscriber)`。

您将“订阅者”拼错为“订阅者”

# java - lovecraftian：hibernate HQL IS EMPTY 不起作用并呈现出荒谬的复杂 SQL

> ID：14242575
> 
> 赞同：4
> 
> 时间：2013-01-09T17:08:19.153
> 
> 标签：java, hibernate

你好，

这就是故事：我有一个一对多。一个是“RadicadoOficio”，许多是“RespuestaOficio”

我只想选择所有没有响应的 rads。

这些是实体（为教育目的而缩写）：

```
@Entity
@Table(name="COR_RADICADO_OFICIO")
public class RadicadoOficio {   
    @OneToMany(mappedBy="radicado")
    private List<RespuestaOficio> respuestas;

    @Column(name="requiere_respuesta")
    private Long requiereRespuesta;
}

@Entity
@Table(name="cor_respuesta_oficio")
public class RespuestaOficio {
    @ManyToOne
    @JoinColumns({@JoinColumn(name = "num_radicado"), @JoinColumn(name="ano_radicado")})
    private RadicadoOficio radicado;
} 
```

这个 DAO 方法：

```
HibernateUtil.getCurrentSession().createQuery("select obj from " + sample.getCanonicalName() + " obj where  obj." + longProp+ " = ? and obj." + childrenProp + " IS EMPTY" )
            .setLong(0, longVal );

    if (firstResult != null) {
        q.setFirstResult(firstResult);
        q.setMaxResults(maxResults);
    }

    return q.list(); 
```

呈现这些东西：

radicadoof0_.respuesta_multiple 作为 respuesta17_8_，radicadoof0_.tipo_aplicativo 作为来自 COR_RADICADO_OFICIO 的 radicadoof0_ 其中 radicadoof0_.requiere_respuesta=? 而不是（存在（从 cor_respuesta_oficio respuestas1_ 中选择 respuestas1_.INTERNO_RESPUESTA，其中 radicadoof0_.ANO_RADICADO=respuestas1_.num_radicado 和 radicadoof0_.NUM_RADICADO=respuestas1_.ano_radicado））row_ ） where rownum_ <= ？和 rownum_ > ？

甲骨文抛出了一个我不明白的“无效号码”错误。

欢迎任何帮助，tnx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:25:38.993

您的 hql 可以与您的参数一起更改为以下内容。这里的变化是使用你 hql 中的所有元素。

```
createQuery("select r FROM RadicadoOficio r where 0 = all elements(r.respuestas)"); 
```

因此，在您的查询中，它看起来像下面的内容

```
HibernateUtil.getCurrentSession().createQuery("select obj from " + sample.getCanonicalName() + " obj where  obj." + longProp+ " = ? and 0=all elements(obj." + childrenProp + ")" )
        .setLong(0, longVal ); 
```

# c++ - 使用 std::pair 类的头文件中的 typedef 错误

> ID：14242578
> 
> 赞同：1
> 
> 时间：2013-01-09T17:08:25.437
> 
> 标签：c++, std, header-files, std-pair

我正在以类似 STD 的方式编写 SkipList 实现：使用分配器、迭代器等。整个类已完成并且正在工作，但现在我正在尝试为我创建的类编写一个头文件。我当前的头文件内容是：

```
template<class _MySkiplist>
    class _Skiplist_const_iterator;

template<class _MySkiplist>
    class _Skiplist_iterator;

template<class _Kty,
    class _Pr,
    class _Alloc>
        class skiplist
        {
            typedef skiplist<_Kty, _Pr, _Alloc> _Myt;

            typedef typename _Skiplist_const_iterator<_Myt> const_iterator;
            typedef typename _Skiplist_iterator<_Myt> iterator;

            typedef typename _Alloc::size_type size_type;

            typedef std::pair<iterator, iterator> _Pairii;
            typedef std::pair<iterator, bool> _Pairib;

            skiplist();
            skiplist(const _Alloc& _Al);
            skiplist(const _Pr& _Pred);
            skiplist(const _Pr& _Pred, const _Alloc& _Al);
            ~skiplist();

            iterator begin();
            const_iterator begin() const;
            iterator end();
            const_iterator end() const;

            size_type size() const;
            size_type max_size() const;
            bool empty() const;

        //  _Pairib insert(_Kty& _val);
        //  _Pairib  insert(const _Kty& _val);
            size_type erase(const _Kty& x);
            void clear();

            _Pr key_comp() const;
            _Pr value_comp() const;

            iterator find(const _Kty& x);
            size_type count(const _Kty& x) const;
            iterator lower_bound(const _Kty& x) const;
            iterator upper_bound(const _Kty& x) const;
    //      _Pairii equal_range(const _Kty& x) const;

            _Alloc get_allocator() const;
        }; 
```

我不断收到以下错误：

> 错误 1 ​​错误 C2143：语法错误：缺少 ';' 在'<'之前
> 
> 错误 3 错误 C2238: ';' 前面的意外标记
> 
> 错误 5 错误 C2238: ';' 前面的意外标记
> 
> 错误 2 错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

所有这些错误都是指头文件中的以下两行：

```
 typedef std::pair<iterator, iterator> _Pairii;
        typedef std::pair<iterator, bool> _Pairib; 
```

我已经没有想法为什么会发生错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:14:59.463

导致这种情况的错误是您`typename`在非依赖类型名称上使用：

```
typedef typename _Skiplist_const_iterator<_Myt> const_iterator;
typedef typename _Skiplist_iterator<_Myt> iterator; 
```

删除`typename`并包含定义的标题`<memory>`就`std::pair`可以了。

另请注意，您的标识符是无效的（以下划线开头的标识符后跟另一个下划线或大写字母是保留的）并且您*可以*使用*可读*的标识符。;-) 标准库实现使用保留标识符以避免与客户端代码冲突。但你不应该那样做。

# html - CSS Media 查询是否会加载所有引用的 CSS？

> ID：14242582
> 
> 赞同：1
> 
> 时间：2013-01-09T17:08:44.660
> 
> 标签：html, css, mobile-safari, media-queries

如果我使用 CSS 媒体查询来应用 2 个不同的 CSS，例如 desktop.css 和 mobile.css，具体取决于我的最大宽度，这将如何实际工作？

浏览器是否会始终加载 CSS，然后在客户端应用实际的 CSS，或者浏览器是否智能足以仅加载相关的 CSS？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:20:54.550

只要您使用实际的媒体查询，所有 CSS 都会在页面*加载*时加载，因为这是所有支持媒体查询的浏览器的默认行为。在您到达这些断点或满足规则（如果您不使用断点媒体查询）之前，它不会应用 CSS。

如果您使用的是模仿媒体查询行为的 JavaScript，那么这完全是一个不同的球类游戏，并且取决于它是如何编写的，这取决于是否加载了 CSS。

代码示例将有助于确定一个有效的答案——但据我所知，你的第一句话是正确的；浏览器将始终加载您的所有 CSS，并且仅根据当时使用的视口/设备应用相关的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:14:58.790

这完全取决于您定义 CSS 的方式和位置。我[将此页面](http://cloudfour.com/examples/mediaqueries/image-test/)作为基于不同媒体查询加载图像方式的参考。

但是，基本上，如果您根据媒体查询有条件地加载 CSS，那么在满足该媒体查询之前它不应该加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:10:15.373

它加载所有 CSS 并通过正常的 CSS 层次结构应用它。

# mysql - 更新...选择自

> ID：14242587
> 
> 赞同：1
> 
> 时间：2013-01-09T17:09:03.733
> 
> 标签：mysql, select

我有一个`members_info`包含许多成员的表，但我需要做的是使用成员 A 的信息更新成员 B 的信息。

以下是成员用户 ID：

会员 A = 98089 ( `member_info_id`)
会员 B = 236505 ( `member_info_id`)

这两个成员没有共同点，所以我不能加入。如何更新会员 B 的资料？

**这是表格的结构，但我怀疑它是否有用**

```
mysql> describe member_info;
+-------------------------------+--------------+------+-----+-------------------+----------------+
| Field                         | Type         | Null | Key | Default           | Extra          |
+-------------------------------+--------------+------+-----+-------------------+----------------+
| member_info_id                | int(11)      | NO   | PRI | NULL              | auto_increment |
| member_id                     | int(11)      | NO   | UNI | 0                 |                |
| street                        | varchar(100) | NO   |     | NULL              |                |
| street2                       | varchar(50)  | NO   |     |                   |                |
| city                          | varchar(50)  | NO   |     |                   |                |
| state                         | varchar(50)  | NO   |     |                   |                |
| country_id                    | int(11)      | NO   |     | 0                 |                |
| postal                        | varchar(20)  | NO   |     |                   |                |
| phone                         | varchar(20)  | NO   |     |                   |                |
| street_ntv                    | varchar(100) | NO   |     |                   |                |
| street2_ntv                   | varchar(50)  | NO   |     |                   |                |
| city_ntv                      | varchar(50)  | NO   |     |                   |                |
| state_ntv                     | varchar(50)  | NO   |     |                   |                |
| card_ship_addr                | varchar(250) | NO   |     | NULL              |                |
| tax_id                        | varchar(20)  | NO   |     |                   |                |
| c_type                        | varchar(20)  | NO   |     |                   |                |
| c_number                      | varchar(20)  | NO   |     |                   |                |
| c_code                        | varchar(5)   | NO   |     |                   |                |
| c_date                        | varchar(10)  | NO   |     |                   |                |
| c_name                        | varchar(50)  | NO   |     |                   |                |
| street_b                      | varchar(100) | NO   |     | NULL              |                |
| street_b2                     | varchar(50)  | NO   |     |                   |                |
| city_b                        | varchar(50)  | NO   |     |                   |                |
| state_b                       | varchar(50)  | NO   |     |                   |                |
| country_b_id                  | int(11)      | NO   |     | 0                 |                |
| postal_b                      | varchar(20)  | NO   |     |                   |                |
| new_data                      | text         | NO   |     | NULL              |                |
| new_data_code                 | varchar(10)  | NO   |     |                   |                |
| new_data_date                 | int(11)      | NO   |     | 0                 |                |
| picture_id                    | int(1)       | NO   |     | 0                 |                |
| gender                        | tinyint(4)   | NO   |     | 0                 |                |
| date_birth                    | date         | YES  |     | NULL              |                |
| education                     | tinyint(4)   | NO   |     | 0                 |                |
| income_range                  | tinyint(4)   | NO   |     | 0                 |                |
| li_first_name                 | varchar(200) | NO   |     |                   |                |
| li_last_name                  | varchar(200) | NO   |     |                   |                |
| li_street                     | varchar(200) | NO   |     |                   |                |
| li_street2                    | varchar(200) | NO   |     |                   |                |
| li_city                       | varchar(200) | NO   |     |                   |                |
| li_state                      | varchar(200) | NO   |     |                   |                |
| li_country_id                 | varchar(200) | NO   |     |                   |                |
| li_postal                     | varchar(200) | NO   |     |                   |                |
| li_phone                      | varchar(200) | NO   |     |                   |                |
| li_governmentid               | varchar(200) | NO   |     |                   |                |
| li_gov_filename               | varchar(50)  | NO   |     |                   |                |
| li_gov_id_number              | varchar(30)  | NO   |     |                   |                |
| li_gov_driver_state           | varchar(10)  | NO   |     |                   |                |
| li_gov_country                | varchar(50)  | NO   |     |                   |                |
| li_gov_expdate                | varchar(50)  | NO   |     |                   |                |
| li_governmentdate             | int(11)      | NO   |     | 0                 |                |
| li_staff_id                   | int(11)      | NO   |     | 0                 |                |
| li_verify_date                | int(11)      | NO   |     | 0                 |                |
| private_key                   | varchar(100) | NO   |     |                   |                |
| private_key_enable            | int(11)      | NO   |     | 0                 |                |
| show_displayname              | tinyint(1)   | YES  |     | 0                 |                |
| legal_status                  | int(11)      | NO   | MUL | NULL              |                |
| legal_change_reason           | text         | NO   |     | NULL              |                |
| legal_update_time             | timestamp    | NO   | MUL | CURRENT_TIMESTAMP |                |
| legal_expire_date             | date         | NO   |     | 0000-00-00        |                |
| legal_wf_update_id            | int(11)      | YES  | MUL | NULL              |                |
| legal_gov_update_id           | int(11)      | YES  | MUL | NULL              |                |
| legal_info_update_id          | int(11)      | YES  | MUL | NULL              |                |
| legal_verifications_update_id | int(11)      | YES  | MUL | NULL              |                |
| ewallet_log_update_id         | int(11)      | YES  | MUL | NULL              |                |
| legal_lang                    | tinyint(4)   | YES  | MUL | NULL              |                |
+-------------------------------+--------------+------+-----+-------------------+----------------+
65 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:18:09.460

即使它们没有直接关系，您仍然可以执行`JOIN`：

```
UPDATE 
    members_info mb JOIN
    members_info ma ON ma.member_info_id = 98089
SET
    mb.Name = ma.Name,
    mb.Info = ma.Info
    -- Etc... 
WHERE
    mb.member_info_id = 236505 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:19:52.590

如果您只想用 A 的信息更新单个成员 (B)，那么...

```
UPDATE members_info member_B, (SELECT DISTINCT ID, Column_1, Column_2, Column_X
                             FROM members_info
                             WHERE id = '98089') member_A

SET member_B.Column_1 = member_A.Column_1, member_B.Column_2 = member_A.Column_2
WHERE member_B.id = '236505' 
```

**注：未经测试。

# excel - 根据行中其他单元格的内容填充 Excel 2007 中的单元格

> ID：14242588
> 
> 赞同：0
> 
> 时间：2013-01-09T17:09:06.850
> 
> 标签：excel, vba

我有一个 Excel 2007 电子表格，其中填充了四列（V1 V2、V3 V4），其中包含用逗号分隔的值（整数 [0-20]）。值不必是连续的。
![Excel 电子表格：示例数据和输出](../Images/d6632c620cd25419307ba3c2af866395.png)
我想创建一个新列（例如newV），如果它包含在该行的前四列中的至少两列中，则其单元格仅包含一个整数。这可以通过 Excel 中的公式或宏来完成吗？如果是这样，解决这个问题的好方法是什么？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:26:08.167

如果每个值在每个单元格中只能出现一次：

```
Function IfAtLeast(rng As Range, num As Integer)
    Const SEP As String = ","
    Dim c As Range, d As Object, arr, i As Long, tmp, k
    Dim rv As String
    rv = ""
    Set d = CreateObject("scripting.dictionary")
    For Each c In rng
        arr = Split(c.Value, SEP)
        For i = LBound(arr) To UBound(arr)
            tmp = Trim(arr(i))
            If Not d.exists(tmp) Then d.Add tmp, 0
            d(tmp) = d(tmp) + 1
        Next i
    Next c
    For Each k In d.keys
        If d(k) >= num Then rv = rv & IIf(Len(rv) > 0, ",", "") & k
    Next k
    IfAtLeast = rv
End Function 
```

用法：

```
=IfAtLeast(A2:D2,2) 
```

编辑：如果您在对 UDF 进行故障排除时遇到问题，那么使用 sub 调试问题通常更容易

```
Sub Tester()
    debug.print IfAtLeast(Activesheet.Range("A2:D2"), 2)
End Sub 
```

# ios - 当目标是 iOS 5.0 时，应用程序不能在 iOS 5 上运行

> ID：14242598
> 
> 赞同：0
> 
> 时间：2013-01-09T17:09:19.023
> 
> 标签：ios, ios5, ios6

我用 iOS 6.0 SDK 制作了一个应用程序。我已将部署目标设置为 iOS 5.0。

当我在 iOS 6.0 模拟器中运行应用程序时，一切正常。但是当我在 iOS 5.0 模拟器中运行该应用程序时，我看到一个黑色窗口，并且 Xcode 在输出中说：

```
2013-01-08 14:25:06.032 Feestweek[583:c07] Unknown class SASlideMenuStaticViewController in Interface Builder file.
2013-01-08 14:25:06.965 Feestweek[583:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'The NIB data is invalid.'
*** First throw call stack:
(0x2159052 0x1f29d0a 0x2101a78 0x21019e9 0x14fd838 0x13a4e2c 0x13a53a9 0x150e5e2 0x13a55cb 0x1305a73 0x1305ce2 0x1305ea8 0x130cd9a 0x12ddbe6 0x12de8a6 0x12ed743 0x12ee1f8 0x12e1aa9 0x2043fa9 0x212d1c5 0x2092022 0x209090a 0x208fdb4 0x208fccb 0x12de2a7 0x12dfa9b 0x287d 0x27a5 0x1)
terminate called throwing an exception(lldb) 
```

我可以做些什么来在 iOS 5 上运行我的应用程序？我使用故事板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:14:44.043

取消选中 XIB 中的“使用自动布局”。Xcode 4.5 默认为您添加到项目中的新 nib 文件启用此属性。取消选中自动布局复选框解决了问题

# ruby-on-rails - 更改 before_save 回调中的属性以通过验证？

> ID：14242603
> 
> 赞同：3
> 
> 时间：2013-01-09T17:09:31.613
> 
> 标签：ruby-on-rails, validation, rails-activerecord

我有一个`Organization`带有`iv`属性的模型。如果`iv`未设置，则它是随机的，但它必须是唯一的。首先想到的是下面的回调。它不像`valid?`尝试重新验证那样工作。

```
class Organization < ActiveRecord::Base
  validates :iv, uniqueness: true
  before_save :set_default_iv

  def set_default_iv
    self.iv ||= random(1000)

    ### is it possible to validate like this?
    # self.iv = random(1000) until valid?
 end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:04:32.173

按照建议使用 UUID 生成器，或使用某种算法自己检查唯一性（下面的示例）。但是在`before_validation`回调中执行此操作，因此验证器将捕获任何错误。

```
before_validation :set_default_iv

def set_default_iv
  self.iv = random(1000) until iv.present? && !collisions_exist?
end

def collisions_exist?
  class.where({:iv => iv}).
        where(new_record? ? {} : ['id != ?', id]).exists?
end 
```

请注意，此算法的性能将随着表的增长和冲突的发生而降低。出于这个原因， UUID 生成器当然是推荐的方法`random(1000)`，因为您根本不需要手动检查冲突。

# php - 在两个网站之间传递 JSON 数组

> ID：14242604
> 
> 赞同：0
> 
> 时间：2013-01-09T17:09:35.370
> 
> 标签：php, json, curl

我想在两个网站之间传递一个数组，但我很难做到这一点，在我的本地主机中我尝试这个代码：

```
 $array = array("12" => "val", "34" => "val2");
 $url = 'http://example1.com/save.php';
 $post = 'data='.json_encode($array);
 $ch = curl_init($url);
 curl_setopt($ch, CURLOPT_POST, true);
 curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
 curl_setopt($ch, CURLOPT_HEADER, false);
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, false);
 curl_exec($ch);
 curl_close($ch); 
```

然后在 example1.com/save.php 我这样做只是为了测试：

```
 $result = json_decode($_POST['data'],true);

 foreach ($result as $key => $value) {
    echo $key.'='.$value.'<br />';
 } 
```

但这给了我这个警告：

```
 Warning: Invalid argument supplied for foreach() in /home/a2549384/public_html/save.php on line 5 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:19:43.753

[您应该使用is_array](http://php.net/manual/en/function.is-array.php)函数检查您传递给 foreach 的是一个数组。错误意味着您正在对不是数组的东西进行 foreach。

检查您的 foreach 并查看 as 之前的内容是否实际上是一个数组。不仅在理论上而且实际上使用[var_dump](http://php.net/manual/en/function.var-dump.php)来转储它。

此外，如果您不确定它是否是一个数组，您可以随时使用以下 PHP 示例代码进行检查：

```
if (is_array($variable)) {

  foreach ($variable as $item) {
   //do something
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:22:58.703

你可能需要改变

`$post = 'data='.json_encode($array);`

至

`$post = 'data='.urlencode(json_encode($array));`

无论如何，只是`var_dump($_POST);`在另一边，看看是否有编码错误。

您可以检查解码是否有`json_last_error()`错误。

# erlang - EProf Erlang 分析

> ID：14242607
> 
> 赞同：3
> 
> 时间：2013-01-09T17:09:42.173
> 
> 标签：erlang

我正在尝试使用 eprof 分析 Erlang 应用程序。结果表明大部分时间都花在了 dict 模块上，尽管我最感兴趣的分析模块并没有直接使用 dict，它的依赖项看起来有点像这样：

```
A-- B - dict
 |- C - dict 
```

A 是正在运行的进程（a gen_server）并使用模块 B 和 C，它们都使用 dict。如何判断哪个模块使用 dict 最多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-25T21:37:04.670

为了解决类似的问题，我创建了从 dbg 跟踪格式到 callgrind 格式的转换器。它帮助我使用 kcachegrind 作为具有时间成本信息的函数调用层次结构的可视化工具。

[https://github.com/virtan/eep](https://github.com/virtan/eep)

这是一个帮助查找时间花在哪里的视图示例 [https://raw.github.com/virtan/eep/master/doc/sshot6.png](https://raw.github.com/virtan/eep/master/doc/sshot6.png)

# dialog - 使用 maximizable 时使 p:dialog 可滚动

> ID：14242608
> 
> 赞同：2
> 
> 时间：2013-01-09T17:09:41.410
> 
> 标签：dialog, primefaces, scroll, scrollable, maximize

有谁知道如何使 ap: 对话框与最大化和滚动一起使用？

如果窗口随着滚动而最大化，它会被窃听并且滚动条消失。

我正在使用来自 primefaces 的 p:dialog。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T11:41:19.397

遇到同样的问题，我试图开发一种解决方法。这现在为我修复了缺少的垂直滚动条：

定义以下函数作为 PF 问题 # [4879](http://code.google.com/p/primefaces/issues/detail?id=4879)的解决方法：

```
function fixPFDialogToggleMaximize(dlg){
if(undefined == dlg.doToggleMaximize) {
    dlg.doToggleMaximize = dlg.toggleMaximize;
    dlg.toggleMaximize = function() {
        this.doToggleMaximize();

        var marginsDiff = this.content.outerHeight() - this.content.height();
        var newHeight = this.jq.innerHeight() - this.titlebar.outerHeight() - marginsDiff;
        this.content.height(newHeight);
    };
} 
```

像这样声明要修复的对话框：

```
<p:dialog widgetVar="myDialog" maximizable="true" ...>
...
</p:dialog>
<script type="text/javascript">
    $(document).ready(
        function(){fixPFDialogToggleMaximize(myDialog);}
    );
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-31T19:02:59.257

好吧，我不得不稍微修改你的答案，让它对我有用，我只想分享我的发现，希望能帮助别人。

我并不是想窃取您的答案的功劳，因为我真的不值得或不想要它的功劳，我只想分享我的发现...:)

它是这样的：

My Dialog 使用 onShow 属性调用您的函数并将对话框小部件 var 名称传递给您的函数：

```
<p:dialog widgetVar="charts" width="860" height="540" header="chart}" maximizable="true" minimizable="true" showEffect="fade" onShow="fixPFDialogToggleMaximize('charts')">                 
   <ui:include src="/pages/charts.xhtml"/>
</p:dialog> 
```

然后您的函数使用 PF(widgetVar)：

```
function fixPFDialogToggleMaximize(dlg) {
    if (undefined == PF(dlg).doToggleMaximize) {
        PF(dlg).doToggleMaximize = PF(dlg).toggleMaximize;
        PF(dlg).toggleMaximize = function () {
            this.doToggleMaximize();
            var marginsDiff = this.content.outerHeight() - this.content.height();
            var newHeight = this.jq.innerHeight() - this.titlebar.outerHeight() - marginsDiff;
            this.content.height(newHeight);
        };
    }
} 
```

非常感谢您提供答案，因为它帮助我解决了我在使用 PF 5.2 社区版时遇到的同样问题。

最好的祝福，

乔

# android - jQuery 道具禁用在 Android 浏览器中不起作用

> ID：14242612
> 
> 赞同：1
> 
> 时间：2013-01-09T17:09:53.827
> 
> 标签：android, jquery, web-applications, disabled-input

在桌面浏览器（Chrome）中，我可以使用 jQuery 函数将输入字段设置为禁用： `inputVar.prop('disabled',true)`. 在 GS3 手机上的 Android 浏览器中，同样的代码似乎没有任何作用。我已经在 Android Chrome 和默认浏览器上进行了测试。

有什么选择吗？我也试过这些，但没有运气。

```
inputVar.attr('disabled','');
inputVar.attr('disabled','disabled');
inputVar[0].disabled = false; 
```

**编辑** 完整代码

```
$("fieldset#myFieldSet > input").each(function(){
    var inputVar = $(this);// This is the jquery object of the input
    inputVar.prop('disabled',true);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:11:29.923

嗯，使用 attr 的有效语法是`inputVar.attr('disabled','disabled')`，你试过吗？

此外，请确保您的选择器正在工作（尝试隐藏输入或其他内容），然后再假设问题是禁用。

# android - 需要android设备设置屏幕关闭超时监听器

> ID：14242620
> 
> 赞同：0
> 
> 时间：2013-01-09T17:10:19.240
> 
> 标签：android, timeout, screen

我需要/想要添加设备设置屏幕关闭超时侦听器，以使用用户在设置设备首选项时选择的最新时间更新我的开关。

我试过的代码：

```
 OnSharedPreferenceChangeListener listener = new OnSharedPreferenceChangeListener() {

        @Override
        public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
            Log.v(TAG, "Pref changes");
        }
    };
    SharedPreferences pref = getApplicationContext().getSharedPreferences(Settings.System.SCREEN_OFF_TIMEOUT, 0);
    pref.registerOnSharedPreferenceChangeListener(listener); 
```

我试过了，但似乎监听器只适用于特定的上下文（在我的例子中是 appContext）

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-21T23:09:56.407

我知道这是一个老问题，但由于我最近发现了如何做到这一点，我想我会发布我的答案，以防其他人遇到这个问题。

在以下示例中，“上下文”是您的活动或服务...

```
int displayTimeout;

ContentObserver settingsContentObserver = new ContentObserver(new Handler()) {
@Override
public void onChange(boolean selfChange) {
    super.onChange(selfChange);
    try {
        int checkDisplayTimeout = Settings.System.getInt(context.getContentResolver(), Settings.System.SCREEN_OFF_TIMEOUT);
        if (checkDisplayTimeout != displayTimeout) {
            // the DisplayTimeout has changed
            displayTimeout = checkDisplayTimeout;
        }
    } catch (SettingNotFoundException e) {
        // The SCREEN_OFF_TIMEOUT setting didn't change 'cause it doesn't exist
    }
}}; 
```

要让它开始收听，请使用

```
context.getContentResolver().registerContentObserver(android.provider.Settings.System.CONTENT_URI, true, settingsContentObserver); 
```

通过使用`android.provider.Settings.System.CONTENT_URI`，此 ContentObserver 应该响应许多（但不是全部）设置更改。

确保在听完后将其关闭。

```
context.getContentResolver().unregisterContentObserver(settingsContentObserver); 
```

# php - 使用 jquery 输入重新加载页面

> ID：14242623
> 
> 赞同：0
> 
> 时间：2013-01-09T17:10:23.537
> 
> 标签：php, codeigniter

在我的应用程序中，用户可以制作自己的 Web 表单进行注册。每个新添加的字段都包含三个元素`field_name`：`field_type`和`field_rules`。我至少`field_name`需要指定。

我的问题是当验证失败时，页面重新加载时我会丢失新添加的表单字段。当表单验证失败时，如何将表单错误发送回每个受尊重的表单字段并仍然保留他们的所有工作？

编辑：对不起，如果我不清楚。好的，所以 jQuery 用于向页面添加表单字段。每个克隆的 div 包含三个文本框：field_name、field_type 和 field_rules。我想要做的是使用 CodeIgniter 遍历这些数组以检查我需要的必填字段是否有内容。如果没有，我想将用户发送回表单页面，其中所有用户添加的 jQuery 克隆 div 都存在于用户定义的数据中。

我一直在研究一个条件构造，它将检查 $data 数组以确定它是否应该迭代 div。我想知道是否有更简单的方法：即：在下一页加载或其他内容时将数据发送到 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:53:08.410

看看这个：[http ://www.jqbyte.com/StickyForms/](http://www.jqbyte.com/StickyForms/)

这是一个不错的技巧，您可以使用——将新添加的字段和值存储在 cookie 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T19:47:52.270

好吧，我想给你一些建议。

当您使用 jquery 时，创建一个隐藏输入字段并将其值设置为 0。
当用户创建克隆 div 时，将其值更新为 +1。
当您提交字段并且验证失败时，发布数据可用。
使用 jquery document.ready 并调用一个简单的函数，该函数将在页面加载时运行并获取隐藏输入的值。
如果值为 0，则什么也不做，如果值为 3，则创建 3 个克隆 div。
这样，用户将拥有与提交表单之前相同数量的字段。

还有其他一些提交表单和获取帖子数据的方法。

### [如何使用 jquery ajax 重新填充验证失败的表单](https://stackoverflow.com/questions/10893332/using-jquery-load-to-populate-form-after-failed-validation-with-ajax-in-codeigni)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T19:49:45.623

在这种情况下，传统的表单提交模型不太实用，因为要重新创建它们需要由 PHP 输出的表单字段。

您应该考虑使用 Ajax 调用来进行表单提交。使用 Ajax，您可以获取所有表单字段并将它们捆绑到一个请求中。然后将请求发布到您的服务器，并从服务器调用返回响应。

使用 Ajax，整个页面不会重新加载。您负责解析来自服务器的结果并将其呈现给用户。

为了实现这一点，您可能应该重构处理表单输出/提交的控制器。提交组件应该进入一个单独的控制器，以`JSON`表单形式输出结果，以便 jQuery 轻松解析它。

参考：[这](http://www.od2dev.be/codeigniter-form-with-ajax/)是一个看起来可能对您有所帮助的教程。

有任何问题，然后发表评论。

# javascript - 单击时突出显示行

> ID：14242629
> 
> 赞同：-2
> 
> 时间：2013-01-09T17:10:50.690
> 
> 标签：javascript, html, css, dom

我想在我的 html 页面中添加功能以在选中时突出显示（将行颜色更改为 #DFDFDF）。

如果选择了另一行，则将行颜色返回到其初始颜色并为新选择的行着色。

请注意，当单击顶部标题时，id 喜欢使其免于改变颜色。

这是小提琴：http: [//jsfiddle.net/q42L2/](http://jsfiddle.net/q42L2/)

非常感谢和感谢您的所有帮助

```
<div id="results" class="scrollingdatagrid">

  <table id="mstrTable" cellspacing="0">
     <thead>
      <tr> 
        <th>File Number</th>
        <th>Date1</th>
        <th>Date2</th>
        <th>Status</th>
        <th>Num.</th>
      </tr>
    </thead>
    <tbody>
      <tr> 
        <td>KABC</td>
        <td>09/12/2002</td>
        <td>09/12/2002</td>
        <td>Submitted</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>KCBS</td>
        <td>09/11/2002</td>
        <td>09/11/2002</td>
        <td>Lockdown</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WFLA</td>
        <td>09/11/2002</td>
        <td>09/11/2002</td>
        <td>Submitted</td>
        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>

        <td>09/15/2002</td>

        <td>09/15/2002</td>
        <td>In-Progress</td>
        <td>10</td>
      </tr>
      <tr> 
        <td>WROC</td>

        <td>10/11/2002</td>

        <td>10/11/2002</td>

        <td>Submitted</td>
        <td>12</td>
      </tr>
      <tr> 
        <td>WPPP</td>
        <td>09/16/2002</td>
        <td>09/16/2002</td>
        <td>In-Progress</td>

        <td>0</td>
      </tr>
      <tr> 
        <td>WRRR</td>
        <td>09/06/2002</td>
        <td>09/06/2002</td>
        <td>Submitted</td>
        <td>5</td>

      </tr>
      <tr> 
        <td>WTTT</td>
        <td>09/21/2002</td>
        <td>09/21/2002</td>
        <td>In-Progress</td>
        <td>0</td>
      </tr>

      <tr> 
        <td>W000</td>
        <td>11/11/2002</td>
        <td>11/11/2002</td>
        <td>Submitted</td>
        <td>7</td>
      </tr>
      <tr> 
        <td>KABC</td>

        <td>10/01/2002</td>

        <td>10/01/2002</td>
        <td>Submitted</td>
        <td>10</td>
      </tr>
      <tr> 
        <td>KCBS</td>

        <td>10/18/2002</td>

        <td>10/18/2002</td>

        <td>Lockdown</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WFLA</td>
        <td>10/18/2002</td>
        <td>10/18/2002</td>
        <td>Submitted</td>

        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>
        <td>10/19/2002</td>
        <td>10/19/2002</td>
        <td>In-Progress</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>WROC</td>
        <td>07/18/2002</td>
        <td>07/18/2002</td>
        <td>Submitted</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WPPP</td>
        <td>10/28/2002</td>
        <td>10/28/2002</td>
        <td>In-Progress</td>
        <td>10</td>
      </tr>
      <tr> 
        <td>WRRR</td>

        <td>10/28/2002</td>

        <td>10/28/2002</td>
        <td>Submitted</td>
        <td>5</td>
      </tr>
      <tr> 
        <td>WTTT</td>

        <td>10/08/2002</td>

        <td>10/08/2002</td>

        <td>In-Progress</td>
        <td>0</td>
      </tr>
      <tr> 
        <td>WIL0</td>
        <td>10/18/2001</td>
        <td>10/18/2001</td>
        <td>Submitted</td>

        <td>7</td>
      </tr>
      <tr> 
        <td>KABC</td>
        <td>04/18/2002</td>
        <td>04/18/2002</td>
        <td>Submitted</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>KCBS</td>
        <td>10/05/2001</td>
        <td>10/05/2001</td>
        <td>Lockdown</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WFLA</td>
        <td>10/18/2002</td>
        <td>10/18/2002</td>
        <td>Submitted</td>
        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>

        <td>10/19/2002</td>

        <td>10/19/2002</td>
        <td>In-Progress</td>
        <td>0</td>
      </tr>
      <tr> 
        <td>WROC</td>

        <td>12/18/2002</td>

        <td>12/18/2002</td>

        <td>Submitted</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WPPP</td>
        <td>12/28/2002</td>
        <td>12/28/2002</td>
        <td>In-Progress</td>

        <td>8</td>
      </tr>
      <tr> 
        <td>WRRR</td>
        <td>12/20/2002</td>
        <td>12/20/2002</td>
        <td>Submitted</td>
        <td>5</td>

      </tr>
      <tr> 
        <td>WTTT</td>
        <td>12/11/2002</td>
        <td>12/11/2002</td>
        <td>In-Progress</td>
        <td>0</td>
      </tr>

      <tr> 
        <td>W0VB</td>
        <td>01/18/2003</td>
        <td>01/18/2003</td>
        <td>Submitted</td>
        <td>17</td>
      </tr>
      <tr> 
        <td>KABC</td>

        <td>12/17/2002</td>

        <td>12/17/2002</td>
        <td>Submitted</td>
        <td>20</td>
      </tr>
      <tr> 
        <td>KCBS</td>

        <td>12/16/2002</td>

        <td>12/16/2002</td>

        <td>Lockdown</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WFAA</td>
        <td>12/18/2002</td>
        <td>12/18/2002</td>
        <td>Submitted</td>

        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>
        <td>12/18/2002</td>
        <td>12/18/2002</td>
        <td>In-Progress</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>WROC</td>
        <td>12/19/2002</td>
        <td>12/19/2002</td>
        <td>Submitted</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WPPP</td>
        <td>12/06/2002</td>
        <td>12/06/2002</td>
        <td>In-Progress</td>
        <td>0</td>
      </tr>
      <tr> 
        <td>WRRR</td>

        <td>12/28/2002</td>

        <td>12/28/2002</td>
        <td>Submitted</td>
        <td>5</td>
      </tr>
      <tr> 
        <td>WTTT</td>

        <td>12/30/2002</td>

        <td>12/30/2002</td>

        <td>In-Progress</td>
        <td>0</td>
      </tr>
      <tr> 
        <td>UMBA</td>
        <td>12/26/2002</td>
        <td>12/26/2002</td>
        <td>Submitted</td>

        <td>7</td>
      </tr>
      <tr> 
        <td>KABC</td>
        <td>12/18/2002</td>
        <td>12/18/2002</td>
        <td>Submitted</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>KCBS</td>
        <td>12/29/2002</td>
        <td>12/29/2002</td>
        <td>Lockdown</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WFFF</td>
        <td>12/22/2002</td>
        <td>12/22/2002</td>
        <td>Submitted</td>
        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>

        <td>12/18/2001</td>

        <td>12/18/2001</td>
        <td>In-Progress</td>
        <td>9</td>
      </tr>
      <tr> 
        <td>WROC</td>

        <td>11/19/2001</td>

        <td>11/19/2001</td>

        <td>Submitted</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WPPP</td>
        <td>11/20/2001</td>
        <td>11/20/2001</td>
        <td>In-Progress</td>

        <td>0</td>
      </tr>
      <tr> 
        <td>WRRR</td>
        <td>10/19/2001</td>
        <td>10/19/2001</td>
        <td>Submitted</td>
        <td>5</td>

      </tr>
      <tr> 
        <td>WTTT</td>
        <td>11/29/2001</td>
        <td>11/29/2001</td>
        <td>In-Progress</td>
        <td>8</td>
      </tr>

      <tr> 
        <td>KPLT</td>
        <td>11/19/2001</td>
        <td>11/19/2001</td>
        <td>Submitted</td>
        <td>7</td>
      </tr>
      <tr> 
        <td>KABC</td>

        <td>11/19/2001</td>

        <td>11/19/2001</td>
        <td>Submitted</td>
        <td>13</td>
      </tr>
      <tr> 
        <td>KBRE</td>

        <td>11/19/2001</td>

        <td>11/19/2001</td>

        <td>Lockdown</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WFLA</td>
        <td>11/19/2001</td>
        <td>11/19/2001</td>
        <td>Submitted</td>

        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>
        <td>02/19/2003</td>
        <td>02/19/2003</td>
        <td>In-Progress</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>WROC</td>
        <td>02/17/2003</td>
        <td>02/17/2003</td>
        <td>Submitted</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WPPP</td>
        <td>02/16/2003</td>
        <td>02/16/2003</td>
        <td>In-Progress</td>
        <td>16</td>
      </tr>
      <tr> 
        <td>WRRR</td>

        <td>02/29/2003</td>

        <td>02/29/2003</td>
        <td>Submitted</td>
        <td>5</td>
      </tr>
      <tr> 
        <td>WTTT</td>

        <td>03/19/2003</td>

        <td>03/19/2003</td>

        <td>In-Progress</td>
        <td>19</td>
      </tr>
      <tr> 
        <td>KLTR</td>
        <td>02/10/2003</td>
        <td>02/10/2003</td>
        <td>Submitted</td>

        <td>7</td>
      </tr>
      <tr> 
        <td>KABC</td>
        <td>04/05/2003</td>
        <td>04/05/2003</td>
        <td>Submitted</td>
        <td>16</td>

      </tr>
      <tr> 
        <td>KCBS</td>
        <td>02/19/2003</td>
        <td>02/19/2003</td>
        <td>Lockdown</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WFLA</td>
        <td>02/16/2003</td>
        <td>02/16/2003</td>
        <td>Submitted</td>
        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>

        <td>02/13/2003</td>

        <td>02/13/2003</td>
        <td>In-Progress</td>
        <td>5</td>
      </tr>
      <tr> 
        <td>WROC</td>

        <td>02/14/2003</td>

        <td>02/14/2003</td>

        <td>Submitted</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WPPP</td>
        <td>03/19/2003</td>
        <td>03/19/2003</td>
        <td>In-Progress</td>

        <td>0</td>
      </tr>
      <tr> 
        <td>WRRR</td>
        <td>02/19/2002</td>
        <td>02/19/2002</td>
        <td>Submitted</td>
        <td>5</td>

      </tr>
      <tr> 
        <td>WTTT</td>
        <td>02/19/2002</td>
        <td>02/19/2002</td>
        <td>In-Progress</td>
        <td>0</td>
      </tr>

      <tr> 
        <td>WYYD</td>
        <td>02/11/2002</td>
        <td>02/11/2002</td>
        <td>Submitted</td>
        <td>7</td>
      </tr>
      <tr> 
        <td>KABC</td>

        <td>02/19/2002</td>

        <td>02/19/2002</td>
        <td>Submitted</td>
        <td>11</td>
      </tr>
      <tr> 
        <td>KCBS</td>

        <td>02/19/2002</td>

        <td>02/19/2002</td>

        <td>Lockdown</td>
        <td>12</td>
      </tr>
      <tr> 
        <td>WFLA</td>
        <td>05/19/2002</td>
        <td>05/19/2002</td>
        <td>Submitted</td>

        <td>1</td>
      </tr>
      <tr> 
        <td>WTSP</td>
        <td>02/20/2002</td>
        <td>02/20/2002</td>
        <td>In-Progress</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>WROC</td>
        <td>05/20/2002</td>
        <td>05/20/2002</td>
        <td>Submitted</td>
        <td>2</td>
      </tr>

      <tr> 
        <td>WPPP</td>
        <td>02/19/2003</td>
        <td>02/19/2003</td>
        <td>In-Progress</td>
        <td>13</td>
      </tr>
      <tr> 
        <td>WRRR</td>

        <td>02/19/2002</td>

        <td>02/19/2002</td>
        <td>Submitted</td>
        <td>5</td>
      </tr>

    </tbody>
  </table>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:26:06.353

尝试从这个开始（未经测试）。它应该为您指明正确的方向，您需要做的就是在创建表后通过延迟它或通过从 onload 函数调用 initSelectableTable 来包含它。确保将表的 id 设置为“SelectableTable”。

```
var OldColour = "";
var SelectedRow = null;
var SelectedColour = "#DFDFDF";

initSelectableTable("SelectableTable");

function onCellClicked(cell) {
    if (cell.parentNode) {
        if (SelectedRow) SelectedRow.style.backgroundColor = OldColour;
        SelectedRow = cell.parentNode;
        OldColour = SelectedRow.style.backgroundColor;
        SelectedRow.style.backgroundColor = SelectedColour;     
    }
}

function initSelectableTable(tableid) {
    var elTable = document.getElementById(tableid);
    if (elTable) {
        var cells = elTable.getElementsByTagName("td");
        for (var i = 0; i < cells.length; i++) {
            cells[i].onclick = function () { onCellClicked(this); }
        }
    }
} 
```

希望能帮助到你...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:55:41.590

```
$('tbody tr').bind('click', function (evn){
  $('tbody tr').css('background-color', 'white');
    $(this).css('background-color', 'red');
  }); 
```

[http://jsfiddle.net/raghu2314/RCEKW/1/](http://jsfiddle.net/raghu2314/RCEKW/1/)

这将解决问题，我已经测试它工作正常

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-09T17:27:57.597

您可以通过以下代码（Jquery）简单地做到这一点

```
$(document).ready(function () {       
  $('#mstrTable tr').not('thead tr').click(function () {
    $('#mstrTable tr').css('background-color', 'white');
    $(this).css('background-color', '#DFDFDF');             
  }); 
}); 
```

[演示](http://jsfiddle.net/laraprabhu/q42L2/3/)

**编辑**

`thead`通过使用从选择中排除`Not`。

# solr - 什么会导致 Lucene 索引损坏？

> ID：14242631
> 
> 赞同：5
> 
> 时间：2013-01-09T17:10:51.297
> 
> 标签：solr, lucene

我正在尝试找出从损坏的索引中恢复的策略。为了“掌握”这可能发生的频率，我主要想知道可能导致索引损坏的事情，其次，如果存在关于这些事件发生概率的信息，那么虽然不是那么重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-03-17T06:46:49.617

大多数时候索引应该由于编写器关闭不当而损坏。

```
IndexWriter writer=new IndexWriter(dir,analyzer,true);
writer.addDocument(doc);
writer.close(false); 
```

# javascript - .html 未按预期工作

> ID：14242634
> 
> 赞同：0
> 
> 时间：2013-01-09T17:11:01.057
> 
> 标签：javascript, jquery

```
$('#clicker').click(function () {
 collegeArray = ["Harvard", "Yale", "Princeton"];
 alert(collegeArray.length);
 for (var i = 0; i < collegeArray.length; i++) {
     var divIdName = 'college' + i + 'Div'; //manuplating name of each div generated dynamically
     var newdiv = document.createElement('div')
     .setAttribute('id', divIdName) //setting the name of each div created dynamically
     .html('<p>' + collegeArray.toString() + '</p>')
     appendTo($(#'survey'));
 }
}); 
```

每次按下点击器按钮时，上面的代码都应该附加 html，但它不起作用。我不确定我在这里做错了什么

[http://jsfiddle.net/HvJnH/19/](http://jsfiddle.net/HvJnH/19/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:13:08.860

您正在尝试对原始 DOM 元素使用 jQuery 方法。

```
var newdiv = $('<div/>')
  .prop('id', divIdName) //setting the name of each div created dynamically
  .html('<p>' + collegeArray.toString() + '</p>')
  .appendTo($(#'survey')); 
```

或者：

```
var newdiv = $('<div/>', {
  id: divIdName,
  html: '<p>' + collegeArray.toString() + '</p>'
}).appendTo('#survey'); 
```

*编辑*——另外，正如 Shmiddty 在评论中指出的那样，你绝对不应该在多个元素上重复使用“id”值。如果您想出于某种目的对元素进行分类，或者使用计数器或其他东西组成新的“id”值，请使用“类”属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:13:21.630

您的 # 在您的调查选择器上的引号之外。

你`$(#'survey')`应该有的时候有`$('#survey')`

此外，您将 jQuery 函数与常规 javascript 函数和元素混合在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:15:23.457

您遇到了几个问题，包括在普通 JS 元素上使用 jQuery 方法并在`#`外部加上引号。试试这个：

```
$('#clicker').click(function () {
    collegeArray = ["Harvard", "Yale", "Princeton"];
    for (var i = 0; i < collegeArray.length; i++) {
        var divIdName = 'college' + i + 'Div'; //manuplating name of each div generated dynamically
        var newdiv = $('<div></div>', {
            id: divIdName
        })
            .html('<p>' + collegeArray.toString() + '</p>')
            .appendTo($('#survey'));
    }
}); 
```

[**示例小提琴**](http://jsfiddle.net/RoryMcCrossan/HvJnH/22/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T17:21:40.920

一些更正，它可能会起作用：

```
$('#clicker').click(function () {
    var collegeArray = ["Harvard", "Yale", "Princeton"];
    for (var i = 0; i < collegeArray.length; i++) {
        var divIdName = 'college' + i + 'Div';
        var newDiv = $("<div/>")
            .attr("id", divIdName)
            .html('<p>' + collegeArray[i] + '</p>');

        $("#survey").append(newDiv);
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T17:20:28.020

尝试以下..它的工作

```
 $('#clicker').click(function () {
   collegeArray = ["Harvard", "Yale", "Princeton"];

     for (var i = 0; i < collegeArray.length; i++) {
         var divIdName = 'college' + i + 'Div'; 
          $('<div></div>').attr('id', divIdName).html('<p>' + collegeArray.toString() + '</p>').appendTo($('#survey'));
     }
 }); 
```

# http - php 中的 getenv('HTTP_X_FORWARDED_FOR') 不返回任何内容

> ID：14242636
> 
> 赞同：0
> 
> 时间：2013-01-09T17:11:10.343
> 
> 标签：http

我一直在尝试获取 LAN 中连接的计算机的客户端 IP 地址，如果我使用 getenv('REMOTE_ADDR') 或 $_SERVER['REMOTE_ADDR'] 它返回不同的 IP，它似乎获得了代理地址计算机使用的浏览器，当我尝试 getenv('HTTP_X_FORWARDED_FOR') 它什么都不返回，并且 $_SERVER['HTTP_X_FORWARDED_FOR'] 有一个未定义索引的错误。我已经尝试了在获取真实 IP 地址时发现的所有可能的代码，但没有任何效果。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T11:51:33.740

客户端 HTTP 代理的预期目的之一是隐藏组织的内部拓扑。

如果您控制代理，您可以将其设置为在标头中可靠地报告原始 IP 地址，但不能保证其他人会这样做。

由于在 HTTP 中隐藏拓扑的能力是有意的，因此您必须诉诸“邪恶”的做法，例如签名的小程序、activeX 控件或其他安全性松懈的执行方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-07T05:50:09.197

**这是获取准确 IP 地址的更短、更简洁的方法：**

```
function get_ip_address(){
    foreach (array('HTTP_CLIENT_IP', 'HTTP_X_FORWARDED_FOR', 'HTTP_X_FORWARDED', 'HTTP_X_CLUSTER_CLIENT_IP', 'HTTP_FORWARDED_FOR', 'HTTP_FORWARDED', 'REMOTE_ADDR') as $key){
        if (array_key_exists($key, $_SERVER) === true){
            foreach (explode(',', $_SERVER[$key]) as $ip){
                $ip = trim($ip); // just to be safe

                if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE) !== false){
                    return $ip;
                }
            }
        }
    }
} 
```

它工作正常..

# powershell - 是否可以通过脚本更新 Word 文档中的表单字段

> ID：14242639
> 
> 赞同：5
> 
> 时间：2013-01-09T17:11:19.943
> 
> 标签：powershell, batch-file, ms-word, form-fields

这个问题可能会引起很多问题，所以我会尽量具体一点。我负责支持我的工作使用的第三方应用程序。此应用程序执行的功能之一是从 .dot 文件中提取 word 文档，其中包含来自数据库的信息。它使用 MERGEFIELD 字段来执行此操作。当这个数据被拉入时，它允许保留正常的日期字段和 printdate 字段，但是 createdate（我需要的那个）和 savedate 字段完全搞砸了。它将原始模板创建日期保留在那里，而不是像模板通常那样插入今天的日期作为文档创建日期，并使该字段无效，使其成为纯文本而不是 createdate 字段，因此您无法更新它。我不能 当 createate 字段与邮件合并一起使用时，找不到关于这是否是标准行为的确切答案。我会使用正常的日期，但这些文档可以在几天内进行编辑，最终转换为 PDF 以获得“永久”副本。如果您从程序创建文档然后在第二天打开它，它会自动更新日期......不是我们想要的，需要是它打开的第一天。

我有一个顿悟，可以使用 powershell 脚本来更新模板本身的 createdate。设法通过以下三行来做到这一点：

```
$a = Get-Date
$b = Get-Item "Q:\CUSTOM\DATETEST.dot"
$b.CreationTime = $a 
```

该脚本运行良好，并且文件信息已更新。但是，要让文档中的实际文字反映这一点，您必须进入 Word，用 F9 刷新表单中的字段，然后保存。即使更新了创建日期，当您在 Word 中或从其他应用程序中提取文档时，Word 文档文本仍会显示旧日期，直到您刷新并手动保存模板。这些表格不受保护，因此这不是问题。我看到了一些用于编辑 word 文件的 powershell 脚本，但找不到一个可以刷新日期字段的脚本。我用修改日期尝试了这个脚本，并在表单中使用了 savedate 字段，但这也需要进入并实际保存表单。有没有办法在 powershell 或批处理（或任何脚本语言，不要' 在这一点上不关心）这将使我能够刷新文档中的表单字段然后保存它们，或者任何人都可以想到任何其他方式来解决这个问题？我有几份文件需要这样做，所以每天早上手动进行也是不切实际的。

编辑：我找到了以下代码，如下所述。在这段代码中，我还发现我需要将 Documents.Add 更改为 Documents.Open。我会注意到这有助于以我需要的方式操纵保存日期，但 createdate 仍然是一个谜。

```
$word=new-object -com Word.Application 
$doc=$word.Documents.Add($filename) 
$word.Visible=$False 
$word.ActiveDocument.Fields.Update() 
$doc.SaveAs([REF]$filename) 
$doc.Close() 
$word.Quit() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T21:16:16.193

要将文档另存为模板，请使用以下代码：

```
 $word = new-object -com Word.Application 
 $doc = $word.Documents.add($filename)
 $word.Visible = $False 
 $saveFormat = [Enum]::Parse([Microsoft.Office.Interop.Word.WdSaveFormat],"wdFormatTemplate")
 $doc.SaveAs([ref]$filename2,[ref]$saveFormat)
 $doc.Close() 
 $word.Quit() 
```

这是未经测试的模板，但我已经让它与保存为`.doc`而不是默认值一起使用`.docx`。此外，如果文件与打开的文件同名，它不会让您保存文件。这就是为什么我将其更改为`$filename2`. 您可能需要做一些重命名技巧才能使其正常工作，但这应该可以帮助您解决如何保存文件的问题。

# android - 绕过 GMaps 中的“获取路线”按钮

> ID：14242642
> 
> 赞同：0
> 
> 时间：2013-01-09T17:11:31.627
> 
> 标签：android, google-maps, android-intent, maps

所以我有这样的意图：

```
 Intent intent = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse("http://maps.google.com/maps?daddr=38.757982,-9.153193"));
            intent.setClassName("com.google.android.apps.maps", "com.google.android.maps.MapsActivity");
            startActivity(intent); 
```

它会打开 GMaps 应用程序，`onClick`但会出现坐标文本框，用户仍必须按“获取方向”才能生成它们。

有没有办法我可以绕过这个“获取方向”按钮，这样当意图开始时它会生成方向，而无需用户单击“获取方向”？

谢谢。

编辑：我希望起点是用户的当前位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:32:13.887

您的 URI 中没有起始地址 ( `saddr`)，因此映射它会提示用户输入起始地址。如果您想从当前位置获得路线，`&saddr=Current+Location`请像这样添加到您的 URI -

```
Intent intent = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse("http://maps.google.com/maps?daddr=38.757982,-9.153193&saddr=Current+Location")); 
```

# javascript - 如何使用 Jquery 创建单级面包屑

> ID：14242645
> 
> 赞同：0
> 
> 时间：2013-01-09T17:11:34.137
> 
> 标签：javascript, jquery, html

我想在某些应用程序中创建一个单级面包屑，如下所示：

首页 -> 产品 -> 应用 -> 应用一

现在，应用程序可以有多个孩子。因此，将鼠标悬停在“应用程序”上时，我想要一个下拉菜单来显示指向不同应用程序的所有链接。我试图让用户更容易从一个应用程序跳到另一个应用程序。

任何建议或链接将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:14:38.613

这是一个很好的教程的链接，您需要将它们从水平堆叠更改为垂直堆叠，或者您希望它们看起来如何，但这是链接：

[http://www.kriesi.at/archives/create-a-multilevel-dropdown-menu-with-css-and-improve-it-via-jquery](http://www.kriesi.at/archives/create-a-multilevel-dropdown-menu-with-css-and-improve-it-via-jquery)

# ios - ABAddressBook 和 CFRelease 的奇怪之处

> ID：14242649
> 
> 赞同：0
> 
> 时间：2013-01-09T17:11:44.857
> 
> 标签：ios, automatic-ref-counting, abaddressbook

ABAddressBook 发生了一件奇怪的事情。这是一些代码：

```
- (NSArray*)addressBookArray {

    ABAddressBookRef addressBook = NULL;
    NSArray *temp = nil;

    if(&ABAddressBookCreateWithOptions != NULL) {

        CFErrorRef error = nil;
        addressBook = ABAddressBookCreateWithOptions(NULL, &error);
        ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {

            dispatch_async(dispatch_get_main_queue(), ^{
                if(error) {
                    // handle error
                }
                else if(!granted) {
                    // handle not granted
                }
            });
        });
    }
    else { // iOS 5
        addressBook = ABAddressBookCreate();
    }
    if(addressBook) {
        temp = (__bridge_transfer NSArray*)ABAddressBookCopyArrayOfAllPeople(addressBook);
        CFRelease(addressBook);
    }
    return temp;
}

- (NSArray*)emailList {

    NSArray *temp = [self addressBookArray];
    NSMutableArray *list = nil;

    if(temp) {

        int n = temp.count;
        list = [NSMutableArray arrayWithCapacity:n];

        for(int i = 0; i < n ; i++) {

            ABRecordRef person = (__bridge ABRecordRef)[temp objectAtIndex:i];
            NSString *name = (__bridge_transfer NSString*)ABRecordCopyCompositeName(person);

            if(name) {
                ABMultiValueRef emails = ABRecordCopyValue(person, kABPersonEmailProperty);

                if(emails) {
                    int cnt = ABMultiValueGetCount(emails);

                    for(int j = 0; j < cnt; j++) {
                        NSString *email = (__bridge_transfer NSString*)ABMultiValueCopyValueAtIndex(emails, j);

                        if(email) {
                            [list addObject:email];
                            break;
                        }
                    }
                    CFRelease(emails);
                }
            }
        }
    }
    return list;
} 
```

如果我调用`emailList`并注释掉`CFRelease(addressBook)`，我会收到 XCode 分析中可能存在泄漏的警告，但我的代码运行正常。

如果我取消注释`CFRelease(addressBook)`，则没有泄漏警告，`ABRecordRef person`并且`NSString *name`具有适当的值，但`ABMultiValueRef emails`如果始终为零。

使困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:26:57.020

虽然这让我有些吃惊，但我怀疑`ABPerson`没有它的`ABAddressBook`. 因此，地址簿需要与人一样存在。鉴于此，只要这都是单线程的，您可能希望将您的存储`ABAddressBook`在 ivar 中，这样您就不必一直创建和销毁它。如果它是多线程的，请记住`ABAddressBook`每个线程需要一个单独的。

# vb.net - 如何在 vb.net 中的某些条件下增加变量

> ID：14242650
> 
> 赞同：-2
> 
> 时间：2013-01-09T17:11:48.647
> 
> 标签：vb.net

我正在 vb.net 中编写一个应用程序，我想在其中增加变量（比如`bill_no`）。 `bill_no`从`1`每次点击按钮开始，它应该增加一。当`bill_no`达到 100 时，还有第二个变量（比如`book_no`），它从 1 开始，应该增加 1。

*   `bill_no`= 1 到 100：`book_no`= 1
*   `bill_no`= 101 到 200：`book_no = 2`
*   等等

我不知道该怎么做。请帮我完成这个任务。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:18:25.027

您可以使用整数除法（`\`VB 中的运算符）

```
book_no = (bill_no-1) \ 100 + 1 
```

`n \ 100`产生`0`for `n = 0 .. 99`, `1`for `n = 100 .. 199`, `2`for`n = 200 .. 299`等等

例子

```
bill_no = 100
book_no = (bill_no-1) \ 100 + 1
==> book_no = (100-1) \ 100 + 1
==> book_no = 99 \ 100 + 1
==> book_no = 0 + 1
==> book_no = 1

bill_no = 101;
book_no = (bill_no-1) \ 100 + 1;
==> book_no = (101-1) \ 100 + 1;
==> book_no = 100 \ 100 + 1;
==> book_no = 1 + 1;
==> book_no = 2;

bill_no = 190;
book_no = (bill_no-1) \ 100 + 1;
==> book_no = (190-1) \ 100 + 1;
==> book_no = 189 \ 100 + 1;
==> book_no = 1 + 1;
==> book_no = 2; 
```

注意：整数除法去掉小数点后的部分。互补运算将是模运算（`Mod`VB 中的运算符）。

```
13 \ 5   ==> 2
13 Mod 5 ==> 3   'The rest of the division 
```

自从

```
2 * 5 + 3 = 13 
```

# javascript - 尝试调整画布大小时“没有方法'setAutoResize'”

> ID：14242656
> 
> 赞同：0
> 
> 时间：2013-01-09T17:12:00.660
> 
> 标签：javascript, facebook, canvas, sdk

让我们从头开始。

**情况：**

我有一个应用程序。当我从 Facebook 主搜索栏中按名称搜索应用程序（智能城市项目）时，我看到该应用程序已加载到 Facebook 中，并且有一个滚动条来导航内容（[https://apps.facebook.com/smartcityproject /](https://apps.facebook.com/smartcityproject/)）。这里一切正常。

当我转到页面 (https://www.facebook.com/smartCanada) 并单击应用程序选项卡时，它也会将我带到 Facebook 内的应用程序，但这个 Facebook 上下文是不同的 ( [https://www.facebook. com/smartCanada/app_253415468099353](https://www.facebook.com/smartCanada/app_253415468099353)）。这里我们有一个来自 Facebook 的主滚动条和一个来自页面 iframe 的内部滚动条。

**问题：**

**我必须只得到一个卷轴。**

文档（以及几篇文章、博客和论坛）说我可以使用 FB.Canvas.setSize 或 setAutoGrow（https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setSize/），但我明白了使用这些方法时出现以下 javascript 错误：

```
Uncaught TypeError: Object #<Object> has no method 'setAutoResize' 
```

在文件 connect.facebook.net/en_US/all.js，第 74 行

**问题：**

有人知道我在做什么错吗？'setAutoResize' 方法不在 Facebook 库中？我必须等待一些脚本加载？该方法实际上有效还是无效？有没有另一种方法来改变 iframe 的高度？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:19:48.520

问题是您的脚本在涉及此代码块时停止工作：

```
<script type="text/javascript">
    var userLanguage = '';

    window.fbAsyncInit = function(){

        // ...

        FB.Canvas.setAutoResize();

        // ...
    };

    // Load the SDK Asynchronously
    // ...
</script> 
```

`FB.Canvas.setAutoResize();`现在已弃用，因此 JavaScript 会引发错误。您需要将此行替换为`FB.Canvas.setAutoGrow();`，或将其删除。

您的脚本中还有第二个错误，涉及：

```
<script type="text/javascript">
    jQuery(document).ready(function() {
        FB.Canvas.setAutoGrow();
    }
</script> 
```

将其更改为：

```
<script type="text/javascript">
    jQuery(document).ready(function() {
        FB.Canvas.setAutoGrow();
    })
    // Closing brace was missing!!
</script> 
```

# php - 注意非对象和未定义变量

> ID：14242658
> 
> 赞同：0
> 
> 时间：2013-01-09T17:12:05.777
> 
> 标签：php, mysqli

我试图通过在 PHP 中构建错误答案列表来检索每个问题的错误答案。例如，通过包含原始查询中的单行，来计算错误答案，如下所示：

```
 $query = "SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionNo, an.Answer, an.AnswerId 
   FROM Session s  
   INNER JOIN Question q ON s.SessionId = q.SessionId 
   JOIN Answer an ON q.QuestionId = an.QuestionId 
   WHERE s.SessionName = ? 
   ORDER BY q.QuestionId, an.Answer 
   "; 

   // prepare query 
   $stmt=$mysqli->prepare($query); 
   // You only need to call bind_param once 
   $stmt->bind_param("s", $assessment); 
   // execute query 
   $stmt->execute();  

   $specialOptionTypes = array( 
    'Yes or No' => array( 'Y', 'N' ), 
    'True or False' => array( 'T', 'F' ), 
); 

// Do this for each row: 
if ( array_key_exists( $row->OptionType, $specialOptionTypes ) ) { 
    $options = $specialOptionTypes[ $row->OptionType ]; 
} else if ( preg_match( '/^([A-Z])-([A-Z])$/', $row->OptionType, $match ) ) { 
    $options = range( $match[1], $match[2] ); 
} else { 
    // issue warning about unrecognized option type 
    $options = array(); 
} 
$right = str_split( $row->Answer );  // or explode() on a delimiter, if any 
$wrong = array_diff( $options, $right ); 

    // Fetch the results into an array 

   // get result and assign variables (prefix with db) 
   $stmt->bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionNo, $dbAnswer, $dbAnswerId); 
      while ($stmt->fetch()) { 

      $incorrect_ans[] = $wrong; 

      }     

      .... 

      //table row 

      <td class="answertd" name="incorrectanswers[]"><?php
echo $incorrect_ans[$key];
?></td> 
```

我遇到的问题是我没有得到错误的答案，而是收到了几个错误：

第一个错误是针对`$row`上面代码中显示的任何变量，其中指出：

> 注意：未定义的变量：row in ... on line ...
> 
> 注意：试图在线获取...中非对象的属性...

第二个问题在上面的表格行中，而不是显示不正确的答案，而是显示`Array`。

我的问题是如何修复通知和数组以至少有一个无错误的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:15:45.670

如果你没有初始化`$row`到 if 语句之外的东西，那么它是未定义的。

这意味着`$row`不是一个对象，在某些情况下它可能是 NULL 或 false（没有找到），因为它不可访问。超出范围

# jquery - jquery validate：通过别名覆盖 require_from_group 的默认消息失败

> ID：14242663
> 
> 赞同：0
> 
> 时间：2013-01-09T17:12:17.337
> 
> 标签：jquery, jquery-validate

我有一个由类名而不是字段名定义的特定规则：

```
$.validator.addClassRules("fillone", {
        require_from_group: [1,".fillone"]
    }); 
```

我想为此覆盖默认错误消息，所以我尝试了这个：

```
$.validator.addMethod("xrequire_from_group", $.validator.methods.required, 'Hey nutter, pick at least one');

$.validator.addClassRules("fillone", {
  xrequire_from_group: [1, ".fillone"]
}); 
```

我在这里有一个小提琴来证明它首先可以在不干预别名的情况下工作：

[http://jsfiddle.net/houmie/fg6ae/1/](http://jsfiddle.net/houmie/fg6ae/1/)

这是我在别名后得到的：

[http://jsfiddle.net/houmie/m9uNK/1/](http://jsfiddle.net/houmie/m9uNK/1/)

如您所见，它破坏了它。仅输入一个字段后，两条消息都会消失。但事实并非如此。这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:54:10.570

如果我理解正确的话，我会建议您使用[该`groups`选项](http://docs.jquery.com/Plugins/Validation/validate#toptions)来简单地为两个字段显示一条消息。从逻辑上讲，由于您不需要填写两个字段，因此两个字段旁边不应有错误消息。似乎一条消息告诉用户选择两个中的一个更有意义。

然后，您需要使用`errorPlacement:`选项将其放置在您想要的任何位置。

**工作演示：http:** [//jsfiddle.net/m9uNK/2/](http://jsfiddle.net/m9uNK/2/)

```
var validator = $(form).validate({
    groups: {
        groupname: "field1 field2"  // as per docs, "groupname" is arbitrary
    },
    errorPlacement: function (error, element) {
        if (element.attr("name") == "field1" || element.attr("name") == "field2") {
            error.insertAfter("[name='field2']");  // adjust this accordingly
        } else {
            error.insertAfter(element);  // this is default placement for everything else
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T10:57:13.413

我终于找到了一个可行的解决方案，代码中有一个细微的错误。

```
$.validator.addMethod("xrequire_from_group", $.validator.methods.required, 'Hey nutter, pick at least one'); 
```

用。。。来代替

```
$.validator.addMethod("xrequire_from_group", $.validator.methods.require_from_group, 'Hey nutter, pick at least one'); 
```

现在终于成功了！！！

# jsf-2 - 如何处理页面导航之间的 JSF 消息（POST-REDIRECT-GET）

> ID：14242665
> 
> 赞同：7
> 
> 时间：2013-01-09T17:12:20.420
> 
> 标签：jsf-2

我正在开发**JSF 2** Web 应用程序并使用从页面到页面的隐式导航来指定结果值和更改 url 值。我也有一些 Ajax 请求，以便能够在某些页面中进行更改，而无需提交所有内容。

例如，当我编辑用户的数据并保存更改时，我的问题就出现了。托管 Bean 保存用户数据并返回一个字符串以导航到用户列表。正确保存用户后，`FacesMessage`会在操作方法完成之前添加 a。

**按钮**

```
<p:commandButton value="#{msg.UPDATE}" action="#{manager.actionSave}"
            ajax="false" /> 
```

**将代码写入方法**

```
FacesContext.getCurrentInstance().addMessage(clientId, 
    new FacesMessage(FacesMessage.SEVERITY_INFO, msg, msg)); 
```

但是，即使我的`<h:messages />`主页中有一个标签，那里也没有显示任何内容。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-09T17:54:53.033

问题症状表明`faces-redirect=true`，`<redirect/>`如果您仍在使用`faces-config.xml`.

Faces 消息是请求范围的，因此仅在当前请求所服务的资源中可用。通过重定向导航时，您基本上是在指示网络浏览器在给定的 URL 上创建一个全新的请求。面部消息在该请求中根本不可用。

如果重定向确实是强制性的，例如为了完成[POST-Redirect-GET](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式（这是一件好事），那么您需要将消息存储在 flash 范围内。你可以通过调用[`Flash#setKeepMessages()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/Flash.html#setKeepMessages%28boolean%29)、传递来做到这一点`true`。

```
context.addMessage(clientId, message);
context.getExternalContext().getFlash().setKeepMessages(true); 
```

Note that this will fail if you're using a Mojarra version older than 2.1.14 and are redirecting to a resource in a different base folder. See also [issue 2136](http://java.net/jira/browse/JAVASERVERFACES-2136).

# sql - 如何更新指定类别的产品描述？

> ID：14242668
> 
> 赞同：0
> 
> 时间：2013-01-09T17:12:44.357
> 
> 标签：sql, magento, magento-1.6

我想使用以下 sql 代码将所有具有相同描述的产品设置为具有指定类别 ID 的产品，但在同一类别下它不会更新具有相同描述的产品。

```
update catalog_product_entity_text
  set value = "the product's name test hah test."
  where attribute_id = 66 and
        entity_id (select product_id from catalog_category_product
                    where category_id = 40); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:31:08.140

尝试像这样使用“entity_id IN ...”：

```
update catalog_product_entity_text
  set value = "the product's name test hah test."
  where attribute_id = 66 and
        entity_id IN (select product_id from catalog_category_product
                    where category_id = 40); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:31:46.593

您忘记`IN`在 entity_id 和选择查询之间进行写入。

我不知道您使用的是哪个版本，但对我来说 short_description 的 attribute_id 是 65，而描述是 64。

# javascript - 根据下拉选择在 AJAX/Javascript/HTML 中创建表单时遇到问题

> ID：14242670
> 
> 赞同：0
> 
> 时间：2013-01-09T17:12:48.793
> 
> 标签：javascript, jquery, html, css, ajax

我的工作想要一个非常简单的 Web 表单，我们将使用它来提交内部工作。作品提交将分为 4 个类别，每个类别都需要独特的信息。现在我现在有一个简单的表单，它执行以下操作：

请求名称：[文本框]
请求日期：[文本框]
获取：[文本框]
请求类型：[下拉] 4 项

我想要的是取决于选择的下拉项目，用户应该看到下面显示的正确表单。其中将包含一个表格形式更多“输入的项目和文本框”。

现在我正在尝试这个，但我遇到了多个问题，即我只能看到一个表格行而不是选择的所有内容。

所以也许我以错误的方式解决问题？所以我要投身于你面前，谦卑地寻求帮助。要么是正确方向的一点，要么是此时的任何东西！

```
$(document).ready(function() {
   $('select[name="select_main_table"]').change(function() {
      $("#main_table tr").hide().eq(this.value-1).show();
   }).change();
});

      <td><label for="typeofrequest">Type of Request</label></td>
      <td><select name="select_main_table">
        <option value="" selected="selected"> - Choose -</option>
        <option value="1">Office Move</option>
        <option value="2">Office Closure</option>
        <option value="3">New Office</option>
        <option value="4">New Service</option>
      </select>          </td>
      <td>&nbsp;</td>
    </tr>

   <table id="main_table">
    <tr> 
      <td><label for="sitecontactname">Site Contact Name</label></td>
      <td><input type="text" class="validate[required,custom[sitecontactname]]" name="sitecontactname" id="sitecontactname" value="" /></td>
      <td>&nbsp;</td>
    </tr>

    <tr>  
      <td><label for="sitecontacttitle">Site Contact Title</label></td>
      <td><input type="text" class="validate[required,custom[sitecontacttitle]]" name="sitecontacttitle" id="sitecontacttitle" value="" /></td>
      <td>&nbsp;</td>
    </tr>

    <tr> 
      <td><label for="sitecontactemail">Site Contact Email</label></td>
      <td><input type="text" class="validate[required,custom[sitecontactemail]]" name="sitecontactemail" id="sitecontactemail" value="" /></td>
      <td>&nbsp;</td>
    </tr>

    <tr>  
      <td><label for="sitecontacttelephonenumber">Site Contact Telephone Number</label></td>
      <td><input type="text" class="validate[required,custom[sitecontacttelephonenumber]]" name="sitecontacttelephonenumber" id="sitecontacttelephonenumber" value="" /></td>
      <td>&nbsp;</td>
    </tr>
   </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:42:39.577

感谢您的帮助。我能够在另一个站点上找到一些代码，这些代码使我得到了更好的解决方案。

# wso2 - 从 WSO2 RESTClient 获取不正确的访问令牌类型

> ID：14242672
> 
> 赞同：0
> 
> 时间：2013-01-09T17:12:55.443
> 
> 标签：wso2, wso2-am

我正在评估 WSO2 API Manager 1.3.0 并将其部署在 Linux 服务器上。我发布了一个 API，然后作为客户端用户，我订阅了该 API 并为它生成了生产密钥。

```
 Access Token       EnhC3kxAf6hL68pqMSr2gYwK950a
 Consumer Key       TyEqcYa4hytVPhpiQqRWVNiVIZ0a
 Consumer Secret    7VC9z347ZIzf_K_15rjsGyXcRIYa 
```

当我尝试通过 RESTClient 访问 API 并根据[http://docs.wso2.org/wiki/display/AM130/Subscribing+to+an+API](http://docs.wso2.org/wiki/display/AM130/Subscribing+to+an+API)和[http://docs.wso2传递访问令牌进行身份验证时.org/wiki/display/AM120/Testing+an+API](http://docs.wso2.org/wiki/display/AM120/Testing+an+API)：

```
Authorization:Bearer EnhC3kxAf6hL68pqMSr2gYwK950a 
```

我收到一个错误

```
<ams:fault xmlns:ams="http://wso2.org/apimanager/security">
  <ams:code>900905</ams:code>
  <ams:message>Incorrect Access Token Type is provided</ams:message>
  <ams:description>Access failure for API: /test, version: 1 with key: EnhC3kxAf6hL68pqMSr2gYwK950a</ams:description>
</ams:fault> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T11:42:53.263

从发布者应用程序创建 API 时，最后一个输入字段部分是输入“API 资源”详细信息。您可以为每个 url 模式的每个资源动词设置不同的三种授权级别：

1.None-调用特定API不需要授权标头

2.Application-Application Access Token[应用商店中每个应用生成的访问令牌]调用API所需

3.应用程序用户-调用API所需的最终用户访问令牌[可以通过使用在商店中每个应用程序生成的消费者密钥/秘密从loginAPI生成]

如果您要尝试调用特定的 API 资源 url，首先您需要确保您尝试使用正确的授权方案。例如，如果您将访问 API 资源动词授权方案设置为“应用程序用户”并且如果您尝试使用应用程序访问令牌调用该资源动词，将引发类似的错误。

根据您给定的信息，您已尝试使用带有应用程序访问令牌的 API。您是否可以通过转到 Publisher app->Browse the related API->Navigate to edit API page 仔细检查您是否已将访问资源 url 方法的身份验证方案设置为“应用程序”。?

谢谢;

/拉拉吉

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T04:47:05.960

我遇到了这个问题 - 生产 url 配置为[http://xxx.xxx.xx.xx/services/rest/entity.json/search](http://xxx.xxx.xx.xx/services/rest/entity.json/search)与上下文 /search，URL 前缀为 search/1.0.0 和 URL 模式作为 /*。- 在 REST 客户端上执行 /search/1.0.0/abc 时，我遇到了同样的错误。

该错误已在将生产 URL 设置为[http://xxx.xxx.xx.xx/services/rest](http://xxx.xxx.xx.xx/services/rest)并将上下文设置为 /search 时得到修复。添加 API 资源时，将 URL 前缀设置为 /search/1.0.0，将 URL 模式设置为 /entity.json/search/*。

# c#-4.0 - Outlook 加载项：获取所选会议的与会者电子邮件地址

> ID：14242675
> 
> 赞同：1
> 
> 时间：2013-01-09T17:13:06.693
> 
> 标签：c#-4.0, outlook, outlook-addin, appointment

我正在开发一个小型 Outlook 插件，它将获取有关选定会议的所有信息并将这些信息推送到我们的内部门户。除了RequiredAttendees 部分外，实施已完成。不知道为什么，但**Interop.Outlook.AppointmentItem**对象只返回与会者的全名（作为字符串）。我对他们的与会者电子邮件地址更感兴趣。这是我复制问题的代码片段：

```
try
{
    AppointmentItem appointment = null;
    for (int i = 1; i < Globals.ThisAddIn.Application.ActiveExplorer().Selection.Count + 1; i++)
    {
        Object currentSelected = Globals.ThisAddIn.Application.ActiveExplorer().Selection[i];
        if (currentSelected is AppointmentItem)
        {
            appointment = currentSelected as AppointmentItem;
        }
    }

    // I am only getting attendees full name here
    string requiredAttendees = appointment.RequiredAttendees;

}
catch (System.Exception ex)
{
    LogException(ex);
} 
```

**我可以看到 RequiredAttendees 属性在Microsoft.Office.Interop.Outlook._AppointmentItem**接口中定义为字符串。

```
//
// Summary:
//     Returns a semicolon-delimited String (string in C#) of required attendee
//     names for the meeting appointment. Read/write.
[DispId(3588)]
string RequiredAttendees { get; set; } 
```

如果有人可以帮助我解决此问题或提供一些帮助以获取与会者的电子邮件地址，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T05:04:19.697

像这样的东西（未经测试）：

```
// Recipients are not zero indexed, start with one

for (int i = 1; i < appointment.Recipients.Count - 1; i++)
{
    string email = GetEmailAddressOfAttendee(appointment.Recipients[i]);
}

// Returns the SMTP email address of an attendee. NULL if not found.
function GetEmailAddressOfAttendee(Recipient TheRecipient)
{

    // See http://msdn.microsoft.com/en-us/library/cc513843%28v=office.12%29.aspx#AddressBooksAndRecipients_TheRecipientsCollection
    // for more info

    string PROPERTY_TAG_SMTP_ADDRESS = @"http://schemas.microsoft.com/mapi/proptag/0x39FE001E";

    if (TheRecipient.Type == (int)Outlook.OlMailRecipientType.olTo)
    {
        PropertyAccessor pa = TheRecipient.PropertyAccessor;
        return pa.GetProperty(PROPERTY_TAG_SMTP_ADDRESS);
    }
    return null;
} 
```

# html - HTML5：iPhone4的硬件加速比4s弱很多吗？

> ID：14242679
> 
> 赞同：0
> 
> 时间：2013-01-09T17:13:13.257
> 
> 标签：html, css, iphone-4, hardware-acceleration

我创建了一个 HTML5 Web 应用程序，它通过 CSS3 属性使用硬件加速`translateZ(0)`。

在我的 4s 上，每个作品都非常顺利。

当我在 iPhone4 上测试相同的东西时，性能会大大下降。几乎无法使用。

是否有某种奇特的技巧可以为 iPhone4 启用硬件加速？还是它的 GPU 就那么弱？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T09:16:37.680

结果表明我一直在以错误的方式进行硬件加速转换，请参阅：

[在移动设备上提高 CSS3 过渡性能的“黄金法则”是什么？](https://stackoverflow.com/questions/14277206/what-are-the-golden-rules-to-increase-css3-transition-performance-on-mobile-de)

使用`translate3d(x, y, z)`而不是`translateZ(0)`with`left:x`对我有用。现在即使在较旧的 iPhone 上，所有转换都运行得非常顺利。

# c++ - 套接字，理解 IN_ADDR 中的 S_un

> ID：14242681
> 
> 赞同：2
> 
> 时间：2013-01-09T17:13:24.933
> 
> 标签：c++, sockets

我试图了解[IN_ADDR](http://msdn.microsoft.com/en-us/library/windows/desktop/ms738571%28v=vs.85%29.aspx)中的 S_un 。这是我的 IP 为 127.0.0.1 时的输出：

![输出](../Images/af0dd75794f19ebe1777249810379ab1.png)

有关类型的信息：

```
S_un_b
An IPv4 address formatted as four u_chars.
S_un_w
An IPv4 address formatted as two u_shorts.
S_addr
An IPv4 address formatted as a u_long. 
```

我不明白 S_un_w 和 S_addr 是如何构建的。S_un_b 是逻辑，我的 IP 地址中的每个八位字节都转换为无符号字符。但是 2 条未签名的短裤和未签名的长版如何？还是他们只是在这些变量中复制了 127001 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:16:18.613

它只是一个联合，因此它以三种不同的表示形式显示相同的数据。另一种看待它的方法是将 4 字节整数 (S_addr) 视为十六进制值（并记住 0x7f = 127）：

```
16777343 = 0x100007F  ==> 01 | 00 | 00 | 7f 
```

它是小端格式。

# android - 如何在 Android 中将字符串转换为 JSON 对象

> ID：14242683
> 
> 赞同：0
> 
> 时间：2013-01-09T17:13:31.397
> 
> 标签：android, json

我正在通过这样的 PHP 在服务器上创建 JSON（如果我创建的 JSON 错误，请告诉我如何才能使它正确）。现在我想在 Android 上将此字符串转换为 JSON 对象。

```
{
 "account[0]":{"0":"http:\/\/twitter.com\/OGTedBerg"},
 "image[0]":{"0":"http:\/\/a0.twimg.com\/profile_images\/2821392281\/59f4fe1cbb44c8812401192a199b4b04_normal.jpeg"},
 "name[0]":"Ted Berg",
 "tweet[0]":"I know the flavor I most closely associate with the <em>United<\/em> <em>States<\/em> is Cheesy Paprika.  <a target=\"_blank\" href=\"http:\/\/t.co\/5On9CQuV\">http:\/\/t.co\/5On9CQuV<\/a>",
 "time[0]":"1 minute ago"
 }

 {
  "account[1]":{"0":"http:\/\/twitter.com\/sirgarrick45"},
  "image[1]":{"0":"http:\/\/a0.twimg.com\/profile_images\/3071585947\/207a70fcc09749a1359287a204db1c0b_normal.jpeg"},
  "name[1]":"Mike Green",
  "tweet[1]":"RT @<a class=\" \" href=\"https:\/\/twitter.com\/RussellVogt\">RussellVogt<\/a>: <a target=\"_blank\" href=\"http:\/\/search.twitter.com\/search?q=%23NDAA\" title=\"#NDAA\" class=\" \">#NDAA<\/a> <em>United<\/em> <em>States<\/em> of America Check it out!!   <a target=\"_blank\" href=\"http:\/\/t.co\/KxRx3fMH\">http:\/\/t.co\/KxRx3fMH<\/a>",
  "time[1]":"1 minute ago"
 }

 {
  "account[2]":{"0":"http:\/\/twitter.com\/Gabriel_Enrike"},
  "image[2]":{"0":"http:\/\/a0.twimg.com\/profile_images\/2921364087\/282fec08788f1d96eb0d1167a2639a69_normal.jpeg"},
  "name[2]":"GabrielEnrique",
  "tweet[2]":"@<a class=\" \" href=\"https:\/\/twitter.com\/BarackObama\">BarackObama<\/a> will oath to his second term as president from the <em>United<\/em> <em>States<\/em> on Martin Lutker King jr. day! <a target=\"_blank\" href=\"http:\/\/search.twitter.com\/search?q=%23HeHadADream\" title=\"#HeHadADream\" class=\" \">#HeHadADream<\/a> <a target=\"_blank\" href=\"http:\/\/search.twitter.com\/search?q=%23TeamBO\" title=\"#TeamBO\" class=\" \">#TeamBO<\/a> <a target=\"_blank\" href=\"http:\/\/search.twitter.com\/search?q=%23YesWeCan\" title=\"#YesWeCan\" class=\" \">#YesWeCan<\/a>",
  "time[2]":"1 minute ago"
 }

  {
   "account[3]":{"0":"http:\/\/twitter.com\/Davis_T94"},
   "image[3]":{"0":"http:\/\/a0.twimg.com\/profile_images\/2627985413\/image_normal.jpg"},
   "name[3]":"tim davis",
   "tweet[3]":"RT @<a class=\" \" href=\"https:\/\/twitter.com\/FactBoook\">FactBoook<\/a>: The <em>United<\/em> <em>States<\/em> once captured Mexico City.",
   "time[3]":"1 minute ago"
  } 
```

这是我用来将字符串转换为 JSON 对象的 Java 代码。

```
 private String[] acnt;
private String[] img;
private String[] nam;
private String[] twt;
private String[] tim;

 JSONObject obj = null;
        // creating response string to jsonobject and getting required values 
        try {
            obj = new JSONObject(twitter_response);

            int lenght = obj.length();
            acnt = new String[lenght];
            img = new String[lenght];
            nam = new String[lenght];
            twt = new String[lenght];
            tim = new String[lenght];
            //obj.getJSONArray(twitter_response);
            for ( $i = 0; $i < lenght; $i++ )
            {
                acnt[$i] = new String(obj.getString("account[" + $i + "]"));
                img[$i] = new String(obj.getString("image[" + $i + "]"));
                nam[$i] = new String(obj.getString("name[" + $i + "]"));
                twt[$i] = new String(obj.getString("tweet[" + $i + "]"));
                tim[$i] = new String(obj.getString("time[" + $i + "]"));
            }
        } catch (JSONException e) {
            Log.e("log_tag", "Error receiving tweet "+ e.toString());
            e.printStackTrace();
        } 
```

有了这个，我只得到第一个值；知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:19:39.493

您的输入不是有效的 JSON。JSON 数组使用 pattern `[ { element }, { element }, { element } ...]`，而不是您正在使用的括号语法。

[这是一个](https://stackoverflow.com/questions/431494/json-syntax-transmitting-an-array)关于如何在 JSON 中格式化数组的相关问题，这里是关于 JSON 语法[的一些精确文档。](http://www.json.org/fatfree.html)

编辑：我会说您发布的 JSON 示例非常接近有效（实际上，每个单独的块本身都是有效的，如果您尝试按原样解析整个集合，它只是无效）。也就是说，我仍然认为将数据格式化为更传统的 JSON 数组结构可能更有意义，例如：

```
[
  {
    "account":{"0":"http:\/\/twitter.com\/OGTedBerg"},
    "image":{"0":"http:\/\/a0.twimg.com\/profile_images\/2821392281\/59f4fe1cbb44c8812401192a199b4b04_normal.jpeg"},
    "name":"Ted Berg",
    "tweet":"I know the flavor I most closely associate with the <em>United<\/em> <em>States<\/em> is Cheesy Paprika.  <a target=\"_blank\" href=\"http:\/\/t.co\/5On9CQuV\">http:\/\/t.co\/5On9CQuV<\/a>",
    "time":"1 minute ago"
  },
  ...
] 
```

这可能会使解析过程变得相当简单。

# c++ - 字符串作为模板参数

> ID：14242694
> 
> 赞同：4
> 
> 时间：2013-01-09T17:14:08.363
> 
> 标签：c++

虽然 C++ 标准不允许使用字符串文字作为模板参数，但允许使用以下内容：

**ISO/IEC 14882:2011**

> 14.3.2 模板非类型参数 [temp.arg.nontype]
> 
> 2 [注意：字符串文字（2.14.5）不满足任何这些类别的要求，因此不是可接受的模板参数。[ 例子：
> 
> `template<class T, const char* p> class X { / ... / };`
> 
> `X<int, "Studebaker"> x1; // error: string literal as template-argument`
> 
> `const char p[] = "Vivisectionist";`
> `X<int,p> x2; // OK`
> 
> —结束示例] —结束说明]

那么为什么下面的代码在所有编译器（gcc 4.7.2、MSVC-11.0、Comeau）中都给我一个错误？

```
template <const char* str>
void foo() {}

int main()
{
   const char str[] = "str";
   foo<str>();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:28:27.413

倒回几行。

14.3.2/1：一个常量表达式（5.19），它指定一个具有*静态存储持续时间*和外部或内部链接的对象的地址。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T17:28:51.280

请注意，以下修改有效：

```
template <const char* str>
void foo() {}

char str[] = "str";

int main() {
    foo<str>();
} 
```

有关简短说明，请参阅[http://www.comeaucomputing.com/techtalk/templates/#stringliteral](http://www.comeaucomputing.com/techtalk/templates/#stringliteral)。

# windows - 获取 Windows LAN 上本地静态文件的完全限定 URL

> ID：14242695
> 
> 赞同：0
> 
> 时间：2013-01-09T17:14:08.857
> 
> 标签：windows, networking, filesystems, hyperlink

我正在开发一个企业社交书签工具（主要针对 Windows 用户）。用户可以使用此工具为本地链接添加书签，包括网络驱动器上的链接，例如：

```
//SERVER//something/file.doc 
```

或者是本地的，但仍然可以通过网络访问（如果本地设置允许）

```
//MYNAME_MYMACHINE/Desktop/file.doc 
```

我想确保当有人为这样的链接添加书签时：

```
c:/Desktop/file.doc 
```

..我实际上可以确定 C: 参考是什么（因为它可能只是一个已安装的驱动器）。实际上 - 如果他们在本地安装了该字母下的驱动器，则此参考仅对本地人有意义。如果其他人试图单击以访问该资源，它将不起作用。

我的问题是 - 我如何（使用任何方式） - 查询本地文件引用并将完全限定的网络路径解析为任何用户提供的链接？我想提取一个链接的“最完全合格的版本”，以最大限度地提高它被 AD/LAN 成员的其他人点击的机会。例如，这使用户不必担心共享文件共享链接的“完全合格”意味着什么。

*进一步 - 在 Windows 的右键菜单中使用它*

上面的第一部分确定资源的最完全合格的网络可访问地址。然后，我想构建一个右键单击按钮，以便当有人在 Windows 资源管理器中右键单击文件时 - 他们会看到一个名为*Bookmark & Share this File*的选项。当他们单击时 - 发生上述解决方案并且该文件的链接保存在服务器上。这需要经历的过程很简单——它是一个应用程序的 JSON/XML 端点的帖子，它保存您要保存的资源的 URL。我什至如何开始为各种流行的 Windows 版本执行此操作？这是否称为“外壳扩展”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:28:41.873

查看以下资源：

1.  [从本地路径或映射路径获取 UNC 路径](https://stackoverflow.com/questions/1411606/get-unc-path-from-a-local-path-or-mapped-path)
2.  [http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/a45da6f3-aa74-46e2-8e7b-a54562cd2b5e](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/a45da6f3-aa74-46e2-8e7b-a54562cd2b5e)

# php - 简单派 1.3 保留原始 pubDate？

> ID：14242697
> 
> 赞同：0
> 
> 时间：2013-01-09T17:14:15.290
> 
> 标签：php, simplepie

我将 Simple Pie 1.3 用于简单的新闻流。

有时，像 ESPN 这样的网站会不断更新故事。这会更改 pubDate 并将它们推送到我的提要顶部。

无论如何要检查故事链接是否已经存在于缓存中？

这样我就可以忽略它并保留故事的原始 pubDate。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T02:37:17.800

经过艰苦的搜索，结果发现答案就在我的眼皮底下：

[http://simplepie.org/wiki/tutorial/how_to_display_previous_feed_items_like_google_reader](http://simplepie.org/wiki/tutorial/how_to_display_previous_feed_items_like_google_reader)

只需要根据数据库存储/检查条目。

对任何有同样问题的人都有好处。

享受。

# c# - 未调用 DropCreateDatabaseAlways 种子

> ID：14242699
> 
> 赞同：11
> 
> 时间：2013-01-09T17:14:20.893
> 
> 标签：c#, .net, asp.net-mvc, entity-framework

我在自定义数据库初始化程序上调用 Seed 方法时遇到问题。我正在使用 EF 5.0 并具有以下代码：

```
public static class MyDatabase
{
    public static void Initialize()
    {
        Database.SetInitializer(new MyInitializer());
    }
}

public class MyInitializer : DropCreateDatabaseAlways<MyContext>
{
    protected override void Seed(MyContext context)
    {
        base.Seed(context);
        context.Roles.Add(new Role
        {
            ID = 1,
            Name = "User",
        });
        context.Roles.Add(new Role
        {
            ID = 2,
            Name = "Admin",
        });
        context.SaveChanges();
    }
} 
```

这两个类存在于与 MVC 应用程序不同的类库中。在 中`Global.asax`，我调用该`Initialize()`方法：

```
MyDatabase.Initialize(); 
```

数据库创建得很好，只是`Seed(MyContext context)`没有调用方法，也没有数据进入我的数据库。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-11T21:48:56.393

您的数据库将在稍后使用上下文时创建，或者您始终可以通过在 Global.asax.cs 的 Application_Start() 方法中使用上下文来强制它创建，例如：

```
 System.Data.Entity.Database.SetInitializer(new MyInitializer());
MyContext db = new MyContext();
db.Database.Initialize(true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-06T20:02:28.817

在我的情况下，没有调用 Seed 因为我启用了迁移。当我删除迁移时，它起作用了。[http://entityframework.codeplex.com/workitem/1689](http://entityframework.codeplex.com/workitem/1689)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:23:23.943

`Seed`一旦您将第一个 SQL 查询发送到您的数据库，而不是在您的`Application_Start`. 例如：

```
using (var ctx = new MyContext())
{
    var rolesCount = ctx.Roles.Count(); // should return 2
} 
```

# validation - Github - Travis-CI 验证失败 - 工作站更改

> ID：14242702
> 
> 赞同：1
> 
> 时间：2013-01-09T17:14:32.260
> 
> 标签：validation, github, lua, worker, travis-ci

我实际上面临着一些奇怪的问题。我正在维护我的一些 Lua 项目，托管在 Github。我最近发现使用 Travis-CI 验证服务实现 Lua 测试是相当可能的。它只包括编写测试规范，使用单元测试库（我正在使用[Telescope](http://norman.github.com/telescope/)）运行，然后愚弄 Travis 工人，假装 Erlang。

例如，我已成功将 Travis 包含在此项目中：请参阅此处的[30log](https://github.com/Yonaba/30log) - [Travis YAML](https://github.com/Yonaba/30log/blob/master/.travis.yml)文件。

我想指出，我在我的工作站（在 Windows 7 x86 下运行）上使用 GNU-bash (v1.7.10) 提交，然后推送远程存储库。

一切都很顺利。直到我切换到新的工作站（Windows 7、x64）。我基本上安装了 Gnu-Bash，然后我只是从以前的工作站复制粘贴了一些文件（即包含 rsa_pub 密钥的**.ssh文件夹、** **.bash_history**文件、全局**.gitconfig**文件和**包含我所有正在进行的项目的文件夹源**）在新的工作站上。我做了一些提交，我成功地推动了它们。但是现在来自 Travis-CI 的任何构建测试都失败了，工作人员报告说找不到某些文件。这是[来自 Travis-CI 的日志报告](https://travis-ci.org/Yonaba/30log)，例如：

> 使用工人：bluebox-jvm-otp.worker.travis-ci.org:travis-jvm-
> 10 $ cd ~/builds
> $ export LUA=""
> $ git clone --branch=master --depth=100 --quiet
> git ://github.com/Yonaba/30log.git Yonaba/30log
> $ cd Yonaba/30log
> $ git checkout -qf 0b60646339e65df0f79ce66b6a76c9b825ba5032
> $ source ~/otp/R14B04/activate
> -bash: /home/travis/otp/R14B04/activate: 否这样的文件或目录
> 完成。构建脚本退出：1

问题**当然与代码本身无关**，因为**规范测试都通过了**，在我的工作站上本地使用测试套件（Telescope）运行它们。似乎 travis 的工作人员未能找到一些关键文件来正确处理新提交，然后报告失败。

关于发生了什么以及如何解决该问题的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T20:47:57.297

其实，我有点解决了。我只需要在我的新工作站上重新生成我的 ssh 凭据（密钥），然后在我的 Github 帐户上注册它们。然后，在进一步提交之后，所有构建都通过 Travis 的 Erlang worker 成功通过。谢谢大家。

# asp.net - 渲染一个 具有空操作属性（或根本没有）

> ID：14242705
> 
> 赞同：2
> 
> 时间：2013-01-09T17:14:42.537
> 
> 标签：asp.net, .net, iis-7, asp.net-3.5, windows-server-2008-r2

使用以下代码：

```
<form id="form1" action="" runat="server"> 
```

（即使在页面加载中使用此代码隐藏`form1.Action = string.Empty;`：）

...这是我得到的意外结果：

```
<form method="post" id="form1" name="form1" action="layouts/Default.aspx"> 
```

这是预期的结果，我希望您能帮助完成：

```
<!-- either action="" or no action attribute at all -->
<form method="post" id="form1" name="form1" action=""> 
```

AppPool 设置为运行 Integrated .NET v2.0.50727（我已通过打印运行时版本进行了验证）。.NET Framework v4.5 安装在服务器上（与 Visual Studio 2012 一起）。

这肯定是某种开发环境问题，原因是`action=""`我的两个同事在他们的本地环境中输出了相同的代码库。它们在很大程度上具有与我相同的系统环境规范：

*   Windows Server 2008 R2 64 位
*   视觉工作室 2012
*   .NET 框架 v4.5
*   相同的 AppPool 设置（我们已经检查了两次和三次）
*   相同的代码库（SVN 控制），包括完全相同的`web.config`

ASP.NET v3.5 SP1（在 v4.0 中更好地宣布）中的[这一重大变化可能是相关的。](https://stackoverflow.com/questions/2620874/why-is-the-form-action-attribute-empty-on-production-server)它解释了这种行为。但是，它并没有解释为什么只有我的运行时才会获得这种重大变化。

另请注意，我已经使用该`aspnet_regiis`工具尝试了所有可用的命令组合（无济于事），即来自不同的 .NET 版本文件夹以及卸载/重新安装和使用`-c`等`-i`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T11:13:11.577

以下丑陋的解决方法是我迄今为止找到的唯一解决方案。我将表单子类化以删除`override void RenderBeginTag`.

```
[ToolboxData("<{0}:HtmlFormNoAction runat=\"server\"></{0}:HtmlFormNoAction>")]
public class HtmlFormNoAction : HtmlForm
{
    protected override void RenderBeginTag(HtmlTextWriter writer)
    {
        var htmlString = new StringBuilder(); // this will hold the string
        var stringWriter = new StringWriter(htmlString);
        var htmlWriter = new HtmlTextWriter(stringWriter);
        base.RenderBeginTag(htmlWriter);
        htmlWriter.Flush();
        var formBeginTag = htmlString.ToString();
        var formBeginTagWithoutAction = RemoveActionAttribute(formBeginTag);

        writer.Write(formBeginTagWithoutAction);
    }

    private string RemoveActionAttribute(string formBeginTag)
    {
        const string actionStart = "action=\"";
        if (!formBeginTag.Contains(actionStart))
            return formBeginTag;

        var start = formBeginTag.IndexOf(actionStart);
        var end = formBeginTag.IndexOf("\"", start + actionStart.Length);
        return formBeginTag.Substring(0, start) + formBeginTag.Substring(end + 1);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-14T06:05:55.157

检查这个：[https ://msdn.microsoft.com/en-us/library/ms972974.aspx](https://msdn.microsoft.com/en-us/library/ms972974.aspx)

> ```
> namespace ActionlessForm {
>   public class Form : System.Web.UI.HtmlControls.HtmlForm
>   {
>      protected override void RenderAttributes(HtmlTextWriter writer)
>      {
>         writer.WriteAttribute("name", this.Name);
>         base.Attributes.Remove("name");
> 
>         writer.WriteAttribute("method", this.Method);
>         base.Attributes.Remove("method");
> 
>         this.Attributes.Render(writer);
> 
>         base.Attributes.Remove("action");
> 
>         if (base.ID != null)
>            writer.WriteAttribute("id", base.ClientID);
>      }
>   }
> } 
> ```

还有这个： http: [//www.codeproject.com/Articles/19672/A-Smart-Form-Control-for-ASP-NET-URL-Rewriting](http://www.codeproject.com/Articles/19672/A-Smart-Form-Control-for-ASP-NET-URL-Rewriting)

# javascript - 循环遍历 dojox 网格行以查找某些列中的空字段

> ID：14242707
> 
> 赞同：0
> 
> 时间：2013-01-09T17:14:48.357
> 
> 标签：javascript, dojo

我在不同列的网格中有一些 Dojo 单元格，如果为空，我想执行某个操作。我希望仅在用户右键单击时才执行此操作，因此我将其放在 onRowContextMenu() 中。我目前正在获取该行的索引，但不知道如何使用以及是否需要将该行索引用于条件语句。

所以每行我需要检查四个不同的列来检查它是否有一个值。道场大神有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:18:58.667

不确定您拥有的是否是 DataGrid（这就是我使用的）......也许它也适合您。使用网格的 getItem(rowIndex) 方法。

```
var rowItem = grid.getItem(rowIndex); 
```

其中 grid 是 dojox.grid.DataGrid，rowItem 应该返回一个包含每列值的对象。

然后，您可以使用 for-in 在对象的字段中循环：

```
for (var colId in rowItem) {
    var colVal = rowItem[colId];
    if (!colVal || colVal == "") {
        //column is empty
    }
} 
```

# dart - 从字符串实例化一个类

> ID：14242712
> 
> 赞同：10
> 
> 时间：2013-01-09T17:15:04.387
> 
> 标签：dart, dart-mirrors

在 dart 中是否可以从字符串实例化一个类？

例如：

*   javascript中的香草：

```
var myObject = window[classNameString]; 
```

*   目标-C：

```
id myclass = [[NSClassFromString(@"MyClass") alloc] init]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:32:49.303

您需要知道库名称和类名称才能使事情正常工作。假设您都知道，下面的示例将实例化`TestClass`并调用`doStuff`它。

```
library test;

import "dart:mirrors";

class TestClass {
  doStuff() => print("doStuff was called!");
}

main() {
  MirrorSystem mirrors = currentMirrorSystem();
  LibraryMirror lm = mirrors.libraries['test'];
  ClassMirror cm = lm.classes['TestClass'];
  Future tcFuture = cm.newInstance('', []);
  tcFuture.then((InstanceMirror im) {
    var tc = im.reflectee;
    tc.doStuff();
  });
} 
```

关于此解决方案的一些注意事项：

1.  `test`我们试图从中加载类的库已经导入到 VM 中，这使得这种情况更容易一些。
2.  调用`newInstance`允许将参数传递给构造函数。位置参数已实现，但命名参数尚未实现（从 M2 版本开始）。
3.  `newInstance`返回一个[Future](http://api.dartlang.org/docs/bleeding_edge/dart_async/Future.html)以允许它跨[隔离](http://api.dartlang.org/docs/bleeding_edge/dart_isolate.html)工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-10T08:41:37.400

语法已更改。我让它这样工作

```
library test;

import "dart:mirrors";

class TestClass {
  doStuff() => print("doStuff was called!");
}

main() {
  MirrorSystem mirrors = currentMirrorSystem();
  LibraryMirror lm = mirrors.libraries.values.firstWhere(
      (LibraryMirror lm) => lm.qualifiedName == new Symbol('test'));

  ClassMirror cm = lm.declarations[new Symbol('TestClass')];

  InstanceMirror im = cm.newInstance(new Symbol(''), []);
  var tc = im.reflectee;
  tc.doStuff();
} 
```

如果有更多名为“test”的库，这将失败。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-03-25T00:50:19.380

尝试：

```
Map models = {"Player": Player.instatiate};
var player = models["Player"]();

class Player{
  static instatiate() => Player();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-16T12:13:22.953

这是一个一直困扰着我的问题，直到我发现我可以实现一个粗略**的 from**方法来处理*编码的 Json 对象/字符串*或*Dart 映射*到所需类的转换。

下面是一个简单的例子，它也处理空值并接受 JSON（*作为* **字符串** *参数*）

```
import 'dart:convert';

class PaymentDetail
{
  String AccountNumber;
  double Amount;
  int ChargeTypeID;
  String CustomerNames;

  PaymentDetail({
    this.AccountNumber,
    this.Amount,
    this.ChargeTypeID,
    this.CustomerNames
  });

  PaymentDetail from ({ string : String, object : Map  }) {
     var map   = (object==null) ? (string==null) ? Map() : json.decode(string) : (object==null) ? Map() : object;
     return new PaymentDetail(
        AccountNumber             : map["AccountNumber"] as String,
        Amount                    : map["Amount"] as double,
        ChargeTypeID              : map["ChargeTypeID"] as int,
        CustomerNames             : map["CustomerNames"] as String
     );
  }

} 
```

下面是它的实现

```
 PaymentDetail payDetail =  new PaymentDetail().from(object: new Map());

 PaymentDetail otherPayDetail =  new PaymentDetail().from(object: {"AccountNumber": "1234", "Amount": 567.2980908}); 
```

再一次，这在整个项目中克隆是简单而乏味的，但它适用于简单的情况。

# java - Java 示例代码运行时错误

> ID：14242713
> 
> 赞同：0
> 
> 时间：2013-01-09T17:15:13.067
> 
> 标签：java, runtime

这大概是个初级问题。但是，我已经阅读了《Java 绝对初学者编程》的第 12 章，并接触了一些示例代码。尝试编译此示例代码程序时出现编译器错误。我将所有相关程序都放在同一个包中，所以这不是问题。

错误发生在这一行：

```
minefield.addMineFieldListener(this); 
```

它指出：

```
Exception in thread "main" java.lang.RuntimeException: Uncompilable source code 
- Erroneous sym type: MineField.addMineFieldListener at MinePatrol.<init>
(MinePatrol.java:21) 
```

我的主要问题是：为什么会发生这种情况？

非常感谢您在此问题上的时间和合作。

这是 MinePatrol.java 的代码：

```
import java.awt.*;
import java.awt.event.*;
import java.applet.Applet;
import java.net.URL;
import java.net.MalformedURLException;

public class MinePatrol extends GUIFrame
                    implements MineFieldListener, ActionListener {
protected MineField minefield;
protected Button resetButton;
protected Label flagCountLabel;

public MinePatrol() {
super("MinePatrol");
minefield = new MineField(10, 10, 10);
minefield.addMineFieldListener(this);
add(minefield, BorderLayout.CENTER);
MediaTracker mt = new MediaTracker(this);
Image[] imgs = {
  Toolkit.getDefaultToolkit().getImage("flag.gif"),
  Toolkit.getDefaultToolkit().getImage("mine.gif"),
  Toolkit.getDefaultToolkit().getImage("explode.gif") };

for (int i=0; i < imgs.length; i++) {
  mt.addImage(imgs[i], i);
}
try {
  mt.waitForAll();
} catch (InterruptedException e) {}
minefield.setImages(imgs[0], imgs[1], imgs[2]);
try {
  minefield.setAudioClips(
    Applet.newAudioClip(new URL("file:reveal.wav")),
    Applet.newAudioClip(new URL("file:flag.wav")),
    Applet.newAudioClip(new URL("file:unflag.wav")),
    Applet.newAudioClip(new URL("file:explode.wav")));
} catch (MalformedURLException e) {}

flagCountLabel = new Label("Flags: 10", Label.CENTER);
add(flagCountLabel, BorderLayout.NORTH);
resetButton = new Button("Reset");
resetButton.addActionListener(this);
add(resetButton, BorderLayout.SOUTH);
pack();
setVisible(true);
  }

public static void main(String args[]) {
new MinePatrol();
}

public void mineFieldSolved(MineFieldEvent e) {
flagCountLabel.setText("You Win!");
}

 public void mineFieldRandomized(MineFieldEvent e) {
 flagCountLabel.setText("Flags: " + minefield.getMineCount());
}

 public void mineFieldDetonated(MineFieldEvent e) {
 flagCountLabel.setText("You exploded into tiny bits... RIP");
}

 public void mineFieldFlagCountChanged(MineFieldEvent e) {
 flagCountLabel.setText("Flags: "
  + (minefield.getMineCount() - minefield.getFlagCount()));
 }

 public void actionPerformed(ActionEvent e) {
  minefield.randomize();
  }

 } 
```

这是 MineField.java 的代码

```
import java.awt.*;
import java.util.*;
import java.applet.AudioClip;

public class MineField extends Panel 
                    implements MineCellListener {
protected int rows, cols, mines, flagged, revealed;
protected AudioClip  revealClip, flagClip, unflagClip, explodeClip;
protected MineCell[][] cells;
//keeps track of MineCell indices
protected Hashtable pointIndex;
protected Vector listeners;

   public MineField(int nRows, int nCols, int nMines) {
   rows = nRows > 0 ? nRows : 1;
   cols = nCols > 0 ? nCols : 1;
   cells = new MineCell[rows][cols];
   mines = nMines >= 0 && nMines < rows * cols ? nMines : 1;
   pointIndex = new Hashtable(rows * cols);
   setLayout(new GridLayout(rows, cols));
   for (int r=0; r < cells.length; r++) {
       for (int c=0; c < cells[r].length; c++) {
           cells[r][c] = new MineCell();
           cells[r][c].addMineCellListener(this);
           //Points use (x, y) coordinates to x=c and y=r
           pointIndex.put(cells[r][c], new Point(c, r));
           cells[r][c].setSize(25, 25);
           add(cells[r][c]); 
       }
       }
   listeners = new Vector();
   randomizeField(false);
   }

   protected void randomizeField(boolean fireEvent) {
       Random rand = new Random();
       int index;
   //initialize empty
   for (int r=0; r < cells.length; r++) {
       for (int c=0; c < cells[r].length; c++) {
           cells[r][c].resetContents(MineCell.EMPTY);
       }
   }
   //randomly place all mines
   for (int m=0; m < mines; m++) {
      do {
          index = rand.nextInt(rows * cols);
      }
      while (cells[index / cols][index % cols].getContents() != MineCell.EMPTY);
      cells[index / cols][index % cols].resetContents(MineCell.MINE);
   }
   setNumberClues();
   flagged = revealed = 0;
   //does not fire flagCountChanged, only mineFieldRandomized
   if (fireEvent) (new EventThread(new MineFieldEvent(this,
                                MineFieldEvent.RANDOMIZED))).start();
   }

    public void randomize() {
     randomField(true);
    }

    public int getFlagCount() {
    return flagged;
    }

   public int getMineCount() {
       return mines;
   }

  //counts and sets the number of mines surrounding each cell
   protected void setNumberClues() {
   int nMines;
   for (int r=0; r < cells.length; r++) {
       for (int c=0; c < cells[r].length; c++) {
           if (cells[r][c].getContents() != MineCell.MINE) {
               nMines = 0;
               //count the number of mines surrounding this cell
               for (int dr = r - 1; dr <= r + 1; dr++) {
                   //prevent ArrayIndexOutOfBoundsException
                   //continue puts control back to the beginning of the loop
                   if (dr < 0 || dr >= cells.length) continue;
                   for (int dc = c -1; dc <= c + 1; dc++) {
                       if (dc < 0 || dc >= cells[dr].length) continue;
                       if (cells[dr][dc].getContents() == MineCell.MINE) nMines++;
                   }
               }
               cells[r][c].resetContents(nMines);
               }
           }
       }
   }

     public class MineFieldEvent extends java.util.EventObject {
protected int eventID;
//event id constants
public final static int SOLVED = 0,
                            RANDOMIZED = 1,
                            DETONATED = 2,
                            FLAG_COUNT_CHANGED = 3;

    public MineFieldEvent(Object source, int id) {
    super(source);
    eventID = id;
    }

    public int getID() {
        return eventID;
        }
    }
   protected class EventThread extends Thread {
   MineFieldEvent e;
   EventThread(MineFieldEvent mfe) {
       e = mfe;
   }
      public void addMineFieldListener(MineFieldListener mfl) {
   listeners.addElement(mfl);
   }

   public void removeMineFieldListener(MineFieldListener mfl) {
       listeners.removeElement(mfl);
   }

   public void run() {
    switch(e.getID()) {
case MineFieldEvent.SOLVED:
for (int i=0; i < listeners.size(); i++) {
((MineFieldListener)listeners.elementAt(i)).mineFieldSolved(e);
}
break;
case MineFieldEvent.RANDOMIZED:
for (int i=0; i < listeners.size(); i++) {
((MineFieldListener)listeners.elementAt(i)).mineFieldRandomized(e);
}
break;
case MineFieldEvent.DETONATED:
for (int i=0; i < listeners.size(); i++) {
((MineFieldListener)listeners.elementAt(i)).mineFieldDetonated(e);
}
break;
case MineFieldEvent.FLAG_COUNT_CHANGED:
for (int i=0; i < listeners.size(); i++) {
((MineFieldListener)listeners.elementAt(i)).mineFieldFlagCountChanged(e);
}
break;
}
}
}

   public void setImages(Image f, Image m, Image e) {
   MineCell.setImages(f, m, e);
   }

   public void setAudioClips(AudioClip r, AudioClip f, AudioClip u,
                            AudioClip e) {
   revealClip = r; flagClip = f; unflagClip = u; explodeClip = e;
   }

   /* Reveals areas mine-free minecells */
    protected void showSafeArea(MineCell start) {
   //get the point index for the starting cell
   Point p = (Point)pointIndex.get(start);
   for (int r = p.y - 1; r <= p.y + 1; r++) {
       if (r < 0 || r >= cells.length) continue;
       for (int c = p.x - 1; c <= p.x + 1; c++) {
           if (c < 0 || c >= cells[r].length || !cells[r][c].isHidden())
               continue;
           if (cells[r][c].isFlagged()) {
               flagged--;

              (new EventThread(new MineFieldEvent(this, 
                                    MineFieldEvent.FLAG_COUNT_CHANGED))).start();
           }
           cells[r][c].setHidden(false);
           revealed++;
           if(cells[r][c].getContents() == MineCell.EMPTY)
               showSafeArea(cells[r][c]);
            }
       }
   }

   protected void checkIfSolved() {
       if (flagged + revealed == rows * cols) {
       //solved if we get here.
       revealAll();
       (new EventThread(new MineFieldEvent(this,
                                MineFieldEvent.SOLVED))).start();
       }
    }

   public void revealAll() {
       for (int r=0; r < cells.length; r++) {
           for (int c =0; c < cells.length; c++) {
           cells[r][c].setHidden(false);
           }
       }
   }

    public void mineCellRevealed(MineCellEvent e) {
        if (revealClip != null) revealClip.play();
       revealed++;
       if ((MineCell)e.getSource()).getContents() == MineCell.EMPTY)
        showSafeArea((MineCell)e.getSource());
        checkIfSolved();
   }

    public void mineCellDetonated(MineCellEvent e) {
   //game over show all
   if (explodeClip != null) explodeClip.play();
   revealAll();
   (new EventThread(new MineFieldEvent(this, 
                           MineFieldEvent.DETONATED))).start();
    }

    public void mineCellFlagged(MineCellEvent e) {
         if (flagged >= mines) {
          ((MineCell)e.getSource()).getHidden(true);
          return;
   }
   if (flagClip != null) flagClip.play();
   flagged++;
   (new EventThread(new MineFieldEvent(this,
                            MineFieldEvent.FLAG_COUNT_CHANGED))).start();
   checkIfSolved();
   }

   public void mineCellUnflagged(MineCellEvent e) {
   if (unflagClip != null) unflagClip.play();
   flagged--;
   (new EventThread(new MineFieldEvent(this, 
                             MineFieldEvent.FLAG_COUNT_CHANGED))).start();
   }

                   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:37:00.540

这可能是[NetBeans 错误 199293](http://netbeans.org/bugzilla/show_bug.cgi?id=199293)。它现在已修复，但尚未过时。如果您使用 NetBeans，请检查您是否需要更新。错误消息*Uncompilable source code - Erroneous sym type matches*并且我在您的代码中看不到任何导致错误消息如此明智的内容。尝试使用 Eclipse 或 Ant 构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:30:39.280

minefield.addMineFieldListener(this); 你想用“这个”做什么？

# iphone - 将 UIView 旋转超过 360 度并降低速度

> ID：14242716
> 
> 赞同：2
> 
> 时间：2013-01-09T17:15:29.080
> 
> 标签：iphone, ios, objective-c, core-animation, calayer

我有一个 UIView，我想在给定的 T 时间内围绕它的中心点旋转 N 次。**并且旋转的速度应该逐渐降低。（像一个旋转轮）**。我有下面的代码，它不能正常工作。

```
 float T = 5; // 5 seconds
   float rotations = 10;
   //_containerView is the view to be rotate

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:T];
    [UIView setAnimationRepeatCount:0];
    [UIView setAnimationDelegate:self];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
    CGAffineTransform t = CGAffineTransformRotate(_containerView.transform, (2*M_PI*rotations + 0));
    _containerView.transform = t;
    [UIView commitAnimations]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:31:10.710

```
#define StartAnimation(duration) [UIView beginAnimations:nil context:NULL];    \
[UIView setAnimationDuration:duration];       \
[UIView setAnimationRepeatAutoreverses:NO];   \
[UIView setAnimationRepeatCount:0]

#define StopAnimation [UIView commitAnimations] 
```

定义这些宏并使用

```
StartAnimation(<time>)
//your code
StopAnimation 
```

# c# - 同时为自托管 wcf 服务和 IIS 使用端口 443

> ID：14242717
> 
> 赞同：4
> 
> 时间：2013-01-09T17:15:30.137
> 
> 标签：c#, wcf, iis, ssl

我有一个自托管的 WCF 服务和一个需要在同一台机器上运行的 ASP .Net 网站。我发现，当自托管服务运行时，所有对 IIS 的端口 443 的调用（基于 IP 和主机标头/SSL 绑定）都被路由到 WCF 架构，因此只要自托管网站就会停止工作托管服务正在运行。它有效地抢占了 IIS 完成其工作的能力。

请注意，IIS 在其他端口上仍然可以正常工作，例如端口 80。它只是在端口 443 上过于急切。不完全确定这是服务器问题还是代码/wcf 问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T05:41:26.997

经过相当多的研究，我能够确定其中一个服务端点，一个设置为模拟 crossdomain.xml 文件的 REST 端点正在抢占 IIS。否则一切都按预期工作。我放弃了那个端点并使用 IIS 来提供文件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-09T17:22:27.477

正如您所怀疑的那样，听起来好像自托管服务正在拦截对端口 443 的调用，然后 IIS 才能获取它们。快速检查您的 IIS 日志应该可以确认这是否是正在发生的事情。

请注意，虽然您可以在端口 80 上运行多个域，但如果我没记错的话，您只能在端口 443 上使用一个域，因此主机标头等内容不适用于 HTTPS 连接。这也可能导致您的问题。

有什么方法可以通过 IIS 托管自托管服务？这可能会解决这个问题并减少您将来的管理负担。

编辑以下评论：如果你不能在 IIS 中托管，假设我是正确的 WCF 服务正在拦截 IIS 的请求，这就是阻止流量通过的原因，那么你可能需要添加一些东西到你的WCF 应用程序或创建（或查找现有示例）基于 HttpListener 的传入流量的独立代理，并使用它来识别哪些服务请求正在寻找并适当地中继它。当然，这种类型的代理服务也可用于屏蔽扩展，因此您可以使用它将任何格式的外部 url 中继到适当的内部服务 url。重要的是代理在网络堆栈中位于 WCF 和 IIS 之前，因此它可以在请求被任何一个接收之前拦截请求。如果您正在编写自己的，那么[HttpListener](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)可能是一个很好的起点。

# java - PHP 无法从 Android 接收字符串

> ID：14242718
> 
> 赞同：0
> 
> 时间：2013-01-09T17:15:36.453
> 
> 标签：java, php, android

以下代码尝试将字符串从 Android 发布到 PHP。

*   已授予 INTERNET 权限。
*   鲨鱼已经过检查。
*   设备连接到 MAMP（MAC 的 WAMP）服务器并发送字符串。

安卓上的代码：

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost post = new HttpPost("http://MAMP-SERVER/post.php");

try {
    // Add your data
    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
    nameValuePairs.add(new BasicNameValuePair("username", "Andro"));
    post.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    // Execute HTTP Post Request
    httpclient.execute(post);
    Log.i("POSTED", "YOUR USERNAME");

} catch (ClientProtocolException e) {
    Log.e("Client Protocol Exception", "Err "+ e.getMessage());
} catch (IOException e) {
    Log.e("IO Exception","Err "+ e.getMessage());
} 
```

PHP上的代码：

```
$test=$_REQUEST["username"];  print $_REQUEST["username"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:49:14.367

Are you sure you're actually posting the data?

You could try sending the POST request more like below methods. Then you should be able to simply get your value in the PHP with $_POST

```
public void execute(final RequestMethod method)
        throws IllegalArgumentException, UnsupportedEncodingException {
    switch (method) {
    case GET:
        // add parameters
        String combinedParams = "";
        if (!params.isEmpty()) {
            combinedParams += "?";
            for (NameValuePair p : params) {
                String paramString = p.getName() + "="
                        + URLEncoder.encode(p.getValue(), "UTF-8");

                if (combinedParams.length() > 1) {
                    combinedParams += "&" + paramString;
                } else {
                    combinedParams += paramString;
                }
            }
        }
        HttpGet getRequest = new HttpGet(remoteUrl + combinedParams);
        // add headers
        for (NameValuePair h : headers) {
            getRequest.addHeader(h.getName(), h.getValue());
        }
        executeRequest(getRequest, remoteUrl);
        break;
    case POST:
        HttpPost postRequest = new HttpPost(remoteUrl);
        // add headers
        for (NameValuePair h : headers) {
            postRequest.addHeader(h.getName(), h.getValue());
        }
        if (!params.isEmpty()) {
            postRequest.setEntity(new UrlEncodedFormEntity(
                    (List<? extends NameValuePair>) params, HTTP.UTF_8));
        }
        executeRequest(postRequest, remoteUrl);
        break;
    default:
        break;
    }
} 
```

And

```
private void executeRequest(final HttpUriRequest request, final String url) {
    HttpClient client = new DefaultHttpClient();

    HttpResponse httpResponse;

    try {
        httpResponse = client.execute(request);
        responseCode = httpResponse.getStatusLine().getStatusCode();
        errorMessage = httpResponse.getStatusLine().getReasonPhrase();

        HttpEntity entity = httpResponse.getEntity();

        if (entity != null) {

            responseStream = entity.getContent();

            if (!needStreamInsteadOfString) {
                response = convertStreamToString(responseStream);

                // Closing the input stream will trigger connection release
                responseStream.close();
            }
        }

    } catch (ClientProtocolException e) {
        client.getConnectionManager().shutdown();
        e.printStackTrace();
    } catch (IOException e) {
        client.getConnectionManager().shutdown();
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:17:26.620

你有没有尝试过：

```
$test=$_POST["username"];  print $_POST["username"]; 
```

?

# java - 复制到全局剪贴板不适用于 Ubuntu 中的 Java

> ID：14242719
> 
> 赞同：28
> 
> 时间：2013-01-09T17:15:38.057
> 
> 标签：java, swing, ubuntu, awt, copy-paste

以下来自独立应用程序的代码在 ubuntu 中工作：

```
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.UnsupportedFlavorException;
import java.io.IOException;

public class ClipboardTest {

    public static void main(String[] args) throws Exception {
        Clipboard clipBoard = Toolkit.getDefaultToolkit().getSystemClipboard();        
        // print the last copied thing
        System.out.println(clipBoard.getContents(null).getTransferData(DataFlavor.stringFlavor));
        StringSelection data = new StringSelection("NOW");
        clipBoard.setContents(data, data);
        // prints NOW
        System.out.println(clipBoard.getContents(null).getTransferData(DataFlavor.stringFlavor));
    }

} 
```

将 (Ctrl+V) 粘贴到不同的应用程序中不会产生任何结果；我期待“现在”。再次调用上述代码会出现以下异常：

```
Exception in thread "main" java.awt.datatransfer.UnsupportedFlavorException: Unicode String
    at sun.awt.datatransfer.ClipboardTransferable.getTransferData(ClipboardTransferable.java:160) 
```

作为一个独立的应用程序，即使在[2011 年安全更改](https://stackoverflow.com/a/8513761/194609)之后，它也应该可以工作。通过 Ctrl+C 从 JTextField 内部复制，然后粘贴到其他地方。

使用最新的 java7 (jdk1.7.0_10) 和 jdk1.6.0_33 在 ubuntu 11.04 上均未成功；它[应该可以](https://stackoverflow.com/a/3592022/194609)在带有最新 java7 的 windows 7 和带有 java6_37 的 mac osx 10.6 上按预期工作。还用这些java尝试了xubuntu 12.04，但它在那里不起作用。这是一个 linux/ubuntu 错误吗？

[相关问题](https://stackoverflow.com/q/12707176/194609)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-22T20:59:50.430

我在工作中遇到了与应用程序相同的问题，这是我发现的一篇文章，解释了原因和可能的解决方案。我希望它有所帮助。

[为什么会发生](https://wiki.ubuntu.com/ClipboardPersistence)

> 剪贴板持久性是一个影响 Ubuntu 和其他基于 X11 的操作系统下的许多程序的错误。修复它是 Google Summer of Code 2010 项目。维基百科对这个问题有很好的概述。如果您想以用户身份进行修复，您可以安装 Parcellite 或其他剪贴板管理器。如果您想以程序员的身份对其进行修复，您可以修改您的程序以符合 ClipboardManager 规范。

[X-Window 维基](http://en.wikipedia.org/wiki/X_Window_selection#Clipboard)

[使用 gnome 库](http://java-gnome.sourceforge.net/doc/api/4.1/org/gnome/gtk/Clipboard.html)，您可以调用剪贴板上的 store 方法并修复此问题。到目前为止，这似乎是唯一值得尝试的事情。也看到了 GTK 的类似情况，但仅在 Eclipse 的错误中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-21T21:44:42.903

我用 debian testing (7.0) 和 openjdk 7u3 尝试了你的代码。结果是一样的，但我想我找到了问题（解决方案）。

剪贴板中的内容仅在进程存在时才有效。如果我将您的代码更改为：

```
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;

public class ClipboardTest {

    public static void main(String[] args) throws Exception {
        Clipboard clipBoard = Toolkit.getDefaultToolkit().getSystemClipboard();
        // print the last copied thing
        Transferable t = clipBoard.getContents(null);
        if (t.isDataFlavorSupported(DataFlavor.stringFlavor))
            System.out.println(t.getTransferData(DataFlavor.stringFlavor));
        StringSelection data = new StringSelection("NOW");
        clipBoard.setContents(data, data);
        // prints NOW
        System.out.println(clipBoard.getContents(null).getTransferData(DataFlavor.stringFlavor));
        System.in.read();
    }
} 
```

if 语句防止您的代码在没有可用内容时抛出异常，如果您运行代码一次并且进程结束，就会发生这种情况。
System.in.read() 只是保持进程活着。虽然不按回车键，但我可以粘贴到另一个应用程序中，“现在”按预期出现。
像这样，代码每次都对我有用。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-19T22:38:37.563

问：你有没有尝试过这样的事情：

`gksudo gedit /opt/java/64/jre1.7.0_04/lib/security/java.policy`=>

`permission java.awt.AWTPermission "accessClipboard";`

也可以看看：

*   [复制/粘贴在签名的 Applet 中不起作用](https://stackoverflow.com/questions/8513740/copy-paste-not-working-in-a-signed-applet)

*   [让复制/粘贴在 Mac 上的 JDK 7 AWT Applet 中工作的任何解决方法？](https://stackoverflow.com/questions/13074496/any-workaround-to-getting-copy-paste-working-in-jdk-7-awt-applet-on-mac)

*   [http://www.sqlinform.com/forum4/read.php?3,467](http://www.sqlinform.com/forum4/read.php?3,467)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T14:33:46.773

在这里你可以展示一个测试：

一个 TextArea（它的默认复制/粘贴操作可以与 ubuntu 上的任何其他应用程序一起使用）

我添加了两个按钮，可以从/向系统剪贴板复制和粘贴

```
import javax.swing.*;
import java.awt.*;
import java.awt.datatransfer.*;
import java.awt.event.ActionEvent;
import java.io.IOException;

public class PruebaClipboard {
    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.setTitle("Copy/Paste");
        frame.getContentPane().setLayout(new BorderLayout());
        JPanel btnPanel = new JPanel();
        JButton btnCopy = new JButton("copy");
        JButton btnPaste = new JButton("paste");
        btnPanel.add(btnCopy);
        btnPanel.add(btnPaste);
        final JTextArea textComp = new JTextArea(7,15);

        Action copyAction = new AbstractAction("copy") {
            public void actionPerformed(ActionEvent e) {
                Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
                StringSelection stringSelection = new StringSelection(textComp.getText());
                clipboard.setContents(stringSelection, stringSelection);
            }
        };

        btnCopy.setAction(copyAction);
        Action pasteAction = new AbstractAction("paste") {
            public void actionPerformed(ActionEvent e) {
                Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
                //odd: the Object param of getContents is not currently used
                Transferable contents = clipboard.getContents(null);
                boolean hasTransferableText = (contents != null) && contents.isDataFlavorSupported(DataFlavor.stringFlavor);
                if (hasTransferableText) {
                    try {
                        String result = "";
                        result = (String) contents.getTransferData(DataFlavor.stringFlavor);
                        textComp.append(result);
                    } catch (UnsupportedFlavorException ex) {
                        //highly unlikely since we are using a standard DataFlavor
                        System.out.println(ex);
                        ex.printStackTrace();
                    } catch (IOException ex) {
                        System.out.println(ex);
                        ex.printStackTrace();
                    }
                }
            }
        };
        btnPaste.setAction(pasteAction);

        frame.getContentPane().add(textComp);
        frame.getContentPane().add(btnPanel, BorderLayout.SOUTH);

        frame.setSize(new Dimension(400, 300));
        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

我认为您必须注意：

```
boolean hasTransferableText = (contents != null) && contents.isDataFlavorSupported(DataFlavor.stringFlavor); 
```

并看到有一个[DataFlavor.plainTextFlavor](http://docs.oracle.com/javase/6/docs/api/java/awt/datatransfer/DataFlavor.html#plainTextFlavor)这可能是您需要使用的（尽管它已被弃用）

我已经在 Ubuntu 12.10 上测试了从 java 1.4 到 java 1.6 的代码，但是我提取它的代码自我记得 ubuntu 9.0 以来一直在使用。

# javascript - 如何使用 jQuery 针对数组中的单词检查文本字段值？

> ID：14242722
> 
> 赞同：2
> 
> 时间：2013-01-09T17:15:49.930
> 
> 标签：javascript, jquery, arrays

我的数组有字符串值：

```
var bannedWords = ["cat","dog","test"] 
```

我的文本输入字段检查值是否包含数组中的单词：

```
var title = $j('#edit-content').val()
if ($j.inArray(title, bannedWords) != -1) { alert("it's inside the array") } 
```

当值为“cat”时，它按预期工作。当值为“猫是黑色的”时，我想要警报，因为“猫”在输入值内。

我明白为什么它不起作用，但我不知道我该怎么做？值中有某种循环？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:24:52.280

您可以从数组中构建一个[正则表达式](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp)并使用它来测试输入：

```
// The 'i' flag matches values regardless of case.
var regex = new RegExp('\\b' + bannedWords.join("\\b|\\b") + '\\b', 'i');

// Regex would equal /\bcat\b|\bdog\b|\btest\b/i
var valid = !regex.test($("#edit-content").val()); 
```

**示例：http:** [//jsfiddle.net/aZbWP/1](http://jsfiddle.net/aZbWP/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:18:57.287

您需要将值拆分为一个数组并单独测试每个单词：

```
var words = $j('#edit-content').val().split(' ');
$.each(words, function(index, word) {
    if ($j.inArray(word, bannedWords) != -1) { 
        alert('it\'s inside the array') 
    }
}); 
```

[**示例小提琴**](http://jsfiddle.net/RoryMcCrossan/GdjBq/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:19:11.233

您可以使用循环来检查：

```
function in_string(words, string) {
    for (var i = 0; i < words.length; i++) {
        if (string.indexOf(words[i]) !== -1) {
            return true;
        }
    }

    return false;
}

var valid = in_string(bannedWords, $j('#edit-content').val()) 
```

尽管我建议您在服务器端执行此操作。手动提交请求并绕过您的 JS 验证并不难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:32:28.477

在bannedWords 数组中使用[正则表达式](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)会更强大（例如，您可以一次性检查“cat”、“Cat”和“CAT”）并使您能够更简洁地做您想做的事情。

例如：http: [//jsfiddle.net/PS9FG/1](http://jsfiddle.net/PS9FG/1)

您需要稍微修改此代码以适合您自己的代码（例如，您拥有的 jQuery 行）。

```
var bannedWords = [
  /cat/i,    // the i after each expression means case-insensitive
  /dog/i,
  /test/i
];

document.getElementById('checkBtn').onclick = function() {
    var bWrd = bannedWords.length;
    while (bWrd) {    // loop through each pattern in the array
        bWrd -= 1;
        if (document.getElementById('edit-content').value.match(bannedWords[bWrd])) {
            alert("it's inside the array");
        }
    }
}; 
```

但希望这能让您了解它是如何工作的。

# php - SQL 脚本在 MySQL 中工作，但因 mysqli->query() 而失败；为什么？

> ID：14242723
> 
> 赞同：1
> 
> 时间：2013-01-09T17:15:49.903
> 
> 标签：php, mysql, mysqli

我的 SQL 脚本在 MySQL Workbench 中成功运行。

以下给出了错误：

```
$link = mysqli_connect(***********);
$result = $link->query($sql); 
```

SQL 脚本执行一些操作，包括：

*   创建临时表
*   截断表
*   删除表
*   插入
*   选择

执行此操作时出现错误：

```
-- 1.1 Creating temporary table for categories

    drop table if exists exp_categories; -- just in case
    create temporary table exp_categories
    (
        ID bigint not null,
        Categories text not null,
        PRIMARY KEY (ID)
    ) DEFAULT CHARSET=utf8;

-- 1.2 Inserting data...
-- few other statements here
-- last statement is SELECT 
```

mysqli 是否有我遇到的限制？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-09T17:44:23.870

尝试使用`multi_query()`

> 必须使用 [mysqli_multi_query()](http://php.net/manual/en/mysqli.quickstart.multiple-statement.php)执行多个语句或多个查询。语句字符串的各个语句用分号分隔。

```
$link->multi_query($sql) 
```

并且您连接的用户必须在您的数据库中具有必要的权限或全局权限。

# cmd - 在命令提示符下调用 WinProlog

> ID：14242729
> 
> 赞同：0
> 
> 时间：2013-01-09T17:16:22.457
> 
> 标签：cmd, prolog, prompt

我正在尝试在 Windows 提示符下调用 prolog 文件。问题是我总是收到“是的消息”，而且窗口甚至没有关闭。我究竟做错了什么？

我的“example.pl”文件：

运行：-告诉（'output.txt'），写（'Eu sou um exemplo！'），nl，告诉，停止。

：-跑。

我的控制台命令：

PRO386W.EXE /V1 咨询('exempo.pl')

我使用了所有类型的目录，但它们都不起作用。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T17:38:43.797

尝试添加一个 . 到最后：

```
PRO386W.EXE /V1 consult('exemplo.pl'). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:14:18.890

'halt' 停止 Prolog。

您是否试图让序言退出？

假设你是，那么问题是你运行它的方式。

我在 win 7 上使用了与 SWI-Prolog 相同的程序

和

```
run_me :- writeln('howdy annie'),halt.

:- run_me. 
```

在 somedir 中，我 cd'ed 进入 somedir 并运行

swipl -s ihalt.pl

它完成了预期 -
打印消息并退出

我不知道你用的是什么序言。如果您是 Prolog 的新手，www.swi-prolog.org 对学习更友好。

# jquery - jQuery 仅适用于第一个屏幕

> ID：14242730
> 
> 赞同：0
> 
> 时间：2013-01-09T17:16:22.673
> 
> 标签：jquery, html

我有以下下拉列表，可以在其生成的第一个屏幕上与我的 jquery 一起正常工作，但同一屏幕可以生成多次，并且 jQuery 的后续页面不适用于显示另一个框。

我现在很困惑。非常感谢任何帮助。

```
<xsl:for-each select="bankguarantees/bankguaranteedata">
    <div id="panel22" class="panels">
    <xsl:attribute name="id">panel22_<xsl:value-of select="@id"/></xsl:attribute>
      <table border="1" width="100%" height="100%"  bgcolor="#CECFFF" style="border-top: none" cellspacing="10">    
<tr>
<td>
<table border="0" width="100%" height="100%" bgcolor="lightyellow" class="inline">
<tr>
<td colspan="3" class="Header" height="1"></td>
</tr>

   <tr name="contliab" id="contliab">
            <script type="text/javascript">
             $('#producttypes').change(function()
             {
               if($('#otherprodtype').is(':selected'))
               {
               $('#otherprodtypebox').show();
               }
             else
              {
               if($('#otherprodtypebox').is(':visible'))
               {
                 $('#otherprodtypebox').hide();
               }
              }
             });;
            </script>
            <td class="Label">Product Type</td>
            <td class="field">
             <select name="producttypes" id="producttypes">
              <option value="interventionguar">
               <xsl:if test="producttypes/option[@id='interventionguar']='selected'">
                <xsl:attribute name="selected"/>
               </xsl:if>Intervention Guarantee</option>
              <option value="customsguar">
               <xsl:if test="producttypes/option[@id='customsguar']='selected'">
                <xsl:attribute name="selected"/>
              </xsl:if>Customs Guarantee</option>
              <option value="otherprodtype" id="otherprodtype">
               <xsl:if test="producttypes/option[@id='otherprodtype']='selected'">
                <xsl:attribute name="selected"/>
               </xsl:if>Other</option>
             </select>
             <input class="amdInputText" type="text" id="otherprodtypebox" value="" style="display:none;">
                <xsl:attribute name="value"><xsl:value-of select="otherprodtypebox"></xsl:value-of></xsl:attribute></input>
            </td>
           </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:20:41.380

如果`$('#producttypes')`是在页面加载后动态添加的元素（例如来自 AJAX 调用），那么您必须使用`delegate()`它来捕获来自它的事件。

```
$("#parentElement").delegate('#producttypes','change',function(){
  ...
}); 
```

委托函数放置在动态元素的父元素上。父元素不必是直接祖先，也可以是，`$('body')`但出于性能原因，您应该避免将所有事件附加到主体。

> [**委托（）**](http://api.jquery.com/delegate/) -
> 
> 根据一组特定的根元素，将处理程序附加到现在或将来与选择器匹配的所有元素的一个或多个事件。

# active-directory - Apache HTTP Server 2.4 LDAP（活动目录）身份验证

> ID：14242734
> 
> 赞同：5
> 
> 时间：2013-01-09T17:16:37.623
> 
> 标签：active-directory, apache2

我在 Windows 2008 服务器上安装了 Apache 2.4 和 PHP 5.4。我正在尝试针对 Active Directory 服务器进行身份验证。我在 httpd.conf 中取消了以下注释

```
LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
LoadModule ldap_module modules/mod_ldap.so 
```

我创建了以下别名

```
Alias /Website "C:/Web/Aliases/Website"
<Location /Website>

# Using this to bind
AuthLDAPBindDN "CN=John Doe,OU=Accounts,OU=CA,OU=Country,OU=Company Name,DC=com"
AuthLDAPBindPassword "mypassword"
# search user
AuthLDAPURL "ldap://myserver/OU=Country,OU=Company,DC=com?poibri02?sub?(objectClass=*)"

AuthType Basic
AuthName "USE YOUR WINDOWS ACCOUNT"
AuthBasicProvider ldap
require valid-user

</Location> 
```

但是，当我尝试访问该网站时，我得到 a`500 Internal Server Error`并且 error.log 给出以下内容

```
[Wed Jan 09 12:05:28.614839 2013] [ldap:error] [pid 3904:tid 1064] (70023)This function has not been implemented on this platform: AH01277: LDAP: Unable to add rebind cross reference entry. Out of memory? 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-08T13:43:07.480

这为我解决了这个问题：

```
LDAPReferrals Off 
```

[从这里](https://www.apachelounge.com/viewtopic.php?t=4851&view=next)和[这里](http://serverdown.ttwait.com/que/594366)收集的其他提示：

```
AuthzLDAPAuthoritative off
# Use the password without quotes, e.g. password instead of "password"
AuthLDAPBindPassword password 
```

但是，这些对我来说不是必需的。

# c - unsigned long long 在C中表现得很奇怪

> ID：14242735
> 
> 赞同：1
> 
> 时间：2013-01-09T17:16:40.860
> 
> 标签：c, variables, undefined-behavior, unsigned-long-long-int

在运行为 MIPS 编译的程序时，我偶然发现了一个非常奇怪的问题。以下代码片段用于获取时间纪元并将其以微秒精度存储在`unsigned long long`变量中。

该变量能够存储我检查过的 8 个字节`sizeof(unsigned long long)`。

这段代码奇怪地打印出来：

```
unsigned long long microtime=0;
struct timeval time_camera = { .tv_sec=0, .tv_usec=0 };
gettimeofday(&time_camera,NULL);
microtime = time_camera.tv_sec * 1000000 + time_camera.tv_usec;
printf("Times is now %llu , time since epoch in seconds is: %lu\n", microtime, time_camera.tv_sec); 
```

它给了我以下输出：

```
>> Times is now 484305845 , time since epoch in seconds is: 1357751315 
```

但是，当我将计算分成不同的行时，它可以工作！：

```
unsigned long long microtime=0;
struct timeval time_camera = { .tv_sec=0, .tv_usec=0 };
gettimeofday(&time_camera,NULL);
microtime = time_camera.tv_sec;
microtime = microtime * 1000000;
microtime = microtime  + time_camera.tv_usec;
printf("Times is now %llu , time since epoch in seconds is: %lu\n", microtime, time_camera.tv_sec); 
```

输出是：

```
Times is now 1357751437422143 , time since epoch in seconds is: 1357751437 
```

现在这只是一个巧合吗？例如，我是否损坏了内存或实际上超出了某个地方？也许是 MIPS 编译器？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T17:19:34.280

```
microtime = time_camera.tv_sec * 1000000 + time_camera.tv_usec; 
```

`tv_sec`是一个较小的整数类型（`time_t`，可能是`int`或`long`），所以

```
time_camera.tv_sec * 1000000 
```

溢出。使用后缀为常量赋予适当的类型

```
time_camera.tv_sec * 1000000ULL 
```

在

```
microtime = time_camera.tv_sec;
microtime = microtime * 1000000; 
```

乘法在 处执行`unsigned long long`，因为一个操作数 ( `microtime`) 已经具有该类型，因此另一个被转换为该类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T17:19:12.480

看起来你`size_t`在分配给你的`unsigned long long`. `ULL`试着把你的常数放在后面。

另一种方法是`(unsigned long long) 1000000`. 只要您在乘法中的至少一个操作数上有这个，就可以确保结果将是更高优先级的类型。隐式类型转换优先级规则是（按从高到低的顺序）：

`long double`=> `double`=> `float`=> `unsigned long long`=> `long long`=> `unsigned long`=> `long`=> `unsigned int`=>`int`

# silverlight - 打开记事本，在 Silverlight 中粘贴文本

> ID：14242736
> 
> 赞同：0
> 
> 时间：2013-01-09T17:16:44.827
> 
> 标签：silverlight, shell, copy-paste

我想从 Silverlight 打开记事本，然后将一些文本粘贴到其中。我能够使用剪贴板方法将我想要的文本移动到剪贴板。然后我用shell打开记事本。最后一步是将剪贴板的内容粘贴到记事本中。这可以通过用户按 Ctrl-V 或编辑 - 粘贴来完成

然而，这是一个不能令人满意的解决方案。我想自动化最后一步，将剪贴板粘贴到记事本中。

这是我的代码：

```
 System.Windows.Clipboard.SetText(l_StringBuilder.ToString)

                ' next open notepad
  OpenShell("notepad.exe")

  System.Windows.Clipboard.GetText() ‘ this does not work

    Private Sub OpenShell(p_Program As String)
        Try
            If (AutomationFactory.IsAvailable) Then
                Dim shell = AutomationFactory.CreateObject("Shell.Application")

                shell.ShellExecute(p_Program) 'Open notepad

            End If

        Catch ex As Exception
            MessageBox.Show(ex.ToString)

        End Try
    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T15:53:56.583

我在另一个论坛上得到了答案。这是它的链接：

[http://social.msdn.microsoft.com/Forums/en-US/silverlightnet/thread/b787244d-a0a9-4aea-8858-e94644742ff0/#05ca684e-1d22-4bca-a207-9c422a7cf5d6](http://social.msdn.microsoft.com/Forums/en-US/silverlightnet/thread/b787244d-a0a9-4aea-8858-e94644742ff0/#05ca684e-1d22-4bca-a207-9c422a7cf5d6)

# windows-phone-7 - Windows Phone LINQ to SQL SqlCeException

> ID：14242737
> 
> 赞同：1
> 
> 时间：2013-01-09T17:16:52.097
> 
> 标签：windows-phone-7, linq-to-sql

对于一个学校项目，我们必须制作一个 Windows Phone 7.1 应用程序。它必须使用本地数据库，为此我们必须使用 LINQ 和 Bing 地图。

我们正在制作一个将从数据库中检索路由的应用程序。每条路线都有一些航路点。

现在，我们制作了 3 个表（更实际，但目前只有这 3 个是相关的），即“Route”、“Waypoint”和“RouteWaypointLink”。你可以在下面看到他们的课程

路线：

```
[Table]
public class Route : INotifyPropertyChanged, INotifyPropertyChanging
{
    public event PropertyChangingEventHandler PropertyChanging;
    public event PropertyChangedEventHandler PropertyChanged;

    private int idRouteValue;
    private string nameValue;

    [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]
    public int IDRoute
    {
        get
        {
            return idRouteValue;
        }
        private set
        {
            NotifyPropertyChanging("IDRoute");
            idRouteValue = value;
            NotifyPropertyChanged("IDRoute");
        }
    }
    [Column]
    public string Name
    {
        get
        {
            return nameValue;
        }
        set
        {
            NotifyPropertyChanging("Name");
            nameValue = value;
            NotifyPropertyChanged("Name");
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    private void NotifyPropertyChanging(string propertyName)
    {
        if (PropertyChanging != null)
        {
            PropertyChanging(this, new PropertyChangingEventArgs(propertyName));
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    private void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    public override string ToString()
    {
        return "[" + IDRoute + "] " + Name;
    }
} 
```

航点：

```
[Table]
public class Waypoint : INotifyPropertyChanged, INotifyPropertyChanging
{
    public event PropertyChangingEventHandler PropertyChanging;
    public event PropertyChangedEventHandler PropertyChanged;

    private int idWaypointValue;
    private string nameValue;
    private double gpsLongitudeValue;
    private double gpsLatitudeValue;
    private string descriptionValue;

    [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]
    public int IDWaypoint
    { 
        get 
        {
            return idWaypointValue; 
        } 
        private set 
        {
            NotifyPropertyChanging("IDWaypoint");
            idWaypointValue = value;
            NotifyPropertyChanged("IDWaypoint"); 
        }
    }
    [Column]
    public string Name
    {
        get
        {
            return nameValue;
        }
        set
        {
            NotifyPropertyChanging("Name");
            nameValue = value;
            NotifyPropertyChanged("Name");
        }
    }
    [Column]
    public double GPSLongitude 
    {   
        get
        {         
            return gpsLongitudeValue;    
        }  
        set 
        {
            NotifyPropertyChanging("GPSLongitude"); 
            gpsLongitudeValue = value;
            NotifyPropertyChanged("GPSLongitude");  
        }
    }
    [Column]
    public double GPSLatitude
    {
        get
        {
            return gpsLatitudeValue;
        }
        set
        {
            NotifyPropertyChanging("GPSLatitude");
            gpsLatitudeValue = value;
            NotifyPropertyChanged("GPSLatitude");
        }
    }
    [Column]
    public string Description
    {
        get
        {
            return descriptionValue;
        }
        set
        {
            NotifyPropertyChanging("Description");
            descriptionValue = value;
            NotifyPropertyChanged("Description");
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    private void NotifyPropertyChanging(string propertyName)
    {
        if (PropertyChanging != null)
        {
            PropertyChanging(this, new PropertyChangingEventArgs(propertyName));
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    private void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <returns></returns>
    public override string ToString()
    {
        return Name;
    }
} 
```

RouteWaypointLink：

```
[Table]
public class RouteWaypointLink : INotifyPropertyChanged, INotifyPropertyChanging
{
    public event PropertyChangingEventHandler PropertyChanging;
    public event PropertyChangedEventHandler PropertyChanged;

    private int idRouteWaypointLinkValue;
    private EntityRef<Route> routeValue;
    private EntityRef<Waypoint> waypointValue;
    private int waypointIndexValue;

    [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]
    public int IDRouteWaypointLink
    {
        get
        {
            return idRouteWaypointLinkValue;
        }
        private set
        {
            NotifyPropertyChanging("IDRouteWaypointLink");
            idRouteWaypointLinkValue = value;
            NotifyPropertyChanged("IDRouteWaypointLink");
        }
    }

    [Association(IsForeignKey = true, Storage = "routeValue")]
    public Route Route
    {
        get
        {
            return routeValue.Entity;
        }
        set
        {
            NotifyPropertyChanging("Route");
            routeValue.Entity = value;
            NotifyPropertyChanged("Route");
        }
    }

    [Association(IsForeignKey = true, Storage = "waypointValue")]
    public Waypoint Waypoint
    {
        get
        {
            return waypointValue.Entity;
        }
        set
        {
            NotifyPropertyChanging("Waypoint");
            waypointValue.Entity = value;
            NotifyPropertyChanged("Waypoint");
        }
    }

    [Column]
    public int WaypointIndex
    {
        get
        {
            return waypointIndexValue;
        }
        set
        {
            NotifyPropertyChanging("Index");
            waypointIndexValue = value;
            NotifyPropertyChanged("Index");
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    private void NotifyPropertyChanging(string propertyName)
    {
        if (PropertyChanging != null)
        {
            PropertyChanging(this, new PropertyChangingEventArgs(propertyName));
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    private void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <returns></returns>
    public override string ToString()
    {
        return waypointValue.Entity.ToString();
    }
} 
```

当我们启动我们的程序时，我们想用一些测试数据填充它：

```
/// <summary>
/// 
/// </summary>
/// <param name="connection"></param>
public static void MakeDB(string connection)
{
    RallyDatabase db = new RallyDatabase(connection);

    //Temp
    db.DeleteDatabase();

    if (!db.DatabaseExists())
    {
        db.CreateDatabase();

        #region waypoint
        Waypoint w1 = new Waypoint();
        w1.Name = "VVV Breda";
        w1.GPSLatitude = 51.59380;
        w1.GPSLongitude = 4.77963;
        db.WaypointTable.InsertOnSubmit(w1);

        Waypoint w2 = new Waypoint();
        w2.Name = "Liefdeszuster";
        w2.GPSLatitude = 51.59307;
        w2.GPSLongitude = 4.77969;
        db.WaypointTable.InsertOnSubmit(w2);

        Waypoint w3 = new Waypoint();
        w3.Name = "Valkenberg";
        w3.GPSLatitude = 51.59250;
        w3.GPSLongitude = 4.77969;
        db.WaypointTable.InsertOnSubmit(w3);
        #endregion

        #region route
        Route testRoute1 = new Route();
        testRoute1.Name = "Kroegentocht";
        db.RouteTable.InsertOnSubmit(testRoute1);

        Route testRoute2 = new Route();
        testRoute2.Name = "Bezienswaardighedentocht";
        db.RouteTable.InsertOnSubmit(testRoute2);
        #endregion

        #region waypointlinks
        RouteWaypointLink routeWaypointLink1 = new RouteWaypointLink();
        routeWaypointLink1.Route = testRoute1;
        routeWaypointLink1.Waypoint = w1;
        routeWaypointLink1.WaypointIndex = 0;
        db.RouteLinkTable.InsertOnSubmit(routeWaypointLink1);

        RouteWaypointLink routeWaypointLink2 = new RouteWaypointLink();
        routeWaypointLink2.Route = testRoute1;
        routeWaypointLink2.Waypoint = w2;
        routeWaypointLink2.WaypointIndex = 1;
        db.RouteLinkTable.InsertOnSubmit(routeWaypointLink2);

        //Wut, why does it work when this is commented?
        RouteWaypointLink routeWaypointLink3 = new RouteWaypointLink();
        routeWaypointLink3.Route = testRoute1;
        routeWaypointLink3.Waypoint = w3;
        routeWaypointLink3.WaypointIndex = 2;
        db.RouteLinkTable.InsertOnSubmit(routeWaypointLink3);

        RouteWaypointLink routeWaypointLink4 = new RouteWaypointLink();
        routeWaypointLink4.Route = testRoute2;
        routeWaypointLink4.Waypoint = w1;
        routeWaypointLink4.WaypointIndex = 0;
        db.RouteLinkTable.InsertOnSubmit(routeWaypointLink4);

        RouteWaypointLink routeWaypointLink5 = new RouteWaypointLink();
        routeWaypointLink5.Route = testRoute2;
        routeWaypointLink5.Waypoint = w2;
        routeWaypointLink5.WaypointIndex = 1;
        db.RouteLinkTable.InsertOnSubmit(routeWaypointLink5);
        #endregion

        db.SubmitChanges();
    }
} 
```

然而，当我们尝试运行它时，我们得到一个指向 db.SubmitChanges() 的错误：

```
SqlCeException was unhandled - A foreign key value cannot be inserted because a corresponding primary key value does not exist. [ Foreign key constraint name = FK_RouteWaypointLink_Route ] 
```

现在奇怪的是：当我评论 RouteWaypointLink 的最后 3 个插入时，它工作正常，所以它看起来像这样：

```
#region waypointlinks
RouteWaypointLink routeWaypointLink1 = new RouteWaypointLink();
routeWaypointLink1.Route = testRoute1;
routeWaypointLink1.Waypoint = w1;
routeWaypointLink1.WaypointIndex = 0;
db.RouteLinkTable.InsertOnSubmit(routeWaypointLink1);

RouteWaypointLink routeWaypointLink2 = new RouteWaypointLink();
routeWaypointLink2.Route = testRoute1;
routeWaypointLink2.Waypoint = w2;
routeWaypointLink2.WaypointIndex = 1;
db.RouteLinkTable.InsertOnSubmit(routeWaypointLink2);

//Wut, why does it work when this is commented?
//RouteWaypointLink routeWaypointLink3 = new RouteWaypointLink();
//routeWaypointLink3.Route = testRoute1;
//routeWaypointLink3.Waypoint = w3;
//routeWaypointLink3.WaypointIndex = 2;
//db.RouteLinkTable.InsertOnSubmit(routeWaypointLink3);

//RouteWaypointLink routeWaypointLink4 = new RouteWaypointLink();
//routeWaypointLink4.Route = testRoute2;
//routeWaypointLink4.Waypoint = w1;
//routeWaypointLink4.WaypointIndex = 0;
//db.RouteLinkTable.InsertOnSubmit(routeWaypointLink4);

//RouteWaypointLink routeWaypointLink5 = new RouteWaypointLink();
//routeWaypointLink5.Route = testRoute2;
//routeWaypointLink5.Waypoint = w2;
//routeWaypointLink5.WaypointIndex = 1;
//db.RouteLinkTable.InsertOnSubmit(routeWaypointLink5);
#endregion

db.SubmitChanges(); 
```

当插入 2 个 RouteWaypointLinks 时它确实有效，但当我们尝试创建 5 个时它不工作，这不是很奇怪吗？

当我们尝试添加一些 RouteWaypointLinks 时，我们还在程序中进一步看到了问题（实际上我们已经很远了，但这阻碍了我们）。

有没有人知道发生了什么？我们感谢任何帮助！

你的，特里根

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T21:10:22.120

转到**服务器资源管理器**，然后转到您的 IDRoute**列属性**：

你有这样的选择吗？

![在此处输入图像描述](../Images/b0d3acc3863d0da9086b0330aae26ee1.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T10:52:51.463

嗯，看来我已经通过添加一些东西来修复它

```
private Nullable<int> idRoute;
private Nullable<int> idWaypoint;

[Column(Storage = "idRoute", DbType = "Int")]
public int? IDRoute
{
    get
    {
        return this.idRoute;
    }
    set
    {
        this.idRoute = value;
    }
}

[Column(Storage = "idWaypoint", DbType = "Int")]
public int? IDWaypoint
{
    get
    {
        return this.idWaypoint;
    }
    set
    {
        this.idWaypoint = value;
    }
} 
```

另外，我将关联更改为：

```
[Association(IsForeignKey = true, Storage = "routeValue", ThisKey="IDRoute")]
public Route Route
{
    get
    {
        return routeValue.Entity;
    }
    set
    {
        NotifyPropertyChanging("Route");
        routeValue.Entity = value;
        NotifyPropertyChanged("Route");
    }
}

[Association(IsForeignKey = true, Storage = "waypointValue", ThisKey="IDWaypoint")]
public Waypoint Waypoint
{
    get
    {
        return waypointValue.Entity;
    }
    set
    {
        NotifyPropertyChanging("Waypoint");
        waypointValue.Entity = value;
        NotifyPropertyChanged("Waypoint");
    }
} 
```

我必须添加包含 Route 和 Waypoint 主键的列，这似乎是合乎逻辑的。但是，我仍然不明白为什么当我添加 2 时它会起作用，但当我添加更多时却不会。

好吧，它现在已经修好了，所以一切都很好。

# java - ThreadLocal 中的多个对象

> ID：14242739
> 
> 赞同：6
> 
> 时间：2013-01-09T17:16:54.767
> 
> 标签：java, multithreading, thread-local

我们可以在 a 中设置多个对象`ThreadLocal`吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-09T17:19:02.627

一个thread local是当前线程的一个局部变量；所以每个线程都得到一个值。但是该值可以是一个实例，因此您可以在其中放置一个地图，例如，或者一个收集您想要的所有值的自定义类型。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-09T17:24:05.450

你可以有多个`ThreadLocal`，你可以有一个包含多个对象的对象。

例如

```
final ThreadLocal<Map<String, String>> localProperties = new ThreadLocal<Map<String, String>>() {
     public Map<String, String> initialValue() {
           return new LinkedHashMap<String, String>();
     }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-26T08:55:43.993

我们可以在单个 Thread 中创建多个 ThreadLocal 对象，并使用特定的 ThreadLocal 对象的`get()`方法访问它。

实际上，ThreadLocal 有一个名为 ThreadLocalMap 的静态内部类及其自定义的 hashmap，其中该自定义映射中的 key 是 ThreadLocal 对象，value 是要存储的值。

每个线程都持有这个 threadLocalMap 对象的引用。

# sphinx - 可以 # 在 sphinx 中使用我的密码吗

> ID：14242741
> 
> 赞同：0
> 
> 时间：2013-01-09T17:17:00.023
> 
> 标签：sphinx

我在尝试调用索引器时遇到了 sphinx 的问题：我的密码是：密码！@#$，但是当我尝试使用索引器时，我得到：

错误：索引“wiki_incremental”：sql_connect：无法连接到“localhost”（10061）上的 MySQL 服务器（DSN=mysql://\'Wikidev\'替换为您的数据库用户名：*** @loc alhost:3306/bchelptest） .

我认为所有其他配置都在工作，我想知道密码中的 # 是否真的被读取，如果不是我能做些什么来读取它

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:44:58.487

固定，只需在`\`前面添加`#`，结果是： `\#`

# jquery - 之后向现有的 jquery css 更改添加“背景图像”更改

> ID：14242744
> 
> 赞同：1
> 
> 时间：2013-01-09T17:17:13.003
> 
> 标签：jquery, css, background-image

我有一个链接...

```
a#popup { background:url(../popupopen.jpg) center right no-repeat #fff; 
```

它使用...切换菜单位置

```
jQuery(document).ready(function(){
jQuery('a#popup').toggle(function () {
jQuery("#wps-sidebar").css({left: "30px"});
}, function () {
jQuery("#wps-sidebar").css({left: "-240px"});
});
}); 
```

＆我正在尝试在每个末尾添加一个简单的背景图像更改，以便在打开背景图像时更改为使用 popupclose.jpg （在菜单位置切换之后），并且一旦关闭，显然又回到 popupopen.jpg再次。我正在尝试复制现有示例，但找不到任何可以进入我的 js-inept 大脑的内容，有人可以建议吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:50:53.303

我将背景应用到#wps-sidebar 而不是#popup，然后...

```
#wps-sidebar.opened {
left: 30px;
background: url(../popupclose.jpg) center right no-repeat #fff;
} 
```

...&...

```
jQuery(document).ready(function(){
jQuery('a#popup').toggle(function () {
jQuery("#wps-sidebar").addClass("opened");
}, function () {
jQuery("#wps-sidebar").removeClass("opened");
});
}); 
```

谢谢你的建议，只是我需要的大脑。:)

# php - mysql INSERT查询中的动态php变量

> ID：14242753
> 
> 赞同：0
> 
> 时间：2013-01-09T17:17:24.340
> 
> 标签：php, mysql, forms, bulkinsert

我从我的表单中获取值`39 fields`，所有字段的名称顺序为

```
field1,field2,field3 ....... 
```

我的 sql 表`mytable`也有 39 个同名字段，即 `field1,field2,field3 .......`

现在在 submit.php 中，我正在寻找一个解决方案，我不想将所有这 39 个变量都写入`mytable`ie`INSERT INTO mytable VALUES(field1,field2,field3,......)`

但是我正在寻找一种解决方案，在这种解决方案中，我不必编写所有这 39 个变量，而且我仍然可以将它们存储在 sql 的不同 39 个字段中。我试过的是：

```
$query=mysql_query("INSERT INTO mytable VALUES (
".
for ($k=1; $k<=39; $k++)
{

$vari=$_POST["field".$k];   

$Temp_previous_total++;

}
.")"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:21:25.303

```
$myvars = '';
for ($k=1; $k<=39; $k++)
{
   $myvars .= "'".$_POST["field".$k]."',";   
}
$myvars = substr($myvars,0,-1);
$query = "INSERT INTO mytable VALUES (
".$myvars.")";
mysql_query($query); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:20:56.510

您绝对应该在插入这些字段之前对其进行清理，这是一个对 mysql 查询非常有用的类：[PHP MySQL wrapper v3](http://www.ricocheting.com/code/php/mysql-database-class-wrapper-v3)正是这样做的

# postgresql - 动态 SQL 中的参数连接

> ID：14242756
> 
> 赞同：1
> 
> 时间：2013-01-09T17:17:28.893
> 
> 标签：postgresql, plpgsql, dynamic-sql

我想通过 PostgreSQL 中的 Pl/pgSQL 更新一行，但发生错误。这是我的代码：

```
CREATE OR REPLACE FUNCTION "Surrogate_Del"(tablename text, surro uuid)
  RETURNS void AS
$BODY$DECLARE
tblname text;
surrogate uuid;
BEGIN
tblname:=tablename;
surrogate:=surro;
execute 'UPDATE'||tblname||'SET ID=NULL WHERE surrogate='||surrogate|| ;
END$BODY$
LANGUAGE plpgsql 
```

这是我要根据它更新记录的 UUID

```
*syntax Error »ab7«
cd32cdf0-5ab7-11e2-abda-1c4bd605a98d
                  ^* 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:32:24.593

您需要在参数周围使用转义引号：

```
execute 'UPDATE ' || tblname || ' SET ID = NULL WHERE surrogate = ''' || surrogate || ''''; 
```

mu 的建议更简洁、更可靠：

```
execute 'UPDATE ' || tblname || ' SET ID = NULL WHERE surrogate = ' || quote_literal(surrogate); 
```

如果它是较新版本的 postgresql（我猜是 9.0+），您可以使用以下`format`功能：

```
execute format('UPDATE %I SET ID = NULL WHERE surrogate = %L', tblname, surrogate); 
```

`%L`将其转义为 SQL 文字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T16:38:04.737

通常更好的方法是[使用](http://www.postgresql.org/docs/9.1/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)[子句](http://www.postgresql.org/docs/9.1/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)[插入***值*****`USING`**](http://www.postgresql.org/docs/9.1/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)。这避免了强制转换的运行时开销`text`以及引用特殊字符可能带来的危险。

您也可以直接使用您的*命名参数*。声明和分配另一层局部变量没有意义：

```
CREATE OR REPLACE FUNCTION surrogate_del (_tblname text, _surro uuid)
   RETURNS void AS
$BODY$
BEGIN
   EXECUTE format('UPDATE %I SET ID = NULL WHERE surrogate = $1', _tblname)
   USING _surro;
END
$BODY$ LANGUAGE plpgsql 
```

我还将您的函数名称转换为小写并删除了双引号。我个人的建议是*永远不要*在 PostgreSQL 中使用 CamelCase 标识符。那是痛苦的源泉。

在相关说明中：请记住以`_tblname`区分大小写的方式提供表名。[`format()`或`quote_ident()`](http://www.postgresql.org/docs/current/interactive/functions-string.html)逐字保留拼写。

# php - PHP 会话警告问题

> ID：14242758
> 
> 赞同：1
> 
> 时间：2013-01-09T17:17:52.953
> 
> 标签：php, session

> **可能重复：**
> [使用全局变量作为数据源的 PHP 会话副作用警告](https://stackoverflow.com/questions/175091/php-session-side-effect-warning-with-global-variables-as-a-source-of-data)

我收到以下警告`php`

*`Warning: Unknown: Your script possibly relies on a session side-effect which existed until PHP 4.2.3\. Please be advised that the session extension does not consider global variables as a source of data, unless register_globals is enabled. You can disable this functionality and this warning by setting session.bug_compat_42 or session.bug_compat_warn to off, respectively in Unknown on line 0`*

我相信以下代码会产生警告。

```
 $name=$_SESSION['name'];
 $emails=$_SESSION['email'];

 $_SESSION['info']=array_intersect($name, $emails); 
```

我无权访问`php.ini`也无服务器。我只能更改我的代码。有没有办法删除警告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:24:31.943

这意味着您有一个与会话变量同名的变量，如下所示。

```
$_SESSION['variable'] = null;
$variable = 'data'; 
```

您可以通过将这些行添加到 php.ini 或 .htaccess 中的脚本来阻止 PHP 尝试查找现有变量并警告您

```
ini_set('session.bug_compat_warn', 0);
ini_set('session.bug_compat_42', 0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:19:43.477

这将消除错误：

```
ini_set('session.bug_compat_42',0);
ini_set('session.bug_compat_warn',0); 
```

您也可以在 .htaccess 文件中关闭它，或者如果可用，在您的目录根目录中的 php.ini 文件中关闭它。

# c# - 如何在 C# 中纠正此异常

> ID：14242759
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:17:57.037
> 
> 标签：c#, linq, sql-server-2008, linq-to-sql

我已经编写了如下的 linq 查询：

```
 NorthwindContext context = SqlCE;
   var query = context.Destinations.Where(i => i.Id >= 1).Select(i => new {
                    id = i.Id,
                  name = i.Destination
       }).ToArray();

   public NorthwindDataContext SqlCE
    {
        get
        {
            AppDomain.CurrentDomain.SetData("SQLServerCompactEditionUnderWebHosting", true);
            string connectionString = @"Data Source=|DataDirectory|\Database1.mdf";
            return new NorthwindDataContext(connectionString);
        }
    } 
```

我已连接到 sqlserver northwind.mdf 文件。我在表中有值，我仍然得到空引用异常。我该如何纠正这一点。如何在查询中获取值。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:25:47.557

你可能需要这样的东西：

```
using (var context = new NorthwindContext()) 
{
    var query = context.Destinations.Where(i => i.Id >= 1).Select(i => new {
                id = i.Id,
              name = i.Destination
    }).ToArray();
 } 
```

尽管您可能会丢失更多信息（例如连接字符串等）。

# c# - makepri.exe 是如何集成到 MSBuild 中的？

> ID：14242763
> 
> 赞同：3
> 
> 时间：2013-01-09T17:18:08.570
> 
> 标签：c#, .net, windows-8, visual-studio-2012, windows-runtime

我正在尝试了解 WinRT 中的[资源管理](http://msdn.microsoft.com/en-us/library/windows/apps/jj552947.aspx)。

文档说：

> MakePRI.exe 是用于创建和转储 PRI 文件的命令行工具。它作为 MSBuild 的一部分集成在 Microsoft Visual Studio 中，但对于开发人员手动或自定义构建系统创建包很有用。

我想知道makepri.exe是如何集成到MSBuild中的，我该如何配置呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T23:18:05.803

您的 csproj 文件为 C# XAML 应用程序导入此文件：

```
%ProgramFiles(x86)%\MSBuild\Microsoft\WindowsXaml\v11.0\Microsoft.Windows.UI.Xaml.CSharp.Targets 
```

进而导入以任何语言编写的 Windows XAML 应用程序所共有的这个：

```
%ProgramFiles(x86)%\MSBuild\Microsoft\WindowsXaml\v11.0\Microsoft.Windows.UI.Xaml.Common.Targets 
```

最后它会导入这个包含 makepri 配置命令的文件：

```
%ProgramFiles(x86)%\MSBuild\Microsoft\VisualStudio\v11.0\AppxPackage\Microsoft.AppxPackage.Targets 
```

那里有一个叫做“_GenerateProjectPriFileDependsOn”的东西，它由这些任务组成：

```
 _GeneratePrisForPortableLibraries;
        _GetPriFilesFromPayload;
        _ComputeInputPriFiles;
        _GenerateProjectPriConfigurationFiles;
        _CalculateInputsForGenerateProjectPriFileCore;
        _GenerateProjectPriFileCore;
        _AddFileReadsAndFileWritesForProjectPri;
        _CreateProjectPriFileItem;
        _ExpandPriFiles; 
```

似乎它运行一些任务来列出资源，为 makepri 生成一个配置文件，然后运行 ​​makepri。

目标文件有点难以分析，我会在这里打破并寻找这些 makepri 配置文件。如果您在应用项目的 obj 文件夹下搜索，您可以找到一个名为 priconfig.xml 的文件。事实上，如果您运行 makepri.exe，您会发现有一个用于创建配置文件的 makepri 命令，如果您尝试（通过运行 makepri.exe createconfig） - 您将了解到 priconfig.xml 是配置文件的通用名称. 如果您运行“makepri new”，您将看到生成 pri 文件的选项和调用语法（“MakePri.exe new /pr /cf [options]”）。现在 priconfig.xml 文件列出了一些其他文件，如 pri.resfiles 似乎列出了从引用的程序集导入的 pri 文件和 layout.resfiles ，这是要打包在应用程序中的所有内容文件的列表。

所以这大致就是makepri如何集成到msbuild中的。[现在 Windows 开发中心有关于资源管理系统](http://msdn.microsoft.com/en-us/library/windows/apps/jj552947.aspx)的整个主题，它描述了如果你想手动运行它，你将如何配置它。

您可能还想阅读有关[使用限定符命名资源](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh965324%28v=win.10%29.aspx)的另一个相关主题，该主题显示了如何使用各种限定符（比例、语言环境等）命名或位于限定符文件夹中的资源被拾取。

# python - 在不安装的情况下使用/加载新的python模块

> ID：14242764
> 
> 赞同：1
> 
> 时间：2013-01-09T17:18:16.087
> 
> 标签：python, numpy, scipy, python-module

我对 完全陌生`Python`，我必须在我的代码中使用一些模块，比如`numpy`and `scipy`，但是我没有权限在我的主机上使用`easy-install`or安装新模块`pip`（当然我不知道如何在我有权限的目录[我有 SSH 访问权限]）。

我已经下载`numpy`并使用`from numpy import *`了，但它不起作用。我也用 scipy : 尝试过同样的事情`from scipy import *`，但它也不起作用。

**如何在 Python 中加载/使用新模块而不安装它们 [ `numpy`, `scipy`.. ] ？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:25:27.070

使用 easy_install 或 setup.py 的 --user 选项来指示安装的位置。它应该指向您具有写入权限的目录。

构建并安装模块后，您需要将环境变量 PYTHONPATH 设置为指向该位置。下次运行 python 命令时，您应该能够导入模块。

# php - PHP FTP 和 ajax 或类似的

> ID：14242765
> 
> 赞同：1
> 
> 时间：2013-01-09T17:18:17.710
> 
> 标签：php, javascript, ajax, ftp

我编写了一个 PHP 类，它允许用户与 FTP 服务器交互、连接、更改目录、上传等。接下来我想做的是实时更新服务器上发生的事情，即。如果他们更改目录，向他们发送一条消息说目录已更改，您现在在 {pwd} 中。

这甚至可能吗？我对我的 PHP 类很满意，但我不知道如何赋予它实时性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:33:06.450

您所描述的主要是前端工程问题。

通常在基于浏览器的 UI 中，这些“实时”情况是通过使用 JS 以定时间隔对服务器进行的 ajax 调用来模拟的。您可以设置端点，将您的“答案”表示返回给 ping，并使用相关信息更新您的前端显示。这绕过了 HTTP 协议的无状态特性。

我建议以这种“ping”方式进行的任何呼叫也更新他们的间隔，以防他们没有收到新数据。当几个连续的响应显示没有新信息时，减少检查频率会更有效。每次没有新的报告时，您都可以增加间隔。

当需要真正的“实时”时，还有更高级的实现，您可以搜索“HTTP Push”以获取有关如何在发送新数据之前挂起 HTTP 响应的更多信息。但是，我认为在您的情况下不需要任何特别的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:29:34.583

要模拟实时更新，您可以编写一个简单的 javascript 代码，按时间间隔检查服务器上的更改。就像 Ping 一样，只要有新的东西存在就返回。如果服务器返回 true，您可以获取所有消息。

越来越多的其他方法是 websockets。 [http://socket.io/](http://socket.io/)是一个有用的例子。它基于 node.js

# blackberry - 为 Blackberry 选择 Web 框架

> ID：14242767
> 
> 赞同：3
> 
> 时间：2013-01-09T17:18:18.470
> 
> 标签：blackberry, frameworks, web

对于我们的多平台应用商店，我们目前有一个仅适用于 Android 的原生应用。对于其他平台，我们使用非常有限的响应式网络。

外观和感觉可以保持 web，不需要原生。但是我们需要一些无法直接从网络获得的附加功能：

重要的：

*   短信发送*   持久存储

    理想的：

    *   包处理（找出安装了哪些应用程序）*   推送（从桌面发送消息到手机）

    我们需要专门针对**Blackberry 6、7 和 10**，但未来其他平台可能会更有趣（Symbian、IOS、Windows Phone）。

    我们看过的框架：

    **网络工程**

    *   + 支持 BB 6、7 和 10*   + RIM 支持*   +短信发送是可能的*   - 只有BB，没有其他平台

    **同步**

    *   +/- 支持 BB 6 和可能 7*   + 支持许多其他平台*   +短信发送是可能的

    **电话间隙**

    *   + 支持 BB 6、7 和 10*   + 支持许多其他平台*   - SMS 发送可能是不可能的？

    **美孚**

    *   + 支持 BB 6、7 和 10*   + 支持许多平台*   - SMS 发送可能是不可能的？
    1.  如果 SMS 发送与 BB 6 和 7 的任何这些框架一起工作，您是否有经验？10个呢？
    2.  其他功能呢，它们可用吗？
    3.  其他框架建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T05:08:09.780

BlackBerry 的 Phonegap 建立在 WebWorks 之上。所以恕我直言，您应该能够从黑莓上的 phonegap 发送短信。
您是否尝试过此处提供的选项[Calling phone sms api by using phonegap using javascript](https://stackoverflow.com/questions/8254887/calling-phone-sms-api-by-use-of-phonegap-using-javascript)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T20:14:31.737

我们决定使用 WebWorks，因为正如 Vivek 所说，Phonegap 无论如何都是基于 WebWorks for Blackberry 构建的。许多人建议我们远离Phonegap，因为实际上我们不会获得太多的便携性。

对我的问题的回答：
1\. 已实现：SMS 发送很简单，并且在 Blackberry 6 和 7 上运行良好（10 个未测试）
2\. 已实现：持久存储。
- 推送可用：http: [//developer.blackberry.com/html5/api/blackberry.push.html](http://developer.blackberry.com/html5/api/blackberry.push.html)
- 还不知道包处理。
3\. 我们没有看到比 WebWorks、MoSync、Phonegap 和 Mobl 更多的框架。

# python - 从可能不完整的候选列表构建二维网格

> ID：14242772
> 
> 赞同：5
> 
> 时间：2013-01-09T17:18:29.877
> 
> 标签：python, numpy

**问题**

我需要使用一组候选位置（`X`和中的值`Y`）构建一个二维网格。但是，可能存在应该过滤掉的误报候选，以及误报（在给定周围位置值的情况下，需要为预期位置创建位置）。可以预期网格的行和列是直的，并且旋转（如果有的话）很小。

此外，我没有关于 (0, 0) 网格位置的可靠信息。不过我知道：

```
grid_size = (4, 4)

expected_distance = 105 
```

（除外距离只是对网格点间距的粗略估计，应允许在 10% 的范围内变化）。

**示例数据**

这是理想的数据，没有误报，也没有误报。该算法需要能够处理删除多个数据点并添加错误的数据点。

```
X = np.array([61.43283582, 61.56626506, 62.5026738,   65.4028777, 167.03030303, 167.93965517, 170.82191781, 171.37974684, 272.02884615, 272.91089109, 274.1031746, 274.22891566, 378.81553398, 379.39534884, 380.68181818, 382.67164179])

Y = np.array([55.14427861, 160.30120482, 368.80213904, 263.12230216, 55.1030303, 263.64655172, 162.67123288, 371.36708861, 55.59615385, 264.64356436, 368.20634921, 158.37349398, 54.33980583, 160.55813953,  371.72727273,  266.68656716]) 
```

**代码**

以下函数评估候选并返回两个字典。

第一个具有每个候选位置（作为 2 长度元组）作为键和值是相邻位置右侧和下方的 2 长度元组（使用图像显示方式的逻辑）。这些邻居本身要么是 2 长度的元组坐标，要么是`None`.

第二个字典是第一个字典的反向查找，这样每个候选人（职位）都有一个支持它的其他候选人职位的列表。

```
import numpy as np
from collections import defaultdict

def get_neighbour_grid(X, Y, expect_dist=(105, 105)):

    t1 = (expect_dist[0] + expect_dist[1]) / 2.0 * 0.9
    t2 = t1 * 1.222

    def neighbours(x, y):

        nRight = None
        ideal = x + expect_dist[0]
        D = np.sqrt((X - ideal)**2 + (Y - y)**2)
        candidate = (X[D.argmin()], Y[D.argmin()])
        if candidate != (x, y) and x + t2 > candidate[0] > x + t1:
            nRight = candidate

        nBelow = None
        ideal = y + expect_dist[0]
        D = np.sqrt((X - x)**2 + (Y - ideal)**2)
        candidate = (X[D.argmin()], Y[D.argmin()])
        if candidate != (x, y) and y + t2 > candidate[1] > y + t1:
            nBelow = candidate

        return nRight, nBelow

    right_below_neighbours = dict()
    def _default_val(*args):
        return list()
    reverse_lookup = defaultdict(_default_val)

    for pos in np.arange(X.size):

        pos_tuple = (X[pos], Y[pos])
        n  = neighbours(*pos_tuple)
        right_below_neighbours[pos_tuple] = n
        reverse_lookup[n[0]].append(pos_tuple)
        reverse_lookup[n[1]].append(pos_tuple)

    return right_below_neighbours, reverse_lookup 
```

这是我卡住的地方：

*如何使用这些字典和/或`X`构建`Y`最受支持的网格？*

我有一个想法，从 2 个邻居支持的最右下方的候选者开始，并使用`reverse_lookup`字典迭代地创建网格。但是这种设计有几个缺陷，最明显的是我不能指望检测到较低、最右边的候选人及其支持的邻居。

那个代码，虽然它不会运行，因为当我意识到它有多大问题时我放弃了它（`pre_grid = right_below_neighbours`）：

```
def build_grid(pre_grid, reverse_lookup, grid_shape=(4, 4)):

    def _default_val(*args):
        return 0

    grid_pos_support = defaultdict(_default_val)
    unsupported = 0

    for l, b in pre_grid.values():

        if l is not None:
            grid_pos_support[l] += 1
        else:
            unsupported += 1
        if b is not None:
            grid_pos_support[b] += 1
        else:
            unsupported += 1

    well_supported = list()
    for pos in grid_pos_support:
        if grid_pos_support[pos] >= 2:
            well_supported.append(pos)

    well_A = np.asarray(well_supported)
    ur_pos = well_A[well_A.sum(axis=1).argmax()]

    grid = np.zeros(grid_shape + (2,), dtype=np.float)
    grid[-1,-1,:] = ur_pos

    def _iter_build_grid(pos, ref_pos=None):

        isX = pre_grid[tuple(pos)][0] == ref_pos
        if ref_pos is not None:
            oldCoord = map(lambda x: x[0], np.where(grid == ref_pos)[:-1])
            myCoord = (oldCoord[0] - int(isX), oldCoord[1] - int(not isiX))

        for p in reverse_lookup[tuple(pos)]:

            _iter_build_grid(p, pos)

    _iter_build_grid(ur_pos)

    return grid 
```

第一部分可能很有用，因为它总结了每个位置的支持。它还显示了我需要的最终输出（`grid`）：

一个 3D 数组，第一个维度是网格的形状，第三个维度是长度为 2（每个位置的 x 坐标和 y 坐标）。

**回顾**

所以我意识到我的尝试是如何无用的，但我不知道如何对所有候选人进行全局评估，并使用候选人的 x 和 y 值放置最受支持的网格。因为这是一个非常复杂的问题，我真的不希望有人给出一个完整的解决方案（虽然它会很棒），但是任何关于可以使用什么类型的算法或 numpy/scipy 函数的提示都会不胜感激。

最后，很抱歉这是一个有点冗长的问题。

**编辑**

绘制我想要发生的事情：

![它应该如何工作的草图](../Images/ca6d122986748a65e554c85850a51584.png)

星/点是`X`并`Y`绘制了两个修改，我删除了第一个位置并添加了一个错误的位置，以使其成为所寻求算法的完整示例。

换句话说，我想要的是映射红圈位置的新坐标值（写在它们旁边的坐标值），以便我可以从新坐标（例如`(1, 1) -> (170.82191781, 162.67123288)`）中获取旧坐标。我还希望丢弃不接近真实点描述的理想网格的点（如图所示），最后使用理想网格参数（大致）“填充”空的理想网格位置（蓝色圆圈`(0, 0) -> (55, 55)`）。

**解决方案**

我使用@skymandr 提供的代码来获取理想的参数，然后执行以下操作（不是最漂亮的代码，但它有效）。这意味着我不再使用`get_neighbour_grid`-function。：

```
def build_grid(X, Y, x_offset, y_offset, dx, dy, grid_shape=(16,24),
    square_distance_threshold=None):

    if square_distance_threshold is None:
        square_distance_threshold = ((dx + dy) / 2.0 * 0.05) ** 2

    grid = np.zeros(grid_shape + (2,), dtype=np.float)

    D = np.zeros(grid_shape)
    for i in range(grid_shape[0]):
        for j in range(grid_shape[1]):
            D[i,j] = i * (1 + 1.0 / (grid_shape[0] + 1)) + j

    rD = D.ravel().copy()
    rD.sort()

    def find_valid(x, y):

        d = (X - x) ** 2 + (Y - y) ** 2
        valid = d < square_distance_threshold
        if valid.any():
            pos = d == d[valid].min()
            if pos.sum() == 1:
                return X[pos], Y[pos]

        return x, y

    x = x_offset
    y = y_offset
    first_loop = True

    for v in rD:
        #get new position
        coord = np.where(D == v)

        #generate a reference position already passed
        if coord[0][0] > 0:
            old_coord = (coord[0] - 1, coord[1])
        elif coord[1][0] > 0:
            old_coord = (coord[0], coord[1] - 1)

        if not first_loop:
            #calculate ideal step
            x, y = grid[old_coord].ravel()
            x += (coord[0] - old_coord[0]) * dx
            y += (coord[1] - old_coord[1]) * dy

        #modify with observed point close to ideal if exists
        x, y = find_valid(x, y)

        #put in grid
        #print coord, grid[coord].shape
        grid[coord] = np.array((x, y)).reshape(grid[coord].shape)

        first_loop = False

    return grid 
```

它提出了另一个问题：如何很好地沿着 2D 数组的对角线进行迭代，但我认为这本身就值得提出一个问题：[More numpy way of iterate through the 'orthogonal'对角线的 2D 数组](https://stackoverflow.com/questions/14258317/more-numpy-way-of-iterating-through-the-orthogonal-diagonals-of-a-2d-array)

**编辑**

更新了解决方案代码以更好地处理更大的网格大小，以便它使用已传递的相邻网格位置作为所有位置的理想坐标的参考。仍然必须找到一种方法来实现从链接问题中遍历网格的更好方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T20:01:08.220

这是一个相当简单且便宜的解决方案，尽管我不知道它有多强大。

首先，这是一种更好地估计间距的方法：

```
leeway = 1.10

XX = X.reshape((1, X.size))
dX = np.abs(XX - XX.T).reshape((1, X.size ** 2))
dxs = dX[np.where(np.logical_and(dX > expected_distance / leeway,
                                 dX < expected_distance * leeway))]
dx = dxs.mean()

YY = Y.reshape((1, Y.size))
dY = np.abs(YY - YY.T).reshape((1, Y.size ** 2))
dys = dY[np.where(np.logical_and(dY > expected_distance / leeway,
                                 dY < expected_distance * leeway))]
dy = dys.mean() 
```

该代码计算 X 和 Y 的内部差异，并取在所需间距 10% 以内的那些的平均值。

对于第二部分，找到网格的偏移量，可以使用类似的方法：

```
Ndx = np.array([np.arange(grid_size[0])]) * dx
x_offsets = XX - Ndx.T
x_offset = np.median(x_offsets)

Ndy = np.array([np.arange(grid_size[1])]) * dy
y_offsets = YY - Ndy.T
y_offset = np.median(y_offsets) 
```

从本质上讲，这样做是让每个位置`X`“投票”为`NX = grid_size[0]`左下点可能所在的位置，基于对`X - n * dx`点`n = 0`本身`n = 1`的投票，是`dx`对左点的投票等。这样，靠近真实原点的点将获得最多的选票，并且可以使用中位数找到偏移量。

我认为这种方法在所需原点周围足够对称，因此中位数可以用于大多数（如果不是全部）情况。然而，如果存在许多误报，导致中位数由于某种原因不起作用，则可以使用例如直方图方法找到“真实”原点。

# tcl - TCL中的数组操作并将它们分组

> ID：14242778
> 
> 赞同：0
> 
> 时间：2013-01-09T17:18:49.970
> 
> 标签：tcl

我有两个数组

```
id_array   :{2 1 1 2 3 1 2}
type_array :{apple apple orange orange pineapple pineapple pineapple} 
```

我想处理上述数组，并根据我想要分组的 ids 和类型如下：

苹果 2 苹果 1 橙子 1 2 菠萝 3 菠萝 1 2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:35:56.853

欢迎来到堆栈溢出。通常，我们喜欢看到用户尝试解决他们自己的问题，因为它有助于将注意力集中在未来访问者可能会发现有用的特定歧义或误解上。但是，我们通常也愿意提供帮助，无论：

Tcl 有一种有趣的形式`foreach`，可以让我们同时遍历多个列表。

```
set id_array [list 2 1 1 2 3 1 2]
set type_array [list apple apple orange orange pineapple pineapple pineapple]
foreach id $id_array type $type_array {
    lappend hash($type) [list $id $type]
}
foreach name [array names hash] {
    lappend output $hash($name)
}
puts $output 
```

这输出，对我来说，

```
{{1 orange} {2 orange}} {{3 pineapple} {1 pineapple} {2 pineapple}} {{2 apple} {1 apple}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:00:02.213

这与 acheong87 的答案非常相似，但我将使用字典数据结构

```
set types {apple apple orange orange pineapple pineapple pineapple}
set ids {2 1 1 2 3 1 2}

set groups [dict create]
foreach id $ids type $types {
    dict lappend groups $type [list $id $type]
}
puts $groups
# apple {{2 apple} {1 apple}} orange {{1 orange} {2 orange}} pineapple {{3 pineapple} {1 pineapple} {2 pineapple}}

set out [list]
dict for {type sublist} $groups {lappend out $sublist}
puts out
# {{2 apple} {1 apple}} {{1 orange} {2 orange}} {{3 pineapple} {1 pineapple} {2 pineapple}} 
```

* * *

由于要求解释而更新：

```
set ids {2 1 1 2 3 1 2}
set types {apple apple orange orange pineapple pineapple pineapple}
set groups [list]
set current_type ""
set prev_id -1
foreach id $ids type $types {
    if {$type ne $current_type || $id < $prev_id} {
        if {[info exists group]} {lappend groups $group}
        set group [list]
        set current_type $type
    }
    lappend group [list $id $type]
    set prev_id $id
}
lappend groups $group
puts [list $groups] 
```

这输出

```
{{{2 apple}} {{1 apple}} {{1 orange} {2 orange}} {{3 pineapple}} {{1 pineapple} {2 pineapple}}} 
```

请注意与您要求的相比，额外的大括号。最终列表`$groups`是列表列表。每个元素（或“子列表”）都保持一致的结构。我们看：

*   一个包含 1 个元素的列表，其中包含列表 {2 apple}，
*   一个包含 1 个元素的列表，其中包含列表 {1 apple}，
*   一个包含 2 个元素的列表，其中包含列表 {1 orange} 和列表 {2 orange}，
*   一个包含 1 个元素的列表，其中包含列表 {3 pineapple}，以及
*   一个包含 2 个元素的列表，其中包含列表 {1 pineapple} 和列表 {2 pineapple}。

使用此最终列表进行报告的一种方法是：

```
foreach sublist $groups {
    foreach pair $sublist {
        lassign $pair id type
        puts "$id -> $type"
    }
} 
```

印刷

```
2 -> apple
1 -> apple
1 -> orange
2 -> orange
3 -> pineapple
1 -> pineapple
2 -> pineapple 
```

* * *

回答最后一个请求：鉴于上面的最终列表：

```
set answer [list]
foreach sublist $groups {
    lappend answer [lindex $sublist 0 1]
    foreach pair $sublist {lappend answer [lindex $pair 0]}
}
puts [join $answer] 
```

印刷

```
apple 2 apple 1 orange 1 2 pineapple 3 pineapple 1 2 
```

# iphone - UITabBarController中的UINavigationController奇怪的弹出动画

> ID：14242779
> 
> 赞同：2
> 
> 时间：2013-01-09T17:18:53.370
> 
> 标签：iphone, ios, uinavigationcontroller, uitabbarcontroller

当我创建四个导航控制器并将它们添加到 UITabBar 时，如下所示：

```
// Create the root view controllers for the tab bar
firstViewController = [[FirstViewController alloc] init];
secondViewController = [[SecondViewController alloc] init];
thirdViewController = [[ThirdViewController alloc] init];
fourthViewController = [[FourthViewController alloc] init];

// Configure the tab bar
UITabBarController *tabBarController = [[[UITabBarController alloc] init] autorelease];
tabBarController.viewControllers = @[
[[[UINavigationController alloc] initWithRootViewController:firstViewController] autorelease],
[[[UINavigationController alloc] initWithRootViewController:secondViewController] autorelease],
[[[UINavigationController alloc] initWithRootViewController:thirdViewController] autorelease],
[[[UINavigationController alloc] initWithRootViewController:fourthViewController] autorelease]
];
tabBarController.selectedIndex = 1;

self.window.rootViewController = tabBarController; 
```

我遇到了一个问题，即哪个 UINavigationController 在启动时首次可见（在本例中为索引 1）有一个奇怪的“弹出”动画。导航栏中的标题等动画正确，但导航控制器的内容没有动画变化。

选择不同的选项卡，然后返回到原始选项卡可以解决问题。

此外，如果我设置`self.window.rootViewController`为`[[[UINavigationController alloc] initWithRootViewController:secondViewController] autorelease]`使选项卡栏不在等式中，导航控制器就可以正常工作。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-24T12:39:50.673

我遇到了同样的问题，我发现的唯一解决方案是这个小技巧：

将它放在第一个 UITabBarController 视图控制器上的“(void)viewWillAppear”方法中。

```
 UITabBarController * controller = self.tabBarController;
     //Create this BOOL variable on your class and set it to YES on viewDidLoad
     if(firstTimeViewLoaded) {    
        // Simulate a click on other tab item then switch back instantly.
        [controller setSelectedViewController:controller.viewControllers[1]];
        [controller setSelectedViewController:controller.viewControllers[0]];
     }
     firstTimeViewLoaded = NO; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-16T13:58:01.787

我遇到了同样的问题并找到了解决方案，所以对于那些在谷歌搜索时偶然发现此页面的人：

从[Pop 动画在 UITabbarController 的第一个 UINavigationController 中不起作用](https://stackoverflow.com/questions/29793713/pop-animation-is-not-working-in-first-uinavigationcontroller-of-uitabbarcontroll)：

您可能忘记`[super viewDidAppear:animated];`在方法内部编写`-(void)viewDidAppear:(BOOL)animated`：

```
-(void)viewDidAppear:(BOOL)animated{
    [super viewDidAppear:animated];
} 
```

这应该解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:32:07.150

```
 // Create the root view controllers for the tab bar
firstViewController = [[FirstViewController alloc] init];
secondViewController = [[SecondViewController alloc] init];
thirdViewController = [[ThirdViewController alloc] init];
fourthViewController = [[FourthViewController alloc] init];

   UINavigationController *myNavigationController;
    UITabBarController *myTabBarController = [[UITabBarController alloc] init];

    NSMutableArray *myTabs = [[NSMutableArray alloc] init];

    myNavigationController = [[UINavigationController alloc] initWithRootViewController:firstViewController];
    [myTabs addObject:myNavigationController];
//Release
[myNavigationController release];
//Second view
    myNavigationController = [[UINavigationController alloc] initWithRootViewController:secondViewController];
    [myTabs addObject:myNavigationController];
[myNavigationController release];
//And so on with the third and fourth view controller
//...

[tabBarController setViewControllers:myTabs];
//Add the tab bar controller view to the main view
[self.window addSubview:tabBarController.view]; 
```

# c# - 在网格中选择最近添加的名称

> ID：14242782
> 
> 赞同：0
> 
> 时间：2013-01-09T17:18:58.473
> 
> 标签：c#

昨天我遇到了一些问题，但我会更好地解释它

这是代码

```
private void btnAddNewEmployer_Click(object sender, EventArgs e) {
        //This first code, call a Dialog where the user adds a name a another fields
        using (frmEmployersManager employerManager = new frmEmployersManager()) {
            employerManager.Init(true);
            employerManager.ShowDialog();
        }
        //When they click the Save button, the dialog close, and reloads the grid
        ReloadEmployerData(ctlFilter.Filter);

    } 
```

好吧，我真的不知道如何获得最近添加的名称，再次重新加载时在网格中被选中

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:22:19.840

您可以创建一个变量（例如`var recentlyAddedEmployer= employerManager`：）来跟踪最近添加的雇主吗？然后，每当您添加新名称时，将雇主放在最近添加的雇主中

# mysql - 将多个 mySQL 查询放入一个复杂的查询中

> ID：14242787
> 
> 赞同：0
> 
> 时间：2013-01-09T17:19:05.243
> 
> 标签：mysql

我发现很难学习如何在 mySQL 中构建更复杂的查询。

希望通过这个问题，我可以更深入地了解如何在单个查询中开发多级查询。

我有一个标签系统。

```
tbl1: ktbridge
ktbridge_id
threads_id
keywords_id

tbl2: threads
threads_id
subject
etc

tbl3: keywords
keywords_id
keyword
related_id 
```

以上是我目前的设置。

对于数据，我有：

```
INSERT INTO `ktbridge` (`ktbridge_id`, `threads_id`, `keywords_id`) VALUES
(1, 1, 9);

INSERT INTO `keywords` (`keyword_id`, `keyword`, `related_id`) VALUES
(5, 'Sports', 0),
(6, 'Baseball', 5),
(7, 'football', 5),
(8, 'Curling', 5),
(9, 'Pitchers', 6),
(10, 'Catchers', 6),

INSERT INTO `threads` (`threads_id`, `subject`, `body`, `users_id`, `timestamp`, `replystamp`) VALUES
(1, 'Sports - Baseball - Pitchers - Subject', 'Sports - Baseball - Pitchers - Body', 1, '2013-01-09 14:09:40', '0000-00-00 00:00:00'); 
```

这里的目标是返回与提供的关键字 ID 相关的线程。

困难的部分是，如果选择了“棒球”，它会返回棒球线程。但是，如果选择了“sports”，它会根据`keywords`表中的“related_id”返回它下面的所有线程。因此它将返回所有基于棒球、足球和冰壶的线程。

这是一种可能吗？还是需要多次查询？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:51:14.990

它确实需要多个查询，但您可以嵌套它们并从内部选择中进行选择。我认为以下应该有效（或者至少让你开始）。请注意，这是 MySQL，但应该可以移植到其他 RDBM 系统：

```
SELECT * FROM `threads` WHERE `threads`.`threads_id` IN (
  SELECT `threads_id` FROM `ktbridge` WHERE `ktbridge`.`keywords_id` IN (
    SELECT `keywords_id` FROM `keywords` 
      WHERE `keywords`.`id` = 5 OR `keywords`.`related_id` = 5
    )
  ); 
```

[“IN”的 MySQL 文档参考](http://dev.mysql.com/doc/refman/5.0/en//any-in-some-subqueries.html)

# c# - 如何比较两个base64字符串？

> ID：14242789
> 
> 赞同：4
> 
> 时间：2013-01-09T17:19:08.197
> 
> 标签：c#, asp.net

我有一个从图像转换而来的 base64 字符串（源字符串），我需要一个代码来将该字符串与 Web 服务上的另一个 base64 字符串进行比较，并检查哪个字符串与源字符串最相似，我使用的语言是 C# ， 谁能帮我 ？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:27:04.887

您可以轻松地比较字符串，还可以通过在每一端使用 MD5 校验和来节省一些带宽。

找到“最相似之处”取决于您的算法实现。只有你知道“最相似”是什么意思。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-13T19:14:04.483

如果您正在寻找不同的总位数，您可以使用以下内容：

```
private long Base64BitsDifferent(string first64, string second64)
{
    long toReturn = 0;

    byte[] firstBytes = Convert.FromBase64String(first64);
    byte[] secondBytes = Convert.FromBase64String(second64);
    byte different = 0;

    for (int index = 0; index < firstBytes.Length; index++) {
        different = (firstBytes[index] ^ secondBytes[index]);

        while (different != 0) {
            toReturn++;
            different &= different - 1;
        }
    }

    return toReturn;
} 
```

假设两个 Base64 字符串中表示的字节数相等。

# jquery - 固定右侧 Div 滚动

> ID：14242792
> 
> 赞同：0
> 
> 时间：2013-01-09T17:19:14.573
> 
> 标签：jquery, html, css, twitter-bootstrap

我计划在左侧 div 上显示一个右侧导航栏和内容。我尝试搜索提出的类似问题并尝试实施解决方案，但他们似乎没有回答我的问题。如果有人能指出我正确的方向，我将不胜感激！！:)

更新：http: [//jsfiddle.net/allenchuang/REWZ4/3/](http://jsfiddle.net/allenchuang/REWZ4/3/)。这是我到目前为止所拥有的，但是当调整窗口大小并且需要滚动时，滚动条会出现在橙色 div 旁边，而不是在浏览器窗口的最右侧。有没有办法绕过它？

HTML

```
<body>
  <div id="page">
    <header id="sidebar">
        <h1>Sidebar (Fixed Width)</h1>

      <nav role="navigation">
        <ul>
          <li><a href="#">Link One</a>
          </li>
          <li><a href="#">Link Two</a>
          </li>
          <li><a href="#">Link Three</a>
          </li>
        </ul>
      </nav>
    </header>
    <article id="contentWrapper" role="main">
      <section id="content">
            <h1>Content (Fluid Width)</h1>

        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat.</p>
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum
          dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
          proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
          cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat
          non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat.</p>
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum
          dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
          proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
          cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat
          non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat.</p>
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum
          dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
          proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
          cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat
          non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
      </section>
    </article>
  </div>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:27:48.317

```
.span9 {
float: left;
}

.span3 {
float: right;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T20:24:07.470

只需将此代码提供给需要 100% 高度的列。

```
span
{
  position:absolute;
  height:100%;
} 
```

另请注意，父元素的高度应为 100%。您通常可以通过以下方式设置：

```
html, body
{
  width:100%;
  height:100%;
} 
```

# signals - 从方波/三角波信号中产生锯齿波信号

> ID：14242794
> 
> 赞同：-2
> 
> 时间：2013-01-09T17:19:24.343
> 
> 标签：signals, comparator, integrator

我想创建一个锯齿信号发生器。我知道，如何构建比较器来创建方波。我也知道，如何通过将比较器输出与 o amp 积分器集成来获得三角信号。

我不知道也不知道如何从方波/三角波中获得锯齿信号。有人可以解释一下吗。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:42:04.003

这个怎么样：

从周期为 T 的方波开始。对其进行微分以产生尖峰，交替正负。使用*这些*来重置集成 DC 信号的积分器。这将产生周期为 T/2 的锯齿波。

如果您想要周期为 T 的锯齿波，请使用二极管消除负尖峰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:22:58.163

积分方波的绝对值；每次方波由高变低时，复位积分器。

# c# - 从 Windows 8 应用商店应用项目文件夹中移动 App.xaml

> ID：14242796
> 
> 赞同：2
> 
> 时间：2013-01-09T17:19:30.397
> 
> 标签：c#, .net, wpf, xaml, windows-8

我正在开发一个 Windows 8 应用商店应用项目 (C#)。

应用程序项目文件位于根文件夹中，每个受支持平台的特定文件都放置在其自己的文件夹中：

```
 ROOT  
  |-- Application.Windows8.csproj  
  |-- Application.OtherPlatform.csproj
  |--
  |-- Windows8
          |-- App.xaml
          |-- Other Win8 related files 
```

我的 Windows8 项目包括 Windows8 文件夹下的所有文件，包括 App.xaml。

尝试使用此结构时，我在构建项目时遇到错误：

*应用程序主文件必须命名为 App.xaml*

**是否可以将 App.xaml 保存在与*csproj*文件不同的文件夹中？**

**更新：**

我在 MS Connect 上打开了一张票，因为文档从未指定此文件必须位于根文件夹中：[http ://connect.microsoft.com/VisualStudio/feedback/details/776168/windows-8- store-app-project-doesnt-compile-if-app-xaml-is-placed-in-a-subfolder](http://connect.microsoft.com/VisualStudio/feedback/details/776168/windows-8-store-app-project-doesnt-compile-if-app-xaml-is-placed-in-a-subfolder)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:35:05.247

由于 Windows Store 应用程序的限制，这是不可能的。

从[MSDN -> 应用程序类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.application)

> 注意应用程序主文件必须命名为 App.xaml。

普通的 WPF 应用程序没有这样的限制。

# windows-7 - 如何使用批处理或 vbscript 在 WinPE 中屏蔽/隐藏密码条目？

> ID：14242798
> 
> 赞同：2
> 
> 时间：2013-01-09T17:19:33.493
> 
> 标签：windows-7, batch-file, vbscript, passwords, winpe

我需要在键入时不显示密码输入。它可以保持空白或使用 * 字符。它可以是批处理或 vbscript，并且只能在引导到 WinPE 时使用。在旧版本中，我们使用了这个 vbscript

```
CreateObject("ScriptPW.Password") 
```

但是，我发现 Windows 7 不再提供此功能。我读到它是因为不再支持文件 scriptpw.dll。这需要在没有外部文件或第 3 方可执行文件的情况下完成。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-31T02:10:40.940

我也有类似的情况。我创建了一个 x86 WinPE 启动盘，用于从操作系统为 FUBAR 的加密硬盘驱动器中恢复数据。我使用的是 Windows ADK 8.1。

可悲的是，我发现WinPE中的**网络使用被破坏了。**当你想映射一个共享文件夹时，你必须在命令字符串中输入你的密码；它不会提示您输入密码并屏蔽密码。鉴于我在安全组织中，指示人们在可见的命令字符串中输入他们的密码不会很好......

我能够在我的自定义启动磁盘中包含 scriptpw.dll，并且运行 regsvr32 来注册它*似乎*可以工作，但是，当我运行我为映射驱动器编写的 vbscript 时，当它到达我调用的代码部分时ScriptPW.Password.GetPassword() 提示输入用户密码，它仍然显示键入的字符。该脚本在任何完整版本的 x86 Windows 上都非常有效。

# c++ - 退出时正确使用返回错误码

> ID：14242801
> 
> 赞同：1
> 
> 时间：2013-01-09T17:19:41.850
> 
> 标签：c++, c

对于 Windows（非 GUI）中的 C/C++ 应用程序，不同故障的正确错误代码列表应该是什么？我见过各种列表，例如来自 IBM 和其他人的列表，但我想知道是否对程序退出时提供给用户的典型错误代码达成了某种共识。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:24:48.207

参数有三个可移植值`exit`：`0`、`EXIT_FAILURE`和`EXIT_SUCCESS`。`0`相当于`EXIT_SUCCESS`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:23:05.487

来自：[http ://www.cplusplus.com/reference/cstdlib/EXIT_SUCCESS/](http://www.cplusplus.com/reference/cstdlib/EXIT_SUCCESS/)

成功退出程序：

```
exit(EXIT_SUCCESS); 
```

对于程序失败退出：

```
exit(EXIT_FAILURE); 
```

来自[维基百科](http://en.wikipedia.org/wiki/Errorlevel#DOS)：

> 除了宏 EXIT_SUCCESS 和 EXIT_FAILURE 之外，C 标准没有定义返回码的含义。返回代码的使用规则在不同平台上有所不同（请参阅特定于平台的部分）。

在维基百科中：

> **DOS**
> 
> 在 DOS 术语中，错误级别是可执行程序或子例程返回的整数退出代码。错误级别通常在 0 到 255 之间。在 DOS 中，只有 256 个错误代码可用。
> 
> **视窗**
> 
> Windows 使用 32 位有符号整数作为退出代码。[9] 如果进程初始化失败，可能会返回 Windows 系统错误代码。 [10] Windows 系统错误代码可在线获取。[11]
> 
> 例如，在从 DOS 继承的错误级别术语中，命令行解释器 CMD.exe 直接引用了退出代码。.NET Framework 进程和 Windows PowerShell 将其称为 Process 对象的 ExitCode 属性。

根据维基百科，以下[链接](http://www.hiteksoftware.com/mize/Knowledge/articles/049.htm)包含与 windows 平台相关的错误代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:24:21.077

据我所知，没有这样的标准。唯一的标准是返回 EXIT_SUCCESS（来自 stdlib.h），以防它成功返回。这有助于调用您的程序的脚本检查是否成功。您返回的错误代码需要为您的程序详细记录。POSIX 建议从 main 中返回 0-255。通常 0 是 EXIT_SUCCESS。

如果您只有一个特定的失败返回，您可以使用 EXIT_FAILURE。

# ios - 使用 viewBox 时 UIWebView 中显示的 SVG 图形的垂直间距问题

> ID：14242806
> 
> 赞同：3
> 
> 时间：2013-01-09T17:19:48.677
> 
> 标签：ios, uiwebview, svg, mobile-safari

我正在尝试在 iOS 的 UIWebView 中显示 SVG 图形。然而，我使用网络视图的图像在图形上方和下方添加了大量的空白，100 像素。导致图像垂直占据屏幕的一半，您必须滚动才能完全看到它。

我已经在这个问题上进行了高低搜索，并尝试了很多很多东西。我有一个“足够好”的解决方法，我将在这里分享。我在问这个问题，以防有人有更好的解决方案并帮助遇到同样问题的其他人。

我使用的真实图像是由另一个工具生成的乐谱（由inkscape 处理的lilypond）。然而，这个宽度是高度两倍的简单矩形显示了完全相同的问题。

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.2" viewBox="0 0 20 10" width="100%" height="100%">
  <rect height="10" style="fill:currentColor" width="20" x="0" y="0" />
</svg> 
```

如果您在 Safari 或 Chrome 中查看它，那么它会完美显示，填满窗口并从顶部开始。但是在 UIWebView 上面和下面都有大量的空白。如果您删除 viewBox 属性，那么随机的额外空白就会消失，但这没有用，因为图形很小。无论如何，SVG是正确的。调用返回 1024x1120 `[webView sizeThatFits:CGSizeZero]`。`webViewDidFinishLoad`不是我期望的 1024x512

就我而言，我让 UIWebView 显示原始 SVG。这是我尝试过的没有效果的事情。

*   在 HTML 中包装 SVG
*   用 HTML 包装 SVG 并添加以下 CSS：

    ```
    * {
    margin: 0;
    padding: 0;
    }
    body { overflow: hidden; } 
    ```

*   将以下代码放入`webViewDidFinishLoading`StackOverflow 上的其他地方。

    ```
    - (void)webViewDidFinishLoad:(UIWebView *)webView {
        CGRect frame = webView.frame;
        frame.size.height = 1;
        webView.frame = frame;
        CGSize fittingSize = [webView sizeThatFits:CGSizeZero];
        frame.size = fittingSize;
        webView.frame = frame;
    } 
    ```

`preserveAspectRatio="xMinYMin meet"`部分解决方法是在 svg 标记中添加属性。

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.2" 
  preserveAspectRatio="xMinYMin meet" viewBox="0 0 20 10" width="100%" height="100%">
  <rect height="10" style="fill:currentColor" width="20" x="0" y="0" />
</svg> 
```

这将删除图像顶部多余的空白，但将其留在底部。这只是部分解决方法，就好像它最初看起来是正确的一样，当您不应该滚动时，您仍然可以滚动。因此，我仍然需要禁用滚动以使其看起来正确。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:20:41.113

我使用了您的图像，在 iOS5.1 和 6 中，我可以使图像完全适合或左上对齐。我用

```
preserveAspectRatio="xMinYMin meet" 
```

适合宽度并粘在顶部，以及适合窗户：

```
preserveAspectRatio="xMinYMin slice" 
```

此外，为了允许缩放，我在 HTML 中嵌入了 SVG 并添加了一个元标记。初始比例适合视口。

```
<meta name='viewport' content='initial-scale=1.0; user-scalable=1; maximum-scale=20.0'/> 
```

作为参考，您需要另外将 webView 设置为 scalesPageToFit，并且您需要使用正确的 mimeType 设置 webView。像这样：

```
webView.scalesPageToFit = YES;
[webView   loadData:[htmlPage dataUsingEncoding:NSUTF8StringEncoding]
           MIMEType:@"image/svg+xml"
   textEncodingName:@"UTF-8"
            baseURL:baseURL]; 
```

最终提示：“xMidYMid”！=“xMidyMid”。您会注意到 iOS 6.0 的差异没有问题，但规范说“xMidYMid”，而这正是 iOS 5.1 所要求的。见[这里](https://developer.mozilla.org/en-US/docs/SVG/Attribute/preserveAspectRatio)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T11:15:36.000

我的部分但不是全部问题是由于错误设置 UIWebView 尺寸。我试图通过使用此代码将 UIWebView 设置为全屏。

```
CGRect screenFrame = [UIScreen mainScreen].applicationFrame;
self.webView = [[UIWebView alloc] initWithFrame:screenFrame];
[self.webView setAutoresizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight]; 
```

事实证明这是不对的，因为应用程序框架总是以纵向返回，而我正在横向查看。所以 webview 被设置得太高太薄了，那么它必须被自动调整为全宽。因此，巨大的垂直空白似乎只是图像的中心。

然而，多余的垂直空白的问题仍然存在，只是少了很多。所以我坚持使用添加`preserveAspectRatio="xMinYMin meet"`SVG 的解决方案。

从尝试 Chris Vander Mey 的建议中获得有趣的新知识。这两个显示 SVG 的调用是相同的，除了 loadData 边对边显示图像，但 loadHTMLString 给了它默认的填充。

```
[self.webView loadData:[svgContent dataUsingEncoding:NSUTF8StringEncoding]
              MIMEType:@"image/svg+xml" textEncodingName:@"UTF-8" baseURL:baseURL];

[self.webView loadHTMLString:svgContent baseURL:baseURL]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T13:35:23.423

我刚刚遇到了类似的问题。不知何故，首先加载有`about:blank`帮助……</p>

# atg - 通过 gsa-template 将数据插入到 atg sql 并恢复错误

> ID：14242807
> 
> 赞同：0
> 
> 时间：2013-01-09T17:19:51.937
> 
> 标签：atg

我目前正在尝试通过 xml（在 TemplateParser 中调用 inputFiles）将大量数据插入到我的存储库中。但是，当单个记录引发错误（例如键约束）时，将不再处理任何记录。我知道清理数据以免插入错误的行会很好，但是因为我无法在测试环境中始终如一地控制我们的数据子集，所以我不能保证外部约束引用的表将具有一致的数据.

如果我将整个内容包装在事务中，则不会插入任何记录，如果我用 import-items 包装它，则由于表上的空约束（import-items 尝试插入部分记录）而失败。将每个元素包装在它自己的事务中不会捕获错误，它将每一行插入到坏行，但之后什么都没有。

在将数据导入存储库时，是否有另一种方法可以在错误情况下恢复？或者在插入之前检查 gsa 模板中的约束的方法？

参考文件

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE gsa-template SYSTEM "dynamosystemresource:/atg/dtds/gsa/gsa_1.0.dtd">
<gsa-template>
<transaction>
<add-item item-descriptor="vendorSku">
    <set-property name="skuItem"><![CDATA[0065-OC-OS]]></set-property>
    <set-property name="vendorSkuId"><![CDATA[853-6520]]></set-property>
    <set-property name="vendorItem"><![CDATA[781]]></set-property>
</add-item>
<add-item item-descriptor="vendorSku">
    <set-property name="skuItem"><![CDATA[0189-CRGONET-ONSI]]></set-property>
    <set-property name="vendorSkuId"><![CDATA[8007146]]></set-property>
    <set-property name="vendorItem"><![CDATA[76]]></set-property>
</add-item>
etc..
</gsa-template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:15:27.960

据我目前所能找到的，如果不重载内部 ATG 方法，就不可能做到这一点。但是，我确实发现将数据插入存储库对不良数据、重复项等更具弹性……如果您在更新期间明确设置项目描述符而不是允许存储库执行此操作。

所以在上面的例子中，如果 vendorSku 的 id 字段是 skuItem 插入语句可以修改为：

```
<add-item item-descriptor="vendorSku" id="0189-CRGONET-ONSI">
    <set-property name="vendorSkuId"><![CDATA[8007146]]></set-property>
    <set-property name="vendorItem"><![CDATA[76]]></set-property>
</add-item> 
```

这样，如果文件被多次添加，它将更新现有记录，而不是因为重复而引发错误。您还可以使用`<update-item>`将 add 标志设置为 true 的标记来实现相同的行为。

# android - Android Preference Activity - R 无法解析为变量

> ID：14242812
> 
> 赞同：1
> 
> 时间：2013-01-09T17:20:05.197
> 
> 标签：android, android-preferences

我正在尝试创建首选项活动，但出现以下错误。

```
R cannot be resolved to a variable 
```

**SettingsPreference.java**

```
package com.m7.nomad.preferences;

import android.os.Bundle;
import android.preference.PreferenceActivity;

public class SettingsPreference extends PreferenceActivity  {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences_settings);
    }
} 
```

**res/xml/preferences_settings.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <PreferenceScreen
        android:key="settingsPrefScreen"
        android:title="Account Settings" >
        <Preference
            android:key="profilePref"
            android:title="Your Profile" />
        <Preference
            android:key="passwordPref"
            android:title="Change Password" />
        <Preference
            android:key="privacyPref"
            android:title="Privacy Settings" />
    </PreferenceScreen>

    <Preference
        android:key="notificationPref"
        android:title="Notification Settings" />
    <Preference
        android:key="socialPref"
        android:summary="Facebook, Foursquare, Twitter"
        android:title="Social Connect" />

    <PreferenceCategory android:title="Device Settings" >
        <CheckBoxPreference
            android:defaultValue="true"
            android:key="pushPref"
            android:summary="Show on status bar when new notifications are recieved"
            android:title="Push Notifications" />
        <CheckBoxPreference
            android:defaultValue="true"
            android:dependency="pushPref"
            android:key="vibratePref"
            android:summary="Vibrate on incoming notifications"
            android:title="Vibrate" />
        <CheckBoxPreference
            android:defaultValue="true"
            android:dependency="pushPref"
            android:key="lightPref"
            android:summary="Pulse light for notification"
            android:title="Notification Light" />
    </PreferenceCategory>
    <PreferenceCategory android:title="Friends" >
        <Preference
            android:key="addFriendsPref"
            android:summary="Find friends on Bakasura"
            android:title="Add friends" />
        <Preference
            android:key="friendReqPref"
            android:summary="Approve pending friend requests"
            android:title="Friend  Requests" />
    </PreferenceCategory>
    <PreferenceCategory android:title="Troubleshooting" >
        <Preference
            android:key="helpPref"
            android:summary="Get help using Bakasura!"
            android:title="Help" />
        <Preference
            android:key="reportPref"
            android:summary="Send a force-close report by email"
            android:title="Send report" />
        <Preference
            android:key="cachePref"
            android:summary="sdfas"
            android:title="asdsa" />
    </PreferenceCategory>
    <PreferenceCategory android:title="About" >
        <PreferenceScreen
            android:key="aboutPrefScreen"
            android:summary="About, Terms of Service, Privacy Policy"
            android:title="About" >
            <Preference
                android:key="versionPref"
                android:summary="sadsa"
                android:title="Version" />

            <PreferenceCategory android:title="Legal" >
                <Preference
                    android:key="tosPref"
                    android:title="Terms of Service" />
                <Preference
                    android:key="privacyPolicyPref"
                    android:title="Privacy Policy" />
            </PreferenceCategory>
        </PreferenceScreen>
    </PreferenceCategory>
</PreferenceScreen> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:26:26.120

清理项目重试，否则再试

```
import package.name.R 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T04:14:54.640

我花了很多时间寻找同样的答案。导入 com.package.name.R; 是什么最终修复它。感谢您对此的帮助。

# javascript - 如何在循环中填充 HTML 列表

> ID：14242813
> 
> 赞同：0
> 
> 时间：2013-01-09T17:20:05.787
> 
> 标签：javascript, jquery, html, json

我有一个 Html 列表，我从 REST 调用接收数据作为 JSON 字典，我遍历并获取它们的值。但我找不到如何使用循环中的项目生成下面的 Html。

```
<div class="container">
<ul role="list">
    <li class="infoBasic" role="listitem">
        <div class="date">20-12-2012</div>
        <div class="ammount">-&euro;4,25</div>
    </li>
    <li class="infoDetails" role="listitem">
        <div class="place">data</div>
        <div class="category">data</div>
        <div class="description_title">data</div>
        <div class="description">data</div>
    </li>

   //repeat this for multi items received from REST

</ul> 
```

```
$.ajax
  ({

   success: function (data){                    
        var transactions=data['transactions'];      

        $.each( transactions, function( key, value ) {
             $.each( value, function( key, value) {

                //here how to set/create the appropriate div elements(like above) 
                // with the values I get here in a loop? 

             });                        
      }); 
```

编辑下面的一些解决方案很好，但我不想要我的对象数组中的所有值，我怎样才能只将这些项目（日期、金额、地点..等）获取到 html div 并忽略字典中的其他项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:23:38.847

```
$.each( value, function( key, value) {

            //here how to set/create the appropriate div elements(like above) 
            // with the values I get here in a loop? 

            $(".infoDetails").append("<div class='" + key + "'>" + value + "</div>");
         }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:29:49.840

您可以使用..

```
 var data = "";

   $.each( transactions, function( key1, value1 ) {
         data +="<li class ='"+ key1 +"' role='listitem'>";

             $.each( value1, function( key, value) {
                 data +="<div class ='"+ key +"'>"+value+"</div>"; 
             });
     });  

   $("ul").html(data); // selecting ul element and then embedding html into it.. 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-09T17:25:25.070

试试这个......取一个变量说html......遍历json数组......在列表中添加项目......并将整个html放在一个div中......

```
var html='<ul>';
$.ajax
  ({

   success: function (data){                    
        var transactions=data['transactions'];      

        $.each( transactions, function( key, value ) {
             $.each( value, function( key, value) { 
                html+='<li class="'+key+'">'+value+'</li>';
             });                        
      });
       } 
 }); 
html+='</ul>';
$('#idofdiv').html(html); 
```

# c# - 月份和年份列表

> ID：14242825
> 
> 赞同：0
> 
> 时间：2013-01-09T17:20:50.720
> 
> 标签：c#, asp.net-mvc, linq, razor, asp.net-mvc-4

我正在尝试创建一个存档，括号内是每月的项目数，我想出了这样的东西：-

```
@{
  var startMonth = DateTime.Now.Month;
  var startYear = DateTime.Now.Year;
  var blogList = Model.BlogViewModel.BlogArchiveList;
  var monthName = DateTime.Now.ToString("MMMM");
  var Counter = 0;
}
@foreach (var item in blogList)
{
  if (item.BlogDate.Year == startYear)
  {
      if (item.BlogDate.Month == startMonth)
      {
          Counter = Counter + 1;
      }
      else
      {
          Counter = 1;
          startMonth = item.BlogDate.Month;
      }
  }
  else
  {
      Counter = 1;
      startYear = item.BlogDate.Year;
      startMonth = item.BlogDate.Month;
  }
  monthName = CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(startMonth);
  @Html.ActionLink(monthName + " " +  startYear + "("+ Counter +")", "Archive", new  
  {
     year=startYear, month=startMonth}) <br/>
  } 
```

尽管这似乎可行，但如果有多个条目，我会多次写入月份。

如何避免多次写入该月，同时仍获得该月的帖子数？

感谢您的帮助和时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:24:31.787

尝试使用下一个代码：

```
var statistics = 
     blogList.GroupBy(val => new {val.BlogDate.Month, val.BlogDate.Year})
             .OrderBy(item => item.Key.Year)
             .ThenBy(item => item.Key.Month)
             .Select (grouped => new {Month = grouped.Key.Month, Year = grouped.Key.Year, Count = grouped.Count() });

foreach (var item in statistics)
{
    var monthName = CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(item.Month);
    Console.WriteLine (string.Format("{0} {1} ({2})", monthName, item.Year, item.Count));   
} 
```

打印正确的结果，例如

```
December 2012 (3)
January 2013 (4) 
```

# windows-installer - 使用标准补丁时如何检测以前的版本

> ID：14242832
> 
> 赞同：2
> 
> 时间：2013-01-09T17:21:08.200
> 
> 标签：windows-installer, installshield, patch, installshield-2011

我已经使用 InstallShield 2011 Basic MSI 成功创建了标准补丁。我无法检测到已安装的应用程序的早期版本。例如，我有一个名为 XYZ 的应用程序，其基本版本为 3.7.0.188，我想用 3.7.0.201 版本对其进行修补。我可以成功地将这个补丁应用到 3.7.0.188 基础上。现在，如果我安装早期版本的应用程序 XYZ (3.7.0.173) 并尝试应用我的补丁，它会失败。我希望能够检测到这一点并显示一个无法完成的对话框，还是我的想法都错了？这样做的正确方法是什么？我觉得 InstallShield 应该能够天生做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T08:44:48.923

通常，当您尝试将补丁应用到与其目标不匹配的版本时，Windows Installer 应该会给您类似“Windows Installer 服务无法安装升级补丁，因为要升级的程序可能丢失，或者升级补丁可能会更新程序的不同版本...”您没有收到此消息吗？

据我所知，这是由操作系统控制的，而不是由 InstallShield 控制的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:12:39.590

要探索的一件事是，如果您使用次要升级补丁而不是上面描述的小更新补丁，您是否会看到不同的行为。由于您尚未更改 ProductVersion 的前三个部分之一，因此您正在交付一个小更新。这些更难推理，因为 Windows Installer 通常认为这些版本是等效的，并且根本不会做任何事情来防止您走“错误”的方向。

请参阅[修补和升级](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370579.aspx)以及有关小更新和小升级的链接文章。

# python - Python 的 ElementTree.XML() 和 ElementTree.fromstring 有什么区别？

> ID：14242834
> 
> 赞同：2
> 
> 时间：2013-01-09T17:21:13.880
> 
> 标签：python, xml-parsing, elementtree

很直接的问题。给定字符串

```
s = "<blah x='true'><img src='a.jpg' /><a><b></b></a></blah>" 
```

以下两个 python 命令都产生相同的输出：

```
>>> E.tostring(E.fromstring(s))
'<blah x="true"><img src="a.jpg" /><a><b /></a></blah>'
>>> E.tostring(E.XML(s))
'<blah x="true"><img src="a.jpg" /><a><b /></a></blah>' 
```

那么为什么有两个命令呢？我注意到在 ElementTree 的 Python 2.7 文档中，对 的引用`fromstring()`包含短语“与 XML() 相同”。所以如果它是相同的，为什么包括它？

我注意到的唯一区别是最近版本的 Python 已将可选`parser`参数添加到`XML()`但未添加到`fromstring()`. 为什么？命令的工作方式实际上是否存在细微差别，或者为什么有两个命令显然相同？只是为了方便吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:31:15.197

`fromstring`与 完全相同`XML`。事实上，它是这样定义的：

```
##
# Parses an XML document from a string constant.  Same as {@link #XML}.
#
# @def fromstring(text)
# @param source A string containing XML data.
# @return An Element instance.
# @defreturn Element

fromstring = XML 
```

您可以在[此处](http://svn.effbot.org/public/tags/elementtree-1.3a3-20070912/elementtree/ElementTree.py)查看来源。我认为它是对`tostring`功能的补充。

# installation - ImageMagick 和 Typo3

> ID：14242840
> 
> 赞同：0
> 
> 时间：2013-01-09T17:21:36.210
> 
> 标签：installation, imagemagick, typo3, graphicsmagick

[TYPO3](https://typo3.org/about/typo3-the-cms/system-requirements/)的系统要求表明我可以使用 GraphicsMagic 或 ImageMagick。在主机上，我收到以下错误`No ImageMagick installation available`。

我试图用这个问题[验证 ImageMagick 安装](https://stackoverflow.com/q/4208253/426227)是否安装了 ImageMagick 并且我没有得到版本输出。

还有一些功能被禁用，例如`exec()`. 安装工具写道

> 可能由于安全风险，这些功能被禁用，并且很可能该列表将包含 exec() 之类的功能，TYPO3 使用该功能来访问 ImageMagick。

`im_version_5`设置为`im6`。在我有 ImageMagick 之前，但现在网络空间是另一个。因此，我收到此警告`Image Processing`：

> ImageMagick()的版本和[GFX][im_version_5](im6)的配置不匹配

现在我无法进行测试，因为它们被跳过了。此外，如果用户上传照片，他将无法在后端看到预览图像。

我目前的设置：

```
[GFX][gdlib] = 1
[GFX][im] = 0 
```

因此启用了 GraphicsMagick 而禁用了 ImageMagick。但它仍然会产生问题。

所以我该怎么做？

*   我应该要求宿主启用`exec()`吗？
*   还是没有安装 ImageMagick？
*   其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:24:06.890

您应该询问您的主机是否安装了 ImageMagick/GraphicsMagick 以及是否安装了正确的路径。还要询问 exec() 是否被禁用。

# c# - 从表中选择所有数据，但为特定列值添加计数字段

> ID：14242843
> 
> 赞同：1
> 
> 时间：2013-01-09T17:21:42.907
> 
> 标签：c#, sql, linq

我想`SELECT`通过将 a 添加到结果中来计算特定表中的所有数据，`countField`该结果计算相应值`Item.ResourceId`在所有结果中存在的次数。

```
SELECT Name, ResourceId, (SELECT COUNT(ResourceId) FROM Item GROUP BY ResourceId) AS foo
FROM Item 
```

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:09:57.480

如果这是您想要的查询

```
SELECT Name, ResourceId, COUNT(*) FROM Item GROUP BY Name, ResourceId; 
```

它按如下方式转换为 LINQ。

```
var result = items.GroupBy(item => new { item.Name, item.ResourceId })
                  .Select(group => new { group.Key.Name, group.Key.ResourceId, Count = group.Count() })
                  .ToList(); 
```

或者你想要这个查询？

```
SELECT Name,
       ResourceId,
       (SELECT COUNT(*) FROM Item y WHERE y.ResourceId = x.ResourceId)
FROM
       Item x; 
```

这将转换为以下 LINQ 表达式。

```
var result = items.Select(item => new
             {
                 item.Name,
                 item.ResourceId,
                 Count = items.Count(x => x.ResourceId == item.ResourceId)
             }).ToList(); 
```

给定以下输入

```
Name   ResourceId
-----------------
 A      1
 A      1
 B      1
 B      2
 B      2
 C      3 
```

第一个查询产生

```
Name   ResourceId   Count
-------------------------
 A      1            2
 B      1            1
 B      2            2
 C      3            1 
```

而第二个查询产生了这个。

```
Name   ResourceId   Count
-------------------------
 A      1            3
 A      1            3
 B      1            3
 B      2            2
 B      2            2
 C      3            1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:24:45.370

这行得通吗？

SELECT resourceId, count(resourceId) FROM Item GROUP BY resourceId

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:18:06.653

SELECT Name, ResourceId, ResourceIdCount FROM Item i INNER JOIN (SELECT ResourceId, COUNT(ResourceId) AS ResourceIdCount FROM Item GROUP BY ResourceId) ic ON i.ResourceId = ic.ResourceId

# outlook - 添加到 Outlook 2007 中的消息功能区

> ID：14242852
> 
> 赞同：2
> 
> 时间：2013-01-09T17:22:08.283
> 
> 标签：outlook, outlook-addin, outlook-2007

我的组织正在使用 Office 2007，我们希望在电子邮件表单上添加一个按钮，我们可以用它来替换默认的发送按钮。这将是发送加密的电子邮件（通过在消息中添加特定的单词）然后发送。

我已经研究过创建 Outlook 加载项，但我们遇到的问题是加载项不会立即对用户可见（因为它们位于加载项选项卡上）。

编写电子邮件时，是否可以创建加载项并使其显示在“消息”选项卡（即第一个选项卡）上？

另一种可能的解决方案是覆盖默认的电子邮件表单，以便在那里有额外的发送按钮，但是我担心覆盖默认表单，因为听说过这样做会出现问题。

我很感激任何想法或建议。

非常感谢，

格雷厄姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:03:27.230

在 Visual Studio 2010 中，创建一个 office 插件项目，并添加新的“功能区（Visual Designer）”。选中 Microsoft.Outlook.Mail.Compose 以在您的撰写窗口中显示功能区。

![设置色带类型](../Images/0e5096244a8b7b8cc7b77b69c8001243.png)

根据需要创建选项卡和控件。

如果要访问当前消息的内容，请从`Microsoft.Office.Interop.Outlook.Inspector`

```
 Microsoft.Office.Interop.Outlook.Inspector currentInspector = this.Context as Microsoft.Office.Interop.Outlook.Inspector;

    if (currentInspector == null)
    {
        return;
    }

    Microsoft.Office.Interop.Outlook.MailItem currentMailItem =
        currentInspector.CurrentItem as Microsoft.Office.Interop.Outlook.MailItem;
    if (currentMailItem != null)
    {
        currentMailItem.HTMLBody = "<html><body><h1>Hello</h1><p>Wor<strong>ld!</strong></p></body></html>";
        System.Windows.Forms.MessageBox.Show("The Ribbon is hosted in a mail item.");
        return;
    } 
```

*代码引用自[http://social.msdn.microsoft.com/forums/en-US/vsto/thread/60c5f2b2-6269-4609-9de1-b7c8f65c209a/](http://social.msdn.microsoft.com/forums/en-US/vsto/thread/60c5f2b2-6269-4609-9de1-b7c8f65c209a/)*

我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T20:23:13.323

我不确定你的意思 - 加载项本身对最终用户是不可见的，只有它的 UI 是。该 UI 是什么，由插件来确定。

您的加载项使用什么农事？你实现了 IRibbonExtnsibility 接口吗？ [http://msdn.microsoft.com/en-us/library/office/ff868522.aspx](http://msdn.microsoft.com/en-us/library/office/ff868522.aspx)

# spring - Primefaces 自动完成 ClassCastException

> ID：14242860
> 
> 赞同：0
> 
> 时间：2013-01-09T17:22:32.310
> 
> 标签：spring, hibernate, jsf, primefaces

我正在使用 Spring 3、Hibernate 4 和 JSF 2.0，并且正在尝试进行 primefaces 自动完成。

我在 DAO 类中有以下内容可以从 Oracle 函数中获取值

```
@Override
    public List<EmployeeDetail> getEmployeeDetails(String employeeNumber) {

        List query = (List)entityManager.createNamedQuery("getEmp")
                .setParameter("empNumber", employeeNumber)
                .getSingleResult();

        return query;

    } 
```

转换器类

```
public EmployeeNameConverter(

            List<EmployeeDetail> employeeDB, EmployeeDetailService instance,
                    String employeeNumber) {
                if (employeeDetailService == null) {
                    employeeDetailService = instance;
                }
                if (param == null) {
                    param = employeeNumber;
                }
                this.employeeDB = employeeDB;
            }

@Override
    public Object getAsObject(FacesContext arg0, UIComponent arg1,
            String submittedValue) {
        if (submittedValue.trim().equals("")) {
            return null;
        } else {
            try {
                // int number = Integer.parseInt(submittedValue);
                employeeDB = getEmployeeDetailService().getEmployeeDetails(param);
                for (EmployeeDetail emp : employeeDB) {
                    if (emp.getEmployeeNumber() == submittedValue) {
                        return emp;
                    }
                }

            } catch (NumberFormatException exception) {
                throw new ConverterException(new FacesMessage(
                        FacesMessage.SEVERITY_ERROR, "Conversion Error",
                        "Not a valid employee"));
            }
        } 
```

在我的 Managedbean

我有完整的方法，我将employeeDetailService 传递给我的转换器类。

```
public List<EmployeeDetail> complete(String query) {
        List<EmployeeDetail> suggestions;
        suggestions = new ArrayList<EmployeeDetail>();
        try {
            employee =  (List<EmployeeDetail>) new EmployeeNameConverter(
                    employeeList, employeeDetailService, query);

            for (EmployeeDetail p : employee) {
                if (p.getEmployeeNumber().startsWith(query))
                    suggestions.add(p);
            }
        } catch (Exception e) {
            System.out.println("exc " + e.getMessage());
            e.printStackTrace();
        }

        return suggestions;
    } 
```

JSF 代码

```
<p:autoComplete value="#{empMB.selectedEmployee}"
                            id="basicPojo" minQueryLength="6" 
                            completeMethod="#{empMB.complete}" var="p"
                            itemLabel="#{p.employeeNumber}" 
                            itemValue="#{p}" converter="#{p.employee}"
                            forceSelection="true" /> 
```

当我输入字符时出现异常

```
EmployeeNameConverter cannot be cast to java.util.List
java.lang.ClassCastException: net.test.util.EmployeeNameConverter cannot be cast to java.util.List 
```

我该如何解决这个问题？这是正确的方法还是有人可以提出更好的方法来实现相同的目标？

更新 1

```
@Override
    public List<EmployeeDetail> getEmployeeDetails(String employeeNumber) {

        List query = (List)entityManager.createNamedQuery("getEmp")
                .setParameter("empNumber", employeeNumber)
                .getSingleResult();

        return query;

    } 
```

**例外**

```
net.test.entity.EmployeeDetail cannot be cast to java.util.List
java.lang.ClassCastException: net.test.entity.EmployeeDetail cannot be cast to java.util.List
    at net.test.dao.EmployeeDetailDAOImpl.getEmployeeDetails(EmployeeDetailDAOImpl.java:36) 
```

异常行是

```
List query = (List)entityManager.createNamedQuery("getEmp")
                    .setParameter("empNumber", employeeNumber)
                    .getSingleResult(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T04:42:32.890

这里有两个主要问题

1.  您正在尝试手动实例化和管理 JSF 转换器实例。不要这样做。转换器是一个设计为仅供 JSF 上下文使用的构造。调用`new`或向转换器类提供构造函数参数不是开发人员的工作。[根据此示例](http://www.mkyong.com/jsf2/custom-converter-in-jsf-2-0/)实现一个简单的转换器并在`<p:autoComplete/>`

    根据您的评论，您手动管理转换器的原因是能够访问您的 DAO 层。作为一种解决方法，您可以添加`@ManagedBean`到您的转换器中，JSF 会将其视为托管 bean*和*转换器。作为托管 bean，您现在可以将您的 DAO 资源注入其中。这不是最佳实践，而只是一种解决方法。这种对转换器的限制将在 JSF2.2 中移除：)。

2.  在操作转换器时，您试图将其视为常规 POJO，并因此尝试将其转换为几种不兼容的类型

    ```
     employee = (List<EmployeeDetail>) new EmployeeNameConverter( employeeList, employeeDetailService, query); //EmployeeNameConverter !instanceof EmployeeDetail 
    ```

# actionscript-3 - 未找到 AS3 类型：声音

> ID：14242861
> 
> 赞同：0
> 
> 时间：2013-01-09T17:22:33.933
> 
> 标签：actionscript-3, flash, air

我有一小段 AS3 代码，但它不起作用:(

```
var snd:Sound = new Sound(new URLRequest("Hit1.wav"));
var channel:SoundChannel = new SoundChannel();
channel= snd.play(); 
```

我得到的只是

```
type was not found or was not a compile-time constant: Sound
type was not found or was not a compile-time constant: SoundChannel 
```

我怎样才能解决这个问题？

帆布

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:27:54.583

您必须导入类：

```
import flash.media.Sound;
import flash.media.SoundChannel; 
```

要不就：

```
import flash.media.*; 
```

# ios - 为什么我的财产没有被释放？

> ID：14242862
> 
> 赞同：0
> 
> 时间：2013-01-09T17:22:40.173
> 
> 标签：ios, memory-management, automatic-ref-counting

我有一个延迟加载的属性，定义如下，每次我访问它时都会保留它，就像`foo.bar`. 在“for”循环退出（从 init 分派异步）之后，所有的`bar`get 副本都被释放，但与此同时它们都建立起来了，我收到了内存警告。

为什么会这样？ARC 是否永远不会在内部使用 [pool drain] 来清理未使用的内存？还是我以某种方式在调度或块中导致保留周期？

```
@interface Foo : NSObject

@property (nonatomic, strong) MyAlgorithm *bar;

@end

@implementation Foo

- (id)init {

   if (self = [super init]) {

    __weak Foo *weakSelf = self;

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

        weakSelf.testAudioFilePaths = [[NSBundle mainBundle] pathsForResourcesOfType:kAudioFileWavType inDirectory:kTestFilesDirectory];

        for (NSString *path in weakSelf.testAudioFilePaths) {

            weakSelf.bar = nil; // this is so we rebuild it for each new path

            [weakSelf readDataFromAudioFileAtPath:path];

        }

    });
  }
  return self;
}

- (MyAlgorithm *)bar {
   if (!_bar) {
      _bar = [[MyAlgorithm alloc] initWithBar:kSomeBarConst];
   }
   return _bar;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T10:02:17.730

答案是将循环中的代码位包装**成块，以便在循环**的`@autoreleasepool`每次迭代后将池排空，而不是在循环退出后的某个未来点：

```
- (id)init {

   if (self = [super init]) {

    __weak Foo *weakSelf = self;

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

        weakSelf.testAudioFilePaths = [[NSBundle mainBundle] pathsForResourcesOfType:kAudioFileWavType inDirectory:kTestFilesDirectory];

        for (NSString *path in weakSelf.testAudioFilePaths) {

            @autoreleasepool {

                weakSelf.bar = nil; // this is so we rebuild it for each new path

                [weakSelf readDataFromAudioFileAtPath:path];
            }

        }

    });
  }
  return self;
} 
```

# git - 关于更改父节点及其对子节点的影响的理论怀疑

> ID：14242863
> 
> 赞同：0
> 
> 时间：2013-01-09T17:22:43.263
> 
> 标签：git

你可能猜到我是 Git 的初学者。我的问题：

*   如果你删除一个父节点，他的所有子节点也会被删除吗？
*   如果修改一个父节点，他的子节点也会改变吗？

感谢您的帮助 ：）

卡洛斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T22:26:18.573

根据您的评论，您所谓的节点的 git 术语是“分支”，答案是否定的

按照 Shahbaz 的想法（这也是我的，提交实际上是提交历史图中的节点），答案仍然是否定的。

您实际上无法更改提交。您可以更改引用（如分支或标签名称）*引用的提交*。这就是提交、变基和合并以及所有其余部分所做的事情：它们将新提交添加到图表中，并且通常使您当前分支的名称引用最新的。旧的提交仍然存在，它们的所有结构都完好无损。大约三个月后，如果没有任何内容涉及它们，它们将受到垃圾收集 - 但在您的场景中，子分支仍然引用它们一直在做的事情，因此它们的历史保持不变。

# oracle-adf - 什么是 在 Oracle ADF 框架的页面定义文件中？

> ID：14242867
> 
> 赞同：0
> 
> 时间：2013-01-09T17:22:58.073
> 
> 标签：oracle-adf

据我了解， 中的绑定`ADF`包含`Pagedef.xml`特定 JSF 页面的绑定，这些绑定是 UI 层和在后端运行的业务服务之间的粘合剂，后者由该`Datacontrol`层抽象。我想了解`<executables>`pagedef.xml 文件中的内容是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:05:24.407

可执行文件表示从页面调用的方法——在许多情况下，这些方法是返回数据集合的方法。更多信息在这里： [http ://docs.oracle.com/cd/E16162_01/web.1112/e16182/bcdcpal.htm#BABIFIBI](http://docs.oracle.com/cd/E16162_01/web.1112/e16182/bcdcpal.htm#BABIFIBI)

# c# - 将 C# 矩阵转换为 c++ FLOAT*

> ID：14242870
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:23:17.193
> 
> 标签：c#, c++, matrix, pinvoke

我需要尽可能干净地将 C# 中的 SlimMath 矩阵作为 FLOAT* 获取到托管 c++ 中。到目前为止，我所有的尝试都是肮脏和破碎的。代码看起来像这样：

C＃

```
Matrix m = Matrix.Identity;
//.......(transform matrix)
//.......Convert it to something I can get into c++ ??
myManagedCPPFunction(m.ToArray()); 
```

C++

```
void myClass::myManagedCPPFunction(?? matTransform)
{
    //FLOAT* f = reinterpret_cast<FLOAT*>(&matTransform); //Cant do this cause managed code
    otherClass->Go((FLOAT*)matTransform);
}

//This is existing code I'm trying to get to:
class otherClass
{
public:
virtual void STDMETHODCALLTYPE Go(const FLOAT *pTransformMatrix);
} 
```

我希望这有足够的意义。

谢谢！

编辑，我忘了提到这已经适用于字符串和常规浮点数，它只是 float[] -> float* 我似乎无法正常工作的东西。

我已经能够让它以这种方式工作，但这并不理想：

```
unsafe
{
    fixed (float* f = m.ToArray())
        myManagedCPPFunction(f);
} 
```

出于明显的原因，宁愿不这样做。

好的，我想我现在可以使用它（至少它可以编译并运行，但现在我需要进行转换），如下所示：

```
void myClass::myManagedCPPFunction(SlimDX::Matrix^ matTransform)
{
     FLOAT* f = reinterpret_cast<FLOAT*>(&matTransform);
     otherClass->Go(f);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:45:02.763

这就是您如何在 C++ 中声明它以供 C# 使用（请参阅[p/invoke](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)教程）：

```
extern "C" {
    __declspec( dllexport ) void STDMETHODCALLTYPE Go(float* pMatrix);

    void Go(float* pMatrix) {
       // do your stuff here. assume the matrix has 16 elements
    }
} 
```

在 C# 中：

```
[DllImport("myDll.dll")]
public static extern void Go(float[] matrix); 
```

示例 C# 代码：

```
Matrix m = myMatrix;
Go(m.ToArray()); 
```

编辑：如果您使用 C++/CLI 托管程序集，那么您可以像这样声明函数：

```
using namespace System;

public ref class Class1
{
    public:

        void Go(array<float> ^ pFloat)
        {
            ... 
        }
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T22:32:54.213

如果它是托管 C++，您可以使用与 C# 中相同的类型。为什么不像这样声明 C++ 方法：

```
void myClass::myManagedCPPFunction(Matrix^ matTransform) 
```

# python - Python 调试日志工具在程序完成后跟踪执行？

> ID：14242872
> 
> 赞同：0
> 
> 时间：2013-01-09T17:23:17.673
> 
> 标签：python, debugging, logging, traceback

我想构建一个工具，在推出用于测试的新代码时可以调用该工具，该工具将捕获和评估所有执行行并将它们打印到文件中，以便在执行完成后很长时间内可以对其进行跟踪和调试。将其视为一个调试器，它评估每一行代码的返回并在另一列中打印该行代码加上该行的返回值，因为它也在运行代码。例如：

```
Timestamp           File-Line    Source Code                       Debug Watcher        
----------------    ---------    -------------------------------   -----------------
20130109-10:18AM    test.py-1    import mathy  
20130109-10:18AM    test.py-2    x = 1        # inline comments   return: x:1
20130109-10:18AM    test.py-3    ans = divide(x,2)                call: math_functions.py-55:divide(dividend:1, divisor:2) 
20130109-10:18AM    mathy.py-56     return divedend / divisor     divide() function return: 0.5
20130109-10:18AM    test.py-4    print "Got %d"%ans               call: print : "Got 0.5"
etc... 
```

您是否看到在执行通过单独的函数、文件等时如何跟踪执行？这有可能生成大量日志数据，因此可以将其裁剪到某个限制大小。我还必须使用大型数据结构，例如字典、数组等，并创建一些特殊情况来处理这些事情。

在使用回溯之前，我已经创建了类似的东西，但它从来没有完全正确地工作过。只是想知道是否已经存在更精致的东西。如果没有，你会怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T23:12:49.167

我建议研究两个地方：跟踪装饰器和 sys.settrace。

## 跟踪装饰器

我正在使用这种方法来调试生产代码。请注意，它不会记录执行的每一行 python 代码，也不会评估每个涉及的变量。但是对于我的任务来说已经足够了——它记录了每个函数调用、传递的参数和返回值。它使用日志框架，因此您可以配置此信息的去向 - 屏幕、日志文件等。此外，您需要将跟踪器附加到模块、类或方法以开始跟踪。

[用于调试的跟踪装饰器](http://code.activestate.com/recipes/577551-trace-decorator-for-debugging/)

这是简短的用法示例：

```
import logging
logging.basicConfig(level=logging.DEBUG)

from trace_decorator import trace, attach

class TClass(object):
    def method(self,arg=1):
        print "using TClass.method()"
        self.method2(3)

    def method2(self,arg=2):
        d=1

@trace
def main():
    t = TClass()
    t.method(2) 
```

和程序输出

```
DEBUG:main:>>> main()
DEBUG:DEBUG:>>> TClass.method( self = <TClass object at 0x25b87d0>, arg = 2 )
DEBUG:DEBUG:>>> TClass.method2( self = <TClass object at 0x25b87d0>, arg = 3 )
DEBUG:DEBUG:<<< TClass.method2
DEBUG:DEBUG:<<< TClass.method
DEBUG:main:<<< main 
```

有关更多信息和使用示例，请查看[recipe 的链接](http://code.activestate.com/recipes/577551-trace-decorator-for-debugging/)。

## 系统设置跟踪

您描述的工具听起来很像 python 调试器。仅举几例 python 调试器： [PyDev Eclipse 插件有一个很好的](http://pydev.org/manual_adv_debugger.html)) [pdb](http://docs.python.org/2/library/pdb.html) 但是当用户选择代码中评估某些变量的位置时，您不想进行交互式调试，而是希望捕获每一行的程序状态。无论如何 - python 调试器将是第一个寻找实现此类工具的方法的地方。

Python 调试器使用 python 的[sys.settrace](http://docs.python.org/2/library/sys.html#sys.settrace)来放置他们的跟踪处理程序方法。 [stackoverflow 网站上有很多](https://stackoverflow.com/search?q=%5Bpython%5D%20settrace)关于如何使用 sys.settrace 方法的讨论。但他们中的大多数人都有使用这种方法的预防措施——容易破坏你的程序，使用它会使你的程序运行非常缓慢。

这是一个基于 sys.settrace 的 python 跟踪工具 - 你可以尝试使用它。请注意，您需要 python 2.7 并且程序应该从命令行启动，而不是某些 IDE 或交互式 shell。[https://code.google.com/p/pytracemonitor/](https://code.google.com/p/pytracemonitor/downloads/list)

# c# - 取消 webclient.UploadFileAsync() 导致 TargetInvocationException 错误

> ID：14242881
> 
> 赞同：0
> 
> 时间：2013-01-09T17:23:43.417
> 
> 标签：c#, webclient

我正在使用 Webclient 上传文件，当用户单击中止时。我想取消上传，但文件继续上传，直到完成。在我的中止按钮中，我发出了一个 wc.CancelAsync 导致表单关闭并发出 TargetInvocationException is unhandled error at Program.cs

```
[STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new frmUpload());
} 
```

这是我的部分代码

```
WebClient wc = new WebClient();  

    private void buttonAbort_Click(object sender, EventArgs e)
    {
        wc.CancelAsync();
    }

//Upload code
    try
    {
        wc.UploadFileAsync(Uripath, localPath);                    
        wc.UploadProgressChanged += uploadBarStat;
        wc.UploadFileCompleted += new UploadFileCompletedEventHandler(doneFTP);
    } 
```

我的问题几乎与[在 BackgroundWorker 中取消 Webclient.DownloadFile 相同](https://stackoverflow.com/questions/6522244/cancel-a-webclient-downloadfile-within-a-backgroundworker)

我错过了什么，我需要做什么才能顺利取消上传？或捕获异常错误？

TIA史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T21:39:34.530

添加一个变量布尔值：

```
bool inUpload=false; 
```

然后改变值，如：

```
 void UploadProgressChanged()
            {
               inUpload=true;
            }

void UploadFileCompleted()
            {
               inUpload=false;
            } 
```

并添加签入点击事件：

```
 private void buttonAbort_Click(object sender, EventArgs e)
    {
       if (inUpload) wc.CancelAsync();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:40:55.657

你有什么可以配合“尝试”的吗？此外，将其包装`wc.CancelAsync();`在 try/catch 中，然后运行调试器。是`TargetInvocationError`通过 catch 像普通异常一样被捕获，还是在 IDE 中仍然抛出一个丑陋的错误？

如果它仍然在 IDE 中抛出一个丑陋的错误，也许这篇文章会有所帮助：

[为什么 TargetInvocationException 被 IDE 视为未捕获](https://stackoverflow.com/questions/2658908/why-is-targetinvocationexception-treated-as-uncaught-by-the-ide)

# ruby-on-rails - Ruby on Rails 中模型的 DRY 使用

> ID：14242885
> 
> 赞同：0
> 
> 时间：2013-01-09T17:24:07.573
> 
> 标签：ruby-on-rails, dry

我有以下帮助方法，用于将一些记录上传到 Dropbox。对于三个模型（日志、飞机和进近）中的每一个，我都在做完全相同的事情。我想让这个更干燥，并且只有一次代码，但我不明白如何以抽象的方式引用模型。

有什么建议吗？

```
#------------------------------------------------------------
# Upload entries to Dropbox
#------------------------------------------------------------
def upload_items(items, folder, client)

  # Go through each item and upload it to Dropbox
  items.each do |item|

    if folder == 'logbook'
      # Get the file from the database to upload
      @logbook = current_user.logbooks.find_by_sync_id(item)
      # Upload it
      uploaded_file = client.put_file("/logbook/#{item}.json",@logbook.to_json, overwrite = true)
      # Reset the updated_flag in the database
      @logbook.update_attributes(updated_flag: 0)

    elsif folder == 'aircraft'
      # Get the file from the database to upload
      @aircraft = current_user.aircrafts.find_by_sync_id(item)
      # Upload it
      uploaded_file = client.put_file("/aircraft/#{item}.json",@aircraft.to_json, overwrite = true)
      # Reset the updated_flag in the database
      @aircraft.update_attributes(updated_flag: 0)

    elsif folder == 'approaches'
      # Get the file from the database to upload
      @approach = current_user.approaches.find_by_sync_id(item)
      # Upload it
      uploaded_file = client.put_file("/approaches/#{item}.json",@approach.to_json, overwrite = true)
      # Reset the updated_flag in the database
      @approach.update_attributes(updated_flag: 0)

    end
  end
end 
```

*Ruby 1.9.3，Rails 3.2.8*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:32:31.737

这将完成这项工作。

下面的关键部分是`current_user.public_send(folder.to_sym)`获取文件夹名称并将其转换为要发送给 current_user 的消息。

```
#------------------------------------------------------------
# Upload entries to Dropbox
#------------------------------------------------------------
def upload_items(items, folder, client)

  # Go through each item and upload it to Dropbox
  items.each do |item|
    # Get the file from the database to upload
    resource = current_user.public_send(folder.pluralize.to_sym).find_by_sync_id(item)
    # Upload it
    uploaded_file = client.put_file("/#{folder}/#{item}.json",resource.to_json, overwrite = true)
    # Reset the updated_flag in the database
    resource.update_attributes(updated_flag: 0)
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:38:07.327

我会这样写：

```
class DropboxUploader
  attr_reader :folder, :client

  def initializer(folder, client)
    @folder = folder.to_sym
    @client = client
  end

  def upload(items)
    items.each { |item| update item }
  end

  def resource_name
    folder.to_s.pluralize.to_sym
  end

  def file_path
    "/#{folder}/#{item}.json"
  end

  private
  def find_resource_for(item)
    current_user.public_send(resource_name).find_by_sync_id(item)
  end

  def update(item)
    resource = find_resource_for item
    client.put_file(file_path, @aircraft.to_json, true)
    resource.update_attributes(updated_flag: 0)
  end
end 
```

不仅 DRY，而且更客观（并且更容易测试）。

**编辑：** 用法如下：

```
uploader = DropboxUploader.new(:aircraft, @client)
uploader.upload(@items) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:34:13.153

这应该是方向：

**你的控制器：**

```
#------------------------------------------------------------
# Upload entries to Dropbox
#------------------------------------------------------------
def upload_items(items, folder, client)

  # Go through each item and upload it to Dropbox
  items.each do |item|
   upload_to_dropbox(items, folder, client)
  end
end 
```

**应用控制器：**

```
def upload_to_dropbox(item, folder, client)
  # Get the file from the database to upload
  @model = current_user.send(folder).find_by_sync_id(item)
  # Upload it
  uploaded_file = client.put_file("/aircraft/#{item}.json",@model.to_json, overwrite = true)
  # Reset the updated_flag in the database
  @model.update_attributes(updated_flag: 0)
end 
```

# python - Tkinter 按钮在按下时保持凹陷

> ID：14242896
> 
> 赞同：2
> 
> 时间：2013-01-09T17:24:47.623
> 
> 标签：python, button, csv, lambda, tkinter

我不确切知道我的问题出在哪里，它要么在绑定中，要么在它自己被调用的函数中。

我的按钮都出现在 labelFrame 下，每个按钮都带有一个输入框，因此用户可以加载许多 csv 文件进行分析，并且文件路径是可见的。它必须由用户搜索，因为这些文件可以存在于我不同且未连接的项目文件夹中。

这是一个示例按钮。

```
csv_type21 = Button(csvfiles, text = "Browse ...")
csv_type21.bind("<Button-1>", lambda event, obj = var21, tid = 21: find_cvsfile(event, obj, tid)) 
```

如果用户取消查找文件，它们仍然处于下沉状态，即使他们选择了一个文件，它也会保持下沉状态。（但输入框确实会使用文件路径进行更新）。

这是他们调用的函数，它要求一个 csv 文件并将其保存为一个元组，以便我可以跟踪哪个 csv 是哪个。之后，我为按钮所在的条目框设置了 StringVar 以说明文件路径。

```
def find_csvfile(event, obj, tid):
input_csvfile = askopenfile(initialdir = 'C:/',
                            filetypes = [("CSV File", "*.csv")],
                            title = 'Open CSV File for id ' + str(tid) + '...',
                            mode = 'r')
csv_data = tid, input_csvfile
filepath = input_csvfile.name
obj.set(filepath) 
```

我试过摆弄大量不同的变量和参数，但没有任何效果。我认为它必须是调用相同命令的多个按钮，但我不能确定。

任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-07-18T23:19:39.977

`return "break"`在末尾添加`def find_csvfile(event, obj, tid):`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T09:26:21.197

通过删除绑定解决了问题。lambda 命令被移到 Button 声明中，并且从 find_csvfile 函数中删除了“event”参数。此解决方案可阻止按钮在按下时凹陷。

```
csv_type21 = Button(csvfiles, text = "Browse ...", command = lambda obj = var21, tid = 21: find_csvfile(obj, tid)) 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2015-01-06T17:34:33.840

使用 button.bind("",funcion) 进行探测

```
def funcion()
   print 
```

在 funcion() 执行期间，当鼠标按下并释放时使用“”调用开始。

当返回状态被按下

# java - java HashMap 冲突

> ID：14242899
> 
> 赞同：29
> 
> 时间：2013-01-09T17:24:55.323
> 
> 标签：java, hashmap

我正在阅读有关 hashmap 的工作原理。我正在阅读 **[“如果两个不同的对象具有相同的哈希码会发生什么”](http://javarevisited.blogspot.in/2011/02/how-hashmap-works-in-java.html)**。

根据它，如果两个对象具有相同的哈希码，两者都将被存储，`LinkedList`但据我所知，如果两个哈希码，那么前一个将被新的哈希码覆盖（如果我错了，请纠正我）。

有人可以更详细地说明hashmap如何在内部使用对象作为键，如果两个对象具有相同的hashcode会发生什么以及如何获取这两个对象`get()`？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-09T17:26:46.850

不，第一个不会仅仅因为第二个具有相同的`hashCode`.

只有当它也相等时才会被覆盖（如 所说`equals`）。如果没有，这两个值都将保存在链表中。

获取键时，所有具有相同键的节点`hashCode`将与提供的键进行比较，直到一个相等，然后返回其值（使用`equals`方法）。

如果地图中没有相同的键，您将得到`null`.

如果许多对象具有相同的 hashCode（或更确切地说是相同的 hashCode 以 internal 的大小为模`Entry[] table`），您遇到的唯一问题是链接列表将始终被读取，这更慢（并且破坏了任何哈希表的目的）。这就是为什么在设计一种`hashcode`方法以确保生成的整数分布良好时很重要的原因。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-10T11:22:48.173

让我解释一下 hashmap 的工作原理。

**put方法的工作：**

*HashMap* 的工作原理是散列，我们有存储`put()`和`get()`检索对象形式的 HashMap 的方法。当我们将键和值都传递`put()`给存储在 HashMap 上的方法时，它使用键对象`hashcode()`方法来计算哈希码，并且它们通过对该哈希码应用哈希来识别存储值对象的存储桶位置。在检索它时，它使用键对象 equals 方法来找出正确的键值对并返回与该键关联的值对象。HashMap 在发生冲突时使用链表，对象将存储在链表的下一个节点中。HashMap 也将 key+value 元组存储在链表的每个节点中

**get方法的工作：**

当我们将 Key 和 Value 对象传递给`put()`Java HashMap 上的方法时，HashMap 实现会调用 Key 对象上的 hashCode 方法，并将返回的 hashcode 应用到自己的哈希函数中，以找到存储 Entry 对象的桶位置，重要的一点是 Java 中的 HashMap 存储键和值对象都作为存储桶中的 Map.Entry。如果在桶中找到多个 Entry 对象，它将调用同一桶中每个节点的 ke.equals 方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-09T17:28:21.827

假设您遵循[定义`hashCode`和`equals`](http://javarevisited.blogspot.co.il/2011/02/how-to-write-equals-method-in-java.html)的规则，您描述的场景不会导致数据丢失。最多，性能会随着时间的推移而下降。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-09T17:31:08.667

在 Java hashmap 中，他们可以使用多种方法来做到这一点。来自我在黑暗时代的旧 CS 201 数据结构课程：

1）哈希图中的每个桶都可以成为一个链表的头部，该链表包含所有添加的具有相同哈希值的条目。添加时发生冲突意味着您将新条目添加到链表的末尾。搜索意味着一旦你散列到桶中，你必须线性检查任何链表中的所有链表。

2）如果发生冲突并且存储在概念上是一个数组，您可以从该点开始迭代，直到找到一个空点并在那里添加新条目。对于搜索，这意味着如果您发现哈希桶被占用，那么您必须从该点线性比较数组中支持哈希映射的下一个空点。

在这两种情况下，如果有多个条目具有相同的哈希值，性能就会下降。在一般情况下，这意味着散列函数（用于生成散列码）返回少量可能的值，随着映射的填满，性能会下降。Java HashMap 利用了 50 年来对此类事物的研究，非常适合一般数据进入散列映射的一般情况。

注意@dystroy 对根据 equals() 方法在映射中不能有两个匹配项的规则发表了评论。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-11-21T08:42:56.407

在 Java 8 中，他们彻底检查了`HashMap`. 现在哈希桶被组织为链表或平衡二叉树，具体取决于：

*   哈希数组大小，和/或
*   给定存储桶中的条目数。

这意味着在许多条目落在同一个哈希桶中的情况下，您不再会遇到灾难性的糟糕性能。

有关更多信息，请阅读此博客文章：

*   [Java 8 中 HashMap 的性能改进](https://www.nagarro.com/en/blog/post/24/performance-improvement-for-hashmap-in-java-8)

# ruby - 在 Amazon EC2 上运行 Sinatra 应用程序

> ID：14242902
> 
> 赞同：2
> 
> 时间：2013-01-09T17:24:59.610
> 
> 标签：ruby, amazon-ec2, sinatra

我创建了一个 Sinatra 应用程序，我想在 Amazon EC2 上运行它。我知道有 heroku，但是将 Amazon EC2 作为另一种选择会很好。另一个原因是heroku（[source](https://devcenter.heroku.com/articles/request-timeout)）上存在这个超时问题：

```
The Heroku routing mesh detects and terminates requests taking more than 30 seconds to respond. 
```

到目前为止，我使用 Ubuntu 创建了一个微型实例，并安装了所需的库，并通过`ruby -rubygems app.rb`命令运行了我的 Sinatra 应用程序。我需要做的是让我的应用程序一直运行，只要服务器正在运行，而不仅仅是我运行上面的命令和退出命令行之间的时间。您知道任何简单且轻量级的解决方案吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-08T17:13:35.843

安装非常容易设置的Passenger：

`gem install passenger`

更多详细信息和文档请参阅[https://www.phusionpassenger.com/download](https://www.phusionpassenger.com/download)

# android - 如何将保存的文本转换为编辑文本

> ID：14242903
> 
> 赞同：0
> 
> 时间：2013-01-09T17:25:01.017
> 
> 标签：android

如何将文本保存为文本编辑，以便在离开活动并重新输入后，它会出现在相同的编辑文本中？

```
 switchbutton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            Switch sw = (Switch) v;

            if (sw.isChecked()) {
                SharedPreferences settings = getPreferences(0);
                SharedPreferences.Editor editor1 = settings.edit();
                editor1.putString("nombre", ed1.getText().toString());
                SharedPreferences.Editor editor2 = settings.edit();
                editor2.putString("apellido", ed2.getText().toString());
                SharedPreferences.Editor editor3 = settings.edit();
                editor3.putString("ciudad", ed3.getText().toString());
                SharedPreferences.Editor editor4 = settings.edit();
                editor4.putString("calle", ed4.getText().toString());
                SharedPreferences.Editor editor5 = settings.edit();
                editor5.putString("numero", ed5.getText().toString());
                editor1.commit();
                editor2.commit();
                editor3.commit();
                editor4.commit();
                editor5.commit();   
            } else {

                Toast.makeText(OtraActivity.this, "Datos no guardados",
                        Toast.LENGTH_LONG).show();
            }
        }}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:33:47.087

正如 cloudymusic 建议的那样，使用 SharedPreferences，您的活动`onPause()`存储数据，然后`onResume()`再次加载，即使应用程序关闭，您的 EditText 数据也会保持不变

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:34:50.940

在`onCreate`、`onStart`或任何您加载视图的地方，您可以从首选项加载数据并将其插入到您的视图中：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    SharedPreferences settings = getPreferences(0);
    ed1.setText(settings.getString("nombre", ""));
    ed2.setText(settings.getString("apellido", ""));
    ...
} 
```

在`onPause`中，您可以像单击按钮时一样保存它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:36:09.270

使用以下 onCreate

SharedPreferences 设置 = getPreferences(0); ed1.setText(settings.getString("名词",""));

对其他edittext做同样的事情..

# macos - 如何在 Mac OS X Mountain Lion 上重新打开 IntelliJ IDEA 12.0 CE 项目？

> ID：14242904
> 
> 赞同：0
> 
> 时间：2013-01-09T17:25:07.550
> 
> 标签：macos, intellij-idea

我刚开始在 Mac OS X 10.8.2 Mountain Lion 上使用 IntelliJ IDEA 12.0 社区版，最近创建了一个 Java 项目。在最近的文件系统清理过程中，我将我的项目文件夹移动到另一个文件夹，并删除了欢迎屏幕上“最近项目”列表下指向旧位置的链接。

但是，现在我根本无法打开我的 IntelliJ IDEA 项目。浏览文件系统，似乎没有可以在“打开项目”浏览器中选择的项目文件，也无法在 Finder 中双击项目文件夹以在 IntelliJ IDEA 中打开。项目中有一个隐藏的 .idea 文件夹，但它没有显示在“打开项目”浏览器中，而且 Finder 似乎对此无能为力。

如果我从 IntelliJ IDEA“打开项目”浏览器中双击我的项目文件夹，“打开项目”浏览器就会消失并且什么也没有发生。不会出现错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:25:07.550

问题原来是我的项目路径中有两个名称相同但大小写不同的文件夹。例如：

```
/Volumes/USB HDD/Git
/Volumes/USB HDD/git/mygitproject/MyIntelliJIDEAProject 
```

由于大小写，文件系统和用户（我）知道`git`和`Git`文件夹是不同的实体（诚然，我应该使用更好的名称，但我正在清理文件系统）。IntelliJ IDEA 12.0 CE 的项目打开算法似乎不区分大小写，所以当我双击时`/Volumes/USB HDD/git/mygitproject/MyIntelliJIDEAProject`，IntelliJ IDEA 找不到名为 的文件夹`mygitproject`，`/Volumes/USB HDD/Git`项目加载失败。

我重命名`/Volumes/USB HDD/Git`为`/Volumes/USB HDD/Git.admin`，现在我可以通过在`/Volumes/USB HDD/git/mygitproject/MyIntelliJIDEAProject`.

这可能是 IntelliJ IDEA 中的一个小错误。我本来希望它在找不到项目文件夹时显示错误消息。

# sinatra - sinatra file_config gem 在暂存中不起作用

> ID：14242905
> 
> 赞同：0
> 
> 时间：2013-01-09T17:25:09.550
> 
> 标签：sinatra, yaml, configuration-files

我正在使用[这个](http://www.sinatrarb.com/contrib/config_file.html)gem，它适用于生产环境和开发，但不是暂存：

这是main.rb

```
set :environments, %w{development test production staging}
config_file 'config/config.yml' 
```

和 config/config.yml

```
development: &development
  sub1:
    pay_to_email: test1@gmail.com

test:
  <<: *development

staging:
  <<: *development  

production:
  <<: *development 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T12:23:15.117

弄清楚为什么我必须像这样在注册 Sinatra::ConfigFile 之后设置它：

```
 register Sinatra::ConfigFile   
 set :environments, %w{development test production staging}
 config_file 'config/config.yml' 
```

# algorithm - 如何理解降低 0~1 背包的时间复杂度

> ID：14242909
> 
> 赞同：0
> 
> 时间：2013-01-09T17:25:21.360
> 
> 标签：algorithm, knapsack-problem

至于0~1背包问题，

```
f[i][v]=max{f[i-1][v],f[i-1][v-c[i]]+w[i]} 
```

c[i] 表示第 i 个商品的成本，w[i] 表示第 i 个商品的价值。

我读了一个文档，它说时间复杂度可以优化，特别是当 V 较大时。如下

```
 i=1...N

 v=V...0 
```

可以改为

```
 i=1...n        

bound=max{V-sum{w[i..n]},c[i]}        

 v=V...bound 
```

是什么意思？V（最大袋子）如何减去w[i]（商品价值）的总和？

真的很困惑，或者这个文档有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T02:32:14.983

你没有说你正在优化谁的复杂性。你在使用动态规划吗？如果是这样，这可能意味着您不需要计算`f[i][v]`v 的小值，因为您不需要这些值来找到最佳值。

即使你把所有的货物从`i + 1`到`n`到背包里，你仍然有一个`V - sum{c[i+1..n]}`剩余的容量，所以你不需要解决容量小于那个的子问题`i`（限制为货物）。`1..i`

如果您需要更正式的答案，请描述问题以及正在使用的算法，并提供更多详细信息。

# highcharts - 如何动态更改 HighCharts 中的 yAxis min、max 和 tickInterval

> ID：14242911
> 
> 赞同：1
> 
> 时间：2013-01-09T17:25:25.540
> 
> 标签：highcharts

我可以在初始选项对象中设置这些值，一切正常。例如，如果我稍后使用 chart.options.yAxis.tickInterval 更改选项，在重绘 yAxis 时它们似乎会被忽略。

```
 // Global variables
var markInterval = undefined;
var minInterval = 0;
var maxInterval = undefined;

chart = new Highcharts.Chart({
        // ... 
        yAxis: {
            title: {
                text: 'Mark'
            },
            labels: {
                formatter: function() {

                    // html formatting
                },
                useHTML: true
            },
            tickInterval: markInterval,
            min: minInterval,
            max: maxInterval
        },
        plotOptions: {
            series: {
                events: {
                    legendItemClick: function(event) {
                        // setTickIntervals(); Change the global values markInterval, minInterval and maxInterval
                        chart.options.yAxis.tickInterval = markInterval;
                        chart.options.yAxis.min = minInterval;
                        chart.options.yAxis.max = maxInterval;
                        chart.redraw();
                    }
                }
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-10T10:31:46.140

我错误地设置了新值，例如：

```
chart.options.yAxis.tickInterval = markInterval; 
```

应该

```
chart.yAxis[0].options.tickInterval = markInterval; 
```

然后一切都按预期工作。

# c# - Asp.net 不应用dependentAssembly/codeBase 提示

> ID：14242915
> 
> 赞同：0
> 
> 时间：2013-01-09T17:25:32.287
> 
> 标签：c#, asp.net, .net, assembly-loading

我正在尝试针对 RazorEngine 无法在 Razor 2.0 应用程序中部署的问题实施[此解决方法，因为它依赖于不兼容的 Razor 1.0。](https://stackoverflow.com/a/10936596/1371084)

我所做的是在 bin 文件夹中创建了两个目录：1.0 和 2.0，并将各自的 System.Web.Razor.dll 文件放入每个目录中。然后，我向 web.config 添加了dependentAssembly/codeBase 提示，以将程序集加载器指向正确的方向。

但是，我似乎无法让 Asp.net 尊重我为 System.Web.Razor 程序集申请的 codeBase 覆盖。结果是无法加载 System.Web.Razor 1.0.0.0 以供 RazorEngine 使用。

网页配置

```
<configuration>
    <runtime xmlns="">
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Razor" publicKeyToken="31bf3856ad364e35" culture="neutral" />
                <codeBase version="1.0.0.0" href="file://c:\apps\lr2\web\arcs\bin\1.0\System.Web.Razor.dll" />
                <codeBase version="2.0.0.0" href="file://c:\apps\lr2\web\arcs\bin\2.0\System.Web.Razor.dll" />
            </dependentAssembly>
        </assemblyBinding>
    </runtime>
</configuration> 
```

System.Web.Razor 1.0.0.0 的 Fusion 程序集加载日志的输出：

> 日志：用户 = NT AUTHORITY\SYSTEM 日志：DisplayName = System.Web.Razor，版本 = 1.0.0.0，文化 = 中性，PublicKeyToken = 31bf3856ad364e35（完全指定）
> 
> 日志：Appbase = file:///C:/apps/lr2/web/arcs/
> 
> 日志：初始 PrivatePath = C:\apps\lr2\web\arcs\bin
> 
> 日志：动态基础 = C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\a63cc915
> 
> 日志：缓存基础 = C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\a63cc915
> 
> 日志：AppName = 98966cc9
> 
> 调用程序集：RazorEngine，版本=3.0.8.0，文化=中性，PublicKeyToken=9ee697374c7e744a。
> 
> LOG：此绑定在默认加载上下文中开始。
> 
> LOG：使用应用程序配置文件：C:\apps\lr2\web\arcs\web.config
> 
> LOG：使用主机配置文件：C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet.config
> 
> LOG：使用 C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config 中的机器配置文件。
> 
> 日志：政策后参考：System.Web.Razor，版本=1.0.0.0，文化=中性，PublicKeyToken=31bf3856ad364e35
> 
> 日志：GAC 查找不成功。
> 
> 日志：正在尝试下载新的 URL 文件：///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/a63cc915/98966cc9/System.Web.Razor.DLL。
> 
> 日志：尝试下载新 URL 文件：///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/a63cc915/98966cc9/System.Web.Razor/System.Web.Razor .DLL。
> 日志：正在尝试下载新的 URL 文件：///C:/apps/lr2/web/arcs/bin/System.Web.Razor.DLL。
> 
> 日志：正在尝试下载新的 URL 文件：///C:/apps/lr2/web/arcs/bin/System.Web.Razor/System.Web.Razor.DLL。
> 
> 日志：正在尝试下载新的 URL 文件：///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/a63cc915/98966cc9/System.Web.Razor.EXE。
> 
> 日志：尝试下载新 URL 文件：///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/a63cc915/98966cc9/System.Web.Razor/System.Web.Razor 。EXE文件。
> 
> 日志：正在尝试下载新的 URL 文件：///C:/apps/lr2/web/arcs/bin/System.Web.Razor.EXE。
> 
> 日志：正在尝试下载新的 URL 文件：///C:/apps/lr2/web/arcs/bin/System.Web.Razor/System.Web.Razor.EXE。
> 
> LOG：所有探测 URL 都已尝试并失败。

知道为什么 Asp.net 从不尝试深入 bin\1.0 吗？

我确实检查了 machine.config 并且没有任何冲突的 assemblyBinding 的迹象。

感谢帮助！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-10T14:50:32.433

我通过使用 AppDomain.CurrentDomain.AssemblyResolve 事件来解决这个问题。

```
 System.AppDomain.CurrentDomain.AssemblyResolve += (o, e) =>
    {
        if (e.Name == "System.Web.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35")
            return System.Reflection.Assembly.LoadFrom(Server.MapPath("~/bin/1.0/System.Web.Razor.dll"));

        return null;
    }; 
```

# sql - 带有 Oracle 保留字的 Squirrel SQL 错误

> ID：14242916
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:25:33.263
> 
> 标签：sql, oracle, toad, squirrel-sql

使用基于 Java 的 Squirrel SQL 客户端版本 3.4.0 的简单更新语句应该是一个简单的更新语句（注意：这在 TOAD for Oracle 中运行良好，但从长远来看，我希望使用 Squirrel。

查询是：

```
UPDATE txn_header
SET KNZ = ' ', "TIMESTAMP" = ' '
WHERE ORGU_CODE_CMPY = '001'
and ORGU_CODE = '0040'
and TILL_SHORT_DESC = '061' 
and KNZ = 'WT'
and TXHD_TXN_NR between 729167 and 730881; 
```

我的问题是，TIMESTAMP 是 Oracle PL/SQL 保留字。研究表明，Oracle 中的保留字应包含在双引号“TIMESTAMP”中。但这似乎执行了最后一个成功的查询。

我也试过

```
'TIMESTAMP'
[TIMESTAMP] 
(TIMESTAMP = " ") 
("TIMESTAMP = " ") 
```

空格的目的是

上次成功的查询是：

```
SELECT knz, count(*) 
   from TXN_HEADER
group by knz 
```

至少可以说我很困惑，而且我不是数据库管理方面的专家 - 任何帮助都会令人难以置信。

编辑 - 2013 年 10 月 1 日制作

我还尝试在 TIMESTAMP 列名上使用反引号

```
UPDATE txn_header
SET KNZ = ' ', TXN_HEADER.`TIMESTAMP` = ' ' 
WHERE ORGU_CODE_CMPY = '001' 
and ORGU_CODE = '0040'
and TILL_SHORT_DESC = '061' 
and KNZ = 'WT'
and TXHD_TXN_NR between '729167' and '729167' 
```

我收到以下错误：

```
Error: ORA-00911: invalid character

SQLState:  42000
ErrorCode: 911
Position: 44 
```

Squirrel 的 GUI 指向反引号，我已经将其视为保留字的解决方案。

我连接的服务器是 Oracle 11 服务器

谢谢你，大卫伯金

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:11:26.693

使用下表定义，更新适用于 v3.4：

```
create table txn_header (
    knz varchar2(100),
    "TIMESTAMP" timestamp,
    ORGU_CODE_CMPY varchar2(100),
    ORGU_CODE varchar2(100),
    TILL_SHORT_DESC varchar2(100),
    TXHD_TXN_NR integer
) 
```

你能提供你的表创建语句吗？

# html - 如何将 CSS 表格行单元格大小与下一行的单元格大小分离？

> ID：14242922
> 
> 赞同：3
> 
> 时间：2013-01-09T17:25:55.790
> 
> 标签：html, css, css-tables

我是 CSS 的完全初学者（这实际上是我写的第一个 CSS）和 HTML 的相对初学者，所以如果我遗漏了一些明显的东西或者我犯了一些严重的错误，请原谅我。现在，问题：

我正在尝试创建一个布局，但偶然发现了一个禁止我做我想做的事情的问题。这是我所拥有的屏幕截图：

![目前的布局。](../Images/07437c50875c2c66936589f0af3f2e0e.png)

我想要做的只是简单地把`div`“家”、“博客”等写成和`div`下面的一样宽，有效地使它在与侧边栏相同的 Y 处结束。像这样：

![我想要达到的目标。](../Images/f35aeb5332d2ac9352835a865a8cf10e.png)

HTML 文件的主体包含一个`background`class `div`，它负责装饰文本，而所有不存在的内容都在另一个`div`名为`container`. `container`设置为`display: table`并在其中包含两个`div`class `row`（标记 a `display: table-row`），第一个包含导航`div`，第二个包含主要和侧边栏（所有这些都是 class `section`，标记`display: table-cell`）。

这是整个文件，显示 CSS 以及我如何尝试构建 HTML：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<head>
    <title>mini</title>
    <style type="text/css">

        * {
            font-family: "Ubuntu", Helvetica, Arial, sans-serif;
            margin: 0;
        }

        body {
            padding: 100px 0 0 0;           
            background: white;
            color: #444444;
        }

        h1 {
            font-size: 48px;
            font-weight: bold;
            letter-spacing: -0.083333em;
            line-height: 1.3em;
            text-transform: lowercase;
        }

        p {
            line-height: 1.5em;
        }

        .container {
            overflow: hidden;
            padding: 24px 24px 24px 24px;
            border-spacing: 35px 35px;
            display: table;
        }

        .section {
            position: relative;
            padding: 24px 24px 24px 24px;
            border-width: 1px;
            border-style: solid;
            border-color: #888888;
            background: white;
            display: table-cell;
        }

        .background {
            position: absolute;
            margin: -124px -124px -124px -124px;
            z-index: -1;
            float: right;
            font-size: 54px;
            line-height: 1em;
            font-weight: bold;
            color: #eeeeee;
        }

        .row {          
            display: table-row;
        }

        #sidebar {
            width: 20%;
        }

        #navigation {
            font-size: 24px;
            font-weight: bold;
            text-transform: lowercase;
        }

        #empty {
        }

    </style>
</head>

<body>
    <div id="background" class="background">
        bgtext
    </div>

    <div id="foreground" class="container">
        <div class="row">
            <div id="navigation" class="section">
                navitext
            </div>
        </div>
        <div class="row">
            <div id="mainbody" class="section">
                <h1>Main</h1>
                maintext
            </div>
            <div id="sidebar" class="section">
                <h1>Sidebar</h1>
                sidetext
            </div>
        </div>
    </div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:33:53.123

实现这一点的一种方法是围绕所有内容创建一个包装器：

```
#wrapper {
   width:960px;
   position: relative;
}

<div id="wrapper">

   <div id="header">Header</div>

   <! -- Other content related divs goes here -->

</div> 
```

div 现在将`header`占用尽可能多的空间，即`960px`. 这同样适用于 div 内的其他`wrapper`div，除非另有说明（这是您要查找的内容）。

您可能希望将此 div 居中，`margin: 0 auto`以使您的网站在更大的屏幕上看起来不错。

祝你好运:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:19:44.870

我不完全确定您要做什么，但我认为您的意思是您希望导航栏中的锚点之间的间距相等。在这种情况下，不需要 JavaScript。

我会使用居中的内联块，两边都有间隔，以便每个链接之间的距离与边界的填充相同。

见代码：

```
<!-- In style: -->
...
#navigation > .spacer {
    display: inline-block;
    width: 5%;
    float: left;
}

#navigation > .navLink {
    display: inline-block;
    width: 22.5%;
    float: left;
    text-align: center;
}
...

...
<!-- Nav bar div -->
<div id="navigation" class="section">
    <div class="spacer">
        &nbsp;
    </div>
    <div class="navLink">
        link1
    </div>
    <div class="navLink">
        link2
    </div>
    <div class="navLink">
        link3
    </div>
    <div class="navLink">
        link4
    </div>
    <div class="spacer">
        &nbsp;
    </div>
</div>
... 
```

根据需要格式化并享受您的新导航栏！
希望有帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-09T17:39:09.857

您不需要 display: table 或 display:table-cell，因为在模板设计中使用它不是一个好习惯。如果要为单元格提供填充，则有必要分别最小化该元素的宽度。以下内容可能对您有所帮助。

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<head>
    <title>mini</title>
    <style type="text/css">

        * {
            font-family: "Ubuntu", Helvetica, Arial, sans-serif;
            margin: 0;
        }

        body {
            padding: 100px 0 0 0;           
            background: white;
            color: #444444;
        }

        #wrapper{
            width:80%;
            margin:auto;
        }

        #main{
            width:100%;
        }

        #navigation{
            border:black 1px solid;
            float:left;
            width:96%;
            padding:2%;
            margin-bottom:20px;
        }

        #mainbody{

            border:black 1px solid;
            float:left;
            width:75%;

            height:auto;
        }

         #sidebar{
            border:black 1px solid;
            float:right;
            width:23%;

            height:100%;

        }

    </style>
</head>

<body>
    <div id="wrapper">
        <div id="navigation">
            Home | blog | forum | about
        </div>

        <div id="main">
            <div id="mainbody">
                 <h1>Main</h1>
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br />
                    maintext maintext maintext maintext maintext maintext maintext maintext maintext
                    <br /><br />

            </div>
            <div id="sidebar">
                side bar
            </div>
        </div>
    </div>
</body>

</html> 
```

# java - 实现枚举以管理 Java 中的常量的正确方法是什么？

> ID：14242924
> 
> 赞同：0
> 
> 时间：2013-01-09T17:25:58.880
> 
> 标签：java, enums

在做了一些研究之后，我发现从 java 1.5 开始，最好在枚举中管理在“常量”类中声明的常量（或关键属性）。

我想知道实现这些枚举的正确方法是什么，以尽可能简单地获取枚举元素的值，无论其类型如何。

示例：是否可以具有“Constant.Messages.WARNING”的值，其中 Messages 是：

```
public enum Messages {

    WARNING("main.message.warning")

} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:28:22.280

您可以通过实现一些方法来做到这一点。您将需要一个构造函数和一个 getter：

```
public enum Messages {
    WARNING("main.message.warning");

    private String message;

    Messages (String message) { this.message = message; }

    public String get() { return this.message; }
} 
```

现在你可以写：

```
String msg = Messages.WARNING.get(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:34:36.437

您可以将枚举自定义为 Java 中的其他类，但很少有例外。

我将使用相同的示例，但它使用`toString`without `getMessage`，因此您可以在`toString`调用的地方（例如 in`System.out.println`或任何日志记录方法）使用枚举。

```
public enum Messages
{
    WARNING("main.message.warning"),
    ERROR("main.message.error");

    private final String message;

    // Parameters to the enum constructors are the ones in the enum "definition"
    Messages(final string message)
    {
        this.message = message;
    }

    @Override
    public String toString()
    {
        return message;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T17:29:36.940

```
public enum Messages {

    WARNING("main.message.warning")
    private String message;
    Messages(String message) {
        this.message = message
    }
    String getMessage() {
        return this.message;
    }
} 
```

毕竟你可以

```
Messages.WARNING.getMessage() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-09T17:30:00.483

是的，但在这种情况下，这`"main.message.warning"`是枚举的一个实例成员：

```
public enum Messages
{
    WARNING("main.message.warning"),
    ERROR("main.message.error");

    private final String message;

    // Parameters to the enum constructors are the ones in the enum "definition"
    Messages(final string message)
    {
        this.message = message;
    }

    public String getMessage()
    {
        return message;
    }
} 
```

还要注意，所有这些构造函数都是在 JVM 启动时调用的；当您的程序“准备就绪”时，枚举值都在那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T17:28:47.390

Java 编译器在幕后做了一些魔术，所以`enum`当你遇到它们时会觉得有点奇怪。您可以使用私有构造函数添加任意附加数据，例如：

```
public enum Messages {

    WARNING("main.message.warning");

    private final String key;

    private Messages(String key) { this.key = key; }
    public String getKey() { return key; }
} 
```

# c# - 如何使用 Console.Out 将 byte[] 写入文件？

> ID：14242925
> 
> 赞同：1
> 
> 时间：2013-01-09T17:26:03.607
> 
> 标签：c#, stream, console, textwriter

在java中你可以这样做：

```
File file = new File(filepath);
PrintStream pstream = new PrintStream(new FileOutputStream(file));
System.setOut(pstream);

byte[] bytes = GetBytes();
System.out.write(bytes); 
```

我想在 C# 中做类似的事情。我试过了，但没有用：

```
StreamWriter writer = new StreamWriter(filepath);
Console.SetOut(writer);

byte[] bytes = GetBytes();
Console.Out.Write(bytes); 
```

看起来这里的主要问题是 Write 方法不接受字节数组作为参数。

我知道我可以使用 File.WriteAllBytes(filepath, bytes)，但我希望 C# 代码尽可能接近原始的 java 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:39:31.660

> 我知道我可以使用 File.WriteAllBytes(filepath, bytes)，但我希望 C# 代码尽可能接近原始的 java 代码。

Java 代码做了一些你不应该做的事情：它将二进制数据写入标准输出，而标准流不是为二进制数据设计的，它们在设计时考虑到了文本。.NET 在这里做了“正确的事”，并为您提供了一个*文本*接口，而不是二进制数据接口。

因此，正确的方法是将数据直接写入文件，而不是标准输出。

~~作为一种解决方法，您可以伪造它并使用以下范围的不变编码将字节转换为字符`byte`：~~不起作用，因为 .NET 字符串的“不变”编码是 UTF-16，它不接受每个字节输入都是有效的；例如，字节数组`new byte[] { 0xFF }`是无效的 UTF-16 代码序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:32:10.807

不[只是](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)

```
File.WriteAllBytes(filepath, GetBytes()) 
```

或者你可以这样做，

```
using (var writer = new StreamWriter(filepath))
{
    var bytes = GetBytes();
    writer.BaseStream.Write(bytes, 0, bytes.Length)
}; 
```

一旦你将它传递`StreamWriter`给`SetOut`它，它只会暴露`TextWriter`不允许访问内部流的基础。这是有道理的，因为 Console 是为向用户提供输出而设计的。我想将任意二进制文件输出到控制台是非标准的。

# sql - 在多线程环境中将记录插入数据库表

> ID：14242926
> 
> 赞同：0
> 
> 时间：2013-01-09T17:26:04.120
> 
> 标签：sql, tsql

我有这个 TSQL 代码，它检查“sadsadsad”是否存在，如果不存在，则将其插入表中。

```
if not exists(select id from [ua_subset_composite] where ua = 'sadsadsad')
  begin
    insert into [ua_subset_composite]
    select 'sadsadsad',1,null,null,null,null
  end 
```

我担心的是，在将有多个线程同时运行的生产环境中，可能会出现记录将在不存在选择和插入之间滑过的情况。

我不想在列上添加唯一约束，并且想知道是否可以改进此 SQL 代码以保证唯一性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:39:31.373

解决这个问题的一种方法是使用更高级别的隔离（即锁定）。您可以将整个语句包装在事务中并使用更严格的隔离级别。

例如：

```
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

BEGIN TRANSACTION

   <your code here>

COMMIT TRANSACTION 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:30:20.600

您可以在数据库上实施锁定策略。你有悲观的选择：

> 当您锁定记录以供您独家使用时，直到您完成它为止。它比乐观锁定具有更好的完整性，但需要您小心设计应用程序以避免死锁。

或乐观：

> 在您阅读记录的地方，记下版本号并在写回记录之前检查版本是否未更改。当您写回记录时，您会过滤版本上的更新以确保它是原子的。（即在您检查版本并将记录写入磁盘之间尚未更新）并一键更新版本。
> 
> 如果记录是脏的（即与您的不同版本），您将中止事务并且用户可以重新启动它。

[来源](https://stackoverflow.com/a/129397/205426)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:31:05.577

当您执行`select`, 放置一个`updlock`,`holdlock`在被选择的范围内：

```
begin transaction

if not exists(
    select id 
    from [ua_subset_composite] with (updlock, holdlock) 
    where ua = 'sadsadsad')
  begin
    insert into [ua_subset_composite]
    select 'sadsadsad',1,null,null,null,null
  end

commit 
```

，`holdlock`相当于[`serializable`隔离级别](http://msdn.microsoft.com/en-us/library/ms173763.aspx)，将产生以下效果：

> *   语句不能读取已被其他事务修改但尚未提交的数据。
>     
>     
> *   在当前事务完成之前，任何其他事务都不能修改当前事务已读取的数据。
>     
>     
> *   在当前事务完成之前，其他事务不能插入键值落在当前事务中的任何语句读取的键范围内的新行。
>     
>     
> 
> 范围锁被放置在与事务中执行的每个语句的搜索条件相匹配的键值范围内。这会阻止其他事务更新或插入符合当前事务执行的任何语句的任何行。这意味着如果事务中的任何语句第二次执行，它们将读取相同的行集。范围锁一直保持到事务完成。这是隔离级别中最具限制性的，因为它锁定整个范围的键并保持锁定直到事务完成。**由于并发性较低，仅在必要时使用此选项**。

除了...`updlock`之外还需要 ，`holdlock`通过添加 ，我们可以防止单独的进程同时在同一范围上`updlock`执行自己的语句。`select with (updlock, holdlock)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:32:03.123

这就是我最终要做的

```
insert into [ua_subset_composite]  WITH (TABLOCKX) (ua, os)
select @r, 1 
where not exists (select 1 from [ua_subset_composite] nolock where ua = @r 
```

为了测试代码，我从多个窗口同时运行了这段代码

```
declare @r nvarchar(30);
while(1=1)
begin

set @r =  convert(nvarchar(30),getdate(),21 )
insert into [ua_subset_test]  WITH (TABLOCKX) (ua, os)
select @r, 1 
where not exists (select 1 from [ua_subset_test] nolock where ua = @r

)
end 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-10T05:01:52.727

不幸的是，以上答案都不是正确的。当心任何开始的“锁定”解决方案`BEGIN TRAN SELECT`。是的，如果隔离级别是 SERIALIZABLE，则`SELECT`创建阻止其他进程更新所选数据的锁。但是如果没有选择数据呢？要锁定什么？

IOW，`BEGIN TRAN`设置竞争条件：

```
/* spid */
 /* 1 */   SELECT ... -- returns no rows
 /* 2 */   SELECT ... -- returns no rows
 /* 1 */   INSERT ... -- whew! 
 /* 2 */   INSERT ... -- error 
```

要在写入之前读取（例如，向用户呈现数据），有特殊的时间戳数据类型。但是，在您的情况下，它只是一个插入。使用原子事务，即单个语句：

```
insert into [ua_subset_composite] (column1, column2)
values ('sadsadsad', 1)
where not exists (
    select 1 from ua_subset_composite 
    where column1 = 'sadsadsad'
) 
```

服务器保证该行被插入或不被插入。锁定由知道如何操作的人在最短的时间内为您完成。:-)

> 我不想添加唯一约束

好吧，你可能应该，你知道的。上面的代码将阻止*尝试*添加非唯一值，并避免出现错误消息。独特的约束会阻止不那么小心的人*成功*。

# erlang - 在erlang中发送带有特殊字符的消息

> ID：14242934
> 
> 赞同：1
> 
> 时间：2013-01-09T17:26:29.067
> 
> 标签：erlang

我使用 erlang，我使用与我的电脑相关的调制解调器

我想从调制解调器向我的电话号码发送消息

我开发了这个功能，它工作得很好

```
send(To) ->
Message =http_urii:encode("Vous n'avez pas d'écheance à payer."),
    Url = io_lib:format("http://192.168.1.5:9998/sendsms?tel=~s&text=~s", [To, Message]),
    http:request(lists:flatten(Url), sms). 
```

我的问题与带有变音符号的[符号](http://en.wikipedia.org/wiki/Diacritic)有关，例如 **é ， à**

因为在我的手机中我收到了短信但特殊字符没有以正确的格式显示**é**变成了另一个字符，**à**变成了另一个字符

我想在我的手机中收到这条信息：**Vous n'avez pas d'écheance à payer。**

我修改了发送的源代码

```
 send(To) ->
    Message =http_urii:encode("Vous n'avez pas d'%E9cheance %EA payer."),
        Url = io_lib:format("http://192.168.1.5:9998/sendsms?tel=~s&text=~s", [To, Message]),
        http:request(lists:flatten(Url), sms). 
```

但在我的手机中，我收到了这条消息**Vous n'avez pas d'%E9cheance %EA payer。**不编码特殊字符

**http_urii.erl**的源代码是：

```
-module(http_urii).

-export([parse/1, encode/1, decode/1]).

%%%=========================================================================
%%%  API
%%%=========================================================================
parse(AbsURI) ->
    case parse_scheme(AbsURI) of
    {error, Reason} ->
        {error, Reason};
    {Scheme, Rest} ->
        case (catch parse_uri_rest(Scheme, Rest)) of
        {UserInfo, Host, Port, Path, Query} ->
            {Scheme, UserInfo, Host, Port, Path, Query};
        _  ->
            {error, {malformed_url, AbsURI}}
        end
    end.

encode(URI) ->
    Reserved = sets:from_list([$;, $:, $@, $&, $=, $+, $,, $/, $?,
                   $#, $[, $], $<, $>, $\", ${, $}, $|,
                   $\\, $', $^, $%, $ ]),
    lists:append(lists:map(fun(Char) ->
                   uri_encode(Char, Reserved)
               end, URI)).

decode([$%,Hex1,Hex2|Rest]) ->
    [hex2dec(Hex1)*16+hex2dec(Hex2)|decode(Rest)];
decode([First|Rest]) ->
    [First|decode(Rest)];
decode([]) ->
    [].

%%%========================================================================
%%% Internal functions
%%%========================================================================
parse_scheme(AbsURI) ->
    case split_uri(AbsURI, ":", {error, no_scheme}, 1, 1) of
    {error, no_scheme} ->
        {error, no_scheme};
    {StrScheme, Rest} ->
        case list_to_atom(http_util:to_lower(StrScheme)) of
        Scheme when Scheme == http; Scheme == https ->
            {Scheme, Rest};
        Scheme ->
            {error, {not_supported_scheme, Scheme}}
        end
    end.

parse_uri_rest(Scheme, "//" ++ URIPart) ->

    {Authority, PathQuery} =
    case split_uri(URIPart, "/", URIPart, 1, 0) of
        Split = {_, _} ->
        Split;
        URIPart ->
        case split_uri(URIPart, "\\?", URIPart, 1, 0) of
            Split = {_, _} ->
            Split;
            URIPart ->
            {URIPart,""}
        end
    end,

    {UserInfo, HostPort} = split_uri(Authority, "@", {"", Authority}, 1, 1),
    {Host, Port} = parse_host_port(Scheme, HostPort),
    {Path, Query} = parse_path_query(PathQuery),
    {UserInfo, Host, Port, Path, Query}.

parse_path_query(PathQuery) ->
    {Path, Query} =  split_uri(PathQuery, "\\?", {PathQuery, ""}, 1, 0),
    {path(Path), Query}.

parse_host_port(Scheme,"[" ++ HostPort) -> %ipv6
    DefaultPort = default_port(Scheme),
    {Host, ColonPort} = split_uri(HostPort, "\\]", {HostPort, ""}, 1, 1),
    {_, Port} = split_uri(ColonPort, ":", {"", DefaultPort}, 0, 1),
    {Host, int_port(Port)};

parse_host_port(Scheme, HostPort) ->
    DefaultPort = default_port(Scheme),
    {Host, Port} = split_uri(HostPort, ":", {HostPort, DefaultPort}, 1, 1),
    {Host, int_port(Port)}.

split_uri(UriPart, SplitChar, NoMatchResult, SkipLeft, SkipRight) ->
    case inets_regexp:first_match(UriPart, SplitChar) of
    {match, Match, _} ->
        {string:substr(UriPart, 1, Match - SkipLeft),
         string:substr(UriPart, Match + SkipRight, length(UriPart))};
    nomatch ->
        NoMatchResult
    end.

default_port(http) ->
    80;
default_port(https) ->
    443.

int_port(Port) when is_integer(Port) ->
    Port;
int_port(Port) when is_list(Port) ->
    list_to_integer(Port).

path("") ->
    "/";
path(Path) ->
    Path.

uri_encode(Char, Reserved) ->
    case sets:is_element(Char, Reserved) of
    true ->
        [ $% | http_util:integer_to_hexlist(Char)];
    false ->
        [Char]
    end.

hex2dec(X) when (X>=$0) andalso (X=<$9) -> X-$0;
hex2dec(X) when (X>=$A) andalso (X=<$F) -> X-$A+10;
hex2dec(X) when (X>=$a) andalso (X=<$f) -> X-$a+10. 
```

现在我将 http_urii 更改为标准的 http_uri

但是当我执行我的项目时

我有这个错误： Erlang R13B03 (erts-5.7.4) [source] [rq:1] [async-threads:0] [hipe] [kernel-poll:false]

```
Eshell V5.7.4  (abort with ^G)
1> exception: [{http_uri,encode,
                      ["Vous n'avez pas d'écheance à payer."]},
            {sms_alert,send,1},
            {webrpc_api,build_response,2},
            {webrpc_api,format_response,2},
            {webrpc_api,process_command,2},
            {httpd_response,traverse_modules,2},
            {httpd_response,generate_and_send_response,1},
            {httpd_request_handler,handle_response,1}] 
```

我知道我使用的是 erlang 版本 13，但是我在项目的 src 中制作了模块 http_uri.erl ，所以通常应该可以使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:11:04.437

如果您查看`http_urii:encode/1`返回的内容，您会发现它不是您明确使用的内容。在我的机器上，我得到：

```
4> http_urii:encode("Vous n'avez, pas d'énheance à payer.").
"Vous%20n%27avez%2C%20pas%20d%27énheance%20à%20payer." 
```

标准 Erlang 版本中有一个模块`http_uri`在这种情况下返回与您的`http_urii`.

# c++ - 插入集合向量时出错

> ID：14242936
> 
> 赞同：0
> 
> 时间：2013-01-09T17:26:43.867
> 
> 标签：c++

我在以下代码中收到错误：“在'a'之前的预期初始化程序”。但我没有得到初始化程序的用途以及我应该如何放置一个。我是 C++ 的初学者，所以请原谅我的新手问题。

```
#include <set>
#include <vector>
#include <iostream>
using namespace std;

int main()
{
 vector<set<unsigned> > a;
 set<unsigned>::iterator it;
 a[0].insert(0);
 a[0].insert(1);
 a[0].insert(2);
 for(it=a[0].begin(); it!=a[0].end; ++it)
 {
  cout<<*it;
 }
 return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:27:44.097

看起来问题（或至少一个问题）是缺少分号：

```
set<unsigned>::iterator it 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:28:14.537

如果不是`using namespace std`，则必须在该命名空间的成员前面加上`std::`：

```
std::vector<std::set<unsigned> > a; 
```

# debian - Debian 软件包差异 例如 +squeeze3

> ID：14242939
> 
> 赞同：1
> 
> 时间：2013-01-09T17:26:51.030
> 
> 标签：debian, apt

我有大约 200 台 Debian 服务器并开始工作以确保盒子上的所有软件包都是相同的（每个环境）。

但是，在我的环境中，我得到的包名称略有不同，如下所示：

2.6.2-5、2.6.2-5+挤压3、2.6.2-5+挤压1、2.6.2-5+挤压6、2.6.2-5+挤压4

正如你所看到的，所有安装的 puppet 包都是 2.6.2-5 - 那么这 +squeezeN 是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:38:23.417

这些情况下的版本是指 NMU 或其他类似的次要更新。上游版本是相同的，但实际的包版本实际上是不同的。您可能需要检查`/usr/share/doc/puppet/changelog.Debian.gz`+squeeze4 以查看究竟发生了什么[变化](http://packages.debian.org/changelogs/pool/main/p/puppet/puppet_2.6.2-5+squeeze6/changelog)。

一般来说，Debian 版本号中的 1suffix 总是大于 1，除了 1~suffix 总是更小。

如果上游版本是 1.23，并且该版本的 Debian 软件包是第五次升级，那么 Debian 版本号是 1.23-5。对于不保证 Debian 部分的整数增量的非常小的更新，您经常会看到类似 5.1 或 5descriptivetag1 的内容。分叉、衍生产品等可能会使用 1.23-5ubuntu3 之类的东西来标记他们的 Debian 版本 5 的第三个版本。

该`+squeeze`部分表示这些版本是对最初发布 Debian Squeeze 时发布的稳定版本的次要更新。Debian 的政策是不在稳定发行版中发布新版本的软件包，除非它们会接受关键的、定义明确的、有限的修复（通常是针对安全漏洞的补丁）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T16:05:33.367

这些版本与发布后的上传有关。

`squeeze`通常，一旦发布（如）完成，包将被冻结。之后，通常只允许上传修复安全相关问题的更新。这些上传在版本中获得了一个额外的 -tag，因此 2.6.2-5+squeeze6 将是发布后第 6 个要压缩的上传。

# c# - .NET Calendar.GetWeekOfYear 为 en-US 返回不正确的结果

> ID：14242940
> 
> 赞同：0
> 
> 时间：2013-01-09T17:26:52.233
> 
> 标签：c#, .net, datetime, calendar, cultureinfo

我搜索了一个类似的帖子，但似乎没有人回答这个问题。

对于日期*01/01/2005*和*12/28/2008*，周数应该是 1，根据*timeanddate.com*网站，假设它是正确的：

[2005 年 1 月 1 日](http://www.timeanddate.com/calendar/custom.html?year=2005&country=1&cols=0&lang=en&wno=1&cdt=31&typ=0&display=3&df=1)和[2008 年 12 月 28 日](http://www.timeanddate.com/calendar/?year=2008&country=1)

问题是，我的 C# 代码为*01/01/2005*生成了正确的周数结果，但为*12/28/2008*生成了不正确的结果，返回 53，而不是 1：

```
CultureInfo clUS = new CultureInfo( "en-US", false );

int wkNm = clUS.Calendar.GetWeekOfYear(
  new DateTime( 2005, 1, 1, clUS.Calendar ),
  clUS.DateTimeFormat.CalendarWeekRule,
  clUS.DateTimeFormat.FirstDayOfWeek
);  // returns 1

wkNm = clUS.Calendar.GetWeekOfYear(
  new DateTime( 2008, 12, 28, clUS.Calendar ),
  clUS.DateTimeFormat.CalendarWeekRule,
  clUS.DateTimeFormat.FirstDayOfWeek
);  // returns 53 
```

对于`CalendarWeekRule`and `FirstDayOfWeek`，我使用的是 en-US 文化的默认选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:16:38.950

可从[此处获得该问题的描述](http://blogs.msdn.com/b/shawnste/archive/2006/01/24/iso-8601-week-of-year-format-in-microsoft-net.aspx)

我对`CalendarWeekRule.FirstFourDayWeek`规则使用下面的方法 - 它检查**星期四的**周数是什么（使用相同的 .NET 方法），因为星期四是使用该规则时真正重要的一天，而微软的代码一直都是正确的:)

```
 private static int WeekNumber(DateTime date)
    {
        var dayOffset = DayOfWeek.Thursday - date.DayOfWeek;
        if (dayOffset > 0)
            date = date.AddDays(dayOffset);

        return CultureInfo.CurrentCulture.Calendar.GetWeekOfYear(date, CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday);
    } 
```

# sharepoint-2010 - Sharepoint 2010：通过 CSOM 将 wiki 页面从一个网站复制到另一个网站后，缺少快速启动和功能区

> ID：14242942
> 
> 赞同：1
> 
> 时间：2013-01-09T17:26:59.497
> 
> 标签：sharepoint-2010

我在将我的 wiki 页面从一个 SharePoint 站点复制到另一个站点时遇到问题。我正在使用 CSOM（客户端对象模型）和以下（简化）代码：

```
 var fileCreationInformation = new SP.FileCreationInformation();

                string page = EXTRACTED VALUE OF THE SOURCE FIELD "wikiField" (string)
                byte[] bytes = new byte[page.Length * sizeof(char)];
                System.Buffer.BlockCopy(page.ToCharArray(), 0, bytes, 0, bytes.Length);

                fileCreationInformation.Content = bytes;
                fileCreationInformation.Overwrite = true;
                fileCreationInformation.Url = EXTRACTED VALUE OF THE SOURCE FIELD "FileLeafRef" (string)

                Microsoft.SharePoint.Client.File uploadFile = oList.RootFolder.Files.Add(fileCreationInformation);
                clientContext.Load(uploadFile);
                clientContext.ExecuteQuery(); 
```

我的问题是在复制之后，我的新 wiki 页面被创建并且内容完美显示，除了没有 Quicklaunch 和 Ribbon。显示的只是我的原始内容（例如 XML 仅用于 xml 页面），有点难看:)

你知道我该如何解决这个问题吗？我是否遗漏了什么，或者我以错误的方式解决问题？

先感谢您！

尼古拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T09:25:06.113

谢谢乔希，这是个好主意。我通过使用 AddTemplateFile 解决了我的问题！这是（简化的）代码：

```
 string path = PATH
                SP.File wikiPage = oList.RootFolder.Files.AddTemplateFile(path, SP.TemplateFileType.WikiPage);
                wikiPage.ListItemAllFields["WikiField"] = CONTENT
                wikiPage.ListItemAllFields.Update(); 
```

# java - 关于计算不同键的总数

> ID：14242951
> 
> 赞同：0
> 
> 时间：2013-01-09T17:27:40.947
> 
> 标签：java

我有一个地图，它在地图中存储脚本号和患者 ID，脚本号是关键，因为它始终是唯一的，如下所示

```
Map m = new LinkedHashMap();
m.put ("123", "23"); 
m.put ("323", "23");
m.put ("153", "23");
m.put ("623", "23");
m.put ("125", "23");
m.put ("122", "24");
m.put ("167", "24");
m.put ("173", "24");
m.put ("113", "25"); 
```

现在我的查询是我需要找出与患者 ID 23 相关联的脚本数量

正如我们在上面看到的，患者 ID 23 共有 5 个不同的脚本，所以我需要计算总的不同脚本和脚本编号也与患者 ID 23 相关联，即 123,323,153,623,125

我已将值显示为示例，但在我的情况下，动态值将填充在地图中，因此请告知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:30:33.667

听起来您需要另一个方向的地图，将患者 ID 映射到计数。每次插入新记录时，`get`该患者的条目并增加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:30:33.113

If`LinkedHashMap`是您拥有的唯一数据结构，唯一的方法是对其进行迭代，并将每个患者 id 与`23`.

如果由于某种原因这不令人满意，您可以构建一个辅助数据结构。但是，如果不了解您的问题，很难在这个方向上提出具体的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:31:20.570

遍历您的`Map`或创建一个`Map`“Patient Id”是键，值是“脚本编号”的列表。

```
 //Field to store the data in:
    Map<PatientId, List<ScriptId>> partientScriptMap = new HashMap<PatientId, 

    // method to add data
    void add(PatientId p, ScriptId s) {
        List<ScriptId> scriptIds = partientScriptMap.get(p);
        if (null == p) {
            scriptIds = new ArrayList<ScriptId>();
        }
        scriptIds.add(s);
        partientScriptMap.put(p, scriptIds);
   }

   // get all ScriptIds related to a PationId 
   List<ScriptId> getScriptIds(PatientId p) {
        return partientScriptMap.get(p);
   } 
```

您的 ScriptIds 和 PatientIds 是否都是字符串，在上面的代码中替换它们，`String` 而不是像这样使用它：

```
 add("123", "23"); 
    add("323", "23");
    add("153", "23");
    add("623", "23");
    add("125", "23");
    add("122", "24");
    add("167", "24");
    add("173", "24");
    add("113", "25");

    System.out.println("scriptIds for 24: "+getScriptIds("24"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:30:14.907

```
int count = 0;
for (int i = 0; i < m.size(); i ++) {
    if (m.get(i) == 23) count ++;
} 
```

只需循环并对照 23 检查每个结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T17:34:55.277

首先，您应该使用泛型，它们更容易使用。

现在您所要做的就是遍历每个键并查看关联的值是否是您要查找的值：

```
Map<String, String> m = new LinkedHashMap<String, String>();
...

List<String> keys = new ArrayList<String>();
for(String str: m.keySet()) {
    if(m.get(str).equals("23")) {
        keys.add(str);
    }
} 
```

# debugging - 在 qemu 中使用 gdb 调试引导加载程序

> ID：14242958
> 
> 赞同：15
> 
> 时间：2013-01-09T17:28:05.947
> 
> 标签：debugging, assembly, gdb, bootloader, qemu

Freedos 引导加载程序似乎有问题。（在某些情况下，引导代码似乎找不到内核。）

所以我正在尝试使用 gdb 调试 qemu 中的引导加载程序。按照在几个 wiki 上找到的说明和免费提供的在线课程资料，我像这样运行 qemu

```
qemu-system-i386 -fda fdboot.img -boot a -s -S 
```

然后像这样连接gdb

```
$ gdb
(gdb) target remote localhost:1234 
```

我可以逐步完成前 10 到 12 条指令`si`，我认为这些指令是 SeaBIOS。

但除此之外，当我尝试进入引导加载程序代码时，它会继续执行而不会中断，一直到 FreeDos 菜单提示符。这完全跳过了我想在执行时逐步检查的引导加载程序代码。

我需要做什么才能逐步通过引导加载程序？

[如果您想亲自尝试，可以从项目网站下载 freedos 软盘图像。]

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-11T00:36:45.477

使用 qemu 1.3 和 gdb 7.3.50.20111117 在这里工作正常（你没有说你使用了什么版本）。我能够单步执行大量指令，直到我感到无聊并放置一个断点来捕获引导加载程序：

```
(gdb) br *0x7c00
Breakpoint 1 at 0x7c00
(gdb) c
Continuing.

Breakpoint 1, 0x00007c00 in ?? ()
(gdb) x/i $eip
=> 0x7c00:      jmp    0x7c3e 
```

请注意，我首先使用`set architecture i8086`.

# ios - 用于管理观察者的 Objective-C 设计模式

> ID：14242971
> 
> 赞同：11
> 
> 时间：2013-01-09T17:28:45.833
> 
> 标签：ios, objective-c, design-patterns

在我的应用程序中，我有一个对象，它封装了通过 HTTP 与服务器的通信。如果服务器上发生更改，例如会话不再有效，或者有新消息给用户等，此对象会发出一些 HTTP 请求以“轮询”。

应用程序的 UI 对象必须将自己注册到通信对象，以通过 UI 对象实现的协议接收通知。注册是通过以下方法完成的：

```
[communicationObject addObserver: self]; 
```

并删除自身：

```
[communicationObject removeObserver: self]; 
```

通信对象将观察者存储在一个可变数组中。在某些情况下，UI 对象是在 UINavigationController 中推送的 UIViewController。在这种情况下，当用户回到父控制器时，UI控制器没有被释放，因为通信对象的观察者数组保留了它，并且UI控制器不能将自己从观察者中移除，因为**dealloc**方法永远不会被调用（明显地）。

问题：这个观察者通知器是一个糟糕的设计模式？**有没有不使用viewWillDisappear**方法检测到 UI 控制器被父控制器释放的方法？有解决此类情况的最佳实践吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-09T17:51:02.420

### 最佳实践

如果您正在使用观察者模式，并且您希望视图控制器*仅*在屏幕上观察一个值，那么调用`addObserver:`in`viewDidAppear`和`removeObserver:`in是一个好主意`viewWillDisappear`。这不是错误的设计或滥用这些方法；实际上，这是标准做法，也是对这些视图控制器方法的很好使用。

如果您希望视图控制器在某个值从屏幕上移除*后*仍继续观察它，请首先**确保**这确实是您想要的。如果是的话，有几件事要记住：

*   特别是，确保您的视图控制器设置为，如果它以前存在并且新出现在屏幕上，则它具有相同的状态，就好像它是从头开始实例化并立即出现在屏幕上一样。一种体面的方法（通常是我在自己的项目中所做的）是将所有设置代码保存在一个`setup`方法中，并确保在实例化和表示时都调用它。
*   此外，请务必避免在后台引发昂贵的无关计算。通常，这可以通过依赖于在`setup`呈现视图控制器时调用的方法来完成，而不是在对象的生命周期内保持一致的状态。
*   最后，一定要记住，视图控制器只有在屏幕上时才连接其出口（视图/子视图，通常统称为视图层次结构）。当它关闭但保留时，这些都是`nil`. 检查其视图层次结构是否就绪的一个好方法是通过`isViewLoaded`属性。

### 保留诉展示

重要的是不要混淆视图控制器（或任何对象，就此而言）被**保留**在某处并且它**在屏幕上**的想法。这些是非常不同的事件，而且通常不会重合。例如，如果您有一个“父”视图控制器（例如`UINavigationController`）管理一个或多个“子”视图控制器，则可能会同时实例化和保留多个视图控制器，而屏幕上仅显示一个一次。

### 更好的是：`NSNotificationCenter`

如果您愿意，处理全局事件的另一个选项是 via `NSNotificationCenter`，它允许您指定`selector`调用观察者的方法，允许匿名发布通知，并让任意事件对象 ( `userInfo`) 与通知事件相关联。通过这种方式，您`communicationObject`将向 发布通知`[NSNotificationCenter defaultCenter]`，并且您的视图控制器将在`defaultCenter`. 您仍然会以类似的方式添加/删除观察者对象，但您会获得一种集中的、更强大的协调全局事件的方式。

# apache - 如何重写 /foo 、 /foo/ 、 /foo/bar ，而不是 /fooofake？

> ID：14242975
> 
> 赞同：0
> 
> 时间：2013-01-09T17:28:52.307
> 
> 标签：apache, .htaccess

**我正在尝试匹配：**

```
http://example.com/foo

http://example.com/foo/

http://example.com/foo/bar

http://example.com/foo/bar/addditional 
```

但不是

```
http://example.com/foofake 
```

任何人都知道如何做到这一点，或者有人对此有任何正则表达式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:28:52.307

我已经看到这个问题被问了很多次，所以和其他地方，我只是想出了这个好把戏，并想分享它。

**这个`RewriteRule`正则表达式可以工作：**

```
RewriteRule ^foo/{0,1}(?![a-z])(.*) 
```

**进一步解释：**

`foo`匹配以 foo 开头的东西。

`/{0,1}`表示必须有零个或一个尾随斜杠。你可能认为这只会匹配 /foo 或 /foo/ ，但这也匹配 /fooofake 因为它在 foo 之后也没有任何尾随斜杠。

`(?![a-z])`这是这个正则表达式的主要部分。这表示方括号内的东西，即 [az] 不应该在 foo 之后。请注意，这仍然会匹配其他字符，例如 /foo+bar。继续阅读更复杂的版本。

`(.*)`表示匹配斜杠后的*任何内容。*这也可以根据需要进行优化。

这是使用相同逻辑的更复杂的版本：

```
foo/{0,1}(?![a-zA-Z0-9`~!@$%^&*()_\-\{\}\[\]\+\=\\\|:;"'>.<,'\s])(.*)$ 
```

这个将我键盘上的所有字符都列入黑名单，这样它们就不会出现在 /foo 之后。

你可以在这里看到迷你版：[http ://regexr.com?33blp](http://regexr.com?33blp)

你可以在这里找到扩展版本：[http ://regexr.com?33bme](http://regexr.com?33bme)

我觉得这个方法有很大的改进空间，所以如果你发现任何缺陷或者你找到了让它更棒的方法，请评论！

# haskell - cabal install --avoid-reinstalls 到底是做什么的？

> ID：14242977
> 
> 赞同：5
> 
> 时间：2013-01-09T17:28:57.363
> 
> 标签：haskell, cabal, cabal-install

我发现`--avoid-reinstalls`在其他情况下 cabal 失败的地方构建包。它到底在做什么？阴谋集团不是已经尝试避免重新安装，还是不应该这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T04:17:03.697

这个邮件列表帖子很好地解释了它：[http ://www.haskell.org/pipermail/beginners/2011-June/007502.html](http://www.haskell.org/pipermail/beginners/2011-June/007502.html)

> 依赖解析算法将尝试制定允许运行 gitit 的一致安装计划。但是，为了实现这一点，它可能决定有必要在新配置中重新安装一些现有的包（具有其他依赖项或标志设置）。这样的重新安装将覆盖商店中以前的包，如果以前的包被其他东西依赖，那么这些其他东西就会中断。

--avoid-reinstalls 标志可以防止这种行为。

# linux - 来自 Linux Ubuntu 64 位的普遍 ODBC 连接 - 未找到 DSNADD

> ID：14242978
> 
> 赞同：2
> 
> 时间：2013-01-09T17:29:10.590
> 
> 标签：linux, odbc, database-connection, pervasive

我正在尝试通过 ODBC 从 Ubuntu 64 位服务器连接到 Pervasive。

我做了以下事情：

1.  使用 apt-get 命令安装**unixodbc 。**
2.  从[Pervasive 站点](http://www.pervasivedb.com/psqlv11/Pages/PSQL-v11-Linux-Downloads.aspx)下载了**Pervasive SQL 64bit Client 11.20**（不知道这是否正确，我必须安装）
3.  提取存档并移动到*/usr/local/psql*

现在，在*/usr/local/psql/bin*我只能看到：

*   clicadm64
*   isql64
*   psregedit64
*   psregsvr64

没有**dsnadd**设置连接驱动程序和 DSN 的痕迹...我做错了什么？

（我是 Linux 新手，所以任何形式的建议都会非常感激）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:00:31.660

如果您使用的是 64 位应用程序，则需要 64 位驱动程序。如果您有 32 位应用程序，则需要 32 位驱动程序。

该`dsnadd`实用程序似乎是 32 位的。您需要安装 32 位客户端才能获得该工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-14T19:26:23.917

我也一直在尝试在 ubuntu 上建立一个普遍的客户端。

这篇文章对我很有帮助，其中包括一个为 64 位编辑的 dsnadd 版本。

[https://tron2001.wordpress.com/2014/09/09/psql-64-bit-linux-client-installation/](https://tron2001.wordpress.com/2014/09/09/psql-64-bit-linux-client-installation/)

请仔细阅读脚本，但我认为您甚至不需要这个 dsnadd 实用程序，因为您可以手动编辑 odbc.ini 来做同样的事情。

# php - PHP比较布尔值和整数

> ID：14242979
> 
> 赞同：0
> 
> 时间：2013-01-09T17:29:18.817
> 
> 标签：php, integer, boolean

```
var_dump((int) true); // returns 1
var_dump(true > 0);  // returns true
var_dump(true > - 1); // returns false
var_dump(1 > - 1); // returns true 
```

有人可以详细解释一下上面这两个的结果是什么，因为它将布尔值与整数进行比较，这让我感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:31:44.660

这个答案不再满足问题，因为 OP 改变了问题。

* * *

您通常不应该比较不同类型的操作数，如果您有一些这样做的代码可能有错误。结果可能没有多大意义。

如果你想知道答案，试试吧：

```
var_dump(true > 0); // gives true
var_dump(true > -1); // gives false 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:31:57.317

`>`是一个数值比较运算符，因此 PHP 进行[“松散比较”](http://php.net/manual/en/types.comparisons.php)并在每种情况下转换`true`为 1 或 -1。

我想在内部发生以下情况：

当您询问 if 时`(true > 0)`，PHP 首先松散地测试 if `true==0`，返回 false，然后用 1 代替`true`，比较返回 true。

当你问 if 时`(true > -1)`，PHP 首先松散地测试 if `true==-1`，返回 true，这意味着`(true > -1)`一定是 false。

简而言之：不要做这样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:48:11.053

通过考虑 Blazemonger 所写的内容，我弄清楚了这里发生了什么。考虑一下：

```
var_dump(true == 0); // returns false
var_dump(true == 1); // true
var_dump(true == -1); // true
var_dump(true == -2); // true 
```

所以真实的东西是零。

对于 > 运算符，PHP 首先测试是否相等（==），所以 true == X 除了 X = 0 之外始终为 true。如果比较结果为 true，则它不能更大，因此 true > X 始终为 false，除非对于 X = 0。

所以：

```
var_dump(true > 0); // true
var_dump(true > 1); // false
var_dump(true > -1); // false
var_dump(true > -2); // false 
```

# mysql - mysql使用带有子选择的主键输出到同一个表中的值

> ID：14242982
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:29:27.940
> 
> 标签：mysql

例如，我如何指代儿子这个名字。当我只有母亲的名字时，**使用子选择**

```
id-Name - mother
1 -son - 2
2 -mommy  - null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:35:49.803

这是使用子选择。

```
SELECT  t.*,
        (SELECT Name FROM TABLE_NAME WHERE mother = t.id) as sons_name
FROM    TABLE_NAME as t
WHERE   t.name = 'Mommy' 
```

但是你也可以使用连接来做到这一点：

```
SELECT  t1.*, t2.name as sons_name
FROM    TABLE_NAME as t1
        LEFT JOIN TABLE_NAME as t2 ON t2.mother = t1.id
WHERE   t1.name = 'Mommy' 
```

# c++ - CImg 库未加载图像

> ID：14242983
> 
> 赞同：0
> 
> 时间：2013-01-09T17:29:30.187
> 
> 标签：c++, stack-overflow, cimg

我已按照 CImg[教程](http://cimg.sourceforge.net/reference/group__cimg__tutorial.html)进行操作，并且效果很好。但是，如果我尝试加载不同的图像（除了 lena.jpg），我会收到堆栈溢出错误。

例如，这有效：

```
CImg<float> image;
string filePath = "C:/Users/zzz/Documents/lena.jpg";
image.load(filePath.c_str()); 
```

但这给出了一个错误：

```
CImg<float> image;
string filePath = "C:/Users/zzz/Documents/anotherimage.jpg";
image.load(filePath.c_str()); 
```

错误是：LoadImageTest.exe 中 0x77bb15de 处的未处理异常：0xC00000FD：堆栈溢出。

我认为堆栈溢出是由于“anotherimage.jpg”太大，所以我也尝试了一个非常小的图像（16x16 像素）。这导致了同样的错误。

有人对为什么会发生这种情况有任何建议吗？

完整代码：

```
#include "stdafx.h"
#include <iostream>

#include "CImg.h"

using namespace cimg_library;
using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    CImg<float> image;

    // This works...
    string filePath = "C:/Users/zzz/Pictures/lena.jpg";

    // This doesn't work...
    // string filePath = "C:/Users/zzz/Pictures/small.jpg";

    image.load(filePath.c_str());

    CImgDisplay main_disp(image, "The image");

    while (!main_disp.is_closed())
    {
        main_disp.wait();
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T08:27:38.777

看起来很奇怪。您确定这确实是 JPG 格式的文件吗？它是否使用一些特殊的 JPEG 格式（黑白、12 位？，...）。

# java - 读取文件时使用分隔符

> ID：14242984
> 
> 赞同：7
> 
> 时间：2013-01-09T17:29:30.797
> 
> 标签：java, delimiter

我几乎没有使用分隔符的经验，我需要读取一个文本文件，该文件存储多个对象，这些对象的数据存储在单行中，由逗号 (",") 分隔。然后使用单独的字符串创建一个新对象，该对象被添加到数组列表中。

```
Amadeus,Drama,160 Mins.,1984,14.83
As Good As It Gets,Drama,139 Mins.,1998,11.3
Batman,Action,126 Mins.,1989,10.15
Billy Elliot,Drama,111 Mins.,2001,10.23
Blade Runner,Science Fiction,117 Mins.,1982,11.98
Shadowlands,Drama,133 Mins.,1993,9.89
Shrek,Animation,93 Mins,2001,15.99
Snatch,Action,103 Mins,2001,20.67
The Lord of the Rings,Fantasy,178 Mins,2001,25.87 
```

我正在使用 Scanner 读取文件，但是我得到一个 no line found 错误并且整个文件被存储到一个字符串中：

```
Scanner read = new Scanner (new File("datafile.txt"));
read.useDelimiter(",");
String title, category, runningTime, year, price;

while (read.hasNext())
{
   title = read.nextLine();
   category = read.nextLine();
   runningTime = read.nextLine();
   year = read.nextLine();
   price = read.nextLine();
   System.out.println(title + " " + category + " " + runningTime + " " +
                      year + " " + price + "\n"); // just for debugging
}
read.close(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T17:36:49.500

使用 read.next() 而不是 read.nextLine()

```
 title = read.next();
   category = read.next();
   runningTime = read.next();
   year = read.next();
   price = read.next(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T17:39:39.713

我想你想调用`.next()`which 返回一个 String 而不是`.nextLine()`. 您的`.nextLine()`呼叫正在越过当前线路。

```
Scanner read = new Scanner (new File("datafile.txt"));
   read.useDelimiter(",");
   String title, category, runningTime, year, price;

   while(read.hasNext())
   {
       title = read.next();
       category = read.next();
       runningTime = read.next();
       year = read.next();
       price = read.next();
     System.out.println(title + " " + category + " " + runningTime + " " + year + " " + price + "\n"); //just for debugging
   }
   read.close(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T17:35:21.253

你应该`next();` 在你使用的地方使用`nextLine();`

看看教程：[http ://docs.oracle.com/javase/tutorial/essential/io/scanning.html](http://docs.oracle.com/javase/tutorial/essential/io/scanning.html)

注意这些行：

```
try {
   s = new Scanner(new BufferedReader(new FileReader("xanadu.txt")));

   while (s.hasNext()) {
   System.out.println(s.next());
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-30T07:51:47.410

上面所有的答案都是正确的，实际上是一样的。然而，重要的一点是每个人都应该记住，`Scanner`缓冲区大小只有 1024。这意味着如果分隔文本的长度更长，解析将停止。

因此，对给定的解决方案进行一点改进，使用`BufferedReader`而不是直接将文件传递给`Scanner`. 例子：

```
 BufferedReader in = new BufferedReader(new FileReader("datafile.txt"), 16*1024);
    Scanner read = new Scanner(in);
    read.useDelimiter(",");
    String title, category, runningTime, year, price;

    while(read.hasNext())
    {
        title = read.next();
        category = read.next();
        runningTime = read.next();
        year = read.next();
        price = read.next();
        System.out.println(title + " " + category + " " + runningTime + " " + year + " " + price + "\n"); //just for debugging
    }
    read.close(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-09T17:33:53.293

您还可以使用 String.split() 函数将字符串转换为字符串数组，然后遍历每个字符串以获得您的值。

[如何将逗号分隔的字符串转换为 ArrayList？](https://stackoverflow.com/questions/7488643/java-how-to-convert-comma-separated-string-to-arraylist)有关更多详细信息，请参阅此内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-09T17:30:56.580

一个问题是：

```
while(read.hasNext())
   {
       title = read.nextLine();
       category = read.nextLine();
       runningTime = read.nextLine();

hasNext() 
```

如果此扫描器在其输入中有另一个标记，则返回 true。不是整行。您需要使用[hasNextLine()](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#hasNextLine%28%29)

您正在执行 nextLine() 三次。我认为您需要做的是，阅读该行并拆分该行。

# joomla - Joomla 搜索结果网址不正确

> ID：14242990
> 
> 赞同：1
> 
> 时间：2013-01-09T17:29:43.383
> 
> 标签：joomla, joomla-sef-urls

我正在使用 Joomla 2.5.4，当我使用搜索组件进行搜索时，网址不是应有的。

预期的网址应如下所示：

```
/desktop-projects/78-projects/76-project
/<MenuItem>/<Category>/<Article> 
```

实际的搜索结果 url 如下所示：

```
/component/content/article/78-projects/76-project 
```

当它链接到这个 /component/content/article/ 样式 url 时，页面没有分配给菜单项的模块。为什么 url 中没有菜单项？

我注意到其他模块/组件也以这种方式链接，我缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-06T10:52:56.183

听起来您的搜索结果未显示在您网站上的正确 URL 上。

在您的搜索模块中，有一个名为“设置 ItemID”的选项。这允许您选择 URL 将使用的菜单项。

如果您将此留空，则您的搜索组件可以使用另一个类型为搜索的菜单项。

# java - 嘲笑班级的问题

> ID：14242992
> 
> 赞同：5
> 
> 时间：2013-01-09T17:29:46.763
> 
> 标签：java, mockito, jdbi

我正在尝试使用 mockito 模拟 JDBI 的[Query](https://github.com/brianm/jdbi/blob/master/src/main/java/org/skife/jdbi/v2/Query.java)类，但是它无法模拟其基类的方法`SqlStatement`。

当运行下面的代码时，when 语句实际上是在调用基类中的具体实现，并以`NullPointerException`.

```
import java.util.Map;

import org.junit.Test;
import org.skife.jdbi.v2.Query;

import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

public class TestClass {
    @Test
    public void testBind() {
        Query<Map<String,Object>> mockQuery = mock(Query.class);
        when(mockQuery.bind("xxx", 5)).thenReturn(mockQuery); //this line fails
        //more stuff here
    }
} 
```

我也用 EasyMock 尝试过，得到了相同的结果，它无法模拟这种方法。

**更多信息：**

*   Mockito 版本是 1.9.5
*   JDBI 版本是 2.4.1（当前与 dropwizard 一起提供的版本）

例外是：

```
 java.lang.NullPointerException
        at org.skife.jdbi.v2.SQLStatement.bind(SQLStatement.java:434)
        at TestClass.testBind(TestClass.java:17)
            at .... 
```

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:29:28.883

`bind`中的方法`SqlStatement`是最终的（例如[`SQLStatement#bind(String, int)`](https://github.com/brianm/jdbi/blob/master/src/main/java/org/skife/jdbi/v2/SQLStatement.java#L432)），因此您不能使用 Mockito 模拟它们，这*是 mockito 目前无法绕过的 JVM（编辑：）*的限制。

* * *

EDIT2：请注意，正如下面的评论所指出的，对上面写的内容存在一些误解，这需要我澄清一下：

*   *JVM 的限制*意味着您无法加载标记为具有最终访问权限的类型的子类，您不能覆盖标记为具有最终访问权限的方法，否则您将得到一个 VerifyError。[§8.1.1.2 Java 语言规范的最终类](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.1.1.2) [§8.4.3.3 JLS 的最终方法](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.3.3) [§4.10 Java 虚拟机规范](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.10)
*   *mockito 无法绕过*意味着 Mockito 目前无法克服 final 类或 final 方法来模拟它们，因为此时 Mockito 使用 CGLIB 生成要模拟的类型的子类。但其他框架（如 PowerMock 或 JMockit）可能能够做到这一点，因为它们有其他策略来*克服*这一点。

* * *

你的选择是改变你的设计，这样你就不必存根那些交互，或者你必须使用 PowerMock，它使用类加载器的复杂技巧来重写类字节码（不是我喜欢的方法，尽管 PowerMock 在技术上令人印象深刻）。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:36:58.003

尝试

```
Mockito.doReturn(mockQuery).when(mockQuery).bind("xxx",5); 
```

# .htaccess - Codeigniter 奇怪的问题，一些带有斜杠的链接工作有些没有

> ID：14242993
> 
> 赞同：1
> 
> 时间：2013-01-09T17:29:46.850
> 
> 标签：.htaccess, codeigniter

我有奇怪的问题。我有一个 Codeigniter 应用程序，它在我的本地机器上运行良好，但在远程服务器上却不行。以下是场景

1.  一些带有斜杠的链接有效，但没有斜杠的链接在 Firefox 中显示“连接已重置”错误。

2.  一些没有尾部斜杠的链接可以工作，但带有尾部斜杠的链接在 Firefox 中显示“连接已重置”错误。

我确信编码没有错误，因为。我认为罪魁祸首是 .htaccess 文件。以下是我的 .htaccess 文件

```
RewriteEngine on
RewriteBase /demo/
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:38:51.617

我相信您的问题是缺少“？” 在这条线上：

```
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

添加这个'？直接在“index.php”之后

```
RewriteRule ^(.*)$ index.php?/$1 [L,QSA] 
```

另外，根据我的经验，我会去掉 RewriteBase 上的斜杠，并将其添加到 $config['base_url'] 参数中，然后让 CI 为您完成这项工作：

```
$config['base_url'] = 'http://yourwebsite.com/demo/';
-instead of-
$config['base_url'] = 'http://yourwebsite.com/demo'; 
```

这是我在 CI 中使用了一段时间的 .htaccess 设置，它对我很有帮助：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase / # TODO: add a folder name here if the application is not in web root

  RewriteCond %{REQUEST_URI} ^system.*
  RewriteRule ^(.*)$ /index.php?/$1 [L]

  RewriteCond %{REQUEST_URI} ^application.*
  RewriteRule ^(.*)$ /index.php?/$1 [L]

  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
  # If we don't have mod_rewrite installed, all 404's
  # can be sent to index.php, and everything works as normal.
  # Submitted by: ElliotHaughin

  ErrorDocument 404 /index.php
</IfModule> 
```