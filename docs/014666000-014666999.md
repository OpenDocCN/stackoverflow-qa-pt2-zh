# StackOverflow 问答 14666000-14666999

# ruby-on-rails - Rails app deploy with rubber - error in create_staging

> ID：14666000
> 
> 赞同：0
> 
> 时间：2013-02-02T20:10:45.263
> 
> 标签：ruby-on-rails, deployment, amazon-web-services, capistrano

rails 3.2.8 ruby 1.9.3 I want to deploy a simple rails app to aws, vulcanized with complete_passenger_nginx_postgresql placed aws key, secret and account in rubber.yml

During cap rubber:create_staging, I get an error, and I don't know its source and how to investigate. Would love your suggestions.

*   2013-02-02 21:46:17 executing `rubber:setup_local_aliases' /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/recipes/rubber/setup.rb:92:in`block (3 levels) in load': can't convert nil into String (TypeError) from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/instance.rb:188:in `each' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/instance.rb:188:in`each' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/recipes/rubber/setup.rb:77:in `block (2 levels) in load' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:138:in`instance_eval' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:138:in `invoke_task_directly' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/callbacks.rb:25:in`invoke_task_directly_with_callbacks' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:89:in `execute_task' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/namespaces.rb:191:in`method_missing' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/namespaces.rb:110:in `block in define_task' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/recipes/rubber/instances.rb:383:in`post_refresh' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/recipes/rubber/instances.rb:242:in `create_instances' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/recipes/rubber/instances.rb:29:in`block (2 levels) in load' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:138:in `instance_eval' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:138:in`invoke_task_directly' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/callbacks.rb:25:in `invoke_task_directly_with_callbacks' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:89:in`execute_task' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/namespaces.rb:191:in `method_missing' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/namespaces.rb:110:in`block in define_task' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/rubber-2.1.2/lib/rubber/recipes/rubber/utils.rb:27:in `block (2 levels) in load' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:138:in`instance_eval' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:138:in `invoke_task_directly' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/callbacks.rb:25:in`invoke_task_directly_with_callbacks' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:89:in `execute_task' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/configuration/execution.rb:101:in`find_and_execute_task' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/cli/execute.rb:46:in `block in execute_requested_actions' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/cli/execute.rb:45:in`each' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/cli/execute.rb:45:in `execute_requested_actions' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/cli/help.rb:19:in`execute_requested_actions_with_help' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/cli/execute.rb:34:in `execute!' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/lib/capistrano/cli/execute.rb:14:in`execute' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/gems/capistrano-2.14.1/bin/cap:4:in `<top (required)>' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/bin/cap:19:in`load' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/bin/cap:19:in `<main>' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/bin/ruby_noexec_wrapper:14:in`eval' from /Users/yanivpreiss/.rvm/gems/ruby-1.9.3-p362/bin/ruby_noexec_wrapper:14:in `'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T12:02:58.490

`rubber:setup_local_aliases`似乎是问题的根源，所以也许你没有在你的 Rubber.yml 文件中正确设置一些东西。`domain name`也许忘了设置？此外，我昨天尝试部署`complete_unicorn_nginx_postgresql`，HAproxy 在与 nginx_unicorn 的端口绑定中遇到了一些问题，所以要小心这些问题。

# svn - What plugin should I use to integrate TortoiseSVN into Visual Studio 2012 on Windows 8?

> ID：14666002
> 
> 赞同：5
> 
> 时间：2013-02-02T20:10:50.103
> 
> 标签：svn, visual-studio-2012, windows-8, visualsvn

I have TortoiseSVN installed on my local machine just to improve my knowledge of subversion on some small personal projects. I downloaded and attempted to install VisualSVN to integrate TortoiseSVN into Visual Studio, but the VisualSVN installer threw an error--`There is a problem with this Windows installer package. A DLL required for this install to complete could not be run.`

Are there any other programs/plugins that integrate TortoiseSVN into Visual Studio 2012 that are compatible with Windows 8?

Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:27:14.860

要将 VS 与 Subversion 集成，我使用[Agent SVN](http://www.zeusedit.com/agent)，这对我来说效果很好。

我已在 Windows 7 和 Windows XP 上尝试过此设置，但尚未在 Windows 8 机器上尝试过此设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T01:55:05.687

我在 Windows 8 上使用[AnkhSVN](http://ankhsvn.open.collab.net/downloads)将 Visual Studio 与 Subversion 集成。它是独立的，与 TortoiseSVN 无关。

# modeling - 统一过程 (UP) 与统一建模语言 (UML)

> ID：14666003
> 
> 赞同：6
> 
> 时间：2013-02-02T20:10:52.747
> 
> 标签：modeling, uml, methodology, specifications

统一过程 (UP) 和统一建模语言 (UML) 有什么区别？有区别吗，还是使用任何一个都一样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-04T04:52:23.270

用非常简单的话来说：

UML 是一种建模语言，是一组用于绘制图表的规则和标准。UP是一种软件开发方法论或过程，一步步告诉你开发软件应该做什么！其中一些步骤可能需要绘制 UML 图。

# java - 如何在 Java 中打印已经格式化的字符串

> ID：14666004
> 
> 赞同：1
> 
> 时间：2013-02-02T20:10:58.777
> 
> 标签：java, println, system.out

我有一段已经缩进了。例如

```
Hello:
     Hi every body 
```

现在我想用 Java 打印它。使用`System.out.println`我必须把这个函数放在每一行。当你在 python 中使用 print 时，我怎么能这样做，你只需在它周围放一个 " 并且它已经准备好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:15:40.637

像这样格式化字符串是一种方法：

```
"Hello:\n\tHi every body" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:14:11.567

您可以使用特殊字符，例如`\n`换行符。

```
System.out.println("Hello:\n     Hi everybody"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T20:15:06.400

你有一个`String.format`方法，它返回一个`formatted`字符串： -

```
String str = String.format("%s%n%20s", "Hello", "Hi everyone!");
System.out.println(str); 
```

`%n`in 字符串格式用于打印一个`newline`字符。

`%20s`将正确缩进字符串，并将占用字符`20`空间。

* * *

如果要打印格式化的字符串，而不是存储它，可以使用`System.out.format`：-

```
System.out.format("%s%n%20s", "Hello", "Hi everyone!"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:13:53.917

当然，您只需使用换行符和制表符转义序列 -`\t`并且`\n`

这是一个简单的例子：

```
//Note: Text content in the code blocks is automatically word-wrapped
import java.io.*;  

class Tabs {  
  public static void main(String[] args) {  
    try {  
      String t = "\t\t";  
      PrintStream ps = new PrintStream("tabs.txt");  
      ps.print("A" + t + "B");  
      ps.print("C\t\tD");  
    } catch(Exception e) {  
      System.err.println(e);  
    }  
  }  
} 
```

[来源](http://www.coderanch.com/t/511159/java/java/Printing-tab-characters)

另请参阅 -[使用“\t”（制表符）打印不会导致列对齐](https://stackoverflow.com/questions/6000810/printing-with-t-tabs-problem)

玩它，你会明白的

# javascript - 如何在输入文本密码上添加标签以避免这些项目符号？

> ID：14666007
> 
> 赞同：1
> 
> 时间：2013-02-02T20:11:20.343
> 
> 标签：javascript, html

将标签放在输入类型密码上的最佳方法是什么，因为它将其值显示为*** * ？

没有可以放置编辑按钮的地方，所以我想放置一些文本，例如：

```
Click here... 
```

所以用户可以点击 em 编辑密码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:13:43.033

```
<input placeholder="Click here..." type="password" name="password"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:14:05.467

1.  [使用背景图像并在他们输入文本时将其换掉](https://stackoverflow.com/questions/2934315/change-of-a-background-image-of-a-button-on-onclick-event)
2.  使用 HTML 5 的[`placeholder`](http://www.whatwg.org/specs/web-apps/current-work/multipage/common-input-element-attributes.html#attr-input-placeholder)属性

> 占位符属性表示一个简短的提示（一个单词或短语），用于在控件没有值时帮助用户输入数据。提示可以是示例值或预期格式的简要描述。如果指定了该属性，则该属性的值必须不包含 U+000A 换行 (LF) 或 U+000D 回车 (CR) 字符。
> 
> 占位符属性不应用作标签的替代品。对于较长的提示或其他建议性文本，title 属性更合适。
> 
> 这些机制非常相似，但略有不同：控件标签给出的提示始终显示；在用户输入值之前显示占位符属性中给出的简短提示；当用户请求进一步帮助时，会显示 title 属性中的提示。
> 
> 当元素的值为空字符串或控件未获得焦点（或两者兼有）时，用户代理应在删除换行符后向用户显示此提示，例如通过将其显示在空白的未获得焦点的控件中并以其他方式隐藏它.
> 
> 以下是使用占位符属性的邮件配置用户界面示例：

```
<fieldset>  
  <legend>Mail Account</legend>  
    <p><label>Name: <input type="text" name="fullname" placeholder="John Ratzenberger"></label></p>  
    <p><label>Address: <input type="email" name="address" placeholder="john@example.net"></label></p>  
    <p><label>Password: <input type="password" name="password"></label></p>  
    <p><label>Description: <input type="text" name="desc" placeholder="My Email Account"></label></p> 
</fieldset> 
```

# apache - 无法在 Apache/2.2.21 (Win32) 中加载 mod_fcgid

> ID：14666009
> 
> 赞同：1
> 
> 时间：2013-02-02T20:11:21.200
> 
> 标签：apache, mod-fcgid

我正在使用 Apache/2.2.21 (Win32)

[我从http://www.apachelounge.com/download/win32/modules-2.2/mod_fcgid-2.3.7-win32.zip](http://www.apachelounge.com/download/win32/modules-2.2/mod_fcgid-2.3.7-win32.zip)下载了 mod_fcgid

我用了

```
LoadModule mod_fcgid modules/mod_fcgid.so 
```

加载 mod_fcgid

但我收到了这个错误

```
httpd.exe: Syntax error on line 86 of F:/xampp/apache/conf/httpd.conf: Can't locate API module structure `mod_fcgid' in file F:/xampp/apache/modules/mod_fcgid.so: No error 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:15:26.540

它应该是

```
LoadModule fcgid_module modules/mod_fcgid.so 
```

# model-view-controller - Best practices: which PHP or Python framework to choose as backend (see desired criteria) for Ember.js?

> ID：14666012
> 
> 赞同：2
> 
> 时间：2013-02-02T20:11:35.207
> 
> 标签：model-view-controller, ember.js

I'm new to Ember.js and trying to see if it fits me.

I'm building a web app where each user can signup and get into its member area. Then the app uses a Platform via RESTful API to provide user with context-specific features (i.e. create a shared folder, upload files, etc..)

The goal is to scale the app later on and deploy it onto different domains leveraging the power of the Platform.

At this point i'm looking for the framework to supply Ember.js with data and handle persistence (i.e. storing info on new users into database and sending corresponding API call to the Platform). The topics I'm concerned with are:

1.  what's the best way to manage authentication/session via Ember.js+backend?
2.  If i have to store the data in the database anyway, why would I use Ember.js and not just rely on features already provided by MVC frameworks written in Python/PHP?

Thanks in advance for any insights and/or references.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T14:23:22.180

哪个框架（任何语言）最适合 Ember.js 的答案基本上是：“任何”。您可能将 Ember 视为具有文档脚本模式（如 Backbone 或普通旧 jQuery）的框架，其中服务器呈现文档，而 javascript 逐渐将其行为增强为不那么静态的东西。最好将 Ember 想象成一个微型 Cocoa / Android，它将浏览器作为运行时环境而不是特定的移动平台。

无论环境如何，客户端应用程序都适用于任何语言和任何服务器应用程序 Web 框架。只要应用程序使用 HTTP 并支持发送数据（不仅仅是渲染页面），你就可以了。您甚至不必一定使用 JSON 作为数据格式，尽管如今大多数人都选择这种格式。

要回答您的其他问题：

1.  身份验证是 Web 上的服务器问题，因此 Ember 与它没有任何关系。将整个应用程序放在登录页面后面，并使用您想要的任何身份验证机制。如果您的应用程序的某些部分需要在身份验证之前公开，我只需在身份验证之前和之后公开一个完全不同的构建（或具有不同路由器的相同构建）。否则，您会发现`isAuthenticated`支票在您的路线和模板中乱扔垃圾。

2.  您会为浏览器编写完整的客户端应用程序，原因与任何人在任何地方构建客户端应用程序的原因相同：状态性和数据传输成本。Web 设计为无状态。您可以通过会话获得基本的无状态，如果您的应用程序可以被视为一系列文档，这就足够了。完全跳过客户端应用程序，将客户端设备视为愚蠢的文档查看器。如果您有更复杂的状态需求，则需要在客户端环境中自行处理。一旦你决定这是必要的，你会发现发送数据比发送页面或页面片段便宜得多。因此，您的服务器应用程序（以您想要的任何设计模式）公开数据，而您的客户端应用程序（以类似 MVC 的模式）使用、显示、并允许通过这些数据进行导航和交互。如果您的客户端是在 iPhone 上运行的 ObjC/Cocoa、Android 上运行的 Java、Roku 上运行的 BrightScript、浏览器中运行的 Ember，甚至是为需要远程数据的 Windows 应用程序提供支持的 C#，那么情况就是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:18:47.613

我没有使用过 Ember.js 但我很好奇看到你的问题，我只是在谷歌上输入了“ember js and”。没有 Python，但第三个选项是 PHP。最多的结果是“ember js 和 rails”。我建议你看看这个选项。我认为这是关于 Ember.js 的最佳和最有文档的选项。

如果我必须在 PHP 和 Python 之间进行选择，我的选择是选择 PHP。它更复杂，更大的社区等等。但我建议你给 RAILS 一个机会。你必须尝试一下。有很多关于 ember.js 和 rails 的教程和文档。

希望我有所帮助。

# visual-studio-2010 - AWS Toolkit for Visual Studio 2010

> ID：14666014
> 
> 赞同：2
> 
> 时间：2013-02-02T20:11:45.830
> 
> 标签：visual-studio-2010, amazon-web-services

Solution explorer in VS 2010 SP1 crash after installing AWS Toolkit for VS2010:

An exception was encountered while constructing the content of this frame. This information is also logged by running the application with the `/log` parameter on the command line, which stores results in `C:\Users\Administrator\AppData\Roaming\Microsoft\VisualStudio\10.0\ActivityLog.xml`.

Exception details:

```
System.OutOfMemoryException: Insufficient memory to continue the execution of the program.
   at System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)
   at System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32 errorCode)
   at Microsoft.VisualStudio.Platform.WindowManagement.WindowFrame.ConstructContent() 
```

Any ideas?

# python - 配置不当 /

> ID：14666017
> 
> 赞同：0
> 
> 时间：2013-02-02T20:12:05.773
> 
> 标签：python, django, url, django-grappelli

我在尝试配置我的管理员 grappelli 时遇到错误。每当我的索引被注释掉时，管理页面都可以正常工作。但是当取消注释时，它会给我一个错误，在 /admin/ 处配置不当。那我应该如何配置管理员呢？

```
from django.conf.urls.defaults import *
from django.views.static import *

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    (r'^admin/', include('apps.grappelli.urls')),
    (r'^admin/', include(admin.site.urls)),
    (r'^$', include('apps.index.views')),

    # Examples:
    #(r'^blog/', include('apps.blog.views')),

    # Uncomment the admin/doc line below to enable admin documentation:
    #(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:

) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:33:19.610

这是我的`urlconf`，我也在使用 grampelli 并且工作正常，

```
urlpatterns = patterns('',
    url(r'^admin/', include(admin.site.urls)),
    url(r'^grappelli/', include('grappelli.urls')), 
```

我建议你使用[django-boilerplate](https://github.com/martinogden/django-boilerplate)来摆脱这个小配置问题。

# java - Java Graphics drawArc with high precision

> ID：14666018
> 
> 赞同：5
> 
> 时间：2013-02-02T20:12:09.340
> 
> 标签：java, graphics, awt, java-2d

I'm trying to draw a high precision arc in Java using AWT/Swing. The Graphics class offers the "drawArc" method to do this and in most cases this is fine. However, when the arc has a large radius (I.e. The "width" and "height" parameters are large) then the arc will not be drawn precisely. This is because the "startAngle" and "arcAngle" parameters are given as integer degrees. I'm forced to convert an angle (given in radians) to degrees and then rounding it. The loss of precision leads to the arc falling short of its actual end point (if you round down) or go further than it should (if you round up).

I'm looking for an alternative method of drawing arcs. Preferable this should work in the same way but accept floating point angles as parameters.

If such a function does not exist (I've not been able to find one) I would like to write it myself, but I have no idea how to go about this as the Graphics class already offers the lowest level drawing methods I can find. The only idea I had is to approximate the arc with a sequence of straight lines but to get a smooth arc you would need a lot of lines and this seems dreadfully inefficient.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:18:24.760

如果您希望对角度参数使用双精度值，为什么不使用[Arc2D](http://docs.oracle.com/javase/7/docs/api/java/awt/geom/Arc2D.html)对象，例如[Arc2D.Double](http://docs.oracle.com/javase/7/docs/api/java/awt/geom/Arc2D.Double.html)呢？您提到的所有参数都是双重类型。

另外，您是否正确设置了 Graphics2D 对象的 RenderingHints 以允许抗锯齿？

例如，

```
import java.awt.*;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;
import java.awt.geom.Arc2D;

import javax.swing.*;

@SuppressWarnings("serial")
public class TestArc2D extends JPanel {
   private static final int PREF_W = 1000;
   private static final int PREF_H = 400;
   private static final Stroke STROKE = new BasicStroke(5f);
   private static final Color ARC_COLOR = Color.red;
   private Arc2D arc;

   public TestArc2D() {
      addComponentListener(new ComponentAdapter() {
         @Override
         public void componentResized(ComponentEvent e) {
            double x = 10;
            double y = x;
            double w = getWidth() - 2 * x;
            double h = 2 * getHeight() - 2 * y - 50;
            double start = 0;
            double extent = 180.0;
            arc = new Arc2D.Double(x, y, w, h, start , extent, Arc2D.OPEN);
         }
      });
   }

   @Override
   protected void paintComponent(Graphics g) {
      super.paintComponent(g);
      Graphics2D g2 = (Graphics2D) g.create();
      g2.setStroke(STROKE);
      g2.setColor(ARC_COLOR);
      g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);
      if (arc != null) {
         g2.draw(arc);
      }
      g2.dispose();
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   private static void createAndShowGui() {
      TestArc2D mainPanel = new TestArc2D();

      JFrame frame = new JFrame("TestArc2D");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-07T19:03:10.987

使用 Graphics2D，您可以使用 rotate(theta,x,y) 函数精确绘制弧线的一端：

```
g2.rotate(-1*thetaStartRadians,xc,yc);
g2.drawArc(x1,y1,width,height,0, thetaLengthDegrees-1);
g2.rotate(thetaStartRadians,xc,yc); 
```

然后你只需要精确地画出另一边的最后一点：

```
g2.rotate(-1*thetaLengthRadians,xc,yc);
g2.drawArc(x1,y1,width,height,0,-2));
g2.rotate(thetaLengthRadians,xc,yc); 
```

并且您将绘制一条弧线以精确的 theta 值。在机器方面，这可能不是最有效的方法，因为有一点重绘重叠；但这是我能想到的最简单的方法。

# hibernate - Hibernate 自动创建我的表。这有什么问题吗？

> ID：14666031
> 
> 赞同：1
> 
> 时间：2013-02-02T20:13:46.023
> 
> 标签：hibernate

首先，我应该说我是 Hibernate 技术的初学者。（嗯，实际上，我已经在几个项目中使用过它）。但我想知道你对此的看法。我使用 Hibernate 注释以这种方式创建我的数据库的所有表：

*   使用“hibernate.hbm2ddl.auto=create-drop”，（一遍又一遍）直到我最终得到我需要的数据库模型。

*   然后我尝试从 Hibernate 生成的数据库模型中获取 SQL 脚本（例如，使用 Workbench）。

*   我删除了我的数据库，然后再次创建它，但现在使用的是 SQL 脚本。

*   之后，在我的项目中，我将属性“hibernate.hbm2ddl.auto=create-drop”更改为“hibernate.hbm2ddl.auto=update”。

我想知道，我是否以正确的方式使用 Hibernate？还是总是建议先创建数据库模型再做其他事情。（或者这取决于你在做什么类型的项目）

抱歉我的拼写错误，如果有的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:17:27.093

您的方法是可以接受的，这就是您通常原型和开始新项目的方式。然而，一旦你稳定下来，你应该采取更多的行动。首先检查 Hibernate 生成的脚本。自定义外键名称、约束、数据类型等。它们并不总是完美的。

此外要注意`update`策略。这并不总是正确的。在现实世界中，一旦您推出了应用程序的第一个版本，您将需要更稳定的工具，例如[flyway](/questions/tagged/flyway "显示标记为“flyway”的问题")来管理数据库迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:18:00.017

我认为这在开发环境中是可以的，但你显然不能在生产环境中删除表。

我们之前遇到过类似的问题，我们曾经让 hibernate 在本地创建表，但在 qa 和 staging 上使用 SQL ddl 脚本。我们遇到了数据类型不一致的问题。

因此，您必须确保数据类型等始终匹配。

我想最好的做法是准确地反映您在 prod on dev 中所做的事情，并使用相同的 SQL 脚本来创建表。

# c# - 如何在不返回标签的情况下返回两个标签之间的字符串（仅使用正则表达式）

> ID：14666033
> 
> 赞同：0
> 
> 时间：2013-02-02T20:13:47.210
> 
> 标签：c#, regex

```
 string x = "[string] two[string] (1thing)";
        Regex sort1 = new Regex(@"\[(.*?)\]");
        MatchCollection sortOpen = sort1.Matches(x);
        foreach (Match y in sortOpen)
        {
            ..
        } 
```

带括号返回：如何返回没有用于排序的标签的字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:56:53.843

您可以使用

```
(?<=\[)(.*?)(?=\]) 
```

在 .NET 中。`(?<=expression)`匹配`expression` **前缀**但将其从捕获中排除，同时`(?=expression)`匹配`expression` **后缀**但将其从捕获中排除。

# c# - LuaInterface/C# - 使用 .NET 对象创建的闭包永远不会被清理

> ID：14666047
> 
> 赞同：1
> 
> 时间：2013-02-02T20:15:24.177
> 
> 标签：c#, function, lua, closures, luainterface

我在 C# 应用程序中使用最新版本的 LuaInterface ( [http://code.google.com/p/luainterface/ )。](http://code.google.com/p/luainterface/)我遇到了一个问题，即 Lua 类无法清理 ObjectTranslator 'objects' 和 'objectsBackMap' 字典中的内部引用，导致内存使用量一直在增长。

下面的代码说明了这个问题：

```
public class Program
{
    public static void Main()
    {
        Lua lua = new Lua();
        string f = @"
            return function(myClass, dotNetObject)
              local f = function() dotNetObject:TestMethod() end
              myClass:StoreFunction(f);
            end";

        var result = lua.DoString(f)[0] as LuaFunction;

        MyClass testItem = new MyClass();

        for (int i = 0; i < 50; i++)
        {
            DotNetObject o = new DotNetObject();
            result.Call(testItem, o);
        }

        lua.DoString("collectgarbage()");
        ObjectTranslator translator = (ObjectTranslator)typeof(Lua).GetField("translator", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance).GetValue(lua);
        Console.WriteLine("Object count: " + translator.objects.Count);
        //Prints out 51\. 50 of these items are instances of 'DotNetObject', despite them being unreachable.
        //Forcing a .NET garbage collection does not help. They are still being held onto by the object translator.
    }

    public class MyClass
    {
        public void StoreFunction(LuaFunction function)
        {
            //I would normally save off the function here to be executed later
        }
    }

    public class DotNetObject
    {
        public void TestMethod()
        {
        }
    }
} 
```

当匿名函数（本地 f = ...）从外部范围创建涉及 .NET 对象的闭包时，就会出现问题。只要 Lua 解释器还活着，我创建的 50 个 DotNetObject 类实例就永远不会被垃圾回收，即使在 Lua 中强制进行 GC 时也是如此。

在 MyClass.StoreFunction 中手动处理 LuaFunction (function.Dispose()) 对象可以解决问题，但这是不可取的，因为在我的实际应用程序中，我不知道函数何时会执行——或者它是否会执行。强迫我处置 LuaFunction 会改变应用程序的整个架构，因此我基本上是通过处置包含 LuaFunction 的对象以及包含该对象的对象，一直沿链向上进行手动内存管理。

那么，这是 LuaInterface 中的一个错误，还是我错误地使用了该库？非常感谢任何建议，谢谢！

# android - 如何在不解锁的情况下从锁屏小部件启动活动？

> ID：14666051
> 
> 赞同：4
> 
> 时间：2013-02-02T20:15:39.050
> 
> 标签：android, android-intent, android-widget

我在锁屏小部件上有一个按钮，我希望该按钮在按下时启动一个活动。如果屏幕被锁定，我希望活动出现在锁定屏幕上，而用户无需输入 PIN 或图案或其他任何内容，并且当用户离开活动时，锁定屏幕应该重新出现。

我知道，如果我从 ADB shell手动启动它`WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED`，我的活动*确实会出现在锁屏上。*`am start`问题是，当我按下小部件中的按钮时，它会让我在创建活动之前输入解锁 PIN。

我的小部件提供程序中有此代码：

```
@Override
public void onUpdate(final Context context, final AppWidgetManager appWidgetManager, final int[] appWidgetIds) {
    for (final int appWidgetId : appWidgetIds) {
        // Get the RemoteViews for controlling this widget instance.
        final RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.my_widget);

        // Construct an intent to launch the activity.
        final Intent intent = new Intent(context, MyActivity.class);
        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        // Attach the intent to the widget's button.
        final PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0);
        views.setOnClickPendingIntent(R.id.my_button, pendingIntent);

        appWidgetManager.updateAppWidget(appWidgetId, views);
    }
} 
```

这是代码`MyActivity`：

```
public MyActivity() {
    Log.d(TAG, "Activity instantiated");
}

@Override
protected void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Allow this activity to appear over the lock screen.
    final Window window = getWindow();
    window.addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);

    setContentView(R.layout.my_activity);
} 
```

当我按下小部件中的按钮时，系统会提示我输入解锁 PIN。*活动构造函数中的日志消息直到我输入 PIN后*才会出现，这意味着 Android 决定在 PIN 产生任何效果之前要求输入PIN *。*`FLAG_SHOW_WHEN_LOCKED`

有没有办法告诉Android我想在屏幕仍然锁定时启动活动？也许我可以在我的`Intent`or上设置一个标志`PendingIntent`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T10:04:17.193

您可以使用广播意图并在您的小部件提供程序中收听它，然后在 onRecieve 方法上启动活动意图，这不会解锁您的设备，但会在前台启动您的活动，而无需请求用户解锁。

```
Intent broadcastIntent = new Intent("com.yourapp.yourbroadcast");
widget.setOnClickPendingIntent(R.id.yourButton,  
                               PendingIntent.getBroadcast(ctxt, 0, broadcastIntent, PendingIntent.FLAG_UPDATE_CURRENT)); 
```

在您的 onRecieve(Context ctx, Intent intent) 上：

```
if (intent.getAction().equals("com.yourapp.yourbroadcast"))
{ 
       final Intent intent = new Intent(context, MyActivity.class);
       intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
       ctx.startActivity(intent) ;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T19:18:18.270

在您的清单中：

```
<receiver
        android:name=".YourWidget"
        android:label="Your Widget description" >
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            <action android:name="com.yourpackage.widgetbroadcast" />
        </intent-filter>
        <meta-data
            android:name="android.appwidget.provider"
            android:resource="@xml/wisget_yourwidget" />
</receiver> 
```

你的小部件类：

```
public class YourWidget extends AppWidgetProvider {
    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
        for (int i = 0; i < appWidgetIds.length; i++) {
            int appWidgetId = appWidgetIds[i];      
            RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
            Intent intent = new Intent("com.yourpackage.widgetbroadcast");
            PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, 0);
            views.setOnClickPendingIntent(R.id.widget_yourlayout, pendingIntent);
            appWidgetManager.updateAppWidget(appWidgetId, views);
        }
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        super.onReceive(context, intent);
        if (intent.getAction().equals("com.yourpackage.widgetbroadcast")) {
            Intent intentStart = new Intent(context, MainActivity.class);           
            intentStart.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            context.startActivity(intentStart);
        }
    }
} 
```

在您的 MainActivity 中：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);        
    Window w = getWindow();
    w.addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);
    //Your code...
} 
```

确保将活动中的寡妇标志设置为 FLAG_SHOW_WHEN_LOCKED 而不是 FLAG_DISMISS_KEYGUARD 以保持屏幕锁定。此示例将通过单击小部件来启动活动。

# python - 如何让我的 Python 脚本永远运行？

> ID：14666053
> 
> 赞同：3
> 
> 时间：2013-02-02T20:15:42.877
> 
> 标签：python

我有一个读取传感器值的 python 脚本（摘录如下）。不幸的是，它一次只运行 5 - 60 分钟，然后突然停止。有没有办法可以有效地让它永远运行？为什么像这样的 python 脚本不能在 Raspberry Pi 上永远运行，或者 python 会自动限制脚本的持续时间？

```
 while True:
    current_reading = readadc(current_sensor, SPICLK, SPIMOSI, SPIMISO, SPICS)
    current_sensed = (1000.0 * (0.0252 * (current_reading - 492.0))) - correction_factor

    values.append(current_sensed)
    if len(values) > 40:
           values.pop(0)

    if reading_number > 500:
           reading_number = 0

    reading_number = reading_number + 1

    if ( reading_number == 500 ):
           actual_current = round((sum(values)/len(values)), 1)

           # open up a cosm feed
           pac = eeml.datastream.Cosm(API_URL, API_KEY)

           #send data
           pac.update([eeml.Data(0, actual_current)])

           # send data to cosm
           pac.put() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:23:40.293

看起来您的循环似乎没有延迟，并且不断地附加您的“值”数组，这可能会导致您在相当短的时间内耗尽内存。我建议添加延迟以避免每次都附加值数组。

**添加延迟：**

```
import time
while True:
    current_reading = readadc(current_sensor, SPICLK, SPIMOSI, SPIMISO, SPICS)
    current_sensed = (1000.0 * (0.0252 * (current_reading - 492.0))) - correction_factor

    values.append(current_sensed)
    if len(values) > 40:
           values.pop(0)

    if reading_number > 500:
           reading_number = 0

    reading_number = reading_number + 1

    if ( reading_number == 500 ):
           actual_current = round((sum(values)/len(values)), 1)

           # open up a cosm feed
           pac = eeml.datastream.Cosm(API_URL, API_KEY)

           #send data
           pac.update([eeml.Data(0, actual_current)])

           # send data to cosm
           pac.put()
    time.sleep(1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:24:02.567

理论上，这应该永远运行，并且 Python 不会自动限制脚本执行。我猜你遇到了问题`readadc`或`pac`提要挂起并锁定脚本或执行中的异常（但你应该看到如果从命令行执行脚本）。脚本是挂起还是停止并退出？

如果您可以使用 Pi 输出一些数据`print()`并在 Pi 上查看它，您可以添加一些简单的调试行来查看它挂在哪里 - 您可能无法使用超时参数轻松修复它。另一种方法是线程化脚本并将循环体作为线程运行，主线程充当看门狗，如果处理线程花费太长时间来完成他们的工作，则终止处理线程。

# javascript - jQuery Highcharts 不适用于 JSF 2.0

> ID：14666057
> 
> 赞同：0
> 
> 时间：2013-02-02T20:16:02.457
> 
> 标签：javascript, jquery, jsf, highcharts

我尝试将 JavaScript 库“Highcharts 2.3.5”（基于 jQuery）与 Java Server Faces 2.0（Apache MyFaces）一起使用。

我只是想从 Highcharts 示例中尝试一个基本示例。示例如下所示：

```
<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Highcharts Example</title>

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script type="text/javascript">
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'line',
                marginRight: 130,
                marginBottom: 25
            },
            title: {
                text: 'Monthly Average Temperature',
                x: -20 //center
            },
            subtitle: {
                text: 'Source: WorldClimate.com',
                x: -20
            },
            xAxis: {
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                    'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yAxis: {
                title: {
                    text: 'Temperature (°C)'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            tooltip: {
                formatter: function() {
                        return '<b>'+ this.series.name +'</b><br/>'+
                        this.x +': '+ this.y +'°C';
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
                x: -10,
                y: 100,
                borderWidth: 0
            },
            series: [{
                name: 'Tokyo',
                data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
            }, {
                name: 'New York',
                data: [-0.2, 0.8, 5.7, 11.3, 17.0, 22.0, 24.8, 24.1, 20.1, 14.1, 8.6, 2.5]
            }, {
                name: 'Berlin',
                data: [-0.9, 0.6, 3.5, 8.4, 13.5, 17.0, 18.6, 17.9, 14.3, 9.0, 3.9, 1.0]
            }, {
                name: 'London',
                data: [3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
            }]
        });
    });

});
        </script>
    </head>
    <body>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>

    </body>
</html> 
```

所以我创建了一个facestemplate：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<title><ui:insert name="title">Default title</ui:insert></title>
<ui:insert name="head">
</ui:insert>
</h:head>
<h:body>
    <div id="content">
        <ui:insert name="content">
        </ui:insert>
    </div>
</h:body>
</html> 
```

我用于我的 Highchart 代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="/mytemplate.xhtml">
    <ui:define name="head">
        <script type="text/javascript"
            src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script type="text/javascript">
            $(function() {
                var chart;
                $(document)
                        .ready(
                                function() {
                                    chart = new Highcharts.Chart(
                                            {
                                                chart : {
                                                    renderTo : 'container',
                                                    type : 'line',
                                                    marginRight : 130,
                                                    marginBottom : 25
                                                },
                                                title : {
                                                    text : 'Monthly Average Temperature',
                                                    x : -20
                                                //center
                                                },
                                                subtitle : {
                                                    text : 'Source: WorldClimate.com',
                                                    x : -20
                                                },
                                                xAxis : {
                                                    categories : [ 'Jan',
                                                            'Feb', 'Mar',
                                                            'Apr', 'May',
                                                            'Jun', 'Jul',
                                                            'Aug', 'Sep',
                                                            'Oct', 'Nov', 'Dec' ]
                                                },
                                                yAxis : {
                                                    title : {
                                                        text : 'Temperature (°C)'
                                                    },
                                                    plotLines : [ {
                                                        value : 0,
                                                        width : 1,
                                                        color : '#808080'
                                                    } ]
                                                },
                                                tooltip : {
                                                    formatter : function() {
                                                        return '<b>'
                                                                + this.series.name
                                                                + '</b><br/>t_$ta_$tag'
                                                                + this.x + ': '
                                                                + this.y + '°C';
                                                    }
                                                },
                                                legend : {
                                                    layout : 'vertical',
                                                    align : 'right',
                                                    verticalAlign : 'top',
                                                    x : -10,
                                                    y : 100,
                                                    borderWidth : 0
                                                },
                                                series : [
                                                        {
                                                            name : 'Tokyo',
                                                            data : [ 7.0, 6.9,
                                                                    9.5, 14.5,
                                                                    18.2, 21.5,
                                                                    25.2, 26.5,
                                                                    23.3, 18.3,
                                                                    13.9, 9.6 ]
                                                        },
                                                        {
                                                            name : 'New York',
                                                            data : [ -0.2, 0.8,
                                                                    5.7, 11.3,
                                                                    17.0, 22.0,
                                                                    24.8, 24.1,
                                                                    20.1, 14.1,
                                                                    8.6, 2.5 ]
                                                        },
                                                        {
                                                            name : 'Berlin',
                                                            data : [ -0.9, 0.6,
                                                                    3.5, 8.4,
                                                                    13.5, 17.0,
                                                                    18.6, 17.9,
                                                                    14.3, 9.0,
                                                                    3.9, 1.0 ]
                                                        },
                                                        {
                                                            name : 'London',
                                                            data : [ 3.9, 4.2,
                                                                    5.7, 8.5,
                                                                    11.9, 15.2,
                                                                    17.0, 16.6,
                                                                    14.2, 10.3,
                                                                    6.6, 4.8 ]
                                                        } ]
                                            });
                                }); });
        </script>
    </ui:define>

    <ui:define name="content">
        <script src="http://code.highcharts.com/highcharts.js"></script>
        <script src="http://code.highcharts.com/modules/exporting.js"></script>

        <div id="container"
            style="min-width: 400px; height: 400px; margin: 0 auto"></div>

    </ui:define>
</ui:composition>
</html> 
```

但我看不到我的面孔实现的图表。我的问题是什么？有没有更好的方法或通用的方法来使用 javascript / jQuery / highcharts 和 JSF？

编辑：更正了我的代码。我确定，Javascript 代码已加载。

但是当我用萤火虫检查我的代码时，我的“highchart”函数会生成两次。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:20:29.673

你没有关闭匿名函数。在头部`});`的结束标签之前添加。`</script>`

请参阅下面的代码片段：

```
<ui:composition template="/mytemplate.xhtml">
<ui:define name="head">
    <script type="text/javascript"
        src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            var chart;
            $(document)
                    .ready(
                            function() {
                                chart = new Highcharts.Chart(
<!-- CODE CONTINUES -->

                           } ]
                                        }); // END new Highcharts.Chart()
                            }); // END $(document).ready()

         }); // THIS WAS MISSING!!
    </script>
</ui:define> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:11:42.893

将所有代码放在 js 文件中并将其包含在您的*xhtml*中，而不是在浏览器控制台中查看错误，您也可以 jslint 代码...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-08T06:37:25.367

将以下行添加到第一行的 highcharts 代码中...

```
 jQuery.noConflict(); 
```

例如：-

```
$(function () {
    var chart;
    jQuery.noConflict(); //add this
 $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'line',
                marginRight: 130,
                marginBottom: 25
            }, .......... 
```

# javascript - 如何在所有操作系统中使用 JS/CSS 重新创建类似文件浏览器的 Mac

> ID：14666058
> 
> 赞同：-1
> 
> 时间：2013-02-02T20:16:05.800
> 
> 标签：javascript, html, css

在 UI 交互期间因操作系统而异的一件事是文件浏览器。在 Windows 中上传文件时弹出的文件浏览器窗口与 Mac 中的不同。是否可以使用 Javascript/CSS/HTML 或少量服务器端代码来模拟 Mac 类型的文件浏览器，这样如果用户想要在网页也来自Windows？（我不是在谈论文件输入，我是在询问文件浏览器窗口，人们可以在其中导航以找到他想要上传的文件..）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:18:55.253

不，这是不可能的，即使是这样，它也可能会降低可用性。当违反主机平台约定时，可用性会受到损害。请参阅[本文中关于不一致的部分（第二个标题）](http://www.nngroup.com/articles/okndashcancel-or-cancelndashok/)。

就像 一样`<input type="file"/>`，文件选择器 UI 完全取决于浏览器和主机操作系统。JavaScript 和服务器都不能直接访问客户端的本地文件系统，因为这会带来巨大的安全风险。

# c# - 自定义验证属性调用另一个验证属性

> ID：14666059
> 
> 赞同：4
> 
> 时间：2013-02-02T20:16:09.817
> 
> 标签：c#, asp.net-mvc, validation, custom-attributes

我想创建一个调用其他验证属性的自定义验证属性。

例如，我想创建一个名为`PasswordValidationAttribute`. 我希望它用 来装饰它定义的属性，并定义`RequiredAttribute`各种`RegularExpressionAttribute`参数`StringLengthAttribute`（例如密码的正则表达式以及最大和最小字符串长度）。

我正在努力从哪里开始，确定涉及多少工作并确定它是否可能。一旦将此属性应用于属性，我希望它能够`ValidationMessageFor` `HtmlHelper`正确处理并进行服务器端调用。我希望我不需要重新定义它们（否则工作量会太大）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T22:45:26.643

对于**.net 4**，它可能看起来像：

```
[AttributeUsage(AttributeTargets.Property | AttributeTargets.Field, AllowMultiple = false)]
public class MyValidationAttribute : ValidationAttribute
{
    private readonly bool isRequired;

    public string Regex { get; set; }

    public int StringLength { get; set; }

    public MyValidationAttribute(bool isRequired)
    {
        this.isRequired = isRequired;
    }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        var composedAttributes = ConstructAttributes().ToArray();
        if (composedAttributes.Length == 0) return ValidationResult.Success;

        var errorMsgBuilder = new StringBuilder();
        foreach (var attribute in composedAttributes)
        {
            var valRes = attribute.GetValidationResult(value, validationContext);
            if (valRes != null && !string.IsNullOrWhiteSpace(valRes.ErrorMessage))
                errorMsgBuilder.AppendLine(valRes.ErrorMessage);
        }
        var msg = errorMsgBuilder.ToString();
        if (string.IsNullOrWhiteSpace(msg))
            return ValidationResult.Success;
        return new ValidationResult(msg);
    }

    private IEnumerable<ValidationAttribute> ConstructAttributes()
    {
        if (isRequired)
            yield return new RequiredAttribute();
        if (Regex != null)
            yield return new RegularExpressionAttribute(Regex);
        if (StringLength > 0)
            yield return new StringLengthAttribute(StringLength);
    }
} 
```

**用法：**

```
[MyValidationAttribute(true, Regex = "[a-z]*", StringLength = 3)]
public string Name { get; set; } 
```

* * *

在**.net 3.5**中有一个限制，您不能从底层属性动态构造消息值（*至少我无法通过它*）。您只能为每个属性设置一条消息。

改变的一切都在方法内部`IsValid`。

```
public override bool IsValid(object value)
{
    var composedAttributes = ConstructAttributes().ToArray();
    if (composedAttributes.Length == 0) return true;
    return composedAttributes.All(a => a.IsValid(value));
} 
```

*注意事项`ErrorMessage`：*

`IsValid`.net 3.5 中方法的返回值`ValidationAttribute`不是`ValidationResult`but `bool`。当我尝试设置时`ErrorMessage`，我得到了错误`value can be set only once`。

# asp.net - ASP.Net + MasterPage & 动态内容

> ID：14666061
> 
> 赞同：1
> 
> 时间：2013-02-02T20:16:17.830
> 
> 标签：asp.net, css

我正在做一个项目，并且需要让导航栏保持静态（例如 facebook），而不是 CSS 固定位置，但是说当我**单击菜单中的某个项目**以加载其内容时，**只有内容区域会被刷新**。

因此，我相信我需要一个位于页面中心的容器来加载动态内容。现在，导航栏包含在我所有相同的 aspx 页面中，并且导航栏会在页面之间刷新。

我阅读了几篇文章/帖子，我想到的方法是将每个 aspx 包装到用户控件中，然后在从基于本文的相应菜单项调用时将其动态加载到我的母版页内的 div 中：

[http://msdn.microsoft.com/en-us/library/c0az2h86%28v=VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/c0az2h86%28v=VS.100%29.aspx)

我的一个页面使用 jquery 选项卡在父 div 中显示/隐藏多个子 div 内容，这意味着所有 div 内容都在一个页面中，但是现在我正在处理 30 多个 aspx 页面，这意味着这种方式应该被淘汰，但这就是我需要的概念。

问题是我有超过 30 个巨大的 aspx 页面，不确定这是否是要走的路。对我的情况有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:26:52.357

所以你只是想让你的菜单栏保持固定？那么利用 css position 属性`fixed`。

将您的菜单栏包装在一个容器中`div`，然后对其进行样式设置。

```
div#menu{
    position: fixed;
    height: 25px;
    width: 100%;
} 
```

然后给你的页面内容一个 25px 的上边距

```
div#content{
    margin-top: 25px;
} 
```

这将导致您的导航在滚动时始终保持固定在页面顶部，并且您无需对页面/用户控件/动态加载内容执行任何操作。

我在这里整理了一个小例子。[CSSDeck 示例](http://cssdesk.com/8hKHz)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:09:41.107

问题是你希望它有多干净*或多脏*？

真的干净吗？-> 构建[单页应用程序](http://www.asp.net/single-page-application)。这可能会使您重写应用程序的很大一部分。

老套？-> 使用 iFrame 并从您的页面中删除（部分？）MasterPage。

更脏？[-> 在UpdatePanel](http://ajax.net-tutorials.com/controls/updatepanel-control/)中加载您的内容。您必须再次从页面中删除 MasterPage。

所有解决方案都会向您提出导航挑战，如此处所[问](https://stackoverflow.com/questions/7287484/website-structure-javascript-jquery-platform-with-hash-navigation)。

# c - fgetc 总是返回值 1

> ID：14666062
> 
> 赞同：3
> 
> 时间：2013-02-02T20:16:21.027
> 
> 标签：c, printf, eof, fgetc, getc

有以下功能：

```
void readAndPrint(FILE * f) {
    int c;

    while(c = fgetc(f) != EOF) {
        printf("%d", c);
    }
} 
```

在 main() 主体中，我使用以下代码来使用上述函数：

```
FILE * pFile;

pFile=fopen ("myfile.txt","r");

readAndPrint(pFile) 
```

;

无论我在 myfile.txt 中放入什么，程序都会打印出来。例如，对于 abc，打印出 111。

我知道函数中的 c 应该声明为 int 以正确地将其与 EOF 进行比较。此外，我希望将文本文件中每个字符的 ASCII 集中的 int 代码打印出来（97 表示 a，...）。我无法弄清楚为什么它会打印出'ones'......你知道原因吗？先感谢您。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-02T20:17:57.567

`(c = fgetc(f) != EOF)`- 这里首先`fgetc(f) != EOF`发生这种情况，结果`1`or`0`被分配给`c`. 条件检查总是返回`TRUE`( `1`) 或`FALSE`( `0`)。

做`while((c = fgetc(f)) != EOF)`

# opengl - OpenGL - 使用 gluLookAt 围绕立方体旋转会非常快速地旋转

> ID：14666067
> 
> 赞同：2
> 
> 时间：2013-02-02T20:16:43.377
> 
> 标签：opengl, rotation, glulookat

我正在尝试使用 gluLookAt 围绕以原点为中心的立方体移动，而不是直接在对象上执行 R*T 转换。起初，我不确定如何解决这个问题。然后我意识到（在圆坐标中实现了一半的解决方案之后）我应该尝试使用球坐标系表示。我能够编写一些代码来做到这一点，但我（相机的“眼睛”）在立方体周围旋转得非常快。另外，我注意到我也向立方体移动了一点，而不是保持一个恒定的半径。当我使用 Rotate*Translate 方法时，它以更合适的速度旋转相同的距离。

我的旋转方法是使用球坐标，但我不确定这是否正确。[我根据维基百科页面](http://en.wikipedia.org/wiki/Spherical_coordinate_system)上的图表计算了这两个角度。我计算我所在的当前点的大小（distX，distY，distZ）。我们最初在 XY 平面上看负 Z 平面）。我还得到了两个角度，一个指定绕 x 轴的旋转角度，一个指定绕 y 轴的旋转角度。这五个值是根据我的鼠标点击方式计算得出的。

我根据一些三角函数计算 theta 和 phi，然后最后计算新位置。这些公式可以在之前的链接中找到。最后一步是将其插入 gluLookAt。同样，在运行这个程序时，我可以围绕立方体旋转，但它非常快并且还可以平移相机。我究竟做错了什么？

我的代码列在下面，以供您参考。引用“y”和“up”的部分是我尝试计算绕 Z 轴的旋转。我可以描述旋转的最佳方式是，如果你看着一个物体，想象你自己是相机，然后左右倾斜你的头。我没有将它包含在我对 gluLookAt 的调用中，因为我也无法让它工作。

编辑：它现在以看起来正确的速度旋转，但它并没有完全旋转。我的意思是，在旋转时，“眼睛”会以一定角度朝向立方体移动，但随后会向后旋转，从而撤消旋转。但这会循环，因此眼睛所走的路径看起来类似于弯曲的无穷大符号。

```
void sceneTransformation(){
glLoadIdentity( );
    //Using the R*T approach. Works flawlessly
//glTranslatef(-distX, distY, -distZ);
//glRotatef( anglex, 1.0, 0.0, 0.0 );
//glRotatef( angley, 0.0, 1.0, 0.0 );

GLdouble radx = anglex*PI/180.;
GLdouble rady = angley*PI/180.;

GLdouble l = sqrt(pow(distX, 2) + pow(distY, 2) + pow(distZ, 2));
GLdouble phi = atan(distY/distZ) + radx;
GLdouble theta = acos(distZ/l) + radx;

GLdouble deltaZ = l*sin(theta)*cos(phi);
GLdouble deltaY = l*sin(theta)*sin(phi);
GLdouble deltaX = l*cos(theta);

GLdouble ytheta = atan(distX/distY); 
GLdouble y = sqrt(pow(distX,2) + pow(distY, 2));
GLdouble yangle = PI/2.-ytheta-rady;

GLdouble up_y = y*sin(yangle);
GLdouble up_x = y*cos(yangle);

gluLookAt((distX - deltaX), (distY - deltaY), (distZ - deltaZ), 0, 0, 0, 0,1,0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:19:26.487

`sin()`像,和朋友这样的数学函数`cos()`期望以弧度而不是度数输入。看起来您正在假设度数，因此您的旋转速度比预期快了大约 57.3 倍（确切地说：360 / (2 * pi)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:34:26.917

You need to make your movement timebased, this means to multiply the rotation angle with the delta between the beginning last and current frame.

```
angle += 90 * timeDelta; // Rotate by 90 degree each second 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T15:38:39.060

您的问题有一个很好的解决方案。进行一些调查，但我认为它会满足您的需求。 [四元数](http://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation)

[一些代码](http://willperone.net/Code/quaternion.php)

适合将矢量转换为旋转和向后

# dart - dartEditor 文件层次结构和库/部件逻辑

> ID：14666068
> 
> 赞同：1
> 
> 时间：2013-02-02T20:16:46.647
> 
> 标签：dart, dart-pub, dart-editor

当我在 Windows8 中使用 DartEditor 创建一个“Web 应用程序”时，它给了我这个层次结构

```
ClientView/
  packages/
  pubspec.lock
  pubspec.yaml
  web/
    packages/
    clientview.css
    clientview.dart
    clientview.dart.js
    clientview.dart.js.deps
    clientview.dart.js.map
    clientview.html 
```

然后我添加 lib/ 文件：

```
 web/
    ...
    lib/
      src/
        canvas.dart
        i_drawable.dart
        node.dart
      client_canvas.dart
    ... 
```

**client_canvas.dart 文件**

```
library client_view;

import 'dart:html';
import 'package:meta/meta.dart'; 

// Interface
part 'src/i_drawable.dart';

// Class
part 'src/canvas.dart';
part 'src/node.dart'; 
```

在“part”关键字之后包含的每个文件中，我都添加了这一行：

```
part of client_view; 
```

但似乎没有一个类可以被其他飞镖代码访问

```
class Canvas implements IDrawable // no such type 'IDrawable'
abstract class Node implements IDrawable // no such type 'IDrawable'
class CustomNode extends Node // no such type 'Node' (if try to create a custom node) 
```

我想这是我还不了解的酒吧和图书馆的组织方式。

所以我试图做的是在同一个项目中创建一个库，我想将该库导入到由 clientview.html 文件调用的 clientview.dart 文件中。

您的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:45:31.287

由于您使用的是相对导入，并且所有内容似乎都是同一个库的一部分，因此我认为没有明显的错误原因。也许你可以分享更多细节。

不过，您可能应该重新组织您的源代码树以更符合 Pub 标准。`web/`并且`lib/`都应该是顶级目录，否则您将无法`package:`导入自己的库。这就是为什么建议`web/`只包含入口点（带有`main()`方法的脚本）而其他所有内容都应该在`lib/`.

另外，我会尽量少用`part`。我发现将几乎每个文件都定义为库并导入它们要好得多。它使每个文件的依赖关系更加清晰，并允许消费者只导入接口，而不是实现。`export`使构建一个公开另一个定义的库成为可能。

最后，风格 nit：Dart 不是 C#，我们不会在我们的接口上使用那个丑陋的“I”前缀 :-) 只需命名你的 interface `Drawable`。

# actionscript-3 - 如何在旨在在 Windows 上运行的独立 AIR 应用程序中在没有 Flex 框架的情况下在 Actionscript 3 中创建警报对话框

> ID：14666081
> 
> 赞同：0
> 
> 时间：2013-02-02T20:17:35.153
> 
> 标签：actionscript-3, flash, air, alert

我有一个项目，用 Actionscript 3 编写，使用 Flash CS5 构建。在其中，有些部分需要插入麦克风，并且在我之前的程序员通过抛出错误通知用户缺少麦克风。这会导致程序停止运行，这是不受欢迎的行为。

问题：如何在尽可能纯的 Actionscript 中创建弹出警报对话框。我在 mx.controls 中找到了 Alert 类，但我找不到将它添加到项目中的方法。我找到了 Yahoo AlertManager 类，但无法让它正常工作，而且它周围的框架看起来比我需要的要大。

这在使用 AIR 2.5、Flash CS5、Actionscript 3.0 的 Windows 7 环境中作为独立应用程序部署在触摸屏上。我使用 FlashDevelop 作为 AS 编辑器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:42:48.420

您必须制作自己的警报框，方法是制作`NativeWindow`实例并对其进行编辑，或者（我建议）制作您自己的扩展类的自定义类`NativeWindow`。

这是我为我的一个应用程序制作的一个简单的通用版本：

```
package  
{
    import flash.display.*;
    import flash.geom.*;

    public class AlertWindow extends NativeWindow 
    {

        public function AlertWindow(owningWindow:NativeWindow, windowTitle:String) 
        {
            var initOptions:NativeWindowInitOptions = new NativeWindowInitOptions();
            initOptions.maximizable = false;
            initOptions.minimizable = false;
            initOptions.resizable = false;
            initOptions.owner = owningWindow;
            initOptions.type = NativeWindowType.UTILITY;

            super(initOptions);

            title = windowTitle;
            alwaysInFront = true;
            stage.align = StageAlign.TOP_LEFT;
            stage.scaleMode = StageScaleMode.NO_SCALE;

            bounds = new Rectangle(owner.x + owner.width - (owner.width / 2) - 125, owner.y + owner.height - (owner.height / 2) - 75, 250, 150);
        }
    }
} 
```

我很快就把它搅起来了，所以它可能没有它应该的那么干净或高效，但它应该是一个很好的开始。显然，您可以添加消息、按钮、事件侦听器和其他任何内容。

如果您不了解所有代码，则应查看[`NativeWindow`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/NativeWindow.html)和[`NativeWindowInitOptions`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/NativeWindowInitOptions.html)文档。

# java - 未解析的套接字地址

> ID：14666082
> 
> 赞同：6
> 
> 时间：2013-02-02T20:17:46.860
> 
> 标签：java, network-programming

这更像是一个新手问题，但我无法在 Google 上找到我正在寻找的答案类型。

我正在阅读`InetSocketAddress`java.net 包中的类，我遇到了这个名为`createUnresolved(String host, int port)`. 此方法创建一个**未解析**的Socket。

基本上我们所说的未解决是什么意思？我在编译程序时经常遇到这个术语，但从未完全理解它。谁能解释一下java中的一般含义，以及该方法的上下文含义。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:20:50.207

我[在一个太阳博客中](http://grokbase.com/t/hadoop/common-issues/117jsjk8d7/jira-created-hadoop-7472-rpc-client-should-deal-with-the-ip-address-changes)找到了这个：

> 但决定保持原样，但使用 createUnresolved() 创建 InetSocketAddress，以便我们知道用于实例化它的内容。如果用户一开始就输入了 IP 地址，我们将不会处理它。（我认为以前无法​​区分）令牌将具有用户在开始时使用的任何内容（IP 或名称），并且在使用名称的情况下，即使地址发生更改，令牌缓存的密钥也不会更改。所以委托令牌应该继续工作。

基本上，它是一个半生不熟的 InetSocketAddress - 所以它不是最终的迭代。这是一个中间步骤..

并从 API：

> 它也可以是一对（主机名 + 端口号），在这种情况下，将尝试解析主机名。
> 
> 如果解析失败，则称该地址未解析，但仍可在某些情况下使用，例如通过代理连接

所以我们没有找到主机名，或者用户友好的“www.abc.com”方法。

但是，如果我们通过代理进行连接，那没关系，因为代理服务器会处理主机名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-03T17:43:20.840

我有同样的例外：java.net.UnknownHostException：主机未解决：[https ://www.google.com](https://www.google.com)

问题是因为我添加了协议https://，删除https://后问题解决了

```
try {
    Socket socket = new Socket();
    socket.connect(new InetSocketAddress("www.google.com", 443), 100);
    socket.close();
    return true;
} catch (IOException e) {
    e.printStackTrace();
    return false;
} 
```

# ruby - 对 ruby 哈希的 xml 响应

> ID：14666086
> 
> 赞同：0
> 
> 时间：2013-02-02T20:18:01.967
> 
> 标签：ruby, xml, hash

背景

我有来自设备 REST API 的 XML 响应，我需要选择一个特定的键/值对。目前我正在使用 HTTParty get 来检索 XML 并挑选出文本。我认为我正在以艰难的方式做到这一点，并且必须有一个更简单的方法。

问题

有没有更简单的方法来实现这一点，使其更容易理解和更可重用？

XML 看起来像这样。我正在尝试选择 formatted="Off" 键/值对。

```
<?xml version="1.0" encoding="UTF-8"?><properties><property id="ST" value="0" formatted="Off" uom="on/off"/></properties> 
```

我目前使用的代码：

```
require 'httparty'

  class Rest
    include HTTParty
    format :xml
      end

  listen_for (/status (.*)/i) do |input|
    command_status input.downcase.strip
    request_completed
  end

  def command_status(input)
  inputst = @inputSt[input]
  unless inputst.nil?
      status = status_input(inputst)
      say "#{input} is #{status}" 
  else
      say "I'm sorry, but I am not programmed to check #{input} status." 
  end
 end    

 def status_input(input)
    # Battery operated devices do not continuously reports status, thus will be blank until first change after an ISY reboot or power cycle.
    resp = Rest.get(@isyIp + input, @isyAuth).inspect
    resp = resp.gsub(/^.*tted"=>"/, "")
    status = resp.gsub(/", "uom.*$/, "")
    return status.downcase.strip
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T02:29:51.790

我想出了如何使用`parsed_response`并理解生成的 HASH 深度将 XML 解析为 HASH。谢谢你的提示，戴夫！

```
 def status_input(input)
    # Battery operated devices do not continuously reports status, thus will be blank until first change after an ISY reboot or power cycle.
    resp = Hash[Rest.get(@isyIp + input, @isyAuth).parsed_response]
    status = resp["properties"]["property"]["formatted"]
    return status.downcase.strip
  end 
```

谢谢你的帮助！

# css - IIS - 浏览文件时拒绝访问

> ID：14666087
> 
> 赞同：0
> 
> 时间：2013-02-02T20:18:09.587
> 
> 标签：css, iis, permission-denied

我在 IIS 中的应用程序下有 2 个文件夹。当我右键单击文件夹 1 中的文件并单击浏览时，我可以看到该文件很好（它是一个 css 文件）。当我在文件夹 2（也是一个 css 文件）下的 fie 上做同样的事情时。我得到一个

“访问被拒绝。您似乎试图执行一项不允许您执行的操作。您无法以访客身份查看此 URL。您必须登录。”

IE 和 Chrome 中的网络流量为 200。

有什么帮助吗？我不知道发生了什么事

**解决方案**

这更像是一个我很愚蠢的场景，而不是一个解决方案。从要移动到文件夹的位置下载文件时，文件本身包含文本“拒绝访问.....”。它与 IIS 无关。一旦我解决了下载问题，我就得到了正确的文件并将其移动到文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:56:22.557

这些文件夹之一是否有可能是虚拟文件夹？如果是这样，那么您需要为运行应用程序池的用户设置 NT 权限。

例如，如果您的网站和可用的文件夹位于 c:\inetpub\wwwroot\website1 下，但不起作用的文件夹是 d:\some_other_folder\ 下的虚拟文件夹，则您需要打开此文件夹的安全设置并授予以下权限运行应用程序池的系统用户。

# java - 在 CMU Sphinx (pocketsphinx) 中使用 JSGF 语法代替 DMP 语言模型（使用 -jsgf 代替 -lm）

> ID：14666088
> 
> 赞同：8
> 
> 时间：2013-02-02T20:18:10.850
> 
> 标签：java, android, speech-recognition, cmusphinx

我需要在我的 android 应用程序中离线训练 CMU Sphinx。我下载[了这个](https://github.com/Kaljurand/Inimesed)使用这个参数的项目，但是当我启动它时，我有这个错误：`Fatal signal 11 (SIGSEGV) at 0x0000001c (code=1)`。当 Sphinx 找不到声学模型时，我也会遇到此错误。[我在这里](https://stackoverflow.com/questions/11260151/training-acoustic-model-for-cmu-sphinx-using-finite-state-grammar-jsgf)找到了我的问题的答案，但这对我不起作用。我做错了什么，任何人都可以为我提供任何教程或一个好的答案吗？

所以问题是如何使用`.jsgf`文件而不是`.DMP`文件作为 Pocketsphinx 的语言模型，就像在 Inimesed 项目的识别器任务中使用的那样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T03:59:49.527

如果 CMU Sphinx 在 Android 和 Windows 上的工作方式相似，以下可能会有所帮助：

[http://www.aiaioo.com/cms/index.php?id=28](http://www.aiaioo.com/cms/index.php?id=28) [http://homepages.abdn.ac.uk/k.vdeemter/pages/teaching/NLP/practicals/JSGFGrammar.html](http://homepages.abdn.ac.uk/k.vdeemter/pages/teaching/NLP/practicals/JSGFGrammar.html) [http:// www.w3.org/TR/jsgf/](http://www.w3.org/TR/jsgf/)

示例 JSGF 文件：

```
#JSGF V1.0;
grammar hello;
public <command> = ( open | close ) ( computer | window | music | note ); 
```

将上述语法保存在一个名为“hello.gram”的文本文件中，然后运行 ​​sphinx：

```
pocketsphinx_continuous.exe -hmm hub4wsj_sc_8k -jsgf hello.gram -dict hub4.5000.dic 
```

# uml - UML 状态机，本地与外部转换

> ID：14666095
> 
> 赞同：9
> 
> 时间：2013-02-02T20:18:39.587
> 
> 标签：uml, modeling

正如[http://www.eclipse.org/forums/index.php/t/452409/](http://www.eclipse.org/forums/index.php/t/452409/)中已经询问的那样， 我不确定我是否正确理解了本地转换的含义，我想知道我是否将它们与语义正确与否

这两个状态机是否相等？

![具有本地转换的状态机](../Images/68fcbd1a4b4bf96a8c0f7c65b6ddc19c.png)

![没有本地转换的状态机](../Images/5d156b3877de0d0909b199a8219c246d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T10:32:22.157

*在 UML 2.4.1 下，第一个图显示了接收到触发器*时从 State1 的本地转换，第二个图显示了接收到*触发器*时子状态之间的转换。从 State1 的外部过渡将由指向 State1 然后弯曲回到它的箭头表示（上层建筑规范的图 15.48）。

UML 上层结构 2.4.1 的第 15.3.15 节*TransitionKind*给出了内部、本地和外部转换的语义：

> kind=local 意味着转换，如果被触发，将不会退出复合（源）状态，但它将应用于复合状态内的任何状态，并且这些状态将被退出和进入。

由于本地和子状态之间的转换都不会导致 State1 退出，这些图显示了类似的状态机 - 不同之处在于，从 State1.3 开始，第一台机器将重新进入 State1.3（导致其退出和进入行为调用），而第二个在触发时不会从 State1.3 执行任何操作。

# ruby-on-rails - 我的 rails 应用程序中的任何 rake 命令中的控制台错误

> ID：14666097
> 
> 赞同：0
> 
> 时间：2013-02-02T20:18:47.453
> 
> 标签：ruby-on-rails, rake, error-console

在我的 rails 应用程序中运行任何 rake 命令时，我遇到了一些问题：

```
humberto@asterix:/var/www/avante-q-a$ rake db

/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:11: warning: already initialized constant DEFAULT_HOOKS
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:23: warning: already initialized constant DEFAULT_PRINT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:48: warning: already initialized constant SIMPLE_PRINT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:57: warning: already initialized constant CLIPPED_PRINT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:62: warning: already initialized constant DEFAULT_EXCEPTION_HANDLER
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:68: warning: already initialized constant DEFAULT_EXCEPTION_WHITELIST
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:71: warning: already initialized constant DEFAULT_PROMPT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:82: warning: already initialized constant SIMPLE_PROMPT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:84: warning: already initialized constant SHELL_PROMPT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:91: warning: already initialized constant NAV_PROMPT
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:107: warning: already initialized constant DEFAULT_CONTROL_D_HANDLER
/home/humberto/.rvm/gems/ruby-1.9.3-p327/gems/pry-0.9.9.6/lib/pry.rb:121: warning: already initialized constant DEFAULT_SYSTEM
rake aborted!
cannot load such file -- pry/nav

(See full trace by running task with --trace) 
```

我已经运行了 bundle install 并且它成功了。有人知道这里缺少什么吗？从现在开始感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:21:50.033

您应该尝试在捆绑程序上下文中重新运行它：

```
bundle exec rake db 
```

Bundle exec 首先加载 bundler 并在加载 rake 之前将所有 gem 挂接到当前环境中。

# php - 使用 Mockery 时的不完整测试

> ID：14666101
> 
> 赞同：2
> 
> 时间：2013-02-02T20:19:06.537
> 
> 标签：php, phpunit, mockery

假设我正在测试一个方法在 php 中调用另一个方法

```
<?php
use \Mockery as m;

public function testMethodCallsOtherMethod {
    $m = m::Mock(new StdClass);
    $m->assertCalledWith('methodName')->once();
    doSomethingSoMCallsMethodName($m);
}

function tearDown() {
    m::close();
} 
```

当我使用 PHPUnit 运行此测试时，它报告测试不完整，因为测试中没有 PHPUnit 断言。但是，它是一个有效的测试，如果不调用该方法将会出错。有什么好的解决方案可以让 PHPUnit 意识到这是一个有效的测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:43:53.413

一个简单的解决方法是一个虚拟断言：

```
$this->assertTrue(true); 
```

# ember.js - 如何将模型路由名称项传递给 ember.js 模板中的 linkTo

> ID：14666103
> 
> 赞同：2
> 
> 时间：2013-02-02T20:19:09.643
> 
> 标签：ember.js, handlebars.js, ember-router

如何动态地将路由名称传递给 {{linkTo}}？

例如，给定以下代码：

```
App.Router.map(function() {
 this.resource('anon', {path: '/main'},
 function() {
   this.route('home', {path:'/home'});
   this.route('about', { path: '/about' });
   this.route('contact', { path: '/contact' });
 });
});

App.NavController = Ember.ArrayController.extend({
  selectedNav:'',
  setNav:function(value){
  var nav = App.Nav.find(value);
  var items = nav.get('navItems');
  this.set('content', items);    
  }
}); 
```

这些模板：

```
<script type="text/x-handlebars" data-template-name="nav">
  <ul class="nav">
    {{#each in controller}}
      {{ partial "basicNav"}}
    {{/each}}
   </ul>
</script>

<script type="text/x-handlebars" data-template-name="_basicNav">
  <li>{{#linkTo navItemPath}}{{navItemName}}{{/linkTo}}</li>
</script> 
```

这些模型具有以下夹具数据：

```
App.Nav = DS.Model.extend({
  navItems:DS.hasMany('App.NavItem'),
  name:DS.attr('string')
});

App.NavItem = DS.Model.extend({
  nav:DS.belongsTo('App.Nav'),
  navItemName:DS.attr('string'),
  navItemPath:DS.attr('string')
});

App.Nav.FIXTURES = [
 {
  id: 10,
  name: 'Anon',
  navItems: [100,200,300]
 }
];

App.NavItem.FIXTURES = [
{
  id:100,
  nav:10,
  navItemName:'Home',
  navItemPath:'anon.home'
},
{
  id:200,
  nav:10,
  navItemName:'Contact',
  navItemPath:'anon.contact'
},
{
  id:300,
  nav:10,
  navItemName:'About',
  navItemPath:'anon.about'
}
]; 
```

如何将 navItemPath 传递给 {{linkTo}} 助手？在此代码段中：

```
{{#linkTo navItemPath}}{{navItemName}}{{/linkTo}} 
```

ember 抱怨它找不到“navItemPath”路线，就像它在字面上寻找它一样。如果我将其替换为有效的文字路线，例如：

```
{{#linkTo 'anon.home'}}{{navItemName}}{{/linkTo}} 
```

ember 将按预期呈现带有 navItemName 的 linkTo，所以我知道控制器正在向它传递正确的数据，但当然所有路由都是愚蠢的。我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T11:33:16.530

您不能使用 LinkTo 帮助器执行此操作，您需要将链接的*href*`navItemPath`绑定到使用[bindAttr](http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_bindAttr)

```
<a {{bindAttr href="navItemPath"}}>{{navItemName}}</a> 
```

确保呈现 navItemPath 值的逻辑考虑了[位置](http://emberjs.com/guides/routing/specifying-the-location-api/)API

# php - PHP中将一系列字符串解析成数组的数组

> ID：14666104
> 
> 赞同：2
> 
> 时间：2013-02-02T20:19:11.077
> 
> 标签：php, arrays, string, forms, parsing

作为 PHP 新手并查看了文档等，我无法找到这个问题的答案。

我想接受`$_POST`如下输入：

```
Large Automated Structural Restoration  1   Hull Repair Unit        Medium  50 m3
Experimental 10MN Microwarpdrive I  5   Propulsion Module       Medium  50 m3
Warp Disruptor I    1   Warp Scrambler      Medium  5 m3
Upgraded EM Ward Amplifier I    1   Shield Amplifier        Medium  5 m3
Tracking Disruptor I    1   Tracking Disruptor  Small   Medium  5 m3 
```

变成一个`array`like：

```
[Experimental 10MN Microwarpdrive I] [5] [Propulsion Module] [] [Medium] [50] //Disregard m3
[Warp Disruptor I] [1] [Warp Scrambler] [] [Medium] [5]
...
[Tracking Disruptor I] [1] [Tracking Disruptor] [Small] [Medium] [5] 
```

到我可以调用一个变量的地方，`$asset[0][name]`这样我就可以准备一个对外部资源的 XML 调用。

逻辑正在逃避我，或者我不理解某些东西。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:57:36.950

```
$aero=explode(PHP_EOL,trim($_POST['textarea'])); //separate each line
$asset=array(); //init the assets
foreach ($aero as $unit) { //loop each line
    $detail=explode("\t",$unit); //split by tab
    $name=$detail[0]; //assign the name to the first item in the arr
    unset($detail[count($detail)-1]); //delete the last item ('m3' not needed)
    unset($detail[0]); //delete the first item (we saved it as $name)
    $asset[][$name]=$detail; //add an array item
} 
```

只是为了好玩，当您没有标签时，这是另一个使用正则表达式 1-liner 的解决方案：

```
$regex='/^([A-Za-z0-9 ]+) (\d+) ([A-Z][A-Za-z ]+?)(\ ()|\ (Small)\ )([A-Z][a-z]+) (\d+) m3$/m';
preg_match_all($regex,$textarea,$aero);
$asset=array();    
foreach ($aero[1] as $no=>$unit) {
    $asset[$unit]=array($aero[2][$no],
                $aero[3][$no], 
                $aero[6][$no], 
                $aero[7][$no], 
                $aero[8][$no]); 
} 
```

这一点可能需要一点补充：`(\ ()|\ (Small)\ )`类似于`(\ ()|\ (Small)\ |\ (Medium)\ |\ (Large)\ )`

处理前示例的第一行和最后一行的正则表达式输出：

```
Array ( [0] => Array ( [0] => Large Automated Structural Restoration 1 Hull Repair Unit Medium 50 m3 [1] => Tracking Disruptor I 1 Tracking Disruptor Small Medium 5 m3 )  
[1] => Array ( [0] => Large Automated Structural Restoration [1] => Tracking Disruptor I )  
[2] => Array ( [0] => 1 [1] => 1 )  
[3] => Array ( [0] => Hull Repair Unit [1] => Tracking Disruptor )  
[4] => Array ( [0] => [1] => Small )  
[5] => Array ( [0] => [1] => )  
[6] => Array ( [0] => [1] => Small )  
[7] => Array ( [0] => Medium [1] => Medium )  
[8] => Array ( [0] => 50 [1] => 5 ) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:26:26.843

如果您`explode`的字符串的正则表达式分隔符为 >1 个空格，那么所有内容都将位于一个数组中，您可以使用该数组执行您想要的操作。

```
$reg = '\s+';
$ar = explode($reg,$_POST['val']); 
```

# android - 在imageview android中间插入一个textview

> ID：14666106
> 
> 赞同：7
> 
> 时间：2013-02-02T20:19:34.713
> 
> 标签：android, layout, textview, imageview

我需要将文本视图放在图像视图的中间，所以我有这段代码

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/row_background"
android:layout_width="fill_parent"
android:layout_height="wrap_content" >

<TextView
    android:id="@+id/menu_label"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:lines="1" />

<ImageView
    android:id="@+id/menu_icon"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerInParent="true"
    android:layout_marginBottom="@dimen/menu_icon_margin_top_bottom"
    android:layout_marginRight="@dimen/menu_icon_margin_right"
    android:layout_marginTop="@dimen/menu_icon_margin_top_bottom" />

<TextView
    android:id="@+id/notif_number"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@id/menu_icon"
    android:layout_alignLeft="@id/menu_icon"
    android:layout_alignRight="@id/menu_icon"
    android:layout_alignTop="@id/menu_icon"
    android:lines="1"
    android:text="69"
    android:textColor="@android:color/white" /> 
```

我需要最后一个文本视图始终位于 menu_icon ImageView 的中心，但我的方法不起作用它只是把它放在左上角。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-02T20:34:43.813

As your ImageView not fills all RelativeLayout you cant achieve desireable effect. I suggest you to place ImageView and TextView in FrameLayout.

```
<FrameLayout
    android:layout_width = "wrap_content"
    android:layout_height = "wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerInParent="true">

 <TextView
    android:id="@+id/menu_label"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:lines="1" />

 <ImageView
    android:id="@+id/menu_icon"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginBottom="@dimen/menu_icon_margin_top_bottom"
    android:layout_marginRight="@dimen/menu_icon_margin_right"
    android:layout_marginTop="@dimen/menu_icon_margin_top_bottom" />
</FrameLayout> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:24:52.403

您只需要添加：

```
android:layout_centerInParent="true" 
```

到最后一个 TextView

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-16T13:25:19.077

`FrameLayout`是最好的方法。你也可以使用`RelativeLayout`，顺便说一句。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="40dp"
    android:layout_height="40dp">

    <ImageView
        android:id="@+id/marker_image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        tools:src="@drawable/ic_marker_selected" />

    <TextView
        android:id="@+id/marker_title"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_gravity="center"
        android:gravity="center"
        android:textColor="#fff"
        android:textSize="14sp"
        tools:text="A" />

</FrameLayout> 
```

# c - 事件系统中的无效指针

> ID：14666109
> 
> 赞同：0
> 
> 时间：2013-02-02T20:19:40.767
> 
> 标签：c, events

我正在编写一个事件系统，程序员可以在其中制作自己的事件，但我遇到了用于传递事件数据的 void 指针的问题。事件系统大致是这样工作的：

```
typedef enum { ... USER_EVENT ...} event_type;

typedef struct {
    int id;
    void* data;
} user_event;

typedef struct {
    event_type type;
    union {
        ...
        user_event user;
        ...
    };
} event; 
```

所以我正在编写一个用户事件，使用我自己的自定义结构，并将其传递给这个函数：

```
void add_user_event(int id, void* data) {
    event e;
    user_event u;
    u.id = id;
    u.data = data;
    e.type = USER_EVENT;
    e.user = u;
    add_event(e); /* add_event is just a function that adds the event to the event stack, and it works fine with predefined events */
}
...
add_user_event(my_user_event_id, (void*)&data); 
```

然后我像这样检索它：

```
...
if (e.type == USER_EVENT && e.user.id == the_user_id) {
    user_data_struct data = *(user_data_struct*) e.user.data;
    /* do stuff */
} 
```

事情是，这应该有效，但它没有（它只是给出完全乱码的数据）。我确信*给定*的数据是好的（做了一些检查），但是它以某种方式没有得到正确的数据（可能是一个错误的指针位置？）。如果这有帮助的话，其他一些提示是`add_user_event`调用是在函数内进行的（并且事件是在函数内定义的）。这会影响什么吗？

提前感谢，如果这还不够清楚，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:45:31.707

事实证明，正如[cnicutar](https://stackoverflow.com/users/714501/cnicutar)指出的那样，这个问题与 void 指针或任何东西无关，这仅仅是因为事件的数据存储在一个函数中（事件处理程序在函数完成执行后被调用，因此数据是在它甚至可以访问它之前就被破坏了）。

所以这是我的原始代码：

```
void fire_my_event() {
    my_event_structure ev;
    /* do stuff with ev */
    add_user_event(my_event_id, (void*)&ev);
}
/* ev is now destroyed, before the event handler could be called */ 
```

我通过制作`ev`“全局”来修复它，如下所示：

```
my_event_structure ev;

void fire_my_event() {
    /* reset ev and set values */
    add_user_event(my_event_id, (void*)&ev);
}
/* ev will not be destroyed until the end of the program */ 
```

# r - R中不同时期的经纬度数据的可能分析数量

> ID：14666112
> 
> 赞同：-4
> 
> 时间：2013-02-02T20:20:30.330
> 
> 标签：r, csv, import-from-csv

我在这里有一个数据集，其中包含一个地区的纬度、经度和盐度。我有三种不同情况的这些数据。第一种情况是正常流量情况，第二种情况是高流量情况，第三种情况是水位上升。

我想了解我们如何使用这些数据，然后进行某种类型的分析。

我的数据集上传到[https://www.dropbox.com/s/285iuyv6bugm48p/dataanalysisforthreetimes.csv](https://www.dropbox.com/s/285iuyv6bugm48p/dataanalysisforthreetimes.csv)

我想到的一些事情是：

1.  找出每次盐度的增加或减少，甚至说出一个规律。
2.  不同条件下的平均盐度

我以前在**R**中启动的代码如下：

```
mydata <- read.csv("dataanalysisforthreetimes.csv")
head(mydata)
library(reshape2)
data1 <- melt(mydata,"Lat","Long") 
```

你会建议我是否可以将任何线性模型拟合到我的数据中？任何建议的技术都受到高度赞赏。我想用**R**来做分析。你能推荐任何阅读吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:29:20.997

所有三个条件的平均盐度：

```
data1 <- melt(mydata,id=c("Lat","Long"))

aggregate(value ~ variable, mean, data=data1)
#   variable     value
#1  Highflow  4.039384
#2 Levelrise 32.238867
#3    Normal 21.153334 
```

这是您如何从您的条件中获得平均值的方法。至于线性模型，您可能最好在 R 中搜索具有空间自相关性的线性模型来入门。

# python - matplotlib 坐标格式

> ID：14666114
> 
> 赞同：6
> 
> 时间：2013-02-02T20:20:35.897
> 
> 标签：python, matplotlib, coordinates

我有这样的简单情节：

```
matplotlib.pyplot as plt

pt_no = [1,2,3]
coord_x = [6035763.111, 6035765.251, 6035762.801]
coord_y = [6439524.100, 6439522.251, 6439518.298]

fig, ax = plt.subplots()
ax.scatter(coord_y, coord_x, marker='x')
ax.axes.get_xaxis().set_visible(False)
ax.axes.get_yaxis().set_visible(False)
for i, txt in enumerate(pt_no):
    ax.annotate(txt, (coord_y[i], coord_x[i]))

plt.show() 
```

但是当您在图形上移动或按住光标时，绘图窗口的右下角显示的坐标看起来像 6.43953e + 06。
我怎样才能让我的输入坐标完全按原样显示，例如
6439518.298 而不是 6.43953e + 0
？
提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T20:50:44.623

该`ax.fmt_xdata`属性可以设置为格式化显示字符串的函数。

例如：

```
ax.fmt_xdata = lambda x: "{0:f}".format(x)
ax.fmt_ydata = lambda x: "{0:f}".format(x) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-02T21:49:56.990

您还可以通过设置完全覆盖默认标签`format_coord`

```
ax.format_coord = lambda x, y: "({0:f}, ".format(y) +  "{0:f})".format(x) 
```

[例如](http://matplotlib.org/examples/api/image_zcoord.html)，[api文档](http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.format_coord)

# php - Laravel 主页给出 404 但 index.php 有效

> ID：14666117
> 
> 赞同：1
> 
> 时间：2013-02-02T20:20:49.413
> 
> 标签：php, .htaccess, laravel

我正在我网站的子文件夹中创建自定义 cms。我在 www.mysite.com/cms/ <-- 应用程序、捆绑包、公共等都在那里安装了 laravel 的新副本。

由于共享主机，我无法创建虚拟主机，但我设法通过放置 /public 来消除在 url 中的需要

```
RewriteCond %{REQUEST_URI} !^/cms/public/.*$
RewriteRule ^(.*)$ /cms/public/$1 [L] 
```

在我的 cms 文件夹中的 .htaccess 文件中。

问题是，干净的 url 可以工作 www.mysite.com/cms/public/ 显示 Laravel 起始页。但是 www.mysite.com/cms/ 给了我一个 404 not found 错误，并且 www.mysite.com/cms/index.php 显示了 Laravel 起始页。

我已将 application.php 中的 url 数组元素设置为

```
'url' => 'http://www.mysite.com/cms/', 
```

和索引元素

```
'index' => '', 
```

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T06:19:49.557

也许如果您要将`public`文件夹的内容上传到`/cms`，并将其他文件夹的内容上传到`/cms_system`，您可以更改`paths.php`文件以反映这一点？

所以，你会有这个：

```
/cms
    (contents of the public folder, with .htaccess)
/cms_system
    /application
    /bundles
    /laravel
    /storage
    (etc) 
```

您的路径将如下所示：

```
$paths['sys'] = 'system';
$paths['bundle'] = 'bundles';
$paths['app'] = 'application';
$paths['storage'] = 'storage';
$paths['public'] = '../cms'; 
```

我还没有对此进行测试，但它应该可以工作。如果有任何问题，请告诉我，并会看到可以相应更改的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T00:25:00.433

要在共享主机上使用 laravel，我建议试试[这个](http://forums.laravel.io/viewtopic.php?id=4977)。

顺便说一句，在您的 .htaccess 中，您只是将所有不存在的请求查询重定向到公共目录中的 index.php。因此，您应该使用 url.com/public 访问。

# c - 将数组的所有元素设置为值的最佳方法是什么？

> ID：14666121
> 
> 赞同：3
> 
> 时间：2013-02-02T20:21:02.737
> 
> 标签：c

我有一个整数数组，我想在每次调用函数时将数组中的所有值设置为“x”。

我看过 memset ，但这只适用于我认为的字节数组。

我可以做明显的 for 循环，但我猜有一个标准的 lib 函数可以更好地完成这个。有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:24:04.197

循环一下，差不多。或`memset`为 0，如果您知道该值为零（与您了解位表示的其他值类似）。不会有标准库解决方案，因为标准库不知道特定的用户类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:28:34.977

如果您使用的是 x86 系统，则可以为此使用一些程序集。例如，在 gcc 中：

```
 __asm__(
            "rep stosb"
            : "=a"('x'), "=c"(count), "=D"(array)
           ); 
```

应该做的伎俩。

`rep stosb`取值`AL`并将其分配给 指向的连续内存位置`ES:EDI`。位置的数量在 中指定`ECX`。

顺便说一句，在最近的处理器中，[英特尔已经做出了很多努力来提高 和 的性能`MOVSB`，`STOSB`](http://www.hardwaresecrets.com/article/Inside-the-Intel-Ivy-Bridge-Microarchitecture/1397/)所以这是一个很好的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T20:24:11.700

除了`memset`和循环（两者都是`O(n)`时间）之外，**它实际上可以在其中完成`O(1)`**- 但代价是内存量的三倍，以及以后更昂贵的查找。

[本文](http://eli.thegreenplace.net/2008/08/23/initializing-an-array-in-constant-time/)描述了它是如何完成的。

这个想法是维护额外的堆栈（逻辑上，实现为数组+指向顶部的指针）和数组，额外的数组将指示它何时首次初始化（从 0 到 n 的数字），堆栈将指示哪些元素已被修改。

访问时`array[i]`，如果`stack[additionalArray[i]] == i && i < top`数组的值为`array[i]`. 否则 - 它是“初始化”值。

执行时`array[i] = x`，如果尚未初始化（如前所述），则应设置`additionalArray[i] = stack[top]`并增加`top`.

这会导致`O(1)`初始化，但如前所述，它需要额外的内存，并且每次访问都更加广泛。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:30:11.130

下面的逻辑会帮助你。

```
...
int a[100] = {0};
int b = 5;
memset_ex(a, 100, &b, sizeof(int));
...

memset_ex(void *buf, int buf_size, void *value, int size_of_type)
{
    int i = 0;

    for(i = 0; i <= (buf_size - size_of_type); i +=size_of_type)
    {
        memcpy((buf + i), value, size_of_type);
    }
} 
```

# c# - 为什么我会收到此 404 错误？

> ID：14666122
> 
> 赞同：2
> 
> 时间：2013-02-02T20:21:04.120
> 
> 标签：c#, asp.net, asp.net-mvc

在一个新创建的 MVC4 应用程序中，将此函数插入​​到帐户控制器中

```
 [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult AdminLogin(AdminLoginModel model, string returnUrl)
    {
        if (ModelState.IsValid && WebSecurity.Login("administrator", model.Password, persistCookie: model.RememberMe))
        {
            return RedirectToLocal(returnUrl);
        }

        // If we got this far, something failed, redisplay form
        ModelState.AddModelError("", "The password provided is incorrect.");
        return View(model);
    } 
```

还有这个

```
public class AdminLoginModel
{ 
    [Required]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    [Display(Name = "Remember me?")]
    public bool RememberMe { get; set; }
} 
```

放入accountModel.cs。我还创建了一个新文件 AdminLogin.cshtml 并将其留空。在 _loginPartial.cshtml 文件中，我插入了一个操作链接

`<li>@Html.ActionLink("Register", "AdminLogin", "Account", routeValues: null, htmlAttributes: new { id = "registerLink" })</li>`

但是，当我单击该注册链接时，我会看到 404 错误指出 `/Account/AdminLogin`未找到。

我在插入那个微小的 mvc 的过程中错过了一些东西；你可以帮帮我吗 ？我是一个 mvc 初学者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:28:56.047

单击浏览器中的链接会产生 GET 请求，但您的操作方法仅适用于 POST 请求。

添加`[HttpGet]`属性或删除`[HttpPost]`属性以解决此特定问题。

通常，您会希望在提交数据时继续使用 POST 请求。因此，我的建议是将客户端更改为使用表单（或使用客户端逻辑来拦截链接单击操作并使用 ajax 请求提交数据）。

# objective-c - 无窗截图

> ID：14666123
> 
> 赞同：2
> 
> 时间：2013-02-02T20:21:14.220
> 
> 标签：objective-c, xcode4.2

我一直在研究 Son Of Grab Apple 演示，我真的很难获得没有任何窗口的屏幕截图（只有桌面、停靠栏和菜单栏）。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:22:39.130

这是一些示例代码，它仅使用桌面截取屏幕截图。

```
CFArrayRef onScreenWindows = CGWindowListCreate(kCGWindowListOptionOnScreenOnly, kCGNullWindowID);
CFArrayRef nonDesktopElements = CGWindowListCreate(kCGWindowListOptionOnScreenOnly | kCGWindowListExcludeDesktopElements, kCGNullWindowID);
CFRange range = CFRangeMake(0, CFArrayGetCount(nonDesktopElements));
CFMutableArrayRef desktopElements = CFArrayCreateMutableCopy(NULL, 0, onScreenWindows);
for (int i = CFArrayGetCount(desktopElements) - 1; i >= 0; i--)
{
    CGWindowID window = (CGWindowID)(uintptr_t)CFArrayGetValueAtIndex(desktopElements, i);
    if (CFArrayContainsValue(nonDesktopElements, range, (void*)(uintptr_t)window))
        CFArrayRemoveValueAtIndex(desktopElements, i);
}

CGImageRef cgimage = CGWindowListCreateImageFromArray(CGRectInfinite, desktopElements, kCGWindowListOptionAll);
NSBitmapImageRep* rep = [[NSBitmapImageRep alloc] initWithCGImage:cgimage];
NSData* data = [rep representationUsingType:NSPNGFileType properties:[NSDictionary dictionary]];
[data writeToFile:@"/tmp/foo.png" atomically:YES]; 
```

您应该能够扩展获取 Dock 和菜单栏的一般方法。您构建一个您感兴趣的窗口 ID 列表，然后调用`CGWindowListCreateImageFromArray()`. 我通过询问所有屏幕窗口和所有屏幕窗口（不包括桌面元素）来计算桌面元素的窗口 ID。桌面元素是第一个列表中不在第二个列表中的元素。

获取菜单栏和 Dock 的窗口 ID 并没有那么直接，因为 CGWindowList API 中没有直接对应的选项。您需要使用`CGWindowListCopyWindowInfo()`or获取屏幕窗口的描述字典数组`CGWindowListCreateDescriptionFromArray()`并检查内容。最有用的键可能是`kCGWindowLayer`. 除了在我的示例代码中使用该技术获得的桌面元素之外，我认为您会想要`CGWindowLevelForKey(kCGDockWindowLevelKey)`更多的东西。

# ajax - AJAX 调用失败取决于代码中的位置，浏览器触发 document.ready 中途调用。推特引导问题？

> ID：14666124
> 
> 赞同：1
> 
> 时间：2013-02-02T20:21:39.507
> 
> 标签：ajax, twitter-bootstrap, document-ready

我在追一个讨厌的问题。onclick 处理程序中的 AJAX 调用未完成，因为浏览器在调用过程中触发了 document.ready。在 Firebug 控制台中跟踪 readystate 和状态时，我得到：

*   `READYSTATECHANGE:1 STATUS:0`
*   `READYSTATECHANGE:2 STATUS:0`
*   `READYSTATECHANGE:4 STATUS:0`
*   `Document Ready`（-> 这是第二次触发，在重新连接 UI 时破坏了一切）

我相信我没有面临跨域安全块，因为在页面的其他地方调用时，相同的 AJAX 调用将正确完成。

我正在使用 Jquery 1.8.1，我尝试了多种 AJAX 客户端调用（即

```
$.getJSON
$.ajax 
```

以及使用标准`XMLHttpRequest`对象。

有没有人见过这个？用于更深入调试的指针会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:31:20.627

调试完问题后，我现在有一个解决方法。我的 AJAX 调用是从链接到 Twitter 引导按钮的单击处理程序中调用的。单击该按钮会触发 AJAX 调用，但也会触发一个`window.load`事件，该事件会刷新 JS 应用程序。

我的解决方法是`<button>..</button>`用一个`<input>..</input>`字段替换 ，见下文：

```
<form class="form-search">
    <label>Enter search string:
        <input id="SearchString" type="text" class="input-medium search-query">
        <!-- Broken: <button id="SearchAction" type="submit" class="btn btn-primary"> Search </button> -->
        <!-- This works: -->
        <input type="button" id="SearchAction" value="Go Find"/>
        <img id="RssAction" style="vertical-align:bottom" src="images/feed-icon-14x14.png">
    </label>
</form> 
```

这可能还不是根本原因。

# wordpress - WordPress - 如何最小化我的 WordPress 查询？

> ID：14666129
> 
> 赞同：0
> 
> 时间：2013-02-02T20:21:55.010
> 
> 标签：wordpress

我有一个正在运行的 Wordpress 查询。它查询一周中的几天，目前，我知道每天重复查询的唯一方法是运行查询 7 次，手动更改星期几。

有没有办法只运行一次查询？

我的代码：

```
<?php
$args=array(
  'taxonomy' => 'day',
  'term' => 'monday',
  'post_type' => 'schedule',
  'meta_key' => 'tr_show_time', 
  'orderby' => 'tr_show_time', 
  'order' => 'asc',  
  'posts_per_page' => 24,
  'caller_get_posts'=> 1
);
$my_query = null;
$my_query = new WP_Query($args);
if( $my_query->have_posts() ) {
while ($my_query->have_posts()) : $my_query->the_post(); ?>

My code to execute for the schedule.

<?php endwhile; } wp_reset_query(); ?> 
```

所以目前，我必须更改每个查询中的“术语”，并且有 7 次相同的查询。一定会有更好的办法。

如果有更好的方法，有人可以回答并教我答案吗？

谢谢

编辑：我只想补充一点，日程表上的每个“天”都有 24 个项目，一天中的每个小时一个，它们按从 00:00 到 24:00 的顺序显示（00:00、01:00、02 :00 等），因此需要维护此“排序”。我能看到的唯一方法是每天单独查询，因此我有 7 个查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:32:11.897

I solved it myself:

```
<?php
date_default_timezone_set('America/New_York');
$d=date("D");
$current_day = date ('l');
?>
    <ul>
      <?php
$args=array(
  'taxonomy' => 'day',
  'term' => $current_day,
  'post_type' => 'schedule',
  'meta_key' => 'tr_show_time', 
  'orderby' => 'tr_show_time', 
  'order' => 'asc',  
  'posts_per_page' => 24,
  'caller_get_posts'=> 1
);
$my_query = null;
$my_query = new WP_Query($args);
if( $my_query->have_posts() ) {
while ($my_query->have_posts()) : $my_query->the_post(); ?>
      <?php $show_name = get_post_meta( get_the_ID(), 'tr_show_name', true ); ?>
      <?php $show_time = get_post_meta( get_the_ID(), 'tr_show_time', true ); ?>

my code here.

      <?php endwhile; } wp_reset_query(); ?>
    </ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:33:30.707

Try using the `tax_query` parameter

```
$args = array(
  'tax_query' => array(
        array(
            'taxonomy' => 'day',
            'field' => 'slug',
            'terms' => array( 'monday', 'tuesday', 'wednesday' )
        )
    ),
  'post_type' => 'schedule',
  'meta_key' => 'tr_show_time', 
  'orderby' => 'tr_show_time', 
  'order' => 'asc',  
  'posts_per_page' => 24,
  'caller_get_posts'=> 1
); 
```

For more information read up on [taxonomy queries](http://codex.wordpress.org/Class_Reference/WP_Query#Taxonomy_Parameters)

# java - 编译后Java对象引用变量类型会发生什么？

> ID：14666132
> 
> 赞同：3
> 
> 时间：2013-02-02T20:22:02.047
> 
> 标签：java, variables, reference, compilation, bytecode

我不记得曾经在 Java 字节码中看到过任何引用变量类型的概念。我对类型擦除有所了解，但这个术语似乎与泛型密切相关，而我的问题一般是关于对象引用变量。Java 对象引用变量类型能否在编译后继续存在？或者变量类型只是起到帮助编译器帮助开发人员检查代码是否有意义的作用？如果引用变量类型在编译后仍然存在，它们会出现在字节码中的什么位置？

编辑：请允许我在这里感谢您的所有宝贵贡献。为了进一步缩小我的想法，我想添加一个示例：

```
Object o = "foo"; 
```

在字节码中，变量 o 及其类型（对象）会在任何地方表示并在运行时读取吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:27:39.653

是的，字节码也是类型安全的。首先，每次向下转换时都会使用一个字节码[指令：`checkcast`](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)

```
Object obj = "abc";
String s = (String)obj; 
```

被翻译成：

```
aload_1       
checkcast     #3                  // class java/lang/String
astore_2 
```

* * *

其次`invokevirtual`，其他人期望给定类型的对象。如果您传递了错误的类型，JVM 将拒绝加载此类。我不认为用 Java 语言可以实现，所以我做了一些黑客攻击。以下代码：

```
Integer x = 1;
String s = "abc";
int len = s.length(); 
```

被翻译成：

```
 0: iconst_1      
   1: invokestatic  #2                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
   4: astore_1      
   5: ldc           #3                  // String abc
   7: astore_2      
   8: aload_2       
   9: invokevirtual #4                  // Method java/lang/String.length:()I
  12: istore_3 
```

`8`注意加载`s`局部变量的指令。使用十六进制编辑器替换`aload_2`为`aload_1`，从而尝试调用`String.length()`对象`Integer`（`x`局部变量）：

```
$ java Test

Exception in thread "main" java.lang.VerifyError: 
  Bad type on operand stack in method Test.main([Ljava/lang/String;)V at offset 9 
```

只是如果你好奇，如果你禁用类验证，地狱就会崩溃：

```
$ java -Xverify:none Test
Exception in thread "main" java.lang.NullPointerException
  at java.lang.String.length(String.java:623)
  at Test.main(Test.java:6) 
```

本来可以更糟的。

* * *

最后但同样重要的是，有大量专用于特定原语（浮点数、双精度数、整数等）的操作码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:58:15.663

JVM 加载的所有字节码都经过静态类型检查以确保其安全。如果没有类型检查，恶意字节码可能只会将 int 视为指针并破解 VM。

然而，仅仅因为字节码是类型安全的并不意味着它具有显式类型。相反，每个值都有一个由类型推断确定的隐式类型。（从 Java 7 开始，还必须在每个基本块的开头包含指定所有内容类型的元数据，从而使类型推断任务更加容易）。

请注意，虽然所有内容都经过类型检查，但规则比 Java 中的更为宽松。例如，在字节码中，没有布尔、字节、字符或短局部变量之类的东西。它们都被编译成整数。因此，例如，您可以拥有一个不等于 true 或 false 的布尔值。此外，在您调用接口的方法之前不会检查接口，因此接口变量实际上可以保存任何任意对象。最后，Hotspot VM 允许您自由混合 byte[] 和 boolean[]s。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T20:54:23.383

字段类型在[字段描述符](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.3.2)中编码。

局部变量的类型可以编码到[LocalVariableTable 属性](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7.13)（或通用类型的[LocalVariableFieldTypeTable 属性](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7.14)）中，并且在面向 Java 6 的类文件中，必须在[StackMapTable 属性](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7.4)中编码。[对于较旧的类文件，JVM 将使用类型推断](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.10.2)验证字节码的类型正确性。

因此，虽然字段和变量的类型没有用字节码表示是正确的，但它们在类文件中（至少对于面向 Java 6 或更高版本的类文件）。

# python - Python __Slots__ (制作和使用)

> ID：14666138
> 
> 赞同：0
> 
> 时间：2013-02-02T20:22:39.400
> 
> 标签：python, class, slots

我真的没有上课并且使用`__slots__`有人可以让它更清楚吗？

例如，我正在尝试创建两个类，一个是空的，另一个不是。到目前为止我得到了这个：

```
class Empty:
    __slots__ =()

def mkEmpty():
    return Empty()

class NonEmpty():
    __slots__ = ('one', 'two') 
```

但我不知道如何制作“mkNonEmpty”。我也不确定我的 mkEmpty 函数。

谢谢

编辑：

这就是我最终的结果：

```
class Empty:
    __slots__ =()

def mkEmpty():
    return Empty()

class NonEmpty():
    __slots__ = ('one', 'two')

def mkNonEmpty(one,two):
    p = NonEmpty()
    p.one= one
    p.two= two
    return p 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:47:16.373

然后，您必须以传统方式初始化您的类。它将像这样工作：

```
class Empty:
    __slots__ =()

def mkEmpty():
    return Empty()

class NonEmpty():
    __slots__ = ('one', 'two')

    def __init__(self, one, two):
        self.one = one
        self.two = two

def mkNonEmpty(one, two):
    return NonEmpty(one, two) 
```

实际上，构造函数是不必要的和非 Pythonic。您可以并且应该直接使用类构造函数，如下所示：

```
ne = NonEmpty(1, 2) 
```

如果您需要某种记录，您也可以使用空构造函数并直接在应用程序中设置插槽

```
class NonEmpty():
    __slots__ = ('one', 'two')

n = NonEmpty()
n.one = 12
n.two = 15 
```

您需要了解，仅出于性能/内存原因需要插槽。您不需要使用它们，也可能不应该使用它们，除非您知道您的内存受限。不过，这应该只是在实际遇到问题之后。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-02T20:43:58.213

也许[文档](http://docs.python.org/2/reference/datamodel.html?highlight=slots#__slots__)会有所帮助？老实说，这听起来不像你需要担心的水平`__slots__`。

# .htaccess - .htaccess 重写 php 分页

> ID：14666140
> 
> 赞同：3
> 
> 时间：2013-02-02T20:22:59.230
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, pagination

我已经查看了有关此主题的多个线程，但是所有线程都在处理多个参数，而且**我**对 .htaccess 还是很陌生，我无法弄清楚如何修改答案以适应我的需要。

我正在使用 .htaccess 重写 URL，除了我尝试重写分页 URL 时，一切似乎都很顺利。

我的分页网址非常简单： blog.php?page=2 但由于某种原因我无法将网址重写为 /blog/page/2 。当我尝试将其路由到该 URL 时，我收到“内部服务器错误”。现在我将它重写为 /blog-page/2，这没关系，但我更喜欢 /blog/page/2。

我的 .htaccess 文件中有很多事情要做，所以我只会发布重写：

```
RewriteEngine On

# Full path
#RewriteBase /

# Rewrite all php files    
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php

# Rewrite the user profile pages
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^user/([a-zA-Z0-9_-]+)$ profile.php?user=$1
RewriteRule ^user/([a-zA-Z0-9_-]+)/$ profile.php?user=$1

# Rewrite the company profile pages
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^company/([a-zA-Z0-9_-]+)$ employer.php?user=$1
RewriteRule ^company/([a-zA-Z0-9_-]+)/$ employer.php?user=$1

# Rewrite the blog post pages
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^post/([a-zA-Z0-9_-]+)$ entry.php?id=$1
RewriteRule ^post/([a-zA-Z0-9_-]+)/$ entry.php?id=$1

# Rewrite the job listing pages
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^job/([a-zA-Z0-9_-]+)$ listing.php?id=$1
RewriteRule ^job/([a-zA-Z0-9_-]+)/$ listing.php?id=$1

# Rewrite blog pagination
RewriteRule ^blog/page/([0-9]+)$ blog.php?page=$1 
RewriteRule ^blog/page/([0-9]+)/$ blog.php?page=$1 
```

显然，我遇到的问题是博客分页的最终 RewriteRule。为什么我不能使它成为 /blog/page/2 但我可以使它成为 /blog-page/2？

我还尝试对博客类别和工作类别进行多页 .htaccess 重写，但我不断收到内部错误。我想要 1 次重写博客的工作类别和博客类别。这就是我所拥有的：

```
# Rewrite the category queries
RewriteRule ^/category/(.*)/?$ /$.php?cat=$1 [L,QSA] 
```

是否可以使此分页重写适用于 2 个不同的页面？比如blogs.php和jobs.php？

`RewriteCond %{REQUEST_FILENAME} !-f`另外，在我制定重写规则之前是否有必要继续放置？还是1次就够了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T07:12:27.537

您是否检查过 apache 错误日志以获取有关错误消息的信息？如果没有，那么每当您收到 500 内部错误消息时，这是第一个开始的地方。

看看apache 手册中的[RewriteCond](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)。看来您希望 RewriteCond 可以为多个规则工作，但这不是它的工作方式。RewriteCond 仅适用于下一个 RewriteRule。您可以将多个 RewriteCond 行链接在一起以获得单个 RewriteRule，但如果您希望 RewriteCond 应用于 RewriteRules，则必须将其放在每行之前。

好消息是您的大多数规则都不需要 RewriteCond：

```
RewriteEngine On

# Rewrite all php files    
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php [L]

# Rewrite the user profile pages
RewriteRule ^user/([a-zA-Z0-9_-]+)/?$ profile.php?user=$1 [L]

RewriteCond 
# Rewrite the company profile pages
RewriteRule ^company/([a-zA-Z0-9_-]+)/?$ employer.php?user=$1 [L]

# Rewrite the blog post pages
RewriteRule ^post/([a-zA-Z0-9_-]+)/?$ entry.php?id=$1 [L]

# Rewrite the job listing pages
RewriteRule ^job/([a-zA-Z0-9_-]+)/?$ listing.php?id=$1 [L]

# Rewrite blog pagination
RewriteRule ^blog/page/([0-9]+)/?$ blog.php?page=$1 [L] 
```

我对您的规则进行了一些更改：

1.  删除了大部分 RewriteCond 规则。如果您计划在任何目录中包含一些静态文件，则需要添加`RewriteCond %{REQUEST_FILENAME} !-f`规则以便为它们提供服务。
2.  通过添加 ? 来合并处理尾随 / 的规则 使斜线可选。
3.  在您的规则中添加 [L] 以指示在找到并执行匹配项后无需运行其他规则。查看apache 手册中的[RewriteRule以获取有关可用标志的更多详细信息。](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)

# c# - 如何在 Watin 等待回邮？

> ID：14666141
> 
> 赞同：2
> 
> 时间：2013-02-02T20:23:18.707
> 
> 标签：c#, web, watin

在我的 C# 代码中，我`Watin`用来浏览网页，登录到一个页面，我需要点击登录按钮，但是在我想注销之后，所以我有点击注销按钮，但是注销部分不起作用。我什至尝试在登录后关闭浏览器（使用 close 方法），但没有奏效。感觉一旦页面发生更改（即登录后），来自 c# 的更多命令将不再起作用。

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T15:22:16.317

正如另一个答案中提到的 Thread.Sleep(milliseconds) 是一种等待一段时间以加载某些内容的方法。非常非常容易实现，但由于加载时间不同，它远非最佳，如果你让它足够长以至于它总是等待足够长的时间，你最终会浪费很多时间。在一次测试中，这没什么大不了的，但是例如，如果您必须等待 5 秒钟并且您有 1000 次测试......等等等等等等。

我走过的路线是：

1.  放入 Thread.Sleep()s 以确定它是否是“等待”问题。
2.  如果要多次使用带有 Sleep() 的代码，请找出导致需要 sleep() 的原因。
3.  使用各种 Wait...() 方法重构 Sleep()。WaitTilExists、WaitForAttributeEqualsWhatever、WaitForAsyncToFinish <- 不是真正的方法，但 WatiN 内置了一堆

现在等待我的主要原因是 ASP.NET 中的 JQuery 异步调用，我创建了一个静态帮助器类，它可以很好地等待异步调用完成。这些往往非常特定于您正在测试的网站所使用的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T20:01:41.777

在 Watin 中，您会遇到许多代码是非阻塞的情况（您将执行一行代码并立即继续执行），因此对于这些情况，您需要找到一种不同的方式来了解下一页（操作，等）已经存在。例如，在登录页面上，您可以检查该页面是否有一个名为 UserName 的 TextBox：

```
<code>      
    TextField uName = browser.TextField(Find.ByName("userName"));    
    if(uName.Exists)
    {
         // Then do the login code....
    }
</code> 
```

同样，在继续执行代码之前，您应该控制登录后的页面是否存在。例如，如果您登录到一个您知道将包含文本的页面：“您的帐户详细信息”，您可能会执行以下操作：

```
<code>
    browser.GoTo("http://www.yourdomain.com/login.aspx");
    //do your login code

    browser.WaitUntilContainsText("Your Account Details", 240); // the second parameter indicates the seconds it will wait before it times out.

    // your code to deal with the page after the login.  
</code> 
```

使用 Thread.Sleep 会造成混乱，这肯定是一个问题，你永远不会在网页上获得正确的时间（即使你认为它需要 10 秒它可能永远不会回来，那时服务器将终止打开的连接）。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T13:48:38.067

watin click 命令等到浏览器加载完毕，所以实际上它是在等待回发。如果您使用 ClickNoWait() 命令，它不会等待。因此，如果您的代码看起来像这样，它应该可以工作：

```
browser.GoTo("www.your-site.com");
// fill user/pass
browser.Button(Find.ByClass("login-class")).Click();
browser.Button(Find.ByClass("logout-class")).Click(); 
```

如果它仍然不起作用，您可以在登录后单击**browser.WaitForComplete();**

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-04T14:17:12.123

在脚本中使用 Thread.sleep 与注销和登录同步...或者直接关闭应用程序并使用 ie 实例重新登录应用程序而不是注销

# c# - 处理 MVC 后模型的最佳实践是什么？

> ID：14666142
> 
> 赞同：4
> 
> 时间：2013-02-02T20:23:28.940
> 
> 标签：c#, .net, asp.net-mvc, razor

我对 MVC 还是很陌生，但仍然对 2 个案例的最佳和正确方法感到困惑，结果相同。假设某个用户应该为特定的根类别添加新的子类别。

**情况 1：** SubCategory 是 EF 的映射类，其中所有属性都不可为空。

控制器：

```
 [Authorize]
    public ActionResult Create()
    {
        SubCategory subCategory = new SubCategory();

        subCategory.RootCategoryID = 1;

        return View(subCategory);
    }

    [Authorize]
    [HttpPost]
    public ActionResult Create(SubCategory thisSubCategory)
    {
        if (ModelState.IsValid)
        {
           //And some BL logic called here to handle new object...
        }
    } 
```

看法：

```
 @Html.HiddenFor(model => model.ID)

    @Html.HiddenFor(model => model.RootCategoryID)

    <h3>Sub Category Name: </h3>

    @Html.EditorFor(model => model.CategoryName)

    @Html.ValidationMessageFor(model => model.CtaegoryName)

    <input id="btnAdd" type="submit" value="Add" /> 
```

**案例 2：** 添加助手类作为控制器的模型并在发布后填充 EF 对象

控制器：

```
 class SubCategoryHelper
    {
       public string Name { get; set; }
    }

    [Authorize]
    public ActionResult Create()
    {
       SubCategoryHelper subCategory = new SubCategoryHelper();

       return View(subCategory);
    }

    [Authorize]
    [HttpPost]
    public ActionResult Create(SubCategoryHelper thisSubCategory)
    {
        if (ModelState.IsValid)
        {
           SubCategory newSubCategory = new SubCategory();

           newSubCategory.RootCategoryID = 1;

           newSubCategory.CtaegoryName = thisSubCategory.Name;

           //And some BL logic called here to handle new object...
        }
    } 
```

看法：

### 子类别名称：

```
 @Html.EditorFor(model => model.Name)

    @Html.ValidationMessageFor(model => model.Name)

    <input id="btnAdd" type="submit" value="Add" /> 
```

两种方式都一样，但第一种方式看起来不太安全，因为可以在客户端更改隐藏。第二种方式要长得多，想象一下对于客户端或产品等丰富对象的相同方式......我应该选择什么？还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:16:39.213

**第一种情况很简单。**如果您扩展您的模型，您将不得不在更少的地方进行更改。它的安全性并不低。您可以通过多种方式绕过创建或绑定隐藏的输入字段。

用于`BindAttribute`绕过属性绑定：

```
ActionResult Create([Bind(Exclude = "RootCategoryId")]
                    SubCategoryHelper thisSubCategory) {//....} 
```

或者`ScaffoldColumnAttribute`在模型类属性上（例如，当您使用编辑模板时）：

```
[ScaffoldColumn(false)]
public int RootCategoryId {get; set;} 
```

或者只是简单地不公开它（就像您在使用`Html.HiddenInput`帮助器的示例中所做的那样）。

* * *

您描述的第二种方法通常称为**ViewModel 模式**。它**鼓励你的表现层和领域层的分离**。优点是，您的域模型不会被表示层特定代码（如各种显示属性等）污染。但是，它带来了域模型和视图模型之间映射的另一个开销。

可能没有一般的经验法则。这取决于您的应用程序的类型。

*如果它基本上是一些简单的数据驱动的 CRUD 应用程序，您可以轻松地留在第一个。然而，当您的应用程序变得更大时，您肯定会欣赏您在不同层上的自由。如果您的 BLL 代码与除 ASP MVC 之外的其他类型的“客户端”（Web 服务、桌面等）一起使用，我肯定会选择第二种选择。*

我还建议阅读这篇很棒的文章：[分层值得映射吗](http://blog.ploeh.dk/2012/02/09/IsLayeringWorthTheMapping.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T21:17:38.857

我总是选择案例 2，无论是我从事的小项目还是大项目，我总是将我的数据层（实体框架）和我的 UI 层分开。尤其是如果您使用的是实体框架，因为这些对象可能会变得很大，而且您正在传递很多您通常不需要的废话。

与其称它为`Helper`类，不如称它们为`ViewModel`或`Model`。在你的情况下，`SubCategoryViewModel`.

```
public class SubCategoryViewModel
{
   public int Id {get;set;}
   public int RootCategoryId {get;set;}
   [Required]
   public string Name { get; set; }
}

[Authorize]
public ActionResult Create()
{
   var subCategoryViewModel = new SubCategoryViewModel();

   return View(subCategoryViewModel);
}

[Authorize]
[HttpPost]
public ActionResult Create(SubCategoryViewModel viewModel)
{
    if (ModelState.IsValid)
    {
       var subCategory = new SubCategory();

       subCategory.RootCategoryID = 1;

       subCategory.CategoryName = viewModel.Name;

       //And some BL logic called here to handle new object...

    }
} 
```

# ruby - 使用命名路由使用我的匹配路由格式生成简单链接

> ID：14666149
> 
> 赞同：0
> 
> 时间：2013-02-02T20:24:10.897
> 
> 标签：ruby, ruby-on-rails-3, routes, link-to

这是我写的路线：

```
Foo::Application.routes.draw do
  get "home/index"

  match "/ads/:category_name" => "ads#by_category"
  match "/ads/:category_name/:id" => "ads#show"

  resources :ads

  root :to => 'home#index'
end 
```

在我的一个共享视图中，我编写了一个显示所有类别的侧边栏元素：

```
<div id="category-sidebar">
  <h2>Categorias</h2>
  <% Category.order('name').each do |category| %>
    <%= link_to category.name %>
  <% end %>
</div> 
```

这会产生：

```
<div id="category-sidebar">
  <h2>Categorias</h2>
    <a href="/ads/Aeronautica">Aeronautica</a>
    <a href="/ads/Aeronautica">Agropecuaria y Campo</a>
    <a href="/ads/Aeronautica">Alimentos y Bebidas</a>
    <a href="/ads/Aeronautica">Animales y Mascotas</a>
    <a href="/ads/Aeronautica">Arte y Antiguedades</a>
</div> 
```

* * *

我想产生一个`href`喜欢：

```
/ads/Aeronautica
/ads/Alimentos%20y%20Bebidas 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:13:51.723

使用 bundle exec rake routes 为您的“/ads/:category_name/:id”路径查找命名路由。假设这条路线被称为“类别”。然后你可以这样做（注意'_path'位）：

```
Category.order('name').each do |category|
  link_to category.name, categories_path(:id => category.id)
end 
```

# java - JMS Connectionfactory 在 TomEE+ 1.5.1 Servlet 中给出 NullPointerException

> ID：14666152
> 
> 赞同：0
> 
> 时间：2013-02-02T20:24:23.213
> 
> 标签：java, servlets, jms, code-injection

我正在测试 TomEE+，因为它包含了我在新系统中需要的许多功能。Apache ActiveMQ 就是其中之一。但是我在让 JMS 工作时遇到了一些困难，而且我寻找解决方案的努力没有产生任何结果。我什至试图用谷歌搜索答案！

即使我尝试“开箱即用”的示例：

```
import javax.annotation.Resource;
import javax.servlet.http.HttpServlet;
import javax.jms.Topic;
import javax.jms.Queue;
import javax.jms.ConnectionFactory;

public class MyServet extends HttpServlet {

    @Resource(name = "foo")
    private Topic fooTopic;

    @Resource(name = "bar")
    private Queue barQueue;

    @Resource
    private ConnectionFactory connectionFactory;

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //...

        Connection connection = connectionFactory.createConnection();
        connection.start();

        // Create a Session
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

        // Create a MessageProducer from the Session to the Topic or Queue
        MessageProducer producer = session.createProducer(fooTopic);
        producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT);

        // Create a message
        TextMessage message = session.createTextMessage("Hello World!");

        // Tell the producer to send the message
        producer.send(message);

        //...
    }

} 
```

我遇到了同样的问题，我的 ConnectionFactory 为空。当我调试时，我可以看到我所有的 @Resource 注释成员都是这种情况。我认为我的成员在正确注释时会通过注入实例化？

我尝试将此添加到我的 tomee.xml 中，但没有结果：

```
<Resource id="MyJmsResourceAdapter" type="ActiveMQResourceAdapter">
  BrokerXmlConfig =  broker:(tcp://localhost:61616)
  ServerUrl       =  tcp://localhost:61616
</Resource>

<Resource id="MyJmsConnectionFactory" type="javax.jms.ConnectionFactory">
  ResourceAdapter = MyJmsResourceAdapter
</Resource>

<Container id="MyJmsMdbContainer" ctype="MESSAGE">
  ResourceAdapter = MyJmsResourceAdapter
</Container>

<Resource id="bar" type="javax.jms.Queue"/>
<Resource id="foo" type="javax.jms.Topic"/> 
```

运行示例时，我仍然得到 NullPointerException。关于我可能遗漏某些东西的任何建议。除了 tomee.xml 之外，我正在运行 TomEE+ 的 1.5.1 版本，没有任何改变。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T06:37:17.383

将连接工厂资源代码更改为以下。它应该工作

```
@Resource(name = "MyJMSConnectionFactory", type = ConnectionFactory.class)
private ConnectionFactory connectionFactory; 
```

# python - 从查找文件批量重命名文件名的一部分

> ID：14666157
> 
> 赞同：2
> 
> 时间：2013-02-02T20:24:53.763
> 
> 标签：python, dictionary, rename

**编辑**：我的最终解决方案见底部

我有一个约 12,700 个文本文件的目录。

他们有这样的名字：

*1 - Re/Report Novenator 公开呼吁埋葬 - Lizbett 于 2009 年 9 月 10 日星期四撰写。txt*

每个文件的前导数字递增（例如目录中的最后一个文件以“12,700 - ”开头）。

不幸的是，这些文件没有按时间排序，我需要它们。幸运的是，我有一个单独的 CSV 文件，其中映射了 ID 号，例如上面示例中的 1 应该是 25（因为它之前有 24 条消息），2 应该是 8，3 应该是 1，依此类推，像这样：

```
OLD_FILEID  TIMESORT_FILEID
21      0
23      1
24      2
25      3 
```

我不需要更改文件标题中的任何内容，除了这个我需要与其关联值交换的单个前导数字。在我的脑海中，这将工作的方式是打开一个文件名，检查出现在破折号之前的数字，在 CSV 中查找它们，用相关的值替换它们，然后用调整后的标题保存文件并继续到下一个文件。

做这样的事情的最好方法是什么？我是一个 python 新手，但已经玩过足够的游戏，可以按照大多数指示或建议感到自在。谢谢 ：）

e：尽我所能按照以下说明进行操作，但不起作用，但我不知道为什么：

```
import os
import csv
import sys

#open and store the csv file
with open('timesortmap.csv','rb') as csvfile:
timeReader = csv.reader(csvfile, delimiter = ',', quotechar='"')

#get the list of files
for filename in os.listdir('DiggOutput-TIMESORT/'):
oldID = filename.split(' - ')[0]
newFilename = filename.replace(oldID, timeReader[oldID],1)
os.rename(oldID, newFilename) 
```

我得到的错误是：

```
TypeError: '_csv.reader' object is not subscriptable 
```

我没有使用 DictReader，但那是因为当我使用 csv.reader 并打印行时，它看起来像这样：

```
['12740', '12738']
['12742', '12739']
['12738', '12740']
['12737', '12741']
['12739', '12742'] 
```

当我使用 DictReader 时，它看起来像这样：

```
{'FILEID-TS': '12738', 'FILEID-OLD': '12740'}
{'FILEID-TS': '12739', 'FILEID-OLD': '12742'}
{'FILEID-TS': '12740', 'FILEID-OLD': '12738'}
{'FILEID-TS': '12741', 'FILEID-OLD': '12737'}
{'FILEID-TS': '12742', 'FILEID-OLD': '12739'} 
```

我在终端中收到此错误：

```
File "TimeSorter.py", line 16, in <module>
newFilename = filename.replace(oldID, timeReader[oldID],1)
AttributeError: DictReader instance has no attribute '__getitem__' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:58:05.187

这在 Python 中应该非常简单，只需使用[`csv`](http://docs.python.org/2/library/csv.html)和[os](http://docs.python.org/2/library/os.html)模块即可。

Python 有一个名为的内置[字典类型](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)`dict`，可用于在处理时将 ​​csv 文件的内容存储在内存中。基本上，您需要使用`csv`模块读取 csv 文件并将每个条目转换为字典条目，可能使用`OLD_FILEID`字段作为键和`TIMESORT_FILEID`值。

然后，您可以使用[`os.listdir()`](http://docs.python.org/2/library/os.html#os.listdir)获取文件列表并使用循环依次获取每个文件名。（如果您需要过滤文件名列表以排除某些文件，请查看[`glob`](http://docs.python.org/2/library/glob.html)模块）。在您的循环中，您只需要提取与文件关联的数字，这可以使用以下方法完成：

```
file_number = filename.split(' - ')[0] 
```

然后调用[`os.rename()`](http://docs.python.org/2/library/os.html#os.rename)传入旧文件名和新文件名。可以使用以下内容找到新文件名：

```
new_filename = filename.replace(file_number, file_mapping[file_number], 1) 
```

`file_mapping`从 csv 文件创建的字典在哪里。这会将第一次出现的 替换为`file_number`映射文件中的数字。

**编辑**

正如 TheodrosZelleke 指出的那样，按照我上面列出的内容，有可能覆盖现有文件。几种可能的策略：

1.  用于`os.rename()`将文件的重命名版本移动到不同的目录（例如，当前目录的子目录，或者更好的是使用创建的临时目录[`tempfile.mkdtemp()`](http://docs.python.org/2/library/tempfile.html#tempfile.mktemp)。一旦所有文件都被重命名，用于`os.rename`将文件从临时目录移动到当前目录。
2.  为新文件名添加扩展名，例如，`.tmp`假设选择的扩展名不会导致其他冲突。完成所有重命名后，使用第二个循环重命名文件以排除`.tmp`扩展名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T01:06:27.790

这是我最终与朋友一起解决的问题，如果有人找到并寻找它：

```
import os
import csv
import sys

IDs = {}

#open and store the csv file
with open('timesortmap.csv','rb') as csvfile:
        timeReader = csv.reader(csvfile, delimiter = ',', quotechar='"')

        # build a dictionary with the associated IDs
        for row in timeReader:
              IDs[ row[0] ] = row[1]

# #get the list of files
path = 'DiggOutput-OLDID/'
tmpPath = 'DiggOutput-TIMESORT/'
for filename in os.listdir('DiggOutput-OLDID/'):
    oldID = filename.split(' - ')[0]
    newFilename = filename.replace(oldID, IDs[oldID])
    os.rename(path + filename, tmpPath + newFilename) 
```

# objective-c - NSPredicate 中的减法

> ID：14666161
> 
> 赞同：2
> 
> 时间：2013-02-02T20:25:03.843
> 
> 标签：objective-c, nspredicate

我想要一个像这样的 NSPredicate ：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(latitude - %@) < %@",coordsLatitude, kMaxLatLong]; 
```

我基本上想在 Core Data 中找到与`userLocation`.

*   `latitude`是每个 gps 实体的纬度属性。

*   `coordsLatitude`是 userLocation 的纬度。

*   `kMaxLatLong`设置为 1

我得到了`EXC_BAD_ACCESS`这条线。我认为这是由于我的谓词格式不正确，尤其是减法运算符。但是，我找不到任何说明如何使用 NSPredicates 和 NSExpressions 的减法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:32:07.103

我会反过来做。

计算出最小和最大纬度，然后使用谓词查找介于两者之间的所有内容。

IE

```
float coordsLatitude = //whatever

float minLatitude = coordsLatitude - kMaxLatLong;
float maxLatitude = coordsLatitude + kMaxLatLong;

NSPredicate *minPredicate = [NSPredicate predicateWithFormat:@"latitude >= %f", minLatitude];
NSPredicate *maxPredicate = [NSPredicate predicateWithFormat:@"latitude <= %f", maxLatitude];

NSPredicate *compoundPredicate = [NSCompoundPredicate andPredicateWithSubPredicates:@[minPredicate, maxPredicate]]; 
```

然后在您的获取请求中使用 CompoundPredicate。

# java - 将 2D Double 转换为 2D Float

> ID：14666162
> 
> 赞同：0
> 
> 时间：2013-02-02T20:25:09.953
> 
> 标签：java, multidimensional-array, casting, floating-point

有谁知道如何将二维数组从 double 转换为 float 我有以下内容：

```
double [][] matrix = new double[width][height]; 
```

我想将变量 data 中的数据转换为 Flaot，所以我有一个新变量，如下所示：

```
float [][] floatmatrix = new float[width][height]; 
```

我试过铸造，但它是不允许的，例如

```
float[][] data = (float[][]) result; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:28:23.443

您需要逐项复制它（在两个嵌套循环中）：

```
 float[][] floatmatrix = new float[width][height];
    for (w = 0; width > w; w++) {
        for (h = 0; height > h; h++) {
            floatmatrix[w][h] = (float) matrix[w][h];
        }
    } 
```

# javascript - 无法在 Visual Studio (Windows 8) 中加载 Bing 地图的“方向”模块

> ID：14666165
> 
> 赞同：0
> 
> 时间：2013-02-02T20:25:27.683
> 
> 标签：javascript, visual-studio-2012, windows-8, bing-maps

我对 Windows 8 应用程序开发很陌生。我已经在 Visual Studio 中启动并运行了一个不错的“Hello World”程序。我正在使用 Javascript API。

我在加载模块时遇到问题。我无法专门加载“Microsoft.Maps.Directions”模块。

“Microsoft.Maps.Map”正在加载没有任何问题，我可以毫无问题地显示地图。但是每当我尝试加载其他模块时，我的应用程序就会崩溃。

我在这里忽略了一些非常明显的东西吗？我需要下载一些额外的库吗？我已经下载了 Bing Maps AJAX Control 7 SDK 并使用它来显示地图。

谢谢！

我的代码：

```
//Initialization logic for loading the map control
(function () {
    function initialize() {
        Microsoft.Maps.loadModule('Microsoft.Maps.Directions', { callback: Testing});
        Microsoft.Maps.loadModule('Microsoft.Maps.Map', { callback: GetMap });
    }
    document.addEventListener("DOMContentLoaded", initialize, false);
})();

//This works
function GetMap() {
    var messageDialog = new Windows.UI.Popups.MessageDialog('Maps Loaded!');
    messageDialog.showAsync();
});

//This doesn't work
function Testing() {
    var messageDialog = new Windows.UI.Popups.MessageDialog('Directions Loaded!!');
    messageDialog.showAsync();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T14:41:30.230

首先，确保您使用的是[适用于 Windows 8 的 Bing Maps SDK](http://visualstudiogallery.msdn.microsoft.com/bb764f67-6b2c-4e14-b2d3-17477ae1eaca)。

其次，确保在使用 Maps API 之前加载模块脚本文件。

```
<script src="/Bing.Maps.JavaScript/js/veapicore.js"></script>
<script src="/Bing.Maps.JavaScript/js/veapiModules.js"></script> 
```

第二个脚本标签在这里很重要，因为它可以使用“辅助”模块，如方向。文档中没有很好地指出需要加载 veapiModules.js 才能使这些模块正常工作。

# c# - Unable to open Remote Exchange (2010 and 2013) PSSession from a different domain (WinRM) 错误。请指教？

> ID：14666168
> 
> 赞同：0
> 
> 时间：2013-02-02T20:26:00.140
> 
> 标签：c#, powershell-2.0, exchange-server, powershell-remoting, winrm

我正在尝试打开一个远程交换 PS 会话，但它失败并出现 WinRM 错误。

请注意，我可以打开正常的 PS 会话，但不能使用交换配置。

1.  那么是否可以在启用 PSRemoting 的同一域中的任何机器上管理交换服务器？

2.  是否可以从不同域的机器管理交换服务器？

3.  欢迎任何关于错误的建议？

这是我执行的命令：

```
**Case 1: Failing to open a remote session with exchange configuration.**

PS C:\> $connectionUri="http://{fqdn/powershell?serializationLevel=Full;ExchClientVer=14.3.91.1"

PS C:\> $s = New-PSSession -ConnectionURI $connectionUri -ConfigurationName Microsoft.Exchange
 -SessionOption $so -Credential $c
[fqdn] Connecting to remote server failed with the following error message : The WinRM clie
nt cannot process the request. The WinRM client tried to use Negotiate authentication mechanism, but the destination co
mputer (fqdn:80) returned an 'access denied' error. Change the configuration to allow Negot
iate authentication mechanism to be used or specify one of the authentication mechanisms supported by the server. To us
e Kerberos, specify the local computer name as the remote destination. Also verify that the client computer and the des
tination computer are joined to a domain. To use Basic, specify the local computer name as the remote destination, spec
ify Basic authentication and provide user name and password. Possible authentication mechanisms reported by server: For
 more information, see the about_Remote_Troubleshooting Help topic.
    + CategoryInfo          : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportExc
   eption
    + FullyQualifiedErrorId : PSSessionOpenFailed

Without connectionURL, and with just fqdn:

PS C:\> $s = New-PSSession fqdn -Credential $c -ConfigurationName
Microsoft.Exchange
[fqdn] Connecting to remote server failed with the following error message : The WS-Managem
ent service cannot process the request. The resource URI (__http://schemas.microsoft.com/powershell/Microsoft.Exchange) w
as not found in the WS-Management catalog. The catalog contains the metadata that describes resources, or logical endpo
ints. For more information, see the about_Remote_Troubleshooting Help topic.
    + CategoryInfo          : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportExc
   eption
    + FullyQualifiedErrorId : PSSessionOpenFailed

**Case 2: without exchange configuration, i am able to open the PS session.**

PS C:\> $s = New-PSSession "fqdn" -Credential $c
PS C:\> $s

 Id Name            ComputerName    State    ConfigurationName     Availability
 -- ----            ------------    -----    -----------------     ------------
  1 Session1        xxxxxxxxxxxx       Opened   Microsoft.PowerShell     Available 
```

问候，

梦想家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T06:45:29.823

我不确定您的环境是什么样的，但也许可以尝试这些链接来设置 CAS 进行远程处理

**通过 Internet 为远程 powershell 设置 CAS：http:** [//www.parative.com/Blogs/Exchange/2010/02/exchange-2010-remote-powershell/](http://www.parative.com/Blogs/Exchange/2010/02/exchange-2010-remote-powershell/)

**使用 Powershell 远程管理 Exchange 2010：http:** [//www.mikepfeiffer.net/2010/02/managing-exchange-2010-with-remote-powershell/](http://www.mikepfeiffer.net/2010/02/managing-exchange-2010-with-remote-powershell/)

**使用远程 PowerShell 连接到远程 Exchange 2010 组织：** [http ://www.msexchange.org/blogs/walther/news/connecting-to-a-remote-exchange-2010-organization-using-remote-powershell-429.html](http://www.msexchange.org/blogs/walther/news/connecting-to-a-remote-exchange-2010-organization-using-remote-powershell-429.html)

# c++ - 将指针分配添加到向量后删除

> ID：14666169
> 
> 赞同：2
> 
> 时间：2013-02-02T20:26:02.630
> 
> 标签：c++, vector, allocation

在 C++ 中将对象添加到向量并删除指向该对象的指针后，向量内的对象也会被删除吗？

例如，

```
int i = 0;
std::vector<A> aVect;
while(i++ < 10)
{    
    A *ptrToA = new A();
    aVect.push_back(*ptrToA);
    delete ptrToA;
} 
```

调用是否仍然有效：

```
aVect.at(2); 
```

调用“删除”会破坏添加到向量中的对象，还是只会释放指针的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:34:46.210

Yes you can delete the pointer because, as others have noted you dereference the pointer to it is copied into the vector by value.

It would be more efficient to just construct into the vector like this and avoid new/delete entirely:

```
int i = 0;
while(i++ < 10)
{    
    std::vector<A> aVect;
    aVect.push_back(A());
} 
```

In C++11 a copy will not be made - the rvalue version of push_back will be used - A will be constructed into it's slot in the vector.

You may not want to create a new vector each time???

```
std::vector<A> aVect;
int i = 0;
while(i++ < 10)
{    
    aVect.push_back(A());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:29:03.097

调用 仍然有效`aVect.at(2)`，因为向量持有`*ptrToA`. 当您调用`aVect.push_back(*ptrToA)`时，它`A`使用赋值运算符设置它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:27:49.963

在这里，您将对象的**副本**推送到向量，并且该副本不会被删除。

但是，如果你写：

```
int i = 0;
while(i++ < 10)
{    
    A *ptrToA = new A();
    std::vector<*A> aVect;
    aVect.push_back(ptrToA);
    delete ptrToA;
} 
```

然后你在向量中推送指针，当你删除时，`ptrToA`你也会删除向量中指针指向的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:28:08.050

您已经创建了 A: 类型对象的向量`std::vector<A>`，这意味着当您将一些新对象插入其中时，会创建该新对象的**副本**并将其存储到向量中。

所以是的，即使在新对象被删除之后访问这个元素也是完全安全和有效的。***删除原始对象不会以任何方式影响存储在矢量中的副本。***

这种向量（保存具有自动存储持续时间的对象的向量）的优点是，一旦向量被破坏，存储这些对象的内存就会自动清理。因此，您的代码中不太可能出现一些内存泄漏以及您的工作量减少，因为您不需要自己处理那些丑陋的内存管理:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T20:28:30.057

不，不会的。您`std::vector<A>`存储对象的实例而不是指针。实际上，您在将 A 推入向量时取消引用指针。

这将导致对象的副本（通过 构建`copy constructor`）存储在您的向量中。推送对象后，您有 2 个 A 类实例。`heap`（通过）分配了一个实例`new operator`。另一个实例位于分配的`stack`位置 。`aVect`

另一方面，如果您的向量将存储指针 ( `std::vector<*A>`)，则在删除后`ptrToA`，存储在向量内的指针指向已释放的内存位置（[悬空指针](http://en.wikipedia.org/wiki/Dangling_pointer)）。尝试访问该指针会导致错误，可能是`segfault`.

# java - 如果中间文件夹不存在，则创建中间文件夹

> ID：14666170
> 
> 赞同：50
> 
> 时间：2013-02-02T20:26:15.750
> 
> 标签：java, file

我正在尝试为用户登录的每个用户名创建一个文件夹。目前我有

```
private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
File theFile = new File(destination + username); // will create a sub folder for each user 
```

但该`File theFile`位不会为用户名创建新文件夹。我该怎么做？

我努力了

```
private String destination;

public void File() 
{
    destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
    File theFile = new File(destination + username); // will create a sub folder for each user (currently does not work, below hopefully is a solution) 
    theFile.mkdirs();
} 
```

但我需要稍后在程序中使用目的地，我该怎么做？

这是我的整个代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package richard.fileupload;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import javax.annotation.PostConstruct;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import javax.faces.context.FacesContext;
import java.io.File;
import org.primefaces.event.FileUploadEvent;

@ViewScoped
@ManagedBean(name = "fileUploadController")
public class FileUploadController {

    /*
     public void handleFileUpload(FileUploadEvent event) {
     System.out.println("called");
     FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
     FacesContext.getCurrentInstance().addMessage(null, msg);
     }
     }
     */
    private String username;
    private String destination;

    @PostConstruct
    public void init() {
        System.out.println("called get username");
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
    }

    public void File() {
    destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
    File theFile = new File(destination + username); // will create a sub folder for each user (currently does not work, below hopefully is a solution) 
    theFile.mkdirs();
}

    public File getDirectory(String destination, String username) {
        System.out.println("called get directory");
        // currently not working, is not calling the username or destination 
        //set the user directory from the destinarion and the logged user name
        File directory = new File(destination, username);
        //check if the location exists
        if (!directory.exists()) {
            //let's try to create it
            try {
                directory.mkdir();
            } catch (SecurityException secEx) {
                //handle the exception
                secEx.printStackTrace(System.out);
                directory = null;
            }
        }
        return directory;
    }

    public void handleFileUpload(FileUploadEvent event) {
        System.out.println("called handle file");
        FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded."); //Displays to user on the webpage
        FacesContext.getCurrentInstance().addMessage(null, msg);
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            //handle the exception
            e.printStackTrace();
        }
    }

    public void copyFile(String fileName, InputStream in) {
        try {

            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(destination + fileName)); // cannot find path when adding username atm
            System.out.println("Called CopyFile"); //testing 
            System.out.println(destination + fileName);

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();
//make sure new file is created, (displays in glassfish server console not to end user)
            System.out.println("New file created!");//testing
        } catch (IOException e) {
            e.printStackTrace();

            FacesMessage error = new FacesMessage("The files were not uploaded!");
            FacesContext.getCurrentInstance().addMessage(null, error);
        }
    }
} 
```

最终编辑（希望如此）

```
 public void copyFile(String fileName, InputStream in) {
        try {

            destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
            File theFile = new File(destination + "/" + username); 
            theFile.mkdirs();// will create a sub folder for each user (currently does not work, below hopefully is a solution) (DOES NOW WORK)

            System.out.println("Completed File");
            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(destination + fileName)); // cannot find path when adding username atm
            System.out.println("Called CopyFile"); //testing 
            System.out.println(destination + fileName);

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();
//make sure new file is created, (displays in glassfish server console not to end user)
            System.out.println("New file created!");//testing
        } catch (IOException e) {
            e.printStackTrace();

            FacesMessage error = new FacesMessage("The files were not uploaded!");
            FacesContext.getCurrentInstance().addMessage(null, error);
        }
    }
} 
```

我怎样才能打印出新的目的地并在以后使用它，因为目前它创建了新文件夹但没有选择它来使用

编辑也解决了这个问题：

```
 NewDestination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/" + username; 
```

添加了上面的代码，现在一切正常

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2013-02-02T20:28:35.173

您必须实际调用一些方法来创建目录。仅仅创建一个`file`对象不会在文件系统上创建相应的文件或目录。

您可以使用[`File#mkdirs()`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdirs%28%29)方法创建目录： -

```
theFile.mkdirs(); 
```

[`File#mkdir()`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdir%28%29)和之间的区别在于[`File#mkdirs()`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdirs%28%29)，如果中间目录不存在，后者将创建任何中间目录。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-06-21T05:12:55.390

如果在创建/编辑文件时不存在中间文件夹，请使用此代码尖晶石创建中间文件夹：

```
File outFile = new File("/dir1/dir2/dir3/test.file");
outFile.getParentFile().mkdirs();
outFile.createNewFile(); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-01-06T21:06:12.160

可以在[这里找到来自](https://stackoverflow.com/a/32454807/7037546)[Benoit Blanchon](https://stackoverflow.com/users/1164966/benoit-blanchon)的一个不错的 Java 7+ 答案：

> 在 Java 7 中，您可以使用[`Files.createDirectories()`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#createDirectories(java.nio.file.Path,%20java.nio.file.attribute.FileAttribute...)).
> 
> 例如：

```
Files.createDirectories(Paths.get("/path/to/directory")); 
```

# java - 计算出图像的最大尺寸？

> ID：14666174
> 
> 赞同：3
> 
> 时间：2013-02-02T20:27:22.960
> 
> 标签：java, image, awt

我正在用 Java 创建一个小游戏，并且我有一个旋转的图像。

![在此处输入图像描述](../Images/f9b9f2562ed3b89e51555a90ec266e9d.png)

正如你在下面的两张图片中看到的，有一艘巨船在游戏中缓慢地旋转，但是当它到达某个点时它会被切断（由于它自己的小 BufferedImage）。

这是我的渲染代码：

```
public void drawImageRotated(BufferedImage img, double x, double y, double scale,    double angle) {
        x -= xScroll;
        y -= yScroll;  
        BufferedImage image = new BufferedImage((int)(img.getWidth() * 1.5D), (int)(img.getHeight() * 1.5D), 2);
        Graphics2D g = (Graphics2D)image.getGraphics();
        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g.rotate(Math.toRadians(angle), image.getWidth() / 2, image.getHeight() / 2);
        g.drawImage(img, image.getWidth() / 2 - img.getWidth() / 2, image.getHeight() / 2 - image.getHeight() / 2, null);
        g2d.drawImage(image, (int)(x-image.getWidth()*scale/2), (int)(y-image.getHeight()*scale/2), (int)(image.getWidth()*scale), (int)(image.getHeight()*scale), null);
        g.dispose();      
 } 
```

回到手头的问题，我怎样才能计算出旋转过程中图像的最大 x 和 y 大小，以便补偿缓冲图像的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:48:31.517

> 如何在旋转过程中计算出图像的最大 x 和 y 大小，以便补偿缓冲图像的大小？

```
double sin = Math.abs(Math.sin(angle));
double cos = Math.abs(Math.cos(angle));
int w = image.getWidth();
int h = image.getHeight();
int neww = (int)Math.floor(w*cos+h*sin);
int newh = (int)Math.floor(h*cos+w*sin); 
```

上面的代码取自这个例子：[Java(SWING) working with Rotation](https://stackoverflow.com/questions/3636292/javaswing-working-with-rotation/3636789#3636789)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:49:55.933

如果您有一个围绕其中心旋转的基本矩形图像，则旋转期间的最大宽度和高度将是图像矩形的对角线水平或垂直时。这个对角线距离可以用勾股定理计算，并用于`BufferedImage`.

```
 int size = (int) Math.sqrt((img.getWidth() * img.getWidth()) + (img.getHeight() * img.getHeight()));
    BufferedImage image = new BufferedImage(size, size, 2);
    // The rest of your code as before 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:36:53.477

另一种方法是旋转实际`Graphics`对象，绘制图像并恢复旋转：

```
AffineTransform old = g2d.getTransform();
g2d.rotate(Math.toRadians(angle), x + image.getWidth() / 2, y + image.getWidth() / 2);
g2d.drawImage(image, x, y, null);
g2d.setTransform(old); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:48:45.853

让我们考虑`width`原始图像的宽度、`height`原始高度和`angle`以弧度为单位的旋转角度值。

根据我的计算，旋转图像的大小是这样的：

```
rotatedWidth = Math.cos(angle) * width + Math.sin(angle) * height;
rotatedHeight = Math.sin(angle) * width + Math.cos(angle) * height; 
```

您可能还需要查看[此](https://stackoverflow.com/questions/12165977/java-image-rotation/12166204)线程，因为它可能会有所帮助。

# php - jquery中字符串的连接

> ID：14666175
> 
> 赞同：0
> 
> 时间：2013-02-02T20:27:25.470
> 
> 标签：php, javascript, jquery, html

我有这个片段

```
<script>
function redirect($i){
  $(function(){
    var trans = $('#trans'+$i).html();
    var mileage = $('#mileage'+$i).html();
    var eng = $('#eng'+$i).html();
    var ext = $('#ext'+$i).html();
    var stock = $('#stock'+$i).html();
    var vin = $('#vin'+$i).html();
    var location = $('#location'+$i).html();
    var price = $('#price'+$i).html();
    var photo = $('#photo'+$i).attr('src');
    window.location.href = "details.php?trans="+trans+"&&mileage="+mileage+"&&eng="+eng+"&&ext="+ext+"&&stock="+stock+"&&vin="+vin+"&&location="+location+"&&price=$$"+price+"&&photo="+photo;
  });
</script>

<?php
    include('function.php');
    $Descriptions = Descriptions();
?>
<!--vehicle1--> 
<?php
    for($i=0;$i<sizeof($Descriptions);$i++){
?>

<div class="vehicle-listing alternate">
  <div class="vehicle-title-wrap"><h6><a ><?php $Descriptions[$i]['ad_title']; ?></a></h6></div>
  <div class="vehicle-inner-wrap">
     <div class="vehicle-photo" id="thumb_holder_1">
        <a ><img id="photo"+"<?php echo $i;?>" src="<?php $id=$Descriptions[$i]['id'];$Images = Images($id);  echo $Images[0]['imagepath']; ?>" class="thumbnail lazy-load" width="170px" height="140px" /></a>
     </div>
     <a >
       <div class="click-to-view"   OnClick="redirect(<?php echo $i; ?>)" ></div>
     </a>
     <div class="first-half vehicle-specs container">
        <div class="container"><span class="spec-label">Trans:</span> <span class="spec-data" id="trans"+"<?php echo $i;?>"><?php echo $Descriptions[$i]['trans']; ?></span></div>
        <div class="container"><span class="spec-label">Mileage:</span> <span class="spec-data" id="mileage"+"<?php echo $i;?>" ><?php echo $Descriptions[$i]['mileage']; ?></span></div>
        <div class="container"><span class="spec-label">EXT:</span> <span class="spec-data" id="eng"+"<?php echo $i;?>" ><?php echo $Descriptions[$i]['engine']; ?></span></div>
                    </div>
     <div class="second-half vehicle-specs container">
        <div class="container"><span class="spec-label">Ext Color:</span> <span class="spec-data" id="ext"+"<?php echo $i;?>"><?php echo $Descriptions[$i]['color']; ?></span></div>
        <div class="container"><span class="spec-label">Stock :</span> <span class="spec-data" id="stock"+"<?php echo $i;?>"><?php echo $Descriptions[$i]['stock']; ?></span></div>
         <div class="container"><span class="spec-label">VIN :</span> <span class="spec-data" id="vin"+"<?php echo $i;?>"><?php echo $Descriptions[$i]['vin']; ?></span></div>
      </div>
      <div class="location">
         <span class="lake-worth" >Location:  <span id="location"+"<?php echo $i;?>" ><?php echo $Descriptions[$i]['state']; ?></span></span>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="lake-worth">Price:  $$<span id="price"+"<?php echo $i;?>" >
  <?php echo $Descriptions[$i]['price']; ?></span></span>

       </div>
    </div>
  </div>
  <?php
}
  ?> 
```

问题是重定向后的值未定义。我认为问题在于字符串（jquery 或 html）的连接。因此，重定向中的值是错误的。

*   任何人都可以显示错误在哪里吗？
*   我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:42:03.923

可能还有其他问题，但是通过重新格式化，您可以看到您`}`在第一个`</script>`标签之前缺少 a。

还有这个：

```
window.location.href = "details.php?trans="+trans+"&mileage="+mileage+"&eng="+eng+"&ext="+ext+"&stock="+stock+"&vin="+vin+"&location="+location+"&price=$$"+price+"&photo="+photo; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:46:43.263

```
<?php
  for ($i = 0; $i < sizeof($Descriptions); $i++) {
?>

<div class="vehicle-listing alternate">
  <div class="vehicle-title-wrap">
    <h6><a >
    <?php
      echo $Descriptions[$i]['ad_title']; 
```

没有`echo`，是这个原因吗？

# c# - 列出绑定到 datagridview 的数据并在进度条上提供反馈

> ID：14666182
> 
> 赞同：0
> 
> 时间：2013-02-02T20:27:55.563
> 
> 标签：c#, .net

我正在填充一个datagridview

```
MyDataGridView.DataSource = MyList; 
```

其中 MyList 是一个 List < MyClass > 。现在我希望在填充 datagridview 时填充进度条。我可以做 MyProgessBar.Maximum = MyList.Count，但是如何在每次绘制一行时设置 MyProgressBar 值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T14:07:19.757

这是背景工作者的解决方案......我没有找到其他任何东西，但这适用于我必须做的事情

```
 private void PopulateDataGridView()
    {
        MyProgressBar.Value = 0;
        MyProgressBar.Maximum = MyList.Count;
        MyBackGroundWorker.RunWorkerAsync();
        MyDataGridView.DataSource = MyList;
    } 
```

进而

```
 private void MyBackGroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        while (true)
        {
            MyBackGroundWorker.ReportProgress(MyDataGridView.Rows.Count);
            if (MyDataGridView.Rows.Count == MyProgressBar.Maximum)
            {
                break;
            }
            System.Threading.Thread.Sleep(100);
        }

    }

    private void MyBackGroundWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        MyProgressBar.Value = MyDataGridView.Rows.Count;
    } 
```

# c - C - fread() 到缓冲区索引

> ID：14666185
> 
> 赞同：0
> 
> 时间：2013-02-02T20:28:05.203
> 
> 标签：c, buffer, fread

这是在 C

我想知道是否可以 fread() 到缓冲区的某个索引。

例如：

fread（缓冲区[10]，1,5，文件）

缓冲区[10] = 某事 缓冲区[11] = 某事 ... ... 缓冲区[14] = 某事

这有可能吗？这需要在没有任何额外缓冲区的情况下完成。（严格的内存限制）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:30:01.327

```
fread(buffer+10, 1, 5, file); 
```

应该这样做。我相信您确保计数在缓冲区限制内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:30:49.907

您需要提供指向要存储数据的位置的指针。有两种方法可以做到这一点（但实际上它只是相同的方式，但语法不同）。

1.  使用地址运算符`&`：`&buffer[10]`

2.  要使用指针算术：`buffer + 10`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:30:49.857

fread 的第一个参数是指针。在这种情况下，您可以这样做： fread(buffer+10, 1, 5, file) 您将获得所需的行为。那是因为 buffer+i 是指向数组“buffer”的第 i 个单元的指针。

# python - 使用中间件防止scrapy重复访问网站

> ID：14666197
> 
> 赞同：6
> 
> 时间：2013-02-02T20:28:39.357
> 
> 标签：python, web-crawler, scrapy

我有这样的问题：

[如何在scrapy中根据url过滤重复请求](https://stackoverflow.com/questions/12553117/how-to-filter-duplicate-requests-based-on-url-in-scrapy)

因此，我不希望网站被多次抓取。我调整了中间件并编写了一个打印语句来测试它是否正确分类了已经看到的网站。确实如此。

尽管如此，解析似乎被执行了多次，因为我收到的 json-File 包含双重条目。

```
from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector
from scrapy.item import Item

from crawlspider.items import KickstarterItem

from HTMLParser import HTMLParser

### code for stripping off HTML tags:
class MLStripper(HTMLParser):
    def __init__(self):
        self.reset()
        self.fed = []
    def handle_data(self, d):
        self.fed.append(d)
    def get_data(self):
        return str(''.join(self.fed))

def strip_tags(html):
    s = MLStripper()
    s.feed(html)
    return s.get_data()
###

items = []

class MySpider(CrawlSpider):
    name = 'kickstarter'
    allowed_domains = ['kickstarter.com']
    start_urls = ['http://www.kickstarter.com']

    rules = (
        # Extract links matching 'category.php' (but not matching 'subsection.php')
        # and follow links from them (since no callback means follow=True by default).
        Rule(SgmlLinkExtractor(allow=('discover/categories/comics', ))),

        # Extract links matching 'item.php' and parse them with the spider's method parse_item
        Rule(SgmlLinkExtractor(allow=('projects/', )), callback='parse_item'),
    )

    def parse_item(self, response):
        self.log('Hi, this is an item page! %s' % response.url)

        hxs = HtmlXPathSelector(response)
        item = KickstarterItem()

        item['date'] = hxs.select('//*[@id="about"]/div[2]/ul/li[1]/text()').extract()
        item['projname'] = hxs.select('//*[@id="title"]/a').extract()
        item['projname'] = strip_tags(str(item['projname']))

        item['projauthor'] = hxs.select('//*[@id="name"]')
        item['projauthor'] = item['projauthor'].select('string()').extract()[0]

        item['backers'] = hxs.select('//*[@id="backers_count"]/data').extract()
        item['backers'] = strip_tags(str(item['backers']))

        item['collmoney'] = hxs.select('//*[@id="pledged"]/data').extract()
        item['collmoney'] = strip_tags(str(item['collmoney']))

        item['goalmoney'] = hxs.select('//*[@id="stats"]/h5[2]/text()').extract()
        items.append(item)
        return items 
```

我的 items.py 看起来像这样：

```
# Define here the models for your scraped items
#
# See documentation in:
# http://doc.scrapy.org/topics/items.html

from scrapy.item import Item, Field

class KickstarterItem(Item):
    # define the fields for your item here like:
    date = Field()
    projname = Field()
    projauthor = Field()
    backers = Field()
    collmoney = Field()
    goalmoney = Field()
    pass 
```

我的中间件如下所示：

```
import os

from scrapy.dupefilter import RFPDupeFilter
from scrapy.utils.request import request_fingerprint

class CustomFilter(RFPDupeFilter):
def __getid(self, url):
    mm = url.split("/")[4] #extracts project-id (is a number) from project-URL
    print "_____________", mm
    return mm

def request_seen(self, request):
    fp = self.__getid(request.url)
    self.fingerprints.add(fp)
    if fp in self.fingerprints and fp.isdigit(): # .isdigit() checks wether fp comes from a project ID
        print "______fp is a number (therefore a project-id) and has been encountered before______"
        return True
    if self.file:
        self.file.write(fp + os.linesep) 
```

我将此行添加到 settings.py：

```
DUPEFILTER_CLASS = 'crawlspider.duplicate_filter.CustomFilter' 
```

我使用“scrapy crawl kickstarter -o items.json -t json”调用脚本。然后我从中间件代码中看到了正确的打印语句。关于为什么 json 包含包含相同数据的多个条目的任何评论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-02T17:31:18.343

所以现在这些是删除重复项的三个修改：

我将此添加到settings.py： `ITEM_PIPELINES = ['crawlspider.pipelines.DuplicatesPipeline',]`

让 scrapy 知道我在 pipelines.py 中添加了一个 DuplicatesPipeline 函数：

```
from scrapy import signals
from scrapy.exceptions import DropItem

class DuplicatesPipeline(object):

    def __init__(self):
        self.ids_seen = set()

    def process_item(self, item, spider):
        if item['projname'] in self.ids_seen:
            raise DropItem("Duplicate item found: %s" % item)
        else:
            self.ids_seen.add(item['projname'])
            return item 
```

你不需要调整蜘蛛，也不要使用我之前发布的 dupefilter/middleware 东西。

但是我觉得我的解决方案不会减少通信，因为必须先创建 Item-object，然后才能对其进行评估并可能删除它。但我对此没意见。

（提问者找到的解决方案，移到答案中）

# django - 如何使用 Django Rest Framework 创建多个模型实例？

> ID：14666199
> 
> 赞同：95
> 
> 时间：2013-02-02T20:28:48.363
> 
> 标签：django, django-rest-framework

我想通过一个 API 调用使用 Django Rest Framework 保存和更新多个实例。例如，假设我有一个可以有多个“教师”的“教室”模型。如果我想创建多个教师，然后更新他们所有的教室号码，我会怎么做？我是否必须为每位教师进行 API 调用？

我知道目前我们无法保存嵌套模型，但我想知道我们是否可以在教师级别保存它。谢谢！

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-05-22T16:45:20.370

我知道这是不久前有人问过的，但是我在自己尝试解决这个问题时发现了它。

事实证明，如果您`many=True`在为模型实例化序列化程序类时通过，那么它可以接受多个对象。

这在 django rest 框架文档中提到[这里](http://www.django-rest-framework.org/api-guide/serializers/#dealing-with-multiple-objects)

就我而言，我的观点是这样的：

```
class ThingViewSet(viewsets.ModelViewSet):
    """This view provides list, detail, create, retrieve, update
    and destroy actions for Things."""
    model = Thing
    serializer_class = ThingSerializer 
```

我真的不想写一堆样板来直接控制序列化程序的实例化和 pass `many=True`，所以在我的序列化程序类中，我重写了`__init__`：

```
class ThingSerializer(serializers.ModelSerializer):
    def __init__(self, *args, **kwargs):
        many = kwargs.pop('many', True)
        super(ThingSerializer, self).__init__(many=many, *args, **kwargs)

    class Meta:
        model = Thing
        fields = ('loads', 'of', 'fields', ) 
```

以以下格式将数据发布到此视图的列表 URL：

```
[
    {'loads':'foo','of':'bar','fields':'buzz'},
    {'loads':'fizz','of':'bazz','fields':'errrrm'}
] 
```

使用这些详细信息创建了两个资源。这很好。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2016-10-26T03:37:48.727

我得出了与 Daniel Albarral 类似的结论，但这里有一个更简洁的解决方案：

```
class CreateListModelMixin(object):

    def get_serializer(self, *args, **kwargs):
        """ if an array is passed, set serializer to many """
        if isinstance(kwargs.get('data', {}), list):
            kwargs['many'] = True
        return super(CreateListModelMixin, self).get_serializer(*args, **kwargs) 
```

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2016-11-29T09:44:44.043

这是另一种解决方案，您不需要覆盖您的序列化程序`__init__`方法。只需覆盖您的视图的 (ModelViewSet)`'create'`方法。注意`many=isinstance(request.data,list)`。在这里`many=True`，当您发送要创建的对象数组以及`False`仅发送一个对象时。这样，您可以同时保存项目和列表！

```
from rest_framework import status, viewsets
from rest_framework.response import Response

class ThingViewSet(viewsets.ModelViewSet):

"""This view snippet provides both list and item create functionality."""

    #I took the liberty to change the model to queryset
    queryset = Thing.objects.all()
    serializer_class = ThingSerializer

    def create(self, request, *args, **kwargs):
        serializer = self.get_serializer(data=request.data, many=isinstance(request.data,list))
        serializer.is_valid(raise_exception=True)
        self.perform_create(serializer)
        headers = self.get_success_headers(serializer.data)
        return Response(serializer.data, status=status.HTTP_201_CREATED, headers=headers) 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-03-06T22:12:39.883

我无法完全弄清楚如何让 request.DATA 从字典转换为数组——这限制了我使用 Tom Manterfield 的解决方案的能力。这是我的解决方案：

```
class ThingSerializer(serializers.ModelSerializer):
    def __init__(self, *args, **kwargs):
        many = kwargs.pop('many', True)
        super(ThingSerializer, self).__init__(many=many, *args, **kwargs)

    class Meta:
        model = Thing
        fields = ('loads', 'of', 'fields', )

class ThingViewSet(mixins.CreateModelMixin, viewsets.GenericViewSet ):
    queryset = myModels\
        .Thing\
        .objects\
        .all()
    serializer_class = ThingSerializer

    def create(self, request, *args, **kwargs):
        self.user = request.user
        listOfThings = request.DATA['things']

        serializer = self.get_serializer(data=listOfThings, files=request.FILES, many=True)
        if serializer.is_valid():
            serializer.save()
            headers = self.get_success_headers(serializer.data)
            return Response(serializer.data, status=status.HTTP_201_CREATED,
                            headers=headers)

        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST) 
```

然后我在客户端上运行这个等价物：

```
var things = {    
    "things":[
        {'loads':'foo','of':'bar','fields':'buzz'},
        {'loads':'fizz','of':'bazz','fields':'errrrm'}]
}
thingClientResource.post(things) 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-10-08T15:31:22.593

我认为尊重框架提议架构的最佳方法是创建一个像这样的 mixin：

```
class CreateListModelMixin(object):

    def create(self, request, *args, **kwargs):
        """
            Create a list of model instances if a list is provided or a
            single model instance otherwise.
        """
        data = request.data
        if isinstance(data, list):
            serializer = self.get_serializer(data=request.data, many=True)
        else:
            serializer = self.get_serializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        self.perform_create(serializer)
        headers = self.get_success_headers(serializer.data)
        return Response(serializer.data, status=status.HTTP_201_CREATED,
                    headers=headers) 
```

然后你可以像这样覆盖 ModelViewSet 的 CreateModelMixin ：

```
class <MyModel>ViewSet(CreateListModelMixin, viewsets.ModelViewSet):
    ...
    ... 
```

现在在客户端你可以这样工作：

```
var things = [    
    {'loads':'foo','of':'bar','fields':'buzz'},
    {'loads':'fizz','of':'bazz','fields':'errrrm'}
]
thingClientResource.post(things) 
```

或者

```
var thing = {
    'loads':'foo','of':'bar','fields':'buzz'
}

thingClientResource.post(thing) 
```

编辑：

正如罗杰柯林斯在[他的回应](https://stackoverflow.com/a/40253309/3507146)中建议的那样，覆盖 get_serializer 方法比“创建”更聪明。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-03-14T10:29:49.310

您可以简单地覆盖`get_serializer`APIView 中的方法并传入`many=True`基本`get_serializer`视图，如下所示：

```
class SomeAPIView(CreateAPIView):
    queryset = SomeModel.objects.all()
    serializer_class = SomeSerializer

    def get_serializer(self, instance=None, data=None, many=False, partial=False):
        return super(SomeAPIView, self).get_serializer(instance=instance, data=data, many=True, partial=partial) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-03-14T09:25:48.303

我想出了一个简单的例子`post`

序列化程序.py

```
from rest_framework import serializers
from movie.models import Movie

class MovieSerializer(serializers.ModelSerializer):

    class Meta:
        model = Movie
        fields = [
            'popularity',
            'director',
            'genre',
            'imdb_score',
            'name',
        ] 
```

视图.py

```
from rest_framework.response import Response
from rest_framework import generics
from .serializers import MovieSerializer
from movie.models import Movie
from rest_framework import status
from rest_framework.permissions import IsAuthenticated

class MovieList(generics.ListCreateAPIView):
    queryset = Movie.objects.all().order_by('-id')[:10]
    serializer_class = MovieSerializer
    permission_classes = (IsAuthenticated,)

    def list(self, request):
        queryset = self.get_queryset()
        serializer = MovieSerializer(queryset, many=True)
        return Response(serializer.data)

    def post(self, request, format=None):
        data = request.data
        if isinstance(data, list):  # <- is the main logic
            serializer = self.get_serializer(data=request.data, many=True)
        else:
            serializer = self.get_serializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST) 
```

这些行是多实例的实际逻辑-

```
data = request.data
if isinstance(data, list):  # <- is the main logic
      serializer = self.get_serializer(data=request.data, many=True)
else:
      serializer = self.get_serializer(data=request.data) 
```

[如果您对 many=True 感到困惑，请参阅此](https://stackoverflow.com/questions/51223456/what-does-many-true-do-in-django-rest-framework)

当我们发送数据时，它会在里面`list`有点像这样 -

```
[
    {
        "popularity": 84.0,
        "director": "Stanley Kubrick",
        "genre": [
            1,
            6,
            10
        ],
        "imdb_score": 8.4,
        "name": "2001 : A Space Odyssey"
    },
    {
        "popularity": 84.0,
        "director": "Stanley Kubrick",
        "genre": [
            1,
            6,
            10
        ],
        "imdb_score": 8.4,
        "name": "2001 : A Space Odyssey"
    }
] 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-02-11T14:30:58.457

[Django REST Framework 文档](http://django-rest-framework.org/)中的[通用视图](http://django-rest-framework.org/api-guide/generic-views.html)页面指出[ListCreateAPIView](http://django-rest-framework.org/api-guide/generic-views.html#listcreateapiview)通用视图“用于读写端点以表示模型实例的集合”。

这就是我开始寻找的地方（实际上我会去寻找，因为我们很快也会在我们的项目中需要这个功能）。

另请注意，Generic Views 页面上的[示例](http://django-rest-framework.org/api-guide/generic-views.html#examples)恰好使用`ListCreateAPIView`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-10-24T17:47:41.510

我遇到的最直接的方法：

```
 def post(self, request, *args, **kwargs):
        serializer = ThatSerializer(data=request.data, many=isinstance(request.data, list))
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        else:
            return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST) 
```

# gwt - 如何在 Tomcat 中运行 GWT RPC

> ID：14666206
> 
> 赞同：0
> 
> 时间：2013-02-02T20:29:14.820
> 
> 标签：gwt, tomcat

我有一个运行良好的小应用程序，但在 Tomcat 中运行不正确，我只是将 GWT 的 war 文件夹中的所有文件复制到 Tomcat webapps 文件夹中，当我在 localhost 上运行我的应用程序时，它可以完美启动但是当我尝试制作通过tomcat的RPC调用它给了我这个错误附加

![在此处输入图像描述](../Images/156fd46bcd62a7f2b84e8f0dcdb3da45.png)

任何的想法

谢谢

注意：我的 RPC 服务仅在我在 TOMCAT 中运行时才会产生问题，否则 RPC 工作正常

我的 Web.xml

![在此处输入图像描述](../Images/156fd46bcd62a7f2b84e8f0dcdb3da45.png)

```
 <?xml version="1.0" encoding="UTF-8"?>
       <web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
          http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
          version="2.5"
             xmlns="http://java.sun.com/xml/ns/javaee">

           <!-- Servlets -->

            <servlet>
            <servlet-name>DashBoardServlet</servlet-name>
            <servlet-class>com.dashboard.server.DashBoardServiceImpl</servlet-class>
           </servlet>

           <servlet-mapping>
           <servlet-name>DashBoardServlet</servlet-name>
            <url-pattern>/dashboardsupervisor/DashBoardServlet</url-pattern>
            </servlet-mapping>
             <!-- Default page to serve -->
             <welcome-file-list>
             <welcome-file>DashBoardSupervisor.html</welcome-file>
            </welcome-file-list>

           </web-app> 
```

我的 RPC 服务接口

```
 package com.dashboard.client;

           import java.util.ArrayList;

          @RemoteServiceRelativePath("DashBoardServlet")
           public interface DashBoardService extends RemoteService {

      ArrayList<FoundIntravue> fetchIntraVUE(String first, String second,  String    choice);
        String saveIntraVue(Intravue interVue, ArrayList<Networks> networksList) t   throws Exception;
      String restoreDatabase(Date selectedDate) throws Exception;
        String cleanDatabase() throws Exception;
      String saveDatabase() throws Exception;
     ArrayList<Intravue> fetchIntravuesList();

         } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T12:56:28.603

我不确定这是否是问题的全部，但如果您在 Tomcat 上运行应用程序，则不需要在 GWT 代码服务器上运行代码。我可以在您的地址栏中看到您的网址`?gwt.codesvr=127.0.0.1:9997`。尝试删除它。

**编辑**：
在 Eclipse 中运行应用程序

```
http://127.0.0.1:8888/Project1.html?gwt.codesvr=127.0.0.1:9997 
```

`Project1.html`您要加载的页面在哪里。

在 Tomcat 中，URL 应该是

```
localhost:8080/project 
```

`project`您放在 webapps 目录中的 WAR 文件的名称在哪里。

**最终得到的答案是：**
不要忘记您的库必须位于`war/WEB-INF/lib`. `war`您放在 Tomcat 的 webapps 文件夹中的顶级文件夹在哪里。

# jquery - 即使单击取消，表单也始终提交

> ID：14666212
> 
> 赞同：0
> 
> 时间：2013-02-02T20:29:48.563
> 
> 标签：jquery, html, forms

它转到正确的 if 语句，但无论哪种方式，它总是提交表单。如果陈述属实，我不希望它提交，如果他们按下取消，我也不希望它提交。

我也看到了很多类似的问题，但他们的答案都不是正确的解决方案。

我的表单html：

```
<form action="actual link here" method="POST" target="_blank" onsubmit="ordering()"> 
```

我的js：

```
function ordering() {
    if($('#total').html() == "$0.00") {
        alert("You have not ordered anything. Please use our contact page if you wish to contact us.");
        return false;
    }
    else {
        return window.confirm("Are you sure?");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:47:47.347

为了停止提交事件，您需要指定`return ordering()`如下：

```
<form action="actual link here" method="POST" target="_blank" onsubmit="return ordering()"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:38:17.107

您可以将按钮更改为 div 并将函数附加到它的 onclick 属性：

```
<div id='submitButton' onclick="ordering()"></div> 
```

并对您的功能进行微小的更改：

```
function ordering() {
   if($('#total').html() == "$0.00") {
     alert("You have not ordered anything. Please use our contact page if you wish to contact us.");
    }
    else if(window.confirm("Are you sure?")) {
    $('form').submit();
    }
} 
```

如果您不介意为 div 编写样式以使其看起来像一个按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:59:10.773

由于您已经在使用 jQuery，因此您不必在页面上添加内联 'onsubmit=....' javascript，只需使用以下代码：

给表单一个 ID（或一个类），以便于使用 jQuery 选择它；

```
<form id='myform' action="actual link here" method="POST" target="_blank">

<script>
$(document).ready(function () {

    $('#myform').on('submit', function(e) {
        if($('#total').html() == "$0.00") {
                e.preventDefault();
            alert("You have not ordered anything. Please use our contact page if you wish to contact us.");
            return false;
        } else {
            return window.confirm("Are you sure?");
        }
    }
});
</script> 
```

# java - 从 Java 字节中提取半字节

> ID：14666214
> 
> 赞同：1
> 
> 时间：2013-02-02T20:30:08.923
> 
> 标签：java, serial-port

```
Hex:[0A][52][08][01][01][01][00][CD][21][02][59]

0      [0A]
1      [52]         Packettype    = TEMP_HUM
2      [08]         subtype       = TH8 - 
3      [01]         Sequence nbr  = 1
4/5    [01][01]     ID            = 257
6/7    [00][CD]     Temperature   = 20.5 °C
8      [21]         Humidity      = 33
9      [02]         Status        = Dry
10     [5] *nibble           Signal level  = 5
11     [9] *nibble           Battery       = OK 
```

所以我通过串行端口获得了 11 个字节（十六进制）。我将所有字节分配给一个字节数组，以便以后可以使用它们。

我有两个问题：

1] 如何在 Java 中将 4 和 5 个字节重新组合在一起（我假设是 INT）？2]如何提取最后一个字节的 10 和 11 或高和低半字节？

[来自下面的评论] 示例字节：高 [0101] [0110] 低低低字节 = yourbyte & 0x0f; 01010110 & 0x0f (00001111) = 00000110

```
 highNibble = yourByte >>>> 4
           01010110 >>> 4 = 00000101

          IF you use this Example Byte: High[1101][0110]Low
          highNibble = yourByte >>> 4
          11010110 >>> 4 = 00000101
          Because >>> removes the signed bit. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:39:05.463

1）这取决于字节序。它将是`(b[4] << 8) | b[5]`或`(b[5] << 8) | b[4]`

2)`lowNibble = yourByte & 0x0f; highNibble = (yourByte >> 4) & 0x0f;`

你也可以这样做：`lowNibble = yourByte & 0x0f; highNibble = yourByte >>> 4;`

无符号移位 ( `>>>`) 用零填充高位，与符号无关。

# android - 带有 WebView 的 ViewPager 中的 ProgressBar

> ID：14666217
> 
> 赞同：2
> 
> 时间：2013-02-02T20:30:13.580
> 
> 标签：android, webview, progress-bar, android-viewpager

我在 ViewPager（v4 支持）中有一个 webview，我想在应用加载时放置一个进度条。这是我到目前为止所拥有的，但它不起作用。基本上我让它指向我的 WebVIew 布局文件中的进度条，但它没有加载任何东西......？

```
 private class MyPagerAdapter extends PagerAdapter {
        public int getCount() {
           return 3;
        }
        public Object instantiateItem(View collection, int position) {
            LayoutInflater inflater = (LayoutInflater)     collection.getContext()
               .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
           int resId = 0;
           switch (position) {
        case 0:
            resId = R.layout.web_view;
                        break;
        case 1:
            resId = R.layout.media;
            break;
         case 2:
            resId = R.layout.youtube;
             break;

         }
         View view = inflater.inflate(resId, null);
        ((ViewPager) collection).addView(view, 0);
         web = (WebView) findViewById(R.id.web_view);
         final ProgressBar bar = (ProgressBar)     findViewById(R.id.loading);

         web.loadUrl(url);
         web.getSettings().setJavaScriptEnabled(true);

            web.setWebViewClient(new WebViewClient () {

            @Override
            public void onLoadResource(WebView view,      String url) {
                // TODO Auto-generated method stub
                web.loadUrl("javascript:var element =     document.getElementById('social-tabs'); element.parentElement.removeChild(element);");
            web.loadUrl("javascript:var element = document.getElementById('omc-top-banner'); element.parentElement.removeChild(element);");
            web.loadUrl("javascript:var element = document.getElementById('simplereach-   slide-element'); element.parentElement.removeChild(element);");

                            }

        @Override
        public void onPageStarted(WebView view, String  url,    
                Bitmap favicon) {
            // TODO Auto-generated method stub
            bar.setVisibility(View.VISIBLE);

                            }

        @Override
        public void onPageFinished(WebView view, String url) {
            // TODO Auto-generated method stub
            bar.setVisibility(View.GONE);

            }

           });

         return view;
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:00:34.017

您需要在 webview 客户端中实现 onProgressChanged 方法以适当地更新进度条：

```
 final Activity MyActivity = this;

      web.setWebViewClient(new WebViewClient () {

            .
            .
            .
            public void onProgressChanged(WebView view, int progress) {

                                MyActivity.setProgress(progress * 100);

                                ProgressBar pb = (ProgressBar) findViewById(R.id.progressBar2);

//pb is equivalent to your "bar" progress bar variable

                                pb.setVisibility(View.VISIBLE);
                                pb.setProgress(progress);
                                if (progress == 100) {
                                    pb.setVisibility(View.GONE);

                                }
            }
        } 
```

# php - 如何拆分日期时间戳的时间部分？

> ID：14666218
> 
> 赞同：0
> 
> 时间：2013-02-02T20:30:21.357
> 
> 标签：php, mysql, datetime

是否可以将日期时间字符串的时间部分拆分为小时、分钟和秒，以便每个字段都有一个数值？理想情况下从 mysql 数据库中检索。

我在网站上查看过，似乎有很多关于如何分割日期和时间部分的建议，但没有关于我的具体问题的建议。提前谢谢了。

PS 我将使用 PHP 从 mysql 数据库中选择日期时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:33:59.203

如果要直接在 sql 中执行此操作：

```
SELECT HOUR( timestamp_field ) AS HOUR, 
       MINUTE( timestamp_field ) AS MINUTE, 
       SECOND( timestamp_field ) AS SECOND
FROM some_table 
```

或者，如果您想在执行查询后在 php 中执行此操作

```
$datetime = "1997-12-31 23:59:59";
$parsed = date_parse($datetime); 
```

看起来像

```
Array
(
[year] => 1997
[month] => 12
[day] => 31 
[hour] => 23
[minute] => 59
[second] => 59
[fraction] => 0.5
[warning_count] => 0
[warnings] => Array()
[error_count] => 0
[errors] => Array()
[is_localtime] => 
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:35:13.283

怎么样：

```
<?php
$timestamp = 1359837241;
$hour = date('H', $timestamp);
$minute = date('i', $timestamp);
$second = date('s', $timestamp);
echo $hour . '<br>';
echo $minute . '<br>';
echo $second . '<br>';
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:38:25.700

使用打击代码，您可以将 DateTime 转换为 TimeStamp

```
$date = new DateTime("1897-04-21 22:55:19");
$TimeStamp=$date->getTimestamp(); 
```

并且使用**date()**函数，您可以将时间戳拆分为年、分、秒

```
echo date("H",$TimeStamp);
.
.
. 
```

有关更多信息，请参阅[日期（）](http://www.php.net/manual/en/function.date.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:47:10.283

如果我正确理解了您的问题，那么应该这样做：

```
<?php
    $timeStamp = '2012-10-23 13:35:20';
    $timeStampSplode = explode( ' ', $timeStamp );

    $head = $timeStampSplode[0];
    $tail = $timeStampSplode[1];

    $headSplode = explode( '-', $head );
    $tailSplode = explode( ':', $tail );

    $year = $headSplode[0];
    $month = $headSplode[1];
    $date = $headSplode[2];

    $hour = $tailSplode[0];
    $minute = $tailSplode[1];
    $second = $tailSplode[2];

    echo "Year: ". $year. "<br />";
    echo "month: ". $month. "<br />";
    echo "date: ". $date. "<br />";
    echo "hour: ". $hour. "<br />";
    echo "minute: ". $minute. "<br />";
    echo "second: ". $second. "<br />";
?> 
```

并且使用 $timeStamp 作为从数据库中获取的值是没有问题的。

# c++ - 为什么具有“相同签名”的模板和非模板函数重载调用非模板函数？

> ID：14666219
> 
> 赞同：21
> 
> 时间：2013-02-02T20:30:29.377
> 
> 标签：c++, templates, c++11, overloading

我有这个代码：

```
template<
    class T = const int &
> void f(T) {}

void f(const int &) {}

int main() {
   f(0);
} 
```

为什么它调用第二个而不是第一个？我会认为它们是相同的，但它们显然不是，因为我没有收到重新定义错误。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-02T20:34:08.003

因为第二个重载不是模板。

当模板函数和非模板函数都可用于解析函数调用时，选择非模板函数。

来自 C++ 11 标准的第 13.3.3/1 段：

> [...] 鉴于这些定义，如果对于所有参数 i，ICSi(F1) 不是比 ICSi(F2) 更差的转换序列，则可行函数 F1 被定义为比另一个可行函数 F2**更好的函数，****然后 [ ...] F1 是一个非模板函数，F2 是一个函数模板特化**[...]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-02T20:35:12.027

一个是模板，另一个不是，它们绝对不一样。

重载解决方案旨在优先使用非模板而不是模板化函数，其他一切都相同。

# asp.net-mvc - 当目标是在视图中显示此图像时，我应该在模型中使用哪种图像？

> ID：14666224
> 
> 赞同：3
> 
> 时间：2013-02-02T20:31:39.077
> 
> 标签：asp.net-mvc, entity-framework, razor

我处于将图像作为字节数组存储在 SQL 数据库中的情况。我正在使用 EF，因此我的模型中有一个字节数组自动属性，然后首先通过代码将其提交到数据库。

我想将一个只读属性（即 Image）放入我的模型中，并在调用 get 访问器时将字节数组转换为 Image。两个问题：

1.  我应该使用什么样的图像？它应该是 System.Drawing 图像还是更新的 BitmapImage？
2.  这会在代码优先和 EF 方面引起任何问题吗？

如果您愿意，我可以发布代码，但我认为没有必要，如果有人想查看我的代码，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:53:10.550

> 1）我应该使用什么样的图像？它应该是 System.Drawing 图像还是更新的 BitmapImage？

他们都没有。您应该使用字节数组 ( `byte[]`)。

> 2) 这会导致代码优先和 EF 方面的任何问题吗？

我不这么认为。我不是 EF 专家，但我认为应该可以将`byte[]`属性映射到数据库中的相应`varbinary(max)`列。

现在回到关于在视图模型上显示图像和拥有属性的原始问题。即使您这样做，您也无法将此字节数组属性显示为视图内的图像，除非您使用[`data uri scheme`](http://en.wikipedia.org/wiki/Data_URI_scheme)并非所有浏览器都广泛支持的。如果您决定走这条路，这可能会是这样的：

```
@model MyViewModel
...
<img src="data:image/png;base64,@Html.Raw(Convert.ToBase64String(Model.Image))" alt="some image"> 
```

但是，如果您正在寻找一种可以在所有浏览器上运行的解决方案作为替代方案，您可以设计一个控制器操作，该操作将从数据库中获取您的图像作为字节数组，然后将其流式传输到响应中。`<img>`接下来，从您的角度来看，您可以在标签内引用此操作。

举个例子：

```
public ActionResult Image(int id)
{
    byte[] imageData = ... go query your database to retrieve the corresponding
                           image record using the id
    return File(imageData, "image/png");
} 
```

然后在您的主视图中只需将`<img>`标签指向此控制器操作：

```
@model MyViewModel
...
<img src="@Url.Action("Image", "SomeController", new { id = Model.Id })"> 
```

# php - 如何使用 JS 和/或 PHP 遍历 INI 文件？

> ID：14666230
> 
> 赞同：0
> 
> 时间：2013-02-02T20:32:29.827
> 
> 标签：php, javascript, jquery, ini

我需要帮助开发可以循环通过 INI 注释、部分、设置及其值的 JS 代码（或 PHP，如果它更容易和更高效）。

例如，这是我的 PHP：

```
<?php 
$ini_array = parse_ini_file("sample.ini", true);
print_r(json_encode($ini_array));
?> 
```

这是我的 PHP 输出的 JSON：

```
{"HEADINGONE":{"settingone":"hello","settingtwo":"world"},"HEADINGTWO":{"settingthree":"hi","settingfour":"again"}} 
```

正在解析这个 INI 文件：

```
[HEADING ONE]
settingone=hello
settingtwo=world 

[HEADING TWO]
settingthree=hi
settingfour=again 
```

这是我的 JS：

```
$.getJSON('index.php', function (data) {
 $.each(data, function (i,item) {
  alert(i);
 });
}); 
```

到目前为止，我的网页提醒“标题一”和“标题二”，但我怎样才能让它读取文件的其余部分？

所以我可以提醒“HEADING ONE”、“settingone”、“hello”、“HEADING TWO”等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:02:46.397

试试这个：

```
$.getJSON('index.php', function (data) {
 $.each(data, function (i,item) {
   $.each(item, function (settingName, settingValue) {
      alert('setting: ' + settingName + ', value: ' + settingValue);
   });
 });
}); 
```

# meteor - 安全的流星管理功能

> ID：14666232
> 
> 赞同：1
> 
> 时间：2013-02-02T20:32:47.207
> 
> 标签：meteor

我有几个要添加到流星站点的管理功能，并且正在徘徊创建，隐藏和保护它们的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:42:34.543

您可以使用[Meteor.methods](http://docs.meteor.com/#meteor_methods)。只需确保仅将它们包含在服务器上，方法是将代码放在名为`server/`Eg的文件夹中

`server/admin.js`

```
Meteor.methods({
  foo: function (arg1, arg2) {
    // confirm that the user is an admin
    if ( ! this.user.isAdmin )
      throw new Meteor.Error(401, "You are not authorized to perform this action");
    // perform task
    return "some return value";
  }
}); 
```

# php - Insert with variable number of items - nested foreach

> ID：14666237
> 
> 赞同：0
> 
> 时间：2013-02-02T20:33:21.130
> 
> 标签：php, mysql, database

I'm not sure how to go about this. I have a nested foreach that I'm attempting to build an insert query from.

```
preg_match_all('/...../', $text, $matches);
foreach ($foo[0] as $bar){
$item1 = $bar
preg_match_all('/..'/, $bar, $result){
foreach($result[0] as $link){
something here
}
$insertstuff = "insert ignore into table (field1, field1) values (value1, value2)..etc
mysql_query($insertstuff, $con);
} 
```

So here is my question. There will be anywhere from 0 - 10 links returned in the nested foreach. How do I build the query to take those links and insert them into the respective column, ie link1, link2 --> link10\. This is just a barebones example, I just am not sure how to structure the query to take into account the unknown number of things to insert.

To update: I have it working but i'm not sure if it's the most efficient.

```
$i=1;
foreach ($result[0] as $link) {
if ($i=1)
{$link1 = $link;}
elseif ($i=2)
{$link2 = $link;}                     
elseif ($i=3)
{$link3 = $link;}
etc down to 10\. 
$i++;
} 
```

Thank you

# php - Use custom info box on google maps api

> ID：14666238
> 
> 赞同：0
> 
> 时间：2013-02-02T20:33:27.833
> 
> 标签：php, javascript, google-maps

I have been following a tutorial to set up a google map for my website [here](https://developers.google.com/maps/articles/phpsqlajax_v3) and I have completed this, however I now want a custom info box that pops up when you click the icon. (at the moment it pops up with googles default)

I was trying to use [this](http://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/docs/examples.html) code to do it, but every time I try none of the icons appear.

```
 <script type="text/javascript">
//<![CDATA[

var customIcons = {
  restaurant: {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_blue.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  },
  bar: {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_red.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  }
};

  var labelText = "City Hall";

    var myOptions = {
             content: labelText
            ,boxStyle: {
               border: "1px solid black"
              ,textAlign: "center"
              ,fontSize: "8pt"
              ,width: "50px"
             }
            ,disableAutoPan: true
            ,pixelOffset: new google.maps.Size(-25, 0)
            ,position: new google.maps.LatLng(49.47216, -123.76307)
            ,closeBoxURL: ""
            ,isHidden: false
            ,pane: "mapPane"
            ,enableEventPropagation: true
    };

function load() {
  var map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(47.6145, -122.3418),
    zoom: 13,
    mapTypeId: 'roadmap'
  }); 
```

This is the part that im changing at the moment

```
 var infoWindow = new google.maps.InfoWindow; 
```

to this

```
 var infoWindow = new infoBox(myOptions); 
```

.

```
 // Change this depending on the name of your PHP file
  downloadUrl("phpsqlajax_genxml.php", function(data) {
    var xml = data.responseXML;
    var markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
      var name = markers[i].getAttribute("name");
      var address = markers[i].getAttribute("address");
      var type = markers[i].getAttribute("type");
      var point = new google.maps.LatLng(
          parseFloat(markers[i].getAttribute("lat")),
          parseFloat(markers[i].getAttribute("lng")));
      var html = "<b>" + name + "</b> <br/>" + address;
      var icon = customIcons[type] || {};
      var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: icon.icon,
        shadow: icon.shadow
      });
      bindInfoWindow(marker, map, infoWindow, html);
    }
  });
}

function bindInfoWindow(marker, map, infoWindow, html) {
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(html);
    infoWindow.open(map, marker);
  });
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
}

function doNothing() {}

//]]>

</script> 
```

Any help to say where i'm going wrong would be appreciated

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:03:54.590

假设您已经包含了 infobox-library 并且 php-file 返回了预期的 XML，除了以下内容没有任何问题：

```
var infoWindow = new infoBox(myOptions); 
```

它一定要是：

```
var infoWindow = new InfoBox(myOptions);
//-------------------^ 
```

# javascript - AJAX - Cross-domain connection to XML files in another server which I don't control?

> ID：14666242
> 
> 赞同：0
> 
> 时间：2013-02-02T20:33:50.657
> 
> 标签：javascript, ajax, cross-domain

> **Possible Duplicate:**
> [Ways to circumvent the same-origin policy](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)

I want to connect to another domain using AJAX. The problems are:

*   I don't control that server, so I can't use Cross-origin resource sharing
*   The server's response is not JSON (is XML), so I can't use JSONP

Currently I use AJAX to connect to a php file in my server which uses `file_get_contents` to get those XML files from the other server.

And it works well, but it would be nice if I could handle all connection using only JavaScript. Can I?

# busy-waiting - 使用一对标志实现忙等待

> ID：14666245
> 
> 赞同：0
> 
> 时间：2013-02-02T20:34:01.403
> 
> 标签：busy-waiting

我正在尝试使用 2 个标志来实现繁忙的等待机制。我遇到了僵局，但就是不明白为什么......在我看来它应该可以工作......

抱歉，代码很长，这是我成功完成的最短时间。

```
package pckg1;

public class MainClass {

public static void main(String[] args) {
    Buffer b = new Buffer();
    Producer prod = new Producer(b);
    Consumer cons = new Consumer(b);

    cons.start();
    prod.start();
}
}

class Producer extends Thread {
private Buffer buffer;

public Producer(Buffer buffer1) {
    buffer = buffer1;
}

public void run() {
    for (int i = 0; i < 60; i++) {
        while (!buffer.canUpdate)
            ;
        buffer.updateX();
        buffer.canUpdate = false;
        buffer.canUse = true;
    }
}
}

class Consumer extends Thread {
private Buffer buffer;

public Consumer(Buffer buffer1) {
    buffer = buffer1;
}

public void run() {
    for (int i = 0; i < 60; i++) {
        while (!buffer.canUse)
            ;
        buffer.consumeX();
        buffer.canUse = false;
        buffer.canUpdate = true;
    }
}
}

class Buffer {
private int x;
public boolean canUpdate;
public boolean canUse;

public Buffer() {
    x = 0;
    canUpdate = true;
}

public void updateX() {
    x++;
    System.out.println("updated to " + x);

}

public void consumeX() {
    System.out.println("used " + x);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:43:03.643

我建议所有相关的逻辑`Buffer`都应该放在那个类中。

此外，访问（和修改）标志必须受到保护，如果 2 或更多可以访问它。这就是为什么我`synchronised`采用这两种方法的原因。

```
class Buffer {
private int x;
private boolean canUpdate;
private boolean canUse;

public Buffer() {
    x = 0;
    canUpdate = true;
}

public synchronised void updateX() {
    x++;
    System.out.println("updated to " + x);
    canUpdate = false;
    canUse = true;
}

public synchronised void consumeX() {
    System.out.println("used " + x);
    canUpdate = true;
    canUse = false;
}

    public synchronised boolean canUse() {
        return canUse;
    }
    public synchronised boolean canUpdate() {
        return canUpdate;
    }
} 
```

此外，从and类中删除`canUpdate`和`canUse`写入，并用方法替换读取（在条件中）。`Producer``Consumer`

`Thread.sleep(100)`此外，在等待循环中引入一些也会很有用。

# button - 如何在 J2ME 应用程序的表单上创建按钮？

> ID：14666248
> 
> 赞同：2
> 
> 时间：2013-02-02T20:34:20.177
> 
> 标签：button, java-me, midp, lcdui

我尝试制作一个简单的“hello world”应用程序，在单击按钮时，它会打印一个字符串“hello world”。如何在表单上添加按钮？

我需要创建一个按钮，当我单击它时可以生成一个字符串。如何在 j2me 中不使用画布添加按钮？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:04:25.357

从我在一本旧的 J2ME 书中找到的类图（在线[http://www.stardeveloper.com/articles/display.html?article=2002121101&page=2](http://www.stardeveloper.com/articles/display.html?article=2002121101&page=2) ）看来 J2ME 不做按钮。好吧，在旧手机上不需要它们。

只需创建一个“hello”命令并将其添加到菜单或表单中。然后系统会将其放在您设备上可用的任何按钮上。对于触摸屏设备，可能会将其变成可点击的东西。

这是代码

```
import javax.microedition.lcdui.Command;
import javax.microedition.lcdui.CommandListener;
import javax.microedition.lcdui.Display;
import javax.microedition.lcdui.Displayable;
import javax.microedition.lcdui.Form;
import javax.microedition.lcdui.TextBox;
import javax.microedition.lcdui.TextField;
import javax.microedition.midlet.MIDlet;
import javax.microedition.midlet.MIDletStateChangeException;

public class HelloWorld extends MIDlet implements CommandListener {

    private static final String HELLO_WORLD = "Hello, World!!";

    private Form form= new Form ("");

    private Command exit= new Command("Exit", Command.EXIT, 0x01);
    private Command ok= new Command("OK", Command.OK, 0x01);
    private Command hello= new Command("HELLO", Command.SCREEN, 0x01);

    private TextBox textBox= new TextBox("Hello World", HELLO_WORLD, HELLO_WORLD.length(), TextField.UNEDITABLE);

    public HelloWorld() {
        this.form.addCommand(exit);
        this.form.addCommand(hello);
        this.form.setCommandListener(this);
        this.textBox.addCommand(ok);
        this.textBox.addCommand(exit);
        this.textBox.setCommandListener(this);
    }

    protected void destroyApp(boolean unconditional)
            throws MIDletStateChangeException { }

    protected void pauseApp() { }

    protected void startApp() throws MIDletStateChangeException {
        Display.getDisplay(this).setCurrent(this.form);
    }

    public void commandAction(Command c, Displayable d) {
        if (c == this.exit) {
            this.notifyDestroyed();
        }
        if(c == this.ok) {
            Display.getDisplay(this).setCurrent(this.form);         
        }
        if(c == this.hello) {
            Display.getDisplay(this).setCurrent(this.textBox);          
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T22:31:51.650

对此有一个 API，但您最好三思而后行是否真的需要它。

API 在[lcdui 项目对象的外观模式部分中进行了描述](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Item.html#appearance)

> StringItem 和 ImageItem 类具有可在其构造函数中设置的外观模式属性。此属性可以具有值 PLAIN、HYPERLINK 或 BUTTON 之一。PLAIN 的外观模式通常用于文本或图形材料的非交互式显示。外观模式值对项目的交互性没有任何副作用。为了具有交互性，该项目必须具有一个或多个命令（最好分配一个默认命令），并且它必须具有接收命令调用通知的 CommandListener...
> 
> BUTTON 模式下的**StringItem 或 ImageItem 可用于创建基于按钮的用户界面**...

请注意，本节还解释了使用按钮外观可能有问题的情况：

> ...这很容易导致应用程序使用不便。例如，在基于遍历的系统中，用户必须先导航到一个按钮，然后才能调用其上的任何命令。如果按钮分布在长表单中，用户可能需要执行大量导航才能发现所有可用命令。此外，从表单另一端的按钮调用命令可能非常麻烦。基于遍历的系统通常提供一种从任何地方（例如从菜单）调用命令的方法，而无需遍历特定项目。与其将命令添加到按钮并将该按钮放入表单中，不如将该命令直接添加到表单中对用户来说更合适和方便。

# javascript - Fancybox iframe popup when site is loaded via another domain using iframe

> ID：14666250
> 
> 赞同：0
> 
> 时间：2013-02-02T20:34:28.233
> 
> 标签：javascript, jquery, iframe, fancybox, fancybox-2

I have a member-site that is operational.

That sites uses fancybox iframe "pop-up" and all works well. Now I want to allow webmasters to connect to member area via iframe and everything works well, but I am just curious if I can make fancybox popup overlay to go all over the browser instead of just "iframe" on user-domain....

To make it more clear my site resides on www.MyScriptDomain.com and there, when fancybox popup is triggered - overlay covers entire browser viewport.

Now if on www.SomeOtherDomain.com my member site is called via iframe like this:

```
<iframe name="inlineframe" src="http://MyScriptDomain.com/index.php" frameborder="0" scrolling="auto" width="980" height="500"></iframe> 
```

when fancybox popup is triggered overlay pop out, but it covers only area of 980px / 500px, so is there a way to make nice integration, so it will actually cover entire browser viewport ?

# ruby-on-rails - Ruby on Rails - Need help associating models

> ID：14666253
> 
> 赞同：0
> 
> 时间：2013-02-02T20:34:44.133
> 
> 标签：ruby-on-rails, model-associations, rails-models

Ok, am still a newbie in ruby on rails trying to learn my way around. I have two models (User model and Comment model). Basically a user has a simple profile with an 'about me' section and a photo's section on the same page. Users must be signed in to comment on other users profiles.

My User Model

```
 class User < ActiveRecord::Base
        attr_accessible :email, :name, :username, :gender, :password, :password_confirmation
        has_secure_password
        has_many :comments
        .
        .
    end 
```

My Comment Model

```
 class Comment < ActiveRecord::Base
       belongs_to :user
       attr_accessible :content
       .
       .
     end 
```

In my comments table, I have a `user_id` column that stores the id of the user whose profile has been commented on and a `commenter_id` column that stores the id of the user commenting on the profile.

Comment Form

```
 <%= form_for([@user, @user.comments.build]) do |f| %>
      <%= f.text_area :content, cols: "45", rows: "3", class: "btn-block comment-box" %>
      <%= f.submit "Comment", class: "btn" %>
    <% end %> 
```

My comments Controller

```
 class CommentsController < ApplicationController
        def create
           @user = User.find(params[:user_id])
           @comment = @user.comments.build(params[:comment])
           @comment.commenter_id = current_user.id
           if @comment.save
             ......... 
           else
             .........
           end      
        end  
    end 
```

This works fine storing both `user_id` and `commenter_id` in the database. My problem comes when displaying the user comments on the show page. I want to get the name of the user who commented on a specific profile.

In my user controller

```
 def show
        @user = User.find(params[:id])
        @comments = @user.comments
      end 
```

I want to get the name of the user from the `commenter_id` but it keeps throwing errors `undefined method 'commenter' for #<Comment:0x007f32b8c37430>` when I try something like `comment.commenter.name`. However, `comment.user.name` works fine but it doesn't return what I want. Am guessing am not getting the associations right.

I need help getting the correct associations in the models so as to get the name from the commenter_id.

My last question, how do I catch errors in the comments form? Its not the usual `form_for(@user)` where you do like `@user.errors.any?`.

routes.rb

```
 resources :users do
         resources :comments, only: [:create, :destroy]
      end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:58:10.823

在你的模型中尝试这样的事情

```
class User < ActiveRecord::Base
  has_many :received_comments, :class_name => "Comment", :foreign_key => "user_id"
  has_many :given_comments, :class_name => "Comment", :foreign_key => "commenter_id"
end

class Comment < ActiveRecord::Base
  belongs_to :user # comment about profile
  belongs_to :commenter, :class_name => "User", :foreign_key => "commenter_id"
end 
```

退房： http: [//guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

你可能会在 has_many 集合上想出更好的命名，收到和给出是我能在短时间内做的最好的：)

注意：在许多情况下，foreign_key 是选项，将其留在上面 - 我认为它有助于清晰

*   has_many fk 引用 many 表（其他表）中的列
*   belongs_to fk 指的是 many 表（这个表）中的列

# visual-studio - Visual Studio 编辑器分类器覆盖

> ID：14666255
> 
> 赞同：0
> 
> 时间：2013-02-02T20:34:47.317
> 
> 标签：visual-studio, visual-studio-2012, visual-studio-extensions

我在 VS2012 中工作，我正在创建一个新的编辑器分类器。基本上，我对微软的 Typescript 语法高亮感到非常失望，所以我想添加它。但我很难覆盖他们的默认颜色。我可以覆盖某些关键字颜色（如`public`or `var`），但不能覆盖其他颜色（如`this`or `static`）。

您应该能够调整它的方式是通过`Order`导出类的属性。

```
[Order(Before = Priority.High)]
internal sealed class ETS_Keyword : ClassificationFormatDefinition { ... } 
```

您可以包含两个订单属性（`Before`和`After`）和三个优先级（`Default`和`Low`）`High`。我发誓我已经尝试过它们的每一种组合，但我似乎无法覆盖某些关键字（可能还有其他类别的项目）的默认颜色。

我需要做一些特别的事情来覆盖这些类吗？我知道我正在与默认的 Typescript 扩展作斗争，但必须有一种方法可以达到更高的优先级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:19:16.160

哇，我最诚挚的道歉。我不敢相信，但这个问题与优先级没有任何关系。事实证明，我正在编辑我的正则表达式以匹配新关键字，但 Visual Studio 在 Experimental Hive 中调试之前没有重新编译我的项目（与我的 VS2008 和 VS2010 安装不同）。

所以我想如果您遇到这个问题，请尝试正确使用您的 IDE。：/

# c - 尝试将浮点数读入数组时，scanf 崩溃

> ID：14666263
> 
> 赞同：1
> 
> 时间：2013-02-02T20:35:14.520
> 
> 标签：c, crash, scanf

这是我的代码：

```
double values[8], cumulative[8];

printf("Enter first decimal number: ");
scanf("%f", values[0]);
printf("values[0] = %g", values[0]); 
```

我的问题是 scanf 语句使程序崩溃，第二个 printf 永远不会执行。我最初的尝试是用双精度填充数组的每个插槽，但由于这不起作用，我将程序简化为这个，但这也不起作用。

我是学习C的初学者，所以我可能犯了一个我看不到的愚蠢错误。任何帮助将不胜感激，谢谢！

**编辑：**

好的，显然我需要在 scanf 语句中添加一个 & 符号。但我认为数组只是指向数组第一个元素的指针？为什么我必须使用 & 符号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:36:31.803

`scanf("%f", values[0]);`- 这里第一个元素的地址应该传递给scanf。您正在传递第一个元素的值，这是一个垃圾值，因此它崩溃了。

`values[0]`是`*(values + 0)`，所以这将给出第一个元素的值而不是第一个元素的地址。

做`scanf("%lf", &values[0]);`或`scanf("%lf", (values + 0));`或`scanf("%lf", values);`

因为它是`double`使用`%lf`而不是`%f`.

程序中的另一个问题是未初始化的变量。尝试在声明时将变量初始化为零。

```
double values[8] = {0};
double cumulative[8] = {0}; 
```

如果在代码的某个位置访问一些错误的指针，如果它初始化为零，将导致 100% 崩溃。否则它将尝试访问一些会导致内存损坏的垃圾值指针，这有时不会崩溃，而是会给出意外的输出。但这也有 50% 的几率发生崩溃，而您现在正在遇到这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:37:40.053

```
scanf("%f", values[0]); 
```

您需要将要存储的位置的*地址*`scanf()`传递给. 它需要是：

```
scanf("%f", &values[0]); 
```

否则，您只是告诉`scanf()`将输入值存储到初始化值的整数表示所指向的任何内存位置`values[0]`——这绝对不是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:38:03.950

扫描 a 的格式`double`是`%lf`; `%f`是为`float`。这与让人们感到困惑的 不同`printf()`——我也是。您还需要将指针传递给变量。

如果您使用 GCC，它应该会警告您格式不匹配。如果没有，则说明您没有启用足够的警告选项进行编译（`-Wall`这是一个很好的起点；如果可以，请添加）`-Wextra`。`-Werror`检查`printf()`和`scanf()`格式的显式选项是`-Wformat`，但它包含在`-Wall`.

```
#include <stdio.h>

int main(void)
{
    double values[8];

    printf("Enter first decimal number: ");
    if (scanf("%lf", &values[0]) != 1)
        printf("Scan failed!\n");
    else 
        printf("values[0] = %g\n", values[0]);
    return(0);
} 
```

请注意，这包括输出末尾的换行符，并且还会在输入出现问题（例如没有数据或无效数据）时进行诊断。

> 我以为数组只是指向数组第一个元素的指针？为什么我必须使用 & 符号？

1.  数组不仅是指向数组第一个元素的指针，而且当数组名在表达式中使用而不是作为 的参数时`sizeof()`，它会变为指向数组第一个元素的指针。
2.  您必须使用与号，因为`values[0]`它是数组第一个元素的值，而不是数组第一个元素的地址，并且`scanf()`需要地址，而不是值。请记住：`a[i] == *(a + i)`对于数组名称或指针`a`和索引`i`，并注意`*`取消引用指针。如果你写了`scanf("%lf", values)`or `scanf("%lf", values + 0)`，你正在传递一个指针。请注意，传递`scanf("%lf", &values)`将是类型不匹配（尽管作为地址传递的值是相同的——所以它巧合地“有效”）。传递的类型将是“指向 8 数组的指针`double`”，这与“指向 8 的指针`double`”不同。

# python - heroku 的 gunicorn 和瓶子设置

> ID：14666267
> 
> 赞同：2
> 
> 时间：2013-02-02T20:36:09.867
> 
> 标签：python, heroku, wsgi, bottle, gunicorn

我在 heroku 上玩瓶子，想换一个更“生产”的 WSGI 服务器 gunicorn。这是我的设置：

```
import os
import bottle
from bottle import route, run, template, request, static_file, error

class StripPathMiddleware(object):
    def __init__(self, app):
        self.app = app
    def __call__(self, e, h):
        e['PATH_INFO'] = e['PATH_INFO'].rstrip('/')
        return self.app(e, h)

# ................................................................. #

@error(404)
def error404(error):
    return template('view/404.tpl')

app = bottle.app()
run(app=StripPathMiddleware(app), server='gunicorn', host='0.0.0.0', port=int(os.environ.get("PORT", 5000)), debug=True, workers=3) 
```

这是我的**Procfile**：

```
web: gunicorn SimpleServer:app -w 3 
```

我在 SimpleServer.py 应用程序中尝试了设置和不设置工作人员数量的**Procfile 。**

在本地机器上，只有在应用程序中我有**workers=3**并且我没有指定工人开始**gunicorn**时它才有效：

```
(bottleServ)caerus@Artem:~/bottleServ$ gunicorn SimpleServer:app
2013-02-02 23:23:48 [18133] [INFO] Starting gunicorn 0.17.2
2013-02-02 23:23:48 [18133] [INFO] Listening at: http://127.0.0.1:8000 (18133)
2013-02-02 23:23:48 [18133] [INFO] Using worker: sync
2013-02-02 23:23:48 [18138] [INFO] Booting worker with pid: 18138
Bottle v0.11.6 server starting up (using GunicornServer(workers=3))...
Listening on http://0.0.0.0:5000/
Hit Ctrl-C to quit.

2013-02-02 23:23:48 [18138] [INFO] Starting gunicorn 0.17.2
2013-02-02 23:23:48 [18138] [INFO] Listening at: http://0.0.0.0:5000 (18138)
2013-02-02 23:23:48 [18138] [INFO] Using worker: sync
2013-02-02 23:23:48 [18139] [INFO] Booting worker with pid: 18139
2013-02-02 23:23:48 [18140] [INFO] Booting worker with pid: 18140
2013-02-02 23:23:48 [18141] [INFO] Booting worker with pid: 18141 
```

但是**foreman start**存在问题，无论我使用什么设置都可以：

```
(bottleServ)caerus@Artem:~/bottleServ$ foreman start
23:31:57 web.1  | started with pid 18192
23:31:58 web.1  | 2013-02-02 23:31:58 [18195] [INFO] Starting gunicorn 0.17.2
23:31:58 web.1  | 2013-02-02 23:31:58 [18195] [INFO] Listening at: http://0.0.0.0:5000  (18195)
23:31:58 web.1  | 2013-02-02 23:31:58 [18195] [INFO] Using worker: sync
23:31:58 web.1  | 2013-02-02 23:31:58 [18200] [INFO] Booting worker with pid: 18200
23:31:58 web.1  | 2013-02-02 23:31:58 [18201] [INFO] Booting worker with pid: 18201
23:31:58 web.1  | 2013-02-02 23:31:58 [18202] [INFO] Booting worker with pid: 18202
23:31:58 web.1  | Bottle v0.11.6 server starting up (using GunicornServer(workers=3))...
23:31:58 web.1  | Listening on http://0.0.0.0:5000/
23:31:58 web.1  | Hit Ctrl-C to quit.
23:31:58 web.1  | 2013-02-02 23:31:58 [18202] [INFO] Starting gunicorn 0.17.2
23:31:58 web.1  | 2013-02-02 23:31:58 [18202] [ERROR] Connection in use: ('0.0.0.0', 5000)
23:31:58 web.1  | 2013-02-02 23:31:58 [18202] [ERROR] Retrying in 1 second.
23:31:58 web.1  | Bottle v0.11.6 server starting up (using GunicornServer(workers=3))...
23:31:58 web.1  | Bottle v0.11.6 server starting up (using GunicornServer(workers=3))...
23:31:58 web.1  | Listening on http://0.0.0.0:5000/
23:31:58 web.1  | Listening on http://0.0.0.0:5000/
23:31:58 web.1  | Hit Ctrl-C to quit.
23:31:58 web.1  | Hit Ctrl-C to quit.
23:31:58 web.1  | 2013-02-02 23:31:58 [18200] [INFO] Starting gunicorn 0.17.2
23:31:58 web.1  | 2013-02-02 23:31:58 [18201] [INFO] Starting gunicorn 0.17.2
23:31:58 web.1  | 2013-02-02 23:31:58 [18200] [ERROR] Connection in use: ('0.0.0.0',   5000)
23:31:58 web.1  | 2013-02-02 23:31:58 [18201] [ERROR] Connection in use: ('0.0.0.0', 5000)
23:31:58 web.1  | 2013-02-02 23:31:58 [18200] [ERROR] Retrying in 1 second.
23:31:58 web.1  | 2013-02-02 23:31:58 [18201] [ERROR] Retrying in 1 second. 
```

任何想法，将不胜感激！)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T00:59:49.197

您正在启动 gunicorn 来运行应用程序，然后使用[Bottle 的“运行”](http://bottlepy.org/docs/dev/_modules/bottle.html#run)来生成另一台服务器（至少在 Heroku 上）。您收到错误的原因是初始服务器占用端口 5000，而第二个服务器无法访问它。尝试运行你的瓶子应用程序（python SimpleServer.py）它应该创建服务器本身。此外，当您将“应用程序”传递给运行时，http 服务器会生成您的应用程序的另一个副本（它会生成另一个 gunicorn 服务器），所以只需将其删除。

```
run(server='gunicorn', host='0.0.0.0', port=int(os.environ.get("PORT", 5000)), debug=True, workers=X)

python SimpleServer.py 
```

应该是你所需要的。

# c# - Recursive power calculation

> ID：14666275
> 
> 赞同：-4
> 
> 时间：2013-02-02T20:37:03.860
> 
> 标签：c#, factorial

I need to write a recursive method `Power(base, exponent)` that, when called, returns `Power(3,4) = 3*3*3*3`. And `exponent` is an integer greater than or equal to 1\. Below is my code, but it is wrong. I want to use factorial, but i know little about factorial.

```
public static void Main(string[] args)
{
    Console.WriteLine("please enter base,\n" + "please enter exponent,\n" + "pressing 'Enter'after each one");

    double number1 = Convert.ToDouble(Console.ReadLine());

    int number2 = Convert.ToInt16(Console.ReadLine());

    double result = Pow(number1, number2);

    Console.WriteLine("pow({0},{1}) is {2}",number1,number2,result);
}

public static long Factorial(long number)
{
    if (number <= 1)
        return 1;
    else
        return number * Factorial(number - 1);
}

public static double Pow(double basevalue, int exponentvalue)
{
    double a=1;
    if (exponentvalue==1)
    {
        Console.WriteLine("It is not make sense!");
        return basevalue;
    }
    else if(exponentvalue > 1)
    {
        a=exponentvalue * Factorial(exponentvalue - 1);
    }
    return a;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:49:56.420

我假设您谈论阶乘的原因是因为它可以使用递归算法计算，因此可以计算数字的整数幂。除此之外，您不应使用阶乘来计算功率。

要使用递归计算数字的幂，您可以这样做：

```
Power(base, exponent) = base*Power(base, exponent - 1) 
```

并终止递归：

```
Power(base, 0) = 1 
```

`Power(3, 4)`使用递归计算的结果如下：

```
Power(3, 4)
    = 3*Power(3, 3)
    = 3*3*Power(3, 2)
    = 3*3*3*Power(3, 1)
    = 3*3*3*3*Power(3, 0)
    = 3*3*3*3*1 
```

在 C# 中实现这一点留作练习。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:45:31.177

简单的。如果需要，您可以添加一些额外的无效检查`exponentvalue`。

```
public static double Pow(double basevalue, int exponentvalue)
{
    if (exponentvalue == 0)
    {
        return 1;
    }
    if (exponentvalue == 1)
    {
        return baseValue;
    }
    return baseValue * Pow(basevalue, exponentvalue-1);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T20:50:00.020

首先，您需要查找一些您正在使用的功能 mate。阶乘与权力**无关。**您可以将幂编写为递归函数，如下所示：

```
internal static double Pow(double @base, int exponent)
{
    if (exponent < 0)
    {
        Console.Error.WriteLine("Usage of this function is limited to positive exponents only");
        throw new Exception();
    }
    else if (exponent == 1)
    {
        return @base;
    }
    else if (exponent == 0)
    {
        return 1;
    }
    else
    {
        return @base * Pow(@base, exponent - 1);
    }
} 
```

# node.js - Accessing server side functions using Express.js and EJS

> ID：14666276
> 
> 赞同：0
> 
> 时间：2013-02-02T20:37:29.760
> 
> 标签：node.js, express, ejs

I'm running a test app in Express.js using EJS as the templating engine. I'd like to access functions stored in a .js file to run server side and not client side. For instance if I have:

```
<%= console.log("I'm in the server console"); %> 
```

the server catches the console output, and if I have:

```
<script type="text/javascript"> console.log("I'm in the client-side console"); </script> 
```

Now if I have a function to output the same for the client side I can include it this way:

```
<script type="text/javascript" src="/javascripts/clientSideCode.js"> clientSideOutput(); </script> 
```

But how do I include a file and its functions that way so EJS can execute server side code? It appears that the `public` folder in express is just for client side code.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:29:09.817

您可以创建模板可以通过以下方式访问的辅助函数`app.locals`：

*   [http://expressjs.com/api.html#app.locals](http://expressjs.com/api.html#app.locals)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T22:51:41.003

您可以使用[node.js](http://nodejs.org)和[Socket.IO](http://socket.io)在客户端和服务器之间发出实时事件。例如，客户端会执行以下操作：

```
<script>window onload = function() {

socket.emit('request_customer_list', { state: "tx" });

socket.on('receive_customer_list', function(data) {
$.each(data.customer_list, function(key, value) {

  socket.set(key, value); // store the customer data and then print it later
});

});} 
```

在您的服务器上，您可以有一个例程来加载客户列表并以类似的格式发回：

```
socket.on('connection')
  socket.on('request_customer_list', function(data){
   state = data.state;
   var customer_list;
   // pretend i loaded a list of customers from whatever source right here
   socket.emit('receive_customer_list', {customer_list: customer_list});
)} )}; 
```

# database - Laravel 4：处理种子中的关系

> ID：14666277
> 
> 赞同：15
> 
> 时间：2013-02-02T20:37:34.997
> 
> 标签：database, many-to-many, laravel, laravel-4

在 L4 的新种子功能中是否有一种简单的方法来管理多对多关系？

一种方法是为数据透视表制作种子，但我会做很多工作。

对这类事情的良好工作流程有什么想法吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-29T09:59:16.850

在最新版本的 Laravel 4 中，您可以在 DatabaseSeeder 类的“运行”方法中定义所有播种脚本的运行顺序。

```
public function run()
{
    DB::statement('SET FOREIGN_KEY_CHECKS=0;');

    $this->call('PrimaryTableOneSeeder');
    $this->command->info('The first primary table has been seeded!');

    $this->call('PrimaryTableTwoSeeder');
    $this->command->info('The second primary table has been seeded!');

    $this->call('PivotTableSeeder');
    $this->command->info('The pivot table has been seeded!');

    DB::statement('SET FOREIGN_KEY_CHECKS=1;');
} 
```

您会注意到我在运行所有种子之前和之后禁用了外键约束。这可能是不好的做法，但这是我可以使用 truncate 函数重新设置每个表的 id 计数的唯一方法。如果您按照[插入相关模型](http://four.laravel.com/docs/eloquent#inserting-related-models)的指南进行操作，则可能不需要此做法。

```
class PrimaryTableOneSeeder extends Seeder {

public function run()
{
    DB::table('primaryone')->truncate();
    Primaryone::create(array(
        'field' => 'value',
        'created_at' => new DateTime,
        'updated_at' => new DateTime
    ));
} 
```

要像我在示例中所做的以及最新版本的文档那样使用[质量分配，您需要为模型指定一些受保护的或可填充的列。](http://four.laravel.com/docs/eloquent#mass-assignment)为此，只需将属性添加到您的模型中，如下所示：

```
class Primaryone extends Eloquent {

protected $guarded = array('id'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T02:45:00.367

Laravel 种子文件是常规的 PHP 脚本（除了它们需要返回一个数组）。您可以在种子文件中查询数据库（使用 Eloquent、Fluent builder 甚至 PDO）。

解决多对多问题的一种方法是故意命名您的种子文件，以便最后填充数据透视表...例如，您可以在文件名前添加一个数值（即 1_authors.php、2_books. php、3_authors_books.php 等）。Artisan 在执行文件之前按字母顺序对文件名进行排序。

我已经发布了一个关于**[Laravel 4 数据库播种](http://laravelbook.com/laravel-database-seeding/)**的小教程——这应该能让你继续前进。另外，你可以参考官方的[种子](http://doc.laravelbook.com/migrations/)文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:38:29.840

种子用于简单信息、测试数据和静态信息。我不建议用它来处理关系。就个人而言，我只将它用于每个表的 2 或 3 条记录，以帮助测试我的应用程序。

在开发应用程序时，请考虑先处理数据输入（管理）区域，然后再处理前端。这样您就可以轻松添加测试数据。

# ios - iOS native app GA tracking (v2) - video and audio

> ID：14666278
> 
> 赞同：0
> 
> 时间：2013-02-02T20:37:36.453
> 
> 标签：ios, objective-c, google-analytics

I'm trying to track video and audio plays as screen views using the GA iOS SDK v2\. Is this possible? Normally one would replace the uiviewcontroller reference with GItrackedviewcontroller. This doesn't seem to be an option.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T09:31:32.333

是的，这是可能的。您可以手动调用

```
[tracker sendView:@"My view name"]; 
```

每次打开视频或音频流时。GAITrackedViewController 除了将这个 sendView 调用准确地放入 viewDidAppear（或 viewWillAppear，对此不确定）之外什么都不做。

# xml - 从链接数据 XSLT 中获取属性

> ID：14666282
> 
> 赞同：0
> 
> 时间：2013-02-02T20:38:04.563
> 
> 标签：xml, xslt

假设我的 XML 文件中有以下代码，我想在行中显示以下信息：creationDate - serviceName - problemCode - Division。

```
<foi:serviceInfo rdf:ID="SI1">
 <foi:serviceName>Sewer</foi:serviceName>
 <foi:problemCode>SI1</foi:problemCode>
 <foi:division>Water</foi:division>
</foi:serviceInfo>

<foi:serviceInfo rdf:ID="SI2">
 <foi:serviceName>Recycling</foi:serviceName>
 <foi:problemCode>SI2</foi:problemCode>
 <foi:division>Solid Waste</foi:division>
</foi:serviceInfo>

<foi:serviceRequest rdf:ID="R1">
       <foi:creationDate>29 03 2013</foi:creationDate>
       <foi:servicing rdf:resource="#SI1"/>
</foi:serviceRequest>
<foi:serviceRequest rdf:ID="R2">
       <foi:creationDate>29 06 2013</foi:creationDate>
       <foi:servicing rdf:resource="#SI2"/>
</foi:serviceRequest> 
```

我可以按行显示来自 serviceRequest 的信息，但是，我不知道如何将 foi:servicing 中的资源链接到 serviceInfo 的 ID（以便获取 serviceInfo 中包含的属性，然后显示它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:27:01.643

这是一个有点不优雅的解决方案，并且需要额外的工作来扩展到结构不同的数据集（尽管它适用于您的示例数据集中排列的任意数量的 serviceInfo 和 serviceRequest 元素）。它的优点是它涉及使用应用模板而不是 for-each。使用应用模板是最佳实践。另外，我不知道要使用正确的命名空间，所以我只是做了一些。

**这个 XSLT**

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:foi="http://www.foi.com"
xmlns:rdf="http://www.rdf.com"
exclude-result-prefixes="foi rdf"
version="2.0">

<!-- Identity template -->
<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
</xsl:template>
<xsl:variable name="newLine"><xsl:text>

</xsl:text></xsl:variable>
<xsl:template match="/">
    <xsl:value-of select="$newLine"/><table><xsl:value-of select="$newLine"/>
        <xsl:apply-templates select="//foi:creationDate"/>
    </table><xsl:value-of select="$newLine"/>
</xsl:template>
<xsl:template match="foi:creationDate">
    <xsl:variable name="resourceId" select="replace(../foi:servicing/@rdf:resource,'#','')"/>
    <xsl:message>BAH <xsl:value-of select="$resourceId"/></xsl:message>
    <tr><xsl:value-of select="$newLine"/>
        <td><xsl:apply-templates/></td><xsl:value-of select="$newLine"/>
        <td><xsl:apply-templates select="//foi:serviceName[parent::*[@rdf:ID=$resourceId]]"/></td><xsl:value-of select="$newLine"/>
        <td><xsl:apply-templates select="//foi:problemCode[parent::*[@rdf:ID=$resourceId]]"/></td><xsl:value-of select="$newLine"/>
        <td><xsl:apply-templates select="//foi:division[parent::*[@rdf:ID=$resourceId]]"/></td><xsl:value-of select="$newLine"/>
    </tr><xsl:value-of select="$newLine"/>
</xsl:template>
<xsl:template match="foi:serviceName">
    <xsl:apply-templates select="@* | node()" />
</xsl:template>
<xsl:template match="foi:problemCode">
    <xsl:apply-templates select="@* | node()" />
</xsl:template>
<xsl:template match="foi:division">
    <xsl:apply-templates select="@* | node()" />
</xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时：（注意：我添加了一个根元素）**

```
<root>
<foi:serviceInfo rdf:ID="SI1">
    <foi:serviceName>Sewer</foi:serviceName>
    <foi:problemCode>SI1</foi:problemCode>
    <foi:division>Water</foi:division>
</foi:serviceInfo>
<foi:serviceInfo rdf:ID="SI2">
    <foi:serviceName>Recycling</foi:serviceName>
    <foi:problemCode>SI2</foi:problemCode>
    <foi:division>Solid Waste</foi:division>
</foi:serviceInfo>
<foi:serviceRequest rdf:ID="R1">
    <foi:creationDate>29 03 2013</foi:creationDate>
    <foi:servicing rdf:resource="#SI1"/>
</foi:serviceRequest>
<foi:serviceRequest rdf:ID="R2">
    <foi:creationDate>29 06 2013</foi:creationDate>
    <foi:servicing rdf:resource="#SI2"/>
</foi:serviceRequest>
</root> 
```

**产生所需的结果：**

```
<tr>

<td>29 03 2013</td>

<td>Sewer</td>

<td>SI1</td>

<td>Water</td>

</tr>

<tr>

<td>29 06 2013</td>

<td>Recycling</td>

<td>SI2</td>

<td>Solid Waste</td>

</tr>

</table> 
```

**简要说明：**

*   抑制文本节点（文本节点的默认模板是输出它们；我们将通过 XSLT 文件末尾的特定模板输出它们）
*   处理 foi:creationDate 元素
*   在处理每个 foi:createDate 元素时，找到其父 rdf:resource 并将该值存储在变量中
*   然后处理每个适当的元素，通过查看文档中的所有元素（这就是“//”的意思），其父的 rdf:ID 与 rdf:resource 匹配（注意：如果有多个匹配的元素，这将输出多个值标准...您的数据集没有这样的多个元素；* 可能是 [也许应该是] foi:serviceName，但我想说明 * 的含义——选择任何元素并且 [] 中的内容区分哪些元素可以合格）
*   这也允许您在 serviceName 等元素中有子节点（不仅仅是文本节点）并处理这些节点（尽管现在处理正在复制到结果树）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:43:20.233

**这个较短的转换使用 X 引用的键并在表中生成所需的结果：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:foi="some:foi" xmlns:rdf="some:rdf" exclude-result-prefixes="foi rdf">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kSIById" match="foi:serviceInfo" use="concat('#',@rdf:ID)"/>

 <xsl:template match="/*">
  <table border="1"><xsl:apply-templates/></table>
 </xsl:template>
 <xsl:template match="/*/*" priority="-1"/>

 <xsl:template match="/*/foi:serviceRequest">
  <tr>
   <td><xsl:apply-templates select="foi:creationDate"/></td>
   <xsl:apply-templates select="key('kSIById', foi:servicing/@rdf:resource)/*"/>
  </tr>
 </xsl:template>

 <xsl:template match="foi:serviceInfo/*">
   <td><xsl:value-of select="."/></td>
 </xsl:template>
</xsl:stylesheet> 
```

**在提供的源 XML 上应用时（包装在单个顶部元素中并定义了命名空间）：**

```
<root xmlns:foi="some:foi" xmlns:rdf="some:rdf">
  <foi:serviceInfo rdf:ID="SI1">
    <foi:serviceName>Sewer</foi:serviceName>
    <foi:problemCode>SI1</foi:problemCode>
    <foi:division>Water</foi:division>
  </foi:serviceInfo>

  <foi:serviceInfo rdf:ID="SI2">
    <foi:serviceName>Recycling</foi:serviceName>
    <foi:problemCode>SI2</foi:problemCode>
    <foi:division>Solid Waste</foi:division>
  </foi:serviceInfo>

  <foi:serviceRequest rdf:ID="R1">
    <foi:creationDate>29 03 2013</foi:creationDate>
    <foi:servicing rdf:resource="#SI1"/>
  </foi:serviceRequest>
  <foi:serviceRequest rdf:ID="R2">
    <foi:creationDate>29 06 2013</foi:creationDate>
    <foi:servicing rdf:resource="#SI2"/>
  </foi:serviceRequest>
</root> 
```

**产生想要的正确结果：**

```
<table border="1">
   <tr>
      <td>29 03 2013</td>
      <td>Sewer</td>
      <td>SI1</td>
      <td>Water</td>
   </tr>
   <tr>
      <td>29 06 2013</td>
      <td>Recycling</td>
      <td>SI2</td>
      <td>Solid Waste</td>
   </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T03:01:09.750

在 XSLT 中交叉引用数据的首选方法是使用`<xsl:key>`. 以下 XSLT 应该这样做：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:foi="foifoifoi" xmlns:rdf="rdfrdf"
                exclude-result-prefixes="foi rdf">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:key name="kService" match="foi:serviceInfo" use="@rdf:ID"/>

  <xsl:template match="/*">
    <div>
      <xsl:apply-templates select="foi:serviceRequest" />
    </div>
  </xsl:template>

  <xsl:template match="foi:serviceRequest">
    <xsl:variable name="referenceId"
                  select="substring(foi:servicing/@rdf:resource, 2)" />
    <xsl:variable name="info" select="key('kService', $referenceId)[1]"/>
    <div>
      <xsl:value-of select="foi:creationDate"/>
      <xsl:apply-templates select="$info/*" />
    </div>
  </xsl:template>

  <xsl:template match="foi:serviceInfo/*">
    <xsl:value-of select="concat(' - ', .)"/>
  </xsl:template>
</xsl:stylesheet> 
```

`foi`（我必须为and组成命名空间，`rdf`因为您没有指出它们。请用正确的 URI 替换）。在此 XML 上运行时（添加了根节点）：

```
<root xmlns:foi="foifoifoi" xmlns:rdf="rdfrdf">
  <foi:serviceInfo rdf:ID="SI1">
    <foi:serviceName>Sewer</foi:serviceName>
    <foi:problemCode>SI1</foi:problemCode>
    <foi:division>Water</foi:division>
  </foi:serviceInfo>

  <foi:serviceInfo rdf:ID="SI2">
    <foi:serviceName>Recycling</foi:serviceName>
    <foi:problemCode>SI2</foi:problemCode>
    <foi:division>Solid Waste</foi:division>
  </foi:serviceInfo>

  <foi:serviceRequest rdf:ID="R1">
    <foi:creationDate>29 03 2013</foi:creationDate>
    <foi:servicing rdf:resource="#SI1"/>
  </foi:serviceRequest>
  <foi:serviceRequest rdf:ID="R2">
    <foi:creationDate>29 06 2013</foi:creationDate>
    <foi:servicing rdf:resource="#SI2"/>
  </foi:serviceRequest>
</root> 
```

这会产生：

```
<div>
  <div>29 03 2013 - Sewer - SI1 - Water</div>
  <div>29 06 2013 - Recycling - SI2 - Solid Waste</div>
</div> 
```

要点：

*   使用 an`xsl:key`允许`foi:serviceInfo`通过某个定位`ID`。
*   使用该`key()`函数`foi:serviceInfo`通过 ID 查找相关的。最后`[1]`的 将其限制为第一场比赛。我不确定是否有可能不止一场比赛，但有吗？
*   将其任何子级呈现`foi:serviceInfo`为连字符加元素值的模板。

# c# - 为什么 String.Contains 在此查询中不区分大小写？

> ID：14666284
> 
> 赞同：5
> 
> 时间：2013-02-02T20:38:11.860
> 
> 标签：c#, .net, asp.net-mvc, linq, asp.net-mvc-4

我正在学习[这个 ASP MVC 教程](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/examining-the-edit-methods-and-edit-view)。本教程的这一页涉及编写一个简单的“搜索”页面。控制器包含此方法：

```
public ActionResult SearchIndex(string searchString) 
{           
     var movies = from m in db.Movies 
                  select m; 

    if (!String.IsNullOrEmpty(searchString)) 
    { 
        movies = movies.Where(s => s.Title.Contains(searchString)); 
    } 

    return View(movies); 
} 
```

根据 MSDN，[`String.Contains`](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx)是区分大小写的。但是当我导航到 时`[website url]/Movies/SearchIndex?searchString=mel`，它会返回一个带有标题的电影`Melancholia`。如果我在调试器中检查控制器方法，`searchString`则`mel`（小写）符合预期。

为什么不`String.Contains`区分大小写匹配这个标题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-02T20:42:53.563

使用`Linq to entities`查询时是由 SQL Server 完成的。您的 Lambda 表达式被转换为 SQL 查询，因此它是否区分大小写取决于服务器配置。

如果您想更改 SQL Server 排序规则并使其区分大小写，请参阅此页面：http: [//blog.sqlauthority.com/2007/04/30/case-sensitive-sql-query-search/](http://blog.sqlauthority.com/2007/04/30/case-sensitive-sql-query-search/)

# web-services - TCP 连接流失意味着什么？

> ID：14666287
> 
> 赞同：8
> 
> 时间：2013-02-02T20:38:23.610
> 
> 标签：web-services, tcp, finagle

在 Web 服务的上下文中，我看到使用了术语“TCP 连接搅动”。具体来说， [Twitter finagle](http://engineering.twitter.com/2011/08/finagle-protocol-agnostic-rpc-system.html)有办法避免它发生。它是如何发生的？这是什么意思？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T10:43:13.197

这个术语可能有多种用途，但我总是看到它用于在很短的时间内建立许多 TCP 连接的情况，这会导致客户端和服务器的性能问题。

这通常发生在编写客户端代码时，该代码会在任何类型的 TCP 故障时自动连接。如果此失败恰好是在连接建立之前（或在协议交换的早期）发生的连接失败，那么客户端可以进入一个近乎忙碌的循环，不断地建立连接。这可能会导致客户端的性能问题——首先，在一个非常繁忙的循环中有一个进程会占用 CPU 周期，其次，每次连接尝试都会消耗一个客户端端口号——如果速度足够快，软件可以环绕当它们达到最大端口号时（因为端口只有 16 位数字，这当然不是不可能的）。

虽然编写健壮的代码是一个有价值的目标，但这种简单的“自动重试”方法有点太天真了。您可以在其他上下文中看到类似的问题 - 例如，父进程不断重新启动子进程，该子进程立即崩溃。避免它的一种常见机制是某种增加的回退。因此，当第一次连接失败时，您会立即重新连接。如果它在很短的时间内（例如 30 秒）再次失败，那么您在重新连接之前等待，比如说，2 秒。如果在 30 秒内再次失败，则等待 4 秒，以此类推。阅读[有关指数退避的 Wikipedia 文章](http://en.wikipedia.org/wiki/Exponential_backoff)（或[此博客文章](http://dthain.blogspot.co.uk/2009/02/exponential-backoff-in-distributed.html)可能更适合此应用程序）以了解有关此技术的更多背景信息。

这种方法的优点是它不会压倒客户端或服务器，但这也意味着客户端仍然可以在没有人工干预的情况下恢复（这对于无人值守服务器上的软件或大型集群中的软件尤其重要）。

在恢复时间很关键的情况下，TCP 连接创建的简单速率限制也是很可能的——可能不超过每秒 1 次或其他什么。但是，如果每台服务器有很多客户端，这种更简单的方法仍然会使服务器被接受然后关闭高连接率的负载所淹没。

如果您计划使用指数退避，需要注意的一件事 - 我建议设置最大等待时间，或者您可能会发现，一旦服务器端确实开始再次接受连接，长时间的故障会使客户端需要很长时间才能恢复。在大多数情况下，我建议将 5 分钟作为合理的最大值，但这当然取决于应用程序。

# twitter-bootstrap - 如何从 twitter 引导模式中删除滚动条？

> ID：14666289
> 
> 赞同：0
> 
> 时间：2013-02-02T20:38:28.117
> 
> 标签：twitter-bootstrap, django-forms, django-views

我正在使用 django 和 twiiter 引导程序。在下面的代码中，我在引导模式中调用 django 视图，它是一个 userena 登录表单 - 帐户/登录/。视图呈现在模态中，但我得到一个滚动条，我想摆脱这个滚动条。

这是我的模态代码

```
<script>
   $(document).ready(function() {
     $('#signup').modal({
       remote: '/accounts/signin/',
       show: false
     });
   });
</script>   

    <div class="container">
    <div id="signup" class="modal hide fade in" style="display: none;">
    <div class="modal-header">
             <a class="close" data-dismiss="modal">Sample</a>
             </div>
        <div class="modal-footer">
          <a href="#" class="btn btn-primary" data-dismiss="modal">Close</a>
        </div>  
     </div>
</div> 
```

然后在这里调用模态

```
 <li><a data-toggle="modal" href="#signup">Signs Up New</a></li> 
```

这是显示引导模式的正确方法吗？如何摆脱滚动条？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-11T10:00:11.990

添加一个带有“Modal-body”类的“div”来保存您的内容并定义最大高度或最大宽度。请参阅下面的示例代码。

```
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3 id="myModalLabel">Modal Title</h3>
    </div>
    <div class="modal-body" style="max-height:800px;">
        Your content here...
    </div>
    <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</div> 
```

# ruby-on-rails - 使用 has_many 分配 Rails 模型：通过

> ID：14666293
> 
> 赞同：0
> 
> 时间：2013-02-02T20:39:28.387
> 
> 标签：ruby-on-rails, rails-activerecord

我只是不知道如何创建与连接表的关系。我已经阅读了所有关于它们的帖子，但主要错误似乎是模型的连接表中应该是单数的，我有。我似乎可以正确地创建模型并分配它们。我有带有数据集的项目，项目可以有多个数据集，而一个数据集可以属于多个项目。数据集可以是活动的或不活动的，这就是为什么我需要 has_many through 而不是 has_many_and_belongs_to 设置。我的模型定义是：

```
class Project < ActiveRecord::Base
  attr_accessible :name, :user_id

  belongs_to :user
  has_many :activedatasets
  has_many :datasets, :through => :activedatasets

end

class DataSet < ActiveRecord::Base
  attr_accessible :name, :project_id, :filename, :tempfilename

  has_many :activedatasets
  has_many :projects, :through => :activedatasets

end

class ActiveDataSet < ActiveRecord::Base
  attr_accessible :active, :data_set_id, :project_id

  belongs_to :project
  belongs_to :dataset

end 
```

当我创建一个新数据集时，我在参数中有 project_id，所以我试图设置如下关系：

```
class DataSetsController < ApplicationController
  def new
    @dataset = DataSet.new
    @dataset.activedatasets.project_id = params[:project_id]
  end
end 
```

我得到的错误似乎很有名：

```
NameError in DataSetsController#new

uninitialized constant DataSet::Activedataset 
```

有人可以指出我正确的方向吗？

谢谢你的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:51:25.187

你需要使用：

```
has_many :active_data_sets
has_many :data_sets, :through => :active_data_sets 
```

在 DataSet 模型中：

```
has_many :active_data_sets
has_many :projects, :through => :active_data_sets 
```

基本上，rails 希望您使用下划线来分隔关联名称中的单词，并将它们转换为 CamelCase。所以active_data_sets 变成了ActiveDataSet。然后 Rails 使用它来计算关联与哪个模型类。

您还需要将控制器更改为：

```
class DataSetsController < ApplicationController
  def new
    @dataset = DataSet.new
    @dataset.active_data_sets.build(:project_id => params[:project_id])
  end
end 
```

否则你会得到一个错误，因为你试图设置 active_data_sets 集合的 project_id 而不是创建一个新的 ActiveDataSet。

# ms-access - 将多个附件上传到 Access 并自动分配

> ID：14666299
> 
> 赞同：1
> 
> 时间：2013-02-02T20:39:58.557
> 
> 标签：ms-access, ms-access-2007

两天过去了，我把头发扯掉了。

我需要将数百个“png”附件上传到一个表格中（即不是每个帐户代码一个接一个），通过将帐户代码与附件文件名匹配，他们会自动在表格中找到相关的帐户代码。

或者，我需要将所有附件上传到一个地方，然后进行搜索查询，将这些附件分配给表格中的特定帐户代码。

我已经能够提出一个查询，将所有附件分配给我的所有相关帐户代码，但无法使用数据文件名分配特定附件以引用特定帐户代码。

我还能够创建一个表单，在数据文件名下显示相关附件，但是当我双击它时，它不会从该字段打开。当我从表单打开附件本身时，它只会显示“管理附件”框，显示每个附件供我选择我想要的附件。这对我的客户没有用。

我确信它必须很简单，但我已经花了很长时间在这方面，所以任何人都可以帮忙。

格雷厄姆

# c# - HTML遍历很慢

> ID：14666302
> 
> 赞同：3
> 
> 时间：2013-02-02T20:40:14.323
> 
> 标签：c#, performance, traversal, mshtml

我面临着使用 C# 简单地遍历 MSHTML 元素的速度非常慢。**这是通过document.all**集合迭代三次的小例子。我们有空白的 WPF 应用程序和名为 Browser 的 WebBrowser 控件：

```
public partial class MainWindow
{
    public MainWindow()
    {
        InitializeComponent();

        Browser.LoadCompleted += DocumentLoaded;
        Browser.Navigate("http://google.com");
    }

    private IHTMLElementCollection _items;

    private void DocumentLoaded(object sender, NavigationEventArgs e)
    {
        var dc = (HTMLDocument)Browser.Document;
        _items = dc.all;

        Test();
        Test();
        Test();
    }

    private void Test()
    {
        var sw = new Stopwatch();
        sw.Start();

        int i;
        for (i = 0; i < _items.length; i++)
        {
            _items.item(i);
        }

        sw.Stop();

        Debug.WriteLine("Items: {0}, Time: {1}", i, sw.Elapsed);
    }
} 
```

输出是：

```
Items: 274, Time: 00:00:01.0573245
Items: 274, Time: 00:00:00.0011637
Items: 274, Time: 00:00:00.0006619 
```

1 和 2 行之间的性能差异是可怕的。我尝试用非托管 C++ 和 COM 重写相同的代码，并且完全没有性能问题，非托管代码的运行速度快了 1200 倍。不幸的是，非托管不是一种选择，因为真正的项目比简单的迭代更复杂。

我知道运行时第一次为每个引用的 HTML 元素（即 COM 对象）创建 RCW。但它会那么慢吗？每秒 300 个项目，100% 核心负载为 3,2 GHz CPU。

上面代码的性能分析： ![性能分析](../Images/c362f7d5d8aeb9b5035c0793c35b5126.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:17:18.163

使用 for each 而不是 document.all.item(index) 枚举所有元素集合（如果切换到 C++，请使用 IHTMLElementCollection::get__newEnum）。

推荐阅读：[IE + JavaScript 性能建议 - 第 1 部分](http://blogs.msdn.com/b/ie/archive/2006/08/28/728654.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T09:09:44.417

性能不佳的根源在于MSHTML 互操作程序集中定义为**动态对象的集合项。**

```
public interface IHTMLElementCollection : IEnumerable
{
    ...
    [DispId(0)]
    dynamic item(object name = Type.Missing, object index = Type.Missing);
    ...
} 
```

如果我们重写该接口使其返回 IDispatch 对象，那么滞后将消失。

```
public interface IHTMLElementCollection : IEnumerable
{
    ...
    [DispId(0)]
    [return: MarshalAs(UnmanagedType.IDispatch)]
    object item(object name = Type.Missing, object index = Type.Missing);
    ...
} 
```

新输出：

```
Items: 246, Time: 00:00:00.0034520
Items: 246, Time: 00:00:00.0029398
Items: 246, Time: 00:00:00.0029968 
```

# php - 如何在 IPAGE 托管服务器上上传 cakePHP 框架项目？

> ID：14666305
> 
> 赞同：-1
> 
> 时间：2013-02-02T20:41:07.790
> 
> 标签：php, cakephp

这是我的网站[http://uncommonw.com/](http://uncommonw.com/)使用 cakephp 框架构建是一个 PHP 框架，我想知道错误是什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:48:12.683

错误消息说明了它；目录 /var/php_sessions/ 不存在或不能被 CakePHP 写入

```
failed: No such file or directory
....
....
Failed to write session data (files). Please verify that the current setting 
of session.save_path is correct (/var/php_sessions) 
```

但是，我认为您可以通过使用“Cake”而不是“php”作为会话处理程序来解决此问题；

在你的 app/Config/core.php 中，改变这个：

```
Configure::write('Session', array(
    'defaults' => 'php'
)); 
```

至：

```
Configure::write('Session', array(
    'defaults' => 'cake'
)); 
```

然后会话将被写入您的应用程序文件夹中的此目录：

```
app/tmp/sessions 
```

您必须确保 tmp 目录（以及其中的所有文件夹）对于 PHP 是可写的

# matlab - bintprog 可以与 MATLAB 上的 mod 2 方程约束一起使用吗？

> ID：14666306
> 
> 赞同：1
> 
> 时间：2013-02-02T20:41:09.477
> 
> 标签：matlab, binary, linear-programming

有没有办法在 MATLAB 上解决二元最小化问题，而不是方程约束，而是模约束，也就是说，而不是 A*x=b，例如 A*x=b (mod 2)？我试过使用 bintprog，但不知道如何添加这个条件。是否有二进制非线性规划的求解器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-22T12:53:58.080

不，你不能，因为 mod 2 不是线性运算符。bintprog 仅用于线性方程。

# c# - 使 wcf 数据服务生成具有虚拟属性的实体

> ID：14666307
> 
> 赞同：2
> 
> 时间：2013-02-02T20:41:13.307
> 
> 标签：c#, wcf, silverlight, interface, virtual

我们引用了一个无法修改的 wcf 数据服务。

它作为服务参考添加到我们的项目中。

完成后，将生成实体类。

我们希望生成的属性是虚拟的。

例如

> 公共虚拟字符串名称 {get;set;}

如果可以使它们实现包含它们所具有的属性的接口，那也将是很酷的。

我计划用 Castle.DynamicProxy 来增强它们。

从我的角度来看，无论是实现 ifc，还是在生成的类中将属性设为虚拟，都不应该干扰数据传输，因为这完全是客户端。

那么，是否可以让服务生成的实体具有虚拟属性？或者让他们实现一个包含他们的属性列表的接口，以及如何实现？

谢谢阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T01:29:52.770

不，没有办法使用 WCF 生成虚拟成员。

一种解决方案可能是使用接口。您可以利用生成的类被标记为部分的事实，这避免了编辑生成的代码的需要，因此在重新生成代码时您的修改被覆盖。

这个问题的解决方案可能有用：

[如何将 WCF 客户端代理生成的类中的方法标记为虚拟](https://stackoverflow.com/questions/13235345/how-can-i-mark-the-methods-in-a-wcf-client-proxy-generated-class-as-virtual)

# c - 区分字符串和字节数组？

> ID：14666308
> 
> 赞同：6
> 
> 时间：2013-02-02T20:41:34.570
> 
> 标签：c, string, gcc, c99, buffer-overflow

我有很多函数需要一个字符串作为参数，为此我使用`char*`，但我所有需要字节数组的函数也使用`char*`.

问题是我很容易犯在字符串函数中传递字节数组的错误，导致各种溢出，因为找不到空终止符。

这通常是如何处理的？我可以想象将我所有的字节数组函数都更改为`uint8_t`，然后编译器会在我传递一个字符串时发出有关签名的警告。或者这里的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:49:04.483

我通常会制作一个类似于以下内容的数组

```
typedef struct {
   unsigned char* data;
   unsigned long length;
   unsigned long max_length;
} array_t; 
```

然后传递 array_t*

并创建采用 array_t* 的数组函数

```
void array_create( array_t* a, unsgined long length) // allocates memory, sets the max_length, zero length

void array_add(array_t* a, unsigned char byte)  // add a byte 
```

ETC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:37:53.927

这个问题在 C 中比你想象的更普遍。由于`char*`和`char[]`等价于函数参数，因此这样的参数可以指代三个不同的语义概念：

*   一个`char`对象上的指针（这是指针类型的“官方”定义）
*   一个`char`数组
*   一个字符串

在大多数情况下，C 标准中的现代接口可能`void*`用于无类型字节数组，您可能应该遵守该约定，并且`char*`仅用于字符串。

`char[]`本身可能很少这样使用；我无法想象这些有很多用例。如果您将它们视为数字，您应该使用`signed`or`unsigned`变体，如果您将它们视为位模式`unsigned char`应该是您的选择。

如果您真的将数组作为函数参数（`char`或不是），您可以通过清楚地指示来为您的代码的临时读者标记该事实：

```
void toto(size_t n, char A[const n]); 
```

这相当于

```
void toto(size_t n, char *const A); 
```

但会让你的意图更清晰。将来甚至可能会有工具为您进行边界检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T04:01:36.037

C 使用约定。这是我使用的规则（在标准库之后流行）

```
void foo(char* a_string);

void bar(void* a_byte_array, size_t number_of_bytes_in_the_array); 
```

这很容易记住。如果您传递单个 char* ptr，则它必须是一个以 null 结尾的 char 数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:50:21.480

编写一个通用结构来处理字符串和字节。

```
struct str_or_byte
{
    int type;
    union
    {
        char *buf;
        char *str;
    }pointer;
    int buf_length;
} 
```

如果`type`不是字符串，则访问`pointer.buf`唯一的 upto `buf_length`。否则直接访问`pointer.str`而不检查`buf_length`并将其维护为空终止字符串。

或者通过仅考虑长度将字符串也维护为字节数组，不要为字符串保留以空字符结尾的字符。

```
struct str_or_byte
{
    char *buf;
    int buf_length;
} 
```

并且不要使用不考虑长度的字符串操作函数。这意味着使用`strncpy`, `strncat`, `strncmp`... 而不是`strcpy`, `strcat`, `strcmp`...

# javascript - 如何在剑道网格中创建动态列

> ID：14666309
> 
> 赞同：0
> 
> 时间：2013-02-02T20:41:48.117
> 
> 标签：javascript, jquery, kendo-ui, kendo-grid

我正在使用剑道网格，我正在尝试创建没有。列基于编号。数据库 tbl_account 中的成员数。例如：- 如果 tbl_account 有 2 个成员，则网格应显示 2 列。

有没有办法做到这一点？任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:37:39.510

在我的项目中，我在运行时动态创建了列。我在这里发布了剃刀代码：

[http://www.kendoui.c​​om/forums/mvc/grid/ie-8-bug-column-resize-handle-not-showing-on-dynamic-grid-columns.aspx#2475693](http://www.kendoui.com/forums/mvc/grid/ie-8-bug-column-resize-handle-not-showing-on-dynamic-grid-columns.aspx#2475693)

# regex - mod_rewrite 规则丢失一个变量（正则表达式问题）

> ID：14666319
> 
> 赞同：0
> 
> 时间：2013-02-02T20:42:54.130
> 
> 标签：regex, apache, mod-rewrite

我得到了以下 mod_rewrite 规则

`Rewriterule ^products/([0-9]+)/([a-zA-Z0-9]+)[^a-zA-Z0-9]+([a-zA-Z0-9]+) /products/$2-$3-C$1 [R=301,L]`

因此，当有如下链接时：

`http://www.domain.com/products/2930/Monet, Claude`

它应该翻译为

`http://www.domain.com/products/Monet-Claude-C2930`

然而，它以某种方式摆脱`Claude`并将其翻译为：

`http://www.domain.com/products/Monet-C2930`

这不是很奇怪吗？它出什么问题了？

**更新**

我刚刚注意到问题是由上面的规则引起的： `Rewriterule ^products/([0-9]+)/([a-zA-Z0-9]+) /products/$2-C$1 [R=301,L]`我忘了用 $ 符号结束它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:06:31.697

它必须是工作测试它

```
RewriteRule ^products/([0-9]*)/([a-zA-Z0-9]+)[^a-zA-Z0-9]+([a-zA-Z0-9]*)$  /products/$2-$3-C$1 [R=301,L] 
```

# google-app-engine - GAE 和 GWT - response.sendRedirect 不是重定向

> ID：14666321
> 
> 赞同：0
> 
> 时间：2013-02-02T20:43:15.493
> 
> 标签：google-app-engine, gwt, blobstore

我正在创建一个需要图像上传功能的应用程序。我一直在关注[本](http://www.fishbonecloud.com/2010/12/tutorial-gwt-application-for-storing.html)教程和[App Engine 文档](https://developers.google.com/appengine/docs/java/blobstore/overview)。

图片上传正确，服务器重定向到FileUpload HttpServlet的doPost函数。我可以从请求中读取 blob 密钥并将其保存在数据存储中。

我的问题是将响应发送回客户端。我所看到的一切都指向使用 response.sendRedirect 函数，但这还没有成功。

```
public class FileUpload extends HttpServlet 
{
public void doPost(HttpServletRequest request, HttpServletResponse response)  throws ServletException, IOException
{
    BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();

    Map<String, List<BlobKey>> blobs = blobstoreService.getUploads(request);

    BlobKey blobKey = blobs.get("picFileUpload").get(0);

    ShipHull shipHull = new ShipHull();
    shipHull.setShipHullName(request.getParameter("hullNameText"));
    shipHull.setShipImageURL("/shipbuilder/blobService?blob-key=" + blobKey.getKeyString());

    PersistenceManager pm = PMF.get().getPersistenceManager();

    try
    {
        pm.makePersistent(shipHull);
    }
    catch (Exception e)
    {
        String hi = "hello";
    }
    finally
    {
        pm.close();
    }

    Boolean test = response.isCommitted();

    response.sendRedirect("/shipbuilder/FileUpload?gwt.codesvr=127.0.0.1:9997&shipHullName=" + shipHull.getShipHullName());

    test = response.isCommitted();

    return;
}

@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException 
{
    String id = req.getParameter("shipHullName");
    resp.setHeader("Content-Type", "text/html");
    resp.getWriter().println(id);
}

} 
```

我正在尝试将客户端重定向回同一个 servlet 中的 doGet。我已经尝试过这个并且没有`gwt.codesvr=127.0.0.1:9997`and the`shipHullName=" + shipHull.getShipHullName())`但是 doGet 函数永远不会到达。我也试过了`https://www.google.com`。

这一切都在开发服务器上完成（尚未在生产服务器上尝试过）。

如果您有任何其他返回图像保存状态的方法（例如，如果文件名已被使用），我不介意尝试不同的方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:59:40.523

我已经弄清楚了问题所在。[我想我和这篇文章](https://stackoverflow.com/questions/7476420/gwt-blobstore-error-calling-createuploadurl)有同样的问题。

我必须单击 GWT 开发模式工具箱图标并添加网络服务器“弹药箱”（我的计算机名称）和代码服务器为“127.0.0.1”。当我将浏览器定向到该开发链接时，一切正常，甚至你给SSR的答案。这是一个域切换问题。

谢谢您的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:01:36.960

您可以尝试将成功/失败的字符串放入 resp 对象中。

```
public void doPost( HttpServletRequest req, HttpServletResponse resp ) throws ServletException, IOException
{
 try{
   processFileUploads(req)
   resp.getWriter().print( "Success" );
 }{
 catch(Exception e){
   resp.getWriter().println( "Unable to upload the file - Upload Failed" );
 }
} 
```

# javascript - 使用 Jquery 或 Javascript 查找未标记的 html

> ID：14666325
> 
> 赞同：1
> 
> 时间：2013-02-02T20:43:49.647
> 
> 标签：javascript, jquery

> **可能重复：**
> [删除只有   的元素 使用 jQuery 的空间](https://stackoverflow.com/questions/1520981/remove-elements-with-only-a-nbsp-space-using-jquery)

我有一个自动生成的 HTML 提要，其中充满了垃圾......我正在尝试对其进行清理，并希望使用 jquery 去除一些错误代码。因此，例如，在隐藏在代码中的平均页面上，有接近 200 倍：

```
<div align="center"> </div> 
```

如果有某种 id 或 class 元素，这些将很容易摆脱。但我想不出一种方法来找到它们，而实际上它们里面没有任何东西。我可以按属性搜索吗？或者更好的是有没有办法通过 HTML 代码找到......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:36:29.777

如果您试图简单地删除所有空的 DIV 元素，或者只有一个空格的 DIV，那么您可以这样做：

`$('div').map(function() {`

 ````
 if( $(this).html().length <= 0 || $(this).html() == " ")
    {
        return this;
    }

}).remove(); 
````  `这会遍历页面上的所有 div，如果它们符合特定条件（它们为空或只有一个空格），则它将它们从 DOM 中删除。

这应该给你一个起点。如果您只想检查具有“中心”对齐属性的 DIV，那么您可以这样做：

`$('div:[align="center"]').map(function() {`

 ````
 if( $(this).html().length <= 0 || $(this).html() == " ")
    {
        return this;
    }

}).remove(); 
````  `当一个简单的过滤器或属性比较不够用时，jQuery 的 map() 函数会很棒。

你可以在这里阅读更多关于它的信息...... [http://api.jquery.com/map/](http://api.jquery.com/map/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:45:44.267

有一个 jQuery[属性选择器](http://api.jquery.com/attribute-equals-selector/)

对于您的示例：

```
jQuery( "div [align='center']" ) 
`````

# python - Matplotlib：具有相同高度的 Broken_barh 图

> ID：14666326
> 
> 赞同：0
> 
> 时间：2013-02-02T20:43:55.777
> 
> 标签：python, matplotlib

我正在处理broken_barh 图。有什么办法可以得到一个固定的broken_barh高度吗？图像应该在垂直方向变大，但比例应该保持不变。

这是一个简单的例子。

```
import matplotlib.pyplot as plt
import matplotlib as mlp

fig = plt.figure()
ax = fig.add_subplot(111)

broken_barh(self, xranges, yrange, **kwargs)
ax.broken_barh([(110, 30), (150, 10)], (0, 10), facecolors='blue')
ax.broken_barh([(10, 50), (100, 20), (130, 10)] , (10, 10),
               facecolors=('red', 'yellow', 'green'))
ax.broken_barh([(50, 30), (85, 10)], (20, 10), facecolors='black')

ax.set_xlim(0,200)
ax.set_xlabel('seconds since start')
ax.set_yticks([0,10,20])
ax.set_yticklabels(['Bill', 'Jim', 'Jeff'])
ax.grid(True)

plt.savefig('broken_barh_example.png', bbox_inches='tight') 
plt.show() 
```

如果我生成两个图，一个有两个 broken_barh，另一个有三个，它看起来像这样：

有 2 个破碎的酒吧 [http://imageshack.us/a/img195/747/brokenbarhexample2.png](http://imageshack.us/a/img195/747/brokenbarhexample2.png)

有 3 个破碎的酒吧 [http://img341.imageshack.us/img341/5650/brokenbarhexamplenoyran.png](http://img341.imageshack.us/img341/5650/brokenbarhexamplenoyran.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:55:59.080

渲染适合所有可用空间。如果您希望图形的大小随着添加更多行而增长，您可以通过以下方式手动完成

```
 fig.set_size_inches(w, h * num_rows, forward=True) 
```

强制固定条形高度。

[（文档）](http://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure.set_size_inches)

# nosql - neo4j中非键值数据的设计

> ID：14666329
> 
> 赞同：0
> 
> 时间：2013-02-02T20:44:35.107
> 
> 标签：nosql, neo4j

我有这样的数据：

```
Berlin: capital, city, germany, europe, DE3, CET
Lyon: city, france, Rhône-Alpes, europe, CET
Warsaw: capital, europe, city, poland, masovian, CET
Toulouse: city, midi-pyrénées, europe, france, CET
[...] 
```

这种记录有几千条。

我写了一个解析器来提取数据并像这样放入neo4j：

```
name: Berlin
capital: true
city: true
germany: true
DE3: true
CET: true 
```

这是一个示例节点。如果我想找到首都，我可以这样做：

```
START obj =node:node_auto_index('capital: true') RETURN obj 
```

这很有效，但我的问题是：

1.  我可以为这个非订单数据做得更好吗？
2.  也许我可以使用与真实不同的东西来更快地找到。例如 0 或 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T11:42:19.803

有多少个首都？

你也可以做一个资本节点，然后做：

```
start capitalCategory = node(1) match capital-[:IS_A]->capitalCategory return n; 
```

/彼得

# python - 零阶贝塞尔函数 Python

> ID：14666330
> 
> 赞同：2
> 
> 时间：2013-02-02T20:44:41.537
> 
> 标签：python, scipy, bessel-functions

为这个问题的简单性道歉。

我想在 Python 中实现一个方程。在这个等式中，K_0 是零阶修正贝塞尔函数。

在 Python 中实现 K_0 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T20:51:52.613

无需实施；它包括在内。请参阅[scipy.special](http://docs.scipy.org/doc/scipy/reference/special.html)模块的文档，尤其是优化的常用[模块](http://docs.scipy.org/doc/scipy/reference/special.html#faster-versions-of-common-bessel-functions)：

```
>>> import scipy.special
>>> print scipy.special.k0.__doc__
k0(x[, out])

y=k0(x) returns the modified Bessel function of the second kind (sometimes called the third kind) of
order 0 at x.
>>> scipy.special.k0(1)
0.42102443824070823 
```

或更一般地说：

```
>>> print scipy.special.kn.__doc__
kn(x1, x2[, out])

y=kn(n,x) returns the modified Bessel function of the second kind (sometimes called the third kind) for
integer order n at x.
>>> scipy.special.kn(0, 1)
0.42102443824070834 
```

# slowcheetah - SlowCheetah 不处理转换

> ID：14666333
> 
> 赞同：0
> 
> 时间：2013-02-02T20:44:52.303
> 
> 标签：slowcheetah

我复制了一个`web.config`已经定义了从一个项目到另一个项目的 show cheetah 变换。转换在新项目中显示得很好，我可以编辑它们。但是，当我运行项目时，它们没有被应用。

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:44:52.303

项目本身必须配置为应用转换。

为此，在新项目中：

*   右键单击`web.config`（或任何具有转换的文件）
*   添加变换

这将设置项目以应用慢猎豹变换，并将复制/编辑的变换保留在原处。

此操作可能需要一些时间，因为项目已卸载、修改和重新加载。

# ios - 在一个 CLLocationCoordinate2D 数组中收集 2 个数组 CLLocationDegree

> ID：14666336
> 
> 赞同：1
> 
> 时间：2013-02-02T20:45:12.270
> 
> 标签：ios, ios5, ios5.1

我需要在 ios 上的谷歌地图上绘制一条折线，我在单独的数组中有纬度和经度，我想将它们收集到一个 CLLocationCoordinate2D 数组中，所以请帮助我编写制作这个集合的代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:00:04.967

```
CLLocationCoordinate2D *coords = malloc(coordinateCount * sizeof(CLLocationCoordinate2D));
for(size_t i = 0; i < coordinateCount; ++i)  
{
    coords[i].latitude = latitudes[i];
    coords[i].longitude = longitudes[i];
}

// ... Use the array ...

free(coords); 
```

# java - 如何处理 JavaDoc 注释重复？

> ID：14666343
> 
> 赞同：5
> 
> 时间：2013-02-02T20:45:47.620
> 
> 标签：java, documentation, javadoc

我想知道记录这个潜在`Point`课程的最佳方式是什么：

```
public class Point {
    /* the X coordinate of this point */
    private int x;
    /* the Y coordinate of this point */
    private int y;

    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public int getX() {
        return x;
    }

    public int getY() {
        return y;
    }
} 
```

`x`我具体关心的是and`y`属性及其各自的 getter 和 setter之间的重复，以及构造函数参数之间的重复。

并不是说我正在开发公共 API 或任何类似的东西，例如，我可以对某个变量进行一般性评论，然后让 getter 和 setter 具有相同的文本。我只是想避免在我自己的内部代码中重复注释。例如，有没有办法将构造函数`getX()`的参数与属性联系起来？`int x``x`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:12:00.510

> 例如，有没有办法将 getX() 和构造函数的 int x 参数绑定到 x 属性？

不，我不知道。*我*做什么：

*   根本不要评论getter（或setter）
*   如果 X 需要上下文信息，并且如果它以某种方式代表类的（部分）状态，我只在类级 Javadoc 中记录它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:50:16.593

一个明显的约定是不为琐碎的 getter 编写 JavaDoc 注释。

# c++ - 神秘的笑脸出现在我的命令提示符下，让我百思不得其解，我的代码是否泄露了？

> ID：14666345
> 
> 赞同：6
> 
> 时间：2013-02-02T20:46:03.250
> 
> 标签：c++, windows, console, cmd, ascii

最近一直在玩C++，慢慢习惯了.

```
#include <iostream>
#include <stdlib.h>
#include <windows.h>

// BEGIN: Graphics Defines

char display01[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display02[80] = {255,218,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display03[80] = {255,179,255,255,255,179,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display04[80] = {255,179,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display05[80] = {255,179,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display06[80] = {255,179,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display07[80] = {255,179,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display08[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display09[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display10[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display11[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display12[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display13[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display14[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display15[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display16[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display17[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display18[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display19[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display20[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display21[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display22[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display23[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display24[80] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};
char display25[80] = {255,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,205,255};

void printScreen()
{
    system("CLS");
    std::cout << display01 << display02 << display03 << display04 << display05 << display06 << display07 << display08 << display09 << display10 << display11 << display12 << display13 << display14 << display15 << display16 << display17 << display18 << display19 << display20 << display21 << display22 << display23 << display24 << display25;
}

// END: Graphics Defines
// BEGIN: Game Logic Defines

bool debugLevel = true;        // When set to, debug messages will appear
unsigned short int eTimer = 0; // Engine Timer, keeps track of time

void initializeEngine()
{
    system("MODE CON:COLS=80 LINES=25");
    system("COLOR 0A");
    printScreen();
    for(;;) //
    {
        Sleep(33);
        eTimer++;
    }
}

// END: Game Logic Defines

int main()
{
    initializeEngine();
} 
```

![](../Images/88aca52ea15e0d249f223bd3b8344dcd.png)

为什么我的输出中有这个笑脸？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T20:50:03.047

我遇到过这种情况。这是因为您正在打印带有 ascii 代码 1 或 2 的字符。

在这种特殊情况下，我怀疑这是因为您的字符串不是以 NULL 结尾的 - [您的字符串中有 80 个字符，您的“填充”长度为 80 个字符。把它改成81，一切都会好很多。

# php - 在 SQL 中插入多行

> ID：14666347
> 
> 赞同：1
> 
> 时间：2013-02-02T20:46:08.960
> 
> 标签：php, mysql, sql, performance

性能相关：

进行 1000 次查询以插入 1000 行是否更好：

```
 for($i=1;$i<=1000;++$i){
         $query = 'insert into table1 (First,Last) values ("Fred","Smith")';
         mysql_query($query);
    } 
```

或者使用 PHP（通过在 for 循环中连接值）创建查询，如下所示：

```
 $query = ' insert into table1 (First,Last) values ("Fred","Smith"),
      ("John","Smith"),
      ...
      ("Michael","Smith"),
      ("Robert","Smith")';
   mysql_query($query); 
```

鉴于可能有很多值，我选择一次插入 10 个。我不知道这是否可以，在这种情况下最好的做法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:47:23.027

第二个更好。连接到数据库的成本很高。

换一种说法，什么更快？进行 1,000 次旅行以送出 1,000 个箱子还是一次旅行以送出 1,000 个箱子？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:49:47.410

[我想这个问题在官方网站上](http://dev.mysql.com/doc/refman/5.1/en/insert-speed.html)已经得到了很好的回答：

> 如果您同时从同一个客户端插入多行，请使用带有多个 VALUES 列表的 INSERT 语句一次插入多行。这比使用单独的单行 INSERT 语句要快得多（在某些情况下快很多倍）。

不过，我建议整个页面，因为它列出了优化多插入（针对不同类型的引擎）的几种策略。然而在最后它提到...

> 加载数据时 INSERT 仍然比 LOAD DATA INFILE 慢得多，即使使用刚刚概述的策略也是如此。

...这是非常正确的：如果您需要将一些巨大的（但静态的）数据集加载到数据库中，请改用[**LOAD DATA INFILE**](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:48:14.523

第二个更好，你可以控制它，第一个你没有太多控制插入不同的值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:51:28.227

其简单，批量处理的成本低于一一处理。这都是关于成本开销的，这里是性能方面的资源。

# javascript - 具有动态宽度和高度项的 Jquery Masonry

> ID：14666352
> 
> 赞同：0
> 
> 时间：2013-02-02T20:46:56.040
> 
> 标签：javascript, jquery, css, jquery-masonry

您好，我的博客上有一个网格（在单击项目时，我添加了一些调整项目大小的类），但是砌体没有调整大小并且项目搞砸了。

这是一个工作示例： http: [//nemaworkshop.com/The-Smith](http://nemaworkshop.com/The-Smith)

```
$('#featured-page').masonry({
  itemSelector: '.dbnMWLI '
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:14:33.337

调整元素大小后，只需调用`$('#featured-page').masonry('reload')`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-10T13:17:28.307

接受的答案中的代码对我不起作用。我收到了这个错误：

```
no such method 'reload' for masonry instance 
```

但是以下代码对我有用：

```
$('#featured-page').masonry(); 
```

# c++ - 组合类 C++ 中的冗余代码

> ID：14666353
> 
> 赞同：4
> 
> 时间：2013-02-02T20:47:00.863
> 
> 标签：c++, oop, inheritance, object-composition, object-design

我正在尝试学习 C++。一切都很顺利，直到我的“练习”计划遇到了很小的障碍。我相信，这个障碍源于设计问题。

想想二十一点（21）。我做了几节课。

1.  卡片
2.  甲板
3.  手
4.  播放器

一个甲板由 - 为简单起见 - 有一系列卡片组成。
-它可以显示所有卡片
-它可以洗牌
-它可以移除卡片

一手牌就是一副牌——它的好处是
——它可以计算它的手牌价值
——它可以把牌加到手上

现在来解决我的问题 - 播放器设计

-A Player Has A hand (private access)
我对玩家的问题是，那只手有一个名为 addCardToHand 的方法函数。如果我必须创建一个名为 addCardToHand(Card c) 的 Player 方法，在该方法中调用并传递给同一方法，我会感到一种冗余/糟糕的设计。

或者

将 Hand h 声明为可公开访问的成员，并在“main()”中执行类似于
Player p 的操作；
卡卡；
phaddCard（卡片）；

任何建议都会很有启发性并受到高度赞赏。请记住，我正在学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:14:48.577

这里最好的答案是：这取决于:) 不过，我会尝试澄清一下。

第一个问题是：Player 类有没有内部逻辑？如果是 Hand 的简单容器，我会简单地写`Player.GetHand().AddCard()`，因为没有理由重复`Player.AddCard()`方法内部的代码，问题就解决了。

*现在*让我们假设，需要实现额外的逻辑来将一张牌添加到玩家的手上。这意味着，在将牌添加到手牌时，必须调用 Player 类中的附加代码。在这种情况下，我看到了三种可能的解决方案。

（来源仅用于演示目的，可能无法编译）

*   限制对 Hand 的访问，这样任何人都无法从 Player 中检索它。玩家必须实现 AddToHand、RemoveFromHand 等方法。可行，但使用起来不舒服。

    ```
    class Player
    {
    private:
        Hand hand;

    public:
        void AddToHand(Card & card) 
        { 
            hand.Add(card); 
        }
    }; 
    ```

*   使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern "观察者模式")。当用户（类用户）调用 Player.GetHand().AddCard() 时，Hand 会通知 Player，数据已更改，并且 Player 可以采取相应的行动。您可以使用 C++11 中的 std::function 轻松实现这一点来实现事件。

    ```
    class Deck
    {
    private:
        std::function<void(void)> cardsChanged;

    public:
        void Add(Card card)
        {
            // Add a card
            if (!(cardsChanged._Empty()))
                cardsChanged();
        }

        void SetCardsChangedHandler(std::function<void(void)> newHandler)
        {
            cardsChanged = newHandler;
        }
    };

    // (...)

    class Player
    {
    private:
        Hand hand;

        void CardsChanged() { ... }
    (...)
    public:
        Player()
        {
            hand.SetCardsChangedHandler([&this]() { this.CardsChanged(); } );               
        }
    }; 
    ```

*   使用所有必要的接口方法定义 IHand 接口。Hand 显然应该实现 IHand 并且 Player.GetHand() 应该返回 IHand。诀窍是，Player 返回的 IHand 不一定必须是 Hand 实例，而是可以是充当用户和真实 Hand 实例之间桥梁的装饰器（请参阅[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern "装饰图案")）。

    ```
    class IHand
    {
    public:
        virtual void Add(Card card) = 0;
        virtual void Remove(Card card) = 0;
    };

    class Hand : public IHand
    { 
        // Implementations
    }

    class PlayersHand : public IHand
    {
    private:
        Hand & hand;
        Player & player;

    public:
        PlayersHand(Hand & newHand, Player & newPlayer)
        {
            hand = newHand;
            player = newPlayer;
        }

        void Add(Card card)
        {
            hand.Add(card);
            player.HandChanged();
        }

        // ...
    };

    class Player
    {
    private:
        Hand hand;
        PlayersHand * playersHand;

    public:
        Player()
        {
            playersHand = new PlayersHand(hand, this);
        }

        IHand GetHand()
        {
            return playersHand;
        }
    } 
    ```

就个人而言，在第二种情况下，我会选择第二种解决方案 - 它非常简单，易于扩展和重用，以防进一步需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:17:10.490

函数调用转发是一种常见的做法。您应该将其视为添加某种程度的抽象。这不是再次做同样的事情（冗余意味着），而是使用另一种方法实现一种方法。

您可以想象将来会进行一些修改，例如添加`Player`卡片缓存，或者在用户调用时需要更新的其他内容`addCardToHand`。如果你没有实现转发方法，你会在哪里添加缓存更新代码？

另请注意，这些函数的“接口”`Player::addCardToHand`不需要与`Card::addCard`参数相同，返回值可以不同。`Player`也许在这种情况下它不是那么重要，但通常转发功能是可以在' 接口和' 接口之间添加一些翻译的地方`Hand`。

# ubuntu-12.04 - Ubuntu 12.04 ruby 包安装错误

> ID：14666357
> 
> 赞同：2
> 
> 时间：2013-02-01T16:46:36.403
> 
> 标签：ubuntu-12.04, ruby, deployment, rvm

我正在尝试将 rails 应用程序部署到我的 Ubuntu 服务器。我已经安装了`rvm`，现在我正在尝试使用`bundler`它来部署我的应用程序。

但是我得到了这个：

```
/usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': Permission denied - /myroot/repos/myapp/.bundle (Errno::EACCES) 
```

首先，什么用户正在执行整个`rvm`命令？我的意思是我的路径中有`rake`等`bundle`，但我不确切知道哪个用户正在执行它们。

作为第一个意图，我尝试更改文件`/myapp`夹内所有文件的权限。给他们`root:rvm`，但没有运气。

现在，如果我尝试将 bundle 命令作为`sudo`（或者实际上是任何 ruby​​ 命令）运行，我会收到类似于以下错误的错误：

```
/usr/local/rvm/gems/ruby-1.9.3-p374@global/bin/ruby_noexec_wrapper 
```

因此，稍微解释一下包装器是什么以及为什么找不到 ruby​​ 将有助于我理解这种错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:15:18.877

建议不要使用`sudo`for`rvm`和`ruby`任何 RubyGems 安装命令，因为`sudo`默认情况下会丢失用于配置 RVM / Ruby / RubyGems 的环境变量。

如果你真的需要使用`sudo`- 继续使用`rvmsudo`- 但我需要警告你它会提升暴露系统的权限，这是一个安全风险。

# django - 推送到 Heroku 时如何停止覆盖目录

> ID：14666361
> 
> 赞同：0
> 
> 时间：2013-02-02T20:47:20.553
> 
> 标签：django, git, heroku, directory

这似乎很简单，但我找不到解决方法。我在 heroku 上有一个 django 应用程序。我使用 heroku 作为暂存环境。我的应用程序使用`media`从管理页面上传的图像和文件的目录。

当我`git push heroku master`销毁这个目录时，即使它没有添加到 repo 中。

我怎样才能阻止这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:04:31.480

Heroku 不提供持久存储。

在`git push`你的代码被转换成一个*slug*然后它被分发到你的应用程序运行的 dyno。有关详细信息，请参阅[https://devcenter.heroku.com/articles/slug-compiler](https://devcenter.heroku.com/articles/slug-compiler)。

如果您想要持久存储，您应该将您的应用程序与 AWS S3（简单存储服务）或其他一些服务集成。

# php - Zend Framework 2 phpunit 使用连接测试表

> ID：14666362
> 
> 赞同：6
> 
> 时间：2013-02-02T20:47:20.693
> 
> 标签：php, phpunit, zend-framework2

我使用了 Zend Framework 2 文档中的专辑示例并创建了一个应用程序。

现在，在使用它进行单元`phpunit`测试时，我在测试具有`join`with say table的表时遇到了问题`Account_Type`。

这是它的代码。

`fetchAll`功能是

```
function fetachAll()
{
    $sql = new Sql($this->tableGateway->getAdapter());

    $select = $sql->select();

    $select->from('Album')
           ->columns(array('id', 'name', 'account_type_id', 'managing_account_id'))
       ->join(array('AT' => 'account_type'), 'album.account_type_id = AT.account_type_id');

    $resultSet = $this->tableGateway->selectWith($select);

    return $resultSet; 
} 
```

上表的单元测试代码是。

```
public function testFetchAllReturnsAllAlbums()
{
    $resultSet= new ResultSet();

    $mockTableGateway = $this->getMock(
        'Zend\Db\TableGateway\TableGateway', 
        array('select'), 
        array(), 
        '', 
        false
    );    

    $mockTableGateway->expects($this->once())
                     ->method('select')
                     ->with()
                     ->will($this->returnValue($resultSet));

    $albumTable = new AlbumTable($mockTableGateway);

    $this->assertSame($resultSet, $albumTable->fetchAll());
} 
```

我收到错误这个错误

```
Argument 1 passed to Zend\Db\Sql\Sql::__construct() must be an instance of
Zend\Db\Adapter\Adapter, null given, 
```

对于这一行`$this->assertSame($resultSet, $albumTable->fetchAll());`方法`testFetchAllReturnsAllAlbums`。

如果有人为加入做过phpunit测试，请提供一个相同的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T05:15:49.657

您可能想模拟对象的`getAdapter`方法`Zend\Db\TableGateway\TableGateway`。调用此方法并将其返回值传递给`Zend\Db\Sql\Sql`构造函数。

# ruby-on-rails - RoR 词汇测验应用程序可扩展性

> ID：14666365
> 
> 赞同：0
> 
> 时间：2013-02-02T20:47:45.067
> 
> 标签：ruby-on-rails, ruby

我正在用 ruby​​/rails 设计一个词汇测验应用程序。我有可以工作的基本模型/关联设置，但我担心可扩展性。应用程序中会有一定数量的单词。为简单起见，假设为 100。用户将能够继续提出一个问题，该问题将通过查看他们之前提出的问题而生成。该问题将为定义提供一个单词和 4 个选项（一个是定义，其他三个定义是随机选择的）。

这是我目前建立模型和关联的方式；

```
class User < ActiveRecord::Base
  has_many :user_questions
end

class UserQuestion < ActiveRecord::Base
  belongs_to :user
  belongs_to :vocab_word
end

class VocabWord < ActiveRecord::base
  has_many :user_question
end 
```

假设我要保留这个基本模型，我应该使用以下哪种方法？

1.  为每个用户设置一定数量的 UserQuestion 对象 (100)，并使用计算列来存储用户在特定单词上的表现的统计信息。（例如，用户 502 尝试了 3 次“干旱”这个词并且正确回答了 2 次）。
2.  对于每个问题尝试，创建一个新的 UserQuestion 对象。（例如，用户 502 试图猜测“干旱”但不正确）

这些方法中的任何一种都可以扩展吗？如果应用程序有 100 万用户，第一个策略将在 user_questions 中有 1 亿行。第二个可能不止于此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:09:27.167

您快到了。我建议您使用以下内容扩展您的模型，并对 UserQuestion 和用户关联进行轻微修正。

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :user_questions
end

class UserQuestion < ActiveRecord::Base
  has_and_belongs_to_many :users
  belongs_to :vocab_word
end

class VocabWord < ActiveRecord::base
  has_many :user_question
end

class Attempt < ActiveRecord::base
  belongs_to :vocab_word
  belongs_to :user
  belongs_to :user_question

  attr_accessible :result
end 
```

您需要一个 user_questions_users 关联表才能在问题和用户之间建立多对多关联。我相信它将是可扩展的。确保正确设置索引。

# php - 字符串保存在数据库中时被转义（mysql）

> ID：14666367
> 
> 赞同：0
> 
> 时间：2013-02-02T20:47:49.670
> 
> 标签：php, mysql, symfony

在我的网站中，我有一个表单来输入有关产品的一些信息，如果我在字符串中使用一些引号，它们会以空格字符保存在数据库中。
例如，如果我`He's fun`在表单中输入，我将进入数据库：`He\'s fun`这很烦人，因为在我看来，字符串呈现为`He\'s fun`

我不明白，因为在我的本地环境中我没有这个问题，字符串`He's fun`将存储`He's fun`在我的 mysql DB 中。

我能做些什么来避免这个逃避问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T07:51:41.217

由于@hek2mgl 注释关闭了服务器上我的 .htaccess 文件中的 magic_quotes_gpc 函数，我已经解决了这个问题。

对我来说，我必须这样写：`php_value magic_quotes_gpc Off`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:53:53.560

```
/**
 * @Route("/")
 * @Template()
 */
public function indexAction(){

   $var = stripslashes('He\'s fun');

   return array('var' => $var);
} 
```

# java - 在 Struts2 中，如何在 URL 中不出现参数的情况下进行永久重定向（状态码 301）

> ID：14666370
> 
> 赞同：3
> 
> 时间：2013-02-02T20:48:13.783
> 
> 标签：java, redirect, struts2, http-status-code-301

我有一个 Struts2（2.2.3 版）网络应用程序。我正在尝试将旧链接重定向到新页面。我知道我可以通过

```
 <action name="old-action" class="MVRActionClass">
        <result type="redirectAction">
            <param name="actionName">new-action</param>
            <param name="namespace">/new-action-namespace</param>
            <param name="statusCode">301</param>
        </result>
    </action> 
```

但这会`statusCode=301`在最终重定向的 url 中添加一个参数。我不希望这种情况发生。所以我实施了一些其他方法，但没有成功。

例如，在从动作返回之前，我尝试`status`在响应对象中设置 -

```
@Override
public String execute() {
    ...     
    ((HttpServletResponse) response).setStatus(301);
    return SUCCESS;
} 
```

这没有用。我仍然获得链接的 302 状态。然后我创建了一个拦截器并像这样向它添加了一个 PreResultListener -

```
public class MyInterceptor extends AbstractInterceptor {

@Override
public String intercept(ActionInvocation invocation) throws Exception {

  invocation.addPreResultListener(new PreResultListener() { 
    @Override
    public void beforeResult(ActionInvocation invocation, String resultCode) {

      try {
    ActionContext actionContext = invocation.getInvocationContext();

    HttpServletResponse response = (HttpServletResponse).actionContext.get(StrutsStatics.HTTP_RESPONSE);

     response.setStatus(301);
     actionContext.put(StrutsStatics.HTTP_RESPONSE, response);

      } catch(Exception e) {
        invocation.setResultCode("error");
      }
    }
  });

  // Invocation Continue
      return invocation.invoke();
    }
  }
} 
```

即使这样也没有用。我仍然获得链接的 302 状态。

我也看了看`redirect type=httpheader`。但我不认为这正是我想要的。因为我需要发送 301 以及 redirectedTo 页面的内容，即新链接。

有一些提到子类化`org.apache.struts2.dispatcher.ServletActionRedirectResult`，然后添加`statusCode`到禁止列表中。但我不知道如何`RedirectResult`在工作流程中注入这个自定义。

任何帮助表示赞赏。

**更新** [我已经在下面发布了答案。](https://stackoverflow.com/a/14693816/131315)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:05:23.327

在结果处理过程中，它看起来`statusCode`没有从参数列表中删除。

要使用您*自己的*结果类型，只需将其定义为任何其他结果类型并使用它来代替`redirectAction`. 这在[结果配置文档](http://struts.apache.org/2.x/docs/result-configuration.html)中进行了讨论。您应该能够覆盖`getProhibitedResultParams()`并添加`statusCode`到列表中。

IMO statusCode 应该在该列表中。已经有一张[JIRA 票了](https://issues.apache.org/jira/browse/WW-3389)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:13:44.913

如果有人和我有同样的问题，这就是我根据[戴夫的回答解决的](https://stackoverflow.com/a/14666512/131315)方法。

首先在您将调用此结果类型的包中声明结果类型。

```
 <result-types>
       <result-type name="premanentRedirectAction" 
                    class="management.dispatcher.ServletActionPermanentRedirectResult" />
    </result-types> 
```

然后像这样简单地定义结果类型 -

```
package management.dispatcher;
import java.util.List;
import org.apache.struts2.dispatcher.ServletActionRedirectResult;
import com.google.common.collect.Lists;

public class ServletActionPermanentRedirectResult extends ServletActionRedirectResult {

private static final long serialVersionUID = 4921150146065435746L;

@Override
protected List<String> getProhibitedResultParams() {
    List<String> prohibitedResultParams = Lists.newArrayList(super.getProhibitedResultParams());
    prohibitedResultParams.add("statusCode");

    return prohibitedResultParams;
   }
   } 
```

然后如果旧操作具有以下映射，则无论您想使用 301 重定向到哪里 -

```
 <action name="media-coverage">
        <result type="premanentRedirectAction">
            <param name="actionName">press</param>
            <param name="namespace">/</param>
            <param name="statusCode">301</param>
        </result>
    </action> 
```

# variables - 接受用户输入的变量

> ID：14666379
> 
> 赞同：2
> 
> 时间：2013-02-02T20:49:09.727
> 
> 标签：variables, input, forth

因此，对于以前使用过 FORTH 的任何人来说，这应该是一个简单的问题，但我是一个试图学习如何编写这种语言的新手（这与 C++ 有很大不同）。

无论如何，我只是想在 FORTH 中创建一个名为“Height”的变量，并且我希望用户能够在调用某个单词“setHeight”时为“Height”输入一个值。但是，我尝试的一切似乎都失败了，因为我不知道如何设置变量，也不知道如何获取用户输入并将其放入变量中。

```
 VARIABLE Height 5 ALLOT
    : setHeight 5 ACCEPT ATOI CR ; 
```

我希望这是一个容易解决的问题，任何帮助将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T09:00:14.847

查看[FORTH 中字符串或数字输入的](http://rosettacode.org/wiki/User_input/Text#Forth)[Rosettacode](http://rosettacode.org/wiki/Rosetta_Code)输入/输出示例：

**字符串输入**

```
: INPUT$ ( n -- addr n )
   PAD SWAP ACCEPT
   PAD SWAP ; 
```

**数字输入**

```
: INPUT# ( -- u true | false )
  0\. 16 INPUT$ DUP >R
  >NUMBER NIP NIP 
  R> <> DUP 0= IF NIP THEN ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T22:55:08.113

自我教育需要记住的重要一点——C++ 是大量类型转换的，而 Forth 则完全相反。您希望高度是字符串、整数还是浮点数，它是有符号的还是无符号的？每个都有自己的用例。无论您选择什么，都必须牢记您选择的类型与 Height 变量进行交互。每次都想想你的比特意味着什么。

从您的 ATOI 调用来看，我假设您希望将 Height 的值作为整数。不过，一个 5 字节的整数是不寻常的，所以我仍然不确定。但这里有这个假设：

```
VARIABLE Height 1 CELLS ALLOT
VARIABLE StrBuffer 7 ALLOT

: setHeight ( -- )
  StrBuffer 8 ACCEPT
  DECIMAL ATOI Height ! ; 
```

CELLS 调用确保您创建的变量具有您的 CPU 喜欢的位数。DECIMAL 调用确保您没有在 ATOI 之前的某个地方更改为 HEX。

创建 StrBuffer 变量是获得字符串暂存空间的众多方法之一。假设您的 CELL 是 16 位的，那么对于一个以零结尾的 16 位有符号整数，您最多需要 7 个字符——例如，“-32767\0”。一些实现有 PAD，可以用来代替创建自己的缓冲区。另一个常用词是 SCRATCH，但我不认为它按我们想要的方式工作。

如果您坚持创建自己的字符串缓冲区空间，我个人喜欢这样，因为您确切知道自己获得了多少空间，那么请考虑为所有单词的字符串处理需求创建一个大缓冲区。例如：

```
VARIABLE StrBuffer 201 ALLOT 
```

这也使您不必做出 16 位 CELL 假设，因为 200 个字符很容易容纳 64 位有符号整数，以防您现在或将来某天实现的 CELL 大小。

# ios - Ios 在裁剪某些部分后拍摄屏幕快照

> ID：14666380
> 
> 赞同：1
> 
> 时间：2013-02-02T20:49:16.807
> 
> 标签：ios, image, crop

是的，正如标题所说，我需要对我的应用进行裁剪快照。

我想稍微切掉屏幕截图的顶部（％20）我已经有一个代码，我用来拍摄快照并将其发送到 Facebook 并且它正在工作，但是它拍摄了所有屏幕的照片，所以如何告诉我的代码忽略屏幕的 %20%。也许还有高度和宽度我在堆栈溢出中查看了一些问题并设法滑动我的屏幕截图，所以我摆脱了顶部不需要的部分，但这次是在底部巨大的白色区域出现所以它没有解决我的问题。

这是我的快照代码

```
UIGraphicsBeginImageContext(self.ekran.bounds.size);
    [self.ekran.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *resultingImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:24:58.570

一种裁剪图像的方法，它接受任何帧来裁剪图像

```
- (UIImage *)cropImage:(UIImage *)imageToCrop toRect:(CGRect)rect
    {    
        CGImageRef imageRef = CGImageCreateWithImageInRect([imageToCrop CGImage], rect);
        UIImage *cropped = [UIImage imageWithCGImage:imageRef];
        CGImageRelease(imageRef);

        return cropped;
    } 
```

按如下方式使用它：

```
UIGraphicsBeginImageContext(self.ekran.bounds.size);
[self.ekran.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *resultingImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

CGFloat imgHight = resultingImage.size.height;

// Create a frame that crops the top 20% of the image
CGRect* imageFrame = CGRectMake(0, imgHight -  (imgHight*0.8), width, imgHight*0.8);

resultingImage = [self cropImage:resultingImage toRect:imageFrame]; 
```

# ruby - 用于就地多行正则表达式替换的 Shell 命令

> ID：14666381
> 
> 赞同：3
> 
> 时间：2013-02-02T20:49:25.737
> 
> 标签：ruby, regex

使用单行正则表达式，您可以使用`-p`and `$_.sub!`：

```
$ cat file.txt
<a
a>
c
$ ruby -i -pe '$_.sub!("a", "b")' file.txt
$ cat file.txt
<b
b>
c 
```

有没有什么捷径可以代替多线模式？我目前使用这样的东西：

```
$ ruby -i -e 'print *readlines.join.sub(/<.*>/m, "d")' file.txt
$ cat file.txt
d
c 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:44:59.757

使用`gets(nil)`可以为您节省多达 6 个字符 :)

```
ruby -i -e 'print gets(nil).sub(/<.*>/m, "d")' file.txt 
```

从`gets` [文档](http://apidock.com/ruby/Kernel/gets)：

> > 可选参数指定记录分隔符。分隔符包含在每条记录的内容中。nil 的分隔符读取整个内容。[...]

# css - 如何在 CSS 中将两个 div 并排放置？

> ID：14666384
> 
> 赞同：1
> 
> 时间：2013-02-02T20:49:47.823
> 
> 标签：css

我想将两个 div 并排放置，但无论我做什么，第二个 div 总是在第一个 div 之下的某个地方结束。我努力了：

```
div.one {
width:50%;
float:left;
}

div.two {
width:50%
float:right;
margin-left:50%;
} 
```

和

```
div.one {
width:50%;
display:inline-block;
}

div.two {
width:50%;
display:inline-block;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:51:40.757

从您的第一个示例中，尝试删除边距。

```
div.one {
   width:50%;
   float:left;
}

div.two {
    width:50%
    float: left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:21:12.583

```
#div-1a {
position:absolute;
top:0;
right:0;
width:200px;
}
#div-1b {
position:absolute;
top:0;
left:0;
width:200px;
} 
```

这是一个很棒的教程的链接，它为您提供了几个定位示例：[http ://www.barelyfitz.com/screencast/html-training/css/positioning](http://www.barelyfitz.com/screencast/html-training/css/positioning)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:56:22.713

两者都应该是“浮动：左；”

元素必须适合 - 当有边框、边距或内边距时，“width:50%;” 可能太高了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:00:37.323

```
.one {
    width: 50%;
    float: left;
    background: green;
    height: 100px;
}

.two {
    width: 50%;
    float: right;
    height: 100px;
    background: red;
} 
```

[http://jsfiddle.net/qf9GD/](http://jsfiddle.net/qf9GD/)

# xcode - 实现自定义标签栏后，MWPhotoBrowser 中的分页无法正常工作

> ID：14666389
> 
> 赞同：0
> 
> 时间：2013-02-02T20:49:58.943
> 
> 标签：xcode, uitabbarcontroller, uipageviewcontroller, mwphotobrowser

我在一个项目中使用[MWPhotoBrowser](https://github.com/mwaterfall/MWPhotoBrowser)并且一切都很好，直到我实现了一个自定义选项卡栏（使选项卡项目之一更高更宽）。我使用[RXCustomTabBar](https://github.com/rumex/RXCustomTabBar)作为我的标签栏的起点，只对其进行了一些修改，但没有任何有意义的更改。

实施新标签栏并在应用程序中打开 MWPhotoBrowser 后，我只能查看第一张照片。我仍然可以在照片浏览器中滚动，但没有显示除第一张照片之外的其他照片。当我不查看第一张照片时，我也不能切换在 MWPhotobrowser 中实现的“fullScreenLayout”。

我很困惑，因为我不知道是什么导致了这个问题。我知道这是一个牵强附会的问题，因为它是我正在使用的两个定制库，但也许有人在过去遇到过类似的问题。将非常感谢您的建议！

这是我用来推送 MWPhotoBrowser 的代码：

```
MWPhotoBrowser *browser = [[MWPhotoBrowser alloc] initWithDelegate:self];
[self.navigationController pushViewController:browser animated:YES]; 
```

我尝试以模态方式呈现浏览器：

```
[self.navigationController presentModalViewController:browser animated:YES]; 
```

这样照片可以正确显示，但我没有导航栏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T14:31:03.233

经过数小时的头痛后，我想出了一个解决方案：

```
MWPhotoBrowser *browser = [[MWPhotoBrowser alloc] initWithDelegate:self];
[browser setInitialPageIndex:indexPath.item];
UINavigationController *navBar = [[UINavigationController alloc] initWithRootViewController:browser];
[self.navigationController presentModalViewController:navBar animated:YES]; 
```

即，我创建了一个 UINavigationController，在其中嵌入了我的 MWPhotoBrowser，然后以模态方式呈现导航控制器。

# java - 使用局部变量与字段对 GC 的影响

> ID：14666396
> 
> 赞同：4
> 
> 时间：2013-02-02T20:50:32.220
> 
> 标签：java, android, dalvik

我在 onDraw() 方法的调用堆栈中有一个方法 3 级。每次重绘被称为数百次，有时甚至数千次。我已经对 onDraw() 方法进行了广泛的分析，我可以看到以下方法占总数的 14%，因此绝对值得一看。我需要在捏缩放和拖动操作期间提高帧速率。

```
private void getVisiblePointsFromPath(){

   double longRads = longitude * (Math.PI / 180);
   double latRads = latitude * (Math.PI / 180);

   ...

} 
```

当方法退出并且双打超出范围时，我假设它们有资格进行 GC，尽管我认识到这可能发生的时间是不确定的。

这样做有什么好处吗：

```
public class GisView extends ImageView{

    private double longRads;
    private double latRads;

    private void getVisiblePointsFromPath(){

       longRads = longitude * (Math.PI / 180);
       latRads = latitude * (Math.PI / 180);

       ...

    }

} 
```

我假设这个习惯用法会导致双打被清空，然后在每次传递时重新分配，但不会导致额外的垃圾，从而减少我造成的 GC 数量。还是虚拟机比这更聪明？

请注意，我的问题本身并不是“哪个更快”，而是关于哪个可能导致更少的 GC。我可以测量速度差异，但我对 Dalvik VM 和 Android GC 的了解还不够，无法预测哪个会导致更少的垃圾。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T20:52:04.033

> 我假设这个习惯用法会导致双打被清空，然后在每次传递时重新分配，但不会导致额外的垃圾，从而减少我造成的 GC 数量。还是虚拟机比这更聪明？

[原始局部变量存在于堆栈上](https://softwareengineering.stackexchange.com/a/65289/1845)，而不是堆上，因此它们根本不需要进行 GC。一旦函数返回，它们就会有效地消失——因为这会清除堆栈帧。

也就是说，是的，每次传递*都会*重新分配双打，因为这就是您编写的代码所说的。如果您想提高此特定方法的速度，请*计算`longRads`and `latRads`when `longitude`and `latitude`are set*。正确的做法是**始终**将这些字段的设置委托给 setter 方法。例如：

```
public void setLongitude(double longitude) {
    this.longitude = longitude;
    this.longRags = longitude * (Math.PI / 180);
} 
```

当然，这会使设置速度变慢，但这不是您所要求的优化。

# java - 在最后一行读取键盘输入时扫描仪的奇怪行为

> ID：14666399
> 
> 赞同：0
> 
> 时间：2013-02-02T20:50:48.917
> 
> 标签：java, java.util.scanner

使用 读取键盘输入时`Scanner(System.in)`，程序在我输入的最后一行停止，只有在我按下`enter`输入控制台后它才会继续工作。

例如，如果我想读这个

```
3
f
g
h 
```

相反，我得到

```
3
f
g

h 
```

我的程序很简单，

```
public static void main(String[] args) {
    // TODO Auto-generated method stub
    Scanner sc = new Scanner(System.in);
    int count = sc.nextInt();
    sc.nextLine();
    System.out.println("\n"+count);
    while(count>0) {
        System.out.println(sc.nextLine());
        count--;

    }
} 
```

我无法理解发生了什么。我会感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:58:35.923

我有一段时间没有使用扫描仪了，但我希望这会很有用：

```
String string;
java.util.Scanner mainScanner = new java.util.Scanner(System.in);
while( mainScanner.hasNextLine() )
{
    string = mainScanner.nextLine();
    // use string
} 
```

# javascript - 存在元标记时，HTML5 Canvas 不显示图像

> ID：14666413
> 
> 赞同：1
> 
> 时间：2013-02-02T20:52:25.190
> 
> 标签：javascript, android, ios, mobile, canvas

HTML5 画布（仅使用 drawImage 函数）未显示在移动设备上，但在我的笔记本电脑上。

我没有收到任何错误或任何错误，但它不会显示在 iOS 上的 chrome 或 android 上的默认浏览器中。

仅当文档中包含以下元标记时才会出现此问题：

```
<meta name="viewport" content="width=device-width, initial-scale=1"></meta> 
```

带有元标记：[mmhudson.com/index.html](http://mmhudson.com/index.html)

没有：[mmhudson.com/index1.html](http://mmhudson.com/index1.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T01:46:40.697

这两个页面之间的区别不仅仅是元标记。

具体来说，带有元标记的那个没有**事件**`ontouchstart`。

# c - 带有野牛的逗号分隔值的语义

> ID：14666414
> 
> 赞同：0
> 
> 时间：2013-02-02T20:52:29.693
> 
> 标签：c, bison, flex-lexer

我正在尝试为逗号分隔值列表赋予语义值。事实上，我已经定义了野牛使用的减少规则

```
commasv : exp
        | commasv "," exp 
```

其中`exp`它是一个数字或一个变量或一个函数指针，或者还有一个带有其各自语法和语义规则的逗号标记。的类型`exp`是双精度的，所以类型`commasv`必须是双精度的。

问题是我想存储列表以便使用它，例如，在函数调用中。例如

```
h = create_object()
compute_list(h,1,cos(3.14159)) 
```

将给出某个`compute_list`函数的预期结果。

作为基础野牛文件，我使用了[bison 手册](http://www.gnu.org/software/bison/manual/bison.html#Multi_002dfunction-Calc)中的 mfcalc 示例，并将该函数替换为[使用 flex](https://gist.github.com/4699166)`yylex`生成的其他函数。现在我可以做类似的事情

```
pi = 3.14159
sin(pi)
ln(exp(5)) 
```

使用带有 flex的函数的修改版本，`yylex`但我想在函数调用、列表创建等中使用逗号分隔的值。

感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:00:08.697

然后创建一个列表来存储结果。与其让`commasv`规则的结果返回一个实际值，不如让它返回列表头。

一般来说，一旦你获得了某种中等高级的语法（比如它结合了列表之类的东西），你就不能再真正使用值来表示解析，而必须转向某种[抽象语法树](http://en.wikipedia.org/wiki/Abstract_syntax_tree)。

# templates - 如何将模型传递到 MVC 4 中的模板中？

> ID：14666415
> 
> 赞同：0
> 
> 时间：2013-02-02T20:52:31.173
> 
> 标签：templates, asp.net-mvc-4, model

我正在尝试在 MVC 4 中执行以下操作：

```
@Html.DisplayFor(x => x, "QCDetailDepartmentTable-ActionButton") 
```

当我单步执行代码时，它完全绕过了模板并且不会显示任何内容。

但是，如果我将其替换为模型中的字段，例如：

```
@Html.DisplayFor(x => x.SortOrder, "QCDetailDepartmentTable-ActionButton") 
```

它工作得很好。

我简单的模板文件有：

```
<td>hi</td> 
```

任何想法为什么试图通过模型不起作用？

# javascript - 用dat.GUI设置三个js中的一个对象的颜色选择颜色

> ID：14666417
> 
> 赞同：3
> 
> 时间：2013-02-02T20:52:47.763
> 
> 标签：javascript, three.js, dat.gui

如何在三个 js 的一个对象中使用[dat.gui设置颜色](http://code.google.com/p/dat-gui/)

我想用对话框选择颜色，比如[本例中的框 3](http://www.jaanga.com/2012/10/using-threejs-with-datgui-user.html)

这个怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:32:12.957

我制作了以下功能以使用选择器颜色更改颜色

```
function cambiarColor( obj )
{
    var gui = new dat.GUI();

    var Configuracion=function(){
            this.color = "#ffae23";
    }
    var conf = new Configuracion();

    var controlador = gui.addColor( conf, 'color');
    controlador.onChange( function( colorValue  )
    {
      //the return value by the chooser is like as: #ffff so
      //remove the # and replace by 0x
      colorValue=colorValue.replace( '#','0x' );
      //create a Color
      var colorObject = new THREE.Color( colorValue ) ;
      //set the color in the object
      obj.material.color = colorObject;
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-25T01:55:04.330

实现**Three.js**颜色或统一颜色到**dat.gui**的简单方法：

```
dat.GUI.prototype.addThreeColor=function(obj,varName){
    // threejs & dat.gui have color incompatible formats so we use a dummy data as target :
    var dummy={};
    // set dummy initial value :
    dummy[varName]=obj[varName].getStyle(); 
    return this.addColor(dummy,varName)
        .onChange(function( colorValue  ){
            //set color from result :
            obj[varName].setStyle(colorValue);
        });
};
dat.GUI.prototype.addThreeUniformColor=function(material,uniformName,label){
    return this.addThreeColor(material.uniforms[uniformName],"value").name(label||uniformName);
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-28T11:51:51.860

没有额外对象的简化版本：

```
var gui = new dat.GUI();

var conf = { color : '#ffae23' };    
gui.addColor(conf, 'color').onChange( function(colorValue) {
    obj.material.color.set(colorValue);
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T16:06:48.237

没有必要制作“新的 Three.Color”。我不确定这是否是一回事。试试下面的代码。它对我有用。

```
 function cambiarColor( obj )
{
    var gui = new dat.GUI();

var Configuracion=function(){
        this.color = "#ffae23";
}
    var conf = new Configuracion();

    var controlador = gui.addColor( conf, 'color');
    controlador.onChange( function( colorValue  )
    {
      //the return value by the chooser is like as: #ffff so
      //remove the # and replace by 0x
      colorValue=colorValue.replace( '#','0x' );
      //set the color in the object
      obj.material.color.setHex(colorValue);
    });
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T21:02:04.823

这个例子[http://jaanga.github.com/blode/#jaanga.github.com/Blode/DAT.GUI-User-Controls](http://jaanga.github.com/blode/#jaanga.github.com/Blode/DAT.GUI-User-Controls)不够好吗？

# ruby-on-rails - 如何在 rails3 中实现记住我的功能

> ID：14666418
> 
> 赞同：0
> 
> 时间：2013-02-02T20:52:48.133
> 
> 标签：ruby-on-rails

如何在 Rails 中实现记住我的功能。我正在使用 authologic gem 我的 UserSession 控制器的代码是：

请建议我如何使用任何参考来实现记住我。我已尝试使用此代码，但无法实现它。

```
class UserSessionsController < ApplicationController
    before_filter :require_no_user, :only => [:new, :create]
    before_filter :require_user, :only => :destroy
    def new
        @user_session = UserSession.new
    end

    def create
        @user_session = UserSession.new(params[:user_session],true)
        if @user_session.save
            flash[:notice] = "Login successful!"
            unless cookies[:last_visited].nil?
                set_last_visited
            end

            cookies.permanent[:last_visited] = Time.now
            if params[:remember_me]
                user = @user_session.user
            user.update_attributes(:remember_token => create_remember_token)
                cookies[:remember_token] = { :value => user.remember_token, :expires => 24.weeks.from_now }
            end
            redirect_back_or_default users_url(@current_user)
        else
            flash[:error]="invalid login and password"
            render :action => :new
        end
    end

    def destroy
    cookies.delete(:remember_token)
        current_user_session.destroy
        flash[:notice] = "Logout successful!"
        redirect_back_or_default home_path
    end

    private

    def create_remember_token
        SecureRandom.urlsafe_base64
    end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:12:24.073

你试过这种方法吗？

```
UserSession.create(:login => "yourusername", :password => "yourpassword", :remember_me => true) 
```

# php - 致命错误：在非对象上调用成员函数 fetch()

> ID：14666422
> 
> 赞同：0
> 
> 时间：2013-02-02T20:53:46.297
> 
> 标签：php, fatal-error

我在我的网站中为我的群组编写了以下代码..

```
public function set_group_id($group_id)
    {

        $db2        = & $this->network->db2;
        /* if( $this->id ) {
            return FALSE;
        } */
        if( ! $group_id ) {
            return FALSE;
        }
        if( ! $g = $this->network->get_group_by_id($group_id) ) {
            return FALSE;
        }
        if( !$g->is_public && $this->user->id>0 && !$this->user->is_network_admin ) {
            $users  = $this->network->get_group_invited_members($g->id);
            if( !$users || !in_array(intval($this->user->id),$users) ) {
                return FALSE;
            }
        }

         $D->i_am_network_admin  = ( $this->user->is_logged && $this->user->info->is_network_admin > 0 );
         $D->i_am_admin      = $D->i_am_network_admin;

         if( !$D->i_am_network_admin ) {
         $D->i_am_admin  = $db->fetch('SELECT id FROM groups_admins WHERE group_id="'.$g->id.'" AND user_id="'.$this->user->id.'" LIMIT 1') ? TRUE : FALSE;
         }

        if( $g->mojaz && !$this->user->i_am_admin  ) {
            return FALSE;
        }
        $this->group    = $g;
        $this->to_user  = FALSE;
        return TRUE;
    } 
```

我在这一行的错误...

```
 $D->i_am_admin  = $db->fetch('SELECT id FROM groups_admins WHERE group_id="'.$g->id.'" AND user_id="'.$this->user->id.'" LIMIT 1') ? TRUE : FALSE; 
```

我想为网站组创建限制器，如果用户是网站管理员，他可以发送帖子，或者如果用户是组管理员可以发送帖子，否则返回 false。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:14:13.860

在您的错误行中，$db 为空，因为您的函数set_group_id()**中没有声明 $db 。**
我只看到数据库对象**$db2**

```
$db2 =& $this->network->db2 
```

尝试将 $db 替换为 $db2。如果 $db2 包含正确的数据库对象和打开连接的句柄，它将起作用

# css - 在 CSS 中实现 SVG 图像文件的正确方法是什么？

> ID：14666424
> 
> 赞同：1
> 
> 时间：2013-02-02T20:54:03.950
> 
> 标签：css, svg, css-sprites, glyphicons

我有一个 SVG 文件，其中包含多个具有唯一 ID 的 SVG。

```
<g id="tags">
...
</g>
<g id="tags2">
...
</g> 
```

到目前为止，我已经尝试实现这两种方式，但没有成功。我尝试将其设置为背景位置。

```
.icon {
  background-image: url(/img/glyphicons_pro/glyphicons/svg/glyphicons.svg);
  background-repeat: no-repeat;
  background-size: 100%;
}

.icon.tags-icon {
  background-position: 0px 0px;
  width: 12px;
  height: 12px;
} 
```

我尝试在最后附加 SVG 的 ID，这似乎也不起作用。

```
.icon.tags-icon {
  background-image: url(/img/glyphicons_pro/glyphicons/svg/glyphicons.svg#tags);
  background-repeat: no-repeat;
  background-size: 80%;
} 
```

我一直在寻找几个小时，似乎无法找到正确的方法...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:21:46.173

假设不同的元素位于不同的位置，您可以使用[svg 片段标识符来显示不同的区域，例如](http://www.w3.org/TR/SVG/linking.html#SVGFragmentIdentifiers)`<g>`

```
<html>
<body>
<embed src="shapes.svg#svgView(viewBox(50,0,100,100))" style="width:100px;        height:100px" type="image/svg+xml" />
<embed src="shapes.svg#svgView(viewBox(0,200,100,100))" style="width:100px;height:100px" type="image/svg+xml"/> 
<embed src="shapes.svg#svgView(viewBox(0,400,100,100))" style="width:100px;height:100px" type="image/svg+xml"/>  
</body>
</html> 
```

上面的例子展示了嵌入，但这个想法同样适用于背景图像。

另一种方法是[SVG 堆栈](http://simurai.com/post/20251013889/svg-stacks)，它的工作原理是将所有图形叠加在一起，然后使用 CSS 显示您想要查看的图形。

# css - 子菜单对齐

> ID：14666425
> 
> 赞同：0
> 
> 时间：2013-02-02T20:54:15.277
> 
> 标签：css, drop-down-menu, navigation

我无法摆脱导航栏和子菜单下拉菜单之间的差距。您可以在[此处](http://martha-nutritionist.com/new/)查看问题。

我的CSS在这里：

```
nav#nav{
    float: left;
    font: 14px/16px 'MuseoSlab500Regular', arial, helvetica, sans-serif;
    margin-right: auto;
    z-index: 99999;
    /*background-image: url(../images/2blkbg.png);*/
    /*background-repeat: repeat-x;*/
    padding-left: 30px;
    /*background-position: left bottom;*/
    background-color: #000;
    height: 53px;
    display: block;
    position: relative;
    margin-top: 15px;
    margin-bottom: 15px;
    }
#nav ul{
    list-style: none;
    margin: 0;
    padding: 0;
}
#nav ul li{
    float: left;
    margin-right: 0;
    margin-bottom: 0;
    padding-top: 0;
    padding-right: 49px;
    padding-bottom: 0;
    padding-left: 0;
}
#nav ul a,#nav li.current-menu-ancestor a{
    display: block;
    height:83px;
    line-height: 53px;
    border-top-width: 0px;
    border-top-style: solid;
    border-top-color: #fff;
}
#nav ul .current_page_item a, #nav ul .current-menu-item  a, #nav ul > .current-menu-parent a{
    color:#a0ce4e;
    text-decoration:none;
    border-color:#a0ce4e;
}
#nav ul li{
    position: relative;
}
#nav ul ul{
    display: none;
    position: absolute;
    top: 0px;
    left: 0;
    width: 170px;
    background: #edebeb;
    z-index: 100000;
    border-top: 3px solid #a0ce4e;
    z-index: 99999;
}
#nav ul li:hover ul{
    display: block;
}
#nav ul li ul li{
    display: block;
    float: none;
    margin: 0;
    padding: 0;
    background-image: url(../images/blkbg.png);
    background-repeat: repeat-x;
}
#wrapper #nav ul li ul li a{
    background: url(../images/subnav_sep.jpg) repeat-x bottom left;
    border: 0;
    height: 30px;
    text-indent: 20px;
    font: 13px/30px 'PTSansRegular', Arial, Helvetica, sans-serif;
    color: #333333 !important;
}
#wrapper #nav ul li ul li a:hover,#wrapper #nav ul li ul li.current-menu-item a{
    background-color:rgba(255,255,255,0.5);
}
#nav ul ul ul{
    display:none !important;
}
#nav ul ul li:hover ul{
    display:block !important;
    top:-3px;left:170px;
}
#nav select{
    max-width:100%;
    display:none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:22:54.730

很好，您发布了网址，因为问题不在您包含的 css 中。问题出在这个类中：

```
#nav ul ul {
  top:86px;
} 
```

此顶部偏移量应设置为**53px**，与菜单栏 ( ) 的高度相同`nav#nav`：

```
#nav ul ul {
  top:53px;
} 
```

这个 css 类实际上*不在*您的 css 样式表中，而是在您的页面本身中。它包含在`<head></head>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:03:22.247

```
#nav > li > a,#nav li.current-menu-ancestor a {
  height:83px;
  line-height:83px;
}
#nav ul ul {
  top:86px;
} 
```

设置`top`and 将消除多余的间隙：

```
#nav ul ul {
  top:86px;
} 
```

# vb.net - 更改为发布并返回调试后，VB 项目未进入调试模式

> ID：14666426
> 
> 赞同：0
> 
> 时间：2013-02-02T20:54:22.110
> 
> 标签：vb.net, visual-studio, .net-1.1

我在 VB VS2003 中有一个项目，一切正常，直到我将其更改为发布，编译然后返回调试。现在我可以运行该项目，但它不会在任何断点处停止，我在不同的机器上尝试过，结果是一样的，我尝试过其他项目，一切正常

```
 <STAThread()> _
        Public Shared Sub Main()
            Dim splashWin As New Splash 'Here is one breakpoint and it never stop
            splashWin.Show()
            Application.DoEvents() 
```

注意：如果我按下 VS 上的全部中断（暂停）按钮，它会启动此错误：“无法中断执行。请等待调试对象完成加载，然后重试。” 但应用程序运行良好

# view - 在其他视图中使用pickerview信息？

> ID：14666429
> 
> 赞同：0
> 
> 时间：2013-02-02T20:54:37.477
> 
> 标签：view, picker, tabbed

我有一个选项卡式应用程序。我有 4 个选项卡，在前 2 个选项卡中有选择器视图。如何在第三个选项卡中使用我在第一个和第二个选择器视图中提供的信息？例如：1 个选择器视图：（这是您最喜欢的动物）狗、猫、马。我选狗。现在在第二个选项卡（第二个选择器视图）中：（哪种颜色，无论如何）绿色，蓝色，棕色。我选择棕色。

我希望第一个信息（狗）能够在第三个选项卡中使用。选项：绿色、蓝色和棕色（示例）（无论我选择什么）都是相同的。但是在第三个视图中应该有一只棕色的狗（例如文本“你选择了棕色的狗”）。我希望你明白我的意思... 1\. 选择：狗 2\. 棕色 = 3rd Tab 棕色狗。这就像一个小数据库......或者我该怎么做？我希望你能帮助我。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T11:51:11.613

```
See the code 

-(IBAction)simple_picker:(id)sender{

    pickerViewPopup = [[UIActionSheet alloc] init];
    const CGFloat toolbarHeight = 44.0f;
    Picker = [[UIPickerView alloc] initWithFrame:CGRectMake(0, toolbarHeight, 0, 0)];
    Picker.showsSelectionIndicator = YES;
    Picker.dataSource = self;
    Picker.delegate = self;
    //........
    UIToolbar *pickerToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, toolbarHeight)];
    pickerToolbar.barStyle = UIBarStyleBlackOpaque;
    [pickerToolbar sizeToFit];
    NSMutableArray *barItems = [[NSMutableArray alloc] init];

    UIBarButtonItem *cancel= [[UIBarButtonItem alloc]initWithTitle:@"Cancel" style:UIBarButtonItemStyleBordered target:self action:@selector(Cancel_picker:)];
    [barItems addObject:cancel];
    UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];
    [barItems addObject:flexSpace];
    //....
    UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed2:)];
    [barItems addObject:doneBtn];
    [pickerToolbar setItems:barItems animated:YES];
    [pickerViewPopup addSubview:pickerToolbar];

    lbl2.text=[picArray objectAtIndex:0];

    [pickerViewPopup addSubview:Picker];
    [pickerViewPopup showInView:self.view.superview];
    [pickerViewPopup setBounds:CGRectMake(0,0,self.view.frame.size.width, 464)];

}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView;
{
    return 1;
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
            lbl2.text= [picArray objectAtIndex:row];

}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component;
{

    return [picArray count];

}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component;
{

return [picArray objectAtIndex:row];

}

-(void)btncancelPressed2:(id)sender{
    [pickerViewPopup dismissWithClickedButtonIndex:1 animated:YES];
}

-(void)Cancel_picker:(id)sender{
    [pickerViewPopup dismissWithClickedButtonIndex:1 animated:YES];
} 
```

# php - PHP/JavaScript 隐藏信息

> ID：14666434
> 
> 赞同：0
> 
> 时间：2013-02-02T20:55:44.893
> 
> 标签：php, javascript, hide

我有以下代码：

```
<?php

$secret_data = "data noone can know";

?>

bla bla bla alot of html

<script type="text/javascript">
function("bla bla", {
data: '<?=$secret_data?>'
}
);
</script> 
```

当人们在他们的网络浏览器中查看源代码时，他们就会知道数据。如何在我的 JavaScript 中使用它，但仍然保持安全？

我可以以某种方式将 JavaScript 放入 PHP 中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:01:09.790

您当前正在做的工作，但最终用户将能够看到“秘密数据”。任何客户端都将对用户可见。如果您需要将一些数据传递给您不希望用户看到的脚本，您可以将其存储在会话中。

```
<?php
    session_start();
    $_SESSION['secret_data'] = 'data noone can know';
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:13:00.023

使用 Javascript 等客户端技术时，不可能对源代码进行隐藏和保密。它的基本原则之一。它在客户端运行。

取自本[网站](http://computer.howstuffworks.com/javascript.htm)：

> JavaScript 是所谓的客户端脚本语言。这意味着它是一种在 Internet 浏览器中运行的计算机编程语言（浏览器也称为 Web 客户端，因为它连接到 Web 服务器以下载页面）。

不幸的是，因此您的陈述没有意义：

> 好吧，我需要 javascript 来使用秘密数据，而不让最终用户看到它是什么

为了保持代码/信息的秘密，它必须在服务器上实现/存储。

我鼓励您进一步了解 Javascript 的实际工作原理。这是描绘典型架构的图像：

![服务器端和客户端技术](../Images/6d55eccf3448ea1410ea0b7304538547.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T21:15:26.240

> 当另一个用户需要查看用户内容时，它会在 javascipt.xml 中使用。但如果另一个人知道这个 id，则该用户可以对其进行编辑。所以因此它需要被隐藏

你的问题是：

*   如果用户知道 id，他们可以查看内容
*   如果用户知道 id，他们可以编辑内容

您只希望创建内容的用户能够编辑它，但任何知道 id 的人都能够查看它。

就您当前的系统而言，您无法在不使内容无法查看或编辑的情况下保持 id 的秘密，并且您无法在无法查看和编辑内容的情况下提供它。

因此，试图保密 id 并不是这里的解决方案。

您需要为系统添加额外的检查层。由于任何知道该 id 的人都可以查看内容，因此您可以保留查看部分。

由于仅允许创建内容的用户对其进行编辑，因此需要额外的保护。当请求进入编辑内容时，您必须*验证*请求来自已知用户（即用户已登录），并且您必须确保他们*有权*编辑内容（即用户名登录用户与创建内容的用户的用户名相同，或者他们是管理员或具有其他适当的权限）。

那一层auth/authz可以在服务器上完成。

# c++ - 创建后的 QT 多线程和移动对象线程

> ID：14666436
> 
> 赞同：1
> 
> 时间：2013-02-02T20:55:57.810
> 
> 标签：c++, multithreading, qt, qthread

我有一个多线程程序，它从网站下载和获取信息，然后获取信息，创建一个对象，然后我将其添加到我的 GridLayout 中。

我需要创建数千个对象，然后将其添加到我的网格布局中，使用 8 个线程获取信息，然后使用相同的 8 个线程创建对象并将它们添加到 8 个不同的网格中。

程序运行大约 20 秒后，我收到
QThread::start: Failed to create thread (The access code is invalid.) 错误。又过了几秒钟，我得到一些运行时 C++ 错误，这些错误挂起并且不显示消息。这意味着什么？让我感到困惑的是，此时，我的线程已经创建并且我实际上并没有创建更多线程.. 在这些线程内部，尽管它们每个都在创建小部件对象，然后我将它们发送到主网格布局..

我检查了我正在运行的线程数量（QThread:idealThreadCount），它只返回 8。

我正在使用多线程从站点下载信息，然后每个记录返回值，这些值我创建到对象中以放入我的 GridLayout。

我在想，因为那时，这些对象都属于单个线程，并且在所有 url 完成之前不会发出（finished（）），所以它占用了一些东西并导致这个错误？

在下载信息并将新对象添加到我的网格布局后，我是否应该尝试 MoveToThread 并将所有这些对象发送回主线程？

这是否对正在发生的事情有意义，如果您希望我发布代码？

谢谢。

编辑：

刚尝试创建后移动线程，但得知 QObject::moveToThread: Widgets cannot be move to a new thread

这是我创建的线程

```
void checkNewArrivals::createWorkers(QString url, QString category, QString subCategory){
    QThread* thread = new QThread;
    checkNewArrivalWorker* worker = new checkNewArrivalWorker(url, category, subCategory);
    worker->moveToThread(thread);
    connect(worker, SIGNAL(error(QString)), this, SLOT(errorString(QString)));
    connect(thread, SIGNAL(started()), worker, SLOT(process()));
    connect(worker, SIGNAL(finished()), thread, SLOT(quit()));
    connect(worker, SIGNAL(result(QString,QString,QString,QString,QString,int, int)), this, SLOT(addItem(QString,QString,QString,QString,QString,int, int)));
    connect(worker, SIGNAL(finished()), worker, SLOT(deleteLater()));
    connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));
    thread->start();
} 
```

这是我发出结果的工人类函数

```
void checkNewArrivalWorker::getHtml(QString url){
    html = QString::fromStdString(Curl->getWebsiteHtml(url.toStdString()));
    html = html.mid(html.indexOf("Goods List"));
    html = html.mid(0, html.indexOf("footer"));

    for (int i = 0; i < html.count("GoodsBox"); i++){
        //blah blah blah blah

        emit result(idLink, picLink, price, category, subCategory, row, col);
        col++;
        if (col == 5){
            col = 0;
            row++;
        }

        html = html.replace(itemRow, "");
    }
} 
```

然后我添加结果以创建一个项目并将其添加到网格布局

```
void checkNewArrivals::addToGrid(QGridLayout *layout, QString id, QString picUrl, QString usPrice, int row, int col){
    checkNewArrivalItem* item = new checkNewArrivalItem;
    if (item->setupItem(id, picUrl, usPrice) == true){
        layout->addWidget(item, row, col);
    };
} 
```

这些项目工作正常，直到我认为项目超载..不太确定我为什么会收到此错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:07:45.670

Qt GUI 对象不能存在于除主线程之外的任何线程中。需要创建 GUI 对象并将其添加到主线程中的布局中。您仍然可以从后台线程收集数据，但您需要将其传递回主线程以进行显示。为此，我建议使用信号，因为默认情况下信号/插槽连接是线程安全的。

编辑：您的新线程看起来应该可以工作。但是，我认为您会发现最好保持特定数量的线程运行并将工作委派给它们。一方面，创建、启动、停止和销毁线程是一个昂贵的过程。但更重要的是，您可能只是创建了太多线程。

需要明确的是，QThread::idealThreadCount() 不是您正在运行的线程数，而是您的 CPU 可以最有效地处理的线程数。我猜你有一个带超线程的四核 CPU，它是 8 个。

我认为您很可能创建了太多线程。这听起来很像我错误地这样做的时候。

# animation - 如何设置动画的图像分辨率？

> ID：14666439
> 
> 赞同：16
> 
> 时间：2013-02-02T20:57:02.433
> 
> 标签：animation, matplotlib

如何使用“matplotlib.animation”模块设置保存为 mp4 电影的动画的分辨率？

在网上我只找到了使用“animation.FuncAnimation”的例子。例如来自[http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/](http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/)的不错的教程使用：

```
anim = animation.FuncAnimation(fig, animate, init_func=init,
                           frames=200, interval=20, blit=True)
anim.save('basic_animation.mp4', fps=30, extra_args=['-vcodec', 'libx264']) 
```

从 matplotlib.animation 模块参考中，我找到了提供“dpi”参数的“animation.Animation.save”方法，但我不知道如何正确应用此功能

```
matplotlib.animation.Animation.save(filename, writer=None, fps=None, dpi=None, codec=None, bitrate=None, extra_args=None, metadata=None, extra_anim=None) 
```

一个小的示例代码可能会有所帮助。

非常感谢。

约翰内斯

PS：顺便问一下，如何插入带有 sytax-highlighting 的 Python 代码？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-02T21:24:43.733

您可以通过迂回的方式控制分辨率。分辨率、图形大小和dpi并不是全部独立的，如果你知道其中两个，那么第三个是固定的。

您可以`dpi`在 save 参数中设置，在保存之前，设置图形的大小

```
fig.set_size_inches(w_in_inches, h_in_inches, True). 
```

你的决议是`dpi * w_in_inches X dpi * h_in_inches`。

```
dpi = 100
writer = animation.writers['ffmpeg'](fps=30)
ani.save('test.mp4',writer=writer,dpi=dpi) 
```

您可能需要从源代码升级到更新版本的 mpl （debian 很棒，因为它是如此保守而糟糕，因为它是如此保守）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:59:46.577

`bitrate`是用于指定电影质量的参数。您设置的值越高，电影的质量就越高。

# php - 拆分字符串，重复行数，然后插入mysql数据库

> ID：14666442
> 
> 赞同：0
> 
> 时间：2013-02-02T20:57:12.137
> 
> 标签：php, mysql, string, insert, split

我有以下问题：

如果字符串是： 1 x something `br`1 x something else `br`2 x something even different

我希望将其插入到我的 mysql 数据库中，如下所示： 1 东西 1 其他东西 2 甚至不同的东西

因此，我们需要将需要插入的每一行分开，当有一个新列时`br`，还要拆分（分解）有一个“x”的新列，并将第一部分插入第一列，第二部分插入第二列.

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:47:33.600

试试这个..

```
<?php

$string = '1 x something <br> 1 x something else <br> 2 x something even different';

$lines = explode('<br>', $string);

foreach($lines AS $line){

    list($quantity, $item) = explode('x', $line);

    $sql = sprintf('INSERT INTO TABLE (field_for_quantity, field_for_item) VALUES (%u, "%s")', $quantity, $item);
    mysql_query($sql);

}

?> 
```

# c - 编译 C 并将 ASM 组装成机器代码

> ID：14666444
> 
> 赞同：5
> 
> 时间：2013-02-02T20:57:26.983
> 
> 标签：c, assembly, compilation, machine-code

**我有三个问题：**

1.  我可以使用什么编译器以及如何使用它将 C 源代码编译成**机器代码**？
2.  我可以使用什么汇编程序以及如何使用它将 ASM 汇编为**机器代码**？
3.  （可选）您如何建议将机器代码放置在正确的地址中（即引导加载程序机器代码必须放置在引导扇区中）？

**我的目标：** 我正在尝试制作一个基本的操作系统。这将使用个人制作的引导加载程序和内核。我也会尝试从 Linux 内核（即驱动程序）中获取一些零碎的东西并将它们集成到我的内核中。我希望在大多数现代计算机上创建一个类似 DOS 的 32 位操作系统来处理内存问题。我认为我不会为我的操作系统创建可执行格式，因为我的操作系统不会动态到需要它。

**我的情况：** 我在带有 Intel Celeron CPU 的 x86-64 windows 8 笔记本电脑上运行；我相信它使用安全启动。我将在带有 Intel Core I3 CPU 的 x86-64 桌面上测试我的操作系统。我对操作系统及其技术有一个平均的了解。我知道这个项目所需的 C、ASM 和计算机理论。我认为还值得注意的是，我 16 岁，没有受过正规的计算机科学教育。

**我的研究：**在谷歌搜索 C 通常编译成什么后，我找到了各种答案，包括机器代码、二进制、普通二进制、原始二进制、汇编和可重定位目标代码。据我了解，程序集通常会组装成 PE 格式的可执行文件。我听说过 Cygwin、GCC C 和 MingW C 编译器。至于汇编器，我听说过 FASM、MASM 和 NASM。我搜索过[OSDev](http://wiki.osdev.org/Main_Page "OSDev.org wiki（主页）")和[OSDever](http://www.osdever.net/ "OSDever.net")等网站。

**我尝试过的：**我尝试设置 GCC（一场噩梦）并创建一个交叉编译器（另一个噩梦）。

**结论：**如您所知，我对编译器、汇编器和可执行格式感到困惑。请在回答我的问题的同时消除我的无知。这些可能是唯一让我无法在简历中使用操作系统的事情。抱歉，我会包含更多链接，但 stackoverflow 不会让我制作两个以上的链接。万分感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T21:06:00.947

首先，快速回答您的三个问题。

1.  几乎任何编译器都会将 C 代码翻译成汇编代码。这就是编译器*所做*的。GCC 和 clang 很受欢迎并且是免费的。

    ```
    clang -S -o example.s example.c 
    ```

2.  您选择的任何编译器都可能支持汇编，只需使用相同的编译器驱动程序即可。

    ```
    clang -o example.o example.s 
    ```

3.  您的链接器文档将告诉您如何将特定代码放在特定地址等等。如果您如上所述使用 GCC 或 clang，您可能会使用`ld(1)`. 在这种情况下，请阅读“链接器脚本”。

接下来，一些注意事项：

*   您不需要交叉编译器或自行设置 GCC。您正在使用 Intel 机器，为 Intel 机器生成代码。linux 发行版附带的任何 clang 或 GCC 二进制发行版都应该可以正常工作。

*   C 编译器通常将代码编译成程序集，然后将生成的程序集传递给系统汇编器以得到机器代码。机器码、二进制、普通二进制、原始二进制基本上都是同义词。

*   生成的机器代码被打包成某种可执行文件格式，告诉主机操作系统如何加载和运行代码。在 Windows 上是 PE，在 Linux 上是 ELF，在 Mac OS X 上是 Mach-O。

*   您不需要为您的操作系统创建可执行格式，但您可能想要*使用*一种。ELF 是一个非常简单（并且有据可查）的选项。

还有一点个人注意事项，我希望不会让您太沮丧 - 如果您对编译器、汇编器、链接器和所有这些工具的工作方式不是*很*熟悉，那么您的项目将*非常*困难和混乱。可以这么说，您可能想从一些较小的项目开始以获得您的“海腿”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T22:45:49.043

我想你的问题的第一部分已经回答了，所以我将讨论另外两个：

> 我可以使用什么汇编程序以及如何使用它将 ASM 汇编为机器代码？

, (基本上非常喜欢), , "masm" ie 之一，`nasm`并且作为 Microsoft 工具的一部分免费提供。`yasm``nasm``fasm``ml64.exe``ml.exe`

其中，我可能会推荐`nasm`或`yasm`。该建议完全基于个人喜好 - 但他们支持的广泛平台以及默认使用英特尔语法是我的原因。我会尝试一些，看看你喜欢什么。

> （可选）您如何建议将机器代码放置在正确的地址中（即引导加载程序机器代码必须放置在引导扇区中）？

好吧，只有一种方法可以将引导加载程序放置在 MBR 的正确地址 - 打开 LBA 0 处的磁盘并在那里准确写入 512 个字节，以`0x55AA`. 冲洗，然后关闭。MBR 通常还包含一个嵌入其中的分区表——它既是代码又是数据。这个东西的科学术语是[冯诺依曼架构](https://en.wikipedia.org/wiki/Von_Neumann_architecture#Development_of_the_stored-program_concept)，可以简单概括为“程序和数据存储在同一个地方”。BIOS 想要从磁盘启动时的操作是将前 512 个字节读入内存，检查签名，如果匹配，则执行该内存（从字节 0 开始）。

好的，这些问题就不用说了。现在我再给你一些注意事项：

*   引导加载程序的 512 字节对于任何人来说都不够用。因此，一些文件系统包含引导扇区，引导加载程序本身只是加载在这些扇区中找到的代码/数据。这允许加载更大量的代码——足以让内核运行。例如，grub 在旧版本中包含 stage1、stage1_5 和 stage2 组件。
*   尽管大多数操作系统都要求您使用可执行格式容器，但您并不*需要*。在磁盘和内存中，可执行代码只是一个、两个或三个字节的字符串，称为操作码。您可以阅读[操作码参考](http://ref.x86asm.net/)或 Intel/AMD 手册以了解十六进制值转换为什么。无论如何，您可以使用 nasm 执行从汇编程序到二进制文件的直接转换，如下所示：

    ```
     nasm -f bin input.asm -o output.asm 
    ```

    尽管结果可能不会执行，但它非常适用于 16、32 或 64 位汇编程序。唯一的地方是，如果您`[bits 16]`在代码中显式使用该指令以及`org 100h`，那么您将拥有一个 MSDOS .com 程序。不幸的是，这是现有的最简单的二进制格式——你只有一大块代码和数据，而且不能超过单个段的大小。

    我觉得这可能会解决这一点：

    > 我找到了各种答案，包括机器代码、二进制、普通二进制、原始二进制、汇编和可重定位目标代码。

    关于汇编组装成什么的答案 - 它组装成操作码和内存地址，具体取决于汇编程序。这以字节表示，这些字节本身就是数据。您可以使用十六进制编辑器原始阅读它们，尽管在少数情况下这是绝对必要的。我提到内存地址是因为一些操作码控制如何解释内存地址 - 例如，可重定位目标代码要求地址不是硬编码的（相反，它们被解释为与当前位置的偏移量）。

    > 据我了解，程序集通常会组装成 PE 格式的可执行文件。

    可以公平地说，派生出 C/C++ 的汇编器被编译为操作码，然后这些操作码与程序中包含的任何其他内容（数据、资源）一起以可执行格式（例如 PE）存储。通常取决于您的操作系统。

*   如果你彻底阅读了 OSDev Wiki，你会意识到分段寻址是一件非常痛苦的事情——现代操作系统中段的标准和唯一用法是定义跨越整个地址空间的四个段——在环 0 和 3 处的两个数据段，在环 0 和 3 的两个代码段。

*   如果您还没有彻底阅读[OSDEV Wiki](http://wiki.osdev.org)，那么您应该阅读。我还推荐[JamesM 的内核教程](http://www.jamesmolloy.co.uk/tutorial_html/index.html)，其中包含有关在 C 中构建内核的实用建议。

*   如果你只是想对一个 DOS 内核做坏事，你实际上仍然可以不需要自己编写一个完整的内核。您还应该能够将 CPU 从 DOS 切换到保护模式。您需要[FreeDOS](http://www.freedos.org/)和您选择的汇编程序。有一个关于[终止和保持驻留](https://en.wikipedia.org/wiki/Terminate_and_Stay_Resident)的优秀教程，这基本上意味着挂钩一个中断例程，然后将自己从活动进程列表中编辑出来，在[Rootkit 兵工厂](https://rads.stackoverflow.com/amzn/click/com/144962636X)。互联网上可能也有这方面的教程。

    我可能很想建议首先这样做，只是为了让自己习惯这种低级的东西。

*   如果你只是想戳一个操作系统，你可以在 Windows 上设置内核调试。WinDbg 有点……晦涩难懂，但一旦你习惯了它就会变得有意义。
*   您提到您的笔记本电脑使用安全启动。如果是这种情况，您的笔记本电脑使用 UEFI。如果您想阅读此内容，[UEFI 规范](http://www.uefi.org/specs/)100% 保证比您的数学作业更无聊，但我建议您略读它以了解目标和基本环境。重要的是拥有[EFI SDK](http://sourceforge.net/apps/mediawiki/tianocore/index.php?title=UDK2010)，它使您能够构建与 EFI 兼容的应用程序（PE 格式并存在于磁盘上的 FAT32 分区上 - 因此安装 EFI 引导加载程序非常简单，即使编写一个不是这样。如果我必须提出一个诚实的建议，我现在会坚持使用 MBR，因为在撰写本文时使用 MBR 模拟操作系统比 EFI 容易得多，而且*您现在确实想在某种形式的 VM 中执行此操作*. 另外，我会使用现有的 grub，因为引导加载程序并不是那么令人兴奋，真的。
*   别人说了，我就说：*你绝对想在某种形式的模拟器或虚拟机下做这样的事情*。你肯定会犯错，而且你会遇到你不理解的事情。模拟器和虚拟机软件现在是免费的，有些像 BOCHS 会告诉你给定故障、陷阱等的原因是什么。这很有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T22:02:23.243

起初，“机器码”和“二进制”是同义词。“目标代码”是某种中间形式，链接器将在最后转换为二进制。一些 C/C++ 编译器不是直接生成二进制文件，而是生成汇编程序源代码，它们提供给汇编程序，生成目标代码，然后提供给链接器，生成最终的二进制文件。在大多数情况下，这些过程对用户是透明的。您向编译器提供 C/C++/Pascal/任何源代码，并在输出中获得一个二进制文件。

[FASM 汇编器，又名 flatassembler](http://flatassembler.net)是 OS 开发的最佳汇编器。FASM 中已经创建了几个操作系统。

那是因为 FASM 是可自编译的并且非常易于移植。这样，在 2..3 天内，您可以将它移植到您的操作系统，然后您的操作系统将变得自给自足 - 即您将能够从您的操作系统中编译程序。

FASM 的另一个优点是它不需要链接器——它可以直接生成多种格式的二进制文件。

活跃的大社区也很重要。有大量可用于 FASM 的资源，包括用于操作系统开发的资源。

[留言板](http://board.flatassembler.net)非常活跃，是可以学到很多东西的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:09:11.477

首先，使用 Virtual box 之类的东西进行测试

我认为您可能想要采取一些较小的步骤，以便轻松编写 C 代码。

然后看看磁盘上的引导扇区是如何工作的（在互联网上有很好的记录）还看看其他开源引导加载程序的代码。

然后看看怎么做任务切换。写起来也不难。您甚至可以在尝试嵌入到您自己的操作系统之前在您的正常操作系统下运行它的大部分内容

使用 C 编译器，您通常可以将 asm inline 通常与`asm { /* assembly code */ }`

# ajax - 将 JSON 响应放入隐藏字段并将其检索到函数中

> ID：14666446
> 
> 赞同：1
> 
> 时间：2013-02-02T20:57:39.640
> 
> 标签：ajax, json, spring, jquery

我正在使用 JSON 使用以下函数检索数据库中表包含的行数。

```
function rowCount()
{
    $.ajax({
        headers: { 
                'Accept': 'application/json',
                'Content-Type': 'application/json' 
            },
        datatype:"json",
        type: "GET",                    
        url: "/wagafashion/ajax/CmsRowCount.htm",
        success: function(response)
        {
            $("#rows").val(response);
        },
        error: function(e)
        {
            alert('Error: ' + e);
        }
    });
} 
```

在成功处理程序中，响应按预期到达。服务器端没有问题。

响应只是映射到`long`表示数据库表中行数的 Java 类型。

我将此响应放在成功处理程序`id`中`rows`使用的隐藏字段中。`$("#rows").val(response);`

使用以下 jQuery 函数提交表单时会调用上述函数。

```
$(function() {
    $('#dataForm').submit(function() {

        rowCount();  //Invokes the above function that makes a JSON request.
        var rows=$("#rows").val();
        alert("rows = "+rows);

        return false;
    });
}); 
```

警告框尝试警告隐藏字段包含的值（即上文所述的 JSON 响应），但**它**首次为空。只有当我再次按下提交按钮（没有页面刷新）时，它才会提醒实际值。

* * *

还尝试将前面的函数替换为以下函数。

```
$(function() {
    $('#dataForm').submit(function() {

        rowCount();  //Invokes the first function that makes a JSON request.     

        var form = $(this),
        url = form.attr('action'),
        rows = form.find('input[name="rows"]').val();

        alert("rows = "+rows);

        return false;
    });
}); 
```

但它也没有奏效。为什么会这样？将隐藏字段的正确值检索到前面的 jQuery 函数中的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:00:14.970

> 警告框尝试警告隐藏字段包含的值（即上文所述的 JSON 响应），但**它**首次为空。

Ajax 调用是*异步*的。当您调用时`rowCount`，您*开始*调用，但随后`rowCount`返回并且您的代码继续。调用直到稍后才*完成*（这就是`ajax`接受回调的原因）。

如果您从*回调*触发下一步的操作，您将获得价值。您通常通过`rowCount`接受它自己的回调来做到这一点，如下所示：

```
function rowCount(callback)          // <==== Accept the callback
{
    $.ajax({
        headers: { 
                'Accept': 'application/json',
                'Content-Type': 'application/json' 
            },
        datatype:"json",
        type: "GET",                    
        url: "/wagafashion/ajax/CmsRowCount.htm",
        success: function(response)
        {
            $("#rows").val(response);
            callback();              // <==== Call the callback
        },
        error: function(e)
        {
            alert('Error: ' + e);
            callback();              // <==== Probably want to give it a value telling it things failed
        }
    });
} 
```

然后使用它：

```
$(function() {
    $('#dataForm').submit(function() {
        var form = $(this); // <== Grab this outside the callback

        rowCount(function() {

            var url = form.attr('action'),
                rows = form.find('input[name="rows"]').val();

            alert("rows = "+rows);
        });

        return false;
    });
}); 
```

如果要根据回调决定是否允许提交表单，则必须始终取消提交，然后如果要允许，则从回调中以编程方式触发提交。

# xcode - 无法在 XCode 4.5 中编译 .s 文件

> ID：14666448
> 
> 赞同：0
> 
> 时间：2013-02-02T20:57:44.820
> 
> 标签：xcode, assembly

我正在尝试编译包含以下代码的 .s 文件：

```
.text
.globl memcpy_armneon
memcpy_armneon:
    pld [r1, #0xC0]
    vldm r1!,{d0-d7}
    vstm r0!,{d0-d7}
    subs r2,r2,#0x40
    bge memcpy_armneon 
```

但 XCode 4.5 抱怨：

“LLVM GCC 4.2 错误没有这样的指令：'pld [r1,'。有没有办法编译这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:39:15.153

好的，现在是心理调试时间。我这里有 Xcode 4.6，它似乎甚至*没有*LLVM GCC 的 ARM 版本：

```
$ gcc -arch armv7 -c -o example.o example.s 
llvm-gcc-4.2: error trying to exec '/usr/bin/../llvm-gcc-4.2/bin/arm-apple-darwin11-llvm-gcc-4.2': execvp: No such file or directory 
```

这使我相信您正在将此代码交给英特尔汇编程序。事实上，当我这样做时，我得到的正是你的文件的错误措辞：

```
$ gcc -c -o example.o example.s 
example.s:5:no such instruction: `pld [r1,'
example.s:6:no such instruction: `vldm r1!,{d0-d7}'
example.s:7:no such instruction: `vstm r0!,{d0-d7}'
example.s:8:too many memory references for `sub'
example.s:9:no such instruction: `bge memcpy_armneon' 
```

您可能想要使用 clang 以便实际使用 ARM 汇编程序：

```
clang -arch armv7 -c -o example.o example.s 
```

# java - 确定长度为 N 的数组是否在长度为 M 的数组中

> ID：14666452
> 
> 赞同：2
> 
> 时间：2013-02-02T20:58:27.170
> 
> 标签：java, algorithm

> **可能重复：**
> [确定数组是否包含 n…n+m 的算法？](https://stackoverflow.com/questions/177118/algorithm-to-determine-if-array-contains-n-nm)

让我们假设 M > N，并且您有 2 个数组。长度为 M 的一个称为 A，长度为 N 的一个称为 B。有没有更快的方法来确定数组 B 是否存在于数组 A 中？

例如：

A = [ 1 2 3 4 5 6 ]

B1 = [ 2 3 4 ]

因此数组 B1 存在于 A 中，而 [ 1 3 2 ] 之类的则不存在。

这本质上是在 Java 中使用 char 数组实现类似 isSubstring() 的东西。

我能想到的唯一方法是在 O(n^2) 中将 A 中的每个元素与 B 中的初始元素进行比较，然后遍历 B 以寻找匹配项。

我想这个问题在面试中相当普遍，所以我的问题是问是否有更快的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:10:47.630

你想要[KMP](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)

> algorithm kmp_search: 输入：一个字符数组，S（要搜索的文本）一个字符数组，W（搜索的词） 输出：一个整数（在 S 中找到 W 的从零开始的位置）
> 
> ```
> define variables:
>     an integer, m ← 0 (the beginning of the current match in S)
>     an integer, i ← 0 (the position of the current character in W)
>     an array of integers, T (the table, computed elsewhere)
> 
> while m+i is less than the length of S, do:
>     if W[i] = S[m + i],
>         if i equals the (length of W)-1,
>             return m
>         let i ← i + 1
>     otherwise,
>         let m ← m + i - T[i],
>         if T[i] is greater than -1,
>             let i ← T[i]
>         else
>             let i ← 0
> 
> (if we reach here, we have searched all of S unsuccessfully)
> return the length of S 
> ```

复杂：

> 假设表 T 的先验存在，Knuth-Morris-Pratt 算法的搜索部分的复杂度为 O(k)，其中 k 是 S 的长度，O 是大 O 表示法。由于除了进入和退出函数的固定开销外，所有的计算都在while循环中进行，我们将计算这个循环的迭代次数的界限；为了做到这一点，我们首先对 T 的性质进行关键观察。根据定义，它的构造使得如果在 S[m + i] 与 W[i] 比较时从 S[m] 开始的匹配失败，那么下一个可能的匹配必须从 S[m + (i - T[i])] 开始。特别是下一个可能的匹配必须出现在比 m 更高的索引处，因此 T[i] < i。利用这个事实，我们将证明循环最多可以执行 2k 次。对于每次迭代，它执行循环中的两个分支之一。第一个分支总是增加 i 而不会改变 m，因此 S 的当前审查字符的索引 m + i 增加。第二个分支将 i - T[i] 添加到 m，正如我们所见，这始终是一个正数。因此增加了当前潜在匹配开始的位置m。现在，如果 m + i = k 则循环结束；因此，循环的每个分支最多可以到达 k 次，因为它们分别增加 m + i 或 m，并且 m ≤ m + i：如果 m = k，则肯定 m + i ≥ k，所以因为它增加最多以单位增量计算，我们必须在过去的某个时间点有 m + i = k，因此无论哪种方式我们都可以完成。因此循环最多执行 2k 次，表明搜索算法的时间复杂度为 O(k)。

附加信息：

KMP算法的效率

> 由于算法的两个部分分别具有 O(k) 和 O(n) 的复杂度，因此整个算法的复杂度为 O(n + k)。无论 W 或 S 中有多少重复模式，这些复杂性都是相同的。

# php - 复杂的 MySQL join/where 子句

> ID：14666453
> 
> 赞同：0
> 
> 时间：2013-02-02T20:58:30.290
> 
> 标签：php, mysql, join

我的数据库中有 2 个表（实际上更多，但它们目前无关紧要）。

一张表存储状态为“已发布”或“已删除”的书籍。书籍的状态为已发布或已丢弃，具体取决于该书是否已被携带。

另一个表存储有关特定用户是否阅读过特定书籍的数据。

我想显示用户已阅读和尚未阅读的所有书籍的列表，这些书籍仍在携带。我创建了一个查询，它将连接两个表并匹配每本书，无论状态如何，都与特定用户和已读日期相匹配，如果未读则为 NULL。问题是，虽然我想显示用户尚未阅读的书籍，但我不想显示用户尚未阅读且不再携带的书籍（状态为垃圾）。

目前，我一直无法做到这一点。在 PHP 端的 foreach 循环中，我正在检查是否已阅读状态为垃圾的书，如果没有，则跳过它。我觉得这在数据库方面效率低下。

以下是我目前拥有的脚本。我想要完成的事情是否可能？它的效率会更高还是更低？谢谢您的帮助。

```
 SELECT 
     book.ID as actual_book_id,
     book.post_title,
     book.post_status,
     read.*
 FROM books as book
 LEFT OUTER JOIN book_club as read
     ON read.book_id = book.ID
     AND read.user_id = $userID
 WHERE book.post_type = 'book'
     AND book.post_status IN ('publish','trash')
 ORDER BY
     book.post_title ASC 
```

假设 $userID 是与用户相关的有效整数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:02:36.457

您必须添加一些更复杂的子句，而不仅仅是您的 IN。

```
SELECT 
     book.ID as actual_book_id,
     book.post_title,
     book.post_status,
     read.*
 FROM books as book
 LEFT OUTER JOIN book_club as read
     ON read.book_id = book.ID
     AND read.user_id = $userID
 WHERE book.post_type = 'book'
     AND (book.post_status  = 'publish' OR
          (book.post_status = 'trash' AND read.<columnDate> IS NOT NULL))
 ORDER BY
     book.post_title ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:12:39.270

我认为您可以尝试在 user_id 之前和之后查找书籍。这是示例：

```
SELECT 
     book.id as actual_book_id,
     book.post_title,
     book.post_status,
     r.*
FROM 
(
      SELECT 
           user_read.* 
      FROM book_club AS user_read 
      WHERE user_read.user_id = $userID
) AS r 
LEFT JOIN books as book ON r.book_id = book.id 
WHERE book.post_type = 'book'
     AND book.post_status IN ('publish','trash')
 ORDER BY
     book.post_title ASC 
```

通过这种方式，您应该只显示给定 userID 的 post_status = 'publish' 或 'trash' 的书籍。

# c - Lex：仅由其他单词的字母组成的最长单词

> ID：14666457
> 
> 赞同：0
> 
> 时间：2013-02-02T20:59:00.587
> 
> 标签：c, lex, flex-lexer

我正在尝试编写将字符串作为输入的 lex 代码，并通过一个长字典文件进行解析以找到该字典中最长的单词，该单词仅由该字符串中的字母组成。字符串中的每个字母都可以使用零次或多次，这意味着单词“in”对“input”有效。这是我到目前为止所拥有的：

```
%{
#include <stdio.h>
%}

%option noyywrap

%% 
[input]+ { 
          printf("This is the longest I think: %s\n", yytext);
         }

.|\n    {}
%%

int main(void)
{
    yylex();
    return 0;
} 
```

但是，这确实没有达到我的预期。这段代码通过并打印字典中每个单词的匹配部分，所以我得到像“i”、“iu”、“inu”等的输出，这些显然不是有效的单词。有人知道怎么修这个东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:04:56.083

您可以将行首和行尾标记用作正则表达式的一部分，以要求匹配整行，而不仅仅是其中的一部分。尝试将您的正则表达式从更改`[input]+`为

```
^[input]+$ 
```

然后，您将需要一些单独的逻辑来跟踪您迄今为止发现的最长字符串，但从您上面的代码来看，我认为这更直接地解决了您手头的问题。

希望这可以帮助！

# java - 使用 JLGui 更改系统音量

> ID：14666459
> 
> 赞同：0
> 
> 时间：2013-02-02T20:59:12.787
> 
> 标签：java, audio, volume, javasound

我目前正在学习如何使用 jlgui 构建一个简单的 MP3 播放器（使用 swt 来控制它）。虽然我相处得很好，但有一件事真的让我很震惊，那就是控制从计算机发出的声音的音量和声像。

我有一个类，它创建一个 BasicPlayer 对象和一个与之配套的 BasicController。我曾尝试使用 BasicController.setGain 方法，但如果我在其中输入任何值，它所做的只是将音量设置为静音，而且我似乎无法在歌曲播放期间更改此值。如果有人能在这方面给我一些帮助，我将不胜感激，因为它让我发疯:-(

还考虑尝试以下建议

```
AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(new File("C:\\Kasabian.mp3"));
Clip clip = AudioSystem.getClip();
clip.open(audioInputStream);
FloatControl gainControl = (FloatControl) clip.getControl(FloatControl.Type.MASTER_GAIN); 
```

但不确定如何将它与 jlgui 结合使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:28:10.427

“自己动手”解决方案：

Java 声音教程在“使用控件处理音频”页面的末尾有一个非常少的部分，称为“直接操作音频数据”。 [http://docs.oracle.com/javase/tutorial/sound/controls.html](http://docs.oracle.com/javase/tutorial/sound/controls.html)

我放弃了“控制”，只做自己。如果有人有一个使用 Java 控件进行音量和平移的有效解决方案，我会很高兴听到它。

要自己控制音量，您需要进入从 AudioInputLine 读取的数据“缓冲区”，将数据转换为 PCM 帧，将 PCM 值乘以 1 的分数（其中 1.0 是全音量，0 是沉默），转换回字节，然后，最后，写入您的 SourceDataLine。

此外，（如果您还不气馁），如果体积变量是松散耦合且易失的，它会有所帮助，如果您指定的体积是“目标”并且缓冲区循环内的变量逐渐接近目标，则更有帮助以每帧为基础。这是为了避免可能产生点击的音量跳跃。

并且（如果这还不够的话）将 0 到 1.0 的范围映射到更好地匹配可听度级别的方程（例如，指数或对数）是有帮助的。

# java-ee-6 - 在 jboss 中找不到类 def 为 7.X

> ID：14666465
> 
> 赞同：0
> 
> 时间：2013-02-02T21:00:09.777
> 
> 标签：java-ee-6, jboss7.x, ear

我有一个项目结构

```
eardirectory.Ear
  lib/
    my-custom-classes.jar
    .....
    .....
  my-custom-ejb.jar
  META-INF/
    .... 
```

```
//Now I tried to load classes from classloader as
ClassLoader cl = Thread.currentThread().getContextClassLoader();
clazz = Class.forName(my-custom-classes.class1.class.getName(), true, cl); 
```

但这不起作用，因为当前线程是 jboss 并且 jboss 没有 my-custom-classes.jar 的任何标识。

**所以我的问题是如何用 jboss 做到这一点？**我必须在运行时加载类定义。**在“jboss-deployment-structure”**中有什么方法可以在部署 EAR 之前定义如何加载类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T11:57:06.063

Follow the steps to create module it should work

**Step-1** In jboss-as-7.1.1.Final/modules/com/company/gyani/main/

```
 -module.xml
                      -my-custom-classes.jar

  Content of  module.xml

 <?xml version="1.0" encoding="UTF-8"?>
      <module xmlns="urn:jboss:module:1.0" name="com.company.gyani">
    <resources>
      <resource-root path="my-custom-classes.jar"/>
    </resources>
    <dependencies>
      <module name="javax.api"/>
         </dependencies>
      </module> 
```

Step-2 Now IN my.ear/META-INF/

```
 -jboss-deployment-structure.xml
      -MANIFEST.MF 
```

Content of MANIFEST.MF

```
 Manifest-Version: 1.0
    Dependencies: com.company.gyani 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T12:09:33.387

您需要使用 JBoss AS7 提供的模块概念。

在这里，您将您的 classes/jars/property 文件配置为模块，并且这些在服务器范围内启动 JBoss 时加载，并且可以被任何依赖于该模块的已部署应用程序访问。

通读[如何配置模块](http://www.mastertheboss.com/jboss-as-7/how-to-install-a-module-on-jboss-as-7)

# ruby - Ruby 通过索引访问多个数组元素（子数组）

> ID：14666467
> 
> 赞同：19
> 
> 时间：2013-02-02T21:00:20.380
> 
> 标签：ruby, arrays

我有一个数组，我有一个数组，其中包含第一个数组中某些元素的索引。从第一个数组中获取元素的最佳方法是什么？

我在做：

```
result = []
indexes.each { |current| result << my_array[current] } 
```

但是应该有更好的方法..

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-02T21:08:01.200

您可以使用[Array#map](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-map)：

```
indexes.map { |i| my_array[i] } 
```

甚至更好，[Array#values_at](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-values_at)

```
my_array.values_at(*indexes) 
```

其中 * 符号将数组提取为传递给方法的参数。

# java - 如何在 Java 数组中存储 1 亿个整数？

> ID：14666468
> 
> 赞同：8
> 
> 时间：2013-02-02T21:00:19.990
> 
> 标签：java, arrays, memory, integer

我正在做一个小任务，我需要在一个数组中存储大约 10 亿个整数。但是，我遇到了堆空间问题。你能帮我解决这个问题吗？

机器详细信息：Core 2 Duo 处理器，4 GB RAM。我什至尝试过 -Xmx 3072m 。有什么解决方法吗？ **同样的事情在 C++ 中也有效，所以绝对应该有一种方法可以将这么多的数字存储在内存中。**

下面是我得到的代码和异常：

```
public class test {
    private static int C[] = new int[10000*10000];

    public static void main(String[] args) {
        System.out.println(java.lang.Runtime.getRuntime().maxMemory()); 

    }

} 
```

异常：线程“主”java.lang.OutOfMemoryError 中的异常：测试时的 Java 堆空间。（test.java:3）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:20:08.220

使用关联数组。键是整数，值是计数（整数被添加到列表中的次数）。

如果分布相对随机，这应该可以为您节省一些可观的空间，如果不是，则更是如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T21:08:05.987

如果您需要存储 10 亿个完全随机的整数，那么恐怕您确实需要相应的空间，即大约 4GB 的内存用于 32 位`int`数字。您可以尝试增加 JVM 堆空间，但您需要有 64 位操作系统和至少一样多的物理内存——而且您只能做到这一点。

另一方面，如果您可以利用应用程序中的特定约束，您可能能够更有效地存储这些数字。

例如，如果您只需要知道一个特定元素`int`是否包含在一个集合中，那么您可以使用一个位集合——即`int`范围内的每个值一个位。这大约是 40 亿位，即 512 MB - 一个更合理的空间需求。例如，少数[BitSet](http://docs.oracle.com/javase/6/docs/api/java/util/BitSet.html)对象可以覆盖整个 32 位整数范围，而无需编写任何位处理代码......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T22:31:34.230

可能使用内存映射文件会有所帮助吗？它们不是从堆中分配的。这是一篇如何创建矩阵的文章。数组应该更容易。

[将内存映射文件用于巨大的矩阵 - Peter Lawrey](http://java.dzone.com/articles/using-memory-mapped-file-huge)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:08:22.567

您可以在 32 位系统上增加到 4GB。如果您使用的是 64 位系统，则可以更高。

输入 cmd 这个

```
java -Xmx4g programname 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T21:13:42.987

由于这么大的阵列可能不适合您的 RAM，因此您需要配置足够的 HDD 交换空间。4 - 16 Gb 交换在这些时候看起来并不现实。

Java 只允许`int`用作数组的索引，而不是`long`. 因此，最大可能的数组可以有 2147483648 个值，足够了。

用于`-Xmx`提高默认情况下可能不足的内存上限。3072m 是不够的，因为 10 亿个整数需要大约 4 Gb。由于操作系统等也需要空间，因此具有 4 Gb RAM 的机器无法在内存中保存所有 4 Gb 数据结构。

JRE 或 OS 也可能拒绝一次性授予这么大的一块内存，需要分配一些较小的块（可能是数组或数组）。

# javascript - 在 URL 中声明一个变量并在导航到页面时在 Javascript 中为其分配一个值

> ID：14666474
> 
> 赞同：3
> 
> 时间：2013-02-02T21:00:49.930
> 
> 标签：javascript, html, query-string, location-href

我对 HTML（和一般编程）相对较新，我试图声明一个变量并在导航到页面时为其分配一个值。我所拥有的是这样的一行代码：

```
function() navigate {window.location = "myPage.html?myVar=1";} 
```

当我运行该函数时，将加载新页面，但是每当我尝试访问该变量时，我都会收到一条错误消息，指出该变量未定义。但是，如果我在新页面中定义变量，例如`<script>var myVar;</script>`，该值将设置为 null，而不是我在之前使用的导航函数中尝试将其设置为的值。

我想不出任何解决方案，我的错误可能源于我对`?`url 末尾的工作原理的误解，但我无法很好地解释它在任何地方的工作原理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:06:31.360

查询字符串变量用于在我们请求页面时将数据传递给服务器，但是您仍然可以使用 javascript 访问它们，请查看这个 Stackoverflow 问题[How can I get query string values in JavaScript?](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:21:32.627

**查询字符串 - 在客户端和服务器端**

Javascript 是一种客户端脚本语言，不会将[查询字符串自动处理为变量。](http://en.wikipedia.org/wiki/Query_string)这通常由服务器端脚本语言完成，例如 PHP。

例如，在 PHP 的服务器端，您通常会将查询字符串值自动分配给`$_GET`数组，或者`$_GET['myVar']`在这种情况下。但在 Javascript 中情况并非如此，您需要自己处理查询字符串。

**片段标识符 - 将 URL 值传递给 Javascript**

在 Javascript 中，通过 URL 传递值的最常见方式实际上是通过[片段标识符](http://en.wikipedia.org/wiki/Fragment_identifier)而*不是*通过[查询字符串](http://en.wikipedia.org/wiki/Query_string)。

例如，您可以像这样传递两个变量：

```
myPage.html#myVar=1&myOtherVar=2 
```

在 JavaScript 中，`location.hash`变量将自动分配值`#myVar=1&myOtherVar=2`，您可以像这样进一步处理：

```
var location_vars = [];
var location_vars_temp = location.hash.replace('#',''); // Remove the hash sign
location_vars_temp     = location_vars_temp.split('&'); // Break down to key-value pairs
for (i=0; i < location_vars_temp.length; i++) {
    location_var_key_val = location_vars_temp[i].split('='); // Break down each pair
    location_vars[location_var_key_val[0]] = location_var_key_val[1];
} 
```

此时`location_vars`将是一个填充有传递值的数组，您将能够使用`location_vars['myVar']`和引用它们`location_vars['myOtherVar']`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:06:18.937

函数写错了。检查您的 javascript 控制台是否有错误。以下是在 javascript 中编写函数的方法示例：

```
 var navigate = function() { window.location = "myPage.html?myVar=1"; } 
```

或者

```
 function navigate() { window.location = "myPage.html?myVar=1"; } 
```

我提醒一下，这个名字`navigate`太笼统了。我会把它命名为`navigateToMyPage`.

我重新阅读了这个问题，并意识到您正在寻找一种从 url 获取参数的方法。

你会想做这样的事情：

```
 var navigateToMyPage = function() { window.location = "myPage.html?" + location.search; } 
```

这是一个相关的问题和解决方案： [如何从 GET 参数中获取值？](https://stackoverflow.com/questions/979975/how-to-get-the-value-from-url-parameter)

或者

如果你想传递一个 javascript 变量值，你可以这样做：

```
 var myVar = 1 + 1;
    var navigateToMyPage = function() { window.location = "myPage.html?myVar=" + myVar; } 
```

祝你好运！

# boost - Windows Phone 8 的提升？

> ID：14666476
> 
> 赞同：3
> 
> 时间：2013-02-02T21:01:00.867
> 
> 标签：boost, windows-phone-8

是否有适用于 Windows Phone 8 的 boost 二进制文件？我主要在寻找基本的东西，比如`shared_ptr`线程。请注意，线程既需要为 ARM 构建，又需要使用正确的平台调用，同时`shared_ptr`可以直接使用。

如果没有，我如何`boost::thread`为 Windows Phone 8 构建？

**更新：**我检查了 WinRT API 和 boost 源。boost 中的 windows 线程在很大程度上依赖于线程本地存储 (TLS)，但 WinRT 不支持这一点。然而，似乎有一些光纤本地存储（FLS），但它并不完全相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-04T21:03:11.280

2014 年 7 月 18 日有一个[官方页面，确认](http://blogs.msdn.com/b/vcblog/archive/2014/07/18/using-boost-libraries-in-windows-store-and-phone-applications.aspx)*Boost 中的一些库使用了 Windows Store 和 Phone 应用程序中不可用的 API，*因此*我们对 Boost 构建系统进行了改进，以支持面向 Windows Store 和 Phone 的 Windows 运行时*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-05T02:29:23.763

从 Visual Studio 2013 Update 4 开始，您可以编译使用[`TLS`API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686801(v=vs.85).aspx)的源代码，因为它们是作为转发到[`FLS`API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682664(v=vs.85).aspx)（与 Store 兼容）的内联实现的。显然，预编译的二进制文件不起作用，因为它们会尝试`TLS`直接绑定。

仅供参考，`TLS`不推荐使用/禁止的原因是因为如果线程终止，可能会泄漏内存。如果您`TLS`在 Store 应用程序中使用 API，它们将面临相同的潜在内存泄漏问题（[`FlsCallback`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682665(v=vs.85).aspx)提供给[`FlsAlloc`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682664(v=vs.85).aspx)is `null`），因此请考虑迁移到`TLS`并提供清理功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T23:46:51.577

I'm compiling against some static libraries that rely on boost so I don't think that's an issue at all.

# css - 用css封面覆盖页面时停止背景滚动？

> ID：14666478
> 
> 赞同：0
> 
> 时间：2013-02-02T21:01:22.827
> 
> 标签：css

有人可以告诉我，我正在使用封面在页面加载时创建（白色）遮光效果，下面是我正在使用的 css。有没有办法阻止鼠标滚动在后台上下移动页面？

```
#cover {
display:none;
position:absolute;
z-index:999999;
left:0px;
top:0px;
width:100%;
height:2648px;
background-color:#fff;
filter:alpha(Opacity=50);
opacity:0.7;
-moz-opacity:0.7;
-khtml-opacity:0.7
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:04:37.133

解决方案可能是添加“溢出：隐藏；” 给你的身体，在页面加载时，在页面加载时将其删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:04:46.827

问题是您使用的 Height:2648px 当然高于大多数屏幕，因此创建了滚动。

您可以通过使用解决此问题

**CSS**

```
#cover {height:100%;} 
```

**溢出法**

```
#cover {overflow:none;} 
```

另外，我不确定为什么首先高度是 2648px，但是如果您遇到溢出或高度：100% 的纵横比问题，请使用**[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)**来修复有问题的设备。

# java - 用于访问 volatile 实例变量的局部变量

> ID：14666479
> 
> 赞同：0
> 
> 时间：2013-02-02T21:01:27.073
> 
> 标签：java, oop, design-patterns, volatile

创建对已作为成员字段保存的静态 volatile 变量的本地引用的目的或价值是什么。这里的代码来自 java.util.Scanner JDK 6b14 [here](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Scanner.java#505)。

```
class Scanner {
    private static volatile Pattern linePattern;
    ...
    private static Pattern linePattern() {
        Pattern lp = linePattern;
        if (lp == null)
            linePattern = lp = Pattern.compile("...");
        return lp;
    }
    ...
} 
```

[Java 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html)：“对于声明为 volatile 的所有变量（包括 long 和 double 变量），读取和写入都是原子的……对 volatile 变量的任何写入都会与随后读取同一变量建立起先发生关系。”

这意味着读取对 Pattern 对象的引用不会因为它已经改变而中途失败。volatile 关键字应该准确地保护这些类型的访问，所以我不打算复制局部变量来确保返回有效值。

此外，可以在成员字段上完成延迟初始化，而无需中间局部变量：

```
if (linePattern == null) linePattern = Pattern.compile("..."); 
```

[它看起来是这里](https://stackoverflow.com/a/2786019/1163940)和[这里](http://mail.openjdk.java.net/pipermail/core-libs-dev/2010-May/004165.html)看到的字节码优化。使用局部变量会产生更小的字节码（更少的指令）以及对实际值的更少访问（这是一种昂贵的易失性读取）。但是他们并没有同时使用最终变量优化，所以我对得出这个结论持怀疑态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:04:05.850

[延迟初始化](http://en.wikipedia.org/wiki/Lazy_initialization)，即延迟工作直到真正需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:13:32.363

它保证返回值不为 NULL - 即使静态变量在检查和返回之间设置为 NULL。

同时它是一个不同步的惰性初始化，如果需要，它会重新初始化；）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T22:50:13.267

这“加速”了事情。访问`volatile`变量的成本很高。使用可以通过将其分配给堆栈变量并访问它来避免这种开销

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:05:04.150

对于`volatile`字段，`linePattern`可能会在不同的行之间发生变化。复制对局部变量的引用可以确保您不会有不一致的状态。例如，如果你写了

```
 if (linePattern == null)
    linePattern = Pattern.compile("..."); 
```

then`linePattern`可能在执行时*不再*为空`Pattern.compile`。

# php - 如何将 DIV 元素中的值提交到基于 PHP 的表单中

> ID：14666484
> 
> 赞同：2
> 
> 时间：2013-02-02T21:02:23.623
> 
> 标签：php, jquery, html

我有一个像复选框一样工作的 DIV 元素。我想将其“值”属性提交到基于 PHP 的表单中，但它不会将 DIV 响应传递给 PHP 文件。

HTML：

```
 <form action="test.php" method="post">
    <div id="test1" value="testvalue" name="test" checked="checked"></div>
    <input type="submit" />
 </form> 
```

PHP：

```
<?php
$test = $_POST['test'];
echo $test;
?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T21:04:18.487

只有表单元素被发送回服务器。如果要发送值，则需要创建一个输入元素。你可以考虑制作一个`<input type="hidden" name="test" value="testvalue"`.

为了响应您使用 jQuery 注释制作的自定义复选框，您可以使用 jQuery 设置隐藏输入元素的值。这将让您继续使用 div，但有一个值会被发送回服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T21:15:10.507

@andrew-jackman 说的是正确的，但我仍然在 jQuery 上摆弄了一下。

我包含了一个隐藏字段来管理数据并使用 jQuery 的切换来复制复选框功能

```
<form action="test.php" method="post">
  <div id="test1" value="testvalue"  checked="checked">
    <input type="hidden" name="test" id="hiddenfield" />
  </div>
<input type="submit" /> 
```

javascript

```
$('div#test1').toggle(function(){
  $('input#hiddenfield').val('checked');
  alert($('input#hiddenfield').val());
},function(){
  $('input#hiddenfield').val('');
  alert($('input#hiddenfield').val())
}) 
```

[http://jsfiddle.net/kumiau/nPEYw/1/](http://jsfiddle.net/kumiau/nPEYw/1/)

# import - Compass 在哪里寻找要导入的文件？

> ID：14666489
> 
> 赞同：0
> 
> 时间：2013-02-02T21:02:48.483
> 
> 标签：import, gem, compass-sass, sass

在 SCSS 文件中编写`@import`语句时，Compass 如何知道在哪里查找？

我认为这个问题没有得到很好的回答，我无法在文档中找到任何内容。

我一直在浏览各种 Ruby gem 的文件夹，有一次我认为任何名为的文件夹都被`stylesheets`添加到某个列表中（但在哪里？？）。然而，这不能是完整的解释，因为我还看到`@import`了不在此类文件夹中的 ' 引用文件。我也无法在 gems 中找到任何定义它的配置文件。

此信息位于何处*或*如何生成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:18:26.013

从[http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#import)：

> “Sass 在当前目录中查找其他 Sass 文件，以及 Rack、Rails 或 Merb 下的 Sass 文件目录。”

您可以通过将它们保存在导入文件旁边并将它们命名为“_[filename].scss”来快捷导入，然后使用@import“[filename]”导入它们

Compass scss/sass 文件位于您的 gem 路径中：

> gems/compass-[版本]/frameworks/compass/

# wcf - 带有额外信息的流式文件 WCF 4.5

> ID：14666492
> 
> 赞同：0
> 
> 时间：2013-02-02T21:03:24.583
> 
> 标签：wcf, .net-4.5, file-transfer

我正在设置一个需要接收文件的 web 服务，有时文件可能 > 10MB，所以我决定使用 WCF 4.5 中最新的流功能。不幸的是，如果它是方法中的唯一参数，我只能使用流，就像这样 -

```
public void SendLargeFile(Stream stream) 
```

那么我怎样才能获得与文件一起传递的更多信息，比如关于文件是什么以及需要用它做什么的变量？似乎只是发送文件有点没用。我想做的是这样的 -

```
public void SendLargeFile(Stream stream, string fileName, string customerName) 
```

我见过一些人在谈论消息，但与它需要做的所有事情相比，这似乎是一团糟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T14:32:21.470

`[DataContract]`您可以考虑为您的参数创建一个：

```
public void SendLargeFile(SendLargeFileRequest request) 
```

请求是：

```
[DataContract]
public class SendLargeFileRequest 
{
      [DataMember] 
      public Stream stream;
      [DataMember] 
      public string fileName;

      [...]
} 
```

这有助于您在将来更改您的请求，而无需修改您的签名`OperationContract`

# c# - 如何绕过多重继承

> ID：14666496
> 
> 赞同：0
> 
> 时间：2013-02-02T21:03:47.507
> 
> 标签：c#, inheritance, interface, abstract-class, multiple-inheritance

我正在尝试在 C# 中实现以下内容，以便我可以强制初始化父类中的某些事件委托和变量，或者我会使用接口。显然下面的语法不正确。

具体类是1类和2类。

这里的想法 MyClass 是一个按钮，它是一个图像，它是别的东西。

**编辑：** “我知道可选和其他不是对象而是状态。我真正想做的是编写代码以适当的方法维护可选状态，因为它们对所有人都是一样的。即点击事件（单击位置）检查我是否根据我的边界框单击，将状态更新为选中。我在 XNA 中，这是 ac# 轮询环境，我正在尝试使 GUI 尽可能地作为事件驱动，如果那样的话有意义吗？”

```
 public abstract class Class1
    {
        private int NumberNeededForMethod;

        private void methodThatOccursWhenEventHappens(int NumberNeededForMethod)
        {
            // stuff using NumberNeededForMethod;
        }

        private Class1(int NumberNeededForMethod)
        {
            MethodDelegate += methodThatOccursWhenEventHappens(int
            NumberNeededForMethod)
            ;
        }
    }

public abstract class Class2
    {
        private int NumberNeededForMethod2;

        private void methodThatOccursWhenEventHappens2(int NumberNeededForMethod2)
        {
            // stuff using NumberNeededForMethod2;
        }

        Class2(int NumberNeededForMethod2)
        {
            MethodDelegate += methodThatOccursWhenEventHappens(int NumberNeededForMethod2);
        }
    }

public class ClassThatIsBothClass1andClass2: Class1, Class2
{
    ClassThatIsBothClass1andClass2( int NumberNeededForMethod1, int NumberNeededForMethod2) : Class1(NumberNeededForMethod1),Class2(NumberNeededForMethod2)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:57:59.147

首先，当然，C# 不*支持*多重继承，所以无论你实现什么多态性都必须使用接口和组合来完成。

参考[此评论](https://stackoverflow.com/questions/14666496/how-to-get-around-multiple-inheritance?answertab=oldest#comment20499569_14666536)： ***Draggable***，***Selectable***和***Ownable***是对象的*属性*。

*另一方面， ***Image***和***Button*****是**对象。*

 *Button 不能是***Ownable***。

但是按钮*可以**是***Ownable、Draggable 或 Selectable。我想知道的是这些属性是否不仅仅是单个`IAshtonControl`界面上的属性？

可以想象一个按钮也可以是一个图像。这很有意义。

因为 C# 缺少多重继承，所以您根本无法创建从基类和基类`AshtonButton`派生的类。`Button``Image`

您*可以*做的一件事是创建一个`AshtonButton`实现该接口的类，该`IAshtonControl`接口的实现可以委托给一个工作类的私有实例，该实例执行所有`IAshtonControl`实例共有的任何工作。

或者，如果需要，您可以有单独`IOwnable`的 ,`IDraggable`和`ISelectable`接口。

无论哪种方式，都可以真实地做出声明，即`AshtonButton`是一个`IAshtonControl`，是可拥有的，是可拖动的，是可选择的。对于不同的控件，这些东西可能具有不同的含义（不同的行为/视觉效果），或者它们可能没有，但是您可以将这些实现细节隐藏在接口后面，以便您可以以编程方式以相同的方式处理每个对象，而不管其实现如何.

将对象与其属性分开很重要，因为这会影响您思考问题的方式。 *Draggable*不是一个东西，它是一个东西的特性。

但是，如果您的目标是让 a`Button`也是 a `Image`，那么某种类型的组合或委托就是实现该目标的方法。如果您有一个`IAshtonImage`接口，那么您将在`AshtonImage`类和类上实现它`AshtonImageButton`。然后你有一个类的内部实例（组合），`AshtonImage`在`AshtonImageButton`类中，并将对成员的调用委托给`IAshtonImage`私有（组合）`AshtonImage`实例，依此类推。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T21:07:41.747

您可以使用组合来创建一个包含 class1 和 class2 的类，并且该类可以响应您的按钮引发的事件。*

# ruby-on-rails-3 - 使用 fields_for 和 partial 生成多个关联实例只显示一个实例

> ID：14666499
> 
> 赞同：0
> 
> 时间：2013-02-02T21:04:11.667
> 
> 标签：ruby-on-rails-3, forms, model-associations

以前我能够呈现特定关联的多个实例（生成属于团队的多个角色 [团队有许多角色 - 角色属于团队] 但是在对布局进行一些更改后它不再这样做。我已经通读许多相关的线程，但似乎没有一个能解决我的问题。

我有一个多模型表单，我正在尝试构建多个角色关联并让它们在项目创建视图中多次呈现。我遇到的问题是它只会渲染一次。

```
#projects_controller.rb
def new
@user = current_user
@project = Project.new
@team = Team.new
@team = @project.build_team
#Default - New Project generates two roles through a team
2.times{@team.roles.new
        role = @team.roles.build}  
 end

#Models

  class Project < ActiveRecord::Base

    has_one :team, dependent: :destroy
    has_many :roles, :through => :team
     accepts_nested_attributes_for :team, :allow_destroy => :true
   end

 class Team < ActiveRecord::Base
      attr_accessible :name, :roles_attributes
      validates :project, presence: true
      belongs_to :project
      has_many :roles, dependent: :destroy

      accepts_nested_attributes_for :roles, :allow_destroy => :true
 end

class Role < ActiveRecord::Base
 belongs_to :team
end

#Views
#new.html.erb
 <%= form_for :project do |f| %>
      <%= render 'fields', :project_form => f %>
      <%= content_tag(:button, content_tag(:span, "Create Project"), {:class => "btn- cma-2 bolds", :type=>:submit}) %> 
     <% end %>

#_fields.html.erb 
  <%= project_form.fields_for :roles do |f| %>
        <%= render 'shared/role_fields', :role_form => f %>
   <% end %>

#_role_fields.html.erb
<div class="formAreaWhite clearfix">
  <div class="width350 fleft">
    <p class="blue">Title:</p>
    <div class="formArea"><%= role_form.collection_select(:role_title_id, @roletitles, :id, :title, {:prompt => "Select a Role"}, {:class=>"formSelect", :size => '1'}) %>
    </div>

    <p><span class="blue">Skills:</span>6/6</p>
  </div>

  <div class="width350 fright">
    <p class="blue">Duties:</p>
    <div class="formArea">

      <div class="formArea"><%= role_form.text_area :duty, :class=>"text300" %></div>
    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:05:18.133

我意识到了这个问题。我在更新模板时删除了 fields_for :team 标记，因为我希望隐藏团队值但存在关联。显然，团队实例必须出现在视图中才能建立角色关联。

一旦将此标签添加回视图中，就会按预期生成角色的实例。

# javascript - JavaScript 发送没有扩展库的帖子

> ID：14666503
> 
> 赞同：0
> 
> 时间：2013-02-02T21:04:19.780
> 
> 标签：javascript, forms, post, submit

我有带有 4 个提交按钮的导航表单。

```
<form action="index.php?do=move" method="post">
<center>
<input name="north" type="submit" value="North" /><br />
<input name="west" type="submit" value="West" /><input name="east" type="submit" value="East" /><br />
<input name="south" type="submit" value="South" />
</center>
</form> 
```

我需要制作 js 函数，当我按下键盘上的箭头时应该提交数据。这是我的解决方案，但 ut 不起作用:)

```
function read_key(event){
var form  = document.createElement('form');
    form.name = "arrows";
    form.method = "POST";
    form.action = "index.php?do=move";
    var sub = document.createElement('input');
    sub.type = "submit";
    if(event.keyCode==37){
        sub.name  = "west";}
    if(event.keyCode==38){
        sub.name  = "north";}
    if(event.keyCode==39){
        sub.name  = "east";}
    if(event.keyCode==40){
        sub.name  = "south";}   
    form.appendChild(sub);
    document.arrows.submit();
} 
```

并通过 body onkeypress = "read_key(event)" 将其连接到 html。有人可以帮我找出错误在哪里吗？我想在没有像 jQuery 这样的扩展库的情况下使用它。对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:18:15.820

您必须将表单附加到 DOM。这应该有效：

```
function read_key(event){
    if(event.keyCode >=37 && event.keyCode <=40) {
    var form  = document.createElement('form');
        form.name = "arrows";
        form.method = "POST";
        form.action = "index.php?do=move";
        var sub = document.createElement('input');
        sub.type = "submit";
        if(event.keyCode==37){
            sub.name  = "west";}
        if(event.keyCode==38){
            sub.name  = "north";}
        if(event.keyCode==39){
            sub.name  = "east";}
        if(event.keyCode==40){
            sub.name  = "south";}   
        form.appendChild(sub);
        // you have to append the form to body
        document.body.appendChild(form);
        // you can do it like that:
        // document.arrows.submit();
        // but simpler is:
        form.submit();
        // remove it after submit
        document.body.removeChild(form);
    }
} 
```

# c# - 3D 锯齿状阵列

> ID：14666507
> 
> 赞同：0
> 
> 时间：2013-02-02T21:04:37.630
> 
> 标签：c#, multidimensional-array, jagged-arrays

有没有办法像这样访问我的三维锯齿状数组：

```
jaggedArray[1,2,3]; 
```

到目前为止，我得到了以下代码片段：

```
 int[][] jaggedArray = new int[3][]
        {
            new int[] { 2, 3, 4, 5, 6, 7, 8 },
            new int[] { -4, -3, -2, -1, 0, 1},
            new int[] { 6, 7, 8, 9, 10 }
        };

        int[,,] dontWork = new int[,,] // expect 7 everywhere in the last dimension
        {
            { { 2, 3, 4, 5, 6, 7, 8 } },
            { { -4, -3, -2, -1, 0, 1} },
            { { 6, 7, 8, 9, 10 } }
        }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:09:15.227

至于第一个问题，您正在尝试访问锯齿状数组的第一个元素的第二个元素的第三个元素：

```
jaggedArray[1][2][3] 
```

至于错误，3D 数组期望维度的每个元素中的元素数量相同。为简单起见，假设您有一个 2D 锯齿状数组，粗略表示内存中的样子：

```
First row  -> 2,   3,  4,  5, 6, 7, 8
Second row -> -4, -3, -2, -1, 0, 1
Third row  -> 6,   7,  8,  9, 10 
```

您可以看到每一行都被视为不同的数组，因此大小可能不同。但是，多维数组不具有此属性。它需要完全填充：

```
Column    :  0    1   2   3   4  5  6
------------------------------------
First row :  2,   3,  4,  5,  6, 7, 8
Second row: -4,  -3, -2, -1,  0, 1 
Third row :  6,   7,  8,  9, 10 
```

您的表格缺少一些单元格，这是没有意义的。您需要在每个维度上使用相同数量的元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T21:34:19.617

You got the syntax for declaring 2D jagged array right, 3D jagged arrays are an extension of that. For example:

```
int[][][] jagged3d = new int[][][]
{
    new int[][] { new int[] { 111, 112 }, new int[] { 121, 122, 123 } },
    new int[][] { new int[] { 211 } }
} 
```

But to access it, you need different syntax:

```
jagged3d[0][1][2] 
```

# php - GD Captcha 安全表单出现空白

> ID：14666513
> 
> 赞同：1
> 
> 时间：2013-02-02T21:05:30.543
> 
> 标签：php, image, captcha

所以我正在尝试为我的注册表单制作一个验证码表格，但我不确定出了什么问题，因为每当我打开页面时，我都会看到在找不到图像的 url 时显示的图像（我会发布一张图片，但我不能，因为这是我的第一个问题）。

我不确定我做错了什么，因为我在制作教程时正在遵循教程，它似乎对他们有用。此外，没有显示任何错误，所以我不知道可能出了什么问题。我的代码在这里：

```
<?php
session_start();
header('Content-type: image/jpeg');

$text = 4539;
$font_size = 4;
$image_height = 40;
$image_width = 200;
$image = imagecreate($image_width, $image_height);
imagecolorallocate($image, 255, 255, 255);
$font_colour = imagecolorallocate($image, 0, 0, 0);
// Set the enviroment variable for GD
putenv('GDFONTPATH=' . realpath('.'));

// Name the font to be used (note the lack of the .ttf extension)
$font = 'font';
imagettftext($image, 0, 15, 30, $font_colour, $font, $text);
?> 
```

此外，当我知道代码有效时，$text 变量将被设置为随机，该值是静态的，用于测试目的。我会很感激我能得到的任何帮助。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:09:07.180

添加文本后，您需要将图像输出到浏览器：

```
imagettftext($image, 0, 15, 30, $font_colour, $font, $text);
imagepng($image);
imagedestroy($image); 
```

由于脚本完成后 php 进程退出，因此可能并不严格需要销毁，但[示例](http://www.php.net/manual/en/function.imagepng.php)中有它，所以我将其包含在内。

此外，您可以使用或选择 png、gif 和 jpeg 图像`imagepng()`格式。png格式在这里应该很好。`imagegif()``imagejpeg()`

# php - 如何在网站中存储和管理用户的图像

> ID：14666514
> 
> 赞同：0
> 
> 时间：2013-02-02T21:05:31.640
> 
> 标签：php, image, image-uploading, image-upload

我正在创建一个约会网站，用户可以在其中上传他们的图片，有些是私人的，有些是公开的。

我计划做的是保存所有上传的图像，当我想展示它们时，我会有一个脚本来调用它们。

即：url-> mysite.com/members/mainimage/5

处理这个调用的函数是： public function mainImage($user) {

```
 $this->load->model('tables/user_images_table');
    $image = $this->user_images_table->getMainUserImage($user);

    if($image != null ) {
        $imageExploded = explode('.',$image);

        switch( $imageExploded[1] ) {
            case "gif": $ctype="image/gif"; break;
            case "png": $ctype="image/png"; break;
            case "jpeg":
            case "jpg": $ctype="image/jpg"; break;
            default:
        }
        $imagePath = 'uploads/'.$image;
    } else {
        //default image
        $imagePath = 'inner/default.png';
        $ctype = 'image/png';
    }

    header('Content-type: '.$ctype);
    readfile(base_url()."images/".$imagePath);
} 
```

但是当我看到我的网站越来越大时，我注意到每个用户图像请求我的所有应用程序文件都已加载，这可能会减慢我的网站速度。

你知道如何保存私人图像（不会通过 url 公开，只有在对用户进行一些检查之后）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:31:00.097

store your private images in some folder, also place there `.htaccess` with such code:

```
deny from all 
```

so now no one can access these files via http directly

then create `.htaccess` in the root of your site and copy these lines there:

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^private-photo/([0-9]+)\.(jpg|jpeg|gif|png)$ private_photo.php?id=$1 [QSA,L] 
```

so now all http requests like [http://site.com/private-photo/113.jpg](http://site.com/private-photo/113.jpg) will be redirected to private_photo.php

so the final step is: you create private_photo.php where you get id of image from `$_GET["id"]`, make security checkings - if the user who requests the photo has an access to it, and then `fopen/fpassthru` the image or just displaying an error about restricted access

# numpy - 从 numpy 数组创建稀疏矩阵

> ID：14666521
> 
> 赞同：3
> 
> 时间：2013-02-02T21:06:19.487
> 
> 标签：numpy

我需要使用 numpy 数组中的值创建一个矩阵。这些值应根据索引数组分布在矩阵行上。

像这样：

```
>>> values
array([ 0.73620381,  0.61843002,  0.33604769,  0.72344274,  0.48943796])
>>> inds
array([0, 1, 2, 3, 2])
>>> m = np.zeros((4, 5))
>>> for i, (index, value) in enumerate(zip(inds, values)):
        m[index, i] = value
>>> m
array([[ 0.73620381,  0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0.61843002,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0\.        ,  0.33604769,  0\.        ,  0.48943796],
       [ 0\.        ,  0\.        ,  0\.        ,  0.72344274,  0\.        ]]) 
```

我想知道是否有一种矢量化的方式来做到这一点，即没有循环。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:51:22.050

以下是您可以如何使用[精美的索引](http://www.scipy.org/Tentative_NumPy_Tutorial#head-0dffc419afa7d77d51062d40d2d84143db8216c2)来做到这一点：

```
>>> values
array([ 0.73620381,  0.61843002,  0.33604769,  0.72344274,  0.48943796])
>>> inds
array([0, 1, 2, 3, 2])
>>> mshape = (4,5)
>>> m = np.zeros(mshape)
>>> m[inds,np.arange(mshape[1])] = values
>>> m
array([[ 0.73620381,  0\.        ,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0.61843002,  0\.        ,  0\.        ,  0\.        ],
       [ 0\.        ,  0\.        ,  0.33604769,  0\.        ,  0.48943796],
       [ 0\.        ,  0\.        ,  0\.        ,  0.72344274,  0\.        ]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-31T05:40:29.783

您的`values`和`inds`数组可以用作`scipy.sparse`构造函数的输入（类似于 Matlab 中的稀疏）。

```
from scipy import sparse
values = np.array([ 0.73620381,  0.61843002,  0.33604769,  0.72344274,  0.48943796])
inds=np.array([0,1,2,3,2])
index = np.arange(5)
m=sparse.csc_matrix((values,(inds,index)),shape=(4,5))
m.todense()  # produces a matrix or
m.toarray() 
```

# php - 静态数据库连接作为函数的参数

> ID：14666523
> 
> 赞同：1
> 
> 时间：2013-02-02T21:06:29.800
> 
> 标签：php, database, function, parameters

从今天开始，我将非静态数据库的变量传递给我的 php 项目的函数，这需要数据库访问。我阅读了有关多个数据库连接的所有内容，因此我将数据库连接更改为静态函数，因此我在所有函数中都可以访问我的数据库连接，而无需将其作为函数参数传递。因此，可以通过使用例如 myDatabaseConnection::myFirstdatabase->prepare 等来访问我的数据库连接（甚至是不同的数据库）...

问题是：什么是最佳实践？这样做好不好。我的一些函数（例如从数据库中读取一些数据）依赖于数据库连接，但是如果我从函数的参数中删除数据库连接变量，在我看来，某些东西（一种依赖关系）丢失了.

那么最好的做法是什么？您是否将数据库连接作为变量传递给需要数据库访问的函数？

非常感谢。

我理解连接的事情。但是我项目中的其他功能呢？例如从数据库中读取所有成员名称的函数？您是否将数据库连接变量传递给该函数，或者您是否使用我的“全局”静态数据库连接访问该函数内部的数据库连接。我知道，它不是全局的，但我的静态数据库连接可以从任何地方访问......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:19:57.423

```
<?php
require_once('CLASSdatabase.php');

class AUTHENTICATE{
    private $user_database_object;
    private $current;
    private $email_id;
    private $password;
    private $error;

    function __construct($email_id,$password){
        $this->user_database_object=new MYSQL_DATABASE("user");
        $this->email_id=$email_id;
        $this->password=$password;
    }

    private function verify_password(){
        $sql="select password from `users` where email_id='";
        $sql.=$this->email_id."';";
        $this->user_database_object->open_connection();
        $row=$this->user_database_object->fetch_array($this->user_database_object->query($sql));
        // code ...
        $this->user_database_object->close_connection();
    }
}
// code ..
?> 
```

`CLASSdatabase.php`

```
<?php
require_once("config.php");

    class MYSQL_DATABASE{
        private $dbname;
        private $connection;
        public $last_query;

        function __construct($dbname){
        $this->dbname=$dbname;
        }

        public function open_connection(){
        }
        public function close_connection(){
        }
        public function query($sql){
        }
        public function fetch_array($result_set){
        }
        // code ...
    }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:14:24.533

您的数据库连接对象应该在实例化时注入它的依赖项。然后你的类是可重用的。恕我直言

# java - 带有微调器的 Android 空指针异常

> ID：14666528
> 
> 赞同：1
> 
> 时间：2013-02-02T21:06:34.770
> 
> 标签：java, android, xml, nullpointerexception, spinner

我收到此错误，但我不知道为什么：

```
02-02 22:00:59.207: E/java.lang.NullPointerException(6258): null
02-02 22:00:59.207: E/java.lang.NullPointerException(6258): java.lang.NullPointerException
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.Spinner.measureContentWidth(Spinner.java:682)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.Spinner.onMeasure(Spinner.java:442)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1404)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:695)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1404)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureHorizontal(LinearLayout.java:1052)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:590)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1404)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:695)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.ScrollView.measureChildWithMargins(ScrollView.java:1217)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.ScrollView.onMeasure(ScrollView.java:321)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:847)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2176)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.View.measure(View.java:15513)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1874)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1089)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1265)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:989)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4351)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.Choreographer.doCallbacks(Choreographer.java:562)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.Choreographer.doFrame(Choreographer.java:532)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.os.Handler.handleCallback(Handler.java:725)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.os.Looper.loop(Looper.java:137)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at android.app.ActivityThread.main(ActivityThread.java:5191)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at java.lang.reflect.Method.invokeNative(Native Method)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at java.lang.reflect.Method.invoke(Method.java:511)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
02-02 22:00:59.207: E/java.lang.NullPointerException(6258):     at dalvik.system.NativeStart.main(Native Method) 
```

我有这样的代码，可能触发了错误：

```
spBarausLangbezeichnung = (Spinner) findViewById(R.id.barauslage_eingabe_spbarauslagebezeichnung);
final List<BarausInfo> barausInfos = getHelper().getRTE(BarausInfo.class).queryForAll();
    adapterBarausLangbezeichnung = new SpinnerArrayAdapter<BarausInfo>(this, barausInfos) {
      public void set(View v, int position, List<BarausInfo> barInfos) {
        ((TextView) v).setText(barInfos.get(position).BarausLang.Bezeichnung);
      }
    };
    spBarausLangbezeichnung.setAdapter(adapterBarausLangbezeichnung); 
```

SpinnerArrayAdapter 是（从互联网上得到的）：

```
public abstract class SpinnerArrayAdapter<T> extends ArrayAdapter<T> {
  private List<T> items;
  private Activity activity;

  public SpinnerArrayAdapter(Activity activity, List<T> items) {
    super(activity, android.R.layout.simple_list_item_1, items);
    this.items = items;
    this.activity = activity;
  }

  public abstract void set(View v, int position, List<T> items);

  @Override
  public View getDropDownView(int position, View convertView, ViewGroup parent) {
    TextView v = (TextView) super.getView(position, convertView, parent);
    if (v == null) {
      v = new TextView(activity);
    }
    v.setTextColor(Color.BLACK);
    set(v, position, items);
    return v;
  }

  @Override
  public T getItem(int position) {
    return items.get(position);
  }

  @Override
  public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;

    if (v == null) {
      LayoutInflater inflater = activity.getLayoutInflater();
      v = inflater.inflate(android.R.layout.simple_spinner_item, null);
    }
    TextView lbl = (TextView) v.findViewById(android.R.id.text1);
    lbl.setTextColor(Color.BLACK);
    set(v, position, items);
    return convertView;
  }
} 
```

如果您在代码中看到任何错误，请告诉我。我从错误中看到的只是一些宽度和高度测量功能，但这并不能告诉我任何事情。

编辑：我的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.22"
                android:text="@string/texteinsatzvonbis" />

            <TextView
                android:id="@+id/barauslage_eingabe_einsatzvon"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="02.02.2012" />

            <TextView
                android:id="@+id/barauslage_eingabe_einsatzbis"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="02.04.2012" />
        </LinearLayout>

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/textbarauslagedatum" />

        <TextView
            android:id="@+id/barauslage_eingabe_barauslagedatum"
            style="@android:style/Widget.Button.Small"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >
        </TextView>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical" >

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/textbarauslagebezeichnung" />

                <Spinner
                    android:id="@+id/barauslage_eingabe_spbarauslagebezeichnung"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:padding="0dip" />
            </LinearLayout>
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.22"
                android:orientation="vertical" >

                <Spinner
                    android:id="@+id/barauslage_eingabe_spbarauslagewaehrung"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:padding="0dip" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"

                android:orientation="vertical" >

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent"
                    android:text="@string/textbarauslagemenge" />

                <EditText
                    android:id="@+id/barauslage_eingabe_editbarauslagemenge"
                    android:layout_width="60dip"
                    android:layout_height="wrap_content"
                    android:inputType="number" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="vertical" >

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent"
                    android:text="@string/textbarauslageeinzelpreis" />

                <EditText
                    android:id="@+id/barauslage_eingabe_editbarauslageeinzelpreis"
                    android:layout_width="140dip"
                    android:layout_height="wrap_content"
                    android:inputType="numberDecimal" />
            </LinearLayout>
        </LinearLayout>

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/textbarauslagebemerkung" />

        <EditText
            android:id="@+id/barauslage_eingabe_editbarauslagebemerkung"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1.22"
            android:inputType="textMultiLine"
            android:maxLength="30"
            android:scrollbars="vertical" />

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="bottom"
            android:orientation="horizontal" >

            <ImageButton
                android:id="@+id/btnspeichern"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:src="@drawable/ic_save_selected" />

            <ImageButton
                android:id="@+id/btnrevert"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:src="@drawable/ic_revert" />

            <Button
                android:id="@+id/btnabbrechen"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:text="@string/abbrechen" />
        </LinearLayout>
    </LinearLayout>

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:45:55.490

把问题解决了。现在我希望自己能够成功，因为我找到了一个，而且我相信这个问题已经解决了。

笔记

```
return convertView; 
```

应该读

```
return v; 
```

# c# - 如何在后面的代码中全局引用对象（gridview）

> ID：14666538
> 
> 赞同：2
> 
> 时间：2013-02-02T21:07:46.263
> 
> 标签：c#, asp.net, .net, gridview

有什么方法可以在页面后面的代码中将 GridView 对象作为变量引用，这样我就可以引用它一次而不是多次？

我试图让我的代码更容易更新，更容易传输。我必须使用的参考越少越好！

这是我的代码目前看起来如何的一个示例，必须有更好的方法在每个 void 范围之外声明 var GridView_ 变量？

```
public class GlobalVars
{
    // Button Toggle
    public static bool boolToggleView = false;

    // Column Indexes
    public static int Column1Index = new int();     
}

protected void GetColumnIndexes()
{
    // GridView Variable
    var GridView_ = GridViewName;

    // Column Indexes
    GlobalVars.Column1Index = Utility.GetColumnIndexByName(GridView_, "Column1");
}   

protected void Button1_Click(object sender, EventArgs e)
{
    // GridView Variable
    var GridView_ = GridViewName;

    if (GlobalVars.boolToggleView)
    {
        GlobalVars.boolToggleView = false;
    }
    else
    {
        GlobalVars.boolToggleView = true;
    }

    // Bind GridView
    GridView_.DataBind();
} 
```

# objective-c - 以编程方式调用 CCMenuItem 的块

> ID：14666539
> 
> 赞同：1
> 
> 时间：2013-02-02T21:07:48.540
> 
> 标签：objective-c, cocos2d-iphone

我有以下 CCMenuItem：

```
 menuItem = [CCMenuItemImage itemWithNormalImage:@"example.png" selectedImage:@"example2.png" disabledImage:@"example3.png" block:^(id sender) {
        // do some important things.
    }]; 
```

其中 menuItem 是一个全局实例变量。

有没有办法以编程方式调用 menuItem 的块代码？还是我必须在其中包装另一个函数然后调用它？例如

```
 menuItem = [CCMenuItemImage itemWithNormalImage:@"example.png" selectedImage:@"example2.png" disabledImage:@"example3.png" block:^(id sender) {
        [self doThings];
    }];

    ...
    - (void) doThings {
      // do some important things.
    } 
```

我宁愿只以编程方式调用块代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:17:50.397

您可以致电：

> [菜单项激活]；

这将调用块或回调。这种方法唯一需要注意的是，要使用 vanilla 框架方法，不得禁用菜单项。（必须有 menuItem.isEnabled = YES）

不过，我更喜欢使用您的第二种方法，并使用包装方法并在外部调用它，这正是因为我提到的警告。

# python - 如果客户期望它，python 启用 ssl

> ID：14666542
> 
> 赞同：1
> 
> 时间：2013-02-02T21:08:12.080
> 
> 标签：python, sockets, ssl, serversocket

如果有什么方法可以知道客户端是否希望服务器启用 SSL？

我正在构建一个小型 SMTP 服务器并在 465 上实现了 SSL，但一些客户端不期望 SSL，因此显然连接失败。

有没有可能以任何方式告诉这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:29:03.027

服务器没有干净的方法来检测客户端是否希望在连接开始时使用 SSL/TLS。事实上，如果期望服务器首先发送数据（就像 SMTP 的情况：服务器在客户端发送任何数据之前发送横幅），那么根本没有办法做到这一点。

这就是 SSL/TLS 通常以以下两种方式之一使用的原因：

*   为协议的 SSL/TLS 版本指定了一个新的端口号。例如，HTTP（端口 443 而非端口 80）、IMAP（端口 993 而非端口 143）、SMTP（端口 465 而非 25 或 587）。如果服务器接受新端口上的连接，它就会立即知道使用 SSL/TLS。
*   [STARTTLS](http://en.wikipedia.org/wiki/STARTTLS)：服务器和客户端通过协议的非 SSL/TLS 版本开始，但服务器在其服务能力声明中指示 STARTTLS。客户接受报价并提出要求。服务器和客户端现在都使用 SSL/TLS 重新启动协议。

STARTTLS 的效率有点低，因为服务器和客户端之间的非 SSL/TLS 对话首先发生（使用多个网络往返）并且它不适用于所有协议（HTTP 不支持它），但是如果可用，它通常是首选，因为它可以更轻松地自动配置电子邮件设置（无需探测一堆可能的端口并选择最好的端口）。

端口 465 是第一个解决方案的示例：选择一个新端口并在其上运行 SSL/TLS。这意味着服务器和客户端都应该立即使用 SSL/TLS 在该端口上进行通信。

如果您看到客户端尝试在端口 465 上使用纯文本 SMTP，**则这些客户端是 BROKEN**。真的没有什么可以解决的。客户有严重的错误，应该修复......

此外，对于 SMTP，[您确实需要使用 STARTTLS，而不是 SMTP over SSL/TLS on port 465](http://www.imc.org/ietf-apps-tls/mail-archive/msg00204.html)。

# svg - D3.js 语义缩放和平移示例不起作用

> ID：14666543
> 
> 赞同：0
> 
> 时间：2013-02-02T21:08:16.180
> 
> 标签：svg, d3.js, zooming, pan

我正在尝试为 D3.js 实现一个版本的 SVG Semantic Zoom and Pan 示例，在[此处](http://bl.ocks.org/3680957)找到。按照 Mike Bostock（[此处](https://groups.google.com/forum/?fromgroups=#!topic/d3-js/A8eROvFjOVI)）的建议，我正在尝试使用 Dendrogram / 树（此处为示例）来执行此[操作](http://bl.ocks.org/4063570)。[目标就像其他线程之一提到](http://jsfiddle.net/ia22/UVJA8/)的这个 jsFiddle ，除了没有奇怪的节点/路径取消链接行为。我的个人尝试位于[此处](http://jsfiddle.net/faren451/6kEpp/)。

我在使用 Mike 的代码的 Firebug 中遇到错误，关于“无法翻译（NaN，NaN）”，因此我将缩放功能中的代码更改为如下所示。但是，行为很奇怪。现在 1）我的路径不缩放/移动，2）我只能从右下角--左上角平移节点（如果我尝试从左下角--右上角平移，节点仍然沿着 LR-UL 移动方向）。

```
var vis = d3.select("#tree").append("svg:svg")
              .attr("viewBox", "0 0 600 600")
              .attr("width", w + m[1] + m[3])
              .attr("height", h + m[0] + m[2])
              .append("svg:g")
              .attr("transform", "translate(" + m[3] + "," + m[0] + ")")
              .call(d3.behavior.zoom().x(x).y(y).scaleExtent([1,8]).on("zoom",zoom));

// zoom in / out
function zoom() {
    var nodes = vis.selectAll("g.node");
    nodes.attr("transform", transform);
}

function transform(d) {
    return "translate(" + x(d.y) + "," + y(d.x) + ")";
} 
```

[我尝试遵循上面](https://groups.google.com/forum/?fromgroups=#!topic/d3-js/A8eROvFjOVI)提到的 Google Groups 线程和[jsFiddle](http://jsfiddle.net/ia22/UVJA8/)中给出的其他解决方案，但我没有取得太大进展。在我的代码中包含来自 jsFiddle 的路径链接和 translate() 函数让我可以缩放路径——除了 1）它们垂直翻转（某处 x 和 y 转置无法正常工作）；2）路径不以与节点相同的速率缩放（可能与＃1有关），因此它们变得“未链接”；3）当我平移时，路径现在向各个方向平移，但节点不移动。当我单击一个节点展开树时，路径会重新调整并自行修复，因此更新代码似乎工作得更好（但我不知道如何识别/复制其中的工作部分）。[在这里](http://jsfiddle.net/faren451/6kEpp/)查看我的代码。

```
function zoom(d) {
    var nodes = vis.selectAll("g.node");
    nodes.attr("transform", transform);

    // Update the links...
    var link = vis.selectAll("path.link");
    link.attr("d", translate);
}

function transform(d) {
    return "translate(" + x(d.y) + "," + x(d.x) + ")";
}

function translate(d) {
    var sourceX = x(d.target.parent.y);
    var sourceY = y(d.target.parent.x);
    var targetX = x(d.target.y);
    var targetY = (sourceX + targetX)/2;
    var linkTargetY = y(d.target.x0);
    var result = "M"+sourceX+","+sourceY+" C"+targetX+","+sourceY+" "+targetY+","+y(d.target.x0)+" "+targetX+","+linkTargetY+"";
    //console.log(result);

   return result; 
```

我的问题是：

*   我可以查看树形图/树上的缩放/平移的任何工作示例吗？
*   使用我上面的代码，任何人都可以确定路径在哪里/如何被翻转？我在绘制 SVG Cubic Bezier 曲线的 translate() 函数中尝试了各种排列，但似乎没有任何效果。同样，我的 jsFiddle 在[这里](http://jsfiddle.net/faren451/6kEpp/)。
*   为什么平移只能部分起作用的任何故障排除提示或想法？

谢谢你们每一个人的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T18:52:37.400

你有一个很好的实现，但由于一个主要的错字而出轨：

```
function transform(d) {
    return "translate(" + x(d.y) + "," + x(d.x) + ")";
} 
```

本来应该

```
function transform(d) {
    return "translate(" + x(d.y) + "," + y(d.x) + ")";
} 
```

为了让你的路径不翻转，你可能不应该反转 y 轴：

```
y = d3.scale.linear().domain([0, h]).range([h, 0]) 
```

变成

```
y = d3.scale.linear().domain([0, h]).range([0, h]) 
```

修复在这里：http: [//jsfiddle.net/6kEpp/2/](http://jsfiddle.net/6kEpp/2/)。但是为了将来参考，您可能应该让您的 x 轴对 x 值进行操作，而 y 轴对 y 值进行操作，否则您只会让自己感到困惑。

**完善您的实施的最后评论：**

1.  从默认渲染（或在打开/关闭节点之后）到缩放实现的贝塞尔绘图中有一点跳跃。你只需要使那些相同的贝塞尔函数，当你玩它时感觉会好很多。
2.  您需要在图形重绘后根据现有节点的相对移动更新缩放矢量。否则，在打开/关闭节点后再次尝试缩放时会出现突然的跳跃。

# android - 适用于 iPhone 和 Android 的加密

> ID：14666552
> 
> 赞同：1
> 
> 时间：2013-02-02T21:09:44.643
> 
> 标签：android, iphone, encryption

我正在尝试编写一个加密类，允许 iPhone 向 Android 发送加密文本，反之亦然。虽然这在 Android 中非常简单（以下代码）

```
 private static final String CIPHER_ALGORITHM = "AES";
private static final String RANDOM_GENERATOR_ALGORITHM = "SHA1PRNG";
private static final int RANDOM_KEY_SIZE = 128;

// Encrypts string and encode in Base64
public static String encrypt( String password, String data ) throws Exception 
{
    byte[] secretKey = generateKey( password.getBytes() );
    byte[] clear = data.getBytes();

    SecretKeySpec secretKeySpec = new SecretKeySpec( secretKey, CIPHER_ALGORITHM );
    Cipher cipher = Cipher.getInstance( CIPHER_ALGORITHM );
    cipher.init( Cipher.ENCRYPT_MODE, secretKeySpec );

    byte[] encrypted = cipher.doFinal( clear );
    String encryptedString = Base64.encodeToString( encrypted, Base64.DEFAULT );

    return encryptedString;
}

// Decrypts string encoded in Base64
public static String decrypt( String password, String encryptedData ) throws Exception 
{
    byte[] secretKey = generateKey( password.getBytes() );

    SecretKeySpec secretKeySpec = new SecretKeySpec( secretKey, CIPHER_ALGORITHM );
    Cipher cipher = Cipher.getInstance( CIPHER_ALGORITHM );
    cipher.init( Cipher.DECRYPT_MODE, secretKeySpec );

    byte[] encrypted = Base64.decode( encryptedData, Base64.DEFAULT );
    byte[] decrypted = cipher.doFinal( encrypted );

    return new String( decrypted );
}

public static byte[] generateKey( byte[] seed ) throws Exception
{
    KeyGenerator keyGenerator = KeyGenerator.getInstance( CIPHER_ALGORITHM );
    SecureRandom secureRandom = SecureRandom.getInstance( RANDOM_GENERATOR_ALGORITHM );
    secureRandom.setSeed( seed );
    keyGenerator.init( RANDOM_KEY_SIZE, secureRandom );
    SecretKey secretKey = keyGenerator.generateKey();
    return secretKey.getEncoded();
}
} 
```

我已经看到了几十个关于类似主题的答案，但没有得到一段真正有效的 iOS 代码，它给出了相同的结果。大多数代码甚至都无法正确编译。有人有一个真正的工作代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:37:38.797

请参阅iOS 上的[RNCryptor和 Java 上的](https://github.com/rnapier/RNCryptor)[JNCryptor](http://cryptonode.org/jncryptor/)。它们实现相同的文件格式。它正确处理带有随机 IV 的 AES-CBC-256、带有随机盐的 PBKDF2 生成的密码，以及用于数据身份验证和完整性的经过验证的 HMAC。

# mysql - 在 wordpress 中使用 get_user 进行排序

> ID：14666553
> 
> 赞同：3
> 
> 时间：2013-02-02T21:10:06.957
> 
> 标签：mysql, sql, wordpress

我有`wp_users`一个表，它有一个列排序。我开始知道`get_users()`返回所有用户。
我正在使用它，就像`get_users('orderby=ordering')`
我从[这个链接获得帮助一样](http://codex.wordpress.org/Function_Reference/get_users)

但不幸的是，它没有按排序列排序。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:19:42.740

您应该首先查看数据库中的用户表。您尝试的命令很好，但您用于排序的参数可能是错误的。您应该按用户表中的列排序，例如用户名或用户 ID。

在您提到的链接上，我发现了这些：

orderby - 按 'ID'、'login'、'nicename'、'email'、'url'、'registered'、'display_name' 或 'post_count' 排序。

顺序 - ASC（升序）或 DESC（降序）。

一些工作示例：

通过 nicename 获取用户：

```
$users = get_users('orderby=nicename'); 
```

其他示例：

显示按帖子计数排序的用户，降序

```
$user_query = new WP_User_Query( array ( 'orderby' => 'post_count', 'order' => 'DESC' ) ); 
```

显示用户已注册，升序排列

```
$user_query = new WP_User_Query( array ( 'orderby' => 'registered', 'order' => 'ASC' ) ); 
```

# streaming - Red5 媒体服务器 - 简单订阅者/连接按钮不起作用

> ID：14666554
> 
> 赞同：0
> 
> 时间：2013-02-02T21:10:07.427
> 
> 标签：streaming, red5

我正在尝试测试 Red5 媒体服务器提供的演示。我对 Simple Broadcaster 应用程序更感兴趣。当我在我的机器（OS Ubuntu 12.04 - Mozilla Firefox）上测试它时它工作正常，但是当我尝试从本地网络上的另一台机器连接时，连接按钮机器什么都不做（Windows 7 - Mozilla Firefox/Internet Explorer）。我知道 Flash Player 已安装并更新到最新版本。

你有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T21:05:40.600

The ports that the Red5 server uses need to be opened on your local machine for others to be able and connect to it. So basically what you need to do is open ports 5080 and 1935\.

I used these commands in the terminal:

```
iptables -A INPUT -p tcp -d 0/0 -s 0/0 --dport 5080 -j ACCEPT 
```

and

```
iptables -A INPUT -p tcp -d 0/0 -s 0/0 --dport 1935 -j ACCEPT 
```

# javascript - Mustache.js 完成模板渲染后如何运行回调

> ID：14666557
> 
> 赞同：10
> 
> 时间：2013-02-02T21:10:15.307
> 
> 标签：javascript, jquery, mustache

一旦 Mustache.js 完成渲染模板并将其插入到 DOM 中，是否有一种干净的方法来定义/运行回调函数？例如，像这样：

```
Mustache.render(template, viewModel, function() {...}); 
```

我能想到的最好的方法是计算视图模型中将插入 DOM 的节点数，然后使用 setInterval 检查 DOM 中是否存在这么多节点。一旦他们这样做了，我就可以调用我想要的函数。这对我来说似乎效率低下并且可能有问题，但我不知道还能做什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-31T04:19:16.307

与 mustache 无关，实际上是关于 jQuery .html()。

$('.your_div').html(rendered).promise().done(function() {

```
// do your stuff 
```

});

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-30T09:57:32.470

你不需要对 mustache.js 的`render()`函数进行回调，因为它是同步的。jquery`.html()`也是同步的。

如果您真的需要回调（无论出于何种原因），您可以自己编写代码：

```
var myrender = function(template, viewModel, callback)
{
    Mustache.render(template, viewModel);
    if(typeof callback === "function")
        callback();
}

// usage:
myrender(my_template, my_viewModel, function(){
    alert("I can do anything here!");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T19:33:02.923

~~如果您还使用 jQuery，则可以使用：~~

 ~~```
$("#element").ready(function() {
  // do something when Mustache.js has finished rendering
}); 
```~~  ~~Mustache.js 能够流式传输模板结果。这在项目的文档中有所描述，但[最近被删除](https://github.com/janl/mustache.js/commit/c6aef7ea1299273038a033ed96adc6dd8237d329)。我不确定这是否是故意的，但它似乎仍然有效。`Mustache.to_html`这描述了每次渲染模板块时调用的函数的可选回调参数。也许这可以帮助您解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-20T14:19:59.830

你可以使用这样的东西：

```
displayData: function () {
    app.renderTemplate("test", app.data, function (returnValue) {
        $('.result').append(returnValue);
    });

},

renderTemplate: function (templatefile, data, callback) {
    var tpl = 'views/' + templatefile + '.mst';
    $.ajax(tpl,
        {
            dataType: "text",
            success: function (template) {
                var rendered = Mustache.render(template, data);
                callback(rendered);
            }
        });
} 
```

详细的操作方法可以在这里找到： [https ://www.chaensel.de/mustache-js-return-rendered-result-to-callback-function/](https://www.chaensel.de/mustache-js-return-rendered-result-to-callback-function/)~~

# ios - 追加到 NSString 方法的开头

> ID：14666558
> 
> 赞同：8
> 
> 时间：2013-02-02T21:10:42.013
> 
> 标签：ios, objective-c, swift, nsstring, append

我想在 NSString`A`前面附加 NSString `B`。是否有内置方法可以附加到 NSString 的开头而不是 NSString 的结尾？

我知道我可以使用，但是使用和将文本添加到 NSString 的末尾有`stringWithFormat`什么区别？`stringWithFormat``stringByAppendingString`

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-02T21:14:33.830

如果可以追加到字符串的末尾，则可以追加到字符串的开头。

**附加**

```
NSString* a = @"A";
NSString* b = @"B";
NSString* result = [a stringByAppendingString:b]; // Prints "AB" 
```

**前置**

```
NSString* a = @"A";
NSString* b = @"B";
NSString* result = [b stringByAppendingString:a]; // Prints "BA" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-07-23T19:47:43.093

单线解决方案：

```
myString = [@"pretext" stringByAppendingString:myString]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-02T21:32:49.693

您也可以使用 stringWithFormat ：

```
NSString *A = @"ThisIsStringA";
NSString *B = @"ThisIsStringB";
B = [NSString stringWithFormat:@"%@%@",A,B]; 
```

stringByAppendingString 是 NSString 的实例方法，stringWithFormat 是 NSString 类的类方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-02T22:55:28.887

可能值得指出的是，没有“将一个字符串附加到另一个字符串”这样的事情。NSString 是不可变的。

在每种情况下，您都在“创建一个由一个字符串跟随另一个字符串组成的新字符串”。

将新创建的字符串放回同一个变量并不重要。

您永远不会“将文本添加到字符串的末尾”。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-01-12T11:16:46.867

在这里，我在 Swift 中有解决方案：

```
extension String {

    // Add prefix only, if there is not such prefix into a string
    mutating func addPrefixIfNeeded(_ prefixString: String?) {
        guard let stringValue = prefixString, !self.hasPrefix(stringValue) else {
            return
        }
        self = stringValue + self
    }

    // Add force full prefix, whether there is already such prefix into a string
    mutating func addPrefix(_ prefixString: String?) {
        guard let stringValue = prefixString else {
            return
        }
        self = stringValue + self
    }
} 
```

# java - 证书 java 客户端 https

> ID：14666560
> 
> 赞同：0
> 
> 时间：2013-02-02T21:10:57.647
> 
> 标签：java, ssl, https, client, keytool

我必须在 java 中创建一个与服务器建立 https 连接的客户端。我有我的证书，我用我的浏览器登录网站。如何在我的 java 客户端上使用相同的证书？我应该将它添加到密钥库吗？

谢谢

新信息：服务器和客户端都在同一个主机 - > localhost 客户端必须向 https://localhost:8183 提出请求 我创建用户的证书键入：

```
$ ./build-key fg1
$ openssl pkcs12 -export -out fg1.pfx -inkey fg1.key -in fg1.crt -certfile ca.crt -name default 
```

然后我做了

```
$ keytool -importkeystore -srckeystore fg1.pfx -srcstoretype pkcs12 -destkeystore VEPClientRestKeyStore.jks  -srcalias default -destalias fg1 -destkeypass <mypassword> 
```

现在我真的迷路了。我如何使用这个密钥库连接到服务器并发出请求？再次感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:49:26.470

我最近写了[一篇博](http://blog.chariotsolutions.com/2013/01/https-with-client-certificates-on.html)文，并附有示例，用于在 Android 上执行此操作，尽管用于建立连接的代码在桌面上是相同的。

您基本上有两个选择 - 要么使用 keytool 将证书导入 java 密钥库，如 tigran 所指向的帖子所示，要么根据需要在内存中创建密钥库，如我的博客文章随附的示例所示。

# jquery - .toggle 正在为我的锚标记设置动画，而不是将其用作点击

> ID：14666561
> 
> 赞同：0
> 
> 时间：2013-02-02T21:10:59.853
> 
> 标签：jquery, toggle

我知道 .toggle 可以执行两种不同的事情，如果您提供两个功能，它应该提供一个切换按钮单击和关闭，但我的代码正在使动画立即发生并且锚标记消失

html

```
<nav class="mainNav">
                    <ul>
                        <li class="home"><a href="#">home</a></li>
                        <li class="work"><a href="#">work</a></li>
                        <li class="blog"><a href="#">blog</a></li>
                        <li class="contact"><a href="#">contact</a></li>

                    </ul>
                    <a href="#" id="toggle">HI</a>
                </nav> 
```

js

```
$(function() {
    $(".rslides").responsiveSlides({auto:true});

    $("#toggle").toggle(function(){
        $(".mainNav ul").slideDown();
    }, function(){
        $(".mainNav ul").slideUp();
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:15:41.297

您的切换方法是切换`#toggle`，您传递给切换的函数是切换动画完成后回调的函数[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

最好使用 SlideToggle，

```
$('#toggle').click(function() {
  $('.mainNav ul').slideToggle('slow', function() {
    // Animation complete.
  });
}); 
```

# html - 错误的基线

> ID：14666562
> 
> 赞同：1
> 
> 时间：2013-02-02T21:11:02.287
> 
> 标签：html, css, twitter-bootstrap

`input file`我对HTML5 标签有一个奇怪的问题。![这是它的样子](../Images/a3bd392ae91b7a761d1d40024e56c5f3.png)

文本高于按钮。它没有任何 CSS 属性。我正在使用 Bootstrap 前端框架，也许这就是问题所在？我该如何修复它？

谢谢提前！

编辑：

这是我的表格

```
<form action="/change" enctype="multipart/form-data" method="POST">

    <span class="help-block">Username</span>
    <input id="checkuser" type="text" name="nuser" value="<%= user.user %>"/>
    <i id="usricon" style="margin-left: 8px; margin-right: 5px;" class=""></i>
    <small id="usrc" style="padding-bottom: 3px;"></small>

    <span class="help-block">Email</span>
    <input id="checkmail" type="text" name="nmail" value="<%= user.mail %>"/><i
    id="milicon" style="margin-left: 8px; margin-right: 5px;"></i>
    <small id="milc" style="padding-bottom: 3px;"></small>

    <span class="help-block">Password</span>
    <input type="password" id="opass" name="opass" placeholder="Your old password"/>
    <i id="pssicon1" style="margin-left: 8px; margin-right: 5px;" class=""></i>
    <small id="pssc1" style="padding-bottom: 3px;"></small><br>
    <input type="password" id="ps" name="npass" placeholder="Your new password"/>
    <i id="pssicon2" style="margin-left: 8px; margin-right: 5px;" class=""></i>
    <small id="pssc2" style="padding-bottom: 3px;"></small>

    <span class="help-block">Avatar</span>
    <img class="img-rounded" style="height: 80px; width 80px" 
      src="<%= user.path %><%= user.avatar %>">
    <input id="avat" type="file" name="navatar" accept="image/*">

    <span style="margin-top: 1em" class="help-block">Background</span>
    <input type="file" id="back" name="nback" accept="image/*"><br>

    <input class="button" type="submit">

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:12:44.393

通常，您无法设置输入文件标签的样式。这一切都是由浏览器完成的。有一些技术可以在其上叠加样式，但始终保留默认样式。

# android - 如何在不使用 Intent 的情况下从任何其他 Activity 打开 Home Activity

> ID：14666565
> 
> 赞同：0
> 
> 时间：2013-02-02T21:11:41.903
> 
> 标签：android, button, android-activity, back, launching

在一次采访中，有人问我这个问题。假设应用程序中有 4 个活动。他希望后退按钮在前三个活动上正常工作（即在后退按钮按下时转到上一个屏幕）；除了最后一个。

他希望，当他在第四个活动（屏幕）上按下后退按钮时，用户应该转到主活动（开始屏幕或第一个屏幕）。但是当用户从第一个屏幕转到第二个屏幕时，Home Activity 上的内容应该是相同的。所以我认为，我不能使用 Intent，因为它会创建启动 Activity 的新实例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T21:15:15.117

> 他希望，当他在最后一个活动（屏幕）上按下后退按钮时，用户应该转到主活动（开始屏幕或第一个屏幕）。

面试官应该面试他或她自己的替代者，如果他认为以这种方式破解“返回”按钮是个好主意。

> 所以我认为，我不能使用 Intent，因为它会创建启动 Activity 的新实例。

添加`FLAG_ACTIVITY_REORDER_TO_FRONT`或组合使用`FLAG_ACTIVITY_CLEAR_TOP`的with`FLAG_ACTIVITY_SINGLE_TOP`来调出您的“家庭活动”。要么将导致现有的“家庭活动”实例出现在前台。如果您希望销毁所有其他活动，请使用第二种方法（和）。`Intent``startActivity()``FLAG_ACTIVITY_CLEAR_TOP``FLAG_ACTIVITY_SINGLE_TOP`

# c++ - 如何确定 OpenCV 中的像素是黑色还是白色？

> ID：14666566
> 
> 赞同：0
> 
> 时间：2013-02-02T21:11:43.867
> 
> 标签：c++, python, opencv

我在 Python 中有这段代码：

```
width = cv.GetSize(img_otsu)[0]
height = cv.GetSize(img_otsu)[1]
#print width,":",height
for y in range(height):
    for x in range(width):
        if(img_otsu[y,x]==(255.0)):
            CountPixelW+=1
        if(img_otsu[y,x]==(0.0)):
            CountPixelB+=1 
```

我想将此 Python 代码转换为 C++

这是我到目前为止所拥有的：

```
cv::threshold(img_gray,img_otsu,0.0,255.0,cv::THRESH_BINARY+cv::THRESH_OTSU);

for(int y =0;y<=img_otsu.size().height;y++)
    for(int x=0;x<=img_otsu.size().width;x++)
    {
        //Check Pixel 0 or 255 This is Problem
    } 
```

如何在 C++ 中检查像素是黑色还是白色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T02:05:12.900

您可以将该`at()`函数用于`Mat`对象（请参阅[OpenCV 文档](http://docs.opencv.org/modules/core/doc/basic_structures.html#mat-at)）。

`img_otsu.at<uchar>(y,x)`将返回该位置矩阵中元素的值。请注意，您可能必须更改`uchar`为任何类型的矩阵`img_otsu`（例如，`float`或`double`）。获得值后，只需将其与 0 或 255 进行比较。

# sql - 寻找想法，帮助将数据库从 Postgres（在 Heroku 下）迁移到 SQL Azure

> ID：14666570
> 
> 赞同：0
> 
> 时间：2013-02-02T21:12:19.137
> 
> 标签：sql, heroku, azure-sql-database, postgresql-9.1, database-migration

从 Postgres 迁移到 MySQL 的方法是否也适用于从 Postgres（在 Heroku 下）到 SQL Azure 的数据库迁移？如果没有，有人可以帮助了解采用什么策略吗？我正在考虑以下几点：

1.  在 SQL Azure 下构建一个新的数据库架构并将 database.yml 更改为 SQL Server 适配器（不确定如何）

2.  迁移完整的架构（表和实体关系——不需要数据）。并且，将 database.yml 更改为 SQL Server 适配器（不确定如何）。

3.  如果两者都不起作用 - 找出一种在 Postgres 和 SQL Azure 之间同步数据的方法。

想法，想法非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T10:17:25.140

如果您有一个 Rails 应用程序，正在使用 ActiveRecord 并且正在使用数据库迁移，那么这相当简单。按照此（[http://blogs.msdn.com/b/silverlining/archive/2011/09/14/using-active-record-with-sql-azure.aspx](http://blogs.msdn.com/b/silverlining/archive/2011/09/14/using-active-record-with-sql-azure.aspx)）指南让您的应用程序在 SQL Azure 上运行，上传您的代码更改为 Heroku，运行`heroku run bundle exec rake db:migrate`即可完成。

如果您不使用数据库迁移，您的任务将更加困难。我建议使用 PGBackups 从 Heroku Postgres ( [https://devcenter.heroku.com/articles/heroku-postgres-import-export](https://devcenter.heroku.com/articles/heroku-postgres-import-export) ) 导出数据，并找到一种方法将此 SQL 加载到 SQL Azure。

# javascript - jQuery 两个按钮使图片从左向右移动

> ID：14666572
> 
> 赞同：0
> 
> 时间：2013-02-02T21:12:25.713
> 
> 标签：javascript, jquery, html, button

当我单击“<<”和“>>”两个按钮之一时，我想让一张图片（火柴人图片）从左向右移动。这是我的代码，

```
function personLeft() {
                $('#img').animate({left:'50px'});
            }
function personRight() {
                $('#img').animate({right:'50px'});
            } 
```

这是按钮，

```
<button id='left' onclick='personRight()'><<</button>
<button id='right' onclick='personLeft()'>>></button> 
```

出于某种原因，这不起作用。它只会让他向右移动一次，或者向左移动一次。我试过这样做：

```
$(document).ready(function(){
    $('#left').click(function(){
        $('#img').animate({left:'50px'});
    });
    $('#right').click(function(){
        $('#img').animate({left:'50px'});
    });
}); 
```

但它只是做与函数相同的事情。如果您需要确切了解我的意思，请点击此处的[链接](http://dotcomaftereverything.com/jquery/game)。

所以，我想知道的是如何做到每次点击右键，它会向右移动 50 像素，每次点击左键，它都会向左移动 50 像素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:21:29.770

您目前只是将其位置设置为 50px，您要做的是从其当前位置添加 50px：

```
$('#left').click(function(){
    $('#img').animate({
        left:'+=50px'
    });
}); 
```

检查[http://www.w3schools.com/jquery/jquery_animate.asp](http://www.w3schools.com/jquery/jquery_animate.asp) - 使用相对值了解更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:15:33.690

您可以尝试将元素向左移动。

```
$('#left').click(function(){
    $('#img').animate({left:'-50px'});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:16:29.897

向左移动，试试这个

```
$('#img').animate({left:'-50px'}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:18:03.043

而不是直接指定，`50px`您需要从前一个值中添加或减去它。

尝试做类似的事情

```
$('#left').click(function(){
    var left = parseInt($('#img').css('left'));
    $('#img').animate({left:(left - 50) + 'px'});
}); 
```

和类似的东西`#right`

# tortoisehg - TortoiseHg Workbench：修订历史视图在哪里，哦，在哪里？

> ID：14666579
> 
> 赞同：5
> 
> 时间：2013-02-02T21:13:39.667
> 
> 标签：tortoisehg

好的，这很愚蠢，但我终生无法在 TortoiseHg Workbench 中找到修订历史视图。它在那里，然后就消失了。

它列出了每个修订版，然后可以单击特定修订版，从而导致（该修订版的）所有文件的列表出现在左栏窗口中。

我觉得我已经尝试了每个按钮和菜单。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T21:27:28.517

默认工作台视图

![工作台](../Images/52d7caef6da1b4c0be0365ab403eaa86.png)

如果您隐藏了一些窗格（折叠？），您必须找到边框并将其拖放到正确的方向（抱歉，我无法在屏幕截图上显示光标）。

# css - CSS 选择器特异性冲突中的优先级（类型与类选择器）

> ID：14666581
> 
> 赞同：6
> 
> 时间：2013-02-02T21:13:51.930
> 
> 标签：css, css-selectors, css-specificity

我从本[教程](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)中了解了选择器优先级。在一种情况下，我无法理解这种行为。我在 HTML 中有一个元素：

```
<input class="top_bar_login_form_input" type="text"  name="email" placeholder="Prijavno ime"> 
```

问题是来自另一个选择器的属性会覆盖类中的属性。

![图片](../Images/5eb0830978c5092aae5c15a7e10006a9.png)

如上图所示，该类被不太具体的选择器覆盖。元素由 选择`input[type="text"]`，它不如类特定。我看到的这些行为背后的唯一原因是，`.inputbox`在确定优先级时也会计算类，即使它与元素不匹配。

为什么类型选择器会覆盖类选择器？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-02T21:21:42.273

**TL;DR 答案**

*第一条规则比第二条更具体，*因为它同时具有选择器的类型和属性部分，因此具有优先级：

```
input[type="text"] { }         /* type + attribute for specificity */
.top_bar_login_form_input { }  /* only class for specificity, so *less* specificity */ 
```

* * *

**更长的答案**

*[根据MDN page on specificity](https://developer.mozilla.org/en-US/docs/CSS/Specificity)，*您会认为*`type="text"`属性选择器位比类选择器更具体：*

 *> 以下选择器列表是通过增加特异性：
> 
> *   通用选择器
> *   类型选择器
> *   类选择器
> *   属性选择器
> *   伪类
> *   ID 选择器
> *   内联样式

在撰写此答案时，上面的引用在 MDN 文章中。

**为什么这是误导：**

（感谢@BoltClock 的[见解](https://stackoverflow.com/questions/14666581/precedence-in-css-conflicts/14666661#comment20504875_14666661)。）

以上*似乎是*正确的，但那是因为您通常`input[type="text"]`在执行属性选择器时将元素包含在选择器中（例如 ）。然而，偷偷摸摸的是：`input`位很重要。

假设我们有以下标记：

```
<input class="my-class" type="text" value="some value" /> 
```

在[以下场景](http://jsfiddle.net/WxxGm/)中，输入呈现**红色**：

```
[type="text"] { color: green; }
.my-class { color: red; }             /* last rule matched */ 
```

如果我们在[场景](http://jsfiddle.net/ygYdv/)中反转规则，输入将呈现**绿色**：

```
.my-class { color: red; }
[type="text"] { color: green; }       /* last rule matched */ 
```

这是因为两个选择器具有相同的特异性。现在将`input`选择器引入属性规则将使其中一个更具体，可以在[这个场景](http://jsfiddle.net/5a6V3/)中看到：

```
input[type="text"] { color: green; }  /* most _specific_ rule matched */
.my-class { color: red; } 
```

[W3 规范](http://www.w3.org/TR/CSS21/cascade.html#specificity)让我头疼，但它确实详细说明了上述工作的原因。另请参阅[@BoltClock 的答案](https://stackoverflow.com/a/14669845/419956)和这些代码示例中的注释，以获取有关如何计算特异性的信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-03T05:45:27.580

您的元素`input[type="text"]`在第一条规则中匹配。尽管`.inputbox`选择器不匹配它，但这不会影响优先级，因为逗号分隔的选择器列表仅按列表*中*匹配元素的最特定选择器计数。如果没有一个选择器匹配它，那么它根本不算数。

第一个规则覆盖第二个规则的原因是因为类选择器和属性选择器具有相同的[特异性](http://www.w3.org/TR/selectors/#specificity)。`input`伴随（或伴随）属性选择器的类型选择器是导致它超过单独的类选择器的原因：

```
/* 1 attribute, 1 type -> specificity = 0-1-1 */
input[type="text"]

/* 1 class             -> specificity = 0-1-0 */
.top_bar_login_form_input 
```

所以第一个选择器比第二个更具体，而不是相反。

如果你用一个类型来限定类选择器，那么你有`input.top_bar_login_form_input`，选择器将是平衡的，你的第二个规则将覆盖第一个。*

# c - 为什么 Erlang 没有 C NIF 替代 calloc？

> ID：14666582
> 
> 赞同：3
> 
> 时间：2013-02-02T21:13:52.863
> 
> 标签：c, erlang, erlang-nif

为什么 Erlang 有一个 C NIF 替代`malloc`, `enif_alloc`，而不是`calloc`？从而强制使用`memset()`after`enif_alloc`进行数组访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:23:23.720

好吧，我认为这与事实有关（来自文档）：

**“在 R13B03 中作为实验性功能引入的 NIF。”**

附带说明一下，Erlang 审查委员会也相当保守，可能是由于其诞生于电信公司的历史，这对于容错语言是可以理解的。

我想我没有看到您遇到的问题，因为总是欢迎您使用 calloc() 编写适当的端口并使用旧的编组方法。 [http://www.erlang.org/doc/tutorial/erl_interface.html](http://www.erlang.org/doc/tutorial/erl_interface.html)

快乐的 C 编码！

# javafx-2 - JavaFX 2 -fx-effect 打破不透明度

> ID：14666583
> 
> 赞同：1
> 
> 时间：2013-02-02T21:13:56.903
> 
> 标签：javafx-2

有没有其他人发现在样式中添加 -fx-effect 会阻止不透明度工作？

这是一个简单的例子

```
public class TestGUI extends Application {

@Override
public void start(final Stage primaryStage) {

    Line line = LineBuilder.create()
            .startX(150)
            .startY(0)
            .endX(150)
            .endY(250)
            .build();

    Button btn = ButtonBuilder.create()
            .text("Open countdown!")
            // this breaks the opacity!
            .style("-fx-effect: dropshadow(three-pass-box, grey, 5, 0.5, 2, 5);")
            .opacity(0.6)
            .build();

    btn.setOnAction(new EventHandler<ActionEvent>() {
        @Override
        public void handle(ActionEvent event) {
            System.out.println("Button clicked");
        }
    });

    StackPane root = new StackPane();
    root.getChildren().addAll(line, btn);

    Scene scene = new Scene(root, 300, 250);

    primaryStage.setTitle("Test Application");
    primaryStage.setScene(scene);
    primaryStage.show();
}

public static void main(String[] args) {
    launch(args);
} 
```

}

取出`style`子句，通过按钮可以看到行。

这是一个错误还是我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:41:59.220

阴影实际上是半透明节点和半透明本身的阴影，但是因为您在半透明阴影之上叠加了一个半透明节点，所以整体结果仍然是半透明的，但比没有应用阴影的节点更不透明。类似于将两个 50% 不透明节点分层。两个分层节点的相交区域将为 75% 不透明。

在您的示例中，您将不透明度设置为 0.6，因此节点 + 阴影的组合不透明度为 0.6 + 0.4 * 0.6 = 0.84。加上阴影的颜色比受影响的节点开始时要暗。这使得很难看到受影响节点后面的线 - 但您仍然可以看到它，因为节点 + 它的效果不是完全不透明的。为了更清楚地显示发生了什么，我将样本的不透明度设置为 0.2，使组合不透明度为 0.36。您可以在下面的屏幕截图中看到结果，受影响节点后面的线仍然清晰可见。

![半透明效果](../Images/b4ca2925e2aed5cdcef532ab47754e94.png)

通常，阴影和不透明节点在视觉上不会混合在一起，看起来都很好

# ruby-on-rails - 使用收藏时遵循得墨忒耳法则？

> ID：14666591
> 
> 赞同：1
> 
> 时间：2013-02-02T21:14:59.120
> 
> 标签：ruby-on-rails, design-patterns, language-agnostic, law-of-demeter

在 Ruby on Rails（或任何其他具有集合的语言......）中，当查询像计数这样简单的东西时，是否有必要打破[Demeter 违反法则？](http://en.wikipedia.org/wiki/Law_of_Demeter)

```
class Survey
  has_one :kingdom

  def first_survey?
    # Should this be broken according to Law of Demeter?
    self.kingdom.surveys.count == 1
    # -or-
    self.kingdom.surveys_count == 1
  end
end

class Kingdom
  has_many :surveys

  # Is this the "right thing to do", or overkill?
  def surveys_count
    self.surveys.count
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T23:03:31.827

通常当我看到违反德墨忒耳法则时，我问的第一个问题不是“我如何‘避免点’？” 您应该问的问题是“这个违反的功能是否属于其他人？” 在这种情况下，我可能会像这样构造它：

```
class Survey
  belongs_to :kingdom
end

class Kingdom
  has_many :surveys

  def first_survey?(survey)
    surveys.first == survey
  end
end

kingdom = Kingdom.find(kingdom_id)
first_survey = kingdom.surveys.first
last_survey = kingdom.surveys.last # Assuming there is more than one survey.

kingdom.first_survey?(first_survey) #=> true
kingdom.first_survey?(last_survey)  #=> false 
```

通过以这种方式构造它，`Survey`不再需要进入`Kingdom`对象并查询其关联，避免违反得墨忒耳法则。`first_survey?`这也允许您稍后更改定义。一个人为的例子是如果`Surveys`可以“发布”。然后可以很容易地将 for a 更改为仅支持检查传入的是否`first_survey?`是第一个属性设置为 的。`Kingdom``Survey``Survey``published``true`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:23:40.630

[来自维基百科的定义](http://en.wikipedia.org/wiki/Law_of_Demeter#In_object-oriented_programming)

> 更正式地说，函数的得墨忒耳定律要求对象 O 的方法 m 只能调用以下类型对象的方法

```
1\. O itself  
2\. m's parameters  
3\. Any objects created/instantiated within m  
4\. O's direct component objects  
5\. A global variable, accessible by O, in the scope of m 
```

> 特别是，一个对象应该避免调用另一个方法返回的成员对象的方法。对于许多使用点作为字段标识符的现代面向对象语言，该法则可以简单地表述为“仅使用一个点”。也就是说，代码 abMethod() 违反了 a.Method() 没有的规律。举个简单的例子，想要狗走路时，不会直接命令狗的腿走路；取而代之的是命令狗，然后狗命令自己的腿。

在上述情况下，是的，这将违反得墨忒耳定律：

```
 def first_survey?
    # Should this be broken according to Law of Demeter?
    self.kingdom.surveys.count == 1 
```

至于它是否矫枉过正，我说不，但我不喜欢糟糕的代码（即不正确的代码，允许的错误多于应有的错误，我对此有很多争论）。

你想要做的是这样的：

```
def first_survey?
    self.kingdom.surveys_count == 1 
```

如果我的理解是正确的，这并不违反 Demeter，因为您没有`suverys.count`直接访问该属性。相反，您要求`kingdom`返回它拥有的内部属性（我认为这更正确，因为它正在使用对象的 API `kingdom`）

```
# Is this the "right thing to do", or overkill?
  def surveys_count
    self.surveys.count
  end 
```

这是“正确的做法”，否则外部系统将如何访问该属性？

**从评论中**

> 只使用一个点实际上是一个非常糟糕的规则，因为 "string".strip.downcase.tr_s('^[a-z0-9]', '-') 不违反 demeter

好吧，既然你提出来了，我会反驳你的说法。这实际上不是一个坏规则，因为您在这里忽略了一条非常关键的信息，strip 函数返回一个新的字符串对象以及 tr_s 的小写。如果您要生成三个额外的对象，我会非常担心任何看到这一点的开发人员。它确实违反了规则，因为您正在直接访问成员。你想要考虑的，我绝不是 Ruby 专家，是这样的：

```
class MyString  
{  
     string internal_string;
         def strip()  
         {  
              self.internal_string = self.internal_string.strip
         }  

       def downcase()
       {
         self.internal_string = self.internal_string.downcase
       }  

       def tr_s()
       {  
           self.internal_string = self.internal_string.tr_s
       }  
} 
```

上面所做的是允许开发人员通过在库函数周围放置一个瘦包装器来调用您的 API。有些人可能会称之为矫枉过正，但它对可以做什么和应该做什么给出了非常明确的界限。现在让这个得墨忒耳得到批准（如果我正确理解法律的话）

```
myString.strip().downcase().tr_s() 
```

现在可能不清楚的是，这并不违反 Demeter，因为我正在调用公开的 API `myString`，过度杀伤（也许），最正确（几乎肯定）。

# jquery - 选项卡中的 Jquery cookie：保留或更改先前活动选项卡上的类？

> ID：14666595
> 
> 赞同：1
> 
> 时间：2013-02-02T21:15:21.367
> 
> 标签：jquery, cookies, addclass, removeclass

当我单击一个选项卡时，“defaulttab”类附加到活动选项卡。但是，当我刷新页面时，我上次打开的选项卡会丢失该类，并且该类默认为原始选项卡。如何刷新页面，并将课程附加到之前处于活动状态的选项卡？

```
jQuery(document).ready(function() {

    jQuery('.tabs a').click(function(){
         switch_tabs(jQuery(this));
    });
    switch_tabs(jQuery('.defaulttab'));
});

function switch_tabs(obj)
{
    jQuery('.tab-content').hide();
    jQuery('.tabs a').removeClass("active");
    var id = obj.attr("rel");
    jQuery('#'+id).show();
    obj.addClass("active"); 
} 
```

# php - magic-quotes 是 ON && 使用 stripslashes 和 mysql-real-escape-string TOGETHER

> ID：14666602
> 
> 赞同：0
> 
> 时间：2013-02-02T21:15:31.897
> 
> 标签：php, mysql, mysql-real-escape-string, stripslashes, magic-quotes-gpc

> **可能重复：**
> [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

我在免费的 php 服务器上，我无权访问 php.ini 文件，并且 magic_quotes 已打开。因此，当我通过表单页面将记录添加到 mysql 时，我的 php 代码是

 `````
$_POST["text"]=trim(stripslashes(mysql_real_escape_string($_POST["text"]))); 
```` 

`我的问题：` 

 `1.  我想消除magic_quote效果，因为它会贬值和删除**，**并以最佳方式将潜在的恶意用户输入放入mysql。那么我上面的代码是正确的还是我需要更改、改进？

    谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:42:36.550

只需 stripslashes() 就足以摆脱魔术引号。

```
$text = stripslashes($_POST["text"]); 
```

查看在运行时删除魔术引号的更完整示例：http: [//php.net/manual/en/security.magicquotes.disabling.php](http://php.net/manual/en/security.magicquotes.disabling.php)

你真的应该得到一个不同的 PHP 服务器。自 PHP 5.3.0（2009 年 6 月）起，魔术引号已被弃用。您的 PHP 托管站点已近四年没有更新 PHP，而且您面临许多其他错误甚至安全漏洞的风险。是时候转移到另一个主机了。

* * *

回复您的评论：

是的，stripslashes 只是将请求参数转换为纯文本。

至于是否应该使用mysql_real_escape_string()的问题...

首先，只有在将值插入 SQL 查询*时才应该这样做。*您不一定要对每个 POST 值都这样做，因此将转义应用于所有内容是愚蠢的。

以此类推，这就像在你知道你会吃多少以及你会吃多少剩菜*之前*将你的晚餐放入冰箱储存容器中一样。:-)

其次，您根本不应该再使用 mysql_* 函数。[自 PHP 5.5.0 起不推荐使用](http://www.php.net/mysql_query)它们，并且将在 PHP 的未来版本中删除它们。您现在应该开始使用 mysqli_* 或 PDO 函数。

第三，您根本不应该对 SQL 查询中的动态值使用转义。相反，使用带参数的准备好的查询。与使用 mysql_real_escape_string() 相比，参数化查询**更安全、更易于编码且运行速度更快。**

* * *

回复您的下一条评论：

不，我认为你还没有得到它。

如果您想将 $_POST["text"] 插入 SQL 查询，并且魔术引号为 ON，您可以执行以下操作：

```
// remove the magic quotes simply with stripslashes():
$text = stripslashes($_POST["text"]);

// prepare an SQL statement, using a ? placeholder instead of interpolated value
$stmt = $mysqli->prepare("INSERT INTO mytable (mytext) VALUES (?)");

// always check for an error on prepare, you might have made a syntax error, 
// or the table might not exist, etc.
if ($stmt === false) {
  die($mysqli->error);
} 

// bind one PHP variables for each parameter placeholder in the query
$stmt->bind_param("s", $text);

// then execute!  MySQL will use the values of the PHP variables you bound
// in place of the placeholders
$status = $stmt->execute();

// always check for an error on execute too, because the value of the parameter 
// might cause the query to fail, e.g. conflicting with another value in a 
// unique column, etc.
if ($status === false) {
  die($stmt->error);
} 
```

如果使用查询参数，则无需使用 mysqli_real_escape_string()。

* * *

如果您需要更多帮助，这里有一个关于 mysqli 的教程，其中包含显示绑定参数的示例：

*   [http://devzone.zend.com/239/ext-mysqli-part-i_overview-and-prepared-statements/](http://devzone.zend.com/239/ext-mysqli-part-i_overview-and-prepared-statements/)``

# python - 无法在 VPS 上获得基本的 Django 设置

> ID：14666605
> 
> 赞同：2
> 
> 时间：2013-02-02T21:16:07.303
> 
> 标签：python, django, centos, vps

我正在尝试在 VPS（CentOS）上部署一个 Django 网站，但我从一开始就遇到了问题。这是我所做的：

```
ssh root@myserver.com
cd /home/mydomain/public_html
pip install django
django-admin.py startproject mysite
cd mysite
python manage.py runserver 0.0.0.0:8000 
```

当我访问时，`mydomain.com:8000`我希望看到最初的 Django 页面“它成功了！”。但是浏览器只是挂起并且连接超时。

我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:13:05.123

如果您无法访问该站点，请尝试以下操作：

```
$ wget http://127.0.0.1:8000 
```

如果您在本地获得响应但不是通过网络获得响应，则可能是防火墙或 iptables 问题。CentOS 相当锁定，因此请检查 ip 表。

[http://wiki.centos.org/HowTos/Network/IPTables#head-cdc2ff6985016368c04d0b37a5914eef2e8d5796](http://wiki.centos.org/HowTos/Network/IPTables#head-cdc2ff6985016368c04d0b37a5914eef2e8d5796)

# javascript - 如何在没有 jQuery 的情况下编写 javascript 插件

> ID：14666608
> 
> 赞同：10
> 
> 时间：2013-02-02T21:16:30.757
> 
> 标签：javascript, prototype

使用 jQuery 编写插件相对容易，只需使用 $.fn 即可。像这样：

```
$.fn.analyse = function() {
...
} 
```

但是如果你不能使用 jQuery 怎么办？

假设我希望能够使用以下代码：

```
document.querySelector("#mydiv").analyse(); 
```

我可以这样做：

```
Object.prototype.analyse = function() {
...
} 
```

但据我了解，这是不赞成的！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-02T21:23:37.963

这里有一些东西可以帮助你开始：

```
var proto_methods = {
    analyse: function() {
        var node = this.node;

        // ...
    }
}, wrap, _wrap;

_wrap = function(selector) { this.node = document.querySelector(selector); };
_wrap.prototype = proto_methods;

wrap = function(selector) {
    return new _wrap(selector);
}; 
```

像这样使用它：

```
wrap("#mydiv").analyse(); 
```

如果您想添加更多插件（并且它更面向对象），请使用它：

```
var pack = {
    binder: [{}]
};

pack.query_bind = function( bound ) {
    if (bound) pack.binder[1] = bound;
};

pack.fn = function( attributes ) {
    for (var i in attributes) pack.binder[0][i] = attributes[i];
};

var _wrap = function(selector) {
    this.node = /^(#|.)\w+/.test(selector) ? pack.binder[1](selector) : {};
};

_wrap.prototype = pack.binder[0];

var wrap = function(selector) {
    pack.query_bind(document.querySelector.bind(document));
    return new _wrap(selector);
};

wrap.fn = pack.fn;

wrap.fn({
    cool: function() {},
    nice: function() {}
});

wrap('#mydiv').cool(); 
```

您可以随时调用`wrap.fn`，原型将被更新。

但是，请注意，这并不是 jQuery 的真正替代品，因为有很多东西我没有包含在这段代码中。该功能在许多方面`wrap`不如 jQuery 先进和有用。`$`

我希望这有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-13T10:48:32.937

刚刚写了样板。它没有自己的选择器逻辑，因为它是为 D3.js 之上的库设计的，它已经拥有自己的选择器引擎。 [https://gist.github.com/turboMaCk/34bde8e744f5921be0c4](https://gist.github.com/turboMaCk/34bde8e744f5921be0c4)

# php - PHP 在浏览器中显示电子邮件

> ID：14666610
> 
> 赞同：1
> 
> 时间：2013-02-02T21:16:39.943
> 
> 标签：php, email, html-email

我已将原始格式的电子邮件（包括标题和多部分信息）存储在数据库中。我想显示消息的文本/html。如何解析消息并仅显示 html 文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:35:49.030

我没试过...

```
$emailArray = file($someFileName);
$count = count ($emailArray);
$divider = false;
$emailText = '';

for ($i = 0; $i < $count; $i++){
    if (strpos($emailArray[$i], 'Content-Type: text/html') !== false){
        $divider = $emailArray[$i - 1];
    }elseif ($divider && strpos($emailArray[$i], $divider . '--') === false){
        $emailText .= $emailArray[$i];
    }elseif(strpos($emailArray[$i], $divider) !== false){
        break;
    }
}
echo $emailText; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:20:54.527

如果您想以文本格式显示电子邮件中未更改的文本，您可以使用`<PRE></PRE>`标签

# java - 如何在java中将数组元素上移一位？

> ID：14666611
> 
> 赞同：0
> 
> 时间：2013-02-02T21:16:57.943
> 
> 标签：java, arrays

我正在处理一个 java 分配，我需要删除数组中的一个整数元素并将下面的元素向上移动以保持它们的顺序。该数组目前是降序的随机整数。我不允许使用 array.copy，因为我需要收集数组使用信息作为分配的一部分。我已经尝试了很多不同的方法来做到这一点，但似乎无法让它发挥作用。

```
public static void deletionArray(int anArray[], int positionToDelete) {
    for (int j = anArray[positionToDelete] - 1; j < anArray.length; j++) {
        System.out.println("j is " + j);
        anArray[j] = anArray[j + 1];
    }

    displayArray(anArray);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:21:42.120

您正在迭代直到`anArray.length`（独占），但在循环内部，您正在访问`anArray[j + 1]`，因此这将等于`anArray[anArray.length]`最后一次迭代，这将导致 ArrayIndexOutOfBoundsException。

迭代直到`anArray.length - 1`（不包含），并决定应该在数组的最后一个元素中存储什么而不是之前的值。

您也是从 开始`anArray[positionToDelete] - 1`，而不是从 开始`positionToDelete`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:20:55.870

你有两个错误。

由于这是一项作业，我不会给出完整的答案 - 只是一个提示。你的循环定义是错误的。想一想：循环的第一次和最后一次迭代会发生什么？想象一个 5 元素数组（编号为 0 到 4，根据 Java 规则），并在擦除元素编号（例如 2）时计算出循环迭代中的变量值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:22:02.010

使用`System.arraycopy`比循环更快：

```
public static void deletionArray( int anArray[], int positionToDelete) {
    System.arraycopy(anArray, positionToDelete + 1, anArray,
            positionToDelete, anArray.length - positionToDelete - 1);
    //anArray[length-1]=0;        //you may clear the last element 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:23:54.347

```
public static int[] deletionArray(int anArray[], int positionToDelete) {
    if (anArray.length == 0) {
        throw new IlligalArgumentException("Error");
    }
    int[] ret = new int[anArray.length - 1];
    int j = 0;
    for (int i = 0; i < anArray.length; ++i) {
        if (i != positionToDelete) {
            ret[j] = anArray[i];
            ++j;
        }
    }
    return ret;
} 
```

**为什么我们要保留一个新数组？**

因为如果不这样做，我们将使用 C\C++ 样式的数组：一个数组和它的“使用长度”。

```
public static int deletionArray(int anArray[], int positionToDelete, int n) {
   if (n == 0) {
       throw new IlligalArgumentException("Error");
   }
   for (int i = positionToDelete; i < n - 1; ++i) {
       anArray[i] = anArray[i + 1];
   }
   return n - 1; // the new length
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T21:25:35.167

这个怎么样 ？请注意评论，我认为您不能删除数组中的元素，只需将其替换为其他内容，这可能很有用：[Removing an element from an Array (Java)](https://stackoverflow.com/questions/642897/removing-an-element-from-an-array-java)

更新了“JB Nizet”评论：

```
public class Driver {

    public static void main (String args []){

        int intArray[] = { 1,3,5,6,7,8};
        int updatedArray[] = deletionArray(intArray , 3);

         for (int j = 0; j < updatedArray.length; j++) {    
             System.out.println(updatedArray[j]);
         }

    }

    public static int[] deletionArray(int anArray[], int positionToDelete) {
        boolean isTrue = false;

           for (int j = positionToDelete; j < anArray.length - 1; j++) {            
                if(j == positionToDelete || isTrue){
                    isTrue = true;
                    anArray[j] = anArray[j + 1];
                }

            }

        anArray[anArray.length-1] = 0; //decide what value this should be or create a new array with just the array elements of length -> anArray.length-2
        return anArray;
    }
} 
```

# vb6 - 错误“内存不足”vb6

> ID：14666612
> 
> 赞同：2
> 
> 时间：2013-02-02T21:17:05.053
> 
> 标签：vb6

我有一个在 IDE 中运行良好的应用程序，但不会以 exe 形式运行。我有日志记录，所以应用程序在登录表单中生成内存不足错误

```
 Login.Show vbModal
  Unload Login 
```

在登录加载子例程中，这是我在那里的代码。

```
m_lsLoginState = Failed
Me.Height = 1815 
```

有谁知道可能导致错误的原因。m_isLoginState 是一个枚举变量

```
Public Enum LoginStates
    Failed
    Succeed
    Quit
End Enum 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T14:55:04.197

我终于找到了问题的原因和解决方案

碰巧正在使用添加到项目资源中的清单文件，这样当应用程序编译时，它将在 Windows 主题中显示控件。

然后我注意到主窗体 frmMain 有这个初始化，而登录窗体首先显示。

```
m_Shell32 = LoadLibrary("Shell32.dll")
Call InitCommonControls 
```

令我困惑的是，编译后的可执行文件已经像这样工作了一段时间，没有任何问题。

`system error &H80070583 (-2147023485)`经过多次调整，当启动应用程序可执行文件时，我又遇到了另一个错误。此错误表明这是一个明显的问题，导致我找到解决方案

我通过将上面的代码移动到登录表单的初始化来解决问题

谢谢你的帮助

# asp.net-mvc-4 - 在控制器上编辑 IEnumerable null

> ID：14666617
> 
> 赞同：0
> 
> 时间：2013-02-02T21:17:53.703
> 
> 标签：asp.net-mvc-4

我不能`List<album>`在这个上使用一个，只能在没有编辑标签的视图上使用，我有一个视图工作得很好，但我不能编辑它们的一个列表。

```
@model IEnumerable<MyMixtapezServerCodeHomePage.Models.album>
@using (Html.BeginForm("FeatureSystem", "album", FormMethod.Post))
{

<table>

    <tr>
        <th>
            @Html.DisplayNameFor(model => model.name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.feature)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.feature_order)
        </th>
        <th></th>
    </tr>

    @foreach (var item in @Model)
    {

        <tr>
            <td>

                <div class="editor-label">
                    @Html.LabelFor(model => item.name)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => item.name,"album")
                    @Html.ValidationMessageFor(model => item.name)
                </div>
            </td>
            <td>
                <div class="editor-label">
                    @Html.LabelFor(model => item.feature,"album")
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => item.feature)
                    @Html.ValidationMessageFor(model => item.feature)
                </div>
            </td>
            <td>
                <div class="editor-label">
                    @Html.LabelFor(model => item.feature_order)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => item.feature_order,"album")
                    @Html.ValidationMessageFor(model => item.feature_order)
                </div>
            </td>
            <td></td>
        </tr>

    }
    <input type="submit" />
</table>} 
```

控制器

```
 [HttpPost]
    public ActionResult FeatureSystem(IEnumerable<album> albums)
    {
        foreach (album album in albums)
        {
            if (ModelState.IsValid)
            {
                albumRepository.Update(album);
                albumRepository.SaveChanges();
            }
        }

        return RedirectToAction("Index");
    } 
```

我收到的专辑是空的，为什么？我可以编辑一个列表吗？我只需要这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-06T10:03:43.423

在视图中使用 IList 而不是 IEnumerable，并将 foreach 循环替换为 for 循环。

**步骤1：**

利用

```
@model IList <MyMixtapezServerCodeHomePage.Models.album> 
```

代替

```
@model IEnumerable<MyMixtapezServerCodeHomePage.Models.album> 
```

**第2步：**

利用

```
@for (var i = 0; i < Model.Count; i++) 
```

代替

```
@foreach (var item in @Model) 
```

请参阅[如何将 IEnumerable 列表传递给 MVC 中的控制器，包括复选框状态？](https://stackoverflow.com/a/17037925/273646)更多细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:22:06.680

我相信这自 mvc3 以来没有改变

因此，要拥有一个可编辑的集合，您必须使用 for 循环，而不是 foreach，否则绑定将不起作用。

```
@for(var i = 0; i < Model.Count; i++)
 {
    <tr>
        <td>

            <div class="editor-label">
                @Html.LabelFor(model => Model[i].name)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => Model[i].name,"album")
                @Html.ValidationMessageFor(model => Model[i].name)
            </div>
        </td>
        <td>

  ...
} 
```

看看[这个](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)，旧的，但我认为不会过时。

# typescript - 具有不同文件中的类的 TypeScript 模块

> ID：14666618
> 
> 赞同：1
> 
> 时间：2013-02-02T21:18:02.250
> 
> 标签：typescript

我正在尝试将模块拆分为多个文件。我关注了这个[问题](https://stackoverflow.com/questions/14436175/typescript-splitting-module-into-multiple-files)，但没有运气，我似乎无法访问同一模块中但不同文件中的类。

我正在为 Visual Studio 2012 使用 TypeScript 0.8.2 插件

```
/* filesystem */
- /core
- - Router.ts
- - Server.ts
- /DefinitelyTyped
- - ..
- index.ts

/* file Router.ts */
///<reference path='../DefinitelyTyped/node/node.d.ts'/>
import Url = module("url");

module Core {
    export class Router {
        static route(url: string) {
            var pathname: string = Url.parse(url).pathname;
            var query: string = Url.parse(url).query;
            console.log("About to route to " + pathname);
        }
    }
}

/* file Server.ts */
///<reference path='../DefinitelyTyped/node/node.d.ts'/>
///<reference path="Router.ts"/>

import Http = module("http");

module Core {
    export class Server {

        private server: Http.Server;
        private port: number;

        constructor(port: number) {
            this.port = port;
            this.server = Http.createServer(this.onRequest);
            this.server.listen(this.port);
            console.log("Server started at http://127.0.0.1:" + this.port + "/.");
        }

        private onRequest(request: Http.ServerRequest, response: Http.ServerResponse) {
            var url: string = request.url;

            console.log("Received request: \"" + request.url + "\".");

            Router.route(url); //problem: Name 'Router' doesn't exist in this scope...

            response.writeHead(200, { "Content-Type": "text/plain" });
            response.write(url);
            response.end();
        }

        public getPort(): number {
            return this.port;
        }
    }
} 
```

那么，我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T01:25:47.163

作为一般规则，永远不要将`import`/`export`与`/// <reference>`包含声明以外的任何内容的文件混合和匹配（即`.d.ts`，如果您在代码中的任何位置使用`import`/ ，则仅引用文件`export`）。你想要的是这个（见`NB`添加/删除）：

```
/* file Router.ts */
///<reference path='../DefinitelyTyped/node/node.d.ts'/>
import Url = module("url");

// NB Removed containing module for clarity
export class Router {
    static route(url: string) {
        var pathname: string = Url.parse(url).pathname;
        var query: string = Url.parse(url).query;
        console.log("About to route to " + pathname);
    }
}

/* file Server.ts */
///<reference path='../DefinitelyTyped/node/node.d.ts'/>
// NB Removed reference

import Http = module("http");
import Router = module("./Router"); // NB Added

module Core {
    export class Server {

        private server: Http.Server;
        private port: number;

        constructor(port: number) {
            this.port = port;
            this.server = Http.createServer(this.onRequest);
            this.server.listen(this.port);
            console.log("Server started at http://127.0.0.1:" + this.port + "/.");
        }

        private onRequest(request: Http.ServerRequest, response: Http.ServerResponse) {
            var url: string = request.url;

            console.log("Received request: \"" + request.url + "\".");

             // NB first 'Router' is the import name at the top of this file, feel free to change
             // NB second'Router' is the name of the class from that module
            Router.Router.route(url);

            response.writeHead(200, { "Content-Type": "text/plain" });
            response.write(url);
            response.end();
        }

        public getPort(): number {
            return this.port;
        }
    }
} 
```

# postgresql - 如何在 SQLAlchemy 中表达 JOIN 和 GROUP BY 查询？

> ID：14666622
> 
> 赞同：2
> 
> 时间：2013-02-02T21:18:19.993
> 
> 标签：postgresql, sqlalchemy

```
SELECT sector.sector, count(*) 
FROM reports, organization, sector 
WHERE reports.org_id = organization.id
    AND organization.id = sector.org_id
GROUP BY sector.sector; 
```

老实说，我什至不确定从哪里开始在 sqlalchemy 中表达这个 GROUP BY 和 JOIN。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T21:43:05.920

```
db.query(func.count(Sector.sector), Sector.sector).\
    join(Organzation).join(Report).\
    group_by(Sector.sector).all() 
```

我能够将其表示为以下表达式。我之前的努力失败了，因为我需要`db.rollback()`我尴尬的失败尝试。

# python - 可以不定义类默认值吗？

> ID：14666624
> 
> 赞同：0
> 
> 时间：2013-02-02T21:18:43.093
> 
> 标签：python

保留上下文的细节以及我为什么关心......

可以这样做吗：

```
class IsThisOk(object):
    def __init__( self, **kwargs ):
        for k in kwargs:
            setattr( self, k, kwargs[k] )
obj = IsThisOk( apples=2 , oranges=2 ) 
```

因为我一直把它当作：

```
class OptionB(object):
    apples = None
    oranges = None
    """class defaults"""
    def __init__( self, **kwargs ):
        for k in kwargs:
            setattr(self,k,kwargs[k])
b = OptionB( apples=2 , oranges=2 ) 
```

=====

编辑 ：

我最初在上面有这个，这是我不应该有的......

```
class OptionA(object):
    """set self.k but with class defaults"""
    apples = None
    oranges = None
    def __init__( self, **kwargs ):
        for k in kwargs:
            self.k = kwargs[k]
a = OptionA( apples=2 , oranges=2 ) 
```

这一切都来自我试图优化一些代码。

我还注意到：

```
 for k in kwargs:
        setattr( self, k, kwargs[k] ) 
```

比

```
 for k,v in kwargs.iteritems():
        setattr( self, k, v ) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T21:42:26.240

正如 delnan 评论的那样，既不`IsThisOk`也`OptionA`不会像您所展示的那样工作。那是因为`self.k = kwargs[k]`等效于`setattr(self, "k", kwargs[k])`而不是您在 中使用的所需调用`OptionB`。

另一种解决方案可能是使用标准库`namedtuple`中模块的类工厂：`collections`

```
>>> from collections import namedtuple
>>> OptionC = namedtuple("OptionC", ["apples", "oranges"])
>>> c = OptionC(2, 2) # you can also use keyword arguments, if you wish
>>> print(c)
OptionC(apples=2, oranges=2) 
```

此选项的限制是 OptionC 实例将是不可变的，就像它的 parent class 一样`tuple`。`c.apples = 5`也就是说，创建实例后您将无法执行此操作。

但是，要回答标题中的问题，不，没有必要在类定义中定义默认变量。事实上，我认为这是气馁。如果您希望类构造函数有可选参数，请在`__init__`方法定义中为它们提供默认值：

```
class OptionD:
    def __init__(apples=None, oranges=None):
        self.apples = apples
        self.oranges = oranges 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-02T21:31:51.670

*编辑*正如评论中所述，这几乎是一个不该做的例子。

```
...
for k in kwargs:
  exec('self.{}={}'.format(k,kwargs[k]))
... 
```

# emacs - 结合组织模式捕获和钻取模块来学习词汇

> ID：14666625
> 
> 赞同：5
> 
> 时间：2013-02-02T21:18:45.303
> 
> 标签：emacs, elisp, org-mode, org-drill

我想用`capture`of模块`org-mode`创建一个我想学的生词的数据库，然后用`drill`模块来学习它们（闪存卡样式）。

在我的`org-capture-templates`我添加了以下内容：

```
("v" "Vocabulary" entry
               (file+headline (concat org-directory "/vocab.org")
                              "Vocabulary")
               "* Word :drill:\n%^ \n** Answer \n%^") 
```

这是我[从这里](http://lists.gnu.org/archive/html/emacs-orgmode/2010-09/msg00924.html)借来的一个相当幼稚的模板。它工作得很好，但它太有限了。不幸的是，我很陌生`elisp`，我不知道如何改进它。

我认为上述模板必须在以下几个方面进行改进：

**标题**当前第一个输入字符串是（新）单词并且标题是固定的。标题怎么可能是同一个（输入）词？我认为以下结果是可取的：

```
* Vocabulary
** Foo :drill:
Foo
*** Answer
What is foo 
```

实际上，更好的方法是使用 3 个输入字符串。

1.  `foo`将成为标题的新词（例如）。
2.  如果第二个为空，则它得到与 (1) 相同的字符串。否则，将字符串连接到 (1) 中的字符串。例如，作为第二个输入`bar`将产生`foo bar`. 这将是条目的内容。
3.  这个词的定义应该出现在`answer`副标题中。

**重复**（再看一次[）](http://lists.gnu.org/archive/html/emacs-orgmode/2010-09/msg00924.html)如果稍后我尝试`foo`再次捕获，我想知道它，并被指示编辑已经存在的条目 - 跳过所有输入。

**排序**捕获后，我认为对单词列表进行排序会很好。考虑到每个条目的标题就是单词本身，这应该不会太难。在这种情况下，可能可以使用该`org-sort-entries`功能。

我知道这是一个相当大的问题，但我也认为如果可以在这里解决它，它将对许多用户有很大的用处。

* * *

# 编辑：

* * *

使用@juan_g 的建议，我改进了我的模板，现在它是：

```
("v" "Vocabulary" entry
               (file+headline (concat org-directory "/vocab.org")
                              "Vocabulary")
               "* %^{The word} :drill:\n %t\n %^{Extended word (may be empty)} \n** Answer \n%^{The definition}") 
```

我没有设法将第二个输入的默认值设置为第一个。我尝试了类似的东西，`%^{Extended word (may be empty)|%\1}`但它返回`^A`了，这没有帮助。

无论如何，这个改进的版本似乎已经可以使用了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T23:37:35.363

关于输入问题，在[Org Mode Manual: 9.1.3.2 Template expansion](http://orgmode.org/org.html#Template-expansion)中，有 %\1 特殊转义码：

> %\n 插入在第 n 个 %^{prompt} 处输入的文本，其中 na 数字，从 1 开始。

重复问题可能需要一些 Emacs Lisp 编码。

有关排序，请参阅 Cc ^ (org-sort)。

顺便说一句，[org-drill](http://orgmode.org/worg/org-contrib/org-drill.html)似乎确实是一个非常有趣的包，基于 SuperMemo 的间隔重复算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T17:25:18.303

您需要一个额外的“\”，因此 %\\1 按预期工作。

# svg - 无法获得 svg 动画

> ID：14666627
> 
> 赞同：0
> 
> 时间：2013-02-02T21:18:50.217
> 
> 标签：svg, raphael

我使用 ReadySetRaphael 工具从 InkScape 导入了 SVG。我想对 svg 进行动画处理，并将其简化。因此，仅出于测试目的，我尝试使用 animate 方法对其进行转换。

我不断收到错误消息，说我的对象没有“动画”方法。我检查了其他 SO 答案，这些答案建议我必须克隆对象并设置最终路径，但不确定是否这样做，或者它如何适用于我？

到目前为止，这是我的 js 代码。

```
//code created using readysetraphael. Original svg made in inkscape.
var rsr = Raphael('rsr', '744.09448', '1052.3622');

var layer1 = rsr.set();
var path2993 = rsr.path("m 344.93716,348.36218 c 0,0 34.17415,-33.06016 -1.26571,-83.92195 -35.43985,-50.86178 39.23699,-38.14634 6.32855,-91.55121 -32.90844,-53.40487 -50.62837,-36.8748 -50.62837,-36.8748 -9.49282,-0.63577 -8.85996,-0.63577 -8.85996,-0.63577");
path2993.attr({
    id: 'path2993',
    parent: 'layer1',
    fill: 'none',
    stroke: '#cf0000',
    "stroke-width": '2.92',
    "stroke-linecap": 'butt',
    "stroke-linejoin": 'miter',
    "stroke-miterlimit": '4',
    "stroke-opacity": '1',
    "stroke-dasharray": 'none',
    "marker-start": 'none',
    "marker-mid": 'none',
    "marker-end": 'url(#TriangleInL)'
}).data('id', 'path2993');
layer1.attr({
    'id': 'layer1',
    'name': 'layer1'
});

var rsrGroups = [layer1];

//Animate svg
rsr.animate({
    transform: 's2'
}, 2000); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T10:10:41.417

您的代码在纸对象上拉动动画调用。作为[`animate()`的成员`Element`](http://raphaeljs.com/reference.html#Element.animate)，呼叫失败。

我假设您正在尝试为特定形状设置动画，例如`path2993`. 只需在相关元素上调用它：

```
path2993.animate({transform: 's2'}, 2000); 
```

# iphone - AFNetworking - JSON：接收“数字”而不是 JSON

> ID：14666633
> 
> 赞同：1
> 
> 时间：2013-02-02T21:19:25.913
> 
> 标签：iphone, sdk, afnetworking

我已经设置了一个 AFNetworking HTTP Client 子类并将 HTTP 操作注册为 AFJSONRequestOperation。并像这样设置默认标题：

```
[self setDefaultHeader:@"Content-Type" value:@"application/json"];
    [self setDefaultHeader:@"Accept" value:@"text/html"]; 
```

然后我像这样调用 RESTful 服务器：

```
 [[TheAPIClient sharedClient] getPath:domain parameters:nil success:^(AFHTTPRequestOperation *operation, id JSON) {

        NSLog(@"%@", JSON);

    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {

NSLog(@"FAILED"); 

    }]; 
```

但我得到的只是很多这样的数字：

```
<7b0d0a20 20224d65 6e755365 74223a20 7b0d0a20 20202022 4b617465 676f7269 53657422 3a205b0d 0a202020 2020207b 0d0a2020 20202020 20202245 6c656d65 6e745365 74223a20 5b0d0a20 20202020 20202020 207b0d0a 20202020 20202020 20202020 22496422 3a20312c 0d0a2020 20202020 20202020 2020224e 61766e22 3a202252 656a6520 636f636b 7461696c 222c0d0a 20202020 20202020 20202020 22426573 6b726976 656c7365 223a2022 52656a65 723f222c 0d0a2020 20202020 20202020 20202250 72697322 3a203134 392c0d0a 20202020 20202020 20202020 224b6174 65676f72 69536574 4964223a 20310d0a 20202020 20202020 20207d0d 0a202020 20202020 205d2c0d 0a202020 20202020 20224964 223a2031 2c0d0a20 20202020 20202022 4e61766e 223a2022 466f7272 6574222c 0d0a2020 20202020 20202245 6c656d65 6e745365 74496422 3a20312c 0d0a2020 20202020 2020224d 656e755f 4964223a > 
```

我怎么解决这个问题？任何想法为什么会这样？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:32:09.150

`JSON`是一个`NSData`包含

```
{
  "MenuSet": {
    "KategoriSet": [
      {
        "ElementSet": [
          {
            "Id": 1,
            "Navn": "Reje cocktail",
            "Beskrivelse": "Rejer?",
            "Pris": 149,
            "KategoriSetId": 1
          }
.... 
```

您可以将其转换为`NSDictionary`with

```
NSError *error;
NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:JSON options:0 error:&error]; 
```

# java - java - 如何从具有java反射的字段中获取扩展类的匿名实例？

> ID：14666634
> 
> 赞同：1
> 
> 时间：2013-02-02T21:19:27.247
> 
> 标签：java, reflection, field, anonymous

我有一个类“S”，在其中创建从类“T”派生的匿名类的字段：

```
class T {
  public void foo() {}
}

class S {
  T t1 = new T() {};
  T t2 = new T() {};
} 
```

我需要遍历另一个 S 实例的所有 T 字段来调用“foo”。问题是我无法创建一个实例来传递给 Field.get(...) 因为这是一个匿名类。如果我传递一个 T 实例，我会得到一个 IllegalArgumentException...

有没有机会让它发挥作用？

**编辑**

好的，我现在明白我应该将 S 传递给 Field.get()。但是我过于简单化了，情况有点复杂。S 实际上是一个匿名类：

```
class SM { 
  class S {
    void bar() {...}

    class T {
      public void foo() {}
    }
  }
}

....

SM sm = new SM() {
  S s = new S() {
    T t1 = new T() {};
    T t2 = new T() {};
  }
} 
```

我需要访问 S.bar() 中的所有 T 字段。谢谢！

**再次编辑**

pff 当然，我需要将“this”传递给 Field.get()。谢谢大家，对不起，我感觉很笨。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:35:27.627

When you call field.get(Object) you need to pass an instance on which the call will be made

```
S s = new S();
Class<?> sClass = s.getClass();
Field[] fields = sClass.getDeclaredFields();
for(Field field : fields){
    if(field.getType().equals(T.class)){
        T instance = (T)field.get(s);
        instance.foo();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:34:12.223

Hhmm, don't really see your problem. How about:

```
S s = new S();
Field t1Field = S.class.getDeclaredField("t1");
t1Field.setAccessible(true);
T t1 = (T)t1Field.get(s);
t1.foo(); 
```

# c++ - Qt 的设计问题

> ID：14666635
> 
> 赞同：1
> 
> 时间：2013-02-02T21:19:31.327
> 
> 标签：c++, qt, observer-pattern, qt5

使用 Qt 5.0.0

以下是大致的一种`Observer`模式（代码被剥离到最低限度以仅解释问题）：

```
class A : public QObject
{
    Q_OBJECT
    public:
        void registerListner(Observer *pObs);
        static A* getInstance();
    signals:
        void sig();
};

void A::registerListner(Observer *pObs)
{
    connect(this, SIGNAL(sig()), pObs, SLOT(slo));
}

////////////////////////////////////////////////////////////////

class Observer : public QObject
{
    Q_OBJECT
    public slots:
        virtual void slo() = 0;
};

class ConcreteObserver : public Observer , public QWidget
{
    Q_OBJECT
    public: //re-mentioning "slots" is not necessary
        virtual void slo();
};

ConcreteObserver *pCObs = new ConcreteObserver;
A::getInstance()->registerListner(pCObs);

///////////////////////////////////////////////////////////// 
```

问题（除了可怕的钻石）：不能从 QObject 继承多次 - moc 不允许它。一种可能的解决方案是从 QWidget 派生 Observer，然后仅从 Observer 派生 ConcreteObserver。然而，这对 ConcreteObserver 施加了限制。也许 ConcreteObserver_2 需要从 QDialog 派生等等。

我该如何解决这个设计问题？Qt 5.0.0 Signal-Slot（除了早期版本）有什么特定的东西可以解决这个问题，或者你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T09:54:44.650

如果运行时警告对您来说还不够，您可以通过制作函数模板来添加一些编译时类型检查，并通过不定义类本身来`registerListener`避免多重继承。`QObject``Observer`

这可能看起来像这样：（注意：我的 SFINAE 技能不存在，这可能会变得更好。）

```
#include <QObject>
#include <QDebug>

#include <type_traits>

class A : public QObject
{
    Q_OBJECT
    public:
        template <typename T>
        void registerListener(T *pObs)
        {
            static_assert(std::is_base_of<QObject, T>::value,
                          "Listener must be a QObject");
            static_assert(std::is_same<void, 
                                       decltype(std::declval<T>().slo())
                                      >::value,
                          "Slot slo must have signature void slo();");
            connect(this, SIGNAL(sig()), pObs, SLOT(slo()));
        }
        static A* getInstance() { return instance; }
        static void init() { instance = new A; }
        void doStuff() { emit sig(); }
    signals:
        void sig();
    private:
        static A *instance;
}; 
```

几个测试用例：

```
class BadObject1 : public QObject
{
    Q_OBJECT
    public:
        BadObject1() {}
    public slots:
        void slo(int){}
};
class BadObject2 : public QObject
{
    Q_OBJECT
    public:
        BadObject2() {}
    public slots:
        int slo(){return 0;}
};
struct BadObject3 {
    void slo();
};

class ObservedObject : public QObject
{
    Q_OBJECT
    public:
        ObservedObject(QString const& name): QObject() {
            setObjectName(name);
        }
    public slots:
        virtual void slo(){
            qDebug() << objectName();
        }
};
class ObservedObject2 : public ObservedObject
{
    Q_OBJECT
    public:
        ObservedObject2(QString const& name)
          : ObservedObject(name + " (derived)") {}
}; 
```

还有一个主文件：

```
#include "A.h"

A* A::instance = 0;

int main(int , char **)
{
    A::init();
    A::getInstance()->registerListener(new BadObject1);
    A::getInstance()->registerListener(new BadObject2);
    A::getInstance()->registerListener(new BadObject3);
    A::getInstance()->registerListener(new ObservedObject("foo"));
    A::getInstance()->registerListener(new ObservedObject2("bar"));
    A::getInstance()->doStuff();
} 
```

在所有情况下，您都会遇到编译器错误`BadObjectN`。如果您将它们注释掉，输出将如下所示：

```
"foo" 
"bar (derived)" 
```

* * *

但是有一个警告：这*不会*检查该`void slo();`成员是否确实是一个插槽。您可以在运行时通过以下方式检查：

```
if (pObs->metaObject()->indexOfSlot("slo()") == -1) {
    qDebug() << "Class" << pObs->metaObject()->className() 
                        << "doesn't have a slo slot.";
   ::exit(1);
} 
```

这将起作用并完成预期的工作（除非您有一个未将插槽声明为虚拟的类层次结构 - 然后在省略`slots`“说明符”的派生类中会发生奇怪的事情。所以我主张您的文档没有您在上面对该说明符的评论：在重载插槽时使用它总是一个好主意）。

我不相信最后的检查在编译时是可以实现的，“槽解析”是通过 QObject 元数据的运行时遍历完成的，并且涉及解析 moc 生成的字符串。即使它使用了一些递归模板魔法，我也不认为这是工作的努力。您将在注册类型处收到运行时错误消息，您可以在其中包含错误对象的实际类名。这是一个非常准确的错误消息，应该被最简单的测试用例捕获。

# c++ - std::string 到 LPBYTE 和 RegEnumValueA

> ID：14666638
> 
> 赞同：3
> 
> 时间：2013-02-02T21:20:07.960
> 
> 标签：c++, registry, type-conversion

将 std::string 转换为 LPBYTE 以使此代码正常工作的正确方法是什么？

```
string Name;
string Value;
RegEnumValueA(hKey, 0, const_cast<char*>(Name.c_str()), &dwSize, NULL, NULL, (LPBYTE)const_cast<char*>(Value.c_str()), &dwSize2); 
```

当我尝试使用此代码时，字符串名称一切正常，但字符串值中存在错误的指针错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:28:17.900

指针参数应指向将由函数修改的有效缓冲区。未`c_str()`初始化的字符串的 不指向任何有效的东西。

使用 char 缓冲区而不是`string`s。这是 const_cast<> 完全不需要的一个很好的例子。

```
char Name[200], Value[200]; //Sizes are arbitrary
DWORD dwSize = sizeof(Name), dwSize2 = sizeof(Value);

RegEnumValueA(hKey, 0, Name, &dwSize, NULL, NULL, (LPBYTE)Value, &dwSize2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:36:49.153

获取所需`std::string`数据的正确方法

```
//alloc buffers on stack
char buff1[1024];
char buff2[1024];

//prepare size variables
DWORD size1=sizeof(buff1);
DWORD size2=sizeof(buff2);

//call
RegEnumValueA(hKey, 0, buff1, &size1, NULL, NULL, (LPBYTE)buff2, &size2);

//"cast" to std::string
std::string Name(buff1);
std::string Value(buff2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:46:23.300

如果你*真的*想像你说的那样“投射” `std::string`，你可以考虑下面的代码。它应该适用于`std::string`我知道的任何实现，但它仍然有点“hacky”，我不推荐它。

```
string Name(1024, ' ');
string Value(1024, ' ');
DWORD dwSize=Name.size();
DWORD dwSize2=Value.size();

RegEnumValueA(hKey, 0, const_cast<char*>(&Name[0]), &dwSize, NULL, NULL, (LPBYTE)const_cast<char*>(&Value[0]), &dwSize2); 
```

# php - php DataGrid 等价物

> ID：14666641
> 
> 赞同：0
> 
> 时间：2013-02-02T21:20:17.690
> 
> 标签：php, mysql, sql, datagrid, crud

我正在为 ASP .NET 中具有不同方案的 20 多个表构建 CRUD 页面我只需要使用 DataGrid 并且（几乎）所有内容都会自动处理

它们是 php 中 DataGrid 的任何等效项，它允许用户在 mysql 表中添加、删除和更新记录，而无需编写所有 php/SQL 代码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T05:38:06.013

[phpGrid](http://www.phpgrid.com) (www.phpgrid.com) 可以处理你所有的 CRUD 需求。这是一个商业产品，但是伙计，它物有所值。您还可以下载免费的精简版并免费使用。

[![在此处输入图像描述](../Images/96607cd4b8587cc01dfb3a6a2802eae2.png)](https://i.stack.imgur.com/KtssO.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:16:04.613

有一些 DataGrids 有 php 库来进行 crud 操作。其中一些不是免费的。你可以看看这个不错的选择列表。[http://php-team.blogspot.com/2009/05/10-jquery-datagrid-plugins.html](http://php-team.blogspot.com/2009/05/10-jquery-datagrid-plugins.html)

如果你想生成 php 代码，有免费和商业软件，我建议你看看 phpmaker。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T16:38:36.197

你可以试试 DaDaBIK www.dadabik.org。免责声明：我是作者。

# python - 使用 Python Tkinter GUI 长时间运行的进程

> ID：14666643
> 
> 赞同：-1
> 
> 时间：2013-02-02T21:20:21.463
> 
> 标签：python, tkinter, multiprocessing

多年来我一直在做普通的 python 脚本，但最近不得不深入研究 GUI（使用 Tkinter）。简单地说，我有一个基本的 Tk 窗口，带有一个 Start/Stop 按钮，它应该调用 function `Foo()`。函数`Foo()`包含一个`while True`虽然，这将导致 UI 永远锁定。

我想知道是否可以从这里获得一些指导。我应该使用 pythons[多处理](http://docs.python.org/2/library/multiprocessing.html)工具吗？我也在考虑 Twisted / Gevent / 线程，但我认为它们不适合任务（可能是错误的）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T03:50:16.450

我最终使用了`multiprocessing`python 中的库。我开始`Foo()`一个新的过程并开始。当按下停止按钮时，它终止子进程。

# javascript - 如何循环通过复选框 ID 并将它们传递给 SQL DB？

> ID：14666644
> 
> 赞同：0
> 
> 时间：2013-02-02T21:20:23.517
> 
> 标签：javascript, arrays, checkbox

我真的很难弄清楚如何找到所有 Checkbox 输入 ID，并只用一个字符串或可以处理请求的东西将它们单独传递给我的 SQL DB。这就是我到目前为止所拥有的，它是重复的和多余的，并且是一个 PAAAIN，因为我还有 70 个复选框要通过，这变得越来越荒谬了。当然有一种方法可以在 Javascript 中做到这一点？目前这一切都有效，我有一个单独的 PHP 上传脚本，可以正确地将所有这些信息发送到数据库，我只想知道一个快捷方式或数组或任何帮助我管理我的 70 多个复选框的东西选择并且需要发送到数据库。

下面的代码是我正在使用的，它可以工作，但正如你所见，处理所有这些 ID 变得荒谬......有什么想法吗？我将永远感激不尽。

```
Separate snippet form HTML file:
<tr>
                    <td>
                        <input id="fire_extinguisher" value="fire_extinguisher" type="checkbox">Fire Extinguisher
                    </td>
                    <td>
                        <input id="eye_wash_shower" type="checkbox">Eye Wash/Shower
                    </td>
                    <td>
                        <input id="ladder_scaffold" type="checkbox">Ladder/Scaffold
                    </td>
                    <td>
                        <input id="warning_signs" type="checkbox">Warning Signs
                    </td>
                    <td>
                        <input id="communications" type="checkbox">Communications
                    </td>
                </tr> 
```

JS文件

```
//UPLOAD DATA
//Global variables
var jsaform = {
    'location_detail' : "",
    'emergency_number' : "",
    'today' : "",
    'person_in_charge' : "",
    'other_employees' : "",
    'job_description' : "",
    'job_hazards' : "",
    'energy_source_controls' : "",
    'fire_extinguisher' : "No",
    'eye_wash_shower' : "No",
    'ladder_scaffold' : "No",
    'warning_signs' : "No",
    'communications' : "No",
    'machine_guarding' : "No",
    'forklift' : "No",
    'transportation' : "No",
    'welding_cutting' : "No",
    'test_equipment' : "No",
    'barricades' : "No",
    'gfci_cord' : "No",
    'protective_covering' : "No",
    'hand_tools' : "No",
    'ventilation' : "No",
    'msds' : "No",
    'power_tools' : "No",
    'soldering' : "No",
    'equipment_other' : "",
    'natural_fiber' : "No",
    'flame_resistant' : "No",
    'long_sleeves' : "No",
    'kevlar_sleeves' : "No",
    'tyvek' : "No",
    'hard_hat' : "No",
    'hearing_protection' : "No",
    'sun_screen' : "No",
    'safety_glasses' : "No",
    'goggles' : "No",
    'face_shield' : "No",
    'harness' : "No",
    'attachment_point' : "No",
    'personal_flotation_device' : "No",
    'full_face' : "No",
    'half_face' : "No",
    'dust_mask' : "No",
    'safety_shoes' : "No",
    'rubber_boots' : "No",
    'dielectric' : "No",
    'cotton' : "No",
    'leather' : "No",
    'hot_gloves' : "No",
    'protection_other' : ""
}

function uploaddata() { 

//Read all of the data from the page
jsaform.location_detail = document.getElementById("location_detail").value;
jsaform.emergency_number = document.getElementById("emergency_number").value;
jsaform.today = document.getElementById("today").value;
jsaform.person_in_charge = document.getElementById("person_in_charge").value;
jsaform.other_employees = document.getElementById("other_employees").value;
jsaform.job_description = document.getElementById("job_description").value;
jsaform.job_hazards = document.getElementById("job_hazards").value;
jsaform.energy_source_controls = document.getElementById("energy_source_controls").value;
jsaform.equipment_other = document.getElementById("equipment_other").value;
jsaform.protection_other = document.getElementById("protection_other").value;   
//Read Checked items
if (document.getElementById('fire_extinguisher').checked) {
                    jsaform.fire_extinguisher = 'Yes';
            }
if (document.getElementById('eye_wash_shower').checked) {
                    jsaform.eye_wash_shower = 'Yes';
            }
if (document.getElementById('ladder_scaffold').checked) {
                    jsaform.ladder_scaffold = 'Yes';
            }
if (document.getElementById('warning_signs').checked) {
                    jsaform.warning_signs = 'Yes';
            }

//Send to database upload function
upload_jsaform();   
}
    function upload_jsaform() {
        $.ajax({
      type: 'POST',
      url: './php/upload_jsaform.php',
      data: jsaform,
      async: false,
      dataType: 'text',
      success: function() {
        alert("Thank you. Your Job Safety Analysis form has been submitted.");
        },

      error: function(jqXHR, textStatus, errorThrown) {
        alert("Error... " + textStatus + "\n" + errorThrown);
            }
    });
    return false;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:35:19.000

You can loop like this:

```
for (eID in jsaform) {
    if(document.getElementById(eID) && document.getElementById(eID).checked) {
        jsaform[eID] = 'Yes';
    }
} 
```

# c# - 执行 Win Store Apps 时将日期/纹理从 CLR 移动到 Directx 的运行时组件的最佳方式

> ID：14666645
> 
> 赞同：0
> 
> 时间：2013-02-02T21:20:27.000
> 
> 标签：c#, directx, windows-store-apps, textures

我有一个 Windows 应用商店应用程序和一个创建 SurfaceImageSource（direct3d 渲染）的运行时组件 (Cpp/CX)。

该应用程序显示图像的网格视图。当用户单击图像时，我想将其用作 RT 库中的纹理。我的选择是什么，什么是最好的。我应该将图像的路径传递给 RT Lib 并以某种方式将其加载到那里，还是应该将其加载到 CLR 中并将数据作为指针传递？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:32:47.647

Passing the filename might crash due to the security restrictions of Windows Store Apps. You can open a file only with a file picker or if you have been granted the explicit permission.

So when loading the file, you should save its content. E.g. to a byte array. Here is how the byte array can be generated from a `StorageFile`:

```
//file is the input StorageFile
var sourceStream = await file.OpenReadAsync();
//do anything else with the file, e.g. creating a BitmapImage
using(MemoryStream mem = new MemoryStream())
{
    //Reset the file stream
    sourceStream.Seek(0);
    sourceStream.AsStreamForRead().CopyTo(mem);
    var bytes = mem.ToArray();
} 
```

Then you should pass the byte data to the DirectX library and load it to a texture. Alternatively you can use the `BitmapDecoder` class to convert the file to raw image data. The methods `CreateAsync`, `GetPixelDataAsync` and `DetachPixelData` might be of help.

# jquery - 单击子 td 中的链接，Jquery 遍历父表

> ID：14666647
> 
> 赞同：0
> 
> 时间：2013-02-02T21:20:48.687
> 
> 标签：jquery

我有以下表结构

```
<table calss="ptable">
<tr>
<td><select>...</select></td>
<td><input/></td>
<td>input/></td>
<td><a class="abc"></a></td>
</tr>
<tr>
<td><select>...</select></td>
<td><input/></td>
<td>input/></td>
<td><a class="abc"></a></td>
</tr>
<tr>
<td><select>...</select></td>
<td><input/></td>
<td>input/></td>
<td><a class="abc"></a></td>    </tr></table> 
```

现在点击“a”标签，我必须遍历整个表并为每个 td 中的选择和输入设置值。我正在使用 jquery ......请帮助我是 jquery 的新手......

我找到了这样的解决方案......

```
 var firsta = $(".abc").first().parents(".ptable");              
  $(firsta).children("tbody").find("tr td").each(function (index) { alert(index); }); 
```

有没有更好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:05:46.680

只是不想让它无人回答。因为我有一个解决方案，所以我想分享它......

```
 var firsta = $(".abc").first().parents(".ptable");              
  $(firsta).children("tbody").find("tr td").each(function (index) { alert(index); }); 
```

谢谢大家的帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:39:36.937

也许尝试以下方法：

```
function event_a() {
    $(".ptable").find("td").bind("click",{nr:index},function(evt){
        alert(evt.data.nr);
    });
} 
```

您可以通过以下方式将此函数绑定到每个 a-tag：

```
$(".abc a").click(event_a); 
```

# vhdl - 如何在 VHDL 中表示顺序算法

> ID：14666649
> 
> 赞同：1
> 
> 时间：2013-02-02T21:20:54.043
> 
> 标签：vhdl

我来自软件领域，并试图找出如何在 VHDL 中编写顺序算法。从教科书中，它说进程内的语句是按顺序执行的。但我意识到只有当涉及到变量而不是信号时，它才是正确的。进程内部的 Re 信号，它们在进程结束时得到更新，并且评估使用右操作数的先前值。所以据我了解，它仍然是并发的。出于性能目的，我不能总是使用变量来进行复杂的计算。

1.  但是如何使用信号来呈现顺序算法呢？我最初的想法是使用 FSM。真的吗？FSM 是在 VHDL 中正确编码顺序算法的唯一方法吗？
2.  如果我是对的，进程中的信号语句是并发的，那么这与体系结构级别的信号并发分配有什么区别？过程的顺序性是否只适用于变量赋值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:51:26.797

当您尝试在不同的周期中执行算法的步骤时，您已经意识到流程中的“顺序”结构本身并不能做到这一点 - 事实上，变量也无济于事。一个顺序程序——除非它使用明确的“等待某个事件”，例如等待上升沿（clk）——将被展开并在单个时钟周期内执行。

正如您可能已经发现使用变量一样，这可能是一个相当长的时钟周期。

VHDL中有三种主要的顺序执行方式，用途不同。

让我们尝试他们在 a 和 b 之间实现线性插值，

```
a, b, c, x : unsigned(15 downto 0);
x <= ((a * (65536 - c)) + (b * c)) / 65536; 
```

(1) 是经典的状态机；最好的形式是单进程 SM。在这里，计算被分解为几个周期，以确保一次最多进行一个乘法（乘法器很昂贵！），但 C1 是并行计算的（加法/减法很便宜！）。它可以安全地用变量而不是中间结果的信号重写。

```
type state_type is (idle, step_1, step_2, done);
signal state     : state_type := idle;
signal start     : boolean := false;
signal c1        : unsigned(16 downto 0); -- range includes 65536!
signal p0, p1, s : unsigned(31 downto 0);

process(clk) is
begin
   if rising_edge(clk) then
      case state is
      when idle   => if start then
                        p1    <= b * c;
                        c1    <= 65536 - c;
                        state <= step_1;
                     end if;
      when step_1 => P0 <= a * c1;
                     state <= step_2;
      when step_2 => s <= p0 + p1;
                     state <= done;
      when done   => x <= s(31 downto 16);
                     if not start then  -- avoid retriggering
                        state <= idle;  
                     end if;
      end case;
   end if;
end process; 
```

（2）是马丁汤普森（优秀文章！）链接的“[隐式状态机](http://parallelpoints.com/inferred-state-machines-in-vhdl-vs-2-process-machines-of-all-things/)”......编辑添加链接，因为马丁的答案消失了。与显式状态机相同的注释适用于它。

```
process(clk) is
begin
   if start then
      p1 <= b * c;
      c1 <= 65536 - c;
      wait for rising_edge(clk);
      p0 <= a * c1;
      wait for rising_edge(clk);
      s  <= p0 + p1;
      wait for rising_edge(clk);
      x  <= s(31 downto 16);
      while start loop
         wait for rising_edge(clk);
      end loop;
   end if;
end process; 
```

(3) 是流水线处理器。在这里，执行需要几个周期，但一切都是并行发生的！流水线的深度（以周期为单位）允许每个逻辑顺序步骤以顺序方式发生。这允许高性能，因为长链计算被分解成周期大小的步骤......

```
 signal start     : boolean := false;
    signal c1        : unsigned(16 downto 0); -- range includes 65536!
    signal pa, pb, pb2, s : unsigned(31 downto 0);
    signal a1        : unsigned(15 downto 0);

process(clk) is
begin
   if rising_edge(clk) then
      -- first cycle
      pb <= b * c;
      c1 <= 65536 - c;
      a1 <= a;     -- save copy of a for next cycle
      -- second cycle
      pa <= a1 * c1;  -- NB this is the LAST cycle copy of c1 not the new one!
      pb2 <= pb;   -- save copy of product b
      -- third cycle
      s  <= pa + pb2;
      -- fourth cycle
      x  <= s(31 downto 16);
   end if;
end process; 
```

在这里，资源不共享；它将使用 2 个乘法器，因为每个时钟周期有 2 个乘法器。它还将为中间结果和副本使用更多的寄存器。但是，给定每个周期中 a、b、c 的新值，它会在每个周期中输出一个新结果——从输入延迟四个周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:56:27.127

1.  大多数多周期算法可以通过使用您建议的 FSM 或使用流水线逻辑来实现。如果算法由严格的顺序步骤（即没有循环）组成，流水线逻辑可能是更好的选择，FSM 通常只用于需要根据输入不同控制流的更复杂的算法。

    流水线逻辑实际上是一个非常长的组合逻辑链，使用寄存器分成多个“阶段”，数据从一个阶段流向下一个阶段。添加寄存器以减少每个阶段（两个寄存器之间）的延迟，以增加延迟为代价允许更高的时钟频率。但是请注意，较高的延迟并不意味着较低的吞吐量，因为新数据可以在前一个数据项完成之前开始处理！对于 FSM，这通常是不可能的。

2.  进程内的信号分配与体系结构之间的最大区别在于，您可以在进程内的多个位置为信号分配一个值，最后一个分配“获胜”。在架构级别，一个信号只能有一个赋值语句。许多控制流语句（if、case/when 等）也只能在流程中使用，而不是在体系结构级别。

# php - 当 iframe 完成其进程时，如何将相同的域不可见 IFRAME 内容获取到主页？

> ID：14666651
> 
> 赞同：2
> 
> 时间：2013-02-02T21:21:08.257
> 
> 标签：php, javascript, html, iframe

我想知道如何创建一个不可见的 iframe 并将其最终内容也放入主页中，而不仅仅是在 iframe 内？（注意。我的不可见 iframe url 在同一个域中，并且是用 php 编写的，我可以根据我的要求对其进行修改）。

```
<iframe id ='myframe' src='http://www.mydomain.com/process.php'></iframe> 
```

我的目标是在不可见的 iframe 完成其过程（通常需要 10 秒才能完成）时向用户显示某种加载动画，然后在主页中显示最终输出并删除加载动画。

我的不可见 iframe 重定向到另一个 php url（也在同一个域中）并输出一些数据，但我想在我的主页中显示这些数据，不仅在不可见的 iframe 内。你们能告诉我这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:31:17.777

[This](http://www.roseindia.net/java/pass-value-example/pass-value-from-iframe-parent.shtml) what you looking for? Otherwise I could only think to use `ajax` for this.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:28:48.560

用于`ajax`共享状态，或者您可以在一个窗口中执行动画，完成后，您可以使用打开一个新窗口`window.open();`

我从来没有以这种方式尝试过ajax，但是：

```
<frameset cols="25%,*,25%">
  <frame src="frame_a.php">
  <frame src="frame_b.php">
</frameset> 
```

当动画`frame_a.php`结束时，JavaScript 方法可以使用 ajax 与`frame_b.php`

`<script></script>`on中的那个方法`frame_a.php`会将 post 或 get 参数发送到`frame_b.php`. 不用担心加载...如果您没有很多资源（css/js 文件），它就足够快了。此外，如果您不希望用户等待，您可以设置一些默认动画 on `frame_b.php`。

这是该方法应包含的内容：

```
function share_state_with_frame_b(state) {
    $.ajax({
      type: "POST",
      url: "frame_b.php",
      data: { d1: "v1" , d2: "v2" }
    }).done(function( msg ) {
      // close frame_a.php
    });
} 
```

# java - 绘制字符串时绘制任意多边形而不是某些字符

> ID：14666662
> 
> 赞同：0
> 
> 时间：2013-02-02T21:21:42.400
> 
> 标签：java

我需要绘制一个文本行，其中一些指定的字符将被任意多边形替换。这些多边形必须直接使用[drawPolygon](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#drawPolygon%28int%5B%5D,%20int%5B%5D,%20int%29)用 Graphics 绘制。方法。虽然 Unicode 包含一系列图形符号，但它们不适用于此任务。

我想知道是否可以在字符串中出现该字符的任何实例中用多边形替换字符？例如，如果我输入单词“Holly”并点击“enter”，第一个字母将被多边形替换。如果然后我输入“蓟”这个词，多边形的新位置会代替第二个字母吗？

任何帮助/指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:51:43.533

假设实际的多边形以 Unicode 表示，您所要做的就是字符串替换。

```
System.out.println("Hello".replace('H', '\u25C6')); 
```

生产

> ◆你好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:38:39.803

如果你想显示一个多边形，可能最简单的方法是选择一个 Unicode 符号 有很多带有图形内容的（甚至是雪人）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:52:51.140

[这对于FontMetrics](http://docs.oracle.com/javase/7/docs/api/java/awt/FontMetrics.html)是完全可行的，它允许测量使用给定字体打印的字符串的尺寸。使用 FontMetrics 确定计算字符串片段的位置，然后在其间绘制字符串片段和多边形。

如果多边形必须以某种方式非常特殊（可能是非 Unicode 字符？），或者它们所需的尺寸与使用字体中的字母尺寸非常不同，这种方法似乎是合理的。

在 Java 早期，当 Unicode 支持还不是很好时，以这种方式绘制不受支持的国家字符的情况并不少见。

# c - 试图理解 gcc 选项 -fomit-frame-pointer

> ID：14666665
> 
> 赞同：88
> 
> 时间：2013-02-02T21:21:46.800
> 
> 标签：c, performance, gcc, cpu-registers, stack-frame

我让 Google 告诉我`gcc`option的含义`-fomit-frame-pointer`，这会将我重定向到以下语句。

> **-fomit-frame-pointer**
> 
> 不要将帧指针保存在不需要的函数的寄存器中。这避免了保存、设置和恢复帧指针的指令；它还为许多功能提供了额外的寄存器。这也使得在某些机器上无法进行调试。

根据我对每个函数的了解，将在进程内存的堆栈中创建一个激活记录，以保存所有局部变量和更多信息。我希望这个帧指针表示一个函数的激活记录的地址。

在这种情况下，哪些函数类型不需要将帧指针保存在寄存器中？如果我得到这个信息，我会尝试基于它设计新函数（如果可能的话），因为如果帧指针没有保存在寄存器中，一些指令将在二进制中被省略。在有许多功能的应用程序中，这将真正显着提高性能。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-02-02T21:29:47.403

大多数较小的函数不需要帧指针 - 较大的函数可能需要一个。

这实际上是关于编译器如何管理跟踪堆栈的使用方式以及堆栈上的位置（局部变量、传递给当前函数的参数以及为即将调用的函数准备的参数）。我认为描述需要或不需要帧指针的函数并不容易（从技术上讲，没有函数必须有一个帧指针 - 它更像是“如果编译器认为有必要降低复杂性其他代码”）。

我认为你不应该“尝试让函数没有帧指针”作为你编码策略的一部分——就像我说的，简单的函数不需要它们，所以使用`-fomit-frame-pointer`，你会得到一个可用的寄存器用于寄存器分配器，并保存 1-3 条关于进入/退出函数的指令。如果你的函数需要一个帧指针，那是因为编译器认为这是一个比不使用帧指针更好的选择。拥有没有帧指针的函数不是目标，目标是拥有既正确又快速运行的代码。

请注意，“没有帧指针”应该会提供更好的性能，但这并不是什么神奇的子弹可以带来巨大的改进——尤其是在 x86-64 上，它已经有 16 个寄存器开始。在 32 位 x86 上，因为它只有 8 个寄存器，其中一个是堆栈指针，占用另一个作为帧指针意味着占用了 25% 的寄存器空间。将其更改为 12.5% 是一个相当大的改进。当然，为 64 位编译也会有很大帮助。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-07-14T10:56:24.703

这是关于英特尔平台上的 BP/EBP/RBP 寄存器的全部内容。该寄存器默认为堆栈段（不需要特殊前缀即可访问堆栈段）。

> EBP 是访问堆栈内的数据结构、变量和动态分配的工作空间的最佳寄存器选择。EBP 通常用于相对于堆栈上的固定点而不是相对于当前 TOS 来访问堆栈上的元素。它通常标识为当前过程建立的当前堆栈帧的基地址。在偏移量计算中使用EBP作为基址寄存器时，偏移量在当前堆栈段（即SS当前选择的段）中自动计算。因为 SS 不必明确指定，所以在这种情况下指令编码更有效。EBP 还可用于索引可通过其他段寄存器寻址的段。

（来源[-http://css.csail.mit.edu/6.858/2017/readings/i386/s02_03.htm](http://css.csail.mit.edu/6.858/2017/readings/i386/s02_03.htm)）

由于在大多数 32 位平台上，数据段和堆栈段是相同的，因此 EBP/RBP 与堆栈的这种关联不再是问题。在 64 位平台上也是如此：AMD 于 2003 年推出的 x86-64 架构在很大程度上放弃了对 64 位模式分段的支持：其中四个分段寄存器：CS、SS、DS 和 ES 被强制为 0 . x86 32 位和 64 位平台的这些情况本质上意味着在访问内存的处理器指令中可以使用 EBP/RBP 寄存器，无需任何前缀。

因此，您编写的编译器选项允许将 BP/EBP/RBP 用于其他方式，例如保存局部变量。

“这避免了保存、设置和恢复帧指针的指令”意味着避免在每个函数的入口处使用以下代码：

```
push ebp
mov ebp, esp 
```

或`enter`指令，它在 Intel 80286 和 80386 处理器上非常有用。

此外，在函数返回之前，使用了以下代码：

```
mov esp, ebp
pop ebp 
```

或`leave`指令。

调试工具可以扫描堆栈数据并在定位时使用这些推送的EBP寄存器数据`call sites`，即，按照它们被分层调用的顺序显示函数的名称和参数。

程序员可能对堆栈帧有疑问，不是广义的（它是堆栈中的一个实体，只服务一个函数调用并保留返回地址、参数和局部变量），而是狭义的——当这个术语`stack frames`在编译器选项的上下文。从编译器的角度来看，堆栈帧只是*例程的进入和退出代码*，它将锚推入堆栈——也可用于调试和异常处理。调试工具可以扫描堆栈数据并使用这些锚点进行回溯，同时定位`call sites`在堆栈中，即以与分层调用函数相同的顺序显示函数的名称。

这就是为什么对于程序员来说，从编译器选项的角度理解什么是堆栈帧是至关重要的——因为编译器可以控制是否生成此代码。

在某些情况下，编译器可以省略堆栈帧（例程的入口和出口代码），变量将直接通过堆栈指针（SP/ESP/RSP）而不是方便的基指针（BP/ ESP/RSP）。编译器省略某些函数的堆栈帧的条件可能不同，例如： (1) 该函数是叶函数（即不调用其他函数的终端实体）；(2) 不使用任何例外；(3) 在堆栈上没有调用带有传出参数的例程；(4) 函数没有参数。

省略堆栈帧（例程的进入和退出代码）可以使代码更小更快。尽管如此，它们也可能对调试器回溯堆栈数据并将其显示给程序员的能力产生负面影响。这些是编译器选项，用于确定函数应满足哪些条件，以便编译器授予它堆栈帧进入和退出代码。例如，在以下情况下，编译器可以选择将此类进入和退出代码添加到函数中：（a）总是，（b）从不，（c）在需要时（指定条件）。

从一般性到特殊性：如果您使用`-fomit-frame-pointer`GCC 编译器选项，您可能会在例程的进入和退出代码以及额外的寄存器上获胜（除非它默认情况下已经打开，或者本身或其他选项隐式打开，在这种情况下，您已经从使用 EBP/RBP 寄存器的增益中受益，并且如果该选项已经隐式打开，则不会通过显式指定此选项获得额外增益）。但是请注意，在 16 位和 32 位模式下，BP 寄存器不能像 AX（AL 和 AH）那样提供对 8 位部分的访问。

由于此选项除了允许编译器在优化中使用 EBP 作为通用寄存器外，还可以防止为堆栈帧生成退出和进入代码，这会使调试复杂化——这就是[GCC 文档](https://gcc.gnu.org/onlinedocs/gcc-3.4.4/gcc/Optimize-Options.html)明确指出的原因（通常用粗体强调style) 启用此选项**会使某些机器上的调试变得不可能**。

另请注意，与调试或优化相关的其他编译器选项可能会隐式打开`-fomit-frame-pointer`或关闭该选项。

我在 gcc.gnu.org 上没有找到任何关于其他选项如何影响`-fomit-frame-pointer` *x86 平台*的官方信息，[https://gcc.gnu.org/onlinedocs/gcc-3.4.4/gcc/Optimize-Options.html](https://gcc.gnu.org/onlinedocs/gcc-3.4.4/gcc/Optimize-Options.html)仅声明以下内容：

> -O 还会在不干扰调试的机器上打开 -fomit-frame-pointer。

因此，如果您仅在 x86 平台上使用单个 `-O' 选项进行编译，*则文档本身*并不清楚是否`-fomit-frame-pointer`会打开。它可能会通过经验进行测试，但在这种情况下，GCC 开发人员没有承诺在未来不更改此选项的行为，恕不另行通知。

但是，[Peter Cordes](https://stackoverflow.com/users/224132/peter-cordes)在评论中指出，`-fomit-frame-pointer`x86-16 平台和 x86-32/64 平台之间的默认设置存在差异。

此选项 – `-fomit-frame-pointer`– 也[与 Intel C++ Compiler 15.0 相关](https://software.intel.com/en-us/node/522827)，不仅与 GCC 相关：

对于英特尔编译器，此选项有一个别名`/Oy`。

这是英特尔写的：

> 这些选项确定 EBP 是否用作优化中的通用寄存器。选项 -fomit-frame-pointer 和 /Oy 允许这样使用。选项 -fno-omit-frame-pointer 和 /Oy- 不允许它。
> 
> 一些调试器期望 EBP 被用作堆栈帧指针，除非这样，否则无法生成堆栈回溯。-fno-omit-frame-pointer 和 /Oy- 选项指示编译器生成维护和使用 EBP 作为所有函数的堆栈帧指针的代码，以便调试器仍然可以在不执行以下操作的情况下生成堆栈回溯：
> 
> 对于 -fno-omit-frame-pointer：使用 -O0 关闭优化 对于 /Oy-：关闭 /O1、/O2 或 /O3 优化 -fno-omit-frame-pointer 选项在您指定选项时设置 - O0 或 -g 选项。-fomit-frame-pointer 选项在您指定选项 -O1、-O2 或 -O3 时设置。
> 
> 当您指定 /O1、/O2 或 /O3 选项时，将设置 /Oy 选项。选项 /Oy- 在您指定 /Od 选项时设置。
> 
> 使用 -fno-omit-frame-pointer 或 /Oy- 选项可将可用通用寄存器的数量减少 1，并可能导致代码效率稍低。
> 
> 注意 对于 Linux* 系统：GCC 3.2 异常处理当前存在问题。因此，当为 C++ 安装 GCC 3.2 并打开异常处理（默认设置）时，英特尔编译器会忽略此选项。

请注意，上述引用仅与 Intel C++ 15 编译器相关，与 GCC 无关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-10-02T01:18:58.130

我以前没有遇到过“激活记录”这个词，但我认为它指的是通常所说的“堆栈帧”。这是当前函数使用的堆栈区域。

帧指针是保存当前函数堆栈帧地址的寄存器。如果使用帧指针，则在进入函数时，旧的帧指针被保存到堆栈中，并且帧指针被设置为堆栈指针。在离开函数时，旧的帧指针被恢复。

大多数普通函数不需要帧指针来进行自己的操作。编译器可以通过函数跟踪所有代码路径上的堆栈指针偏移，并相应地生成局部变量访问。

在某些情况下，帧指针对于调试和异常处理可能很重要。尽管现代调试和异常处理格式旨在支持大多数情况下没有帧指针的函数，但这种情况变得越来越少见。

现在需要帧指针的主要时间是函数使用 alloca 或可变长度数组。在这种情况下，堆栈指针的值不能被静态跟踪。

# haskell - Haskell 导入有副作用吗？

> ID：14666666
> 
> 赞同：24
> 
> 时间：2013-02-02T21:21:49.167
> 
> 标签：haskell

前段时间我写了一些代码，用于从十六进制编码的字符串文字`OverloadedStrings`创建`ByteString`s，它使用[`base16-bytestring`](http://hackage.haskell.org/package/base16-bytestring). 这工作得很好，但似乎我并没有像我想象的那样理解它。

让我完全困惑的是这个。为什么

```
{-# LANGUAGE OverloadedStrings #-}

import Data.ByteString.Base16 ()
import qualified Data.ByteString as B

plaintext = "The message" :: B.ByteString

main = print plaintext 
```

编译并运行正常，但如果我删除导入，`Data.ByteString.Base16`则编译失败（类似于[这个问题](https://stackoverflow.com/questions/3815442/how-do-i-get-the-overloadedstrings-language-extension-working)）：

```
test.hs:6:13:
No instance for (Data.String.IsString B.ByteString)
  arising from the literal `"The message"' 
```

根据[Haskell Wiki](http://www.haskell.org/haskellwiki/Import)，像这样的导入“仅用于导入类型类的实例而没有其他用途”，但据我所知，base16-bytestring 源代码没有定义任何类型类实例，只有`encode`and`decode`函数.

导入如何`IsString`为代码编译提供必要的实例？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-02T21:32:47.397

In Haskell, typeclass instances are always exported and imported--you can't hide them. This is usually referred to as the "open world assumption".

This means that typeclass instances are also exported transitively: if you import a library with an instance, it gets exported from your module as well.

In this case, the `IsString` instance is in `Data.ByteString.Char8`, which is imported by `Data.ByteString.Base16`. You should be able to replace your import with:

```
import Data.ByteString.Char8 () 
```

There is a nice [SO question](https://stackoverflow.com/questions/8728596/explicitly-import-instances) giving some information on the open world assumption, if you're interested.

# actionscript-3 - 如何在二维碰撞后保持速度

> ID：14666668
> 
> 赞同：1
> 
> 时间：2013-02-02T21:22:01.493
> 
> 标签：actionscript-3, math, collision

我知道这很明显，但我在进行简单计算时遇到了一些麻烦。

我有一个对象，它具有 X 和 Y 分量的速度。我只是通过 X 和 Y 分量的平方根来计算它的总速度：

```
var totalSpeed:Number = Math.sqrt(b.currentSpeedY * b.currentSpeedY + b.currentSpeedX * b.currentSpeedX); 
```

我还有一个名为 的变量`divergence`，它保证在 -1 和 1 之间。根据散度，我通过将散度和总速度相乘来计算碰撞后速度的新 X 分量：

```
var sX:Number =  -totalSpeed * divergence; 
```

现在，由于我有了新的 X 速度和总速度，我只需通过从总速度中减去新 X 值的平方并取其平方根来获得新的 Y 速度：

```
var sY:Number = -Math.sqrt(totalSpeed - (sX * sX)); 
```

这是我的问题：计算前后的总速度不匹配。我可以通过打印碰撞前后的总速度（平方和的根）以及简单地直观地查看物体的速度来确认这一点。碰撞后，物体的速度总是趋于变慢。

我显然在某处遗漏了一些非常简单的东西，但不幸的是在任何地方都找不到。阻止总和匹配的错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:31:12.940

在 sy 计算中它应该是

```
var sY:Number = -Math.sqrt(totalSpeed * totalSpeed - (sX * sX)); 
```

# css - INSTAPRESS WP PLUGIN - 移动和桌面对齐的 CSS 图像大小

> ID：14666675
> 
> 赞同：0
> 
> 时间：2013-02-02T21:22:54.747
> 
> 标签：css, layout, mobile, wordpress-theming, responsive-design

我在让我的 Instagram 图像正确显示时遇到问题。我尝试了所有类型的技巧和更改，但无法让它在桌面和移动设备上看起来一致。在全窗口大小和所有浏览器（移动设备除外）时，它看起来很完美，但是当我更改浏览器查看窗口的大小时，它变得很奇怪。

这是我的问题：

1.  我需要所有水平的 Instagram 图像都具有响应性，这意味着当我更改浏览器窗口的大小时，它们会调整到适合正确查看它们的尺寸。我希望他们始终保持在 5 张图像中...

这是正在进行的工作的链接：

[http://www.jaygiroux.com/wordpress/](http://www.jaygiroux.com/wordpress/)

我曾尝试尽我所能修改 instapress.css，但现在我被卡住了。我尝试在某些地方使用百分比而不是像素，但它仍然无法正常工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:37:08.420

我在线阅读的是，直到版本 3 nivo 滑块没有响应，因此您可能需要更新库。

[http://nivo.dev7studios.com/2012/05/30/the-nivo-slider-is-responsive/](http://nivo.dev7studios.com/2012/05/30/the-nivo-slider-is-responsive/)

我还注意到您调用了两次标记（第一次在 ie 类兼容性代码之间），所以也要注意这一点。

# xml - 如何使用其 baseName 而不是 Item(#) 来选择 XML 子节点？

> ID：14666678
> 
> 赞同：6
> 
> 时间：2013-02-02T21:23:38.193
> 
> 标签：xml, vba, excel, xml-parsing

我有点坚持以下几点：我尝试使用 VBA 将货币汇率从本地银行网站获取到 Excel - 主要用于 XML 解析练习，我想说这是我的第一次认真尝试。

经过几个小时的谷歌搜索和阅读相关的 SO 问题后，我得到了或多或少可行的解决方案，但我想对其进行优化以更好地理解 XML。到目前为止一切顺利，问题是：

```
<LIST_RATE>
    <RATE ISO="EUR" Code="978">
        <TITLE>Евро</TITLE>
        <CODE>978</CODE>
        <ISO>EUR</ISO>
        <DATE>Thu, 31 Jan 2013 09:00:00 GMT</DATE>
        <BUY>11550.0000</BUY>
        <SELL>11820.0000</SELL>
        <QUANTITY>1</QUANTITY>
    </RATE>
    <RATE ISO="RUB" Code="643">
        <TITLE>Российский рубль</TITLE>
        <CODE>643</CODE>
        <ISO>RUB</ISO>
        <DATE>Thu, 31 Jan 2013 09:00:00 GMT</DATE>
        <BUY>279.0000</BUY>
        <SELL>292.0000</SELL>
        <QUANTITY>1</QUANTITY>
    </RATE>
    <RATE ISO="USD" Code="840">
        <TITLE>Доллар США</TITLE>
        <CODE>840</CODE>
        <ISO>USD</ISO>
        <DATE>Thu, 31 Jan 2013 09:00:00 GMT</DATE>
        <BUY>8570.0000</BUY>
        <SELL>8710.0000</SELL>
        <QUANTITY>1</QUANTITY>
    </RATE>
</LIST_RATE> 
```

对于上面的 XML 部分（以防万一 - 这是完整 XML 的链接：http: [//www.priorbank.by/CurratesExportXml.axd?](http://www.priorbank.by/CurratesExportXml.axd?channel=9) channel=9）我正在使用以下代码遍历`RATE`节点的子节点：`LIST_RATE`

```
For Each RATE_Node In LIST_RATE_Node.ChildNodes
    CurrencyCode = RATE_Node.ChildNodes.Item(2).Text 'ISO node
    RateValue = CSng(Replace(RATE_Node.ChildNodes.Item(4).Text, ".", ",")) 'BUY node
    [rest of code]
Next 
```

代码工作正常，但我想以`RATE`某种**方式使用它们的名称**而不是`Item(#)`. 我试过`selectSingleNode`了，但我一点也不熟悉 XPath，而且我使用的符号总是返回第一个`<RATE ISO="EUR" Code="978">`值。`getElementsByTagName`返回整个节点，依此类推。

我阅读了很多相关的 SO 问题，但仍然卡住了。我很确定解决方案很简单——我只需要让所有的收支平衡。任何有关正确方向的建议或指导都将受到高度赞赏。提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-02T23:09:31.407

```
 Option Explicit

    Private Const xml As String = "<LIST_RATE>" & _
        "<RATE ISO='EUR' Code='978'>" & _
            "<TITLE>????</TITLE>" & _
            "<CODE>978</CODE>" & _
            "<ISO>EUR</ISO>" & _
            "<DATE>Thu, 31 Jan 2013 09:00:00 GMT</DATE>" & _
            "<BUY>11550.0000</BUY>" & _
            "<SELL>11820.0000</SELL>" & _
            "<QUANTITY>1</QUANTITY>" & _
        "</RATE>" & _
    "</LIST_RATE>"

    Sub test()
        Dim xmlDocument As MSXML2.DOMDocument60
        Set xmlDocument = New DOMDocument60

        If Not xmlDocument.LoadXML(xml) Then
            Err.Raise xmlDocument.parseError.ErrorCode, , xmlDocument.parseError.reason
        End If

        Dim listRateNode As IXMLDOMNode
        Dim rateNode As IXMLDOMNode
        Dim isoNode As IXMLDOMNode
        For Each listRateNode In xmlDocument.ChildNodes
            For Each rateNode In listRateNode.ChildNodes
                Set isoNode = rateNode.SelectSingleNode("ISO")
            Next
        Next

        Set isoNode = Nothing
        Set isoNode = xmlDocument.SelectSingleNode("/LIST_RATE/RATE[ISO='EUR']/ISO")
    End Sub 
```

SelectSingleNode 应该可以工作。如果在 RATE_NODE 上使用 SelectSingleNode，则只使用`rateNode.SelectSingleNode("ISO")`. 在 xml 文档中，您可以使用它`xmlDocument.SelectSingleNode("/LIST_RATE/RATE[ISO='EUR']/ISO")`来查找值为 EUR 的 iso 节点。这对你有帮助吗？

# php - 使用 PHP 和 cURL 无需登录表单即可登录网站

> ID：14666681
> 
> 赞同：2
> 
> 时间：2013-02-02T21:23:47.713
> 
> 标签：php, curl

我正在尝试使用 cURL 登录到没有登录表单的站点。要登录，您必须访问：

```
example.com/index.php?version=1.74&premium=true&user=USERNAME&password=PASSWORD&model=iPhone&sv=5.0.1 
```

老实说，我不知道从哪里开始。我浏览了许多 cURL 文章，但没有一篇解释如何在没有表单的情况下进行登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:28:19.437

表单具有字段。它还有一个 HTTP 方法（通常是 POST）。

在这种情况下，似乎数据是通过 GET 方法发布的（作为 URL 中的查询字符串）。

您只需构建该 URL（查找`http_build_query()`内置函数）并使用常规 CURL 调用请求它。很可能，您还需要接受（并继续发送）带有服务器发送给您的会话信息的 cookie。为此，您需要使用 设置`CURLOPT_COOKIEJAR`和`CURLOPT_COOKIEFILE`值[`curl_setopt()`](http://www.php.net/manual/en/function.curl-setopt.php)。

# ruby-on-rails - 如何使用链接到参数调用方法 - rails 3

> ID：14666684
> 
> 赞同：0
> 
> 时间：2013-02-02T21:24:12.677
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, link-to

我有一个名为的模型`School`，我有一个名为`custom_search`：

```
def self.custom_search( text, page, order = :asc )
    search( include: [:prices] ) do 
      fulltext text
      paginate page: page, per_page: 7
      order_by :price, order
    end
end 
```

如何从具有如下参数的视图中调用它：

```
School.custom_search params[:search], params[:page]
# or :
School.custom_search params[:search], params[:page], :desc 
```

我是否使用 link_to 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:35:35.477

```
# app/controllers/schools_controller.rb
def search
  @schools = School.custom_search params[:search], params[:page]
end

# in your view
link_to 'My link', search_schools_path(search: 'Bar', page: 1)

# config/routes.rb
resources :schools do
  collection do
    get 'search'
  end
end 
```

# actionscript-3 - Flash AS3：构造函数必须是实例方法

> ID：14666691
> 
> 赞同：0
> 
> 时间：2013-02-02T21:24:58.743
> 
> 标签：actionscript-3, flash, hittest

大家好，我有一个问题，不知道如何解决它:(有人可以告诉我怎么做吗？

构造函数必须是实例方法。

所以这是我的代码：

```
package
{
    import com.coreyoneil.collision.CollisionList;
    import flash.events.Event;
    import flash.display.Sprite;    

    public class terrain extends Sprite
    {
        private var wheel:Ball;
        private var collisionList:CollisionList;
        private var speed:Number;

        private const GRAVITY:Number = .75;
        private const FRICTION:Number = .98;
        private const IMMOVABLE:Number = 10000;

        public function terrain():void
        {
            if(stage == null)
            {
                addEventListener(Event.ADDED_TO_STAGE, init, false, 0, true);
                addEventListener(Event.REMOVED_FROM_STAGE, clean, false, 0, true);
            }
            else
            {
                init();
            }
        }

        private function init(e:Event = null):void
        {
            collisionList = new CollisionList(terrain);

            wheel = new wheel(10);
            wheel.mass = IMMOVABLE * 2;
            addChild(wheel);
            collisionList.addItem(wheel);
            wheel.x = 30;
            wheel.y = 10;

            speed = 0;

            terrain.graphics.lineStyle(15);

            addEventListener(Event.ENTER_FRAME, updateScene);
        }

        private function updateScene(e:Event):void
        {           
            var collisions:Array = collisionList.checkCollisions();

            if(collisions.length)
            {
                var collision:Object = collisions[0];
                var angle:Number = collision.angle;
                var overlap:int = collision.overlapping.length;

                var sin:Number = Math.sin(angle);
                var cos:Number = Math.cos(angle);

                var vx0:Number = wheel.vx * cos + wheel.vy * sin;
                var vy0:Number = wheel.vy * cos - wheel.vx * sin;

                // Unlike the other examples, here I'm choosing to calculate the amount
                // of bounce based on the objects' masses, with a default mass of 10000 (IMMOVABLE)
                // being used for the drawing the wheel is colliding with.  As such, the only
                // real variable in play here is the current vector of the wheel.
                vx0 = ((wheel.mass - IMMOVABLE) * vx0) / (wheel.mass + IMMOVABLE);
                wheel.vx = vx0 * cos - vy0 * sin;
                wheel.vy = vy0 * cos + vx0 * sin;

                wheel.vx -= cos * overlap /wheel.radius;
                wheel.vy -= sin * overlap / wheel.radius;

                wheel.vx += speed;
            }
            trace("down");
            wheel.vy += GRAVITY;
            wheel.vy *= FRICTION;
            wheel.vx *= FRICTION;

            wheel.x += wheel.vx;
            wheel.y += wheel.vy;

            if(wheel.x > stage.stageWidth) wheel.x = stage.stageWidth;  
            if(wheel.x < 0) wheel.x = 0;                                    
            if(wheel.y > stage.stageHeight - (wheel.height >> 1)) 
            {
                wheel.y = 10;   
                wheel.x = 30;
                wheel.vx = wheel.vy = 0;
            }

        }

        private function clean(e:Event):void
        {
            removeEventListener(Event.ENTER_FRAME, updateScene);
        }

    }
    } 
```

代码中有一些注释..请忽略它，我使用了示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:14:17.273

```
collisionList = new CollisionList(terrain);
terrain.graphics.lineStyle(15); 
```

这是错误 1026，如果构造函数是静态的、私有的或在您的情况下用作标识符，也会引发错误。使用 this.graphics 代替 terrain.graphics 或仅使用 graphics.etc（删除地形），并将“this”作为“CollisionList”的参数传递。
（无关：最好以大写“Terrain”开头的类命名）

# asp.net - 客户端时区信息

> ID：14666692
> 
> 赞同：2
> 
> 时间：2013-02-02T21:25:33.293
> 
> 标签：asp.net, asp.net-mvc-4

在 ASP .NET (MVC 4) 中，以下内容不会在客户端的本地时间呈现。

```
@DateTime.UtcNow.ToLocalTime() 
```

我希望它在客户的本地时间呈现。我相信我可以通过在 BeginRequest 上设置线程的 TimeZoneInfo 来做到这一点。

这是处理时区的正确（或适当）方式吗？如果是这样，我怎样才能在 BeginRequest 中获取客户端的 TimeZoneInfo 以便我可以适当地设置它？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:38:13.383

`DateTime.UtcNow.ToLocalTime()`会给你服务器的时间。最好的方法是让用户在您网站上的帐户设置中决定他的时区。

您可以使用一些 Javascript 技巧来找到他的时区。请参阅此问题：[如何在 ASP.NET 中获取客户端日期和时间？](https://stackoverflow.com/questions/274826/how-to-get-client-date-and-time-in-asp-net)

# ruby - 与 enum#with_index 混淆 - 起始偏移索引

> ID：14666696
> 
> 赞同：0
> 
> 时间：2013-02-02T21:26:02.803
> 
> 标签：ruby, ruby-1.9.3

```
a=[11,22,31,224,44].to_enum
=> #<Enumerator: [11, 22, 31, 224, 44]:each>
a.select.with_index{|x| puts x if x<2 }
=> []
a.with_index(2)
=> #<Enumerator: #<Enumerator: [11, 22, 31, 224, 44]:each>:with_index(2)>
irb(main):011:0> a.with_index(2){|x| puts x if x==224}
224
=> [11, 22, 31, 224, 44]
a.with_index(2){|x| puts x if x < 224}
11
22
31
44
=> [11, 22, 31, 224, 44] 
```

***困惑：*** *这里我将起始偏移量设置为`2`。但是如果我们查看输出 - 怎么`11`来* 而不是`31`。正如在`31`位置上`2th`。

```
a.with_index(2){|x| puts x if x > 224}
=> [11, 22, 31, 224, 44]
a.with_index(1){|x| puts x if x > 224}
=> [11, 22, 31, 224, 44]
a.with_index(1){|x| puts x if x < 224}
11
22
31
44
=> [11, 22, 31, 224, 44]
a.with_index(1){|x| puts x if x < 224}
11
22
31
44
=> [11, 22, 31, 224, 44] 
```

***困惑：*** *在这里，我将起始偏移量设置为`1`。但是如果我们查看输出 - 怎么`11`来而不是`22`。正如在`22`位置上`1st`。*

在考虑所有事实时，即使我们提到了起始偏移量，我也想知道 - 为什么`enum#with_index`不从提到的偏移量开始评估？

***注意：***是否有任何直接的方法来打印`index`内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:34:34.260

[Enumerator#with_index](http://ruby-doc.org/core-1.9.3/Enumerator.html#method-i-with_index) has confusing documentation,but hopefully this will make it more clear.

```
a=[11,22,31,224,44].to_enum
=> [11, 22, 31, 224, 44]
a.with_index { |val,index| puts "index: #{index} for #{val}" }
index: 0 for 11
index: 1 for 22
index: 2 for 31
index: 3 for 224
index: 4 for 44

a.with_index(2) { |val,index| puts "index: #{index} for #{val}" }
index: 2 for 11
index: 3 for 22
index: 4 for 31
index: 5 for 224
index: 6 for 44 
```

As you can see, what it actually does is offset the index, not start iterating from the given index.

# windows-phone-8 - 从应用程序和电脑共享文件

> ID：14666699
> 
> 赞同：0
> 
> 时间：2013-02-02T21:26:33.193
> 
> 标签：windows-phone-8

我创建了一个应用程序来记录音频并为其添加一些效果（Voice Instagram！）。

目前，我将这些文件的 mp3 版本保存在本地存储文件夹中。出于调试目的，我需要从我的 PC 访问这些文件。这就是问题所在！

WP8 不允许我在任何公共文件夹（文档、音乐等）中写入内容，并且我无法从我的 PC 访问内部应用程序文件。

我在这里有什么选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T06:50:34.763

我最终使用 SkyDrive 并在那里上传文件。

# .net - .NET 最灵活的 Web 服务 API 框架是什么？

> ID：14666700
> 
> 赞同：1
> 
> 时间：2013-02-02T21:26:48.067
> 
> 标签：.net, web-services, asp.net-web-api

在考虑如何为客户实现 Web 服务以编程方式调用我们的服务时，我已经查看了 Microsoft Web API 框架，它看起来很棒，但这是最好、最灵活的框架吗？

例如，我想让客户像这样调用 RESTful 方法：

/api/产品/创建

并尽可能灵活，允许客户通过几种不同的方法调用它

```
HTTP GET:
/api/products/create?name=widget&price=1.99

HTTP POST:
/api/products/create
name=widget&price=1.99

JSON via POST:
/api/products/create
{ "name": "widget", "price": 1.99 }

XML via POST:
/api/products/create
<product><name>widget</name><price>1.99</price></product> 
```

以及其他任何有意义的事情。归根结底，我不在乎他们如何调用它，因为我只需要输入来执行操作，我希望允许客户通过他们喜欢的任何方法调用它，并且对他们来说最简单，然后我可以响应例如，如果他们通过 Accept 请求标头指定，则使用相同的格式或特定格式。

Web API 框架是否可以处理这个问题，或者是否有其他一些路由框架可以以这种方式工作，以便使用可以发送到 ProductsRepository 的 Product 模型调用我的控制器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:00:21.187

Web API 绝对可以处理：)

这是你如何做到的。设置这条路线：

```
config.Routes.MapHttpRoute("WebAPI", "api/{controller}/{action}"); 
```

并像这样创建您的模型和控制器：

```
public class ProductsController : ApiController
{
    [HttpGet]
    public void Create(string name, decimal price)
    {
        Create(new Product() { Name = name, Price = price });
    }

    [HttpPost]
    public void Create(Product product)
    {
        // Create product
    }
}

[DataContract(Name = "product", Namespace = "")]
public class Product
{
    [DataMember(Name="name")]
    public string Name { get; set; }
    [DataMember(Name="price")]
    public decimal Price { get; set; }
} 
```

您上面列出的所有内容都应该适用于此。第一个操作将处理 GET，只要请求具有正确的 Content-Type 标头，您显示的所有三种不同的 POST 格式都应该与第二个操作一起正常工作。

Web API 默认带有反序列化 XML、JSON 和表单 URL 编码数据的格式化程序，但您也可以注册自己的自定义格式化程序以支持更多格式。如果您需要更多相关信息，可以在此处找到：

[http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters](http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters)

您已经了解了使用 Web API 的主要优势之一。它使读取和公开各种格式的数据变得非常容易，而无需重新编写业务逻辑。

# r - R中数字信号处理的卷积

> ID：14666702
> 
> 赞同：6
> 
> 时间：2013-02-02T21:27:03.597
> 
> 标签：r, vector, signal-processing, convolution, digital

我有一个简单的数字系统，它有一个输入 x(n) = u(n) - u(n-4)。![系统一](../Images/676b32e738ad10ce53442075398af005.png)

我正在尝试使用“signal”包中的 conv() 函数或“stats”包中的 convolve() 函数找到输出 y(n)，并绘制 y(n) 与 n 的关系，即 -10 ≤ n ≤ 10.

到目前为止，我有以下代码：

```
library(signal)

n <- c(-10:10)                           # Time index
x <- c(rep(0, 10), rep(1, 4), rep(0, 7)) # Input Signal
h1 <- c(rep(0, 11), 0.5, rep(0, 9))      # Filter 1
h2 <- 0.8^n                              # Filter 2
h2[0:11] <- 0                            #

system <- data.frame(n, x, h1, h2)

y <- conv(x + conv(x, h1), h2)           # Output Signal

system <- transform(system, y=y[1:21]) 

plot(system$n, system$y) 
```

我检查了这个情节，这是非常错误的。我认为在进行卷积时会回收一些向量，并且 conv() 函数的输出似乎与原始时间索引不一致。我似乎无法弄清楚如何在这里解决我的逻辑。我意识到 conv(n, m) 函数返回一个长度为 (m+n)-1 的向量，有没有一种好方法可以轻松地将这个向量与时间索引向量匹配？

这将需要一些数字信号处理知识以及 R 中的编码知识，如果有人有为此目的使用 R 的经验并且可以提供一些指示，那就太好了。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:28:41.437

我想通了。 conv() 函数的输出中心与时间索引向量的中心对齐。像这样：

```
library(signal)

n <- c(-10:10)                           # Time index
x <- c(rep(0, 10), rep(1, 4), rep(0, 7)) # Input Signal, square pulse
h1 <- c(rep(0, 11), 0.5, rep(0, 9))      # Filter 1
h2 <- 0.8^n                              # Filter 2
h2[1:10] <- 0                            #

system <- data.frame(n, x, h1, h2)

y <- conv(x + conv(x, h1)[11:31], h2)    # Output Signal

system <- transform(system, y=y[11:31]) 

plot(system$n, system$y) 
```

我将使用通用表格来完成此操作，因为我会定期执行此操作，并且不想每次都手动执行此操作。如果有人打败我，请分享。:)

# 更新

创建了 conv() 函数的一般形式，以自动排列输入和输出向量的索引。这是以无法获得完整卷积为代价的，因此您必须首先将输入设置为描绘整个感兴趣区域。

```
library(signal) # Should this be inside the func. with attach(), detach()?

conv2 <- function(x, y){
    conv(x, y)[ceiling(length(x)/2):(length(x)+floor(length(x)/2))]
}

# so 
y <- conv2(x + conv2(x, h1), h2) 
```

# 更新 2

我想要一个与 FFT 进行比较的函数。我对这个版本不太满意，我想使用 sapply()，但它确实有效。现在，它会做......我会努力改进。

```
conv3 <- function(x, h){
m <- length(x)
n <- length(h)
X <- c(x, rep(floor(n/2), 0, floor(n/2)))   
H <- c(h, rep(floor(m/2), 0, floor(m/2)))
   Y <- vector()

for(i in 1:n+m-1){
    Y[i] <- 0 
    for(j in 1:m){
        Y[i] <- ifelse(i-j+1>0, Y[i] + X[j]*H[i-j+1], 0)
    }
}
Y[is.na(Y)] <- 0
Y[ceiling(m/2):(m+floor(m/2))]
} 
```

接下来，我认为我需要努力使其具有多维性。

# php - PHP foreach 不显示结果

> ID：14666714
> 
> 赞同：-1
> 
> 时间：2013-02-02T21:28:09.747
> 
> 标签：php, html, twitter

我有一个脚本可以抓取 Twitter 搜索 API 并在推文中返回 URL 的结果。但是，它目前没有返回任何结果。为什么是这样？

```
$search = json_decode(file_get_contents('https://search.twitter.com/search.json?q=%23google%20vine.co%2Fv%2F&result_type=recent&include_entities=1&rpp=10'));

foreach($search->results as $result) {
    echo $result->urls->expanded_url.'<br>';
} 
```

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:40:01.913

尝试

```
foreach($search->results as $result) {
    foreach($result->entities->urls as $url){
        echo $url->expanded_url.'<br>';
    }
} 
```

$search->results 是一个对象数组，你也必须迭代这个

# networking - 如何计算隔离交换机上 TCP 多播的节省？

> ID：14666717
> 
> 赞同：0
> 
> 时间：2013-02-02T21:28:20.593
> 
> 标签：networking, tcp, multicast

对 TCP 与多播的“真正节省”进行了有趣的讨论，发现我们都无法证明我们关于复制数据的切换成本的假设，而且我一直无法找到明确的答案。

这是场景： - 我们有一个服务器，它通过 TCP 发布到 3 个客户端。- 服务器和客户端在一个交换机上。

我们同意从 TCP 切换到多播可以节省网络，但不同意这些节省有多大。

有明显且易于搜索的节省： - 多播上的较小标头 - 没有连接消息 - 没有 ack 消息

我们不同意的地方是开关将节省多少“工作”。在 TCP 中，数据将从服务器复制到交换机，并切换到客户端 3 次（3 次向上，3 次向下）。在多播中，数据将从服务器复制到交换机一次，然后复制到客户端 3 次（1 次向上，3 次向下）。

我的同事认为，到客户端的 3 个多播副本对于交换机而言与 tcp 副本一样多（相对于大小和其他协议差异），而我相信交换机具有可以使多播副本显着降低成本的优化。

或者换一种说法，添加第 4 个多播客户端会“几乎是 tcp 的一半昂贵”还是“几乎免费”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:36:59.173

基本节省是每三个传入的 TCP 数据包一个传入的多播数据包。其他一切都是次要的。

# debugging - Windbg，如何检查内存段权限？

> ID：14666721
> 
> 赞同：7
> 
> 时间：2013-02-02T21:28:52.897
> 
> 标签：debugging, memory, permissions, windbg

例如输出堆栈为不可执行，一些堆是可执行/不可执行的..

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-03T05:48:51.340

[!address](http://msdn.microsoft.com/en-us/library/windows/hardware/ff561519(v=vs.85).aspx)或[!vprot](http://msdn.microsoft.com/en-us/library/windows/hardware/ff565611(v=vs.85).aspx) (UM) 扩展显示虚拟内存保护信息。

```
0:000> !address 0038f750
Usage:                  Stack
Allocation Base:        00290000
Base Address:           0038d000
End Address:            00390000
Region Size:            00003000
Type:                   00020000    MEM_PRIVATE
State:                  00001000    MEM_COMMIT
Protect:                00000004    PAGE_READWRITE
More info:              ~0k

0:000> !vprot 0038f750
BaseAddress:       0038f000
AllocationBase:    00290000
AllocationProtect: 00000004  PAGE_READWRITE
RegionSize:        00001000
State:             00001000  MEM_COMMIT
Protect:           00000004  PAGE_READWRITE
Type:              00020000  MEM_PRIVATE 
```

# angularjs - 他们是控制器“调用”指令的更好方法吗

> ID：14666725
> 
> 赞同：0
> 
> 时间：2013-02-02T21:29:24.610
> 
> 标签：angularjs, angularjs-directive

我有一个创建和管理引导模式对话框的指令。

目前我有指令监视控制器上的布尔值。然后控制器可以将其设置为 true 以显示模式对话框。

这似乎有点乱。有没有更好的办法？

行动中的指令：

```
<modal trigger="shouldDisplayModal" title="{{modalTitle}}" 
message="{{modalMessage}}" positiveclick="okClicked()" 
negativeclick="closed()" 
positivelabel="Ok" negativelabel="Cancel"/> 
```

指令控制器中的手表：

```
// watch the trigger value. expected to be boolean
$scope.$watch('trigger',function(newValue, oldValue){                
    if (newValue)
    {
        // enable any disabled buttons 
        modalElem.find('button').removeClass('disabled');
        // show the dialog
        modalElem.modal('show');
    }
    else
    {
        // hide the dialog
        modalElem.modal('hide');
    }
}); 
```

这是一个工作示例：http: [//jsfiddle.net/rabidgremlin/Ya96z/31/](http://jsfiddle.net/rabidgremlin/Ya96z/31/)

**更新**：这是一个修复的示例，可以纠正页面上多个指令的一些问题：http: [//jsfiddle.net/rabidgremlin/sjbCJ/1/](http://jsfiddle.net/rabidgremlin/sjbCJ/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:57:10.740

我打算建议在指令模板中使用 ng-show （[指令](http://docs.angularjs.org/guide/directive)页面上的对话框组件所做的，以及与您的属性`visible`一样的`trigger`属性），但后来我看到您之前还需要启用一些按钮修改可见性。

所以，我认为你所拥有的一切都很好，而且我不认为它是混乱的。要么您的指令必须 $watch 某些东西，要么您可以在事件发生时创建对话框——这似乎是 @pkozlowski 在评论中提到的 $dialog 服务所做的。后者不需要触发器属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:59:29.860

就在几周前，我写了一篇关于使用 angular 和 bootstrap modals 的博客。

我的解决方案涉及一项服务，模式的所有隐藏/显示魔法都由引导程序的 javascript 处理，而角度只是担心数据。

[http://willvincent.com/blog/angularjs-and-twitter-bootstrap-playing-nicely](http://willvincent.com/blog/angularjs-and-twitter-bootstrap-playing-nicely)

# java - Android JSON 解析器

> ID：14666728
> 
> 赞同：2
> 
> 时间：2013-02-02T21:29:35.683
> 
> 标签：java, android, json

我正在尝试解析位于[http://api.pathofexile.com/ladders/Default?offset=0&limit=1](http://api.pathofexile.com/ladders/Default?offset=0&limit=1)的 JSON 。

```
{
"total": 15000,
"entries": [
    {
        "online": false,
        "rank": 1,
        "character": {
            "name": "Byrr",
            "level": 85,
            "class": "Shadow",
            "experience": 1397076236
        },
        "account": {
            "name": "Canoobians"
        }
    }
]
} 
```

在尝试修改它以检索“在线”和“排名”元素时，我一直在关注[androidhive 教程。](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)（最终我想要所有具有大量条目的元素，但我只从这两个开始尝试理解事物。

```
public class AndroidJSONParsingActivity extends ListActivity {

// url to make request
private static String url = "http://api.pathofexile.com/ladders/Default?offset=0&limit=2";

// JSON node names
private static final String TAG_ENTRIES = "entries";
private static final String TAG_ONLINE = "online";
private static final String TAG_RANK = "rank";

// entries JSONArray
JSONArray entries = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // Hashmap for ListView
    ArrayList<HashMap<String, String>> entriesList = new ArrayList<HashMap<String, String>>();

    // create JSON Parser instance
    JSONParser jParser = new JSONParser();

    // getting JSON string from url
    JSONObject json = jParser.getJSONFromUrl(url);

    try {
        // Getting Array of entries
        entries = json.getJSONArray(TAG_ENTRIES);

        // looping through entries
        for (int i = 0; i < entries.length(); i++) {
            JSONObject ent = entries.getJSONObject(i);

            // storing each JSON item in a variable
            String online = ent.getString(TAG_ONLINE);
            String rank = ent.getString(TAG_RANK);

            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            // adding each child node to HashMap key => value
            map.put(TAG_ONLINE, online);
            map.put(TAG_RANK, rank);

            // adding HashList to ArrayList
            entriesList.add(map);
        }
    } catch (JSONException e) {
        e.printStackTrace();
    }

    // Updating parsed JSON data into ListView
    ListAdapter adapter = new SimpleAdapter(this, entriesList, R.layout.list_item, new String[] { TAG_ONLINE, TAG_RANK }, new int[] { R.id.online, R.id.rank });
    setListAdapter(adapter); 
```

我的 JSONParser() 类与教程中的相同。现在，当我运行程序时，我得到了错误：

```
Error parsing data org.json.JSONException: Value <!DOCTYPE of type java.lang.String cannot be converted to JSONObject. 
```

我不知道为什么会发生这个错误，因为根据 JSONLint，JSON 是有效的，所以它不应该发送任何 HTML，对吗？有没有我遗漏的东西，或者甚至是一种完全不同/更好的提取 JSON 的方法？任何朝着正确方向的踢球都将不胜感激。

**编辑：**由于我是新用户，所以我还不能自我回答，但事实证明我得到了一个`NullPointerException`我`JSONParser()`以前没有看到的问题，并且使用`HttpGet()`而不是`HttpPost()`解决了我的问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:53:55.587

在 JSONParser 中查看这一行

```
 BufferedReader reader = new BufferedReader(new InputStreamReader(
                        is, "iso-8859-1"), 8); 
```

站点返回此标头

```
Content-Type: text/html; charset=UTF-8 
```

您必须在 BufferedReader 中将 iso-8859-1 更改为 UTF-8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T06:02:05.623

事实证明，我得到了一个`NullPointerException`我`JSONParser()`以前没有看到的内容，并且使用`HttpGet()`而不是`HttpPost()`解决了我的问题。

# linux - Receive data on socket in TIME_WAIT state

> ID：14666740
> 
> 赞同：2
> 
> 时间：2013-02-02T21:31:36.483
> 
> 标签：linux, sockets, tcp, time-wait

What happens, in below scenarios, when a socket in TIME_WAIT receives a segment

*   a) When it receives lost ACK
*   b) When sending node wants to establish another new connection using same src_ip:src_port on the server to same dst_ip:dst_port for which the server already has a TIME_WAIT socket.

Will it ignore/drop it, sends a reset or reuse the TIME_WAIT socket?

Thanks

M

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:48:19.523

> a) 当它收到丢失的 ACK

没有什么。

> b) 当发送节点想要在服务器上使用相同的 src_ip:src_port 建立另一个新连接到服务器已经有一个 TIME_WAIT 套接字的相同 dst_ip:dst_port 时。

没有什么。

这两种情况都不符合您的标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T02:55:10.103

好的 在深入挖掘并阅读了这本书 [第 43 页] 'Unix Network Programming' 之后，我终于弄清楚了我的问题出了什么问题（回答我自己的问题）。

a）'Active-Closer'，在 TIME_WAIT 状态下，将重新发送 ACK 到丢失/徘徊的 FIN（在此状态下不期望任何 ACK [链接] [http://upload.wikimedia.org/wikipedia/ commons/5/55/TCP_CLOSE.svg](http://upload.wikimedia.org/wikipedia/commons/5/55/TCP_CLOSE.svg) )

b) TCP 不会启动处于 TIME_WAIT 状态的连接的新化身。（我仍然不知道它是如何阻止它的，即它是否重置了该连接，我们如何通过读取 tcpdump 来计算这一点）

# kendo-ui - Kendo Mobile Appended form elements from treeview not being noticed

> ID：14666748
> 
> 赞同：0
> 
> 时间：2013-02-02T21:32:40.063
> 
> 标签：kendo-ui, kendo-treeview

I am trying to figure out why appended form elements are not being notice by kendo mobile --- i have tried 10 different fixes but those items just dont get noticed:

This is in the view:

```
<li>
                            <div id="currentMovements">
                                <ul id="curMoves" data-role="listview" ></ul>
                            </div>

                            Add Movements:
                            <div id="routineMovements"></div>

                        </li> 
```

And this is my script:

```
<script>

        //init move count
        var move_count = 0;

        function onSelect(e) {

            console.log("Selected: " + this.text(e.node));

            //add li to movements div
            //make each field unique by li 
            //using move_count
            $("#currentMovements ul").append('<li><input type="text" name="moves[' + move_count + ']" data-min="true" id="moves[' + move_count + ']" class="k-input small-move" value="' + this.text(e.node) + '" /><input type="text" name="id[' + move_count + ']" data-min="true" id="sets[' + move_count + ']" class="k-input small-nums" value="3" /> sets of <input type="text" name="reps[' + move_count + ']" data-min="true" id="reps[' + move_count + ']"  class="k-input small-nums" value="10" /><span class="clearitem">Delete</span></li>');

            //increase move count
            move_count++;

                ///test to see if the field is being noticed
                moves = $('#moves[0]').val();   
                console.log(moves);
        }

        function populateRoutineForm() {

            $('#curMoves .clearitem').live('click', function() {
                $(this).parent().remove();
            });

            var routineMovementsData = new kendo.data.HierarchicalDataSource({
                data: [
                    {
                        text: "Chest", items: [
                            { text: "Inclined Bench" },
                            { text: "Decline Bench" },
                            { text: "Dumbell Presses" }
                        ]
                    },{
                        text: "Tricep", items: [
                            { text: "Cable Pulldowns" },
                            { text: "Skull Crushers" },
                            { text: "Close Grip Benchpress" }
                        ]
                    }
                ]
            });

            //todo can we use the MVVM stuf from above to do this now?
            $("#routineMovements").kendoTreeView({
                dataSource: routineMovementsData,
                select: onSelect
            });

        }

        function sendAddRoutine() {

            var userID = window.localStorage.getItem("userID"); 

            var routine_title = $('#routine_title').val();
            var routine_share = $('#routine_share').val();

                ///test to see if the field is being noticed
                moves = $('#moves[0]').val();   
                console.log(moves);

            $.ajax({
                url: endpoint + "app/api/add_routine.php",
                dataType: "jsonp",
                type: "GET",
                data: { userID: userID, routine_title: routine_title, routine_share: routine_share },

                success: function (data) {
                    $('#routineResult').html(data.results);

                    //app.navigate("#view-routineFeed");

                }
            });
        }

        $('#routineDoneButton').click(function () {

            sendAddRoutine();
        });

    </script> 
```

Im wondering if there some way to re-init the view without losing other fields that appear above the append div?

# mysql - MySQL select distinct across multiple tables

> ID：14666751
> 
> 赞同：0
> 
> 时间：2013-02-02T21:32:57.410
> 
> 标签：mysql, sql, distinct

I have a query that selects all columns from multiple tables, but it's returning multiples of the same values (I only want distinct values).

How can I incorporate something like this? When I try this, it still

```
Select Distinct A.*, B.*, C.*.... 
```

Does distinct only work when selecting the column names and not all (*) ? In [this](http://www.w3schools.com/sql/sql_distinct.asp) reference it says distinct in reference to column names, not across all of the tables. Is there any way that I can do this?

**edit - I added more info below**

Sorry guys, I just got back onto my computer. Also, I just realized that my query itself is the issue, and Distinct has nothing to do with it.

So, the overall goal of my Query is to do the following

1.  Generate a list of friends that a user has
2.  Go through the friends and check their activities (posting, adding friends, etc..)
3.  Display a list of friends and their activities sorted by date (I guess like a facebook wall kind of deal).

Here are my tables

```
update_id |  update | userid  | timestamp  //updates table

post_id |  post | userid  | timestamp      //posts table

user_1 |   user_2  | status   |  timestamp   //friends table 
```

Here is my query

```
SELECT U.* , P.* ,F.* FROM posts AS P 
JOIN updates AS U ON P.userid = U.userid 
JOIN friends AS F ON P.userid = F.user_2 or F.user_1
WHERE P.userid IN (
        select user_1 from friends where user_2 = '1'
        union
        select user_2 from friends where user_1 = '1'
        union
        select userid from org_members where org_id = '1'
        union
        select org_id from org_members where userid = '1'
        ) 
ORDER BY P.timestamp, U.timestamp, F.timestamp limit 30 
```

The issue I'm having with this (that I thought was related to distinct), is that if values are found to meet the requirements in, say table Friends, a value for the Posts table will appear too. This means when I'm displaying the output of the SQL statement, it appears as if the Posts value is shown multiple times, when the actual values I'm looking for are also displayed

The output will appear something like this (notice difference between post value in the rows)

```
update_id |  update | userid  | timestamp | post_id |  post | userid  | timestamp | user_1 |   user_2  | status   |  timestamp

     1    | update1 |   1    | 02/01/2013 |    1    |  post1|  1      |  2/02/2013|  1     |   2       |  1       | 01/30/2013
     1    | update1 |   1    | 02/01/2013 |    2    |  post2|  1      |  2/03/2013|  1     |   2       |  1       | 01/30/2013 
```

So, as you can see, I thought I was having a distinct issue (because update1 appeared both times), but the query actually just selects all the values regardless. I get the results I'm looking for in the Post table, but all the other values are returned. So, when I display the table in PHP/HTML, the Post value will display, but I also get duplicates of the updates (just for this example)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T09:21:39.347

我想你想要这个：

```
select *
from tableA
union
select * 
from tableB
union
select * 
from tableC 
```

这假设 HHS 表都具有相同数量的列并且它们具有相同的数据类型。这不是，您必须选择特定的列才能做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:08:19.953

如果您多解释一下您正在查询的表之间的连接是什么，那将很容易，因为您可以使用联接、联合（如上所述）甚至分组依据...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:10:06.200

您更新后的帖子显示的 JOIN 条件之一为：

```
JOIN friends AS F ON P.userid = F.user_2 OR F.user_1 
```

这相当于：

```
JOIN friends AS F ON (P.userid = F.user_2 OR F.user_1  != 0) 
```

并将包含许多您不打算包含的行。您可能打算：

```
JOIN friends AS F ON (P.userid = F.user_2 OR P.userid = F.user_1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T21:50:00.507

当您选择 distinct * 时，您选择每一行，包括使记录唯一的那一行。如果你想要比你得到的更好的东西，你必须在你的选择子句中输入各个列的名称。

# jquery - 将值四舍五入到小数点后 2 位 JavaScript

> ID：14666752
> 
> 赞同：21
> 
> 时间：2013-02-02T21:33:06.400
> 
> 标签：jquery, rounding

我对最终值有一个小问题，我需要四舍五入到小数点后两位。

```
var pri='#price'+$(this).attr('id').substr(len-2);
            $.get("sale/price?output=json", { code: v },
               function(data){
                 $(pri).val(Math.round((data / 1.19),2));
            });
        }); 
```

任何帮助表示赞赏。

解决方案：`$(pri).val(Math.round((data / 1.19 * 100 )) / 100);`

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-02-02T21:45:31.000

如果您希望将其视觉格式化为两位小数作为字符串（用于输出），请使用[`toFixed()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Number/toFixed)：

```
var priceString = someValue.toFixed(2); 
```

@David 的回答有两个问题：

1.  它将结果保留为浮点数，因此可以显示具有许多小数位的特定结果，例如，`134.1999999999`而不是`"134.20"`.

2.  如果您的值是整数或四舍五入到十分之一，您将看不到额外的十进制值：

    ```
    var n = 1.099;
    (Math.round( n * 100 )/100 ).toString() //-> "1.1"
    n.toFixed(2)                            //-> "1.10"

    var n = 3;
    (Math.round( n * 100 )/100 ).toString() //-> "3"
    n.toFixed(2)                            //-> "3.00" 
    ```

而且，正如您在上面看到的，使用`toFixed()`也更容易打字。;)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-02T21:33:51.143

只需将数字乘以 100，四舍五入，然后将所得数字除以 100。

# asp.net - Diagnosing "Thread was being aborted." in ASP.NET

> ID：14666753
> 
> 赞同：3
> 
> 时间：2013-02-02T21:33:41.280
> 
> 标签：asp.net, iis-7.5, windbg

I am receiving a "Thread was being aborted." in the stack trace of my ASP.NET application. I am attempting to use the WinDbg technique described here to diagnose: [http://blogs.msdn.com/b/asiatech/archive/2012/06/21/how-to-troubleshoot-httpexception-request-timed-out-asp-net-4-0-64-bit.aspx](http://blogs.msdn.com/b/asiatech/archive/2012/06/21/how-to-troubleshoot-httpexception-request-timed-out-asp-net-4-0-64-bit.aspx) Right now I am just trying to catch this in the sample asp.net application provided. I can get the asp.net application to timeout but I can't get the dump described in the article to generate. I think I need help from a WinDbg person to understand where I am going wrong. I am including the WinDbg entries. My output is a bit different but I can't tell which address to use in the `aspnet_timeout.cfg` file described.

```
0:038> .symfix
0:038> .loadby sos clr
0:038> !name2ee system.web.dll System.Web.RequestTimeoutManager+RequestTimeoutEntry.TimeoutIfNeeded
Module:      59201000
Assembly:    System.Web.dll
Token:       0600699b
MethodDesc:  592926e4
Name:        System.Web.RequestTimeoutManager+RequestTimeoutEntry.TimeoutIfNeeded(System.DateTime)
JITTED Code Address: 593f4200
0:038> !U 593f4200
preJIT generated code
System.Web.RequestTimeoutManager+RequestTimeoutEntry.TimeoutIfNeeded(System.DateTime)
Begin 593f4200, size 29\. Cold region begin 59d14150, size 23
Hot region:
*** WARNING: Unable to verify checksum for C:\Windows\assembly\NativeImages_v4.0.30319_32\System.Web\ccb5cc864818531ed9725d02d3d078a6\System.Web.ni.dll
>>> 593f4200 55              push    ebp
593f4201 8bec            mov     ebp,esp
593f4203 57              push    edi
593f4204 56              push    esi
593f4205 8bf1            mov     esi,ecx
593f4207 8b4e10          mov     ecx,dword ptr [esi+10h]
593f420a 8d4508          lea     eax,[ebp+8]
593f420d ff7004          push    dword ptr [eax+4]
593f4210 ff30            push    dword ptr [eax]
593f4212 3909            cmp     dword ptr [ecx],ecx
593f4214 e85f83f5ff      call    System_Web_ni+0x14c578 (5934c578) (System.Web.HttpContext.MustTimeout(System.DateTime), mdToken: 060025f7)
593f4219 8bf8            mov     edi,eax
593f421b 85ff            test    edi,edi
593f421d 0f852dff9100    jne     System_Web_ni+0xb14150 (59d14150)
593f4223 5e              pop     esi
593f4224 5f              pop     edi
593f4225 5d              pop     ebp
593f4226 c20800          ret     8
Cold region:
59d14150 8bce            mov     ecx,esi
59d14152 e849bb6cff      call    System_Web_ni+0x1dfca0 (593dfca0) (System.Web.RequestTimeoutManager+RequestTimeoutEntry.RemoveFromList(), mdToken: 0600699a)
59d14157 b9508f4859      mov     ecx,offset System_Web_ni+0x288f50 (59488f50) (MT: System.Web.HttpApplication+CancelModuleException)
59d1415c e8ef4c63ff      call    System_Web_ni+0x148e50 (59348e50) (System_Web_ni)
59d14161 8bd0            mov     edx,eax
59d14163 c6420401        mov     byte ptr [edx+4],1
59d14167 8bcf            mov     ecx,edi
59d14169 e89a0963ff      call    System_Web_ni+0x144b08 (59344b08) (System_Web_ni)
59d1416e e9b0006eff      jmp     System_Web_ni+0x1f4223 (593f4223) 
```

aspnet_timeout.cfg

```
<ADPlus Version='2'>
      <!-- Configuring ADPlus to log all first chance exceptions -->
      <!-- Will still create full dump for any type of second chance exceptions -->
  <KeyWords>
     <keyword Name="loadbysos"> .loadby sos clr</keyword>
     <keyword Name="GetJIT"> !name2ee System.web.dll System.Web.RequestTimeoutManager+RequestTimeoutEntry.TimeoutIfNeeded </keyword>
     <keyword Name="JITAddress"> .foreach /pS 0n13 ( record {!name2ee System.web.dll System.Web.RequestTimeoutManager+RequestTimeoutEntry.TimeoutIfNeeded}) { r $t1= ${record}; bp $t1+0xb14150 ".dump /ma /u ${AdpDumpDirEsc}\\Full Request timed out ${AdpProcName}_.dmp;g"; .printf"*breakpoint list*\n"; bl}        </keyword>
  </KeyWords>
   <Settings>
                  <Option>  NoDumpOnFirst  </Option>
                  <RunMode> CRASH </RunMode>
  </Settings>
  <PreCommands>
         <DebugActions> loadbysos; GetJIT; JITAddress </DebugActions>
  </PreCommands>
</ADPlus> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:01:53.003

此日志显示您在某处有 TimeOut。但是您的计算机上必须有其他事件显示在您已超时的女巫页面中。

如果您有很多次超时，您首先需要找到导致该问题的页面，可能是保存会话的下载页面，或者需要比超时设置更多时间运行的页面。

此执行[超时](http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.executiontimeout.aspx)在 web.config 上设置，默认值为 110 秒：

```
<system.web>
    <httpRuntime executionTimeout="110"/>
</system.web> 
```

# objective-c - 使用 ARC 重新分配对象

> ID：14666755
> 
> 赞同：1
> 
> 时间：2013-02-02T21:33:51.890
> 
> 标签：objective-c, cocoa, properties, automatic-ref-counting

如果我在对象的 init 中创建了一个 NSArray。

然后稍后我想为相同的属性重新创建一个新的 NSArray 我应该先将旧的设置为 nil 吗？

IE

去就好了么……

```
self.arrayProperty = [[NSArray alloc] init]; 
```

还是我应该...

```
self.arrayProperty = nil;
self.arrayProperty = [[NSArray alloc] init]; 
```

（为了这个例子，我只是使用一个数组，但这是关于属性的一般问题）。

如果它有任何区别，它是一个强大的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:35:53.943

第一种方法很好，您不需要`nil`在分配新对象之前显式设置它，因为 setter 在保留和分配新对象之前释放属性的支持对象。正是你在 MRC 下会做的事情（除了这里你不自动释放对象）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T22:22:02.550

就像 ARC 一样，当没有更多对它的引用时，对象就会死亡。唯一的区别是，在第二个代码中你做了一个无用的额外操作。

# sql-server - Recursive CTE with additional EXISTS conditions?

> ID：14666759
> 
> 赞同：3
> 
> 时间：2013-02-02T21:34:17.770
> 
> 标签：sql-server, common-table-expression, recursive-query

I have a situation where I need to be able to see if a given person is within a user/manager hierarchy. I have the next structure of table: UserId UserName ManagerId

I have 2 IDs: some UserId (say 5) and ManagerId (say 2). As a result I need to know if manager with given Id (2) is chief for user with given id (5)? For example, if

1.  User 1 reports to user 2.
2.  User 3 reports to user 1.
3.  User 4 reports to user 3

the result SQL-query have to show that for UserId = 4 and ManagerId = 1 answer is true.

I've just created query for getting all hierarchy:

```
WITH temp (level, UserName, UserId, ManagerId) AS
(
  SELECT 1 AS level, EmployeeName, EmployeeId, BossId
  FROM Employees
  WHERE BossId IS NULL

  UNION ALL

  SELECT level+1 AS level, EmployeeName, EmployeeId, BossId
  FROM Employees, temp
  WHERE BossId = UserId
)

SELECT t.* from temp AS t 
```

But now I don't know how to get result query with above mentioned conditions :(

Thanks in advance for any help!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:52:49.473

在锚点中找到用户，然后沿着层次结构向上走。检查您在递归查询中针对经理获得的行。

如果存在经理行，这将返回经理行。

```
WITH temp AS
(
  SELECT EmployeeName, EmployeeId, BossId
  FROM Employees
  WHERE EmployeeId = @UserID

  UNION ALL

  SELECT E.EmployeeName, E.EmployeeId, E.BossId
  FROM Employees AS E
    inner join temp AS T
      ON E.EmployeeId = T.BossId
)

SELECT * 
FROM temp
WHERE EmployeeId = @ManagerID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:16:54.607

如果他或她存在，这将返回 BossID：

```
WITH BOSSES AS 
(
    SELECT BossID
    FROM Employees
    WHERE EmployeeID = @uID

    UNION ALL

    SELECT E.BossID
    FROM Employees E 
    JOIN BOSSES B ON E.EmployeeID = B.BossID
)
SELECT *
FROM BOSSES 
WHEN BossID = @bID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T22:03:54.110

我已经将所有级别的层次结构包含在 CTE 中，然后您可以使用它来查询。使用此层次结构，您可以在分隔列中查看给定员工的所有经理（可能对其他计算有用）。

试试这个：

```
WITH cte (UserId, ManagerId, Level, Hierarchy) as (
   SELECT EmployeeId, BossId, 0, CAST(EmployeeId as nvarchar)
   FROM Employee
   WHERE BossId IS NULL 
   UNION ALL
   SELECT EmployeeId, BossId, Level+1, 
      CAST(cte.Hierarchy + '-' + CAST(EmployeeId as nvarchar) as nvarchar)
   FROM Employee INNER JOIN cte ON Employee.BossId=cte.UserId 
)
SELECT * 
FROM cte
WHERE UserId = 4 
  AND '-' + Hierarchy LIKE '%-1-%' 
```

这是[小提琴](http://sqlfiddle.com/#!3/a6f561/1)。我使用了 UserId = 4 和 ManagerId = 1。

祝你好运。

# django - setting django-storages with S3

> ID：14666762
> 
> 赞同：1
> 
> 时间：2013-02-02T21:34:32.997
> 
> 标签：django, amazon-s3

I have used django-storages and S3Boto on my current project.

All went well on my project when running on my windows machine under the dev webserver. uploads are automaticly uploaded to my S3 and any storage hold in a FileField automaticlly set to my S3 URL when using {{MEDIA_URL}}

Now, I didnt set anything in my MEDIA_URL.

Today, I have set up my site in an EC2 Amazon linux machine running apache and my site runs however any {{MEDIA_URL}} does not set to my S3 URL, the same code base is working perfectly on my windows dev webserver.

When I am uploading it does upload to my S3 but I can not refer to my S3 files within my templetes. What strange is that via the admin site I am able to get the S3 URL. so everything looks right but I probably doing somthing wrong.

How did I set my S3 storage :

On settings.py

```
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
AWS_ACCESS_KEY_ID = "[my key]"
AWS_SECRET_ACCESS_KEY = "[my key]"
AWS_STORAGE_BUCKET_NAME ="[my bucket]" 
```

Thats it, and its work like a charm on my dev enviorment.

Any ideas what I am doing wrong ?

# jquery - 使用 $.getScript 加载的脚本中未定义 CoffeeScript 类

> ID：14666764
> 
> 赞同：2
> 
> 时间：2013-02-02T21:34:57.870
> 
> 标签：jquery, coffeescript

我将 CoffeeScript 类与 jQuery 结合使用，并通过 ajax 加载另一个 HTML 页面，该页面又引用另一个 javascript，但无法让 ajax 加载页面查看父页面在脚本中加载的类：

父页面加载一个 javascript 文件（从 CoffeeScript 编译）：

```
<script src="/assets/global.js?body=1" type="text/javascript"></script> 
```

在 CoffeeScript 文件中有一个类：

```
class App
  constructor: ->
    ... 
```

我正在加载另一个网页：

```
$.ajax({
  url: '/import/show', 
  success: (data) =>
    $('#content').html(data)
}) 
```

该页面又引用了另一个 Coffee/JavaScript 文件：

```
<script src="/assets/import.show.js?body=1" type="text/javascript"></script> 
```

当这个加载的 javascript 文件包含：

```
alert('test') 
```

警报按预期发出。这表明加载代码工作正常。但是，如果子脚本包含：

```
app = new App() 
```

我收到一个错误：

```
Uncaught ReferenceError: App is not defined 
```

如果我将代码放在文档就绪函数中，也会发生这种情况：

```
$(=> a = new App()) 
```

有谁知道如何使父页面加载的脚本中的类在通过ajax加载的子页面加载的脚本中可用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-18T09:49:27.570

只需在您的班级名称前加上@。

```
class @App 
```

这将生成以下内容：

```
(function() {
    this.App = (function() {
    ... 
```

Since you define the class when window is the *this*, it will be globally accessible.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:57:31.020

我想我已经发现了为什么会发生这种情况并找到了解决方法。当我查看编译后的脚本（而不是 CoffeeScript）时，我发现了以下内容：

```
(function() {
    var App
    App = (function() {
    ... 
```

然后我发现'class App'将类定义为函数中的var，这意味着它只能从该CoffeeScript文件中访问。

解决方法是让我将我的类定义为：

```
class window.App
  constructor: ->
    ... 
```

然后，这会将类的范围设置为窗口 DOM 对象，然后可以从 ajax 加载的脚本中访问该对象。

有谁知道是否有更好的方法可以做到这一点，或者这似乎是正确的方法？

# php - 使用 XMLHttprequest 上传多个文件

> ID：14666765
> 
> 赞同：3
> 
> 时间：2013-02-02T21:35:09.180
> 
> 标签：php, javascript, html, xmlhttprequest

我正在尝试制作一个进度百分比的异步文件上传表单。我认为这可能适用于 FormData 对象，但我认为该帖子不起作用。当我提交时没有任何反应。我已经检查过，没有错误，没有 javascript 也可以工作，所以 PHP 没问题 代码有什么根本性的问题吗？

```
 var handleUpload = function(event){
      event.preventDefault();
      event.stopPropagation();

  var fileInput = document.getElementById('file');
  var data = new FormData();

  for(var i = 0; i < fileInput.files.length; ++i){
     data.append('file[]',fileInput.files[i]);
}
  var request = new XMLHttpRequest();
      request.upload.addEventListener('progress',function(event){
   if(event.lengthComputable){

      var percent = event.loaded / event.total;
      var progress = document.getElementById('upload_progress');

    while (progress.hasChildNones()){
           progress.removeChild(progress.firstChild);
         }
           progress.appendChild(document.createTextNode(Math.round(percent * 100) + '%'));
   }
});

           request.upload.addEventListener('load',function(event){
           document.getElementById('upload_progress').style.display = 'none';
});
           request.upload.addEventListener('error',function(event){
           alert("failed");

});
           request.open('POST','upload.php');
           request.setRequestHeader('Cache-Control','no-cache');
           document.getElementById('upload_progress').style.display = 'block';
};

           window.addEventListener('load',function(event){
           var submit = document.getElementById('submit');
           submit.addEventListener('click',handleUpload);
}); 
```

的HTML：

```
<div id = "upload_progress"></div>

<form id="form" action="" method="post" enctype="multipart/form-data">
    <input id="file" name="file[]" type="file" multiple /><br>
    <input type="submit" name="send" id ="submit" value="send">
</form> 
```

并上传.php

```
if(!empty($_FILES['file'])){
    foreach  ($_FILES['file']['name'] as $key => $name) {
    move_uploaded_file($_FILES['file']['tmp_name'][$key],"myfiles/$name");
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:58:00.330

您忘记了 javascript 代码中最重要的一行：

`request.send(data);`

在这之后：

`request.setRequestHeader('Cache-Control','no-cache');`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T22:25:12.377

之后

```
request.setRequestHeader('Cache-Control','no-cache'); 
```

您忘记发送数据..

```
request.send(data); 
```

顺便说一句，您需要发送正确的标头

```
request.setRequestHeader("Content-type", ,,,
request.setRequestHeader("Content-length",...
request.setRequestHeader("Connection", "close"); 
```

# javascript - 从字段中获取数字并处理它们

> ID：14666767
> 
> 赞同：1
> 
> 时间：2013-02-02T21:35:19.753
> 
> 标签：javascript, jquery

我有一个字段，它通过与数字关联的链接列表获取它的输入。（类似于计算器，但没有运算符）。我想检索这些数字并将它们通过一个将它们除以 12 的函数。（从英尺到英寸的转换）。

首先，我有一个 jQuery click 函数列表，如下所示：

```
$('#a0').click(function(){
    writeInput(input, one); // var one = 1;
}); 
```

接下来我有“写输入”功能（这是数字显示在“屏幕”上的地方）

![在此处输入图像描述](../Images/fad5c0d8bf6d70355eddcb8781e982ee.png)

```
function writeInput(field, str){
    $input = $(field);
    var text = $input.val($input.val() + str);
    $input.text(text);
    convert(text);
} 
```

最后我有一个函数应该将输入的数字除以 12

```
function convert(input){
    var divide = (input / 12);
    $("#output").html(divide); //output is a paragraph where the number is displayed
} 
```

当我运行我的代码时，我得到**NAN**输出应该是数字。我尝试过 parseInt() 和其他技巧。但是我最接近正确的是当我得到 [object] [object] 输出时。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:41:31.827

在您的代码`text`中是一个 jQuery 对象，您使用`val`作为返回 jQuery 对象的 setter，您应该使用`val`/`text`方法作为获取更新值的 getter。

```
function writeInput(field, str){
    var text = $(field).val(function(i, v){
                  return v + str;
               }).text(function(i, t){
                  return t + str
               }).val();
    convert(text);
} 
```

# javascript - 用 JavaScript 编写这个 jQuery 点击函数

> ID：14666774
> 
> 赞同：0
> 
> 时间：2013-02-02T21:35:56.037
> 
> 标签：javascript, jquery

我正在慢慢地从 jQuery 到 vanilla JS，但是我正在努力用 JavaScript 编写以下内容，我是否必须为每个元素设置一个“for”循环？我如何将子元素定位为一个 ID？

这是我想了解的：

```
$('#id li').click(function(){
    $(this).addClass('active');
}); 
```

我了解文档 getElementById 来获取“#id”，但我将如何获得子 <li> 元素？以及如何让“onclick”功能适用于单击的任何列表元素？我是否必须为每个元素设置一个“for”循环？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:50:16.293

这是一个 JSFiddle，可以满足您的要求：http:
[//jsfiddle.net/digitalzebra/ZMXGC/10/](http://jsfiddle.net/digitalzebra/ZMXGC/10/)

```
(function() {
    var wrapper = document.getElementById("id");
    var clickFunc = function(event) {
        var target = event.originalTarget || event.target;

        target.className = "active";
    };

    wrapper.addEventListener("click",clickFunc);
})(); 
```

稍微解释一下是为了...

首先，我使用自执行函数来获取包装器 div，使用`getElementById()`. 这相当于在 jQuery 中使用 id 选择器：`$('#id')`

接下来，我使用该函数将点击处理程序附加到元素`addEventListener()`并传入一个事件类型`click`。

这将 click 处理函数绑定到 div 元素，就像 jQuery`click()`一样。我正在使用一种称为事件冒泡的东西，其中包装器的任何子级上的单击事件将调用附加到包装器的单击处理程序。

一旦用户点击元素，我们的函数就会被调用。 `originalTarget`or`target`是用户实际点击的元素，**在这种情况下，它始终是`li`**. 然后我将该元素上的类设置为活动状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T22:27:41.160

这是上述问题的示例 [http://jsfiddle.net/G3ADG/2/](http://jsfiddle.net/G3ADG/2/)

```
 (function() {
    var id = document.getElementById("id");
    var liele = id.getElementsByTagName("li");
    for (var i = 0; i < liele.length; i++) {
        liele[i].addEventListener("click", function () {
            this.className = "active";
        })

    }
})(); 
```

好吧，我真的很喜欢 Polaris878 解决方案，因为他没有在其中使用任何循环。在我的解决方案中，首先使用 document.getElementById 获取 HTML 节点信息，这与 $("#id") 类似。比在下一步中我获取的所有标签类型的“li”是“id”的孩子，而不是在这个 li 标签数组上添加事件监听器来监听点击功能

className 是允许在该节点上添加类的属性之一

我已经在 mozilla 和 chrome 中测试了上面的代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T22:03:22.407

这将起作用（IE >= 10），不想搜索 classList.add() 替换 IE<10，

```
var elems = document.querySelectorAll('#id li');
for (var i = 0; i < elems.length; i++) {
    var elem=elems[i];
    elem.addEventListener("click", function (e) {

        this.classList.add('active');
    });
} 
```

[小提琴](http://jsfiddle.net/oceog/j9cQy/)

# svg - 如何使 SVG 元素在 Retina MacBook 上的 Safari 中以高 DPI 呈现？

> ID：14666776
> 
> 赞同：3
> 
> 时间：2013-02-02T21:36:21.053
> 
> 标签：svg, safari, retina-display

[本网站](http://couplespsychology.com)使用所有矢量图形 (SVG)。在配备 Retina 显示屏的 MacBook Pro 上的 Safari 中，一些元素以高 DPI 模式呈现，而一些元素以低分辨率呈现（然后像素加倍）。

它们都在 Chrome 中以高清形式呈现。

什么决定了 SVG 元素在 OS X 上的 Safari 中是以高 DPI 还是低 DPI 呈现？是否可以强制 Safari 在视网膜屏幕上以高 DPI 渲染元素？

# php - 在 Yii 框架中检查验证规则

> ID：14666779
> 
> 赞同：0
> 
> 时间：2013-02-02T21:36:33.790
> 
> 标签：php, yii, yii-events

我是 Yii 框架的新手，所以我试图了解它的工作方式。对于创建表单的用户，我有以下验证规则，现在我需要检查 afterValidation() 方法，如果所有验证规则都通过了用户密码的哈希值。我不知道的是，如果 Yii 有一个内置方法，如果验证规则是否通过，则返回 true 或 false。

```
 public function rules()
    {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            array('email, password, username', 'required'),
            array('email, username, password', 'length', 'max'=>256),
            array('email, username', 'unique'),
            array('password', 'compare'),
            array('password_repeat', 'safe'),
        );
    }

 protected function afterValidate()
        {
            parent::afterValidate();
          if("VALIDATION RULES HAVE PASSED, ther is no error message")
{  
            $this->password = $this->encrypt($this->password);
}
        }
        public function encrypt($value)
        {
          return md5($value);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T01:42:55.920

您应该使用的方法是[$this->hasErrors()](http://www.yiiframework.com/doc/api/1.1/CModel#hasErrors-detail)因为您的表单验证已经执行。嵌套错误的可能原因是它`afterValidate()`在每个之后调用你，`$this->validate()`因为我认为如果执行验证会自动调用它并且你最终会出现无限循环

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T02:45:11.503

相反，如果`afterValidate()`在验证周期中运行任何东西，我想你想把你的代码放在`beforeSave()`.

`beforeSave()`只有在您的验证规则运行并且没有错误时才会运行。

作为奖励：如果你只是在做标准密码的东西，考虑使用[Yii 密码行为](https://github.com/phpnode/YiiPassword)。它将为您节省大量时间，并且已经被一些最优秀的 Yii 程序员彻底检查过。

# css - 如果里面没有任何东西，textarea 的大小会缩小

> ID：14666782
> 
> 赞同：1
> 
> 时间：2013-02-02T21:36:44.717
> 
> 标签：css

我有一个 ID 为 #studentselect 的简单文本区域

```
#studentselect{
    max-width:350px;    
    min-width:350px;    
} 
```

现在我遇到的问题是，如果在兼容性视图中在 IE9 中测试时 textarea 中没有任何内容，那么 textarea 的宽度会缩小到 20px。我的问题是，如果 textarea 中没有任何内容，如何将默认 textarea 宽度设为 350px？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:39:36.993

```
#studentselect{
  width:350px;    
} 
```

我已经上传[了这个简单的小提琴](http://jsfiddle.net/8REzj/)。

# backbone.js - 下划线，不能调用未定义的替换

> ID：14666786
> 
> 赞同：1
> 
> 时间：2013-02-02T21:37:38.120
> 
> 标签：backbone.js

我之前遇到过这个错误并尝试了我在 SO 上找到的解决方案，但在这种情况下我无法通过尝试我找到的解决方案来解决它。我有一个 question_template 放在我的索引文件的标题中，文件底部带有 js 脚本标签。在视图的初始化程序中，我使用 jQuery html 函数获取模板，控制台日志显示模板是从 index.html 中检索的。但是，当我尝试将其插入下划线 _.template 时，它​​会触发无法调用未定义错误的替换

```
 var QuestionView = Backbone.View.extend({
el: $(".east"), 
initialize: function(){

    var template = $('#question_template').html();
    console.log(template);
    this.template = _.template(template);   #error triggered

}, 
```

由于我能够记录模板，我看不出我的问题是什么？这是下划线代码的一部分。

```
text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {
source += text.slice(index, offset)
.replace(escaper, function(match) { return '\\' + escapes[match]; }); 
```

第一个问题：“文本”代表什么，在我的情况下，它是未定义的？我会认为“文本”是模板，但既然我可以记录我的模板，它是如何未定义的？

我还准备好包含在文档中的所有 js 代码（包括问题视图的初始化），这在有关此问题的其他 SO 问题中是解决方案

```
$(function() {

  ...code ommitted...
  var question_view   = new QuestionView({ model: game});

}); 
```

第二个问题：还有什么我可以尝试的

**更新** 注意，我随后将模型数据传递给模板，但由于触发了错误，它永远不会那么远

```
**$(this.el).html(this.template(response));** 
```

我分三个步骤准备模板

```
1\. var template = $('#question_template').html();
        console.log(template);
2\.      this.template = _.template(template);

3\. $(this.el).html(this.template(response)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:47:07.637

您应该将模型数据传递给模板，

this.template = _.template(template, this.model.toJSON());

# android - Android中相同大小的图片GridView

> ID：14666790
> 
> 赞同：1
> 
> 时间：2013-02-02T21:38:08.027
> 
> 标签：android, image, gridview, pixels, image-size

我想在`GridView`.

我试图以不同的方式获得屏幕尺寸。例如：

```
final int h = getResources().getDisplayMetrics().densityDpi;

and set size of the image..
convertView.setLayoutParams(new GridView.LayoutParams(h, h)); 
```

但这还不够。如果屏幕很大，那么 2 个图像在大屏幕上看起来非常小 - 就像花生一样。

例如，谁能指导我。设备的屏幕尺寸为纵向 4 英寸，我可以创建 2 张几乎 2 英寸的图像。

![在此处输入图像描述](../Images/17573bd6d5c193b33c7b7c4849f2181a.png)

这是我的gridview xml文件

```
 <GridView
        android:id="@+id/grid_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:alwaysDrawnWithCache="true"
        android:clipChildren="true"
        android:gravity="center_horizontal"
        android:horizontalSpacing="2dp"
        android:verticalSpacing="5dp"
        android:numColumns="auto_fit"
        android:padding="0dp"
        android:scrollingCache="true"
        android:smoothScrollbar="true"
        android:stretchMode="columnWidth"
         >
    </GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T05:47:36.503

听起来您正在尝试根据屏幕尺寸更改图像尺寸，如果是这样，您应该查看[支持多种屏幕尺寸](http://developer.android.com/guide/practices/screens_support.html)的教程。Android 已经提供了该功能。

此外，如果您只水平显示两个图像，则可以使用 LinearLayout 代替，使用 GridView 是矫枉过正的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T13:51:02.277

将这些属性添加到您的网格 android:columnWidth="200dp" android:stretchMode="columnWidth"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:46:26.093

只需在 XML 中设置 GridView 的列数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-05T02:35:51.057

要制作相同大小的图像，请`ImageView` 像这样[SquaredImageView](https://github.com/square/picasso/blob/master/picasso-sample/src/main/java/com/example/picasso/SquaredImageView.java)

如果您想`Layout`拥有相同的大小，请遵循相同的方法`onMeasure`描述`SquaredImageView`

# css - 如何修复冲突的响应式菜单 Css 和 Colorbox css？

> ID：14666791
> 
> 赞同：0
> 
> 时间：2013-02-02T21:38:12.430
> 
> 标签：css, responsive-design, colorbox

我正在尝试将响应式菜单集成到我的网站[，](http://www.bravotech.me/skeleton/menu.html)但我还运行了一个彩盒脚本​​。问题是，响应式菜单的 css（我在[这里](http://designshack.net/articles/css/code-a-responsive-navigation-menu/)）搞乱了我的 colorbox css。CSS如下：

彩盒CSS：

```
/*
    ColorBox Core Style:
    The following CSS is consistent between example themes and should not be altered.
*/
#colorbox, #cboxOverlay, #cboxWrapper{position:absolute; top:0; left:0; z-index:9999;
 overflow:hidden; }
#cboxOverlay{position:fixed; width:100%; height:100%;}
#cboxMiddleLeft, #cboxBottomLeft{clear:left;}
#cboxContent{position:relative;}
#cboxLoadedContent{overflow:auto;}
#cboxTitle{margin:0;}
#cboxLoadingOverlay, #cboxLoadingGraphic{position:absolute; top:0; left:0; width:100%; height:100%;}
#cboxPrevious, #cboxNext, #cboxClose, #cboxSlideshow{cursor:pointer;}
.cboxPhoto{float:left; margin:auto; border:0; display:block; max-width:none;}
.cboxIframe{width:100%; height:100%; display:block; border:0;}
#colorbox, #cboxContent, #cboxLoadedContent{box-sizing:content-box;} 
```

响应式菜单 css 如下：

```
* {
    padding: 0;
    margin: 0;

    -webkit-box-sizing: border-box;
       -moz-box-sizing: border-box;
            box-sizing: border-box;
}

nav {
    width: 90%;
    margin: 50px auto; 
}

nav ul {
    list-style: none;
    text-align: right;
   /* overflow: hidden; */
}

nav li a {
    background: #444;
    border-right: 1px solid #fff;
    color: #fff;
    display: block;
    float: left;
    font: 400 13px/1.4 'Cutive', Helvetica, Verdana, Arial, sans-serif;
    padding: 10px;
    text-align: center;
    text-decoration: none;
    text-transform: uppercase;
    width: 12.5%;

        /*TRANSISTIONS*/
    -webkit-transition: background 0.5s ease;
       -moz-transition: background 0.5s ease;
         -o-transition: background 0.5s ease;
        -ms-transition: background 0.5s ease;
            transition: background 0.5s ease;
}

 /*HOVER*/
nav li a:hover , nav li a.current{
    background: #222;
}

nav li a:visited {
    color:#FFF;
}

nav li:last-child a {
    border: none;
}

/*SMALL*/
nav small {
    color: #aaa;   
    font: 100 11px/1 Helvetica, Verdana, Arial, sans-serif;
    text-transform: none;

}

...more responsive css STUFF ( unimportant) 
```

**我已经找到了问题。**我需要帮助修复它。当我打开彩盒图片时，框本身比弹出窗口的其余部分要小。所以它看起来很棒，我正在 FireFox 18.0.1 中对其进行测试，但如果我使用 Chrome 版本 24.0.1312.56 m 并且它可以在 Chrome 中运行（它显示了整个事情）

问题在于菜单css中的这一行：

```
 -moz-box-sizing: border-box; 
```

而且我对它不太熟悉，不知道它在做什么，但我知道如果我把它拿出来，我的响应式设计菜单不能正常工作，但我的颜色框可以。我正在考虑将它从 css 的“*”部分中取出并将其添加到其他地方，但我该怎么做呢？我可以将其硬编码为 div 或其他内容吗？这是我的html：

```
 <link rel="stylesheet" href="stylesheets/base.css">
    <link rel="stylesheet" href="stylesheets/skeleton.css">
    <link rel="stylesheet" href="stylesheets/layout.css">

    <link rel="stylesheet" href="stylesheets/menu-css.css">

    <link rel="stylesheet" href="colorboxjs/colorbox/colorbox1.css" />
        <script type="text/javascript" src="jquery/jquery-1.8.1.min.js"></script>
        <script type="text/javascript" src="colorboxjs/jquery.colorbox-min.js"></script>
        <script>
            $(document).ready(function(){
            $(".gallery3").colorbox({rel:'gallery3', transition:"none", width:"75%", height:"75%"});
            });
        </script>

</head>
<body>

    <!-- Primary Page Layout
    ================================================== -->

    </div><!-- container -->

    <div class="container" style="background:lightgray; padding: 15px">
        <h3> 5 menu right </h3>
        <nav>
        <ul>
        <li><a class="current" href="#">First</a></li>
        <li><a href="#">Second</a></li>
        <li><a href="#">Third</a></li>
        <li><a href="#">Fourth</a></li>
        <li><a href="#">Fifth</a></li>
        </ul>       
        </nav>
    </div>

    <div class="container" style="background:lightgray; padding: 15px">
    <P>THIRD TYPE - No Transition + fixed width and height (75% of screen size)</P>
        <a class='gallery3' href='images/slider-1.jpg'>Pic 1</a>
        <a class='gallery3' href='images/slider-2.jpg'>Pic 2</a>
        <a class='gallery3' href='images/slider-3.jpg'>Pic 3</a>
    </div>  
    <br/><br/>
<!-- End Document
================================================== -->
        <script>
            jQuery('a.gallery').colorbox();
        </script>
</body>
</html> 
```

感谢所有高级帮助。～喵喵

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T00:48:04.170

什么 box-sizing: border-box; 确实是，它将在您的内容宽度中包含所有边框和填充宽度/长度。所以不是 1px 边框 + 50px 宽度 = 52px 总宽度，边框框将始终强制总宽度为 50px。

您始终可以使用媒体查询并从某个屏幕尺寸开始使用边框框，这可以很好地分离您的正常和移动 CSS，但它会在您需要修复的小屏幕上导致类似的错误。这是有关媒体查询的快速介绍：http: [//css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

或者，您可以摆脱边框并手动将您看到的任何更改移回原位（为此使用 FF 的 firebug 或 Chrome 开发人员工具）。但我确实想补充一点，边框框非常酷且方便，您应该考虑将其保留并轻推您的默认代码。

# heroku - heroku-toolbelt git:clone 当我是项目合作者时权限被拒绝 - 不是所有者

> ID：14666803
> 
> 赞同：0
> 
> 时间：2013-02-02T21:39:41.100
> 
> 标签：heroku, heroku-toolbelt

我是 Heroku java 项目的合作者。我想克隆项目。

当我执行

> git:clone -a theapp

我收到了我在其他帖子中看到的控制台消息：

```
Cloning from app 'theapp'...
Cloning into 'theapp'...
Warning: Permanently added the RSA host key for IP address '50.19.xx.xxx' to the list of known hosts.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0644 for '/Users/me/.ssh/id_rsa' are too open.
It is recommended that your private key files are NOT accessible by others.
This private key will be ignored.
bad permissions: ignore key: /Users/me/.ssh/id_rsa
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

我知道我可以将 /Users/me/.ssh/id_rsa 的权限更改为 700 来解决这个问题，但我觉得这个问题与协作特别相关，我不是项目的所有者。我努力了 ：

```
 Heroku keys:add 
```

同样，这并没有解决问题。

有没有人成功地 git:clone 一个他/她是合作者的项目——而不是所有者？

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T23:11:33.330

此问题并非特定于 Github 或合作者。私钥必须是私有的。您的私钥具有允许所有者以外的人（*您*）查看您的私钥的权限。这使得密钥不再是私有的。

如果您运行以下命令：

`ls -All /Users/me/.ssh/id_rsa`

您将看到密钥对所有者以外的用户拥有`r`或权限。`rw`

您需要做的是更改这些权限，以便只有所有者拥有对密钥的权限，再次将其设为私有。[`chmod 700`](http://www.thinkplexx.com/learn/article/unix/command/chmod-permissions-flags-explained-600-0600-700-777-100-etc)您可以通过在文件上运行来做到这一点：

`chmod 700 /Users/me/.ssh/id_rsa`

现在您拥有了一个受保护的**私钥**，只有您，即所有者，才能读取、运行和执行。

# c++ - 防止 SDL 程序消耗额外资源

> ID：14666812
> 
> 赞同：6
> 
> 时间：2013-02-02T21:40:55.653
> 
> 标签：c++, sdl

我正在设计应该在图像上展示开放简历的程序。我注意到基本 SDL 应用程序的概念非常糟糕——它由循环和延迟组成。

```
while(true) {
    while(event_is_in_buffer(event)) {
        process_event(event);
    }
    do_some_other_stuff();
    do_some_delay(100);       //Program is stuck here, unable to respond to user input
} 
```

这使得程序即使在后台也可以执行和渲染（或者如果首先不需要重新渲染）。如果我使用更长的延迟，我会消耗更少的资源，但我必须等待更长的时间才能处理鼠标点击等事件。
我想要的是让程序等待事件，就像 WinApi 所做的那样或像套接字请求那样做。那可能吗？
我想要的概念：

```
bool go=true;
while(get_event(event)&&go) {  //Program gets stuck here if no events happen
    switch(event.type){
       case QUIT: go=false;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T21:48:04.890

您可以使用`SDL_WaitEvent(SDL_Event *event)`在 SDL 中等待事件。它将比您当前拥有的轮询循环设计使用更少的资源。请参阅此[文档](http://www.libsdl.org/intro.en/usingevents.html)中的示例：

```
{
    SDL_Event event;

    while ( SDL_WaitEvent(&event) ) {
        switch (event.type) {
                ...
                ...
        }
    }
} 
```

# php - CodeIgniter 错误为 foreach() 提供的参数无效

> ID：14666813
> 
> 赞同：1
> 
> 时间：2013-02-02T21:40:56.117
> 
> 标签：php, database, codeigniter

我正在尝试从数据库中选择数据，但出现此错误：

```
 A PHP Error was encountered        
    Severity: Warning
    Message: Invalid argument supplied for foreach()
    Filename: controllers/hello.php
    Line Number: 24 
```

**控制器：**

```
<?php
    // system/application/controllers/hello.php

    class Hello extends CI_Controller {

       public function __construct()
       {
            parent::__construct();
       }

       function show_data() {

            $query = $this->load->model('user');
            foreach ($query->result() as $value) {
                echo $value -> username;
                echo $value -> password;
                echo $value -> first_name;
                echo $value -> last_name;
            }
       }
    }
?> 
```

**模型：**

```
class User extends CI_Model {

    function __construct()
    {
        // Call the Model constructor
        parent::__construct();
    }

    function show()
    {
        $query = $this->db->get('user', 10);
        return $query->result();
    }
} 
```

我正在看这个教程：[https ://www.codeigniter.com/user_guide/database/results.html](https://www.codeigniter.com/user_guide/database/results.html)

错误是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:50:26.823

你的控制器功能应该是这样的，

```
function show_data() {
    $this->load->model('user');
    $query = $this->user->show();
    foreach($query as $value) {
        echo $value->username;
        echo $value->password;
        echo $value->first_name;
        echo $value->last_name;
    }
} 
```

[在此处](https://www.codeigniter.com/user_guide/general/models.html#loading-a-model)查看如何加载模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T21:46:34.777

你调用 $query->result() 两次，一次在模型中，一次在循环中，你应该只做一次。那只是一个错误。

另一个更重要的是您启动模型（并将其分配给变量，这不是必需的，并且是一种不好的做法），并且您不会从模型中调用该函数。

所以首先你必须在控制器中启动你的模型（如果你打算更频繁地使用这个模型，你的函数或构造）： $this->load->model('my_model');

然后你必须访问你想使用的函数： $this->my_model->my_model_function()

# mysql - 在 Windows 服务器上自动备份 MySQL 数据库

> ID：14666819
> 
> 赞同：37
> 
> 时间：2013-02-02T21:41:42.487
> 
> 标签：mysql, database, backup

有没有办法在一天中的特定时间为指定的服务器自动备份 MySQL 数据库或发送带有附件的电子邮件。你认为哪种方式是最好和最安全的？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-07-07T10:36:45.517

最好的方法是

```
mysqldump.exe --user=YourUserName --password=YourPassword --host=localhost --port=3306 --result-file="Path\dump.sql" --databases "DatabaseName1" "Database2"

mysqldump.exe --user=root --password=root  --host=localhost --port=3306 --result-file="c:\www\db\backup.%date:~10,4%%date:~7,2%%date:~4,2%.sql" --default-character-set=utf8 --single-transaction=TRUE --databases "dbtest1" "dbtest2" 
```

该模式每次运行时`backup.%date:~10,4%%date:~7,2%%date:~4,2%.sql`都会创建一个唯一的名称 ( )`backup20131010.sql`

现在你只需要在你的任务调度器中调用这个命令。就是这样。:)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-02T22:15:23.827

我会使用 Windows Task Scehduler/cron （取决于您的系统）和[mysqldump](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)。在链接中向下滚动，它包含一些如何实现您想要的见解。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-07T09:33:21.513

您可以将以下命令之一添加到`Windows task scheduler`：

```
mysqldump –-user [username] –-password=[password] [database name] > [dump file] 
```

或以紧凑的方式：

```
mysqldump –u[username] –p[password] [database name] > [dump file] 
```

或者：

```
mysqldump -u[user] -p[password] --result-file="c:\<path>\backup.%DATE:~0,3%.sql" [database] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-29T15:01:25.363

`databaseW.2016,06,29-22,31,48-15.sql`

```
@echo off
rem Backup Database (Daily,via Task Scheduler)
rem databaseW
set filename="c:\xampp\dbk\databaseW.%date:~6,4%,%date:~0,2%,%date:~3,2%-%time:~0,2%,%time:~3,2%,%time:~6,2%-%time:~9,2%.sql"
c:\xampp\mysql\bin\mysqldump.exe --user=root --password=dell@root --host=localhost --port=3306 --result-file=%filename% --default-character-set=utf8 --single-transaction=TRUE --databases "databaseW" 
```

要创建名称基于日期和时间的文件，请使用`%date%`和`%time%`。请注意，这 2 个变量基于语言环境和 cmd shell 版本

*   打开cmd窗口
*   输入`echo %time%`和`echo %date%` 我的是`22:11:16.80`，`06/29/2016 Wed`
*   substr 变量通过`%variable:~startpos,length%` 我想要用逗号分隔的时间，所以 cmd 去 `echo %time:~0,2%,%time:~3,2%,%time:~6,2%,%time:~9,2%`
*   得到一个文件名，如`databaseW.2016,06,29-22,31,48-15.sql` 使用`set filename="databaseW.%date:~6,4%,%date:~0,2%,%date:~3,2%-%time:~0,2%,%time:~3,2%,%time:~6,2%-%time:~9,2%.sql"`
*   提前检查`date`和`time`
*   使用`--result-file`选项而不是`>`; 根据Mysql Manuel，使用“>”保存的文件的字符集是`UTF-16`，而`--result-file`以下是`--default-character-set`
*   保存到文件`BackpDay-databaseW.cmd`
*   将其添加到新任务`Action`并设置触发器（Windows 任务计划程序）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-02T12:41:28.393

我做了这项工作，类似于其他人所解释的......**但几乎没有区别和额外的工作**：

1）我制作了一个批处理文件
2）通过 Windows 调度程序运行该批处理文件
3）为该任务制定了适当的计划
4）在批处理文件中执行这些步骤：

*   4-1) 根据当前日期准备文件名
*   4-2) 通过mysqldump.exe在对应目录&文件名中得到备份
*   4-3) 通过 7-Zip 应用程序制作一个压缩文件（安装它）然后删除未压缩的备份
*   4-4) 在我们的网络文件服务器上放一份副本

这是一个脚本（.bat）示例：

```
@echo off
set current=%date:~10,4%%date:~4,2%%date:~7,2%
set filename="E:\MySQL Backups\DBName-%current%.sql"
set filename2="E:\MySQL Backups\DBName-%current%.zip"
echo %filename%
cd "E:\MySQL Backups"
C:\"Program Files"\MySQL\"MySQL Server 5.5"\bin\mysqldump.exe db_name --user=root --password=rootpass --host="127.0.0.1" --port=instancePort --result-file=%filename% --default-character-set=utf8 --single-transaction=TRUE
echo backup-finished

if exist %filename% (
    "C:\Program Files\7-Zip\7z.exe" a %filename2% %filename%
    echo zip-finished
    del %filename%
)
if exist %filename2% (
    copy %filename2% "\\192.168.x.x\MySQL Backups"
    echo copy-finished
) 
```

# python - 一次加载关系树

> ID：14666821
> 
> 赞同：0
> 
> 时间：2013-02-02T21:41:50.487
> 
> 标签：python, django, django-queryset, django-orm

我有一个名为 Post 的模型：

```
class Post(models.Model):
    poster = models.ForeignKey(User)
    content = models.TextField(verbose_name='Text', max_length=1000)
    reply_to = models.ForeignKey('self', null=True, blank=True, default=None) 
```

这允许添加“第一篇文章”（带有空白的回复），并回复帖子甚至“回复回复”

例如，我的数据库中有这样的东西：

```
First Post
    Reply one
        Reply to reply one
    Reply two
        Reply to reply two 
```

如何加载回复树？

当我使用：

```
r = Post.objects.filter(reply_to=FirstPost) 
```

它当然会返回：

```
Reply one
Reply two 
```

是否可以一次加载所有相关帖子？我主要需要它来计算对第一篇文章的所有回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:08:27.640

您可以使用 MPTT ( [http://django-mptt.github.com/django-mptt/tutorial.html#the-problem](http://django-mptt.github.com/django-mptt/tutorial.html#the-problem) )。我以前没有使用过这个库，所以让我知道它是怎么回事。

# 模型.py

```
class Post(MPTTModel):
    poster = models.ForeignKey(User)
    content = models.TextField(verbose_name='Text', max_length=1000)
    parent = models.TreeForeignKey('self', null=True, blank=True, related_name='children')
    class MPTTMeta:
        order_insertion_by = ['poster'] 
```

# 视图.py

```
 ....
 r = FirstPost.get_children() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:49:02.920

不，我认为没有办法一次加载所有回复。

但是，您可以向帖子类型添加额外的元数据，以便能够运行有序样式的查询，其中计算回复的数量变成了一个简单的计算，其中已经为父节点加载了数据。

请参阅[这篇文章](http://www.sitepoint.com/hierarchical-data-database-2/)，了解如何做到这一点（它使用 MySQL SQL 方言和 PHP，但原则仍然适用）。

基本上，您向树中定义排序的节点添加`left`和`right`字段，让您轻松计算树中给定根元素*下方的项目数。*它就像数据库表中的二叉树。原理取自这本优秀的数据库设计书籍：[“Joe Celko's Trees and Hierarchies in SQL for Smarties”](https://rads.stackoverflow.com/amzn/click/com/1558609202)。

# c++ - boost::program_options 用于单字节变量

> ID：14666823
> 
> 赞同：6
> 
> 时间：2013-02-02T21:42:11.773
> 
> 标签：c++, boost, boost-program-options

*强调文本*如何使用 Boost 程序选项从命令行接受单字节变量？

结果的命令行参数`--id1=1 --id2=1`值为 id1=49（或 '1', 0x31）和 id2=1。

```
#include <stdint.h>
#include <iostream>
#include <boost/program_options.hpp>

using namespace std;

int main(int argc, char** argv)
{
    (void)argc;
    (void)argv;
    namespace po = boost::program_options;

    const int myargc = 3;
    const char* myargv[] = {"foo","--id1=1","--id2=2" };

    uint8_t  id1;
    uint16_t id2; // works as expected.

    po::variables_map vm;
    po::options_description cmd_options( "Command options" );
    cmd_options.add_options()
    ( "id1", po::value<uint8_t >( &id1 )->default_value( 0 ), "A 1-byte ID" )
    ( "id2", po::value<uint16_t>( &id2 )->default_value( 0 ), "A 2-byte ID" )
    ;

    po::store( po::parse_command_line( myargc, myargv, cmd_options ), vm );
    po::notify( vm );
    // Using command line parameters of --id1=1 --id2=1,    
    // at this point, id1=49 (or '1', 0x31) and id2=1.
    cout << "BPO parsing of " << myargv[1] << " and " << myargv[2] << endl;
    cout << "id1: " <<      id1 << endl;
    cout << "id1: " << (int)id1 << endl;
    cout << "id2: " <<      id2 << endl;

    id1 = boost::lexical_cast<uint8_t>("1");
    id2 = boost::lexical_cast<int>("2");

    cout << "Using boost::lexical_cast" << endl;
    cout << "id1: " <<      id1 << endl;
    cout << "id1: " << (int)id1 << endl;
    cout << "id2: " <<      id2 << endl;

} 
```

输出是：

```
BPO parsing of --id1=1 and --id2=2
id1: 1
id1: 49
id2: 2
Using boost::lexical_cast
id1: 1
id1: 49
id2: 2 
```

Boost 最终调用 boost::lexical_cast("1")' ，它转换为 char 而不是数值——“1”变成了 '1'，即 49。

有没有办法改变 boost::program_options::add_options() 初始化以将单字节值视为整数而不是字符串/字符？如果没有，我有哪些选项可以更改解析或映射？明显（但不利）的选项是：[1] 不要使用类似字符的值 [2] 手动解析（绕过 Boost）或 [3] 在 Boost 解析后执行二次转换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T20:02:45.747

`boost::program_options`您观察到的行为与or无关`boost::lexical_cast`，这只是`uint8_t`类型的流提取的工作原理。下面[证明](http://liveworkspace.org/code/4xjHC1%241)了

```
#include <iostream>
#include <sstream>

int
main()
{
   uint8_t id1;
   uint16_t id2;
   std::istringstream iss( "1 1" );
   iss >> id1 >> id2;
   std::cout << "id1 char:     " << id1 << std::endl;
   std::cout << "id1 uint8_t:  " << (uint8_t)id1 << std::endl;
   std::cout << "id1 int:      " << (int)id1 << std::endl;
   std::cout << "id2 uint16_t: " << (uint16_t)id2 << std::endl;
   std::cout << "id2 int:      " << (int)id2 << std::endl;
} 
```

产生：

```
id1 char:     1
id1 uint8_t:  1
id1 int:      49
id2 uint16_t: 1
id2 int:      1 
```

如果您想将程序选项限制为单个字节，我建议使用`boost::numeric_cast`

```
#include <stdint.h>
#include <iostream> 
#include <boost/bind.hpp>
#include <boost/numeric/conversion/cast.hpp>
#include <boost/program_options.hpp>

int
main(int argc, char** argv)
{
    (void)argc;
    (void)argv;
    namespace po = boost::program_options;

    const int myargc = 3;
    const char* myargv[] = {"foo","--id1=1","--id2=2" };

    unsigned  id1;
    uint16_t id2; // works as expected.

    po::options_description cmd_options( "Command options" );
    cmd_options.add_options()
        ( "id1", po::value<unsigned>( &id1 )->notifier([](unsigned value){ boost::numeric_cast<uint8_t>(value); } ), "A 1-byte ID" )
        ( "id2", po::value<uint16_t>( &id2 ), "A 2-byte ID" )
        ;

    po::variables_map vm;
    po::store( po::parse_command_line( myargc, myargv, cmd_options ), vm );
    po::notify( vm );
    std::cout << "id1: " << id1 << std::endl;
    std::cout << "id2: " << id2 << std::endl;
} 
```

这是一个[示例会话](http://liveworkspace.org/code/2TFkeT%240)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T05:27:43.713

创建一个字节大小的数字字节类，但像数值一样流式传输，而不是像 char 一样流式传输。

```
#include <stdint.h>
#include <iostream>
#include <boost/program_options.hpp>

using namespace std;

struct NumByte
{
    uint8_t value;

    NumByte() : value() {}
    NumByte( const uint8_t &arg ) : value(arg) {}
    NumByte( const NumByte &arg ) : value(arg.value) {}

    operator uint8_t() const { return value; }

    friend istream& operator>>(istream& in, NumByte& valArg)
    {
        int i;
        in >> i;
        valArg.value = static_cast<uint8_t>(i);
        return in;
    }

    friend ostream& operator<<(ostream& out, NumByte& valArg)
    {
        out << static_cast<int>(valArg.value);
        return out;
    }
};

int main(int argc, char** argv)
{
    (void)argc;
    (void)argv;
    namespace po = boost::program_options;

    const int myargc = 3;
    const char* myargv[] = {"foo","--id1=1","--id2=2" };

    NumByte  id1;
    uint16_t id2; 

    po::variables_map vm;
    po::options_description cmd_options( "Command options" );
    cmd_options.add_options()
      ( "id1", po::value<NumByte >( &id1 )->default_value( 0 ), "A 1-byte ID" )
      ( "id2", po::value<uint16_t>( &id2 )->default_value( 0 ), "A 2-byte ID" )
      ;

    po::store( po::parse_command_line( myargc, myargv, cmd_options ), vm );
    po::notify( vm );

    assert( sizeof(NumByte)==1 ); // insure the size of a numeric byte is the size of a byte.

    cout << "BPO parsing of " << myargv[1] << " and " << myargv[2] << endl;
    cout << "id1: " <<      id1 << endl;
    cout << "id1: " << (int)id1 << endl;
    cout << "id2: " <<      id2 << endl;

    id1 = boost::lexical_cast<NumByte>("1");
    id2 = boost::lexical_cast<int>("2");

    cout << "Using boost::lexical_cast" << endl;
    cout << "id1: " <<      id1 << endl;
    cout << "id1: " << (int)id1 << endl;
    cout << "id2: " <<      id2 << endl;

} 
```

输出是：

```
BPO parsing of --id1=1 and --id2=2
id1: 1
id1: 1
id2: 2
Using boost::lexical_cast
id1: 1
id1: 1
id2: 2 
```

# macos - 将 2 个声卡合并为一个虚拟驱动程序

> ID：14666827
> 
> 赞同：1
> 
> 时间：2013-02-02T21:42:32.280
> 
> 标签：macos, audio, usb, driver, virtual

目前我正在使用 Macbook Pro 和 Macosx 10.8.2 3 天前，我意识到控制器没有任何内置声卡后不久就买了一个 DJ 控制器。我通过 USB 端口将该设备连接到 macbook。一切都很好，我可以使用 macbook 内置声卡和 5+1 音响系统进行混音。但问题是，大多数 djs 都会提示，这意味着他们的耳机需要另一个声音输出，以便在声音之间进行平滑过渡。所以我买了一个便宜的usb声卡。我把耳机插到那个上。

混音软件太笨了，它没有任何能力同时管理两个声卡。

所以我发现如果我编写一个具有两个虚拟立体声输出的虚拟声卡驱动程序，我可以将内置的 macos 声卡和 USB 声卡合并到该虚拟驱动程序中。

到目前为止我做了什么：

开始阅读 I/O Kit 框架。

我打算做什么：

实际上我不太明白要继承哪个 I/O Kit 系列我可能会先尝试对驱动程序实现 PCI 系列或 USB 系列继承另一件事是，到目前为止我所了解的，在我的虚拟驱动程序中，我必须清除设备 ID 和设备总线地址，以便将内置卡转发到虚拟输出 1，将 USB 声卡转发到虚拟输出 2

任何帮助将不胜感激，只要给我看灯，我可以自己开车。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:56:56.953

您根本不需要编写驱动程序或进行任何编程。只需使用音频 MIDI 设置实用程序创建一个聚合设备。

[http://support.apple.com/kb/HT3956](http://support.apple.com/kb/HT3956)

# javascript - jVectorMap：如何向所选区域添加类？

> ID：14666830
> 
> 赞同：0
> 
> 时间：2013-02-02T21:42:51.810
> 
> 标签：javascript, jvectormap

我有以下代码：

```
onRegionClick: function (event, code) {
    // search for the state based on the code of the region clicked.
    for (var r = 0; r < mapData.stateList.length; r++) {
        if (mapData.stateList[r].state == code) {
            if (mapData.stateList[r].markets.length == 1) {
                // state only has one region - navigate to it.
                window.location = mapData.stateList[r].markets[0].url;
                break;
            } else {
                // state has multiple regions - zoom into it on the map and show the markets.
                $("#map-reset").show();
                $('.map-label').text('Click a city below to view communities in that area.');
                $('body').addClass('map-zoomed');
                showState(code);
                break;
            }
        }
    }
} 
```

如何向所选区域添加课程？根据通过 Google 和 Stack Overflow 发现的类似问题，我尝试了几条路线，但均无济于事。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:04:40.133

检查我的修复方法：

[http://pastebin.com/s5GwcEMy](http://pastebin.com/s5GwcEMy)

我添加了这个方法“setSelectedRegionStyle”

您需要参考地图：

```
map = $("#world-map-gdp").vectorMap('get', 'mapObject'); 
```

设置自定义颜色后：

```
map.setSelectedRegionStyle('IT', '#b2c9cb'); 
```

在我的情况下只需要更改颜色，但您可以使用萤火虫检查其他选项。

这是添加的方法（在过去的bin中检查）

```
setSelectedRegionStyle : function (r,c) {
return this.regions[r].element.style.selected.fill = c;
}, 
```

# asp.net - 尝试查找我的数据库时出现 Visual Studio 错误

> ID：14666831
> 
> 赞同：0
> 
> 时间：2013-02-02T21:42:51.880
> 
> 标签：asp.net, sql-server, visual-studio-2008, web-applications

我是一名学习 asp.net 的学生，在尝试重新配置我创建的数据源时遇到了问题。当我运行我的 Web 应用程序时，我可以编辑/添加/删除数据库中的条目，但是当我尝试创建或重新配置数据源时，它会给我以下消息：

> 无法为此连接检索数据库架构。请确保连接设置正确且数据库在线。
> 
> 无法加载文件或程序集“Microsoft.SqlServer.Management.Sdk.Sfc，Version=10.0.0.0，Culture=neutral，PublicKey Token=89845dcd8080cc91”或其依赖项之一。该系统找不到指定的文件。

现在，我从未更改过计算机上数据库的位置，也从未将其从原始文件夹中删除。我进入我的“服务器资源管理器”选项卡，它显示数据库已连接。我在数据连接列表中右键单击我的数据库并转到“修改连接...”并运行“测试连接”选项，它显示“测试连接成功”。如果我的应用程序可以编辑数据库，为什么 Microsoft Visual Studio 找不到让我编辑数据源的连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:00:18.037

由于错误表明问题是系统无法找到正确的程序集 ( `SQL Server SDK`)。

我怀疑您的安装`SQL Server`不完整或不成功，或者您应该下载一些组件以提供成功的连接。

您会考虑[在此处](http://blogs.cametoofar.com/post/cannot-load-file-or-assembly-microsoftsqlservermanagementsdksfc.aspx)或[此处下载的组件的有用链接](http://social.msdn.microsoft.com/Forums/en/vssetup/thread/5abfbb57-dac9-4039-b121-ae21c9b9352c)

# list - 使用列表递归 - Haskell

> ID：14666835
> 
> 赞同：5
> 
> 时间：2013-02-02T21:43:06.897
> 
> 标签：list, haskell, recursion

我正在尝试编写一个递归函数，它将一个包含整数列表的列表作为输入并返回一个类型为 ([Int],Int) 的元组。（[整数]，整数）

这是为您提供棋盘的“棋盘游戏”：

```
 [[5,4,3,8,6],
  [0,2,1,0,7],
  [0,1,9,4,3],
  [2,3,4,0,9]] 
```

这将是一个有 4 行 5 列的板。列表中的数字是“硬币值”。这个棋盘游戏的目标是从列表的顶部到底部收集硬币。您可以从顶行的任何位置开始向下移动，您可以直接向下，或斜向左或向右。你会想要一条能给你最大总硬币值的路径。

我创建了第一个函数，您可以在其中输入路径列表 [([Int],Int)] 并返回具有最大硬币值的路径 ([Int],Int)。

现在我需要创建一个函数来实际生成我将输入到第一个函数中的路径列表。

我知道我将不得不使用递归。我将输入棋盘（如上图）和起始栏。我将不得不获取列号，然后创建所有可能路径的列表。如果我从列号开始，我下一个可能的步骤是位置（在下一行）- 相同的列号，列 num -1 和列 num +1。我需要递归调用它，直到我到达底部。

我如何能够存储这些路径步骤，然后存储所有可能路径的最终列表？

([Int],Int) - [Int] 是列表/列号或行中的位置，Int 是硬币值。

我是 haskell 的新手，虽然我明白我必须做什么，但编写代码真的很困难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T01:17:07.937

您不会在惯用的功能代码中的某些变量中“存储”中间值。相反，您将它们保留为累积参数，您可以使用诸如 foldr 之类的函数传递该参数。

[http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:foldr](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:foldr)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T03:21:24.243

我想我现在可以（轻松地）将我对[另一个问题](https://stackoverflow.com/questions/14711328/improvement-of-the-greedy-algorithm/14721446#14721446)的回答调整为这个问题。我列出了允许的索引组合并将板映射到它们。（pat 的[评论](https://stackoverflow.com/questions/14711328/improvement-of-the-greedy-algorithm/14721446#14721446)帮助我改进 index_combinations）

*Main> :load "new1.hs"
[1 of 1] 编译 Main（new1.hs，解释）
好的，加载的模块：Main。
*Main> 结果
([8,7,4,9],28)
*Main> 路径
[3,4,3,4]

```
import Data.List
import Data.Ord
import Data.Maybe

r = [[5,4,3,8,6],
     [0,2,1,0,7],
     [0,1,9,4,3],
     [2,3,4,0,9]]

r1 = r !! 0
r2 = r !! 1
r3 = r !! 2
r4 = r !! 3

index_combinations = 
  [[a,b,c,d] | a <- [0..4], b <- [max 0 (a-1)..min 4 (a+1)], 
   c <- [max 0 (b-1)..min 4 (b+1)], d <- [max 0 (c-1)..min 4 (c+1)]]  

mapR xs = [r1 !! (xs !! 0), r2 !! (xs !! 1), 
           r3 !! (xs !! 2), r4 !! (xs !! 3)]

r_combinations = map mapR index_combinations
r_combinations_summed = zip r_combinations $ map (foldr (+) 0) r_combinations

result = maximumBy (comparing snd) r_combinations_summed
path = index_combinations !! fromJust (elemIndex result r_combinations_summed) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T10:37:02.893

如果您有兴趣在此处使用我的包[网格](http://hackage.haskell.org/package/grid-2.1.1 "网格") [（用户指南）](https://github.com/mhwombat/grid/wiki "用户指南") 作为示例来帮助您入门。（如果您不想使用它，您可能会发现一些源代码很有帮助。）

创建一个 4 行 5 列的网格。

```
λ> :m + Math.Geometry.Grid
λ> let g = rectSquareGrid 4 5
λ> indices g
[(0,0),(0,1),(0,2),(0,3),(1,0),(1,1),(1,2),(1,3),(2,0),(2,1),(2,2),(2,3),(3,0),(3,1),(3,2),(3,3),(4,0),(4,1),(4,2),(4,3)] 
```

我们希望能够将“硬币值”映射到网格位置，因此我们将创建一个 GridMap。

```
λ> :m + Math.Geometry.GridMap
λ> let m = lazyGridMap g [5,4,3,8,6,0,2,1,0,7,0,1,9,4,3,2,3,4,0,9]
λ> m
lazyGridMap (rectSquareGrid 4 5) [5,4,3,8,6,0,2,1,0,7,0,1,9,4,3,2,3,4,0,9]
λ> toList m
[((0,0),5),((0,1),4),((0,2),3),((0,3),8),((1,0),6),((1,1),0),((1,2),2),((1,3),1),((2,0),0),((2,1),7),((2,2),0),((2,3),1),((3,0),9),((3,1),4),((3,2),3),((3,3),2),((4,0),3),((4,1),4),((4,2),0),((4,3),9)] 
```

我们可以找出网格中任何单元格的邻居，但是对于您的应用程序，我们遇到了一点问题：我的 RectSquareGrid 类型不允许对角线移动。

```
λ> neighbours (1,2) m
[(0,2),(1,3),(2,2),(1,1)] 
```

现在，我很乐意创建一种`Grid`可以满足您需求的新型。或者，您可以编写自己的函数，其中包括对角线邻居：

```
λ> let neighbours2 (x, y) g = filter (`inGrid` g) [(x-1,y-1), (x-1,y), (x-1,y+1), (x,y-1), (x,y+1), (x+1,y-1), (x+1,y), (x+1,y+1)]
λ> neighbours2 (1,2) m
[(0,1),(0,2),(0,3),(1,1),(1,3),(2,1),(2,2),(2,3)] 
```

但是您只对允许向下移动感兴趣，无论是直线向下还是对角线，所以这里有一个更有用的函数：

```
λ> let allowedMoves (x, y) g = filter (`inGrid` g) [(x+1,y-1), (x+1,y), (x+1,y+1)]
λ> allowedMoves (1,2) m
[(2,1),(2,2),(2,3)] 
```

所以现在我们可以编写一个函数，为您提供从给定索引到网格底行的所有可能路径。

```
allPathsFrom a g | fst a == fst (size g) = [[a]]
                 | otherwise             = Prelude.map (a:) xs
  where xs = concatMap (\x -> allPathsFrom x g) ys
        ys = allowedMoves a g 
```

例如：

```
λ> allPathsFrom (0,1) m
[[(0,1),(1,0),(2,0),(3,0),(4,0)],[(0,1),(1,0),(2,0),(3,0),(4,1)],[(0,1),(1,0),(2,0),(3,1),(4,0)],[(0,1),(1,0),(2,0),(3,1),(4,1)],[(0,1),(1,0),(2,0),(3,1),(4,2)],[(0,1),(1,0),(2,1),(3,0),(4,0)],[(0,1),(1,0),(2,1),(3,0),(4,1)],[(0,1),(1,0),(2,1),(3,1),(4,0)],[(0,1),(1,0),(2,1),(3,1),(4,1)],[(0,1),(1,0),(2,1),(3,1),(4,2)],[(0,1),(1,0),(2,1),(3,2),(4,1)],[(0,1),(1,0),(2,1),(3,2),(4,2)],[(0,1),(1,0),(2,1),(3,2),(4,3)],[(0,1),(1,1),(2,0),(3,0),(4,0)],[(0,1),(1,1),(2,0),(3,0),(4,1)],[(0,1),(1,1),(2,0),(3,1),(4,0)],[(0,1),(1,1),(2,0),(3,1),(4,1)],[(0,1),(1,1),(2,0),(3,1),(4,2)],[(0,1),(1,1),(2,1),(3,0),(4,0)],[(0,1),(1,1),(2,1),(3,0),(4,1)],[(0,1),(1,1),(2,1),(3,1),(4,0)],[(0,1),(1,1),(2,1),(3,1),(4,1)],[(0,1),(1,1),(2,1),(3,1),(4,2)],[(0,1),(1,1),(2,1),(3,2),(4,1)],[(0,1),(1,1),(2,1),(3,2),(4,2)],[(0,1),(1,1),(2,1),(3,2),(4,3)],[(0,1),(1,1),(2,2),(3,1),(4,0)],[(0,1),(1,1),(2,2),(3,1),(4,1)],[(0,1),(1,1),(2,2),(3,1),(4,2)],[(0,1),(1,1),(2,2),(3,2),(4,1)],[(0,1),(1,1),(2,2),(3,2),(4,2)],[(0,1),(1,1),(2,2),(3,2),(4,3)],[(0,1),(1,1),(2,2),(3,3),(4,2)],[(0,1),(1,1),(2,2),(3,3),(4,3)],[(0,1),(1,2),(2,1),(3,0),(4,0)],[(0,1),(1,2),(2,1),(3,0),(4,1)],[(0,1),(1,2),(2,1),(3,1),(4,0)],[(0,1),(1,2),(2,1),(3,1),(4,1)],[(0,1),(1,2),(2,1),(3,1),(4,2)],[(0,1),(1,2),(2,1),(3,2),(4,1)],[(0,1),(1,2),(2,1),(3,2),(4,2)],[(0,1),(1,2),(2,1),(3,2),(4,3)],[(0,1),(1,2),(2,2),(3,1),(4,0)],[(0,1),(1,2),(2,2),(3,1),(4,1)],[(0,1),(1,2),(2,2),(3,1),(4,2)],[(0,1),(1,2),(2,2),(3,2),(4,1)],[(0,1),(1,2),(2,2),(3,2),(4,2)],[(0,1),(1,2),(2,2),(3,2),(4,3)],[(0,1),(1,2),(2,2),(3,3),(4,2)],[(0,1),(1,2),(2,2),(3,3),(4,3)],[(0,1),(1,2),(2,3),(3,2),(4,1)],[(0,1),(1,2),(2,3),(3,2),(4,2)],[(0,1),(1,2),(2,3),(3,2),(4,3)],[(0,1),(1,2),(2,3),(3,3),(4,2)],[(0,1),(1,2),(2,3),(3,3),(4,3)]] 
```

请注意，由于`GridMap`s 也是s，我们可以在or`Grid`上调用上述所有函数。`m``g`

```
λ> allPathsFrom (0,1) m 
```

`grid` 如果您希望我添加一个允许对角线移动到我的包裹的网格，请告诉我（amy at nualeargais dot ie） 。

# visual-studio-2012 - Visual Studio 2012 程序语言

> ID：14666837
> 
> 赞同：1
> 
> 时间：2013-02-02T21:43:26.217
> 
> 标签：visual-studio-2012

当我安装 Visual Studio 2012 Ultimate Edition 时，我没有看到有人问我更喜欢安装哪些编程语言。它会自动安装所有语言（C#、C++ ...）。这是正常的还是我错过了选择我想要的语言的窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:03:33.043

这个是正常的。Visual Studio 2012 默认安装所有功能。

# c# - 从 db 获取链接模型值的更好方法是什么

> ID：14666840
> 
> 赞同：0
> 
> 时间：2013-02-02T21:43:30.533
> 
> 标签：c#, asp.net-mvc, linq, asp.net-mvc-4, ef-code-first

首先，我对 ASP.NET MVC C# 和 EF 非常陌生。我正在创建一个网站，希望能帮助我学习这三种奇妙的技术。话虽如此，我的项目中有以下模型。

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public string FirstName { get; set; }
    public string Lastname { get; set; }
    public string EmailAddress { get; set; }
    //public string PhoneNumber { get; set; }
    public bool? ChangePassword { get; set; }
    public bool? Deletable { get; set; }

    //Add more Properties for more fields

    public virtual ICollection<CompanyInformation> ParentCompanies { get; set; }
    public virtual StaffProfile sProfile { get; set; }
} 
```

和

```
public class StaffProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int StaffProfileId { get; set; }
    public string Alias { get; set; }
    public StaffGrouping Group { get; set; }
    public ICollection<PhoneNumber> PhoneNumbers { get; set; }
    public bool isPhoneNumberDisplayed { get; set; }
    public bool TextNotificationsAllowed { get; set; }
    public bool EmailNotificationsAllowed { get; set; }
    public bool PhoneNotificationsAllowed { get; set; }
} 
```

员工分组

```
public class StaffGrouping
{
    public int id { get; set; }
    public string GroupName { get; set; }
} 
```

为了完整起见，电话号码模型

```
public class PhoneNumber
{
    public int id { get; set; }
    public string Number { get; set; }
    public string Extension { get; set; }
    public PhoneType Type { get; set; }
    public bool isPrimary { get; set; }
    public bool isInActive { get; set; }
}

public enum PhoneType { 
    Home,
    Mobile,
    Work,
    Other
    } 
```

我正在尝试从数据库中获取所有员工（包括他们链接到的电话号码、用户资料和组）并将其添加到视图模型中，以便更好地与我的视图集成。目前我正在这样做：

公共 ActionResult ManageStaff() { 使用 (var repo = new CompanyInformationRepository(new UniteOfWorkCompanies())) { var company = repo.FindCompany(User.Identity.Name);

```
 var Users = repo.CompanyStafflookup(company);

            var model = new List<StaffManagementViewModel>();

            foreach (var user in Users)
            {
                var group = repo.StaffGroupLookup(user.sProfile);

                //var phoneNumber = user.sProfile.PhoneNumbers.Where(p => p.isPrimary == true).FirstOrDefault();

                model.Add(new StaffManagementViewModel
                {
                    FirstName = user.FirstName,
                    LastName = user.Lastname,
                    EmailAddress = user.EmailAddress,
                    PhoneNumber = "(915) 433 - 1739", //phoneNumber.Number,
                    Group = group.GroupName,
                    UserID = user.UserId
                });
            }
            return View(model);
        } 
```

还有我的存储库：

```
 public IQueryable<HoursOfOperation> CompanyHoursLookup(string userName)
    {
        var company = FindCompany(userName).id;

        //var model = _db.HoursOfOperations.Where(e => e.Company.id == company);

        var model = from h in _db.HoursOfOperations
                    where h.Company.id == company
                    orderby h.Day ascending, h.From ascending
                    select h;

        return model;
    }

    public IQueryable<UserProfile> CompanyStafflookup(CompanyInformation company)
    {

        var model = from s in _db.UserProfiles.Include("sProfile")
                    where s.ParentCompanies.Any(e => e.companyName == company.companyName)
                    orderby s.FirstName ascending
                    select s;

        return model;
    }

    public StaffGrouping StaffGroupLookup(StaffProfile Staff)
    {
        var Staffwithgroup = _db.StaffProfiles.Where(e => e.StaffProfileId == Staff.StaffProfileId).Include("Group").FirstOrDefault();

        return Staffwithgroup.Group;
    } 
```

我猜应该有更好更有效的方法来做到这一点，因为我正在计算至少三次访问数据库。我尝试在 the`.include`上使用`userprofile`but 因为我没有指向该组的导航属性，所以它给了我一个错误。我正在谈论的代码如下：

```
 var model = from s in _db.UserProfiles.Include("sProfile").Include("PhoneNumbers").Include("Group")
                    where s.ParentCompanies.Any(e => e.companyName == company.companyName)
                    orderby s.FirstName ascending
                    select s; 
```

有没有一种方法可以在一次调用中实现这一点，基本上会返回一个列表，`UserProfiles`其中`StaffProfile`包括`PhoneNumbers`，最后是`Group`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T00:03:25.460

您可以简单地为包含添加完整路径的前缀，即使用：

```
Include("sProfile.Group") 
```

这将包括 StaffProfile 和它的组。

# matrix - 使用滚动/俯仰/偏航旋转矩阵

> ID：14666843
> 
> 赞同：0
> 
> 时间：2013-02-02T21:43:42.217
> 
> 标签：matrix, opengl-es-2.0, transformation, glkit

我想将一些真实世界的转换（从加速度计/陀螺仪/指南针）应用到我的模型视图矩阵。这边走：

```
modelViewMatrix = GLKMatrix4MakeLookAt(cam.x, cam.y, cam.z,
                                       0.f, 0.f, 0.f,
                                       0.f, 1.f, 0.f);

GLKVector3 v = GLKVector3Normalize(x, y, z);    // accelerometer + gyro

float roll = asinf(-v.x);
float pitch = atan2f(v.y, -v.z);
float yaw = GLKMathDegreesToRadians(heading);   // compass

GLKMatrix4 m = GLKMatrix4Identity;
m = GLKMatrix4RotateX(m, pitch);
m = GLKMatrix4RotateY(m, roll);
m = GLKMatrix4RotateZ(m, yaw);

modelViewMatrix = GLKMatrix4Multiply(m, m_modelViewMatrix); 
```

有用。但有一个问题。当手机处于“相机”（横向）方向时，“滑动解锁”正好是垂直的，**y**和**z**都非常接近于零，经常改变它们的符号。因此， atan2() 返回一些“随机”值，并且场景在水平面中移动......

`x`必须有一种方法可以通过从、`y`、和中创建单个矩阵来简化转换`z`，并且`heading`不会丢失准确性...

UPD：**[发现问题！](http://en.wikipedia.org/wiki/Gimbal_lock#Loss_of_a_degree_of_freedom_with_Euler_angles)**谁能解释如何将解决方案应用于我的矩阵？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T07:22:17.617

这应该阐明您需要做什么：[http](http://tutorialrandom.blogspot.com/2012/08/how-to-rotate-in-3d-using-opengl-proper.html) ://tutorialrandom.blogspot.com/2012/08/how-to-rotate-in-3d-using-opengl-proper.html这将解决您的万向节锁定问题。

至于垂直握住手机时的随机值，我不确定。可能会转换方向向量，使其值始终为正值或其他东西。

# wso2 - 在 WSO2 身份服务器中更改 SAML SSO 的加载消息

> ID：14666845
> 
> 赞同：0
> 
> 时间：2013-02-02T21:43:54.457
> 
> 标签：wso2, wso2is

我正在使用 WSO2 Identity Server 4.0.0 SAML SSO 功能，并希望将“正在加载 WSO2 Stratoslive ...”消息更改为其他内容（在我的情况下将其翻译为其他语言）。此消息位于何处，我该如何更改？

我已经尝试替换 org.wso2.carbon.sso.redirector.ui_2.0.1.jar 中的“redirect_ajaxprocessor.jsp”和 org.wso2.stratos.identity.saml2.sso 中的“redirect_ajaxprocessor.jsp”中的消息。 mgt.ui_2.0.1.jar 但没有效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:30:48.807

没有。您不必更改 sso-mgt，只需 sso.redirector.ui_2.0.1.jar 和“redirect_ajaxprocessor.jsp”就足够了

# jquery - jQuery 表单验证 - 错误标签的 CSS

> ID：14666852
> 
> 赞同：6
> 
> 时间：2013-02-02T21:45:04.277
> 
> 标签：jquery, css, jquery-validate

我正在使用与 jquery 网站上完全相同的示例进行简单的表单验证； [http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

不过有一点我不明白，示例中的错误消息显示在每个输入字段的右侧。我想在每个输入字段下显示错误。这是如何运作的？我尝试使用宽度和填充，但到目前为止没有运气。

我使用的 CSS 代码略有改动，但仍然非常简单；

```
label { width: 10em; float: left; }
label.error { float: none; color: red; padding-left: 0px; vertical-align: bottom; }
p { clear: both; }
fieldset {position: absolute; left: 450px; width: 400px; } 
em { font-weight: bold; padding-right: 1em; vertical-align: top; } 
```

这是 jfiddle [http://jsfiddle.net/nBv7v/](http://jsfiddle.net/nBv7v/)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-02T22:00:37.087

> 引用 OP：“示例中的错误消息显示在每个输入字段的右侧。我想在每个输入字段下显示错误。这是如何工作的？”

您可以使用[选项](http://docs.jquery.com/Plugins/Validation/validate#toptions)简单地将默认元素从 更改`label`为。由于是“块级”，它将自动换行。`div`[`errorElement`](http://docs.jquery.com/Plugins/Validation/validate#toptions)`div`

```
$(document).ready(function() {

    $('#myform').validate({ // initialize the plugin
        errorElement: 'div',
        // your other rules and options
    });

}); 
```

**工作演示：http:** [//jsfiddle.net/xvAPY/](http://jsfiddle.net/xvAPY/)

你甚至不必弄乱 CSS。但是，如果您需要更改任何内容，请使用`div.error`.

```
div.error {
    /* your rules */
} 
```

* * *

[有关更多验证插件选项，](http://docs.jquery.com/Plugins/Validation/validate#toptions)请参阅文档。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-02T21:55:30.987

`label`元素是一个而[`inline element`](http://webdesign.about.com/od/htmltags/qt/block_vs_inline_elements.htm)不是一个`block-level`元素。换句话说，默认情况下`label`元素不会开始新行。

为此，您可以像这样覆盖其默认样式：

```
label.error {
    display:block;
    width:100%;
    ...
} 
```

看自己的[**JsFiddle 演示**](http://jsfiddle.net/nBv7v/2/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T22:00:18.440

您必须设置`display: block`on `label.error`，这样，它将显示在下一行。现在你唯一需要做的就是添加更多的填充`label.error`，或者使用表格或其他东西来对齐文本框下的错误。

在您发布的 jsFiddle 中，以下修改会将错误消息放在文本框下：

```
label.error { display: block; float: none; color: red; padding-left: 11.5em; vertical-align: top; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-10T13:22:12.183

就像使用这个类和这个 css 一样简单。

```
.has-error input{
  background: rgba(166, 66, 66, 0.69);
} 
```

# arrays - 为什么在我用 Excel 中的数据填充数组后，VB.NET 会在我的数组中显示 (0,0) 元素？

> ID：14666854
> 
> 赞同：1
> 
> 时间：2013-02-02T21:45:12.303
> 
> 标签：arrays, vb.net, multidimensional-array

以下代码将生成一个 x(,) 矩阵，其中包含从 Excel 传输的数组元素，当使用 QuickWatch 查看时，将指示从零开始的数组。但是，该数组将从 1 开始，并且 QuickWatch 中显示的 (0,0) 元素将不可访问。

我认为这种行为是一个错误，因为 QuickWatch 显示存在 (0,0) 元素，但实际上并不存在 - 因为它不可访问。

以下代码将生成有问题的 x(,) 数组，当使用 QuickWatch 查看时将显示 (0,0) 元素。

要实现代码，请将 OperFileDialog1 添加到您的表单中，然后将以下代码粘贴到例如按钮中。您需要确保打开的 Excel 中有有效的字符串或数值单元格 A1、A2、B1、B2。在运行时，由于某种原因，元素 x(0,0) 是不可读的，即使使用 QuickWatch 查看时 x(0,0) 元素中会显示数据：

```
Dim i, j As Integer
Dim filename As String
Dim x(,) As Object
Dim myx(,) As Object
With OpenFileDialog1
    .FileName = "*.*"
    .CheckFileExists = True
    .ShowReadOnly = True
    .Filter = "Excel 2010 *.xlxs|*.xlxs|Excel 2003-2007 *.xls|*.xls"
    If .ShowDialog = Windows.Forms.DialogResult.OK Then
        'Load file
        filename = .FileName
    End If
End With

' Create new Application.
Dim rXL As New Excel.Application
Dim rWB As Excel.Workbook
Dim rSheet As Excel.Worksheet
Dim rRng As Excel.Range
rWB = rXL.Workbooks.Open(filename)

For i = 1 To 1 '  rWB.Sheets.Count To 1 Step -1
    Dim sheet As Excel.Worksheet = rWB.Sheets(i)
    Dim r As Excel.Range = sheet.UsedRange
    If r.Rows.Count = 0 Then Exit For
    Dim eCellArray As System.Array = r.Value
    ReDim x(r.Rows.Count, r.Columns.Count)
    x = r.Value
    rRng = Nothing
Next
ReDim myx(x.GetLength(0) + 1, x.GetLength(1) + 1)
For i = 0 To x.GetLength(0)
    For j = 0 To x.GetLength(1)
        myx(i + 1, j + 1) = x(i, j)
    Next
Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T00:34:34.600

这适用于 vb.net 2008：

```
Dim x(100, 100) As Object
x(0, 0) = "asdf"
MsgBox(x(0, 0)) 
```

您可能将字符串分配给错误的数组元素，或者您可能分配了正确的数组元素而不是单个字符串，例如字符串数组。

# matlab - 将 Matlab 结构打印到文本文件

> ID：14666862
> 
> 赞同：2
> 
> 时间：2013-02-02T21:46:40.003
> 
> 标签：matlab

我有一个 Matlab 程序，它生成一组非常大的结构作为其输出。
这些结构足够大，我希望能够将文本表示形式打印到文本文件中以供以后研究。

即，命令：

> 富（1）

将第一个结构体发送到屏幕，但结构体太大而无法放入滚动窗口，而且滚动窗口对于查看如此大的文本块来说是一个糟糕的工具，无论如何。我希望能够将该命令的输出直接通过管道传输到文本文件。

不幸的是，没有为结构中的某些元素定义 fprintf，因此 fprintf 失败。同样，我相信作为 Psychtoolbox 库一部分的 WriteStructsToText.m 脚本也会失败。

有什么方法可以强制 Matlab 将屏幕上显示的内容直接转储到文本文件中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T22:02:39.377

该[`diary`](http://www.mathworks.com/help/matlab/ref/diary.html)功能是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:59:20.703

没有用于将结构保存在文件中的默认 Matlab 函数（至少我不知道）。*但是文件交换*有[`struct2File`](http://www.mathworks.com/matlabcentral/fileexchange/35421-struct2file)功能。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T22:09:15.077

您可以考虑使用[struct2dataset](http://www.mathworks.com/help/stats/struct2dataset.html)命令很好地格式化您的结果，然后再将其输出到屏幕上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-09T13:55:44.910

老问题，但 IMO，最简单的解决方案是使用[`evalc`function](https://uk.mathworks.com/help/matlab/ref/evalc.html)。请参阅下面的控制台会话，尝试直接使用打印结构时失败，尝试`fprintf`使用输出时也会失败`disp`，但使用时成功`evalc`：

```
>> a = [1 2 3; 4 5 6]

a =

     1     2     3
     4     5     6

>> disp(whos('a'))
          name: 'a'
          size: [2 3]
         bytes: 48
         class: 'double'
        global: 0
        sparse: 0
       complex: 0
       nesting: [1×1 struct]
    persistent: 0

>> fprintf('%s\n', whos('a'))
Error using fprintf
Function is not defined for 'struct' inputs.

>> fprintf('%s\n', disp(whos('a')))
Error using disp
Too many output arguments.

>> fprintf('%s\n', evalc('disp(whos(''a''))'))
          name: 'a'
          size: [2 3]
         bytes: 48
         class: 'double'
        global: 0
        sparse: 0
       complex: 0
       nesting: [1×1 struct]
    persistent: 0

>> 
```

`evalc`在R2006a之前被引入Matlab，所以你应该没有兼容性问题。

只要确保您只使用该`evalc`功能，如果您可以信任将用作输入的任何内容；EG 如果您允许`evalc`从用户输入生成输入，则用户可能会输入恶意代码，EG 可能会运行系统命令，从而危及您 PC 上的文件等。但如果您`evalc`在硬编码字符串上使用，则示例中为 EG上面`evalc('disp(whos(''a''))')`，那你应该没问题。*

# php - 图像调整大小出错

> ID：14666865
> 
> 赞同：0
> 
> 时间：2013-02-02T21:46:58.960
> 
> 标签：php, image-resizing

我正在尝试使用 WideImage 库调整上传图像的大小。

我需要将其转换为可能的最高分辨率。输出大小应为 Width:460px Height:345px

这是我调整大小的来源：

```
list($w, $h) = getimagesize($_FILES['image']['tmp_name']);
$wpercent = ($w/460)*100;
$hpercent = ($h/345)*100;
if ($wpercent >= 100 && $hpercent >= 100) {
    // Both is over 100% of the allowed size, then resize so the smaller side match.
    if ($wpercent > $hpercent) {
        // height is smallest
        $remove_percent = $hpercent - 100;
    }else{
        // width is smallest
        $remove_percent = $wpercent - 100;
    }
    $new_h_percent = $hpercent - $remove_percent;
    $new_w_percent = $wpercent - $remove_percent;
    $new_w = ($w/460)*$new_w_percent;
    $new_h = ($h/345)*$new_h_percent;
    $img = $img->resize($new_w, $new_h, 'inside');
    $img = $img->crop("center", "middle", 460, 345);
}else {
    // En af dem er for små
    if ($wpercent > $hpercent) {
        // height is smallest
        $add_percent = 100 - $hpercent;
    }else{
        // width is smallest
        $add_percent = 100 - $wpercent;
    }
    $new_h_percent = $hpercent + $add_percent;
    $new_w_percent = $wpercent + $add_percent;
    $new_w = ($w/460)*$new_w_percent;
    $new_h = ($h/345)*$new_h_percent;
    $img = $img->resize($new_w, $new_h, 'inside');
    $img = $img->crop("center", "middle", 460, 345);
}
$img->saveToFile('uploads/tmp/'.$new_name); 
```

它确实会调整大小，只是缩小到我想要的大小。

有任何想法吗？

如果需要，它也应该裁剪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:00:24.230

```
 list($w, $h) = getimagesize($_FILES['image']['tmp_name']);
        if ($w != 460 || $h != 345) {
             $img = $img->resize(460, 345, 'inside');
             $img = $img->crop("center", "middle", 460, 345);
        }
        $img->saveToFile('uploads/tmp/'.$new_name); 
```

你想用所有这些 new_h_percent 和 new_w_percent 来完成什么？

# ruby-on-rails - Rails：一旦达到限制，我如何处理自动升级用户帐户？

> ID：14666866
> 
> 赞同：3
> 
> 时间：2013-02-02T21:46:59.913
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, stripe-payments

我有一个存储文件的 Rails 应用程序，用户可以在其中订阅三个计划：

*   计划 1：*免费试用*最多**50 个文件**，为期**30 天**
*   计划 2：最多**250 个文件**
*   计划 3：最多**500 个文件**

在以下情况下，我将如何自动升级/降级用户计划：

*   30 天试用期结束或用户上传超过 50 个文件
*   超出文件限制并进入另一个括号
*   或者文件被删除并且用户**下降**了一个级别

如何将 Rails 应用程序设置为“监视”用户帐户以进行这些更改？

有没有比在 Files 控制器创建和删除操作中粘贴逻辑更好的方法？那么 30 天的试用逻辑呢？谢谢！

注意：我可以很好地处理订阅的实际切换，只需寻找监控和触发切换的逻辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:07:31.027

在用户的计划上设置[关联回调。](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)假设您与 Plan 有 has_many 关系，在 User.rb 中您可能有类似

```
has_many :plans, :through => :user_plans,
  :after_add => :check_plan_eligibility,
  :after_remove => :check_plan_eligibility 
```

进而

```
protected
def check_plan_eligibility(obj)
  # Do checks here based on your rules, and update the user's plan ID accordingly
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:52:56.097

观察者（[http://api.rubyonrails.org/classes/ActiveRecord/Observer.html](http://api.rubyonrails.org/classes/ActiveRecord/Observer.html)）

或者

ActiveRecord::Callbacks ( [http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html) )

用户登录后可查看 30 天试用。其余的可以在用户更新时使用回调来完成。

# javascript - 正则表达式问题 - 未知空格

> ID：14666867
> 
> 赞同：0
> 
> 时间：2013-02-02T21:47:02.760
> 
> 标签：javascript, parsing

基本上我的问题是我的程序接受的文本输入充满了随机空格、制表符和其他空白单元（换行符也是如此，但没有那么多）。

我已成功删除所有标签...

```
// Parse the input box into an array
var inputArr = document.getElementById("inputBox").value.split(/[\t]/); 
```

现在文本看起来像这样......

"隐藏组的虚拟字段 , , , , , , ,*Role ,Go To , , , Collapse section Summary , , , ,Name ,Doe,John ,Details ,Customer ,John Doe Inc.

我的问题：我有一个开关...

```
switch(inputArr[i]) { 
```

...有几种情况...

```
 case ("Name" || "Name " || " Name" || " Name "):
            if(inputArr[i - 1] == ("Summary" || "Summary " || " Summary" || " Summary ")) {
                contNameBool = true;
                break;
            }
            break;
        case ("Details" || "Details " || " Details" || " Details "):
            if(contNameBool == true) {
                contNameBool = false;
                break;
            } else if(contNameBool == false && compNameBool == true) {
                compNameBool = false;
                break;
            }
            break;
        case ("Customer" || "Customer " || " Customer" || " Customer "):
            if(inputArr[i - 1] == "Details") {
                contNameBool = false;
                compNameBool = true;
                break;
            }
            break;
        case "Address":
            if(inputArr[i - 1] == "Profile") {
                compNameBool = false;
                emailBool = true;
                break;
            }
            break;
        case ("VISA" || "MASTERCARD" || "AMERICAN" || "DISCOVER"):
            emailBool = false;
            break;
        case "Show":
            if(inputArr[i + 1] == "next" && inputArr[1 + 2] == "row") {
                accountLinesArray.length = inputArr[i - 1];
                for(j = 0; j < accountLinesArray.length; j++) {
                    accountLinesArray[j] = new account();
                }
                break;
            }
            break;
        case "Order":
            if(inputArr[i + 1] == "ID" && inputArr[i + 2] == "MRC") {
                accountsBool = true;
                break;
            }
            break; 
```

正如您可能知道的那样，我试图让我的程序识别文本中的某些关键词并相应地切换一些布尔值。无论我如何配置条件，switch 语句似乎都不会涉及任何情况。例如案件...

```
case ("Name" && "Name " && " Name" && " Name "): 
```

不会触发，即使我使用 ||。

在任何人发布之前。我意识到我的代码充其量是草率的。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:58:45.607

首先，您仅在选项卡上进行拆分。要拆分任何空白字符序列，请执行以下操作：

```
var inputArr = document.getElementById("inputBox").value.split(/\s+/); 
```

这将减少您需要处理的案例数量，因此您无需检查“姓名”、“姓名”、“姓名”或“姓名”，只需检查“姓名”：

```
case "Name":
    ...
    break; 
```

其次，这与您期望的不一样（请参阅下面的说明）：

```
inputArr[i - 1] == ("Summary" || "Summary " || " Summary" || " Summary ") 
```

但是通过上面的第一个更改，您无论如何都可以与“摘要”进行比较。

第三，对于您确实想要匹配完全不同的值的情况，您可以这样做：

```
case "VISA":
case "MASTERCARD":
case "AMERICAN":
case "DISCOVER":
    emailBool = false;
    break; 
```

最后，你真的应该重新考虑你的整个方法，但没有更多细节，很难给你任何有意义的建议......

祝你好运！

编辑（为什么`inputArr[i - 1] == ("Summary" || "Summary " || ...`不工作）：

在 Javascript 中，非空字符串算作真，`||`并且`&&`可以用作短路评估。例如，`("Name" || " Name")`get 被评估为`"Name"`因为`"Name"`是真的，所以等式的其余部分不需要评估。同样，`("Name" && " Name")`将等价于`" Name"`，因为`"Name"`它为真，所以它移动到下一个，`" Name"`这也是真并且是语句的结尾。要执行您正在尝试的操作，需要执行以下操作：

```
(inputArr[i - 1] == "Summary") || (inputArr[i - 1] == "Summary ") || ... 
```

或者可以通过使用正则表达式更简单地完成：

```
!!inputArr[i - 1].match("Summary").length
// Be careful though, as this could also match something like "NotASummaryDude" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:03:39.960

应用 Ray 的建议后，您可能还想从数组中删除空元素：

```
for (var i=inputArr.length-1; i>=0; i--){
    if (inputArr[i] == '' || !inputArr[i].match(/[^\s]/)) inputArr.splice(i,1)
} 
```

# html - 如何摆脱文本覆盖底部的随机一对像素

> ID：14666868
> 
> 赞同：0
> 
> 时间：2013-02-02T21:47:05.200
> 
> 标签：html, css, hover, overlay

我正在设计的网站上有一张带有透明文本覆盖的图像。

即使我的所有宽度和高度都为 100%，透明叠加层似乎比图像长几个像素。也没有边距或填充。

我花了最后半个小时试图弄清楚为什么它在那里，所以我可以摆脱它。任何帮助，将不胜感激。

**注意：我使用的是响应式 CSS 框架，所以我不能使用任何绝对高度或任何东西**

这是现场网站的链接：http: [//fine-grain-2.myshopify.com/](http://fine-grain-2.myshopify.com/)

这是HTML：

```
<div class="six columns alpha">
    <div class="thumb"> 
       <img src="http://cdn.shopify.com/s/files/1/0209/0122/products/MG_9507_large.jpg?348" alt="" />
       <div class="overlay">
           <a href="/products/the-bowden-brown-cherry">
           <h2>THE BOWDEN</h2>
           <h3>brown + cherry</h3>
           </a>
       </div>
    </div>                  
</div> 
```

这是CSS：

```
#home img, a, .column, .columns {
    padding: 0;
    margin: 0;
    width: 100%;
}

#home .six.columns {
    padding-bottom: 40px;
    position: relative;
}

#home .six.columns.alpha {
    padding-right: 40px;
}

#home .six.columns .thumb {
    display: block;
    width: 100%px;
    height: 100%px;
    text-decoration: none;
    padding: 0;
    margin: 0;
    position: relative;

}

#home .six.columns .overlay {
    position:absolute;
    top:0;
    left:0;
    opacity:0;
    width: 100%;
    height: 100%;
    text-decoration: none;
    background: none repeat scroll 0 0 rgba(0, 0, 0, 0.75);
    margin: 0;
    padding: 0;
}

#home .six.columns .thumb:hover .overlay {
    opacity: 1;
}

#home .six.columns h2 {
    color: #FAFAFA;
    display: block;
    font-size: 1.8em;
    font-weight: lighter;
    letter-spacing: 0.3em;
    margin-top: 27%;
    text-align: center;
}

#home .six.columns h3 {
    color: #FAFAFA;
    display: block;
    font-size: 1em;
    font-weight: lighter;
    letter-spacing: 0.6em;
    text-align: center;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:53:37.070

刚设置`display: block;`为`.thumb img`。

# c# - 如何根据百分比概率做出选择

> ID：14666876
> 
> 赞同：5
> 
> 时间：2013-02-02T21:48:12.333
> 
> 标签：c#, probability

我希望使用[这篇](https://stackoverflow.com/a/48089)文章中提供的答案从列表中随机选择独特的项目。

按照所描述的方法，在我的循环的每次迭代中，我都会生成一个概率值，它是从列表中选择当前项目的百分比机会。

我需要知道的是如何使用这个百分比值来选择项目（或不选择）。

这是我拥有的代码，`remainingIndices`是`List<int>`

```
for (var i = 0; i < remainingIndices.Count; i++)
{
    var probability = pixelsToAdd / (float)(remainingIndices.Count - i);
} 
```

`pixelsToAdd`是 120 并且`remainingIndices.Count`是 3600。我开始的概率值是 0.0333333351

该解决方案应该灵活地处理更广泛的值，最好是任何值。

谢谢

**评论**

对于这个问题的未来读者，我应该澄清一下，起初我认为概率值是介于 0 和 100 之间的某个百分比，但实际上它是介于 0 和 1 之间的值，因此与返回值完美匹配`Random.NextDouble()`，因此可用于比较，如下面的答案所述。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:55:32.657

要使用您的概率，请将其与遵循均匀分布的随机变量的样本进行比较`[0, 1]`。

```
if (Random.NextDouble() <= probability)
    // Take the ith element in the list 
```

你产生的循环将是：

```
List<???> selectedItems = new List<???>();
for (var i = 0; i < remainingIndices.Count; i++)
{
    var probability = pixelsToAdd / (float)(remainingIndices.Count - i);
    if (Random.NextDouble() <= probability)
    {
        selectedItems.Add(items[i]);
        pixelsToAdd--;
    }
} 
```

# api - SoundCloud 播放器小部件禁用声音统计

> ID：14666878
> 
> 赞同：2
> 
> 时间：2013-02-02T21:48:41.003
> 
> 标签：api, soundcloud

我正在查看 SoundCloud 播放器小部件 API 并尝试解决我在使用较小规模的播放器时遇到的问题。当前加载曲目艺术家、姓名和所有 SoundCloud 曲目统计信息。由于播放器的大小，我得到了一个难看的重叠。有没有办法使用 API 禁用那些声音云统计？

[http://i.imgur.com/jdOWuIg.png](http://i.imgur.com/jdOWuIg.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T18:09:49.263

名称有点混乱，但如果您添加`&show_playcount=false`到嵌入代码，它们将被隐藏。例子：

[https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Fplaylists%2F2860118&show_playcount=false](https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Fplaylists%2F2860118&show_playcount=false)

# php - php循环遍历xml兄弟一次以匹配兄弟然后移动到下一个

> ID：14666879
> 
> 赞同：1
> 
> 时间：2013-02-02T21:48:48.847
> 
> 标签：php, xpath, xml-parsing, simplexml

xml 兄弟按日期列出。由于每个日期的时间不同，每个日期可能会被列出多次。如...

编辑：添加 XML

```
<?xml version="1.0"?>
<theaterxml>
<theatreid>12345</theatreid>-
<filmtitle>
    <name>Movie Name 1</name>
    <shortname>MOVIENAME1</shortname>
    <rating>R</rating>
    <length>101</length>
    <show>
        <screen>1</screen>
        <date>02022013</date>
        <time>1205</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02022013</date>
        <time>1305</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02022013</date>
        <time>1605</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02032013</date>
        <time>1205</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02032013</date>
        <time>1305</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02032013</date>
        <time>1605</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02042013</date>
        <time>1205</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02042013</date>
        <time>1305</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02042013</date>
        <time>1605</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show> 
</filmtitle>
<filmtitle>
    <name>Movie Name 2</name>
    <shortname>MOVIENAME2</shortname>
    <rating>R</rating>
    <length>101</length>
    <show>
        <screen>1</screen>
        <date>02022013</date>
        <time>1205</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02022013</date>
        <time>1305</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02022013</date>
        <time>1605</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02032013</date>
        <time>1205</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02032013</date>
        <time>1305</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02032013</date>
        <time>1605</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02042013</date>
        <time>1205</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02042013</date>
        <time>1305</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show>
    <show>
        <screen>1</screen>
        <date>02042013</date>
        <time>1605</time>
        <salelink>http://mysite.com/foo?linkToThisTimeAndDate=999</salelink>
    </show> 
</filmtitle> 
```

当我使用 foreach 获取主 xml 的日期子项时，我只得到第一个日期。当我使用 while 循环时，它会显示每个日期的每次出现，直到没有更多日期为止。

我需要做的是运行一个while循环，显示每个日期一次，然后显示下一个不同的日期，直到没有更多的日期。然后，在那个 while 循环中，我需要另一个显示该日期的每次时间，直到没有更多内容为止。我需要能够通过使用 $_GET['date'] 和 ?date=01022013 的 url 来决定显示哪个日期及其时间。

我希望这是有道理的。我在移动设备上输入此内容，现在无法访问我的 PC 来复制/粘贴实际代码或 xml。

已编辑：现在在 PC

这似乎是很多 xml，但这只是一个片段。完整的 xml 显示 8 到 13 部电影，每天 2 到 5 次，有时持续 3 周。每次都必须加载它变得很重。现在我正在使用 simplexml，但更愿意使用 xmlreader。

今天的 xml 是 97.6KB。每次有人进入一个页面，选择几个日期中的一个，然后进入另一个页面，等等。在这个和图像之间，每次点击页面时显示单个页面的大量数据或改变。特别是在慢速连接、移动设备等方面。

现在我在这个项目上有点不知所措，并试图进一步学习/重新学习这让我更加落后。我个人鄙视 xml，并希望他们的内部软件在 mysql 数据库中构建它，但这是我必须使用的。此外，设计这个的公司也可以更好地构建它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T23:02:49.787

您是否正在寻找这样的东西：

```
// create a DOM document and load your xml (as string)
$document = new DOMDocument();
$document->loadXML($xml);

// create a xpath selector for the document
$selector = new DOMXPath($document);

// get all show elements
$showResult = $selector->query('//show');

// dates will contain the results
$dates = array();
foreach($showResult as $show) {
    // get the date sub node 
    $dateResult = $selector->query('date', $show);
    if(count($dateResult) !== 1) {
        die('bad xml');
    }
    $date = $dateResult->item(0)->nodeValue;

    // get the time sub node 
    $timeResult = $selector->query('time', $show);
    if(count($timeResult) !== 1) {
        die('bad xml');
    }
    $time = $timeResult->item(0)->nodeValue;

    // if it is the first the time the date appears
    // we create an empty array for this index. The 
    // array will contain the timestamps
    if(!isset($dates[$date])) {
        $dates[$date] = array();
    }

    // add time to array if the same does not exists
    if(!in_array($time, $dates[$date], TRUE)) {
        $dates[$date][] = $time;
    }
}

// get all dates and times
var_dump($dates);

// get times for 02022013
var_dump($dates['02022013']); 
```

# php - Mysql 没有保存带有 ' 字符的答案

> ID：14666882
> 
> 赞同：0
> 
> 时间：2013-02-02T21:49:04.423
> 
> 标签：php, mysql

> **可能重复：**
> [如何在 PHP 中处理 SQL 查询中的单引号？](https://stackoverflow.com/questions/7062604/how-do-i-handle-single-quotes-inside-a-sql-query-in-php)

问候，我有一个用于应用程序的小脚本，它将问题答案保存到数据库中。脚本如下：

```
while(list($QKey,$QVal) = each($AppQuestions)) {
    $result2= mysql_query("
         INSERT INTO forum_app_answers (AID, AppID, Question, Answer)".
         " VALUES (NULL, '$AppID', '$Questions[$QKey]', '$QVal')"
     ) or die(mysql_error()); 
```

现在的问题是，如果有人在答案中写了 ' 字符，则数据不会被保存。对于简单的写作没关系。问题仅在于答案中包含 ' 。任何帮助将不胜感激

发生以下错误：您的 SQL 语法有错误；查看与您的 MySQL 服务器版本相对应的手册，了解使用 Near 的 GF 的正确语法。渠道服务')' 在第 1 行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:52:54.873

使用准备好的语句。查找 PDO 并使用准备好的语句。

`mysql_`已弃用。

连接后`$dbh = new PDO()`，

```
 $sql = 'sql';
    $stmt = $dbh->prepare($sql);
    $stmt->execute($params); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:56:00.723

请执行下列操作：

```
$QVal = $mysqli->real_escape_string($QVal);
$query = "INSERT INTO forum_app_answers (AID, AppID, Question, Answer) 
          VALUES (NULL, '$AppID', '$Questions[$QKey]', '$QVal')";
//  $mysqli is previously defined
$mysqli->query($query);
if ($mysqli->errno !=0){
    printf("you have an error in your query %s", $mysqli->error);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:55:56.667

你可以试试：

```
while(list($QKey,$QVal) = each($AppQuestions)) {
    $result2= mysql_query("
       INSERT INTO forum_app_answers
           (AID, AppID, Question, Answer)". " 
       VALUES (
           NULL,
           '$AppID',
           '$Questions[$QKey]',
            '". mysql_real_escape_string($QVal). "')
      ") or die(mysql_error()); 
```

如果没有 mysql_real_escape_string()，您的脚本也会存在巨大的安全问题。

# php - 使用 AJAX 将 Javascript 变量获取到 PHP 文件

> ID：14666883
> 
> 赞同：-2
> 
> 时间：2013-02-02T21:49:23.793
> 
> 标签：php, javascript, ajax, ajax-request

我是 web 基础应用程序开发的新手，我正在学习 AJAX。这是我的问题，我正在尝试使用一些变量（用户输入）发出 AJAX 请求并获取具有相同变量的 php 文件。以下是我的代码，如果我遗漏了什么或者我做错了，请告诉我，我将不胜感激！谢谢你。

Javascript代码：

```
<script type="text/javascript">
function ajaxFunction(){
var ajaxRequest;
try{
  ajaxRequest = new XMLHttpRequest();
 }catch (e){
   try{
     ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
     }catch (e) {
  try{
     ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
  }catch (e){
    document.getElementById("Alert").innerHTML= "*Your browser broke!";
    document.getElementById("Alert").style.color = '#E00000 ';
     return false;
   }
  }
 }
  ajaxRequest.onreadystatechange = function(){
    if(ajaxRequest.readyState == 4){
      var ajaxDisplay = document.getElementById('display');
      ajaxDisplay.value = ajaxRequest.responseText;
     }
   }
 var input_building = document.getElementById('building').value;
 var input_room = document.getElementById('room').value;
 var queryString = "?building=" + input_building + "&room=" + input_room;
 ajaxRequest.open("GET", "map.php" + queryString, true);
 ajaxRequest.send(); 
}
 </script> 
```

HTML：

```
 <select id="building" name="building">
     <option value="#" default >Select</option>
     <option value="Luis C. Monzon">Luis C. Monzon</option>
  </select>
  <input type="text" id="room" name="room" placeholder="eg. 208B / CH 116" >
  <input id="submit" type="button" value="submit" onclick="ajaxFunction()" >
  <p id="display"></p> 
```

PHP 文件：

```
<?php>
  $building = $_GET['building'];
  $room = $_GET['room'];

  echo "<h1>".$room." ".$building."</h1>";
  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:30:56.793

您正在为元素设置`value`属性。`<p>`你应该设置它的`innerHTML`. 值用于输入字段。

```
document.getElementById('display').innerHTML = ajaxRequest.responseText; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T06:53:43.383

根据要求，我将发表我的评论

在您的代码中，您需要更改`ajaxDisplay.value`为`ajaxDisplay.innerHTML`- 正如 Juan 所阐述的那样，表单字段具有值，容器标签具有 innerHTML。

稍微捍卫一下 jQuery 的使用——我基本上同意对于简单的 JavaScript，加载外部库可能是多余的——在 Ajax 的情况下，我相信 jQuery 可以满足所有浏览器的需求。

你的 jQuery 代码：

```
<!DOCTYPE html>
<html>
<head>
<title>Get building</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
$(function() { // run onload
  $("ajaxbutton").on("click",function() {
    var input_building = $('building').val();
    var input_room = $('room').val();
    var queryString = "?building=" + input_building + "&room=" + input_room;
    $("#display").load("map.php" + queryString); // get the room 
  });
});
</script>
</head>
<body>
<select id="building" name="building">
  <option value="#" default >Select</option>
  <option value="Luis C. Monzon">Luis C. Monzon</option>
</select>
<input type="text" id="room" name="room" placeholder="eg. 208B / CH 116" />
<input id="ajaxbutton" type="button" value="Find Building" />
<p id="display"></p>
</body>
</html> 
```

注意：为了更好地控制结果，您可以将负载更改为

```
 $.get("map.php" + queryString,function(data) {
      // do something with data here - for example if you use JSON
      $("#display").html(data);
    }); 
```

# objective-c - 两个动态调整大小的视图之间的自动布局约束

> ID：14666887
> 
> 赞同：0
> 
> 时间：2013-02-02T21:49:36.463
> 
> 标签：objective-c, cocoa, interface-builder

**前提**

我有一个超级视图 C，它只包含两个子视图 A 和 B。ASCII 艺术：

```
+-----------+
|   view A  |
|   view B  |
+-----------+ 
```

这就是我想要的：

*   A 的顶部必须固定在 C 的顶部。A 的高度没有固定在任何东西上；它实际上根据其内容而变化：它是一个无滚动视图`NSTextView`。

*   B 的顶部必须始终距离 A 的底部 10 个像素。B 的底部必须始终固定在 C 的底部。

整个视图 C 应该在 A 和 B 之间进行分割，并且 A 和 B 之间的分割必须由 A 的当前高度决定（由 决定`NSTextView`），并且 B 应该填充 A 未占用的任何剩余空间。

*换句话说*：A 保持在顶部。B 填写了 superview 的其余部分。随着 A 的增长，B 被向下推。

**问题**

Interface Builder 总是创建不可删除的约束，将 B 的顶部固定到 C 的顶部。这意味着 B 将始终位于特定的 Y 位置。如果我给 B 一个高度限制，这不会发生，但这不是我想要的。

![界面生成器](../Images/d565089f20fa6e6a26d9718fc2a3e842.png)

我已经尝试实现超级视图`updateConstraints`来删除这个 IB 生成的约束。那种工作，但是当我这样做时，B的顶部从未调整过，似乎是任意设置的。不管我将约束优先级设置为什么，B 最终都位于 C 的底部、顶部或远离屏幕的某个位置。此外，A 似乎增长到填满整个 C。

这是我无法摆脱的自动创建的约束：

![界面生成器](../Images/f830e242eff5764dc64f246b44493c7e.png)

**额外细节**

我应该补充一点，C 是基于视图的单元格视图`NSTableView`。我计算了适合 A 和 B 所需的高度`tableView:heightOfRow`，并期望约束能够将所有内容都布置好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:11:03.820

后人的答案：在约束条件下显然不可能进行描述的配置。到目前为止，我的解决方案有效：

*   在 A 上创建一个设置特定高度的约束。（在 IB 中，我设置了一个虚拟高度。）
*   在 B 上创建一个设置特定顶部的约束。
*   *不要*指定 A 和 B 之间的垂直间距。（至少在我的情况下，这会触发 . 中的奇怪行为`NSTableView`。）
*   在您的控制器或视图代码中，计算出 A 的高度并使用该`constraint.constant`属性进行设置。
*   同样在您的控制器或视图代码中，计算出 B 的顶部（使用 A 的高度）并使用`constraint.constant`属性设置它。

# file - symfony2 文件下载管理器

> ID：14666898
> 
> 赞同：0
> 
> 时间：2013-02-02T21:50:45.633
> 
> 标签：file, symfony, authorization, download, bundle

我正在寻找 Symfony2 的 Bundle，它允许特定用户访问下载文件，如 .zip .pdf。用户可以登录和下载他们有权访问的文件。只要用户“通过身份验证”并具有正确的角色。

我还希望能够向某人发送一个具有特定生命周期的下载 URL，一旦下载成功就会消失。

我查看了packagist.org，我能找到的最近的是chilldev/file-manager-bundle，但是它没有访问控制和URL生成。我也查看了 knpbundles.com 并找不到任何东西。

有谁知道具有功能类型的捆绑包？这将为我节省大量的开发时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:32:17.390

恕我直言，没有这样的捆绑包。您需要自己编写安全代码或尝试组合一些现有的捆绑包。

值得一看：

**奏鸣曲项目** [https://github.com/sonata-project](https://github.com/sonata-project)

**FriendsOfSymfony** [https://github.com/FriendsOfSymfony](https://github.com/FriendsOfSymfony)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-26T14:24:00.883

可能有点晚了，但我建议检查这个包：[NzoFileDownloaderBundle](https://github.com/NAYZO/NzoFileDownloaderBundle)

# apache - htaccess 将 www (es) 重定向到非 www (es)

> ID：14666899
> 
> 赞同：3
> 
> 时间：2013-02-02T21:51:08.873
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

我目前正在将对 www.example.com 的所有请求重定向到 example.com。我可以很好地使用在 stackoverflow 其他地方找到的这段代码：

```
RewriteCond %{HTTP_HOST} ^www\.example\.com [NC]
RewriteRule ^(.*)$ http://example.com/$1 [L,R=301] 
```

到现在为止还挺好。我遇到的问题是我还需要确保我的网站的西班牙语版本也重定向 - www.example.com/es 需要重定向到 example.com/es，但这不适用于上面显示的代码。

我需要添加什么才能使重定向起作用？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:15:58.967

在 example.com/es/ 文件夹中，创建一个包含以下内容的 .htaccess 文件：

```
RewriteCond %{HTTP_HOST} ^www\.example\.com$ [NC]
RewriteRule ^(.*)$ http://example.com/es/$1 [L,R=301] 
```

（[参考](https://stackoverflow.com/questions/14666899/htaccess-redirect-www-es-to-non-www-es/14667099#comment20501673_14666899)）

# microcontroller - 为 EEPROM 仿真 STM32F4 保留闪存位置

> ID：14666904
> 
> 赞同：0
> 
> 时间：2013-02-02T21:51:52.757
> 
> 标签：microcontroller, stm32, flash-memory, stm32f4discovery

我想在扇区 2 和 3 中模拟 EEPROM，以保持低擦除时间（小 16kb 扇区）。我的问题是如何保留这个闪存空间以防止编译器将程序代码放置在这些扇区中？

谁能指出我到目前为止没有发现任何有意义的信息？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-10T13:40:46.990

从应用笔记[AN3969](http://www.st.com/content/ccc/resource/technical/document/application_note/ec/dd/8e/a8/39/49/4f/e5/DM00036065.pdf/files/DM00036065.pdf/jcr:content/translations/en.DM00036065.pdf)中可以看出，正如您所说，最好的方法是使用扇区 0-3，因为它们只有 16kB。

> 我的问题是如何保留这个闪存空间以防止编译器将程序代码放置在这些扇区中？

在您的链接器文件 (*.ld) 中，声明您的 Flash 的开头位于第 4 扇区的开头，以便链接器将您的代码从该地址开始放置，例如。

# c++ - istream 过载不工作

> ID：14666905
> 
> 赞同：0
> 
> 时间：2013-02-02T21:51:53.240
> 
> 标签：c++, overloading, istream

根据要求，实际文件：

d_date.h [http://pastebin.com/AFe4XE2c](http://pastebin.com/AFe4XE2c)

d_except.h [http://pastebin.com/8QE2m8ia](http://pastebin.com/8QE2m8ia)

d_date.cpp [http://pastebin.com/dgpxLWKv](http://pastebin.com/dgpxLWKv)

input.dat [http://pastebin.com/XUpRcu9E](http://pastebin.com/XUpRcu9E)

我做了一个类似于以下的简单程序，我得到了类似的错误。

班级：

```
#ifndef DATE_CLASS
#define DATE_CLASS

#include <iostream>
#include <iomanip>
#include <string>

//#include "d_except.h"

using namespace std;

class date
{
   public:
      date ();

      //ADDED
      friend ostream& operator<<(ostream&, const date&); 
      friend istream& operator>>(istream&, date&);

   private:
      int month, day, year;
            // private members that specify the date

};

#endif 
```

和日期.CPP：

```
#ifndef DATE_CPP
#define DATE_CPP

#include "date.h"
#include <stdexcept>
#include <iostream>

using namespace std;

ostream& operator<<(ostream& ostr, const date& date1){
     char blah;
     ostr << blah;
 }

 istream& operator>>(istream& istr, date& date1){
     istr >> "5";
     return istr;
 }

#endif 
```

驱动程序.CPP：

```
#include <iostream>
#include "date.h"
//#include "d_except.h"

using namespace std;

void main (void)
{
    date date1;
    date date2;
} 
```

和错误（不是发布长度列表，而是发布到末尾的那些：

```
c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(373): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(unsigned __int64 &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(392): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(float &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(411): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(double &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(429): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(long double &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(447): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(void *&)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(466): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(std::basic_streambuf<_Elem,_Traits> *)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          while trying to match the argument list '(std::istream, const char [2])'
1>  Generating Code...
1>
1>Build FAILED. 
```

更长的版本：（忽略以下内容）当我使用以下内容时，我会收到可怕的警告：

```
class date
{
   public:
    //irrelevant (hopefully) functions not shown are here
    friend ostream& operator<<(ostream&, const date&); 
    friend istream& operator>>(istream&, date&);

   private:
    int month, day, year;
}

 ostream& operator<<(ostream& ostr, const date& date1){
    ostr << date1.getDay() << "/" << date1.getMonth() << "/" << date1.getYear() << " "; 
    return ostr;
 }

 istream& operator>>(istream& istr, date& date1){
     int d, m, y;
     char ch;
     istr >> d >> ch >> m >> ch >> y >> ch;
     date1.setDay(d);
     date1.setMonth(m);
     date1.setYear(y);
     return istr;
 } 
```

我的输入是 input.dat 并在 Microsoft Visual Studio 2010 的调试页面中指定。我在 >> 之后使用不同的变量重复以下内容。据我所知，istream 使用日期存在一些问题。我认为它在这篇文章的最后一行“告诉”了我问题所在，但我仍然不明白。

```
c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(411): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(double &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(429): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(long double &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(447): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(void *&)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\istream(466): or       'std::basic_istream<_Elem,_Traits> &std::basic_istream<_Elem,_Traits>::operator >>(std::basic_streambuf<_Elem,_Traits> *)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          while trying to match the argument list '(std::istream, date)' 
```

运行这些东西的实际 .cpp 是：

```
void main (void)
{
    date date1;
    date date2;

    cout << "Enter date1 and date2:" << endl;

    while (cin >> date1 >> date2)
    {
        cout << "Printing date1 and date2" << endl;
        cout << date1 << endl << date2 << endl;
                //and more...

} 
```

附录：

```
class date
{
   public:
      date (int mm=1, int dd=1, int yyyy=1900);
            // supply date in format MM/DD/YYYY
            // preconditions: 1 <= mm <= 12,
            //                1 <= dd <= daysInMonth()

      void writeShortDate () const;
            // output the date in the format "MM/DD/YYYY"
      void writeLongDate () const;
            // output the date in the format "month day, year"

      void incrementDate(int ndays);
            // add ndays days to the date
            // precondition: 0 <= ndays <= 365

      int numberOfDays() const;
            // return the number of days into the year

      int getMonth() const;// done
            // return the month as integer value 1 to 12
      int getDay() const; //done
            // return day of the month
      int getYear() const;  //done
            // return the year

      void setMonth(int mm); //done
            // update the month
            // precondition: 1 <= mm <= 12
      void setDay(int dd); //done
            // update the day
            // precondition: 1 <= dd <= daysInMonth()
      void setYear(int yyyy); //done
            // update the year
            // precondition:  if the date is February 29,
            //                yyyy must be a leap year
      int daysInMonth() const;
            // return number of days in the month

      bool isLeapYear() const;
            // is the current year a leap year (true/false)

      //ADDED
      bool operator< (const date&) const;
      bool operator> (const date&) const;
      date operator++ ();
      friend ostream& operator<<(ostream&, const date&); 
      friend istream& operator>>(istream&, date&);
   private:
      enum monthName {Jan = 1, Feb, Mar, Apr, May, Jun,
                      Jul, Aug, Sep, Oct, Nov, Dec};
            // private type used by date

      int month, day, year;
            // private members that specify the date

}; 
```

和：

```
#ifndef DRIVER_H
#define DRIVER_H

#include <iostream>
#include "d_date.h"
#include "d_except.h"

using namespace std;

void main (void)
{
    date date1;
    date date2;

    cout << "Enter date1 and date2:" << endl;

    while (cin >> date1 >> date2)
    {
        cout << "Printing date1 and date2" << endl;
        cout << date1 << endl << date2 << endl;

        if (date1 == date2) 
            cout << date1 << " is equal to " << date2 << endl;

        if (date1 != date2) 
            cout << date1 << " is not equal to " << date2 << endl;

        if (date1 < date2) 
            cout << date1 << " is less than " << date2 << endl;

        if (date1 > date2) 
            cout << date1 << " is greater than " << date2 << endl;

        ++date1;
        ++date2;

        cout << "Increment of date1: " << date1 << endl;
        cout << "Increment of date2: " << date2 << endl;

        cout << endl << "---End of Run---" << endl << endl;

        cout << "Enter date1 and date2:" << endl;
    }

} 
```

这是给学校的，我讨厌发布几乎整个作业，但我无法修复错误。以上是date.h和driver.cpp的更详细版本。

我不知道我做了什么，但现在我得到的唯一错误是：

```
Error   1   error C2678: binary '>>' : no operator found which takes a left-hand operand of type 'std::istream' (or there is no acceptable conversion) 
```

另外，忘了提...这里没有显示 driver.cpp 的重载代码，但不会导致错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T23:13:35.333

`operator >>`编译器告诉您while存在问题`trying to match the argument list '(std::istream, date)'`。事实上，在您的班级重载中`operator >>`，您`date`在发布的代码的最后一个版本中有此说明：

```
istr >> "5"; 
```

通常，重载签名中的第二个参数`operator >>`是对应该从流中提取（反序列化）的对象的非常量引用。但是，字符串文字`"5"`具有 type `char [2]`，并且该类型不存在重载`operator >>`。这是有道理的：如何从流中提取对象并将其存储到字符串文字中？

因此，您得到的错误。我怀疑您以前版本的代码受到类似问题的影响。

# php - php $_GET 方法

> ID：14666908
> 
> 赞同：-2
> 
> 时间：2013-02-02T21:52:08.463
> 
> 标签：php, mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

例如，如何让 php 获取字母和数字
`http://www.mywebsite.com/chatBody.php?chat_code=9BYELZ0WxdQr4An`

我是我正在使用的所有代码：

```
$sql = "SELECT * FROM chat WHERE chat_members_code = " . mysql_real_escape_string($_GET['chat_code']);
$chat = mysql_query($sql);

while($row = mysql_fetch_array($chat)) {

$chat_id = $row['id'];
$user_1_id = $row['user_1_id'];
$user_1_fullname = $row['user_1_fullname'];
$user_1_username = $row['user_1_username'];
$user_2_id = $row['user_2_id'];
$user_2_fullname = $row['user_2_fullname'];
$user_2_username = $row['user_2_username'];
$chat_body = $row['chat_body'];
$chat_members_code = $row['chat_members_code'];
$chat_time = $row['chat_time'];
$chat_date = $row['chat_date'];
$chat_datetime = $row['chat_datetime'];

} 
```

它显示了这个错误：

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in C:\wamp\www\LiveChat\php\chatBody.php on line 21 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:21:56.417

试试这个

```
 $chatCode = mysql_real_escape_string($_GET['chat_code']) ;
   $sql = "SELECT * FROM chat WHERE chat_members_code =  '".$chatCode."' "; 
```

# php - 如何在页面之间的symfony中保存变量？

> ID：14666909
> 
> 赞同：0
> 
> 时间：2013-02-02T21:52:18.967
> 
> 标签：php, class, symfony-1.4

我正在使用 symfony 并且在我的操作类中我处理执行一些操作的执行函数。在该函数中，我想将一个变量保存到类中，以便以后可以引用它。有没有办法在不写入数据库或使用全局 PHP POST 变量的情况下做到这一点？

就像，在 executeIndex 函数中，我将变量保存到类范围，然后当调用 executeEdit 函数时，我可以检索该值吗？这可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:41:07.553

正如弗里克所说，您可以使用会话：

```
// store into the session
$this->getUser()->setAttribute('my_var', $var);

// fetch var already stored in the session
$my_var = $this->getUser()->getAttribute('my_var', null); 
```

或者`sfConfig`，如果您的变量与配置有关，您可以使用：

```
// define a setting
sfConfig::set('my_var', $var);

// Retrieve a setting
$my_var = sfConfig::get('my_var', null); 
```

# javascript - 带有 Spine.js 的真实世界 webapp 结构

> ID：14666915
> 
> 赞同：1
> 
> 时间：2013-02-02T21:52:50.830
> 
> 标签：javascript, model-view-controller, structure

我使用 Spine.js 和 CoffeeScript 研究 JavaScript MVC 已经有一段时间了。我开发 Ruby on Rails 有一段时间了，所以我了解模型、视图和控制器应该分别处理什么（基于我对它的适度经验）。但是在 Rails 中，我们已经知道（一般来说）每个控制器基本上都是控制一堆视图（或页面）并一次处理一个或多个模型的东西。（也许，如果我错了，请纠正我，因为我不是专业人士，但我必须承认）。

然而，我在架构方面发现了一个与 Spine 完全不同的概念。我阅读了它的文档并深入研究了它的示例应用程序。不幸的是，所有 Spine 示例应用程序都展示了如何处理单页应用程序，而在现实世界中“更大”的应用程序将不再是这种情况。（如果 Spine 只能用于“单页应用程序”，请纠正我）。

假设有一个网站（或应用程序）由许多页面/部分/模块组成，如下所示：

1 - 主页，例如显示基于缩略图的列表 2 - 联系人页面 3 - 当前用户的个人资料管理页面（普通 CRUD）

每个页面都具有与标题相同的主要结构（或布局），带有指向上述页面的链接、搜索输入字段和注销链接（我已经知道登录页面应该是分开的，所以我不会问认证在这里）。

这里棘手的部分是我无法真正弄清楚如何将整个部分联系在一起，我一直在问自己一些问题，在 Google 和 StackOverflow 上进行了搜索，但没有明确的答案。

1 - “必须”一个脊椎应用程序应用程序只在一页中？我的意思是，固定页眉和页脚，但有一个动态内容 DIV，它根据用户在页眉上单击的选项卡加载和卸载视图？还是应该将每个页面视为独立的脊椎应用程序？

2 - 我在一页中有多个控制器吗？比如app主控制器和导航控制器（header）？

3 - 每个控制器是否应该处理一个模型或与之关联的模型？（在示例中，它们之间始终存在一对一的关系，例如任务模型和任务控制器）。

4 - 我应该在我的应用程序中的哪里存储与接口相关的状态变量。我是否应该创建一个“记住”当前用户的模型，或者例如突出显示哪个选项卡以供进一步参考？或者我应该将它们存储到控制器中吗？

5 - 如果它是一个单页应用程序（但有很多部分或模块），我应该为这个页面内的每个加载部分都有一个控制器吗？

我知道这些对于更有经验的程序员来说可能是微不足道的问题，但我真的不知道从哪里开始。因此，如果有人能引导我走上正确的道路，那就太棒了。

提前致谢！

DD

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:31:42.823

我认为这是一个非常好的问题。我的答案会很广泛，所以请耐心等待。

我的回答的本质是，您需要熟悉其他框架才能了解您选择的框架要解决的问题。你的问题是可以理解的。其他人一直在为缺乏一种“正确”的方式来做一些常见的事情而苦苦挣扎。解决方案是根据示例、包装器/扩展和替代框架创建的。也许，您应该寻找与[Backbone](http://backbonejs.org/)相关的信息，它启发了 Spine 并且仍然与它相似。

正如您所说，您熟悉 Rails 的 MVC。然后是 Spine 的 MVC 方法，它完全不同。这应该给您一个提示，即 MVC（或一般的 MV*）是具有非常不同实现的广泛概念。好吧，您可能会认为 Rails 毕竟是一个基于请求的服务器端框架，而 Spine 是一个基于客户端事件的框架——所以区别是可以理解的。好吧，客户端 JavaScript 框架之间也没有统一性。比如上面提到的 Backbone 有所谓的 Views，其实就是起到了控制器的作用。所以我想 Spine 的创建者所做的一件事就是为了清晰起见将 Views 重命名为 Controllers。[Addy Osmani](http://addyosmani.com/blog/understanding-mvc-and-mvp-for-javascript-and-backbone-developers/)详细解释了 JavaScript 的 MV* 。还有[一个很好的概述](http://coding.smashingmagazine.com/2012/07/27/journey-through-the-javascript-mvc-jungle/)JavaScript 框架。

所以 Spine 和 Backbone 的一个“问题”是它们没有规定任何架构。换句话说，他们不够有主见。您可以根据需要使用它们，这一事实令人沮丧。下面我试着回答你的问题：

1.  使用 Spine，应用程序*不需要*是单页应用程序 (SPA)。

你可以创建一个有多个页面的应用程序，每个页面加载它自己的控制器。在这种情况下，您的视图可以在服务器上呈现，并且您的模型可以从生成的 JavaScript 引导。当您不想要 SPA，但仍想组织 JavaScript 或拥有一些可重用的组件时，这很好。

但是，从 Spine 的特性集（例如路由）来看，它是在考虑 SPA 的情况下创建的。

1.  对于 SPA 和复杂的 UI，通常最好将部分 UI（小部件）分开。在 Spine 中，控制器是这种分离的手段。所以是的，使用多个控制器并使用控制器嵌套。也许，应该有一个最顶层的应用程序控制器。

2.  这不是真的（没有技术限制），尽管[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)使事情变得更容易。

3.  将这些变量存储在相应级别的控制器中。如果您需要观察这些值，请将它们存储为模型，否则将它们存储为控制器属性。

4.  您可以拥有一个 App 控制器，其中包含页眉、页脚、侧边栏控制器和活动页面。在 Routes 中，您创建一个相应的控制器并将其传递给 App 控制器，该控制器将主区域内容替换为该控制器的元素。这是一种可能的方法。

再来一次：

人们一直在为 Backbone/Spine 中的应用程序架构缺乏具体性而苦苦挣扎。他们创建了一些解决方案，如应用程序控制器、布局管理器等。对于 Backbone，您可以查看[Marionette](https://github.com/derickbailey/backbone.marionette)、[Chaplin](https://github.com/chaplinjs/chaplin)或[Thorax](https://github.com/walmartlabs/thorax)。通过向他们学习，您将能够为您的 Spine 应用程序提出一个架构。祝你好运！

# javascript - 如何在 Rob Flaherty 的美国地图示例中缩放拉斐尔地图？

> ID：14666918
> 
> 赞同：1
> 
> 时间：2013-02-02T21:53:01.477
> 
> 标签：javascript, raphael

我正在尝试实现[这张很棒的地图](http://www.ravelrumba.com/code/demos/us-map-raphael/demo-animated.html)，但我不知道如何缩放它。更改容器 div 的大小或高度/宽度值只会裁剪底层地图。我想我需要 paper.scaleAll(.5) 在这里的某个地方，但无法弄清楚。谢谢！

```
 <script>
  window.onload = function () {
    var R = Raphael("container", 1000, 900),
      attr = {
      "fill": "#d3d3d3",
      "stroke": "#fff",
      "stroke-opacity": "1",
      "stroke-linejoin": "round",
      "stroke-miterlimit": "4",
      "stroke-width": "0.75",
      "stroke-dasharray": "none"
    },
    usRaphael = {};

    //Draw Map and store Raphael paths
    for (var state in usMap) {
      usRaphael[state] = R.path(usMap[state]).attr(attr);
    }

    //Do Work on Map
    for (var state in usRaphael) {
      usRaphael[state].color = Raphael.getColor();

      (function (st, state) {

        st[0].style.cursor = "pointer";

        st[0].onmouseover = function () {
          st.animate({fill: st.color}, 500);
          st.toFront();
          R.safari();
        };

        st[0].onmouseout = function () {
          st.animate({fill: "#d3d3d3"}, 500);
          st.toFront();
          R.safari();
        };

      })(usRaphael[state], state);
    }

  };
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:22:02.953

另一个答案几乎是正确的，但是您必须将缩放命令的锚点设置为 0,0，以便每个状态都从同一点缩放：

element.transform("s2,2 0,0");

当您使用它时，我会创建一个 R.set() 元素并将每个状态添加到其中，以便您可以在添加其他对象（例如图例）时将比例仅应用于状态您不想扩展：

```
usRaphael = {},
states = R.set();

//Draw Map and store Raphael paths
for (var state in usMap) {
  usRaphael[state] = R.path(usMap[state]).attr(attr);
  states.push(usRaphael[state]);
} 
```

然后在最后：

```
states.transform("s2,2 0,0"); 
```

[jsFiddle](http://jsfiddle.net/chriswilsondc/F4f8d/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:21:04.433

绘制地图后（在`for`循环之外）尝试以下操作：

```
R.forEach(function(element) {
    element.transform("s2");
}); 
```

我不确定您使用的是什么版本的 Raphael，但我的代码假设是最新的。它的作用是遍历纸上的每条路径并将变换设置为“比例 2”。这会将所有路径缩放 2。

# asp.net-mvc - 如何使用 ASP.MVC 和 DotNetOpenAuth 从 Facebook 获取电子邮件地址

> ID：14666921
> 
> 赞同：1
> 
> 时间：2013-02-02T21:53:43.923
> 
> 标签：asp.net-mvc, dotnetopenauth

我正在尝试在我的应用程序中设置身份验证。我有发布到外部网站的工作（脸书和谷歌）

```
[AcceptVerbs(HttpVerbs.Post | HttpVerbs.Get), ValidateInput(false)]
    public ActionResult OpenIdLogOn(string returnUrl)
    {
        var redirectUrl = "~/Companies/LogIn";
        var provider = Request.Form["provider"];
        if (Common.IsNull(provider))
            return View();            
        OpenAuth.RequestAuthentication(provider, redirectUrl);
        return View();
    } 
```

这通过确定单击了哪个按钮（使用 facebook / Google 登录）然后请求身份验证来工作。当身份验证完成并收到回复后，我尝试检索电子邮件地址。

```
public ActionResult LogIn()
    {
        var redirectUrl = "~/Companies/LogIn/OpenIdLogOn";
        var response = Response;
        var userEmail = Request.Params[16];
        if (!String.IsNullOrEmpty(ReturnUrl))
        {                
            Response.Redirect("~/Bloggers");
        }

        ViewBag.OAuthProviders = OpenAuth.AuthenticationClients.GetAll().ToList();
        return View();
    } 
```

如果我使用谷歌登录，以下将起作用 -

```
var userEmail = Request.Params[16]; 
```

但facebook不会发回电子邮件。好吧，我在请求中看不到它。必须有比使用`Request.Params[16];` 也更好的方法来做到这一点。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T14:47:34.667

如果看不到是什么`OpenAuth`，很难说新代码应该是什么样子。但是只要说你绝对不应该直接从请求中抓取电子邮件地址就足够了。当您这样做时，OAuth 和 OpenID 提供的所有安全性都毫无价值。您需要从您正在使用的安全库中获取电子邮件地址。

对于 Google，这意味着从响应的`FetchResponse`或`ClaimsResponse`扩展中获取它。

对于 Facebook，这意味着使用从登录返回的访问令牌从 Facebook 获取电子邮件地址*并*验证受众字段，以确保访问令牌不会作为用户欺骗攻击的一部分被重定向到您的网站。

# http - 有了 MVP，就不需要像 MVC 中的控制器了吗？

> ID：14666922
> 
> 赞同：0
> 
> 时间：2013-02-02T21:53:49.603
> 
> 标签：http, model-view-controller, design-patterns, web, mvp

我了解在 MVP 中，演示者和视图相互调用以协调事件并显示模型中的数据。所以视图可以不知道模型（对吗？）

所以......我的问题实际上是两个。

1.  MVP 适合传统的 Web 应用程序还是仅适用于 ajax Web 应用程序？由于传统的 Web 范式是由视图提交表单到 servlet 组成的。
2.  在 MVP 中不需要控制器吗？而且...好吧，主持人毕竟不是控制器？

在我的旧 Web 应用程序中，我使用了一种更复杂的 MVC 方法，可以这样表示：

![在此处输入图像描述](../Images/3d51aed07f270f575fe2d870be5c85ae.png)

这也是“发布后重定向”网络模式的一种变体。但是我总是有一个特殊的Controller作为jsp页面（或其他模板技术）的上限，它有责任获取url参数（通常是ID）并加载html模板要显示的对象。“cap 控制器”与特定视图严格关联，而 Action Controller 只是执行一个操作并选择下一个视图，重定向到它的 cap。

这个“cap controller”在某种程度上类似于 MVP 中的“Presenter”的概念？

据我了解，在 MVP 中，Presenter 还处理事件。在 MVP 中，presenter 的角色涵盖了动作控制器的角色以及上面的“cap 控制器”？

或者这是一种混合（MVPC）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T10:36:57.797

简而言之，主持人是掌控一切的人。它接受一个请求，告诉模型要做什么，然后将结果传递给视图进行显示。这不是一个循环程序。模型向演示者报告。至少在被动视图变体中。

# wpf - 设置 ListView 以填充所有可用的垂直空间

> ID：14666923
> 
> 赞同：3
> 
> 时间：2013-02-02T21:53:50.240
> 
> 标签：wpf, xaml, windows-8

我正在尝试设计一个顶行固定高度的设计，以及一个填充所有可用剩余空间的 ListView。

ListView 有一个很大的 ItemsSource 并且要正确使用 UI 虚拟化，我读到需要指定高度。如果我将它设置为绝对值，它工作正常。但是，将其设置为“Stretch”似乎会渲染整个 ListView（甚至在屏幕外）。

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <Grid.RowDefinitions>
        <RowDefinition Height="200"></RowDefinition>
        <RowDefinition Height="*"></RowDefinition>
    </Grid.RowDefinitions>
    <ScrollViewer VerticalScrollMode="Enabled" Grid.Row="1">
        <ListView VerticalAlignment="Stretch"/>
    </ScrollViewer>
</Grid> 
```

如何让 ListView 在不离开屏幕的情况下占用所有可用空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:58:11.643

整个 ListView 都被渲染了，因为你把它放在了一个`ScrollViewer`. 一个独立的 ScrollViewer 对虚拟化一无所知，并且基本上告诉它的内容它们有无限的空间来呈现自己。

所以移除 ScrollViewer，让 ListView 成为 Grid 的直接子项。ListView 有自己的内部 ScrollViewer 来*处理*虚拟化，当 ListView 获得足够的项目来填满屏幕时，您应该会看到它。

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <Grid.RowDefinitions>
        <RowDefinition Height="200"></RowDefinition>
        <RowDefinition Height="*"></RowDefinition>
    </Grid.RowDefinitions>

    <ListView VerticalAlignment="Stretch" Grid.Row="1" />
</Grid> 
```

# javascript - 清除间隔（）不工作

> ID：14666924
> 
> 赞同：48
> 
> 时间：2013-02-02T21:53:52.783
> 
> 标签：javascript, scope, setinterval, clearinterval

> **可能重复：**
> [JS - 如何在使用 setInterval() 后清除间隔](https://stackoverflow.com/questions/8266726/js-how-to-clear-interval-after-using-setinterval)

我有一个函数，它`font-family`每 500 毫秒使用一次更改一些文本`setInterval`（我这样做只是为了练习 JavaScript。）通过单击“打开”按钮调用该函数，并且应该使用单独的按钮清除间隔，“离开”。但是，“关闭”按钮实际上并没有清除间隔，它只是继续。我怀疑这与范围有关，但我不确定如何以其他方式编写它。另外，我不想用 jQuery 来做这件事，因为毕竟我这样做是为了学习。

```
<body>
<p><span id="go" class="georgia">go</span> Italian</p>
<p>
    <button id="on" type="button" value="turn on">turn on</button>
    <button id="off" type="button" value="turn off">turn off</button>
</p>

<script>
var text = document.getElementById("go");
var on = document.getElementById("on");
var off = document.getElementById("off");

var fontChange = function() {
    switch(text.className) {
        case "georgia":
            text.className = "arial";
            break;
        case "arial":
            text.className = "courierNew";
            break;
        case "courierNew":
            text.className = "georgia";
            break;      
    }
};

on.onclick = function() {
    setInterval(fontChange, 500);
};

off.onclick = function() {
    clearInterval(fontChange);
}; 
</script>
</body> 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-02-02T21:56:41.923

`setInterval`返回一个 ID，然后您可以使用它来清除间隔。

```
var intervalId;
on.onclick = function() {
    if (intervalId) {
        clearInterval(intervalId);
    }
    intervalId = setInterval(fontChange, 500);
};

off.onclick = function() {
    clearInterval(intervalId);
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-02T21:56:23.530

该`setInterval`函数返回一个整数值，它是您创建的“计时器实例”的 id。

您需要传递的正是这个整数值`clearInterval`

例如：

```
var timerID = setInterval(fontChange,500); 
```

然后

```
clearInterval(timerID); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T21:57:18.877

我认为你应该这样做：

```
var myInterval
on.onclick = function() {
    myInterval=setInterval(fontChange, 500);
};

off.onclick = function() {
    clearInterval(myInterval);
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-02T21:58:52.713

您使用 clearInterval 不正确。

这是正确的用法：

设置定时器

```
var_name = setInterval(fontChange, 500); 
```

接着

```
clearInterval(var_name); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-02T21:56:20.893

[setInterval](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)方法返回一个间隔 ID，您需要将其传递给该 ID以`clearInterval`清除间隔。您正在传递一个不起作用的函数。这是一个工作 setInterval/clearInterval 的示例

```
var interval_id = setInterval(myMethod,500);
clearInterval(interval_id); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-03T00:53:58.040

您的函数中有错误，但您应该做的第一件事是正确设置 body 标签：

```
<body>
<p><span id="go" class="georgia">go</span> Italian</p>
<p>
    <button id="on" type="button" value="turn on">turn on</button>
    <button id="off" type="button" value="turn off">turn off</button>
</p>
</body>

<script>....</script> 
```

有时问题可能是，当脚本启动时，您只调用一次“var text”和其他 var。如果您对 DOM 进行更改，此静态解决方案可能是有害的。

所以你可以试试这个（这是更灵活的方法并使用函数参数，所以你可以在*任何*元素上调用函数）：

```
<body>
<p><span id="go" class="georgia">go</span> Italian</p>
<p>
    <button type="button" value="turn on"
         onclick=turnOn("go")>turn on</button>
    <button type="button" value="turn off"
         onclick=turnOff()>turn off</button>
</p>
</body>

<script type="text/JavaScript">
var interval;

var turnOn = function(elementId){
    interval = setInterval(function(){fontChange(elementId);}, 500);
};

var turnOff = function(){
    clearInterval(interval);
};

var fontChange = function(elementId) {
    var text = document.getElementById(elementId);
    switch(text.className) {
        case "georgia":
            text.className = "arial";
            break;
        case "arial":
            text.className = "courierNew";
            break;
        case "courierNew":
            text.className = "georgia";
            break;      
    }
};
</script> 
```

*你不再需要这个了，所以删除它：*

```
var text = document.getElementById("go");
var on = document.getElementById("on");
var off = document.getElementById("off"); 
```

这是动态代码，意思是运行通用且不直接处理元素的 JS 代码。我喜欢这种方法，而不是为每个 div 元素定义一个自己的函数。;)

# java - 根据 o2 对应的 getter 设置 o1 的所有 setter

> ID：14666927
> 
> 赞同：2
> 
> 时间：2013-02-02T21:54:12.597
> 
> 标签：java, idioms

在 Java 中，我有一个方法可以`to`根据 object 的相应属性修改 object 的属性`from`。

```
public static void shape(SomeType from, SomeType to) {
    to.setA( from.getA() );
    to.setB( from.getB() );
    to.setC( from.getC() );
    ...
} 
```

我可以想象，这个任务/习语在软件开发中经常出现，以至于它都被赋予了一个名称，并且还有可以为我自动完成它的现有库。你知道任何这样的图书馆吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:17:07.653

我不想要这样的图书馆。你的对象最终可能会有很多意想不到的状态。正如其他人所说，使用复制构造函数。

一般来说，如果您负担得起，请在转换状态时争取不变性。它通常使对问题的推理更容易，并降低副作用的风险。一个很好的例子是[joda time](http://joda-time.sourceforge.net/)，它大量使用了不变性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T22:03:51.143

通常的做法是使用复制构造函数或复制方法。

```
public SomeType(SomeType other)
{
  a = other.a;
  b = other.b;
  c = other.c;
}

public void copy(SomeType other)
{
  a = other.a;
  b = other.b;
  c = other.c;
} 
```

我不确定是否有人会在实践中真正做到这一点，但理论上你可以使用反射来自动化这个过程（[getMethods](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getMethods%28%29)可能是一个好的开始）。除了可能的性能问题（不知道这有多快）之外，我想的主要问题是这可能会导致您不希望复制的数据被复制，当多人处理相同的代码时尤其可能发生这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T22:07:05.910

我不认为有一个通用的解决方案。也许[AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)可以提供帮助，但这可能是一个不好的做法。

如果要复制对象的所有数据并且它们属于同一类，则该类的实现者可能会实现 Cloneable 接口，您只需调用 clone()。

如果类不同，那么只有您知道应该将源对象的哪些成员复制到目标对象的哪些成员。一个接一个地复制它们是最简单和最易读的方法。

还有一个成员的“浅”或“深”副本的问题，超出了问题的范围，但值得记住。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T22:10:03.123

这已经在这里问了。查看[Copy all values from fields in a class to another through reflection](https://stackoverflow.com/questions/1667854/copy-all-values-from-fields-in-one-class-to-another-through-reflection)。

我使用过推土机——但又回到使用@dukeling 提到的复制构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T22:18:46.747

尝试实现可克隆接口

```
public class SomeType implements Cloneable {
    private String a;

    public String getA() {
        return a;
    }

    public void setA(String a) {
        this.a = a;
    }

    public Object clone() {
        try {
            return super.clone();
        } catch(CloneNotSupportedException e) {
            System.out.println("Cloning not allowed.");
            return this;
        }
    } 
} 
```

你可以测试这个::

```
public class Test {

    public static void main (String args[]) {
        SomeType a = new SomeType();
        SomeType b = (SomeType) a.clone();
        if ( a == b ) {
            System.out.println( "yes" );
        } else {
            System.out.println( "no" );
        }
    } 
```

}

是的，如果对象类型不同，您可以尝试使用反射，但请记住，属性的名称必须相同

这就是使用反射的答案，使用此类，您可以将所有参数从一个对象传递到另一个对象，无论类型如何，只要方法和属性的名称相同即可。

```
package co.com;

import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class SetAttributes {

public static String capitalize( String word ) {
    return Character.toUpperCase( word.charAt( 0 ) ) + word.substring( 1 );
}

public static void setAttributes( Object from, Object to ) {
    Field [] fieldsFrom = from.getClass().getDeclaredFields();
    Field [] fielsdTo = to.getClass().getDeclaredFields();
    for (Field fieldFrom: fieldsFrom) {
        for (Field fieldTo: fielsdTo) {
            if ( fieldFrom.getName().equals( fieldTo.getName() ) ) {
                try {
                    Method [] methodsTo = to.getClass().getDeclaredMethods();
                    for ( Method methodTo: methodsTo ) {
                        if ( methodTo.getName().equals( "set" + capitalize( capitalize( fieldTo.getName() ) ) ) ) {
                            Method methodFrom = from.getClass().getDeclaredMethod( "get" + capitalize( fieldFrom.getName() ), null );
                            methodTo.invoke(to, methodFrom.invoke( from, null ) );
                            break;
                        }
                    }
                } catch (SecurityException e) {
                    e.printStackTrace();
                } catch (NoSuchMethodException e) {
                    e.printStackTrace();
                } catch (IllegalArgumentException e) {
                    e.printStackTrace();
                } catch (IllegalAccessException e) {
                    e.printStackTrace();
                } catch (InvocationTargetException e) {
                    e.printStackTrace();
                }
            }
            System.err.println( fieldFrom );
        }
    }
}

public static void main (String args[]) {
    SomeType a = new SomeType();
    SomeType b = new SomeType();
    a.setA( "This" );
    setAttributes( a, b );
    System.err.println( b.getA() );
}

} 
```

# javascript - 为什么 scrollWidth 在这种情况下在 Firefox 中不起作用？

> ID：14666931
> 
> 赞同：2
> 
> 时间：2013-02-02T21:54:34.370
> 
> 标签：javascript, cross-browser

我正在尝试在 Javascript 中制作一个简单的选取框，并且需要在以下内容中获取***innerDIV*****的完整内容宽度***：*

 *```
<div id="container" style="width: 100%; overflow: hidden;">
    <div id="innerDiv" style="direction: rtl; white-space: nowrap; overflow: visible; position: relative;">
        very long ... text
    </div>
</div> 
```

我试过**scrollWidth**。它在 Chrome 中运行良好，**但在 Firefox**中运行良好（它提供了 clientWidth 的值）。

这是一个现场演示： http: [//jsfiddle.net/5fPGy/3/](http://jsfiddle.net/5fPGy/3/)（用 Chrome 和 Firefox 试试）

有谁知道为什么？以及如何获得全宽？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T12:51:53.623

我有同样的问题，我找到了你的问题的答案。这是 Firefox 中的一个错误：[https](https://bugzilla.mozilla.org/show_bug.cgi?id=833542) ://bugzilla.mozilla.org/show_bug.cgi?id=833542 。

Firefox 为 scrollWidth 返回 clientWidth 值。它应该在 Firefox 21 中修复。

现在，我使用了一种解决方法来在 Firefox 上获得正确的滚动宽度：将溢出设置为隐藏，获取正确的滚动宽度并将溢出恢复为可见。请参阅：http: [//jsfiddle.net/5fPGy/5/](http://jsfiddle.net/5fPGy/5/)

```
var scrollWidth = $(ele).css("overflow", "hidden")[0].scrollWidth;
alert('clientWidt h = ' + ele.clientWidth + ',  scrollWidth = ' + scrollWidth  );
$(ele).css("overflow", "visible"); 
```

祝你好运，

安德烈

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-22T18:54:11.233

这似乎可以解决问题：

```
docWidth = Math.max(
        Math.max(frameDoc.body.scrollWidth, frameDoc.documentElement.scrollWidth),
        Math.max(frameDoc.body.offsetWidth, frameDoc.documentElement.offsetWidth)                               
); 
```*

# javascript - 使用 Javascript 和 Jquery 从 HTML 中转义括号

> ID：14666940
> 
> 赞同：0
> 
> 时间：2013-02-02T21:55:49.007
> 
> 标签：javascript, jquery, regex

我正在尝试获取括号中的一些数据的值。这是我的 Javascript 代码。

```
var info = $('.printedsubtext:first');
re = /\((.*)\)/i;
console.log(info.match(re)[1]);​ 
```

.printedsubtext 看起来像这样（注意后面有一个空的 div，所以我选择了第一次出现）

```
<div class="printedsubtext" style="margin-top: 10px;"> 
<strong>Merchant SKU:</strong> 155687<br> 
<strong>ASIN:</strong> B009NFT9PK<br>
<strong>Listing ID:</strong> 1009MIKWRIP<br>
<strong>Order-Item ID:</strong> 02975468341162<br>
<strong>Condition:</strong> Used - Good<br>
<strong>Comments:</strong> Publisher: Thomas Y. Crowell&amp;lt;br&amp;gt;Date of Publication: 1973&amp;lt;br&amp;gt;Binding: hard cover&amp;lt;br&amp;gt;Edition: &amp;lt;br&amp;gt;Condition: Good/Fair&amp;lt;br&amp;gt;Description: (M481)&amp;lt;br&amp;gt;<br>
<div class="printedsubtext" style="margin-top: 10px;">
</div>
</div> 
```

我希望代码将 M481 打印到控制台中。

但是，这会产生语法错误。出于某种原因，如果我将信息替换为这样的东西，它会起作用

```
var info = "Cats make (me) happy"; 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:58:07.743

`match`是一个字符串的方法；您正在从 jQuery 集合中调用它。尝试使用所选元素的文本。

如果你想在搜索中包含 HTML，你应该使用：

```
var info = $('.printedsubtext:first').html(); 
```

如果您只想考虑文本节点，请使用：

```
var info = $('.printedsubtext:first').text(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:44:08.343

这应该有效：

```
var txt = $(".printedsubtext").text();
re = txt.match(/\((.+)\)/);
alert(re[1]); 
```

# inheritance - ASP.NET MVC 根据模型的类型加载部分视图

> ID：14666944
> 
> 赞同：1
> 
> 时间：2013-02-02T21:56:07.587
> 
> 标签：inheritance, asp.net-mvc-4, partial-views

我有一个 ViewModel 对象，其中包含 Vehicle 类型的属性。此类型是基本类型，可以从其他类型（如 Car 或 Truck）继承。

现在我的视图绑定到这个 ViewModel 并且对于 Vehicle 属性，我想使用部分视图。根据 Vehicle 属性的类型，只有这个视图看起来会有所不同。

实现这一目标的最佳（最简洁）方法是什么？我应该直接检查 Razor 中的类型并加载适当的局部视图吗？这听起来不太聪明....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:47:44.130

您可以使用编辑器模板。我编写了[`example here`](https://stackoverflow.com/a/6485552/29407)一个抽象的基本视图模型，并为模型的每种具体类型提供了不同的编辑器模板。所以基本上你可以使用编辑器模板而不是使用部分视图，ASP.NET MVC 将根据你的视图模型的运行时类型自动呈现正确的模板。

# ruby-on-rails - 使用 has_many 与用户的两种类型的关联，:through

> ID：14666954
> 
> 赞同：0
> 
> 时间：2013-02-02T21:56:58.430
> 
> 标签：ruby-on-rails, rails-activerecord

我有一个模型用户。用户可以拥有一个对象。用户还可以相互发送对象。我正在尝试访问用户的所有“发件人”，以便我可以访问 @user.senders 并获取该用户的所有唯一发件人。这是我的设置：

```
class Object < ActiveRecord::Base
  belongs_to :user

  has_many :senders, through: :object_relationships, source: :user, class_name: "User"
  has_many :object_relationships
end

class User < ActiveRecord::Base
  has_many :owned_objects, inverse_of: :user

  has_many :objects, through: :object_relationships
  has_many :object_relationships
end

class ObjectRelationship < ActiveRecord::Base
  belongs_to :user
  belongs_to :object
end 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:05:49.887

```
class Gift < ActiveRecord::Base
  belongs_to :user

  has_many :gift_senders    
  has_many :senders, through: :gift_senders, source: :user
end

class User < ActiveRecord::Base
  has_many :sent_gifts, class_name: 'Gift', foreign_key: :user_id

  has_many :gift_senders    
  has_many :accepted_gifts, through: :gift_senders, source: :gift
end

class GiftSender < ActiveRecord::Base
  belongs_to :user
  belongs_to :gift
end 
```

为了避免混淆，我已将您的模型重命名为礼物。

# php - in_array 对严格选项感到困惑

> ID：14666955
> 
> 赞同：0
> 
> 时间：2013-02-02T21:57:11.113
> 
> 标签：php

当我使用严格选项（我被认为是最好的选择，因为我正在将数字与数字进行比较）时，如果永远不会成真。但没有严格它工作正常！我只是在检查数组是否已经包含 post_id。如果不添加，如果是，则不添加重复项。

```
if (!in_array($post->ID, $cookie_value)) {  
    array_unshift($cookie_value, $post->ID);
}

print_r($cookie_value);

Array ( [0] => 25 [1] => 1 ) 
```

那么这里的交易是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T03:12:04.750

Why use strict in the first place, especially if without strict it works just fine? If the string "2" is in the array, don't you want it to match the number 2? Unless your goal is to for example have both the string "2" and the number 2 in the array

There are very few times where I care about what type PHP thinks a variable is. The way PHP implements [type juggling](http://php.net/manual/en/language.types.type-juggling.php), I usually don't have to care.

I don't think you want to use strict.

# iphone - iOS中响应触摸的不规则区域

> ID：14666968
> 
> 赞同：1
> 
> 时间：2013-02-02T21:59:07.110
> 
> 标签：iphone

假设我有一张按地区划分的国家/地区地图，例如[http://www.understandingitaly.com/regions.html](http://www.understandingitaly.com/regions.html)将这些区域“转换”为“可触摸”区域的最佳方法是什么，当我点击一个时会响应并通知他们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:10:18.660

如果您将您的国家/地区绘制为贝塞尔路径（例如使用`UIBezierPath`），您可以使用该`containsPoint:`方法检查您绘制的特定路径是否包含触摸位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:05:23.953

这是我在stackoverflow上的第一个答案。

我会尝试做这样的事情：

使用 region (x, y) 尝试为每个区域设置一个“可触摸”区域。

找出每个区域的 (x, y) 中心点是什么。然后，根据给定的中心点定义一个矩形区域。

# amazon-web-services - 为什么 CloudFront 会根据 Accept-Encoding 改变 CORS 标头响应？

> ID：14666971
> 
> 赞同：17
> 
> 时间：2013-02-02T21:59:19.367
> 
> 标签：amazon-web-services, amazon-s3, cross-domain, cors, amazon-cloudfront

我正在尝试让 CORS 与 Amazon S3 + CloudFront 一起正常工作。

设置我的 CORS 配置后，它似乎工作正常：

```
$ curl -H "Origin: https://app.close.io" -I "https://d4389n07pf8cq.cloudfront.net/built/app.9e1f9ee9.js" -s | grep Access  
Access-Control-Allow-Origin: https://app.close.io
Access-Control-Allow-Methods: GET, HEAD
Access-Control-Max-Age: 3000
Access-Control-Allow-Credentials: true 
```

但是，当请求资源时，`Accept-Encoding: gzip`不会正确返回 CORS 标头。

```
$ curl -H "Origin: https://app.close.io" -H "Accept-Encoding: gzip" -I "https://d4389n07pf8cq.cloudfront.net/built/app.9e1f9ee9.js" -s | grep Access 
(nothing) 
```

这是为什么？

我的 CORS 配置如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <CORSRule>
        <AllowedOrigin>https://app.close.io</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
        <AllowedMethod>HEAD</AllowedMethod>
        <MaxAgeSeconds>3000</MaxAgeSeconds>
        <AllowedHeader>Authorization</AllowedHeader>
        <AllowedHeader>Content-*</AllowedHeader>
        <AllowedHeader>Host</AllowedHeader>
        <AllowedHeader>Accept-Encoding</AllowedHeader>
    </CORSRule>
</CORSConfiguration> 
```

（我还尝试了`Accent-Encoding`删除标头的 CORS 配置。）

`Content-Encoding: gzip`S3 对象本身已压缩，并具有、`Cache-Control: public, max-age=31536000`和的“元数据” `Content-Type: application/javascript`。

我不明白为什么 CloudFront+S3 CORS 在请求 gzip 时无法正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T08:52:42.030

我认为您遇到的问题是由于 CloudFront 缺乏对 CORS 的本机支持引起的。目前，他们不支持在 Origin 标头上进行 Vary，因此 CloudFront 可能会为您的第二个请求提供一个旧的缓存响应，该响应没有正确的 CORS 标头（接受编码：gzip）。

请查看 AWS 论坛上的此主题，了解缺少 CORS 支持的解决方法：

[https://forums.aws.amazon.com/message.jspa?messageID=422504#422532](https://forums.aws.amazon.com/message.jspa?messageID=422504#422532)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-27T19:46:16.667

2014 年 6 月 26 日，AWS[在 CloudFront 上发布了正确的 Vary: Origin 行为，](http://aws.amazon.com/about-aws/whats-new/2014/06/26/amazon-cloudfront-device-detection-geo-targeting-host-header-cors/)因此我[在这个问题上添加了一些说明，以](https://stackoverflow.com/a/24459590/2483)反映我们如何正确设置它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T23:04:27.037

这可能对您有所帮助，因为我已成功让 CORS 在 S3 和 Cloudfront 上工作。我注意到 S3 和 Cloudfront 第一次提取文件时，它们几乎会缓存标题，即使在您更改它们之后也是如此。确保启用“查询参数”版本控制，您可以添加`?v=1`到文件末尾。这为我们“更新”了标题，CORS 一切都很好。

# visual-studio-2010 - 有没有办法在 Visual Studio 中模拟 Sublime Text 的“多光标”功能？

> ID：14666973
> 
> 赞同：19
> 
> 时间：2013-02-02T21:59:35.293
> 
> 标签：visual-studio-2010, sublimetext2, visual-studio-express

有没有办法在 Visual Studio 中模拟 Sublime Text 的“多光标”功能？

我知道您可以在 Visual Studio 中使用 ST2 作为外部编辑器，但我不确定这在 Express Edition 中是否可行。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-07T16:29:40.433

看看[这个新的 Visual Studio 插件，它带来了你想要](http://www.hanselman.com/blog/SimultaneousEditingForVisualStudioWithTheFreeMultiEditExtension.aspx)的，它支持自 2010 年以来的所有版本的 Visual Studio。

![在 VS 中显示多重编辑](../Images/b2af4a77359efc8db04c97ab06056dd6.png)

由于 Visual Studio Express 不支持加载项，因此无法在 express 版本上启用此功能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-04-18T16:51:20.560

更新！在 VS 2019 中，我们可以使用`ctrl+alt+click`. 此外，它还带来了旧的块选择 ( `alt+mouse selection`) 和其他选项，如`Edit>Multiple Insertion Symbols`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-03T12:27:48.917

唯一真正的 Sublime Text 等价物是[MixEdit](https://visualstudiogallery.msdn.microsoft.com/f301cf82-e80b-4b92-9e5c-ef7985ae6702)。

[![在此处输入图像描述](../Images/bcdbff5cc4d5925a87181a0de83b52da.png)](https://i.stack.imgur.com/TMRK3.gif)

虽然它不是免费的。[您可以以 9 美元的价格购买它](http://www.codinglabs.net/BuyMixEdit.aspx)，这是一次千载难逢的付款。

你可以使用这个[快速指南](http://www.codinglabs.net/MixEdit.aspx)，但如果你来自 Sublime，命令非常直观。

更新：不想付钱？刚刚意识到您可以在提示注册时单击<*取消>。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-30T11:26:22.587

还有另一个名为[*MixEdit*](http://www.codinglabs.net/MixEdit.aspx)的扩展程序提供了比*MultiEdit*更多的功能，但它是[商业](http://www.codinglabs.net/BuyMixEdit.aspx)版的试用版。

*（我与作者无关）*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-27T18:52:58.633

VS 社区 2019

`shift + alt + .`下一场比赛

`shift + alt + ;`对于所有比赛

# php - PHP PDO 函数 lastInsertId 和竞争条件

> ID：14666974
> 
> 赞同：6
> 
> 时间：2013-02-02T21:59:35.380
> 
> 标签：php, mysql, pdo

假设在我的系统中，用户**U1在表****A**中创建了一个新的数据库条目，我使用**lastInsertId**函数来获取该条目的 ID（auto_increment 字段），但几乎同时（稍后）另一个用户**U2**也做了同样的事情.

在这种情况下，**lastInsertId**是否会为**U1**返回另一个用户添加的条目的 ID，因为它是最新的？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T22:15:31.243

我相信你应该只担心竞争条件，以防你为不同的线程使用单个连接。如果您为每个请求使用不同的连接，您应该没问题。查看[http://dev.mysql.com/doc/refman/5.0/en/getting-unique-id.html](http://dev.mysql.com/doc/refman/5.0/en/getting-unique-id.html)了解更多详情。

# java - 来自 ExceptionTranslator 的异常不会返回到 flex

> ID：14666983
> 
> 赞同：1
> 
> 时间：2013-02-02T22:00:36.890
> 
> 标签：java, spring, apache-flex, spring-security, blazeds

我正在使用 Flex + Blazeds + Spring Security。我的 ExceptionTranslator 发生了一些奇怪的事情。

```
public class ProjectExceptionTranslator implements ExceptionTranslator {

   @Override
   public boolean handles(Class<?> arg0) {
        return true;
   }

   @Override
   public MessageException translate(Throwable throwable) {
        MessageException exception = new MessageException();

        if (throwable instanceof BadCredentialsException) {
            exception.setCode("08");
            exception.setMessage("Login error.");
        }

        if (throwable instanceof HibernateException) {
            exception.setCode("16");
            exception.setMessage("Data base error.");
        }

    return exception;
  } 
```

}

spring 抛出的所有消息，例如：BadCredentialsException，都返回到 flex。但是，如果我的服务抛出一些 ex：HibernateException，它不会返回到 flex。

这是我的配置：

```
<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />

<bean
    class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" />

<flex:message-broker>                       
    <flex:exception-translator ref="projectExceptionTranslator" />
    <flex:secured />
</flex:message-broker> 
```

我错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:39:49.560

我通过重新安装 Flash Builder 解决了这个问题。

# c++ - Project Euler 19 中的 Off-by 1 错误

> ID：14666985
> 
> 赞同：-1
> 
> 时间：2013-02-02T22:00:45.937
> 
> 标签：c++, math

我正在做[Project Euler #19](http://projecteuler.net/problem=19)。如果您只想逐月循环并应用一些高中模运算，这显然是一个微不足道的问题，但我正在尝试一种不同的方法只是为了好玩。

我注意到 1901 年 1 月/2 月 1 日不是星期日，2001 年 1 月/2 月 1 日也不是，因此我可以将我的日历年视为从 3 月 1 日开始。使用基本的模运算，很容易看出如果闰年不存在，那么给定年份中的 X 天数是重复序列 {2,2,2,1,2,1,2}，因为 365 等于 1（模 7）。因此，考虑闰年会导致序列中出现 2 个元素的跳跃。所以我写了这段代码来完成这个问题：

```
const unsigned s[7] = {2,2,2,1,2,1,2};
unsigned n = 0;  
unsigned y = 1901;
unsigned c = 0;
do {
    c=c%7;
    n+=s[c];
    ++y; 
    c += ((y%4!=0)||(y%400==0) ? 1 : 2); 
} while (y<2001);
std::cout << n << std::endl; 
```

但是我得到 172，答案是 171。有人知道我哪里出错了吗？

注意：请不要留下 1200/7 评​​论。

固定：替换为`c += ((y%400==0)||((y%4==0)&&(y%100!=0)) ? 2 : 1);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:27:34.497

**编辑**：关于闰年规则。

闰年规则还有*一种*特殊情况。

一年是闰年，如果它是：

*   可被四除
    *   但不能被 100 整除
        *   除非它也能被 400 整除

有时我希望我们有公制日历。兆秒和千秒，有人知道吗？

* * *

也许你对闰年规则有点困惑？

从您的链接：

> 闰年出现在任何能被 4 整除的年份，但不会出现在世纪，除非它能被 400 整除。

所以能被400整除的年份*就是*闰年。您的代码中的条件是相反的。

# java - .equals 不使用扫描仪

> ID：14666986
> 
> 赞同：0
> 
> 时间：2013-02-02T22:00:53.973
> 
> 标签：java, minecraft, bukkit

我知道它正在读取文件，因为我让它将 txt 文件的内容打印到控制台，但每次我尝试 .equals 时，变量都不会更改为 true/false，只是保持 true 有什么想法吗？

```
public static void readWebPage() {
      URLConnection connection;
      try {
       connection = new URL("https://dl.dropbox.com/u/40562795/List.txt").openConnection();
       @SuppressWarnings("resource")
       Scanner scanner = new Scanner(connection.getInputStream());
       scanner.useDelimiter("\\z");
       String text = scanner.next();
        System.out.println(text);
        if(text.equals("stop")){
            stop = true;
            System.out.println("Successfully stopped.");
        }else{ if(text.equals("-"))
            stop = false;
            System.out.println("Successfully started.");
        }
      } catch (MalformedURLException e) {
       e.printStackTrace();
      } catch (IOException e) {
       e.printStackTrace();
      }
 } 
```

*编辑：*

那行得通，它现在可以读取它，但是我的变量没有更新为真/假。它保持在 true 左右，这在控制台中说。

```
if(stop = false){
    System.out.println("stop = false.");
}else
if(stop = true){
    System.out.println("stop = true.");
} 
```

我的变量是如何制作的：

```
 public static boolean stop = false; 
```

这就是我制作变量的方式，它应该 = false 但停止也不 - 更改它。我在我的 java 文件中搜索了可能触发它的东西，但找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:06:30.740

`-`远程文本文件中的字符后有一个尾随空格。您可以使用空格分隔符而不是行终止符分隔符。代替

```
scanner.useDelimiter("\\z"); 
```

和

```
scanner.useDelimiter("\\s+"); 
```

以便您的支票`text`与您的`.equals`支票相符。

**编辑：**

从编辑中，您的`if`语句表达式中有一个赋值：

```
if (stop = false) { 
```

用。。。来代替

```
if (stop == false) { 
```

或更好

```
if (!stop) { 
```

总的来说，这个`if`语句是不必要的，你可以简单地写

```
System.out.println("stop = " + stop); 
```

# javascript - 暂停 Web Audio API 声音播放

> ID：14666987
> 
> 赞同：4
> 
> 时间：2013-02-02T22:01:00.290
> 
> 标签：javascript, html, audio, web-audio-api

如何为我的音频创建暂停功能？我在下面的脚本中已经有了一个播放功能。

[http://pastebin.com/uRUQsgbh](http://pastebin.com/uRUQsgbh)

```
function loadSound(url) {
    var request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.responseType = 'arraybuffer';

    // When loaded decode the data
    request.onload = function() {

        // decode the data
        context.decodeAudioData(request.response, function(buffer) {
            // when the audio is decoded play the sound
            playSound(buffer);
        }, onError);
    }
    request.send();
}

function playSound(buffer) {
    sourceNode.buffer = buffer;
    sourceNode.noteOn(0);
} 
```

但是我怎样才能暂停或停止呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T19:53:02.800

简短的回答是“你不能暂停它——正如 idbehold 所说，你可以通过调用 sourceNode.noteOff(0); 来停止它”。

您不能暂停它，原因与音频电缆上没有“暂停”按钮的原因相同——因为数据一直在通过它。您可以实现一个可以暂停的记录器节点，但在某些时候，如果您不取消暂停，它将缓冲大量数据。

实现这个场景的常用方法是跟踪你在播放中的位置（例如，通过记住你开始的时间），然后当你想暂停时记住那个偏移量，调用 noteOff(0)，然后当你想重新开始播放创建一个指向相同缓冲区的新节点并使用偏移量调用 noteOnGrain。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T22:59:30.500

问题`noteOff(0)`在于它会破坏`AudioNode`，因此您将无法使用来暂停音频。相反，您可以简单地断开连接`sourceNode`，这将有效地暂停音频。要恢复播放，只需重新连接即可。由于您的代码连接`sourceNode`到`analyser`：

```
function pause() {
    sourceNode.disconnect();
}

function resume() {
    sourceNode.connect(analyser);
} 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-12T17:45:08.300

在分配缓冲区之前，您已经创建了一个可以使用上下文的 bufferSource。创建bufferSource的方法是“createBufferSource” => context.createBufferSource。创建 bufferSource 后，您使用“context.destination”=> source.connect(context.destination); 创建了一个 conexion。全部，现在要播放，对现代浏览器使用 start(0)，对旧浏览器使用 noteOn(0)

```
function loadSound() {
   xhr = new XMLHttpRequest();
   xhr.open('GET', url, true);
   xhr.responseType = 'arraybuffer';
   xhr.onload = function () {
       /* Processing response data - xhr.response */
       /* Decoding audio data. */
       var context = new webkitAudioContext();
       context.decodeAudioData(xhr.response, function onSuccess (buffer) {
           if (! buffer) {
               alert('Error decoding file data.');
               return;
           }
           var source = context.createBufferSource(); /* Create SourceNode. */
           source.buffer = buffer; /* buffer variable is data of AudioBuffer type from the decodeAudioData() function. */
           source.connect(context.destination); /* Connect SourceNode to DestinationNode. */
           source.start(0); /* Play sound. */
       }, function onError (error) {
           alert('Error decoding file data.');
       });

   };
    xhr.onerror = function () {
        /* Handling errors */
        console.log('error');
    };
    xhr.send();
} 
```

# linux-kernel - 如何在内核模块中使用 DebugFS blob 包装器

> ID：14666991
> 
> 赞同：2
> 
> 时间：2013-02-02T22:01:57.493
> 
> 标签：linux-kernel, kernel, kernel-module

我试图找到将**大**数据从内核移动到用户空间的**最快**方法。现在我正在尝试 GKH 的 debugfs，但我正在努力让 blob 包装器工作。

 **这是我到目前为止得到的：

```
#include <linux/module.h>
#include <linux/moduleparam.h>
#include <linux/init.h>
#include <linux/kernel.h>
#include <linux/types.h>
#include <linux/debugfs.h>

MODULE_AUTHOR("CREED0R");
MODULE_LICENSE("GPL");

struct dentry *dfs;
struct debugfs_blob_wrapper *myblob;

int my_init(void)
{
    int stats[10];
    int i;

    for (i = 0; i < 10; i++)
        stats[i] = i;

    myblob->data = (void *) stats;
    myblob->size = (unsigned long) 10;

    dfs = debugfs_create_blob("test", 0644, NULL, myblob);

    if (dfs == NULL) {
        printk("Could not create debugfs blob\n");
        return 1;
    }

    printk("DebugFS file created\n");

    return 0;
}

void my_exit(void)
{
    printk("DebugFS file deleted\n\n");
    debugfs_remove(dfs);
}

module_init(my_init);
module_exit(my_exit); 
```

它可以构建，但是如果我运行 insmod，我的 qemu 实例会死得很惨。

不知道为什么会这样。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T09:14:25.423

谢谢你的帮助。我只是忘记为 blob 结构获取内存，因此设置数据和大小指针不可避免地会杀死它。

这是正确的版本，将 32K' 的 u32 从内核泵入用户空间。它使用 2.6.32.38 内核构建：

```
#include <linux/module.h>
#include <linux/moduleparam.h>
#include <linux/init.h>
#include <linux/kernel.h>
#include <linux/types.h>
#include <linux/debugfs.h>

#define SIZE 8192

MODULE_AUTHOR("CREED0R");
MODULE_LICENSE("GPL");

struct dentry *dfs;
struct debugfs_blob_wrapper *myblob;

u32 *stats; /* our blob of data */

int my_init(void)
{
    int i;
    int stats_size;   /* size of our data */
    int struct_size;  /* size of the blob struct */

    struct_size = sizeof(struct debugfs_blob_wrapper);
    stats_size  = SIZE * sizeof(u32);

    /* get mem for data */
    stats = kmalloc(stats_size, GFP_KERNEL);

    if (stats == NULL) {
        printk("Could not allocate mem for data\n");
        return -ENOMEM;
    }

    /* fill datablob with dummy data */
    for (i = 0; i < SIZE; i++)
        stats[i] = i;

    /* get mem for blob struct and init */
    myblob = (struct debugfs_blob_wrapper *) kmalloc(struct_size, GFP_KERNEL);

    if (myblob == NULL) {
        printk("Could not allocate mem for blob\n");
        kfree(stats);
        return -ENOMEM;
    }

    /* only set data pointer and data size */
    myblob->data = (void *) stats;
    myblob->size = (unsigned long) stats_size;

    /* create pseudo file under /sys/kernel/debug/ with name 'test' */
    dfs = debugfs_create_blob("test", 0644, NULL, myblob);

    if (dfs == NULL) {
        printk("Could not create debugfs blob\n");
        kfree(stats);
        kfree(myblob);
        return -EINVAL;
    }

    printk("DebugFS file created\n");

    return 0;
}

void my_exit(void)
{
    printk("DebugFS file deleted\n\n");

    kfree(myblob);
    kfree(stats);

    debugfs_remove(dfs);
}

module_init(my_init);
module_exit(my_exit); 
```**

# database - 小规模“Kijiji”的数据库设置

> ID：14666992
> 
> 赞同：0
> 
> 时间：2013-02-02T22:02:06.137
> 
> 标签：database, performance, indexing

是将大量数据分成不同的表更好还是将它们全部聚集到一个表中更好。

这对索引和性能有何影响？

前任。假设我有很多数据，比如 kijiji 帖子。将每个按类别标记的表的帖子分开是否更好，或者使用我所有帖子的一张大表并通过标记为类别的列进行索引更容易优化性能。

这是一个学校项目，规模不大。我不是在谈论将我的数据分成块，因为我还不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:12:37.683

除非在极少数情况下，您应该始终将数据标准化为至少第 3 范式。简单（并且有些不正确）这意味着只存储每条数据一次，即多个表。这最大限度地减少了数据损坏的可能性，并且通过适当的索引将很快。

# php - preg_replace 使用数组数据时的简单文本

> ID：14666993
> 
> 赞同：0
> 
> 时间：2013-02-02T22:02:19.927
> 
> 标签：php, preg-replace

假设我有一个简单的文本：

> testing testing testing [http://www.youtube.com/watch?v=pzfAdmAtYIY](http://www.youtube.com/watch?v=pzfAdmAtYIY) 更多测试和随机文本 [http://www.youtube.com/watch?v=UZQ_RDb0lcE](http://www.youtube.com/watch?v=UZQ_RDb0lcE)更多文本等

我也有简单的数组：

```
$arr = array('Samsung Mobile USA - El Plato Supreme', 'SET FIRE | DUBSTEP'); 
```

如何实现这一点：

> testing testing testing pzfAdmAtYIY Samsung Mobile USA - El Plato Supreme 更多测试和随机文本 UZQ_RDb0lcE SET FIRE | DUBSTEP 更多文字等

我的尝试：

```
$count = 0;
$text = 'testing testing testing http://www.youtube.com/watch?v=pzfAdmAtYIY more testing and random text http://www.youtube.com/watch?v=UZQ_RDb0lcE more text etc';
$arr = array('Samsung Mobile USA - El Plato Supreme', 'SET FIRE | DUBSTEP');
$string = preg_replace('/http:\/\/www.youtube.com\/watch\?v=([a-zA-Z0-9_-]*)/ms', ' \\1 '. $arr[$count++].'', $text);
print $string; 
```

结果很不幸：

> testing testing testing pzfAdmAtYIY Samsung Mobile USA - El Plato Supreme 更多测试和随机文本 UZQ_RDb0lcE Samsung Mobile USA - El Plato Supreme 更多文本等

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:17:56.573

[你可以用preg_replace_callback](http://php.net/manual/de/function.preg-replace-callback.php)做这样的事情：

```
$str = 'testing testing testing http://www.youtube.com/watch?v=pzfAdmAtYIY more testing and random text http://www.youtube.com/watch?v=UZQ_RDb0lcE more text etc';

// either like this:
// $arr = array('Samsung Mobile USA - El Plato Supreme', 'SET FIRE | DUBSTEP');
// or via $GLOBALS array
$GLOBALS['arr'] = array('Samsung Mobile USA - El Plato Supreme', 'SET FIRE | DUBSTEP');

$str = preg_replace_callback('/http:\/\/www.youtube.com\/watch\?v=([a-zA-Z0-9_-]*)/ms', function($match) {
    // this is called for each match of the expression

    // sets a counter
    static $count = 0;        

    // making $arr a global variable
    // global $arr;

    // the return value
    // $r = $arr[$count];
    // or in case it is in the $GLOBALS
    $r = $GLOBALS['arr'][$count];
    // increase the counter
    $count++;
    // and return
    return $r;
}, $str);

echo $str; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:07:02.063

preg_replace() ：第二个参数必须是替换数组，因为您的示例遵循以下规则：“如果此参数是字符串且模式参数是数组，则所有模式都将被该字符串替换”。

还要注意正则表达式中的点：它们必须被转义。

结果： $string = preg_replace('regex', $arr, $text);

[http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)

# html - CSS 下拉菜单冲突

> ID：14666995
> 
> 赞同：1
> 
> 时间：2013-02-02T22:02:34.653
> 
> 标签：html, css, drop-down-menu

我最近购买了一个主题，但现在我遇到了下拉菜单的问题。它位于描述框下方。

当我们进入女鞋下方并将鼠标放在“靴子”子菜单上的内容框下方时，请查看此处的网站。 [http://morestore.org/](http://morestore.org/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T22:20:44.263

将此添加到您的CSS：

```
#featured{
    z-index:0;
}

#header{
    z-index:100;
} 
```

您需要向标题添加更高的 z-index，因此它将显示在滑块的上方。`z-index`css 属性是克服许多布局挑战的有效方法。您可以在[Smashing Magazine上阅读更多相关信息](http://coding.smashingmagazine.com/2009/09/15/the-z-index-css-property-a-comprehensive-look/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T22:09:33.593

将 z-index:15 更改为 z-index:5

在

```
.slide .description {

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T22:10:17.043

`#menu`应该`z-index`为您的`.slide .description`. 更改 CSS 文件中的这一行：

```
#menu{position:absolute;bottom:-103px;left:0px;background:url(images/secondary-menu.png) no-repeat;width:961px;height:98px;z-index:10;} 
```

对此：

```
#menu{position:absolute;bottom:-103px;left:0px;background:url(images/secondary-menu.png) no-repeat;width:961px;height:98px;z-index:20;} 
```

我已经在 Chrome 中尝试过了，然后它就可以工作了。您可以为 z-index 设置更高的值，以防您稍后添加其他动态内容，例如您的描述标签，并且它们将在标签上有 z-index ;)

# android - 将 URL 从 WebView 传递给 ShareActionProvider？

> ID：14666998
> 
> 赞同：4
> 
> 时间：2013-02-02T22:02:45.360
> 
> 标签：android, webview, shareactionprovider

我想在我的 WebView 中获取用户用户所在的任何页面，并允许他们与 FaceBook/etc 共享 URL 作为 ACTION_SEND 意图。

我试过了，但显然 onCreateOptionsMenu 中不存在 URL。如何将其移至 onOptionsItemsSelected？

```
private ShareActionProvider mShareActionProvider;
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    // TODO Auto-generated method stub

    return super.onOptionsItemSelected(item);
}
   @Override
public boolean onCreateOptionsMenu(Menu menu) {
     getMenuInflater().inflate(R.menu.activity_main, menu);
     MenuItem item = menu.findItem(R.id.menu_item_share);
     mShareActionProvider = (ShareActionProvider)item.getActionProvider();
     mShareActionProvider.setShareHistoryFileName(
       ShareActionProvider.DEFAULT_SHARE_HISTORY_FILE_NAME);
     mShareActionProvider.setShareIntent(createShareIntent());
     return true;   
}
 private Intent createShareIntent() {
      Intent shareIntent = new Intent(Intent.ACTION_SEND);
            shareIntent.setType("text/plain");
            shareIntent.putExtra(Intent.EXTRA_TEXT, 
          web.getUrl());
            return shareIntent;
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T22:33:31.427

您上面的代码不起作用，因为`onCreateOptionsMenu`仅在第一次显示选项菜单时调用了一次。

解决这个问题很容易。`onOptionsItemSelected`当被调用时，我们正在构建我们的 Intent 。这是选择膨胀菜单的任何资源的时候。如果所选项目是共享资源，`shareURL`则执行现在构建并启动 Intent。

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
public final boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.menu_item_share:
            shareURL();
    }
    return super.onOptionsItemSelected(item);
}

private void shareURL() {
    Intent shareIntent = new Intent(Intent.ACTION_SEND);
    shareIntent.setType("text/plain");
    shareIntent.putExtra(Intent.EXTRA_TEXT, web.getUrl());
    startActivity(Intent.createChooser(shareIntent, "Share This!"));
} 
```

我没有测试上面的代码示例。既不是在实际设备上，也不是在 Java 编译器上。尽管如此，它应该可以帮助您解决问题。