# StackOverflow 问答 14900000-14900999

# python - 我如何比较两个单词列表，更改共同的单词，并在 python 中打印结果？

> ID：14900004
> 
> 赞同：0
> 
> 时间：2013-02-15T17:22:40.050
> 
> 标签：python, python-3.x

如果我有一个字符串列表-

```
common = ['the','in','a','for','is'] 
```

我有一个句子被分解成一个列表-

```
lst = ['the', 'man', 'is', 'in', 'the', 'barrel'] 
```

我如何比较两者，如果有任何共同的单词，然后再次打印完整的字符串作为标题。我有一部分工作，但我的最终结果打印出新更改的公共字符串以及原始字符串。

```
new_title = lst.pop(0).title()
for word in lst:
    for word2 in common:
        if word == word2:
            new_title = new_title + ' ' + word

    new_title = new_title + ' ' + word.title()

print(new_title) 
```

输出：

```
The Man is Is in In the The Barrel 
```

所以我试图得到它，以便共同的小写单词留在新句子中，没有原件，也没有它们变成标题大小写。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:34:39.567

```
>>> new_title = ' '.join(w.title() if w not in common else w for w in lst)
>>> new_title = new_title[0].capitalize() + new_title[1:]
'The Man Is in the Barrel' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:35:54.633

如果您要做的只是查看 的任何元素是否`lst`出现在 中`common`，您可以这样做

```
>>> common = ['the','in','a','for']
>>> lst = ['the', 'man', 'is', 'in', 'the', 'barrel']
>>> list(set(common).intersection(lst))
['the', 'in'] 
```

并检查结果列表中是否包含任何元素。

如果您希望单词 in`common`小写并且您希望所有其他单词大写，请执行以下操作：

```
def title_case(words):
    common = {'the','in','a','for'}
    partial = ' '.join(word.title() if word not in common else word for word in words)
    return partial[0].capitalize() + partial[1:]

words = ['the', 'man', 'is', 'in', 'the', 'barrel']
title_case(words) # gives "The Man Is in the Barrel" 
```

# file - 批处理文件读取空格之间的行集值

> ID：14900006
> 
> 赞同：0
> 
> 时间：2013-02-15T17:22:42.990
> 
> 标签：file, text, batch-file, lines, spaces

我想设置此批处理文件以使用与此类似的内容来读取文本文件中的行。

```
for /f "tokens=* delims= " %%a in (RawData.txt) do (
set /a N+=1
set v!N!=%%a
) 
```

例如，它正在阅读的内容与此类似。

```
20120901 0:00 9 
```

我希望它现在设置 3 个不同的值

```
value1 = 20120901
value2 = 0:00
value3 = 9 
```

假设文本文件中的每一行都有 3 个不同的字符串。我想在两个空格之间设置值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:36:59.773

你已经很接近了。

```
@echo off
setlocal enabledelayedexpansion
set N=0
for /f "tokens=1-3" %%a in (RawData.txt) do (
    set /a N=!N!+1
    call set v!N!=%%a
    set /a N=!N!+1
    call set v!N!=%%b
    set /a N=!N!+1
    call set v!N!=%%c
) 
```

我认为。我没有测试它。RawData.txt中的第一行是 through，`%v1%`第二行是through ，依此类推。`%v3%``%v4%``%v6`

# javascript - 防止 angularjs 应用程序中的重定向行为

> ID：14900008
> 
> 赞同：4
> 
> 时间：2013-02-15T17:22:52.777
> 
> 标签：javascript, angularjs, angularjs-directive

当用户尝试单击浏览器后退按钮并且表单上有脏数据时，它会显示确认。

这是角度js控制器代码

```
 function MyCtrl2($rootScope, $location, $scope) {

    $rootScope.$watch(function () {
        return $location.path();
    },

    function (newValue, oldValue) {
        if ($scope.myForm.$dirty) {
            var a = confirm('do you');
            if (!a) {
                 //how to prevent this redirect
            }
        }
    },
    true);
}

MyCtrl2.$inject = ['$rootScope', '$location', '$scope']; 
```

但是如何防止重定向

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-27T03:05:38.700

仅供参考，现在可以在 Angular 中取消路线。

```
$scope.$on('$locationChangeStart', function(event, newUrl, oldUrl) {
  event.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T21:23:52.610

您要解决的整个问题的根源有两个 DOM 事件：onhashchange 和 onbeforeunload。可以检查和阻止 onhashchange，但是，浏览器上的后退按钮不会触发 onhashchange。更糟糕的是，如果页面没有重新加载，onbeforeunload 将不会触发，这意味着如果您点击返回以转到页面上的上一个哈希，它不会触发。正因为如此，如果您按 Back to 去上一条路线，它仍然会离开您的表格。

目前[在 Angular 的待办事项列表上还有一个悬而未决的问题，](https://github.com/angular/angular.js/issues/592)即他们将如何允许取消路线。我认为哈希问题的后退按钮是目前阻碍它们的原因。

因此，如果您想在表单被编辑后阻止所有导航离开您的表单，那么最后您可能想要重新设计您的解决方案以做一些更激烈的事情。类似于将表单正在编辑的所有数据存储在 $rootScope 中，以及一个表明它脏但不完整的标志，然后将事件处理程序添加到 routeChangeStart 以检查这些值并将您发送回表单。

以下是它的工作原理（[如果你有兴趣的话，还有一个笨拙的人](http://plnkr.co/edit/iSqubpKinYUzrtr9r0q4)）：

```
app.config(function($routeProvider) {
  //set up the routes. (Important because we're going to navigate
  // BACK to them.)
  $routeProvider.when('/Form', {
    controller: 'FormCtrl',
    templateUrl: 'form.html'
  }).otherwise({
    controller: 'HomeCtrl',
    template: '<h3>Home</h3>' 
  });
});

app.run(function($rootScope, $location){ 
  //set up your rootScope formData object.
  $rootScope.formData = {};

  //add a routing event to check the route
  // and whether or not the data has been editted and then 
  // send it back to the proper form.
  $rootScope.$on('$routeChangeStart', function() {
    if($location.path() != '/Form' && $rootScope.formData.dirty && 
      !$rootScope.formData.complete && !confirm('Do you want to leave this form?')) {
      $location.path('/Form');
    }
  });

  //handle outright navigating away from the page.
  $(window).on('beforeunload', function() {
     if($rootScope.formData.dirty && 
      !$rootScope.formData.complete) {
         return 'Are you sure you want to navigate away from this form?';
     }
  });
});

app.controller('FormCtrl', function($scope) {
  $scope.$watch(function (){
    return $scope.myForm.$dirty;
  }, function(dirty) {
    $scope.formData.dirty = $scope.formData.dirty | dirty;
  })
}); 
```

* * *

其他想法

最初我制定了一个指令来帮助解决这个问题，但我意识到由于我上面提到的问题，它不会起作用。无论如何，为了后代的缘故，这里是：

```
app.directive('form', function ($window){
  return {
    restrict: 'E',
    link: function(scope, elem, attrs) {

      //check for a prevent-if-dirty attribute on your form tag
      if(attrs.preventIfDirty !== undefined) {

        // first off, stop routing hash changes from 
        // changing the page.
        scope.$on('$locationChangeStart', function(event) {
          if(scope.testForm.$dirty) {
            event.preventDefault();
          }
        });

        // a little setup for our next piece
        var formName = attrs.name;
        function showWarning() {
          return 'You have changed the form';
        }

        // Now stop browser navigation from moving away
        // from your dirty form.
        scope.$watch(function (){
          return scope[formName].$dirty;
        }, function(dirty) {
          if(dirty) {
             $(window).on('beforeunload', showWarning);
          } else {
             $(window).off('beforeunload', showWarning);
          }
        });
      }
    }
  };
}); 
```

[这是一个展示它的plunker。](http://plnkr.co/edit/4M4nJw9suxnOPgzXuge0?p=preview)

# c# - 如何在 C# 中获取单击 bing 地图的地理位置

> ID：14900010
> 
> 赞同：1
> 
> 时间：2013-02-15T17:23:00.267
> 
> 标签：c#, bing-maps

是否可以获得我`Map`在 c# 中单击 bing 的位置的地理位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T21:36:35.820

好的，由于您在 C# 中使用 WinRT，因此您正在使用 Bing Maps Windows Store App 控件。将地图添加到 XAML 标记中：

```
<Page
    x:Class="Win8PublicApp.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:m="using:Bing.Maps">
    <Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <m:Map Name="MyMap" Credentials="YOURKEY"/>
    </Grid>
</Page> 
```

然后您可以执行此操作以在您单击的位置添加图钉：

```
public MainPage()
{
    this.InitializeComponent();

    this.MyMap.PointerPressedOverride += MyMap_PointerPressedOverride;
}

void MyMap_PointerPressedOverride(object sender, PointerRoutedEventArgs e)
{
    Bing.Maps.Location l = new Bing.Maps.Location();
    this.MyMap.TryPixelToLocation(e.GetCurrentPoint(this.MyMap).Position, out l);
    Bing.Maps.Pushpin pushpin = new Bing.Maps.Pushpin();
    pushpin.SetValue(Bing.Maps.MapLayer.PositionProperty, l);
    this.MyMap.Children.Add(pushpin);
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-15T17:35:10.897

Bing Maps API 使这非常容易。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title></title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>

      <script type="text/javascript">

         var map = null;         

         function GetMap()
         {
            // Initialize the map
            map = new Microsoft.Maps.Map(document.getElementById("myMap"),
                         {credentials:"Bing Maps Key"}); 

            //Add handler for the map click event.
            Microsoft.Maps.Events.addHandler(map, 'click', displayLatLong);

         }

          function displayLatLong(e) {
              if (e.targetType == "map") {
                  var point = new Microsoft.Maps.Point(e.getX(), e.getY());
                  var loc = e.target.tryPixelToLocation(point);
                  document.getElementById("textBox").value= loc.latitude + ", " + loc.longitude;

              }
          }

      </script>
   </head>
   <body onload="GetMap();">
      <div id='myMap' style="position:relative; width:400px; height:400px;"></div><br>
      <b>Click the map to display the coordinate values at that point.</b><br>
      Latitude, Longitude:       
      <input id='textBox' type="text" style="width:250px;"/>
   </body>
</html> 
```

来源：[MSDN 上的必应地图 API](http://msdn.microsoft.com/en-us/library/gg508988.aspx)

# php - 如何使用 Codeigniter 删除上传的文件？

> ID：14900012
> 
> 赞同：5
> 
> 时间：2013-02-15T17:23:24.207
> 
> 标签：php, codeigniter, upload

我使用 Codeigniter 的上传类将图像上传到项目中的文件夹。在数据库中我只存储上传图片后生成的url，所以当我想删除数据库中的一行时，我还需要删除图片。我怎样才能在codeigniter中做到这一点？

我将不胜感激您的回答。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-16T04:07:02.887

您可以使用此功能删除给定路径中的所有文件，例如`uploads`文件夹中的所有文件，该`deleteFiles()`功能可能位于您的模型之一中：

```
$path = $_SERVER['DOCUMENT_ROOT'].'/uploads/';

function deleteFiles($path){
    $files = glob($path.'*'); // get all file names
    foreach($files as $file){ // iterate files
      if(is_file($file))
        unlink($file); // delete file
        //echo $file.'file deleted';
    }   
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-16T03:59:36.950

```
delete_row_from_db(); unlink('/path/to/file'); 
```

/path/to/file 必须是真实路径。

例如：

如果您的文件夹是这样的 htp://example.com/uploads

$path = **realpath** (APPPATH . '../uploads');

**APPPATH = 应用程序文件夹的路径。**

它的工作...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T04:52:48.170

if(isset($_FILES['image']) && $_FILES['image']['name'] != '') {

```
 $config['upload_path']   = './upload/image'; 
            $config['allowed_types'] = 'jpeg|jpg|png';
            $config['file_name']    = base64_encode("" . mt_rand());
            $this->load->library('upload', $config);

            $this->upload->initialize($config); 

            if (!$this->upload->do_upload('image')) 
            {
                $error = array('error' => $this->upload->display_errors());
                $this->session->set_flashdata('msg', 'We had an error trying. Unable upload  image');
            } 
            else 
            { 
                $image_data = $this->upload->data();
                @unlink("./upload/image/".$_POST['prev_image']);
                $testData['image'] = $image_data['file_name'];
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-21T06:28:04.910

```
$m_img_real= $_SERVER['DOCUMENT_ROOT'].'/images/shop/real_images/'.$data['settings']->shop_now;
$m_img_thumbs = $_SERVER['DOCUMENT_ROOT'].'/images/shop/thumbs/'.$data['settings']->shop_now;

if (file_exists($m_img_real) && file_exists($m_img_thumbs)) 
{
     unlink($m_img_real);
     unlink($m_img_thumbs);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-27T13:44:18.267

看法：

```
<input type="file" name="new_file" data-required="1" class="" />
<input type="hidden" name="old_file" value="echo your old file name"/>
<input type="submit" name="submit"/> 
```

控制器：

```
function edit_image() {

 if(isset($_FILES['new_file']['name']) && $_FILES['new_file']['name'] != '') {

                move_uploaded_file($_FILES['new_file']['tmp_name'],'./public_html/banner/'.$_FILES['new_file']['name']);

                $upload = $_FILES['new_file']['name'];

                $name = $post['old_file'];
                @unlink("./public_html/banner/".$name);
            }
            else {

                $upload = $post['old_file'];
            }              

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-15T11:26:57.427

尝试使用`delete_files('path')`CI 框架本身提供的功能： [https ://ellislab.com/codeigniter/user-guide/helpers/file_helper.html](https://ellislab.com/codeigniter/user-guide/helpers/file_helper.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-24T10:21:28.877

```
$image_data = $this->upload->data();
unlink($image_data['full_path']); 
```

此行将`$this->upload->data()`返回有关上传文件的许多信息。您可以打印信息并相应地工作。

# php - jquery mobile - 在选择时，使用 ajax 更新 html 结果

> ID：14900015
> 
> 赞同：0
> 
> 时间：2013-02-15T17:23:30.447
> 
> 标签：php, jquery, jquery-mobile

我正在使用 jquery mobile 的多重选择：自定义来尝试帮助根据用户的选择过滤数据。

我可以看到 jquery mobile 已经在 SELECT 上更新了文本，因为选择一个选项会自动更改选择菜单中的文本。

有没有办法利用它，以便我可以通过 AJAX 将所选选项的值发送到 php 页面并通过 JSON 返回结果？

```
<form id="target" method="post">
<div data-role="fieldcontain">
<label for="select-choice-attunement" class="select ui-hidden-accessible">Filter Attunement</label>
<select data-mini="true" name="select-choice-attunement" id="select-choice-attunement" multiple="multiple" data-native-menu="false">
    <option>Filter by Element</option>
    <option value='1'>fire</option>
    <option value='2'>water</option>
    <option value='3'>earth</option>
    <option value='4'>light</option>
    <option value='5'>darkness</option>
</select>
</div>
</form> 
```

让它更清楚一点。

从上面的列表中，您可以看到只有 5 个选项。用户可能会在 1 次或全部 5 次后完成。结果需要反映他们选择的内容，最好尽可能快（这就是我想挂钩到 jquery mobiles 更新的原因）。因此，如果选择“fire”，它将立即通过调用的 php 函数过滤并返回 json 列表，即必要的列表项。

让我们想象一下，我想用一个新的列表项数组更新以下内容：

看法：

```
<div id='change_with_ajax'>
<ul>
<?php
foreach ($ajaxretrievedarray as $array) 
{
echo "<li>".$array['name']."</li>";
} ?>
</ul>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T21:07:23.867

您可以查看以下示例。

触发更改事件时，所选值将显示在警报框中。

```
<!DOCTYPE html> 
<html> 
    <head> 
        <title>Select Choice</title> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>

        <script>
            $(document).on('change', '#select-choice-attunement', function(e){
                alert($(this).val());
            });
        </script>
    </head>

    <body>
        <!-- /page -->
        <div data-role="page">
            <!-- /header -->
            <div data-role="header" data-theme="b">
                <h1>Select Choice</h1>
            </div>
            <!-- /content -->
            <div data-role="content">
                <div data-role="fieldcontain">
                    <label for="select-choice-attunement" class="select ui-hidden-accessible">Filter Attunement</label>
                    <select data-mini="true" name="select-choice-attunement" id="select-choice-attunement" multiple="multiple" data-native-menu="false">
                        <option>Filter by Element</option>
                        <option value='1'>fire</option>
                        <option value='2'>water</option>
                        <option value='3'>earth</option>
                        <option value='4'>light</option>
                        <option value='5'>darkness</option>
                    </select>
                </div>
             </div>
        </div>
    </body>
</html> 
```

我希望这有帮助。

# types - ocaml 定义类型并将其用于计算

> ID：14900016
> 
> 赞同：-2
> 
> 时间：2013-02-15T17:23:33.163
> 
> 标签：types, ocaml

我有以下类型值，我想根据这些类型进行计算，但我收到一条错误消息：

> 此表达式具有类型值，但表达式应为 int 类型

那么我应该怎么做计算呢？

```
type binop = 
  | Plus 
  | Minus 
  | Mul 
  | Div 
  | Eq 
  | Ne 
  | Lt 
  | Le 
  | And 
  | Or          
  | Cons

type expr =   
  | Const of int 
  | True   
  | False      
  | NilExpr
  | Var of string    
  | Bin of expr * binop * expr 
  | If  of expr * expr * expr
  | Let of string * expr * expr 
  | App of expr * expr 
  | Fun of string * expr    
  | Letrec of string * expr * expr

type value =  
  | Int of int      
  | Bool of bool          
  | Closure of env * string option * string * expr 
  | Nil                    
  | Pair of value * value 

val x : value = Int 1
val x : value = Int 1 
```

当我这样做时

```
 x+x;; 
```

然后它会抛出错误，我想要这样的东西：

```
 Nano.value = Int 2 
```

修复这样的东西，它会返回`value = Int`一些东西，但我想要`Nano.value = Int`一些东西，以及名为 Nano.ml 的文件，所以我想要`Nano.value`

```
let add (x,y) = match (x,y) with 
   | (Int xx, Int yy) -> Int (xx + yy)
   | ( _ , _) -> Int 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:13:55.117

正如其他答案所提到的，您需要为该类型定义自己的“加号”运算符`value`。像这样的东西应该工作：

```
exception Bad_addition

let rec (++) a b = match (a,b) with
  | (Int(x),Int(y)) -> Int(x+y)
  | (Bool(x),Bool(y)) -> Bool(x || y)
  | (Nil,Nil) -> Nil
  | (Pair(x1,y1),Pair(x2,y2)) -> Pair(x1 ++ x2,y1 ++ y2)
  | _ -> raise Bad_addition 
```

这将为您提供一个名为的运算符`++`，然后您可以使用它来将值相加。例如，做`Int(1) ++ Int(1)`会产生结果`Int(2)`。

请注意，我已将布尔值的“加法”定义为逻辑或，将两个`Nil`值的加法定义为`Nil`，并将对的加法定义为逐点加法，但您可以为这些实现不同的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:31:02.857

没有为 value 类型的值定义“+”运算符，所以这里发生的情况是您正在为整数调用“+”运算符。

您需要定义一个运算符来添加您的值类型：

```
let ( +! ) x y = match (x,y) with 
   | (Int xx, Int yy) -> xx + yy
   |  _ -> raise <some exception>

Int 8 +! Int 2  ... should yield 10. 
```

（注意：我现在无法轻松访问 OCaml REPL，因此可能无法编译）

另外，不确定添加两个闭包、Nil's 或 Pair's 意味着什么，您必须为您的加法运算符确定这一点，您会注意到我只是为除 Ints 之外的任何东西提出了一些例外。您需要填写适合该类型的操作。

# ios - 归档应用程序 RestKit 0.10 失败

> ID：14900017
> 
> 赞同：0
> 
> 时间：2013-02-15T17:23:39.697
> 
> 标签：ios, restkit

我在 iOS 6.0 项目中使用 RestKit 0.10.2 已经有一段时间了。我一直在制作 Ad Hoc 预置档案，以便在其他设备上进行测试而没有问题。在最近的更新之后，我现在有了 iOS SDK 6.1。

我仍然可以在 iPhone 模拟器和手机（仍然有 iOS 6.0）上运行我的应用程序，但我无法再构建存档。它现在出现以下错误：

```
"_lcl_configure_by_name", referenced from:
  -[AppDelegate application:didFinishLaunchingWithOptions:] in AppDelegate.o
"_OBJC_CLASS_$_RKClient", referenced from:
  objc-class-ref in AppDelegate.o
  objc-class-ref in [MY_CLASS]ViewController.o
  objc-class-ref in [MY_CLASS]ViewController.o
  objc-class-ref in [MY_CLASS].o
  objc-class-ref in [MY_CLASS]ViewController.o
"_RKLogInitialize", referenced from:
  -[AppDelegate application:didFinishLaunchingWithOptions:] in AppDelegate.o
ld: symbol(s) not found for architecture armv7s
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

RestKit 类也出现了类似的错误：`RKParams`, `RKParserRegistry`, `RKMIMETypeJSON`, `RKRequestSerialization`, `RKObjectMapping`.

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:28:57.260

从架构构建设置中删除 armv7s。这对于 iPhone 5 处理器上的高性能游戏以外的任何东西都是不必要的。可能 restkit 项目构建设置没有构建 armv7s 二进制文件。最简单的方法是从您的主项目中删除 armv7s，这样它就不会尝试链接它。

# wordpress - 无法获取 WordPress 的自定义图像大小

> ID：14900018
> 
> 赞同：6
> 
> 时间：2013-02-15T17:23:41.013
> 
> 标签：wordpress

我定义了我的自定义图像大小，如下所示：

```
 add_theme_support('post-thumbnails');
    add_image_size('news-big', 370, 240, true);
    add_image_size('news-small',270,150,true);
    add_image_size('portfolio-big',370,500,true);
    add_image_size('portfolio-small',270,350,true);
    add_image_size('client',200,150,false); 
```

我上传了测试照片并且它有效 - 它们已调整大小。但是当我尝试打印它时：

```
 <?php $img = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID, 'news-big') ); ?>
    <?php print_r($img); ?> 
```

它返回“拇指”（150x150）。这是我第一次看到这样的事情。我使用 Roots 框架主题。怎么了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T17:26:45.117

你有一个放错位置的括号，所以你实际上并没有传递一个大小`wp_get_attachment_image_src`，它默认为缩略图。

```
<?php $img = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), 'news-big' ); ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T17:27:56.900

[`get_post_thumbnail_id`](http://codex.wordpress.org/Function_Reference/get_post_thumbnail_id)只接受一个参数，post id ...

您想将 size 参数传递给 wp_get_attachment_image_src

```
$img_src = wp_get_attachment_image_src(
             get_post_thumbnail_id($post->ID), 
             news-big'
           ); 
```

### 为什么？

尽管 WordPress 根据您的尺寸定义制作了许多图像，但仍然只有一个附件 ID。不同尺寸没有不同的ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:01:48.087

这是缩略图的错误显示：

```
<?php $img = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID, 'news-big') ); ?>
<?php print_r($img); ?> 
```

如果您在帖子中添加缩略图，您可以简单地使用：

```
the_post_thumbnail(); 
```

没有这一切。如果您添加自定义缩略图大小，您可以使用：

```
the_post_thumbnail('news-big'); 
```

但在使用它之前，您必须真正添加图片以发布为“特色图片”。

# ruby-on-rails - Rails Carrierwave Base64 图片上传

> ID：14900038
> 
> 赞同：18
> 
> 时间：2013-02-15T17:25:12.280
> 
> 标签：ruby-on-rails, ruby, carrierwave

使用 Carrierwave 将图像从客户端上传到 Rails 后端的最佳方式是什么。现在我们的 iOS 开发人员正在以 base64 格式发送文件，因此请求如下所示：

```
"image_data"=>"/9j/4AAQSkZJRgABAQAAAQABAAD/4QBYRXhpZgAATU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAHgAAAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAAeAB4DAREAAhEBAxEB/8QAHwAAAQUBAQE.... 
```

所以，我的问题实际上是两个问题。我应该告诉他以不同的文件格式发送吗？如果base64是发送这些文件的正确方法，那么我该如何在carrierwave中处理它们？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-15T21:59:32.773

我认为一种解决方案是将解码的数据保存到文件中，然后将此文件分配给已安装的上传器。在那之后摆脱那个文件。

另一个（内存中）解决方案可以是这个：

```
# define class that extends IO with methods that are required by carrierwave
class CarrierStringIO < StringIO
  def original_filename
    # the real name does not matter
    "photo.jpeg"
  end

  def content_type
    # this should reflect real content type, but for this example it's ok
    "image/jpeg"
  end
end

# some model with carrierwave uploader
class SomeModel
  # the uploader
  mount_uploader :photo, PhotoUploader

  # this method will be called during standard assignment in your controller
  # (like `update_attributes`)
  def image_data=(data)
    # decode data and create stream on them
    io = CarrierStringIO.new(Base64.decode64(data))

    # this will do the thing (photo is mounted carrierwave uploader)
    self.photo = io
  end

end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-04-04T10:47:28.890

您可以使用[Carrierwave-base64 Gem](https://github.com/lebedev-yury/carrierwave-base64)轻松实现这一点，您不必自己处理数据，您只需添加 gem 并更改您的模型

```
mount_uploader :file, FileUploader 
```

至

```
mount_base64_uploader :file, FileUploader 
```

就是这样，现在您可以轻松地说：

```
Attachment.create(file: params[:file]) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-06-17T07:06:37.963

老问题，但我不得不做类似的事情，从通过 json 请求传递的 base64 字符串上传图像。这就是我最终做的事情：

```
#some_controller.rb
def upload_image
  set_resource
  image = get_resource.decode_base64_image params[:image_string]
  begin
    if image && get_resource.update(avatar: image)
      render json: get_resource
    else
      render json: {success: false, message: "Failed to upload image. Please try after some time."}
    end
  ensure
    image.close
    image.unlink
  end
end

#some_model.rb
def decode_base64_image(encoded_file)
  decoded_file = Base64.decode64(encoded_file)
  file = Tempfile.new(['image','.jpg']) 
  file.binmode
  file.write decoded_file

  return file
end 
```

# c++ - 设置过剩到 Qt Creator

> ID：14900039
> 
> 赞同：0
> 
> 时间：2013-02-15T17:25:15.317
> 
> 标签：c++, qt, opengl, compiler-construction, glut

我想将 OpenGL 与 glut 与 Qt 创建者结合起来。我使用的是 Windows，我的 QT 版本是 4.7.4，32 位。

我按照教程：

[http://www.youtube.com/watch?v=1nzHSkY4K18](http://www.youtube.com/watch?v=1nzHSkY4K18)

我还检查了人们的其他一些问题，但他们没有给我答案。

包括过剩之前的部分工作正常。但是，当我尝试包含 glut 时，它不起作用。错误是：

> 未定义对 glutInit_ATEXIT_HACK 的引用

以及更多未定义的对 glutfunctions 的引用。

我将 glut-libraries 和 headers 复制到 Minwg 文件夹中的相应文件夹中。但我不确定这是否是正确的文件夹。

我是否必须为 Qt 获取 glut 和 OpenGL 的特殊库？我必须把它们放在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:26:46.387

> 我想将 openGL 与 glut 结合到 QT 创建者中

为什么？Qt 做了 GLUT 所做的一切，还有更多。如果您已经在使用 Qt，则不需要 GLUT。你所要求的毫无意义。

### 因评论而更新

首先：QGLWidget 做了 GLUT 所做的一切，还有更多。基本思想是从 QGLWidget 派生一个自定义的 Widget 类，并覆盖一些虚函数。*paintGL*是您通常注册的 als GLUT 显示功能。还有*resizeGL*和*initializeGL*。

您只需要调整大小，如果您需要在窗口更改后重新初始化某些资源，例如后处理 FBO 纹理附件等。**不要**，我再说一遍*，不要*把 glViewport 或投影设置之类的东西放在那里。它不属于那里。它属于显示功能。

initializeGL 应该用于加载纹理和其他一次性的东西。不要打电话给`glEnable(GL_DEPTH_TEST)`那里之类的。这也属于显示功能。

所以基本要点变成

```
class MyGLWidget : public QGLWidget 
{
Q_OBJECT
public:
    MyGLWidget(QGLWidget *parent):
        QGLWidget(parent)
    {}

protected:
    virtual void paintGL();
    virtual void resizeGL();
    virtual void initializeGL();
} 
```

您在显示函数的末尾调用 QGLWidget::swapBuffers 而不是 glutSwapBuffers。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T21:21:16.520

> 我是否必须为 QT 获取 glut 和 openGL 的特殊库？我必须把它们放在哪里？

不，但 OpenGL 和（可选 Glut）应该可以在您的包含和库路径中找到。该错误表明它们不在包含路径中，或者您没有包含它们。

我第二个约会狼。您不需要同时使用 Qt 和 Glut。如果您仅将 glut 用于辅助函数（gluLookAt、gluQuadrics），您可以相当轻松地复制它们或简单地使用 google。

# c# - Visual Studio 正则表达式替换重复捕获组

> ID：14900042
> 
> 赞同：2
> 
> 时间：2013-02-15T17:25:31.200
> 
> 标签：c#, regex, visual-studio-2010, replace, capturing-group

我正在做一个相当大的项目（c#），从一个地方到另一个地方，我的片段看起来像这样：

```
((int)foo).ToString() + "," + ((int)bar).ToString() + "," + ((int)zig).ToString() + ... 
```

逗号分隔的字符串具有任意长度（平均范围从 1 到 5，但我不确定是否还有更多）。到目前为止，我能够找到我想要使用的所有事件：

```
\({.+}\).ToString\(\)( *\+ *"," *\+ *\({.+}\).ToString\(\))* 
```

现在对于每一个事件我想用这样的东西替换它：

```
{ (int)foo, (int)bar, (int)zig , ...} 
```

手动替换每个事件是不可行的，是否有替换正则表达式可以完成这项工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:35:21.510

是的，您可以使用正则表达式在 Visual Studio 中进行查找和替换。

简而言之，您需要对标记表达式使用花括号并使用 , 等重用`\1`它们`\2`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:39:33.433

我可能误解了你的问题，但听起来你已经得到了答案......使用`System.Text.RegularExpressions.Regex.Replace(string, string)`. 如果您需要细粒度的控制，请考虑使用名称包装您的捕获：（`\((?<foo>.+)\)`或使用索引）。使用这些捕获，如果需要，您可以通过循环匹配然后迭代捕获来手动进行替换。

# java - 在 JAR 文件中加载时未调用 JavaFX 2.2 控制器初始化（）

> ID：14900047
> 
> 赞同：1
> 
> 时间：2013-02-15T17:25:48.240
> 
> 标签：java, javafx-2, javafx

背景：我创建了一个 JavaFX 应用程序，使用 JFXPanel 嵌入到 Swing 框架中。我一直在使用 Eclipse 作为 IDE。“主应用程序”是另一个类，它仅用于创建一个类的实例，该实例扩展`JFXPanel`为在实例化时加载我的 .fxml 文件。当从 Eclipse 执行主类时，一切都很好，我的 .fxml 文件中指定的 fx:controller 调用了它的`initialize()`方法（我可以从它在加载时对 UI 所做的更改中看出）并且没有问题。

但是，当我将所有内容打包到 JAR 中并尝试将我的 JFXPanel 扩展类添加到 Swing`JFrame`实例时，它会设法加载 .fxml 文件，只是读取图像、样式表等，其余代码的功能是预期但是永远不会调用`fx:controller`'`initialize()`方法。我从 jar 内部或外部的其他类访问该类没有问题，我什至尝试设置一个 ControllerFactory 它将返回一个 Controller 的实例，以及尝试设置`FXMLLoader`类加载器和使用两者的各种组合调用的静态和非静态方法`load()`. 结果总是一样的：从 IDE 启动时它会起作用，但从我打包的 jar 启动时不起作用。我知道 jar 没有丢失任何文件，因为就像我说的那样，从 Java 代码中找到类没有问题，并且捆绑的 fxml/css 文件似乎加载正常，减去控制器问​​题。

有人曾经遇到过这种情况，或者知道`FXMLLoader`无法设置控制器会发生什么吗？这可能是某种错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T21:22:07.277

在将我的 JavaFX 软件打包成 .jar 文件时，我遇到了类似的问题。原来这是关于相对路径的问题。您的 IDE 对此没有任何问题，但是在 jar 中编译时会出现问题。

这是使用以下代码调用我的 .fxml 文件解决的。

```
getClass().getClassloader().getResource("/my/view/selector.fxml") 
```

要说这是你的错误的“原因”，我不确定，但这确实让我难过一段时间，似乎几乎是我遇到的问题。

原始问题：[Executable Jar 仅限于一个带有 JavaFX 的窗口](https://stackoverflow.com/questions/14241283/executable-jar-limited-to-one-window-with-javafx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T20:48:39.400

我无法解决这个问题。虽然 fxml/css 文件加载正常并引用了正确的控制器类，但我仍然无法看到控制器类的 initialize() 方法在所有内容打包到 jar 后被调用。

由于我需要控制器的唯一事情是获取 fxml 文件中定义的各种 UI 对象，以便我可以对它们进行真正的编程，因此我选择创建一个递归搜索来通过它们的 fxml ID 查找这些单独的小部件[似乎先查找'id'然后'fx：id'如果没有找到'id']在场景树中..

```
//grabs fxml file relative to root of the jar
FXMLLoader loader = new FXMLLoader(ClassLoader.getSystemClassLoader().getResource("app.fxml"));
Parent javaFXRoot = (Parent) loader.load();

public Node findWidgetByID(String id, Parent javaFXRoot)
{
    return findObject(root, id);
}

private Node findObject(Parent root, String id)
{
    for (Node node : root.getChildrenUnmodifiable())
    {
        if (node.getId() != null && node.getId().equals(id))
        {
            return node; // found the node, return it
        }
        Node retValue = null;
        if (node instanceof Parent)
        {
            retValue = findObject(((Parent) node), id); // recursive search
        }
        if (retValue != null) //if our node was found by the recursive search, return that
        {
            return retValue;
        }
    }
    return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-15T17:20:28.503

我在从 IDE 调用该方法时遇到了同样的问题`initialize()`，但不是从（阴影）jar 调用。

问题是我们使用了配置为保持`protected`和`public`方法的 ProGuard。但是，该`initialize()`方法已声明`private`。因此它混淆了方法名称，JavaFX 找不到任何适当命名的方法并且`initialize()`从未被调用。

要阻止 ProGuard 混淆您的 JavaFX 注释方法和字段，请将此规则包含在您的`proguard.conf`:

```
-keepattributes javafx.fxml.FXML

-keepclassmembers class * {
    @javafx.fxml.FXML *;
} 
```

第一行将保留`@FXML`注释，另一条规则保留带`@FXML`注释的类成员名称。

# sql - Oracle 中的 Sql 查询联接

> ID：14900050
> 
> 赞同：0
> 
> 时间：2013-02-15T17:26:11.070
> 
> 标签：sql, oracle, oracle11g

我有父表和多个具有外键约束的子表。

```
School Table

School ID EduDetails Genders Address_id  EDUTYPE
  1        2          M         3         FGN 
```

和子表一样

```
 Education Details
 EDU ID    EducationType
  2        Online

 AKA Name
 School Id   AKA Name
     1       Test School
     1       School Test

 Gender Table
 Gender ID   Gender Desc
      M      Male 
```

我正在为父母和学校表使用左外连接来获取结果。

但我的问题是，如果 AKA 表有 5 个与学校 ID 匹配的计数，而 Gender 表只有 1 个该学校 ID 的记录。

因此，结果带有 5 个重复行，其中包含学校信息和其他子表信息。

是否有任何解决方法来解决此问题。我尝试通过函数使用子查询和row_number。但这对我不起作用。谁能帮我解决这个问题。

提前感谢您花时间查看此问题。

我需要的输出应该是这样的

```
 School_id AKA Name     GenderDesc EductaionType
   1       Test School    Male       Online
   1       School Test 
```

所以我需要为不匹配的记录设置 Null 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:52:37.180

由于您想要 AKA Name 表中的所有记录，因此我加入了这一点，`Row_Number`为每一行获取一个。然后在其他桌子上`Row_Number`使用它。`LEFT JOIN`

```
SELECT S.SchoolId, 
  SA.AKAName,
  G.GenderName,
  ED.EducationType
FROM School s
  JOIN 
     (SELECT SchoolId, 
        AKAName, 
        ROW_NUMBER() OVER (PARTITION BY SchoolId ORDER BY AKAName) rn
      FROM SchoolAKA
      ) SA ON S.SchoolID = SA.SchoolId
  LEFT JOIN 
     (SELECT EDUID, 
        EducationType, 
        ROW_NUMBER() OVER (ORDER BY EducationType) rn
      FROM EduDetails
      ) ED ON S.EDUID = ED.EDUID AND SA.rn = ED.rn
  LEFT JOIN 
     (SELECT GenderId, 
        GenderName, 
        ROW_NUMBER() OVER (ORDER BY GenderName) rn
      FROM Genders
      ) G ON S.GenderId = G.GenderId AND SA.rn = G.rn 
```

这是 SQL[小提琴](http://sqlfiddle.com/#!4/16385/1)。

结果如下：

```
SCHOOLID   AKANAME       GENDERNAME   EDUCATIONTYPE
1          School Test   Male         Online
1          Test School   (null)       (null) 
```

# javascript - 我可以使用 jasminerice 和 rails 3.2.8 测试我的公共文件夹中的 javascript 文件吗？

> ID：14900052
> 
> 赞同：0
> 
> 时间：2013-02-15T17:26:20.917
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3.2, tdd, jasmine

我在我的 rails 应用程序中测试一个 javascript 文件时遇到了一些麻烦。我在我的公共目录中有这个文件，因为我想静态地提供它。

我目前正在使用**jasminerice 0.0.9**来测试我在 app/assets 中的所有其他 javascript 文件，这些文件似乎工作正常。

在尝试测试我的公共 javascript 文件时，我无法通过以下方式在测试中要求它：

```
#= require /public/myfile.js 
```

有谁知道是否可以用 jasminerice 在我的公共目录中测试我的文件，或者是否有其他方法可以测试它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:21:44.290

尝试添加：

```
//= require_tree public 
```

..在文件包含之前。它也只是（没有扩展名）：

```
#= require myfile 
```

# windows - 实现 Windows 定时器

> ID：14900055
> 
> 赞同：0
> 
> 时间：2013-02-15T17:26:26.837
> 
> 标签：windows, winapi, timer, glut, freeglut

如何实现一个 C++ 计时器函数，它的行为类似于： `void glutTimerFunc(unsigned int msecs,void (*func)(int value), value);`但纯粹是 WinAPI（或 STL）的东西？不过，我需要它来不忙等待。它需要在 X 毫秒后调用一个函数感谢您的任何/所有帮助！

我一直在看，`struct timeval tv;`但我对如何实际实施它有点困惑。它需要替代`glutTimerFunc()`. 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:12:03.563

调用后使用等待计时器 - [SetWaitableTimer](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686289%28v=vs.85%29.aspx)`CreateWaitableTimer`

> 当到期时间到达时，会向定时器发出信号，并且设置定时器的线程调用可选的完成例程。

这里有一个我认为你想要的使用模式的[例子](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686898%28v=vs.85%29.aspx)。

# php - 使用 PDO 调用 MSSQL 存储过程不起作用

> ID：14900056
> 
> 赞同：0
> 
> 时间：2013-02-15T17:26:28.920
> 
> 标签：php, sql-server, stored-procedures, pdo, execute

试图调用 MSSQL 存储过程。程序基本上是这样的： USE [DATABASE] GO SET ANSI_NULLS ON GO SET QUOTED_IDENTIFIER ON GO

ALTER 过程 [dbo].[STOREDPROCEDURE] (@username varchar(10)) 为

SELECT * FROM '表名' where userfield = @username

* * *

```
PHP Code
$username = 'username';
try {
    $connection = new PDO('odbc:Driver={SQL Server Native Client 10.0};Server={SERVER};Database={DATABASE};Uid={USER};Pwd={PASSWORD}', 'USER', 'PASSWORD');
}
catch(PDOException $e) {
    echo 'Connection Failed :'.$e->getMessage().PHP_EOL;
    echo 'Please contact the application administrator';
}

$stm = $connection->prepare("CALL STOREDPROCEDURE(?)");
$stm->bindParam(1, $username, PDO::PARAM_STR, 10);
$stm->execute();
$results = $stm->fetchAll();
var_dump($results); 
```

输出为： array(0) { } 这个数据库中有大量数据。

我知道与数据库的连接有效，当我更改连接中的数据库名称时，它会失败。

但是，当我在 (Call ADanE1Username) 行中更改存储过程的名称时，结果没有任何变化。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:29:17.457

使用 SQL SERVER，您必须使用

```
$stm = $connection->prepare("EXEC STOREDPROCEDURE(?)"); 
```

**[执行（事务处理 SQL）](http://msdn.microsoft.com/en-us/library/ms188332.aspx)**

# vim - vim 用 s/ 替换函数

> ID：14900071
> 
> 赞同：0
> 
> 时间：2013-02-15T17:27:42.627
> 
> 标签：vim

我正在尝试执行以下操作

```
%s/foo/\=substitute(getline('.'),'bar','','g') 
```

到这个例子

```
this is a foo cool bar 
```

我希望它返回的是

```
this is a bar cool bar 
```

但它回来了

```
this is a this is a foo cool  cool bar 
```

意味着整行被返回，而不仅仅是替换（）函数中匹配的正则表达式

我错过了什么吗？

我知道 split() 函数和 sed 实现，但我想要它在替代()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:43:53.383

为什么`substitute()`？

为什么不简单`:s/foo/bar/`呢？

无论如何，这两个丑陋的命令都应该工作...... :(

```
:%s/foo/\=substitute(submatch(0),".*","bar","g")/

:%s/.*/\=substitute(submatch(0),"foo","bar","g")/ 
```

如果您更喜欢只使用函数，这也可以：

```
:%call setline(line('.'),substitute(getline('.'),'foo','bar','g')) 
```

# highcharts - Highcharts 基本条

> ID：14900073
> 
> 赞同：0
> 
> 时间：2013-02-15T17:27:53.763
> 
> 标签：highcharts

我正在尝试将 highcharts 的导出 api 与 bar 类型一起使用。

你知道我是否可以为每个组定义不同数量的条吗？

我将尝试解释一个例子，以[http://www.highcharts.com/demo/bar-basic](http://www.highcharts.com/demo/bar-basic)我可以从亚洲删除 1900 年并将 1700 年添加到美国吗？在其他组中不显示零。

# javascript - 使用基于 iframe url 的 javascript 更改 X-UA-Compatible 元标记

> ID：14900084
> 
> 赞同：1
> 
> 时间：2013-02-15T17:28:43.143
> 
> 标签：javascript, cross-browser

语境：

我正在一个大型站点上工作，其中一些旧控件会在较新的浏览器中中断，因此我们不得不使用您的标准 meta X-UA-Compatible 标签强制 IE7 文档模式。我们已经更换了大部分问题控件，但没有时间和预算来全部更换。我们希望没有控件的页面可以在 IE 浏览器的当前文档模式下呈现，以利用其提供的客户端性能提升。问题是我无法让较新的 ie 浏览器像我想要的那样切换模式。网站的导航使用 iframe，我觉得这可能是我的主要问题。我在带有 iframe 的父页面上有我的 javascript。

我希望能够使用 javascript 来做到这一点，并且一直在尝试这样做。这就是我正在做的事情。它成功地更改了标签，但浏览器似乎并不关心。**为了让浏览器考虑标签，我需要更改什么？**

```
 //tag swapping code 
     function FixIEMetaTag(url) {

         //Remove current IE meta Tag
         var iefixTagOld = document.getElementsByTagName('meta')[0];
         if (iefixTagOld) { iefixTagOld.parentNode.removeChild(iefixTagOld); }

         //Determine Document Type for IE browsers
         var contentVal = 'IE=Edge';             
         if (IsPageWithBadGrid(url)) { contentVal = 'IE=7'; }

         //Create and add new IE meta Tag
         var iefixTag = document.createElement('meta');
         iefixTag.setAttribute("http-equiv", "X-UA-Compatible");
         iefixTag.setAttribute("content", contentVal);
         var theHead = document.getElementsByTagName('head')[0];
         theHead.insertBefore(iefixTag, theHead.firstChild);
     }

     //navigation code
     function GoToPage(url) {

         if (window.frames["ifrm"]) {

             FixIEMetaTag(url);

             window.open(url,"ifrm");
             return false;
         }

         return true;
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:38:52.577

为了有效，`X-UA-Compatible`元标记必须在页面加载时出现。到 Javascript 运行时，改变已经太迟了。

如果您确实需要为 iframe 的内容打开和关闭 IE7 模式，最好的办法是保留具有不同`X-UA-Compatible`标签的页面的两个版本，或者通过 URL 参数传递兼容性标志（例如，`?mode=ie7`vs. `?mode=edge`） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:02:47.550

就像我根据迄今为止的答案和评论想到我应该做什么......

听起来好像我需要重新加载主页以更改 IE 元标记。根据我当前的代码，我在想这样的事情：

```
 //navigation code
 function GoToPage(url) {

     if (window.frames["ifrm"]) {

         var oldContentTagValue = 'IE=Edge';  
         //Determine Previous IEType tag
         var iefixTagOld = document.getElementsByTagName('meta')[0];
         if (iefixTagOld) { 
             oldContentTagValue = (?);//something fancy to get current tag type

         }

         //Determine Document Type for IE browsers
         var contentVal = 'IE=Edge';             
         if (IsPageWithBadGrid(url)) { contentVal = 'IE=7'; }

         if(oldContentTagValue !=contentVal ){
             //redirect to current page with contenttypetag stuff and iframe url in query string
         }
         else{
             window.open(url,"ifrm");
         }
         return false;
     }

     return true;
 } 
```

然后我会根据查询字符串参数设置 iframe url 并在加载时更正元标记......想法？

# jquery - jQuery $.ajax 服务器转换为 json

> ID：14900085
> 
> 赞同：0
> 
> 时间：2013-02-15T17:28:43.283
> 
> 标签：jquery

我是 jQuery 的新手。我的应用程序已经构建好了。我看到使用了两个 ajax 方法`$.getJSON()`和 $.ajax()。我不明白的是，`$.getJSON()`在成功函数中接收到的数据直接用作对象。

但是如果使用 $.ajax ，我看到了代码 `var json = eval('(' + data + ')');`，为什么我们需要进行这种转换，为什么`$.getJSON()`方法不需要它？

下面是 $.ajax() 和 $.getJSON() 代码：

```
 $.ajax({
    type: 'POST',
    url: ServiceUrl.SystemConfig,
    data: "",
    success : function(data) {
         var json = eval('(' + data + ')');
    }

    $.getJSON('/index', "",
    function(json, textStatus) { }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:31:32.343

该`$.getJSON( url [, data ] [, success(data, textStatus, jqXHR) ] )`方法是一个快捷方式

```
$.ajax({
  dataType: "json",
  url: url,
  data: data,
  success: success
}); 
```

如果您[阅读文档](http://api.jquery.com/jQuery.getJSON/)，您会看到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:43:00.217

$.getJSON 是在 $.ajax 请求中将预期的 Content-Type 设置为 application/json 的快捷方式，它告诉 jQuery 在返回之前将响应解析为 JSON 对象。当您知道您将收到 JSON 时，这非常有用。$.ajax 更通用，因此不知道它会得到 JSON，除非它被明确告知。这意味着来自 $.ajax 的响应没有预先解析，你必须自己做。

# objective-c - 格式化浮点数以填充前导空格

> ID：14900088
> 
> 赞同：4
> 
> 时间：2013-02-15T17:29:06.250
> 
> 标签：objective-c, cocoa-touch, nsstring, number-formatting

我可以用前导零得到我想要的结果，但它不适用于空格。

```
[NSString stringWithFormat:@"%05.2f", 2.1]; // 02.10 
```

但是，以下方法不起作用：

```
[NSString stringWithFormat:@"% 5.2f", 2.1]; // 2.10 
```

这也不是：

```
[NSString stringWithFormat:@"%5.2f", 2.1]; // 2.10 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:53:42.080

我刚试过这个，它穿着：

```
printf("%s\n", [[ NSString stringWithFormat:@"% 5.2f\n", 2.1 ] UTF8String ] ) ; 
```

这使

```
 2.10 
```

这是正确的......也许问题出在其他地方？

*编辑*

如果您不使用固定宽度的字体，则可以插入制表符而不是`\t`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:58:13.980

我认为我的原始解决方案与@ColWhi 和@nielsbot 建议的一样有效...我认为问题在于字体（Helvetica）的空格比字符窄...

# xcode - UIImageView 只设置大小或原点

> ID：14900089
> 
> 赞同：0
> 
> 时间：2013-02-15T17:29:13.187
> 
> 标签：xcode, uiimageview

有没有办法只为 UIImageView 设置大小/原点而不是另一个？现在我必须使 CGRect 的前两个或最后两个参数与以前相同。

# windows-phone-7 - 如何为 Windows Phone 中的按钮手动引发点击事件？

> ID：14900094
> 
> 赞同：0
> 
> 时间：2013-02-15T17:29:37.447
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-8

如何为 windows phone 中的按钮手动引发点击事件？技术上可行吗？这是手动提出此类事件的好建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:30:48.723

您可以像使用任何其他函数一样手动引发事件，因为就其本身而言，事件处理程序只不过是与在发生事件时传递给它的数据相关联的函数。

因此，假设您有一个模拟事件处理程序：

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    Debug.WriteLine("TEST");
} 
```

您可以轻松地手动调用它：

```
Button_Click_1(btnTest, new RoutedEventArgs()); 
```

在这种情况下，您可以提供自己的发件人。如果您想专门引发一个事件，而不必显式绑定到您自己的事件处理程序，请查看[这个答案](https://stackoverflow.com/a/586156/303696)- 您可以使用反射，尽管我不确定您为什么需要这样。

# jenkins - 访问 jenkins 时出现代理错误

> ID：14900096
> 
> 赞同：3
> 
> 时间：2013-02-15T17:29:42.547
> 
> 标签：jenkins, apache2, continuous-integration

当我访问詹金斯我得到这个错误 -

代理错误

代理服务器收到来自上游服务器的无效响应。代理服务器无法处理请求 GET /。

原因：从远程服务器读取错误

我尝试了初始化脚本来重新启动詹金斯，但它没有说 8080 已经在使用中。我更改了 jenkins 默认端口，但仍然出现上述错误。关于如何解决这个问题的任何指示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:22:32.287

最简单的事情：停止运行 jenkins 的 Web 服务器。运行 netstat -a。
8080 端口在使用吗？如果是，则需要将 Web 服务器的端口更改为 8080 以外的端口。（9090 很容易记住）。

如果 8080 正在使用中，您应该在尝试启动 Web 服务器时收到错误消息。检查 Web 服务器的日志。

顺便说一句，你真的是说你改变了詹金斯的默认端口吗？或者这是 jenkins 运行的 Web 服务器的默认端口？

# java - 如何从prototypejs客户端将pojo对象作为参数传递给rest web service

> ID：14900097
> 
> 赞同：2
> 
> 时间：2013-02-15T17:29:50.957
> 
> 标签：java, javascript, web-services, rest, prototypejs

如何从prototypejs客户端将pojo对象作为参数传递给rest web服务。

假设我有这样的网络服务。

```
@Path("/postItem")
@Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })
public Item postItem(Item item) 
{
  return new item;
} 
```

从客户端使用prototypejs库如何将pojo对象作为参数传递给rest web服务。

如果参数是字符串或整数类型，我会将其作为查询参数传递，但它是 pojo 对象以防万一。

我是关于 pojo 对象的语法创建，然后将它从prototypejs 传递给rest web 服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T01:59:03.317

您使用哪种 jax-rs 实现？对于 Jersey，您可以通过指定 jersey servlet 将 json 发布到服务器：

```
<servlet>
    <servlet-name>jersey-servlet</servlet-name>
    <servlet-class>
        com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>your package</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
        <param-value>true</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>jersey-servlet</servlet-name>
    <url-pattern>/api/*</url-pattern>
</servlet-mapping> 
```

然后在您的客户端代码中，您可以直接将一个 json 发送到服务器，该 json 将被反序列化为一个 Item 实例

# c# - 过滤并保留具有匹配属性的对象列表的第一个对象

> ID：14900098
> 
> 赞同：1
> 
> 时间：2013-02-15T17:29:50.963
> 
> 标签：c#, .net, entity-framework

我先道歉，因为我现在意识到我完全用错了我的例子。对于那些做出回应的人，我真的很感激。请让我重新尝试以更准确的细节进行解释。请编辑您的回复，对于我之前的帖子没有更准确，我再次表示歉意。

使用名为 Staging 的实体框架模型类（它是我的 Staging 表的表示形式），我有以下`List<Staging>`.

```
List<Staging> data = (from t in database.Stagings select t).ToList();
//check for an empty List...react accordingly... 
```

快速浏览一下`Staging`外观：

```
public partial class Staging
{
    public int ID { get; set; }        //PK
    public int RequestID { get; set; } //FK
    ...
    public string Project { get; set; }
    ...
} 
```

让我们假设查询将 10 条记录返回到我的`data`列表中。让我们还假设`data[3]`,`data[6]`和`data[7]`中的每个都具有相同的值`data.Project`，比方说`"Foo"`。该`data.Project`值直到运行时才知道。

鉴于此，我将如何保留第一次出现 ,并`data[3]`从我的?`data[6]``data[7]``List<Staging>`

**编辑：** 我有以下有效的代码，但还有其他方法吗？

```
 HashSet<string> projectValuesFound = new HashSet<string>();
  List<Staging> newData = new List<Staging>();

  foreach (Staging entry in data)
  {
    if (!projectValuesFound.Contains(entry.Project))
    {
      projectValuesFound.Add(entry.Project);
      newData.Add(entry);
    }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:32:24.777

您可以通过 LINQ 和 a 执行此操作`HashSet<T>`：

```
var found = new HashSet<string>();
var distinctValues = theList.Where(mc => found.Add(mc.Var3));

// If you want to assign back into the List<T> again:
// theList = distinctValues.ToList(); 
```

这是有效的，因为`HashSet<T>.Add`如果值不在集合中，则返回 true，如果它已经存在，则返回 false。因此，您只会获得`Var3`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:58:01.490

做到这一点的“规范”方法是将适当实施的比较器传递给[Distinct](http://msdn.microsoft.com/en-us/library/bb338049.aspx)：

```
class Var3Comparer : IEqualityComparer<MyClass> {
    public int GetHashCode(MyClass obj) {
        return (obj.Var3 ?? string.Empty).GetHashCode();
    }
    public bool Equals(MyClass x, MyClass y) {
        return x.Var3 == y.Var3;
    }
}

// ...

var distinct = list.Distinct(new Var3Comparer()); 
```

请注意，虽然当前的实现似乎保持“幸存”元素的顺序，但文档说它“返回无序序列”并且最好以这种方式处理。

还有一个不需要比较器的 Distinct 重载 - 它只是假定[默认](http://msdn.microsoft.com/en-us/library/ms131187.aspx)[比较](http://msdn.microsoft.com/en-us/library/bb348436.aspx)[器](http://msdn.microsoft.com/en-us/library/ms224763.aspx)，如果由.`MyClass`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:31:44.153

你可以使用 Linq：

```
var result = (from my in theList where my.Var3 == "Foo" select my).First(); 
```

如果您*还想*保留其他项目，可以使用[Distinct()](http://msdn.microsoft.com/en-us/library/bb338049.aspx)而不是 First()。要使用 Dictinct()，要么`MyClass`必须实现`IEquatable<T>`，要么必须提供`IEqualityComparer<T>`MSDN 链接中所示的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T17:35:23.330

```
var uniques = (from theList select theList.Var3).Distinct(); 
```

这将为您提供所有条目的不同值。

# r - 如何在 R varImpPlot 中操作 y 轴文本标签？

> ID：14900102
> 
> 赞同：7
> 
> 时间：2013-02-15T17:30:10.693
> 
> 标签：r

以下示例类似于我的数据集：

```
require(randomForest)

alpha = c(1,2,3,4,5,6)
bravo = c(2,3,4,5,6,7)
charlie = c(2,6,5,3,5,6)
mydata = data.frame(alpha,bravo,charlie)

myrf = randomForest(alpha~bravo+charlie, data = mydata, importance = TRUE)

varImpPlot(myrf, type = 2) 
```

我似乎无法控制 y 轴标签在`varImpPlot`. 我曾尝试更改绘图参数（例如 mar、oma），但没有成功。我需要将 y 轴标签向左移动，以便生成具有正确标签位置的 PDF。

**如何将 y 轴标签向左移动？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T18:46:16.990

我尝试使用`adj`参数，但它产生了一个错误。作为 varImpPlot ，`dotchart`在后面使用，这里是使用 lattice 的版本`dotplot`。然后，您可以使用`scales`参数自定义轴。

```
imp <- importance(myref, class = NULL, scale = TRUE, type = 2)
dotplot(imp, scales=list(y =list(cex=2,
                                       at = c(1,2),
                                       col='red',
                                       rot =20,
                                       axs='i') ,
                               x =list(cex=2,col='blue')) ) 
```

![在此处输入图像描述](../Images/6673f6eb5a037986cb17ca4a51ef955f.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-09T22:01:44.553

您可以从 myref 中提取构建绘图所需的数据，并使用 ggplot 构建绘图。通过这样做，您可以更自由地调整情节。这里有些例子

```
library(ggplot2)

str(myrf)
str(myrf$importance)
data <- as.data.frame(cbind(rownames(myrf$importance),round(myrf$importance[,"IncNodePurity"],1)))
colnames(data) <- c("Parameters","IncNodePurity")
data$IncNodePurity <- as.numeric(as.character(data$IncNodePurity)) 
```

标准情节：

```
(p <- ggplot(data) + geom_point(aes(IncNodePurity,Parameters))) 
```

旋转 y 轴标签：

```
(p1 <- p+ theme(axis.text.y = element_text(angle = 90, hjust = 1))) 
```

更多调整（也是此处显示的第一个图）：

```
(p2 <- p1 +  scale_x_continuous(limits=c(3,7),breaks=3:7) + theme(axis.title.y = element_blank())) 
```

看起来像 varImpPlot 的图（此处显示的第二个图）：

```
(p3 <- p2+ theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(colour = 'gray', linetype = 'dashed'),
panel.background = element_rect(fill='white', colour='black'))) 
```

使用 ggplot 可以轻松保存为 pdf：

```
ggsave("randomforestplot.pdf",p2) 
```

或者

```
ggsave("randomforestplot.png",p2)

p2 
```

![在此处输入图像描述](../Images/4e4ef140d819ecf2142d0e5a9c269967.png)

```
p3 
```

![在此处输入图像描述](../Images/c67b28a15662be2733e1417e4c5af84b.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T06:59:57.147

我是否理解正确，您想在情节边界的左侧获取文本`charlie`和更多内容？`bravo`如果是这样，这里有一个 hack 来存档这个，基于`rownames`绘图中使用的修改：

```
myrf = randomForest(alpha~bravo+charlie, data = mydata, importance = TRUE)
#add white spaces at the end of the rownames
rownames(myrf$importance)<-paste(rownames(myrf$importance), "   ") 
varImpPlot(myrf, type = 2) 
```

in 中的 adj 参数`dotchart`固定为 0（右对齐），所以不修改 的代码就无法更改`dotchart`：

```
mtext(labs, side = 2, line = loffset, at = y, **adj = 0**, col = color, 
    las = 2, cex = cex, ...) 
```

（来自`dotchart`）

**编辑**：您也可以进行另一种黑客攻击。取 的代码`dotchart`，将上面的行改为

```
 mtext(labs, side = 2, line = loffset, at = y, adj = adjust_ylab, col = color, 
        las = 2, cex = cex, ...) 
```

然后将参数添加`adjust_ylab`到参数列表中，并将函数重命名为 example `dotchartHack`。现在复制 的代码`varImpPlot`，找到调用的行`dotchart`，将函数名称更改为`dotchartHack`并将参数添加`adjust_ylab=adjust_ylab`到函数调用中，将函数重命名为`varImpPlotHack`并添加`adjust_ylab`到此函数的参数列表中。现在您可以通过更改参数来更改`charlie`and的对齐方式：`bravo``adjust_ylab`

```
 myrf = randomForest(alpha~bravo+charlie, data = mydata, importance = TRUE) 
 varImpPlotHack(myrf, type = 2,adjust_ylab=0.5) 
```

来自`?par`：

> adj 的值决定了文本字符串在 text、mtext 和 title 中的对齐方式。值 0 生成左对齐文本、0.5（默认）居中文本和右对齐文本。（[0, 1] 中的任何值都是允许的，并且在大多数设备上，该间隔之外的值也可以使用。）

# c++ - vector::push_back 何时增加容量？

> ID：14900104
> 
> 赞同：3
> 
> 时间：2013-02-15T17:30:19.870
> 
> 标签：c++, stdvector

我`std::vectors`通过在开始时设置它们的容量并使用`push_back`来慢慢填充它们来使用一堆。这些向量中的大多数将具有相同的大小（16 个元素），尽管有些可能会变得更大。如果我`push_back`最初在大小为 0 且容量为 16 的向量上使用 16 次，我可以确定容量在 16 之后正好是 16`push_backs`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T17:32:18.597

是的——一旦你保留了一个特定的容量，向量将不会被重新分配，直到你超过你设置的容量¹。没有指定在不重新分配的情况下可以推送多少项目，但可以保证至少有多少项目。

* * *

1.  特别是，指向向量的指针和迭代器保证在超过指定容量之前保持有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T17:34:04.670

`23.3.6.5 [vector modiﬁers]`

```
void push_back(const T& x);
void push_back(T&& x); 
```

> 备注：如果新大小大于旧容量，则导致重新分配

几乎不言自明。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T17:36:49.867

是的。

23.3.6.3p6：

> 在调用之后发生的插入期间不会发生重新分配，`reserve()`直到插入会使向量的大小大于 的值`capacity()`。

# python - 如何防止 Django 覆盖 sessionid cookie？

> ID：14900106
> 
> 赞同：2
> 
> 时间：2013-02-15T17:30:21.453
> 
> 标签：python, django, selenium, session-cookies, django-sessions

我试图在测试中有 2 个具有相同会话的浏览器窗口。请注意，由于 selenium 的限制，每个浏览器都有不同的 firefox 配置文件。

测试（您可以尝试，只要您有测试/测试人员用户）是：

```
import time

from django.test import LiveServerTestCase
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.firefox.webdriver import WebDriver
from selenium.common.exceptions import NoSuchElementException

class ScriptTestCase(LiveServerTestCase):
    def do_admin_login(self, username, password, browser):
        browser.get('%s%s' % (self.live_server_url, '/admin/'))
        username_input = browser.find_element_by_name("username")
        username_input.send_keys(username)
        password_input = browser.find_element_by_name("password")
        password_input.send_keys(password)
        browser.find_element_by_xpath('//input[@value="Log in"]').click()

    def test_double_window_inactivity(self):
        browser0 = WebDriver()
        self.do_admin_login('test', 'test', browser0)
        cookie = browser0.get_cookie('sessionid')
        cookies = {'name': 'sessionid', 'value': cookie['value']}

        browser1 = WebDriver()
        browser1.add_cookie(cookies)
        print 1, browser0.get_cookie('sessionid')['value']
        print 2, browser1.get_cookie('sessionid')['value']
        browser1.get('%s%s' % (self.live_server_url, '/admin/'))
        print 3, browser0.get_cookie('sessionid')['value']
        print 4, browser1.get_cookie('sessionid')['value'] 
```

输出是：

```
1 08ba4efecf00d2b98aacd174ed20e144
2 08ba4efecf00d2b98aacd174ed20e144
3 08ba4efecf00d2b98aacd174ed20e144
4 cb49379190cb37735697c5c82ab300fc 
```

如您所见，在 browser1 打开 /admin/ 后，它的 sessionid 被意外覆盖。

如何解决这个问题？我试图让 browser1 与 browser0 具有相同的会话。

修复代码，感谢 Hedde ---

```
 def test_double_window_inactivity(self):
      self.browser.execute_script('window.open("/admin/", "other")')

      for win in self.browser.window_handles:
          self.browser.switch_to_window(win)
          self.assertWarningHidden()

      time.sleep(5+1)  # Added one second to compensate for fadeIn
      for win in self.browser.window_handles:
          self.browser.switch_to_window(win)
          self.assertWarningShown()

      time.sleep(5+1)  # Added one second to compensate for lag
      for win in self.browser.window_handles:
          self.browser.switch_to_window(win)
          self.assertWarningNotInPage() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T19:46:09.187

我相信事情会像他们应该做的那样工作。也就是说，会话应该在选项卡和/或窗口之间共享，而不是在浏览器之间共享。

查看您的代码，您似乎不打算跨浏览器共享会话，只是跨两个 Firefox 窗口。实例化两个 WebDriver 类不是你应该的工作方式。查看 selenium[源代码](http://code.google.com/p/selenium/source/browse/py/selenium/webdriver/remote/webdriver.py)，`firefox.WebDriver`继承自`remote.WebDriver`，它具有切换选项卡和/或窗口的方法（例如第 490 行）。

您应该将浏览器设置为类变量并相应地打开窗口或选项卡。

# sql - sql int 到十进制，没有存储

> ID：14900107
> 
> 赞同：0
> 
> 时间：2013-02-15T17:30:24.607
> 
> 标签：sql

我目前正在用 MS-SQL 编写将旧数据转换为新表，旧表中的变量之一是 int。在新表中，它必须是小数（10,3），因为现在正在输入数据。旧数据也有一些空值。当我使用 round 转换数据以生成新的小数时，出现错误：

> 消息 8115，级别 16，状态 8，第 1 行将 int 转换为数据类型 numeric 的算术溢出错误。

使用以下代码：

```
insert into Data_Exchange_Claims_History (Qty_Dispense)
select convert(decimal(10,3),round(ISNULL(Qty_Dispense, 0), 3))
from dbo.Data_Exchange_Claims_History_old c 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:36:43.880

我认为问题是它怎么会失败？

An`INT`并不总是适合 a `DECIMAL(10,3)`。

`DECIMAL(10,3)`表示一共10位，其中3位在小数点右边。

换句话说，它只能表示最大为 的整数`9999999`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:39:56.063

仅当 INT <= 9,999,999 9,999,999 将变为 9,999,999.000（总共 10 位，3 位小数）时，INT 才能适合 DECIMAL 10,3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:58:25.550

在玩了一段时间后，我突然意识到我只需要将小数移动三位，所以我将这些数字除以 1000 并且它起作用了。新查询如下所示：

```
insert into Data_Exchange_Claims_History (Qty_Dispense)
select convert(decimal(10,3),(Qty_Dispense/1000))
from dbo.Data_Exchange_Claims_History_old c 
```

感谢所有为此做出贡献的人，因为它帮助我从新的角度看待这个问题。

# c# - 从类型的字符串表示中获取 List(T)

> ID：14900113
> 
> 赞同：1
> 
> 时间：2013-02-15T17:30:41.860
> 
> 标签：c#, .net, entity-framework

我有一个类型的字符串表示，我需要获取该特定类型的列表。我正在尝试这个：

```
var string_rep = "Double";
var list = _context.Entity.ToList<Type.GetType(string_rep)>(); 
```

我得到“运算符 < 不能应用于类型方法组和 System.Type 的操作数”。正确的做法是什么？欣赏它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T17:33:19.473

由于`list`如果直到运行时才知道该类型，则无法将变量键入列表的实际泛型类型，因此从一开始就对列表进行强类型化并没有真正的好处。您也可以使用：

```
var list = _context.Entity.ToList<object>(); 
```

没有办法比使用该方法获得更多的编译时支持。

虽然您可以使用反射来创建列表，例如使用：

```
public static IList ToList(this IEnumerable source, string typeName)
{
    return ToList(source, Type.GetType(typeName));
}

public static IList ToList(this IEnumerable source, Type type)
{
    var list = (IList)Activator.CreateInstance(
        typeof(List<>).MakeGenericType(type));
    foreach(object item in source) list.Add(item);
    return list;
} 
```

与第一个示例相比，使用这两个中的一个的唯一优点是向列表中添加不属于指定类型的项目会引发异常，而不是允许列表包含任何类型的`object`. 通常这并不重要，但最好让例外情况出现在您的面前，而不是允许不应该存在的项目进入列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:35:56.820

您可以在运行时使用反射来执行此操作。请参阅以下帖子：

[C#泛型列表<T>如何获取T的类型？](https://stackoverflow.com/questions/1043755/c-sharp-generic-list-t-how-to-get-the-type-of-t)

# javascript - 将 jquery 对象数组转换为 html

> ID：14900115
> 
> 赞同：1
> 
> 时间：2013-02-15T17:30:47.280
> 
> 标签：javascript, jquery, sorting, html-table

我有一个对象数组，这些对象是`<tr>`'s with children `<td>`'s 等。我怎样才能将这些对象放入 dom 中，替换它们在我的方法之前的样子？

```
<table id="trg">
    <tbody>
        <tr class="trg-quantity-head">
            <th class="trg-quantity quantity-head">Quantity</th>
            <th class="trg-quantity">0-10</th>
            <th class="trg-quantity">11+</th>
            <th class="trg-quantity">100+</th>
            <th class="trg-quantity">250+</th>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">1″&lt;/td>
            <td class="trg-price trg-price-base">$0.02</td>
            <td class="trg-price trg-price-table">$0.01</td>
            <td class="trg-price trg-price-table">$14.94</td>
            <td class="trg-price trg-price-table">$14.18</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">1-1/2”&lt;/td>
            <td class="trg-price trg-price-base">$33.27</td>
            <td class="trg-price trg-price-table">$28.02</td>
            <td class="trg-price trg-price-table">$27.00</td>
            <td class="trg-price trg-price-table">$29.03</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">1-1/4”&lt;/td>
            <td class="trg-price trg-price-base">$25.72</td>
            <td class="trg-price trg-price-table">$21.57</td>
            <td class="trg-price trg-price-table">$20.66</td>
            <td class="trg-price trg-price-table">$19.70</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">1-3/4”&lt;/td>
            <td class="trg-price trg-price-base">$48.91</td>
            <td class="trg-price trg-price-table">$43.91</td>
            <td class="trg-price trg-price-table">$42.21</td>
            <td class="trg-price trg-price-table">$40.36</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">1/2″&lt;/td>
            <td class="trg-price trg-price-base">$9.87</td>
            <td class="trg-price trg-price-table">$6.32</td>
            <td class="trg-price trg-price-table">$5.83</td>
            <td class="trg-price trg-price-table">$5.38</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">2”&lt;/td>
            <td class="trg-price trg-price-base">$58.88</td>
            <td class="trg-price trg-price-table">$53.88</td>
            <td class="trg-price trg-price-table">$51.16</td>
            <td class="trg-price trg-price-table">$49.50</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">3/4″&lt;/td>
            <td class="trg-price trg-price-base">$15.27</td>
            <td class="trg-price trg-price-table">$10.65</td>
            <td class="trg-price trg-price-table">$10.24</td>
            <td class="trg-price trg-price-table">$9.52</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">3/8″&lt;/td>
            <td class="trg-price trg-price-base">$8.52</td>
            <td class="trg-price trg-price-table">$5.44</td>
            <td class="trg-price trg-price-table">$4.54</td>
            <td class="trg-price trg-price-table">$4.16</td>
        </tr>
        <tr class="trg-variations">
            <td class="trg-variation">5/8″&lt;/td>
            <td class="trg-price trg-price-base">$11.43</td>
            <td class="trg-price trg-price-table">$7.80</td>
            <td class="trg-price trg-price-table">$7.35</td>
            <td class="trg-price trg-price-table">$6.85</td>
        </tr>
    </tbody>
</table> 
```

这是我用来运行和排序此表的 js：http: [//jsfiddle.net/uxRmr/1/](http://jsfiddle.net/uxRmr/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:23:52.923

David Ferogi 的 Fiddle 的重构版本。

* * *

## [重构小提琴](http://jsfiddle.net/vol7ron/uxRmr/8/)

```
function sortByRationalValue (a,b){
    return a.rationalValue - b.rationalValue;
}
function returnObjectFromMeasurements(element, text) {
    var obj     = {},
        range   = text.replace(/["'”″]/g, '').split('-'),
        rational;

    if (range.length > 1)
        rational = eval(range[0]) + eval(range[1]);
    else
        rational = eval(range[0]);

    obj.rationalValue = rational;
    obj.element       = element;
    return obj;
}

(function run(){
    var tableVars     = [],
        tableElements = [];

    var $tr = $("table#trg tr.trg-variations");
    $tr.each(function (index) {
        var $this = $(this);
        tableVars[index] = returnObjectFromMeasurements(this,
                                                        $this.children('td').first().text()
                                                       );
    });
    tableVars.sort(sortByRationalValue);

    $.each(tableVars, function (index, value) {
        tableElements[index] = value.element;
    });

    $('#trg tbody').html(tableElements).find('tr:odd').addClass('odd');

}()); 
```

# excel - Excel 更新列、单元格值

> ID：14900116
> 
> 赞同：0
> 
> 时间：2013-02-15T17:30:48.927
> 
> 标签：excel

所以这就是我想要做的：

```
1) Look-up A2 value in Column C.
2) The rows in Column C where A:2 value exists, then the respective cell in D will get the value
   of B.  If it does not exists then D will have a value of 0.

the formula im using in D2 is something like =LOOKUP(A2,C:C,REPLACE WITH B) and if not exists then b2 = 0 
```

我可以使用匹配但不知道如何用正确的值替换

![在此处输入图像描述](../Images/e0755a01d4a63df2ed9214da193edd9e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:41:34.227

如果我正确理解输入 - 您需要一组从某个数字开始递增 10 的数字。有2种方法：

1.  输入起始编号，例如`10000000`in `A1`。输入`A2`公式：`=A1+10`并根据需要自动填充（或只是复制和粘贴）尽可能多的行。
2.  `10000000`输入`A1`，然后`10000010`输入`A2`，选择**两个**单元格并使用鼠标拖动右下角 - 这将产生递增的值。

希望这会有所帮助。

**编辑：**

在聊天中讨论后，解决方案是这样的（假设上传的屏幕示例）：

1.  在当前数据上方添加行，A、B 和 C 中的零。
2.  C 列：`1`在 C3 中，`=C3+10`在 C4 中并自动填充，或者只是从 1 开始以 10 递增的值：1、11、21、...
3.  D 列：`=VLOOKUP(B2,A:C,3,0)`在 D2 及以下。这将从 C 列返回新生成的值，该值对应于 A 中**同一行**的该值，即对于 D5，它是 11，因为 B5 等于 1100000000，这是 A4，C4 中对应的是 11。

总而言之，它看起来像这样：

![样本](../Images/ce6f3bb8c633ef565dd78900b3e62c94.png)

附上示例文件：[https ://www.dropbox.com/s/wlc70q92oefiewe/IDsGeneration.xlsx](https://www.dropbox.com/s/wlc70q92oefiewe/IDsGeneration.xlsx)

# postgis - PostGIS 函数中的 PostgreSQL 查询

> ID：14900120
> 
> 赞同：0
> 
> 时间：2013-02-15T17:30:57.373
> 
> 标签：postgis

我正在尝试运行以下 PostGIS 查询：

```
select ST_distance_spheroid(
  ST_GeomFromText('POINT(
    (select AsText(location) from test where name="EGMC")
  )', 4326),
  ST_GeomFromText('POINT(
    (select AsText(location) from test where name="EGDY")
  )', 4326),
  'SPHEROID["WGS_1984",6378137,298.257223563]'
); 
```

但不断收到错误：

```
ERROR:  parse error - invalid geometry
HINT:  "POINT(
(s" <-- parse error at position 9 within geometry 
```

我很高兴我知道错误意味着什么，我只是不知道如何去实现我想做的事情。我不想手动指定位置，它存储在数据库中！我知道这个地方的名字，所以我想通过查找来获得它的位置。我应该怎么做？另外，转换成字符串来转换回来似乎有点不必要，我还能做什么？

如果我可以在不必指定变量的情况下做到这一点，那就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T22:55:26.513

[您正在混合使用不同](https://gis.stackexchange.com/a/24487/1872)的 SQL 和 WKT 。此外，您不需要重新创建已经存在的几何图形。改为查询现有几何：

```
select ST_distance_spheroid(g1.location, g2.location, 'SPHEROID["WGS_1984",6378137,298.257223563]')
from test g1, test g2
where g1.name = "EGMC" and g2.name = "EGDY"; 
```

# c# - 如何有效地仅在当前图形区域中绘制可见对象？

> ID：14900123
> 
> 赞同：1
> 
> 时间：2013-02-15T17:31:04.293
> 
> 标签：c#, algorithm, graphics, drawing, search

如何有效地仅选择在当前绘图视图中可见的图形对象？

我正在使用开源图表库 ZegGraph 来绘制数十亿个对象。ZedGraph 中的设计是循环遍历每个对象，并在给定左上角以及对象的高度和宽度的情况下计算它在当前缩放视图中是否可见。这对数千个项目来说很好，但对数百万个项目来说却变得很慢。现在我们有数十亿个超出 PC 内存的项目，因此我们将它们缓存到磁盘。当然，这使得从磁盘循环遍历它们，只找到当前视图中的少数，这是不可想象的。

一个有用的约束是对象都具有足够接近的垂直坐标，因此如果它们水平可见，那么它们有 90% 的机会在视图中。这意味着该算法可以简单地根据左右边缘是否与可见区域重叠来查找对象。

我的第一个想法是让它们按左角的 X 坐标排序。但是，对象可以具有不同的宽度，它们可以大于可见区域，因此左角可能不在屏幕上，但对象仍可能部分可见。

当然，给定 X1 和 X2 是区域的左右边缘，x1 和 x2 是每个对象的左右边缘，我们需要每个具有 x1 < X2 和 x2 > X1 的对象。

到目前为止，似乎我们以某种方式保留了所有 x1（左边缘）的短列表以及对对象的引用。还有一个包含对每个对象的引用的所有 x2（右边缘）的排序列表。

那么下一步是使用二分搜索在 x1 列表中找到满足 x1 < X2 条件的第一个吗？然后我们在 x2 列表中找到第一个满足 x2 > X1 的条件？

但是他们如何在不扫描每个项目的情况下找到 x1 和 x2 的交集呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:33:58.440

将整个区域分解为离散区域，将您的对象划分为这些区域，并仅渲染那些可见的区域。

如果他们移动，更新他们所属的区域。

# css - 让一个网页在一段时间后自动打开另一个网页？

> ID：14900124
> 
> 赞同：0
> 
> 时间：2013-02-15T17:31:05.170
> 
> 标签：css, html, webpage

嘿伙计们，我必须为我的课程做这个，这是我的确切要求

" 4 秒后，将显示第二个页面（主网页）。"

打开网站后，会出现一个欢迎页面，之后（4 秒）它会自动转到主页。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T17:33:46.397

```
<meta http-equiv="refresh" content="4;URL='home.html'"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:37:57.787

使用元标记重定向不需要 javascript

```
<meta http-equiv="refresh" content="4;URL='http://www.mysite.com/homepage.html'" /> 
```

# php - cakephp addCrumb Html Helper

> ID：14900127
> 
> 赞同：0
> 
> 时间：2013-02-15T17:31:26.040
> 
> 标签：php, jquery, ajax, cakephp, cakephp-1.3

我正在尝试在 Cake php 应用程序中使用[Html Helper](http://book.cakephp.org/1.3/en/The-Manual/Core-Helpers/HTML.html)的面包屑功能来创建面包屑轨迹。我按照他们在手册上所说的方式进行操作（一直滚动到底部以查看它），但我面临的问题是，当通过 Ajax 加载视图时（通过使用 jquery 的 .load() 函数例如），我的面包屑没有显示。我认为这是：

```
<?php echo $this->Html->addCrumb('Users', '/users'); ?> 
```

这在我的布局中：

```
<?php echo $this->Html->getCrumbs(' >> ', 'Home'); ?> 
```

但什么都没有显示。当视图不是通过 Ajax 加载时，一切都很好。谁能告诉我为什么会这样？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T09:23:10.613

您可以再次在视图中输出面包屑，隐藏，然后`.load()`将它们附加到布局中的面包屑。否则你将无法做到这一点。“布局”碎屑已被渲染，如果您`load()`用于注入内容，则不会再次渲染。

一些示例代码可以让您了解我将如何做到这一点：

```
// layout
echo '<div class="crumbs">' . $this->Html->getCrumbs() . '</div>';
echo '<div class="content"><!-- AJAX content goes here--></div>';

// view
$this->Html->addCrumb('My Page');
echo '<div class="hiddenCrumbTrail">' . $this->Html->getCrumbs() . '</div>';
echo 'Here is my page content';

// js
$(function() { 
    $('.content').load('/controller/action'); // load content
    $('.crumbs').empty(); // remove existing
    $('.crumbs').append($('.hiddenCrumbTrail')); // append with updated
}); 
```

# ruby-on-rails - 在实现 state_machine gem 之前和之后我可以测量性能差异的方法是什么？

> ID：14900130
> 
> 赞同：0
> 
> 时间：2013-02-15T17:31:50.893
> 
> 标签：ruby-on-rails, ruby, performance, benchmarking, state-machine

我几乎完成了 pluginaweek 的 state_machine gem 的实现，我想在实现它之前尝试测量一些东西，以便之后我可以重新测量并看到不同之处。现在，视图中有大量的条件逻辑来判断对象是否处于某种状态。

我的第一个猜测是在我的服务器日志中查看该主视图的加载时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:50:47.333

您可以使用多种性能测试工具。最简单的可能是 Apache 的“ab”，而更复杂/灵活的一端是 Apache Jmeter。

过程很简单：

*   选择您要衡量性能的特定页面或一组页面。
*   使用这些工具来访问您的应用程序并收集基线数据。
*   对您的应用程序进行更改并重新运行您的测试套件。
*   查看数据，看看是否有有意义的改进。如果是这样，请保留您的更改。如果没有，请删除它们。
*   重复直到你满意或放弃。:)

这显然是一个非常广泛的概述，但这就是要点。重要的是使用一致的度量和一组一致的测试条件。例如，'ab' 的相同命令行选项或 jmeter 的相同测试计划。

PS - 实际上，我不希望从你描述的变化中获得巨大的胜利。真正的胜利可能在于代码的可读性和可维护性。

# java - 集群环境中的序列化问题

> ID：14900131
> 
> 赞同：1
> 
> 时间：2013-02-15T17:31:54.190
> 
> 标签：java, servlets, serialization, weblogic

我正在尝试在具有 Weblogic 10 g 的集群环境中使用我的 Java 应用程序，并且我们遇到了会话复制问题，因为通常在会话中的许多类都没有实现 Serializable 接口。

在这些类之一中，问题是不可序列化的 ServletContext 属性。我假设这个属性应该用瞬态关键字标记是否正确？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:34:04.903

如果您不需要它持久化，您可以标记它`transient`，序列化将忽略它。请记住，当它被反序列化时它将为空......

# .net - Windows 7 和 Windows 8 中的 ListBox 边距不同

> ID：14900132
> 
> 赞同：11
> 
> 时间：2013-02-15T17:31:56.783
> 
> 标签：.net, wpf, windows-7, windows-8, listbox

我已经设计了一个 WPF 列表框。我在Windows 8下开发。设置样式如下（见图）后，当我在Windows 7中测试应用程序时，边距不一样。正如您在图像中看到的，节点之间的间隔在 Windows 8 中为 1px，但在 Windows 7 中为 0 px。

![在此处输入图像描述](../Images/1060d9488e1bc93a5c300f00ff17ac14.png)

你知道这是为什么，以及如何解决吗？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T15:43:28.220

实际上我自己设法摆脱了它，看起来它的 ListViewItem 样式正在被 Windows8 更改，向 ListView 的本地资源添加样式对我有用。

```
 <ListView.Resources>
        <Style TargetType="ListViewItem">
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </ListView.Resources> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-01T13:52:38.793

默认的 ListBoxItem 包含一个边框。ListBoxItem 还指定了一个由此边框继承的填充。它的 Padding DP 需要像 Andy 提到的那样设置。

# javascript - 使用 .prop(hidden: true) 在 JQuery 中隐藏按钮

> ID：14900138
> 
> 赞同：14
> 
> 时间：2013-02-15T17:32:23.093
> 
> 标签：javascript, jquery, google-chrome, button

我试图弄清楚如何使用 .prop(hidden: true) 方法隐藏带有 JQuery 的按钮。出于某种原因，在 Chrome 中，当我设置此值并查看 html 时，该按钮有一个隐藏元素，但该按钮仍显示为在页面上可见。

有任何想法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-15T17:35:16.087

按钮没有隐藏属性？

```
$('button').hide(); 
```

或者

```
$('button').toggle(true);  //shows button
$('button').toggle(false); //hides button 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-15T17:35:28.210

您可以使用将`display`样式设置为`none`. 例如，

```
$("#button").css("display", "none"); 
```

或者，`.hide()`为简洁起见，

```
$("#button").hide() 
```

还有`visibility`，`opacity`但是这两个可能不会产生你想要的效果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T17:38:28.770

您不能使用 jQuery 的`.prop()`功能隐藏按钮，您必须使用其中一个，`.hide() or .fadeOut()`或者您可以尝试使用`.css()`以下方法：

使用`.css()`：

```
$('input[submit]').css('display','none'); 
```

使用`fadeOut()`：

```
$('input[submit]').fadeOut(); 
```

使用`.hide()`：

```
$('input[submit]').hide(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T17:35:09.403

您的语法不正确，但无论如何都没有“隐藏”属性。你可能想要：

```
$('#your_button').hide(); 
```

或者可能

```
$('#your_button').addClass('hidden'); 
```

如果你的 CSS 中有一个“隐藏”类。

语法的错误部分是函数调用的参数表达不正确。设置属性应如下所示：

```
$("#your_button").prop("name", "value"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T17:35:24.140

jQuery.prop[仅用于 HTML 属性](http://api.jquery.com/prop/)，即在 DOM 节点上定义的东西。CSS 样式不适用于用 prop 设置的东西，`hidden`只是不存在，而`href`or`class`是适用的。相反，您必须使用`$(el).css('display', 'none')`or `$(el).hide()`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-10-07T10:42:16.653

如果您碰巧将 jquery 与 bootstrap4 一起使用，那么您所描述的实际上是正确的。

只需执行以下操作： `$element.prop('hidden', true);`

如果没有可用的 bootstrap 4，它仍然适用于现代浏览器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-15T17:36:45.383

prop() 是一个 getter 函数：[http](http://api.jquery.com/prop/) ://api.jquery.com/prop/我建议使用隐藏：[http ://api.jquery.com/hide/](http://api.jquery.com/hide/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-15T18:21:18.030

如果你想使用道具，那么

```
$("#my_button").prop("style").display="none" 
```

我会去w/o jquery。（回到基础）

```
document.getElementById("mybutton").style.display = "none"; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-03T19:52:29.280

您可以使用`ternary`运算符和`css()`方法来完成相同的事情：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator)

```
$("#button").css("display", (mycondition) ? "block" : "none"); 
```

# ios - 以某种方式使用 iOS API 用 Facebook 页面标记照片

> ID：14900141
> 
> 赞同：0
> 
> 时间：2013-02-15T17:32:34.700
> 
> 标签：ios, facebook, facebook-graph-api

我试图用粉丝页面标记一张照片，但我只成功地在照片上标记了用户。

后来我在 Facebook API 参考中发现“......目前，您无法使用此 API 在照片中标记页面。” 我生气了！

所以我在这里问你们。无论如何要在照片中标记页面吗？反正？！

在绝望和哭了很久之后，我有了一个想法，“我会在 iOS 上使用 web Facebook API”。但我真的不知道它是否能解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T23:33:21.313

根据此[文档](https://developers.facebook.com/docs/reference/api/photo/)，您是对的，“您不能使用此 API 在照片中标记页面。”

如果工程师花时间专门提到这一点，那么这是设计使然，这是不可能的。

# facebook - 是否有任何适用于 c# 的 facebook api 可用于 windows phone 以获取附近的地方（atms/hotels）？

> ID：14900144
> 
> 赞同：0
> 
> 时间：2013-02-15T17:32:45.477
> 
> 标签：facebook, windows-phone-7, facebook-graph-api, windows-phone-7.1, windows-phone-8

是否有任何 facebook c# api 可用于 windows phone 来获取附近的地方（atms/hotels/hospitals/着名的地方等）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:24:22.933

**不**，没有可用的内置 API 端点，但非常欢迎您下载[Facebook SDK](http://nuget.org/packages/Facebook/5.3.2.0)并使用它连接到 Graph API。

# iframe - 滚动 iframe 而无需将鼠标悬停在它上面

> ID：14900146
> 
> 赞同：0
> 
> 时间：2013-02-15T17:32:46.867
> 
> 标签：iframe, scroll, mouseover

我有一个 iframe 用于显示网页的主要内容；但是，无论鼠标指向何处，我都想让 IFRAME 滚动。我不希望我的访问者因为无法滚动而感到困惑，除非他们的鼠标位于 iframe 上。这可能吗？用鼠标悬停在身体​​上的任何地方滚动 iframe？

我不会链接任何代码，因为我拥有的唯一相关代码是 <iframe></iframe> 标记。

（正文本身不可滚动，隐藏滚动条）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:56:34.207

好吧。我为此制定了一个相当快速而肮脏的解决方案，其中包括以下步骤：

*   `<iframe>`为您的元素添加一个“id” 。（在我的例子中，我使用了`id="myFrame"`）
*   将**jQuery Mousewheel**插件与最新的 jQuery 一起附加到 html 页面的标题。

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script type="text/javascript" src="https://raw.github.com/brandonaaron/jquery-mousewheel/master/jquery.mousewheel.js"></script> 
```

*   最后在 html 正文的末尾或iframe 本身**之后添加以下 javascript 代码。**

```
<script type="text/javascript">
    var scrolloffset = 30;  // amount of scrolling per mousewheel step

    var myFrame = $('#myFrame');  // the iframe ID
    var frameScrollPosition = 0;

    $(window).mousewheel(function(event,delta){

        // reset stored offset so that it matches with iframe's
        frameScrollPosition = myFrame.contents().scrollTop();

        var frameHeight = myFrame.contents().height() - myFrame.height();

        if(delta > 0){
            var newPosition = frameScrollPosition - scrolloffset;
        } else {
            var newPosition = frameScrollPosition + scrolloffset;
        }

        if(newPosition < 0){
            newPosition = 0;
        }

        if(newPosition >= frameHeight){
            newPosition = frameHeight;
        }

        frameScrollPosition = newPosition;
        myFrame.contents().scrollTop(frameScrollPosition);

    });
</script> 
```

确保你[**下载**](https://github.com/brandonaaron/jquery-mousewheel/downloads)了插件，而不是像我一样从 github 调用它。这只是为了测试和概念验证。

# asp.net - Web API 中的客户端证书和基于声明的身份

> ID：14900150
> 
> 赞同：4
> 
> 时间：2013-02-15T17:32:59.610
> 
> 标签：asp.net, asp.net-web-api, ssl-certificate, wif, claims-based-identity

如果通过 HTTPS 访问作为 ASP.NET Web API 控制器实现的端点的客户端提供客户端证书，则该证书可通过`Request.GetClientCertificate`. 但是，我想知道：是否有可能以与 .NET 4.5 中的安全模型集成的基于声明的模型的形式提供信息？

我想这样做的主要原因是我需要不同的客户端能够以不同的方式进行身份验证来访问相同的服务，所以我更愿意从证书等细节中抽象出来。我希望我的控制器能够根据当前用户的声明做出决定，而不用担心这些声明的出处。

我知道有一种`X509CertificateClaimSet`类型，它看起来像是自然流动：

1.  通过 TLS/SSL 传递的客户端证书被表示为`X509CertificateClaimSet`通过某种令牌映射过程（类似于您可以用于 ACS 的联合提供程序生成的传入 cookie 如何由`SessionSecurityTokenHandler`
2.  声明转换模块（从元素派生`ClaimsAuthenticationManager`并配置有`<claimsAuthenticationManager>`元素）检查来自证书的声明集，并将其转换为非令牌特定的应用程序特定声明
3.  处理程序查找特定于应用程序的声明。

甚至还有一个`X509SecurityTokenHandler`，听起来应该这样做。但是，据我所知，这是为在发送的消息中处理基于证书的身份验证的场景而设计的——它似乎不支持证书所有权证明发生在传输级别，即作为 TLS/SSL 握手的一部分。

我想知道是否需要编写自己的模块来执行此操作。从理论上讲，它看起来可能只是处理`AuthenticateRequest`事件，查看证书请求，`X509CertificateClaimSet`如果证书存在则从证书构造一个。但是……然后呢？我只是创建自己的`ClaimsPrincipal`并替换现有用户吗？还是有一些“正确”的方法可以将我发现的声明添加到集合中？（客户端证书不一定是声明的唯一来源 - 我的应用程序已经在使用来自与 ACS 集成的声明。是否有标准机制来确保正确合并所有可能的声明来源？）

看起来`SessionAuthenticationModule`（SAM）是当前提供声明主体的身份模型组件，它只是替换了先前在上下文中的那个，也是当前线程的用户。但它似乎提供了可扩展性——如果你覆盖它`ValidateSessionToken`，它会返回`ClaimsIdentity`构成主体的对象集。所以理论上，我可以覆盖它并在那时添加任何额外的声明。

但我不确定这是要走的路。据我所知，SAM 在`ClaimsAuthenticationManager`完成声明转换后执行此操作。或者索赔转换是错误的模型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T21:15:36.030

看看[这里](http://leastprivilege.com/2012/08/20/support-for-x-509-client-certificates-in-thinktecture-identitymodel-for-web-api/)：客户端证书身份验证和声明生成是其中的一部分`Thinktecture.IndetityModel`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T19:10:03.240

如果我是你，我会将身份验证外部化 - 让其他一些服务提供身份验证并返回带有所需声明的 SAML 令牌。

这样，在您的应用程序中，您并不会真正想到证书，您只是期望来自联合身份提供者的一些具体声明。

然后，您实施您的身份提供者之一以实际接受证书，但传出 SAML 隐藏此实施细节并将证书转换为对您的应用程序有用的声明集。

# sql - 加入Oracle中的最佳记录，如果有的话

> ID：14900154
> 
> 赞同：0
> 
> 时间：2013-02-15T17:33:07.627
> 
> 标签：sql, oracle, select, oracle11g, ranking

我有一个相当复杂的 Oracle 查询，从多个表中获取数据。在其中一个连接中，我想要最好的记录，如果有的话。因此，左外连接。有一个开始日期字段，因此对于大多数记录，获取最大开始日期将使我获得最佳记录。但是，偶尔会有记录具有相同的开始日期。在这种情况下，还有一个状态字段。但是，最佳状态值不是最小值或最大值。“20”最好，“05”或“40”都可以，“70”最差。当返回多条记录时，如何设置查询以找到最佳选项？

所以，如果我有以下数据

```
Table1                       Table2
ID     otherData             ID      date      status    otherData
1      stuffa                1       jan-1-13  20        stuff93
2      stuff3                
3      stuff398              3       jan-2-13  20        stuff92
                             3       jan-2-13  70        stuff38
                             3       dec-3-12  20        stuff843 
```

我将能够查询并获得以下信息：

```
1   stuffa    jan-1-13  20  stuff93
2   stuff3
3   stuff398  jan-2-13  20  stuff92 
```

现在，我的查询如下，得到第二条记录 3，状态为 70：

```
select *
from table1 t1
left outer join
   (select *
    from table2 t2a
    where t2a.date = (select max(t2b.date)
                        from table2 t2b
                       where t2b.id = t2a.id)
    ) t2
  on (t2.id = t1.id) 
```

有没有办法在 select 语句中设置有序枚举或类似的东西？就像是

```
rank() over ( partition by status order by ('20','05','40','70') rank 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:38:41.970

如果有序枚举的元素很少，您可以使用它

```
 ........         order by 
                  CASE status WHEN '20' THEN 1
                              WHEN '05' THEN 2
                              WHEN '40' THEN 3
                              WHEN '70' THEN 4
                  END) rank 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:43:57.057

像这样将状态添加到订单中；

```
select *
  from (select t1.id,  t1.otherdata otherdatat1, t2.date, t2.status, t2.otherdata otherdatat2,
               rank() over (partition by t1.id order by t2.date desc,
                            case t2.status
                              when '20' then 1
                              when '05' then 2
                              when '40' then 3
                              when '70' then 4
                              else 5
                            end) rnk
          from table1 t1
               left outer join table2 t2
                            on t1.id = t2.id)
 where rnk = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:41:11.313

您可以执行以下操作：

```
select t1.id, t1.otherdata, t2.dt, t2.status, t2.otherdata 
from table1 t1
left outer join (
    select t2a.*,
        row_number() over (partition by id order by dt desc,
            case status
                when '20' then 1
                when '05' then 2
                when '40' then 3
                when '70' then 4
                else 5 end) as rn
    from table2 t2a
    ) t2 on t2.id = t1.id and t2.rn = 1
order by t1.id; 
```

这假设即使有两个具有相同的状态，您也想要一个命中；你得到的两个中的哪一个是不确定的。如果你想要两者都可以使用`rank()`。无论哪种方式，您都根据日期（降序，因为您想要最大值）和您自己的状态值顺序为每条记录分配排名，然后只选择连接条件中排名最高的。

数据设置为：

```
create table table1(id number, otherdata varchar2(10));
create table table2(id number, dt date, status varchar2(2), otherdata varchar2(10));

insert into table1 values(1, 'stuffa');
insert into table1 values(2, 'stuff3');
insert into table1 values(3, 'stuff398');

insert into table2 values(1, date '2013-01-01', '20', 'stuff93');
insert into table2 values(3, date '2013-01-02', '20', 'stuff92');
insert into table2 values(3, date '2013-01-02', '70', 'stuff38');
insert into table2 values(3, date '2012-12-03', '20', 'stuff843'); 
```

...这给出了：

```
 ID OTHERDATA  DT        STATUS OTHERDATA
---------- ---------- --------- ------ ----------
         1 stuffa     01-JAN-13 20     stuff93    
         2 stuff3                                 
         3 stuff398   02-JAN-13 20     stuff92 
```

# ios - 最后一个块返回时的触发方法

> ID：14900159
> 
> 赞同：3
> 
> 时间：2013-02-15T17:33:21.313
> 
> 标签：ios, block

当我确信两个块代码都已返回时，我如何触发方法？像这样...

```
// Retrieve Messages Array from Parse
[ParseManager retrieveAllMessagesForShredderUser:(ShredderUser *)[PFUser currentUser] withCompletionBlock:^(BOOL success, NSError *error, NSArray *objects){
        self.messagesArray = objects;
    }];

// Retrieve MessagesPermissions Array from Parse
[ParseManager retrieveAllMessagePermissionsForShredderUser:(ShredderUser *)[PFUser currentUser] withCompletionBlock:^(BOOL success, NSError *error, NSArray *objects){
        self.messagePermissionsArray = objects;
    }];

-(void)methodToRunWhenBothBlocksHaveReturned{
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:38:56.373

如果您可以保证块将在同一个线程（即 UI 线程）上执行，那么替代方案很简单，使用`__block`变量。

```
-(void)yourMethod {
    __block int count = 0;
    [ParseManager retrieveAllMessagesForShredderUser:(ShredderUser *)[PFUser currentUser] withCompletionBlock:^(BOOL success, NSError *error, NSArray *objects){
        self.messagesArray = objects;
        count++;
        if (count == 2) {
             [self methodToRunWhenBothBlocksHaveReturned];
        }
    }];

    [ParseManager retrieveAllMessagePermissionsForShredderUser:(ShredderUser *)[PFUser currentUser] withCompletionBlock:^(BOOL success, NSError *error, NSArray *objects){
        self.messagePermissionsArray = objects;
        count++;
        if (count == 2) {
             [self methodToRunWhenBothBlocksHaveReturned];
        }
    }];
}

-(void)methodToRunWhenBothBlocksHaveReturned{
} 
```

如果您没有相同线程的保证，您可以使用[锁](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSLock_Class/Reference/Reference.html)来确保变量的增量（以及与 2 的比较）将是原子的。

# r - R - 遍历每一行并填充上一行的值

> ID：14900165
> 
> 赞同：5
> 
> 时间：2013-02-15T17:33:42.107
> 
> 标签：r, loops

我想测试来自特定列的值是否包含 NA 值，如果是，则用前一行的值填充该 NA 空间。我仍在尝试掌握`apply`函数系列的窍门。

例如我想把这个：

```
 Date   Balance
2012-01-01      1000
2012-01-02        NA
2012-01-03        NA
2012-01-04      1200
2012-01-05      1215
2012-01-06        NA 
```

进入：

```
 Date   Balance
2012-01-01      1000
2012-01-02      1000
2012-01-03      1000
2012-01-04      1200
2012-01-05      1215
2012-01-06      1215 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T17:36:57.883

这是`na.locf`zoo 包中的功能任务。看`?na.locf`

考虑一下`DF`你的data.frame，然后：

```
DF <- read.table(text="      Date   Balance
2012-01-01      1000
2012-01-02        NA
2012-01-03        NA
2012-01-04      1200
2012-01-05      1215
2012-01-06        NA", header=TRUE)

library(zoo)
na.locf(DF)
        Date Balance
1 2012-01-01    1000
2 2012-01-02    1000
3 2012-01-03    1000
4 2012-01-04    1200
5 2012-01-05    1215
6 2012-01-06    1215 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-15T18:32:07.270

使用`data.table`with`roll = TRUE`也能很好地做到这一点！

```
require(data.table)
# convert Date column to date format
df$Date <- as.Date(df$Date)
# keep this, as we'll remove rows with NA to use `roll`
dates   <- df$Date
# remove rows with NA
dt2     <- na.omit(data.table(df))
# set key to Date
setkey(dt2, "Date")
# use dates which has the NA rows that will be filled 
# with value from previous column with roll=T
dt2[J(dates), roll=T]

#          Date Balance
# 1: 2012-01-01    1000
# 2: 2012-01-02    1000
# 3: 2012-01-03    1000
# 4: 2012-01-04    1200
# 5: 2012-01-05    1215
# 6: 2012-01-06    1215 
```

# sencha-touch - 销毁视图之间切换的东西

> ID：14900169
> 
> 赞同：0
> 
> 时间：2013-02-15T17:33:56.310
> 
> 标签：sencha-touch, sencha-touch-2

在我的程序中，我有 2 个“屏幕”，第一个有一个列表，如果我按下一个项目，我会转到第二个屏幕……在第二个屏幕中，第一个屏幕有一个返回按钮……</p>

当我拳头返回时，我会收到此警告

```
WARN][Ext.Component#constructor] Registering a component with a id (`usernamelabel`)
which has already been used. Please ensure the existing 
component has been destroyed (`Ext.Component#destroy()`. 
```

在控制器中我尝试了这样的事情：

```
 itemUp: function (dataview, index, target, record, e, Opst ) {
Ext.Viewport.animateActiveItem({xtype: 'mytabpanel'},{ type: 'flip' );
var store = Ext.getStore('Customers');
store.clearFilter();
Ext.destroy(this.searchField);
Ext.destroy(this.clientsList);
 } 
```

但不起作用..如何摧毁整个“屏幕”？

PS：如果我在 iOS 或 android 设备上运行程序，我会看到相同的“主题”……如何专门化主题？（在我的 win 手机 7.8 上不起作用.. 正常吗？）

多谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:53:05.137

这是因为你 harcoded `id: usernamelabel`，所以当你第二次启动它时，你会得到上面的警告信息。如果您使用，您将是安全的`itemId`

# php - Facebook API 未返回“已安装”字段

> ID：14900174
> 
> 赞同：0
> 
> 时间：2013-02-15T17:34:05.663
> 
> 标签：php, facebook, facebook-graph-api

使用他们的 PHP SDK 调用 Facebook API 时，我无法获得“已安装”的值。

这是我正在使用的代码：

```
$apiresult = $facebook->api("/$currentUserFbId/friends?fields=id,name,installed,picture");

//print_r reveals that only id, name, and picture exist in the returned object
print_r($apiresult); 
```

有没有其他人遇到过这个问题？不`longer`支持安装吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:44:58.437

该`installed`字段仅在为真时返回。我假设您的朋友都没有安装该应用程序。

# netbeans - Windows 上的 Netbeans FTP 问题

> ID：14900176
> 
> 赞同：0
> 
> 时间：2013-02-15T17:34:13.497
> 
> 标签：netbeans, ftp, netbeans-7

我在我的 Windows 8 计算机和我的 Ubuntu 12.10 计算机上安装了 Netbeans。在我的 Ubuntu 计算机上 FTP 工作得非常好，但在我的 Windows 计算机上它只能工作几次。

通常当我在 Windows 机器上下载文件时，它会下载大部分文件，然后下载其余文件失败。当我上传文件时，它有时会上传，也就是：

*   Netbeans 坐下来加载，然后询问我是否要为会话保持 FTP 开放。
*   Netbeans 保存文件然后甚至不上传它（可能是不同的问题）

但是在 Ubuntu 上我没有任何这些问题。什么会导致这种情况？

# java - 使方法同步或在方法中添加同步块之间有区别吗？

> ID：14900177
> 
> 赞同：2
> 
> 时间：2013-02-15T17:34:15.583
> 
> 标签：java, multithreading, synchronized

这两个代码块的行为是否相同？您可以假设这些运行方法是从线程调用的。

```
public synchronized void run() {
    System.out.println("A thread is running.");
} 
```

或者

```
static Object syncObject = new Object();

public void run() {
    synchronized(syncObject) {
        System.out.println("A thread is running.");
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T17:35:22.657

```
public synchronized void run()
{
    System.out.println("A thread is running.");
} 
```

相当于：

```
public void run()
{
    synchronized(this) // lock on the the current instance
    {
        System.out.println("A thread is running.");
    }
} 
```

* * *

并供您参考：

```
public static synchronized void run()
{
    System.out.println("A thread is running.");
} 
```

相当于：

```
public void run()
{
    synchronized(ClassName.class) // lock on the the current class (ClassName.class)
    {
        System.out.println("A thread is running.");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:39:49.770

不，正如您所说的那样，没有区别，但是如果该方法是静态方法，则同步块会将封闭类的类对象作为锁。

# jax-ws - JAX-WS | 在逻辑处理程序中获取操作名称

> ID：14900179
> 
> 赞同：0
> 
> 时间：2013-02-15T17:34:26.120
> 
> 标签：jax-ws

我有一个从我的 WSDL 生成的 JAX-WS 2.0 Web 服务实现。

我需要在我的逻辑处理程序实现中访问 Web 服务操作名称。

我使用以下方法来解决这个问题，但它总是返回 null。

context.get(MessageContext.WSDL_OPERATION);

如果你们中的任何人都可以帮助我解决这个问题，那就太好了。

我的服务器是 WAS 7.0，开发 IDE 是 RAD 8。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T08:09:14.420

如果您想要 SOAPAction Header 并且它包含 Web 服务名称（就像我的一样），您可以使用它来打印它：

```
private void inLogger(SOAPMessageContext context){
    HttpServletRequest req = (HttpServletRequest)context.get(MessageContext.SERVLET_REQUEST);
    System.out.println(req.getHeader("SOAPAction"));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-03T18:16:33.550

如果您的处理程序正在实施`LogicalHandler<LogicalMessageContext>`，您可以这样做：

```
((QName)context.get( LogicalMessageContext.WSDL_OPERATION )).getLocalPart(); 
```

这将返回被调用的操作的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T10:47:16.327

您可以尝试这种方式：

1）通过requestContext设置参数：

```
 Map<String, Object> requestCtx = dispatcher.getRequestContext();
 requestCtx.put("operationName", "anyOperation"); 
```

2) 在 WS LogicalHandler 的 handleMessage 中检查这个参数：

```
 public boolean handleMessage(LogicalMessageContext messageContext) {
    boolean isCustomOperation = messageContext.containsKey("operationName");
    if (isCustomOperation) {
    // do smth..
    }
    return true;
 } 
```

# java - Simplexml 值必需的异常

> ID：14900188
> 
> 赞同：0
> 
> 时间：2013-02-15T17:34:51.853
> 
> 标签：java, android, xml, xml-parsing, simple-framework

我收到一个 valuerequired 异常错误，我无法理解。如果我将 xmlns 设置为 required = false 一切正常，但 xmlns 值为空，尽管所有其他值都按预期设置。

我正在阅读的xml：

```
<test xmlns="somestring"           
id="123456"   
timestamp="2013-05">         
<value1>12</value1>     
<value2>3 </value2>    
</test> 
```

这是错误消息：

02-15 18:05:55.988: W/System.err(31450): org.simpleframework.xml.core.ValueRequiredException: 无法满足@org.simpleframework.xml.Attribute(empty=, name=xmlns, required=true ) 字段 'xmlns' 私有 java.lang.String parsing.Test.xmlns 用于第 1 行的类 parsing.Test

代码：

```
 @Root(name = "test") 
public class Test {

    @Element(name = "value1")
    private String value1;
    @Element(name ="value2")
    private String value2;

    @Attribute(name = "xmlns")
    private String xmlns;
    @Attribute(name = "id")
    private String id;
    @Attribute(name = "timestamp")
    private String timestamp;

    public Test () {
    }

    public Test (String value1, String value2, String xmlns, String id, String timestamp) {
        this.value1 = value1;
        this.value2 = value2;
        this.xmlns = xmlns;
        this.id = id;
        this.timestamp = timestamp;
    }

    public String getValue1() {
        return value1;
    }

    public String getValue2 () {
        return value2;
    }
    public String getXMLns () {
        return xmlns;
    }
    public String getId () {
        return id;
    }
    public String getTimeStamp () {
        return timestamp;
    }} 
```

序列化方法：

```
public Test DeSerialize (String xml) {
    //System.out.println("xml:  \n " + xml);
    try {
        test = serializer.read(Test.class, xml);
    } catch (Exception e) {
        e.printStackTrace();
    }
    return test;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T10:16:49.093

属性 xmlns 是为命名空间保留的，这就是您收到错误的原因。

# c# - 为什么我动态创建的标签无法按要求对齐？

> ID：14900189
> 
> 赞同：0
> 
> 时间：2013-02-15T17:35:00.397
> 
> 标签：c#, label, panel

当我将标签的 ContentAlignment 属性设置为 MiddleRight 时，我希望它与我放置它的面板中的右侧对齐。相反，它顽固地保持左对齐。为什么会这样，我该如何解决？这是我的代码：

```
private void CreateNewLabel(int YPos, string DisplayStr, ContentAlignment contentAlign,
                            int FontSize)
{
    Label lbl = new Label();
    //lbl.Left = DEFAULT_XPOS;
    lbl.Font = new Font(lbl.Font.Name, FontSize, lbl.Font.Style);
    lbl.Top = YPos;
    lbl.Text = DisplayStr;
    lbl.TextAlign = contentAlign;
    lbl.AutoSize = true;
    panelFauxLabel.Controls.Add(lbl);
} 
```

除了水平放置外，一切都在工作。我不想设置 Left 属性，因为我希望某些对齐能够占据所有“右侧”空间；我敢肯定，计算 XPos 是可能的，但也相当复杂，我更确定。

## 更新

奥利维尔的回答效果很好。现在的代码是：

```
 private void CreateNewLabel(int YPos, string DisplayStr, ContentAlignment contentAlign, int FontSize)
    {
        Label lbl = new Label();
        lbl.Left = DEFAULT_XPOS;
        lbl.Font = new Font(lbl.Font.Name, FontSize, lbl.Font.Style);
        lbl.Top = YPos;
        lbl.Text = DisplayStr;
        lbl.TextAlign = contentAlign;
        if (contentAlign.Equals(ContentAlignment.MiddleRight))
        {
            lbl.Anchor = AnchorStyles.Right;
        }
        else // there is no AnchorStyles.Center or AnchorStyles.Middle
        {
            lbl.Anchor = AnchorStyles.Left;
        }
        lbl.AutoSize = false;
        lbl.Width = panelFauxLabel.Width;
        panelFauxLabel.Controls.Add(lbl);
    } 
```

## 更新 2

我不得不对标签的高度进行调整，以防止大字体在膝盖处被截断，可以这么说：

```
 // This factor was just a guess, but it seems to work pretty well
    double down = Math.Round(FontSize*1.5);
    lbl.Height = Convert.ToInt32(down); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:55:33.393

`TextAlign`对齐标签内的文本，而不是面板内的标签。考虑使用该`Anchor`属性将标签与面板的右边缘对齐。

* * *

**更新**

这是如何做到的：使标签与面板的宽度相同，将标签锚定在顶部、左侧和右侧

```
lbl.TextAlign = contentAlign;
lbl.AutoSize = false;
lbl.Anchor = AnchorStyles.Top | AnchorStyles.Left | AnchorStyles.Right;
lbl.Top = YPos;
lbl.Left = 0;
lbl.Width = panelFauxLabel.ClientSize.Width; // ClientSize takes account of scroll
                                             // bars, borders and padding.
panelFauxLabel.Controls.Add(lbl); 
```

现在标签与面板一起调整大小，文本在标签内正确对齐。设置`lbl.AutoSize`为`false`以使标签大小与文本长度无关。

# jquery - 使用 JQuery 设置 HiddenField 的值，但无法在代码隐藏中读取值

> ID：14900193
> 
> 赞同：0
> 
> 时间：2013-02-15T17:35:14.780
> 
> 标签：jquery, asp.net

这是我的 HTML 代码

```
<table>
  <tr>
     <th>
         Department Comments:
     </th>
     <td>
         <asp:TextBox ID="txtDepartmentComments" runat="server" Columns = "45" 
              TextMode = "MultiLine" CssClass = "txtComments" ></asp:TextBox>
         <asp:HiddenField ID = "hfDptComments" runat = "server" />

     </td>
     <td>
         <asp:Button ID="btnComplete" runat="server" Text="Completed" 
          CssClass = "button-save" />
     </td>
   </tr>
</table> 
```

这是我的jQuery代码

```
$('[id*="btnComplete"]').click(function () {
    var $val = $(this).closest('tr').find('[id*="txtDepartmentComments"]').val();
    var hfDptComments = $(this).closest('tr').find('[id*="hfDptComments"]');
    $(hfDptComments).prop('value', $val);

    alert($(hfDptComments).val());
}); 
```

这只是一个虚拟代码，用于测试该值是否正在发送到服务器。

```
protected void Page_Load(object sender, EventArgs e)
{
   string strDptComments = this.hfDptComments.Value;
} 
```

当我键入内容并运行应用程序时，javascript 框消息会显示我键入的内容。但是，当我在后面的代码中设置断点时，总是得到一个空字符串。

知道为什么吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:43:42.697

您应该尝试使用设置`.val()`值

```
$(hfDptComments).val($val); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:55:30.237

尝试使用这个：

```
hfDptComments.prop('value', $val);

hfDptComments.attr('value', $val);

hfDptComments.val($val); 
```

`hfDptComments`它已经是一个 jquery 对象。尝试其中之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:56:20.170

正常编写您的 javascript 函数（无需通过 jQuery 进行事件绑定），例如：

```
function SetMyValue() {
    var $val = $('#<%# btnComplete.ClientID %>').closest('tr').find('[id*="txtDepartmentComments"]').val();
    var hfDptComments = $(this).closest('tr').find('[id*="hfDptComments"]');
    $(hfDptComments).val($val);
} 
```

在按钮的标记中设置`OnclientClick`属性（将回发），例如：

```
<asp:Button ID="btnComplete" runat="server" Text="Completed" OnClientClick="return SetMyValue();"
          CssClass = "button-save" /> 
```

# wpf - 将 Observable Collection 从基类转换为继承类

> ID：14900210
> 
> 赞同：0
> 
> 时间：2013-02-15T17:36:04.357
> 
> 标签：wpf, c#-4.0

我正在编写一个 WPF 应用程序，我目前正在将一些重用代码重构为我的其他视图模型可以继承的基本 ViewModel 类。

此基类上的一个 Property 字段是

```
public class MessageParentBase
{
  MessageParentBase() {}

  public string Name;
}

internal ObservableCollection<MessageParentBase> _GridData = new ObservableCollection<MessageParentBase>(); 
```

我有一个后续的财产声明

```
public ObservableCollection<MessageParentBase> GridData
    {
        get { return _GridData; }
        set { _GridData = value; }
    } 
```

这很好用，我的问题是 inerited 类实际上使用了 follow 类

```
Public class ChatMessage : MessageParentBase
{
    public string Message;
} 
```

并且视图包含一个绑定到此 GridData 属性的数据网格，但应该绑定到 ChatMessage 类的 Message 字段的列是空白的，并且在 MessageParentBase 类中找到的字段被填充。

所以我认为视图不知道从 MessageParentBase 类转换为 ChatMessage 存在问题。

我可以通知视图对象将属于“ChatMessage”类型。

我确实尝试将属性声明移动到继承的视图模型

```
public ObservableCollection<ChatMessage> GridData
    {
        get { return _GridData; }
        set { _GridData = value; }
    } 
```

但这给了我以下错误：-

无法将类型“System.Collections.ObjectModel.ObservableCollection”隐式转换为“System.Collections.ObjectModel.ObservableCollection”

我需要在视图级别进行投射还是可以更改视图模型以更好地实现这一点？

任何建议将不胜感激。

埃姆林

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:43:26.100

您的 ViewModel 应包含一个列表，其中包含您的网格将显示的类型（在本例中为 ChatMessage 类型）。仍然可以使用继承调用常用方法，但绑定列表必须是 ChatMessage 类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:49:02.740

将集合更改为：

```
public ObservableCollection<MessageParentBase> GridData { get; set; } 
```

然后添加到您的构造函数中

```
this.GridData = new ObservableCollection<MessageParentBase>(); 
```

由于 WPF 使用反射从数据上下文中检索绑定数据，因此它应该能够获取存储在该集合中的派生类的值。

此外，当您运行应用程序时，检查选择了“调试”的输出窗口，XAML 引擎将在那里输出任何绑定错误。

# c# - 使用向上和向下箭头键获取列表视图中关注的项目

> ID：14900215
> 
> 赞同：0
> 
> 时间：2013-02-15T17:36:30.020
> 
> 标签：c#, listview, selecteditem, keydown, keyup

我希望从列表视图中获取选定的项目，但不是通过单击它，因为我已经有一个功能可以做到这一点。我想用我的向上和向下箭头来做到这一点。

我已经有了一个方法，但是它抛出了一个异常，任何人都可以帮助重构它吗？这是下面的方法

```
private void lvViewFile_KeyDown(object sender, KeyEventArgs e)
{
    ListView lvTemp = (ListView)sender;
    if (e.KeyCode == Keys.Up)
    {
        if (lvTemp.Focused == true)
        {
            var selected = this.lvCategory.SelectedItems[0].Focused;
        }
    }
    else if (e.KeyCode == Keys.Down)
    {
        if (lvTemp.Focused == true)
        {
            var selected = this.lvCategory.SelectedItems[0].Focused;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-09-20T12:38:12.083

一个旧帖子，但我调整了接受的答案以在使用箭头键导航 ListView 时显示来自数据库的数据。这可能对其他人有帮助：

```
ListView lv = sender as ListView;
if (lv.Focused) // which it should be as the user is running arrow keys on it!
{
    int selected = lv.FocusedItem.Index; // gets the index of the CURRENT ListViewItem (Not the one you see highlighted after arrow key movement)
    switch (e.KeyCode) // Can use if/else here if preferred
    {
        case Keys.Up:
            //Change index to the row above the current one
            selected--;
            if(selected < 0) //check if already on the first row
            {
                selected = 0;
            }
            break;
        case Keys.Down:
            //Change index to the row below the current one
            selected++;
            if(selected > lv.Items.Count - 1) //check if index out of range
            {
                selected = lv.Items.Count - 1;
            }
            break;
    }
    // Carry out your choice of action. (This one reads a database and fills fields)
    FillFields(lvClients.Items[selected].SubItems[0].Text);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T10:09:46.620

这似乎正是我想要的。

```
if (e.KeyCode == Keys.Up)
{
    if (lvTemp.Focused == true)
    {
        var selected = lvTemp.FocusedItem.Index;
        if (selected.Equals(0))
        {
            enableMoveDown();
        }
        else if (selected.Equals(lvCategory.Items.Count - 1))
        {
            enableMoveUp();
        }
        else
        {
            enableMoveUpMoveDown();
        }
    }
}
else if (e.KeyCode == Keys.Down)
{
    if (lvTemp.Focused == true)
    {
        var selected = lvTemp.FocusedItem.Index;
        if (selected.Equals(0))
        {
            enableMoveDown();
        }
        else if (selected.Equals(lvCategory.Items.Count - 1))
        {
            enableMoveUp();
        }
        else
        {
            enableMoveUpMoveDown();
        }
    }
} 
```

# jquery - 无法确定页面的水平滚动

> ID：14900217
> 
> 赞同：0
> 
> 时间：2013-02-15T17:36:41.860
> 
> 标签：jquery, html, css, knockout.js

我正在处理层次结构页面并且无法滚动它，它应该从屏幕上水平滚动以显示所有部门，但它只是在其他部门下方创建新部门并且看起来有点奇怪（如我的屏幕截图中的测试部门 7），它应该在屏幕之外创建测试部门 7 并允许滚动。我已经包含了用于创建层次结构的 css 以及一个屏幕截图来解释我的意思。整个层次结构基于[http://astuteo.com/slickmap/](http://astuteo.com/slickmap/)这里有什么。我的想法很新鲜，对此有任何新的想法将不胜感激，谢谢。可能会有一些我可以用来针对#primaryNav或其他东西的jquery吗？![在此处输入图像描述](../Images/70e7274610c8941930569458dbdd39f8.png)

----在.ascx文件中-----

我在这里使用 knockoutjs 来创建层次结构

```
<div class="row-fluid" data-bind="if: MapViewVisible, visible: Items().length > 0" style="display: none;">
    <div class="span12" data-bind="visible: MapViewVisible">
        <ul id="primaryNav" class="col10" data-bind="template: { name: 'root-template', foreach: Hierarchy}">

        </ul>            
    </div>
</div> 
```

----CSS------

```
#primaryNav li {
width:25%;
}

#primaryNav li ul li {
width:100% !important;
}

#primaryNav.col1 li { width:99.9%; }
#primaryNav.col2 li { width:50.0%; }
#primaryNav.col3 li { width:33.3%; }
#primaryNav.col4 li { width:25.0%; }
#primaryNav.col5 li { width:20.0%; }
#primaryNav.col6 li { width:16.6%; }
#primaryNav.col7 li { width:14.2%; }
#primaryNav.col8 li { width:12.5%; }
#primaryNav.col9 li { width:11.1%; }
#primaryNav.col10 li { width:12.5%; }

/* ------------------------------------------------------------
    General Styles
------------------------------------------------------------ */

body {
/*background: white;
color: black;
padding: 40px;
font-family: Gotham, Helvetica, Arial, sans-serif;
font-size: 12px;
line-height: 1;*/
}
.sitemap {
margin: 0 0 40px 0;
float: left;
width: 100%;
}
h1 {
font-weight: bold;
text-transform: uppercase;
font-size: 20px;
margin: 0 0 5px 0;
}
h2 {
font-family: "Arial", Verdana, sans-serif;
font-size: 10px;
color: #777777;
margin: 0 0 20px 0;
}
a {
text-decoration: none;
}
ol, ul {
list-style: none;
}

/* ------------------------------------------------------------
Site Map Styles
------------------------------------------------------------ */

/* -------- Top Level --------- */

#primaryNav {
margin: 0;
float: left;
width: 200%; /*tried this and overflow but didnt seem to work*/
overflow-x:auto;
}
#primaryNav #home {
display: block;
float: none;
background: #ffffff url('/_layouts/images/barium/lines/L1-left.png') center bottom     no-repeat;
position: relative;
z-index: 2;
padding: 10px 0 30px 0;
}
#primaryNav li {
float: left;
background: url('/_layouts/images/barium/lines/L1-center.png') center top no-repeat;
padding: 30px 0;
margin-top: -30px;
}
#primaryNav li a {
margin: 0 20px 0 0;
padding: 10px 0;
display: block;
font-size: 14px;
font-weight: bold;
text-align: center;
color: black;   
background: #c3eafb url('/_layouts/images/barium/lines/white-highlight.png') top left repeat-x;
border: 2px solid #b5d9ea;
-moz-border-radius: 5px;
-webkit-border-radius: 5px;
-webkit-box-shadow: rgba(0,0,0,0.5) 2px 2px 2px; 
-moz-box-shadow: rgba(0,0,0,0.5) 2px 2px 2px; /* FF 3.5+ */
}

#primaryNav li a:hover {
background-color: #e2f4fd;
border-color: #97bdcf;
}
#primaryNav li:last-child {
background: url('/_layouts/images/barium/lines/L1-right.png') center top no-repeat;
}

#primaryNav a:link:before,
#primaryNav a:visited:before {
/*content: " "attr(href)" ";*/
display: block;
text-transform: uppercase;
font-size: 10px;
margin-bottom: 5px;
word-wrap: break-word;
}
#primaryNav li a:link:before,
#primaryNav li a:visited:before {
color: #78a9c0;
}

/* -------- Second Level --------- */

#primaryNav li li {
width: 100%;
clear: left;
margin-top: 0;
padding: 10px 0 0 0;
background: url('/_layouts/images/barium/lines/vertical-line.png') center bottom repeat-y;
}
#primaryNav li li a {
background-color: #cee3ac;
border-color: #b8da83;
}
#primaryNav li li a:hover {
border-color: #94b75f;
background-color: #e7f1d7;
}
#primaryNav li li:first-child {
padding-top: 30px;
}
#primaryNav li li:last-child {
background: url('/_layouts/images/barium/lines/vertical-line.png') center bottom repeat-y;
}
#primaryNav li li a:link:before,
#primaryNav li li a:visited:before {
color: #8faf5c;
}

/* -------- Third Level --------- */

#primaryNav li li ul {
margin: 10px 0 0 0;
width: 100%;
float: right;
padding: 9px 0 10px 0;
background: #ffffff url('/_layouts/images/barium/lines/L3-ul-top.png') center top no-repeat;
}
#primaryNav li li li {
background: url('/_layouts/images/barium/lines/L3-center.png') left center no-repeat;
padding: 5px 0;
}
#primaryNav li li li a {
background-color: #fff7aa;
border-color: #e3ca4b;
font-size: 12px;
padding: 5px 0;
width: 80%;
float: right;
}
#primaryNav li li li a:hover {
background-color: #fffce5;
border-color: #d1b62c;
}
#primaryNav li li li:first-child {
padding: 15px 0 5px 0;
background: url('/_layouts/images/barium/lines/L3-li-top.png') left center no-repeat;
}
#primaryNav li li li:last-child {
background: url('/_layouts/images/barium/lines/L3-bottom.png') left center no-repeat;
}
#primaryNav li li li a:link:before,
#primaryNav li li li a:visited:before {
color: #ccae14;
font-size: 9px;
}

li a p, li a .nofontweight
{
font-weight:400;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:51:21.630

您在主 UL 容器之外的类（行流体）具有宽度限制。如果您使用 .row_fluid 设置`overflow:auto`，那应该可以解决问题。

但是，在没有看到太多工作样本的情况下，这就是我现在可以评估的全部内容。

jsFiddle.net 是发布和测试示例代码的好地方。

# c# - C# 中的 int 是 32 位吗？

> ID：14900220
> 
> 赞同：2
> 
> 时间：2013-02-15T17:36:44.730
> 
> 标签：c#

我刚刚听说 int 的大小取决于机器。我一直认为int的大小是32位。有人可以解释这个难题吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-15T17:38:08.323

在 C# 中，`int`类型始终为`Int32`，并且始终为 32 位。

其他一些语言有不同的规则，并且`int`可能依赖于机器。在某些语言中，`int`被定义为具有最小尺寸，但机器/实现特定尺寸至少那么大。例如，在 C++ 中，int 数据类型不一定是 32 位。从[基本数据类型](http://www.cplusplus.com/doc/tutorial/variables/)：

> 一般规范是 int 具有系统架构建议的自然大小（一个“单词”），并且四种整数类型 char、short、int 和 long 必须至少与其前一个一样大，其中 char 为总是一个字节的大小。

但是，.NET 对此进行了标准化，因此类型实际上指定为`Int32`,`Int64`等。在 C# 中，`int`是 的别名`System.Int32`，并且始终为 32 位。C# 语言规范中的部分保证了这一点`4.1.5 Integral Types`，该部分规定：

> int 类型表示带符号的 32 位整数，其值介于 –2147483648 和 2147483647 之间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T17:38:46.393

[MSDN](http://msdn.microsoft.com/en-us/library/5kzh1b5w(v=vs.80).aspx)声明`int`是 32 位。这个人可能是在谈论 C++ 吗？

标准未指定以`C++` [字节为单位的整数类型的大小](https://stackoverflow.com/questions/589575/size-of-int-long-etc)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T17:41:05.210

来自[C# 语言规范](http://msdn.microsoft.com/en-us/library/aa691145%28v=vs.71%29.aspx)：

> 该`int`类型表示带符号的 32 位整数，其值介于 –2147483648 和 2147483647 之间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T17:39:11.183

`int`是 的别名`System.Int32`。您也可以使用`System.Int16`,`System.Int64`和`BigInteger`。

# c# - 如何在 IDE 中关闭别名自动更正

> ID：14900223
> 
> 赞同：0
> 
> 时间：2013-02-15T17:36:52.830
> 
> 标签：c#, visual-studio-2012

出于某种原因，我的小指喜欢将 shift 键向下按住比我通常喜欢的时间长一点。所以我最终打字`STring.Empty`了很多。Visual Studio*有助于*将其转换`string.Empty`为不需要的行为。我宁愿将其转换为`String.Empty`. 注意大小写的差异。

我很清楚这`string`只是;[的别名](https://stackoverflow.com/questions/7074/whats-the-difference-between-string-and-string)。`String`所以这归结为一个简单的个人偏好，即在 IDE 中如何对事物进行颜色编码。

有没有办法告诉视觉工作室总是自动更正`String`而不是别名？这可以节省我每天按下后退按钮的无数次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:43:41.657

IDE 只会对已知在当前范围内有效的类型进行“自动更正”。 `string`始终有效，但`String`仅当您`System`使用`using`指令引用命名空间时才有效。如果您确实引用了`System`，那么 VS 2012 将“自动更正”为`String`，而不是-`string`这是我的经验。

# sql-server - 监控 SQLServer

> ID：14900224
> 
> 赞同：0
> 
> 时间：2013-02-15T17:36:52.470
> 
> 标签：sql-server, monitoring

我正在寻找一种解决方案来监控（用图表）我的 MSSQL 实例在一段时间（白天或晚上）内的状态，并为该监控获取或制作报告。

请问有人有或知道任何已知的简单解决方案吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:51:10.867

取决于您要监视的内容。有供应商产品可以做到这一点。Idera 有诊断管理器，RedGate 有 SQL 监视器等等。或者，如果您不想花任何钱，SQL Server 有几个监控选项，包括警报、基于策略的管理和数据收集。这些不会那么漂亮，可能不会涵盖那么多，更不用说您将自己编写一些代码，但它们是免费的（当然，使用 SQL Server，取决于版本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T20:17:15.347

相关的，尽管您需要编辑脚本以获取信息是 Ola Hallengren 的维护解决方案 [http://ola.hallengren.com/](http://ola.hallengren.com/)。有一些用于维护的有用脚本，但根据您尝试获取的信息，您可以在这些脚本的基础上构建以获取信息。从那里，您可以在 SSRS 中使用这些查询的结果来填充图表，甚至可以使用 Excel 等工具。

同样，Ola Hallengren 提供维护解决方案，因此需要对这些解决方案进行调整以进行监控（取决于您正在监控的内容），但它们是完全免费的，您可以编辑脚本，以及查看信息的来源，以便您可以确定需要监控的内容。

# oracle - Oracle Streams：ORA-0001 出队？

> ID：14900225
> 
> 赞同：0
> 
> 时间：2013-02-15T17:36:54.020
> 
> 标签：oracle, stream, queue

在生产环境中，我们在将消息出列时时不时会收到 ORA-0001 错误。我们用：

1.  索拉里斯 10
2.  甲骨文 10g
3.  C++ 应用程序
4.  带有 dbms_aq 包的 PROC*C 用于排队操作
5.  带有 XML 负载的队列
6.  我们处理大量消息（1K/分钟）。

任何线索为什么出队会导致 ORA-0001（唯一约束）错误？

更新：每个请求添加代码。

```
EXEC SQL EXECUTE
DECLARE
      message_properties dbms_aq.message_properties_t;
      dequeue_options    dbms_aq.dequeue_options_t;
      message_payload xmltype;
      tmpclob clob;
      dynamic_sql_string varchar2(512);

BEGIN
dequeue_options.wait := :iReadTimeout;
dequeue_options.dequeue_mode := dbms_aq.REMOVE;
dequeue_options.visibility := dbms_aq.ON_COMMIT;

IF :iBuffered = 1 then
    dequeue_options.delivery_mode := dbms_aq.buffered;
    dequeue_options.visibility := dbms_aq.immediate;
    :iNavigationMode := 0;
END IF;

IF :iDequeueOnly = 1 and :iQueueType <> 1 THEN
    dequeue_options.dequeue_mode := dbms_aq.REMOVE_NODATA;
    dequeue_options.wait := dbms_aq.NO_WAIT;
    dequeue_options.msgid := hextoraw(:pszDequeueMsgId);
ELSE
    IF :iNavigationMode = 0 THEN
       dequeue_options.navigation := dbms_aq.FIRST_MESSAGE;
    ELSE
       dequeue_options.navigation := dbms_aq.NEXT_MESSAGE;
    END IF;
END IF;

dequeue_options.deq_condition := :pszDeqCondition;

dbms_aq.dequeue(queue_name => :pszQueueName,
      message_properties => message_properties,
      dequeue_options => dequeue_options,
      payload => message_payload,
      msgid => :msgid );
IF dequeue_options.dequeue_mode <> dbms_aq.REMOVE_NODATA THEN
        EXECUTE IMMEDIATE dynamic_sql_string USING OUT tmpclob, IN message_payload;
        :gpoXmlClob := tmpclob;
ELSE
        :gpoXmlClob := message_payload.getclobval();
END IF;
END; 
```

# c# - 罗马数字转整数

> ID：14900228
> 
> 赞同：14
> 
> 时间：2013-02-15T17:37:04.200
> 
> 标签：c#, roman-numerals

在数据中，有时相同的产品会用罗马数字命名，而其他时候会用数字命名。

**示例** `Samsung Galaxy SII`经文`Samsung Galaxy S2`

如何将`II`其转换为价值`2`？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-10-31T05:05:51.583

我注意到这里有一些非常复杂的解决方案，但这是一个非常简单的问题。我提出了一个解决方案，避免了对“异常”（IV、IX、XL 等）进行硬编码的需要。我使用`for`循环来查看罗马数字字符串中的下一个字符，以查看与数字相关的数字是否应该减去或添加到总数中。为简单起见，我假设所有输入都是有效的。

```
private static Dictionary<char, int> RomanMap = new Dictionary<char, int>()
    {
        {'I', 1},
        {'V', 5},
        {'X', 10},
        {'L', 50},
        {'C', 100},
        {'D', 500},
        {'M', 1000}
    };

public static int RomanToInteger(string roman)
{
    int number = 0;
    for (int i = 0; i < roman.Length; i++)
    {
        if (i + 1 < roman.Length && RomanMap[roman[i]] < RomanMap[roman[i + 1]])
        {
            number -= RomanMap[roman[i]];
        }
        else
        {
            number += RomanMap[roman[i]];
        }
    }
    return number;
} 
```

我最初尝试`foreach`在字符串上使用 a，我认为这是一个更易读的解决方案，但我最终将每个数字相加，然后如果结果是我不喜欢的例外之一，则将其减去两次。无论如何，我都会在这里发布以供后代使用。

```
public static int RomanToInteger(string roman)
{
    int number = 0;
    char previousChar = roman[0];
    foreach(char currentChar in roman)
    {
        number += RomanMap[currentChar];
        if(RomanMap[previousChar] < RomanMap[currentChar])
        {
            number -= RomanMap[previousChar] * 2;
        }
        previousChar = currentChar;
    }
    return number;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-07-12T17:42:03.630

这是我的解决方案

```
public int SimplerConverter(string number)
    {
        number = number.ToUpper();
        var result = 0;

        foreach (var letter in number)
        {
            result += ConvertLetterToNumber(letter);
        }

        if (number.Contains("IV")|| number.Contains("IX"))
            result -= 2;

        if (number.Contains("XL")|| number.Contains("XC"))
            result -= 20;

        if (number.Contains("CD")|| number.Contains("CM"))
            result -= 200;

        return result;

    }

    private int ConvertLetterToNumber(char letter)
    {
        switch (letter)
        {
            case 'M':
            {
                return 1000;
            }

            case 'D':
            {
                return 500;
            }

            case 'C':
            {
                return 100;
            }

            case 'L':
            {
                return 50;
            }

            case 'X':
            {
                return 10;
            }

            case 'V':
            {
                return 5;
            }

            case 'I':
            {
                return 1;
            }

            default:
            {
                throw new ArgumentException("Ivalid charakter");
            }

        }

    } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-01-16T03:43:00.720

一个更简单易读的 C# 实现：

*   将 I 映射到 1，V 映射到 5，X 映射到 10，L 映射到 50，C 映射到 100，D 映射到 500，M 映射到 1000。
*   使用一个单独的 foreach 循环（*foreach*故意使用，保留先前的值）。
*   将映射的数字添加到总数中。
*   减去之前添加的数字的两倍，如果 I 在 V 或 X 之前，X 在 L 或 C 之前，C 在 D 或 M 之前（此处并非所有字符都允许！）。
*   在空字符串、错误字母或不允许用于减法的字符上返回 0（不用于罗马数字）。
*   备注：它还没有完全完成，我们没有检查所有可能的条件以获取有效的输入字符串！

代码：

```
private static Dictionary<char, int> _romanMap = new Dictionary<char, int>
{
   {'I', 1}, {'V', 5}, {'X', 10}, {'L', 50}, {'C', 100}, {'D', 500}, {'M', 1000}
};

public static int ConvertRomanToNumber(string text)
{
    int totalValue = 0, prevValue = 0;
    foreach (var c in text)
    {
        if (!_romanMap.ContainsKey(c))
            return 0;
        var crtValue = _romanMap[c];
        totalValue += crtValue;
        if (prevValue != 0 && prevValue < crtValue)
        {
            if (prevValue == 1 && (crtValue == 5 || crtValue == 10)
                || prevValue == 10 && (crtValue == 50 || crtValue == 100)
                || prevValue == 100 && (crtValue == 500 || crtValue == 1000))
                totalValue -= 2 * prevValue;
            else
                return 0;
        }
        prevValue = crtValue;
    }
    return totalValue;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-15T20:49:51.740

我刚才写了一个简单的罗马数字转换器，但它并没有做很多错误检查，但它似乎适用于我可以扔给它的所有格式正确的东西。

```
public class RomanNumber
{
    public string Numeral { get; set; }
    public int Value { get; set; }
    public int Hierarchy { get; set; }
}

public List<RomanNumber> RomanNumbers = new List<RomanNumber>
    {
        new RomanNumber {Numeral = "M", Value = 1000, Hierarchy = 4},
        //{"CM", 900},
        new RomanNumber {Numeral = "D", Value = 500, Hierarchy = 4},
        //{"CD", 400},
        new RomanNumber {Numeral = "C", Value = 100, Hierarchy = 3},
        //{"XC", 90},
        new RomanNumber {Numeral = "L", Value = 50, Hierarchy = 3},
        //{"XL", 40},
        new RomanNumber {Numeral = "X", Value = 10, Hierarchy = 2},
        //{"IX", 9},
        new RomanNumber {Numeral = "V", Value = 5, Hierarchy = 2},
        //{"IV", 4},
        new RomanNumber {Numeral = "I", Value = 1, Hierarchy = 1}
    };

/// <summary>
/// Converts the roman numeral to int, assumption roman numeral is properly formatted.
/// </summary>
/// <param name="romanNumeralString">The roman numeral string.</param>
/// <returns></returns>
private int ConvertRomanNumeralToInt(string romanNumeralString)
{
    if (romanNumeralString == null) return int.MinValue;

    var total = 0;
    for (var i = 0; i < romanNumeralString.Length; i++)
    {
        // get current value
        var current = romanNumeralString[i].ToString();
        var curRomanNum = RomanNumbers.First(rn => rn.Numeral.ToUpper() == current.ToUpper());

        // last number just add the value and exit
        if (i + 1 == romanNumeralString.Length)
        {
            total += curRomanNum.Value;
            break;
        } 

        // check for exceptions IV, IX, XL, XC etc
        var next = romanNumeralString[i + 1].ToString();
        var nextRomanNum = RomanNumbers.First(rn => rn.Numeral.ToUpper() == next.ToUpper());

        // exception found
        if (curRomanNum.Hierarchy == (nextRomanNum.Hierarchy - 1))
        {
            total += nextRomanNum.Value - curRomanNum.Value;
            i++;
        }
        else
        {
            total += curRomanNum.Value;
        }
    }

    return total;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-12-07T12:52:59.700

[我来到这里寻找罗马数字解析器的小型实现，但在大小和优雅方面对所提供的答案并不满意。我将最终的递归实现留在这里，以帮助其他人搜索小型实现。]

* * *

### 通过递归转换罗马数字

*   该算法也能够处理不相邻的数字（fe `XIIX`）。
*   此实现可能仅适用于格式良好（匹配的字符串`/[mdclxvi]*/i`）罗马数字。
*   该实现未针对速度进行优化。

```
// returns the value for a roman literal
private static int romanValue(int index)
{
    int basefactor = ((index % 2) * 4 + 1); // either 1 or 5...
    // ...multiplied with the exponentation of 10, if the literal is `x` or higher
    return index > 1 ? (int) (basefactor * System.Math.Pow(10.0, index / 2)) : basefactor;
}

public static int FromRoman(string roman)
{
    roman = roman.ToLower();
    string literals = "mdclxvi";
    int value = 0, index = 0;
    foreach (char literal in literals)
    {
        value = romanValue(literals.Length - literals.IndexOf(literal) - 1);
        index = roman.IndexOf(literal);
        if (index > -1)
            return FromRoman(roman.Substring(index + 1)) + (index > 0 ? value - FromRoman(roman.Substring(0, index)) : value);
    }
    return 0;
} 
```

> **尝试**使用这个 .Netfiddle：[https ://dotnetfiddle.net/veaNk3](https://dotnetfiddle.net/veaNk3)

### 它是如何工作的？

该算法通过从罗马数字中获取最高值并递归地加/减文字剩余左/右部分的值来计算罗马数字的值。

```
ii X iiv # Pick the greatest value in the literal `iixiiv` (symbolized by uppercase) 
```

然后递归地重新计算并减去左侧并添加右侧：

```
(iiv) + x - (ii) # Subtract the lefthand-side, add the righthand-side
(V - (ii)) + x - ((I) + i) # Pick the greatest values, again
(v - ((I) + i)) + x - ((i) + i) # Pick the greatest value of the last numeral compound 
```

最后将数字替换为它们的整数值：

```
(5 - ((1) + 1)) + 10 - ((1) + 1)
(5 - (2)) + 10 - (2)
3 + 10 - 2
= 11 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-04-17T09:05:34.047

使用[Humanizer库，您可以使用](https://github.com/Humanizr/Humanizer#roman-numerals)**FromRoman**扩展将罗马数字更改为数字

```
"IV".FromRoman() => 4 
```

**并使用ToRoman**扩展进行反向操作。

```
4.ToRoman() => "IV" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-13T16:49:09.567

**完成“减法”语义检查的解决方案**

当前的解决方案都没有完全满足“减法”的整套规则。**“IIII”-> 是不可能的。**每个解决方案的结果都是 4。字符串：“CCCC”、“VV”、“IC”、“IM”也是无效的。

一个很好的检查语义的在线转换器是[https://www.romannumerals.org/converter](https://www.romannumerals.org/converter) 所以，如果你真的想做一个完整的语义检查，它要复杂得多。

我的方法是首先编写带有语义检查的单元测试。然后写代码。然后用一些 linq 表达式减少循环。

也许有一个更聪明的解决方案，但我认为以下代码满足了转换罗马数字字符串的规则。

在代码部分之后，有一个部分包含我的单元测试。

```
public class RomanNumerals
{

    private List<Tuple<char, ushort, char?[]>> _validNumerals = new List<Tuple<char, ushort, char?[]>>()
    {
        new Tuple<char, ushort, char?[]>('I', 1, new char? [] {'V', 'X'}),
        new Tuple<char, ushort, char?[]>('V', 5, null),
        new Tuple<char, ushort, char?[]>('X', 10, new char?[] {'L', 'C'}),
        new Tuple<char, ushort, char?[]>('L', 50, null),
        new Tuple<char, ushort, char?[]>('C', 100, new char? [] {'D', 'M'}),
        new Tuple<char, ushort, char?[]>('D', 500, null),
        new Tuple<char, ushort, char?[]>('M', 1000, new char? [] {null, null})
    };

    public int TranslateRomanNumeral(string input)
    {
        var inputList = input?.ToUpper().ToList();

        if (inputList == null || inputList.Any(x => _validNumerals.Select(t => t.Item1).Contains(x) == false))
        {
            throw new ArgumentException();
        }

        char? valForSubtraction = null;
        int result = 0;
        bool noAdding = false;
        int equalSum = 0;
        for (int i = 0; i < inputList.Count; i++)
        {
            var currentNumeral = _validNumerals.FirstOrDefault(s => s.Item1 == inputList[i]);
            var nextNumeral = i < inputList.Count - 1 ? _validNumerals.FirstOrDefault(s => s.Item1 == inputList[i + 1]) : null;
            bool currentIsDecimalPower = currentNumeral?.Item3?.Any() ?? false;

            if (nextNumeral != null)
            {
                // Syntax and Semantics checks
                if ((currentNumeral.Item2 < nextNumeral.Item2) && (currentIsDecimalPower == false || currentNumeral.Item3.Any(s => s == nextNumeral.Item1) == false) ||
                    (currentNumeral.Item2 == nextNumeral.Item2) && (currentIsDecimalPower == false || nextNumeral.Item1 == valForSubtraction) ||
                    (currentIsDecimalPower && result > 0 &&  ((nextNumeral.Item2 -currentNumeral.Item2) > result )) ||
                    (currentNumeral.Item2 > nextNumeral.Item2) && (nextNumeral.Item1 == valForSubtraction)

                    )
                {
                    throw new ArgumentException();
                }

                if (currentNumeral.Item2 == nextNumeral.Item2)
                {
                    equalSum += equalSum == 0 ? currentNumeral.Item2 + nextNumeral.Item2 : nextNumeral.Item2;
                    int? smallest = null;
                    var list = _validNumerals.Where(p => _validNumerals.FirstOrDefault(s => s.Item1 == currentNumeral.Item1).Item3.Any(s2 => s2 != null && s2 == p.Item1)).ToList();
                    if (list.Any())
                    {
                        smallest = list.Select(s3 => s3.Item2).ToList().Min();
                    }

                    // Another Semantics check
                    if (currentNumeral.Item3 != null && equalSum >= (smallest - currentNumeral.Item2))
                    {
                        throw new ArgumentException();
                    }

                    result += noAdding ? 0 : currentNumeral.Item2 + nextNumeral.Item2;
                    noAdding = !noAdding;
                    valForSubtraction = null;
                }
                else
                if (currentNumeral.Item2 < nextNumeral.Item2)
                {
                    equalSum = 0;
                    result += nextNumeral.Item2 - currentNumeral.Item2;
                    valForSubtraction = currentNumeral.Item1;
                    noAdding = true;
                }
                else 
                if (currentNumeral.Item2 > nextNumeral.Item2)
                {
                    equalSum = 0;
                    result += noAdding ? 0 : currentNumeral.Item2;
                    noAdding = false;

                    valForSubtraction = null;
                }
            }
            else
            {
                result += noAdding ? 0 : currentNumeral.Item2;
            }
        }
        return result;
    }
} 
```

**这是单元测试**

```
 [TestFixture]
public class RomanNumeralsTests
{
    [Test]
    public void TranslateRomanNumeral_WhenArgumentIsNull_RaiseArgumentNullException()
    {
        var romanNumerals = new RomanNumerals();

        Assert.Throws<ArgumentException>(() => romanNumerals.TranslateRomanNumeral(null));
    }

    [TestCase("A")]
    [TestCase("-")]
    [TestCase("BXA")]
    [TestCase("MMXK")]
    public void TranslateRomanNumeral_WhenInvalidNumeralSyntax_RaiseException(string input)
    {
        var romanNumerals = new RomanNumerals();

        Assert.Throws<ArgumentException>(() => romanNumerals.TranslateRomanNumeral(input));
    }

    [TestCase("IIII")]
    [TestCase("CCCC")]
    [TestCase("VV")]
    [TestCase("IC")]
    [TestCase("IM")]
    [TestCase("XM")]
    [TestCase("IL")]
    [TestCase("MCDXCXI")]
    [TestCase("MCDDXC")]
    public void TranslateRomanNumeral_WhenInvalidNumeralSemantics_RaiseException(string input)
    {
        var romanNumerals = new RomanNumerals();

        Assert.Throws<ArgumentException>(() => romanNumerals.TranslateRomanNumeral(input));
    }

    [TestCase("I", 1)]
    [TestCase("II", 2)]
    [TestCase("III", 3)]
    [TestCase("IV", 4)]
    [TestCase("XLII", 42)]
    [TestCase("MMXIII", 2013)]
    [TestCase("MXI", 1011)]
    [TestCase("MCDXCIX", 1499)]
    [TestCase("MMXXII", 2022)]
    [TestCase("V", 5)]
    [TestCase("VI", 6)]
    [TestCase("CX", 110)]
    [TestCase("CCCLXXV", 375)]
    [TestCase("MD", 1500)]
    [TestCase("MDLXXV", 1575)]
    [TestCase("MDCL", 1650)]
    [TestCase("MDCCXXV", 1725)]
    [TestCase("MDCCC", 1800)]
    [TestCase("MDCCCLXXV", 1875)]
    [TestCase("MCML", 1950)]
    [TestCase("MMXXV", 2025)]
    [TestCase("MMC", 2100)]
    [TestCase("MMCLXXV", 2175)]
    [TestCase("MMCCL", 2250)]
    [TestCase("MMCCCXXV", 2325)]
    [TestCase("MMCD", 2400)]
    [TestCase("MMCDLXXV", 2475)]
    [TestCase("MMDL", 2550)]
    [TestCase("MMMMMMMM", 8000)]
    [TestCase("MMMMMMMMIV", 8004)]
    public void TranslateRomanNumeral_WhenValidNumeral_Translate(string input, int output)
    {
        var romanNumerals = new RomanNumerals();

        var result = romanNumerals.TranslateRomanNumeral(input);

        Assert.That(result.Equals(output));
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-18T00:11:35.903

```
private static int convertRomanToInt(String romanNumeral)
{
    Dictionary<Char, Int32> romanMap = new Dictionary<char, int>
    {
        {'I', 1 },
        {'V', 5},
        {'X', 10},
        {'L', 50},
        {'C', 100},
        {'D', 500},
        {'M', 1000}
    };

    Int32 result = 0;
    for (Int32 index = romanNumeral.Length - 1, last = 0; index >= 0; index--)
    {
        Int32 current = romanMap[romanNumeral[index]];
        result += (current < last ? -current : current);
        last = current;
    }

    return result;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-11-17T06:31:50.637

`System.Linq`从这个借了很多。`String`implements `IEnumerable<char>`，所以我认为这是合适的，因为无论如何我们都将它视为可枚举的对象。针对一堆随机数进行了测试，包括 1、3、4、8、83、99、404、555、846、927、1999、2420。

```
 public static IDictionary<char, int> CharValues 
    { 
        get 
        { 
            return new Dictionary<char, int>
            {{'I', 1}, {'V', 5}, {'X', 10}, {'L', 50}, {'C', 100}, {'D', 500}, {'M', 1000}};
        } 
    }

    public static int RomanNumeralToInteger(IEnumerable<char> romanNumerals)
    {
        int retVal = 0;

        //go backwards
        for (int i = romanNumerals.Count() - 1; i >= 0; i--)
        {
            //get current character
            char c = romanNumerals.ElementAt(i);

            //error checking
            if (!CharValues.ContainsKey(c)) throw new InvalidRomanNumeralCharacterException(c);

            //determine if we are adding or subtracting
            bool op = romanNumerals.Skip(i).Any(rn => CharValues[rn] > CharValues[c]);

            //then do so
            retVal = op ? retVal - CharValues[c] : retVal + CharValues[c];
        }

        return retVal;
    } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-02-16T21:16:13.673

```
 private static Dictionary<char, int> RomanNumberMap = new Dictionary<char, int> {
        {'I', 1},
        {'V', 5},
        {'X', 10},
        {'L', 50},
        {'C', 100},
        {'D', 500},
        {'M', 1000}
    };

    private const string RomanNumberValidationRegEx = "^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$";

    private static int ConvertToRomanNumberToInteger(string romanNumber)
    {
        if (!Regex.IsMatch(romanNumber, RomanNumberValidationRegEx))
        {
            throw new ArgumentOutOfRangeException(romanNumber);
        }

        int result = 0;

        for (int i = 0; i < romanNumber.Length; i++)
        {
            int currentVal = RomanNumberMap[romanNumber[i]];

            if (romanNumber.Length > i + 1)
            {
                int nextVal = RomanNumberMap[romanNumber[i + 1]];

                if (nextVal > currentVal)
                {
                    result = result + (nextVal - currentVal);
                    i++;
                    continue;
                }

            }

            result = result + currentVal;

        }

        return result;
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-22T05:25:58.487

我将通过在 .net 中使用数组来建议一种最简单的方法：C# 部分中给出了注释以进行解释

**VB.net**

```
Public Class Form1
    Dim indx() As Integer = {1, 2, 3, 4, 5, 10, 50, 100, 500, 1000}
    Dim row() As String = {"I", "II", "III", "IV", "V", "X", "L", "C", "D", "M"}
    Dim limit As Integer = 9
    Dim output As String = ""
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim num As Integer
        output = ""
        num = CInt(txt1.Text)
        While num > 0
            num = find(num)
        End While
        txt2.Text = output
    End Sub
    Public Function find(ByVal Num As Integer) As Integer
        Dim i As Integer = 0
        While indx(i) <= Num
            i += 1
        End While
        If i <> 0 Then
            limit = i - 1
        Else
            limit = 0
        End If
        output = output & row(limit)
        Num = Num - indx(limit)
        Return Num
    End Function
End Class 
```

**C＃**

```
using Microsoft.VisualBasic;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Diagnostics;
public class Form1
{
    int[] indx = {
        1,
        2,
        3,
        4,
        5,
        10,
        50,
        100,
        500,
        1000
        // initialize array of integers 
    };
    string[] row = {
        "I",
        "II",
        "III",
        "IV",
        "V",
        "X",
        "L",
        "C",
        "D",
        "M"
        //Carasponding roman letters in for the numbers in the array
    };
        // integer to indicate the position index for link two arrays 
    int limit = 9;
        //string to store output
    string output = "";
    private void Button1_Click(System.Object sender, System.EventArgs e)
    {
        int num = 0;
        // stores the input 
        output = "";
        // clear output before processing
        num = Convert.ToInt32(txt1.Text);
        // get integer value from the textbox
        //Loop until the value became 0
        while (num > 0) {
            num = find(num);
            //call function for processing
        }
        txt2.Text = output;
        // display the output in text2
    }
    public int find(int Num)
    {
        int i = 0;
        // loop variable initialized with 0
        //Loop until the indx(i).value greater than or equal to num
        while (indx(i) <= Num) {
            i += 1;
        }
        // detemine the value of limit depends on the itetration
        if (i != 0) {
            limit = i - 1;
        } else {
            limit = 0;
        }
        output = output + row(limit);
        //row(limit) is appended with the output
        Num = Num - indx(limit);
        // calculate next num value
        return Num;
        //return num value for next itetration 
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-28T12:18:58.830

这是我在 JavaScript 中的 O(n) 解决方案

```
const NUMERAL = {
    'I': 1,
    'V': 5,
    'X': 10,
    'L': 50,
    'C': 100,
    'D': 500,
    'M': 1000,
}

var romanToInt = function(s) {
    if (s.length === 1) return +NUMERAL[s];

    let number = 0;
    for (let i = 0; i < s.length; i++) {
        let num = +NUMERAL[s[i]];
        let prev = +NUMERAL[s[i-1]];

        if (prev < num) number += num - (2 * prev);
        else number += num;
    }

    return number;
};
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-02-17T17:27:12.643

我只使用数组编写了这个。
我在这里省略了测试代码，但它看起来可以正常工作。

```
public static class RomanNumber {
        static string[] units = { "", "I", "II", "III", "IV", "V", "VI", "VII", "VIII", "IX" };
        static string[] tens = { "", "X", "XX", "XXX", "XL", "L", "LX", "LXX", "LXXX", "XC" };
        static string[] hundreds = { "", "C", "CC", "CCC", "CD", "D", "DC", "DCC", "DCCC", "CM" };
        static string[] thousands = { "", "M", "MM", "MMM" };

        static public bool IsRomanNumber(string source) {
            try {
                return RomanNumberToInt(source) > 0;
            }
            catch {
                return false;
            }
        }

        /// <summary>
        /// Parses a string containing a roman number.
        /// </summary>
        /// <param name="source">source string</param>
        /// <returns>The integer value of the parsed roman numeral</returns>
        /// <remarks>
        /// Throws an exception on invalid source.
        /// Throws an exception if source is not a valid roman number.
        /// Supports roman numbers from "I" to "MMMCMXCIX" ( 1 to 3999 )
        /// NOTE : "IMMM" is not valid</remarks>
        public static int RomanNumberToInt(string source) {
            if (String.IsNullOrWhiteSpace(source)) {
                throw new ArgumentNullException();
            }

            int total = 0;
            string buffer = source;

            // parse the last four characters in the string
            // each time we check the buffer against a number array,
            // starting from units up to thousands
            // we quit as soon as there are no remaing characters to parse

            total += RipOff(buffer, units, out buffer);

            if (buffer != null) {
                total += (RipOff(buffer, tens, out buffer)) * 10;
            }

            if (buffer != null) {
                total += (RipOff(buffer, hundreds, out buffer)) * 100;
            }

            if (buffer != null) {
                total += (RipOff(buffer, thousands, out buffer)) * 1000;
            }

            // after parsing for thousands, if there is any character left, this is not a valid roman number
            if (buffer != null) {
                throw new ArgumentException(String.Format("{0} is not a valid roman number", buffer));
            }
            return total;
        }

        /// <summary>
        /// Given a string, takes the four characters on the right,
        /// search an element in the numbers array and returns the remaing characters.
        /// </summary>
        /// <param name="source">source string to parse</param>
        /// <param name="numbers">array of roman numerals</param>
        /// <param name="left">remaining characters on the left</param>
        /// <returns>If it finds a roman numeral returns its integer value; otherwise returns zero</returns>
        public static int RipOff(string source, string[] numbers, out string left) {
            int result = 0;

            string buffer = null;

            // we take the last four characters : this is the length of the longest numeral in our arrays
            // ("VIII", "LXXX", "DCCC")
            // or all if source length is 4 or less
            if (source.Length > 4) {
                buffer = source.Substring(source.Length - 4);
                left = source.Substring(0, source.Length - 4);
            }
            else {
                buffer = source;
                left = null;
            }

            // see if buffer exists in the numbers array 
            // if it does not, skip the first character and try again
            // until buffer contains only one character
            // append the skipped character to the left arguments
            while (!numbers.Contains(buffer)) {
                if (buffer.Length == 1) {
                    left = source; // failed
                    break;
                }
                else {
                    left += buffer.Substring(0, 1);
                    buffer = buffer.Substring(1);
                }
            }

            if (buffer.Length > 0) {
                if (numbers.Contains(buffer)) {
                    result = Array.IndexOf(numbers, buffer);
                }
            }

            return result;
        }
    }
} 
```

**编辑**
忘记它！
只需在[此处查看](https://stackoverflow.com/questions/7040289/converting-integers-to-roman-numerals)**BrunoLM**解决方案。 它简单而优雅。 唯一*需要注意*的是它不检查来源。

 ** * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-01-26T21:05:28.847

这个使用堆栈：

```
 public int RomanToInt(string s)
    {
        var dict = new Dictionary<char, int>();
        dict['I'] = 1;
        dict['V'] = 5;
        dict['X'] = 10;
        dict['L'] = 50;
        dict['C'] = 100;
        dict['D'] = 500;
        dict['M'] = 1000;
        Stack<char> st = new Stack<char>();
        foreach (char ch in s.ToCharArray())
            st.Push(ch);

        int result = 0;
        while (st.Count > 0)
        {
            var c1=st.Pop();
            var ch1 = dict[c1];

            if (st.Count > 0)
            {
                var c2 = st.Peek();
                var ch2 = dict[c2];
                if (ch2 < ch1)
                {
                    result += (ch1 - ch2);
                    st.Pop();
                }
                else
                {
                    result += ch1;
                }
            }
            else
            {
                result += ch1;
            }
        }
        return result;
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-04-03T12:33:36.937

这是我的解决方案：

```
 /// <summary>
    /// Converts a Roman number string into a Arabic number
    /// </summary>
    /// <param name="romanNumber">the Roman number string</param>
    /// <returns>the Arabic number (0 if the given string is not convertible to a Roman number)</returns>
    public static int ToArabicNumber(string romanNumber)
    {
        string[] replaceRom = { "CM", "CD", "XC", "XL", "IX", "IV" };
        string[] replaceNum = { "DCCCC", "CCCC", "LXXXX", "XXXX", "VIIII", "IIII" };
        string[] roman = { "M", "CM", "D", "CD", "C", "XC", "L", "XL", "X", "IX", "V", "IV", "I" };
        int[] arabic = { 1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1 };
        return Enumerable.Range(0, replaceRom.Length)
            .Aggregate
            (
                romanNumber,
                (agg, cur) => agg.Replace(replaceRom[cur], replaceNum[cur]),
                agg => agg.ToArray()
            )
            .Aggregate
            (
                0,
                (agg, cur) =>
                {
                    int idx = Array.IndexOf(roman, cur.ToString());
                    return idx < 0 ? 0 : agg + arabic[idx];
                },
                agg => agg
            );
    }

    /// <summary>
    /// Converts a Arabic number into a Roman number string
    /// </summary>
    /// <param name="arabicNumber">the Arabic number</param>
    /// <returns>the Roman number string</returns>
    public static string ToRomanNumber(int arabicNumber)
    {
        string[] roman = { "M", "CM", "D", "CD", "C", "XC", "L", "XL", "X", "IX", "V", "IV", "I" };
        int[] arabic = { 1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1 };
        return Enumerable.Range(0, arabic.Length)
            .Aggregate
            (
                Tuple.Create(arabicNumber, string.Empty),
                (agg, cur) =>
                {
                    int remainder = agg.Item1 % arabic[cur];
                    string concat = agg.Item2 + string.Concat(Enumerable.Range(0, agg.Item1 / arabic[cur]).Select(num => roman[cur]));
                    return Tuple.Create(remainder, concat);
                },
                agg => agg.Item2
            );
    } 
```

以下是这些方法如何工作的说明：

转阿拉伯数字

第一个聚合步骤是替换罗马数字的特殊情况（例如：IV -> IIII）。第二个聚合步骤简单地总结了罗马字母的等效阿拉伯数字（例如 V -> 5）

ToRomanNumber:

我从给定的阿拉伯数字开始聚合。对于每一步，数字将除以罗马字母的等效数字。然后，该除法的其余部分是下一步的输入。除法结果将被转换为等效罗马数字字符，该字符将附加到结果字符串中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-01-18T14:37:46.563

FWIW，这是 David DeMar 答案的“尝试解析”版本：

```
private static readonly Dictionary<char, int> _romanMap = new Dictionary<char, int>() { { 'I', 1 }, { 'V', 5 }, { 'X', 10 }, { 'L', 50 }, { 'C', 100 }, { 'D', 500 }, { 'M', 1000 } };

public static bool TryParseRoman(string text, out int value)
{
    value = 0;
    if (string.IsNullOrEmpty(text))
        return false;

    var number = 0;
    for (var i = 0; i < text.Length; i++)
    {
        if (!_romanMap.TryGetValue(text[i], out var num))
            return false;

        if ((i + 1) < text.Length)
        {
            if (!_romanMap.TryGetValue(text[i + 1], out var num2))
                return false;

            if (num < num2)
            {
                number -= num;
                continue;
            }
        }

        number += num;
    }

    value = number;
    return true;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-01-26T17:11:04.450

```
/*
this uses the string object Replace() & Split() methods
*/
int ToNumber(string roman){
    /*
    the 0 padding after the comma delimiter allows adding up the extra index produced by Split, which is not numerical
    */
    string s1=roman.Replace("CM","900,0");
    s1=s1.Replace("M","1000,0");
    s1=s1.Replace("CD","400,0");
    s1=s1.Replace("D","500,0");
    s1=s1.Replace("XC","90,0");
    s1=s1.Replace("C","100,0");
    s1=s1.Replace("XL","40,0");
    s1=s1.Replace("L","50,0");
    s1=s1.Replace("IX","9,0");
    s1=s1.Replace("X","10,0");
    s1=s1.Replace("IV","4,0");
    s1=s1.Replace("V","5,0");
    s1=s1.Replace("I","1,0");

    string[] spl=s1.Split(",");
    int rlt=0;
    for(int i=0;i<spl.Count();i++)
    {
        rlt+= Convert.ToInt32(spl[i].ToString());
    }               
    return rlt;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-10-17T18:40:30.307

我参考了这个[博客](http://blackandwhitecomputer.blogspot.com/2015/10/convert-roman-numeral-to-number-in-c.html)。您可以将罗马数字反转，然后进行比较会更容易进行比较。
public static int pairConversion(int dec, int lastNum, int lastDec) { if (lastNum > dec) return lastDec - dec; 否则返回 lastDec + dec；}

```
 public static int ConvertRomanNumtoInt(string strRomanValue)
    {
        var dec = 0;
        var lastNum = 0;
        foreach (var c in strRomanValue.Reverse())
        {
            switch (c)
            {
                case 'I':
                    dec = pairConversion(1, lastNum, dec);
                    lastNum = 1;
                    break;
                case 'V':
                    dec=pairConversion(5,lastNum, dec);
                    lastNum = 5;
                    break;
                case 'X':
                    dec = pairConversion(10, lastNum, dec);
                    lastNum = 10;
                    break;
                case 'L':
                    dec = pairConversion(50, lastNum, dec);
                    lastNum = 50;
                    break;
                case 'C':
                    dec = pairConversion(100, lastNum, dec);
                    lastNum = 100;
                    break;
                case 'D':
                    dec = pairConversion(500, lastNum, dec);
                    lastNum = 500;
                    break;
                case 'M':
                    dec = pairConversion(1000, lastNum, dec);
                    lastNum = 1000;
                    break;
            }
        }
        return dec;

    } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-07-31T21:52:59.043

```
private static HashMap<Character, Integer> romanMap = new HashMap<>() {{
    put('I', 1); put('V', 5); put('X', 10); put('L', 50); 
    put('C', 100); put('D', 500); put('M', 1000);
}};

private static int convertRomanToInt(String romanNumeral) {
    int total = 0;
    romanNumeral = romanNumeral.toUpperCase();

    //add every Roman numeral
    for(int i = 0; i < romanNumeral.length(); i++) {
        total += romanMap.get(romanNumeral.charAt(i));
    }

    //remove the Roman numerals that are followed 
    //directly by a larger Roman numeral
    for(int i = 0; i < romanNumeral.length()-1; i++) {
        if(romanMap.get(romanNumeral.charAt(i)) 
           < romanMap.get(romanNumeral.charAt(i+1))) {
           total -= 2* romanMap.get(romanNumeral.charAt(i));
        }
    }
    return total;
}

//note that the topmost solution does not solve this Roman numeral
//but mine does
//also note that this solution is a preference of simplicity over complexity
public static void main(String[] args) {
    String rn = "CcLXxiV"; //274
    System.out.println("Convert " + rn + " to " + convertRomanToInt(rn));
} 
```

* * *

## 回答 #20

> 赞同：-4
> 
> 时间：2013-02-15T18:12:55.243

```
public static int ConvertRomanNumtoInt(string strRomanValue)
{
    Dictionary RomanNumbers = new Dictionary
    {
        {"M", 1000},
        {"CM", 900},
        {"D", 500},
        {"CD", 400},
        {"C", 100},
        {"XC", 90},
        {"L", 50},
        {"XL", 40},
        {"X", 10},
        {"IX", 9},
        {"V", 5},
        {"IV", 4},
        {"I", 1}
    };
    int retVal = 0;
    foreach (KeyValuePair pair in RomanNumbers)
    {
        while (strRomanValue.IndexOf(pair.Key.ToString()) == 0)
        {
            retVal += int.Parse(pair.Value.ToString());
            strRomanValue = strRomanValue.Substring(pair.Key.ToString().Length);
        }
    }
    return retVal;
} 
```*

# ios - 阻止代码完成

> ID：14900229
> 
> 赞同：4
> 
> 时间：2013-02-15T17:37:07.380
> 
> 标签：ios, xcode, block

在下面的场景中，似乎无法使用 tab 键自动填充块的参数，而是必须将它们完整地写出来，这有点痛苦。

有没有更简单的方法来做到这一点？

![代码狙击手](../Images/a88f609c588e944bba5e09c083c9df8e.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T17:45:34.877

如果您突出显示了自动填充文本，则按下`ENTER`并为您填充参数和块体，以及额外的一点自动填充文本，内容为`code`.

# python - Unpickle 一个数据结构 Vs。通过调用 readlines() 构建

> ID：14900232
> 
> 赞同：0
> 
> 时间：2013-02-15T17:37:26.820
> 
> 标签：python, performance, pickle

我有一个用例，我需要从文件中的行构建一个列表。此操作可能会在分布式网络上执行 100 次。我一直在使用以下明显的解决方案：

```
with open("file.txt") as f:
    ds = f.readlines() 
```

我只是想，也许我最好创建一次这个列表，将其腌制到一个文件中，然后使用该文件来取消每个节点上的数据。

如果我这样做，会有任何性能提升吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T19:16:18.303

> 如果我这样做，会有任何性能提升吗？

测试一下看看！

```
try:
    import cPickle as pickle
except:
    import pickle
import timeit

def lines():
    with open('lotsalines.txt') as f:
         return f.readlines()

def pickles():
    with open('lotsalines.pickle', 'rb') as f:
        return pickle.load(f)

ds = lines()
with open('lotsalines.pickle', 'wb') as f:
    t = timeit.timeit(lambda: pickle.dump(ds, file=f, protocol=-1), number=1)
print('pickle.dump: {}'.format(t))

print('readlines:   {}'.format(timeit.timeit(lines, number=10))
print('pickle.load: {}'.format(timeit.timeit(pickles, number=10)) 
```

我的“lotsalines.txt”文件就是复制的源文件，直到它长 655360 行，或 15532032 字节。

苹果 Python 2.7.2：

```
readlines:   0.640027999878
pickle.load: 2.67698192596 
```

并且泡菜文件是 19464748 字节。

Python.org 3.3.0：

```
readlines:   1.5357899703085423
pickle.load: 1.5975534357130527 
```

它是 20906546 字节。

因此，Python 3 的速度`pickle`比 Python 2 快了很多，至少如果你使用 pickle 协议 3 的话，但它仍然远没有简单的`readlines`. （并且`readlines`在 3.x 中变得慢了很多，并且被弃用了。）

但实际上，如果您有性能问题，您应该`list`首先考虑是否需要。快速测试表明，构建`list`这种大小的 a 几乎是（ 3.x中的`readlines`时序， 2.x 中的时间）的一半。而且它使用了大量的内存（这实际上可能也是它很慢的原因）。如果您实际上不需要（通常不需要），只需遍历文件，根据需要获取行。`list(range(655360))``list(xrange(655360))``list`

# visual-studio-2010 - 如何指定我的应用绑定的 IP 地址？

> ID：14900236
> 
> 赞同：3
> 
> 时间：2013-02-15T17:37:28.493
> 
> 标签：visual-studio-2010, azure, azure-web-roles, azure-compute-emulator

我们正在开发一个相当复杂的系统，其中涉及几个不同的应用程序（MVC、基于 http 的 WCF、基于 TCP 的 WCF、ADFS 和一些通用工作角色），所有这些都部署到 Azure。对于本地调试，我们需要这些在本地 Dev Fabric 和 IIS 中运行。我已经完成了我需要做的几乎所有事情，并且一切正常，除了一件事：我无法预测各种事物将在 Dev Fabric 中绑定到哪个 IP 地址。有时是 127.0.0.1，有时是 127.0.0.3，有时是 127.0.0.4（也许还有其他一些？）。对于我的配置文件转换和 ADFS 依赖方信任，我需要提前知道这些 IP 是什么。

**我如何专门为我的网站管理/控制（或至少预测）这些 IP 地址？（WCF 一切都很好）**如果我实际上可以将所有内容部署到我的开发结构并引用正确的 IP，那么一切正常！但是，这样做非常麻烦，并且每次我需要对 web.config 和 app.config 转换文件进行几次调整（更不用说每次更改时重新配置 ADFS 服务器），所以这不是一个可持续的情况任何手段！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T05:02:48.480

我们在 ASP.NET MVC 解决方案中遇到了类似的挑战，该解决方案使用运行 WIF STS 的第二个 Web 角色进行[基于声明的身份验证](http://msdn.microsoft.com/en-us/magazine/ee335707.aspx)。MVC 应用程序的 web.config 在本地模拟器中运行时需要知道 STS 的非负载均衡器 IP 地址。

此外，我们有自定义代码构建 URL 路由，它只能看到模拟器分配的内部 IP 地址 (127.255.0.X)。这些路由在通过负载均衡器传回时会导致问题。我们还关闭了 IIS 中的默认网站，以保证模拟器完成端口重新映射。

使用 Azure 1.8 SDK，我们观察到，当从命令行启动应用程序并且删除开发结构中的所有其他部署时，本地模拟器将始终分配 127.255.0.X 地址。

一旦解决方案被打包到 VS2010 中，我们构建了一个 PowerShell 脚本来从命令行启动 Web 角色。我们有一个名为 AzureLocal 的构建配置和 Web 转换，用于为本地模拟器打包。

```
Import-Module WebAdministration
Stop-WebSite 'Default Web Site'

$env:WindowsAzureEmulatorInstallPath = (Get-ItemProperty -Path "Registry::HKLM\Software\Microsoft\Windows Azure Emulator" -Name InstallPath).InstallPath
$env:ServiceHostingSDKInstallPath = $env:WindowsAzureEmulatorInstallPath + '.NET SDK\2012-10'

$env:Path = $env:WindowsAzureEmulatorInstallPath + 'emulator;' + $env:WindowsAzureEmulatorInstallPath + 'devstore;' + $env:ServiceHostingSDKInstallPath + 'bin;' + $env:Path

csrun /devfabric:start
csrun /devstore:start
csrun /removeAll
csrun /devfabric:clean

csrun Application\Foobar.Extensions.Azure\csx\AzureLocal Application\Foobar.Extensions.Azure\bin\AzureLocal\app.publish\ServiceConfiguration.Local.cscfg

Write-Host "Application Pools to Attach for Debugging"
get-item IIS:\AppPools\*

$ie = New-Object -ComObject InternetExplorer.Application
$ie.Navigate("https://127.255.0.1:444")
$ie.Visible = $true 
```

您的应用程序听起来比我们的 STS 和 MVC 组合具有更多的移动部分，但如果您可以在 Visual Studio 之外编写启动脚本，那么您可以获得可预测的地址分配。

# c# - 按字母顺序对枚举排序后检索索引值

> ID：14900241
> 
> 赞同：0
> 
> 时间：2013-02-15T17:37:37.493
> 
> 标签：c#, linq

按字母顺序排序 typeof(EnumType) 的有效方法是什么？

枚举值的索引是非顺序的，但按字母顺序排序。（即苹果 = 5，香蕉 = 2，哈密瓜 = 3）

暂时实例化没问题。

最终，我需要所选特定枚举值的索引代码。

我问是因为我想出的方法看起来不是最好的：

```
Array tmp = Enum.GetValues(typeof(EnumType));
string[] myenum = tmp.OfType<object>().Select(o => o.ToString()).ToArray();
Array.Sort(myenum);
int enum_code = (int)Enum.Parse(typeof(EnumType), myenum.GetValue((int)selected_index).ToString());
string final_code = enum_code.ToString()); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T17:40:48.200

您可以使用 Linq 编写更紧凑和可维护的代码。除非您在高性能应用程序的内部循环中执行此操作，否则我怀疑 Linq 与您的原始代码与任何其他可能的实现的速度是否会很重要：

```
var sorted = (from e in Enum.GetValues(typeof(EnumType)).Cast<EnumType>()
              orderby e.ToString() select e).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:47:52.983

鉴于该错误，一个更费力（且与 .net 2 兼容）的解决方案是；

```
SortedDictionary<string, MyEnumType> list = new SortedDictionary<string, MyEnumType>();
foreach (Enum e in Enum.GetValues(typeof(MyEnumType)))
{
    list.Add(e.ToString(), (MyEnumType)e);
} 
```

检索枚举；

```
MyEnumType temp = list["SomeValue"]; 
```

# wpf - 绑定动态添加的元素

> ID：14900242
> 
> 赞同：0
> 
> 时间：2013-02-15T17:37:43.440
> 
> 标签：wpf, xaml

TPTB 已决定我们的应用程序必须在单个窗口中运行，不允许以模态模式弹出新窗口。

当然，我们有一个 UI 设计，涉及在整个地方弹出模式对话框。

所以我在窗口中添加了一个顶级网格。在那个网格中，我没有定义行或列，所以所有内容都绘制在第 0 行/第 0 列中。

Grid 中的第一个元素是另一个 Grid，其中包含通常显示在 Window 中的所有内容。第二个是带有灰色、半透明背景的全尺寸边框。其余的是具有宽边距和白色背景的边框，包含需要显示为弹出窗口的各种用户控件。除了第一个之外，所有的都有 Visibility="Collapsed"。

然后，当我需要显示一个弹出窗口时，我会在灰色背景和相应的 UserControl 上设置 Visibility="Visible"。结果是一个很好的阴影盒效果，效果很好。

直到有人决定弹出窗口需要能够显示弹出窗口。以不可预测的顺序。

我在网格中使用 Visibility="Collapsed" 元素实现的方法的局限性在于它们的顺序是固定的。UserControlB 将始终显示在 UserControlA 之上，即使是 UserControlB 要求显示 UserControlA。这是不可接受的。

所以我的下一个尝试是在 Window.Resources 中定义各种 UserControls，并在代码中将它们添加到 Grid 中：

```
this.masterGrid.Children.Add(this.Resources["userControlA"] as UserControlA); 
```

这几乎奏效了。但是绑定都搞砸了。

例如，其中一个控件应该将属性绑定到 Window 视图模型的成员对象中的集合的 CurrentItem。当我将控件定义为网格中的不可见项时，它工作正常。但是当我将它定义为资源时，属性为空——它从未被绑定。

因此，在将其添加到网格后，我尝试将其绑定到代码中：

```
userControlA.SetBinding(UserControlA.myProperty, new Binding()
    { Source = this.viewModel.myCollection.CurrentItem }); 
```

编译和运行都很好，但我没有绑定到正确的对象。

第一次显示 UserControl 时，我看到绑定到它的正确对象。但是当我关闭它并将集合中的 CurrentItem 移动到另一个对象并再次显示 UserControl 时，我仍然看到第一个对象绑定。如果我再次关闭它，并第三次打开它，那么我将看到正确的对象绑定到控件。

我已经检查了代码，并且我绑定的 CurrentItem 每次都是正确的，但它似乎只需要每隔一次。

所以我首先尝试明确清除绑定：

```
BindingOperations.ClearBinding(userControlA, UserControlA.myProperty);
userControlA.SetBinding(UserControlA.myProperty, new Binding()
    { Source = this.viewModel.myCollection.CurrentItem }); 
```

但这似乎没有任何区别。

总而言之，这感觉就像我在一个兔子洞里奔跑，越来越深入地追逐复杂性，以解决应该是一个相当简单的问题。

有没有人有任何建议：

1.  如何获得绑定以处理动态添加的元素，或者
2.  如何在不使用动态排序元素的情况下将任意排序的弹出窗口显示为阴影框？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T22:06:35.037

虽然您无法创建新 Windows 对我来说似乎很奇怪，但我绝对建议不要通过做不必要的事情（例如将您的视图存储在 MainWindow 的资源中）而使其过于复杂。

如果您只是将这些元素的新实例添加到 ObservableCollection 中会更好：

XAML：

```
<Window x:Class="WpfApplication4.Window8"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication4"
        Title="Window8" Height="300" Width="300">
    <Window.Resources>
        <DataTemplate DataType="{x:Type local:ViewModel1}">
            <StackPanel Background="Green">
                <TextBlock Text="This is ViewModel1!!"/>
                <TextBlock Text="{Binding Text}"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type local:ViewModel2}">
            <StackPanel Background="Blue" HorizontalAlignment="Center">
                <TextBlock Text="This is ViewModel2!!"/>
                <TextBlock Text="{Binding Text2}"/>

            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type local:ViewModel3}">
            <StackPanel Background="Red" VerticalAlignment="Center">
                <TextBlock Text="This is ViewModel3!!"/>
                <TextBlock Text="{Binding Text3}"/>
                <TextBox Text="{Binding Text3}"/>
            </StackPanel>
        </DataTemplate>

    </Window.Resources>
    <DockPanel>
        <Button Width="100" Content="Add" Click="Add_Click" DockPanel.Dock="Top"/>
        <Button Width="100" Content="Remove" Click="Remove_Click" DockPanel.Dock="Top"/>

        <ListBox ItemsSource="{Binding ActiveWidgets}" SelectedItem="{Binding SelectedWidget}">
            <ListBox.Template>
                <ControlTemplate>
                    <ItemsPresenter/>
                </ControlTemplate>
            </ListBox.Template>
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid IsItemsHost="True"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="VerticalAlignment" Value="Stretch"/>
                    <Setter Property="HorizontalAlignment" Value="Stretch"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <ContentPresenter ContentSource="Content"/>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>
    </DockPanel>
</Window> 
```

代码背后：

```
using System.Linq;
using System.Windows;
using System.Collections.ObjectModel;
using System;

namespace WpfApplication4
{
    public partial class Window8 : Window
    {
        private WidgetsViewModel Widgets { get; set; }

        public Window8()
        {
            InitializeComponent();

            DataContext = Widgets = new WidgetsViewModel();
        }

        private Random rnd = new Random();
        private int lastrandom;
        private void Add_Click(object sender, RoutedEventArgs e)
        {
            var random = rnd.Next(1, 4);
            while (random == lastrandom)
            {
                random = rnd.Next(1, 4);
            }

            lastrandom = random;

            switch (random)
            {
                case 1:
                    Widgets.ActiveWidgets.Add(new ViewModel1() {Text = "This is a Text"});
                    break;
                case 2:
                    Widgets.ActiveWidgets.Add(new ViewModel2() { Text2 = "This is another Text" });
                    break;
                case 3:
                    Widgets.ActiveWidgets.Add(new ViewModel3() { Text3 = "This is yet another Text" });
                    break;
            }

            Widgets.SelectedWidget = Widgets.ActiveWidgets.LastOrDefault();

        }

        private void Remove_Click(object sender, RoutedEventArgs e)
        {
            Widgets.ActiveWidgets.Remove(Widgets.SelectedWidget);
            Widgets.SelectedWidget = Widgets.ActiveWidgets.LastOrDefault();
        }
    }

    public class WidgetsViewModel: ViewModelBase
    {
        public ObservableCollection<ViewModelBase> ActiveWidgets { get; set; }

        private ViewModelBase _selectedWidget;
        public ViewModelBase SelectedWidget
        {
            get { return _selectedWidget; }
            set
            {
                _selectedWidget = value;
                NotifyPropertyChange(() => SelectedWidget);
            }
        }

        public WidgetsViewModel()
        {
            ActiveWidgets = new ObservableCollection<ViewModelBase>();
        }
    }

    public class ViewModel1: ViewModelBase
    {
        public string Text { get; set; }
    }

    public class ViewModel2: ViewModelBase
    {
        public string Text2 { get; set; }
    }

    public class ViewModel3: ViewModelBase
    {
        public string Text3 { get; set; }
    }
} 
```

只需将我的代码复制并粘贴到文件 - 新建 - WPF 应用程序中，然后自己查看结果。

由于 Grid 总是将添加到它的最后一个 UI 元素放在最顶部，因此您将看到向 observablecollection 添加项目会使这些“不同的小部件”始终彼此重叠出现，最顶部是最后添加的一个。

底线是，当`WidgetA`请求打开时`WidgetB`，只需创建一个新的`WidgetBViewModel`并将其添加到`ActiveWidgets`集合中。然后，当`WidgetB`不再需要时，只需将其删除。

然后，只需将您的 UserControls 放入每个 ViewModel 的适当 DataTemplate 中。我强烈建议您为每个 Widget 保留一个单独的 ViewModel，如果您需要在它们之间共享数据，只需在 ViewModel 之间共享数据即可。`ListBox ItemsSource="{Binding Whatever, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}"` **除非**你有充分的理由，否则不要尝试做类似的事情。

这样你就不再需要处理`Panel.ZIndex`东西了。也许您可以创建几个附加属性来处理诸如焦点之类的事情，但是这种方法非常简单，并且比 the`Visibility`和`Resources`方法具有更高的性能。

# ios - 在 Objective-C 中限制录制的视频大小

> ID：14900245
> 
> 赞同：3
> 
> 时间：2013-02-15T17:37:51.233
> 
> 标签：ios, objective-c, video, uiimagepickercontroller

我想知道是否有办法限制 iOS 中录制的视频*大小*。我知道可以限制*duration*，但在我看来没有办法限制实际*大小*，至少我找不到它。

# r - R 包 mgcv 是否存在已知的兼容性问题？是否有通用的兼容性规则？

> ID：14900248
> 
> 赞同：5
> 
> 时间：2013-02-15T17:38:03.533
> 
> 标签：r, mgcv

我使用 R 版本 2.15.1 (2012-06-22) 和 mgcv 版本 1.7-22

我在 R 中加载了以下一组包：

```
 library(sqldf)
library(timeDate)
library(forecast)
library(xts)
library(tseries)
library(MASS)
library(mgcv) 

```

碰巧我不能运行一个简单的模型（我省略了代码）。甚至从帮助页面中获取的示例代码：

```
 dat = gamSim(1,n=400,dist="normal",scale=2)
b = gam(y~s(x0)+s(x1)+s(x2)+s(x3),data=dat) 

```

给出一个错误：

```
 Error in qr.qty(qrc, sm$S[[l]]) : 
  NA/NaN/Inf in foreign function call (arg 5)
In addition: Warning message:
In smoothCon(split$smooth.spec[[i]], data, knots, absorb.cons, scale.penalty = scale.penalty,  :
  number of items to replace is not a multiple of replacement length 

```

请注意，如果我只是加载包 mgcv 然后立即使用示例代码，一切正常。如果我只是加载所有包并运行示例代码，它也可以工作。如果我只是行不通

1.  加载所有包
2.  做一些文件读取、sqldf 语句、ts 操作和一些来自包预测的模型。
3.  如果我然后应用 GAM，它就不再起作用了。

显然，一般环境中的变量定义会破坏包的功能。

是否有任何已知问题？如果我加载各种包，是否有必须遵守的一般规则？我可以编写“干扰”包 mgcv 的代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T21:11:02.897

@Richard 有 2 个与 GAM 相关的软件包：gam 和 mgcv。同时加载两个库通常会导致冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T08:37:43.100

加载 mgcv 作为第一个包解决了我的问题......奇怪但真实。

# mysql - 访问表的值并将其与 sql 中的字符串进行比较

> ID：14900249
> 
> 赞同：0
> 
> 时间：2013-02-15T17:38:03.387
> 
> 标签：mysql, sql, triggers

我在将表 1 中的值与字符串进行比较时遇到了麻烦这是我尝试过的..

```
DELIMITER $$
DROP TRIGGER IF EXISTS comment_trigger$$
CREATE TRIGGER  comment_trigger AFTER INSERT ON post_comments
FOR EACH ROW
DECLARE 
@var_post_id varchar(20);
BEGIN
IF (NEW.post_id LIKE 'rmdid%') THEN
SET @var_post_id=SELECT post_id FROM recommendations WHERE recommendation_id=NEW.post_id;
IF(@var_post_id LIKE 'recid%') THEN
UPDATE cooking_category SET last_activity=NEW.comment_time WHERE post_id=NEW.post_id;
END IF;
END IF;
END$$
DELIMITER ; 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:06:03.347

您可以直接在`select`语句中分配变量：

```
SELECT @var_post_id = post_id
FROM recommendations
WHERE recommendation_id=NEW.post_id; 
```

`select`这是首选，但如果您在语句周围加上括号，您的语法也可以使用：

```
SET @var_post_id=(SELECT post_id FROM recommendations WHERE recommendation_id=NEW.post_id); 
```

# excel - Excel 工作表属性窗口出现空白

> ID：14900253
> 
> 赞同：2
> 
> 时间：2013-02-15T17:38:25.120
> 
> 标签：excel, properties, vba

我正在尝试使用“开发人员”选项卡上的“属性”按钮访问 Excel（在本例中为 2007）工作表的“属性”窗口，如此处[所述](http://chandoo.org/wp/2011/01/25/worksheet-properties-via-a-menu/)。我想进入“属性”窗口的原因是设置诸如对象名称之类的属性，以便在解决它的 VBA 脚本中使用。

属性窗口出现了，但它是空白的，顶部没有我正在查看的对象的标识，也没有列出任何属性。为什么会这样，我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T17:38:25.120

事实证明，这样做的原因是我有相关的 VBA 项目受密码保护。当我打开 VBA 项目并在提示时输入密码时，“属性”窗口再次开始工作。

# npm - Windows：找不到“grunt.js”配置文件

> ID：14900259
> 
> 赞同：1
> 
> 时间：2013-02-15T17:38:42.423
> 
> 标签：npm, gruntjs

在 Windows 下，当我在项目上运行 grunt 时出现以下错误：

找不到“grunt.js”配置文件。你需要帮助吗？

我的配置与我的 mac 完全相同，但它失败了 - 有人看到了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:40:05.450

这是我为解决此问题所做的工作：

全局卸载 grunt：

```
npm uninstall -g grunt 
```

全局安装 grunt-cli：

```
npm install -g grunt-cli 
```

然后，在项目根目录中：

```
npm install 
```

一切都很好。希望这适用于其他遇到此问题的人。

# java - 视频 android 编程的困难（无图像）

> ID：14900261
> 
> 赞同：0
> 
> 时间：2013-02-15T17:38:48.453
> 
> 标签：java, android, eclipse, mobile, galaxy-tab

我尝试在 Galaxy Tab 2 上放一个视频，但是，应用程序启动但我没有图像，我只有声音。所以我尝试在手机（Galaxy S2）上运行该应用程序，它可以工作（声音+视频）（我的视频是尺寸为 1280x800 的 mp4）。

**代码：**

```
import android.app.Activity;
import android.net.Uri;
import android.os.Bundle;
import android.view.Window;
import android.view.WindowManager;
import android.widget.MediaController;
import android.widget.VideoView;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.activity_main);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);

    //VideoView view = new VideoView(this);
    VideoView view = (VideoView)findViewById(R.id.view);
    //view.setMediaController(new MediaController(this));
    //setContentView(view);
    view.setVideoURI(Uri.parse("android.resource://"+this.getPackageName()+"/"+R.raw.video4));
    view.requestFocus();
    view.start();
    }
} 
```

**XML:**

```
<?xml version="1.0" encoding="utf-8"?>
<VideoView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" android:id="@+id/view"
android:layout_height="fill_parent" android:layout_alignParentRight="true"
android:layout_alignParentLeft="true" android:layout_alignParentTop="true"
android:layout_alignParentBottom="true" android:layout_gravity="center">
</VideoView> 
```

**日志猫：**

```
02-13 20:55:21.707: D/OpenGLRenderer(31903): Flushing caches (mode 1)
02-13 20:55:22.105: D/OpenGLRenderer(31903): Flushing caches (mode 0)
02-13 20:56:23.699: D/libEGL(31991): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
02-13 20:56:23.707: D/libEGL(31991): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
02-13 20:56:23.707: D/libEGL(31991): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
02-13 20:56:23.902: D/OpenGLRenderer(31991): Enabling debug mode 0
02-13 20:56:23.933: I/MediaPlayer(31991): path is null
02-13 20:56:24.050: W/MediaPlayer(31991): info/warning (901, 0)
02-13 20:56:24.199: I/MediaPlayer(31991): Info (901,0)
02-13 20:56:24.199: E/MediaPlayer(31991): mOnInfoListener is null. Failed to send MEDIA_INFO message.
02-13 20:56:24.207: D/MediaPlayer(31991): getMetadata 
```

在这里，我尝试 avi 它是相同的。

我更改了视频的格式（我放了 flv），它可以工作，但我在 logcat 中再次遇到问题：

```
02-15 21:53:06.189: D/libEGL(15791): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
02-15 21:53:06.189: D/libEGL(15791): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
02-15 21:53:06.196: D/libEGL(15791): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
02-15 21:53:06.321: D/OpenGLRenderer(15791): Enabling debug mode 0
02-15 21:53:06.345: I/MediaPlayer(15791): path is null
02-15 21:53:06.689: D/MediaPlayer(15791): getMetadata
02-15 21:53:12.978: W/IInputConnectionWrapper(15791): showStatusIcon on inactive InputConnection 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:19:22.773

“路径为空”这可能是您的问题，请确保 uri 正确。此外 android.resource 看起来或听起来都不正确...仔细检查一下。

## 更新

此外，您可能希望在调用 start 之前等待**准备完成：**

[http://developer.android.com/reference/android/widget/VideoView.html#setOnPreparedListener(android.media.MediaPlayer.OnPreparedListener)](http://developer.android.com/reference/android/widget/VideoView.html#setOnPreparedListener(android.media.MediaPlayer.OnPreparedListener))

## 更新

试试这个 URI：

```
file:///android_asset/(filename.here) 
```

# java - 无法找出 NoClassDefFoundError 的原因：aspose/pdf/Paragraph

> ID：14900263
> 
> 赞同：0
> 
> 时间：2013-02-15T17:38:54.050
> 
> 标签：java, eclipse, tomcat, aspose

由于这个 NoClassDefFound 错误，我无法加载我的 webapp 的任何页面（本地在 Tomcat 7.0.2.6 上）。我在我的智慧结束试图找出原因是什么，这是我所知道的：

我的同事让这个项目在本地（在 Tomcat 上）和我们的开发服务器（WebLogic）上成功运行。

我已经从 svn 做了一个新的下拉，所以我的代码和他的完全一样。我已经验证我有一个对 Aspose 的共享库引用（并且所需的 .jar 在那里），并且 weblogic.xml 有一个条目。

我们最初在 WebLogic 上部署时看到了同样的错误，因为 Aspose 库的名称不正确，但它在他的 Tomcat 服务器上本地运行良好。

我试过清理和重建项目没有效果。

尽我所能，它必须是 Tomcat 问题，或者可能是 Eclipse 设置。

有没有人遇到过类似的情况？关于尝试解决此问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:11:03.453

您需要做的第一件事是确定您是否与另一个具有相同名称和包的类发生冲突。最简单的方法是使用 cygwin/linux 控制台，将这个 shell 脚本保存到一个文件中，比如 findjar

```
find "$1" -name "*.jar" -exec sh -c 'jar -tf {}|grep -H --label {} '$2'' \; 
```

把它放在你的路径中并导航到服务器实例的根目录并像这样运行脚本

```
findjar . yourclass 
```

注意期间，不要忘记它。如果您的项目中有多个具有相同名称的类，这将返回。

一旦您确定项目是干净的并且该类只有一个副本，我会尝试将您的共享库文件夹实际添加到 websphere 服务器实例 JVM 参数中。要做到这一点：

1.  进入管理员，点击服务器
2.  打开服务器类型，点击websphere应用服务器
3.  您应该会在那里看到您的服务器，单击它
4.  在右侧，您将看到“服务器基础架构”部分，其下方是“Java 和进程管理”子部分</li>
5.  打开该部分并点击“流程定义”</li>
6.  在流程定义屏幕上是另一个右侧列。点击“Java虚拟机”</li>
7.  是的，终于我们在正确的屏幕上，这里有尽头，我保证
8.  在虚拟机页面上，有一个标有“类路径”的大文本字段您需要做的是输入共享库文件夹的完整路径

这样做很奇怪，而且毫无意义，但我过去不得不这样做，以允许我的代码查看共享资源中的属性文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:42:14.307

您的同事可能在他的 Tomcat 实例本身中安装了 java 库。

在 Tomcat 目录中查看一些 lib 文件夹（我不记得确切的位置，我认为它会根据版本而变化），但类似于 ${CATALINE_HOME}/common/lib

验证他在他的 tomcat 安装中没有与您的不同的 JAR 文件。

来自这个问题：[如果它们在两个 Web 应用程序中，Tomcat 是否会将相同的库文件加载到内存中两次？](https://stackoverflow.com/questions/267953/managing-libraries-in-tomcat) 它们显然存储在这里：

```
Tomcat 6 $CATALINA_HOME/lib
Tomcat 5 $CATALINA_HOME/common/lib 
```

# c# - 让 ServiceStack 默认路由转到 MVC3 控制器

> ID：14900265
> 
> 赞同：1
> 
> 时间：2013-02-15T17:39:06.587
> 
> 标签：c#, asp.net-mvc, servicestack

我已经安装`ServiceStack.Host.MVC`到具有很多控制器的现有 MVC3 项目中。

它现在路由到 default.htm。我发现另一个 StackOverFlow 问题说要更改默认重定向路径，请执行以下操作。

```
SetConfig(new EndpointHostConfig {DefaultRedirectPath = "/Foo" }); 
```

但我真的很想改变它来执行默认的控制器和操作作为 global.ascx 中的设置。我已经编辑了 DefaultRedirectPath 以指向*/Home*，它似乎工作正常，并且没有将 Home 添加到我的 url 或任何东西，但我不是 100% 了解在我的应用程序中拥有 AppHost 之间的关系。

如果更改这不是正确的做法，那么开始将一些 Service Stack AppHost 与常规 MVC 应用程序集成的最佳方法是什么。我将把我的基本控制器移到`ServiceStackController`，然后慢慢开始使用新的会话和用户管理的东西。最终，我将希望将授权或共享 sessionId 用于某些服务，但我稍后会谈到。

首先，我的目标是开始使用 Funq 的一些 IOC 功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:42:38.393

您可能不需要 DefaultRedirectPath，因为它只是对预定义 URL 的重定向。在使用旧的 url 时，您需要点击 MVC 控制器，并为 ServiceStack 提供一个新的 URL 区域。为此，[首先设置`ServiceStackHandlerFactoryPath`](https://github.com/ServiceStack/ServiceStack/wiki/Run-servicestack-side-by-side-with-another-web-framework). 它应该允许您在子 url 中托管 ServiceStack，并且它不会干扰您现有的控制器，除非路径中存在冲突：

```
SetConfig(new EndpointHostConfig { ServiceStackHandlerFactoryPath = "api" }); 
```

web.config 中的 ServiceStack http 处理程序需要匹配：

```
<location path="api">
<!-- Required for IIS 7.0 -->
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <add path="*" name="ServiceStack.Factory" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack" verb="*" preCondition="integratedMode" resourceType="Unspecified" allowPathInfo="true" />
    </handlers>
  </system.webServer>
</location> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T15:31:02.800

ServiceStack BootstrapAPI 应用程序将 CatchAllController 设置为 MVC 应用程序的 HomeController。这对我有用。

在 AppHost::Configure 中，我输入了以下代码：

```
public override void Configure(Funq.Container container)
{
  //  Other Configuration constructs here

  ServiceStackController.CatchAllController = reqCtx => container.TryResolve<HomeController>();
} 
```

# java - 使用 convertView 和自定义数据 listView 时出现 NullPointerException

> ID：14900270
> 
> 赞同：1
> 
> 时间：2013-02-15T17:39:14.480
> 
> 标签：java, android, listview, custom-adapter, convertview

我正在使用自定义数据 listViews 和一个 convertView 来创建一个可以填充自定义数据的基本 listView，我在底部附近的一段代码中得到一个空指针异常，该代码块具有“holder.text1.setText(X); " 等等。我不知道为什么以及如何解决这个问题。

**（按照建议，我在 else 语句中初始化了文本视图，但仍然抛出相同的异常）**

```
 package com.example.worksheet2;

import android.app.ListActivity;
import android.content.Context;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

 public class D extends ListActivity {

final class DataMap {
    public String contactName = "";
    public int followerCount;

    public DataMap(String contactName, int followercount) {
        this.contactName = contactName;
        this.followerCount = followercount;
    }

}

protected LayoutInflater mLayoutInflater;
protected Context mContext = this;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.home_list_view);
    mLayoutInflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    DataMap[] data = new DataMap[] {

    new DataMap("Person A", 1),
    new DataMap("Person B", 6),
    new DataMap("Person C", 6),
    new DataMap("Person D", 6),
    new DataMap("Person E", 6)

    };

    setListAdapter(new listViewAdapter(this, R.layout.home_list_view_list_item, data));

}

class ViewHolder {
    public ImageView avatar;
    public TextView text1, text2;

}

final class listViewAdapter extends ArrayAdapter<DataMap> {
    private int layoutResource;
    public DataMap[] dataObjects;

    public listViewAdapter(Context context, int resource, DataMap[] objects) {
        super(context, resource, objects);
        layoutResource = resource;
        dataObjects = objects;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        TextView monkey = (TextView) findViewById(R.id.monkey);
        ViewHolder holder;
        if (convertView == null) {
        convertView=                                                 mLayoutInflater.inflate(layoutResource,       null, false);
            holder = (ViewHolder) convertView.getTag();
            holder = new ViewHolder();
            holder.avatar = (ImageView) findViewById(R.id.avatar);
            holder.text1 = (TextView) findViewById(R.id.title);
            holder.text2 = (TextView) findViewById(R.id.link);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
            holder = new ViewHolder();

        }

        DataMap data = dataObjects[position];
        holder.text1.setText(data.contactName);
        holder.text2.setText(data.followerCount);
        holder.avatar.setImageResource(R.drawable.ic_launcher);

        return convertView;
    }

} 
```

}

**编辑**

这是要求的日志/堆栈跟踪：

```
 02-15 17:45:53.181: E/ListView(1006): null
   02-15 17:45:53.181: E/ListView(1006): java.lang.NullPointerException
   02-1517:45:53.181:E/ListView(1006):at com.example.worksheet2.D$listViewAdapter.getView(D.java:89)                                                   
02-15 17:45:53.181: E/ListView(1006):   at android.widget.AbsListView.obtainView(AbsListView.java:1449)
02-15 17:45:53.181: E/ListView(1006):   at android.widget.ListView.makeAndAddView(ListView.java:1801)
02-15 17:45:53.181: E/ListView(1006):   at android.widget.ListView.fillDown(ListView.java:671)
02-15 17:45:53.181: E/ListView(1006):   at android.widget.ListView.fillFromTop(ListView.java:728) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:45:07.883

只看 getView 方法：

如果 convertView 不为空，则 holder.text1 和 holder.text2 可能为空，因为在 if 语句之外实际上没有任何东西将 text1 和 text2 初始化为 TextViews。我会在 else 代码块中解决这个问题。

下一次，异常的堆栈跟踪会很好地查看异常发生在哪一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:53:07.273

您没有在 listViewAdapter.getView() 的 else 块中设置 holder.text1、holder.text2 或 holder.avatar。我建议进行类似的更改：

```
 ...
    if (convertView == null) {
        convertView = mLayoutInflater.inflate(layoutResource,       null, false);
        holder = (ViewHolder) convertView.getTag();
        holder = new ViewHolder();

        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
        holder = new ViewHolder();
    }
    holder.avatar = (ImageView) findViewById(R.id.avatar);
    holder.text1 = (TextView) findViewById(R.id.title);
    holder.text2 = (TextView) findViewById(R.id.link);
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-01T07:54:15.310

更改您的 getView() 方法，如下所示：

```
TextView monkey = (TextView) findViewById(R.id.monkey);
        ViewHolder holder;
        if (convertView == null) {
        convertView = mLayoutInflater.inflate(layoutResource, null, false);
            holder = (ViewHolder) convertView.getTag();
            holder = new ViewHolder();
            holder.avatar = (ImageView) findViewById(R.id.avatar);
            holder.text1 = (TextView) findViewById(R.id.title);
            holder.text2 = (TextView) findViewById(R.id.link);

            convertView.setTag(holder);

        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        DataMap data = dataObjects[position];
        holder.text1.setText(data.contactName);
        holder.text2.setText(data.followerCount);
        holder.avatar.setImageResource(R.drawable.ic_launcher); 
```

# linux - ubuntu安装后USB复用

> ID：14900279
> 
> 赞同：3
> 
> 时间：2013-02-15T17:39:56.537
> 
> 标签：linux, ubuntu

这似乎是一个愚蠢的问题，但是......
在使用 USB 安装 Ubuntu 之后，是否可以再次将其用作常规 USB，或者它是否像 CD 安装一样，USB 现在只适合安装 Ubuntu？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:54:27.103

是的你可以。

事实上，您可以保持 Ubuntu 设置不变，并使用剩余的可用空间来存储其他东西，以防您将来需要安装 Ubuntu。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:49:56.077

你可以正常使用它，只要确保你已经清理了 MBR，以防你在重启时插入设备（当 USB 引导仍然启用时）。

最简单的方法是格式化整个分区（或使用分区管理器清理整个设备）。[GParted](http://gparted.sourceforge.net/index.php)应该能够为您做到这一点。

一些（粗略的！）技术背景：

USB 设备是闪存设备，其中位存储为非易失性，但可擦除和可更改。普通 CD-ROM 上的位将真正被“刻录”，因为在创建 CD 时反射容量将永久改变。启动计算机时，有一个包含引导加载程序的小内存 ROM，它正在查找在前 512 个字节包含 MBR 的设备，它将被执行并加载操作系统（或者在你的情况下是 Ubuntu 的第一步安装过程）。

因此，如果您想再次将 USB 设备用作普通数据存储，您还应该清除这些前 512 字节，因为在重新启动时插入设备时可能会加载来自 USB 的引导加载程序。然后引导加载程序可能会抛出异常，因为它通常会期望 Ubuntu 安装文件存在于该设备上。

# javascript - 测试正则表达式 javascript

> ID：14900280
> 
> 赞同：0
> 
> 时间：2013-02-15T17:39:59.450
> 
> 标签：javascript, expression

我已经为数量编写了一个正则表达式，他们可以订购的最大数量是每个（夏季、秋季、冬季）500 个。表达式是——

```
 var chkquantity = ^([1-9]?\d|[1-4]\d{2}|500)$/ 
```

我不确定测试是否正确-

```
if ((chkquantity.test(quantity)== false){
  alertmsg = alertmsg + "Please limit each magazine to 500 copies or less:" + "\n";
} 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:43:51.337

如果您正在处理数字，请将它们作为数字处理。

```
if (Number(quantity) > 500) {
    alertmsg = alertmsg + "Please limit each magazine to 500 copies or less:" + "\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:48:00.867

根据 Torsten 的答案，您可能还想验证它是一个数字。

```
if(Number(quantity) > 500 || isNaN(quantity)) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:56:14.567

由于您正在处理数字，因此您可以使用更简单的方法来摆脱困境。只需验证它是所有数字，并且数值小于或等于500

```
function checkLimit(val){
    if (!isNaN(val) && parseInt(val)<500)
        return true;
    else if(isNaN(val)){
        alert ("Enter valid quantity.");

    return false;
}

if (!checkLimit(quantity))
    alertmsg = alertmsg + "Please limit each magazine to 500 copies or less:" + "\n"; 
```

# php - php Mysqli 自定义错误信息

> ID：14900281
> 
> 赞同：1
> 
> 时间：2013-02-15T17:40:00.363
> 
> 标签：php, mysql

我有一个使用 php 的网页，它使用 mysqli 函数与 MySql 数据库交互。我想禁止来自 MySql 和 Php 的所有错误消息，并将这些错误记录在数据库中以进行跟踪和历史记录。显然我不希望弹出 MySql 查询供用户查看，我想要一条自定义消息。诸如“服务器错误：请重试”之类的东西。

是否有任何方法可以将其实施到我的网站中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:01:48.323

这是一个示例，可以帮助您混淆用户的错误消息。

```
<?php
mysqli_report(MYSQLI_REPORT_OFF); //Turn off default messages

$mysqli = new mysqli("localhost", "user", "password", "database");

$query = "SELECT * FROM Table ";
$res = $mysqli->query($query);

if ($mysqli->error) {
    try {    
        throw new Exception("MySQL error $mysqli->error <br> Query:<br> $query", $msqli->errno);    
    } catch(Exception $e ) {
        // Log your error in db or just output it
        // using $e->getMessage() to log the actual message;
        echo nl2br($e->getTraceAsString());
    }
}

?> 
```

# c++ - 为什么使用静态字符缓冲区来实例化从 DLL 加载的 C++ 类

> ID：14900283
> 
> 赞同：3
> 
> 时间：2013-02-15T17:40:02.470
> 
> 标签：c++, dll, new-operator

今天我看到这个 C++ 代码从 EXE 中创建一个驻留在 DLL 中的类（加载 DLL 之后）

```
extern "C"
{
    DLL_EXPORT MyClass *CreateClass()
    {
        static char classBuffer[sizeof(MyClass)];

        return new ((void*)classBuffer)MyClass();
    }
} 
```

我不明白为什么在这里我们不简单地使用 new 运算符，而是首先声明该静态缓冲区，然后将其与类实例化一起使用。任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:46:09.337

`new`因为它避免了对and的依赖`delete`，但仍然调用了构造函数。

但这也意味着您不能拥有该类的多个实例[至少在同一个进程中]。这可能是故意的，以避免不止一个实例，也可能是一个缺陷。这完全取决于课程本身的目的是什么。但是多次调用这个函数是个坏主意——我认为它应该有一些保护措施。

我觉得这不是解决问题的理想方法，但是如果不了解类的整体“背景”和这个实现，很难说还有什么其他的解决方案，哪个是正确的。

# objective-c - 从 NSDictionary 构建嵌套的 NSMenu

> ID：14900284
> 
> 赞同：2
> 
> 时间：2013-02-15T17:40:02.840
> 
> 标签：objective-c, cocoa, nsdictionary, nsmenu

我已经构建了一个包含多个嵌套层的 NSDictionary，我想将其复制为 NSMenu，这样当我的 NSDictionary 更新时，我的 NSMenu 也会更新。例如，如果我有一个 NSDictionary 包含：

```
Item1
 |---Item 1.1
 |---Item 1.2

Item2
 |---Item 2.1
 |    |---Item 2.1.1
 |---Item 2.2
 |---Item 2.3 

Item3 
```

这应该会导致我的菜单包含三个条目 - 第 1 项、第 2 项和第 3 项。第 1 项和第 2 项应该是子菜单，第 2.1 项也是如此。

如果我删除第 2 项，则第 2 项及其所有子菜单也应删除。

问题是我不知道如何解决这个问题。我知道如何以编程方式制作 NSMenu，所以我不会在没有任何知识的情况下处理这个问题，但我不知道如何以这种方式模拟绑定。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:18:58.667

执行此操作的方法是将对象设置为菜单委托（请参阅 参考资料[`NSMenuDelegate`](http://developer.apple.com/library/mac/#documentation/cocoa/reference/NSMenuDelegate_Protocol/Reference/Reference.html)）。我将菜单项的标签设置为唯一值，然后在启动期间找到该菜单项。我使用 App Delegate 作为菜单委托，然后通过实现以下委托方法来构建菜单：

```
- (NSInteger)numberOfItemsInMenu:(NSMenu *)menu;

- (BOOL)menu:(NSMenu *)menu
  updateItem:(NSMenuItem *)item
     atIndex:(NSInteger)index
shouldCancel:(BOOL)shouldCancel; 
```

您增加了任意复杂的字典结构的复杂性，因此您需要创建一个自定义类来存储每个菜单项（菜单文本和选择器，作为字符串，以及您可能需要的任何其他内容）。然后将这些项目和任何子词典存储在主词典中。

当您枚举字典（在`menu:updateItem:atIndex:shouldCancel:`委托方法中）时，您将需要使用测试对象（自定义对象或字典）的类型，`isKindOfClass`并且为了处理任意嵌套，您可能需要使用私有的递归方法处理单个字典。

祝你好运; 这并不简单，但肯定是可以实现的。

# java - 每次查看活动时如何调用方法？

> ID：14900287
> 
> 赞同：5
> 
> 时间：2013-02-15T17:40:07.487
> 
> 标签：java, android, eclipse, android-activity

每次查看活动时如何调用方法？

例如，我从 导航`activity1`到`activity2`。现在我再次导航到`activity1`. 每次`activity1`显示/导航到该活动时，我都需要运行该方法`loadEveryTime()`。我怎样才能做到这一点？请帮忙！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T17:41:13.450

`onResume()`每次恢复 Activity 时都会调用它，所以把你的方法调用放在那里。确保调用超类。

```
@Override
protected void onResume()
{
  super.onResume();
  loadEveryTime();
} 
```

# post - 使用扩展创建 OData POST 实体

> ID：14900289
> 
> 赞同：8
> 
> 时间：2013-02-15T17:40:42.510
> 
> 标签：post, odata, expand

我正在尝试同时创建一个实体和两个子实体的实例。

如果我将以下 JSON 发布到 /user_objects 资源，它会愉快地创建父 user_object 实体和链接的 User_object_attribute 实体。唯一的问题是我似乎无法扩展结果集以包含新的 user_object_attribute 所以我实际上拥有最新版本的 user_object 但我必须去从 OData 服务读取，即另一个服务器命中为了检索 user_object_attributes。

返回后，我的 id 可以整齐地进入子 user_object_attribute 对象，但是如果孩子有一个像 created_date 这样的服务器端生成字段呢？那么我还需要再次访问 OData 存储库吗？

我已经尝试了正确的 $expand 查询 ?$expand=user_objects_attributes 并且虽然创建成功，但我仍然没有返回扩展的结果集。

有人知道这是否可能吗？还是不是因为这样做的唯一方法是返回所有子user_object_attributes？

```
{
   "annotator_id":1,
   "content_type":"content_type",
   "created_date":"2013-02-15T17:20:09.191",
   "guid":"GUID",
   "size_kb":100,
   "title":"Title",
   "updated_date":null,
   "url":"URL",
   "user_object_id":0,
   "user_objects_attributes":[
      {
         "attribute_id":0,
         "name":"name191",
         "user_object_id":0,
         "value":"value191"
      }
   ]
} 
```

谢谢，马克。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T03:26:11.947

[在这里查看](http://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5BMS-ODATA%5D.pdf)OData V3 规范：

> 在 1.0 和 2.0 版本中，如果插入完全成功，服务器必须返回一个带有 201（已创建）状态代码的响应和一个符合 InsertEntity Request（第 2.2.7.1.1 节）中指定的语法的响应正文。在服务器执行了所有服务器特定的数据处理规则（验证等）之后，响应正文必须包含插入资源的值。在资源插入服务器之前，服务器可以更改从客户端接收到的资源的值。
> 
> 在版本 3.0 中，响应可能有一个 204 状态代码，如 [RFC2616] 中所指定，基于 InsertEntity 请求上的客户端偏好（参见 Prefer（第 2.2.5.9 节））。

不清楚服务器应该做什么......只返回顶级创建的实体，或者该实体以及所有它的扩展链接。

我对 $expand 对 POST （或任何 CUD 请求）没有影响并不感到惊讶。如果不是查询，WCF DS 可能会忽略它。根据规范，这可能是正确的。

坦率地说，我认为使用 WCF DS Server 您将无法获得其他任何东西。在 V3 中，您可以（仅）获得带有实体的 201，或者如果您指定标头说您不想要内容，则获得 204 无内容。

这是否符合 OData... 不完全确定:-)。无论如何，我认为您目前无法在 WCF DS 堆栈上获得您想要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-01T03:41:50.430

我能够在使用 OData v4 的查询选项`POST`创建新实体之后返回导航属性，而不会出现问题。`$expand`

确保您的方法被装饰，`[EnableQuery]`并且您`Include`使用导航属性的名称进行调用。

例如：

```
[EnableQuery]
public IHttpActionResult Post(user_object user)
{
    if (!this.ModelState.IsValid)
    {
        return this.BadRequest(this.ModelState);
    }

    this.db.user_objects.Add(user);
    this.db.SaveChanges();

    user = this.db.user_objects.Include("user_objects_attributes").Single(x => x.user_object_id == user.user_object_id));

    return this.Created(user);
} 
```

`POST`URL 查询字符串应`?$expand=user_objects_attributes`包括.

另见：
[https ://github.com/OData/WebApi/issues/356](https://github.com/OData/WebApi/issues/356)

# magento - Magento 设计更新仅在搜索结果页面上替换 list.phtml

> ID：14900291
> 
> 赞同：2
> 
> 时间：2013-02-15T17:40:43.757
> 
> 标签：magento, magento-1.7

如何向 Magento 发布设计更新以仅替换搜索结果页面的 list.phtml 模板？有不止一种方法可以做到吗？如果有一种方法可以像我一样通过管理面板对单个类别进行操作，那将是理想的，但如果没有，那么编辑 xml 文件也可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:57:15.333

您应该创建文件：`app/design/frontend/YOURPACKAGE/YOURTHEME/layout/local.xml`具有内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<layout version="0.1.0">
  <catalogsearch_result_index>
    <reference name="search_result_list">
        <action method="setTemplate"><template>custom/list.phtml</template></action>
    </reference>
  </catalogsearch_result_index>
</layout> 
```

并创建您的自定义模板，例如`app/design/frontend/YOURPACKAGE/YOURTHEME/template/custom/list.phtml`

# android - 将视图添加到 listView 和 scrollView

> ID：14900296
> 
> 赞同：0
> 
> 时间：2013-02-15T17:40:50.733
> 
> 标签：android, android-listview, android-linearlayout

我尝试在同一个控制器中将视图添加到 ScrollView 和布局（线性或相对不会改变任何内容）

```
RelativeLayout header = (RelativeLayout)((LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE)).inflate(R.layout.frame_header, null);
mListView.addHeaderView(header);
mLayout.addView(header); 
```

但是当我这样做时，它会崩溃

```
java.lang.ClassCastException: android.widget.LinearLayout$LayoutParams cannot be cast to android.widget.AbsListView$LayoutParams 
```

此外，当我只将我的视图分配给 listView 或布局时，它可以完美地工作..

有人有解决我问题的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:43:27.913

A`View`只能有一个父母，所以你想要的是不可能的。

# java - 使用 JDBM3 的意外内存负载

> ID：14900303
> 
> 赞同：0
> 
> 时间：2013-02-15T17:41:14.600
> 
> 标签：java, memory, memory-leaks

虽然 JDBM3 数据库承诺（据我所知）在访问和写入数据时使用非常小的内存，但我有以下问题：即使在 TreeMap 的键集中迭代时，似乎所有数据都加载到内存中。所以下面的代码：

```
 db=DBMaker.openFile("Myfile")
        .make();   
    SortedMap<Integer, double[]> MyMap=db.getTreeMap("MyMap");
    int i=0;
    final Set<Integer> keySet = MyMap.keySet();
    for (Object key : keySet) {
        System.out.println(i++);
     } 
```

导致将所有双精度矩阵加载到内存中，最后导致 OutOfMemory 错误。在我看来，加载的 GB 也比数据本身多得多。到目前为止我考虑的事情是：

*   这是一个错误吗？或者在创建/打开数据库（缓存、事务？）时有一些参数会禁用此“功能”？

*   这是我使用的 JDBM3 alpha 3 中的一个错误（当有 alpha 4 时）？我只需要在切换之前验证这一点，因为不兼容，我必须从头开始做所有事情。

*   更新的 MapDB（以前的 JDBM4）会发生这种情况吗？我还需要在切换之前验证这一点。

*   还是出于某种原因这是图书馆的正常行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:57:14.903

首先：OOEM 的常见原因是写入。JDMB3 将未提交的数据保存在内存中。因此，对于大型事务，您将耗尽内存。解决方案是提交每 N 个项目。或者您可以禁用事务（DBMaker 选项）以将更改直接写入文件。

第二：迭代键集不应该将所有数据加载到内存中。如果是这样，那就是错误。但是 JDBM3 不受支持，所以我建议迁移到 MapDB。

# iphone - 使用 Target iOS 5.0 从 iOS SDK 6.1 加载 Maps App

> ID：14900304
> 
> 赞同：0
> 
> 时间：2013-02-15T17:41:20.697
> 
> 标签：iphone, ios, ipad, ios6, mapkit

我想在使用 iOS 6.1 SDK 编译的应用程序中支持 iOS5。

一项功能是将用户带到地图应用程序。[这是一个链接](https://stackoverflow.com/questions/30058/how-can-i-launch-the-google-maps-iphone-application-from-within-my-own-native-ap/30079#30079)，解释了如何使用适用于 iOS 5 的 iOS SDK 5 以及适用于 iOS 6 的 iOS SDK 6 进行操作。

但是，如果我使用 iOS 6.1 SDK 并使用 iOS 5 设备，那么[神奇的 URL 链接](http://handleopenurl.com/scheme/map)会根据需要将我带到 Mobile Safari 中的 maps.google.com 网站，而不是本机 Maps 应用程序。

这可以解决吗？

**编辑**

到目前为止，我有这个：

```
BOOL appleMapsSupported = FALSE;
NSString *reqSysVer = @"6.0";
NSString *currSysVer = [[UIDevice currentDevice] systemVersion];
if ([currSysVer compare:reqSysVer options:NSNumericSearch] != NSOrderedAscending)
    appleMapsSupported = TRUE;
if (appleMapsSupported){
    NSLog(@"device version %@", [[UIDevice currentDevice] systemVersion]);
    MKPlacemark* placemark = [[MKPlacemark alloc] initWithCoordinate:coordinate addressDictionary:@{(NSString*)kABPersonAddressStreetKey:@"Your Place"}];
    MKMapItem* mapItem = [[MKMapItem alloc] initWithPlacemark:placemark];
    [mapItem openInMapsWithLaunchOptions:@{MKLaunchOptionsDirectionsModeKey : MKLaunchOptionsDirectionsModeWalking}];
}else{
    NSString* url = [NSString stringWithFormat:@"http://maps.google.com/?t=m&q=Your+Place%%40%g,%g", coordinate.latitude, coordinate.longitude];
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:44:07.127

Apple 已更新其对地图的 URL 处理，您需要指向`maps.apple.com`，这将适当地重定向到 Google。[有关更多/如何的信息，请参阅文档](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html#//apple_ref/doc/uid/TP40007894-SW1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:43:37.153

链接的答案看起来不错。您需要做的就是通过类似这样的方式检查用户正在运行的 iOS 版本[，](https://stackoverflow.com/questions/3339722/check-iphone-ios-version)并为 iOS 6 案例和 iOS 小于 6 案例执行适当的代码。

# scala - scala currying/partials 构建函数过滤器列表

> ID：14900305
> 
> 赞同：2
> 
> 时间：2013-02-15T17:41:25.473
> 
> 标签：scala, partials, currying

给定以下代码：

```
case class Config(
  addThree: Boolean = true,
  halve: Boolean = true,
  timesFive: Boolean = true
)

def doOps(num: Integer, config: Config): Integer = {
  var result: Integer = num
  if ( config.addThree ) {
    result += 3
  }
  if ( config.halve ) {
    result /= 2
  }
  if ( config.timesFive ) {
    result *= 5
  }
  result
}                                             

val config = Config(true,false,true)          

println( doOps(20, config) )
println( doOps(10, config) ) 
```

我想用更有效和惯用的构造替换丑陋的 doOps 方法。具体来说，我想构建一个函数链，仅根据所使用的特定配置执行所需的转换。我知道我可能想创建某种部分应用的函数，我可以将 Integer 传递到其中，但我对如何以有效的方式实现这一点持空白。

我特别想避免 doOps 中的 if 语句，我希望得到的结构只是一个函数链，它调用链中的下一个函数而不首先检查条件。

生成的代码，我想看起来像这样：

```
case class Config(
  addThree: Boolean = true,
  halve: Boolean = true,
  timesFive: Boolean = true
)

def buildDoOps(config: Config) = ???

val config = Config(true,false,true)
def doOps1 = buildDoOps(config)

println( doOps1(20) )
println( doOps1(10) ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:00:30.503

这是我的建议。基本上，我创建了一系列相互独立的函数。如果其中一项操作被禁用，我将其替换为`identity`. 最后我`foldLeft`在那个序列上，使用`num`参数作为初始值：

```
case class Config(
  addThree: Boolean = true,
  halve: Boolean = true,
  timesFive: Boolean = true
) {

  private val funChain = Seq[Int => Int](
    if(addThree) _ + 3 else identity _,
    if(halve) _ / 2 else identity _,
    if(timesFive) _ * 5 else identity _
  )

  def doOps(num: Int) = funChain.foldLeft(num){(acc, f) => f(acc)}

} 
```

我放在`doOps()`里面`Config`，因为它很适合那里。

```
Config(true, false, true).doOps(10)  //(10 + 3 ) * 5 = 65 
```

如果你是受虐狂，`foldLeft()`可以这样写：

```
def doOps(num: Int) = (num /: funChain){(acc, f) => f(acc)} 
```

如果您不喜欢`identity`，请使用`Option[Int => Int]`和`flatten`：

```
private val funChain = Seq[Option[Int => Int]](
    if(addThree) Some(_ + 3) else None,
    if(halve) Some(_ / 2) else None,
    if(timesFive) Some(_ * 5) else None
).flatten 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:17:18.067

类似于 Tomasz Nurkiewicz 的解决方案，但使用 Scalaz 的 monoid 进行自同态（具有相同输入和输出类型的函数）。

幺半群的追加操作是`compose`，标识元素是`identity`函数。

```
import scalaz._, Scalaz._

def endo(c: Config): Endo[Int] =
  c.timesFive ?? Endo[Int](_ * 5) |+|
  c.halve ?? Endo[Int](_ / 2) |+|
  c.addThree ?? Endo[Int](_ + 3)

def doOps(n: Int, c: Config) = endo(c)(n) 
```

当`??`左操作数为 时，运算符返回右操作数，当 时返回`true`幺半群的单位元素`false`。

请注意，函数的组合顺序与它们的应用顺序相反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:45:39.757

如果你想采用更具声明性（和可扩展性）的风格，你可以这样做：

```
import collection.mutable.Buffer

abstract class Config {
  protected def Op( func: Int => Int )( enabled: Boolean) {
    if ( enabled ) {
      _ops += func
    }   
  }
  private lazy val _ops = Buffer[Int => Int]()
  def ops: Seq[Int => Int] = _ops
}

def buildDoOps(config: Config): Int => Int = {
  val funcs = config.ops
  if ( funcs.isEmpty ) identity // Special case so that we don't compose with identity everytime
  else funcs.reverse.reduceLeft(_ andThen _)
} 
```

现在您可以像这样简单地定义您的配置：

```
case class MyConfig(
  addThree: Boolean = true,
  halve: Boolean = true,
  timesFive: Boolean = true
) extends Config {
  Op(_ + 3)(addThree)
  Op(_ / 3)(halve)
  Op(_ * 5)(timesFive)
} 
```

最后是 REPL 中的一些测试：

```
scala> val config = new MyConfig(true,false,true)
config: MyConfig = MyConfig(true,false,true)
scala> val doOps1 = buildDoOps(config)
doOps1: Int => Int = <function1>
scala> println( doOps1(20) )
115
scala> println( doOps1(10) )
65 
```

请注意，它需要一个抽象`buildDoOps`的实例。`Config`换句话说，它适用于`Config`（例如`MyConfig`上面的）的任何子类，并且在创建另一种类型的配置时不需要重写它。

此外，`buildDoOps`返回一个只执行请求操作的函数，这意味着我们不必在每次应用该函数时都对配置中的值进行不必要的测试（但仅在构造它时）。事实上，鉴于函数只依赖于配置的状态，我们可以（并且可能应该）简单地`lazy val`为它定义一个，直接进入`Config`（这是`result`下面的值）：

```
abstract class Config {
  protected def Op( func: Int => Int )( enabled: Boolean) {
    if ( enabled ) {
      _ops += func
    }   
  }
  private lazy val _ops = Buffer[Int => Int]()
  def ops: Seq[Int => Int] = _ops
  lazy val result: Int => Int = {
    if ( ops.isEmpty ) identity // Special case so that we don't compose with identity everytime
    else ops.reverse.reduceLeft(_ andThen _)
  }
} 
```

然后我们会这样做：

```
case class MyConfig(
  addThree: Boolean = true,
  halve: Boolean = true,
  timesFive: Boolean = true
) extends Config {
  Op(_ + 3)(addThree)
  Op(_ / 3)(halve)
  Op(_ * 5)(timesFive)
}

val config = new MyConfig(true,false,true)
println( config.result(20) )
println( config.result(10) ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:09:46.470

您可以向`Config`案例类添加更多功能，如下所示。正如您所提到的，这将允许您将函数调用链接在一起。

```
case class Config(
  doAddThree : Boolean = true,
  doHalve : Boolean = true,
  doTimesFive : Boolean = true
) {
  def addThree(num : Integer) : Integer = if(doAddThree) (num+3) else num
  def halve(num : Integer) : Integer = if(doHalve) (num/2) else num
  def timesFive(num : Integer) : Integer = if(doTimesFive) (num*5) else num
}

def doOps(num: Integer, config: Config): Integer = {
  var result: Integer = num
  result = config.addThree(result)
  result = config.halve(result)
  result = config.timesFive(result)
  result
}                                             

val config = Config(true,false,true)          

def doOps1(num : Integer) = doOps(num, config)

println( doOps1(20) )
println( doOps1(10) ) 
```

执行此“链接”的一种更简洁的方法是使用`foldLeft`部分应用的函数列表，类似于其他答案之一提到的内容：

```
def doOps(num: Integer, config: Config): Integer = {
  List(
    config.addThree(_),
    config.halve(_),
    config.timesFive(_)
  ).foldLeft(num) {
    case(x,f) => f(x)
  }
} 
```

# jquery-mobile - jquery mobile datebox遍历显示的日期

> ID：14900307
> 
> 赞同：0
> 
> 时间：2013-02-15T17:41:29.437
> 
> 标签：jquery-mobile, datebox

我在 http://dev.jtsage.com/jQM-DateBox2/demos/fullopt.html 使用 jquery mobile datebox 特别是我在[http://dev.jtsage.com/cdn/datebox/](http://dev.jtsage.com/jQM-DateBox2/demos/fullopt.html)使用 calbox[选项1.1.0/jqm-datebox-1.1.0.mode.calbox.js](http://dev.jtsage.com/cdn/datebox/1.1.0/jqm-datebox-1.1.0.mode.calbox.js)

如何遍历日历上显示的所有日期并以“YYYY-MM-DD”格式获取日期？很容易得到一天，因为它正在显示，所以你可以从 dom 中提取它 - 但他们也是一种获取年份和月份部分的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T13:23:44.197

你可以看看

```
$('element').datebox('getTheDate') 
```

但这会给您“其他”月份日期的错误月份/年份。您的预期目的是什么，也许有更好的方法来实现它？（或者，如果您有一个引人注目的用例，也许需要添加一些东西......）

# node.js - 如何在没有 grunt-cli 的情况下运行 grunt 0.4.*

> ID：14900310
> 
> 赞同：14
> 
> 时间：2013-02-15T17:41:40.577
> 
> 标签：node.js, gruntjs

我想知道是否可以在没有安装 grunt-cli 的情况下运行 grunt 0.4.*。

我知道 grunt-cli 会在我的项目目录中的 node-modules 中查找安装的 grunt 版本，以便运行该版本的 grunt 但是......是否可以在没有安装 grunt-cli 的情况下运行 grunt？如何？

提前致谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-21T09:21:36.827

grunt-cli 是非常少量的代码。如果我是你，我会在[GitHub 存储库](https://github.com/gruntjs/grunt-cli/blob/master/bin/grunt)中查看它。这样，您将了解它的作用，并且很容易做到这一点。

我很幸运在没有 grunt-cli 的情况下运行它。您可以使用以下命令执行此操作：

```
node -e "require('grunt').cli()" 
```

如果要指定任务，可以这样做：

```
node -e "var g = require('grunt'); g.cli.tasks = ['default']; g.cli()" 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-13T07:19:22.220

尝试

```
node -e "require('grunt').cli();" 
```

如果你在 mac/unix 上

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-29T16:44:42.007

您可以尝试使用其他脚本：

```
var grunt = require('grunt');
grunt.cli(); 
```

这将寻找 grunt 包并执行 Gruntfile.js。

# c++ - 这里有循环依赖吗？

> ID：14900311
> 
> 赞同：1
> 
> 时间：2013-02-15T17:41:50.670
> 
> 标签：c++, class, vector, g++

下面我复制了我的部分代码的简化版本，它在编译时会出错。

**测试.cpp**

```
#include <iostream>
#include "../Beta.h"
#include "../Alpha.h"

using namespace std;

int main() {
    cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
    return 0;
} 
```

**阿尔法.h**

```
#include <vector>

class Alpha
{
    public:

        typedef struct _info{
            int  k;
        } info;

        friend class Beta;
}; 
```

**Beta.h**

```
 #include <vector>

        class Alpha;

        class Beta
        {
            public:
            std::vector <Alpha::info*> vecInfo;
        }; 
```

当我运行时，`g++ testing.cpp`我收到以下错误消息

> 在 testing.cpp:10:0: ../Beta.h:8:15: 错误中包含的文件中：
> 
> 嵌套名称说明符中使用的不完整类型“Alpha”../Beta.h:8:15：
> 
> 错误：嵌套名称说明符中使用的类型“Alpha”不完整
> 
> ../Beta.h:8:27: 错误：模板参数 1 无效 ../Beta.h:8:27:
> 
> 错误：模板参数 2 无效

我可以从论坛线程中看到，第一个错误是由于某种循环依赖（[错误：嵌套名称说明符中使用的类型不完整](https://stackoverflow.com/questions/4572483/error-incomplete-type-used-in-nested-name-specifier-g)）。我看不到我的代码和他们的代码之间的相似性。我究竟做错了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T17:44:54.313

这并不是真正的循环依赖。 `Beta.h`只需要 to`#include "Alpha.h"`而不是前向声明`class Alpha;`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T17:45:11.310

您需要包含`Alpha.h`在 中`Beta.h`，因为需要完整的类定义才能访问`Alpha::info`. 这不会创建循环依赖，因为`Alpha.h`不包含`Beta.h`.

```
// don't forget the include guards!
#ifndef BETA_H_
#define BETA_H_

#include <vector>
#include "../Alpha.h"

class Beta
{
    public:
    std::vector <Alpha::info*> vecInfo;
};

#endif 
```

# php - PHP的日期如何显示

> ID：14900318
> 
> 赞同：0
> 
> 时间：2013-02-15T17:42:23.777
> 
> 标签：php, wordpress, date, custom-fields

如果填充了自定义字段，我有此代码显示我的自定义字段和旁边的图像

```
<?php
$value = get_post_meta( get_the_ID(), 'ecpt_eventstartdate', true);
if( !empty($value)) {
    echo '<img src="/wp-content/uploads/2013/02/date1.gif">';
    echo $value;
}
?> 
```

它来自 wordpress 中的 datepicker 字段，我无法为爱或金钱计算出如何让它正确显示日期，即使将 $value 替换为以下内容：

```
string $format [, int $timestamp = time() ] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:51:26.890

问题是当前输出是什么/$value 里面有什么？

如果它是一个 unix 时间戳（如 1360954102），那么 Guerra 是对的，你应该这样做：`echo date('Y-m-d',$value);`

如果当前格式是字符串并且日期没有按照您的意愿进行格式化，那么您首先需要将 $value 传输回时间字符串（例如使用 strtotime() 或 explode() + mktime() ），在您可以使用 date() 重新格式化之前。

如果这不能解决您的问题，请发布 $value 里面的内容以及它应该如何格式化。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:43:31.857

利用

```
new Date(date('Y-m-d')); 
```

这应该够了吧

# php - 用于打印为 json、array 和 xml 的数组

> ID：14900321
> 
> 赞同：0
> 
> 时间：2013-02-15T17:42:28.597
> 
> 标签：php, xml, json

我正在尝试以 json 格式获得正确的输出，但下面的输出有点混乱。它应该是这样的： `"{"table":"users","operation":"select","username":"inan"}"`

我该如何解决我的问题？

谢谢

**服务器.php**

```
print_r($_POST); 
```

**客户端.php**

```
$data = array('table'=>'users', 'operation'=>'select', 'uid'=>'yoyo');
curl_setopt($curl_handle, CURLOPT_POSTFIELDS, $data);
$output = curl_exec($curl_handle);

if ($this->request_response_type == 'array')
{
echo $output;
}
else if ($this->request_response_type == 'json')
{
echo json_encode($output);
}
else if ($this->request_response_type == 'xml')
{
    //xml conversion will be done here later. not ready yet.
} 
```

**输出：**

```
"Array\n(\n    [table] => users\n    [operation] => select\n    [uid] => yoyo\n)\n" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:09:09.827

**使用print_r**打印出来的数组无法解析回变量。

在你的 server.php 中做`echo json_encode($_POST);`. 然后在你的 client.php

```
<?php
//...
$output = curl_exec($curl_handle);

// and now you can output it however you like
if ($this->request_response_type == 'array')
{
    //though i don't see why you would want that as output is now useless if someone ought to be using the variable
    $outputVar = json_decode($output); // that parses the string into the variable
    print_r((array)$outputVar);
    // or even better use serialize()
    echo serialize($outputVar);
}
else if ($this->request_response_type == 'json')
{
    echo $output; //this outputs the original json
}
else if ($this->request_response_type == 'xml')
{
    // do your xml magic with $outputVar which is a variable and not a string
    //xml conversion will be done here later. not ready yet.
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-15T17:44:24.470

看看[JSON.stringify](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)

# c# - 从 C# 中的文本文件中删除带有时间戳的重复行

> ID：14900323
> 
> 赞同：0
> 
> 时间：2013-02-15T17:42:29.803
> 
> 标签：c#

我正在尝试开发一种可以将数据连续存储到日志文件中的软件工具。数据重复，我想删除所有重复的行并存储到日志文件中。我浏览了几个论坛并找到了解决方案，但这不是我要寻找的。这是我的情况：

FM 广播电台在广告时段播放标准消息，比如说“Soft Rock KWAV 96.9FM”一段时间，几分钟后他们播放一首带有标题或艺术家姓名等的歌曲。我可以将所有信息存储到我的日志中没有重复行的文件。我的问题是，当歌曲完成后，又有 10 分钟的广告插播，此时我当前的日志文件已经包含消息（“Soft Rock KWAV 96.9 FM”），所以它不允许第二个重复的消息进入文本文件。如果我运行我的软件并在一天结束时查看日志文件，将只有一个商业中断，这是不正确的。

任何建议/想法将不胜感激。

输入数据：

2013 年 2 月 15 日，09:12，软

2013 年 2 月 15 日，09:12，软

2013 年 2 月 15 日，09:12，软

2013 年 2 月 15 日，09:12，软

2013 年 2 月 15 日，09:12，软

2013 年 2 月 15 日，09:12，软

2013 年 2 月 15 日，09:12，摇滚

2013 年 2 月 15 日，09:12，摇滚

2013 年 2 月 15 日，09:12，摇滚

2013 年 2 月 15 日，09:12，摇滚

2013 年 2 月 15 日，09:12，摇滚

2013 年 2 月 15 日，09:12，摇滚

2013 年 2 月 15 日，09:12，KWAV

2013 年 2 月 15 日，09:12，KWAV

2013 年 2 月 15 日，09:12，KWAV

2013 年 2 月 15 日，09:12，KWAV

2013 年 2 月 15 日，09:12，KWAV

2013 年 2 月 15 日，09:12，KWAV

02/15/2013, 09:12, 96.9 FM

02/15/2013, 09:12, 96.9 FM

02/15/2013, 09:12, 96.9 FM

02/15/2013, 09:12, 96.9 FM

02/15/2013, 09:12, 96.9 FM

02/15/2013, 09:12, 96.9 FM

2013 年 2 月 15 日，09:13，软

2013 年 2 月 15 日，09:13，软

2013 年 2 月 15 日，09:13，软

2013 年 2 月 15 日，09:13，软

然后下一首歌曲/标题/艺术家姓名等等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:31:56.210

[http://msdn.microsoft.com/en-us/library/vstudio/ezwyzy7b.aspx](http://msdn.microsoft.com/en-us/library/vstudio/ezwyzy7b.aspx)

[http://msdn.microsoft.com/en-us/library/vstudio/8bh11f1k.aspx](http://msdn.microsoft.com/en-us/library/vstudio/8bh11f1k.aspx)

我会结合使用这两个帖子。

```
// load a StreamReader to the old path
using (StreamReader sr = new StreamReader(oldPath)) 
{
    // load a StreamWriter to the new path
    using (StreamWriter sw = new StreamWriter(newPath)) 
    {
        string lastLine = string.empty();
        while (sr.Peek() >= 0) 
        {
            var line = sr.ReadLine();

            // if the line's text is different from the previous, write it
            if (line != lastLine)
            {            
                sw.WriteLine(line);
                lastLine = line
            }
        }
    }
} 
```

这假设您只想过滤掉连续的行，并且您将定期运行它。免责声明：我实际上并没有运行此代码。

# c# - 获得不正确的纬度和经度以获取大距离

> ID：14900328
> 
> 赞同：0
> 
> 时间：2013-02-15T17:43:00.577
> 
> 标签：c#, geolocation, geographic-distance

我正在使用以下功能。

```
 private static Location CoordinateAtADistance(double latOrigin, double lonOrigin, double radius, double angle)
    {

        double lonDestination;
        double R = 6371.0;
        double d = radius / R;  // d = angular distance covered on earth's surface

        double lat1 = ToRadian(latOrigin);
        double lon1 = ToRadian(lonOrigin);
        double brng = ToRadian(angle);

        double latDestination = lat1 + d * Math.Cos(brng);
        double dLat = d * Math.Cos(brng);
        double dPhi = Math.Log(Math.Tan(latDestination / 2 + Math.PI / 4) / Math.Tan(lat1 / 2 + Math.PI / 4));
        double q = (double.IsNaN(dLat / dPhi)) ? dLat / dPhi : Math.Cos(lat1);  // E-W line gives dPhi=0
        double dLon = d * Math.Sin(brng) / q;
        // check for some daft bugger going past the pole
        if (Math.Abs(latDestination) > Math.PI / 2)
            latDestination = latDestination > 0 ? Math.PI - latDestination : -(Math.PI - latDestination);

        lonDestination = (lon1 + dLon +3* Math.PI) % (2 * Math.PI) - Math.PI;

        Location nextPoint = new Location();
        if (angle == 0)
        {
            nextPoint.Latitude = ToDegree(latDestination);
            nextPoint.Longitude = lonOrigin;
        }
        if (angle == 90)
        {
            nextPoint.Latitude = latOrigin;
            nextPoint.Longitude = ToDegree(lonDestination);
        }
        return nextPoint;
    } 
```

这里的半径是距离。

现在的问题是当我计算短距离时，例如几百公里，它工作得很好。但是对于大距离来说，比如 11,000 公里，它给出了正确的经度。请不要我只沿纬度或经度移动，因此其中一个在任何情况下都不会改变。在移动纬度时，我得到了正确的答案，但经度值并没有更接近。如果有任何不清楚的地方，请发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T14:54:13.483

```
 double latDestination = lat1 + d * Math.Cos(brng);
        double dLat = d * Math.Cos(brng);
        double dPhi = Math.Log(Math.Tan(latDestination / 2 + Math.PI / 4) / Math.Tan(lat1 / 2 + Math.PI / 4));
        double q = (double.IsNaN(dLat / dPhi)) ? dLat / dPhi : Math.Cos(lat1);  // E-W line gives dPhi=0
        double dLon = d * Math.Sin(brng) / q;
        // check for some daft bugger going past the pole
        if (Math.Abs(latDestination) > Math.PI / 2)
            latDestination = latDestination > 0 ? Math.PI - latDestination : -(Math.PI - latDestination);

        lonDestination = (lon1 + dLon + 3 * Math.PI) % (2 * Math.PI) - Math.PI; 
```

需要稍作修正，上面的公式可以正常工作。

# javascript - 无法让 jQuery 与速度对话

> ID：14900334
> 
> 赞同：0
> 
> 时间：2013-02-15T17:43:22.683
> 
> 标签：javascript, jquery, input, velocity

我有这个在速度文件中的输入

```
<input name="$name_GradePoints" id="$name_GradePoints" value="$!value_GradePoints" type="text" size="5" maxlength="11"/> 
```

我试图让它使用一个简单的 jQuery 更改事件。

```
<script type="text/javascript">

$('.target').change(function() {
  Something will happen.
});
</script> 
```

.target 最终将成为输入中的 id，我知道那部分。

该脚本最终将成为输入的验证器。

我只是对要为 jQuery 进行更改的内容感到困惑

$name_GradePoints**或**#$name_GradePoints**或**#{$name_GradePoints}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:26:15.383

使用`#$name_GradePoints`：

```
$('#${name_GradePoints}').change(function() {
    Something will happen.
}); 
```

或者如果你遇到 jQuery 和 Velocity 都想使用的问题`$`，你可以使用 jQuery 的全名：

```
jQuery('#${name_GradePoints}').change(function() {
    Something will happen.
}); 
```

# hibernate-mapping - 在hibernate中映射（整数）映射

> ID：14900337
> 
> 赞同：0
> 
> 时间：2013-02-15T17:43:29.660
> 
> 标签：hibernate-mapping

你将如何注释这个 bean 以在 hibernate 中映射？

```
@Entity
public class PerformanceValues implements Serializable{

    private static final long serialVersionUID = 1234850675335166109L;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    //key is mass, value is distance needed
    private Map<Integer, Integer>  massToDist;
} 
```

每个performanceValues实体都有一个唯一的map，每个map只能关联一个PerformanceValues（我猜这是oneToOne的关系）

谢谢

# assembly - “mov (%ebx,%eax,4),%eax”是如何工作的？

> ID：14900343
> 
> 赞同：3
> 
> 时间：2013-02-15T17:43:46.480
> 
> 标签：assembly, att, addressing-mode

一直在从事装配任务，并且在大多数情况下，我对装配非常了解。或者至少对于这项任务来说足够好。但是这个 mov 声明让我绊倒了。如果有人能解释一下这个 mov 语句是如何操纵寄存器值的，我将不胜感激。

mov (%ebx,%eax,4),%eax

PS 我无法通过基本搜索找到这种特定类型的 mov 语句，所以如果我错过了它并再次提出问题，我深表歉意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T17:48:12.063

AT&T 汇编中完整的内存寻址模式格式为：

```
offset(base, index, width) 
```

所以对于你的情况：

```
offset = 0
base = ebx
index = eax
width = 4 
```

这意味着该指令类似于：

```
eax = *(uint32_t *)((uint8_t *)ebx + eax * 4 + 0) 
```

在类似 C 的伪代码中。

# mysql - SELECT...INTO 在存储过程中返回 null

> ID：14900351
> 
> 赞同：2
> 
> 时间：2013-02-15T17:44:11.177
> 
> 标签：mysql, stored-functions

这个功能：

```
CREATE FUNCTION `GetCardID`(numId INT) RETURNS int(11)
    DETERMINISTIC
BEGIN
    DECLARE retcard INT(11);
    SELECT id
    INTO retcard
    FROM cards
    WHERE `number` = numId
        AND enabled = 1
    LIMIT 1;
    RETURN retcard;
END 
```

即使查询时也始终返回 null：

```
SELECT id FROM cards WHERE `number`=<Insert Value Here> AND ENABLED = 1 LIMIT 1; 
```

为使用的相同值和函数参数返回一个有效值。

例如：
SELECT id FROM cards WHERE number=12345 AND ENABLED = 1 LIMIT 1;
-- 返回一个 id，而
GetCardId(12345);
-- 返回空值

有什么想法我在这里想念的吗？我认为自己在 SQL 方面非常熟练，但在 SP 方面有点绿色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T22:39:22.190

克里斯托弗这是你的功能。试试这个，它应该工作：

```
CREATE FUNCTION [dbo].[GetCardID]
(  
    @Num_ID INT

)  
RETURNS int  
AS  
BEGIN  
    declare @retcard int    

    select Top 1 @retcard = id 
    FROM cards 
    where number = @num_Id
    AND enabled = 1

    return @retcard

END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T20:56:20.007

您在功能中使用的数据有多大？这个数字是否可能大于 INT 的大小？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:50:47.823

`Always returns NULL`：

去掉`DETERMINISTIC`过程定义中的子句。MySQL 缓存来自此类过程或函数的响应。

摘自 MySQL：

> 如果一个例程对于相同的输入参数总是产生相同的结果，则该例程被认为是“确定性的”，否则被认为是“非确定性的”。如果例程定义中既没有给出 DETERMINISTIC 也没有给出 NOT DETERMINISTIC，则默认为 NOT DETERMINISTIC。要声明函数是确定性的，您必须明确指定 DETERMINISTIC

[MySQL 5.5 - 创建过程或函数](http://dev.mysql.com/doc/refman/5.5/en//create-procedure.html)

# android - 从数据库填充的过滤器列表视图不显示非拉丁字符的结果

> ID：14900356
> 
> 赞同：0
> 
> 时间：2013-02-15T17:44:35.310
> 
> 标签：android, sqlite

我有一个显示数据库记录的列表视图和一个用于过滤显示项目的 textWatcher。问题是这适用于拉丁字符，但不适用于 unicode。Unicode 显示得很好。以下是相关代码：

```
etFilter.addTextChangedListener(new TextWatcher() {

       public void beforeTextChanged(CharSequence s, int start, 
         int count, int after) {
       }

       public void onTextChanged(CharSequence s, int start, 
         int before, int count) {
        dataAdapter.getFilter().filter(s.toString());
       }

    public void afterTextChanged(Editable arg0) {
        // TODO Auto-generated method stub

    }
      });

      dataAdapter.setFilterQueryProvider(new FilterQueryProvider() {
             public Cursor runQuery(CharSequence constraint) {
                 return provider.fechDobjectsByName(constraint.toString());
             }
         }); 
```

我在这里没有找到任何相关的问题。有人知道怎么做吗？编辑：对不起，这是我的错误。使用 Unicode 字符搜索会显示结果，但区分大小写。我现在才意识到这一点。那么，无论字母是否大写，如何搜索和显示结果呢？

```
public Cursor fechDobjectsByName(String inputText) throws SQLException {

      Cursor mCursor = null;
      if (inputText == null  ||  inputText.length () == 0)  {
       mCursor = database.query(DbHelper.TABLE_SONGS, 
         new String[] {DbHelper.COLUMN_ID,
         DbHelper.COLUMN_SONGNAME, DbHelper.COLUMN_SONGARTIST, 
         DbHelper.COLUMN_SONGGENRE}, 
         null, null, null, null, null);

      }
      else {
       mCursor = database.query(true, DbHelper.TABLE_SONGS, 
         new String[] {DbHelper.COLUMN_ID,
         DbHelper.COLUMN_SONGNAME, DbHelper.COLUMN_SONGARTIST, 
         DbHelper.COLUMN_SONGGENRE}, 
         DbHelper.COLUMN_SONGNAME + " like '%" + inputText + "%'", null,
         null, null, null, null);
      }
      if (mCursor != null) {
       mCursor.moveToFirst();
      }
      return mCursor; 
```

# java - 无法将错误员工强制转换为 java.lang.Comparable

> ID：14900357
> 
> 赞同：0
> 
> 时间：2013-02-15T17:44:37.377
> 
> 标签：java, mergesort

当我在我的测试器类中使用数组排序函数时，我遇到了一个错误。

```
import java.util.Arrays;
public class tester implements EmployeeInfo
{

public static void main(String[] args) throws CloneNotSupportedException
{
        Employee[]emps = new Employee[9];
        double sum=0,total=0;

        emps[0]= new Staff("Chan, Scott","123",'M',1959,2,23,35.00);
        emps[1]= new Staff("Salinas, Brian","456",'F',1964,7,12,30.00);
        emps[2]= new Staff("Weir, Allen","789",'M',1970,6,2,22.00);
        emps[3]= new Faculty("Im, Lee", "243", 'F',1962,4,27, "Full","Ph.d",
                "Engineering", 3);
        emps[4]= new Faculty("Bui, Trung","791" , 'F', 1975,3,14, 
                "Associate","Ph.d","English", 1);
        emps[5] = new Faculty("Monreno, Maria", "623", 'F', 1980,5,22, 
                "Assistant","MS","Physical Education", 0);
        emps[6]= new Partime("Lee, Chesong", "455", 'F', 
                1977,8,10,35,20);
        emps[7]= new Partime("Garcia, Frank", "678", 'F', 
                1987,9,15,30,25);
        emps[8] = new Partime("Alquilo, Roscoe", "945", 'M', 
                1988,9,15,20,30);
        /**
         * Display Staff, faculty, and Part-time
         */
        for(int i = 0; i<emps.length;i++)
        {
            if(emps[i] instanceof Staff)
            {
                System.out.println("\n"+emps[i]);
            }//end of if statement
            if(emps[i] instanceof Faculty)
            {
                System.out.println("\n"+emps[i]);
            }//end of if statement

        }// end of for loop

        //b
        System.out.println("\nTotal montly Salary for all employees");
        for(int i = 0; i<emps.length; i++)
        { 
            sum = emps[i].monthlyEarning()+sum;
        }
        System.out.println("$"+sum);
        //c
        System.out.println("\nTotal monthly salary for all faculuty");
        for(int i = 0; i<emps.length;i++)
        {
            if(emps[i] instanceof Faculty)
            {
                total = emps[i].monthlyEarning()+total;
            }
        }
        System.out.println("$"+total);

        //d Duplicate a faculty object. test the duplication
        Faculty f1 = (Faculty)emps[4];
        Faculty f2 = (Faculty)f1.clone();
        Education dupl = new Education("Bachelor",
                "Airforce",2);
        f2.setEducation(dupl);
        System.out.println("\nD Duplicate a Faculty Object"
                +"\n"+f2.toString());

        //E Verify two staff objects are the same

        System.out.println("\nE.Verify two staff objects ");
        Staff s1 = (Staff)emps[6];
        Staff s2 = (Staff)s1.clone();
        Staff s3 = new Staff("Victor Tran", "456", 'M', 
        1993, 5, 20,60);
        if(s1.getbirthday()==s2.getbirthday())
        {
            System.out.print("\nThe two staff objects " +
                    " birthdays"+ " are the same "
                    +"therefore "+true+"\n");
        }
        if(s3.getbirthday()==s1.getbirthday())
        {
            System.out.print(true);
        }

        //F Sort employees by ascending employee ID
        System.out.println("\nSort employees by ID");
        Arrays.sort(emps);
        for(int i=0;i<emps.length;i++)
        {
            System.out.println("\n"+emps[i]);
        } 
```

错误输出为

> 线程“主”java.lang.ClassCastException 中的异常：工作人员无法在 java.util.Arrays.mergeSort(Arrays.java:1144) 处的 java.util.Arrays.mergeSort(Arrays.java:第1155章

我的员工班级看起来像这样：

```
public class Staff extends Employee implements EmployeeInfo,Cloneable
{
    private double hourlyRate;

/**
 * Default Constructor
 */
public Staff()
{
    super();
    hourlyRate = 0.0;
}
/**
 * Argument Constructor
 * @param name
 * @param number
 * @param g
 * @param date
 * @param rate
 */
public Staff(String name, String number, char g, 
        int year, int month, int day,double rate)
{
    super(name,number,g,year,month,day);
    hourlyRate = rate; 
}
/**
 * Sets the hourly rate
 * @param rate
 */
public void setHourlyRate(double rate)
{
    hourlyRate = rate; 
}
/**
 * Get the hourly rate
 * @return hourlyRate
 */
public double getHourlyRate()
{
    return hourlyRate;
}
public double monthlyEarning()
{
    double salary = STAFF_MONTHLY_HOURS_WORKED* hourlyRate;
    return salary;
}

public String toString()
{
    return super.toString() +"\nFull Time"+"\nMonthly Salary: $"
                + monthlyEarning()+"\nHourly Rate: $"+hourlyRate;
}
public Object clone() throws CloneNotSupportedException
{
    Staff s = (Staff)super.clone();
    return s;
}
}// End of Staff Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:58:02.587

让您的对象（员工等）实现 Comparable 接口并使用 ID 进行比较。如果需要，检查 Comparable 接口的使用情况，这非常简单。没有 Arrays.sort 将不知道如何对对象进行排序

# c# - 在正确的语句上选择 return empty

> ID：14900358
> 
> 赞同：0
> 
> 时间：2013-02-15T17:44:41.860
> 
> 标签：c#, sqlite, select

我刚刚在 SQLite.NET 库中发现了一个错误。我有一个函数，它返回一个包含 Select 命令内容的字符串数组。代码如下：

```
string selectSQL = "SELECT id, token FROM Files WHERE (name LIKE 'Client.rar') AND (folder_id IN (SELECT id FROM Directories WHERE Path || name || '\' LIKE 'C:\Documents and Settings\Django\'))";
SQLiteCommand selectCommand = new SQLiteCommand(selectSQL, sqliteCon);
SQLiteDataReader dataReader = selectCommand.ExecuteReader();

bool results = dataReader.Read();
if (results == true)
{
    List<string> list = new List<string>();
    for (int i = 0; i < dataReader.FieldCount; i++)
    {
        string field = dataReader[i].ToString();
        list.Add(field);
    }
    string[] arr = list.ToArray();

    dataReader.Close();
    sqliteCon.Close();
    return arr;
}
else
{
    string[] arr = { "" };
    return arr;
} 
```

使用 SQLite 数据浏览器程序查看数据库。事实是，以前的软件中的查询有效，而在我的 C# 应用程序中返回一个空结果。

有谁知道那在哪里？似乎一切都是正确的

问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:17:11.753

我将继续并将其作为答案：

尝试将第一行更改为：

```
string selectSQL = @"SELECT id, token FROM Files WHERE (name LIKE 'Client.rar') AND (folder_id IN (SELECT id FROM Directories WHERE Path || name || '\' LIKE 'C:\Documents and Settings\Django\'))"; 
```

您在字符串中有几个反斜杠，如果您不转义它们，它们将导致问题。您可以选择将所有反斜杠替换为两个反斜杠（`\\`而不是`\`），并且不要将 @ 放在字符串前面。

# javascript - 页面创建phonegap jquery mobile

> ID：14900359
> 
> 赞同：1
> 
> 时间：2013-02-15T17:44:46.917
> 
> 标签：javascript, cordova, jquery-mobile

我试图在页面加载时执行脚本但它不起作用

首先，我加载我的第一页

```
$('#loadingPage').bind('pageinit', function(event) {...} 
```

这有效，我将我的页面重定向到 menu.html

```
<!DOCTYPE HTML>
<html>
    <head></head>
    <body>
        <div date-role="page" id="menuPage"></page>
    </body>
</html> 
```

在我的脚本文件中，我有

```
$('#menuPage').live('pageshow', function(event) {alert('bbb')};
$('#menuPage').live('click', function(event) {alert('aaa')}; 
```

我从来没有警报 bbb 但是当我点击我的屏幕时我有警报 aaa

完整的脚本代码：

[http://pastebin.com/Jh676yFZ](http://pastebin.com/Jh676yFZ)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:54:24.493

您的代码中有两个问题。Pagecreate 不应该用作页面加载触发器，最好使用 pagebeforechange 和 pageshow。这是第一个问题。第二个是 menu.html 页面格式错误，现在也已修复。

还有一件事，这不是一个错误，但我已经更改了 live( 与 on( 函数用于事件绑定。目前这不是问题，但 live 目前已被弃用，我认为它不会从 jQuery 1.9 开始工作

# c++ - 以字符串形式发送文本与引号之间的文本之间的区别

> ID：14900366
> 
> 赞同：0
> 
> 时间：2013-02-15T17:45:20.897
> 
> 标签：c++, string, qt, stream, filepath

我使用 mysql++ 库连接到我的数据库。我创建了一个连接和查询：

```
Connection conn(false);
conn.connect("database", "localhost", "user", "pass");
Query query = conn.query(); 
```

然后我可以向数据库发送查询，例如：

```
query << "select name from my_table1, my_table2 where age=20" 
```

但我想发送一个*数字*变量而不是 20。我试图这样做：

```
std::stringstream ss; //create a stringstream
ss << my_number //add number to the stream
std::string number = ss.str();
query << "select name from my_table1, my_table2 where age="+number; 
```

不幸的是，它不起作用。我的第二个问题是类似的。我创建了一个 QPixmap 对象（这里 QPixmap 无论如何都无关紧要）并且我必须给构造函数一个指向我的图像的路径：

```
std:string name;
(...)
std::string path = "/home/root/img/"+name+".png"; //name is a variable string
QPixmap *tmp = new QPixmap(QString::fromUtf8(path.c_str())); //conversion from string to QString 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:52:48.790

```
query << "select name from my_table1, my_table2 where age="+number; 
```

应该：

```
query << "select name from my_table1, my_table2 where age=" << number; 
```

因为`+`不是有效的 C++ 流连接运算符。

QPixmap 有什么问题？也许这应该是一个单独的问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:27:22.190

对于您的第二个问题，我建议您将其更改为：

```
std:string name;
(...)
std::string path = "/home/root/img/"+name+".png"; //name is a variable string 
```

对此：

```
const QString name;
...
const QString path = QString("/home/root/img/%1.png").arg(name);
....
QPixmap tmp(path); 
```

# php - 如何在属性值中添加php标签？

> ID：14900370
> 
> 赞同：1
> 
> 时间：2013-02-15T17:45:44.050
> 
> 标签：php, html, string, double-quotes

我正在尝试使用 php 动态编写元关键字，所以我有这样的代码，在 WAMP 服务器 localhost/myfile.php 中运行：

```
<meta name="keywords" content="keyword1, keyword2,
<?php
echo $my_array['index_of_keyword3']; 
?>
"> 
```

当然，这会导致：

```
 <meta name="keywords" content="keyword1, keyword2,<?php echo $my_array['index_of_keyword3']; ?> "> 
```

那么我该怎么做才能得到

```
 <meta name="keywords" content="keyword1, keyword2,keyword3 "> 
```

?

谢谢 ！

顺便说一句，我知道我可以这样做

```
<?php echo "<meta name=\"keywords\" content=\"keyword1, keyword2,$myVariable\">"; ?> 
```

但我想通过仅对变量使用 php 来简化我的代码。

编辑：天哪，我看到我是个白痴解决了这个问题:)

我已经写过`<?php$row=blabla..?>` 更改它以`<?php $row=blabla..?>`解决问题。感谢所有的答案。我会赞成他们所有人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:50:42.910

我假设您的页面扩展名是**.html**而不是**.php**

将 somepage.html 更改为 somepage.php，它应该开始工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:47:28.577

试试这个：

```
<meta name="keywords" content="<?php echo implode(",", $my_array);?>"> 
```

这样您就可以打印用逗号分隔的所有数组内容。还要确保您的文件扩展名是**.php**以解释您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T17:49:56.493

我认为您的问题是您不解析文件。你怎么称呼这个文件，因为 PHP 似乎没有解释它？

**编辑**：在您的 wamp 配置中尝试禁用`short open tag`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T17:58:06.957

您的文件没有`.php`扩展名，或者您尝试直接从文件系统打开它。要使 PHP 工作，您需要一个服务器，例如适用于 Windows 的[XAMPP](http://www.apachefriends.org/en/xampp.html)和适用于 Linux 的 LAMP 包。

当您运行服务器时，将`htdocs`在服务器目录中调用一个目录。将您的文件放在那里并`http://localhost/YourFilenameHere`在浏览器的地址栏中键入以访问您的文件。

# google-maps - 将 Google-Maps API 从 V2 升级到 V3

> ID：14900371
> 
> 赞同：1
> 
> 时间：2013-02-15T17:45:44.420
> 
> 标签：google-maps, google-maps-api-3, google-maps-api-2

我正在尝试将 Google Maps API V2 转换为 V3，但我无法让它工作，我已经尝试了 3 天，但它没有工作:-(

如果有人可以请告诉我如何正确执行此操作，我将***非常***感谢...

**V2 代码**

```
<script src="http://maps.google.com/maps?file=api&v=2&key=ABQIAAAA4vJ90IKcF0qHxC2Cg9NjchT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQ-rtrvY-Stu0L_q-OypfOv3WnUfg" 
type="text/javascript"></script>

<script type="text/javascript">

var geocoder, location1, location2, gDir, getCityName, getcITIESName, getDeliveryCityName, PickState, DeliveryState, SteState, SteStateB2, theAddress1, memeaddress1, memeaddress2;

function initialize() {

geocoder = new GClientGeocoder();
gDir = new GDirections();
GEvent.addListener(gDir, "load", function() {
var drivingDistanceMiles = (gDir.getDistance().meters / 1609.344).toFixed(0);//for 0 decial place
var drivingDistanceKilometers = gDir.getDistance().meters / 1000;
//theAddress1 = location1.address
getCityName = location1.address.split(",")
memeaddress1 = getCityName[0] + ',' + getCityName[1];

getcITIESName = location2.address.split(",");
memeaddress2 = getcITIESName[0] + ',' + getcITIESName[1].substr(0,3);
SteState = document.getElementById('selFromState').options[document.getElementById('selFromState').options.selectedIndex].value;
SteStateB2 = document.getElementById('selToState').options[document.getElementById('selToState').options.selectedIndex].value;
if (document.getElementById("inputString").value + ', ' + SteState == memeaddress1)
{
}
else
{
  doItagain=confirm('Cannot find the Pickup City!\n\nDid you mean: ' + location1.address + ' ?' + '\n\nPress OK to Change\nCancel to keep the City and State you entered!\n\n\n');
  if(doItagain){
getCityName[1] = (getCityName[1]).replace(/^\s*|\s*$/g,'');
var showonlythefirst2ltrspickup = getCityName[1].substr(0,2) 
document.getElementById("inputString").value = getCityName[0]
document.getElementById("selFromState").value = showonlythefirst2ltrspickup;
showLocation()
  }

  else

// Just end and exit function
window.alert('Please Note you must enter the miles manually!')
document.getElementById("txtMiles").value = "0";
//}
}
if (document.getElementById("inputString2").value + ', ' + SteStateB2 == memeaddress2)
{
document.getElementById("txtMiles").value = drivingDistanceMiles;
checkemptyB2();
}
else
{
  doIt=confirm('Cannot find the Delivery City!\n\nDid you mean: ' + location2.address + ' ?' + '\n\nPress OK to Change\nCancel to keep the City and State you entered!\n\n\n');
  if(doIt){
getcITIESName[1] = (getcITIESName[1]).replace(/^\s*|\s*$/g,'');
var showonlythefirst2ltrs = getcITIESName[1].substr(0,2) 
document.getElementById("inputString2").value = getcITIESName[0]
document.getElementById("selToState").value = showonlythefirst2ltrs;

showLocation()
  }

  else

// Just end and exit function
window.alert('Please Note you must enter the miles manually!')
document.getElementById("txtMiles").value = "0";
}
});
}

function showLocation() {
checkemptyB2();
//geocoder = new GClientGeocoder();
//gDir = new GDirections();
//alert("here is the pickup address:" + document.getElementById("inputString2").value + ',' + document.getElementById("selToState").value)
geocoder.getLocations(document.getElementById("inputString").value + ',' + document.getElementById("selFromState").value, function (response) {
if (!response || response.Status.code != 200)
{
alert("Sorry, we were unable to geocode the pickup address");
}
else
{
location1 = {lat: response.Placemark[0].Point.coordinates[1], lon: response.Placemark[0].Point.coordinates[0], address: response.Placemark[0].address};
geocoder.getLocations(document.getElementById("inputString2").value + ',' + document.getElementById("selToState").value, function (response) {
if (!response || response.Status.code != 200)
{
alert("Sorry, we were unable to geocode the delivery address");
}
else
{
location2 = {lat: response.Placemark[0].Point.coordinates[1], lon: response.Placemark[0].Point.coordinates[0], address: 

response.Placemark[0].address};
gDir.load('from: ' + location1.address + ' to: ' + location2.address);
}
});
}
});
}
</script>
<script type="text/javascript">

function changedelivery() {
  doIt=confirm('do you wish to proceed?');
  if(doIt){
document.getElementById("inputString2").value = getcITIESName[0]
document.getElementById("selToState").value = SteStateB2
  }
  else{
// Just end and exit function
  }
}
</script> 
```

这是我尝试过的代码：

```
<script type="text/javascript">

var geocoder,location1,location2,gDir,getCityName,getcITIESName,getDeliveryCityName,PickState,DeliveryState,SteState,SteStateB2,theAddress1,memeaddress1,memeaddress2;

function initialize() {

geocoder = new google.maps.Geocoder();
gDir = new google.maps.DirectionsService();
google.maps.Event.addListener(gDir, "load", function() {
var drivingDistanceMiles = (gDir.getDistance().meters / 1609.344).toFixed(0);//for 0 decial place
var drivingDistanceKilometers = gDir.getDistance().meters / 1000;

getCityName = location1.address.split(",")
memeaddress1 = getCityName[0] + ',' + getCityName[1];

getcITIESName = location2.address.split(",");
memeaddress2 = getcITIESName[0] + ',' + getcITIESName[1].substr(0,3);

SteState = document.getElementById('selFromState').options[document.getElementById('selFromState').options.selectedIndex].value;
SteStateB2 = document.getElementById('selToState').options[document.getElementById('selToState').options.selectedIndex].value;

if (document.getElementById("inputString").value + ', ' + SteState == memeaddress1)
{
}
else
{
  doItagain=confirm('Cannot find the Pickup City!\n\nDid you mean: ' + location1.address + ' ?' + '\n\nPress OK to Change\nCancel to keep the City and State you entered!\n\n\n');

if(doItagain){
getCityName[1] = (getCityName[1]).replace(/^\s*|\s*$/g,'');
var showonlythefirst2ltrspickup = getCityName[1].substr(0,2) 
document.getElementById("inputString").value = getCityName[0]
document.getElementById("selFromState").value = showonlythefirst2ltrspickup;
showLocation()
  }

else

// Just end and exit function
window.alert('Please Note you must enter the miles manually!')
document.getElementById("txtMiles").value = "0";
//}
}

if (document.getElementById("inputString2").value + ', ' + SteStateB2 == memeaddress2)
{
document.getElementById("txtMiles").value = drivingDistanceMiles;
checkemptyB2();
}

else

{
  doIt=confirm('Cannot find the Delivery City!\n\nDid you mean: ' + location2.address + ' ?' + '\n\nPress OK to Change\nCancel to keep the City and State you entered!\n\n\n');

if(doIt){
getcITIESName[1] = (getcITIESName[1]).replace(/^\s*|\s*$/g,'');
var showonlythefirst2ltrs = getcITIESName[1].substr(0,2) 
document.getElementById("inputString2").value = getcITIESName[0]
document.getElementById("selToState").value = showonlythefirst2ltrs;

showLocation()
  }

else

// Just end and exit function
window.alert('Please Note you must enter the miles manually!')
document.getElementById("txtMiles").value = "0";
}
});
}

function showLocation() {
checkemptyB2();
geocoder.geocode(document.getElementById("inputString").value + ',' + document.getElementById("selFromState").value, function (response) {

if (!response || response.Status.code != 200)
{
alert("Sorry, we were unable to geocode the pickup address");
}

else

{
location1 = {lat: response.Placemark[0].Point.coordinates[1], lon: response.Placemark[0].Point.coordinates[0], address: response.Placemark[0].address};
geocoder.geocode(document.getElementById("inputString2").value + ',' + document.getElementById("selToState").value, function (response) {
if (!response || response.Status.code != 200)
{
alert("Sorry, we were unable to geocode the delivery address");
}

else

{
location2 = {lat: response.Placemark[0].Point.coordinates[1], lon: response.Placemark[0].Point.coordinates[0], address: 

response.Placemark[0].address};
gDir.load('from: ' + location1.address + ' to: ' + location2.address);
}
});
}
});
}
</script>
<script type="text/javascript">

function changedelivery() {
  doIt=confirm('do you wish to proceed?');

if(doIt){
document.getElementById("inputString2").value = getcITIESName[0]
document.getElementById("selToState").value = SteStateB2
}

else

{
// Just end and exit function
}
}
</script> 
```

再次感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T23:17:24.223

任何以“G”开头的都是 v2 类。您需要更换：

*   GClientGeocoder(); -> [google.maps.Geocoder](https://developers.google.com/maps/documentation/javascript/geocoding)
*   GDirections(); -> [google.maps.DirectionsService & google.maps.DirectionsRenderer](https://developers.google.com/maps/documentation/javascript/directions)

与他们的 v3 等价物。它们是不同的，有关详细信息，请参阅文档。

# html - Phonegap 替代方案

> ID：14900372
> 
> 赞同：0
> 
> 时间：2013-02-15T17:45:54.803
> 
> 标签：html, cordova, mobile, html5-audio

是否有支持更改媒体（尤其是音频）播放速率的 phonegap 替代方案？

看起来他们没有这样的属性： http: [//docs.phonegap.com/en/1.0.0/phonegap_media_media.md.html](http://docs.phonegap.com/en/1.0.0/phonegap_media_media.md.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T12:37:43.493

HTML5 中的`audio`and`video`元素支持根据规范更改播放速率。不幸的是，这并不适用于所有玩家。我已经设法让它在除 Android 之外的任何地方都能工作，并且我希望很快就会提供广泛的浏览器支持，因为 android 开发团队正在努力。

如果您深入了解细节，请注意设置播放速率仅在您收到属性已设置为非零数字的`timeupdate`事件后在所有平台上有效，除非在 iOS 上它仅在为零时有效（因此它可以跨平台工作，您必须设置两次）。`currentTime``currentTime`

# google-maps - 谷歌地图 - 使用类而不是 ID 创建地图？

> ID：14900373
> 
> 赞同：4
> 
> 时间：2013-02-15T17:45:56.847
> 
> 标签：google-maps

我有一个谷歌地图，我有 3 个标签。理想情况下，我希望在所有三个选项卡中使用相同的地图，但您似乎只能使用 ID 创建地图：

```
map = new google.maps.Map(document.getElementById('map_canvas'),
    mapOptions); 
```

如果是这种情况，我必须用 3 个单独的 ID 制作 3 个单独的地图吗？您可以仅使用“类”制作 3 个 Google 地图并重新调整同一张地图的用途吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T02:38:21.917

您可以使用 jQuery 的对象来创建新地图

`var mapClass = $('.map_canvas'); and var map = new google.maps.Map(mapClass[0],mapOptions);`

请查看我的 jsfiddle 并告诉我[http://jsfiddle.net/davidchase03/fDFMz/](http://jsfiddle.net/davidchase03/fDFMz/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:09:36.420

您可以使用下面的 nebula_gdCN() 函数来获取由类名标识的元素数组。然后，您可以为每个选项卡创建一个新地图，并将每个地图对象存储在一个单独的变量中。

```
<div class="my_tabs" style="width: 550px; height: 450px"></div>
<div class="my_tabs" style="width: 550px; height: 450px"></div>
<div class="my_tabs" style="width: 550px; height: 450px"></div>

<script>
var tabs = nebula_gdCN('my_tabs') ;
map1 = new google.maps.Map(tabs[0], mapOptions);
map2 = new google.maps.Map(tabs[1], mapOptions);
map3 = new google.maps.Map(tabs[2], mapOptions);

//Include these two functions
nebula_gdCN = function(q){
    var classArr = Array();
    for(var i=0;i<document.getElementsByTagName('*').length;i++){
        if( nebula_gdC(i).className == q){
            classArr.push(nebula_gdC(i)) ;
        }
    }
    return classArr ;
}
nebula_gdC = function(i,b){
    var b = b || '*' ;
    return document.getElementsByTagName(b)[i] ;
}
</script> 
```

# php - 为什么我不需要在关联数组中使用 array_push？

> ID：14900379
> 
> 赞同：0
> 
> 时间：2013-02-15T17:46:21.147
> 
> 标签：php, arrays

我正在使用此代码，但如果我使用`array_push()`它是用 插入值`null`，我正在使用`array_push`在数组中输入值

```
foreach ($_POST['record_num'] as $check_rec_num) {
    if(!in_array($check_rec_num, $_SESSION['selected_record'][$pageno])) {
        array_push($_SESSION['selected_record'][$pageno][], $check_rec_num);
    }
} 
```

但是当我使用它时，它会自动在数组中添加值，而不使用`array_push`为什么会这样？

```
foreach ($_POST['rec_num'] as $check_rec_num) {
    if(!in_array($check_rec_num, $_SESSION['selected_record'][$pageno])) {
        $_SESSION['selected_record'][$pageno][] = $check_rec_num;
    }
} 
```

第一个例子

```
Array ( [1] => Array ( [0] => 36 [1] => 35 ) [2] => ) 
```

第二个例子（没有小括号）

```
Array ( [1] => Array ( [0] => 36 [1] => 35 [2] => 34 ) [2] => Array ( [0] => ) ) 
```

Array Design 3rd example没有使用`array_push`它是如何在数组末尾自动添加值而不使用`array_push`？

```
Array ( 
   [1] => Array ( 
          [0] => 36 
          [1] => 35 
      ) 
   [2] => Array ( 
          [0] => 33 
          [1] => 32
      )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:47:34.127

你有一个额外`[]`的

```
array_push($_SESSION['selected_record'][$pageno][], $check_rec_num); 
```

这将做到：

```
$_SESSION['selected_record'][$pageno] = array();
array_push($_SESSION['selected_record'][$pageno], $check_rec_num); 
```

参见手册[`array_push`](http://php.net/manual/en/function.array-push.php)。

> 注意：如果第一个参数不是数组，array_push() 将引发警告。这与创建新数组的 $var[] 行为不同。

然而，你应该更好地使用，`$_SESSION['selected_record'][$pageno][]`因为

> 注意：如果您使用 array_push() 向数组添加一个元素，最好使用 $array[] = 因为这样就没有调用函数的开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:48:20.240

那是因为额外的`[]` Remove it 并且它会起作用：

```
array_push($_SESSION['selected_record'][$pageno], $check_rec_num); 
```

# javascript - IE7将元素和值添加到javascript数组

> ID：14900384
> 
> 赞同：0
> 
> 时间：2013-02-15T17:46:54.813
> 
> 标签：javascript, arrays, internet-explorer-7

我这样声明一个数组

```
var positions = []; 
```

或者

```
var positions = new array(); 
```

无论哪种方式都有效

稍后在脚本中添加一个值

```
positions[0].top = 0; 
```

除 ie7 外，其他浏览器都正常出现此错误

```
Error: Unable to set value of the property 'top': object is null or undefined 
```

还有另一种方法可以让我在 ie7 中填充 arra 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:47:42.220

你想要 javascript 函数 push()。你应该全面这样做。

```
 var positions = ["something", "somethign else"];
  positions.push("something new"); 
```

`.top`是我相信的大多数 dom 元素的属性，但不适合这个数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:51:15.843

您正在尝试添加对象值而不是推送到数组。如果您尝试使用数组，则需要使用 .push()：

```
var positions = [];
    positions.push(value);
    positions.push(value2); 
```

因此，在上面的代码中，`value`将在`positions[0]`并且`value2`将在`positions[1]`.

但是，如果您尝试创建一个可以访问的对象，如下所示：

```
position.top;
position.bottom;
etc. 
```

然后你需要创建一个对象：

```
var positions = {};
    positions.top = 0;
    positions.bottom = 20; 
```

# javascript - 在javascript中嵌入ruby，ruby无法识别

> ID：14900387
> 
> 赞同：0
> 
> 时间：2013-02-15T17:47:02.210
> 
> 标签：javascript, ruby-on-rails

我有一个 ruby​​ 函数创建一个哈希的实例变量，我无法在 javascript 中访问它的值。

这是我的控制器：

```
class TransferController < ApplicationController
    def index
        require 'json'
        #@transfers = Transfer.select("transfer_id,section_id,sum(net) as net").group("transfer_id,section_id").having("sum(net) <> ?",0).order("transfer_id ASC")
        @transfers = Transfer.select("section_id,section_name,sum(net) as net").group("section_id,section_name").order("section_id ASC")

        h = Hash.new()
        a = []

        @transfers.each do |section| 
            h["name"] = section.section_name
            h["size"] = section.net
            a.insert(h)
        end

        @sectionhash = Hash.new()
        @sectionhash["name"] = "stringush"
        @sectionhash["children"] = a

    end
end 
```

这是我的观点：

```
<h1><%= @sectionhash["name"] %></h1>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript">
var x = <%= @sectionhash["name"] %>;
alert(x);
</script> 
```

我得到的结果是，它向我展示了哈希内部的值，但 javascript 什么也不做。我什至尝试在分配 ruby​​ 代码之前发出警报，它起作用了。所以它在嵌入红宝石的路线上失败了。我在这个论坛上看到人们回答说我写的嵌入行是合法的。任何想法为什么这不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T17:53:36.267

您仍然需要遵守正常的 Javascript 语法规则。 `var x = <%= @sectionhash["name"] %>;`将打印：`var x = stringush;`由于没有名为 stringush 的变量，这是无效的。您需要像这样引用 JS 字符串：

`var x = '<%= @sectionhash["name"] %>';`

这将打印：`var x = 'stringush';`这是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T17:53:27.233

我认为您正在寻找的是`x`string `"stringush"`。为此，将您的 javascript 更改为：

```
<script type="text/javascript">
    var x = '<%= @sectionhash["name"] %>';
    alert(x);
</script> 
```

您需要在其中引用，否则 javascript 将被引用，`var x = stringush;`并且由于没有名为 的变量`stringush`，x 将是未定义的。

# c# - 将控件添加到自定义基本页面

> ID：14900392
> 
> 赞同：1
> 
> 时间：2013-02-15T17:47:29.053
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone-8, windows-phone

我正在尝试为我的 WP 应用程序创建一个自定义基页。我通过创建一个`cs`继承自这样的新类文件来做到`PhoneApplicationPage`这一点：

```
public class BasePage: PhoneApplicationPage
{
   //handle common non-visual stuff here
} 
```

问题是我想在每个使用的页面上添加一个控件，`BasePage`但 BasePage 没有`LayoutRoot`或任何我可以将控件附加到的可视元素。有没有办法可以将相同的控件添加到所有使用 BasePage 的页面，这样我就不必每次都复制/粘贴它？

**编辑**：根据 TriggerPin 的回答添加 XAML。我为我创建了一个新的 XAML 文件，`BasePage.cs`但这会引发错误`BasePage.g.cs`：“MyApp.MainPage 已经包含 '_contentLoaded' 的定义”（以及 'LayoutRoot' 和 'InitializeComponent' 的类似消息）

```
<local:BasePage
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:MyApp.Template"
    x:Class="MyApp.MainPage"
    mc:Ignorable="d"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:45:29.113

请注意，默认情况下，派生自 PhoneApplicationPage 的类型是部分的

```
 public partial class MainPage : PhoneApplicationPage 
```

部分定义允许您将类定义拆分到多个文件中。最常见的是这种类型，定义在 .cs 和 .xaml 文件之间进行拆分。

```
 <phone:PhoneApplicationPage x:Class="MyProject.MainPage"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone">

     <!-- Custom layout here -->

 </phone:PhoneApplicationPage> 
```

如果您使您的实现成为部分类并提供基本的 xaml 代码，您将能够做您想要实现的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-06T10:17:45.090

您需要一个至少必须是 Panel 类型的容器才能添加您的子控件。Page 只是一个用户控件，不能直接将您的 UIElement 添加到其中。

尝试这个：

```
Panel container = // init it from your page, you must have a root element in page.
container.Children.Add(new TextBlock()); // your children control. 
```

我是在win8里做的。

# css - 使用 CSS 将嵌套的 Div 移动到底角

> ID：14900393
> 
> 赞同：0
> 
> 时间：2013-02-15T17:47:30.090
> 
> 标签：css

我在这里搜索并找到了一个解决方案，但似乎没有回答我在寻找什么

（[使用 CSS 垂直对齐嵌套的 DIV](https://stackoverflow.com/questions/14081835/vertically-align-nested-divs-using-css)）

我的问题是，当您有 2 个 div，其中一个嵌套在另一个 div 中时，默认情况下，内部 div 将位于左上角，我如何将其放在右下角？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:51:01.080

添加到父级`position: relative;`

和嵌套的 div

```
position: absolute;
right:0px
bottom 0px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:51:27.077

```
.outerDiv{
    position:relative;
}

.innerDiv{
    position:absolute;
    bottom:0;
    right:0;
} 
```

# c++ - C++ 内存泄漏

> ID：14900398
> 
> 赞同：0
> 
> 时间：2013-02-15T17:47:41.023
> 
> 标签：c++, memory, free, memory-leaks

嗨，我有以下代码，它将节点从 slaveQueue 和 preload 带到 preload1 和 preload2，但内存总是在增加。我认为它应该在我调用 dfs 后释放，因为在本地函数返回后应该释放所有内存，并且我检查了 pop() 函数是否也会释放内存？所以我想知道我的内存泄漏在哪里？谢谢

```
 queue<Graphnode> *preload1 = new queue<Graphnode>;
    queue<Graphnode> *preload2 = new queue<Graphnode>;
    for(int n = windowWidth; n > 0; n--)
    {
        if((*slaveQueue).empty())
        {
            //cout <<"fffffffffffff"<<endl;
            break;
        }
        (*preload2).push((*slaveQueue).front());
        //cout << (*slaveQueue).size()<<endl;
        (*slaveQueue).pop();
    }
    int preload1No =0;

    while(!(*preload2).empty())
    {
        preload1No++;
        *slaveroot = (*preload2).front();
        (*preload2).pop();
        if(!(*slaveQueue).empty())
        {
            (*preload2).push((*slaveQueue).front());
            (*slaveQueue).pop();
        }
        dfs(*slaveroot,goal,totalDepth,*preload1,*preload2,checkfile);
        if(preload1No>windowWidth)
        {
            (*preload1).push(*slaveroot);
            (*preload1).pop();
        }
        else
        {
            (*preload1).push(*slaveroot);
        }
        cout<<(*preload1).size()<<"\t"<<(*preload2).size()<<endl;
    }
    delete slaveroot;
    delete preload1;
    delete preload2;
    delete slaveQueue; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:49:53.910

是的，它会复制指针`a`，但不会复制指向的内存`a`。所以这里没有内存泄漏，因此没有什么可以释放的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:50:38.013

如果您没有在 中显式分配任何内存`func1`，并且没有调用执行此操作的函数，则没有内存泄漏。您复制到函数中的只是一个指针。复制的指针本身位于函数的堆栈上，一旦函数返回，就会与函数范围内的所有其他内容一起弹出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T17:49:20.570

`a`in`func1`是按值传递，这意味着它在堆栈上。因此它不会造成*任何*内存泄漏。`func`退出时释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T17:55:18.687

当你传递`a`给你的函数时，它本身的副本`a`就是被传递的。当函数退出时，该副本`a`被销毁。指向的内存`a`根本不会复制到您的代码中。

您的代码泄漏了一个字节的内存¹因为您`func1`在无限循环中调用，所以`delete a;`永远不会执行。然而，当大多数人谈论/考虑内存泄漏时，他们想到的是“渐进式”泄漏——程序运行时间越长，泄漏的内存越多。

* * *

1.  如果您想获得技术知识，它泄漏的是内存管理器中的一个最小大小的块。这通常会大于 1 个字节，但究竟大多少将取决于实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T17:49:24.920

如图所示，您的代码没有内存泄漏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T17:49:44.543

`a`它确实在堆栈上创建了一个副本。但是，一旦函数返回，该内存就会恢复。

如果您有内存泄漏，这可能是由此处未显示的代码引起的。

# objective-c - 连接和存储音乐符号 - Objective-C

> ID：14900401
> 
> 赞同：3
> 
> 时间：2013-02-15T17:47:46.327
> 
> 标签：objective-c, unicode

我将这些 un​​icode 定义用于尖锐和扁平的符号，它们在字符串连接中工作正常：

```
#define kSharpSymbol [NSString stringWithFormat:@"\U0000266F"]
#define kFlatSymbol [NSString stringWithFormat:@"\U0000266D"]

[...]
// Set F#
[f setNoteLetterName:[NSString stringWithFormat:@"F%@",kSharpSymbol]]; 
```

然后，我刚刚阅读了一个[SO question](https://stackoverflow.com/questions/5690172/xcode-utf-8-literals)，Apple 不推荐依赖 unicode 格式，所以我去了这个，它也可以工作，但是当我执行隐式字符串 concat 时会导致编译器警告：

**格式指定类型“无符号短”，但参数的类型为“int”**

```
#define kSharpSymbol [NSString stringWithFormat:@"%C", 0x266F]
#define kFlatSymbol [NSString stringWithFormat:@"%C", 0x266D]
[...]
// Set F#
[f setNoteLetterName:[NSString stringWithFormat:@"F%@",kSharpSymbol]]; 
```

我想我需要澄清一下。什么是最好的，如何让编译器满意？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:53:08.633

我建议用另一种方法来解决这个问题：例如，直接使用包含 Unicode 符号的字符串常量绝对没有错

```
#define kSharpSymbol @"♯"
#define kFlatSymbol  @"♭" 
```

The advantage is that the human readers of your program are going to see the symbol without looking it up in a table. The disadvantage is that the program is not going to look correctly when viewed in some older text editors that do not support modern file encoding. Fortunately, Xcode's editor is not one of them, so it shouldn't be a concern.

# javascript - 正则表达式检测连续重复的数字

> ID：14900403
> 
> 赞同：0
> 
> 时间：2013-02-15T17:47:57.843
> 
> 标签：javascript, regex

我无法实现并找到一个正则表达式来检测重复数字（超过 2 次）的序列，例如：

```
1111 or
a1111 or
test4555 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T17:51:09.883

你可以写：

```
/(\d)\1\1/ 
```

where`\d`表示“一个数字”，`(...)`表示“捕获（记住）`...`匹配的内容”，并`\1`表示“第一个`(...)`捕获的内容”。

# python - 使用 Python 正则表达式在子字符串中查找字符

> ID：14900414
> 
> 赞同：0
> 
> 时间：2013-02-15T17:48:51.117
> 
> 标签：python, regex

我有以下列表：

```
l = ['(PREDIR )?NAME SUFTYP|PREDIR NAME( SUFTYP)?', '(PREDIR )?NAME|PREDIR NAME', '(PREDIR )?PRETYP NAME SUFTYP( SUFDIR)?|PREDIR (PRETYP )?NAME( SUFTYP)? SUFDIR', '(PREDIR )?PRETYP NAME|PREDIR (PRETYP )?NAME', 'NAME SUFTYP( SUFDIR)?|NAME( SUFTYP)? SUFDIR', 'NAME SUFTYP|NAME( SUFTYP)?', 'NAME|NAME', 'PRETYP NAME ( SUFDIR)?|(PRETYP )?NAME SUFDIR'] 
```

我想查找`?`仅包含在一侧的项目`|`，并仅替换为包含的一侧`?`。

具体来说，我希望我希望将其中的项目`l`替换为以下内容：

`'(PREDIR )?NAME|PREDIR NAME'`->`'(PREDIR )?NAME'`

`'(PREDIR )?PRETYP NAME|PREDIR (PRETYP )?NAME'`->`'(PREDIR )?PRETYP NAME|PREDIR (PRETYP )?NAME'`

`'NAME SUFTYP|NAME( SUFTYP)?'`->`'NAME( SUFTYP)?'`

我能想到的唯一方法是通过一个迭代过程，我`?`首先检查左侧而不是右侧，然后反之亦然。

以下不起作用。

```
for i in l:
    i = re.sub(r'(.*?\?.*?)(\|.*?[^?].*?)',r'\1',i) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:00:54.773

试试这个：

```
l = ['(PREDIR )?NAME SUFTYP|PREDIR NAME( SUFTYP)?', '(PREDIR )?NAME|PREDIR NAME', 
     '(PREDIR )?PRETYP NAME SUFTYP( SUFDIR)?|PREDIR (PRETYP )?NAME( SUFTYP)? SUFDIR', 
     '(PREDIR )?PRETYP NAME|PREDIR (PRETYP )?NAME', 
     'NAME SUFTYP( SUFDIR)?|NAME( SUFTYP)? SUFDIR', 'NAME SUFTYP|NAME( SUFTYP)?', 
     'NAME|NAME', 'PRETYP NAME ( SUFDIR)?|(PRETYP )?NAME SUFDIR']

import re

l2 = []
for elem in l:
    inner = re.split("\|", elem);

    left = '?' in inner[0]
    right = '?' in inner[1]

    if (left and right) or not (left or right): 
        # Either both side of `|` have `?` or none of the sides have `?`
        l2.append(elem)
    elif left:
        l2.append(inner[0])
    else:
        l2.append(inner[1])

print l2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T18:05:32.873

因此，如果我理解您，您想将字符串拆分为`|`，并且如果其中恰好有一部分包含 a `?`，则返回该字符串，否则返回字符串？我不确定正则表达式是否值得头疼：为什么不呢

```
def fix(s):
    has_qmark = [part for part in s.split("|") if '?' in part]
    return has_qmark[0] if len(has_qmark) == 1 else s 
```

反而？它实际上是英文的。

```
>>> fix('(PREDIR )?NAME|PREDIR NAME')
'(PREDIR )?NAME'
>>> fix('(PREDIR )?PRETYP NAME|PREDIR (PRETYP )?NAME')
'(PREDIR )?PRETYP NAME|PREDIR (PRETYP )?NAME'
>>> fix('NAME SUFTYP|NAME( SUFTYP)?')
'NAME( SUFTYP)?' 
```

# jquery - $.each() 仅获取其父项未隐藏的项目

> ID：14900417
> 
> 赞同：1
> 
> 时间：2013-02-15T17:49:06.217
> 
> 标签：jquery

我有一个循环遍历 div 中的项目的每个循环。

```
$(":radio[id^=lt]:checked,:hidden[id^=lt]", "#entry_"+item_id).each(function() {
    // Get values here
}); 
```

我将如何修改循环代码以仅获取父 tr 未隐藏的那些（参见下面的 CT）？输入可以是单选或隐藏类型。

```
<div class="entry" style="" id="entry_1117178">
    <table width="100%">
        <tbody>
            <tr>
                <td align="right"><label class="lbl_ln" for="lname_1117178" id="null_1117178">Name on License:&nbsp;</label></td>
                <td align="left"><input type="text" name="lname" class="lname" id="lname_1117178"></td>
            </tr>
            <tr>
                <td align="right"><label class="lbl_lic" for="ln_1117178" id="lbl_1117178">License:&nbsp;</label></td>
                <td align="left"><input type="text" class="ln" name="ln" id="ln_1117178"></td>
            </tr>
            <tr class="InfoCol" id="InfoCol_AL" style="display: none;">
                <td class="TypeCol" id="InfoType_220574">
                    <input type="hidden" class="lt_" id="lt_1117178_220574" name="lt_1117178_220574" value="220574">
                    <label id="lbl_lt_220574" class="lt_" for="lt_1117178"></label>
                </td>
            </tr>
            <tr class="InfoCol" id="InfoCol_CT" style="display: table-row;">
                <td class="TypeCol" id="InfoType_181258">
                    <input type="hidden" class="lt_" id="lt_1117178_181258" name="lt_1117178_181258" value="181258">
                    <label id="lbl_lt_181258" class="lt_" for="lt_1117178"></label>
                </td>
            </tr>
            <tr class="InfoCol" id="InfoCol_DC" style="display: none;">
                <td class="TypeCol" id="InfoType_183820">
                    <input type="radio" class="lt_" id="lt_1117178_183820" name="lt_1117178_183820" value="183820">
                    <label id="lbl_lt_183820" class="lt_" for="lt_1117178_183820">Item 1</label>
                </td>
                <td class="TypeCol" id="InfoType_183821">
                    <input type="radio" class="lt_" id="lt_1117178_183821" name="lt_1117178_183821" value="183821">
                    <label id="lbl_lt_183821" class="lt_" for="lt_1117178_183821">Item 2</label>
                </td>
            </tr>
        </tbody>
    </table>
</div> 
```

在上面的代码的情况下，我只想获取 ID=lt_1117178_181258 的输入的值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:50:01.167

```
$(":radio[id^=lt]:checked,:hidden[id^=lt]", "#ce_entry_"+item_id).each(function() {
    if ( $(this).closest('tr').is(':visible') ) {
        // Get values here
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:53:57.270

这似乎更清洁：

```
$("input", ".InfoCol:visible").each(function() {
  //whatever
}); 
```

它可能有点过于简化，但根据您展示的 html，我认为它可能会工作......

# javascript - JavaScript 检查是否定义了属性

> ID：14900420
> 
> 赞同：6
> 
> 时间：2013-02-15T17:49:18.547
> 
> 标签：javascript

检查是否定义了像 obj.prop.otherprop.another 这样的对象属性的推荐方法是什么？

```
if(obj && obj.prop && obj.prop.otherprop && obj.prop.otherprop.another) 
```

这很好用，但足够丑陋。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:13:13.567

最有效的方法是在 try{} catch(exception){} 块中检查 obj.prop.otherprop.another。如果剩下的都存在，那将是最快的；否则将处理异常。

```
var a = null;
try {
  a = obj.prop.otherprop.another;
} catch(e) {
  obj = obj || {};
  obj.prop = obj.prop || {};
  obj.prop.otherprop = obj.prop.otherprop || {};
  obj.prop.otherprop.another = {};
  a = obj.prop.otherprop.another ;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:51:12.630

不是说这更好，但是...

```
x = null
try {
  x = obj.prop.otherprop.another;
} catch() {}
// ... 
```

或者...

```
function resolve(obj, path) {
  path = path.split('.');
  while (path.length && obj) obj = obj[path.shift()];
  return obj;
}

x = resolve(obj, 'prop.otherprop.another'); 
```

...但我想实际的答案是没有最佳实践。不是我知道的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:01:27.227

如果你心情很傻，这会起作用：

```
if ((((obj || {}).prop || {}).anotherprop || {}).another) { ... } 
```

但我不知道初始化三个新对象是否真的值得不必重复输入路径。

# mysql - mysql WHERE IN，但有多个测试值

> ID：14900422
> 
> 赞同：1
> 
> 时间：2013-02-15T17:49:23.750
> 
> 标签：mysql, sql

我已经在这个网站和网络上环顾四周，但到目前为止还没有任何运气。

问题：

我有一个存储文件信息的表，其中包含一个以逗号分隔的数值列表，标识哪些组可以访问每个文件。

每个用户的活动组都存储在一个会话中，因此我需要将会话中以逗号分隔的数字列表与存储在表格列中的逗号分隔列表进行比较。如果会话中的任何组与列中的任何组匹配，则该文件是可访问的。

例如 ：

资源 1 的 rgroups 字段由“1,13,15”填充，表明这 3 个组可以查看资源。

在列出资源的页面上，我有以下查询，其中 $matches 来自活动组的会话：

```
SELECT * FROM resources WHERE rgroups IN ($matches) 
```

现在这似乎在 1 个组处于活动状态时工作正常 - 即 WHERE 1 IN (1,13,15) - 但是当多个组处于活动状态时呢？

```
SELECT * FROM resources WHERE 1,14 IN (1,13,15) 
```

还是我需要一个不同的、更复杂的查询？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:57:09.137

In 子句只是一个嵌套的 OR 条件。Where rgroups in ('1','13','15) 与说 Where (rgroups = '1' OR rgroups ='13' OR....) 相同

只需在某种通用函数中构造您的 SQL 语句并将其应用于数据库。

享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:59:15.933

您需要更复杂的查询。另外，我认为您的第一个版本不起作用。工作版本应该使用`like`：

```
where concat(',', $matches, ',') like concat('%,', rgroups, ',%') 
```

您可以将想法扩展到多个组：

```
where concat(',', $matches, ',') like concat('%,', rgroup1, ',%') and
      concat(',', $matches, ',') like concat('%,', rgroup2, ',%') and
      concat(',', $matches, ',') like concat('%,', rgroup3, ',%') 
```

where`rgroup<n>`是组的一个元素。

如果您知道 rgroup 中有多少个元素，您可以执行以下操作：

```
where find_in_set($matches, substring_index(rgroups, 1)) > 0 and
      find_in_set($matches, substring_index(rgroups, 2)) > 0 and
      find_in_set($matches, substring_index(rgroups, 3)) > 0 
```

如果您知道最大值，可以尝试：

```
where (substring_index(rgroups, 1) = 0 or  find_in_set($matches, substring_index(rgroups, 1))) and
      (substring_index(rgroups, 2) = 0 or  find_in_set($matches, substring_index(rgroups, 2))) and
      (substring_index(rgroups, 3) = 0 or  find_in_set($matches, substring_index(rgroups, 3))) and
      . . . 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T03:25:08.213

我根据 Gordon Linoff 所说的以及我在网上其他地方看到的内容找到了一个解决方案。

答案的本质是：

```
$matcharr = explode(",", $matches);

$mysqlwhere = "";
foreach($matcharr as $item){
$mysqlwhere .= "$item IN (rgroups) OR ";
}
$mysqlwhere = substr($mysqlwhere,0,-3);
$only4group = "AND (" . $mysqlwhere . ")"; 
```

我使用 $matches 中的活动组会话并将其拆分，创建以下查询：

```
SELECT * FROM resources WHERE rarea = 'shared' AND (1 IN (rgroups) OR 13 IN (rgroups) ) ORDER BY rarea, rname 
```

感谢你的帮助！

# bash - bash if 语句中的 -n 和 -a 选项有什么作用？

> ID：14900426
> 
> 赞同：73
> 
> 时间：2013-02-15T17:49:32.760
> 
> 标签：bash

`-a`和`-n`选项在以下 bash`if`语句中执行什么功能？

```
if [ -n "$1" -a -n "$2" -a -n "$3" ]; then
    REFNAME=$(basename $3)
else 
```

是`-a`和`-n`所谓的*[初选](http://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html)*吗？

是否`-a file`意味着“如果文件存在则为真。”？

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2013-02-15T17:56:13.370

`-a`在“and”或“&&”表达式中将两个表达式链接在一起。此选项已[弃用](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/test.html)。

`-n`检查字符串的长度是否非零。

您可以将测试表达式转换为以下伪代码：

```
if ( ($1 has nonzero length) and
     ($2 has nonzero length) and
     ($3 has nonzero length) ) 
```

该表达式中不检查文件是否存在，只检查参数是否已提供给脚本。

参数`-a`和`-n`可以在手册页中找到`test`

```
man test 
```

运算符`[ ... ]`通常用作系统的简写，`test ...`并且可能在您的系统上具有相同的功能。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-02-15T18:23:43.330

### 吹毛求疵

开关`-a`并`-n`严格来说不是`bash` `if`语句的一部分，因为该`if`命令不处理这些开关。

### 什么是初选？

我称它们为“开关”，但`bash`您链接到的文档与“初级”指的是相同的东西（可能是因为这是讨论布尔表达式的一部分时使用的常用术语）。

### 背景和文档

In `sh` scripts `if` is a command that takes a command as its argument, executes it and tests its return code. If the return code is `0` the block of code following `then` is executed up until the closing `fi` or (if supplied) the following `else`. If the return code was not `0` and an `else` statement was supplied then the block of code following `else` is executed up until the closing `fi`.

You can see this effect by passing `if` the command `true` or the command `false`, which are simple commands that do nothing and return `0` and non-`0` respectively.

```
if true ; then echo true was true ; else echo true was false ; fi
if false ; then echo false was true ; else echo false was false ; fi 
```

In the sample code you provided the command that you're passing to `if` is `[`, which is also sometimes known as `test`. It is this command which takes the switches you're asking about. In `bash` the `test` command will be a built-in command; try `type [` to learn its type. For built-in commands `help` will show usage, so also run `help [` to see documentation. Your system probably also has a `/bin/[` and a `/bin/test` and if you `man test` you can see the manuals for those. Although the behavior of the built-in `test` may not be identical to the behavior documented in the man pages, which is likely more verbose than the simple description you'll get from `help [`, it will probably describe the behavior of the built-in `[` command fairly accurately.

### The behavior of -a and -n

Knowing that the command you're running is `test` we can consult `help test` or `man test` and read its usage. This will show that`-n` tests the following argument and evaluates to true if it is not an empty string.

In the documentation of `test` you will also see a the switch `-e`. This switch tests the following argument and evaluates to true if that argument is a file or directory that exists. More useful still is the `-f` switch which evaluates to true if the following argument exists and is a regular file (as opposed to a directory or a block device, or whatever).

The source of your confusion is probably that there can be **two** forms of `-a`: Unary and binary. When `-a` is used in a unary context, that is with *one following argument* but *no preceding arguments*, it treats its argument as a file and tests for its existence, just like the `-e` switch. However, when `-a` is used in a binary context, that is with *one argument before it and one argument after it*, it treats its arguments as other conditions and acts as a boolean AND operator.

In the interests of portability it is important to note that unary `-a` is a non-standard extension which [won't be found](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/test.html) in POSIX. It is available in `bash` and `ksh`, however, so usage is probably widespread.

### Example

```
cd /tmp
if [ -a test-file ] ; then
    echo 1: test-file exists
else
    echo 1: test-file missing
fi

touch test-file

if [ -a test-file ] ; then
    echo 2: test-file exists
else
    echo 2: test-file missing
fi

var=somerthing
if [ -n "$var" -a -a test-file ] ; then
    echo variable var is not empty and test-file exists
fi
rm -f test-file 
```

# c++ - 初始化我自己的类类型的向量

> ID：14900427
> 
> 赞同：1
> 
> 时间：2013-02-15T17:49:32.270
> 
> 标签：c++, vector, c++11

我正在尝试声明我自己的类类型（**SY::Symbol**）的静态向量，如下所示：

**符号表.h**

```
namespace SYT
{
    class SymbolsTable
    {
        public:
            static std::vector<SY::Symbol> m_symbols;
                    void addToken(TK::Token);
    };
} 
```

我想在 SymbolsTable.cpp 文件的方法 addToken 中使用*它*。

**符号表.cpp**

```
#include "../../includes/px/SymbolsTable.h"
#include "../../includes/px/Token.h"

#include <vector>
#include <string>
#include <iostream>
#include <algorithm>
#include <iterator>

std::vector<SY::Symbol> SYT::SymbolsTable::m_symbols(std::initializer_list<SY::Symbol>);

SYT::SymbolsTable::SymbolsTable()
{

}

void SYT::SymbolsTable::addToken(TK::Token token)
{
    int index = getSymbolIndex(token); 

    if(index == -1)
    {
        SY::Symbol symb(token, "");
        SYT::SymbolsTable::m_symbols.push_back(symb);
        token.setIndex(indexOf(m_symbols, symb)); 
    }
    else
    {
        token.setIndex(index);
    }       
} 
```

我尝试在 SymbolsTable.cpp 的类之外声明和初始化它*，*但我得到了错误。

> 错误：没有在类“SYT::SymbolsTable”中声明的“std::vector SYT::SymbolsTable::m_symbols(std::initializer_list)”成员函数

如您所见，我必须对其进行初始化，因此我正在尝试使用 this `initializer_list`，但我不知道这样做是否正确。

所以，我知道我必须在一切之前初始化向量。

**我的问题是：**

*   在哪里初始化它；
*   如何初始化它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:52:38.160

```
std::initializer_list<SY::Symbol> 
```

这是一种类型，因此编译器将其读取为未在指定范围内声明的函数定义，因此出现错误。

你可以写

```
std::vector<SY::Symbol> SYT::SymbolsTable::m_symbols; 
```

只是定义它，或者

```
std::vector<SY::Symbol> SYT::SymbolsTable::m_symbols{1,2,3,4}; 
```

`SY::Symbol`初始化它 - 注意用有效对象替换 1-4 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:51:58.113

你可以写

```
std::vector<SY::Symbol> SYT::SymbolsTable::m_symbols; 
```

在 cpp 文件中。

这使用默认构造函数，将向量初始化为空向量。

但是，很可能您并不真的想要一个静态*成员*，因为让非静态成员函数更新静态数据成员感觉非常错误。相反，您可能想要该类的静态*实例*。甚至这可能是一个次优设计，但仍然可能是一种改进。

# google-maps - Google Maps API v3 - 信息窗口内的 ContextMenu

> ID：14900431
> 
> 赞同：1
> 
> 时间：2013-02-15T17:49:34.607
> 
> 标签：google-maps, contextmenu

我正在使用 ContextMenu.js 为右键单击地图时的一些选项创建上下文菜单。插件在这里：http: [//googlemapsmania.blogspot.com/2012/04/create-google-maps-context-menu.html](http://googlemapsmania.blogspot.com/2012/04/create-google-maps-context-menu.html)

这是我的代码的一部分：

```
/* Right click marker for location specific context menu */
            google.maps.event.addListener(contextMenu, 'menu_item_selected', function(latLng, eventName){
                switch(eventName){
                    case 'directions_from_click':
                        //Populate start field with the marker location
                        showDirections();
                        geocoder.geocode({latLng: latLng}, function(results, status) {
                          if (status == google.maps.GeocoderStatus.OK) {
                            if (results[0]) {
                              fAddress = results[0].formatted_address;
                              $('#start').val(fAddress);

                            }
                          }
                        });
                        $('#panelWrapper').focus();
                        break;
                    case 'directions_to_click':
                        //Populate start field with the marker location
                        showDirections();
                        geocoder.geocode({latLng: latLng}, function(results, status) {
                              if (status == google.maps.GeocoderStatus.OK) {
                                if (results[0]) {
                                  fAddress = results[0].formatted_address;
                                  $('#end').val(fAddress);
                                }
                              }
                            });
                            $('#panelWrapper').focus();
                        break;
                }
            }); 
```

但这仅适用于右键单击地图。我想采用相同的上下文菜单并将其用于我的信息窗口内的链接。例如，显示“方向”的链接（见图），然后单击时会出现上下文菜单。我该怎么做呢？我

![在此处输入图像描述](../Images/1cfdc6954d05a1e3ecab1cc97d18ec5d.png)

# java - 在 Android 应用程序中编辑/添加 IPTC 元数据

> ID：14900445
> 
> 赞同：4
> 
> 时间：2013-02-15T17:50:14.990
> 
> 标签：java, android, image-processing, exif, iptc

我看过许多其他类似的问题，但似乎都没有一个准确的答案。

我正在开发一个适用于大量图像的 Android 应用程序。我希望通过编辑 IPTC 关键字标签（或其他适当标签）的值来向图像添加信息。我正在使用[Metadata Extractor](http://drewnoakes.com/code/exif/)读取元数据，但这个库不支持写入元数据。

我看过[Apache Sanselan](http://commons.apache.org/imaging/)，它似乎不合适，因为它严重依赖`java.awt`（在 Android 中不可用）。我知道[Imagero](http://reader.imagero.com/)，但我还没有使用它，希望能找到更好的开源库。

有没有人遇到过这样的图书馆？我更喜欢它是开源的，但即使是商业建议也会受到赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-06T15:43:46.077

[https://github.com/k3b/pixymeta-android/](https://github.com/k3b/pixymeta-android/)是实现的[https://github.com/dragon66/pixymeta-android/](https://github.com/dragon66/pixymeta-android/)的一个分支

*   android 和 jave2se/awt 的单一来源

然而，实现一个简单易用的 api 仍有很多工作要做

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-03T09:22:04.543

使用[http://sourceforge.net/projects/iim4j/](http://sourceforge.net/projects/iim4j/)不会开箱即用，但可以适应。我这样做是为了添加版权声明和联系人字段。没有尝试其他领域，因为我不需要它们。所以这将是你的赌注。

抱歉，无法分享代码。

# excel - Microsoft Excel：日期的条件格式（在特定范围内）

> ID：14900446
> 
> 赞同：1
> 
> 时间：2013-02-15T17:50:18.697
> 
> 标签：excel, date, range, conditional-formatting

尝试在 excel 中进行条件格式化，这对我的数据来说似乎有点棘手。

我有 654 个日期。654 行/条目。

我需要使用三种颜色：

绿色 - 将今天日期后 10 个月内的单元格设为绿色

黄色 - 使今天日期后 10 到 12 个月内的单元格变为黄色

红色 - 使距离今天日期超过 12 个月的单元格变为红色，或者单元格中没有任何数据

我知道这是不正确的，但我觉得我在正确的轨道上：

`red=($G$428:$G$655<=TODAY() + 365)` *我将如何在此公式中容纳空白单元格？*

`yellow=($G$3:$G$427<=TODAY() + 300 to 365)` *您如何正确指定“10 到 12 个月之间”？*

```
green=($G$3:$G$427<=TODAY() + 300) 
```

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:04:41.633

我的测试范围是 B3:B35（在应用规则之前选择）

```
=ABS(B3-TODAY())<=300 ' <10 months

=OR(B3="",ABS(B3-TODAY())>365)  'more than 1 year or empty

=ABS((B3-TODAY())>300) ' >10 months (rule above takes care of >12 mo) 
```

# android - 将 Spannable 存储到字符串

> ID：14900449
> 
> 赞同：0
> 
> 时间：2013-02-15T17:50:25.657
> 
> 标签：android, imageview, emoticons

我正在编写一个聊天应用程序，并解析情感图标，我使用来自这里的代码[Displaying emoticons in Android](https://stackoverflow.com/questions/3341702/displaying-emoticons-in-android?rq=1)

我的聊天文本像“SENDER|TIME|NON_PARSED_CHAT_TEXT”一样存储在 ArrayList 中

问题是我在一个字符串中包含所有聊天消息（时间和发件人以及聊天文本），我将其拆分并在 ListView 中连续显示，每次我获取此聊天文本并重新解析它情感图标，是否有任何可能的方法将 Spannable 对象（解析后的聊天文本由提供的问题中的函数产生）存储到带有时间和发送者的 ArrayList 中的字符串？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:52:33.800

> 是否有任何可能的方法将 Spannable 对象（解析后的聊天文本由提供的问题中的函数产生）存储到 ArrayList 中的字符串以及时间和发送者？

欢迎你[`toHtml()`在`Html`class](http://developer.android.com/reference/android/text/Html.html#toHtml%28android.text.Spanned%29)上使用，虽然它只能处理一些 HTML 输出，而不是任意的东西。

你也可以有一个`ArrayList`that 持有`Spannable`而不是`String`转换 that `Spannable`。

# signal-processing - 应用 FFT 后的对称部分适用于哪些频率？

> ID：14900459
> 
> 赞同：2
> 
> 时间：2013-02-15T17:50:57.430
> 
> 标签：signal-processing, fft

我有一个 4096 个样本长的 44.1 kHz 音频剪辑。对其应用 FFT 后，我得到 4096 个频段。

然后每个频段将跨越 10.77 Hz (44100 / 4096)。

我被告知第二半频率与前半部分共轭对称。

考虑到这是我上面的计算正确还是我错过了一些重要的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T18:07:04.153

这非常正确 - 对于最常见的具有纯实输入（即所有虚部为零）的复数到复数 FFT，前 N/2 个输出箱（在您的情况下为 0..2047）通常是您将成为的唯一箱感兴趣。第一个 bin 是 DC (0 Hz)，bin N/2 对应于 Nyquist (Fs/2 = 22.05 kHz)，通常不感兴趣。N/2 以上的 bin 只是底部 N/2-1 bin 的复共轭“镜像”。

有关更多详细信息，请参阅[此答案](https://stackoverflow.com/questions/4364823/how-to-get-frequency-from-fft-result/4371627#4371627)。

# html - 将 SVG 代码内联到 HTML5 文档中时要包含的内容

> ID：14900466
> 
> 赞同：0
> 
> 时间：2013-02-15T17:51:13.533
> 
> 标签：html, svg, html5-canvas

我正在尝试将我编码/绘制的 SVG 插入 HTML5 文档，我想知道文档中的 SVG 代码需要做什么。

在阅读了一些教程后，我了解到最好将其放置在具有设定尺寸的容器中。然后给它的孩子，svg 标签，正确版本的语法属性，baseProfile 属性，xmlns 属性，以及 100% 的高度和宽度。

然后，将 svg 代码、定义、路径等作为 SVG 元素的子元素。

我是否遗漏了什么或者我不需要什么？

另外，我应该在标签之前添加以下内容还是仅在独立的 svg 文档中需要：

```
 <?xml version="1.0" encoding="utf-8"?>
    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:59:27.830

html5 中不需要 xmlns。正如您所怀疑的，DOCTYPE 和 xml 版本适用于独立文件。

# jquery - 使用 jQuery 从数组中的项目中剥离 HTML 代码

> ID：14900469
> 
> 赞同：1
> 
> 时间：2013-02-15T17:51:19.520
> 
> 标签：jquery, regex

我有一个 Javascript 数组，其中包含字符串值项。但是，其中一些项目在`HTML`标签之间包含文本。下面是我的数组的一个例子。

`var myArr = ["Weather", "very", "<span style="font-weight:bold;">nice</span>"]`

我怎样才能`<span></span>`从数组中剥离标签，只留下单词`nice`？

我已经研究过使用 jquery 的 .match() 来检测数组是否包含 HTML，但是在 JSFiddle 中测试它时没有成功。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T17:53:40.177

# 更新

防止 XSS 攻击的更新版本，使用[`$.parseHTML`](http://api.jquery.com/jQuery.parseHTML/).

```
myArr = $.map(myArr, function(str, i){
  return $("<div/>").append($.parseHTML(str)).text();
}); 
```

* * *

**以前的更新**

可能您可以尝试以下方法：

```
myArr = $.map(myArr, function(str, i){
  return $("<div/>").html(str).text();
}); 
```

[看这里。](http://jsfiddle.net/GTyZe/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:54:43.303

```
var newArr = [];
var myArr = ["Weather", "very", "<span style=\"font-weight:bold;\">nice</span>"]
$.each(myArr, function(index, value) {
  newArr.push($('<div/>').html(value).text());
}); 
```

[工作小提琴](http://jsfiddle.net/YS9TP/)。

# php - Ruby PHP MD5 不兼容 - 这怎么可能？

> ID：14900487
> 
> 赞同：2
> 
> 时间：2013-02-15T17:52:32.707
> 
> 标签：php, ruby, md5

这怎么可能？我无法让 Ruby 给我与 PHP 相同的 MD5，也无法解决这个问题……我认为是编码，但似乎我已经设法让每个文件都保持相同的格式。

**PHP 代码：（**结果：bfa7df865d9f4aff62c4643d0e1cb33b）

```
echo md5("9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@#@akskd9"); 
```

**带有 Digest-MD5 的 Ruby 代码：（**结果：bd53907a1b47e9a381ee663ec75b59f4）

```
require 'digest/md5'
puts Digest::MD5.hexdigest("9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@#@akskd9") 
```

**带有 HMAC-MD5 的 Ruby 代码：（**结果：d41d8cd98f00b204e9800998ecf8427e）

```
require 'hmac-md5'
puts HMAC::MD5.new("9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@#@akskd9").hexdigest 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T17:55:03.503

使用单引号而不是双引号

```
Digest::MD5.hexdigest('9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@#@akskd9') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:25:13.323

正是“#@”的组合使它想要将字符串末尾的“@akskd9”视为变量。

例如：

```
@akskd9 = "foobar"
puts "9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@#@akskd9"

=> 9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@foobar 
```

..没有 # ，那么它会忽略 @ 符号：

```
@akskd9 = "foobar"
puts "9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@@akskd9"

=> 9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@@akskd9 
```

...有趣的是，如果没有 # 之后的 {...}，它将字符串的其余部分视为变量。

```
@ak = "foobar"
puts "9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@#@akskd9"

=> 9jdaksjdfosdjsljz91m1wms0zkzd0k0askd1m2l3!@3@ 
```

# ruby - 如何干净地验证用户输入是否是Ruby中的整数？

> ID：14900490
> 
> 赞同：13
> 
> 时间：2013-02-15T17:52:35.003
> 
> 标签：ruby, validation, integer

我有一段代码要求用户输入一个数字作为我的问题的答案。我可以做到`to_i`，但棘手/垃圾输入会通过`to_i`. 例如，如果用户输入`693iirum5`作为答案，那么 #to_i 会将其剥离为`693`.

请建议一个函数，而不是正则表达式。提前感谢您的回复。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-15T17:56:20.133

这将验证输入：

```
Integer(gets) rescue nil 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-03T10:18:31.207

为了回答[camdixon 的](https://stackoverflow.com/questions/14900490/how-to-cleanly-verify-if-the-user-input-is-an-integer-in-ruby/14900559#comment32265574_14900559)问题，我提交了这个提议的解决方案。

使用接受的答案，而不是`rescue nil`使用`rescue false`和包装你的代码在一个简单的 if 中。

### 例子

```
print "Integer please: " 
user_num=Integer(gets) rescue false 
if user_num 
    # code 
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T18:00:11.770

用于在没有正则表达式的情况下`input_string.to_i.to_s == input_string`验证 是否为整数。`input_string`

```
> input_string = "11a12"
> input_string.to_i.to_s == input_string
=> false
> input_string = "11"
> input_string.to_i.to_s == input_string
=> true
> input_string = "11.5"
> input_string.to_i.to_s == input_string
=> false 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T18:20:43.137

## 使用内核#Integer

如果传递了无效值，则会引发[Kernel#Integer](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-Integer)方法。`ArgumentError: invalid value for Integer()`方法描述部分说：

> [S] 字符串应严格符合数字表示。此行为与 String#to_i 的行为不同。

换句话说，虽然[String#to_i](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-to_i)将*强制*将值转换为整数，但 Kernel#Integer 将确保该值在转换之前已经是格式正确的。

## 模拟行为的示例`Integer(gets)`

```
Integer(1)
# => 1

Integer('2')
# => 2

Integer("1foo2\n")
# => ArgumentError: invalid value for Integer(): "1foo2\n" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T18:01:01.520

to_i 很好，但一切都取决于你在垃圾输入的情况下想要什么。无？如果你想要 693iirum5 返回其他东西，你可以解析输入的字符串，你需要一个正则表达式来检查字符串。既然您要求不要提供正则表达式，我不会，也许您可​​以明确您真正希望它返回的内容。

# javascript - 带有手动选项的 Angular JS 选择

> ID：14900497
> 
> 赞同：7
> 
> 时间：2013-02-15T17:52:52.897
> 
> 标签：javascript, angularjs

我们的应用程序中有一些**不能**使用**ng-options的下拉菜单，因为我们需要在 <options> 标签本身上设置 title 属性，而这对于****ng-options**是不可能的。

*我们需要标题的原因是因为 IE < 9 会去掉过长的值，并且它们仅在标题中可见（在元素悬停时显示）*

现在，要查看我遇到的问题，请查看以下 JS fiddle。

[http://jsfiddle.net/nstuart/nF7eJ/（HTML](http://jsfiddle.net/nstuart/nF7eJ/) 位）

```
<div ng-app="myApp" ng-controller="MyCtrl">
    <select ng-model="params.value">
        <option value="">Any</option>
        <option ng-repeat="v in options" value="{{v.value}}" title="{{v.name}}" ng-selected="{{v.value == params.value}}">{{v.name}}</option>
    </select>
    <p>{{params.value}}</p>
</div> 
```

理想情况下，**选择**会选择“test3”，但您可以看到它被设置为空选项。我理解这是因为 ng-model 的值不存在于**ng-options**中，但那是因为我没有定义一个！

关于如何让这样的东西工作的任何想法？甚至可以为 ng-options 生成的选项添加标题，以便我们可以使用它？

**编辑**

将小提琴更新为：http: [//jsfiddle.net/nstuart/nBphn/2/](http://jsfiddle.net/nstuart/nBphn/2/)，如下面的答案所述。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-15T18:14:41.440

实际上，只需从 ng-selected 中的表达式中删除花括号，它就会起作用：

```
<option ng-repeat="v in options" 
        value="{{v.value}}" 
        title="{{v.name}}" 
        ng-selected="v.value == params.value">{{v.name}}
</option> 
```

[小提琴](http://jsfiddle.net/nF7eJ/11/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T18:10:04.803

```
<option ng-repeat="v in options" value="{{v.value}}" title="{{v.name}}"
        ng-selected="checkOption(v.value)">{{v.name}}</option>

$scope.checkOption = function(value){
    return($scope.params.value == value);
} 
```

[小提琴](http://jsfiddle.net/bfelda/nF7eJ/10/)

[更新] 忘记传递值变量。更新了小提琴和答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-22T00:20:27.850

对于手动选项，您只需要使用`ng-model`指令。该`ng-model`指令为所选选项提供了两种数据绑定方式。

jsfiddle：http: [//jsfiddle.net/rpaul/1p9b5et8/1/](http://jsfiddle.net/rpaul/1p9b5et8/1/)

```
<body ng-app ng-controller="AppCtrl">
<select ng-model="selectedFruit" >
    <option value ='1'> Apple</option>
     <option value ='2'> Orange</option>
</select>
   Selected value is  {{selectedFruit}}
</body>

function AppCtrl($scope) {     

      $scope.selectedFruit = '1';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T19:07:17.630

您可能还想查看[http://angular-ui.github.com/#directives-select2中的 select2 指令](http://angular-ui.github.com/#directives-select2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-22T13:51:47.790

在我的代码中，我重新计算 ng-change="changeItem()" 上的选择标题

HTML

```
<div ng-app="myApp" ng-controller="MyCtrl">
    <select ng-options="item.id as item.title for item in items" 
            ng-model="selectedId" ng-change="changeItem()" title="{{myTitle}}">
        <option value="" disabled selected style="display: none;">Select Item</option>                
    </select>
    <div>
        {{selectedId}}        
    </div>
    <div>
        {{myTitle}}        
    </div>
</div> 
```

应用程序.js

```
angular.module('myApp', []);

function MyCtrl($scope) {

    $scope.items = [{
        id: 1,
        title: "Icebox"
    }, {
        id: 2,
        title: "Summer"
    }, {
        id: 3,
        title: "Milestone"
    }];

    $scope.changeItem = function() {
        $scope.myTitle = undefined;
        for(var i=0; i<$scope.items.length; i++){
            if($scope.items[i].id == $scope.selectedId){
                $scope.myTitle = $scope.items[i].title;    
            }
        }    
    }    
} 
```

[小提琴](http://jsfiddle.net/ncG5s/8/)

# javascript - 如何防止 SVG 绘图中的对象在 chrome 中的 SVG 元素的边界处被剪裁？

> ID：14900502
> 
> 赞同：7
> 
> 时间：2013-02-15T17:53:20.103
> 
> 标签：javascript, html, google-chrome, svg

我正在使用 SVG 绘制一个交互式图表，该图表可以随着用户交互而发生很大变化。更准确地说，当用户添加实体时，它可以向任何方向（包括负坐标）扩展。

我想把我的 SVG 对象想象成一个可以包含对象的无限计划，无论它们在哪里都会被绘制。我使用这个对象的位置和变换来允许用户缩放和移动当前在屏幕上可见的部分。 ![在此处输入图像描述](../Images/c643ff99101a66f1690be2244db25036.png) 问题是，通过一个幼稚的实现，我得到了这个： ![在此处输入图像描述](../Images/69efbe355b4ffe4dc6efc05f60e475a8.png)

我用这个 SVG 代码做了一个最小的[jsFiddle](http://jsfiddle.net/MWqCW/)来重现这个问题

```
<svg>
    <rect x="-10" y="35" width="40" height="40"
    style="stroke: black; fill: none;"/>
    <!-- roof -->
    <polyline points="-10 35, 10 7.68, 30 35" 
    style="stroke:black; fill: none;"/>
    <!-- door -->
    <polyline points="10 75, 10 55, 20 55, 20 75"
    style="stroke:black; fill: none;"/>
</svg> 
```

这个CSS代码

```
svg {
    border: 1px solid blue;
    position: absolute; top: 30px; left: 30px;
} 
```

我知道我可以：动态更改 SVG 的 viewBox，并为 svg 元素应用偏移量，但这将是一个非常痛苦的重构，因为它是从 VML 移植的旧代码，并且有很多交互使坐标系统转换。所以我想要一个不涉及更改坐标系的解决方案。

***编辑***：我第一次忘记提到它，但`"overflow: visible"`没有产生预期的结果：孩子仍然被剪掉。

***问：有没有办法让浏览器在 SVG 元素的边界之外进行绘制？***

注意：即使我更喜欢使用标准解决方案，我也可以只使用 chrome 解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-15T17:57:47.687

通常的方法是将[溢出](http://www.w3.org/TR/SVG/masking.html#OverflowAndClipProperties)=“可见”添加到 svg 元素

# javascript - 使用正则表达式过滤掉不符合条件的单词

> ID：14900503
> 
> 赞同：0
> 
> 时间：2013-02-15T17:53:25.710
> 
> 标签：javascript, regex

我在一个字符串中有一个 0 到 10,000+ 字长的文本。我也有一个输入字符串`input`。如何删除字符串中不以 开头的所有单词`input`？

前任：

“这是一串包含三十万亿口渴的演员的字符串。”

输入 = “th”

我希望“这三十个口渴的演员”回归。我对正则表达式知之甚少，所以我不确定如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:09:59.863

这是一个perl解决方案，希望对您有所帮助。

```
$beginning = "th";
$s = "This is a string containing thirty-trillion thirsty thespians."; 
@results = $s =~/\b($beginning\w*)/ig;
print for @results` 
```

它会打印

> 这三十口渴的演员

正则表达式执行以下操作：
它以单词边界开始匹配，`\b`. `($beginning\w*)`捕获以 开头的单词，`$beginning`后跟零个或多个单词字符。括号意味着它将返回括号内匹配的任何内容。

这`i`意味着它不区分大小写`g`意味着它遍历整个字符串并将匹配的所有内容作为列表返回（`@results`此处）。

# assembly - 在没有操作系统细节的情况下玩组装

> ID：14900509
> 
> 赞同：0
> 
> 时间：2013-02-15T17:53:37.127
> 
> 标签：assembly, x86

我有时喜欢在 C(++) 中使用内联汇编来了解更多信息并轻松与之交互。我查看了像 NASM 这样的汇编程序的教程，但似乎你必须注意很多操作系统特定的细节才能做任何事情。

有没有办法玩汇编，我可以编写简单的函数并从 C 或类似的东西中调用它们？也许是一个以目标文件作为输出的汇编器？

基本上我有兴趣学习如何将问题转化为低级指令，我不想处理样板代码以将消息打印到屏幕等等。

请注意，我不打算用汇编语言编写实际程序。我知道编译器在这方面做得比我以往任何时候都好。我只是为了好玩，基本上是为了解决难题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:23:05.210

您可能有兴趣关注[Paul Carter 的 PC 组装教程](http://www.drpaulcarter.com/pcasm/)。它适用于 NASM 和几乎所有 C 编译器（gcc、Open Watcom、Borland's、Microsoft's）。

# python - 更改应用程序和任务栏图标 - Python/Tkinter

> ID：14900510
> 
> 赞同：13
> 
> 时间：2013-02-15T17:53:39.120
> 
> 标签：python, tkinter

我一直在研究一个非常简单的 python/tkinter 脚本（一个 .pyw 文件），我想更改它的应用程序图标（例如，资源管理器窗口和*启动/所有程序*窗口中显示的“文件”图标- 不是“文件类型”图标，也不是应用程序图标的主窗口）和任务栏图标（应用程序最小化时任务栏上显示的图标）。是否可以更改它们，或者只有当您通过 .exe 有效*安装*应用程序时才可行？

这个小应用程序应该只能在 Windows XP / 7 机器上运行，它使用 Python 2.7.3。

提前致谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-12-31T14:33:20.463

Windows 上的另一个选项如下：

在您的 python 代码中添加以下内容：

```
import ctypes

myappid = 'mycompany.myproduct.subproduct.version' # arbitrary string
ctypes.windll.shell32.SetCurrentProcessExplicitAppUserModelID(myappid) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-05-27T13:37:53.157

利用

```
root.iconbitmap(default='ardulan.ico') 
```

但问题是它只替换了窗口上的图标而不是任务栏上的图标。这是因为 py 文件是从 python 解释器执行的，所以 windows 使用他的图标而不是 tkinter 图标。

我认为你必须用 py2exe、cx_Freeze、py2app 来“编译”它...

[http://www.py2exe.org/index.cgi/CustomIcons](http://www.py2exe.org/index.cgi/CustomIcons)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-07-07T03:12:19.683

我有一个`music_app.py`文件和`melody.ico`文件

使用 Tkinter，您可以使用：

```
from tkinter import *
root = Tk()
root.title("melody")
root.iconbitmap(r"melody.ico")
root.mainloop() 
```

使用 PyQT

```
from PyQt4 import QtGui
import sys

app = QtGui.QApplication(sys.argv)
Form = QtGui.QWidget()
Form.setWindowIcon(QtGui.QIcon('melody.ico'))
Form.setWindowTitle('melody')
Form.show()
sys.exit(app.exec_()) 
```

之后，您可以转换`music_app.py`为`.exe`或不转换，结果保持不变：

[![在此处输入图像描述](../Images/e2ecf06c66b5af0a6122a9b05bfc8369.png)](https://i.stack.imgur.com/pVeEq.png)

希望有帮助！！！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-21T15:17:23.597

您可以通过创建*python.exe*或*pythonw.exe*文件的新快捷方式来做到这一点（在 Window 的资源管理器右键单击菜单中可用的选项），然后右键单击快捷方式，选择属性，并将目标更改为：

```
"C:\Path\to\Python.exe" "Absolute\or\relative\path\to\file.py" 
```

然后选择更改图标（仍在属性窗口中），然后选择您的 .ico 文件。从此快捷方式执行程序将自动将所选图标设置为任务栏和窗口图标。

*请注意，虽然通过执行设置快捷方式，而不是直接单击您的 .py 文件，**当前工作目录将是 python.exe 之一**，而不是您的文件，您也可以在快捷方式的属性窗口中更改它，在“ start in" 输入字段（在目标下方），或使用 python 方法`os.getcwd()`查找当前工作目录并`os.chdir(path)`设置它*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-17T21:52:41.913

使用 PyInstaller 创建单个文件 exe 并使用 Inno Setup 构建 Windows 安装程序包。Inno Setup 会为你做图标的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-07T18:28:46.220

对于那些在这篇文章中寻找更准确和完整答案的人：

```
import tkinter as tk
root = tk.Tk()

root.iconbitmap('/path/to/ico/icon.ico')
root.mainloop() 
```

来源参考是[delftstack.com](https://www.delftstack.com/howto/python-tkinter/how-to-set-window-icon-in-tkinter/)

# bash - bash 命令并行

> ID：14900518
> 
> 赞同：0
> 
> 时间：2013-02-15T17:53:46.113
> 
> 标签：bash

我希望有两个 youtube-dl 进程（或尽可能多的）并行运行。请告诉我如何。提前致谢。

```
#!/bin/bash
#package: youtube-dl axel

#file that contains youtube links
FILE="/srv/backup/temp/youtube.txt"

#number of lines in FILE
COUNTER=`wc -l $FILE | cut -f1 -d' '`

#download destination
cd /srv/backup/transmission/completed

if [[ -s $FILE ]]; then
  while [ $COUNTER -gt 0 ]; do

    #get video link
    URL=`head -n 1 $FILE`

    #get video name
    NAME=`youtube-dl --get-filename -o "%(title)s.%(ext)s" "$URL" --restrict-filenames`

    #real video url
    vURL=`youtube-dl --get-url $URL`

    #remove first link
    sed -i 1d $FILE

    #download file
    axel -n 10 -o "$NAME" $vURL &

    #update number of lines
    COUNTER=`wc -l $FILE | cut -f1 -d' '`
  done
else
  break
fi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T01:42:59.503

这应该适用于 GNU Parallel：

```
cd /srv/backup/transmission/completed
parallel -j0 'axel -n 10 -o $(youtube-dl --get-filename -o "%(title)s.%(ext)s" "{}" --restrict-filenames) $(youtube-dl --get-url {})' :::: /srv/backup/temp/youtube.txt 
```

了解更多：[https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T18:05:00.190

## 解决方案

您需要[在子shell 中运行您的命令，](http://tldp.org/LDP/abs/html/subshells.html)即将您的命令放入`( cmd ) &`.

### 定义

> shell 脚本本身可以启动子进程。这些子shell 让脚本进行并行处理，实际上同时执行多个子任务。

### 代码

对你来说，我猜它看起来像这样（我添加引号`$vURL`）：

```
( axel -n 10 -o "$NAME" "$vURL" ) & 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:29:27.227

我不知道这是否是最好的方法，你可以定义一个函数，然后在后台调用它

像这样的东西：

```
#!/bin/bash
#package: youtube-dl axel

#file that contains youtube links
FILE="/srv/backup/temp/youtube.txt"

# define a function
download_video() {
  sleep 3
  echo $1
}

while read -r line; do
  # call it in background, with &
  download_video $line &
done < $FILE 
```

脚本快速结束但功能仍在后台运行，3秒后将显示回声

还使用了 read 和 while 循环来简化文件读取

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:54:49.587

这是我的看法。通过避免使用几个命令，您应该会看到速度的一些小改进，尽管它可能并不明显。我确实添加了错误检查，可以节省您处理损坏 URL 的时间。

```
#file that contains youtube links
FILE="/srv/backup/temp/youtube.txt"

while read URL ; do
    [ -z "$URL" ] && continue

    #get video name
    if NAME=$(youtube-dl --get-filename -o "%(title)s.%(ext)s" "$URL" --restrict-filenames) ; then
        #real video url
        if vURL=$(youtube-dl --get-url $URL) ; then
            #download file
            axel -n 10 -o "$NAME" $vURL &
        else
            echo "Could not get vURL from $URL"
        fi
    else
        echo "Could not get NAME from $URL"
    fi
done << "$FILE" 
```

根据要求，这是我将 vURL 和 NAME 获取以及下载并行的建议。注意：由于下载依赖于 vURL 和 NAME，因此创建三个进程没有意义，两个为您提供最佳回报。下面我将 NAME fetch 放在它自己的进程中，但如果结果证明 vURL 始终更快，那么将它与 NAME fetch 交换可能会有一点回报。（这样下载过程中的 while 循环甚至不会浪费一秒钟的睡眠时间。） 注意 2：这是相当粗糙的，未经测试，它只是即兴发挥，可能需要工作。无论如何，可能有一种更酷的方式。害怕...

```
#!/bin/bash

#file that contains youtube links
FILE="/srv/backup/temp/youtube.txt"

GetName () {  # URL, filename
    if NAME=$(youtube-dl --get-filename -o "%(title)s.%(ext)s" "$1" --restrict-filenames) ; then
        # Create a sourceable file with NAME value
        echo "NAME='$NAME'" > "$2"
    else
        echo "Could not get NAME from $1"
    fi
}

Download () {  # URL, filename
    if vURL=$(youtube-dl --get-url $1) ; then
        # Wait to see if GetName's file appears
        timeout=300  # Wait up to 5 minutes, adjust this if needed
        while (( timeout-- )) ; do
            if [ -f "$2" ] ; then
                source "$2"
                rm "$2"
                #download file
                if axel -n 10 -o "$NAME" "$vURL" ; then
                    echo "Download of $NAME from $1 finished"
                    return 0
                else
                    echo "Download of $NAME from $1 failed"
                fi
            fi
            sleep 1
        done
        echo "Download timed out waiting for file $2" 
    else
        echo "Could not get vURL from $1"
    fi
    return 1
}

filebase="tempfile${$}_"
filecount=0

while read URL ; do
    [ -z "$URL" ] && continue
    filename="$filebase$filecount"
    [ -f "$filename" ] && rm "$filename" # Just in case
    (( filecount++ ))
    ( GetName "$URL" "$filename" ) &
    ( Download "$URL" "$filename" ) &
done << "$FILE" 
```

# c# - 为什么更喜欢收益率而不是简单的回报？

> ID：14900523
> 
> 赞同：2
> 
> 时间：2013-02-15T17:54:03.883
> 
> 标签：c#

我试图了解使用 Yield 来枚举集合。我写了这个基本代码：

```
static void Main(string[] args)
{
    Iterate iterate = new Iterate();
    foreach (int i in iterate.EnumerateList())
    {
        Console.Write("{0}", i);
    }
    Console.ReadLine();
}

class Iterate
{
    public IEnumerable<int> EnumerateList()
    {
        List<int> lstNumbers = new List<int>();

        lstNumbers.Add(1);
        lstNumbers.Add(2);
        lstNumbers.Add(3);
        lstNumbers.Add(4);
        lstNumbers.Add(5);

        foreach (int i in lstNumbers)
        {
            yield return i;
        }
    }
} 
```

（1）如果我简单地使用`return i`而不是`yield return i`怎么办？

(2) 使用 Yield 有什么优势，什么时候更喜欢使用它？

****已编辑******

 **在上面的代码中，我认为使用`foreach`两次是一种开销。第一个在方法`main function`中，第二个在`EnumerateList`方法中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T17:54:54.020

Using`yield return i`使这个方法成为一个[*迭代器*](http://msdn.microsoft.com/en-us/library/vstudio/dscyy5s0.aspx)。它将`IEnumerable<int>`从整个循环中创建一系列值。

如果你使用`return i`，它只会返回一个`int`值。在您的情况下，这会导致编译器错误，因为您的方法的返回类型是`IEnumerable<int>`，而不是`int`。

在这个特定的例子中，我个人只是返回`lstNumbers`而不是使用迭代器。但是，您可以在没有列表的情况下将其重写为：

```
public IEnumerable<int> EnumerateList()
{
    yield return 1;
    yield return 2;
    yield return 3;
    yield return 4;
    yield return 5;
} 
```

甚至：

```
public IEnumerable<int> EnumerateList()
{
    for (int i=1;i<=5;++i)
        yield return i;
} 
```

当你创建一个你想像一个集合一样的类时，这非常方便。手动实现`IEnumerable<T>`自定义类型通常需要创建自定义类等。在迭代器之前，这需要大量代码，如[在 C# 中实现自定义集合的旧示例中](http://support.microsoft.com/kb/307484)所示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:00:50.633

正如 Reed 所说， using`yield`允许您实现迭代器。迭代器的主要优点是它允许惰性求值。即，除非需要，否则不必实现整个结果。

Consider `Directory.GetFiles` from the BCL. It returns `string[]`. I.e. it has to get all the files and put the names in an array before it returns. In contrast `Directory.EnumerateFiles` returns `IEnumerable<string>`. I.e. the caller is responsible for handling the result set. That means that the caller can opt out of enumerating the collection at any point.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T17:59:00.323

该`yield`关键字将使编译器将函数转换为枚举器对象。

该`yield return`语句不只是退出函数并返回一个值，它使代码处于一种状态，以便在从枚举器请求下一个值时可以在该点恢复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T17:59:08.837

您不能只返回 i，因为 i 是 int 而不是 IEnumerable。它甚至不会编译。您可以返回 lstNumbers，因为它实现了 IEnumerable 的接口。

我更喜欢 yield return 因为编译器将处理构建可枚举而不必首先构建列表。所以对我来说，如果我有一些已经实现接口的东西，那么我会返回，如果我必须构建它而不是在其他地方使用它，那么我会产生返回。**

# reporting-services - 如何根据阈值保持值更改字体颜色

> ID：14900524
> 
> 赞同：4
> 
> 时间：2013-02-15T17:54:05.767
> 
> 标签：reporting-services, fonts, colors

我有一个要求，如果阈值大于 6%，则文本颜色应显示为红色，在 5-6% 之间应更改为黄色。我在第一个要求 iif(fields!My_column.value>6, "red","Black") 的文本框字体颜色属性中尝试了这个表达式，但没有奏效。对于我的两个问题，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T18:16:21.467

没有理由这不应该工作。

您可以为**文本框设置****颜色**属性，它应该没问题。

 **```
=Switch(Fields!My_column.Value > 6, "Red"
    , Fields!My_column.Value < 5, "Black"
    , true , "Yellow") 
```

给出：

![在此处输入图像描述](../Images/77cf5fe5864ed963ca5d89b6c452dab4.png)

您的基础数据看起来如何？6% 是“ *6* ”还是实际上是“ *0.06* ”？**

# php - 这种方法在 PHP 中处理错误安全吗？是地道的吗？

> ID：14900525
> 
> 赞同：0
> 
> 时间：2013-02-15T17:54:12.100
> 
> 标签：php, error-handling

我在我的一些函数中写了很多这样的代码：

```
$f = fopen($fname);

if ($f === false) {
    throw new Exception("cannot open $fname");
} 
```

当您处理大量要打开和处理的文件时，这很冗长。我想知道这是否可以在没有任何不可预见的不良副作用的情况下工作：

```
$f = fopen($fname) or die("cannot open $fname"); 
```

这在 Perl 中是惯用的，但在 PHP 中是否正确？还有另一种更好的方法吗？这似乎是有效的，但我知道 PHP 会以很多意想不到的方式咬你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:58:57.887

就我个人而言，我将所有代码作为一个可能引发异常的函数。然后调用该函数捕获异常。如果是实时（生产），则在收到异常时生成适当的页面和日志详细信息。否则（测试/开发）将这些细节放在页面上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:59:05.380

我倾向于选择类似的东西：

```
if(!($f = @fopen($fname, 'r'))) {
    throw new Exception("cannot open $fname");
} 
```

perl 风格也很好，尽管我相信 fopen 会引发错误。

# java - 引用 ImageView 子类获取 ClassCastException

> ID：14900527
> 
> 赞同：1
> 
> 时间：2013-02-15T17:54:21.617
> 
> 标签：java, android, subclass, android-imageview, classcastexception

我有一个项目，我正在尝试为 ImageView 创建一个子类，以添加一些我想使用的方法。我只有几周的 Android 编码经验，所以我不是很有经验，而且对 OOP 还很陌生。因为我无法让它在我的主项目中工作，所以我做了一个小测试项目，唉，我得到了同样的错误。

首先，我创建了一个扩展 ImageView 的新类 ImageViewCustom.java

```
public class ImageViewCustom extends ImageView {} 
```

（我已经添加了超类的构造函数）

在 XML 中，我在[这里阅读后确实喜欢](https://stackoverflow.com/a/7039470)

```
<ImageView class="com.example.testcustomclass.ImageViewCustom" 
    android:id="@+id/imageViewCustom" ... /> 
```

这可以构建和运行，但是当我尝试像这样在 MainActivity 中引用它时

```
ImageViewCustom imageViewTest = (ImageViewCustom)
    findViewById(R.id.imageViewCustom); 
```

我得到...

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to start activity
    ComponentInfo{com.example.testcustomclass.MainActivity}:
    java.lang.ClassCastException: android.widget.ImageView 
    cannot be cast to com.example.testcustomclass.ImageViewCustom 
```

我究竟做错了什么？D：我认为我遗漏了一些非常基本的东西，因为这是一个几乎是空的项目。仅供参考，我正在尝试在今晚之前完成一项任务（嗯！）并且得到了太多重复的代码，我想做一个子类，但我很难过和压力过大>_<睡眠不足等。

（编辑，修复代码格式...）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:58:01.870

好吧，您的 XML 已关闭...我总是使用

```
<com.my.project.MyView
     android:id="..."
/> 
```

我认为这是正确的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:11:02.170

如果您在 xml 布局中引用您的视图，则不需要使用类

代替

```
<ImageView class="com.example.testcustomclass.ImageViewCustom" 
    android:id="@+id/imageViewCustom" ... /> 
```

和

```
<com.example.testcustomclass.ImageViewCustom
    android:id="@+id/imageViewCustom" ... /> 
```

# ruby-on-rails - 异常通知 gem 和 Rails 3.2 缺少模板错误

> ID：14900528
> 
> 赞同：3
> 
> 时间：2013-02-15T17:54:22.523
> 
> 标签：ruby-on-rails, exception-notification

我们在项目中使用 exception_notification gem，现在我们看到缺少模板错误。这是我们的设置的样子：

```
# Gemfile
gem 'exception_notification'

# config/initializers/exception_notifications.rb
if Rails.env.production?  
    server_hostname = `hostname`.chomp
    Rails.application.config.middleware.use ExceptionNotifier, 
    :exception_recipients => %w(webdev@domain.com),
    :sender_address =>  %("Application Error" <admin@domain.com>),
    :email_prefix => "[#{server_hostname}] "
end 
```

当异常发生时，我们确实收到了电子邮件，但呈现的错误页面是原始 ERB 和文本的无样式混合，一点也不漂亮 < [screenshot](http://cl.ly/image/2R3X1n0k3R3S) > 我们日志中的错误消息是：

```
ActionView::MissingTemplate (Missing template /exception_notification with {:locale=>[:en], :formats=>[:text], :handlers=>[:erb, :builder]}. Searched in:
    * "/Users/j/Projects/agilebits/app/views"
    * "/Users/j/Projects/agilebits/vendor/bundle/ruby/1.9.1/gems/exception_notification-3.0.1/lib/exception_notifier/views"
): 
```

当然，视图不在我的`app/views`文件夹中，但在我的 gems 文件夹中：

```
↪ ls -R /Users/j/Projects/agilebits/vendor/bundle/ruby/1.9.1/gems/exception_notification-3.0.1/lib/exception_notifier/views
exception_notifier

/Users/j/Projects/agilebits/vendor/bundle/ruby/1.9.1/gems/exception_notification-3.0.1/lib/exception_notifier/views/exception_notifier:
_backtrace.html.erb                        _request.html.erb                          background_exception_notification.html.erb
_backtrace.text.erb                        _request.text.erb                          background_exception_notification.text.erb
_data.html.erb                             _session.html.erb                          exception_notification.html.erb
_data.text.erb                             _session.text.erb                          exception_notification.text.erb
_environment.html.erb                      _title.html.erb
_environment.text.erb                      _title.text.erb 
```

看起来 Rails 正在寻找视图 /exception_notification.text.erb ，`exception_notification-3.0.1/lib/exception_notifier/views`而不是在那里的`exception_notifier`子目录中。在这一点上，我不确定这是否是 Rails 或 exception_notification gem 的问题，但鉴于电子邮件已发送，我不确定为什么会出现错误消息。

感谢您查看并提供任何指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:07:02.380

我遇到了同样的问题，最终分叉了 exception_notification 并更改了它在 notifier.rb 中查找模板的位置。Fork 在[https://github.com/etcetc/exception_notification](https://github.com/etcetc/exception_notification)

# python - 2D和3D numpy数组的多态处理

> ID：14900529
> 
> 赞同：0
> 
> 时间：2013-02-15T17:54:26.173
> 
> 标签：python, numpy

我正在用 Python 处理图像，需要编写一个可以同时处理彩色和灰度图像的程序。他们是 numpy 数组

颜色形状：（512,512,3）

灰度形状：(512,512)

现在我必须遍历图像的每个通道，即返回：

```
For Color: im[:,:,0], im[:,:,1], im[:,:,2]

For Grayscale: im[:,:] 
```

如何在没有任何 if 条件的情况下以相同的格式编写它们？我尝试了 im[:,:,0] 的灰度，但它超出了索引的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:56:24.423

我不确定这是否有用，但`numpy`提供了插入[新轴](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing)的能力：

```
im_new = im_old[:,:,np.newaxis] 
```

据我了解，这使得它与any`im_new[i,j,k]`相同。`im_old[i,j]``k`

（另请注意，这`np.newaxis`只是 的别名`None`）

# jquery - 使用jQuery在DOM中查找字符串的位置

> ID：14900535
> 
> 赞同：0
> 
> 时间：2013-02-15T17:54:44.817
> 
> 标签：jquery, dom

我有以下问题：

我使用 jQuery .text() 函数来获取整个 div 元素的纯文本内容。

现在，我从这个字符串中创建了一个小子字符串。我想回到 dom 并在整个 DOM 中找到这个子字符串的 strpos。这是jsfiddle，

[http://jsfiddle.net/56GYt/](http://jsfiddle.net/56GYt/)

这是html

```
<body>
       <div class="geronimo"> this is the problem.<p> now what do i do</p>
       <p> this is the next problem<br> i hope someone can help
       <em> im cooked if i dont find a quick solution.</em>
       </div> 
```

现在这是我的 jQuery。var textcontents = $(".geronimo").text();

```
 var textlengths = textcontents.length;
    //get a random number inside this length
    //create a searchstring from this
    var searchstring =
       textcontents.substring(Math.floor((Math.random()*textlengths)+1,textlengths));
      alert(searchstring);
     //now find this searchstring in the dom and return its strpos 
```

我想强调一下，我想要一个可能使用纯 DOM 方法而不是正则表达式的解决方案。使用正则表达式我知道这是可能的，但不建议将正则表达式用于此类工作。

# visual-studio-2010 - 配置 clickonce deploy 以便用户可以找到并打开包含的 pdf 文件

> ID：14900536
> 
> 赞同：0
> 
> 时间：2013-02-15T17:54:46.653
> 
> 标签：visual-studio-2010, clickonce

我在我的项目中创建了一个文档文件夹，并将用户指南（一个 pdf 文件）添加到我的项目中（作为内容，如果更新则复制）

使用单击一次部署，文件被复制 - 但临时用户将无法使用资源管理器导航到其位置。如何配置部署以使用户在想要阅读此文件时更容易找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:07:06.513

我认为没有 ClickOnce 解决方案，您需要在首次运行后创建文件夹（例如 ProgramFiles/Appl）并手动将帮助文件复制到文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T07:12:47.623

处理此问题的另一种方法是在应用程序启动或用户请求 hte 文件时将文件复制到 MyDocuments/yourappname/appdata/，然后将用户定向到那里。

# git - git log - 行太长 - 没有换行符

> ID：14900541
> 
> 赞同：9
> 
> 时间：2013-02-15T17:55:19.353
> 
> 标签：git

（使用 Debian Linux、KDE、Konsole 和 bash。）

当我运行 git log 时，我无法阅读完整的提交消息。我看到了句子的开头，但如果太长，我就看不到了。

我也没有看到多行的条目。

如何查看完整的 git 日志条目？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T18:11:21.373

您是否尝试按右箭头按钮来查看那些长线？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-15T17:59:44.917

`git log | cat`总是一个不错的技巧。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-15T17:59:44.643

如果您需要强制使用默认日志样式，请执行

```
git log --format=medium 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-12T23:51:31.283

```
$ git config --global core.pager 'less -R' 
```

请注意，这可以防止 less 跟踪屏幕外观，这可能会导致各种显示问题，其中之一是长线被分割到错误的位置（这是我们*想要*的副作用）

# c# - DataGridView.CurrentCell.RowIndex 属性上的意外空引用异常

> ID：14900542
> 
> 赞同：0
> 
> 时间：2013-02-15T17:55:19.870
> 
> 标签：c#, winforms, datagridview, nullreferenceexception

一个`DataGridView.CurrentCell`属性是否有可能不存在但对其属性`null`具有价值？如果是这样，我该如何防止这种情况发生？`null``RowIndex`

`SelectionChanged`额外信息：在事件上检查此值，`DataGridView`以将当前选定行的索引存储在类字段中。

代码如下：

```
private void dgTraffic_SelectionChanged(object sender, EventArgs e)
{
    try
    {
        if (dgReport.CurrentCell != null)
            actualRow = dgReport.CurrentCell.RowIndex;
    }
    catch (NullReferenceException ex)
    {
    #if DEBUG
        MessageBox.Show("Error on dgTraffic_SelectionChanged:\n" + ex.Message);
    #endif
    }
} 
```

不知何故，我在引用 RowIndex 属性的行上得到了一个未处理的 NullReferenceException，所以我添加了 try-catch，但我不知道这是怎么发生的。顺便说一句，我意识到方法名称是“dgTraffic”，方法主体中使用的对象是 dgReport。实际上就是这样设置的，这就是 dgReport 的 SelectionChanged 事件使用的方法。

# ios - 使用自动布局自定义 UITableViewCell 的子视图 - 没有 xib，全部在代码中

> ID：14900544
> 
> 赞同：2
> 
> 时间：2013-02-15T17:55:24.707
> 
> 标签：ios, uitableview, ios6, autolayout, heightforrowatindexpath

使用自动布局在代码中添加的自定义 UITableViewCell 的子视图有效（已验证）。然而，这样做的重点是不必计算每个 tableview 单元格的高度，并且委托方法 heightForRowAtIndexPath 在绘制 tableview 时需要一个高度。

如何使用自动布局（在已添加和工作的代码中添加基于视觉格式语言的内容）根据内容计算出这个高度，并将其返回到这个 heightForRowAtIndexPath？

此外，我真的不能在后台线程上执行此操作（或者我可以吗？），因此，如果我有一个 UITableView 使用它并由 1000 条记录的列表支持，这将永远持续下去，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T20:48:04.117

在这种情况下，自动布局仅意味着您不需要计算每个单元格中子视图的帧大小。它与 heightForRowAtIndexPath 方法无关 - 表格视图使用它来定义单元格的框架，然后通知子视图的布局。

使用 Autolayout 确定高度可能会很慢，而且您不能在后台线程上执行此操作。如果您有 1000 行，那么我会考虑使用层次结构而不是单个表，因为滚动浏览会非常乏味。您还可以考虑在设置或创建数据时计算高度。

您*可以*使用约束设置屏幕外视图，用每个项目的数据填充它，然后记录并缓存高度。但是，您必须在数据端而不是在高度方法中执行此操作，因为它太慢了。

# c++ - C++中赋值运算符重载的目的

> ID：14900545
> 
> 赞同：1
> 
> 时间：2013-02-15T17:55:25.627
> 
> 标签：c++, operator-overloading, assignment-operator

我试图了解在 C++ 中重载某些运算符的目的。
从概念上讲，赋值语句可以通过以下方式轻松实现：

*   销毁旧对象，然后复制构造新对象
*   复制新对象的构造，然后与旧对象交换，然后销毁旧对象

事实上，复制和交换的实现*通常是*实际代码中赋值的实现。

那么，为什么 C++ 允许程序员重载赋值运算符，而不仅仅是执行上述操作？

是否打算允许分配比破坏+构造更快的场景？
如果是这样，什么时候发生？如果不是，那么它打算支持什么用例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:03:19.103

1) 引用计数

假设您有一个被引用计数的资源并且它被包装在对象中。

```
void operator=(const MyObject& v) {
  this->resource = refCount(v->resource);
}

// Here the internal resource will be copied and not the objects.
MyObject A = B; 
```

2）或者您只想复制没有花哨语义的字段。

```
void operator=(const MyObject& v) {
  this->someField = v->someField;
}

// So this statement should generate just one function call and not a fancy 
// collection of temporaries that require construction destruction.
MyObject A = B; 
```

在这两种情况下，代码都运行得更快。在第二种情况下，效果是相似的。

3）还有类型...使用运算符来处理将其他类型分配给您的类型。

```
void operator=(const MyObject& v) {
  this->someField = v->someField;
}
void operator=(int x) {
  this->value = x;
}
void operator=(float y) {
  this->floatValue = y;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:03:33.800

首先，请注意“破坏旧对象，然后复制构造新对象”不是异常安全的。

但是重新“复制新对象的构造，然后与旧对象交换，然后销毁旧对象”，这是实现赋值运算符的**交换习惯，如果正确完成，它是异常安全的。**

在某些情况下，自定义赋值运算符可能比交换习语更快。例如，POD 类型的直接数组不能真正交换，除非通过较低级别的分配。因此对于交换习语，您可以预期与数组大小成正比的开销。

然而，从历史上看，并没有太多关注交换和异常安全。

bjarne 最初想要例外（如果我没记错的话），但直到 1989 年左右它们才进入该语言。所以最初的 c++ 编程方式更侧重于分配。在某种程度上，失败的构造函数通过将 0 分配给`this`……来表示其失败，我*认为*，在那些日子里，你的问题是没有意义的。这只是所有的任务。

* * *

类型方面，一些对象具有标识，而另一些对象具有价值。分配给值对象是有意义的，但是对于标识对象，通常希望限制可以修改对象的方式。虽然这不需要自定义复制分配的能力（只是使其不可用），但有了这种能力，就不需要任何其他语言支持。

* * *

我也认为出于任何其他可以想到的具体原因：可能没有这样的原因真的需要通用能力，但是通用能力足以涵盖所有内容，因此它降低了整体语言的复杂性。

* * *

获得比我的预感、回忆和直觉更明确的答案的一个很好的来源是 bjarne 的“c++ 的设计和演变”一书。

*可能*这个问题在那里有一个明确的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T18:05:24.940

破坏旧对象，然后复制构造新对象，通常是行不通的。除非类提供特殊的交换函数，否则交换习惯用法保证不会起作用`std::swap`——在其非专门实现中使用赋值，并且直接在赋值运算符中使用它会导致无限递归。

当然，用户可能想要做一些特别的事情，例如将赋值运算符设为私有。

最后，几乎可以肯定的是，一个根本原因是：默认赋值运算符必须与 C 兼容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T18:24:45.923

实际上，在看到 juanchopanza 的答案（已被删除）之后，我想我最终自己弄清楚了。

复制赋值运算符允许类在可以重用资源（在本例中为内存）时 *避免不必要地分配资源*`basic_string`。

 *因此，当您分配给 a 时`basic_string`，重载的复制分配运算符将避免分配内存，而只会将字符串数据直接复制到现有缓冲区。

如果必须销毁并再次构造对象，则必须重新分配缓冲区，这对于小字符串来说可能成本更高。

（请注意，这`vector`也可以从中受益，但前提是它知道元素的复制构造函数永远不会抛出异常。否则它需要维护其异常安全并实际执行复制和交换。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T18:02:50.880

它还允许您使用其他类型的分配。
你可以有一个**Person**类，它带有一个分配 ID 的赋值运算符。

但除此之外，您并不总是想照原样复制所有成员。

默认分配只做浅拷贝。
例如，如果类包含指针或锁，您并不总是希望从其他对象复制它们。
通常，当您有指针时，您想使用深拷贝，并且可能创建指针指向的对象的副本。
如果你有锁，你希望它们特定于对象，并且你不想从另一个对象复制它们的状态。

如果您的类将指针作为成员，则提供您自己的复制构造函数和赋值运算符实际上是一种常见的做法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T17:59:06.127

我经常将它用作转换构造函数，但已经存在对象。即分配成员变量类型等给一个对象。*

# python - 双路径 - Django collectstatic

> ID：14900546
> 
> 赞同：0
> 
> 时间：2013-02-15T17:55:26.410
> 
> 标签：python, django

我正在使用 django 并尝试使用 manage.py collect static 并且我不断收到此错误 OSError: [Errno 2] No such file or directory: '/home/talisman/projects/Klanestro/home/projects/Klanestro/static'

我认为它正在做的是两次导入 STATICFILES_DIRS，我不知道发生了什么这是我的 settings.py

```
# Django settings for Klanestro project.

import socket
import sys
import os.path

if socket.gethostname() == 'Pangolin': #Brian's Development Laptop
    DEBUG = TEMPLATE_DEBUG = True
    TEMPLATE_DIRS = ('/home/talisman/projects/Klanestro/templates')
    SQL_LITE_NAME = '/home/talisman/projects/Klanestro/db1.db'
else:
    DEBUG = TEMPLATE_DEBUG = False
    TEMPLATE_DIRS =('/root/www/Klanestro/templates')
    SQL_LITE_NAME = '/root/www/Klanestro/db1.db'

# PROJECT_ROOT = os.path.normpath(os.path.dirname(__ file__))

ADMINS = (
     ('Brian Carpenter', 'klanestrotalisman@gmail.com'),
)

MANAGERS = ADMINS

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': SQL_LITE_NAME,             # Or path to database file if using sqlite3.
        'USER': '',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
}

# Local time zone for this installation. Choices can be found here:
# http://en.wikipedia.org/wiki/List_of_tz_zones_by_name
# although not all choices may be available on all operating systems.
# In a Windows environment this must be set to your system time zone.
TIME_ZONE = 'America/Chicago'

# Language code for this installation. All choices can be found here:
# http://www.i18nguy.com/unicode/language-identifiers.html
LANGUAGE_CODE = 'en-us'

SITE_ID = 1

# If you set this to False, Django will make some optimizations so as not
# to load the internationalization machinery.
USE_I18N = True

# If you set this to False, Django will not format dates, numbers and
# calendars according to the current locale.
USE_L10N = True

# If you set this to False, Django will not use timezone-aware datetimes.
USE_TZ = True

# Absolute filesystem path to the directory that will hold user-uploaded files.
# Example: "/home/media/media.lawrence.com/media/"
MEDIA_ROOT = ''

# URL that handles the media served from MEDIA_ROOT. Make sure to use a
# trailing slash.
# Examples: "http://media.lawrence.com/media/", "http://example.com/media/"
MEDIA_URL = ''

# Absolute path to the directory static files should be collected to.
# Don't put anything in this directory yourself; store your static files
# in apps' "static/" subdirectories and in STATICFILES_DIRS.
# Example: "/home/media/media.lawrence.com/static/"
if DEBUG == True:
    STATIC_ROOT = '/home/projects/Klanestro/staticroot'
else:
    STATIC_ROOT = '/root/www/Klanestro/staticroot'

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/'

# Additional locations of static files

if DEBUG == True:
    STATICFILES_DIRS = (
        # Put strings here, like "/home/html/static" or "C:/www/django/static".
        # Always use forward slashes, even on Windows.
        # Don't forget to use absolute paths, not relative paths.
        'home/projects/Klanestro/static',
        )
else:
    STATICFILES_DIRS = ('root/Klanestro/static',)

# List of finder classes that know how to find static files in
# various locations.
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

# Make this unique, and don't share it with anybody.

# List of callables that know how to import templates from various sources.
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
#     'django.template.loaders.eggs.Loader',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
     'django.middleware.clickjacking.XFrameOptionsMiddleware',
)

ROOT_URLCONF = 'Klanestro.urls'

# Python dotted path to the WSGI application used by Django's runserver.
WSGI_APPLICATION = 'Klanestro.wsgi.application'

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
     'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
     'django.contrib.admindocs',
     'django.contrib.comments',
     'django.contrib.sitemaps',

    'tagging',
    'mptt',
    'zinnia',
    'south',
    'registration',
    'zinnia_gallery',

)

# A sample logging configuration. The only tangible logging
# performed by this configuration is to send an email to
# the site admins on every HTTP 500 error when DEBUG=False.
# See http://docs.djangoproject.com/en/dev/topics/logging for
# more details on how to customize your logging configuration.
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'filters': {
        'require_debug_false': {
            '()': 'django.utils.log.RequireDebugFalse'
        }
    },
    'handlers': {
        'mail_admins': {
            'level': 'ERROR',
            'filters': ['require_debug_false'],
            'class': 'django.utils.log.AdminEmailHandler'
        }
    },
    'loggers': {
        'django.request': {
            'handlers': ['mail_admins'],
            'level': 'ERROR',
            'propagate': True,
        },
    }
}

TEMPLATE_CONTEXT_PROCESSORS = (
  'django.contrib.auth.context_processors.auth',
  'django.core.context_processors.i18n',
  'django.core.context_processors.debug',
  'django.core.context_processors.request',
  'django.core.context_processors.media',
  'django.core.context_processors.static',
  'django.contrib.messages.context_processors.messages',
  'zinnia.context_processors.version',) # Optional

# ZINNIA_ENTRY_BASE_MODEL = 'blogs.custom_entry.Entry'

ACCOUNT_ACTIVATION_DAYS=7
EMAIL_HOST='localhost'
EMAIL_PORT=1023
EMAIL_HOST_USER='username'
EMAIL_HOST_PASSWORD='password' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:01:36.107

您可以尝试在您定义的第一个位置添加逗号`TEMPLATE_DIRS`吗？

像这样：

```
TEMPLATE_DIRS = ('/home/talisman/projects/Klanestro/templates',) 
```

这可能与您第一次没有将 TEMPLATE_DIRS 定义为元组的事实有关（因为缺少逗号）。

如果第一次出现的 TEMPLATE_DIRS 是一个元组，django 将连接（使用`+`），其他 if 声明，所以你会得到一个有两个条目的元组。

另一方面，如果您首先将其定义为字符串（缺少逗号），则连接会产生一个字符串，该字符串具有原始`TEMPLATE_DIRS`值和您第二次定义的元组的字符串表示形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:05:58.747

您的`STATICFILES_DIRS`值可能需要一个初始斜线：

```
if DEBUG:
    STATICFILES_DIRS = (
        # Put strings here, like "/home/html/static" or "C:/www/django/static".
        # Always use forward slashes, even on Windows.
        # Don't forget to use absolute paths, not relative paths.
        '/home/projects/Klanestro/static',
        )
else:
    STATICFILES_DIRS = ('/root/Klanestro/static',) 
```

（注意我真的不建议在生产环境中以 root 运行。创建一个相关用户，或者使用 Apache 的现有用户。）

# security - 如何实现蜜罐？

> ID：14900551
> 
> 赞同：2
> 
> 时间：2013-02-15T17:55:47.967
> 
> 标签：security, honeypot

我想在我们的实验室实现蜜罐。实际上，这是我在我们机构工作的一部分。所以我需要一些帮助和建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:01:04.137

“配置为通过镜像真实生产系统来检测入侵者的服务器。它看起来像一个正在工作的普通服务器，但所有的数据和事务都是虚假的。蜜罐位于防火墙内部或外部，用于了解入侵者的技术以及确定真实系统中的漏洞”

实际上，蜜罐是伪装成不受保护的计算机。蜜罐记录所有操作和与用户的交互。由于蜜罐不提供任何合法服务，所有活动都是未经授权的（并且可能是恶意的）。Talabis 提出的蜜罐类似于使用湿水泥来检测人类入侵者

[http://www.cse.wustl.edu/~jain/cse571-09/ftp/honey/index.html](http://www.cse.wustl.edu/~jain/cse571-09/ftp/honey/index.html)

**这份 pdf 白皮书详细介绍了如何实现它。**
[http://www.tracking-hackers.com/conf/slides/implementing.pdf](http://www.tracking-hackers.com/conf/slides/implementing.pdf)

# android - EditText - 在 API < 11 的 FrameLayout 中像拖动操作一样翻译

> ID：14900553
> 
> 赞同：0
> 
> 时间：2013-02-15T17:55:53.097
> 
> 标签：android, draggable, android-edittext

我想`EditText`通过拖动操作在 FrameLayout 内部进行翻译，就像我们可以`ImageView`使用`Matrix`.

我试过了

*   与 onTouch() 相同，但`ImageView`可以`Matrix`用于`Translation`. 我们不能在`EditText`.

`drag`里面可以`EditText`吗`FrameLayout`？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:53:10.230

```
option1 = (TextView)findViewById(R.id.option_1);
    option2 = (TextView)findViewById(R.id.option_2);
    option3 = (TextView)findViewById(R.id.option_3);

    //views to drop onto
    choice1 = (TextView)findViewById(R.id.choice_1);
    choice2 = (TextView)findViewById(R.id.choice_2);
    choice3 = (TextView)findViewById(R.id.choice_3);

    //set touch listeners
    option1.setOnTouchListener(new ChoiceTouchListener());
    option2.setOnTouchListener(new ChoiceTouchListener());
    option3.setOnTouchListener(new ChoiceTouchListener());

    //set drag listeners
    choice1.setOnDragListener(new ChoiceDragListener());
    choice2.setOnDragListener(new ChoiceDragListener());
    choice3.setOnDragListener(new ChoiceDragListener());

    private final class ChoiceTouchListener implements OnTouchListener {
    public boolean onTouch(View view, MotionEvent motionEvent) {
        if (motionEvent.getAction() == MotionEvent.ACTION_DOWN) {
            /*
             * Drag details: we only need default behavior
             * - clip data could be set to pass data as part of drag
             * - shadow can be tailored
             */
            ClipData data = ClipData.newPlainText("", "");
            DragShadowBuilder shadowBuilder = new View.DragShadowBuilder(view);
            //start dragging the item touched
            view.startDrag(data, shadowBuilder, view, 0);
            return true;
        } else {
            return false;
        }
    }
} 

/**
 * DragListener will handle dragged views being dropped on the drop area
 * - only the drop action will have processing added to it as we are not
 * - amending the default behavior for other parts of the drag process
 *
 */
private class ChoiceDragListener implements OnDragListener {

    @Override
    public boolean onDrag(View v, DragEvent event) {
        switch (event.getAction()) {
        case DragEvent.ACTION_DRAG_STARTED:
            //no action necessary
            break;
        case DragEvent.ACTION_DRAG_ENTERED:
            //no action necessary
            break;
        case DragEvent.ACTION_DRAG_EXITED:        
            //no action necessary
            break;
        case DragEvent.ACTION_DROP:
            //handle the dragged view being dropped over a drop view
            View view = (View) event.getLocalState();
            //stop displaying the view where it was before it was dragged
            view.setVisibility(View.INVISIBLE);
            //view dragged item is being dropped on
            TextView dropTarget = (TextView) v;
            //view being dragged and dropped
            TextView dropped = (TextView) view;
            //update the text in the target view to reflect the data being dropped
            dropTarget.setText(dropped.getText());
            //make it bold to highlight the fact that an item has been dropped
            dropTarget.setTypeface(Typeface.DEFAULT_BOLD);
            //if an item has already been dropped here, there will be a tag
            Object tag = dropTarget.getTag();
            //if there is already an item here, set it back visible in its original place
            if(tag!=null)
            {
                //the tag is the view id already dropped here
                int existingID = (Integer)tag;
                //set the original view visible again
                findViewById(existingID).setVisibility(View.VISIBLE);
            }
            //set the tag in the target view being dropped on - to the ID of the view being dropped
            dropTarget.setTag(dropped.getId());
            break;
        case DragEvent.ACTION_DRAG_ENDED:
            //no action necessary
            break;
        default:
            break;
        }
        return true;
    }
} 
```

有关更多详细信息，请参阅此[拖放](http://mobile.tutsplus.com/tutorials/android/android-sdk-implementing-drag-and-drop-functionality/)

# javascript - 周日只在 Jquery Datepicker 上？

> ID：14900563
> 
> 赞同：6
> 
> 时间：2013-02-15T17:56:24.693
> 
> 标签：javascript, jquery, datepicker

目的：只允许用户在 datpicker 日历上选择星期日。

目前我几乎完成了，除了周日工作以外的每隔一天。当我在下面的代码中使用 7 表示星期日时，整个日历都无法点击，其他任何一天都可以完美运行。

```
$(document).ready(function() {

    $("#datepicker2").datepicker({ 
        autoSize: true,         // automatically resize the input field 
        altFormat: 'yy-mm-dd',  // Date Format used
        firstDay: 1, // Start with Monday
        beforeShowDay: function(date)

        { return [date.getDay() == 7,''];}}); // Allow only one day a week
}); 
```

问题：我怎样才能只允许周日选择？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T17:58:19.807

[`Date.getDay()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getDay)返回范围内的值`0-6`，而不是`1-7`。

```
beforeShowDay: function(date) {
    return [date.getDay() === 0,''];
} 
```

# sql - Sql：选择所有类型的条件都为真

> ID：14900564
> 
> 赞同：2
> 
> 时间：2013-02-15T17:56:26.130
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个表定义和填充如下：

```
DECLARE @Temp TABLE
(
    ProjectId INT,
    EmployeeId INT,
    SomeTypeId INT,
    IsExpired BIT,
    IsWarning BIT,
    IsIncomplete BIT
)

--all incomplete...
INSERT INTO @Temp VALUES (1, 1, 1, 0, 0, 1)
INSERT INTO @Temp VALUES (1, 1, 2, 0, 0, 1)
INSERT INTO @Temp VALUES (1, 1, 3, 0, 0, 1)

--two warnings...
INSERT INTO @Temp VALUES (1, 2, 1, 0, 1, 0)
INSERT INTO @Temp VALUES (1, 2, 2, 0, 1, 0)
INSERT INTO @Temp VALUES (1, 2, 3, 0, 0, 0)

--two expirations...
INSERT INTO @Temp VALUES (1, 3, 1, 0, 0, 0)
INSERT INTO @Temp VALUES (1, 3, 2, 1, 0, 0)
INSERT INTO @Temp VALUES (1, 3, 3, 1, 0, 0) 
```

我想返回不同的 ProjectId、EmployeeId 对以及任何警告或过期：

```
SELECT DISTINCT ProjectId, EmployeeId FROM @Temp WHERE IsWarning = 1 OR IsExpired = 1 
```

没问题。

但是，我还想返回 ProjectId、EmployeeId 对，其中 IsWarning = 0 和 IsExpired = 0 和 IsIncomplete = 1，但这对于所有 SomeTypeId (1、2、3) 都必须是正确的。换句话说，没有警告，没有过期，只是所有类别都不完整。

SomeTypeId Fks 到查找表。目前只有 3 个条目，但将来可能会有更多条目。

有任何想法吗？

我希望返回 ProjectId, EmployeeId (1, 1)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:06:36.967

这使用`MAX`并`MIN`确保所有值都相同；需要为`+ 0`每个位添加一个以使其可用于正常的数字聚合函数（如/// `MIN`... ）`MAX``SUM`

```
SELECT ProjectId, EmployeeId
FROM Temp
GROUP BY ProjectId, EmployeeId
HAVING MAX(IsWarning    + 0) = 0
   AND MAX(IsExpired    + 0) = 0
   AND MIN(IsIncomplete + 0) = 1 
```

[一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!6/27b07/2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:06:35.600

我不确定您的问题是要在 SAME 查询中获得这些结果，还是想要一个全新的查询。假设后者，您的查询将是：

```
SELECT DISTINCT ProjectId, EmployeeId FROM @Temp WHERE (IsWarning = 0 AND IsExpired = 0 AND IsIncomplete = 1) 
```

假设前者，它将是：

```
SELECT DISTINCT ProjectId, EmployeeId FROM @Temp WHERE (IsWarning = 1 OR IsExpired = 1) 
```

或（IsWarning = 0 AND IsExpired = 0 AND IsIncomplete = 1）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:30:52.907

假设您没有重复记录，请尝试此操作；

请注意，*假设*您仍需要选择 data ，`union`则添加。如果您不需要它们，只需将其删除。**`WHERE IsWarning = 1 OR IsExpired = 1`**

 *[SQL-DEMO 这里](http://sqlfiddle.com/#!3/ef464/1)

```
;with cte as (
  select projectid, employeeid,
         case when sometypeid in (1,2,3) and 
                   IsWarning = 0 and IsExpired = 0 and IsIncomplete = 1
              then 1 else 0 end x
  from temp  
)
select projectid, employeeid 
from cte
group by projectId, employeeid
having sum(x) >= 3
union
select projectid, employeeid 
from Temp 
where IsWarning = 1 or IsExpired = 1 
```*

# ios - 如何使用 AFNetworking 允许 https 连接？

> ID：14900572
> 
> 赞同：7
> 
> 时间：2013-02-15T17:57:23.363
> 
> 标签：ios, objective-c, ios4, afnetworking

我设置了 AFNetworking，但它不接受 https 网址。如何让 AFNEtworking 通过 ssl 连接。

我有以下代码：

```
 NSMutableURLRequest *apiRequest =
[self multipartFormRequestWithMethod:@"POST"
                                path: pathstr
                          parameters: params
           constructingBodyWithBlock: ^(id <AFMultipartFormData>formData)
           {
               //TODO: attach file if needed
           }];

AFJSONRequestOperation* operation = [[AFJSONRequestOperation alloc] initWithRequest: apiRequest];
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    //success!
    completionBlock(responseObject);
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    //failure :(

    NSLog(@"%@", error);
    completionBlock([NSDictionary dictionaryWithObject:[error localizedDescription] forKey:@"error"]);
}];

[operation start]; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-03-10T07:54:34.267

```
operation.securityPolicy.allowInvalidCertificates = YES; 
```

这段代码非常重要。如果你不添加这个，你会得到一个错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-15T20:20:36.413

这显然只有在您拥有非自签名证书或添加以下内容时才有效：

#define _AFNETWORKING_ALLOW_INVALID_SSL_CERTIFICATES_ 到您的 pch 文件。如果您为此使用可可豆荚，您可能需要继承 AFHTTPRequestOperation 并实现：

```
- (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace
{
    if ([[protectionSpace authenticationMethod] isEqualToString:NSURLAuthenticationMethodServerTrust]) {

        if ([self bypassSslCertValidation:protectionSpace])
            return YES;
        else
            return [super connection:connection canAuthenticateAgainstProtectionSpace:protectionSpace];

    }
    return [super connection:connection canAuthenticateAgainstProtectionSpace:protectionSpace];

}

- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
{
    if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) {
        if ([self bypassSslCertValidation:challenge.protectionSpace]) {
            [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust] forAuthenticationChallenge:challenge];
            return;
        }
        else
            return [super connection:connection didReceiveAuthenticationChallenge:challenge];
        return;
    }
}

- (BOOL) bypassSslCertValidation:(NSURLProtectionSpace *) protectionSpace
{
    if (ENVIRONMENT_TYPE == DEV_ENV || ENVIRONMENT_TYPE == STAGING_ENV) {
        return YES;
    }
    return NO;
} 
```

然后告诉 AFNEtworking 使用新的子类：

```
AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:@""]];
[client registerHTTPOperationClass:[YourSubClassHTTPRequestOperation class]]; 
```

这不是世界上最容易做的事情，从技术上讲，忽略自签名并不能使它工作，但是如果您使用标准 SLL 证书它可能会正常工作，请记住删除此代码或使其仅在调试时可用如果你打算发布。

添加回答，因为评论有字符限制！

看[标题的选择很少](https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFHTTPClient.h)

可以手动加入队列的返回操作：

```
- (AFHTTPRequestOperation *)HTTPRequestOperationWithRequest:(NSURLRequest *)urlRequest 
```

或者将您的自定义子类操作传递给这个：

```
- (void)enqueueHTTPRequestOperation:(AFHTTPRequestOperation *)operation; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-10T13:08:33.510

试试这个代码。

```
 NSMutableURLRequest *apiRequest =
[self multipartFormRequestWithMethod:@"POST"
                                path: pathstr
                          parameters: params
           constructingBodyWithBlock: ^(id <AFMultipartFormData>formData)
           {
               //TODO: attach file if needed
           }];

AFJSONRequestOperation* operation = [[AFJSONRequestOperation alloc] initWithRequest: apiRequest];
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    //success!
    completionBlock(responseObject);
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    //failure :(

    NSLog(@"%@", error);
    completionBlock([NSDictionary dictionaryWithObject:[error localizedDescription] forKey:@"error"]);
}];
operation.securityPolicy.allowInvalidCertificates = YES;
[operation start]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-15T05:36:13.247

如果 AFNetworking 在超类实现上被禁用子类，那么只需输入类似 :http//foo//bar 的代码并将其设置为 bool

# javascript - 在 CKEditor 中为 KCFinder 添加一个按钮

> ID：14900577
> 
> 赞同：0
> 
> 时间：2013-02-15T17:57:53.213
> 
> 标签：javascript, html, ckeditor

我有 CKEditor 与[KCFinder](http://kcfinder.sunhater.com/)集成并运行，但该应用程序将由几乎没有计算经验的人使用，因此我希望 CKEditor 工具栏中的按钮看起来像当前的图像按钮，但直接跳转到 KCFinder。

如果您想象查看 CKEditor，单击“图像”然后单击“浏览器服务器”，我想基本上删除 CKeditor 初始弹出窗口的中间步骤。

理想情况下，用户仍然可以右键单击图像并单击“图像属性”以查看 CKEditor 的弹出窗口。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T15:49:33.263

需要一个自定义插件，并且无法像希望的那样轻松完成。

# git - Git：提交标签，然后将提交合并到master

> ID：14900584
> 
> 赞同：4
> 
> 时间：2013-02-15T17:58:07.437
> 
> 标签：git, git-branch, git-merge, git-tag

我主要熟悉SVN。我使用 Git 已经有一段时间了，但还没有做过非常高级的事情。对于我的项目，我一直在创建标记单个版本的标签。例如，我有一个`v1.2.3`针对我的项目的特定版本调用的标签。我想对该标签提交一个错误修复，然后将其合并到主标签中。我该怎么做呢？我查找了有关从标签创建分支的信息，但我不确定这是否是正确的做法。我可以直接提交到标签，然后将其合并到主标签中吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T18:01:58.320

在我看来，提交一个标签是完全错误的，尽管 svn 设计允许它。

比如说，你有一个版本 v1.2.3 并且你提交了那个标签——你得到了什么？还是 v1.2.3 或 1.2.3a 或类似的版本？你如何恢复后来的 1.2.3 版本？

不过，在 git 中，您可以重新创建标签。但是我不确定您是否应该针对“我不小心标记了错误的版本”或您有“移动”标签（例如“最后一个稳定版本”）之外的任何其他情况这样做。

在 git 你可以这样做：

```
git branch v1.2.3-bugfix v1.2.3   [v1.2.3-bugfix is your branch, v1.2.3 the tag]
git checkout v1.2.3-bugfix
-- do your changes --
git add ...
git commit
git tag -f v1.2.3 
```

也就是说，首先你从你的标签开始创建一个分支。然后你检查那个分支（通过 git checkout -b 有一个快捷方式）。您提交更改并重新创建标签。

之后，您可以删除您的错误修复分支。

# django - 在模板中看不到查询结果

> ID：14900587
> 
> 赞同：0
> 
> 时间：2013-02-15T17:58:11.980
> 
> 标签：django, django-views, django-templates

我想在 ajax 获取请求后在 html 中查看我的查询结果。请在下面找到我的代码 def tanim_ajax(request)：

```
#views.py
def tanim_ajax(request):

    if request.GET.get('q'):

        q = request.GET.get('q')
        results = Title.objects.filter(title__contains=q),
        print results
        return render_to_response('tanim/ajax.html',
                                    {'results':results},
                                    context_instance=RequestContext(request))

#models.py
class Title(models.Model):
    title = models.CharField(max_length=100,verbose_name="Başlık")
    category = models.ForeignKey(Category,verbose_name="Kategori")
    active = models.BooleanField(default=False)
    slug = models.SlugField(editable=False)

    def __unicode__(self):
        return self.title 
```

一切都适用于模板

```
{% for i in results %}
<br>{{i}}
{% endfor %} 
```

`[<Title: foo>]`当我检查`http://127.0.0.1:8000/tanimlar/tanim_ajax/?q=foo`url时，我可以看到结果。

但是当我有以下模板时

```
 {% for i in results %}
<br>{{i.title}}
{% endfor %} 
```

我没有看到任何结果。任何的想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:15:02.623

因为您将 QuerySet 传递到上下文中。相反，请尝试将 values() 附加到您的查询中，这将返回一个字典。

```
results = Title.objects.filter(title__contains=q).values() 
```

# javascript - 围绕特定文本包裹一个新的 div 元素

> ID：14900591
> 
> 赞同：2
> 
> 时间：2013-02-15T17:58:30.513
> 
> 标签：javascript, jquery, html, text

我正在努力解决这个问题。

如何`<div>`在没有任何类或 ID 的文本周围包装新元素？

下面是场景：

```
<div class="ContentDiv">.....</div>

Share your knowledge. <a href="URL">Be the first to write a review »</a> 
```

我需要新`div`的环绕“ `Share your knowledge. <a href="URL">Be the first to write a review »</a>`”

我尝试了以下方法：

```
$(document).ready(function() {
  $('.ContentDiv').each(function() {
    $(this).add($(this).next()).wrapAll('<div class="NewDiv"></div>');
  })
})
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div class="ContentDiv">.....</div>

Share your knowledge. <a href="URL">Be the first to write a review »</a>
```

但它不起作用，因为它仅环绕`<a>`元素并将文本留在其下方。我也需要那里的其余文字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:03:04.373

您需要获取下一个文本节点`.ContentDiv`并将其包装：

```
$('.ContentDiv').each(function() {
   $(this).next('a').add(this.nextSibling).wrapAll('<div class="NewDiv"></div>');
}); 
```

[**小提琴**](http://jsfiddle.net/PnjM9/3/)

由于 jQuery 并没有真正获得文本节点，因此本机`nextSibling`应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:09:27.213

为此，您可以在 $('.ContentDiv') 之后添加一个 div，然后将 html 添加到其中。

```
$("<div id='new_div'></div").insertAfter($('.ContentDiv')).html("Share your knowledge. <a href='URL'>Be the first to write a review »</a>"); 
```

# mysql - MySQL，使用自定义页眉和页脚行输出到文件

> ID：14900592
> 
> 赞同：0
> 
> 时间：2013-02-15T17:58:32.930
> 
> 标签：mysql, command-line

是否可以使用具有自定义第一行（例如“MySQL 输出”和自定义最后一行）的结果进行 MySQL 查询，并且您是否可以让最后一行说诸如“此文件有 200 行”之类的内容。

# javascript - 更新数组需要 MongoDB 帮助

> ID：14900593
> 
> 赞同：1
> 
> 时间：2013-02-15T17:58:49.357
> 
> 标签：javascript, arrays, mongodb

我有这些文件在一个集合中

```
{
   _id: 1,
   name: 'xpto',
   arr: [1, 2, 3]
},
{
  _id: 2,
  name: 'xyz'
} 
```

我希望 addToSet 编号 4 使用 update {multi: 1} 进行 arr，但出现错误“无法将 $addToSet 修饰符应用于非数组。”。我知道它发生是因为我的第二个文档没有 arr 字段。

当数组不在所有文档中时，是否可以使用 $push 和/或使用更新命令的 $addtoset 更新数组？

我用 find 做到了这一点，寻找 cursor.arr 并在不存在时创建数组。

你知道另一种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:03:35.697

如果您只需要**更新****第一个文档**中的数组，您可以使用 $push 运算符，如下所示：

**db.docs.update({_id:1},{$push:{arr:4}});**

如果您需要**更新两个文档**，您也可以使用 $push，但在第一个参数中使用空值：

**db.docs.update({}, {$push:{arr:4}});**

结果将是：*{"_id":1, "arr":[1,2,3,4], "name":"xpto"} {"_id":2, "arr":[4], “名称”：“xyz”}*

# assembly - 了解 ATT 组装（立即）

> ID：14900594
> 
> 赞同：1
> 
> 时间：2013-02-15T17:58:53.917
> 
> 标签：assembly, x86, att, immediate-operand

假设我有以下装配线

```
movl   $-1, %edi
movl   $1, %edx 
```

我究竟将什么存储到 %edi/%edx 寄存器中。

基本上，如果我要将此代码转换为 C 程序，我是否会将一些变量初始化为 -1 和 1，因为这就是我的看法，这就是我认为我感到困惑的地方。

我理解立即 =“一些常数”，但这是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:21:32.130

有四种方法可以将某些内容加载到寄存器中：

1.  立即值 - 在 AT&T 汇编程序中，它使用 a `$number`，并将该特定值（数字）加载到寄存器中。请注意，`number`它不一定是数值，例如，它可以是`movl $printf, %eax`- 这会将函数的地址加载`printf`到寄存器`eax`中。

2.  从另一个寄存器，`movl %eax, %edx`- 我们现在将`eax`值复制到`edx`.

3.  从一个固定的内存位置， `movl myvar, %eax`- 的内容`myvar`在`eax`.

4.  从另一个寄存器中的内存位置，`movl (%eax), %edx`- 现在，`edx`无论 32 位值在`eax`. 当然，假设它实际上是一个“好”的内存位置——如果不是，我们就有一个段错误。

如果这是 C 代码，代码可能看起来像这样：

1)

```
int x = 42; 

int (*printfunc)(const char *fmt, ...) = printf; 
```

2)

```
int x = 1;  
int y = 2; 
..., 
x = y;     // movl  %eax, %edx 
```

3)

```
int x = myvar; 
```

4)

```
int x = *myptr; 
```

编辑：几乎所有作为移动指令“源”的东西也可以是算术运算的源，例如`add $3, %eax`C 中的`x += 3;`.

# css - 边距在 IE7 的 iframe 中无法正常工作？

> ID：14900609
> 
> 赞同：0
> 
> 时间：2013-02-15T17:59:34.767
> 
> 标签：css, internet-explorer, internet-explorer-7, margin

我正在做一个项目，但在使用 IE7 时遇到了一些问题。

我有一个 iframe 占据整个页面并加载另一个页面。剪下来，它看起来像这样：

```
<html>

<head>

<title>Corporate Directory</title>
</head>
<body scroll="no" style="margin: 0;">

<iframe id="corpdir" height="100%" width="100%" frameborder="0" src="http://fullpath.to/corporate/directory" name="parent_frame">

</body>
</html> 
```

转到[http://fullpath.to/corporate/directory](http://fullpath.to/corporate/directory)在 IE7 中效果很好，而且渲染完全没有问题。但是当它像上面那样加载到 iframe 中时，有些元素会被推到左边。所有这些元素都定义了“margin-left”，但它似乎被忽略了。并非所有带有左边距的元素都被推过，只有少数。我看不出他们有什么共同点，我可以想象会这样做。

（请不要问为什么我几乎被迫在全屏 iframe 中加载我们的 web 应用程序。请接受这是非常企业化的并继续前进。谢谢。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:17:35.347

像这样修复它：

```
<html>

<head>

<title>Corporate Directory</title>
</head>
<frameset>
  <frame src="http://fullpath.to/corporate/directory">
</frameset>
</html> 
```

甚至没有意识到没有理由在那里使用 iframe。

# iphone - UITableViewCell 被重用

> ID：14900612
> 
> 赞同：-3
> 
> 时间：2013-02-15T18:00:03.160
> 
> 标签：iphone, ios, objective-c, uitableview

我有一个`UITableView`称为症状表......并且当在可补救表`UISwitch`中打开时有可补救我在症状表视图单元上显示一个`UIImage`以突出显示`UISwitch`该单元格的打开。当我在第一个症状的可补救中打开时，我正在显示`UISwitch`但单元格正在被重复使用，并且图像也显示在其他症状表视图单元格中。谁能帮我解决这个问题？

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    if (tableView==symptomsTableView)
    {
        PPsymptomTableCell *cell;

        static NSString *cellIdentifier=@"cellIdentifier";
        cell=[tableView dequeueReusableCellWithIdentifier:cellIdentifier];

        if (cell==nil)
        {
            cell=[[PPsymptomTableCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
            cell.selectionStyle=UITableViewCellSelectionStyleNone;
        }
        int symptomIDSelected;

        symptomIDSelected = [[[mainsymptArray objectAtIndex:indexPath.row]objectForKey:@"SymptID"]intValue];

        NSLog(@"%d",[[activeNotificationDictionary objectForKey:[NSNumber numberWithInt:symptomIDSelected]]intValue]);

        for (int i = 0; i<activeNotificationDictionary.count; i++)
        {
            if([[activeNotificationDictionary objectForKey:[NSNumber numberWithInt:symptomIDSelected]]intValue] == symptomIDSelected)
            {
                cell.selectedCellImageDisplay.hidden=NO;
            }
            else
            {
                cell.selectedCellImageDisplay.hidden=YES;
            }
        }

        NSLog(@"end of symptoms cell for row");
        if (searching==YES)
        {
            cell.symptomCellLabel.text=[[searchSymptomsArray objectAtIndex:indexPath.row] objectForKey:@"SymptName"];
            cell.backgroundColor=[UIColor clearColor];
            return cell;
        }
        else
        {
            cell.backgroundColor=[UIColor clearColor];
            NSArray *sectionArray=[mainIndexDictionary objectForKey:[allKeysArray objectAtIndex:indexPath.section]];
            cell.symptomCellLabel.text=[[sectionArray objectAtIndex:indexPath.row] objectForKey:@"SymptIndexName"];
            return cell;
        }
    } 
```

这里的 activenotification 字典是一个`NSMutableDictionary`包含特定症状 ID 的补救 ID 值的地方。这是症状表的`UITableViewCell`习惯

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self)
    {
        self.backgroundColor = [UIColor clearColor];
        self.contentView.backgroundColor = [UIColor clearColor];
        self.symptomCellImageView.contentMode=UIViewContentModeScaleToFill;

        selectedCellImageDisplay = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"selectedSymptomImage.png"]];
        selectedCellImageDisplay.frame = CGRectMake(230.0, 8.0, 30.0, 30.0);
        selectedCellImageDisplay.hidden=YES;

        symptomCellLabel=[[UILabel alloc]initWithFrame:CGRectMake(15.0,0.0 ,280.0,40.0)];
        symptomCellLabel.font=[UIFont fontWithName:@"Rockwell" size:17];
        symptomCellLabel.textColor=[UIColor blackColor];
        symptomCellLabel.backgroundColor=[UIColor clearColor];
        [self.contentView addSubview:symptomCellLabel];
        [self.contentView addSubview:selectedCellImageDisplay];
             // Initialization code
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T18:03:50.663

正在重用单元格，因为您要求重用它 ( `dequeueReusableCellWithIdentifier:`)。因为单元格可以重复使用，所以必须显式设置*每个单元格的**所有*特性，包括开关的存在与否及其状态。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:03:39.477

你把它`UISwitch`放进牢房的什么地方？每次出列或初始化单元格后，您都需要确保设置开关的状态。*

# jqgrid - 如何使用 Slickgrid 呈现 XML 数据？

> ID：14900615
> 
> 赞同：0
> 
> 时间：2013-02-15T18:00:23.843
> 
> 标签：jqgrid, grid, slickgrid, xmlreader, datastore

我们正在使用 JQuery 和 JQuery UI，并希望将 xml 到 dom 表重写为基于数据存储的网格。在 ExtJs 中，我可以使用 Ext.data.reader.Xml 和数据模式将返回的数据映射到网格。我正在尝试做同样的事情，但使用基于 JQuery 的网格库。还需要考虑性能和主题。

我过去使用过 JqGrid，它有 xmlmap 选项。但是，我关注的是 SlickGrid，特别是它的性能。我看不到任何 XML 驱动的示例。我怀疑如果我使用 Slickgrid，我将不得不加载 xml 并循环通过它来构建数据对象。

有人对使用 Slickgrid 显示 XML 数据有什么建议吗？具体来说，它是否具有 xmlmap 或 xml 阅读器功能？对于 1000 行，SlickGrid 会比 JqGrid 显着提高性能吗？

XML 示例：

```
 <D:prop>
            <FileExtension>.s4d</FileExtension>
            <ComponentType>DynamicTrove</ComponentType>
            <getcontenttype>application/xml</getcontenttype>
            <ComponentCreatedOn>2011-03-17 12:57:57 </ComponentCreatedOn>
            </D:prop>
            <D:prop>
            <FileExtension>.s4d2</FileExtension>
            <ComponentType>DynamicTrove2</ComponentType>
            <getcontenttype>application/xml2</getcontenttype>
            <ComponentCreatedOn>2011-03-17 12:57:57 2</ComponentCreatedOn>
            </D:prop> 
```

谢谢你。

示例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T20:57:00.937

您可以在网格中显示此类 XML 数据。我建议您包括本地搜索和过滤，如果用户必须分析 1000 行数据，这对用户来说非常实用。如果您将分页与过滤一起使用，您将获得 1000 行的非常好的性能。我不建议您一次显示所有 1000 行。分页要好得多。

主要问题可能是 XML 名称空间，因为它可能以不同的方式解析 jQuery。有关问题的简短描述，请参阅[答案](https://stackoverflow.com/a/10979536/315935)。

[该演示](http://www.ok-soft-gmbh.com/jqGrid/XmlInjqGrid_.htm)是一个示例，可以作为您的起点。[另一个演示](http://www.ok-soft-gmbh.com/jqGrid/XmlInjqGrid_.htm)使用 XML 命名空间并在 IE 中正常工作，但在 Google Chrome 中却不正确。

![在此处输入图像描述](../Images/f1a6902170fc36b929ce348afd07a1a9.png)

# python - 为什么我对阿特金斯筛法的天真实施排除了 5？

> ID：14900620
> 
> 赞同：5
> 
> 时间：2013-02-15T18:00:43.983
> 
> 标签：python, matlab, sieve-of-atkin

我基于[Wikipedia 低效但清晰的伪代码](http://en.wikipedia.org/wiki/Sieve_of_Atkin#Pseudocode)编写了一个极其幼稚的 Atkin 筛子实现。我最初在 MATLAB 中编写了算法，它省略了 5 作为质数。我还用 Python 编写了算法，结果相同。

从技术上讲，我知道*为什么*5 被排除在外；在步骤 where `n = 4*x^2 + y^2`，n == 5 当 x == 1 和 y == 1 时。这只发生一次，所以 5 从素数翻转到非素数并且永远不会翻转回来。

为什么我的算法与 Wikipedia 上的算法不匹配？虽然我做了一些表面上的调整（例如，每次迭代只计算一次 x^2，在第一个方程中使用它时存储 mod(n, 12) 的值等），但它们不应该改变逻辑算法。

我阅读了[几个与阿特金筛子](https://stackoverflow.com/a/12066272/869912) [相关的](https://stackoverflow.com/q/1569127/869912)[讨论](https://stackoverflow.com/q/2145939) ，但我不知道哪些差异在我的实现中造成了问题。

## Python代码：

```
def atkin1(limit):
    res = [0] * (limit + 1)
    res[2] = 1
    res[3] = 1
    res[5] = 1

    limitSqrt = int(math.sqrt(limit))
    for x in range(1, limitSqrt+1):
        for y in range(1, limitSqrt+1):
            x2 = x**2
            y2 = y**2
            n = 4*x2 + y2
            if n == 5:
                print('debug1')
            nMod12 = n % 12
            if n <= limit and (nMod12 == 1 or nMod12 == 5):
                res[n] ^= 1

            n = 3*x2 + y2
            if n == 5:
                print('debug2')
            if n <= limit and (n % 12 == 7):
                res[n] ^= 1

            if x > y:
                n = 3*x2 - y2
                if n == 5:
                    print('debug3')
                if n <= limit and (n % 12 == 11):
                    res[n] ^= 1

    ndx = 5
    while ndx <= limitSqrt:
        m = 1
        if res[ndx]:
            ndx2 = ndx**2
            ndx2Mult =m * ndx2
            while ndx2Mult < limit:
                res[ndx2Mult] = 0
                m += 1
                ndx2Mult = m * ndx2
        ndx += 1

    return res 
```

## MATLAB代码

```
function p = atkin1(limit)

% 1\. Create a results list, filled with 2, 3, and 5
res = [0, 1, 1, 0, 1];

% 2\. Create a sieve list with an entry for each positive integer; all entries of
% this list should initially be marked nonprime (composite).
res = [res, zeros(1, limit-5)];

% 3\. For each entry number n in the sieve list, with modulo-sixty remainder r:

limitSqrt = floor(sqrt(limit));
for x=1:limitSqrt
    for y=1:limitSqrt
        x2 = x^2;       y2 = y^2;

        % If r is 1, 13, 17, 29, 37, 41, 49, or 53, flip the entry for each
        % possible solution to 4x^2 + y^2 = n.
        n = 4*x2 + y2;
        nMod12 = mod(n, 12); 
        if n <= limit && (nMod12 == 1 || nMod12 == 5)
            res(1, n) = ~res(1, n);
        end

        % If r is 7, 19, 31, or 43, flip the entry for each possible solution
        % to 3x^2 + y^2 = n.
        n = 3*x2 + y2;
        if n <= limit && mod(n, 12) == 7
            res(1, n) = ~res(1, n);
        end

        % If r is 11, 23, 47, or 59, flip the entry for each possible solution
        % to 3x^2 - y^2 = n when x > y.
        if x > y
            n = 3*x2 - y2;
            if n <= limit && mod(n, 12) == 11
                res(1, n) = ~res(1, n);
            end
        end

        % If r is something else, ignore it completely.
    end
end

   % 4\. Start with the lowest number in the sieve list.
ndx = 5;
while ndx < limitSqrt
    m = 1;
    if res(ndx)
        % 5\. Take the next number in the sieve list still marked prime.
        % 6\. Include the number in the results list.
        % 7\. Square the number and mark all multiples of that square as nonprime.
        ndx2 = ndx^2;
        ndx2Mult = m * ndx2;
        while ndx2Mult < limit
            res(ndx2Mult) = 0;
            m = m + 1;
            ndx2Mult = m * ndx2;
        end
    end

    % 8\. Repeat steps five through eight.
    ndx = ndx + 1;
end

p = find(res); % Find the indexes of nonzerogo
end 
```

## [维基百科伪代码](http://en.wikipedia.org/wiki/Sieve_of_Atkin#Pseudocode)

```
// arbitrary search limit
limit ← 1000000         

// initialize the sieve
is_prime(i) ← false, ∀ i ∈ [5, limit] 

// put in candidate primes: 
// integers which have an odd number of
// representations by certain quadratic forms
for (x, y) in [1, √limit] × [1, √limit]:
    n ← 4x²+y²
    if (n ≤ limit) and (n mod 12 = 1 or n mod 12 = 5):
        is_prime(n) ← ¬is_prime(n)
    n ← 3x²+y²
    if (n ≤ limit) and (n mod 12 = 7):
        is_prime(n) ← ¬is_prime(n)
    n ← 3x²-y²
    if (x > y) and (n ≤ limit) and (n mod 12 = 11):
        is_prime(n) ← ¬is_prime(n)

// eliminate composites by sieving
for n in [5, √limit]:
    if is_prime(n):
        // n is prime, omit multiples of its square; this is
        // sufficient because composites which managed to get
        // on the list cannot be square-free
        is_prime(k) ← false, k ∈ {n², 2n², 3n², ..., limit} 

print 2, 3
for n in [5, limit]:
    if is_prime(n): print n 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:13:06.683

In Wikipedia's text description of the algorithm, the "results list" and "sieve list" are two different things. Your Matlab code has just one vector used for both. But the initial value in the sieve list for 5 should be "non-prime".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T18:10:50.540

不看代码，我在你的描述中读到了这个：

```
so 5 is flipped from prime to nonprime and never flipped back 
```

我想这就是问题所在，它应该被初始化为假（因此是非质数），并且因为它只有在它保持质数时才会被切换。

# django - 实现自动建议功能（不是自动完成）

> ID：14900625
> 
> 赞同：0
> 
> 时间：2013-02-15T18:01:04.487
> 
> 标签：django, elasticsearch, django-haystack, autosuggest

我正在使用 django haystack（带有 ElasticSearch 搜索引擎）并希望实现与自动完成不同的自动建议功能。

例如，考虑一个已被索引的小型数据集（表行）：

```
When your code is all set
And you have finished it all
Your goals have been met
And you feel not so small 
```

这就是我希望实现的：

```
First input query(for search index): 'finished coding'
expected search result:
    When your code is all set
    And you have finished it all

Second, input query(for search index): 'finished coding! goals met!'
expected search result:
    When your code is all set
    And you have finished it all
    Your goals have been met 
```

haystack's`SearchQuerySet().autocomplete(content=above query)`不会产生上述结果。

如何构建这样的查询集？

我们还在 stackoverflow 的提问页面中看到了它；即，当我们在标题字段中键入时，它会为我们提供**可能已经有您答案的问题**列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T18:01:00.587

我通过使用得到了预期的结果：

```
SearchQuerySet().filter(content__in=query.split()) 
```

也许这不是正确的方法，因为标记化是搜索引擎的任务，但它对我有用。

# asp.net - 从 ASP.NET 到经典 asp 的会话

> ID：14900627
> 
> 赞同：0
> 
> 时间：2013-02-15T18:01:19.960
> 
> 标签：asp.net, session, asp-classic

我有一个旧系统，不是由我用经典 ASP 开发的。我有一个新系统，由我在 ASP.NET 中开发

如何将会话变量（不是复杂类型，只是简单的字符串或 int）传递到该经典 ASP 页面？我不需要任何回报。

要在作品中添加扳手 - 如果经典 ASP 站点位于不同的域上，我该如何进行“移交”或转移？

更新：不能使用通过查询字符串传递项目或将其存储在数据库中并让经典 ASP 从数据库中读取它的选项。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T13:22:59.683

您可以使用一个经典的 asp 页面来设置会话变量，例如 post 参数。

然后从您的 asp.net 页面调用该经典的 asp 页面。

示例（不完整）session.asp：

```
if session("userIsloggedIn") = true and request.form("act") = "setSessionVar" then
    session(request.form("name")) = request.form("value")
end if 
```

当然，这是某种 hack，但我们谈论的是经典的 asp...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-22T05:19:05.843

我有一个不同的方向。我通过 cookie 交换了会话状态。添加这些方法。所以现在我没有直接调用 Session ，而是使用这些方法。

ASP.NET

```
 public static void AddSessionCookie(string key, string value)
    {
        var cookie = HttpContext.Current.Request.Cookies["SessionCookie"];
        if (cookie == null)
        {
            cookie = new HttpCookie("SessionCookie");
            cookie.Expires = DateTime.Now.AddHours(12);
            HttpContext.Current.Response.Cookies.Add(cookie);
            HttpContext.Current.Request.Cookies.Add(cookie);
        }

        HttpContext.Current.Session[key] = value;
        cookie[key] = value;
    }
    public static string GetSessionCookie(string key)
    {
        if (HttpContext.Current.Session[key] == null)
            return string.Empty;

        string cook = HttpContext.Current.Session[key].ToString();
        if (!String.IsNullOrEmpty(cook))
        {
            var cookie = HttpContext.Current.Request.Cookies["SessionCookie"];
            if (cookie == null)
            {
                cookie = new HttpCookie("SessionCookie");
                cookie.Expires = DateTime.Now.AddHours(12);
                HttpContext.Current.Response.Cookies.Add(cookie);
                HttpContext.Current.Request.Cookies.Add(cookie);
            }
            if (cookie != null)
                cookie[key] = cook;

            return cook;
        }
        return cook;
    } 
```

然后经典

```
Function AddSessionCookie(key, value)

    Response.Cookies("SessionCookie")(key)= value
Response.Cookies("SessionCookie").Expires = DATE + 1
Session(key) = value

End Function

  Function GetSessionCookie(key)

If Session(key) <> "" Then
Response.Write(Session(key))
ELSEIF Response.Cookies("SessionCookie")(key) <> "" THEN
Session(key)=Response.Cookies("SessionCookie")(key)
Set GetSessionCookie = Session(key)
End If
End Function 
```

# tomcat - 从 catalina.out 禁用 atomikos 日志记录

> ID：14900629
> 
> 赞同：1
> 
> 时间：2013-02-15T18:01:29.613
> 
> 标签：tomcat, logging, atomikos

我想将 atomikos 日志级别设置为高于 INFO。Tomcat 的 catalina.out 日志文件写入了许多 INFO 消息，导致事务需要很长时间才能完成。

在启动期间，catalina.out 包含：

```
18:11:51,481  INFO [main] AbstractUserTransactionService:16 - USING com.atomikos.icatch.console_log_level = WARN 
```

在事务期间，以下内容多次写入 catalina.out。

```
18:12:05,072  INFO [http-8080-1] CompositeTransactionImp:16 - registerSynchronization ( com.atomikos.jdbc.AtomikosConnectionProxy$JdbcRequeueSynchronization@7b60ad0 ) for transaction 127.0.0.1.tm0000100018  
18:12:05,072  INFO [http-8080-1] AtomikosConnectionProxy:16 - atomikos connection proxy for Pooled connection wrapping physical connection org.postgresql.jdbc4.Jdbc4Connection@37955233: calling prepareStatement...  
18:12:05,073  INFO [http-8080-1] AtomikosConnectionProxy:16 - atomikos connection proxy for Pooled connection wrapping physical connection org.postgresql.jdbc4.Jdbc4Connection@37955233: isClosed()...  
18:12:05,073  INFO [http-8080-1] AtomikosConnectionProxy:16 - atomikos connection proxy for Pooled connection wrapping physical connection org.postgresql.jdbc4.Jdbc4Connection@37955233: calling getWarnings...  
18:12:05,073  INFO [http-8080-1] AtomikosConnectionProxy:16 - atomikos connection proxy for Pooled connection wrapping physical connection org.postgresql.jdbc4.Jdbc4Connection@37955233: calling clearWarnings...  
18:12:05,073  INFO [http-8080-1] AtomikosConnectionProxy:16 - atomikos connection proxy for Pooled connection wrapping physical connection org.postgresql.jdbc4.Jdbc4Connection@37955233: close()... 
```

我尝试在 conf/logging.properties 中将 atomikos 级别设置为 WARN，但仍在写入 INFO 日志。我什至从 logging.properties 中删除了 ConsoleHandler，但 catalina.out 仍在被写入。

在我的 webapp 目录中，我更新了 log4j.xml 以包含以下内容，但仍然获取日志。

```
<logger name="com.atomikos">
    <level value="ERROR"/>
</logger> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T14:25:56.810

在 Atomikos 3.7 中，设置以下系统属性：

```
com.atomikos.icatch.console_log_level=WARN 
```

有关所有 Atomikos JTA 属性，请参阅[此链接](http://www.atomikos.com/pub/Documentation/Tomcat7Integration35/jta.properties)

从 Atomikos 3.8 开始，与 log4j 的集成通过 SLF4j 得到了很大改进。

请参阅[配置日志](http://www.atomikos.com/Documentation/ConfiguringTheLogs)

# html - 时事通讯的圆角表样式

> ID：14900632
> 
> 赞同：1
> 
> 时间：2013-02-15T18:01:40.853
> 
> 标签：html, css

我有一个新闻信函程序，它有一个带边框的表格，但我正在尝试使边框具有圆形边缘。出于某种原因，当我添加“border-radius: 20px;”时 它不起作用。

```
<table style="border-radius: 20px;  order-color: #000000; border-width: 1px; width: 680px;" border="1" cellpadding="5" rules="none" align="center"> 
```

我不能有一个单独的样式表。它只显示一个标准的方形边框。也许我做错了，我不擅长 html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:14:30.297

默认情况下，`table`设置为`display: table;`。将其更改为`display: block;`并添加`border-collapse: seperate;`

例子：

```
 <table style="border-radius: 20px;  border-color: #000000; border-width: 1px; width: 680px; display: block; border-collapse: separate;" border="1" cellpadding="5" rules="none" align="center"> 
```

**jsfiddle：http: [//jsfiddle.net/57we8/](http://jsfiddle.net/57we8/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:05:53.957

试试这个 CSS

```
    身体 {
      边距：30px；
    }
    桌子 {
      边框折叠：分开；
      边框间距：0；
      最小宽度：350px；
    }
    表 tr th，
    表 tr td {
      右边框：1px 实心#bbb；
      边框底部：1px 实心#bbb；
      填充：5px；
    }
    表 tr th:first-child,
    表 tr td:first-child {
      左边框：1px 实心#bbb；
    }
    表 tr th {
      背景：#eee;
      边框顶部：1px 实心#bbb；
      文本对齐：左；
    }

    /* 左上边框半径 */
    表 tr:first-child th:first-child {
      边框左上角半径：6px；
    }

    /* 右上角边框半径 */
    表 tr:first-child th:last-child {
      边框右上角半径：6px；
    }

    /* 左下边框半径 */
    表 tr:last-child td:first-child {
      边框左下角半径：6px；
    }

    /* 右下边框半径 */
    表 tr:last-child td:last-child {
      边框右下角半径：6px；
    }

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:12:15.637

在你的 CSS 中试试这个：

```
-webkit-border-radius: 10px;
-moz-border-radius: 10px;
border-radius: 10px; 
```

然后考虑在 IE 中包含 PIE.htc ( [http://css3pie.com/](http://css3pie.com/) ) 或类似的东西：

```
*behavior:url(PIE.htc); /* shows in IE7 and below */
_behavior:url(PIE.htc); /* shows in IE6 and below */ 
```

# php - Symfony2 添加要为开发环境运行的命令

> ID：14900640
> 
> 赞同：3
> 
> 时间：2013-02-15T18:02:01.917
> 
> 标签：php, symfony

如何让 Symfony2 在 Dev 环境中每次加载页面时运行某些命令？

我们使用 TypeScript，我已经构建了一个命令，它将获取我所有的 TypeScript 并编译它。唯一的问题是，每次我上传一些新代码时我都必须手动执行此操作，这会在调试时减慢速度（尽管我在生产环境中这样做非常好）。

我希望它在每次页面加载时调用该命令（如果某些文件自上次编译后发生了更改......我将构建所有逻辑）。我只需要知道我应该挂在哪里。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:59:33.353

如果您打算使用 Symfony 编译您的 TypeScript，我会尝试使用[事件监听器](http://symfony.com/doc/current/cookbook/service_container/event_listener.html)

您可以尝试这样的事情（未经测试）：

向文件中添加服务，`config_dev.yml`以便监听器仅在开发环境中运行

```
# app/config/config_dev.yml 
services:        
      compileTypeScript:
        class: myApp\TypescriptBundle\Controller\TypescriptComiler
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest, priority: 64 } 
```

我不确定优先级是如何工作的，但 64 似乎达到了我的最佳选择。

创建上面引用的类并添加代码以编译 TypeScript。

```
//Class
class TypescriptCompiler extends controller
{
    public function onKernelRequest(GetResponseEvent $event)
    {       
        // compile your TypeScript here
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T19:33:28.353

与其每次都使用 Symfony 编译（慢），不如设置一个[grunt.js](http://gruntjs.com) [监视任务](https://github.com/gruntjs/grunt-contrib-watch)来监视文件，然后在每次发生更改时编译。为此，您必须熟悉在开发系统上设置[node.js。](http://nodejs.com)总而言之，我觉得将客户端和服务器完全解耦是一种不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T16:44:22.217

我们正在考虑在进行产品部署时触发 grunt - 以执行优化。

Dev 使用原始文件和客户端实现。

# javascript - HTML5 如何使画布不拉伸页面？

> ID：14900644
> 
> 赞同：0
> 
> 时间：2013-02-15T18:02:20.640
> 
> 标签：javascript, html, css, canvas, stretch

我已经学会了如何在 HTML5 中使用画布，我有一个问题。

有没有办法让画布不拉伸页面上的其他元素？例如我有一些文本，如果我放置一个 500px 宽的画布，文本被发送到右侧为画布腾出空间，有没有办法将画布放在文本下面或者只是让它不拉伸其他元素在页面中，或者是否只是一种用于以某种方式适当定位画布的技术，以便它位于您想要的位置？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:08:38.540

就像对待 div 一样对待画布。调整 div 的大小/位置的方式，你可以对画布做同样的事情。如果您在调整画布时遇到特定问题，请发布您正在使用的代码。

编辑：另外，如果您使用 CSS 设置画布高度/宽度，请小心，因为它只会更改元素大小，而不是绘图表面大小。要确保元素和绘图表面大小都发生变化，请使用 width 和 height 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:04:14.413

您应该在画布元素中包含**宽度**和**高度**属性。

```
canvas.width  = 600;
canvas.height = 600; 
```

如果您想自动适应屏幕，请参阅下面的问题
[Resize HTML5 canvas to fit window](https://stackoverflow.com/questions/1664785/html5-canvas-resize-to-fit-window)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T18:06:41.543

使用 css 样式的 z-index 使您的文本位于画布上方。

示例 CSS：

```
#canvas_id
{
position:absolute;
width: 100px;
height: 100px;
top: 100px;
left: 100px;
z-index:-1;
}
#text_div
{
position:absolute;
width: 100px;
height: 100px;
top: 100px;
left: 100px;
z-index:0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:04:38.980

画布是一个[流程元素](http://www.w3.org/TR/html-markup/common-models.html)。您可以像使用其他流元素一样定位它，例如 div。它具有[默认尺寸（300 x 300）](http://www.w3.org/TR/2012/WD-html5-author-20120329/the-canvas-element.html#the-canvas-element)，但在其他方面表现得更像一个 div。

要进入下一行，您可以这样做：

```
aaa
<br>
<canvas id=a></canvas> 
```

CSS 有很多可能性（与所有流元素一样），很难一一列举。

# android - 用于 Android 开发的微调器

> ID：14900657
> 
> 赞同：-1
> 
> 时间：2013-02-15T18:03:27.623
> 
> 标签：android

我已经按照 android 网站上的指南创建了一个微调器。我已经完全复制了代码，但仍然出现以下错误：

> 令牌“setDropDownViewResource”的语法错误，此令牌后应有标识符

,

> 令牌“。”的语法错误，...预期

,

> 标记的语法错误，错误的构造

,

> 令牌“适配器”上的语法错误，此令牌后应为 VariableDeclaratorId

如果有人可以帮助我解决这些问题可能是什么，将不胜感激。

我已经展示了下面的代码。

```
 package com.example.myfirstapp;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.Spinner;

public class MainActivity extends Activity {
    public final static String EXTRA_MESSAGE = "com.example.myfirstapp.MESSAGE";
    public final static String EXTRA_MESSAGE_COLOR = "com.example.myfirstapp.MESSAGE2";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }  

    Spinner spinner = (Spinner) findViewById(R.id.spinner);
 // Create an ArrayAdapter using the string array and a default spinner layout
 ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
         R.array.color_array, android.R.layout.simple_spinner_item);
 // Specify the layout to use when the list of choices appears
 adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
 // Apply the adapter to the spinner
 spinner.setAdapter(adapter);

/** Called when the user clicks the Send button */
public void sendMessage (View view)   {
    Intent i = new Intent(this, DisplayMessageActivity.class);
    EditText editText = (EditText) findViewById(R.id.edit_message);
    //EditText editTextcolor = (EditText) findViewById(R.id.edit_message_color);
    String message = editText.getText().toString();
    //String messagecolor = editTextcolor.getText().toString();
    Bundle extras = new Bundle();
    extras.putString(EXTRA_MESSAGE, message);
    //extras.putString(EXTRA_MESSAGE_COLOR, messagecolor );
    i.putExtras(extras);
    startActivity(i);

}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:15:34.257

你有没有像这个例子那样做

```
public class MySpinner extends Activity {
public void onCreate(Bundle b){

// make sure that you have set the content view
setContentView(R.id.layout);
Spinner spinner = (Spinner) findViewById(R.id.building);

// Create an ArrayAdapter using the string array and a default spinner layout
ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
        R.array.buildings_array, android.R.layout.simple_spinner_item);

// Specify the layout to use when the list of choices appears
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

// Apply the adapter to the spinner
spinner.setAdapter(adapter);
super.onCreate(b);
}
} 
```

你的活动代码是这样的吗……

# javascript - javascript 聊天框/信使脚本

> ID：14900658
> 
> 赞同：1
> 
> 时间：2013-02-15T18:03:30.620
> 
> 标签：javascript, css

我正在尝试编写一个类似聊天框的 facebook，但我遇到了一个小问题。我正在使用以下代码（它只是测试代码，所以它不是很干净）：

CSS代码：

```
#messenger {
  position: fixed;
  bottom: 0px;
  right: 10px;
  width: 200px;
  height: 300px;
  z-index: 4;
  background-color: #ECECEC;
  border: 1px solid #000;
}
#messenger.p {
  text-align: right;
}
#contacts {
  margin: 5px 5px 5px 5px;
}
#chatspace {
  position: fixed;
  bottom: 0px;
  right: 240px;
  height: 20px;
  left: 20px;
  background-color: #ECECEC;
  border: 1px solid #000;
  z-index: 4;
}
.chatbox {
  position: absolute;
  bottom: 0px;
  width: 200px;
  height: 200px;
  z-index: 4;
  background-color: #ECECEC;
  border: 1px solid #000;
} 
```

html/javascript 代码：

```
<script type="text/javascript">
var i = 0;

function oc_chatbox() {

  if (i == 0) {
  document.getElementById('contacts').style.visibility = 'hidden';
  document.getElementById('messenger').style.height = '20px';
  i = 1;
  }

  else {
  document.getElementById('contacts').style.visibility = 'visible';
  document.getElementById('messenger').style.height = '300px';
  i = 0;
  }
}

function new_chat(userid) {
  var new_right;
  new_right = document.getElementById('messenger').style.right;
  //alert('old value: '+ new_right);
  new_right += 20;
  //alert('New value of right: '+ new_right);
  document.getElementById('chatspace').innerHTML = '<div id="'+userid+'" class="chatbox" style="right: '+new_right+'px;"></div>';
  //document.write('<div id="'+userid+'" class="chatbox" style="right: '+new_right+'px;"></div>');
}
</script>
<div id="chatspace"></div>
<div id="messenger">
 <p><a href="#" onclick="oc_chatbox();">Collapse</a></p>
 <div id="contacts">
 <ul>
  <li><a href="#" onclick="new_chat('contact_a');">contact A</a></li>
 </ul>
 </div>
</div> 
```

问题是，当我尝试向聊天栏添加新聊天时，我似乎无法将它们放在一起。谁能帮忙？

编辑：

所以我将javascript代码更改为：

```
var last = null;
function new_chat(userid) {
  if(userid==null)
    userid = "user666";
  var new_right;
  var margin = 10;
  var messenger = window.last==null?document.getElementById('messenger'):window.last;  //Take the messenger or the last added chat
  new_right = document.body.clientWidth-messenger.offsetLeft;      //Compute the window size
  console.log(new_right);                                //Log the number
  new_right += margin;                                   //keep spaces between divs

  var newChat = document.createElement("div");           //DOM create DIV
  newChat.id = userid;
  newChat.className = "chatbox shadow";
  newChat.style.right = new_right+"px";
  newChat.innerHTML = '<p>'+userid+'</p><p><textarea></textarea></p>';
  window.last = newChat;  //Remember whichever is last
  document.body.appendChild(newChat);
} 
```

现在它可以工作了，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:16:50.297

您应该尝试添加浮动样式。

```
.chatbox {
  float: right;
} 
```

将其添加到您的聊天框样式中。您可能需要稍微弄乱一下，以确保浮动不会与您的其他元素混淆。您可能需要一个更好的容器来存放它们。

如果你想获得真正的乐趣，你可以从 jQuery 中添加 .draggable()，然后你可以让它们捕捉到你的聊天栏。然后，您可以更改聊天的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:22:18.727

除非样式已设置且有效，否则您无法使用其样式获得元素的右偏移量。相反，您必须获取`element.offsetLeft`窗口区域的大小并执行以下操作：

```
new_right = windowSize()[0]-messenger.offsetLeft; 
```

其中窗口大小是[这个函数。](http://www.howtocreate.co.uk/tutorials/javascript/browserwindow)

这是您的功能的我的工作版本：

```
var last = null;
function new_chat(userid) {
  if(userid==null)
    userid = "user666";
  var new_right;
  var margin = 20;
  var messenger = window.last==null?document.getElementById('messenger'):window.last;  //Take the messenger or the last added chat
  new_right = windowSize()[0]-messenger.offsetLeft;      //Compute the window size
  console.log(new_right);                                //Log the number
  new_right += margin;                                   //keep spaces between divs

  var newChat = document.createElement("div");           //DOM create DIV
  newChat.id = userid;
  newChat.className = "chatbox";
  newChat.style.right = new_right+"px";
  window.last = newChat;  //Remember whichever is last
  document.body.appendChild(newChat);
} 
```

如果`console`未在您的浏览器中定义，您可能会收到错误。但在这种情况下，您应该使用更好的浏览器。通常，将`if(console!=null)`放在代码中。
[这是链接。](http://u8.8u.cz//crap/fblikechat.html)

# c - C中的算术不计算

> ID：14900665
> 
> 赞同：0
> 
> 时间：2013-02-15T18:03:51.280
> 
> 标签：c

我有这段代码可以计算员工工资的月税。当我运行它时，一切似乎都运行良好，直到 if 子句中的点。

如果我将 basicSalary 提供为 50000 并将所有其他输入值提供为 0，那么当应在 4000 左右时，monthlyTax 数字会变为零。

谁能解释我为什么会这样？

```
#include <stdio.h>

int main()
{
    int basicSalary, allowances, transportAllowance, numberOfDependants, deduction;
    float monthlyTax, income;

    printf("Enter Basic Salary Amount: ");
    scanf("%d", &basicSalary);

    printf("\nEnter Allowances Amount: ");
    scanf("%d", &allowances);

    printf("\nEnter transportAllowance Amount: ");
    scanf("%d", &transportAllowance);

    printf("\nEnter Number Of Dependants: ");
    scanf("%d", &numberOfDependants);

    switch (numberOfDependants)
    {
           case 0:
                deduction = 215000;
                break;
           case 1:
                deduction = 325000;
                break;
           case 2:
                deduction = 415000;
                break;
           case 3:
                deduction = 475000;
                break;
           default:
                   printf("Number Of Dependants Can Only Be Between 0 - 3, Enter A Proper Value.");
                   return 1;
    }

    income = basicSalary * 13 + allowances + (transportAllowance - 6800) * 12 - deduction;

    if (income < 500000)
    {
        monthlyTax = ((15/100) * (income/12));
    }
    else
    {  
        monthlyTax = ((15/100) * (500000/12)) + ((30/100) * ((income-500000)/12));
    }

    monthlyTax = monthlyTax/12;

    printf("\nMothly Tax Amount is %f", monthlyTax);
    getch();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T18:06:25.720

在 C 中，`15 / 100`等于`0`，因为它是*整数除法*。

原作者的意思大概是浮点除法`15.0 / 100.0`。

一般来说，浮点计算中隐含的所有常量也应该是浮点类型的（即，有`.0`附加的），除非你真的知道你在做什么。为了安全起见，这适用于所有数字，而不仅仅是部门中的数字。

如果它们不是常量而是整数变量，则可能需要强制转换：

```
(float)basicSalary ... 
```

顺便说一句，许多变量，例如`basicSalary`，也应该是 类型`float`。

作为最后的建议，除非您有特殊需要，否则通常建议默认使用`double`而不是到处使用。`float`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:07:13.700

这是由整数除法引起的

```
monthlyTax = ((15/100) * (income/12)); 
```

在这里，15/100 的计算结果不是 0.15，而是 0（去掉了小数部分）。

更改公式以使用浮点值：

```
monthlyTax = ((15/100.f) * (income/12.f)); 
```

或者

```
monthlyTax = ((15/100.0) * (income/12.0)); 
```

# c# - Windows Phone 列表不显示数据

> ID：14900666
> 
> 赞同：2
> 
> 时间：2013-02-15T18:03:54.267
> 
> 标签：c#, .net, windows-phone-7, xaml, windows-phone-7.1

我有以下用于测试的代码，如何输入到列表中。这些项目存在于列表中，但未显示。

```
public MyFellows()
    {
        InitializeComponent();
        List<Fellow> fellowList = new List<Fellow>();
        for (int i = 0; i < 2; i++)
        {
            Fellow fellow = new Fellow();
            fellow.Name = "Danish " + i;
            fellow.Email = "Email " + i;
            fellowList.Add(fellow);
        }
        lbFellows.ItemsSource = null;
        lbFellows.ItemsSource = fellowList;
    }

    private class Fellow
    {
        public string Name { get; set; }
        public string Email { get; set; }
    } 
```

并且正在使用以下 xaml

```
<ListBox x:Name="lbFellows" Margin="8,8,8,177">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Vertical" Width="Auto" Height="300">
                        <TextBlock x:Name="tbName" Width="Auto" FontSize="22" FontWeight="Bold" Text="{Binding Name}" />
                        <TextBlock x:Name="tbEmail" Width="Auto" FontSize="22" Height="Auto" Text="{Binding Email}"/>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:14:16.053

首先，WPF 仅绑定到属性，并且该属性必须存在于对象的 DataContext 中。

您必须像这样更改代码：

```
public List<Fellow> fellowList { get; set; }
// Constructor
public MainPage()
{
    InitializeComponent();

    fellowList = new List<Fellow>();
    for (int i = 0; i < 2; i++)
    {
        Fellow fellow = new Fellow();
        fellow.Name = "Danish " + i;
        fellow.Email = "Email " + i;
        fellowList.Add(fellow);
    }
    this.DataContext = this;
    //lbFellows.ItemsSource = null;
    lbFellows.ItemsSource = fellowList;
}

public class Fellow
{
    public string Name { get; set; }
    public string Email { get; set; }
} 
```

# android - 我必须修复一个错误 nullpointerexception

> ID：14900667
> 
> 赞同：1
> 
> 时间：2013-02-15T18:03:55.470
> 
> 标签：android, android-asynctask, nullpointerexception, wallpaper

我有一个仅出现在 froyo 设备中的错误

Bitmap.createScaledBitmap() 中的空指针异常

```
java.lang.RuntimeException: An error occured while executing doInBackground()
at android.os.AsyncTask$3.done(AsyncTask.java:200)
at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019)
Caused by: java.lang.NullPointerException
at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:344)
at com.varxstudio.beautifulwallpapersLite.Imagen.a(Unknown Source)
at com.varxstudio.beautifulwallpapersLite.g.a(Unknown Source)
at com.varxstudio.beautifulwallpapersLite.g.doInBackground(Unknown Source)
at android.os.AsyncTask$2.call(AsyncTask.java:185)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306) 
```

这是代码任何解决方案吗？为什么只在froyo？？？以前只使用 BitmapFactory.decodeStream(inputStream) 来加载图像，但我找到了一个flusedInputStream方法来做到这一点，但我仍然得到同样的错误

```
private class DownloadDialog extends AsyncTask<Void, Void, Void> {

    ProgressDialog myDialog = null;
    int result = 0;

    @Override
    protected void onPreExecute() {
        myDialog = ProgressDialog.show(Imagen.this, "", advert);
        myDialog.setCancelable(true);
        return;
    }

    @Override
    protected Void doInBackground(Void... params) {
        result = setWallpaper(path);

        return null;
    }

    @Override
    protected void onPostExecute(Void result) {
        myDialog.dismiss();
        switch (result){
            ----
        }
        return;
    }
}

public int setWallpaper(String path) {          
    int width, height;
    Bitmap dbm, bm;         
    bm = null;
    dbm = null; 
    InputStream is = null;

    WallpaperManager wpm = WallpaperManager.getInstance(this);
    dis = getWindowManager().getDefaultDisplay();           

    if((wpm != null) && (dis != null)){ 
        height = dis.getHeight();
        width = (int) (height * 1.33);              

        try {           
            URLConnection conn = new URL(path).openConnection();                
            conn.connect();             
            is = conn.getInputStream();             

            if (is != null) {                   
                bm = BitmapFactory.decodeStream(new FlushedInputStream(is));                    
                dbm = Bitmap.createScaledBitmap(bm, width, height, false);
                wpm.setBitmap(dbm);                 
            }else {
                return 2;
            }

        } catch (MalformedURLException e) {                 
            e.printStackTrace();                
        } catch (IOException e) {               
            e.printStackTrace();                
        } finally {             
            if (is != null) {
                try {
                    is.close();
                }
                catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }           
        if(bm != null){
            bm.recycle();
        }
        if(dbm != null){
            dbm.recycle();  
        }           
    }else {
        return 1;
    }
    return 0;
}

static class FlushedInputStream extends FilterInputStream {
    public FlushedInputStream(InputStream inputStream) {
        super(inputStream);
    }

    @Override
    public long skip(long n) throws IOException {
        long totalBytesSkipped = 0L;
        while (totalBytesSkipped < n) {
            long bytesSkipped = in.skip(n - totalBytesSkipped);
            if (bytesSkipped == 0L) {
                int b = read();
                if (b < 0) {
                    break;  // we reached EOF
                } else {
                    bytesSkipped = 1; // we read one byte
                }
            }
            totalBytesSkipped += bytesSkipped;
        }
        return totalBytesSkipped;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:39:21.270

你有 NullPointerException 因为 `BitmapFactory.decodeStream(new FlushedInputStream(is));`返回 null，返回 null 的原因`BitmapFactory.decodeStream(stream)`是因为图像不好。从某种意义上说，坏图像确保你返回的是 Android 支持的位图格式，（示例`Android doesn't support tiff`）。第二个原因是因为图像分辨率，如果图像分辨率太高解码失败..所以确保你有小图像。

这是我在 SO 中发布的关于同一问题的问题。[使用 BitmapFactory.decodeArray 创建位图失败](https://stackoverflow.com/questions/14681643/image-isnt-creating-using-the-bitmapfactory-decodebytearray)

我之前也遇到过同样的问题，但我已经通过使用 Android 开发人员网站提供的 [高效显示位图的教程解决了这个问题](http://developer.android.com/training/displaying-bitmaps/index.html)

# matlab - MATLAB：从矩阵中获取具有条件的 k 个随机下标

> ID：14900668
> 
> 赞同：0
> 
> 时间：2013-02-15T18:03:55.760
> 
> 标签：matlab, random, indexing

我想从给定一组下标的文件中获取当前加载数据的 C++ 程序中的`k`随机下标。`A`

我有一个双值矩阵和一个`MxN`整数从 0 到 20的矩阵。`A``Mx1``B`

我怎样才能从条件中获取`k`随机下标？例如，给定：`A``B`

```
A = [ 0.25 0.25 0.25 0.25
      0.18 0.18 0.18 0.18 
      0.36 0.36 0.36 0.36 
      0.51 0.51 0.51 0.51 ]

B = [ 0 
      1
      2
      1 ] 
```

我正在尝试从if获取`k = 1`随机行下标。所以，我正在寻找or 。`i``A``B(i) == 1``i == 1``i == 4`

我尝试首先创建一个逻辑索引：

```
idx = B == 1; 
```

然后，从`A`具有该条件的元素中获取如下：

```
r = A( idx, : ); 
```

最后，对`r`to 进行排列以获得`k`行：

```
randperm( size(r) ) 
```

但我现在卡住了，因为我不知道如何将排列转换为矩阵`A`。

我也试图理解这个函数`[I,J] = ind2sub(siz,IND)`，但现在不知道如何将下标与随机排列结合起来。此外， 的结果`randperm( size(r) )`与 的大小有关`r`。

那么，我怎样才能从条件中获取`k`随机下标？这个想法是使用 C++ 程序中的下标作为输入参数`A``B`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:22:24.893

您可以获得相关的行号，如下所示：

```
nrs=1:length(idx);
nrs=nrs(idx); 
```

现在排列它们：

```
nrs_permidx = randperm(length(nrs))
permuted = nrs(nrs_permidx) 
```

我想你可以从这里拿走它。

# java - 如何修复它：com.microsoft.sqlserver.jdbc.SQLServerException？

> ID：14900675
> 
> 赞同：0
> 
> 时间：2013-02-15T18:04:31.150
> 
> 标签：java, sql-server

我想连接到 sql server express。我下载[了这个](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=11774)驱动。我阅读了帮助文件，这是我的代码：

```
 try 
        {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            String connectionUrl = "jdbc:sqlserver://localhost;database=ActorsDb;integratedSecurity=true;";
            Connection con = DriverManager.getConnection(connectionUrl);
            PreparedStatement st = con.prepareStatement("INSERT INTO Actors(FirstName,LastName,Age) VALUES(?,?,?)");
            st.setString(1, "Robert");
            st.setString(2, "de Niro");
            st.setInt(3,45);
            st.executeUpdate();     
            con.close();
        } 
        catch (SQLException | ClassNotFoundException e) 
        {
            e.printStackTrace();
        } 
```

我得到这个例外：`com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection to the host localhost, port 1433 has failed. Error: "Connection refused: connect. Verify the connection properties. Make sure that an instance of SQL Server is running on the host and accepting TCP/IP connections at the port. Make sure that TCP connections to the port are not blocked by a firewall.".`

我关闭了防火墙，但没有任何改变。

1.  我去了 SQL Server 配置管理器并启用了 TCP/IP

2.  我去了IP地址，IP1并设置属性

主动：是；启用：是；TCP 动态端口：[空] ; TCP 端口：1433

关于我所缺少的任何提示？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:07:44.220

检查 SQL Server 服务是否正在运行，并检查是否有任何程序（如防病毒）阻止连接。如果是这样，请禁用它们或向该连接添加例外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:08:56.483

您在 JDBC URL 中使用 localhost，请尝试使用您在 SSCM 中描述的“IP1”的 IP 地址。或者，验证 SSCM 是否配置为侦听 localhost:1433。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T22:49:13.427

问题解决了。我不得不将 sqljdbc_auth.dll 复制到工作目录中。

# android - 我的自定义视图控件不在片段中重绘

> ID：14900676
> 
> 赞同：1
> 
> 时间：2013-02-15T18:04:36.053
> 
> 标签：android, view, ondraw, invalidation

我创建了从控件扩展的自定义视图控件`View`，仅在方法中绘制了一些信息`onDraw`。

如果我在常规活动布局上创建控件，一切正常。但是，如果我在 Fragment 中创建此控件`onCreateView()`，它会在创建时进行绘制，然后我的视图“冻结”。它可以工作并解决但不调用`onDraw()`. 我想打电话`invalidate()`，但什么也没有。

有任何想法吗？

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)     {       
    final View v = inflater.inflate(R.layout.button, container, false);
    mAgatButton = (agatButton) v.findViewById(R.id.agatButton1);
    mAgatButton.setOnClickListener(new OnClickListener() {      
        @Override
        public void onClick(View view) {
            // This not Repainted           
            final GraphViewSeries TahoSer = mGraphTaho.getSeries((byte)0);
            mGraphTahoPos++;
            TahoSer.appendData(new GraphViewData(mGraphTahoPos, 50d), true);            
            //This Work correct
            mTahoLabel.setText(String.format(getString(R.string.button_rpm), (int)(Math.random()*1000)));

            Log.d(agatButton.class.toString(),"Click Detected: "+TahoSer.size());
        }
    });
    final Context context = getActivity().getApplicationContext();

    LinearLayout graphView = (LinearLayout) v.findViewById(R.id.graph_lay_taho);
    graphView.addView(mGraphTaho = getGraphView(context,"Taho"));

    mTahoLabel = (TextView) v.findViewById(R.id.tahoText);
    mTahoLabel.setText(String.format(getString(R.string.button_rpm), 0));

    return v;
}

private GraphView getGraphView(Context context, String Name)
  {
     final GraphView tmpView = new LineGraphView(context,Name);  
     tmpView.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.MATCH_PARENT));

     List<GraphViewData> initalSeriesData = new ArrayList<GraphViewData>();
     for (byte i=0;i<20;i++)
         initalSeriesData.add(new GraphViewData(i, 0d));

     final GraphViewSeries tahoSeries = new GraphViewSeries(initalSeriesData);

     ((LineGraphView) tmpView).setDrawBackground(true);
     tmpView.addSeries(tahoSeries);
     tmpView.setViewPort(1, 20);
     tmpView.setScalable(false);
     tmpView.setManualYAxis(true);
     tmpView.setManualYAxisBounds(100, 0);

     return tmpView;
  } 
```

如果我不使用 Fragment 一切正常。怎么了？

# php - 以下函数在 PHP 中的作用是什么？

> ID：14900683
> 
> 赞同：2
> 
> 时间：2013-02-15T18:04:54.457
> 
> 标签：php, arrays

```
private static function quote($str)
{
    return '"' . $str . '"';
} 
```

这也意味着什么？

```
$args = array_map(array($this, 'quote'), $args); 
```

我是 PHP 新手，正在尝试通过别人的源代码找出我的方法。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:05:27.327

它为数组中的所有值添加引号。

# ember.js - Ember js 如何使用 DS.FixtureAdapter 设置控制器的模型？

> ID：14900686
> 
> 赞同：1
> 
> 时间：2013-02-15T18:05:03.067
> 
> 标签：ember.js, ember-data

如何正确设置控制器的型号？

这是我的代码（出现错误）：

```
<script>
   window.App = Ember.Application.create();

   App.Store = DS.Store.extend({
    revision: 11,
    adapter: 'DS.FixtureAdapter'
   });

   App.ApplicationRoute = Ember.Route.extend({
    setupController: function() {
     this.controllerFor('topic').set('model', App.Topic.find());
    }
   });

   App.Topic =  DS.Model.extend({
    label: DS.attr('string'),
    selected: DS.attr('boolean')
   });

   App.Topic.FIXTURES = [
     { id: 1, label: '1\. First topic', selected: true },
     { id: 2, label: '2\. Second topic' },
     { id: 3, label: '3\. Third topic' },
   ];

   App.TopicController = Ember.ArrayController.extend();

   App.IndexController = Ember.ObjectController.extend({
    content: [],
    test: 'INDEX TEST',
    currentTopics: null
   });
</script> 
```

模板（试图将 TopicController 绑定到 Ember.Select 视图）

```
<script type="text/x-handlebars" data-template-name="index">

  {{view Ember.Select
     contentBinding="App.TopicController"
     selectionBinding="currentTopics"
     optionLabelPath="content.label"
     optionValuePath="content.id"}}

</script> 
```

**版本：** ember 1.0.0-pre4 ember-data 修订版 11

[提琴手](http://jsfiddle.net/aFPy7/3/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:39:09.060

[**这里**](https://github.com/emberjs/ember.js/issues/2007)有一个关于这个的讨论，但是到目前为止，Ember 控制器使用别名`content`for `model`，所以你`setupController`应该是：

```
App.ApplicationRoute = Ember.Route.extend({
  setupController: function() {
    this.controllerFor('topic').set('content', App.Topic.find());
  }
}); 
```

此外，您可以查看**[使用](http://jsfiddle.net/schawaska/dWcUp/)**`FixtureAdapter`. 请记住，这是一项正在进行的工作，我会在找到时间时对其进行更新。

[http://jsfiddle.net/schawaska/KjWKw/](http://jsfiddle.net/schawaska/KjWKw/)

# mongodb - mongodb服务器名是怎么选的？

> ID：14900687
> 
> 赞同：1
> 
> 时间：2013-02-15T18:05:04.420
> 
> 标签：mongodb

```
~$ mongo
MongoDB shell version: 2.2.3
connecting to: test
> 
```

为什么是我的服务器名称`test`？我在哪里可以改变它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:50:38.407

“测试”是默认数据库。您可以在 use 命令的帮助下更改当前数据库。

**使用** *新数据库名称*

如果“NewDatabaseName”不存在，它将在 Mongo 中创建。

# google-sheets - 如何通过 Google 电子表格的 API 从其 ID 获取浏览器 URL？

> ID：14900692
> 
> 赞同：0
> 
> 时间：2013-02-15T18:05:27.177
> 
> 标签：google-sheets, google-drive-api

我正在通过 API 将 csv 文件导入 Google 电子表格，我有一个 DocumentListEntry 对象：

```
DocumentList docs = new DocumentList("test");

docs.login(adminEmail, adminPassword);
DocumentListEntry newDocs=docs.uploadFile(uploadfilepath, filename); 
```

我可以通过 newDocs.getDocId() 检索它的 id，但是如何找到要在浏览器中用作链接以打开文档的 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T01:40:44.553

您可以使用 Drive SDK API“files/get”通过 fileid 获取 web url。API 文档在这里：

[https://developers.google.com/drive/v2/reference/files/get](https://developers.google.com/drive/v2/reference/files/get)

从结果 json 文件中，有一个“alternateLink”，这正是您想要的。

# python - 枚举所有完整（标记）二叉树

> ID：14900693
> 
> 赞同：6
> 
> 时间：2013-02-15T18:05:29.697
> 
> 标签：python, algorithm, data-structures, catalan

我正在寻找一种实用的算法来枚举所有完整标记的二叉树。

完全二叉树是一棵树，其中所有内部节点的度数为 3，叶子的度数为 1，根的度数为 2。

带标签的树是所有叶子都有唯一标签的树。

例子：

```
 *
    |\
    | \
    *  *
   /|  |\
  / |  | \
 T  C  D  F 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T18:57:52.260

从评论中可以清楚地看出，问题是枚举有根无序标记的完整二叉树。正如[本文](http://ajmonline.org/2010/darwin.pdf)`n`所解释的，这种带有标签的树的数量`(2n-3)!!`是`!!`双[因子函数](http://en.wikipedia.org/wiki/Factorial#Double_factorial)。

以下python程序基于参考论文中的递归证明；我认为代码很简单，可以作为算法的解释传递：

```
# A very simple representation for Nodes. Leaves are anything which is not a Node.
class Node(object):
  def __init__(self, left, right):
    self.left = left
    self.right = right

  def __repr__(self):
    return '(%s %s)' % (self.left, self.right)

# Given a tree and a label, yields every possible augmentation of the tree by
# adding a new node with the label as a child "above" some existing Node or Leaf.
def add_leaf(tree, label):
  yield Node(label, tree)
  if isinstance(tree, Node):
    for left in add_leaf(tree.left, label):
      yield Node(left, tree.right)
    for right in add_leaf(tree.right, label):
      yield Node(tree.left, right)

# Given a list of labels, yield each rooted, unordered full binary tree with
# the specified labels.
def enum_unordered(labels):
  if len(labels) == 1:
    yield labels[0]
  else:
    for tree in enum_unordered(labels[1:]):
      for new_tree in add_leaf(tree, labels[0]):
        yield new_tree 
```

对于`n == 4`，有`(2*4 - 3)!! == 5!! == 1 * 3 * 5 == 15`树：

```
>>> for tree in enum_unordered(("a","b","c","d")): print tree
... 
(a (b (c d)))
((a b) (c d))
(b (a (c d)))
(b ((a c) d))
(b (c (a d)))
(a ((b c) d))
((a (b c)) d)
(((a b) c) d)
((b (a c)) d)
((b c) (a d))
(a (c (b d)))
((a c) (b d))
(c (a (b d)))
(c ((a b) d))
(c (b (a d))) 
```

该问题的另一种可能解释是，它寻求具有指定标签列表的有根有序完整二叉树的枚举。具有 n 片叶子的树的数量由加泰罗尼亚[数](http://en.wikipedia.org/wiki/Catalan_number)列给出。`C[n-1]`

```
def enum_ordered(labels):
  if len(labels) == 1:
    yield labels[0]
  else:
    for i in range(1, len(labels)):
      for left in enum_ordered(labels[:i]):
        for right in enum_ordered(labels[i:]):
          yield Node(left, right) 
```

对于 5 个标签，我们有：`C[5-1] == 14`

```
>>> for tree in enum_ordered(("a","b","c","d", "e")): print tree
... 
(a (b (c (d e))))
(a (b ((c d) e)))
(a ((b c) (d e)))
(a ((b (c d)) e))
(a (((b c) d) e))
((a b) (c (d e)))
((a b) ((c d) e))
((a (b c)) (d e))
(((a b) c) (d e))
((a (b (c d))) e)
((a ((b c) d)) e)
(((a b) (c d)) e)
(((a (b c)) d) e)
((((a b) c) d) e) 
```

# ios - 两个目标，两个同名的头文件如何使用每个头文件为正确的目标？

> ID：14900696
> 
> 赞同：13
> 
> 时间：2013-02-15T18:05:45.983
> 
> 标签：ios, xcode, header

好的，这就是我尝试过的。

我在两个单独的目录 IRL 中有头文件。它们的名称相同，但位于两个不同的位置。

我只想包含每个目标的相关头文件。为了便于解释，让我们说头文件称为“Config.h”。

所以我有：

> ${PRODUCT_DIR}/Header1/Config.h

和

> ${PRODUCT_DIR}/Header2/Config.h

这些文件出现在 Xcode 的 LHS 以及两个不同的组中（指向 IRL 文件夹的 Header1 和 Header2）。

所以现在我需要做的就是让 Xcode 从每个目标的正确文件夹中选择正确的。

> 目标1

和

> 目标2

我已经尝试`User Header Search Paths`为每个目标添加路径，但它仍然选择了错误的路径。我还尝试切换“始终搜索用户路径”，这似乎也没有效果。

所以我的问题是，这是因为它们在项目目录中吗？还是因为它们位于 LHS 文件管理器的 Xcode 中，因此 Xcode 将它们复制到构建文件夹中？

奇怪的是，它似乎是从姓氏字母顺序的文件夹中选择头文件...

在以前版本的 Xcode 中，我确信您可以选择将哪些标头复制到构建文件夹中。

无论如何..有谁知道我该如何解决这个问题，以便我可以让它为目标选择正确的头文件？

非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T10:00:34.287

我遇到的问题是 2 倍：

1.  您需要从项目中删除头文件。如果它们在 Xcode 中，在文件管理器中，那么它们将自动包含在项目中。

2.  您需要在“用户标题搜索路径”中使用文件夹的相对路径。我正在使用`${PROJECT_DIR}/path/to/header/folder`which 给出了正确的路径，但似乎无法正常工作。将条目改为`./path/to/header/folder`改为工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-29T14:45:01.243

我在 1 个项目中有 4 个目标和 40 多个标头，XCode 8 中的最佳解决方案我认为最好的解决方案是更改以下标签：

```
Always Search user Paths 
```

是的，对我来说一切都很好： [![在此处输入图像描述](../Images/26da105679772e511040f4a151d7c025.png)](https://i.stack.imgur.com/3o2SO.png)

# java - 为什么 SwingWorker 会意外停止？

> ID：14900697
> 
> 赞同：8
> 
> 时间：2013-02-15T18:05:49.420
> 
> 标签：java, multithreading, swing, concurrency, swingworker

我想尝试一些想法，`SwingWorker`因为我没有使用太多。相反，我遇到了一个问题，我不知道出了什么问题。

这是一个简短的[SSCCE](http://sscce.org/)演示了这个问题（我知道这里的人喜欢 SSCCE）：

```
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;

public class SwingWorkerTest
{
    public static void main (String[] args)
    {
        SwingUtilities.invokeLater (new Runnable ()
        {
            @Override
            public void run ()
            {
                new MySwingWorker (500).execute ();
                new MySwingWorker (900).execute ();
                new MySwingWorker (1200).execute ();
            }
        });
    }
}

class MySwingWorker extends SwingWorker<Void, Void>
{
    private int ms;

    public MySwingWorker (int ms)
    {
        this.ms = ms;
    }

    @Override
    protected Void doInBackground()
    {
        Thread t = Thread.currentThread ();

        for (int i = 0; i < 50; i++)
        {
            try
            {
                Thread.sleep (ms);
            }
            catch (InterruptedException e)
            {
                e.printStackTrace ();
            }

            System.out.println ("I am thread with " + ms + " sleep in iteration " + i + ": " + t.getName () + " (" + t.getId () + ")");
        }

        return null;
    }
} 
```

所以我的程序应该创建 3 个 SwingWorker，它们在屏幕上打印一行，然后休眠指定的毫秒数，然后再次打印该行并再次休眠等。我`SwingWorker`从 Swing 的线程中创建 s，否则它们甚至不会启动。

所以预期的输出是：

```
I am thread with 500 sleep in iteration 0: SwingWorker-pool-1-thread-1 (15)
I am thread with 900 sleep in iteration 0: SwingWorker-pool-1-thread-2 (16)
I am thread with 500 sleep in iteration 1: SwingWorker-pool-1-thread-1 (15)
I am thread with 1200 sleep in iteration 0: SwingWorker-pool-1-thread-3 (17)
I am thread with 500 sleep in iteration 2: SwingWorker-pool-1-thread-1 (15)
I am thread with 900 sleep in iteration 1: SwingWorker-pool-1-thread-2 (16)
I am thread with 500 sleep in iteration 3: SwingWorker-pool-1-thread-1 (15)
I am thread with 1200 sleep in iteration 1: SwingWorker-pool-1-thread-3 (17)
I am thread with 500 sleep in iteration 4: SwingWorker-pool-1-thread-1 (15)
I am thread with 900 sleep in iteration 2: SwingWorker-pool-1-thread-2 (16)
I am thread with 500 sleep in iteration 5: SwingWorker-pool-1-thread-1 (15)
I am thread with 500 sleep in iteration 6: SwingWorker-pool-1-thread-1 (15)
I am thread with 900 sleep in iteration 3: SwingWorker-pool-1-thread-2 (16)
I am thread with 1200 sleep in iteration 2: SwingWorker-pool-1-thread-3 (17)
I am thread with 500 sleep in iteration 7: SwingWorker-pool-1-thread-1 (15)
............. 
```

依此类推，总共 150 行（3 个工作人员 x 50 次迭代）

相反，我得到的输出是：

```
I am thread with 500 sleep in iteration 0: SwingWorker-pool-1-thread-1 (15)
I am thread with 900 sleep in iteration 0: SwingWorker-pool-1-thread-2 (16)
I am thread with 500 sleep in iteration 1: SwingWorker-pool-1-thread-1 (15) 
```

就是这样。就3行。之后程序退出。该`try catch`块的任何地方都没有堆栈跟踪。

**1）。**睡眠时间为 1200 毫秒的工人在哪里？实际上，如果我用 1000 毫秒替换 1200 毫秒，那么这个工作人员也会打印 1 行……是的，只有一个。奇怪的...

**2）。**工人为什么停下来？（而且我没有得到 150 行的东西）

我**在 Windows 7 64-bit 上使用 JRE 7 Update 11**运行了这个程序。

PS：我很确定[这里提到的错误](https://stackoverflow.com/a/7548506/995822)在这个版本的 JRE 中得到了修复，因为我确实得到了 2 个不同的值（15 和 16）作为线程 ID 打印在控制台上。这是我怀疑的第一件事。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T18:10:55.243

我相信您需要显示一个可视化的 Swing 顶级窗口，以保持 Swing 事件线程处于活动状态。否则程序将因缺少非守护线程而关闭。

**编辑：**
为了证明 SwingWorker 线程是一个 Daemon 线程，只需添加一行代码来测试它：

```
System.out.println("I am thread with " + ms + " sleep in iteration "
   + i + ": " + t.getName() + " (" + t.getId() + ")");

// **** added
System.out.println("Daemon?: " + Thread.currentThread().isDaemon()); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-15T18:21:30.657

如果您查看 SwingWorker 类源代码 (Java SE 7) 的第 771 行：

```
thread.setDaemon(true); 
```

您将看到`SwingWorker`在守护线程中执行，在 Java 中，如果所有非守护线程都完成，JVM 将终止。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-15T18:27:21.347

如前所述，您可以使用 UI 来保持线程处于活动状态。

或者，您可以做的是使用`SwingWorker#get`（或任何阻止主线程终止的东西）等待线程完成。通过这样做，您将获得预期的输出。这是修改后的代码，可以满足您的要求。

```
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;
import java.util.concurrent.ExecutionException;

public class SwingWorkerTest
{
    public static void main (String[] args)
    {
        final MySwingWorker w1 = new MySwingWorker (500),
         w2 = new MySwingWorker (900),
         w3 = new MySwingWorker (1200);
        SwingUtilities.invokeLater (new Runnable ()
        {
            @Override
            public void run ()
            {
                w1.execute ();
                w2.execute ();
                w3.execute ();
            }
        });

        try{
            // you can replace the code in this block
            // by anything that keeps the program from 
            // terminating before the threads/SwingWorkers.
            w1.get();
            w2.get(); 
            w3.get(); 
        }catch(InterruptedException e){
            System.err.println("InterruptedException occured");
        }catch(ExecutionException e){
            System.err.println("InterruptedException occured");
        }

    }
}

class MySwingWorker extends SwingWorker<Void, Void>
{
    private int ms;

    public MySwingWorker (int ms)
    {
        this.ms = ms;
    }

    @Override
    protected Void doInBackground()
    {
        Thread t = Thread.currentThread ();

        for (int i = 0; i < 50; i++)
        {
            try
            {
                Thread.sleep (ms);
            }
            catch (InterruptedException e)
            {
                e.printStackTrace ();
            }

            System.out.println ("I am thread with " + ms + " sleep in iteration " + i + ": " + t.getName () + " (" + t.getId () + ")");
        }

        return null;
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-15T18:11:34.967

您是否尝试过创建任何 UI？或者在main的末尾放置类似的东西`new Object().wait();`，以防止主线程退出？

我不*完全确定*是这种情况，但是没有任何实际的 UI 显示，我很确定 swing 工作人员只是另一个线程，并且您没有将任何配置为守护线程，所以 main 启动它们，main完成，进程退出？

# c++ - 是否可以使用 Emscripten 从 JavaScript 调用 C++ 函数？

> ID：14900699
> 
> 赞同：7
> 
> 时间：2013-02-15T18:05:56.077
> 
> 标签：c++, emscripten

我正在尝试从 C++ 库生成 JavaScript 包装器（以便可以在 Web 浏览器的客户端使用 C++ 代码），但我不确定哪些工具最适合此目的。使用 Emscripten，是否可以从 C++ 库生成 JavaScript 库，以便在 JavaScript 中调用 C++ 函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T18:09:27.460

是的，根据[Emscripten 的官方文档，可以从 JavaScript 调用编译后的 C++ 函数。](http://kripken.github.io/emscripten-site/docs/porting/connecting_cpp_and_javascript/Interacting-with-code.html)

# linux - 等效于 libSgm 的拨号

> ID：14900702
> 
> 赞同：0
> 
> 时间：2013-02-15T18:06:02.553
> 
> 标签：linux, x11, irix

我正在将一个复杂的软件从 IRIX 移植到 Linux Red-Hat。它现在使用来自 libSgm 的 Dial 小部件（例如，请参见[此处）。](http://techpubs.sgi.com/library/dynaweb_docs/0530/SGI_Developer/books/IndigoMagic_IG/sgi_html/ch04.html#id23968)我搜索了很长时间，但没有找到任何可以在 Linux 上使用的 libSgm 或 Dial 的等效/替代品。

有人知道吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T12:09:16.513

我所知道的唯一可用的是指轮小部件。它在开源的 Open Inventor 库中，可以在此处获取：[https](https://github.com/aumuell/open-inventor) ://github.com/aumuell/open-inventor （原文：http: [//oss.sgi.com/projects/inventor/](http://oss.sgi.com/projects/inventor/)）

# java - Java：在 oracle 数据库中调用存储过程

> ID：14900708
> 
> 赞同：9
> 
> 时间：2013-02-15T18:06:24.283
> 
> 标签：java, sql, oracle, stored-procedures, jdbc

**编辑：虽然这个问题中的一些答案可能会帮助其他人解决不同的问题，但该解决方案实际上与数据库连接上的自动提交功能的一些错误有关！执行查询后强制提交会导致数据库反映更改，因此下面显示的代码是调用此类存储过程的正确方法**

我正在尝试在 oracle 数据库中调用一个简单的存储过程。

该过程如下所示：

```
procedure clear_orderProcDtlByOrdId(p_order_id in order_header.order_id%type,
                                    p_transaction_id in sl_order_processing_dtl.transaction_id%type DEFAULT NULL,
                                    p_item_action_id in sl_order_processing_dtl.item_action_id%type DEFAULT NULL )
... 
```

我遇到问题的java代码看起来像这样

```
 try 
    {
        CallableStatement storedProc = conn.prepareCall("{call PKG_PI_FRAUD.clear_orderProcDtlByOrdId(?)}");
        storedProc.setString(1, orderID);
        storedProc.execute();
    } 
    catch (SQLException e) 
    {
        e.printStackTrace();
    } 
```

我根本没有收到任何错误，但是没有反映数据库更改。当我在 SQL Developer 中运行该过程时，我看到了结果。我认为这可能是因为提交问题，但我建立的连接处于自动提交模式。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T12:56:56.803

虽然这个问题中的一些答案可能会帮助其他人解决不同的问题，但该解决方案实际上与数据库连接上的自动提交功能的一些错误有关！执行查询后强制提交会导致数据库反映更改，因此问题中显示的代码是调用这种类型的存储过程的正确方法！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T18:59:44.107

为了能够在 Oracle 数据库中捕获过程的返回，试试这个。

```
public static void main(String[] args) {

        try {

            Class.forName("oracle.jdbc.driver.OracleDriver");
            String url = "jdbc:oracle:thin:@localhost:1521:xe";
            Connection con = DriverManager.getConnection(url, db_user, password);
            System.out.println("Connected to database");

            SimpleDateFormat simpleDateFormat = new SimpleDateFormat("dd/MM/yyyy");
            Date now = new java.sql.Date(simpleDateFormat.parse("12/02/2001").getTime());

            String command = "{call SALDOS(?,?)}";
            CallableStatement cstmt = con.prepareCall(command);
            cstmt.registerOutParameter(2, Types.DECIMAL);

            cstmt.setDate(1, now);
            cstmt.execute();
            Double str = cstmt.getDouble(2);

            cstmt.close();
            System.out.println("Retorno: " + str);

        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

如果您以这种方式使用不同的 Returns Map SimpleJdbcCall：

```
 SimpleJdbcCall call = Util.getSimpleJdbcCallInstance();
    call.setProcedureName("PROCED_CONDOMINIAL");
    call.declareParameters(
            new SqlParameter("CONDOMINIO", Types.VARCHAR),
            new SqlParameter("BLOCO", Types.VARCHAR),,
            new SqlOutParameter("P_NUMERO", Types.NUMERIC),
            new SqlOutParameter("P_LOG", Types.VARCHAR));

    Map<String, Object> parametros = new HashMap<String, Object>();
    parametros.put("CONDOMINIO_IC", descricaoCondominio);
    parametros.put("BLOCO_IC", imovelCondominial.getBloco());

    Map<String, Object> out = call.execute(parametros);
    BigDecimal chave = (BigDecimal) out.get("P_NUMERO");
    imovelCondominial.setId(chave.longValue()); 
```

和程序的声明

```
create or replace PROCEDURE         PROCED_CONDOMINIAL
               (CONDOMINIO            VARCHAR2,
                BLOCO                 VARCHAR2,
                NUMERO                OUT NUMBER,
                LOG                   OUT VARCHAR2)      -- PARAMETROS DE SAIDAS (OUT).- 
```

在这里工作。看看这个博客。

[http://jameajudo.blogspot.com.br/2009/03/call-procedure-oracle-with-java-and.html](http://jameajudo.blogspot.com.br/2009/03/call-procedure-oracle-with-java-and.html)

在 Oracle 10xe 和 11xe 上测试。

# java - 堆栈，foreach，错误的顺序？

> ID：14900710
> 
> 赞同：24
> 
> 时间：2013-02-15T18:06:27.263
> 
> 标签：java, stack, queue

使用 Java 的`for`each 语法时，`Stack`不对输出元素使用 LIFO 排序。考虑以下代码：

```
import java.util.Queue;
import java.util.Stack;
import java.util.LinkedList;

public class QueueStackTest {
  private static int[] numbers = {1, 2, 3, 4, 5};

  public static void main(String[] args) {
    Stack<Integer> s = new Stack<Integer>();
    Queue<Integer> l = new LinkedList<Integer>();

    for (int i : numbers) {
      s.push(i);
      l.offer(i);
    }

    System.out.println("Stack: ");
    for(Integer i : s) {
      System.out.println(i);
    }

    System.out.println();
    System.out.println("Queue:");
    for(Integer i : l) {
      System.out.println(i);
    }
  }
} 
```

**输出：**

```
Stack: 
1
2
3
4
5

Queue:
1
2
3
4
5 
```

问题：

1.  这有意义吗？它是一个错误吗？
2.  我可以保证这至少会以正确的顺序返回队列元素吗？
3.  消费（处理） a`Stack`或 a`Queue`时，这是最好的方法吗？或者我应该使用以下内容进行更手动的循环：`while(!s.isEmpty()) { handle(s.pop()); }`或`while(!l.isEmpty()) { handle(l.poll()); }`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-15T18:23:02.353

[Stack 的 Javadoc 中](http://docs.oracle.com/javase/7/docs/api/java/util/Stack.html)有一个有趣的脚注：

> Deque 接口及其实现提供了一组更完整和一致的 LIFO 堆栈操作，应优先使用此类。例如：
> 
> 双端队列栈 = new ArrayDeque();

您的程序的扩展版本：

```
 public static void main(String[] args) {
    Stack<Integer> s = new Stack<Integer>();
    Deque<Integer> d = new ArrayDeque<Integer>();
    Queue<Integer> l = new LinkedList<Integer>();

    for (int i : numbers) {
      s.push(i);
      l.offer(i);
      d.push(i);
    }

    System.out.println("Stack: ");
    for(Integer i : s) {
      System.out.println(i);
    }

    System.out.println();
    System.out.println("Queue:");
    for(Integer i : l) {
      System.out.println(i);
    }
    System.out.println();
    System.out.println("Deque:");
    for(Integer i : d) {
      System.out.println(i);
    }
  } 
```

给

```
....
Deque:
5
4
3
2
1 
```

所以也许切换到 Deque 以获得更一致的行为。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-15T18:10:17.917

您需要使用 pop() & poll() 而不是 for 循环。这就是 Stack/Queue 提供的 API。

当你迭代时，你是在直接迭代 Stack/Queue 的内部表示。

# ruby-on-rails - 回形针：一个模型中有多个“has_attached_file”

> ID：14900711
> 
> 赞同：3
> 
> 时间：2013-02-15T18:06:34.763
> 
> 标签：ruby-on-rails, database, paperclip

我的模型片段：

```
attr_accessible :package1_file_name, :package2_file_name
has_attached_file :package1
has_attached_file :package2 
```

从我的 _form （简化版）：

```
<%= form_for(@submission, :html => { :multipart => true, :id => "fileupload"  }) do |f| %>
 <%= f.file_field :package1%>
 <%= f.file_field :package2%>
<% end %> 
```

问题是回形针将为数据库中的每个文件插入两个**单独**的条目。但是，我希望它只插入**一个**条目，因为我的表中有两个单独的字段：`package1_file_name`, `package2_file_name`.

有没有办法做到这一点？

谢谢！

* * *

对于克里斯蒂安·瓦尔加：

也许我不应该简化原始问题中的代码，但使用`jQuery file upload`插件后我的视图实际上是这样的：

```
<%= f.fields_for :uploads do |upload| %>
    <div class="row fileupload-buttonbar">
        <!-- The first upload field -->
          <span class="btn btn-success fileinput-button">
                <%= upload.file_field :package1 %>
          </span>
        <!-- The second upload field -->
          <span class="btn btn-success fileinput-button">
                <%= upload.file_field :package2 %>
          </span>
    </div>
<% end %> 
```

`upload`当前模型的子模型在哪里

我不确定这是否`multipart`使这两个文件字段像单独的附件一样，但我正在尝试将这两个附件合并为一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T21:38:35.080

好的，所以我做了一些研究，但我仍然无法复制您的问题。我用该代码构建了一个测试应用程序，它只将一个条目插入到数据库中。

创建项目（终端）

```
rails new paperclip-test
cd paperclip-test
echo "gem 'paperclip'" >> Gemfile
bundle
rails generate scaffold submission
rails generate paperclip submission package1 package2
rake db:migrate 
```

更新模型（**submission.rb**）

```
attr_accessible :package1, :package2
has_attached_file :package1, :styles => { :medium => "300x300>", :thumb => "100x100>" }
has_attached_file :package2, :styles => { :medium => "300x300>", :thumb => "100x100>" } 
```

更新控制器（**submissions_controller.rb**）

```
def create
    # @submission = Submission.new(params[:submission])
    @submission = Submission.create(params[:submission])
end 
```

更新表单（**_form.html.erb**）

```
<%= f.file_field :package1 %>
<%= f.file_field :package2 %> 
```

更新视图 ( **show.html.erb** )

```
<%= image_tag @submission.package1.url(:medium) %>
<%= image_tag @submission.package2.url(:medium) %> 
```

运行应用程序并创建新提交

返回控制台：

```
sqlite3 db/development.sqlite3
select * from submissions; 
```

结果：

```
1|2013-02-21 21:16:38.898602|2013-02-21 21:16:38.898602|image_1.jpg|image/jpeg|54231|2013-02-21 21:16:38.419947|image_2.jpg|image/jpeg|61766|2013-02-21 21:16:38.658720 
```

[来自https://github.com/thoughtbot/paperclip#quick-start](https://github.com/thoughtbot/paperclip#quick-start)的回形针说明

# php - PHP 倒数计时器，完成 +7 天后重复，直到达到一定数量

> ID：14900713
> 
> 赞同：0
> 
> 时间：2013-02-15T18:06:35.173
> 
> 标签：php, timer, countdown

所以这是我需要做的：

*   从数据库中获取时间（暂时不要担心数据库的东西）
*   以天、小时和分钟为单位的倒计时时间
*   当倒计时达到 0 时，将倒计时增加 7 天，同时将情节计数增加 1
*   重复多次，直到剧集计数达到一定数量（由数据库设置，此时再次不要太担心数据库的内容）然后停止倒计时并回显 Aired

基本上它会倒计时到电视节目的下一集播出时间并显示下一集的编号，这将一直持续到所有剧集播出。

这是我目前所拥有的，它在一定程度上有效，但只会+7天/++集一次，之后倒计时将变为负数。我已经尝试过while循环和其他一些东西，但我没有太多运气。

```
$date = "February 12, 2013 5:06 PM";
$date = strtotime($date);
$remaining = $date - time();

$episode = 0;

if ($remaining < 0) {
++$episode;
$remaining = strtotime("+7 day", $date) -time();
}

$days_remaining = floor($remaining / 86400);
$hours_remaining = floor(($remaining % 86400) / 3600);
$mins_remaining = floor(($remaining % 86400 % 3600) / 60);

if ($episode == 3){
 echo "Aired";
} else {
echo "$days_remaining:$hours_remaining:$mins_remaining Ep $episode";
} 
```

任何建议都非常感谢，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:14:18.170

当然会变成负数。

`$remaining`达到 0后，再增加 7 天。

```
if ($remaining < 0) { // remaining: less than 0 days
++$episode; // episode becomes 1
$remaining = strtotime("+7 day", $date) -time(); // remaining: less than 7 days
} 
```

但是，再过 7 天后，`$remaining`仍然是负数，只增加了 7 天。由于您还没有保存`$episode`在数据库中，因此根据代码它仍然是 0。

```
$episode = 0; // $episode starts at 0 according to the code
if ($remaining < 0) { // remaining: less than -7 days
++$episode; // episode becomes 1 
```

所以它继续负数并给你`$episode == 1`。

你应该这样做：

```
$date = strtotime("February 12, 2013 5:06 PM");
for ($i = 0; $i < 3; $i++) {
    $episodes[$i+1] = strtotime("+". 7*$i ." day", $date);
    $remainings[$i+1] = $episodes[$i+1] - time();
}
foreach ($remainings as $key => $remaining) {
    if ($remaining > 0) {
        $episode = $key;
        $days_remaining = floor($remaining / 86400);
        $hours_remaining = floor(($remaining % 86400) / 3600);
        $mins_remaining = floor(($remaining % 86400 % 3600) / 60);
        break;
    }
}
if (!isset($episode)){
    echo "Aired";
} else {
    echo "$days_remaining:$hours_remaining:$mins_remaining Ep $episode";
} 
```

# php - 奇怪的 PHP 类自动加载器行为 - PEAR 相关

> ID：14900717
> 
> 赞同：0
> 
> 时间：2013-02-15T18:06:45.300
> 
> 标签：php, pear, autoloader

我有一个奇怪的问题，我无法弄清楚。我正在使用`PEAR`从 PHP 页面发送邮件。该类`Send_Mail`正在工作（使用 SMTP 发送邮件），但我收到与我的`autoloader`.

```
Warning: include(classes/LOGIN.php) 
[<a href='function.include'>function.include</a>]: 
failed to open stream: No such file or directory in 
C:\xampp\htdocs\mysite\initialize.php on line 46` 
```

在我的`initialize.php`文件中，我有这个：

```
function autoloader($class) {
    include 'classes/' . $class . '.php';
}

spl_autoload_register('autoloader'); 
```

在我的`header.php`文件中，我正在为该站点加载几个 PHP 类：

```
// autoload PHP classes for site
autoloader('Navigation');
autoloader('Validation'); 
```

该错误是指我没有的 LOGIN 类。但是我搜索了整个站点文件夹，包括`php`并在以下位置找到了这两行`C:\xampp\php\PEAR\Net\SMTP.php`：

```
/* These standard authentication methods are always available. */
$this->setAuthMethod('LOGIN', array($this, '_authLogin'), false);
$this->setAuthMethod('PLAIN', array($this, '_authPlain'), false); 
```

当我注释掉包含的行时，`LOGIN`我得到了相同的警告，但是`PLAIN`当我注释掉这两行时，警告消失了（但随后 SMTP 身份验证失败）。

为什么会这样？

**更新**

这是我的新的`autoloader`：

```
function autoloader($class) {

    if (file_exists('classes' . $class . '.php')) {
        include 'classes' . $class . '.php'; 
    }
} 
```

但是，当我 echo`'classes' . $class . '.php'`时，我得到了这个：

`classes/.php`

然后如果我把它改回不使用`file_exists`它就可以了，但`echo`仍然显示`classes/.php`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:35:48.717

我不确定您使用的是哪个版本的 Net_SMTP，但该`setAuthMethod`函数将各种不同类型的结构作为参数 - 方法名称、类、对象、可调用对象等。

由于 PHP 是动态类型的，`SMTP.php`因此在 Net_SMTP 中必须对该对象进行大量检查以确定它是什么类型的对象。作为其中的一部分，它会尝试确定“LOGIN”是否是一个类名，它正在调用您的自动加载器。

解决方案是在尝试包含之前在您的自动加载器中执行一个`file_exists`，但当然，如果您的包含路径在任何方面都很复杂，那么您基本上会让自己头疼。任何处理过编写综合自动加载器的人都知道你的痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T22:47:22.870

我恢复到一个简单的`autoloader`，事情似乎工作正常：

```
function autoloader($class) {
    include 'classes/' . $class . '.php';
}

spl_autoload_register('autoloader'); 
```

感谢您的建议。

# ios - NSUserDefaults 没有快速更新值

> ID：14900718
> 
> 赞同：3
> 
> 时间：2013-02-15T18:06:47.067
> 
> 标签：ios, xcode, nsuserdefaults

我有超时功能，如果应用程序空闲（在后台）一段时间，我会超时我的应用程序并将用户发送到登录屏幕。我在我的应用程序委托中将用户默认值中的“timedOut”键设置为 YES，然后在每个视图控制器中引用该键，如果是，我会转到登录屏幕。在登录屏幕上，如果“timedOut”为“是”，我有一个显示“会话已超时”的标签。我的问题是，如果我登录，然后很快注销，标签就会显示，即使我在显示标签后立即将该键明确设置为 NO，然后同步用户默认值。**如果我等待一两秒钟然后注销，标签就会像应有的那样被隐藏起来。** 我已经解决了“问题”，但想了解这种行为。

视图中的代码确实加载到了我的登录视图控制器中。您会认为这会将 isTimedOut 更改为 NO，但是当我快速注销时，再次调用 viewdidload，但 isTimedOut 为 YES。

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
sessionLabel.hidden = YES;
isTimedOut = [defaults boolForKey:@"isTimedOut"];
if (isTimedOut == YES)
{
    sessionLabel.hidden = NO;
    defaults = [NSUserDefaults standardUserDefaults];
    [defaults setBool:NO forKey:@"isTimedOut"];
    isTimedOut = NO;
    NSLog(@"Timed Out has been reset to %s",[defaults boolForKey:@"isTimedOut"] ? "YES" : "NO");
    [defaults synchronize];

} 
```

更新

我使用我的应用程序委托中的属性而不是 NSUserDefaults 替换了上面的代码，并且“奇怪”的行为消失了。

```
eONavAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
isTimedOut = appDelegate.isTimedOut;
sessionLabel.hidden = YES;
//isTimedOut = [defaults boolForKey:@"isTimedOut"];
  NSLog(@"Timed Out has been reset to %s",appDelegate.isTimedOut ? "YES" : "NO");
if (isTimedOut == YES)
{
    appDelegate.isTimedOut = NO;
    sessionLabel.hidden = NO;

} 
```

更多代码

要注销，我有 UIButtonBarItem 以编程方式调用 segue。doLogout 属性告诉登录视图控制器运行注销 API。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
// Make sure your segue name in storyboard is the same as this line
if ([[segue identifier] isEqualToString:@"logoutSegue"])
{

    // Get reference to the destination view controller
    eoLoginViewController *vc = [segue destinationViewController];
    vc.doLogout = YES;

}
} 
```

isTimedOut 设置在应用程序委托中的一个位置。

```
-(void)timeoutWithDate:(NSDate *)currentDate
{
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSDate *previousDate  = [defaults objectForKey:@"enteredBackground"];
NSTimeInterval distanceBetweenDates = [currentDate timeIntervalSinceDate:previousDate];//TimeInterval is in seconds
NSLog(@"Time between dates in seconds %f",distanceBetweenDates);

double minutesInAnHour = 60;
double minutesBetweenDates = distanceBetweenDates / minutesInAnHour;
NSLog(@"minutesBetweenDates %f",minutesBetweenDates);

if(minutesBetweenDates > 60)
{
    isTimedOut = YES;

}
else
{
    isTimedOut = NO;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:27:28.777

用这个：

要保存布尔值：

```
[[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"isTimedOut"]; 
```

加载布尔：

```
 if ([[NSUserDefaults standardUserDefaults] boolForKey:@"isTimedOut"] == YES) {
        //it equals yes
        }

    else {
        //it equals no
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T19:59:35.230

你为什么不试试这样的东西？我没有看到你的完整项目，但它应该像一个魅力。

```
- (void)viewDidLoad {
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(applicationWillResignActive:) name:UIApplicationWillResignActiveNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(applicationWillEnterForeground:) name:UIApplicationWillEnterForegroundNotification object:nil];
} 
```

然后...

```
- (void)applicationWillResignActive:(UIApplication *)application
{
    [[NSUserDefaults standardUserDefaults] setValue:[NSDate date] forKey:@"sleepTime"];
    [[NSUserDefaults standardUserDefaults] synchronize];
} 
```

和...

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{
    NSInteger _timeoutInSeconds = 300;

    NSDate *_sleepTime = [[NSUserDefaults standardUserDefaults] valueForKey:@"sleepTime"];
    if (_sleepTime) {
        NSCalendar *_calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
        NSDateComponents *_dateComponents = [_calendar components:NSSecondCalendarUnit fromDate:_sleepTime toDate:[NSDate date] options:0];
        if (_dateComponents.second > _timeoutInSeconds) {
            // expired session
        } else {
            // valid session
        }
    }
} 
```

# php - file_put_contents 未创建 txt 文件

> ID：14900719
> 
> 赞同：11
> 
> 时间：2013-02-15T18:06:48.167
> 
> 标签：php, linux, apache, centos, selinux

我目前有一个在浏览器浏览器浏览网页时正在运行的 php 脚本。我要做的是在脚本运行时编写一个文本文件来存储变量。该文件夹的所有者是apache，但每个人都有读写权限，严格用于测试目的。（我认为这可能是权限问题）在服务器上启用了 SELINUX，当我从控制台运行脚本时，它会在正确的目录中创建文本文件。

```
file_put_contents("My working file location", $myString); 
```

我正在使用这一行来尝试编写和创建文本文件，我知道我的文件位置有效，因为我可以运行它并在离线模式下创建它，IE 通过控制台运行它。问题是我试图写入的变量是通过 HTTP Post 填充的，当我通过浏览器运行脚本时，或者当 apache 运行脚本时，它不会写入或创建文件。我需要做什么才能允许访问写入/更改语法明智地让这个脚本写入这个文本文件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-15T18:17:02.243

您的问题可能是由于 apache 没有权限写入您指定的文件位置。转到该目录并使用以下`ls`命令检查权限和组所有权：

```
cd "My working file location"
ls -l . 
```

输出中有三列显示目录的权限、所有者和组。它们很可能归根用户所有，并且没有`apache`写入目录的权限。

如果是这种情况，那么当它尝试创建文件时，您将在 apache 日志中看到一个错误。在浏览器中运行脚本时尝试跟踪日志：

```
tail -f /var/log/apache2/error.log 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-14T02:08:16.307

我最近遇到了同样的麻烦，偶然发现了这个问题。不幸的是，OP在评论中说，他找到了自己的解决方案，只是接受了一个对我们没有帮助的答案......然后在搜索并成功使**file_put_contents**再次工作后，我决定分享我的解决方案。

我的文件和目录的权限可以接受任何写入（确保您的目录是这样的，`chmod 757`这将授予 root 和*其他人*在该位置写入文件的权限）。如果它仍然不能像我一样工作，那是因为您的系统可能是**SELinux**（安全增强 Linux）系统。

如果您想确保编写`setenforce 0`这会将 selinux 转换为许可模式，请再次运行您的脚本，如果它有效，则表示问题已得到很好的描述。

在这种情况下，重新打开 selinux并在项目目录所在的目录中`setenforce 1`尝试。`ls -Zl`这会给你一个像

```
drwx---r-x.  9  root   root  system_u:object_r:httpd_sys_content_t:s0  4096  Dec  8  00:25  project 
```

或者一些不同的东西，但`httpd_sys_content_t`如果你曾经`chcon`将上下文从一个目录转移到这个目录。但如果你没有`httpd_sys_content_t`它也没关系，因为无论如何我们都需要更改该目录的上下文。

首先，您需要接受任何`public_content_rw_t`上下文来写入文件。类型

```
setsebool -P httpd_anon_write on 
```

这将（P）永久地将 SELinux 布尔值`httpd_anon_write`设置为 true，并且任何被称为 as 的上下文`public_content_rw_t`都将有权在其自己的位置写入任何文件。

现在你必须说你的项目目录是 SELinux，`public_content_rw_t`否则你仍然无法写入文件。类型 ：

```
semanage fcontext --add --type public_content_rw_t "/project(/.*)?" 
```

并`restorecon -RvF /project`告诉*selinux*应用上述规范。

现在你的目录是*public_content_rw_t*，你应该可以写文件了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-13T02:12:34.957

我也遇到了这个问题。就我而言，我发现目录的所有权是错误的。对于典型的 Apache 安装，目录应该由 www-data:www-data 拥有，而不是 root:root。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-05T04:10:51.987

对于有类似问题的人，可以尝试其他方法。你可能只是犯了一个简单的错误，不需要你搞乱文件权限——如果你犯了这个错误，修复文件权限可能无济于事。

确保您在 file_put_contents() 中使用本地的*相对*文件路径。

例如，使用：

```
file_put_contents('short_local_path/my_working_file.txt', $myString); 
```

不是：

```
file_put_contents('http://example.com/remote_path/my_working_file.txt', $myString); 
```

并不是：

```
file_put_contents('/whole/root/file/path/to/my_working_file.txt', $myString); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-02-15T20:12:30.247

您是否尝试过 chmodding 目录`777`？

尝试这个：

```
if(file_put_contents('file.txt', 'text')){
    die('yes');
} else {
    die('no');
} 
```

可能拼错了什么。^

# vb.net - 如何制作像 MessageBox 一样的自定义 .Net Windows 窗体？

> ID：14900720
> 
> 赞同：0
> 
> 时间：2013-02-15T18:06:52.973
> 
> 标签：vb.net, visual-studio-2010, .net-4.0

如何制作一个行为类似于消息框的表单？

例如，我有 2 个名为`form1`和的表单`form2`。

*   `form1`包含我的基本信息（姓名、性别、地址和 1 个按钮（教育背景））。
*   `form2`包含我的教育背景（学校、school_add、按钮（确定）和按钮（取消））。

如果我打开`form1`并单击教育背景按钮，`form2`则会出现。我想要的是，如果用户在仍处于打开状态时尝试单击`form1`，`form2`则会`form2`闪烁并且用户无法操作`form1`. 我想要求用户`form2`在返回之前单击“取消”或“确定”按钮`form1`，就像消息框如何阻止您使用它后面的表单一样。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:22:20.903

您正在寻找的称为**[模态](http://msdn.microsoft.com/en-us/library/39wcs2dh%28v=vs.100%29.aspx)**形式。

这很容易做到：只需调用`.ShowDialog(Me)`而不是`.Show()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:15:50.300

```
' Form1 button handler
Private Sub buttonClick(ByVal sender As Object, ByVal e As System.EventArgs) Handles button.Click
   Dim f As New Form2()
   f.ShowDialog(Me)
End Sub 
```

另请参阅[http://msdn.microsoft.com/en-us/library/39wcs2dh(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/39wcs2dh(v=vs.100).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:50:22.620

使用 .ShowDialog 而不是 .Show 加载表单

```
Form2.ShowDialog 
```

# php - 如何使用 PHP 剪切图像的一部分并将其粘贴到另一个图像？

> ID：14900727
> 
> 赞同：0
> 
> 时间：2013-02-15T18:07:11.917
> 
> 标签：php, image, imagemagick, gd

我正在使用 PHP 作为后端构建一个简单的图像生成器，我想实现这个功能： - 剪切源图像的椭圆部分 - 调整大小并将其粘贴到目标图像上的某些坐标 - 保存目标图像

例如，查看此图像：

![示例照片](../Images/b570e88f2f9ae86dcf878a7568d11e67.png)

我正在寻找一个可以通过将此选择的 x、y、宽度和高度作为输入参数来管理此类任务的函数。该解决方案可以使用 imagemagick 或 GD（或其他任何东西 - 它只需要使用 PHP 完成）。

感谢您的帮助或至少为我指明正确的方向！

# c# - 是否可以为字符串实现 ExpressionTree.GreaterThan 等，以便 LINQ 可以使用它

> ID：14900731
> 
> 赞同：4
> 
> 时间：2013-02-15T18:07:21.160
> 
> 标签：c#, linq

我今天早上看到了一个问题（[在一系列值上查询我的模型](https://stackoverflow.com/questions/14896585/query-my-model-on-a-range-of-values)），似乎由（[https://stackoverflow.com/a/1447926/195550](https://stackoverflow.com/a/1447926/195550)）回答，但那里的整个情况让我对更概括的兴趣解决方案。

我希望能够使用 Jon Skeet 的答案来实现一个`Between`可以在非 SQL 生成的环境中使用字符串键，但似乎字符串没有实现**GreaterThan**、**LessThan**、**GreaterThanOrEqual**、**LessThanOrEqual**运算符的事实进入Linq 能够构建执行此操作所需的表达式树的方式。

*   我意识到可以只使用这些`CompareTo`方法进行查询来完成这项任务，但我真的很喜欢这种优雅的`query.Between(v=>v.StringKey, "abc", "hjk")`表达方式。

*   我查看了 System.Linq.Expression 程序集，发现它正在寻找一个名为“op_GreaterThan”的方法，例如用于 GreaterThan 操作，但*我不知道*

    1.  我是否可以为字符串实现这个（知道我不能为字符串扩展实际的“>”运算符）
    2.  如何构建正确的方法签名。
*   我创建了以下示例并进行了测试，这些示例显示了 Between 扩展方法在字符串键上不起作用的地方。

如果可以为字符串键实现这将是非常优雅的。有人对如何实现这一目标有任何建议或见解吗？

**来自 Jon Skeet 的运算符之间，添加了包含标志**

* * *

```
public static class BetweenExtension
{
    public static IQueryable<TSource> Between<TSource, TKey>(
        this IQueryable<TSource> source,
        Expression<Func<TSource, TKey>> keySelector,
        TKey low,
        TKey high,
        bool inclusive = true) where TKey : IComparable<TKey>
    {
        var key = Expression.Invoke(keySelector, keySelector.Parameters.ToArray());

        var lowerBound = (inclusive)
                  ? Expression.GreaterThanOrEqual(key, Expression.Constant(low))
                  : Expression.GreaterThan(key, Expression.Constant(low));

        var upperBound = (inclusive)
                  ? Expression.LessThanOrEqual(key, Expression.Constant(high))
                  : Expression.LessThan(key, Expression.Constant(high));

        var and = Expression.AndAlso(lowerBound, upperBound);
        var lambda = Expression.Lambda<Func<TSource, bool>>(
                        and, keySelector.Parameters);

        return source.Where(lambda);
    }
} 
```

**使用“int”键对上述内容进行工作测试**

* * *

```
[TestFixture]
public class BetweenIntTests
{
    public class SampleEntityInt
    {
        public int SampleSearchKey { get; set; }
    }

    private IQueryable<SampleEntityInt> BuildSampleEntityInt(params int[] values)
    {
        return values.Select(
               value => 
               new SampleEntityInt() { SampleSearchKey = value }).AsQueryable();
    }

    [Test]
    public void BetweenIntInclusive()
    {
        var sampleData = BuildSampleEntityInt(1, 3, 10, 11, 12, 15);
        var query = sampleData.Between(s => s.SampleSearchKey, 3, 10);
        Assert.AreEqual(2, query.Count());
    }

    [Test]
    public void BetweenIntNotInclusive()
    {
        var sampleData = BuildSampleEntityInt(1, 3, 10, 11, 12, 15);
        var query = sampleData.Between(s => s.SampleSearchKey, 2, 11, false);
        Assert.AreEqual(2, query.Count());
    }
} 
```

**使用“字符串”键对上述内容进行非工作测试**

* * *

```
[TestFixture]
public class BetweenStringsTests
{

    public class SampleEntityString
    {
        public string SampleSearchKey { get; set; }
    }

    private IQueryable<SampleEntityString> BuildSampleEntityString(params int[] values)
    {
        return values.Select(
               value =>
               new SampleEntityString() {SampleSearchKey = value.ToString() }).AsQueryable();
    }

    [Test]
    public void BetweenStringInclusive()
    {
        var sampleData = BuildSampleEntityString(1, 3, 10, 11, 12, 15);
        var query = sampleData.Between(s => s.SampleSearchKey, "3", "10");
        Assert.AreEqual(2, query.Count());
    }

    [Test]
    public void BetweenStringNotInclusive()
    {
        var sampleData = BuildSampleEntityString(1, 3, 10, 11, 12, 15);
        var query = sampleData.Between(s => s.SampleSearchKey, "2", "11", false);
        Assert.AreEqual(2, query.Count());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:17:45.823

您必须调用该`string.CompareTo`方法作为表达式树的一部分。然后，您可以测试其结果。要查看它的外观，请查看调试器中的以下值：

```
Expression<<Func<string, bool>> filter = str => str.CompareTo("abc") > 0; 
```

# jquery - 一种简化此 JavaScript 文件的方法？jQuery 显示/隐藏？

> ID：14900735
> 
> 赞同：0
> 
> 时间：2013-02-15T18:07:43.717
> 
> 标签：jquery, hide, show

我有 4 个 div 和 4 个相应的按钮。当您单击 button1 时，它显示 div 1 并隐藏所有其他。如此等等。而不是必须列出所有要隐藏的 div，我可以只使用一个“隐藏所有其他 div”类型的字符串吗？不是隐藏页面上的每个 div，而是隐藏每个#div(number)。

```
$(document).ready(function() {
var h1 = $("#div56").height();
var h2 = $("#div54").height();
var h3 = $("#div47").height();
var h4 = $("#div45").height();
$("#div56,#div54,#div47,#div45").height(… h2, h3, h4));
$("#div54,#div47,#div45").hide();
});

$("#lnk56").live('click', function() {
$("#div56").show();
$("#div54,#div47,#div45").hide();
});
$("#lnk54").live('click', function() {
$("#div54").show();
$("#div56,#div47,#div45").hide();
});
$("#lnk47").live('click', function() {
$("#div47").show();
$("#div56,#div54,#div45").hide();
});
$("#lnk45").live('click', function() {
$("#div45").show();
$("#div56,#div54,#div47").hide();
}); 
```

这是相应的 HTML/PHP：

```
 <div class="grid_5">

        <?php query_posts( 'post_type=credits&showposts=99999'); ?>
    <?php if (have_posts()) : while (have_posts()) : the_post(); ?>

        <div class="post">

<div class="buttons">
            <a id="lnk<?php the_ID(); ?>" href="#"><h5><?php the_title(); ?></h5></a>
</div><!--/buttons-->

<?php wp_link_pages(array('before' => 'Pages: ', 'next_or_number' => 'number')); ?>

        </div>

        <?php endwhile; endif; ?>
</div><!--/grid_5-->

<div class="grid_7">
        <div class="scrollbox">
        <div id="divParent">

                <?php query_posts( 'post_type=credits'); ?>
                <?php if (have_posts()) : while (have_posts()) : the_post(); ?>

        <div class="info" id="<?php the_ID(); ?>">

                <?php the_content(); ?>

        </div>

        <?php endwhile; endif; ?>

                </div><!--/divParent-->
       </div>
        </div><!--/grid_7--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:23:26.223

使用一些正则表达式来收听所有链接

```
$('body').on("click", "[id^="lnk"]", function(event){
   $(this).parent().show();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:28:25.307

这是我的尝试

```
$(document).ready(function () {
    $('button[id^="lnk"]').on('click', function () {
        $('div[id^="div"]').hide();
        var id = $(this).attr('id').substring(3);
        $('#div' + id).show();
    });
}); 
```

这将影响 ID 以 开头的所有按钮`lnk`。但是，由于我们没有可使用的 html，因此我认为这是我们的意图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:12:00.520

您可以在所有这些 div 上添加一个类（例如“divGroup”），然后执行以下操作：

```
function() {
    $("div.divGroup").hide();
    this.show();
}

$("#lnk56").live('click', showIt());
... repeat for all divs ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:14:38.330

您可以通过使用类来隐藏并使其动态化，您可以使用 data-* 属性从按钮中检索正确的 Id 并显示相应的 div。看到这个 JSFiddle：http: [//jsfiddle.net/V9ZZy/](http://jsfiddle.net/V9ZZy/)

```
$(document).on("click", "button", function(){
       var id = $(this).attr('data-btn-id');
       $(".myDivs").hide();
       $("#div" + id).show();
});

    <div id="div1" class="myDivs">Hello 1</div>
<button id="btn1" data-btn-id="1">Btn 1</button>

<div id="div2" class="myDivs">Hello 2</div>
<button id="btn2"  data-btn-id="2">Btn 2</button>

<div id="div3" class="myDivs">Hello 3</div>
<button id="btn3"  data-btn-id="3">Btn 3</button>
... 
```

# android - 过渡动画期间嵌套片段消失

> ID：14900738
> 
> 赞同：101
> 
> 时间：2013-02-15T18:07:50.697
> 
> 标签：android, android-fragments, android-support-library, android-nested-fragment

这是场景： Activity 包含 fragment ，它`A`反过来用于`getChildFragmentManager()`添加片段`A1`，如下所示：`A2``onCreate`

```
getChildFragmentManager()
  .beginTransaction()
  .replace(R.id.fragmentOneHolder, new FragmentA1())
  .replace(R.id.fragmentTwoHolder, new FragmentA2())
  .commit() 
```

到目前为止，一切都很好，一切都按预期运行。

然后我们在 Activity 中运行以下事务：

```
getSupportFragmentManager()
  .beginTransaction()
  .setCustomAnimations(anim1, anim2, anim1, anim2)
  .replace(R.id.fragmentHolder, new FragmentB())
  .addToBackStack(null)
  .commit() 
```

在过渡期间，`enter`片段的动画`B`运行正常，但**片段 A1 和 A2 完全消失**。`popEnter`当我们使用 Back 按钮恢复事务时，它们会正确初始化并在动画期间正常显示。

在我的简短测试中，它变得更奇怪了——如果我为子片段设置动画（见下文），`exit`当我们添加片段时动画会间歇性地运行`B`

```
getChildFragmentManager()
  .beginTransaction()
  .setCustomAnimations(enter, exit)
  .replace(R.id.fragmentOneHolder, new FragmentA1())
  .replace(R.id.fragmentTwoHolder, new FragmentA2())
  .commit() 
```

我想要实现的效果很简单——我想要`exit`（或者应该是`popExit`？）片段`A`（anim2）上的动画运行，为整个容器设置动画，包括它的嵌套子级。

有没有办法做到这一点？

**编辑：请**[在这里](https://github.com/BurntBrunch/NestedFragmentsAnimationsTest)找到一个测试用例

**Edit2**：感谢@StevenByle 推动我继续尝试静态动画。显然你可以在每个操作的基础上设置动画（不是全局的整个事务），这意味着孩子可以有一个无限的静态动画集，而他们的父母可以有不同的动画，整个事情可以在一个事务中提交. 请参阅下面的讨论和[更新的测试用例项目](https://github.com/BurntBrunch/NestedFragmentsAnimationsTest)。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2014-04-24T17:44:49.707

所以似乎有很多不同的解决方法，但基于@Jayd16的回答，我想我找到了一个非常可靠的包罗万象的解决方案，它仍然允许在子片段上自定义过渡动画，并且不需要做布局的位图缓存。

有一个`BaseFragment`扩展类，`Fragment`并使所有片段扩展该类（不仅仅是子片段）。

在`BaseFragment`该类中，添加以下内容：

```
// Arbitrary value; set it to some reasonable default
private static final int DEFAULT_CHILD_ANIMATION_DURATION = 250;

@Override
public Animation onCreateAnimation(int transit, boolean enter, int nextAnim) {
    final Fragment parent = getParentFragment();

    // Apply the workaround only if this is a child fragment, and the parent
    // is being removed.
    if (!enter && parent != null && parent.isRemoving()) {
        // This is a workaround for the bug where child fragments disappear when
        // the parent is removed (as all children are first removed from the parent)
        // See https://code.google.com/p/android/issues/detail?id=55228
        Animation doNothingAnim = new AlphaAnimation(1, 1);
        doNothingAnim.setDuration(getNextAnimationDuration(parent, DEFAULT_CHILD_ANIMATION_DURATION));
        return doNothingAnim;
    } else {
        return super.onCreateAnimation(transit, enter, nextAnim);
    }
}

private static long getNextAnimationDuration(Fragment fragment, long defValue) {
    try {
        // Attempt to get the resource ID of the next animation that
        // will be applied to the given fragment.
        Field nextAnimField = Fragment.class.getDeclaredField("mNextAnim");
        nextAnimField.setAccessible(true);
        int nextAnimResource = nextAnimField.getInt(fragment);
        Animation nextAnim = AnimationUtils.loadAnimation(fragment.getActivity(), nextAnimResource);

        // ...and if it can be loaded, return that animation's duration
        return (nextAnim == null) ? defValue : nextAnim.getDuration();
    } catch (NoSuchFieldException|IllegalAccessException|Resources.NotFoundException ex) {
        Log.w(TAG, "Unable to load next animation from parent.", ex);
        return defValue;
    }
} 
```

不幸的是，它确实需要反思。但是，由于此解决方法适用于支持库，因此除非更新支持库，否则不会冒底层实现更改的风险。如果您从源代码构建支持库，则可以为下一个动画资源 ID 添加访问器，`Fragment.java`并消除对反射的需要。

此解决方案无需“猜测”父动画的持续时间（因此“什么都不做”动画与父动画的退出动画具有相同的持续时间），并允许您仍然对子片段执行自定义动画（例如，如果您用不同的动画重新交换子片段）。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-02-22T05:53:28.477

为了避免用户在事务中删除/替换父片段时看到嵌套片段消失，您可以通过提供它们出现在屏幕上的图像来“模拟”仍然存在的那些片段。此图像将用作嵌套片段容器的背景，因此即使嵌套片段的视图消失，图像也会模拟它们的存在。此外，我不认为失去与嵌套片段视图的交互性是一个问题，因为我认为您不希望用户在它们刚刚被删除的过程中对它们采取行动（可能作为用户操作作为好）。

我做了一个设置背景图像的[小例子（一些基本的东西）。](https://gist.github.com/luksprog/4996190)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-03-26T21:54:37.777

我能够想出一个非常干净的解决方案。IMO 它是最不老套的，虽然这在技术上是“绘制位图”解决方案，但至少它由片段库抽象。

确保您的孩子使用以下代码覆盖父类：

```
private static final Animation dummyAnimation = new AlphaAnimation(1,1);
static{
    dummyAnimation.setDuration(500);
}

@Override
public Animation onCreateAnimation(int transit, boolean enter, int nextAnim) {
    if(!enter && getParentFragment() != null){
        return dummyAnimation;
    }
    return super.onCreateAnimation(transit, enter, nextAnim);
} 
```

如果我们在子片段上有一个退出动画，它们将被动画化而不是眨眼。我们可以通过一个动画来利用这一点，该动画只是在一段时间内以完整的 Alpha 绘制子片段。这样，它们将在父片段动画时保持可见，从而提供所需的行为。

我能想到的唯一问题是跟踪该持续时间。我也许可以将它设置为一个很大的数字，但如果它仍在某处绘制动画，我担心它可能会出现性能问题。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-01-16T00:35:50.183

为了清楚起见，我发布了我的解决方案。解决方案非常简单。如果您试图模仿父片段事务动画，只需简单地将自定义动画添加到具有相同持续时间的子片段事务。哦，确保在 add() 之前设置自定义动画。

```
getChildFragmentManager().beginTransaction()
        .setCustomAnimations(R.anim.none, R.anim.none, R.anim.none, R.anim.none)
        .add(R.id.container, nestedFragment)
        .commit(); 
```

R.anim.none 的 xml（我的父母进入/退出动画时间是 250 毫秒）

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <translate android:fromXDelta="0" android:toXDelta="0" android:duration="250" />
</set> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-02-21T14:40:34.607

我知道这可能无法完全解决您的问题，但也许它会适合其他人的需求，您可以为您的孩子添加`enter`/`exit`和`popEnter`/动画，而这些动画实际上不会移动/动画s。只要动画与其父动画具有相同的持续时间/偏移量，它们就会看起来与父动画一起移动/动画。`popExit``Fragment``Fragment``Fragment`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-12-14T07:42:04.217

您可以在子片段中执行此操作。

```
@Override
public Animator onCreateAnimator(int transit, boolean enter, int nextAnim) {
    if (true) {//condition
        ObjectAnimator objectAnimator = ObjectAnimator.ofFloat(getView(), "alpha", 1, 1);
        objectAnimator.setDuration(333);//time same with parent fragment's animation
        return objectAnimator;
    }
    return super.onCreateAnimator(transit, enter, nextAnim);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-03T23:45:34.173

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

编辑：我最终没有实现这个解决方案，因为它还有其他问题。Square 最近推出了 2 个替换片段的库。我想说这实际上可能是一个比试图破解片段做谷歌不希望他们做的事情更好的选择。

[http://corner.squareup.com/2014/01/mortar-and-flow.html](http://corner.squareup.com/2014/01/mortar-and-flow.html)

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

我想我会提出这个解决方案来帮助将来遇到这个问题的人。如果您追溯原始发布者与其他人的对话，并查看他发布的代码，您会看到原始发布者最终得出在子片段上使用无操作动画同时为父片段设置动画的结论。此解决方案并不理想，因为它会强制您跟踪所有子片段，这在将 ViewPager 与 FragmentPagerAdapter 一起使用时可能会很麻烦。

**由于我在所有地方都使用子片段，因此我想出了这个高效且模块化的解决方案（因此可以轻松删除），以防他们修复它并且不再需要这种无操作动画。**

有很多方法可以实现这一点。我选择使用单例，我称之为 ChildFragmentAnimationManager。它基本上会根据它的父片段为我跟踪一个子片段，并在被询问时对孩子应用无操作动画。

```
public class ChildFragmentAnimationManager {

private static ChildFragmentAnimationManager instance = null;

private Map<Fragment, List<Fragment>> fragmentMap;

private ChildFragmentAnimationManager() {
    fragmentMap = new HashMap<Fragment, List<Fragment>>();
}

public static ChildFragmentAnimationManager instance() {
    if (instance == null) {
        instance = new ChildFragmentAnimationManager();
    }
    return instance;
}

public FragmentTransaction animate(FragmentTransaction ft, Fragment parent) {
    List<Fragment> children = getChildren(parent);

    ft.setCustomAnimations(R.anim.no_anim, R.anim.no_anim, R.anim.no_anim, R.anim.no_anim);
    for (Fragment child : children) {
        ft.remove(child);
    }

    return ft;
}

public void putChild(Fragment parent, Fragment child) {
    List<Fragment> children = getChildren(parent);
    children.add(child);
}

public void removeChild(Fragment parent, Fragment child) {
    List<Fragment> children = getChildren(parent);
    children.remove(child);
}

private List<Fragment> getChildren(Fragment parent) {
    List<Fragment> children;

    if ( fragmentMap.containsKey(parent) ) {
        children = fragmentMap.get(parent);
    } else {
        children = new ArrayList<Fragment>(3);
        fragmentMap.put(parent, children);
    }

    return children;
}

} 
```

接下来，您需要有一个扩展所有 Fragment 扩展的 Fragment 的类（至少是您的子 Fragment）。我已经有这门课了，我称之为 BaseFragment。创建片段视图时，我们将其添加到 ChildFragmentAnimationManager，并在其销毁时将其删除。您可以在附加/分离或序列中的其他匹配方法上执行此操作。我选择 Create/Destroy View 的逻辑是因为如果 Fragment 没有 View，我不关心动画它以继续被看到。这种方法也应该更适用于使用 Fragment 的 ViewPager，因为您不会跟踪 FragmentPagerAdapter 持有的每一个 Fragment，而只会跟踪 3 个。

```
public abstract class BaseFragment extends Fragment {

@Override
public  View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    Fragment parent = getParentFragment();
    if (parent != null) {
        ChildFragmentAnimationManager.instance().putChild(parent, this);
    }

    return super.onCreateView(inflater, container, savedInstanceState);
}

@Override
public void onDestroyView() {
    Fragment parent = getParentFragment();
    if (parent != null) {
        ChildFragmentAnimationManager.instance().removeChild(parent, this);
    }

    super.onDestroyView();
}

} 
```

现在你所有的 Fragment 都由父 Fragment 存储在内存中，你可以像这样对它们调用 animate ，你的子 Fragment 不会消失。

```
FragmentTransaction ft = getActivity().getSupportFragmentManager().beginTransaction();
ChildFragmentAnimationManager.instance().animate(ft, ReaderFragment.this)
                    .setCustomAnimations(R.anim.up_in, R.anim.up_out, R.anim.down_in, R.anim.down_out)
                    .replace(R.id.container, f)
                    .addToBackStack(null)
                    .commit(); 
```

另外，只要你有它，这里是你的 res/anim 文件夹中的 no_anim.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android" android:interpolator="@android:anim/linear_interpolator">
    <translate android:fromXDelta="0" android:toXDelta="0"
        android:duration="1000" />
</set> 
```

同样，我不认为这个解决方案是完美的，但它比每个实例都有一个子片段要好得多，在父片段中实现自定义代码以跟踪每个子片段。我去过那里，它并不好玩。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-08T02:23:34.580

我认为我找到了比 Luksprog 建议的将当前片段快照到位图更好的解决方案。

诀窍是**隐藏**被移除或分离的片段，只有在动画完成后，片段才会在其自己的片段事务中被移除或分离。

想象一下，我们有`FragmentA`和`FragmentB`，都有子片段。现在你通常会这样做：

```
getSupportFragmentManager()
  .beginTransaction()
  .setCustomAnimations(anim1, anim2, anim1, anim2)
  .add(R.id.fragmentHolder, new FragmentB())
  .remove(fragmentA)    <-------------------------------------------
  .addToBackStack(null)
  .commit() 
```

相反，你做

```
getSupportFragmentManager()
  .beginTransaction()
  .setCustomAnimations(anim1, anim2, anim1, anim2)
  .add(R.id.fragmentHolder, new FragmentB())
  .hide(fragmentA)    <---------------------------------------------
  .addToBackStack(null)
  .commit()

fragmentA.removeMe = true; 
```

现在对于 Fragment 的实现：

```
public class BaseFragment extends Fragment {

    protected Boolean detachMe = false;
    protected Boolean removeMe = false;

    @Override
    public Animation onCreateAnimation(int transit, boolean enter, int nextAnim) {
        if (nextAnim == 0) {
            if (!enter) {
                onExit();
            }

            return null;
        }

        Animation animation = AnimationUtils.loadAnimation(getActivity(), nextAnim);
        assert animation != null;

        if (!enter) {
            animation.setAnimationListener(new Animation.AnimationListener() {
                @Override
                public void onAnimationStart(Animation animation) {
                }

                @Override
                public void onAnimationEnd(Animation animation) {
                    onExit();
                }

                @Override
                public void onAnimationRepeat(Animation animation) {
                }
            });
        }

        return animation;
    }

    private void onExit() {
        if (!detachMe && !removeMe) {
            return;
        }

        FragmentTransaction fragmentTransaction = getFragmentManager().beginTransaction();
        if (detachMe) {
            fragmentTransaction.detach(this);
            detachMe = false;
        } else if (removeMe) {
            fragmentTransaction.remove(this);
            removeMe = false;
        }
        fragmentTransaction.commit();
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-25T05:59:57.663

我对地图片段有同样的问题。它在其包含的片段的退出动画期间不断消失。解决方法是为子地图片段添加动画，使其在父片段的退出动画期间保持可见。子片段的动画在其持续期间将其 alpha 保持在 100%。

动画：**res/animator/keep_child_fragment.xml**

```
<?xml version="1.0" encoding="utf-8"?>    
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <objectAnimator
        android:propertyName="alpha"
        android:valueFrom="1.0"
        android:valueTo="1.0"
        android:duration="@integer/keep_child_fragment_animation_duration" />
</set> 
```

然后在将地图片段添加到父片段时应用动画。

**父片段**

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {

    View view = inflater.inflate(R.layout.map_parent_fragment, container, false);

    MapFragment mapFragment =  MapFragment.newInstance();

    getChildFragmentManager().beginTransaction()
            .setCustomAnimations(R.animator.keep_child_fragment, 0, 0, 0)
            .add(R.id.map, mapFragment)
            .commit();

    return view;
} 
```

最后，在资源文件中设置子片段动画的持续时间。

**值/整数.xml**

```
<resources>
  <integer name="keep_child_fragment_animation_duration">500</integer>
</resources> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-21T13:47:24.307

为了动画嵌套片段的消失，我们可以在 ChildFragmentManager 上强制弹出堆栈。这将触发过渡动画。为此，我们需要赶上 OnBackButtonPressed 事件或监听 backstack 更改。

这是带有代码的示例。

```
View.OnClickListener() {//this is from custom button but you can listen for back button pressed
            @Override
            public void onClick(View v) {
                getChildFragmentManager().popBackStack();
                //and here we can manage other fragment operations 
            }
        });

  Fragment fr = MyNeastedFragment.newInstance(product);

  getChildFragmentManager()
          .beginTransaction()
                .setTransition(FragmentTransaction.TRANSIT_FRAGMENT_CLOSE)
                .replace(R.neasted_fragment_container, fr)
                .addToBackStack("Neasted Fragment")
                .commit(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-10-24T00:17:43.110

我最近在我的问题中遇到了这个问题：[嵌套片段转换不正确](https://stackoverflow.com/questions/46859132/nested-fragments-transitioning-incorrectly)

我有一个解决方案，可以在不保存位图、不使用反射或任何其他不满意的方法的情况下解决这个问题。

可以在此处查看示例项目：[https ://github.com/zafrani/NestedFragmentTransitions](https://github.com/zafrani/NestedFragmentTransitions)

可以在此处查看效果的 GIF：[https ://imgur.com/94AvrW4](https://imgur.com/94AvrW4)

在我的示例中，有 6 个子片段，分为两个父片段。我能够毫无问题地实现进入、退出、弹出和推送的转换。配置更改和后压也成功处理。

大部分解决方案在我的 BaseFragment（由我的子片段和父片段扩展的片段）的 onCreateAnimator 函数中，如下所示：

```
 override fun onCreateAnimator(transit: Int, enter: Boolean, nextAnim: Int): Animator {
    if (isConfigChange) {
        resetStates()
        return nothingAnim()
    }

    if (parentFragment is ParentFragment) {
        if ((parentFragment as BaseFragment).isPopping) {
            return nothingAnim()
        }
    }

    if (parentFragment != null && parentFragment.isRemoving) {
        return nothingAnim()
    }

    if (enter) {
        if (isPopping) {
            resetStates()
            return pushAnim()
        }
        if (isSuppressing) {
            resetStates()
            return nothingAnim()
        }
        return enterAnim()
    }

    if (isPopping) {
        resetStates()
        return popAnim()
    }

    if (isSuppressing) {
        resetStates()
        return nothingAnim()
    }

    return exitAnim()
} 
```

活动和父片段负责设置这些布尔值的状态。从我的示例项目中查看方式和位置更容易。

在我的示例中，我没有使用支持片段，但可以对它们及其 onCreateAnimation 函数使用相同的逻辑

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-13T23:53:11.337

解决这个问题的一个简单方法是使用`Fragment`这个库中的类而不是标准库片段类：

[https://github.com/marksalpeter/contract-fragment](https://github.com/marksalpeter/contract-fragment)

作为旁注，该包还包含一个有用的委托模式，称为`ContractFragment`您可能会发现它对利用父子片段关系构建应用程序很有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-06-06T19:07:36.843

从@kcoppock 的上述回答中，

如果您有 Activity->Fragment->Fragments （多个堆叠，以下有帮助），请对最佳答案恕我直言进行小幅编辑。

```
public Animation onCreateAnimation(int transit, boolean enter, int nextAnim) {

    final Fragment parent = getParentFragment();

    Fragment parentOfParent = null;

    if( parent!=null ) {
        parentOfParent = parent.getParentFragment();
    }

    if( !enter && parent != null && parentOfParent!=null && parentOfParent.isRemoving()){
        Animation doNothingAnim = new AlphaAnimation(1, 1);
        doNothingAnim.setDuration(getNextAnimationDuration(parent, DEFAULT_CHILD_ANIMATION_DURATION));
        return doNothingAnim;
    } else
    if (!enter && parent != null && parent.isRemoving()) {
        // This is a workaround for the bug where child fragments disappear when
        // the parent is removed (as all children are first removed from the parent)
        // See https://code.google.com/p/android/issues/detail?id=55228
        Animation doNothingAnim = new AlphaAnimation(1, 1);
        doNothingAnim.setDuration(getNextAnimationDuration(parent, DEFAULT_CHILD_ANIMATION_DURATION));
        return doNothingAnim;
    } else {
        return super.onCreateAnimation(transit, enter, nextAnim);
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-13T15:53:50.927

我的问题是父片段删除（ft.remove（fragment）），子动画没有发生。

基本问题是子片段在父片段退出动画之前立即被销毁。

子片段自定义动画不会在父片段移除时执行

正如其他人所逃避的那样，在移除 PARENT 之前隐藏 PARENT（而不是孩子）是要走的路。

```
 val ft = fragmentManager?.beginTransaction()
            ft?.setCustomAnimations(R.anim.enter_from_right,
                    R.anim.exit_to_right)
            if (parentFragment.isHidden()) {
                ft?.show(vehicleModule)
            } else {
                ft?.hide(vehicleModule)
            }
            ft?.commit() 
```

如果您确实想删除父级，您可能应该在自定义动画上设置一个侦听器以了解动画何时结束，这样您就可以安全地对父级片段进行一些最终确定（删除）。如果您不及时执行此操作，您最终可能会终止动画。NB 动画是在它自己的异步队列上完成的。

顺便说一句，您不需要子片段上的自定义动画，因为它们将继承父动画。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-08-14T19:12:09.620

该问题已在`androidx.fragment:fragment:1.2.0-alpha02`. 有关详细信息，请参阅[https://issuetracker.google.com/issues/116675313 。](https://issuetracker.google.com/issues/116675313)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-10-26T11:48:38.517

旧线程，但万一有人在这里绊倒：

上述所有方法对我来说都没有吸引力，位图解决方案非常肮脏且性能不佳；其他的要求子片段了解用于创建相关子片段的事务中使用的转换的持续时间。在我看来，一个更好的解决方案类似于以下内容：

```
val currentFragment = supportFragmentManager.findFragmentByTag(TAG)
val transaction = supportFragmentManager
    .beginTransaction()
    .setCustomAnimations(anim1, anim2, anim1, anim2)
    .add(R.id.fragmentHolder, FragmentB(), TAG)
if (currentFragment != null) {
    transaction.hide(currentFragment).commit()
    Handler().postDelayed({
        supportFragmentManager.beginTransaction().remove(currentFragment).commit()
    }, DURATION_OF_ANIM)
} else {
    transaction.commit()
} 
```

我们只是隐藏当前片段并添加新片段，当动画完成后我们删除旧片段。这样，它在一个地方处理，并且不创建位图。

# jquery - 使用jQuery查找一个元素相对于另一个元素的距离

> ID：14900741
> 
> 赞同：0
> 
> 时间：2013-02-15T18:08:02.457
> 
> 标签：jquery, offset

我有一系列文章，每页重复 10 次。结构是这样的：

```
<article class="postWrap">
     <h2>Title</h2>
     <p>Here is text</p>
</article> 
```

我需要找到 p 标签到文章顶部的距离。因此，根据标题的长度，p 标签与文章顶部的距离可能会有所不同。最好的方法最有可能使用`offset()`，但我无法让它正常工作。

谢谢

更新：

这是我编写的工作代码，但我想有一种更好的方法：

```
$(".postWrap").each(function(){
        var postWrap = $(this).offset().top;
        var firstP = $(this).find("p:first-of-type").offset().top;
        var diff = firstP - postWrap;
        var meta = $(this).find(".meta").css({'marginTop' : diff})

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:53:09.453

假设您的问题总是在`<h2>`您的第一个元素之前只有一个元素`<p>`，您可以使用元素的高度（`outerHeight`）`<h2>`而不是计算偏移量作为快捷方式：

```
$(".postWrap").each(function(){
    var diff = $(this).find('h2:first').outerHeight();
    var meta = $(this).find(".meta").css('margin-top', diff);
}); 
```

从您的示例中我没有得到什么`.meta`，但是您可以尝试并告诉我它是否按预期工作。`innerHeight`如果更合适，您也可以使用。

编辑：或者作为没有声明变量的“单线”：

```
$(".postWrap").each(function(){
    $(this).find(".meta").css(
        'margin-top', 
        $(this).find('h2:first').outerHeight()
    );
}); 
```

# asp.net-mvc-4 - EF迁移配置类的Seed方法中获取App_Data文件夹路径

> ID：14900743
> 
> 赞同：7
> 
> 时间：2013-02-15T18:08:22.737
> 
> 标签：asp.net-mvc-4, ef-code-first, entity-framework-5, entity-framework-migrations

如何在代码优先迁移的配置类的 Seed 方法中获取 App_Data 文件夹的路径。

我想从我放在 App_Data 文件夹中的文件中读取，并且 Seed 方法在 update-database 命令之后运行。HttpContext.Current.Server.MapPath 显然不起作用，因为此时没有 HttpContext。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-20T04:29:24.040

我让它与类似的东西一起工作： `string MyPath = AppDomain.CurrentDomain.BaseDirectory + "/../App_Data"`

因为`AppDomain.CurrentDomain.BaseDirectory` 在“/bin”目录结束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T13:26:02.163

这是一种快速入门的方法：

```
var myPath = AppDomain.CurrentDomain.BaseDirectory;
//to quickly show the path, either attach another debugger or just throw an exception
throw new Exception(myPath); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-21T20:12:40.427

@Rusty Divine 给出了一个很好的答案，但也许你会发现这对你更好：

```
System.IO.Path.Combine( System.Text.RegularExpressions.Regex.Replace(AppDomain.CurrentDomain.BaseDirectory, @"\\bin\\Debug$", String.Empty, System.Text.RegularExpressions.RegexOptions.IgnoreCase) ,   RELATIVE_PATH,  "FILENAME.EXE"); 
```

例如：

```
System.IO.Path.Combine( System.Text.RegularExpressions.Regex.Replace(AppDomain.CurrentDomain.BaseDirectory, @"\\bin$", String.Empty, System.Text.RegularExpressions.RegexOptions.IgnoreCase) ,  "App_Data\\Init",   "fileName.txt"); 
```

`AppDomain.CurrentDomain.BaseDirectory`通过这种方式（使用 Regx），我们确保唯一的替换可能是字符串的后缀（末尾） 。如果服务器路径中有名为：“\bin\Debug”的子文件夹，它们将不会被替换。

此解决方案不区分大小写，这意味着“\BIN\debug”也将被替换。

此外，您不需要将字符串附加到一个字符串。 `System.IO.Path.Combine`会为你做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-28T04:48:59.110

对于它的价值......如果您要在单元测试中使用 BaseDirectory，则需要进行字符串替换。但是，这仍然存在它使用单元测试项目的路径的问题，因此如果您试图指向另一个项目中的文件，请注意这一点。在这种情况下，您将不得不对路径进行硬编码。

```
AppDomain.CurrentDomain.BaseDirectory.Replace("\\bin\\Debug","") + "\\App_Data"; 
```

# assembly - MASM 替代 NASM 填充到 510 字节，时间为 510 - ($-$$) db 0

> ID：14900757
> 
> 赞同：0
> 
> 时间：2013-02-15T18:09:16.793
> 
> 标签：assembly, nasm, padding, masm, bootloader

这个 NASM 声明的**MASM**替代方案是什么？

```
times 510 - ($-$$) db 0 
```

我正在制作 MBR 引导加载程序。基本上，这条语句用 0 填充内存上剩余的 510 字节，因为引导加载程序的大小应该是 512 字节。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T19:12:26.930

```
code segment use16
assume cs:code
org 7c00h
start:

; your code
db 510-($-start) dup(0)
dw 0AA55h

code ends
end start 
```

另一种选择是在输出文件中`org`实际*查找，* [NASM 手册中提到该](https://nasm.us/doc/nasmdo12.html#section-12.1.3)文件适用于 MASM 但不适用于 NASM：

```
; MASM only
        ORG 0 

        ; some boot sector code 

        ORG 510 
        DW 0xAA55 
```

# css - CSS选择器不是元素类型的孩子？

> ID：14900763
> 
> 赞同：97
> 
> 时间：2013-02-15T18:09:35.183
> 
> 标签：css, css-selectors

我想为`code`不在`a`标签内的元素设置样式。

实现这一目标的最佳方法是什么？

`code:not(a code)`似乎根本不起作用，至少在 Chrome 上，即使它[看起来应该](https://developer.mozilla.org/en/docs/CSS/:not)

我也不能让它从控制台工作。

还有其他我可以使用的纯 CSS 方法吗？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2013-02-15T18:10:29.333

`:not`不支持组合选择器。

如果我们谈论它的直接父母：

```
:not(a) > code 
```

否则没有办法在 CSS 中做到这一点。您必须覆盖它：

```
code {
    /* some styles */
}

a code {
    /* override previous styles */
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2021-07-01T13:21:01.857

实际上，您应该可以使用您的代码，或者您可以使用通配符来选择所有不被选择的元素

```
code:not(a *) {
  font-weight: bold;
} 
```

[密码笔](https://codepen.io/jkohlin/pen/OJmVXEO)

# jenkins - 多配置詹金斯工作订单

> ID：14900765
> 
> 赞同：6
> 
> 时间：2013-02-15T18:09:42.340
> 
> 标签：jenkins

我正在使用具有顺序执行的多重配置作业。2 轴： - 从站 - 用户定义 

詹金斯以“随机”的顺序运行我的工作。

有没有办法解决这个订单？为什么詹金斯不使用使用定义变量的顺序（第一行在前）？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-12-08T20:09:07.677

为此可以使用`Matrix configuration sorter plugin`[1]。安装插件后，你会得到一个选项`Execution order of builds`，有以下值可供选择：

*   不在乎
*   估计的构建持续时间（最长的优先）
*   估计的构建持续时间（最短的优先）
*   最后轴顺序

选择最后一个选项应该按照轴中指定的方式对作业进行排序，尽管仅适用于最后一个。

[1] [https://wiki.jenkins-ci.org/display/JENKINS/Matrix+configuration+sorter+plugin](https://wiki.jenkins-ci.org/display/JENKINS/Matrix+configuration+sorter+plugin)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-06T21:28:17.607

根据[Jenkins: The Definitive Guide](http://books.google.com/books?id=m0n_yhblGysC&pg=PA267&lpg=PA267#v=onepage&q&f=false) by John Smart 的第 267 页，Jenkins 将以与参数值相同的方式使用轴的值，但是当触发时，作业将每个轴值运行一次。

这些值的顺序不是固定的（可能是随机的；我不确定）。大概这里的假设是有足够的构建从站，每个排列可以由不同的从站处理，并且排列的顺序无关紧要。我说排列是​​因为，如果有多个轴，则构建的总数对应于轴的笛卡尔积。

多轴场景可能回答了为什么无法在用户定义的轴中指定顺序：它会很复杂，并且当构建从属分布式时，它不是很有用。詹金斯根本不关心轴排序，这是有充分理由的。一个轴和一个构建从属的简单情况，其中顺序可能实际上很重要，本质上是一个边缘情况。

# ios - shouldAutorotateToInterfaceOrientation 在 4.3 中不会触发

> ID：14900766
> 
> 赞同：1
> 
> 时间：2013-02-15T18:09:42.810
> 
> 标签：ios

在我的 iPad 应用程序中，我有一个 UIScrollView。当我在“iPad 5 模拟器”下运行它时，应该 AutorotateToInterfaceOrientation 触发并且一切正常，但在“iPad 4.3 模拟器”中，此事件不会触发。

我应该如何解决这个问题？

另一个问题：当我在“iPad 5 模拟器”中测试我的应用程序时，此事件在启动时触发 7 次

这是我的代码的一部分：

#import "AppDelegate.h"

```
#import "ContentController.h"

@implementation AppDelegate

@synthesize window, contentController;

- (void)applicationDidFinishLaunching:(UIApplication *)application
   {
    NSString *nibTitle = @"iPad";
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
    { nibTitle = @"Iphone";
    }
    [[NSBundle mainBundle] loadNibNamed:nibTitle owner:self options:nil];

    [self.window addSubview:self.contentController.view];

    [window makeKeyAndVisible];
    }

@end 
```

内容控制器.h

@interface 内容控制器：UIViewController

```
{
    NSArray *contentList;
}

@property (nonatomic, retain) NSArray *contentList;

@end 
```

PadContentController.h

```
 ```
@interface PadContentController : ContentController <UIScrollViewDelegate>
        {   
        UIScrollView *appScrollView;
        NSMutableArray *viewControllers;
        }

    @property (nonatomic, retain) IBOutlet UIScrollView *AppScrollView;

    @property (nonatomic, retain) NSMutableArray *viewControllers;

    @end 
``` 
shouldAutorotateToInterfaceOrientation 在 PadContentController 中。

```
 -(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
            {
                [super shouldAutorotateToInterfaceOrientation:interfaceOrientation];
                switch (interfaceOrientation)
                {

                    case UIInterfaceOrientationPortraitUpsideDown:
                    case UIInterfaceOrientationPortrait:
                      return NO;

                    default:
                        return YES;
                }
            } 
```

我在 UIScrollView 中添加了一些视图，在每个视图中也实现了 shouldAutorotateToInterfaceOrientation。当我在“iPad 5 模拟器”中运行应用程序时，PadContentController 和所有视图中的 shouldAutorotateToInterfaceOrientation 都会被调用。但是当我在“在 iPad 4.3 模拟器中”运行它时，只调用第一个视图中的 shouldAutorotateToInterfaceOrientation（仅在启动时）并且 PadContentController 中的 shouldAutorotateToInterfaceOrientation 不会调用，因此不会发生旋转。

```

# sql - 从 shell 传递到 sqlplus 时可变长度的变化

> ID：14900767
> 
> 赞同：1
> 
> 时间：2013-02-15T18:09:46.030
> 
> 标签：sql, oracle, shell, unix, sqlplus

在将 1 个字符变量从 sqlplus 传递到 shell 时，我发现了这个烦人的异常情况。

```
echo "Please enter the upgrade option: "
read type

if [[ "$type" != "1" ]] && [[ "$type" != "2" ]]
then
            echo "You have entered an invalid response. Exiting."
    exit 0;
fi

sql_result=$($ORACLE_HOME/bin/sqlplus -s /nolog <<-EOF
connect $eval_user/$eval_pass@$db_name

SPOOL results.txt;
WHENEVER OSERROR EXIT 9;

DEFINE vType = '$type'
DEFINE type_flag = '$t_flag'
DEFINE vOrigowner = '$origOwner'
@@EV_DBUPGRADE.sql '&vType' '&vOrigowner' '&vAppConvFromDt' '&vAppConvThruDt' '&vAppConvStatusFlg' '&type_flag' 
```

在 EV_DBUPGRADE.sql 下，我在使用变量 vType 时发现了这个错误：

```
vOption        varchar2(1)  := UPPER('&1'); 
```

我收到这个抱怨缓冲区长度的烦人错误

```
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error: character string buffer too small
ORA-06512: at line 7 
```

如果使用 varchar2(10)，则不会发生错误。但是，我不想在一百万个不同的地方改变它。反正有限制吗？谁能告诉我如何在 BEGIN 之外的 sqlplus 中打印调试消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T23:58:34.117

我不确定这里到底发生了什么，但是 shell 正在对你的 shell 变量做一些事情。

我能够在 ksh 中复制您的错误（“testme.ksh”）

```
#!/bin/ksh

type="1"

sqlresult=$($ORACLE_HOME/bin/sqlplus -s /nolog << EOF
connect user/pswd@database
define vType = '$type'
@test.sql &vType
exit
/
EOF)

echo $sqlresult 
```

SQL 脚本（“test.sql”）：

```
declare
   vOption varchar2(1) := UPPER('&1');
begin
   dbms_output.put_line('Test: ' || vOption);
end;
/ 
```

输出：

```
Connected. old 2: vOption varchar2(1) := UPPER('&1'); new 2: vOption varchar2(1)
:= UPPER('$type'); declare test.sql testme.ksh ERROR at line 1: ORA-06502: PL/SQ
L: numeric or value error: character string buffer too small ORA-06512: at line
2 
```

我不确定为什么会这样，但我可以通过将 shell 变量直接传递给 SQL 脚本执行并绕过“define”语句来解决它：

```
#!/bin/ksh

type="1"

sqlresult=$($ORACLE_HOME/bin/sqlplus -s /nolog << EOF
connect user/pswd@database
@test.sql $type
exit
/
EOF)

echo $sqlresult 
```

输出：

```
Connected. old 2: vOption varchar2(1) := UPPER('&1'); new 2: vOption varchar2(1)
:= UPPER('1'); PL/SQL procedure successfully completed. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T23:59:09.323

好吧，似乎 rgettman 有实际的答案，但我将把它留在这里，稍微了解一下`prompt`......

* * *

添加调试的快速版本是使用提示：

```
prompt Arg 1 is &1 
```

或者你可以从 dual 中选择值，这有点混乱，或者在 a 周围有一个快速的匿名块`dbms_output`- 但对于这种快速检查 a`prompt`应该没问题。如果您只是在寻找替代值，您可以`set verify on`，这是默认设置，因此您的脚本目前可能将其关闭。

我似乎可以得到这种效果的唯一方法是如果我在被调用的脚本中有一个`set define off`（或`scan off`旧语法），所以它会尝试将文字字符串`&1`放入变量（显然不适合）而不是它的值代表。大概，从问题的第二部分，你看不到里面放了什么？

无论如何......如果这不是问题 - 如果单独调用它似乎不太可能 - 那么我想知道这是否是一个字符集问题，但这听起来也不正确。而且我还想知道为什么你要强制它是一个数值，然后将它作为一个字符串传递，这与问题并不相关。也许添加更多的 SQl 脚本可能会带来一些启示——至少从顶部到发生错误的地方。

# java - ResultSet 关闭后占用 RAM

> ID：14900770
> 
> 赞同：2
> 
> 时间：2013-02-15T18:09:56.200
> 
> 标签：java, postgresql, jdbc, resultset, ram

我有内存泄漏的问题。我的代码示意图：

```
CallableStatement c = Baza.conn.prepareCall("select * from something");           
ResultSet rs = c.executeQuery();//takes about 100sec

while(rs.next())
{
//do stuff, only calculations, I don't create any object
}   

rs.close();
c.close(); 
```

在`executeQuery`执行 RAM 时，使用率高达 300MB，并且再也不会下降。当程序再次在同一个地方（但选择略有不同）时，Ram 使用率有时会再次上升，有时不会。我应该做的不仅仅是接近`ResultSet`吗？非常感谢您的帮助，因为现在我必须每隔几个小时重新启动该程序。

我正在使用 JDBC4 和 posgresql

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:32:48.420

您可以使用游标并设置提取大小以减少查询的内存使用量。

```
Baza.conn.setAutoCommit(false); // Turn off autocommit on the connection to enable cursors in JDBC
CallableStatement c = Baza.conn.prepareCall("select * from something");           
c.setFetchSize(1000); // The fetch size determines the number of records returned in each "Batch"
ResultSet rs = c.executeQuery();// This may appear to run faster depending on the query

// Nothing changes here.  The JDBC driver handles the cursor for you.
while(rs.next())
{
//do stuff, only calculations, I don't create any object
}   

rs.close(); // This will close the cursor
c.close(); // I would recommend re-enabling autocommit if you weren't closing the connection here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:14:18.420

您可以使用 ：

```
Baza.conn.setAutoCommit(false); 
```

在 ResultSet 之前，并使用：

```
rs.getMoreResults(java.sql.Statement.CLOSE_CURRENT_RESULT);
Baza.conn.commit(); 
```

在 ResultSet 之后和之前

```
rs.close();
c.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:20:09.717

如果查询需要那么长时间，则可能是连接速度非常慢，或者您返回了大量数据。将所有数据保存在 RAM 中并不是最好的解决方案。正如 Jigar Joshi 的评论已经指出的那样：您可能想研究分页。此外，关闭连接也是一个好习惯。关于垃圾收集，请考虑 Java7，它有一个新的垃圾收集器（例如，请参阅[Java 7 (JDK 7) 垃圾收集和 G1 上的文档](https://stackoverflow.com/questions/8111310/java-7-jdk-7-garbage-collection-and-documentation)），可能更适合您的需求

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:13:59.100

确保也关闭“conn”。

JVM 在内部管理内存。您不必期望您的操作系统报告的 RAM 利用率会立即释放。当 JVM 执行垃圾回收时，它最终应该被释放。配置 JMX 监听器，使用 JConsole 监控 JVM 内存，不要信任操作系统。

# postgis - PostGIS位置定位错误

> ID：14900776
> 
> 赞同：0
> 
> 时间：2013-02-15T18:10:15.593
> 
> 标签：postgis

我不确定这是否是问这个问题的正确地方，但我想我会试一试。我有一个导入 PostGIS 的世界地图 shapefile，并在测试表中添加了几个点。这些应该在英国，但它们就在马达加斯加海岸附近。我显然做错了什么，但是查看两张表的 ogrinfo ，我得到：

```
Layer name: countries
Geometry: 3D Multi Polygon
Feature Count: 525
Extent: (-180.000000, -89.999933) - (180.000000, 84.134162)
Layer SRS WKT:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
FID Column = gid
Geometry Column = geom
scalerank: Integer (2.0)
featurecla: String (32.0)
name: String (254.0)
namealt: String (254.0)
region: String (50.0)
subregion: String (50.0)

INFO: Open of `PG:dbname=g4wd'
      using driver `PostgreSQL' successful.

Layer name: test
Geometry: 3D Point
Feature Count: 2
Extent: (51.009400, -2.638900) - (51.571400, 0.695600)
Layer SRS WKT:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Geometry Column = location
id: Integer (0.0)
name: String (25.0) 
```

所以我很困惑我应该检查什么。有谁知道我需要检查或做什么，因为所有的 prj 信息似乎都是正确的？

编辑：添加了 geometry_columns 详细信息 - 不确定是否相关。

```
g4wd=# select * from geometry_columns;
 f_table_catalog | f_table_schema | f_table_name | f_geometry_column | coord_dimension | srid |     type     
-----------------+----------------+--------------+-------------------+-----------------+------+--------------
 g4wd            | public         | test         | location          |               2 | 4326 | POINT
 g4wd            | public         | countries    | geom              |               2 | 4326 | MULTIPOLYGON 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T22:46:28.023

坐标数据`test`需要转置 (Y, X) -> (X, Y)，因为 PostGIS（和大多数其他 GIS 软件）的轴顺序是经度、纬度（不是相反！）。

如果此数据已加载，请使用以下 SQL 更新语句交换轴顺序：

```
UPDATE test SET
  location = ST_SetSRID(ST_MakePoint(ST_Y(location), ST_X(location)), 4326); 
```

# php - 使用jquery将多个复选框中的值添加到数据库中的同一行

> ID：14900778
> 
> 赞同：1
> 
> 时间：2013-02-15T18:10:23.990
> 
> 标签：php, javascript, jquery, mysql

我已经研究了 2 天，但还没有找到适当的解决方案来解决我的问题。本质上，我正在尝试使用 jQuery 基于多个复选框按 ID “链接”数据库行，但这里有点棘手：

### 背景：

*   我有一个`positions`显示为 HTML 表 ( `#ct`) 的数据库表 ()，每行旁边都有复选框。
*   一次最多可以检查四 (4) 行并相互“链接”（但不必担心可以检查的框数限制）
*   `positions`从SHOULD链接行创建一个新行，`covered_positions`其中包含列`id`(PK), `linked_id1`, `linked_id2`, `linked_id3`,`linked_id4`

### 已经做了什么：

*   每个复选框*已经*将其值分配`id`给`positions`
*   一个下拉选择框*已经*触发了 Javascript 函数`ctActions()`

### 我*认为*需要的：

*   **`ctActions()`**使用以下方法在复选框值中创建一个数组：

    ```
    var linked_ids = [];

    $("#ct input[type='checkbox']:checked").each(function() {
        linked_ids.push(this.value);
    }); 
    ```

*   将数据编码并发送到 PHP：

    ```
    var linked_ids_json = JSON.stringify(linked_ids);

    $.post('link-positions.php', { linked_ids_json: linked_ids_json } ); 
    ```

* * *

*   在我的**`link-positions.php`**：

    ```
    // Get & explode array
    $array = json_decode($_POST['linked_ids_json']);

    // Test whether each value is set -- Not sure if needed
    $linked_id1 = (isset($array[0]) ? $array[0] : "");
    $linked_id2 = (isset($array[1]) ? $array[1] : "");
    $linked_id3 = (isset($array[2]) ? $array[2] : "");
    $linked_id4 = (isset($array[3]) ? $array[3] : "");

    include('../mysqli-connect.php');
    $conn = dbConnect();

    $sql = "INSERT INTO `covered_positions` (
        linked_id1,
        linked_id2,
        linked_id3,
        linked_id4)
        VALUES (?, ?, ?, ?)";

    $stmt = $conn->prepare($sql);
    $stmt->bind_param('iiii',
                $linked_id1,
                $linked_id2,
                $linked_id3,
                $linked_id4);

    $stmt->execute();

    $conn->close(); 
    ```

但在这一切之后，什么都没有发生。我确定我的代码中有一些明显的错误，所以我想我会发布它以供一些更有经验的人看。

### 更新

*   已修复但仍未解决问题`$stmt->execute`。`$stmt->execute()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:58:59.167

`AJAX`如果请求成功完成或出现任何错误，请检查 FireBug 。

接下来，检查您在服务器上获取的数据`print_r($_POST);`

考虑到您的 HTML 就像

```
<form id="form1">
    <input class="cb" type="checkbox" value="a" name="cbTest[]" />
    <input class="cb" type="checkbox" value="b" name="cbTest[]" />
    <input class="cb" type="checkbox" value="c" name="cbTest[]" />
    <input class="cb" type="checkbox" value="d" name="cbTest[]" />
</form> 
```

我建议您通过使用来获取检查值

```
// if the form only contains checkboxes
var linked_ids_json = $('#form1').serialize();

// Or
var linked_ids_json = $('.cb').serialize();
$.ajax({
    type: 'post',
    url: 'link-positions.php',
    data: linked_ids_json,
    success: function () {
        // callback
    }
}); 
```

在 PHP 中使用，例如，

```
$array = $_POST['linked_ids_json']; 
```

您将能够访问以下值`$linked_id[0];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T19:10:33.370

由OP解决。这最初被编辑到问题正文中：

> 我发现 link-positions.php 文件在错误的目录中！下面的代码工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T19:25:11.313

我设法解决了这个问题。代码工作正常，只是 link-positions.php 位于错误的目录中。希望代码可以帮助其他人完成类似的任务。

# debugging - 在调试期间在 IDE 中显示 printf 消息

> ID：14900780
> 
> 赞同：6
> 
> 时间：2013-02-15T18:10:38.427
> 
> 标签：debugging, arm, cortex-m3, keil

我们有一个设备，我想使用 printf 函数将消息发送到 IDE 以进行调试。设置：

*   ARM Cortex-M3 设备

*   ULINK2接口

*   uVision4 IDE

我已按照[此链接](http://www.keil.com/support/man/docs/ulink2/ulink2_trace_itm_viewer.htm)中的说明进行操作，以便能够在“调试（printf）查看器”中查看消息。首先我修改了“retarget.c”文件，将输出重定向到[ITM](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0337e/BABCCDFD.html)接口：

```
#include <stdio.h>
#include <rt_misc.h>

#pragma import(__use_no_semihosting_swi)

// Para utilização do saida de debug através do ULINK2
#define ITM_Port8(n)    (*((volatile unsigned char *)(0xE0000000+4*n)))
#define ITM_Port16(n)   (*((volatile unsigned short*)(0xE0000000+4*n)))
#define ITM_Port32(n)   (*((volatile unsigned long *)(0xE0000000+4*n)))
#define DEMCR           (*((volatile unsigned long *)(0xE000EDFC)))
#define TRCENA          0x01000000

struct __FILE { int handle; /* Add whatever you need here */ };
FILE __stdout;

// Escreve caractere na porta de Debug
int sendchar (int ch)  {          
  if (DEMCR & TRCENA) {
    while (ITM_Port32(0) == 0);
    ITM_Port8(0) = ch;
  }
  return(ch);
} 

int fputc(int ch, FILE *f) {
  return (sendchar(ch));
}

int ferror(FILE *f) {
  /* Your implementation of ferror */
  return EOF;
}

void _ttywrch(int ch) {  
  sendchar(ch);
}

void _sys_exit(int return_code) {
label:  goto label;  /* endless loop */
} 
```

然后我按照说明在uVision4中配置了IMT： ![在此处输入图像描述](../Images/5fad73acfc63e68972532c43c9a15018.png)

该项目编译良好。我将应用程序下载到设备并开始使用 uVision4 调试会话。在系统初始化之后，我尝试在主函数中使用带有简单消息的 printf，但调试查看器仍然为空。我已经在“sendchar”函数中设置了断点，我可以看到所有行都按预期命中。

有没有人成功地将 printf 与 ULINK2 和 uVision4 一起使用？有没有人知道为什么我在调试查看器窗口中看不到任何输出？

**更新**

我尝试使用现有的 ITM 函数，从而产生更简单的“retarget.c”：

```
int fputc(int ch, FILE *f) {
  return (ITM_SendChar((uint32_t)ch));
} 
```

然而，调试查看器中没有显示任何输出。当我跳过 printf 函数调用时，IDE 底部会显示“Trace: Data Overflow”，然后是“Trace: Communication Error”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T19:58:54.880

问题出在“Trace”配置中的“CoreClock”字段中。它与设备的时钟不匹配。在我更改它以匹配设备时钟后，调试查看器中显示了正确的输出。

一些有用的链接：

[uVision 中的跟踪状态](http://www.keil.com/support/man/docs/ulink2/ulink2_trace_status.htm)

[如何配置 Trace，一步一步](http://www.keil.com/support/man/docs/ulink2/ulink2_LPC17xx.htm)

# python - 如果没有重叠，使用 MultiIndex 的内部连接将失败

> ID：14900785
> 
> 赞同：7
> 
> 时间：2013-02-15T18:10:47.807
> 
> 标签：python, pandas

我无法让“空”内部连接与 MultiIndex 一起使用。在 0.10.1 下，我有：

```
d1 = pd.DataFrame({
    'i1': [1, 2, 2],
    'i2': [1, 1, 2],
     'a': [10,20,30]}).set_index(['i1', 'i2'])
d2 = pd.DataFrame({
    'i1': [3, 3],
    'i2': [1, 2],
    'b': [40, 50]}).set_index(['i1', 'i2'])
d1.join(d2, how='inner') 
```

这给了我

```
Exception: Cannot infer number of levels from empty list 
```

有什么好办法解决这个问题吗？我希望能够提前知道交叉路口是否为空，这样我就可以避免异常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T18:32:13.290

请求宽恕比许可更[容易](http://docs.python.org/2/glossary.html#term-eafp)：

```
import pandas as pd
d1 = pd.DataFrame({'i1': [1, 2, 2], 'i2': [1, 1, 2], 'a': [10, 20, 30]}
                  ).set_index(['i1', 'i2'])
d2 = pd.DataFrame(
    {'i1': [3, 3], 'i2': [1, 2], 'b': [40, 50]}).set_index(['i1', 'i2'])
try:
    d1.join(d2, how='inner')
except Exception as err:
    # Change this to however you wish to handle this case.
    print(err) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T02:29:26.527

我对此不是 100% 的，但是进行外部联接并删除 NA 与内部联接相同。因此，在没有匹配索引的情况下，您只会得到一个空数据框。如果我们修改您的示例以包含一条匹配记录，则情况似乎是这样：

```
import pandas as pd
d1 = pd.DataFrame({
    'i1': [1, 2, 2],
    'i2': [1, 1, 2],
    'a': [10,20,30]}).set_index(['i1', 'i2'])
d2 = pd.DataFrame({
    'i1': [1, 3],
    'i2': [1, 2],
    'b': [40, 50]}).set_index(['i1', 'i2'])
d3 = d1.join(d2, how='outer').dropna()
d4 = d1.join(d2, how='inner') 
```

这使：

```
In [9]: d3
Out[9]: 
        a   b
i1 i2        
1  1   10  40

In [10]: d4
Out[10]: 
        a   b
i1 i2        
1  1   10  40 
```

所以在外连接 + 之后`dropna()`，您可以看到有多少行`d3`并从那里开始。使用您的原始示例：

```
import pandas as pd
d1 = pd.DataFrame({
    'i1': [1, 2, 2],
    'i2': [1, 1, 2],
     'a': [10,20,30]}).set_index(['i1', 'i2'])
d2 = pd.DataFrame({
    'i1': [3, 3],
    'i2': [1, 2],
    'b': [40, 50]}).set_index(['i1', 'i2'])
d3 = d1.join(d2, how='outer').dropna()
print(d3.shape) # no error, shows "(0, 2)" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-19T01:09:02.933

通过逐块合并 HDFstore 中的多个索引节点，在 for 循环中解决了他的问题。像这样解决它丑陋，以后可能对其他人有帮助。

```
import pandas as pd
d1 = pd.DataFrame({
    'i1': [1, 2, 2],
    'i2': [1, 1, 2],
     'a': [10,20,30]}).set_index(['i1', 'i2'])
d2 = pd.DataFrame({
    'i1': [3, 3],
    'i2': [1, 2],
    'b': [40, 50]}).set_index(['i1', 'i2'])
for x in y:
    try:
        d3 = d1.join(d2, how='inner')
    except Exception:            
        print "no merge possible between rows, but let's continue"
        d3 = d1.join(d2, how='outer').dropna()
    if len(d3)
        print "there's a merge"
        #action
    print "fail, but still in the race" 
```

# jquery - 使用 jQuery 删除内容并附加类

> ID：14900790
> 
> 赞同：0
> 
> 时间：2013-02-15T18:10:52.103
> 
> 标签：jquery

我必须使用专有的 cms 博客来呈现它的“摘要标记”，其中包含

1.  省略号
2.  动态变化的链接（所以链接总是不同的）
3.  静态文字说：点击这里阅读更多。

这是摘要标记当前在页面上呈现的方式：

```
<p>Content goes here....<a href="example.htm">Click here to read more.</a></p>
<p>More content goes here....<a href="anothertest.htm">Click here to read more.</a></p>
<p>Content goes here....<a href="helloworld.htm">Click here to read more.</a></p> 
```

同时，我想用一些 jquery 来控制摘要标记，所以我不限于通过以下方式进行严格的显示：

1.  删除每个`ellipsis`
2.  在包含省略号的后面附加一个`class`ONLY `href`，因此它不会更新页面上的其他链接。

这将是非常期望的预期结果。

```
<p>Content goes here.<a href="example.htm" class="readmore">Click here to read more.</a></p>
<p>More content goes here.<a href="anothertest.htm" class="readmore">Click here to read more.</a>
<p>Content goes here.<a href="helloworld.htm" class="readmore">Click here to read more.</a> 
```

非常感谢您提前提供的帮助！

这就是我得到的，我知道这很糟糕

```
$("p").html("...").remove:after.attr(".readmore").attr("href")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:19:05.033

```
$('p').each(function () {
    var textNode = $(this).find('a:last-child').addClass('readmore')[0].previousSibling;

    textNode.textContent = textNode.textContent.replace(/\.{3}\s*$/, '');
}); 
```

这是小提琴：http: [//jsfiddle.net/sH2eA/](http://jsfiddle.net/sH2eA/)

# jsf-2 - h:selectManyCheckbox 不尊重属性“collectionType”

> ID：14900791
> 
> 赞同：4
> 
> 时间：2013-02-15T18:10:52.307
> 
> 标签：jsf-2, mojarra, selectmanycheckbox

几个`h:selectManyCheckbox`s 由这种类型的 map 支持：`Map<Type, ArrayList<MyItem>>`.

xhtml 片段如下所示：

```
<h:selectManyCheckbox
    value="#{backingBean.values['type']}"
    collectionType="java.util.ArrayList"
    converter="#{myCustomConverter}>
    <f:selectItems .../>
</h:selectManyCheckbox> 
```

复选框显示正确，转换器在两种方式中都正确使用。

不幸的是，当我在提交页面后尝试访问地图的值时，地图不再包含列表。相反，我得到一个 ClassCastException，因为这些值已被替换为`Object[]`.

[搜索互联网，我似乎遇到了与MyFaces](https://issues.apache.org/jira/browse/MYFACES-3522)完全相同的问题。

我想，我已经将问题追踪到`MenuRenderer`. EL 表达式的类型是确定的，在我的例子中这导致了 Object。但只有当类型首先相关时，才会尊重`Collection`该属性。`collectionType`

我使用的是Mojarra 2.1.0，但是即使是更高版本也没有改变相关的源代码。

加起来：

*   我是否有正确的期望`List`应该仍然是 a `List`？
*   我这真的是一个bug吗？如果是这样，是否已在以后的版本中修复？
*   有解决方法吗？

提前非常感谢。

问候，

丹尼尔

# sql - 我是否要从 AD 中的经理姓名中删除除姓名以外的所有内容？

> ID：14900797
> 
> 赞同：1
> 
> 时间：2013-02-15T18:11:09.077
> 
> 标签：sql, sql-server-2008, sql-server-2005

我不能为我的生活，弄清楚我在这里做错了什么。

当我运行查询以将名称从 Active Directory 提取到 sql server 数据库中时，输出如下所示：

```
CN=Jackson\, Andrew,OU=Information Technology,OU=Departments,DC=MO,DC=canton,DC=MA,DC=us. 
```

我想做的是每次都跳闸，所以输出看起来更像这样：

```
Jackson, Andrew 
```

下面的代码让我失望了。它一直告诉我 REPLACE 需要 3 个参数。

我似乎无法弄清楚。

```
REPLACE(LEFT(manager,charindex('','',manager)-1),''CN='','''') as Manager 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:22:48.890

```
REPLACE(SUBSTRING(<query output>,4,CHARINDEX(',OU=',<query output>) - 4),'\','') 
```

该解决方案对您的数据做了很多假设，但它可能对您有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:20:25.890

关于现有查询的问题，似乎所有双单引号都应该只是单单引号。

```
select REPLACE(LEFT(manager,charindex(',',manager)-1),'CN=','') as Manager 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:35:30.453

替换`\,`为字符串中不太可能出现的字符或字符组合，然后拆分为`,`，然后将特殊字符/组合变为`,`：

```
**REPLACE(**
  REPLACE(
    LEFT(
      **REPLACE(manager, ''\,'', CHAR(127))**,
      charindex('','',**REPLACE(manager, ''\,'', CHAR(127))**)-1),
    ''CN='',
    ''''
  ) **, CHAR(127), '','')** as Manager 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/d41d8/8868)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:15:25.553

正如 Marc 在评论中所写，可能有更好的方法来进行查询。我没有AD经验，所以我不会去那里。

不过，关于`REPLACE`，问题似乎是`''CN=''`。这些不应该是单引号吗？换句话说，它应该是`'CN='`。

# javascript - 如何使用 jquery 在更改函数中嵌套单击函数？

> ID：14900801
> 
> 赞同：0
> 
> 时间：2013-02-15T18:11:32.877
> 
> 标签：javascript, jquery, nested

我有一个带有两个选项的选择下拉菜单：是/否（实际上是三个：还有“选择一个选项”没有价值）。然后有一些处理一些变量的复选框（选中时变量被添加到全局变量（称为tot），当未选中时它们被减去）。我希望复选框有两种不同的行为，具体取决于下拉选项是或否。所以我写了这个，但我认为我误解/误解了一些东西，因为它不起作用（当它没有嵌套在更改选择函数中时它起作用）。

```
<select name="container" id="container">
<option id="none" value="" >Select an option</option>
<option id="no" value="no" >no</option>
<option id="yes" value="yes" >yes</option>
</select> 
```

这是javascript（带有jquery库）

```
var tot = 0;
$(document).ready(function () {

    $("#container").change(function () {
        var sel = $(this).find(":selected").attr("id")
        if (sel == "no" || sel == "none") {

            $("#in-category-1").click(function () {
                if ($('#in-category-1').is(':checked')) {
                    if (tot < 60) {
                        tot = tot + 2.5;
                    } else if (tot >= 60) {
                        alert('Stop!');
                        $('#in-category-1').attr('checked', false);
                    }
                } else if (tot > 0) {
                    tot = tot - 2.5;
                }
                functionblablabla();
                });
                if (sel == "yes") {

                    $("#in-category-1").click(function () {
                        if ($('#in-category-1').is(':checked')) {
                            if (tot < 50) {
                                tot = tot + 2.5;
                            } else if (tot >= 50) {
                                alert('Stop!');
                                $('#in-category-1').attr('checked', false);
                            }
                        } else if (tot > 0) {
                            tot = tot - 2.5;
                        }
                        functionblablabla2();
                    });
                });
            }); 
```

即使在页面加载时默认选择了选项（选项存储在数据库中），也会发生一些事情，所以如果没有选择同样的事情应该发生

```
 if (($('#no').prop('defaultSelected')) ||  ($('#none').prop('defaultSelected')) ) {
                                $("#in-category-1").click(function () {
                               //same stuff than change select no or select none
                               });
    }

    if ($('#yes').prop('defaultSelected')) {
                                $("#in-category-1").click(function () {
                               //same stuff than change select yes
                               });
    } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T20:22:01.547

您可以做得更好的几点：

*   括号
    *   看起来“如果是”应该是大 if 块的一部分
    *   缺少一些关闭的
*   不要创建全局 VAR
    *   将“tod”变量放入 dom 就绪函数中
*   分离之前的点击事件（否则如果选项更改多次，事件将汇总）

    `$("#in-category-1").off("click");`

*   使用快捷方式获取选定的值

    `$(this).val();`

小提琴：http: [//jsfiddle.net/kmybV/](http://jsfiddle.net/kmybV/)

# css - PhoneGap 和 HTML5/CSS 框架

> ID：14900804
> 
> 赞同：0
> 
> 时间：2013-02-15T18:11:46.460
> 
> 标签：css, cordova, cross-browser, kendo-ui

我的问题是关于代码的兼容性。如果我编写自己的 CSS 代码并将其与框架附带的代码混合，是否有可能无法在所有平台上都呈现良好？

我们是否面临与多个浏览器相同的问题？如果我使用PhoneGap，我应该为每个浏览器（webkit、mozilla、opera so）编写代码版本吗？

我希望它主要在 iOS 和 Android 上呈现良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:26:39.510

PhoneGap 使用OS 提供的原生Web 组件，例如UIWebView。iOS 和 Android 使用移动 webkit，但其他操作系统使用不同，例如 WP8 的 IE10。

因此，如果您针对多个操作系统，您也会遇到同样的问题。从一个版本的操作系统到另一个版本也有细微的差异......

# javascript - childNodes[] 在 IE9 中无法像在 IE7 和 8 中一样工作

> ID：14900805
> 
> 赞同：1
> 
> 时间：2013-02-15T18:11:49.330
> 
> 标签：javascript, internet-explorer, internet-explorer-9

我有一些适用于 IE7 和 8 但不适用于 9 的代码

```
var table = document.getElementById('RadGrid_ctl01').childNodes[2]; 
```

这在 IE9 中不起作用，现在我确实读到了 IE9 计数空格等，因此索引与 IE7 和 IE8 中的不同，所以当我将索引从 2 更改为 4 时，我调试并发现相同的值像这样：

```
var table = document.getElementById('RadGrid_ctl01').childNodes[4]; 
```

但是，当我稍后尝试使用此代码访问表对象时

```
var editor = table.childNodes[i].childNodes[j].childeNodes[0] 
```

变量编辑器将在 IE7 和 IE8 中获得预期值，但在 IE9 中它变为 null，因为 childNodes[j] 没有任何子节点。我不知道是什么原因造成的。i 和 j 都从 0 开始。

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:26:30.533

IE9 的行为是正确的，低版本是错误的。问题是由两个 html-tags 之间的空格引起的，这应该导致文本节点。

**更新：添加示例**

```
<ul><li>Foo</li><li>Bar</li></ul>

<ul>
    <li>Foo</li>
    <li>Bar</li>
</ul> 
```

看起来几乎一样，不是吗？但是生成的 DOM 不同。第一个示例将导致：

```
- ul
-- li
--- (text)Foo
-- li
---(text)Bar 
```

虽然第二个标记导致了这一点：

```
- ul
-- (text)
-- li
--- (text)Foo
-- (text)
-- li
--- (text)Bar
-- (text) 
```

而且由于文本节点不能有任何子节点，这会导致您的 Javascript 静默失败。

**可能的解决方案**

一种解决方案是去除空的文本节点。我曾经为这个问题写过一个[要点](https://gist.github.com/1UnitedPower/4072004)。

**更新：**

[`Node.normalize()`](https://developer.mozilla.org/en-US/docs/DOM/Node.normalize)似乎是一个更可靠的解决方案，但我没有检查它的浏览器兼容性。

# entity-framework-5 - 实体框架 5 列映射日期时间

> ID：14900813
> 
> 赞同：0
> 
> 时间：2013-02-15T18:12:09.430
> 
> 标签：entity-framework-5

这似乎不起作用：

```
this.Property(t => t.mydatetime)
    .HasColumnType("datetime")
    .HasColumnName("mydatetime"); 
```

查看 sql profiler 更新 sql 字符串仍然使用 datetime2(7) 并使用额外的小数位。这样做的结果是 datetime2 和 datetime 之间的舍入差异。

如何强制实体框架使用 datetime sql 类型？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T22:15:36.063

`HasColumnType("datetime")`指定列类型，而不是 SQL 语句中使用的临时参数类型。你无法控制这些，也没有必要。如果您`DateTime`的应用程序中有一个 .NET 填充了一些小数位，并且希望将其存储`datetime`在 SQL Server 中的类型中，则该值将（并且只能）存储为舍入值。舍入是在将 SQL 发送到数据库服务器之前发生在客户端还是发生在数据库服务器本身上都没有关系。结果将是相同的：具有精度损失的舍入存储值。

# sharepoint-2010 - Sharepoint 全新安装如何设置站点 - 获取 _layouts/error.aspx

> ID：14900815
> 
> 赞同：0
> 
> 时间：2013-02-15T18:12:15.723
> 
> 标签：sharepoint-2010

我们全新安装了一个 Sharepoint 站点。管理面板已全部设置完毕，但我们需要设置一个基本团队站点。我尝试创建一个网站集并使用 Teamsite 作为我们的基础，但我不断收到 /_layouts/error.aspx。你如何做一个新鲜的网站？有关于如何在站点已经设置后设置团队站点的教程，但没有来自全新安装的教程。我们如何建立一个新网站？有点沮丧。我们只是得到这个错误：发生了意外错误。它重定向到/_layouts/error.aspx。

有任何想法吗？谢谢。

附加信息：我们试图访问的站点实际上是与我们的管理区域不同的站点，而不是我们面向公众的站点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T20:22:52.350

我假设您已经创建了一个应用程序？如果不是，您必须先执行此操作，然后在该应用程序下创建一个站点。例如，在应用程序管理下，您创建一个新应用程序（使用基于声明的身份验证以获得最佳结果），设置端口号（默认为 80），完成后，它会提示您是否要创建站点。

> > 如果您使用的是服务器（不是基础），请不要误将团队站点用作顶级站点；顶级团队网站只能在其下创建团队网站（即不能发布）。

如果您确实有一个应用程序设置（所以您知道，一个应用程序与设置一个具有匹配 SharePoint DB 的空白 IIS 站点相同），那么它就是另外一回事了。在应用程序下设置站点通常不是问题，但可能是您可能遇到权限错误；不幸的是，导致 99% 的 SP 问题。

跟踪此问题的唯一方法是使用系统应用程序事件日志和 SharePoint 日志。从事件日志开始，看看是否有任何错误。如果未打开 SharePoint 日志（默认为 c:\Program Files\Common Files\Microsoft\Web Server Extensions\14\Logs）。SharePoint 每 30 分钟创建一个新日志（同样默认情况下） - 按日期对文件夹进行排序并打开最新的。搜索不带破折号的相关编号 (xxxxx-) 的第一部分 - 当您找到它的第一次出现时，在编辑器中向左滚动到消息所在的位置，然后开始向下滚动。您也可以简单地尝试搜索“错误”或“失败”。该日志可能难以阅读，因此您可以使用 ULSViewer（从此处下载：http: [//archive.msdn.microsoft.com/ULSViewer](http://archive.msdn.microsoft.com/ULSViewer)）。

在很多情况下，这可能是应用程序池帐户没有访问数据库的正确权限。

如果这没有帮助（或者您无法弄清楚），您可以临时修改 web.config 文件 - 找到 'customerrors="Off"' 并将其更改为 On（区分大小写！）；您可能需要执行 IISReset（打开命令窗口或开始 > 运行输入 CMD 然后单击确定）然后输入 IISreset；这将停止并重新启动 IIS。这将关闭来自 SharePoint 的错误处理，并将显示完整的错误 - 完成后将其转回关闭！

如果您在生产系统上，请在下班后执行此操作！！

也就是说，如果您确实看到任何错误并且无法弄清楚，请在此处重新发布。

此致，

David Sterling - 首席执行官/CSA/执行顾问 david_sterling@sterling-consulting.com – +1 704-202-2282 – Skype：davidmsterling 博客：[http](http://davidmsterling.blogspot.com) ://davidmsterling.blogspot.com 公司网站：[http://www.sterling- Consulting.com](http://www.sterling-consulting.com) 精选于：[http ://www.sharepoint-blog.com](http://www.sharepoint-blog.com)

# android - Andengine Motion Streking Resume 问题

> ID：14900817
> 
> 赞同：0
> 
> 时间：2013-02-15T18:12:20.957
> 
> 标签：android, andengine

Andengine 存储库中给出的 MotionStreaking 示例工作正常，但是一旦我按下主页按钮然后尝试恢复它，它只会显示游戏中使用的纹理的放大和扭曲版本，或者只是一个空白屏幕。我需要在游戏中使用它。请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T23:26:19.137

MotionStreaking 示例使用这样的 RotationModifier：

> 新的 RotationModifier(10, 0, 7200, EaseQuadInOut.getInstance())

旋转修改器（内部）正在调整纹理的旋转（即 setRotation() 方法）。当您离开和返回时，没有任何东西可以将旋转重置回其原始状态。您需要做的是创建一个 initialize() 方法（或类似的方法），手动将旋转设置回零。例如，像这样：

```
public void initialize() {
   rectangleGroup.setRotation(0f);
} 
```

# python - 为什么会这样：处理需要通过才能继续？

> ID：14900821
> 
> 赞同：5
> 
> 时间：2013-02-15T18:12:39.573
> 
> 标签：python, python-2.7, if-statement, continue

有人可以解释为什么`else: pass`需要下面显示的内容才能执行其余代码（最终`print 'processing...`语句）吗？注意`print`in`else`被放在那里只是为了让我知道执行确实是在走这条路。

似乎只要`continue`不执行 就应该发生这种情况，因为 中的代码`else`什么都不做。但是，如果我离开了，当条件为 False 时，循环中似乎不会执行`else`任何进一步的操作——当目录中*确实*存在具有扩展名的文件时——这对我来说没有意义。文档说“继续最近的封闭循环的下一个循环”，很好，但是如果没有执行，不应该处理继续下一条语句吗？`for`*`continue`*

 *```
import os

source_dir = r'C:\Downloads'
ext = '.mp3'

for dirName, subdirList, fileList in os.walk(source_dir):
    if not any(os.path.splitext(fileName)[1].lower() == ext for fileName in fileList):
        print '  skipping "{}"'.format(dirName)
        continue
    else:  # why is this clause needed to continue this iteration of a loop?
        print 'contains   "{}"'.format(dirName)
        pass

    print 'processing "{}" which has "{}" files'.format(dirName, ext) 
```

**谜团已揭开**

看似奇怪的行为是由于缩进问题，这在上面的代码中不可见，通常在我的文本编辑器中也不可见。事实证明，最后一个语句缩进了 3 个空格，然后是一个制表符，这`print`使它看起来与. 显然让我很困惑。`else``pass``else``continue``if`

这是我的文本编辑器中的代码截图，它的“显示空间/标签”选项已打开。红点代表空格，红色右 guillemet ( `»`) 代表制表符：

![我的编辑器中显示错误缩进的文件屏幕截图](../Images/aa24c891a23eaf9b8563ba7b07577bf0.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T18:20:33.900

你不需要它。我运行了以下 2 个脚本：

```
#test1.py
import os

source_dir = '.'
ext = '.txt'

for dirName, subdirList, fileList in os.walk(source_dir):
    if not any(os.path.splitext(fileName)[1].lower() == ext for fileName in fileList):
        print '  skipping "{}"'.format(dirName)
        continue
    else:  # why is this clause needed to continue this iteration of a loop?
        print 'contains   "{}"'.format(dirName)
        pass

    print 'processing "{}" which has "{}" files'.format(dirName, ext) 
```

和

```
#test2.py
import os

source_dir = '.'
ext = '.txt'

for dirName, subdirList, fileList in os.walk(source_dir):
    if not any(os.path.splitext(fileName)[1].lower() == ext for fileName in fileList):
        print '  skipping "{}"'.format(dirName)
        continue
    #else:  # why is this clause needed to continue this iteration of a loop?
    #    print 'contains   "{}"'.format(dirName)
    #    pass

    print 'processing "{}" which has "{}" files'.format(dirName, ext) 
```

我将它们运行为：

```
python test1.py > junk.log
python test2.py > junk.log2 
```

这是前几行`junk.log`：

```
test $ head junk.log
processing "." which has ".txt" files
  skipping "./new"
  skipping "./unum"
processing "./unum/kiv-unum-409befe069ac" which has ".txt" files
  skipping "./unum/kiv-unum-409befe069ac/build"
  skipping "./unum/kiv-unum-409befe069ac/build/bdist.macosx-10.3-fat"
  skipping "./unum/kiv-unum-409befe069ac/build/lib"
  skipping "./unum/kiv-unum-409befe069ac/build/lib/tests"
  skipping "./unum/kiv-unum-409befe069ac/build/lib/unum"
  skipping "./unum/kiv-unum-409befe069ac/build/lib/unum/units 
```

注意“处理”行的存在。

然后我`diff`输出：

```
diff junk.log junk.log2 
```

结果如下：

```
0a1
> contains   "."
3a5
> contains   "./unum/kiv-unum-409befe069ac"
14a17
> contains   "./unum/kiv-unum-409befe069ac/docs"
16a20
> contains   "./unum/kiv-unum-409befe069ac/nose-1.2.1-py2.7.egg/EGG-INFO"
19a24
> contains   "./unum/kiv-unum-409befe069ac/nose-1.2.1-py2.7.egg/nose"
30a36
> contains   "./unum/kiv-unum-409befe069ac/Unum.egg-info" 
```

请注意，“处理”行没有区别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-15T22:00:39.810

我将回答我自己的问题并最终接受它。所描述的看似奇怪的行为是由一个微妙的缩进问题引起的，用户@delnan 首先引起了我的注意。因为它是隐形的，所以一开始我觉得不会是这样，但经过更多的调查最终发现了它。其中的详细信息已添加到我的问题的末尾。*

# dojo - 如何创建带表头的 Dojo 表

> ID：14900822
> 
> 赞同：0
> 
> 时间：2013-02-15T18:12:48.737
> 
> 标签：dojo

如何使用 dojo 控件创建表格视图。

例如，我想使用类似于此 HTML 表的 dojo 控件创建一个表。

```
<table border="0" style=" border:1px #000000 solid">
        <tr>
            <th>Total</th>
            <th>Enabled</th>
            <th>On Trial</th>
            <th>Banned</th>
        </tr>
        <tr>
            <td>100</td>
            <td>50</td>        
            <td>30</td>        
            <td>20</td>
        </tr>        
    </table> 
```

如果您知道任何事情，请告诉我。

谢谢，维维克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:25:57.750

我通常做的是将 HTML 包装在 Dojo 组件中。例如：

```
<div data-dojo-type="dojox.mobile.View"> 

  //HTML Table && other dojo components

</div> 
```

这有帮助吗？

# php - 如何使用 PHP 检测当前的 IIS 版本？

> ID：14900828
> 
> 赞同：6
> 
> 时间：2013-02-15T18:13:07.510
> 
> 标签：php, iis, version, version-detection

我现在的做法是……</p>

```
if ( preg_match( '~IIS/(\d+\.\d+)~', $_SERVER['SERVER_SOFTWARE'], $matches ) )
    $version = $matches[1]; 
```

…但是我没有使用 IIS 的经验，搜索了一段时间后，我发现没有任何信息表明它有多可靠。服务器签名可能会被抑制，或者模式可能会在旧版本或其他软件中发生更改。

是否可以使用 PHP 检测到完整正确的 IIS 版本？也许[只有 Windows 的扩展](http://www.php.net/manual/en/refs.utilspec.windows.php)？有什么我应该注意的陷阱吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:39:41.297

据我所知，IIS 版本的结构是这样修复的

```
 Microsoft-IIS/5.0 (Windows 2000)
 Microsoft-IIS/5.1 (Windows XP)
 Microsoft-IIS/6.0 (Windows 2003 Server) 
```

# security - 除了 flash 或 silverlight 之外，还有什么其他技术可以阻止通过 webbrowser 中的 firebug 更改编辑网页？

> ID：14900830
> 
> 赞同：0
> 
> 时间：2013-02-15T18:13:22.823
> 
> 标签：security

除了 flash 之外，还有什么其他技术可以阻止通过 webbrowser 中的 firebug 等更改编辑网页？

因为每个人都可以改变网页的外观并将javascript等注入网站。

据我所知，只有闪光灯和银光可以防止这种行为，但我可能错了。

你知道现在使用的任何其他“不可编辑”的技术，比如闪光灯或银光吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:18:50.730

用户使用 Firebug 或类似工具所做的任何更改只会影响他们对页面的视图，并且会在他们重新加载页面后立即消失。这绝不是安全隐患，因此请忘记它。

您唯一应该关心的是验证用户发送到服务器的任何内容，例如确保数字确实是数字、电子邮件地址是电子邮件地址等等。

# eclipse - 通过 gcc -include 包含的 Eclipse-CDT 索引文件

> ID：14900832
> 
> 赞同：2
> 
> 时间：2013-02-15T18:13:32.633
> 
> 标签：eclipse, eclipse-cdt

我正在尝试处理我在 Eclipse 中打开的现有项目。但是，几乎所有文件都显示错误，`Symbol 'SOME_SYMBOL' could not be resolved.`原因是头文件是通过 gcc“-include”选项包含的。我怎样才能让 Eclipse CDT 索引器来索引这个文件。

编译命令看起来像这样

```
gcc -包括配置.h

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-22T19:03:14.357

Eclipse 确实支持索引单个文件，它只是默认不显示选项卡：

1.  转到：窗口 > 首选项 > C/C++ > 属性页设置
2.  检查：'显示“包含文件”选项卡'
3.  按申请
4.  转到：项目 > 属性 > 路径和符号 > 包含文件
5.  添加要包含在 GNU C 和 GNU C++ 中的文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T22:51:35.633

它可能没有 .h 文件的正确位置。Eclipse 正在您的工作区目录中寻找 config.h。您可以使用 #include "filepath\config.h" 将 eclipse 直接指向文件

或者

您可以导航到项目属性 -> C/C++ 构建 -> 设置 -> 包含此处，您可以在 -i 选项中添加 config.h 所在的文件夹。

现在您应该能够将#include "config.h" 添加到您的cpp 文件中。

# xslt - 如何在 Mule 3.3 应用程序中使用模式感知 XSLT 处理器

> ID：14900836
> 
> 赞同：0
> 
> 时间：2013-02-15T18:13:52.687
> 
> 标签：xslt, xslt-2.0, mule

我打算从我的 xsl 样式表中验证输入 xml 和输出 xml。我正在关注这个[developerworks 帖子](http://www.ibm.com/developerworks/xml/library/x-schemaxslt/index.html#iratings)来做到这一点。

当我尝试通过运行我的应用程序时`Mule Server`，它失败并出现以下异常

```
Error at xsl:import-schema on line 8 of :
  XTSE1650: To use xsl:import-schema, you need the schema-aware version of Saxon from
  http://www.saxonica.com/
Error at Product on line 23 of :
  XTSE1660: To perform validation, a schema-aware XSLT processor is needed
Error on line 23 of :
  XTTE1512: There is no global element declaration for Product, so strict validation will fail 
```

1.  在骡子可以做吗？
2.  这是模式验证的有效方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:18:28.200

Mule的[XML 模块提供了一个验证过滤器](http://www.mulesoft.org/documentation/display/current/XML+Module+Reference#XMLModuleReference-Filters)：

```
<mule-xml:schema-validation-filter
    schemaLocations="com/myapp/schemas/schema.xsd, com/myapp/schemas/anotherSchema.xsd"/> 
```

我建议您先尝试使用它，看看它是否适合您的需求。

否则，如果您坚持当前的方法，您可能必须将 Saxon JARs Mule 嵌入替换为模式感知版本，或者在您的应用程序 /libs 中提供模式感知版本并使用类加载器过滤来确保使用正确的版本。

# android-emulator - 如何在 Eclipse 中为安卓模拟器安装下载的英特尔系统映像

> ID：14900837
> 
> 赞同：0
> 
> 时间：2013-02-15T18:13:53.137
> 
> 标签：android-emulator

我已经安装了 eclipse 和 android sdk。sdk 还需要 eclipse 插件。我想在不使用 sdk manager 的情况下为模拟器安装系统映像，因为我已经下载了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T01:12:49.740

打开 Android SDK Manager，它将显示可用系统映像的列表。只需选择您需要的，然后单击下载。 ![在此处输入图像描述](../Images/b1aef17a119c6155e977155f2ef79298.png)

# ios - SoundCloud HTML5 小部件没有自动播放，iOS

> ID：14900840
> 
> 赞同：1
> 
> 时间：2013-02-15T18:14:00.870
> 
> 标签：ios, html, soundcloud

HTML5 SoundCloud 小部件自动播放功能不适用于 iOS5 和 iOS6。

我没有测试过低于 iOS 5。

见：[http ://www.bushytunes.net/test.asp](http://www.bushytunes.net/test.asp)

此页面通过`auto_play=true`在 iframe src 中包含参数来启用该功能。

这可以解决吗？或者有没有我可以添加到我的应用程序以启用此功能的 hack？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T23:26:28.787

所有 iOS 设备上的任何音频或视频都禁用自动播放，这是 Apple 的决定。这是一个文档链接，说明播放必须由用户控制：http: [//developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations。 html#//apple_ref/doc/uid/TP40009523-CH5-SW1](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html#//apple_ref/doc/uid/TP40009523-CH5-SW1)

播放必须由用户操作启动。据我所知，没有任何黑客可以让你启用它。

# iis - Web Farm Framework 无法镜像到辅助服务器

> ID：14900841
> 
> 赞同：3
> 
> 时间：2013-02-15T18:14:01.783
> 
> 标签：iis, iis-7, web-farm-framework

我一直在努力让 Web Farm Framework 正常工作一段时间，但它只是不工作。如果我找不到解决方案，我将不得不查看另一个产品或在我们的构建服务器之外进行双重部署。

设置是我有一个控制器设置。我已经以各种可能的方式添加了服务器，要么设置服务器，要么尝试让 WFF 去做，但没有任何效果。这是有效的：

*   控制器 - WFF 已安装并正常工作
*   主服务器 - 仅安装 IIS 管理服务。
*   辅助服务器 - 仅安装 IIS 管理服务。

两台服务器位于 NetScaler 负载平衡器上，但我在 Microsoft NLB 上还有其他服务器，并且行为相同。

设置是这样的：

1.  向 WFF 添加了一个新的服务器场
2.  添加主服务器（运行 AddServer 操作）
3.  一切看起来都不错（Web Farm Agent 推送到主服务器，服务器在日志中成功启动）
4.  通过 WFF 配置 WDeploy_v2 (Web Deploy 2.1) 以推送到主服务器。收到有关下载 Microsoft.Web.PlatformInstaller 的警告，但这是意料之中的，它不在主服务器上
5.  添加了各种其他产品（SQL Server 的东西等）都正确安装并且服务器已成功启动。登录到物理主服务器，一切都安装好了，看起来不错。
6.  添加了辅助服务器
7.  安装的所有各种产品，包括 Web Deploy 2.1 并被添加到服务器。登录到辅助服务器并且他们在那里，来自主服务器的副本
8.  WFF 将辅助服务器与主服务器进行比较（Diffing local application WinServer() 与主服务器 SERVERNAME）
9.  下一行是一个错误。

无法运行操作“RunRemote”。无法在服务器 'SECONDARYSERVERNAME' 上运行方法 'Microsoft.Web.Farm.SyncApplicationsRemoteMethod' 响应流中的异常。无法创建类型为“webServer”和路径“”的对象。（2/15/2013 10:18:15 AM）在远程计算机上处​​理请求时发生错误。无法创建类型为“webServer”和路径“”的对象。清单“webServer”中的一个或多个条目无效。找不到配置文件“/”。找不到文件“c:\windows\microsoft.net\framework\v2.0.50727\config\web.config”。响应流中的异常。无法创建类型为“webServer”和路径“”的对象。（2/15/2013 10:18:15 AM）在远程计算机上处​​理请求时发生错误。无法创建类型为“webServer”和路径“”的对象。清单“webServer”中的一个或多个条目无效。找不到配置文件“/”。找不到文件“c:\windows\microsoft.net\framework\v2.0.50727\config\web.config”。

我检查了路径中的辅助服务器，文件在那里。为场配置的 WFF 帐户是本地管理员（在所有服务器上）并且可以访问它。

此时它运行的一系列操作（RunRemote、ProvisionApplications、AddServer）都失败了。它将服务器标记为不健康，运行 DisableLoadBalancing 操作，然后尝试自动修复 10 次。

在将服务器与主服务器进行比较后，每次自动修复都会因相同的错误 RunRemote 失败（在比较失败之前，它实际上成功地执行了 RunRemote、QueryInstalledProducts 和 ServiceControl）。

基本上，当它到达检查差异点时，从主节点到辅助节点的复制失败。

就像我说的那样，我确实已经尝试了一切，所以这是我最后一次尝试修复它或完全摆脱它。服务器使用 NetScaler 进行负载平衡，因此我尝试将两者都配置为启用和禁用负载平衡（就 WFF 而言）。没有不同。服务器在 UAT 开启的情况下运行（这似乎总是有问题）。我们可以通过 TeamCity 或命令行进行 Web 部署（一旦安装了应用程序），将网站远程部署到服务器，所以我知道所有这些都在工作。只是无法让 WFF 正常运行。

它适用于一台服务器，只是当您添加辅助服务器时它会失败。我刚刚完成的另一项测试是将一台服务器作为主服务器，将另一台服务器作为辅助服务器，然后完全卸载所有内容，重新启动两者，然后将辅助服务器设置为 pirmary 并将主服务器设置为辅助服务器（只是看看是否可能是原始辅助服务器）服务器只是在接受订单时遇到问题）。两台主服务器始终工作。

希望有人可以提供帮助。非常令人沮丧，因为那里几乎没有文档，人们发布的任何类型的错误消息都与这种情况“相似”，但并不准确。任何类似的设置我都尝试过各种修复，但都没有奏效。另外，我按照上面的方法进行了干净的设置，因此它*应该可以正常工作*，但不能。

还有环境：所有服务器都是Server 2008 x64 R2。服务器可以访问 Internet，并且防火墙服务未运行。

还有一个更新。在设置并在辅助服务器上尝试将主服务器同步到辅助服务器时出现故障后，我将辅助服务器设置为主服务器（右键单击上下文菜单）。它翻转并且完全相同的行为。现在新的主服务器很好，但新的辅助服务器在尝试执行 RunRemote 操作时失败。

谢谢！

# mysql - 创建数据库时mysql与netbeans连接出错？

> ID：14900846
> 
> 赞同：1
> 
> 时间：2013-02-15T18:14:22.180
> 
> 标签：mysql, sql, database, netbeans

我正在使用 xampp。我想将 mysql 与 netbeans 连接。我在服务选项卡中从数据库创建新连接时测试了我的连接。我得到连接成功的消息。但是在尝试创建数据库时我得到了这个错误

```
access denied for user"@'localhost' to database 'student' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:34:48.520

对于 mysql

1.  撤销权限

    ```
    revoke all privileges on *.* from 'student'@'localhost'; 
    ```

2.  然后根据需要授予适当的权限：

    ```
    grant SELECT,INSERT,UPDATE,DELETE ON `db`.* TO 'student'@'localhost'; 
    ```

在您的情况下，您可能想要

```
 GRANT ALL PRIVILEGES ON *.* TO  'student@localhost'; 
```

最后，冲洗：

```
 flush privileges; 
```

# php - 中断 Xdebug 中的属性更改

> ID：14900850
> 
> 赞同：5
> 
> 时间：2013-02-15T18:14:38.650
> 
> 标签：php, xdebug

我试图找出某个对象的某个属性在哪里被修改。由于 PHP 的高度动态性（`$o->$prop = $val`等等），这实际上是不可能通过简单的代码分析来完成的。有没有办法启动调试会话并在属性被修改的行中断？`__set`（通过对类的条件调用添加一个魔法`xdebug_break()`可能在简单的情况下会有所帮助，但如果该类或其祖先之一已经有一个魔法设置器，它可能会变得非常复杂，所以这也不是一个好的解决方案。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-01T06:05:11.187

根据 xdebug 文档，似乎*应该*有一种方法可以中断变量更改。 [http://xdebug.org/docs-dbgp.php#breakpoints](http://xdebug.org/docs-dbgp.php#breakpoints)

> watch：在写入由表达式参数定义的变量或地址时中断

但源代码表明文档领先于其实际功能： [https ://github.com/xdebug/xdebug/blob/master/xdebug_handler_dbgp.c#L875](https://github.com/xdebug/xdebug/blob/master/xdebug_handler_dbgp.c#L875)

```
if (strcmp(CMD_OPTION('t'), "watch") == 0) {
        RETURN_RESULT(XG(status), XG(reason), XDEBUG_ERROR_BREAKPOINT_TYPE_NOT_SUPPORTED);
    } 
```

我实际上无法在 repo 的其他任何地方找到字符串“watch”，所以我的假设是它目前不受支持。

Xdebug 的错误跟踪器中似乎存在错误：

[http://bugs.xdebug.org/view.php?id=514](http://bugs.xdebug.org/view.php?id=514)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-15T18:19:30.093

将您尝试调试的属性声明为`private`，并创建一个`__set`方法。在其中，您将能够找到答案。

```
class subject extends something {
    private $field;

    public function __set($key, $value) {
        if ($key == 'field') {
            debug_print_backtrace(); exit;
        }

        if (method_exists(get_parent_class($this), '__set')) {
            return parent::__set($key, $value);
        }

        return $this->$key = $value;
    }
} 
```

编辑：这是 getter 和 setter 的另一个惊人原因:)

# mysql - 使用 PostgreSQL 运行 ThinkingSphinx 时出错

> ID：14900853
> 
> 赞同：1
> 
> 时间：2013-02-15T18:14:44.897
> 
> 标签：mysql, postgresql, sphinx, thinking-sphinx

我曾经使用 mySQL 启动并运行thinking-sphinx。现在，我迁移到 PostgreSQL。但是，我的thinking-sphinx 仍然是为mySQL 配置的，所以出现以下错误：

```
 /Users/name/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require': no such file to load -- mysql2 (LoadError) 
```

我回溯到`thinking_sphinx.rb`文件中`Users/name/.rvm/gems/thinking-sphinx-3.0.1/lib`，发现以下内容：

```
if RUBY_PLATFORM == 'java'
  require 'java'
  require 'jdbc/mysql'
else
  require 'mysql2'
end 
```

我如何强制`thinking-sphinx`接受`pgsql`？或者，我是否需要卸载`thinking-sphinx`并`Sphinx`完全安装它们并使用配置进行安装`pgsql`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T00:05:14.610

来自[https://github.com/pat/thinking-sphinx/issues/413#issuecomment-11912232](https://github.com/pat/thinking-sphinx/issues/413#issuecomment-11912232)

> Thinking Sphinx v3 使用 SphinxQL 与 Sphinx 通信——这实质上意味着 Sphinx 的行为类似于 MySQL 服务器。因此，向 Sphinx 发送查询需要 mysql2 gem。

所以把这个添加到你的 Gemfile

```
gem 'mysql2' 
```

# java - 模态 JInternalFrames - 调整大小后 GlassPane 消失

> ID：14900861
> 
> 赞同：1
> 
> 时间：2013-02-15T18:15:12.293
> 
> 标签：java, swing

首先，我使 GlassPane 可见，然后将 JInternalFrame 添加到它。GlassPane 成功阻止了对其下的 GUI 元素的访问，但是当我尝试调整 JInternalFrame 的大小时，GlassPane 消失了，我不知道为什么。

内部框架仍然位于其上。看起来有些东西将 Glasspane 的 setVisible 方法更改为 false ...如何解决？

这是一些代码。当我调整 JInternalFrame 的大小时，glassPane 丢失了。

```
import java.awt.Cursor;
import java.awt.event.*;
import java.beans.PropertyVetoException;
import javax.swing.*;
import javax.swing.event.*;

public class Example {

    private static JFrame frame = new JFrame();
    private static JDesktopPane glassPane = new JDesktopPane();

    public static void main(String[] args) {
        // make JDesktopPane (glassPane) transparent
        glassPane.setOpaque(false);
        // add empty mouse adapter to block events to other components then JInternalFrame
        glassPane.addMouseListener(new MouseAdapter(){});
        frame.setGlassPane(glassPane);

        final JInternalFrame internal = new JInternalFrame("testFrame", true, true);
        internal.setBounds(20, 20, 240, 200);

        // add listener to hide glassPane when  intenralFrame is closed
        internal.addInternalFrameListener(new InternalFrameListener(){
            public void internalFrameOpened(InternalFrameEvent e) {}
            public void internalFrameClosing(InternalFrameEvent e) {}
            public void internalFrameClosed(InternalFrameEvent e) {
                glassPane.remove(internal);
                glassPane.setVisible(false);
                glassPane.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
                try {
                    internal.setClosed(true);
                } catch (PropertyVetoException e1) {
                    e1.printStackTrace();
                }           
            }
            public void internalFrameIconified(InternalFrameEvent e) {}
            public void internalFrameDeiconified(InternalFrameEvent e) {}
            public void internalFrameActivated(InternalFrameEvent e) {}
            public void internalFrameDeactivated(InternalFrameEvent e) {}

        });

        // adding exmaple components to frame
        frame.setLayout(new BoxLayout(frame.getContentPane(), BoxLayout.PAGE_AXIS));
        frame.getContentPane().add(new JButton("button 1"));
        // button showing modal JInternalFrame
        JButton activate = new JButton("Show Modal InternalFrame");
        activate.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e) {
                glassPane.add(internal);    
                internal.setVisible(true);
                glassPane.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
                glassPane.setVisible(true);
            }       
        });
        frame.getContentPane().add(activate);

        // example menu
        JMenuBar menuBar = new JMenuBar();
        JMenu menu = new JMenu("test menu");
        menu.add(new JMenuItem("test"));
        menuBar.add(menu);
        frame.setJMenuBar(menuBar);
        frame.setSize(800, 600);
        frame.setVisible(true);
    }
} 
```

# opencv - 使用深度信息的物体识别算法建议

> ID：14900862
> 
> 赞同：5
> 
> 时间：2013-02-15T18:15:14.443
> 
> 标签：opencv, depth, point-cloud-library, object-recognition

我最近按照[本文](http://saturne.xrce.xerox.com/layout/set/print/content/download/20785/148346/file/2004_010.pdf)中描述的技术实现了一个识别软件。但是，我的数据集还包含使用 OpenNI 拍摄的深度图。

我想使用深度信息来增加识别器的鲁棒性。我想在提取 VFH 描述符后训练 1-vs-all SVM 计算弓形响应直方图（我为此任务调整了 OpenCV DescriptorExtractor 接口）。但关键是：我怎样才能将这两件事结合起来以获得更精确的结果？有人可以为此建议我一个策略吗？

Ps 我非常想测试直接向 kinect 显示对象的识别器（而不是像我现在正在做的那样，将裁剪的图像提供给识别器）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T10:25:00.690

我建议你看看 PCL，它是一个很像 opencv 的框架，只是它专门用于点云处理。使用它已经有一段时间了，但算法是其他最先进的实现。

*   [http://pointclouds.org/documentation/](http://pointclouds.org/documentation/)

# data-binding - 我可以使用现有的 Metro 类来创建未连接到可见 ui 控件的可绑定字符串吗

> ID：14900863
> 
> 赞同：0
> 
> 时间：2013-02-15T18:15:21.063
> 
> 标签：data-binding, windows-8

我正在编写一个 Windows 8 应用程序（为我自己），它为一些自动生成的路径生成 g 代码。在生成 g 代码时，我想使用可以自己在应用程序中编写和编辑的文本模板。我认为遵循 {binding path} 表示法是个好主意，所以我的模板可能看起来像

“{binding Gcode.LinearMove} {binding Axis.X} {binding CurrentPoint.X } ....” 在数据绑定后给出“G1 X 90 ...”。

所有对象 Gcode、Axis、CurrentPoint 都可以定义为代码生成器的 DataContext 的一部分。

我目前使用使用 StringBuilder 构建的简单字符串并传递给 ListView 进行显示并使用格式来替换值，但这当然会冻结我在代码中使用的属性并且是限制性的。我玩过使用正则表达式替换的特定模板名称，但替换值再次被冻结在代码中。

我认为使用可编辑模板可以让我更自由地动态选择在运行时使用哪些属性。

所以我的问题是，这是否可以使用现有的 Metro 类和数据绑定的 .net 实现来实现，还是我必须从头开始？请记住，绑定将在不可见和非 UI 控件上。我认为将 Textblocks 用于数千行 gcode 的列表在资源方面将是一件愚蠢的事情，而且我在某处读到应用程序中不提供多重绑定。

艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T20:58:57.880

是的，您可以使用 TextBlock 或 RichTextBlock 并将各个运行绑定到您要显示的属性。当后面的代码更改时（只要它正确实现 INotifyPropertyChange），屏幕上的文本应该会按预期更新。

这是一篇关于绑定运行的好小文章：

[http://tozon.info/blog/post/2012/10/16/Windows-Store-apps-the-case-of-missing-StringFormat-or-Binding-on-the-Run.aspx](http://tozon.info/blog/post/2012/10/16/Windows-Store-apps-the-case-of-missing-StringFormat-or-Binding-on-the-Run.aspx)

开发支持、设计支持和更多的好处：http: [//bit.ly/winappsupport](http://bit.ly/winappsupport)

# hibernate - java.lang.AbstractMethodError：org.joda.time.contrib.hibernate.PersistentDateTime.nullSafeGet

> ID：14900875
> 
> 赞同：20
> 
> 时间：2013-02-15T18:15:53.223
> 
> 标签：hibernate, jodatime

我正在尝试将[Joda-Time](http://www.joda.org/joda-time/apidocs/index.html) - 2.1 与 Hibernate [4.2.0.CR1 一起使用](http://sourceforge.net/projects/hibernate/files/hibernate4/4.2.0.CR1/hibernate-release-4.2.0.CR1.zip/download)。我在某些实体类中有一些日期时间字段，例如，

```
@Column(name = "DISCOUNT_START_DATE")
@Type(type="org.joda.time.contrib.hibernate.PersistentDateTime")
private DateTime discountStartDate; 
```

注释`Type`是`org.hibernate.annotations.Type`. 我收到以下异常。

```
java.lang.AbstractMethodError: org.joda.time.contrib.hibernate.PersistentDateTime.nullSafeGet(Ljava/sql/ResultSet;[Ljava/lang/String;Lorg/hibernate/engine/spi/SessionImplementor;Ljava/lang/Object;)Ljava/lang/Object;
at org.hibernate.type.CustomType.nullSafeGet(CustomType.java:127)
at org.hibernate.type.AbstractType.hydrate(AbstractType.java:106)
at org.hibernate.persister.entity.AbstractEntityPersister.hydrate(AbstractEntityPersister.java:2903)
at org.hibernate.loader.Loader.loadFromResultSet(Loader.java:1668)
at org.hibernate.loader.Loader.instanceNotYetLoaded(Loader.java:1600)
at org.hibernate.loader.Loader.getRow(Loader.java:1500)
at org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:712)
at org.hibernate.loader.Loader.processResultSet(Loader.java:940)
at org.hibernate.loader.Loader.doQuery(Loader.java:910)
at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:341)
at org.hibernate.loader.Loader.doList(Loader.java:2516)
at org.hibernate.loader.Loader.doList(Loader.java:2502)
at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2332)
at org.hibernate.loader.Loader.list(Loader.java:2327)
at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:490)
at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:355)
at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:195)
at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1246)
at org.hibernate.internal.QueryImpl.list(QueryImpl.java:101)
at dao.DiscountDAO.getList(DiscountDAO.java:84)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:64)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
at $Proxy49.getList(Unknown Source)
at controller.DiscountController.showForm(DiscountController.java:207)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:219)
at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)
at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:746)
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:687)
at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:925)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:856)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:915)
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:811)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:796)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.springframework.orm.hibernate4.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:152)
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.springframework.web.multipart.support.MultipartFilter.doFilterInternal(MultipartFilter.java:119)
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at filter.NoCacheFilter.doFilter(NoCacheFilter.java:102)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330)
at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118)
at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:103)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:150)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:183)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:50)
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:125)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.access.channel.ChannelProcessingFilter.doFilter(ChannelProcessingFilter.java:144)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192)
at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160)
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1822)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722) 
```

在一些答案中提到它[`joda-time-hibernate-1.3`](http://sourceforge.net/projects/joda-time/files/joda-time-hibernate/1.3/joda-time-hibernate-1.3-dist.zip/download)在类路径上需要（不是更旧的），但这样做也对我不起作用。

Hibernate 真的**不能**用`org.joda.time.contrib.hibernate.PersistentDateTime`吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-15T21:38:56.917

根据[这个文件](http://www.joda.org/joda-time-hibernate/)，joda-time 需要`Hibernate 3.6`，并且是最新的`Hibernate 4+`。
但是您可以使用 Jadira 框架中的用户类型。

在这种情况下，用户类型是

```
@Type(type="org.jadira.usertype.dateandtime.joda.PersistentDateTime") 
```

并且可以在 Maven 依赖项中找到

```
<dependency>
   <groupId>org.jadira.usertype</groupId>
   <artifactId>usertype.core</artifactId>
   <version>3.1.0.CR1</version>
</dependency> 
```

Maven repo 搜索结果：[这里](http://search.maven.org/#search%7Cgav%7C1%7Cg%3a%22org.jadira.usertype%22%20AND%20a%3a%22usertype.core%22)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T14:14:09.200

我在使用 Hibernate 4.2.0.CR1 时也遇到了同样的错误。但是通过将版本更改为 3.6.8.Final，问题得到了解决。

# java - 为什么这个对象数组中的每个元素都会被最后一个对象覆盖？

> ID：14900879
> 
> 赞同：2
> 
> 时间：2013-02-15T18:16:04.230
> 
> 标签：java, arrays, class, object

我有以下代码：

```
public static void main(String[] args) {
  Player players[] = new Player[2];
  Scanner kb = new Scanner(System.in);
  System.out.println("Enter Player 1's name");
  players[0] = new Player(kb.nextLine());
  System.out.println("Enter Player 2's name");
  players[1] = new Player(kb.nextLine());
  System.out.println("Welcome "+ players[0].getName() + " and " + players[1].getName());    
} 
```

它旨在创建一个新的播放器对象并存储播放器的名称，同时将所有对象保留在数组中。

这是播放器类：

```
public class Player {
  static String name;
  public Player(String playerName) {
    name = playerName;
  }

  public String getName(){
    return name;
  } 
} 
```

实际发生的是，当我只有 1 个对象时它可以工作，但是当我有 2 个时，数组中的每个元素都与第二个元素相同。当我在数组中有 3 个对象时，每个元素都与第 3 个相同，依此类推。

我不确定为什么会发生这种情况，或者如何纠正它，这让我困惑了好几个小时：/

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T18:18:37.247

这是因为静态场。静态用于跨对象实例。它们存储在类级别。

下面的代码可以工作：

```
class Player
{
    String name;

    public Player(String playerName)
    {
        name = playerName;
    }

    public String getName()
    {
        return name;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-15T18:19:03.743

将静态字符串名称更改为私有字符串名称

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T18:18:56.850

名称字段不应是静态的。静态意味着变量实际上是全局的并且在所有类实例之间共享。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:55:47.207

使用关键字**static**您创建了`name`一个**不是**实例变量的类变量。类变量对所有对象都是通用的。[点击阅读更多内容](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)。

# visual-studio-2010 - 在 VS2010 中读取 .txt 文件

> ID：14900880
> 
> 赞同：2
> 
> 时间：2013-02-15T18:16:05.027
> 
> 标签：visual-studio-2010, fopen

我正在尝试读取文本文件并将内容显示到屏幕上。该文件只是一个单词列表。我已将 .txt 文件放在我的项目树中，但代码不会打开它。我的问题是，.txt 文件放错地方了吗？fopen 是执行此操作的正确功能吗？我正在绕圈子，它看起来很简单！:(

文件存放在“ProjectName”下的目录--Source Files--File.txt

到目前为止，我的代码是：

```
int main (void)
{

char word [30];

    FILE *fp;

    if ((fp = fopen("sort.txt", "r")) == NULL)
    {
        printf( "File could not be opened\n");
    }
    else
    {
        fscanf(fp, "%s", word);

        while (!feof(fp))
        {
            fscanf(fp, "%s", word);
        }

        fclose (fp);
    }
    return 0;
} 
```

* * *

问题解决了。我通过右键单击 Source Files 然后选择 Add New Item 并在 Utility 选项下选择文本文件，在我的项目中重新创建了一个文本文件。然后我将原始文本文件数据复制到其中。然后在适当的目录中创建该文件。简单的解决方案！快乐的新手编码器！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:19:26.103

由于您打开的是相对路径，因此您需要将 File.txt 与 .exe 放在同一文件夹中。当然，我假设当您编写 File.txt 时，您的意思是 sort.txt，因为这就是您的代码所引用的内容。

对于托管语言，您可以对任何文件使用“始终复制”，但对于 C++，您不能。因此，要将特定文件复制到输出目录，您需要添加一个构建后事件：

*   右键单击 C++ 项目并选择属性
*   展开“配置属性”
*   展开“构建事件”
*   单击“构建后事件”
*   粘贴`copy "$(ProjectDir)sort.txt" "$(OutputPath)"`到“命令行”框中
*   点击“确定”

现在，当您构建时，应该将 sort.txt 复制到与可执行文件相同的位置。请注意，尽管 sort.txt 看起来像是在“源文件”文件夹中，但实际上并非如此（至少在默认情况下）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:19:51.460

您的代码将被编译到解决方案中的 bin 文件夹中。打开的文件在 bin 文件夹中与 .exe 相同的位置查找文件。如果单击解决方案文件夹中的文件，右键单击并选择属性，然后将选项“复制到输出目录”设置为“始终复制”，VS 会将该文件复制到与 exe 相同的位置。

# variables - 试图了解如何将参数从 gradle 传递到我的 shell 脚本？

> ID：14900883
> 
> 赞同：4
> 
> 时间：2013-02-15T18:16:20.750
> 
> 标签：variables, command-line, terminal, arguments, gradle

我正在尝试通过 gradle 任务将命令行参数传递给我的 shell 脚本，myconfiguration 如下所示。

```
task dosomething(type:Exec) {
  workingDir 'dir'
  executable 'sh'
  args '-c','source dosomething.sh $arg'
} 
```

我试图通过在终端中执行以下命令来传递它：

```
$ gradle dosomething -Parg=foo 
```

它不起作用是我做错了什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T18:42:18.237

Groovy 仅对双引号字符串执行字符串插值。（这就是我默认使用双引号的原因之一。）尝试：

```
...
args "-c", "source dosomething.sh $arg" 
```

# r - 如何计算不同跨度上不同行的百分比变化

> ID：14900885
> 
> 赞同：1
> 
> 时间：2013-02-15T18:16:20.237
> 
> 标签：r, statistics, plyr, quantmod

我正在尝试计算`gvkey`（1001、1384 等）认可的公司季度数据的价格变化百分比。是对应的季度股价，`PRCCQ`。

```
 gvkey  PRCCQ
1   1004 23.750
2   1004 13.875
3   1004 11.250
4   1004 10.375
5   1004 13.600
6   1004 14.000
7   1004 17.060
8   1004  8.150
9   1004  7.400
10  1004 11.440
11  1004  6.200
12  1004  5.500
13  1004  4.450
14  1004  4.500
15  1004  8.010 
```

我想要做的是添加 8 列显示 1 个季度回报、2 个季度回报等，一直到 8 个季度。我已经能够通过使用和的`delt`函数计算每个PRCCQ 的1 个季度收益，并且我还能够使用相同的代码通过更改来获得2 个季度的收益。`quantmod``ddply``plyr``k`

```
ddply(data, "gvkey", transform,  DeltaCol = Delt(PRCCQ,k=2)) 
```

但是，这个等式不会让我比`k=2`没有给我**不同行数的错误 2,3**更高。我现在尝试使用许多替代方法，但效果很好。是否有一个函数可以插入到`ddply`我必须替换的代码中，`Delt`或者可能是另一个完全替代的代码行，以在各个列中显示所有 8 个季度的回报？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:33:55.503

您可以将您的数据声明为`ts()`并使用`cbind()`和`diff()`

```
data <- read.table(header=T,text='gvkey  PRCCQ
   1004 23.750
   1004 13.875
   1004 11.250
   1004 10.375
   1004 13.600
   1004 14.000
   1004 17.060
   1005  8.150
   1005  7.400
  1005 11.440
  1005  6.200
  1005  5.500
  1005  4.450
  1005  4.500
  1005  8.010')

data <- split(data,list(data$gvkey))
(newdata <- do.call(rbind,lapply(data,function(data) { data <- ts(data) ; cbind(data,Quarter=diff(data[,2]),Two.Quarter=diff(data[,2],2))})))

      data.gvkey data.PRCCQ Quarter Two.Quarter
 [1,]       1004     23.750      NA          NA
 [2,]       1004     13.875  -9.875          NA
 [3,]       1004     11.250  -2.625     -12.500
 [4,]       1004     10.375  -0.875      -3.500
 [5,]       1004     13.600   3.225       2.350
 [6,]       1004     14.000   0.400       3.625
 [7,]       1004     17.060   3.060       3.460
 [8,]       1005      8.150      NA          NA
 [9,]       1005      7.400  -0.750          NA
[10,]       1005     11.440   4.040       3.290
[11,]       1005      6.200  -5.240      -1.200
[12,]       1005      5.500  -0.700      -5.940
[13,]       1005      4.450  -1.050      -1.750
[14,]       1005      4.500   0.050      -1.000
[15,]       1005      8.010   3.510       3.560 
```

编辑：

另一种方式，没有`split()`和`lapply()`（可能更快）

```
data <- read.table(header=T,text='gvkey  PRCCQ
       1004 23.750
       1004 13.875
       1004 11.250
       1004 10.375
       1004 13.600
       1004 14.000
       1004 17.060
       1005  8.150
       1005  7.400
      1005 11.440
      1005  6.200
      1005  5.500
      1005  4.450
      1005  4.500
      1005  8.010')
newdata <- do.call(rbind,by(data, data$gvkey,function(data) { data <- ts(data) ; cbind(data,Quarter=diff(data[,2]),Two.Quarter=diff(data[,2],2))})) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:44:07.970

```
df <- read.table(text="gvkey  PRCCQ
1  1004  5.500
2  1004  4.450
3  1004  4.500
4  1004  8.010
5  1005  4.450
6  1005  4.500",header=TRUE)

library(plyr)
library(quantmod)
ddply(df, "gvkey", transform, DeltaCol = Delt(PRCCQ,k=3))
#error

Delt2 <- function(x,k) {
  if(length(x)>k) as.vector(Delt(x1=x,k=k)) else rep(NA,length(x))
}

ddply(df, "gvkey", transform, DeltaCol = Delt2(PRCCQ,k=3))
#  gvkey PRCCQ  DeltaCol
#1  1004  5.50        NA
#2  1004  4.45        NA
#3  1004  4.50        NA
#4  1004  8.01 0.4563636
#5  1005  4.45        NA
#6  1005  4.50        NA 
```

# linux - 如何使用 bash 来关闭我的 GPU？

> ID：14900890
> 
> 赞同：1
> 
> 时间：2013-02-15T18:16:49.813
> 
> 标签：linux, bash, gpu

我目前正在熟悉 bash 脚本。我的一个问题是试图通过在每次 Linux 加载时关闭强大的 GPU 来修复笔记本电脑上的混合视频。

为此，我目前通过添加以下行来编辑 rc.local：

```
chown -R $USER:$USER /sys/kernel/debug
echo OFF > /sys/kernel/debug/vgaswitcheroo/switch 
```

问题是，每次系统退出睡眠模式时，GPU 都会再次开启，最终会变得越来越热，如 lm-sensors 所示。

我的问题：我必须做些什么来保持所说的 GPU 不断关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:30:48.973

我认为这是一个错误，尚未修复，所以现在您可以通过添加类似这样的内容来调用唤醒事件的脚本`/etc/pm/sleep.d`

```
#!/bin/sh
case "${1}" in
    resume|thaw)
        vga_off.sh
        ;;
esac 
```

注意：您确定 GPU 再次打开吗？还是如此[错误](https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1027522)中报告的那样消耗更多功率？如果是这种情况，解决方法是再次打开和关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:22:38.527

这个问题可能有很多解决方案，但一个可行的方法是将这两行放入脚本中，然后将其添加到您的 crontab 中，每 5 分钟运行一次。这将导致计算机每五分钟禁用一次 GPU，如果它已经被禁用，它不会造成任何不利影响（除了每 5 分钟运行一个短脚本，这并不多）。

```
crontab -e
# Add the following line:
*/5 * * * * /home/user2057368/scripts/GPUTurnOffScript.sh 
```

GPUTurnOffScript.sh 可以写成如下：

```
#!/bin/bash
chown -R $USER:$USER /sys/kernel/debug
echo OFF > /sys/kernel/debug/vgaswitcheroo/switch 
```

然后你必须通过更改权限来确保它是可执行的

```
sudo chmod u+x GPUTurnOffScript.sh 
```

# c# - 从类中的集合字段中获取值

> ID：14900891
> 
> 赞同：-1
> 
> 时间：2013-02-15T18:16:52.310
> 
> 标签：c#, string, collections

我需要从属性/字段中获取集合类型数据并最终将其显示在表单上。我怎么做？

下面的代码解释了我正在尝试做的事情和我得到的错误，希望它有意义。

```
public class C
{

    public string Id { get; set; }
    //public List<string> ColVal { get; }

    public C()
    {}

    public C(ObjectA objVar)
    {
        Id = objVar.Id;
        //ColVal = objVar.ColVals; //<- Errors out: This is a collection type property, how do I get values & solve this?
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:25:54.530

我不知道 ObjectA 是什么，但它看起来应该是 C 类型，所以我改变了它。然后我注意到您的集合属性没有设置器。

公共类 C {

```
public string Id { get; set; }
public List<string> ColVal { get; set; }

public C()
{}

public C(C objVar)
{
    Id = objVar.Id;
   ColVal = objVar.ColVal; //<- Errors out: This is a collection type property, how do I get values & solve this?
}
} 
```

# ruby - 如何在 Ruby 中批量单元测试对象集合？

> ID：14900892
> 
> 赞同：1
> 
> 时间：2013-02-15T18:16:52.293
> 
> 标签：ruby, unit-testing

当我对我不太信任的代码进行单元测试时，我通常会使用这种模式：

1.  想想我对函数输出的许多（可能是几十个）期望（我认为这些是关于代码如何工作的“理论”）。
2.  旋转数以千计的对象。
3.  通过我编写的数十个断言运行每个对象，这些断言反映了我对代码工作方式的期望。

在 Ruby 的 Test::Unit （我是新手）中，我一直在做这样的事情：

```
class TestFooBarrer < Test::Unit::TestCase
  def setup
    @lots_of_objects_to_be_tested = FooBarrer.bar_lots_of_foos
  end

  def assert_foo_has_been_barred(foo)
    assert_kind_of Bar, foo
  end

  def assert_foo_has_baz_method(foo)
    assert_respond_to foo, :baz
  end

  #Many more assertions along those lines go here.

  def test_all_theories
    @lots_of_objects_to_be_tested.each do |foo|
      assert_foo_has_been_barred(foo)
      assert_foo_has_baz_method(foo)
      # etc.
      #
    end
  end
end 
```

当我正在测试的理论数量有几十个时，这显然会变得有点笨拙，并且涉及到在我看来很多不必要的重复。我宁愿做这样的事情：

```
class FooTheories
  def self.assert_all_theories(foo)
    # ???
  end

  def assert_foo_has_been_barred(foo)
    assert_kind_of Bar, foo
  end

  def assert_foo_has_baz_method(foo)
    assert_respond_to foo, :baz
  end

  #Many more assertions along those lines go here.
end

class TestFooBarrer < Test::Unit::TestCase
  def setup
    @lots_of_objects_to_be_tested = FooBarrer.bar_lots_of_foos
  end

  def test_all_theories
    @lots_of_objects_to_be_tested.each do |foo|
      FooTheories.assert_all_theories(foo)
    end
  end
end 
```

基本上，我正在寻找一种方法来在一个地方编写一堆断言，然后在大量对象上一遍又一遍地调用它们。

Ruby 中是否有类似的支持？我与 Test::Unit 无关。任何测试框架都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:57:54.180

我要做的是即时生成测试。在 test_helper 中添加一个方法：

```
def test(obj, &block)
  define_method("test_#{ obj.to_s }", &block)
end 
```

然后你可以像下面这样制作你的测试套件

```
class TestObjects < Test::Unit::TestCase

  @objects_to_test = [...]

  @objects_to_test.each do |obj|
    test obj do

      assert obj.is_a?(Foo), 'not a foo'

      # all assertions here

    end
  end

end 
```

然后如果它失败了，你会知道哪个对象失败了，因为测试的名称是对象的字符串表示。前消息：

```
1) Failure:
test_#<Bar:0x000001009ee930>(TestObjects):
not a foo 
```

# c# - 在 Web 应用程序中读取二进制数据会导致文件损坏

> ID：14900893
> 
> 赞同：1
> 
> 时间：2013-02-15T18:16:54.913
> 
> 标签：c#, .net, asp.net-mvc, postgresql-9.1

我正在使用 ASP.Net MVC-web 应用程序中的上传页面将二进制文件/附件存储在 Postgress 数据库中。如果我在控制台程序中获取这些附件并将内容写入磁盘，所有附件都很好，我可以读取它们。如果我在我的 Web 应用程序中执行完全相同的代码，则每个附件的内容都会损坏。这是什么原因造成的？

这是我正在使用的代码：

```
 private void DumpBijlagen( )
    {
        NpgsqlConnection connection = null;

        try
        {
            DataSet     ds              = new DataSet();
            DataTable   dt              = new DataTable();
            string  connectionString    = "Server=127.0.0.1;Port=5432;User Id=gtsys;Password=gtsys;Database=postgis20";
            connection = new NpgsqlConnection( connectionString);

            StringBuilder sb = new System.Text.StringBuilder( );
            sb.AppendFormat( "select id, filename, filesize, created, data from web_bijlagen" );

            string sql = sb.ToString( );
            d.WriteLine( sql);

            NpgsqlDataAdapter   da  = new NpgsqlDataAdapter( sql, connection);
            da.Fill( ds);
            dt = ds.Tables[ 0];

            string  filename = string.Empty;
            int     fileSize = 0;
            byte[]  bytes   = null;

            foreach( DataRow dr in dt.Rows)
            {
                filename    = System.Convert.ToString   ( dr[ "filename"]);
                fileSize    = System.Convert.ToInt32    ( dr[ "filesize"]);
                bytes       = dr[ "data"] as byte[];
                WriteBijlage( filename, bytes);
            }

            DataDumper.Dump( dt);
            connection.Close();
        }
        catch( System.Exception ex)
        {
            d.WriteLine( ex.Message);
        }
        finally
        {
            if( connection.State == System.Data.ConnectionState.Open) 
            {
                connection.Close( );
            }               
        }
    }

    private void WriteBijlage( string filename, byte[] bytes)
    {
        filename = string.Format( @"d:\Usr\Stephan\Junk\wBijlagen\{0}", filename);
        FileStream      fs  = new FileStream    ( filename, FileMode.Create, FileAccess.Write);     
        BinaryWriter    bw  = new BinaryWriter  ( new BufferedStream(fs));
        bw.Write( bytes);   
        bw.Flush();

        fs.Close();
        bw.Close(); 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T16:24:33.460

你可能想试试这个：

在您将字节返回给您的网络应用程序时 - 首先将其编码为 base64。下面的代码适用于我的一个应用程序中的确切目的。

```
thumbnail_url = @"data:image/png;base64," + Convert.ToBase64String(bytes); 
```

差点忘了提——然后您将返回值用作图像的 src。根据需要更改类型 - 我的是 png。

我希望这有帮助。

# python - 在循环中添加同一类的新对象

> ID：14900894
> 
> 赞同：2
> 
> 时间：2013-02-15T18:16:57.927
> 
> 标签：python, class, object, python-3.x, pygame

我不确定标题是否给出了最好的描述。但这是我的问题。我有一个名为“球”的课程。每个球都有自己的宽度、半径和颜色。当我在循环之前添加自己的球时，我的代码运行良好，例如。ball1 = Ball() .... ball2 = Ball() 我正在使用 pygame，我想要的是，每当我按下“空格”时，它都会添加另一个具有自己特征的球。我有它，所以它随机给出宽度、半径和颜色。这是我的代码：

```
BLACK = (0,0,0)
WHITE = (255, 255, 255)
BLUE = (0, 0, 255)
RED = (255, 0, 0)
GREEN = (0, 255, 0)

fps = 30

color_list = [BLACK, BLUE, GREEN, RED]

col = None
siz = None
wit = None
posx = None
posy = None
ball = None

class Ball:

    ballCount = 0

    def __init__(self):
        Ball.ballCount +=1
        self.col = random.choice(color_list)
        self.siz = random.randint(20, 80)
        self.wit = random.randint(1, 3)
        self.posx = random.randint(self.siz, width-self.siz)
        self.posy = random.randint(self.siz, height-self.siz)

    def blitball(self):
        pygame.draw.circle(screen, self.col, (self.posx, self.posy),self.siz, self.wit)

    def move(self):
        self.posx+=1

ball2 = Ball()
ball1 = Ball()
ball3 = Ball()

while True:

    amount = 0

    event = pygame.event.poll()
    keys = pygame.key.get_pressed()

    if event.type == QUIT:
        pygame.quit()
        sys.exit()

    if keys[K_q]:
        pygame.quit()
        sys.exit()

    #############################################################

    if keys[K_SPACE]:
        eval("ball"+str(Ball.ballCount+1)) = Ball()

    #############################################################

    screen.fill(WHITE)

    for r in range(Ball.ballCount):
        amount+=1
        eval("ball"+str(amount)).move()
        eval("ball"+str(amount)).blitball()

    pygame.time.wait(int(1000/fps))

    pygame.display.update() 
```

使用`for r in range(Ball.ballCount):`了，所以我不必为每个球输入函数。这完美地工作。如果您知道更简单的方法，请告诉我。

所以我需要补充的是：

```
if keys[K_SPACE]:  
    #add another ball, ball3, ball4,..etc. 
```

如果这意味着更改我的某些代码，请随时告诉我，甚至自己动手。感谢您提前回复。（我在标签中有我的问题）

丹尼斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:33:28.627

将你的球存储在一个列表中并在那里对它们采取行动

```
# starting three balls
balls = [Ball(),Ball(),Ball()]

while True:
    amount = 0

    event = pygame.event.poll()
    keys = pygame.key.get_pressed()

    if event.type == QUIT:
        pygame.quit()
        sys.exit()

    if keys[K_q]:
        pygame.quit()
        sys.exit()

    #############################################################

    if keys[K_SPACE]:
        balls.append(Ball())

    #############################################################

    screen.fill(WHITE)

    for ball_in_play in balls:
        ball_in_play.move()
        ball_in_play.blitball()

    pygame.time.wait(int(1000/fps))

    pygame.display.update() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:38:05.107

您几乎从不想按名称创建新变量。

而且，即使在极少数情况下，您也几乎从不想使用`eval`or `exec`。

而且，即使您确实想使用`eval`or `exec`，您也几乎不想将它们与默认`locals`/一起使用`globals`。

但是，让我们先看看为什么您的代码不能正常工作，然后再看看如何做得更好。

```
eval("ball"+str(Ball.ballCount+1)) = Ball() 
```

您正在生成一个类似的字符串`"ball4"`，然后调用`eval`它。毫不奇怪，它的计算结果为 string `"ball4"`。然后，您尝试为该`Ball`字符串而不是变量分配一个新值（新构造的实例），显然这不起作用。（实际上，我猜你会`SyntaxError`因为试图分配给一个函数调用而得到一个，甚至在任何事情都被评估之前。）

要解决这个问题，你必须把整个东西放进去`eval`：

```
eval("ball"+str(Ball.ballCount+1) + " = Ball()") 
```

但这不起作用，因为`eval`仅适用于表达式，而不适用于语句。对于语句，您需要`exec`：

```
exec("ball"+str(Ball.ballCount+1) + " = Ball()") 
```

这将摆脱你的错误。

但是让我们看看创建`ball4`变量的正确方法：

```
locals()["ball" + str(Ball.ballCount+1)] = Ball() 
```

更简单也更难出错。

但是一旦你看到了，当你可以使用任何你想要的名字时，为什么还要麻烦使用`locals()`as a呢？`dict``dict`

```
my_balls["ball" + str(Ball.ballCount+1)] = Ball() 
```

而且，一旦你这样做了，你就不需要每个“球”前缀：

```
my_balls[Ball.ballCount+1] = Ball() 
```

到那时，你可能会意识到你的键只是自然数，这意味着你只是`list`用 a模拟 a `dict`，所以你不妨只做`my_balls`a `list`。

然后，你不再需要`Ball.ballCount`了——它只是`len(my_balls)`.

那么，使用`eval`and有什么不好`exec`呢？

好吧，它的效率较低，它使您的代码更难调试（并在交互式终端中进行试验），并且它打开了巨大的安全漏洞（想象一下您向用户询问下一个球号，他给了您“3 ; os.system('rm -rf /'); _" 然后你尝试`exec("Ball" + user_input_string + " = Ball()")`）。

但与它使您的代码更难阅读这一事实相比，所有这些都算不了什么。比较：

```
eval("ball"+str(amount)).move()

balls[amount].move() 
```

# javascript - 如果用户鼠标悬停在表格中，如何删除按钮？

> ID：14900897
> 
> 赞同：1
> 
> 时间：2013-02-15T18:17:04.587
> 
> 标签：javascript, jquery, css

[小提琴](http://jsfiddle.net/23b99/5/)

我现在所拥有的几乎是好的，但是当您沿着表格行移动鼠标时，按钮会由于某种原因被移除，这是我不想要的。如果您将鼠标移出整个表格，我只会删除要删除的按钮。

HTML：看起来像任何具有 3 列 12 行 + 3 列的旧表`<thead>`。

JS：

```
$(document).ready(function(){
    $('#editData tr').hover(function(){
        $('button').remove();
        $(this).children('td:last-child').append('<button id="editButton">Edit</button>');
    });
    $('#editData').mouseout(function(){
        $('button').remove();
    });
}); 
```

CSS：

```
#editData {
  width: 500px;
  margin: auto;
  background: #dadce1;
  margin-bottom: 50px;
  box-shadow: 0 0 10px 1px #e1e1e1;
}
#editData tbody {
  border: 1px solid #b8b8b8;
  border-top: 0;
}
#editData thead {
  border: 1px solid #b8b8b8;
  border-bottom: 0;
  background: rgba(255,255,255,0.7);
  font-size: 20px;
}
#editData thead th {
  padding: 10px;
  font-weight: bold;
  text-align: center;
}
#editData th:last-child, #editData tr td:last-child {
  width: 40px;
}
#editData tr {
  text-align: center;
  height: 30px;
}
#editData td {
  padding: 3px;
}
#editData tr:nth-child(even) {
  background: rgba(255,255,255,0.7);
}
#editButton {
  width: 40px;
  height: 24px;
  border-radius: 5px;
  padding: 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T18:27:41.813

当 DOM 准备好时，最好附加所有按钮：

```
$(function() {
  $('#editData tr td:last-child').append('<button class="editButton">Edit</button>');
}); 
```

然后使用 CSS 显示/隐藏按钮：

```
.editButton {
  width: 40px;
  height: 24px;
  border-radius: 5px;
  padding: 0;
  display: none;
}

#editData tr:hover .editButton {
  display: block;
} 
```

还要注意按钮是 now `.editButton`。

* * *

这是它的实际操作：http: [//jsfiddle.net/23b99/15/](http://jsfiddle.net/23b99/15/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:22:51.183

使用第二个参数[`.hover`](http://api.jquery.com/hover/)。这会将`mouseleave`处理程序附加到您的行 ( `tr`)。

```
$('#editData tr').hover(function(){
    $(this).children('td:last-child').append('<button id="editButton">Edit</button>');
}, function() {
    $('button').remove();
}); 
```

[**小提琴**](http://jsfiddle.net/23b99/10/)

基本上，只需平衡行的您`mouseenter`和`mouseleave`处理程序。

* * *

此外，如果您有兴趣了解真正的问题，请阅读[`mouseout`vs`mouseleave`](http://api.jquery.com/mouseout/)（页面底部的演示）。

问题是，`mouseout`每次它在表格的任何后代中触发时都会冒泡，它会冒泡到表格元素并触发其 mouseout 处理程序。

从[`mouseout`](http://api.jquery.com/mouseout/)文档：

> 由于事件冒泡，这种事件类型会引起很多麻烦。例如，在本例中，当鼠标指针移出 Inner 元素时，`mouseout`将向该元素发送一个事件，然后向 Outer 发送一个事件。这可能会`mouseout`在不合时宜的时间触发绑定处理程序。[`.mouseleave()`](http://api.jquery.com/mouseleave)有关有用的替代方案，请参阅讨论。

* * *

`hover`只是附加`mouseenter`和`mouseleave`处理程序的简写，您可以显式使用`mouseleave`而不是`mouseout`在原始示例中使用它，它也可以工作：

```
$('#editData tr').mouseenter(function(){
    $('button').remove();
    $(this).children('td:last-child').append('<button id="editButton">Edit</button>');
});
$('#editData').mouseleave(function(){
    $('button').remove();
}); 
```

[**小提琴**](http://jsfiddle.net/23b99/16/)

第二段代码是您所要求的：它在您`mouseleave`使用表格时删除所有按钮，而第一个是我的重构版本，`mouseenter`它在您行时附加一个按钮并在您使用时将其删除`mouseleave`。两者具有相同的可见效果。

* * *

旁注：我已经替换了示例中的`hover`by ，因为在使用单个参数调用时会不必要地将处理程序附加到两者和事件上。`mouseenter``.hover``mouseenter``mouseleave`

使用`.hover`, `mouseleave`for`tr`将删除按钮并创建一个新按钮，当您将鼠标移动到表格外部时，事件将冒泡到表格元素删除刚刚创建的按钮，或者如果您将鼠标移动到另一个行，处理程序也将被调用两次（`mouseleave`旧行和`mouseenter`新悬停目标行）。当然，这是不可见的，因为这些处理程序将在微秒内执行，并且浏览器可能会分组重绘。您可以看到，这就是这个[fiddle](http://jsfiddle.net/23b99/17/)`console.log`中的一些 s实际发生的情况。

这在此用例中可能没有太大区别（性能除外），但在许多其他情况下，您可能会遇到问题 - 关于 SO 的许多问题是因为提问者认为[`.hover()`](http://api.jquery.com/hover/)使用单个参数调用只会附加一个[`mouseenter`](http://api.jquery.com/mouseenter/)处理程序，但事实并非如此.

附言。我将这个答案针对您的事件冒泡/逻辑问题，但您不必为了这么简单的事情滥用 jQuery。@Daryl Ginn 的回答是非常适合实际使用的解决方案。`=]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:22:11.927

你只需要用 替换`hover`，`mouseover`然后它就可以工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:24:19.337

问题是当鼠标离开'td'时会发生mouseout，但由于它位于'tr'上，所以悬停不会再次发生。通过在“td”上进行悬停，当您使用鼠标水平移动并越过列边界时，您会开始新的悬停。

试试这个改变。tr -> td 并添加一个 .parent()

```
$(document).ready(function(){
    $('#editData td').hover(function(){
        $('button').remove();
        $(this).parent().children('td:last-child').append('<button id="editButton">Edit</button>');
    });
    $('#editData').mouseout(function(){
        $('button').remove();
    });
}); 
```

[新小提琴](http://jsfiddle.net/23b99/9/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T18:29:15.590

我想你正在寻找这个：http: [//jsfiddle.net/23b99/13/](http://jsfiddle.net/23b99/13/)

```
 $(document).ready(function () {
       $('#editData tr').hover(function () {
         $('button').remove();
         $(this).children('td:last-child').append('<button id="editButton">Edit</button>');
       }, function () {
         $('button').remove();
       });
    }); 
```

# google-analytics - 无法解析来自 Garb 的响应

> ID：14900898
> 
> 赞同：0
> 
> 时间：2013-02-15T18:17:06.177
> 
> 标签：google-analytics, ruby-on-rails-3.2, google-analytics-api, garb-gem

我正在尝试在我的 rails 应用程序中使用 Sija 的[Garb 。](https://github.com/Sija/garb)但是我在获取配置文件后无法解析响应。以下是我为获取配置文件所做的工作的摘要：

```
Garb::Session.access_token = token
subs = Garb::Management::Profile.all
@subsInfo = []
subs.each do |sub|
  sub_info = {:sid => sub.id,
              :sname => sub.name, 
              :surl => sub.websiteUrl
             }
  @subsInfo << sub_info
end 
```

问题是，即使 sub.id 和 sub.name 有效，我也会收到“未定义的方法 'websiteUrl'”消息。这是我提出 to_yaml 时 subs 响应的样子：

```
---
- !ruby/object:Garb::Management::Profile
  entry:
    id: '12345678'
    kind: analytics#profile
    selfLink: https://www.googleapis.com/analytics/v3/management/accounts/01234567/webproperties/UA-01234567-1/profiles/12345678
    accountId: '01234567'
    webPropertyId: UA-01234567-1
    internalWebPropertyId: '12345678'
    name: first property
    currency: USD
    timezone: America/New_York
    websiteUrl: http://www.firstproperty.com
    defaultPage: http://www.firstproperty.com/home.html
    type: WEB
    created: '2010-05-21T14:40:46.600Z'
    updated: '2011-02-02T16:51:12.910Z'
    eCommerceTracking: true
    parentLink:
      type: analytics#webproperty
      href: https://www.googleapis.com/analytics/v3/management/accounts/01234567/webproperties/UA-12345678-1
    childLink:
      type: analytics#goals
      href: https://www.googleapis.com/analytics/v3/management/accounts/01234567/webproperties/UA-01234567-1/profiles/12345678/goals
  session: &12345678901234 !ruby/class 'Garb::Session'
- !ruby/object:Garb::Management::Profile
  entry:
    id: '23456789'
    kind: analytics#profile
    selfLink: https://www.googleapis.com/analytics/v3/management/accounts/01234567/webproperties/UA-01234567-2/profiles/23456789
    accountId: '01234567'
    webPropertyId: UA-01234567-2
    internalWebPropertyId: '23456789'
    name: Second Property
    currency: USD
    timezone: America/Los_Angeles
    websiteUrl: http://www.secondproperty.com/
    defaultPage: http://www.secondproperty.com/index.html
    type: WEB
    created: '2010-07-05T19:58:33.611Z'
    updated: '2011-02-02T16:51:12.922Z'
    eCommerceTracking: true
    parentLink:
      type: analytics#webproperty
      href: https://www.googleapis.com/analytics/v3/management/accounts/01234567/webproperties/UA-01234567-2
    childLink:
      type: analytics#goals
      href: https://www.googleapis.com/analytics/v3/management/accounts/01234567/webproperties/UA-01234567-2/profiles/23456789/goals
  session: *012345678901234 
```

我一生都无法弄清楚为什么 websiteUrl 告诉我它是未定义的。不仅仅是那个属性，还有其他几个属性，但出于某种原因 id 和 name 工作得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:20:02.823

[在这里](https://github.com/Sija/garb/blob/master/lib/garb/management/profile.rb)找到了答案。该属性已从 websiteUrl 重命名为 website_url。哎呀。

# javascript - js: removeEventListener for function(){}

> ID：14900905
> 
> 赞同：0
> 
> 时间：2013-02-15T18:17:58.057
> 
> 标签：javascript, events

使用 addEventListener 和 removeEventListener 之类的命名函数，如 function foo(){} 似乎很容易。

但是，我还有另一种情况，使用无名函数可能很有用，例如

> 添加事件监听器（
> 
> ```
>  "thervent",
> 
>    function(){
> 
>            /*whatever i want to do before removing the eventlistener afterwards.*/ 
> 
>            ...removeEvenetListener("...",???,...);
> 
>    } 
> ```
> 
> );

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:20:07.063

您需要将该函数存储在一个变量中，以便在删除它时可以引用它。

```
var handler;

handler = function () {
    /* ... */
    removeEventListener("theEvent", handler);
};

addEventListener("theEvent", handler); 
```

如果您愿意，您可以完全内联地执行此操作，但如果您不了解闭包¹ ，则此表达式会有点令人困惑。这种方法的优点是处理程序的名称不会污染您在其中添加事件侦听器的函数的范围。

```
addEventListener("theEvent", (function () {
    function handler () {
        /* ... */
        removeEventListener("theEvent", handler);
    };

    return handler;
}())); 
```

* * *

¹当然，如果您不了解闭包，那么您应该在编写另一行 JavaScript 之前立即了解它们，因为这是该语言中最有用和最强大的功能之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T18:21:57.060

除了浏览器兼容性问题，^(1,2)没有什么能阻止您[命名该函数表达式](http://kangax.github.com/nfe/#named-expr)：

```
addEventListener(
   "thervent",
   function foobar(){
        /*whatever i want to do before removing the eventlistener afterwards.*/ 

        removeEventListener("thervent", foobar ,...);

   }
); 
```

* * *

1.  [http://kangax.github.com/nfe/#jscript-bugs](http://kangax.github.com/nfe/#jscript-bugs)
2.  [http://kangax.github.com/nfe/#safari-bug](http://kangax.github.com/nfe/#safari-bug)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:23:30.917

您不能删除匿名函数，您需要一个处理程序来执行此操作：

```
el.addEventListener(
    "theevent",
   function myhandler(e){
       /*whatever i want to do before removing the eventlistener afterwards.*/ 
       this.removeEvenetListener(e.type, myhandler, false);

   },
   false
); 
```

请注意，`myhandler`它仅为函数体定义，因此您不会与外部其他函数的名称发生冲突。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-15T18:21:47.717

使用`arguments.callee`. 像这样的东西会起作用：

```
addEventListener("theEvent",function() {
    var callee = arguments.callee;
    // some code here
    removeEventListener("theEvent",callee);
}); 
```

或者，如果您使用严格模式（在我看来毫无意义，但以防万一......）使用这个：

```
addEventListener("theEvent",function handler() {
    // some code here
    removeEventListener("theEvent",handler);
}); 
```

# android - 如何在android布局中将图像调整为特定大小？

> ID：14900906
> 
> 赞同：1
> 
> 时间：2013-02-15T18:17:59.193
> 
> 标签：android

我正在尝试创建一个图像按钮，并且我想为其指定特定的宽度和高度，但是我的图像大小为 512 x 512 并且当活动开始时，布局由于图像而失真。

无论如何我可以将其调整为特定大小吗？

```
 <Button
        android:id="@+id/prev"
        android:text=""
        android:gravity="center"
        android:width="20dp"
        android:height="20dp"
        android:background="@drawable/go_prev"
            /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:21:08.967

是的。将您的 layout_width 和 layout_height 设置为数值，它会将图像固定为该精确尺寸。然后，您可以通过 scaleType 参数控制其缩放或裁剪方式。小心指定 dp 或 px - dp 将允许您以 160 英寸为单位指定它，px 将是物理像素（但可能是任何真实世界的大小）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:21:57.420

您可以指定`px`物理像素而不是`dp`（与密度无关的像素）的大小；**但是**，如果您的应用程序应该支持多个屏幕，则**不应这样做。**

另外，考虑使用`android:layout_height`and`android:layout_width`代替`height`and`width`

# html - VB.net：如何更改放大器；至 ＆

> ID：14900907
> 
> 赞同：0
> 
> 时间：2013-02-15T18:17:58.633
> 
> 标签：html, vb.net, json, json.net

我有一个用于歌曲的 json 提要，对于某些歌曲，它会`amp;`在 json 中显示它的时间，`&amp;`这是 json 中的标题示例：

> Stay (Bass King & X-Vertigo Mix) (feat. Mikky Ekko)

我认为 json 是为互联网设计的。然后它将摆脱＆并保留amp;。我该如何阻止这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:40:44.573

添加对 System.Web 的引用，您可以使用

[`System.Web.HttpUtility.HtmlDecode()`](http://msdn.microsoft.com/en-us/library/system.web.httputility.htmldecode.aspx)

例子：

```
Dim x As String = "Stay (Bass King &amp; X-Vertigo Mix) (feat. Mikky Ekko)"
Console.WriteLine(x)
x = HttpUtility.HtmlDecode(x)
Console.WriteLine(x) 
```

输出：

```
Stay (Bass King &amp; X-Vertigo Mix) (feat. Mikky Ekko)
Stay (Bass King & X-Vertigo Mix) (feat. Mikky Ekko) 
```

# ios - UIView 动画和完成块

> ID：14900916
> 
> 赞同：14
> 
> 时间：2013-02-15T18:18:45.397
> 
> 标签：ios, objective-c

我正在尝试为 tableview 的偏移设置动画，然后在完成块中将其向上移动。但是我的代码在完成块中没有做任何事情：

```
-(void)viewDidAppear:(BOOL)animated {
    if (TRUE) {
         NSLog(@"animating table view");

        [UIView animateWithDuration:.25
                         animations:^{
                             self.tableView.contentOffset = CGPointMake(self.tableView.contentOffset.x, self.tableView.contentOffset.y - 60);
                         }
                         completion:^(BOOL finished){
                             NSLog(@"completion block");
                         }];
    }
} 
```

“完成块”永远不会被输出......有什么想法吗？

编辑：

好的，所以它与我的 UIRefreshControl 有关：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    if (TRUE) {
        UIRefreshControl *refresh = [[UIRefreshControl alloc] init];
        refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Pull to Refresh"];
        [refresh addTarget:self action:@selector(refreshTableView:) forControlEvents:UIControlEventValueChanged];

        [self setRefreshControl:refresh];
    }
} 
```

添加刷新控件后，它不会触发完成块。如果我不添加控件，它会按预期工作。

编辑2：

K，所以如果我滚动表格视图，则会触发完成块：

```
2013-02-15 13:37:06.266 [1922:14003] animating table view
2013-02-15 13:37:14.782 [1922:14003] completion block 
```

编写的代码应该在“动画表视图”之后立即记录“完成块”，但它有 8 秒的延迟，因为那是我自己滚动表视图时。

“拉动刷新”的样子：

![在此处输入图像描述](../Images/16cb9778adceb40a5cdc181b86a088a5.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-15T18:23:00.820

我用过这个并且工作正常。它的替代解决方案。

```
[UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationOptionCurveEaseOut
                         animations:^
         {
             CGRect frame = self.adBannerView.frame;

             self.adBannerView.frame = frame;
         }
                         completion:^(BOOL finished)
         {
         }]; 
```

尝试添加延迟和选项。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-15T21:28:21.930

我能够重现此问题并找到解决方法。

使用继承自的 a`UIScrollView`时，`UITableView`您无法更改它`contentOffset`的不是动画属性。相反，您需要使用方法`setContentOffset:animated:`。

所以，你需要做的是：

1.  将您的视图控制器设置为`UITableView`委托。我做了`viewDidAppear`。
2.  设置一个标志，以便您在委托中知道滚动发生是因为您触发了。
3.  在委托方法`- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView`中，反弹动画（您可以在此处使用`performSelector:afterDelay:`.

这是代码：

```
@interface MyViewController ()

@property (assign, nonatomic) BOOL shouldReturn;

@end

@implementation MyViewController

-(void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    if (TRUE) {
        NSLog(@"animating table view");
        self.shouldReturn = YES;
        self.tableView.delegate = self;
        [self.tableView setContentOffset:
                     CGPointMake(self.tableView.contentOffset.x,
                                 self.tableView.contentOffset.y - 60)
                                animated:YES];
    }
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    if (TRUE) {
        UIRefreshControl *refresh = [[UIRefreshControl alloc] init];
        refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Pull to Refresh"];
        [refresh addTarget:self action:@selector(refreshTableView:) forControlEvents:UIControlEventValueChanged];

        [self setRefreshControl:refresh];
    }
}

- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView {
    if (self.shouldReturn) {
        self.shouldReturn = NO;
        [self.tableView setContentOffset:CGPointZero animated:YES];
    }
}

@end 
```

# java - 我的服务选项卡从 NetBeans 中消失了

> ID：14900923
> 
> 赞同：12
> 
> 时间：2013-02-15T18:19:14.923
> 
> 标签：java, netbeans, jdbc

好的，这是一个非常奇怪和微不足道的问题，但我想上帝本人并没有让我足够聪明，无法独自应对，所以我想问一下，如何将“服务”选项卡放回左侧选项卡? 目前，只有“文件”和“项目”可见选项卡，我尝试探索“查看”菜单，但没有运气。

我正在尝试通过本教程，如果它是相关的，但我被困在这里。

[http://netbeans.org/kb/docs/ide/java-db.html](http://netbeans.org/kb/docs/ide/java-db.html)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-10-09T14:45:05.080

窗口-> 服务。每当您丢失“选项卡”/窗口时，请先检查窗口菜单。

我怀疑这可能在某些版本中改变了位置，但我不确定。我知道 7.3 版就是这样。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-15T18:26:02.600

单击`View -> Services`( **Ctrl+5** )。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-03T18:56:00.617

单击此下方的窗口菜单，您可以看到服务菜单项我单击了它。它看起来更接近 NetBeans IDE 6.7.1 中的“项目”选项卡。快捷键是 ctl+5 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-23T17:18:38.683

转到窗口选项卡并选择重置窗口...。我认为您已关闭它们...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-03T18:45:13.560

单击此下方的 Window 菜单，您可以看到 Service 菜单项，只是我单击它出现在 NetBeans IDE 6.7.1 中的项目附近

# c# - 访问包含表单外对象的列表

> ID：14900930
> 
> 赞同：2
> 
> 时间：2013-02-15T18:19:30.903
> 
> 标签：c#

我有一个表单，其中有一个存储对象的列表。然后我有一个对话框，我希望在其中访问此列表并循环浏览其内容。

主要形式：

```
namespace personregister
{
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }      

    public List<person> personStorage = new List<person>(); 
```

在对话中，我想做这样的事情：

```
namespace personregister
{
public partial class AddPersonDialogue : Form
{
    public AddPersondialogue()
    {
        InitializeComponent();            
        foreach (person p in personStorage)
        {
          //do stuff
        }
    } 
```

问题是我无法访问我以其他形式创建的 personStorage。如何在对话窗口中访问该列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:27:54.170

添加一个方法来进行对话并在它构建后调用。

```
public partial class AddPersonDialogue : Form
{
    public AddPersonDialogue()
    {
        InitializeComponent();            

    }

    public void SetUpPeople(List<person> personStorage)
    {
        foreach (person p in personStorage)
        {
          //do stuff
        }
    }
}

 public Form1()
 {
    {
        InitializeComponent();
    }      

    public List<person> personStorage = new List<person>();

    public void ShowForm()
    {
        var dialogue = new AddPersonDialogue();

        dialogue.SetUpPeople(personStorage);

        dialogue.Show();
    }
} 
```

您也可以通过构造函数来完成。

```
public partial class AddPersonDialogue : Form
{
    public AddPersonDialogue(List<person> personStorage)
    {
        InitializeComponent();
        foreach (person p in personStorage)
        {
          //do stuff
        }       

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:27:16.430

**编辑**

现在您已重命名函数以表明它是一个构造函数 - 下面的选项 #1 是最好的。只需将`IList<person> personStorage`其作为参数添加到您的构造函数。（或者`IEnumeable<person> personStorage`如果您不需要特定于列表的功能，则使其更加通用）

* * *

既然`AddPersonDialogue`对它一无所知`Form1`，也不知道怎么弄`personStorage`。假设您正在从这里创建对话框，`Form1`这里有几个选项：

1.  添加一个构造函数，`AddPersonDialogue`它接受一个`List<person>`参数并将该值分配给一个属性。这样你就可以在`AddPersonDialogue`.
2.  将公共属性添加到`AddPersonDialogue`for `PersonStorage`。然后在创建对话框后设置该属性。

如果列表对于表单运行是必不可少的，我会将它放在构造函数中，以便调用者知道它是必需的组件。

# android - 有没有办法查看 Android 谷歌服务源代码？

> ID：14900933
> 
> 赞同：4
> 
> 时间：2013-02-15T18:19:42.370
> 
> 标签：android, google-maps-android-api-2, android-source

我想查看 Google 服务的源代码（特别是 GoogleMap 类，来自 Maps API 的 V2）。我环顾四周，找不到任何东西。

我知道以下内容：

*   一般Android开发的Java API可以在线浏览：http: [//grepcode.com/project/repository.grepcode.com/java/ext/com.google.android/android/](http://grepcode.com/project/repository.grepcode.com/java/ext/com.google.android/android/)
*   Google Android 应用程序（如 Google 地图）的源代码不可用：http: [//source.android.com/faqs.html#how-can-i-get-access-to-the-google-apps-for-安卓地图](http://source.android.com/faqs.html#how-can-i-get-access-to-the-google-apps-for-android-such-as-maps)
*   用于查看 Android 源代码的 Eclipse 插件不包括服务源代码（如预期的那样）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:22:18.623

Google 自己的应用程序（地图、Play 商店、Gmail）不是开源的，也不属于 Android 开源项目 (AOSP)。

请注意，包名称有明显的区别：

```
android.* android核心组件
com.android.* 内部助手/实现类
com.google.* Google 的 API 和应用程序。

```

# javascript - jQuery悬停功能

> ID：14900942
> 
> 赞同：0
> 
> 时间：2013-02-15T18:20:34.520
> 
> 标签：javascript, jquery, html, css

我正在尝试在两个不同的表中同步悬停...但是由于某种原因，当只有函数的第一部分有效时，添加第二部分会破坏第一部分并且不会给我任何错误。

我没有把它放到 jsfiddle 中，因为它不是视觉上的东西……它的纯代码在某个地方被破坏了。

```
$(function(){
    //first part
        var trsCont = $('#conteudo table tr');
        for (i = 0; i < trsCont.length; i++) {
            trsCont.eq(i).hover(
                function () {
                    $('#coluna_fixa table tr').eq(i-1).toggleClass("hovered");
                    }
                );
            }
        //second part   
        var trsCol = $('#coluna_fixa table tr');
        for (i = 0; i < trsCol.length; i++) {
            trsCol.eq(i).hover(
                function () {
                    $('#conteudo table tr').eq(i+1).toggleClass("hovered");
                }
            );
        }
}); 
```

我知道我做错了什么……有人能指出来吗？

感谢您阅读本文。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:29:43.660

您真的不应该在循环内定义事件处理程序。相反，您应该使悬停功能更通用，如下所示：

```
//first part
       $('#table1 tr').hover(
           function () {
               var index = $(this).index();
               $("#table2 tr:eq(" + (index - 1) + ")").toggleClass("hovered");
           }
       );
        //second part   
        $('#table2 tr').hover(
           function () {
               var index = $(this).index();
               $("#table1 tr:eq(" + (index + 1) + ")").toggleClass("hovered");
           }
       ); 
```

看看这个 JSFiddle 的例子：http: [//jsfiddle.net/cAEWR/2/](http://jsfiddle.net/cAEWR/2/)

# video - jwplayer黑盒问题

> ID：14900944
> 
> 赞同：1
> 
> 时间：2013-02-15T18:20:44.140
> 
> 标签：video, jwplayer

我不明白为什么视频不能播放？和格式有关系吗？mp4？

我正在使用 jwplayer，因为我想要一个非 Flash 解决方案/

这是链接：[http ://www.2kfilms.com/jw_test.html](http://www.2kfilms.com/jw_test.html)

我正在使用的代码是给定的：

```
`<div id='my-video'></div>
<script type='text/javascript'>
    jwplayer('my-video').setup({
        file: 'http://www.2kfilms.com/jazz.mp4',
        width: '480',
        height: '270'
    });
</script>` 
```

# javascript - Html javascript 链接在 HTML 5 Boilerplate 中包含 url 变量

> ID：14900946
> 
> 赞同：0
> 
> 时间：2013-02-15T18:20:54.680
> 
> 标签：javascript, html, caching, html5boilerplate

当我查看 HTML 5 Boilerplate 时，我注意到一件事：几乎每个脚本链接都是这样的：**'../script.js?v=1'**。这个“v=1”部分引起了我的注意，所以我做了一些研究，发现它是为了缓存目的。我的问题是：**这种技术是如何命名的，它是如何完成的？有没有办法自动更改/更新版本号？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:22:57.650

这通常称为 cachebusting URL。

如果你改变`script.js`了，你可以简单地改变它`?v=2`来强制浏览器跳过缓存。（因为没有缓存内容`script.js?v-2`）

大多数服务器端 Web 环境都有可以自动生成缓存清除 URL 的插件，通常通过在查询字符串中包含文件的哈希值。

# svn - 在svn中重命名目录

> ID：14900947
> 
> 赞同：3
> 
> 时间：2013-02-15T18:20:56.240
> 
> 标签：svn, rename

我有一个这样的文件夹结构：

```
A/B/C/hello.txt 
```

我使用 svn mv 将 A 重命名为 Z：

```
Z/B/C/hello.txt 
```

然后我对 hello.txt 做了一些修改。现在，svn status 给出：

```
D    A/B/C/hello.txt
A+   Z
M+   Z/B/C/hello.txt 
```

当我尝试提交时，我收到以下错误消息：

```
'Z/B/C' is not under version control and is not part of the commit, yet its child 'Z/B/C/hello.txt' is part of the commit 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-01-14T12:56:11.230

```
上例中重命名 SVN 文件夹的命令及其输出如下所示：
# svn mv AZ
AZ
DA/B/C/hello.txt
DA/B/C
轻拍
达
#ls
AZ
# rm -rf A
#ls
Z
#svn st
达
A + Z
# svn ci -m "提交消息。"
删除源/A
添加源/Z

提交修订版 307。
#svn st
# ls -R
.:
Z

./Z:
乙

./Z/B:
C

./Z/B/C:
你好.txt

```

# php - 将 .db 文件导入 MySql 数据库

> ID：14900950
> 
> 赞同：1
> 
> 时间：2013-02-15T18:21:06.647
> 
> 标签：php, mysql, database

我是使用 MySQL 数据库的新手，需要一些帮助。场景很像这样：我从一些传感器收集数据，这些传感器带有他们自己的软件。该软件在从传感器获取数据并将其本地保存在计算机中时，会构建一个 .db 文件。

我的问题是从 .db 文件中收集这些数据，并以一定的频率将其输入到 MySQL 数据库中。

是否可以创建一个使用 .db 文件更新 MySQL 数据库的脚本（假设每 5 秒一次）？你能提供一些关于使用什么的方向吗？

db 文件的链接： [http ://www.filedropper.com/file_45](http://www.filedropper.com/file_45)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:44:30.320

您可以在 Linux 上使用 cron 或在 Windows 上使用 Scheduler。

**编辑：**

对于您上传的文件，您需要安装 SQLite。检查[**此项**](http://www.sqlite.org/sqlite.html)以获取对数据的命令行访问权限。

如果您想为您的系统创建一个 Web 界面，您可能需要检查[**一下。**](http://php.net/manual/en/book.sqlite.php)

# django - 单个 Django 模板是否可以呈现给多个对象？

> ID：14900957
> 
> 赞同：0
> 
> 时间：2013-02-15T18:21:30.870
> 
> 标签：django, django-templates

有没有办法使用 Django 的模板系统来呈现模板文件并返回三个离散对象？

用例：我正在整理一封要根据一些请求参数呈现的电子邮件。每封电子邮件包含 a) 主题，b) 纯文本版本，c) html 版本。理想情况下，我希望所有这些都来自一个模板文件，而不是三个单独的文件，以便于维护。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:36:29.157

我会使用 render_to_string，传入要渲染的部分的参数。这将允许您使用一个模板并一次渲染模板的一部分。

```
from django.template.loader import render_to_string

subject = render_to_string('the-template.html',
    {'section': 'subject', 'subject': 'Foo bar baz'})
plain_text = render_to_string('the-template.html',
    {'section': 'text', 'text': 'Some text'})
html = render_to_string('the-template.html',
    {'section': 'html', 'html': '<p>Some html</p>'})

#the-template.html
{% if section == 'subject' %}
    {{ subject }}
{% elif section == 'text' %}
    {{ plain_text }}
{% else %}
    <h1>A headline, etc.</h1>
    {{ html }}
{% endif %} 
```

您还可以将传入请求中所需的任何值传递给上下文中的模板。

# java - 为什么后退按钮在此 Android 网络视图中不起作用？

> ID：14900959
> 
> 赞同：4
> 
> 时间：2013-02-15T18:21:34.037
> 
> 标签：java, android, eclipse, android-webview

让“返回”按钮在 webview 中工作时遇到问题。

我不确定我应该将`onKeyDown()`部分放在代码中的哪个位置（目前在最后一个`@Override`）

两者`mywebview.canGoBack()`都会`mywebview.goBack()`导致错误提示“无法解析 mywebview”。

如果我将支架一直移动`mywebview.setWebClient(...)`到底部，`mywebview-error`就会消失，但是`override`, `onKeyDown`, `return true`,会`return super`导致各种错误。

谁能告诉我该怎么做？

代码：

```
package com.sib;

import android.os.Bundle;
import android.app.Activity;
import android.view.KeyEvent;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class SiB extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.sib);

        WebView mywebview = (WebView) findViewById(R.id.webview);
        mywebview.loadUrl("url");

        WebSettings webSettings = mywebview.getSettings();
        webSettings.setJavaScriptEnabled(true);

        mywebview.setWebViewClient(new WebViewClient());

    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {

        if ((keyCode == KeyEvent.KEYCODE_BACK) && mywebview.canGoBack()) {
            mywebview.goBack();
            return true;
        }
        return super.onKeyDown(keyCode, event);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:23:08.640

创建`mywebview`一个类实例变量。

```
public class SiB extends Activity {
WebView mywebview; 
```

然后确保不要通过取出声明中的声明来隐藏它，`onCreate()`它应该如下所示：

```
mywebview = (WebView) findViewById(R.id.webview);
mywebview.loadUrl("url"); 
```

根据[我能找到](https://stackoverflow.com/questions/5312334/how-to-handle-back-button-in-activity)的，Gabe 是对的。`onKeyDown()`后压机仅适用于 API 4 及更低版本。`onBackPressed()`应该适用于比 API 4 更新的一切。

```
@Override
public void onBackPressed(){

    if (mywebview.canGoBack()) {
        mywebview.goBack();
        return;
    }
    super.onBackPressed();      
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:22:34.953

onKeyDown 对后面不起作用。您需要覆盖 onBackPressed。

# sencha-touch-2 - Sencha Touch 2：“找不到指定的商店”

> ID：14900967
> 
> 赞同：3
> 
> 时间：2013-02-15T18:22:01.493
> 
> 标签：sencha-touch-2, nested-lists

我正在尝试将 JSON 数据加载到 NestedList 中。我在 /app/store/Exhibits.js 中有以下商店文件

```
Ext.define('VisitTCMIndy.store.Exhibits',{
requires: ['VisitTCMIndy.model.Exhibit', 'Ext.data.proxy.JsonP'],
extend: 'Ext.data.TreeStore',
config: {
    model: 'VisitTCMIndy.model.Exhibit',
    proxy: {
        type: 'jsonp',
        url: 'http://www.example.com/explore.php',
        reader: {
            type: 'json',
            rootPropery: 'children'
        }
    }   
}
}); 
```

然后我在 /app/view/Explore.js 中的以下视图中引用它

```
Ext.define('VisitTCMIndy.view.Explore', {
extend: 'Ext.Container',
requires: [
    'Ext.data.TreeStore',
    'Ext.dataview.NestedList',
    'VisitTCMIndy.store.Exhibits',
],
xtype: 'explorecard',
config: {
    iconCls: 'compass1',
    title: 'Explore',
    layout: 'fit',
    items: [
        {
            xtype: 'titlebar',
            docked: 'top',
            title: 'Explore'
        },
        {
            xtype: 'nestedlist',
            fullscreen: true,
            store: 'VisitTCMIndy.store.Exhibits',
            detailCard: {
                html: 'Explore Details'
            },
            listeners: {
                leafitemtap: function(nestedList, list, index, target, record){
                    var detailCard = nestedList.getDetailCard();
                    detailCard.setHtml('Exhibit Title: '+ record.get('title'));
                }
            }
        }

    ]
}
}); 
```

当我转到该页面时，我收到以下警告和一个空列表：

> [WARN][Ext.dataview.NestedList#applyStore] 找不到指定的Store

在我的一生中，我无法弄清楚我做错了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T18:55:23.947

行。原来我必须在我的 app.js 文件中声明我的商店和模型。然后仅通过名称来引用我的商店，而无需其他类定义。因此，我在 app.js 文件中添加了以下内容：

```
models: ['Exhibit'],
stores: ['Exhibits'], 
```

然后，这是我更新的 Explore.js 视图文件。

```
Ext.define('VisitTCMIndy.view.Explore', {
extend: 'Ext.Container',
requires: [
    'Ext.data.TreeStore',
    'Ext.dataview.NestedList',
    'VisitTCMIndy.store.Exhibits',
],
xtype: 'explorecard',
config: {
    iconCls: 'compass1',
    title: 'Explore',
    layout: 'vbox',
    items: [
        {
            xtype: 'titlebar',
            docked: 'top',
            title: 'Explore'
        },
        {
            xtype: 'nestedlist',
            store: 'Exhibits',
            title: 'Museum Levels',
            displayField: 'title',
            detailCard: {
                html: 'Explore Details'
            },
            listeners: {
                leafitemtap: function(nestedList, list, index, target, record){
                    var detailCard = nestedList.getDetailCard();
                    detailCard.setHtml('<div style="text-align:center;margin:.5em;"><img src="'+record.get('image')+'" alt="'+record.get('title')+'" />'+
                        '<p style="text-align:left;">'+record.get('text')+'</p></div>'
                    );
                }
            },
            flex: 1
        }

    ]
}
}); 
```

另外，请注意我将布局从 fit 更改为 vbox。我必须这样做，并给列表一个 1 的 flex，以便列表现在实际显示它正在加载数据。

# android - Android：在没有 Google API 的 Google 帐户中使用 OAuth2 进行身份验证

> ID：14900979
> 
> 赞同：1
> 
> 时间：2013-02-15T18:22:35.060
> 
> 标签：android, google-api, oauth-2.0

为了在之前使用 Google API 需要在 Google 帐户中进行身份验证，并使用 OAuth2 获取身份验证令牌。好吧，我会知道是否有可能做相反的事情：在 Android 中使用 OAuth2，因为我在不使用 Google API 的情况下在 Google 帐户中进行身份验证。我只需要在 Google 帐户中进行身份验证即可执行 Google Apps 脚本脚本，即仅用于向这些脚本发出 GET 或 POST 参数化请求，这些脚本将根据其代码处理此参数，仅此而已。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:36:06.640

是的，这是可能的。这样做的代码：

```
public class UploadFileGASActivity extends Activity {
    public final static String GAS_HELLO_WORLD = "url_to_gas_script";
    public static boolean authTokenInvalidated = false;

    public class OnTokenAdquired implements AccountManagerCallback<Bundle>{
        public void run(AccountManagerFuture<Bundle> future){
            Log.v("CALLBACK","post-getAuthToken");
            try {
                Bundle authTokenBundle = future.getResult();

                if ( authTokenBundle.containsKey(AccountManager.KEY_AUTHTOKEN)){
                    String authTokenStr = authTokenBundle.getString(AccountManager.KEY_AUTHTOKEN);
                    String accountName = authTokenBundle.getString(AccountManager.KEY_ACCOUNT_NAME);
                    String accountType = authTokenBundle.getString(AccountManager.KEY_ACCOUNT_TYPE);
                    Log.v("ACCOUNT NAME",accountName);
                    Log.v("ACCOUNT TYPE",accountType);
                    Log.v("TOKEN",authTokenStr);
                    if (!authTokenInvalidated) {
                        invalidateAuthToken("com.google",authTokenStr);
                        authTokenInvalidated = true;
                        Log.v("CALLBACK","authTokenInvalidated == true");
                        getAuthToken();
                        return;
                    }
                    else {
                        authTokenInvalidated = false;
                        Log.v("CALLBACK","authTokenInvalidated == false");
                    }
                    HttpUtil httpUtil = new HttpUtil();
                    String responseStr = httpUtil.getResponseFromHttpRequest(GAS_HELLO_WORLD, authTokenStr);
                    Log.v("GAS_HELLO_WORLD",responseStr);
                    TextView textView = (TextView)findViewById(R.id.text_upload_file_gas);
                    textView.setText(authTokenStr);
                }
                else {
                    Log.v("KEY_AUTHTOKEN","non hai auth token, normal cando non hai conexion");
                }
                if (authTokenBundle.containsKey(AccountManager.KEY_INTENT)) {
                    Log.e("KEY_INTENT","temos KEY_INTENT");
                    Intent launch = (Intent)authTokenBundle.get(AccountManager.KEY_INTENT);
                    startActivityForResult(launch,0);
                    return;
                }
            }
            catch (AuthenticatorException e){
                Log.e("OnTokenAdquired.run","AuthenticatorException");
            }
            catch (IOException e){
                Log.e("OnTokenAdquired.run","IOException");
            }
            catch (OperationCanceledException e){
                Log.e("OnTokenAdquired.run","OperationCanceledException");
            }
        }
    }
    public void getAuthToken() {
        AccountManager accountManager = AccountManager.get(this);
        Bundle options = new Bundle();
        OnTokenAdquired onTokenAdquired = new OnTokenAdquired();
        Handler handler = new Handler();
        Account[] accounts = accountManager.getAccountsByType("com.google");
        String authTokenType = "oauth2:https://www.googleapis.com/auth/drive";
        AccountManagerFuture<Bundle> future = accountManager.getAuthToken(accounts[1], 
            authTokenType, options, this, onTokenAdquired, handler);
    }
    public void invalidateAuthToken(String accountType, String authToken){
        AccountManager accountManager = AccountManager.get(this);
        accountManager.invalidateAuthToken(accountType, authToken);
    }

    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        //Activity.RESULT_OK;
        Bundle extras = data.getExtras();
        Set<String> keys = extras.keySet();
        Iterator<String> iter = keys.iterator();
        Log.v("KEY_INTENT","requestCode: "+requestCode+", resultCode: "+resultCode);
        Log.v("KEY_INTENT","EXTRAS KEY_INTENT");
        while (iter.hasNext()){
                Log.v("KEY_INTENT",(String)iter.next());
        }
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_upload_file_gas);
            Log.v("GAS","UploadFileGASActivity called.");
        getAuthToken();
    }
} 
```

并且，在 HttpUtil 中：

```
 public String getResponseFromHttpRequest(String httpRequest, String authToken) {
        [..]
        request.setHeader("Authorization", "OAuth "+authToken);
        [..]
    } 
```

我希望它可以帮助某人。不管怎么说，还是要谢谢你。

# sql-server - 如何编写键盘快捷键以从选定表中选择前 1000 个 *？

> ID：14900981
> 
> 赞同：6
> 
> 时间：2013-02-15T18:22:42.850
> 
> 标签：sql-server, ssms, keyboard-shortcuts

有没有办法在 ssms 2012 中创建一个键盘快捷键，按下时会产生与 相同的效果`select top 1000 * from mytable`？

我已经对此进行了探索：http: [//msdn.microsoft.com/en-us/library/ms174178](http://msdn.microsoft.com/en-us/library/ms174178)。

通常，在频繁地浏览数据库时，程序员需要从表中选择顶级记录。

如果这不能在 ssms 中自定义，我会对 ac# 解决方案感到满意，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T18:37:33.133

工具 -> 选项，然后环境 -> 键盘 -> 查询快捷方式。分配一个键为：

```
select top 1000 * from 
```

注意没有表名。现在按 OK，然后打开一个新的查询窗口。突出显示一个表名，然后点击您的组合键。

# java - 在应用引擎java中查询列表属性

> ID：14900984
> 
> 赞同：0
> 
> 时间：2013-02-15T18:22:53.377
> 
> 标签：java, list, google-app-engine

我知道当您在如下查询中使用 IN 运算符时，它会导致多个查询：

```
select * from A where a IN (1,2,3) 
```

另一方面，appengine 如何处理我们在列表属性中查找单个值的查询？

```
select * from B where someListProp IN 1 
```

这在幕后有什么作用？它会导致像另一个一样的多个查询吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T20:38:08.530

1.  这将创建三个查询并组合结果。好处是这发生在数据库服务器上，所以只有往返。

2.  不，这会创建一个查询。

# c - 使用 PPB_ImageData Google Native Client 的 C 示例程序

> ID：14900985
> 
> 赞同：1
> 
> 时间：2013-02-15T18:22:56.113
> 
> 标签：c, google-nativeclient, getimagedata

是否有使用 Google Native Client 中的 PPB_ImageData 的 c 语言参考示例示例？我需要从 html 画布中获取图像数据并使用 c 库处理图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T07:30:36.007

看起来正式的 SDK 有几个利用 PPB_ImageData 的 C++ 示例。您应该能够编写一个调用基于 C 的库的 C++ NaCl 应用程序。

如果您打算使用 C API（我也是这样），那么您必须从 SDK 文档开始工作并了解 PPB_ImageData 的工作原理。但是，我有一个使用 PPB_ImageData 的基于 C 的 Native Client 应用程序。[相关源文件位于此处。](https://github.com/multimediamike/SaltyGME/blob/master/saltygme.c)对“imagedata”进行不区分大小写的搜索以查找所有兴趣点。也许这对你有用。

# php - PHP foreach 的多个循环？

> ID：14900993
> 
> 赞同：1
> 
> 时间：2013-02-15T18:23:19.320
> 
> 标签：php

$result 包含来自数据库查询的数据项数组。

$A 是一个空数组。我还创建了一个名为 $B 的空数组，依此类推。

我想遍历字母表的所有 26 个字母。对于每个字母，我想遍历包含我的数据库查询结果的数组并将它们推送到各自的数组中。所以'Ant'和'Antelope'被推到数组$A上，'Buffalo'推到数组$B上等等。

这是我的问题PHP：

```
$letter = 'A';
  for($count = 1; $count <= 26; ++$count) {
    foreach ($result as $topic) {
      if (substr($topic->animal, 0, 1) == $letter //the first letter is A, B...
        array_push($A, $topic->animal);
      }
    }
  }
  $letter++;
} 
```

1.  我认为内部数组指针被移动到 $result 的末尾，因为我只得到以字母 A 开头的动物被推到数组 $A 上。所有其他数组（$B、$C 等）都是空的。在任何情况下，它只能工作一次（对于字母 A）。reset($result) 似乎不起作用。如何循环 $result 多次 (26) 次？

2.  循环遍历字母时如何更改要推送的数组？换句话说，当 $letter 增加到 BI want 时：array_push($B, $topic->animal);

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:26:57.493

1.  你总是在推进`A`，所以它不会影响任何其他阵列是有道理的。
2.  您可以使用`array_push($$letter,$topic->animal);`(Variable variables) 但不建议使用 - 您应该使用嵌套数组`array_push($letters[$letter],$topic->animal)`

也就是说，试试这个：

```
$letters = Array();
foreach($result as $topic) {
    $letters[substr($topic->animal,0,1)][] = $topic->animal;
} 
```

# java - 如何在 jboss 7.1 中使用 jsf 表单

> ID：14900996
> 
> 赞同：0
> 
> 时间：2013-02-15T18:23:25.003
> 
> 标签：java, jakarta-ee, jsf-2

我的 web.xml 中有这个：

```
<login-config>
        <auth-method>FORM</auth-method>
        <form-login-config>
            <form-login-page>/login_page.xhtml</form-login-page>
        </form-login-config>
</login-config> 
```

login_page.xhtml 有一些 jsf 代码在 jboss 重定向到他时没有呈现。

我如何在里面使用 jsf 而不是 html 页面`<form-login-page>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:41:39.453

JSF 的工作由`FacesServlet`.

您需要确保 URL`<url-pattern>`与`FacesServlet`. 鉴于您的问题，您似乎没有将其映射到 的简单 URL 模式上`*.xhtml`，而是映射到其他东西上，`*.jsf`例如`*.faces`或`/faces/*`。然后，您应该更改 URL，使其与该 URL 模式完全匹配。

想象一下它是`*.jsf`，那么你需要这样改变它：

```
<form-login-page>/login_page.jsf</form-login-page> 
```

但是，更简单的是仅映射`FacesServlet`on `*.xhtml`。这样，您就无需摆弄虚拟 URL。

```
<url-pattern>*.xhtml</url-pattern> 
```

### 也可以看看：

*   [JSF Facelets：有时我看到 URL 是 .jsf，有时是 .xhtml。为什么？](https://stackoverflow.com/questions/3008395/jsf-facelets-sometimes-i-see-the-url-is-jsf-and-sometimes-xhtml-why/3008504#3008504)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:34:29.590

只需使用 form-error-page 标签即可：

```
<login-config>
    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/faces/yourlogin.jsp</form-login-page>
        <form-error-page>/faces/yourloginError.jsp</form-error-page>
    </form-login-config>
</login-config> 
```